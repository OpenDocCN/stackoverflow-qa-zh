# StackOverflow 问答 000933000-000933999

# c++ - 在 C++ 中使用从 C 库返回的指针

> ID：933003
> 
> 赞同：3
> 
> 时间：2009-05-31T22:16:27.783
> 
> 标签：c++

我正在使用用 C 开发的库（特别是：HTK）。我对源代码进行了一些修改，并尝试从函数中获取指针（指向链表的开头）。不赘述；假设我有一个名为 OutType 的结构。在我的 C++ 代码中，我声明： **OutType* Out** ; 并将其传递给某个函数**LName(....., OutType* Out)** 现在，在 C 库中，LName 接受参数 Out，并调用名为 SaveH 的函数，其中 Out 是返回值（**Out=SaveH(... )** ) 并且在 SaveH 中，Out 被分配为**OutType returnOut=(OutType*)malloc(1,sizeof(OutType));** 据我所知，Out 是完全 malloc 的，并且在 LName 函数中我可以获得已分配的内存区域的地址。但是当我返回我的 C++ 代码时，我在其中调用 LName 并将 Out 作为参数传递，该参数的地址始终为 0。如果我保持一切不变，但只需更改 SaveH 以使 Out 不是返回值，而是作为**SaveH(....,OutType* Out)**的参数，并在传递所有内容之前在 C++ 代码中分配该值。正常吗？在 C 库中分配的指针是否有问题，在 C++ 代码中使用？谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-31T22:20:43.890

您正在传递指针的副本，这就是为什么在您的 C++ 代码中看不到 C 库中的更改的原因。

由于您已经在修改库，因此您应该让 C 函数获取**指向指针的指针**。

```
LName(....., OutType** Out)

*Out=SaveH(...); 
```

现在您将传递 C++ 指针的地址，因此您的 C 代码将修改相同的原始指针。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-31T22:23:49.940

如果你有一个功能：

```
void Foo( int * p ) {
   p = malloc( sizeof(int) );
} 
```

那么当你调用它时：

```
int * x;
Foo( x ); 
```

x 的值将保持不变，因为获取了指针的副本。您需要一个指向指针的指针：

```
void Foo( int ** p ) {
   *p = malloc( sizeof(int) );
} 
```

然后：

```
int * x;
Foo( & x ); 
```

如果这不是您的问题，请发布一些实际代码来说明您所询问的内容。

# python - python xml.dom 中的 XML 字符

> ID：933004
> 
> 赞同：1
> 
> 时间：2009-05-31T22:16:45.133
> 
> 标签：python, xml, dom

我正在从 python 生成一个 xml 文档。我们正在使用 xml.dom 包来创建 xml 文档。我们在想要生成字符 φ 时遇到问题。这是一个φ。但是，当我们将该字符串放入文本节点并在其上调用 toxml() 时，我们会得到 &#x03c6;。我们当前的解决方案是在 toxml() 的结果上使用 saxutils.unescape() 但这并不理想，因为我们必须解析 xml 两次。

有没有办法让 dom 包识别“φ” 作为 xml 字符？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-31T23:17:08.287

我认为您需要在其中使用 Unicode 字符串`\u03c6`，因为`.data`文本节点的字段（据我所知）应该是“已解析”的数据，不包括 XML 实体（因此何时`&amp;`返回 XML）。如果要确保在输出时将非 ascii 字符表示为实体，则可以执行以下操作：

```
import codecs

def ent_replace(exc):
  if isinstance(exc, (UnicodeEncodeError, UnicodeTranslateError)):
    s = []
    for c in exc.object[exc.start:exc.end]:
      s.append(u'&#x%4.4x;' % ord(c))
    return (''.join(s), exc.end)
  else:
    raise TypeError("can't handle %s" % exc.__name__)

codecs.register_error('ent_replace', ent_replace) 
```

并使用`x.toxml().encode('ascii', 'ent_replace')`.

# iphone - 为什么 UITextView 对其文本属性使用字符串而不是可变字符串？

> ID：933014
> 
> 赞同：2
> 
> 时间：2009-05-31T22:20:32.097
> 
> 标签：iphone, cocoa-touch, uitextview

从代码设计的角度来看，为什么内部实现会`UITextView`使用`NSString`而不是`NSMutableString`当其内容经常更改时？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-31T23:44:16.860

从一般编码的角度来看：

设置属性时，会调用属性设置器方法。这样，控件能够在属性更改时注意到，以便它可以使用新内容重绘控件。

如果属性是一个可变对象，你可以改变它的内容并且控件不会得到任何通知这已经发生了，所以它不知道控件需要被重绘。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T00:11:45.227

传递不可变对象而不是允许外部类访问私有可变变量是 Cocoa 中的一般模式。你会在 NSArray 和 NSDictionary 等集合类中看到同样的情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-21T01:23:58.937

当然，你没有理由不能改变它所指向的东西！因为成员只是一个指针，所以您可以根据需要将字符串替换为`NSMutableString`自己。

如果您想将大量文本附加到视图中，这可能是一种更有效的方法。

```
- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {
        [myTextView setText:[[NSMutableString alloc] init]];
    }
    return self;
} 
```

只要确保仍然调用 setText ，因为正如@Guffa 在他的回答中解释的那样，否则视图将不知道重绘自己。

```
- (void)appendText:(NSString*)text 
{
    NSMutableString *dispText = (NSMutableString*)[myTextView text];
    [dispText appendString:text];

    [myTextView setText:dispText]; // notify myTextView of text change!    
} 
```

# c++ - 宏使用取决于整数

> ID：933020
> 
> 赞同：1
> 
> 时间：2009-05-31T22:27:03.223
> 
> 标签：c++, opengl, macros

我必须在函数内多次使用宏，需要使用的宏取决于我传递给函数的数字。

例如

```
 function(int number) { 
    switch(number) { 
       case 0: doStuff(MACRO0); break; 
       case 1: doStuff(MACRO1); break; 
    } 
  } 
```

问题是：对于每个使用相同宏的 switch 语句，我有很多事情要做。有没有比在 switch 语句中包含所有这些东西更优雅的解决方案？就像将宏本身传递给函数一样？我已经阅读了 C++ 中类似 eval() 的方法，但它们对我来说感觉不对。另一种方法可以确定宏扩展的内容，但我没有找到任何相关信息。

哦，实际上是openGL。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-31T22:31:31.843

我会使用一个函数对象

```
struct Method1 {
    void operator()() { ... }
};

template<typename Method>
void function(Method m) {
    ...
    m();
    ...
}

int main() {
    function(Method1());
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-31T22:34:06.313

这在很大程度上取决于`MACRO1`扩展到什么。如果它是一个常量，您可以只在 of 之外调用该函数，`switch`或者执行多个失败案例。如果它取决于当地情况，那么您每次都必须对其进行评估。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-31T22:54:29.517

除了上述建议之外，我经常发现使用虚拟继承可以摆脱长条件，尤其是 switch-over-enums 类型的代码。我不确定你的具体情况是什么，所以我不确定他的适用性如何，但假设上面是

```
enum StyleID { STYLE0 = 0, STYLE1, STYLE2 /* ... */ };

void drawStyle(StyleID id) {
  switch(id) {
     case STYLE1: doDraw(MACROSTYLE1); break;
     /* ... */
  };
} 
```

可以通过虚拟继承避免长的开关块：

```
class StyleInterface {
   /* some methods */
   virtual void doDraw() = 0;
};

class Style1 : public StyleInterface {
   /* concrete impl */
   virtual void doDraw() { doDraw(MACROSTYLE1); }
};

void drawStyle(StyleInterface* id) {
    id->doDraw();
} 
```

# google-app-engine - 对 *User* 类型的查询的 Google Datastore 问题

> ID：933023
> 
> 赞同：1
> 
> 时间：2009-05-31T22:28:27.450
> 
> 标签：google-app-engine, jdo, google-cloud-datastore, jdoql

在[这个](https://stackoverflow.com/questions/764337/how-to-fetch-data-by-user-from-google-datastore)问题上，我解决了查询 Google Datastore 以按用户（com.google.appengine.api.users.User）检索内容的问题，如下所示：

```
User user = userService.getCurrentUser();
String select_query = "select from " + Greeting.class.getName(); 
Query query = pm.newQuery(select_query); 
query.setFilter("author == paramAuthor"); 
query.declareParameters("java.lang.String paramAuthor"); 
greetings = (List<Greeting>) query.execute(user); 
```

上面的工作正常 - 但经过一些混乱后，我意识到这种语法不是很实用，因为需要构建更复杂的查询 - 所以我决定手动构建我的过滤器，现在我得到了例如以下内容（其中过滤器通常作为字符串变量传入，但为了简单起见，现在是内联的）：

```
User user = userService.getCurrentUser();    
String select_query = "select from " + Greeting.class.getName(); 
Query query = pm.newQuery(select_query); 
query.setFilter("author == '"+ user.getEmail() +"'");  
greetings = (List<Greeting>) query.execute(); 
```

显然，即使[JDOQL 支持](http://code.google.com/appengine/docs/java/datastore/queriesandindexes.html)`field = 'value'`这种语法并且它在其他字段（字符串类型和枚举）上也能正常工作，这也不起作用。另一个奇怪的事情是，查看应用引擎仪表板中的数据查看器，“作者”字段存储为*用户*类型，但值为“user@gmail.com”，然后当我将其设置为参数时（上面的情况很好）我将参数声明为一个字符串，然后传递一个用户（用户）的实例，该实例用一个简单的序列化（我猜）。*`toString()`*

 *有人知道吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T03:37:33.550

在查询语言中使用字符串替换*总是*一个坏主意。用户很容易破坏并弄乱您的环境，并且会引入一整套编码问题等。

您之前的参数替换方法有什么问题？据我所知，它支持一切，并且回避了任何解析问题。至于知道要传递多少个参数的问题，您可以使用 Query.executeWithMap 或 Query.executeWithArray 来执行带有未知数量参数的查询。

# database - 在数据库端实现 Comet

> ID：933029
> 
> 赞同：2
> 
> 时间：2009-05-31T22:31:51.670
> 
> 标签：database, comet, server-side

这更多是出于好奇和“供将来参考”，但是 Comet 在数据库端是如何实现的呢？我知道大多数实现都使用长期存在的 HTTP 请求来“等待”直到数据可用，但是这是如何在服务器端完成的呢？Web 服务器如何知道新数据何时可用？它是否不断轮询数据库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-31T22:56:54.723

这在很大程度上取决于应用程序。最可能的实现是某种消息传递系统。

很可能，您的服务器端代码将包含很多部分：

*   一些处理传入请求的应用服务器，
*   一个（单独的）comet 服务器，处理所有与客户端的开放连接，
*   数据库，以及
*   某种消息传递基础设施

最后一个，消息传递基础设施确实是关键。这为应用服务器提供了一种与彗星服务器通信的方式。因此，当请求进入应用服务器时，应用服务器会将消息放入消息队列中，告诉彗星服务器通知正确的客户端

同样，如何实现消息传递非常依赖于应用程序。一个非常简单的实现将只使用一个名为的数据库表`messages`并对其进行轮询。

但是根据您计划使用的堆栈，应该有更复杂的工具可用。

在 Rails 中，我使用的是[Juggernaut](http://juggernaut.rubyforge.org/)，它只是侦听某个网络端口。每当有数据要发送时，Rails 应用程序服务器都会打开与这个主宰推送服务器的连接，并告诉它要发送什么给客户端。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-31T23:08:34.480

你用的是什么数据库？如果它支持许多 RDBMS 以某种形式或形式执行的**触发器**，那么您可以让触发器触发一个事件，该事件实际上告诉 HTTP 请求发送适当的响应。

触发器消除了轮询的需要……轮询通常不是最好的主意。

[PostgreSQL](http://www.postgresql.org/docs/8.1/interactive/triggers.html)似乎有很好的支持（甚至是 PL/Python）。

# java - Java 类型转换和继承

> ID：933037
> 
> 赞同：2
> 
> 时间：2009-05-31T22:39:28.457
> 
> 标签：java, oop, casting

我想要一种从 java Date 对象获取当前 unix 时间戳的好方法，这是我的解决方案：

```
public class Date extends java.util.Date {

    public int getUnixTimeStamp() {
        int unixtimestamp = (int) (this.getTime() * .001);
        return unixtimestamp;
    }
} 
```

这很好用，但问题是当我尝试将 java Date 对象转换为我的自定义日期类时，即：

```
Calendar foo = Calendar.getInstance();
foo.set(0, 0, 0, 12, 30);
myapp.Date foo2 = (myapp.Date)foo.getTime(); 
```

这会生成：线程“main”中的异常 java.lang.ClassCastException: java.util.Date cannot be cast to myapp.Date

我理解为什么会出现这个异常，但是有没有办法将超类转换为子类？如果没有，您将如何实现 unixtimestamp 方法？我在我的应用程序中经常使用它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-31T22:47:34.867

您不能在子类中强制转换超类，因为子类可能具有比超类更大的接口，这意味着子类可以具有超类没有的 getUnixTimeStamp() 等函数。在您的示例中，这意味着您尝试在 java.util.Date 上调用 getUnixTimeStamp。

您可以在此处使用委托或组合来代替继承。

这意味着你有一个类

```
public class Date {

    private java.util.date date;

    public Date(java.util.Date date) {
        this.date = date
    }

    public int getUnixTimeStamp() {
        int unixtimestamp = (int) ((this.date.getTime()) * .001);
        return unixtimestamp;
    } 
```

}

通过这种方式，您不会将日期转换为您在 java.util.date 周围创建一个类的日期。

如果您只使用这个函数，那么创建一个返回更改日期的静态实用函数 getUnixTime(Date date) 可能是一个更简单的解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-31T22:48:27.517

如果您热衷于拥有您的子类，请在您的类中实现一个构造函数，`Date`并在其中`java.util.Date foo`调用; 然后不是强制转换，而是调用来实例化您的子类。`super``foo.getTime()``Date(foo)`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-31T22:48:19.017

为什么你需要让这个类扩展 java.util.Date 呢？制作一个静态函数，它接受一个 Date 并返回该日期的 unix 时间戳。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-31T22:50:31.053

如前所述，您可以通过让类的构造函数将时间作为输入来实现它。像这样的东西：

公共课日期{

```
long unixtimestamp;

public Date(long time) {
    unixtimestamp = (long) (time * .001);
}

public long getUnixTimeStamp() {
    return unixtimestamp;
} 
```

}

另一种选择是创建一个转换它的静态方法。这取决于您是否计划在课程中添加其他类似的功能。如果不是，那么静态方法可能会更好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-31T22:53:11.313

不，如果引用不指向派生类型的实例，则不能将类型转换为更派生的类型。

`Date`返回的对象`Calendar.getTime()`不是您的`Date`对象之一，并且它不具有这些对象所具有的其他属性和行为。

您可以修改 Date 类以使用组合而不是继承，例如

```
class Date {

    private java.util.Date date;

    public Date( java.util.Date date ) {
        this.date = date;
    }

    public int getUnixTimestamp() {
        return (int)( date.getTime() * .001 );
    }

} 
```

# sql - SQL Join 和 Count 不能正确 GROUP BY？

> ID：933040
> 
> 赞同：4
> 
> 时间：2009-05-31T22:43:23.830
> 
> 标签：sql, join, count, group-by

因此，假设我想选择我所有博客文章的 ID，然后计算与该博客文章相关的评论数，我如何使用 GROUP BY 或 ORDER BY 以便返回的列表按每篇文章的评论数排序?

我有这个查询返回数据但不是按我想要的顺序？更改 group by 没有区别：

```
SELECT p.ID, count(c.comment_ID) 
FROM wp_posts p, wp_comments c 
WHERE p.ID = c.comment_post_ID 
GROUP BY c.comment_post_ID; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-31T22:49:53.707

我不熟悉 pre-SQL92 的语法，所以我会用我熟悉的方式来表达它：

```
SELECT c.comment_post_ID, COUNT(c.comment_ID)
FROM wp_comments c
GROUP BY c.comment_post_ID
ORDER BY COUNT(c.comment_ID) -- ASC or DESC 
```

你用的是什么数据库引擎？至少在 SQL Server 中，除非您从帖子表中提取更多数据，否则不需要连接。加入：

```
SELECT p.ID, COUNT(c.comment_ID)
FROM wp_posts p
JOIN wp_comments c ON c.comment_post_ID = p.ID
GROUP BY p.ID
ORDER BY COUNT(c.comment_ID) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-31T22:45:36.353

```
SELECT p.ID, count(c.comment_ID) AS [count]
FROM wp_posts p, wp_comments c 
WHERE p.ID = c.comment_post_ID 
GROUP BY c.comment_post_ID;
ORDER BY [count] DESC 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T23:46:47.763

可能评论表上没有相关数据，所以请尝试按帖子ID分组，并请学习JOIN语句，它很有帮助并且产生更好的结果

```
SELECT p.ID, count(c.comment_ID) 
FROM wp_posts p
LEFT JOIN wp_comments c ON (p.ID = c.comment_post_ID)
GROUP BY p.ID 
```

我在 SQL 查询过程中也遇到过这种情况 :)

# com - vtable 有问题——是我还是图书馆？

> ID：933041
> 
> 赞同：1
> 
> 时间：2009-05-31T22:43:37.137
> 
> 标签：com, dll, vtable

我正在尝试使用一个使用 vtable 的 COM 库。然而，在我调用函数之后，堆栈发生了一些奇怪的事情，这告诉我我做错了什么。

带有 vtable 定义的头文件粘贴在此处：[pastebin.com/m2d66c18c](http://pastebin.com/m2d66c18c)（特别参见从第 810 行开始的代码）。此处粘贴了一个示例：[pastebin.com/m1b46e662](http://pastebin.com/m1b46e662)。

该表正在填充函数的正确位置，但是当我调用函数时，它们似乎在错误的位置查找堆栈上的参数。此外，在调用表中的函数后，堆栈被弄乱了，我的程序崩溃了。我尝试将函数类型更改为两者`__cdecl`，`__stdcall`但这无济于事。

要么是我的代码，要么是库，编写库的公司还没有回复我——因为这是周末，我假设。此外，还有一个使用该库的演示应用程序，它可以工作——所以我认为这是我的代码/编译器 (gcc)/其他东西，而不是库。

是不是为了使用 COM 库，您需要做一些特别的事情？

# python - Python 模块全局变量与 __init__ 全局变量

> ID：933042
> 
> 赞同：4
> 
> 时间：2009-05-31T22:44:09.757
> 
> 标签：python, global

抱歉，有些困惑的 Python 新手问题。假设我有一个名为`animals.py`....的模块

```
globvar = 1

class dog: 
   def bark(self):
      print globvar

class cat:
   def miaow(self):
      print globvar 
```

这和这有什么区别

```
class dog:
   def __init__(self):
      global globvar

   def bark(self):
      print globvar

class cat:
   def miaow(self):
      print globvar 
```

假设我总是先实例化一只狗？

我想我的问题是，有什么区别吗？在第二个示例中，是否像在第一个示例中一样启动`dog`创建模块级别，其行为相同并具有相同的范围？`globvar`

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-31T23:12:13.820

`global`不会创建一个新变量，它只是说明这个名称应该引用一个全局变量而不是一个局部变量。通常对函数/类/中变量的赋值是指局部变量。例如采用这样的函数：

```
def increment(n)
  # this creates a new local m
  m = n+1
  return m 
```

这里创建了一个新的局部变量`m`，即使可能`m`已经存在一个全局变量。这是您通常想要的，因为某些函数调用不应意外修改周围范围内的变量。如果你确实想修改一个全局变量而不是创建一个新的局部变量，你可以使用`global`关键字：

```
def increment(n)
  global increment_calls
  increment_calls += 1
  return n+1 
```

在您`global`的构造函数中不创建任何变量的情况下，进一步尝试访问`globvar`失败：

```
>>> import animals
>>> d = animals.dog()
>>> d.bark()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "animals.py", line 7, in bark
    print globvar
NameError: global name 'globvar' is not defined 
```

但是如果你真的`globvar`在构造函数中赋值，当你创建狗时会创建一个模块全局变量：

```
class dog:
   def __init__(self):
      global globvar
      globvar = 1
... 
```

执行：

```
>>> import animals
>>> d = animals.dog()
>>> d.bark()
1
>>> print animals.globvar
1 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-31T22:53:45.807

不，该`global`语句仅在您*分配*给方法或函数中的全局变量时才重要。所以这`__init__`无关紧要——它不会**创建**全局，因为它没有分配任何东西给它。

# python - Python 正则表达式与字符串替换相结合？

> ID：933046
> 
> 赞同：-1
> 
> 时间：2009-05-31T22:47:24.993
> 
> 标签：python, regex

我想知道是否可以将字符串替换与 python re 模块一起使用？

例如，我使用 optparse 并有一个名为 options.hostname 的变量，每次用户执行脚本时都会更改。

我在日志文件的每一行中有以下正则表达式匹配 3 个字符串。

```
 match = re.search (r'^\[(\d+)\] (SERVICE NOTIFICATION:).*(\bCRITICAL)', line) 
```

我希望能够通过匹配 options.hostname 作为最后一个匹配组来执行字符串替换，但是我无法使任何变体起作用。这可能吗？

```
 match = re.search (r'^\[(\d+)\] (SERVICE NOTIFICATION:).*(\bCRITICAL).*(s%), line) % options.hostname 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-31T22:52:15.483

```
 match = re.search (r'^\[(\d+)\] (SERVICE NOTIFICATION:).*(\bCRITICAL).*(%s)'
                    % options.hostname, line) 
```

# c# - 实体框架外键（或缺少外键）

> ID：933052
> 
> 赞同：2
> 
> 时间：2009-05-31T22:49:19.420
> 
> 标签：c#, asp.net-mvc, entity-framework, efpocoadapter

所以我一直在倾注这段代码，试图弄清楚这一点......我在 .NET 3.5 SP1 中使用 Entity Framework 1.0 和 ASP.NET MVC 和 EFPocoAdapter（所以单独的 Poco 类）。

所以我有以下控制器之一的代码：

```
 [AcceptVerbs(HttpVerbs.Post)]
    public ActionResult EditUser(int? id, FormCollection form)
    {
        var user = new User();

        using (var db = new UMSEntities { DeferredLoadingEnabled = false })
        {
            if (id != null)
            {
                user = db.Users.FirstOrDefault(p => p.UserID.Equals((int) id));
                db.LoadProperty(user, p => p.UserProfiles);
                db.LoadProperty(user, p => p.UserCompanyProfile);
            }
            else
            {
                user.UserGuid = Guid.NewGuid();
                user.DateCreated = DateTime.Now;
                user.DateLastActivity = DateTime.Now;
                user.DateModified = DateTime.Now;
                user.Password = "demo";
                user.Version = 0;
                user.SecretAnswer = "";
                user.SecretQuestion = "";
                user.IsApproved = true;
                user.IsActive = true;

                user.UserProfiles = new UserProfile();
                user.UserCompanyProfile = new UserCompanyProfile
                      {
                          EmployeeID = "",
                          HireDate = DateTime.Now,
                          Title = "",
                          UserCode = "",
                          Company = db.Companies.First(p => p.CompanyID == 8)
                      };

                db.Users.InsertOnSaveChanges(user);

            }

            TryUpdateModel(user);

            db.SaveChanges();
        } 
```

编辑现有用户非常完美（注意 id != null）。但是，它是添加新用户的代码部分。它一直有效，直到我到达将 UserCompanyProfile 添加到用户对象的代码部分。如果我将此代码注释掉，它就可以正常工作。当我尝试通过查询数据库将公司附加到 UserCompanyProfile 时出现问题 - 我收到此错误。

```
Entities in 'UMSEntities.UserCompanyProfiles' participate in the 'FK__UserCompa__Compa__25869641' relationship. 0 related 'Companies' were found. 1 'Companies' is expected. 
```

顺便说一句，它实际上返回了一个 Company 对象（它的类型是 PocoProxies.CompanyProxy）。任何帮助都将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T19:47:20.467

所以我想通了，哦，我的话是不是花了我很长时间......也很明显。我不需要查询公司并通过 UserCompanyProfile 关联它，而是需要以相反的方式关联它：

```
 // ...
                user.UserProfiles = new UserProfile();
                user.UserCompanyProfile = new UserCompanyProfile
                      {
                          EmployeeID = "",
                          HireDate = DateTime.Now,
                          Title = "",
                          UserCode = ""
                      };

                var company = db.Companies.First(p => p.CompanyID.Equals(16));
                company.UserCompanyProfile.Add(user.UserCompanyProfile);

                db.Users.InsertOnSaveChanges(user);
                // ... 
```

希望这对其他人有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T00:00:28.120

是否存在 ID 为 8 的公司？我会说更改您的代码以首先获得正确的公司，我敢打赌问题会消失。

你的Lamda表达可能有问题，但我对他们还不够了解。

# java - 控制器是否创建新视图？

> ID：933065
> 
> 赞同：3
> 
> 时间：2009-05-31T22:56:21.527
> 
> 标签：java, model-view-controller, dependency-injection, dependencies

我正在开发一个简单的 Java 应用程序。目前，我有两个视图，一个用于登录，另一个用于登录。

所以我的问题是，一旦用户登录，登录视图的控制器是否应该创建第二个视图？

问题是，第一个控制器需要知道第二个视图的每个依赖项......

编辑：这**不是**一个网络应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T09:20:04.850

我认为 LoginController 根本不应该创建 SecondView。用户登录后，LoginController 应该触发登录成功的事件，并且任何关心该事件的控制器都应该采取适当的措施。

如果您使用 DI，则理想情况下希望将视图注入控制器。

不太清楚你的最后一句话是什么意思，所以没有回答。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T10:14:48.483

如果您的对象需要实例化一个类，但您不希望它依赖于实例化类的细节，请注入一个工厂（如[您所建议](https://stackoverflow.com/questions/933065/does-a-controller-create-new-views/933116#933116)的那样）。

我喜欢使用接口，所以我可以插入我的依赖项的不同实现。这是一个例子：

```
public class RealLoginController implements LoginController {
    private LoginViewFactory viewFactory;

    public LoginController(LoginViewFactory viewFactory) {
        this.viewFactory = viewFactory;
    }

    public ModelAndView handleRequest(HttpServletRequest request,
                                      HttpServletResponse response) {
         if (isLoggedIn()) {
             return viewFactory.createLoggedInView();
         } else {
             return viewFactory.createLoggedOutView();
        }
    }

    // ...
}

public class RealLoggedInView implements LoginView {
    // Implementation for rendering stuff
}

public class RealLoggedOutView implements LoginView {
    // Implementation for rendering stuff
}

public interface LoginViewFactory {
    public LoginView createLoggedInView();
    public LoginView createLoggedInView();
}

public class RealLoginViewFactory implements LoginViewFactory {
    private FooModel fooEngine;
    private BarConfig barConfig;

    public RealLoginViewFactory(FooModel fooLayer, BarConfig barConfig) {
        this.fooEngine = fooEngine;
        this.barConfig = barConfig;
    }

    public LoginView createLoggedInView() {
        if (fooEngine.hasBaz()) {
            return new RealLoginView(barCongig.getQux());
        } else {
            return new RealLoginView(barCongig.getQux(),
                                     fooEngine.getBaz());
        }
    }

    public LoginView createLoggedOutView() {
        // ...
    }
}

public class RealLoginController implements LoginController {
    private LoginViewFactory viewFactory;

    public LoginController(LoginViewFactory viewFactory) {
        this.viewFactory = viewFactory;
    }

    public ModelAndView handleRequest(HttpServletRequest request,
                                      HttpServletResponse response) {
         if (isLoggedIn()) {
             return viewFactory.createLoggedInView();
         } else {
             return viewFactory.createLoggedOutView();
        }
    }

    // ...
} 
```

然后，您可以将控制器与您喜欢的任何视图一起使用：

```
public class LoginControllerTest {
    public void testSomething() {
        // ...
        controller = new RealLoginController(fakeViewFactory);
        assertHasTag("td#row1", controller.getRenderedStuff());
        // ...
    }
} 
```

如果您不需要复杂的实例化逻辑并且您的框架知道如何通过名称为您获取依赖项，则您可能能够避免该问题（如[bpappa 建议的那样）。](https://stackoverflow.com/questions/933065/does-a-controller-create-new-views/933110#933110)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-31T23:35:48.670

这是用 Spring MVC 吗？

如果您使用没有注释的 Spring MVC 2.5 或更低版本，则在 handleRequest 方法结束时，会返回一个 ModelAndView 对象。这包含视图信息（无论是重定向视图中的视图本身，还是只是视图的名称）。您可以根据某些逻辑有条件地返回不同的视图。例如 -

```
handleRequest(HttpServletRequest request, HttpServletResponse response) {
     // get user from session
     if (user.isLoggedIn())
         return new ModelAndView("loggedInView");
     else
         return new ModelAndView("notLoggedInView");
} 
```

如果这是一个新项目，并且您可以访问 Java 1.5，我建议您使用[基于注释的 Spring MVC](http://blog.springsource.com/2007/11/14/annotated-web-mvc-controllers-in-spring-25/)，因为这样您就可以返回任何您想要的内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-31T23:38:59.163

我认为工厂可能会做到这一点：

```
public class LoginViewFactory
{
    private depA;
    private depB;

    public LoginViewFactory(dependencyA, dependencyB)
    {
        depA = dependencyA;
        depB = dependencyB;
    }

    LoginView create()
    {
        return new LoginView(depA, depB);
    }
}

//and then pass this factory to my controller
new Controller(new LoginViewFactory(new A(), new B()); 
```

你怎么看？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T06:04:57.867

您应该采用与 Spring 相同的方法，并让您的控制器返回一个视图名称。然后让另一个类处理基于视图名称创建视图。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T09:13:54.020

我认为你的第一个“视图”（登录页面）可以被认为是一个静态页面，因为它通常是第一个可访问的页面，所以它后面可能没有控制器。

但是假设您的 Web 应用程序中还有一些其他页面，并假设您实际上有一个控制器 A（一种 DispatchController ）将用户引导到登录页面。

提交此页面后，您通常会有一个不同的控制器（例如 LoginController ），它将引导（如果登录成功）用户到您的第二个视图页面（登录页面）

所以底线是：对我来说，看起来你需要两个控制器，每个控制器都有不同的责任。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-03T10:24:49.617

如果您的登录是表单 POST（应该是），我会在成功登录后重定向到主页。

这样一来，如果用户在登录后点击主页上的刷新，他们就不会收到有关重新提交 POST 的浏览器警告。
如果他们单击主页上的链接然后单击后退按钮，则同样适用。

在 Spring 中，您可以使用这种语法来做到这一点。

```
return new ModelAndView(new RedirectView(homepage, true), model); 
```

“主页”参数将在您的 spring 配置中配置并作为参数注入 - 它应该是您网站主页的相对 URL。

因为您正在重定向主页控制器，所以这会处理您的依赖问题。

# dll - 将 .dll.a 转换为 dll

> ID：933074
> 
> 赞同：0
> 
> 时间：2009-05-31T23:05:40.837
> 
> 标签：dll

我下载了一个自动跟踪库以在我的 java 项目中使用，但它只包含（libautotrace.a、libautotrace.la、libautotrace.dll.a 和标头）

我的问题：是否可以将 libautotrace.dll.a 转换为 dll 库？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T02:25:21.840

You can not.

The dot-a files you have were compiled for a Unix system, and can not be directly converted to a Windows format.

You will need to find a windows-native build or the source code to build it yourself.

# c# - 在 C# 中显示随机数

> ID：933077
> 
> 赞同：2
> 
> 时间：2009-05-31T23:07:40.630
> 
> 标签：c#, random

我正在尝试设计一个可以猜测数字的代码。我定义了要在列表框中显示的数字的范围。我开始写 Random(1,10) 但如果我输入 11，它仍然会写在我的列表框中。我怎样才能写出从我的范围中选择的数字，即 1-10？

这是我的代码的一部分：

```
 private void btnOk_Click(object sender, EventArgs e)
      {

        string yourNumber;
        yourNumber = textBox1.Text.Trim();

        int returnNumber = RandomNumber(1, 10);                 
        int.TryParse(textBox1.Text, out returnNumber);
        listBox1.Items.Add(returnNumber);            
      } 
```

## 附加问题

如果我想显示一个数字范围，例如 1-10，我该怎么做？用户将键入 11 程序不会接受。

我做了这样的事情：

```
 int returnNumber = RandomNumber(1, 10);    

        string yourNumber;
        yourNumber = textBox1.Text.Trim();  

        if(Int32.TryParse(textBox1.Text>=1)) && (Int32.TryParse(textBox1.Text<=10));
        {
        listBox1.Items.Add(yourNumber);
        textBox1.Text = string.Empty;
        } 
```

程序有问题。

## 更新

对于 Nathaniel，我尝试了这个：

```
int returnNumber=RandomNumber(1,10);
int counter=1;
int yourNumber;

Int32.TryParse(textBox1.Text.Trim(), out yourNumber);
if (yourNumber >=1 && yourNumber <= 10)
{
  listBox1.Items.Add(yourNumber);
}
else
{
  MessageBox.Show("Please enter a number between 1-10");
} 
```

我想做的是设计一个猜数字的程序。所以这是第一部分。

## 更新

这是我的最终代码，可以改进吗？我认为接下来我要做的就是限制用户输入的次数。这意味着，他们只能猜出正确的数字 3 次或 5 次。不知道在哪里实施

```
 namespace Guessing_Game
   {
  public partial class Form1 : Form
   {
    private static int randomNumber;
    private const int rangeNumberMin = 1;
    private const int rangeNumberMax = 10;

    public Form1()
    {
        InitializeComponent();
        randomNumber = GenerateNumber(rangeNumberMin, rangeNumberMax);
    }

    private int GenerateNumber(int min,int max)
    {
        Random random = new Random();
        return random.Next(min, max);
    }

    private void btnOk_Click(object sender, EventArgs e)
    {
        int yourNumber = 0;

        Int32.TryParse(textBox1.Text.Trim(), out yourNumber);

        if (yourNumber>= rangeNumberMin && yourNumber<=rangeNumberMax)
        {
            listBox1.Items.Add(yourNumber);
            if (yourNumber > randomNumber)
            {
                listBox2.Items.Add("No the Magic Number is lower than your number");
            }

            if (yourNumber < randomNumber)
            {
                listBox2.Items.Add("No, the Magic Number is higher than your number");
            }

            if(yourNumber==randomNumber)
            {
                listBox2.Items.Add("You guessed the Magic Number!");
                btnRestart.Enabled = true;
            }
        }
        else
        {
            MessageBox.Show("Please enter a number between " + rangeNumberMin + " to " + rangeNumberMax);
        }
    }

    private void btnRestart_Click(object sender, EventArgs e)
    {
        listBox2.Items.Clear();
        listBox1.Items.Clear();
        textBox1.Text = null;
        randomNumber = GenerateNumber(rangeNumberMin, rangeNumberMax);
        btnRestart.Enabled = false;
    }
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-31T23:11:47.563

该行：

```
int returnNunmber = RandomNumber(1, 10); 
```

什么都不做，因为在下一行中，returnNumber 用作输出变量，它将是 textBox1 中的任何数字。去除那个

```
int.TryParse(textBox1.Text, out returnNumber); 
```

行，它将向您的列表框添加一个从 1 到 10 的随机数。

编辑:::: 要回答您的其他问题，请尝试：

```
private void btnOk_Click(object sender, EventArgs e)
  {
    string yourNumber;
    yourNumber = textBox1.Text.Trim();
    int returnNumber;    
    int.TryParse(textBox1.Text, out returnNumber);
    if( returnNumber < 1 || returnNumber > 10) {
      returnNumber = RandomNumber(1, 10);
    }
    listBox1.Items.Add(returnNumber);            
  } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-10T12:43:26.347

让我们一块一块地看：

```
int returnNumber = RandomNumber(1, 10); 
```

没有内置`RandomNumber`功能；请注意，对于`Random`该类，最终值是独占的，因此对于范围内的数字，您需要类似以下内容：

```
static readonly Random rand = new Random();
static int Random(int min, int max) {
    if(max < min) throw new ArgumentOutOfRangeException("max");
    lock(rand) {
        return rand.Next(min, max + 1);    
    }
} 
```

但是，您随后会完全丢弃此值：

```
int.TryParse(textBox1.Text, out returnNumber); 
```

的使用`out`意味着`returnNumber`完全忽略之前的值。我不确定您的意图是什么，但您*似乎*只想检查该值：

```
if(int.TryParse(textBox1.Text, out returnNumber)
      && returnNumber >= 1 && returnNumber <= 10)
{
    listBox1.Items.Add(returnNumber);
} 
```

我试着看最后一个例子，但真的不清楚你想做什么——你能澄清一下吗？

* * *

（在问题编辑和评论后编辑）

您将需要一个计数器，为失败的尝试增加该计数器 - 例如：

```
using System;
using System.Drawing;
using System.Windows.Forms;
class MyForm : Form {
    Button btn;
    ListBox lst;
    TextBox tb;
    const int MaxTries = 3, MaxNumber = 10;
    int targetNumber, guessCount = 0;
    public MyForm() {
        targetNumber = new Random().Next(1, MaxNumber + 1);
        Text = "Guess a number";
        Icon = SystemIcons.Question;
        Controls.Add(lst = new ListBox {Dock=DockStyle.Fill});
        Controls.Add(btn = new Button {Text="Guess",Dock=DockStyle.Top});
        Controls.Add(tb = new TextBox {Dock=DockStyle.Top});
        btn.Click += btn_Click;
    }

    void  btn_Click(object sender, EventArgs e) {
        int userNumber;
        if (int.TryParse(tb.Text.Trim(), out userNumber)) {
            if (userNumber < 1 || userNumber > MaxNumber) {
                lst.Items.Add("Did I mention... between 1 and " + MaxNumber);
            } else {
                if (userNumber == targetNumber) {
                    lst.Items.Add("Well done! You guessed well");
                    btn.Enabled = false; // all done
                } else {
                    lst.Items.Add(targetNumber < userNumber
                        ? "Try a bit lower" : @"It is bigger than that");
                    if (++guessCount >= MaxTries) {
                        btn.Enabled = false;
                        lst.Items.Add("Oops, should have picked more wisely");
                    }
                }
            }
        } else {
            lst.Items.Add("Nice; now give me a number");
        }
    }
    [STAThread]
    static void Main() {
        Application.EnableVisualStyles();
        Application.SetCompatibleTextRenderingDefault(false);
        Application.Run(new MyForm());
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-10T18:53:17.990

对您的代码进行一些小的更改，压缩几行并添加限制代码，利用猜测列表作为计数器：

```
namespace Guessing_Game
{
   public partial class Form1 : Form
   {
        private static int randomNumber;
        private const int rangeNumberMin = 1;
        private const int rangeNumberMax = 10;
        private const int maxGuesses = 5;

        public Form1()
        {
            InitializeComponent();
            randomNumber = GenerateNumber(rangeNumberMin, rangeNumberMax);
        }

        private int GenerateNumber(int min,int max)
        {
            Random random = new Random();
            return random.Next(min, max);
        }

        private void btnOk_Click(object sender, EventArgs e)
        {
            int yourNumber = 0;

            if (Int32.TryParse(textBox1.Text.Trim(), out yourNumber) &&
               yourNumber>= rangeNumberMin && yourNumber<=rangeNumberMax)
            {

                listBox1.Items.Add(yourNumber);

                if (yourNumber > randomNumber)
                {
                    listBox2.Items.Add("No the Magic Number is lower than your number");
                }
                else if (yourNumber < randomNumber)
                {
                    listBox2.Items.Add("No, the Magic Number is higher than your number");
                }
                else
                {
                    listBox2.Items.Add("You guessed the Magic Number!");
                    textBox1.Enabled = false;
                    btnOk.Enable = false;
                    btnRestart.Enabled = true;
                }

                //Will stop on the 5th guess, but guards the case that there were more than 5 guesses
                if(listBox1.Items.Count >= maxGuesses && yourNumber != randomNumber)
                { 
                    listBox2.Items.Add("You are out of guesses!");
                    textBox1.Enabled = false;
                    btnOk.Enable = false;
                    btnRestart.Enabled = true;
                }
            }
            else
            {
                MessageBox.Show("Please enter a number between " + rangeNumberMin + " to " + rangeNumberMax);
            }
        }

        private void btnRestart_Click(object sender, EventArgs e)
        {
            listBox2.Items.Clear();
            listBox1.Items.Clear();
            textBox1.Text = null;
            randomNumber = GenerateNumber(rangeNumberMin, rangeNumberMax);
            btnRestart.Enabled = false;
            textBox1.Enabled = true;
            btnOk.Enable = true;

        }
    }
} 
```

编辑以防止在最后一次猜测中正确猜测数字时出现“您已猜中”消息。

# php - 在文件未上传的 PHP 中尝试 catch 语句

> ID：933081
> 
> 赞同：32
> 
> 时间：2009-05-31T23:11:16.427
> 
> 标签：php, exception, try-catch

我了解 try-catch 语句的作用，但是通过阅读 php.net 上的文档，我无法在自己的代码中实现一个。我需要一个真实的例子来帮助我理解。

如果上传不成功，如何将此示例转换为 try-catch 语句？

```
$move = move_uploaded_file($_FILES['file']['tmp_name'], $_SERVER['DOCUMENT_ROOT'].'/uploads/'.$_FILES['file']['name']);

if (!$move) {
    die ('File didn\'t upload');
} else {            
    //opens the uploaded file for extraction
    echo 'Upload Complete!';
} 
```

这可能不是一个很好的例子，但我们将不胜感激。

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2009-05-31T23:15:42.440

你可以这样做。

```
try {
    //throw exception if can't move the file
    if (!move_uploaded_file( ... )) {
        throw new Exception('Could not move file');
    }

    //do some more things with the file which may also throw an exception
    //...

    //ok if got here
    echo "Upload Complete!";
} catch (Exception $e) {
    die ('File did not upload: ' . $e->getMessage());
} 
```

上面的例子有点无意义，但你应该明白了。请注意，您可以从任何地方（例如，在您通过 try{} 调用的函数/方法中）抛出异常，它们将向上传播。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-31T23:18:22.480

好吧，如果你想使用异常，你可以这样做：

```
function handleUpload() {

    $move = move_uploaded_file($_FILES['file']['tmp_name'], $_SERVER['DOCUMENT_ROOT']."/uploads/".$_FILES['file']['name']);

    if (!$move) {
       throw new Exception('File Didnt Upload');
    }

}

try {
   handleUpload();
   echo "File Uploaded Successfully";
} catch(Exception $ex) {
   die($ex->getMessage);
} 
```

我知道这可能看起来很臃肿 - 但您可以从调用堆栈中的任何位置调用该方法，并在任何时候捕获异常。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-31T23:19:01.917

`try-catch`语句用于处理异常。我不相信该函数`move_uploaded_files`可以抛出异常，因此我认为您编写的代码是正确的。调用后，您查看返回码。如果为假，则结束处理，否则报告成功。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-09-23T07:06:02.610

根据 PHPbug 中的类似帖子，只有 OO 代码（面向对象的代码）会引发异常。这意味着诸如 move_uploaded_file 之类的函数不会抛出它们自己的异常，但其他一些代码会。

# python - 裁剪 FFT 矩阵

> ID：933088
> 
> 赞同：2
> 
> 时间：2009-05-31T23:15:35.170
> 
> 标签：python, audio, signal-processing, fft

音频处理对我来说很新鲜。目前使用 Python Numpy 处理波形文件。计算 FFT 矩阵后，我得到了不存在频率的噪声功率值。我对可视化数据感兴趣，准确性不是一个高优先级。是否有一种安全的方法来计算裁剪值以删除这些值，或者我应该使用每个样本集的所有 FFT 矩阵来得出一个平均数？

问候

编辑：

```
 from numpy import *
    import wave
    import pymedia.audio.sound as sound
    import time, struct
    from pylab import ion, plot, draw, show

    fp = wave.open("500-200f.wav", "rb")
    sample_rate = fp.getframerate()
    total_num_samps = fp.getnframes()
    fft_length = 2048.
    num_fft = (total_num_samps / fft_length ) - 2
    temp = zeros((num_fft,fft_length), float)

    for i in range(num_fft):
        tempb = fp.readframes(fft_length);
        data = struct.unpack("%dH"%(fft_length), tempb)
        temp[i,:] = array(data, short) 
    pts = fft_length/2+1
    data = (abs(fft.rfft(temp, fft_length)) / (pts))[:pts]

    x_axis = arange(pts)*sample_rate*.5/pts
    spec_range = pts
    plot(x_axis, data[0])
    show() 
```

这是使用 Goldwave 创建的包含 500hz（淡出）+ 200hz 正弦波的合成波文件的非对数刻度图。

![](https://i.stack.imgur.com/rr9OE.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T01:27:00.210

模拟波形不应该像你的图那样显示 FFT，所以有些地方很不对劲，可能不是 FFT，而是输入波形。您绘图中的主要问题不是波纹，而是 1000 Hz 左右的谐波和 500 Hz 的次谐波。模拟波形不应显示任何这些（例如，请参见下面的图表）。

首先，您可能只想尝试绘制原始波形，这可能会指出一个明显的问题。此外，将波解包为无符号短裤（即“H”）似乎很奇怪，尤其是在此之后没有大的零频率分量。

正如次谐波和高次谐波（以及 Trevor）所建议的那样，通过对波形应用削波，我能够获得与您的 FFT 非常接近的副本。您可以在模拟或解包中引入剪裁。无论哪种方式，我通过在 numpy 中创建波形来绕过这一点。

这是正确的 FFT 应该是什么样子（即基本上是完美的，除了由于开窗而使峰变宽）

[![替代文字](https://i.stack.imgur.com/HF2zs.png)](https://i.stack.imgur.com/HF2zs.png)

这是一个被削波的波形（与您的 FFT 非常相似，从次谐波到 1000 Hz 左右的三个高次谐波的精确模式）

[![替代文字](https://i.stack.imgur.com/HxYrO.png)](https://i.stack.imgur.com/HxYrO.png) 这是我用来生成这些的代码

```
from numpy import *
from pylab import ion, plot, draw, show, xlabel, ylabel, figure

sample_rate = 20000.
times = arange(0, 10., 1./sample_rate)
wfm0 = sin(2*pi*200.*times)
wfm1 = sin(2*pi*500.*times) *(10.-times)/10.
wfm = wfm0+wfm1
#  int test
#wfm *= 2**8
#wfm = wfm.astype(int16)
#wfm = wfm.astype(float)
#  abs test
#wfm = abs(wfm)
#  clip test
#wfm = clip(wfm,  -1.2, 1.2)

fft_length = 5*2048.
total_num_samps = len(times)
num_fft = (total_num_samps / fft_length ) - 2
temp = zeros((num_fft,fft_length), float)

for i in range(num_fft):
    temp[i,:] = wfm[i*fft_length:(i+1)*fft_length] 
pts = fft_length/2+1
data = (abs(fft.rfft(temp, fft_length)) / (pts))[:pts]

x_axis = arange(pts)*sample_rate*.5/pts
spec_range = pts
plot(x_axis, data[2], linewidth=3)
xlabel("freq (Hz)")
ylabel('abs(FFT)')
show() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-31T23:49:36.443

FFT 因为它们是加窗和[采样](http://en.wikipedia.org/wiki/Sampling_(signal_processing))的，所以也会导致频域中的[混叠](http://en.wikipedia.org/wiki/Aliasing)和采样。时域中的过滤只是频域中的乘法，因此您可能只想应用一个过滤器，该过滤器只是将每个频率乘以您正在使用的过滤器的函数值。例如，在通带中乘以 1，在其他区域中乘以零。意外的值可能是由混叠引起的，其中较高的频率被折叠到您所看到的频率。原始[信号需要将频带限制为采样率的一半](http://en.wikipedia.org/wiki/Nyquist%E2%80%93Shannon_sampling_theorem)，否则会出现[混叠](http://en.wikipedia.org/wiki/Aliasing). 更令人担忧的是扭曲感兴趣区域的混叠，因为对于这个频带，您想知道频率来自预期的频率。

要记住的另一件事是，当您从波形文件中获取一条数据时，您在数学上将其乘以方波。这会导致 sinx/x 与频率响应进行卷积以将其最小化，您可以将原始窗口信号与[Hanning 窗口](http://en.wikipedia.org/wiki/Window_function)之类的信号相乘。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T04:24:43.613

对于一维 FFT，值得一提的是，第一个元素（索引`[0]`）包含 DC（零频率）项，元素`[1:N/2]`包含正频率，元素`[N/2+1:N-1]`包含负频率。由于您没有提供有关 FFT 输出的代码示例或其他信息，因此我不能排除“不存在频率下的噪声功率值”不仅仅是频谱的负频率的可能性。

* * *

**编辑**：[这](http://www.refactory.org/s/radix_2_cooley_tukey_fast_fourier_transform_fft/view/latest)是一个用纯 Python 实现的 radix-2 FFT 示例，它有一个简单的测试例程，可以找到矩形脉冲的 FFT `[1.,1.,1.,1.,0.,0.,0.,0.]`，. [您可以在键盘](http://codepad.org)上运行该示例并查看该序列的 FFT 为

```
[0j,                    Negative frequencies
(1+0.414213562373j),    ^
0j,                     |
(1+2.41421356237j),     |
(4+0j),                <= DC term
(1-2.41421356237j),     |
0j,                     v
(1-0.414213562373j)]    Positive frequencies 
```

请注意，代码按频率升序打印出傅立叶系数，即从最高负频率到 DC，然后再到最高正频率。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-01T13:34:16.277

我对您的问题了解得不够多，无法实际回答任何具体问题。

但根据我自己编写 FFT 的经验，可以尝试以下几点：

*   确保您遵循奈奎斯特规则
*   如果您正在查看 FFT 的线性输出......您将无法看到自己的信号并认为一切都已损坏。确保您正在查看 FFT 幅度的 dB。（即“情节（10 * log10（abs（fft（x））））”）
*   通过像纯音一样输入生成的数据，为您的 FFT() 函数创建一个 unitTest。然后将相同的生成数据提供给 Matlab 的 FFT()。在两个输出数据系列之间进行绝对值差异，并确保最大绝对值差异类似于 10^-6（即唯一的差异是由小的浮点错误引起的）
*   确保您正在[窗口化您的数据](http://en.wikipedia.org/wiki/Window_function#High-_and_moderate-resolution_windows)

如果这三件事都有效，那么您的 fft 就可以了。您的输入数据可能是问题所在。

*   检查输入数据看是否有[剪裁 http://www.users.globalnet.co.uk/~bunce/clip.gif](http://www.users.globalnet.co.uk/~bunce/clip.gif)

时域限幅显示为频域中信号的镜像，以特定的规则间隔显示，幅度较小。

# python - 通用多对多关系

> ID：933092
> 
> 赞同：51
> 
> 时间：2009-05-31T23:18:01.873
> 
> 标签：python, django, generics, django-models, many-to-many

我正在尝试创建一个消息系统，其中消息的发件人和收件人可以是通用实体。这对发件人来说似乎很好，只有对象可以引用（GenericForeignKey），但我不知道如何为收件人解决这个问题（GenericManyToManyKey ??）

下面是一个简化的例子。PersonClient 和 CompanyClient 从 Client 继承属性，但有自己的特定细节。最后一行是症结所在。如何让消息接收者成为一组 CompanyClients 和 PersonClients

```
 class Client(models.Model):
      city = models.CharField(max_length=16)

      class Meta:
          abstract = True

  class PersonClient(Client):
      first_name = models.CharField(max_length=16)
      last_name = models.CharField(max_length=16)
      gender = models.CharField(max_length=1)

  class CompanyClient(Client):
      name = models.CharField(max_length=32)
      tax_no = PositiveIntegerField()

  class Message(models.Model):
      msg_body = models.CharField(max_length=1024)
      sender = models.ForeignKey(ContentType)
      recipients = models.ManyToManyField(ContentType) 
```

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2009-06-02T00:10:47.300

您可以通过手动创建消息和收件人之间的联结表来使用通用关系来实现这一点：

```
from django.db import models
from django.contrib.contenttypes import generic
from django.contrib.contenttypes.models import ContentType

class Client(models.Model):
    city = models.CharField(max_length=16)

    # These aren't required, but they'll allow you do cool stuff
    # like "person.sent_messages.all()" to get all messages sent
    # by that person, and "person.received_messages.all()" to
    # get all messages sent to that person.
    # Well...sort of, since "received_messages.all()" will return
    # a queryset of "MessageRecipient" instances.
    sent_messages = generic.GenericRelation('Message',
        content_type_field='sender_content_type',
        object_id_field='sender_id'
    )
    received_messages = generic.GenericRelation('MessageRecipient',
        content_type_field='recipient_content_type',
        object_id_field='recipient_id'
    )

    class Meta:
        abstract = True

class PersonClient(Client):
    first_name = models.CharField(max_length=16)
    last_name = models.CharField(max_length=16)
    gender = models.CharField(max_length=1)

    def __unicode__(self):
        return u'%s %s' % (self.last_name, self.first_name)

class CompanyClient(Client):
    name = models.CharField(max_length=32)
    tax_no = models.PositiveIntegerField()

    def __unicode__(self):
        return self.name

class Message(models.Model):
    sender_content_type = models.ForeignKey(ContentType)
    sender_id = models.PositiveIntegerField()
    sender = generic.GenericForeignKey('sender_content_type', 'sender_id')
    msg_body = models.CharField(max_length=1024)

    def __unicode__(self):
        return u'%s...' % self.msg_body[:25]

class MessageRecipient(models.Model):
    message = models.ForeignKey(Message)
    recipient_content_type = models.ForeignKey(ContentType)
    recipient_id = models.PositiveIntegerField()
    recipient = generic.GenericForeignKey('recipient_content_type', 'recipient_id')

    def __unicode__(self):
        return u'%s sent to %s' % (self.message, self.recipient) 
```

您可以像这样使用上述模型：

```
>>> person1 = PersonClient.objects.create(first_name='Person', last_name='One', gender='M')
>>> person2 = PersonClient.objects.create(first_name='Person', last_name='Two', gender='F')
>>> company = CompanyClient.objects.create(name='FastCompany', tax_no='4220')
>>> company_ct = ContentType.objects.get_for_model(CompanyClient)
>>> person_ct = ContentType.objects.get_for_model(person1) # works for instances too.

# now we create a message:

>>> msg = Message.objects.create(sender_content_type=person_ct, sender_id=person1.pk, msg_body='Hey, did any of you move my cheese?')

# and send it to a coupla recipients:

>>> MessageRecipient.objects.create(message=msg, recipient_content_type=person_ct, recipient_id=person2.pk)
>>> MessageRecipient.objects.create(message=msg, recipient_content_type=company_ct, recipient_id=company.pk)
>>> MessageRecipient.objects.count()
2 
```

如您所见，这是一个更加冗长（复杂？）的解决方案。我可能会保持简单，并在下面使用 Prariedogg 的解决方案。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-10-07T10:13:16.453

解决这个问题的绝对最佳方法是使用一个名为 django-gm2m 的库

```
pip install django-gm2m 
```

那么如果我们有我们的模型

```
>>> from django.db import models
>>>
>>> class Video(models.Model):
>>>       class Meta:
>>>           abstract = True
>>>
>>> class Movie(Video):
>>>     pass
>>>
>>> class Documentary(Video):
>>>     pass 
```

还有一个用户

```
>>> from gm2m import GM2MField
>>>
>>> class User(models.Model):
>>>     preferred_videos = GM2MField() 
```

我们能做的

```
>>> user = User.objects.create()
>>> movie = Movie.objects.create()
>>> documentary = Documentary.objects.create()
>>>
>>> user.preferred_videos.add(movie)
>>> user.preferred_videos.add(documentary) 
```

甜吗？

有关更多信息，请访问此处：

[http://django-gm2m.readthedocs.org/en/stable/quick_start.html](http://django-gm2m.readthedocs.org/en/stable/quick_start.html)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-06-01T02:02:47.063

您可以通过简化架构以包含一个`Client`带有标志的表来解决此问题，以指示它是什么类型的客户端，而不是使用两个单独的模型。

```
from django.db import models
from django.utils.translation import ugettext_lazy as _

class Client(models.Model):
    PERSON, CORPORATION = range(2)
    CLIENT_TYPES = (
                    (PERSON, _('Person')),
                    (CORPORATION, _('Corporation')),
                   )
    type = models.PositiveIntegerField(choices=CLIENT_TYPES, default=PERSON)
    city = models.CharField(max_length=16)
    first_name = models.CharField(max_length=16, blank=True, null=True)
    last_name = models.CharField(max_length=16, blank=True, null=True)
    corporate_name = models.CharField(max_length=16, blank=True, null=True)
    tax_no = models.PositiveIntegerField(blank=True, null=True)

    def save(self, *args, **kwargs):
        """
        Does some validation ensuring that the person specific fields are
        filled in when self.type == self.PERSON, and corporation specific
        fields are filled in when self.type == self.CORPORATION ...

        """
        # conditional save logic goes here
        super(Client, self).save(*args, **kwargs) 
```

如果您以这种方式做事，您可能根本不必使用通用外键。作为额外的便利，您还可以为 Client 模型编写自定义管理器，例如`Client.corporate.all()`, `Client.person.all()`，以返回仅包含您想要的客户端类型的预过滤查询集。

这也可能不是解决问题的最佳方式。我只是把它作为一种潜在的可能性扔在那里。我不知道是否有将两个相似模型组合在一起并使用保存覆盖来确保数据完整性的传统智慧。似乎它可能存在潜在问题......我会让社区在这个方面向我学习。

# objective-c - 在 Objective-C 中，我是否重定向包含实例的方法而不对其进行子类化？

> ID：933093
> 
> 赞同：-1
> 
> 时间：2009-05-31T23:18:20.467
> 
> 标签：objective-c, iphone

在 Objective-C 中，如何重新连接一个类的实例方法以调用另一个类中的方法？

假设一个 UIView 类 A 包含另一个称为 childA 的 UIView 类。我希望它在调用 childA 的 drawRect 时调用 A 类中的方法，而不必将 childA 子类化并在其 drawRect 中进行所需的调用。如何做到这一点？

另外，如何动态地为 childA 的绘图类提供方法？我知道这可能不是一个好习惯，但它对测试目的很有用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-31T23:40:47.553

要回答您关于重新布线方法的第一个问题：

您不想在一般原则上这样做，因为它有点违背了面向对象设计的全部目的，但出于测试目的，它可能很有用。只要你在 Leopard 上，这也不是特别困难。

看看[Objective-C 2.0 运行时参考](http://developer.apple.com/documentation/Cocoa/Reference/ObjCRuntimeRef/Reference/reference.html)，它包含了王国的钥匙，就像它一样。查看函数`class_getInstanceMethod`、`method_getImplementation`、`method_getTypeEncoding`和`class_addMethod`它们的组合，可以让您在运行时更改类的方法。

如果您只是将一个选择器调换到另一个，`method_exchangeImplementations`这是一个有用的快捷方式。

要回答关于动态提供方法的第二个问题，就像将 SEL 传递给方法然后调用一样简单`-performSelector:withObject:`：

```
@interface MyView : NSView {
    SEL drawingSelector;
    id drawingDelegate;
}
@property SEL drawingSelector;
@property id drawingDelegate;
@end

@implementation MyView

- (void)drawRect:(NSRect)rect {
    [self.drawingDelegate performSelector:drawingSelector withObject:[NSValue valueWithRect:rect]];
}

@end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T01:08:09.840

对于您提出的第一个问题，您似乎会将 UIView A 设置为 childA 和其他 UIView 的委托对象 - 然后他们可以使用委托方法来调用您在 A 中想要的额外绘图功能。

或者让每个孩子都要求超级视图，如果它是“A”类型，则调用您感兴趣的方法。

# sifr - 网络字体嵌入与 sifr？

> ID：933098
> 
> 赞同：10
> 
> 时间：2009-05-31T23:24:53.137
> 
> 标签：sifr, typography, cufon, webfonts, typekit

我想使用非标准的网络字体来改善我的 HTML 的外观。

**嵌入网络字体或使用类似 sifr 的字体更可取吗？**

我的理解是 sifr 是一个基于 Flash 的矢量字体查看器，但我一直不愿意尝试它，因为它看起来有些复杂。

似乎没有很多关于网络字体嵌入的令人鼓舞的讨论（因为法律问题）所以也许 sifr 是一种标准的方式来做到这一点？

对于任何反馈，我们都表示感谢。谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-01T21:58:10.780

Safari 3.1、即将推出的 Firefox 3.5 和即将推出的 Opera 10 支持 Web 字体。自 IE4 以来，Internet Explorer 已支持（不同的）格式。

此时，在 Safari、Firefox 和 Opera 中实现的最大问题是它们需要您将原始字体文件上传到您的 Web 服务器。对于许多字体，这将构成对您从字体铸造厂获得的许可证的违反。因此，如果字体代工厂没有授予您使用它们的权限，那么现在的网络字体不是一个合适的解决方案。但是，有免费许可的字体可用。

这给我们留下了大约三个其他选项：图像、Flash 和基于 JavaScript 的解决方案。图像通常更受欢迎，因为它们对浏览器怪癖和性能的影响最小，但是在 PHP 中生成动态图像通常看起来不如其他解决方案好。您当然可以在 Photoshop 中手动创建图像，但这通常会达不到目的。

sIFR 使用 Flash 来呈现文本，并且非常灵活，您可以选择文本、动态更改文本以及对嵌套 HTML 元素的样式进行一些控制。Hoefler & Frere-Jones 同意 sIFR，前提是您支付服务器许可证费用并采取一切可能的措施将 sIFR Flash 电影限制在您的域名内。

Cufón 是一个纯 JavaScript 解决方案，它实现了自己的渲染引擎，非常聪明。在这一点上，它不如 sIFR 灵活，其法律问题仍不清楚。

也就是说，图像、sIFR 和 Cufón 都是 hack，*昨天*我们需要适当的网络字体。

（免责声明：我是 sIFR 的首席开发人员，所以我可能有些偏见。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-31T23:58:35.597

您也可以考虑 JS 替代方案。但是，为了获得最佳的跨浏览器兼容性，您最好使用图像以及背景图像和文本缩进 CSS 技巧来用图像替换静态文本。

我上面提到的技术（和其他技术）可以在这里阅读：http: [//css-tricks.com/nine-techniques-for-css-image-replacement/](http://css-tricks.com/nine-techniques-for-css-image-replacement/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-31T23:36:56.140

需要考虑的事情：

对于每个看到您的“更好看”字体的访问者来说，由于浏览器不兼容或禁用该功能而不会看到的访问者也一样多。拥有正确的字体可能不是您可以进行的最有价值的设计更改。

用我的手机浏览器写的，它没有嵌入字体。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-01T00:22:13.053

请注意，定义字体嵌入的 CSS3 Web 字体模块仍然是工作草案。事实上，字体嵌入的实际支持并不好。我会说最好再等2-3年。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-01T22:04:14.933

同样一文不值：[TypeKit](http://blog.typekit.com/)，一种为您提供一行 JavaScript 以将所有这些抽象出来的服务。

# objective-c - 从 URL Objective C 获取图像

> ID：933099
> 
> 赞同：55
> 
> 时间：2009-05-31T23:25:37.880
> 
> 标签：objective-c

我正在尝试从 URL 获取图像，但它似乎对我不起作用。有人可以指出我正确的方向吗？

这是我的代码：

```
NSURL *url = [NSURL URLWithString:@"http://myurl/mypic.jpg"];

NSString *newIMAGE = [[NSString alloc] initWithContentsOfURL:url
                                       encoding:NSUTF8StringEncoding error:nil];

cell.image = [UIImage imageNamed:newIMAGE]; 
```

当我调试 newIMAGE 字符串为 nil 时，有些东西在那里不起作用。

* * *

## 回答 #1

> 赞同：173
> 
> 时间：2009-06-01T00:02:14.810

您想要的是获取图像数据，然后使用该数据初始化 UIImage ：

```
NSData * imageData = [[NSData alloc] initWithContentsOfURL: [NSURL URLWithString: @"http://myurl/mypic.jpg"]];
cell.image = [UIImage imageWithData: imageData];
[imageData release]; 
```

根据要求，这是一个异步版本：

```
dispatch_async(dispatch_get_global_queue(0,0), ^{
    NSData * data = [[NSData alloc] initWithContentsOfURL: [NSURL URLWithString: @"http://myurl/mypic.jpg"]];
    if ( data == nil )
        return;
    dispatch_async(dispatch_get_main_queue(), ^{
        // WARNING: is the cell still using the same data by this point??
        cell.image = [UIImage imageWithData: data];
    });
    [data release];
}); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-31T23:56:07.117

好的，这里有几件事是错误的：

1.  从 URL (url) 到 NSString (newImage) 的转换不正确，代码实际上是尝试将“ [http://myurl/mypic.jpg](http://myurl/mypic.jpg) ”的内容加载到 NSString 中。

2.  -imageNamed 方法将一个字符串作为参数，该字符串是本地文件的路径，而不是 URL。

您需要使用 NSData 对象作为中介，如本例所示：http: [//blogs.oreilly.com/digitalmedia/2008/02/creating-an-uiimage-from-a-url.html](http://blogs.oreilly.com/digitalmedia/2008/02/creating-an-uiimage-from-a-url.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-03-26T00:41:52.183

接受的答案异步版本在我的代码中运行得很慢。使用 NSOperation 的方法运行速度快了光年。Joe Masilotti 提供的代码 -->[目标 - C：从 URL 加载图像？](https://stackoverflow.com/questions/12140662/objective-c-loading-image-from-url)（并粘贴在下面）：

```
-(void) someMethod {
    // set placeholder image
    UIImage* memberPhoto = [UIImage imageNamed:@"place_holder_image.png"];

    // retrieve image for cell in using NSOperation
    NSURL *url = [NSURL URLWithString:group.photo_link[indexPath.row]];
    [self loadImage:url];
}

- (void)loadImage:(NSURL *)imageURL
{
    NSOperationQueue *queue = [NSOperationQueue new];
    NSInvocationOperation *operation = [[NSInvocationOperation alloc]
                                        initWithTarget:self
                                        selector:@selector(requestRemoteImage:)
                                        object:imageURL];
    [queue addOperation:operation];
}

- (void)requestRemoteImage:(NSURL *)imageURL
{
    NSData *imageData = [[NSData alloc] initWithContentsOfURL:imageURL];
    UIImage *image = [[UIImage alloc] initWithData:imageData];

    [self performSelectorOnMainThread:@selector(placeImageInUI:) withObject:image waitUntilDone:YES];
}

- (void)placeImageInUI:(UIImage *)image
{
    [self.memberPhotoImage setImage:image];
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-06-11T05:26:17.690

在**Swift 3 和 4中**

```
let theURL = URL(string:"https://exampleURL.com")
let imagedData = NSData(contentsOf: theURL!)!
let theImage = UIImage(data: imagedData as Data)
cell.theImageView.image = theImage 
```

这将在主线程中完成。

并在**异步/后台线程中执行相同的操作**

```
 DispatchQueue.main.async(){
      let theURL = URL(string:"https://exampleURL.com")
      let imagedData = NSData(contentsOf: theURL!)!
      let theImage = UIImage(data: imagedData as Data)
   }
   cell.theImageView.image = theImage 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-09-26T05:46:28.027

`[data release]`不再需要更新 Jim dovey 的答案，因为在更新的苹果指南中。内存管理由 ARC（自动计数引用）自动完成，

这是更新的`asynchronous call`，

```
dispatch_async(dispatch_get_global_queue(0,0), ^{
        NSData * data = [[NSData alloc] initWithContentsOfURL: [NSURL URLWithString: @"your_URL"]];
        if ( data == nil )
            return;
        dispatch_async(dispatch_get_main_queue(), ^{
            self.your_UIimage.image = [UIImage imageWithData: data];
        });

    }); 
```

# objective-c - 如何将文本绘制到子视图中？

> ID：933100
> 
> 赞同：0
> 
> 时间：2009-05-31T23:25:39.830
> 
> 标签：objective-c, iphone

我想`UIView`使用 call 将文本绘制到 的子视图中`drawInRect:withFont:lineBreakMode`，但这仅在当前上下文中运行。

是否可以从当前视图将文本绘制到子视图中？

子视图是一个通用实例，如果可以避免的话，我`UIView`真的不想为此目的创建一个新的派生类。`UIView`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T01:56:51.460

不，如果你要在上下文中做某事，你必须在那个视图的 -drawRect: 中。您始终可以使您的子视图成为覆盖 -drawRect: 的 UIView 子类，以显示您想要的文本......但在这一点上，您正在重新发明 UILabel。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T03:07:43.873

一种选择是将 CALayer 添加到视图的层，而不是向视图添加 UIView。CALayer 有一个`delegate`属性，您可以将任何对象分配给该属性。CALayer 调用：

```
- (void)drawLayer:(CALayer *)layer inContext:(CGContextRef)ctx 
```

在 上`delegate`，您可以执行以下操作：

```
- (void)drawLayer:(CALayer *)layer inContext:(CGContextRef)ctx {
    if (layer == myLayer) {
        UIGraphicsPushContext(ctx);
        [string drawInRect:rect withFont:font lineBreakMode:mode];
        UIGraphicsPopContext();
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T01:50:38.680

不，你不能做你所描述的。子类化 UIView 正是你应该使用的方法——创建一个只有一个简单`-drawRect:`方法的 UIView 子类并没有错。

# c# - C# 在运行时停止属性更改

> ID：933101
> 
> 赞同：2
> 
> 时间：2009-05-31T23:27:32.197
> 
> 标签：c#, properties, user-controls

我一直在尝试使用设计器中设置的一些自定义属性来构建用户控件。然而，该控件涉及一些不应在运行时调整的互操作代码和设置。有没有办法在设计器代码最初设置值后停止更改这些值？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-31T23:35:36.830

你能修改属性定义吗？一种方法是，向属性设置器添加一个标记，并只允许一个设置操作（通常由 InitializeComponent() 完成）：

```
private int _myProperty;
private bool _isMyPropertySet = false;
public int MyProperty
{
    set
    {
        if (!_isMyPropertySet)
        {
            _isMyPropertySet = true;
            _myProperty = value;
        }
        else
        {
            throw new NotSupportedException();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T02:10:29.170

Michael provided a great answer, and it will solve your problem at runtime. However, at design time, if you need to be able to change that value more than once (it is design time, and the probability is likely high), then you will want to combine the DesignMode check with Michaels example:

```
private int _myProperty;
private bool _isMyPropertySet = false;
public int MyProperty
{
    set
    {
        if (this.DesignMode || !_isMyPropertySet)
        {
                _isMyPropertySet = true;
                _myProperty = value;
        }
        else
        {
                throw new NotSupportedException();
        }
    }
} 
```

Now you will be able to edit this value to your hearts content during design, without running into that NotSupportedException() and getting a botched designer on the second set.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T00:02:57.803

WinForms 体系结构提供了一种内置方法来测试代码当前是否在设计模式下执行 - [Component.DesignMode](http://msdn.microsoft.com/en-us/library/system.componentmodel.component.designmode.aspx)属性。

所以你可能想要一个这样的实现：

```
private int _foo;

public int Foo
{
    get { return _foo; }
    set
    {
        if (this.DesignMode)
            throw new InvalidOperationException();

        _foo = value;
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-31T23:30:37.353

您可以在属性设置器中抛出异常吗？

```
public int SomeProperty {

   set {

      if(designerComplete) {
          throw new IllegalOperationException();
      }

   }

} 
```

将 DesignerComplete 设置为类变量 - 在构造函数中调用 InitializeComponent 方法后将其设置为 true。

# wcf - 现实世界中的 Web 服务调用和代理身份验证

> ID：933104
> 
> 赞同：0
> 
> 时间：2009-05-31T23:33:09.860
> 
> 标签：wcf, web-services, proxy

我们正在开发一个应用程序，该应用程序由一个承载 Web 服务（除其他外）的 Web 服务器和一个将与该 Web 服务通信的客户端组成。客户端应用程序和服务器都应在公司防火墙内使用。该应用程序将被打包并部署到世界各地的组织中，因此它需要足够灵活以在多种类型的环境中工作。

我的问题围绕 Web 服务身份验证以及适合现实世界场景的内容。我知道有些公司的代理服务器需要单独的身份验证。跨组织的要求多久一次？代理服务器何时强制用户进行身份验证（您可以在不进行身份验证的情况下访问内部站点.. 仅对外部站点进行身份验证）？

我问这些问题的原因是，我不确定我们应该在客户端应用程序中构建什么样的功能来对 Web 服务进行身份验证。默认情况下，我们将获取当前用户凭据并将其传递给服务器。你觉得这够了吗？如果公司需要某种形式的替代身份验证来进行内部访问，这将不起作用。我的问题围绕着最后一种情况——它多久发生一次？为什么公司会强制使用备用凭据进行内部访问？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T01:02:25.267

如果 Internet Explorer 可以在不提示用户的情况下通过代理服务器访问站点，则您对 Web 服务的调用应该“正常工作”。如果 IE 提示用户，*则*需要拼凑一种方式填写代理服务器认证信息。

我遇到了很多让 Web 服务坚如磐石的问题，但从未遇到过代理服务器身份验证问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T01:37:50.233

为什么不让它可配置？此外，使用 WCF，您可以配置几乎任何您可能需要的东西，在大多数情况下无需更改您的代码。

# sql - 这个 SQL IF 对 & 符号做了什么？

> ID：933106
> 
> 赞同：4
> 
> 时间：2009-05-31T23:34:01.873
> 
> 标签：sql

这个 SQL IF 对 & 符号做了什么？

```
IF ((@TablesToDeleteFrom & 1) <> 0 AND
            (@TablesToDeleteFrom & 2) <> 0 AND
            (@TablesToDeleteFrom & 4) <> 0 AND
            (@TablesToDeleteFrom & 8) <> 0 AND
            (EXISTS (SELECT UserId FROM dbo.aspnet_Users WHERE @UserId = UserId)))
        BEGIN
    ... 
```

这是来自 aspnet_Users_DeleteUser SP 内的 aspnet 会员数据库。@TablesToDeleteFrom 被声明为 int 并默认为 0。我以前没有见过像这样使用 &。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-31T23:34:55.193

这是一个[位运算](http://msdn.microsoft.com/en-us/library/ms174965.aspx)符。基本上，要删除的表将通过为表创建值的按位组合将多个表存储在一个基于整数的字段中。这是一个例子。

```
1 - TableA
2 - TableB
4 - TableC
8 - TableD 
```

表 A 和表 B = 1 | 2 = 3。（您使用 OR 运算符获取结果，并使用 AND 运算符检查结果）。因此 3 的值存储在该字段中。然后，您可以使用 & 运算符查看是否设置了该值。1 & 3 == 1，所以 TableA 将被删除。4 & 3 = 0 所以不会删除 TableC。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-31T23:39:49.707

正如@Bob 所说，`&`是按位和；因此，顺便说一下，一个更紧凑的等价物

```
IF ((@TablesToDeleteFrom & 1) <> 0 AND
            (@TablesToDeleteFrom & 2) <> 0 AND
            (@TablesToDeleteFrom & 4) <> 0 AND
            (@TablesToDeleteFrom & 8) <> 0 AND 
```

是

```
IF ((@TablesToDeleteFrom & 15) = 15) AND 
```

# c# - 有没有在非泛型上下文中引用泛型类的干净方法？

> ID：933112
> 
> 赞同：1
> 
> 时间：2009-05-31T23:36:51.337
> 
> 标签：c#, .net, generics

考虑以下：

```
public interface ICleanCoder
{
    void DoSomeCoding(object task);
}

public interface ICleanCoder<T>
{
    void DoSomeCoding(T task);
}

...

public class TestCleanCoding
{
    void RegisterCleanCoder(ICleanCoder coder);
} 
```

我必须拥有初始的非泛型接口，以便稍后启用对它的非泛型引用。我知道从技术上讲这是完全合理的，但是解决方案对我来说有点腐烂，我想知道我是否遗漏了一些东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-31T23:43:53.553

不幸的是，这是做到这一点的唯一方法，除非您也想让 TestCleanCoding 成为模板（这是一个合理的设计决策，不会放弃 ICleanCoder 作为模板的好处）；另外，您遗漏了一个重要部分：

```
public interface ICleanCoder<T> : ICleanCoder
{
    void DoSomeCoding(T task);
} 
```

否则，您的模板化界面与您的基本界面无关。

# iphone - 您是否创建了一个独资企业来在 Apple 的 App Store 上销售应用程序？

> ID：933115
> 
> 赞同：3
> 
> 时间：2009-05-31T23:38:30.817
> 
> 标签：iphone, app-store

我几乎准备好在 Apple App 上提供一个 iPhone 应用程序。存储并赚取我的数百万美元。;)

对于那些曾经去过的人，您是否成立了一家企业（有限责任公司或独资企业）以保持合法性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T00:25:53.483

最后，这实际上取决于您的应用程序开发计划。如果您打算使其成为“真正的”业务，您绝对希望将其纳入法律保护和税收优惠。如果这只是一个爱好/你在业余时间做的事情，那么我不会打扰。

我们已经使用了几次 LegalZoom 来合并；计划花费 <= 2000 美元左右来完成从汤到坚果的工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-31T23:45:06.030

我想说这在很大程度上取决于您的应用程序的性质。如果您的应用程序处理个人信息或以某种方式可能会损坏手机本身的其他数据或信息，您可能需要确保明智地承担责任。

如果它是一个游戏或不会（不应该）影响那种类型的东西，那么你可能就可以单独进行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T01:27:46.947

不要以为合并会保护您免于承担责任。看[这里](http://www.litigationandtrial.com/2009/05/articles/the-law/for-people/can-i-set-up-an-llc-to-avoid-personal-liability-in-a-lawsuit/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-31T23:41:34.290

我用了我的名字。在我注册的时候，我听到了关于公司需要多长时间才能获得批准的恐怖故事，而个人的批准却在飞速发展。也许那已经改变了。

# asp.net - Jquery拖放包含问题 - CSS问题？

> ID：933118
> 
> 赞同：1
> 
> 时间：2009-05-31T23:39:49.660
> 
> 标签：asp.net, jquery, drag-and-drop

我已经成功地创建了 2 个 DIV，并在运行时用一大堆对象填充第一个 DIV，所有对象都使用 .drag 类。第二个 DIV 具有 .drop 类，正在等待用户将一些对象拖放到其中。问题是，每当我尝试将对象拖到第一个 DIV 之外时，就会出现一个滚动条，并且我似乎无法将对象拖到创建对象的父 DIV 之外！我注意到的一件事是，如果我去掉下面的 ASPX 文件中的滚动条，我可以自由拖动，但随后页面下方会出现一个巨大的列，看起来很糟糕。

更新 - 很确定这是一个 CSS 问题，但我不知道我现有的 CSS 东西哪里出了问题。

您可以在我的开发网站上看到发生了什么：[http](http://www.mobiuspc.com) ://www.mobiuspc.com 单击任何按钮，然后尝试将其拖到父 DIV 之外，您会明白我的意思！

这是我的相关 ASPX 信息：

```
<asp:Panel ID="toolboxpanel" runat="server"  cssclass="toolbox" ScrollBars="Auto">
the toolbox is here
</asp:Panel>

<asp:Panel ID="droppanel" runat="server" CssClass="drop" >
 the drop area is here</asp:Panel>

</div> 
```

以及我应用到它的 CSS：

```
.drag
{
width: 125px;
height:94px;
padding:3px;
margin-bottom:35px;
float: left;
}
.toolbox
{
position:absolute;
height:700px;
width:324px;
border-style:solid;
border-width:2px;
border-color:Black;
}
.drop
{
height:700px;
width:700px;
border-style:solid;
border-width:2px;
border-color:Black;
margin-left:324px;
} 
```

和 JQuery 以防万一：

```
 $('.drag').draggable({ revert: true, helper: 'clone' });
 $('.drop').droppable({
    tolerance: "touch", // Here should be a string
    drop: function(ev, ui) {

        var poo = $(ui.draggable).attr("id");
        $('[id$="myHidden"]').val(poo);
        __doPostBack('<%= HiddenButton.UniqueID  %>', '');

    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T02:42:12.723

我在您的 CSS 或模板中没有看到“拖动”类。您的意思是在 .drag 或 .toolbox 上设置您的可拖动对象？

从我的工作代码中脱颖而出的唯一另一件事是“位置：绝对”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T19:31:24.943

在 Firebug 中使用您的页面时，更改以下内容允许我拖放：

```
.toolbox
{
/*position:absolute;*/ 
height:700px;
width:324px;
border-style:solid;
border-width:2px;
border-color:Black;
}
.drop
{
height:700px;
width:700px;
border-style:solid;
border-width:2px;
border-color:Black;
/* the following updated or added */
margin-left:328px;
position:absolute;
top:132px;
} 
```

删除 position:absolute 将您的 div.drop 元素移动到您的 div.toolbox 下方，这可能是您从 Dave 的回答中提到的怪异之处。我在 .drop 的 css 中更新的所有内容都只是重新定位 div。

# c++ - C++ Linux 中的套接字超时

> ID：933122
> 
> 赞同：8
> 
> 时间：2009-05-31T23:41:25.133
> 
> 标签：c++, linux, sockets, timeout

好的，首先我想提一下我所做的事情是完全合乎道德的，是的，我正在端口扫描。

当端口打开时，程序运行良好，但是当我到达关闭的套接字时，程序会暂停很长时间，因为没有超时条款。下面是下面的代码

```
int main(){

    int err, net;
    struct hostent *host;
    struct sockaddr_in sa;

    sa.sin_family = AF_INET;

    sa.sin_port = htons(xxxx);
    sa.sin_addr.s_addr = inet_addr("xxx.xxx.xxx.xxx");

    net = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);
    err = connect(net, (struct sockaddr *)&sa, sizeof(sa));

    if(err >= 0){ cout << "Port is Open"; }
    else { cout << "Port is Closed"; }

} 
```

[我在堆栈溢出时发现了这一点，但使用select()](https://stackoverflow.com/questions/284748/tuning-socket-connect-call-timeout)命令对我来说没有意义。

问题是我们能不能让 connect() 函数超时，这样我们就不用等一年就让它返回错误？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-01T00:08:06.063

最简单的方法是设置一个`alarm`并被`connect`信号中断（参见[UNP](http://www.kohala.com/start/unpv12e.html) 14.2）：

```
 signal( SIGALRM, connect_alarm ); /* connect_alarm is you signal handler */
alarm( secs ); /* secs is your timeout in seconds */
if ( connect( fs, addr, addrlen ) < 0 )
{
    if ( errno == EINTR ) /* timeout */
        ...
}
alarm( 0 ); /* cancel alarm */ 
```

虽然使用`select`并不难 :)
您可能也想了解[原始套接字](http://mixter.void.ru/rawip.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T00:12:49.907

如果您对使用阻塞 IO 完成此操作一无所知，您应该调查 setsockopt() 调用，特别是 SO_SNDTIMEO 标志（或其他标志，取决于您的操作系统）。

请注意，这些标志不可靠/不便携，并且可能在不同平台或给定平台的不同版本上以不同方式实现。

执行此操作的传统/最佳方法是通过使用 select() 的非阻塞方法。如果您不熟悉套接字，最好的书籍之一是 TCP/IP Illustrated, Volume 1: The Protocols。它在亚马逊上：[http ://www.amazon.com/TCP-Illustrated-Protocols-Addison-Wesley-Professional/dp/0201633469](https://rads.stackoverflow.com/amzn/click/com/0201633469)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-06T11:53:04.997

RudeSocket 解决了这个问题

我找到了一个在 linux Fedora（不确定 Windows）中测试的 lib 文件，它给了我超时选项。您可以在下面找到一个非常简单的示例。

```
#include <rude/socket.h>
#include <iostream>

using namespace std;
using namespace rude;

Socket soc;
soc.setTimeout(30, 5);

//Try connecting
if (soc.connect("xxx.xxx.xxx.xxx", 80)){

    cout << "Connected to xxx.xxx.xxx.xxx on Port " << 80 << "\n";
}

//connections Failed
else{
    cout << "Timeout to xxx.xxx.xxx.xxx on Port " << 80 << "\n";
}

soc.close(); 
```

这是[DevSite的链接](http://rudeserver.com/socket/)

# javascript - GMap - 如果光标不在标记顶部，则不会触发 onrightclick 事件

> ID：933126
> 
> 赞同：0
> 
> 时间：2009-05-31T23:43:35.520
> 
> 标签：javascript, google-maps

您可以在此处复制错误：[http ://www.trailbehind.com/node/1148091](http://www.trailbehind.com/node/1148091)

出于某种原因，仅当用户的光标位于标记上时才会触发以下事件，但我已经看到它在其他地方正常工作，我不确定我的网站上出现了什么问题：

```
GEvent.addListener(map, 'singlerightclick', function(latLng, src, overlay) {
  console.log(1);
} 
```

谢谢你提供的所有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T00:10:25.543

您的代码看起来正确，当我访问您提供的 URL（我只使用 Google Chrome 尝试过）并右键单击任何位置时，会出现一个带有相关信息的标记。我应该在什么浏览器上观察（或未能观察到）哪些不当行为？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-11-21T21:09:58.677

似乎是 Mac 上 Firefox 中的一个错误。在此处查看详细信息 - [http://code.google.com/p/gmaps-api-issues/issues/detail?id=1545](http://code.google.com/p/gmaps-api-issues/issues/detail?id=1545)

我希望很快有一个解决方案。

# sql - 如何将两个不同类型的 linq 列表查询合并到新类型的列表中？

> ID：933128
> 
> 赞同：0
> 
> 时间：2009-05-31T23:44:03.583
> 
> 标签：sql, linq-to-sql

我想将两个不同类型的列表合并到一个新类型列表中。我会使用连接，但如果列表 A 没有该公共属性的值，我仍然想使用列表 B 的值。

```
class A{
 decimal AValue
 DateTime Date
 int UserID
 }

class B{
 int BValue
 DateTime Date
 int UserID
 }

class Merge{
 decimal? Avalue
 int? BValue
 DateTime Date
 int UserID

 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-01T00:07:09.387

如果我理解正确，应该这样做。由于有 2 个日期可供选择，我从清单中选择了一个。

假设 alist 为 IEnumerable<A> 和 blist 为 IEnumerable<B>

*编辑：*先前的答案加入了错误的方式，允许连接的**B**部分为空。我已经更新了代码以允许 null **A** s

```
blist
    .GroupJoin
    (
        alist,
        tb => tb.UserID,
        ta => ta.UserID,
        (tb, ta) => new {tb, ta}
    )
    .SelectMany
    (
        j => j.ta.DefaultIfEmpty(),
        (j, x) =>
        new Merge
            {
                AValue = x.AValue,
                BValue = j.tb.BValue,
                Date = j.tb.Date,
                UserID = j.tb.UserID
            }
    ); 
```

# .net - 什么是可以编译为本机 Windows 代码的轻量级编程语言？

> ID：933129
> 
> 赞同：6
> 
> 时间：2009-05-31T23:44:07.857
> 
> 标签：.net, windows, winapi, compiler-construction, programming-languages

我是 .Net 开发人员，但我无法保证 .Net Framework 将安装在目标计算机上。

我已经看到了一些建议使用 NGen 编译为本机代码的问题（[此处](https://stackoverflow.com/questions/335499/are-there-tools-to-compile-cil-to-a-binary)和[此处）。](https://stackoverflow.com/questions/45702/is-there-some-way-to-compile-a-net-application-to-native-code)两者都指出您仍然需要该框架。

我想编写一个相当轻量级的应用程序（基本的 GUI，没有数据库，没有什么复杂的），但由于各种原因，我不想安装任何框架或字节码解释器。

[这个问题](https://stackoverflow.com/questions/79582/best-win32-compiled-scripting-language)建议使用 Python 和 py2exe。我不熟悉 Python，但如果它是完成这项工作的最佳工具，我可能会学到足够的知识来编写这个应用程序（不过我不想这样做）。我还考虑过用 DHTML 和 javascript 编写它——我可以依靠具有相对较新浏览器的机器。

我熟悉 C 系列语言，并且涉足 Java、PHP 和 Ruby。

**谁能推荐一种我可以轻松编译为本机 Win32 代码的语言？**

*编辑：澄清*

有一些答案表明，如果我熟悉 C 系列语言，为什么不直接使用 C？我可能应该澄清一下。我每天都使用 C#，而且我是在 C+ 和 C++ 上长大的（但已经好几年没用过这两种语言了）。

看起来 C/C++ 可能是要走的路，但我必须刷新我对它们的记忆:)

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-31T23:47:55.790

如果它是轻量级的并且没有什么复杂的，而且你熟悉 C 语言家族.. 那么为什么不 C 和 Win32 Api 呢？当然，这比编写 .net 或 java 程序要难，但它肯定会编译为本机 Windows 代码，并且不需要字节码或解释器。

此外，您还可以使用 Mono 将 C# 应用程序与 Mono 运行时静态链接。[http://www.mono-project.com/Guide:Running_Mono_Applications](http://www.mono-project.com/Guide:Running_Mono_Applications)

我看到你需要复习 C ..这是另一个想法，然后：[Delphi](http://en.wikipedia.org/wiki/Delphi_programming_language)。

[这个帖子](https://stackoverflow.com/questions/370399/whats-the-best-way-to-write-a-windows-client-app-other-than-net)里还有更多的答案

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-31T23:56:50.047

我会尝试使用 Qt 的 C++ ......我认为这是一个非常重要的学习框架，考虑到它刚刚变成了 LGPL。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-01T00:43:30.360

如果您愿意考虑一个可以完全包含在您的安装中的字节码解释器（您提到的 python 解决方案将会这样做），那么您可以考虑使用[Lua](http://www.lua.org/)和类似[srlua](http://luaforge.net/projects/srlua/)的东西将您的脚本与解释器捆绑到一个单一的。EXE文件。为了获得与 Lua 一起使用的快速 GUI，[IUP](http://www.tecgraf.puc-rio.br/iup/)是一个不错的选择，但也有其他 GUI 框架的绑定。

如果问题更多是没有大量系统依赖项的全新安装，而不是尝试获取没有 DLL 的单个 EXE，那么请考虑使用 Lua 而不用 srlua 来打包它。它不需要以任何神奇的方式安装，并且可以与您的脚本以及 DLL 或脚本形式的任何所需模块一起存在于单个文件夹中。

将 C 可调用函数绑定到 Lua 内核很容易，因为作者从一开始就将其设计为嵌入到更大的应用程序中。例如，它只需要几行样板代码就可以创建一个用 C 语言编写的 Lua 可调用模块，该模块分布在一个 DLL 中。

开始使用 Lua 以及完整的有用模块套件的一种简单方法是[Lua for Windows](http://luaforge.net/projects/luaforwindows/)项目，该项目为 Lua 维护了一个“包含电池”的安装套件。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-01T01:14:17.643

帕斯卡/德尔福也许？

实际上，如果您想要兼容性，没有什么比不使用 MFC 的 Win32 应用程序更好的了。不确定 STL 是否不在 VS 安装的一些额外 DLL 中。

另一方面，我记得在安装时看到诸如 VC++ redistributables 之类的消息，不确定它是否引用了 MFC 甚至核心库。最好不要使用 MFC。

您可以将 WTL 用于 GUI，它将编译为您的可执行文件。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-31T23:50:33.447

Windows API 本身是 C 语言。

如果 C 不够轻量级，您可以考虑使用 C++/MFC，它非常适合制作简单的 GUI 程序，而您的代码最少。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-01T00:49:21.813

对我来说它的 powerbasic (www.powerbasic.com)。它编译本机 exe（真实的，而不是嵌入编译的字节码）。语法就像旧的 pds 或 quick basic（但更高级）。它允许内联汇编程序、面向对象的类（可选，您也可以只编写程序代码）。如果你有 c 的背景，那就坚持下去。如果您喜欢基本语言，那么 pb 是不费吹灰之力。它就像带有字符串的c。除此之外，如果你喜欢 pascal，delphi 的编译器可以生成本地 exe。

-大学教师

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-31T23:48:42.623

NGen 旨在通过编译为本机代码来优化 .NET 代码。您仍然需要 .NET 框架。此外，NGen 在客户端机器上的安装程序中运行——您不能分发本机代码。

创建 .NET 安装程序项目，它将检查框架并自动安装它。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-31T23:58:37.377

在不知道您将要编写哪种特定类型的应用程序的情况下，很难确定...但是 MFC（如果您知道的话）或纯 C/C++ 和 Win32 API 将是一个合理的选择，基于你提供的信息。

当然，MFC 有点过时了。但是它附带了数以万计的应用程序，而且除了它的缺点之外，它确实可以用于许多目的。如果您可以获得 Visual C++ 6.x 的副本，那么有很多向导/等可以帮助您快速推出应用程序。也就是说，我绝对不建议仅仅为此目的学习 MFC。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-06-01T04:56:26.970

Along the lines of C/C++ you might take a look at [the D programming language](http://www.digitalmars.com/d/1.0). It's got most of the advantage of D including native binaries by default but is a lot closer to C# or Java in the features department. Unfortunately, in the tools and, to a lesser extent, libs domain it's sadly lacking (although that is changing fairly quickly).

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-31T23:48:53.980

C++ 或 VB6 都适合你。看看VB6。它很容易学习，并且很容易使用 GUI。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-31T23:49:11.793

我喜欢 C++Builder。.NET Framework 是由开发 Borland 的 Visual Component Library 的一些人设计的，所以如果你走这条路，你会觉得它很熟悉。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-06-01T01:13:10.877

另一种选择是坚持使用 .Net 并使用 .Net 链接器，例如 Salamander .NET Linker 或 Thinstall - 这样您就无需担心客户端计算机上的内容。

# sql - 每组匹配行的比率

> ID：933136
> 
> 赞同：2
> 
> 时间：2009-05-31T23:45:53.440
> 
> 标签：sql, tsql, group-by

我想计算一个组中满足某些条件的项目在该组中的项目总数中的比率。我已经解决了这个问题，但很想知道我的解决方案是否是最优的，因为查询在我的大型（10m+）数据集上花费了很长的时间。

这是我最简单的形式：

```
create table #tableA 
(
    id int IDENTITY(1,1),
    groupid int,
    flag bit,
    CONSTRAINT [PK_TableA] PRIMARY KEY CLUSTERED 
    (
        [id] ASC
    )
)

insert into #tableA (groupid,flag) values (1,0),(1,0),(1,1),(2,0),(2,1)

select 
    a.groupid ,
    cast(totalCount as float)/count(*) as ratio
from 
    #tableA a 
    join 
    (
        select 
            groupid,
            COUNT(*) totalCount 
        from 
            #tableA 
        where 
            flag=1 
        group by 
            groupid
    ) b on a.groupid=b.groupid 
group by 
    a.groupid,
    b.totalCount

drop table #tableA 
```

有没有更有效的方法来编写这个查询？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-31T23:55:08.537

假设`flag`为 0 或 1，这应该有效：

```
select groupid ,
       cast(sum(flag) as float)/count(*) as ratio
from tableA
group by groupid 
```

如果`flag`可以采用其他值，`CASE`则无论如何`IF()`都应该有助于工作。`SUM`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-01T17:19:45.707

select groupid , AVG(cast(flag as float)) as ratio from tableA group by groupid

# c++ - 使用捕获时的 boost::regex 段错误

> ID：933143
> 
> 赞同：4
> 
> 时间：2009-05-31T23:49:32.793
> 
> 标签：c++, boost-regex

下面的简单程序出现段错误。它似乎与析构函数match_results有关。

```
#include <iostream>
#include <vector>
#include <string>
#include <boost/regex.hpp>

using namespace std;

int main(int argc, char *argv)
{
    boost::regex re;
    boost::cmatch matches;

    boost::regex_match("abc", matches, re.assign("(a)bc"));

    return 0;
} 
```

编辑：我正在使用 boost 1.39

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-31T23:55:46.617

boost::regex 是 boost 中少数不只存在于头文件中的组件之一……有一个库模块。

您正在使用的库很可能是使用与您的应用程序不同的设置构建的。

**编辑：找到一个带有**[这个已知 boost bug](https://svn.boost.org/trac/boost/ticket/2535)的示例场景，其中 boost 必须使用与`-malign-double`您的应用程序相同的标志构建。

这是您的 boost 库与您的应用程序不具有二进制兼容性的几种可能情况之一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T00:05:17.033

你用的是哪个版本的boost？

我用 boost 1.36 编译了上面的例子，我没有遇到任何段错误。

如果您有多个 boost 库，请确保在运行时选择正确的版本。

Boost 正则表达式需要针对库进行编译`-lboost_regex-gcc_whatever-is-your- version`

就我而言：

```
g++ -c -Wall -I /include/boost-1_36_0 -o main.o main.cpp
g++ -Wall -I /include/boost-1_36_0 -L/lib/boost-1_36_0 -lboost_regex-gcc33-mt main.o -o x 
```

执行：

```
LD_LIBRARY_PATH=/lib/boost-1_36_0 ./x 
```

您将指向系统上 boost include/libs 的位置，注意库名称中 gcc 和 m(ulti) t(hreaded) 的版本 - 这取决于您编译的内容，只需查看您的 boost lib 目录并选择一个版本的正则表达式库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T08:17:21.393

您正在使用要从中获取匹配项的临时变量。我认为，您的问题将得到解决，如果改为“abc”，您将使用以下内容：

```
string a("abc);
regex_match(a, matches, re.assign("(a)bc")); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-11-01T16:09:32.160

I was having the same problem. I tried the solution posted by Drew Dormann, but it didn't work. Then I discovered that I was actually linking against 1.40, but for some reason the headers were for 1.37\. Once I downloaded the correct headers (1.40), it stopped segfaulting.

I noticed it when I had compiled with the debugging symbols `-g` and run a dbg backtrace..

Hope that helps...

# sharepoint - Sharepoint 作为大容量信息系统

> ID：933148
> 
> 赞同：2
> 
> 时间：2009-05-31T23:53:53.377
> 
> 标签：sharepoint, workflow, scheduling, bdc

我正在考虑在我工作的一家新公司设计一些核心信息系统（在[工作流系统](https://stackoverflow.com/questions/908705/workflow-system)中描述了我的一个想法）

我想得更多，并且正在强烈考虑使用 sharepoint 来完成很多繁重的工作，因为它提供了很多开箱即用的功能。

但是，我不确定它将如何处理我们将向其发送的大量数据。我阅读了 MS 白皮书 ( [http://go.microsoft.com/fwlink/?LinkId=95450&clcid=0x409](http://go.microsoft.com/fwlink/?LinkId=95450&clcid=0x409) )，它说列表中的大约 2000 项是关于使用传统设计方法的限制。

但首先是关于我的计划和数据结构的一些信息：

我们有多个客户。每个客户端都有多个应用程序。每个应用程序将有多个正在进行的作业（或进程运行）。

每个应用程序都将存储重要的通信和文档。每个作业代表单次运行对数据文件的处理，并存储有关作业的信息，例如 postscript 文件、邮政清单等。

工作量约为每天 50 - 100 个。每个作业都有一个由外部程序触发的工作流。然后，例如在“作业调度程序”页面上，生产人员可以安排作业并对作业执行自定义操作（编写为插件）。

我在想这些工作会放在外面并通过 BDC 访问，但我仍然希望它们出现在共享点列表中，以添加共享点功能和报告，并且可以在多个地方访问它们

例如

*   申请门户 - 查看申请职位
*   生产调度程序 - 查看即将进行的作业列表、分配给资源、触发其他功能（例如将打印文件复制到打印机、生成邮件机文件）
*   发票视图 - 查看已完成但未开票的工作，导出到会计包
*   客户视图 - 客户门户显示工作、发票、库存水平（来自外部仓库系统）、文档、变更登记/帮助台

因此，有关作业的基本信息将位于 BDC 中，但随后 sharepoint 将捕获有关每个作业的附加元数据。此外，我们可能会使用 WF 或 K2 blackpoint / blackpearl 之类的东西加入更高级的工作流程。

这可行吗？您建议阅读任何资源以加快速度吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-01T22:18:29.320

要使用 SharePoint，您应该专注于 SharePoint 擅长什么以及它的设计目的。

SharePoint 是一个很棒的协作门户，它不如简单的大容量数据库好。所以...

您可以为每个客户设置一个小站点，并为每个作业设置子站点。“工作站点”的目标是显示（可能使用 Web 部件）相关的即将到来的工作、工作错误/异常列表以及每个工作的相关团队文档。

可以创建单独的站点以给出工作的特定“视图”。例如，可以创建一个“发票”站点以再次从 BDC Webparts 中查看需要发票的内容。

[https://iwsolve.partners.extranet.microsoft.com/SDPS/](https://iwsolve.partners.extranet.microsoft.com/SDPS/)可能会提供一些帮助。

不要试图在 SharePoint 列表中存储大量信息，因为它可能会用元数据“标记”它。如果需要，数据库表完全能够包含提供附加信息的列。

这样想吧。如果您每天创建 50 到 100 个作业，则将这些数据放入列表中的前提是您的站点用户将希望手动输入这些作业的元数据。我认为不是，因此创建您需要的系统，以便在源中正确存储元数据，或在 SharePoint 列表中存储有关作业“类型”的元数据，并允许 SharePoint 将作业类型与 BDC 中的作业相匹配。

SharePoint 将帮助您将所有系统信息集成在一起，但不幸的是，您似乎有很多工作要做，只是计划哪些信息应该去哪里以及每种类型的用户将如何查看它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T22:50:25.107

请查看我写的这篇关于管理大型 SharePoint 列表以获得更好性能的[博客文章](http://sharepoint.microsoft.com/blogs/GetThePoint/Lists/Posts/Post.aspx?ID=162)- 它可能会为 2,000 项问题提供一些解释，这实际上并不是对列表中项目数量的硬性限制，因为SharePoint 将支持每个列表最多 500 万个项目。解决此问题的一种方法是创建和维护按索引字段过滤的不同视图，以向您显示不同的项目，一次最多 2,000 个。希望有帮助。

Dina Ayoub 项目经理 Windows SharePoint Services

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T02:26:34.783

棘手的问题 Dane... 在发表意见之前，我想进一步了解您的设计/愿景。

根据我在您的问题中读到的内容，我不会将 SharePoint 2007 用作此应用程序的开发平台。

1) 在 SharePoint 2007 中的开发体验有时会很痛苦，而且效率低下。

*   难以调试
*   陡峭的学习曲线

2）容易陷入性能问题

*   数据层很复杂，可能需要专业的 SQL/SharePoint 管理员技能来扩展平台。
*   内容数据库不应超过 100 GB。

3) 部署可能非常困难，具体取决于您在做什么。

4) 新版本将在未来 12 个月内发布。

只是我的 .02。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T05:17:34.713

SharePoint 可能非常适合 UI 方面，但您需要仔细考虑哪些部分存储和修改在 SharePoint 列表中，哪些部分存储在其他位置。这与其说是 SharePoint 问题，不如说是当您拥有多个数据源时您必须始终处理的问题。

我可能会使用 SharePoint 列表作为作业的主要存储，以避免任何同步问题并使编辑更容易。数据量应该不是问题——只要确保你没有尝试一次显示 2000 个项目——在大量项目上遇到性能问题的是视图，而不是列表本身。

# ruby-on-rails - 如何将参数传递给 Rails 中持续存在验证错误的表单？

> ID：933153
> 
> 赞同：1
> 
> 时间：2009-05-31T23:56:47.303
> 
> 标签：ruby-on-rails

我正在尝试在 Rails 中创建分层菜单系统。我的菜单模型是树形数据结构，我需要将父级信息传递给新操作。我发现这样做的最好方法是将父母的 id 作为查询字符串传递。这有效，除非验证阻止创建。问题是新视图渲染后，url中不再存在该参数。

我走错路了吗？我应该只在会话中坚持价值吗？我是否应该创建一个下拉列表来选择父项（我宁愿让用户单击“在此处添加新项”）。这一定是一个普遍的问题，但我还没有找到任何相关的东西。

更新：为了澄清一个问题，我尝试执行以下操作以在失败情况下呈现视图时传递参数，但此时已经设置了 url（我们已经发布到控制器的基本 url）。

```
format.html { render :action => "new", :parent_id=> params[:parent_id] } 
```

我需要另一种方式来传递参数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T00:44:27.907

我想到了。我刚刚添加了一个隐藏字段来保存 parent_id。当浏览器请求新表单时，我将 parent_id 放入模型对象中，并将其保留在 psotback 上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T00:14:07.470

不是 100% 清楚你想要达到的目标。

操作验证失败后，是否再次渲染视图？你不能把 parent_id 作为参数传递给这个视图吗？

# css - 精灵图像的最佳方式？

> ID：933165
> 
> 赞同：6
> 
> 时间：2009-06-01T00:06:57.250
> 
> 标签：css, css-sprites

我现在要在 www.trailbehind.com 上显示图像。

大多数图像是由 JavaScript 函数加载的，我有很多小图像，例如地图图标。

有没有支持这个的软件？我知道如果您的图像在 Django 模板中，您可以使用 Django-sprites。如果您想编写一些 Java 代码，您可以类似地使用 GWT。

对于带有 Javascript 前端的 Python/Django 网站来说，最好的方法是什么？除非用户关闭了 JavaScript，否则我从不显示任何 HTML。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-02-21T09:10:20.377

您也可以使用[胶水](http://gluecss.com/)。它是一个用于生成 css sprites 的开源命令行工具。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-01T00:14:23.693

有一个[在线精灵生成器。](http://spritegen.website-performance.org/)这可以极大地帮助该过程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T01:25:20.037

[SpriteMe](http://spriteme.org/)是一个不错的选择，它可以用作书签，因此您可以轻松地在任何您必须看到潜在收益的网站上运行它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-19T08:03:13.020

如果您想生成更紧凑的精灵输出，请尝试[ZeroSprites](http://zerosprites.com/)。

[ZeroSprites](http://zerosprites.com/)使用 VLSI 布局规划算法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-12T19:13:48.117

您可以使用[http://draeton.github.com/stitches/](http://draeton.github.com/stitches/)是一个 HTML5 在线应用程序。（使用现代浏览器打开）

您只需拖放图像，就可以生成精灵图像和 css 代码以在样式表中使用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-01-05T09:36:28.120

如果您在 Mac 上，则可以使用此工具。这些工具以一种有效的方式对精灵进行排序，并生成可能的最小精灵表。他们还会自动为您生成 CSS 输出。因此，您无需与坐标或计算像素作斗争。您可以为此使用[Sprite Master](http://www.mobinodo.com/spritemaster)。

# c++ - 在第二个模板（STL 容器）中使用模板参数

> ID：933172
> 
> 赞同：2
> 
> 时间：2009-06-01T00:12:58.267
> 
> 标签：c++, design-patterns, templates

我是一个尝试模板和设计模式的菜鸟，并且想使用模板参数 ITEM 创建一个迭代器模式。但是，我的私有成员 var 是一个 STL 容器，它本身就是一个模板，那么如何将 STL 容器的模板参数“同步”到类模板使用的参数？

这是实际的类：

```
#include "StatusIteratorInterface.h"
#include "StatusContainer.h"
#include <map>

template<typename ITEM> class StatusContainer;

template <typename ITEM>
class StatusIterator : public StatusIteratorInterface<ITEM> {

public:
    StatusIterator( StatusContainer<ITEM>* container );

    ITEM* getFirst( void );
    ITEM* getNext( void );
    bool isDone( void );
    ITEM* getCurrent( void );

private:
    StatusContainer<ITEM>* container_;
    ITEM* currentItem_;
    std::multimap< std::pair<std::string, uint32_t>, ITEM >::iterator conIter1_; //gives error
    std::multimap< std::pair<string, uint32_t>, uint32_t>::iterator conIter_;
}; 
```

conIter_ 很好，但是“硬编码”我的模板值。包括它上面的行给出了这个编译错误：

```
/Users/joe/Developer/Template_DesignPattern_Iterator/StatusIterator.h:33: error: expected ';' before 'conIter1_' 
```

我有一个可以很好地编译和运行此代码的 main，但显然只适用于 uint32_t 类型。请原谅我使用了不正确的术语，例如“模板参数”和“模板参数”。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-01T00:16:08.760

这是 C++ 中常见的绊脚石。因为`ITEM`在解析该类时是未知的，所以编译器无法推断出您的迭代器确实是一种类型。

更改此行：

```
std::multimap< std::pair<std::string, uint32_t>, ITEM >::iterator conIter1_; 
```

首先`typename`，表明它是一种类型：

```
typename std::multimap< std::pair<std::string, uint32_t>, ITEM >::iterator conIter1_; 
```

您正在使用名称中包含模板参数的类型。

那是你需要使用的时候**`typename`**。

# wxpython - Wx.choice 在 ubuntu 中不起作用

> ID：933177
> 
> 赞同：3
> 
> 时间：2009-06-01T00:17:03.627
> 
> 标签：wxpython

我只会说西班牙语，我会尽量用我蹩脚的英语写，对不起。

我正在学习 wx.Python，我在 Windows XP 中编写了一个小示例并运行完美，但 ubuntu Jaunty 中的相同代码运行不佳。

wx.Choice 的字体显示为desfased，选项几乎不可见，当您选择一个时，Label 始终为空。

hxxp://ricardonarvaja.info/WEB/OTROS/BOA%20CONSTRUCTOR%20PASO%20A%20PASO/instantanea1.png

```
enter code here
#Boa:Frame:Frame1

import wxversion
wxversion.select('2.8')
import wx

print wx.version()
def create(parent):
    return Frame1(parent)

[wxID_FRAME1, wxID_FRAME1BUTTON1, wxID_FRAME1CHOICE1, wxID_FRAME1PANEL1, 
 wxID_FRAME1TEXTCTRL1, wxID_FRAME1TEXTCTRL2, 
] = [wx.NewId() for _init_ctrls in range(6)]

class Frame1(wx.Frame):
    def _init_sizers(self):
        # generated method, don't edit
        self.boxSizer1 = wx.BoxSizer(orient=wx.VERTICAL)

    def _init_ctrls(self, prnt):
        # generated method, don't edit
        wx.Frame.__init__(self, id=wxID_FRAME1, name='', parent=prnt,
              pos=wx.Point(473, 288), size=wx.Size(364, 190),
              style=wx.DEFAULT_FRAME_STYLE, title='Frame1')
        self.SetClientSize(wx.Size(356, 156))

        self.panel1 = wx.Panel(id=wxID_FRAME1PANEL1, name='panel1', parent=self,
              pos=wx.Point(0, 0), size=wx.Size(356, 156),
              style=wx.TAB_TRAVERSAL)

        self.textCtrl1 = wx.TextCtrl(id=wxID_FRAME1TEXTCTRL1, name='textCtrl1',
              parent=self.panel1, pos=wx.Point(40, 16), size=wx.Size(100, 21),
              style=0, value=u'')
        self.textCtrl1.Bind(wx.EVT_SET_FOCUS, self.OnTextCtrl1SetFocus)

        self.textCtrl2 = wx.TextCtrl(id=wxID_FRAME1TEXTCTRL2, name='textCtrl2',
              parent=self.panel1, pos=wx.Point(40, 48), size=wx.Size(100, 21),
              style=0, value=u'')
        self.textCtrl2.Bind(wx.EVT_SET_FOCUS, self.OnTextCtrl2SetFocus)

        self.button1 = wx.Button(id=wxID_FRAME1BUTTON1, label=u'SUMAR',
              name='button1', parent=self.panel1, pos=wx.Point(140, 101),
              size=wx.Size(75, 23), style=0)
        self.button1.Center(wx.HORIZONTAL)
        self.button1.Bind(wx.EVT_BUTTON, self.OnButton1Button,
              id=wxID_FRAME1BUTTON1)

        self.choice1 = wx.Choice(choices=['suma', 'resta', 'mult'],
              id=wxID_FRAME1CHOICE1, name='choice1', parent=self.panel1,
              pos=wx.Point(160, 40), size=wx.Size(146, 21), style=0)
        self.choice1.Bind(wx.EVT_CHOICE, self.OnChoice1Choice,
              id=wxID_FRAME1CHOICE1)

        self._init_sizers()

    def __init__(self, parent):
        self._init_ctrls(parent)

    # XXX Este codigo esta sin terminar
    def OnButton1Button(self, event):

        print self.choice1.Label
        try:
            if self.choice1.Label=='suma':
                suma=int(self.textCtrl1.Value)+int(self.textCtrl2.Value)
                self.button1.Label='Suma = ' + str(suma)
            if self.choice1.Label=='resta':
                suma=int(self.textCtrl1.Value)- int(self.textCtrl2.Value)
                self.button1.Label='Resta = ' + str(suma)
            if self.choice1.Label=='mult':
                suma=int(self.textCtrl1.Value) * int(self.textCtrl2.Value)
                self.button1.Label='Mult = ' + str(suma)
        except:
            self.button1.Label='Error tipo de datos'
            self.textCtrl1.Value=''
            self.textCtrl2.Value=''

        event.Skip()

    def OnTextCtrl1SetFocus(self, event):
        self.textCtrl1.Value=''
        print self.choice1.Label
        if self.choice1.Label=='suma':
            self.button1.Label='SUMAR'
        if self.choice1.Label=='resta':
            self.button1.Label='RESTAR'
        if self.choice1.Label=='mult':
            self.button1.Label='MULT'
        event.Skip()

    def OnTextCtrl2SetFocus(self, event):
        self.textCtrl2.Value=''
        print self.choice1.Label
        if self.choice1.Label=='suma':
            self.button1.Label='SUMAR'
        if self.choice1.Label=='resta':
            self.button1.Label='RESTAR'
        if self.choice1.Label=='mult':
            self.button1.Label='MULT'
        event.Skip()

    def OnChoice1Choice(self, event):

        if self.choice1.Label=='suma':
            self.button1.Label='SUMAR'
        if self.choice1.Label=='resta':
            self.button1.Label='RESTAR'
        if self.choice1.Label=='mult':
            self.button1.Label='MULT'

        event.Skip()

if __name__ == '__main__':
    app = wx.PySimpleApp()
    frame = create(None)
    frame.Show()

    app.MainLoop() 
```

打印**self.choice1.Label**在 ubuntu 中总是打印 EMPTY，而在 Windows 中打印 suma、resta 或 mul，wx.choice 的选项之一，如何预期。

里克纳尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T00:34:15.057

使用是错误的`self.choice1.Label`；在你的代码中替换它，你`self.choice1.StringSelection`的代码就可以工作了！

# c# - C#中的日期时间选择器

> ID：933180
> 
> 赞同：0
> 
> 时间：2009-06-01T00:19:49.750
> 
> 标签：c#, .net

我正在开发 C# 应用程序，并希望允许用户在 datetimepicker 中输入时间和日期。请让我知道如何实现这一点

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-01T00:33:22.283

您需要指示 DateTimePicker 控件使用自定义格式，并提供包含时间元素的格式：

```
this.dateTimePicker1.CustomFormat = "MMMM dd, yyyy hh:mm";
this.dateTimePicker1.Format = System.Windows.Forms.DateTimePickerFormat.Custom; 
```

您也可以在设计器中执行此操作。

# windows - 本地计算机上的 windows mailslot 最大大小

> ID：933184
> 
> 赞同：1
> 
> 时间：2009-06-01T00:21:23.507
> 
> 标签：windows, winapi, ipc

在本地计算机中研究 IPC 的 windows mailsots 后，我对数据报的最大大小有点困惑。MSDN 说

[“邮槽是驻留在内存中的伪文件，您可以使用标准文件函数来访问它。邮槽消息中的数据可以是任何形式，但在计算机之间发送时不能大于 424 字节。与磁盘文件不同，邮槽“](http://msdn.microsoft.com/en-us/library/aa365130(VS.85).aspx)

“在计算机之间发送时”让我感到困惑。如果数据仅从一个本地进程发送到同一台机器上的另一个进程，是否有最大大小？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T01:56:00.883

我自己找到了答案。是的，如果进程在同一台本地计算机上，它可以接收超过 400 个字节。它最多可以接收邮件槽缓冲区发送到的数量

# javascript - 帮助使用 javascript submit() 函数将表单提交到 JQuery 脚本

> ID：933186
> 
> 赞同：0
> 
> 时间：2009-06-01T00:22:11.773
> 
> 标签：javascript, jquery

上周我试图在没有解决方案的情况下提出这个问题。我仍然无法让它工作。我想做的是将通过 WYSIWYG **javascript**编辑器输入的数据提交到我拥有的 JQuery 脚本，该脚本将首先告诉用户他们是否正在尝试提交一个空的文本框我需要做的最后一件事是告诉用户他们的数据输入成功与否。

我在 JQuery 脚本中遇到问题，因为单击保存按钮时没有执行任何操作。

此编辑器使用绑定到编辑器上的小保存图标的 javascript submit()。当用户按下编辑器上的按钮时，它会触发我在表单标签中的功能。这大约是我所能得到的。

我认为表单标签属性存在问题，因为当我单击编辑器上的**任意位置**时，编辑器会从屏幕底部跳下。我相信这与我在表单标签中的 onclick 事件有关。

JQuery 脚本的第一部分应该处理文本区域的表单验证。如果这真的很难开始工作，我愿意放手，只处理服务器端的所有事情，但我只需要将数据发布到 JQuery 脚本，以便我可以将其发送到我的 php 脚本。

谢谢你们的帮助。

```
<form name="rpt" class="rpt" id="rpt" action="" onclick="doSave(); return false;"> 
```

* * *

```
function doSave()
{
  $(function()
  {
    $('.error').hide();
    $(".rpt").click(function()
    {
      $('.error').hide();
      var textArea = $('#report');
      if (textArea.val() == "")
      {
        textArea.show();
        textArea.focus();
        return false;
      }
      else
      {
          return true;
      }
        var dataString = '&report='+ report;
        alert (dataString);return false;

      $.ajax({
          type: "POST",
          url: "body.php?action=customer",
          data: dataString,
          dataType: 'json',
          success: function(data){
              $('#cust input[type=text]').val('');
              var div = $('<div>').attr('id', 'message').html(data.message);
              if(data.success == 0) {
                  $('#cust input[type=text]').val('');
                  $(div).addClass('ajax-error');
              } else {
                  $('#cust input[type=text]').val('');
                  $(div).addClass('ajax-success');
              }
              $('body').append(div);
            }
      });
      return false;
    });
  });
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T00:44:48.640

您需要更改一些内容。首先这个：

```
<form name="rpt" class="rpt" id="rpt" action="" onclick="doSave(); return false;"> 
```

不是 jQuery 的方式。加上它不是您想要的 click() 事件。做这个：

```
<form name="rpt" class="rpt" id="rpt" action="">

<script type="text/javascript">
$(function() {
  $("#rpt").submit(do_save);
});
</script> 
```

那个工程：

```
$(function() {
  ..
}); 
```

意思是“当文档准备好时，执行这段代码”。它是略长一点的简写，完全等同于：

```
$(document).ready(function() {
  ..
}); 
```

这段代码：

```
$("#rpt").submit(doSave); 
```

意思是“找到 id 为 'rpt' 的元素并为其附加一个事件处理程序，这样当在其上执行 'submit' 事件时，调用 do_save() 函数”。

并将 doSave() 更改为：

```
function doSave() {
  $('.error').hide();
  $(".rpt").click(function() {
    $('.error').hide();
    var textArea = $('#report');
    if (textArea.val() == "") {
      textArea.show();
      textArea.focus();
      return false;
    } else {
      return true;
    }
    var dataString = '&report='+ report;
    alert (dataString);return false;

    $.ajax({
      type: "POST",
      url: "body.php?action=customer",
      data: dataString,
      dataType: 'json',
      success: function(data){
        $('#cust input[type=text]').val('');
        var div = $('<div>').attr('id', 'message').html(data.message);
        if (data.success == 0) {
          $('#cust input[type=text]').val('');
          $(div).addClass('ajax-error');
        } else {
          $('#cust input[type=text]').val('');
          $(div).addClass('ajax-success');
        }
        $('body').append(div);
      }
    });
  });
  return false;
} 
```

**注意：** return false 现在在正确的位置，因此它实际上阻止了表单提交回服务器。action="" 仅表示表单将提交回其当前位置，因此您必须防止这种情况发生。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T00:27:11.220

```
function X() {
    $(function() {
        //... things you want to do at startup
    });
}; 
```

不做你想做的事。什么都不会被执行，因为你从来没有告诉它被执行。

您可能想尝试以下方法：

```
<script type="text/javascript">
    jQuery(function($) {
        //... things you want to do at startup
    });
</script> 
```

另外，您想要`onsubmit`. `form`您可以使用

```
$('#theform').submit(function() {
    //... perform the ajax save
}); 
```

此外，您可能需要查看[表单插件](http://malsup.com/jquery/form/)。

# c# - 如何在托管代码中编组子集字节 [] 数组？

> ID：933192
> 
> 赞同：0
> 
> 时间：2009-06-01T00:32:29.023
> 
> 标签：c#

考虑以下方法（在工厂方法中使用）：

```
private Packet(byte[] rawBytes, int startIndex)
{
    m_packetId = BitConverter.ToUInt32(rawBytes, startIndex);
    m_dataLength = BitConverter.ToUInt16(rawBytes, startIndex + 4);
    if (this.Type != PacketType.Data)
        return;
    m_bytes = new byte[m_dataLength];
    rawBytes.CopyTo(m_bytes, startIndex + Packet.HeaderSize);
} 
```

最后两行代码让我觉得很浪费。分配更多内存并用内存中的值填充它似乎很愚蠢。

使用非托管代码，可能会出现这样的情况：

```
 m_bytes = (rawBytes + (startIndex + Packet.HeaderSize)); 
```

（我没有通过编译器运行它，所以语法可能是关闭的，但你可以看到这只是指针操作的问题。）

前几天我遇到了一个类似的问题，当 API 返回一个实际上是一个 short[] 数组的 byte[] 数组时。

这些类型的数组排列仅仅是使用托管代码的成本，还是我只是缺少一种新的思想流派？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T00:41:41.907

您是否考虑过重组，以便可能不需要副本？

`rawBytes`第一个选项：存储对in的引用`m_bytes`并将需要添加到所有访问的偏移量存储到此字节数组中。

第二种选择：改为`m_bytes`使用`MemoryStream`缓冲区、偏移量和长度构造；此构造函数也不复制字节缓冲区，只允许访问指定的子段。

请记住，避免复制操作的代价是`rawBytes`and `m_bytes`（数组或流）将是别名，因此对一个的更改也会改变另一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T00:34:13.623

是的，这在托管代码中成本更高，但没有什么能阻止您创建此方法`unsafe`并执行您希望执行的指针操作。

# glib - Glib 有多个分支吗？

> ID：933194
> 
> 赞同：0
> 
> 时间：2009-06-01T00:34:12.857
> 
> 标签：glib

我正在尝试从源代码构建 Firefox，但我对某些要求感到困惑。

我正在尝试构建需要 glib 的 libIDL。我构建了 glib 并将其安装到 /usr/local，但是当我尝试配置 libIDL 时，出现以下错误：

```
checking for LIBIDL... configure: error: Package requirements (glib-2.0 >= 2.4.0) were not met:

No package 'glib-2.0' found 
```

我使用了我能找到的最新版本的 glib， ftp: [//ftp.gtk.org/pub/glib/2.20/glib-2.20.3.tar.gz](ftp://ftp.gtk.org/pub/glib/2.20/glib-2.20.3.tar.gz)

但是，我也一直在四处搜索并看到对 libglib-2.0 的引用，例如[http://packages.debian.org/search?keywords=libglib2.0-dev](http://packages.debian.org/search?keywords=libglib2.0-dev)

Glib 是否有 2 个不同的分支，例如 v1 和 v2？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T04:59:10.167

您需要安装**glib-devel**以使 glib 标头存在于您的系统上。如果没有标头，autoconf 会将库标记为缺失。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-02-16T03:58:50.357

您从应该可以工作的源代码安装了 glib。实际问题很可能与您选择安装的路径有关。autoconf 脚本可能没有在您安装它的地方寻找 glib，或者它可能首先查看另一个目录并找到旧版本。

# ruby - 在 ruby 中使用散列密码

> ID：933199
> 
> 赞同：5
> 
> 时间：2009-06-01T00:35:07.973
> 
> 标签：ruby, security

首先，我想承认自己是密码学和密码安全的新手。我正在尝试将密码存储在由 ruby​​ 托管的数据库中。我的理解是明文密码应该附加到一个随机的“盐”中，并且整个短语应该通过一些散列算法进行散列，例如：

```
 Digest::SHA1.hexdigest(salt_plus_plainpassword) 
```

一旦该字符串存储在数据库中，如果附加了一个现在未知的随机盐，如何再次将其取出以验证用户输入的内容是否正确？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-01T01:40:07.607

最好的方法是为每个用户存储一个盐，它是根据他们执行此操作时的时间生成的。

确实，一旦有人可以访问您的数据库，他们就可以看到用户的盐，但如果发生这种情况，您需要担心更大的事情。

检查用户密码的方法是获取他们的明文输入并用盐对其进行加密，然后比较 crypted_pa​​sswords，如果它们匹配，则它们已通过身份验证。我不相信储存盐是一个问题，因为你需要它。如果您担心 SQL 注入攻击，您最好保护您的应用程序免受攻击，而不是不存储您需要的信息，在这种情况下，每个用户都会加盐。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T09:35:52.980

从理论上讲，盐有两个主要目的。首先是防止重复的密码在数据库中得到相同的哈希值。二是增加密码的长度，从而也增加了攻击者猜测密码的难度。

但是存在存储盐的问题，如果你将它插入数据库，第二个目的就有点失败了，以防有人抓取该数据，理想情况下它应该存储在不同的位置，但这只有在你的应用程序非常重要的情况下才有必要敏感的！

如果您的应用程序的代码不是公开的，我会说一种可能的方法来规避这个问题是根据每个用户的静态值生成盐，比如创建日期或用户名，因为如果有人读取数据库，它就是不清楚你是否使用盐...

# c++ - Mac 上的 C++/Windows SendMessage() 等价物（如果有的话）是什么？

> ID：933203
> 
> 赞同：1
> 
> 时间：2009-06-01T00:39:58.977
> 
> 标签：c++, objective-c, windows, macos

Mac OS 中是否有与[SendMessage等效的功能？](http://msdn.microsoft.com/en-us/library/ms644950(VS.85).aspx)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-01T00:42:27.037

具有讽刺意味的是，Objective-C 中的每个方法调用都相当于 SendMessage。Objective-C 本质上是一个消息传递系统。

所以你只说：

```
[window myMessage] 
```

并且 myMessage 例程将通过将 myMessage 传递给 Window 对象并让它处理该方法来执行...

也可能更接近您真正想要做的事情是使用通知在组件之间传递消息。

如果您在编译时没有 Window 对象，编译器可能会抱怨它不知道 Window 是否可以处理您发送的消息。对于这些情况，您可以使用：

```
[window performSelector:@selector(myMessage)] 
```

此调用的其他版本允许将对象作为参数传递。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T01:48:25.813

这取决于您使用 SendMessage() 发送的消息。例如， Cocoa 中的大多数事件都会通过`-[NSApplication sendEvent:]`，或者`SendEventToEventTarget()`如果您想要一个较低级别的版本。对于其他消息，例如调整大小、移动等，您需要查看 NSWindow（例如`-setFrame:animated:`）或 NSApplication 的适当方法。

一般来说，不像 SendMessage() 那样使用漏斗例程和函数常量，在 Cocoa 中，您只需获取相关对象并调用其方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T00:52:42.867

在更高的层次上，如果您谈论的是 Carbon 事件管理器，您将使用函数“SendEventToEventTarget”

请参阅[http://developer.apple.com/documentation/Carbon/Reference/Carbon_Event_Manager_Ref/Reference/reference.html](http://developer.apple.com/documentation/Carbon/Reference/Carbon_Event_Manager_Ref/Reference/reference.html)

# jquery - jQuery 表单提交/效果改进？

> ID：933205
> 
> 赞同：0
> 
> 时间：2009-06-01T00:40:13.937
> 
> 标签：jquery

我正在制作一个使用 jQuery ajax.form 插件提交的向下滑动登录表单。效果有效，提交有效。但是当你把它们放在一起时，它们就不起作用了......

这是针对表达式引擎的，所以 {if} 标签只是 EE 条件。看到用户登录后内容会发生变化——我只需要重新加载它以便内容发生变化——我认为做一堆 .html() 重写会更容易......一旦表单是提交后，正确的内容会重新加载并且可以点击，但“#panel”不会重新设置动画。

```
<div id="client-login">
<div class="wrap">
<p  class="work-message">We're doing some work under the hood!  If things get/are funky, please excuse us!</p>
    {if logged_out}
    <div id="client" class="login">Client Login</div>
    {/if}
    {if logged_in}
    <div id="client" class="login">Hey, {username}!</div>
    {/if}
</div>
</div>
<div id="panel">
    <div id="panel-content" class="wrap">
    {if logged_out}
    {exp:member:login_form id="login-form"}
    <ul>
    <li>
    <label><span>Username</span></label>
    <input type="text" name="username" value="" maxlength="32" class="input" size="25" />
    </li>
    <li>
    <label><span>Password</span></label>
    <input type="password" name="password" value="" maxlength="32" class="input" size="25" />
    </li>
    <li class="login-forgot">
    <a href="{path='member/forgot_password'}">Forgot your password?</a>
    </li>
    {if auto_login}
    <li class="checkbox">
    <input class='checkbox' type='checkbox' name='auto_login' value='1' /> Auto-login on future visits
    </li>
    {/if}
    </ul>
    <p>
    <input type="submit" id="panelsubmit" name="submit" value="Submit" />
    </p>
    {/exp:member:login_form}
    {/if}
    <div id="messages">
    <p></p>
    </div>
{if logged_in}
    <div id="logout">
        <h2>What do ya wanna' do?!</h2>
        <form id="login-form" >

          <input type="hidden" name="ACT" value="10" />

          <input type="submit" value="Log Out" />

        </form> 
    </div>
{/if}

$(document).ready(function()
{
$('.login').toggle(
function()
{
  $('#panel').stop().animate({
  height: "150", 
  padding:"20px 0",
  backgroundColor:'rgba(0,0,0,0.8)',
 }, 500);
 $('#client-login').stop().animate({
  backgroundColor:'rgba(0,0,0,0.8)',
 }, 500);
},
function()
{
  $('#panel').stop().animate({
    backgroundColor:'rgba(0,0,0,0.2)',
  height: "0", 
  padding:"0px 0",
  }, 500);     
 $('#client-login').stop().animate({
  backgroundColor:'rgba(0,0,0,0.2)',
 }, 500);

});

    $('#login-form').ajaxForm({  
        // success identifies the function to invoke when the server response 
        // has been received; here we apply a fade-in effect to the new content 
        success: function() { 
            $("#client").remove().fadeOut("fast");
            $("#client-login").load("/ #client-login").fadeIn("fast");
            $("#panel-content").remove().fadeOut("fast");
            $("#panel").load("/ #panel-content").fadeIn("fast");

        } 
    }); 
}); 
```

功能基本上就在那里，但是表单在提交后需要像以前一样工作！此外， .remove 的动画也不起作用。我是 JavaScript 新手，不知道如何改进。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-01T00:46:23.147

由于您通过 AJAX 加载内容，因此在重新加载之前存在的动画和功能将不再起作用，因为效果仅绑定到原始元素。要解决此问题，您需要将加载的内容重新绑定到动画等。

有几种方法可以做到这一点。首先，您可以将动画功能重新应用于加载的内容。例如，一旦加载了内容，调用一个将动画重新绑定到新元素的函数。

其次，更容易的是，您可以使用 jQuery **live()**函数。**这是我认为更好的方法。**live() 函数绑定所有当前和未来的元素，而不仅仅是绑定当前元素。因此，在创建动画时，请在 live() 函数中创建它。[这是来自http://docs.jquery.com/Events/live](http://docs.jquery.com/Events/live)的使用示例：

```
$("p").live("click", function(){
  $(this).after("<p>Another paragraph!</p>");
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T01:50:17.010

```
$('.login').toggle(
function()
{
          $('#panel').stop().animate({
          height: "150", 
          padding:"20px 0",
          backgroundColor:'rgba(0,0,0,0.8)',
         }, 500);
         $('#client-login').stop().animate({
          backgroundColor:'rgba(0,0,0,0.8)',
         }, 500);
    },
    function()
    {
          $('#panel').stop().animate({
            backgroundColor:'rgba(0,0,0,0.2)',
          height: "0", 
          padding:"0px 0",
          }, 500);     
         $('#client-login').stop().animate({
          backgroundColor:'rgba(0,0,0,0.2)',
         }, 500); 
```

});

```
$('#login-form').ajaxForm({  
    // success identifies the function to invoke when the server response 
    // has been received; here we apply a fade-in effect to the new content 
    success: function() { 
        $("#client-login .wrap").fadeOut('slow');
        $("#client-login .wrap").remove();          
        $("#client-login").load("/ #client-login").fadeIn(2000);
        $("#panel-content").fadeOut('slow');
        $("#panel").load("/ #panel-content").fadeIn(2000);
         $('#panel').animate({
            backgroundColor:'rgba(0,0,0,0.2)',
          height: "0", 
          padding:"0px 0",
          }, 500);   
         $('#client-login').animate({
          backgroundColor:'rgba(0,0,0,0.2)',
         }, 500);
    } 
}); 
```

所有动作都发生在“标题”div中......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T22:01:09.620

好吧，这就是我所拥有的，它似乎工作......有没有更好的方法来做到这一点？

```
$(document).ready(function()
{
$("#client-login").css({backgroundColor:'rgba(0,0,0,0.2)'});
$(".login").live('mouseover', function(){ 
    $(".login").toggle(
    function()
    {
              $('#panel').stop().animate({
              height: "150", 
              padding:"20px 0",
              backgroundColor:'rgba(0,0,0,0.8)',
             }, 500);
             $('#client-login').stop().animate({
              backgroundColor:'rgba(0,0,0,0.8)',
             }, 500);
        },
    function()
    {
              $('#panel').stop().animate({
                backgroundColor:'rgba(0,0,0,0.2)',
              height: "0", 
              padding:"0px 0",
              }, 500);     
             $('#client-login').stop().animate({
              backgroundColor:'rgba(0,0,0,0.2)',
             }, 500);
});
});
$(".login").live('mouseover', function(){ 

    $('#login-form').ajaxForm({  
        // success identifies the function to invoke when the server response 
        // has been received; here we apply a fade-in effect to the new content 
        success: function() { 
            $("#client-login .wrap").fadeOut('slow');
            $("#client-login .wrap").remove();          
            $("#client-login").load("/ #client-login").fadeIn(2000);
            $("#panel-content").fadeOut('slow');
            $("#panel").load("/ #panel-content").fadeIn(2000);
             $('#panel').animate({
                backgroundColor:'rgba(0,0,0,0.0)',
              height: "0", 
              padding:"0px 0",
              }, 500);   
             $('#client-login').animate({
              backgroundColor:'rgba(0,0,0,0.2)',
             }, 500);
        } 
    }); 
    }); 
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T22:44:38.357

我得到了它！

```
$(document).ready(function(){
    $("#client-login").css({backgroundColor: 'rgba(0,0,0,0.2)'});
    var speed = 300;
    var openpanel = function() {
            $("#client-login").stop().animate({
                backgroundColor: 'rgba(0,0,0,0.8)'
                },speed);
            $("#panel").stop().animate({
                backgroundColor: 'rgba(0,0,0,0.8)',
                height: '200px'
                },speed);
            $('#panel').removeClass("closed");
        };
    var closepanel = function() {
            $("#client-login").stop().animate({
                backgroundColor: 'rgba(0,0,0,0.2)'
                },speed);
            $("#panel").stop().animate({
                backgroundColor: 'rgba(0,0,0,0.2)',
                height: '0px'
                },speed);
            $('#panel').addClass("closed");
        };
    $(".login").live("click",function() {
       if ($("#panel").hasClass("closed"))
       {
            openpanel();
       } else {
            closepanel();
       };
    $('#login-form').ajaxForm({
      // success identifies the function to invoke when the server response
      // has been received; here we apply a fade-in effect to the new content
      success: function() {
        closepanel();
        $("#client-login").load("/ #client-login");
        $("#panel").load("/ #panel-content", 1000);
        }
    });
    });
}); 
```

谢谢你的帮助，詹姆斯！

# iphone - 在 UIScrollView 中理解这段话有问题

> ID：933207
> 
> 赞同：2
> 
> 时间：2009-06-01T00:40:53.670
> 
> 标签：iphone

我在 UIScrollView 的文档中无法理解这一点：

“管理滚动视图中显示的内容绘制的对象应该平铺内容的子视图，这样视图就不会超过屏幕的大小。当用户在滚动视图中滚动时，这个对象应该根据需要添加和删除子视图。”

使用滚动视图的目的不是管理大于包含滚动视图的子视图吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-01T04:14:47.140

这样做是为了在显示大量数据时限制内存使用和其他开销。这与 UITableView 的文档建议您重用您提供给它的单元格的原因相同。

# algorithm - 是否可以根据文本结构猜测用户的心情？

> ID：933212
> 
> 赞同：56
> 
> 时间：2009-06-01T00:43:30.140
> 
> 标签：algorithm, nlp

我假设需要使用自然语言处理器来解析文本本身，但是对于基于用户编写的文本检测用户情绪的算法，您有什么建议？我怀疑它会非常准确，但我仍然感兴趣。

编辑：我绝不是语言学或自然语言处理方面的专家，所以如果这个问题过于笼统或愚蠢，我深表歉意。

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2009-06-06T07:12:51.313

这是称为[情感分析](http://en.wikipedia.org/wiki/Sentiment_analysis)的自然语言处理领域的基础。尽管您的问题很笼统，但它肯定并不愚蠢-例如，亚马逊对产品评论中的文本进行了此类研究。

如果您对此很认真，那么可以通过以下方式实现简单的版本-

1.  **获取正面/负面情绪的语料库**。如果这是一个专业项目，您可能需要一些时间并自己手动注释语料库，但如果您赶时间或刚开始只是想尝试一下，那么我建议您查看Bo Pang 和 Lillian Lee 的[情感极性语料库](http://www.cs.cornell.edu/People/pabo/movie-review-data/)研究。使用该语料库的问题在于它不是为您的领域量身定制的（具体来说，语料库使用电影评论），但它仍然应该适用。

2.  **将您的数据集拆分为 Positive 或 Negative 句子**。对于情感极性语料库，您可以将每条评论拆分为其复合句子，然后将整体情感极性标签（正面或负面）应用于所有这些句子。将此语料库分成两部分——90% 用于训练，10% 用于测试。如果您使用的是 Weka，那么它可以为您处理语料库的拆分。

3.  **将机器学习算法**（如 SVM、朴素贝叶斯、最大熵）应用于单词级别的训练语料库。这个模型称为[词袋模型](http://en.wikipedia.org/wiki/Bag_of_words)，它只是将句子表示为它所组成的词。这与许多垃圾邮件过滤器运行的模型相同。为了很好地介绍机器学习算法，有一个名为[Weka](http://www.cs.waikato.ac.nz/ml/weka/)的应用程序，它实现了一系列这些算法，并为您提供了一个 GUI 来使用它们。然后，您可以根据尝试使用此模型对测试语料库进行分类时产生的错误来测试机器学习模型的性能。

4.  **将此机器学习算法应用于您的用户帖子**。对于每个用户帖子，将帖子分成句子，然后使用机器学习模型对它们进行分类。

所以是的，如果你认真对待这一点，那么它是可以实现的——即使没有过去在计算语言学方面的经验。这将是相当多的工作，但即使使用基于单词的模型也可以获得良好的结果。

如果您需要更多帮助，请随时与我联系 - 我总是很乐意帮助其他对 NLP 感兴趣的人 =]

* * *

*小笔记*——

1.  仅仅将一段文本分割成句子是 NLP 的一个领域——称为[句子边界检测](http://en.wikipedia.org/wiki/Sentence_boundary_disambiguation)。有许多工具（OSS 或免费）可用于执行此操作，但对于您的任务，对空格和标点符号进行简单拆分应该没问题。
2.  [SVMlight](http://svmlight.joachims.org/)也是另一个需要考虑的机器学习器，事实上，他们的归纳 SVM 执行与我们正在研究的任务类似的任务 - 尝试用 1000 个正例和 1000 个负例来分类哪些 Reuter 文章是关于“企业收购”的。
3.  将句子转换为特征进行分类可能需要一些工作。在这个模型中，每个单词都是一个特征——这需要对句子进行标记，这意味着将单词和标点符号分开。另一个技巧是将所有单独的单词标记小写，以便“我恨你”和“我恨你”最终被认为是相同的。有了更多数据，您可以尝试并包括大写是否有助于对某人是否生气进行分类，但我相信至少对于最初的努力来说，单词应该足够了。

* * *

**编辑**

我刚刚发现 LingPipe 实际上有一个使用我正在谈论的 Bo Pang 和 Lillian Lee 情感极性语料库[进行情感分析的教程。](http://alias-i.com/lingpipe/demos/tutorial/sentiment/read-me.html)如果您使用 Java，这可能是一个很好的工具，即使不是，它也会经历我上面讨论的所有步骤。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-06-01T00:56:02.143

毫无疑问，可以根据用户输入的文字来判断用户的情绪，但这绝非易事。我能想到的事情：

*   大写字母往往表示激动、烦恼或沮丧，当然是一种情绪反应，但有些新手会这样做，因为他们没有意识到重要性，所以你不能在不看他们写的其他内容的情况下假设这一点（确保它并非全部大写）；
*   大写字母实际上只是强调的一种形式。其他是使用某些激进的颜色（例如红色）或使用粗体或更大的字体；
*   有些人在情绪高涨时会犯更多的拼写和语法错误和拼写错误；
*   扫描表情符号可以让您非常清楚地了解用户的感受，但类似 ​​:) 可能会被解释为高兴、“我告诉过你”甚至具有讽刺意味；
*   脏话的使用往往具有明确的含义，但又不是明确的。许多人的口语通常会包含某些四个字母的单词。对于其他一些人，他们甚至可能不会说“地狱”，而是说“哎呀”，因此任何咒骂（甚至“糟透了”）都很重要；
*   在脏话不一定合适的情况下，标点符号组（如@#$@$@）往往会被替换为脏话，因此不太可能是口语化的；
*   感叹号可以表示惊讶、震惊或愤怒。

您可能想查看[书面文本分析的进展，](http://books.google.com.au/books?id=Vlb3BUpkF9kC&pg=PA138&lpg=PA138&dq=written+text+determining+mood&source=bl&ots=n1UXjWfoD9&sig=kAKi_vcGGxHygCrYRcJR27287as&hl=en&ei=TiYjSpe9A4KG6APJg4XHAw&sa=X&oi=book_result&ct=result&resnum=7)甚至[通过结合多种证据来源来确定博客的情绪](http://ieeexplore.ieee.org/iel5/4427043/4427044/04427099.pdf?arnumber=4427099)。

最后值得注意的是，书面文本通常被认为比实际情况更消极。这是公司中电子邮件通信的常见问题，仅作为一个例子。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-01T00:51:18.597

我不敢相信我会认真对待这件事……假设一个一维的情绪空间：

*   如果文本包含诅咒词，-10 情绪。
*   我认为感叹词*往往*是负面的，所以-2情绪。
*   当我感到沮丧时，我输入非常。短的。句子。-5 心情。

我越想越清楚，这些能指中的很多都表示一般的极端情绪，但并不总是很清楚是什么*样*的情绪。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-08-24T05:46:10.990

如果您支持字体，粗体红色文本可能是一个愤怒的用户。带有蝴蝶剪贴画的绿色常规大小的文本是一个快乐的文本。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-01T01:01:13.600

我对这门课记性不好，但我相信我看到了一些关于课文语法结构和整体语气的研究。这也可以像更短的词和表达情感的词一样简单（嗯，脏话很明显）。

**编辑**：我注意到第一个回答的人的帖子基本相似。对于较短的句子，确实可能有一些严肃的想法。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-01T01:04:39.770

情绪和行为的分析是非常严肃的科学。尽管其他答案嘲笑这个问题，执法机构多年来一直在调查情绪的分类。我听说的计算机中的使用通常有更多的上下文（时间信息、语音模式、改变频道的速度）。我认为你可以——取得一些成功——通过使用来自两个已知组的样本训练神经网络来确定用户是否处于特定情绪：愤怒和不愤怒。祝你的努力好运。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-01T02:36:58.057

我同意 ojblas 的观点，这是一个严肃的问题。

情绪分类是目前*语音*识别领域的热门话题。如果您考虑一下，交互式语音响应 (IVR) 应用程序需要处理愤怒的客户与处理冷静的客户大不相同：应该将愤怒的人快速路由到具有正确经验和培训的人工操作员。声调是一个非常可靠的情绪指标，足够实用，以至于公司都渴望让它发挥作用。谷歌“语音情感识别”，或阅读[本文](http://www.speechtechmag.com/Articles/Editorial/Feature/Show-Some-Emotion-29458.aspx)了解更多。

这种情况在基于 Web 的 GUI 中应该没有什么不同。回顾 cletus 的评论，文本和语音情感检测之间的类比很有趣。如果一个人输入大写字母，他们被称为“喊”，就好像他的声音在使用语音界面时音量和音高一样。检测键入的脏话类似于语音系统中脏话的“关键字发现”。如果一个人不高兴，他们将使用 GUI 或语音用户界面 (VUI) 犯更多错误，并且可以将其传递给人类。

这里有一个“多模式”情绪检测研究领域。想象一个您也可以与之交谈的 Web 界面（按照 IBM/Motorola/Opera [XHTML + Voice Profile](http://xml.coverpages.org/ni2004-03-23-b.html)原型实现的思路）。情绪检测可以基于来自语音和视觉输入模式的提示的组合。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-03T14:24:41.850

我认为，我的算法相当简单，但是，为什么不通过文本计算 smilics :) vs :(

显然，文本 ":) :) :) :)" 解析为快乐的用户，而 ":( :( :(" 肯定会解析为悲伤的用户。享受吧！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-01T00:54:40.413

是的。

你能不能做到是另一回事。这个问题起初似乎是人工智能完成的。

现在，如果您有击键时间，您应该能够弄清楚。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-11-20T22:15:15.100

我猜模糊逻辑会做。无论如何，从确定用户情绪的几个规则开始，然后将“引擎”扩展并与更准确和更复杂的规则结合起来，这将是相当容易的。

# python-3.x - Python 3 有哪些使用/未使用的特性？

> ID：933214
> 
> 赞同：3
> 
> 时间：2009-06-01T00:43:40.577
> 
> 标签：python-3.x, frontend

我最近做了一些网页设计作为一种爱好，主要动机是学习有趣的东西。学习 Python 固然很好，但我发现 Python 重写为时已晚，所以我必须同时学习 Python 3 和 2.6。

我是一个新手，所以我希望人们从从事最终用户编程而不是语言设计者的角度来分享他们认为 Python 3 的优势/劣势。我的问题将更多的是人们实际上喜欢使用什么，或者回避为非生产性或非pythonic。

对我来说，`with`语句肯定是加号，而中断`print`运算符肯定是减号。

**澄清编辑**：有很多帖子询问是否应该学习 Python 2 或 3，或者是否有任何区别。我发现我的问题有所不同：人们出于某种原因选择使用 Python 3 但可能对哪些更好，哪些不更好有意见。

**另一个澄清**：已在`with`向后移植到 2.* 的答案中指出。道歉。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-01T00:51:24.757

我还没有在“生产环境”中使用 Python 3，但是在使用它时，我发现`print`作为一个函数是一个绝妙的主意——例如，我可以很容易地将它放在一个`lambda`now 中，在 2 中。 *我必须使用`sys.stdout.write("%s\n" % foo)`，有点笨拙。**此外，**诸如使用不同于`sys.stdout`或删除 final`\n`的输出文件等调整的语法比 Python 2.* 的可读性强得多！

 **顺便说一句，`with`最近的 Python 2.* 版本也是如此，它不是 Python 3 - 独有的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T00:48:31.487

从长远来看，我认为他们所做的一切都是为了最好的。他们删除了许多过时的做事方式，从而强制执行“只有一种方法可以做到”并提高一致性。此外，`with`声明很棒。

使用 Python 3 的一个明显问题是它缺乏对很多 [big] 库（例如 Django）的支持。如果您的库都没有与 Python 3 冲突，那么没有理由不使用它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-01T01:20:20.800

一个优点是字节和字符串之间的澄清。在您短暂的 Python 体验中，您有多少次与不清楚的`UnicodeDecodeError`and混淆`UnicodeEncodeError`？如果您从未遇到过 unicode 与 bytestrings 的问题，那么您很可能使用的是纯 ascii 语言，（英语？;)）但这通常是初学者最难掌握的概念。（顺便说一句，如果您仍然感到困惑，[这个链接应该](http://farmdev.com/talks/unicode/)对 Python 2.x 有所帮助）

我真的认为 str 和 bytes 之间的这种区别是 Python3.0 的强项之一。阅读[PEP358](http://www.python.org/dev/peps/pep-0358/)以获取正式描述，并阅读[diveintopython 类](http://diveintopython3.org/strings.html)以获取更多面向最终用户的内容。这一新功能迫使开发人员在 unicode 对象和以特定编码编码的字节对象之间保持*清晰*的区别。我相信这种变化将帮助新手更容易理解这两种结构之间的区别，并将帮助有经验的开发人员使用理智的编程方法。

但是当然这种改变有它自己的不方便：移植 2.x 应用程序是相当困难的，如果你还没有在你的 2 .x 代码。烦人，但长期需要。

对于很多用户来说，这些重大变化看起来很烦人，而且......对于重要的库/解决方案来说实施起来很烦人。Python2.x 的当前力量是众多的第三方应用程序/模块：但由于移植到 Python3 有时并非易事，那些第三方应用程序将需要一些时间来移植（而且因为 2.x 仍然活着，这些应用程序需要维护两个版本：一个针对 2.x 客户端，一个针对 3.x……维护成本很高！）明年，运行 Python3 的成熟应用程序的数量可能会相当多低，因为与 Python3 兼容的第三方数量很少。但是，我再次强烈支持这些重大变化：你读过这个[猴子、香蕉、Python(3) 和消防水带的故事](http://www.b-list.org/weblog/2008/dec/05/python-3000/)吗？;)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-01T00:51:47.033

我真的很喜欢字典理解：

```
{k: v for k, v in stuff} 
```

并[扩展可迭代解包](http://www.python.org/dev/peps/pep-3132/)：

```
(head, *rest) = range(5) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-01T00:53:37.297

这真的很主观。Python3.x 肯定是对 2.x 的改进。它包含期待已久的变化，如：字典推导、有序字典、更强大的字符串格式化......等等更不用说更干净的库了。

# python - 用于非 Django 项目的类 Django 抽象数据库 API

> ID：933232
> 
> 赞同：6
> 
> 时间：2009-06-01T00:58:06.210
> 
> 标签：python, database, django, orm, django-models

我喜欢 Django 附带的抽象数据库 API，我想知道是否可以使用它（或类似的东西）为我的非 Django Python 项目建模、访问和管理我的（postgres）数据库。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-06-01T01:00:11.963

您正在寻找的是[对象关系映射器](http://en.wikipedia.org/wiki/Object-relational_mapping)(ORM)。Django 有自己的内置的。

要单独使用 Django 的 ORM：

*   [使用 Django ORM 作为独立组件](http://jystewart.net/process/2008/02/using-the-django-orm-as-a-standalone-component/)
*   [独立使用 Django ORM](http://pascal.nextrem.ch/2008/08/17/use-django-orm-as-standalone/)
*   [使用设置而不设置 DJANGO_SETTINGS_MODULE](http://docs.djangoproject.com/en/dev/topics/settings/#using-settings-without-setting-django-settings-module)

如果你想使用别的东西：

*   [有哪些好的 Python ORM 解决方案？](https://stackoverflow.com/questions/53428/what-are-some-good-python-orm-solutions)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-01T01:01:55.097

流行的 Python 独立 ORM：

*   [SQL炼金术](http://www.sqlalchemy.org/)
*   [SQL 对象](http://www.sqlobject.org/)
*   [风暴](https://storm.canonical.com/)

它们都支持 MySQL 和 PostgreSQL（以及其他）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-01T07:20:15.517

我特别喜欢使用以下工具的[SQLAlchemy ：](http://www.sqlalchemy.org/)

*   [Elixir](http://elixir.ematia.de/)（声明式语法）
*   [迁移](http://code.google.com/p/sqlalchemy-migrate/)（架构迁移）

他们真的让我想起了[ActiveRecord](http://ar.rubyonrails.org/)。

# algorithm - 智能进度条 ETA 计算

> ID：933242
> 
> 赞同：77
> 
> 时间：2009-06-01T01:06:22.700
> 
> 标签：algorithm, user-interface, language-agnostic

在许多应用程序中，我们有一些用于文件下载、压缩任务、搜索等的进度条。我们都经常使用进度条来让用户知道正在发生的事情。如果我们知道一些细节，比如已经完成了多少工作，还有多少工作要做，我们甚至可以给出时间估计，通常是通过推断达到当前进度水平所花费的时间。

[![压缩 ETA 截图](https://i.stack.imgur.com/QOIIx.png)](https://i.stack.imgur.com/QOIIx.png)
[（来源：[jameslao.com](http://jameslao.com/wp-content/uploads/2008/01/winrar-progress-bar.png)）]

但我们也看到这个 Time Left “ETA” 显示的节目非常糟糕。它声称文件复制将在 20 秒内完成，然后一秒钟后它说需要 4 天，然后又闪烁到 20 分钟。不仅没用，还很麻烦！ETA 变化如此之大的原因是进度本身可能会发生变化，并且程序员的数学可能过于敏感。

苹果通过避免任何准确的预测而只是给出模糊的估计来回避这一点！ [（来源：][[autodesk.com](https://download.autodesk.com/esd/mudbox/help2009/images/MED/DaliSP1/English/Install_licensing/install_progress_MAC.png)][）][![苹果含糊的回避](https://i.stack.imgur.com/Tu5Wf.png)](https://i.stack.imgur.com/Tu5Wf.png)

这也很烦人，我有时间休息一下，还是我的任务会在 2 秒内完成？如果预测太模糊，那么做任何预测都是没有意义的。

**简单但错误的方法**

作为第一次通过 ETA 计算，可能我们都只是创建一个函数，例如如果 p 是已经完成的小数百分比，并且 t 是到目前为止所花费的时间，我们输出 t*(1-p)/p 作为估计需要多长时间才能完成。这个简单的比率工作“OK”，但也很糟糕，尤其是在计算结束时。如果您缓慢的下载速度使副本在一夜之间缓慢推进，最后在早上，有些事情开始了，副本开始以 100 倍的速度全速运行，您完成 90% 的 ETA 可能会说“1 小时”和 10 秒稍后您达到 95%，ETA 会说“30 分钟”，这显然是一个非常糟糕的猜测。在这种情况下，“10 秒”是一个非常、非常、更好的估计。

发生这种情况时，您可能会考虑更改计算以使用**最近的**速度，而不是平均速度来估计 ETA。您获取过去 10 秒内的平均下载率或完成率，并使用该速率来预测完成的时间。这在前面的通宵下载的例子中表现得非常好，因为它会在最后给出非常好的最终完成估计。但这仍然有很大的问题.. 当您的费率在短时间内快速变化时，它会导致您的 ETA 大幅反弹，并且您会得到“20 秒内完成，2 小时内完成，2 秒内完成，30 内完成”分钟”快速显示编程耻辱。

**实际问题：**

给定计算的时间历史，计算完成任务的估计时间的最佳方法是什么？我不是在寻找指向 GUI 工具包或 Qt 库的链接。我在询问生成最理智和准确的完成时间估计的**算法。**

你在数学公式上取得过成功吗？某种平均，也许通过使用超过 10 秒的速率和超过 1 分钟的速率和超过 1 小时的速率的平均值？某种人工过滤，例如“如果我的新估计值与之前的估计值相差太大，请将其调低，不要让它反弹太多”？某种奇特的历史分析，您可以将进度与时间进度相结合，以找到速率的标准偏差，从而在完成时给出统计错误指标？

您尝试过什么，什么效果最好？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-06-01T01:25:31.757

## 原始答案

创建这个网站的公司[显然制作](http://www.joelonsoftware.com/items/2007/10/26.html)了一个调度系统，可以在员工编写代码的情况下回答这个问题。它的工作方式是基于过去的蒙特卡罗模拟未来。

## 附录：蒙特卡洛的解释

这就是该算法在您的情况下的工作方式：

您将任务建模为一系列微任务，例如 1000 个。假设一个小时后你完成了其中的 100 个。现在，您通过随机选择 90 个已完成的微任务，将它们的时间相加并乘以 10 来运行剩余 900 个步骤的模拟。重复 N 次，您对剩余时间有 N 个估计。请注意，这些估计之间的平均值约为 9 小时——这并不奇怪。但是通过将结果分布呈现给用户，您将诚实地向他传达赔率，例如“有 90% 的可能性，这将需要另外 3-15 小时”

根据定义，如果所讨论的任务可以建模为一堆*独立的随机*微任务，则该算法会产生完整的结果。只有知道任务与此模型有何不同，才能获得更好的答案：例如，安装程序通常有一个下载/解包/安装任务列表，而其中一个的速度无法预测另一个。

## 附录：简化蒙特卡洛

我不是统计专家，但我认为如果你仔细研究这种方法的模拟，它总是会返回一个正态分布作为大量独立随机变量的总和。因此，您根本不需要执行它。事实上，您甚至不需要存储所有已完成的时间，因为您只需要它们的总和和它们的平方和。

在可能不是很标准的符号中，

```
sigma = sqrt ( sum_of_times_squared-sum_of_times^2 )
scaling = 900/100          // that is (totalSteps - elapsedSteps) / elapsedSteps
lowerBound = sum_of_times*scaling - 3*sigma*sqrt(scaling)
upperBound = sum_of_times*scaling + 3*sigma*sqrt(scaling) 
```

有了这个，你可以输出消息说事情将从现在开始以某个固定的概率在 [lowerBound, upperBound] 之间结束（应该是大约 95%，但我可能错过了一些恒定的因素）。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-06-07T20:43:56.830

这是我发现效果很好的方法！对于前 50% 的任务，您假设速率是恒定的并进行推断。时间预测非常稳定，不会反弹太多。

一旦超过 50%，就**切换**计算策略。你把剩下的部分工作（1-p），然后回顾你自己的进步历史，并找到（通过二分搜索和线性插值）你花了多长时间完成最后一项（1 -p）百分比并将**其**用作您的时间估计完成。

因此，如果您现在完成了 71%，那么您还剩下 29%。你回顾你的历史，发现你多久前完成了（71-29=42%）。将该时间报告为您的预计到达时间。

这自然是自适应的。如果您有 X 量的工作要做，那么它只会查看完成 X 量工作所花费的时间。最后，当您完成 99% 时，它仅使用非常新鲜、非常近期的数据进行估算。

它当然不是完美的，但它会平滑地变化，并且在最有用的时候特别准确。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2015-01-18T00:11:28.057

虽然所有示例都是有效的，但对于“剩余时间下载”的特定情况，我认为查看现有开源项目以了解它们的作用是一个好主意。

据我所知，Mozilla Firefox 在估计剩余时间方面是最好的。

**火狐浏览器**

Firefox 会跟踪剩余时间的最后估计值，并通过使用此估计值和当前剩余时间估计值，对时间执行平滑功能。[请参阅此处](https://dxr.mozilla.org/mozilla-central/source/toolkit/mozapps/downloads/DownloadUtils.jsm#252)的 ETA 代码。这使用了之前[在此处](https://mxr.mozilla.org/mozilla/source/toolkit/components/downloads/src/nsDownloadManager.cpp#2250)计算的“速度”，它是最后 10 个读数的平滑平均值。

这有点复杂，所以解释一下：

*   根据先前速度的 90% 和新速度的 10% 对速度进行平滑平均。
*   用这个平滑的平均速度计算出估计的剩余时间。
*   使用这个估计的剩余时间，和之前估计的剩余时间来创建一个新的估计剩余时间（为了避免跳跃）

**谷歌浏览器**

Chrome 似乎到处乱跳，代码[显示了这个](https://code.google.com/p/chromium/codesearch#chromium/src/content/browser/download/download_item_impl.cc&rcl=1421356211&l=688)。

我喜欢 Chrome 的一件事是它们如何格式化剩余时间。对于 > 1 小时，它说“还剩 1 小时” 对于 < 1 小时，它说“还剩 59 分钟” 对于 < 1 分钟，它说“还剩 52 秒”

[你可以在这里](https://code.google.com/p/chromium/codesearch#chromium/src/ui/base/l10n/time_format.cc&rcl=1421356211&l=36)看到它的格式

**打倒他们！经理**

它没有使用任何聪明的东西，这意味着 ETA 到处乱跳。

请参阅[此处的代码](https://github.com/downthemall/downthemall-mirror/blob/c8fd56c464b2af6b8dc7ddee1f9bbe6e9f6e8382/chrome/content/dta/manager/manager.js#L724)

**pySmartDL（python 下载器）**

取最后 30 次 ETA 计算的平均 ETA。听起来是一种合理的方法。

[请参阅此处](https://github.com/iTaybb/pySmartDL)的代码/blob/916f2592db326241a2bf4d8f2e0719c58b71e385/pySmartDL/pySmartDL.py#L651)

**传送**

在大多数情况下给出了一个相当好的预计到达时间（除了开始时，正如预期的那样）。

在过去 5 次读数中使用平滑因子，类似于 Firefox，但没有那么复杂。与Gooli的回答基本相似。

[请参阅此处](https://trac.transmissionbt.com/browser/trunk/libtransmission/torrent.c?rev=14428#L1319)的代码

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-06-01T20:49:35.847

我通常使用[指数移动平均线](http://en.wikipedia.org/wiki/Moving_average#Exponential_moving_average)来计算平滑因子为 0.1 的操作的速度，并使用它来计算剩余时间。这样，所有测得的速度都会对当前速度产生影响，但最近的测量结果比遥远的过去的影响要大得多。

在代码中，它看起来像这样：

```
alpha = 0.1 # smoothing factor
...
speed = (speed * (1 - alpha)) + (currentSpeed * alpha) 
```

如果您的任务大小一致，则`currentSpeed`只是执行最后一个任务所花费的时间。如果任务具有不同的大小，并且您知道一个任务应该是另一个任务的两倍，您可以将执行任务所花费的时间除以其相对大小以获得当前速度。使用`speed`您可以通过将剩余时间乘以剩余任务的总大小（或者如果任务是统一的，则仅乘以它们的数量）来计算剩余时间。

希望我的解释足够清楚，今天有点晚了。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-01T01:17:38.107

在某些情况下，当您需要定期执行相同的任务时，使用过去的完成时间进行平均可能是一个好主意。

例如，我有一个应用程序通过其 COM 接口加载 iTunes 库。就项目数量而言，给定 iTunes 库的大小通常不会从启动到启动显着增加，因此在此示例中，可以跟踪最后三个加载时间和加载速率，然后对其进行平均，然后计算您当前的预计到达时间。

这将比瞬时测量准确得多，并且可能也更加一致。

但是，此方法取决于任务的大小与以前的方法相对相似，因此这不适用于解压缩方法或任何给定字节流是要处理的数据的其他方法。

只是我的 0.02 美元

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-10-12T09:17:20.197

首先，它有助于生成运行移动平均线。这对最近发生的事件赋予了更大的权重。

为此，请保留一堆样本（循环缓冲区或列表），每个样本都有一对进度和时间。保留最近的 N 秒样本。然后生成样本的加权平均值：

```
totalProgress += (curSample.progress - prevSample.progress) * scaleFactor
totalTime += (curSample.time - prevSample.time) * scaleFactor 
```

其中 scaleFactor 作为过去时间的反函数从 0...1 线性变化（因此对最近的样本进行更重的加权）。当然，你可以玩弄这个权重。

最后，您可以获得平均变化率：

```
 averageProgressRate = (totalProgress / totalTime); 
```

您可以通过将剩余进度除以该数字来使用它来计算 ETA。

然而，虽然这为您提供了一个很好的趋势数字，但您还有另一个问题 - 抖动。如果由于自然变化，您的进度会稍微移动（噪音很大）-例如，也许您正在使用它来估计文件下载量-您会注意到噪音很容易导致您的 ETA 跳跃，尤其是如果未来还很遥远（几分钟或更长时间）。

为了避免抖动过多地影响您的 ETA，您希望这个平均变化率数字对更新的响应缓慢。解决此问题的一种方法是保持平均ProgressRate的缓存值，而不是立即将其更新为您刚刚计算的趋势数字，而是将其模拟为具有质量的重物理对象，缓慢地应用模拟的“力”将其移向趋势数字。有了质量，它有一点惯性，不太可能受到抖动的影响。

这是一个粗略的示例：

```
// desiredAverageProgressRate is computed from the weighted average above
// m_averageProgressRate is a member variable also in progress units/sec
// lastTimeElapsed = the time delta in seconds (since last simulation) 
// m_averageSpeed is a member variable in units/sec, used to hold the 
// the velocity of m_averageProgressRate

const float frictionCoeff = 0.75f;
const float mass = 4.0f;
const float maxSpeedCoeff = 0.25f;

// lose 25% of our speed per sec, simulating friction
m_averageSeekSpeed *= pow(frictionCoeff, lastTimeElapsed); 

float delta = desiredAvgProgressRate - m_averageProgressRate;

// update the velocity
float oldSpeed = m_averageSeekSpeed;
float accel = delta / mass;    
m_averageSeekSpeed += accel * lastTimeElapsed;  // v += at

// clamp the top speed to 25% of our current value
float sign = (m_averageSeekSpeed > 0.0f ? 1.0f : -1.0f);
float maxVal = m_averageProgressRate * maxSpeedCoeff;
if (fabs(m_averageSeekSpeed) > maxVal)
{
 m_averageSeekSpeed = sign * maxVal;
}

// make sure they have the same sign
if ((m_averageSeekSpeed > 0.0f) == (delta > 0.0f))
{
 float adjust = (oldSpeed + m_averageSeekSpeed) * 0.5f * lastTimeElapsed;

 // don't overshoot.
 if (fabs(adjust) > fabs(delta))
 {
    adjust = delta;
            // apply damping
    m_averageSeekSpeed *= 0.25f;
 }

 m_averageProgressRate += adjust;
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-01T01:14:13.933

你的问题很好。如果可以将问题分解为具有精确计算的离散单元，通常效果最好。不幸的是，即使您要安装 50 个组件，每个组件可能占 2%，但其中一个组件可能很大，但情况可能并非如此。我取得了一定成功的一件事是为 CPU 和磁盘计时，并根据观察数据给出一个不错的估计。知道某些检查点确实是点 x 可以让您有机会纠正环境因素（网络、磁盘活动、CPU 负载）。然而，由于它依赖于观测数据，这种解决方案本质上并不通用。使用诸如 rpm 文件大小之类的辅助数据帮助我使我的进度条更准确，但它们绝不是防弹的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-02-02T17:53:18.947

## 均匀平均

最简单的方法是线性预测剩余时间：

```
t_rem := t_spent ( n - prog ) / prog 
```

其中`t_rem`是预测的 ETA，`t_spent`是自操作开始以来经过的时间，`prog`完成的微任务数量超出了它们的全部数量`n`。解释一下——<code>n 可能是表中要处理的行数或要复制的文件数。

该方法无参数，无需担心衰减指数的微调。权衡是对不断变化的进度速率的适应不佳，因为所有样本对估计的贡献都是相同的，而最近的样本应该比旧的样本具有更大的权重，这导致我们

## 指数平滑率

其中标准技术是通过平均以前的点测量来估计进展率：

```
rate := 1 / (n * dt); { rate equals normalized progress per unit time }
if prog = 1 then      { if first microtask just completed }
    rate_est := rate; { initialize the estimate }
else
begin
    weight   := Exp( - dt / DECAY_T );
    rate_est := rate_est * weight + rate * (1.0 - weight);
    t_rem    := (1.0 - prog / n) / rate_est;
end; 
```

其中`dt`表示最后完成的微任务的持续时间，等于自上次进度更新以来经过的时间。请注意，这`weight`不是一个常数，必须根据观察到某个速度的时间长度进行调整`rate`，因为我们观察到某个速度的时间越长，先前测量的指数衰减就越高。该常数`DECAY_T`表示样本权重减少*e*倍的时间长度。*SPWorley本人建议对**gooli*的提议进行类似的修改，尽管他将其应用于错误的术语。等距测量的指数平均值为：

```
Avg_e(n) = Avg_e(n-1) * alpha + m_n * (1 - alpha) 
```

但是如果样本不等距怎么办，就像典型进度条中的时间一样？考虑到`alpha`上面只是一个经验商，其真实值为：

```
alpha = Exp( - lambda * dt ), 
```

其中`lambda`是指数窗口的参数和`dt`自上一个样本以来的变化量，不需要是时间，而是任何线性和加性参数。`alpha`对于等距测量是常数，但随 变化`dt`。

请注意，此方法依赖于预定义的时间常数，并且在时间上不可扩展。换句话说，如果完全相同的过程被一致地减慢一个常数因子，这个基于速率的滤波器将对信号变化成比例地变得更加敏感，因为在每一步`weight`都会减少。然而，如果我们想要一个独立于时间尺度的平滑，我们应该考虑

## 缓慢的指数平滑

这本质上是通过增加一个常数的简化来颠倒利率的平滑，`weight`因为`prog`它以等距增量增长：

```
slowness := n * dt;   { slowness is the amount of time per unity progress }
if prog = 1 then      { if first microtask just completed }
    slowness_est := slowness; { initialize the estimate }
else
begin
    weight       := Exp( - 1 / (n * DECAY_P ) );
    slowness_est := slowness_est * weight + slowness * (1.0 - weight);
    t_rem        := (1.0 - prog / n) * slowness_est;
end; 
```

无量纲常数`DECAY_P`表示两个样本之间的归一化进度差异，其权重为 1 与*e*的比率。换句话说，这个常数决定了平滑窗口在进程域中的宽度，而不是在时域中。因此，该技术与时间尺度无关，并且具有恒定的空间分辨率。

## 进一步研究：自适应指数平滑

您现在可以尝试各种[自适应指数平滑](https://en.wikipedia.org/wiki/Exponential_smoothing#Double_exponential_smoothing)算法。只记得把它应用到*慢*而不是*评价*。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-01T01:42:33.780

我一直希望这些东西能告诉我一个范围。如果它说“这项任务很可能会在 8 分钟到 30 分钟之间完成”，那么我就知道该采取什么样的休息时间了。如果它在整个地方弹跳，我很想看它直到它安定下来，这非常浪费时间。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2013-08-30T02:43:07.800

我已经尝试并简化了您的“简单”/“错误”/“OK”公式，它最适合我：

```
t / p - t 
```

在 Python 中：

```
>>> done=0.3; duration=10; "time left: %i" % (duration / done - duration)
'time left: 23' 
```

与 (dur*(1-done)/done) 相比，这节省了一个操作。而且，在您描述的极端情况下，可能在等待整晚之后再忽略 30 分钟的对话几乎没有关系。

将这种简单的方法与[Transmission 使用的方法进行](https://stackoverflow.com/a/28005790/819417)[比较](https://gist.github.com/CTimmerman/241a09b4f8f62624a90a592f964d5e83#file-test_eta-py)，我发现它的[准确率提高了 72%。](https://gist.github.com/CTimmerman/241a09b4f8f62624a90a592f964d5e83#file-smooth_72_percent_off-log)

* * *

## 回答 #11

> 赞同：-4
> 
> 时间：2009-06-01T01:13:15.620

我不费吹灰之力，它只是应用程序的一小部分。我告诉他们发生了什么事，然后让他们去做别的事情。

# php - 计算 PHP 字符串中特定字符的所有出现次数的最有效方法是什么？

> ID：933253
> 
> 赞同：15
> 
> 时间：2009-06-01T01:15:23.023
> 
> 标签：php, string

计算 PHP 字符串中特定字符的所有出现次数的最有效方法是什么？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-06-01T01:36:36.257

用这个：

```
echo substr_count("abca", "a"); // will echo 2 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T02:03:05.457

Not sure what kind of a response you're looking for, but here's a function that might do it:

```
function findChar($c, $str) {
    indexes = array();
    for($i=0; $i<strlen($str); $i++) {
        if ($str{$i}==$c) $indexes[] = $i;
    }
    return $indexes;
} 
```

Pass it the character you're looking for and the string you want to look:

```
$mystring = "She shells out C# code on the sea shore";
$mychar = "s";
$myindexes = $findChar($mychar, $mystring);
print_r($myindexes); 
```

It should give you something like

```
Array (
    [0] => 0
    [1] => 4
    [2] => 9
    [3] => 31
    [4] => 35
) 
```

or something...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T02:07:14.480

If you are going to be repeatedly checking the same string, it'd be smart to have some sort of trie or even assoc array for it otherwise, the straightforward way to do it is...

```
for($i = 0; $i < strlen($s); $i++)
  if($s[i] == $c)
    echo "{$s[i]} at position $i"; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T01:24:06.860

你不能把角色喂给[preg_match_all](http://us2.php.net/preg_match_all)吗？

# actionscript-3 - AS3 - 是否可以按对象属性搜索数组？

> ID：933257
> 
> 赞同：6
> 
> 时间：2009-06-01T01:17:50.850
> 
> 标签：actionscript-3

是否可以使用 Array.indexOf() 通过数组中对象的属性来搜索数组：

```
var myArray:Array = new Array();
var myMovieClip = new MovieClip();

myMovieClip.name = "foo";

myArray.push(myMovieClip);
myArray.indexOf(MovieClip.name == "foo"); //0 
```

或者

```
myArray.indexOf(myMovieClip.name == "foo"); //0 
```

上面的两个 indexOf() 都不起作用，是否可以使用正确的语法来实现这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-01T01:27:10.083

查看 Array 的过滤器方法（新可用于 AS3）。您可以编写一个过滤器方法，返回所有符合您条件的对象（在您的情况下，一个具有特定名称的影片剪辑）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-01T02:28:56.777

index of 将搜索条目 ... MovieClip.name == "foo" 应该引发编译器错误，因为 MovieClip 没有属性 "name" ... myMovieClip.name == "foo" 将为**true**，并且那么你将得到真正的索引，如果它在数组中......

如果你真的需要索引，你将需要遍历数组......按键......或在增量循环中，如果数组是数字和密集......如果数组是关联的（使用字符串键）你迫切需要使用 for-in 循环，因为过滤器和相关函数将仅涵盖数字索引...

在数值数组中，我建议采用以下两种方法之一：

```
//this will return an array of all indices
myArray.map(function (val:*,index:int,...rest):int { return (val.name == "foo") ? index : -1 }).filter(function (val:int,...rest):Boolean { return val != -1 });

//here a more reusable utility function ... you may want to put it to some better place ... just as an example ...
package {
     public class ArrayUtils {
          public static function indexOf(source:Array, filter:Function, startPos:int = 0):int {
               var len:int = source.length;
               for (var i:int = startPos; i < len; i++) 
                    if (filter(source[i],i,source)) return i;
               return -1;
          }
     }
}
//and now in your code:
var i:int = ArrayUtils.indexOf(myArray, function (val:*,...rest):Boolean { return val.name == "foo" }); 
```

希望对您有所帮助... ;)

问候

back2dos

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-08-22T17:38:44.897

虽然 back2dos 的方法很酷，但我认为初学者可能会觉得它过于复杂，所以为了他们这里提供一个更简单的方法，可能更容易使用，但在任何情况下都不会像 back2dos 的方法那样通用.

```
var myArray:Array = new Array();
var myMovieClip1 = new MovieClip();
var myMovieClip2 = new MovieClip();

myMovieClip1.name = "foo";
myMovieClip2.name = "bar";

myArray.push(myMovieClip1);
myArray.push(myMovieClip2);

function getIndexByName(array:Array, search:String):int {
    // returns the index of an array where it finds an object with the given search value for it's name property (movieclips, sprites, or custom objects)
    for (var i:int = 0; i < array.length; i++) {
        if (array[i].name == search) {
            return i;
        }
    }
    return -1;
}

trace("bar index = "+getIndexByName(myArray, "bar"));
trace("foo index = "+getIndexByName(myArray, "foo")); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T01:42:06.387

```
myMovieClip.name == "foo"; 
```

^== 如果要分配变量，请使用

```
myMovieClip.name = "foo"; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-12-11T16:25:45.697

这就是我所做的。如果您愿意，可以更改函数名称......这只是为了解释。

```
getObjectFromArrayByProperty(arrayToSearch, 'oBjectProperty', 'value');

function getObjectFromArrayByPoperty(array:Array, _property, search:String):Object{
    for (var i:int = 0; i < array.length; i++) {
        if (array[i][_property] == search) {
                return array[i];
        }
    }
    return null;
} 
```

这将返回对象而不仅仅是索引。如果未找到匹配项，则该函数返回 null。

# drupal - Drupal 5：标志模块 - 在块中显示用户标记的项目

> ID：933259
> 
> 赞同：1
> 
> 时间：2009-06-01T01:19:17.697
> 
> 标签：drupal, user-interface, e-commerce

我的目标是**在一个块中获取当前用户标记项目**的列表，我可以在我的 node.tpl.php 中使用它所需的功能是产品的“比较列表”。

**任何有D5**中[标志模块](http://drupal.org/handbook/modules/flag "标志模块")经验的人都可以为我指明正确的方向吗？我基本上希望能够说：

 **```
<?php print $all_current_user_flags ?> 
```

是否有为此预定义的功能，还是我必须手动将其从数据库中取出？我没有设法[在文档中找到很多](http://drupal.org/node/296955)关于此的内容，而且我对什么是最佳行动方案感到有些困惑。

提前致谢。

*编辑：*对于仍在阅读本文的任何人，我已经移至[会话收藏夹](http://drupal.org/project/session_favorites)模块，因为它允许匿名用户构建收藏夹列表。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-01T11:33:52.760

[这](http://mrphp.com.au/code/project/drupal/drupal-5/how-display-view-block)有效：

```
<h3>Comparison List</h3>
<?php print views_build_view('page',views_get_view('flag_bookmarks'),$args,true,10,$page); ?> 
```

# iphone - iPhone 已暂停

> ID：933277
> 
> 赞同：0
> 
> 时间：2009-06-01T01:29:22.857
> 
> 标签：iphone

当我调用`stringByEvaluatingJavaScriptFromString`调用 javascript 方法时，iPhone 被“暂停”（不能在 iphone 上做任何事情）：

```
NSString *_script = [[NSString alloc] initWithString: @"onTest()"];
[[NSString alloc] initWithString: [webView stringByEvaluatingJavaScriptFromString: _script]]; 
```

onTest() 方法在本地资源 index.html 中定义。

请告诉我是什么原因？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-01T01:55:50.633

stringByEvaluatingJavaScriptFromString has a in-built "kill timer" (which is my way of calling it) of 5 sec. If your javascript is complex, and runs for more than 5 sec, the iPhone OS kills the thread making your iPhone look suspended.

May be you can wait for iPhone OS 3.0 which promises faster Javascript processing (and may be who knows they could increase the kill timer seconds)

# architecture - Scale Out Application (Split User Data) - 如何建立单点登录？

> ID：933283
> 
> 赞同：0
> 
> 时间：2009-06-01T01:33:54.343
> 
> 标签：architecture, scalability

我必须为应用程序做出架构决策，并且想知道实现以下目标的最佳方式，希望不必在多个地方重复信息。

*设想：*

1.  整个用户数据的独立、自治部分的应用程序实例被分割到多个地理上分散的服务器（例如，檀香山的服务器 1 上的用户 1 - 1,000，东京的另一个服务器上的用户 1,001 - 2,000 等）。
2.  **单用户数据在整个系统的一台**服务器上只能使用**一次**，其他服务器不可用。
***   用户不关心其他用户的数据，因此服务器之间没有内在的通信需求。*   但是，该应用程序需要一个中心登录点，我们称之为*www.mysite.com/login***

 **我最初的想法是建立一个“主”数据库来保存所有用户及其服务器位置，然后在登录时重定向到适当的数据库。

有没有更简单/更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T01:38:56.130

根据您拥有的服务器数量，另一种方法是让“登录中心点”向所有服务器发送（“广播”）每个登录请求；大多数服务器会迅速回答“用户未知”，其中一个会将自己标识为用户所在的服务器等等。这是否比管理信息“复制”到“主数据库”更好，确保一致性等等，由于信息稀少，很难说，但至少它可能是一个值得考虑的替代架构。

# c# - Assert.AreEqual 如何确定两个通用 IEnumerable 之间的相等性？

> ID：933285
> 
> 赞同：35
> 
> 时间：2009-06-01T01:36:36.710
> 
> 标签：c#, unit-testing, ienumerable, mstest, assert

我有一个单元测试来检查方法是否返回正确的`IEnumerable`. 该方法使用`yield return`. 它是可枚举的类如下：

```
enum TokenType
{
    NUMBER,
    COMMAND,
    ARITHMETIC,
}

internal class Token
{
    public TokenType type { get; set; }
    public string text { get; set; }
    public static bool operator == (Token lh, Token rh) { return (lh.type == rh.type) && (lh.text == rh.text); }
    public static bool operator != (Token lh, Token rh) { return !(lh == rh); }
    public override int GetHashCode()
    {
        return text.GetHashCode() % type.GetHashCode();
    }
    public override bool Equals(object obj)
    {
        return this == (Token)obj;
    }
} 
```

这是该方法的相关部分：

```
 foreach (var lookup in REGEX_MAPPING)
 {
     if (lookup.re.IsMatch(s))
     {
         yield return new Token { type = lookup.type, text = s };
         break;
     }
 } 
```

如果我将此方法的结果存储在 中`actual`，请创建另一个 enumerable `expected`，然后像这样比较它们......

```
 Assert.AreEqual(expected, actual); 
```

...，断言失败。

`IEnumerable`我为此编写了一个类似于[Python`zip`函数](https://docs.python.org/2/library/functions.html?highlight=zip#zip)的扩展方法（它将两个 IEnumerables 组合成一组对）并尝试了这个：

```
foreach(Token[] t in expected.zip(actual))
{
    Assert.AreEqual(t[0], t[1]);
} 
```

有效！`Assert.AreEqual`那么这两个s有什么区别呢？

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2009-06-01T01:54:13.180

找到了：

```
Assert.IsTrue(expected.SequenceEqual(actual)); 
```

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2009-06-01T02:01:47.597

您是否考虑过使用`CollectionAssert`该类...考虑到它旨在对集合执行相等性检查？

**附录：**
如果被比较的“集合”是枚举，那么简单地用“ `new List<T>(enumeration)`”包装它们是执行比较的最简单方法。构建一个新列表当然会导致一些开销，但是在单元测试的上下文中，我希望这不应该太重要吗？

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2009-06-01T01:41:11.897

`Assert.AreEqual`将比较手头的两个对象。`IEnumerable`s 本身就是类型，并提供了一种机制来迭代某些集合......但它们实际上不是那个集合。您最初的比较比较了两个`IEnumerable`s，这是一个有效的比较......但不是您需要的。您需要比较*这两个`IEnumerable`s 打算枚举的*内容。

这是我比较两个可枚举的方法：

```
Assert.AreEqual(t1.Count(), t2.Count());

IEnumerator<Token> e1 = t1.GetEnumerator();
IEnumerator<Token> e2 = t2.GetEnumerator();

while (e1.MoveNext() && e2.MoveNext())
{
    Assert.AreEqual(e1.Current, e2.Current);
} 
```

我不确定上面的代码是否比你的`.Zip`方法少，但它很简单。

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2012-06-18T19:11:52.670

我认为断言你想要的平等的最简单和最清晰的方法是结合 jerryjvl 的答案和 MEMark 对他的帖子的评论 - 结合`CollectionAssert.AreEqual`扩展方法：

```
CollectionAssert.AreEqual(expected.ToArray(), actual.ToArray()); 
```

这提供了比 OP 建议的 SequenceEqual 答案更丰富的错误信息（它会告诉您发现哪个元素是意外的）。例如：

```
IEnumerable<string> expected = new List<string> { "a", "b" };
IEnumerable<string> actual   = new List<string> { "a", "c" }; // mismatching second element

CollectionAssert.AreEqual(expected.ToArray(), actual.ToArray());
// Helpful failure message!
//  CollectionAssert.AreEqual failed. (Element at index 1 do not match.)    

Assert.IsTrue(expected.SequenceEqual(actual));
// Mediocre failure message:
//  Assert.IsTrue failed. 
```

如果/当你的测试失败时，你会*很*高兴你这样做了——有时你甚至可以知道什么是错的，而不必打破调试器——嘿，你做的 TDD 是对的，所以你先写一个失败的测试，对？;-)

`AreEquivalent`如果您用于测试等效性（顺序无关紧要），错误消息会更有帮助：

```
CollectionAssert.AreEquivalent(expected.ToList(), actual.ToList());
// really helpful error message!
//  CollectionAssert.AreEquivalent failed. The expected collection contains 1
//  occurrence(s) of <b>. The actual collection contains 0 occurrence(s). 
```

# c# - XmlSerializer 和 XmlAnyElement 中的控制命名空间

> ID：933290
> 
> 赞同：1
> 
> 时间：2009-06-01T01:39:20.823
> 
> 标签：c#, .net, serialization, xml-serialization

使用 dotnet 2.0。代码说明：

```
 Class1 c1 = new Class1(); 
        c1.SomeInt = 5;

        XmlDocument doc = new XmlDocument();
        doc.LoadXml("<anode xmlns=\"xyz\" ><id>123</id></anode>");  

        c1.Any = new XmlElement[1];
        c1.Any[0] = (XmlElement)doc.DocumentElement;

        XmlSerializer ser = new XmlSerializer(typeof(Class1));
        XmlSerializerNamespaces ns = new XmlSerializerNamespaces();
        ns.Add("", "xyz");

        StringBuilder sb = new StringBuilder();
        XmlWriterSettings settings = new XmlWriterSettings();
        settings.OmitXmlDeclaration = true;

        XmlWriter writer = XmlWriter.Create(sb, settings);
        writer.WriteStartElement("root");
        ser.Serialize(writer, c1, ns);
        writer.WriteEndElement();

        writer.Close();

        string str = sb.ToString();
        MessageBox.Show(str); 
```

其中 Class1 定义如下：

```
[System.Serializable()]
[System.Xml.Serialization.XmlRoot(Namespace="xyz")]
public class Class1
{
    private int someInt;

    public int SomeInt
    {
        get { return someInt; }
        set { someInt = value; }
    }

    private System.Xml.XmlElement[] anyField;

    /// <remarks/>
    [System.Xml.Serialization.XmlAnyElementAttribute()]
    public System.Xml.XmlElement[] Any
    {
        get
        {
            return this.anyField;
        }
        set
        {
            this.anyField = value;
        }
    }
} 
```

此代码显示字符串：

```
<root><Class1 xmlns="xyz"><SomeInt>5</SomeInt><anode xmlns="xyz"><id>123</id></anode></Class1></root> 
```

这是正确的 xml，但我想知道这是否可以简化。

我想要的是在“阳极”元素中没有多余的 xmlns="xyz" 部分。即我想：

```
<root><Class1 xmlns="xyz"><SomeInt>5</SomeInt><anode><id>123</id></anode></Class1></root> 
```

这可能吗 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T02:07:35.120

不，我不相信你可以。您可以使用本文所述的别名命名空间：[Prettification of XML Serialization within Web Services](http://www.topxml.com/rbnews/XmlSerializer/re-21763_Prettification-of-XML-Serialization-within-Web-Services.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-10-18T14:00:28.700

```
settings.NamespaceHandling = NamespaceHandling.OmitDuplicates 
```

# php - Drupal node_save 不再返回 $nid，那么我该如何获取呢？

> ID：933292
> 
> 赞同：8
> 
> 时间：2009-06-01T01:40:25.860
> 
> 标签：php, drupal, drupal-6

我有这样的代码：

```
... setup $issue object ...
$node = node_save($issue);

print_r($node); 
```

节点创建成功，一切正常……但从 save_node() 没有返回任何内容。较早的文档表明它返回 $nid。一些讨论和票证表明，在最近的 Drupal 版本中，节点对象被返回，但我什么也没得到（并且 $node->nid 是空的）。

那么，如何找出新创建节点的nid呢？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-06-01T03:41:20.653

好吧，终于想通了（男孩我觉得很傻）。

node_save 现在对现有节点对象（在我的例子中已经在 $issue 中定义）进行操作，并且只需将 nid 字段（以及其他字段）添加到现有对象。没有返回任何内容，但我可以在 node_save 运行后使用 $issue->nid 访问 nid。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-12-23T20:04:19.533

谢谢你！很高兴知道。感谢您回答自己的问题并分享，以便其他人（如我自己）可以学习！很好的解决方案！感谢您的贡献

2个提示：
//使用drupal_set_message()通知用户节点已成功保存
//尝试在保存之前使用node_submit()来捕获可能存在的错误

```
if ($_newnode = node_submit($_newnode)) {
    node_save($_newnode);
    drupal_set_message(t("Node ".$_newnode->title." added correctly"));
    $return = $_newnode->uid;
} else {
    $return = 0;
    drupal_set_message(t("Node ".$_newnode->title." added incorrectly"), "error");
}

return $return; 
```

# java - Java 泛型到底有什么问题？

> ID：933293
> 
> 赞同：2
> 
> 时间：2009-06-01T01:40:54.643
> 
> 标签：java, generics, programming-languages

> **可能重复：**
> [为什么有人声称 Java 的泛型实现不好？](https://stackoverflow.com/questions/520527/why-do-some-claim-that-javas-implementation-of-generics-is-bad)

Java 的泛型到底有什么问题？或者换一种方式，其他语言对类似概念的实现有什么更好的？

我并不是要引发任何战争，但自 1.4 以来（即在泛型之前）我就没有用 Java 编程过。在其他问题（例如问题 282329，[链接文本](https://stackoverflow.com/questions/282329 "你讨厌你最喜欢的语言的五件事是什么")）中，人们谈论“奇怪”而没有详细说明。

有人愿意详细说明吗？

# java - JavaBean 'useBean 类属性 classes.UserData 的值无效'

> ID：933320
> 
> 赞同：2
> 
> 时间：2009-06-01T02:05:49.723
> 
> 标签：java, attributes, javabeans

我有两个不工作的 JSP 和一个 JavaBean。我正在使用Tomcat 6.0。第一个 JSP 是 GetName.jsp，位于 C:\Tomcat\webapps\app1\GetName.jsp：

```
<HTML>
<BODY>
<FORM METHOD=POST ACTION="NextPage.jsp">
What's your name? <INPUT TYPE=TEXT NAME=username SIZE=20><BR>
What's your e-mail address? <INPUT TYPE=TEXT NAME=email SIZE=20><BR>
What's your age? <INPUT TYPE=TEXT NAME=age SIZE=4>
<P><INPUT TYPE=SUBMIT>
</FORM>
</BODY>
</HTML> 
```

第二个 JSP 是 NextPage.jsp，位于 C:\Tomcat\webapps\app1\NextPage.jsp：

```
<jsp:useBean id="user" class="classes.UserData" scope="session"/> 
<HTML>
<BODY>
You entered<BR>
Name: <jsp:getProperty name="user" property="username" /><BR>
Email: <jsp:getProperty name="user" property="email" /><BR>
Age: <jsp:getProperty name="user" property="age" /><BR>
</BODY>
</HTML> 
```

我的 JavaBean UserData 编译正确，类文件位于 C:\Tomcat\webapps\app1\WEB-INF\classes：

```
package classes;

import java.io.Serializable;

public class UserData implements Serializable {
    String username;
    String email;
    int age;

    public UserData() {
    }

    public void setUsername( String value )
    {
        username = value;
    }

    public void setEmail( String value )
    {
        email = value;
    }

    public void setAge( int value )
    {
        age = value;
    }

    public String getUsername() { return username; }

    public String getEmail() { return email; }

    public int getAge() { return age; }
} 
```

我的 web.xml 文件中也有以下内容，位于 C:\Tomcat\webapps\app1\WEB-INF：

```
<?xml version="1.0" encoding="ISO-8859-1"?>

<!DOCTYPE web-app
  PUBLIC "-//Sun Microsystems, Inc.//DTD Web Application 2.2//EN"
  "http://java.sun.com/j2ee/dtds/web-app_2_2.dtd">

<web-app>
</web-app> 
```

我的 Google 搜索建议与类路径有关。我的类路径当前是 .;C:\Tomcat\lib\servlet-api.jar。

当我在 GetName.jsp 中输入信息并单击按钮时，Tomcat 会为我提供 NextPage.jsp 的以下信息：

```
org.apache.jasper.JasperException: /NextPage.jsp(1,1) The value for the useBean class attribute classes.UserData is invalid.
    org.apache.jasper.compiler.DefaultErrorHandler.jspError(DefaultErrorHandler.java:40)
    org.apache.jasper.compiler.ErrorDispatcher.dispatch(ErrorDispatcher.java:407)
    org.apache.jasper.compiler.ErrorDispatcher.jspError(ErrorDispatcher.java:148)
    org.apache.jasper.compiler.Generator$GenerateVisitor.visit(Generator.java:1203)
    org.apache.jasper.compiler.Node$UseBean.accept(Node.java:1160)
    org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2343)
    org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2393)
    org.apache.jasper.compiler.Node$Visitor.visit(Node.java:2399)
    org.apache.jasper.compiler.Node$Root.accept(Node.java:489)
    org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2343)
    org.apache.jasper.compiler.Generator.generate(Generator.java:3365)
    org.apache.jasper.compiler.Compiler.generateJava(Compiler.java:199)
    org.apache.jasper.compiler.Compiler.compile(Compiler.java:315)
    org.apache.jasper.compiler.Compiler.compile(Compiler.java:295)
    org.apache.jasper.compiler.Compiler.compile(Compiler.java:282)
    org.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:586)
    org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:317)
    org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:342)
    org.apache.jasper.servlet.JspServlet.service(JspServlet.java:267)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:717) 
```

我可以发誓我做的一切都是正确的，但显然我不是。在我把头发都扯掉之前，有人能告诉我怎么了吗？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T14:52:04.357

您需要在 NextPage.jsp 文件中设置 bean 属性。

像这样在您的 useBean 语句之后添加以下行。

```
<jsp:useBean id="user" class="UserData" scope="session"/>
<jsp:setProperty name="user" property="*" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T02:25:03.900

问题是您的`UserData.class`文件位于错误的目录中，这意味着`UserData.class`实际上应该位于`webapps/app1/WEB-INF/classes/classes/UserData.class`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-04T09:57:01.200

编译java文件“UserData.java”后，会得到一个类文件="UserData.class"。确保UserData.class位于类下的User中。即文件 UserData.java 和 UserData.class 的位置必须是-

..\Tomcat6.0\webapps\ROOT\WEB-INF\classes\UserData.java 和 ..\Tomcat6.0\webapps\ROOT\WEB-INF\classes\UserData.class

如果 WEB-INF 中没有“classes”，您可以创建一个名为“classes”的新文件夹来存储这些文件。重新启动 tomcat 以查看更改。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T02:18:17.890

问题似乎是您将引用类作为一个包。不是，是战争中类的根目录。

从您的类中删除 package 行，并将您的 bean 称为 class="UserData" 并查看会发生什么。

# c# - NHibernate SchemaUpdate

> ID：933327
> 
> 赞同：21
> 
> 时间：2009-06-01T02:07:44.760
> 
> 标签：c#, .net, nhibernate, migration

根据个人经验以及我所阅读的所有内容，NHibernate 的 SchemaUpdate 不支持删除列和表。我想使用 SchemaUpdate 来生成迁移 DDL，但是没有删除会使其变得更加困难。你如何解决这个问题？在进行影响数据库的更改时，是否有其他工具可以帮助将注意力集中在域层上？

是否有任何工具可以像 SchemaUpdate 一样工作（我可以将工具指向我的实体和数据库的当前版本，并让它生成更改脚本）？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-06-01T06:47:18.703

作为一种选择，有一些工具使用[ROR](http://ar.rubyonrails.org/classes/ActiveRecord/Migration.html)的迁移概念。可能不像你想的那么容易，但是你得到了 Up() 和 Down() 用于前进/回滚的概念。

通过一些调整，我能够让[migratordotnet](http://code.google.com/p/migratordotnet/)为一个小项目工作。

还在这里找到了一篇有用的博客文章：http: [//benscheirman.com/2008/06/net-database-migration-tool-roundup](http://benscheirman.com/2008/06/net-database-migration-tool-roundup/)，虽然它是在不久前写的，但希望列出的一些项目从那以后更进一步。

以下是上述帖子的列表：

*   [迁移者.NET](http://code.google.com/p/migratordotnet/)
*   [RikMigrations](http://www.rikware.com/RikMigrations.html)
*   [塔伦蒂诺](http://code.google.com/p/tarantino/)
*   [机器迁移](http://blog.eleutian.com/2008/04/25/AFirstLookAtMachineMigrations.aspx)
*   [亚音速迁移](http://blog.wekeroad.com/2007/10/03/subsonic-migrate-me/)
*   [dbDeploy.NET](http://dbdeploy.com/2007/09/25/dbdeploynet-v10-officially-released/)

# git - Git 撤消某些文件中的更改

> ID：933329
> 
> 赞同：191
> 
> 时间：2009-06-01T02:09:05.333
> 
> 标签：git, file, version-control, undo, revert

在编码时，我将打印语句添加到一些文件中以跟踪正在发生的事情。

完成后，是否可以还原某些文件中的更改，但提交我实际处理的文件？

假设我在 file 中添加了 print `A`，但我修改了 file `B`。`B`是我想提交的`A`，我想恢复到原来的状态。

* * *

## 回答 #1

> 赞同：297
> 
> 时间：2009-06-01T02:16:14.540

根据您对文件 A 所做的更改，有三种基本方法可以做到这一点。如果您尚未将更改添加到索引或提交它们，那么您只想使用 checkout 命令 - 这将改变与存储库匹配的工作副本的状态：

```
git checkout A 
```

如果您已经将其添加到索引中，请使用重置：

```
git reset A 
```

如果你已经提交了它，那么你使用 revert 命令：

```
# the -n means, do not commit the revert yet
git revert -n <sha1>
# now make sure we are just going to commit the revert to A
git reset B
git commit 
```

另一方面，如果您已经提交了它，但提交涉及的文件相当多，您也不想恢复，那么上述方法可能涉及很多“重置 B”命令。在这种情况下，您可能希望使用此方法：

```
# revert, but do not commit yet
git revert -n <sha1>
# clean all the changes from the index
git reset
# now just add A
git add A
git commit 
```

另一种方法，需要使用 rebase -i 命令。如果您有多个要编辑的提交，这可能会很有用：

```
# use rebase -i to cherry pick the commit you want to edit
# specify the sha1 of the commit before the one you want to edit
# you get an editor with a file and a bunch of lines starting with "pick"
# change the one(s) you want to edit to "edit" and then save the file
git rebase -i <sha1>
# now you enter a loop, for each commit you set as "edit", you get to basically redo that commit from scratch
# assume we just picked the one commit with the erroneous A commit
git reset A
git commit --amend
# go back to the start of the loop
git rebase --continue 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-09-11T21:07:36.933

来源： http: [//git-scm.com/book/en/Git-Basics-Undoing-Things](http://git-scm.com/book/en/Git-Basics-Undoing-Things)

git checkout -- modifiedfile.java

* * *

1)$ git 状态

你会看到修改后的文件

2)$git checkout -- modifiedfile.java

3)$git 状态

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-06-01T02:16:56.067

```
git add B # Add it to the index
git reset A # Remove it from the index
git commit # Commit the index 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-06-01T02:11:04.690

[人 git-checkout](http://git-scm.com/docs/git-checkout)：`git checkout A`

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-01T02:13:49.473

是的;

```
git commit FILE 
```

将只提交文件。然后你可以使用

```
git reset --hard 
```

撤消其他文件中的本地更改。

可能还有其他我不知道的方法...

编辑：或者，正如 NicDumZ 所说， git-checkout 只是要撤消更改的文件（最佳解决方案取决于是否有更多文件要提交或更多文件要撤消:-)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-02T12:14:12.600

[为什么你不能简单地使用“ git add](http://www.kernel.org/pub/software/scm/git/docs/git-add.html "git-add - 将文件 _contents_ 添加到索引") *<file>* ”（甚至“git add --interactive”或具有交互式提交选项的“git gui”）标记你想要在提交中进行的更改，然后使用“git commit”而不是“git commit -a”？

在您的情况下（对于您的示例），它将是：

```
prompt> git add B
prompt> git commit 
```

只会提交对文件 B 的更改，而文件 A 将保持“脏”状态，即在工作区版本中使用那些打印语句。当您想删除那些打印语句时，使用它就足够了

```
prompt> git reset A 
```

或者

```
prompt> git checkout HEAD -- A 
```

恢复到提交的版本（来自 HEAD 的版本，即“git show HEAD:A”版本）。

# ios - 如何使用 NSURLConnection 与 SSL 连接以获得不受信任的证书？

> ID：933331
> 
> 赞同：305
> 
> 时间：2009-06-01T02:09:35.350
> 
> 标签：ios, objective-c, https, ssl-certificate, app-transport-security

我有以下简单的代码来连接到 SSL 网页

```
NSMutableURLRequest *urlRequest=[NSMutableURLRequest requestWithURL:url];
[ NSURLConnection sendSynchronousRequest: urlRequest returningResponse: nil error: &error ]; 
```

除了如果证书是自签名证书它会给出错误`Error Domain=NSURLErrorDomain Code=-1202 UserInfo=0xd29930 "untrusted server certificate".`有没有办法将它设置为无论如何都接受连接（就像在浏览器中你可以按接受一样）或绕过它的方法？

* * *

## 回答 #1

> 赞同：418
> 
> 时间：2010-01-09T15:21:35.553

有一个支持的 API 可以实现这一点！向您的`NSURLConnection`委托添加类似的内容：

```
- (BOOL)connection:(NSURLConnection *)connection canAuthenticateAgainstProtectionSpace:(NSURLProtectionSpace *)protectionSpace {
  return [protectionSpace.authenticationMethod isEqualToString:NSURLAuthenticationMethodServerTrust];
}

- (void)connection:(NSURLConnection *)connection didReceiveAuthenticationChallenge:(NSURLAuthenticationChallenge *)challenge {
  if ([challenge.protectionSpace.authenticationMethod isEqualToString:NSURLAuthenticationMethodServerTrust])
    if ([trustedHosts containsObject:challenge.protectionSpace.host])
      [challenge.sender useCredential:[NSURLCredential credentialForTrust:challenge.protectionSpace.serverTrust] forAuthenticationChallenge:challenge];

  [challenge.sender continueWithoutCredentialForAuthenticationChallenge:challenge];
} 
```

请注意，`connection:didReceiveAuthenticationChallenge:`如果需要，可以在向用户显示一个对话框之后等稍后将其消息发送给 challenge.sender。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2009-06-10T01:19:25.187

[如果您不愿意（或无法）使用私有 API，则有一个名为ASIHTTPRequest](http://allseeing-i.com/ASIHTTPRequest)的开源（BSD 许可）库，它提供了对较低级别`CFNetwork APIs`. 他们最近引入了允许通过API`HTTPS connections`使用自签名或不受信任的证书的功能。`-setValidatesSecureCertificate:`如果您不想引入整个库，您可以使用源代码作为参考来自己实现相同的功能。

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2011-08-11T14:36:56.883

理想情况下，iOS 应用程序需要接受不受信任的证书时应该只有两种情况。

场景 A：您连接到使用自签名证书的测试环境。

场景 B：您正在`HTTPS`使用代理代理流量`MITM Proxy like Burp Suite, Fiddler, OWASP ZAP, etc.`The Proxies 将返回由自签名 CA 签名的证书，以便代理能够捕获`HTTPS`流量。

[出于显而易见的原因](http://en.wikipedia.org/wiki/Man-in-the-middle_attack)，生产主机不应使用不受信任的证书。

如果您需要让 iOS 模拟器接受不受信任的证书以进行测试，强烈建议您不要更改应用程序逻辑以禁用`NSURLConnection`API 提供的内置证书验证。如果应用程序在没有删除此逻辑的情况下向公众发布，它将容易受到中间人攻击。

出于测试目的接受不受信任的证书的推荐方法是将证书颁发机构 (CA) 证书导入您的 iOS 模拟器或 iOS 设备上，该证书签署了证书。我写了一篇快速博客文章，演示了如何在 iOS 模拟器中执行此操作：

[使用 ios 模拟器接受不受信任的证书](http://blog.gdssecurity.com/labs/2011/8/7/accepting-un-trusted-certificates-using-the-ios-simulator.html)

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-06-01T10:53:41.077

`NSURLRequest`有一个名为 的私有方法`setAllowsAnyHTTPSCertificate:forHost:`，它将完全按照您的意愿进行操作。您可以通过类别定义`allowsAnyHTTPSCertificateForHost:`方法`NSURLRequest`，并将其设置为返回`YES`您想要覆盖的主机。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2010-02-02T19:50:59.320

我不能对此表示赞赏，[但我发现这个](http://chariotsolutions.blogspot.com/2009/09/iphone-and-ssl.html)非常适合我的需求。`shouldAllowSelfSignedCert`是我的`BOOL`变量。只需添加到您的`NSURLConnection`代表，您就应该在每个连接的基础上快速绕过。

```
- (BOOL)connection:(NSURLConnection *)connection canAuthenticateAgainstProtectionSpace:(NSURLProtectionSpace *)space {
     if([[space authenticationMethod] isEqualToString:NSURLAuthenticationMethodServerTrust]) {
          if(shouldAllowSelfSignedCert) {
               return YES; // Self-signed cert will be accepted
          } else {
               return NO;  // Self-signed cert will be rejected
          }
          // Note: it doesn't seem to matter what you return for a proper SSL cert
          //       only self-signed certs
     }
     // If no other authentication is required, return NO for everything else
     // Otherwise maybe YES for NSURLAuthenticationMethodDefault and etc.
     return NO;
} 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2014-02-07T07:15:14.080

为了补充接受的答案，为了更好的安全性，您可以将您的服务器证书或您自己的根 CA 证书添加到钥匙串（[https://stackoverflow.com/a/9941559/1432048](https://stackoverflow.com/a/9941559/1432048)），但是单独这样做不会使 NSURLConnection自动验证您的自签名服务器。您仍然需要将以下代码添加到您的 NSURLConnection 委托中，它是从 Apple 示例代码[AdvancedURLConnections](https://developer.apple.com/library/ios/samplecode/AdvancedURLConnections/Introduction/Intro.html)复制的，并且您需要将 Apple 示例代码中的两个文件（Credentials.h、Credentials.m）添加到您的项目中。

```
- (BOOL)connection:(NSURLConnection *)connection canAuthenticateAgainstProtectionSpace:(NSURLProtectionSpace *)protectionSpace {
return [protectionSpace.authenticationMethod isEqualToString:NSURLAuthenticationMethodServerTrust];
}

- (void)connection:(NSURLConnection *)connection didReceiveAuthenticationChallenge:(NSURLAuthenticationChallenge *)challenge {
if ([challenge.protectionSpace.authenticationMethod isEqualToString:NSURLAuthenticationMethodServerTrust]) {
//        if ([trustedHosts containsObject:challenge.protectionSpace.host])

    OSStatus                err;
    NSURLProtectionSpace *  protectionSpace;
    SecTrustRef             trust;
    SecTrustResultType      trustResult;
    BOOL                    trusted;

    protectionSpace = [challenge protectionSpace];
    assert(protectionSpace != nil);

    trust = [protectionSpace serverTrust];
    assert(trust != NULL);
    err = SecTrustEvaluate(trust, &trustResult);
    trusted = (err == noErr) && ((trustResult == kSecTrustResultProceed) || (trustResult == kSecTrustResultUnspecified));

    // If that fails, apply our certificates as anchors and see if that helps.
    //
    // It's perfectly acceptable to apply all of our certificates to the SecTrust
    // object, and let the SecTrust object sort out the mess.  Of course, this assumes
    // that the user trusts all certificates equally in all situations, which is implicit
    // in our user interface; you could provide a more sophisticated user interface
    // to allow the user to trust certain certificates for certain sites and so on).

    if ( ! trusted ) {
        err = SecTrustSetAnchorCertificates(trust, (CFArrayRef) [Credentials sharedCredentials].certificates);
        if (err == noErr) {
            err = SecTrustEvaluate(trust, &trustResult);
        }
        trusted = (err == noErr) && ((trustResult == kSecTrustResultProceed) || (trustResult == kSecTrustResultUnspecified));
    }
    if(trusted)
        [challenge.sender useCredential:[NSURLCredential credentialForTrust:challenge.protectionSpace.serverTrust] forAuthenticationChallenge:challenge];
}

[challenge.sender continueWithoutCredentialForAuthenticationChallenge:challenge];
} 
```

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2015-08-24T19:05:53.410

在 iOS 9 中，所有无效或自签名证书的 SSL 连接都将失败。这是iOS 9.0 或更高版本以及 OS X 10.11 及更高版本中新的[App Transport Security](https://developer.apple.com/library/ios/technotes/App-Transport-Security-Technote/)功能的默认行为。

您可以通过在字典中`Info.plist`设置`NSAllowsArbitraryLoads`为来覆盖 , 中的此行为。*但是，我建议仅出于测试目的覆盖此设置。*`YES``NSAppTransportSecurity`

 *[![在此处输入图像描述](https://i.stack.imgur.com/E7vPl.png)](https://i.stack.imgur.com/E7vPl.png)

有关信息，请参阅[此处](https://developer.apple.com/library/ios/technotes/App-Transport-Security-Technote)的应用程序传输技术说明。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2010-07-21T12:58:10.427

Nathan de Vries 发布的类别解决方法将通过 AppStore 私有 API 检查，并且在您无法控制`NSUrlConnection`对象的情况下很有用。一个示例是`NSXMLParser`打开您提供的 URL，但不公开`NSURLRequest`or `NSURLConnection`。

在 iOS 4 中，解决方法似乎仍然有效，但仅在设备上，模拟器不再调用该`allowsAnyHTTPSCertificateForHost:`方法。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2015-02-13T00:46:34.363

您必须使用`NSURLConnectionDelegate`来允许 HTTPS 连接，并且 iOS8 有新的回调。

**已弃用：**

```
connection:canAuthenticateAgainstProtectionSpace:
connection:didCancelAuthenticationChallenge:
connection:didReceiveAuthenticationChallenge: 
```

相反，您需要声明：

> `connectionShouldUseCredentialStorage:`- 发送以确定 URL 加载程序是否应使用凭证存储来验证连接。
> 
> `connection:willSendRequestForAuthenticationChallenge:`- 告诉代理连接将发送一个身份验证质询请求。

`willSendRequestForAuthenticationChallenge`您可以`challenge`像使用已弃用的方法一样使用，例如：

```
// Trusting and not trusting connection to host: Self-signed certificate
[challenge.sender useCredential:[NSURLCredential credentialForTrust:challenge.protectionSpace.serverTrust] forAuthenticationChallenge:challenge];
[challenge.sender continueWithoutCredentialForAuthenticationChallenge:challenge]; 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2012-03-16T23:25:34.003

我发布了一些要点代码（基于我注意到的其他人的工作），可以让您正确地针对自生成的证书进行身份验证（以及如何获得免费证书 - 请参阅[Cocoanetics](http://www.cocoanetics.com/2010/12/nsurlconnection-with-self-signed-certificates/)的评论底部）

我的代码在这里[github](https://gist.github.com/2051599)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2013-09-17T07:36:34.387

如果你想继续使用**sendSynchronousRequest**我在这个解决方案中工作：

```
FailCertificateDelegate *fcd=[[FailCertificateDelegate alloc] init];

NSURLConnection *c=[[NSURLConnection alloc] initWithRequest:request delegate:fcd startImmediately:NO];
[c setDelegateQueue:[[NSOperationQueue alloc] init]];
[c start];    
NSData *d=[fcd getData]; 
```

你可以在这里看到：[Objective-C SSL 同步连接](https://stackoverflow.com/a/18843828/1662307)

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2017-01-07T12:31:23.627

您可以使用此代码

```
-(void)connection:(NSURLConnection *)connection willSendRequestForAuthenticationChallenge:(NSURLAuthenticationChallenge *)challenge
{
     if ([[challenge protectionSpace] authenticationMethod] == NSURLAuthenticationMethodServerTrust)
     {
         [[challenge sender] useCredential:[NSURLCredential credentialForTrust:[[challenge protectionSpace] serverTrust]] forAuthenticationChallenge:challenge];
     }
} 
```

使用`-connection:willSendRequestForAuthenticationChallenge:`而不是这些已弃用的方法

**已弃用：**

```
-(BOOL)connection:(NSURLConnection *)connection canAuthenticateAgainstProtectionSpace:(NSURLProtectionSpace *)protectionSpace  
-(void)connection:(NSURLConnection *)connection didReceiveAuthenticationChallenge:(NSURLAuthenticationChallenge *)challenge 
-(void)connection:(NSURLConnection *)connection didCancelAuthenticationChallenge:(NSURLAuthenticationChallenge *)challenge 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2015-09-07T09:37:55.773

使用[AFNetworking](https://github.com/AFNetworking/AFNetworking)，我已成功使用以下代码使用 https 网络服务，

```
NSString *aStrServerUrl = WS_URL;

// Initialize AFHTTPRequestOperationManager...
AFHTTPRequestOperationManager *manager = [AFHTTPRequestOperationManager manager];
manager.requestSerializer = [AFJSONRequestSerializer serializer];
manager.responseSerializer = [AFJSONResponseSerializer serializer];

[manager.requestSerializer setValue:@"application/json" forHTTPHeaderField:@"Content-Type"];
manager.securityPolicy.allowInvalidCertificates = YES; 
[manager POST:aStrServerUrl parameters:parameters success:^(AFHTTPRequestOperation *operation, id responseObject)
{
    successBlock(operation, responseObject);

} failure:^(AFHTTPRequestOperation *operation, NSError *error)
{
    errorBlock(operation, error);
}]; 
```

# jquery - CSS、JQuery Cycle 和 IE 问题

> ID：933334
> 
> 赞同：6
> 
> 时间：2009-06-01T02:10:15.707
> 
> 标签：jquery, css, cycle

我正在使用一个名为“Cycle”的 jQuery 插件，我在 IE 中遇到了 CSS 的问题，它在 Opera、FF、Chrome 和 Safari 中看起来很完美，但 IE 正在破解悲伤..

www[dot]photographicpassions[dot]com/home

您会在右侧看到“最新作品”和主图像下方的缩略图，在 FF、Safari、Chrome 和 Opera 中，灰色容器位于所有缩略图的后面，但在 IE 中，灰色背景停止在顶部缩略图..我已经尝试了各种方法来使它工作，但无济于事..有人可以帮我吗？

这是在 IE 中表现不佳的容器的 CSS：

```
/* latest work container */
div#latestHolder {
    position: relative;
    float: left; width: 368px;
    margin: 0px 0px 0px 0px;
    padding: 10px 10px 10px 10px;
    background-color: #666666;
}

/* thumbnails */
div#nav {
    position: relative;
    float: left; left: 0px;
    width: 376px;
    padding: 0px 0px 0px 0px;
    margin: 1px 0px 0px 0px;
}
    div#nav li {
        width: 66px;
        float: left;
        padding: 0px 0px 0px 0px;
        margin: 9px 9px 0px 0px;
        list-style: none;
        cursor: pointer;
    }
    div#nav a {
        padding: 3px;
        display: block;
        background: #404040;
        cursor: pointer;
    }
        div#nav a.activeSlide {
            background: #ffffff;
            cursor: pointer;
        }
        div#nav a:focus {
            outline: none;
            cursor: pointer;
        }
    div#nav img {
        width: 60px;
        border: none;
        display: block;
        cursor: pointer;
    } 
```

如果有人可以帮助我，那就太好了！:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T02:39:33.590

只需使用溢出：隐藏在您的容器上。默认情况下，溢出：自动不会增长元素以包含其内容。设置 overflow: hidden （或 overflow: auto...bit 会冒不必要的滚动条的风险），您将强制容器 div 扩展到其所有子元素的高度...包括浮动元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T02:25:00.997

div`#latestHolder`向左浮动，这会导致它[从页面流中移除](http://www.digital-web.com/articles/web_design_101_floats/)。在结束div`float:left;`之前尝试使用相对/绝对位置而不是或清除浮动。`#mainContainer`

`#maincontainer`清除将涉及在div的末尾添加一个块级元素，如下所示：

```
<div style="clear: both;"></div> 
```

# javascript - 闭包中如何引用局部变量？

> ID：933343
> 
> 赞同：5
> 
> 时间：2009-06-01T02:15:24.340
> 
> 标签：javascript, loops, closures

我正在阅读一篇文章（[傻瓜的 JavaScript 闭包](http://blog.morrisjohns.com/javascript_closures_for_dummies)），其中一个示例如下。

```
function buildList(list) {
  var result = [];
  for (var i = 0; i < list.length; i++) {
    var item = 'item' + list[i];
    result.push( function() {alert(item + ' ' + list[i])} );
  }
  return result;
}

function testList() {
  var fnlist = buildList([1,2,3]);
  // using j only to help prevent confusion - could use i
  for (var j = 0; j < fnlist.length; j++) {
    fnlist[j]();
  }
}

testList(); 
```

当调用 testList 时，会出现一个警告框，上面写着“item3 undefined”。文章有这样的解释：

> 当在线调用匿名函数时，`fnlist[j]();`它们都使用相同的单个闭包，并且它们在该闭包中使用 i 和 item 的当前值（其中 i 的值为 3，因为循环已完成，并且 item 具有值'项目3'）。

为什么 item 的值为“item3”？当 i 变为 3 时，for 循环不会结束吗？如果结束，项目不应该仍然是“项目2”吗？还是 testList 调用函数时再次创建了变量项？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-01T02:21:16.013

你很近...

> 为什么 item 的值为“item3”？当 i 变为 3 时，for 循环不会结束吗？

是的。

> 如果结束，项目不应该仍然是“项目2”吗？

没有。这个例子有点棘手。在循环的最后一次迭代中，`i`是 2，但它引用了`list`数组的第三个元素，即 3。换句话说，`item == 'item' + list[2] == 'item3'`

> 还是 testList 调用函数时再次创建了变量项？

不，你第一次几乎是对的。我想你只是错过`item[2]`了价值 3。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-05-19T13:24:44.410

buildList 中的 for 循环在您执行以下操作之前完成：

```
for (var j = 0; j < fnlist.length; j++) {
  fnlist[j]();
} 
```

...因此，到那时（当您调用每个函数时），该变量`item`将是最后分配给它的任何内容（即“item3”），并且`i`将是`3`（作为最后一次`i++`操作的结果），并且`list[3]`是`undefined`.

*这与循环在调用闭包*函数之前完成的事实有关。为了防止这种情况，您可以创建一个新的闭包，如下所示：

```
function buildList(list) {
  var result = [];
  for (var i = 0; i < list.length; i++) {
    var item = 'item' + list[i];
    result.push(
        (function(item, i){
            // Now we have our own "local" copies of `item` and `i`
            return function() {
                console.log(item + ' ' + list[i])
            };
        })(item, i)
    );
  }
  return result;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-05-19T13:24:00.353

如您所说，该`list`变量存储在闭包中。

实际上您可以访问该`list`变量，但您正在尝试访问`list[3]`. 毕竟，`i`变量也是作为闭包存储的，在`console.log`调用函数时它的值为 3。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-05-19T13:27:41.120

我认为你缺少的一点`list[i]`是因为`i`是 3 而被低估了，并且`list`只为 0..2 定义。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-01T02:23:46.460

当 i 变为 3 时循环结束，但存储在闭包中并由 alert 显示的“item”变量设置为

```
var item = 'item' + list[i]; 
```

文本“项目”+ 列表 [2] 中的值。第三个列表项是 3，所以文本是 item3

# .net - 使用 unsafe 标记编译的 .NET 代码可以在 Mono 中运行吗？

> ID：933350
> 
> 赞同：6
> 
> 时间：2009-06-01T02:20:03.113
> 
> 标签：.net, mono, bitmap, unsafe

我有一些代码使用 LockBits 方法进行位图操作并使用指针直接访问位图数据。当然，这段代码必须包装在一个不安全的块中，我想知道这是否意味着该代码在 Mono 中不起作用。

我假设 Bitmap 类在 Mono 中可用，但也许这是另一个破坏因素。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-01T02:25:32.603

是的。这是关于 unsafe 关键字的 Mono 文档：[http ://go-mono.org/docs/index.aspx?link=ecmaspec%3A25](http://go-mono.org/docs/index.aspx?link=ecmaspec%3A25)

Bitmap 类也可用。您可以在此处找到文档：http: [//go-mono.org/docs/index.aspx](http://go-mono.org/docs/index.aspx?tlink=35@ecma%3a1990%23Bitmap%2f) ?tlink=35@ecma%3a1990%23Bitmap%2f 。就像在 .NET Bitmaps 继承 Image 一样，这很好。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-01T02:24:51.403

是的，它可以，而且 Mono 有 Bitmap 类。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-07-10T16:17:34.320

是的，`unsafe`可用。

Mono 甚至在`unsafe`内部使用关键字来尝试在某些领域加速，`BigInteger`例如`Mono.Security`.

# sql-server - MS-SQL Server 2000 慢速全文索引

> ID：933351
> 
> 赞同：3
> 
> 时间：2009-06-01T02:20:23.347
> 
> 标签：sql-server, sql-server-2000, full-text-search

我们在包含 633,569 条记录的相当大的表上建立了全文索引。作为维护计划的一部分，每天晚上在运行删除/插入记录的 DTS 包之后，索引会从头开始重建。大块数据被删除，然后插入（以处理更新和插入），因此增量索引是不可能的。将包更改为仅在必要时删除也是不可能的，因为它是最终将被替换的遗留应用程序。

FTI 包括两列——一列是 varchar(50) not null，另一列是 varchar(255) null。

主键列上有一个聚集索引，它只是一个标识列。上面提到的整数列和 varchar(50) 列上还有一个组合索引。出于性能原因，添加了后一个索引。

问题是重新索引非常缓慢 - 大约 8 小时。

服务器相当健壮（双处理器，4gb 内存），除了重新索引之外，一切都运行得很快。

有关如何加快速度的任何提示？

**更新**

我们的客户可以访问 sql 框。结果他们打开了作为全文索引一部分的表的更改跟踪。我们把它关掉了，全部填充用了不到 3 个小时。仍然不是很好，但比 8 好。

**更新 2**

FTI 再次需要大约 8 小时来填充。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-26T19:32:29.397

SQL Server 的索引很慢，主要是因为它的异步数据提取方案。

*   通过“在后台更新索引”选项使用更改跟踪。

提高全文索引性能的最简单方法是使用带有“在后台更新索引”选项的更改跟踪。当您为表建立索引时（FTI 与“标准”SQL 索引一样，在每个表的基础上工作） ，您指定完全填充、增量填充或更改跟踪。当您选择完整填充时，您正在全文索引的表中的每一行都会被提取和索引。这是一个两步过程。

首先，您（或企业管理器）运行此系统存储过程：

```
sp_fulltext_getdata CatalogID, object_id 
```

在将所有时间戳和 PK 值的所有结果集返回给 MSSearch 后，MSSearch 将发出另一个 sp_fulltext_getdata，但这一次，对表中的每一行执行一次。因此，如果您的数据库中有 5000 万行，此过程将发行5000万次。

另一方面，如果您使用增量填充，MSSearch 将发出一个初始值：

```
sp_fulltext_getdata CatalogID, object_id 
```

对于您正在全文索引的表中的每一行。因此，如果您的数据库中有 5000 万行，则该语句也将发出 5000 万次。为什么？因为即使使用增量填充，MSSearch 也必须准确确定哪些行已更改、更新和删除。增量填充的另一个问题是，即使对不是全文索引的列进行了更改，它们也会对行进行索引或重新索引。

尽管增量填充通常比完整填充快，但您可以看到，对于大型表，两者都将非常耗时。

我建议您启用具有后台或计划更新的更改跟踪。如果这样做，您将看到 MSSearch 将首先发出另一个：

```
sp_fulltext_getdata CatalogID, object_id 
```

对于启用了更改跟踪的表中的每一行。然后，对于具有您正在全文索引的列并且在初始完整填充后修改的每一行，将写入行信息（在您所在的数据库中索引）到 sysfulltextnotify 表。然后，MSSearch 将仅针对出现在此表中的行发出以下命令，然后将它们从 sysfulltextnotify 表中删除。

*   考虑使用单独的构建服务器

在您编制索引时大量更新的表可能会产生锁定问题，因此，如果您可以忍受定期过时的目录和有时不可用的 MSSearch 引擎，请考虑使用单独的构建服务器。您可以通过确保索引服务器具有要全文索引的表副本并导出目录来做到这一点。显然，如果您需要对目录进行实时或接近实时的更新，这不是一个好的解决方案

*   人口运行时限制活动

在填充运行时，不要运行 Profiler，并尽可能限制其他数据库活动。Profiler 消耗大量资源。

*   增加索引进程的线程数

增加为索引进程运行的线程数。默认值只有五个，在四边形或八边形上，您可以将其提高到更高的值。但是，如果 MSSearch 从 SQL Server 中获取过多数据，它会自我限制，因此请避免在单处理器或双处理器系统上执行此操作。

*   停止任何防病毒或打开的文件代理备份软件。

如果这不可行，请尝试阻止他们扫描 SQL FTI 正在使用的临时目录和目录目录

*   将目录、临时目录和页面文件放在它们自己的控制器上

如果您可以进行投资。将目录放在其自己的控制器上，最好放在 RAID-1 阵列上。将临时目录放在 RAID-1 阵列上。同样，考虑将页面文件放在其自己的具有自己的控制器的 RAID-1 阵列上。

*   考虑为 Temp DB - 每个 CPU / Core 1 个创建辅助数据文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T02:26:41.307

*   你有足够的内存吗？

*   就 RAID 配置而言，您的文件驱动器位置是什么？

*   您是否看到高温的 tempDB 活动？

（顺便说一句，半百万条记录并不大；它甚至不是中等... ;)）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T02:31:16.600

尝试将索引放在与数据库不同的物理磁盘上。

编辑：斯科特报告说情况已经如此。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T12:26:53.713

在您进行重新索引或直播时系统是否处于脱机状态？

这些是您全文目录中唯一的项目吗？如果不是，您可能需要考虑将它们从您的 FTS 数据的其余部分中分离出来。（也可能有助于监控）索引中的标识列是否配置为唯一键？

你能量化大量的变化吗？重新填充有 3 个基本选项；您可能想尝试切换到完整或增量，因为其中一种可能比您现在使用的更适合您。以我的经验，如果对总数据库的更改小于 40%（在将大数据导入数据库期间存在类似问题），增量效果很好。如果更改 >40%，那么完整可能会更好（根据我的经验 - 我索引文档所以它可能对您有不同的工作方式）您可能要考虑的第三个选项尝试使用计划更新重新索引选项进行更改跟踪。

如果您可以使服务器对用户脱机，那么在重新索引时您运行 FTS 的性能设置是什么？您可以检查此全文搜索服务属性/性能选项卡 - 系统资源使用情况作为滑块（认为有 4 或 5 个位置）。可能有一个系统过程来改变这个不知道它并且没有一台 2000 机器来检查了。

FTS / Reindexing 喜欢 ram 和很多它；一般的经验法则是虚拟内存是物理内存的 3 倍；如果您有多个物理磁盘，则创建多个 Pagefile.sys 文件，以便将每个 Pagefile.sys 文件放置在其自己的物理磁盘上。你是在 NT 还是 Windows 2000 上？检查是否正确配置了超过 2gb 的扩展内存。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T15:35:40.290

在当前执行的列中禁止空值可能不会加快索引速度，但根据我的经验，这是一种更好的做法，尤其是出于索引目的。我可以证明允许空值的唯一列是日期列。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-25T13:30:56.663

这是[SQL Server 上 FT 索引性能的参数清单](http://www.sql-server-performance.com/tips/full_text_search_p1.aspx)。其中大部分已在此处引用和检查。不过，我在您的评论中找不到其中之一：

> SQL Server MAX SERVER MEMORY 设置应手动设置（动态内存分配已关闭），以便留出足够的虚拟内存供全文搜索服务运行。为此，请选择 MAX SERVER MEMORY 设置，一旦设置，就会留下足够的虚拟内存，以便全文搜索服务能够访问相当于服务器中物理 RAM 量 1.5 倍的虚拟内存量。这将需要一些试验和错误来实现此设置。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-06T10:30:29.457

提高全文索引的性能：http: [//msdn.microsoft.com/en-us/library/ms142560.aspx](http://msdn.microsoft.com/en-us/library/ms142560.aspx)

# c# - WPF SQL Distributed Data Model with LINQ and SQL Express

> ID：933352
> 
> 赞同：1
> 
> 时间：2009-06-01T02:20:38.930
> 
> 标签：c#, .net, sql, sql-server, sql-server-2005

I am developing an application in C#/WPF that requires a distributed data model, as it will have both online and offline access.

My current thoughts are to develop the first version of the application against SQL Server express and LINQ to SQL. Then use the schema to create a SQL Express Compact DB (and modify the connection string) for distribution.

Once that version is how I like it, I will add the "distributededness" to the application by creating a web service that the application syncs its local database with.

My questions are: is this a good approach? And will I run into problems by turning my reference to a "real" SQL server into a reference to a local self-contained SQL database file? I had issues trying to create LINQ to SQL with a compact DB reference, but I can't see how it is different then a reference to a "real" server.

Thanks

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T04:28:15.407

目前我正在考虑这个：

[http://www.mindscape.co.nz/products/lightspeed/](http://www.mindscape.co.nz/products/lightspeed/)

然后为我的应用程序使用 LINQ to SQLITE。

对这种方法有什么意见吗？

# requirements - Requirements testing

> ID：933353
> 
> 赞同：2
> 
> 时间：2009-06-01T02:20:51.583
> 
> 标签：requirements

I've just finished the implementation of my software system and now I have to document whether it has satisfied its requirements. What sort of information should I include and how should I lay it out?

My initial functional and non-functional requirements was in a two-column table and looked something like this:

*   FN-01 The system should allow users to send private messages to each other.
*   NFN-03 The setup/conﬁguration form should contain sensible default values for most ﬁelds.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T03:49:41.413

我会使用已经存在的需求编号方案，而不是创建一个新方案。我将为每个要求记录以下项目：

1.  **需求状态**：这可以用许多不同的方式表达，但是如果需求已按所列完成、以所列内容的修改变体完成或根本无法完成，您会很想交流。
2.  **需求注释**：描述之前列出的需求状态。这就是“为什么”，将解释那些不能完全满足要求的项目。
3.  **完成日期**：这主要用于未来的产品规划，也可作为历史参考服务器。

还有几点要记住：

1.  需求可能会被客户审查，尤其是当客户是需求的来源时。因此，该文件需要尽可能准确和信息丰富。（这也是您不更改需求编号方案的另一个原因，除非您必须这样做。）
2.  您的测试部门（假设您有一个）应该使用这些文档进行测试计划，他们需要知道满足了哪些要求，哪些没有满足，最重要的是哪些更改以及如何更改。

最后，除非您要为某人展示狗和小马表演，否则您不需要将屏幕截图作为需求文档的一部分。您也不需要提供完成的“证明”。测试部门会为你做这件事。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-09T17:38:20.553

有一些技术可以将您的需求转换为测试用例。但这些取决于您的要求是如何记录的。如果您已经进行了基于场景的需求分析，那么这将非常容易：只需为场景的每个路径创建一个序列图，编写/执行测试 -> 完成。除了以这种方式创建的文档外，还应该给您的讲师留下深刻印象。

如果你没有场景，你应该从你的用例中创建一些。

这里的缺点是它的工作量很大，并且只应在证明其使用合理性的情况下使用（例如论文；））

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T23:02:54.983

验证需求的正式方法是测试——通常是验收测试。

这个想法是：对于每个需求，都应该有一个或多个测试来验证需求。在正式的开发情况下，客户将在他们签署需求的同时签署验收测试。

然后，当产品完成后，您将展示验收测试的结果，客户在接受最终产品之前对其进行审核。

如果您有无法测试的需求，那么它们可能写得不好。

例如，不要说“加载文件应该很快”，说“在 Z 的硬件上加载大小为 X 的文件不超过 Y 毫秒”或类似的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T18:20:24.443

我们通常会制定一个测试计划，如果满意，可以在其中勾选每个项目。该计划将基于原始需求（功能性或非功能性），例如：

**要求：**使用错误密码尝试登录 3 次后，用户帐户应被锁定。

**测试：**尝试使用错误密码登录 3 次以上。用户帐户现在是否被锁定？

我们将针对每个需求执行此操作，并为每个候选发布者重新运行计划。一些测试是自动化的，但我们确实有一个豪华的测试团队来执行手动测试！

根据运行这些测试计划和用户验收测试的结果，我们将签署 RC 为正确且适合发布。

请注意，有时即使测试计划中的某些项目没有通过，我们也会签收发布，这完全取决于项目的性质！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-01T02:43:11.083

逐一列出带有需求行的需求编号，然后是证明它这样做的文本和/或屏幕截图。

将左侧的需求编号以粗体显示，然后将需求文本标记为斜体。将证明文本/屏幕截图与要求文本对齐，将左列留空，仅显示要求编号。例如：

```
REQ-1      italicized requirement text

           text discussing how the software has
           fulfilled the requirements, possibly
           with a picture:

           -----------------------
           |                     |
           |                     |
           |                     |
           |                     |
           |                     |
           -----------------------

REQ-2      italicized requirement text

           etc... 
```

您应该根据逻辑程序区域分组为章节或章节，并以关于整个程序区域如何满足要求的简介开始章节或章节（一般

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-02T15:31:30.753

我会保持简单并添加以下列：

*   交付满足要求 - 带有包含是、否、打开的下拉列表
*   评论 - 关于传递的任何评论，例如“需要定义消息大小”、“不完全满足消息的布局，但被客户接受”等。
*   完成日期 - 交付更改的时间
*   满意日期 - 接受更改的时间

通过使用需求 ID，我假设它们指向包含更详细信息的文档，包括布局、屏幕截图等。

# javascript - make html image area ‘coord’ blinking or glow …

> ID：933355
> 
> 赞同：0
> 
> 时间：2009-06-01T02:22:18.180
> 
> 标签：javascript, jquery, html, effects

i trying to make html image `<area coord tag` more clear to viewer. any javascript sample to make those coordinate blinking effect or similar as long as it each coord is clear to viewer?

p/s: problem with paste < area .that why you didn't see the full of my message.sorry repost

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T02:27:59.853

i haven't tested this as i don't have time right now but you should be able to make it stand out just with CSS, something like this:

```
area {
    filter:Glow(color=#00FF00,strength=4);
    text-decoration: blink;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T02:52:30.787

两种解决方案：一种，叠加另一个图像。除了您要突出显示的区域外，叠加图像将是透明的，并且不透明度设置得足够低以仍然可以看到它后面的内容。第二，使用真实图像作为上述'覆盖'图像的背景图像（覆盖图像必须具有已经半透明的覆盖区域而不是使用css）。

例如（版本一）

```
<span class='image_container'>
    <img id='base_image' src='base.png' >
    <img id='overlay_image' src='overlayimage.png' usemap='#yourmaphere'>
    <map name='yourmaphere'>
    ...
    </map>
</span>

.image_container {
    position:relative;
}

#overlay_image {
    position:absolute;
    top:0;
    left:0;
    opacity:0.5;
    filter: alpha(opacity = 50);
    /* text-decoration: blink; */ /*optional*/
} 
```

例如（第二版）

```
<img id='base_image' src='overlayimage.png' usemap='#yourmaphere'>
<map name='yourmaphere'>
...
</map>

#base_image {
    background: transparent url(base.png) no-repeat scroll top left;
} 
```

# ruby-on-rails - Rails Formbuilder Question

> ID：933356
> 
> 赞同：7
> 
> 时间：2009-06-01T02:22:20.270
> 
> 标签：ruby-on-rails, ruby, formbuilder

I'm working a project that has recurring, weekly events. Thus, I use several DateTime fields in a nontraditional way. What I'm working on is a FormBuilder that creates a field that outputs a select for a weekday, and a select for time. I'm using a twelve-hour plugin I found online, so that works:

```
class ActionView::Helpers::FormBuilder
  def dow_time(dow,time,options={})
    rval = select(dow, DateTime::DAYNAMES)
    rval += time_select(time, {:minute_step => 15, :ignore_date => false, :twelve_hour => true})
  end
end 
```

The problem I'm having is that the weekday select doesn't actually have a default selected value. This works fine on my create pages, but not on the edit pages. dow is a symbol that references the field in the calling model where the day of the week string is "Monday", "Tuesday", etc. How can I pull that value out of the calling model using dow.

```
self[dow] 
```

Doesn't work since this is in a different class.

Any ideas? Something different?

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-01T10:34:37.603

如果您在 FormBuilder 中，那么您可以通过简单地使用“对象”变量来访问当前对象。

前任：

在：edit.html.erb

```
<% form_for(@event) do |form| %>
  <%= form.custom_datetime_select(:event_starts_at) %>
<% end %> 
```

在你的 FormBuilder

```
def custom_datetime_select(field, options = {})
  start_time = object.send(field)
  ...
end 
```

`object`和都`object_name`在您调用时为您设置`form_for`。

有关`actionpack/lib/action_view/helpers/form_helper.rb`更多详细信息，请参阅。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T04:00:28.107

这应该对你有用......

```
class ActionView::Helpers::FormBuilder
  def dow_time(dow_model, time, options={})
    rval = select(dowmodel, :dow, DateTime::DAYNAMES)
    rval += time_select(time, {:minute_step => 15, :ignore_date => false, :twelve_hour => true})
  end
end 
```

# php - PHP - 如何最好地确定当前调用是来自 CLI 还是 Web 服务器？

> ID：933367
> 
> 赞同：215
> 
> 时间：2009-06-01T02:26:42.257
> 
> 标签：php

我需要确定当前的 PHP 调用是来自命令行 (CLI) 还是来自 Web 服务器（在我的例子中，是带有 mod_php 的 Apache）。

有什么推荐的方法吗？

* * *

## 回答 #1

> 赞同：342
> 
> 时间：2009-06-01T02:34:43.007

`php_sapi_name`是您要使用的函数，因为它返回接口类型的小写字符串。此外，还有 PHP 常量`PHP_SAPI`。

文档可以在这里找到：http: [//php.net/php_sapi_name](http://php.net/php_sapi_name)

例如，要确定是否从 CLI 运行 PHP，您可以使用以下函数：

```
function isCommandLineInterface()
{
    return (php_sapi_name() === 'cli');
} 
```

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2014-09-22T05:57:52.860

我已经使用这个功能几年了

```
function is_cli()
{
    if ( defined('STDIN') )
    {
        return true;
    }

    if ( php_sapi_name() === 'cli' )
    {
        return true;
    }

    if ( array_key_exists('SHELL', $_ENV) ) {
        return true;
    }

    if ( empty($_SERVER['REMOTE_ADDR']) and !isset($_SERVER['HTTP_USER_AGENT']) and count($_SERVER['argv']) > 0) 
    {
        return true;
    } 

    if ( !array_key_exists('REQUEST_METHOD', $_SERVER) )
    {
        return true;
    }

    return false;
} 
```

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2016-12-30T22:08:59.553

`php_sapi_name()`确实不是执行此检查的最佳方法，因为它取决于检查许多可能的值。可以从命令行、shell 脚本或 cron 作业调用 php-cgi 二进制文件，并且（在大多数情况下）这些也应被视为“cli”，但`php_sapi_name()`会为这些返回不同的值（请注意，这不是与普通版本的 PHP 的情况不同，但您希望您的代码在任何地方都可以工作，对吧？）。更不用说明年可能会有我们现在不可能知道的使用 PHP 的新方法。当我关心的只是天气时，我宁愿不考虑它，我是否应该用 HTML 包装我的输出。

幸运的是，PHP 有办法专门检查这一点。只需`http_response_code()`不带任何参数使用，如果从 Web 服务器类型环境运行，它将返回 TRUE，如果从 CLI 类型环境运行，它将返回 FALSE。这是代码：

```
$is_web=http_response_code()!==FALSE; 
```

如果您在调用它之前不小心（？）从从 CLI（或类似 CLI 的东西）运行的脚本中设置了响应代码，这甚至会起作用。

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2009-06-01T02:34:46.797

我认为他的意思是是否正在调用 PHP CLI 或者它是来自 Web 请求的响应。最好的方法是使用`php_sapi_name()`which 如果它正在运行一个 web 请求，如果它正在运行，它会回显 Apache。

列出一些从 php[文档中获取的内容`php_sapi_name()`](http://php.net/manual/en/function.php-sapi-name.php)：

*   在线服务器
*   阿帕奇
*   apache2过滤器
*   apache2处理程序
*   镉
*   cgi (直到 PHP 5.3)
*   cgi-fcgi
*   cli
*   cli-server ( PHP 5.4 的[内置 Web 服务器)](http://php.net/manual/en/features.commandline.webserver.php)
*   连续性
*   嵌入
*   fpm-fcgi
*   伊萨皮
*   光速
*   米尔特
*   nsapi
*   phttpd
*   pi3web
*   罗克森
*   thttpd
*   晚礼服
*   网络游戏

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2014-01-17T11:22:14.110

这应该处理所有情况（包括 php-cgi）

```
return (php_sapi_name() === 'cli' OR defined('STDIN')); 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2017-02-15T11:00:46.967

```
function is_cli() {
    return !http_response_code();
} 
```

例子：

```
if (is_cli()) {
    echo 'command line';
} else {
    echo 'browser';
} 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-06-01T02:33:44.083

尝试

```
isset($_SERVER['REQUEST_METHOD']) 
```

如果已设置，则您在浏览器中。

或者，您可以检查是否

```
isset($_SERVER['argv']) 
```

但在 Windows CLI、IDK 上可能不是这样。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2013-04-16T18:48:16.913

我用这个：

```
php_sapi_name() == 'cli' || (is_numeric($_SERVER['argc']) && $_SERVER['argc'] > 0) 
```

这是来自 Drush 代码库 environment.inc，他们在那里进行了类似的检查。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-06-01T02:36:49.583

根据[http://jp2.php.net/manual/en/features.commandline.php](http://jp2.php.net/manual/en/features.commandline.php)有许多常量仅在从 CLI 运行时设置。这些常量是 STDIN、STDOUT 和 STDERR。测试其中之一将告诉您它是否处于 cli 模式

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2014-09-02T12:57:39.307

joomla方式

```
if (array_key_exists('REQUEST_METHOD', $_SERVER)) die(); 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-06-01T02:34:39.527

我建议检查是否设置了[$_SERVER](http://de.php.net/manual/en/reserved.variables.server.php)数组的某些条目。

例如：

```
if (isset($_SERVER['REQUEST_METHOD'])) {
        print "HTTP request\n";
} else {
        print "CLI invocation\n";
} 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-07-21T17:37:49.017

一个简单的方法是询问`$argv`变量，（无论如何你可能会为命令行参数做这件事）。即使没有参数也`$argv`返回一个空数组。

如果已设置，则使用 cli。然后，您可以假设所有其他调用都通过某个 Web 服务器或其他。

例如：

```
if (isset($argv)) {
  // Do the cli thing.
} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2018-06-06T08:43:59.633

这个问题的正确答案取决于它背后的真正意图：

*   SAPI 是否是决定因素（网络上下文与否）？
*   还是信息被解释为“在 tty 中运行”？

如果前者给出的答案和所写的评论足以找到有效的解决方案。

如果是后者，如果该工具作为 cronjob 或作为来自另一个守护进程的后台作业运行，此处给出的配方将失败——在这种情况下，我建议进一步测试是否`STDIN`是 TTY：

```
function at_tty() {
    return defined("\STDIN") && posix_isatty(\STDIN);
} 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2018-08-14T20:33:38.350

怎么，这么多复杂的解决方案。怎么样 ...

```
if($_SERVER['REQUEST_SCHEME']=="http" or $_SERVER['REQUEST_SCHEME']=="https"){
    // must be browser :)
} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-10-22T08:55:34.160

```
// Detect CLI calls
define("IS_CLI_CALL",( strcmp(php_sapi_name(),'cli') == 0 ));

if(IS_CLI_CALL){
   //do you stuff here

} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2018-04-01T11:18:12.407

根据[上面 Silver Moon 的回答](https://stackoverflow.com/questions/933367/php-how-to-best-determine-if-the-current-invocation-is-from-cli-or-web-server/25967493#25967493)，我使用此函数返回正确的换行符：

```
/**
* Linebreak function
* @return "/n" if cli, else return <br>
*/
protected static function lb(){

    return (defined('STDIN') || php_sapi_name() === 'cli' || isset($_ENV['SHELL']) ||
    (empty($_SERVER['REMOTE_ADDR']) && !isset($_SERVER['HTTP_USER_AGENT']) && count($_SERVER['argv']) > 0) ||
    !isset($_SERVER['REQUEST_METHOD'])) ? "\n" : "<br>";

} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-10-11T11:49:52.657

### 一个实用的提示

官方的方式（正如许多人所说的）是`PHP_SAPI`作为一个常量或`php_sapi_name()`作为一个函数，`cli`当您处于命令行情况时它们都会返回。他们是对的。

**但！...**

考虑使用`$_SERVER["argv"]`（`$argv`在大多数情况下也是）`null`在浏览器中运行时使用，以及从命令行调用时使用数组。这种方法（或同时使用）的优点是您可以*模拟*在浏览器中运行的终端，只需为 $argv / $_SERVER["argv"] 变量提供（假）值。当您在通常无法获得 SSH 访问权限的外部服务器（prod、staging 等）上进行测试时，这会派上用场。

最好的方法是记住您是否需要 CLI 模拟，并使用*$argv*和*PHP_SAPI*`<pre>`来协调这一点 - 例如，如果 PHP_SAPI 不是“cli”，您可能需要预先输出一个额外的标签但是$argv 有一个值。

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2009-06-01T14:45:41.717

我的首选方法：

```
if (array_key_exists('SHELL', $_ENV)) {
  echo "Console invocation";
}
else {
  echo "HTTP invocation";
} 
```

* * *

## 回答 #19

> 赞同：-19
> 
> 时间：2009-06-01T02:32:28.283

我会尝试：

```
echo exec('whoami'); 
```

通常网络服务器在不同的用户名下运行，所以这应该说明问题。

# asp.net - Anyone have a workaround for the aspnet menu control not rendering properly in ie8?

> ID：933370
> 
> 赞同：2
> 
> 时间：2009-06-01T02:31:11.810
> 
> 标签：asp.net, internet-explorer-8, aspmenu

I am programming asp.net in C# using vs2008\.

My app runs fine in ie7, but the drop down menu does not render in ie8\. A white rectangle shows up instead of the menu items. I checked viewsource and the html for the menu looks good.

Anyone have a fix?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T02:39:38.423

尝试使用`<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7">`此处详述的元标记：http: [//www.microsoft.com/windows/internet-explorer/readiness/developers-new.aspx#dom](http://www.microsoft.com/windows/internet-explorer/readiness/developers-new.aspx#dom)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-23T14:23:40.487

ms发布了补丁，这是他们下拉控件中的错误

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-08T16:12:41.853

[http://blogs.msdn.com/giorgio/archive/2009/02/01/asp-net-menu-and-ie8-rendering-white-issue.aspx](http://blogs.msdn.com/giorgio/archive/2009/02/01/asp-net-menu-and-ie8-rendering-white-issue.aspx)

# iphone - NSObject release... Still shows up in ObjectAlloc

> ID：933377
> 
> 赞同：0
> 
> 时间：2009-06-01T02:35:36.187
> 
> 标签：iphone, objective-c, memory-management

I have been tracking down why NSObject references, while being explicitly release, still show up in ObjectAlloc. In fact, have reduced down NSObject to a basic shell, with a [[myObject alloc]init] immediately followed by a [myObject release], and it does not look like it is being released in ObjectAlloc. This is a big problem with a NavigationController app that pushes/pops multiple view controllers, as the recently popped viewcontrollers aren't being released, because of these 'unreleased' NSObject references. Hmmmmmm.

I could put my code up here, and have a bunch of 'have you's that never get anywhere. Autorelease pools, blah blah.

So, let's look at the Sample 'SeismicXML' sample app from Apple... fire it up in ObjectAlloc/Leaks. Very basic in getEarthquakeData:

```
XMLReader *streamingParser = [[XMLReader alloc] init];
[streamingParser parseXMLFileAtURL:[NSURL URLWithString:feedURLString] parseError:&parseError];
[streamingParser release]; 
```

I see a TON of junk laying around in ObjectAlloc from XMLReader, despite releasing it. I bet if we put a 'refresh' button on this app to call 'getEarthquakeData' again, we would crash the app within 5 refreshes.

Any thoughts?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T02:45:46.510

我认为您对 ObjectAlloc 工具感到困惑，该工具将显示应用程序生命周期内的所有对象分配。它的主要用途是跟踪一段时间内的内存使用情况。

我认为您想要的工具是称为 Leaks 的工具，它通过没有任何引用向您显示正在泄漏的内存。那是指向对象的指针在重新分配之前未发送 release-dealloc。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T02:51:32.877

可能有一个自动释放池持有该对象。如果您创建了许多自动释放的对象而不将它们从池中清除，那么在您返回到带有自动释放池的外循环之前，您将得到泄漏。

下面是自动释放池的工作方式：在主循环中，有一个自动释放池。所有自动发布的东西都在那里。在每次循环迭代结束时，池中的所有对象都会被释放。如果您在某个地方的另一个循环中分配对象，它们实际上不会被释放，直到您返回主循环。当然，除非您为循环创建自己的自动释放池。

另一个问题可能是您的对象永远不会被释放。如果您在 +alloc 和 -release 之间遇到异常，您将得到泄漏。解决此问题的一种方法是改用：

```
[[[XMLReader alloc] init] autorelease] 
```

最后，您可以在这里使用垃圾收集。我对 GC 系统了解得不够多，无法告诉您应该期待什么行为。

# ruby-on-rails - Ruby on Rails and restful_authentication plugin

> ID：933378
> 
> 赞同：3
> 
> 时间：2009-06-01T02:35:38.247
> 
> 标签：ruby-on-rails, login, ruby-on-rails-plugins, restful-authentication

I'm using the restful_authentication plugin for my login page. The problem is that after I log in as a user, I never get logged out until I click on log out. How do I set a session timeout of 15 minutes? For example, after 15 minutes if I go to any page, I should be redirected to the login page.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T02:56:41.837

您可以在 rails 2.3 的 config/initializers/session_store.rb 文件中配置会话过期时间。

只需添加以下选项：

```
:expire_after => 60.minutes 
```

或者，您可以通过在 before_filter 中使用以下内容来更改每个控制器/操作的过期时间：

```
request.session_options = request.session_options.dup
request.session_options[:expire_after] = 5.minutes
request.session_options.freeze 
```

这些说明位于：[http](http://squarewheel.pl/posts/3) ://squarewheel.pl/posts/3 ，其中还包含一个用于 rails < 2.3 的插件的链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T22:57:50.110

请注意，这只设置 cookie 过期时间，而不是服务器检查的会话过期时间（至少对于我为 rails <2.3 编写的插件）。要实现后者，您必须实现自己的 before_filter 来检查会话中的时间戳，如果时间超过可接受的限制，则将其丢弃。同样，我还没有检查 >=2.3 是否需要这样做

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-06-14T18:40:30.510

在您的 application.rb 中：

```
 before_filter :update_activity_time, :except => [:login, :logout]

   def update_activity_time
     session[:expires_at] = 60.minutes.from_now #default 60
   end 
```

# .net - Can't use ProcessWindowStyle.Minimized to start Firefox instance minimized?

> ID：933379
> 
> 赞同：0
> 
> 时间：2009-06-01T02:35:55.547
> 
> 标签：.net, firefox

I'm having trouble using Process.Start with Firefox. I want to start a new instance of Firefox in a minimized window. The following works fine with Internet Explorer, notepad, etc.:

```
ProcessStartInfo p = new ProcessStartInfo();
p.FileName = "iexplore.exe";
p.Arguments = "http://www.google.com";
p.WindowStyle = ProcessWindowStyle.Minimized;
Process.Start(p); 
```

This opens IE in a new, minimized window. Good, just what I want. If I try the exact same thing but instead supply Firefox in the p.FileName, it opens Firefox in a "normal" window, rather than minimized. I've tried various changes to arguments, also have tried examining my local Firefox settings (under Tools/Options) with no luck. I'm sure I'm just missing something simple, but can't figure out what it is. If anyone can help me with getting Firefox opened in a minimized state it would be greatly appreciated!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-01T02:39:34.290

This is a link to an awfully old thread, but it might still be relevant for your issue: [Start Firefox minimized to taskbar?](http://forums.mozillazine.org/viewtopic.php?f=38&t=338477&start=0&st=0&sk=t&sd=a).

# c# - 转换为双转义字符串

> ID：933387
> 
> 赞同：2
> 
> 时间：2009-06-01T02:41:04.210
> 
> 标签：c#, string

在 C# 中，我有一个需要转换为双重转义的文件名（因为我将此字符串输入到正则表达式中）。

换句话说，如果我有：

```
FileInfo file = new FileInfo(@"c:\windows\foo.txt");
string fileName = file.FullName; 
```

`fileName`是：`c:\\\\windows\\\\foo.txt`

但我需要将其转换为在文件名中有两个文字反斜杠 \\ 的序列。文件名必须是`@"c:\\\\windows\\\\foo.txt"`, 或`"c:\\\\\\\\windows\\\\\\\\foo.txt"`. 有没有一种简单的方法来进行这种转换？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-01T02:55:35.787

我认为您正在寻找[Regex.Escape](http://msdn.microsoft.com/en-us/library/system.text.regularexpressions.regex.escape.aspx)

```
Regex.Escape(@"c:\test.txt") == @"C:\\Test\.txt" 
```

注意它是如何转义 '.' 的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T02:45:46.197

最简单的这部分无需使用正则表达式：

```
string fileName = file.FullName.Replace(@"\", @"\\\\"); 
```

基于OP，但我认为你真的想要这个：

```
string fileName = file.FullName.Replace(@"\", @"\\"); 
```

话虽如此，我看不出你想如何使用它......它根本不需要转义......也许你应该发布更多代码？

# svn - 尝试 svn 结帐，但得到： svn: '.' 已经是不同 URL 的工作副本

> ID：933390
> 
> 赞同：18
> 
> 时间：2009-06-01T02:43:58.353
> 
> 标签：svn, svn-checkout, working-copy

我正在尝试 svn checkout 到我的 public_html 文件夹，但我收到此错误：svn: '.' 已经是不同 URL 的工作副本

我的兄弟已经为我建立了一个样板站点，但我已经对其进行了更改并将这些更改放入我自己的存储库中。如何使此文件夹不是他最初设置的存储库的工作副本？

我可以删除 public_html 文件夹并创建一个新文件夹吗？我可以从头开始，因为我只是将已安装的 drupal 站点检出到该站点上。

我在另一个问题中看到一个解决方案可能是简单地删除 .svn 目录。我试过这个，但它说.svn中的几个子目录的权限被拒绝。

在此先感谢您的帮助，希望这个问题不会太愚蠢...

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-01T03:37:42.743

你可以试试“svn switch”。在 http://svnbook.red-bean.com/en/1.0/ch04s05.html 的示例中，它很简单：

```
 $ svn switch http:// svn.example.com/repos/calc/branches/my-calc-branch 
```

但是由于您有子目录权限问题，因此您重新创建 public_html 的计划听起来是最好的解决方案；请注意“rm”的拼写错误。尝试使用“mv”将旧目录移开，这不依赖于子目录权限。

您可以使用：

```
 $ mv public_html old_public_html
 $ mkdir public_html
 $ chmod 755 public_html
 $ cd public_html
 $ svn checkout url 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-01T03:09:57.817

如果您赶时间，这一系列命令应该可以做到。

必须有一种方法来更新工作副本的参考 url，但我不知道它是临时的。

```
$ svn diff > ../changes.patch
$ rm -rf * ..?*
$ svn checkout url
$ patch -p < ../changes.patch 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T03:13:44.767

如果您不需要与您兄弟的仓库建立联系，那么只需删除他的所有`.svn`目录。

权限问题肯定与 SVN 无关。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-03-26T05:31:33.400

我认为在您的情况下，最好的选择是删除文件夹并再次创建它，从 SVN 结帐

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-01T22:46:40.650

> 我在另一个问题中看到一个解决方案可能是简单地删除 .svn 目录。我试过这个，但它说.svn中的几个子目录的权限被拒绝。

即使您无法删除目录，您也可以将它们移走：

```
$ mv .svn /tmp/dustbin 
```

编辑：

您应该至少对您的主目录具有写访问权限：

```
$ mv ~/public_html /tmp/dustbin
$ mkdir ~/public_html 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-02-04T20:00:46.490

我刚刚在 Eclipse 3.5 中遇到了这个错误（“...已经是不同 URL 的工作副本”）。我试图从 Eclipse“SVN Repository Exploring”透视图（来自 tigris.org 的 Subclipse subversion 客户端适配器）检查项目的特定分支。我钻入了`[project] | branches | [branch]`我感兴趣的分支，然后右键单击我感兴趣的分支并选择了`Checkout`；这导致了错误。

对我来说，解决方法是转到“Java EE”透视图，右键单击我的项目，然后`Replace With | Branch/Tag...`从上下文菜单中选择。这样做，我成功地下载了我感兴趣的分支。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-07-15T13:03:37.083

我发现如果我只是转到 J2EE 透视图，右键单击项目，然后在尝试签出新分支之前选择删除，它可以解决这个问题。

# c# - WPF MenuItem 子项未显示

> ID：933403
> 
> 赞同：5
> 
> 时间：2009-06-01T02:53:34.277
> 
> 标签：c#, wpf, datatemplate, menuitem, children

我正在使用 ObjectDataProvider 和 DataTemplate 在菜单栏中填充 MenuItem。（WPF、C#/XAML）见下面的片段。

结果：出现顶部菜单项，当我单击它时，包装菜单项（带有绑定标题文本的菜单项）与指示子项存在的小箭头一起出现，但悬停或单击箭头不显示子项，它们无法访问。

预期结果：孩子们是可见的并且行为正常。

片段：

```
<ObjectDataProvider x:Key="Brokers" ObjectInstance="{x:Static brokers:BrokerManager.Instance}" MethodName="GetBrokers" IsAsynchronous="True" />
        <DataTemplate x:Key="BrokerMenuItem" DataType="IBroker">
            <MenuItem Header="{Binding Path=Name}">
                <MenuItem Header="Connect" />
                <MenuItem Header="Disconnect" />
            </MenuItem>
        </DataTemplate>

<MenuItem Header="Brokers" ItemsSource="{Binding Source={StaticResource Brokers}}" ItemTemplate="{DynamicResource BrokerMenuItem}"/> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T10:19:12.110

arsenmrkt：我有完全相同的问题，如果我使用 DataTemplate 填充 MenuItem，我似乎无法将子项添加到任何这些生成的项目中。我不明白你的答案，我应该如何使用 ContentPresenter 来解决这个问题？

编辑：实际上，我的问题并不完全相同，因为我试图将集合集合绑定到菜单。我想我已经通过使用 HierarchicalDataTemplate 让它工作了：

```
<Menu>
    <MenuItem Header="{Binding Name}" ItemsSource="{Binding MenuOptions}">
        <MenuItem.ItemTemplate>
            <HierarchicalDataTemplate ItemsSource="{Binding Categories}">
                <MenuItem Header="{Binding Name}"/>
                <HierarchicalDataTemplate.ItemTemplate>
                    <DataTemplate>
                        <MenuItem Header="{Binding Name}"/>
                    </DataTemplate>
                </HierarchicalDataTemplate.ItemTemplate>
            </HierarchicalDataTemplate>
        </MenuItem.ItemTemplate>
    </MenuItem>
</Menu> 
```

这对你 NicholasF 有帮助吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-21T16:45:52.760

经过一个多星期的搜索，我终于找到了如何使其正常工作。事实证明，DataTemplates 对于动态菜单来说不太好用。正确的方法是使用 MenuItem 的 ItemContainerStyle 属性。（或者是 ItemStyleContainer？）

只需创建一个样式来覆盖标题并将其设置为您需要的任何内容。我他们覆盖了 ItemsSource 以包括我的孩子。但是在这里要小心，因为孩子将继承样式并且每个孩子都有相同的孩子并生成递归菜单。您需要覆盖您孩子的 ItemsSource 并将其设置为空 x:Array 或类似的。

有几个博客描述了如何使用 ItemContainerStyle，查看它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T03:16:09.583

menuitem 控件的 ItemSource 属性用于为该项目提供子项，请尝试`<ContentPresenter />`与该数据模板一起使用。

# sql-server-2008 - 在 Windows 7 上运行 Sql Server 2008 Express Edition SP1 时遇到问题（防火墙问题？）

> ID：933406
> 
> 赞同：2
> 
> 时间：2009-06-01T02:56:15.177
> 
> 标签：sql-server-2008, windows-7

我已经在运行 Windows 7 Beta 1 的笔记本电脑上安装了 sql2008 express sp1。我遇到的问题是动态端口/防火墙/Windows 7 的组合。

```
A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: Named Pipes Provider, error: 40 - Could not open a connection to SQL Server) 
```

当我尝试使用管理工具连接到 sql 时，我第一次遇到这个问题，但是一旦我将 Sql Server 管理工具作为程序启用以通过防火墙，它就可以正常工作。现在的问题是当我启动我的网站时，它给了我这个错误。我也肯定 sql 浏览器正在运行，并且我已经在 sql express 服务中启用了 tcp/ip 和命名管道。

那么有人对如何解决这个问题有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T17:39:44.307

是的，我知道这两种情况。我已经设置为命名实例和默认实例，并调整了连接字符串，但都不起作用。

我还启用了命名管道并且不行。它与 windows 7 防火墙有关，但无法弄清楚，所以我只安装了 server 2008 标准版，瞧。

我怀疑它使用动态端口的事实是 Windows 7 的另一个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T03:15:07.323

您是否在 SSMS 和 Web 应用程序中使用相同的实例名称？

通常，人们会尝试仅根据机器名称进行连接，例如“MySQLServer”。SQL Server Express 默认安装一个*命名实例*，其默认名称为 SQLExpress。如果是这种情况，请尝试连接到“MySQLServer\SQLExpress”（当然，省略引号）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T03:40:23.570

进入 SQL Server 配置管理器 - 在程序 - Microsoft SQL Server 2008 - 配置工具下 - 并确保在 SQL Server 网络配置 - SQLExpress 协议下启用命名管道（默认情况下未启用）。

# excel - 多个数据透视图 SetSourceData 错误

> ID：933407
> 
> 赞同：0
> 
> 时间：2009-06-01T02:56:23.990
> 
> 标签：excel, vba

我在 Excel 2002 中的单独工作表上有多个数据透视图，每个图表都有自己的数据透视表。

当我尝试使用以下代码使用 VBA 生成这些图表时：

```
Set cht = Charts.Add(After:=Worksheets("Setup"))
With cht
    ' we use named ranges here
    .SetSourceData Source:=range(tblName)
    .Name = chtName 
```

……

其中 tblName 是刚刚创建了几行的命名范围，如果只有一个表格和图表生成，代码运行良好，但给我一个运行时错误 1004：“数据透视图报表的源数据无法更改......”如果我尝试一个接一个地生成数据透视表和图表集。

转到插入-> 名称-> 定义，创建的命名范围列表似乎是正确的。

为具有动态范围的数据透视图设置源数据的正确方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-01T04:12:44.347

我想你可能试图一次做太多的事情。

如果数据源要改变，我不会使用数据透视图。

使用数据透视表，在运行时创建图表（如您的示例）。构建数据透视表结果的图表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T05:05:53.650

这段代码假定每张工作表只有一个数据透视表，并且数据透视表从单元格 A1 开始：

```
Sheets(wsName).Select
Range("A1").Select
Set cht = Charts.Add(after:=Worksheets(Worksheets.Count))
With cht
    .SetSourceData Sheets(wsName).Range("A1")
    .Name = chtName 
```

...

将“Worksheets.Count”更改为特定的工作表名称似乎也会触发该错误。

# jboss - JBoss 4.2.3 EAR 和 Apache 2.2 虚拟主机与 jk_mod 服务空白白页

> ID：933408
> 
> 赞同：2
> 
> 时间：2009-06-01T02:56:24.287
> 
> 标签：jboss, coldfusion, virtualhost, ear, railo

我有一个 EAR 文件，我正在尝试与 JBoss 4.2.3 上的各种 WAR 部署一起部署

各个独立 WAR 部署都工作正常，只是 EAR 中包含的同一应用程序的副本，但 EAR 部署及其包含的 WAR 无法正常工作。

当我访问 jboss-web.xml 配置为与此 EAR 关联的虚拟主机时，我在浏览器中收到一个空白页面。与独立 WAR 部署关联的其他虚拟主机都可以正常工作，并且配置方式相同。

我在启动时没有收到任何错误，并且 JBoss 报告该站点已启动。我在 WAR 的 WEB-INF 中有一个 jboss-web.xml 文件，它将它与 server.xml 的定义联系起来。这适用于除 EAR 之外的所有其他类型的配置。我一直只得到一个白页，好像 JBoss 无法将 EAR 中的 WAR 连接到主机，或者 WAR 没有正确启动，或者我这里有一些配置错误。

当我启动 JBoss 时，它会在 webwar1.war/WEB-INF 中创建 flex 和 railo 目录，并在 railo.ear/lib/railo-server 中创建一个 railo-server 目录，但仍然只是为我提供一个空白页。

这是我站的地方...

我有一组共享的 Railo JAR 文件位于 /JBoss/server/default/deploy/jboss-web.deployer/railojars/lib （我告诉 jboss-service.xml 将其包含为类路径）

我的 site1.WAR 和 site2.WAR 文件位于 deploy 文件夹中，每个文件都包含一个 index.cfm 和一个 WEB-INF，其中 web.xml 和 jboss-web.xml 映射到虚拟主机。他们每个人都使用这个共享的 Railo JAR 实例并完美运行。我在 server.xml 中配置的带有外部文件夹的 docPath 和 appPath 的站点使用此共享 JAR 安装并完美运行。一切都很好。

如果我在 /JBoss/server/default/deploy 文件夹（带有 Railo lib 文件夹的完整 WAR）中放置 railo1.war、railo2.war 等，这些站点将使用 WAR 中包含的 Railo 实例。这也很棒。

所以，我唯一剩下的问题是：

在 /JBoss/server/default/deploy 下我创建了 railo.ear

railo.ear 内部是：META-INF，其中包含 application.xml，其中：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE application PUBLIC "-//Sun Microsystems, Inc.//DTD J2EE Application 1.2//EN" "http://java.sun.com/j2ee/dtds/application_1_2.dtd">
<application id="RailoInstance1">
 <display-name>Railo3</display-name>
 <description>Railo3</description>
 <module id="Module1">
 <web>
  <web-uri>webwar1.war</web-uri>
  <context-root>/webwar1</context-root>
 </web>
 </module>
</application> 
```

它还包含 webwar1.war，其中包含：index.cfm 和 WEB-INF

WEB-INF 有 web.xml、lib 和 jboss-web.xml

jboss-web.xml 看起来像这样：

```
<jboss-web>
    <context-root>/</context-root>
    <virtual-host>foo3.com</virtual-host>
</jboss-web> 
```

从 server.xml：

```
<Host name="foo3.com">
    <Alias>www.foo3.com</Alias>
</Host> 
```

foo3.com 正在使用 jk_mod 通过来自 Apache 的虚拟主机发送到 JBoss。映射到 WAR 部署的其他两个站点（foo1.com、foo2.com）的配置方式完全相同，并且工作正常。

WEB-INF 包含 lib 文件夹，因此我希望这个 webwar1.WAR 实例使用该 lib 文件夹中包含的 Railo JAR 文件。问题是当我启动 JBoss 时，我所有的其他站点都配置了它们的各种工作方式，但是 webwar1.war 中的站点没有出现。我只是在浏览器中看到一个白页。

因此，webwar1.war 文件中的 WEB-INF 中的 jboss-web.xml 没有连接到 server.xml 中定义的内容，或者这里出现了其他问题。我的其他独立 WAR 安装和共享 JAR 站点都可以看到它们各自的描述符，如 jboss-web.xml 中标记的那样，并且具有与此部署相同的内容。

所以，我只是想弄清楚我需要做什么才能让最后一个 EAR 配置正常工作。

我现在尝试的方式似乎每个 WAR 都会尝试使用它包含的 JAR 文件，但我希望为整个 EAR 拥有一组共享的 JAR 文件，然后耳朵中的每个 WAR 文件都使用这些 JARS。

我希望能够在这个 EAR 配置下拥有 webwar1.war、webwar2.war 等，因此我已将 lib 文件夹移出 webwar1.war/WEB-INF/lib 并移入 railo.ear/lib

我很想以这种方式进行设置，但我什至无法在 EAR 中加载一个带有自己的 JAR 文件的 WAR。我已经尝试了这种新配置，并在浏览器中获得了相同的空白页面。

有任何想法吗？

JBoss 没有给我任何错误。另一个奇怪的事情是，当我尝试访问配置不正确且未启动的站点时，我没有从 Apache 收到错误。如果我访问的站点没有在 JBoss 中设置为主机并且我通过 jk_mod 重定向到 JBoss，我会看到 JBoss 默认页面。当我访问 railo.ear 中与这个 webwar1.war 关联的虚拟主机时，我没有看到这个默认页面，所以 JBoss 必须知道它应该对域/虚拟主机做一些事情，否则它会告诉我默认的 JBoss页。相反，我看到的是一个空白的白色。

我还应该提到这适用于 JBoss 5.1。railo.ear 配置了完全相同的方式锁定到虚拟主机并正常工作。

帮助？谢谢！！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-10-13T14:31:37.260

听起来像是一项复杂的工作；railo-users 邮件列表上的人可能会提供帮助：[http ://groups.google.com/group/railo](http://groups.google.com/group/railo)

Railo还有一个专业的服务团队是王牌：[http ://www.getrailo.com/index.cfm/contact-us/](http://www.getrailo.com/index.cfm/contact-us/)

# c# - 传递给实例或直接引用的全局设置

> ID：933411
> 
> 赞同：1
> 
> 时间：2009-06-01T02:56:50.637
> 
> 标签：c#, unit-testing, class, oop

我有一个 Logging 类，它在控制台应用程序启动时被实例化并存储在一个静态变量中。

如果我想让一个类使用记录器，应该将它传递给构造函数中的类还是直接引用？

我正在尝试编写单元测试，无论哪种方式我都应该能够做到。只是意味着我必须在调用使用它的代码之前设置静态变量。

干杯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T03:14:48.383

听起来您正在寻找的是某种[IoC 容器](http://martinfowler.com/articles/injection.html)。您可以使用[EntLib 的 Unity](http://www.codeplex.com/unity)或其他类似的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T03:02:17.693

为了使您的类尽可能地可单元测试，应尽可能传入所有依赖项，包括记录器。这就是所谓的依赖注入 (DI)，是编写单元可测试代码的一种非常常见和标准的模式。日志记录几乎总是一个横切关注点，它只嵌入在方法体中，因为实际上没有任何像样的 AOP 框架可以正确地提取这些关注点并以声明方式应用它们。在编写/运行单元测试时必须处理日志只会增加测试的复杂性，可能会增加额外的配置问题，而当您真的希望让测试尽可能简单和有针对性时。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T03:04:01.650

使用[静态网关模式](http://blog.jpboodhoo.com/TheStaticGatewayPattern.aspx)怎么样？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T03:13:03.303

您可以创建它的一个实例并将该实例存储为同一类的成员并通过属性返回它。

例如 Logger.Default
这将返回对已创建实例的引用。

编辑：这方面的一个例子可能是 Console 类和它的 SetOut 方法。我的意思是您可以继续使用 Console.WriteLine.... 如果您想更改流，请使用 SetOut 方法。它将输出重定向到一个新的流。

希望有帮助。

# git - 如何在 Emacs 中自定义 git.el 的差异面？

> ID：933413
> 
> 赞同：2
> 
> 时间：2009-06-01T02:59:14.047
> 
> 标签：git, emacs, customization, emacs-faces

我的 Emacs 设置为在绿色文本上将文本显示为黑色背景。问题是当我使用 git.el 进行 diff 时，缓冲区顶部显示以 --- 或 +++ 开头的更改的部分显示为在绿色上使用绿色，所以我无法阅读我检查 git.el 但是似乎无法弄清楚是用哪张脸来控制这个的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T04:21:42.367

转到缓冲区，将点移动到神秘面孔并输入`C-u C-x =`（aka `C-u M-x what-cursor-position`）。Emacs 首先会告诉您很多关于该字符的信息，但随后还会说明：

```
There are text properties here:
  face                 diff-header
  fontified            t 
```

所以你要找的脸是`diff-header`。

# iphone - 将 viewWillAppear 推迟到 webViewDidFinishLoad

> ID：933414
> 
> 赞同：8
> 
> 时间：2009-06-01T03:01:13.637
> 
> 标签：iphone, uiwebview

我有一个`UIWebViews`在多个视图控制器中使用的应用程序。`UIWebViews`用于渲染本地生成的 html，不需要慢速网络访问。

`viewWillAppear`为了节省内存，我只根据视图控制器回调的提示按需加载这些。（并卸载屏幕外实例以响应`didReceiveMemoryWarning`消息。）

问题是用户可以看到正在呈现的 html，有时伴随着样式的闪烁和其他各种令人不快的伪影。我宁愿渲染在屏幕外完成，并在准备好时显示完全渲染的视图。

`viewWillAppear`在 UIWebView 完全呈现之前能够不返回将是非常整洁的。但是怎么做？

我通过向它发送消息来告诉它`UIWebView`要呈现的内容。`loadHTMLString:baseURL:`这是异步的，稍后（很快）webview 的委托会被回调`webViewDidFinishLoad`。

我尝试在内部运行一个 runloop `viewWillAppear`，运行`NSDefaultRunLoopMode`或`UITrackingRunLoopMode`. 这在模拟器中有效（它向日志抱怨

> [CATransaction synchronize] 在事务中调用

但确实有效）但在设备上它会死锁，`webViewDidFinishLoad`永远不会被调用。

（另外，似乎`UIWebView`加载属性不起作用。至少，在我调用之后`loadHTMLString:baseURL:`和在得到回调之前它不是真的。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T03:38:58.733

我认为这里有很多解决方案。一个快速的方法是加载 UIWebView，并将其隐藏属性设置为 YES。然后将您的 UIViewController 设置为 UIWebViews 委托并实现：

`- (void)webViewDidFinishLoad:(UIWebView *)webView`

您将属性设置回 NO。

需要注意的是，如果您有框架/嵌入的内容，webViewDidFinishLoad 将多次触发。因此，您必须对此进行跟踪。如果您正在加载本地内容，这应该不是问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T04:41:50.297

我最喜欢 monowerker 的解决方案，但另一种解决方案是一直保留已经渲染的 UIWebView（在比视图控制器更永久的对象中）。如果 monowerker 的解决方案看起来太具有破坏性，我只会这样做。

# excel - 数据透视图报表筛选器/页面字段的默认值

> ID：933415
> 
> 赞同：0
> 
> 时间：2009-06-01T03:01:41.827
> 
> 标签：excel, vba

我在 Excel 2002 中使用宏生成数据透视图，使用日期字段作为图表报告过滤器（将字段方向设置为 xlPageField）。我想将此数据透视字段的默认选定值设置为日期字段中的最新值。在 VBA 中这样做的正确语法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-01T04:30:52.270

动态创建图表后，您不想选择单元格吗？

就像是：

```
Dim value As Date
value = "1-apr-09"
Dim row As Integer
row = 0

Dim keeplooping As Boolean
keeplooping = True
While (keeplooping)
    row = row + 1
    If Range("B" & row).value = value Then
        keeplooping = False
        Range("B" & row).Select
        MsgBox ("found it")
    ElseIf Range("B" & row).value = "" Then
        keeplooping = False
        MsgBox ("Not found")
    End If
Wend 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T00:09:45.303

*chartObject* .PivotLayout.PivotTable.PivotFields(" *fieldName* ").CurrentPage = " *fieldValue* "

这是来自 Excel 2003 但我认为 2002 会类似

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-04T03:22:15.457

您不能遍历该页面字段的所有项目吗？这是一个数据透视表，但让它为图表工作应该没什么大不了的：

```
Sub Main()
    Dim pvt As PivotTable
    Dim fld As PivotField
    Dim itm As PivotItem
    Dim m As Variant

    Set pvt = Worksheets(1).PivotTables(1)
    Set fld = pvt.PageFields(1)

    m = fld.PivotItems(1)
    For Each itm In fld.PivotItems
        If itm.Value > m Then m = itm.Value
    Next itm

    fld.CurrentPage = m
End Sub 
```

# javascript - JQuery 在 Firefox 中有效，但在 IE 中无效

> ID：933420
> 
> 赞同：1
> 
> 时间：2009-06-01T03:05:04.053
> 
> 标签：javascript, jquery

任何人都知道为什么以下 JQuery 表达式在 Firefox 中有效，但在 IE 或 Chrome 中无效？

```
$('form :hidden:last').attr('name') 
```

警告语句显示在 IE 中表达式未定义。

更新：这是一些失败的 HTML。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
   <head>
      <script type="text/javascript" src="/js/jquery-1.3.2.min.js">
      </script>
      <script type="text/javascript">
         function addItem() {
           var v = $('form :hidden:last').attr('name');
           var n = /(.*)input/.exec(v);
           var newPrefix;
           if ( n[1].length == 0 ) {
             newPrefix = '1';
           } else {
             newPrefix = parseInt(n[1])+1;
           }
           var lastExercise = $('form tr:last select:first').attr('value');
           var oldElem = $('form tr:last');
           var newElem = oldElem.clone(true);
           var lastHidden = $('form :hidden:last');
           lastHidden.val(newPrefix);
           var pat = '=\"'+n[1]+'input';
           newElem.html(newElem.html().replace(new RegExp(pat, 'g'), '=\"'+newPrefix+'input'));
           newElem.appendTo('table');
           $('form tr:last select:first').attr('value', lastExercise);
           $('form :hidden:last').val('');
         }
         function removeItem() {
           var rows = $('form tr');
           if ( rows.length > 2 ) {
             rows.filter(":last").remove();
             $('form :hidden:last').val('');
           } else {
             alert('Cannot remove any more rows');
           }
         }
      </script>
   </head>
   <body>
         <form autocomplete="off" method="post" action="">
            <div>
               <input type="button" onclick="addItem(); return false;" value="Add Item" />
               <input type="button" onclick="removeItem(); return false;" value="Remove Last Item" />
            </div>
            <table>
               <tr>
                  <th>Name</th>
                  <th>Weight</th>
               </tr>
               <tr>
                  <td>
                     <input type="text" name="input1" id="input1" value="" />
                  </td>
                  <td>
                     <input type="text" name="input2" id="input2" value="" />
                     <select name="input3" class="unitsInput">
                        <option value="0">
                           Pounds
                        </option>
                        <option value="1">
                           Kilograms
                        </option>
                     </select>
                  </td>
                  <td>
                     <input type="hidden" name="input4" id="input4" value="" />
                  </td>
               </tr>
            </table>
            <div>
               <select name="input8">
                  <option value="0">0</option>
                  <option value="1">1</option>
                  <option value="2">2</option>
               </select>
            </div>
            <div>
               <input type="submit" name="submit" id="submit" value="Submit" />
            </div>
         </form>
   </body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T03:42:20.543

您的 JQuery 是否包含在 a 中`$(document).ready( ... )`？

例如：

```
$(document).ready(function() {
    $('form :hidden:last').attr('name')
}); 
```

这样做很重要，以确保在您的 JQuery 代码开始执行之前 DOM 已完全加载。否则，没有 DOM（文档）可供它查询。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T03:39:24.367

您是否在 DOM 完全加载并使用最新版本的 jQuery 后运行此查询？上面 Dan 的例子对我来说即使在 IE6 中也能正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T16:18:05.500

看来 IE 将最后的选项元素视为隐藏。将javascript中的所有“...：隐藏...”选择器更改为“...输入：隐藏...”似乎可以解决问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T03:22:19.087

我能够让它在 IE7 中运行良好。
你的 HTML 是什么样的？

这是我的样子：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>Untitled Document</title>
<script type="text/javascript" src="jquery-1.3.2.min.js"></script>
</head>

<body>
<form action="" method="get" name="testform">
<input name="bob" type="hidden" value="" />
<input name="steve" type="hidden" value="" />
<input name="william" type="hidden" value="" /></form>
<script type="text/javascript">
    $(document).ready(function(){
        alert($('form :hidden:last').attr('name'));
    });
</script>
</body>
</html> 
```

# subsonic - 亚音速：相同的列名不同的表

> ID：933422
> 
> 赞同：1
> 
> 时间：2009-06-01T03:05:34.877
> 
> 标签：subsonic

我有一个查询，我需要为两个不同表中的两个不同列执行“Where”子句，但 subsonic 为两者创建相同的参数化参数名称，这会导致问题。我怎样才能解决这个问题？

```
string _RawSql = new Select()
  .From(Tables.Table1)
  .InnerJoin(Tables.Table2)
  .InnerJoin(Table3.SidColumn, Table2.Table3SidColumn)
  .Where(Table1.SidColumn).IsEqualTo(2)
  .And(Table3.SidColumn).IsEqualTo(1)
  .BuildSqlStatement(); 
```

这正在创建的查询是

```
SELECT ....
FROM [dbo].[Table1]
INNER JOIN [dbo].[Table2] ON [dbo].[Table1].[Table2Sid] = [dbo].[Table2].[Sid]
INNER JOIN [dbo].[Table3] ON [dbo].[Table2].[Table3Sid] = [dbo].[Table3].[Sid]
WHERE [dbo].[Table1].[Sid] = @Sid
AND [dbo].[Table3].[Sid] = @Sid 
```

请注意，在最后两行中，它对 Table1 和 Table3 都使用了 @Sid。我该怎么做才能使用@Sid0 和@Sid1？

任何帮助，将不胜感激。谢谢

* * *

感谢您的回复，我真的很感激。我正在使用 2.1 我已经在使用 TableColumn。下面是c#亚音速代码...

```
.Where(Table1.SidColumn).IsEqualTo(2)  
.And(Table3.SidColumn).IsEqualTo(1) 
```

在 sql profiler 中查看时创建以下 sql

```
WHERE [dbo].[Table1].[Sid] = @Sid
AND [dbo].[Table3].[Sid] = @Sid 
```

您能否告诉我如何用您建议的方式替换这些行？我真的宁愿不使用文字“Table2.Sid = 2”

* * *

Ranmore，问题与变量或常量相同。

我什至尝试过

```
.Where("Table1.Sid").IsEqualTo(2)  
.And("Table3.Sid").IsEqualTo(1) 
```

这会将查询创建为

```
WHERE Table1.Sid = @Table1.Sid0
AND Table3.Sid = @Table3.Sid1 
```

在这种情况下，我终于得到了不同的参数化变量，但现在 SQL Server 抱怨，因为它不喜欢 . 在参数化的 var 名称中。

我不知道如何使用 2 个 where 子句为 2 个不同的表执行连接！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T06:00:44.213

你用的是什么版本？在 2.2 中，您可以使用 TableColumn 对象来解决这个问题（2.1 也可能相同。因此，您可以使用对象（Table2.SidColumn）而不是使用结构，就像您正在做的那样。

如果迫在眉睫 - 您可以使用字符串覆盖所有内容 - 因此在您的情况下，您可以在 Where() 方法中使用“Table1.Sid”和“Table2.Sid”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-08-10T11:50:28.680

我不确定我拥有什么版本的代码，但您的查询会为我生成编号参数。

如果您查看 ANSISqlGenerator.cs [https://github.com/subsonic/SubSonic-2.0/blob/master/SubSonic/SqlQuery/SqlGenerators/ANSISqlGenerator.cs的第 255 行](https://github.com/subsonic/SubSonic-2.0/blob/master/SubSonic/SqlQuery/SqlGenerators/ANSISqlGenerator.cs)

```
c.ParameterName = String.Concat(col.ParameterName, query.Constraints.IndexOf(c)); 
```

where 参数确实应该附加数字......也许拉最新版本？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T23:13:40.910

我无法确认这一点，但也许问题只发生在文字上？（为了简洁起见，不确定您的示例代码是否像那样）

```
int table1SidColumnValue = 2;
int table3SidColumnValue = 1;

.Where(Table1.SidColumn).IsEqualTo(table1SidColumnValue)
.And(Table3.SidColumn).IsEqualTo(table2SidColumnValue) 
```

我记得在使用具有文字值的多个 .In() 子句时看到了这个问题，但不确定这是否适用于您的问题。

# c# - c# 检测应用程序焦点丢失

> ID：933426
> 
> 赞同：0
> 
> 时间：2009-06-01T03:11:20.997
> 
> 标签：c#

我似乎有一个问题，我试图检测我的表单何时失去焦点，但它有一个基于 COM 互操作的用户控件来显示网络摄像头提要。这导致失去和获得焦点事件并不总是触发。有没有办法检测应用程序失去焦点，也许是通过 windows api 调用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-01T03:13:20.947

[这个 SO 线程](https://stackoverflow.com/questions/466354/how-can-i-tell-if-a-window-has-focus-win32-api)可能会对您有所帮助。

# iphone - Tweetie 喜欢滑动菜单

> ID：933428
> 
> 赞同：6
> 
> 时间：2009-06-01T03:13:13.380
> 
> 标签：iphone, cocoa-touch, uikit, uitableview

如何实现类似滑动菜单的 tweetie？

我已经完成了使用 customcell 开发 tableviewcontroller 的工作。customcell 实现了 touchesbegan 和 touchesMoved。它还通过选择器向父 tableviewcontroller 报告滑动手势。

现在我应该如何隐藏“滑动”单元格并用“滑动菜单视图”替换它，我应该如何从滑动视图上的按钮获取操作？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-01T05:18:32.107

每个表格视图单元格都有一个包含整个单元格区域的 contentView。将您的滑动菜单视图作为具有不透明背景的单个容器视图添加到内容视图，使其位于其他所有内容之上。将其定位为与左侧齐平 (x=0)，将宽度设置为 0，并将其设置为隐藏。该单个容器可以包含任何其他子视图（按钮等），并且您可以将单元格视图本身设置为按钮事件的目标（然后将其与单元格索引信息一起冒泡到父表视图）。

到时候显示它，将其设置为不隐藏，然后使用 UIView 动画使容器宽度从 0 变为全表宽度。将持续时间设置得非常低（即 0.2 秒），所以它很活泼。当您运行动画时，滑动菜单会显示在单元格内容视图中的所有其他内容上。要让它消失，只需反转它（在 UIView BeginAnimation 块中将宽度设置为 0）。您可能还想在最后设置一个动画完成处理程序并在那里做一些内务处理（将容器视图设置为隐藏、释放内存等）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-01-30T23:21:04.730

我做了一个类似菜单的推文，没有完整的代码，但我在博客上写过。希望能帮助到你！

[http://petersteinberger.com/2010/01/tweetie-like-swipe-menu-for-iphone-apps/](http://petersteinberger.com/2010/01/tweetie-like-swipe-menu-for-iphone-apps/)

# programming-languages - 设置 catch 块的顺序是否有一个好的一般策略？

> ID：933436
> 
> 赞同：1
> 
> 时间：2009-06-01T03:16:34.607
> 
> 标签：programming-languages

设置 catch 块的顺序是否有一个好的一般策略？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T03:19:28.470

我会先捕获最“具体”的异常，然后再进一步捕获更一般的异常：

```
try {
  ...
}
catch (DivideByZeroException ex) {
 ...
}
catch (InvalidArgumentException ex) {
  ...
}
catch (Exception ex) {
  ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T03:21:30.977

以下是 MSDN 的一些[设计指南](http://msdn.microsoft.com/en-us/library/ms229014(VS.80).aspx)。[查看 Enterprise Library异常处理块](http://msdn.microsoft.com/en-us/library/dd203116.aspx)也可能很好。那里有很多用于构建异常处理策略的好东西。

# c# - SqlTableProfileProvider 和自定义类型属性

> ID：933437
> 
> 赞同：0
> 
> 时间：2009-06-01T03:17:50.750
> 
> 标签：c#, asp.net, sql

我正在使用 SqlTableProfileProvider 来存储配置文件数据。它适用于标准字段......但我想存储这样存储的购物车数据：http: [//csharpdotnetfreak.blogspot.com/2009/05/aspnet-creating-shopping-cart-example.html](http://csharpdotnetfreak.blogspot.com/2009/05/aspnet-creating-shopping-cart-example.html)

我基本上遇到了这个论坛主题中描述的相同问题： [http](http://forums.asp.net/p/1065760/1627006.aspx) ://forums.asp.net/p/1065760/1627006.aspx 论坛 上没有解决方案......这里有人做过吗？

任何想法，将不胜感激。谢谢。

亚当

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-01T15:47:08.763

看起来“沙盒”SqlTableProfileProvider 不允许我在字段中存储其他数据类型......

所以我选择了这篇文章底部定义的路线。 [http://forums.asp.net/p/956974/1649620.aspx#1649620](http://forums.asp.net/p/956974/1649620.aspx#1649620)

我添加了一个默认的 sqlprofile 提供程序并将购物车数据存储在那里。

# iphone - UISegmentControl 和 UITableViewController 动画

> ID：933438
> 
> 赞同：0
> 
> 时间：2009-06-01T03:18:56.737
> 
> 标签：iphone, cocoa-touch, uikit

当用户在 UISegmentControl 中的段之间更改时，如何为我的“删除 tableviewitems”设置动画？

该行为应类似于电话应用程序中的“未接/所有”呼叫。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T10:47:09.217

deleteRowsAtIndexPaths:withRowAnimation: 和 insertRowsAtIndexPaths:withRowAnimation: 将为您提供动画。

如果您需要执行更复杂的操作（插入和删除），您可以启动一个块。类似于 UIView 动画块：

```
[tableView beginUpdates];

//add and delete

[tableView endUpdates]; 
```

请记住，您需要更新模型以反映表中的更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T04:23:26.873

UITableView 可以发送一条消息：[deleteRowsAtIndexPaths:withRowAnimation:](http://developer.apple.com/iphone/library/documentation/UIKit/Reference/UITableView_Class/Reference/Reference.html#//apple_ref/occ/instm/UITableView/deleteRowsAtIndexPaths:withRowAnimation:) withRowAnimation 参数确定将用于删除单元格的动画类型。

我不知道这些动画是否与错过的/所有功能完全匹配。如果他们不这样做，我猜你将不得不设置一个动画来折叠单元格的高度，然后再删除它们。

# django - Django - ORM 问题

> ID：933439
> 
> 赞同：2
> 
> 时间：2009-06-01T03:19:16.083
> 
> 标签：django, orm, date, group-by

只是想知道是否有可能获得仅使用 Django ORM 的 SQL 查询可以获得的结果：

```
SELECT * FROM (SELECT DATE_FORMAT(created, "%Y") as dte, sum(1) FROM some_table GROUP BY dte) as analytics; 
```

结果是：

```
+------+--------+
| dte  | sum(1) |
+------+--------+
| 2006 |     20 | 
| 2007 |   2230 | 
| 2008 |   4929 | 
| 2009 |   1177 | 
+------+--------+ 
```

简化模型如下所示：

```
# some/models.py

class Table(models.Model):
   created = models.DateTimeField(default=datetime.datetime.now) 
```

我已经尝试了各种混合使用 .extra(select={}) 和 .values() 的方法，还使用了此处描述的 .query.group_by 技巧[，](https://stackoverflow.com/questions/469200/any-python-olap-mdx-orm-engines)但希望能以全新的眼光看待这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T03:44:09.373

Django 1.1（发布时的主干）具有[聚合](http://docs.djangoproject.com/en/dev/topics/db/aggregation/)，这些允许您在查询中执行[counts](http://docs.djangoproject.com/en/dev/ref/models/querysets/#id9)、[mins](http://docs.djangoproject.com/en/dev/ref/models/querysets/#min)、[sums](http://docs.djangoproject.com/en/dev/ref/models/querysets/#sum)、[averages](http://docs.djangoproject.com/en/dev/ref/models/querysets/#avg)等。

您想要做的可能会使用多个查询集来完成。请记住，表中的每一行（甚至是生成的结果表）都应该是一个新对象。你并没有真正解释你在总结什么，所以我会考虑一下`dollars`：

```
book_years = Books.object.all().order_by('year').distinct()

# I use a list comprehension to filter out just the years
for year in [book_year.created.year for book_year in book_years]:
    sum_for_year = Book.objects.filter(created__year=year).aggregate(Sum(sales)) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T03:53:40.963

当您需要 Django 不允许您通过 ORM 表达的查询时，您始终可以[使用原始 SQL](http://docs.djangoproject.com/en/dev/topics/db/sql/#topics-db-sql)。

为了您的直接目的，我认为按表达式分组（并对组进行聚合计算）超出了 Django 当前的能力。

# javascript - 用 Python 控制嵌入到网站的 Flash 播放器？

> ID：933441
> 
> 赞同：0
> 
> 时间：2009-06-01T03:20:33.333
> 
> 标签：javascript, python, flash, controls, embedded-resource

我正在尝试编写一些简单的 python 脚本，这将允许我使用键绑定的 python 脚本来控制其中一个互联网收音机（我收听的）。

我现在可以连接并登录网站，我可以获取歌曲数据（即 - 传递给播放器的所有数据）。

我注意到，播放器是用 javascript 控制的，假设它的地址是[http://www.sitesite.com/player.swf](http://www.sitesite.com/player.swf)

如果播放器可以用javascript控制，那么我认为应该有一种方法，用python控制它。如果我是对的，有人可以举个例子吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T03:41:23.570

不，你不能用 Python 控制播放器，flash 和 javascript 可以相互通信，因为 Flash 播放器嵌入网页时是如何工作的。听起来你无论如何都在绕过 Flash 播放器，那么为什么你需要控制一个你不使用的播放器呢？

# linux - 更好的 Linux shell？

> ID：933445
> 
> 赞同：27
> 
> 时间：2009-06-01T03:22:31.660
> 
> 标签：linux, bash, shell, powershell

我使用 bash，并且已经使用了十多年 - 但偶尔我想知道 Linux shell 世界中是否有任何重大的新发展。

几年前，微软发布了 PowerShell，看起来很有趣。Linux shell 中是否有任何类似的创新？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-06-01T04:58:25.547

您是否意识到`bash 4`最近发布了许多新功能和语言添加？

*   Shell 选项`globstar`( `**/foo`) 进行递归搜索，`dirspell`修复路径名扩展期间的拼写错误。
*   关联数组，将字符串映射到字符串，而不仅仅是数字到字符串。
*   shell 选项允许通过`autocd`键入目录路径而不是必须放在`cd`前面来更改目录。
*   协同进程
*   `&>>`和`|&`重定向运算符，同时重定向`stdout`和`stderr`
*   现有内置函数的大量添加，以提高脚本编写的便利性。

查看：

*   “官方”变更日志：[http://tiswww.case.edu/php/chet/bash/CHANGES](http://tiswww.case.edu/php/chet/bash/CHANGES)
*   一些新功能的简短指南：[http://bash-hackers.org/wiki/doku.php/bash4](http://bash-hackers.org/wiki/doku.php/bash4)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-01T03:25:42.637

我会看一下zsh或fishshell。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-06-01T08:08:18.150

Bash（和其他几个 shell）最不被吹捧的特性之一是能够编写自己的可加载项，并让 shell 作为内置运行它们。

假设您编写了可加载的 'on' .. 并且您希望它像这样工作：

```
on node 123 run some command
on class nodes run some command
on all nodes run some command 
```

... ETC ..

您可以按照有关如何编写可加载文件的简单示例进行操作，然后通过 enable -f /path/to/loadable loadable_name 将其启用为内置的 bash

所以在我们的例子中，启用 -f /opt/bash/loadables/on on

...在你的 bashrc 中，你已经明白了。

因此，如果您想让 bash 本地解释您的漂亮新语言，您将编写一个名为“use”或“switch_to”的可加载文件，然后在设置了某个环境变量的情况下修改解析器以加载不同的语法/运行时。

IE：

```
#/bin/bash

switch_to my-way-cool-language

funkyfunc Zippy(int p) [[
   jive.wassup(p) ]] 
```

然而，大多数人*并不*想破解他们的外壳。我确实想指出，存在使用 Bash 并按照您想要的方式进行操作的工具，而无需过多地摆弄核心代码。

请参阅 /path-to-bash-source/examples/loadables，您可能可以让它飞到您工作的地方，因为您仍在使用 Bash。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-06-01T03:46:34.380

我认为“原始改进外壳”是**ksh93**。bash 出现在 ksh 源代码是专有的时候；如果 ksh 那时是开源的，那么可能认为没有必要拥有一个新的 shell（尽管你永远不知道 FSF）。ksh 值得研究，尤其是它能够通过 C 模块进行扩展，但它并没有明显战胜 bash。bash 的自动补全显然更胜一筹，这可能足以让 bash 整体获胜。无论如何，bash 和 ksh 已经为收敛做出了巨大的努力，因此差异很小。

另一个有趣的 shell 是**zsh**，它试图成为 ksh 的一切，同时也包括 csh。由于我从未看到 csh 的任何意义或用途，因此我不是提倡 zsh 的合适人选。我将指出一个不寻常的不兼容性：默认情况下，在 zsh 中，变量`$var` *总是*扩展为单个标记，即使它包含空格。这种行为与所有其他 sh 派生的 shell 不兼容，并且偶尔会带来不便，但实际上它比原来的更有意义，并且节省了大量的引用。

csh 是第一个具有作业控制功能的 shell，但在我看来，它（及其后继者）已被 bash 和 ksh 取代。写脚本从来都不是很有趣。

最后，还有许多为救援软盘（！）和其他 Spartan 环境而设计的小 shell，但听起来你对这些没有兴趣。

（在创新的问题上，我应该补充一点，我以前写成 shell 脚本的一半以上现在是[Lua](http://www.lua.org/)脚本。其他人可能对 Python 或 Ruby 说同样的话，或者在过去，Perl 或 Tcl。所以我认为真正的创新是从 shell 迁移到命令行的可编程交互。）

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-06-01T10:33:12.867

[您可以通过Pash](http://igorshare.wordpress.com/2008/04/06/pash-cross-platform-powershell-is-out-in-the-wild-announcement/)在 Linux 上运行 PowerShell 。它使用 Mono 的方式与 PowerShell 使用 .NET 的方式相同。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-06-01T04:00:24.363

IIRC，Powershell 是面向对象的，而大多数 unix shell 和实用程序都对文本进行操作。在这方面，[松鼠壳](http://squirrelsh.sourceforge.net/)可能会让您感兴趣。不过我从来没用过。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-06-01T05:27:59.037

如果您愿意失去`sh`兼容性，您可以考虑使用 Python 或 Tcl 等脚本语言作为您的 shell。 [`rlwrap`](http://utopia.knoware.nl/~hlub/uck/rlwrap/)如果解释器不提供行编辑、命令历史记录、补全等功能，它会非常方便。

关于 shell 的一种理念是，它们应该主要只用于将进程与文件连接起来（[这里有一个页面支持这种方法](http://www.pixelbeat.org/programming/shell_script_mistakes.html)）。也就是说，人们已经使用它们编写了一些非常复杂的软件。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-10-10T19:47:25.123

Shell 并没有比[Scheme Schell](http://www.scsh.net)更具创新性。Scheme 的所有功能与运行 Unix 命令的能力*和*嵌入式 awk 解释器（当然是用 Scheme 编写的）相结合。唯一的缺点是它需要一点点[补丁](http://article.gmane.org/gmane.lisp.scheme.scsh/7715)才能在 64 位 Linux 上构建。

它不完全是 Bourne-shell，但它是不同的。当然，您必须学习Scheme - 奖金！

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-10-10T19:36:08.727

如果你喜欢 ruby​​，你可以使用 rush（ruby-unix shell，不是 irb）

在此处查看演示文稿

[http://www.slideshare.net/adamwiggins/rush-the-ruby-shell-and-unix-integration-library](http://www.slideshare.net/adamwiggins/rush-the-ruby-shell-and-unix-integration-library)

或官网查看更多示例

[http://rush.heroku.com/](http://rush.heroku.com/)

# java - 如何将超类型列表转换为子类型列表？

> ID：933447
> 
> 赞同：292
> 
> 时间：2009-06-01T03:25:18.440
> 
> 标签：java, list, generics, collections, casting

例如，假设您有两个类：

```
public class TestA {}
public class TestB extends TestA{} 
```

我有一个返回 a 的方法，`List<TestA>`我想将该列表中的所有对象强制转换为，`TestB`以便最终得到 a `List<TestB>`。

* * *

## 回答 #1

> 赞同：650
> 
> 时间：2009-06-01T04:52:35.260

简单地投射到`List<TestB>`几乎可以工作；但它不起作用，因为您不能将一个参数的泛型类型转换为另一个参数。但是，您可以通过中间通配符类型进行转换，并且它是被允许的（因为您可以在通配符类型之间进行转换，只是带有未经检查的警告）：

```
List<TestB> variable = (List<TestB>)(List<?>) collectionOfListA; 
```

* * *

## 回答 #2

> 赞同：124
> 
> 时间：2009-06-01T09:04:22.950

泛型的转换是不可能的，但是如果您以另一种方式定义列表，则可以将其存储`TestB`在其中：

```
List<? extends TestA> myList = new ArrayList<TestA>(); 
```

当您使用列表中的对象时，您仍然需要进行类型检查。

* * *

## 回答 #3

> 赞同：46
> 
> 时间：2009-06-01T03:29:52.597

你真的不能*：

示例取自[本 Java 教程](http://java.sun.com/docs/books/tutorial/java/generics/subtyping.html)

假设有两种类型`A`和`B`这样的`B extends A`。那么下面的代码是正确的：

```
 B b = new B();
    A a = b; 
```

前面的代码是有效的，因为`B`它是`A`. 现在，`List<A>`和会发生什么`List<B>`？

事实证明，`List<B>`它不是的子类，`List<A>`因此我们**不能**写

```
 List<B> b = new ArrayList<>();
    List<A> a = b; // error, List<B> is not of type List<A> 
```

此外，我们甚至**不能**写

```
 List<B> b = new ArrayList<>();
    List<A> a = (List<A>)b; // error, List<B> is not of type List<A> 
```

*：为了使转换成为可能，我们需要一个共同的父级`List<A>`和`List<B>`:`List<?>`例如。以下**是**有效的：

```
 List<B> b = new ArrayList<>();
    List<?> t = (List<B>)b;
    List<A> a = (List<A>)t; 
```

但是，您会收到警告。`@SuppressWarnings("unchecked")`您可以通过添加到您的方法来抑制它。

* * *

## 回答 #4

> 赞同：45
> 
> 时间：2015-02-10T10:08:56.567

使用 Java 8，您实际上可以

```
List<TestB> variable = collectionOfListA
    .stream()
    .map(e -> (TestB) e)
    .collect(Collectors.toList()); 
```

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2009-06-01T03:30:02.363

我认为你的方向是错误的......如果该方法返回一个`TestA`对象列表，那么将它们强制转换为`TestB`.

基本上，您是在要求编译器让您对不支持它们`TestB`的类型执行操作。`TestA`

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2015-05-26T16:59:12.190

[由于这是一个被广泛引用的问题，并且当前的答案主要解释了它为什么不起作用（或提出我永远不想在生产代码中看到的 hacky、危险的解决方案），我认为添加另一个答案是合适的，显示陷阱和可能的解决方案。]

* * *

这通常不起作用的原因已经在其他答案中指出：转换是否实际有效取决于原始列表中包含的对象的类型。当列表中有对象的类型不是 type `TestB`，而是属于 的不同子类时`TestA`，则强制转换*无效*。

* * *

当然，演员表*可能*是有效的。您有时会获得有关编译器无法使用的类型的信息。在这些情况下，可以强制转换列表，但一般**不推荐**：

一个可以...

*   ...投射整个列表或
*   ...强制转换列表的所有元素

第一种方法（对应于当前接受的答案）的含义是微妙的。乍一看，它似乎工作正常。但是如果输入列表中有错误的类型，那么 a`ClassCastException`将被抛出，可能在代码中完全不同的位置，并且可能很难调试它并找出错误元素滑入列表的位置。最糟糕的问题是有人甚至可能在列表被转换*后*添加无效元素，使调试更加困难。

调试这些杂散的问题`ClassCastExceptions`可以通过该[`Collections#checkedCollection`](https://docs.oracle.com/javase/8/docs/api/java/util/Collections.html#checkedCollection-java.util.Collection-java.lang.Class-)系列方法得到缓解。

* * *

## 根据类型过滤列表

`List<Supertype>` 从 a 转换为a 的一种更类型安全的方法`List<Subtype>`是实际*过滤*列表，并创建一个仅包含具有特定类型的元素的新列表。这种方法的实现有一定的自由度（例如关于`null`条目的处理），但一种可能的实现可能如下所示：

```
/**
 * Filter the given list, and create a new list that only contains
 * the elements that are (subtypes) of the class c
 * 
 * @param listA The input list
 * @param c The class to filter for
 * @return The filtered list
 */
private static <T> List<T> filter(List<?> listA, Class<T> c)
{
    List<T> listB = new ArrayList<T>();
    for (Object a : listA)
    {
        if (c.isInstance(a))
        {
            listB.add(c.cast(a));
        }
    }
    return listB;
} 
```

此方法可用于过滤任意列表（不仅具有关于类型参数的给定子类型-超类型关系），如下例所示：

```
// A list of type "List<Number>" that actually 
// contains Integer, Double and Float values
List<Number> mixedNumbers = 
    new ArrayList<Number>(Arrays.asList(12, 3.4, 5.6f, 78));

// Filter the list, and create a list that contains
// only the Integer values:
List<Integer> integers = filter(mixedNumbers, Integer.class);

System.out.println(integers); // Prints [12, 78] 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-06-01T04:16:22.507

您不能像 Steve Kuo 提到的那样强制转换，但是您可以将内容`List<TestB>`转储到. 尝试以下操作：`List<TestA>``List<TestA>``List<TestB>`

```
List<TestA> result = new List<TestA>();
List<TestB> data = new List<TestB>();
result.addAll(data); 
```

我没有尝试过这段代码，所以可能有错误，但想法是它应该遍历数据对象，将元素（TestB 对象）添加到列表中。我希望这对你有用。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2013-03-02T12:14:00.397

最好的安全方法是在实现`AbstractList`中实现和强制转换项目。我创建了`ListUtil`助手类：

```
public class ListUtil
{
    public static <TCastTo, TCastFrom extends TCastTo> List<TCastTo> convert(final List<TCastFrom> list)
    {
        return new AbstractList<TCastTo>() {
            @Override
            public TCastTo get(int i)
            {
                return list.get(i);
            }

            @Override
            public int size()
            {
                return list.size();
            }
        };
    }

    public static <TCastTo, TCastFrom> List<TCastTo> cast(final List<TCastFrom> list)
    {
        return new AbstractList<TCastTo>() {
            @Override
            public TCastTo get(int i)
            {
                return (TCastTo)list.get(i);
            }

            @Override
            public int size()
            {
                return list.size();
            }
        };
    }
} 
```

您可以使用`cast`方法来盲目地投射列表中的对象和`convert`安全投射的方法。例子：

```
void test(List<TestA> listA, List<TestB> listB)
{
    List<TestB> castedB = ListUtil.cast(listA); // all items are blindly casted
    List<TestB> convertedB = ListUtil.<TestB, TestA>convert(listA); // wrong cause TestA does not extend TestB
    List<TestA> convertedA = ListUtil.<TestA, TestB>convert(listB); // OK all items are safely casted
} 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2011-09-19T20:06:07.873

我知道的唯一方法是复制：

```
List<TestB> list = new ArrayList<TestB> (
    Arrays.asList (
        testAList.toArray(new TestB[0])
    )
); 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-06-01T05:58:42.267

当你转换一个对象引用时，你只是在转换引用的类型，而不是对象的类型。强制转换不会改变对象的实际类型。

Java 没有用于转换 Object 类型的隐式规则。（与原语不同）

相反，您需要提供如何将一种类型转换为另一种类型并手动调用它。

```
public class TestA {}
public class TestB extends TestA{ 
    TestB(TestA testA) {
        // build a TestB from a TestA
    }
}

List<TestA> result = .... 
List<TestB> data = new List<TestB>();
for(TestA testA : result) {
   data.add(new TestB(testA));
} 
```

这比直接支持的语言更冗长，但它有效，您不需要经常这样做。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-06-01T03:31:54.963

如果您有该类的对象，`TestA`则不能将其强制转换为`TestB`. every`TestB`是 a `TestA`，但不是相反。

在以下代码中：

```
TestA a = new TestA();
TestB b = (TestB) a; 
```

第二行会抛出一个`ClassCastException`.

如果`TestA`对象本身是`TestB`. 例如：

```
TestA a = new TestB();
TestB b = (TestB) a; 
```

因此，您可能并不总是将列表`TestA`转换为`TestB`.

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2018-04-28T18:33:59.287

您可以使用[Eclipse Collections](http://www.eclipse.org/collections/)`selectInstances`中的方法。这将涉及创建一个新集合，但是不会像使用铸造的公认解决方案那样有效。

```
List<CharSequence> parent =
        Arrays.asList("1","2","3", new StringBuffer("4"));
List<String> strings =
        Lists.adapt(parent).selectInstancesOf(String.class);
Assert.assertEquals(Arrays.asList("1","2","3"), strings); 
```

我包含`StringBuffer`在示例中以显示`selectInstances`不仅向下转换类型，而且如果集合包含混合类型，也会过滤。

注意：我是 Eclipse Collections 的提交者。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-06-01T03:30:06.560

由于类型擦除，这是可能的。你会发现

```
List<TestA> x = new ArrayList<TestA>();
List<TestB> y = new ArrayList<TestB>();
x.getClass().equals(y.getClass()); // true 
```

在内部，两个列表都是 type `List<Object>`。出于这个原因，您不能将一个投射到另一个 - 没有什么可投射的。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2017-06-22T18:09:12.207

问题是，如果您的方法包含 TestB，则它不会返回 TestA 列表，那么如果输入正确怎么办？然后这个演员表：

```
class TestA{};
class TestB extends TestA{};
List<? extends TestA> listA;
List<TestB> listB = (List<TestB>) listA; 
```

效果与您希望的一样好（Eclipse 会警告您未经检查的演员阵容，这正是您正在做的事情，所以，嗯）。那么你能用它来解决你的问题吗？实际上你可以因为这个：

```
List<TestA> badlist = null; // Actually contains TestBs, as specified
List<? extends TestA> talist = badlist;  // Umm, works
List<TextB> tblist = (List<TestB>)talist; // TADA! 
```

正是你要求的，对吧？或者更确切地说：

```
List<TestB> tblist = (List<TestB>)(List<? extends TestA>) badlist; 
```

似乎对我来说编译得很好。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2018-03-27T07:57:43.917

```
class MyClass {
  String field;

  MyClass(String field) {
    this.field = field;
  }
}

@Test
public void testTypeCast() {
  List<Object> objectList = Arrays.asList(new MyClass("1"), new MyClass("2"));

  Class<MyClass> clazz = MyClass.class;
  List<MyClass> myClassList = objectList.stream()
      .map(clazz::cast)
      .collect(Collectors.toList());

  assertEquals(objectList.size(), myClassList.size());
  assertEquals(objectList, myClassList);
} 
```

此测试显示如何转换`List<Object>`为`List<MyClass>`. 但是您需要注意`objectList`必须包含与`MyClass`. 而这个例子在使用时可以考虑`List<T>`。为此`Class<T> clazz`，在构造函数中获取字段并使用它而不是`MyClass.class`.

**更新**

实际上，您不能在强类型 Java AFAIK 中从超类型转换为子类型。但是您可以引入超类型实现的接口。

```
interface ITest {
}

class TestA implements ITest {
}

class TestB extends TestA {
}

public class Main {

  public static void main(String[] args) {
    List<ITest> testAList = Arrays.asList(new TestA(), new TestA());

    Class<ITest> clazz = ITest.class;
    List<ITest> testBList = testAList.stream()
        .map(clazz::cast)
        .collect(Collectors.toList());

    System.out.println(testBList.size());
    System.out.println(testAList);
  }
} 
```

或者您可以从子类型转换为超类型。像这样：

```
class TestA {
}

class TestB extends TestA {
}

public class Main {

  public static void main(String[] args) {
    var a = new TestA();
    var b = new TestB();
    System.out.println(((TestA) b));

    List<TestB> testBList = Arrays.asList(new TestB(), new TestB());

    Class<TestA> clazz = TestA.class;
    List<TestA> testAList = testBList.stream()
        .map(clazz::cast)
        .collect(Collectors.toList());

    System.out.println(testAList.size());
    System.out.println(testAList);
  }
} 
```

仅供参考，我最初的回答指出了将它与`generics`. 事实上，我是从我的 Hibernate DAO 代码中获取的。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2020-03-18T09:03:43.020

很奇怪，一些工具箱仍然没有提供手动转换列表，例如：

```
@SuppressWarnings({ "unchecked", "rawtypes" })
public static <T extends E, E> List<T> cast(List<E> list) {
    return (List) list;
} 
```

当然，这不会一一检查项目，但这正是我们在这里要避免的，如果我们很清楚我们的实现只提供子类型。

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2017-07-14T16:06:58.397

这应该可行

```
List<TestA> testAList = new ArrayList<>();
List<TestB> testBList = new ArrayList<>()
testAList.addAll(new ArrayList<>(testBList)); 
```

# nsis - 检查 NSIS 安装程序的单个实例

> ID：933450
> 
> 赞同：2
> 
> 时间：2009-06-01T03:26:01.577
> 
> 标签：nsis, single-instance

我有一个用 NSIS 编写的更新程序。我只是想确保当它被调用两次或更多次时，它不会创建更新程序的另一个实例，否则会有两个或更多更新程序在运行。

如果您的更新程序已经在运行，您如何限制更新程序创建另一个实例？因此，无论进行了多少次调用，都只有一个更新程序正在运行。

谢谢...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-01T04:20:03.880

您应该使用互斥锁，请参阅[http://nsis.sourceforge.net/Allow_only_one_installer_instance](http://nsis.sourceforge.net/Allow_only_one_installer_instance)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T03:59:25.923

我只是想办法。我使用了 KillProc 插件。它返回找到的进程数。因此，如果找到另一个实例，它将退出程序。这确保只有一个实例在运行。

# linq-to-sql - 显示由 LinqtoSQL 生成的 SQL

> ID：933456
> 
> 赞同：1
> 
> 时间：2009-06-01T03:30:27.543
> 
> 标签：linq-to-sql

如何查看由 LINQ2SQL 插入生成的 SQL？假设我有

```
 db.Elephants.InsertOnSubmit(elephantInstance);
        db.SubmitChanges(); 
```

反正有看SQL吗？我已经安装了 Scott Gu 提到的 LINQtoSQL 可视化工具（[http://weblogs.asp.net/scottgu/archive/2007/07/31/linq-to-sql-debug-visualizer.aspx](http://weblogs.asp.net/scottgu/archive/2007/07/31/linq-to-sql-debug-visualizer.aspx)），它似乎确实适用于完整的 LINQ 查询，但不适用于这样的插入。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T03:34:03.323

SQL Server Profiler 将显示生成的查询。它还将向您展示 SQL Server 用于解决这些查询的执行计划，并为您提供提高性能的方法。

更多信息请访问[http://msdn.microsoft.com/en-us/library/ms187929.aspx](http://msdn.microsoft.com/en-us/library/ms187929.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T03:57:16.127

您可以使用 DataContext.Log 来记录 SQL。您可以将任何 TextWriter 设置为 DataContext.Log 属性。如果您想将输出记录到调试器或控制台，请尝试此[http://www.u2u.info/Blogs/Kris/Lists/Posts/Post.aspx?ID=11](http://www.u2u.info/Blogs/Kris/Lists/Posts/Post.aspx?ID=11) - 一切顺利。

# c++ - Mac OS X 中的唯一硬件 ID

> ID：933460
> 
> 赞同：32
> 
> 时间：2009-06-01T03:32:36.103
> 
> 标签：c++, macos, unique, hardware-id

Mac OS X 开发对我来说是一个相当新的事物，我正在移植一些软件。对于软件许可和注册，我需要能够生成某种硬件 ID。它不必太花哨。以太网 MAC 地址、硬盘驱动器序列号、CPU 序列号等。

我已经在 Windows 上覆盖了它，但在 Mac 上我一无所知。任何关于我需要做什么的想法，或者我可以去哪里获取这方面的信息都会很棒！

编辑：

对于其他对此感兴趣的人，这是我最终与 Qt 的 QProcess 类一起使用的代码：

```
QProcess proc;

QStringList args;
args << "-c" << "ioreg -rd1 -c IOPlatformExpertDevice |  awk '/IOPlatformUUID/ { print $3; }'";
proc.start( "/bin/bash", args );
proc.waitForFinished();

QString uID = proc.readAll(); 
```

注意：我使用的是 C++。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2010-05-02T18:56:51.973

对于 C/C++：

```
void get_platform_uuid(char * buf, int bufSize) {
    io_registry_entry_t ioRegistryRoot = IORegistryEntryFromPath(kIOMasterPortDefault, "IOService:/");
    CFStringRef uuidCf = (CFStringRef) IORegistryEntryCreateCFProperty(ioRegistryRoot, CFSTR(kIOPlatformUUIDKey), kCFAllocatorDefault, 0);
    IOObjectRelease(ioRegistryRoot);
    CFStringGetCString(uuidCf, buf, bufSize, kCFStringEncodingMacRoman);
    CFRelease(uuidCf);    
} 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-06-03T10:44:50.810

试试这个终端命令：

```
ioreg -rd1 -c IOPlatformExpertDevice | awk '/IOPlatformUUID/ { split($0, line, "\""); printf("%s\n", line[4]); }' 
```

从[这里](http://www.jaharmi.com/2008/03/15/get_uuid_for_mac_with_ioreg)

这是包裹在 Cocoa 中的命令（可能会更简洁一些）：

```
NSArray * args = [NSArray arrayWithObjects:@"-rd1", @"-c", @"IOPlatformExpertDevice", @"|", @"grep", @"model", nil];
NSTask * task = [NSTask new];
[task setLaunchPath:@"/usr/sbin/ioreg"];
[task setArguments:args];

NSPipe * pipe = [NSPipe new];
[task setStandardOutput:pipe];
[task launch];

NSArray * args2 = [NSArray arrayWithObjects:@"/IOPlatformUUID/ { split($0, line, \"\\\"\"); printf(\"%s\\n\", line[4]); }", nil];
NSTask * task2 = [NSTask new];
[task2 setLaunchPath:@"/usr/bin/awk"];
[task2 setArguments:args2];

NSPipe * pipe2 = [NSPipe new];
[task2 setStandardInput:pipe];
[task2 setStandardOutput:pipe2];
NSFileHandle * fileHandle2 = [pipe2 fileHandleForReading];
[task2 launch];

NSData * data = [fileHandle2 readDataToEndOfFile];
NSString * uuid = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding]; 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2014-04-02T02:47:57.187

为什么不试试`gethostuuid()`？这是 Mac OS X 系统调用手册中的文档：

姓名：

```
 gethostuuid -- return a unique identifier for the current machine 
```

概要：

```
 #include <unistd.h>

 int gethostuuid(uuid_t id, const struct timespec *wait); 
```

描述：

> gethostuuid() 函数返回一个由 id 指定的 16 字节 uuid_t，它唯一标识当前机器。请注意，gethostuuid() 用于生成 UUID 的硬件标识符本身可以被修改。
> 
> wait 参数是一个指向 struct timespec 的指针，它指定等待结果的最长时间。将 tv_sec 和 tv_nsec 字段设置为零意味着无限期地等待直到它完成。

返回值：

> gethostuuid() 函数在成功时返回零，在错误时返回 -1。

错误

> gethostuuid() 函数在以下情况下失败：

```
 [EFAULT]           wait points to memory that is not a valid part of the
                    process address space.

 [EWOULDBLOCK]      The wait timeout expired before the UUID could be
                    obtained. 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-10-17T17:54:58.353

如果您告诉我们您使用的语言，这将更容易回答。无需任何 shell 命令即可通过 SystemConfiguration 框架获取这些信息，如果您想亲自动手，也可以通过 IOKit 获取这些信息。

```
- (NSString*) getMACAddress: (BOOL)stripColons {
    NSMutableString         *macAddress         = nil;
    NSArray                 *allInterfaces      = (NSArray*)SCNetworkInterfaceCopyAll();
    NSEnumerator            *interfaceWalker    = [allInterfaces objectEnumerator];
    SCNetworkInterfaceRef   curInterface        = nil;

    while ( curInterface = (SCNetworkInterfaceRef)[interfaceWalker nextObject] ) {
        if ( [(NSString*)SCNetworkInterfaceGetBSDName(curInterface) isEqualToString:@"en0"] ) {
            macAddress = [[(NSString*)SCNetworkInterfaceGetHardwareAddressString(curInterface) mutableCopy] autorelease];

            if ( stripColons == YES ) {
                [macAddress replaceOccurrencesOfString: @":" withString: @"" options: NSLiteralSearch range: NSMakeRange(0, [macAddress length])];
            }

            break;
        }
    }

    return [[macAddress copy] autorelease];
} 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2013-12-20T14:52:06.810

```
/*
g++ mac_uuid.cpp -framework CoreFoundation -lIOKit
*/

#include <iostream>
#include <IOKit/IOKitLib.h>

using namespace std;

void get_platform_uuid(char * buf, int bufSize)
{
   io_registry_entry_t ioRegistryRoot = IORegistryEntryFromPath(kIOMasterPortDefault, "IOService:/");
   CFStringRef uuidCf = (CFStringRef) IORegistryEntryCreateCFProperty(ioRegistryRoot, CFSTR(kIOPlatformUUIDKey), kCFAllocatorDefault, 0);
   IOObjectRelease(ioRegistryRoot);
   CFStringGetCString(uuidCf, buf, bufSize, kCFStringEncodingMacRoman);
   CFRelease(uuidCf);
}

int main()
{
   char buf[512] = "";
   get_platform_uuid(buf, sizeof(buf));
   cout << buf << endl;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-01T03:43:55.363

跑步：

```
system_profiler | grep 'Serial Number (system)' 
```

在终端中返回它可能是唯一的 id。这适用于我的 10.5 机器，我不确定在其他版本的 OS X 中正确的字符串是什么。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-03T10:50:22.170

正如上面的一些人所暗示的那样，您可以使用终端命令来获取硬件 ID。

我假设您想在代码中执行此操作，因此我将查看 Cocoa 中的 NSTask 类。它基本上允许您在应用程序中运行终端命令。

此代码是如何在 Cocoa 中使用 NSTask 的示例。它设置环境以执行“killall”命令。它通过了争论“Finder”。

这相当于在命令行上运行“killall Finder”，这显然会杀死 Finder。

```
NSTask *aTask = [[NSTask alloc] init];
NSMutableArray *args = [NSMutableArray array];

[aTask setLaunchPath: @"/usr/bin/killall"];
[args addObject:[@"/Applications/Finder" lastPathComponent]];
[aTask setArguments:args];
[aTask launch];

[aTask release]; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-03T10:30:52.040

System Profiler（在应用程序 - 实用程序中）包含大部分此类信息。它有您的序列号和您的 mac 地址（与 Mac 无关。所有计算机都有一个 mac 地址，这对于每个网卡来说几乎都是唯一的）。

# php - 我如何编写我的脚本来输出数据，我放置这样的东西：{name}

> ID：933463
> 
> 赞同：0
> 
> 时间：2009-06-01T03:34:29.810
> 
> 标签：php, templates

我看过很多脚本，您会在其中看到类似的内容

```
<meta keyword="{keywords}" ...> 
```

或者

```
<input type="text" name="name" value="{name}"> 
```

这叫什么，我自己怎么做。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-01T03:36:48.937

它被称为模板。

您需要一个模板引擎，或者您可以自己编写一个。很久以前有一个流行的模板引擎叫做 Smarty。今天，模板引擎是大多数框架的一部分。

下面是几个 PHP 模板引擎的列表： [http ://www.webresourcesdepot.com/19-promising-php-template-engines/](http://www.webresourcesdepot.com/19-promising-php-template-engines/)

考虑到您有这样的问题，您自己的模板引擎更有可能出现错误，因此我建议选择免费提供的模板引擎之一。

还有一件事。PHP 本身是一种模板引擎，因此您不一定要添加另一层模板。使用 PHP：

```
<input type="text" name="name" value="<?=$VALUES['name']?>"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T03:56:52.400

我可以推荐...

```
<input type="text" name="name" value="<?= e($name) ?>"> 
```

其中 e 是转义函数

我发现不需要模板引擎

更多示例...

前...

```
<ul>
<?php foreach( $items as $item ): ?>
    <li><?= e($item) ?><li>
<?php endforeach; ?>
</ul> 
```

如果....

```
<input type="checkbox"<?php if( $checkbox ): ?> selected="selected"<?php endif; ?>> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T03:37:07.610

有一些模板引擎支持这种类型的变量语法，例如 Blitz 模板 ( [http://alexeyrybak.com/blitz/blitz_en.html](http://alexeyrybak.com/blitz/blitz_en.html) )。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T03:37:55.613

我不确定你的意思，但让我大胆猜测一下：

```
$foo = "Please replace {this} here!";
$bar = str_replace('{this}', 'that', $foo); 
```

当然，有很多模板系统可以做到这一点，只是更智能。所以你可能想调查一下。

# sql - 使用Linq根据另一个数据库中的数据从一个数据库中获取数据

> ID：933466
> 
> 赞同：0
> 
> 时间：2009-06-01T03:36:56.533
> 
> 标签：sql, linq

我有一个名为 MasterDatabase 的数据库，它的 MainIndex 表包含 Id、Database (nvarchar)、Table(nvarchar) 列

我还有另外 2 个带有表和数据的数据库。

有没有办法用 MasterDatabase.MainIndex 的结果替换 FROM 语句？

这可以用 LINQ 完成吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-11T14:07:02.873

另一种选择是将要从第二个数据库中选择的表添加为主数据库中的视图。然后，您将能够将视图映射为实体。

**:)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T05:15:08.023

或者，您可以通过在 .dbml 中为表添加前缀来访问另一个数据库中的表，`[DatabaseName].[SchemaName].[TableName]`或者如果它位于不同的服务器上`[ServerName]`，也包括...然后您就不必使用动态 linq

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T03:38:56.270

您需要 Linq 动态查询库来完成此操作。它允许您在 Linq 查询中进行字符串替换。

更多信息请访问[http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx](http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx)

# php - 如何在 Symfony 中使用 Propel ORM 编写带有 group by 子句的 SQL 计数？

> ID：933473
> 
> 赞同：3
> 
> 时间：2009-06-01T03:39:49.967
> 
> 标签：php, sql, symfony1, propel

如何使用 Propel ORM 编写以下 SQL 查询？

```
SELECT species, COUNT(*) FROM Bird GROUP BY species; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-05-17T08:14:08.327

这不是一个会产生有意义的水合`Bird`对象的查询，因为您只选择了`species`这些物种的列和计数。因此[，Colin 建议的“原始”SQL 查询](https://stackoverflow.com/questions/933473/how-can-i-write-a-sql-count-with-group-by-clause-using-propel-orm-in-symfony/935456#935456)可能是最好的方法 - 但最后不要水合，只需从结果中获取数据`PDOStatement`。

如果`species`是对`Species`表格的引用，您可以从那里开始工作：水合物`Species`对象，每个物种的鸟类数量都有一个额外的列。如果您使用 Symfony 1.2 及以下版本，我强烈推荐[DbFinder 插件](http://www.symfony-project.org/plugins/DbFinderPlugin)，因为它极大地简化了使用`Criteria`，并且具有选择单个补充列的方法：

```
$speciesQuery = DbFinder::from('Species')->
  join('Bird')->
  groupBy('Bird.Id')->
  withColumn('COUNT(Bird.Id)', 'NbBirds');

foreach ($speciesQuery->find() as $species) {
  echo $species->getName() . ": " . $species->getNbBirds() . " birds\n";
} 
```

如果您使用 Symfony 1.3 或 1.4，您应该将捆绑的 Propel 1.4 升级到 Propel 1.5，其中 DbFinder 的创建者 François Zaniotto 移植了它的大部分功能并添加了更多功能，因此上述代码可以在 Propel 1.5 中运行而无需额外的插件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-04T13:02:53.090

> ```
> $c = new Criteria();
> $c->addAsColumn('cnt', "count(*)");
> self::addSelectColumns($c);
> $c->addGroupByColumn(BirdPeer::SPECIES); 
> ```

但是，如果您需要将 count(*) 获取到填充的对象，则您需要进行自定义补水。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T15:57:43.067

我发现很难找到关于 Propel Criteria 的单个文档（上面似乎没有 API 文档），所以我通常使用 symfony 书第 8 章中的列表；但我不知道这是否全面。

但是你可以做的是直接将 SQL 提供给 Propel。以下是从[http://propel.phpdb.org/docs/user_guide/chapters/FindingObjects.html](http://propel.phpdb.org/docs/user_guide/chapters/FindingObjects.html)中的示例修改的：

```
 $con = Propel::getConnection(DATABASE_NAME);

    // if not using a driver that supports sub-selects
    // you must do a cross join (left join w/ NULL)
    $sql = "SELECT species, COUNT(*) FROM Bird GROUP BY species";

    $stmt = $con->createStatement();
    $rs = $stmt->executeQuery($sql, ResultSet::FETCHMODE_NUM);

    return parent::populateObjects($rs); 
```

我认为我自己从来没有这样使用过它，尽管我可能有。

# javascript - 如何检查数组元素是否只包含新行？

> ID：933476
> 
> 赞同：1
> 
> 时间：2009-06-01T03:41:13.040
> 
> 标签：javascript, arrays, string

由段落和一些空行组成的纯文本文件通过 Ajax 加载到数组中。数组由换行符拆分为元素，例如：

```
var infoArray = new Array();
infoArray = response.split("\n"); 
```

然后数组通过一个 for 循环，对各种元素中的关键字进行各种测试，这表明下一个 n 元素以特定方式处理。大多数元素是输出的，例如

```
    strMsg += '<li>' + infoArray[i] + '</li>';

```

问题是文本文件中的空白行也保存到数组元素中。然后一个空白列表项得到输出，并且明显错误。

需要一个测试条件来检查数组元素是否为空或包含换行符，我不确定哪个适用。另外服务器有问题，有时需要一分钟才能加载新信息，所以我有时不确定我是否正在刷新我最近的代码。

我尝试过的一些事情：

```
    if (!(infoArray[i].substring(0,0) == '')) { /* 处理输出 */ }
    if (!(infoArray[i].substring(0,1) == '\n')) { /* 处理输出 */ }
    if (!(infoArray[i].substring(0,0) == '\n')) { /* 处理输出 */ }
    if (!(infoArray[i].substring(0,1) == /\n/)) { /* 进程输出 */ }
    if (!(infoArray[i].substring(0,1) == /\n/)) { /* 进程输出 */ }
    if (!(infoArray[i].substring(0,1) == /\n|\s*\n/)) { /* 处理输出 */ }
    if (!(infoArray[i].IsEmpty())) { /* 处理输出 */ }

    var tempString = infoArray[i].toString();
    if (!(tempString.IsEmpty())) { /* 处理输出 */ }
    if (tempString.length != 0) { /* 进程输出 */ }

```

想法？

编辑：哦，是的，我还尝试在检查“\ n”之前进行“编码”和“解码”，只是为了把它拿出来。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T03:48:29.107

尝试使用 RegEx 修剪字符串。我认为这个很受欢迎（取自[第一个 google hit](http://developer.loftdigital.com/blog/trim-a-string-in-javascript)）：

```
if (!(infoArray[i].replace(/^\s+|\s+$/g, '') == '')) 
```

WebKit 发布了另一组您可以使用[的修剪功能。](http://www.webtoolkit.info/javascript-trim.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T03:57:11.137

我建议只修剪数组元素。例如，您可以使用 jQuery：

```
if (infoArray[i] = $.trim(infoArray[i])) {
    strMsg += '<li>' + infoArray[i] + '</li>';
} 
```

# ios - 更改表格视图中的单元格高度Objective C

> ID：933479
> 
> 赞同：4
> 
> 时间：2009-06-01T03:42:15.303
> 
> 标签：ios, iphone

我希望我的单元格的高度根据其中显示的文本而改变。文本会有所不同，我基本上希望单元格改变大小。这是我到目前为止所拥有的：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:@"DefaultCell1"];
    CGRect cellRectangle;
    if (cell == nil) {

    cellRectangle = CGRectMake(0.0, 0.0, 300, 110);
    cell = [[[UITableViewCell alloc] initWithFrame:cellRectangle reuseIdentifier:@"DefaultCell1"] autorelease];
    }

    UILabel *label;
    cellRectangle = CGRectMake(10, (40 - 20) / 2.0, 280, 110);

    //Initialize the label with the rectangle.
    label = [[UILabel alloc] initWithFrame:cellRectangle];
    label.lineBreakMode = UILineBreakModeWordWrap;
    label.numberOfLines = 20;

    label.font = [UIFont fontWithName:@"Helvetica" size:11.0];
    label.text = [[self.person.statusMessages objectAtIndex:indexPath.row]   valueForKey:@"text"];
    CGFloat height = [label.text sizeWithFont:label.font].height;

    //So right here is where I think I need to do something with height and 
    //see it to something tied to he cell

    [cell.contentView addSubview:label];

    [label release];

    return cell;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-01T05:15:29.007

您不应该在 cellForRowAtIndexPath 方法中设置高度。还有另一个 UITableViewDatasource 方法叫做 tableView:heightForRowAtIndexPath: 你应该实现它来返回单元格的高度。不过要小心使用它；您不能在此方法中获取该索引路径处的单元格；如果你这样做，你将构建一个无限递归循环。

编辑：要清楚；您需要仅根据单元格的内容而不是单元格本身来计算单元格的高度。

此外，在您创建单元格的代码中，您可以将 CGRectZero 传递给 frame 参数；如果您这样做，表格视图将计算单元格的框架本身（如果我没记错的话，在 OS 3.0 中也不推荐显式传递框架）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-05-11T23:56:25.587

如果所有行都具有相同的高度，我认为在你的情况下是这样，你可以在你的 tableview 控制器中 setRowHeight 。

```
- (id)initWithStyle:(UITableViewStyle)style {
    // Override initWithStyle: if you create the controller programmatically and want to perform customization that is not appropriate for viewDidLoad.
    self = [super initWithStyle:style];
    if (self) {
        // Custom initialization.
        NSLog(@"%s", __FUNCTION__);
        [self.tableView setRowHeight:110];
    }
    return self;
} 
```

行宽可以通过表格的superview宽度来控制

# java - 在 BouncyCastle 中使用“强”JRE 策略文件

> ID：933483
> 
> 赞同：4
> 
> 时间：2009-06-01T03:43:18.343
> 
> 标签：java, cryptography, aes, bouncycastle

密码学新手在这里...我正在尝试使用 BouncyCastle 和下面的代码进行 128 位加密。

```
import java.io.BufferedOutputStream;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.InputStream;
import java.io.OutputStream;
import java.security.KeyStore;
import java.security.Security;
import java.security.cert.X509Certificate;

import org.apache.commons.io.IOUtils;
import org.bouncycastle.cms.CMSEnvelopedDataGenerator;
import org.bouncycastle.cms.CMSEnvelopedDataStreamGenerator;
import org.bouncycastle.jce.provider.BouncyCastleProvider;

public class Test {
        public static void main(String[] args) throws Throwable {
                Security.addProvider(new BouncyCastleProvider());

                KeyStore keyStore = KeyStore.getInstance("PKCS12");

                FileInputStream keyStoreFile = new FileInputStream("test.p12");

                try {
                        keyStore.load(keyStoreFile, "test12".toCharArray());
                } finally {
                        keyStoreFile.close();
                }

                X509Certificate certificate = (X509Certificate) keyStore
                                .getCertificate(keyStore.aliases().nextElement());

                OutputStream output = new BufferedOutputStream(new FileOutputStream(
                                "test.out"));

                try {
                        InputStream input = new FileInputStream("test.in");

                        try {
                                CMSEnvelopedDataStreamGenerator generator = new CMSEnvelopedDataStreamGenerator();

                                generator.addKeyTransRecipient(certificate);

                                OutputStream encryptedOutput = generator.open(output,
                                                CMSEnvelopedDataGenerator.AES128_WRAP, 128,
                                                BouncyCastleProvider.PROVIDER_NAME);

                                try {
                                        IOUtils.copy(input, encryptedOutput);
                                } finally {
                                        encryptedOutput.close();
                                }
                        } finally {
                                input.close();
                        }
                } finally {
                        output.close();
                }
        }
} 
```

但我得到这个错误：

```
Exception in thread "main" org.bouncycastle.cms.CMSException: key inappropriate for algorithm.
        at org.bouncycastle.cms.CMSEnvelopedDataStreamGenerator.open(Unknown Source)
        at org.bouncycastle.cms.CMSEnvelopedDataStreamGenerator.open(Unknown Source)
        at org.bouncycastle.cms.CMSEnvelopedDataStreamGenerator.open(Unknown Source)
        at hk.gov.gld.etb.uploading.pkcs7.Test.main(Test.java:45)
Caused by: java.security.InvalidKeyException: Illegal key size or default parameters
        at javax.crypto.Cipher.a(DashoA13*..)
        at javax.crypto.Cipher.init(DashoA13*..)
        at org.bouncycastle.cms.CMSEnvelopedGenerator$RecipientInf.toRecipientInfo(Unknown Source)
        ... 4 more 
```

我使用的证书是使用JDK的keytool程序生成的，如下：

```
keytool -genkeypair -dname "cn=test" -alias test -keystore test.p12 -storepass test12 -validity 180 -storetype pkcs12 -keyalg rsa 
```

我使用的JDK版本是6，我使用的BouncyCastle版本是141。

我做对了吗？我还需要安装无限强度策略文件来进行 128 位加密吗？

非常感谢您的帮助。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T05:45:02.490

我相信是这样 - 你需要 US_export_policy.jar 和 local_policy.jar。我们需要在我们的项目中做同样的事情，这解决了它。

我认为您生成和使用的密钥应该没问题，否则。将这两个 jar 添加到 jre/lib/security 中，这应该会立即解决您的问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-11T05:09:59.603

似乎 BouncyCastle 库的 141 版有一个错误。当我升级到最新版本 (143) 时，完全相同的代码工作。

# python - 有没有办法在不调用 TypeError 的情况下使用错误数量的参数调用 Python 函数？

> ID：933484
> 
> 赞同：1
> 
> 时间：2009-06-01T03:43:49.233
> 
> 标签：python, apply, invocation

当您使用错误数量的参数或使用不在其定义中的关键字参数调用函数时，您会收到 TypeError。我想要一段代码来获取回调并根据回调支持的内容使用可变参数调用它。一种方法是，对于回调`cb`，使用`cb.__code__.cb_argcount`and `cb.__code__.co_varnames`，但我宁愿将其抽象为类似的东西`apply`，但这仅适用于“适合”的参数。

例如：

```
 def foo(x,y,z):
   pass

 cleanvoke(foo, 1)         # should call foo(1, None, None)
 cleanvoke(foo, y=2)       # should call foo(None, 2, None)
 cleanvoke(foo, 1,2,3,4,5) # should call foo(1, 2, 3)
                           # etc. 
```

Python中是否已经有类似的东西，还是我应该从头开始编写？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-01T03:47:31.073

与其自己深入研究细节，不如[检查](http://docs.python.org/library/inspect.html)函数的签名——你可能想要`inspect.getargspec(cb)`.

您究竟想如何使用该信息以及您拥有的参数来“正确”调用该函数，我并不完全清楚。假设为简单起见，您只关心简单的命名参数，并且您想要传递的值在 dict `d`...

```
args = inspect.getargspec(cb)[0]
cb( **dict((a,d.get(a)) for a in args) ) 
```

也许你想要一些更高级的东西，并且可以详细说明什么？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-01T03:57:23.490

这也许？

```
def fnVariableArgLength(*args, **kwargs):
    """
    - args is a list of non keywords arguments
    - kwargs is a dict of keywords arguments (keyword, arg) pairs
    """
    print args, kwargs

fnVariableArgLength() # () {}
fnVariableArgLength(1, 2, 3) # (1, 2, 3) {}
fnVariableArgLength(foo='bar') # () {'foo': 'bar'}
fnVariableArgLength(1, 2, 3, foo='bar') # (1, 2, 3) {'foo': 'bar'} 
```

* * *

**编辑** 您的用例

```
def foo(*args,*kw):
    x= kw.get('x',None if len(args) < 1 else args[0])
    y= kw.get('y',None if len(args) < 2 else args[1])
    z= kw.get('z',None if len(args) < 3 else args[2])
    # the rest of foo

foo(1)         # should call foo(1, None, None)
foo(y=2)       # should call foo(None, 2, None)
foo(1,2,3,4,5) # should call foo(1, 2, 3) 
```

# css - 如何设置动态宽度 DIV

> ID：933494
> 
> 赞同：0
> 
> 时间：2009-06-01T03:48:09.247
> 
> 标签：css, html

这是我的场景。我有一个容器 div，里面有 (n) 个子元素。对于这个例子，假设容器 div 中有 2 个 div：

```
<div id="container">
    <div id="col1">
        Stuff in col1
    </div>
    <div id="col2">
        Stuff in col2
    </div>
</div> 
```

容器 div 将占视口的百分比，例如 80%。现在，我正在寻找的是这两个内部 div（col1 和 col2）彼此内联并占用相同数量的空间。所以结果应该是这样的：

```
+-------------- container -------------+
|  +---- col1 ----+  +---- col2 ----+  |
|  | stuff in     |  | stuff in     |  |
|  | col1         |  | col2         |  |
|  +--------------+  +--------------+  |
+--------------------------------------+ 
```

或者，如果容器宽度发生变化，应该会导致如下结果：

```
+------------------------------ container -----------------------------+
|  +------------ col1 ------------+  +------------ col2 ------------+  |
|  | stuff in col1                |  | stuff in col2                |  |
|  | stuff in col1                |  | stuff in col2                |  |
|  +------------------------------+  +------------------------------+  |
+----------------------------------------------------------------------+ 
```

内部 div 始终具有相同的宽度，并且彼此之间有一定的间隔。这类似于表格布局，但如果可能，我宁愿不使用表格。我尝试了各种技术，例如浮动和内联显示 div 无济于事。他们似乎永远无法正确对齐。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-01T04:12:36.563

表格单元格可以自动拉伸。不完全可能`div`，因此您必须手动为每列指定适当的宽度。例如：

```
#col1, #col2 {
    float: left;
    width: 50%;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T03:55:02.993

使 col1 和 col2 跨度（不是 div）与

```
vertical-align:top
display:inline-block
width:50% 
```

显然（调整宽度以考虑您的边距/填充。并建议您对边距/填充使用百分比，以便它们加起来略低于 100%，请参阅：[http ://ejohn.org/blog/sub-pixel-problems-在-css/](http://ejohn.org/blog/sub-pixel-problems-in-css/) )

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T23:43:39.523

## 我的首选解决方案

使用相对于外部容器的定位：

```
#container, #container > div  
{
    position: relative;
}

#col1  
{
     left: 2%; /* your margin */
}

#col2  
{
     right: 2%;
}

#container > div 
{
     width: 47%;
} 
```

请注意，您在中间留下大约相同的 2%。`#col1`和现在`#col2`应该对齐。

## 其他解决方案

使用 CSS3：[`column-count: 2`](http://www.w3.org/TR/css3-multicol/#lsquo0)在 first 之后使用和中断列`div`。

如果你真的想漂浮，只做`#col1 { float: left; width: 50%; }`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T00:21:18.540

```
#container{
overflow: hidden
} 

#col1, #col2 {
    float: left;
    width: 50%;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-25T15:01:58.763

也许使用`display: table;`会有所帮助？[http://jsfiddle.net/g4dGz/119/](http://jsfiddle.net/g4dGz/119/)

# algorithm - 创建您自己的 MD5 碰撞

> ID：933497
> 
> 赞同：48
> 
> 时间：2009-06-01T03:50:03.163
> 
> 标签：algorithm, language-agnostic, hash

我正在做一个关于 MD5 碰撞的演示，我想告诉人们碰撞的可能性有多大。

最好有两个散列到同一事物的文本块，并解释在我遇到碰撞之前需要多少 [a-zA-Z] 组合。

显而易见的答案是散列所有可能的组合，直到命中两个相同的散列。那么你将如何进行编码。作为一个快速实验，我尝试对 [AZ] 的 5 列的每个组合进行哈希处理，将其存储在 .net 哈希表中并捕获碰撞异常。这有两个问题——哈希表最终超时，我很确定我需要更多的字符。

显然这个数据结构太大了，无法在内存中处理，所以现在我必须涉及到一个数据库。听起来也是一个测试 azure 的好项目——有点像[这些家伙](http://blogs.msdn.com/stevecla01/archive/2009/01/09/hooking-up-windows-azure-to-wikipedia.aspx)。

谁能指出我这样做的*有效*方法的方向？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-06-01T04:04:21.617

以下两个不同的 128 字节序列哈希相同：

**MD5 哈希**：79054025255fb1a26e4bc422aef54eb4

以下差异突出显示（粗体）。抱歉，有点难看。

```
d131dd02c5e6eec4693d9a0698aff95c 2fcab5 8 712467eab4004583eb8fb7f89
55ad340609f4b30283e4888325 7 1415a 085125e8f7cdc99fd91dbd f 280373c5b
d8823e3156348f5bae6dacd436c919c6 dd53e2 b 487da03fd02396306d248cda0
e99f33420f577ee8ce54b67080 a 80d1e c69821bcb6a8839396f965 2 b6ff72a70

```

和

```
d131dd02c5e6eec4693d9a0698aff95c 2fcab5 0 712467eab4004583eb8fb7f89
55ad340609f4b30283e4888325 f 1415a 085125e8f7cdc99fd91dbd 7 280373c5b
d8823e3156348f5bae6dacd436c919c6 dd53e2 3 487da03fd02396306d248cda0
e99f33420f577ee8ce54b67080 2 80d1e c69821bcb6a8839396f965 a b6ff72a70

```

碰撞/块 1 的可视化（来源：[Links.Org](http://www.links.org/?p=6)）

![替代文字](https://www.links.org/pics/d12-2.png)

碰撞/block2 的可视化（来源：[Links.Org](http://www.links.org/?p=6)）

![替代文字](https://www.links.org/pics/d13-2.png)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-02T04:13:38.523

仅使用文本文件很难做到这一点，AFAIK。您可能会遇到*一些*冲突，但让它们也来自 [a-zA-Z] 并不容易（还）。

另一方面，如果您只想要两个具有相同哈希的“有意义”的文件，您可以使用 PostScript 之类的方法：使用不同的二进制 blob 导致冲突，并使用条件表达式来显示不同的输出因此。

参见例如[这个问题](http://ipsc.ksp.sk/contests/ipsc2006/real/problems/h.html)（H2 部分）和[解决方案](http://ipsc.ksp.sk/contests/ipsc2006/real/solutions/h.html)。例如，[这个 PS 文件](http://ipsc.ksp.sk/contests/ipsc2006/real/solutions/h1.ps)和[这个](http://ipsc.ksp.sk/contests/ipsc2006/real/solutions/h2.ps)具有相同的 MD5sum，但它们都是格式正确的 PostScript 文件，当您打开它们时，它们的文本完全不同。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-02T03:26:25.733

如果您谈论的是直接碰撞的可能性有多大——没有故意尝试引起碰撞的碰撞——那么您会感到失望：您需要平均生成 2^64 个明文才能预期看到碰撞，这远远超出了您在合理（或实际上，甚至是_un_reasonable）时间内所能做的事情。

如果您想证明故意制造碰撞的难度，其他答案已经证明了这一点。但是，要求字符串完全是文本的额外限制使得即使是这些方法也基本上不切实际。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-01T04:47:58.823

我会看看[Hashcash](http://en.wikipedia.org/wiki/Hashcash)。使用有效的哈希算法，如 md5，计算碰撞的时间与位数成指数。Hashcash 所做的是计算部分冲突。也就是说，匹配哈希的低 16 位。要使低 16 位匹配，必须尝试平均散列 2^15 种不同的组合。如果您知道提出 16、24 或 32 位冲突需要多长时间，那么您可以轻松计算出更高位数的时间。

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2009-06-02T03:41:57.407

这种散列的全部意义在于冲突极不可能发生。你不会偶然生成一个——在你成功之前，你的机器几乎肯定会因年老而死。如果您可以合理地产生冲突，那么使用哈希的全部意义就会消失！

# python - Django 中的自定义标记

> ID：933500
> 
> 赞同：1
> 
> 时间：2009-06-01T03:53:08.703
> 
> 标签：python, django, markdown

谁能给我一个想法或一些关于如何使用纺织或 Markdown 为 django 创建自定义标记的参考（或者我在这里想错了）？

例如：我想转换以下标记（外括号表示它们被分组为一个标签：
[
[Contacts]
* Contact #1
* Contact #2
* Contact #3
[Friend Requests]
* Jose
]

将它们转换为：

```
<div class="tabs">  
    <ul> 
        <li class="tab">Contacts</li> 
        <li>Contact #1</li>
        (etc.. etc..)
    </ul>
</div> 
```

还是更适合我的需求推荐正则表达式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T15:36:57.483

内置[标记](http://docs.djangoproject.com/en/dev/ref/contrib/#markup)应用程序使用过滤器模板标签来呈现纺织品、降价和重组文本。如果这不是您想要的，另一种选择是使用“标记”字段。例如，

```
class TownHallUpdate(models.Model):
    content = models.TextField()
    content_html = models.TextField(editable=False)

    def save(self, **kwargs):
        self.content_html = textile.textile(sanitize_html(self.content))
    super(TownHallUpdate, self).save(**kwargs) 
```

*来自 James Tauber（和 Brian Rosner）的[django patterns](http://eldarion.com/talks/2009/05/eurodjangocon_djangopatterns.pdf) talk 示例。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T12:59:55.190

Django 带有一个内置的 contrib 应用程序，它提供过滤器以使用几种不同的标记语言显示数据，包括纺织和降价。

有关更多信息，请参阅[相关文档](http://docs.djangoproject.com/en/dev/ref/contrib/#markup)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T03:55:02.040

一个快速的谷歌搜索结果与[此](http://www.freewisdom.org/projects/python-markdown/Django)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-04T00:36:22.610

好吧，似乎最好的方法仍然是使用正则表达式并创建我自己的过滤器。

以下是一些帮助我的链接：
[http ://showmedo.com/videos/video?name=1100010&fromSeriesID=110](http://showmedo.com/videos/video?name=1100010&fromSeriesID=110)
[http://www.smashingmagazine.com/2009/05/06/introduction-to-advanced-regular-表达式/](http://www.smashingmagazine.com/2009/05/06/introduction-to-advanced-regular-expressions/)

希望这可以帮助和我有同样问题的人！

# javafx - 如何在大表面上制作平滑的 JavaFX LinearGradient？

> ID：933501
> 
> 赞同：0
> 
> 时间：2009-06-01T03:53:17.203
> 
> 标签：javafx, linear-gradients

为什么下面的代码会导致块状渐变？即渐变不平滑，您可以看到一些组成它的矩形。

有没有办法来解决这个问题？
顺便说一句，我在 Vista 上运行它，但我也在 Mac 上体验过。

```
var stage:Stage = Stage {
title: "Louis' Photo Wall"
width: 900
height: 600

scene: Scene {
    content : Rectangle {
        width:  bind stage.scene.width
        height: bind stage.scene.height
        fill:LinearGradient {
            startX : 0.0
            startY : 0.0
            endX : 0.0
            endY : 1.0
            stops: [
                Stop {
                    color : Color {
                        red:0.0
                        blue:0.0
                        green:0.0
                    }

                    offset: 0.0
                },
                Stop {
                    color : Color {
                        red:0.8
                        blue:0.8
                        green:0.8
                    }
                    offset: 1.0
                },

            ]
        }

    }//OuterRectangle
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-01T18:23:30.850

块状的数量并不引人注目。

移动到 1.0 的 endX 似乎给出了更明显的变化，块状结果的对角化。

一个假设是有几件事正在发生。1\. r/g/b 颜色并不是真正连续的，而是有 256 步。（8 位）。255 中的 0.8 是 204。 2\. 当一个颜色从 0 到 0.8 映射到 600 个像素时，每个像素都会增加一个不能完全平滑的增量。当我跑步时，场景大小实际上是 792x566。因此，渐变将使用 566/204 = 2.775 像素用于一种颜色，然后再转移到另一种颜色。这会导致进行转换的地方出现波动。

这并不能解释为什么使用 0.0 到 1.0 的停止（而不是 0.0 到 0.8）会导致（至少在我的运行中）似乎是一个平滑的过渡。

* * *

追问：`ofTheWay`LinearGradient 有一种可能用于插值的方法。代码示例和结果...

```
for (v in [0.00..1.00 step 1.0/600]) {
   println("{%7.5f v} {Color.WHITE.ofTheWay(Color.BLACK,v)}");
} 
```

哪个打印

```
0.00000 javafx.scene.paint.Color[red=255,green=255,blue=255,opacity=1.0]
0.00167 javafx.scene.paint.Color[red=255,green=255,blue=255,opacity=1.0]
0.00333 javafx.scene.paint.Color[red=254,green=254,blue=254,opacity=1.0]
0.00500 javafx.scene.paint.Color[red=254,green=254,blue=254,opacity=1.0]
0.00667 javafx.scene.paint.Color[red=253,green=253,blue=253,opacity=1.0]
0.00833 javafx.scene.paint.Color[red=253,green=253,blue=253,opacity=1.0]
0.01000 javafx.scene.paint.Color[red=252,green=252,blue=252,opacity=1.0]
0.01167 javafx.scene.paint.Color[red=252,green=252,blue=252,opacity=1.0]
0.01333 javafx.scene.paint.Color[red=252,green=252,blue=252,opacity=1.0]
0.01500 javafx.scene.paint.Color[red=251,green=251,blue=251,opacity=1.0]
0.01667 javafx.scene.paint.Color[red=251,green=251,blue=251,opacity=1.0]
... 
```

# c# - 类似 Base64String 的 C# 方法，但只有字母数字（没有加号或斜杠）

> ID：933503
> 
> 赞同：15
> 
> 时间：2009-06-01T03:54:40.917
> 
> 标签：c#, encoding, base64, alphanumeric

是否有任何与 Convert.ToBase64String 类似的 C# 方法，但除了字母数字输出之外不生成任何内容？

谢谢！

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-03-01T23:20:29.423

现在的答案有点过时了。为了将来的搜索者的利益：现在在 C# 中处理此问题的最佳方法是：

```
byte[] b; // fill your byte array somehow
string s = System.Web.HttpServerUtility.UrlTokenEncode(b); 
```

这将返回一个 URL 安全的 Base64 编码字符串（这就是您在问题的评论中所说的真正追求的内容）。

然后，您可以使用它再次对其进行解码，您猜对了：

```
byte[] b = System.Web.HttpServerUtility.UrlTokenDecode(s); 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-06-01T04:12:07.280

您可能正在考虑使用类似 Base32 编码的方法。Michael Giagnocavo有一个用于 C#[的](http://www.atrevido.net/blog/2004/01/13/Base32%2BIn%2BNET.aspx)Base32 编码器/解码器。它使用大写字母和数字的组合。

[这里](https://stackoverflow.com/questions/641361/base32-decoding)也有关于 StackOverflow 的相关讨论。

**编辑：**如果这是用于与 URL 安全相关的 Base64 编码，只需执行 Base64 并将“+”替换为“-”，将“/”替换为“_”。但我猜，你可能不想要它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-01T04:22:09.683

base-64 的一个常见变体（用于查询字符串）是使用“-”和“_”代替“+”和“/”。也许`Replace(...)`在每一端都有一点可以完成这项工作？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-01T04:00:32.477

如果可能，您可以用一些预定义的字符串替换 + 或斜杠。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-09-15T16:14:06.533

我正在寻找类似的编码器，我使用了[https://github.com/renmengye/base62-csharp/](https://github.com/renmengye/base62-csharp/)

它是“0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz”字符空间范围内的编码器/解码器。

我只是用它包装了它的方法

`System.Text.Encoding.UTF8.GetBytes(plainText);` 和 `System.Text.Encoding.UTF8.GetString(decoded);`

调用以使其可以轻松地处理字符串。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-01T04:35:58.430

您可以使用 BitConverter.ToString() 它将为您提供一个十六进制字符串。但是，生成的字符串将比 Base64 编码长。

# php - 如何将 var_export 的输出读入 PHP 中的变量？

> ID：933506
> 
> 赞同：20
> 
> 时间：2009-06-01T03:55:23.133
> 
> 标签：php, import

输出如下所示，在 output.txt 文件中恢复：

```
array (
  'IMType' => '1',
  'Email' => 'test@gmail.com',
  'SignupName' => 'test11',
  'Password' => '11111',
  'Encrypted' => '',
  'Confirm' => '11111',
  'OldPassword' => '',
  'Name' => 'test',
  'SignupProvinceText' => 'province',
  'SignupCity' => 'cityname',
  'Street' => 'street x.y',
  'SignupIndustry' => 'IT',
  'SignupCompany' => 'jobirn',
  'SignupJt' => 'engineer',
  'CellPhoneNum' => '',
  'linked_in' => '',
) 
```

它实际上是 的输出`var_export(my_variable,true)`，但是如何再次将其读入变量？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-06-01T03:57:38.233

像这样：

```
$dumpStr = var_export($var,true);
eval('$somevar = ' . $dumpStr.';'); 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-06-01T03:59:51.477

也许您想序列化对象然后反序列化？ [http://php.net/serialize](http://php.net/serialize)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2018-10-30T12:57:15.653

很简单，你必须把它保存为php文件而不是txt然后

只需将它包含在一个变量中:)

像这样：

```
file_put_contents( '/some/file/data.php', '<?php return '.var_export( $data_array, true ).";\n" ); 
```

当您需要访问它时，只需执行以下操作：

```
$data = include '/some/file/data.php' 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-07-29T05:32:05.047

此技术适用于数据缓存：

```
<?php
// reading data from DB or an API webservice etc.
$arrName = array();    
$arrName = call_procedure_here();

$strFileContent = '<?php' . PHP_EOL . '$arrName = ' . var_export($arrName,true) . ';' . PHP_EOL . '?>';
file_put_contents('cache_folder/arrayfilename.php', $strFileContent);

// later... from another process
include 'cache_folder/arrayfilename.php';
?> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-01-09T15:54:15.310

我写了一个基本的`var_export`解析器，没有 eval：[VarExportParser.php](https://github.com/klesun-misc/dev_data/blob/master/common/php/VarExportParser.php)

用法：

```
require_once('VarExportParser.php');
$parsed = VarExportParser::parse("array ('IMType' => '1', 'Email' => 'test@gmail.com')");
print(json_encode($parsed).PHP_EOL); 
```

输出：

```
{"IMType":"1","Email":"test@gmail.com"} 
```

您可以在这里尝试它的 js 版本：[text_transform.html](https://klesun-misc.github.io/dev_data/text_transform.html#dataset=varExportExample)（*var_export to json*按钮）

# iphone - 如何在 iphone 应用程序中以编程方式检索用户的电话号码？

> ID：933509
> 
> 赞同：0
> 
> 时间：2009-06-01T03:56:12.587
> 
> 标签：iphone

作为标题如何？我已经尝试过其他来源的代码：

```
id number = [[NSUserDefaults standardUserDefaults] objectForKey:@”SBFormattedPhoneNumber”];

NSLog(@”user phone number is %@”, number); 
```

然而，即使我在固件 2.2.1 的设备上进行了测试，它也会返回 NULL。任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-16T16:18:59.123

我遇到了同样的问题，并通过在手机上设置号码解决了它。默认情况下，我不认为该号码是在 iPhone 上设置的，但可以通过进入“设置”->“电话”->“我的号码”来解决。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T12:14:17.607

我不相信 2.2.1 SDK 是可能的。

Wil Shipley 在这方面非常努力，并在 4 月份向湾区可可领导小组的演讲中谈到了这一点。如果你想看的话，谷歌会希普利可可负责 vimeo。

我自己没试过。

# sql - MS-SQL In 语句

> ID：933519
> 
> 赞同：1
> 
> 时间：2009-06-01T03:58:52.413
> 
> 标签：sql, sql-server

```
Select a, b, c from table where a in (1, 2, 3) 
```

如果列表在列中怎么办？

我试试这个会报错：

```
Select a, b, c from a in b 
```

对不起，我没有明确我的问题。

这与**加入**或加入无关**（从表中选择 b）**

b列类型是nvarchar，数据是一个列表，像这样'1,2,5'

列类型是 int。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T09:35:37.350

许多答案都指向了正确的方向，但我认为这个真的会奏效：

```
SELECT a, b, c
FROM table
WHERE ',' + b + ',' LIKE '%,' + CAST(a as varchar) + ',%' 
```

您可以通过强制 B 以逗号开头和结尾来加快速度。或者更好的是，规范化数据库并将列 B 移动到具有一对多关系的自己的表中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T04:17:41.600

阅读您的问题后，这就是您想要的：

```
SELECT
    a,b,c
FROM
    tblA
WHERE
    b LIKE CAST(a as nvarchar) + ',%'
    OR b LIKE '%,' + CAST(a as nvarchar) + ',%'
    OR b LIKE '%,' + CAST(a as nvarchar) 
```

那应该这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T18:02:12.430

See [Need SQL Query Help, matching a stored procedure list parameter against individual columns](https://stackoverflow.com/questions/813124/need-sql-query-help-matching-a-stored-procedure-list-parameter-against-individua/813352#813352). It shows how to write a UDF that will take your "list" column and return a table that you can use to join against the one you're selecting from.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T04:09:11.167

在 SQL 中，列通常是所谓的“标量”数据类型之一：数字、日期/时间、字符串——参见例如[MSDN](http://msdn.microsoft.com/en-us/library/ms187752.aspx)。如果您更好地解释在什么意义上您将“列表”放入列`b`中，以及如何（例如向我们展示`CREATE TABLE a`声明），我们也许可以为您提供更好的帮助！

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2009-06-01T04:04:13.257

我想你想加入表格？

```
SELECT a, b, c
FROM a
JOIN b ON a.ID=b.ID 
```

# blackberry - 为什么在 WTK 存根生成器中使用 java.io.ObjectStreamException 用于枚举？

> ID：933530
> 
> 赞同：2
> 
> 时间：2009-06-01T04:06:23.710
> 
> 标签：blackberry, java-me, java-wireless-toolkit, cldc, jsr172

我正在使用在 WCF 中实现的 Web 服务，它在接口中定义了枚举。我正在尝试从 Java BlackBerry 客户端调用它。我正在使用 Eclipse 为 BlackBerry 开发 Java 应用程序。我正在使用[Sun Java Wireless Toolkit](http://java.sun.com/products/sjwtoolkit/download.html) (WTK) 2.5.2 生成存根代码，因为 Web 服务相当大（Windows Mobile 客户端已经在使用）。

当我尝试使用 WTK 生成存根代码时，我在 Eclipse 中收到有关枚举的错误。在以下函数中，它抱怨 java.io.ObjectStreamException 无法解析为类型。

```
private Object readResolve()
    throws java.io.ObjectStreamException {
    return fromValue(getValue());
} 
```

运行存根生成器时，有一个用于 CLDC 1.0 或 CLDC 1.1 的开关。使用这两个选项生成会导致相同的问题。

我在 Sun 找到了一个关于此的[论坛帖子，但没有任何回应。](http://forums.sun.com/thread.jspa?threadID=764788&tstart=690)这篇文章中的人说，“现在 java.io.ObjectStreamException 不在 CLDC 中，而是在 CDC 中。是否有一个很好的工具可以为 J2ME 特别是 CLDC 1.0/1.1 创建 Web 服务存根？” [我通过查看 [documentation 3](http://java.sun.com/javame/reference/apis/jsr139/) )验证了它在 CLDC 1.1 中不存在。

Eclipse 中有两个快速修复程序可以解决这种情况：1）在包“java.io”中创建类“ObjectStreamException”或 2）修复项目设置（希望我添加参考）。

更新：

这是 JSR-172 规范所说的……

5.2.5 枚举 JAX-RPC 子集不提供对 XML 枚举的支持。

5.2.6 由限制派生的简单类型 JAX-RPC 子集不支持通过限制派生简单类型。

WCF 枚举的WSDL 生成一个`<xs:simpleType>`包含. 那么我是否只是说这个字段是一个 int 而不是定义常量？`<xs:restriction>``<xs:enumeration>`

这只是WTK中的一个错误吗？如果是这样，我向 Sun 提交了一份错误报告，看看他们是否做出回应。为什么工具包不将此标记为错误？

所以现在我需要更改接口，使其符合 JSR-172。是否有工具可以阅读 WSDL 并指出合规性问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T18:30:57.453

CLDC 和 Wireless Toolkit 都使用 Java Micro Edition。JavaME 基于 Java 语言的第 2 版，这意味着没有泛型和枚举。

为您的黑莓手机调查 Web 服务的第一步是阅读 JSR-172 规范。

# asp.net - HTTPContextBase.User 和 MembershipUser 之间的区别

> ID：933531
> 
> 赞同：0
> 
> 时间：2009-06-01T04:08:00.183
> 
> 标签：asp.net

请澄清。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T04:48:28.540

Context.User 是机器上当前进程在其下运行的用户的[IPrincipal 。](http://msdn.microsoft.com/en-us/library/system.security.principal.iprincipal.aspx)MembershipUser 是您以某种方式通过身份验证的应用程序级用户。这两件事可以是相同的（[模拟](http://msdn.microsoft.com/en-us/library/ms998351.aspx)），也可以是不同的（例如在服务帐户下运行并从数据库对用户进行身份验证）。默认情况下，它们是不同的。

# project-management - 对于企业 Web 应用程序，推荐的支持技术人员与开发人员的比例是多少？

> ID：933534
> 
> 赞同：1
> 
> 时间：2009-06-01T04:11:15.410
> 
> 标签：project-management

我们一直在处理开发和支持方面的许多难题。工单堆积如山，当我们忙于解决问题时，我们忽略了花足够的时间与客户就该问题进行实际沟通。目前，我们有 2 位主要开发人员可以在 Web 应用程序上工作，其中一位几乎也是唯一负责处理沟通和处理支持票证的支持人员。我们还有第三个人兼职，涉足支持和开发领域。对于管理支持票和兼顾与客户沟通和实际修复错误，您有什么好的技巧吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T04:39:30.970

它实际上是用户的错误经济成本、开发人员成本和支持人员成本的函数。

如果发生错误时业务受到的影响很小，那么允许错误票据堆积是一个好的业务决策。

如果支持人员很便宜，那么拥有一个忙碌的运营/支持团队可能比修复错误更便宜。例如，假设用户必须拨打电话才能更改密码。现在，考虑一下，开发人员需要十个小时来编写一个允许用户更改自己密码的功能。你基本上有这些费用：

```
x = Cost of support time * number of requests * average time to service one request
y = Cost of developer time * number of requests reduced * average time saved 
```

只需找到这两个参数的交集。这并不容易，因为需要考虑软件的预期寿命以确定节省的成本。您可以根据解决问题多快收回成本来重写函数。然后，您可以对哪些问题可以按开发人员时间最好地解决，哪些问题最好由支持人员处理进行排名。

另一个例子，假设您的网络服务器每 2-4 周冻结一次。支持人员收到投诉，然后重新启动服务器。您可以计算客户的成本、支持人员的成本以及解决问题和解决问题的开发成本。通常前两个比第三个更容易计算。开发人员可能需要一个小时才能找到问题，或者可能是硬件故障无法通过诊断测试，开发人员需要两个月才能找到。

撇开经济学不谈，我的偏好是让开发人员轮流处理支持。这使他们对最耗时的支持问题有一个很好的了解，并且他们也是判断修复这些问题的成本的最佳选择。此外，开发人员往往不喜欢支持任务，并且会找出经济解决方案以减轻支持负担。让每个开发人员轮换支持可以确保他们在某种程度上“吃自己的狗粮”。

# opencv - 高斯滤波器算法在 OpenCV 中是如何工作的

> ID：933540
> 
> 赞同：5
> 
> 时间：2009-06-01T04:13:23.833
> 
> 标签：opencv, gaussian

我写了自己的高斯滤波器，但它真的很慢。

OpenCV 的高斯算法要快得多，比我的高斯滤波器快 20 倍。我想在我的项目中重写OpenCV的高斯算法，我不想在我的项目中包含opencv。

然而，

> 谁能给我算法描述，opencv的源码好像太难懂了？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-01T05:09:12.023

高斯滤波器有一个特性可以很容易地加速：滤波器可以在两个维度上独立应用。您定义一个垂直操作的一维过滤器和另一个水平操作的过滤器，并同时应用它们；这会产生与在二维中应用单个过滤器相同的效果。

除此之外，您可能需要查看适用于您的处理器的[SIMD 指令](http://en.wikipedia.org/wiki/SIMD)，例如[SSE3 。](http://en.wikipedia.org/wiki/SSE3)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-01T04:46:49.447

要回答您问题的第二部分，高斯模糊只是在图像上作为卷积核应用的 3-d 高斯表面。[维基百科](http://en.wikipedia.org/wiki/Gaussian_interpolation)对算法本身有很好的参考，但基本上，你取高斯曲线的值并将其转换为方阵，并将其乘以图像中的每个像素，例如：

```
Kernel:               
[0 1 2 0 0
1 4 6 4 1      X   Iterate over every single pixel in the image
2 6 10 6 2
1 4 6 4 1
0 1 2 1 0] 
```

（请注意，这只是一个示例内核，有非常具体的 eqns，根据您的高斯变量，您会得到不同的结果）

为了回答您问题的性能部分，假设图像大小不变，该算法的整体速度将取决于几件事。假设图像是 NxM 像素，卷积核是 PxP 像素。您将不得不进行 P *P* N*M 操作。P 越大，对给定图像执行的操作就越多。您可以巧妙地使用此处使用的算法，进行非常具体的基于行或列的数学运算。

实施也很重要。如果您想变得非常高效，您可能需要使用您的架构提供的最高级指令。如果您使用的是 Intel x86 芯片，您可能希望获得 Intel 性能原语 (IPP) 的许可证并直接调用这些指令。IIRC，OpenCV 在可用时确实使用了 IPP...

如果给定架构上的浮点性能很差，您还可以做一些非常聪明的事情并使用所有缩放的整数。这可能会加快速度，但在走这条路之前，我会先看看其他选择。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-01T04:47:52.830

试试看[这里](http://homepages.inf.ed.ac.uk/rbf/HIPR2/gsmooth.htm)。您想提前计算出离散高斯矩阵，然后将其与图像进行卷积。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-01T05:12:14.767

如果您的卷积核相对较大并且您正在实现直接卷积，则性能差异可能是因为 OpenCV 正在使用快速傅里叶变换 (FFT) 实现卷积。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-12-19T23:58:48.167

我讨厌迂腐，但您要求的是算法，即完成任务所需的精确步骤序列。你已经有了高斯算法。所以你问题的关键是当你要求*更快*的东西时，这与要求算法不同。

要回答*更快*的问题 - 您想知道 OpenCV 如何优化其代码，这是一个技术性很强且范围广泛的主题。我会冒险猜测它使用汇编语言和特定于 GPU 的功能。我将从学习汇编开始，然后研究 CUDA 包以利用您的 GPU。

# regex - 如何在使用 Perl 进行搜索和替换期间追加而不是替换文本？

> ID：933543
> 
> 赞同：4
> 
> 时间：2009-06-01T04:16:43.833
> 
> 标签：regex, perl

我正在尝试在 Perl 中使用正则表达式进行搜索和替换。

我正在搜索的文本是：

```
<space>Number<space>NumberNumberNumber 
```

我想将其替换为：

```
<space>Number<space>NumberNumberNumberI 
```

我有以下正则表达式可用于查找字符串：

```
\s[0-9]\s[0-9[0-9][0-9] 
```

但是我该怎么替换字符串呢？基本上我只想在末尾附加一个“我”。

我正在使用：

```
perl -pi -e "s/\s[0-9]\s[0-9][0-9][0-9]/I/;" testFile 
```

但这用 I 代替了整个事情，而不是附加到它上面。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-01T04:18:47.030

这就是反向引用的用途。只需将要捕获的文本部分用括号括起来即可。第一组括号在 $1 中可用，第二组在 $2 中，依此类推。

```
s/(\s[0-9]\s[0-9]{3})/$1I/ 
```

在 Perl 5.10 中，我们获得了[命名捕获](http://perldoc.perl.org/perlre.html#'%28%3f%3cNAME%3epattern%29')，所以你可以说

```
s/(?<bodytext>\s[0-9]\s[0-9]{3})/$+{bodytext}I/ 
```

介于两者之间的东西`<`是`>`名称。名称成为`%+`变量中的键，值是捕获的文本。

另一种解决方案是使用[零宽度正向后视](http://perldoc.perl.org/perlre.html#'%28%3f%3c=pattern%29'-'%5cK')

```
s/(?<=\s[0-9]\s[0-9]{3})/I/ 
```

或其，Perl 5.10 的新功能，简写`\K`

```
s/\s[0-9]\s[0-9]{3}\K/I/ 
```

* * *

尝试

```
perl -pi -e 's/(\s[0-9]\s[0-9][0-9][0-9])/$1I/' filename 
```

如果你使用双引号，$1 会在 Perl 看到它之前被 shell 插入。如果您认为某些应该可以工作的东西有问题，那么看看 Perl 所看到的可能是个好主意。您可以使用[B::Deparse](http://perldoc.perl.org/B/Deparse.html)执行此操作：

```
perl -MO=Deparse -pi -e "s/(\s[0-9]\s[0-9][0-9][0-9])/$1I/" filename 
```

这将产生以下输出。

```
BEGIN { $^I = ""; }
LINE: while (defined($_ = <ARGV>)) {
    s/(\s[0-9]\s[0-9][0-9][0-9])/I/;
}
continue {
    print $_;
}
-e syntax OK 
```

从这里我们可以看出它`$1`是缺失的。让我们用单引号再试一次：

```
perl -MO=Deparse -pi -e 's/(\s[0-9]\s[0-9][0-9][0-9])/$1I/' filename
BEGIN { $^I = ""; }
LINE: while (defined($_ = <ARGV>)) {
    s/(\s[0-9]\s[0-9][0-9][0-9])/$1I/;
}
continue {
    print $_;
}
-e syntax OK 
```

一次转义：

```
perl -MO=Deparse -pi -e "s/(\s[0-9]\s[0-9][0-9][0-9])/\$1I/" filename
BEGIN { $^I = ""; }
LINE: while (defined($_ = <ARGV>)) {
    s/(\s[0-9]\s[0-9][0-9][0-9])/$1I/;
}
continue {
    print $_;
}
-e syntax OK 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-02-18T01:41:30.523

2009 年答案的较短版本 — 您可以使用***零宽度正向后向断言***,`(?<=pattern)`或`\K`, 在匹配后插入一些内容：

```
%echo "test" | perl -p -e "s/(?<=test)/ing/"
testing
%echo "test" | perl -p -e "s/test\K/ing/"
testing
% 
```

或者，要在匹配之前插入一些内容，您可以使用***零宽度正向前瞻断言***，`(?=pattern)`：

```
%echo "test" | perl -p -e "s/(?=test)/#/"
#test
% 
```

参考：

*   [http://perldoc.perl.org/perlre.html#Lookaround-Assertions](http://perldoc.perl.org/perlre.html#Lookaround-Assertions)

# sql - 连接 select 语句中的行

> ID：933548
> 
> 赞同：1
> 
> 时间：2009-06-01T04:19:13.457
> 
> 标签：sql, sql-server-2005

我有一个类似这样的选择语句

```
select col1 from table1 where cond1=true 
```

这会返回类似的结果

```
col1
_____
5
5
6
3 
```

但我想改变它以返回我

```
5-5-6-3 
```

这可能吗？如果有怎么办？请让我知道如何做到这一点。提前感谢您的回复。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T04:32:46.640

这正是您想要的：

```
declare @ret varchar(500)
set @ret=''
select @ret = @ret + col1 + '-' from test

select substring(@ret, 1, len(@ret)-1) 
```

注意：如果您的 col1 是*int*，那么我认为您将不得不使用*convert*或*cast*来使其成为*varchar*。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-01T04:33:38.743

[http://blog.shlomoid.com/2008/11/emulating-mysqls-groupconcat-function.html](http://blog.shlomoid.com/2008/11/emulating-mysqls-groupconcat-function.html)

```
SELECT my_column AS [text()]
FROM   my_table
FOR XML PATH('') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T04:25:22.240

您可能可以，但为什么不在应用程序中这样做呢？我不知道您使用的是什么语言，但是您可以在获得查询结果（伪代码）后执行以下操作：

```
result = result.join('-') 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T04:34:36.687

如果您在 Microsoft SQL Server 上，您应该可以使用 REPLACE 命令来完成。

```
SELECT col1,
       dynamic_text = REPLACE( 
                ( 
                    SELECT 
                        DISTINCT phone_col2 AS [data()] 
                    FROM 
                        table2
                    WHERE 
                        condition 
                    FOR XML PATH ('') 
                ), '', '-')

 FROM table1
WHERE condition 
```

这样的事情可能会奏效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-01T04:51:28.973

我建议您在前端执行此操作，对于大量行，这将非常慢。SQL Server 的 sting 连接极其缓慢。您可以创建一个 .net 函数来获取表格并返回字符串，这样可以确保速度。

如果没有性能问题，比如一次性的事情等，请使用上面的其他解决方案，因为这些解决方案是在 sql 中处理的

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-01T04:57:54.317

这也有效：

```
 --Sample Data
DECLARE @Test TABLE
    (
    Col1 int 
    )

INSERT @Test
SELECT 1
UNION ALL
SELECT 2
UNION ALL
SELECT 3
UNION ALL
SELECT 4
UNION ALL
SELECT 5

--The query
SELECT          SUBSTRING(
                (
                SELECT          '-' + CAST(Col1 AS varchar(10))
                FROM            @Test
                ORDER BY        Col1
                FOR XML PATH    ('')
                ), 2, 2000) AS MyJoinedColumn 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-01T18:07:42.933

试试这个：

```
declare @Test table (rowid int identity(1,1) primary key, col1 int not null)
insert into @test Values (5)
insert into @test Values (5)
insert into @test Values (6)
insert into @test Values (3)

declare @value varchar(500)
set @value=NULL
select @value = COALESCE(@Value+'-'+CONVERT(varchar,col1),convert(varchar,col1)) from @Test

print @value 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-09-08T09:24:22.753

在 MySQL 下，您可以轻松做到这一点

```
select GROUP_CONCAT(col1 SEPARATOR '-') from table1 where cond1=true 
```

# xml - 经典asp中的System.Net.HttpWebRequest？

> ID：933553
> 
> 赞同：4
> 
> 时间：2009-06-01T04:22:43.253
> 
> 标签：xml, post, asp-classic, request, xmlhttprequest

我有一个经典的 asp 应用程序，需要将 XML 发布到支付引擎，参考代码使用 System.Net.HttpWebRequest 对象 (asp.net)。我可以使用经典 ASP 中的等效项来发布 XML 吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-01T13:23:34.863

这是我用于在 ASP 中发出 HTTP 请求的一个小辅助函数。它在 JScript 中，但您至少应该了解一些想法以及一些我们多年来必须解决的讨厌的问题的一些指示。

```
<%

/*
   Class: HttpRequest
       Object encapsulates the process of making an HTTP Request.

   Parameters:
      url - The gtarget url
      data - Any paramaters which are required by the request.
      method - Whether to send the request as POST or GET
      options - async (true|false): should we send this asyncronously (fire and forget) or should we wait and return the data we get back? Default is false

   Returns:
      Returns the result of the request in text format.

*/

var HttpRequest = function( url, data, method, options  )
{
    options = options ? options : { "async" : false };
    options[ "async" ] = options["async"] ? true : false;

    var text = "";
    data = data ? data : "";
    method = method ? String( method ).toUpperCase() : "POST";

    // Make the request
    var objXmlHttp = new ActiveXObject( "MSXML2.ServerXMLHTTP" );
    objXmlHttp.setOption( 2, 13056 ); // Ignore all SSL errors

    try {
        objXmlHttp.open( method, url, options[ "async" ] ); // Method, URL, Async?
    }
    catch (e)
    {
        text = "Open operation failed: " + e.description;
    }

    objXmlHttp.setTimeouts( 30000, 30000, 30000, 30000 );   // Timeouts in ms for parts of communication: resolve, connect, send (per packet), receive (per packet)
    try {
        if ( method == "POST" ) {
            objXmlHttp.setRequestHeader( "Content-Type", "application/x-www-form-urlencoded" );
        }

        objXmlHttp.send( data );

        if ( options[ "async" ] ) {
            return "";
        }

        text = objXmlHttp.responseText;

    } catch(e) {
        text = "Send data failed: " + e.description;
    }

    // Did we get a "200 OK" status?
    if ( objXmlHttp.status != 200 )
    {
        // Non-OK HTTP response
        text = "Http Error: " + objXmlHttp.Status + " " + Server.HtmlEncode(objXmlHttp.StatusText) + "\nFailed to grab page data from: " + url;
    }

    objXmlHttp = null; // Be nice to the server

    return  text ;
}

%> 
```

如果您将其保存在文件（称为 httprequest.asp）中，则可以使用以下代码使用它：

```
<%@ Language="JScript" %>
<!--#include file="httprequest.asp"-->
<%

var url = "http://www.google.co.uk/search";
var data = "q=the+stone+roses"; // Notice you will need to url encode your values, simply pass them in as a name/value string

Response.Write( HttpRequest( url, data, "GET" ) );

%> 
```

一个警告，如果它有错误它会返回给你错误信息，没有办法捕捉它。它可以满足我们的需求，如果我们需要更多的保护，那么我们可以创建一个可以更好地处理错误的自定义函数。

希望有帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-01T06:03:42.337

经典 ASP 可以使用`XMLHTTP`ActiveX 对象或`ServerXMLHTTP`通过 MSXML 库提供的对象来发起请求。（[MSDN 参考](http://msdn.microsoft.com/en-us/library/ms762278(VS.85).aspx)）。

[这篇知识库文章](http://support.microsoft.com/kb/290591)提供了一个很好的对象参考和示例代码`ServerXMLHTTP`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-02-22T23:06:08.587

我认为此函数的异步版本有效并避免此处讨论的“不发送”错误的原因：

[如何在 asp classic 中触发异步调用并忽略响应？](https://stackoverflow.com/questions/1510497/how-do-i-fire-an-asynchronous-call-in-asp-classic-and-ignore-the-response)

是不是你永远不会在异步版本中释放 COM 对象 - 很好，它解决了问题，坏的是它泄漏了大量时间资源。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-01T04:25:21.367

所有 AJAXy 都使用 XMLHttp。
看看这个链接是否有帮助 - [http://www.mikesdotnetting.com/Article.aspx?ArticleID=39](http://www.mikesdotnetting.com/Article.aspx?ArticleID=39)

编辑：不要接受这个答案。
我所做的只是使用谷歌搜索它。你先尝试过吗？

我想有些问题可以通过搜索来回答。
对于其他一切，都有 StackOverflow。

# asp.net - Elmah 不使用 asp.net 网站

> ID：933554
> 
> 赞同：80
> 
> 时间：2009-06-01T04:22:48.433
> 
> 标签：asp.net, exception-handling, elmah

我尝试将 elmah 与我的 asp.net 站点一起使用，但每当我尝试访问[http://localhost:port/elmah.axd 时](http://localhost:port/elmah.axd)，我都会得到资源未找到异常。我的 web.config 如下所示。

```
 <?xml version="1.0"?>
    <configuration>
      <configSections>
        <sectionGroup name="elmah">
          <section name="security" requirePermission="false" 
                  type="Elmah.SecuritySectionHandler, Elmah"/>
          <section name="errorLog" requirePermission="false" 
                  type="Elmah.ErrorLogSectionHandler, Elmah" />
          <section name="errorMail" requirePermission="false" 
                  type="Elmah.ErrorMailSectionHandler, Elmah" />
          <section name="errorFilter" requirePermission="false" 
                  type="Elmah.ErrorFilterSectionHandler, Elmah"/>
        </sectionGroup>
      </configSections>
      <elmah>
        <security allowRemoteAccess="0" />
        <errorLog type="Elmah.SqlErrorLog, Elmah" 
                 connectionStringName="elmah-sql" />
        <errorMail
                from="my@account"
                to="myself"
                subject="ERROR From Elmah:"
                async="true"
                smtpPort="587"
                smtpServer="smtp.gmail.com"
                userName="my@account"
                password="mypassword" />
      </elmah>

      <connectionStrings>
        <add name="elmah-sql" connectionString="data source=(sqlserver); 
               database=elmahdb;
             integrated security=false;User ID=user;Password=password"/>
      </connectionStrings>
      <system.web>
        <compilation debug="true">
          <assemblies>
            <add assembly="Elmah, Version=1.0.10617.0, Culture=neutral, 
               PublicKeyToken=null"/>
          </assemblies>
        </compilation>
        <authentication mode="Windows"/>

        <httpHandlers>
          <remove verb="*" path="*.asmx"/>
          <add verb="*" path="*.asmx" validate="false" 
            type="System.Web.Script.Services.ScriptHandlerFactory, 
               System.Web.Extensions, Version=3.5.0.0, Culture=neutral, 
                  PublicKeyToken=31BF3856AD364E35"/>
          <add verb="*" path="*_AppService.axd" validate="false" 
               type="System.Web.Script.Services.ScriptHandlerFactory, 
               System.Web.Extensions, Version=3.5.0.0, Culture=neutral, 
                   PublicKeyToken=31BF3856AD364E35"/>
          <add verb="GET,HEAD" path="ScriptResource.axd" 
                 type="System.Web.Handlers.ScriptResourceHandler, 
               System.Web.Extensions, Version=3.5.0.0, Culture=neutral, 
                    PublicKeyToken=31BF3856AD364E35" validate="false"/>
        </httpHandlers>
        <httpModules>
          <add name="ScriptModule" type="System.Web.Handlers.ScriptModule, 
                System.Web.Extensions, Version=3.5.0.0, Culture=neutral, 
                PublicKeyToken=31BF3856AD364E35"/>
        </httpModules>
      </system.web>

      <system.webServer>
        <validation validateIntegratedModeConfiguration="false"/>
        <modules runAllManagedModulesForAllRequests="true">
          <remove name="ScriptModule"/>
          <add name="ScriptModule" preCondition="managedHandler" 
                type="System.Web.Handlers.ScriptModule, 
               System.Web.Extensions, Version=3.5.0.0, Culture=neutral, 
                 PublicKeyToken=31BF3856AD364E35"/>
          <add name="ErrorMail" type="Elmah.ErrorMailModule, Elmah"/>
          <add name="ErrorLog" type="Elmah.ErrorLogModule, Elmah"/>
          <add name="ErrorFilter" type="Elmah.ErrorFilterModule, Elmah"/>
        </modules>

        <handlers>
          <remove name="WebServiceHandlerFactory-Integrated"/>
          <remove name="ScriptHandlerFactory"/>
          <remove name="ScriptHandlerFactoryAppServices"/>
          <remove name="ScriptResource"/>
          <add name="ScriptHandlerFactory" verb="*" path="*.asmx" 
                preCondition="integratedMode" 
               type="System.Web.Script.Services.ScriptHandlerFactory, 
                    System.Web.Extensions, Version=3.5.0.0, 
               Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
          <add name="ScriptHandlerFactoryAppServices" verb="*" 
            path="*_AppService.axd" preCondition="integratedMode" 
               type="System.Web.Script.Services.ScriptHandlerFactory, 
                 System.Web.Extensions, Version=3.5.0.0, 
               Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
          <add name="ScriptResource" preCondition="integratedMode" 
            verb="GET,HEAD" path="ScriptResource.axd" 
               type="System.Web.Handlers.ScriptResourceHandler, 
            System.Web.Extensions, Version=3.5.0.0, 
               Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
          <add name="Elmah" verb="POST,GET,HEAD" path="elmah.axd" 
                       preCondition="integratedMode" 
               type="Elmah.ErrorLogPageFactory, Elmah"/>
        </handlers>
      </system.webServer>
    </configuration> 
```

编辑：Elmah =（错误记录模块和处理程序）
[http://code.google.com/p/elmah/](http://code.google.com/p/elmah/)

* * *

## 回答 #1

> 赞同：153
> 
> 时间：2009-07-23T23:18:24.903

我刚刚遇到了 Elmah 无法在 IIS7 部署中工作的类似问题。我发现我需要在`system.web`AND中注册 Elmah 模块和处理程序`system.webServer`：

```
<system.web>
...
  <httpHandlers>
    ...
    <add verb="POST,GET,HEAD" path="elmah.axd" type="Elmah.ErrorLogPageFactory, Elmah" />
    ...
  </httpHandlers>
  <httpModules>
    ...
    <add name="ErrorLog" type="Elmah.ErrorLogModule, Elmah"/>
    <add name="ErrorMail" type="Elmah.ErrorMailModule, Elmah" />
    <add name="ErrorFilter" type="Elmah.ErrorFilterModule, Elmah" />
    ...
  </httpModules>
  ...
</system.web>
<system.webServer>
  ...
  <modules runAllManagedModulesForAllRequests="true">
    ...
    <add name="ErrorLog" type="Elmah.ErrorLogModule, Elmah"/>
    <add name="ErrorMail" type="Elmah.ErrorMailModule, Elmah" />
    <add name="ErrorFilter" type="Elmah.ErrorFilterModule, Elmah" />
    ...
  </modules>
  <handlers>
    ...
    <add name="Elmah" verb="POST,GET,HEAD" path="elmah.axd" type="Elmah.ErrorLogPageFactory, Elmah" />
    ...
  </handlers>
<system.webServer> 
```

* * *

## 回答 #2

> 赞同：120
> 
> 时间：2009-11-05T07:20:38.277

*你可能也需要这个*

```
<elmah>
    <security allowRemoteAccess="1" />
</elmah> 
```

当你拿到时

> 403 - 禁止：访问被拒绝。您无权使用您提供的凭据查看此目录或页面。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2009-06-01T04:47:10.070

尝试在该部分的“httphandlers”和“httpmodules”部分中注册模块和处理程序`<system.web>`：

```
 <httpHandlers>
      ......
    <add verb="POST,GET,HEAD" path="elmah.axd" type="Elmah.ErrorLogPageFactory, Elmah"/>
      .....

    </httpHandlers>
    <httpModules>
        .......
        <add name="ErrorMail" type="Elmah.ErrorMailModule, Elmah"/>
        <add name="ErrorLog" type="Elmah.ErrorLogModule, Elmah"/>
        <add name="ErrorFilter" type="Elmah.ErrorFilterModule, Elmah"/>
       .......
    </httpModules> 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2011-07-15T06:45:04.383

今天解决它的一种方法是使用 nuget。

Visual Studio：菜单->工具->库包管理器->包管理器控制台

```
install-package elmah 
```

高温高压

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2013-12-26T18:39:15.603

当我使用 NuGet（VS 2013，IIS 8.0）安装时，这条线丢失了：

```
<system.webServer>
  <handlers>
    <add name="Elmah" verb="POST,GET,HEAD" path="elmah.axd" type="Elmah.ErrorLogPageFactory, Elmah" />
 </handlers>
</system.webServer> 
```

添加它解决了 404 错误问题。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2011-11-29T03:34:40.580

nuget 包未将以下重要行添加到 web.config 导致 403 错误。

```
<configuration>
  <elmah>  
    <security allowRemoteAccess="1" />
    <errorLog type="Elmah.XmlFileErrorLog, Elmah" logPath="~/app_data/elmah" />
  </elmah>
</configuration> 
```

此外，您可能希望通过以下方式限制对错误日志的访问

```
<add name="Elmah" verb="POST,GET,HEAD" path="/admin/elmah.axd" type="Elmah.ErrorLogPageFactory, Elmah" resourceType="Unspecified" requireAccess="Script" preCondition="integratedMode" /> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-07-21T09:56:21.823

如果您使用的是区域，请确保您已更新 appsetting 密钥之一

默认

```
<add key="elmah.mvc.route" value="elmah" /> 
```

如果您是区域管理员

```
<add key="elmah.mvc.route" value="admin/elmah" /> 
```

# c# - 如何在 C# 中连接到 Telnet 服务器？

> ID：933556
> 
> 赞同：2
> 
> 时间：2009-06-01T04:23:04.847
> 
> 标签：c#, .net, telnet

我有我的 OJT，我当前的任务是做一个连接到 telnet 服务器的 FTP 客户端服务器。这是我第一次做这样的节目。知道如何在 c# windows 应用程序中执行此操作吗？如何使用完整的身份验证建立与 telnet 的连接？他们是否有任何开源库可以帮助我做到这一点？对此的任何帮助将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T05:22:03.100

编辑：关于这个主题的另一个[堆栈溢出问题](https://stackoverflow.com/questions/390188/c-telnet-library)很好地回答了它。

最流行的策略似乎涉及使用 System.Net.Sockets 类

这两个站点都有代码示例并描述了打开连接和读取数据： [C# Help - TELNET Client](http://www.csharphelp.com/archives/archive239.html)

[C# 和 Telnet - 不像听起来那么痛苦](http://geekswithblogs.net/bigpapa/archive/2007/10/08/C-2.0-and-Telnet---Not-As-Painful-As-It.aspx)

但是，如果你想走开源路线，有一个名为[.NET Telnet](http://dotnettelnet.sourceforge.net/)的项目，它提供了一个开源库来帮助进行 telnet 交互。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T05:28:58.660

首先阅读[TcpClient](http://msdn.microsoft.com/en-us/library/system.net.sockets.tcpclient.aspx)类，然后搜索示例代码。如果您需要实现[`Telnet`](http://en.wikipedia.org/wiki/Telnet)客户端，您应该了解旧的[RFC 854](https://www.rfc-editor.org/rfc/rfc854)。

[`FTP`](http://en.wikipedia.org/wiki/File_Transfer_Protocol)只是一堆其他的 RFC，你可以从[RFC 959](https://www.rfc-editor.org/rfc/rfc959)开始。

Telnet 和 FTP 客户端都可以直接使用`TcpClient`.

# jquery - IE 中的 jQuery .width(val) 错误 - 参数无效

> ID：933564
> 
> 赞同：5
> 
> 时间：2009-06-01T04:30:15.703
> 
> 标签：jquery, internet-explorer

通过 ajax 加载内部 div (#book_table) 后，我想调整正文的宽度以适应更大的内容。

```
var new_width = parseInt($('#book_table').css('width'))+407;
$('body').width(new_width); 
```

在 FF 和 Safari 中工作，但在 IE 中因“无效参数”而失败。在解压后的 jQuery 1.3.1 中，它是第 1049 行：

```
elem[ name ] = value; 
```

但是，传递文字值在 IE 中有效：

```
$('body').width(1200); 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-01T04:36:20.193

你应该试试：

```
var new_width = $('#book_table').width() + 407;
$('body').width(new_width); 
```

使用`css('width')`返回一个带有“px”扩展名的字符串，而不仅仅是一个数字。Firefox 可以正确解析`"100px"`为`100`with `parseInt`，但看起来 IE 不能。

Using`width()`只会返回一个整数，这也消除了调用的需要`parseInt`。

# mysql - 获取表格行数的最有效方法

> ID：933565
> 
> 赞同：67
> 
> 时间：2009-06-01T04:30:23.177
> 
> 标签：mysql, sql, count

我目前有一个超过 600 万行并且还在增长的数据库。我目前在做 SELECT COUNT(id) FROM table；为了向我的用户显示数字，但是数据库变得越来越大，除了能够显示数字之外，我不需要存储所有这些行。有没有办法选择要显示的 auto_increment 值，以便我可以清除数据库中的大部分行？使用`LAST_INSERT_ID()`似乎不起作用。

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2010-04-04T23:38:18.483

以下是查找`AUTO_INCREMENT`表的下一个值的最高效方法。即使在包含数百万个表的数据库上，这也很快，因为它不需要查询潜在的大型`information_schema`数据库。

```
mysql> SHOW TABLE STATUS LIKE 'table_name';
// Look for the Auto_increment column 
```

但是，如果您必须在查询中检索此值，那么`information_schema`您必须转到数据库。

```
SELECT `AUTO_INCREMENT`
FROM   INFORMATION_SCHEMA.TABLES
WHERE  TABLE_SCHEMA = 'DatabaseName'
AND    TABLE_NAME   = 'TableName'; 
```

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2009-06-01T04:37:22.813

如果只是关于获取记录（行）的数量，我建议使用：

```
SELECT TABLE_ROWS
FROM information_schema.tables 
WHERE table_name='the_table_you_want' -- Can end here if only 1 DB 
  AND table_schema = DATABASE();      -- See comment below if > 1 DB 
```

（至少对于 MySQL）。

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2009-07-10T12:07:52.967

试试这个

执行此 SQL：

```
SHOW TABLE STATUS LIKE '<tablename>' 
```

并获取字段的值`Auto_increment`

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2013-09-24T22:14:22.543

我不确定为什么没有人提出以下建议。这将仅使用 SQL 获得 auto_increment 值（无需使用 PHP `mysql_fetch_array`）：

```
SELECT AUTO_INCREMENT FROM information_schema.tables WHERE TABLE_NAME = 'table' 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-12-17T09:08:33.997

如果您通过编写选择查询直接获得最大数量，那么您的查询可能会给出错误的值。例如，如果您的表有 5 条记录，那么您的增量 id 将为 6，如果我删除第 5 条记录，您的表有 4 条记录，最大 id 为 4，在这种情况下，您将获得 5 作为下一个增量 id。为此，您可以从 mysql 定义本身获取信息。通过在php中编写以下代码

```
<?
$tablename      = "tablename";
$next_increment     = 0;
$qShowStatus        = "SHOW TABLE STATUS LIKE '$tablename'";
$qShowStatusResult  = mysql_query($qShowStatus) or die ( "Query failed: " . mysql_error() . "<br/>" . $qShowStatus );

$row = mysql_fetch_assoc($qShowStatusResult);
$next_increment = $row['Auto_increment'];

echo "next increment number: [$next_increment]";
?> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-08-20T04:30:09.593

`SELECT id FROM table ORDER BY id DESC LIMIT 1`可以返回最大 id 而不是自动递增 id。在某些情况下两者都不同

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-09-02T20:36:03.200

如果您没有“显示状态”的权限，那么最好的选择是创建两个触发器和一个新表，以保留十亿记录表的行数。

例子：

表 A >> 十亿条记录
表 B >> 1 列和 1 行

每当 TableA(InsertTrigger) 上有插入查询时，TableB 上的行值增加 1
每当 TableA(DeleteTrigger) 上有删除查询时，TableB 中的行值减 1

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-01T04:41:52.043

在 information_schema 建议旁边，这个：

```
SELECT id FROM table ORDER BY id DESC LIMIT 1 
```

也应该非常快，前提是 id 字段上有一个索引（我相信 auto_increment 必须是这种情况）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-10-16T09:45:15.723

```
$next_id = mysql_fetch_assoc(mysql_query("SELECT MAX(id) FROM table"));
$next_id['MAX(id)']; // next auto incr id 
```

希望它有帮助:)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-05-08T20:42:27.367

**控制器**

```
SomeNameModel::_getNextID($this->$table) 
```

**模型**

```
class SomeNameModel extends CI_Model{

private static $db;

function __construct(){
  parent::__construct();
  self::$db-> &get_instance()->db;
}

function _getNextID($table){
  return self::$db->query("SHOW TABLE STATUS LIKE '".$table."' ")->row()->Auto_increment;
}

... other stuff code

} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-07-16T01:05:37.890

这些答案似乎都不是很正确。我都试过了。这是我的结果。

```
Sending query: SELECT count(*) FROM daximation
91
Sending query: SELECT Auto_increment FROM information_schema.tables WHERE table_name='daximation'
96
Sending query: SHOW TABLE STATUS LIKE 'daximation'
98
Sending query: SELECT id FROM daximation ORDER BY id DESC LIMIT 1
97 
```

这是屏幕截图： [https ://www.screencast.com/t/s8c3trYU](https://www.screencast.com/t/s8c3trYU)

这是我的PHP代码：

```
$query = "SELECT count(*) FROM daximation"; 
$result = sendquery($query);
$row = mysqli_fetch_row($result);
debugprint( $row[0]);

$query = "SELECT Auto_increment FROM information_schema.tables WHERE table_name='daximation'"; 
$result = sendquery($query);
$row = mysqli_fetch_row($result);
debugprint( $row[0]);

$query = "SHOW TABLE STATUS LIKE 'daximation'"; 
$result = sendquery($query);
$row = mysqli_fetch_row($result);
debugprint( $row[10]);

$query = "SELECT id FROM daximation ORDER BY id DESC LIMIT 1"; 
$result = sendquery($query);
$row = mysqli_fetch_row($result);
debugprint( $row[0]); 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2011-09-29T02:19:29.240

难道你不能只在一个单独的表中创建一个记录，或者在一个名为“用户”的列中创建一个记录，然后用用户注册时最后插入的 id 更新它吗？

然后，您只需通过简单的查询检查该字段。

它可能很粗糙，但它会完美地工作。

# .net - WCF:: ServiceHost & AddServiceEndpoint: 参数类型是否颠倒？

> ID：933570
> 
> 赞同：1
> 
> 时间：2009-06-01T04:33:55.610
> 
> 标签：.net, wcf, servicehost

虽然我正在尝试学习 WCF，而且看起来很简单，但我遇到了一个奇怪的情况……至少在我看来这很奇怪。

为什么 ServiceHost ctor 采用具体类，而 AddServiceEndpoint 采用接口，反之则不然？从 OOP 的角度来看，后者似乎更合乎逻辑。

考虑以下：

```
 [ServiceContract]
    interface IVocalAnimal
    {
        [OperationContract]
        string MakeSound();
    }
  ...      
  public class Dog : IVocalAnimal
  {
     public string MakeSound()
     {
        return("Woof!");
     }
  }
 ...
 public class Cat : IVocalAnimal
  {
     public string MakeSound()
     {
        return("Meeooow!");
     }
  } 
```

所以现在我们要创建一个“AnimalSound”服务，您可以通过 /AnimalSoundService/Dog 或 /AnimalSoundService/Cat 连接来获取狗或猫的声音

```
...
Uri baseAddress = new Uri("net.pipe://localhost/AnimalSoundService");
ServiceHost serviceHost = new ServiceHost(typeof(IVocalAnimal), baseAddress);
serviceHost.AddServiceEndpoint(typeof(Dog), new NetNamedPipeBinding(NetNamedPipeSecurityMode.None), "Dog");
serviceHost.AddServiceEndpoint(typeof(Cat), new NetNamedPipeBinding(NetNamedPipeSecurityMode.None), "Cat");
... 
```

但是上面的代码由于某些原因无法编译，因为我不太明白，ServiceHost ctor 想要具体的类（所以是 Dog 或 Cat），而 EndPoint 想要接口。

那么它不是反之亦然的原因是什么，因为在我看来，更细粒度的端点支持特定的实现更自然（因此您可以针对每个端点地址命中合同的特定实现），而更通用的 ServiceHost 应该是一个接受接口？

顺便说一句，我不是迂腐……我只是诚实地试图理解，因为我确信是我在这里错过了一些东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T05:01:32.643

创建 ServiceHost 时，您正在创建实际的服务，因此它必须是具体的。

另一方面，您的端点就是您的客户所看到的。您不一定希望您的客户知道您的实现——他们应该只获得接口定义。

正如您所说，端点确实支持特定的实现：无论您在创建 ServiceHost 时使用哪个。端点的目的不是提供多个实现，而是提供多个协议/绑定来访问单个实现。

如果您想要不同的 Dog 和 Cat 服务，我相信您需要两个 ServiceHost，每个都有一个 NetNamedPipeBinding 端点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T05:24:04.517

我明白你在想什么。从 OOP 的角度来看，这是有道理的，但这不是服务的角度。服务是一组操作。该组操作在合同中定义。您可以使用类来为服务契约建模，但大多数使用接口，因为接口是一种更直接的模型。MSDN 对这些概念进行了[很好的讨论](http://msdn.microsoft.com/en-us/library/ms733070.aspx)。

记住，你不认识我，我也不认识你。我们交换消息，而不是对象。我不想要你的猫和狗。除非我们事先达成协议，否则我不知道如何处理你给我的猫或狗。你告诉我我能做什么，我会调用你的方法来做到这一点。这是一篇关于内部数据与外部数据的[好文章。](http://msdn.microsoft.com/en-us/library/ms954587.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T13:25:55.903

我不得不对其他答案有点不同意。虽然它们在某种程度上在技术上是正确的，但我认为最重要的原因是它与隐藏实现或使用类与接口来定义服务契约无关。

如果您考虑到单个服务实现可以公开多个端点的事实，那么为什么会这样就更明显了。如您所知，每个端点可能会或可能不会公开不同的合约，并且每个端点都可以在不同的绑定上公开。

例如，您可能有一项服务公开了一个通过 MSMQ 的单向契约和一个通过 HTTP 的双向契约。或者，它可能在一个 URL 上公开 JSON 合约，在另一个 URL 上公开 XML 合约。

# wcf - C5 集合库 - WCF 上的序列化问题

> ID：933572
> 
> 赞同：0
> 
> 时间：2009-06-01T04:34:57.840
> 
> 标签：wcf, serialization, c5

我正在尝试通过 WCF 从[C5 集合库](http://en.wikipedia.org/wiki/C5_Generic_Collection_Library_for_C_Sharp_and_CLI)发送 TreeDictionary 。它可以到达收件人那里（我必须为似乎是内部数据结构的东西添加很多 KnownType 属性）。但是，现在我陷入了失败的境地，因为它无法为`C5.KeyValuePair'2[typea,typeb]`.

这是因为 C5 类本身不能跨越 WCF（我很幸运能走到这一步）还是其他什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T12:53:38.947

C5 classes are indeed not designed to go across a serialization boundary. You have several options.

1.  Add a reference to the C5 libraries on your client side. This is not service oriented and will not work on anything but a .NET client at best. Not recommended.
2.  If possible, convert the dictionary to a regular .NET dictionary and return that. Your client ought to be able to receive this.

Good luck!

# c++ - 检查内存是否归零的最快方法

> ID：933581
> 
> 赞同：4
> 
> 时间：2009-06-01T04:43:41.963
> 
> 标签：c++, windows, linux

我有一个程序需要检查文件的一部分是否已清零或有数据。这个 alg 为整个文件运行，最多可以运行几场演出，并且需要一段时间才能运行。有没有更好的方法来检查它是否归零？

平台：Linux和windows

```
bool WGTController::isBlockCompleted(wgBlock* block)
{
    if (!block)
        return false;

    uint32 bufSize = (uint32)block->size;
    uint64 fileSize = UTIL::FS::UTIL_getFileSize(m_szFile);

    if (fileSize < (block->size + block->fileOffset))
        return false;

    char* buffer = new char[bufSize];

    FHANDLE fh=NULL;

    try
    {
        fh = UTIL::FS::UTIL_openFile(m_szFile, UTIL::FS::FILE_READ);
        UTIL::FS::UTIL_seekFile(fh, block->fileOffset);
        UTIL::FS::UTIL_readFile(fh, buffer, bufSize);
        UTIL::FS::UTIL_closeFile(fh);
    }
    catch (gcException &)
    {
        SAFE_DELETEA(buffer);
        UTIL::FS::UTIL_closeFile(fh);
        return false;
    }

    bool res = false;

    for (uint32 x=0; x<bufSize; x++)
    {
        if (buffer[x] != 0)
        {
            res = true;
            break;
        }
    }

    SAFE_DELETEA(buffer);
    return res;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-01T04:50:16.167

“一会儿”有多长？...我想说尝试并行比较尽可能多的值会有所帮助，也许使用一些 SIMD 指令一次比较超过 4 个字节？

但是请记住，无论您进行比较多快，最终仍需要从文件中读取数据。如果文件尚未在内存中某处的缓存中，那么在磁盘带宽饱和之前，您可能会被限制在最大 100-150 MB/s 的数量级。如果您已经达到了这一点，那么您可能首先需要研究一种避免加载文件的方法，或者只是接受它不会比这更快的事实。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T05:14:05.543

文件/块中是否有更可能具有非零值的地方？您只需要找到**一个**非零值（您的中断条件），因此首先查看您最有可能找到它们的位置 - 这不必是文件/块的开头。根据实际应用，从末尾开始或检查中间的 1/3 可能有意义。

但是，我不建议随机跳到不同的位置；从磁盘读取可能会变得难以置信;) ..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T05:24:33.050

我想看看这个函数的汇编输出。您可以做的可以大大加快速度的方法是使用 SSE 指令。使用这些指令，您可以一次加载 8 个字节，将它们全部检查为零并继续。您也可以多次展开该 for 循环。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T05:24:56.840

你的算法看起来不错，但是如果你事先知道你将得到什么类型的文件，你可以启发式地优化起始位置......但是如果它是一个特定的文件，很可能信息将在标题中（前几个字节）。

还要确保调用该方法的人的 block->size 不是 1 :)

还可以查看 Boost 的内存映射文件工具...这可能会有所帮助，具体取决于您如何计算最佳块-> 大小

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-01T06:01:58.390

我为您提供了“开箱即用”的答案，但我不确定在您的情况下实施的可行性。

如果您不控制转储过程：由于它是在特殊情况下生成的大型恢复（转储？）文件，为什么不在转储后立即以低优先级扫描文件（0字节）并以某种方式标记它以后识别速度快吗？（或者您可以压缩它并稍后解析/扫描 zip 文件）

或者，如果您控制转储过程：（无论如何都必须执行一个缓慢的过程）为什么不在转储文件的末尾指示（或返回并在它的开头写入），如果转储文件填充为 0 或有一些有效的数据（因为你写了它并且你知道里面有什么）？这样您就不必为 I/O 开销支付两次费用。

这里的目标是通过将过程推迟到另一个更早的时间来使读取速度更快，因为当转储发生时，不太可能有操作员等待它加载。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-01T16:12:35.500

首先，不要每次都分配一个新的缓冲区。分配一个（每个线程）并重用它。使用一个不错的大块，并进行多次读取/检查。
其次，不要比较每个字符。对更大的整数类型进行比较。您很可能需要 32 位 int，但根据您的操作系统/编译器，使用 64 位甚至 128 位 int 可能会更快。使用 32 位 int，您可以将比较次数减少 4 倍。当然，您的遗嘱必须担心最终条件。为此，很容易，如果您要比较的缓冲区不是您的 int 大小的偶数倍，只需在进行比较之前将最后 X 个字节设置为 0。第三，它可能会帮助您的编译器展开循环。在循环体中进行 4 或 8 次比较。这应该有助于编译器进行一些优化，并减少退出循环的比较次数。确保您的缓冲区是您的比较类型 x 循环中比较次数的倍数。第四，

对于其中的任何一个，您当然会想要获得一些指标，看看有什么实际帮助。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-01T22:28:59.313

我会告诉你一个肮脏、不可移植和困难的方法，但比它更有效......如果你正在处理稀疏文件，你真的很无聊并且想要弄乱你正在使用的文件系统的内部，您可以尝试添加一个新函数，该函数返回一个位图，指示哪些块已映射，哪些块未映射​​（未映射的块归零，其余部分仍需手动检查）。

是的，我知道这很疯狂，没有人愿意做这样的事情 xD

# c++ - 如何在不向子窗口发送 wm_paint 的情况下使父窗口无效？

> ID：933584
> 
> 赞同：1
> 
> 时间：2009-06-01T04:46:52.113
> 
> 标签：c++, windows, winapi, sdk, gdi

父窗口和子窗口大小相同。子重绘时父监听子重绘，父重绘。所以我不能使用 invalidate 来清理父窗口，因为这会将 wm_paint 发送到子窗口，然后是一个无限循环。

如何在不使用 invalidateRect、invalidateRgn 等的情况下清理父窗口。或者，如何在不将 wm_paint 发送到子窗口的情况下使父级无效？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T05:06:36.223

您可以`WS_CLIPCHILDREN`在窗口上设置样式，或尝试调用指定为最终参数的[RedrawWindow函数。](http://msdn.microsoft.com/en-us/library/ms913080.aspx)`RDW_NOCHILDREN`这可能会做你想做的事，尽管这有点难说。

# sql-server - 如何使用 SQL Server 显示从 raiserror() 生成的错误消息

> ID：933601
> 
> 赞同：4
> 
> 时间：2009-06-01T04:54:44.320
> 
> 标签：sql-server, raiserror

我正在通过 JDBC 从 jsp 与 SQL Server 2005 进行交互（这是一个分配，不是真正的项目），并且我在我正在使用的数据库中创建了一个触发器。如果在执行此触发器时不满足某个条件，我会通过 raiserror() 引发错误。我希望此错误显示在通过 JDBC 调用 SQL Server 查询的实际页面上，但目前当我打印出 SQLException.getMessage() 的结果时，我只收到以下默认消息：

事务在触发器中结束。该批次已中止。

有谁知道如何提取我在触发代码中实际传递给 raiserror 的文本？我已经尝试过：

*   SQLException.getState()
*   SQLException.getNextException()
*   SQLException.getCause()
*   SQLException.toString()

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-01T15:05:51.037

我想到了。这个问题与我在调用 raiserror() 时选择的严重性有关。我为此参数传递了 10，因为我看到了一个将 10 放在那里的示例，但是为了将错误文本传递给 SQLException，严重性必须为 11 或更高。更改严重性后，一切正常。如果其他人有类似的问题，我建议您尝试一下。此外，谷歌 JDBC 错误处理有用的文档（我会提交一个链接，但不允许新用户）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T05:27:58.960

您需要迭代使用 getNextException() 返回的所有异常

# .net - 将数据推送到 .NET 中的未知 Web 服务

> ID：933605
> 
> 赞同：0
> 
> 时间：2009-06-01T04:58:08.840
> 
> 标签：.net, web-services, rest, soap

大家好，这是我的要求：

我有一个中央应用程序，它接收来自其他应用程序的请求，执行某些操作，然后将数据返回到该应用程序。该数据最简单的形式是 XML 文档。

现在，在设计时，这个中央应用程序不知道哪些其他应用程序将发出请求。

每次 Central App 收到请求时，它也会收到一个 URL，告诉 Central App 它的 Web 服务地址（见下文），因此 Central App 知道将数据推送到哪里：

```
http://someapp1.com/UpdateData
http://someapp2.com/UpdateData 
```

现在，我想使用 SOAP 或某种 RESTful 实现，最好不要使用 WCF。

**我的问题是：**

1.  使用 SOAP，如果接口都相同，我可以在运行时动态更改服务 URL 吗？
2.  如果可以，那么我将如何以 RESTful 方式发布大量 XML？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T05:37:51.817

中央应用程序的工作是某种非常长时间运行的过程吗？否则，为什么 Central App 不公开只是将结果作为响应返回的 Web 方法，而不是发起一个新的调用？

someapp1 调用 Central.GetMyData(param) ... 中央进程 ... someapp1 从 Central 接收 SOAP 响应

这也将有助于解耦您的系统，该系统现在已设置，以便许多应用程序知道 Central 的 API，并且 Central 知道它应该向其他每个应用程序发送什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T06:04:08.527

第一点）当然可以更改 Web 服务代理在运行时与之交谈的端点。我相信它看起来像这样......

```
ws.Endpoint.Address = new System.ServiceModel.EndpointAddress( newurl ) 
```

在您的情况下，显然您的“中央应用程序”将调用代理，因为它将数据发送回您的“请求者/接收者”。

当您的请求者/接收者提出请求时，它将使用代理来调用中央应用程序，但我想在这种情况下，它不需要是动态的（只有一个“中央应用程序”对吗？）

第2点）不确定最聪明的方法是什么。当然，默认情况下，您从 WCF Web 服务发送/接收的消息始终是 XML。如果您希望服务合同保持不变，您将需要一个包装器对象来包含数据。我想您可以尝试创建一个具有“有效负载”成员的对象，该成员可以保存您的数据。

希望这可以帮助

迈克尔

# python - 获取/呈现一对多关系的最佳方式是什么？

> ID：933612
> 
> 赞同：2
> 
> 时间：2009-06-01T05:01:38.557
> 
> 标签：python, django

我有 2 个看起来像这样的模型：

```
class Entry(models.Model):
user = models.ForeignKey(User)
dataname = models.TextField()
datadesc = models.TextField()
timestamp = models.DateTimeField(auto_now=True)

class EntryFile(models.Model):
    entry = models.ForeignKey(Entry)
    datafile = models.FileField(upload_to="uploads/%Y/%m/%d/%H-%M-%S") 
```

我想为特定用户呈现所有条目及其相关文件。现在，在我看来，我正在这样做以获取值：

```
 entries = Entry.objects.filter(user=request.user).order_by("-timestamp")
    files = {}
    for entry in entries:
        entryfiles = EntryFile.objects.filter(entry=entry)
        files[entry] = entryfiles
    return render_to_response("index.html", {'user': request.user, 'entries': entries, 'files': files, 'message': message}) 
```

但我不能/不知道如何在我的模板中使用这些数据。这是我现在所做的，但不起作用：

```
{% for entry in entries %}
    <td>{{ entry.datadesc }}</td>
    <td><table>
        {{ files.entry }}
        {% for file in files.entry %}
        <td>{{ file.datafile.name|split:"/"|last }}</td>
        <td>{{ file.datafile.size|filesizeformat }}</td>
        <td><a href="{{ object.datafile.url }}">download</a></td>
        <td><a href="{% url main.views.delete object.id %}">delete</a></td>
        {% endfor %}
    </table></td>
{% endfor %} 
```

任何人都可以告诉我我是否以正确的方式在视图中执行此操作，然后如何在模板中访问这些数据？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-01T05:13:44.873

只需将您的视图代码剪切到这一行：

```
entries = Entry.objects.filter(user=request.user).order_by("-timestamp") 
```

并在模板中执行此操作：

```
{% for entry in entries %}
    <td>{{ entry.datadesc }}</td>
    <td><table>
    {% for file in entry.entryfile_set.all %}
        <td>{{ file.datafile.name|split:"/"|last }}</td>
        <td>{{ file.datafile.size|filesizeformat }}</td>
        <td><a href="{{ object.datafile.url }}">download</a></td>
        <td><a href="{% url main.views.delete object.id %}">delete</a></td>
    {% endfor %}
    </table></td>
{% endfor %} 
```

但是，我非常喜欢在模型中使用[`related_name`](http://docs.djangoproject.com/en/dev/topics/db/queries/#following-relationships-backward)，因此您可以更改此行：

```
entry = models.ForeignKey(Entry) 
```

对此：

```
entry = models.ForeignKey(Entry, related_name='files') 
```

然后您可以通过更改以下内容来访问特定条目的所有文件：

```
{% for file in files.entryfile_set.all %} 
```

为了更易读/更明显：

```
{% for file in entry.files.all %} 
```

# c# - 如何使用 Assert 来验证是否引发了异常？

> ID：933613
> 
> 赞同：911
> 
> 时间：2009-06-01T05:01:53.873
> 
> 标签：c#, unit-testing, mstest, assert, vs-unit-testing-framework

如何使用`Assert`（或其他 Test 类）来验证是否引发了异常？

* * *

## 回答 #1

> 赞同：1056
> 
> 时间：2009-06-01T05:09:23.320

对于“Visual Studio Team Test”，您似乎将 ExpectedException 属性应用于测试的方法。

此处文档中的示例：[使用 Visual Studio Team Test 进行单元测试演练](http://msdn.microsoft.com/en-us/library/ms379625(VS.80).aspx#vstsunittesting_topic5)

```
[TestMethod]
[ExpectedException(typeof(ArgumentException),
    "A userId of null was inappropriately allowed.")]
public void NullUserIdInConstructor()
{
   LogonInfo logonInfo = new LogonInfo(null, "P@ss0word");
} 
```

* * *

## 回答 #2

> 赞同：273
> 
> 时间：2009-06-01T05:06:54.727

通常你的测试框架会对此给出答案。但如果它不够灵活，你可以随时这样做：

```
try {
    somethingThatShouldThrowAnException();
    Assert.Fail(); // If it gets to this line, no exception was thrown
} catch (GoodException) { } 
```

正如@Jonas 指出的那样，这不适用于捕获基本异常：

```
try {
    somethingThatShouldThrowAnException();
    Assert.Fail(); // raises AssertionException
} catch (Exception) {
    // Catches the assertion exception, and the test passes
} 
```

如果您绝对必须捕获异常，则需要重新抛出 Assert.Fail()。但实际上，这表明你不应该手写这个；检查你的测试框架的选项，或者看看你是否可以抛出一个更有意义的异常来测试。

```
catch (AssertionException) { throw; } 
```

您应该能够根据自己的喜好调整这种方法——包括指定要捕获的异常类型。如果您只期望某些类型，请使用以下命令完成`catch`块：

```
} catch (GoodException) {
} catch (Exception) {
    // not the right kind of exception
    Assert.Fail();
} 
```

* * *

## 回答 #3

> 赞同：123
> 
> 时间：2011-04-12T11:20:45.543

我首选的实现方法是编写一个名为 Throws 的方法，并像使用任何其他 Assert 方法一样使用它。不幸的是，.NET 不允许您编写静态扩展方法，因此您不能使用此方法，就好像它实际上属于 Assert 类中的构建一样；只需制作另一个名为 MyAssert 或类似的东西。该类如下所示：

```
using System;
using Microsoft.VisualStudio.TestTools.UnitTesting;

namespace YourProject.Tests
{
    public static class MyAssert
    {
        public static void Throws<T>( Action func ) where T : Exception
        {
            var exceptionThrown = false;
            try
            {
                func.Invoke();
            }
            catch ( T )
            {
                exceptionThrown = true;
            }

            if ( !exceptionThrown )
            {
                throw new AssertFailedException(
                    String.Format("An exception of type {0} was expected, but not thrown", typeof(T))
                    );
            }
        }
    }
} 
```

这意味着您的单元测试如下所示：

```
[TestMethod()]
public void ExceptionTest()
{
    String testStr = null;
    MyAssert.Throws<NullReferenceException>(() => testStr.ToUpper());
} 
```

它的外观和行为更像您的单元测试语法的其余部分。

* * *

## 回答 #4

> 赞同：94
> 
> 时间：2013-12-04T11:02:29.527

如果你使用 NUNIT，你可以这样做：

```
Assert.Throws<ExpectedException>(() => methodToTest()); 
```

也可以存储抛出的异常以进一步验证它：

```
ExpectedException ex = Assert.Throws<ExpectedException>(() => methodToTest());
Assert.AreEqual( "Expected message text.", ex.Message );
Assert.AreEqual( 5, ex.SomeNumber); 
```

请参阅： http: [//nunit.org/docs/2.5/exceptionAsserts.html](http://nunit.org/docs/2.5/exceptionAsserts.html)

* * *

## 回答 #5

> 赞同：63
> 
> 时间：2009-06-01T05:10:19.323

如果您使用的是最初没有`ExpectedException`属性的 MSTest，您可以这样做：

```
try 
{
    SomeExceptionThrowingMethod()
    Assert.Fail("no exception thrown");
}
catch (Exception ex)
{
    Assert.IsTrue(ex is SpecificExceptionType);
} 
```

* * *

## 回答 #6

> 赞同：53
> 
> 时间：2016-10-18T16:03:10.947

MSTest (v2) 现在有一个 Assert.ThrowsException 函数，可以像这样使用：

```
Assert.ThrowsException<System.FormatException>(() =>
            {
                Story actual = PersonalSite.Services.Content.ExtractHeader(String.Empty);
            }); 
```

您可以使用 nuget 安装它：`Install-Package MSTest.TestFramework`

* * *

## 回答 #7

> 赞同：36
> 
> 时间：2009-06-01T05:22:42.443

小心使用 ExpectedException，因为它可能导致如下所示的几个陷阱：

[http://geekswithblogs.net/sdorman/archive/2009/01/17/unit-testing-and-expected-exceptions.aspx](http://geekswithblogs.net/sdorman/archive/2009/01/17/unit-testing-and-expected-exceptions.aspx)

和这里：

[http://xunit.github.io/docs/comparisons.html](http://xunit.github.io/docs/comparisons.html)

如果您需要测试异常情况，那么就没有那么多不受欢迎的方法了。您可以使用该`try{act/fail}catch{assert}`方法，该方法对于不直接支持除`ExpectedException`.

一个更好的选择是使用 xUnit.NET，它是一个非常现代、前瞻性和可扩展的单元测试框架，它从所有其他错误中吸取了教训，并得到了改进。一个这样的改进是`Assert.Throws`，它为断言异常提供了更好的语法。

你可以在 github 上找到[xUnit.NET：http://xunit.github.io/](http://xunit.github.io/)

* * *

## 回答 #8

> 赞同：24
> 
> 时间：2010-10-01T21:13:12.910

在我正在做的一个项目中，我们有另一个解决方案。

首先，我不喜欢 ExpectedExceptionAttribute，因为它确实考虑了导致异常的方法调用。

我用一个辅助方法来代替。

**测试**

```
[TestMethod]
public void AccountRepository_ThrowsExceptionIfFileisCorrupt()
{
     var file = File.Create("Accounts.bin");
     file.WriteByte(1);
     file.Close();

     IAccountRepository repo = new FileAccountRepository();
     TestHelpers.AssertThrows<SerializationException>(()=>repo.GetAll());            
} 
```

**辅助方法**

```
public static TException AssertThrows<TException>(Action action) where TException : Exception
    {
        try
        {
            action();
        }
        catch (TException ex)
        {
            return ex;
        }
        Assert.Fail("Expected exception was not thrown");

        return null;
    } 
```

整洁，不是吗；）

* * *

## 回答 #9

> 赞同：16
> 
> 时间：2018-11-01T10:38:18.253

您可以通过简单的一行来实现这一点。

如果您的操作`foo.bar()`是异步的：

```
await Assert.ThrowsExceptionAsync<Exception>(() => foo.bar()); 
```

如果`foo.bar()`不是异步的

```
Assert.ThrowsException<Exception>(() => foo.bar()); 
```

* * *

## 回答 #10

> 赞同：15
> 
> 时间：2009-06-01T05:09:18.700

它是测试方法的一个属性......你不使用 Assert。看起来像这样：

```
[ExpectedException(typeof(ExceptionType))]
public void YourMethod_should_throw_exception() 
```

* * *

## 回答 #11

> 赞同：13
> 
> 时间：2015-04-07T23:11:14.127

您可以使用以下方法从 Nuget 下载包：**PM> Install-Package MSTestExtensions**，它将nUnit/xUnit 样式的*Assert.Throws()语法添加到 MsTest。*

高级说明：下载程序集并从*BaseTest*继承，您可以使用*Assert.Throws()*语法。

Throws 实现的主要方法如下所示：

```
public static void Throws<T>(Action task, string expectedMessage, ExceptionMessageCompareOptions options) where T : Exception
{
    try
    {
        task();
    }
    catch (Exception ex)
    {
        AssertExceptionType<T>(ex);
        AssertExceptionMessage(ex, expectedMessage, options);
        return;
    }

    if (typeof(T).Equals(new Exception().GetType()))
    {
        Assert.Fail("Expected exception but no exception was thrown.");
    }
    else
    {
        Assert.Fail(string.Format("Expected exception of type {0} but no exception was thrown.", typeof(T)));
    }
} 
```

披露：我把这个包放在一起。

更多信息：[http ://www.bradoncode.com/blog/2012/01/asserting-exceptions-in-mstest-with.html](http://www.bradoncode.com/blog/2012/01/asserting-exceptions-in-mstest-with.html)

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2017-06-26T22:50:35.537

在 VS 内置单元测试中，如果您只是想验证是否抛出了“任何异常”，但您不知道类型，您可以使用 catch all：

```
[TestMethod]
[ExpectedException(typeof(Exception), AllowDerivedTypes = true)]
public void ThrowExceptionTest()
{
    //...
} 
```

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2014-08-01T16:14:06.280

我不建议使用 ExpectedException 属性（因为它太受约束且容易出错）或在每个测试中编写 try/catch 块（因为它太复杂且容易出错）。使用设计良好的断言方法——要么由您的测试框架提供，要么自己编写。这是我编写和使用的内容。

```
public static class ExceptionAssert
{
    private static T GetException<T>(Action action, string message="") where T : Exception
    {
        try
        {
            action();
        }
        catch (T exception)
        {
            return exception;
        }
        throw new AssertFailedException("Expected exception " + typeof(T).FullName + ", but none was propagated.  " + message);
    }

    public static void Propagates<T>(Action action) where T : Exception
    {
        Propagates<T>(action, "");
    }

    public static void Propagates<T>(Action action, string message) where T : Exception
    {
        GetException<T>(action, message);
    }

    public static void Propagates<T>(Action action, Action<T> validation) where T : Exception
    {
        Propagates(action, validation, "");
    }

    public static void Propagates<T>(Action action, Action<T> validation, string message) where T : Exception
    {
        validation(GetException<T>(action, message));
    }
} 
```

示例用途：

```
 [TestMethod]
    public void Run_PropagatesWin32Exception_ForInvalidExeFile()
    {
        (test setup that might propagate Win32Exception)
        ExceptionAssert.Propagates<Win32Exception>(
            () => CommandExecutionUtil.Run(Assembly.GetExecutingAssembly().Location, new string[0]));
        (more asserts or something)
    }

    [TestMethod]
    public void Run_PropagatesFileNotFoundException_ForExecutableNotFound()
    {
        (test setup that might propagate FileNotFoundException)
        ExceptionAssert.Propagates<FileNotFoundException>(
            () => CommandExecutionUtil.Run("NotThere.exe", new string[0]),
            e => StringAssert.Contains(e.Message, "NotThere.exe"));
        (more asserts or something)
    } 
```

笔记

返回异常而不是支持验证回调是一个合理的想法，只是这样做会使这个断言的调用语法与我使用的其他断言非常不同。

与其他人不同，我使用“传播”而不是“抛出”，因为我们只能测试异常是否从调用传播。我们无法直接测试是否引发了异常。但我想你可以想象 throws 的意思是：被抛出而不是被抓住。

最后的想法

在切换到这种方法之前，我考虑在测试仅验证异常类型时使用 ExpectedException 属性，如果需要更多验证，则使用 try/catch 块。但是，我不仅要考虑每次测试使用哪种技术，而且随着需求的变化将代码从一种技术更改为另一种技术也不是一件容易的事。使用一种一致的方法可以节省脑力。

所以总而言之，这种方法具有：易用性、灵活性和鲁棒性（很难做错）。

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2012-09-14T20:12:52.450

好吧，我会总结一下这里其他人之前所说的话......无论如何，这是我根据好的答案构建的代码:) 剩下要做的就是复制和使用......

```
/// <summary>
/// Checks to make sure that the input delegate throws a exception of type TException.
/// </summary>
/// <typeparam name="TException">The type of exception expected.</typeparam>
/// <param name="methodToExecute">The method to execute to generate the exception.</param>
public static void AssertRaises<TException>(Action methodToExecute) where TException : System.Exception
{
    try
    {
        methodToExecute();
    }
    catch (TException) {
        return;
    }  
    catch (System.Exception ex)
    {
        Assert.Fail("Expected exception of type " + typeof(TException) + " but type of " + ex.GetType() + " was thrown instead.");
    }
    Assert.Fail("Expected exception of type " + typeof(TException) + " but no exception was thrown.");  
} 
```

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2013-04-05T00:02:33.393

上面@Richiban 提供的帮助器效果很好，只是它不处理抛出异常的情况，但不是预期的类型。以下解决了：

```
using System;
using Microsoft.VisualStudio.TestTools.UnitTesting;

namespace YourProject.Tests
{
    public static class MyAssert
    {
        /// <summary>
        /// Helper for Asserting that a function throws an exception of a particular type.
        /// </summary>
        public static void Throws<T>( Action func ) where T : Exception
        {
            Exception exceptionOther = null;
            var exceptionThrown = false;
            try
            {
                func.Invoke();
            }
            catch ( T )
            {
                exceptionThrown = true;
            }
            catch (Exception e) {
                exceptionOther = e;
            }

            if ( !exceptionThrown )
            {
                if (exceptionOther != null) {
                    throw new AssertFailedException(
                        String.Format("An exception of type {0} was expected, but not thrown. Instead, an exception of type {1} was thrown.", typeof(T), exceptionOther.GetType()),
                        exceptionOther
                        );
                }

                throw new AssertFailedException(
                    String.Format("An exception of type {0} was expected, but no exception was thrown.", typeof(T))
                    );
            }
        }
    }
} 
```

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2016-02-05T18:07:23.523

由于您提到使用其他测试类，比`ExpectedException`属性更好的选择是使用[Shoudly](https://github.com/shouldly/shouldly)的[Should.Throw](http://docs.shouldly-lib.net/docs/shouldthrow)。

```
Should.Throw<DivideByZeroException>(() => { MyDivideMethod(1, 0); }); 
```

假设我们要求*客户*必须有一个*地址*才能创建*订单*。如果不是，该`CreateOrderForCustomer`方法应该导致`ArgumentException`. 然后我们可以写：

```
[TestMethod]
public void NullUserIdInConstructor()
{
  var customer = new Customer(name := "Justin", address := null};

  Should.Throw<ArgumentException>(() => {
    var order = CreateOrderForCustomer(customer) });
} 
```

这比使用`ExpectedException`属性要好，因为我们要明确什么应该引发错误。这使我们测试中的要求更加清晰，并且在测试失败时也使诊断更加容易。

注意还有一个`Should.ThrowAsync`用于异步方法测试。

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2016-12-14T12:17:14.673

作为替代方案，您可以尝试测试异常实际上是在测试中的下两行引发的。

```
var testDelegate = () => MyService.Method(params);
Assert.Throws<Exception>(testDelegate); 
```

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2019-01-21T11:39:46.513

有一个很棒的库，叫做[NFluent](http://www.n-fluent.net/)，它*可以加快并简化您编写断言的方式*。

编写一个抛出异常的断言非常简单：

```
 [Test]
    public void given_when_then()
    {
        Check.ThatCode(() => MethodToTest())
            .Throws<Exception>()
            .WithMessage("Process has been failed");
    } 
```

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2009-06-01T05:09:59.667

这将取决于您使用的是什么测试框架？

例如，在 MbUnit 中，您可以使用属性指定预期的异常，以确保获得您真正期望的异常。

```
[ExpectedException(typeof(ArgumentException))] 
```

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2009-06-01T05:10:14.270

查看[nUnit Docs](http://www.nunit.org/index.php?p=exception&r=2.4.1)以获取有关以下内容的示例：

```
[ExpectedException( typeof( ArgumentException ) )] 
```

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2017-05-05T05:39:19.700

如果使用**NUnit**，试试这个：

```
Assert.That(() =>
        {
            Your_Method_To_Test();
        }, Throws.TypeOf<Your_Specific_Exception>().With.Message.EqualTo("Your_Specific_Message")); 
```

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2021-08-16T13:18:58.960

我知道这个线程很旧并且有很多很好的答案，但也许值得一提的是本地函数可以以非常简单的方式提供帮助。

```
//Arrange

//Act
void LocalFunction() => mr.ActualMethod(params);

//Assert
Assert.Throws<Exception>(LocalFunction); 
```

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2015-09-11T19:56:49.020

尽管这是一个老问题，但我想在讨论中添加一个新想法。我已经将 Arrange, Act, Assert 模式扩展为 Expected, Arrange, Act, Assert。您可以创建一个预期的异常指针，然后断言它被分配给。这感觉比在 catch 块中执行 Asserts 更干净，让 Act 部分主要只用于一行代码来调用被测方法。您也不必`Assert.Fail();`往返`return`于代码中的多个点。抛出的任何其他异常都将导致测试失败，因为它不会被捕获，并且如果抛出了您预期类型的​​异常，但它不是您所期望的，则针对消息或其他属性断言异常有助于确保您的测试不会意外通过。

```
[TestMethod]
public void Bar_InvalidDependency_ThrowsInvalidOperationException()
{
    // Expectations
    InvalidOperationException expectedException = null;
    string expectedExceptionMessage = "Bar did something invalid.";

    // Arrange
    IDependency dependency = DependencyMocks.Create();
    Foo foo = new Foo(dependency);

    // Act
    try
    {
        foo.Bar();
    }
    catch (InvalidOperationException ex)
    {
        expectedException = ex;
    }

    // Assert
    Assert.IsNotNull(expectedException);
    Assert.AreEqual(expectedExceptionMessage, expectedException.Message);
} 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2021-10-26T11:50:40.333

这适用于 处理数据库或 http 事务时的*Visual Studio Team Test*（又名**MSTest**） 。
系统应该在某处抛出异常，使用**Assert.ThrowExceptionAsync<>()**将捕获您的 Throw 事件。（在这些情况下，**Assert.ThrowException<>()**不会捕获异常）。

```
 [TestMethod]
   public void Invalid_Input_UserName_Should_Throw_Exception()
   {
       await Assert.ThrowExceptionAsync<ExpectedExceptionType>(()=> new LogonInfo(InvalidInputInUserNameFormat,"P@ssword"));
   } 
```

# javascript - Safari 使用 jQuery 返回不正确的宽度

> ID：933614
> 
> 赞同：0
> 
> 时间：2009-06-01T05:01:56.777
> 
> 标签：javascript, jquery, safari

这是我的 jQuery 有问题的部分

```
var tickerWidth = 0;
var padding = 10;
firstList.find('li').each(function() {

            $(this).append(' &mdash;');
            tickerWidth += $(this).width() + padding;  

           $('body').prepend($(this).width() + '<br />');

        }); 
```

`firstList`是一个包含`ul`元素的变量。当我在 Firefox 中运行它时，我正确地计算出宽度并将其打印到我的页面上。但是，在 Safari 中，我得到的宽度要窄得多——大约是`&mdash;`没有插入的宽度……这是某种竞争条件吗？

有什么办法可以对抗这种情况吗？也许先循环并插入html实体，然后再次循环以计算宽度？

谢谢

**编辑**

我确实先循环，插入html实体，然后再循环，但值仍然不正确......

我也尝试过`outerWidth()`，但没有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T05:18:30.220

好的，我可以正确计算它，尽管它有点难看。

我没有插入实体，而是`append()`像这样插入它

```
 $(this).html($(this).html() + ' &mdash;'); 
```

这工作正常。

# c# - 如何在 C# 中合成和输出简单的声波？

> ID：933617
> 
> 赞同：4
> 
> 时间：2009-06-01T05:03:18.867
> 
> 标签：c#, windows, audio

如果你有口齿不清，请不要试图说出我的标题。

但是，是的，对于更复杂的锯齿波和其他波，生成简单或奖励的最简单方法是什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-01T05:26:43.983

根据我的经验，[.wav 文件格式](http://www.sonicspot.com/guide/wavefiles.html)（[Wikipedia 条目](http://en.wikipedia.org/wiki/WAV)列出了提供文件格式的其他文档；使用您认为最好的文件格式）是最简单且广泛使用的格式。编写未压缩的 PCM 非常容易。

对于正弦波和锯齿波之类的东西，我会将任务分为采样和文件制作。所以你可能有一个界面，例如：

```
public interface IWave
{       
    double Sample(double time);
} 
```

where`Sample`将给出一个大于 0（但可能大于 1）的时间，并且应该返回一个介于 -1 和 1 之间的值。（您可以为此使用委托。）然后编写一个文件生成器来创建一个基于采样持续时间（例如“100000 波”）和采样频率（例如 50000 Hz）。

那么这只是一个`IWave`适当实施的例子——例如一个返回`sin(time / (2 * pi))`简单正弦波或`(time % 1.0) * 2 - 1`锯齿波的版本。对于额外的娱乐，您可以编写合成函数来加速或减慢波浪，放大它，合并其他波浪等。当然，文件生成器不需要知道*任何*这些。它只需要取一个*并* `IWave`对其进行适当次数的采样，将 [-1, 1] 范围适当地缩放到 [0, 255]。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T09:11:12.563

只是为了详细说明 Jon 已经说过的内容-您所做的只是创建一个 8 位（即字节 [1024]）或 16 位缓冲区并将其填充（即对于方波，它是 [255 255 255 255 0 0 0 0 255 255 255 255 0 0 0 0]）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-11-22T08:51:39.620

查看[此问题](https://stackoverflow.com/questions/203890/creating-sine-or-square-wave-in-c)以获取有关如何在 C# 中生成正弦波的示例代码。将其扩展到方波或锯齿波将非常容易。您可以通过将简单波形混合在一起来生成更复杂的波形。

如果需要，您还可以使用[NAudio](http://naudio.codeplex.com) `WaveFileWriter`类将生成的数据写入 WAV 文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-03T16:58:44.647

有一篇 Charles Petzold 文章[Simple Electronic Music Sequencer for Silverlight](http://www.charlespetzold.com/blog/2009/07/Simple-Electronic-Music-Sequencer-for-Silverlight.html) 基于 Gilles Khouzam 的博客文章[Playing back Wave files in Silverlight](http://blogs.msdn.com/b/gillesk/archive/2009/03/23/playing-back-wave-files-in-silverlight.aspx)和 Pete Brown[在 Silverlight 3 Beta 中使用 MediaStreamSource 创建声音](http://10rem.net/blog/2009/03/23/creating-sound-using-mediastreamsource-in-silverlight-3-beta)。Mike Hodnick 有一篇有用的博客文章，其中包含基于 Petzold 文章的示例代码，称为[Windows Phone 7 上的数字音频合成](http://kindohm.com/blog/2010/08/03/digital-audio-synthesis-on-windows-phone-7/)。

在主窗口的 XAML 中，Mike 引入了一个媒体元素

```
<MediaElement x:Name="media"/> 
```

然后使用该`SetSource`方法将媒体元素源设置为他正在构建的wave

```
this.media.SetSource(new TonesSource());
this.media.Play(); 
```

Mike 的`ToneSource`子类是他的子类，而他的子`BaseSource`类`MediaStreamSource`又覆盖了它的几个方法：`OpenMediaAsync`, `GetSampleAsync`, `SeekAsync`, `CloseMedia`,`GetDiagnosticAsync`和`SwitchMediaStreamAsync`. [MSDN 文档](http://msdn.microsoft.com/en-us/library/system.windows.media.mediastreamsource%28v=vs.95%29.aspx)中有更多关于它们的信息；Mike 的代码本身并不长，但涉及到位移和写入内存流，值得[在 Mike 的博客文章中提供的源代码中](http://kindohm.com/files/WP7AudioSynthesisDemo.zip)查看。

然后迈克的`ToneSource`班级提供立体声样本

```
protected override StereoSample GetSample()
{
    short left = 0;
    short right = 0;

    foreach (var oscillator in this.leftOscillators)
        left += oscillator.GetNextSample();

    foreach (var oscillator in this.rightOscillators)
        right += oscillator.GetNextSample();

    return new StereoSample() { Left = left, Right = right };
} 
```

使用他的`Oscillator`课

```
public short GetNextSample()
{
    ushort wholePhaseAngle = (ushort)(phaseAngle >> 16);
    short amplitude = 0;
    amplitude = (short)(short.MaxValue * Math.Sin(2 * Math.PI * wholePhaseAngle / ushort.MaxValue));
    amplitude = (short)((amplitude * multiplier) >> 16);
    phaseAngle += phaseAngleIncrement;

    return amplitude;
} 
```

`NoiseSource`迈克还提供比他的更简单`ToneSource`

```
protected override StereoSample GetSample()
{
    return new StereoSample()
    {
        Left = (short)random.Next(short.MinValue, short.MaxValue),
        Right = (short)random.Next(short.MinValue, short.MaxValue)
    };
} 
```

# asp.net - 调用 page_clientvalidate() 方法后服务器控件事件不起作用

> ID：933620
> 
> 赞同：-1
> 
> 时间：2009-06-01T05:06:33.150
> 
> 标签：asp.net, javascript

当我使用 javascript 调用 Page_ClientValidate('Add1') 函数时，asp.net 事件的服务器控件不起作用。'Add1' 是验证组。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T06:04:50.850

请提供一些示例代码并更好地解释“asp.net 事件的服务器控件不起作用”的含义。

同时，这里有一些应该如何使用的[示例代码：](http://weblogs.asp.net/srkirkland/archive/2008/02/13/using-asp-net-validation-from-client-code.aspx)`Page_ClientValidate(validationGroup)`

```
<asp:TextBox runat="server" ID="tbHours" Width="50px"></asp:TextBox>
<asp:RequiredFieldValidator ID="rvalAddHours" runat="server" ControlToValidate="tbHours" ValidationGroup="AddEntry" ErrorMessage="* Hours Required" Display="Dynamic"></asp:RequiredFieldValidator>
<asp:RangeValidator ID="rgValAddHours" runat="server" ControlToValidate="tbHours" ValidationGroup="AddEntry" ErrorMessage="* Hours Must Be 0-24" Display="Dynamic" Type="Double" MinimumValue="0" MaximumValue="24"></asp:RangeValidator>
<asp:Button ID="btnAddEntry" runat="server" OnClientClick="ValidateAndAddNewEntry(); return false;" CausesValidation="true" ValidationGroup="AddEntry" Text="Create" />

<script type="text/javascript>
 function ValidateAndAddNewEntry() {
    var res = Page_ClientValidate("AddEntry");    
    if ( res == true ) {
        //Do work
    }
 }
</script> 
```

# hosting - 云计算：建立云需要什么

> ID：933624
> 
> 赞同：18
> 
> 时间：2009-06-01T05:08:20.420
> 
> 标签：hosting, cloud

设置云需要什么。我在中东有一些朋友想要设置类似于 Google 和 Amazon 的云，并且想知道是否有任何开放技术可以用来设置云托管服务。有任何想法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-01T05:18:16.490

以下是一些开源云服务器：

*   [http://www.eucalyptus.cloud](http://www.eucalyptus.cloud)
*   [http://www.enomaly.com/](http://www.enomaly.com/)
*   [http://sourceforge.net/projects/eyeos/](http://sourceforge.net/projects/eyeos/)（半“云”）

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-06-01T05:19:09.127

你应该看看[桉树](http://www.eucalyptus.com/)。Eucalyptus 的目标是允许您设置自己的私有云，类似于 Amazon 的 EC2。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-08-26T18:53:53.090

软件很重要，没有任何公开可用的软件可以复制您在 Google、Microsoft 或 Amazon 中找到的软件。微软在他们的基础设施方面写得最多。[AutoPilot](http://research.microsoft.com/apps/pubs/default.aspx?id=64604)和[云成本](http://www.mvdirona.com/jrh/TalksAndPapers/CostOfClouds_CCR.pdf)是两篇有趣的论文。成本的真正部分将是数据中心的设计和建设。所需的计算机数量并非微不足道。需要明确的是，我不认为由 5000 台机器组成的单个集群是云。许多 5000 台机器的集群是一个云。此外，云应该对数据中心故障具有弹性，因此可能应该至少有两个数据中心。

除了地理位置之外，他们还有什么理由想要拥有自己的而不使用 EC2 或 Azure？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-06-06T20:25:52.717

最近 VMWare 宣布了 Cloud Foundry。Cloud Foundry 既是一个商业产品，也是一个开源项目。[cloudfoundry.com](http://www.cloudfoundry.com)是商业服务的网站。开源项目位于[cloudfoundry.org](http://www.cloudfoundry.org)，源代码在[github 上](https://github.com/cloudfoundry)。

到目前为止，我所看到的表明，由 cloudfoundry 开发的云软件以及相应的服务更像是一种[PaaS](http://en.wikipedia.org/wiki/Platform_as_a_service)产品，而不是[IaaS](http://en.wikipedia.org/wiki/Infrastructure_as_a_Service#Infrastructure)。考虑到 VMWare 的核心优势是虚拟化这一事实，这可能看起来令人惊讶。

[根据您的要求，您可以通过将 Cloud Foundry 的 OSS 与Eucalyptus](http://www.eucalyptus.com/)等其他开源 IaaS 软件相结合来构建您自己的完整堆栈，从而构建整个云解决方案。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-01T05:16:26.260

“云”是一个经常被误解的术语。

任何在互联网上进行任何工作的计算机都可以称为云。这只是对“在其他地方”完成的计算机工作的隐喻。

也许您的意思是[分布式计算](http://en.wikipedia.org/wiki/Distributed_computing)？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-12-02T20:30:03.880

Rackspace 的解决方案集在[OpenStack](http://openstack.org)上运行。

# c# - Best way to handle data within windows mobile 6 program

> ID：933644
> 
> 赞同：0
> 
> 时间：2009-06-01T05:19:36.443
> 
> 标签：c#, windows-mobile

I am making a small project for myself that deals with gps and some other cool stuff on WM6 in C#. I am just wondering, is it better to read from a file when you need to access the data or is it better to just read the whole file into the program and deal with it then? Mainly, I am talking about locations that I will save within some type of file/database, not quite sure which one yet. These locations will need to be looped over frequently and that's why I think I should read the whole file in and then write back to it later, but how much data becomes too much? Are there any efficiency issues that could arise from reading in lots of data from a file opposed to the obvious efficiency issues from reading the next value from a file as needed? It doesn't really make too much difference at this stage since I will probably never get lots and lots of data, but it is good to think about scalability at some stage I suppose.

Cheers

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-01T05:45:37.763

Shane is right on the mark, store the data in a SQLCE database and use paramatized querys to access what you need from there.

As for memory usage, WM6 (and 6.5) is based on WinCE 5.something

WinCE 5.* has this annoying design where there is no concept of virtual memory, memory is split up into 32mb slots and applications are only allocated a single slot - in effect your application can only use 32mb of memory. Sure there are hacks out there to get around this but this is still a fundamental limit.

You really dont need to be too concerned about using too much memory - always call dispose, only keep around what you need to keep around, and learning how to use '.NETCF Remote Performance Monitor' which has saved my a$$ on ocassion.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T05:33:06.067

I would recommend some sort of database. No matter what the platform, it just makes things easier.

I can look into [SQL Server Compact](http://www.microsoft.com/Sqlserver/2005/en/us/compact.aspx) or Windows Mobile [EDB](http://msdn.microsoft.com/en-us/library/aa916024.aspx) database api. The SQL Server Compact is most likely to be easier to use in C#.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T06:03:58.450

as well as the other suggestions is [db4Objects](http://www.db4o.com/) it has a lightweight compact framework version (just download the .NET version and you also get a compact framework version).

# list - 多列 CSS 列表

> ID：933645
> 
> 赞同：7
> 
> 时间：2009-06-01T05:19:54.227
> 
> 标签：list, css

有没有办法做**可重排的**多列列表，列表可以有**不同高度的列表项，**只使用有效的 CSS？通过可重排，我的意思是当用户将窗口拖得更宽或更窄时，当列表项具有固定宽度时，列数应该自动调整。

我看过[A List Apart](http://www.alistapart.com/articles/multicolumnlists/)上的文章，但他们的解决方案都不符合所有这些（看似简单的）要求。乍一看，我认为 CCS3 对多列列表的提议也没有（因为看起来你必须指定列数）。

如果有帮助，我根本不*关心*IE6，只关心 IE7。我的目标受众是早期采用者、精通网络的类型。

**更新：**更仔细地查看 CSS3 规范，*应该*指定列宽，但实际上，我遇到了溢出等问题。有人用这个东西IRL吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-01T14:14:33.013

## 原帖

实际上，单个命令对我有用（尽管它有`-webkit-`版本`-moz-`）：

```
div.wrapper 
{
    -webkit-column-width: 10em;
    -moz-column-width: 10em;
} 
```

以下是提高可读性的附加规则。将下面和上面的代码插入 A List Apart 文章的示例中（如果有人清除版权，我可以粘贴整个 HTML）并享受：

```
div.wrapper {       
    border: 2px solid blue;
    -webkit-column-rule: 2px solid blue;
    -moz-column-rule: 2px solid blue;
}

.wrapper ol {
    margin: 0;
}

.wrapper br {
    display: none; /* Extra BR is unnecessary there */
} 
```

已测试：Safari 4 (4528.17)、Fx 3.5b4 /Mac。

**请注意**，前段时间第一次遇到*列宽属性时，我完全错过了它确实重新平衡的关键事实。*现在在[W3C](http://www.w3.org/TR/css3-multicol/#CSS3PAGE)发现它并通过[Surfin' Safari](http://webkit.org/blog/88/css3-multi-column-support/)确认。

## 附录：固定列数

正如我从澄清中了解到的那样，列的宽度应该随着页面的宽度而变化，所以命令更像

```
div.wrapper 
{
    -webkit-column-count: 3;
    -moz-column-count: 3;
} 
```

## 附录：垂直滚动

现在你说应该有一个垂直滚动条。由于没有 UI 可以在每一列的右侧单独设置滚动条，我想您会想到一个可以滚动整个多列列表的滚动条。这可以通过再包装一个来`div`完成

```
div.morewrap 
{
     height: 50%; /* whatever you need */
     overflow-y: scroll; 
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T15:51:19.173

使用[CSS 多列布局](https://developer.mozilla.org/en-US/docs/CSS/Using_CSS_multi-column_layouts)，可以指定列数（调整大小时会变宽或变窄）**或**列宽（调整大小时会导致添加或删除新列）：

```
ul li {
    margin-left: 1em; /* needed to preserve bullets */
    column-break-inside: avoid; /* don't forget this */
}
ul {
    list-style: outside disc;
    padding-left: 0.5em;
    column-width: 150px; /* actually the minimum width */
} 
```

[http://jsfiddle.net/mblase75/XtzLF/](http://jsfiddle.net/mblase75/XtzLF/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T05:23:02.630

不是通过纯 CSS，不。某处可能有一个JavaScript实现，但我不知道你描述的任何流畅的实现。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-07-29T21:52:05.677

我意识到这是一篇旧帖子，但我刚刚在我的项目上开始工作，而 Ilya 的解决方案对我不起作用（尽管我可能错过了一些东西）。无论如何，问题在于 CSS3 列（现在是候选推荐）溢出想要通过创建额外的列向右移动，如果你有溢出：自动你最终会得到一个水平滚动条，而不是垂直滚动条（ OP想要的，我也想要）。我通过将包含列的 div （使用 -moz-column-count 集）包装在另一个 div 中来解决此问题，并使用 overflow-y:auto 设置该列的高度。这意味着外部 div 可以垂直滚动，而带有列的内部 div 具有所需的高度，并且不需要水平溢出。

我希望有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-07T14:39:06.913

我最近需要在项目中使用多列列表。我们正在使用 CSS3 列，并在此过程中遇到了几个小问题。我在这里发表了一篇关于它的文章：http: [//bit.ly/css3lists](http://bit.ly/css3lists)

它的短处是这样的：

1.  只设置列数和之间的宽度，而不是列宽。
2.  如果您不希望内容跨越多个列，则需要添加一些额外的标记以使列表正确呈现。

# java - Java中二维数组的Dijkstra算法

> ID：933656
> 
> 赞同：7
> 
> 时间：2009-06-01T05:25:55.403
> 
> 标签：java, algorithm, multidimensional-array, dijkstra

这是一个学校项目；我遇到了很多麻烦，我似乎找不到可以理解的解决方案。

```
 a b c d e z
 a - 2 3 - - -
 b 2 - - 5 2 -
 c 3 - - - 5 -
 d - 5 - - 1 2
 e - 2 5 1 - 4
 z - - - 2 4 - 
```

那就是二维数组。因此，如果您想找到最短路径，它从 a,b,e,d,z = 7 和 (a,b) = (b,a) 开始 - 它会将您带到新行以获取该行的相邻行路径

有没有人可以帮我实现这个例子的 Dijkstra 算法？我真的很感激。（我似乎最喜欢数组，地图和集合让我有点困惑，列表是可管理的——尽管我现在愿意研究任何类型的解决方案）

[至少我不只是从网络上抄袭来源。我真的很想学习这些东西......这真的很难（>.<）]

哦，起点是A，终点是Z

* * *

和大多数人一样，我认为算法的概念并不难——我只是可以看到正确的编码......请帮忙？

示例代码——一个朋友帮了我很多（尽管它充满了我发现难以理解的数据结构）我也尝试过调整来自 dreamincode.net/forums/blog/martyr2/index.php 的 C++ 代码？ showentry = 578 进入java，但这并不顺利......

```
import java.util.*;

public class Pathy{

    private static class pathyNode{
        public final String name;
        public Map<pathyNode, Integer> adjacentNodes;

        public pathyNode(String n){
            name = n;
            adjacentNodes = new HashMap<pathyNode, Integer>();
        }

    }

    //instance variables

    //constructors

    //accessors

    //methods
    public static ArrayList<pathyNode> convert(int[][] inMatrix){
        ArrayList<pathyNode> nodeList = new ArrayList<pathyNode>();
        for(int i = 0; i < inMatrix.length; i++){
            nodeList.add(new pathyNode("" + i));
        }
        for(int i = 0; i < inMatrix.length; i++){
            for(int j = 0; j < inMatrix[i].length; j++){
                if(inMatrix[i][j] != -1){
                    nodeList.get(i).adjacentNodes.put(nodeList.get(j),
                            new Integer(inMatrix[i][j]));
                }
            }
        }
        return nodeList;
    }

    public static Map<pathyNode, Integer> Dijkstra(ArrayList<pathyNode> inGraph){
        Set<pathyNode> visited = new HashSet<pathyNode>();
        visited.add(inGraph.get(0));
        pathyNode source = inGraph.get(0);
        Map answer = new TreeMap<pathyNode, Integer>();
        for(pathyNode node : inGraph){
            dijkstraHelper(visited, 0, source, node);
            answer.put(node, dijkstraHelper(visited, 0, source, node));
        }
        return answer;
    }

    private static int dijkstraHelper(Set<pathyNode> visited, int sum, pathyNode start, pathyNode destination){
        Map<pathyNode, Integer> adjacent = new HashMap<pathyNode, Integer>();

        for(pathyNode n : visited){
            for(pathyNode m: n.adjacentNodes.keySet()){
                if(adjacent.containsKey(m)){
                    Integer temp = n.adjacentNodes.get(m);
                    if(temp < adjacent.get(m)){
                        adjacent.put(m, temp);
                    }
                }
                else{
                    adjacent.put(m, n.adjacentNodes.get(m));
                }
            }
        }

        Map<pathyNode, Integer> adjacent2 = new HashMap<pathyNode, Integer>();
        Set<pathyNode> tempSet = adjacent.keySet();
        tempSet.removeAll(visited);
        for(pathyNode n: tempSet){
            adjacent2.put(n, adjacent.get(n));
        }
        adjacent = adjacent2;
        Integer min = new Integer(java.lang.Integer.MAX_VALUE);
        pathyNode minNode = null;

        for(pathyNode n: adjacent.keySet()){
            Integer temp = adjacent.get(n);
            if(temp < min){
                min = temp;
                minNode = n;
            }
        }
        visited.add(minNode);
        sum += min.intValue();
        sum = dijkstraHelper(visited, sum, start, destination);
        return sum;
    }

    //main
    public static void main(String[] args){

        int[][] input = new int[][] { {-1, 2, 3, -1, -1, -1},
                          {2, -1, -1, 5, 2, -1},
                          {3, -1, -1, -1, 5, -1},
                          {-1, 5, -1, -1, 1, 2},
                          {-1, 2, 5, 1, -1, 4},
                          {-1, -1, -1, 2, 4, -1},
                        };
                        //-1 represents an non-existant path

        System.out.println(Dijkstra(convert(input)));
    }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-01T07:59:23.457

The representation that you are calling 2D array, is the Adjacency matrix representation of a graph and the problem you are trying to solve is an instance of 'Single-Source Shortest Paths' problem. Dijkstra's algorithm is designed to solve this type of problem. This might be helpful [http://renaud.waldura.com/doc/java/dijkstra/](http://renaud.waldura.com/doc/java/dijkstra/). Download the code from the site and read the documentation. Basically you will need to write code similar to following

```
 RoutesMap map = map =  new DenseRoutesMap(5);
    map.addDirectRoute(City.A, City.B, 2);
    map.addDirectRoute(City.A, City.C, 3);
    map.addDirectRoute(City.B, City.A, 2);
    map.addDirectRoute(City.B, City.D, 5);
    map.addDirectRoute(City.B, City.D, 2);
    ...
    DijkstraEngine engine = new DijkstraEngine(map);
    int distance = engine.getShortestDistance(City.F); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-07-26T13:27:20.847

不知道是否有人仍然对 Dijikstra 的这种矩阵表示感兴趣，但我一直在考虑在 Actionscript 中编码 Dijikstra，因此首先必须自学 Dijuikstra 是如何工作的。完成此操作并尝试对其进行编码后，我昨晚才意识到我可以表示节点和矩阵中的距离，例如您在这篇文章顶部的矩阵。我的理论是，找到最短路径将是一件非常简单的事情。我仍在尝试以确保我正确。

在矩阵中；

abcdeza - 2 3 - - - b 2 - - 5 2 - c 3 - - - 5 - d - 5 - - 1 2 e - 2 5 1 - 4 z - - - 2 4 -

我开始查看行“a”（因为这是起点）并选择行中最小的数字为 2（在 b 下）。所以我将路径写为“a - b”，成本为 2。然后我转到 b 行并再次找到 b 右侧的最小数字（因为我们已经在 b 节点。这给了我 2 下“e”。所以路径现在是“a - b - e”，总成本为 4。i 然后查看“e”行，规则应该是找到出现在“e”列之后的最小数字。这将给我“z”，并给出完整路径为“a - b - e - z”，总成本为 8。但是，请记住，我昨晚才发现这一点，该方法需要在查看时认识到“e”行的另一种可能性是以 1 的成本进入 d 列。

因此，这是一个更好的解决方案，路径为“a - b - e - d -z”，总成本为 7，正如您所说的那样。

好的，我仍然需要在 Actionscript 中编写代码，但我的直觉是在 Actionscript 中编写代码会很容易。恐怕我没有 Java 经验，但如果你同意我的方法，用 Java 编写代码应该很容易。

保罗

# legacy - 通过脚本驱动遗留的交互式 DOS 应用程序

> ID：933658
> 
> 赞同：1
> 
> 时间：2009-06-01T05:27:21.800
> 
> 标签：legacy

我需要用 GUI 包装一个交互式 DOS 应用程序。DOS 应用程序不接受任何命令行参数。因此，所有工作都必须以交互方式完成。

完成工作的过程如下： 1\. 在 DOS 命令提示符下启动 DOS 应用程序。2\. 出现一个屏幕，要求我们“按任意键开始” 3\. 按任意键会导致“菜单 1”，我们会在其中选择：[C] .. 创建新文件 [L] .. 加载现有文件file [Q] .. Quite Program 4\. 按'L'键会进入另一个屏幕，显示加载项目文件的默认驱动器。如果驱动不是你想要的，“按[空格键]更改驱动” 5\. 按“回车”确认驱动 6\. 显示所有相关工程文件，我们可以使用 up-down-left-right箭头导航并按 Enter 加载文件。7\. 交互过程继续进行，直到生成文本输出。

我没有 DOS 应用程序的源代码。

是否有任何可用的工具可以让我通过定义文件来驱动整个过程。这样的工具将允许我开发一个 GUI 来完成这项工作，而无需用户与旧的 DOS 应用程序交互。

谢谢。大卫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T05:41:16.913

可能是您最简单的选择是使用[Quick Test Pro](http://en.wikipedia.org/wiki/HP_QuickTest_Professional)进行自动化。如果您不关心屏幕上显示的内容，您可以使用 SendKeys 功能输入按键。您可以使用来自任何 Microsoft 语言/环境的 SendKeys。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T06:50:46.107

您可能可以使用 Windows Script Host 和[SendKeys](http://msdn.microsoft.com/en-us/library/8c6yea83(VS.85).aspx)方法来执行此操作。这是来自 MSDN 的 VBScript 示例：

```
Set WshShell = WScript.CreateObject("WScript.Shell")
WshShell.Run "calc"
WScript.Sleep 100
WshShell.AppActivate "Calculator"
WScript.Sleep 100
WshShell.SendKeys "1{+}"
WScript.Sleep 500
WshShell.SendKeys "2"
WScript.Sleep 500
WshShell.SendKeys "~"
WScript.Sleep 500
WshShell.SendKeys "*3"
WScript.Sleep 500
WshShell.SendKeys "~"
WScript.Sleep 2500 
```

# asp.net - ASP.NET中的超链接控件和链接控件有什么区别？

> ID：933663
> 
> 赞同：14
> 
> 时间：2009-06-01T05:30:20.250
> 
> 标签：asp.net

超链接控件和链接控件 ASP.NET 有什么区别？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-06-01T05:35:21.117

两个控件的目的是相同的。但这两者之间有一个主要区别，即HTML超链接控件是一种HTML控件，只要单击它，页面就会导航到目标页面。ASP.NET Link Button 控件是一个服务器控件，只要用户单击它，请求就会重定向回服务器，并在其响应中将页面导航到目标页面。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-01-22T09:11:53.123

当用户单击控件时，HyperLink 控件会立即导航到目标 URL。表单不会发布到服务器。

LinkBut​​ton 控件首先将表单发布到服务器，然后导航到 URL。如果您需要在访问目标 URL 之前进行任何服务器端处理，请使用 LinkBut​​ton。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-01T05:40:24.743

该`<asp:Hyperlink>`控件是 Web 服务器控件，而`<a>`链接是基本的 HTML 控件。

与所有 WebControl 一样，前者提供了功能齐全的编程事件模型，而后者允许您呈现 HTML 锚点。您可以将`runat="server"`属性添加到链接控件以使其能够在服务器端代码中访问。但是，控件需要此属性（因为它是在 HTML`Hyperlink`中呈现为超链接的 ASP.NET 对象。`<a>`

# .net - .NET XML 序列化没有文本声明

> ID：933664
> 
> 赞同：20
> 
> 时间：2009-06-01T05:30:48.190
> 
> 标签：.net, xml-serialization, .net-2.0

我正在尝试像这样生成 XML：

```
<?xml version="1.0"?>
<!DOCTYPE APIRequest SYSTEM
"https://url">
<APIRequest>
  <Head>
      <Key>123</Key>
  </Head>
  <ObjectClass>
    <Field>Value</Field
  </ObjectClass>
</APIRequest> 
```

我有一个用 XMLSerialization 属性装饰的类（ObjectClass），如下所示：

```
[XmlRoot("ObjectClass")]
public class ObjectClass
{
    [XmlElement("Field")]
    public string Field { get; set; }
} 
```

我真正的直觉想法是让这个工作在我序列化时做到这一点：

```
ObjectClass inst = new ObjectClass();
XmlSerializer serializer = new XmlSerializer(inst.GetType(), "");

StringWriter w = new StringWriter();
w.WriteLine(@"<?xml version=""1.0""?>");
w.WriteLine("<!DOCTYPE APIRequest SYSTEM");
w.WriteLine(@"""https://url"">");
w.WriteLine("<APIRequest>");
w.WriteLine("<Head>");
w.WriteLine(@"<Field>Value</Field>");
w.WriteLine(@"</Head>");

XmlSerializerNamespaces ns = new XmlSerializerNamespaces();
ns.Add("", ""); 
serializer.Serialize(w, inst, ns);

w.WriteLine("</APIRequest>"); 
```

但是，这会生成这样的 XML：

```
<?xml version="1.0"?>
<!DOCTYPE APIRequest SYSTEM
"https://url">
<APIRequest>
  <Head>
      <Key>123</Key>
  </Head>
  <?xml version="1.0" encoding="utf-16"?>
  <ObjectClass>
    <Field>Value</Field>
  </ObjectClass>
</APIRequest> 
```

即 serialize 语句自动添加 <?xml 文本声明。

我知道我在攻击这个错误所以有人可以指出我正确的方向吗？

作为一个注释，我认为只创建一个带有 ObjectClass 的 APIRequest 类是没有实际意义的（因为据说有 20 种不同类型的 ObjectClass，每个都需要这个样板），但如果我是，请纠正我错误的。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2010-09-17T08:21:49.427

试试这个：

```
internal static string ToXml(object obj)
{
  string retval = null;
  if (obj != null)
  {
    StringBuilder sb = new StringBuilder();
    using(XmlWriter writer = XmlWriter.Create(sb, new XmlWriterSettings() { OmitXmlDeclaration = true }))
    {
      new XmlSerializer(obj.GetType()).Serialize(writer, obj);
    }
    retval = sb.ToString();
  }
  return retval;
} 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-06-01T05:54:18.683

永远不要使用字符串连接构建 xml。这是邪恶的。

输出：

```
<?xml version="1.0" encoding="utf-16"?>
<!DOCTYPE APIRequest SYSTEM "https://url">
<APIRequest>
  <Head>
    <Key>123</Key>
  </Head>
  <ObjectClass>
    <Field>Value</Field>
  </ObjectClass>
</APIRequest> 
```

代码：

```
using System;
using System.Diagnostics;
using System.Text;
using System.Xml;
using System.Xml.Serialization;

public static class Program {
    public static void Main() {
        var obj = new ObjectClass { Field = "Value" };

        var settings = new XmlWriterSettings {
            Indent = true
        };

        var xml = new StringBuilder();
        using (var writer = XmlWriter.Create(xml, settings)) {
            Debug.Assert(writer != null);

            writer.WriteDocType("APIRequest", null, "https://url", null);
            writer.WriteStartElement("APIRequest");
            writer.WriteStartElement("Head");
            writer.WriteElementString("Key", "123");
            writer.WriteEndElement(); // </Head>

            var nsSerializer = new XmlSerializerNamespaces();
            nsSerializer.Add("", "");

            var xmlSerializer = new XmlSerializer(obj.GetType(), "");
            xmlSerializer.Serialize(writer, obj, nsSerializer);

            writer.WriteEndElement(); // </APIRequest>
        }

        Console.WriteLine(xml.ToString());
        Console.ReadLine();
    }
}

[XmlRoot("ObjectClass")]
public class ObjectClass {
    [XmlElement("Field")]
    public string Field { get; set; }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-05-03T03:07:14.083

如果您出于性能等原因不想依赖 xml 编写器，您可以这样做：

```
// Read into memory stream and set namespaces to empty strings
XmlSerializerNamespaces nsSerializer = new XmlSerializerNamespaces();
nsSerializer.Add(string.Empty, string.Empty);
XmlSerializer xs = new XmlSerializer(typeof(Model.AudioItem));
xs.Serialize(ms, item, nsSerializer);

// Read into UTF-8 stream and read off first line (i.e "<?xml version="1.0"?>")
StreamReader sr = new StreamReader(ms);
ms.Position = 0;
sr.ReadLine(); 
```

sr.ReadToEnd().ToString() 现在包含裸序列化

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-05T12:33:50.150

派生您自己的 XmlTextWriter 以省略 XML 声明。

```
Private Class MyXmlTextWriter
Inherits XmlTextWriter
Sub New(ByVal sb As StringBuilder)
    MyBase.New(New StringWriter(sb))
End Sub
Sub New(ByVal w As TextWriter)
    MyBase.New(w)
End Sub

Public Overrides Sub WriteStartDocument()
    ' Don't emit XML declaration
End Sub
Public Overrides Sub WriteStartDocument(ByVal standalone As Boolean)
    ' Don't emit XML declaration
End Sub
End Class 
```

使用派生的 MyXmlTextWriter 的实例调用 Serialize。

```
Dim tw As New MyXmlTextWriter(sb)
Dim objXmlSerializer As New XmlSerializer(type)
objXmlSerializer.Serialize(tw, obj) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-07-31T01:37:50.543

[Scott Hanselman 在这方面](http://www.hanselman.com/blog/XmlFragmentWriterOmitingTheXmlDeclarationAndTheXSDAndXSINamespaces.aspx)有一篇很好的文章。不久前，我使用了 Kzu 的示例（Scott 的博客指出），效果很好。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2016-01-19T11:21:26.893

```
if (!string.IsNullOrEmpty(strXML) && strXML.Contains(@"<?xml"))
strXML = strXML.Remove(0, strXML.IndexOf(@"?>", 0) + 2); 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2010-01-14T13:19:46.380

一个衬里，从字符串中删除第一行：

```
String.Join("\n", strXML.Split('\n').Skip(1).ToArray()) 
```

不优雅，但简洁。

# optimization - 将字符串映射到值的最佳数据结构是什么？

> ID：933666
> 
> 赞同：0
> 
> 时间：2009-06-01T05:32:04.257
> 
> 标签：optimization, data-structures, dictionary, map

我对解释每种情况下最好的答案感兴趣。

特别是最适合：

*   几个值
*   很多价值观
*   许多值，只有少数被广泛使用
*   只读或几乎只读的地图
*   多写地图
*   无需检索的快速成员资格
*   具有大值的内存占用
*   其他

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-01T05:46:52.567

如果存储的值少于 100 个并且不存储超过 100 个符号的值，则应使用 Map/Dictionary 对象。如果需要更多，最好使用数据库存储。

读/写操作的数量无关紧要。

# sql - 设计 SQL 替代方案？

> ID：933667
> 
> 赞同：5
> 
> 时间：2009-06-01T05:33:00.653
> 
> 标签：sql, lisp, scheme, innodb, dsl

我正在考虑设计和实现我自己的 SQL 等效 (DDL+DML)，即...

1.  纯关系代数语言，以及
2.  具有优雅的类似于 Lisp-/Scheme 的语法

假设一个 RDBMS，如 MySQL，我究竟需要从哪里开始我的语言设计工作？在 InnoDB 等存储引擎层之上？

我不知道所有 RDBMS 功能通常位于存储引擎之上吗？我目前直观的理解是，创建 RDBMS（例如 MySQL）所需的大部分工作已经在存储引擎中完成（特别是在 InnoDB 中），您需要做的就是创建一个包装语言它。但我也知道，如果这是真的，为什么 MySQL 会存在！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-01T07:21:53.907

如果你真的用 lisp 编写它应该不会花很长时间。大约一个下午，我用 Lisp 写了一个简单的数据库引擎。这是它的外观示例：

```
(select movies (<= 1990 year 2000) (member director '(terry-gilliam tim-burton))) 
```

这里，'select' 是一个宏。它扫描其后面的谓词以查找作为字段名称的符号，并将它们绑定到数据库中的字段。然后它编写一个函数，将这些字段绑定到传递给函数的记录值，并使用该函数过滤表。宏扩展为如下内容：

```
(flet ((filter (item)
        (let ((year (movie-year item))
              (director (movie-director item)))
         (and (<= 1990 year 2000)
              (member director '(terry-gilliam tim-burton))))))
 (loop for item in movies
       if (filter item) collect item)) 
```

以这种方式（实际上是在 Lisp 中，而不仅仅是使用类似 Lisp 的语法）这样做很酷的事情是您可以免费获得编译。在我的系统上，上面的代码不是由数据库引擎解释的，它实际上是程序的编译部分（在 C 中不能这样做，现在可以吗？）。因此它很快，即使数据库代码本身（“选择”和表定义的代码）只有几行长。该数据库完全驻留在内存中，但这没关系......您可以更改宏以适应外部数据库，甚至编写它确实使用索引。这对于我正在从事的项目来说已经足够好了，所以我没有添加索引或任何花哨的东西。

我最喜欢它的部分是，虽然它保留了 SQL 的所有简洁性，但代码与它周围的代码没有什么不同，因为它都是 Lisp。您可以在搜索词中引入变量，而不必担心引用它们。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-01T05:54:32.803

我怀疑解决此问题的最佳方法是在您的语言和 SQL 之间创建一个转换器，主要是因为您无法从 rdbms 获得比通过其 SQL 方言提供的功能更多的功能。

MySQL 的存在与存储引擎的工作难度无关，MySQL 中的[存储引擎](http://dev.mysql.com/tech-resources/articles/storage-engine/part_1.html)真正完成了大部分繁重的工作，让 MySQL 解析和优化 SQL 并从引擎中检索数据，尊重相应的语义引擎。

大多数 rdbms 不会向用户/管理员公开存储引擎，因此在这方面 MySQL 有点独特，这使得创建翻译器更加合理，这样您就可以（通过更改一些语法规则）使用多个 rdbms通过您的应用程序。

此外，您可能无法在现有数据库技术上生成纯关系语言，请查看[The Third Manifesto](http://thethirdmanifesto.com/)了解更多信息。

说了这么多，我真的会先看看所有现有的 SQL 包装器，也许[有些会适合你的口味](http://en.wikipedia.org/wiki/SQL#Alternatives_to_SQL)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T06:37:22.590

许多 rdbms 产品传统上都是基于 isam 包构建的——mysql 就是一个明显的例子。它们都在指定表和索引、迭代行等级别上操作；具有处理读、写、锁等的基本设施。

此外，出于竞争原因，大多数 isam 产品都需要在顶部添加 SQL 层。您可以开始搜索那些 SQL 层可能可用的示例。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-01T11:25:06.037

在*Practical Common Lisp*中，[本章](http://www.gigamonkeys.com/book/practical-a-simple-database.html)旨在为音乐数据库提供一个简单的 RDBS 样式接口。可能有帮助。

# ssis - SSIS 中的行计数转换

> ID：933673
> 
> 赞同：0
> 
> 时间：2009-06-01T05:39:37.757
> 
> 标签：ssis

我正在使用“行计数”组件来计算数据流中的行数。我已经标记了一个名为 In_rec 的新变量。但它没有填充正确的行数。请让我知道相同的输入列属性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T05:42:16.457

你是什​​么意思它没有填充正确的行数？您是否尝试在数据流任务之外读取变量并且不能？您的范围设置是否正确（即，如果您尝试在另一个任务中访问它，不仅仅是数据流任务）？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-10-24T15:21:26.940

嗨，您是否尝试将变量分配给行计数转换的变量名属性。这就是您如何获得在运行时保留在包中的行数的值。

# c++ - 递归类型转换

> ID：933680
> 
> 赞同：1
> 
> 时间：2009-06-01T05:42:46.083
> 
> 标签：c++, casting

我得到了一个典型的'vector4'类，它带有一个操作符float*，可以为gl*4fv和[]自动转换它。还有用于优化编译器的“const”版本以及 const 引用，这很好用：

```
typedef struct vec4
{
    ...

    // ----------------------------------------------------------------- //

        // Cast operator, for []
    inline operator float* () { 
        return (float*)this;
    }

        // Const cast operator, for const []
    inline operator const float* () const { 
        return (const float*)this;
    }

    // ----------------------------------------------------------------- //

    ...

        // Vertex / Vector 
    struct {
        float x, y, z, w;
    };  

            // Color
    struct {
        float r, g, b, a;
    };
} vec4; 
```

我的问题是，当我现在使用支持从矩阵中提取行的运算符 vec4* 编写“matrix4”类时，并且还具有矩阵 [][] 运算符的“副作用”，这很好。

```
typedef struct mat4
{
    ...

    // ----------------------------------------------------------------- //
            // Cast operator, for []
    inline operator vec4* () { 
        return (vec4*)this;
    }

        // Const cast operator, for const []
    inline operator const vec4* () const { 
        return (const vec4*)this;
    }
    // ----------------------------------------------------------------- //

    private:
        float f[16];
} mat4; 
```

我的问题是，为什么编译器没有检测到将 mat4 转换为 float* 的能力？我怀疑 mat4 -> vec4 -> float* 的继承是合理的，但似乎并非如此。我想到编译器可能会将其视为未定义的 mat4 -> vec4* -> float* ，但该假设是无效的，因为定义了运算符

```
inline operator const vec4 () const { 
    return (vec4)*this;
} 
```

不起作用，并调用 glMultMatrixf(mat4(...)); （例如）产生与没有运算符时相同的错误消息。

在 mat4 中定义运算符 float* 当然是不可能的，因为这将消除使用 [][] 的能力（模棱两可的运算符）

有什么解决方案吗？还是每次我想自动转换为浮动*时都必须手动转换为 vec4？自动投射是一个非常好的功能，它巧妙地用 OpenGL 插入代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T05:54:40.977

C++ 可以执行自动转换，但按照标准不会执行两次连续的自动转换。

它被认为太有利于无意中的错误和歧义。

可能对您有用的三个选项：

**当您需要`float*`来自矩阵的 a 时，您自己显式地执行第一次强制转换。**

```
FuncThatWantsFloatPointer( *static_cast<Vec4*>(MyMatrix) ); 
```

**`float*`在您的矩阵类中实现直接转换。**

```
typedef struct mat4
{
        ...
        operator const float* () const
        { 
                return *static_cast<Vec4*>(*this);
        }

} mat4; 
```

**`operator[]`如果您喜欢使用方括号表示法，请在矩阵和向量类中实现**

```
typedef struct mat4
{
        ...
        const vec4& operator[] ( size_t index ) const
        { 
                return static_cast<Vec4*>(*this)[index];
        }

} mat4; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T08:01:40.410

...其中一个规则是不允许任何转换序列包含多个用户定义的转换（即，对单个争论构造函数或隐式类型转换运算符的调用）。- 更有效的 C++，Scott Meyers

您可能希望为 vec4 和 mat4 重载 operator[]。

```
struct vec4
{
    float& operator[](int index) { return f[index]; }
    const float& operator[](int index) const { return f[index]; }

    operator float*() { return f; }
    operator const float*() const { return f; }

    float f[4];
};

struct mat4 
{
    vec4& operator[](int row) { return v[row]; }
    const vec4& operator[](int row) const { return v[row]; }

    operator float*() { return f; }
    operator const float*() const { return f; }

    union
    {
        vec4 v[4];
        float f[16];
    };
};

int main(void)
{
    mat4 m;
    ::memset(&m, 0, sizeof(mat4));
    m[0][1] = 1;
    cout << m[0][1] << endl; // it prints 1.

    return 0;
} 
```

# parsing - RSS/Atom 提要中最重要的元素

> ID：933686
> 
> 赞同：1
> 
> 时间：2009-06-01T05:47:18.570
> 
> 标签：parsing, rss, elements, atom-feed

我们正在构建一个“按需”提要解析服务 ( [http://superfeedr.com](http://superfeedr.com) )，开发人员可以直接将其插入到他们自己的应用程序中。我们无需构建您自己的提要解析模块并花费数天时间来设置和维护它，而是为您完成“艰苦”的工作，我们的服务会以实时和标准 ATOM 格式向您发送更新。

到目前为止，当我们解析提要时，我们只提取并发送条目*标题*、*链接*、*发布日期*和*摘要*。

您希望从我们的提要解析器中收到哪些其他元素？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T05:59:46.320

作者姓名。

# c# - 使用 XmlDocument 读取 XML 属性

> ID：933687
> 
> 赞同：83
> 
> 时间：2009-06-01T05:49:52.607
> 
> 标签：c#, .net, xml, xmldocument

如何使用 C# 的 XmlDocument 读取 XML 属性？

我有一个看起来像这样的 XML 文件：

```
<?xml version="1.0" encoding="utf-8" ?>
<MyConfiguration xmlns="http://tempuri.org/myOwnSchema.xsd" SuperNumber="1" SuperString="whipcream">
    <Other stuff />
</MyConfiguration> 
```

我将如何读取 XML 属性 SuperNumber 和 SuperString？

目前我正在使用 XmlDocument，并且我得到了使用 XmlDocument 之间的值，`GetElementsByTagName()`并且效果非常好。我只是不知道如何获得属性？

* * *

## 回答 #1

> 赞同：119
> 
> 时间：2009-06-01T05:58:10.770

```
XmlNodeList elemList = doc.GetElementsByTagName(...);
for (int i = 0; i < elemList.Count; i++)
{
    string attrVal = elemList[i].Attributes["SuperString"].Value;
} 
```

* * *

## 回答 #2

> 赞同：89
> 
> 时间：2009-06-01T06:07:14.497

您应该查看[XPath](https://www.w3schools.com/xml/xpath_intro.asp)。一旦你开始使用它，你会发现它比遍历列表更高效、更容易编写代码。它还可以让你直接得到你想要的东西。

然后代码将类似于

```
string attrVal = doc.SelectSingleNode("/MyConfiguration/@SuperNumber").Value; 
```

请注意，XPath 3.0 于 2014 年 4 月 8 日成为 W3C 推荐标准。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-06-01T07:23:33.887

您可以迁移到 XDocument 而不是 XmlDocument，然后如果您更喜欢该语法，请使用 Linq。就像是：

```
var q = (from myConfig in xDoc.Elements("MyConfiguration")
         select myConfig.Attribute("SuperString").Value)
         .First(); 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-06-05T10:50:39.080

我有一个 XML 文件 books.xml

```
<ParameterDBConfig>
    <ID Definition="1" />
</ParameterDBConfig> 
```

程序：

```
XmlDocument doc = new XmlDocument();
doc.Load("D:/siva/books.xml");
XmlNodeList elemList = doc.GetElementsByTagName("ID");     
for (int i = 0; i < elemList.Count; i++)     
{
    string attrVal = elemList[i].Attributes["Definition"].Value;
} 
```

现在，`attrVal`具有 的值`ID`。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-06-01T05:53:48.967

`XmlDocument.Attributes`也许？（它有一个方法 GetNamedItem 可能会做你想要的，虽然我一直只是迭代属性集合）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-03-17T19:55:43.643

假设您的示例文档在字符串变量中`doc`

```
> XDocument.Parse(doc).Root.Attribute("SuperNumber")
1 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-03-01T19:47:02.297

如果您的 XML 包含命名空间，那么您可以执行以下操作来获取属性的值：

```
var xmlDoc = new XmlDocument();

// content is your XML as string
xmlDoc.LoadXml(content);

XmlNamespaceManager nsmgr = new XmlNamespaceManager(new NameTable());

// make sure the namespace identifier, URN in this case, matches what you have in your XML 
nsmgr.AddNamespace("ns", "urn:oasis:names:tc:SAML:2.0:protocol");

// get the value of Destination attribute from within the Response node with a prefix who's identifier is "urn:oasis:names:tc:SAML:2.0:protocol" using XPath
var str = xmlDoc.SelectSingleNode("/ns:Response/@Destination", nsmgr);
if (str != null)
{
    Console.WriteLine(str.Value);
} 
```

有关 XML 名称空间的更多信息，请[点击此处](http://www.w3schools.com/xml/xml_namespaces.asp)和[此处](http://www.sitepoint.com/xml-namespaces-explained/)。

# ruby-on-rails - 使用 Ruby On Rails 的事务操作

> ID：933696
> 
> 赞同：5
> 
> 时间：2009-06-01T05:56:06.590
> 
> 标签：ruby-on-rails, transactions, actioncontroller

我在控制器中有一个复杂的操作，它对数据库执行几个更新查询。

如何在没有任何结构重构的情况下使此操作*像事务一样？*

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-01T06:12:54.147

```
MyModel.transaction do
  begin
    @model.update_stuff
    @sub_model.update_stuff
    @sub_sub_model.update_stuff
  rescue ActiveRecord::StatementInvalid # or whatever 
    # rollback is automatic, but if you want to do something additional, 
    # add it here
  end
end 
```

这是[事务方法的文档](http://api.rubyonrails.org/classes/ActiveRecord/Transactions/ClassMethods.html)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-20T08:23:47.743

可以通过以下方式使控制器中的所有操作都具有事务性：

```
around_filter :transactional

def transactional
  ActiveRecord::Base.transaction do
    yield
  end
end 
```

# xcode - XCode / Interface Builder：如何重命名默认的 NSToolbar 项？

> ID：933697
> 
> 赞同：1
> 
> 时间：2009-06-01T05:57:12.800
> 
> 标签：xcode, nstoolbar

当我将 NSToolbar 添加到我的应用程序时，它带有一些默认项目，如“自定义”或“颜色”，我无法重命名它们。这些属性被禁用并且无法编辑。

我正在寻找一种简单的方法来翻译这些项目，因为我不需要英文应用程序。我还想编辑“完成”按钮的文本和“允许的工具栏项目”文本。

我真的在寻找一种简单的方法来做到这一点，因为我正在为孩子们做一个教程，如果我不需要的话，我不想做一个整体的本地化。无论如何，如果它不复杂，我会这样做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-05T13:12:52.817

Apple 的默认工具栏项目已针对许多国家/地区进行了本地化。要在您的应用程序中使用另一种语言，您可以通过将适当的“Countryname.lproj”目录添加到应用程序包装器中的“资源”目录来本地化您的应用程序。

默认情况下，XCode 仅创建“English.lproj”本地化。如果您不需要英语，您可以将其重命名为“German.lproj”（或其他）。您必须再次将包含的文件添加到您的项目中并删除旧的引用。

您可能还希望将 Info.plist 文件中的“本地化本地开发区域”设置设置为您所在的国家/地区。

我不知道如何让 InterfaceBuilder 显示另一个本地化，它总是使用英语。

# javascript - 这是调用javascript函数的正确方法吗？

> ID：933703
> 
> 赞同：1
> 
> 时间：2009-06-01T06:00:29.923
> 
> 标签：javascript, jquery

这是用 jquery 调用我的 javascript 函数的正确方法吗？我花了过去 5 个小时试图弄清楚为什么这不起作用。

```
<form class="rpt" id="rpt" action=""> 
```

* * *

```
$(function() {
  $("#rpt").submit(doSave);
});
</script> 
```

* * *

这是 javascript 所见即所得编辑器中的一小段代码。我仍然在我的 html 中使用完全相同的表单标签。

```
 // Save
        case "Save":
            WYSIWYG.updateTextArea(n);
            var form = WYSIWYG_Core.findParentNode("FORM", this.getEditor(n));
            if(form == null) {
                alert("Can not submit the content, because no form element found.");
                return;
            }
            form.submit();
        break; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T06:28:36.477

提交函数有两种变体。如果您打电话`$('#rpt').submit();`，您将触发表单的“提交”事件。如果您调用`$('#rpt').submit(myFunctionName);`您将绑定`myFunctionName`到表单的“提交”事件。这*不会*在页面加载时触发，而只会在您尝试提交表单时触发。因此，这段代码：

```
<form id="rpt" method="GET" action="http://www.google.com/search">
Search: <input type="text" name="q"> <input type="submit" value="Go">
</form> 
```

而这个Javascript：

```
function myFunctionName() {
   alert('The form is being submitted!');
   return false; // cancel the event (ie, the form will not be sent)
}
$(function() {
    $('#rpt').submit(myFunctionName);
}); 
```

*仅在提交表单时*调用该`myFunctionName`函数（通过手动按下“Go”按钮或在文本字段获得焦点时按下 Enter）。[这是它在工作中的一个示例](http://jsbin.com/eyebi)。如果你想在页面加载时运行一个特定的函数，你所要做的就是向函数传递一些东西，或者简称：*`$(document).ready();``$()`*

 *```
function onLoadDoThis() {
    alert('Page is loaded!');
}
$(document).ready(onLoadDoThis); // $(onLoadDoThis); is the same thing 
```

这[是一个例子](http://jsbin.com/otari)。希望这清除了一些东西...

# 编辑

好的，所以我提出了一个您正在尝试做的工作示例。起初我很生气你不能让它工作，但实际上有很多限制你必须解决，因为这个编辑器有多糟糕。无论如何，进入解释：

第一个问题是库将 $ 的使用覆盖到它自己的小函数中。所以 jQuery 令人敬畏是不可能的常规方式。值得庆幸的是，[jQuery 很棒](http://docs.jquery.com/Core/jQuery.noConflict)，您可以通过执行以下操作来解决这个问题：

```
$j = jQuery.noConflict(); 
```

现在，`$(...);`你必须做而不是做`$j(...);`。如果您没有意识到这一点，很可能您正在尝试编写 jQuery 代码，但没有发生任何事情。

你可能遇到的下一个障碍是，对于*大多数*事件，当你做类似的事情时`$(selector).myevent(aFunction);`，假设做`$(selector).myevent();`会触发所述事件。但是，[提交事件并非如此](https://stackoverflow.com/questions/645555/should-jquerys-form-submit-not-trigger-onsubmit-within-the-form-tag)。除非表单操作是*由用户触发的，*否则当通过代码提交表单时，不会调用您绑定到表单提交的代码。因此，即使编辑器源代码中的行`form.submit();`只是触发表单的本机提交事件，即使您使用 Javascript 将事件绑定到此事件，在这种情况下也不会调用它，因为用户没有t触发提交事件，代码做到了。

由于这个限制，在不编辑编辑器源代码的情况下实现你想要的变得越来越棘手。您会看到，编辑器将其“创建所有仪表板废话”的内容附加到窗口的加载事件中。这个事件在 jQuery 的 DOM 就绪事件之后触发，因为 jQuery 就绪的重点是尽快触发，而不是一秒钟后触发，而这`window.load`需要它的甜蜜时间。所以我们要做的就是抛弃 jQuery 绑定代码 ( *grimace* ) 并使用编辑器自己的绑定代码在它自己的“创建仪表板”功能之后直接附加一个事件。此时，仪表板已经创建，因此我们可以访问“保存”按钮并使其执行我们想要的操作 - 仅在删除其调用“保存”的原始事件之后

在一天结束时，代码最终看起来像这样：

```
$j = jQuery.noConflict(); // give up ownership of $ to WYSIWYG

WYSIWYG.attach('textarea1', full); // first attach the event to create this widget

WYSIWYG_Core.addEvent(window, "load", function() {
    // and now override the Save button
    // the removeAttr('onclick') is crucial to stop it
    // from doing what it normally does (Which is submit the form)
    $j('#Save').removeAttr('onclick').click(function() {
        var form = $j('#myform');
        var data = form.serialize();
        var type = form.attr('method');
        var url = form.attr('action');
        $j.ajax({
            url: url,
            type: type,
            data: data,
            dataType: 'json',
            success: function(d) {
                if(d.success == 1) {
                    $j('#notice').html('Everything went alright! High fives.');
                } else {
                    $j('#notice').html('Something went wrong. Eep.');
                }
            }
        });        
    });
}); 
```

While`my_handler.php`是一个非常简单的脚本，它只返回一个 json 字符串：

```
<?php
// process your stuff here, set success as 1 or 0
$success = 1;
print json_encode(array('success' => $success));
?> 
```

[这是它的一个例子](http://www.rootspot.com/stackoverflow/jquery.php)。

就个人而言，我真的不喜欢这个特定的编辑器，我建议您查看其他内容。

不管怎样，我希望这会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T06:18:10.767

由于“rpt”是类名和表单名，所以可以使用“.”。或“#”，假设“doSave”是用作回调的函数的名称，它将起作用。所以，它可以这样调用：

```
$(".rpt").submit(doSave);
function doSave(){
  //do something
} 
```

或者你可以让函数本身成为参数：

```
$(".rpt").submit(function(){
  //do something here
}); 
```

**编辑：**如果您不希望表单回发。添加一个“return false;”。

```
$("#rpt").submit(doSave);
function doSave(){
  //do something
  alert("form submit fired");
  return false;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T06:06:21.957

它甚至比这更简单：

```
$("#rpt").submit(doSave); 
```

如果这不起作用，那是因为您使用的是 JQuery 集，即使您对提交表单元素感兴趣。如果是这样，请尝试让 JQuery 相信它只是一个元素：

```
$("#rpt").eq(0).submit(doSave); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T07:07:37.460

该`doSave`函数可能必须在源代码中定义得比将其绑定到提交事件的代码更早...

**此代码不起作用**

```
// doSave is undefined at this point
$("#rpt").submit(doSave);

// Now we've defined doSave, but it's too late.
function doSave(){
  //do something
  alert("form submit fired");
  return false;
} 
```

**我相信这段代码应该可以工作：**

```
$("#rpt").submit( function (){
    alert("submitted");
    return false;    
}); 
```

**或者，如果您必须单独定义 doSave，请尝试以下操作：**

```
// First define doSave
function doSave(){
  //do something
  alert("form submit fired");
  return false;
}

// Then bind it
$("#rpt").submit(doSave); 
```

# xml - 将 XML 与属性合并

> ID：933705
> 
> 赞同：3
> 
> 时间：2009-06-01T06:01:38.407
> 
> 标签：xml

### 复制：

> [将 XML 与属性合并](https://stackoverflow.com/questions/80609/merge-xml-documents)

我有两个要合并的 XML 文件。

**当第二个 XML 中的元素可以覆盖**第一个 XML 中的元素时，合并的文件应该包含两个文件中的每个元素（维护层次结构）：

当两个元素相同（相同的 XPATH，相同的属性）时，我想覆盖。

可能有一百万种方法可以做到这一点 - 这是最轻松的（最好不学习 XSLT）

样本结果：

文件 1

```
<a>
 <b foo="d"/>
 <b bar="c"/>
 <c/>
</a> 
```

文件 2

```
<a>
 <b foo="e"/>
 <b boo="c"/>
 <c/>
</a>
<x>
 <b bar="c"/>
</x> 
```

输出

```
<a>
 <b foo="d"/>
 <b bar="c"/>
 <b boo="c"/>
 <c/>
</a>
<x>
 <b bar="c"/>
</x> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-04T14:27:59.380

XSLT 可能看起来像一个挑战，但它可以为您的问题提供一个很好的解决方案。您可能需要考虑针对您的问题公开可用的 XSLT。这将完全独立于平台，因为许多平台都实现了这些转换。也许试试这个：

[http://www2.informatik.hu-berlin.de/~obecker/XSLT/#merge](http://www2.informatik.hu-berlin.de/~obecker/XSLT/#merge)

有一些选项也可以巧妙地改变合并的执行方式，从而为您提供更灵活的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T06:25:07.293

> [http://www.javaworld.com/javaworld/jw-07-2007/jw-07-xmlmerge.html](http://www.javaworld.com/javaworld/jw-07-2007/jw-07-xmlmerge.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T12:50:27.330

使用[xml2](http://ofb.net/~egnor/xml2/)可以通过以下过程使这变得非常简单：

*   在两个文件上使用 xml2 进行简单表示
*   合并两者
*   处理覆盖
*   使用 2xml 转换回 xml

我还不确定如何进行覆盖，但其余的可能看起来类似于

xml2 文件1 文件2 | 排序 | 2xml

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T17:25:18.960

我在第一个答案中没有发现任何有用的东西，第二个似乎不完整，所以我为自己写了它。

代码相当丑陋（我很想听听建议——我的 XML 处理能力……不是那么好）。

```
using System;
using System.IO;
using System.Text.RegularExpressions;
using System.Xml;

namespace XmlMerge
{
    internal class Program
    {
        private static int Main(string[] args)
        {
            if (args.Length != 3)
            {
                Console.WriteLine("Usage: XmlMerge <mainFile> <mergedFile> <output>");
                return 1;
            }

            string mainFile = args[0];
            string mergedFile = args[1];
            string outputFile = args[2];

            if (!File.Exists(mainFile) ||
                !File.Exists(mergedFile))
            {
                Console.WriteLine("One of the input files doesn't exist");
                return 1;
            }

            var main = new XmlDocument();
            main.Load(mainFile);
            var merged = new XmlDocument();
            merged.Load(mergedFile);
            foreach (XmlNode element in merged.SelectNodes("/config/section/value"))
            {
                string xpath = GetXpath(element);
                XmlNode mainNode = main.SelectSingleNode(xpath);
                if (mainNode != null)
                {
                    // existing value
                    mainNode.InnerText = element.InnerText;
                }
                else
                {
                    // go to father, add as new node
                    AddNewNode(element, main, xpath);
                }
            }

            main.Save(outputFile);

            return 0;
        }

        /// <summary>
        /// Add <paramref name="toAdd"/> to <paramref name="existing"/> under <paramref name="xpath"/>
        /// </summary>
        /// <param name="toAdd"></param>
        /// <param name="existing"></param>
        /// <param name="xpath"></param>
        private static void AddNewNode(XmlNode toAdd, XmlNode existing, string xpath)
        {
            foreach (var part in xpath.Split('/'))
            {
                if (part == "")
                    continue;

                var child = existing.SelectSingleNode(part); 
                if (child != null)
                {
                    existing = child;
                    continue;
                }

                // similar child does not exist, add it ourselves
                var partMatch = Regex.Match(part, @"(.*)(?:\[(.*)\])");
                var name = partMatch.Groups[1].Value;
                var attributes = partMatch.Groups[2].Value;

                var newChild = existing.OwnerDocument.CreateElement(name);
                if (attributes != null)
                {
                    foreach (var attributeStr in attributes.Split(new[]{"and"}, StringSplitOptions.None))
                    {
                        var attributeMatch = Regex.Match(attributeStr, "@(.*)='(.*)'");
                        var attributeName = attributeMatch.Groups[1].Value;
                        var attributeValue = attributeMatch.Groups[2].Value;

                        XmlAttribute attribute = existing.OwnerDocument.CreateAttribute(attributeName);
                        attribute.Value = attributeValue;
                        newChild.Attributes.Append(attribute);
                    }
                }
                existing.AppendChild(newChild);
            }
        }

        private static string GetXpath(XmlNode node)
        {
            if (node.ParentNode == null)
                return "";

            string attributeStr = GetAttributeStr(node);
            return GetXpath(node.ParentNode) + "/" + node.Name + attributeStr;
        }

        private static string GetAttributeStr(XmlNode node)
        {
            if (node.Attributes.Count == 0)
                return "";

            var result = "[";
            bool first = true;
            foreach (XmlAttribute attribute in node.Attributes)
            {
                if (!first)
                    result += " and ";
                result += "@" + attribute.Name + "='" + attribute.Value + "'";
                first = false;
            }
            return result + "]";
        }
    }
} 
```

# bazaar - Bazaar 插件：预提交挂钩上的修改文件列表

> ID：933711
> 
> 赞同：0
> 
> 时间：2009-06-01T06:04:15.783
> 
> 标签：bazaar, bazaar-plugins

我想编写一个 Bazaar 插件，在修改文件提交之前执行一些操作。诸如检查语法错误之类的事情，如果文件中仍有 TODO，则警告提交者。

如何获取 Bazaar 插件中已修改文件的列表？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T08:34:44.727

如果您使用`pre_commit`钩子，那么您的钩子函数将`tree_delta`作为参数之一（请参阅[钩子签名文档](http://doc.bazaar-vcs.org/latest/en/user-reference/bzr_man.html#hooks)）。您需要使用`tree_delta`对象来访问添加/修改/重命名文件的列表。 [TreeDelta 类的文档可在此处获得](http://starship.python.net/crew/mwh/bzrlibapi/bzrlib.delta.TreeDelta.html)。

[您可以在此处查看 pre_commit 挂钩代码的示例](http://bazaar.launchpad.net/~bialix/%2Bjunk/checkeol/annotate/head%3A/__init__.py)。

# jquery - 是否有不使用回调的 $getJSON 版本？

> ID：933713
> 
> 赞同：39
> 
> 时间：2009-06-01T06:04:34.613
> 
> 标签：jquery, json

我正在为 3rdParty javascript 库实现回调，我需要返回值，但我需要从服务器获取值。我需要做这样的事情：

```
3rdPartyObject.getCustomValue = function {
   return $.getJSON('myUrl');
} 
```

getJson 使用 XMLHttpRequest （我相信）它同时具有同步和异步行为，我可以使用同步行为吗？

* * *

## 回答 #1

> 赞同：103
> 
> 时间：2009-06-01T06:06:48.930

查看 jQuery 源代码，这就是全部`$.getJSON`：

```
getJSON: function( url, data, callback ) {
    return jQuery.get(url, data, callback, "json");
}, 
```

这就是全部`$.get`：

```
get: function( url, data, callback, type ) {
    // shift arguments if data argument was omitted
    if ( jQuery.isFunction( data ) ) {
        callback = data;
        data = null;
    }

    return jQuery.ajax({
        type: "GET",
        url: url,
        data: data,
        success: callback,
        dataType: type
    });
}, 
```

那里没有黑魔法。由于您需要自定义基本功能以外的东西`$.getJSON`，您可以只使用低级`$.ajax`功能并将[async 选项](http://docs.jquery.com/Ajax/jQuery.ajax#options)传递为 false：

```
$.ajax({
    type: 'GET',
    url: 'whatever',
    dataType: 'json',
    success: function() { },
    data: {},
    async: false
}); 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2010-10-25T18:50:45.073

您还可以在拨打电话之前使用以下内容：

```
$.ajaxSetup( { "async": false } ); 
```

我不知道“异步”属性的范围，我怀疑它是一个全局配置。因此，请考虑是否要在同步调用后将其更改回 true。

例子：

```
3rdPartyObject.getCustomValue = function { 
    $.ajaxSetup( { "async": false } );
    var result = $.getJSON('myUrl');
    $.ajaxSetup( { "async": true } );
    return result;
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2010-09-30T18:01:06.337

```
var jsonObjectInstance = $.parseJSON(
    $.ajax(
        {
           url: "json_data_plz.cgi", 
           async: false, 
           dataType: 'json'
        }
    ).responseText
); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-07-07T14:29:34.483

但除非我弄错了，否则这段代码是行不通的：

```
3rdPartyObject.getCustomValue = function {
  var json = $.ajax({
    type: 'GET',
    url: 'whatever',
    dataType: 'json',
    success: function() { },
    data: {},
    async: false
  });

return json;
} 
```

因为 $.ajax 返回 XHR 对象而不是解析的 json 对象。

你需要做更多类似的事情：

```
var jsonLoader = function(url){
    this.url = url;
    this.rawData = {};
    this.getRawData();
};

jsonLoader.prototype.getRawData = function(){

    var json = $.ajax({
        type: 'GET',
        url: this.url,
        dataType: 'json',
        success: this.getRawData(this),
        data: {},
        async: false
    });
};

jsonLoader.prototype. getRawData = function(self){
    return function(json){self.rawData = json;};
};

var loadMe = new jsonLoader("Data.json");
loadMe.rawData //has the parsed json object 
```

事实上，可能有一种更简洁的方法可以实现相同的目标

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-12-03T10:13:53.413

如果有人必须在 Rails 中执行此操作，我有一个非常干净的方式，如下所示：

**像这样设置你的控制器：**

> ```
> def my_ajax_action
> 
>     respond_to do |format|
>       # if you use render, you won't need a view page, the ":json =>" part takes care of all 
>       # the formatting
>       format.json { render :json => @variable_containing_json }
>     end
> 
> end 
> ```

**在 Javascript 中设置调用**

> ```
> function doAjaxWork( ) {
> 
>     var ret;
> 
>     $.ajax({
>         type: 'GET',
>         url: '/controller/action/param',
>         dataType: 'json',
>         complete: function(response) {
>            ret = eval('(' + response.responseText + ')');
>         },
>         async: false
>     });
> 
>     return ret;
> } 
> ```

当然，除非您必须这样做，否则不要执行此同步操作。哦，当我在其中显示带有 url 的 javascript 时，请查看[JSRoutes](https://github.com/railsware/js-routes) ...它使这些非常干净。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-01-08T16:38:50.850

async 属性的范围是全局的，您的方法将同步调用。

# c# - 在 Visual Studio 中获取活动项目

> ID：933714
> 
> 赞同：1
> 
> 时间：2009-06-01T06:04:42.613
> 
> 标签：c#, visual-studio, visual-studio-2008

在 Visual Studio 插件中，我试图获取当前活动的项目。

我发现了一些关于使用 DTE.ActiveSolutionProjects 的 Web 帖子。该函数为我提供了可以转换为的对象和 DTE.Project 对象的数组——但它总是给我相同的项目，无论我在 IDE 中作为当前解决方案加载了什么。该数组中始终存在一个元素，并且始终是相同的元素。

还有其他方法可以找到项目吗？

——保罗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-01T06:39:56.860

事实证明，我的 ActiveSolutionProjects 做了我想要的——除了它在运行 VS2008 的调试实例时提供了虚假信息。如果插件直接加载到 VS2008 中，我会得到正确的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-07-31T08:05:36.493

[我使用了Get active project - Extending Visual Studio SharePoint development tools tip #1](https://blog.mastykarz.nl/active-project-extending-visual-studio-sharepoint-development-tools-tip-1/)文章中的这段代码。放松，无需 SharePoint 工作。我将在此处显示代码，但最好阅读文章以获取有关您可能需要在项目文件中进行的一些更改的信息。

```
internal static Project GetActiveProject()
{
    DTE dte = Package.GetGlobalService(typeof(SDTE)) as DTE;
    return GetActiveProject(dte);
}

internal static Project GetActiveProject(DTE dte)
{
    Project activeProject = null;

    Array activeSolutionProjects = dte.ActiveSolutionProjects as Array;
    if (activeSolutionProjects != null && activeSolutionProjects.Length > 0)
    {
        activeProject = activeSolutionProjects.GetValue(0) as Project;
    }

    return activeProject;
} 
```

# inversion-of-control - 什么是组件驱动开发？

> ID：933723
> 
> 赞同：23
> 
> 时间：2009-06-01T06:14:22.863
> 
> 标签：inversion-of-control, components, ioc-container, paradigms

*组件驱动开发*术语开始被广泛使用，尤其是。与控制反转有关。

1.  它是什么？
2.  它解决了哪些问题？
3.  什么时候合适，什么时候不合适？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-06-06T23:54:47.403

> 它是什么？

我认为您答案中的定义很好地涵盖了这个问题。虽然，我质疑为什么定义包括组件需要显式定义其依赖项。组件的典型示例是 ActiveX 控件——它们是否需要显式定义它们的依赖关系？

> 它解决了哪些问题？

复杂性管理。它试图通过允许您只考虑组件的实现来解决这个问题。只需编写组件，*不必*考虑如何组合或管理它们。这是由组件外部的一些框架或基础设施完成的，对组件作者来说并不重要。

> 什么时候合适，什么时候不合适？

不一定适用于琐碎或一次性的应用程序。组件架构中的坏味道是，如果您花时间思考或处理基础架构来管理和组合组件，而不是组件本身。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-06-01T06:26:41.487

我不确定这是一个“广泛使用”的术语，但在 VCS（版本控制系统）中，我知道有两种方法可以管理构建程序所需的一组文件：

*   [基于系统的方法](https://stackoverflow.com/questions/769786/vendor-branches-in-git/769941#769941)，其中所有集合具有共同的生命周期，并且必须标记为全部
*   基于组件的方法，其中单个文件集有自己的生命周期，并且元标签引用组件的所有标签，以通过这些组件之间的组合和依赖关系来指定所有系统。

[应用架构](https://stackoverflow.com/questions/704855/software-design-vs-software-architecture/705013#705013)用于识别这些组件：

*   功能领域和应用
*   第三方库
*   构架

这就是 IoC 的用武之地，因为它是任何框架的基础。它解决的问题是让您更好地识别应用程序的部分：
假设您设计一个 PLR（盈亏）应用程序，负责计算交易者的盈亏（头寸）。
你会很快意识到它不是一个单一的应用程序，而是几个组合：

*   图形用户界面
*   发射器
*   调度程序（在多个服务器之间调度计算，因为一个服务器没有足够的内存来计算所有服务器！）
*   等等

然后，您可以确定一个计算框架 (Ioc)，它可以让您插入不同的模块，然后由您的框架在正确的时间调用这些模块。

或者，您可以识别纯[技术框架（KPI、日志、异常管理），然后您的任何其他](https://stackoverflow.com/questions/212270#212362)*功能*组件都可以使用这些框架。

在项目管理方面，这也允许您独立开发每个部分，同时通过 VCS 确保全球协调。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-06-13T21:05:19.203

基于组件的开发并不是什么新鲜事。我不知道组件驱动开发，但我会假设它是 CBD。这就是 Unix 的设计方式，一堆可替代的小程序，每个都很好地完成一件事。在桌面领域，Delphi 的 VCL 已经成功地使用了具有丰富可重用组件和第三方市场的组件。随着一些技术的成熟，我们现在看到了 CBD 的复兴。例如，简单的 Web 应用程序正在演变为 SOA 和 RESTful WS。所有 Java 人一直在谈论的是模块化和 IoC。

您正在寻找的答案可能会在Ke Jin[的Why and what of Control of Control中找到。](http://www.pocomatic.com/docs/whitepapers/ioc/)

> 此外，这些经典的 OO 编程语言的自然命令性往往会错过树（低级逻辑控制过程代码）的森林（高级架构/结构）。接管现有应用程序的开发和维护工程师必须依赖其过时的设计/架构文档和低级代码注释/模式。
> 
> 基于组件的开发 (CBD) 范式通过将管道逻辑转移到框架中来解决上述两个问题，这些框架根据用户/开发人员提供的声明性描述来操作组件和设置应用程序。与常见的混淆相反，这种声明性描述并不意味着是应用程序设置脚本。相反，它们的基本意图是明确表达应用程序体系结构/结构，而不强制要求它们的命令式管道过程（即描述什么而不是如何）。CBD 范式的目标是通过这些框架支持有效和灵活的应用程序组合，并让应用程序开发人员专注于业务逻辑和领域问题，而无需考虑低级管道复杂性。
> 
> 结合了声明性应用程序描述和 IoC 技术的 CBD 框架称为 IoC 框架。与它们的前辈相反，IoC 框架 *是非侵入性*的，并且使用 *依赖/配置注入/设置场景*。

根据 Wikipedia，基于组件的开发是基于[组件的软件工程 (CBSE)](http://en.wikipedia.org/wiki/Component-based_software_engineering)的别名。

> [它] 是软件工程的一个分支，其优先级是在给定软件系统中可用的广泛功能方面的*关注点分离。*

这有点模糊，所以让我们看看更多细节。

> 单个组件是封装了一组相关功能（或数据）的软件包或模块。
> 
> 所有系统进程都放置在单独的组件中，因此每个组件内的所有数据和函数在语义上都是相关的（就像类的内容一样）。因为这个原则，人们常说组件是 *模块化*的和内*聚*的。

所以，根据这个定义，一个组件可以是任何东西，只要它真正做好一件事并且只做一件事。

> 关于系统范围的协调，组件通过*接口*相互通信。[...] 这个原则导致组件被称为*封装*。

所以这听起来越来越像我们认为好的 API 或 SOA 应该有的样子。

*提供*的接口由棒棒糖表示，*所需*的接口由连接到 UML 中组件外边缘的打开套接字符号表示。

[![替代文字](https://i.stack.imgur.com/iiGCM.gif)](https://i.stack.imgur.com/iiGCM.gif)
[（来源：[wikimedia.org](http://upload.wikimedia.org/wikipedia/en/2/25/Component-based_Software_Engineering_%28CBSE%29_-_example_2.gif)）]

> 组件的另一个重要属性是它们是可 *替换*的，因此如果后续组件满足初始组件的要求（通过接口表示），那么一个组件可以被另一个组件替换（在设计时或运行时）。
> 
> 可重用性是高质量软件组件的一个重要特征。应该设计和实现一个软件组件，以便它可以在许多不同的程序中重用。

可替代性和可重用性是使组件成为组件的原因。那么这和面向对象编程有什么区别呢？

> 面向对象编程 (OOP) 的理念是软件应该根据它所代表的实际或想象对象的心智模型来编写。[...]
> 
> 相比之下，基于组件的软件工程没有做出这样的假设，而是指出应该通过将预制组件粘合在一起来开发软件，就像在电子或机械领域一样。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-06-02T06:29:23.980

*这是我做一些研究后的定义。*

*组件驱动开发*是软件开发中的一种方法，其中代码被分割成可重用和可测试的组件，这些组件组合在一起形成用于交付业务功能的应用程序基础。组件的组合和管理通常委托给[Inversion of Control](http://abdullin.com/wiki/inversion-of-control-ioc.html) Container。

组件本身是一个类，它实现了一些服务契约，并明确定义了它为了履行这个契约而需要的依赖关系。实际的实现对组件之外的其他人是隐藏的。

**相关链接：**

*   [组件驱动开发和 IoC 容器](http://abdullin.com/journal/2009/5/31/component-driven-development-and-ioc-containers.html)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2011-02-19T20:41:23.057

我认为基于组件的软件工程是一种通过使用可插拔组件来开发软件系统的方法；组件是“*仅具有合同指定的接口和明确的上下文依赖关系的组合单元*”，“*可以独立部署并受第三方组合的约束*”。（Clemens Szyperski，“[组件软件：超越面向对象编程](https://rads.stackoverflow.com/amzn/click/com/0201178885)”）

CBSE 促进代码重用和灵活/适应性软件系统的快速组装。

多年来，有大量研究集中在这个主题上。旗舰活动（[ACM SIGSOFT Symposium on Component Based Software Engineering](http://cbse-conferences.org/2011/)）现在已经是第 14 年了，并且出现了很多新趋势。

此外，如果您想要一个很好的可重用、可插拔和可扩展组件示例，这些组件在当今工业界大量使用，请查看[**MS Enterprise Library**](http://msdn.microsoft.com/en-us/library/ff953181(PandP.50).aspx)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-13T14:05:12.503

如果您有兴趣将组件（或其他可重用资产）组合到应用程序中，您还应该查看[软件产品线](http://www.software-acumen.com/about-product-lines/)方法。

在软件产品线中，组件（或较低级别的代码元素）之间的依赖关系是在这些组件之外显式管理的。这通常使用包含规则的*特征模型*来完成，例如

*   这两个组件不得一起使用（互斥性）
*   如果使用此组件，则必须使用此其他组件或（相互依赖）
*   可以使用某些特定组件集的任意组合（可选）

根据您希望建模的依赖项的复杂性，其他更复杂的规则也是可能的。

有时用来代替特征建模的另一种方法是使用代码生成器来配置要组装到最终应用程序中的不同组件。也可以将特征建模与代码生成相结合。

除了代码生成之外，您可能还会搜索其他一些术语，例如特定领域的建模、模型驱动的软件开发、软件系列。

* * *

## 回答 #7

> 赞同：-4
> 
> 时间：2013-05-17T09:47:11.023

在您尝试使用 Unity 3D 之前，您永远不会理解什么是真正的组件驱动开发。它不是 ActiveX 或你以前见过的任何东西，你以前见过的还有另一个 Component 含义。

组件驱动的开发，几乎每个人都在谈论最近，意味着，你有两件事：

1.  **对象**- 就像 OOP 编程中的对象或现实世界的对象。
2.  **对象的组件**——类似于对象功能的一部分或其中一项能力。

因此：**组件 - 不是对象。它是 - 对象的功能**。

因此，在标准的 OOP 编程中，当您需要扩展 Base Object 的新功能时，您必须通过继承 Base Object 来创建新的 Derived Object。

在组件驱动开发中，当您需要扩展对象时，您只需创建空对象并用不同的组件填充它，无需任何继承。在组件驱动的开发中，没有类，而是有**预制件**——它是带有预定义组件的预定义对象和子对象。

正如我所说，除非你尝试，否则你永远不会明白。通过组件驱动的开发，您不必总是使用编程，您可以使用图形编辑器来代替，它还使您摆脱了典型 OOP 的继承地狱。组件本身是用通常的编程方式编写的，但是更高层次的系统，包括对象，大多只需要在编辑器中使用和组合组件，并接收定制的对象行为。

因此：组件驱动开发为您提供：

1.  只需使用编辑器，无需编程即可创建程序逻辑的强大功能。
2.  将您的思想从 OOP 继承地狱中解放出来。使开发更加简单快捷。
3.  使您的程序高度可定制和可扩展，甚至无需接触代码。更少的错误和错误。
4.  只需重新编程特定组件，即可更轻松地维护程序代码，而不会对休息系统产生太大影响。
5.  ETC...

我还想补充一点，基于组件（驱动）的编程不能替代 OOP 编程，它是 OOP 或常规编程的顶部。CBP 中仍然使用常规编程来实现低级组件。我认为这篇文章对 CBP 也有很好的简短解释：http: [//acmantwerp.acm.org/wp-content/uploads/2010/10/componentbasedprogramming.pdf](http://acmantwerp.acm.org/wp-content/uploads/2010/10/componentbasedprogramming.pdf)

# php - 读取从 PHP 中的套接字接收到的所有数据

> ID：933724
> 
> 赞同：0
> 
> 时间：2009-06-01T06:15:18.197
> 
> 标签：php, sockets, telnet

我正在编写一个简单的 telnet 客户端库。我使用 fsockopen() 打开套接字并使用 fgetc() 和 fwrite() 读写套接字。我使用 fgetc() 而不是 fread() 来处理 Telnet 特殊命令和选项，例如 (IAC, ...)。

问题是大多数时候我从套接字读取，返回需要太长时间。正如我所描述的那样，只要连接超时，它就会花费很长时间，然后我就有了结果。

这是我的阅读方法：

```
protected function getChar()
{
    $char = fgetc( $this->_socket );
    return $char;
} // public function getChar() 
```

目前我使用这个条件来确保流完成：

```
$char = $this->getChar();
if ( $char === false ) {
    // end of the stream.
} 
```

有没有其他方法可以确定流已完成并读取所有数据？

Udate：我认为 Telnet 协议中的 EOF 字符不是 PHP 所期望的 EOF，这就是脚本找不到流结尾的原因。有谁知道 Telnet 协议中的 EOF（文件结尾）字符是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-10T17:23:22.977

我搜索并没有发现任何有用的东西。然后我试图找出python中的telnetlib对这个问题做了什么（我只是在学习python），我发现即使是python库也不搜索EOF。它只是继续读取流，直到超时，或者经过一定时间，或者搜索特殊字符串返回结果。所以我用同样的方法阅读并解决了我的问题。感谢所有的答案和评论。我会尝试说服我的公司分发这个带有开源兼容许可证的 telnet 库。如果发生这种情况，我会在这里更新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T07:05:36.200

有`[feof](http://php.net/manual/en/function.feof.php)()`可能有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T16:51:30.410

尝试回显您收到的每个字符的十六进制值。您应该能够看到您收到的 EOF 内容，即使 PHP 无法识别它。查看[ord()](http://us3.php.net/manual/en/function.ord.php)和[bin2hex()](http://us.php.net/manual/en/function.bin2hex.php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-05T16:00:49.300

Telnet 没有流结束标记 (char)。它只是发出提示并停止发送。所以最好的方法是在提示文本上捕获你的输出流。

# c# - 是否可以在使用扫描仪（条形码）的模拟器上运行 PPC？

> ID：933725
> 
> 赞同：1
> 
> 时间：2009-06-01T06:17:01.783
> 
> 标签：c#, windows-mobile

我有带有扫描仪的 PPC (Windows mobile)，在我的程序中我使用这个扫描仪

与 dll。当我尝试在模拟器上运行这个程序时它不会工作。

有没有办法解决这个问题？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T06:30:03.010

我建议实施一个模拟条形码扫描仪。因此，创建一个接口定义了条码扫描器的所有可能功能（例如字符串 PerformScan()）。然后实现一个与模拟器一起使用的版本，该版本可以返回硬编码值、来自文件或其他任何对您有意义的值，以及另一个实际调用扫描仪以在设备上使用的版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T14:22:09.627

你用的是什么扫描仪？（即 Intermec、Hand Held、Honeywell、Symbol）此外，条形码扫描仪是内置在 windows 移动设备中，还是外部连接（例如通过串行或 USB）？

前两个答案可能是正确的，但这实际上取决于您使用的硬件。另外，我猜测做他们建议的事情可能比您想要/可以做的更多……并且可能需要访问扫描仪的硬件规格才能完成。如果它只是一个标准的串行接口，那就太好了，但情况并非总是如此......

实际上我经常遇到这个问题，因为我为霍尼韦尔（以前的手持产品）移动扫描设备编写软件。简而言之，至少对于我们的扫描仪来说，模拟器不是一种选择。我们的 windows 移动设备上的扫描硬件不仅内置在硬件中，而且内置在移动操作系统的内核级别。扫描 API 也内置在自定义 DLL 中，但如果没有我们的硬件和我们的操作系统修改（主要以自定义 IOCTL 调用的形式），它甚至无法运行。

现在，在某些设备上，您想做的事情*可能*是可能的，但这取决于设备型号和品牌。如果您能提供更多信息，我很乐意回答我的任何提示……如果我不知道，可能会从业内其他同事那里找到答案。

只是好奇，这也是您必须使用模拟器而不是实际设备的原因吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T06:49:51.863

扫描仪可以被视为（并且应该提供一个接口）一个标准的串行设备，可以通过打开/关闭/读/写访问。当您在模拟器上时，您可能可以轻松构建一个控制台或文件访问器来替代。

# jquery - jQuery 插件不适用于 1.3

> ID：933731
> 
> 赞同：0
> 
> 时间：2009-06-01T06:24:23.783
> 
> 标签：jquery, plugins

我正在使用这个时间选择器插件。

labs.perifer.se/timedatepicker/jquery.timePicker.js

它适用于 jquery 1.2。看这里。

labs.perifer.se/timedatepicker/

但是当与 jQuery 1.3 一起使用时，IE 会抛出一些错误。例如 Error: 'jQuery' is undefined。我正在使用 IE 8。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T06:30:45.210

听起来您在加载 jQuery 的路径中有错字。仔细检查您的文件名、路径并与脚本标签中的内容进行比较，或者直接从谷歌加载 jQuery：

[http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js](http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js)

然后，您再也不必担心路径拼写错误或错误的文件版本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T08:06:14.830

此外，您需要确保您对 jQuery 的引用在您对 timepicker.js 的引用之前，否则您将收到该错误。

```
<script type="text/javascript" src="..path to jquery.js"></script>
<script type="text/javascript" src="..path to timepicker.js"></script> 
```

# visual-studio - Visual Studio 中的发布模式和调试模式有什么区别？

> ID：933739
> 
> 赞同：144
> 
> 时间：2009-06-01T06:30:30.543
> 
> 标签：visual-studio, visual-studio-2005, conditional-compilation

> **可能重复：**
> [.NET 中的调试与发布](https://stackoverflow.com/questions/90871/debug-vs-release-in-net)
> [调试/发布差异](https://stackoverflow.com/questions/367884/debug-release-difference)

构建项目时 Visual Studio 中的发布模式和调试模式有什么区别？

* * *

## 回答 #1

> 赞同：136
> 
> 时间：2009-06-02T09:33:10.303

**Debug**和**Release**只是不同**解决方案配置**的标签。如果需要，您可以添加其他人。我曾经从事的一个项目有一个名为“Debug Internal”的项目，用于打开应用程序的内部编辑功能。如果你去`Configuration Manager...`（它在`Build`菜单上）你可以看到这个。[您可以在Configuration Manager Dialog Box](http://msdn.microsoft.com/en-us/library/aa301853.aspx)下找到有关 MSDN Library 的更多信息。

然后，每个**解决方案配置**都由一堆**项目配置**组成。同样，这些只是标签，这次是为您的项目设置的集合。例如，我们的 C++ 库项目有名为“Debug”、“Debug_Unicode”、“Debug_MT”等的项目配置。

可用设置取决于您正在构建的项目类型。对于 .NET 项目，它是一个相当小的集合：`#define`s 和其他一些东西。对于 C++ 项目，您需要调整更多种类的东西。

不过，一般来说，当您希望在关闭优化器的情况下构建项目时，以及希望在构建中包含完整的调试/符号信息（通常在 .PDB 文件中）时，您将使用“调试”。当您想要打开优化器并且不想包含完整的调试信息时，您将使用“Release *”*。

* * *

## 回答 #2

> 赞同：107
> 
> 时间：2009-06-01T06:36:01.283

好吧，这取决于您使用的语言，但通常它们是 2 个独立的配置，每个配置都有自己的设置。默认情况下，Debug 在编译文件中包含调试信息（允许轻松调试），而 Release 通常启用优化。

就条件编译而言，它们各自定义了可以在程序中检查的不同符号，但它们是特定于语言的宏。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-06-01T06:35:18.617

主要区别在于在调试模式下编译时，还会创建允许调试的 pdb 文件（因此您可以在代码运行时单步执行代码）。然而，这意味着代码没有优化太多。

# c - 与 sys/select.h 和 termios.h 中定义的功能等效的 Windows 是什么

> ID：933745
> 
> 赞同：22
> 
> 时间：2009-06-01T06:36:28.990
> 
> 标签：c, linux, winapi

我在linux中有一个应用程序，编译成功。我想在 Windows 中运行相同的程序。

但是编译会产生以下与头文件相关的错误。

1.  找不到 sys/select.h
2.  找不到 termios.h

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-06-01T06:51:01.863

Windows API 在结构和风格上与任何风格的 Unix 提供的系统调用和库例程的混合非常不同。

### termio.h

Windows 使用与任何 *nix 系统完全不同的模型来执行终端 I/O。结果，确实没有直接等效于`termios.h`标头及其朋友。

您想在 MSDN 上阅读有关 Windows[通信资源](http://msdn.microsoft.com/en-us/library/aa363196(VS.85).aspx)的信息。

一些需要了解的更多信息包括：

*   [DCB](http://msdn.microsoft.com/en-us/library/aa363214(VS.85).aspx)结构_
*   [COMMTIMEOUTS](http://msdn.microsoft.com/en-us/library/aa363190(VS.85).aspx)结构_
*   [`BuildCommDCB()`](http://msdn.microsoft.com/en-us/library/aa363143(VS.85).aspx)
*   [`SetCommState()`](http://msdn.microsoft.com/en-us/library/aa363436(VS.85).aspx)
*   ... 还有很多 ...

一般来说，你会发现你需要直接处理更多的 Windows API，因为`stdio`在进行设备 I/O 时会增加混乱。

### 选择.h

没有直接等效于 Unix select(2) 系统调用。

在 Windows 中，许多内核对象可以处于有信号或无信号状态，并且向对象发出信号的行为可用于释放调用[`WaitForMultipleObjects()`](http://msdn.microsoft.com/en-us/library/ms687025(VS.85).aspx). `HANDLE`当数据可用时，一些但不是所有对象都会发出信号。具体来说，我知道`HANDLE`WinSock 中的 s 具有该功能，但我不了解 Comm API。我知道`HANDLE`对一个打开的文件没有。

如果您需要在处理窗口消息的线程中等待事件，那么您可能应该使用[`MsgWaitForMultipleObjects()`](http://msdn.microsoft.com/en-us/library/ms684242(VS.85).aspx)它，因为它会在线程被阻塞时正确传递消息。

[在 MSDN 文章Using Synchronization](http://msdn.microsoft.com/en-us/library/ms686967(VS.85).aspx)中阅读有关 Windows 同步原语的信息。

但是，Windows 中内置了几种异步 I/O，它们可以`select()`通过改变设计来替代需求。两者都需要大量使用不能与 C stdio 库结合使用的特性。

MSDN 有几篇关于 I/O 技术的文章，以及大量示例：

*   [输入输出概念](http://msdn.microsoft.com/en-us/library/aa365199(VS.85).aspx)
*   [同步和异步 I/O](http://msdn.microsoft.com/en-us/library/aa365683(VS.85).aspx)
*   [同步和重叠输入输出](http://msdn.microsoft.com/en-us/library/ms686358(VS.85).aspx)
*   [`CreateFile()`](http://msdn.microsoft.com/en-us/library/aa363858(VS.85).aspx)（尤其是备注部分）

请注意，有关 Windows 工作原理的大部分信息都散布在概述文章和 API 函数和结构参考材料的备注部分中。这会给人一种印象，即在初读时没有完全记录在案。

### 使用 Cygwin 移植

另一种方法是使用[Cygwin](http://www.cygwin.com/)来做移植。它在 Windows API 上提供了大部分 POSIX 层。但是，您最终会得到一个依赖于 GPL 的 Cygwin DLL 的应用程序，除非您从他们那里购买商业使用许可证。使用 Cygwin 来获得适用于没有 Unix 经验的 Windows 用户的应用程序可能会很棘手，因为关于这两个系统的设置和使用方式的许多其他假设不同。

`select()`考虑到不同的打开文件描述符的混合，Cygwin 已经完成了相当多的繁重工作来构建在 Windows 上工作的实现。[用户指南](http://cygwin.com/cygwin-ug-net/highlights.html#ov-hi-select)中描述了这项工作。

请注意，只有在 Cygwin 环境中完成时，才会记录和支持针对 Cygwin 的构建。仅将 Cygwin 的 bin 放在 Windows PATH 上并从命令提示符处工作通常是不够的。您确实需要启动 Cygwin 的 bash 构建并从那里编译，以便所有内容都使用相同的 Cygwin 样式安装点和模拟的 Unix 文件结构。

将 Cygwin 头文件与第三方工具头文件混合使用是疯狂的必经之路。

**编辑：**我重新安排了一下，并添加了一些材料以回应评论。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2021-09-20T07:19:07.927

### 还有一个用于 Windows 的 termios 移植，称为[termiWin](https://github.com/veeso/termiWin)。

> termiWin 是一个库，其目的是允许您在 Windows 系统上使用，在 Linux 中使用相同的代码通过串行端口与设备通信。这是可能的，因为 termios 的函数已被重写为与 Windows 的 COM 函数兼容。

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2012-08-05T13:33:21.413

我使用在一些论坛中找到的代码创建了 2 个文件来绕过 windows.h 和 windows com 端口库：

“nowindows.h”

```
/* file nowindows.h v1.0 use at your own risk *
#ifndef DWORD
#define WINAPI
typedef unsigned long DWORD;
typedef short WCHAR;
typedef void * HANDLE;
#define MAX_PATH PATH_MAX
typedef unsigned char BYTE;
typedef unsigned short WORD;
typedef unsigned int BOOL;
#include <sys/types.h>
#include <sys/stat.h>
#include "unistd.h"
#include <fcntl.h>

#define GENERIC_READ                O_RDONLY    //read only mode
#define GENERIC_WRITE               O_WRONLY    //write only mode
#define CREATE_ALWAYS               O_CREAT     //create new file
#define OPEN_EXISTING               0           //fake parameter's value
#define FILE_ATTRIBUTE_NORMAL       0644        // file attributes
#endif 
```

和

“nowindowscomport.h”

```
/* file nowindowscomport.h v1.0 use at your own risk *//
typedef struct _DCB {
    DWORD DCBlength;
    DWORD BaudRate;
    DWORD fBinary  :1;
    DWORD fParity  :1;
    DWORD fOutxCtsFlow  :1;
    DWORD fOutxDsrFlow  :1;
    DWORD fDtrControl  :2;
    DWORD fDsrSensitivity  :1;
    DWORD fTXContinueOnXoff  :1;
    DWORD fOutX  :1;
    DWORD fInX  :1;
    DWORD fErrorChar  :1;
    DWORD fNull  :1;
    DWORD fRtsControl  :2;
    DWORD fAbortOnError  :1;
    DWORD fDummy2  :17;
    WORD  wReserved;
    WORD  XonLim;
    WORD  XoffLim;
    BYTE  ByteSize;
    BYTE  Parity;
    BYTE  StopBits;
    char  XonChar;
    char  XoffChar;
    char  ErrorChar;
    char  EofChar;
    char  EvtChar;
    WORD  wReserved1;
} DCB, *LPDCB;
typedef struct _COMSTAT {
    DWORD fCtsHold  :1;
    DWORD fDsrHold  :1;
    DWORD fRlsdHold  :1;
    DWORD fXoffHold  :1;
    DWORD fXoffSent  :1;
    DWORD fEof  :1;
    DWORD fTxim  :1;
    DWORD fReserved  :25;
    DWORD cbInQue;
    DWORD cbOutQue;
} COMSTAT, *LPCOMSTAT;
typedef struct _COMMTIMEOUTS {
    DWORD ReadIntervalTimeout;
    DWORD ReadTotalTimeoutMultiplier;
    DWORD ReadTotalTimeoutConstant;
    DWORD WriteTotalTimeoutMultiplier;
    DWORD WriteTotalTimeoutConstant;
} COMMTIMEOUTS, *LPCOMMTIMEOUTS;
#define ERROR_INVALID_HANDLE             6L 
/* Purge functions for Comm Port */
#define PURGE_TXABORT       0x0001  /* Kill pending/current @@-377,11 +382,4 @@ */
#define PURGE_RXCLEAR 0x0008
#define PURGE_TXCLEAR 0x0004
#define PURGE_RXABORT 0x0002
// DTR Control Flow Values.
#define DTR_CONTROL_DISABLE    0x00
#define DTR_CONTROL_ENABLE     0x01
#define DTR_CONTROL_HANDSHAKE  0x02
#define RTS_CONTROL_DISABLE 0x00
#define NOPARITY 0
#define ONESTOPBIT 0 
```

# c# - 如何在 WPF 应用程序的单个列表框中将图像从一个位置移动到另一个位置

> ID：933747
> 
> 赞同：0
> 
> 时间：2009-06-01T06:37:25.027
> 
> 标签：c#, wpf, image, listbox

我开发了一个 WPF 应用程序，在其中我将图像添加到列表框。现在我想在该列表框中将图像从一个地方移动到另一个地方。例如 - 位于列表框中第一个位置的图像必须移动我用鼠标指针拖动的第五个位置。任何建议请。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T06:49:52.473

这可能会有所帮助。它允许在两个列表之间拖动，但也可以处理重新排序，所以它应该可以工作。

[Bea Stollnitz：如何在数据绑定的 ItemsControls 之间拖放项目？](http://bea.stollnitz.com/blog/?p=53)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T06:40:50.277

我猜你应该为列表框实现拖放

# php - 在php中删除会话变量

> ID：933749
> 
> 赞同：1
> 
> 时间：2009-06-01T06:38:32.510
> 
> 标签：php, ajax

我创建了一个网页，其中我使用会话变量，当我单击注销时，我使用 ajax 清除会话变量，它在 IE 中工作正常，但是当我使用 firefox 时，有时会话不会被破坏，我用来清除会话的代码是 [当我单击注销按钮时]

`function floadhomepage(){`

```
 ajaxFunction();
//alert('Logout clicked');
window.location.replace("index.php"); 
```

}

```
function ajaxFunction()
var xmlhttp;
if (window.XMLHttpRequest){
  // code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
   }

else if (window.ActiveXObject){
// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
} 
```

别的 {

```
 alert("Your browser does not support XMLHTTP!");
}
xmlhttp.onreadystatechange=function(){
}
xmlhttp.open("GET","logout.php",true);
xmlhttp.send(null);
} 
```

在 logout.php 文件中包含以下代码

```
<?php
session_start();
session_destroy();
unset($_Session['session variable name']);
?> 
```

请指导我找到解决方案提前谢谢..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T06:45:29.127

尝试

```
session_start();
$_SESSION = array();
session_destroy(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T09:38:12.413

我遇到了一些问题

`$_Session['session variable name']`是一个`array( 'first_element' => true, 'second_element' => '123456789' )`。

当我这样做的时候

`unset( $_Session['session variable name'] )`

然后

`session_destroy`,`session_start` 和 重新定义`$_Session['session variable name'] = array( 'first_element' => true );`

当我在 var_dumping`$_Session['session variable name']`时，

与`array( 'first_element' => true, 'second_element' => '123456789' )`second_element 在一起！

我必须取消设置数组中的所有元素。

当我升级 php.ini 时，这个问题消失了。现在我不记得我有哪个 php 版本了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T14:44:39.363

你有没有想过浏览器缓存？即使您在 firefox 中注销，firefox 仍可能会缓存已登录的页面。

尝试使用以下方法停止页面缓存：

```
header("Cache-Control: no-cache, must-revalidate"); // HTTP/1.1
header("Expires: Sat, 26 Jul 1997 05:00:00 GMT"); // Date in the past 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T06:47:16.440

`session_destroy()`单独就足够了，并且独立于浏览器，因为它发生在服务器端。

# eclipse - 如何使用 EMF API 以编程方式从 ecore 创建 Genmodel 和模型代码？

> ID：933750
> 
> 赞同：2
> 
> 时间：2009-06-01T06:39:14.290
> 
> 标签：eclipse, eclipse-emf, eclipse-emf-ecore

有没有可用的教程？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-01T09:50:40.643

可能你最好在 EMF 新闻组上询问，因为我发现这个只是因为谷歌警报。有一个 ant 任务可以做到这一点，EcoreGeneratorTask，所以这将是一个寻找如何做到这一点的好地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-02T15:38:50.257

[这](http://www.ibm.com/developerworks/opensource/library/os-eclipse-dynamicemf/)可能是一个很好的开端。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-30T12:24:44.087

我不确定这是否仍然有趣，但在[这个线程](https://www.eclipse.org/forums/index.php/t/513278/)中描述了一个可能的解决方案。

# tfs - 无法发送 TFS 凭据

> ID：933753
> 
> 赞同：1
> 
> 时间：2009-06-01T06:40:34.177
> 
> 标签：tfs

我正在尝试使用以下代码将 TFS 凭据发送到服务器以连接 TFS 服务器

```
TeamFoundationServer tfs = TeamFoundationServerFactory.GetServer(). 
```

此方法需要两个输入参数。一个是字符串类型（tfs url 作为字符串），另一个是类型`ICredentialsProvider`。我无法创建此类的实例，也无法将 TFS 凭据发送到方法`Getserver`。如果有任何人请帮助我有想法。

谢谢苏妮莎。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-01T06:59:16.603

创建`ICredentialsProvider`.

您应该能够实例化一个`UICredentialsProvider`实现`ICredentialsProvider`.

或者，您可以构造一个`TeamFoundationServer`实例并通过构造函数传递凭据。

这些链接可能会有所帮助：

*   [连接到 TFS](http://www.tfsexamples.com/Default.aspx?Page=Connect%20to%20TFS)
*   [TFS API：如何在 TeamFoundationServerFactory.GetServer() 和 TeamFoundationServer 构造函数之间进行选择](http://blogs.msdn.com/buckh/comments/755115.aspx)
*   [使用 Team Foundation Server API 时如何获取登录对话框](http://blogs.msdn.com/buckh/archive/2006/03/17/credentialprovider.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T16:04:40.257

网络凭证网络凭证；

```
 if (Username != null && Password != null)
        {
             if (Domain != null)
                  networkCredential = new NetworkCredential(Username, Password, Domain);
             else
                  networkCredential = new NetworkCredential(Username, Password);
         }
         else
         {
              networkCredential = CredentialCache.DefaultNetworkCredentials;
         }

        TeamFoundationServer TFS = new TeamFoundationServer( stringTFSURL, networkCredentials); 
```

# .net - 各种 .Net 框架版本的市场份额是多少？

> ID：933755
> 
> 赞同：19
> 
> 时间：2009-06-01T06:41:47.810
> 
> 标签：.net

有谁知道这些统计数据是否在任何地方收集或存在？任何轶事证据至少有一点帮助

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-01T07:27:21.133

我找到了这个链接：[http](http://discuss.joelonsoftware.com/default.asp?biz.5.592012) ://discuss.joelonsoftware.com/default.asp? biz.5.592012 在正文的某个地方，您会发现以下数字：

> ```
> ~80% .Net 1+
> ~50% .Net 2+
> ~20% .Net 3+ (~17%  Vista)
> ~03% .Net 3.5+ (Skewed b/c I have 3.5...) 
> ```

我不知道这些数字是从哪里来的，但它确实有些道理。HP 和 ATI 的软件是用 .NET（我相信是 1.1）编写的，所以几乎每个拥有 HP 打印机或 ATI 显卡的人都有 .NET 1.1。所有 Vista 用户都有 .NET 3.0 。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-08-16T21:48:59.910

也许[搜索热度](https://trends.google.com/trends/explore?date=all&q=.net%201.1,.net%202.0,.net%203.0,.net%203.5,.net%204)会给你一个新的视角。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-04-26T10:20:29.427

[我们这里](http://www.nemo-docs.com/blog/usage-statistics/)有一些基于 WPF 程序使用统计的统计数据。这可能有点偏离，因为我们的安装程序建议但不强制人们安装 .NET 4。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-05-04T16:38:20.190

我编写了在 .Net 2.0 上运行的软件，但作为遥测的一部分，它会报告已安装的版本，这样我就可以确定何时可以在不影响太多现有客户的情况下进行升级。虽然我可以提取所有已安装版本的信息，但我目前每月对最高安装版本进行汇总，因为我将使用它来确定何时升级。这是 2015 年 4 月的样子。

*   2.0 - 0.79%
*   3.0 - 0.52%
*   3.5 - 15.22%
*   4.0 - 31.50%
*   4.5 - 51.97%

您可以从 3.5 推断出 2.0 和 3.0 的数字，因为 3.5 需要/包括要安装的早期版本。同样，4.5 以完全向后兼容性取代了 4.0，因此我们现有的客户群中有 83.47% 与 4.0 兼容。

作为奖励，这里是我们的客户群针对该特定应用程序的操作系统分发信息。

*   Windows XP - 23.12%
*   Windows Vista - 1.04%
*   视窗 7 - 66.75%
*   视窗 8 - 8.83%

这是活动安装的数据，我过滤掉了几个月没有报告任何数据的安装。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-01T08:01:49.253

将一些 Linux / Mac 数据添加到组合中可能会很有趣？

我知道[Ubuntu](http://www.ubuntu.com/)至少从 8.04 开始默认安装[Mono](http://www.mono-project.com)

# c# - C# MVC：防止对 ASP.NET 站点的拒绝服务 (DOS) 攻击的好方法是什么？

> ID：933756
> 
> 赞同：1
> 
> 时间：2009-06-01T06:42:15.703
> 
> 标签：c#, asp.net, asp.net-mvc, denial-of-service

我正在寻找一种既好又便宜的方法来防止对我的 ASP.NET MVC 站点的拒绝服务攻击。

我一直在考虑一种解决方案，它拦截 HttpHandler，然后计算 Cache 对象中的请求，键类似于“RequestCount_[IpAddressOfRequestClient]”，但这似乎会产生疯狂的开销。

任何想法将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-01T07:11:56.127

您可能会考虑尝试限制请求。通过 IP 和/或 cookie 识别用户，并将请求限制为（例如）每两秒 1 次。人类不会注意到，但这会大大减慢机器人的速度。

这有助于应用程序级别（保护您的应用程序/数据库），但它不是一个完整的解决方案，因为点击仍然来自网络级别。

作为前线防线，我可能会依赖硬件。许多 ISP 提供一些保护，例如： http: [//www.softlayer.com/facilities_network_n2.html](http://www.softlayer.com/facilities_network_n2.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-05-10T10:02:03.450

这是一个非常古老的问题，但我希望这个参考可以帮助其他人。

现在我们正在使用“ **API Protector .NET** ”（[https://apiprotector.net](https://apiprotector.net)）来保护我们的 API 免受 DoS 和 DDoS 攻击。

**它也是一个与MVC、WebApi 和 .NetCore**兼容的库，它给我们带来了**非常好的结果**，无论是在**简单性**方面，还是在**可维护性**方面。使用这个库，您可以用一行代码以非常具体的方式保护 API 的每个函数。

正如 API Protector .NET 网站中所解释的：

> 如果您通常将 API 限制为每个 IP 或每个用户 N 个请求，那么这些 N 个请求可用于不断影响相同的特定繁重功能，从而严重减慢整个服务的速度。
> 
> “您的 API 的每个功能都必须以特定方式进行限制，具体取决于该功能对服务器的正常使用频率和处理成本，否则您将无法保护您的 API。”</p>
> 
> API Protector .NET 允许您以简单、声明性和可维护的方式轻松保护 .NET API 的每个功能免受 DoS 和 DDoS 攻击。

唯一的缺点是**它的成本为 5 美元**，但它以非常低的价格为我们提供了我们正在寻找的东西，不像 WebApiThrottle 库，虽然它是我尝试的第一个选项（因为它是免费的），但它最终是当我们想以特定方式保护不同的功能时（如解释的那样，这对于有效保护至关重要），这是不切实际的不可维护的。

API Protector .NET 允许组合不同的保护措施（按 ip、按用户、按角色等）**，用一行来装饰每个功能**，这使其**易于实现和维护**。有关详细说明，请阅读：[https ://apiprotector.net/how-it-works](https://apiprotector.net/how-it-works/)

一个有趣的轶事是，**当我们仍然使用 WebApiThrottle 保护我们的 API 时**，我们做了一些模拟 DDoS 攻击的测试，来自不同主机的许多并行请求，并且出于某种原因，（我认为这是由于与线程同步有关的事情)，大量请求进入函数，并且由于服务器已经超载而迟到了，节流开始了。再加上难维护性，这并没有让我们对可靠的保护有太大的信心，这就是为什么我们最终尝试了这个效果很好的替代方案。

# c++ - 使用字符串流代替字符串？- C++

> ID：933757
> 
> 赞同：1
> 
> 时间：2009-06-01T06:42:30.973
> 
> 标签：c++, string, iostream

我得到了一个用 C++ 编写程序的家庭作业，但我们不允许使用字符串类。但是，我们可以使用[iostream](http://en.wikipedia.org/wiki/Iostream)库，包括 stringstream。我正在考虑使用 stringstream 来构建我的类、从函数返回等。

这对您来说是个好主意吗？我应该注意哪些陷阱？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-01T06:56:41.600

您也可以使用矢量<char>。它是字符串的一个很好的替代品。正如 Scott Meyers 在他的“Effective STL”一书中所说：

> 第三，考虑使用vector<char>代替字符串，vector实现不允许被引用计数，这样隐藏的多线程性能问题就不会出现。当然，如果您切换到 vector<char>，您将放弃字符串的花哨的成员函数，但是无论如何，大多数功能都可以通过 STL 算法获得，因此您并没有放弃功能，而是将一种语法换成另一种语法。

我认为使用 stringstream 可能出现的主要问题是它不是严格意义上的容器。我不确定是否可以将算法和其他常规 STL 内容与流一起使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-19T00:37:40.353

如果情况是没有字符串的商店数据库，您可以简单地使用枚举。

```
enum {
     Prod1,
     Prod2,
     Prod3
}; 
```

这意味着您可以将整数作为标识符传递，然后只需使用带有 switch 语句的打印函数。

```
void PrintProd(int product) {
    switch(product) {
         case Prod1: 
              cout << "Product 1" << endl;
              break;
         case Prod2:
              cout << "Product 2" << endl;
              break;
     // etc.
     }
} 
```

这可以让你绕过很多麻烦。如果您不介意处理堆，则分配产品名称的 char* 向量也可以工作，其中 id 是向量的索引。

# css - CSS div 没有按正确的垂直顺序堆叠

> ID：933760
> 
> 赞同：0
> 
> 时间：2009-06-01T06:44:08.617
> 
> 标签：css, html

我有两个div。我希望 ID 为“hor_rule”的一个出现在另一个 ID 为“header”的下方。

我的印象是这应该自动发生。我一定犯了一些愚蠢的错误。

--- HTML 文件 ---

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>ARCS <~~ the title ~~></title>
    <style type="text/css" media="all">@import "css/styles.css";</style>
</head>
<body>
<div id="container">
    <div id="header">
    <span id="header_title"><~~ the title ~~></span>
</div>
<div id="hor_rule"></div>
</div>
</body>
</html> 
```

--- CSS 文件 ---

```
@charset "utf-8";
/* CSS Document */

#header { 
float:left; 
width:64%;
vertical-align:top;
margin:12px;
}

#header_title { 
font-family: Arial;
font-size:xx-large;
font-weight: bold;
}

#hor_rule{
    height:1px;
    background-color:#999;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-01T06:46:25.990

您的“标题” div 是浮动的，宽度为 64%……这意味着它下方的某些东西（没有应用宽度，或宽度小于容器的 36%）将向上滑动并填充该位置. 将“hor_rule”的宽度设置为高于 36%。

或者，您可以将“容器” div 设置为更大的宽度或让“容器” div`clear: both;`

# sql - 寻找最活跃的话题或游戏

> ID：933764
> 
> 赞同：1
> 
> 时间：2009-06-01T06:46:06.240
> 
> 标签：sql, algorithm

在您的数据库中查找最活跃的论坛帖子或游戏的好指标是什么？

想象一下，你经营一个像 4chan 这样的论坛。您希望最活跃的线程出现在第一页上。您尝试按 last_updated 对主题进行排序，但结果很混乱：您在每次刷新时看到的线程实际上是随机的，跳到第二页可能会显示许多相同的结果。必须有更稳定的算法来确定活动线程！

想象一下，您经营一个网站，人们可以在其中玩和看游戏。您希望人们在访问您的首页时就看到这些游戏是多么令人兴奋。游戏中的交互可以归结为生成单个事件。但是你不能只按 last_updated 排序，因为有些人玩得很慢，你想找到令人兴奋的游戏。

对于奖励积分，请考虑如何构建 SQL 查询以获得最大活动，或者如何在服务器端缓存中实现它。最佳答案不需要 cron 作业来整理数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T15:48:56.983

在论坛示例中，最热门的主题是基于发布的评论，因此您只需计算当天/周/月发布的评论数量（无论您决定构成“热门”的时间范围）并根据此对主题进行排序。

```
SELECT p.id, p.title, COUNT(c.created_at) as count
FROM posts p, comments c
WHERE p.id = c.post_id
AND c.created_at > ***TIME YOU DETERMINE AS HOT***
GROUP BY p.id, p.title
ORDER BY count DESC 
```

假设您对这些数据模型有类似的表设置，您的游戏场景将是相同的

** 请注意，您在 select 中输入的任何内容也必须在 group by 语句中 **

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T07:19:41.897

当然，您不能指望 last_updated（它自己），您应该对所有时间活动线程使用 reply_count/play_count、view_count/played_count。您可能需要为每个游戏添加一个类似 now_playing_count 的字段，以确定现在最热门的游戏。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T07:32:54.990

与您的问题有些相关的问题称为“[布兰妮斯皮尔斯问题](http://www.americanscientist.org/issues/pub/the-britney-spears-problem)”，它是关于通过算法确定热门话题的难度。从人工智能的角度来看，这是一个难题，因为首先，没有固定数量的主题，所以分类是不可能的。而且由于趋势不时变化，模型需要考虑时间因素（典型的神经网络不会，除非你在谈论时间延迟神经网络）。最后，热不热是主观的，因人而异，这意味着您可能需要考虑到人过去的兴趣（[协同过滤](http://en.wikipedia.org/wiki/Collaborative_filtering)）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T15:53:42.317

伪代码：

选择id，count按主题分组，按count排序

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-06-01T15:56:31.867

> 您尝试按 对主题进行排序`last_updated`，但结果很混乱：您在每次刷新时看到的线程实际上是随机的，跳到第二页可能会显示许多相同的结果。

您可以记住用户单击第一页的确切时间，并且按`last_updated`小于或等于该日期的顺序排序：

```
SELECT  t.id, t.name, p.last_updated
FROM    threads t
JOIN    posts p
ON      p.thread_id = t.id
        AND p.last_updated <= @last_updated
ORDER BY
        p.last_updated DESC 
```

这将为您提供稳定的结果集。

仅当用户刷新首页（而不是单击`page 1`等`page 2`）时才更新变量

# sql-server-2005 - 为最快的查询创建 guid 主键 select where guid in ( guid1, guid2 , guid3 ...)

> ID：933766
> 
> 赞同：2
> 
> 时间：2009-06-01T06:47:12.540
> 
> 标签：sql-server-2005

需要使用 GUID 作为主键。我这样想对吗

```
ProductID UNIQUEIDENTIFIER NOT NULL 
ROWGUIDCOL DEFAULT (NEWSEQUNTIALID()) PRIMARY KEY CLUSTERED 
```

将为 where 子句提供最快的选择

`productid in ( guid1 , guid2 ,..., guidn )`

并且不会恶化非集群

`natural_key like 'Something*'`

独立选择。仅由用户查询并以编程方式从头开始创建/重新创建的表。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T08:19:11.683

The fact you're using GUID's as a clustered index will most definitely negatively impact your performance. Even with the NEWSEQUENTIALGUID, the GUIDs aren't really sequential - they're only partially so. Their randomness by nature will definitely lead to higher index fragmentation and thus to less optimal seek times.

Additionally, if you have a 16-byte GUID as your clustered key, it will be added to any non-clustered index on that table. That might not sound so bad, but if you have 10 mio. rows, 10 non-clustered indices, using a 16-byte GUID vs. a 4-byte INT will cost you 1.2 GByte of storage wasted - and not just on disk (which is cheap), but also in your SQL server's memory (since SQL server always loads entire 8k pages into 8k blocks of memory, no matter how full or empty they are).

I can see the point of using a GUID as a primary key - they're almost 100% guarantee to be unique is appealing to developers. BUT: as a clustered key, they're a nightmare for your database.

My best practice: if I really need a GUID as primary key, I add a 4-byte INT IDENTITY to the table which then serves as the clustered key - the results are way better that way!

If you have a non-clustered primary key, your queries using list of GUIDs will be just as fast as if it where a clustered primary key, and by not using GUIDs for your clustered key, your table will perform even better in the end.

Read up more on clustered key and why it's so important to pick the right one in Kimberly Tripps' blog - the the Queen of Indexing and can explain things much better than I do:

*   [GUIDs as PRIMARY KEY and/or clustered key](http://www.sqlskills.com/BLOGS/KIMBERLY/post/GUIDs-as-PRIMARY-KEYs-andor-the-clustering-key.aspx)
*   [The clustered index debate continues](http://sqlskills.com/BLOGS/KIMBERLY/post/The-Clustered-Index-Debate-Continues.aspx)
*   [Ever-increasing clustering key - the Clustered Index Debate..........again!](http://www.sqlskills.com/BLOGS/KIMBERLY/post/Ever-increasing-clustering-key-the-Clustered-Index-Debateagain!.aspx)

Marc

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T08:40:17.227

除了 GUID 不好（来自 marc_s 的回答）之外，您还有一个 IN 子句。这归结为：

```
productid = guid1 OR productid = guid2 OR ... OR productid = guidn 
```

...在实践中，这也不是最佳的。

通常，`natural_key like 'Something%'`对于自然键列上的聚集索引很可能会更好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T07:59:54.297

A Clustered index is best suited to range searches, so it might satisfy your query:

```
productid in ( guid1 , guid2 ,..., guidn ) 
```

but depends what else you are selecting, grouping by, ordering by etc if the index is to be a covering index. Otherwise another non-clustered index might be picked by the optimiser followed by a lookup into the clustered index. It also depends to some extent on the number of rows in that table.

Also, I think you might want to use NEWID() as oppose to NEWSEQUENTIALID()

# postgresql - PostgreSQL 数据分析/聚合

> ID：933769
> 
> 赞同：0
> 
> 时间：2009-06-01T06:47:20.387
> 
> 标签：postgresql, analysis, aggregation

我在 PostgreSQL 中有一个具有以下结构和数据的表：

```
Question      | Answer      | Responses
---------------------------------------
Burger          BigMac        8
Burger          Whopper       19
Burger          Cheeseburger  4
Drink           Coke          22
Drink           Water         1
Drink           Juice         7
Side            Salad         8
Side            Fries         19 
```

如何运行一个查询，该查询返回每个“问题”的最高“响应”的“答案”？对于上述数据，我希望看到如下内容：

```
Question      | Answer      | Responses
---------------------------------------
Burger          Whopper       19
Drink           Coke          22
Side            Fries         19 
```

对于每个“问题”，我没有任何问题，但提取相关的“答案”也被证明是一个问题。用于获得问题和最高响应的 SQL 是：

```
SELECT Question, MAX(Responses) FROM mytable GROUP BY Question; 
```

任何人都可以阐明我等式的最后一部分 - 显示相关答案吗？

我试过这个：

```
SELECT Question, Answer, MAX(Responses) FROM mytable GROUP BY Question; 
```

但是 Postgres 抱怨 Answer 没有在聚合或 GROUP BY 语句中使用。我是否只需要事先确定所有问题，然后对每个问题进行 SQL 查询以找到响应最多的答案？我宁愿不走这条凌乱的道路，但我想这是一个选择。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-01T08:44:51.837

```
SELECT
    DISTINCT ON (question)
    question, answer, responses
FROM
    mytable
ORDER BY
    question, responses DESC; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T10:04:14.903

一种标准方法是使用窗口函数。不幸的是，这需要 8.4，但如果你可以尝试，这样的东西应该可以工作：

```
SELECT question, answer, responses
FROM (
  SELECT question,answer,responses,row_number()
    OVER (PARTITION BY question ORDER BY responses DESC)
  FROM mytable
) AS t 
WHERE row_number=1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-10T18:01:35.423

```
Select Answer
From mytable, (Select Question, max(Responses) as maxres
               From mytable
               Group by Questions) as Temp
Where mytable.Question = Temp.Question
      and mytable.Responses = Temp.maxres 
```

注意：原始问题没有具体说明，因为最多可以有一个答案（每个问题）。

# sql - SQL Server DB - 删除记录，或设置 IsDeleted 标志？

> ID：933780
> 
> 赞同：2
> 
> 时间：2009-06-01T06:53:23.683
> 
> 标签：sql, database

> **可能重复：**
> [当我想使用数据库约束但只标记为已删除而不是删除时该怎么办？](https://stackoverflow.com/questions/771197/what-to-do-when-i-want-to-use-database-constraints-but-only-mark-as-deleted-inste)

在大量使用的数据库中设置某种“IsDeleted”标志来简单地标记要删除的记录（然后稍后删除它们）是否更合适，还是应该直接删除它们？

我喜欢 IsDeleted 标志方法，因为它提供了一个简单的选项来恢复数据，以防出现严重错误，我什至可以为用户提供某种“撤消”功能。我正在处理的数据相当重要。

我不喜欢 IsDeleted，因为它确实会混淆数据检索查询，因为除了常规查询之外，我还必须按 IsDeleted 标志的状态进行过滤。查询使用的索引不超过一个，所以我还假设这会大大减慢速度，除非我创建复合索引。

那么，什么更合适呢？有没有更好的“中间方式”来获得两者的好处，你在使用什么以及为什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-01T06:59:07.213

根据经验，我从不删除任何数据。我所从事的业务类型总是存在诸如“取消的客户中有多少拥有 4 号小部件”之类的问题 如果我删除了客户，我怎么能得到它。或者更可能的是，如果从小部件表中删除了大小为 4 的小部件，这将导致引用完整性问题。一个“活动”位标志似乎对我有用，并且索引没有大的性能影响。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T07:08:32.903

我会受到业务需求的驱动。如果客户希望您立即恢复已删除的数据并且取消删除数据是业务逻辑和/或用例的一部分，那么*isDeleted*标志是有意义的。

否则，通过将已删除的数据留在数据库中，您可以解决更适合通过数据库备份和维护过程解决的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T08:08:53.420

这样做的机制之前已经讨论过好几次了。

[问题 771197](https://stackoverflow.com/questions/771197) [问题 68323](https://stackoverflow.com/questions/68323)

我个人最喜欢的一个 deleted_at 列记录在问题 771197 中

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T07:02:54.663

答案是，这取决于场景。

它需要撤消删除吗？
用户这样做的频率是多少？
随着时间的推移，它将产生多少条记录？

如果需要，您可以创建具有相同结构且名称为 _DELETED 后缀的表。
客户__已删除。

我认为您还应该考虑如果在您取消删除记录并且其他一些用户输入具有相似内容的记录时发生冲突会发生什么。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-01T08:11:59.313

我了解到删除数据很少有意义，因为总是有一些报告需要数据，或者更经常有人错误地删除并需要它回来。我个人将所有“已删除”的项目移动到数据库的存档版本中。然后将其单独备份，报告可以使用它。主数据库大小保持精简，恢复数据并不是什么大问题。

但就像其他人所说的那样，这取决于您的业务需求和数据库的规模/大小。存档/删除的字段可能就足够了。

# c# - 找出声明为超类的实例的子类类型

> ID：933782
> 
> 赞同：2
> 
> 时间：2009-06-01T06:54:50.357
> 
> 标签：c#, oop, types

假设我有超类 A，以及从 A 继承的子类 A1 和 A2，我怎样才能在下面的代码中获取变量的子类类型？

```
A _a1 = new A1();
A _a2 = new A2();
// Need type of A1 and A2 given the variables _a1 and _a2. 
```

另外，如果我有另一个子类 A2_1，它是 A2 的子类，我如何获得下面给定代码的最低子类类型？

```
A _a2_1 = new A2_1(); 
```

编辑：感谢您的回答。什么嘘嘘。过度思考问题，甚至没有尝试 GetType()。=/

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-01T06:56:20.383

`Console.WriteLine(_a1.GetType());`

GetType 可以返回变量的运行时类型，而与声明类型无关。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T06:57:30.053

您可以使用 GetType() 方法：

```
Type type = _a1.GetType();
Type subtype = _a2_1.GetType(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T06:57:03.753

对于第一个 - 只需使用`_a1.GetType()`and `_a2.GetType()`。第二个-“最低子类类型”是什么意思；*或：您期望*什么答案...（这可能有助于我们理解您的意思...）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-01T06:58:53.157

任何对象上的 GetType() 始终为您提供真实的对象类型，而不是超类的类型。如果您使用“new subclass()”创建子类的实例，那么“subclass”就是对象的类型。

调用 GetType() 是您的情况所需要的。

# sql - 何时使用复合索引？

> ID：933783
> 
> 赞同：16
> 
> 时间：2009-06-01T06:55:44.800
> 
> 标签：sql, database

关于使用复合索引的一般规则是什么？什么时候应该使用它们，什么时候应该避免它们？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-06-01T07:03:55.050

当您的 SELECT 查询经常使用这些列作为 WHERE 子句中的条件时，复合索引很有用。它提高了检索速度。如果没有必要，您应该避免使用它们。

这篇[文章](http://www.odetocode.com/Articles/70.aspx)提供了一些非常好的信息。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-06-01T09:18:21.830

只选择几个字段的查询可以完全在索引上运行。例如，如果您在 (OrderId) 上有一个索引，则此查询将需要表查找：

```
select Status from Orders where OrderId = 42 
```

但是，如果您在 (OrderId,Status) 上添加复合索引，引擎可以从索引中检索它需要的所有信息。

对多列进行排序可以受益于复合索引。例如， (LastName, FirstName) 上的索引将有利于此查询：

```
select * from Orders order by LastName, FirsName 
```

有时，您在多个列上有一个唯一的常量。例如，假设您每天都重新启动订单号。那么 OrderNumber 不是唯一的，但 (OrderNumber, OrderDayOfYear) 是唯一的。您可以使用唯一的复合索引来强制执行此操作。

我确信复合索引还有更多用途，仅列出几个示例。

# iphone - 帮助我开始使用 OpenGL

> ID：933793
> 
> 赞同：3
> 
> 时间：2009-06-01T06:59:53.577
> 
> 标签：iphone, opengl-es

直到今天我还在使用基本的 UIKIT 应用程序，但现在我需要在 OpenGL 中工作。

问题是我对OpenGL一无所知，并且对如何开始以及从哪里开始感到困惑。

我需要创建一个与“iBeer”相同的应用程序（请参阅 YouTube 中的电影）。

所以我对如何创建您在应用程序中看到的啤酒图形有很多困惑，那么应该首选什么库？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-01T07:35:47.043

创建 opengl 应用程序有点费时，学习语法并适应它需要时间。神奇地编写一个“ibeer”应用程序并不容易，即使它不是有史以来最先进的应用程序。
我不认为有任何捷径，你必须学习 opengl 及其语法。
iphone 也使用 Opengl|Es，它的语法与常规的 opengl 相差不远，但仍然有很大的不同，以至于你不能使用常规的 opengl 引擎。

我遇到的两个最好的 opengl 资源是：

*   [红皮书](http://www.glprogramming.com/red/)
*   [Nehe的游戏教程](http://nehe.gamedev.net/)

还有一些专门针对opengl|es和iphone开发的好教程

*   [Nehe教程移植到iphone](http://iphonedevelopment.blogspot.com/2008/12/nehe-tutorials-lesson-2-ported-to.html)
*   [关于 iphone 开发的博客文章](http://iphonedevelopment.blogspot.com/2008/12/start-of-wavefront-obj-file-loader.html)

但是我猜你对创建应用程序比学习 opengl 语法更感兴趣，因此你也应该看看一些 opengl-engines

*   [Irrlicht opengl 引擎](http://irrlicht.sourceforge.net/)
*   [统一](http://unity3d.com/company/news/iphone-press)

网络上可能还有一百万以上的资源，但应该可以帮助您入门。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-01T08:43:29.203

Jeff LaMarsh在[他的博客上有一本](http://iphonedevelopment.blogspot.com)[很好](http://iphonedevelopment.blogspot.com/2009/05/opengl-es-from-ground-up-table-of.html)的入门书。这是目录：

1.  基本概念。看简单
2.  在透视图中绘制视口
3.  要有光。
4.  生活在物质世界
5.  纹理和纹理映射

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-05T11:13:00.983

我建议将其他技术排除在等式之外并单独学习 OpenGL：然后查看 ES 的差异并介绍 iPhone 的细节等。我会支持 Mads 认为 NeHe 是一个不好的起点：这些中有一些错误未解决的教程（例如忘记了 OpenGL 的 y 坐标相对于大多数 UI 工具包是倒置的，但也忘记了 BMP 相对于 UI 工具包是倒置存储的，因此加载 BMP 并显示它是巧合而不是故意）。

上面推荐的 OpenGL 红皮书是我读过的最清晰和最好的书面计算书籍之一，但是免费的在线副本已经过时，所以请获取现代的死树副本。你不会后悔的。我再次同意 Mads 的观点，即对数学的良好理解很重要。我认为你可以在阅读红皮书的同时修正你的数学，因为它轻轻地打动了你，并且有一些附录涵盖了一些技巧。

最后，当尝试不同的东西时，比如平移、缩放等的影响，你经常会发现自己处于编译、调整、编译循环中。更有效的是拥有一个可以让您在运行时调整参数的应用程序：但是在学习的同时编写这样的东西有点棘手。Nate Robins 有一些*出色的*演示程序，可让您调整参数以调用 opengl 并在应用程序中向您展示其影响。opengl红皮书本身强烈推荐它们：[http ://www.xmission.com/~nate/opengl.html](http://www.xmission.com/~nate/opengl.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-01T13:40:26.810

学习 OpenGL 和/或 OpenGL ES 最好通过学习*计算机图形学*的先决条件概念以及学习所涉及的数学来完成。特别是线性代数、向量空间以及如何使用矩阵来表示协调系统。OpenGL 只是一个易于使用的 API，**只要您了解自己在做什么**。如果你害怕数学，不要浪费你的时间。

对于绝对初学者，我推荐《3D 数学入门》一书，其中包含[gamemath.com](http://gamemath.com/)上的勘误表和示例以及名为“矩阵和四元数常见问题解答”的在线文章，可在此处获得：[www.j3d.org/matrix_faq/matrfaq_latest.html](http://www.j3d.org/matrix_faq/matrfaq_latest.html)

iPhone 上使用的 OpenGL ES 1.x 实现规范： [http](http://www.khronos.org/opengles/1_X) : //www.khronos.org/opengles/1_X 最后但并非最不重要的是，OpenGL 2.1 规范和 OpenGL 着色语言的第一个版本， GLSL： [http ://www.opengl.org/registry/doc/glspec21.20061201.pdf](http://www.opengl.org/registry/doc/glspec21.20061201.pdf) [http://www.opengl.org/registry/doc/GLSLangSpec.Full.1.10.59.pdf](http://www.opengl.org/registry/doc/GLSLangSpec.Full.1.10.59.pdf)

与我交谈过的很多人都不认为规范算作图书馆用户的文档，但在我看来确实如此；仅仅因为它是准确的，它具有权威性，任何其他出版物无论如何都会引用它。如果您了解所需的数学知识和计算机图形学的一般概念，阅读该标准应该是轻而易举的事。

最后一句话：不惜一切代价避免 NeHe。我在这里看到了它的建议，如果你想走尝试失败的路线，这可能没问题。NeHe 的教程教*如何*，但不教*为什么*。大多数示例也非常过时。

如果您想在计算机上使用*OpenGL* ，我建议您专注于 OpenGL（着色器）的可编程管道而不是固定功能管道。（OpenGL ES 1.x 没有着色器） Cg、GLSL 和 HLSL 等着色器语言将继续存在。最新的 OpenGL 3.1 标准就是证明，其中完成任务的唯一方法是通过着色器。只是一个明智的警告，因为红皮书和其他“在 10 天内技术自己的 OpenGL”书籍倾向于关注后者。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-01T07:34:18.327

我发现这本书对于学习 OpenGL ES 1.1（iphone 支持的版本）非常有用： [http ://www.amazon.co.uk/Mobile-3D-Graphics-Kaufmann-Computer/dp/0123737273/ref=sr_1_3?ie =UTF8&s=书籍](http://www.amazon.co.uk/Mobile-3D-Graphics-Kaufmann-Computer/dp/0123737273/ref=sr_1_3?ie=UTF8&s=books)

虽然在阅读之前我已经了解了 OpenGL 的基础知识，但不能保证它对于一个初学者来说有多好。

其他人似乎喜欢“红皮书”，这里有免费的在线版本：[http](http://www.opengl.org/documentation/red_book/) ://www.opengl.org/documentation/red_book/ 这可能对学习基本原理很有用，但它涵盖了标准桌面 openGL，并且这与 Iphone 上可用的内容之间存在差异。

Iphone SDK 还附带了几个示例，我发现它们非常有用。

# asp.net-mvc - 如何从 ActionFilter 访问 ModelState？

> ID：933798
> 
> 赞同：47
> 
> 时间：2009-06-01T07:02:41.667
> 
> 标签：asp.net-mvc, action-filter, modelstate

我正在构建一个`ActionFilter`为简单的垃圾邮件块重用一些代码 - 基本上我所做的是我有一个`Html Helper`呈现输入文本框和隐藏输入的方法，并且在 ActionFilter 我检查这两个值是否相同. 如果没有，我想利用其余的验证逻辑并将 a 添加`ModelStateError`到`ModelState`，但我该怎么做呢？如何`ModelStateError`从 whithin 中添加一个`ActionFilter`？

更新：这是我正在尝试的代码。当我测试具有此属性的控制器操作时，即使我没有传递任何所需的表单值，它`ModelState.IsValid`仍然会返回：`true`

```
public override void OnActionExecuting(ActionExecutingContext filterContext)
{
    var r = filterContext.HttpContext.Request;
    if (r.Form["sixtimesnine"] != r.Form["fourtytwo"] || string.IsNullOrEmpty(r.Form["sixtimesnine"]) || string.IsNullOrEmpty(r.Form["fourtytwo"]))
    {
        filterContext.Controller.ViewData.ModelState.AddModelError("Spam", this.ErrorMessage);
    }
    base.OnActionExecuting(filterContext);
} 
```

这是`ActionMethod`：

```
[ValidateAntiSpam(ErrorMessage = "Spambotar får inte.")]
public ActionResult Write(GuestbookPost postToCreate)
{
    if (ModelState.IsValid)
    {
        _posts.Add(postToCreate);
        return RedirectToAction("Index");
    }
    return View();
} 
```

我刚刚注意到，如果我在`OnActionExecuting`方法内设置断点并点击“调试测试”，则永远不会命中断点。为什么？

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2009-06-01T07:21:16.403

那将是： `filterContext.Controller.ViewData.ModelState`

# asp.net - ie8中的asp.net ajax可折叠面板问题

> ID：933806
> 
> 赞同：0
> 
> 时间：2009-06-01T07:06:34.357
> 
> 标签：asp.net, internet-explorer-8, collapsiblepanelextender

任何人都可以在 ie8 浏览器中尝试这段简单的代码并尝试刷新页面，

在 ie8 中，您将在刷新时收到有关 getelementbyid 的错误。

当我运行它时，它抱怨无法找到 id 为 'ctl00_main_dd' 的控件

```
<cc1:CollapsiblePanelExtender ID="CollapsiblePanelExtender2" runat="server"     
     ImageControlID="Image2" CollapsedImage="~/App_Themes/IMStandard/icons/uparrow.png"
    ExpandedImage="~/App_Themes/IMStandard/icons/downarrow.png"
     CollapseControlID="dd" ExpandControlID="dd"
     TargetControlID="pnlQuickKeywordSearch"
     SuppressPostBack="true">
</cc1:CollapsiblePanelExtender>
 <asp:Panel ID="dd" runat="server">
    <h3 class="loginHeader">
        <asp:Image ID="Image2" runat="server" />
        &nbsp;&nbsp;Quick Keyword search&nbsp;<asp:Image ID="HelpIconImage" runat="server"
            Width="16px" Height="16px" ImageUrl="~/App_Themes/IMStandard/icons/help.png" /></h3>
</asp:Panel>
 <asp:Panel ID="pnlQuickKeywordSearch" Style="float: left; border: double 3px #C9DF86;"
    runat="server" >
    <div style="clear: both; padding: 5px;">
    </div></asp:Panel> 
```

有人知道为什么会这样吗？这是ie8中的错误还是我错过了什么？

顺便说一句，我正在使用母版页，但我认为这与它没有任何关系。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-01T07:32:03.387

这个例子适用于我在 Windows 7 上运行的 IE8。id 'ctl00_main_dd' 通常是生成的客户端 ID（VS2010 将使我们能够指定客户端 ID。）

您可以使用 div 代替 asp:panel 进行展开/折叠控件吗？

```
<div ID="dd">
    <h3 class="loginHeader">
        <asp:Image ID="Image2" runat="server" />
          Quick Keyword search <asp:Image ID="HelpIconImage" runat="server"
            Width="16px" Height="16px" ImageUrl="~/App_Themes/IMStandard/icons/help.png" /></h3>
</div> 
```

然后可折叠面板扩展器应该能够找到静态“dd”客户端 ID。

添加 02.06：没有很好的猜测为什么它只发生在 IE8 中

我会检查=>

1) 正确的母版页中的文档类型

```
DOCTYPE html PUBLIC “-//W3C//DTD XHTML 1.0 Transitional//EN” “http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd” 
```

2) 勾选 IE8 中的兼容性视图按钮（如果存在）

3) 确保所有 VS、Framework 和 Toolkit 都是最新版本（SP1）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-16T18:33:42.260

我们刚刚遇到了一个奇怪的场景，折叠面板中有一个带有 style="float:right;" 的标签，删除 div 标签解决了这个问题。希望这对其他人有帮助。

# iphone - 在保留纹理的同时更改 iPhone 表格视图（样式分组）背景颜色

> ID：933808
> 
> 赞同：18
> 
> 时间：2009-06-01T07:06:52.640
> 
> 标签：iphone, uitableview

我们如何更改 tableview 的背景颜色（样式分组），同时仍然保留细列/线条效果的纹理，当它具有默认蓝色时，我们可以看到它。如果我尝试使用 backgroundcolor 属性更改背景颜色，我会得到一个普通视图没有任何纹理。

谢谢

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2012-09-18T06:07:47.280

```
tableview.backgroundView = nil;
tableview.backgroundColor = [UIColor clearColor]; 
```

这可能会帮助您解决问题

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-06-01T08:39:03.110

首先，您可以尝试在 Stack Overflow 上搜索您的确切问题。这里有两个：

*   [如何设置 UITableView 的背景...](https://stackoverflow.com/questions/894875/how-can-i-set-the-background-of-uitableview-the-tableview-style-is-grouped-to-u)
*   [如何自定义分组表视图的背景/边框颜色？](https://stackoverflow.com/questions/400965/how-to-customize-the-background-border-colors-of-a-grouped-table-view)

如果这没有帮助，请尝试使表格视图的背景颜色透明`[UIColor clearColor]`，并在 UITableview 后面放置另一个视图，其中包含您需要的颜色/纹理/图像。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T13:55:26.353

创建tableView的属性：

```
@property (nonatomic, strong) IBOutlet UITableView *tableView; 
```

然后合成它：

```
@synthesize tableView = _tableView; 
```

在实现创建方法：

```
- (UITableView *) tableView {
  [_tableView setBackgroundColor:[UIColor whiteColor]];
  return _tableView;
} 
```

还要记住在 xib 文件中连接您的 tableView，它应该可以工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-09-15T13:45:34.127

无需编写代码，只需**在*****View*** **部分**中为 table view 的*Background*属性选择*Clear Color*。

 **# delphi - 简单的搜索引擎

> ID：933812
> 
> 赞同：1
> 
> 时间：2009-06-01T07:08:41.233
> 
> 标签：delphi, full-text-search

我正在尝试编写程序，它就像一个简单的搜索引擎，在这个程序中，用户应该在编辑框中输入搜索关键字，然后他可以单击搜索按钮，程序应该从目录并在此文本文件中找到与该关键字匹配的单词。我正在使用 Delphi 2007。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-14T20:49:28.910

如果您使用的是 unix 系统，请发送呼叫到[`grep`](http://en.wikipedia.org/wiki/Grep). 如果您使用的是 windows 系统，请安装[grep for windows](http://gnuwin32.sourceforge.net/packages/grep.htm)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-16T00:01:46.177

您可能想查看开源项目[GExperts](http://www.gexperts.org)的源代码。它包含一个运行良好的文本搜索引擎 (grep)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-16T23:57:13.410

基本上你需要在另一个字符串中找到一个字符串。看看这个算法：[http ://en.wikipedia.org/wiki/Knuth-Morris-Pratt_algorithm](http://en.wikipedia.org/wiki/Knuth-Morris-Pratt_algorithm)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-17T00:04:11.243

我在 C# 中写过类似的东西 - [Searcharoo.net](http://www.searcharoo.net/) - 你可以从那里下载源代码。

不过，可能更有用的是我写的描述它是如何工作的文章……这个关于[版本 1](http://www.searcharoo.net/SearcharooV1/)的描述可能会有一些用处——尽管我可能在我写它（早在 2004 年）之后就有偏见。

你的问题很开放，所以我不确定这是否会有所帮助 - 特别是因为我不了解 Delphi 以及它与 C# 的不同之处 - 但希望它有所帮助......

# c++ - 模拟窗口的移动并让它对碰撞做出反应

> ID：933821
> 
> 赞同：0
> 
> 时间：2009-06-01T07:13:37.307
> 
> 标签：c++, c, winapi

我正在阅读这个[主题](https://stackoverflow.com/questions/932706/how-to-programmatically-move-a-window-slowly-as-if-the-user-were-doing-it)，我决定试一试。令我惊讶的是，它似乎真的比我猜的要容易。我对“DesiredPos”变量有些困惑。至少在我的实现中。我试图不断移动一个窗口，让它在碰到显示器边缘时像球一样反应。就像乒乓球比赛中的球一样。我已经制作了这样的程序来移动鼠标，但我似乎无法理解这个。

这是我到目前为止所拥有的，当涉及到 Windows API 中的许多功能时，我的经验有限。请记住，这是一个核心草稿。

编辑我还没有实现任何碰撞检测，但我只是想让移动部分工作。

```
#include <windows.h>
#include <math.h>

int newX(int oldx);
int newY(int oldy);
double SmoothMoveELX(double x);
int main()
{

    int lengthInMs = 10*1000;
    HWND notepad = FindWindow("Notepad",NULL);
    RECT window;
    SetTimer(
            notepad,
            NULL,
            30,
            (TIMERPROC)NULL
            );
    int startTime = GetTickCount();
    int pos = elap / lengthInMs;

    while(1)
    {
            RECT window;
            GetWindowRect(notepad,&window);
            int elap = (GetTickCount() - startTime);
            if(elap  >= lengthInMs)
            {
                  int NEWX = NewX(window.x);
                  int NEWY = NewY(window.y);
                  MoveWindow(
                             notepad,
                             NEWX,
                             NEWY,
                             100,
                             100,
                             TRUE
                             );  
                             }
                             }
} 

int NewX(int oldx)
{
    int newx = oldx*(1-SmoothMoveELX(pos))
             + 10 *SmoothMoveELX(pos));

    return newx;
}

int newY(int oldy)
{
    int newy = oldy*(1-SmoothMoveELX(pos))
             + 10 *SmoothMoveELX(pos));
    return newy;
}

double SmoothMoveELX(double x)
{
       double PI = Atan(1) * 4;
       return ((cos(1 - x) * PI + 1) /2 )
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T13:07:30.043

我的建议是看一下“verlet integration”。这是模拟基本力学的一种非常简单的方法。谷歌搜索它，你会发现很多例子，包括碰撞检测和摩擦。从长远来看，这将为您提供更自然的结果，然后使用正弦函数估计速度或新位置。

# c# - 在 IronPython 和 IronRuby 中打包脚本源文件

> ID：933822
> 
> 赞同：3
> 
> 时间：2009-06-01T07:14:45.760
> 
> 标签：c#, python, ruby, ironpython, ironruby

有谁知道如何将 python 和 ruby​​ 库添加为 dll 中的资源以进行部署？我想在我的应用程序中托管一个脚本引擎，但不想在源文件中部署相应语言的整个标准库。有没有一种简单的方法可以让 require 或 import 语句找到嵌入的资源？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T12:23:55.480

您可以添加自定义导入挂钩，以便在执行导入时查找嵌入式资源。这有点复杂，可能不值得麻烦。

更好的技术是在启动时获取所有嵌入式模块，使用 ScriptEngine 执行它们并将您创建的模块放入与引擎关联的 sys.modules 字典中。这会自动使它们可供引擎执行的 Python 代码导入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T08:19:01.450

You can create StreamContentProviders for example

In the ironrubymvc project under IronRubyMVC/Core/ you will find what you need.

[AssemblyStreamContentProvider](http://github.com/casualjim/ironrubymvc/blob/01fc9e5f4cd6b3c0f96a75acd9521673b3f0701e/IronRubyMvc/Core/AssemblyStreamContentProvider.cs)

[Usage of the ContentProvider](http://github.com/casualjim/ironrubymvc/blob/01fc9e5f4cd6b3c0f96a75acd9521673b3f0701e/IronRubyMvc/Core/RubyEngine.cs#L246)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T08:35:49.950

IronPython 2.0 在 Codeplex.com/ironpython 上有一个名为 PYC 的示例编译器，它可以创建 DLL（如果您也需要它们，还可以创建应用程序）。

IronPython 2.6 在 Tools\script 下有一个更新版本的 PYC。

干杯，戴维

# projects-and-solutions - 流口水相关问题

> ID：933823
> 
> 赞同：0
> 
> 时间：2009-06-01T07:14:54.730
> 
> 标签：projects-and-solutions, drools

嗨，我想在我的网站上做一些改变。所以我写了一套规则，但我不知道如何在我希望它们工作的地方解雇它们，即我网站的原始代码。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-25T16:57:38.503

当你有你的 abc 对象时，这将是你插入到工作内存中的事实。例如：

```
KnowledgeBuilder kbuilder = KnowledgeBuilderFactory.newKnowledgeBuilder();
kbuilder.add( ResourceFactory.newFileSystemResource( fileName ), ResourceType.DRL );
if (kbuilder.hasErrors() ) {
    System.out.println( kbuilder.getErrors() );
} else {
    KnowledgeBase kbase = KnowledgeBaseFactory.newKnowledgeBase();
    kbase.addKnowledgePackages( kbuilder.getKnowledgePackages() );
    StatelessKnowledgeSession ksession = kbase.newStatelessKnowledgeSession();
    ksession.execute( abc );
} 
```

然后，当执行完成时，您将拥有修改后的 abc 对象。看看[这里](http://downloads.jboss.com/drools/docs/5.0.1.26597.FINAL/drools-expert/html/ch03.html#d0e1797)

您可能不希望每次都构建规则（这实际上是时间消费者），因此您可以使用 KnowledgeAgent 或拥有静态知识库，并在规则文件更改时重新创建它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T07:34:31.760

缺少一些信息（例如 Drools 的哪个版本、您正在运行的环境等），所以我会尝试以一般的方式回答，如果您需要更具体的信息，请告诉我：

通常，在 Drools 中，您将对象“断言”到工作内存中（使用诸如 assertObject 之类的方法），这允许规则引擎知道它们，然后，当您在该工作内存上执行“fireAllRules”时，所有规则都已执行（因此，您可以在需要时在工作内存上显式调用 fireAllRules 方法 - 我认为这就是您要问的）。

有关更多详细信息，如果您还没有看过，可以查看： http: [//legacy.drools.codehaus.org/Working+Memory](http://legacy.drools.codehaus.org/Working+Memory)。

谢谢加迪

# python - Python 正则表达式搜索和替换

> ID：933824
> 
> 赞同：4
> 
> 时间：2009-06-01T07:15:04.823
> 
> 标签：python, regex, string, markdown

我不是 Python 新手，而是一个使用正则表达式的完整新手（在我的待办事项列表中）

我正在尝试使用 python re 来转换字符串，例如

```
[Hollywood Holt](http://www.hollywoodholt.com) 
```

到

```
<a href="http://www.hollywoodholt.com">Hollywood Holt</a> 
```

和一个字符串

```
*Hello world* 
```

到

```
<strong>Hello world</strong> 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-01T07:16:50.967

你为什么要费心使用正则表达式？您的内容是 Markdown，为什么不简单地获取字符串并通过 markdown 模块运行它？

首先，确保已安装 Markdown。它对 ElementTree 有依赖关系，所以如下所示轻松安装它们两个。如果您运行的是 Windows，则可以改用[Windows 安装程序](http://pypi.python.org/packages/any/M/Markdown/Markdown-2.0.win32.exe)。

```
easy_install ElementTree
easy_install Markdown 
```

要使用 Markdown 模块并将字符串转换为 html，只需执行以下操作（三引号用于文字字符串）：

```
import markdown
markdown_text = """[Hollywood Holt](http://www.hollywoodholt.com)"""
html = markdown.markdown(markdown_text) 
```

# c# - 处置表单时处置子表单的 WinForm

> ID：933825
> 
> 赞同：0
> 
> 时间：2009-06-01T07:16:05.540
> 
> 标签：c#, winforms, dispose

我有一个可以打开子表单的表单（带有`ShowDialog`）。我想确保在主表单完成后正确处理子表单。我尝试将子表单添加到`components`主表单的成员中，但此时我得到了一个`ArgumentNullException`.
我知道我可以实例化`components`我自己，但这不是有点危险吗？有一天，我将在设计器视图中添加一个组件，这将`new Container()`在 Designer.cs 文件中生成该行，我永远不会知道我有两个组件实例在堆周围运行。
是否有更简单的方法来确保正在处理子表单？

编辑 - 将我的解决方案移至答案

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T07:39:51.653

如果您在 showdialog 中使用该表格，您可能会认为在收到结果后您可以在那里处理该表格？

```
using(MyDialog dlg = new MyDialog())
{
   result = dlg.ShowDialog();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T10:02:26.563

您通常不能覆盖表单的 Dipose 方法，因为它已经在 Form.Designer.cs 文件中定义。有一个小技巧如何将您自己的处理逻辑添加到表单中。

使用以下类：

```
public class Disposer : Component
    {
        private readonly Action<bool> disposeAction;               

        public Disposer(Action<bool> disposeAction)
        {
            this.disposeAction = disposeAction;
        }

        protected override void Dispose(bool disposing)
        {
            base.Dispose(disposing);
            this.disposeAction(disposing);
        }

        public static Disposer Register(ref IContainer container, Action<bool> disposeAction)
        {
            Disposer disposer = new Disposer(disposeAction);
            if (container == null)
                container = new System.ComponentModel.Container();

            container.Add(disposer);
            return disposer;
        }
    } 
```

保留子表单列表并将以下行添加到主表单的构造函数中：

```
Disposer.Register(ref this.components, this.MyDisposeAction); 
```

当您的主窗体被释放时，您的所有子窗体也将被释放，例如：

```
private void MyDisposeAction(bool disposing)
{
  if (disposing)
  {
    foreach (var subForm in this.subForms)
    {
      subForm.Dispose(disposing);
    }
  } 
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T09:15:10.510

根据[MSDN](http://msdn.microsoft.com/en-us/library/c7ykbedk.aspx)，通过调用的模态表单`ShowDialog()`不会自动处理，开发人员有责任处理它们：

> 当窗体显示为模式对话框时，单击关闭按钮（窗体右上角带有 X 的按钮）会导致窗体隐藏并且 DialogResult 属性设置为 DialogResult.Cancel。与无模式表单不同，当用户单击对话框的关闭表单按钮或设置 DialogResult 属性的值时，.NET Framework 不会调用 Close 方法。相反，该表单被隐藏并且可以再次显示而无需创建对话框的新实例。因为显示为对话框的表单没有关闭，所以当您的应用程序不再需要该表单时，您必须调用该表单的 Dispose 方法。

这里的相关点是“不再需要表格时”。在您的情况下，您似乎需要后续操作的表单，因此将`ShowDialog()`调用包装在`using`构造中不会达到目的。

我的建议是在 Main 表单的 Dispose 方法中处理 Dialog，或者尽早处理：

```
protected override void Dispose(bool disposing)
{
  if (disposing && (components != null))
  {
    components.Dispose();
  }
  // dlg is a variable of type Form2(the dialog)
  if (dlg != null)
  {
    dlg.Dispose();
    dlg = null;
  }
  base.Dispose(disposing);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-29T06:21:10.217

My current workaround:
I've added the Components property to the form, and am using it to access the collection

```
private IContainer Components{    get { return components ?? (components = new Container());}} 
```

# c# - 在 C# 中实现多态性，如何最好地做到这一点？

> ID：933831
> 
> 赞同：3
> 
> 时间：2009-06-01T07:19:01.243
> 
> 标签：c#, oop, polymorphism

这里的第一个问题，所以希望你们都对我温柔！

在过去的几天里，我一直在阅读大量关于多态性的文章，并试图将其应用到我在 c# 中所做的事情中，似乎有几种不同的方法可以实现它。我希望我已经掌握了这一点，但即使我没有澄清，我也会很高兴。

据我所知，我有 3 个选项：

1.  我可以从基类继承并`virtual`在我希望派生类覆盖的任何方法上使用关键字''。
2.  我可以用虚拟方法实现一个抽象类并这样做，
3.  我可以使用接口吗？

从我所见，如果我不需要基础中的任何实现逻辑，那么接口给了我最大的灵活性（因为我在多重继承等方面没有限制自己），但是如果我需要基础为了能够在派生类正在做的事情之上做一些事情，那么使用 1 或 2 会是更好的解决方案吗？

感谢您对这些人的任何意见 - 这个周末我在这个网站和其他地方读了很多书，我*想*我现在理解了这些方法，但如果我是对的，我只想以一种特定语言的方式澄清追踪。希望我也正确标记了这个。

干杯，特里

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-01T07:29:10.413

接口提供了最多的抽象；您不受任何特定实现的约束（如果由于其他原因该实现必须具有不同的基类，则很有用）。

对于真正的多态，`virtual`是必须的；多态性最常与类型子类相关...

您当然可以将两者混合使用：

```
public interface IFoo {
    void Bar();
}
class Foo : IFoo {
    public virtual void Bar() {...}
}
class Foo2 : Foo {
    public override ...
} 
```

`abstract`是另一回事；的选择`abstract`真的是：它可以由基类明智地定义吗？如果没有默认实现，则必须是`abstract`.

当有很多通用的实现细节时，一个通用的基类会很有用，而纯粹通过接口复制是没有意义的；但有趣的是 - 如果实现*永远不会*因实现而异，扩展方法提供了一种有用的方法来在 an 上公开它`interface`（这样每个实现都不必这样做）：

```
public interface IFoo {
    void Bar();
}
public static class FooExtensions {
    // just a silly example...
    public static bool TryBar(this IFoo foo) {
        try {
             foo.Bar();
             return true;
        } catch {
             return false;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T07:26:00.373

以上三点都是有效的，并且本身就很有用。没有“最好”的技术。只有编程实践和经验才能帮助您在正确的时间选择正确的技术。

所以，选择一个现在看起来合适的方法，然后实施。看看什么有效，什么失败，吸取教训，然后再试一次。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-01T07:32:07.613

接口通常受到青睐，原因如下：

*   多态是关于契约，继承是关于重用
*   继承链很难正确处理（尤其是单继承，请参见 Windows 窗体控件中的设计错误，其中可滚动性、富文本等功能在继承链中被硬编码
*   继承导致维护问题

也就是说，如果您想利用通用功能，您可以使用接口来实现多态性（让您的方法接受接口），但使用抽象基类来共享某些行为。

```
public interface IFoo
{
    void Bar();
    enter code here
} 
```

将是你的界面

```
public abstract class BaseFoo : IFoo
{
    void Bar
  {
        // Default implementation
  }
} 
```

将是您的默认实现

```
public class SomeFoo : BaseFoo
{

} 
```

是一个你重用你的实现的类。

尽管如此，您仍将使用接口来实现多态性：

```
public class Bar
{
   int DoSometingWithFoo(IFoo foo)
{

    foo.Bar();
}
} 
```

注意我们在方法中使用了接口。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-01T07:32:13.340

你应该问的第一件事是“为什么我需要使用多态性？”，因为多态性本身并不是 and end，而是达到目的的一种手段。明确定义问题后，应该更清楚使用哪种方法。

无论如何，您评论的这三个方法并不是排他性的，如果您只需要在某些类而不是其他类之间重用逻辑，或者需要一些不同的接口，您仍然可以混合使用它们......

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-01T07:33:31.463

*   使用抽象类来执行类结构
*   使用接口来描述行为

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-01T07:34:31.900

这实际上取决于您想如何构建代码以及您想用它做什么。

从测试的角度来看，拥有接口类型的基类是好的，因为您可以使用模拟对象来替换它。

如果您希望在某些函数中而不是其他函数中实现代码，那么抽象类确实是这样，就好像抽象类除了抽象函数之外什么都没有，它实际上是一个接口。

请记住，抽象类不能被实例化，因此对于工作代码，您必须有一个派生自它的类。

在实践中，一切都是有效的。

如果我有很多从抽象类派生的类但在浅层（比如只有 1 个类），我倾向于使用抽象类。

如果我期待更深层次的继承，那么我会使用一个带有虚函数的类。

不管怎样，最好保持类的简单，以及它们的继承，因为它们越复杂，就越有可能引入错误。

# asp.net - ASP.NET 登录控制

> ID：933837
> 
> 赞同：1
> 
> 时间：2009-06-01T07:22:36.667
> 
> 标签：asp.net, login-control

我打算在 ASP.NET 3.5 Web 应用程序中使用来自 ASP.NET 2.0 的 members.authentication/authorization API。但是，当我为登录组件实现 LoggedIn 方法时，如下所示：

```
protected void Login1_LoggedIn(object sender, EventArgs e)
    {
        Label1.Text = User.Identity.Name;
    } 
```

名称为空值...用户名/密码正确，如果使用默认行为，登录控件工作正常，但似乎身份未正确初始化。关于如何获取具有关联值的当前用户对象的任何想法？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T07:34:30.777

您可能需要先检查 User.IsAuthenticated 是否为真

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T07:35:28.217

您可以使用[Membership.GetUser](http://msdn.microsoft.com/en-us/library/system.web.security.membership.getuser.aspx)方法来完成同样的事情：

```
Label1.Text = Membership.GetUser().UserName 
```

# asp.net - 为什么我们的机器上的 Intranet 这么慢？

> ID：933839
> 
> 赞同：1
> 
> 时间：2009-06-01T07:22:54.450
> 
> 标签：asp.net, iis, performance

我们在我们的机器上使用 IIS 5 + Windows XP，它们有 Celeron CPU @ 2.6 ghz，2 GB RAM

这些机器有机器控制系统，控制系统将事件记录到数据库，我们希望显示机器使用情况、操作员登录等报告。我们使用 Windows XP 和 IIS 5，我们的应用程序是 ASP.NET (3.5)。我们使用 Sql server 2005 express 和 Crystal Reports 10.5 进行报告。

问题是，每当您在重新启动或网络服务器长时间不活动后打开 Intranet 页面时，页面需要很长时间才能做出反应，10-30 秒。当我打开一个显示报告的页面时，它也会滞后这段时间。

在第一次长时间加载后查看页面时，它们会快速呈现。

页面是预编译的（有一点帮助，但不大），磁盘没有碎片，sql server 反应很快（用其他应用程序测试） - 我真的不知道是什么原因，但我想消除它，因为这对客户来说看起来很糟糕 - 等待半分钟才能显示报告页面。

为什么这么慢？我已经在 php/mysql/iis 上完成了一些示例页面，而且速度非常快......我可以做些什么来在机器重启时“预加载”所有 Intranet 应用程序？如果没有任何帮助，我会制作一个简单的脚本，它会定期从网络服务器请求所有页面，所以它会被“预热”，但我认为这是一个愚蠢的解决方案。:(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T07:27:15.127

我猜可能直到第一个请求才加载网站的应用程序池 - 这次是进程外主机进程开始运行并提供请求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T07:47:31.857

IIS 在回收后需要几秒钟来编译每个 ASPX 页面。您需要创建一个预热脚本，在回收后以编程方式加载您的一些页面。该脚本将导致延迟，因此您的用户不必这样做。

这是一个例子。[http://blogs.msdn.com/joelo/archive/2006/08/13/697044.aspx](http://blogs.msdn.com/joelo/archive/2006/08/13/697044.aspx)适用于 SharePoint，但概念相同，您应该能够适应它。

# c++ - 如何使用 Perl 的 C++ 类？

> ID：933844
> 
> 赞同：14
> 
> 时间：2009-06-01T07:27:57.810
> 
> 标签：c++, perl, xs

我有一组用 C++ 编写的类。从 Perl 脚本调用它们的最佳方法是什么？谢谢。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-01T16:55:16.440

我不是特别喜欢 SWIG，而是更喜欢自己编写接口代码。Perl 带有一种称为“XS”的伪语言，用于连接 C 或 C++。不幸的是，为了使用它，您至少需要了解 C、Perl，然后还要了解一些有关解释器 API 的知识。如果您已经非常了解 Perl 和 C，那么这并不是*很大*的一步。在 XS 上查看以下核心文档：

1.  [perlxstut](http://perldoc.perl.org/perlxstut.html)（XS 教程）
2.  [perlxs](http://perldoc.perl.org/perlxs.html)（XS 参考）
3.  [perlapi](http://perldoc.perl.org/perlapi.html)（解释器 API）

此外，互联网上有很多教程和操作方法。

现在，使用 XS 连接到 C++ 需要一些额外的步骤。一开始锻炼可能有点令人沮丧，但一旦你得到它，就会整齐地落入到位。在这方面，核心文档充其量是稀疏的。但一切都没有丢失。Perl 的 wxWidgets 绑定的创建者 Mattia Barbon 编写了一个很棒的工具“XS++”，它使这变得非常简单（或像 XS 一样简单）。它包含在 Wx 中，但我们正在努力将其拆分为自己的发行版。这是正在进行的工作。你可以在 github 上找到[Mattia 的 XS++ 代码](http://github.com/mbarbon/extutils-xspp/tree/master)和[我的修改版本。](http://github.com/mbarbon/extutils-xspp/network)

除非将独立的 XS++ 发布到 CPAN，否则我建议从其他资源中学习为 C++ 编写 XS：

*   很久以前，John Keizer 写了一篇[关于 XS 和 C++ 的优秀教程](http://www.johnkeiser.com/perl-xs-c++.html)。它还包括指向有用工具和文档的更多指针。
*   我从那个教程和我在 CPAN 上找到的一些示例中学习了 XS&C++。我不记得我当时看了什么。但现在我可以指出我自己的工作是一个（好还是坏，我不知道）示例：[Math::SymbolicX::FastEvaluator](http://search.cpan.org/dist/Math-SymbolicX-FastEvaluator)。
*   同样，计划中的 XS++ 发行版包含一个使用 XS++ 连接 C++ 和 Perl的[完整（尽管毫无意义）示例。](http://github.com/tsee/extutils-xspp/tree/0deb4fce1858701d09da4dfb30569e4de8132070/examples/Object-WithIntAndString)由于 XS++ 被翻译成普通的 XS，您可以使用它来*生成*示例。

PS：还有 Inline::CPP 模块。如果可行，它可能是最简单的解决方案。不过，我怀疑它是否可以处理模板。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-06-01T07:40:52.010

检查[http://www.swig.org](http://www.swig.org)：

> “SWIG 是一种软件开发工具，它将用 C 和 C++ 编写的程序与各种高级编程语言连接起来。SWIG 用于不同类型的语言，包括常见的脚本语言，如 Perl、PHP、Python、Tcl 和 Ruby。”

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-06-01T18:13:17.230

我通常会选择 XS，比如 tsee，但也有[Inline::C](http://search.cpan.org/perldoc?Inline::C)（或在这种情况下为[Inline::CPP](http://search.cpan.org/perldoc?Inline::CPP)）。我不喜欢 SWiG 并且倾向于避免围绕它构建的软件包。

# c++ - 如何在 C 中找到可执行文件的位置？

> ID：933850
> 
> 赞同：160
> 
> 时间：2009-06-01T07:29:47.197
> 
> 标签：c++, c, linux, unix, path

C/C++ 中有没有办法找到当前执行程序的位置（完整路径）？

（问题`argv[0]`在于它没有给出完整的路径。）

* * *

## 回答 #1

> 赞同：211
> 
> 时间：2009-06-01T08:40:25.417

总结一下：

*   在 Unix 上，`/proc`真正直接和可行的方法是：

    *   `readlink("/proc/self/exe", buf, bufsize)`(Linux)

    *   `readlink("/proc/curproc/file", buf, bufsize)`(FreeBSD)

    *   `readlink("/proc/self/path/a.out", buf, bufsize)`（索拉里斯）

*   `/proc`在没有（即如果上述失败）的Unix上：

    *   如果 argv[0] 以“/”（绝对路径）开头，这就是路径。

    *   否则，如果 argv[0] 包含“/”（相对路径），则将其附加到 cwd（假设尚未更改）。

    *   否则在目录中搜索`$PATH`可执行文件`argv[0]`。

    之后检查可执行文件是否实际上不是符号链接可能是合理的。如果是相对于符号链接目录解析它。

    /proc 方法中不需要此步骤（至少对于 Linux）。proc 符号链接直接指向可执行文件。

    请注意，正确设置取决于调用进程`argv[0]`。大多数情况下这是正确的，但是在某些情况下调用进程不能被信任（例如 setuid 可执行文件）。

*   在 Windows 上：使用`GetModuleFileName(NULL, buf, bufsize)`

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-06-01T07:40:41.933

如果您使用的是 Windows，请使用[GetModuleFileName()函数。](http://msdn.microsoft.com/en-us/library/ms683197(VS.85).aspx)

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-06-01T08:12:56.813

Please note that the following comments are unix-only.

The pedantic answer to this question is that there is no **general** way to answer this question correctly in all cases. As you've discovered, argv[0] can be set to anything at all by the parent process, and so need have no relation whatsoever to the actual name of the program or its location in the file system.

However, the following heuristic often works:

1.  If argv[0] is an absolute path, assume this is the full path to the executable.
2.  If argv[0] is a relative path, ie, it contains a `/`, determine the current working directory with getcwd() and then append argv[0] to it.
3.  If argv[0] is a plain word, search $PATH looking for argv[0], and append argv[0] to whatever directory you find it in.

Note that all of these can be circumvented by the process which invoked the program in question. Finally, you can use linux-specific techniques, such as mentioned by emg-2\. There are probably equivalent techniques on other operating systems.

Even supposing that the steps above give you a valid path name, you still might not have the path name you actually want (since I suspect that what you actually want to do is find a configuration file somewhere). The presence of hard links means that you can have the following situation:

```
-- assume /app/bin/foo is the actual program
$ mkdir /some/where/else
$ ln /app/bin/foo /some/where/else/foo     # create a hard link to foo
$ /some/where/else/foo 
```

Now, the approach above (including, I suspect, /proc/$pid/exe) will give `/some/where/else/foo` as the real path to the program. And, in fact, it is *a* real path to the program, just not the one you wanted. Note that this problem doesn't occur with symbolic links which are much more common in practice than hard links.

In spite of the fact that this approach is in principle unreliable, it works well enough in practice for most purposes.

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-06-02T11:34:22.183

实际上不是答案，而只是要记住的注释。

正如我们所看到的，在 Linux 和 Unix 中查找运行可执行文件位置的问题是相当棘手且特定于平台的。在这样做之前应该三思而后行。

如果你需要你的可执行位置来发现一些配置或资源文件，也许你应该遵循 Unix 将文件放置在系统中的方式：将配置放在当前用户主目录`/etc`或`/usr/local/etc`或在当前用户主目录中，`/usr/share`这是放置资源文件的好地方。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-06-01T07:37:09.977

在许多 POSIX 系统中，您可以检查位于 /proc/PID/exe 下的 simlink。几个例子：

```
# file /proc/*/exe
/proc/1001/exe: symbolic link to /usr/bin/distccd
/proc/1023/exe: symbolic link to /usr/sbin/sendmail.sendmail
/proc/1043/exe: symbolic link to /usr/sbin/crond 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-06-01T09:18:31.847

请记住，在 Unix 系统上，二进制文件可能在启动后就被删除了。它在 Unix 上是完全合法和安全的。最后我检查了 Windows 将不允许您删除正在运行的二进制文件。

/proc/self/exe 仍然是可读的，但它不会是一个真正的工作符号链接。这将是……奇怪。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2014-09-19T17:42:43.763

在 Mac OS X 上，使用[`_NSGetExecutablePath`](https://developer.apple.com/library/mac/documentation/Darwin/Reference/ManPages/man3/dyld.3.html).

请参阅[`man 3 dyld`](https://developer.apple.com/library/mac/documentation/Darwin/Reference/ManPages/man3/dyld.3.html)和[this answer](https://stackoverflow.com/a/1024933/733626) to a similar question。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-08-05T21:40:54.273

对于 Linux，您可以找到`/proc/self/exe`捆绑在一个名为 binreloc 的好库中的处理方式，您可以在以下位置找到该库：

*   [http://autopackage.org/docs/binreloc/](http://autopackage.org/docs/binreloc/)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-19T19:03:20.250

我会

1) 使用 basename() 函数：[http](http://linux.die.net/man/3/basename)
://linux.die.net/man/3/basename 2) chdir() 到那个目录
3) 使用 getpwd() 获取当前目录

这样，您将获得整洁、完整的目录，而不是 ./ 或 ../bin/。

如果这对您的程序很重要，也许您会想要保存和恢复当前目录。

# windows-mobile - 如何在windows Mobile中进行电话会议

> ID：933854
> 
> 赞同：0
> 
> 时间：2009-06-01T07:32:33.400
> 
> 标签：windows-mobile, compact-framework, opennetcf

谁能指导我如何从 netcf 进行电话会议...在 Windows Mobile 中，就像我有三个号码一样，我想给他们打电话参加电话会议...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T08:34:28.097

我自己从来没有这样做过，但是您必须使用[Telephony API](http://msdn.microsoft.com/en-us/library/aa922068.aspx)。

您会在其中找到以下功能：

[lineSetupConference](http://msdn.microsoft.com/en-us/library/aa918927.aspx) , [lineAddToConference](http://msdn.microsoft.com/en-us/library/aa918522.aspx)等

我建议您仔细阅读 MSDN 部分，因为 TAPI 不是很容易使用。

我不确定您对 C# 有多少访问权限，并且还建议在 C/C++ 中完成使用这些的编码，您可以通过 DLL 在更简化的 API 中公开它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T08:31:43.577

您不能在 Windows Mobile 设备上同时拨打三个号码。它可能只有一张 SIM 卡（如果是双 SIM 卡设备，最多两张）。

通常电话会议由第三方或某种允许多人拨入的电话服务器管理。

# visual-studio - 如何解决以下 C2220 错误？

> ID：933862
> 
> 赞同：5
> 
> 时间：2009-06-01T07:35:07.453
> 
> 标签：visual-studio, visual-studio-2005

构建项目时出现以下错误。即使我将属性“将警告视为错误”设置为“否”，我也得到了这个：

```
error C2220: warning treated as error - no object file is created. 
```

任何人都可以帮我解决这个问题吗？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T15:41:31.803

[C2220](http://msdn.microsoft.com/en-us/library/ksk5k0ta(VS.80).aspx)的文档建议在较低的警告级别进行编译。它还表明，被视为错误选项的警告被实现为编译器标志：/WX。因此，您可以在 .vcproj 文件中搜索该文本并手动将其从文件中删除。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T07:56:44.240

Probably you forgot to add an header. Just where you get the first warning and see in what header file is defined.

Regards

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-09-03T11:37:00.783

```
#pragma warning(disable : 4146) 
```

在文件级别进行设置，而不是更改项目设置。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-07-14T20:46:03.253

我收到“错误 C2220：警告视为错误 - 未创建目标文件。” 在下面的代码中。
一旦我将total 的**数据类型更改为****int**，错误就解决了。

```
int colNum=0;
unsigned int total=123;
for (colNum=0;colNum<total;colNum++) { 
```

# git - 在一个 git 存储库中维护不相关的目录

> ID：933864
> 
> 赞同：9
> 
> 时间：2009-06-01T07:35:41.913
> 
> 标签：git

我想在一个 git 存储库中合并两个或多个目录。这些存储库在逻辑上是链接的，但属于不同的文件系统路径，*例如* `/etc/httpd`，`/var/named/chroot/var/named`它们都包含我想作为一个整体管理的虚拟主机数据，但我无法链接它们。

我已经[询问了 git 邮件列表](http://n2.nabble.com/Maintaining-a-repository-with-symlinks-td2844705.html#a2844705)，但没有运气。

建议？

* * *

**更新：**我不使用这种机制来部署代码，我只是发现这是一种非常方便的方式：

*   跟踪发生的变化，这样我就可以很容易地`git checkout`解决以前已知的稳定点和事件`git bisect`配置问题。
*   在单独的目录中暂存更改，然后在执行更改时从该目录中提取。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T09:29:14.023

最好的方法是编写一个部署文件的脚本，并使用 Git 来管理项目的源代码。如果您有更复杂的需求，那么 Puppet 等管理工具可以与版本控制集成。

直接 Git 签出不是进行部署的好方法——它不是为此而设计的。您可以通过使用导出工具来避免在目标系统上拥有存储库的问题，但根据设计，Git 不会存储文件的完整权限/ACL 数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T12:25:00.020

也许您可以设置一个具有多个不相交分支的 Git 存储库，一个用于您要跟踪的每个不同的目录树。我不确定这种安排是否会满足您的所有要求，但它可以让您将不同的目录保存在同一个存储库中。

# java - 如何在 BigDecimal 上获取Scale？

> ID：933866
> 
> 赞同：2
> 
> 时间：2009-06-01T07:35:52.537
> 
> 标签：java, bigdecimal

我发现 BigDecimal 有 setScale 方法，但没有 getScale 方法。如何在 BigDecimal 上获取Scale？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-01T07:41:01.073

BigDecimal 中有 scale()（在这种情况下不是 getScale）方法，它返回由 setScale(..) 设置的比例。见： http: [//java.sun.com/j2se/1.5.0/docs/api/java/math/BigDecimal.html#scale()](http://java.sun.com/j2se/1.5.0/docs/api/java/math/BigDecimal.html#scale())

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-01T07:43:21.490

[BigDecimal.scale()](http://java.sun.com/j2se/1.5.0/docs/api/java/math/BigDecimal.html#scale())：

> 公共整数比例（）
> 
> 返回此 BigDecimal 的小数位数。如果为零或正数，则刻度是小数点右侧的位数。如果为负数，则将数字的未缩放值乘以 10 的负数次方。例如，-3 的比例表示未缩放的值乘以 1000。
> 
> 返回：此 BigDecimal 的小数位数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T07:42:34.427

使用 BigDecimal.scale()

# php - 在这种情况下使用什么 mysql 表结构

> ID：933872
> 
> 赞同：2
> 
> 时间：2009-06-01T07:38:58.193
> 
> 标签：php, mysql, database-design

我需要为房地产网站创建数据库结构，用户可以在其中创建多种类型的属性以及与属性相关的许多功能。

主要类别将是：1\. 住宅（子类型公寓、房屋、阁楼） 2\. 商业（子类型：酒店、建筑物、办公室、工厂） 3\. 地形（子类型：城市、农业、工业、运动）

以上所有这些都可以定义许多特征，例如公寓：灯光、燃气、房间数量、浴室、楼层号、阳台等，这些特征因一种房产类型而异。

目前，我有一个名为的主表`property`，其中包含地址和价格等基本信息，以及三个子表`property_house`、`property_commercial`、 ，并且`property_terrain`具有与属性一样多的字段。

这个结构好吗？我需要将所有属性类型的创建和修改为一种形式，可能需要 3-4 个步骤，并且会因一种属性类型而异。如果我只有一个主表，`property`而第二个`property_features`用于存储 property_id、feature_name 和 feature_value 会更容易吗？什么是最好的性能和维护？你们会投票给什么？

谢谢！:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T08:01:25.450

I have experience with both ways you have mentioned. ( I'm co-developer of iRealty [http://www.irealtysoft.com/](http://www.irealtysoft.com/) ver 3\. and ver 4 have two different storage methods). After several years of dealing with both ways I recommend to create a single table for all properties. This pattern is called Single Table Inheritance ([http://martinfowler.com/eaaCatalog/singleTableInheritance.html](http://martinfowler.com/eaaCatalog/singleTableInheritance.html) by Martin Fowler).

I see only two disadvantages of this method:

1.  field names should be unique within all property types
2.  a lot of records will have NULL in about a have of their columns which wastes disk space a little bit

A the same time with this database structure all CRUD routines are very simple and straightforward. You will save a lot of time building queries/ORM layer. With this structure you are free to create indexes and utilize arithmetic and other database functions in WHERE clauses and avoid costly JOINs.

The disk space is cheap, the development time is expensive.

The | property_id | feature_name | feature_value | allows to keep the same database structure when changing fields and property types, which is good when you have a complex upgrade/update routines. If you are going to build a single (production) instance application the upgrades should not be an issue. However this method make CRUD model complex and hence more expensive and bug-prone. (More code --- more bugs.)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T07:47:05.417

那么，这三个主要类别是一成不变的吗？未来是否有可能出现第四个？我可能会选择这样的东西：

```
CREATE TABLE property (
    id int not null auto_increment,
    name varchar(250) not null,
    property_type int not null,
    property_subtype int not null,
    primary key(id)
);
CREATE TABLE property_type (
    id int not null auto_increment,
    name varchar(250) not null,
    primary key(id)
);
CREATE TABLE property_subtype (
    id int not null auto_increment,
    type int not null,
    name varchar(250) not null,
    primary key(id)
);
CREATE TABLE property_feature (
    id int not null auto_increment,
    property int not null,
    feature int not null,
    value varchar(250) not null,
    primary key(id)
);   
CREATE TABLE property_feature (
    id int not null auto_increment,
    feature int not null,
    value varchar(250) not null,
    primary key(id)
); 
```

我认为从长远来看，这将是最有效的，如果时机成熟，也是最灵活的。

使用此结构，您可以像这样添加数据：

```
mysql> INSERT INTO property_type (name) VALUES ('House'),('Commercial'),('Terrains');
Query OK, 3 rows affected (0.00 sec)
Records: 3  Duplicates: 0  Warnings: 0

mysql> INSERT INTO property_subtype (type, name) VALUES (1, 'Apartment'),(1, 'House'), (1,'Loft');
Query OK, 3 rows affected (0.00 sec)
Records: 3  Duplicates: 0  Warnings: 0

mysql> INSERT INTO subtype_feature (subtype, name) VALUES (1, 'Light'),(1, 'Floor #');
Query OK, 2 rows affected (0.00 sec)
Records: 2  Duplicates: 0  Warnings: 0

mysql> INSERT INTO property (name, property_type, property_subtype) VALUES ('Som
e Apartment', 1, 1);
Query OK, 1 row affected (0.01 sec)

mysql> INSERT INTO property_feature (feature, value) VALUES (1, 'Yes'),(2, '5th');
Query OK, 2 rows affected (0.00 sec)
Records: 2  Duplicates: 0  Warnings: 0

mysql> INSERT INTO property_feature (property, feature, value) VALUES (1, 1, 'Yes'),(1, 2, '5th');
Query OK, 2 rows affected (0.00 sec)
Records: 2  Duplicates: 0  Warnings: 0 
```

然后，您可以很容易地获得特定属性的所有功能：

```
mysql> SELECT s.name, f.value FROM property_feature f INNER JOIN subtype_feature
 s ON f.feature = s.id WHERE f.property = 1;
+---------+-------+
| name    | value |
+---------+-------+
| Light   | Yes   |
| Floor # | 5th   |
+---------+-------+
2 rows in set (0.00 sec) 
```

# c# - C# 以螺旋运动在图像中移动？

> ID：933876
> 
> 赞同：5
> 
> 时间：2009-06-01T07:40:50.933
> 
> 标签：c#, .net, image-processing

我想通过图像的像素移动，而不是以“正常”方式逐行、逐列地移动。但从中心像素开始并以螺旋运动向外。但我不知道该怎么做。关于如何做到这一点的任何建议？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-01T07:46:20.860

您可以通过使用参数函数来做到这一点，半径函数是 r(t) = R，并且 x(t) = Rcos(t) 和 y(t)=Rsin(t)。你的意思是[这样](http://www60.wolframalpha.com/input/?i=plot+t*cos%28t%29%2C+t*sin%28t%29)的吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T07:50:38.653

反过来考虑这一点会很有帮助。

例如，从左上角开始按顺时针方向移动，您将沿着顶行移动，然后从右侧向下，沿着底部，从左边缘向上移动到起点下方的像素。

然后沿着第二排移动，并继续螺旋。

根据图像的尺寸，您最终会得到单列像素或单行像素，并且将向上/向下或向左/向右移动。

从这个终点开始，您可以按照您的步骤倒退并根据需要处理所有像素。

要从数学上计算出您的起始位置，您需要知道图像的宽度/高度以及您想要结束的像素以及到达最后一个像素时您想要行进的方向。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T07:54:41.530

这样的事情应该这样做：

```
int x = width / 2;
int y = height / 2;
int left = width * height;
int dir = 0;
int cnt = 1;
int len = 2;
int[] move = { 1, 0, -1, 0, 1 };
while (left > 0) {
   if (x >= 0 && x < width && y >= 0 && y < height) {
      // here you do something with the pixel at x,y
      left--;
   }
   x += move[dir % 4];
   y += move[(dir % 4) + 1];
   if (--cnt == 0) {
      cnt = len++ / 2;
      dir++;
   }
} 
```

如果图像不是正方形，则螺旋将在图像坐标之外继续，直到覆盖整个图像。语句中的条件`if`确保只处理属于图像一部分的坐标。

# .net - 将 PDB 调试文件留在实时服务器上是否存在任何安全问题？

> ID：933883
> 
> 赞同：26
> 
> 时间：2009-06-01T07:43:29.213
> 
> 标签：.net, asp.net, security, pdb-files

将 .NET PDB 文件保存在真实服务器上是否存在任何安全问题？

我知道抛出异常可能需要更长的时间，但是在正常执行期间谁会抛出异常呢？:-)

但是从安全的角度来看呢？有什么问题吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-06-01T07:54:19.160

如果您的系统使用 PDB 不安全，那么没有它们可能就不安全。显然，这取决于更好的错误报告对您的价值。就个人而言，我非常重视这一点，因此倾向于部署 PDB。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-07-11T10:30:30.590

我认为一个公平的论点是**不**将 PDB 留在实时服务器上是一种风险。在生产崩溃并且问题无法在 dev 或 UAT 上重现的情况下，诊断错误发生的位置要花费更多时间（并且可能是不可能的）。

至少，**与部署的 DLL 匹配的 PDB**应该位于生产服务器上某处的 ZIP 文件中。他们应该很容易被您以外的人找到，以防您不在身边提供帮助。

另请参阅PDB 文件： John Robbins 的[每个开发人员必须知道的内容。](https://www.wintellect.com/pdb-files-what-every-developer-must-know/)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-06-01T07:56:36.737

将 .PDB 文件发布到您的网站时可能遇到的唯一问题是发生异常时，您忘记在 web.config 中设置 CustomErrors 属性。堆栈跟踪将显示文件名和行号，这可能是一个安全问题。

我认为没有其他风险。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-01T08:09:43.233

如果服务器是 IIS，则没有。如果保存在正确的位置（网站\bin），这些文件将不会向公众公开。偶尔我会在 Web 服务器上找到中间（obj 目录）文件——这似乎是意外公开二进制文件的一种最喜欢的方式。在您的 pdb 可见的任何情况下，您的 dll 也可见，这更糟。

正如 activa 所指出的，堆栈跟踪对于有或没有行号的黑客来说非常有用。保持私密。

我假设您可能在真实服务器上运行的任何其他程序 - 服务等 - 根本无法公开访问。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-01T08:05:19.980

如果您向最终用户显示失败的异常（又名黄屏死机），那么它可能会给攻击者带来更好地了解您的系统的风险。

一种可能的解决方案 - 有一个**异常处理策略**：

1.  使用原始堆栈跟踪、附加信息和唯一异常 ID (Guid) 记录所有异常。
2.  将触发的异常替换为仅包含异常 ID（用于参考和反馈）和已清理消息（即：无连接字符串）的包装器，并丢弃堆栈跟踪信息。

.NET 中的开源异常处理块示例：

*   [从 Lokad](http://abdullin.com/journal/2008/12/1/net-exception-handling-action-policies-application-block.html)
*   [来自微软](http://msdn.microsoft.com/en-us/library/cc309505.aspx)

*   [理论](http://abdullin.com/journal/2008/11/29/what-is-an-action-policy.html)

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2009-06-01T07:50:10.650

基本上，PDB 就在源代码之下，而 ASP.NET/IIS 也不会阻止它们被下载。

现在肯定人们必须猜测程序集名称，这可能不太可能，但为什么要冒险呢？

* * *

## 回答 #7

> 赞同：-5
> 
> 时间：2009-06-01T15:39:58.247

嗯 - 我会在这方面倾向于安全谨慎。我认为你应该有 PDB，但不是在生产服务器上。此外，您应该在任何实时系统上关闭调试。调试是讨厌的，当你不需要它的时候你就是不想要它。

来自[斯科特·格思里](http://weblogs.asp.net/scottgu/archive/2006/04/11/442448.aspx)：

1.  ASP.NET 页面的编译需要更长的时间（因为禁用了一些批处理优化）
2.  代码执行速度可能会变慢（因为启用了一些额外的调试路径）
3.  在运行时在应用程序中使用更多的内存
4.  从 WebResources.axd 处理程序下载的脚本和图像不会被缓存

在您的 machine.config 中设置部署零售=true：

```
<configuration>
    <system.web>
          <deployment retail="true"/>
    </system.web>
</configuration> 
```

这将覆盖调试、错误和跟踪设置，这将防止计算机本身之外的任何错误泄露。

既然您已经关闭了调试，没有错误或跟踪，为什么要将 PDB 部署到生产服务器？将它们存储在其他地方，甚至可能是您的开发服务器。从开发到生产的代码升级脚本可以明确排除 PDB，但将它们存档，以便在需要进行生产调试时可用。

# asp.net-mvc - 请求教程以向 NerdDinner ASP.NET MVC 应用程序添加 Openid 支持

> ID：933884
> 
> 赞同：26
> 
> 时间：2009-06-01T07:43:48.853
> 
> 标签：asp.net-mvc, dotnetopenauth, nerddinner

我正在寻找使用 ASP.NET MVC NerdDinner 教程来了解 ASP.NET MVC 和 OpenId。

我想将 NerdDinner 中的身份验证系统替换为仅 OpenId。我已经下载了最新的 DotNetOpenAuth 库，但我不确定如何将它们放在一起。任何人都可以提供快速的分步教程吗？

这就像放入库中一样简单，还是应用程序也需要进行重大更改？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-06-02T14:02:01.230

下载[dotnetopenid 后](http://code.google.com/p/dotnetopenid/)，查看 samples\RelyingPartyMvc 目录。有一个示例，他们用 OpenID 替换了默认的 MVC 身份验证系统。相关代码在 Controllers/UserController.cs 中。这是身份验证操作：

```
//Stage 1: Show form asking for Open ID identifier URL
var openid = new OpenIdRelyingParty();
if (openid.Response == null) {
    // Stage 2: user submitting Identifier
    Identifier id;
    if (Identifier.TryParse(Request.Form["openid_identifier"], out id)) {
            openid.CreateRequest(Request.Form["openid_identifier"]).RedirectToProvider();
    } else {
            ViewData["Message"] = "Invalid identifier";
            return View("Login");
            }
} else {
    // Stage 3: OpenID Provider sending assertion response
    switch (openid.Response.Status) {
        case AuthenticationStatus.Authenticated:
            FormsAuthentication.RedirectFromLoginPage(openid.Response.ClaimedIdentifier, false);
            break;
        case AuthenticationStatus.Canceled:
            ViewData["Message"] = "Canceled at provider";
            return View("Login");
        case AuthenticationStatus.Failed:
            ViewData["Message"] = openid.Response.Exception.Message;
            return View("Login");
    }
}
return new EmptyResult(); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-01T09:52:32.400

不是 NerdDinner 规范，但对于想要在其 ASP.NET MVC 应用程序中实现 OpenId 支持的人可能很有用：

*   [将 OpenID 登录支持添加到您的 ASP.NET MVC 站点](http://blog.nerdbank.net/2008/04/add-openid-login-support-to-your-aspnet.html)
*   [增强 ASP.NET MVC OpenID 登录体验](http://blog.nerdbank.net/2008/04/enhancing-aspnet-mvc-openid-login.html)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-03T22:17:37.040

好的，所以我得到了这种工作！答案是以下答案的组合，再加上控制器和视图的一些处理。

首先[下载 DotNetOpenAuth](https://www.ohloh.net/p/dotnetopenauth/download)，然后导航到示例目录，您可以在其中找到 OpenIdRelayingPartyMvc 代码。在我的 NerdDinner 解决方案中，

*   我添加了对 DotNetOpenAuth 程序集的引用
*   添加新的“用户控制器”并从示例的用户控制器中复制代码
*   添加了正确的 using 语句并更改了命名空间以反映 NerdDinner.Controllers
*   从示例中重新创建了类似的“用户”视图，并适当地更改它们以反映站点主内容 ID。
*   在 home 控制器下添加了一个 xrds 视图。（不确定这是做什么的）
*   更改索引并在 HomeController 中添加 Xrds ActionResult 方法以反映示例。
*   更改了 web.config 文件（在根文件夹中） Authenticate 部分以将登录路径更改为新的 UserController 和 Login 方法
*   将“LogOnUserControl”ActionLinks 更改为指向新的 UserControl 以及“Login”和“Logout”方法。
*   乱用各种直接调用登录功能的视图

现在，这以有限的方式起作用。我可以使用 OpenID 登录 NerdDinner 应用程序并与之交互。所以这很酷。然而，一些功能还没有工作。保存创建的晚餐不起作用，但它也不会挂起。我将不得不研究如何将 AccountController 中的一些成员资格功能迁移到 UserController。我会更新这篇文章（欢迎提出建议和指点）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-01T17:47:18.443

查看 Samples/OpenIdRelyingPartyMvc 目录（一个使用 OpenId 身份验证的简单 ASP.NET MVC 网站）。您可以从将 Web.config 中的 Home/User Controllers/Views 和设置复制到您的项目中开始。我认为这是为您的网站提供 OpenId 身份验证的最快方法。然后，[正如 Alexander Prokofyev 所说，在](https://stackoverflow.com/questions/933884/request-for-tutorial-to-add-openid-support-to-nerddinner-asp-net-mvc-application/934190#934190)[Andrew Arnott 的（DotNetOpenAuth/DotNetOpenId 作者）博客上](http://blog.nerdbank.net/)有非常有用的帖子-[将 OpenID 登录支持添加到您的 ASP.NET MVC 站点](http://blog.nerdbank.net/2008/04/add-openid-login-support-to-your-aspnet.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-01T08:31:53.500

codeplex 上有一个会员入门工具包，应该是您正在寻找的。如果他们遵循微软身份验证约定，他们都应该遵循提供者模型（阅读它）。

[http://mvcmembership.codeplex.com/](http://mvcmembership.codeplex.com/)

# c++ - 没有仿函数的 std::sort

> ID：933886
> 
> 赞同：0
> 
> 时间：2009-06-01T07:45:46.930
> 
> 标签：c++, stl, sorting, functor

我对 std::sort 算法有疑问。这是我的测试代码：

```
struct MyTest
{
    int m_first;
    int m_second;

    MyTest(int first = 0, int second = 0) : m_first(first), m_second(second)
    {
    }
};

int main(int argc,char *argv[])
{
    std::vector<MyTest> myVec;
    for(int i = 0; i < 10; ++i)
    {
        myVec.push_back(MyTest(i, i + 1));
    }

    //Sort the vector in descending order on m_first without using stand alone function or functors

    return 0;

} 
```

`m_first`是否可以在不使用任何独立函数或仿函数的情况下对变量上的向量进行排序？另外，请注意我没有使用 boost。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-01T07:52:25.357

是的，只要要排序的范围内的值类型有一个`operator <`定义了“严格弱排序”的值，也就是说，它可以用来`MyTest`正确比较两个实例。您可能会执行以下操作：

```
class MyTest
{
  ...
  bool operator <(const MyTest &rhs) const
  {
    return m_first<rhs.m_first;
  }
}; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-01T07:51:01.490

为你的结构写一个 operator<。这是 sort 使用的默认函数，也是允许它在您的自定义数据结构上运行的最简单方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-01T07:51:49.087

定义运算符<

```
struct MyTest
{
...
    bool operator<(const MyTest& a_test) const {
        return m_first < a_test.m_first;
    }
}; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-01T08:57:31.437

可以使用成员函数来做到这一点，但独立函数是要走的路。

```
bool operator <(const MyTest &lhs, const MyTest &rhs)
{
    return lhs.m_first<rhs.m_first;
} 
```

为什么 ..

> Scott Meyers：**非成员函数如何改进封装**
> 
> 如果您正在编写一个可以实现为成员或非朋友非成员的函数，您应该更喜欢将其实现为非成员函数。该决定增加了类封装。当您考虑封装时，您应该考虑非成员函数。
> 
> [惊讶吗？继续阅读](http://www.ddj.com/cpp/184401197)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-01T07:56:02.590

您应该定义一个`operator<`in `MyTest`，它应该如下所示：

```
bool operator<(const MyTest &other) const {
  return m_first < other.m_first;
}; 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2011-08-28T10:40:23.083

[http://ideone.com/3QLtP](http://ideone.com/3QLtP)

这没有定义运算符 <，但确实定义了函子。

但是，穿越时间或编译过程很有趣。

# vb.net - 哪一个是“更好”的代码片段？

> ID：933892
> 
> 赞同：0
> 
> 时间：2009-06-01T07:48:43.477
> 
> 标签：vb.net, code-snippets

哪个代码片段更好？如何？[基于可读性、调试、代码标准等的“更好”...]

```
Dim Name As String = Employee.Name 
```

或者

```
Dim Name As String 
Name = Employee.Name 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T07:55:31.123

结合声明和赋值通常被认为是最好的方法（你的第一个例子）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T07:54:35.430

好吧，因为它们都是等价的并且都非常简单，我希望编译器将它们简化为相同的东西，所以两者都不是真的更好。

就我个人而言，我觉得第二种方法有它的优势，因为您可以在一行代码中创建一个类型的多个变量，然后一个接一个地初始化它们，这对于可读的代码是我的偏好。但是，如果您只有一个变量要初始化，那么第一个变量也很简洁。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T07:58:00.323

只要声明和赋值之间没有 null/empty 或内容检查，我更喜欢选项 1。更易于阅读且更少混乱。

# asp.net-mvc - ASP.NET MVC：特定于页面的逻辑

> ID：933894
> 
> 赞同：3
> 
> 时间：2009-06-01T07:49:14.803
> 
> 标签：asp.net-mvc, architecture, code-behind

关于[ASP.NET MVC 和**Codebehind-files 的**](http://haacked.com/archive/2009/05/05/page-view-lockdown.aspx)讨论很多，其中大部分都指出这些[Codebehind-files 是邪恶的](http://stevesmithblog.com/blog/codebehind-files-in-asp-net-mvc-are-evil/)。

所以我的问题是，**您如何处理特定于页面的逻辑**？

我们**不想要的是内联代码中的意大利面条式代码，**并且我们**不希望页面特定的代码分散在辅助类**中或 HTML 辅助类之上。

一个例子是：

```
<% for(int i = 0; i < companyList.Count; i++) { %>
    RenderCompanyNameWithRightCapsIfNotEmpty(company, i)
<% } %> 
```

附带代码隐藏：

```
private string RenderCompanyNameWithRightCapsIfNotEmpty(string company, index)
{
    if (index == 0) {
        return string.Format("<div class=\"first\">{0}</div>", company);
    }
    // Add more conditional code here
    // - page specific HTML, like render a certain icon
    string divClass = (index % 2 == 0) ? "normal" : "alternate";
    return string.Format("<div class=\"{1}\">{0}</div>", company, divClass);
} 
```

这只会在一页上使用，并且很可能会发生变化。

**更新**：我想到了几种方法：

1）页面上的内联代码隐藏 - 使用返回字符串的简单方法。

```
<script runat="server">
    private string RenderCompanyHtml(string companyName) ...
<script> 
```

2）在控制器中放置一个返回字符串的方法。但这**会将 View-logic 放入 Controller**中。

```
public class SomeController : Controller 
{
    [NonAction] 
    private static string RenderCompanyHtml(string companyName) ...

    public ActionResult Index() ...
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T08:09:31.923

You should put that code in the controlleraction where you prepare the viewdata.

I usually make a region "helper methods" in my controller class with a few [NonAction] methods to keep things clean.

So my (simplified) controller would look like this:

```
public class SomeController : Controller 
{
  #region Helper methods
  [NonAction] 
  private static string CompanyNameWithRightCapsIfNotEmpty(string company)
  {
    if (string.IsNullOrEmpty(company)) {
        return company;
    }
    return UpperCaseSpecificWords(company);
  }

  #endregion

  public ActionResult Companies()
  {
    var companies = GetCompanies();
    var companyNames = companies.Select(c =>  CompanyNameWithRightCapsIfNotEmpty(c.Name));
    ViewData["companyNames"] = companyNames;
    return view();
  }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T08:18:59.720

Helper methods are one good way of handling page specific code, but I think it is a;ways preferable to get your model to show the data you need.

If you're going to go for the helper option, you would be better served by making the operation it perfroms a bit less page specific. If your method RenderCompanyNameWithRightCapsIfNotEmpty has to be so specific it would be better if your model provided it. One way would be to have the model provide a list with the text already formatted, and expose it as a public property (say an IEnumerable of formatted company names).

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T08:15:04.313

Use Html Helpers.

Like so create the helper methods in a `static` class:

```
 public static string Label(this HtmlHelper helper, string target, string text)
    {
        return String.Format("<label for='{0}'>{1}</label>", target, text);
    } 
```

.. then use in your view:

```
<span><% =Html.Label("FinishDateTime.LocalDatetime", "Finish Time:")%><br /> 
```

You could create a helper method called maybe `RenderCompanyName(string[] companies)` that checked for nulls, did the caps manipulation and rendered the html in between - all in the same helper if you like.

Also: controller action methods should be light - ie. only getting the data and returning views. You should delegate things like manipulation of data for presentation to views and Html helpers.

**EDIT:** Here is a helper that you might be after:

This helper renders an `IList<>` to html in the form of an unordered list `<ul>...</ul>`. The useful thing about it is that it gives you control over how the list is rendered thru css **AND** it allows you to render additional html/content for each item. Take a look - this is the helper:

```
 public static string UnorderedList<TItem>(this HtmlHelper helper,
        IList<TItem> items, Func<TItem, string> renderItemHtml,
        string ulID, string ulClass, string liClass)
    {
        StringBuilder sb = new StringBuilder();

        // header
        if (!ulID.IsNullOrTrimEmpty()) sb.AppendFormat("<ul id='{0}'", helper.Encode(ulID.Trim()));
        else sb.AppendFormat("<ul");
        if (!ulClass.IsNullOrTrimEmpty()) sb.AppendFormat(" class='{0}'>", helper.Encode(ulClass.Trim()));
        else sb.AppendFormat(">");

        // items
        foreach (TItem i in items)
        {
            if (!liClass.IsNullOrTrimEmpty())
                sb.AppendFormat("<li class='{0}'>{1}</li>", helper.Encode(liClass.Trim()),
                    renderItemHtml(i));
            else
                sb.AppendFormat("<li>{0}</li>", renderItemHtml(i));
        }

        // footer
        sb.AppendFormat("</ul>");

        return sb.ToString();
    } 
```

..using it is easy. here is a simple example to render a list of tags:

```
 <div id="tags">
        <h2>Tags</h2>
        <%=Html.UnorderedList<Tag>(Model.Tags.Tags,tag=>
            {
                return tag.Name;
            },null,null,null) %>
    </div> 
```

..you can see in my usage example that i have chosen not to specify any css or id attribute and i simply return the name of the `Tag` item thru the use of the anonymous delegate. Anonymous delegates are way easy to use.. in your case maybe something like this would work:

```
 <div id="tags">
        <h2>Tags</h2>
        <%=Html.UnorderedList<string>(ViewData["companies"],company=>
            {
                if (someCondition) return company.ToUpper();
                else return company;
            },null,null,null) %>
    </div> 
```

.. `ViewData["companies"]` is an `IList<string>` for simplicity.

# c# - 使用引用游标作为 ODP.NET 的输入类型

> ID：933903
> 
> 赞同：2
> 
> 时间：2009-06-01T07:53:01.003
> 
> 标签：c#, oracle, odp.net, ref-cursor

我正在尝试使用 a`RefCursor`作为 Oracle 存储过程的输入参数。这个想法是选择一组记录，将它们输入存储过程，然后 SP 循环输入`RefCursor`，对其记录进行一些操作。不，我不能选择 SP 内的记录，因此避免了使用`RefCursor`作为输入类型。

我在 Oracle 的文档中找到了一个关于如何执行此操作的示例（这将是链接，但似乎我还不能使用它们），但它使用一个简单`SELECT`的方法来填充输入`RefCursor`；这就是问题所在：我必须从代​​码中填充它。

你看，在代码中我有这个：

```
[OracleDataParameter("P_INPUT", OracleDbType.RefCursor, ParameterDirection.Input)]
private List<MiObject> cursor; 
```

而且，我尝试用 a ， a ，甚至是一个普通的数组来填充*光标*，但没有任何效果。当我尝试运行测试时，出现错误：`List<T>``DataTable``MyObject`

> “无效的参数链接”

也许不是确切的措辞，因为我是从西班牙语翻译的，但这就是信息

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T13:05:06.180

我还与我试图在我的帖子上链接的文章的作者 Mark Williams 保持联系，他的回复是这样的：

" 给我发电子邮件是没有问题的；但是，我想我对这个问题的回答会让你失望。

不幸的是，你不能做你想做的事情（像这样从客户端创建一个 refcursor）。

几个问题是，refcursor 是指 Oracle 在服务器上拥有的内存，而 Oracle 没有客户端项目的概念，如 DataTable 或 .NET List 等。

除了使用 refcursor 之外，您还有其他可用的选项吗？"

所以基本上我搞砸了，这个问题已经结束了。感谢大家阅读和/或尝试提供帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T07:57:57.420

从记忆中，ODP.NET 库中的某个地方没有一个`OracleCursor`类可以工作吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-08T21:32:20.640

查看[此示例](http://www.oracle.com/technology/oramag/oracle/06-jan/o16odpnet.html)，将 refcursor 作为 oracle technet 的 pl/sql 输入。

clou 是输入的 refcursor 对象必须由 oracle 自己创建。您不能将列表或其他任何内容转换为 refcursor。

# asp.net - 当我运行我的 asp.net 网站并尝试创建文件时，出现错误“访问被拒绝”

> ID：933905
> 
> 赞同：0
> 
> 时间：2009-06-01T07:54:22.187
> 
> 标签：asp.net

我的网站不创建文件，我将 asp.net 设置为写入目录。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T07:57:41.587

The account under which the website runs needs to have permissions to write files to the directory in which you want to write the files.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T07:58:06.703

it could be two things. this access denied error, is it a 403: Access Denied error? If so your IIS setup isn't configured for anonymous users. If its not it could be the IIS user the site is running as doesn't have permissions to access the site's folder.

Double check these two things, if it's neither we can look at what else is happening. Things I try is can I server a static file, or is it just ASP.NET etc

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T07:59:18.980

Write access isn't enough to create files. Try giving full control to the ASP.Net user (Network Service ny default) to the temporary files folder you are trying to write to.

# vb.net - 使用包含的 Linq to SQL 性能

> ID：933933
> 
> 赞同：1
> 
> 时间：2009-06-01T08:07:20.927
> 
> 标签：vb.net, linq, performance

我正在重载一个查询 SQL 数据库的 vb.net 搜索过程。我用作比较的旧方法之一使用存储过程来执行搜索并返回查询。我的新方法使用 linq。

我有点担心使用包含 linq 查询时的性能。我正在使用这两种方法查看同等可比的查询。
基本上有 1 个 where 子句，这里有一些分析器结果；

```
Where name = "ber10rrt1" 
```

*   Linq 查询：24reads
*   存储查询：111reads

    其中名称 = "%ber10%"

*   Linq 查询：53174reads

*   存储过程查询：23386reads

暂时忘记索引（不是我的数据库）......事实上，这两种方法基本上都在执行相同的查询（尽管存储过程确实引用了[某些]表的视图）。

这与其他人对 linq to sql 的体验一致吗？

此外，有趣的是；

*   使用像“BER10%”

*   结果集.Where(函数(c) c.ci.Name.StartsWith(name))

使用 13125reads 生成存储过程，使用 8172reads 生成 linq

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T08:45:07.747

我不确定那里是否有足够的时间进行完整的分析...我假设我们在这里谈论`string.Contains`/ `string.StartsWith`（不是`List<T>.Contains`）。

If the generated TSQL is similar, then the results should be comparable. There are a few caveats to this - for example, is the query column a calculated+persisted value? If so, the `SET` options must be exact matches for it to be usable "as is" (otherwise it has to re-calculate per row).

So: what is the TSQL from the SP and LINQ? Are they directly comparable? You mention a `VIEW` - I'm guessing this could make a big difference if (for example) it filters out data (either via a `WHERE` or an `INNER JOIN`).

Also - `LIKE` clauses starting `%` are rarely a good idea - not least, it can't make effective use of any index. You might have better performance using "full text search"; but this isn't directly available via LINQ, so you'll have to wrap it in an SP and expose the SP via the LINQ data-context (just drag the SP into the designer).

My money is **on the `VIEW`** (and the other code in the SP) being the main difference here.

# c# - Add reference in code with C#?

> ID：933934
> 
> 赞同：1
> 
> 时间：2009-06-01T08:07:24.720
> 
> 标签：c#

I am looking for the equivalent of C++'s #pragma comment(lib, "name"); but for C# and adding assembly references. How can i do it?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T08:40:37.617

请参见：

[从 C# 调用 C++ 库](http://geeklit.blogspot.com/2006/08/calling-c-lib-from-c.html)

[从 C# 调用非托管 DLL](http://msdn.microsoft.com/en-au/magazine/cc301501.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T08:37:31.587

不要以为可以通过代码动态添加引用。

但是，您可以通过代码中的反射（Assembly.LoadXXX 方法）加载所需的程序集，然后访问其中定义的类型。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T08:47:43.560

如果我理解正确，您可以通过 [DLLImport] 使用[PInvoke](http://msdn.microsoft.com/en-us/magazine/cc164123.aspx)，如下例所示：

```
[DllImport("User32.dll", SetLastError=true)]
static extern Boolean MessageBeep(UInt32 beepType); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T08:45:05.377

您不能这样做，因为 C# 编译器*需要*事先引用才能生成 IL，而 C++ 编译器具有描述所引用库的布局的头文件（至少从解析器/验证的角度来看 - 它需要生成阶段的LIB实际上能够写入偏移量）

# jquery - jQuery Ajax加载函数+返回HTML以外的值

> ID：933939
> 
> 赞同：1
> 
> 时间：2009-06-01T08:09:49.753
> 
> 标签：jquery, ajax, load

我正在使用以下 jQuery 代码在 ASPX 页面中填充我的 DIV

```
 var div = $("#divPrice");  
   div.fadeOut('slow',function(){      
   div.load("../Lib/handlers/GetPrice.aspx?answers="+queryValues+"&item="+modelId,{ symbol: $("#txtSymbol" ).val() },function()
   {
      $(this).fadeIn('slow');                                           
   });

   });   
  $("#divBtns").fadeIn('slow'); 
```

这工作正常。在 Get`price.aspx`中，它将返回一个 HTML，并将其加载到 div 中。现在我想将另一个数字连同这个 HTML 返回到我的 javascript。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T08:20:33.383

请阅读[这些](http://encosia.com/category/jquery/)帖子以深入了解使用 jquery 玩 asp.net。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-11-19T23:06:09.220

使用隐藏的控制输入来做到这一点：

网

```
<input type="hidden" id="yr_control" value="<%=Request.QueryString.Get("val_control") %>" /> 
```

后面的代码：

```
Request.QueryString.Get("val_control") 
```

在阿贾克斯

```
$("#yr_control").attr("value") 
```

# mysql - 多个数据库具有不同的 ibdata 文件

> ID：933940
> 
> 赞同：3
> 
> 时间：2009-06-01T08:10:00.050
> 
> 标签：mysql

我的 MySQL 服务器运行 4 个数据库，并将 innodb_data_file_path 设置为默认配置 [ibdata1]。我看到磁盘上这个文件的大小增长到 1GB。此文件只会随着运行此服务器的应用程序收集监控数据而增长。

只是不确定在如此大的文件大小下这将如何产生性能问题。

有没有办法按数据库拆分这个文件？这样每个数据库都可以有自己的ibdata文件。我知道 InnoDB 有一个选项，可以在每个表中拆分此数据文件（仍然维护共享表空间），但找不到任何选项来按数据库拆分此文件。

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-11-11T21:41:44.217

将此选项添加到 my.cnf ：*innodb_file_per_table*

参考： [http ://dev.mysql.com/doc/refman/5.0/en/innodb-multiple-tablespaces.html](http://dev.mysql.com/doc/refman/5.0/en/innodb-multiple-tablespaces.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T13:49:33.780

每个数据库应该已经有一个单独的表空间文件。您应该在 mysql 数据目录中的不同数据库的每个子目录中看到一个 ibdata 文件。

# python - 用于在 CLI 中编辑文本的 Python 模块

> ID：933941
> 
> 赞同：4
> 
> 时间：2009-06-01T08:10:22.123
> 
> 标签：python, text-editor, command-line-interface

是否有一些 python 模块或命令可以让我的 python 程序进入 CLI 文本编辑器，用一些文本填充编辑器，当它退出时，将文本取出到某个变量中？

目前我让用户使用 raw_input() 输入内容，但我想要比这更强大的东西，并将其显示在 CLI 上。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-01T08:24:56.133

好吧，您可以使用子进程启动用户的 $EDITOR，编辑一个临时文件：

```
import tempfile
import subprocess
import os

t = tempfile.NamedTemporaryFile(delete=False)
try:
    editor = os.environ['EDITOR']
except KeyError:
    editor = 'nano'
subprocess.call([editor, t.name]) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T08:22:51.833

你可以看看[urwid](http://excess.org/urwid/)，一个基于curses的、成熟的python UI 工具包。它允许您定义非常复杂的界面，它包括用于不同类型文本的不同编辑框类型。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-04-11T15:52:21.987

这是我为另一个项目编写的函数。它允许用户编辑一行文本，并支持换行和光标 | 您可以使用箭头键来回移动。它依赖于[readchar](https://pypi.org/project/readchar/)模块：`pip3 install readchar`读取键码，因此它应该在 Windows 中工作，但我只在 linux 终端上测试过它并作为 initramfs 的一部分。

GitHub：[https ://github.com/SurpriseDog/KeyLocker/blob/main/text_editor.py](https://github.com/SurpriseDog/KeyLocker/blob/main/text_editor.py)

（更可能是最新的）

```
#!/usr/bin/python3

import sys
import shutil
from readchar import readkey

def text_editor(init='', prompt=''):
    '''
    Allow user to edit a line of text complete with support for line wraps
    and a cursor | you can move back and forth with the arrow keys.
    init    = initial text supplied to edit
    prompt  = Decoration presented before the text (not editable and not returned)
    '''

    term_width = shutil.get_terminal_size()[0]
    ptr = len(init)
    text = list(init)
    prompt = list(prompt)

    c = 0
    while True:
        if ptr and ptr > len(text):
            ptr = len(text)

        copy = prompt + text.copy()
        if ptr < len(text):
            copy.insert(ptr + len(prompt), '|')

        # Line wraps support:
        if len(copy) > term_width:
            cut = len(copy) + 3 - term_width
            if ptr > len(copy) / 2:
                copy = ['<'] * 3 + copy[cut:]
            else:
                copy = copy[:-cut] + ['>'] * 3

        # Display current line
        print('\r' * term_width + ''.join(copy), end=' ' * (term_width - len(copy)))

        # Read new character into c
        if c in (53, 54):
            # Page up/down bug
            c = readkey()
            if c == '~':
                continue
        else:
            c = readkey()

        if len(c) > 1:
            # Control Character
            c = ord(c[-1])
            if c == 68:     # Left
                ptr -= 1
            elif c == 67:   # Right
                ptr += 1
            elif c == 53:   # PgDn
                ptr -= term_width // 2
            elif c == 54:   # PgUp
                ptr += term_width // 2
            elif c == 70:   # End
                ptr = len(text)
            elif c == 72:   # Home
                ptr = 0
            else:
                print("\nUnknown control character:", c)
                print("Press ctrl-c to quit.")
                continue
            if ptr < 0:
                ptr = 0
            if ptr > len(text):
                ptr = len(text)

        else:
            num = ord(c)
            if num in (13, 10):  # Enter
                print()
                return ''.join(text)
            elif num == 127:     # Backspace
                if text:
                    text.pop(ptr - 1)
                    ptr -= 1
            elif num == 3:       # Ctrl-C
                sys.exit(1)
            else:
                # Insert normal character into text.
                text.insert(ptr, c)
                ptr += 1

if __name__ == "__main__":
    print("Result =", text_editor('Edit this text', prompt="Prompt: ")) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T08:18:28.520

如果您不需要 Windows 支持，您可以使用[readline 模块](http://docs.python.org/library/readline.html)来进行基本的命令行编辑，就像在 shell 提示符下一样。

# map - 累积最大值，计算每个父记录

> ID：933942
> 
> 赞同：0
> 
> 时间：2009-06-01T08:11:00.110
> 
> 标签：map, biztalk, max

有没有人使用过累积最大值 functoid 并注意到性能问题？

**摘要**
如果想要映射字段的最大值，可以使用 functoid 累积最大值。

**问题**
在我们使用它一段时间后，我们注意到较大文件的性能下降。

检查 xslt 注意到每个循环记录都进行了最大计算......

可以将计算移至祖父，并在自定义 XSL 路径中指出新的 xslt，但我真的很喜欢在映射工具中保留映射的可能性。

有什么建议么？

马丁带来的亲切问候

[http://martinbring.blogspot.com](http://martinbring.blogspot.com)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T07:18:51.497

通过去除累积最大值并添加3个脚本functoid，以另一种方式进行计算，问题得到解决。**映射时间减少了 40 倍。**

11 Mb，10 000 行，以前在 200 分钟内映射，现在在 5 分钟内映射。

**解决方案一种脚本 functoid，“内联 XSLT 调用模板”，没有输入或输出，包含**[此处找到的 EXSLT 数学库](http://www.exslt.org/math/functions/max/index.html)
中的库的 max() 部分。我没有使用整个库，而是解压缩了文件并“提取”了 max() 模板。

```
 <xsl:template name="GetMax">
   <xsl:param name="nodes" /> 

    <xsl:choose>
      <xsl:when test="not($nodes)">NaN</xsl:when> 
      <xsl:otherwise>
        <xsl:for-each select="$nodes">
          <xsl:sort data-type="number" order="descending" /> 
          <xsl:if test="position() = 1">
          <xsl:value-of select="number(.)" /> 
        </xsl:if>
       </xsl:for-each>
     </xsl:otherwise>
   </xsl:choose>
 </xsl:template> 
```

一个脚本 functoid，“内联 XSLT 调用模板”，没有输入或输出，包含一个变量，该变量在模板处选择属性点，并设置要计算的节点

```
<xsl:variable name="var:MaxValueDate">
    <xsl:call-template name ="GetMax">
            <xsl:with-param name ="nodes" select="Root//Parent/ValueToCalculate" />
    </xsl:call-template>
</xsl:variable> 
```

一个脚本functoid，“内联XSLT”，一个输出，使用变量来填充输出元素的值。

```
<OutputElement>
        <xsl:value-of select="$var:MaxValueDate" />
</OutputElement> 
```

瞧！

# vb.net - VB.Net code optimization?

> ID：933947
> 
> 赞同：3
> 
> 时间：2009-06-01T08:15:34.093
> 
> 标签：vb.net

I would like to ask humbly to those vb.net experts out there regarding optimization of the code. My example here is

a.

```
Dim lblEventCategory = CType(Me.gvSpecialEvent.Rows(e.NewEditIndex).FindControl("lblEventCategory"), Label) 
```

b.

```
 Dim lblEventCategory As Label = CType(Me.gvSpecialEvent.Rows(e.NewEditIndex).FindControl("lblEventCategory"), Label) 
```

Which of the two is more efficient is it letter A? or letter B?

Can somebody help me understand these codes?

Thanks in advance

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-01T09:29:28.533

如果我们谈论的是 .Net 3.5，那么 1800 INFORMATION 所说的不是真的，因为会发生类型推断，编译器会推断类型，因此是类型安全的。所以在 .Net 3.5 中 a 和 B 是相同的。

在 Visual Studio 2008 中，只需打开或关闭 Option Infer 即可查看差异。

在 .Net 3.5 之前，不会发生类型推断，它将使用变体类型或更确切地说是对象类型。所以在 pre.Net 3.5 中 A 和 B 是不一样的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T09:36:43.853

在 .NET 3.5 中 Dim x = value 与 C# var x = value 相同；编译器将推断类型，因此两者在运行时相等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T08:20:22.697

The first one defines the variable `lblEventCategory` as a Variant type. This is generally worse than the second where you use an explicit type. The Variant type is a kind of "catch all" that can safely hold any type of variable, but you lose any and all type safety and warnings that the compiler might have been able to give you. Also a Variant type uses more memory and will be slower at run time because of the conversions that need to be performed on it.

Additionally, method calls will be "late bound" - this means that the calls to those methods will not be resolved until runtime, when the type of the variable is known, the call is then made by name. This is typically astronomically slower than if you use the explicit type where the call can be made "early bound" (i.e., at compile time).

On the other hand, Variant types do have their place. They are useful in OLE automation (COM) programming, if you are interacting with a language like VBScript that only supports variant types. In that situation, you may be wise to wrap the calls into the late-bound code so that the Variant type is converted to and from the correct type at the boundary of the call.

# javascript - javascript commands not all firing

> ID：933948
> 
> 赞同：0
> 
> 时间：2009-06-01T08:15:35.733
> 
> 标签：javascript

I have a very simple JavaScript function:

```
function insertPost()
{
    document.postsong.submit()

    parent.document.getElementById('postSongButton').disabled = true;

} 
```

Both commands in it work but only the first one will fire. This is true when they switch places also. Only the first one will fire...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T09:19:49.567

**编辑：**经过进一步检查，我发现问题的真正根源在于：

```
document.postsong.submit() 
```

这是我在不同浏览器中的测试结果。如果 submit() 之前的行是“button.disable = true”，并且按钮 type="submit"：

*   Firefox 禁用该按钮并提交表单。
*   Chrome 会禁用该按钮，但不会提交。
*   IE 不会禁用该按钮，但会提交表单。

这解释了您一直在经历的行为。在 getElementById 之前拥有 parent 不会伤害任何东西，但这不是必需的。将 insertPost() 函数中的代码更改为：

```
function insertPost(){
 document.getElementById("postSongButton").disabled = true;
 document.forms["postSong"].submit();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T08:30:17.527

```
document.postsong.submit() 
```

提交表单，将焦点从函数上移开，函数到此结束

```
parent.document.getElementById('postSongButton').disabled = true; 
```

禁用按钮，所以也许是没有什么可以提交表单。

不太确定禁用表单按钮是否会阻止事件冒泡，但我怀疑这两行的性质会导致您将它们分开，并将第二行放在另一个事件处理程序中。

希望这能为您指明正确的方向。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T08:21:42.507

Did you check the casing of the html element?

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-01T08:41:40.610

单击按钮时，您将调用函数 insertPost()。因此，您必须首先禁用按钮，然后提交表单。我认为我不明白为什么要使用对象的父级。

函数 insertPost() {

```
parent.document.getElementById('postSongButton').disabled = true;
document.postsong.submit(); 
```

}

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-01T09:31:14.737

您正在使用 parent.document.getElementById(...

只需检查您是否正确引用了按钮。即，如果您使用的父参考是正确的。即，如果按钮与表单或父级在同一页面中。

是的，首先您必须禁用该按钮，然后触发表单的提交操作。当您以另一种方式执行此操作时，您最终可能会导航到另一个页面，并且禁用行可能永远不会执行。

但是，既然你说，禁用对你根本不起作用，我想如果你使用了错误的参考。当您尝试禁用它时，它是否为您提供了任何 javascript 错误？

# apache - Apache 错误地将 jsp 页面转换为“文本/纯文本”

> ID：933959
> 
> 赞同：1
> 
> 时间：2009-06-01T08:20:53.443
> 
> 标签：apache, tomcat, ajp

我有一个相当正常的设置，其中 Apache 代理请求通过 AJP 协议在 Tomcat 内运行的 servlet。

我们已经在 Apache 2.0.46/Tomcat 5.0.28 上运行此设置多年没有问题，但最近更新到 Apache 2.2.3/Tomcat 5.5。

问题是我们已经注意到间歇性地（可能是 3 次）Apache 会以某种方式将 servlet 提供的页面的“Content-Type”HTTP 标头从“text/html”转换为“text/plain”，这导致浏览器显示 HTML 源代码而不是渲染它。

有没有人见过这种行为并知道可能是什么原因？我怀疑我们在 servlet 代码中做了一些坏事，旧版本的 Tomcat/Apache 更宽容。

**更新**：我已经确认是 Apache 更改了标题。如果我直接浏览到 Tomcat，则不会出现问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-12-01T00:32:57.330

一些 web 应用程序没有正确设置它们所服务的 MIME 类型，但在独立服务时仍然可以正常工作，因为像浏览器这样的客户端应用程序能够解释内容的类型。但是当在 Apache 后面提供服务时，这些应用程序将无法正常运行，因为 Apache 将提供默认类型的 text/plain。

一个解决方案是为这些 Web 应用程序添加 DefaultType None 行到您的 apache 虚拟主机：

```
DefaultType None 
```

[http://httpd.apache.org/docs/2.2/mod/core.html#defaulttype](http://httpd.apache.org/docs/2.2/mod/core.html#defaulttype)

从我的博客文章： http: [//patternbuffer.wordpress.com/2011/11/30/mime-type-issue-with-apache-mod_jk-and-mod_proxy-serving-plain-text/](http://patternbuffer.wordpress.com/2011/11/30/mime-type-issue-with-apache-mod_jk-and-mod_proxy-serving-plain-text/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T17:01:44.153

如果您间歇性地看到此问题，则几乎可以肯定是 servlet 代码中存在问题，而不是 Tomcat 或 httpd 配置错误。您是否有可以打开以打印 HTTP 标头内容的日志记录？

为了进一步隔离问题，您还可以尝试绕过 httpd 并直接访问页面的 Tomcat URL。

我之前没有见过这种特殊的行为，所以很抱歉我不能更具体。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T17:04:48.220

间歇性是指某些页面表现出这种行为而其他页面没有表现出这种行为，或者有些页面有时会表现出这种行为而有时不会表现出这种行为？

您是否可以将任何日志记录附加到 AJP 层以记录该级别的 HTTP 标头，以便您可以验证是 Apache 还是 Tomcat 添加了虚假标头？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T23:33:59.307

您是否要代理回集群？也许其中一台服务器配置错误。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T02:40:58.557

行。我想通了，这是servlet代码中的一个错误：

作为 HTTP 请求的结果，我们正在做这样的事情来编写序列化的 Java 对象：

```
DeflaterOutputStream dos = new DeflaterOutputStream(response.getOutputStream());
ObjectOutputStream oos = new ObjectOutputStream(dos);
response.setContentType("application/x-java-serialized-object");
oos.writeObject(someObject); 
```

似乎正在发生的事情是，`DeflaterOutputStream`当`ObjectOutputStream`它们仍然附加到响应对象的输出流时，它们会在三到四个请求之后被垃圾收集，这会导致流上发生一些事情，使 Apache 感到困惑并导致它重写标头.

我将上面的内容替换为：

```
ByteArrayOutputStream byteStream = new ByteArrayOutputStream();
DeflaterOutputStream dos = new DeflaterOutputStream(byteStream);
oos = new ObjectOutputStream(dos);
response.setContentType("application/x-java-serialized-object");
oos.writeObject(someObject);
oos.flush();
dos.finish();
byteStream.writeTo(response.getOutputStream()); 
```

问题就消失了。

以下链接似乎描述了类似的问题：

*   [AJP 刷新数据包导致 text/plain](http://markmail.org/message/btwcnbl2i7ftwj4n#query:apache%20ajp%20changes%20Content-Type+page:1+mid:btwcnbl2i7ftwj4n+state:results)
*   [ASF Bugzilla – 错误 43478](https://issues.apache.org/bugzilla/show_bug.cgi?id=43478)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-10T10:55:18.320

I was also facing the same issue it got resolved. If problem in only one folder then there is some servlet that is blocking the request/response and making a customize request/response to tomcat. Tomcat 7.0.x

# javascript - Client-side pagination with jqGrid

> ID：933968
> 
> 赞同：6
> 
> 时间：2009-06-01T08:27:29.467
> 
> 标签：javascript, jquery, jquery-plugins, pagination

I know it's possible to do client-side sorting in jqGrid by setting loadonce = true but is it possible to do client-side paging as well?

I want to pass all the data (about 80 pages of JSON) to the client initially during page load and then, I don't want any server calls. I want jqGrid to handle both the paging and sorting.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-30T15:10:17.040

代替重新发布问题，我会建议一个可能对某人有帮助的链接，但它还没有帮助我：

[http://www.trirand.com/blog/?page_id=18/help/using-client-side-sorting-but-server-side-paging-using-jqgrid/page-1](http://www.trirand.com/blog/?page_id=18/help/using-client-side-sorting-but-server-side-paging-using-jqgrid/page-1)

我也希望通过客户端排序获得客户端分页方面的帮助。

# html - 将带有文本的图像转换为 word 或 txt 或 html 的工具

> ID：933972
> 
> 赞同：-1
> 
> 时间：2009-06-01T08:29:56.797
> 
> 标签：html, .net

让我知道任何将带有文本的图像文件转换为 word、txt 或 html 的工具...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T09:40:16.420

您正在寻找的技术是[OCR](http://en.wikipedia.org/wiki/Optical_character_recognition)。尝试在[Codeproject](http://www.codeproject.com/info/search.aspx?artkw=OCR&sbo=kw)上查找.NET 中的 OCR 实现。

# vim - 在 vim 中注释掉 XML

> ID：933975
> 
> 赞同：20
> 
> 时间：2009-06-01T08:31:00.817
> 
> 标签：vim

我经常发现自己在配置文件中删除和添加 XML 部分：

*   tomcat的server.xml
*   maven的settings.xml

和许多其他人。

是否有一个 vim 插件/命令可以使这个简单？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-06-01T09:01:44.767

[您可以使用匹配的 XML 标记的组合，正如在这个问题](https://stackoverflow.com/questions/500989/jump-to-matching-xml-tags-in-vim "在 VIM 中跳转到匹配的 XML 标签")和 Perl 的搜索和替换中可以看到的那样。

例如，给定这个片段：

```
<TypeDef name="a">
  <ArrayType high="14" low="0">
    <UndefType type="node">
    </UndefType>
  </ArrayType>
</TypeDef> 
```

将光标放在开头或结尾`TypeDef`处，然后键入以下序列：

```
vat:s/^\(.*\)$/<!--\1-->/ 
```

`v`- 让您进入可视模式
`at`- 选择整个 XML 标记- 用XML 的注释分隔符
`:s/^\(.*\)$/<!--\1-->/`包围每一行`'<!--...-->'`

或者，您可以像这样删除它：

```
dat 
```

`d`- 按照以下动作删除
`at`- 和以前一样

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-01T11:04:33.253

使用[环绕.vim](http://www.vim.org/scripts/script.php?script_id=1697 "环绕.vim")进行一般的标签匹配、删除、插入、环绕等，

对于注释标签，很容易使用 vim 文本对象 & 和一个简单的宏

例子：

进入

```
vmap ,c <esc>a--><esc>'<i<!--<esc>'>$ 
```

合适的地方，然后将光标放在以下第二行的“ArrayType”的大写“A”（从上面的 Nathan Fellmans 示例中借用）

```
<TypeDef name="a">
  <ArrayType high="14" low="0">
    <UndefType type="node">
    </UndefType>
  </ArrayType>
</TypeDef> 
```

然后打

```
vat,c 
```

你会得到：

```
<TypeDef name="a">
  <!--<ArrayType high="14" low="0">
    <UndefType type="node">
    </UndefType>
  </ArrayType>-->
</TypeDef> 
```

将光标放在评论的末尾

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-09-04T07:12:42.007

我喜欢[https://github.com/tpope/vim-commentary](https://github.com/tpope/vim-commentary)的简单性。易于添加其他语言，但似乎支持大多数开箱即用。不到 100 行代码。

`gcc`评论当前行，或选择要评论的文本并点击`gc`。超级容易。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-06-01T09:07:24.660

Vim 本身并没有对所有文件类型进行智能注释。你应该得到一个脚本来满足你的评论需求。

我使用已经存在并维护了很长时间的 enhcomentify 脚本

[http://www.vim.org/scripts/script.php?script_id=23](http://www.vim.org/scripts/script.php?script_id=23)

它似乎很好地完成了 xml，并且对于您正在使用的任何文件类型，您都可以获得相同的键绑定的优势。

还有其他人.. 特别是 NERD 评论者

[http://www.vim.org/scripts/script_search_results.php?keywords=comment&script_type=&order_by=rating&direction=descending&search=search](http://www.vim.org/scripts/script_search_results.php?keywords=comment&script_type=&order_by=rating&direction=descending&search=search)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-01T16:43:49.400

我认为调整[这个 vim 技巧](http://vim.wikia.com/wiki/Wrap_a_visual_selection_in_an_HTML_tag)可能很有用。

我建议添加：

```
" Wrap visual selection in an XML comment
vmap <Leader>c <Esc>:call CommentWrap()<CR>
function! CommentWrap()
  normal `>
  if &selection == 'exclusive'
    exe "normal i-->"
  else
    exe "normal a-->"
  endif
  normal `<
  exe "normal i<!--"
  normal `<
endfunction 
```

到你的 .vimrc

然后，在视觉选择处于活动状态 (V) 的情况下，点击 \c（反斜杠然后 c）将您的块包装在`<!-- -->`XML 样式的注释中。

或者，按照 wiki 上的建议，您可以将代码放入 ~/.vim/scripts/wrapwithcomment.vim 并添加到您的 .vimrc：

```
au Filetype html,xml source ~/.vim/scripts/wrapwithcomment.vim 
```

仅在处理 html 或 xml 文件时加载该功能。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-01T08:43:02.633

最好是找到一个在选择的开头和结尾添加内容的命令。

当我评论 python 代码时，我正在这样做：

```
:2,4s/^/#/g 
```

# java - 在准备演示或演示时，我应该如何设置 Eclipse？

> ID：933976
> 
> 赞同：9
> 
> 时间：2009-06-01T08:31:25.217
> 
> 标签：java, eclipse

如果我展示代码，我通常会在语法高亮文本编辑器中展示它。但我最近在一些演示文稿中做了更多的“实时编码”，展示一些 IDE 工具很重要。

在准备演示或演示时，我应该如何设置 Eclipse？

*   有没有办法保存和切换演示者设置？
*   有没有方便的方法来增加字体大小？
*   有什么值得一提的简洁工具或技巧吗？（如 ZoomIt 或 OSX 中的缩放功能）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-01T13:10:40.800

“有没有办法保存和关闭演示者设置？”

**为您将在会议上完成的每项特定任务创建一个新的“视角”。**因此，当您在家开发时，您将使用 c++/java/debug 透视图，然后当您演示时，您将使用 c++-presentation/java-presentation/debug-presentation 透视图。

如何为每个任务创建新视角：

*   复制您当前的开发演示文稿
*   更改为较低的分辨率 800x600 或 1024x800
*   在每个透视图中调整每个 GUI 项目的所有不同大小，并确保它在演示文稿中看起来不错
*   从朋友那里获得大量反馈，看看他们认为应该对您的 eclipse 设置进行哪些更改。

* * *

有没有方便的方法来增加字体大小？

**您可以更改操作系统使用的字体，这将影响 Eclipse 使用的字体。**或者您可以使用以下方法从 Eclipse 中更改字体：

*   菜单栏“窗口”->菜单项“首选项”->左文本窗口“常规”->“外观”->“颜色和字体”
*   双击要更改字体的项目

* * *

有什么值得一提的简洁工具或技巧吗？

**我敢肯定有......但演示文稿不是关于巧妙的技巧。**我见过的所有最好的演示文稿都使用非常简单的工具，而且演示文稿很好，因为演示者与人群交谈和互动。我见过的所有最糟糕的演示都取决于一些失败的巧妙技巧......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T12:37:55.173

正如 graham.reeds 所说，但我更喜欢提高字体大小而不是降低分辨率。

将演示所需的一切都放在自己的工作区中，这样您就不会被您通常从事的所有实际项目所迷惑。我曾经在一个教程中花了 30 分钟试图找出为什么我无法通过测试，并发现我一直在一个项目中编辑一个测试，但在另一个项目中运行一个具有相同名称的测试。幸好我在这期间有练习让观众们继续练习，但我不想再经历那种尴尬了！

单独工作区的另一个好处是演示模式的样式设置不会影响日常工作的样式设置。

此外，关闭所有可能在演示过程中弹出的应用程序：邮件监视器、即时消息等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T09:31:17.717

从我做过的极少数演讲中获得的经验：

*   可读文本的低分辨率
*   尽可能多地去除边缘周围的绒毛
*   练习在这些条件下实际工作（尽可能学习键盘快捷键等）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T13:18:55.137

尝试通过增加字体大小/降低分辨率（无论您选择哪种方式）找到一个良好的平衡。使文本足够大以阅读是很好的，但请记住，这通常会与每行字符数限制相冲突。

根据您的编码风格，您可能有很多超过 80、100 等字符的代码行，滚动显示这些较长的行有时会让人分心，并且难以遵循代码。

你想去多远解决这个问题取决于你。只需确保使用您打算呈现的较低分辨率/较大字体大小来拉动您的代码，并检查您没有进行过多的水平滚动。

# c# - 网页内容编辑器

> ID：933984
> 
> 赞同：0
> 
> 时间：2009-06-01T08:34:34.633
> 
> 标签：c#, asp.net, web-content

是否有任何网页内容编辑器（如 FCKEditor 或 WMD 编辑器）允许页面布局（图像、表格等），如 MS Word？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T08:40:49.910

不太确定您对页面布局的要求是什么，但 Telik 有一个功能非常丰富的 html 编辑器。虽然它是一个商业产品。

看看[http://demos.telerik.com/aspnet-ajax/editor/examples/default/defaultcs.aspx](http://demos.telerik.com/aspnet-ajax/editor/examples/default/defaultcs.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T08:41:15.663

[TinyMCE](http://tinymce.moxiecode.com/)是最接近 MSWord 的候选者……显然，作为一个 Web 界面，它不能完全像 Word，但它具有许多 Word 的功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T08:45:02.070

FCK 和 TinyMCE 都允许表格和其他布局元素（整体 FCK 具有更好的添加元素实现），并且都允许您拥有 url 的图像。

Tiny 有一个插件可以上传图片，但它很重，我认为是专有的。

以上都不是内联编辑器，如果这是你想要的。目前在这个方向上最好的可能是 TiddlyWiki。

我一直在研究我自己的基于 Mootools 的实现，它允许编辑任何网页，并内置了图像上传等功能。它目前处于测试阶段，但如果这是你的目标，我可以给你发送一个链接。

# c - 在哪里可以找到 Visual Studio 的 C99 数学实现？

> ID：933985
> 
> 赞同：2
> 
> 时间：2009-06-01T08:34:44.617
> 
> 标签：c, visual-studio-2005, c99

我有一些代码使用了 C99 中存在的几个数学函数，但没有在 VS2005 附带的 math.h 或 cmath 中定义。我可以在任何地方获得 C99 的 VS2005 兼容实现吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T08:37:50.383

VS 根本不支持 C99 :( 你总是可以在紧要关头从 BSD 的 libc 或其他来源中删除它（GCC 可能有它，但可能会遇到许可问题）

# java - 什么是动态代理类，我为什么要使用一个？

> ID：933993
> 
> 赞同：73
> 
> 时间：2009-06-01T08:39:08.290
> 
> 标签：java, design-patterns, dynamic-proxy

使用动态代理的用例是什么？

它们与字节码生成和反射有何关系？

有什么推荐的读物吗？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2014-01-26T01:57:35.467

我强烈推荐这个[资源](https://web.archive.org/web/20150226062232/http://userpages.umbc.edu/~tarr/dp/lectures/DynProxies-2pp.pdf)。

首先，您必须了解代理模式的用例。请记住，代理的主要目的是控制对目标对象的访问，而不是增强目标对象的功能。访问控制包括同步、认证、远程访问（RPC）、惰性实例化（Hibernate、Mybatis）、AOP（事务）。

与静态代理相比，动态代理生成的字节码需要在运行时进行 Java 反射。使用动态方法，您不需要创建代理类，这可以带来更多便利。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-06-01T08:55:04.530

> *动态代理类*是一个实现在运行时指定的接口列表的类，这样通过类实例上的一个接口的方法调用将被编码并通过统一接口分派到另一个对象。它可用于为接口列表创建类型安全的代理对象，而无需预先生成代理类。动态代理类对于需要在呈现接口 API 的对象上提供类型安全的反射调用调用的应用程序或库很有用。

[动态代理类](http://docs.oracle.com/javase/8/docs/technotes/guides/reflection/proxy.html)

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-11-18T15:11:44.447

我刚刚想出了动态代理的一个有趣用途。

我们在一个非关键服务与另一个依赖服务耦合时遇到了一些麻烦，并且希望探索在该依赖服务不可用时容错的方法。

所以我写了一个**LoadSheddingProxy**，它接受两个委托——一个是“普通”服务的远程实现（在JNDI查找之后）。另一个对象是一个“虚拟”减载 impl。每个方法调用都有一个简单的逻辑，可以捕获超时并在重试之前转移到虚拟对象一段时间。这是我如何使用它：

```
// This is part of your ServiceLocator class
public static MyServiceInterface getMyService() throws Exception
{
    MyServiceInterface loadShedder = new MyServiceInterface() {
        public Thingy[] getThingys(Stuff[] whatever) throws Exception {
            return new Thingy[0];
        }
        //... etc - basically a dummy version of your service goes here
    }           
    Context ctx = JndiUtil.getJNDIContext(MY_CLUSTER);
    try {
        MyServiceInterface impl = ((MyServiceHome) PortableRemoteObject.narrow(
                ctx.lookup(MyServiceHome.JNDI_NAME), 
                MyServiceHome.class)).create();
        // Here's where the proxy comes in
        return (MyService) Proxy.newProxyInstance(
            MyServiceHome.class.getClassLoader(),
        new Class[] { MyServiceInterface.class },
        new LoadSheddingProxy(MyServiceHome.JNDI_NAME, impl, loadShedder, 60000));  // 10 minute retry
    } catch (RemoteException e) {    // If we can't even look up the service we can fail by shedding load too
        logger.warn("Shedding load");
        return loadShedder;
    } finally {
        if (ctx != null) {
        ctx.close();
        }
    }
} 
```

这是代理：

```
public class LoadSheddingProxy implements InvocationHandler {

static final Logger logger = ApplicationLogger.getLogger(LoadSheddingProxy.class);

Object primaryImpl, loadDumpingImpl;
long retry;
String serviceName;
// map is static because we may have many instances of a proxy around repeatedly looked-up remote objects
static final Map<String, Long> servicesLastTimedOut = new HashMap<String, Long>();

public LoadSheddingProxy(String serviceName, Object primaryImpl, Object loadDumpingImpl, long retry)
{
    this.serviceName = serviceName;
    this.primaryImpl = primaryImpl;
    this.loadDumpingImpl = loadDumpingImpl;
    this.retry = retry;
}

public Object invoke(Object obj, Method m, Object[] args) throws Throwable
{
    try
    {
        if (!servicesLastTimedOut.containsKey(serviceName) || timeToRetry()) {
            Object ret = m.invoke(primaryImpl, args);
            servicesLastTimedOut.remove(serviceName);
            return ret;
        } 
        return m.invoke(loadDumpingImpl, args);
    }
    catch (InvocationTargetException e)
    {
        Throwable targetException = e.getTargetException();

        // DETECT TIMEOUT HERE SOMEHOW - not sure this is the way to do it???
        if (targetException instanceof RemoteException) {
            servicesLastTimedOut.put(serviceName, Long.valueOf(System.currentTimeMillis()));
        }
        throw targetException;
    }                    
}

private boolean timeToRetry() {
    long lastFailedAt = servicesLastTimedOut.get(serviceName).longValue();
    return (System.currentTimeMillis() - lastFailedAt) > retry;
}
} 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-06-01T08:46:32.457

该类[`java.lang.reflect.Proxy`](http://java.sun.com/javase/6/docs/api/java/lang/reflect/Proxy.html)允许您通过处理[`InvocationHandler`](http://java.sun.com/javase/6/docs/api/java/lang/reflect/InvocationHandler.html). 它被认为是 Java 反射工具的一部分，但与字节码生成无关。

Sun 有一个关于使用 Proxy 类[的教程。](http://docs.oracle.com/javase/8/docs/technotes/guides/reflection/proxy.html)[谷歌也有帮助。](http://www.google.com/search?q=java+dynamic+proxy)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-06-01T08:47:54.637

一个用例是休眠 - 它为您提供实现模型类接口的对象，但在 getter 和 setter 下存在与 db 相关的代码。即你使用它们就像它们只是简单的 POJO，但实际上有很多事情在掩护下。

例如 - 你只是调用一个惰性加载属性的 getter，但实际上该属性（可能是整个大对象结构）是从数据库中获取的。

您应该检查[cglib](http://cglib.sourceforge.net/)库以获取更多信息。

# c# - 不同 AppDomain 中使用的类的静态变量

> ID：933994
> 
> 赞同：2
> 
> 时间：2009-06-01T08:40:10.643
> 
> 标签：c#, appdomain

我有两个引用同一个类库的可执行文件。在类库中，我有一个静态变量。该静态变量如何保留在两个不同的可执行文件上？

这是它的外观：

```
public class MyClass
{
    public static string MyVar;
} 
```

应用 1：

```
public class MyApp1
{
      public void SomeMethod()
      {
           MyClass.MyVar = "hello";
      }       
} 
```

应用 2：

```
public class MyApp2
{
      public void SomeOtherMethod()
      {
           if(MyClass.MyVar == "hello")    
                DoSomething();
      }       
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-01T08:43:50.963

没有内置的东西可以做到这一点。您是否希望静态变量在可执行文件的调用中也保持不变，或者只是在两者同时运行时？基本上，您正在查看“正常”的持久性机制（并考虑活性 - 检测一个进程何时需要重新加载其状态）。

我个人会尝试围绕这个进行设计，以避免甚至想要这样做。考虑使用两个应用程序与之通信的单独服务。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-01T09:01:21.053

这听起来很愚蠢。
但是将其写入公共位置的文本文件并在需要时从中读取。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-01T08:45:06.530

在 appdomains 之间共享数据的唯一方法是远程处理（WCF、.net 远程处理等）***********