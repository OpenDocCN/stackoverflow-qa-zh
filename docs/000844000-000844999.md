# StackOverflow 问答 000844000-000844999

# javascript - JavaScript 正则表达式和子匹配

> ID：844001
> 
> 赞同：72
> 
> 时间：2009-05-09T20:34:08.570
> 
> 标签：javascript, regex

为什么`g`设置修饰符后 Javascript 子匹配停止工作？

```
var text = 'test test test test';

var result = text.match(/t(e)(s)t/);
// Result: ["test", "e", "s"] 
```

以上工作正常，`result[1]`is`"e"`和`result[2]`is `"s"`。

```
var result = text.match(/t(e)(s)t/g);
// Result: ["test", "test", "test", "test"] 
```

以上忽略了我的捕获组。以下是唯一有效的解决方案吗？

```
var result = text.match(/test/g);
for (var i in result) {
    console.log(result[i].match(/t(e)(s)t/));
}
/* Result:
["test", "e", "s"]
["test", "e", "s"]
["test", "e", "s"]
["test", "e", "s"]
*/ 
```

**编辑：**

我又回来高兴地告诉你，10 年后你现在可以做到这一点（.matchAll 已添加到规范中）

```
let result = [...text.matchAll(/t(e)(s)t/g)]; 
```

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2009-05-09T20:55:14.150

如您所见，如果设置了全局修饰符，使用`String`'函数将不会返回捕获的组。`match()`

在这种情况下，您可能想要使用一个`RegExp`对象并调用它的`exec()`函数。`String`'s`match()`几乎与`RegExp`'`exec()`功能相同……除了这些情况。如果设置了全局修饰符，普通`match()`函数不会返回捕获的组，而`RegExp`'`exec()`函数会。（注意[here](http://james.padolsey.com/javascript/regular-expressions-in-javascript-part-2/)，以及其他地方。）

要记住的另一个问题是它`exec()`不会在一个大数组中返回匹配项——它会一直返回匹配项，直到用完，在这种情况下它会返回`null`.

因此，例如，您可以执行以下操作：

```
var pattern = /t(e)(s)t/g;  // Alternatively, "new RegExp('t(e)(s)t', 'g');"
var match;    

while (match = pattern.exec(text)) {
    // Do something with the match (["test", "e", "s"]) here...
} 
```

另一件需要注意的是，在提供的字符串`RegExp.prototype.exec()`上`RegExp.prototype.test()`执行正则表达式并返回第一个结果。`RegExp.prototype.lastIndex`每个顺序调用都将根据字符串中的当前位置逐步更新结果集。

这是一个示例： // 请记住示例和模式中有 4 个匹配项。lastIndex 从 0 开始

```
pattern.test(text); // pattern.lastIndex = 4
pattern.test(text); // pattern.lastIndex = 9
pattern.exec(text); // pattern.lastIndex = 14
pattern.exec(text); // pattern.lastIndex = 19

// if we were to call pattern.exec(text) again it would return null and reset the pattern.lastIndex to 0
while (var match = pattern.exec(text)) {
    // never gets run because we already traversed the string
    console.log(match);
}

pattern.test(text); // pattern.lastIndex = 4
pattern.test(text); // pattern.lastIndex = 9

// however we can reset the lastIndex and it will give us the ability to traverse the string from the start again or any specific position in the string
pattern.lastIndex = 0;

while (var match = pattern.exec(text)) {
    // outputs all matches
    console.log(match);
} 
```

[您可以在 MDN](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp)上找到有关如何使用`RegExp`对象的信息（具体来说，这里是[函数](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp/exec)[的](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp/exec)文档）。[`exec()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp/exec)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2019-05-15T15:44:23.627

我很惊讶地发现，我是第一个用我 10 年前一直在寻找的答案来回答这个问题的人（答案还不存在）。我还希望实际的规范作者会在我之前回答它；）。

**.matchAll**已经被添加到一些浏览器中。

在现代 javascript 中，我们现在可以通过执行以下操作来完成此操作。

```
let result = [...text.matchAll(/t(e)(s)t/g)]; 
```

[**.matchAll 规范**](https://tc39.github.io/ecma262/#sec-string.prototype.matchall)

[**.matchAll 文档**](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/matchAll)

我现在维护一个同构的 javascript 库，它可以帮助进行很多这种类型的字符串解析。你可以在这里查看：[string-saw](https://github.com/icodeforlove/string-saw)。它有助于使 .matchAll 在使用命名捕获组时更易于使用。

一个例子是

```
saw(text).matchAll(/t(e)(s)t/g) 
```

它会输出一个对用户更友好的匹配数组，如果你想变得花哨，你可以放入命名的捕获组并获取一个对象数组。

# asp.net - Internet Explorer 8 中 ScriptManager.RegisterClientScriptBlock 和 jQuery 的问题

> ID：844004
> 
> 赞同：8
> 
> 时间：2009-05-09T20:34:42.483
> 
> 标签：asp.net, jquery, plugins, scriptmanager, registerclientscriptblock

我想使用 jQuery 的 jGrowl 插件（[http://stanlemon.net/projects/jgrowl.html#samples](http://stanlemon.net/projects/jgrowl.html#samples)）在页面上显示一些消息。为此，我调用 ScriptManager.RegisterClientScriptBlock 方法，如下所示：

```
ScriptManager.RegisterClientScriptBlock(this, typeof(Page), Guid.NewGuid().ToString(),
   "$.jGrowl('" + message + "');", true); 
```

该代码在 Firefox/Chrome/Safari 中完美运行。但是在 Internet Explorer 中，我看不到通知，也没有收到任何 Javascript 错误。

我在 Windows 7 下工作，我有 Internet Explorer 8 Beta（版本 8.0.7000.0），并且在兼容模式下我有相同的“错误”。

我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-10T04:56:19.237

出现此问题是因为 IE8 期望在可以对 DOM 进行修改之前加载所有 DOM 元素。我能够复制您使用 jGrowl 描述的问题。

为了解决这个问题，我刚刚修改了您的脚本，以便在文档准备好后调用 jGrowl。这是更新的代码：

```
ScriptManager.RegisterClientScriptBlock(this, typeof(Page), 
     Guid.NewGuid().ToString(),
     "$(function(){$.jGrowl('" + message + "');});", true); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-01-04T08:41:11.770

添加`<form runat="server" id="form1">`到页面。它会工作...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T03:16:49.857

如果没有错，我认为您必须在客户端页面中添加此内容。

```
<script language="javascript" type="text/javascript" id="forModalPopUp">
    var prm =  Sys.WebForms.PageRequestManager.getInstance();
    prm.add_initializeRequest(InitializeRequest);
    prm.add_endRequest(EndRequest);
    function InitializeRequest(sender, args) {
    }
    function EndRequest(sender, args) {
    }
</script> 
```

有关更多详细信息，请查看[此](http://oysterleelife.blogspot.com/2012/05/scripmanager-error-in-updatepanel.html)。

# html - HTML 编码：东欧语言

> ID：844006
> 
> 赞同：2
> 
> 时间：2009-05-09T20:35:34.510
> 
> 标签：html, character-encoding

我的程序正在从包含英语、德语和几种东欧语言的数据库中获取消息。我的 Python 脚本通过以下方式设置编码：

```
<meta  http-equiv="Content-Type" content="text/html; charset=utf-8"/> 
```

并使用从数据库中正确获取的值（如果我在我的日志中检查）。

不幸的是，我测试的所有浏览器（IE8、Firefox 3.0.10、Opera 9.64）都会根据我的本地语言设置切换为：

*   Firefox 中的西方 ISO-8859-1
*   IE 中的西欧 (Windows)
*   在 Opera 中自动

我在浏览器中手动切换字符编码后，一切正常。

如果我使用 UTF-8 手动生成 HTML 文件（使用 TextMate 各自的 jEdit 测试），也会发生同样的情况，尽管两个编辑器都正确显示了内容。

这适用于英语和德语，但不适用于俄语。如何强制“正确”字符编码？

**回答**

VirtualHost（Apache 配置）部分中的以下条目对我有用：

```
AddDefaultCharset utf-8 
```

非常感谢您为我指明了正确的方向，这很有帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-09T20:55:02.827

当文档通过 HTTP 传输时，[HTTP 标头信息是关键信息](http://www.w3.org/TR/html401/charset.html#h-5.2.2)：

> […] 符合标准的用户代理在确定文档的字符编码时必须遵守以下优先级（从最高优先级到最低优先级）：
> 
> 1.  " " 字段中的 HTTP " `charset`" 参数`Content-Type`。
> 2.  `META`带有“ ”的声明`http-equiv`设置为“ `Content-Type`”，并为“”设置了一个值`charset`。
> 3.  `charset`在指定外部资源的元素上设置的属性。

因此，请确保在[`Content-Type`标题字段](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.17)中声明字符编码，而不仅仅是在文档中。

# jquery - jQuery asp 下拉列表

> ID：844007
> 
> 赞同：1
> 
> 时间：2009-05-09T20:36:24.943
> 
> 标签：jquery, asp.net

我有一个带有一些 asp 表单元素的控件，但是如何在另一个控件中获取表单元素。我通常做 jQuery('#<%= MyDropDownList.ClientID %>).val()，但这是不可能的，因为它在另一个控件中。如何在不硬编码的情况下访问元素？

总结一下： 控件 1：Asp:DropDownList 控件 2：需要通过 jQuery 从控件 1 访问 asp:DropDownlist 中的值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T21:18:59.117

您可以使用以下 jQuery 选择器获取**Control1**内下拉列表的值。

```
$('#<%= Control1.ClientID%> select').val() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T21:39:45.120

如果名称是唯一的，您可以使用选择器在 id 的末尾进行名称匹配。

```
$('[id$="DropDownList1"]').val(); 
```

这将匹配所有以 id 结尾的控件`DropDownList1`并获取第一个控件的值。如果名称是唯一的，那么它将是您的另一个下拉列表。

# sqlite - SQLite - 涉及 2 个表的查询

> ID：844011
> 
> 赞同：1
> 
> 时间：2009-05-09T20:38:52.020
> 
> 标签：sqlite

我想从某个表中选择一行并根据另一个表对结果进行排序。

这是我的表：

```
lang1_words:
word_id - word

statuses:
word_id - status 
```

在每个表中 word_id 对应于另一个表中的值。

这是我的查询：

```
SELECT statuses.word_id FROM statuses, lang1_words
WHERE statuses.status >= 0
ORDER BY lang1_words.word ASC 
```

但它返回超过 1 行的相同 word_id 并且它们的结果没有按字母顺序排序。

我的查询有什么问题，我该如何实现我的目标？

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-09T20:51:21.307

您需要加入这两个表，一种方法是：

```
SELECT statuses.word_id FROM
statuses JOIN lang1_words ON statuses.word_id = lang1_words.word_id
WHERE statuses.status >= 0
ORDER BY lang1_words.word ASC 
```

# google-chrome - 如何在新标签页的谷歌浏览器中打开 PDF 文件？

> ID：844027
> 
> 赞同：-1
> 
> 时间：2009-05-09T20:47:11.877
> 
> 标签：google-chrome

我知道这不是关于编程的问题，但我希望我能找到我的问题的答案。

有没有办法强制谷歌浏览器在新标签页中打开 PDF 文件？现在 Chrome 在当前打开的选项卡中打开 PDF，单击“返回”按钮返回真的很烦人。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-09T20:49:28.970

单击 PDF 链接时按住 Ctrl 键。

它在 FireFox 和 IE 中的工作方式相同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T20:49:42.323

单击链接时尝试按住 Ctrl 键。或者右键单击链接并在新选项卡中打开。或者只是通过右键单击下载文件并保存，然后在 Chrome 之外打开它。

# sql - 如何从 SQL SSIS 中的日期时间字符串中删除日期？

> ID：844029
> 
> 赞同：5
> 
> 时间：2009-05-09T20:47:26.337
> 
> 标签：sql, tsql, ssis, business-intelligence

我正在处理一个数据仓库项目，并且想知道如何（最好在数据流中的派生列组件中）从 SQL 日期时间记录中删除日期片段。

一旦我将日期时间转换为时间，我将查找时间以在时间维度表中找到相关的时间记录。

有人可以给我一个简单的函数来在派生列转换中完成这个吗？

示例：将日期时间（例如“12/02/2008 11:32:21 AM”）简单地转换为“11:32:21 AM”。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-10T22:56:55.543

我只会进行`DT_DBTIME`类型转换（使用派生列转换或转换类型转换）。`DT_DBTIME`仅包含日期/时间的（小时、分钟、秒）部分，因此您将摆脱日期部分。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-27T16:22:46.103

实际上，如果您像这样反转前 2 个表达式： `(DT_DBDATE)(DT_DATE)GETDATE()` 而不是`(DT_DATE)(DT_DBDATE)GETDATE()`，那么您将`TRUNCATE`关闭日期字段的时间。

如果`DT_DATE`表达式在表达式之前`DT_DBDATE`，您的输出中仍然会有时间部分，但它会被重置为全零。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-10-19T08:05:07.263

如果您需要在变量表达式中执行此操作，Michael 的解决方案将不起作用，但您可以使用以下表达式：

```
(DT_DATE)(DT_DBDATE)GETDATE() 
```

(DT_DBDATE) 仅将当前日期和时间转换为日期。但是新的数据类型与 SSIS 的日期时间不兼容。因此，您必须使用 (DT_DATE) 转换为兼容类型。

此解决方案的礼貌属于 Russel Loski，他已将其发布在他的博客中：http: [//www.bidn.com/blogs/RussLoski/ssas/1458/converting-datetime-to-date-in-ssis](http://www.bidn.com/blogs/RussLoski/ssas/1458/converting-datetime-to-date-in-ssis)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-11-16T21:21:45.287

在为调度应用程序编写报告时遇到了这个问题，需要存储为日期时间数据类型的一部分的时间。我将日期时间格式化为 0，这给了你这个 mon dd yyyy hh:miAM（或 PM），并且只是做了一个子字符串，它只以 AM/PM 格式返回时间。

下面的例子。

```
DECLARE @S DATETIME = GETDATE()

SELECT SUBSTRING(CONVERT(NVARCHAR(30), @S , 0) , 13 , 10) AS ApptTime
    , CONVERT(NVARCHAR(30), @S , 0) AS ApptDate 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-05-11T13:49:27.047

我个人为此使用了一系列功能。例如：

```
ALTER FUNCTION [dbo].[TIMEVALUE]
(
 @Datetime datetime
)
RETURNS datetime
AS
BEGIN
    RETURN (@Datetime - CAST(ROUND(CAST(@Datetime AS float), 0, 1) AS datetime))
END 
```

我很想获得所有的功劳，但它真的应该归功于[这个人](http://weblogs.asp.net/guerchele/archive/2004/05/04/RE_3A00_-Separating-Date-and-Time-in-T_2D00_SQL.aspx)。

# c# - 使用 C# 和 AutoIt 向 Flash 游戏发送消息

> ID：844030
> 
> 赞同：6
> 
> 时间：2009-05-09T20:47:30.720
> 
> 标签：c#, flash, bots, minimized

我正在为 Flash 游戏制作机器人，并且我已经弄清楚如何将所有[AutoIt](http://en.wikipedia.org/wiki/AutoIt)函数导入到我的 C# 代码中。

```
string title = "Minesweeper";
string full = auto.WinGetTitle(title,"");
string handle = auto.WinGetHandle(full, "");
if (auto.WinExists(full, "") == 1)
    textBox1.Text = "window exists";
addressBox.Text = full;

for (int r = 1; r < 40; r++)
{
    auto.ControlClick(full, "", "", "left", 2, r * 10, r * 10);
    //auto.ControlClick(handle, "", "", "left", 2, r * 10, r * 10);
} 
```

（我很确定未注释的应该是带手柄的，反之亦然，但这适用于[Minesweeper](http://en.wikipedia.org/wiki/Minesweeper_%28Windows%29)。）

所以它适用于扫雷并且不需要它是活动窗口。当我尝试让它在我的 Flash 游戏上运行时，它需要 Internet Explorer 窗口处于活动状态。这是 Flash 需要的东西，还是在游戏最小化时我可以做些什么来使它工作？

这不必使用 AutoIt 导入来完成。我也曾一度尝试过来自 user32 的[SendMessage](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644950%28v=vs.85%29.aspx)，但这对我来说根本不适用于 Flash 内容。

我只是在一个随机网站而不是 Flash 网站或扫雷器上对此进行了测试，出于某种原因，如果我从 Autoit 脚本程序中执行它，而不是从我的 C# 程序中执行它，则代码可以工作......

**2012 年 6 月 20 日**：我很确定这与手柄通过的方式有关。我已经通过调用 AutoIt EXE 文件并使用从 C# 代码中获得的句柄作为参数进行了一些测试，我必须向其中添加一个`0x`，然后在 AutoIt 代码中我必须将它从字符串转换为一个 HWnd，所以这可能是什么，在这种情况下，我不知道该怎么做，因为导入的函数依赖于句柄的字符串输入。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-21T14:50:43.810

您可能想尝试排除窗口句柄和变量处理问题。不需要使用 WinGetTitle，“扫雷”窗口标题应该可以正常工作。根据我在 Windows 7 中的 AutoIt v3 Window Info 工具，Minesweeper 窗口的标题和类别都是 Minesweeper。这么难的编码

> auto.ControlClick("[TITLE:Minesweeper; CLASS:Minesweeper], "", "", "left", 2, r * 10, r * 10);

可能会奏效。有关其工作原理的更多信息，请参阅AutoIt 帮助文件中的**高级窗口描述**。如果这仍然不起作用，请在帮助文件中查找**WinTitleMatchMode 。**它允许您在窗口标题匹配中设置一些宽大处理规则，这可以使您更轻松。

AutoIt X 是 AutoIt 的 DLL/COM 控制版本，它是您将 AuotIt 添加到任何支持 DLL/COM 的语言的方式。如果其他人想知道[您将如何在 C# 中使用 AutoIt](http://www.autoitscript.com/forum/index.php?showtopic=39262)。不幸的是，AutoIt X 在主要语言的开发和测试方面经常落后。尽管没有理由认为您的问题是由仅提供 AutoItX 项目背景的错误引起的。如果您还没有，您应该将这个问题的副本发布到 [ActiveX/COM 帮助和支持 (AutoItX)](http://www.autoitscript.com/forum/index.php?showforum=14)论坛。多年来，根据我的经验，AutoIt 最棒的地方之一就是社区（这里并没有太多变化）。一些愿意提供帮助的语言开发人员经常光顾该特定论坛部分。

至于你**6 月 20 日**的笔记，AutoIt 将所有变量都视为字符串，直到它检测到它的特殊之处。它不知道一个值是十六进制的，除非它以你提到的 0x 开头。这在过去给我带来了各种奇怪的问题。我有几次不得不将零添加到变量中，以便 AutoIt 在之后正确评估它。AutoIt3 不会经常发生这种情况，但请记住一些事情。

如果您需要任何 AutoIt 参考代码，AutoIt 论坛的许多成员[都制作了扫雷机器人](http://www.autoitscript.com/forum/index.php?act=Search&CODE=show&searchid=6d33165bd3e245e37eca1e3a23a77923&search_in=posts&result_type=topics&highlite=%2Bminesweeper)，您可以查看并可能会看到一些有用的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-20T14:23:25.253

确保以管理员身份运行 C# 程序。这是我可以看到的一种方法有效而另一种方法无效的唯一区别。

# ruby-on-rails - 私有方法中的 redirect_to

> ID：844034
> 
> 赞同：0
> 
> 时间：2009-05-09T20:49:11.403
> 
> 标签：ruby-on-rails, ruby

我有一个调用私有方法的操作。如果此私有方法发生错误，则会 调用*redirect_to 。*问题是它到达了*redirect_to*并根据它正在重定向的日志但不在客户端并导致错误。

有什么建议么？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-09T21:09:06.020

您可以尝试将私有方法临时更改为公开，但我认为它不太可能有帮助。

尝试安装 Firefox 插件`httpfox`并查看浏览器接收到的原始字节。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T16:05:49.507

从私有方法调用 redirect_to 绝对没有问题，你的问题是别的。

# visual-studio-2008 - 如何不断更新VS2008 Watch Window（不停止执行）？

> ID：844042
> 
> 赞同：3
> 
> 时间：2009-05-09T20:51:53.520
> 
> 标签：visual-studio-2008, debugging, watch

在 Adob​​e Director 中，有一个监视窗口会在我的应用程序运行时更新。例如，如果我有一个游戏应用程序并正在观察一个球对象的实例，我可以看到它的所有值（速度、高度、状态变量等）在应用程序运行时实时更新。我还可以将任何其他对象添加到窗口中，并在不停止执行的情况下深入了解它的变量。

在 C# 中的 Visual Studio（我在 2008 年）中有没有办法在我的应用程序运行时更新“调试”>“监视”窗口？换句话说，我想在应用程序运行时关注给定对象的不同变量，而不是冻结所有内容并在某个特定时刻检查事物的状态。

如果这不可能，是否有任何方法可以查看任意对象的值（无需预先对这些对象进行硬编码）。例如，对于坦克对象，我们有位置、方向、速度等。假设有几十个不同类型的游戏对象，每个对象都有十几个值。这些值每秒变化 60 次。

目标是能够在运行时选择要“观察”的游戏对象，然后深入了解它的变量层次结构（与观察器窗格的方式相同）。同样，此工具事先不了解对象，因此无法针对特定对象进行硬编码。

提前致谢！

亚当

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T22:20:23.640

如果您想要监视变量的特定值，可以使用条件断点：http: [//msdn.microsoft.com/en-us/library/7sye83ce.aspx](http://msdn.microsoft.com/en-us/library/7sye83ce.aspx)

当然，也总是有可靠的 ASSERT() 宏。

如果您有非常复杂的调试需求，您可能需要在应用程序中编写自定义代码来进行调试。通常，这类事情会被包裹在 #ifdef _DEBUG/#endif 语句中，这样发布版本就不会受到影响。您可以支持从日志文件调试的旧备用到编写自定义监视窗口以显示您需要查看的当前值的所有内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-14T15:58:26.137

创建一个断点，右键单击它，选择命中事件，并在那里设置变量的打印。这行得通。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-14T16:00:56.827

没有办法做到这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-10T22:25:42.233

我不确定是否可以像您描述的那样设置调试监视窗口不断更新。您是否考虑[`TRACE`](http://msdn.microsoft.com/en-us/library/4wyz8787%28VS.80%29.aspx)过在应用程序运行时使用将内容输出到输出面板的宏？

```
TRACE(_T("m_LocationX: %d\n"), m_LocationX);
TRACE(_T("m_LocationY: %d\n"), m_LocationY); 
```

根据`TRACE`语句执行的频率，您的输出窗口可能会被淹没，但它至少应该为您提供运行时所需的信息。

* * *

**编辑 1：**如果您不使用 MFC，请查看解释替代方法的StackOverflow[答案。](https://stackoverflow.com/questions/494653/how-can-i-use-trace-macro-in-non-mfc-projects)

**编辑 2：**再次查看这个问题，不清楚您使用的是 C++ 还是 .Net - 如果您使用的是 C#，那么您可以通过使用`Debug`and`Trace`类来获得类似的结果 - 一篇描述它们使用的好文章可以是在[这里](http://support.microsoft.com/kb/815788)找到。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-09T20:59:07.853

这可能会有所帮助：

[http://msdn.microsoft.com/en-us/library/z4ecfxd9.aspx](http://msdn.microsoft.com/en-us/library/z4ecfxd9.aspx)

打开或关闭自动属性评估

> 1.  在工具菜单上，单击选项。
> 2.  在选项对话框中，打开调试节点，然后单击常规。根据您的 IDE 设置，您可能需要选择显示所有设置才能查看调试节点。
> 3.  选择或清除启用属性评估和其他隐式函数调用。
> 4.  单击确定。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-09T21:15:55.800

我不知道在不被调试器破坏的情况下进行观看的方法，但是您可以使用几种不同的方法。我会亲自使用 Trace 和 Trace.Writeline 或类似的东西（我使用自定义库）。但是，您也可以使用 Tracepoints 获得快速解决方案，这是将内容输出到输出窗口的断点。

我有一个简短的谷歌，这篇[文章](http://msdn.microsoft.com/en-us/library/232dxah7.aspx "文章")似乎给出了如何设置它们的概述，你把你的变量名放在 { } 中，它们被输出到输出窗口，似乎没有闯入调试器（尽管在幕后这正是它确实）

希望有帮助

# prolog - 在 gprolog 中声明谓词动态

> ID：844043
> 
> 赞同：8
> 
> 时间：2009-05-09T20:52:21.397
> 
> 标签：prolog, prolog-directive-dynamic

我在 Prolog 中有这段代码：

```
dynamic(player_at/1).
player_at(house).
goto(X) :- retract(player_at(house)), assert(player_at(X)). 
```

但我仍然收到此错误：

```
uncaught exception: error(permission_error(modify,static_procedure,player_at/1),retract/1) 
```

当我执行 goto(foo) 时。

我已经阅读了[动态文档](http://contraintes.inria.fr/~haemmerl/gprolog-rh/doc/manual021.html#htoc47)，但我不知道如何使用它，至少在 gprolog 中是这样。我错过了什么吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-09T21:00:12.097

通过添加前缀来修复第一行`:-`：

```
:- dynamic(player_at/1). 
```

没有`:-`该行将 dreefine predicate `dynamic/1`，而不是执行现有的`dynamic`谓词。

其他 prolog 实现（但不是 gprolog）也支持这一点：

```
:- dynamic player_at/1. 
```

# xml - 为什么人们会使用纯 XML 数据库而不是普通的 RDBM？

> ID：844045
> 
> 赞同：7
> 
> 时间：2009-05-09T20:53:09.040
> 
> 标签：xml, database

你们中有多少人实际上在使用纯 XML 数据库而不是 RDBM？前者似乎正在获得动力，但我不明白优势。有人愿意解释吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-09T21:07:05.043

表明 XML 的条件并不是一个疯狂的想法

*   如果您的数据看起来像一组文档。例如，小说具有结构，例如章节、段落、句子、单词。您可能希望以编程方式访问该结构，但很难创建支持该结构的关系模式。

*   所需的字段和表格数量之多令人难以置信，几乎所有都是可选的。例如，并非所有小说都有恶棍，但恶棍属性或标签很容易添加到 xml 文档中。

*   如果你有相当少量的数据。

*   数据具有很强的层次性。查询组织结构图的 XML 文档比对具有链接到自身的经理列的员工表执行类似查询更容易。

示例 - 使用普通 ole xml 作为数据存储的 DasBlog。

表明关系模型更好的条件

*   您的大部分数据都很好地适合表格和列，相当少量的字段，大多数字段都是必需的。

*   有很多数据。与 XML 数据库世界相比，关系世界一直在优化性能。

你可以同时拥有它

*   大多数现代关系数据库都支持 xml 作为第一类数据类型。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-09T21:57:22.240

没有提到的一个优点是，如果数据应该对公众可用（通过 RSS 或其他方式），它会容易得多。如果数据的主要用途是用于某种公共 API，或者以后无论如何都要格式化为 XML，那么为什么不呢？假设您想存储一些 HTML 模板。*将其存储*为 HTML不是更容易吗？您还可以节省 RDBMS 的开销并将数据处理为 XML。

如果您几乎只进行阅读和很少的写作，那么 XML 也可以，但根据您的工作，更简单的格式（例如 JSON）可能更有效。

在任何其他情况下，尤其是在涉及大量数据操作的情况下，真正的数据库（无论是关系型、面向对象、面向文档等）都会更加高效，因为它们就是为此而构建的。XML 并不适用于 100,000,000 行数据。

我认为一些数据库使用 XML 的原因是因为它是一种广泛使用的格式，尤其是对于 RSS 提要之类的东西。就像我之前说的，如果您的数据最终需要是 XML，那么为什么不将其存储为 XML，让您的生活更轻松呢？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-09T21:29:34.647

作为从事大量使用 XML 数据库的开源产品的人，我发现 XML 数据源非常宝贵，因为它们代表了程序中使用的纯数据结构。

XML 允许我在代码中对复杂结构进行建模，然后将其直接序列化为 XML，以便在其他地方或以后读取，或者我特别是在我的情况下导出 XML 中的复杂结构，然后在内存中对其进行操作和查询。还有其他选项，例如[ODBMS](http://en.wikipedia.org/wiki/ODBMS)和[ORM](http://en.wikipedia.org/wiki/Object-relational_mapping)，它们提供了许多相同的优点（然后还有更多），但会带来知识或性能开销。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-09T21:12:52.923

我看不到在没有上下文的情况下使用 XML 优于关系数据库的真正好处。

关系数据库通常操作起来很笨拙，尽管您可以轻松地查询它们的任何需求。如果您不需要对数据进行查询，那么您对 ​​RDBM 没有任何实际用途。您见过多少张照片包含在关系数据库中？将照片存储为jpeg或png不是更方便吗？另一方面，您喜欢将图像像素存储在 XML 中吗？

# c# - 使工作进程回收所需的使用内存量的经验法则？

> ID：844050
> 
> 赞同：1
> 
> 时间：2009-05-09T20:56:36.673
> 
> 标签：c#, .net, asp.net, worker-process

我有一个包含很多这样的代码库：

```
byte[] contents = FileUtils.FileToByteArray(FileOfGartantuanProportions); 
```

我不控制我的 IIS 服务器，所以我看不到系统日志或进行检测，我只是看到我的请求无法返回（死亡白页），有时 YSOD 出现内存不足错误。

在 IIS5 或 IIS6 终止工作进程或干脆死掉之前，有没有人有一个经验法则，你可以加载到内存中的最多数据是多少？

或者更好的是，我是否有一个 API 调用，例如：

```
 if(!IsEnoughMemoryFor(FileOfGartantuanProportion.Length)) throw new SomeException() ; 
```

在我的 XP Pro 工作站上，我可以获得一个 ASP.NET 页面来成功处理内存中非常大的字节数组，但这些结果显然不适用于真正的共享服务器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T15:33:12.740

在本机模式下使用 IIS6，您可以配置每个应用程序池的限制。

对于 IIS5，它使用 machine.config 中的元素作为总系统内存的百分比进行配置 - 默认为 60%。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T15:36:37.213

对于 IIS 6，您可能会遇到[内存回收限制](http://download.microsoft.com/download/2/8/0/2800a518-7ac6-4aac-bd85-74d2c52e1ec6/tuning.doc)PeriodicRestartPrivateMemory 和 PeriodicRestartMemory。我认为在 XP 上，它是物理内存的 60%。至少那是我对 asp.net 1.1 的记忆，我不确定 2.0

YSOD 可能最好用 try/catch 围绕大分配来处理。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-30T20:35:55.107

根据[Tess Ferrandez](http://blogs.msdn.com/tess/)在 TechEd 上的演讲，当您有大约 800MB 的私有字节或 1.4GB 的虚拟字节时，您可以开始在 32 位服务器上看到内存不足异常。

她也有一篇关于为什么会在这里的好帖子：

> [餐厅类比](http://blogs.msdn.com/tess/archive/2006/09/06/net-memory-usage-a-restaurant-analogy.aspx)

她提出的其他观点包括考虑您要序列化到会话中的内容 - 例如，序列化 1MB 数据集可能导致服务器每页使用 15-20MB 内存，因为该数据被序列化和反序列化。

# java - 如何在 Java 中传递 uint？

> ID：844053
> 
> 赞同：2
> 
> 时间：2009-05-09T20:58:11.150
> 
> 标签：java, winapi, uint32

我正在尝试使用 Java 中的 uint 参数调用 SendMessage，但我无法将 int 转换为 uint。我无法更改 SendMessage 中的 uint 参数，因为它是一个 windows 函数。有没有办法做到这一点？

背景：我实际上正在使用处理，我正在按照以下教程访问 user32.dll： http://processing.org/hacks/hacks: [jnative](http://processing.org/hacks/hacks:jnative)

和[http://jnative.free.fr/SPIP-v1-8-3/article.php3?id_article=8](http://jnative.free.fr/SPIP-v1-8-3/article.php3?id_article=8)

我正在关注这个来调用 SendMessage [http://www.codeproject.com/KB/cs/Monitor_management_guide.aspx](http://www.codeproject.com/KB/cs/Monitor_management_guide.aspx)

这是我的代码，GetActiveWindow 工作正常，它来自上面的第二个链接。

```
 int SC_MONITORPOWER = 0xF170;
 int WM_SYSCOMMAND = 0x0112;
 int MONITOR_ON = -1;
 int MONITOR_OFF = 2;
 int MONITOR_STANDBY = 1;

HWND ValidHWND = org.xvolks.jnative.util.User32.GetActiveWindow(); 
org.xvolks.jnative.util.User32.SendMessage(ValidHWND, (UINT)WM_SYSCOMMAND, 
          (WPARAM)SC_MONITORPOWER, (LPARAM)MONITOR_STANDBY); 
```

最后一行是发生错误的地方，它表示 User32 类型的预期 UINT 不适用于我提供的 LONG。我也不能修改 SendMessage

这是上面调用调用的相应 java 文件，GetActiveWindow 部分工作正常，因为它来自教程。我正在尝试定制 Sendmessage 以遵循它，但我还没有完全弄清楚。但是，我认为这对我得到的错误并不重要，因为在这里将参数更改为 SendMessage 不会改变编译器的期望。我已经尝试将 int Msg 更改为 uint Msg 到 long Msg，编译器仍然需要上面代码中的 uint。

```
public class Paul_s_User32 extends User32 {
public HANDLE GetActiveWindow() {
    JNative GetActiveWindow = new JNative(DLL_NAME, "GetActiveWindow");
    GetActiveWindow.setRetVal(Type.INT);
    GetActiveWindow.invoke();
    HWND handle = new HWND(GetActiveWindow.getRetValAsInt());
    GetActiveWindow.dispose();
    return handle;
}
public IntPtr SendMessage(IntPtr hWnd, int Msg, 
          IntPtr wParam, IntPtr lParam) {
    JNative SendMessage = new JNative(DLL_NAME, "SendMessage");
    //SendMessage.setRetVal(Type.long);
    SendMessage.invoke();

    SendMessage(ValidHWND, WM_SYSCOMMAND, SC_MONITORPOWER, MONITOR_STANDBY);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-09T21:48:19.420

从数据的角度来看，一个 uint 和一个 int 是同一个东西——一个 32 位的值。唯一的区别是操作码如何解释最高位。在 Java 和 C 之间传递时，您只是传递 32 位，因此符号无关紧要。解决方案是将 uint 参数声明为 int。

顺便说一句，未签名/已签名的问题在这里并不重要，因为 SendMessage 的 uMsg 值对于所有 Microsoft 消息都是正数，就此而言，对于您可能遇到的其他任何事情，很可能是正数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-10T01:25:37.683

如果您使用的是 org.xvolks.jnative 包，所有参数（HWND、UINT、WPARAM 和 LPARAM）都是 org.xvolks.jnative.misc.basicStructures 中的类。所以你应该能够做这样的事情（未经测试的代码）：

```
import org.xvolks.jnative.misc.basicStructures.*;
...

User32.SendMessage(
    new HWND(ValidHWND),
    new UINT(WM_SYSCOMMAND), 
    new WPARAM(SC_MONITORPOWER),
    new LPARAM(MONITOR_STANDBY); 
```

供您参考，这里是 org.xvolks.jnative.util.User32 中 SendMessage 的实现。如您所见，jnative 代码根本不关心有符号和无符号。[您可能会发现获取jnative 源代码](http://sourceforge.net/project/showfiles.php?group_id=156421&package_id=174535)很有用。

```
public static LRESULT SendMessage(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam) throws NativeException, IllegalAccessException
{
    JNative SendMessage = new JNative(DLL_NAME, "SendMessageA");
    SendMessage.setRetVal(Type.INT);
    int pos = 0;
    SendMessage.setParameter(pos++, hWnd.getValue());
    SendMessage.setParameter(pos++, Msg.getValue());
    SendMessage.setParameter(pos++, wParam.getValue());
    SendMessage.setParameter(pos++, lParam.getValue());
    SendMessage.invoke();
    pos = SendMessage.getRetValAsInt();
    SendMessage.dispose();
    return new LRESULT(pos);
} 
```

如果您决定不喜欢 JNative，您可以查看[Java Native Access (JNA)](https://github.com/twall/jna/)。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-09T21:02:58.390

由于 Java 没有无符号类型的概念，因此您必须使用 long 来表示无符号 int。检查[此站点](http://darksleep.com/player/JavaAndUnsignedTypes.html)以获取有关如何执行此操作的示例。

# c# - .NET 等价于旧的 vb left(string, length) 函数

> ID：844059
> 
> 赞同：74
> 
> 时间：2009-05-09T21:01:30.970
> 
> 标签：c#, .net, vb.net

作为一名非 .NET 程序员，我正在寻找与旧的 Visual Basic 函数等效的 .NET `left(string, length)`。它很懒，因为它适用于任何长度的字符串。正如预期的那样，`left("foobar", 3) = "foo"`虽然，最有帮助的是，`left("f", 3) = "f"`.

在 .NET`string.Substring(index, length)`中，所有超出范围的内容都会引发异常。在 Java 中，我总是使用 Apache-Commons lang.StringUtils。在谷歌中，我搜索字符串函数并没有走得太远。

* * *

**@Noldorin** - 哇，感谢您的 VB.NET 扩展！我的第一次遇到，虽然我花了几秒钟在 C# 中做同样的事情：

```
public static class Utils
{
    public static string Left(this string str, int length)
    {
        return str.Substring(0, Math.Min(length, str.Length));
    }
} 
```

注意静态类和方法以及`this`关键字。是的，它们很容易调用，就像`"foobar".Left(3)`. 另请参阅[MSDN 上的 C# 扩展](http://msdn.microsoft.com/en-us/library/bb383977.aspx)。

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2009-05-09T21:10:11.977

这是一个可以完成这项工作的扩展方法。

```
<System.Runtime.CompilerServices.Extension()> _
Public Function Left(ByVal str As String, ByVal length As Integer) As String
    Return str.Substring(0, Math.Min(str.Length, length))
End Function 
```

这意味着您可以像使用旧的 VB`Left`函数（即`Left("foobar", 3)`）一样使用它，也可以使用较新的 VB.NET 语法，即

```
Dim foo = "f".Left(3) ' foo = "f"
Dim bar = "bar123".Left(3) ' bar = "bar" 
```

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2009-05-09T21:11:29.713

另一个单行选项将类似于以下内容：

```
myString.Substring(0, Math.Min(length, myString.Length)) 
```

其中 myString 是您尝试使用的字符串。

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2009-05-09T21:19:14.110

添加对 Microsoft.VisualBasic 库的引用，您可以使用完全相同*的方法*[Strings.Left](http://msdn.microsoft.com/en-us/library/microsoft.visualbasic.strings.left.aspx)。

 ** * *

## 回答 #4

> 赞同：15
> 
> 时间：2011-02-11T23:46:49.810

不要忘记 null 情况：

```
public static string Left(this string str, int count)
{
    if (string.IsNullOrEmpty(str) || count < 1)
        return string.Empty;
    else
        return str.Substring(0,Math.Min(count, str.Length));
} 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2014-07-07T21:00:26.537

利用：

```
using System;

public static class DataTypeExtensions
{
    #region Methods

    public static string Left(this string str, int length)
    {
        str = (str ?? string.Empty);
        return str.Substring(0, Math.Min(length, str.Length));
    }

    public static string Right(this string str, int length)
    {
        str = (str ?? string.Empty);
        return (str.Length >= length)
            ? str.Substring(str.Length - length, length)
            : str;
    }

    #endregion
} 
```

它不应该出错，将空值作为空字符串返回，并返回修剪后的值或基值。像 "testx".Left(4) 或 str.Right(12) 一样使用它；

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-05-09T21:05:33.267

你可以自己做：

```
private string left(string inString, int inInt)
{
    if (inInt > inString.Length)
        inInt = inString.Length;
    return inString.Substring(0, inInt);
} 
```

我的是 C#，你必须为 Visual Basic 更改它。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-09T21:04:35.110

您可以将 substring 的调用包装在一个新函数中，该函数按照其他答案中的建议（正确的方式）测试它的长度，或者使用 Microsoft.VisualBasic 命名空间并直接使用 left （通常被认为是错误的方式！）

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-09-18T16:27:17.800

另一种技术是通过添加 Left() 方法来扩展字符串对象。

这是有关此技术的源文章：

[http://msdn.microsoft.com/en-us/library/bb384936.aspx](http://msdn.microsoft.com/en-us/library/bb384936.aspx)

这是我的实现（在 VB 中）：

```
Module StringExtensions

    <Extension()>
    Public Function Left(ByVal aString As String, Length As Integer)
        Return aString.Substring(0, Math.Min(aString.Length, Length))
    End Function

End Module 
```

然后将其放在要使用扩展名的任何文件的顶部：

```
Imports MyProjectName.StringExtensions 
```

像这样使用它：

```
MyVar = MyString.Left(30) 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-03-06T14:51:52.000

我喜欢做这样的事情：

```
string s = "hello how are you";
s = s.PadRight(30).Substring(0,30).Trim(); //"hello how are you"
s = s.PadRight(3).Substring(0,3).Trim(); //"hel" 
```

但是，如果您想要尾随或开始空格，那么您就不走运了。

我真的很喜欢使用 Math.Min，它似乎是一个更好的解决方案。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-08-23T19:21:08.323

如果您想避免使用扩展方法并防止出现长度不足的错误，请试试这个

```
string partial_string = text.Substring(0, Math.Min(15, text.Length)) 
// example of 15 character max 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-09-03T07:17:25.120

只是在一个非常特殊的情况下：

如果您在左侧执行此操作，您将使用一些部分字符串检查数据，例如：

`if(Strings.Left(str, 1)=="*") ...;`

然后您还可以使用 C# 实例方法，例如`StartsWith`和`EndsWith`来执行这些任务。

`if(str.StartsWith("*"))...;`

# ruby-on-rails - 我可以从我的 Rails 应用程序发送电子邮件，但不能通过电子邮件网关发送 SMS 文本

> ID：844074
> 
> 赞同：1
> 
> 时间：2009-05-09T21:10:53.240
> 
> 标签：ruby-on-rails, ruby, email, sms

我有需要发送电子邮件和短信的应用程序。它可以很好地发送电子邮件，但是当我尝试使用电子邮件网关（对于 verizon，xxxyyyzzzz@vtext.com）发送短信时，我什么也得不到。我已经使用我的 gmail 帐户通过电子邮件网关给电话发了短信，所以我知道它可以工作。我只是认为从我的应用程序的角度来看，我只是在发送另一封电子邮件。知道为什么这不起作用吗？或者我能做些什么来解决它？

我还应该注意，我是通过本地计算机上的 Rails 应用程序执行此操作的……这并不重要。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T21:13:32.670

也许 Verizon 有软件可以识别从软件而不是人类发送的电子邮件，并拒绝你的？

尝试让您的软件添加普通电子邮件客户端会添加的所有相同标题（例如 X-Mailer）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T21:16:10.810

Verizon 可以将反向 DNS 查询作为简单的垃圾邮件检查。您的 ISP 的信息可能会在此查找过程中显示，而不是您的电子邮件包含的返回地址信息，因此可能会被阻止。

要解决此问题，请确保您使用的返回电子邮件地址来自 ISP 电子邮件帐户。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-09T21:16:43.180

这是在 Linux 上调试它的方法。使用 strace 运行 Rails 应用程序服务器：

```
strace -s99999 -e connect,read,write,close -o strace.log script/server 
```

然后检查`strace.log`并查看 Rails 应用程序连接到哪个 SMTP 服务器，以及它读取和写入的内容。

然后用你最喜欢的邮件客户端做同样的事情（推荐：mutt，因为 Thunderbird 的 strace 很慢）。

尝试从 Rails 发送与您的邮件客户端发送的字节完全相同的字节。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-09T22:45:05.743

我过去使用[SMS_Fu](http://www.designbyblake.com/archives/50)发送短信。它工作得非常好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-28T08:08:56.853

我已经为 Ruby 编写了一个用于发送 SMS 的客户端应用程序，请参阅[http://freebiesms.blogspot.com/2009/07/send-free-sms-from-ruby.html](http://freebiesms.blogspot.com/2009/07/send-free-sms-from-ruby.html)以下载完整的源代码。

问候

担

# xslt - XSLT：Foreach 迭代每个项目，但显示第一个项目的值？

> ID：844093
> 
> 赞同：1
> 
> 时间：2009-05-09T21:20:30.610
> 
> 标签：xslt, foreach

我有一个项目列表，对于每个项目，我都想将其设为 url。

列表：

```
 <root>
   <tags>
     <tag>open source</tag>
     <tag>open</tag>
     <tag>advertisement</tag>
     <tag>ad</tag>
   </tags>
 </root> 
```

XSLT：

```
<xsl:template match="*">
    <div class="tags">
      <xsl:for-each select="/post/tags/tag">
          <a href="#">
            <xsl:value-of select="//tag"/>
          </a>
      </xsl:for-each>
    </div>
</xsl:template> 
```

输出：

```
 <div class="tags"> 
    <a href="#">open source</a> 
    <a href="#">open source</a> 
    <a href="#">open source</a> 
    <a href="#">open source</a> 
  </div> 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-09T21:51:50.990

一种更正确的 XSLT 方法是添加一个“标记”模板并修改您的原始模板：

```
<xsl:template match="*">
    <div class="tags">
        <xsl:apply-templates select="tag" />
    </div>
</xsl:template>

<xsl:template match="tag">
      <a href="#">
        <xsl:value-of select="."/>
      </a>
</xsl:template> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-09T21:26:30.520

您对 value-of 表达式所做的是选择 xml 文档中的所有标记节点：

```
<xsl:value-of select="//tag"/> 
```

这样做的效果是只有第一个选定的节点将用于该值。

您可以改用以下内容：

```
<xsl:value-of select="."/> 
```

在哪里选择 =“。” 将从 for-each 中选择当前节点。

# nhibernate - 使用 NHibernate 查询数据库的规范模式

> ID：844097
> 
> 赞同：3
> 
> 时间：2009-05-09T21:21:29.673
> 
> 标签：nhibernate, specification-pattern

你如何实现使用 NHibernate 查询数据库的规范模式？（没有 LINQ to NHibernate）。我阅读了很多关于规范模式的内容，但其中大部分是关于验证和查询内存集合对象的。

据我所知，在这样的规范接口中使用 DetachedCriteria 的最佳方法。

```
interface ISpecification<T> {

 bool IsSatisfiedBy(T object);

 DetachedCriteria CreateCriteria();

} 
```

有没有替代或更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-10T09:20:48.540

这不是更好，但可以替代

```
interface ISpecification<T> 
{
   bool IsSatisfiedBy(T object);

   Expression<Func<T, bool>> Predicate { get; }
} 
```

易于在 linq（休眠）和内存集合上使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-19T09:39:03.737

我使用简单的扩展方法和规范模式实现了这一点，适用于 System.Linq.IQueryable 列表。

```
public interface IFilter<in T>
{
    bool MatchFilter(T o);
}

public static class FilterExtension
{
    public static IQueryable<T> Filter<T>(this IQueryable<T> query, IFilter<T> filter)
    {
        return query.Where(x => filter.MatchFilter(x));
    }
} 
```

简单的示例类和 IFilter 实现：

```
public class Organization
{
    public string Name { get; set; }
    public string Code { get; set; }
    public Address Address { get; set; }

    public Organization(string name, string code, string city, string country)
    {
        Name = name;
        Code = code;
        Address = new Address(city, country);
    }

}

public class Address
{
    public Address(string city, string country)
    {
        City = city;
        Country = country;
    }

    public string City { get; set; }
    public string Country { get; set; }
}

public class GenericOrganizationFilter : IFilter<Organization>
{
    public string FilterString { get; set; }

    public GenericOrganizationFilter(string filterString)
    {
        FilterString = filterString;
    }

    public bool MatchFilter(Organization o)
    {
        return
            (o.Name != null && o.Name.Contains(FilterString)) ||
            (o.Code != null && o.Code.Contains(FilterString)) ||
            (o.Address != null && o.Address.City != null && o.Address.City.Contains(FilterString)) || 
            (o.Address != null && o.Address.Country != null && o.Address.Country.Contains(FilterString));
    }
} 
```

用法：

```
IFilter<Organization> filter = new GenericOrganizationFilter("search string");
//Assuming queryable is an instance of IQueryable<Organization>. 
IQueryable<Organization> filtered = queryable.Filter(filter); 
```

# coldfusion - 301重定向导致循环错误

> ID：844098
> 
> 赞同：1
> 
> 时间：2009-05-09T21:21:53.307
> 
> 标签：coldfusion, http-status-code-301

我需要重定向我的网站，例如：

*   [http://www.foo.com/index.cfm](http://www.foo.com/index.cfm)

至

*   [http://www.foo.com](http://www.foo.com)

在这个应用程序中，index.cfm 是我的默认页面（在 IIS 中设置）。当我尝试 301 重定向时，我收到重定向循环错误。整个应用程序都在 ColdFusion 中。我正在我的 index.cfm 页面上的 IIS 中更新此设置。请对此提出一些建议。谢谢你的建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-09T21:35:42.493

那么在 IIS 中，您的默认页面设置会查找 index.cfm 吗？我认为您正在获得重定向循环，因为对于服务器[http://www.foo.com/index.cfm与](http://www.foo.com/index.cfm)[http://www.foo.com](http://www.foo.com)相同。

听起来您只想隐藏“index.cfm”而不向用户显示？

在这种情况下，我不认为尝试使用 301 重定向是可行的方法。

您可能想查看[IIS 7 的 URL 重写功能](http://weblogs.asp.net/scottgu/archive/2007/02/26/tip-trick-url-rewriting-with-asp-net.aspx)，并查看方法 #3

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T21:27:42.327

好吧，我不知道coldfusion，但是只要用于访问脚本index.cfm 的URL 上有任何额外的字符（只要请求方法是GET），您就可以调节301 标头输出，这样您就可以避免无限重定向。这里有一些**伪代码**来解释我自己：

```
if URL is not 'http://www.foo.com' and method is 'GET'
    output header '301 http://www.foo.com/' 
```

# wpf - WPF 窗口格式无法按预期工作

> ID：844099
> 
> 赞同：0
> 
> 时间：2009-05-09T21:21:54.400
> 
> 标签：wpf

我有一个 WPF 窗口，我希望窗口顶部的一部分只是其中包含的所有元素的高度。窗口的底部应该是可调高度区域。如果窗口变得更高，那么底部应该是增长的部分而不是顶部。

在窗口的底部，我想要其中包含两个部分。顶部应该是可调节高度部分，底部应该是显示其中包含的所有元素所需的高度。

如果您查看下面的 xaml 代码，您将看到我总共定义了三个网格。外部网格有两个行定义，其中第一行设置为 Auto，这样高度就足以包含其中包含的所有元素。第二行应该是可调整的，以允许它填充窗口的其余大小。

在外部网格的第二行内部是另一个网格，它应该允许第一行的高度灵活，第二行的高度刚好足以容纳其中包含的所有元素。

我遇到的问题是整个窗口都没有填满。底部网格仅位于外部窗口的一部分下方。为什么底部网格没有填充整个窗口？如何更改定义以允许这样做？

```
<Window x:Class="WPFSample.Window1"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
Title="Window1" Height="300" Width="300">
<Grid x:Name="LayoutRoot">
    <Grid.RowDefinitions>
        <RowDefinition Height="Auto" />
        <RowDefinition />
        <RowDefinition Height="*" />
        <RowDefinition />
    </Grid.RowDefinitions>
    <Grid x:Name="TopGrid" VerticalAlignment="Top" Width="Auto" Height="Auto" Grid.Row="0">
        <Button Height="23" HorizontalAlignment="Left" Margin="60,0,0,4" Name="button1" VerticalAlignment="Bottom" Width="75">Button</Button>
    </Grid>
    <Grid x:Name="BottomGrid" Width="Auto" Height="Auto" VerticalAlignment="Bottom" Grid.Row="1">
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition />
            <RowDefinition Height="Auto" />
            <RowDefinition />
        </Grid.RowDefinitions>
        <Button Grid.Row="0" Height="23" Margin="60,0,61,4" Name="button2" VerticalAlignment="Bottom">Button</Button>
        <Button Grid.Row="1" Height="23" Margin="60,0,61,4" Name="button3" VerticalAlignment="Bottom">Button</Button>
    </Grid>
</Grid> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-09T22:33:04.103

我想出了这个。除了我认为的两个之外，我还定义了多个行定义。一旦我删除了额外的，格式就会按预期工作。

# c - 在 WIN32 中的“BUTTON”类窗口上显示位图

> ID：844101
> 
> 赞同：5
> 
> 时间：2009-05-09T21:23:03.727
> 
> 标签：c, winapi, button, bitmap

***编辑：**我认为在创建子窗口（即我的按钮）期间不会发送 WM_CREATE 消息。因此，通过在 WM_CREATE 期间调用 SendMessage，我正在向尚未创建的窗口发送消息。现在的解决方案是在 WM_SHOWWINDOW 消息期间调用 SendMessage()。子窗口是否在创建时发送 WM_CREATE 消息？*

为什么按钮上不显示位图？位图为 180x180 像素。

我有一个资源文件：

```
Bit BITMAP bit.bmp 
```

然后我创建主窗口和一个子“按钮”窗口：

```
HWND b, d;

b = CreateWindow(L"a", NULL, WS_OVERLAPPEDWINDOW, 0, 0, 500, 500, 0, 0, 
                  hInstance, 0);

d = CreateWindow(L"BUTTON", NULL, WS_CHILD | WS_VISIBLE | BS_BITMAP, 
                 10, 10, 180, 180, b, 200, hInstance, 0); 
```

然后，在我的 Windows 程序中，我向“BUTTON”窗口发送“BM_SETIMAGE”消息：

```
HBITMAP hbit; 

case WM_CREATE:    // It works if I change this to: case WM_SHOWWINDOW 

hbit = LoadBitmap(hInstance, L"Bit");

SendMessage(d, BM_SETIMAGE, (WPARAM)IMAGE_BITMAP, (LPARAM)hbit); 
```

LoadBitmap() 返回一个有效的句柄，因为它没有返回 NULL，而且我可以使用 BitBlt() 函数在客户区显示位图。所以我要么没有正确发送消息，要么没有正确创建“按钮”窗口。

我究竟做错了什么？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-09T23:00:50.620

`WM_CREATE`当创建该类的窗口时，将调用窗口类“a”的窗口过程。这是在您*第一次*调用 时`CreateWindow`，即在您创建子`BUTTON`窗口之前。 `WM_CREATE`意思是“你正在被创造”——它并不意味着“一个孩子正在被创造”。

解决方案是调用类“a”`d = CreateWindow(L"BUTTON"...)`的处理程序：`WM_CREATE`

```
case WM_CREATE:
    d = CreateWindow(L"BUTTON", NULL, WS_CHILD | WS_VISIBLE | BS_BITMAP, 
                     10, 10, 180, 180, hwnd, 200, hInstance, 0);
    hbit = LoadBitmap(hInstance, L"Bit");
    SendMessage(d, BM_SETIMAGE, (WPARAM)IMAGE_BITMAP, (LPARAM)hbit); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T22:47:58.390

你如何验证`WM_CREATE`没有被调用？由于`BUTTON`不是您的窗口类（而是由操作系统定义），它拥有`WndProc`窗口，而不是您 - 因此`WM_CREATE`不应为代码中的按钮调用，因为`BUTTON`不是您的类。

如果你想接收按钮的消息，你必须继承它，然后提供你自己的`WndProc`.

# php - 如何使表结构保持最新

> ID：844103
> 
> 赞同：0
> 
> 时间：2009-05-09T21:24:43.270
> 
> 标签：php, mysql, schema

有没有人有一个 scipt 的想法，它可以使用当前数据库表检查表定义的数组/XML，并进行适当的更改/创建查询以同步它们？我目前正在使用 php5 和 mysql 5。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-10T02:12:58.427

我感觉 MySQL Workbench 能够创建 alter/diff SQL 脚本

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-10T12:55:05.480

选择一些数据库迁移框架或编写自己的。并阅读此[https://blog.codinghorror.com/get-your-database-under-version-control/](https://blog.codinghorror.com/get-your-database-under-version-control/)

# c# - Apply 等集合是否有内置的扩展方法？

> ID：844104
> 
> 赞同：2
> 
> 时间：2009-05-09T21:24:53.860
> 
> 标签：c#, .net

我正在寻找一种内置的扩展方法，例如 Apply：

```
collection.Apply (predicate) 
```

这将对集合中包含的所有项目应用一个方法。

我先问一下，这样我就不会写已经存在的东西了。

编辑：我没有使用 foreach 的原因是因为我想使用 LINQ 来表达方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-09T21:28:39.610

嗯，有`List<T>.ForEach`，但什么都没有`IEnumerable<T>`。这是很多第 3 方“额外扩展方法”工具包中的东西：)

我同意其他`foreach`通常是更好的方法的答案 - 尽管它偶尔会有所不同：

```
DoSomething(x => x.Where(...).Select(...).ForEach(...)); 
```

和

```
DoSomething(x => {
    foreach (var y in x.Where(...).Select(...)) {
        (...)
    }
}); 
```

这比单行更重要。

我想我*通常*只会在我已经有一个委托或者可能是一个方法组的情况下使用这种方法。例如，能够有一个单行来转储过滤的集合是非常好的：

```
people.Where(p => p.Age >= 18).ForEach(Console.WriteLine); 
```

不过，在更多地接触函数式编程之后，我可能会更频繁地使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T21:29:24.163

我很确定没有`IEnumerable<T>`,`ICollection<T>`或`IList<T>`.

但是，该类`List<T>`有一个通用[`ForEach`](http://msdn.microsoft.com/en-us/library/bwabdf9z.aspx)方法（内置，而不是扩展），您可以这样使用：

```
list.ForEach(delegate); 
```

就个人而言，我对这些方法没有任何真正的价值。一个简单的 foreach 循环多使用一行代码并提供相同的可用性，但当然没有什么能阻止您自己编写一个。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-09T22:27:22.823

好吧，我不能没有基本的`ForEach(...)`扩展方法，也许是因为我吞下了功能性药丸或其他东西。

```
public static void ForEach<T>(this IEnumerable<T> sequence, Action<T> action)
{
    if (sequence == null) throw new ArgumentNullException("sequence");
    if (action == null) throw new ArgumentNullException("action");

    foreach (T t in sequence)
        action(t);
} 
```

有人可能会说这只是节省了几行代码。但我认为它不仅如此：它保存了一个变量声明，我个人最喜欢的是它与智能感知配合得非常好。

IE

```
people.Where(p => p.Age < 38)
      .Select(p => p.Firstname + " " + p.Surname)
      .ForEach(fullname => Console.WriteLine(fullname)); 
```

由于智能感知的强大功能，编写起来比 foreach 循环更容易、更快捷。

永远不要低估智能感知在 API 设计中的重要性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-09T21:28:22.183

我不确定是否有类似的东西，但你为什么不使用 foreach，因为你正在对所有项目应用该方法。

# python - wxPython：从文件中绘制基于矢量的图像

> ID：844110
> 
> 赞同：3
> 
> 时间：2009-05-09T21:26:37.290
> 
> 标签：python, wxpython, vector-graphics

如何从 wxPython 中的文件中绘制基于矢量的图像？我对这种东西的图像格式一无所知，所以请推荐。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-09T21:43:13.770

您可以使用 cairo 和 librsvg python 绑定来做到这一点。[这里](http://www.daa.com.au/pipermail/pygtk/2007-April/013778.html)有一个小例子。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-19T20:59:49.077

我做过类似的事情，我有一个自定义矢量图像格式，需要在 wxPython 窗口中呈现。为了实现这一点，我使用 GDI 接口来绘制命令，并编写了自己的解析器模块。这个站点上有一个很棒的 GDI 教程可以帮助你：[http ://www.zetcode.com/wxpython/gdi/](http://www.zetcode.com/wxpython/gdi/)

# python - 用 Python 下载网页及其所有资源文件

> ID：844115
> 
> 赞同：9
> 
> 时间：2009-05-09T21:28:26.740
> 
> 标签：python, urllib2, wget

我希望能够使用 Python 下载页面及其所有相关资源（图像、样式表、脚本文件等）。我（有点）熟悉 urllib2 并且知道如何下载单个 url，但在我开始在 BeautifulSoup + urllib2 上进行黑客攻击之前，我想确保没有与“wget --page-requisites [http ”等效的 Python ://www.google.com](http://www.google.com) ”。

具体来说，我有兴趣收集有关下载整个网页（包括所有资源）所需时间的统计信息。

谢谢马克

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-09T21:31:08.277

吸毒者？见[http://effbot.org/zone/websucker.htm](http://effbot.org/zone/websucker.htm)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-05-14T21:22:34.010

websucker.py 不导入 CSS 链接。HTTrack.com 不是 python，它是 C/C++，但它是一个很好的、维护的、用于下载网站以供离线浏览的实用程序。

[http://www.mail-archive.com/python-bugs-list@python.org/msg13523.html](http://www.mail-archive.com/python-bugs-list@python.org/msg13523.html) [issue1124] Webchecker 不解析 css “@import url”

Guido> 这基本上是不受支持和无人维护的示例代码。随意提交补丁！

# asp.net-mvc - 为什么我的 ASP.NET MVC 应用程序请求 Windows 身份验证？

> ID：844117
> 
> 赞同：1
> 
> 时间：2009-05-09T21:28:40.153
> 
> 标签：asp.net-mvc, windows-authentication

我一直在构建一个 ASP.NET MVC 应用程序并使用表单身份验证。在我的控制器动作中，我有：

[授权（用户=“我，乔”）]

这一直很好。昨晚当我发布最新的更改并尝试查看我的网站时，它开始弹出一个 Windows 身份验证对话框。我查看了所有代码，无法弄清楚为什么它会更改为 Windows 身份验证。我的 web.config 文件至少 10 天没有更改。如果我从我的开发箱运行代码，它不会这样做......只有当它从我的主机运行时。如果我从我的控制器操作中删除授权行，它就不会发生。

我该如何解决这个问题或如何调试我的解决方案以查看为什么会发生这种情况？

顺便说一句，我的 web.config 说：

```
<authentication mode="Forms">
  <forms loginUrl="~/Account/LogOn" timeout="2880" />
</authentication> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-09T21:32:51.987

这很可能对 IIS 设置进行，以对 Web 服务器上的网站文件夹进行身份验证和权限。我会先检查这两个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T22:26:57.783

我只是在黑暗中拍摄，但是`<identity>`您的 web.config 中有设置吗？

```
 <system.web>
    ...   
    <identity impersonate="true"/>
    ...
 </system.web> 
```

如果是这样，删除这条线可能会有所帮助。询问您的托管服务提供商为什么突然将 Windows 身份验证应用于您的网站也可能会有所帮助。正如其他人所提到的，有可能导致这种行为的 IIS 设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T21:33:46.600

我认为您需要为 IUSER、IWAM 设置权限

使用 Windows 资源管理器浏览到您要授予权限的文件夹。右键单击该文件夹并选择“属性”。在出现的对话框中，单击顶部附近的“安全”选项卡。然后，您可以为这些帐户（IUSR_machineName、IWAM_macnineName 和 ASPNET）添加或编辑安全性。

# database - 游戏如何处理保存的内容？

> ID：844133
> 
> 赞同：14
> 
> 时间：2009-05-09T21:36:53.520
> 
> 标签：database, xna

我在 SO 上没有看到这个问题的答案，这让我担心它非常简单，我只是错过了一些东西，但这里有。

背景，随意跳过：我需要一门我多年前跳过的学士学位课程。理论上它是计算机图形学，但自从我离开后，它变得更像是游戏开发。这很棒，因为对我来说，它比填充算法和翻译以及过去的其他东西更有趣。这是每隔一年才开设的第 4 年课程，但我设法说服该部门让我对同一主题进行第 4 年的独立研究，并称这已经足够好了。

“运行”独立研究的教授不教授实际的计算机图形学课程，所以虽然他是一个聪明人，但这并不是他真正的领域。所以我的大部分问题都留给了我，一本教科书和互联网。你知道......就像一个独立的研究应该是。:)

/背景

我有一个喜欢开发游戏系统的朋友。我计划将他的一款桌面游戏制作成使用 XNA 的电脑游戏。

我没有预见到游戏机制有任何无法克服的挑战，但我很好奇的一件事是大多数游戏如何保存它们的内容？我的意思是通过几种方式，希望我能清楚地表达出来。

以您玩过的任何 RPG 为例。您可以点击“保存”按钮并保存世界、您的角色信息以及任何其他必要的信息。然后稍后您可以点击“加载”按钮并将其恢复。

还是NPC对话的情况。当我碰到 Merchant #853 时，他随机吐出 3 种不同的问候语之一。

还有其他我能想到的，但它们实际上只是同一主题的变体。即使有这两个例子，在我看来也可以使用相同的机制，但那个机制是什么？

我从事 Web 开发已有多年，所以我的思绪会自动跳到“数据库！”。数据库是任何问题的解决方案。我可以看到它在这里是如何工作的，但开销似乎相当陡峭。“这是我的 6mb 编译游戏……哦，还有 68mb 的 MySQL 安装。” 或者更糟糕的是，因为我使用的是 XNA，也许我需要找到一种方法来捆绑 SQL Server。:)

我想也许是 XML，但这对我来说也不合适。如果我想在 Xbox 上运行，它将如何工作？还是祖尼？（这些对于我正在做的事情不是必需的，但必须有一个解决方案将它们考虑在内。）

有谁知道其中的秘密？还是有一些想法？

谢谢杰夫

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-11T01:22:41.843

保存游戏的方式主要有两种，一种是简单的，一种是复杂的。第一种方法是简单地存储当前级别、当前分数和一些其他统计数据。这在诸如超级马里奥银河之类的游戏和大多数早期基于控制台模块的游戏中都可以看到。保存游戏不会恢复您的确切位置，而只会恢复您已完成的关卡。这些存档游戏通常非常简单，并且只需要很少的内存。

第二种方式不仅存储了你的整体进度，还存储了每一个小细节，比如敌人的位置、他们当前的动画帧等等，这样加载一个保存游戏就会把你放在你停下来的确切位置，所有敌人就在原地，而不是回到关卡的开始。这些存档游戏往往比其他版本大得多，因此主要出现在 PC 游戏中。

这两种方案都没有使用数据库，因为数据库的目的是提供动态查询数据结构的能力，但游戏需要的不是查询单个片段的方法，而只是一种静态存储它们的方法。加载存档游戏时，它会完全加载到内存中，然后游戏引擎会从那里处理数据。有少数例外，例如 MMORPG 可以在数据库上运行，但单人游戏通常不能。

数据的实际存储方式取决于游戏。最常见的似乎是简单的二进制数据格式，因为它们在磁盘空间方面比 XML 要好得多。在较旧的游戏中，那些二进制格式通常会原始转储游戏进程的一段内存，因此它们没有任何经过深思熟虑的结构，并且在发布补丁或不同版本的游戏时经常会崩溃，在一些现代游戏中游戏仍然如此。也可以使用 XML 以及任何其他基于文本的文件格式。

在很大程度上，这更像是一个游戏设计问题，而不是一个编程问题，因为他们保存游戏的方式可以极大地改变游戏的玩法。简单的方法，您只需保存关卡编号和一些统计信息，但实现起来要容易得多，因为它只需几行代码。而第二个需要序列化你的大部分类，这对于复杂的游戏可能是一个相当棘手的问题，并导致许多微妙的错误。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-09T21:42:45.830

一种方法是使用 .net 序列化。

确保您的游戏状态是一个完全连接的图，并且该图中的每个类都标记为可序列化（使用 SerializableAttribute），保存（和加载）您可以使用正常的 .net 序列化。

您可以查看[Project Xenocide](http://www.projectxenocide.com/)（开源 XNA 游戏）的代码库，了解它是如何完成的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-09T21:52:21.970

您可以使用带有[SQLite.NET 包装器的](http://sqlite.phxsoftware.com/)[SQLite](http://www.sqlite.org/)数据库。我用过这个，发现它很简单。整个 DLL 只有 850KB，数据库本身位于一个文件中（根据需要创建临时文件）。所以你的用户不应该有问题。

但您也可以使用简单的 XML 文件，或自制的二进制格式。这完全取决于您将如何查询数据，以及涉及多少数据。没有一个答案。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-09T22:52:11.733

正如其他人所指出的，序列化是要走的路。而 Gamasutra 刚刚发表了一篇关于[数据烘焙](http://www.gamasutra.com/view/feature/3984/delicious_data_baking.php)的文章。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-09T22:33:44.787

从我有限的游戏开发经验来看，保存游戏**真的不会占用太多存储空间**。正如 tvanfosson 所说，您通常在玩游戏时将大部分内容存储在内存中，因此将状态保存到磁盘不是问题。

这是一个简短的例子。假设是单人角色扮演游戏，如果您只需要保存角色的位置，您可能需要一个级别编号、xyz 坐标以及您所面对的方向。那只是几个字节。

现在假设您需要保存诸如健康包、板条箱、敌人、角色的健康和拾取的物品等的状态/位置。您最多可以有几百个这样的东西，很容易小于 10KB。

显然，对于更复杂的游戏，事情会变得非常复杂。诀窍是只存储重新创建玩家体验真正需要的内容。很多游戏只让你在某些地方保存，比如关卡结束。在这种情况下，您只需要存储新的关卡编号加上之前关卡的结果（例如剩余生命值、拾取物品）。

即使您允许任意保存点，您也可以忽略您无法返回的任何地点/关卡的状态。而且您可能不希望用户能够保存中跳。

编辑：关于文件格式......使用任何方便数据类型的方式！XML 是一种很好的做事方式。不确定数据库的有效性，因为对于 RPG 来说，每个数据片段都可能非常不同；您最终可能会得到一堆表，每个表都有一行。

大多数游戏使用自己的二进制文件格式。首先，这大大减少了存储量。其次，它可以通过手动编辑保存游戏来帮助防止用户作弊 - 如果您有 XML 之类`<health value="10"/>`的文件，则可以很容易地编辑文件以读取`<health value="100"/>`。二进制的缺点是调试起来要困难得多。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-09T21:45:33.063

在游戏运行时，我会尝试将与当前上下文相关的所有内容保存在内存中。您的初始化可以以某种合适的序列化格式保存并在启动时读取。XML 可以工作，但它有点冗长。自定义的紧凑二进制格式可能更合适。保存状态也是如此。加载保存的游戏时需要重新初始化的任何对象都应序列化为自定义二进制格式，然后在加载时重新构建。如果遇到内存问题，为速度优化的小型自定义数据库将是另一种选择。它可以在安装时预先填充。

# mysql - 如何使用 Perl 将 MySQL 表的内容转储到文件中？

> ID：844141
> 
> 赞同：2
> 
> 时间：2009-05-09T21:45:59.160
> 
> 标签：mysql, perl

将 MySQL 表转储到 Perl 中的文件的最佳方法是什么？

我一直在使用：

```
open( FILE, ">$filename" );
my $sth=$dbh->prepare("select * from table");
$sth->execute();
while ( my $row = $sth->fetchrow_arrayref ) {
    print FILE join( "|", @$row ), "\n";
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-09T21:51:30.270

你能掏出[mysqldump](http://dev.mysql.com/doc/refman/5.1/en/mysqldump.html)吗？这就是它的存在...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-09T22:36:41.333

这取决于你真正想要什么。您想保留模式信息和数据库元数据吗？列名呢？另一方面，只要架构和列顺序不变，您当前的方法应该可以很好地用于*数据存储，购买时您应该考虑一些带有“|”的记录的情况* 字符并适当地转义该值，并在您读取和解析文件时应用相应的逻辑。您可能希望查看[Text::CSV](http://search.cpan.org/~makamaka/Text-CSV-1.11/lib/Text/CSV.pm)以获得快速、可靠且灵活的实现，该实现在两个方向上为您完成大部分工作，既写入读取文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-09T22:59:40.747

如前所述，这取决于您想做什么。如果目的是备份数据，您应该考虑复制数据/索引文件的[mysqlhotcopy](http://dev.mysql.com/doc/refman/4.1/en/mysqlhotcopy.html)（如果您使用的是 MyIsam 表）。它比手动转储数据要快得多（例如，我在大约 3 分钟内获得了 2.5 GB 的备份）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-10T03:13:47.267

取决于您需要转储它的原因以及大小和内容。假设您想要的不是备份，显然除了 perl 之外应该有不同的应用程序。我会选择这样的东西，它可以保留您的列，并在某些方面使数据更容易流入其他程序或移交给 CSV。

```
use XML::Simple;
...
my @rows=();
while ( my $h = $sth->fetchrow_hashref() )
{
   $h->{_ROWNUM}=$#rows;
   push(@rows, $h);
}
print XMLout(\@rows); 
```

# python - 在哪里放置适用于模型的方法

> ID：844142
> 
> 赞同：1
> 
> 时间：2009-05-09T21:47:00.533
> 
> 标签：python, django

我正在与 Django 合作。

我有一个名为 Agrument 的模型。争论有双方和所有者。我有一个函数可以返回某个用户的最新参数的一侧。

像 obj.get_current_side(username)

我已经像这样将它添加到实际的 Argument 模型中

```
 def get_current_side(self, user):
        return self.argument_set.latest('pub_date').side 
```

我开始认为这没有意义，因为可能没有 Argument 的实例。这是我会使用类方法的地方吗？我考虑过创建一个 util 类，但我认为与 Argument 类相关联是有意义的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-09T22:08:19.310

在模型上使用实例方法会更有意义`User`：

```
def get_current_side(self):
    try:
        return self.arguments.latest('pub_date').side
    except User.DoesNotExist, e:
        return None 
```

您可以通过扩展`User`模型来做到这一点，如下所述：

*   [使用继承扩展 Django 用户模型](http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/)

*编辑：我不确定抛出了哪个异常。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-10T09:22:00.393

这应该是自定义模型管理器上的一个方法：

```
# in models.py
class ArgumentManager(models.manager.Manager):
    def get_current_side(self, user):
        try:
            return self.filter(user=user).latest('pub_date').side
        except Argument.DoesNotExist:
            return None

class Argument(models.Model):
    # fields etc...

    objects = ArgumentManager()

# Calling:

side = Argument.objects.get_current_side(user) 
```

或者，您**可以**扩展`contrib.auth.user`和添加`get_current_size()`它。但在我对 Django 非常有信心之前，我不会搞砸它。

BTW：这个页面中的大部分代码都是错误的；例如，`user`变量在 OP 的片段上根本没有使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T22:03:16.420

我认为您正在寻找的是模型管理器。

[带有管理器的管理器上的 Django 文档，](http://docs.djangoproject.com/en/dev/topics/db/managers/#topics-db-managers)您可以将函数添加到模型类而不是模型实例。

# java - 为什么JVM启动慢？

> ID：844143
> 
> 赞同：63
> 
> 时间：2009-05-09T21:47:01.437
> 
> 标签：java, jvm, performance, startup

与 CPython 等其他运行时相比，究竟是什么让 JVM（尤其是 Sun 的实现）运行缓慢？我的印象是，这主要与大量库是否需要加载有关，但这似乎不需要 10 年的时间来解决。

想一想，JVM 启动时间与 Windows 上的 CLR 相比如何？Mono 的 CLR 怎么样？

更新：我特别关注 Unix 中常见的链接在一起的小型实用程序的用例。Java 现在适合这种风格吗？无论 Java 产生什么启动开销，它是为每个 Java 进程加起来的，还是仅在第一个进程中才真正体现出来？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-09T22:07:38.377

以下是[维基百科对这个问题的看法](http://en.wikipedia.org/wiki/Java_performance#Startup_time)（附有一些参考资料）。

似乎大部分时间只是从磁盘加载数据（类）（即启动时间受 I/O 限制）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-04T07:53:16.800

只是要注意一些解决方案：

有两种机制可以更快地启动 JVM。第一个是类数据共享机制，从 Java 6 Update 21 开始支持（仅适用于 HotSpot Client VM，据我所知仅适用于串行垃圾收集器）

要激活它，您需要设置**-Xshare**（在某些实现上：**-Xshareclasses**）JVM 选项。

要阅读有关您可能访问的功能的更多信息： [课堂数据共享](http://publib.boulder.ibm.com/infocenter/java7sdk/v7r0/topic/com.ibm.java.aix.70.doc/diag/understanding/shared_classes.html)

第二种机制是 Java Quick Starter。它允许在操作系统启动期间预加载类，请参阅： [Java 快速入门](http://www.java.com/en/download/help/quickstarter.xml)了解更多详细信息。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-09T22:22:12.773

在我的机器上使用 1.6 (Java 6) 客户端 JVM 运行一个简单的 Java 应用程序似乎是即时的。Sun 已尝试调整客户端 JVM 以加快启动速度（客户端 JVM 是默认设置），因此如果您不需要大量额外的 jar 文件，那么启动应该很快。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-09T23:12:12.840

如果您使用 Sun 的 HotSpot for x86_64（64 位编译），请注意当前实现仅在服务器模式下工作，也就是说，它预编译加载的每个类并进行完全优化，而 32 位版本还支持客户端模式，这通常会推迟优化并仅优化 CPU 密集程度最高的部分，但启动时间更快。

参见例如：

*   [http://en.wikipedia.org/wiki/64-bit#32_vs_64_bit](http://en.wikipedia.org/wiki/64-bit#32_vs_64_bit)
*   [http://java.sun.com/docs/hotspot/HotSpotFAQ.html#64bit_compilers](http://java.sun.com/docs/hotspot/HotSpotFAQ.html#64bit_compilers)

话虽如此，至少在我的机器上（Linux x86_64 和 64 位内核），32 位 HotSpot 版本支持客户端和服务器模式（通过 -client 和 -server 标志），但默认为服务器模式，而 64 位版本仅支持服务器模式。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-10T07:30:40.193

这实际上取决于您在启动期间正在做什么。如果你在我的机器上运行 Hello World 应用程序需要 0.15 秒。

但是，Java 更适合作为客户端或服务器/服务运行，这意味着启动时间不如连接时间（约 0.025 毫秒）或往返时间响应时间（<< 0.001 毫秒）重要。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-09T22:07:21.870

有几个原因：

*   有很多`jar`要加载的
*   验证（确保代码不会做坏事）
*   JIT（即时编译）开销

我不确定 CLR，但我认为它通常更快，因为它会为下次缓存本机版本的程序集（因此它不需要 JIT）。CPython 启动速度更快，因为它是一个解释器，而 IIRC 不执行 JIT。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-10T01:58:39.990

除了已经提到的事情（加载类，特别是从压缩的 JAR 中）；在 HotSpot 编译常用字节码之前以解释模式运行；和 HotSpot 编译开销，JDK 类本身也完成了相当多的一次性初始化。许多优化都是为了支持运行时间较长的系统，而这些系统的启动速度不是那么重要。

至于 unix 风格的流水线：您当然不想多次启动和重新启动 JVM。这不会是有效的。工具链应该发生在 JVM 中。这不能轻易地与非 Java Unix 工具混合，除非从 JVM 中启动这些工具。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-10T07:39:43.180

与在 C 或 C++ 中发现的不太丰富的系统相比，所有具有丰富类型系统（如 Java 或 CLR）的 VM 都不会是即时的。这主要是因为在 VM 中发生了很多事情，很多类被初始化并且是正在运行的系统所需要的。初始化系统的快照确实有帮助，但将图像加载回内存等仍然需要花费。

一个简单的 hello world 风格的一个带有 main 的班轮类仍然需要加载和初始化很多东西。验证类需要大量的依赖关系检查和验证，所有这些都需要时间和执行许多 CPU 指令。另一方面，C 程序不会执行任何这些操作，而是会执行一些指令，然后调用打印机函数。

# .net - 有没有办法用 NUnit 声明超时时间？

> ID：844145
> 
> 赞同：0
> 
> 时间：2009-05-09T21:49:25.080
> 
> 标签：.net, api, nunit

如果执行代码挂起，我希望能够使测试失败。目前有没有办法做到这一点？

我在想必须存在以下内容，但我似乎无法在 API 中找到它

```
[Test, Timeout(TimeSpan.FromSeconds(2))]
public void Test() { ...} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-09T22:07:50.683

你在使用[NUnit 2.5](http://nunit.com/index.php?p=download)吗？在 NUnit 2.5 中添加了一个[TimeoutAttribute](http://nunit.com/index.php?p=timeout&r=2.5)，它完全符合您的要求，尽管您以毫秒为单位指定超时。请参阅[发行说明](http://nunit.com/index.php?p=releaseNotes&r=2.5)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T21:52:05.077

AFAIK NUnit 中没有内置任何东西可以做到这一点，但它应该很容易使用 DateTime （或性能计数器，如果你想要更高分辨率的计时器）......

# oracleportal - 在 Oracle Portal 10.1.4 的自定义搜索 Portlet 中提供编辑按钮

> ID：844146
> 
> 赞同：0
> 
> 时间：2009-05-09T21:49:53.910
> 
> 标签：oracleportal

我正在使用 Oracle Portal 10.1.4，并且我有一个自定义搜索 portlet，它有效地执行了一个预设搜索，列出了与某个类别匹配的内容。我希望管理员能够单击显示在预设自定义搜索 portlet 的结果列表中的一段内容旁边的编辑按钮。（因此，从预设搜索返回的每条内容旁边都有一个管理员可以单击的编辑链接）。

有没有办法做到这一点而不必编写我自己的 PL/SQL portlet（以替换自定义搜索 portlet）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-11-27T16:20:37.443

据我所知，操作标准自定义搜索 portlet 的输出是不可能的，用 PL/SQL 或 Java 编写自己的搜索 portlet 将是可行的方法。我能想到的唯一其他方法是截取 portlet 的输出并以某种方式对其进行扩充，或者使用 javascript 来操作 DOM 以添加所需的编辑链接。

理查德。

# c# - 隐式（默认）值与显式值

> ID：844158
> 
> 赞同：5
> 
> 时间：2009-05-09T21:55:59.433
> 
> 标签：c#, .net

依赖隐式默认值是一种不好的做法，例如：

```
class Node
{
    int red;
    int green;
    int blue;

    bool grayscale;

    Node next;
} 
```

而不是显式设置它们：

```
class Node
{
    int red = 0;
    int green = 0;
    int blue = 0;

    bool grayscale = false;

    Node next = null;
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-09T22:00:41.293

不，我认为依赖默认值是可以的。显式分配它们只会使代码混乱。此外，它的优点是更容易区分您分配非默认值的字段。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-09T22:02:19.717

我总是会把它们放进去，因为它证明你已经考虑过这些成员的初始值应该是什么。

```
bool isCool; 
```

可能意味着“我知道这在启动时并不酷”，也可能只是意味着您没有考虑过。

```
bool isCool = false; 
```

显然是一个深思熟虑的决定。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-09T22:00:08.567

我不认为这是一个不好的做法，因为默认值是使用该语言工作的开发人员应该知道/被迫学习的东西。

想到的唯一缺点是不列出默认值可能会导致人们永远不会查看初始化值。在将其初始化为默认值以外的其他值的情况下，可能需要注意一下。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-10T00:19:20.103

这主要是主观的，恕我直言。

对我来说，即使它是明确声明的默认值，它也太“罗嗦”了……在阅读代码时它仍然让我慢了一点，让我们面对现实吧……它是多余的。

我还认为它出现在代码中的频率比它应该的要高，因为人们不知道默认值或者有一些不合理的担心，他们可能会在 C# 5.0 中将 bool 的默认值更改为 true。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-09T23:51:23.323

看看这些问题：

[我应该总是/永远/从不将对象字段初始化为默认值吗](https://stackoverflow.com/questions/636102/should-i-always-ever-never-initialize-object-fields-to-default-values)

[为什么 FXCop 认为初始化为默认值是不好的？](https://stackoverflow.com/questions/730967/why-does-fxcop-thinks-initializing-to-the-default-is-bad)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-06-15T18:50:52.233

开发人员有责任了解原始数据类型的默认值是什么，因此它们不是绝对必要的。但是，正如一些人所指出的那样，它确实证明您已经考虑过这个问题。

此外，代码中绝大多数的变量类型将是您创建的自定义类型。开发人员不负责知道您的自定义枚举的默认值是什么。良好的沟通要求您在这些情况下指定默认值。由于我们是习惯性动物，因此最好养成始终初始化变量的习惯。只要您的方法保持一致，您是在类级别还是在构造函数中执行此操作都没有区别。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-16T12:51:48.887

作为之前所有答案的替代方案，我习惯将这些初始值放在构造函数中，所以我不会费心在它应该是之外寻找变量的初始化。

```
class Node
{
        int red;
        int green;
        int blue;

        bool grayscale;

        Node next;
        public Node() {
            red = 0;
            green = 0;
            blue = 0;

            grayscale = false;
            next = null;
        }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-16T12:50:04.210

我更喜欢明确给出值。尝试从内存中加载默认值对大脑的压力较小。最好预先缓存它们。没有造成伤害。

喜欢

```
string name = string.Empty; 
```

或者

```
Guid userID = Guid.Empty; 
```

# objective-c - 如何通过关系进行 Core Data 查询？

> ID：844162
> 
> 赞同：8
> 
> 时间：2009-05-09T21:59:15.697
> 
> 标签：objective-c, cocoa, macos, core-data

我在搞乱核心数据，我确信我遗漏了一些明显的东西，因为我找不到一个与我正在尝试做的事情完全相似的例子。

假设我正在玩 DVD 数据库。我有两个实体。一部电影（标题、年份、评级以及与演员的关系）和演员（姓名、性别、照片）。

获取所有电影很容易。只是：

```
NSEntityDescription *entity = [NSEntityDescription entityForName:@"Winery"
inManagedObjectContext:self.managedObjectContext]; 
```

获取标题中带有“Kill”的所有电影很容易，我只需添加一个 NSPredicate：

```
NSPredicate *predicate = [NSPredicate predicateWithFormat:
@"name LIKE[c] "*\"Kill\"*""]; 
```

但是 Core Data 似乎抽象出了托管对象的 id 字段......那么我如何查询作为对象的属性（或：查询关系）？

换句话说，假设我已经有我关心的 Actor 对象（例如 [Object id 1 - 'Chuck Norris']），“给我所有由 [Object id 1 - 'Chuck'] 主演的电影的谓词格式是什么诺里斯的]”？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-09T23:10:43.107

假设 Actor 和 Movie 实体之间存在一对多的反向关系，您可以像获取任何特定实体一样为 Chuck Norris 获取实体，然后访问附加到的 Movie 实体数组Actor 实体上的关系。

```
// Obviously you should do proper error checking here... but for this example
// we'll assume that everything actually exists in the database and returns
// exactly what we expect.
NSEntityDescription *entity = [NSEntityDescription entityForName:@"Actor" inManagedObjectContext:self.managedObjectContext];
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"name LIKE[c] 'Chuck Norris'"];
NSFetchRequest *request = [[NSFetchRequest alloc] init];
[request setEntity:entity];
[request setPredicate:predicate];

// You need to have imported the interface for your actor entity somewhere
// before here...
NSError *error = nil;
YourActorObject *chuck = (YourActorObject*) [[self.managedObjectContext executeFetchRequest:request error:&error] objectAtIndex:0];

// Now just get the set as defined on your actor entity...
NSSet *moviesWithChuck = chuck.movies; 
```

需要注意的是，这个示例显然假设 10.5 使用属性，但是您可以在 10.4 中使用访问器方法做同样的事情。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-01-13T09:11:03.600

或者您可以使用另一个谓词：

```
NSEntityDescription *entity = [NSEntityDescription entityForName:@"Actor" inManagedObjectContext:self.managedObjectContext];

NSPredicate *predicate = [NSPredicate predicateWithFormat:@"name = %@",@"Chuck Norris"]
NSFetchRequest *request = [[NSFetchRequest alloc] init];
[request setEntity:entity];
[request setPredicate:predicate];

YourActorObject *chuck = [[self.managedObjectContext executeFetchRequest:request error:nil] objectAtIndex:0];
[request release];

NSSet *moviesWithChuck = chuck.movies; 
```

# linq-to-sql - LINQ to SQL，当我们有多个表时，如何编写一个检查行是否存在的方法

> ID：844163
> 
> 赞同：0
> 
> 时间：2009-05-09T21:59:25.090
> 
> 标签：linq-to-sql

我正在尝试在 C# 中编写一个方法，该方法可以将表类型、列和列值作为参数，并检查是否获得了带有值的行

该方法如下所示：

```
public object GetRecordFromDatabase(Type tabletype, string columnname, string columnvalue) 
```

我正在使用 LINQ to SQL 并且需要以通用方式进行此操作，因此我不需要编写数据库中的每个表。

到目前为止，我一直在为每张桌子这样做，但是其中有 70 多张桌子，这样做变得既麻烦又无聊。

有没有办法动态生成以下代码，并将硬编码的表名替换为参数列表中的值？在此示例中，我在数据库中有一个名为 tbl_nation 的表，DataContext 将它复数为 tbl_nations，我正在检查该列 `for the value`

```
if (DB.tbl_nations.Count(c => c.code.Equals(columnvalue)) == 1)
            {
                return DB.tbl_nations.Single(c => c.code.Equals(columnvalue));
            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-11T04:58:42.787

看看 System.Linq.Dynamic：

[http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx](http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx)

# .net - AccessViolationException 调用我能从托管代码中想到的最基本的 c++ 函数

> ID：844169
> 
> 赞同：0
> 
> 时间：2009-05-09T22:04:47.900
> 
> 标签：.net, c++, interop, unmanaged

我正在尝试学习如何使用托管/非托管代码互操作，但我遇到了 4 小时谷歌搜索无法克服的问题。我在 Visual Studio 中放置了 2 个项目，一个创建了一个 win32 exe，一个创建了一个 windows forms .NET 应用程序。经过一堆乱七八糟的处理后，我得到了正确调用 c++ 代码的 C# 代码，但是从这里我开始每次进入那里时都会收到 AccessViolationException。以下是 .cpp 文件中的代码：

```
 extern "C" __declspec(dllexport) void QuickTest()
    {
        int iTest = 0;
        int aTestArray[3] = {1,2,3};
        return;
    } 
```

这是来自 C# windows 窗体应用程序的代码调用它：

```
 [DllImport("UnmanagedEvaluation2.exe")]
        static extern void QuickTest(); 
```

很简单吧？该调用有效，并且我能够进入 c++ 代码（我为该项目打开了非托管调试），但它每次都因 AccessViolationException 而死在数组创建行上。当我运行可执行文件时，相同的代码运行良好（c++ 代码在控制台应用程序项目中，我尝试从 _tmain 函数调用它，没有问题），但是当从 .NET 调用它时，它每次都会爆炸。

必须有一些明显的东西我在这里遗漏了，但是我没有从阅读教程中找到任何有用的东西，而且关于该异常的大多数问题都是人们遇到复杂的编组或 GCHandles 的问题。提前感谢您的帮助。

更新：你就在下面，但这很奇怪。起初，当我开始这个时，我认为我无法做到这一点（调用可执行文件中的函数），但是当我尝试它时——它确实有效，调用就是这样。似乎它允许您将函数调用到可执行文件中，但是一旦您尝试分配任何内存，它就会死掉。无论如何，感谢您的建议，它现在似乎工作正常。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-09T22:06:34.463

您不能从这些可执行文件外部调用可执行文件中的函数。您需要将代码编译成 DLL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T22:59:17.540

您已将函数声明为`extern "C"`这意味着它`cdecl`用作其调用约定。默认情况下，`DllImport`用作`StdCall`调用约定。这可能是您的代码崩溃的原因。

尝试将您的函数导入 .NET 代码

```
 [DllImport("UnmanagedEvaluation2.exe", CallingConvention=CallingConvention.Cdecl)]
    static extern void QuickTest(); 
```

有关详细信息，请参阅[http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.callingconvention.aspx](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.callingconvention.aspx)。

# apache-flex - 在 SWFLoader (Flex 3) 中滚动内容

> ID：844177
> 
> 赞同：0
> 
> 时间：2009-05-09T22:08:27.720
> 
> 标签：apache-flex, flex3, swfloader

我必须在 SWFLoader 中加载巨大的 (3000x3000) 图片，这没有问题——一切正常。但在低分辨率显示器（如 1024x768）上，我只能看到图片的一部分。所以我需要某种滚动条来滚动图片。

我怎样才能做到这一点？请帮忙，因为我根本不知道。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-10T12:56:02.270

SWFLoader 扩展了不支持滚动的 UIComponent。

您可以通过将 SWFLoader 嵌套在任何基于 Container 的组件中来启用滚动，例如 Canvas（它的 Horizo​​ntalScrollPolicy 和 verticalScrollPolicy 默认设置为“auto”）

# python - 正则表达式实现细节

> ID：844183
> 
> 赞同：17
> 
> 时间：2009-05-09T22:12:50.860
> 
> 标签：python, regex

我回答的一个[问题](https://stackoverflow.com/questions/842856/whats-the-most-efficient-way-to-find-one-of-several-substrings-in-python)让我想知道：

Python中的正则表达式是如何实现的？有什么样的效率保证？实施是“标准”，还是会发生变化？

我认为正则表达式将被实现为 DFA，因此非常有效（最多需要对输入字符串进行一次扫描）。[Laurence Gonsalves](https://stackoverflow.com/users/90848/laurence-gonsalves)提出了一个有趣的观点，即并非所有 Python 正则表达式都是正则的。（他的例子是 r"(a+)b\1"，它匹配某个数量的 a's、ab，然后是与之前相同数量的 a's）。这显然不能用 DFA 来实现。

所以，重申一下：Python 正则表达式的实现细节和保证是什么？

如果有人可以给出某种解释（根据实现）关于为什么正则表达式“cat|catdog”和“catdog|cat”会导致字符串“catdog”中的不同搜索结果，那也很好，因为在我之前提到的[问题中提到](https://stackoverflow.com/questions/842856/whats-the-most-efficient-way-to-find-one-of-several-substrings-in-python)。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-09T23:03:17.870

Python 的 re 模块基于[PCRE](http://en.wikipedia.org/wiki/PCRE)，但已经转向他们自己的实现。

这是[C 代码](http://hg.python.org/cpython/file/a82fc1f366b4/Modules/_sre.c)的链接。

当采用不正确的路径时，该库似乎基于递归回溯。

![替代文字](https://pdos.csail.mit.edu/~rsc/regexp-img/grep1p.png)

正则表达式和文本大小 n
a? ^n a ^n匹配^n

请记住，此图不代表正常的正则表达式搜索。

[http://swtch.com/~rsc/regexp/regexp1.html](http://swtch.com/~rsc/regexp/regexp1.html)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-10T21:01:56.777

Python RE 与该语言的任何其他部分相比，没有“效率保证”（C++ 的标准库是我所知道的唯一一个试图建立此类标准的广泛语言标准——但即使在 C++ 中也没有标准，指定，比如说，将两个整数相乘必须花费恒定的时间，或者类似的东西）；也不能保证任何时候都不会应用大优化。

今天，F. Lundh（最初负责实现 Python 当前的 RE 模块等）在 Pycon Italia 展示 Unladen Swallow，提到他们将探索的途径之一是将正则表达式直接编译为 LLVM 中间代码（而不是他们的自己的字节码风格由临时运行时解释）——因为普通的 Python 代码也被编译为 LLVM（在即将发布的 Unladen Swallow 版本中），然后可以一起优化 RE 及其周围的 Python 代码，有时甚至以非常激进的方式。不过，我怀疑这样的事情很快就会接近“生产就绪”；-)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-10-28T04:24:21.713

[使用反向引用匹配正则表达式是 NP-hard](http://perl.plover.com/NPC/)，它至少与[NP-Complete](http://en.wikipedia.org/wiki/NP-complete)一样难。这基本上意味着它与您可能遇到的任何问题一样困难，并且大多数计算机科学家认为在最坏的情况下它可能需要指数级的时间。如果你能在多项式时间内匹配这样的“正则”表达式（在技术上实际上不是），你可以赢得[一百万美元](http://www.claymath.org/millennium/P_vs_NP/)。

# javascript - 在事件处理程序之外检索鼠标位置

> ID：844187
> 
> 赞同：0
> 
> 时间：2009-05-09T22:15:37.390
> 
> 标签：javascript, dom, mouse

如何在分配的事件处理函数之外检索鼠标位置

例如，如果`Event.MOUSEMOVE = somefuction`，我怎么说...

```
someOtherFunction( maybeSomeParams )
{
    getCurrentMouseLocn();
} 
```

或者

```
someOtherFunction( maybeSomeParams )
{
    mouseXLocn = ?; 
    mouseYLocn = ?;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-10T05:55:34.617

不幸的是，没有办法在事件处理程序之外检索鼠标光标的位置。您有一个选择是为 onmousemove 事件注册一个事件处理程序并将坐标存储在全局（ish）变量中。

使用普通的旧 javascript，以下代码应该可以解决 Safari 和 FF3 的问题。

```
var coords = {x: NaN, y: NaN};

...

if (coords.x === ... && coords.y === ...) {
   /* insert your magic here */
}

...

window.addEventListener('mousemove', function(e) { 
    coords.x = e.clientX;
    coords.y = e.clientY;
}, true); 
```

简而言之，为“onmousemove”事件注册了一个事件监听器（处理程序）。当事件触发时，匿名函数会随事件一起调用。该事件包含几个属性，其中两个是clientX 和clientY。这些是鼠标相对于窗口的坐标，而不是文档的顶部。这些坐标被放置在一个变量中，处理程序和需要坐标的代码都可以访问该变量。这可能是某种全局变量或封闭变量。

我应该注意，通常浏览器中的 javascript 实现是单线程的。简单地说，这意味着`coords`如果自上次调用事件处理程序以来鼠标已经移动，则变量中包含的值可能并不总是最新的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T22:19:17.240

最简单的方法是捕获鼠标移动事件并将位置保存到全局变量中。

如果它已经被捕获，你可以这样做：

```
var oldFunction = document.onmousemove;
document.onmousemove = function(e)
{
    // save x & y here...

    return oldFunction(e);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T22:31:19.287

使用 jQuery，您可以在任何事件中获得鼠标位置：

```
$('#example').click(function(e){
   var x = e.pageX;
   var y = e.pageY;
   // ...
}); 
```

更多信息在这里：[http](http://docs.jquery.com/Tutorials:Mouse_Position) ://docs.jquery.com/Tutorials:Mouse_Position 这可以提供帮助。否则使用 mousemove 事件将最新位置 x/y 存储在全局变量中。

# objective-c - 初始化 NSMutableArray：[NSMutableArray 数组]；

> ID：844188
> 
> 赞同：7
> 
> 时间：2009-05-09T22:16:13.800
> 
> 标签：objective-c, cocoa, cocoa-touch

如果你用上面提到的 NSArray 的便捷方法初始化一个 NSMutableArray，你会得到一个 NSArray 还是一个 NSMutableArray？

有什么后果吗？

（我知道 NSMutableArray 有“arrayWithCapacity:，我只是好奇）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-09T22:22:41.007

如果您使用以下方法对其进行初始化：

```
NSMutableArray *array = [NSMutableArray array]; 
```

你得到一个 NSMutableArray。Objective-C 的一大特点是类方法由子类继承。

因此，在类方法中，您可以执行以下操作：

```
+(id)array {
    return [[[self alloc] init] autorelease];
} 
```

并将`self`引用代码正在执行的类对象（`NSArray`或`NSMutableArray`）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-10T04:37:34.977

**更新：**虽然我“自己测试”的建议通常是一个好主意，但在这种情况下它有点触发快乐。感谢 Jim 在评论中指出我下面的建议不适用于这些类，因为各种形式的 NSArray 都是由 CoreFoundation 免费桥接类实现的。

----- 以下上下文的原始答案 -----

回答此类问题的最简单方法是自己进行测试。尝试以您好奇的方式分配数组，然后从您的代码中分配 NSLog：

NSLog(@"We got a %@", NSStringFromClass([theArray class]));

# objective-c - 有没有一种简单的方法可以向后迭代 NSArray？

> ID：844189
> 
> 赞同：72
> 
> 时间：2009-05-09T22:16:39.930
> 
> 标签：objective-c, nsarray

我有一个`NSArray`并且必须在特殊情况下向后迭代它，以便我首先查看最后一个元素。这是出于性能原因：如果最后一个没有意义，则可以忽略所有以前的。所以我想打破循环。但是，如果我从 0 向前迭代到 n，那将不起作用。我需要从 n 到 0。也许有一个我不知道的方法或函数，所以我不必在这里重新发明轮子。

* * *

## 回答 #1

> 赞同：196
> 
> 时间：2009-05-10T00:16:19.130

要添加其他答案，您可以`-[NSArray reverseObjectEnumerator]`结合使用 Objective-C 2.0 中的快速枚举功能（在 Leopard、iPhone 中可用）：

```
for (id someObject in [myArray reverseObjectEnumerator])
{
    // print some info
    NSLog([someObject description]);
} 
```

提供更多信息的来源： http: [//cocoawithlove.com/2008/05/fast-enumeration-clarifications.html](http://cocoawithlove.com/2008/05/fast-enumeration-clarifications.html)

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-05-09T23:45:00.403

由于这是出于性能考虑，因此您有多种选择，建议您全部尝试一下，看看哪种效果最好。

*   `[array enumerateObjectsWithOptions:NSEnumerationReverse usingBlock:…]`
*   `-[NSArray reverseObjectEnumerator]`
*   [创建数组的反向副本，](https://stackoverflow.com/questions/586370/how-can-i-reverse-a-nsarray-in-objective-c)然后正常迭代
*   使用标准 C for 循环并开始并通过数组向后工作。

更极端的方法（如果性能非常关键）

*   阅读 Cocoa 如何实现快速对象枚举并反向创建您自己的等价物。
*   使用 C 或 C++ 数组。

可能还有其他人。在这种情况下，任何人都可以随意添加它。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-05-09T22:24:34.873

从[这里](http://en.wikibooks.org/wiki/Programming_Mac_OS_X_with_Cocoa_for_beginners/Containers_-_arrays,_and_dictionarys)：

```
 NSEnumerator* myIterator = [myArray reverseObjectEnumerator];
 id anObject;

 while( anObject = [myIterator nextObject])
 {
     /* do something useful with anObject */
 } 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-09T22:21:22.650

```
[NsArray reverseObjectEnumerator] 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-03-05T08:03:15.723

```
for (int i = ((int)[array count] - 1); i > -1; i--) {
    NSLog(@"element: %@",array[i]);
} 
```

# visual-studio-2008 - IIS5 不在本地计算机上提供 index.html，即使它已在默认文档中列出

> ID：844191
> 
> 赞同：1
> 
> 时间：2009-05-09T22:16:54.453
> 
> 标签：visual-studio-2008, iis, iis-5, default-document

我正在使用 IIS5 运行 XP SP3 的机器上用 VS2008 开发一个站点。我已经在每个目录中命名了主页`index.html`以避免`www.domain.tld/directory/pagename.ext`指定完整路径的情况，并且还因为这些页面实际上包含其目录中其他页面的索引。

当我在本地机器上调试时，我得到了可怕的“目录列表”页面。我已经确认它`index.html`在 IIS 默认文档中列出，并且我也尝试将它移到第一个位置。没变。将站点上载到运行 IIS7 的服务器会产生预期和期望的结果。

问题是因为我有旧版本的 IIS 吗？在本地运行而不是在 Web 服务器上运行时，IIS 的运行方式有什么不同吗？我需要更改 web.config 中的设置吗？任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-10T01:05:23.987

您是否确保选中了启用默认文档？IIS 5 会忽略您的 web.config 中的任何网络服务器设置，因此与它没有任何关系。

# windows - 从 Windows 命令行显示“toast”通知弹出窗口的程序？

> ID：844192
> 
> 赞同：3
> 
> 时间：2009-05-09T22:17:29.197
> 
> 标签：windows, command-line, toast

我有一个监控脚本，当它检测到发生某些事情时，我想弹出一个“ [toast 窗口”。](http://msdn.microsoft.com/en-us/library/ms632289(VS.85).aspx)是否有一个简单的可执行文件可供我运行来执行此操作？我知道编写这样的东西相对容易，但如果有可用的程序，我宁愿只使用现有程序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-09T22:39:56.550

GrowlNotify 软件在[这里](http://blog.growlforwindows.com/2009/04/new-growlnotify-command-line-script.html)有一个 Windows 版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-10T01:51:58.540

QuickMacros 也可以做到这一点，但它是 40 美元....不过它也可以为您做早餐... ;)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-08-21T23:55:10.770

那里也有[Snarl](http://snarl.fullphat.net/)。

已经使用了一段时间，它似乎比 Growl 更发达，上次我检查过。

# iphone - `[super viewDidLoad]` 约定

> ID：844195
> 
> 赞同：60
> 
> 时间：2009-05-09T22:21:11.353
> 
> 标签：iphone, objective-c, cocoa, cocoa-touch

我看到一些示例代码在您的实施之前和之后调用了 [super viewDidLoad]。

我知道您不必总是调用 super （如许多其他讨论中所见）。当您调用它时，它是在您编码之前还是之后预期的？

这可能会产生后果，具体取决于 super 的实现。尽管您不必知道 super 的实现即可编写您的实现。

当然，这适用于所有 UIViewControllers 委托方法（willAppear、didAppear 等...）

有什么想法吗？

* * *

## 回答 #1

> 赞同：98
> 
> 时间：2009-05-09T23:20:22.570

我的经验法则是：如果您正在做与初始化相关的事情，请始终首先调用超类的方法（如果您要调用它）。这使超类有机会进行您稍后在方法中可能依赖的任何设置。如果您正在做与销毁相关的事情，请最后调用超类的方法。这确保您可以在方法的整个执行过程中依赖对象的状态。最后，根据具体情况处理任何其他情况。例如，如果您正在处理一个事件，您可能希望首先处理该事件，并且仅在您选择不处理该事件或您以某种方式更改它并希望将其传递给事件时才调用超类的方法链。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-09T07:13:52.847

假设您有 2 个班级，一个父母和一个孩子。子继承自父。他们有一个名为 greet 的方法，它返回一个字符串。

下面是父方法的样子：

代码：

```
-(NSString *)greet {
 return @"Hello";
} 
```

我们希望孩子向父母学习。所以我们用 super 来表达妈妈的问候方式，但也有我们自己的小补充。

代码：//从父级继承

```
-(NSString *)greet {
NSString *parentGreeting = [super greet];
return [parentGreeting stringByAppendingString:@", Mommy"]
} 
```

所以现在父母打招呼“你好”，孩子打招呼“你好，妈妈”。稍后，如果我们将父母的问候语更改为只返回“Hi”，那么两个类都会受到影响，您将有“Hi”和“Hi, Mommy”。

super 用于调用超类定义的方法。它用于访问已被子类覆盖的方法，以便类可以将自己的代码包装在其父类实现的方法周围。如果您要进行任何类型的继承，这将非常方便。

# objective-c - Objective-C 中的子类化是一种不好的做法吗？

> ID：844199
> 
> 赞同：17
> 
> 时间：2009-05-09T22:21:32.570
> 
> 标签：objective-c, oop, subclass

在阅读了大量博客、论坛条目和几个 Apple 文档之后，**我仍然不知道在 Objective-C 中进行大量子类化是否是明智之举**。

以下面的案例为例：

> 假设我正在开发一个包含很多元素的益智游戏。所有这些元素都具有一定数量的相同行为。然后，在我的元素集合中，不同的元素组共享相同的行为，将组与组区分开来，等等......
> 
> 所以，在确定什么从什么继承之后，**我决定子类化。为什么我不应该？** 考虑到使用此模型可以轻松调整一般行为，我认为我完成了面向对象编程的目标。

但是， - 这是我的问题的来源 - Apple 提到**使用委托、数据源方法和非正式协议来支持子类化**。这真的让我大吃一惊，为什么？

好像有两个阵营。那些支持子类化的，那些不支持的。这显然取决于个人口味。**我想知道大规模子类化而不是大规模子类化的利弊是什么**？

总结一下，我的问题很简单：**我说的对吗？为什么或为什么不呢？**

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-10T06:02:34.070

委派是一种使用组合技术来替换您本来可以继承的编码的某些方面的方法。因此，它归结为一个古老的问题，即手头的任务需要一件知道如何做很多事情的大事，或者如果你有一个松散的专用对象网络（一种非常 UNIX 的责任模型）。

使用委托和协议的组合（定义委托应该能够做什么）提供了很大的行为灵活性和易于编码 - 回到 Liskov 替换原则，当你子类化时你必须小心你不会做任何让整个班级的用户感到意外的事情。但是，如果您只是制作一个委托对象，那么您需要承担的责任要少得多，只需您实现的委托方法执行一个协议所要求的，除此之外您并不关心。

使用子类仍然有很多很好的理由，如果您确实在多个类之间共享行为和变量，那么子类可能很有意义。但是，如果您可以利用委托概念，您通常可以使您的类更容易扩展或以设计者可能没有预料到的方式使用。

我更喜欢正式协议而不是非正式协议，因为正式协议不仅可以确保您拥有一个类将您视为代表期望的方法，而且因为协议定义是记录您的内容的自然场所期望来自实现这些方法的委托。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-09T22:25:43.950

就个人而言，我遵循这条规则：如果它尊重[Liskov 替换原则](http://en.wikipedia.org/wiki/Liskov_substitution_principle)，我可以创建一个子类。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-10T05:26:26.123

子类化有它的好处，但它也有一些缺点。作为一般规则，我尽量避免实现继承，而是使用接口继承和委托。

我这样做的原因之一是因为当您继承实现时，如果您覆盖方法但不遵守它们（有时是未记录的合同），您可能会遇到问题。此外，我发现具有实现继承的遍历类层次结构很困难，因为方法可以在任何级别被覆盖或实现。最后，子类化时只能扩大接口，不能缩小接口。这会导致抽象泄漏。一个很好的例子是扩展 java.util.Vector 的 java.util.Stack。我不应该将堆栈视为向量。这样做只允许消费者在界面周围运行。

其他人提到了里氏替换原则。我认为使用它肯定会解决 java.util.Stack 问题，但它也可能导致非常深的类层次结构，以确保类只获得它们应该拥有的方法。

相反，接口继承基本上没有类层次结构，因为接口很少需要相互扩展。这些类只是实现了它们需要的接口，因此可以由消费者以正确的方式处理。此外，由于没有实现继承，因此这些类的消费者不会因为之前对父类的经验而推断他们的行为。

最后，你走哪条路并不重要。两者都是完全可以接受的。这实际上更多的是您更喜欢什么以及您正在使用的框架鼓励什么。古语有云：“在罗马做罗马人做的事”。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-09T23:24:54.977

在 Objective-C 中使用继承没有错。苹果使用它相当多。例如，在 Cocoa-touch 中，UIButton 的继承树是 UIControl : UIView : UIResponder : NSObject 。

我认为 Martin 在提到 Liskov 替代原则时提到了一个重要的点。此外，正确使用继承要求子类的实现者对超类有深入的了解。如果您曾经努力在复杂的框架中扩展一个重要的类，您就会知道总有一条学习曲线。此外，超类的实现细节经常“泄漏”到子类，这对框架构建者来说是一个很大的痛点。

Apple 在许多情况下选择使用委托来解决这些问题；像 UIApplication 这样的重要类通过委托对象公开公共扩展点，因此大多数开发人员都有更容易的学习曲线和更松散的耦合方式来添加应用程序特定的行为——很少需要直接扩展 UIApplication。

在您的情况下，对于您的应用程序特定代码，请使用您最熟悉并最适合您的设计的技术。如果使用得当，继承是一个很好的工具。

我经常看到应用程序程序员从框架设计中吸取教训并尝试将它们应用到他们的应用程序代码中（这在 Java、C++ 和 Python 世界以及 Objective-C 中很常见）。虽然思考和理解框架设计者所做的选择是件好事，但这些教训并不总是适用于应用程序代码。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-09T23:16:12.657

一般来说，如果存在完成您想要做的事情的委托等，您应该避免子类化 API 类。在您自己的代码中，子类化通常更好，但它确实取决于您的目标，例如。如果您提供 API，则应提供基于委托的 API，而不是假设子类化。

在处理 API 时，子类化有更多潜在的错误——例如。如果类层次结构中的任何类获得了一个与您添加的名称相同的新方法，那么您就会破坏东西。而且，如果您提供有用/帮助类型的函数，将来有可能将类似的东西添加到您子类化的实际类中，这可能会更有效，等等，但您的覆盖将隐藏它。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-10-13T19:24:45.760

请阅读 Apple 文档[“向 Cocoa 程序添加行为”](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CocoaFundamentals/AddingBehaviortoaCocoaProgram/AddingBehaviorCocoa.html)！。在**“继承自 Cocoa 类”**部分下，请参阅第 2 段。Apple 明确提到子类化是向框架添加应用程序特定行为的主要方式（请注意，**FRAMEWORK**）。
MVC 模式并不完全不允许使用子类或子类型。至少我没有从苹果或其他人那里看到这个建议（如果我错过了，请随时指出我正确的信息来源）。如果您仅在您的应用程序中子类化 api 类，请继续，没有人阻止您，但请注意它不会破坏整个类/api 的行为。子类化是扩展框架 api 功能的好方法。我们在 Apple IOS 框架 API 中也看到了很多子类化。作为开发人员，必须注意实现是有据可查的，并且不会被其他开发人员意外复制。如果您的应用程序是一组您计划作为可重用组件分发的 API 类，那么这完全是另一场球赛。

恕我直言，与其询问最佳实践是什么，不如先彻底阅读相关文档，实施并测试它。做出你自己的判断。你最清楚自己在做什么。其他人（比如我和其他许多人）很容易从网络上阅读不同来源的东西并抛出术语。做你自己的判断，到目前为止它对我有用。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-09T23:18:57.910

我真的认为这取决于你想要做什么。如果您在示例中描述的益智游戏确实具有一组具有共同属性的独特元素，并且没有提供符合您需求的类 - 例如，“NSPuzzlePiece”，那么我认为没有问题广泛地进行子类化。

根据我的经验，当 Apple 提供的类已经完成了与您希望它做的事情接近的事情时，委托、数据源方法和非正式协议会更有用。

例如，假设您正在构建一个使用表格的应用程序。有（我在这里说的是 iPhone SDK，因为这是我有经验的地方）一个 UITableView 类，它可以完成创建用于与用户交互的表的所有细节，并且为UITableView 的实例比它完全子类化 UITableView 并重新定义或扩展其方法以自定义其行为。

类似的概念适用于委托和协议。如果您可以将您的想法融入 Apple 的类中，那么这样做并使用数据源、委托和协议通常比创建您自己的子类更容易（并且会更顺利地工作）。它可以帮助您避免额外的工作和浪费时间，并且通常不易出错。Apple 的课程负责使功能高效和调试的业务；与他们合作得越多，从长远来看，您的程序所犯的错误就越少。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-11T13:45:16.510

我对 ADC 强调“反对”子类化的印象更多地与操作系统如何演变的遗留问题有关……回到过去（Mac Classic aka os9），当时 c++ 是大多数 mac 工具箱的主要接口，子类化是事实上的标准，以便程序员修改普通操作系统功能的行为（这确实有时令人头疼，这意味着必须非常小心，任何和所有修改的行为都是可预测的，并且没有打破任何标准行为）。

话虽这么说，我对 ADC 对子类化的强调的印象*并不是*提出在没有继承的情况下设计应用程序的类层次结构的案例，而是指出在**新的做事方式（即***OSX*）中，在大多数情况下更合适意味着在不需要子类的情况下自定义标准行为。

 **所以，无论如何，尽可能健壮地设计你的拼图程序的架构，在你认为合适的时候利用继承！

期待看到您酷炫的新拼图应用程序！

|K<

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-01-19T10:51:01.707

Apple 确实似乎被动地不鼓励使用 Objective-C 进行子类化。

这是 OOP 设计的一个公理，即倾向于组合而不是实现。

# jquery - Fogbugz like 下拉菜单

> ID：844202
> 
> 赞同：4
> 
> 时间：2009-05-09T22:22:47.793
> 
> 标签：jquery, user-interface, fogbugz

我正在寻找一个 jquery 插件来获得类似fogbugz 的下拉菜单，以便您可以在下拉菜单中输入。

应该是这样的： http: [//dl.getdropbox.com/u/5910/Jing/2009-05-10_0937.swf](http://dl.getdropbox.com/u/5910/Jing/2009-05-10_0937.swf)（旧视频[http://dl.getdropbox.com/u/5910/Jing /2009-05-10_0055.swf](http://dl.getdropbox.com/u/5910/Jing/2009-05-10_0055.swf) )

所有的答案都没有给我打字部分任何其他建议吗？

编辑：我发现了一些类似的东西： http: [//phone.witamean.net/sexy-combo/examples/index.html](http://phone.witamean.net/sexy-combo/examples/index.html)但有几件事让我很烦恼：它没有选择我们点击的整个字符串单击三角形时，文本框和保管箱不显示所有选项

我找到了一个工作演示，但它来自 ext :( [http://extjs.com/deploy/dev/examples/form/combos.html](http://extjs.com/deploy/dev/examples/form/combos.html)不是 jquery ...但它具有我需要的所有功能

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-10T01:21:16.990

这通常称为组合框，您可以在这里找到一个不错的 jQuery 组合框：

[http://jonathan.tang.name/code/jquery_combobox](http://jonathan.tang.name/code/jquery_combobox)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-09T23:02:38.103

我还没有找到一个同时具有自动完成和组合下拉箭头的功能。但是，这个[插件](http://jquery.bassistance.de/autocomplete/demo/)是关闭的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-12-22T16:26:37.547

试试 jQuery 选择的库：[http](http://harvesthq.github.com/chosen/) ://harvesthq.github.com/chosen/他们似乎工作得很好，并且优雅地回退到正常的选择。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-04-28T22:53:14.720

我刚刚发布了一个 jQuery 插件，它完全可以做到这一点，称为[改进下拉](http://improvingsoftware.com/2011/04/21/adding-combo-box-style-dropdowns-to-your-web-page/)。它发布在 jQuery 站点上的插件库中。[这](http://plugins.jquery.com/project/ImprovedDropdown)是它的直接链接。

# sql - sql server 是否在插入时检查重复的 GUID？

> ID：844203
> 
> 赞同：2
> 
> 时间：2009-05-09T22:22:47.950
> 
> 标签：sql, sql-server, guid

当插入一个 guid 作为主键时，数据库服务器是否遍历每一行以确保没有重复，或者它只是假设重复是不可能的或不太可能？

使用 int 数据库服务器可以简单地增加密钥，但不能使用 GUID

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-09T22:56:03.160

一旦你告诉它一列是主键，这就是数据库的责任。

此时你不必担心，让数据库为你担心。

此外，由于这是一个主键，它将被索引。因此，您对通过每一行（或表扫描）的性能担忧不会真正发生在这个级别。数据库将使用索引文件来确保只能插入唯一值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T22:39:17.303

所有主键都是唯一的。所以服务器负责验证没有两行有相同的主键。如果主键是 int、varchar、guid 等，这是真的。 *如何*验证唯一性约束是实现定义的。基本上，除非你已经证明它是一个性能障碍，否则不要让它担心你。

在过度担心性能之前，请始终进行分析。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T22:28:59.323

我猜只有它是主键或唯一键

但据我所知，GUID 是独一无二的。

# language-agnostic - 您如何在严格的 Scrum 商店中管理非面向用户的工作？

> ID：844215
> 
> 赞同：2
> 
> 时间：2009-05-09T22:32:51.873
> 
> 标签：language-agnostic, continuous-integration, scrum

我们是一家中型工程车间 (10-20)。我们擅长对面向用户的故事进行优先排序和结构化工作，并使客户满意。但是鞋匠的孩子没有鞋子。如果不是关于客户，我们有 0 流程。

我正在寻找系统来确保我们正确地确定优先级并完成非面向用户的工作以保持开发车间的运行：QA 环境（在我们的例子中相当繁重）、持续集成系统、打包等等。

现在，资源总是有限的。我们不想给鞋匠的孩子 10 双最高档的鞋子，以及专门的自行车鞋来引导。我们想要做正确的、必要的工作，采用与我们其他开发相同的低劣纪律。

告诉我哪种系统适合您：您如何确定和组织非面向用户的工作？我想要简单且与 scrum 顺利集成的系统。

（我知道本文顶部有一个红色框，表示 Stack Overflow 的自动问题解析器认为这是一个无法回答的主观问题——我认为可能有 2 或 3 个优秀的答案可以或已被证明是可行的 - 过程是编程不可或缺的一部分。所以这里有一些代表我们的过程的伪代码。修复这个算法）。

```
IBacklog GetBacklogForWork(IWork requestedWork)
{
    if(requestedWork.IsUserFacing) return new PrioritizedBacklogRepository();
    // Everything else. Priority largely based on spare time and who thinks its a neat idea
    return new RandomizedPriorityRepository();
}

void HandleIncomingSuggestionsForWork(IEnumerable(IWork) ideas)
{
    foreach(work in ideas) GetBacklogForWork(work).Insert(work);
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-10T00:16:57.317

***相关****人员正在使用并取决于项目的结果。* 这必然是正确的；如果不是真的，你为什么要这么做？

当您*确定*最依赖或最关心项目结果的人时，您就有了项目所面临的“用户”。让那个人成为客户。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T22:49:16.170

从某种意义上说， IMO 之类的“QA 环境”*是*面向用户的工作。

质量是公认的“非功能性”要求（因此不一定有相关的“故事”）。但是，您可能有一个非功能性需求，例如“软件必须在发货前进行测试”。您可以为这样的需求分配一个相对优先级（“测试软件有多重要？”），然后照常执行（决定如何实现该需求，估计实现需要多长时间，安排实现，分配实现等）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-10T03:05:08.723

我们在我工作的地方所做的是有一个百分比，现在大约 15% 给予或接受几个百分点，用于非面向用户的工作的内部任务。通过这种方式处理技术债务，如果任务积压变得相当大，那么可能会花费一个 sprint 而不是新功能。最后一个向用户或客户推销的方式是，有一段时间只完成维护和预防性工作，因此在下一个 sprint 之后没有任何新功能。

这是一个可以稍微调整的想法，尽管它还不一定完全被淘汰。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T19:27:52.073

我看到它或多或少工作的方式是尽可能多地尝试将非功能性/非面向用户作为相关的面向用户的活动的一部分，或第一个面向用户的活动需要它。这是最容易处理的，因为它只是反映了开发组织的需求，以保持可持续的速度向前发展。

无法关联的额外工作将使用 JB King 描述的百分比来完成。

将其作为具有如此或这样的投资回报率的投资的替代方案在理论上是一个性感的概念，但对于现实生活中的 PO，我已经看到它很少奏效。很难让 PO 了解投资，更不用说实际上强大到足以延迟它的功能。

有时开发团队的困难角色是成为“放慢速度”以保持可持续发展的人。

无论选择何种方法，开发经理有时都会对整个情况感到非常糟糕。作为曾经在那个地方工作过的人以及敏捷教练，我的建议是，只要您觉得自己在为业务做正确的事情，专注于现在需要并且相对较快的非功能性工作ROI，您应该对此感到满意。

注意事项：这是一个真正让自组织面临挑战的领域。组织需要信任团队做正确的事，团队需要赢得而不是滥用这种信任。它是个人或团队了解正确平衡的成熟标志。

# php - PHP MYSQL 插入/更新

> ID：844220
> 
> 赞同：5
> 
> 时间：2009-05-09T22:33:50.670
> 
> 标签：php, mysql

我有一个简单的表格，如下所示。

```
CREATE TABLE `stats` (
  `id` int(11) NOT NULL auto_increment,
  `zones` varchar(100) default NULL,
  `date` date default NULL,
  `hits` int(100) default NULL,
  PRIMARY KEY  (`id`)
) ENGINE=MyISAM AUTO_INCREMENT=7 DEFAULT CHARSET=latin1; 
```

因此，只需每天为每个区域存储简单的命中计数器。

但我只想增加同一天的命中值。

我已经尝试过 MYSQL DUPLICATE KEY UPDATE 但这不起作用，因为我可能在不同的日期有很多区域，所以我不能让它们唯一或日期。

所以我能想到的唯一方法是首先进行查询以查看日期是否存在，然后执行简单的 if() 插入/更新

他们是完成这样一项任务的更好方法吗，因为每天可能有很多 1000 次点击。

希望这是有道理的:-)。

如果你能提供建议，谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-09T23:07:48.933

`(zone, date)`在 CREATE 语句中将元组声明为唯一的。这将使 INSERT ... ON DUPLICATE UPDATE 按预期工作：

```
CREATE TABLE `stats` (
  `id` int(11) NOT NULL auto_increment,
  `zone` varchar(100) default NULL,
  `date` date default NULL,
  `hits` int(100) default NULL,
  PRIMARY KEY  (`id`),
  UNIQUE (`zone`, `date`)
) ENGINE=MyISAM AUTO_INCREMENT=7 DEFAULT CHARSET=latin1;

INSERT INTO stats (zone, date, hits) values ('zone1', 'date1', 1) ON DUPLICATE KEY UPDATE hits = hits + 1; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T22:41:17.093

```
$result = mysql_query("SELECT id FROM stats WHERE zone=$zone AND date=$today LIMIT 1");
if(mysql_num_rows($result)) {
    $id = mysql_result($result,0);
    mysql_query("UPDATE stats SET hits=hits+1 WHERE id=$id");
} else {
    mysql_query("INSERT INTO stats (zone, date, hits) VALUES ($zone, $today, 1)");
} 
```

类似的东西，如果我对你的解释正确的话……那是完全未经测试的。你可以弄清楚变量是什么。

# c# - 哪个不是创建自定义异常的理由？

> ID：844221
> 
> 赞同：-1
> 
> 时间：2009-05-09T22:34:19.077
> 
> 标签：c#, .net, architecture

最近我在brainbench 做了一个测试，结果还不错（大概4.5，硕士）。我只知道 1 个问题的答案（其余的我确定，或者至少我认为我知道正确的答案:)）。问题是：

以下哪一项不是创建自定义异常的原因？

选项 1
插入强标签以供以后检查
选项 2
强类型特定异常的目的
选项 3
允许远程序列化
选项 4
处理创建异常时的常见步骤
选项 5
为自定义数据传播添加自定义属性

我回答“4” - 在创建异常时处理常见步骤。你认为哪一个是正确的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-09T22:37:54.683

选择 3\. 基本异常要么已经支持远程处理，要么您从它派生的不会*添加*远程处理。

* * *

马克在评论中提到的“例外”如下；我认为这不是测试作者的想法：

在 WCF 服务中，您可以允许未处理的异常传播到服务之外。WCF 会将其转换为 SOAP 错误，它可能包含也可能不包含未处理异常的详细信息，具体取决于配置。

更好的做法是识别某些异常集并将它们有意地转换为 SOAP 错误。例如，对数据库实体进行操作的服务可能期望有时找不到实体；有时尝试添加新实体会导致重复；有时更新尝试会导致无效状态。这样的服务可能决定公开`NotFoundFault`,`DuplicateItemFault`和`InvalidStateFault`.

该服务会将三个故障定义为数据合同以定义其内容：

```
[DataContract]
public class FaultBase {
    [DataMember]
    public string ErrorMessage {get;set;}
}

[DataContract]
public class NotFoundFault : FaultBase {
    [DataMember]
    public int EntityId {get;set;}
}

[DataContract]
public class DuplicateItemFault : FaultBase {
    [DataMember]
    public int EntityId {get;set}
}

[DataContract]
public class InvalidStateFault : FaultBase {
} 
```

然后你会指出特定的操作可以返回这样的错误：

```
[OperationContract]
[FaultContract(typeof(NotFoundFault))]
public Entity GetEntityById(int id) 
```

最后，您可以包装 DAL 中的异常，以使 WCF 将返回特定错误：

```
 try {
        return DAL.GetEntity<Entity>(id);
    }
    catch (DAL.NoSuchEntityException ex)
    {
        throw new FaultException<NotFoundFault>(
            new NotFoundFault {EntityId = ex.Id, ErrorMessage = "Can't find entity"});
    } 
```

我认为测试开发人员试图让您认为需要做一些特殊的事情才能序列化异常以远程处理到不同的 AppDomain。如果自定义异常被正确实现，则不会出现这种情况，因为提供的 .NET 异常类都是可序列化的。因此，序列化的能力不是创建自定义异常的借口，因为基类应该已经是可序列化的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-10T02:52:12.997

我实际上同意 4 是错误的：在创建异常时处理常见步骤。

异常在创建时不应该执行“步骤”，而是通知系统已经创建了当前类（可能还有模块）不知道如何解决的异常情况。

如果执行通用步骤对于正确执行功能是必要的，则该功能应包含在代码本身中，而不是分离到异常中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-10T09:56:16.427

在使用 WCF 服务时，我们确实必须为序列化创建自定义异常。所以3不可能是正确答案。

# java - 使用 Hibernate 查询“扩展表”

> ID：844222
> 
> 赞同：0
> 
> 时间：2009-05-09T22:35:27.513
> 
> 标签：java, hibernate, orm

我在 Hibernate 中有一个查询问题。我有一个包含现有数据的表“测试”。我有一个要求，我不能修改测试表的架构，所以我创建了另一个表，'testExtension'，它的主键是测试主键的外键。 **testExtension 中的数据是 test 中数据的子集。即“testExtension”中的行数将少于“test”中的行数。**

我在配置文件中定义了这种关系，如下所示：

```
<class name="Test" table="test">
<id name="testId" column="test_id">
    <generator class="sequence">
        <param name="sequence">test_id_seq</param> 
    </generator>
</id>

<property name="name"/>

<joined-subclass name="TestExtension" table="testExtension">
    <key column="test_id"/>

    <property name="summary" />
    <property name="homepage"/>
</joined-subclass> 
```

通过这个设置，我可以在我的 Java 程序中创建一个 TestExtension 对象，用数据填充它，通过 Hibernate '保存'它，并提交事务。它正确地将数据保存在 Test 和 TestExtension 中。

当我尝试从这些表中查询数据时，出现了我的问题。现在，如果我使用 QBE 的 TestExtension.class 查询特定的 test_id，它只会在 Test 和 TestExtension 中都存在该 id 时返回一行。如果我将 Test.class 用于 QBE，它将返回该行，但我将无法访问存储在 TestExtension 中的任何数据。

我的问题是：如何查询这些表，以便结果基于 Test 和 TestExtension 的“左外连接”？任何解决方案都值得赞赏，无论是通过示例查询、HQL 还是其他方式（尽管最好不是原始 SQL）。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-10T19:41:33.273

HQL 可能是最简单的方法。文档在这里：

[http://docs.jboss.org/hibernate/stable/core/reference/en/html/queryhql-joins.html](http://docs.jboss.org/hibernate/stable/core/reference/en/html/queryhql-joins.html)

听起来您可能想要做的是重新映射您的关系，以便 Test 和 TestExtension 使用一对一的关系而不是继承。然后，您可以使用一对一的左外连接查询 Test 和 TestExtension。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-10T20:13:55.920

如果您使用 HQL 为 Test 类编写查询，它应该做您想做的事。我假设 QBE 正在有效地将示例实体的类添加为查询参数之一。

所以像：

```
from Test t where t.property = :value 
```

应该返回 Test 或 TestExtension 实体。请注意（至少在我使用的 Hibernate 版本中）。在这种情况下，Hibernate 应该立即返回实际实体而不是代理——请注意，TestExtension 实体有时可以作为普通测试延迟加载代理返回。

# c - 用 C 对数据库进行编程

> ID：844223
> 
> 赞同：1
> 
> 时间：2009-05-09T22:35:31.163
> 
> 标签：c, database

我想用 C 对各种数据库进行编程。我想知道所有主要的数据库提供商，Oracle，DB2，Sql Server，MySql 是否都有用于 C 的 api。如果他们都这样做，你能给我一些链接到什么但更具体地说，如何使用 api？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-09T22:39:31.700

数据库连接的行业标准是 ODBC，它是一个 C API。此[Wikipedia 链接](http://en.wikipedia.org/wiki/Open_Database_Connectivity)提供了简要概述和许多其他资源的链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-10T17:35:14.947

您可以使用 ODBC。但这不是一个好主意，因为它可能会对您的应用程序产生性能影响。

你的问题的答案是肯定的。所有主要数据库都提供了一些自己的 api 供您直接与数据库通信。

您的问题的唯一问题是您忘记告诉您将为哪个操作系统开发。我现在唯一记得的那些专业数据库的 api 是 libpq（用于 PostgreSQL）。通常在开发人员的网站上可以找到 C 和 C++ 等语言的 api。

# windows-mobile - 是否有可以为 Windows Mobile 6 构建的动态生成页面的网络服务器？

> ID：844225
> 
> 赞同：0
> 
> 时间：2009-05-09T22:36:49.977
> 
> 标签：windows-mobile, webserver, opera, tiddlywiki

好的，

诚然，这听起来像是一个愚蠢的问题。

但是，我确实有这个需求。我经常使用 tiddlywiki，如果我可以在某些移动浏览器中保存对 tiddlywiki 的更改，那将是非常非常酷的。

但似乎在我尝试过的所有移动浏览器中，我对 tiddlywiki 所做的更改都无法保存到 SD 卡中；

然而，尽管一些移动浏览器似乎非常有能力加载和保存托管在网络服务器上的更改（我实际上已经在 Tiddlyspot.com 上的博客上使用 opera-mini 尝试过这个并成功保存了更改。）

现在，如果我可以托管一个在我的 Windows Mobile 设备上运行的网络服务器，并且该网络服务器能够运行一种简单的动态页面生成语言，并且以某种方式从 txt 文件或某种数据库中写入和读取，我可以访问/修改我的 tiddlywiki，而无需付费将它们托管在某个地方（即使我必须自己编写后端也是值得的！）

以下是我发现的一些移动网络服务器：

*   [微型 Java Web 服务器和容器](http://tjws.sourceforge.net/)
    *   这个唯一的问题是，我认为我的 WM6 设备不能同时在 JVM 上运行更多（因此这会淘汰我用来访问它的大多数浏览器，因为......*嗯*，它们大多是写的在Java中......）
*   [移动网络服务器](http://www.sphinx-soft.com/MWS/index.html)
    *   看起来不错，但似乎没有任何方法可以运行后端（似乎只是提供页面）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-09T23:53:29.277

Windows Mobile 有一个内置的基本 Web 服务器 (HTTPD)，我认为它可以支持 ASP 并支持 ISAPI 过滤器（请参阅[此处](http://msdn.microsoft.com/en-us/library/aa926719.aspx)）。如果 ASP 不是你的菜，你可能会得到一些轻量级的脚本语言来在 CE 下运行，这仍然是一项艰巨的任务，你仍然需要编写 wiki 软件。

为什么不使用众多免费托管 wiki 之一？（看[这里](http://www.wikimatrix.org/)的比较）

# dns - 关于 DNS 轮询

> ID：844228
> 
> 赞同：0
> 
> 时间：2009-05-09T22:38:53.887
> 
> 标签：dns, polling

目前我们对四个 Web 服务器使用 DNS 轮询。

我们遇到的问题是：当用户刷新时，他可能会去其他的web服务器。当用户已经登录时，这感觉很糟糕。因为我们使用会话来记住登录状态，但是当刷新到其他 Web 服务器时，会话丢失了。

所以最好的解决方案应该是让用户在刷新时仍然在同一个 Web 服务器上。有出路吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-09T23:39:35.677

好的，我相信您的意思是“Round Robin DNS”。好吧，您所描述的是一个[非常常见的问题](http://en.wikipedia.org/wiki/Load_balancing_(computing)#Persistence)，并且没有“正确”的解决方案，因为可能的答案取决于许多变量：您是要提供自动故障转移还是仅提供负载平衡？您愿意在负载均衡器上花费时间和/或金钱吗？您正在使用哪些技术？Java EE？php？阿帕奇？IIS？

话虽如此，如果您刚刚完成负载平衡并且故障转移不是什么大问题，您可能希望为每个服务器使用不同的名称（www1、www2、www3 等）并从“主”网络重定向到它们首次访问时的服务器 (www)。它很简单（也很简单），但在一些设置中很实用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-10T00:10:01.513

你有很多选择。

*   你可以将会话存储在一个key:value存储中，fe memcached（我个人最喜欢的）
*   您可以将会话存储在数据库中
*   您可以将反向代理负载均衡器（如 DNS）和您的服务器放在后面。然后将其设置为使来自相同 IP 的所有请求都发送到相同的服务器，而不管它们通过哪个负载均衡器。在 HAProxy 中，此选项称为`balance source`. 注意：如果节点数量发生变化，会话可能会丢失。您可以使用`cookie`or`url_param`功能来避免这种情况。

请参阅[HAProxy 文档](http://haproxy.1wt.eu/download/1.3/doc/haproxy-en.txt)。值得一读，真的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-09T23:11:27.333

我知道某些基于硬件的负载平衡器会在用户和服务器之间创建“粘性”关系以避免此类问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-09T22:40:32.853

Web 服务器可以使用通用数据库服务器来存储会话信息吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-10T00:03:22.513

可以根据客户端位置响应的 DNS 服务器可以解决此问题。带有 geoip 模块或 GeoIPdns 的 PowerDNS 就是一些例子。您需要确保 IP 地址集不重叠，以便客户端始终得到相同的响应。

这本身不会提供任何类型的故障转移。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-09T22:46:36.160

四个 Web 服务器是否都在同一个站点和网络上，或者它们是分布式的？

如果是前者，您可以在 HTTP 响应中的某处包含服务器 ID，以便真实服务器前面的反向代理可以识别哪个服务器负责会话。

# asp.net - 自动从pdf生成关键字

> ID：844229
> 
> 赞同：1
> 
> 时间：2009-05-09T22:39:17.100
> 
> 标签：asp.net, sql-server, pdf

我的应用程序允许用户上传 pdf 文件并将它们存储在网络服务器上供以后查看。我将文件名、位置、大小、上传日期、用户名等存储在 SQL 服务器数据库中。

我希望能够以编程方式，在上传文件后，生成关键字列表（可能除了常用词之外的所有内容）并将它们也存储在 sql 数据库中，以便后续用户可以进行关键字搜索......

关于如何处理此任务的建议？这些类型的例程是否已经存在？

编辑：只是为了澄清我的要求，我不关心做 OCR，我不知道 PDF 的内部，但我知道如果它是由应用程序生成的，例如 Word->PDF Print，文档的文本是可搜索的......所以真的是我的第一个任务，我的问题的目的是，如何从 asp.net 应用程序访问 PDF 文件的文本？在这一点上，扫描 PDF 上的 OCR 可能超出了我的要求。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-09T23:24:07.617

作为第一步，您应该从 PDF 中提取所有文本。 [ghostscript](http://pages.cs.wisc.edu/~ghost/)和[pdftotext](http://en.wikipedia.org/wiki/Pdftotext)可以做到这一点，[PDFBox](http://incubator.apache.org/pdfbox/)是另一种选择。当然还有其他工具。

然后您可以删除所有停用词和重复项并将其写入数据库。

有人提到这不适用于扫描的 PDF 文档，但这只是事实的一半。一方面，有很多扫描的 PDF 文件还嵌入了文本，因为这是一些扫描仪驱动程序所做的（Canon CanoScan 驱动程序执行 OCR 并生成可搜索的 PDF）。另一方面，根据我的经验，使用 LaTeX 生成的包含非 ASCCII 字符的文档会返回垃圾（即使我在 acrobat 中复制和粘贴）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T23:18:03.060

这是一个非常有趣的话题。问题是定义一个 PDF 需要多少个关键字。如果你说：

*   3 到 10 - 我会检查文本分类方法，例如**贝叶斯分类器**或 K-NN（该方法会将 PDF 文件分组为相似的集群）。我知道类似的算法用于过滤垃圾邮件。但这是一个需要输入的系统，例如，如果您将关键字添加到 100 个 PDF，该系统将学习模式。我不是专家，但这是一种方法。

*   超过 10 个 - 那么我建议蛮力 -> 过滤常用词 -> 获取特定文档的最常用词。

我会探索第一个选择。您一定要检查诸如“文本分类”、“自动标记”、“文本挖掘”、“自动关键字提取”等方法。

一些链接：

[http://en.wikipedia.org/wiki/Naive_Bayes_classifier](http://en.wikipedia.org/wiki/Naive_Bayes_classifier)

[使用朴素贝叶斯提取关键字](http://www.cs.bilkent.edu.tr/~guvenir/courses/CS550/Workshop/Yasin_Uzun.pdf)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T22:58:23.043

我预见到获取每个非常用词的唯一问题是您将稀释搜索结果并且必须查询数据库以获取更多 pdf。一个值得关注的网站是[Scribd](http://www.scribd.com/)，它的功能类似于您所说的用户上传文件并且人们能够通过 Flash 应用程序在线查看它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-04T10:49:11.020

如果您计划索引 PDF 文档，您应该考虑使用像[Lucene](http://lucene.apache.org/java/docs/index.html)这样的专用文本搜索引擎。Lucene 提供了仅使用 SQL 和关系数据库难以实现的功能。您仍然需要从 PDF 文档中提取文本，但不必担心过滤掉常用词。通过过滤掉常用词，您将完全失去进行词组搜索的能力。

# c# - 直接使用 LINQ 修改值？

> ID：844236
> 
> 赞同：2
> 
> 时间：2009-05-09T22:41:56.500
> 
> 标签：c#, .net, linq

是否可以使用以下方式修改集合的元素，例如 List、LinkedList 等：

```
collection.Do ( action ) 
```

它执行以下操作：

```
item.Value = 0
(for each item) 
```

我知道枚举器只给出值，而不是参考，因此是问题。

使用 LINQ 如何做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-09T22:50:54.030

尝试：

```
void ModifyEach<T>(this IList<T> list, Func<T, T> modifier)
{
    for (int n = 0; n < list.Count; n++)
        list[n] = modifier(list[n]);
} 
```

用法：

```
List<int> x = new List<int> { 1, 3, 7 };

x.ModifyEach(n => n + 1); // increment each item 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-09T23:31:25.367

`ForEach`如果您的集合包含引用类型，那么您可以使用扩展方法就地修改其项目，类似于`List<T>`.

这是可能的，因为您实际上并没有尝试更改`IEnumerable<T>`序列：集合包含引用，但您只是在修改引用的对象，而不是引用本身。

此技术不适用于值类型的集合。在这种情况下，您将尝试更改只读`IEnumerable<T>`序列，这是不可能的。

```
public static void ForEach<T>(this IEnumerable<T> source, Action<T> action)
{
    foreach (T item in source)
    {
        action(item);
    }
}

// ...

public class Example
{
    public int Value { get; set; }
}

// ...

Example[] examples =
    {
        new Example { Value = 1 }, new Example { Value = 2 },
        new Example { Value = 3 }, new Example { Value = 4 }
    };

examples.ForEach(x => x.Value *= 2);

// displays 2, 4, 6, 8
foreach (Example e in examples)
{
    Console.WriteLine(e.Value);
} 
```

# iphone - 在屏幕外更新 UIWebView？

> ID：844237
> 
> 赞同：1
> 
> 时间：2009-05-09T22:42:33.910
> 
> 标签：iphone, uiwebview

我正在尝试获取 UIWebView 的 UIImage，我可以使用 renderInContext: 来做到这一点。然而，在我生成图像之前，我想用一些 HTML 代码更新 UIWebView，诀窍是 UIWebView 是隐藏的。现在，我无法在 UIImage 中渲染 Web 视图的更新版本，只能使用旧版本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T19:51:17.933

您是否要等到 UIWebView 重新渲染后再查询它？将 HTML 加载到 UIWebView 不会立即更新视图。你需要等待`webViewDidFinishLoad:`。即使 HTML 是没有外部引用的简单字符串也是如此。

# c++ - 为什么 C++0x 右值引用不是默认值？

> ID：844241
> 
> 赞同：20
> 
> 时间：2009-05-09T22:46:38.953
> 
> 标签：c++, c++11, lvalue, rvalue

即将推出的 C++ 标准 C++0x 的一个很酷的新特性是“右值引用”。右值引用类似于左值（普通）引用，除了它可以绑定到临时值（通常，临时只能绑定到`const`引用）：

```
void FunctionWithLValueRef(int& a) {…}
void FunctionWithRValueRef(int&& a) {…}

int main() {
     FunctionWithLValueRef(5); // error, 5 is a temporary
     FunctionWithRValueRef(5); // okay
} 
```

那么，他们为什么要发明一种全新的类型，而不是仅仅取消对普通引用的限制以允许它们绑定到临时对象？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-05-09T22:58:52.793

这将毫无意义。您将更改函数中的事物，并且更改将立即丢​​失，因为该事物实际上是临时的。

新类型的原因源于需要能够决定什么实际上是右值，什么不是。只有这样你才能真正将它们用于它们所使用的很酷的东西。

```
string toupper(string && s) { // for nonconst rvalues
    for(char &c : s) make_uppercase(c);
    return move(s); // move s into a returned string object
}

string toupper(string const& s) { // for the rest
    // calls the rvalue reference version, by passing 
    // an rvalue copy.
    return toupper(string(s));
} 
```

现在，如果您有一些右值并将其传递给 toupper，则可以直接修改右值，因为我们知道临时的东西无论如何都是一次性的，所以我们也可以直接更改它而不需要复制它。同样，同样的观察也用于移动构造函数和移动赋值。右手边没有被复制，只是它的东西被偷走并移到了`*this`.

如果您说右值可以绑定到非 const 左值引用，那么您将无法确定最终是引用左值（命名对象）还是右值（临时）。

* * *

它可能鲜为人知，但无论如何有用，您可以将左值或右值引用限定符放在成员函数上。这是一个示例，它自然地将右值引用的现有语义扩展到隐式对象参数：

```
struct string {
    string& operator=(string const& other) & { /* ... */ }
}; 
```

现在，你不能再说

```
string() = "hello"; 
```

这是令人困惑的，并且在大多数情况下并没有真正的意义。上面所做的`&`就是说赋值运算符只能在左值上调用。右值也可以这样做，方法是把`&&`.

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-09T22:59:12.870

因为添加一种新的引用允许您编写方法的两个重载：

```
void CopyFrom(MyClass &&c)
{
    dataMember.swap(c);
}

void CopyFrom(const MyClass &c)
{
    dataMember.copyTheHardWay(c);
} 
```

接受新类型引用的版本允许修改它接收的变量，因为该变量不会在其他任何地方使用。所以它可以“窃取”它的内容。

这就是添加此功能的全部原因；保留一种类型的参考不会达到预期的目标。

# iphone - UIImageView 和 UIImage：如何调整它们的最大性能？

> ID：844248
> 
> 赞同：1
> 
> 时间：2009-05-09T22:52:32.823
> 
> 标签：iphone, cocoa-touch, performance, uikit

首先：我为图像实现了一个相当复杂的滚动机制，它允许在一个滚动视图中滚动几十万（理论上）。这是通过在滚动时预加载小部分来完成的，同时重用所有 UIImageView。目前我所做的只是将新创建的 UIImage 对象分配给那些重用的 UIImageViews。

如果还可以通过将新的图像数据传递给它们来重用这些 UIImage 对象，那可能会更好。

现在的问题是，我目前正在使用 -imageNamed: 方法。文档说，它缓存了图像。

我在这种情况下使用 -imageNamed 看到的问题：随着图像滚动超出预加载范围，不再需要它。如果它在用户滚动、滚动和滚动时尝试缓存数千张图像，那就太糟糕了。如果我能找到一种方法将新图像数据填充到 UIImage 对象中以重新使用它，那么缓存的旧图像会发生什么？

所以剩下一种方法，看起来很有趣：-initWithContentsOfFile：

这不会缓存图像。而且它不使用-autorelease，这在这种情况下很好。

您认为在这种情况下使用 -initWithContentsOfFile: 会更好吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-09T23:28:26.357

只有基准可以肯定地告诉你。我倾向于认为`UIImage`图像缓存可能*非常*有效，因为它在操作系统中几乎无处不在。也就是说，根据您显示的图像数量，您的方法可能会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-08-22T14:10:48.563

我会说是的。您有太多图像无法将所有图像都保存在缓存中，因此您无法使用 -imageNamed:。如果您的图像没有多次显示，则不会降低性能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-02-16T13:16:54.620

我找到了一个关于此的链接，其中对 imageNamed 方法的评论[http://www.alexcurylo.com/blog/2009/01/13/imagenamed-is-evil/](http://www.alexcurylo.com/blog/2009/01/13/imagenamed-is-evil/)

# c# - 如何按降序对 DateTime 对象的 ArrayList 进行排序？

> ID：844251
> 
> 赞同：12
> 
> 时间：2009-05-09T22:56:30.320
> 
> 标签：c#

如何按降序对 DateTime 对象的 ArrayList 进行排序？

谢谢你。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-05-09T23:06:15.863

首先，除非您坚持使用框架 1.1，否则您根本不应该使用 an `ArrayList`。您应该改用强类型泛型`List<DateTime>`。

对于自定义排序，有一个`Sort`采用比较器的方法的重载。通过反转常规比较，您可以按降序排序：

```
list.Sort(delegate(DateTime x, DateTime y){ return y.CompareTo(x); }); 
```

### 更新：

使用 C# 3 中的 lambda 表达式，委托更容易创建：

```
list.Sort((x, y) => y.CompareTo(x)); 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-05-09T23:13:04.133

`ArrayList`正如“Guffa”已经说过的，除非您在 .NET 1.1 中，否则您不应该使用；不过，这是一个更简单的`List<DateTime>`例子：

```
List<DateTime> dates = ... // init and fill
dates.Sort();
dates.Reverse(); 
```

您的日期现在按降序排列。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-09T23:04:17.337

使用反向排序的日期时间比较器。调用排序。

```
public class ReverseDateComparer:IComparer{ 
    public int  Compare(object x, object y){
        return -1 * DateTime.Compare(x, y);
    }
}

list.Sort(new ReverseDateComparer()); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-09T23:06:21.200

如果您使用的是 .NET 3.5：

```
// ArrayList dates = ...
var sortedDates = dates.OrderByDescending(x => x);
// test it
foreach(DateTime dateTime in sortedDates)
  Console.WriteLine(dateTime);
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-09T23:00:27.250

```
List<T>.Sort(YourDateTimeComparer) where YourDateTimeComparer : IComparer<DateTime> 
```

这是自定义 IComparer 使用的示例：[How to remove duplicates from int[][]](https://stackoverflow.com/questions/701707/how-to-remove-duplicates-from-int)

# sql-server-2008 - 并行性如何影响结果的数量？

> ID：844261
> 
> 赞同：2
> 
> 时间：2009-05-09T23:00:30.217
> 
> 标签：sql-server-2008, common-table-expression, parallel-processing

我有一个相当复杂的查询，看起来像这样：

```
create table Items(SomeOtherTableID int,SomeField int)
create table SomeOtherTable(Id int,GroupID int)
with cte1 as
(
    select 
        SomeOtherTableID,COUNT(*) SubItemCount 
    from 
        Items t 
    where 
        t.SomeField is not null 
    group by 
        SomeOtherTableID

),cte2 as
(
    select
        tc.SomeOtherTableID,ROW_NUMBER() over (partition by a.GroupID order by tc.SubItemCount desc) SubItemRank
    from 
        Items t
        inner join SomeOtherTable a on a.Id=t.SomeOtherTableID 
        inner join cte1 tc on tc.SomeOtherTableID=t.SomeOtherTableID
    where 
        t.SomeField is not null 

),cte3 as
(
    select 
        SomeOtherTableID 
    from 
        cte2 
    where 
        SubItemRank=1
)
select 
    * 
from 
    cte3 t1 
    inner join cte3 t2 on t1.SomeOtherTableID<t2.SomeOtherTableID 
option (maxdop 1) 
```

该查询使得**cte3**填充了**6222个** *不同的*结果。在最后的**select**中，我在**cte3**上与其自身执行交叉连接（以便稍后我可以将表中的每个值与表中的每个其他值进行比较）。注意最后一行：

```
option (maxdop 1) 
```

显然，这会关闭并行性。

因此，在**cte3中有****6222**个结果行，我希望 (6222*6221)/2 或**19353531**在随后的交叉连接选择中产生结果，并且在最终的**maxdop**行到位的情况下，情况确实如此。

 ******但是，当我删除**maxdop**行时，结果数会跳转到**19380454**。我的开发盒上有 4 个内核。

怎么回事？谁能解释这是为什么？我是否需要重新考虑以前以这种方式交叉连接的查询？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-10T02:59:33.590

除了错误之外，并行性不应影响结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-10T09:25:22.287

看起来[SCOPE_IDENTITY](https://connect.microsoft.com/SQLServer/feedback/ViewFeedback.aspx?FeedbackID=328811)也有类似的平行错误

或者您是否也在使用[snaphot isolation](http://connect.microsoft.com/SQL/feedback/ViewFeedback.aspx?FeedbackID=384262)，另一个错误？还有一些博客展示了快照隔离在某些情况下被暂时关闭。

编辑：

回到快照隔离，这里的第 3 点：[你应该对并行性感到紧张的六个原因](https://sqlblog.org/2009/03/21/six-reasons-you-should-be-nervous-about-parallelism)

# testing - 如何验证 msbuild 创建的部署包？（最好使用 mstest 或 nunit）

> ID：844270
> 
> 赞同：0
> 
> 时间：2009-05-09T23:04:52.450
> 
> 标签：testing, continuous-integration, build-automation, automated-tests

我们的 msbuild 过程会创建各种用于部署的 zip 包（主要是网站，但也包括其他东西）。我们有各种反复出现的问题，这些问题一直在偷偷溜回来 - 包含不应该的文件，缺少资源。这需要自动验证。测试标准很简单

foosite 包的验证：

*   存在资源文件。
*   没有测试结果文件、obj 文件或其他构建工件
*   等等。

理想情况下，我可以使用每个人都熟悉的 nunit 或 mstest。Msbuild 知道包在哪里。我们有很多包，可能在不同的分支上同时构建。因此，包的位置和包的名称不是确定性的——所以测试不知道包在哪里。

**将 msbuild 信息提供给 mstest 或 nunit 的最简单方法是什么？**[这个问题](https://stackoverflow.com/questions/460775/passing-a-parameter-to-mstests-using-msbuild)的答案是一个可能的答案，但是，这个问题得到了架构建议而不是答案。我知道这不是单元测试，但无论如何，测试框架很方便。我可以创建一个 exe 来验证构建 - 但是为什么要在项目中添加几个小时呢？

**或者，您对自动验证构建包有更好的建议吗？**（MSI、拉链等）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T23:41:19.510

我最终做的是有一堆自定义的 MS 构建任务，这些任务在 Virtual Server 上启动虚拟机，将 MSI 复制到机器上，静默部署它，然后对其进行验证。我使用[PSExec](http://technet.microsoft.com/en-us/sysinternals/bb897553.aspx)启动 MSI。然后它可以使用[MSTest 命令行](http://msdn.microsoft.com/en-us/library/ms182489(VS.80).aspx)运行程序来使用 MSTest 并运行您的测试位。

这对您来说可能有点过头了，但是使用 VM 可以让您从头开始，并且不受之前在您的开发盒上安装的任何影响。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-10T00:30:02.590

如果您想要快速失败，例如单元测试，那么我建议您针对您的包创建单元测试。这样的测试将解压缩 .ZIP 包，并对内容运行一些断言。

您甚至可以对包使用一些 TDD 技术。例如，如果由于缺少特定文件而导致部署失败，则编写因文件丢失而失败的单元测试；更改构建以使文件存在；然后确保单元测试成功。

但总的来说，部署问题比这更广泛，我赞同[blowdart](https://stackoverflow.com/users/2525/blowdart)的建议。部署到一个或多个虚拟机中，然后在已部署的环境中运行自动化测试。这些测试不仅会测试简单的事情，比如在安装过程中是否返回了错误；他们还会检查 IIS 虚拟目录是否设置正确、属性和内容是否正确，以及网站是否基本运行。

我会使用几个不同的虚拟机来测试不同的部署场景：一个用于干净部署；一个用于从版本 .-1 升级，等等。可以为每个环境运行相同或类似的 IVT 测试。

即使您不能一次完成所有这些，本练习所涉及的思考过程也应该导致对您的部署环境的真正定义有一个更正式的定义。当您有机会在实际测试中体现此正式定义时，这将很有帮助。

# c# - 服务器端 Javascript (aspx.cs) 属性。添加代码以更改标签的文本

> ID：844275
> 
> 赞同：1
> 
> 时间：2009-05-09T23:06:45.490
> 
> 标签：c#, javascript, asp.net, attributes, onclick

我正在尝试通过在 page_load 事件中使用服务器端 JavaScript (onclick) 和 C# 来更改标签的文本。例如，我想写如下内容：

```
Label1.Attributes.Add("onclick", "Label2.text='new caption'") 
```

有谁知道这个的正确代码？另外，这种类型的代码指的是什么；它只是 C# 中的 JavaScript 或 JavaScript，还是有特定的名称？最后，是否存在列出用于 C# 的 control.attributes.add("event", "syntax") 代码选择的书籍或在线资源？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-09T23:25:57.423

没有服务器端 Javascript（除非您更改为实际使用 Javascript 作为服务器语言的 ASP.NET 以外的平台）。您正在做的是向 html 标签添加一个属性，并且代码将完全在客户端执行。

首先，让我们看看它是如何在没有服务器端代码和服务器端控件的情况下在 HTML 中完成的：

```
<span onclick="document.getElementById('Label2').innerHTML='Thank you';">Click me</span>
<span id="Label2"></span> 
```

要改用`Label`控件，从服务器端代码设置 onclick 属性，您可以这样做：

```
Label1.Attributes.Add("onclick", "document.getElementById('Label2').innerHTML='Thank you';"); 
```

只要控件不在命名容器内，这将起作用。如果是，控件的 id 会在容器名称前附加以保持它们的唯一性，因此您需要使用该`ClientID`属性来找出它们的最终 id 是什么：

```
Label1.Attributes.Add("onclick", "document.getElementById('" + Label2.ClientID + "').innerHTML='Thank you';"); 
```

始终包含可用于从 Javascript 访问元素的`ClientID`id，因此无论控件是否在命名容器中，最后一个代码始终有效。

要找出可以使用的属性，您应该查看 HTML 文档，例如用于[span 元素](http://msdn.microsoft.com/en-us/library/ms535895(VS.85).aspx)的 Internet Explorer 文档。在查看特定功能的文档时，请注意标准信息，因为它会告诉您它是否适用于任何浏览器或仅适用于 Internet Explorer。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T23:30:06.667

上面的代码将 JavaScript 添加到客户端上呈现的服务器控件。查看这篇 MSDN 文章 -[将 JavaScript 与 ASP.NET 一起使用以](http://msdn.microsoft.com/en-us/library/aa479011.aspx)了解更多信息。

IIRC，您需要`Label2`通过其 ClientID 进行引用，并且需要编写一些 JavaScript 来更改标签的文本值（我认为 ASP.NET 标签会呈现为`<span>`标签）。

# url - Django URLs - 如何通过干净的 URL 传递多个餐饮而不需要？

> ID：844276
> 
> 赞同：1
> 
> 时间：2009-05-09T23:07:08.280
> 
> 标签：url, post, seo, get, django-urls

我想远离 GET 参数。不想使用 POST，我至少有两个不同的类别来构建 URL。

首先要求访问者选择一个位置，例如：http: [//foo.com/United-States/](http://foo.com/United-States/) **||** [http://foo.com/United-States/California/](http://foo.com/United-States/California/) **||** [http://foo.com/United-States/California/San-Francisco-Region/](http://foo.com/United-States/California/San-Francisco-Region/) **||** [http://foo.com/United-States/California/San-Francisco/](http://foo.com/United-States/California/San-Francisco/)

选择位置后，他们可以选择一个类别，例如：

[http://foo.com/Electronics/](http://foo.com/Electronics/) **||** [http://foo.com/Electronics/Camera/](http://foo.com/Electronics/Camera/) **||** [http://foo.com/Electronics/Camera/Digital/](http://foo.com/Electronics/Camera/Digital/) **||** [http://foo.com/Electronics/Camera/Digital/SLR/](http://foo.com/Electronics/Camera/Digital/SLR/)

那么，一旦完成了位置和类别的选择，我将如何将上述两个 URL 合并为一个呢？

我可能需要传入页码进行分页。( [http://foo.com/page/2/](http://foo.com/page/2/) )

我想保持 URL 干净且不言自明。我知道如何一次处理一种类型的 URL，但不组合多种类型。

如果我要做一个 GET，那么我会做：[http://foo.com/?locid=23323&catid=335&page=2](http://foo.com/?locid=23323&catid=335&page=2)，但我喜欢利用 Django 的干净 URL 并远离 ?& 的东西。

谢谢，

VN44CA

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T23:36:33.217

我认为这将涉及 URL 中的许多信息。我假设任何位置都有其唯一 ID，类别也是如此。为什么不建立一个 URL：

[http://foo.com/United-States/Electronics/](http://foo.com/United-States/Electronics/)

[http://foo.com/California/Digital/](http://foo.com/California/Digital/)

[http://foo.com/San-Francisco/SLR/](http://foo.com/San-Francisco/SLR/)

等等...

在您的情况下，2 个参数就足够了。或者您可以更改类别名称以使其更有意义。

[http://foo.com/Electronics/Camera/Digital/](http://foo.com/Electronics/Camera/Digital/) => [http://foo.com/Digital-Cameras/](http://foo.com/Digital-Cameras/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-10T07:14:56.580

根据您使用位置数据的方式以及用户希望更改位置的频率，最好将其存储在会话中，而不是在 URL 中指定。

例如，我不太可能开始在旧金山寻找单反数码相机，然后去巴尔的摩寻找篮球。

但是，如果您想要任何位置类别组合的永久链接，显然这还不够。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T00:02:28.857

在考虑了一段时间之后，我发现（对我来说）最好的解决方案是让一个字符串在一个干净的 URL 中保存我需要的所有参数。

因此，当用户第一次访问**[http://foo.com/](http://foo.com/)**时，他们会看到一个可供选择的位置。此时 Cookie 为空。

因此，用户继续选择 United-State，URL 看起来像[http://foo.com/12334_0_0_0/United-States/](http://foo.com/12334_0_0_0/United-States/)，并且位置 cookie 设置为 1234，即位置美国的 id。

现在用户选择加利福尼亚并且 URL 更改为[http://foo.com/1235_0_0_0/United-States-California/](http://foo.com/1235_0_0_0/United-States-California/)并且 cookie 从美国替换为 1235，这是位置加利福尼亚的 id。此时用户选择电子产品类别。因此 URL 更改为[http://foo.com/1235_3333_0_0/Electronics/](http://foo.com/1235_3333_0_0/Electronics/)并且 3333 保存在类别 Cookie 中。

如果用户下拉到单反相机，那么他/她会看到[http://foo.com/1235_3344_0_0/SLR-Cameras/](http://foo.com/1235_3344_0_0/SLR-Cameras/)。

这样，URL 的第一部分最多可以跟踪 4 个可以传递的参数，并且名称（slugs）仅用于演示和 SEO。

我认为这行得通吗？将 URL 的 x_y_z_p 部分编码为一些随机文本并解码回参数和数字会很酷。

让我知道你的想法？

# algorithm - 您如何索引文件以进行快速搜索？

> ID：844277
> 
> 赞同：7
> 
> 时间：2009-05-09T23:07:14.940
> 
> 标签：algorithm, search, indexing

如今，微软和谷歌将索引您硬盘上的文件，以便您可以快速搜索它们的内容。

我想知道的是他们是怎么做到的？你能描述一下算法吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-09T23:43:36.400

最简单的情况是倒排索引。

最基本的算法很简单：

*   扫描文件中的单词，创建唯一单词列表
*   规范化和过滤单词
*   在索引中放置一个将该词与文件联系起来的条目

细节是事情变得棘手的地方，但基本原理是相同的。

通过“规范化和过滤”单词，我的意思是将所有内容转换为小写，删除常见的“停用词”（the、if、in、a 等），可能是“词干”（删除动词和复数的常见后缀等）。

之后，您将获得该文件的唯一单词列表，您可以根据该列表构建索引。

有减少存储的优化，检查单词位置的技术（例如，文档中的“this”接近“that”）。

但是，这是它完成的基本方式。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-09T23:44:14.587

这是一个非常基本的描述；有关更多详细信息，您可以阅读这本教科书（免费在线）：http: [//informationretrieval.org/](http://informationretrieval.org/) ¹

1）。对于所有文件，创建一个索引。该索引包含数据集中出现的所有唯一词（称为“语料库”）。对于每个单词，都会关联一个文档 ID 列表；每个文档 id 指的是包含该单词的文档。

变体：有时当您生成索引时，您想忽略停用词（“a”、“the”等）。不过，您必须小心（“to be or not to be”是一个由停用词组成的真实查询）。

有时你也会阻止这些词。这对在更大程度上使用后缀和前缀的非英语语言的搜索质量有更大的影响。

2）当用户输入查询时，查找对应的列表，并合并它们。如果它是一个严格的布尔查询，这个过程非常简单——对于 AND，一个 docid 必须出现在所有单词列表中，对于 OR，至少在一个单词列表中，等等。

3) 如果你想对你的结果进行排名，有很多方法可以做到这一点，但基本思想是使用一个单词在文档中出现的频率，与你期望它在任何文档中出现的频率相比语料库中的文档，作为该文档或多或少相关的信号。见教科书。

4）您还可以存储单词位置以推断短语等。

其中大部分与桌面搜索无关，因为您对召回（包含该术语的所有文档）比排名更感兴趣。

* * *

¹ 以前在[http://www-csli.stanford.edu/~hinrich/information-retrieval-book.html](http://www-csli.stanford.edu/~hinrich/information-retrieval-book.html)上，可通过回程机访问

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-09T23:32:37.407

你总是可以研究像[Apache Lucene](http://lucene.apache.org/java/docs/)这样的东西。

Apache Lucene 是一个完全用 Java 编写的高性能、全功能的文本搜索引擎库。它是一种适用于几乎所有需要全文搜索的应用程序的技术，尤其是跨平台的应用程序。

# graph-theory - 平面图

> ID：844278
> 
> 赞同：0
> 
> 时间：2009-05-09T23:07:42.180
> 
> 标签：graph-theory

我有一个带有节点和边的[平面图](http://en.wikipedia.org/wiki/Planar_graph)，将平原切成部分。`n``e``s`

作为and和`s`的函数的上限是多少？`n``e``e/n`

我试图找出我可以依靠一些代码使用的内存有多少。

* * *

很容易证明它`e`不超过`n*(n-1)/2`，但我有一种感觉，它将是一个小整数。对于`n ~= 10`我有固定节点位置的情况，这将限制高估了 2 倍。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-09T23:10:47.833

你应该看看这里 [http://en.wikipedia.org/wiki/Euler_characteristic](http://en.wikipedia.org/wiki/Euler_characteristic) 可能会有所帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T21:22:18.520

可以通过归纳证明 e <= 3*n - 6。所以 e/n < 3 和所以 s/n < 2。

# objective-c - 如何将自定义图像上传到 iPhone SDK 中的标签栏？

> ID：844296
> 
> 赞同：2
> 
> 时间：2009-05-09T23:17:47.037
> 
> 标签：objective-c, iphone, cocoa, image

如何将自定义图像上传到 iPhone SDK 中的标签栏？

我上传了一张图片，将其添加到资源中，并尝试使其成为标签栏项目的图片。这就是发生的事情：

[http://www.mediafire.com/download.php?tmn1xtnmjhz](http://www.mediafire.com/download.php?tmn1xtnmjhz)

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-09T23:36:30.847

标签栏图标应该是 .png 文件，大约 30px 正方形，并且应该是 24 位的，带有 alpha 通道。您所做的就是使图像完全透明，除了您想要显示为图标的部分。

你可以在这里看到一些例子：http: [//glyphish.com/](http://glyphish.com/)

# c# - WPF - 列表框背景颜色 - CodeBehind

> ID：844312
> 
> 赞同：1
> 
> 时间：2009-05-09T23:24:24.307
> 
> 标签：c#, wpf, listbox, styles

我正在尝试为代码中的列表框设置背景颜色。我可以让它与列表框项目一起使用，但不是列表框本身。

这是有效的代码（使用 ListBoxItem）：

```
 private void SetBackgroundGradient()
    {
        var styleListBox = new Style(typeof(ListBoxItem));

        var myBrush = new LinearGradientBrush();
        myBrush.GradientStops.Add(new GradientStop(Color.FromArgb(255, 0, 0, 0), 0.0));
        myBrush.GradientStops.Add(new GradientStop(Color.FromArgb(255, 255, 255, 255), 1.0));

        styleListBox.Setters.Add(new Setter
        {
            Property = BackgroundProperty,
            Value = myBrush
        });

        lstTopics.ItemContainerStyle = styleListBox;
    } 
```

现在，如果我更改代码以尝试使用 ListBox 本身，我得到的只是白色背景。这是代码：

```
private void SetBackgroundGradient()
    {
        var styleListBox = new Style(typeof(ListBox));

        var myBrush = new LinearGradientBrush();
        myBrush.GradientStops.Add(new GradientStop(Color.FromArgb(255, 0, 0, 0), 0.0));
        myBrush.GradientStops.Add(new GradientStop(Color.FromArgb(255, 255, 255, 255), 1.0));

        styleListBox.Setters.Add(new Setter
        {
            Property = BackgroundProperty,
            Value = myBrush
        });

        lstTopics.Style = styleListBox;
    } 
```

知道我可能做错了什么吗？

如果您需要对我的要求进行任何澄清，请告诉我。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-10T03:16:01.397

我解决了我自己的问题。这是由于我自己的错误。

我在 ListBox 属性中有以下内容：

背景="{x:Null}"

我不知道那是怎么到那里的。可能以某种方式默认设置。

嗯，解决了。上面的代码有效。您可以通过代码将列表框的背景设置为渐变，只要您没有设置 Background = null :)

谢谢

# jfreechart - JfreeChart 中的鼠标事件

> ID：844318
> 
> 赞同：0
> 
> 时间：2009-05-09T23:26:27.063
> 
> 标签：jfreechart

我需要一种方法来区分鼠标事件何时发生在图表本身而不是图表面板（绘图区域）中。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-30T14:05:36.297

您应该能够使用面板中的鼠标事件并使用它`ChartMouseEvent.getEntity()`来查找您的图表是否在图表实体之一之上。请参阅[ChartMouseEvent](http://www.jfree.org/jfreechart/api/javadoc/org/jfree/chart/ChartMouseEvent.html)的 api 文档。

# c - 是否有一个真正安全的 C 格式库？

> ID：844319
> 
> 赞同：2
> 
> 时间：2009-05-09T23:27:24.440
> 
> 标签：c, formatting, string-formatting

牢记关于*[更安全](https://stackoverflow.com/questions/486383/safer-alternatives-to-the-c-standard-library)*的 C 格式库的问题的答案，我想知道是否有**安全**的C 格式库？

我的意思是：

*   不可能与参数中的格式字符串不匹配
*   传递错误的类型不会导致崩溃
*   没有平台相关的方面

请不要回答有关[Microsoft Safe String Library](http://msdn.microsoft.com/en-us/library/8ef0s5kh.aspx)或不太*安全*但仍不完全安全的库，因为我知道这些，它们不满足完全安全的要求。

提前致谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-09T23:50:28.597

您正在用 C 编写。C 不是类型安全的。如果传递 a`int*`而不是 a ，则无法避免未定义的行为`char*`。如果您的变量没有经过静态类型检查/标记以进行运行时检查，则没有“不可能”之类的事情。

如果你有一些会产生警告的东西，那已经很好了......

如果你真的*需要*或想要安全，你可能想看看[旋风](http://cyclone.thelanguage.org/)（C 方言），或一些完全不同的语言。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-09T23:56:19.100

> 不可能与参数中的格式字符串不匹配

如果你想要一个格式字符串，没有特殊的编译器支持，你基本上是做不到的。也就是说，如果您放弃格式字符串，您可以在 C 中拥有一个安全的格式库。我不知道，但如果它们存在，我不会感到惊讶。

一个可以有一个像这样的界面：

```
typedef ... FORMATTER;

FORMATTER create_formatter();
int fmt_add_string_default(FORMATTER f, const char *s);
int fmt_add_string(FORMATTER f, const char *s, int maxlength, const char fill, enum fmt_alignment align);
...
int fmt_add_decimal_default(FORMATTER f, int d);
... // you get the idea
int fmt_write_result(FORMATTER f, char *out, int out_length);
void destroy_formatter(FORMATTER f); 
```

如果有点冗长，这样的事情将是完全安全的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-10T00:38:22.647

不，因为您介绍的任何“安全性”都可以被语言所取代。这就像在沙子上建造你的城堡——不管城堡有多好，如果你从它下面挖出沙子，它仍然可以倒塌。

C 中没有强制执行特定参数类型的机制，也不应该有。

If people don't use your tools as they're meant to, that's their own problem, in my opinion. You're not supposed to be providing software to three-year-olds - they're expected to have some modicum of intelligence.

# ruby-on-rails - Rails：如何让复杂的应用保持 RESTful？

> ID：844334
> 
> 赞同：1
> 
> 时间：2009-05-09T23:37:01.593
> 
> 标签：ruby-on-rails, ruby

我总是尝试使我的应用程序尽可能地 RESTful，但我最近开始处理一个复杂的项目，该项目需要在我的控制器中使用多种附加方法。

我通常通过在路由中添加另一个 :collection 来实现这一点，但这似乎是一种解决方法，在场景中我有 5 个。

是否有任何最佳实践来处理控制器中的额外方法？它们通常是更新模型的简单形式。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-10T04:37:32.200

我所做的另一个解决方案是，每次您发现自己创建了一个不适合 RESTful 操作的操作时，例如搜索，因此您可能会发现自己在文章控制器上进行搜索操作，您可以做什么与其创建此操作，不如创建一个搜索控制器，并在其中使用 RESTful 操作。没有规则说您需要使用所有操作，您可能只需要一两个，但它使您的 API RESTful 和您的代码井井有条。

这不是一个硬性规定，但当我试图决定把东西放在哪里时，我确实发现它很有帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-10T16:04:31.320

我认为 Rails 社区对于如何以及在何处使用“RESTful”这个词有些困惑。严格来说，唯一可以是 RESTful 的是您的**Web API**（正如 railsninja 已经提到的）。符合 REST 约定的应用程序（具有 REST API 的应用程序）的代码通常可以组织成一组控制器（匹配资源）和这些控制器中的方法（匹配 HTTP 协议的四个动词）只不过是关于如何保持应用程序整洁有序的提示。

如果我们想谈论 RESTful Rails 应用程序，我们不能只谈论 RESTful 控制器 - 仅控制器本身就没有 RESTful。一个复杂的 Web 应用程序可能只有一个控制器（和无数方法），它代表许多资源并且完全是 RESTful。

也就是说，向控制器添加更多方法是相当不错的。有时，提取其中一些额外的方法并创建一个全新的控制器是很好的——只要你觉得它好就做这个（经验法则：只要你能够用一些自给自足的资源识别它，就创建新的控制器，即，可以单独存在的资源）。但有时，将一些资源提取到不同的控制器是很愚蠢的。假设您有一个具有状态属性的资源。将此状态属性本身视为资源并对其执行至少一个操作（更新）是有意义的，但将其提取到不同的控制器不会有任何好处。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-09T23:45:12.917

有一个[关于此主题的 Railscast](http://railscasts.com/episodes/35-custom-rest-actions)，将自定义操作添加到其他 RESTful 控制器。

编辑：我看到你已经提到 Railscast 中的方法是一种解决方法。:-) 我相信处理它的唯一其他“纯”方法是根据需要添加额外的控制器来支持您想要的操作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-10T03:12:26.117

“我通常通过在路由中添加另一个 :collection 来实现这一点，但这似乎是一种解决方法，在场景中我有 5 个。”

这对我来说听起来很好。REST 与 crud 操作无关，您的担忧似乎源于您所做的不仅仅是基本的 crud 操作，但这并没有错。

# hibernate - 帮助解决休眠映射问题...请引导！:)

> ID：844339
> 
> 赞同：0
> 
> 时间：2009-05-09T23:39:47.670
> 
> 标签：hibernate, inheritance, mapping

好的，所以我已经撕毁了我的东西并正在重建它，这就是我需要做的。

我有一个名为 Property 的实体：

字符串名称；

@ManyToOne EntityType 类型；

？？？？？？价值

我也需要存储一个值，但根据类型，该值可以是字符串、双精度值或指向另一个对象的链接（Class type.getJavaClass()）。

I tried to do this with inheritance all sorts of ways but still need to be able to do new Property() and have it set the value to null until a Type gets selected, when the appropriate kind of Type gets selected.

最漂亮的是让 Value 为 Object 类型（这样我可以在其中放置 String、Double 或 type.getJavaClass()，但 hibernate 不会让我这样做。:(

任何关于实现这一目标的好方法的想法或建议将不胜感激！谢谢，约书亚

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-11T17:47:21.043

问题是 Hibernate 需要能够将其映射到数据库，因此 Object 类型并不能真正起作用。

我建议您将值设为 String 类型。然后包装“get”和“set”调用，以便最终调用者不知道。例如：

```
public class Property
{

String name;

Enum Type;
String valueString;

public object getValue()
{
    if( getType() == Long )
    {

    return Long.valueOf( getStringValue() );
    }

    if( getType() == String )
    {
        return valueString;
    }

    .....

}

public void setValue( obj )
{
    if( obj instanceof Long )
    {
    setStringValue( obj.toString() )
        setType( Long ) 
    }
    ....

}

} 
```

至于指向另一个对象的链接，由于您的意思是指向另一个表的链接？在这种情况下，我可能会为每个表创建一个单独的列，这样您就可以让数据库保持参照完整性。然后你可以增强 getValue() ， setValue() 来获得适当的实体。

# javascript - 通过 HTTP 回调函数进行谷歌地理编码？

> ID：844341
> 
> 赞同：6
> 
> 时间：2009-05-09T23:42:40.317
> 
> 标签：javascript, ajax, callback, geocoding

我想**通过 HTTP**功能使用谷歌地理编码将城市名称转换为我的 AJAX Web 应用程序的经度和纬度。

但是，HTTP 地理编码器功能似乎不存在回调函数

[http://code.google.com/apis/maps/documentation/geocoding/index.html](http://code.google.com/apis/maps/documentation/geocoding/index.html)

是这样吗，不存在回调函数？

*因为如果这是真的，它本质上意味着通过 HTTP api 的 Google 地理编码在与 AJAX 一起使用时是无用的，因为 JavaScript 会引发跨域异常错误。*

关于如何在 JavaScript 中的 AJAX Web 应用程序中通过 HTTP api 使用地理编码的任何想法？

**注意**：我**不想**使用大约 200kb 下载的完整 Google Maps API（即 GClientGeocoder）。我想使用 HTTP api b/c，因为它具有超快的响应能力，并且不需要我的网络用户下载巨大的完整的交互式谷歌地图 api。

例如 [http://maps.google.com/maps/geo?output=json&sensor=false&key=](http://maps.google.com/maps/geo?output=json&sensor=false&key=) {API_KEY}&q={CITY,STATE}&CALLBACK=????

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-09T23:47:44.937

嗯....我认为您必须将 AJAX 回调到您自己的服务器，然后从您的服务器调用 Google 的地理编码。

这就是我进行 AJAX 地理编码的方式，这一切都通过我的 ASP.NET 代码进行。

编辑：

在 ASP.NET webforms 环境中，我可能将其实现为轻量级 ASHX 文件，但为了简单起见，这里有一个 ASPX 示例：

```
public partial class GoogleHandler : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e) {
        Response.Write(GetGoogleXML("http://pseudo_googlegeocode?parameter=" + parametersFromQuerystring);
    }
} 
```

在上面的示例中，.NET 页面仅传递请求。

但在真实环境中，我宁愿我的 .NET 代码做的不仅仅是传递数据。通过这种方式，我可以在将数据发送到客户端之前，在服务器上进行所有的错误处理、过滤、验证、业务逻辑。

此外，这允许更大的抽象。即，我可能会从谷歌更改为雅虎地理编码。通过这种方式，我只需要更改我的服务逻辑，让客户端只接收一组通用的坐标/位置数据。

此外，使用这种抽象，我实际上可以聚合来自各种地理编码数据源的多个数据。同样，服务器负责聚合，客户端只接收并显示过滤后的数据。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-10T00:44:33.163

这是一个使用 Google Maps Geocoder 的示例。地理编码器函数 getLocation 将回调函数作为第二个参数。

```
function findAddress(street, city, state, zip) {
  var address = [
    street,
    city.toLowerCase(),
    state.toLowerCase(),
    zip
  ].join(', ');

  if (!geocoder) {
    geocoder = new GClientGeocoder();
  }

  if (geocoder) {
    geocoder.getLocations(
      address,
      function(result) {
        var dialog, len, point;
        if (result.Status.code != G_GEO_SUCCESS) {
          alert("Error: "+result.Status.code)
        } else {
          len = result.Placemark.length;
          if (len > 1) {
            alert("Multiple matches were found.  I'll leave it as an exercise to handle this condition");
          } else {
            point = new GLatLng(
              result.Placemark[0].Point.coordinates[1],
              result.Placemark[0].Point.coordinates[0]
            );
          }
        }
      }
    );
  }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-10T00:53:09.273

正如其他人指出的那样，您没有阅读整页。您想要该页面称为[JavaScript Client Geocode](http://code.google.com/apis/maps/documentation/services.html#Geocoding)的内容。

这是我不久前编写的脚本的简化版本。它还使用 Google Map 控件，但请随意忽略它。延迟函数 hack 是因为当我访问他们的服务器太快时，谷歌似乎偶尔会返回 null。我不知道这是否仍然是一个问题，所以除非必须，否则不要放入。

```
<script type="text/javascript">

    //<![CDATA[

    var freezeLocations;
    var coder;
    var map;

    function load() {
      if (GBrowserIsCompatible()) {
        map = new GMap2(document.getElementById("map"));
        map.setCenter(new GLatLng(38.479395, -98.349609), 4);
        map.addControl(new GLargeMapControl());
      }

      coder = new GClientGeocoder();

      missionLocations = new Array();
      missionLocationsDelayed = new Array();
      addMissionLocation("Atlanta, Georgia", "http://improveverywhere.ning.com/group/atlanta");
      //etc.
    }

    function addMissionLocation(newLocation, url)
    {
        var successful = false;
        var counter = 0;

        while(!successful && counter < 3)
        {
            coder.getLatLng(
                newLocation,
                function(point) {
                    if (!point) {
                        //alert(newLocation + " not found");
                        successful = false;
                    } else {
                        missionLocations.push(new GMarker(point, { title:newLocation}));
                        //alert(missionLocations.length);
                        map.addOverlay(missionLocations[missionLocations.length - 1]);
                        missionLocations[missionLocations.length - 1].bindInfoWindowHtml("<a href='" + url + "'>" + newLocation + "</a>");
                        successful = true;
                    }
                }
            );

            if(!successful)
            {
                delayGeocode();
            }

            counter++;
        }
    }

    function delayGeocode()
    {
        for(var i = 0; i < 2000000; i++)
        {
        }
    }

    //]]>
    </script> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-10T04:52:06.033

您可以使用我的博客文章[http://jawtek.blogspot.com/2009/03/unwritten-guide-to-yahoo-query-langauge.html中概述的 Yahoo Query 语言](http://jawtek.blogspot.com/2009/03/unwritten-guide-to-yahoo-query-langauge.html)

您将能够使用如下 yql 语句：

```
`select * from json where
  url="http://maps.google.com/maps/geo?output=json&sensor=false&q=Indianapolis,In"`
```

`[然后，您将使用 src http://query.yahooapis.com/v1/public/yql?q=](http://query.yahooapis.com/v1/public/yql?q=) {your yql here}为您的 html 添加一个脚本标签（可以使用 document.createElement('script') 完成）&format=json&callback={your function here} 其中 {your yql here} 被替换为 yql 语句的 URI 编码版本。`

 `* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-08T00:52:53.940

> 如果您查看了文档但没有找到它，而 Andrew 和 Mike 都没有说“是”，并告诉您如何去做，我怀疑您有答案。

哈哈

并让所有人阅读服务的文档：

> 10.13 在使用服务时向 Google 隐藏或掩盖您的服务的身份，包括不遵守 Maps API 文档中列出的标识约定；或 10.14 违反 Maps API 文档中的任何政策或违反 Google 的软件原则 (...)
> 
> 还
> 
> 该服务设计用于使用 REST 接口对静态（已知）地址进行地理编码，用于在地图上放置应用程序内容。对于用户定义地址的动态地理编码（例如，在用户界面元素中），请参阅 JavaScript 客户端地理编码器或 Flash 客户端地理编码器的 Maps API 的文档。地理编码是一项时间和资源密集型任务。尽可能对已知地址进行预地理编码（使用此处描述的地理编码服务或其他地理编码服务），并将结果存储在您自己设计的临时缓存中。

但话又说回来，您可以尝试[Google Maps API V3 Geocoder](http://code.google.com/apis/maps/documentation/v3/reference.html#Geocoder)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-09T23:55:41.907

查看谷歌地图 API。它有一些回调函数，使用它的地理编码服务。

[http://code.google.com/apis/maps/documentation/reference.html#GClientGeocoder.getLatLng](http://code.google.com/apis/maps/documentation/reference.html#GClientGeocoder.getLatLng)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-09-23T17:33:34.983

我也遇到了你上面描述的挑战。正如您所指出的，Google 阻止了对 Geocode API URL 的跨域 HTTP 访问：

*   [同源政策](http://en.wikipedia.org/wiki/Same_origin_policy)
*   [JSONP 和 Google Maps API 地理编码器 - 不是错误](http://blog.mikecouturier.com/2009/11/jsonp-and-google-maps-api-geocoder-not.html)

在使用客户端脚本时，这确实严重降低了它的实用性。我发现这个挑战的唯一解决方案是创建一个服务器端代理服务，它将来自 Google Maps Geocode API 的响应中继到我的客户端脚本。

[我写了一篇非常冗长的博客文章来描述这个过程。](http://www.telnet80.com/2010/09/doing-client-side-address-validation.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-11T20:32:32.053

我支持创建服务器端页面以访问地理编码器的建议。我正在做类似的事情，效果很好。[这里](http://code.google.com/support/bin/answer.py?answer=80200&topic=11364)有一篇关于在 PHP 中使用地理编码器的好文章。

另请注意，从技术上讲，[您不得](http://code.google.com/apis/maps/terms.html#section_10_12)使用 Google 的地理编码器，除非您将在 Google 地图上显示数据——但我不知道他们是否真的会检查您。

# social-networking - 设置公告板

> ID：844344
> 
> 赞同：0
> 
> 时间：2009-05-09T23:43:15.340
> 
> 标签：social-networking

我想在我的网站上添加一个“社区”部分（公告板），以便每个人都可以交流，但我不知道我在做什么。

我将如何添加它以及哪一个提供最多的文档和支持？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-10T01:23:54.007

无论您做什么，请确保您阅读了有关配置讨论软件的说明，以保护您和您的社区免受互联网上最糟糕的部分：垃圾邮件、欺骗和滥用。

确保立即更改安装随附的管理员密码。

如果您让您的社区对各种发布、收获和一般滥用行为敞开大门，您将整天与成千上万的白痴玩打地鼠游戏。制定您可接受的使用政策，配置您的电路板以支持它，然后执行它。

如果您正在查看的软件不支持电子邮件验证、审核、滥用报告、反垃圾邮件控制等功能，请继续查看。

准备好花时间管理您的社区，以免它成为数以百万计的网络论坛中的另一个，其中充斥着使人们远离您的网站的离题帖子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T23:48:09.837

我认为你需要的是一个论坛软件，网上有很多免费和开源的。DotNetNuke 是一个 .NET，但托管成本可能很高，而 phpBB 是另一种流行的选择，并且有很多便宜的托管解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T23:53:23.303

[这](http://www.phpbb.com/)就是你需要的。编辑：他们不在那里提供托管版本。您可以改用[它](http://pro-forums.com/)。它托管在自己的网站上，免费，不需要下载。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-09T23:54:46.887

你的网站是基于 php/mysql 还是 asp/sql？如果您甚至不知道在哪里可以找到表格，那么您可能无法找到您真正想要的东西。

但是，如果是 php/mysql，我推荐[Cool Php Scripts](http://www.amazon.ca/Wicked-Cool-PHP-Real-World-Difficult/dp/1593271735)书。它涵盖了创建某种社区论坛/留言板。

正如我再次说过的，你可能不会独自完成，至少，没有漫长的令人沮丧的学习曲线。

您总是可以发布一份工作，有人会非常愿意在 elance 或 Rentacoder 或您选择的任何其他网站上出价

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-10T00:12:16.050

维基百科有[一大堆论坛软件](http://en.wikipedia.org/wiki/Comparison_of_Internet_forum_software)。选择与您熟悉的编程语言、您需要的功能等最匹配的一种。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-11T04:28:31.307

出于美观和可扩展性的原因，我发现[Vanilla是一个比 phpBB 更好的论坛应用程序。](http://getvanilla.com/)我没有在需要许多子论坛的情况下看到/使用它，因此根据您的范围，它可能不是正确的选择，但对于中小型论坛，我建议先尝试一下。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-11-03T11:55:14.927

首先，您需要选择符合您要求的论坛软件。

然后，只需按照您选择的软件提供的安装指南进行操作即可。

[论坛软件评论](http://www.forum-software.org)中的更多信息

# jquery - 如何自定义主题 jquery UI 选项卡（不使用 themeroller）

> ID：844362
> 
> 赞同：1
> 
> 时间：2009-05-09T23:53:00.667
> 
> 标签：jquery, themes, jquery-ui-tabs

我知道您可以使用 themeroller 来自定义您的 UI 主题，但是否可以手动完成。如果是，那么您是否必须遵循任何特定的 CSS。谢谢你

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-16T21:11:54.430

当我遇到 Kieth Wood 的网站时，我正在寻找相同的答案：http: [//keith-wood.name/uiTabs.html#tabs-min](http://keith-wood.name/uiTabs.html#tabs-min)

你会发现他记录了几个选项，但*极简主义选项卡*是我开始的好地方。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-09T23:59:08.483

你在 jquery-ui css 文件中有

：[http ://ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/ui-lightness/jquery-ui.css](http://ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/ui-lightness/jquery-ui.css)

```
>     /* Tabs ----------------------------------*/
>     .ui-tabs { padding: .2em; zoom: 1; }
>     .ui-tabs .ui-tabs-nav { list-style: none; position: relative;
> padding: .2em .2em 0; }
>     .ui-tabs .ui-tabs-nav li { position: relative; float: left;
> border-bottom-width: 0 !important;
> margin: 0 .2em -1px 0; padding: 0; }
>     .ui-tabs .ui-tabs-nav li a { float: left; text-decoration: none;
> padding: .5em 1em; }
>     .ui-tabs .ui-tabs-nav li.ui-tabs-selected { padding-bottom:
> 1px; border-bottom-width: 0; }
>     .ui-tabs .ui-tabs-nav li.ui-tabs-selected a, .ui-tabs
> .ui-tabs-nav li.ui-state-disabled a,
> .ui-tabs .ui-tabs-nav
> li.ui-state-processing a { cursor:
> text; }
>     .ui-tabs .ui-tabs-nav li a, .ui-tabs.ui-tabs-collapsible
> .ui-tabs-nav li.ui-tabs-selected a {
> cursor: pointer; } /* first selector
> in group seems obsolete, but required
> to overcome bug in Opera applying
> cursor: text overall if defined
> elsewhere... */
>     .ui-tabs .ui-tabs-panel { padding: 1em 1.4em; display: block;
> border-width: 0; background: none; }
>     .ui-tabs .ui-tabs-hide { display: none !important; } 
```

但是，需要的是 .ui-tabs .ui-tabs-hide { display: none; } 来自[http://jqueryui.com/demos/tabs/](http://jqueryui.com/demos/tabs/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-10T00:00:51.380

当然这是可能的（因为最终主题只是 CSS、图像和可能的 Javascript），但它不是很实用。您可以采用现有主题并对其进行修改。事情是有很多图像文件和你需要更改的类似文件。此外，许多这些文件的名称对应于颜色或其他相关变量。

这实际上非常聪明，因为这意味着您可以在 CSS 和图像上放置一个遥远的未来 Expires 标头，并且如果您更改主题，它仍然会正确更新。

因此，您可以保持文件名相同，但是如果您使用远期 Expires 标头（您应该这样做），那么您就会遇到问题，而且它会让其他看到它的人感到困惑。或者您必须更新所有这些文件和所有参考。

Themeroller 更简单。

# objective-c - 将浮点数转换为 NSDate

> ID：844367
> 
> 赞同：3
> 
> 时间：2009-05-09T23:54:06.890
> 
> 标签：objective-c, nsdate

我想将浮点数转换为 NSDate

我使用以下方法将 NSDate 转换为浮点数：

```
// Turn the date into Integers 
NSCalendar *calendar= [[NSCalendar alloc] initWithCalendarIdentifier:NSGregorianCalendar];  
NSCalendarUnit unitFlags = NSHourCalendarUnit | NSMinuteCalendarUnit | NSSecondCalendarUnit;  
NSDateComponents *dateComponents = [calendar components:unitFlags fromDate:nsdate_wakeTime];  
NSInteger hour = [dateComponents hour];  
NSInteger min = [dateComponents minute];  

//Convert the time in 24:60 to x.x format.
float myTime = hour + min/60; 
```

在我对 mytime 变量进行一些数学运算之后，我得到了许多其他时间相同的浮点格式。

如何将浮点数变成 NSDate？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T03:52:55.220

如果您将计算的时间转换为秒（因此，mytime * 60），那么您可以`dateWithTimeIntervalSinceReferenceDate:`使用`NSDate`. 根据您所做的数学计算，此处引用的日期似乎是相关日期的 00:00。正如 Jason 所提到的，可能有更好的方法来完成您想要完成的工作。

此外，如果您真的想要分钟，您需要将“myTime”计算更改为除以 60.0；您的示例代码将小于 60 的整数值除以整数值 60，该整数值始终为 0。

# olap - BI 与数据挖掘有何关联？

> ID：844376
> 
> 赞同：6
> 
> 时间：2009-05-09T23:59:57.810
> 
> 标签：olap, business-intelligence, data-mining

我对如何将 BI 与数据挖掘联系起来有点困惑。BI可以被称为数据挖掘的某种表现形式吗？

Microsoft Analysis Services 等 BI 工具与 Weka 等数据挖掘工具有何不同？

我猜BI涉及更多的数据报告和分析，其中数据经过某种聚合并以多维数据集的形式表示，但数据挖掘还涉及执行聚类的不同算法，不是吗？

任何指针？

干杯

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-10T00:11:52.853

BI small 正在生成详细报告（今天的销售列表）。涉及的数学很少，可能会计算行数和汇总销售额。在这里您可以看到称为“BI”的报告工具

BI 媒介正在生成一个指标（本季度的利润率）。这只是简单的代数，但由于数据量巨大，频繁生成它是一项挑战。这是立方体和 olap 的世界。

BI large 正在做数学建模。这可能是从线性回归到统计模型的任何东西，你可以命名它。这里的关键是模型使用大量数据。真正的统计学家在贬义上使用“数据挖掘”一词，因为未经训练使用统计数据的人可能会挖掘数据，直到他们发现虚假的相关性。你的数据集越大，你就越有可能找到偶然的关系，而不是现实中真的存在这样的关系。

因为 BI 的客户是业务经理，而不是博士研究生，微软等供应商。通过为我们提供黑匣子“数据挖掘”工具来简化它，其中许多与您在 SAS 等中找到的相同。

我看到将所有这些 BI 应用程序联系起来的唯一一点是，它们都在使用大量数据来做出业务决策。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-12T15:11:29.840

要回答您的一般问题“商业智能是数据挖掘的一种表现”，实际上是相反的。

在一般定义中，BI 是使用您公司的数据来了解您的市场状况并做出决策。因此，正如 MatthewMartin 所说，它可以像 SSRS 报告一样简单，也可以像实时决策支持/人工智能系统一样复杂。

数据挖掘是 BI 的一个方面，因为数据挖掘可用于大量数据，使用实现聚类、神经网络等算法的工具进行知识发现和预测。

# visual-studio-2008 - 在 VS.NET 2008 中取消映射 TT 文件？

> ID：844379
> 
> 赞同：0
> 
> 时间：2009-05-10T00:01:18.073
> 
> 标签：visual-studio-2008, t4

有没有办法在 Studio 中取消映射 .tt 文件？

每次我创建或编辑一个时，它都会警告我执行它们，然后为它创建一个 .cs 文件。

问题是我的 .tt 文件完全不同。它们是来自 Perl 项目的模板工具包文件，它们的标准扩展名为 .tt

我已经尝试将扩展映射从 tt 添加到文本编辑器，但我仍然在这个项目中得到了不需要的行为。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-10T02:09:36.970

可以在工具->选项，“文本模板”中修复警告。

我不相信有可能阻止“映射”发生，但可以撤消它。选择其中一个 .tt 文件后，按 F4 键查看“属性”网格。您会看到“自定义工具”属性设置为“TextTemplatingFileGenerator”。清除该字段，您会发现 .cs 文件消失了。

# wpf - WPF 主题是否可用于包含可在运行时更改的应用程序的多个皮肤？

> ID：844388
> 
> 赞同：12
> 
> 时间：2009-05-10T00:11:20.093
> 
> 标签：wpf, styles, themes, controltemplate, skins

WPF 允许控件库为不同的系统主题提供不同的资源字典，本质上允许应用程序匹配操作系统选择的视觉主题（Aero、Luna 等）。

我想知道是否可以在我的应用程序中包含多个主题资源字典并在框架内利用一些现有的主题支持。这应该适用于我自己的主题名称，并且理想情况下允许用户更改主题，从而在运行时更改应用程序的皮肤外观。即使这只是一个配置设置，它仍然可能很有趣。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-10T03:50:59.953

这是我在支持主题的应用程序中使用的代码片段。在此示例中，我有两个主题（默认和经典 XP）。主题资源分别存储在 DefaultTheme.xaml 和 ClassicTheme.xaml 中。

这是我的 App.xaml 中的默认代码

```
<Application ...>
    <Application.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="ArtworkResources.xaml" />
                <ResourceDictionary Source="DefaultTheme.xaml" />
            </ResourceDictionary.MergedDictionaries>

            <Style x:Key="SwooshButton" TargetType="ButtonBase">
                <!-- style setters -->
            </Style>

            <!-- more global styles -->
        </ResourceDictionary>
    </Application.Resources>
</Application> 
```

然后在 App.xaml 后面的代码中，我有以下方法来允许更改主题。基本上，您所做的是清除资源字典，然后使用新主题重新加载字典。

```
 private Themes _currentTheme = Themes.Default;
    public Themes CurrentTheme
    {
        get { return _currentTheme; }
        set { _currentTheme = value; }
    }

    public void ChangeTheme(Themes theme)
    {
        if (theme != _currentTheme)
        {
            _currentTheme = theme;
            switch (theme)
            {
                default:
                case Themes.Default:
                    this.Resources.MergedDictionaries.Clear();
                    AddResourceDictionary("ArtworkResources.xaml");
                    AddResourceDictionary("DefaultTheme.xaml");
                    break;
                case Themes.Classic:
                    this.Resources.MergedDictionaries.Clear();
                    AddResourceDictionary("ArtworkResources.xaml");
                    AddResourceDictionary("ClassicTheme.xaml");
                    break;
            }
        }
    }

    void AddResourceDictionary(string source)
    {
        ResourceDictionary resourceDictionary = Application.LoadComponent(new Uri(source, UriKind.Relative)) as ResourceDictionary;
        this.Resources.MergedDictionaries.Add(resourceDictionary);
    } 
```

使用这种方法您还需要记住的是，任何使用主题的样式都需要具有动态资源。例如：

```
<Window Background="{DynamicResource AppBackgroundColor}" /> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-10T01:18:46.107

我不知道在框架中执行此操作的方法，但是如果您设置可以更改自己的每个控件的样式，您就可以做到。

原理是制作样式a `DynamicResource`，然后`ResourcesDictionary`根据用户配置加载不同样式的样式。

[这](http://www.nablasoft.com/alkampfer/?p=271)是一篇有示例的文章。

# java - Java 使用 Mod 浮点数

> ID：844393
> 
> 赞同：2
> 
> 时间：2009-05-10T00:13:15.110
> 
> 标签：java

我正在使用 Java 进行练习。我应该使用`/`并`%`从数字中提取数字。数字将类似于`1349.9431`。输出将类似于：

```
1349.9431
1349.943
1349.94
1349.9 
```

我知道这是一种奇怪的方法，但实验室练习需要它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-10T00:20:28.353

让我们想想你知道什么。假设您有数字 12345。将 12345 除以 10 的结果是什么？服用12345 mod 10的结果是什么？

现在想想 0.12345。乘以 10 的结果是什么？那个mod 10的结果是什么？

关键在于这些答案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-10T00:20:25.017

如果 x 是您的号码，您应该能够执行 x - x%0.1 之类的操作来获得 1349.9，然后 x - x%.0.01 获得 1349.94 等等。不过我不确定，在花车上做 mod 一开始有点不寻常，但我认为它应该这样工作。

x - x%10 肯定会得到 1340 和 x - x%100 = 1300 肯定。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-10T00:41:50.610

好吧，无论如何工作都会在后台完成，所以为什么还要麻烦，只需打印它。

```
float dv = 1349.9431f;
System.out.printf("%8.3f %8.2f %8.1f", dv, dv, dv); 
```

或者，这可以存档：

```
float dv = 1349.9431f;
System.out.println(String.format("%8.3f %8.2f %8.1f", dv, dv, dv)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T02:36:37.793

这是一个家庭作业问题，因此不允许按照您在现实世界中*实际*执行的方式进行操作（即像[Margus 那样使用 String 的格式方法）。](https://stackoverflow.com/questions/844393/java-using-mod-floats/844437#844437)考虑到您的问题中包含的内容，我可以看到任何答案的三个限制（如果这些实际上不是您需要改写问题的限制！）

1.  必须接受一个浮点数作为输入（如果可能，只使用浮点数）
2.  必须使用余数 (%) 和除法 (/) 运算符
3.  输入浮点数必须能够在小数点前后有四位数字并且仍然给出正确答案。

约束 1\. 非常痛苦，因为如果您必须使用小数点前后四位的数字，您将很容易在浮点精度上遇到问题。

```
float inputNumber = 1234.5678f;
System.out.println(inputNumber % 0.1); 
```

打印“0.06774902343743147”

将输入浮点数转换为双重原因会更令人头疼：

```
float one = 1234.5678f;
double two = (double) one; 
```

打印“1234.5677490234375”（注意：将答案四舍五入将得到 1234.5677，即 != 1234.5678）

老实说，这让我很困惑，我花了太多时间试图弄清楚如何解决精度问题。我找不到使该程序适用于 1234.5678f 的方法，但它确实适用于询问者的值 1349.9431f。

```
float input = 1349.9431f;

float inputCopy = input;
int numberOfDecimalPoints = 0;
while(inputCopy != (int) inputCopy)
{
  inputCopy = inputCopy * 10;
  numberOfDecimalPoints++;
}

double inputDouble = (double) input;

double test = inputDouble * Math.pow(10, numberOfDecimalPoints);
long inputLong = Math.round(test);

System.out.println(input);
for(int divisor = 10; divisor < Math.pow(10, numberOfDecimalPoints); divisor = divisor * 10)
{
  long printMe = inputLong - (inputLong % divisor);
  System.out.println(printMe / Math.pow(10, numberOfDecimalPoints));
} 
```

在我的三个约束中，我满足了 1（某种）、2 但不是 3，因为它高度依赖于价值。

我很想看看其他 SO 人能想出什么。如果提问者正确地解析了指令，这是一个非常糟糕的练习，IMO。

# php - 寻找基于 PHP 的产品经理

> ID：844394
> 
> 赞同：-4
> 
> 时间：2009-05-10T00:13:23.190
> 
> 标签：php, product-management

我正在寻找一个用户友好的 PHP 应用程序来管理我的客户的老式工具集合。我找不到任何东西来简单地组织他的收藏。我能找到的最接近的东西是购物车，但这不是他需要的，因为他不想出售他的收藏品。我没有时间自己编写代码，他很烦躁，因为这比我承诺的要花更长的时间。

有什么建议么？我敢肯定那里有东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T04:06:22.630

如果它真的像你说的那么简单，为什么不自己写一个快速而肮脏的脚本呢？

在 MySQL 中使用适当的字段设置 1 个表，以及几个 PHP 脚本来显示和添加/删除/更新记录？

我可能会在一个小时内完成这项工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-10T00:23:58.657

[这里](http://www.codango.com/php/dir/webapps/ecommerc/catalogu/)列出了几个选项。我曾经使用过 wordpress 购物车插件。取出定价后端和前端代码并不难。我推荐后者。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-11T14:01:15.977

如果您只是想对工具进行分类，我建议您使用带有 LightBox 弹出窗口的图像/照片库插件的 Wordpress，以便在需要时将它们组合在一起。如果需要将工具分组在一起，只需使用标签添加描述和分组标签。这可能不是您想要的解决方案，但它可能只是可行的方法。我在想展示而不是库存:)

# c++ - Windows FormatMessage 的安全/灵活外观

> ID：844395
> 
> 赞同：4
> 
> 时间：2009-05-10T00:13:29.930
> 
> 标签：c++, formatmessage, fastformat

我需要为一个项目使用[FormatMessage()](http://msdn.microsoft.com/en-us/library/ms679351(VS.85).aspx)，但我不喜欢它可怕的界面。有谁知道一个外观可以整理它，同时仍然允许替换参数？

我刚刚阅读了[FastFormat 介绍的第二部分，并且正在考虑为](http://accu.org/var/uploads/journals/overload90.pdf)[FormatMessage()](http://msdn.microsoft.com/en-us/library/ms679351(VS.85).aspx)编写一个扩展（或者询问[FastFormat](http://accu.org/var/uploads/journals/overload90.pdf)项目团队是否有一个在工作中），但我很想尽快得到一些东西，所以如果那里还有其他像样的东西，我可能会抓住它。

我想要的是能够编写代码，例如：

```
HINSTANCE netevent = ::LoadLibrary("netevent.dll");
std::string msg = LookupError(netevent, EVENT_SERVICE_START_FAILED_II,
    "child-svr", "parent-svr", "ship happens");
::puts(msg.c_str()); 
```

这将给出结果：

```
The child-svr service depends on the parent-svr service which failed to start be cause of the following error:
ship happens 
```

我构建的当前包装器具有接口：

```
std::string LookupError(HINSTANCE hinst, DWORD id, ...); 
```

这有两个问题：

*   它不是类型安全的，因为很容易传递任何类型 - `int`, `std::string`, `void*`-`const char*`
*   参数的数量很容易与表示错误的格式字符串所需的数量不匹配

鉴于[FastFormat](http://www.fastformat.org/)在类型安全方面的能力，我想知道是否有办法遵循其处理[FormatMessage()](http://msdn.microsoft.com/en-us/library/ms679351(VS.85).aspx)的机制。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-10T11:42:02.040

由于编译器无法检查要插入格式字符串的参数数量，因此在编译时不可能使其真正成为类型安全的。

您可以通过对不同数量的插入参数进行一些重载，然后使用灵活的诸如`boost::any`. 所以两个参数的重载将是：

```
std::string FormatMessage(HINSTANCE hinst, DWORD id, const boost::any &arg1, const boost::any &arg2); 
```

当您从 中检索值时`arg1`，如果您尝试获取错误的类型，boost 会抛出异常，因此您只需检查格式字符串并尝试从每个参数中获取所需的类型。

或者，您可以使用模板和 std::ostringstream（或 boost::lexical_cast）来获得非常灵活的版本；再次会有重载以允许参数数量变化，所以这里是单参数版本：

```
template <class TArg1>
std::string FormatMessage(HINSTANCE hinst, DWORD id, const TArg1 &arg1)
{
    std::ostringstream arg1Stream;
    arg1Stream << arg1;
    std::string arg1String = arg1Stream.str();

    DWORD_PTR argArray = reinterpret_cast<DWORD_PTR>(arg1String.c_str());

    // ... etc
} 
```

这样，只要传递的类型可以流式传输，您就可以从每个参数中获取一个字符串，只要格式字符串只需要插入字符串，就不需要其他任何东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-19T01:54:50.263

[C++ 格式库](https://github.com/cppformat/cppformat)允许格式化与返回的错误代码相对应的本机 Windows 错误消息`GetLastError()`和与 .给出的错误相对应的 POSIX 错误消息`errno`。例如：

```
// This throws a WindowsError with the description
//   cannot open file 'madeup': The system cannot find the file specified.
// or similar (system message may vary).
const char *filename = "madeup";
LPOFSTRUCT of = LPOFSTRUCT();
HFILE file = OpenFile(filename, &of, OF_READ);
if (file == HFILE_ERROR)
  throw fmt::WindowsError(GetLastError(), "cannot open file '{}'", filename); 
```

`FormatMessage`使用API 函数获取 Windows 错误消息。您还可以格式化`fmt::format_windows_error`不会引发异常的错误消息。有关详细信息，请参阅[系统错误。](http://cppformat.readthedocs.org/en/latest/reference.html#system-errors)

免责声明：我是 C++ 格式的作者

# php - 有什么更好的， isset 与否？

> ID：844410
> 
> 赞同：6
> 
> 时间：2009-05-10T00:22:54.307
> 
> 标签：php, isset

速度有区别吗

```
if (isset($_POST['var'])) 
```

或者

```
if ($_POST['var']) 
```

哪个更好或者它们是一样的？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-10T00:31:13.290

`isset`出于以下原因，这是一个很好的做法：

*   如果`$_POST['var']`是空字符串或`"0"`，`isset`仍会检测到变量是否存在。
*   不使用 isset 将生成通知。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-05-10T00:30:28.657

他们不一样。考虑一个概念数组：

```
$arr = array(
  'a' => false,
  'b' => 0,
  'c' => '',
  'd' => array(),
  'e' => null,
  'f' => 0.0,
); 
```

假设`$x`是这些键之一（'a'到'f'）和不存在的键'g'它的工作方式如下：

*   `$arr[$x]`适用`false`于所有键 a 到 g；
*   `isset($arr[$x])`适用`true`于键 a、b、c、d 和 f，但`false`适用于 e 和 g；和
*   `array_key_exists($x, $arr)`适用`true`于所有键 a 到 f，`false`适用于 g。

我建议你看看[PHP 的类型杂耍](http://au.php.net/language.types.type-juggling)，特别是转换为布尔值。

最后，您所做的称为[微优化](http://www.codinghorror.com/blog/archives/000185.html)。永远不要选择哪一个被认为更快。无论哪个更快，差异都可以忽略不计，即使您可以可靠地确定哪个更快（我不确定您是否可以达到任何统计显着水平），它也不应该成为一个因素**。**

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-10T00:30:53.977

`isset`测试变量是否有任何值，而 if 测试变量的值。

例如：

```
// $_POST['var'] == 'false' (the string false)
if (isset($_POST['var'])) {
    // Will enter this if
}
if ($_POST['var']) {
    // Won't enter this one
} 
```

最大的问题是两个表达式的等价性取决于您正在检查的变量的值，因此您无法做出假设。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-10T00:32:30.680

在严格的 PHP 中，您需要在使用变量之前检查是否设置了变量。

```
error_reporting(E_ALL | E_STRICT); 
```

你在这里做什么

如果（$var）

不检查是否设置了值。所以 Strict PHP 会为未设置的变量生成通知。（这在数组中经常发生）

同样在严格的 PHP 中（仅供您或其他人参考），在函数中使用未设置的 var 作为参数会引发通知，并且您无法在函数中检查 isset() 以避免这种情况。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-10T12:15:11.070

只是重复别人说的话，如果你执行：

```
if($variable) 
```

并且 $variable**未**设置，您将收到通知错误。加..

```
$var = 0;
if($variable) {
    //This code will never run, because $var is false
} 
```

但在这种情况下使用 isset 会返回 true。

# .net - 将 StringCollection 转换为 List

> ID：844412
> 
> 赞同：48
> 
> 时间：2009-05-10T00:24:11.467
> 
> 标签：.net, vb.net, generics

通常，我会尽可能选择`List<String>`[or, in VB, `List(Of String)`] ：另请参阅*[Best string container](https://stackoverflow.com/questions/669106/best-string-container-stringcollection-collectionstring-liststring-arraylist)*。`StringCollection`

然而，看起来，泛型——因此`List<String>`——显然在 VS 2008 的设置设计器中不受支持。因此，如果我想在我的用户设置中使用字符串列表，我必须求助于使用`StringCollection`那里。

**现在，由于我不想在`StringCollection`整个代码中看到，我需要将其转换为`List<String>`. 我如何有效地做到这一点？或者，更好的是，我错了，有一种`List<String>`在设置设计器中使用的方法吗？**

*编辑：我必须使用 .NET 2.0。*

* * *

## 回答 #1

> 赞同：122
> 
> 时间：2009-05-10T00:30:21.623

如果您使用的是 .NET 3.5 ，则转换`StringCollection`为非常简单。`List<string>`

```
var list = stringCollection.Cast<string>().ToList(); 
```

关于你的第二个问题，我似乎记得可以`List<string>`在 Visual Studio 的设置设计器中使用。如果您选择自定义类型然后浏览器到适当的类型，它应该可以工作。但是，我可能会弄错，所以我需要验证它。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2010-04-15T12:55:50.810

`stringCollection.Cast<string>().ToList()`

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-05-10T00:56:45.600

如果您*必须*使用.NET 2.0，我想最干净的选择是分别`StringCollection`为该实现`IEnumerable<string>`和`IEnumerator<string>`for`StringCollection`和创建一个包装器`StringEnumerator`。（*注*：根据元数据，`StringEnumerator`未实现`IEnumerator`）。示例如下。然而，归根结底，某个地方的某个人将在 上做 a `foreach()`，`StringCollection`所以有人*可能会*争辩说，一个简单`foreach(string item in stringCollection)`的添加到`List<string>`就足够了；我怀疑这不足以满足您的需求。

您也可以`IList<string>`使用这种方法来实现，以节省您复制底层字符串的时间，但您会因“包装器”类型的委托调用（堆栈上的另一个方法调用！）而付出代价。我建议您无论如何都根据系统内的接口来处理事物`IEnumberable<string>`，`IList<string>`而不是具体的列表，它将引导您走上更大灵活性的道路。

```
 static void Main(string[] args)
    {
        StringCollection stringCollection = new StringCollection();
        stringCollection.AddRange(new string[] { "hello", "world" });

        // Wrap!
        List<string> listOfStrings = new List<string>(new StringCollectionEnumerable(stringCollection));

        Debug.Assert(listOfStrings.Count == stringCollection.Count);
        Debug.Assert(listOfStrings[0] == stringCollection[0]); 

    }

    private class StringCollectionEnumerable : IEnumerable<string>
    {
        private StringCollection underlyingCollection; 

        public StringCollectionEnumerable(StringCollection underlyingCollection)
        {
            this.underlyingCollection = underlyingCollection; 
        }

        public IEnumerator<string> GetEnumerator()
        {
            return new StringEnumeratorWrapper(underlyingCollection.GetEnumerator()); 
        }

        System.Collections.IEnumerator System.Collections.IEnumerable.GetEnumerator()
        {
            return this.GetEnumerator(); 
        }
    }

    private class StringEnumeratorWrapper : IEnumerator<string>
    {
        private StringEnumerator underlyingEnumerator; 

        public StringEnumeratorWrapper(StringEnumerator underlyingEnumerator)
        {
            this.underlyingEnumerator = underlyingEnumerator;
        }

        public string Current
        {
            get
            {
                return this.underlyingEnumerator.Current; 
            }
        }

        public void Dispose()
        {
            // No-op 
        }

        object System.Collections.IEnumerator.Current
        {
            get
            {
                return this.underlyingEnumerator.Current;
            }
        }

        public bool MoveNext()
        {
            return this.underlyingEnumerator.MoveNext(); 
        }

        public void Reset()
        {
            this.underlyingEnumerator.Reset(); 
        }
    } 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-10T00:43:02.997

为什么不保持简单，只是迭代它并将项目添加到列表中，或者我误解了什么？

```
public static List<string> Convert(StringCollection collection)
{
    List<string> list = new List<string>();
    foreach (string item in collection)
    {
        list.Add(item);
    }
    return list;
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-10T00:32:26.047

如果您使用 C# 3.0 和 .NET 3.5，则可以使用创建列表

```
var list = new List<string>(new StringCollection().Cast<string>()); 
```

另一种方法是：

```
var c = new StringCollection();
c.AddRange(new List<string>().ToArray()); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-02-11T13:34:46.313

C# 2.0

```
StringCollection colString = new StringCollection();
string[] arrString = new string[colString.Count];
colString.CopyTo(arrString, 0);
List<string> lstString = new List<string>(arrString); 
```

# iphone - 如何在 iPhone 应用程序的导航栏中显示图像？

> ID：844416
> 
> 赞同：22
> 
> 时间：2009-05-10T00:27:05.123
> 
> 标签：iphone

如何在 iPhone 应用程序的导航栏中显示图像？（比如说，就在标题之后）

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-11-08T21:47:17.273

以下是如何让图像在 NavBar 中居中。

```
UIImage *image = [UIImage imageNamed: @"NavBarImage.png"];
UIImageView *imageView = [[UIImageView alloc] initWithImage: image];

self.navigationItem.titleView = imageView;

[imageView release]; 
```

此代码实际上包含在 NavBar 的 Apple 源代码中，可在 Apple 的 iPhone 开发人员中心找到。源代码向您展示了操作 StatusBar 和 NavBar 的各种方法。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-10T08:45:32.460

我没有对此进行测试，但由于 UINavigationBar 是一个视图，您可以向其中添加子视图。

```
UIImage* myImage = [UIImage imageNamed:@"Myimage.png"];
UIImageView* myImageView = [[UIImageView alloc] initWithImage:myImage];
myImageView.frame.origin.x = 30.0; // You will have to find suitable values for the origin
myImageView.frame.origin.y = 5.0;

[myTabbar addSubView:myImageView];
[myImageView release]; 
```

你可以使用 backItem 属性来计算图像视图的位置。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-05-19T09:32:34.873

如果您想要导航栏右侧的图像，您可以将其定义为自定义按钮，按下时不执行任何操作，如下所示

```
UIButton* fakeButton = (UIButton *) [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"yourimage.png"]];
UIBarButtonItem *fakeButtonItem = [[UIBarButtonItem alloc] initWithCustomView:fakeButton];
self.navigationItem.rightBarButtonItem = fakeButtonItem;
[fakeButtonItem release];
[fakeButton release]; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-07-19T13:56:43.230

只需将该代码放入，`- (void)viewWillAppear:(BOOL)animated;`这样它就可以正常工作并添加一个名为 Top Bar 的大小为 320x40 的图像

```
UIImage *image = [UIImage imageNamed: @"TopBar.png"];
[self.navigationController.navigationBar setBackgroundImage:image forBarMetrics:UIBarMetricsDefault]; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-10T00:32:10.853

导航栏有一个名为标题视图的属性 - 将其设置为您喜欢的图像。由于 titleView 会覆盖导航栏的标题，因此您必须在图像文件中包含所需的标题。仍然将标题设置为您想要的标题，以便在您按下视图控制器时显示在后退按钮上

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-03-21T13:12:59.533

我遇到了同样的问题。找到了最好的解决方案

```
 [self.navigationController.navigationBar setBackgroundImage:[UIImage imageNamed:@"background_image.png"] forBarMetrics:UIBarMetricsDefault]; 
```

希望这会有所帮助....

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-12T12:19:45.890

只需编写自己的导航栏。因此，您必须禁用导航栏拳头：

通过在情节提要中选择导航控制器来禁用界面构建器中的顶部栏：属性检查器->模拟指标->顶部栏：选择无

之后你可以添加任何你喜欢的 HeaderView...

```
UIView *headerView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, sFrame.size.width, 100)];
UIColor *background = [[UIColor alloc] initWithPatternImage:[UIImage imageNamed:@"header_image.png"]];
self.headerView.backgroundColor = background;

// ...add buttons and labels

[self.view addSubview:headerView]; 
```

# c# - 设置文件夹浏览器对话框开始位置

> ID：844423
> 
> 赞同：122
> 
> 时间：2009-05-10T00:31:04.553
> 
> 标签：c#

有没有办法将文件夹浏览器对话框的初始目录设置为非特殊文件夹？这是我目前正在使用的

```
fdbLocation.RootFolder = Environment.SpecialFolder.Desktop;
```

但我想使用我存储在这样的字符串中的路径

```
fdbLocation.RootFolder = myFolder;
```

这会导致错误“无法将 'string' 转换为 'System.Environment.SpecialFolder'”。

* * *

## 回答 #1

> 赞同：206
> 
> 时间：2009-05-10T00:39:41.460

只需`SelectedPath`在调用之前设置属性`ShowDialog`。

```
fdbLocation.SelectedPath = myFolder; 
```

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2009-05-10T00:39:34.470

`SelectedPath`在调用之前设置属性`ShowDialog`...

```
folderBrowserDialog1.SelectedPath = @"c:\temp\";
folderBrowserDialog1.ShowDialog(); 
```

将开始他们`C:\Temp`

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2009-05-10T00:34:28.070

```
fldrDialog.SelectedPath = Environment.GetFolderPath(Environment.SpecialFolder.DesktopDirectory) 
```

> "如果在显示对话框之前设置了 SelectedPath 属性，那么只要将 SelectedPath 设置为 RootFolder 的子文件夹的绝对路径（或者更准确地说，指向由 RootFolder 表示的 shell 命名空间）。”

[MSDN - 选定路径](http://msdn.microsoft.com/en-us/library/system.windows.forms.folderbrowserdialog.selectedpath.aspx)

> “GetFolderPath 方法返回与此枚举关联的位置。这些文件夹的位置在不同的操作系统上可以有不同的值，用户可以更改某些位置，并且这些位置是本地化的。”

回复：桌面与桌面目录

**桌面**

> “逻辑桌面而不是物理文件系统位置。”

**桌面目录：**

> “用于在桌面上物理存储文件对象的目录。不要将此目录与桌面文件夹本身混淆，它是一个虚拟文件夹。”

[MSDN - 特殊文件夹枚举](http://msdn.microsoft.com/en-us/library/system.environment.specialfolder.aspx)

[MSDN-GetFolderPath](http://msdn.microsoft.com/en-us/library/system.environment.getfolderpath.aspx)

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-05-04T15:10:37.867

要设置目录选择路径并检索新目录：

```
dlgBrowseForLogDirectory.SelectedPath = m_LogDirectory;
if (dlgBrowseForLogDirectory.ShowDialog() == DialogResult.OK)
{
     txtLogDirectory.Text = dlgBrowseForLogDirectory.SelectedPath;
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-06-26T12:02:53.067

在[dotnet-snippets.de上找到](https://dotnet-snippets.de/snippet/folderbrowserdialog-mit-benutzerdefiniertem-root/1738)

通过反射，这可以工作并设置**真正的 RootFolder！**

```
using System;
using System.Reflection;
using System.Windows.Forms;

namespace YourNamespace
{
    public class RootFolderBrowserDialog
    {

        #region Public Properties

        /// <summary>
        ///   The description of the dialog.
        /// </summary>
        public string Description { get; set; } = "Chose folder...";

        /// <summary>
        ///   The ROOT path!
        /// </summary>
        public string RootPath { get; set; } = "";

        /// <summary>
        ///   The SelectedPath. Here is no initialization possible.
        /// </summary>
        public string SelectedPath { get; private set; } = "";

        #endregion Public Properties

        #region Public Methods

        /// <summary>
        ///   Shows the dialog...
        /// </summary>
        /// <returns>OK, if the user selected a folder or Cancel, if no folder is selected.</returns>
        public DialogResult ShowDialog()
        {
            var shellType = Type.GetTypeFromProgID("Shell.Application");
            var shell = Activator.CreateInstance(shellType);
            var folder = shellType.InvokeMember(
                             "BrowseForFolder", BindingFlags.InvokeMethod, null,
                             shell, new object[] { 0, Description, 0, RootPath, });
            if (folder is null)
            {
                return DialogResult.Cancel;
            }
            else
            {
                var folderSelf = folder.GetType().InvokeMember(
                                     "Self", BindingFlags.GetProperty, null,
                                     folder, null);
                SelectedPath = folderSelf.GetType().InvokeMember(
                                   "Path", BindingFlags.GetProperty, null,
                                   folderSelf, null) as string;
                // maybe ensure that SelectedPath is set
                return DialogResult.OK;
            }
        }

        #endregion Public Methods

    }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-03-15T21:11:24.037

就我而言，这是一次意外的双重转义。

这有效：

```
SelectedPath = @"C:\Program Files\My Company\My product"; 
```

这不会：

```
SelectedPath = @"C:\\Program Files\\My Company\\My product"; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-07-29T09:42:42.700

这很容易，你不需要反思。您必须将 SelectedPath 属性设置为所需的文件夹，但由于 SelectedPath 之前仅设置为绝对路径，即 RootFolder 的子文件夹，因此您必须设置 RootFolder。例如：

您的初始文件夹是 Desktop 子文件夹：

```
dlgBrowseForLogDirectory.RootFolder = Environment.SpecialFolder.DesktopDirectory;
dlgBrowseForLogDirectory.SelectedPath = Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.DesktopDirectory), "yourDesktopFolder"); 
```

您的初始文件夹是一个普通文件夹（我的电脑子文件夹也是如此）：

```
dlgBrowseForLogDirectory.RootFolder = Environment.SpecialFolder.MyComputer;
dlgBrowseForLogDirectory.SelectedPath = @"e:\yourFolder"; 
```

有很好的编码，克劳迪奥

# java - struts 是 java web 的一个很好的起点吗

> ID：844427
> 
> 赞同：4
> 
> 时间：2009-05-10T00:32:12.040
> 
> 标签：java, google-app-engine, jakarta-ee, struts

我一直在用 java 开发，然后我停止了，所以现在我有了我的谷歌应用引擎帐户，我想再次开始。另外，我喜欢 web，而且我知道 struts 是一个很好的 MVC 框架。

我一直在读[这个](http://www.roseindia.net/struts/)。您认为 struts 可以帮助我开始还是我应该从“普通”servlet 开始，然后转到某个框架？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-10T00:49:50.937

我至少会学习基本的 servlet 生命周期和 API。

正如 Joel 所说，[抽象是有漏洞的](http://www.joelonsoftware.com/articles/LeakyAbstractions.html)，这适用于框架——所有框架，而不仅仅是 Web 框架——同样适用。如果你理解底层技术，它试图抽象的东西，你会更好地使用框架，知道它为什么好，以及它如何帮助你。

至于 Struts，我会避开 STruts 1。它现在相当古老。它仍然有很多代码，但我现在不认为它是最佳实践，特别是对于它（过度）使用继承。Struts 2 确实是一个完全不同的基于 Webwork 的框架。

还有很多其他的 MVC 框架。就我个人而言，我喜欢 Spring MVC 非常“纯粹”和轻量级。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-10T00:49:27.503

我肯定会从 MVC 框架开始，而不是您建议的“普通”servlet。

虽然我经常使用 Struts 1.xa，但我认为对于新应用程序，您应该查看 Struts 2、Spring MVC 或其他一些利用新 Java 特性（如注释）的新框架。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-10T00:52:23.893

我完全同意 cletus 的观点，我首先要完全理解 Servlet/JSP。

在那之后，我会使用比 Struts 更现代的框架。对我来说，JSF 或 Spring 现在听起来比 Struts 更好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-10T05:30:59.513

Struts 1 现在已经过时了，而 Struts 2 似乎并没有获得太大的吸引力。那里有很多好的框架，您可能需要考虑：例如 JSF、GWT 或 Spring。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-29T15:58:54.280

我建议您使用 Struts 1.x 而不是 Servlet，因为这会给您带来很多好处，例如

1.  页面导航
2.  输入验证
3.  可扩展性
4.  模块化

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-10T01:51:19.307

我也同意首先学习基础知识（Servlet API 是必须的，强烈推荐 jsp/jstl）是最好的事情。对于许多简单的事情，jsp/jstl 组合实际上非常好。但系统越大，此类 Web 应用程序的可维护性就越差。这与使用 JSF 等重型框架相反。

除了已经提出的建议之外，我还建议您查看 Tapestry 和 Wicket：许多开发人员都喜欢它们。我在 JSF 方面的经历有点消极。但它是那些爱恨交织的框架之一，许多人发誓，其他人只是发誓。

# mysql - 如何转换存储的错误编码数据？

> ID：844432
> 
> 赞同：5
> 
> 时间：2009-05-10T00:36:13.807
> 
> 标签：mysql, perl, encoding, utf-8

我的 Perl 应用程序和 MySQL 数据库现在可以正确处理传入的 UTF-8 数据，但我必须转换预先存在的数据。一些数据似乎已被编码为 CP-1252，并且在被编码为 UTF-8 并存储在 MySQL 中之前没有被解码。我已经阅读了 O'Reilly 的文章[Turning MySQL data in latin1 to utf8 utf-8](http://www.oreillynet.com/onlamp/blog/2006/01/turning_mysql_data_in_latin1_t.html)，虽然它经常被引用，但它并不是一个明确的解决方案。

我看过[Encode::DoubleEncodedUTF8](http://search.cpan.org/dist/Encode-DoubleEncodedUTF8/)和[Encoding::FixLatin](http://search.cpan.org/dist/Encoding-FixLatin/)，但都没有处理我的数据。

这是我到目前为止所做的：

```
#Return the $bytes from the DB using BINARY()
my $characters = decode('utf-8', $bytes);
my $good = decode('utf-8', encode('cp-1252', $characters)); 
```

这解决了大多数情况，但如果针对正确编码的记录运行，它会破坏它们。我尝试使用[Encode::Guess](http://search.cpan.org/dist/Encode/lib/Encode/Guess.pm)和[Encode::Detect](http://search.cpan.org/dist/Encode-Detect/)，但它们无法区分正确编码和错误编码的记录。[因此，如果在转换后找到\x{FFFD} 字符](http://www.fileformat.info/info/unicode/char/fffd/index.htm)，我只需撤消转换。

但是，有些记录只是部分转换。这是一个示例，其中左花引号被正确转换，但右花引号被损坏。

```
perl -CO -MEncode -e 'print decode("utf-8", encode("cp-1252", decode("utf-8", "\xC3\xA2\xE2\x82\xAC\xC5\x93four score\xC3\xA2\xE2\x82\xAC\xC2\x9D")))' 
```

这是一个右单引号没有转换的例子：

```
perl -CO -MEncode -e 'print decode("utf-8", encode("cp-1252", decode("utf-8", "bob\xC3\xAF\xC2\xBF\xC2\xBDs")))' 
```

我是否也在这里处理双重编码数据？我还需要做什么来转换这些记录？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-15T02:06:05.127

对于“四分”的例子，它几乎可以肯定是双重编码的数据。它看起来像：

1.  通过 cp1252 到 utf8 进程运行两次的 cp1252 数据，或
2.  通过 cp1252 到 utf8 进程运行的 utf8 数据

（当然，两种情况看起来都一样）

现在，这就是您所期望的，那么为什么您的代码不起作用？

首先，我想请您参考[这张表](http://unicode.org/Public/MAPPINGS/VENDORS/MICSFT/WINDOWS/CP1252.TXT)，它显示了从 cp1252 到 unicode 的转换。我想让您注意的重要一点是，有些字节（例如 0x9D）在 cp1252 中是无效的。

因此，当我想象编写一个 cp1252 到 utf8 转换器时，我需要对那些不在 cp1252 中的字节做一些事情。我能想到的唯一明智的事情是将未知字节转换为具有相同值的 unicode 字符。事实上，这似乎是发生了什么事。让我们将您的“四分”示例一次退一步。

首先，由于它是有效的 utf-8，让我们解码：

```
$ perl -CO -MEncode -e '$a=decode("utf-8", 
  "\xC3\xA2\xE2\x82\xAC\xC5\x93" .
  "four score" .
  "\xC3\xA2\xE2\x82\xAC\xC2\x9D");
  for $c (split(//,$a)) {printf "%x ",ord($c);}' | fmt 
```

这产生了这个 unicode 代码点序列：

```
e2 20ac 153 66 6f 75 72 20 73 63 6f 72 65 e2 20ac 9d 
```

（“fmt”是一个 unix 命令，它只是重新格式化文本，以便我们对长数据有很好的换行符）

现在，让我们将它们中的每一个表示为 cp1252 中的一个字节，但是当 unicode 字符无法在 cp1252 中表示时，我们只需将其替换为具有相同数值的字节即可。（而不是默认值，即用问号替换它）然后，如果我们对数据发生的事情是正确的，那么我们应该有一个有效的 utf8 字节流。

```
$ perl -CO -MEncode -e '$a=decode("utf-8",
  "\xC3\xA2\xE2\x82\xAC\xC5\x93" .
  "four score" .
  "\xC3\xA2\xE2\x82\xAC\xC2\x9D");
  $a=encode("cp-1252", $a, sub { chr($_[0]) } );
  for $c (split(//,$a)) {printf "%x ",ord($c);}' | fmt 
```

编码的第三个参数 - 当它是一个子时 - 告诉如何处理不可表示的字符。

这产生：

```
e2 80 9c 66 6f 75 72 20 73 63 6f 72 65 e2 80 9d 
```

现在，这是一个有效的 utf8 字节流。不能通过检查来判断吗？好吧，让我们让 perl 将此字节流解码为 utf8：

```
$ perl -CO -MEncode -e '$a=decode("utf-8",
  "\xC3\xA2\xE2\x82\xAC\xC5\x93" .
  "four score" .
  "\xC3\xA2\xE2\x82\xAC\xC2\x9D");
  $a=encode("cp-1252", $a, sub { chr($_[0]) } );
  $a=decode("utf-8", $a, 1);
  for $c (split(//,$a)) {printf "%x ",ord($c);}' | fmt 
```

将“1”作为第三个参数传递给 decode 确保我们的代码在字节流无效时会发出嘶哑的声音。这产生：

```
201c 66 6f 75 72 20 73 63 6f 72 65 201d 
```

或打印：

```
$ perl -CO -MEncode -e '$a=decode("utf-8",
  "\xC3\xA2\xE2\x82\xAC\xC5\x93" .
  "four score" .
  "\xC3\xA2\xE2\x82\xAC\xC2\x9D");
  $a=encode("cp-1252", $a, sub { chr($_[0]) } );
  $a=decode("utf-8", $a, 1);
  print "$a\n"'
“four score” 
```

所以我认为完整的算法应该是这样的：

1.  从 mysql 中获取字节流。将此分配给 $bytestream。
2.  虽然 $bytestream 是一个有效的 utf8 字节流：
    1.  将 $bytestream 的当前值赋给 $good
    2.  如果 $bytestream 是全 ASCII 码（即每个字节都小于 0x80），则跳出这个“while ... valid utf8”循环。
    3.  将 $bytestream 设置为“demangle($bytestream)”的结果，其中 demangle 如下所示。此例程撤消了我们认为该数据遭受的 cp1252 到 utf8 转换器。
3.  如果它不是 undef，则将 $good 放回数据库中。如果从未分配过 $good，则假设 $bytestream 是 cp1252 字节流并将其转换为 utf8。（当然，如果第 2 步中的循环没有改变任何东西等，优化并且不要这样做）

.

```
sub demangle {
  my($a) = shift;
  eval { # the non-string form of eval just traps exceptions
         # so that we return undef on exception
    local $SIG{__WARN__} = sub {}; # No warning messages
    $a = decode("utf-8", $a, 1);
    encode("cp-1252", $a, sub {$_[0] <= 255 or die $_[0]; chr($_[0])});
  }
} 
```

这是基于这样的假设：除非它真的是 utf-8，否则不是全 ASCII 的字符串实际上是非常罕见的有效 utf-8 字节流。也就是说，这不是偶然发生的事情。

编辑添加：

请注意，不幸的是，这种技术对您的“鲍勃”示例没有太大帮助。我认为该字符串也经历了两轮 cp1252 到 utf8 的转换，但不幸的是也有一些损坏。使用与之前相同的技术，我们首先将字节序列读取为 utf8，然后查看我们得到的 unicode 字符引用序列：

```
$ perl -CO -MEncode -e '$a=decode("utf-8",
  "bob\xC3\xAF\xC2\xBF\xC2\xBDs");
  for $c (split(//,$a)) {printf "%x ",ord($c);}' | fmt 
```

这产生：

```
62 6f 62 ef bf bd 73 
```

现在，恰好对于 ef bf bd 三个字节，unicode 和 cp1252 一致。所以在 cp1252 中表示这个 unicode 码点序列就是：

```
62 6f 62 ef bf bd 73 
```

也就是说，相同的数字序列。现在，这实际上是一个有效的 utf-8 字节流，但它解码的内容可能会让您大吃一惊：

```
$ perl -CO -MEncode -e '$a=decode("utf-8",
  "bob\xC3\xAF\xC2\xBF\xC2\xBDs");
  $a=encode("cp-1252", $a, sub { chr(shift) } );
  $a=decode("utf-8", $a, 1);
  for $c (split(//,$a)) {printf "%x ",ord($c);}' | fmt

62 6f 62 fffd 73 
```

即 utf-8 字节流，虽然是合法的 utf-8 字节流，却编码了字符 0xFFFD，一般用于“不可译字符”。我怀疑这里发生的事情是第一个 *-to-utf8 转换看到一个它无法识别的字符并将其替换为“不可翻译”。然后没有办法以编程方式恢复原始字符。

结果是您无法仅通过解码然后查找 0xFFFD 来检测字节流是否是有效的 utf8（我上面给出的算法需要）。相反，你应该使用这样的东西：

```
sub is_valid_utf8 {
  defined(eval { decode("utf-8", $_[0], 1) })
} 
```

# php - 按下“提交”时阻止表单中的网站链接和电子邮件地址

> ID：844446
> 
> 赞同：1
> 
> 时间：2009-05-10T00:49:04.183
> 
> 标签：php, validation, spam-prevention

伙计们，

我有一个 html 表单，它将表单数据作为电子邮件发送。不幸的是，垃圾邮件机器人一直在填写表格，并在表格的消息部分发送网站链接和电子邮件地址。

有没有一种方法可以删除网站链接和电子邮件地址时按下“提交”按钮，然后再将其作为电子邮件地址发送？我使用 PHP 将表单数据作为电子邮件消息实际发送。

谢谢并恭祝安康，

托尼

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-10T00:52:01.680

您是否尝试过[通过 css 隐藏表单](http://robmalon.com/hidden-form-fields-to-prevent-bot-spam/)（显示：无）但在 HTML 中像常规表单一样，并称之为电子邮件或常见的东西，如果该表单有数据，那么它一定是机器人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-10T00:52:17.217

你可以用 Javascript 做到这一点。问题是需要启用 Javascript 才能发生这种情况，因此您可以想象垃圾邮件机器人在这方面会合作的可能性。

您将不得不在服务器上将其过滤掉。就我个人而言，我会直接拒绝任何包含链接或电子邮件地址的消息。向用户吐出一个错误，但甚至不保存它。

有关在 PHP 中检测垃圾邮件的一些技巧，请阅读[无垃圾邮件的可访问表单](http://webaim.org/blog/spam_free_accessible_forms/)。

您可能还想考虑使用 CAPTCHA。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-11T22:52:30.577

这是非常简单的，但你可以建立在它之上，我敢肯定......

尝试添加一张猫或狗的图片，然后让他们输入所示动物的三个字母名称......或类似的东西。进行验证检查，然后从那里开始……便宜又简单的验证码。这样只有人工输入才会输出......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-10T00:51:16.283

如何使用正则表达式将任何与 Web 链接或电子邮件地址匹配的内容替换为空字符串。

您可以在网络上找到正则表达式示例的音调，只需 google 即可

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-10T02:26:35.227

您必须遍历 $_POST 数组中的每个字段（至少是您不希望在其中包含电子邮件或链接的字段），并根据几个正则表达式对其进行检查。

使用 CAPTCHA 的建议也是一个很好的建议。

无论如何，这是一个糟糕的检查实现：

```
class ValidationHelper
{
    // Regex taken from https://github.com/google-code-export/prado3/blob/master/framework/Web/UI/WebControls/TEmailAddressValidator.php
    const EMAIL_REGEX = "#\\w+([-+.]\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)*#";

    // hacked up regex that I just cooked up - could be hugely improved i'm sure.
    const LINK_REGEX = "#(h\s*t\s*t\s*p\s*s?|f\s*t\s*p)\s*:\s*/\s*/#";

    public static function containsEmail($value)
    {
        if (preg_match(self::EMAIL_REGEX, $value))
            return true;

        return false;
    }

    public static function containsLink($value)
    {
        if (preg_match(self::LINK_REGEX, $value))
            return true;

        return false;
    }
}

$errors = array();
foreach ($_POST as $key=>$value) {
    // presumably you want at least one email field, yeah?
    if ($key != 'email') {
        // perhaps you should be running strip_tags over everything if you don't want html and such...
        // see http://php.net/strip_tags for more info. without it (or something similar), there's nothing 
        // to stop people from putting <script type="text/javascript" src="http://notyourdomain.com/~1337skriptkiddy/haxxors.js"></script>
        // into your form. even if you might not necessarily ever be displaying this in a scenario
        // where it can cause trouble, it's never a bad idea to stop this stuff *before* it gets into your db
        $_POST[$key] = $value = strip_tags($value);
        if (ValidationHelper::containsEmail($value) || ValidationHelper::containsLink($value))
            $errors[] = 'Please ensure the value you entered for '.$fieldNames[$key].' does not contain any links or email addresses';
    }
}

if (!empty($errors)) {
    // failed - show errors.
}
else {
    // success!
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-10T05:12:59.260

好吧，如果您真的想打击垃圾邮件，请执行以下步骤：

1.  在表单中放置验证码，这样非人类甚至无法提交表单。一个非常流行的验证码实现是[reCAPTCHA](http://recaptcha.net/)。

2.  在字段上做一个**strip_tags**，这样即使有人手动放置 URL，它也会被删除。

3.  对电子邮件地址进行正则表达式检查并将其删除。从网络上选择一个好的正则表达式，它将选择大多数电子邮件格式。

希望这有帮助。干杯!

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-10T05:22:42.980

大概，您不想接受任何类型的 HTML，只是纯文本？在这种情况下， [strip_tags](http://php.net/manual/en/function.strip-tags.php)是您的朋友。strip_tags 还允许您指定一些可接受的标签。

我还衷心推荐合并一个[标头注入防御脚本](http://www.alt-php-faq.org/local/115/)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-10T14:38:55.780

伙计们，

我尝试使用 strip_tags，它肯定会删除标签，但不会删除“mailto：”或“http://”文本，因此链接仍然是链接。

是否有一个简单的 PHP 命令或例程可以扫描字符串并在字符串的这些部分中将“mailto：”和/或“http://”替换为无害的空字符串“”？

也尝试过谷歌搜索，但我发现的大部分内容都是关于修剪空白等。

抱歉，我对 PHP 有点陌生。

谢谢并恭祝安康，

托尼

# javascript - 如何强制 DOM 在 Javascript/jQuery 中重新评估？

> ID：844451
> 
> 赞同：3
> 
> 时间：2009-05-10T00:51:50.383
> 
> 标签：javascript, jquery

我正在将 HTML 动态附加到网页，并且我还使用 jQuery 来管理内容。

当我添加 HTML 代码时，jQuery 会忽略它的存在。
例如：

```
$("td.elementToClick").click(... 
```

将与 jQuery 一起工作得很好。但是，如果我在代码中的某处附加：

```
$("tr#myRowToAppend").append("<td class="elementToClick>...</td>"); 
```

如果我单击它，jQuery 将忽略这个新元素。

由于 jQuery 在页面完成加载后关联事件，因此我需要以下两种解决方案之一： - 强制 DOM 重新评估页面而不更改当前布局（我不希望刷新，因此 location.reload() 不在问题）。- 强制 jQuery 将这个新元素添加到它的内部事件管理器中。

我不想使用`onclick="blabla()"`，我真的需要使用 jQuery。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-10T00:58:20.337

您正在寻找的是 jQuery [live](http://docs.jquery.com/Events/live)。来自文档描述：“将处理程序绑定到所有当前和未来匹配元素的事件（如点击）。还可以绑定自定义事件。”

如果您愿意，还有一个插件[liveQuery](http://plugins.jquery.com/project/livequery)可以支持更广泛的事件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-10T01:08:49.097

live() 方法将减轻您的大部分头痛。

我看到这种情况在 IE 和克隆元素中更常见，要支持 IE，您必须更加小心 DOM 操作。

我还看到很多关于 SO 的问题，人们在没有先克隆它的情况下将 dom 元素复制/移动到 dom 的新部分，这在 IE 中效果不佳。

因此，您可以使用 live 或当您必须处理来自动态插入的 DOM 元素的事件时，请确保使用 clone(true) 克隆它们以指定您希望复制事件：

```
$("body").append('<div id="one"></div>");

$("#one").mouseover(function(){});

$("body").append( $("#one").clone(true).attr('id','two') ); 
```

# c# - 从字符串中仅返回数字 0-9

> ID：844461
> 
> 赞同：76
> 
> 时间：2009-05-10T00:57:11.743
> 
> 标签：c#, vb.net, regex, vbscript, code-generation

我需要一个可以在 VBScript 和 .NET 中使用的正则表达式，它只返回在字符串中找到的数字。

例如，以下任何“字符串”应仅返回**1231231234**

*   123 123 1234
*   (123) 123-1234
*   123-123-1234
*   (123)123-1234
*   123.123.1234
*   123 123 1234
*   1 2 3 1 2 3 1 2 3 4

这将在电子邮件解析器中用于查找客户可能在电子邮件中提供的电话号码并进行数据库搜索。

我可能错过了一个类似的正则表达式，但我确实在 regexlib.com 上进行了搜索。

[编辑] - 添加了[RegexBuddy](http://www.regexbuddy.com/)在设置 musicfreak 的答案后生成的代码

**VBScript 代码**

```
Dim myRegExp, ResultString
Set myRegExp = New RegExp
myRegExp.Global = True
myRegExp.Pattern = "[^\d]"
ResultString = myRegExp.Replace(SubjectString, "") 
```

**VB.NET**

```
Dim ResultString As String
Try
      Dim RegexObj As New Regex("[^\d]")
      ResultString = RegexObj.Replace(SubjectString, "")
Catch ex As ArgumentException
      'Syntax error in the regular expression
End Try 
```

**C＃**

```
string resultString = null;
try {
    Regex regexObj = new Regex(@"[^\d]");
    resultString = regexObj.Replace(subjectString, "");
} catch (ArgumentException ex) {
    // Syntax error in the regular expression
} 
```

* * *

## 回答 #1

> 赞同：202
> 
> 时间：2009-05-10T01:10:44.550

在 .NET 中，您可以只从字符串中提取数字。像这样：

```
string justNumbers = new String(text.Where(Char.IsDigit).ToArray()); 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2017-04-12T12:20:07.923

作为主要`.Net`解决方案的替代方案，改编自[类似问题的](https://stackoverflow.com/questions/19167669/keep-only-numeric-value-from-a-string)答案：

```
string justNumbers = string.Concat(text.Where(char.IsDigit)); 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-05-10T01:04:40.057

我不知道 VBScript 是否具有某种“正则表达式替换”功能，但如果有，那么您可以执行类似以下伪代码的操作：

```
reg_replace(/\D+/g, '', your_string) 
```

我不知道 VBScript，所以我不能给你确切的代码，但这会删除任何不是数字的东西。

编辑：确保有全局标志（正则表达式末尾的“g”），否则它只会匹配字符串中的第一个非数字。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-10T06:08:34.350

注意：你在这里只解决了一半的问题。

对于“在野外”输入的美国电话号码，您可能有：

*   带或不带“1”前缀的电话号码
*   带或不带区号的电话号码
*   带有分机号码的电话号码（如果你盲目地删除所有非数字，你会错过“x”或“Ext.”或其他任何在线）。
*   可能是用助记字母编码的数字（800-BUY-THIS 或其他）

您需要在代码中添加一些智能，以使生成的数字列表符合您在数据库中实际搜索的单一标准。

你可以做一些简单的事情来解决这个问题：

*   在 RegEx 删除非数字之前，请查看字符串中是否有“x”。如果有，把它后面的所有东西都砍掉（将处理大多数版本的写分机号码）。

*   对于任何以“1”开头的 10+ 位数字，将 1 去掉。它不是区号的一部分，美国区号从 2xx 范围开始。

*   对于任何仍然超过 10 位的数字，假设余数是某种扩展，并将其砍掉。

*   使用“ends-with”模式搜索（SELECT * FROM mytable WHERE phonenumber LIKE 'blah%'）进行数据库搜索。这将处理未提供区号的位置（尽管可能出错），但您的数据库中有*带*区号的号码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-10T01:01:24.403

从表面上看，您试图捕捉任何 10 位数的电话号码....

为什么不首先对文本进行字符串替换以删除以下任何字符。

```
<SPACE> , . ( ) - [ ] 
```

然后，您可以对 10 位数字进行正则表达式搜索。

```
\d{10} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-10T00:59:48.743

您是否浏览过regexlib 上的[phone nr 类别。](http://regexlib.com/DisplayPatterns.aspx?cattabindex=6&categoryId=7)似乎很多人做你需要的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-12-20T21:32:33.150

关于richardtallent 提出的观点，此代码将处理您在分机号码方面的大部分问题，并且美国国家代码（+1）被前置。

不是最优雅的解决方案，但我必须快速解决问题，这样我才能继续我正在做的事情。

我希望它可以帮助某人。

```
 Public Shared Function JustNumbers(inputString As String) As String
        Dim outString As String = ""
        Dim nEnds As Integer = -1

        ' Cycle through and test the ASCII character code of each character in the string. Remove everything non-numeric except "x" (in the event an extension is in the string as follows):
        '    331-123-3451 extension 405  becomes 3311233451x405
        '    226-123-4567 ext 405        becomes 2261234567x405
        '    226-123-4567 x 405          becomes 2261234567x405
        For l = 1 To inputString.Length
            Dim tmp As String = Mid(inputString, l, 1)
            If (Asc(tmp) >= 48 And Asc(tmp) <= 57) Then
                outString &= tmp
            ElseIf Asc(tmp.ToLower) = 120
                outString &= tmp
                nEnds = l
            End If
        Next

        ' Remove the leading US country code 1 after doing some validation
        If outString.Length > 0 Then
            If Strings.Left(outString, 1) = "1" Then

                ' If the nEnds flag is still -1, that means no extension was added above, set it to the full length of the string
                ' otherwise, an extension number was detected, and that should be the nEnds (number ends) position.
                If nEnds = -1 Then nEnds = outString.Length

                ' We hit a 10+ digit phone number, this means an area code is prefixed; 
                ' Remove the trailing 1 in case someone put in the US country code
                ' This is technically safe, since there are no US area codes that start with a 1\. The start digits are 2-9
                If nEnds > 10 Then
                    outString = Right(outString, outString.Length - 1)
                End If
            End If
        End If

        Debug.Print(inputString + "          : became : " + outString)

        Return outString
    End Function 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-01-17T18:49:34.680

最简单的解决方案，没有正则表达式：

```
public string DigitsOnly(string s)
   {
     string res = "";
     for (int i = 0; i < s.Length; i++)
     {
       if (Char.IsDigit(s[i]))
        res += s[i];
     }
     return res;
   } 
```

# c# - C# 自动检测代理设置

> ID：844467
> 
> 赞同：26
> 
> 时间：2009-05-10T01:00:53.157
> 
> 标签：c#, networking, proxy

C# 2008 SP1

我正在使用代码来检测是否在“Internet 选项”下设置了代理。如果有代理，那么我将在我的网络客户端中设置它。

所以我只是检查代理的地址是否存在。如果没有，则在 webclient 中没有要设置的代理。

这是正确的方法吗：

非常感谢您的任何建议，

```
WebProxy proxy = WebProxy.GetDefaultProxy();

if (proxy.Address.ToString() != string.Empty)
{
    Console.WriteLine("Proxy URL: " + proxy.Address.ToString());
    wc.Proxy = proxy;
} 
```

====== 代码编辑 ======

```
[DllImport("wininet.dll", CharSet = CharSet.Auto)]
private extern static bool InternetGetConnectedState(ref InternetConnectionState_e lpdwFlags, int dwReserved);

[Flags]
enum InternetConnectionState_e : int
{
    INTERNET_CONNECTION_MODEM = 0x1,
    INTERNET_CONNECTION_LAN = 0x2,
    INTERNET_CONNECTION_PROXY = 0x4,
    INTERNET_RAS_INSTALLED = 0x10,
    INTERNET_CONNECTION_OFFLINE = 0x20,
    INTERNET_CONNECTION_CONFIGURED = 0x40
}     

// Return true or false if connecting through a proxy server
public bool connectingThroughProxy()
{
    InternetConnectionState_e flags = 0;
    InternetGetConnectedState(ref flags, 0);
    bool hasProxy = false;

    if ((flags & InternetConnectionState_e.INTERNET_CONNECTION_PROXY) != 0)
    {
        hasProxy = true;
    }
    else
    {
        hasProxy = false;
    }

    return hasProxy;
} 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2011-06-08T13:14:51.467

看来[WebRequest.DefaultWebProxy](http://msdn.microsoft.com/en-us/library/system.net.webrequest.defaultwebproxy.aspx)是WebProxy.GetDefaultProxy的[官方替代品。](http://www.west-wind.com/weblog/posts/2005/Jul/11/Replacing-deprecated-SystemNetWebProxyGetDefaultProxy-in-NET-20)

您只需稍作修改即可将其放入原始代码中。就像是：

```
WebProxy proxy = (WebProxy) WebRequest.DefaultWebProxy;
if (proxy.Address.AbsoluteUri != string.Empty)
{
    Console.WriteLine("Proxy URL: " + proxy.Address.AbsoluteUri);
    wc.Proxy = proxy;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-10T02:22:21.930

首先，[GetDefaultProxy](http://msdn.microsoft.com/en-us/library/system.net.webproxy.getdefaultproxy.aspx)被标记为已弃用，因此您无法保证即使在不久的将来它也会出现。其次，[Address](http://msdn.microsoft.com/en-us/library/system.net.webproxy.address.aspx)可以为 null，因此您提供的代码可能会出现 NullReferenceException：

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-10T08:51:10.653

`WebClient`等使用 WinHTTP 设置（不是 IE 设置），所以最简单的方法是配置 WinHTTP！在 XP 等上，您可以使用：

```
proxycfg -u 
```

将当前的 IE 设置导入 WinHTTP 存储。之后，`WebClient`等应该能够毫无问题地使用相同的设置。在 Vista 和 Windows 7 上，现在可以在以下位置找到：

```
netsh winhttp import proxy ie 
```

您需要以管理员身份运行它。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-12-18T22:10:40.813

```
<system.net>
<defaultProxy enabled="false" useDefaultCredentials="false">
  <proxy/>
  <bypasslist/>
  <module/>
</defaultProxy> 
```

在 application.config 文件中使用此代码段。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-10-25T09:51:55.753

这对我有用

```
 var proxy = WebRequest.GetSystemWebProxy();
        Uri testUrl = new Uri("http://proxy.example.com");
        var proxyUrl = proxy.GetProxy(testUrl);
        if (proxyUrl != testUrl)
            //Use your proxy here
        else
            //We are not using a proxy 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-06-15T13:41:15.327

尝试以下操作：

```
public string GetMeMyInfo(string searchCriteria)
{
    // Instatiate the web service and declare the necessary variables
    WsService.WsServiceBus oWsGetInfo = new WsService.WsServiceBus();
    // Configure the Web Service Proxy
    oWsGetInfo.Proxy = System.Net.WebProxy.GetDefaultProxy();
    oWsGetInfo.Proxy.Credentials = System.Net.CredentialCache.DefaultCredentials;
    // Invoke the web service
    return oWsGetInfo.GetInfo4Me(searchCriteria);
} 
```

例如，这将在调用您的 Web 服务之前获得默认代理设置和凭据。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-10T01:25:08.370

查看 System.Net.Configuration.ProxyElement 类。这可能有您正在寻找的信息。

你描述的作品，你也可以在注册表中查看。

这是我为检查代理而编写的 powershell 脚本：

```
function get-proxy
{
    $path = "HKCU:\Software\Microsoft\Windows\CurrentVersion\Internet Settings"
    $reg = get-itemproperty $path
    return $reg
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-01-28T21:09:35.400

设置我的请求代理来`WebRequest.GetSystemWebProxy()`解决问题。

`WebProxy.GetDefaultProxy()`是实际的方式，但现在已弃用。

# javascript - XPCOM中的依赖注入

> ID：844481
> 
> 赞同：1
> 
> 时间：2009-05-10T01:13:52.750
> 
> 标签：javascript, dependency-injection, firefox-addon, xpcom

我的一个 XPCOM 组件利用了其他 XPCOM 组件。当我测试它时，我发现它的依赖关系很麻烦。然后我想到了使用依赖注入在我的构造函数中传递其他组件。我没有成功。是否可以将其他组件的引用传递给您的构造函数？

```
 var _foo = Components.classes["@foo.com/foo;1"].createInstance(bar);
 this.foo = _foo.QueryInterface(Components.interfaces.IFoo); 
```

例如 foo 组件需要 bar。我可以通过 foo 的构造函数传入 bar 吗？我尝试了上述方法，但没有奏效。

瓒

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-10-16T07:03:50.083

> 是否可以将其他组件的引用传递给您的构造函数？

不，参数to`createInstance`是一个接口；`.createInstance(interface)`是`.createInstance().QueryInterface(interface)`.

您的问题的答案在于您在问题中没有描述的区域 - 很可能您不需要从“构造函数”访问其他组件，或者您偶然发现了可以解决的问题，而是“繁琐的 cos的依赖关系”并继续前进。

# c# - 复制大文件时表单应用程序“无响应”？

> ID：844482
> 
> 赞同：2
> 
> 时间：2009-05-10T01:14:30.830
> 
> 标签：c#, winforms, file, progress-bar, copying

我有一个正在开发的文件管理器应用程序。这些文件通常为 500MB 到 2GB。一切正常，但应用程序“停止响应”非常烦人。我想做的是在每个读/写操作之后逐个字节或逐个 meg 复制其中一些 Application.DoEvents() 。沿着这些思路，我不知道要使用的实际类是什么，所以我只是要编一些东西:)

```
private void CopyFile(string inFilename, string outFilename)
{
    FileReader inReader(inFilename);
    FileWriter outWriter(outFilename, FileMode.OpenOrCreate);

    byte theByte;
    while (theByte = inReader.ReadByte())
    {
        outWriter.WriteByte(theByte, WriteMode.Append);
        UpdateProgressBar();
        Application.DoEvents();
    }

    inReader.CloseFile();
    outWriter.CloseFile();
} 
```

我知道这似乎应该是一件简单的事情，但在我的一生中，如果不使用直接 API 调用或其他方式，我似乎找不到任何类型的例子来做到这一点。我必须在这里遗漏一些东西，所以如果有人能让我在这里走上正确的轨道，我将非常感激。

提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-10T01:22:12.463

您应该在表单上使用[BackgroundWorker](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)来进行复制。它将允许在单独的线程上完成文件复制，并让您的 UI 响应。有一些额外的复杂性，但 BackgroundWorker 会为您处理很多管道。但是，有很多[你想做](http://www.codeproject.com/KB/cpp/BackgroundWorker_Threads.aspx)的[例子](http://social.msdn.microsoft.com/Forums/en-US/Vsexpressvcs/thread/a285bdb9-6838-48f3-b8ed-1bf0156f8c51)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-10T01:23:09.327

您需要使用**BackgroundWorkerThread**来完成此操作。这是一个很好的例子：[使用后台工作线程复制文件](http://blogs.microsoft.co.il/blogs/gillyb/archive/2008/08/05/ui-multithreading-for-beginners-using-backgroundworker.aspx)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-10T01:37:13.053

我想使用该`CopyFileEx`功能。如果托管框架库中不存在该功能的类似物，那么谷歌无论如何如何使用它：也许像[http://www.thetechscene.com/2008/09/copyfileex-with-progress-callback这样的文章-in-c-使用-pinvoke/](http://www.thetechscene.com/2008/09/copyfileex-with-progress-callback-in-c-using-pinvoke/)

我想使用的原因`CopyFileEx`是我假设它是在 O/S 内核中实现的，数据在文件系统驱动程序中从一个文件复制到另一个文件，而不使用用户内存（更不用说托管内存）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-10T01:22:26.630

Threading.ThreadPool.QueueUserWorkitem 应该让您顺利进行。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-10T01:24:10.870

一种方法是在单独的线程中执行复制操作。当线程执行复制文件的工作时，您的主应用程序将继续正常运行。您当然希望在线程和主应用程序之间添加通信，以便您可以更新进度条或类似的反馈机制。

如果您不想处理多个线程，另一种方法是创建一个包含用于复制操作的状态变量的类和一个从主应用程序定期调用的成员函数，以便在每次调用时复制一定数量的字节.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-11T00:30:06.360

你这里有两个问题。首先是 GUI 线程在复制大文件时没有响应。正如其他人所建议的那样，您应该使用后台线程来解决这个问题。

另一个问题是您当前的文件复制例程不支持进度回调函数。以下问题的公认答案包含您编写自己的解决方案所需的信息：

[我可以在 .NET 中使用 FileInfo.CopyTo() 显示文件复制进度吗？](https://stackoverflow.com/questions/187768/can-i-show-file-copy-progress-using-fileinfocopyto-in-net)

编辑：我刚刚[为 CopyFileEx 找到了这个包装类](http://msdn.microsoft.com/en-us/magazine/cc163851.aspx)。我测试了它，效果很好！

```
using System;
using System.ComponentModel;
using System.IO;
using System.Runtime.InteropServices;
using System.Security;
using System.Security.Permissions;

namespace FileCopyTest {
    public sealed class FileRoutines {
        public static void CopyFile(FileInfo source, FileInfo destination) {
            CopyFile(source, destination, CopyFileOptions.None);
        }

        public static void CopyFile(FileInfo source, FileInfo destination,
            CopyFileOptions options) {
            CopyFile(source, destination, options, null);
        }

        public static void CopyFile(FileInfo source, FileInfo destination,
            CopyFileOptions options, CopyFileCallback callback) {
            CopyFile(source, destination, options, callback, null);
        }

        public static void CopyFile(FileInfo source, FileInfo destination,
            CopyFileOptions options, CopyFileCallback callback, object state) {
            if (source == null) throw new ArgumentNullException("source");
            if (destination == null)
                throw new ArgumentNullException("destination");
            if ((options & ~CopyFileOptions.All) != 0)
                throw new ArgumentOutOfRangeException("options");

            new FileIOPermission(
                FileIOPermissionAccess.Read, source.FullName).Demand();
            new FileIOPermission(
                FileIOPermissionAccess.Write, destination.FullName).Demand();

            CopyProgressRoutine cpr = callback == null ?
                null : new CopyProgressRoutine(new CopyProgressData(
                    source, destination, callback, state).CallbackHandler);

            bool cancel = false;
            if (!CopyFileEx(source.FullName, destination.FullName, cpr,
                IntPtr.Zero, ref cancel, (int)options)) {
                throw new IOException(new Win32Exception().Message);
            }
        }

        private class CopyProgressData {
            private FileInfo _source = null;
            private FileInfo _destination = null;
            private CopyFileCallback _callback = null;
            private object _state = null;

            public CopyProgressData(FileInfo source, FileInfo destination,
                CopyFileCallback callback, object state) {
                _source = source;
                _destination = destination;
                _callback = callback;
                _state = state;
            }

            public int CallbackHandler(
                long totalFileSize, long totalBytesTransferred,
                long streamSize, long streamBytesTransferred,
                int streamNumber, int callbackReason,
                IntPtr sourceFile, IntPtr destinationFile, IntPtr data) {
                return (int)_callback(_source, _destination, _state,
                    totalFileSize, totalBytesTransferred);
            }
        }

        private delegate int CopyProgressRoutine(
            long totalFileSize, long TotalBytesTransferred, long streamSize,
            long streamBytesTransferred, int streamNumber, int callbackReason,
            IntPtr sourceFile, IntPtr destinationFile, IntPtr data);

        [SuppressUnmanagedCodeSecurity]
        [DllImport("Kernel32.dll", CharSet = CharSet.Auto, SetLastError = true)]
        private static extern bool CopyFileEx(
            string lpExistingFileName, string lpNewFileName,
            CopyProgressRoutine lpProgressRoutine,
            IntPtr lpData, ref bool pbCancel, int dwCopyFlags);
    }

    public delegate CopyFileCallbackAction CopyFileCallback(
        FileInfo source, FileInfo destination, object state,
        long totalFileSize, long totalBytesTransferred);

    public enum CopyFileCallbackAction {
        Continue = 0,
        Cancel = 1,
        Stop = 2,
        Quiet = 3
    }

    [Flags]
    public enum CopyFileOptions {
        None = 0x0,
        FailIfDestinationExists = 0x1,
        Restartable = 0x2,
        AllowDecryptedDestination = 0x8,
        All = FailIfDestinationExists | Restartable | AllowDecryptedDestination
    }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-11T00:46:03.103

除了运行后台线程之外，您还应该注意，您*一次一个字节地*复制了 512M-2G 的数据。这将转化为对 ReadByte 和 WriteByte 的多达 20 亿次调用**。**希望这些调用在某处缓冲，这样您就不会将 20**亿**次托管转换为非托管转换，但即便如此，这肯定会加起来。

内存不是免费的，但肯定很便宜。分配一个缓冲区（可能是 16K-64K）并分块复制。不，代码并不像您需要处理一种不读取整个块的情况那样简单，但我宁愿使用 2G/64K 方法调用而不是 2G。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-10T01:17:43.647

您真正想要做的是拥有一个多线程应用程序并在后台线程中进行文件复制，这样您的主线程就不会被束缚。

# python - 图形库（例如 NetworkX）是我的 Python 问题的正确解决方案吗？

> ID：844505
> 
> 赞同：2
> 
> 时间：2009-05-10T01:34:33.777
> 
> 标签：python, graph

我正在用 Python 重写一个数据驱动的遗留应用程序。其中一个主表被称为“图形表”，并且看起来确实是有向图，所以我正在探索 NetworkX 包，看看将它用于图形表操作是否有意义，并真正实现它是一个图形，而不是一组复杂的数组。

但是，我开始怀疑我们使用此表的方式是否不适合实际的图形操作库。NetworkX 的大部分功能似乎都倾向于以某种方式表征图本身，确定两个节点之间的最短距离，诸如此类。这些都与我的申请无关。

我希望如果我可以在这里描述实际用法，有人可以告诉我我是否只是遗漏了一些东西——我以前从未真正使用过图表，所以这是很有可能的——或者我是否应该探索其他一些东西数据结构。（如果是这样，你有什么建议？）

我们主要使用该表将用户提供的关键字字符串转换为组件的有序列表。这构成了 95% 的用例；其他 5% 是“给定部分关键字字符串，提供所有可能的补全”和“生成所有可能的合法关键字字符串”。哦，并验证图表是否存在畸形。

这是该表的编辑摘录。列是：

关键字 innode outnode 组件

```
acs 1 20 clear
default 1 100 clear
noota 20 30 clear
default 20 30 hst_ota
ota 20 30 hst_ota
acs 30 10000 clear
cos 30 11000 clear
sbc 10000 10199 clear
hrc 10000 10150 clear
wfc1 10000 10100 clear
default 10100 10101 clear
default 10101 10130 acs_wfc_im123
f606w 10130 10140 acs_f606w
f550m 10130 10140 acs_f550m
f555w 10130 10140 acs_f555w
default 10140 10300 clear
wfc1 10300 10310 acs_wfc_ebe_win12f
default 10310 10320 acs_wfc_ccd1 
```

给定关键字字符串“acs,wfc1,f555w”和这个表，遍历逻辑是：

*   从节点 1 开始；“acs”在字符串中，所以转到节点 20。

*   节点 20 的所有关键字都不在字符串中，因此选择默认值，选择 hst_ota，然后转到节点 30。

*   “acs”在字符串中，所以转到节点 10000。

*   “wfc1”在字符串中，所以转到节点 10100。

*   只有一种选择；转到节点 10101。

*   只有一个选择，所以拿起 acs_wfc_im123 并转到节点 10130。

*   “f555w”在字符串中，所以选择 acs_f555w 并转到节点 10140。

*   只有一个选择，所以转到节点 10300。

*   “wfc1”在字符串中，所以选择 acs_wfc_ebe_win12f 并转到节点 10310。

*   只有一个选择，所以拿起 acs_wfc_ccd1 并转到节点 10320——它不存在，所以我们完成了。

因此最终的组件列表是

```
hst_ota
acs_wfc_im123
acs_f555w
acs_wfc_ebe_win12f
acs_wfc_ccd1 
```

我可以仅从该表的 innodes 和 outnodes 制作一个图表，但我一生都无法弄清楚如何构建关键字信息，以确定在面对多种可能性时做出哪个选择。

更新以添加其他用例的示例：

*   给定一个字符串 "acs"，返回 ("hrc","wfc1") 作为可能的合法下一个选择

*   给定字符串“acs, wfc1, foo”，由于未使用的关键字引发异常

*   返回所有可能的合法字符串：

    *   因
    *   acs, 人力资源委员会
    *   acs, wfc1, f606w
    *   acs, wfc1, f550m
    *   acs, wfc1, f555w
*   验证所有节点都可以到达并且没有循环。

我可以为其中的前两个调整 Alex 的解决方案，但我不知道如何为最后两个做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-10T16:57:30.567

绝对不适合通用图形库（如果输入字符串中有多个在节点中有意义的单词，你应该做什么——这是错误吗？——或者如果没有，并且没有默认值对于节点，与您提供的示例中的节点 30 一样）。只需将表写为从节点到元组的字典（默认内容，从单词到特定内容的字典），其中每个内容都是元组（目标，要添加的单词）（并使用 None 作为特殊的“要添加的单词” " `clear`)。所以例如：

```
tab = {1: (100, None), {'acs': (20, None)}),
       20: ((30, 'hst_ota'), {'ota': (30, 'hst_ota'), 'noota': (30, None)}),
       30: ((None, None), {'acs': (10000,None), 'cos':(11000,None)}),
       etc etc 
```

现在处理这个表和输入逗号分隔的字符串很容易，这要归功于设置操作——例如：

```
def f(icss):
  kws = set(icss.split(','))
  N = 1
  while N in tab:
    stuff, others = tab[N]
    found = kws & set(others)
    if found:
      # maybe error if len(found) > 1 ?
      stuff = others[found.pop()]
    N, word_to_add = stuff
    if word_to_add is not None:
      print word_to_add 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T07:13:35.890

添加答案以响应在...中新编辑的进一步要求：我仍然不会选择通用库。对于“所有节点都可以到达并且没有循环”，简单地根据集合进行推理（忽略触发关键字）应该这样做：（再次未经测试的代码，但即使有一些错字&c，总体大纲也应该有所帮助）：

```
def add_descendants(someset, node):
  "auxiliary function: add all descendants of node to someset"
  stuff, others = tab[node]
  othernode, _ = stuff
  if othernode is not None:
    someset.add(othernode)
  for othernode, _ in others.values():
    if othernode is not None:
      someset.add(othernode)

def islegal():
  "Return bool, message (bool is True for OK tab, False if not OK)"
  # make set of all nodes ever mentioned in the table
  all_nodes = set()
  for node in tab:
    all_nodes.add(node)
    add_desendants(all_nodes, node)

  # check for loops and connectivity
  previously_seen = set()
  currently_seen = set([1])
  while currently_seen:
    node = currently_seen.pop()
    if node in previously_seen:
      return False, "loop involving node %s" % node
    previously_seen.add(node)
    add_descendants(currently_seen, node)

  unreachable = all_nodes - currently_seen
  if unreachable:
    return False, "%d unreachable nodes: %s" % (len(unreachable), unreachable)
  else:
    terminal = currently_seen - set(tab)
    if terminal:
      return True, "%d terminal nodes: %s" % (len(terminal), terminal)
    return True, "Everything hunky-dory" 
```

对于“合法字符串”，您将需要一些其他代码，但我无法为您编写它，因为我还不明白是什么使字符串合法或其他......！

# php - 如何计算网络直径

> ID：844508
> 
> 赞同：3
> 
> 时间：2009-05-10T01:40:56.383
> 
> 标签：php, mysql, algorithm, networking

我将数据存储在关系数据库 mysql 和 PHP 中。我有一个名为“rel”的表，它有两个字段：

```
from_node  |  to_node
=====================
1               2
1               3
2               3 
```

等等......

如何计算网络的网络直径。我知道这是任何两对之间最长或最短的路径，但我该如何计算呢？是否有任何 PHP 脚本或函数可以帮助我做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-10T06:17:05.203

假设您有一个连通图（否则最大距离是无限的）并且您的所有节点点都是数字......

使用 (from_node, to_node, 1) 为表 (from, to, distance) 播种。对于每个元组，必须确保 from_node 的值始终小于 to_node 的值

```
CREATE TABLE hops (
    from_node int not null,
    to_node int not null,
    distance int not null default 0,
    primary key (from_node, to_node, distance)
)

-- first load:
INSERT INTO hops (from_node, to_node)
SELECT from_node, to_node FROM rel;

-- iterative step
INSERT INTO hops (from_node, to_node, distance)
SELECT a.from_node, b.to_node, min(a.distance+b.distance)
FROM hops a, hops b
WHERE a.to_node = b.from_node
  AND a.from_node <> b.from_node  -- not self
  AND a.to_node <> b.to_node      -- still not self
  AND a.from_node <> b.from_node  -- no loops
  AND NOT EXISTS (                -- avoid duplicates
          SELECT * FROM hops c
          WHERE c.from_node = a.from_node
            AND c.to_node = b.to_node
            AND c.distance = a.distance+b.distance)
GROUP BY a.from_node, b.to_node 
```

重复执行插入，直到没有插入任何行。然后选择最大距离以获得您的直径。

编辑：对于具有加权顶点的图，您只需使用权重而不是使用 1 来播种距离场。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-10T01:50:19.760

在您的示例中，您显示每个节点都链接到其他每个节点。如果在整个设置过程中都是这种情况，则直径为 1。

如果您的设置是像这样以线性形式出现的线：

```
n=1, n = 2, n = 3, ... n 
```

那么你的直径是 (n+1)/3。

如果您的设置更不规则，具有一系列 N 个节点和 K 个链接，那么您的直径*至少为* `logN/LogK`

**编辑：**为了澄清，我正在计算节点对之间的平均最短距离。

```
n1 - n2 - n3
(n+1)/3 = 4/3

n1-n2 = 1 hop
n2 - n3 = 1 hop
n1- n2 - n3 = 2 hops
(1+1+2)/3 = 4/3 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-10T01:53:07.633

请参阅有关与距离和直径相关的图形（网络）术语的[Wikipedia 文章](http://en.wikipedia.org/wiki/Graph_diameter)。它提到了一些关于如何找到直径的注释。[关于图的连通分量的文章的这一部分](http://en.wikipedia.org/wiki/Connected_component_%28graph_theory%29#Algorithms)还建议了一种算法来发现这些连通分量，可以很容易地调整它来告诉您图的直径。（如果有多个组件，那么我相信直径是无限的。）该算法是一种基于面包/深度优先搜索的简单算法，因此实现起来应该不会很麻烦，效率也不应该一个很大的问题。

如果你不适合写这篇文章（尽管我认为这不会花费太多精力），我建议寻找一个好的网络/图形分析库。那里有一些，但我不确定您想使用 PHP 看看哪些。（你可能不得不使用某种互操作。）

无论如何，希望这会有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-10T03:31:55.350

我真的认为你的意思是你想找到一个网络的[集群系数](http://en.wikipedia.org/wiki/Clustering_coefficient)。此外，您想在 PHP 中执行此操作。不知道有多少好的网络分析库被移植到了 PHP 扩展中。

但是，如果您按照文章进行操作，则想出自己的文章应该不会（太）困难。你不需要生成漂亮的图表，你只需要找到系数。

如果这不是您的意思，请更新/澄清您的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-10T06:25:47.540

网络是一个连通图。那么为什么不尝试从数据中构建一些图形表示并在此基础上执行 BFS 或 DFS？你会得到你正在寻找的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-10T06:47:40.170

这很简单：

*   **准备**
    *   添加一个名为的列`distance`
    *   给所有节点的距离`-1`
*   **第一次迭代**
    *   选择任何节点（例如第一个）
    *   给它的距离`1`
    *   现在迭代直到有距离的节点`-1`
        *   `UPDATE table SET distance=:i+1 WHERE from_node IN (SELECT to_node FROM table WHERE distance=:i)`
*   **第二次迭代**
    *   选择一个距离最大的节点（任意）——记住它
    *   将所有距离设置回`-1`
    *   将您的记忆节点设置为`1`
    *   再次调用迭代

这次最大距离是图形/网络的直径。

# grails - 为什么没有更多的人使用 Grails？

> ID：844520
> 
> 赞同：2
> 
> 时间：2009-05-10T01:51:26.000
> 
> 标签：grails, groovy

我最近一直在学习 Groovy 和 Grails，就开发人员的生产力而言，它似乎比其他 Java 解决方案（Spring、Struts、EJB、JSF）领先了光年。如果我搜索 monster.ca，无论是 Groovy 还是 Grails，都会返回 0 个匹配项，这表明 Grails 在采用方面做得不太好。

我意识到：

*   Grails 相对较新，采用需要时间
*   一项技术的成功不仅仅取决于它的技术优点（例如营销费用）
*   Monster.ca 上的搜索结果充其量只是全球采用的一个非常粗略的代理。可能有很多人在使用它，只是不在加拿大，或者正在使用它的加拿大公司目前根本没有招聘

还有其他原因导致它没有被采用到它似乎“应得”的程度吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-10T01:59:13.560

使用 Grails 的人可能比你想象的要多。工作委员会向您展示人们正在寻找的技能是什么。Grails 是相当新的，在就业市场上并没有很多人使用它。

Grails，尤其是 Groovy，与 Java 非常接近。一些关于 Groovy 和 Java 开发人员的快速课程，很快就会有宾至如归的感觉。你可以很容易地获得一个普通的 Java 开发人员的帖子，并让那个人进入一个使用 grails 开发的位置。

我想说随着越来越多的 Java 商店采用这些技术，您将在未来看到更多 Groovy/Grails 的帖子。

# sql-server - 如何用随机数填充数据库列

> ID：844527
> 
> 赞同：1
> 
> 时间：2009-05-10T02:00:53.200
> 
> 标签：sql-server, database, sql

如何使用没有重复的随机数填充当前为空的 int 列？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-10T02:09:03.727

如果这是您添加了新 INT 列的现有表，则可以执行以下操作：

```
UPDATE MyTable
SET MyIntColumn = CONVERT(int, RAND(CHECKSUM(NEWID())) * 10000); 
```

这将使用 1 到 10000 之间的随机数填充空列。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-10T02:04:14.393

我想您可以将该列设置为主键以防止重复，尽管这是一种黑客行为。您可以稍后删除密钥。

```
---- Create the variables for the random number generation
DECLARE @Random INT;
DECLARE @Upper INT;
DECLARE @Lower INT;
DECLARE @Index integer

---- This will create a random number between 1 and 999
SET @Lower = 1 ---- The lowest random number
SET @Upper = 999 ---- The highest random number
SET @Index = 0 --- A while loop counter

--- Loop from 0 to 10
WHILE @Index < 10
BEGIN
  SELECT 'loop counter = ', @index
  SELECT @Random = ROUND(((@Upper - @Lower -1) * RAND() + @Lower), 0)
  --Insert @Random here.
  SET @index = @index + 1
END 
```

# wpf - WPF - 动态与静态资源

> ID：844531
> 
> 赞同：3
> 
> 时间：2009-05-10T02:07:49.127
> 
> 标签：wpf, performance, memory, resources

我在我的 WPF 项目中遇到了巨大的内存泄漏，并试图找出我可以做些什么来最小化它。为了访问资源，我 100% 的时间都使用 StaticResource。我应该尽可能使用 DynamicResource 吗？在 StaticResource 和 DynamicResource 之间的内存管理方面是否有优势？

仅供参考：我有一个通过 DataTemplate 显示数据的列表框。当用户向上/向下滚动时，内存会快速增加，只需向上/向下滚动几分钟即可达到 1GB。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-10T04:18:32.883

这不太可能是 StaticResource / DynamicResource 的事情。静态和动态指的是查找策略，而不是保留策略：

*   StaticResource 的意思是“查找资源一次，然后继续使用相同的值”。

*   DynamicResource 的意思是“每次需要时查找资源，以防值发生变化”。

因此，您所做的事情听起来是正确的：将 StaticResource 用于不变的资源，例如 DataTemplates（并为可能更改的资源保留 DynamicResource，例如如果用户更改系统配色方案可能会更改的系统画笔）。通过 StaticResource 引用分配 DataTemplate 不会比通过 DynamicResource 引用分配它消耗更多的内存，并且长期会更便宜，因为 WPF 不必继续返回并重新评估引用。

更有可能的是，您的模板本身正在做一些事情，当模板被应用（在数据项上实例化）时，正在以泄漏的方式分配内存（或间接导致分配内存）。我看到的一个违反直觉的原因是模板是否使用旧式位图效果。另一个是如果模板调用与事件处理程序挂钩的代码隐藏。但是这些都不会受到您引用模板资源的方式的影响。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-13T15:07:59.043

据我所知，客户端的操作系统非常重要。

WPF 旨在为 Vista 和更高版本的系统 (Windows 7) 工作。xp 用户可能会遇到性能问题。

# frameworks - MVC 和 NHibernate 的框架

> ID：844534
> 
> 赞同：2
> 
> 时间：2009-05-10T02:09:26.563
> 
> 标签：frameworks, s#arp-architecture

我目前正在研究 S#arp 架构。它似乎还太年轻，无法在此基础上开发任何东西。

S#arp 是否有任何替代方案，包括对 NHibernate（流利的加号）、测试和 MVC 的支持？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-10T02:35:28.950

我强烈建议您选择 ASP.NET MVC 并使用 fluent nhibernate 作为您的存储库。虽然夏普架构也很酷。

# functional-programming - 无状态编程的优点？

> ID：844536
> 
> 赞同：148
> 
> 时间：2009-05-10T02:09:53.223
> 
> 标签：functional-programming, state, immutability

我最近一直在学习函数式编程（特别是 Haskell，但我也阅读了有关 Lisp 和 Erlang 的教程）。虽然我发现这些概念很有启发性，但我仍然看不到“无副作用”概念的实际方面。它的实际优势是什么？我试图以函数式思维方式思考，但有些情况似乎过于复杂，无法以简单的方式保存状态（我不认为 Haskell 的 monads '容易'）。

是否值得继续深入学习 Haskell（或另一种纯函数式语言）？函数式编程或无状态编程实际上比程序式编程更有效率吗？以后有可能我会继续使用 Haskell 或其他函数式语言，还是应该只是为了理解而学习它？

我关心的不是性能而是生产力。所以我主要是问我是否会比使用过程/面向对象/其他语言更高效。

* * *

## 回答 #1

> 赞同：182
> 
> 时间：2009-05-10T02:20:28.067

阅读[简而言之的函数式编程](http://www.defmacro.org/ramblings/fp.html)。

无状态编程有很多优点，尤其是*显着的*多线程和并发代码。说白了，可变状态是多线程代码的敌人。如果默认值是不可变的，程序员就不需要担心一个线程改变两个线程之间共享状态的值，因此它消除了与竞争条件相关的一整类多线程错误。由于没有竞争条件，因此也没有理由使用锁，因此不变性也消除了与死锁相关的另一类错误。

这就是函数式编程很重要的一个重要原因，并且可能是跳上函数式编程火车的最佳选择。还有许多其他好处，包括简化调试（即函数是纯粹的，不会在应用程序的其他部分改变状态），更简洁和富有表现力的代码，与严重依赖设计模式的语言相比，样板代码更少，以及编译器可以更积极地优化您的代码。

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2009-05-10T02:39:37.177

程序的无状态片段**越多，将片段组合在一起而不会出现任何中断的方法就越多**。无状态范式的力量不在于无状态（或纯度）*本身*，而在于它赋予您编写强大、*可重用*的函数并将它们组合起来的能力。

[您可以在 John Hughes 的论文Why Functional Programming Matters](http://www.cs.kent.ac.uk/people/staff/dat/miranda/whyfp90.pdf) (PDF)中找到包含大量示例的优秀教程。

你的工作效率会*更高*，尤其是如果你选择一种同时具有代数数据类型和模式匹配的函数式语言（Caml、SML、Haskell）。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-05-10T04:14:48.103

许多其他答案都集中在函数式编程的性能（并行性）方面，我认为这非常重要。但是，您确实特别询问了生产力，例如，您是否可以在功能范式中比在命令式范式中更快地编程相同的东西。

实际上，我发现（根据个人经验）在 F# 中编程更符合我的想法，因此更容易。我认为这是最大的不同。我在 F# 和 C# 中都进行过编程，而且我喜欢的 F# 中“与语言对抗”的情况要少得多。您不必考虑 F# 中的细节。以下是一些我发现我真正喜欢的例子。

例如，即使 F# 是静态类型的（所有类型都在编译时解析），类型推断会确定您拥有哪些类型，因此您不必说出来。如果它无法弄清楚，它会自动使您的函数/类/任何通用。所以你永远不必写任何通用的东西，这都是自动的。我发现这意味着我花更多的时间思考这个问题，而不是如何实施它。事实上，每当我回到 C# 时，我发现我真的很怀念这种类型推断，你永远不会意识到它是多么让人分心，直到你不再需要这样做。

同样在 F# 中，您调用函数而不是编写循环。这是一个微妙的变化，但意义重大，因为您不必再​​考虑循环构造了。例如，这是一段代码，它会通过并匹配一些东西（我不记得是什么，它来自一个项目 Euler 谜题）：

```
let matchingFactors =
    factors
    |> Seq.filter (fun x -> largestPalindrome % x = 0)
    |> Seq.map (fun x -> (x, largestPalindrome / x)) 
```

我意识到在 C# 中先做一个过滤器然后再做一个映射（即每个元素的转换）会很简单，但你必须在较低的层次上思考。特别是，您必须自己编写循环，并拥有自己的显式 if 语句以及诸如此类的东西。自从学习了 F#，我意识到我发现用函数式编码更容易，如果你想过滤，你写“过滤器”，如果你想映射，你写“映射”，而不是实现每一个细节。

我也喜欢 |> 运算符，我认为它将 F# 与 ocaml 以及可能的其他函数式语言区分开来。它是管道运算符，它允许您将一个表达式的输出“管道”到另一个表达式的输入。它使代码更符合我的想法。就像上面的代码片段一样，这就是说，“获取因子序列，过滤它，然后映射它。” 这是一种非常高级的思维方式，因为您正忙于编写循环和 if 语句，所以您无法在命令式编程语言中获得这种思维方式。每当我进入另一种语言时，这是我最想念的一件事。

所以总的来说，即使我可以同时使用 C# 和 F# 编程，我发现使用 F# 更容易，因为你可以在更高的层次上思考。我会争辩说，因为从函数式编程中删除了较小的细节（至少在 F# 中），所以我的工作效率更高。

**编辑**：我在其中一条评论中看到您要求提供函数式编程语言中的“状态”示例。F# 可以强制编写，因此这里有一个直接示例，说明如何在 F# 中拥有可变状态：

```
let mutable x = 5
for i in 1..10 do
    x <- x + i 
```

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-05-10T05:11:07.703

考虑一下您花了很长时间调试的所有困难错误。

现在，这些错误中有多少是由于程序的两个独立组件之间的“意外交互”造成的？（几乎所有线程错误都有这种形式：涉及写入共享数据的竞争、死锁……此外，通常会发现对全局状态有一些意想不到的影响的库，或者读/写注册表/环境等。） *我*会假设至少有三分之一的“硬错误”属于这一类。

现在，如果您切换到无状态/不可变/纯编程，所有这些错误都会消失。相反，您会遇到一些新的挑战（例如，当您*确实*希望不同的模块与环境交互时），但是在像 Haskell 这样的语言中，这些交互会显式地具体化到类型系统中，这意味着您可以只查看关于它可以与程序的其余部分进行的交互类型的功能和原因。

这是“不变性”IMO 的巨大胜利。在一个理想的世界里，我们都会设计很棒的 AP​​I，即使事情是可变的，效果也会是本地的并且有据可查，并且“意外”的交互将保持在最低限度。在现实世界中，有很多 API 以多种方式与全局状态交互，而这些是最有害的错误的来源。渴望无状态就是渴望摆脱组件之间的意外/隐式/幕后交互。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-05-10T02:31:04.187

无状态函数的一个优点是它们允许预先计算或缓存函数的返回值。甚至一些 C 编译器也允许您将函数显式标记为无状态以提高它们的可优化性。正如许多其他人所指出的，无状态函数更容易并行化。

但效率并不是唯一的问题。纯函数更容易测试和调试，因为任何影响它的东西都被明确说明。当使用函数式语言进行编程时，人们会养成尽可能少的“脏”函数（使用 I/O 等）的习惯。以这种方式分离有状态的东西是设计程序的好方法，即使在功能不那么强大的语言中也是如此。

函数式语言可能需要一段时间才能“获得”，而且很难向没有经历过这个过程的人解释。但是大多数坚持了足够长的人最终意识到大惊小怪是值得的，即使他们最终没有过多地使用函数式语言。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-05-10T02:12:39.613

没有状态，很容易自动并行化您的代码（因为 CPU 具有越来越多的内核，这非常重要）。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2013-08-22T12:47:09.610

当您开始拥有更高的流量时，无状态 Web 应用程序是必不可少的。

例如，出于安全原因，您可能不想将大量用户数据存储在客户端。在这种情况下，您需要将其存储在服务器端。您可以使用 Web 应用程序默认会话，但如果您有多个应用程序实例，则需要确保每个用户始终指向同一个实例。

负载均衡器通常具有“粘性会话”的能力，负载均衡器在某种程度上知道将用户请求发送到哪个服务器。虽然这并不理想，例如，这意味着每次重新启动 Web 应用程序时，所有连接的用户都将失去他们的会话。

更好的方法是将会话存储在 Web 服务器后面的某种数据存储中，现在有很多很棒的 nosql 产品可用于此（redis、mongo、elasticsearch、memcached）。这样，Web 服务器是无状态的，但您仍然拥有状态服务器端，并且可以通过选择正确的数据存储设置来管理此状态的可用性。这些数据存储通常具有很大的冗余，因此几乎总是可以对您的 Web 应用程序甚至数据存储进行更改而不会影响用户。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2010-01-27T23:25:33.100

不久前我就这个主题写了一篇文章：[关于纯度的重要性](http://higherlogics.blogspot.com/2007/10/on-importance-of-purity.html)。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2021-06-29T18:25:24.910

我的理解是 FP 对测试也有巨大的影响。没有可变状态通常会迫使您为函数提供比为类提供更多的数据。有一些权衡，但想想测试一个“incrementNumberByN”而不是“Counter”类的函数是多么容易。

目的

```
describe("counter", () => {
    it("should increment the count by one when 'increment' invoked without 
    argument", () => {
       const counter = new Counter(0)
       counter.increment()
       expect(counter.count).toBe(1)
    })
   it("should increment the count by n when 'increment' invoked with 
    argument", () => {
       const counter = new Counter(0)
       counter.increment(2)
       expect(counter.count).toBe(2)
    })
}) 
```

功能性的

```
 describe("incrementNumberBy(startingNumber, increment)", () => {

   it("should increment by 1 if n not supplied"){
      expect(incrementNumberBy(0)).toBe(1)
   }

   it("should increment by 1 if n = 1 supplied"){
      expect(countBy(0, 1)).toBe(1)
   }

 }) 
```

由于该函数没有状态并且输入的数据更明确，因此当您试图找出测试可能失败的原因时，需要关注的事情更少。在我们必须做的柜台测试中

```
 const counter = new Counter(0)
       counter.increment()
       expect(counter.count).toBe(1) 
```

前两行都对 的值有贡献`counter.count`。在像这样的简单示例中，1 对 2 行可能有问题的代码没什么大不了的，但是当您处理更复杂的对象时，您的测试也可能会增加大量复杂性。

相反，当您使用函数式语言编写项目时，它会促使您保持花哨的算法依赖于流入和流出特定函数的数据，而不是依赖于系统的状态。

另一种看待它的方式是说明在每个范例中测试系统的心态。

对于函数式编程：确保函数 A 适用于给定输入，确保函数 B 适用于给定输入，确保 C 使用给定输入。

对于 OOP：在对对象的状态执行 Y 和 Z 之后，确保对象 A 的方法在给定输入参数 X 的情况下有效。在对对象的状态执行 W 和 Y 之后，确保对象 B 的方法在给定输入参数 X 的情况下有效。

# excel - Excel确定范围

> ID：844541
> 
> 赞同：0
> 
> 时间：2009-05-10T02:14:14.977
> 
> 标签：excel, vba, excel-formula, variance

我正在创建一个包含一列数据的电子表格，我想根据输入的 x 计算 x 行数的方差。有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-10T15:07:30.187

正如 Matthew Flaschen 所建议的，不需要 VBA。这可以通过 Excel 公式来完成。

假设您的数据在 A 列中，从 A1 开始向下。假设单元格 B1 有数字 x，这是您希望使用的样本大小。

那么你需要的公式应该是：

```
=VAR(OFFSET(A1,0,0,B1,1)) 
```

VAR 部分表示计算总体样本的方差，忽略非数字。（函数的变体包括整个人口的 VARP，包括非数字的 VARA 和两者的 VARPA）。

Offset 部分表示从单元格 A1 开始，移动 0 列，向下移动 0 列，然后选择一个 B1 列高和一列宽的范围。

# visual-studio-2008 - 无法在 Visual Studio 中打开 Silverlight 应用程序

> ID：844550
> 
> 赞同：3
> 
> 时间：2009-05-10T02:21:00.077
> 
> 标签：visual-studio-2008, silverlight

这是关于安装了 resharper 和 testdriven 的 Visual Studio pro 2008 sp1。

我刚刚安装：Microsoft Silverlight Projects 2008 版本 9.0.30729.146

我发现由于“缺少补丁”而无法打开 Silverlight 应用程序。错误对话框将我引导回刚刚安装的 silverlight 工具的下载页面。（并卸载并重新安装。）我从未安装过任何测试版。这个错误的谷歌点击转到引用测试版问题的博客页面，以及我已经安装的相同下载。

在这一点上，这对于使用 silverlight 做任何事情都不是好兆头，这些工具甚至都不会运行。在这一点上，我真的不希望另一个研究项目只是为了让它运行。希望有人知道一个简单的解决方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-10T09:38:55.330

无用的错误消息应显示“未安装视觉 Web 开发人员”。他们不会在工具安装期间检查这个关键的先决条件。而且你安装了visual studio sp1之后就不能再安装visual web developer了。vs2008 必须卸载、重新安装并应用 sp1。然后必须卸载silverlight工具，重新安装。真是笑话。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-09-23T20:50:04.497

我昨天和今天的大部分时间都花在了这个问题上。使用 VS 2010 和 Silverlight 4。项目在 Blend 中打开正常，但我收到错误“此安装不支持项目类型”。在 VS 中。

似乎很重要的三件事是安装这些项目：

*   VS Web 开发工具。从程序和功能控制面板执行此操作。--- 选择你的 VS 产品，然后卸载/更改。安装程序将在维护模式下打开。--- 加载完成后，点击下一步。--- 选择添加/删除功能选项并选择**Visual Web Developer**。这似乎是关键。我只安装了它和 C# 并且它可以工作。

*   面向开发人员的 Silverlight 插件。VS 将通过错误对话框和链接提示您。单击它并安装。我正在使用lameo IE，所以现在我重新启动后找不到URL。

*   用于 VS 的 Silverlight 4 工具。--- [http://www.microsoft.com/download/en/confirmation.aspx?id=18149](http://www.microsoft.com/download/en/confirmation.aspx?id=18149) --- 使用此链接。我使用了其他链接，显然它们不是正确的东西。

我还安装了 VS 2010 SP 1 软件包，但老实说，不知道这是否会有所不同。这三个 SL 项目显示没有错误。希望这对某人有帮助！

# php - 如何将参数从动作传递到 Symfony 中的布局

> ID：844553
> 
> 赞同：4
> 
> 时间：2009-05-10T02:24:32.347
> 
> 标签：php, symfony1

全局 layout.php 文件包含每个页面的标签：

```
<body> 
    <?php echo $sf_content ?>
</body> 
```

但是对于我网站的所有内部 HTML 页面，将一个类应用于 body 标记：

```
 <body class="inner-page"> 
    <?php echo $sf_content ?>
 </body> 
```

如何将一个类从不同的模板传递给布局？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-10T02:57:49.443

在你的 layout.php

```
<body <?php if (!include_slot('body_id')): ?>id="default"<?php endif; ?>> 
```

在您的模板中：

```
<?php slot('body_id') ?>id="bla"<?php end_slot(); ?> 
```

或者

```
<?php slot(
  'body_id',
  sprintf('id="%s"', $sf_params->get('module')))
?> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-10T02:57:54.340

这是我在 Symfony 1.2+ 中使用的解决方案

在操作中使用 setSlot()：

```
$this->getResponse()->setSlot('home_page', 'yes'); 
```

然后在布局中使用 get_slot() ：

```
<body class="<?php echo has_slot('home_page') ? 'home-page' : 'inner-page' ?>"> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-10T02:47:41.743

在大多数 MVC 框架中，您在布局中访问变量的方式与在视图文件中访问变量的方式相同。

所以，如果你做了类似 $this->view->my_data=10; 在控制中。您可以通过以下方式在布局中访问它：echo $this->my_data。

这是伪代码，将其调整为交响乐方式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-10T04:03:17.367

我 90% 确定您执行此操作的方式与从常规视图文件中执行此操作的方式相同。因此，只要您在操作中设置变量，就应该可以从 layout.php 文件中访问它。

在你的行动中：

```
$this->body_class = "xxx"; 
```

在 layout.php 中

```
<body class="<?php echo $body_class?>"> 
```

请务必运行一些检查以确保 $body_class 已设置。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-08-19T09:53:53.883

sfConfig::set('name_here', $variableHere);
$variable = sfConfig::get('name_here');

我经常使用这个。在代码的任何地方使用它。

# django - 如何过滤 QuerySet 中的空名称或 NULL 名称？

> ID：844556
> 
> 赞同：540
> 
> 时间：2009-05-10T02:26:50.157
> 
> 标签：django, django-models, django-queryset, filter, null

我有我需要搜索的`first_name`, `last_name`& （可选）。`alias`所以，我需要一个查询来给我所有具有别名集的名称。

只要我能做到：

```
Name.objects.filter(alias!="") 
```

那么，与上面的等价物是什么？

* * *

## 回答 #1

> 赞同：977
> 
> 时间：2009-05-10T02:41:37.250

你可以这样做：

```
Name.objects.exclude(alias__isnull=True) 
```

如果您需要排除空值*和*空字符串，最好的方法是将条件链接在一起，如下所示：

```
Name.objects.exclude(alias__isnull=True).exclude(alias__exact='') 
```

将这些方法链接在一起基本上独立地检查每个条件：在上面的示例中，我们排除了`alias`为空*或*空字符串的行，因此您将获得所有`Name`具有非空、非空`alias`字段的对象。生成的 SQL 如下所示：

```
SELECT * FROM Name WHERE alias IS NOT NULL AND alias != "" 
```

您还可以将多个参数传递给单个调用`exclude`，这将确保仅排除满足*每个条件的对象：*

```
Name.objects.exclude(some_field=True, other_field=True) 
```

在这里，排除了`some_field` *和* `other_field`为真的行，因此我们得到了两个字段都不为真的所有行。生成的 SQL 代码看起来有点像这样：

```
SELECT * FROM Name WHERE NOT (some_field = TRUE AND other_field = TRUE) 
```

或者，如果您的逻辑比这更复杂，您可以使用 Django 的[Q 对象](https://docs.djangoproject.com/en/dev/ref/models/querysets/#q-objects)：

```
from django.db.models import Q
Name.objects.exclude(Q(alias__isnull=True) | Q(alias__exact='')) 
```

有关更多信息，请参阅[此页面](https://docs.djangoproject.com/en/dev/topics/db/queries/)和Django 文档中的[此页面。](https://docs.djangoproject.com/en/dev/ref/models/querysets)

[顺便说一句：我的 SQL 示例只是一个类比——实际生成的 SQL 代码可能看起来不同。通过实际查看它们生成的 SQL，您将更深入地了解 Django 查询的工作原理。]

* * *

## 回答 #2

> 赞同：63
> 
> 时间：2011-02-23T09:14:06.693

```
Name.objects.filter(alias__gt='',alias__isnull=False) 
```

* * *

## 回答 #3

> 赞同：41
> 
> 时间：2009-06-04T15:15:18.940

首先，Django 文档强烈建议不要对基于字符串的字段（例如 CharField 或 TextField）使用 NULL 值。阅读文档以获取说明：

[https://docs.djangoproject.com/en/dev/ref/models/fields/#null](https://docs.djangoproject.com/en/dev/ref/models/fields/#null)

解决方案：我认为，您也可以将 QuerySets 上的方法链接在一起。试试这个：

```
Name.objects.exclude(alias__isnull=True).exclude(alias="") 
```

这应该给你你正在寻找的集合。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2016-03-06T12:02:21.147

从 Django 1.8 开始，

```
from django.db.models.functions import Length

Name.objects.annotate(alias_length=Length('alias')).filter(alias_length__gt=0) 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2019-07-04T10:50:41.310

**1\. 使用 exclude 时，请记住以下几点以避免常见错误：**

不应**将****多个**条件添加**到** `exclude()`像`filter()`. 要排除多个条件，您应该使用**多个** `exclude()`.

例子：`(NOT a AND NOT b)`

```
Entry.objects.exclude(title='').exclude(headline='') 
```

等于

```
SELECT... WHERE NOT title = '' AND NOT headline = '' 
```

==================================================== ====

**2.只有在你真正了解它的时候才使用multiple：**

例子：`NOT (a AND b)`

```
Entry.objects.exclude(title='', headline='') 
```

等于

```
SELECT.. WHERE NOT (title = '' AND headline = '') 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-05-08T15:29:35.357

你可以简单地这样做：

```
Name.objects.exclude(alias="").exclude(alias=None) 
```

真的就是这么简单。 `filter`用于匹配并且`exclude`是匹配除指定内容之外的所有内容。这将评估为 SQL 为`NOT alias='' AND alias IS NOT NULL`.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-10-10T17:15:44.327

这是另一种简单的方法。

```
Name.objects.exclude(alias=None) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-05-29T12:37:26.937

另一种使用通用`isempty`查找的方法，可用于任何字段。

django rest_framework 或其他使用 django 查找的应用程序也可以使用它：

```
from distutils.util import strtobool
from django.db.models import Field
from django.db.models.lookups import BuiltinLookup

@Field.register_lookup
class IsEmpty(BuiltinLookup):
    lookup_name = 'isempty'
    prepare_rhs = False

    def as_sql(self, compiler, connection):
        sql, params = compiler.compile(self.lhs)
        condition = self.rhs if isinstance(self.rhs, bool) else bool(strtobool(self.rhs))
        if condition:
            return "%s IS NULL or %s = ''" % (sql, sql), params
        else:
            return "%s <> ''" % sql, params 
```

然后你可以像这样使用它：

```
Name.objects.filter(alias__isempty=False) 
```

# c# - 如何在 F# 中处理多个文件和 C# 库？

> ID：844557
> 
> 赞同：1
> 
> 时间：2009-05-10T02:30:20.553
> 
> 标签：c#, .net, f#

我有一个具有以下命名空间/类的 C# 库：

```
namespace Helper
{
    public static class Util
    {
         /*static methods*/
    }
} 
```

我在 F# 项目中引用了所述库，当我尝试调用其中一种方法时：

```
error FS0039: The namespace or module 'Helper' is not defined. 
```

这是方法调用不起作用的示例：

```
#light

let a = Seq.skip 1000 (Helper.Util.GetPrimes 200000);; 
```

我错过了一些明显的东西吗？使用 open Helper 也不起作用，奇怪的是 IntelliSense 确实起作用了，它列出了 Util 类中的每个方法。

另外，从同一项目中的其他文件调用我的某些文件中的函数的标准做法是什么？我不想仅仅为了访问一些功能而创建完整的对象。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-10T04:46:45.173

关于多个文件，请参阅“[使用多个 F# 源文件，以及一种有用的调试技术](http://lorgonblog.spaces.live.com/blog/cns!701679AD17B6D310!444.entry)”的第一部分，以及“[偷看 F# 项目系统，第三](http://lorgonblog.spaces.live.com/blog/cns!701679AD17B6D310!347.entry)部分”的最后部分。前者讨论了文件中的顶级代码如何隐式进入与文件名同名的模块中，而后者讨论了如何在项目中对文件进行排序（因为您只能看到上面/之前声明的内容）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-10T03:00:34.710

您的 GetPrimes 方法是什么样的？它对我有用...

我有一个包含以下代码的 C# 库的解决方案：

```
namespace Scratch
{
    public static class Util
    {
        public static IEnumerable<int> GetNumbers(int upto)
        {
            int i = 0;
            while (i++<upto) yield return i;
        }
    }
} 
```

并从引用 C# 项目的 F# 项目中调用它，如下所示：

```
#light

let p = Seq.skip 1000 ( Scratch.Util.GetNumbers 2000000);; 
```

# iphone - Xcode 3.1.3 中断控制台输出

> ID：844561
> 
> 赞同：1
> 
> 时间：2009-05-10T02:34:06.083
> 
> 标签：iphone, xcode, console

今天很头疼 - 首先我升级到 xcode 3.1.3 破坏了我所有的证书/规定。经过两次尝试，我把它们修好了。

现在，我正在处理主题中的问题，没有控制台输出。绝对没有任何内容被打印到控制台 - 没有启动信息，不是当我在断点处停止时从 xcode“打印”变量时，也不是 NSLog()。

没有什么。

我已经重新启动了我的 Mac，重新启动了 Xcode 等。我已经让它清除了控制台并在项目构建时打开它。我将 GDB 记录到一个文件中，这很有效，所以管道很酷。它只是控制台本身已经死了。

图片：（这是在应用程序运行时尝试打印变量的内容之后） [http://mr-sk.com/iphone/screen-capture-2.png](http://mr-sk.com/iphone/screen-capture-2.png)

我是在设备上还是在模拟器上似乎并不重要...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-10T03:41:58.540

看起来拆分栏一直固定在右侧。寻找酒窝并将其向右拖动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-10-21T14:15:56.667

这是一篇较旧的帖子，但我最近在 3.2.3 中遇到了这个问题，所以如果有人遇到这个问题，cdespinosa 的答案就在现场，但是我们中的许多“菜鸟”可能不知道在哪里可以找到这些文件，所以以防万一...

转到 Finder，找到您的 .xcodeproject 文件所在的文件夹，然后右键单击它，然后单击显示此包的内容。当新窗口出现时，将 .perspective、.mode、.pbxuser 文件移至回收站。（确保执行此操作时 XCode 已关闭......我碰巧在项目像白痴一样打开并且认为它第一次没有工作时这样做）

现在重新打开 xcode 和您的项目。您的控制台现在应该已修复。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-10T06:09:14.130

我也会尝试在 iPhone 开发者门户论坛中询问，因为您可以在那里询问有关测试版的东西......

# asp.net - 有什么方法可以防止母版页更改元素 ID？

> ID：844567
> 
> 赞同：6
> 
> 时间：2009-05-10T02:38:20.910
> 
> 标签：asp.net, master-pages, asp.net-3.5

我正在考虑将母版页添加到现有站点，但发现一旦我这样做，元素的 ID 就会在前面加上代码（例如`ctl00_MainPageContent_`）。

不幸的是，这会破坏页面上使用原始、未修改元素 ID 的现有脚本。

我意识到我可以将其替换为，`<%= Element.ClientID %>`但如果我可以完全禁用此行为，那就太棒了。

那么，我可以保留原始ID吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-10T02:53:47.097

上一篇文章已经回答了这个问题：**[删除 MasterPage Generated ID](https://stackoverflow.com/questions/827723/remove-ctl00contentbody-from-rendered-control-id)**

该解决方案使用以下代码覆盖渲染事件：

```
Protected Overrides Sub Render(ByVal writer As System.Web.UI.HtmlTextWriter)
    Dim Html As New StringWriter()
    Dim Render As New HtmlTextWriter(Html)
    MyBase.Render(Render)
    writer.Write(Html.ToString().Replace("name=""ctl00$ContentBody$", _ 
                  "name=""").Replace("id=""ctl00_ContentBody_", "id="""))
End Sub 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-10T03:12:02.887

您可以在控件中覆盖 ClientID 和 UniqueID。这是来自[这里](http://www.west-wind.com/WebLog/ShowPost.aspx?id=4605)，Rick Strahl 的一篇文章。

```
public override string UniqueID
{
    get
    {
        return this.ID;
    }
}

public override string ClientID
{   
    get
    {
        return this.ID;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-10-10T20:31:42.263

这个问题像泥土一样古老，但新的方法是`ClientIDMode="Static"`。

# asp.net - 如何在 ASP.NET 中以集合格式获取发布数据？

> ID：844568
> 
> 赞同：2
> 
> 时间：2009-05-10T02:39:02.827
> 
> 标签：asp.net, forms, post

我想知道如何以集合格式获取帖子数据？假设我有一个表单和一个名为 firstname 的文本框，通常我输入

```
var fn = txtFirstName.Text; 
```

从该文本框中获取数据。但我想知道当我单击提交数据以发布表单时如何获取原始发布数据的集合？

谢谢你。

我想获取发布数据而不是获取。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-10T02:42:19.650

您可以直接访问 Request 对象。它是所有表单元素的集合。您可以遍历它们或按名称访问它们，如下所示：

`Request["txtFirstName"]`

**编辑：**但是，如果有一个同名的查询字符串变量，将首先使用它。在那种情况下，`Request.Form["txtFirstName"]`应该用来代替。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-10T05:53:18.117

Request["txtFirstName"] 实际上会给你 URL 参数，比如：

[http://www.example.com/Page.aspx?txtFirstName=value](http://www.example.com/Page.aspx?txtFirstName=value)

`txtFirstName`如果您想要从具有您想要的名称的输入中发布到页面的值**Request.Form["txtFirstName"]**

# django - Web应用后台流程，新手设计题

> ID：844570
> 
> 赞同：10
> 
> 时间：2009-05-10T02:39:48.957
> 
> 标签：django, web-applications, background

经过多年的桌面应用程序开发，我正在构建我的第一个 Web 应用程序（我正在使用 Django/Python，但也许这是一个完全通用的问题，我不确定）。所以请注意 - 这可能是一个超新手的问题......

我的用户进程之一涉及服务器中的繁重处理（即用户输入某些内容，服务器需要约 10 分钟来处理它）。在桌面应用程序上，我会将用户输入扔到受互斥锁保护的队列中，并使用该互斥锁在队列上以低优先级阻塞运行专用后台线程。

然而，在 Web 应用程序中，一切似乎都面向与 HTTP 请求同步。

假设我将使用数据库作为队列，运行后台进程的最佳实践架构是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-10T02:44:43.873

对此（至少）有两种思想流派。

1.  将工作放在队列中，让您的网络堆栈之外的其他东西处理它。

2.  将工作放在队列中，并在您的 Web 堆栈中处理它。

在任何一种情况下，您都在某处（例如数据库表）的队列中创建工作单元，并让某些进程处理它们。

我通常使用 1 号，我有一个专门的 Windows 服务来处理这些事情。您也可以使用 SQL 作业或类似的东西来做到这一点。

第 2 项的优点是您可以更轻松地将所有代码保存在一个位置 - 在 Web 层中。您仍然需要一些触发执行的东西（例如加载处理具有足够高超时的工作单元的网页），但这可以通过各种机制轻松完成。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-10T03:06:48.733

自从：

1）这是一个常见的问题，

2) 您是平台新手

-- 我建议您查看为您的平台提供的库，以找到处理任务的解决方案。除了排队和处理作业之外，您还需要考虑：

1）worker和web-stack之间的状态通信。这将启用显示工作完成百分比的网页，向人们保证工作正在进行等。

2）如何保证worker进程不死。

3）如果一个job有错误，worker进程会不会定期自动重试？如果作业失败，您或操作人员会收到通知吗？

4）随着工作数量的增加，是否可以添加额外的工作人员以获得并行性？或者，更好的是，可以在其他服务器上添加工作人员吗？

如果您在 Django/Python 中找不到好的解决方案，您也可以考虑将解决方案从另一个平台移植到您的平台。我为 Ruby on Rails 使用了延迟工作。工作进程由 runit 管理。

问候，

拉里

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-10T02:42:51.383

一般来说，我会考虑在不同的服务器上运行后台进程，特别是如果您的 Web 服务器有任何类型的负载。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-14T19:41:02.670

在 Django 中运行长进程：http: [//iraniweb.com/blog/ ?p=56](http://iraniweb.com/blog/?p=56)

# asp.net-mvc - 在 ASP.NET MVC 中从 SQL Server 渲染图像

> ID：844579
> 
> 赞同：0
> 
> 时间：2009-05-10T02:49:42.083
> 
> 标签：asp.net-mvc

我正在尝试从 SQL Server 检索图像（是的，数据类型是图像）并将其显示在我的 ASP.NET MVC 应用程序的视图中。有谁知道如何做到这一点？一个工作示例将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-10T04:56:43.883

我的应用程序使用此功能：

```
 //
    // GET: /FileManager/GetFile/ID
    //[CompressFilter(Order = 1)]
    [OutputCache(Order = 2, Duration = 600, VaryByParam = "ID")]
    //[OutputCache(Duration = 600, VaryByParam = "ID", Location = System.Web.UI.OutputCacheLocation.ServerAndClient)]
    public ActionResult GetFile(int ID)
    {
        FileService svc = new FileService(new SqlFileRepository(base.ConnectionString));

        KsisOnline.Data.File result = svc.GetFileByID(ID);

        return File(result.Data, result.MimeType, result.UploadFileName);
    } 
```

..正如您从评论中看到的那样，到目前为止，我最大的问题是缓存图像结果。（顺便说一句：该方法被称为`GetFile`因为它返回图像、PDF 和其他文件）

我还有许多用于渲染图像的助手，以及来自数据库的图像的变体：

```
 public static string Image(this HtmlHelper helper,
        string classText, string sourcePath, string altText, string width, string height)
    {
        return Image(helper, classText, sourcePath, altText, width, height, null);
    }

    public static string Image(this HtmlHelper helper,
        string classText, string sourcePath, string altText, string width, string height, object htmlAttributes)
    {
        StringBuilder sb = new StringBuilder();
        if (htmlAttributes != null)
            foreach (PropertyInfo p in htmlAttributes.GetType().GetProperties())
                sb.AppendFormat(@" {0}=""{1}""", p.Name, p.GetValue(htmlAttributes, null).ToString());

        if (htmlAttributes == null)
            return String.Format(@"<img{0} src=""{1}"" alt=""{2}"" width=""{3}"" height=""{4}"" />",
                String.IsNullOrEmpty(classText) ? String.Empty : String.Format(@" class=""{0}""", classText),
                (new UrlHelper(helper.ViewContext.RequestContext)).Content(sourcePath),
                altText, width, height);
        else
            return String.Format(@"<img{0} src=""{1}"" alt=""{2}"" width=""{3}"" height=""{4}""{5} />",
                String.IsNullOrEmpty(classText) ? String.Empty : String.Format(@" class=""{0}""", classText),
                (new UrlHelper(helper.ViewContext.RequestContext)).Content(sourcePath),
                altText, width, height, sb.ToString());
    }

    public static string DBImage(this HtmlHelper helper,
      string classText, int fileID, string altText, string width, string height)
    {
        return DBImage(helper, classText, fileID, altText, width, height, null);
    }

    public static string DBImage(this HtmlHelper helper,
        string classText, int fileID, string altText, string width, string height, object htmlAttributes)
    {
        return Image(helper, classText, @"/FileManager/GetFile/" + fileID.ToString(),
            altText, width, height, htmlAttributes);
    } 
```

..助手`DBImage`是使用`GetFile`动作的人。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-10T03:02:37.293

创建自定义结果是处理此问题的最简洁方法，这是一个很好的示例：

[http://blog.maartenballiauw.be/post/2008/05/ASPNET-MVC-custom-ActionResult.aspx](http://blog.maartenballiauw.be/post/2008/05/ASPNET-MVC-custom-ActionResult.aspx)

# sql-server - 保留数据库中的主键值

> ID：844586
> 
> 赞同：0
> 
> 时间：2009-05-10T02:56:16.107
> 
> 标签：sql-server

当我将数据从一个表复制到另一个表时，所有主键值都被重置。有没有办法保留原始表的值。

在原始表中，主键值 (int) 不是连续的（已删除的行）

另一个表具有硬编码的所有值，这就是为什么我需要保持相同的值。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-10T02:58:34.323

您可以通过将[IDENTIY_INSERT 设置为 ON](http://msdn.microsoft.com/en-us/library/aa259221(SQL.80).aspx)

如果两个表具有相同的列，您可以执行以下操作：

```
SET IDENTITY_INSERT Table2 ON
INSERT Table2(pkId, Field2, Field3,...)
SELECT pkId, Field2,Field3,... FROM Table1
SET IDENTITY_INSERT Table2 OFF 
```

# django - 如何在 Django 中执行 SELECT MAX？

> ID：844591
> 
> 赞同：120
> 
> 时间：2009-05-10T02:58:13.513
> 
> 标签：django, django-models, max

我有一个对象列表如何运行查询以给出字段的最大值：

我正在使用这段代码：

```
def get_best_argument(self):
    try:
        arg = self.argument_set.order_by('-rating')[0].details
    except IndexError:
        return 'no posts'
    return arg 
```

评级是一个整数

* * *

## 回答 #1

> 赞同：211
> 
> 时间：2009-05-10T03:14:39.073

看到[这个](http://docs.djangoproject.com/en/dev/topics/db/aggregation/)。您的代码将类似于以下内容：

```
from django.db.models import Max
# Generates a "SELECT MAX..." query
Argument.objects.aggregate(Max('rating')) # {'rating__max': 5} 
```

您还可以在现有查询集上使用它：

```
from django.db.models import Max
args = Argument.objects.filter(name='foo') # or whatever arbitrary queryset
args.aggregate(Max('rating')) # {'rating__max': 5} 
```

如果您需要包含此最大值的模型实例，那么您发布的代码可能是最好的方法：

```
arg = args.order_by('-rating')[0] 
```

请注意，如果查询集为空，即没有参数匹配查询（因为该`[0]`部分将引发`IndexError`），这将出错。如果您想避免这种行为，而只是`None`在这种情况下返回，请使用[`.first()`](https://docs.djangoproject.com/en/dev/ref/models/querysets/#first)：

```
arg = args.order_by('-rating').first() # may return None 
```

* * *

## 回答 #2

> 赞同：85
> 
> 时间：2013-06-14T08:07:20.127

Django 也有 ' [latest(field_name = None)](https://docs.djangoproject.com/en/dev/ref/models/querysets/#latest) ' 函数，可以找到最新的（最大值）条目。它不仅适用于日期字段，还适用于字符串和整数。

您可以在调用该函数时提供字段名称：

```
max_rated_entry = YourModel.objects.latest('rating')
return max_rated_entry.details 
```

或者您已经可以在模型元数据中给出该字段名称：

```
from django.db import models

class YourModel(models.Model):
    #your class definition
    class Meta:
        get_latest_by = 'rating' 
```

现在您可以不带任何参数调用“latest()”：

```
max_rated_entry = YourModel.objects.latest()
return max_rated_entry.details 
```

* * *

## 回答 #3

> 赞同：52
> 
> 时间：2012-06-21T10:53:33.077

我已经为我的项目测试了这个，它在 O(n) 时间内找到了最大值/最小值：

```
from django.db.models import Max

# Find the maximum value of the rating and then get the record with that rating. 
# Notice the double underscores in rating__max
max_rating = App.objects.aggregate(Max('rating'))['rating__max']
return App.objects.get(rating=max_rating) 
```

这可以保证让您有效地获得最大元素之一，而不是对整个表进行排序并获得顶部（大约 O(n*logn)）。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2021-04-20T19:25:27.070

如果您还想获得一个值，而不是`None`表为空（例如 0），请`Max`结合[Coalesce](https://docs.djangoproject.com/en/3.2/ref/models/database-functions/#coalesce)：

```
from django.db.models import Max, Value
from django.db.models.functions import Coalesce

max_rating = SomeModel.objects.aggregate(
    max_rating=Coalesce(Max('rating'), Value(0))
)['max_rating'] 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2021-07-31T18:10:26.603

溶胶 01：

```
from .models import MyMODEL

max_rating = MyMODEL.objects.order_by('-rating').first() 
```

溶胶 02：

```
from django.db.models import Max
from .models import MyMODEL

max_rating = MyMODEL.objects.aggregate(Max('rating')) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-03-11T08:29:54.017

如果您想要随机评论，可能会改进关于@Raydel Miranda 评论的@afahim 答案。如果你想要全部，那么只使用过滤器

```
from django.db.models import Max

# Find the maximum value of the rating and then get the record with that rating. 
# Notice the double underscores in rating__max
max_rating = App.objects.aggregate(Max('rating'))['rating__max']
return App.objects.filter(rating=max_rating).first() 
```

# php - 在高流量网站上传的 Smarty 模板导致空白页面

> ID：844596
> 
> 赞同：1
> 
> 时间：2009-05-10T03:01:52.147
> 
> 标签：php, templates, smarty, lighttpd, templating

我在一个使用 Smarty 模板系统的高流量网站上工作。

当我上传当前正在使用的模板的新副本时，页面变为空白（好像模板文件本身没有任何内容）。我必须关闭 lighttpd，再次上传模板，然后重新启动 lig​​httpd。

Smarty 中是否有任何我应该使用但我可能不会使用的设置？

这是我在 Smarty 内部设置的变量列表：

> $smarty->use_sub_dirs = true;
> 
> $smarty->compile_check = true;

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-10T03:29:01.443

您尝试清除缓存的文件？如果文件没有完全上传并且有人请求它，它会被缓存损坏（至少这是我的想法）。我曾经使用 smarty，我也使用 lighttpd。（决定去 XSLT）

如果页面每秒被请求超过 2 次，除非您关闭 http 服务器，否则您将永远无法实际更新文件。或者清除 smarty 缓存文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-09-19T19:17:14.940

不要直接复制您的模板，将它们复制到某个临时文件夹中，上传完成后执行 mv（移动文件操作）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-10T09:59:52.907

您可能希望在上传文件之前打开缓存（如果已经打开，请增加超时并确保缓存整个模板）。启用缓存并将其设置为几分钟超时，以便 Smarty 不会编译新上传的模板。访问包含您的模板的页面，以确保 Smarty 已将其缓存。然后，在缓存过期之前上传模板。上传完成后，您可以再次关闭缓存（或将其设置回原始值）。

您可能希望向您的应用程序添加一个可以全局打开/关闭此缓存机制的配置设置。

# xml - 我应该如何从 J2ME 中的流中去除无效的 XML 字符？org.xml.sax.SAXParseException：无效字符

> ID：844599
> 
> 赞同：1
> 
> 时间：2009-05-10T03:03:50.270
> 
> 标签：xml, blackberry, java-me, sax, rim-4.2

此代码在 Blackberry JDE v4.2.1 上运行。它采用一种方法，可以进行返回 XML 的 Web API 调用。有时，返回的 XML 格式不正确，我需要在解析之前去除所有无效字符。

目前，我得到：`org.xml.sax.SAXParseException: Invalid character '' encountered`.

我希望看到一种在输入流上附加无效字符剥离器的快速方法的想法，以便流只流经验证器/剥离器并进入解析调用。即我试图避免保存流的内容。

现有代码：

**handler**是`DefaultHandler`
**url**的覆盖是一个包含 API 的字符串`URL`

```
hconn = (HttpConnection) Connector.open(url,Connector.READ_WRITE,true);

...

try{
   XMLParser parser = new XMLParser();
   InputStream input = hconn.openInputStream();
   parser.parse(input, handler);
   input.close();
} catch (SAXException e) {
   Logger.getInstance().error("getViaHTTP() - SAXException - "+e.toString());
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-10T03:48:08.650

很难在 InputStream 上附加剥离器，因为流是面向字节的。[在Reader](http://java.sun.com/javase/6/docs/api/java/io/Reader.html)上执行此操作可能更有意义。您可以制作类似于 StripReader 的东西，它包装另一个阅读器并处理错误。下面是一个快速的、未经测试的概念证明：

```
public class StripReader extends Reader
{
    private Reader in;
    public StripReader(Reader in)
    {
    this.in = in;
    }

    public boolean markSupported()
    {
    return false;
    }

    public void mark(int readLimit)
    {
    throw new UnsupportedOperationException("Mark not supported");
    }

    public void reset()
    {
    throw new UnsupportedOperationException("Reset not supported");
    }

    public int read() throws IOException
    {
    int next;
    do
    {
        next = in.read();
    } while(!(next == -1 || Character.isValidCodePoint(next)));

    return next; 
    }

    public void close() throws IOException
    {
    in.close();
    }

    public int read(char[] cbuf, int off, int len) throws IOException
    {
    int i, next = 0;
    for(i = 0; i < len; i++)
    {
        next = read();
        if(next == -1)
        break;
        cbuf[off + i] = (char)next;
    }
    if(i == 0 && next == -1)
        return -1;
    else
        return i;
    }

    public int read(char[] cbuf) throws IOException
    {
    return read(cbuf, 0, cbuf.length);
    }
} 
```

然后，您将从 Reader 构造一个[InputSource](http://java.sun.com/javase/6/docs/api/org/xml/sax/InputSource.html)，然后使用 InputSource 进行解析。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-10T03:27:59.400

使用[FilterInputStream](http://java.sun.com/j2se/1.5.0/docs/api/java/io/FilterInputStream.html)。覆盖[FilterInputStream#read](http://java.sun.com/j2se/1.5.0/docs/api/java/io/FilterInputStream.html#read())以过滤违规字节。

# c++ - C GUI，带有 C++ 主干？

> ID：844602
> 
> 赞同：1
> 
> 时间：2009-05-10T03:06:35.507
> 
> 标签：c++, c, gtk, ubuntu-9.04

我有一个用 C++ 编写的简单（也是微不足道的）银行应用程序。我在 ubuntu 上，所以我使用 GNOME (GTK+)。我想知道我是否可以用 C/GTK+ 编写我所有的 GUI，然后以某种方式将它链接到我的 C++ 代码。这甚至可能吗？

**注意：**我不想使用 Qt 或 GTKmm，所以请不要提供这些作为答案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-10T03:14:16.610

是的，这是一件非常容易的事情。您所要做的就是将一些 C++ 函数公开为“extern C”，以便您的 UI 代码中的事件处理程序和回调可以调用它们。

如果您无法更改现有的 C++ 源代码 - 没问题。只需为您的 UI 编写一个 C++ shim，外部这些函数，然后从那里调用后端函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-10T03:15:31.430

我不明白为什么不使用适当的[外部“C”](http://www.parashift.com/c++-faq-lite/mixing-c-and-cpp.html#faq-32.6)用法，以便您的 C 代码可以调用 C++。现在，当然，你可能会让自己变得更难，但理论上是合理的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-11T07:05:32.267

像其他人建议您可以为您的 C++ 库编写一个 C 包装器。但你也可以用 C++ 编写前端，即使你只使用 C 子集。如果您不喜欢语言混合，我可以理解，但这是最简单的方法，因为您节省了编写包装器的时间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-11T07:08:19.407

改用[wxWidgets](http://www.wxwidgets.org)怎么样？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-16T16:40:49.307

您可以在不使用 GTKmm 的情况下将 GTK/C 代码编译为 C++，并本机使用 C++ 代码。

大多数健全的 C 库都可以从本机 C++ 代码中使用，而 GTK+ 基本上是一个 C 库。

# java - 如何将 webapp 打包为可部署的战争？

> ID：844604
> 
> 赞同：5
> 
> 时间：2009-05-10T03:07:49.137
> 
> 标签：java, deployment, maven-2, web-applications, war

我是 Maven 的新手，但我迷上了它提供的功能。如何获取 webapp 并让 Maven 将 webapp 打包为可部署的 WAR？此外，我可以设置 Maven 来自动对构建进行版本控制吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-10T03:21:14.003

以下是[入门指南中的示例](http://maven.apache.org/guides/getting-started/index.html)：

```
<project xmlns="http://maven.apache.org/POM/4.0.0"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0
                      http://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>
  <groupId>com.mycompany.app</groupId>
  <artifactId>my-webapp</artifactId>
  <packaging>war</packaging>
  <version>1.0-SNAPSHOT</version>
  <dependencies>
    <dependency>
      <groupId>junit</groupId>
      <artifactId>junit</artifactId>
      <version>3.8.1</version>
      <scope>test</scope>
    </dependency>
  </dependencies>
  <build>
    <finalName>my-webapp</finalName>
  </build>
</project> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-10T03:59:01.417

切换到项目目录并输入：

mvn 清洁包

目标/my-webapp.war 已构建

# java - 使用 Jmock 创建一个模拟来为自己返回一个空值

> ID：844606
> 
> 赞同：1
> 
> 时间：2009-05-10T03:09:50.553
> 
> 标签：java, unit-testing, mocking, jmock

我有一个类似于以下的方法：

```
public void myMethod(MyClass c)
{
  if (c == null)
  {
    return;
  }
  try
  {
    c.someMethod();
  }
  catch (SomeException e)
  {
    // log the exception, possibly re-throw
  }
} 
```

我试图找到一种方法来设置 MyClass 参数 c 的模拟实例，以便它为自己返回 null 值，并且永远不会调用 c.someMethod() 。我的单元测试如下所示：

```
@Test
public void Test_myMethod_With_Null_MyClass_Does_Not_Call_someMethod()
{
    Mockery mockery = new Mockery()
    {{
            setImposteriser(ClassImposteriser.INSTANCE);
    }};

    final MyClass mockMyClass = mockery.mock(MyClass.class);

    try
    {
        mockery.checking(new Expectations()
        {{
            oneOf(mockMyClass).equals(null);
                will(returnValue(true));

            never(mockMyClass).someMethod();
        }});
    }
    catch (Exception e)
    {
        logger.fatal(e);
        fail("Exception thrown in test.");
    }
    Util.myMethod(mockMyClass);
} 
```

基本上，我正在设置 MyClass 的模拟实例，并对其设置期望，即当针对空值测试其值时，它将返回 true，并且永远不会调用方法 someMethod()。

现在，测试失败了，因为 jMock 说不可能覆盖 Object 类提供的方法（equals(null) 部分）。

有没有办法用 jMock 做到这一点？这种模式有意义吗？这是一个有效的测试吗？如果没有，是否有人对如何测试有任何建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-10T04:45:32.023

我认为您不能仅使用 JMock 来测试此代码。

我会通过`null`直接传入来测试这个。如果没有抛出或记录异常，您就知道您的代码按预期工作。@Test

```
public void Test_myMethod_With_Null_MyClass_Does_Not_Call_someMethod()
{
    Util.myMethod(null);
    //no exception should be thrown.
} 
```

如果您想让它更明确，您可以将`myMethod(null)`调用包装在 try/catch 块中，但这不是必需的，除非在失败时阐明失败原因。

```
public void Test_myMethod_With_Null_MyClass_Does_Not_Call_someMethod()
{
    try
    {
        Util.myMethod(null);
    }
    catch( ExpectedException e )
    {
        fail( "Should not have thrown exception: " + e.getMessage() ); 
    }
} 
```

这是一个足够的测试，因为您知道 if `c`is `null`then`c.something()`当然不能被调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T12:18:40.757

模拟应该用于测试对象如何与其协作者交互。如果没有合作者，那么就没有什么可嘲笑的了。传入 null 更简单，更具表现力。

# perl - 在 Perl 5 中获取 switch/case 行为

> ID：844616
> 
> 赞同：28
> 
> 时间：2009-05-10T03:15:24.767
> 
> 标签：perl, switch-statement

在 Perl 5 中是否有一种巧妙的方式来制作 case 或 switch 语句？在我看来，他们应该包括一个版本 6 的开关..

我需要在脚本中使用这种控制结构，而且我听说您可以导入“开关模块”。但是如何在没有导入的情况下实现它以最大限度地减少依赖关系并获得可移植性？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2009-05-10T03:37:02.623

如果您使用的是 Perl 5.10，那么您有[`given`/`when`](http://perldoc.perl.org/perlsyn.html#Switch-statements)这是一个 switch 语句（注意，它不仅可以与正则表达式进行比较，请阅读链接的文档以了解其全部潜力）：

```
#or any of the dozen other ways to tell 5.10 to use its new features
use feature qw/switch/; 

given($string) {
    when (/^abc/) { $abc     = 1; }
    when (/^def/) { $def     = 1; }
    when (/^xyz/) { $xyz     = 1; }
    default       { $nothing = 1; }
} 
```

如果您使用的是 Perl 5.8 或更早版本，则必须使用`if`//语句`elsif`：`else`

```
if    ($string =~ /^abc/) { $abc     = 1; }
elsif ($string =~ /^def/) { $def     = 1; }
elsif ($string =~ /^zyz/) { $xyz     = 1; }
else                      { $nothing = 1; } 
```

或嵌套[条件运算符 ( `?:`)](http://perldoc.perl.org/perlop.html#Conditional-Operator)：

```
$string =~ /^abc/ ? $abc     = 1  :
$string =~ /^def/ ? $def     = 1  :
$string =~ /^xyz/ ? $xyz     = 1  :
                    $nothing = 1; 
```

Core Perl ( [Switch ) 中有一个模块可以通过](http://perldoc.perl.org/Switch.html)[源过滤器](http://perldoc.perl.org/perlfilter.html)为您提供虚假的 switch 语句，但据我了解，它很[脆弱](http://perldoc.perl.org/Switch.html#BUGS)：

```
use Switch;

switch ($string) {
    case /^abc/ {
    case /^abc/ { $abc     = 1 }
    case /^def/ { $def     = 1 }
    case /^xyz/ { $xyz     = 1 } 
    else        { $nothing = 1 }
} 
```

或替代语法

```
use Switch 'Perl6';

given ($string) {  
    when /^abc/ { $abc     = 1; }
    when /^def/ { $def     = 1; }
    when /^xyz/ { $xyz     = 1; }
    default     { $nothing = 1; }
} 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-05-10T03:59:09.217

Programming Perl 中的建议是：

```
 for ($string) {
    /abc/ and do {$abc    = 1; last;};
    /def/ and do {$def    = 1; last;};
    /xyz/ and do {$xyz    = 1; last;};
    $nothing = 1;
} 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-05-12T07:23:41.943

只是对在答案中多次提到的核心[Switch](http://search.cpan.org/dist/Switch)模块的简短评论。有问题的模块依赖于源过滤器。除其他外，这可能会导致报告错误的错误行。太糟糕了，以至于没有一个核心开发人员真正记得或关心记住为什么它首先被接受到 perl 核心中。

此外，Switch.pm 将是第一个从 perl 核心中删除的 Perl 模块。perl 的下一个主要版本 5.12.0 仍将包含它，尽管带有弃用警告。如果您从 CPAN 显式安装 Switch.pm，该弃用警告将消失。（你得到你想要的。）在下一个版本 5.14 中，Switch.pm 将从核心中完全删除。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-05-11T15:36:47.153

我喜欢的等效解决方案是[调度表](http://en.wikipedia.org/wiki/Dispatch_table)。

```
my $switch = {
  'case1' => sub { print "case1"; },
  'case2' => sub { print "case2"; },
  'default' => sub { print "unrecognized"; }
};
$switch->{$case} ? $switch->{$case}->() : $switch->{'default'}->(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-08-07T20:01:04.940

```
print("OK : 1 - CANCEL : 2\n");
my $value = <STDIN>;
SWITCH: {
    ($value == 1) && last(SWITCH);
    ($value == 2) && do {print("Cancelled\n"); exit()};
    print("??\n");
} 
```

# ruby-on-rails - Rails 中的守护进程 gem 问题

> ID：844619
> 
> 赞同：0
> 
> 时间：2009-05-10T03:18:28.440
> 
> 标签：ruby-on-rails, ruby-daemons

除了 daemon_generator 插件之外，我还在使用带有 Rails 的守护进程 gem。我在守护进程日志文件中得到这个输出：

```
 Logfile created on Sat May 09 20:10:35 -0700 2009 by /
-below you find the most recent exception thrown, this will be likely (but not certainly) the exception that made the application exit abnormally ***
#<NameError: uninitialized constant SmsMessage>
-below you find all exception objects found in memory, some of them may have been thrown in your application, others may just be in memory because they are standard exceptions ***
#<NoMemoryError: failed to allocate memory>
#<SystemStackError: stack level too deep>
#<fatal: exception reentered>
#<MissingSourceFile: no such file to load -- ./config/global_constants.conf>
#<NameError: uninitialized constant SmsMessage> 
```

我发现很难从这个输出中理解。它显示不同的错误消息，我可以说这不是 ./config/global_constants.conf 问题，因为我没有在守护程序文件中调用它。另外，我认为这不是内存问题，因为我的 Mac 有 2GB 内存并且运行的程序不多。至于 SmsMessage 我通常使用以下方法调用它：

```
scheduledMessagesParent = SmsMessage.valid.find(:all, :conditions => {:status => $SCHEDULED_MESSAGE}) 
```

在我网站的其他地方工作！我注意到记录器被称为使用

```
ActiveRecord::Base.logger.info ".... 
```

是否有可能我必须以另一种方式指定我的模型路径？我通常使用 logger.info 调用记录器，而不需要 ActiveRecord::Base。如果是这样怎么做？

任何想法如何去调试这个问题？有没有办法显示堆栈跟踪或更好的错误消息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-12T21:58:48.037

我通过使用 Daemon 加载 Rails 环境解决了这个问题。它没有包含在我从中获取信息的教程中，但它现在可以工作了:)

# asp.net - IIS7 自动重定向到 null（在 IE 中）

> ID：844620
> 
> 赞同：0
> 
> 时间：2009-05-10T03:20:17.300
> 
> 标签：asp.net, vb.net, iis-7

我正在用 VB 开发一个 ASP.NET 网站。我的网站与 Firefox 完美配合。但是，对于 IE，它会自动重定向到*null*。

当我尝试

```
http://localhost/mysite/Default.aspx 
```

IE6/IE7 自动重定向到

```
http://localhost/mysite/null 
```

但是，子文件夹内的页面没有问题。当我尝试

```
http://localhost/mysite/forum/ 
```

这是完美的工作。我只是无法浏览根文件夹中的页面。

我应该怎么办？我正在使用 IIS7 和 .net 框架 2.0。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-10T19:23:42.927

首先在工具->Internet 选项->高级中取消选中Internet Explorer中的显示错误消息，然后查看。

如果您使用一些动态链接重定向另一件事？这就是它在 null 上重定向的原因。

检查你的代码。我认为您的代码中可能存在一些问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-10T05:51:10.760

呃……这很奇怪。“null”实际上并不是一个让网络流量重定向的正常位置。您能想到您的代码/IIS 设置中可能重定向到名为“null”的页面的任何地方吗？ 另外奇怪的是 firefox/ie 的区别。

它与身份验证有关吗？IE 可能具有自动 Windows 身份验证，导致您的应用程序行为不同，因为它认为您已登录。尝试在 IIS 中关闭 Windows 身份验证。

或者，您可以调试您的代码吗？在重定向发生之前，您的主页上是否有任何代码执行？

# qt - Qt 信号和继承问题

> ID：844623
> 
> 赞同：12
> 
> 时间：2009-05-10T03:23:38.633
> 
> 标签：qt, inheritance, subclass, signals-slots

我对使用 Qt 编程比较陌生，并且有一个问题。简洁版本：

如何继承超类中定义的信号？

我正在尝试继承其他人精心制作的 QTWidgets 以更改一些默认行为：

```
//Plot3D是一个QWidget，它定义了一个信号“rotationChanged”
类matLinePlot：公共QObject，公共Plot3D {

    Q_OBJECT;
        //ETC...
上市：
       //ETC...

        //捕捉 Plot3D 的信号“rotationChanged”并用它做一些魔术：
    无效初始化图（）{
              QObject::connect(this, SIGNAL(rotationChanged( double , double , double )),
            这，SLOT（myRotationChanged（双，双，双）））；
    }
};

```

问题出在 QObject::connect 行。我想做的是将rotationChanged SIGNAL（来自qwt3D_plot.h）连接到本地函数/SLOT - “myRotationChanged”。但是，每当我这样做时，在运行时我会得到：

> Object::connect: 没有这样的信号 matLinePlot::rotationChanged(double, double, double)

在 C:...\matrixVisualization.h。当然，我知道那`rotationChanged`不是 in `matrixVisualization.h`- 它是 in `qwt_plot3D.h`，但我认为既然我继承了`Plot3D`一切应该没问题。但是，现在我想起来了，因为 SIGNAL 和 SLOT 是宏，我认为[MOC](http://en.wikipedia.org/wiki/Qt_%28toolkit%29#Meta_object_compiler)不知道/不关心继承。

这引出了我的问题——因为 MOC 和 SIGNALS / SLOTS 似乎不了解继承等：我如何子类化在其他地方定义的小部件并访问小部件的信号？

我有很多关于如何使用封装来完成这样的事情的例子，但恐怕我不明白如何用继承来做到这一点。

对不起，如果这是一个荒谬的问题 - 我觉得我错过了一些明显的东西。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-10T11:23:49.507

我想问题是多重继承：

```
class matLinePlot : public QObject, public Plot3D
... 
```

我假设这`Plot3D`是一个子类`QObject`？在这种情况下，你应该这样做

```
class matLinePlot : public Plot3D
... 
```

反而。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-10T05:13:47.727

SIGNAL(x) 和 SLOT(x) 是生成字符串文字的宏。在运行时，插槽和信号使用字符串比较这些生成的文字进行匹配。

（我会在 mdec 的评论中添加评论，但我没有足够的代表）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-10T03:45:36.583

我相信如果 Plot3D::rotationChanged 信号是公开的或受保护的，这将起作用。你确定信号不是私人的吗？

**编辑：**

虽然我找不到具体的参考资料，但我必须得出结论，信号总是公开的。至少我在这里做的一个测试似乎表明我可以连接到一个信号，即使它是在类的私有部分中声明的。

我还验证了在 QObject 中声明的信号可以在连接语句中使用 QObject 的子类进行连接，因此信号绝对是可继承的。正如我在这里的其他答案和评论中看到的那样，问题必须在其他地方。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-10T04:50:25.163

不正确 -> 查看评论。

我在 Uni 使用 Qtopia，我相信我记得有人说过关于连接的 SIGNAL 和 SLOT 参数中的间距。

尝试使用

```
QObject::connect(this, SIGNAL(rotationChanged(double,double,double)),
            this, SLOT(myRotationChanged(double,double,double))); 
```

我知道它看起来并不直观，因为 C++ 对空格不敏感，但是我相信它与 Qtopia/QT 在连接信号和插槽时使用的一些魔法有关。这可能只适用于Qtopia，或者我可能听错了，但试一试。此外，信号是公开的还是受保护的，您是否包含了适当的头文件？

# perl - 它在文档中的什么地方说在测试 readdir 的定义时？

> ID：844625
> 
> 赞同：5
> 
> 时间：2009-05-10T03:26:33.977
> 
> 标签：perl, perldoc

另请参阅：[readdir 的“0”结果如何在一段时间内不为假？](https://stackoverflow.com/questions/843430/how-is-0-result-from-readdir-not-false-in-a-while-condition). （*不是重复的；只是密切相关。*）

* * *

它在文档中的什么地方说在测试 readdir 的定义时？例如，这段代码

```
#!/usr/bin/perl

use strict;
use warnings;

opendir my $dir, "/tmp" or die "$!";

while (my $file = readdir($dir)) {
        print "$file\n";
}
closedir $dir; 
```

通过[B::Deparse](http://perldoc.perl.org/B/Deparse.html)运行时产生：

```
use warnings;
use strict 'refs';
die "$!" unless opendir my $dir, '/tmp';
while (defined(my $file = readdir $dir)) {
    do {
        print "$file\n"
    };
}
z.pl syntax OK 
```

我期待这种行为，但我找不到它的指定位置。在[perlop 的 I/O Operators 部分中，](http://perldoc.perl.org/perlop.html#I%2fO-Operators)它说

> 以下几行是等效的：
> 
>      `while (defined($_ = <STDIN>)) { print; }`
>      `while ($_ = <STDIN>) { print; }`
>      `while (<STDIN>) { print; }`
>      `for (;<STDIN>;) { print; }`
>      `print while defined($_ = <STDIN>);`
>      `print while ($_ = <STDIN>);`
>      `print while <STDIN>;`

但没有提及`readdir`。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-10T15:14:53.953

你说得对，它是无证的。我看起来相当努力，我也找不到任何关于它特别的参考。正如您所发现的那样，它*很*特别，并通过以下方式证明：

```
$ perl -MO=Deparse \
       -E'opendir(my $dir, "."); while($_ = readdir($dir)) { say; }'

BEGIN {
    $^H{'feature_say'} = q(1);
    $^H{'feature_state'} = q(1);
    $^H{'feature_switch'} = q(1);
}
opendir my $dir, '.';
while (defined($_ = readdir $dir)) {
    say $_;
}
-e syntax OK 
```

查看源代码，`Perl_newWHILEOP`特别`op.c`是对 、 和 ... 的测试`readdir`嗯`glob`，`readline`让`each`我们做一些挖掘，看看什么时候`readdir`添加的。

稍微挖掘一下`git`就会发现，至少从 1998 年开始就是这样，Gurusamy Sarathy 在 commit 中做出了相关的更改`55d729e4`。虽然我还没有深入了解哪些版本进入了，但我敢打赌它至少会是 5.6.0 及更高版本。我在三角洲中找不到任何提及。

在第三版骆驼书中*可能会提到，但我没有查过。*

我认为这里的补丁（或者甚至只是 p5p 的注释）肯定会受到赞赏。

*保罗*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-20T22:42:21.587

很抱歉，我没有考虑更新您希望找到此信息的页面。

我确实在尽管的[`readdir`](http://perldoc.perl.org/functions/readdir.html)部分添加了注释。[`perlfunc`](http://perldoc.perl.org/perlfunc.html#readdir-DIRHANDLE)

> `readdir`从 Perl 5.12 开始，您可以在循环中使用 bare `while`，它将`$_`在每次迭代时设置。
> 
> ```
> opendir(my $dh, $some_dir) || die;
> while(readdir $dh) {
>     print "$some_dir/$_\n";
> }
> closedir $dh; 
> ```

它没有明确说它检查定义性。

（我想指出，添加此功能是我对 Perl 核心的第一个补丁。）

# linux - 我可以在 bashrc 中添加一些东西来隐藏文本编辑器（〜扩展名）文件吗？

> ID：844632
> 
> 赞同：6
> 
> 时间：2009-05-10T03:32:08.440
> 
> 标签：linux, bash

我想做 ls 而不看到 vim 生成的所有 ~ 文件。是否可以？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-10T03:39:18.423

与 bash 相比，这最好在 vim 中解决。

采用

```
set backupdir=~/.backup,/tmp 
```

将所有 ~ 文件放在`~/.backup`目录中。将该目录更改为您想要的任何目录。这`/tmp`意味着它将作为`~/.backup`目录的后备。

如果您根本不想生成备份文件，可以使用

```
set nobackup
set nowritebackup 
```

禁用它，但您当然会失去该功能。

编辑：

尽管上述解决方案仍然是我推荐的解决方案，因为您可以使用它做更多事情，但我刚刚意识到`ls`有一个`-B`选项可以隐藏以`~`. 我自己给它起了别名，从来没有注意到。如果你真的想要，你可以使用别名`ls -B`并使用它。

编辑 v2.0：

正如 Wesley 所指出的，有些平台的`ls`命令对 有不同的含义`-B`，有些可能根本没有。我正在使用 GNU `ls`，只要我记得，它就有这个开关。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-10T03:45:02.137

许多编辑器使用这些`~`文件来表示备份文件。（我使用这个技巧从 gedit 隐藏备份文件。）要禁用它们显示，将此命令添加到您的`bashrc`：

```
alias ls='ls --hide=*~' 
```

编辑：Mac OS X`ls`似乎没有这个选项，因此 BSD`ls`可能也没有这个选项。Ubuntu*确实*有这个选项，所以很多 Linux 发行版可能都有；检查您的手册页。此外，Mac`ls`似乎有不同的`-B`，所以在使用[Sykora 的建议](https://stackoverflow.com/questions/844632/can-i-put-something-in-in-bashrc-to-hide-text-editor-extension-files/844636#844636)时要考虑这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-10T18:20:22.377

如果你只是对 ls 隐藏它们，你会很抱歉。就 grep 和其他工具而言，它们仍然存在，只是现在您看不到它们。将它们移动到 /tmp 是一种更好的方法。

这个问题在 .svn 目录中尤其严重，其中有各种你真的不想编辑的无用 cr*p。我不知道解决方案。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-05-15T21:38:50.663

对于 Mac OS X：

```
brew install coreutils
echo "alias ls='/usr/local/bin/gls -B'" >> ~/.bashrc 
```

# algorithm - 寻找几何图形的外部

> ID：844633
> 
> 赞同：-1
> 
> 时间：2009-05-10T03:33:51.773
> 
> 标签：algorithm, geometry

我有一张多边形地图，例如：

[替代文字 http://img13.imageshack.us/img13/2808/output.png](http://img13.imageshack.us/img13/2808/output.png)

（抱歉图片不是很好，我会努力改进的）

绿线是连接形状之间的最短路径。我需要做的是找到形成外边缘的绿线，以及我需要在哪个方向穿过它们以绕 CCW。

多边形总是凸的，线条永远不会交叉。这些线是根据 X,Y 端点定义的。我有一个从多边形到相关线的索引，并标记了连接的一端。

我需要这个的原因是因为我需要找到形成每个内部部分的边缘，并且我的墙跟随解决方案对于外部部分失败/崩溃。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T10:39:14.447

**0\. 澄清：**我不确定凸多边形之间的绿色连接是否作为输入的一部分提供，或者程序是否必须确定适当的绿色连接作为多边形本身之间的最短路径。我刚刚注意到您的图像在右上角缺少绿色边缘（如果允许，这将是外边框的一部分）。

**1.解决方案：总是选择下一条边。**如果您的输入指定了哪些绿线是允许的，哪些是不允许的，那么您只需通过找到一个起点（例如，通过采用具有最低 x 坐标的多边形角）来遍历外部组件的边界，对偏离以逆时针顺序的当前点的多边形，并**以逆时针顺序选择紧跟当前点**的边。现在，将该边的另一端作为“当前点”并重复相同的方法以找到下一条边......直到您返回第一个多边形。

**2.解决方法：从凸包开始。**如果您允许所有可能的绿线，则不需要它们作为输入。所有多边形边缘的凸包是您的解决方案的第一个近似值（查找的详细信息 --- 请参见下文）：凸包包含真正的多边形边缘（让我们将它们视为“黑色”：它们是您最终解决方案的一部分，已经按照正确的顺序）和连接多边形的边（让我们把它们想象成红色：它们需要被绿色边缘和可能的其他多边形的一部分替换）。

**完成第二个解决方案：分而治之：**现在，我们需要用绿色和黑色边缘的组合替换每个红色边缘。我们一次只关注一条红线（并对我们可能拥有的每条红线应用相同的方法）。

所以我们有一条红线，其中包含两个多边形，这些多边形有一条绿线（它们之间的最短连接）——这两条线的四个边定义了一个四边形。如果其他多边形角都不在这个四边形中，那么您就完成了：将红色边缘替换为绿色边缘和多边形上的任何黑色边缘以到达连接点。

但是，如果您在四边形中找到多边形，请从中选择最接近红色边缘的多边形。将红色边缘移向该点 --- 以便新点将红色边缘切割成两个红色边缘。这两个新的红色边缘替换了一个旧的红色边缘：递归地将此方法应用于它们。它们对应的四边形要小得多，并且包含更少的多边形边。

当您继续应用这种分而治之的方法时，您最终将没有剩余的红色边缘（因为每次找到一个空的四边形时，您都会失去一个红色边缘）。

**凸包：**这是一个 n 维的难题，但在二维中很容易：如果您搜索网络或浏览 SO，您肯定会找到比我现在能想到的更好的解决方案，但这是一个浮现在脑海中的问题（再次：分而治之）：找到一个具有最大 x 坐标的点 A 和一个具有最小 x 坐标的点 B，通过两个有向的“蓝色”边连接它们：A->B 和 B->A。将您的点分为两组：边缘 A->B 右侧的点和左侧（实际上是 B->A 的右侧）的点。我们反复替换每个蓝色边缘，直到找到凸包：

取一个蓝色边缘 A->B 并查看其右侧的点。如果没有，那么这个蓝色边缘真的是黑色的（你的解决方案的一部分）。否则，取蓝边最右边的点 C，用两条蓝边 A->C 和 C->B 代替 A->B 边。将 A->B 右侧的点划分为 A->C 右侧的点、C->B 右侧的点和两者都不是的点（它们被忽略）。重复直到所有蓝色边缘都被替换。

# sql - 额外的空列会显着影响 sql 表的大小吗？

> ID：844634
> 
> 赞同：3
> 
> 时间：2009-05-10T03:37:00.533
> 
> 标签：sql

我有几列我知道最初不会使用。仅在需要时添加列或仅将那些额外的列留在那里是一种好习惯吗？

它只是在标题或每一行中多一点空间吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-10T03:45:29.330

在某种程度上取决于列类型。

可变大小的列（例如`varchar(n)`）每行仅使用 4 个额外字节（大约）。

我只会在需要时添加列，因为不太可能添加冗余列并且永远不会删除。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-10T04:01:21.630

是的，如果每行只有几个字节（取决于列类型），它们仍然会占用空间。如果您稍后才使用它们，那么将它们保留在那里有什么好处？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-26T15:00:02.803

我想补充一点，尽管空列占用空间（如其他答案中所述），但在处理大数据库时，添加列并不是一件容易的事。所以有时，最好准备一个额外的列，即使它只是为了将来使用。

# web-services - 我应该使用 Tomcat 还是完整的 Java EE 容器？

> ID：844640
> 
> 赞同：4
> 
> 时间：2009-05-10T03:44:31.250
> 
> 标签：web-services, tomcat, jakarta-ee, production-environment

我需要在现有应用程序之上设计一个 Web 服务层。真的，我最感兴趣的是 WS-Security 和 JMS 支持，可能是 JTA。

最好的服务器是什么？使用轻量级 Tomcat（我有经验）是明智的决定，还是使用实现完整 Java EE 堆栈的服务器（例如 JBoss AS、WebLogic 甚至 GlassFish）会更好？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-10T05:11:41.743

通常，除非您知道您正在尝试特别使用 Java EE 服务，否则最好只使用 Tomcat。Java EE 环境非常重量级；J2EE 的设计考虑了 eBay 这样的大型环境。（我编写了 Sun 的第一个 J2EE 架构课程；我一直在关注这些论点。）

但是，您说“JMS”，它严格来说是一种 Java EE 服务。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-10T03:50:27.383

您可能想尝试使用 JBoss 并查看它如何满足您的需求，但是，如果您想继续使用 Tomcat，您可能需要查看 Spring Framework 并查看它是否具有您想要的功能，因为它是一种在没有 Java EE 容器的情况下拥有 Java EE 的方法。

这取决于你是想尝试一些想法，看看什么对你有用，还是只做一件事，不管怎样都坚持下去。

我倾向于尝试，直到我觉得自己知道的足够多，可以做出最好的决定为止。

就我个人而言，我会使用 Tomcat 和 Spring，但我之前使用过 Spring。

如果您可以提供使用您提到的某些功能的用例，以查看是否有更好的答案，这将很有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-10T05:29:48.050

除非您需要 Tomcat 不提供的 Java EE 堆栈中的东西，否则我会使用 Tomcat。

另外，如果您决定使用 Java EE 堆栈中的项目（如果不是专门为容器编写代码），您可以随时更改。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-08-07T08:42:28.597

我认为您应该开始使用全栈 Java EE 容器。 **您当然可以将 Java EE 功能附加到 Tomcat**，但是当您将 JMS、JTA、WS 等结合在一起时，您所做的就是自己构建一个 Java EE 服务器。JBoss、Glassfish、JonAS 等他们都提供了一个已经过测试并且（希望）比你的更稳定的解决方案 :)

# sql - 唯一的列对作为 A,B 或 B,A

> ID：844646
> 
> 赞同：3
> 
> 时间：2009-05-10T03:47:10.323
> 
> 标签：sql, mysql

如果我有一个包含两列 TeamA 和 TeamB 的连接表，我如何确保每一对都是唯一的？

显然，我可以在这些列上放置一个唯一的复合索引，但这只会确保 A，B 顺序的唯一性，而不是 B，A 对吗？

```
TeamA | TeamB
-------------
 red  | blue
 pink | blue
 blue | red 
```

如您所见，Red vs. Blue 已被指定为第一条记录，然后再次指定为最后一条记录。这应该是非法的，因为他们已经面对面了。

**编辑：**另外，有没有办法处理 SELECT 案例？还是更新？删除？ETC..

此外，还提出了主队或客队的想法，这在这里可能很重要。这个最初的概念是在考虑如何在 DB 端构建包围系统时想到的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-10T03:55:27.417

定义一个约束，例如，A 列中的值必须（按字母顺序或数字）小于 B 列中的值：因此您可以插入 {blue,red} 但不能插入 {red,blue } 因为蓝色小于红色。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-10T03:50:29.660

如果您的 RDBMS（您没有指定）支持触发器，则在该表上创建一个触发器以强制执行您的约束。

创建一个在 INSERT 上触发的触发器，它检查是否已经存在顺序反转的对。如果它执行 ROLLBACK，则允许插入。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-10T05:06:29.710

这是一些与 Mitch 描述的触发方法一起使用的示例代码。

我还没有测试过这段代码，这里已经很晚了:-)

```
CREATE TRIGGER trig_addTeam
ON Teams
FOR INSERT, UPDATE
AS

DECLARE @TeamA VARCHAR(100) 
DECLARE @TeamB VARCHAR(100)
DECLARE @Count INT

SELECT @TeamA = (SELECT TeamA FROM Inserted)
SELECT @TeamB = (SELECT TeamB FROM Inserted)

SELECT @Count = (SELECT COUNT(*) FROM TEAMS WHERE (TeamA = @TeamA AND TeamB = @TeamB)
                 OR (TeamA = @TeamB AND TeamB = @TeamA))

IF @Count > 0 THEN

BEGIN
    ROLLBACK TRANSACTION
END 
```

这样做是查看当前表中是否存在 A|B 或 B|A 序列。如果是，则返回的计数大于零，并且事务回滚并且不提交到数据库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-20T21:32:47.223

如果存在同一对（反向），则取 TeamA>TeamB 的一对。

```
SELECT DISTINCT TeamA, TeamB 
FROM table t1 
WHERE t1.TeamA > t1.TeamB 
    OR NOT EXISTS (
        SELECT * FROM table t2 
            WHERE t2.TeamA = t1.TeamB AND t2.TeamB = t1.TeamA 
    ) 
```

# c# - C# 中的别名关键字（如 typedef）？

> ID：844651
> 
> 赞同：3
> 
> 时间：2009-05-10T03:50:40.207
> 
> 标签：c#

我有 2 个在不同平台上具有不同大小写的库 :(。似乎其他一切都是相同的（方法名称、参数顺序等）。我如何创建别名，以便我当前对平台 a 的拼写在我编译时可以工作对于平台 b（我真的很讨厌为大小写不同做一个包装器）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-10T04:02:59.833

您可以使用 using 关键字来创建别名：

```
using MyName = YourNamespace.YourSubNamespace.YourType; 
```

然后，您可以使用 #if 指令有条件地包含别名。但是，您需要在每个源文件的顶部执行此操作：没有类似#include 的指令允许您创建别名文件并将它们导入每个源文件。因此，如果您打算在大型代码库中执行此操作，那么可能值得考虑另一种方法，例如包装器方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-10T04:02:01.240

[在 C# 中，您可以为命名空间或类型](http://msdn.microsoft.com/en-us/library/sf0df423(VS.80).aspx)创建别名。它不像 typedef 那样灵活，但它可能使您可以将 lib a 中的类型别名为您想要的小写（或大写或其他）。

# wpf - 不将 ViewModel 放在单独的程序集中的充分理由？

> ID：844653
> 
> 赞同：12
> 
> 时间：2009-05-10T03:53:09.467
> 
> 标签：wpf, mvvm

我正在使用 WPF 中的 MVVM 模式开发一个项目。

MVVM 的主要好处之一是保持业务逻辑和表示之间的清晰分离。

作为一个测试，看看所有东西实际上分离得有多好，在周末我将所有 ViewModel、模型和业务逻辑移动到一个单独的 .dll 中。.exe 保留为薄的表示层。

这工作，无缝，*第一次尝试*。

我已经看到了将视图（xaml、演示文稿）保留在 .exe 中并将核心逻辑保留在其自己的 dll 中的好处。例如，对于 Xaml 中的代码隐藏是否是一个问题，我不再[有任何](http://www.google.com/search?q=wpf+mvvm+no+code+behind) [两难](https://stackoverflow.com/search?q=wpf+mvvm+code+behind)的想法：如果有必要，我会接受它，因为我知道它是特定于演示的。

到目前为止，这种 exe/dll 分离效果很好，以至于我的问题是：有没有人经历过这种方法的任何**缺点**？

相关问题：[在 WPF 中实现 MVVM 而不使用 System.Windows.Input.ICommand](https://stackoverflow.com/questions/503329/implementing-mvvm-in-wpf-without-using-system-windows-input-icommand)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-10-02T16:46:58.450

我们在所有产品中都使用这种分离，因为它可以帮助我们查看是否有任何代码违反了 UI - 业务逻辑分离。

大多数时候，我们按照您建议的方式进行操作：

*   Sample.Presentation.exe（包含所有 WPF 内容，精简程序集）

*   Sample.Applications.dll（负责应用程序的工作流程，这里都是ViewModels）

*   Sample.Domain.dll（这里是业务规则）

我们还没有遇到任何问题，我不希望将来看到任何问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-14T09:07:55.480

除了使用少/多项目的一般 pro/con 之外，我没有看到这种方法的任何特定问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-18T17:37:41.530

现在 2 周，我的模型和视图模型在 dll 中，我的 xaml 在 exe 中，没有任何问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-02-26T17:13:55.763

实际的问题是......组装是为了什么？

它们是一种分离逻辑的方法，使其对其他代码不可用，除非您添加引用，因此实际上它们是一种向其他部分隐藏部分代码的方法。

鉴于此目的以及您使用它的方式，我会说您做得对。

话虽如此，我发现更容易验证视图在代码审查中没有任何代码，并将视图保持在同一个程序集中。更少的项目 = 更快的编译和加载时间。

# ruby-on-rails - 使用视图在模型之间传输变量

> ID：844655
> 
> 赞同：2
> 
> 时间：2009-05-10T03:53:46.250
> 
> 标签：ruby-on-rails, ruby

我正在创建一个非常简单的书评网站，它需要允许用户添加关于一本书的少量评论的能力。现在我有两张表，一张用于书籍，一张用于评论，现在需要一种在两者之间传输数据的方法，因为我发现 rails 处理事情的方式非常令人费解。

所以我的图书模型包含“has_many :comments”，而我的评论模型包含：“belongs_to :book”

我用来查看和添加评论的视图是“/views/book/viewbook.html.erb”，它显示了这本书及其所有详细信息，底部是用户可以添加自己评论的部分，看起来像这样：

```
 `<%= form.text_field :title %>
    <%= form.text_area :body %>
    <%= submit_tag "Add Comment", :class => "submit" %>` 
```

`现在我知道这行不通，因为上面的“：title”和“：body”将在书籍模型中，但我需要将它们发送到评论模型，因为它们在评论数据库中。我如何将这些数据传递到评论数据库。我已经尝试过“：comment.title”和其他各种东西，但仍然无法锻炼如何传递这些数据。`

 `任何想法将不胜感激。

（如果这个问题非常愚蠢或没有得到很好的解释，我深表歉意，我的讲师设置了这个作业，并且 rails 不是我曾经使用过的语言。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-10T04:17:15.353

您在开始的表单标签中定义表单的用途：

```
<% form_for :comment do |form| %>

  <%= form.text_field :title %>
  <%= form.text_area  :body %>

  <%= submit_tag "Add Comment", :class => "submit" %>

<%= end %> 
```

这个想法是表单是一个空的评论对象。控制器在模型和视图之间进行通信，因此您的控制器应该有一个动作来处理知道将评论对象保存到评论模型中的表单。您还需要指定评论是针对哪本书的。有很多方法可以处理这个问题（隐藏字段、嵌套的 RESTful 资源等）。

也许从这里开始：http: [//guides.rubyonrails.org/action_controller_overview.html](http://guides.rubyonrails.org/action_controller_overview.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-10T22:46:12.113

因此，现在可以成功发布评论并使用正确的详细信息存储它们，现在我可以使用“book_id”值显示该特定书籍的评论列表。这是我认为可行的方法，我的应用程序的搜索部分也有这样的代码，所以我认为它会很好：

```
def view
  @book = Book.find(params[:id])
  @reviews = Comment.find_by_book_id(@book.id)
end 
```

对应的视图：

```
<% if @reviews %>
  <% for review in @reviews %>
    <%= form.label "Title: " %><%h review.title %> <br />
    <%= form.label "Review:" %><%h review.comment %>
  <% end %>
<% end %> 
```

现在应该得到具有我正在查看的书的“book_id”的评论，并使用 for 循环显示每个评论。虽然不太好用，它会吐出一条错误消息，内容如下：

```
#undefined method `each' for #<Comment:0xb682c2f4>
#Extracted source (around line #27) 
```

第 27 行是

```
 <% for review in @reviews %> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-11T00:23:48.350

要查找一本书的评论，只需：

```
@book = Book.find(params[:id]) 
```

就像您已经完成的那样，然后：

```
@book.comments 
```

对于那本书的评论。所以：

```
<% for review in @book.comments %
  <%= form.label "Title: " %><%h review.title %> <br />
  <%= form.label "Review:" %><%h review.comment %>
<% end %> 
```

您不必在控制器中查找注释。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-10T04:16:59.067

听起来您需要使用嵌套对象形式。这是 Rails 2.3 中的一个新特性：

[http://ryandaigle.com/articles/2009/2/1/what-s-new-in-edge-rails-nested-attributes](http://ryandaigle.com/articles/2009/2/1/what-s-new-in-edge-rails-nested-attributes)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-10T18:52:39.530

因此，我使用您的出色建议对其进行了修改，现在只出现了一个问题。虽然我现在可以成功存储评论标题、正文、时间和将评论留给数据库的人，但我仍然无法弄清楚如何使用存储 book.id。这是视图：

```
<% form_for :comment, :url => { :action => "addcomment" } do |form| %>
  <%= form.hidden_field :user_id, :value => session[:user_id] %>
  <%= form.hidden_field :book_id, :value => @book.id %> <!-- WONT WORK -->
  <%= form.label "Title" %><%= form.text_field :title %><br />
  <%= form.label "Comment" %><%= form.text_area :comment %>
    <%= submit_tag "addComment", :class => "submit" %>
<% end %> 
```

这是我的控制器，现在可以成功存储除 book.id 之外的详细信息

```
def addcomment
  @newcomment = Comment.new(params[:comment])
  if @newcomment.save
    flash[:notice] = "Comment Was Added To The System."
    redirect_to :action => "index"
  end
end 
```

我虽然“@book.id”会起作用，因为在那个视图中我还使用“@book.title”和“@book.authour”之类的东西来显示书籍的详细信息，这似乎有效，但不适用于 ID 字段尽管。

# ios - Objective-C 中的“@private”是什么意思？

> ID：844658
> 
> 赞同：281
> 
> 时间：2009-05-10T03:58:55.943
> 
> 标签：ios, objective-c, cocoa, private

`@private`在 Objective-C中是什么意思？

* * *

## 回答 #1

> 赞同：186
> 
> 时间：2009-05-10T04:07:27.170

这是一个*可见性修饰符*——这意味着声明为的实例变量`@private`只能由*同一类*的实例访问。私有成员不能被子类或其他类访问。

例如：

```
@interface MyClass : NSObject
{
    @private
    int someVar;  // Can only be accessed by instances of MyClass

    @public
    int aPublicVar;  // Can be accessed by any object
}
@end 
```

另外，澄清一下，Objective-C 中的方法总是公开的。不过，有一些“隐藏”方法声明的方法——有关更多信息，请参阅[此问题](https://stackoverflow.com/questions/172598/best-way-to-define-private-methods-for-a-class-in-objective-c)。

* * *

## 回答 #2

> 赞同：160
> 
> 时间：2009-05-16T06:14:32.150

正如 htw 所说，它是一个可见性修饰符。 `@private`意味着 ivar（实例变量）只能从同一类的实例中直接访问。但是，这对您来说可能意义不大，所以让我举个例子。`init`为简单起见，我们将使用类的方法作为示例。我将在线评论以指出感兴趣的项目。

```
@interface MyFirstClass : NSObject
{
    @public
    int publicNumber;

    @protected  // Protected is the default
    char protectedLetter;

    @private
    BOOL privateBool;
}
@end

@implementation MyFirstClass
- (id)init {
    if (self = [super init]) {
        publicNumber = 3;
        protectedLetter = 'Q';
        privateBool = NO;
    }
    return self;
}
@end 
```

* * *

```
@interface MySecondClass : MyFirstClass  // Note the inheritance
{
    @private
    double secondClassCitizen;
}
@end

@implementation MySecondClass
- (id)init {
    if (self = [super init]) {
        // We can access publicNumber because it's public;
        // ANYONE can access it.
        publicNumber = 5;

        // We can access protectedLetter because it's protected
        // and it is declared by a superclass; @protected variables
        // are available to subclasses.
        protectedLetter = 'z';

        // We can't access privateBool because it's private;
        // only methods of the class that declared privateBool
        // can use it
        privateBool = NO;  // COMPILER ERROR HERE

        // We can access secondClassCitizen directly because we 
        // declared it; even though it's private, we can get it.
        secondClassCitizen = 5.2;  
    }
    return self;
} 
```

* * *

```
@interface SomeOtherClass : NSObject
{
    MySecondClass *other;
}
@end

@implementation SomeOtherClass
- (id)init {
    if (self = [super init]) {
        other = [[MySecondClass alloc] init];

        // Neither MyFirstClass nor MySecondClass provided any 
        // accessor methods, so if we're going to access any ivars
        // we'll have to do it directly, like this:
        other->publicNumber = 42;

        // If we try to use direct access on any other ivars,
        // the compiler won't let us
        other->protectedLetter = 'M';     // COMPILER ERROR HERE
        other->privateBool = YES;         // COMPILER ERROR HERE
        other->secondClassCitizen = 1.2;  // COMPILER ERROR HERE
    }
    return self;
} 
```

因此，为了回答您的问题，@private 保护 ivars 免受任何其他类的实例的访问。请注意，MyFirstClass 的两个实例可以直接访问彼此的所有 ivars；假设由于程序员直接完全控制了这个类，他将明智地使用这种能力。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2012-10-02T23:54:03.733

`@private`当有人说您无法访问实例变量时，了解它的含义很重要。真实情况是，如果您尝试在源代码中访问这些变量，编译器会给您一个错误。在以前版本的 GCC 和 XCode 中，您只会收到警告而不是错误。

无论哪种方式，在运行时，所有赌注都是关闭的。这些`@private`和`@protected`ivars 可以被任何类的对象访问。这些可见性修饰符只会使将源代码编译为违反可见性修饰符意图的机器代码变得困难。

不要依赖 ivar 可见性修饰符来保证安全！他们根本不提供。它们严格用于在编译时执行类构建器的愿望。

# c# - ListViewGroups 无法正常工作

> ID：844667
> 
> 赞同：2
> 
> 时间：2009-05-10T04:03:36.820
> 
> 标签：c#, .net, winforms

我正在使用 C# 和 .NET 3.5 在 Windows 窗体中使用 ListView 控件。我有几个要添加到此 ListView 控件的项目，并且我有一些功能应该允许用户选择不同的方式来对列表中的项目进行分组。但是，有时项目会无缘无故地转储到自动生成的“默认”组中。

代码太大，不能放在这里，但让我解释一下我在算法上做什么。假设我们从一个包含项目的 ListView 开始，并且可能已经包含也可能不包含组。

1.  循环浏览每个项目并将其 Group 属性设置为 null。
2.  清空 ListView 的 Groups 集合。
3.  将新组添加到 ListView 的组集合。
4.  循环遍历每个项目并使用通过索引从 ListView 的 Group 集合中获得的值设置 Group 属性。

我已经逐步完成了代码并观察了一切。对于每个项目，它从 ListView 的 Group 集合中获取适当的组并设置项目的 Group 属性，但有时它们最终会列在“默认”组下。

有没有其他人观察到这一点或有任何关于它为什么会发生的理论？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-10T09:05:09.217

这听起来并不熟悉，我无法重现（见下文，它遵循您的方法）。您可以发布与您的“更新组”代码相关的任何内容吗？

```
using System;
using System.Windows.Forms;
static class Program {
    [STAThread]
    static void Main() {
        Application.EnableVisualStyles();
        ListView lv;
        Button btn;

        Form form = new Form {
            Controls = {
                (lv = new ListView { Dock = DockStyle.Fill,
                      ShowGroups = true}),
                (btn = new Button { Dock = DockStyle.Bottom,
                      Text = "Scramblle" })
            }
        };
        Random rand = new Random();
        for (int i = 0; i < 40; i++) {
            lv.Items.Add("Item " + i);
        }
        btn.Click += delegate {
            // 1: Cycle through every item and set it's Group
            // property to null.
            foreach (ListViewItem item in lv.Items) {
                item.Group = null;
            }
            // 2: Empty the ListView's Groups collection.
            lv.Groups.Clear();
            // 3: Add new Groups to the ListView's Group collection.
            int groupCount = rand.Next(lv.Items.Count) + 1;
            for (int i = 0; i < groupCount; i++) {
                lv.Groups.Add("grp" + i, "Group " + i);
            }
            // 4: Cycle through every item and set the Group property
            // using a value obtained from the ListView's Group collection
            // via index.
            foreach (ListViewItem item in lv.Items) {
                item.Group = lv.Groups[rand.Next(groupCount)];
            }
        };
        Application.Run(form);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T22:05:40.163

这是否发生在多个线程上？

听起来您可能正在添加一些 ListViewItems 并在清除组之前采取了组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T06:48:58.363

是的......它也发生在我身上。在添加项目之前尝试设置组。我的意思是，当您初始化 ListViewItem 时，您会将它所属的组添加到构造函数中。这种方式会奏效。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-15T15:37:47.710

是的，我见过类似的行为。我遵循的解决方案基于[此处](http://msdn.microsoft.com/en-us/library/system.windows.forms.listview.groups.aspx)的代码。

```
public partial class ListViewExtended : ListView
{
   private Collection<Dictionary<string, ListViewGroup>> groupTables = new Collection<Dictionary<string,ListViewGroup>>();

   public ListViewExtended()
   {
      InitializeComponent();
   }

   /// <summary>
   /// Create groups for each column of the list view.
   /// </summary>
   public void CreateGroups()
   {
      CreateGroups(false);
   }

   /// <summary>
   /// Create groups for each column of the list view.
   /// </summary>
   public void CreateGroups(bool reset)
   {
      if (OSFeature.Feature.IsPresent(OSFeature.Themes))
      {
         if (reset)
         {
            this.groupTables.Clear();
         }

         for (int column = 0; column < this.Columns.Count; column++)
         {
            Dictionary<string, ListViewGroup> groups = new Dictionary<string, ListViewGroup>();

            foreach (ListViewItem item in this.Items)
            {
               string subItemText = item.SubItems[column].Text;

               // Use the initial letter instead if it is the first column.
               if (column == 0)
               {
                  subItemText = subItemText.Substring(0, 1).ToUpperInvariant();
               }

               if (!groups.ContainsKey(subItemText))
               {
                  groups.Add(subItemText, new ListViewGroup(subItemText) { Name = subItemText });
               }
            }

            this.groupTables.Add(groups);
         }
      }
   }

   /// <summary>
   /// Sets the list view to the groups created for the specified column.
   /// </summary>
   /// <param name="column"></param>
   public void SetGroups(int column)
   {
      if (OSFeature.Feature.IsPresent(OSFeature.Themes))
      {
         try
         {
            this.BeginUpdate();
            this.Groups.Clear();

            if (column == -1)
            {
               this.ShowGroups = false;
            }
            else
            {
               this.ShowGroups = true;
               Dictionary<string, ListViewGroup> groups = groupTables[column];
               this.Groups.AddRange(groups.Values.OrderBy(g => g.Name).ToArray());

               foreach (ListViewItem item in this.Items)
               {
                  string subItemText = item.SubItems[column].Text;

                  // For the Title column, use only the first letter.
                  if (column == 0)
                  {
                     subItemText = subItemText.Substring(0, 1).ToUpperInvariant();
                  }

                  item.Group = groups[subItemText];
               }

               groups.Values.ForEach<ListViewGroup>(g => g.Header = String.Format(CultureInfo.CurrentUICulture, "{0} ({1})", g.Name, g.Items.Count));
            }
         }
         finally
         {
            this.EndUpdate();
         }
      }
   }
} 
```

在实际将项目添加到列表视图的代码中，您想要执行以下操作：

```
this.itemsListView.Items.AddRange(items.ToArray());
this.itemsListView.CreateGroups(true);
this.itemsListView.SetGroups(0); // Group by the first column by default. 
```

# asp.net - 将列值动态添加到 DataGridview

> ID：844671
> 
> 赞同：0
> 
> 时间：2009-05-10T04:08:43.673
> 
> 标签：asp.net, datagridview, datasource, dynamic

我的datagridview中有三列。一列是文本，一列是组合，另一列是文本...我不想使用数据源想在像datagridview.Rows [].cells [].value这样的单元格上添加值。帮帮我，我该怎么做？我的数据库有几列......如何动态添加列值......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-11T17:03:47.853

我只需要做同样类型的事情......这是添加列的方法。

```
If Not IsPostBack Then <br>

        Dim field As New TemplateField
        field.HeaderText = "Name of Column"
        Dim col As DataControlField = field
        GridView.Columns.Add(col)

        End If 
```

**在 Gridview_rowcreated Sub

```
e.row.cells(cellnumber from 0 to N).controls.Add(data) 
```

你将不得不创建一个连接和一个连接字符串

这是一个例子......

```
Dim Dbconn As SqlConnection
Dim Dbcmd As SqlCommand

Dbcmd = New Data.SqlClient.SqlCommand()
Dbcmd.Connection = Dbconn
Dbcmd.CommandType = Data.CommandType.Text

Dbcmd.Commandtext = "select * from table"
dbconn.open()

//then you need a data reader

dim dr as sqlclient.sqldatareader
dr = dbcmd.executereader
while dr.read
add each item to a list
end while 
```

然后在页面加载时将网格的数据源设置为列表

希望这会有所帮助...如果您有任何问题，请问我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-10T04:39:12.647

我强烈建议使用 Repeater 而不是 datagridview 并根据需要渲染尽可能多的列。

.aspx 代码

```
<tr>
    <asp:Repeater ID="rptDayHeaders" runat="server">
        <ItemTemplate>
            <td>
                <strong><asp:Literal ID="ltMonthHeader" runat="server"></asp:Literal></strong>
            </td>
        </ItemTemplate>
    </asp:Repeater>
</tr> 
```

.aspx.vb 代码

```
rptDayHeaders.DataSource = daysList
rptDayHeaders.DataBind() 
```

其中 dayslist 需要是您想要的列数的数组。

我们使用相同的方法来生成完整的甘特图

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-10T04:57:52.807

尝试一些类似的东西

```
dataGrid.Rows.Add(new object[] { "value1", 42, "value3"}); 
```

# linux - Gnome-Terminal，如何在不同的目录中启动？

> ID：844677
> 
> 赞同：26
> 
> 时间：2009-05-10T04:17:25.837
> 
> 标签：linux, console, terminal, gnome

每当我`gnome-terminal`在 Ubuntu 中启动控制台时，它都会在主目录中启动。我怎样才能让它在不同的目录中启动`~/myfolder`呢？我试图写信`cd ~/myfolder`，`~/.profile`但没有任何反应。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-05-10T04:50:51.060

如果您像启动 gnome-terminal 那样`gnome-terminal --working-directory=myfolder`从工作目录开始，`~/myfolder`那么您可以在菜单中添加一个新条目以使用该命令而不是另一个命令。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-10T04:55:43.950

将以下内容添加到您的 ~/.bashrc

```
cd ~/myfolder 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-07-08T13:28:54.917

我这样做了 - 使用脚本：在相同的窗口大小 170x40 中打开 3 个选项卡，每个“选项卡”从不同的目录开始。

```
gnome-terminal --geometry=170x40 --working-directory=myfolder1 \

--tab --working-directory=myfolder2 \

--tab --working-directory=myfolder3 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-07-17T23:43:35.677

您可以使用[nautilus-open-terminal](http://ubuntu-tutorials.com/2007/05/13/nautilus-open-terminal-terminal-quick-launch/)扩展。这允许您右键单击 nautilus 中的文件夹并打开一个终端窗口，该目录作为其工作目录。

您也可以以正常方式运行终端，键入“cd”，然后将文件夹图标从 nautilus 拖到窗口中。这会将文件夹的路径粘贴到命令行中，然后键入 return 以更改到该目录。您可以对常规文件执行相同的操作，以粘贴其路径并在其上运行命令。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-08-19T01:00:29.817

实际上，这就是我默认为每个人关闭它的方式。

```
gconftool-2 --direct \
--config-source xml:readwrite:/etc/gconf/gconf.xml.mandatory/ \
--set -- type=bool /apps/nautilus-open-terminal/desktop_opens_home_dir true 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-11-22T04:04:43.830

## 目录选项

有 `--working-directory`指定终端启动目录的选项（没有短选项形式）。

打开终端的基本方法`/some/dir`是

```
gnome-terminal --working-directory=/some/dir 
```

但是有一个陷阱...

## 坏陷阱

假设我们要在目录中启动终端`~/dir`。

**这不起作用：**

```
gnome-terminal --working-directory=~/dir 
```

根据选项语法，该命令看起来非常好，但终端从主目录开始。
这是因为它没有扩展波浪号 ( `~`)，原因令人困惑 - 见下文。

这些确实有效：

```
gnome-terminal --working-directory=/home/auser/dir

gnome-terminal --working-directory=$HOME/dir

gnome-terminal --working-directory ~/dir 
```

## 波浪号扩展

请注意`=`，最后一个变体中没有。因此， the`~`位于 shell 单词的开头，因此由波浪号扩展处理。

问题是它`~`不会到处扩展，而只是在某些地方。其中之一是变量赋值，例如`directory=~/dir`. 没关系，`~`扩展为`$HOME`，但`--working-directory=~/dir`不扩展`~`，因为这不是变量赋值，只是看起来非常相似。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-10T04:36:57.130

从[GNOME 终端 - 入门](http://library.gnome.org/users/gnome-terminal/stable/gnome-terminal-get-started.html.en)：

> 您还可以指定在配置文件中启动 GNOME 终端时自动运行的命令。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-07-17T23:46:14.970

如果文件夹有一个复杂的路径，即不仅仅是`~/myfolder`，您可以在您的主目录中创建一个指向它的符号链接，这样您就可以快速找到它。您还可以设置`CDPATH`环境变量以告诉 bash 在您键入时搜索目录列表`cd myfolder`。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-11-13T14:00:21.113

[Neil 的 Mayhew 评论](https://stackoverflow.com/questions/844677/gnome-terminal-how-to-start-in-a-different-directory/844711#comment3386972_844711) 和 [Volker 的 Siegel 回答](https://stackoverflow.com/a/27073924/4672928)给我留下了深刻的印象 。我不仅尝试为 **gnome-terminal**设置默认目录，还尝试保留桌面环境的习惯行为（我正在使用*Linux Mint 17.1 Cinnamon*， *GNOME Terminal 3.6.2*，也许它也可以应用于其他 Gnome-congenred德斯）。所以让我把我的两分钱放进去。

1.  `cd ~/myfolder`在最后添加`~/.bashrc`就可以了。但正如已经提到的，它将影响每个交互式 shell。更重要的是，如果您在文件管理器（*Nemo*或*Nautilus*或类似的东西）中打开某个目录并从那里调用上下文菜单（例如，右键单击然后选择**在终端中打开）新的****gnome-terminal**实例 将在`~/myfolder`无论文件管理器中加载的文件夹如何。即使你`gnome-terminal --working-directory=/some/other/folder`显式运行它仍然会打开`~/myfolder`。似乎该方法`.bashrc`无法使用。

2.  `gnome-terminal --working-directory=myfolder`工作正常，但仅当您在使用此参数运行终端的 DE（或桌面上的自定义快捷方式）中使用自定义菜单条目时。如果您想从命令行或迷你启动器（按+ ）运行**gnome-terminal**，您必须每次都输入参数。无论如何，这种方法或多或少是可用的。`Alt``F2`

* * *

**gnome-terminal**如何确定要打开哪个文件夹？如果`--working-directory`未指定，则打开当前工作目录（例如`$PWD`），否则打开明确指定的目录。

我找到了以下解决方案。

`gnome-terminal`在您的文件夹中创建一个名为的`~/bin`文件。它将充当快捷方式，但来自任何地方（开始菜单、迷你启动器、其他终端实例等），因为`~/bin`它已经存在`$PATH`（至少在 Linux Mint 中......）。使该文件可执行。然后将以下内容放入脚本中：

```
#!/bin/bash

home_directory=~

if [ "$PWD" == "$home_directory" ]; then
    # When 'gnome-terminal' was ran from either 
    #     - start menu
    #     - mini-launcher
    #     ... 
    # parent directory is set to $HOME.
    #
    # We respect original command line arguments. 
    # For example, when terminal is ran from another 
    # terminal instance and '--working-directory' is 
    # specified explicitly we should left it as it is.  
    # If there are two '--working-directory' switches 
    # in the command line 'gnome-terminal' will pick up 
    # the last one.
    #
    # Also we use full path to executable here in order
    # to prevent recursive calling of 'gnome-terminal' from 
    # '~/bin'.
    /usr/bin/gnome-terminal --working-directory=/ "$@" 
else
    # 'gnome-terminal' was from another directory. 
    # We don't change anything.
    /usr/bin/gnome-terminal "$@"
fi 
```

如果您从开始菜单运行**gnome-terminal**，您将看到新终端中的当前文件夹是`/`（例如，您可以使用任何文件夹，`~/myfolder`因为我们的自定义包装器是 Bash 脚本，因此 shell 的扩展工作正常）。

如果您在文件管理器中呼吁**在终端中打开，您将在新终端中获得当前目录。**

如果您使用显式参数（可能来自现有终端实例）运行**gnome-terminal**`--working-directory` ，则将在您指定的目录中打开新的终端实例。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-12-30T11:19:34.167

要以 root 用户身份在我想要的目录中打开，我运行了：

```
gnome-terminal --working-directory=/home/my-project/ -x bash -c "sudo su" 
```

# iphone - 如何处理包含属性的 Objective-C 协议？

> ID：844678
> 
> 赞同：136
> 
> 时间：2009-05-10T04:17:36.053
> 
> 标签：iphone, objective-c, cocoa-touch

我已经看到 Objective-C 协议的用法以如下方式使用：

```
@protocol MyProtocol <NSObject>

@required

@property (readonly) NSString *title;

@optional

- (void) someMethod;

@end 
```

我已经看到使用这种格式而不是编写子类扩展的具体超类。问题是，如果你遵守这个协议，是否需要自己合成属性？如果你正在扩展一个超类，答案显然是否定的，你不需要。但是如何处理协议需要遵守的属性呢？

据我了解，您仍然需要在符合需要这些属性的协议的对象的头文件中声明实例变量。在那种情况下，我们可以假设它们只是一个指导原则吗？显然，所需方法的情况并非如此。编译器会为您排除协议列出的所需方法而拍打您的手腕。然而，房产背后的故事是什么？

这是一个生成编译错误的示例（注意：我已经修剪了未反映手头问题的代码）：

我的协议.h

```
@protocol MyProtocol <NSObject>

@required
@property (nonatomic, retain) id anObject;

@optional 
```

TestProtocolsViewController.h

```
- (void)iDoCoolStuff;

@end

#import <MyProtocol.h>

@interface TestProtocolsViewController : UIViewController <MyProtocol> {

}

@end 
```

TestProtocolsViewController.m

```
#import "TestProtocolsViewController.h"

@implementation TestProtocolsViewController
@synthesize anObject; // anObject doesn't exist, even though we conform to MyProtocol.

- (void)dealloc {
    [anObject release]; //anObject doesn't exist, even though we conform to MyProtocol.
    [super dealloc];
}

@end 
```

* * *

## 回答 #1

> 赞同：138
> 
> 时间：2009-05-10T05:46:00.333

该协议只是告诉通过协议知道您的班级的每个人，该属性`anObject`将在那里。协议不是真实的，它们本身没有变量或方法——它们只描述了一组特定的属性，这些属性对你的类是正确的，因此持有对它们的引用的对象可以以特定的方式使用它们。

这意味着在符合您的协议的类中，您必须尽一切努力确保 anObject 正常工作。

`@property`并且`@synthesize`本质上是为您生成代码的两种机制。 `@property`只是说该属性名称将有一个getter（和/或setter）方法。仅这些天`@property`就足以拥有系统为您创建的方法和存储变量（您以前必须添加`@sythesize`）。但是你必须有一些东西来访问和存储变量。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2011-01-02T14:35:58.567

这是我的一个完美运行的示例，首先是协议定义：

```
@class ExampleClass;

@protocol ExampleProtocol

@required

// Properties
@property (nonatomic, retain) ExampleClass *item;

@end 
```

下面是一个支持此协议的类的工作示例：

```
#import <UIKit/UIKit.h>
#import "Protocols.h"

@class ExampleClass;

@interface MyObject : NSObject <ExampleProtocol> {

    // Property backing store
    ExampleClass        *item;

}

@implementation MyObject

// Synthesize properties
@synthesize item;

@end 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-05-10T04:21:22.067

你所要做的就是放下一个

```
@synthesize title; 
```

在您的实施中，您应该准备就绪。它的工作方式与将属性放入类接口中的方式相同。

**编辑：**

您可能希望更具体地执行此操作：

```
@synthesize title = _title; 
```

如果您使用自动合成，这将符合 xcode 的自动合成如何创建属性和 ivars，因此如果您的类具有来自协议和类的属性，那么您的一些 ivars 将不会具有可能影响的不同格式可读性。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2014-07-12T18:52:17.400

看看我的文章[PROPERTY IN PROTOCOL](http://www.fantageek.com/blog/2014/07/13/property-in-protocol/)

假设我有声明 name 属性的 MyProtocol 和符合此协议的 MyClass

**值得注意的事情**

1.  MyClass 中的 identifier 属性声明并生成 getter、setter 和支持 _identifier 变量
2.  name 属性只声明 MyClass 在 header 中有一个 getter、setter。它不生成 getter、setter 实现和支持变量。
3.  我不能重新声明这个名称属性，因为它已经被协议声明了。这样做会报错

    ```
    @interface MyClass () // Class extension

    @property (nonatomic, strong) NSString *name;

    @end 
    ```

**如何在协议中使用属性**

因此，要将 MyClass 与该 name 属性一起使用，我们必须这样做

1.  再次声明属性（AppDelegate.h 这样做）

    ```
    @interface MyClass : NSObject <MyProtocol>

    @property (nonatomic, strong) NSString *name;

    @property (nonatomic, strong) NSString *identifier;

    @end 
    ```

2.  综合我们自己

    ```
    @implementation MyClass

    @synthesize name;

    @end 
    ```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-05-07T22:04:35.543

![协议架构](https://i.stack.imgur.com/nYLvJ.jpg)

示例：2 个类（Person 和 Serial）想要使用 Viewer 的服务......并且必须符合 ViewerProtocol。viewerTypeOfDescription 是订阅者类必须符合的强制属性。

```
typedef enum ViewerTypeOfDescription {
    ViewerDataType_NSString,
    ViewerDataType_NSNumber,
} ViewerTypeOfDescription;

@protocol ViewerProtocol
@property ViewerTypeOfDescription viewerTypeOfDescription;
- (id)initConforming;
- (NSString*)nameOfClass;
- (id)dataRepresentation;
@end

@interface Viewer : NSObject
+ (void) printLargeDescription:(id <ViewerProtocol>)object;
@end

@implementation Viewer
+ (void) printLargeDescription:(id <ViewerProtocol>)object {
    NSString *data;
    NSString *type;
    switch ([object viewerTypeOfDescription]) {
        case ViewerDataType_NSString: {
            data=[object dataRepresentation];
            type=@"String";
            break;
        }
        case ViewerDataType_NSNumber: {
            data=[(NSNumber*)[object dataRepresentation] stringValue];
            type=@"Number";
            break;
        }
        default: {
            data=@"";
            type=@"Undefined";
            break;
        }
    }
    printf("%s [%s(%s)]\n",[data cStringUsingEncoding:NSUTF8StringEncoding],
           [[object nameOfClass] cStringUsingEncoding:NSUTF8StringEncoding],
           [type cStringUsingEncoding:NSUTF8StringEncoding]);
}
@end

/* A Class Person */

@interface Person : NSObject <ViewerProtocol>
@property NSString *firstname;
@property NSString *lastname;
@end

@implementation Person
// >>
@synthesize viewerTypeOfDescription;
// <<
@synthesize firstname;
@synthesize lastname;
// >>
- (id)initConforming {
    if (self=[super init]) {
        viewerTypeOfDescription=ViewerDataType_NSString;
    }
    return self;
}
- (NSString*)nameOfClass {
    return [self className];
}
- (NSString*) dataRepresentation {
    if (firstname!=nil && lastname!=nil) {
        return [NSString stringWithFormat:@"%@ %@", firstname, lastname];
    } else if (firstname!=nil) {
        return [NSString stringWithFormat:@"%@", firstname];
    }
    return [NSString stringWithFormat:@"%@", lastname];
}
// <<
@end

/* A Class Serial */

@interface Serial : NSObject <ViewerProtocol>
@property NSInteger amount;
@property NSInteger factor;
@end

@implementation Serial
// >>
@synthesize viewerTypeOfDescription;
// <<
@synthesize amount;
@synthesize factor;
// >>
- (id)initConforming {
    if (self=[super init]) {
        amount=0; factor=0;
        viewerTypeOfDescription=ViewerDataType_NSNumber;
    }
    return self;
}
- (NSString*)nameOfClass {
    return [self className];
}
- (NSNumber*) dataRepresentation {
    if (factor==0) {
        return [NSNumber numberWithInteger:amount];
    } else if (amount==0) {
        return [NSNumber numberWithInteger:0];
    }
    return [NSNumber numberWithInteger:(factor*amount)];
}
// <<
@end

int main(int argc, const char * argv[])
{

    @autoreleasepool {

        Person *duncan=[[Person alloc]initConforming];
        duncan.firstname=@"Duncan";
        duncan.lastname=@"Smith";

        [Viewer printLargeDescription:duncan];

        Serial *x890tyu=[[Serial alloc]initConforming];
        x890tyu.amount=1564;

        [Viewer printLargeDescription:x890tyu];

        NSObject *anobject=[[NSObject alloc]init];

        //[Viewer printLargeDescription:anobject];
        //<< compilator claim an issue the object does not conform to protocol

    }
    return 0;
} 
```

另一个通过子类继承协议的例子

```
typedef enum {
    LogerDataType_null,
    LogerDataType_int,
    LogerDataType_string,
} LogerDataType;

@protocol LogerProtocol
@property size_t numberOfDataItems;
@property LogerDataType dataType;
@property void** data;
@end

@interface Loger : NSObject
+ (void) print:(id<LogerProtocol>)object;
@end

@implementation Loger
+ (void) print:(id<LogerProtocol>)object {
    if ([object numberOfDataItems]==0) return;
    void **data=[object data];
    for (size_t i=0; i<[object numberOfDataItems]; i++) {
        switch ([object dataType]) {
            case LogerDataType_int: {
                printf("%d\n",(int)data[i]);
            break;
            }
            case LogerDataType_string: {
                printf("%s\n",(char*)data[i]);
                break;
            }
            default:
            break;
        }
    }
}
@end

// A Master Class

@interface ArrayOfItems : NSObject  <LogerProtocol>
@end

@implementation ArrayOfItems
@synthesize dataType;
@synthesize numberOfDataItems;
@synthesize data;
- (id)init {
    if (self=[super init]) {
        dataType=LogerDataType_null;
        numberOfDataItems=0;
    }
    return self;
}
@end

// A SubClass

@interface ArrayOfInts : ArrayOfItems
@end

@implementation ArrayOfInts
- (id)init {
    if (self=[super init]) {
        self.dataType=LogerDataType_int;
    }
    return self;
}
@end

// An other SubClass

@interface ArrayOfStrings : ArrayOfItems
@end

@implementation ArrayOfStrings
- (id)init {
    if (self=[super init]) {
        self.dataType=LogerDataType_string;
    }
    return self;
}
@end

int main(int argc, const char * argv[])
{

    @autoreleasepool {

        ArrayOfInts *arr=[[ArrayOfInts alloc]init];
        arr.data=(void*[]){(int*)14,(int*)25,(int*)74};
        arr.numberOfDataItems=3;

        [Loger print:arr];

        ArrayOfStrings *arrstr=[[ArrayOfStrings alloc]init];
        arrstr.data=(void*[]){(char*)"string1",(char*)"string2"};
        arrstr.numberOfDataItems=2;

        [Loger print:arrstr];

    }
    return 0;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-10T04:52:42.223

变量 anObject 需要在您的 TestProtocolsViewController 类定义中定义，协议只是通知您它应该在那里。

编译器错误告诉你真相 - 变量不存在。@properties 毕竟只是帮手。

# python - Python 正则表达式问题：剥离多行注释但保持换行符

> ID：844681
> 
> 赞同：4
> 
> 时间：2009-05-10T04:20:41.007
> 
> 标签：python, regex, parsing, comments

我正在解析一个源代码文件，我想删除所有行注释（即以“//”开头）和多行注释（即*/..../*）。但是，如果多行注释中至少有一个换行符 (\n)，我希望输出正好有一个换行符。

例如，代码：

```
qwe /* 123
456 
789 */ asd 
```

应该完全变成：

```
qwe
asd 
```

而不是“qweasd”或：

```
qwe

asd 
```

最好的方法是什么？谢谢

* * *

编辑：测试示例代码：

```
comments_test = "hello // comment\n"+\
                "line 2 /* a comment */\n"+\
                "line 3 /* a comment*/ /*comment*/\n"+\
                "line 4 /* a comment\n"+\
                "continuation of a comment*/ line 5\n"+\
                "/* comment */line 6\n"+\
                "line 7 /*********\n"+\
                "********************\n"+\
                "**************/\n"+\
                "line ?? /*********\n"+\
                "********************\n"+\
                "********************\n"+\
                "********************\n"+\
                "********************\n"+\
                "**************/\n"+\
                "line ??" 
```

预期成绩：

```
hello 
line 2 
line 3  
line 4
line 5
line 6
line 7
line ??
line ?? 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-10T05:01:02.347

```
comment_re = re.compile(
    r'(^)?[^\S\n]*/(?:\*(.*?)\*/[^\S\n]*|/[^\n]*)($)?',
    re.DOTALL | re.MULTILINE
)

def comment_replacer(match):
    start,mid,end = match.group(1,2,3)
    if mid is None:
        # single line comment
        return ''
    elif start is not None or end is not None:
        # multi line comment at start or end of a line
        return ''
    elif '\n' in mid:
        # multi line comment with line break
        return '\n'
    else:
        # multi line comment without line break
        return ' '

def remove_comments(text):
    return comment_re.sub(comment_replacer, text) 
```

*   `(^)?`如果注释从行首开始，只要`MULTILINE`使用了 -flag，就会匹配。
*   `[^\S\n]`将匹配除换行符以外的任何空白字符。如果注释从它自己的行开始，我们不想匹配换行符。
*   `/\*(.*?)\*/`将匹配多行注释并捕获内容。惰性匹配，所以我们不匹配两个或多个评论。`DOTALL`-flag`.`匹配换行符。
*   `//[^\n]`将匹配单行注释。`.`由于 -标志而无法使用`DOTALL`。
*   `($)?`如果注释在行尾停止，只要使用- 标志，它将匹配`MULTILINE`。

例子：

```
>>> s = ("qwe /* 123\n"
         "456\n"
         "789 */ asd /* 123 */ zxc\n"
         "rty // fgh\n")
>>> print '"' + '"\n"'.join(
...     remove_comments(s).splitlines()
... ) + '"'
"qwe"
"asd zxc"
"rty"
>>> comments_test = ("hello // comment\n"
...                  "line 2 /* a comment */\n"
...                  "line 3 /* a comment*/ /*comment*/\n"
...                  "line 4 /* a comment\n"
...                  "continuation of a comment*/ line 5\n"
...                  "/* comment */line 6\n"
...                  "line 7 /*********\n"
...                  "********************\n"
...                  "**************/\n"
...                  "line ?? /*********\n"
...                  "********************\n"
...                  "********************\n"
...                  "********************\n"
...                  "********************\n"
...                  "**************/\n")
>>> print '"' + '"\n"'.join(
...     remove_comments(comments_test).splitlines()
... ) + '"'
"hello"
"line 2"
"line 3 "
"line 4"
"line 5"
"line 6"
"line 7"
"line ??"
"line ??" 
```

**编辑：**

*   更新为新规范。
*   添加了另一个示例。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-10T05:07:18.990

您甚至必须提出这个问题，并且给出的解决方案，容我们说，不太可读:-) 应该很好地表明 RE 不是这个问题的真正答案。

从可读性的角度来看，将其实际编码为一个相对简单的解析器会好得多。

很多时候，人们试图用 RE 来“聪明”（我并不是说以贬低的方式），认为单行是优雅的，但他们最终得到的只是无法维护的字符泥潭。我宁愿有一个我可以立即理解的完整注释的 20 行解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-10T04:30:47.440

这是你要找的吗？

```
>>> print(s)
qwe /* 123
456
789 */ asd
>>> print(re.sub(r'\s*/\*.*\n.*\*/\s*', '\n', s, flags=re.S))
qwe
asd 
```

这仅适用于超过一行的评论，但不会影响其他评论。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-10T04:56:47.783

这个怎么样：

```
re.sub(r'\s*/\*(.|\n)*?\*/\s*', '\n', s, re.DOTALL).strip() 
```

它攻击前导空格，，`/*`任何文本和换行符，直到第一个`*\`，然后是之后的任何空格。

它对 sykora 的例子有点扭曲，但它在内部也是非贪婪的。您可能还想查看 Multiline 选项。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-10T04:57:04.040

请参阅[can-regular-expressions-be-used-to-match-nested-patterns](https://stackoverflow.com/questions/133601/can-regular-expressions-be-used-to-match-nested-patterns) - 如果您考虑嵌套注释，则正则表达式不是解决方案。

# google-analytics - 网站分析 - haveamint.com 还是 Google Analytics？

> ID：844684
> 
> 赞同：8
> 
> 时间：2009-05-10T04:29:00.660
> 
> 标签：google-analytics, analytics

是否有适用于[Mint](http://haveamint.com)和 Google Analytics 的比较分析，可以帮助我决定在我的情况下实施哪一个？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-10T08:54:52.643

对于我工作的每个网站，我只使用谷歌分析。我的主要原因：

*   免费 - 无限的网站和点击
*   无广告
*   我不觉得难用，我的客户也不觉得难（大多数人会在几分钟内搞定）
*   它有一个[API](http://code.google.com/apis/analytics/docs/)，所以如果你想要更多，你可以添加你自己的统计数据，甚至合并到网站中
*   对于电子商务，电子商务的额外跟踪很棒
*   有理论认为它甚至可能有助于您的 Google 排名（因为他们会获得有关您网站的额外数据）
*   很多人用，所以经常缓存JS
*   易于设置（我不知道薄荷，但 GA 是几行 JS）
*   连接到adsense，因此可以一起跟踪统计信息（我不知道其他人是否支持这一点）

... 和更多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-09-20T03:39:58.853

几年来，我一直在企业环境中使用 Google Analytics。当然存在限制，特别是在合并到其他数据集时。API 对于弥合这一差距非常宝贵，并真正鼓励利益相关者提出更好的问题。

在我看来，请根据您的业务需求评估两者并找出优缺点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-10T04:50:52.340

Mint 更简单，总是最新的，并且有很多针对博客和个人网站的插件。谷歌分析更复杂，需要一点时间来理解，每天更新，并且为更大的网站（如营销、电子商务等）提供更多功能。

在我自己的网站上，我开始使用 Mint，两者都使用了一段时间，但现在我对 Google Analytics（分析）感到非常满意。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-10T08:56:20.440

为什么您特别选择了这两个可能的选项？那里有许多不错的软件包，其中许多是免费的，并提供出色的服务，与“默认”选择 Google 相比，这些服务可能具有引人注目的优势。

看看[这篇 ReadWriteWeb](http://www.readwriteweb.com/archives/10_web_analytics_tools_free_innovative.php)帖子，它比较了 10 种免费的初学者分析工具。

我在我的网站上使用[Clicky](http://getclicky.com)，发现它是 GA 的绝佳替代品。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-09-18T14:10:34.917

I recommend GA so that as your site grows bigger, you are already on top of a fine analytics tool. Mint is fine for now, but you need to plan for the future, too.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-20T09:31:34.013

如果您对开源服务器端分析感兴趣，您应该查看[http://piwik.org/](http://piwik.org/)。我自己没有使用它，但我听说它很不错，可以与 Google Analytics 相媲美。我自己使用 GA，对此我很满意。只需进行一些额外的测试，例如 Kiss Metrics 就可以了 :)

# javascript - Firefox 3 窗口焦点和模糊

> ID：844689
> 
> 赞同：2
> 
> 时间：2009-05-10T04:32:17.017
> 
> 标签：javascript, firefox, focus

$(window).blur(function(){ windowFocus = false; }).focus(function(){ windowFocus = true; });

问题是在 Firefox 3 中，当我创建一个新选项卡时，它不会丢失 windowFocus。在 ff2 中，ie7 确实输了。在 ff3 中，当我选择另一个程序时，它只会失去窗口焦点。

有人有解决这个问题的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-10T04:51:06.690

改为附加到事件`document`：

```
$(document).blur(function(){
        windowFocus = false;
}).focus(function(){
        windowFocus = true;
}); 
```

...FWIW，这似乎已在 FF3.5 中修复。

# primary-key - 如何解析 RDBMS 中的多对多集合实体？

> ID：844701
> 
> 赞同：0
> 
> 时间：2009-05-10T04:45:50.917
> 
> 标签：primary-key, many-to-many, rdbms

我正在尝试为艺术家和歌曲建模，但我有一个问题，我有一个 Song_Performance 可以由许多艺术家表演（比如二重唱），所以我有一个 Artist_Group 来代表歌曲的演唱者。

好吧，我现在在 Artist 和 Artist_Group 之间建立了多对多的关系，其中 Artist_Group 由该组中的艺术家集合唯一标识。我可以创建一个交集实体，表示艺术家参与 Artist_Group (Artist_Group_Participation?)

我无法想出如何为 Artist_Group 实体提供一个主键，该主键保留了同一组艺术家代表同一组的事实，并且缺少 Artist_Group 实体的主键意味着我缺少一个Artist_Group_Participation 实体的外键。

John Carlis 和 Joseph Maguire 的“Mastering Data Modeling”一书提到了这种形状并将其称为“Many-Many Collection Entity”，并指出它非常罕见，但没有说明如何解决它，因为显然很多一对多关系不能直接存储在 RDBMS 中。我该如何代表这个？

编辑：

看起来每个人都在建议一个交叉表，但这不是我的问题。我有这个。我的问题是强制执行约束，即您不能添加 Artist_Group 条目，其中包含的艺术家组与现有组相同，忽略顺序。我想过让 Artist_Group 的 ID 是一个 varchar，它是组成它的各种艺术家的串联，如果顺序很重要，这将解决问题，但是为“Elton John and Billy Joel”设置一个 Artist_Group 并不能阻止添加“比利·乔尔和埃尔顿·约翰”的组合。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-10T04:55:52.327

Artist 和 Artist_Group 的主键都是数字增量 ID。然后你会有一个 Artist_Group_Participation 表，它有两列：artist_id 和 group_id。这些将是引用其各自表的 ID 的外键。然后选择您将使用 JOIN 的所有内容。

**编辑：**对不起，我误解了你的问题。我能想到的唯一其他方法是在 Artist_Group 表中添加一个“艺术家”列，其中包含艺术家及其 ID 的序列化数组（假设您使用的是 PHP，但其他语言有等价物）。然后只需向该列添加一个 UNIQUE 约束。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-10T05:31:13.193

您可以使每个艺术家的 ID 对应于位域中的位。因此，如果 Elton John 的 ID 为 12，Billy Joel 的 ID 为 123，则由 Elton John 和 Billy Joel 之间的二重唱形成的“组”为`Artist_Group`ID 10633823966279326983230456482242760704（即，它具有第 12 位和第 123 位设置）。

您可以使用交集表强制关系。例如，`CHECK`在 PostgreSQL 中使用约束：

```
CREATE TABLE Artist_Group_Participation (
  artist_id int not null,
  artist_group_id int not null,
  PRIMARY KEY (artist_id, artist_group_id),
  FOREIGN KEY (artist_id) REFERENCES Artists (artist_id),
  FOREIGN KEY (artist_group_id) REFERENCES Artist_Group (artist_group_id),
  CHECK (B'1'<<artist_id & artist_group_id <> 0)
); 
```

诚然，这是一个 hack。`Artist_Group`当代理键应该是唯一的但不包含信息时，它对代理键施加了额外的重要性。

此外，如果您有成千上万的艺术家，并且每天都有新的艺术家，事情可能会变得笨拙，因为`Artist_Group`密钥的数据类型的长度需要一直变大。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-10T05:36:47.267

我想我错过了“Artist_Group”关系的重点。

我心目中的数据模型是：

艺术家：个人。

歌曲：歌曲本身。

表演：歌曲的特定表演或编曲。通常这会有一首歌曲，但您可以提供一个 m:n 链接表来容纳混合曲目。理想情况下，这将是一个单一的真实表演，即，会有一个相关的日期。

录音：表演的特定固定版本（CD 或其他）。通常表演只有一个录音，但有一个单独的表可以处理 Grateful Dead / 多盗版场景，以及重新发行专辑、广播播放与现场与 CD 版本等。

Performance_Artists：从特定表演到表演者列表的链接表。对于每个人，您还可以有一个属性来描述他们在表演中的角色（歌手、鼓手等）。

**一组表演者之间没有明确的关系，*只是*他们共同分享表演。因此，任何试图在录音上下文之外组合随机艺术家集的表都不是准确的关系模型，因为没有真正的关系。**

如果您试图表示一组艺术家之间的**明确**关系（即，他们在同一个乐队中），那么乐队的名称具有唯一性（尽管不足以成为主键），并且可以存储一个乐队简单地作为一个艺术家，然后有一个 Artist_Member 链接表，它可以自引用回各个艺术家记录。或者你可以有一个单独的 Band 表和一个 Band_Members 表来为它分配艺术家，也许还有成员的日期。无论哪种方式，只要记住乐队成员会随着时间的推移而变化，乐队角色会从一首歌曲到另一首歌曲，因此将乐队与表演相关联不应代替将表演直接与相关艺术家联系起来。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-10T06:53:46.613

我想您可以通过对艺术家 ID 进行排序和连接来构建主键？

组：3,2,6 -> 2-3-6 和 6,3,2 -> 2-3-6

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-10T12:22:20.687

我在 RDBMS 方面没有太多经验。但是，我读过 Codd 的论文和 CJ Date 的书籍。

所以，我不会使用 RDBMS 术语，而是尝试用更常见的有意义的术语来解释（至少对我来说！）

开始 -

1.  歌手姓名应以“名 - 姓”为标准

2.  每个“歌手”都应该在“艺人组”表中有一个条目，即使他们已经独奏

3.  “艺术家组”中的每个条目将由多个按字母顺序排列的“歌手”组成。特定组合应该只出现一次。

4.  每首歌曲都将有一个来自“Artists Group”的独特唱片条目，无论它们是独奏、二重奏还是团伙。

我不知道这是否有意义，但这是我的两分钱！

# user-interface - XUL 运行器作为我的应用程序的 GUI 框架，我在这里缺少什么？

> ID：844709
> 
> 赞同：1
> 
> 时间：2009-05-10T04:53:30.430
> 
> 标签：user-interface, licensing, xulrunner

最近我被介绍给 mozilla XUL runner 作为前线 GUI 的框架，这对我来说似乎是基于 xul 和 js 事件的 idial 框架（没有 GUI 人），并让我有可能使用 c++ 作为后端（xpcom）。它的接缝好到完美。我的问题是针对那些在这个框架中过期的人，可以给我一些关于这个框架的局限性的观点。我也可以将商业软件基于 XULrunner 二进制文件吗？有人知道这个许可证问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-10T05:00:47.853

我认为困难的部分是您要为要支持的每个平台编译二进制文件。那是非常讨厌的限制。是的，Mozilla 许可证非常自由，可用于商业目的，这[是许可证](http://www.mozilla.org/MPL/MPL-1.1.html)和带[注释的指南](http://www.mozilla.org/MPL/MPL-1.1-annotated.html)。在这里，我喜欢这个[概述](http://www.oss-watch.ac.uk/resources/mpl.xml)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-09T15:23:30.983

XUL 很棒。

一个缺点是它没有被推广为桌面应用程序开发框架。所以工具支持比微软的差，不是所有的东西都记录在案，它没有组件来做所有的*事情*。

如果您打算使用 XUL 进行认真的开发，请准备好学习该框架，包括其实现细节。基本上，如果您使用的是 Firefox 不主动使用的组件，您*将*遇到需要自己解决的问题。

该框架是开源和自由许可的，允许您对其进行修补并在应用程序中使用修补的运行时。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-11-05T15:45:44.703

XUL 只是更大的“Mozilla 应用程序框架”的一部分。要充分利用这个出色的 x-paltform 开发环境，需要学习很多概念性的东西。就像之前的海报所说，好的文档很难梳理。

我建议你阅读 McFarlane 的书，这里有一个在线版本......

[http://mb.eschew.org/](http://mb.eschew.org/)

它提供了非常彻底的处理——因此您可以像理解平台一样编写代码，而不是像从网络上积累黑客一样。您可以做的另一件事是下载编写良好的基于​​ Mozilla 的开源应用程序，例如 Komodo Edit 和 Songbird，然后浏览它们的 chrome 目录。通过查看工作中的 XUL 专家，您将节省大量时间。

话虽如此，我在商业开发方面遇到的一个主要限制是 XUL 的设计要求您使用 JavaScript 编写大量客户端代码。这意味着您的客户（和竞争对手）最终会得到很多您的源代码。解决这个问题的明显方法是使用另一种语言编写“核心”专有东西代码，并通过 XPCOM 将其绑定到 JS。我听说过的另一种方法（我还没有尝试过）是使用 mozilla 的 JSXDRAPI 将 JS 编译为字节码。Firefox 本身在内部执行此操作以缓存 XUL/JS 文件。不过，我还没有遇到让 xulrunner 识别已编译的 .JSC 文件的人。

埃德蒙·贝古米萨。

# iphone - 使 UIView 的背景成为没有子类的渐变

> ID：844710
> 
> 赞同：27
> 
> 时间：2009-05-10T04:55:27.383
> 
> 标签：iphone, uiview, subclass

有没有办法使 UIView 的背景成为渐变而不继承它？我也不想使用图像文件来完成此操作。仅仅为了为背景绘制渐变就必须继承 UIView 似乎很迟钝。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-05-10T06:04:33.770

您可以使用`+[UIColor colorWithPatternImage:]`来生成带图案的背景。示例（带上你自己的 CGGradient）：

```
// Allocate color space
CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();
// Allocate bitmap context
CGContextRef bitmapContext = CGBitmapContextCreate(NULL, 320, 480, 8, 4 * 320, colorSpace, kCGImageAlphaNoneSkipFirst);
//allocate myGradient
CGFloat locationList[]  = {0.0f, 1.0f};
CGFloat colorList[]     = {0.0f, 0.0f, 0.0f, 1.0f, 0.0f, 0.0f, 0.0f, 0.0f};
CGGradientRef myGradient   = CGGradientCreateWithColorComponents(colorSpace, colorList, locationList, 2);
// Draw Gradient Here
CGContextDrawLinearGradient(bitmapContext, myGradient, CGPointMake(0.0f, 0.0f), CGPointMake(320.0f, 480.0f), 0);
// Create a CGImage from context
CGImageRef cgImage = CGBitmapContextCreateImage(bitmapContext);
// Create a UIImage from CGImage
UIImage *uiImage = [UIImage imageWithCGImage:cgImage];
// Release the CGImage
CGImageRelease(cgImage);
// Release the bitmap context
CGContextRelease(bitmapContext);
// Release the color space
CGColorSpaceRelease(colorSpace);
// Create the patterned UIColor and set as background color
[targetView setBackgroundColor:[UIColor colorWithPatternImage:image]]; 
```

不过，创建一个子类可能会更简单`UIView`。它也将使用更少的内存。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2014-01-19T03:12:07.730

你可以这样做：

**斯威夫特 >= 4.0：**

```
let gradient = CAGradientLayer()
gradient.frame = view.bounds
gradient.colors = [UIColor.red.cgColor, UIColor.white.cgColor]
view.layer.insertSublayer(gradient, at: 0) 
```

**斯威夫特 3.0：**

```
let gradient = CAGradientLayer()
gradient.frame = view.bounds
gradient.colors = [UIColor.red().cgColor, UIColor.white().cgColor]
view.layer.insertSublayer(gradient, at: 0) 
```

**斯威夫特 <= 2.3：**

```
let gradient = CAGradientLayer()
gradient.frame = view.bounds
gradient.colors = [UIColor.redColor().CGColor, UIColor.whiteColor().CGColor]
view.layer.insertSublayer(gradient, atIndex: 0) 
```

**目标-C：**

```
CAGradientLayer *gradient = [CAGradientLayer layer];
gradient.frame = self.view.bounds;
gradient.colors = [NSArray arrayWithObjects:(id)[[UIColor redColor] CGColor], (id)[[UIColor whiteColor] CGColor], nil];
[self.view.layer insertSublayer:gradient atIndex:0]; 
```

确保将 QuartzCore 框架也添加到您的项目中（至少对于 Objective-C）...

```
#import <QuartzCore/QuartzCore.h> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-10T14:45:42.630

我同意 rpetrich，只做 UIView 子类会更干净。有关如何执行此操作的示例，请参阅[我在此问题中的回复](https://stackoverflow.com/questions/422066/gradients-on-uiview-and-uilabels-on-iphone/422208#422208)。如果你愿意，你可以创建一个通用的渐变 UIView 子类，然后简单地将它放在你想要渐变背景的视图后面。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-05T16:49:58.680

我将采用的答案更改为我的版本

```
+(void) setBlackGradientToView:(UIView*)targetView
{
    CGRect frame = targetView.frame;
    // Allocate color space
    CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();
    //allocate myGradient
    CGFloat locationList[]  = {0.0f, 1.0f};
    CGFloat colorList[]     = {0.0f, 0.0f, 0.0f, 1.0f, 0.0f, 0.0f, 0.0f, 0.0f};
    CGGradientRef myGradient   = CGGradientCreateWithColorComponents(colorSpace, colorList, locationList, 2);
    // Allocate bitmap context
    CGContextRef bitmapContext = CGBitmapContextCreate(NULL, frame.size.width, frame.size.height, 8, 4 * frame.size.width, colorSpace, kCGImageAlphaPremultipliedLast);
    //Draw Gradient Here
    CGContextDrawLinearGradient(bitmapContext, myGradient, CGPointMake(0.0f, 0.0f), CGPointMake(0, frame.size.height), 0);
    // Create a CGImage from context
    CGImageRef cgImage = CGBitmapContextCreateImage(bitmapContext);
    // Create a UIImage from CGImage
    UIImage *uiImage = [UIImage imageWithCGImage:cgImage];
    // Release the CGImage
    CGImageRelease(cgImage);
    // Release the bitmap context
    CGContextRelease(bitmapContext);
    // Release the color space
    CGColorSpaceRelease(colorSpace);

    //Create the patterned UIColor and set as background color
    [targetView setBackgroundColor:[UIColor colorWithPatternImage:uiImage]];
    //return uiImage;
} 
```

# javascript - 访问 cookie，希望在 JavaScript 中

> ID：844719
> 
> 赞同：3
> 
> 时间：2009-05-10T05:00:37.120
> 
> 标签：javascript, cookies, xul, add-on

我正在开发一个 Firefox 附加组件，该附加组件将允许用户（所有这些用户都是特定组的一部分；此附加组件的受众范围非常有限）从状态栏中查看其身份验证 cookie 的状态。我们都必须进行身份验证才能访问与工作相关的网站，但是当 cookie 过期时我们不会收到任何警告，因此这会导致工作流程中烦人甚至有时是剧烈的中断。最终，这个附加组件将允许我们从状态栏中提交我们的凭据，而无需进行任何重新加载或重定向，但现在，我只想看到它显示状态。

我一直在 nsICookie、nsICookie2、nsICookieManager 等上查看 Mozilla 开发人员页面，但并不清楚其中任何一个如何适合 JavaScript 或 XUL 或其他任何东西。

理想情况下，我只想让 JavaScript 走出文档并获取我指定的域的 cookie 字符串。如果我能做到这一点，它将允许代码可能被移植到其他浏览器（特别是 Safari 和 Chrome）。但是，如果这必须是特定于浏览器的，那么我至少想知道在没有任何设置或删除的花里胡哨的情况下检查 cookie 是否存在于 Firefox 中的方法。

简单地说，我想用一种方式说：

```
 if (cookieExists("sample.com", CookieName)) {
     alert("You're signed in!");
 } else {
     alert('Go sign in, you fool!');
 } 
```

这样做的最简单/最便携的方法是什么（当然是浏览器端）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-10T12:03:19.997

> 我一直在查看 nsICookie、nsICookie2、nsICookieManager 等的 Mozilla 开发人员页面，但并不清楚它如何适合 javascript 或 XUL 或其他任何东西。

可以从 Firefox 扩展访问所有 cookie，并使用 nsICookieManager 和 nsICookie 接口。从您的扩展程序中的 javascript 代码，您可以访问 cookie 管理器

```
var cookieManager = Components.classes["@mozilla.org/cookiemanager;1"].getService(Components.interfaces.nsICookieManager); 
```

并且您可以遍历所有存储的 cookie

```
var enum = cookieManager.enumerator;
while (enum.hasMoreElements()){
   var cookie = enum.getNext();
   if (cookie instanceof Components.interfaces.nsICookie){
      // commands
   }
} 
```

现在，当引用 cookie 对象时，您可以检查其属性

```
cookie.host
cookie.name
cookie.value
... 
```

在[nsICookie](https://developer.mozilla.org/en/nsICookie)接口中定义。此代码是 Firefox 特定的，可以作为浏览器扩展或[签名脚本](http://www.mozilla.org/projects/security/components/signed-scripts.html)运行。希望我的解释有点帮助。

下面我介绍一些在扩展中使用 JS XPCOM 接口的链接：

1.  [JS XPCOM](https://developer.mozilla.org/en/Code_snippets/JS_XPCOM)
2.  [使用 cookie](https://developer.mozilla.org/en/XUL_Tutorial/XPCOM_Examples#Cookies)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-10T05:05:13.270

您可以使用 jquery 插件进行 cookie 处理

[http://www.stilbuero.de/2006/09/17/cookie-plugin-for-jquery/](http://www.stilbuero.de/2006/09/17/cookie-plugin-for-jquery/)

或者简单地通过javascript： [http ://www.quirksmode.org/js/cookies.html](http://www.quirksmode.org/js/cookies.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-10T05:05:29.777

**[这是在 javascript 中使用 cookie](http://www.ajaxtutorial.net/index.php/2006/03/15/javascript-cookies/)**的一个很好的教程。使用该教程中的函数，您可能可以执行以下操作：

```
if readCookie(yourCookieName != "") {
      alert("You're signed in!");
 else {
      alert("Go sign in, you fool!");
} 
```

**以下是cookie函数：**

```
function readCookie(name) {
  var ca = document.cookie.split(';');
  var nameEQ = name + "=";
  for(var i=0; i < ca.length; i++) {
    var c = ca[i];
    while (c.charAt(0)==' ') c = c.substring(1, c.length); //delete spaces
    if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);
    }
  return "";
}

function createCookie(name, value, days) {
  if (days) {
    var date = new Date();
    date.setTime(date.getTime()+(days*24*60*60*1000));
    var expires = "; expires="+date.toGMTString();
    }
  else var expires = "";
  document.cookie = name+"="+value+expires+"; path=/";
}

function eraseCookie(name) {
  createCookie(name, "", -1);
} 
```

# php - PHP：找不到语法错误

> ID：844722
> 
> 赞同：2
> 
> 时间：2009-05-10T05:01:52.593
> 
> 标签：php, mysql, parsing

> 解析错误：语法错误，blah/blah/blah.php 第 1 行中的意外 $end

这是我收到的错误，带有此代码

```
<?php 
include("db.php");

if (isset($_POST['username']) && 
    isset($_POST['password']) && 
    isset($_POST['email']))
{
  //Prevent SQL injections
  $username = mysql_real_escape_string($_POST['username']);
  $email = mysql_real_escape_string($_POST['email']);

  //Get MD5 hash of password
  $password = md5($_POST['password']);

  //Check to see if username exists
  $sql = mysql_query("SELECT username FROM usersystem WHERE username = 'username'");

  if (mysql_num_rows($s > 0))
  {
    die ("Username taken.");
  }

  mysql_query("INSERT INTO usersystem (username, password, email) VALUES ( '$username', '$password', '$email')") 
    or die (mysql_error()); echo "Account created.";
}
?> 
```

我已经检查了未闭合的括号，这不是问题。同样通过对其进行故障排除，我发现 include("db.php"); 导致问题。当我将其注释掉时，它会很好地加载页面。然而，即使 db.php 完全空白，只是一个空的 .php 文件，它仍然给我同样的错误。我很困惑。有人有想法么？

这是我的 db.php 文件，但老实说，当我使 db.php 完全空白时，我得到了同样的错误。我正在正确保存它。

```
<?php
session_start();
mysql_connect("localhost", "mydatabase", "mypassword");
mysql_select_db("ratherda_jetpackfandango");

function user_login ($username, $password)
{
  //take the username and prevent SQL injections
  //$username = mysql_real_escape_string($username);

  //begin the query
  $sql = mysql_query("SELECT * FROM user WHERE username = 'username' AND password = 'password' LIMIT 1");

  //check to see how many rows were returned
  $rows = mysql_num_rows($sql);

  if ($rows<=0 )
  {
    echo "Incorrect username/password";
  }
  else
  {
    //have them logged in
    $_SESSION['username'] = $username;
  }    
}
?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-10T08:24:40.560

您在 db.php 中有一个[session_start](http://nl3.php.net/function.session-start)是不允许的。它应该是 blah.php 中的第一行。

```
<?php

session_start();

require_once("db.php"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-10T05:08:25.667

发布您的 db.php 文件，问题显然就在那里。意外的 $end 错误通常是由于缺少大括号造成的，因此请检查该文件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-11T04:31:12.020

> if (mysql_num_rows($s > 0))

到

> 如果 (mysql_num_rows($s) > 0)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-10T05:12:48.057

在 php`$end`中，错误通常意味着`}`某处缺少大括号。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-10T07:57:21.860

也许您的`blah.php`文件是从另一个`blahblah.php`文件中包含的，并且错误在那里？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-10T08:09:11.363

您确定包含在内的是您的 db.php 吗？可能是您的 php-paths 中某处的另一个 db.php 被包含在内吗？检查这一点的一种方法是将文件重命名为更独特的名称。

# c# - 用于 .NET 的强大且友好的命令行工具？

> ID：844723
> 
> 赞同：7
> 
> 时间：2009-05-10T05:01:55.400
> 
> 标签：c#, .net, vb.net, command-line, mono

忘记花哨的网络东西。我正在寻找一个好的 .NET CLI 参数处理实用程序，更喜欢开源代码。这适用于需要健壮和友好的命令行参数处理的快速而肮脏的实用程序。

这些是实用程序，可能需要一天的努力。花几天时间编写好的命令行处理似乎有点过头了……但他们确实需要它。

我喜欢命令行处理程序的功能。我会对任何具有以下 2 或 3 项的开源项目感到兴奋。

*   一个一致的语法， [posix 有一个很好的命令行标准](http://www.opengroup.org/onlinepubs/009695399/basedefs/xbd_chap12.html#tag_12_02)，但不一定是 posix。
*   能够为agruments 提供短名称。例如“msbuild /t”==“msbuild /target”
*   它*支持*良好的命令行解析，然后不碍事。我想要一些我的代码使用的东西，而不是在我的代码上强加模式的东西，例如，我不想用事件来响应 arg 的存在，那种类型的东西。
*   关注点分离已经足够好，它的逻辑可以进行单元测试。
*   哦 - 要求它从类属性中读取属性（如在 .NET 配置类中）有两个要求吗？
*   我喜欢 msbuild 中的配置文件覆盖。我可以在构建文件中设置属性，但在命令行上覆盖。
*   内置“显示用法”。[WSF](http://msdn.microsoft.com/en-us/library/15x4407c.aspx)文件 (csript.exe) 具有此功能。不过，我不愿意编写 jscript 来进行命令行处理。
*   不是powershell。我在公司中找不到任何人可以忍受 Powershell 语法。

PS如果我没有找到这样的东西，我可能会在接下来的几周内将一个放在谷歌代码上

PPS 如果我可以添加标签，我会标记这个“pleasesearchtheinternetforme”

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-10T05:19:08.450

*同样来自 codePlex，[CommandLine](http://commandline.codeplex.com/)项目似乎满足您的要求。项目主页中复制/粘贴的自由应用程序给出了......*

命令行解析器库为 CLR 应用程序提供了一个用于操作命令行输入的简单编程接口。该库允许您显示具有良好自定义程度的帮助屏幕。API 将所有无聊的代码都扛在肩上。

命令解析器库支持：

*   短选项（例如 -s）

    *   选项+值/无空格：-sHello
    *   选项+空格+值：-s 你好
*   短选项，例如开关；不需要值

    *   Option+空格+Option+....... -s -x -y -z
    *   选项+选项+选项+...：-sxyz...
    *   Option+Option+空格/任意组合：-sx -yz
*   长选项（例如--long）

    *   选项+相等+值：--long=你好
    *   Option+Space+Value: --long 你好
*   组合选项（关于值）

    *   任何 1;2;3;4（分隔符是可配置的）

共同特征

两者都接受带空格的值： -s"Hello World!" --long "你好 CLR！"

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-10T07:44:52.327

您应该查看 Mono.Options ( [http://www.ndesk.org/Options](http://www.ndesk.org/Options) )，因为它对跨平台更加友好，并且在 Mono 本身中广泛使用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-10T05:15:40.860

*从 CodePlex 来看，[ConsoleFX](http://consolefx.codeplex.com/)似乎可以满足您的要求。项目主页中复制/粘贴的自由应用程序给出了......*

ConsoleFx 是一个基于属性的 .NET/Mono 框架，用于轻松开发命令行界面 (CLI) 应用程序。它通过使用属性自动完成创建 CLI 应用程序所涉及的大部分工作，例如命令行参数解析、错误处理和验证。使用 ConsoleFx，您可以告别冗长繁琐的代码来解析您的命令行参数。

使用 ConsoleFx 命令行解析器，您可以以声明方式指定一系列用于指定命令行参数的条件。这些可以包括以下能力：

*   强制命令行参数的顺序
*   指定开关选项并限制它们作为命令行参数出现的次数
*   允许为开关选项指定参数，并限制可以指定的参数数量
*   指定非开关参数以及如何使用它们
*   对开关参数和非开关参数运行自定义验证，包括对正则表达式、文件掩码、整数、布尔值、枚举等的测试。
*   自动将非开关参数映射到强类型属性，以便于阅读
*   以声明方式执行 ConsoleFx 无法执行的自定义验证

ConsoleFx 还提供了用于控制台输出捕获和控制台类扩展的实用程序类。我们计划在未来添加其他实用程序类，使其成为创建命令行应用程序的一体化解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-10T05:18:25.690

成吉思 ( [http://www.sellsbrothers.com/tools/genghis/](http://www.sellsbrothers.com/tools/genghis/) ) 有一个。不过，不确定维护状态，它可能会带来比您想要的更多的行李。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-04-01T05:34:49.590

我创建了一个[命令行解析类](https://www.siepman.nl/blog/ultimate-command-line-arguments-parsing-query-with-linq)，它以友好的方式为您进行 oa (Linq) 解析。例如这个命令行：

```
-country=Sweden -IsNiceCountry   -Country="The Netherlands" /empty= /space=" " 
```

获取所有国家：

```
var parameters = new ParametersParser();
parameters.GetParameters("-country") 
```

带空字符串的参数：

```
parameters.GetFirstValue("/Empty") 
```

键没有值：

```
parameters.HasKeyAndNoValue("-IsNiceCountry") 
```

密钥不存在（返回 false）：

```
parameters.HasKey("/notExist") 
```

还有很多...

# .net - .net 3.5 SDK 在哪里？

> ID：844725
> 
> 赞同：23
> 
> 时间：2009-05-10T05:03:34.023
> 
> 标签：.net, .net-3.5, sdk

谁能提供下载.net 3.5 SDK的链接？我检查了 MS 网站和谷歌，但找不到下载链接。

谢谢...

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2018-01-10T20:32:05.767

**2020 年更新：** 我可以确认此选项在 VS 2019 中仍然有效（至少企业版和专业版） [![在此处输入图像描述](https://i.stack.imgur.com/9minq.png)](https://i.stack.imgur.com/9minq.png)

在 VS2017 工具菜单 >> 获取工具和功能...

然后在 VS Installer 窗口中选择“Individual Components”选项卡并确保选中并安装了“.NET Framework 3.5 development tools”

[![在此处输入图像描述](https://i.stack.imgur.com/EzsAx.jpg)](https://i.stack.imgur.com/EzsAx.jpg)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-10T10:00:04.653

上面的链接很好，这里的链接包含指向每个基于 Microsoft 的 SDK 的链接。它保持最新。

[http://msdn.microsoft.com/en-us/dd299405.aspx](http://msdn.microsoft.com/en-us/dd299405.aspx)

编辑如果你是最前沿的。意思是想开始为 Win 7, server 2008 r2 中的功能编程。这将是与最新和最伟大的链接。在 RC 级别。（虽然 Win 7 是随 .net 3.5 sp1 一起发布的）

[http://www.microsoft.com/downloads/details.aspx?FamilyID=6db1f17f-5f1e-4e54-a331-c32285cdde0c&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyID=6db1f17f-5f1e-4e54-a331-c32285cdde0c&displaylang=en)

另外这个链接也不错。

[http://code.msdn.microsoft.com/WindowsAPICodePack](http://code.msdn.microsoft.com/WindowsAPICodePack)

包含 win 7 中大多数新功能的 .net 包装器。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-09-01T09:37:33.347

现在所有内容都从以下位置下载：[https](https://www.visualstudio.com/downloads/) : //www.visualstudio.com/downloads/ 向下滚动以*构建 Visual Studio 工具*，下载安装程序，选择*各个组件*并选择要安装的 dotnet 版本。完成后查找“VS 的开发命令提示符”，运行并开心。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-05-27T14:14:51.777

感谢@alftthan 和@Geordie 的回答。今天（05.2021。）这个程序影响了我的“VS Express 2013 for Desktop”:) 请按照以下步骤操作：

*   转到：[https ://visualstudio.microsoft.com/downloads/](https://visualstudio.microsoft.com/downloads/)
*   向下滚动到：Visual Studio 2019 工具，点击展开内容
*   单击并下载安装程序：Visual Studio 2019 的构建工具
*   运行下载的安装程序，点击“Individual components”，勾选`CheckBox`“.NET Framework 3.5 development tools”。
*   确认更新。等待安装过程，然后**重新启动**Win。

问候。

* * *

## 回答 #5

> 赞同：-6
> 
> 时间：2011-05-02T08:29:44.763

就这个。只是 .NET 3.5 sdk，没有别的：

[http://www.microsoft.com/downloads/en/details.aspx?FamilyId=333325FD-AE52-4E35-B531-508D977D32A6&displaylang=en](http://www.microsoft.com/downloads/en/details.aspx?FamilyId=333325FD-AE52-4E35-B531-508D977D32A6&displaylang=en)

# f# - 为什么 F# 的类型推断不能处理这个？

> ID：844733
> 
> 赞同：13
> 
> 时间：2009-05-10T05:07:34.297
> 
> 标签：f#, type-inference

我有一个 FileInfo 序列，但我只关心它们的字符串名称，所以我想要一个字符串序列。起初我尝试过这样的事情：

```
Seq.map (fun fi -> fi.Name) fis 
```

但由于某种原因，F# 的类型推断不足以允许这样做，并让我明确地给“fi”一个类型：

```
Seq.map (fun (fi : FileInfo) -> fi.Name) fis 
```

为什么需要这个注释？如果知道那个`fis : seq<FileInfo>`和那个`Seq.map : ('a -> 'b) -> seq<'a> -> seq<'b>`，那么它不应该推断出 lambda 表达式的类型是`FileInfo -> 'b`，然后从`fi.Name : string`进一步推断出它的类型是`FileInfo -> string`吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-10T05:21:12.187

类型推断从左到右工作。这是管道操作符有用的地方；如果您已经知道“fis”的类型，则将其写为

```
fis |> Seq.map (fun fi -> fi.Name) 
```

推理对你有用。

（一般来说，形式的表达

```
o.Property
o.Method args 
```

要求*先验*地知道“o”的类型；对于大多数其他表达式，当没有固定类型时，推理系统可以“浮动约束”，稍后可以解决，但对于这些情况，没有“所有类型具有名为 P 的属性”形式的约束或'所有具有名为 M 的方法的类型'（如鸭子类型），可以推迟并在以后解决。所以你现在需要这些信息，否则推理会立即失败。）

另请参阅[F# 中类型推断的概述](http://lorgonblog.spaces.live.com/blog/cns!701679AD17B6D310!1526.entry)。

# python - 在 django 模板中执行 getattr() 样式查找

> ID：844746
> 
> 赞同：50
> 
> 时间：2009-05-10T05:15:16.163
> 
> 标签：python, django, django-templates

当您事先不知道某个属性的名称时，Python 的 getattr() 方法很有用。

这个功能也可以在模板中派上用场，但我从来没有想出办法做到这一点。是否有可以执行动态属性查找的内置标签或非内置标签？

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2009-07-10T22:09:44.203

我最近还不得不将此代码编写为自定义模板标签。为了处理所有查找场景，它首先执行标准属性查找，然后尝试执行字典查找，然后尝试**getitem**查找（以使列表工作），然后在对象被查找时遵循标准 Django 模板行为未找到。

（2009 年 8 月 26 日更新，现在也可以处理列表索引查找）

```
# app/templatetags/getattribute.py

import re
from django import template
from django.conf import settings

numeric_test = re.compile("^\d+$")
register = template.Library()

def getattribute(value, arg):
    """Gets an attribute of an object dynamically from a string name"""

    if hasattr(value, str(arg)):
        return getattr(value, arg)
    elif hasattr(value, 'has_key') and value.has_key(arg):
        return value[arg]
    elif numeric_test.match(str(arg)) and len(value) > int(arg):
        return value[int(arg)]
    else:
        return settings.TEMPLATE_STRING_IF_INVALID

register.filter('getattribute', getattribute) 
```

模板使用：

```
{% load getattribute %}
{{ object|getattribute:dynamic_string_var }} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-10T05:35:31.047

我不这么认为。[但是编写自定义模板标签](http://docs.djangoproject.com/en/dev/howto/custom-template-tags/)以在上下文字典中返回属性并不难。如果您只是想返回一个字符串，请尝试以下操作：

```
class GetAttrNode(template.Node):
    def __init__(self, attr_name):
        self.attr_name = attr_name

    def render(self, context):
        try:
            return context[self.attr_name]
        except:
            # (better yet, return an exception here)
            return ''

@register.tag
def get_attr(parser, token):
    return GetAttrNode(token) 
```

请注意，在您的视图中而不是在模板中执行此操作可能同样容易，除非这是在您的数据中经常重复的条件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-10T06:32:43.590

我最终向有问题的模型添加了一个方法，并且可以像模板中的属性一样访问该方法。

尽管如此，我认为如果内置标签允许您动态查找属性会很棒，因为这是我们很多人在模板中经常遇到的问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-03-19T22:01:55.890

保持 get 和 getattr 之间的区别，

```
@register.filter(name='get')
def get(o, index):
    try:
        return o[index]
    except:
        return settings.TEMPLATE_STRING_IF_INVALID

@register.filter(name='getattr')
def getattrfilter(o, attr):
    try:
        return getattr(o, attr)
    except:
        return settings.TEMPLATE_STRING_IF_INVALID 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-10T05:29:51.060

没有内置标签，但[编写自己的](http://docs.djangoproject.com/en/dev/howto/custom-template-tags/#howto-custom-template-tags).

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-01-15T13:03:27.023

该片段节省了我的时间，但我需要它来跨越关系，所以我将其更改为将 arg 拆分为“。” 并递归获取值。它可以在一行中完成： `return getattribute(getattribute(value,str(arg).split(".")[0]),".".join(str(arg).split(".")[1:]))` 但为了便于阅读，我将其保留为 4。我希望有人对此有用。

```
import re
from django import template
from django.conf import settings

numeric_test = re.compile("^\d+$")
register = template.Library()

def getattribute(value, arg):
"""Gets an attribute of an object dynamically AND recursively from a string name"""
    if "." in str(arg):
        firstarg = str(arg).split(".")[0]
        value = getattribute(value,firstarg)
        arg = ".".join(str(arg).split(".")[1:])
        return getattribute(value,arg)
    if hasattr(value, str(arg)):
        return getattr(value, arg)
    elif hasattr(value, 'has_key') and value.has_key(arg):
        return value[arg]
    elif numeric_test.match(str(arg)) and len(value) > int(arg):
        return value[int(arg)]
    else:
        #return settings.TEMPLATE_STRING_IF_INVALID
        return 'no attr.' + str(arg) + 'for:' + str(value)

register.filter('getattribute', getattribute) 
```

# c# - 如何将本机应用程序与 eclipse 集成？

> ID：844751
> 
> 赞同：2
> 
> 时间：2009-05-10T05:19:15.110
> 
> 标签：c#, c++, eclipse, integration

我有几个用 C++ 和 C# 编写的本机应用程序。这些是需要在它们之间共享数据的遗留应用程序。目前，数据共享是通过以某种专有格式导入/导出文本文件。我们目前正在考虑使用 eclipse 集成这两个应用程序。我的问题是：

1.  我们如何将原生应用程序（例如基于 c++ 和 c# 的应用程序）集成到 eclipse 中？
2.  eclipse为原生应用提供了哪些数据集成方式？
3.  eclipse是这种用途的最佳选择吗？

此外，如果您能分享您在 eclipse 中集成原生应用程序的经验，这将非常有帮助。

我特别关注将本机应用程序集成到 eclipse 中，就像我们集成用 Java 编写的 eclipse 插件一样。例如，在 Java 中编写一个包装器插件需要什么，它将通过使用可以集成到 eclipse 中的 JNI 调用来包装一个本机工具，就像任何其他 eclipse 插件一样？这是集成本机应用程序的首选方法，还是用 Java 重写我的旧本机应用程序是个好主意？

我不打算使用“外部工具”配置将 eclipse 用作我的本机应用程序的启动板。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-08T18:49:37.763

如果您可以围绕您的 C++/C# 应用程序编写 JNI 包装器，那么您可以从 Eclipse 插件中使用它们。

最简单的方法是：

1.  将您的 C++/C# 应用程序重新打包为 DLL（如果还没有的话）
2.  用 JNI 层包装它们
3.  将 DLL 放在插件的根文件夹中
4.  从 JNI 包装类中的静态初始化程序块调用 System.LoadLibrary() 以加载所需的 DLL

您可能会发现 Eclipse 新闻组上题为[在 Eclipse 插件中使用 DLL](http://dev.eclipse.org/newslists/news.eclipse.platform/msg76216.html)的讨论很有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-10T05:34:50.813

这里没有关于 Eclipse 的固有特性（这并不是说您不能将它用作 IDE）。基本上，您应该查看[P/Invoke](http://en.wikipedia.org/wiki/P/Invoke)、[COM Interop](http://msdn.microsoft.com/en-us/library/kew41ycz(VS.71).aspx)和 MSDN 关于[Managed-Unmanaged Interoperability](http://msdn.microsoft.com/en-us/library/sd10k43k.aspx)的（大量）部分。虽然您可以将双方与 Java/ [SWT](http://www.eclipse.org/swt/)集成，并将其用作中间人，但我认为这没有多大意义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-11T21:34:13.250

如果您只想从 Eclipse 内部运行应用程序，请使用[外部工具](http://help.eclipse.org/stable/index.jsp?topic=/org.eclipse.platform.doc.user/concepts/concepts-exttools.htm)基础架构。

如果没有，请提供有关您寻求的集成的更多详细信息。

# c++ - 带有链表的哈希表中的前 10 个频率

> ID：844753
> 
> 赞同：3
> 
> 时间：2009-05-10T05:19:41.427
> 
> 标签：c++, pointers, loops, hashtable, linked-list

下面的代码将打印它在我的哈希表（其中是一堆链表）中可以找到的最高频率 10 次。我需要我的代码来打印我的哈希表中的前 10 个频率。我不知道该怎么做（代码示例会很棒，简单的英语逻辑/伪代码也很棒）。

1.  我创建了一个名为“tmp”的临时哈希列表，它指向我的哈希表“hashtable”
2.  然后一个 while 循环遍历列表并查找最高频率，即 int 'tmp->freq'
3.  循环将继续使用变量“topfreq”复制它找到的最高频率的过程，直到它到达哈希表上链表的末尾。

我的“节点”是一个由变量“freq”（int）和“word”（128 个字符）组成的结构。当循环没有其他内容可搜索时，它会在屏幕上打印这两个值。

问题是，我无法弄清楚如何从我刚刚找到的数字中找到下一个最小的数字（这可能包括另一个具有相同频率值的节点，所以我必须检查这个词也不一样）。

```
void toptenwords()
{
    int topfreq = 0;
    int minfreq = 0;
    char topword[SIZEOFWORD];

    for(int p = 0; p < 10; p++) // We need the top 10 frequencies... so we do this 10 times
    {
        for(int m = 0; m < HASHTABLESIZE; m++) // Go through the entire hast table
        {
            node* tmp;
            tmp = hashtable[m];

            while(tmp != NULL) // Walk through the entire linked list
            {
                if(tmp->freq > topfreq) // If the freqency on hand is larger that the one found, store...
                {
                    topfreq = tmp->freq;
                    strcpy(topword, tmp->word);
                }
                tmp = tmp->next;
            }
        }
        cout << topfreq << "\t" << topword << endl;
    }
} 
```

任何和所有的帮助将不胜感激:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-10T06:26:52.577

保留一个包含 10 个节点指针的数组，并将每个节点插入到数组中，保持数组有序。数组中的第十一个节点在每次迭代时都会被覆盖，并且包含垃圾。

```
void toptenwords()
{
        int topfreq = 0;
        int minfreq = 0;
        node *topwords[11];
        int current_topwords = 0;

        for(int m = 0; m < HASHTABLESIZE; m++) // Go through the entire hast table
        {
                node* tmp;
                tmp = hashtable[m];

                while(tmp != NULL) // Walk through the entire linked list
                {
                        topwords[current_topwords] = tmp;
                        current_topwords++;
                        for(int i = current_topwords - 1; i > 0; i--)
                        {
                                if(topwords[i]->freq > topwords[i - 1]->freq)
                                {
                                        node *temp = topwords[i - 1];
                                        topwords[i - 1] = topwords[i];
                                        topwords[i] = temp;
                                }
                                else break;
                        }
                        if(current_topwords > 10) current_topwords = 10;
                        tmp = tmp->next;
                }
        }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-10T08:35:35.747

第 1 步（低效）：

通过插入排序将向量移动到已排序的容器中，但插入到大小为 10 的容器（例如链表或向量）中，并删除掉出列表底部的所有元素。

第 2 步（高效）：

与步骤 1 相同，但要跟踪列表底部项目的大小，如果当前项目太小，则完全跳过插入步骤。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-10T09:37:19.607

如果目标是累积词频，则包含单词链接列表的哈希表似乎是一种特殊的数据结构。

尽管如此，获得十个最高频率节点的有效方法是将每个节点插入优先级队列/堆，例如斐波那契堆，其插入时间为 O(1)，删除时间为 O(n)。假设哈希表迭代很快，这个方法的运行时间是 O(n×O(1) + 10×O(n)) ≡ O(n)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-10T10:08:14.870

假设总共有*n 个*词，我们需要出现频率最高的*k*个词（这里，*k* = 10）。

如果*n*远大于*k*，我所知道的最有效的方法是维护一个最小堆（即顶部元素具有堆中所有元素的*最小*频率）。在每次迭代中，将下一个频率插入堆中，如果堆现在包含*k* +1 个元素，则*删除**最小*的. 这样，堆始终保持在*k*个元素的大小，在任何时候都包含迄今为止看到的*k个最高频率元素。*在处理结束时，按递增顺序读出*k*个最高频率元素。

**时间复杂度：**对于*n 个*单词中的每一个，我们做两件事：插入到一个大小为*k*的堆中，并删除最小元素。每个操作花费 O(log k) 时间，因此整个循环花费 O(nlog k) 时间。最后，我们从一个大小最多为*k*的堆中读出*k*个元素，耗时 O(klog k)，总时间为 O((n+k)log k)。由于我们知道*k* < *n*，O(klog k) 最坏的情况是 O(nlog k)，所以这可以简化为 O(nlog k)。

 **** * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-15T20:17:41.997

绝对*最快*的方法是使用 SoftHeap。使用 SoftHeap，您可以在 O(n) 时间内找到前 10 个项目，而此处发布的所有其他解决方案都需要 O(n lg n) 时间。

[http://en.wikipedia.org/wiki/Soft_heap](http://en.wikipedia.org/wiki/Soft_heap)

这篇维基百科文章展示了如何使用软堆在 O(n) 时间内找到中位数，前 10 名只是中位数问题的一个子集。然后，如果您需要按顺序排列前 10 个项目，您可以对它们进行排序，并且由于您总是最多对 10 个项目进行排序，因此仍然是 O(n) 时间。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-10T05:33:41.020

我将维护一组已使用的单词并更改最里面的 if 条件以测试频率是否大于先前的最高频率和 tmp->word 不在已使用的单词列表中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-10T05:41:44.417

当遍历哈希表（然后遍历其中包含的每个链表）时，保持一个自平衡二叉树（std::set）作为“结果”列表。当您遇到每个频率时，将其插入到列表中，如果列表中的条目超过 10 个，则将其截断。完成后，您将获得一组（排序列表）前十个频率，您可以根据需要对其进行操作。

在哈希表本身中使用集合而不是链表可能会获得性能提升，但您可以自己解决。

# eclipse - 日食在构建工作区时卡住

> ID：844759
> 
> 赞同：127
> 
> 时间：2009-05-10T05:24:54.830
> 
> 标签：eclipse, build, windows-vista

我在 Vista 下使用 eclipse 3.4.1 Java EE。在构建我的工作区时，它似乎被卡住了。取消构建似乎也没有任何作用。

为什么会发生这种情况，我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：147
> 
> 时间：2009-12-10T19:49:07.953

我能够用以下方法解决这个问题：

首先，退出 Eclipse。然后暂时将以下`.projects`文件夹移动到安全位置：

```
mv .metadata\.plugins\org.eclipse.core.resources\.projects projects 
```

启动并退出 Eclipse，然后将`.projects`文件夹移回原来的位置：

```
mv projects .metadata\.plugins\org.eclipse.core.resources\.projects 
```

当然，使用风险自负。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-05-10T08:48:58.460

有时，使用“-clean”参数从命令行执行 eclipse 以强制执行它为工作区进行清理非常有帮助。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2015-06-20T19:38:56.593

eclipse -clean 没有用，但下面做了

```
eclipse -clean -clearPersistedState 
```

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2014-03-18T08:02:40.070

如果我通过 USB 调试 Android，Eclipse 经常冻结 44%。断开设备连接时，Eclipse 将启动。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2014-01-03T18:11:44.547

接受的答案使我能够重新启动 Eclipse，但项目似乎丢失了它们的元数据。（例如，所有 Git/Gradle/Spring 图标都从项目名称中消失了。）我有很多项目，我不想重新导入它们。

所以这就是在开普勒下对我有用的东西。YMMV，但我想记录下来以防万一它对某人有所帮助。

**步骤 1.**暂时将`.projects`文件移开：

```
$ cd .metadata/.plugins/org.eclipse.core.resources
$ mv .projects .projects.bak 
```

**步骤 2.**然后启动 Eclipse。元数据将丢失，但至少 Eclipse 启动时不会卡住。

**步骤 3.**关闭 Eclipse。

**步骤 4.**将`.projects.bak`文件恢复为其原始名称：

```
$ mv .projects.bak .projects 
```

**步骤 5.**重新启动 Eclipse。它可能会构建一些东西，但这次它应该通过。（至少它对我有用。）

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2014-11-25T18:29:07.833

**第1步：**

打开项目目录并编辑 .project 文件，删除以下行以禁用 java 脚本验证。

```
 <buildCommand>
      <name>org.eclipse.wst.jsdt.core.javascriptValidator</name>
      <arguments>
      </arguments>
    </buildCommand> 
```

保存存档。

**第2步：**

转到 Eclipse 安装目录并打开 eclipse.ini（或 sts.in，如果您有 STS），根据您计算机的 RAM 大小更改 xms 和 xmx 值。

```
-Xms512m
-Xmx1024m
-XX:MaxPermSize=256m 
```

或者：在windows中，进入桌面的eclipse快捷方式，右键->属性->添加以下内容：C:\software\eclipse\sts-3.6.2.RELEASE\STS.exe **-clean -Xms512m -Xmx1024m**

运行 Eclipse。

转到 Eclipse->windows->preference->Validation，启用暂停所有验证器。如果您不想执行验证器面板中给出的列表中列出的任何验证，请执行此操作。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2009-05-10T06:06:04.217

您可能想看看[如何报告死锁](http://wiki.eclipse.org/How_to_report_a_deadlock)。您可能还需要检查错误视图和/或错误日志 ([workspace]/.metadata/.log)。如果这没有帮助，您可能需要包含有关您已安装哪些插件以及您拥有哪些项目的更多信息。你能创建一个重现问题的最小工作空间吗？

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2015-01-13T08:12:57.183

当我一次打开太多 Maven 项目时，我遇到了这个问题。我倾向于做的是：

*   重启eclipse（有时我需要杀死eclipse）
*   立即禁用自动构建（项目>取消选中自动构建）
*   右键单击我想要重建的项目
*   关闭不相关的项目
*   重新启用自动构建

这使我的工作区中的案例能够在 99% 的情况下进行功能重建。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2014-09-22T16:35:46.447

我在 Eclipse Indigo 中遇到了类似的问题。我更改了 HeapSize 它开始正常工作。我刚刚添加了以下 eclipse.ini 文件 -vmargs -Xms1024m -Xmx1024m

增加VM大小后它工作正常

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2015-09-04T12:47:28.020

对我来说唯一的解决方案（Luna 4.4.1）是这样的：

转到 Project Properties > Builders，然后取消选中 Javascript Validator。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2011-05-10T08:41:37.167

我的 Eclipse 遇到了同样的问题，作为解决方案，我创建了新项目，手动将所有资源（使用 Windows 复制/粘贴）复制到新项目，删除了旧项目，仅此而已。

有时，这是由于不正确的系统关闭和 Eclipse 工作区开始面临类似问题而发生的。

希望它会奏效。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2012-01-18T09:38:02.120

使用 Eclipse-> Windows->Preferences 取消选择自动构建有助于解决此问题。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2015-03-01T20:59:49.343

删除一些 JDT 索引（在 .metadata.plugins\org.eclipse.jdt.core 中），尤其是大文件，通常可以解决或缓解我的问题。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2010-09-11T08:55:56.807

我只是有同样的问题。

通过使用任务管理器终止构建过程并在没有打开任何项目的情况下退出 Eclipse，我能够在不打开项目的情况下重新进入 Eclipse 并清理项目。然后我再次重新启动 Eclipse，加载我的项目，一切正常。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2012-10-17T16:40:07.133

我发现如果您使用包含大量图像数据的项目（例如专用图像项目）重建工作区，也可能会发生这种情况。最好将类似的东西放入自己的工作区，并将其与您处理的其他项目分开处理。

如果不能，则在清理和重建时不要清理该项目。仅在必要时重建。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2013-03-26T15:25:06.577

在我的情况下，导入下载的项目后出现问题 - 停留在 80% 的构建。通过将组的写入权限添加到项目文件（Ubuntu 12.04）来解决。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2013-10-29T14:36:18.530

就我而言，它有助于从 Windows 资源管理器 (Windows 8.0) 中的收藏夹中删除源文件夹。似乎构建实际上并没有卡住，而是在某种无限循环中触发（如此[处](https://bugs.eclipse.org/bugs/show_bug.cgi?id=342931)所述- 错误 342931）。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2014-01-28T12:40:02.410

有时，问题似乎可以通过杀死从项目文件夹中打开文件的其他程序来解决。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2014-03-13T13:27:53.953

查看登录`[workspace]/.metadata/.log`为我提供了有用的信息。结果发现`java.lang.OutOfMemoryError: PermGen space error`工作区构建会挂起。这可以在`eclipse.ini`或`sts.ini`（如果您使用 SpringSource Tool Suite）文件中进行编辑。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2015-03-31T12:05:15.833

当我尝试在我的项目中安装带有 bower 的 Angular.js 时，我遇到了同样的问题。我似乎 bower 有很多它自动下载的 javascript 文件，这导致我的 IDE 在验证过程中停留了很长时间。所以，我用这种方式解决了这个问题，

*   我首先安装了 tern.js 0.9.0。
*   然后我转到项目属性，选择的 tern 脚本路径仅包含我需要验证的路径，即我的项目的 javascript 文件夹。我排除了其他路径，如占位符、Angular.js 文件、Jquery 文件。
*   我再次从属性中选择了 Javascript，并在包含路径的源代码中做了同样的事情。

我的 IDE 目前可以在没有冻结的情况下工作。我从那里得到帮助。[Tern](https://github.com/angelozerr/tern.java/wiki/Tern-Performance) 我想这可能会有所帮助，因为任何 IDE 由于大量 Javascript 文件而卡住。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2016-07-07T17:57:47.327

我尝试了很多这些建议，但最终对我有用的唯一方法是创建一个新的工作区，并将我的所有项目重新检出到该文件夹​​中。然后它工作正常;-)

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2016-10-17T14:15:52.340

我刚刚重新启动了eclipse，下次它就开始工作了。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2017-01-13T06:53:41.923

刷新您要构建的所有项目。工作过

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2017-05-10T10:27:58.583

重启日食。
它对我有用几次。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2017-10-25T15:36:32.980

我能够通过删除 Eclipse 在我的 eclipse 安装文件夹中创建的额外文件夹来解决这个问题。我没有安装，我正在使用 Ecilpse Neon 3 并安装了 Spring Tool 套件。但是，当我查看提取的 eclipse 安装时，我有 C: 文件夹，它有一些文件夹结构。这是我的下载文件夹的镜像。我删除它并重新启动。

它对我有用！

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2018-03-21T15:48:35.343

这里没有一个答案对我有用。有效的是删除以下文件夹

> C:\Users\你的用户名\workspace\project name.metadata.plugins\org.eclipse.core.resources.projects\project name\.indexes

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2018-07-20T15:05:50.177

我没有调试并找到确切的根本原因，而是删除了项目和元数据文件夹。Eclipse 将在下次启动时重建 .metadata 文件。

然后我拉入了最新的项目代码，问题就解决了。这是更多的工作，因为我必须重新配置所有东西，包括我的服务器，但是构建工作空间在完全完成之前的 3 到 5 分钟内一直停止在 50%，因此值得付出努力。

另外，我发现对于 Eclipse，如果您在构建工作区完成之前停止构建工作区并在 Eclipse 挂起所有内容时关闭它，您真的会弄乱您的配置并浪费大量时间试图使其再次稳定。我正在使用 Eclipse Oxygen，但是在我使用的所有 Eclipse 版本中都发生过这种情况，所以如果可能的话，我真的尽量避免它。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2019-06-07T11:21:14.120

在项目文件夹中打开 .project 文件。有一个错误的条目，它可能会有所帮助

```
 <buildCommand>
        <name>org.eclipse.m2e.core.maven2Builder</name>
        <arguments>
        </arguments>
    </buildCommand> 
```

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2020-05-16T08:44:04.017

如果您使用 Maven 作为构建工具，您可能希望：

1.  关闭日食

2.  删除位于***.m2/repository/***中的依赖目录 - 在 Linux 中它位于*主*目录下，在 Windows 中它应该位于*c:\Users<YourUsername>.m2*中（将 '' 替换为您的用户名）

3.  启动 Eclipse 并享受正常的工作 :)

这帮助我解决了这个问题，我希望它也能帮助你。:)
干杯！

**PS**我已经编辑了我的答案（如*@howlger 所*问），还建议删除**.eclipse**和**.p2**文件夹，因为它可能会造成伤害（**尽管**在我的情况下没有+我必须重新安装一些插件使用）。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2020-10-03T09:34:22.367

如果在构建项目时启动时出现问题，请从菜单中自动禁用构建。项目 -> 自动构建。这解决了我的问题，而更复杂的解决方案却无法解决。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2021-03-15T14:38:06.130

如果您有一个空`java`文件，该文件的命名和类路径与另一个`java`文件完全相同（这可能在解决移动资源的合并冲突时发生），也会发生这种情况。

* * *

例如，以下设置会在多 Maven 模块中导致此问题：

*   `module1/src/main/java/com/package/MyClass.java`（空的）
*   `module2/src/main/java/com/package/MyClass.java`（实际有效类）

要修复，只需删除空的 java 文件。

# regex - 用于在文件中添加内容的 unix 正则表达式

> ID：844762
> 
> 赞同：1
> 
> 时间：2009-05-10T05:29:13.243
> 
> 标签：regex, unix, command

我在文件中有内容

像

```
asdfb ... 1
adfsdf ... 2
sdfdf ..   3 
```

我想编写一个应该能够添加 1 + 2 + 3 并给出结果为 6 的 unix 命令

据我所知，grep 和 awk 会很方便，任何指针都会有所帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-10T05:40:34.573

我相信以下是您正在寻找的。它将汇总从标准输入读取的数据的每条记录中的最后一个字段。

```
awk '{ sum += $NF } END { print sum }' < file.txt 
```

需要注意的一些事项：

1.  使用 awk 你不需要声明变量，它们是通过为它们赋值来实现的。
2.  变量`NF`是当前记录中的字段数。通过在它前面加上 $ 我们将它的值视为一个变量。至少这是它的工作方式:)
3.  该`END { }`块仅在所有记录都已被其他块处理后才出现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-10T05:36:10.153

`awk`您只需要一个脚本，因为它具有`grep`作为语言的一部分内置的功能。

假设您的实际文件包括：

```
asdfb zz 1
adfsdf yyy 2
sdfdf xx   3 
```

你想对第三列求和。您可以使用：

```
echo 'asdfb zz 1
adfsdf yyy 2
sdfdf xx   3' | awk '
    BEGIN {s=0;}
          {s = s + $3;}
    END   {print s;}' 
```

BEGIN 子句在处理任何行之前运行，END 子句在处理所有行之后运行。

另一个子句发生在每一行，但您可以添加更多子句来根据各种事物（`grep`-py 事物）更改行为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-10T05:35:56.287

这可能不是您正在寻找的，但我编写了一个快速的 Ruby 脚本来实现您的目标：

```
#!/usr/bin/env ruby

total = 0
while gets
    total += $1.to_i if $_ =~ /([0-9]+)$/
end
puts total 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-10T05:49:18.937

这是 Perl 中的一个。

```
$ cat foo.txt
asdfb ... 1
adfsdf ... 2
sdfdf ..   3

$ perl -a -n -E '$total += $F[2]; END { say $total }' foo
6 
```

[打高尔夫球的](http://en.wikipedia.org/wiki/Perl_golf)版本：

```
perl -anE'END{say$n}$n+=$F[2]' foo
6 
```

# macos - 如何为 Safari 开发插件？

> ID：844765
> 
> 赞同：0
> 
> 时间：2009-05-10T05:30:20.497
> 
> 标签：macos, safari, add-on

每当我在 Safari 中加载页面时，我希望执行一些个人开发的 JavaScript 代码。似乎 Safari 的 addblock 可以做到这一点。有人知道怎么做吗？

Safari 不可扩展。它没有插件框架。但是还有 adblock 和其他可用的插件，尽管 Apple 的 Webkit 和 Safari 开发人员不鼓励用户使用它们，称它们为“二进制黑客”。似乎其中一些插件使用了 InputManager，它在任何地方都没有记录，至少不是因为人们如何使用它在 Safari 中加载脚本。我想我将不得不向后工程师看看 addblock 是如何做到的，但在我这样做之前，我想我会在这里问一下。有人知道吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-10T19:36:35.277

输入管理器是将任意代码注入另一个应用程序的运行时的常用（ab）方法。到达那里后，您必须对应用程序本身进行足够的逆向工程，以弄清楚如何获得所需的行为；通常这涉及到方法调配来替换您正在破解的应用程序的一部分。它没有记录，因为没有要记录的 API，但是您可以了解各个部分（一般如何编写输入管理器，Objective C 中的方法调配如何工作，如何使用类转储等工具），然后将其全部一起。

不过，您所描述的内容听起来像 Greasemonkey，并且已经有至少一两个黑客可以在 Safari 中启用类似 Greasemonkey 的行为。我建议先看看其中一个是否满足您的需求。

# c++ - STL 迭代器相等性是如何建立的？

> ID：844768
> 
> 赞同：12
> 
> 时间：2009-05-10T05:32:49.460
> 
> 标签：c++, stl

我想知道，如何为 STL 迭代器建立平等（==）？它是简单的指针比较（因此基于地址）还是更花哨的东西？

如果我有来自两个不同列表对象的两个迭代器并比较它们，结果是否总是错误的？

如果我将一个有效值与一个超出范围的值进行比较怎么办？这总是假的吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-10T05:38:43.580

如果需要，迭代器类可以定义重载的 == 运算符。所以结果取决于`operator==`.

您实际上不应该比较来自不同容器的迭代器。我认为，如果您这样做，一些调试 STL 实现会发出警告信号，这将帮助您在代码中发现这种错误使用的情况。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-10-19T09:21:24.103

> **Daniel 问：** 我想知道，如何为 STL 迭代器建立相等（==）？它是简单的指针比较（因此基于地址）还是更花哨的东西？

这取决于实施。现在，在 Visual C++ 2008 上，我看到以下代码（用于列表迭代器）：

```
bool operator==(const _Myt_iter& _Right) const
{   // test for iterator equality

#if _HAS_ITERATOR_DEBUGGING
    _Compat(_Right);
#else
    _SCL_SECURE_TRAITS_VALIDATE(this->_Has_container() && this->_Same_container(_Right));
#endif /* _HAS_ITERATOR_DEBUGGING */

    return (_Ptr == _Right._Ptr);
} 
```

您将在上面看到验证迭代器有效性的代码和`_Ptr`指向列表节点的指针。

所以我想既有验证，也有简单的原始指针比较。

> **丹尼尔问：** 如果我有来自两个不同列表对象的两个迭代器，我比较它们，结果会不会总是假的？

到目前为止，该标准似乎在该主题上有些不清楚。显然，他们会明确写出这种操作有未定义的结果：

引用：[http ://www.open-std.org/jtc1/sc22/wg21/docs/lwg-active.html#446](http://www.open-std.org/jtc1/sc22/wg21/docs/lwg-active.html#446)

> **使用任何迭代器操作的结果**(24.2.1 [input.iterators], 24.2.2 [output.iterators], 24.2.3 [forward.iterators], 24.2.4 [bidirectional.iterators], 24.2.5 [random. access.iterators])**使用两个迭代器值作为参数**（脚注）**，这些值是从两个不同范围**r1 和 r2（包括它们的过去值）获得的，它们不是一个公共范围**的子范围，除非另有明确**说明.
> 
> 脚注）除其他外，这些操作包括 ==、<、二进制 - 和复制赋值

所以我想比较来自不同容器的迭代器是邪恶的...... ^_^

> **丹尼尔问：** 如果我将一个有效值与一个超出范围的值进行比较会怎样？这总是假的吗？

和上面一样。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-10T07:16:58.913

> 我想知道，如何为 STL 迭代器建立平等（==）？

并非所有迭代器都可以进行比较（例如，不需要提供输出迭代器`op==`）。`operator==`当范围的概念为所考虑的迭代器类别明确定义时，您可以使用。

> 它是简单的指针比较（因此基于地址）还是更花哨的东西？

迭代器总是用指针实现的。编辑：我说**用** -- 实现，这不是指标准要求，而是指使用 poitners 作为底层构造的做法。实现（如 VS）可能会插入特殊的验证检查。

> 如果我有来自两个不同列表对象的两个迭代器并比较它们，结果是否总是错误的？

您正在调用未定义的行为。

> 如果我将一个有效值与一个超出范围的值进行比较怎么办？这总是假的吗？

同样，您将调用 UB。唯一有效的比较是在同一范围内的两个迭代器之间或在范围内的一个迭代器和另一个与最后一个元素之后的迭代器之间进行比较。请注意，您只能将迭代器与最后一个元素进行比较，取消引用相同的导致 UB。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-10T09:48:20.923

相等性测试特定于您正在使用的迭代器类型，或者可能根本不存在。如果你真的想知道，你可以随时查看你正在使用的 STL 实现的源代码，在迭代器类中查找 operator==()。

迭代器并不总是指针，实际上在某些“安全”版本的 STL 中，迭代器从来都不是指针。向量和字符串的迭代器通常被实现为指针，因为它们可以。用于双端队列、列表、集合和映射的迭代器在任何半有效实现中都不能是指针。

迭代器是一种智能指针。它们遵循一般原则，即如果它们的外观和行为都像指针，那么就用户而言，它们*就是*指针。

# javascript - 查询登录状态的 URL，javascript

> ID：844795
> 
> 赞同：1
> 
> 时间：2009-05-10T05:59:57.650
> 
> 标签：javascript, ajax, request, xul

这似乎很容易，但我找不到不被认为是安全问题的方法（除了明显的方法）......

因此，我想为 Firefox 构建一个附加组件以供我的团队使用。基本上它将是一个状态栏图标，让我们知道我们的工具站点的身份验证 cookie 是否已过期，因此我们可以在不丢失浏览器中当前任何工作的情况下进行判断。

起初我以为我可以让插件检查 cookie，但对于这样一个简单的想法来说，这似乎是一个巨大的麻烦。然后我突然想到......呃......我可以让插件尝试访问我们网站的主页。如果它收到“拒绝访问”响应，它可以显示“未登录”图标，但如果它得到任何其他内容，它可以显示“已登录”。

然而，所有使用 AJAX 的尝试都被证明几乎和我的 cookie 尝试一样困难。

有没有一种简单的方法，最好使用 javascript，但在 XUL 中，要说

```
var url = "http://example.com";
var response = pingURL(url, "blah);
status = (response = "Welcome!") ? "Signed in" : "Not Signed In"; 
```

其中“pingURL”将是“去”到 url 并获得响应的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-10T06:17:49.540

```
function checkAccess(url, callback) {
    var xhr = new XMLHttpRequest();
    xhr.open("GET", url);
    xhr.onreadystatechange = function () {
        if (xhr.readyState == 4) {
            if (xhr.status == 200) {
                callback(true);
            } else {
                callback(false);
            }
        }
    };
} 
```

这应该工作......只需调用“checkAccess（' [http](http://example.com) ://example.com'，function （ready）{}）;” 例如，准备好是一个布尔值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-10T06:44:24.547

究竟为什么你认为饼干是一个巨大的麻烦？这无疑会更快，并且可能更容易实现。从 chrome 读取 cookie 很[简单，并且有据可查](https://developer.mozilla.org/en/Code_snippets/Cookies)。如果您不知道如何解析 cookie，请寻求帮助。

# wpf - MVVM 和窗口列表

> ID：844807
> 
> 赞同：0
> 
> 时间：2009-05-10T06:08:20.670
> 
> 标签：wpf, data-binding, mvvm

我正在编写一个允许用户浏览数据的应用程序，并且我想使用 FireFox UI 样式：允许用户打开任意数量的窗口，每个窗口都有任意数量的选项卡。我也想尽可能地使用 Model-View-ViewModel 模式来做到这一点。

在 MVVM 中打开一个新选项卡应该很容易处理。制作一个 TabViewModel 的 ObservableCollection，将该集合绑定到 TabControl 的 ItemsSource，然后打开一个新选项卡理论上就像向集合中添加一个新的 TabViewModel 一样简单。

这是我感兴趣的问题：有没有办法为打开一个新*窗口*做同样的事情？即，将 WindowViewModel 的 ObservableCollection 数据绑定到...应用程序的 Windows 集合的 ItemsSource？...这样当我将新的 WindowViewModel 添加到可观察集合时，会自动打开一个新窗口？然后将其绑定到应用程序启动中，这样我就无需设置 StartupUri，而是将第一个 WindowViewModel 添加到集合中？

由于我实际上无法对 Application.Windows 进行数据绑定，因此 ViewModel 层的最佳方式是：

1.  添加一个新的 WindowViewModel 并自动出现一个新的 Window；
2.  移除 WindowViewModel 并使其 Window 自动关闭。
3.  如果用户关闭窗口，则从集合中删除 WindowViewModel。

我可以编写自己的对象来监视 INotifyCollectionChanged 并打开/关闭窗口以响应收集事件，但我不确定这是否是最好的方法——如果是，我不确定最好的钩子方法它进入应用程序。有人对解决此问题的最佳方法有想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-10T07:04:07.823

MVVM 的要点是，ViewModel**不必**（详细）关注View**如何**对 ViewModel 中的更改做出反应。

一种可能性是在 View 中侦听 ViewModel 中的 CollectionChanged 事件的简单跟踪算法，在旅途中创建和销毁 Windows：

```
Dictionary<WindowModel, WindowView> _cache = new;
void WindowModelListChangedHandler(sender, args) {
    switch(args.Action) {
        case Add:
            _cache[args.NewItem] = new WindowView(args.NewItem);
            _cache[args.NewItem].Show();
            break;
        case Remove:
            // ...
    }    
} 
```

# java - 侦听使用 Java 中的文件菜单调用的打印作业事件

> ID：844812
> 
> 赞同：0
> 
> 时间：2009-05-10T06:15:42.947
> 
> 标签：java, event-handling, operating-system

我有兴趣知道我的 Java 程序如何监听底层操作系统生成的 Print 事件。由于我的项目基于 Java，打印作业事件侦听器不应依赖于平台。更具体地说，我的程序将在后台运行，如果用户尝试从 MS Word 打印页面（例如），则应通知打印作业。该事件不仅应通知正在启动的打印作业，还应通知其他详细信息，例如页数、文档位置等（如果可能的话）。非常感谢提供完整教程或一些片段的链接。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-10T06:28:59.483

我们是一家 C++ 和 Java 商店。我编写的代码几乎可以满足您的要求。它是用 C++ 为 Win32 编写的（并且是正确的错误 - 这是 Win32 API 中记录最少的领域之一 - 并且不同的打印机发送不同的事件流，因此开发健壮的打印队列非常困难处理）。

如果有人创建了一个 JNI 库来做这些事情（不太可能），那么它就不可能是跨平台的。所涉及的工作量将是巨大的（不同的操作系统以完全不同的方式处理打印队列和通知）。

我的建议是复习你的 Win32 编程（使用 C/C++）。一旦你有东西在那里工作，如果你绝对必须让它们与你的 Java 应用程序交互，你可以使用 JNI 来包装它。

这是有关打印机更改通知监控的 MSDN 文章（您必须先调用 OpenPrinter - 但下一个调用是 FindFirstPrinterChangeNotification）：http: [//msdn.microsoft.com/en-us/library/dd162722 (VS.85).aspx](http://msdn.microsoft.com/en-us/library/dd162722(VS.85).aspx)

如果您也尝试支持 *nix 和 mac，则需要单独挖掘它们。祝你好运。

# c++ - 涉及私有继承的 C 风格向上和向下转换

> ID：844816
> 
> 赞同：6
> 
> 时间：2009-05-10T06:18:16.327
> 
> 标签：c++, inheritance, casting

考虑以下代码：-

```
class A {};

class B : private A {};

B* bPtr1 = new B;
// A* aPtr1 = bPtr1; // error
// A* aPtr2 = static_cast<A*>(bPtr1); // error
A* aPtr3 = (A*)bPtr1;
B* bPtr2 = (B*)aPtr3; 
```

C 风格的转换丢弃了私有继承，而隐式和`static_cast`失败（也`dynamic_cast`）。为什么 ？如果 C 风格的转换只是有点摆弄，那么 C++ 转换是如何实现的，即他们如何知道内存占用的继承类型？

在 bPtr1 被转换为 aPtr3 之后，我将不得不使用另一个 C 风格的转换来再次向下转换为 B`static_cast`并且`dynamic_cast`失败。那么，bPtr2 能保证好的吗？

提前致谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-10T10:33:43.997

标准在 5.4.7 中指出，C 风格转换实际上*比任何新风格转换序列都可以做的更多*——特别是包括从派生指针到基指针的转换，即使基类是不可访问，这正是私有继承发生的情况。（为什么这应该被允许，特别是为什么它应该只被允许用于 C 风格的演员，完全超出了我的理解；但不可否认的是，它是允许的。）

所以 dribeas 是对的，编译器有义务正确处理 OP 的 C 风格指针转换，即使是`B`从多个基类继承。我自己对 MSVC++8 和 MinGW 的测试在实践中证实了他的结果——当从多个基类继承时，编译器将在将 a 转换为 an`B`时调整指针，反之亦然，以便识别正确的对象或子对象。`B*``A*`

我坚持我的主张，即如果您打算将 a视为a ，则应该`B` *公开*派生，因为使用私有继承反而*需要*使用 C 风格的强制转换。`A``B``A`

 ** * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-10T06:38:58.053

C++ 强制转换由编译器（而不是链接器）强制执行。不是私有继承导致不同的类布局；如果继承不是公共的，则编译器将禁止您根据类的声明将指向派生类的指针转换为指向其基类的指针。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-10T07:17:22.330

现有的答案很好，但是您可能会发现一些有用的信息与此有关：

> C风格的演员只是有点摆弄

如果您在两种指针类型之间使用旧式强制转换，编译器通常不需要摆弄任何位。您是在告诉编译器您希望将内存位置视为包含某种类型（因为您知道它确实有效），因此编译器在运行时根本不做任何事情来修改内存的内容。强制转换只是在编译时禁用类型安全。

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2009-05-10T07:08:48.090

> 如果 C 风格的转换只是有点摆弄，那么 C++ 转换是如何实现的，即他们如何知道内存占用的继承类型？

C++ 中的 C 风格类型转换的意义远不止眼前。从技术上讲，它们是要求编译器选择转换所需的正确转换运算符的唯一方法。出于同样的原因，这比使用`reinterpret_cast`. 后者是实现定义的。

似乎 C 风格的演员阵容有很多混淆。请记住，在您知道如何使用之前，没有任何工具是安全的。这同样适用于 C 风格的演员表。进行 C 风格转换的目的是要求编译器为给定的一对类型选择最安全和最可移植的转换。这可能会触发从静默`static_cast`变为`reinterpret_cast`静默并引入错误。关键是：你需要知道你在做什么。

# javascript - JQuery 文件扩展重写，将新 url 加载到隐藏的 div

> ID：844817
> 
> 赞同：2
> 
> 时间：2009-05-10T06:21:38.487
> 
> 标签：javascript, jquery, url-rewriting

我在侧边栏的 div 中有一个缩略图库。这些 jpg 图像中的每一个都链接到同一页面主 div 中较大的 jpg 图像。我通过fadein jquery将这些加载到一个div中，如下所示：

```
$(function() {
 $('.vid-gallery-thumbnail a').click(function() {
  newImg = $(this).attr('href');
  $('.ngg-imagebrowser img').fadeOut('slow', function(){
   $('.ngg-imagebrowser').css({ height: $(".ngg-imagebrowser img").height() });
   $('.ngg-imagebrowser img').attr({ src: newImg }).css({ margin: "0", visibility: "hidden" }).show();
   $('.ngg-imagebrowser').animate({ height: $(".ngg-imagebrowser img").height() }, 'slow', function(){
    $('.ngg-imagebrowser img').css({ visibility: "visible", display: "none" }).fadeIn('slow');
   });
  });
  return false;
 });
}); 
```

我正在尝试做的是重写该 url 字符串，以便将 .jpg 扩展名动态重写为 .flv 扩展名。然后该链接将被插入到主 div 区域并显示。这是我一直试图开始工作的代码。

```
$(function() {
 $('.vid-gallery-thumbnail a').click(function() {
  if (var suffix == null) { suffix = ".flv"; }
  fileExtension = $(this).attr("src").substr($(this).attr("src").lastIndexOf(".jpg"));
  var newFLV = $(this).attr("src", $(this).attr("src").replace(fileExtension, suffix));
  $('.ngg-imagebrowser img').fadeOut('slow', function(){
   $('.ngg-imagebrowser').css({ height: $(".ngg-imagebrowser img").height() });
   $('.ngg-imagebrowser img').attr({ src: newFLV }).css({ margin: "0", visibility: "hidden" }).show();
   $('.ngg-imagebrowser').animate({ height: $(".ngg-imagebrowser img").height() }, 'slow', function(){
    $('.ngg-imagebrowser img').css({ visibility: "visible", display: "none" }).fadeIn('slow');
   });
  });
  return false;
 });
}); 
```

当前发生的情况：图像未重写，JPG 像普通图像链接一样在浏览器中加载。我不是一个真正的 Javascript 程序员，所以我已经超出了我的深度。任何可以帮助我的想法都会很可爱！提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-10T06:52:19.643

使用带有[Javascript 字符串 replace()](http://free.netartmedia.net/DHTML/DHTML7.html)方法的[正则表达式。](http://www.regular-expressions.info/javascript.html)

```
var src = $(this).attr("src");
if (typeof src != "undefined") {
    $(this).attr("src", src.replace(/\.jpg$/i, ".flv");
} 
```

该检查可能不一定严格，但总比不检查要好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T06:02:20.590

我和我的好朋友 f8xmulder 一起工作，这是 Cletus 解决方案中缺少的部分：$(this) 调用指的是链接，*而不是*元素。所以 Cletus 的解决方案应该是这样的：

```
var img = $('.ngg-imagebrowser img');
var convertToFLV = img.attr("src");
if (convertToFLV != undefined) {
    convertToFLV = convertToFLV.replace(/\.jpg$/i, ".flv");
} 
```

谢谢你让我们快到了，Cletus。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-11T08:37:42.087

我似乎无法对以前的答案发表评论。

@xanadont，在注意到奇怪的行为后，我意识到（你）我们的解决方案，特别是第一行，实际上是拉入默认在 .ngg-imagebrowswer div 中打开的图像。不幸的是，它总是加载相同的图像，因此将相同的文件路径转换为相同的 flv。我们需要做的是从 click 事件中拉出 href。像这样：

```
 var img = $(this).attr('href');
 var convertToFLV = img.attr("src");
 if (convertToFLV != undefined) {
 convertToFLV = convertToFLV.replace(/\.jpg$/i, ".flv");
} 
```

对我来说，这对我来说至少有适度的意义。但不是Javascript。

**编辑：我做了更多的挖掘并找到了解决方案。**
本质上，我需要获取被选中的缩略图的点击源，将其放入 ConvertToFLV，然后在 url wrap 中调用它。
完整代码如下：

```
$(function() {
 $('.vid-gallery-thumbnail a').click(function() {
 newFLV = $(this).attr('href');

 var convertToFLV = $(this).attr('href');
 if (convertToFLV != undefined) {
  convertToFLV = convertToFLV.replace(/\.jpg$/i, ".flv");
 }

 $('.ngg-imagebrowser').fadeOut('slow', function(){
  $('.ngg-imagebrowser').css({ height: $(".ngg-imagebrowser img").height() });
  $('.ngg-imagebrowser img').wrap('<a href="' + convertToFLV + '"></a>').attr({ src: newFLV }).css({ margin: "0", visibility: "hidden" }).show();
  $('.ngg-imagebrowser').animate({ height: $(".ngg-imagebrowser img").height() },'slow', function(){  
   $('.ngg-imagebrowser img').css({ visibility: "visible", display: "none" }).fadeIn('slow');
  });
 });
 return false;
});
}); 
```

**编辑：出现了其他问题。** 单击第一个视频缩略图会显示正确的 URL。单击随后的拇指会显示相同 URL 的克隆。修改后的样式代码如下：

```
$(function() {
 $('.ngg-gallery-thumbnail a').click(function() {
  newImg = $(this).attr('href');
  $(function(){
   $('.ngg-imagebrowser img').attr({ src: newImg }).css({ margin: "0", visibility: "hidden" }).show();
   $('.ngg-imagebrowser').animate({ height: '650px;' }, 'slow', function(){
    $('.vid-imagebrowser div').hide(); // Hide video div
$('.ngg-imagebrowser div').show(); // Show image div
    $('.ngg-imagebrowser img').css({ visibility: "visible", display: "none" }).fadeIn('slow');
   });
  });
  return false;
 });

 $('.vid-gallery-thumbnail a').click(function() {
  newFLV = $(this).attr('href');

  var convertToFLV = $(this).attr('href');
  if (convertToFLV != undefined) {
   convertToFLV = convertToFLV.replace(/\.jpg$/i, ".flv");
  }

  $(function(){     
   $('.vid-imagebrowser img').wrap('<a href="' + convertToFLV + '"></a>').attr({ src: newFLV }).css({ margin: "0", visibility: "hidden" }).show();
   $('.vid-imagebrowser').animate({ height: '650px;' },'slow', function(){
$('.ngg-imagebrowser div').hide(); // Hide image div
$('.vid-imagebrowser div').show(); // Show video div
    $('.vid-imagebrowser img').css({ visibility: "visible", display: "none" }).fadeIn('slow');
   });
   Anarchy.FLV.go(); //recall An-Arcos script
  });
  return false;
 });
}); 
```

**最终编辑：问题解决了！**

```
$(function() {
 $('.ngg-gallery-thumbnail a').click(function() {
   $('div.vid-imagebrowser span').remove();
   newImg = $(this).attr('href');
     $('.ngg-imagebrowser img').attr({ src: newImg }).css({ margin: "0", visibility: "hidden" }).show();
     $('.ngg-imagebrowser').animate({ height: '650px;' }, 'slow', function(){
  $('.vid-imagebrowser div').hide(); // Hide video div
  $('.ngg-imagebrowser div').show(); // Show image div
      $('.ngg-imagebrowser img').css({ visibility: "visible", display: "none" }).fadeIn('slow');
   });
   return false;
  });

  $('.vid-gallery-thumbnail a').click(function() {
   $('div.vid-imagebrowser span').remove();
   newFLV = $(this).attr('href');

   var convertToFLV = $(this).attr('href');
   if (convertToFLV != undefined) {
    convertToFLV = convertToFLV.replace(/\.jpg$/i, ".flv");
   }
   $('.ngg-imagebrowser div').hide(); // Hide image div
   $('.vid-imagebrowser img').attr({ src: newFLV })
   $('.vid-imagebrowser a').attr({ href: convertToFLV }).css({ margin: "0", visibility: "hidden" }).show();
   $('.vid-imagebrowser').animate({ height: '650px;' },'slow', function(){
$('.ngg-imagebrowser div').hide(); // Hide image div
$('.vid-imagebrowser div').show(); // Show video div
    $('.vid-imagebrowser object').css({ visibility: "visible", display: "none" }).fadeIn('slow');
   });
   Anarchy.FLV.go(); //recall An-Arcos script
   return false;
  });
 }); 
```

# macos - 如何在 OS X 上进行静态链接

> ID：844819
> 
> 赞同：58
> 
> 时间：2009-05-10T06:22:10.043
> 
> 标签：macos, linker, static-libraries

我正在尝试链接到 OS X 上的静态库。我`-static`在 gcc 命令中使用了该标志，但收到以下错误消息：

```
ld_classic：找不到文件：-lcrt0.o
collect2: ld 返回 1 个退出状态

```

我查看了手册页，内容如下：

> 除非所有库（包括 libgcc.a）也已使用 -static 编译，否则此选项在 Mac OS X 上不起作用。由于既没有提供静态版本的 libSystem.dylib 也没有提供 crt0.o，因此该选项对大多数人没有用处。

还有其他方法可以链接到这个静态库吗？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2009-05-10T21:54:10.717

为了链接到存档库（有时也称为静态库），只需将其添加到链接行：

```
gcc main.o ... -lfoo ... 
```

链接器将搜索 libfoo.dylib，然后搜索 libfoo.a，这就是您所需要的。

如果您同时拥有*两个*版本的库，并且想要链接存档版本而不是动态版本，只需在链接行上指定存档的完整路径：

```
gcc main.o ... /path/to/libfoo.a ... 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-12-04T16:33:11.900

很遗憾，[它不受支持](http://developer.apple.com/mac/library/qa/qa2001/qa1118.html "2002 年，但仍然活跃")。有些人报告说可以手动编译crt0，但[没有人确认](http://discussions.apple.com/thread.jspa?threadID=2252567&tstart=-1)。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2017-01-06T21:39:44.043

一个常见的情况是**静态链接到第三方用户库，同时动态链接到系统框架**和库，因此您的用户在使用您的程序之前不需要安装第三方库。如果库是针对框架动态链接的（通常是这种情况），它可能仍带有静态 .a，但仅替换为是不够的`-l<libname>`，`/path/to/libname.a`因为 .a 中没有依赖项。您还必须动态链接您的库正在使用的那些框架。

例如，假设您想编写一个使用开源 libusb 的程序，而无需您的用户下载和安装 libusb。假设您有一个使用此构建的动态链接二进制文件：

```
clang -lusb-1.0 main.c -o myprogram 
```

要在 OS X 上静态链接，命令如下所示（注意`-framework`参数）：

```
clang -framework CoreFoundation -framework IOKit main.c /path/to/libusb-1.0.a -o myprogram 
```

要查找需要添加的系统框架和库，请使用 otool 查看第三方 dylib：

```
otool -L /usr/local/opt/libusb/lib/libusb-1.0.0.dylib 
```

这表明：

```
/usr/local/opt/libusb/lib/libusb-1.0.0.dylib:
    /usr/local/opt/libusb/lib/libusb-1.0.0.dylib (compatibility version 2.0.0, current version 2.0.0)
    /usr/lib/libobjc.A.dylib (compatibility version 1.0.0, current version 228.0.0)
    /System/Library/Frameworks/IOKit.framework/Versions/A/IOKit (compatibility version 1.0.0, current version 275.0.0)
    /System/Library/Frameworks/CoreFoundation.framework/Versions/A/CoreFoundation (compatibility version 150.0.0, current version 1348.0.0)
    /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1238.0.0) 
```

您可以从添加框架开始，然后一次添加一个库，您将看到未定义的引用错误列表缩小。请注意，您可能不需要添加每个库，因为有些库可能会作为您明确添加的库的依赖项加载。

如果您不确定 dylib 存在于何处，请以原始动态方式（使用 -lusb-1.0）构建您的程序，然后在其上运行 otool：

```
clang -lusb-1.0 main.c -o myprogram
otool -L myprogram 
```

这使：

```
myprogram:
    /usr/local/opt/libusb/lib/libusb-1.0.0.dylib (compatibility version 2.0.0, current version 2.0.0)
    /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1238.0.0) 
```

另外，请阅读您要链接到的库的许可证。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-08-07T19:39:30.623

`-Bstatic`似乎在 OS-X Lion 上没有任何操作 - 用于`gcc -v`确认这一点。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-06-11T15:21:23.553

我遇到了同样的问题。这是一个可以解决的示例：

STEP1：创建文件

myfunc1.c:

```
#include <stdio.h>

void myfunc1() {
    printf( "This is my func1!\n" );
} 
```

myfunc2.c:

```
#include <stdio.h>

void myfunc2() {
    printf( "This is my func2!\n" );
} 
```

和 myfunc.c：

```
#include <stdio.h>

void myfunc1( void );
void myfunc2( void );

int main() {
    myfunc1();
    myfunc2();
    return 0;
} 
```

STEP2：创建库

```
gcc -c myfunc1.c myfunc2.c

ar -r libmyfuncs.a myfunc1.o myfunc2.o 
```

STEP3：链接

```
gcc -o myfunc -L. myfunc.c -lmyfuncs 
```

不要忘记输入“-L.”；点表示当前路径。

希望有帮助。

# process - 如何在 Windows Xp 中获取 CPU 利用率指标？

> ID：844825
> 
> 赞同：1
> 
> 时间：2009-05-10T06:29:11.743
> 
> 标签：process, cpu, utilization

我需要获取所有进程的 CPU 利用率指标。

> 操作系统 = Windows Xp 编程语言 = Java 要求 = 需要无限期地每隔几秒采样一次，而不仅仅是一个及时的快照。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-10T08:10:06.633

*WMI 是所有*Windows 测量工具的首选工具。我编写了 VB 脚本代码，它会定期查询 WMI 接口以检索 CPU 信息、磁盘信息和各种其他信息。

[Win32_Process](http://msdn.microsoft.com/en-us/library/aa394372(VS.85).aspx)类是您正在寻找的类，本页[详细](http://www.dreamincode.net/code/snippet3297.htm)介绍了如何使用名为 JACOB（Java COM Bridge）的免费工具在 Java 中执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-10T12:33:12.093

使用`typeperf`我们可以在 Windows 中获取基于进程的指标

句法 ：

```
typeperf "\Process(processname)\% Processor Time" "\Process(processname)\%ID Process" 
```

例子 ：

```
typeperf "\Process(svchost)\% Processor Time" "\Process(svchost)\%ID Process" 
```

注意：进程会有几个计数器。所以我们也可以提及这些指标。

在 Windows 中使用 perfmon 工具来获取这些计数器。

在运行中使用 perfmon 命令来使用 perfmon 工具。

计数器将取决于处理器、内存、进程等指标的类型

# iphone - 创建自定义文本绘图视图

> ID：844829
> 
> 赞同：3
> 
> 时间：2009-05-10T06:32:59.363
> 
> 标签：iphone, objective-c, cocoa-touch

我正在为 iPhone 创建一个语法高亮器，为了显示多种格式的文本，我对 UIView 进行了子类化并修改了该`drawRect:`方法，以便每一行都以正确的语法高亮显示（高亮是前面使用 RegEx 完成的，文本是一次绘制`CGContextShowTextAtPoint()`一条线）。一切正常，我将每一行文本作为 NSString 存储在 NSMutableArray 中，我通过隐藏的 UITextField 及其委托方法处理键盘，光标是一个闪烁的 CALayer，可以通过触摸移动，我有一个自定义滚动视图处理滚动。但是，我有两个问题似乎无法解决：

1.  自动换行，现在文本一直在屏幕的左端。为了保持快速，我只重绘视图中已更改的部分（通常只是正在编辑的行，但有时也包括下面的行，例如，如果您在文档中途按下回车键）`setNeedsDisplayInRect:`。这使自动换行变得复杂，因为您必须在屏幕上绘制多条线，即使它仍然只是数组中的一个对象。

2.  UIView 的最大内容大小为 1024x1024，相当于大约 64 行。我需要展示更多内容的能力。我正在考虑一个接一个地使用多个 CALayers，但是我无法将内容绘制到图层（使用`drawLayer:inContext:`and `drawInContext:`）。

所以我的问题是：

*   有没有人对如何完成这两点有任何，甚至是一般性的建议。或者，
*   是否有人已经编写了一个自定义的文本绘图视图来处理我可以使用的这些东西。

谢谢，

凯尔

**编辑：**滚动问题几乎解决了，但是我仍然遇到自动换行问题。我的麻烦是一切都是按行完成的：视图一次更新一行，文本存储为行数组，荧光笔一次突出一行，等等，并且在数组中有一个索引（一个文本行）在屏幕上占用多行会引发一些问题，例如，我必须实现自己的可移动光标，当您移动光标时，它需要能够转动显示行（通过将 touch.x 除以行高）到文本行（数组中的索引）。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-11T17:11:27.437

您应该首先花一些时间了解如何在 Mac 上解决此问题：

[http://developer.apple.com/documentation/Cocoa/Conceptual/TextArchitecture/Tasks/AssembleSysByHand.html](http://developer.apple.com/documentation/Cocoa/Conceptual/TextArchitecture/Tasks/AssembleSysByHand.html)

[http://developer.apple.com/documentation/Cocoa/Conceptual/TextLayout/TextLayout.html](http://developer.apple.com/documentation/Cocoa/Conceptual/TextLayout/TextLayout.html)

特别是，您应该熟悉行片段生成，这是您尝试解决的自动换行问题，并且您应该了解字形生成以便做好富文本。你当然不需要实现 NSTypesetter 或 NSLayoutManager 的所有灵活性，但是 Mac 上的文本系统非常强大，你应该从它的例子中学习。为 iPhone 实现类似于 NSAttributedString 的东西可能对您很有价值并提高您的性能。

除非你经常移动东西（这在 UIScrollView 中最有效），否则我认为你不需要在这里使用 CALayers。对于这个问题来说，这似乎有点矫枉过正，实际上可能会对 UIScrollView 已经提供的优化产生不利影响。如果您发现性能问题，首先确保您没有在 drawRect: 中进行冗余计算。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-11T18:05:13.747

查看[Three20 库](http://github.com/joehewitt/three20/tree/master)中的 TTStyledText 。不确定它与您的目标的匹配程度，但可以作为示例。（图书馆本身有点臃肿，但值得一看。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-10T14:26:12.927

最好在 UIView 中托管的 CATiledLayer 中绘制文本，以绕过 1024x1024 纹理大小限制（在所有现有设备上实际上都是 2048x2048）。对于在 CALayer 中绘制文本的示例，我建议您参考[Core Plot](http://code.google.com/p/core-plot/)框架中的[CPTextLayer](http://code.google.com/p/core-plot/source/browse/trunk/framework/Source/CPTextLayer.m)类。该层（从同一框架内的 CPLayer 类继承）在 CALayer 中进行跨平台（Mac 和 iPhone）文本渲染。您也许可以将其扩展为 CATiledLayer 以处理更长的文本块。

需要注意的一件事是特定于平台的 drawAtPoint: 方法在此层中使用，而不是您正在使用的 CGContextShowTextAtPoint() 函数。这样做的原因是 CGContextShowTextAtPoint() 仅适用于 ASCII 文本，这意味着您不能使用它进行 Unicode 文本渲染。有一个使用 CGContextShowTextAtPoint() 来绘制文本的示例，在 renderAsVectorInContext: 方法底部的 #define'd 部分内。

# php - 通过 wget/curl 长时间 cron 工作？

> ID：844831
> 
> 赞同：3
> 
> 时间：2009-05-10T06:36:45.657
> 
> 标签：php, cron

我正在为我的 php 应用程序处理 cron 作业，并计划通过 wget/curl 使用 cron。我的一些 php cron 作业可能需要 2-3 个小时。如何让 php 从 cron 选项卡工作 2-3 小时？通过 cron wget/curl 运行这么长时间的作业是一种好习惯吗？有人有这方面的经验吗？我也有电子邮件队列，我需要每 10 秒运行一次，但 cron 选项卡是分钟级别的。对这个案子有什么建议吗？

谢谢阅读。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-10T06:44:55.373

当您使用 wget/curl 时，您正在从网络服务器请求页面。每个网络服务器都会有一个超时时间，所以这可能会超时。

此外，一些托管服务提供商可能会停止运行超过特定分钟的进程（基本上是为了控制流氓线程）。

因此，如果作业花费的时间超过几分钟，则不建议使用 wget/curl 进行安排。

尝试使用实际的调度程序对其进行调度。您可以从命令行运行 php

> php [选项] [-f] [--] [参数...]

php 命令应该在路径上。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-10T09:35:56.817

您可以在脚本的开头使用以下内容来告诉 PHP 有效地永不超时：

```
set_time_limit(0); 
```

更明智的做法是，如果 crontab 打算每 24 小时运行一次脚本，请将超时设置为 24 小时，这样您就不会同时运行两个副本。

```
set_time_limit(24*60*60); 
```

Crontab 只允许分钟级执行，因为这是您真正应该启动脚本的最常见的情况 - 启动/关闭成本会导致更快速的调度效率低下。

如果您的应用程序需要每 10 秒检查一次队列，则更好的策略可能是使用一个长时间运行的脚本来执行该检查并偶尔使用 sleep() 来阻止自己占用系统资源。

在 UNIX 系统上，这样的脚本应该真正作为守护进程运行 - 查看 PEAR [System_Daemon](http://pear.php.net/package/System_Daemon)包以了解如何简单地完成此操作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-09-30T20:37:11.750

我刚刚遇到了通过 cron 和 wget 执行的长时间运行的 PHP 脚本的问题。由于 wget 中的默认超时，该脚本在 15 分钟后终止。

但是，如果您设置了正确的超时，我相信这种方法实际上确实有效。您运行的 PHP 脚本需要设置为无限运行时间。最好在长时间运行的脚本开始时设置它。

```
set_time_limit(0); 
```

使用 wget 时，您还需要通过传递 -T0 来消除其超时。例如

```
wget -q0 -T0 http://yourhost/job.php 
```

小心不要让长时间运行的脚本使服务器过载。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-12-10T21:16:29.897

如果`wget`用于调用长时间运行的 cron 作业，请考虑在这种情况下不希望使用的一些默认值。默认情况下，如果在900 秒`--tries`内没有读取任何数据，则会读取 20 次。`--read-timeout`因此，最大尝试设置为 1 以确保仅调用一次 cron 作业，因为您当然不希望长时间运行的脚本在其仍在运行时被多次调用。

```
wget -t 1 https://url/ 
```

如果在 cPanel 上并且您不关心每个 cron 作业运行后的任何输出电子邮件，还可以使用以下标志 -O 和 -q 隐藏输出，并使用 2>&1 重定向错误。

```
wget -O /dev/null -q -t 1 https://url/ 2>&1 
```

# wcf - WCF-流式传输时的错误处理

> ID：844833
> 
> 赞同：1
> 
> 时间：2009-05-10T06:39:23.700
> 
> 标签：wcf, error-handling, streaming

为了支持流式传输，我将带有覆盖的消息返回到 OnWriteBody
...
到客户端（通过 IErrorHandler 中的过滤）。
有没有办法解决这个问题。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-11T17:54:08.240

当使用 WCF 进行流式传输时，我创建了两个 ServiceContracts 一个执行流式传输，另一个将在流式传输结束时发送通知。

响应 ServiceContract 我使用了双工类型的绑定。客户端首先调用响应 ServiceContract 以获取其交易的票证，然后调用我的传输 ServiceContract。然后在事务结束时，客户端将从响应 ServiceContract 中收到成功或失败的通知。

```
 [ServiceContract]
public interface IStreamFileService
{
  [OperationContract]
  void Upload(Stream stream);
}

[ServiceContract(SessionMode = SessionMode.Required, CallbackContract = typeof(ITransferCallback))]
public interface IStreamFileResponseService
{
  [OperationContract(IsOneWay = false, IsInitiating = true, IsTerminating = false)]
  Guid StartUpload();
}

[ServiceContract]
public interface ITransferCallback
{
  [OperationContract]
  void OperationComplete(ResponseMessage response);
} 
```

我在两个服务中执行此操作，因为我的需求和工作流程要求我跟踪许多事情并进行身份验证、验证等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-06T07:27:48.190

当响应标头（例如 200）已发送到客户端时调用 OnWriteBody。在这个阶段不可能处理错误。我使用过的两种解决方法/技巧：

1.  在发送 200 之前等待第一个数据行（就像在返回消息之前）并在 OnWriteBody 中迭代更多行。这将起作用，因为大多数 SQL 错误和超时发生在显示任何数据之前。不过，不包括在结果集迭代时出现错误的情况。
2.  在客户端和服务器上有特殊的错误处理代码。就像，如果 OnWriteBody 内部的错误服务器可能会序列化错误并将其作为特殊的 Data-Row 发送。客户端在接收响应时应该期待这样的特殊数据行并相应地处理。

# c# - 通过 http 代理发送邮件

> ID：844835
> 
> 赞同：8
> 
> 时间：2009-05-10T06:40:25.197
> 
> 标签：c#, proxy, smtpclient, http-proxy

我正在尝试从通过 Internet 选项中设置的 http 代理连接到 Internet 的系统发送电子邮件。

我正在使用 SmtpClient。

有没有办法通过这个代理设置使用 SmtpClient 发送邮件。谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-10T07:08:07.127

Http 代理控制 http 流量，它们与 SMTP 几乎没有任何关系。我之前从未听说过代理 SMTP，毕竟 SMTP 本身本质上支持到目标 SMTP 服务器的“代理”链。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-10T07:33:51.590

I understand that you want to use the browsers default settings, i would also like an answer for that.

Meanwhile, you could do it manually.

```
 MailAddress from = new MailAddress("from@mailserver.com");
    MailAddress to = new MailAddress("to@mailserver.com");

    MailMessage mm = new MailMessage(from, to);
    mm.Subject = "Subject"
    mm.Body = "Body";

    SmtpClient client = new SmtpClient("proxy.mailserver.com", 8080);
    client.Credentials = new System.Net.NetworkCredential("from@mailserver.com", "password");

    client.Send(mm); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-10T07:20:17.533

如果您对 Internet 的唯一访问是通过 HTTP，那么您能够做到这一点的唯一方法是在端口 443 上设置一个带有 SSH 的 VPS（或等效）并使用开瓶器（或腻子）隧道 ssh 通过。从那里通过 ssh 隧道转发 smtp 流量是一件简单的事情。

Be aware that you may be violating the companies computing policy if you do this.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-12-04T05:05:11.830

## Use MailKit

[From Microsoft](https://docs.microsoft.com/en-us/dotnet/api/system.net.mail.smtpclient?view=net-6.0#remarks):

> Important
> 
> We don't recommend that you use the **SmtpClient** class for new development because **SmtpClient** doesn't support many modern protocols. Use [**MailKit**](https://github.com/jstedfast/MailKit) or other libraries instead. For more information, see [SmtpClient shouldn't be used](https://github.com/dotnet/platform-compat/blob/master/docs/DE0005.md) on GitHub.

Create a console app and add MailKit

```
dotnet new console --framework net6.0
dotnet add package MailKit 
```

Code to send through proxy

```
using MailKit.Net.Proxy;
using MailKit.Net.Smtp;
using MailKit.Security;
using MimeKit;

var emailFromAddress = "myemail@gmail.com";
var token = "mytoken";
var to = "Someone.Else@gmail.com";

var message = new MimeMessage();
message.From.Add(new MailboxAddress("Me", emailFromAddress));
message.To.Add(MailboxAddress.Parse(to));
message.Subject = "test";

message.Body = new TextPart("plain")
{
    Text = @"This is a test."
};

using (var client = new SmtpClient())
{
    client.ProxyClient = new HttpProxyClient("my-proxy.mydomain.com", 80);   // <-- set proxy
    client.Connect("smtp.gmail.com", 587, SecureSocketOptions.StartTls);
    client.Authenticate(emailFromAddress, token);

    client.Send(message);
    client.Disconnect(true);
} 
```

在此示例中，我使用 Gmail 发送电子邮件。为此，您必须生成一个令牌。转到您的[gmail](https://mail.google.com/) > 单击页面右上角的图标 >**管理您的 Google 帐户**> 从左侧菜单中选择**安全**性> 中途选择**应用程序密码**> 选择**邮件**并选择您的设备 > 按**生成**> 复制令牌并替换上面的 mytoken。

# visual-studio-2010 - Visual Studio 2010 CTP 过期解决方法

> ID：844837
> 
> 赞同：3
> 
> 时间：2009-05-10T06:42:32.787
> 
> 标签：visual-studio-2010

我从这里下载了 VS2010 CTP：

[http://www.microsoft.com/downloads/details.aspx?FamilyId=922B4655-93D0-4476-BDA4-94CF5F8D4814&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyId=922B4655-93D0-4476-BDA4-94CF5F8D4814&displaylang=en)

自然下载和安装需要一段时间，在 Virtual PC 中运行它后，我很失望地看到它已经过期，尽管它仍然可以下载。

然后我开始研究我需要做些什么才能让它在 2009 年 1 月 1 日到期日之后继续工作。我看着这个：

[http://blogs.msdn.com/virtual_pc_guy/archive/2007/11/28/disabling-time-synchronization-under-virtual-pc-2007.aspx](http://blogs.msdn.com/virtual_pc_guy/archive/2007/11/28/disabling-time-synchronization-under-virtual-pc-2007.aspx)

..但说明中提到要修改 VMC 文件中的设置。

问题是，我搜索了该文件，但里面没有这样的标签。

在启动 VPC 之前，我尝试在主机系统中调慢时钟，但这也不起作用。

有什么建议吗？我想知道如果安装没有意义，为什么 MS 会留下 2010 CTP 下载页面。是否有更新的版本可用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T13:29:39.777

[Visual Studio 2010 和 .NET Framework 4 Beta 1](http://msdn.microsoft.com/en-us/vstudio/dd582936.aspx)

我不确定它的有效期。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-10T06:59:53.620

这些说明确实有效 - 您必须将额外的标签插入到配置文件中；它不是从那里开始的。

我怀疑他们留下它的原因是人们可以下载它。:)

在重新尝试设置之前，您可能需要以从未运行过的状态重新启动虚拟机，因此您应该再次从下载文件中解压缩它。

# c - 查看输入缓冲区，并刷新 C 中的额外字符

> ID：844847
> 
> 赞同：2
> 
> 时间：2009-05-10T06:53:40.687
> 
> 标签：c, input, stdin, flush, peek

如果我想在 C 中接收一个字符输入，我将如何检查是否发送了额外的字符，如果是，我将如何清除它？

有没有类似 getc(stdin) 的函数，但它不会提示用户输入字符，所以我可以输入`while(getc(stdin)!=EOF);`？或者一个函数来查看缓冲区中的下一个字符，如果它不返回 NULL（或任何会存在的），我可以调用一个（另一个）函数来刷新标准输入？

## 编辑

所以现在， scanf 似乎在做这个伎俩，但有没有办法让它读取*整个*字符串，直到换行符？而不是到最近的空白？我知道我可以将“%s %s %s”或其他任何内容放入格式字符串中，但我可以处理任意数量的空格吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-10T07:01:30.637

您无法刷新输入流。如果这样做，您将调用未定义的行为。你最好的选择是：

```
int main() {
  int c = getchar();
  while (getchar() != EOF);
  return 0;
} 
```

使用`scanf`魔法：

```
#include <stdio.h>
#include <stdlib.h> 

#define str(s) #s
#define xstr(s) str(s)
#define BUFSZ 256

int main() {
  char buf[ BUFSZ + 1 ];
  int rc = scanf("%" xstr(BUFSZ) "[^\n]%*[^\n]", buf);
  if (!feof(stdin)) {
    getchar();
  }
  while (rc == 1) {
    printf("Your string is: %s\n", array);
    fflush(stdout);
    rc = scanf("%" xstr(LENGTH) "[^\n]%*[^\n]", array);
    if (!feof(stdin)) {
        getchar();
    }
   }
   return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-10T08:28:44.030

您可以使用`getline`读取整行输入。

或者（针对您的原始问题），您可以致电`select`或`poll`在 stdin 上查看是否还有其他字符要读取。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T03:58:27.533

我今天遇到了类似的问题，我找到了一种似乎可行的方法。我不知道你的情况的细节，所以我不知道它是否对你有用。

我正在编写一个需要从键盘获取单个字符的例程，并且它需要是三个特定击键之一（“1”、“2”或“3”）。如果不是其中之一，则程序需要发送错误消息并循环返回以再次尝试。

问题在于，除了 getchar() 返回的我输入的字符之外，“Enter”键击（将击键发送到程序）保存在输入缓冲区中。该（非打印）换行符然后由纠错循环中的 getchar() 工具返回，进一步导致第二条错误消息（因为换行符不是“1”，也不是“2” ，也不是“3”。）

问题更加复杂，因为我有时会超前于自己，而不是输入单个字符，而是输入这些选项之一将请求的文件名。然后我在缓冲区中有一整串不需要的字符，导致一长串错误消息向下滚动屏幕。

不酷。

但是，似乎已经解决了它的问题如下：

```
c = getchar();  // get first char in line
while(getchar() != '\n') ; // discard rest of buffer 
```

第一行是实际使用我输入的字符的行。第二行处理输入缓冲区中剩余的任何残留物。它只是创建一个循环，一次从输入缓冲区中提取一个字符。语句循环时没有指定要执行的操作。它只是读取一个字符，如果它不是换行符，则返回下一个。当它找到换行符时，循环结束并继续程序中的下一个业务顺序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-09-28T21:07:27.733

我们可以创建一个函数来清除键盘缓冲区，如下所示：

```
#include <stdio.h>

void clear_buffer(){
   char b;
   //this loop take character by character in the keyboard buffer using 
   //getchar() function, it stop when the variable "b" was
   //enter key or EOF.
   while (((b = getchar()) != '\n') && (b != EOF));
}

int main()
{
    char input;
    //get the input. supposed to be one char!
    scanf("%c", &input); 
    //call the clearing function that clear the buffer of the keyboard 
    clear_buffer(); 
    printf("%c\n",input); //print out the first character input
    // to make sure that our function work fine, we have to get the
    // input into the "input" char variable one more time
    scanf("%c", &input); 
    clear_buffer();  
    printf("%c\n",input);
    return 0;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-10T07:00:18.470

使用需要大量字符（超过 1 个，可能是 256 个）的读取，并查看实际返回了多少个字符。如果你得到不止一个，你知道；如果你只得到一个，那就是所有可用的。

你没有提到平台，这很快就变得相当棘手。例如，在 Unix (Linux) 上，正常机制将返回一行数据 - 可能是您所追求的一个字符和一个换行符。或者，也许您说服您的用户输入 ^D（默认）来发送前面的字符。或者，也许您使用控制功能将终端置于原始模式（如`vi`和`emacs`do 之类的程序）。

在 Windows 上，我不太确定——我认为有一个`getch()`功能可以满足您的需求。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-10T07:09:55.093

为什么不使用 scanf 而不是 getc，通过使用 scanf 可以获取整个字符串。

# perl - 如何使用 mod_perl2 和 Apache Bucket Brigades？

> ID：844849
> 
> 赞同：2
> 
> 时间：2009-05-10T06:56:46.607
> 
> 标签：perl, apache, apache2, mod-perl, mod-perl2

我正在编写一个应用程序来动态代理和重写网页，并且非常确定使用 mod_perl2 - 我正在使用 mod_perl (v1) 的现有实现。在 mod_perl2 中，有 APR::Brigades 和 APR::Buckets 的想法，根据我的模糊理解，这是一种进行我想要的过滤和重写的有效方法。但是，除了这些模块的 Perldoc 页面之外，我什么也找不到，所以我真的很不确定如何使用它们。

任何人都可以向我解释 mod_perl2 Bucket Brigades，指向我的教程，或者甚至向我展示一些我可以从中学习的使用 mod_perl2 的开源应用程序吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-11T00:50:02.317

Buckets 和 Brigades 是 Apache Portable Runtime 的原生概念。您将在 Apache HTTP Server 模块（如 mod_proxy、mod_deflate 和 mod_substitute）的源代码中找到大量原生 API 示例，其中包含特定于 HTTP 的倾斜。

在此处查看过滤器信息：http: [//www.apachetutor.org/dev/#filter](http://www.apachetutor.org/dev/#filter)

然后看看前面提到的 Apache HTTP Server 模块。

这里似乎有一个简单的 perl 特定过滤器：

[http://perl.apache.org/docs/2.0/user/handlers/filters.html#Bucket_Brigade_based_Output_Filters](http://perl.apache.org/docs/2.0/user/handlers/filters.html#Bucket_Brigade_based_Output_Filters)

# c# - 奇怪的“枚举器被实例化后集合被修改”异常

> ID：844850
> 
> 赞同：13
> 
> 时间：2009-05-10T06:57:23.703
> 
> 标签：c#, enumeration

也许有人可以指出我正确的方向，因为我完全被这件事难住了。

我有一个函数可以简单地打印出类的 LinkedList：

```
 LinkedList<Component> components = new LinkedList<Component>();
    ...
    private void PrintComponentList()
    {
        Console.WriteLine("---Component List: " + components.Count + " entries---");
        foreach (Component c in components)
        {
            Console.WriteLine(c);
        }
        Console.WriteLine("------");
    } 
```

该`Component`对象实际上有一个自定义`ToString()`调用，如下所示：

```
 int Id;
    ...
    public override String ToString()
    {
        return GetType() + ": " + Id;
    } 
```

这个函数通常工作正常 - 但是我遇到了一个问题，当它构建到列表中大约 30 个左右的条目时，该`PrintcomplentList` `foreach`语句返回一个`InvalidOperationException: Collection was modified after the enumerator was instantiated.`

现在您可以看到，我没有在 for 循环中修改代码，也没有显式创建任何线程，尽管这是在 XNA 环境中（如果重要的话）。应该注意的是，打印输出的频率足够高，以至于控制台输出会降低整个程序的速度。

我完全被难住了，还有其他人遇到过这个吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-10T08:41:24.343

我怀疑开始查找的地方将是您操作列表的任何地方 - 即插入/删除/重新分配项目。我怀疑在某个地方会有一个回调/偶数处理程序被异步触发（可能作为 XNA*绘制*等循环的一部分），并且正在编辑列表 - 本质上是导致这个问题作为竞争条件。

要检查是否是这种情况，请在操作列表的位置周围放置一些调试/跟踪输出，并查看它是否曾经（特别是在异常之前）与控制台输出同时运行操作代码：

```
private void SomeCallback()
{
   Console.WriteLine("---Adding foo"); // temp investigation code; remove
   components.AddLast(foo);
   Console.WriteLine("---Added foo"); // temp investigation code; remove
} 
```

不幸的是，这样的事情通常很难调试，因为更改代码来调查它通常会改变问题（一个[Heisenbug](http://en.wikipedia.org/wiki/Unusual_software_bug)）。

一种答案是同步访问；即在**所有**编辑列表的地方，使用`lock`完整的操作：

```
LinkedList<Component> components = new LinkedList<Component>();
readonly object syncLock = new object();
...
private void PrintComponentList()
{
    lock(syncLock)
    { // take lock before first use (.Count), covering the foreach
        Console.WriteLine("---Component List: " + components.Count
              + " entries---");
        foreach (Component c in components)
        {
           Console.WriteLine(c);
        }
        Console.WriteLine("------");
    } // release lock
} 
```

并在您的回调（或其他）中

```
private void SomeCallback()
{
   lock(syncLock)
   {
       components.AddLast(foo);
   }
} 
```

特别是，“完整操作”可能包括：

*   检查计数**和** `foreach`/`for`
*   检查存在**并**插入/删除
*   ETC

（即不是个人/离散操作 - 而是工作单元）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-06-24T12:37:26.887

而不是`foreach`，我使用`while( collection.count >0)`然后使用`collection[i]`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-08-19T20:38:17.833

我不知道这是否与 OP 有关，但我有同样的错误，并在谷歌搜索期间找到了这个线程。我能够通过在删除循环中的元素后添加一个中断来解决它。

```
foreach( Weapon activeWeapon in activeWeapons ){

            if (activeWeapon.position.Z < activeWeapon.range)
            {
                activeWeapons.Remove(activeWeapon);
                break; // Fixes error
            }
            else
            {
                activeWeapon.position += activeWeapon.velocity;
            }
        }
    } 
```

如果你忽略了中断，你会得到错误“InvalidOperationException: Collection was modified after the enumerator was instantiated。”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-11-19T08:27:07.380

使用`Break`可能是一种方式，但它可能会影响您的一系列操作。我在这种情况下所做的只是将循环转换`foreach`为传统`for`循环

```
for(i=0; i < List.count; i++)
{
    List.Remove();
    i--;
} 
```

这没有任何问题。

# bash - vi 模式下的 Bash：使用光标向上/向下浏览 shell 历史记录，光标位置不在末尾？

> ID：844862
> 
> 赞同：3
> 
> 时间：2009-05-10T07:16:30.290
> 
> 标签：bash, vim, emacs, history

我非常喜欢 vim，并且真的很想通过 vi-mode 增强我的 bash 体验。然而，我非常习惯于 emacs 行为的一件事是，当使用光标向上/向下浏览 shell 历史记录时，光标位于*行尾*。

在 vi 模式下则相反；光标始终位于行首。在 emacs 模式下使用 bash 的时间太长了，期待光标在末尾真的很烧脑。

浏览 shell 历史记录时，是否有机会在 bash vi 模式下默认获取光标位置？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-13T10:01:26.217

您需要重新映射上下光标：

```
bind -m vi-command '"\201": previous-history'
bind -m vi-command '"\202": next-history'
bind -m vi-command '"\203": end-of-line'
bind -m vi-command '"\e[A": "\201\203"'
bind -m vi-command '"\e[B": "\202\203"'
```

这会将上一个历史、下一个历史和行尾映射到不存在的键，然后上下映射到这些字符的序列。如果你愿意，你可以对 j/k 做同样的事情，但我建议不要管它们。这样你就可以两者兼得。

This only remaps the keys when you are in command mode. On my machine, the cursor is already at the end of the line in insert mode. If this is not true for you, you can do the same using vi-insert instead of vi-command as the keymap.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-10T07:44:59.893

我不知道如何在`bash`（或者`readline`，真的）内部重新编码历史代码。

但是，一旦找到要在末尾添加的行，就*真的*很难输入吗？`Shift-A`

如果您要放弃 emacs 模式，那么在某些时候，您将不得不完全这样做并接受`vi`做事的方式。加入我们，你知道你想:-)

# puzzle - 检查一个数是否能被3整除

> ID：844867
> 
> 赞同：19
> 
> 时间：2009-05-10T07:22:00.477
> 
> 标签：puzzle, division, modulo

编写代码来判断一个数是否能被 3 整除。函数的输入是**单个**位，0 或 1，如果目前收到的数字是能被 3 整除的数字的二进制表示，则输出应为 1，否则零。

例子：

```
input  "0":       (0)  output 1
inputs "1,0,0":   (4)  output 0
inputs "1,1,0,0": (6)  output 1 
```

这是基于一个面试问题。我要求绘制逻辑门，但由于这是 stackoverflow，我将接受任何编码语言。硬件实现（verilog 等）的奖励积分。

**第 a 部分（简单）：**第一个输入是 MSB。

**B 部分（稍微难一点）：**第一个输入是 LSB。

**c 部分（困难）：(** a) 或 (b) 哪个更快更小？（理论上不是 Big-O 意义上的，但实际上更快/更小。）现在采用较慢/较大的，并使其与更快/较小的一样快/小。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-05-10T09:48:02.750

有一个相当著名的技巧可以确定一个数字是否是 11 的倍数，方法是交替加减它的十进制数字。如果你最后得到的数字是 11 的倍数，那么你开始的数字也是 11 的倍数：

```
47278 4 - 7 + 2 - 7 + 8 = 0，11 的倍数 (47278 = 11 * 4298)
52214 5 - 2 + 2 - 1 + 4 = 8，不是 11 的倍数 (52214 = 11 * 4746 + 8)

```

我们可以将相同的技巧应用于二进制数。一个二进制数是 3 的倍数当且仅当其位的交替和也是 3 的倍数：

```
4 = 100 1 - 0 + 0 = 1，不是 3 的倍数
6 = 110 1 - 1 + 0 = 0，3 的倍数
78 = 1001110 1 - 0 + 0 - 1 + 1 - 1 + 0 = 0，3 的倍数
109 = 1101101 1 - 1 + 0 - 1 + 1 - 0 + 1 = 1，不是 3 的倍数

```

从 MSB 还是 LSB 开始都没有区别，因此以下 Python 函数在两种情况下都同样适用。它需要一个迭代器，一次返回一个位。 `multiplier`在 1 和 2 之间交替，而不是 1 和 -1 以避免取负数的模。

```
def divisibleBy3(iterator):

    multiplier = 1
    accumulator = 0

    for bit in iterator:
        accumulator = (accumulator + bit * multiplier) % 3
        multiplier = 3 - multiplier

    return accumulator == 0 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2010-07-15T06:39:00.960

在这里......一些新的东西......如何检查任何长度（甚至数千位）的二进制数是否可以被 3 整除。

[![可被 3 整除的状态机](https://i.stack.imgur.com/QeLBq.png)](http://i25.tinypic.com/23oe41.png)

```
-->((0))<---1--->()<---0--->(1)        ASCII representation of graph 
```

从图片来看。

1.  你从双圈开始。
2.  当你得到一个 1 或 0 时，如果数字在圆圈内，那么你会留在那个圆圈内。但是，如果数字在一条线上，那么您将穿过这条线。
3.  重复第二步，直到用完所有数字。
4.  如果你最终进入双圈，那么二进制数可以被 3 整除。

您也可以使用它来生成可被 3 整除的数字。而且我不认为将其转换为电路会很困难。

1个使用图表的例子...

11000000000001011111111111101 可被 3 整除（再次出现在双圈中）

自己试试吧。

您还可以使用类似的技巧来执行 MOD 10，用于将二进制数转换为以 10 为基数的数字。（10 个圆圈，每个圆圈加倍圆圈，表示模数产生的值 0 到 9）

**编辑：**这是从左到右运行的数字，修改有限状态机以接受反向语言并不难。

**注意：**在图形的 ASCII 表示中，() 表示单圈，(()) 表示双圈。在有限状态机中，这些被称为状态，双圈是接受状态（表示最终可被 3 整除的状态）

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-05-10T09:45:41.570

呵呵

LSB 的状态表：

```
S I S' O
0 0 0  1
0 1 1  0
1 0 2  0
1 1 0  1
2 0 1  0
2 1 2  0 
```

解释：0 能被三整除。`0 << 1 + 0 = 0`. 重复使用`S = (S << 1 + I) % 3`and `O = 1`if `S == 0`。

MSB 状态表：

```
S I S' O
0 0 0  1
0 1 2  0
1 0 1  0
1 1 0  1
2 0 2  0
2 1 1  0 
```

解释：0 能被三整除。`0 >> 1 + 0 = 0`. 重复使用`S = (S >> 1 + I) % 3`and `O = 1`if `S == 0`。

`S'`与上面不同，但 O 的工作原理相同，因为`S'`对于相同的情况（00 和 11）为 0。由于 O 在两种情况下都相同，O_LSB = O_MSB，所以要使 MSB 与 LSB 一样短，反之亦然，只需使用两者中最短的。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-05-10T08:14:02.130

这是一个简单的手动操作方法。由于 1 = 2 ² mod 3，对于每个正整数，我们得到 1 = 2 ^(2n mod 3。)此外，2 = 2 ^(2n+1) mod 3。因此，可以通过计算奇数位位置的 1 位来确定整数是否可被 3 整除，将此数字乘以 2，将偶数位位置的 1 位的数量相加。到结果并检查结果是否能被 3 整除。

示例：57 [10] =111001 [2]。奇数位有 2 位，偶数位有 2 位。2*2 + 2 = 6 可以被 3 整除。因此 57 可以被 3 整除。

这也是解决问题 c) 的一个想法。如果反转二进制整数的位顺序，则所有位都保持在偶数/奇数位置，或者所有位都发生变化。因此，将整数 n 的位顺序反转结果是一个整数，当且仅当 n 可被 3 整除时，该整数可被 3 整除。因此，问题 a) 的任何解决方案都适用于问题 b)，反之亦然。嗯，也许这可以帮助找出哪种方法更快......

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-05-10T07:30:27.883

您需要使用算术模 3 进行所有计算。这就是方法

高位：

```
number=0
while(!eof)
    n=input()
    number=(number *2 + n) mod 3

if(number == 0)
    print divisible 
```

低位：

```
number = 0;
multiplier = 1;
while(!eof)
    n=input()
    number = (number + multiplier * n) mod 3
    multiplier = (multiplier * 2) mod 3

if(number == 0)
   print divisible 
```

这是一般的想法...

现在，您的职责是了解**为什么**这是正确的。

是的，自己做作业；）

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-05-10T07:35:50.680

这个想法是数字可以任意增长，这意味着你不能`mod 3`在这里使用，因为你的数字会增长到超出你的整数类的容量。

这个想法是注意数字发生了什么。如果你在右边添加位，你实际上在做的就是向左移动一位并添加新的位。

左移与乘以 2 相同，添加新位是添加 0 或 1。假设我们从 0 开始，我们可以根据最后一个数字的模 3 递归地执行此操作。

```
last | input || next | example
------------------------------------
0    | 0     || 0    | 0 * 2 + 0 = 0
0    | 1     || 1    | 0 * 2 + 1 = 1
1    | 0     || 2    | 1 * 2 + 0 = 2
1    | 1     || 0    | 1 * 2 + 1 = 0 (= 3 mod 3)
2    | 0     || 1    | 2 * 2 + 0 = 1 (= 4 mod 3)
2    | 1     || 2    | 2 * 2 + 1 = 2 (= 5 mod 3) 
```

* * *

现在让我们看看当你向左边添加一点时会发生什么。首先，请注意：

2 ^(2n)模 3 = 1

和

2 ^(2n+1)模 3 = 2

所以现在我们必须根据当前迭代是奇数还是偶数向 mod 添加 1 或 2。

```
last | n is even? | input || next | example
-------------------------------------------
d/c  | don't care | 0     || last | last + 0*2^n = last
0    | yes        | 1     || 0    | 0 + 1*2^n = 1 (= 2^n mod 3)
0    | no         | 1     || 0    | 0 + 1*2^n = 2 (= 2^n mod 3)
1    | yes        | 1     || 0    | 1 + 1*2^n = 2
1    | no         | 1     || 0    | 1 + 1*2^n = 0 (= 3 mod 3)
1    | yes        | 1     || 0    | 2 + 1*2^n = 0
1    | no         | 1     || 0    | 2 + 1*2^n = 1 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-10T07:25:41.530

实际上，LSB 方法实际上会使这更容易。在 C 中：

MSB方法：

```
/* 
Returns 1 if divisble by 3, otherwise 0
Note: It is assumed 'input' format is valid
*/
int is_divisible_by_3_msb(char *input) {
  unsigned value = 0;
  char *p = input;
  if (*p == '1') {
    value &= 1;
  }
  p++;
  while (*p) {
    if (*p != ',') {
      value <<= 1;
      if (*p == '1') {
        ret &= 1;
      }
    }
    p++;
  }
  return (value % 3 == 0) ? 1 : 0;
} 
```

LSB方法：

```
/* 
Returns 1 if divisble by 3, otherwise 0
Note: It is assumed 'input' format is valid
*/
int is_divisible_by_3_lsb(char *input) {
  unsigned value = 0;
  unsigned mask = 1;
  char *p = input;
  while (*p) {
    if (*p != ',') {
      if (*p == '1') {
        value &= mask;
      }
      mask <<= 1;
    }
    p++;
  }
  return (value % 3 == 0) ? 1 : 0;
} 
```

就我个人而言，我很难相信其中一个会与另一个有很大不同。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-02-09T23:39:57.957

```
input  "0":       (0)  output 1
inputs "1,0,0":   (4)  output 0
inputs "1,1,0,0": (6)  output 1 
```

这最后的输入不应该是`12`，还是我误解了这个问题？

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-05-10T07:52:41.013

我认为 Nathan Fellman 在 a 和 b 部分上是正确的（除了 b 需要一个额外的状态：你需要跟踪你的数字位置是奇数还是偶数）。

我*认为*C 部分的诀窍是`last`在每一步都否定价值。即 0 到 0，1 到 2，2 到 1。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-05-14T14:11:06.233

一个数能被 3 整除，如果它的数字之和能被 3 整除。

所以你可以添加数字并得到总和：

*   如果总和大于或等于 10，则使用相同的方法
*   如果它是 3, 6, 9 那么它是可整除的
*   如果总和不同于 3、6、9，则它不可整除

# javascript - 遍历所有 页面上的标签

> ID：844869
> 
> 赞同：35
> 
> 时间：2009-05-10T07:28:08.920
> 
> 标签：javascript, html, recursion, iteration

我想使用 Javascript 浏览页面上的所有元素，看看它们是否有属性集。有没有一种简单的方法可以做到这一点，还是我必须使用递归解决方案？

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2009-05-10T07:30:00.647

您可以使用：

```
var divs = document.getElementsByTagName("div");
for(var i = 0; i < divs.length; i++){
   //do something to each div like
   divs[i].innerHTML = "something new...";
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-10T07:36:39.867

要在页面上的一个或多个所有 div 中查找属性：

```
var divs = document.getElementsByTagName("div"), i=divs.length;
while (i--) {
   if (divs[i].getAttribute([yourProperty]) === 'yourValue'){
      //do something
   } 
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-10T07:37:50.220

您也许还可以使用选择器引擎，例如[Sizzle](http://sizzlejs.com/)。

史蒂夫

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-01-09T14:48:32.857

### 使用 JS`ES6` [`For ... of`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/for...of)

```
for (elem of document.getElementsByTagName('div')){
  elem.style.marginTop='20px'
} 
```

# haskell - 如何在 Haskell 中创建两个具有内部状态的相互生产者/消费者？

> ID：844870
> 
> 赞同：3
> 
> 时间：2009-05-10T07:28:18.280
> 
> 标签：haskell, artificial-intelligence, abstraction, modularity, agent

我有一个代理，它接受状态并返回动作，同时保持状态/动作对的效用的内部表示。我还有一个环境，可以采取行动并返回状态/奖励对。

我需要能够将代理设置为开始状态，然后不断地从代理 -(action)-> environment -(state, reward)-> agent -(action)->... 但是，内部状态（每次迭代都需要更新）需要保持私有（即在代理或环境中）。这意味着我不能简单地将环境调用为代理中的一个函数，使用状态和动作作为参数。

我有点像 Haskell noobie，所以我什至不确定这是否可能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-10T08:22:56.243

您需要决定哪个代理和环境位于“顶部” - 让我们假设对于这个答案的其余部分，它是顶部的环境调用代理，因为这通常最有意义。

您可以使用模块系统将代理的数据表示保持为私有 - 只需导出数据类型名称而无需任何内部结构。

```
module Agent (AgentState, other_stuff) where 
```

与

```
module Agent (AgentState(..), other_stuff) where 
```

如果代理还需要传递环境的状态（尽管我看不出有任何理由这样做是必要的，因为环境可以自己跟踪它），然后使代理函数具有多态性，以便它们可以传递*任何*状态type - 然后环境可以在不暴露其表示的情况下传递它喜欢的任何内容。

也应该可以使用状态单子来更好地控制状态发生的事情，例如防止环境复制代理给它的状态并以相同的状态重复调用代理，但如果你是新手Haskell 最好先在没有单子的情况下获得一些经验。（并不是说单子特别可怕或任何东西，但它们确实对你隐藏了细节，所以更难看到发生了什么。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-10T20:16:32.700

两个问题：

*   如果代理必须使用状态来计算动作，那么您如何期望对代理保密的状态表示？

*   如果环境期望在给定动作的情况下产生状态（和奖励），那么您如何期望对环境的状态表示保密？

这两种方法都是可能的，但每种方法都必须涉及某种抽象，用于查询状态或创建状态。我对这个设计没有好感。

这将有助于通过以下方式澄清问题

*   为感兴趣的函数提供类型签名

*   确定您不希望将状态表示*暴露*给哪些函数。

PS 这些困难与 Haskell 是完全不同的，并且无论选择哪种实现语言都存在问题（前提是实现语言支持*某种*形式的隐私）。

# django - Django 中的准确页面浏览量

> ID：844879
> 
> 赞同：10
> 
> 时间：2009-05-10T07:36:41.753
> 
> 标签：django, visitor-statistic

有什么好的方法可以准确计算页面被查看的次数？

我正在使用 Django。具体来说，我不想刷新页面以增加计数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-10T07:52:17.970

据我所知，目前没有浏览器向服务器发送任何类型的消息/标头，说明请求是否来自刷新。

我可以看到不计算用户刷新页面的唯一方法是跟踪用户查看页面的 IP 和时间，然后如果用户最后一次查看该页面的时间少于 30 分钟，例如，您会将其视为刷新*而不*增加页面查看次数。

无论如何， IMO 大多数页面刷新*都应该*算作页面视图，因为我刷新的唯一原因是查看可能已添加的新数据，或者浏览器崩溃后偶尔意外刷新/重新加载（上述方法会忽略）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-10T08:02:24.420

您可以为每个用户提供在一天结束时到期的 cookie，其中包含一个唯一编号。如果他重新加载页面，您可以检查她当天是否已经被计算在内。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-10T08:06:28.797

您可以创建一个包含页面的唯一访问者的表格，例如 VisitorIP + X-Forwarded-For 内容、User-Agent 字符串以及某种类型的 PageID。如果数据本身无关紧要，您可以从这些值创建一个 md5/sha1 哈希（当然除了 PageID 之外）。但是请注意，此表将增长得非常快。

我建议不要为此设置 cookie。它们的大小有限，并且用户访问的页面很多，您可能会达到该限制并使解决方案不可靠。此外，它也使得在客户端缓存此类页面变得更加困难（请参阅[Cacheability](http://www.mnot.net/cacheability/)），因为它变成了交互式内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-10T10:12:58.290

您可以编写一个 django 中间件并捕获 request.url，然后设置一个带有 url / 访问列的表。注意并发更新的事务。如果你有负载问题，你可以使用 memcached 和 incr 或 add 函数并定期更新数据库表以避免事务锁。

# java - j2ME 的最快 Dijkstra 算法

> ID：844881
> 
> 赞同：1
> 
> 时间：2009-05-10T07:39:10.687
> 
> 标签：java, algorithm, java-me, dijkstra

任何人都可以帮助我更快地实现 Dijkstra 算法的 j2ME 吗？我有两个循环，一个在另一个里面。像这样

```
while(for each item in Q)
{
    //...do something.

    //the following loop is to find the minimum
    for(all un-visited nodes in Q)
    {
       //.. do something to get min.
    }
} 
```

我有将近 23000 个节点和 50000 条边连接它们......在下面提到的所有改进之后，内部循环平均执行 169330131 次。在我的 w910i 手机上完成这需要 5 分钟，而在我的模拟器上则需要几分钟以上。这对我来说太过分了。有什么改进的建议吗？我已经实施了以下改进。

1.  使用数组代替向量。
2.  确保内部循环不考虑访问节点。我所有访问过的节点都在数组的末尾，我节点知道计数。所以，我可以很容易地完全跳过它们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-10T07:59:16.410

我认为您在问题中的算法是错误的。内循环应该查看外循环中项目的每个未访问的邻居：

```
for each (item in Q)
{
  for each (unvisited neighbour of item)
  {
  }
} 
```

将其与[wikipedia 中的伪代码实现进行](http://en.wikipedia.org/wiki/Dijkstra%27s_algorithm)比较：

```
 1  function Dijkstra(Graph, source):
 2      for each vertex v in Graph:           // Initializations
 3          dist[v] := infinity               // Unknown distance function from source to v
 4          previous[v] := undefined          // Previous node in optimal path from source
 5      dist[source] := 0                     // Distance from source to source
 6      Q := the set of all nodes in Graph
        // All nodes in the graph are unoptimized - thus are in Q
 7      while Q is not empty:                 // The main loop
 8          u := vertex in Q with smallest dist[]
 9          if dist[u] = infinity:
10              break                         // all remaining vertices are inaccessible
11          remove u from Q
12          for each neighbor v of u:         // where v has not yet been removed from Q.
13              alt := dist[u] + dist_between(u, v) 
14              if alt < dist[v]:             // Relax (u,v,a)
15                  dist[v] := alt
16                  previous[v] := u
17      return previous[] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-10T07:47:02.167

您的实施有问题。它的复杂度是 O(E + V * log2 (V))。

这意味着 50000 + 23000 * ~15 = 400 000 次迭代。

您当前的复杂性几乎是 O(V^2)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-10T08:12:56.487

我提到了这个算法。我在其他地方找到了一个更简单的算法。请注意，如果我必须在 Wikipedia 中实现一个，则有两个内部循环。

```
while Q is not empty: //Outer loop. 
  u := vertex in Q with smallest dist[];// First inner loop. 
  .... 
  for each neighbor v of u: //Second inner loop. 
```

第二个内环较小。它最多可以执行 4-5 次，因为每个节点最多有 5 条边。具有超过 2 条边的节点数量为 23000 个节点中的 1000 个。因此，内部循环的执行时间可以忽略不计。第一个内循环是问题所在。寻找最小的节点。由于我必须在 j2ME 设备上执行此操作，因此我必须使其占用尽可能少的空间。

# sqlite - Sqlite 插入具有唯一名称，获取 id

> ID：844885
> 
> 赞同：6
> 
> 时间：2009-05-10T07:42:48.307
> 
> 标签：sqlite, unique, identity, auto-generate

我有一个要插入数据库的字符串列表。它们必须是独一无二的。当我插入时，我希望他们的 ID（用作另一个表中的外键）所以我使用 last_insert_rowid。我有2个问题。

1.  如果我使用替换，他们的 ID（整数主键）会更新，这会破坏我的数据库（条目指向不存在的 ID）
2.  如果我使用忽略，rowid 不会更新，所以我没有得到正确的 ID

我如何获得他们的身份证？如果我不需要，我不想使用 select 语句来检查并插入字符串（如果它不存在）。我该怎么做？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2011-01-27T20:32:57.577

当发生 UNIQUE 约束违规时，REPLACE 算法会在插入或更新当前行之前删除导致约束违规的预先存在的行，并且命令会继续正常执行。这会导致 rowid 更改并产生以下问题

```
Y:> **sqlite3 test**  
SQLite version 3.7.4  
Enter ".help" for instructions  
Enter SQL statements terminated with a ";"  
sqlite> **create table b (c1 integer primary key, c2 text UNIQUE);**  
sqlite> **insert or replace into b values (null,'test-1');**  
sqlite> **select last_insert_rowid();**  
1  
sqlite> **insert or replace into b values (null,'test-2');**  
sqlite> **select last_insert_rowid();**  
2  
sqlite> **insert or replace into b values (null,'test-1');**  
sqlite> **select last_insert_rowid();**  
3  
sqlite> **select * from b;**  
2|test-2  
3|test-1 
```

解决方法是更改​​ c2 列的定义，如下所示

```
create table b (c1 integer primary key, c2 text UNIQUE ON CONFLICT IGNORE); 
```

并从您的插入中删除“或替换”子句；

然后在插入后进行测试时，您将需要执行以下 sql：`select last_insert_rowid(), changes();`

```
sqlite> **create table b (c1 integer primary key, c2 text UNIQUE ON CONFLICT IGNORE);**  
sqlite> **insert into b values (null,'test-1');**  
sqlite> **select last_insert_rowid(), changes();**  
1|1  
sqlite> **insert into b values (null,'test-2');**  
sqlite> **select last_insert_rowid(), changes();**  
2|1  
sqlite> **insert into b values (null,'test-1');**  
sqlite> **select last_insert_rowid(), changes();**  
2|0 
```

第三次插入后更改的返回值将通知您的应用程序，您需要查找“test-1”的rowid，因为它已经在文件中。当然，如果这是一个多用户系统，您还需要将所有这些都包装在一个事务中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-01-27T21:50:40.753

我目前使用以下

```
insert into tbl(c_name) select 'val' where not exists(select id from tbl where c_name ='val');
select id from tbl where c_name ='val'; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-10T08:27:07.653

通过“它们必须是唯一的”，它们是否意味着您确定它们是，或者如果它们不是，您想要一个错误作为结果？如果您只是将字符串本身作为其表中的键，那么我不明白 1 或 2 可能是一个问题——如果出现不需要的重复，您将得到一个错误，否则是正确的 ID。也许你可以用你正在使用的 SQL 代码的一个小例子来澄清你的问题，有问题的表，你正在观察什么行为，以及你想要什么行为......？

已编辑：感谢您的编辑，但我仍然不清楚 SQL 给您带来了什么问题！如果您的表来自，例如：

```
CREATE TABLE Foo(
  theid INTEGER PRIMARY KEY AUTOINCREMENT,
  aword TEXT UNIQUE ABORT
  ) 
```

那么任何插入重复单词的尝试都会失败（`ABORT`关键字是可选的，因为它是 的默认值`UNIQUE`）——这不是你*想要*的，因为你说“必须是唯一的”，也就是说，如果它们是错误的不是吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-01-24T10:34:20.197

您的问题的正确答案是：这不能在 sqlite 中完成。您必须进行额外的选择查询。引用last_insert_rowid的[文档：](https://sqlite.org/c3ref/last_insert_rowid.html)

> 由于违反约束而失败的 INSERT 不是成功的 INSERT，并且不会更改此例程返回的值。因此，当插入失败时，INSERT OR FAIL、INSERT OR IGNORE、INSERT OR ROLLBACK 和 INSERT OR ABORT 不会更改此例程的返回值

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-02-05T13:08:55.907

在 2022 年遇到同样的问题，但是从 SQLite3 版本 3.35.0 (2021-03-12) 开始，我们有[RETURNING](https://www.sqlite.org/lang_returning.html)。结合[UPSERT](https://www.sqlite.org/lang_upsert.html)，现在可以实现这一点

```
sqlite> create table test (id INTEGER PRIMARY KEY, text TEXT UNIQUE);
sqlite> insert into test(text) values("a") on conflict do update set id = id returning id;
1
sqlite> insert into test(text) values("a") on conflict do update set id = id returning id;
1
sqlite> insert into test(text) values("b") on conflict do update set id = id returning id;
2
sqlite> insert into test(text) values("b") on conflict do update set id = id returning id;
2
sqlite> select * from test;
1|a
2|b
sqlite> insert into test(text) values("b") on conflict do nothing returning id;
sqlite> 
```

可悲的是，这仍然是一种解决方法，而不是一个优雅的解决方案......在冲突中，插入变成了更新。这意味着您的更新触发器将触发，因此您可能希望远离此！

当插入转换为更新时，它*需要*做一些事情（参见链接）。然而，我们不想做任何事情，所以我们通过`id`自身更新来做一个空操作。然后，`returning id`给我们想要的东西。

笔记：

*   我们的 no-op 实际上会进行更新，因此会花费时间，并且触发器`on update`会触发。但是没有触发器，它对数据没有影响
*   Using `on conflict do nothing returning id` does not fail, but does not return the id.
*   If usable (again, check your triggers), and if all your tables use the primary key `id`, then this technique does not need any specialization: just copy/paste `on conflict do update set id = id returning id;`

# python - 将动态函数定义为字符串

> ID：844886
> 
> 赞同：1
> 
> 时间：2009-05-10T07:44:22.810
> 
> 标签：python

我有一个我每天使用的小python脚本......它基本上读取一个文件，对于每一行我基本上应用不同的字符串函数，如strip（），replace（）等......我不断编辑文件和评论更改功能。根据我正在处理的文件，我使用不同的功能。例如，我有一个文件，对于每一行，我需要使用 line.replace(' ','') 和 line.strip()...

将所有这些作为我脚本的一部分的最佳方法是什么？所以我可以说为每个函数分配数字，然后对每一行应用函数 1 和 4。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-10T08:02:55.293

可以将字符串操作映射到数字：

```
>>> import string
>>> ops = {1:string.split, 2:string.replace}
>>> my = "a,b,c"
>>> ops[1](",", my)
[',']
>>> ops[1](my, ",")
['a', 'b', 'c']
>>> ops[2](my, ",", "-")
'a-b-c'
>>> 
```

但也许操作的字符串描述会更具可读性。

```
>>> ops2={"split":string.split, "replace":string.replace}
>>> ops2["split"](my, ",")
['a', 'b', 'c']
>>> 
```

注意：`string`您可以使用`str`type 来获得相同的效果，而不是使用模块。

```
>>> ops={1:str.split, 2:str.replace} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-10T08:18:04.087

如果您坚持使用数字，那么您不能比 dict（如 gimel 建议的那样）或函数列表（索引为零及以上）做得更好。但是，对于名称，您不一定需要辅助数据结构（例如 gimel 建议的 dict），因为您可以简单地使用 getattr 从对象本身或其类型中检索要调用的方法。例如：

```
def all_lines(somefile, methods):
  """Apply a sequence of methods to all lines of some file and yield the results.
  Args:
    somefile: an open file or other iterable yielding lines
    methods: a string that's a whitespace-separated sequence of method names.
        (note that the methods must be callable without arguments beyond the
         str to which they're being applied)
  """
  tobecalled = [getattr(str, name) for name in methods.split()]
  for line in somefile:
    for tocall in tobecalled: line = tocall(line)
    yield line 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-10T10:04:52.210

首先，许多字符串函数——包括strip 和replace——都被[弃用](http://docs.python.org/library/string.html#deprecated-string-functions "不推荐使用的字符串函数")了。以下答案改为使用字符串方法。（代替`string.strip(" Hello ")`，我使用 的等价物`" Hello ".strip()`。）

这是一些可以为您简化工作的代码。以下代码假定您在字符串上调用任何方法，该方法将返回另一个字符串。

```
class O(object):
    c = str.capitalize
    r = str.replace
    s = str.strip

def process_line(line, *ops):
    i = iter(ops)
    while True:
        try:
            op = i.next()
            args = i.next()
        except StopIteration:
            break
        line = op(line, *args)
    return line 
```

该类的`O`存在是为了使您高度缩写的方法名称不会污染您的命名空间。当您想添加更多字符串方法时，您可以以`O`与给定格式相同的格式添加它们。

该`process_line`函数是所有有趣的事情发生的地方。首先，这里是参数格式的描述：

*   第一个参数是要处理的字符串。
*   其余参数必须成对给出。
    *   该对的第一个参数是一个字符串方法。在此处使用缩短的方法名称。
    *   该对的第二个参数是一个列表，表示该特定字符串方法的参数。

该`process_line`函数返回执行所有这些操作后出现的字符串。

下面是一些示例代码，展示了如何在自己的脚本中使用上述代码。我已经将`process_line`多行的参数分开以显示参数的分组。当然，如果您只是在日常脚本中使用此代码，您可以将所有参数压缩到一行；这实际上使它更容易阅读。

```
f = open("parrot_sketch.txt")
for line in f:
    p = process_line(
        line,
        O.r, ["He's resting...", "This is an ex-parrot!"],
        O.c, [],
        O.s, []
    )
    print p 
```

当然，如果您非常特别想使用数字，您可以将您的函数命名为`O.f1`, `O.f2`, `O.f3`... 但我假设这不是您的问题的精神。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-10T18:57:59.350

要将名称（或数字）映射到不同的字符串操作，我会做类似的事情

```
OPERATIONS = dict(
    strip = str.strip,
    lower = str.lower,
    removespaces = lambda s: s.replace(' ', ''),
    maketitle = lamdba s: s.title().center(80, '-'),
    # etc
)

def process(myfile, ops):
    for line in myfile:
        for op in ops:
            line = OPERATIONS[op](line)
        yield line 
```

你这样使用

```
for line in process(afile, ['strip', 'removespaces']):
    ... 
```

# iphone - 从“子视图”调用 UIViewController

> ID：844895
> 
> 赞同：1
> 
> 时间：2009-05-10T07:48:49.900
> 
> 标签：iphone, uiviewcontroller, view, navigation

我有一个 UIViewController，它在加载时会加载这个..

```
MapViewController *mapController = [[MapViewController alloc] initWithNibName:@"MapView" bundle:nil];
    self.mapViewController = mapController;
    [self.view insertSubview:mapController.view atIndex:0];
    [mapController release]; 
```

我还有一个切换视图按钮，可以更改为表格视图....

```
if (self.tableViewController ==nil)
    {
        TableViewController *tableController = [[TableViewController alloc] initWithNibName:@"TableView" bundle:nil];
        self.tableViewController = tableController;
    [tableController release];
    //[self.view insertSubview:detailController atIndex:0];
    }

    if (self.mapViewController.view.superview == nil)
    {
        [tableViewController.view removeFromSuperview];
        [self.view insertSubview:mapViewController.view atIndex:0];
    }
    else
    {
        [mapViewController.view removeFromSuperview];
        [self.view insertSubview:tableViewController.view atIndex:0];
    } 
```

我正在尝试根据在表视图中选择一行将视图更改为详细视图，但我根本不知道如何调用它。我所有的方法似乎都失败了！请帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-10T08:50:30.030

您应该查看用于处理行选择的类是 UITableViewDelegate，它具有以下方法：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-10T09:04:36.830

将 UITableViewDelegate 协议添加到您的控制器类。

```
@interface myTableViewController : UITableViewController <UITableViewDelegate> 
```

当您创建表 veiw 控制器时，将其委托设置为您的控制器，使用：

```
myTableViewController.delegate = self; // Assuming your setup code runs within the table view controller 
```

在您的 tableViewController 中，实现 didSelectRowAtIndexPath：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
int rowSelected = [indexPath indexAtPosition:0]; // Assuming your UITableView has a single section. 
```

# sql - SQL Server 2005 排序规则问题

> ID：844896
> 
> 赞同：2
> 
> 时间：2009-05-10T07:50:15.247
> 
> 标签：sql, sql-server-2005, collation

我有两个表，它们使用不同的排序规则。不允许连接具有不同排序规则的表中的列，例如以下 SQL 是不允许的，

```
select table1column1 + table2column2 from ... 
```

我的问题是，如何在不破坏表数据的情况下更改表的排序规则？

提前谢谢，乔治

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-10T08:01:05.377

如果需要，您可以随时更改列排序规则。

例如

```
select table1column1 collate database default  + table2column2 collate database default from ... 
```

“数据库默认值”可以是您想要使用的任何排序规则。

您可以使用永久更改列的排序规则

```
ALTER TABLE ... ALTER COLUMN Table1Column1
            varchar(50) COLLATE Latin1_General_CI_AS NOT NULL
GO 
```

# windows - 如何确定消息类型是已发送还是已发布？

> ID：844899
> 
> 赞同：1
> 
> 时间：2009-05-10T07:55:38.057
> 
> 标签：windows, winapi, capture, messages

我知道某些消息类型直接发送到窗口过程，而其他消息类型则发布到线程的消息队列，但我还没有找到任何方法来确定是否发送或发布消息。

MSDN 有一半的帮助；它解释[了发生了什么，](http://msdn.microsoft.com/en-us/library/ms644927.aspx#nonqueued_messages)但它给出的例子可能并不详尽。

是否有明确的已发送消息与已发布消息列表，或确定消息类型的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-10T08:19:44.910

使用`InSendMessage`或`InSendMessageEx`确定[您是否正在处理通过调用](http://msdn.microsoft.com/en-us/library/ms644941(VS.85).aspx)`SendMessage`函数发送的消息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-10T19:35:49.990

有些消息既不张贴也不发送。WM_PAINT、WM_TIMER 和其他一些情况就是如此。当发布的消息队列为空时，它们仅由 GetMessage 返回。

我不确定您要挂钩哪些应用程序，但是如果您不得不问这样的问题，那我/我有点害怕。对于开发人员来说，没有什么比花时间在用户报告的崩溃上更令人沮丧的了，只是发现原因是来自其他一些注入行为不端代码的应用程序。小心踩！

此外，Spy++（Visual Studio 附带的工具）将显示为任何给定的实时 Windows 应用程序发布/发送/接收了哪些消息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-10T08:00:41.617

记录每条消息的 MSDN 页面应被视为权威来源：

> [该`WM_LBUTTONDOWN`消息**发布**时...](http://msdn.microsoft.com/en-us/library/ms645607.aspx)
> 
> [`WM_SETFOCUS`消息在...之后**发送**到一个窗口](http://msdn.microsoft.com/en-us/library/ms646283.aspx)

等等

# email - 为什么 Subversion 不允许“。” 和用户名中的“@”？或者是吗？

> ID：844906
> 
> 赞同：3
> 
> 时间：2009-05-10T08:02:43.983
> 
> 标签：email, svn

我们希望在所有开发工具中使用相同的用户 ID，但是 subversion 的限制不允许我们使用电子邮件地址作为用户名。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-10T10:26:03.343

这实际上取决于您如何设置 Subversion。svnserve 的标准 Subversion 内置身份验证可能不允许 . 和@（我没试过）。我已经使用 Apache 而不是内置的 svnserve 设置了我的 Subversion 存储库。在 Apache 下，您可以使用标准的 Apache 访问控制，例如 htpasswd 文件，甚至可以与 LDAP 或[Microsoft Active Directory](http://www.jejik.com/articles/2007/06/apache_and_subversion_authentication_with_microsoft_active_directory/)集成。然后，您可以为您的 Subversion 用户使用电子邮件地址或 AD 登录名。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-10T10:59:08.910

好吧，既然您可以创建由多个用户组成的组，然后使用@<groupname> 引用它们，我想在常规用户名中使用@ 可能是个问题。

这是来自创建新 svn 存储库时生成的默认 authz 文件中的示例：

```
[groups]
harry_and_sally = harry,sally
[repository:/baz/fuz]
@harry_and_sally = rw 
```

这为 harry_and_sally 组中的用户提供了对 /baz/fuz 中存储库的读写权限。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-05T19:58:37.853

Subversion 实际上在内部使用 UTF-8 来存储它的所有数据，包括用户名，所以对你可以命名你的用户没有任何限制。例如，我刚刚与用户创建了一个提交：

```
'Й, ק,‎ م, ๗, あ, 叶, 葉, and 말.' 
```

问题是，其他程序可能会为特殊目的保留某些字符，例如 svn passwd 文件中的 [、= 和 #。Subversion 可以处理更广泛的用户名，但特定的文件格式不能。如果您发现自己无法使用某些字符，这是链中某些其他链接的限制，例如 Apache 或您的 IDE 或您的数据库，或其他任何东西。

这并没有太大帮助，因为您可能无法轻松修复导致此问题的任何原因或切换工具，但这就是这些天“奇怪”字符的状态。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-10T08:09:02.707

它确实允许“。” 在用户名中，从未尝试过@。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-10T12:12:11.067

在我的 $JOB 公司电子邮件地址是 Subversion 的标准用户名，所以它必须有效。

然而，在我的团队中，我们坚持给予我们（也是公司范围内的）Windows 用户名，这些用户名往往不超过 8 个字符。像这样的用户名`Reallylongfirst.Andlastname@amazing-products.com`在标准 GUI 日志查看器中的可用性很差，并且不能很好地与`svn blame`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-11T17:09:06.740

构造包含用户名的 URI 的常用方法是 `protocol://user@host:port/path`. svn 也使用这个，所以这个`@`字符很特殊。我没有尝试过，但我相当有信心您可以逃脱它（如`%40`）以使其工作。但是，IMO 使用完整的电子邮件地址作为用户名是一个相当糟糕的主意。如果您在公司内部，为什么不能使用本地部分？对于所有用户来说，其他一切很可能都是相同的，因此您只是在重复信息——而且它不能很好地与日志视图配合使用。

另见[RFC 3986](https://www.rfc-editor.org/rfc/rfc3986#section-3.2.1)。

# c# - Java 方法 getGlyphOutline 在 C# 中是否有等价物？

> ID：844913
> 
> 赞同：1
> 
> 时间：2009-05-10T08:09:40.317
> 
> 标签：c#, java, .net

我正在将一些 Java 代码转换为 C#。此代码使用来自 GlyphVector 的 getGlyphOutline。知道 C# 或 .NET 中是否有等价物吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-10T08:37:51.637

您将不得不使用 P/Invoke，请参阅[GetGlyphOutline (gdi32)](http://www.pinvoke.net/default.aspx/gdi32/GetGlyphOutline.html?diff=y)

# c++ - C++ html 表单

> ID：844914
> 
> 赞同：0
> 
> 时间：2009-05-10T08:09:44.653
> 
> 标签：c++, html, cgi

我如何使用 c++ 从 HTML 页面获取表单数据，就 post 和 get 的基础知识而言？

EIDT1：在 Windows 上使用 apache 2 的 CGI，我已经用 apache 配置和测试了 c++。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-10T08:20:25.970

从 HTTP 请求访问表单数据的最简单方法是通过[CGI](http://en.wikipedia.org/wiki/Common_Gateway_Interface)。这涉及读取使用[getenv](http://www.cplusplus.com/reference/clibrary/cstdlib/getenv/)函数完成的环境变量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-10T08:18:46.050

首先看一下[webtoolkit](http://www.webtoolkit.eu/wt#/)。
你可能想用它来让你的生活更轻松。
其次，您可以阅读有关网络协议的信息。
第三看看你的网络服务器文档，他们可能会提供这样的接口来创建一个允许你读取 HTTP 套接字和通过它发送的数据的[守护进程。](http://en.wikipedia.org/wiki/Daemon_(computer_software))

在另一个笔记中，下次你写一个问题时，尽量详细说明。
解释用例并提供测试用例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-10T11:55:37.427

您可以使用 CgiCC 库来满足您的需求。您也可以尝试一些 C++ Web 框架，例如 CppCMS。

# windows - 在处理程序中关闭消息调度

> ID：844920
> 
> 赞同：1
> 
> 时间：2009-05-10T08:16:04.373
> 
> 标签：windows, winapi, directshow

我正在开发一个完全单线程的 Windows 程序，对任何数据结构都没有保护。但是，该程序使用 DirectShow API 打开自己的内​​部消息调度，例如 IVideoWindow::put_Visible。因此调用 IVideoWindow::put_Visible 方法的事件处理函数给了其他事件处理函数破坏其数据的机会。

有没有办法防止在 API 中发送这种消息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-04T19:59:42.140

这个问题对我来说有点不清楚。您是在谈论在内部进入模式消息循环的 API 吗？这是否会给您带来某种重入问题？如果是这种情况，那么可能有更好的方法来解决您的问题。如果 API 进入模态循环，那么毫无疑问是有充分理由的，您应该允许它这样做。（在您的情况下，我猜 DirectShow 在内部与另一个 COM 对象进行通信。）如果编写得当，模态循环仍会将消息发送到同一线程上的其他窗口。

无论如何，如果您真的想这样做，请按以下步骤操作：

```
PostQuitMessage( 0 ); // Signal quit to force the upcoming loop to exit
APIFunc(); // Enters modal loop internally
MSG msg;
PeekMessage( &msg, NULL, WM_QUIT, WM_QUIT, PM_REMOVE ); // Eat the next WM_QUIT 
```

最后一步很重要。当模态循环由于 WM_QUIT 消息而退出时，它必须在退出后发布自己的退出消息（以便应用程序知道退出）。如果你不吃它，你的应用程序将退出。

# objective-c - 将焦点移动到 NSTableView 中新添加的记录

> ID：844933
> 
> 赞同：13
> 
> 时间：2009-05-10T08:27:27.653
> 
> 标签：objective-c, cocoa, macos, nstableview

我正在编写一个使用 Core Data 来控制一些 NSTableViews 的应用程序。我有一个添加按钮，可以在 NSTableView 中创建一条新记录。单击此按钮时，如何使焦点移至新记录，以便立即键入其名称？这与 iTunes 中的想法相同，在单击添加播放列表按钮后，键盘焦点立即移动到新行，因此您可以键入播放列表的名称。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-10T10:08:33.480

好的，首先，如果您还没有，您需要为您的应用程序创建一个控制器类。在控制器类的接口中为您`NSArrayController`的对象存储在其中添加一个出口，并为显示您的对象添加一个出口。`NSTableView`

```
IBOutlet NSArrayController *arrayController;
IBOutlet NSTableView *tableView; 
```

将这些插座连接到IB`NSArrayController`和`NSTableView`IB。然后您需要创建一个`IBAction`在按下“添加”按钮时调用的方法；调用它`addButtonPressed:`或类似的东西，在你的控制器类接口中声明它：

```
- (IBAction)addButtonPressed:(id)sender; 
```

并使其成为 IB 中“添加”按钮的目标。

现在你需要在你的控制器类的实现中实现这个动作；此代码假定您添加到数组控制器的对象是`NSString`s；如果不是，则将`new`变量的类型替换为您要添加的任何对象类型。

```
//Code is an adaptation of an excerpt from "Cocoa Programming for
//Mac OS X" by Aaron Hillegass
- (IBAction)addButtonPressed:(id)sender
{
//Try to end any editing that is taking place in the table view
NSWindow *w = [tableView window];
BOOL endEdit = [w makeFirstResponder:w];
if(!endEdit)
  return;

//Create a new object to add to your NSTableView; replace NSString with
//whatever type the objects in your array controller are
NSString *new = [arrayController newObject];

//Add the object to your array controller
[arrayController addObject:new];
[new release];

//Rearrange the objects if there is a sort on any of the columns
[arrayController rearrangeObjects];

//Retrieve an array of the objects in your array controller and calculate
//which row your new object is in
NSArray *array = [arrayController arrangedObjects];
NSUInteger row = [array indexOfObjectIdenticalTo:new];

//Begin editing of the cell containing the new object
[tableView editColumn:0 row:row withEvent:nil select:YES];
} 
```

当您单击“添加”按钮时，这将被调用，并且将开始编辑新行第一列中的单元格。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-08T17:40:29.810

我相信以这种方式实现它是一种更简单、更合适的方法。

```
-(void)tableViewSelectionDidChange:(NSNotification *)notification {
    NSLog(@"%s",__PRETTY_FUNCTION__);
    NSTableView *tableView = [notification object];
    NSInteger selectedRowIndex = [tableView selectedRow];
    NSLog(@"%ld selected row", selectedRowIndex);

    [tableView editColumn:0 row:selectedRowIndex withEvent:nil select:YES]; 
```

IE

1.  实施`tableViewSelectionDidChange:(NSNotification *)notification`
2.  获取选定的行索引
3.  `editColumn:(NSInteger)column row:(NSInteger)row withEvent:(NSEvent *)theEvent select:(BOOL)select`使用行索引从那里调用。

重要提示：当用户只需选择一行时，此解决方案还将触发编辑。如果您只想在添加新对象时触发编辑，那么这不适合您。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-01-04T20:07:26.477

只需在您的控制器中创建一个单独的并手动`@IBAction`调用该方法。`NSArrayController.add`之后，您可以选择行

```
@IBAction func addLink(_ sender: Any) {
    // Get the current row count from your data source
    let row = links.count

    arrayController.add(sender)

    DispatchQueue.main.async {
        self.tableView.editColumn(0, row: row, with: nil, select: true)
    }
} 
```

# c - 使用重复数据初始化 C 数组

> ID：844935
> 
> 赞同：5
> 
> 时间：2009-05-10T08:30:01.563
> 
> 标签：c, arrays, linker, memory-management

我想用相同的元素重复初始化一个结构数组，即

```
struct st ar[] = { {1,2}, {1,2}, {1,2} }; 
```

但是我不想为此运行任何代码，我希望程序执行时的内存布局是这样的，而不涉及任何 CPU 指令（它会增加非常慢的 CPU 和相对较大的数组的启动时间）。

当将数组用作小型临时数据库（将 id 映射到结构）以及希望对所有数据库值使用默认值时，这是有道理的。

我最好的解决方案是使用某种形式

```
#define I {1,2}
struct st ar[SIZE_OF_ARRAY] = { I,I,I }; 
```

这样编译器会在我的 s 太多或太少时警告我`I`。但这远非理想。

我认为在 ANSI-C 中没有解决方案，但我认为可能存在宏滥用或 gcc 扩展可以完成这项工作。理想情况下，我想要一个标准解决方案，但即使是特定于编译器的解决方案也足够了。

我以为我能够以某种方式递归地定义一个宏，以便`I(27)`将其解析为 27 `{1,2}`s，但我认为这是不可能的。但也许我错了，有什么破解方法吗？

也许内联汇编可以解决问题？用 MASM 或 TASM 定义这样的内存布局非常容易，但我不确定是否可以在 C 代码中嵌入内存布局指令。

是否有任何链接器技巧可以诱使它根据我的命令初始化内存？

PS 我**知道**我可以用一些脚本自动生成 C 文件。使用自定义脚本是不可取的。如果我使用自定义脚本，我将发明一个 C 宏`REP(count,exp,sep)`并编写一个迷你 C 预处理器来将其替换为`exp sep exp sep ... exp {exp appears count time}`.

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-10T08:49:20.707

[boost 预处理器库](http://www.boost.org/doc/libs/release/libs/preprocessor/doc/index.html)（适用于 C 语言）可能会有所帮助。

```
#include <boost/preprocessor/repetition/enum.hpp>

#define VALUE(z, n, text) {1,2}

struct st ar[] = {
    BOOST_PP_ENUM(27, VALUE, _)
};

#undef VALUE 
```

如果你想使用它，你只需要`boost/preprocessor`来自 boost 的目录——它是完全独立的。

虽然，它确实对元素的数量有一些任意限制（我认为在这种情况下它是 256 次重复）。有一种称为[混沌](http://sourceforge.net/projects/chaos-pp)的替代方法，它没有，但它是实验性的，仅适用于严格遵循标准的预处理器（GCC 可以）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-10T08:36:32.170

我能想到的最简单的方法是编写一个脚本来生成可以包含在 C 代码中的初始化程序：

```
{1,2},
{1,2},
{1,2} 
```

然后在您的来源中：

```
struct st ar[] = {
    #include "init.inc"
}; 
```

如果你愿意，你可以安排你`Makefile`自动生成它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-10T08:50:31.623

我猜您可以在带有数组定义的文件上执行以下操作：

```
#include "rep_array_autogen.c"
struct st ar[SIZE_OF_ARRAY] = REPARRAY_DATA; 
```

并让您的 Makefile 生成`rep_array_autogen.c`格式如下

```
#define SIZE_OF_ARRAY 3
#define REPARRAY_DATA {{1, 2}, {1, 2}, {1, 2}, } 
```

由于`rep_array_autogen.c`是在您的机器上构建的，因此它与在其中手动编码一样快。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-10T08:36:26.430

你所拥有的`I`s 形式是标准 C 可以给你的最好的东西。我不明白您如何反对标准初始化代码，但可以使用汇编。嵌入组件必然是一种非标准的非便携机制。

递归宏的问题是你不知道在哪里停止。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-03-10T19:25:54.390

埃拉扎尔，

您能否提供数据来支持您的观点，即预初始化数据比运行时初始化更快？

如果您在带有硬盘驱动器 (HDD) 的标准机器上运行代码并且您的程序驻留在 HDD 上，那么将数据从二进制映像的数据部分复制到 RAM 的时间基本上与使用一些运行时初始化的类型。

基普·莱特纳

# perl - 我在哪里可以找到或下载 Perl 的 p2hp 实用程序？

> ID：844937
> 
> 赞同：1
> 
> 时间：2009-05-10T08:31:30.607
> 
> 标签：perl

我已经`perl`安装了，但是很多命令（`perl`实用程序）不可用。我觉得他们应该在安装`perl`后一起来`perl`。但是根本没有这样的命令。我用谷歌搜索找到可以下载它们的地方，但似乎没有地方告诉我从哪里得到它们。

```
 root@opensolaris:~# which find2perl

 which: no find2perl in (/usr/gnu/bin:/usr/bin:/usr/X11/bin:/usr/sbin:/sbin)

 root@opensolaris:~# which h2ph

 which: no h2ph in (/usr/gnu/bin:/usr/bin:/usr/X11/bin:/usr/sbin:/sbin)

 root@opensolaris:~# perl -v

 This is perl, v5.8.4 built for i86pc-solaris-64int
 (with 31 registered patches, see perl -V for more detail)

 Copyright 1987-2004, Larry Wall 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-10T08:44:24.960

> 这是为 i486-linux-gnu-thread-multi 构建的 perl v5.10.0

我已经安装了这些 perl 基本模块。

*   perl
*   perl 基础
*   perl 调试
*   perl 模块

它对我有用。我什至卸载了 perl-debug，它仍然有效。（Ubuntu 9.04）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-10T08:55:04.000

它可能在 /usr/perl5/5.8.4/bin/h2ph 结束。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-10T10:11:37.683

您的 Solaris 中不提供 h2ph，并且它们往往不提供 perl 的“附加”或“实用程序”，例如“rename”和“find2perl”。

找到 /mount/point/here -name 'h2ph" -ls

它绝对不像 linux，而且布局也很奇怪。

# sql-server - SQL Server 2008 安装错误：Microsoft Visual Studio 2008 的早期版本

> ID：844945
> 
> 赞同：7
> 
> 时间：2009-05-10T08:38:09.047
> 
> 标签：sql-server, visual-studio-2008, sql-server-2008, installation

在安装 SQL Server 2008 开发人员版的过程中，我收到了这个奇怪的错误，提示我应该安装 VSTS 2008 SP1。但实际上我安装了 VSTS 2008 SP1。有什么想法有什么问题吗？

这是我的屏幕快照。

[http://i41.tinypic.com/9teo7m.jpg](http://i41.tinypic.com/9teo7m.jpg)

提前谢谢，乔治

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-09-15T23:46:03.027

在安装 SQL 2008 期间重命名以下注册表项

HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\DevDiv\VS\Servicing\9.0

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-10T08:42:03.717

这是该错误的[知识库文章](http://support.microsoft.com/kb/956139)。这是另[一篇有趣的文章](http://blogs.msdn.com/psssql/archive/2008/08/11/sql-server-2008-visual-studio-2008-sp1-and-net-framework-3-5-sp1-explained.aspx)。

如果您安装了多个 Visual Studio 产品，则必须将它们全部升级到 SP1。如果您拥有 Visual Studio 2008 和一个或多个 2008 Express Edition，则在升级 Visual Studio 之前无法升级 Express Edition。

如果您尚未安装 Visual Studio 2008 RTM 但有此问题，那是因为您的系统上安装了 Visual Studio 2008 Shell（集成模式），但不是在 SP1 级别。这可能是因为它是从 SQL Server 2008 CTP 安装遗留下来的。

您是否仔细检查了“关于”框中是否有 SP1？服务包应在“已安装产品”列表中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-10-27T19:28:24.797

团队资源管理器（Team Foundation Server 的客户端）以及 SQL 管理工具使用 Visual Studio 2008 Shell（集成模式）。

如果在安装 Visual Studio 2008 SP1 之后安装 Team Explorer，即使 Visual Studio 本身处于 SP1，Team Explorer 也会将一些 VS Shell 文件退回到 RTM 补丁级别。

重新运行 Visual Studio 2008 Service Pack 安装程序应该修补 Team Explorer 安装退化的文件，无需卸载 Shell。

请参阅此[详细说明](http://consultingblogs.emc.com/jamiethomson/archive/2009/04/23/installation-order-for-visual-studio-2008-sp1-team-explorer-and-sql-server-2008.aspx)。

换句话说，安装顺序很重要，应该如下：

1.  视觉工作室 2008
2.  团队资源管理器
3.  Visual Studio 2008 服务包 1
4.  SQL 服务器

# html - Flash HTML 图片链接 AS3

> ID：844949
> 
> 赞同：0
> 
> 时间：2009-05-10T08:41:49.380
> 
> 标签：html, flash, actionscript-3, paypal

我有一个 flash as3 文件，我正在导入一个包含此链接的 HTML 文件：

```
<a href="purchase.php?lang=0&"><img src="https://www.paypal.com/en_GB/i/btn/btn_buynowCC_LG.gif" id="paypal_button"></a> 
```

我一生都无法弄清楚，我到处都看过。

有几个论坛建议：

```
function onTicketLoad():void {
if(paypal != null && this.contains(paypal)) {
    removeChild(paypal);
}
var imgLoader:DisplayObject = content_text.getImageReference("paypal_button");
//imgLoader.contentLoaderInfo.addEventListener(Event.COMPLETE,onHtmlImageLoaded);
paypal.addChild(imgLoader.content);
}

function onHtmlImageLoaded(e:Event):void {
    e.target.removeEventListener(Event.COMPLETE, onHtmlImageLoaded);

    paypal.addChild(e.target.content);
    paypal.buttonMode = true;
    paypal.useHandCursor = true;
    addChild(paypal);
} 
```

（该示例完全支离破碎，我只是将其包含在内以说明我正在尝试做的事情）

基本上我认为我需要将图像加载到 getImageReference 方法中......但我很迷茫......任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-18T15:21:15.513

我发现`<img>`在 Flash 中的 TextFields 中的标签上创建链接可能会有问题。

我发现这个问题已经在 adobe bug tracker 上报告了：

[http://bugs.adobe.com/jira/browse/FP-2146](http://bugs.adobe.com/jira/browse/FP-2146)

曾经作为一种解决方法，我创建了一个与图像完全相同大小的单独 swf 文件并将其嵌入（即一个 160x47 舞台和一个带有可点击链接的 MovieClip/按钮，使用 navigateToURL）。基本上，您可以像图像一样将 swf 文件嵌入到 TextFields 中。

这并不理想，但考虑到现在可以使用 swf“按钮”并以或多或少与您使用`<img>`标签相同的方式布局，这似乎是一个不错的折衷方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-11T08:40:54.937

如果您要在 htmlText 框中使用 <img> 标签，“[您必须将文本字段设置为多行并自动换行](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/text/TextField.html#htmlText)”

我试过了，对我来说效果很好。它加载了图像并且链接也有效。这是我的代码：

```
import flash.text.TextField;

var labelText:String = '<a href="purchase.php?lang=0&"><img src="https://www.paypal.com/en_GB/i/btn/btn_buynowCC_LG.gif" id="paypal_button"></a>';
var label:TextField = new TextField();
label.border = true;
label.multiline = true;
label.wordWrap = true;
label.width = 200;
label.height = 100;
addChild(label);
label.htmlText = labelText; 
```

我的示例使用纯 AS3，但它应该与从文本字段属性面板中选择“多行”和“自动换行”完全相同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-10-03T05:51:06.483

AIR（移动）显然忽略了 IMG 标签的安全性......在我看来没用。添加一个事实，即在 Mobile 中不推荐或不支持 TextFlow，并且到目前为止，许多其他尝试获取 IMG 标记来呈现的尝试都没有挑战性。我会用给定的组件打赌几乎是不可能的（当然在 AIR Mobile 领域，它没有很好的文档记录并且与围绕这些问题的在线资源存在冲突，因此刚从 beta 版中出来的情况不清楚和令人困惑）。

# objective-c - 让QTMovieView全屏

> ID：844951
> 
> 赞同：1
> 
> 时间：2009-05-10T08:43:11.377
> 
> 标签：objective-c, cocoa, macos, quicktime

我将 QTMovieView 设置为 IBOutlet。我想全屏播放视频。哪种方法允许这样做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-11-25T07:12:07.323

请参阅 QTKit 示例代码：http: [//developer.apple.com/mac/library/samplecode/MyMediaPlayer/listing3.html](http://developer.apple.com/mac/library/samplecode/MyMediaPlayer/listing3.html)特别是“goFullScreen”方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-10T08:49:29.987

[这](http://api.monobjc.net/html/M_Monobjc_Cocoa_NSView_EnterFullScreenModeWithOptions_2_fd6ad6ce.htm)有帮助吗？

[这](http://api.monobjc.net/html/T_Monobjc_QuickTime_QTMovieView.htm)是所有方法的非常详细的列表。

# objective-c - Objective-C：如何声明对子类可见的静态成员？

> ID：844958
> 
> 赞同：24
> 
> 时间：2009-05-10T08:46:14.287
> 
> 标签：objective-c, inheritance, static

我声明了一系列处理通信协议的静态类。我想声明一个处理常见消息的父类，如 ACK、内联错误......

我需要一个静态变量来维护当前正在处理的元素，并且我想在父类中声明它。

我这样做：

父母.m

```
@implementation ServerParser

static NSString * currentElement; 
```

但子类没有看到 currentElement。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-05-10T09:10:04.727

如果您在类的实现文件中声明一个静态变量，那么该变量仅对*该类*可见。

您可以在类的头文件中声明静态变量，但是，该头文件对所有类都可见`#import`。

如您所描述的，一种解决方法是在父类中声明静态变量，但还要创建一个类方法来访问该变量：

```
@implementation ServerParser

static NSString *currentElement;
...
+ (NSString*)currentElement
{
    return currentElement;
}
...
@end 
```

然后，您可以通过调用来检索静态变量的值：

```
[ServerParser currentElement]; 
```

然而，除非其他类使用该方法，否则该变量将不可见。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-07-18T20:10:37.420

一种解决方法是在父类的实现中声明静态变量，并在父类中声明一个属性。然后在访问器方法中访问静态变量。通过这种方式，您可以使用点语法访问静态变量，例如属性。所有子类都访问同一个共享静态变量。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2014-06-15T08:28:35.870

更简单。创建一个带有受保护静态变量的预基类。例如：

```
public abstract class preBase {

protected static int VariableStaticPrivate; 
```

}

公共抽象类基础：preBase{

```
//Inherit VariableStaticPrivate
//And you can use it. 
```

}

公共类 DerivedOne : Base {

```
//Also inherit VariableStaticPrivate
//And you can use it. 
```

}

# django - django-apache-wsgi 应用程序没有 SQLite 写入权限

> ID：844966
> 
> 赞同：0
> 
> 时间：2009-05-10T08:50:48.860
> 
> 标签：django, sqlite

调试屏幕显示 django 没有对 db 的写访问权限。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-10T09:12:35.050

据推测，运行您的应用程序的用户 ID 对您保存数据库的文件没有写入权限，或者路径上的某些目录存在权限问题。那么 ls -l 或 -ld （或 Windows 等价物）对所有相关权限有什么看法，以及 webapp 在什么用户 ID 下运行？

# php - 根据数据库中的数据创建 jquery 选项卡

> ID：844967
> 
> 赞同：0
> 
> 时间：2009-05-10T08:50:56.583
> 
> 标签：php, jquery, tabs

我想根据 MySQL 数据库中的数据使用 php 创建选项卡，例如计算组数，如果它们是 5 创建 5 个选项卡。我该怎么做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-10T08:53:51.990

您可以像 HTML 一样简单地从 PHP 生成 JS。

如果您在 PHP 文件中使用内联 JavaScript，则只需打开 PHP 并打印出您需要的任何内容。

```
<script type='text/javascript'>
    var foo = <?php echo $bar; ?>; 
    // this will create "var foo = 4;" if $bar = 4
</script> 
```

如果您使用 .js 文件，您可以告诉 HTTP 服务器通过 PHP 传递 .js 文件，例如 Apache 中的此更改。

```
AddType application/x-httpd-php .php .js 
```

现在 Apache 将首先通过 PHP 传递 .js 文件。这会增加服务器的负载，并且 .js 文件通常比 php 或 html 文件缓存更多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-10T09:41:57.223

您可以使用[jQuery Tabs 小部件](http://jqueryui.com/demos/tabs/)。

每个选项卡都由一个列表项和一个 div 元素组成，应该很容易用 PHP 中的数据库内容编写这些内容。

# asp.net - 有没有更好的方法将 ClientID 放入外部 JS 文件？

> ID：844970
> 
> 赞同：6
> 
> 时间：2009-05-10T08:52:37.157
> 
> 标签：asp.net, javascript

我知道以前有人问过这个问题，但是我找到了一种不同的方法来获取对外部 JS 文件中控件的引用，但我不确定这在整体速度方面会如何下降。

我的代码是

```
public static void GenerateClientIDs(Page page, params WebControl[] controls) {

        StringBuilder script = new StringBuilder();
        script.AppendLine("<script type=\"text/javascript\">");

        foreach (WebControl c in controls) {
            script.AppendLine(String.Format("var {0} = '#{1}';", c.ID, c.ClientID));
        }

        script.AppendLine("</script>");

        if (!page.ClientScript.IsClientScriptBlockRegistered("Vars")) {
            page.ClientScript.RegisterClientScriptBlock(page.GetType(), "Vars", script.ToString());
        }
    } 
```

这是我可以在我的 JS 文件中引用 aspx 页面的 id。

任何人都可以看到以这种方式做事的任何缺点吗？我才开始使用外部 JS 文件。在将所有内容写入 UserControl 本身之前。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-10T10:21:54.400

好吧，该方法在每个页面中只能使用一次，因此如果您从用户控件调用它，这意味着您永远不能将其中两个用户控件放在同一页面上。

您可以将控件引用存储在列表中，直到 PreRender 事件发生，然后将它们全部放在页头中的脚本标记中。这样您就可以多次调用该方法，并且所有客户端 ID 都放在同一个脚本标记中。

就像是：

```
private const string _key = "ClientIDs";

public static void GenerateClientIDs(params WebControl[] controls) {
   Page page = HttpContext.Current.Handler As Page;
   List<WebControl> items = HttpContext.Current.Items[_key] as List<WebControl>;

   if (items == null) {
      page.PreRender += RenderClientIDs;
      items = new List<WebControl>();
   }

   items.AddRange(controls);

   HttpContext.Current.Items[_key] = items;
}

private static void RenderClientIDs() {
   Page page = HttpContext.Current.Handler As Page;
   List<WebControl> items = HttpContext.Current.Items[_key] as List<WebControl>;

   StringBuilder script = new StringBuilder();
   script.AppendLine("<script type=\"text/javascript\">");
   foreach (WebControl c in items) {
      script.AppendLine(String.Format("var {0} = '#{1}';", c.ID, c.ClientID));
   }
   script.AppendLine("</script>");

   page.Head.Controls.Add(new LiteralControl(script));
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-10T14:21:58.310

看看这个：[http ://weblogs.asp.net/joewrobel/archive/2008/02/19/clientid-problem-in-external-javascript-files-solved.aspx](http://weblogs.asp.net/joewrobel/archive/2008/02/19/clientid-problem-in-external-javascript-files-solved.aspx)

看起来它会为您处理脏活（类似于 Guffa 的回答）。它会生成一个包含服务器 ID 和客户端 ID 的 JSON 对象 ( [example](http://weblogs.asp.net/blogs/joewrobel/WindowsLiveWriter/ClientIDProblemInExternalJavaScriptFiles_740E/image_4.png) )，因此您可以在 JavaScript 中执行以下操作：

```
var val = PageControls.txtUserName.value; 
```

# android - 是否可以将来自 URL 的图像放入 android 的 imagebutton 中？

> ID：844972
> 
> 赞同：2
> 
> 时间：2009-05-10T08:53:56.873
> 
> 标签：android

我想要做的是一个数据库列表视图，右侧有一个小图像按钮和文本，我希望小图像用文本文件给出的 URL 进行更改，但我被卡住了，2 小时规则结束

For(file lenght) 所以 URL 是 www.site.com/images/(i++).png

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-15T21:23:46.170

您想要做的绝对是可能的，但是您需要手动获取图像并将其设置在 ImageButton 上。

这是一个可以用来获取图像的小方法：

```
private Bitmap fetchImage( String urlstr )
{
    try
    {
        URL url;
        url = new URL( urlstr );

        HttpURLConnection c = ( HttpURLConnection ) url.openConnection();
        c.setDoInput( true );
        c.connect();
        InputStream is = c.getInputStream();
        Bitmap img;
        img = BitmapFactory.decodeStream( is );
        return img;
    }
    catch ( MalformedURLException e )
    {
        Log.d( "RemoteImageHandler", "fetchImage passed invalid URL: " + urlstr );
    }
    catch ( IOException e )
    {
        Log.d( "RemoteImageHandler", "fetchImage IO exception: " + e );
    }
    return null;
} 
```

当然，您需要将此方法包装在一个线程中（在 SDK 1.5 中使用[AsyncTask](http://developer.android.com/reference/android/os/AsyncTask.html "异步任务")或在 SDK pre 1.5 中使用[UserTask](http://code.google.com/p/apps-for-android/source/browse/trunk/Photostream/src/com/google/android/photostream/UserTask.java "用户任务")），然后只需调用：

```
myImageButton.setImageBitmap( bitmap ); 
```

我认为这已经回答了您的问题，如果没有，请进一步详细说明。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-08-12T14:28:57.470

上面的 fetchImage 代码失败并出现
**DEBUG/skia(xxxx): ---**
如果重复调用，decoder->decode 返回 false。
（StackOverflow.com 上已经对此进行了多次讨论）

这不是崩溃或可捕获的错误，而是返回空位图。

这个备用 fetchImage 有效（谁能说出为什么？）：

```
 private Bitmap fetchImage(String urlstr){
    InputStream is= null;
    Bitmap bm= null;
    try{
        HttpGet httpRequest = new HttpGet(urlstr);//bitmapUrl.toURI());
        HttpClient httpclient = new DefaultHttpClient();
        HttpResponse response = (HttpResponse) httpclient.execute(httpRequest);

        HttpEntity entity = response.getEntity();
        BufferedHttpEntity bufHttpEntity = new BufferedHttpEntity(entity);
        is = bufHttpEntity.getContent();
        bm = BitmapFactory.decodeStream(is); 
    }catch ( MalformedURLException e ){
        Log.d( "RemoteImageHandler", "fetchImage passed invalid URL: " + urlstr );
    }catch ( IOException e ){
        Log.d( "RemoteImageHandler", "fetchImage IO exception: " + e );
    }finally{
        if(is!=null)try{
            is.close();
        }catch(IOException e){}
    }
    return bm;
} 
```

# php - 如何在 PHP 中进行长时间的批处理？

> ID：844979
> 
> 赞同：0
> 
> 时间：2009-05-10T09:07:37.323
> 
> 标签：php, batch-processing

当我需要从上传的 CVS 文件更新我的数据库表时，我有批处理，大约 100000-500000 行。通常需要 20-30 分钟，有时会更长。

最好的方法是什么？有什么好的做法吗？任何建议将不胜感激

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-10T09:17:20.200

从 CSV 导入 500.000 行需要 30 分钟？

您是否考虑过让 MySQL 来完成这项艰巨的工作？有[`LOAD DATA INFILE`](http://dev.mysql.com/doc/refman/5.1/en/load-data.html)，它支持处理 CSV 文件：

```
LOAD DATA INFILE 'data.txt' INTO TABLE tbl_name
  FIELDS TERMINATED BY ',' ENCLOSED BY '"'
  LINES TERMINATED BY '\n'; 
```

如果文件的形状不太适合直接导入到目标表中，您可以使用 PHP 预先对其进行转换，或者将其加载到“暂存”表中并让 MySQL 处理必要的转换——以更快和更方便。

作为一个附加选项，似乎可以通过[MySQL Native Driver for PHP (MYSQLND)](http://forge.mysql.com/wiki/PHP_MYSQLND)异步运行 MySQL 查询。也许您也可以探索该选项。它将使您能够保持快速的 UI 性能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-10T09:13:12.550

如果您要进行大量插入，您是在进行批量插入吗？即像这样：

```
INSERT INTO table (col1 col2) VALUES (val1a, val2a), (val1b, val2b), (.... 
```

这将大大加快插入速度。

您可以做的另一件事是在进行更改时禁用索引，然后在完成后让它一次性重建索引。

关于你在做什么的更多细节，你可能会得到更多的想法

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-10T09:13:16.780

[PEAR](http://pear.php.net)有一个名为[Benchmark](http://pear.php.net/package/Benchmark)的包，它有一个 Benchmark_Profiler 类，可以帮助您找到代码中最慢的部分，以便您进行优化。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-10T09:15:42.950

我们在一个大型应用程序中拥有类似的功能。我们遇到了将 csv 中的数百万行插入到具有 9 个索引的表中的问题。[经过大量重构后，我们发现插入数据的理想方法是使用 mysql LOAD DATA INFILE](http://dev.mysql.com/doc/refman/5.1/en/load-data.html)命令将其加载到 [临时] 表中，在那里进行转换并将多个插入查询的结果复制到实际表 ( `INSERT INTO ... SELECT FROM`) 处理中每个查询只有 50k 行左右（这比发出单个插入但 YMMV 执行得更好）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-10T11:28:40.837

> 我不能用 cron 来做，因为这是在用户控制之下，用户单击进程按钮，稍后可以检查日志以查看进程状态

当用户按下所述按钮时，在数据库的表中设置一个标志。然后让你的 cron 作业检查这个标志。如果它在那里，开始处理，否则不要。我适用，您可以使用同一张表发布某种状态更新（例如完成 xx%），以便用户对进度有一些反馈。

# iphone - UIPicker 滑动没有响应

> ID：844982
> 
> 赞同：0
> 
> 时间：2009-05-10T09:10:22.387
> 
> 标签：iphone, uipickerview

UIPicker 滑动在带有 SDK 2.2 的 Iphone 模拟器中完美响应，但我现在正在使用新版本的模拟器进行测试，并且滑动不起作用。我浏览了文档，但看不到 API 的任何更改。所以我假设出了点问题，而 SDK 2.2 让我侥幸逃脱。

Picker 使用自定义视图在其旁边显示图像和文本。当您在选取器的一行上单击一次时，选取器确实会正确更改位置。但是，如果您尝试滑动它不会响应（有时它会移动几毫米）。我认为每一行的自定义视图不会让选择器检测到滑动，所以我在自定义视图中添加了 self.userInteractionEnabled = NO，但它没有任何区别。

您的帮助将不胜感激，

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-01-24T12:02:20.517

问题是 UIPicker 在 UIScrollView 内。要修复它，请将 UIScrollView.scrollEnabled 设置为 NO 以查看滑动返回。

# jfreechart - Jfreechart中的虚线

> ID：844988
> 
> 赞同：9
> 
> 时间：2009-05-10T09:13:35.170
> 
> 标签：jfreechart

有人知道如何在 Jfreechart 中在某些给定坐标处绘制垂直虚线吗？

谢谢

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-10T11:10:21.803

[示例 5](http://www.java2s.com/Code/Java/Chart/JFreeChartLineChartDemo5showingtheuseofacustomdrawingsupplier.htm)显示了图表的一系列虚线。设置你的行程：

```
plot.getRenderer().setSeriesStroke(
    0, 
    new BasicStroke(
        2.0f, BasicStroke.CAP_ROUND, BasicStroke.JOIN_ROUND,
        1.0f, new float[] {6.0f, 6.0f}, 0.0f
    ) 
```

并且您需要将数据集设置为简单地引用垂直线的坐标。

# objective-c - 在objective-c / cocoa-touch中是否有一个方便的功能来找到最小的数字？

> ID：844990
> 
> 赞同：43
> 
> 时间：2009-05-10T09:15:48.007
> 
> 标签：objective-c, cocoa-touch

我有两个号码，需要退回较低的号码。有什么我可以使用的功能吗？当然这是一项简单的任务，我可以做一个 if 语句。我只是想知道。

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2009-05-10T09:19:40.103

如果您使用整数，请使用`MIN()`宏：

```
MIN(25, 50); //Returns 25 
```

如果要比较两个`NSNumber`s，请使用以下`compare:`方法：

```
NSNumber *number, *secondNumber; //Assume 'number'=25, 'secondNumber'=50
NSComparisonResult result = [number compare:secondNumber];

return (result==NSOrderedDescending)?secondNumber:number; //Returns the 'number' NSNumber 
```

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2009-05-10T09:19:46.700

C 标准库包括几个`min()`函数，给定两个数字，将返回两者中的较小者：

```
 double fmin(double x, double y);
 long double fminl(long double x, long double y);
 float fminf(float x, float y); 
```

要使用这些，只需`#include <math.h>`.

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2015-02-12T10:24:12.267

对于最低数量。采用

```
MIN(number1,number2); 
```

对于最大没有。采用

```
MAX(number1,number2); 
```

# c# - WCF 中的哈希集

> ID：844992
> 
> 赞同：3
> 
> 时间：2009-05-10T09:19:00.353
> 
> 标签：c#, wcf, hashset, proxy-classes, service-reference

我在我的 WCF 界面中使用 HashSet

```
[ServiceContract]
public interface IwcfServerSync
{
    [OperationContract]
    void Test(HashSet<int> someHashSet);
} 
```

当我创建一个服务引用时，HashSet 变成了一个 int[]。

我添加了一个 ServiceKnownType ：

```
[ServiceKnownType(typeof(System.Collections.Generic.HashSet<int>))] 
```

并尝试了一些配置，但无法完全改变。

如果我更改它硬编码一切正常，但每次更新我的参考时更改它真的很烦人..

我可能做错了什么，有什么指示或想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-10T09:24:18.563

当它们通过网络时，集合被简化了。您可以通过 IDE 和命令行 ( `svcutil /collectionType`) 指定集合类型，但它将应用于API 上的*所有集合。*我认为你应该接受它，并通过代码处理不匹配。最终，在网络上，集合只是 xml（至少在标准绑定上） - 类似于：

```
<items>
   <item ...>...</item>
   <item ...>...</item>
   <item ...>...</item>
</items> 
```

- 因此为什么它不能（从模式中）分辨数组（`T[]`）、a `List<T>`、a`HashSet<T>`和 a之间`MyFunkyCollection<T>`。

请注意，如果您使用程序集共享（即相同的服务合同程序集在客户端*和*服务器上），则不会发生这种情况——但这违背了 SOA/mex 的意图。但它是一种经常使用的方法 - 因此 IDE 直接支持它，并通过开关 ( `svcutil /reference`) 支持命令行。

* * *

对于支持它的IDE...如果您在类库（dll）中编写服务契约和数据契约，然后从两个项目（服务器项目和客户端项目）。现在将客户端项目中的*服务引用*添加到服务器端点（.svc）。如果您使用的是 VS2008，它将自动检查类型的本地引用并使用它们代替代理生成 - 意思是：您的客户端代码使用`IwcfServerSync`来自类库的类库，它已经知道是否使用`HashSet<T>`等。

# c# - 使用 foreach 将字符串 [] 转换为字符串

> ID：844995
> 
> 赞同：0
> 
> 时间：2009-05-10T09:20:28.133
> 
> 标签：c#, lambda

```
string x;
foreach(var item in collection)
{
   x += item+",";
} 
```

我可以用 lambdas 写这样的东西吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-10T09:30:57.050

假设 C#，您是否尝试过 String.Join()？还是强制使用 lambda？

例子：

```
string[] myStrings = ....;
string result = String.Join(",", myStrings); 
```

**编辑**

尽管最初的标题（和示例）是关于用分隔符连接字符串（`String.Join()`在我看来这是最好的工作），但原始发帖人似乎询问了更广泛的解决方案：如何应用自定义格式的字符串列表。

我对此的回答是编写自己的方法。String.Join 有一个目的，通过它的名字来反映（连接一些字符串）。您的格式逻辑很有可能在您的项目中有意义，因此请编写它，给它一个合适的名称并使用它。

例如，如果你想`<li>text</li>`为每个项目输出，做这样的事情：

```
string FormatAsListItems(string[] myStrings)
{
    StringBuilder sb = new StringBuilder();
    foreach (string myString in myStrings)
    {
         sb.Append("<li>").Append(myString).Append("</li>");
    }
} 
```

我认为意图更清晰，而且您也不会在循环中连接字符串对性能造成影响。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-10T09:31:44.083

```
string x = string.Join(",", collection); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-10T09:34:02.673

您正在寻找解决方案太远。该类`String`有一个`Join`方法：

```
string x = String.Join(",", collection); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-10T09:26:40.927

这回答了你的问题了吗？

[连接字符串的最有效方法？](https://stackoverflow.com/questions/21078/whats-the-best-string-concatenation-method-using-c)

请注意，您可以使用 来执行此操作`Aggregate`，但对于长数组，内置`string.Join`更易于使用且速度更快。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-10T09:28:08.380

```
string[] text = new string[] { "asd", "123", "zxc", "456" };

var result = texts.Aggregate((total, str) => total + "," + str); 
```

更短的语法，感谢 Earwicker

# c# - 加密 BouncyCastle RSA 密钥对并存储在 SQL2008 数据库中

> ID：844997
> 
> 赞同：5
> 
> 时间：2009-05-10T09:21:27.837
> 
> 标签：c#, .net, sql-server, bouncycastle, private-key

我有一个生成 BouncyCastle RSA 密钥对的函数。我需要加密私钥，然后将加密的私钥和公钥存储到单独的 SQL2008 数据库字段中。

我正在使用以下内容获取密钥对：

```
private static AsymmetricCipherKeyPair createASymRandomCipher()
{
    RsaKeyPairGenerator r = new RsaKeyPairGenerator();
    r.Init(new KeyGenerationParameters(new SecureRandom(), 1024));
    AsymmetricCipherKeyPair keys = r.GenerateKeyPair();
    return keys; 
} 
```

这可以很好地返回密钥，但我不确定如何加密私钥并随后将其存储在数据库中。

这就是我目前使用的加密数据（不正确？）：

```
public static byte[] encBytes2(AsymmetricKeyParameter keyParam, byte[] Key, byte[] IV)
{
    MemoryStream ms = new MemoryStream();
    Rijndael rjdAlg = Rijndael.Create();
    rjdAlg.Key = Key;
    rjdAlg.IV = IV;
    CryptoStream cs = new CryptoStream(ms, rjdAlg.CreateEncryptor(), CryptoStreamMode.Write);
    byte[] keyBytes = System.Text.Encoding.Unicode.GetBytes(keyParam.ToString());
    cs.Write(keyBytes, 0, keyBytes.Length);
    cs.Close();
    byte[] encryptedData = ms.ToArray();
    return encryptedData;
} 
```

显然，我在其中转换 keyParam.ToString() 的 keyBytes 设置不正确，因为它只转换 KeyParameter 名称，而不是实际值。我正在向此函数提交keys.Private 的先前密钥对返回。

另一个问题是因为我没有加密公钥，我应该以什么格式将它存储在 SQL2008 数据库中，nvarchar(256) 或其他？

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2010-02-02T15:42:40.937

出于应该清楚的原因，默认（可能是无意的）序列化不能很好地与私钥一起使用，私钥只能在非常有限的情况下写出。

BouncyCastle 支持 PKCS#8，这是“序列化”私钥的相关标准。有称为 PrivateKeyInfo 和 EncryptedPrivateKeyInfo 的 ASN.1 结构。因为它们在 ASN.1 中，所以有标准的方法来序列化/反序列化它们。顾名思义，一个以明文形式存储密钥，另一个根据密码对密钥进行加密。

对于公钥 - 这些通常不会被加密。BC 支持 SubjectPublicKeyInfo 的 X.509 标准格式用于序列化它们。

在 C# 构建中，要查看的高级类是：

*   Org.BouncyCastle.Security.PrivateKeyFactory
*   org.BouncyCastle.Security.PublicKeyFactory
*   Org.BouncyCastle.Pkcs.EncryptedPrivateKeyInfoFactory
*   Org.BouncyCastle.Pkcs.PrivateKeyInfoFactory
*   Org.BouncyCastle.X509.SubjectPublicKeyInfoFactory

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-15T15:03:46.723

只要对象被标记为可序列化，将对象转换为字节数组的一种方法是使用 .Net 中的 BinaryFormatter 类。

您需要将此 using 语句添加到您的代码文件中：

```
using System.Runtime.Serialization.Formatters.Binary; 
```

二进制格式化程序可以将您的类输出到流中。当您打算将对象转换为字节数组时，您可以使用 System.IO.MemoryStream 作为临时存储。

```
MemoryStream memStream = new MemoryStream(); 
```

然后，您可以创建一个新的二进制格式化程序。

```
BinaryFormatter formatter = new BinarryFomatter(); 
```

并使用它来序列化您的对象。

```
formatter.Serialize(memStream, someObject); 
```

要获取字节，您可以使用：

```
return memStream.ToArray(); 
```

要反序列化字节数组，您需要将字节写入内存流。

```
memStream.Write(arrBytes, 0, arrBytes.Length); 
```

返回到流的开头。

```
memStream.Seek(0, SeekOrigin.Begin); 
```

然后使用格式化程序重新创建对象。

```
Object obj = (Object)formatter.Deserialize(memStream); 
```

如果您已经在使用加密函数，您应该能够在将创建的字节数组存储到数据库之前很容易地对其进行加密。

希望这将帮助您朝着正确的方向前进。如果幸运的话，BouncyCastle 对象将被标记为可序列化，否则您将需要一些额外的代码。稍后，我将有机会查看 BouncyCastle 库以便能够对此进行测试，并在必要时发布更多代码。

* * *

...我以前从未使用过 BouncyCastle。经过一些测试，似乎公钥和私钥对象是不可序列化的，因此您需要将这些对象转换为可序列化的对象！

似乎公钥和私钥将属性公开为各种 BouncyCastle.Math.BigInteger 值。（也可以从这些 BigInteger 构造键）。此外，BigIntegers 有一个 ToByteArray() 函数，也可以从字节数组构造。很有用..

知道您可以将每个键分解为 BigIntegers，然后将它们分解为字节数组，并且反过来也是可能的，您可以将所有这些都存储在可序列化的对象中。一个简单的结构或类就可以了，例如

```
[Serializable]
private struct CipherPrivateKey
{
    public byte[] modulus;
    public byte[] publicExponent;
    public byte[] privateExponent;
    public byte[] p;
    public byte[] q;
    public byte[] dP;
    public byte[] dQ;
    public byte[] qInv;
}

[Serializable]
private struct CipherPublicKey
{
    public bool isPrivate;
    public byte[] modulus;
    public byte[] exponent;
} 
```

这为我们提供了一对易于使用的可序列化对象。

AsymmetricCipherKeyPair 将公钥和私钥公开为 AsymmetricKeyParameter 对象。要获得更详细的属性，您需要将它们转换为以下内容：

keyPair.Public 到 BouncyCastle.Crypto.Parameters.RsaKeyParameters keyPair.Private 到 BouncyCastle.Crypto.Parameters.RsaPrivateCrtKeyParameters

以下函数会将这些转换为之前声明的结构：

```
private static CipherPublicKey getCipherPublicKey(Org.BouncyCastle.Crypto.Parameters.RsaKeyParameters cPublic)
{
    CipherPublicKey cpub = new CipherPublicKey();
    cpub.modulus = cPublic.Modulus.ToByteArray();
    cpub.exponent = cPublic.Exponent.ToByteArray();
    return cpub;
}
private static CipherPrivateKey getCipherPrivateKey(Org.BouncyCastle.Crypto.Parameters.RsaPrivateCrtKeyParameters cPrivate)
{
    CipherPrivateKey cpri = new CipherPrivateKey();
    cpri.dP = cPrivate.DP.ToByteArray();
    cpri.dQ = cPrivate.DQ.ToByteArray();
    cpri.modulus = cPrivate.Modulus.ToByteArray();
    cpri.p = cPrivate.P.ToByteArray();
    cpri.privateExponent = cPrivate.Exponent.ToByteArray();
    cpri.publicExponent = cPrivate.PublicExponent.ToByteArray();
    cpri.q = cPrivate.Q.ToByteArray();
    cpri.qInv = cPrivate.QInv.ToByteArray();
    return cpri;
} 
```

使用前面提到的二进制格式化程序，我们可以将刚刚创建的可序列化对象转换为字节数组。

```
CipherPublicKey cpub = getCipherPublicKey((Org.BouncyCastle.Crypto.Parameters.RsaKeyParameters)keypair.Public);
MemoryStream memStream = new MemoryStream();
BinaryFormatter formatter = new BinarryFomatter();
formatter.Serialize(memStream, cpub);
return memStream.ToArray(); 
```

反序列化就是前面描述的反序列化。反序列化公共或私有结构后，您可以使用 BouncyCastle 构造函数重新创建密钥。这些函数证明了这一点。

```
private static Org.BouncyCastle.Crypto.Parameters.RsaKeyParameters recreateASymCipherPublicKey(CipherPublicKey cPublicKey)
{
    Org.BouncyCastle.Crypto.Parameters.RsaKeyParameters key;
    key = new Org.BouncyCastle.Crypto.Parameters.RsaKeyParameters(
            cPublicKey.isPrivate,
            createBigInteger(cPublicKey.modulus),
            createBigInteger(cPublicKey.exponent));
    return key;
}

private static Org.BouncyCastle.Crypto.Parameters.RsaPrivateCrtKeyParameters recreateASymCipherPrivateKey(CipherPrivateKey cPrivateKey)
{
    Org.BouncyCastle.Crypto.Parameters.RsaPrivateCrtKeyParameters key;
    key = new Org.BouncyCastle.Crypto.Parameters.RsaPrivateCrtKeyParameters(
            createBigInteger(cPrivateKey.modulus),
            createBigInteger(cPrivateKey.publicExponent),
            createBigInteger(cPrivateKey.privateExponent),
            createBigInteger(cPrivateKey.p),
            createBigInteger(cPrivateKey.q),
            createBigInteger(cPrivateKey.dP),
            createBigInteger(cPrivateKey.dQ),
            createBigInteger(cPrivateKey.qInv));
    return key;
} 
```

如果您出于任何原因需要重新创建原始密钥对：

```
AsymmetricKeyParameter publ = (AsymmetricKeyParameter)recreateASymCipherPublicKey(cKeyPair.publicKey);
AsymmetricKeyParameter priv = (AsymmetricKeyParameter)recreateASymCipherPrivateKey(cKeyPair.privateKey);
AsymmetricCipherKeyPair keyPair = new AsymmetricCipherKeyPair(publ, priv); 
```

希望这一切都说得通！代码示例应该可以帮助您。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-09-28T10:57:42.180

正确的做法是使用彼得斯的建议。

我在下面包含了一个小的 C# 代码示例：

```
var keyPair = GetKeypair();

PrivateKeyInfo privateKeyInfo = PrivateKeyInfoFactory.CreatePrivateKeyInfo(keyPair.Private);                        
byte[] serializedKey = privateKeyInfo.ToAsn1Object().GetDerEncoded();

AsymmetricKeyParameter deserializedKey1 = PrivateKeyFactory.CreateKey(serializedKey);
Assert.AreEqual(keyPair.Private, deserializedKey1);

AsymmetricKeyParameter deserializedKey2 = PrivateKeyFactory.CreateKey(privateKeyInfo);            
Assert.AreEqual(keyPair.Private, deserializedKey2); 
```

该示例使用 Bouncy Castle API。**请注意**，示例不加密密钥。该`CreatePrivateKeyInfo`方法被重载以允许使用密码作为密钥的保护。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-11T04:33:23.420

关于问题的第二部分，应该用于存储密钥的数据类型是 VARBINARY(256)。

回到问题的第一部分，您实际上可以选择让 SQL Server 为您处理加密。当然，您是否愿意这样做取决于您的应用程序要求是什么，但如果可以选择，我会仔细考虑。

我们将在这里非常基础，只使用对称密钥和三重 DES。

首先，数据库有一个主密钥，用于保护证书和非对称密钥。主密钥使用 Triple-DES 加密。

```
CREATE MASTER KEY ENCRYPTION BY PASSWORD = 'supersecretpassword' 
```

SQL Server 2005/2008 可以生成自己的 X.509 证书，用于保护用于加密实际数据的密钥。

```
CREATE CERTIFICATE ExampleCertificate 
     WITH SUBJECT = 'thisisjustsomemetadata' 
```

有很多加密对称密钥（证书、密码、其他密钥）的选项，以及许多支持的算法。但是对于这个例子，我们将使用我们的证书。

```
CREATE SYMMETRIC KEY ExampleKey
     WITH ALGORITHM = TRIPLE_DES  
     ENCRYPTION BY CERTIFICATE EncryptTestCert 
```

密钥需要使用与加密相同的方法进行解密。在我们的例子中，这将是我们创建的证书。

```
 DECLARE @Value VARCHAR(50)
 SET @Value = 'supersecretdata!'

 OPEN SYMMETRIC KEY ExampleKey DECRYPTION BY CERTIFICATE ExampleCertificate  
     UPDATE SomeTable  
     SET SomeColumn = ENCRYPTBYKEY(KEY_GUID('ExampleKey'), @Value) 
```

解密同样简单。

```
OPEN SYMMETRIC KEY ExampleKey DECRYPTION BY CERTIFICATE ExampleCertificate  
     SELECT CONVERT(VARCHAR(50),DECRYPTBYKEY(SomeColumn)) AS DecryptedData 
     FROM SomeTable 
```

希望这可以解决您的问题，或者至少为您打开了替代解决方案的大门（尽管有在 C# 应用程序中进行加密经验的人可能会在您的上述代码中找到错误）。如果您的要求要求数据甚至不能以纯文本形式通过网络传输到 SQL Server，那么显然这是不行的（好吧，您实际上*可以*创建到 SQL Server 的 SSL 连接......）。****``*********