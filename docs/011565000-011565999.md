# StackOverflow 问答 11565000-11565999

# mysql - 用cmd导出MySql数据库

> ID：11565003
> 
> 赞同：0
> 
> 时间：2012-07-19T16:15:28.453
> 
> 标签：mysql, export, cmd, mysqldump

我正在使用 MySql 5.1 版本，并且正在尝试通过 cmd 导出 mydatabase ，当我编写此命令时：

```
C:\Program Files\MySQL\MySQL Server 5.1\bin\mysqdump -uroot -ppassword mydatabase >mydatabase.sql 
```

我得到一个错误

> 访问被拒绝

不知道是什么问题，求大神帮忙。。。。。。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T19:29:39.313

您对运行此命令的目录有什么权限？它可能正在尝试将 mydatabase.sql 文件写入您无权访问的目录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-03T06:29:17.363

首先检查您的命令行是否识别 mysql 命令。如果没有，请转到命令并输入

set path=c:\wamp\bin\mysql\mysql5.1.36\bin 然后使用这个命令导出你的数据库

转到您拥有 mysql 的目录。-u - 用户名 -p - 提示密码

```
C:\xampp\mysql\bin>mysqldump -u Username -pPassword DatabaseName > DatabaseName.sql 
```

注意：最好使用sql文件file.sql的全路径

要从转储文件（在本例中称为 filename.sql）导出数据库，请使用：mysql -u username -p password database_name > filename.sql

如果您使用的是 Windows，则需要打开 CMD 并转到安装 mysql.exe 的目录。如果您使用的是 WAMP 服务器，那么它通常位于：C:\wamp\bin\mysql\mysql5.1.36\bin（*注意 mysql 的版本可能不同）

所以你会： cd C:\wamp\bin\mysql\mysql5.1.36\bin

然后执行上述命令之一。

# spotify - libspotify API：多个专辑封面？

> ID：11565004
> 
> 赞同：0
> 
> 时间：2012-07-19T16:15:32.510
> 
> 标签：spotify

给定艺术家姓名和专辑名称，专辑可以有多少封面艺术？原以为只有一张，结果在搜索艺人名“Dire Straits”和专辑名“Brothers In Arms”时得到了两张专辑封面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T14:28:03.947

一张专辑有一张专辑封面。但是，同一张专辑可能会有不同封面的重新发行。但是，一个`sp_album`实例将只有一个封面。

# c# - 作为成员的动作委托不编译

> ID：11565012
> 
> 赞同：0
> 
> 时间：2012-07-19T16:16:00.920
> 
> 标签：c#, esb

为什么这段代码不能编译：

```
public class FakeESBSingleMessage<T> : IBusEnabledClass
{
    private Action<T> SubscribedAction { get; set; }

    #region IBusEnabledClass

    public void Publish<T>(T message)
    {
        SubscribedAction(message);
    }

    public void Subscribe<T>(string ID, Action<T> action)
    {
        SubscribedAction = action;
    }

    #endregion
} 
```

它给出以下错误：

错误 37 参数 1：无法从 'T [..FakeESBSingleMessage.cs(8)]' 转换为 'T' ..FakeESBSingleMessage.cs 16 30
错误 39 无法将类型 'System.Action [mscorlib.dll]' 隐式转换为' System.Action [mscorlib.dll]' ..FakeESBSingleMessage.cs 21 32
错误 36 委托 'System.Action' 有一些无效参数 ..\FakeESBSingleMessage.cs 16 13

我正在尝试创建一个用于测试的假 ESB 组件，它保存传递给订阅的委托并在调用发布时调用它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-19T16:19:57.067

您会收到编译错误，因为您的发布和订阅消息定义了一个新的类型参数 T，而不是使用类中定义的那个。试试这个：

```
public class FakeESBSingleMessage<T> : IBusEnabledClass
{
    private Action<T> SubscribedAction { get; set; }

    #region IBusEnabledClass

    public void Publish(T message)
    {
        SubscribedAction(message);
    }

    public void Subscribe(string ID, Action<T> action)
    {
        SubscribedAction = action;
    }

    #endregion
} 
```

# ios - 在上午 12:00 动态创建上周日的日期

> ID：11565018
> 
> 赞同：3
> 
> 时间：2012-07-19T16:16:29.703
> 
> 标签：ios, nsdate

我正在努力弄清楚如何在上午 12:00 为上一个星期日动态创建日期对象

我在想我可以得到今天的日期，然后减去一周中的当前日期 + 1，此时我可以减去一天中的时间，直到凌晨 12 点。

到目前为止，我有一周中的当前日期：

```
NSCalendar *gregorian = [[NSCalendar alloc] initWithCalendarIdentifier:NSGregorianCalendar];
NSDateComponents *comps = [gregorian components:NSWeekdayCalendarUnit fromDate:[NSDate date]];
int weekday = [comps weekday]; 
```

在这一点上，我可以得到今天的日期并减去`weekday`一天中 * 秒的差异。但是，我怎样才能以秒为单位获得今天的时间？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-19T16:34:37.340

无需手动计算秒数（由于夏令时等原因，这无论如何都是危险的）。以下应该完全符合您的要求：

```
NSDate *today = [NSDate date];
NSCalendar *calendar = [[NSCalendar alloc] initWithCalendarIdentifier:NSGregorianCalendar];
[calendar setLocale:[[NSLocale alloc] initWithLocaleIdentifier:@"en-US"]]; // force US locale, because other countries (e.g. the rest of the world) might use different weekday numbering

NSDateComponents *nowComponents = [calendar components:NSYearCalendarUnit | NSWeekCalendarUnit | NSHourCalendarUnit | NSMinuteCalendarUnit | NSSecondCalendarUnit fromDate:today];

[nowComponents setWeekday:1]; //Sunday
[nowComponents setHour:0]; // 12:00 AM = midnight (12:00 PM would be 12)
[nowComponents setMinute:0];
[nowComponents setSecond:0];

NSDate *previousSunday = [calendar dateFromComponents:nowComponents]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T17:02:19.203

我将担心夏令时之间的转换留给您：

```
NSCalendar *gregorian = [[NSCalendar alloc]initWithCalendarIdentifier:NSGregorianCalendar];

NSDate *date = [NSDate date];
NSLog(@"date %@", date);

NSDateComponents *componentsToday = [gregorian components:NSWeekdayCalendarUnit fromDate:date]; // NSYearCalendarUnit | NSMonthCalendarUnit |  NSDayCalendarUnit | 
NSInteger days = componentsToday.weekday - 1;
NSLog(@"Days=%d", days);

NSDate *lastSunday = [date dateByAddingTimeInterval:-days*60*60*24];
NSLog(@"lastSunday %@", lastSunday);

NSDateComponents *componentsSunday = [gregorian components:NSYearCalendarUnit | NSMonthCalendarUnit |  NSDayCalendarUnit  fromDate:lastSunday];
[componentsSunday setHour:0];
[componentsSunday setMinute:0];
[componentsSunday setSecond:0];
NSDate *targetDate = [gregorian dateFromComponents:componentsSunday];
NSLog(@"TargetDate %@", targetDate); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-02-24T10:07:01.103

Swift 2.0 中的@AndreasLey 解决方案：

```
 func getLastSunday() -> NSDate?
{
    let today = NSDate();
    let calendar : NSCalendar! = NSCalendar(calendarIdentifier: NSCalendarIdentifierGregorian)
    calendar.locale = NSLocale(localeIdentifier: "en-US") // force US locale, because other countries (e.g. the rest of the world) might use different weekday numbering

    let flags : NSCalendarUnit = [.Year , .Month, .Weekday, .WeekOfMonth, .Minute , .Second]
    let nowComponents = calendar.components(flags, fromDate: today)

    nowComponents.weekday = 1 //Sunday
    nowComponents.hour = 0  // 12:00 AM = midnight (12:00 PM would be 12)
    nowComponents.minute = 0
    nowComponents.second = 0;

    let  previousSunday = calendar.dateFromComponents(nowComponents);
    return previousSunday
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-26T06:14:55.257

此代码在您从 UIDatePicker 选择的日期设置为上午 12:00。

```
 NSDate *oldDateSelected = datePicker.date;
 unsigned unitFlags = NSCalendarUnitYear | NSCalendarUnitMonth |  NSCalendarUnitDay;
    NSCalendar *calendar = [NSCalendar currentCalendar];
    NSDateComponents *comps = [calendar components:unitFlags fromDate:oldDateSelected];
    comps.hour   = 00;
    comps.minute = 00;
    comps.second = 44;
    NSDate *newDate = [calendar dateFromComponents:comps];
    return newDate; 
```

# java - 在 InvocationHandler 中设置代理对象的实例变量

> ID：11565022
> 
> 赞同：0
> 
> 时间：2012-07-19T16:16:42.483
> 
> 标签：java, multithreading, proxy, invocationhandler

在 Proxy 对象（实现的对象`java.lang.reflect.InvocationHandler`）中，我试图在代理对象中设置一个实例变量。

如下所示：

```
public class ServiceProxy implements InvocationHandler {

    private final Object proxiedObject;

    private ServiceProxy(final Object object) {
        this.proxiedObject = object;
    }

    public static Object newInstance(final Object object) {
        return Proxy.newProxyInstance(object.getClass().getClassLoader(), object.getClass().getInterfaces(), new ServiceProxy(object));
    }

    public Object invoke(final Object proxy, final Method method, final Object[] args) throws Throwable {

        Object result = null;
        MyObject mo = new MyObject();

        // Is the following safe when the proxiedObject is being acceessed by multiple threads?
        final Field sessionField = this.proxiedObject.getClass().getSuperclass().getDeclaredField("mo");
        sessionField.setAccessible(true);
        sessionField.set(this.object, mo);

        result = method.invoke(this.proxiedObject, args);

        return result;
    }
} 
```

这安全吗？

**编辑**：

实际代码：

```
Object result = null;
Session session = HibernateUtil.getSessionFactory().getCurrentSession()

// Is the following save when the proxiedObject is being acceessed by multiple threads?
final Field sessionField = this.proxiedObject.getClass().getSuperclass().getDeclaredField("session");
sessionField.setAccessible(true);
sessionField.set(this.object, session);

result = method.invoke(this.proxiedObject, args);
return result; 
```

**Edit2** : 代理对象是从 GWT 客户端调用的，该客户端同时调用同一代理对象的多个方法。发生这种情况时，我让会话实例字段（代理类）以意想不到的方式关闭和打开。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T16:23:12.400

> 当 proxiedObject 被多个线程访问时，以下内容是否安全？

不，除非`mo`是`volatile`。如果该`mo`字段是，`volatile`那么这将正确跨越内存屏障，并且`mo`所有线程都将看到对该字段的更新。

重要的是要认识到，如果`MyObject`不是不可变的，即使`mo`是也会导致额外的并发问题`volatile`。

* * *

**编辑：**

感谢@jtahlborn 对此的评论。我一直在做一些阅读，现在我很确定这`volatile`也会保护不*被*`MyObject`部分初始化。

由于[构造函数指令重新排序的可能性](http://www.ibm.com/developerworks/java/library/j-jtp0618/index.html)，不能保证`MyObject`当其引用在线程之间共享时已经构造完成。当构造函数完成时，只有`final`构造函数中的字段才能保证正确初始化。任何其他字段可能已初始化，也可能未初始化，因此您需要在多个线程开始访问它之前对对象进行同步。

但是，如果该`mo`字段是 volatile 的，那么“发生在之前”的保证也可以确保`MyObject`已完全初始化。不允许编译器在发布`volatile`变量后重新排序这些指令。看：

*   [Java 中的 Volatile 是什么意思](http://jeremymanson.blogspot.com/2008/11/what-volatile-means-in-java.html)
*   [不稳定的保证和乱序执行](https://stackoverflow.com/questions/2441279/java-volatile-guarantees-and-out-of-order-execution)

# c++ - C++ 和 C 中括号的含义

> ID：11565023
> 
> 赞同：5
> 
> 时间：2012-07-19T16:16:44.090
> 
> 标签：c++, c

我刚刚在 C++ 中有一个讨厌的错误。所以我有寄存器和值的列表，它们被包装在一个结构中，然后这些结构在一个数组中被初始化。但后来我不小心输入`()`了`{}`. 这是一些测试代码：

```
#include <stdio.h>

struct reg_val {
        unsigned reg;
        unsigned val;
};

struct reg_val faulty_array[] = { 
        {0x5001, 0xff},
        {0x5580, 0x01},
        (0x5580, 0x02), //<- THIS LINE IS THE PROBLEM
        (0x5589, 0x00), //<- AND THIS LINE
};

struct reg_val good_array[] = { 
        {0x5001, 0xff}, 
        {0x5580, 0x01}, 
        {0x5580, 0x02},
        {0x5589, 0x00},
};

int main()
{
        unsigned i;
        unsigned faulty_size = sizeof(faulty_array) / sizeof(struct reg_val);
        printf("Size of faulty array: %d\n", faulty_size);

        for (i = 0; i < faulty_size; ++i) {
                printf("faulty reg: %x  val: %x\n", faulty_array[i].reg,
                       faulty_array[i].val);
        }   

        unsigned good_size = sizeof(good_array) / sizeof(struct reg_val);
        printf("\nSize of good array: %d\n", good_size);
        for (i = 0; i < good_size; ++i) {
                printf("good reg: %x  val: %x\n", good_array[i].reg,
                       good_array[i].val);
        }   
        return 0;
} 
```

我对 C 更熟悉，令我惊讶的是，这仍然是用 g++ 编译的：

```
$ g++ -Wall array.cc
array.cc:11: warning: left-hand operand of comma has no effect
array.cc:12: warning: left-hand operand of comma has no effect
array.cc:13: warning: missing braces around initializer for ‘reg_val’
$ ./a.out 
Size of faulty array: 3
faulty reg: 5001  val: ff
faulty reg: 5580  val: 1
faulty reg: 2  val: 0       <-- the first value gets discarded as mentioned in the compiler warning

Size of good array: 4
good reg: 5001  val: ff
good reg: 5580  val: 1
good reg: 5580  val: 2
good reg: 5589  val: 0 
```

这段代码显然无法用 C 编译器编译，C++ 有什么区别使 C++ 编译器（尽管不情愿地）接受这段代码？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T16:19:57.147

是什么让您认为它无法在 C 中编译？

C++： http: [//ideone.com/KLPh4](http://ideone.com/KLPh4) C：http: [//ideone.com/VYUbL](http://ideone.com/VYUbL)

**注意你的警告。** 我怎么强调都不过分。警告可以帮助您发现此类错误。

好吧，C 中的错误消息非常清楚地表明了区别：C 要求初始化器是常量，而不是任意表达式。为什么这些不被视为常量对我来说毫无意义，因为这在 C 中编译得很好：

*   [http://ideone.com/p5I1d](http://ideone.com/p5I1d)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-19T16:36:57.913

为了回答您的问题，我将首先回答：为什么这无法在 C 中编译？好吧，它无法编译，原因是：

```
initializer element is not constant 
```

为了更好的衡量，让我们`{}`从 C 中删除 s：

```
struct reg_val faulty_array[] = { 
        {0x5001, 0xff},
        {0x5580, 0x01},
        0x5580, 0x02, //<- THIS LINE IS THE PROBLEM
        0x5589, 0x00, //<- AND THIS LINE
}; 
```

现在程序输出：

```
Size of faulty array: 4
faulty reg: 5001  val: ff
faulty reg: 5580  val: 1
faulty reg: 5580  val: 2
faulty reg: 5589  val: 0 
```

这是 C 标准（和 C++）完全允许的。C（和 C++）展平大括号以初始化结构元素（这将回来）。您的代码在 C 中失败，因为具有静态存储持续时间的对象必须使用常量表达式或包含常量表达式的聚合初始化程序进行初始化。C 不将`(0x5580, 0x02)`其视为常量表达式。

这（不幸）在 C++ 中编译，因为 C++ 将两个常量表达式之间的逗号运算符视为常量表达式，因此您的代码更像：

```
struct reg_val faulty_array[] = { 
        {0x5001, 0xff},
        {0x5580, 0x01},
        0x02,
        0x00,
}; 
```

...当然，这是允许的。

```
struct reg_val faulty_array[] = { 
        {0x5001, 0xff},
        {0x5580, 0x01},
        {0x02, 0x00},
}; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-19T16:19:12.643

C++ 有一个逗号运算符，它计算其两个操作数并返回其右操作数的值，而忽略其左操作数。[你可以在这里更清楚地看到它。](http://codepad.org/POEMaIlt)

还有 C，显然 =）（谢谢，@BenVoigt）

# cakephp - jqplot 折线图图例超大

> ID：11565024
> 
> 赞同：2
> 
> 时间：2012-07-19T16:16:52.590
> 
> 标签：cakephp, jqplot

我有一个用于折线图的 jqplot，但我的图例变得太大了。我想为图例实现一个可滚动的功能。我尝试执行以下操作：

```
table.jqplot-table-legend {
    display: block;
    height: 350px;
    overflow-y: scroll;
} 
```

在css文件和我的ctp文件中，我试过了

```
legend: { 
    show: true, 
    location: 'ne',
    rendererOptions: {numberColumns: 2}
} 
```

正如之前的帖子中提到的，但似乎没有一个对我有用。请帮忙。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T22:42:43.937

如果我在图表呈现之前或之后应用您的 CSS，只需进行一次更改即可正常工作。我不得不增加它的 z-index 以便滚动条在顶部并且可以点击。这是在图表呈现后应用它的示例：

```
plot1 = jQuery.jqplot ('chart1', data, opts);

var legendTable = $($('.jqplot-table-legend')[0]);    
legendTable.css('display','block');
legendTable.css('z-index',100);
legendTable.css('height','100px');
legendTable.css('overflow-y','scroll'); 
```

[在这里](http://jsfiddle.net/larsenmtl/Czu38/)看小提琴。

# netbeans - 网豆。如何找出引用的库（未包含在项目代码中）？

> ID：11565025
> 
> 赞同：0
> 
> 时间：2012-07-19T16:16:52.667
> 
> 标签：netbeans, clone, libraries

我有一个 netbeans 项目：java Web 应用程序。

项目中的一些库不包含在代码目录中。例如

....netbeans\7.1\var\cache\index\s717\java\14\gensrc\javax\mail\MimeMessage

所以当我在其他机器上克隆项目时，找不到库，因为 netbeans 目录不同。有没有检查它的工具？也许是一个 netbeans 插件。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T19:42:17.673

尝试在 Netbeans 项目浏览器中右键单击库，然后选择“添加 JAR/文件夹”。从那里，导航到所需的 JAR，然后选择“Reference as Relative Path”。

![选择相对路径](../Images/411e17ca91b12924970c3ace0edd9c47.png)

# django - Django 登录呈现重定向的模板，但停留在登录 url

> ID：11565033
> 
> 赞同：1
> 
> 时间：2012-07-19T16:17:24.620
> 
> 标签：django, login, web, loginview

我正在尝试为我的 Django 网站创建一个登录页面。起初我尝试了 Django 附带的所有内置登录功能，但是我遇到了一个问题。我的问题是，目前登录页面一直在尝试重定向到主页。（我也尝试了另一个页面，没有工作）一旦用户登录，重定向页面呈现为 html，但是当它应该是 /mobile/ 或 / 时，url 保持为 /accounts/login/ 并且因为这没有任何链接工作，并且没有加载静态文件。

以下是我的登录视图代码：

```
def login(request):
        if request.method == "POST":
            redirect_to = request.POST['next']
            print 'method is post'
            form = AuthenticationForm(data=request.POST)
            username = request.POST.get('username', '')
            password = request.POST.get('password', '')
            user = auth.authenticate(username=username, password=password)
            if form.is_valid() and user is not None and user.is_active:
                print 'form is valid'
                netloc = urlparse.urlparse(redirect_to)[1]
                print 'original redirect_to is: ',redirect_to
                # Use default setting if redirect_to is empty
                if not redirect_to:
                    print 'changing redict to default: ', redirect_to
                    redirect_to = settings.LOGIN_REDIRECT_URL

                print 'redirect to is: ',redirect_to
                # Heavier security check -- don't allow redirection to a different
                # host.
                #elif netloc and netloc != request.get_host():
                #    redirect_to = settings.LOGIN_REDIRECT_URL

                # Okay, security checks complete. Log the user in.
                print form.get_user()
                auth.login(request, user)
                print 'user logged in'

                return redirect(reverse('builds.views.mobile_view'))
        else:
            redirect_to = request.REQUEST.get('next')
            form = AuthenticationForm(request)
            c = {
                'next':redirect_to,
                'form': form,
                }

            print 'returning render to response login'
            return TemplateResponse(request,'registration/login.html', context = c) 
```

由于内置的​​登录视图似乎不起作用，我想如果我自己编写它可能会起作用，但问题仍然存在。

这是我的登录html代码：

```
<!-- Start of first page: START -->
<div data-role="page" class="type-interior" id="LOGIN" data-theme="a">
    {% if form.errors %}
    <div data-role="header" data-theme="a" data-content-theme="a">
        <h1>Your username and password didn't match. Please try again.</h1>
    </div><!-- /header -->

    {% else %}

    <div data-role="header" data-theme="a" data-content-theme="a">
        <h1>Please Enter Your Username and Password</h1>
    </div><!-- /header -->

    {% endif %}

    <form method="post" action="/accounts/login/" id="login_form">

        <label for="username">User name:</label>
        <input type="text" name="username" value="" id="username">

        <label for="password">Password:</label>
        <input type="password" name="password" value="" id="password">

        <input type="submit" value="Login" id="button"/>

        <input type="hidden" name="next" value="{{ next|escape }}" />

    </form>

    <div data-role="footer" data-theme="a">
        <h4></h4>
    </div>

</div> 
```

请帮我！我觉得我已经尝试了一切。另外请告诉我是否应该包含任何其他代码。

编辑：

好的！我已将问题缩小到我在登录页面的标题中使用的 java 脚本内容（我正在使用 jquery）。标题是：

```
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <title>Install Builds</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1 maximum-scale=1.0, user-scalable=no">
    <link rel="stylesheet" href="{{ STATIC_URL }}blablahblachname.css" />
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.1.0/jquery.mobile.structure-1.1.0.min.css" />
    <!--<script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.1.0/jquery.mobile-1.1.0.min.js"></script>-->
    <link rel="apple-touch-icon-precomposed" href="{{ STATIC_URL }}static/homepage_icon.png" />
    <link rel="icon" href="{{ STATIC_URL }}homepage_icon.png" type="image/vnd.microsoft.icon" />
</head> 
```

有解决办法吗？还是我必须完全排除 javascript，因此登录页面看起来平淡无奇:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T18:12:17.140

我认为这个问题与 jQuery 移动有关。您可以通过添加`data-ajax="false"`到您的表单元素来修复它，同时保留 jQuery Mobile 的其他功能，如[jQuery Mobile 的表单示例](http://jquerymobile.com/test/docs/forms/forms-sample.html)中所述。如果您需要的话，您可能需要在 jQuery Mobile 上阅读一些内容才能使 AJAX 登录正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T16:25:04.333

您是否尝试过使用`django.contrib.auth.views.login`with`next_page`参数？我在我的网站中使用过它，而且效果很好。请[仔细](https://docs.djangoproject.com/en/1.1/topics/auth/#how-to-log-a-user-in)阅读。

# php - Yii 与 ob_gzhandler; 压缩html

> ID：11565038
> 
> 赞同：0
> 
> 时间：2012-07-19T16:17:32.997
> 
> 标签：php, html, yii

我已将此代码添加到`main.php`Yii 上的配置文件中以压缩 html 标记

```
'preload'=>array('log'),
    'onBeginRequest' => create_function('$event', 'return ob_start("ob_gzhandler");'),  
    'onEndRequest' => create_function('$event', 'return ob_end_flush();'), 
```

但我与 zlib 有冲突，我该如何解决？

```
ob_start(): output handler 'ob_gzhandler' conflicts with 'zlib output compression' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T22:21:57.363

你最好在 yii 级别**缩小html 代码**

通过在 .htaccess 中使用这样的段将 gzip 压缩到 apache

```
<IfModule deflate_module>
AddOutputFilterByType DEFLATE text/html text/plain text/xml text/javascript text/css application/json application/javascript

# Netscape 4.x has some problems...
BrowserMatch ^Mozilla/4 gzip-only-text/html

# Netscape 4.06-4.08 have some more problems
BrowserMatch ^Mozilla/4\.0[678] no-gzip

# MSIE masquerades as Netscape, but it is fine
BrowserMatch \bMSIE !no-gzip !gzip-only-text/html

# Do NOT compress localhost
#SetEnvIf Remote_Host 127.0.0.1 no-gzip

# Make sure proxies don't deliver the wrong content
Header append Vary User-Agent env=!dont-vary
</IfModule> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T16:27:00.310

这是 PHP 5.4 的一个错误：[https ://bugs.php.net/bug.php?id=62335](https://bugs.php.net/bug.php?id=62335)

您可能需要禁用`zlib`类似的东西：

```
<?php ini_set('zlib.output_compression', 'Off'); ?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-13T15:03:40.497

用于 Apache 的 Google pagespeed 模块与我一起使用，它预装在 dreamhost 和一些虚拟主机上：

[https://developers.google.com/speed/pagespeed/module](https://developers.google.com/speed/pagespeed/module)

# c# - 替换 CSV 导出中的值

> ID：11565041
> 
> 赞同：0
> 
> 时间：2012-07-19T16:17:40.450
> 
> 标签：c#, asp.net-mvc-3, entity-framework, csv

我正在使用 NuGet 的 CSVHelper 组件。我已成功导出所有数据。但是，我有几个布尔类型的字段并将“true”/“false”返回到 csv 文件。我的项目要求我输出“1”或“0”而不是“true”/“false”。实现这一目标的最简单方法是什么？

```
 var AllRecords = surveyResponseRepository.Get()
                    .Where(r => r.ProgramId == ProgramId);

    string uniqueID = Guid.NewGuid().ToString(); 

    var appData = Server.MapPath("~/CsvExport/" + uniqueID + ".csv");

    using (var csv = new CsvWriter(new StreamWriter(appData)))

    {
        csv.Configuration.HasHeaderRecord = true;
        csv.Configuration.Delimiter = ',';
        csv.WriteRecords(AllRecords);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:28:58.520

我相信您可以继承 CsvWriter 并将 WriteField 覆盖为如下所示：

```
 public override void WriteField( string field )
    {
        if (field.ToLower() == bool.TrueString.ToLower())
             field = "1";
        if (field.ToLower() == bool.FalseString.ToLower())
             field = "0";
        base.WriteField(field);
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T16:23:09.903

循环遍历 AllRecords 中的每条记录，找到由布尔值表示的字段，并使用以下内容转换为整数值：

```
Convert.ToInt32(booleanValue); 
```

# animation - Cocos2d 一个精灵的两个动画

> ID：11565044
> 
> 赞同：1
> 
> 时间：2012-07-19T16:17:51.693
> 
> 标签：animation, cocos2d-iphone, ccsprite, sprite-sheet

我像这样为我的角色设置动画：

```
-(void) createHero
{

    _batchNode = [CCSpriteBatchNode batchNodeWithFile:@"Snipe1.png"];
    [self addChild:_batchNode];
    [[CCSpriteFrameCache sharedSpriteFrameCache] addSpriteFramesWithFile:@"Snipe1.plist"];

    //gather list of frames
    NSMutableArray *runAnimFrames = [NSMutableArray array];
    for(int i = 1; i <= 7; ++i) 
    {
        [runAnimFrames addObject:
        [[CCSpriteFrameCache sharedSpriteFrameCache] spriteFrameByName:
        [NSString stringWithFormat:@"run000%d.png", i]]];
    }

    //create sprite and run the hero
    self.hero = [CCSprite spriteWithSpriteFrameName:@"run0001.png"];
    _hero.anchorPoint = CGPointZero;
    _hero.position = self.heroRunningPosition;

    //create the animation object
    CCAnimation *runAnim = [CCAnimation animationWithFrames:runAnimFrames delay:1/30.0f];
    self.runAction = [CCRepeatForever actionWithAction: [CCAnimate actionWithAnimation:runAnim restoreOriginalFrame:YES]];

    [_hero runAction:_runAction];
    [_batchNode addChild:_hero z:0];
} 
```

这很好用，我的角色正在运行，但现在我想要他跳跃时的第二个动画。目前我是这样的：

```
-(void)changeHeroImageDuringJump 
{
    [_hero setTextureRect:[[CCSpriteFrameCache sharedSpriteFrameCache] spriteFrameByName:@"run0007.png"].rect]; 
} 
```

但是现在我想要一个带有第二个 png 的第二个 plist，所以当角色跳跃时我会得到一个全新的动画。我该如何实施？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T16:24:05.077

就我而言，我实现了一个 AnimatedSprite 类来为我处理这个问题。这样，我添加这样的文件：

```
NSDictionary* anims = [NSDictionary dictionaryWithObjectsAndKeys:
        @"Animations/Character/idle_anim.plist", @"Idle",
        @"Animations/Character/walk_anim.plist", @"Walk",
        @"Animations/Character/run_anim.plist",    @"Run", nil];

CCNode* myNode = [[AnimatedSprite alloc] initWithDictionary:anims 
                      spriteFrameName: @"character_idle_01.png"
                        startingIndex:@"Idle"]; 
```

改变动画很简单：

```
[myNode setAnimation: @"Run"]; 
```

这是我的实现 这是.h

```
@interface AnimatedSprite : CCSprite
{
    NSMutableDictionary* _spriteAnimations;
    CCAction* _currentAnimation;
    NSString* _currentAnimationName;
    bool _initialized;
}
- (id) initWithTextureName:(NSString*) textureName;
- (id) initWithArray: (NSArray*) animList spriteFrameName: (NSString*) startingSprite startingIndex: (int)startingIndex;
- (id) initWithDictionary:(NSDictionary *)anims spriteFrameName:(NSString *)startingSprite startingIndex:(NSString *)startingAnim;

- (void) addAnimation: (NSString*) animationName andFilename: (NSString*) plistAnim;

- (void) setAnimationIndex: (int) index;
- (void) setAnimation: (NSString*) animationName;
@end 
```

这是.m

```
#import "AKHelpers.h"

@implementation AnimatedSprite

NSMutableDictionary* _spriteAnimations;

- (id) initWithTextureName:(NSString*) textureName
{
    CCTexture2D* texture = [[CCTextureCache sharedTextureCache] addImage:textureName];
    CCSpriteFrame* frame = [CCSpriteFrame frameWithTexture:texture rect: CGRectMake(0, 0, 1, 1)];

    if ((self=[super initWithSpriteFrame:frame]))
    {
        _currentAnimationName = nil;
        _currentAnimation = nil;
        _spriteAnimations = [[NSMutableDictionary alloc] init ];
        _initialized = true;

    }
    return self;
}
- (id) initWithArray: (NSArray*) animList spriteFrameName: (NSString*) startingSprite startingIndex: (int)startingIndex
{
    _initialized = false;
    _spriteAnimations = [[NSMutableDictionary alloc] init];

    // Add animations as numbers from 0 to animList.count
    int i = 0;
    for (NSString* anim in animList)
    {
        [self addAnimation: [NSString stringWithFormat:@"%d", i] andFilename:anim];
        i++;
    }

    if ((self = [super initWithSpriteFrameName:startingSprite]))
    {
        _currentAnimationName = nil;
        _currentAnimation = nil;
        [self setAnimationIndex: startingIndex];  
        _initialized = true;  
    }

    return self;
}

- (id) initWithDictionary:(NSDictionary *)anims spriteFrameName:(NSString *)startingSprite startingIndex:(NSString *)startingAnim
{
    _initialized = false;
    _spriteAnimations = [[NSMutableDictionary alloc] init];//[[NSMutableArray alloc] init];

    // Add animations
    for (NSString* key in anims)
    {
        [self addAnimation: key andFilename: [anims objectForKey: key] ];
    }

    if ((self = [super initWithSpriteFrameName:startingSprite]))
    {
        _currentAnimationName = nil;
        _currentAnimation = nil;
        [self setAnimation: startingAnim];
        _initialized = true;

    }
    return self;
}
- (void) dealloc
{
    [_currentAnimationName release];
    [_spriteAnimations release];
    [super dealloc];
}

- (void) setAnimation: (NSString*) animationName
{
    if (![_currentAnimationName isEqualToString:animationName])
    {
        [_currentAnimationName release];
        _currentAnimationName = [animationName copy];

        // Stop current animation
        if (_currentAnimation != nil)
            [self stopAction:_currentAnimation];
        //[self stopAllActions];

        // Apply animation
        NSDictionary* clip = [_spriteAnimations objectForKey: animationName];
        if (clip)
        {
            _currentAnimation = [AKHelpers actionForAnimationClip:clip];
            if (_currentAnimation)
                [self runAction:_currentAnimation];
        }
        else
        {
            _currentAnimation = nil;
        }
    }
}

- (void) setAnimationIndex: (int) index
{
    [self setAnimation: [NSString stringWithFormat:@"%d", index]];
}

- (void) addAnimation: (NSString*) animationName andFilename: (NSString*) plistAnim
{
    NSDictionary *clip = [AKHelpers animationClipFromPlist:plistAnim];

    if (clip)
    {
        [_spriteAnimations setObject:clip forKey:animationName];        

        if (_initialized && [_spriteAnimations count] == 1)
        {
            [self setAnimation:animationName];
        }
    }
}

@end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T16:23:11.613

为跑步和跳跃创建两个不同的动画动作。根据需要运行这些操作。

# android - 阵列适配器 过滤器只从单词的开头匹配

> ID：11565054
> 
> 赞同：2
> 
> 时间：2012-07-19T16:18:22.080
> 
> 标签：android

我有一个`ListView`由`ArrayAdapter<String>`. 内容如：

*   309
*   C309
*   309
*   一辆C309
*   一个 309N

如果我执行：`....getFilter().filter("309")`在我的适配器上，结果是：

*   309
*   309
*   一个 309N

基本上只返回在新字符串开头匹配的内容。只是想知道这是否按预期工作，因为我想返回所有有子字符串匹配的字符串？

在此先感谢，彼得

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T16:57:28.717

是的，这是预期的行为（据我所知）。
在[ArrayAdapter.java](https://github.com/android/platform_frameworks_base/blob/master/core/java/android/widget/ArrayAdapter.java#L483)的第 483 行，您会发现：`if (valueText.startsWith(prefixString)) {`
然后它将字符串拆分为单词并在每个单词上执行 startsWith()。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-19T17:47:35.323

您应该使用 String 方法`startsWith()`。这是它的 Javadoc 页面：

[http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/String.html#startsWith(java.lang.String](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/String.html#startsWith(java.lang.String) )

编辑：因此，在您的 ArrayAdapter 的上下文中，您只需遍历每个值并检查该`startsWith()`方法是否匹配。

# r - 按名称从数据框中删除一列

> ID：11565055
> 
> 赞同：6
> 
> 时间：2012-07-19T16:18:22.637
> 
> 标签：r, dataframe

> **可能重复：**
> [从 R 中的 data.frame 中删除整个列](https://stackoverflow.com/questions/6286313/remove-an-entire-column-from-a-data-frame-in-r)

有没有比以下更好的方法从数据框中按名称删除列？

```
Orange[colnames(Orange) != "Age"] 
```

我尝试了以下方法，但出现错误：

```
> Orange[-"Age"]
Error in -"age" : invalid argument to unary operator
> Orange[,-"Age"]
Error in -"age" : invalid argument to unary operator
> Orange[[,-"Age"]]
Error in -"age" : invalid argument to unary operator 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-19T16:22:34.973

您可以将列设置为 NULL

```
> dat <- data.frame(a = 1, b = 1, c = 1)
> dat
  a b c
1 1 1 1
> dat$a <- NULL
> dat
  b c
1 1 1
> dat["b"] <- NULL
> dat
  c
1 1 
```

有人会过来指出，这`data.frame`将制作大量数据副本来完成这个简单的任务。当数据变大（数百万行）时，这将花费大量时间，并且由于内存限制可能无法正常工作。如果这将是一个问题，请使用`data.table`和`:=`操作员：

```
library(data.table)
> dt <- data.table(a = 1, b = 1, c = 1)
> dt[,a:=NULL]
     b c
[1,] 1 1 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-19T16:21:17.690

尝试：

```
Orange[-match("age",names(Orange))]
   Tree circumference
1     1            30
2     1            58
3     1            87
4     1           115
... 
```

# c# - 远程服务器返回错误：(403) Forbidden。在发布请求期间...？

> ID：11565057
> 
> 赞同：1
> 
> 时间：2012-07-19T16:18:28.597
> 
> 标签：c#, c#-4.0, post, httpwebrequest, http-status-code-403

我尝试为自己制作小型应用程序，我发现了这个应用程序 [如何使用 c# 在 Dailymotion 上上传视频？有人有完整的代码吗？](https://stackoverflow.com/questions/9969219/how-to-upload-video-on-dailymotion-with-c-sharp-is-somebody-has-a-complete-co)

当我尝试了所有事情但发布不起作用时。我使用了提琴手，但我找不到错误。这是代码

```
 var request = WebRequest.Create("https://api.dailymotion.com/me/videos?url=" + Uri.EscapeUriString(uploadResponse.url));
        request.Method = "POST";
        request.ContentType = "application/x-www-form-urlencoded";
        request.Headers.Add("Authorization", "OAuth " + accessToken);

        var requestBytes = Encoding.UTF8.GetBytes("title=test 123&channel=Funny&tags=Humor&description=Testing testing&published=true");

        var requestBytes = Encoding.UTF8.GetBytes(requestString);

        var requestStream = request.GetRequestStream();

        requestStream.Write(requestBytes, 0, requestBytes.Length);

        var response = request.GetResponse();

        var responseStream = response.GetResponseStream();
        string responseString;
        using (var reader = new StreamReader(responseStream))
        {
            responseString = reader.ReadToEnd();
        } 
```

当它到达 request.GetResponse() 时，它会给出错误。那么这里有什么问题..？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T16:32:47.950

我相信您需要摆脱 url 中的“我”，因为您使用的是 OAuth 而不是基本身份验证，如下所示：

```
"https://api.dailymotion.com/videos?url=" 
```

代替：

```
"https://api.dailymotion.com/me/videos?url=" 
```

至少在看起来是这样的快速扫描中，我在一年前为客户编写了一个自动发布器，它没有`me`在 url 中使用。我的凭据现在无效，因此很遗憾无法对其进行测试。您链接的答案似乎是一个错误。

如果您可以阅读其他语言，我发现浏览他们的 SDK 并转换代码很有帮助：

[http://www.dailymotion.com/doc/api/sdk-php.html](http://www.dailymotion.com/doc/api/sdk-php.html)

[https://github.com/dailymotion/dailymotion-sdk-php/blob/master/Dailymotion.php](https://github.com/dailymotion/dailymotion-sdk-php/blob/master/Dailymotion.php)

# excel - Excel：结合重新格式化和邮件宏

> ID：11565061
> 
> 赞同：-1
> 
> 时间：2012-07-19T16:18:39.530
> 
> 标签：excel, vba, outlook

```
Sub Macro1()
'
' Macro1 Macro
'
' Keyboard Shortcut: Ctrl+q
'
    Rows("1:6").Select
    Selection.Delete Shift:=xlUp
    Rows("2:2").Select
    Selection.Delete Shift:=xlUp
    Columns("A:A").Select
    Selection.Delete Shift:=xlToLeft
    Rows("1:1").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorLight1
        .TintAndShade = 0.499984740745262
        .PatternTintAndShade = 0
    End With
    With Selection.Font
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
    End With
    Cells.Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Cells.EntireColumn.AutoFit
    Rows("1:1").Select
    Selection.Font.Bold = True
    Selection.AutoFilter
End Sub 
```

**第二个**

```
Option Explicit
Private Sub CommandButton1_Click()
        sendmail
End Sub

Public Function sendmail()
     On Error GoTo ende
    Dim esubject As String, sendto As String, ccto As String, ebody As String, newfilename As String
    Dim apps As Object, itm As Object

     esubject = "Systematic and Manually Created ASN"
     sendto = "ooooooo@hp.com"
     ccto = "iiiiiiii@hp.com"
     ebody = "Hello All" & vbCrLf & _
     "Please find the Systematically and Manually created ASN for the last month" & _
      vbCrLf & "With Regards" & vbCrLf & "Tarak"

     newfilename = "C:\Stuff.XLS"

     Set apps = CreateObject("Outlook.Application")
     Set itm = apps.createitem(0)

     With itm
         .Subject = esubject
         .To = sendto
         .cc = ccto
         .body = ebody
         .attachments.Add (newfilename)
         .display
         .Send
     End With

     Set apps = Nothing
     Set itm = Nothing

ende:

End Function 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T16:27:46.090

也许像这样

```
Option Explicit
Private Sub CommandButton1_Click()
    Rows("1:6").Select
    Selection.Delete Shift:=xlUp
    Rows("2:2").Select
    Selection.Delete Shift:=xlUp
    Columns("A:A").Select
    Selection.Delete Shift:=xlToLeft
    Rows("1:1").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorLight1
        .TintAndShade = 0.499984740745262
        .PatternTintAndShade = 0
    End With
    With Selection.Font
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
    End With
    Cells.Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Cells.EntireColumn.AutoFit
    Rows("1:1").Select
    Selection.Font.Bold = True
    Selection.AutoFilter

    sendmail
End Sub

Public Function sendmail()
     On Error GoTo ende
    Dim esubject As String, sendto As String, ccto As String, ebody As String, newfilename As String
    Dim apps As Object, itm As Object

     esubject = "Systematic and Manually Created ASN"
     sendto = "ooooooo@hp.com"
     ccto = "iiiiiiii@hp.com"
     ebody = "Hello All" & vbCrLf & _
     "Please find the Systematically and Manually created ASN for the last month" & _
      vbCrLf & "With Regards" & vbCrLf & "Tarak"

     newfilename = "C:\Stuff.XLS"

     Set apps = CreateObject("Outlook.Application")
     Set itm = apps.createitem(0)

     With itm
         .Subject = esubject
         .To = sendto
         .cc = ccto
         .body = ebody
         .attachments.Add (newfilename)
         .display
         .Send
     End With

     Set apps = Nothing
     Set itm = Nothing

ende:

End Function 
```

# sql - 如何使用来自 2 个不同表的打印创建存储过程？

> ID：11565066
> 
> 赞同：0
> 
> 时间：2012-07-19T16:18:55.833
> 
> 标签：sql, sql-server, sql-server-2008

我在数据库中有 3 个表，1 个是瑜伽课，另一个是成员以及它们之间的交集，我想创建一个存储过程，该过程将打印**指定**类的详细信息以及分配给班级。报告输出的格式应与以下内容相同：

```
YOGA CLASS REPORT:
___________________

Class ID: 1112
Week day:   Monday    [Time: 07:00:00]
Studio Number: 1

No.  Member Name         Contact Number
________________________________________
1    John Doe            +26 83 562 3953 
```

**到目前为止，我有：**

```
CREATE PROCEDURE sp_Report  
@classID SMALLINT  
AS  
  IF NOT EXISTS(SELECT * FROM class WHERE classID = @classID)      
  BEGIN  
     RAISERROR ('classID does not exist',16,1)  
     RETURN  
  END

  DECLARE @classWeekday VARCHAR(15)  
  DECLARE @classTime TIME  
  DECLARE @classStudioNo TINYINT

  SELECT @classWeekday = class.classWeekday, @classTime = class.classTime, 
         @classStudioNo = class.classStudioNo  
  FROM class  
  WHERE @classID = classID

  PRINT 'YOGA CLASS REPORT'  
  PRINT 'Class code:' +CAST(@classID AS VARCHAR)  
  PRINT 'Week day:' +@classWeekday +'[Time:' + CAST(@classTime AS VARCHAR)+ ']'   
  PRINT 'Studio Number' +CAST(@classStudioNo AS VARCHAR) 
```

我现在如何打印参加特定课程的所有成员？任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T16:30:40.880

您是否尝试过使用光标？

```
PRINT 'YOGA CLASS REPORT' 

DECLARE cClasses CURSOR FOR
SELECT classWeekday, classTime, classStudioNo  
FROM class  
WHERE classID = @classID

OPEN cClasses
FETCH NEXT FROM cClasses INTO @classWeekday, @classTime, @classStudioNo
WHILE @@FETCH_STATUS = 0
BEGIN

    PRINT 'Class code:' +CAST(@classID AS VARCHAR)  
    PRINT 'Week day:' +@classWeekday +'[Time:' + CAST(@classTime AS VARCHAR)+ ']'   
    PRINT 'Studio Number' +CAST(@classStudioNo AS VARCHAR)

FETCH NEXT FROM cClasses INTO @classWeekday, @classTime, @classStudioNo
END
CLOSE cClasses
DEALLOCATE cClasses 
```

这里有 msdn [DECLARE CURSOR SQL SERVER中的官方文档](http://msdn.microsoft.com/es-es/library/ms180169.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T17:57:34.680

这样的事情会给你参加每个班级的人......

```
SELECT 
     c.MemeberID
     , m.MemberName
     , m.ContactNumber
FROM 
     class c
     INNER JOIN members m ON
         c.MemberID = m.MemberID 
WHERE c.classID = @classID 
```

查看这个[Stack Overflow 问题](https://stackoverflow.com/questions/268384/print-statement-in-t-sql)，我想知道您为什么实际使用`PRINT`？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T18:11:37.677

正如其他人所提到的，我很好奇您为什么要为此使用 print ，但鉴于这是一个约束，您必须通过连接进行光标移动。下面是一些示例代码和一个工作示例。

编辑：我只想补充一点，通常在使用 SQL 时，您会希望避免使用游标。SQL 是一种基于集合的语言，游标是过程性的。因此，虽然我给出了一个使用游标的示例以满足必须打印每个结果的约束，但我不会在任何生产环境中这样做。

```
declare @class table (classID int, className nvarchar(100))
insert @class values (1,'TSQL'),(2,'SQL Server')
declare @members table (memberID int, memberName nvarchar(100), contactNumber nvarchar(100))
insert @members values (1, 'John Doe', '+26 83 562 3953'), (2, 'Bert Evans','+26 83 562 3954')
declare @classmembers table (classID int, memberID int)
insert @classmembers values (1,1),(1,2)

declare attendees cursor for 
    select rsMembers.memberID, memberName, contactNumber
    from @members rsMembers
    inner join @classmembers rsClassMembers on rsClassMembers.memberID = rsMembers.memberID
    where rsClassMembers.classID = 1

open attendees
declare @number int, @name nvarchar(100), @contact nvarchar(100)
fetch next from attendees into @number, @name, @contact
while @@FETCH_STATUS = 0
begin

    print cast(@number as nvarchar(100)) + ' ' + @name + ' ' + @contact
    fetch next from attendees into @number, @name, @contact

end
close attendees
deallocate attendees 
```

[工作示例。](https://data.stackexchange.com/stackoverflow/query/75710)

# javascript - HTML Select 填充有搜索问题

> ID：11565067
> 
> 赞同：12
> 
> 时间：2012-07-19T16:19:03.883
> 
> 标签：javascript, html, css, padding, html-select

我有一个 HTML 选择，其中包含如下项目。

```
<SELECT id="mylist" size=5 >
   <OPTION Value="100">100</OPTION>
   <OPTION Value="200">200</OPTION>
   <OPTION Value="210">210</OPTION>
   <OPTION Value="211">211</OPTION>
</SELECT> 
```

![在此处输入图像描述](../Images/189c84014de09ee708153dbec8577385.png)

现在，如果我在内部单击`SELECT`并键入 21，那么它将选择`210`第一个以 21 开头的项目。一切都很好。

后来我想根据客户的要求在项目的左侧添加一个填充。但很快我意识到填充在`SELECT`IE 中不起作用（至少在我测试的 IE6 和 IE7 上）

所以我加了`&nbsp;&nbsp;`

```
<SELECT id="mylist" size=5 >
   <OPTION Value="100">&nbsp;&nbsp;100</OPTION>
   <OPTION Value="200">&nbsp;&nbsp;200</OPTION>
   <OPTION Value="210">&nbsp;&nbsp;210</OPTION>
   <OPTION Value="211">&nbsp;&nbsp;211</OPTION>
</SELECT> 
```

![在此处输入图像描述](../Images/aef6502ecdfe0d521eb6493c53cc6a41.png)

现在我可以模仿填充。

但我失去了搜索选项。当我在 IE 中输入 21 时，它不会选择 210。它在 chrome 中运行良好。请分享你的想法。

[在这里](http://jsfiddle.net/rjXHa/)找到样品

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-22T11:42:05.770

如何将其包装在 div 中：

HTML：

```
<div class="listwrapper">
    <SELECT id="mylist" size=5 >
        <OPTION Value="100">100</OPTION>
        <OPTION Value="200">200</OPTION>
        <OPTION Value="210">210</OPTION>
        <OPTION Value="211">211</OPTION>
    </SELECT>
</div>​ 
```

CSS：

```
.listwrapper
{
    padding: 0px 0px 0px 15px;
    border: solid 1px silver;
    width: 50px;
}
.listwrapper select,
.listwrapper select:active
{
    border: none 0px white;
    width: 50px;
}
​ 
```

[我的小提琴](http://jsfiddle.net/e5XUz/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T08:25:38.547

`<style>`是一个内联元素，因此添加填充在 IE6 中不起作用，但是`display:block;`可以克服这个问题

采用

```
<style>
    #mylist
{
    padding-left:10px;
    display:block;
}
</style>​ 
```

希望这会有所帮助。[在这里提琴](http://jsfiddle.net/cGbyP/7/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-27T10:54:19.833

尝试在 CSS 中使用对齐

```
​select { width:auto; }
option { text-align:center; } 
```

这确实有效。这是[jsfiddle中的证明](http://jsfiddle.net/rjXHa/43/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-26T11:04:00.127

提供移动选项所需的左填充

```
#mylist
{
  padding-left: 10px;
} 
```

检查这个[小提琴](http://jsfiddle.net/EZHxv/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-26T13:25:23.423

是的，维杰的答案是正确的方法。我们应该始终使用`CSS`而不是任何其他。

这是示例：-

```
<select  size="10" style="text-align:center">
<option value="1">First</option>
<option value="2">Second</option>
<option value="3">Third</option>
<option value="4">Four</option>
</select> 
```

放置尺寸不是强制性的。

希望它是完整的帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-03-17T09:22:52.157

覆盖浏览器搜索的 javascript 代码可以是这样的。例如，请参阅运行代码片段。

```
if (!dimon) {
	var dimon = {};
}
if (!dimon.select) {
	dimon.select = {
		/**
		 * Contains last typed character, and last selected option value
		 * (integer). For example, { "AlternativeMobileSelectionMenu" : { "char" :
		 * "s", "index" : 115 }, "AlternativeTariffSelectionMenu" : { "char" :
		 * "a", "index" : 0 } }
		 */
		hist : {},
		search : function(select, e) {
			// JQuery select object
			var select = $(select);
			if (!select) {
				return;
			}
			// id of HTML select, which is located under 0 index
			var sid = select[0].id;

			// dynamic HTML event
			e = e || window.event;
			var keycode = e.which || e.keyCode;
			keycode = String.fromCharCode(keycode);
			// Search should be case-insensitive
			keycode = keycode.toLowerCase();

			if (keycode < 'a' && keycode > 'z') {
				// handle only alphabetic character is typed
				return;
			}

			// Prevent default browser behavior
			if (e.preventDefault) {
				e.preventDefault();
			} else {
				e.returnValue = false;
			}

			if (!this.hist[sid]) {
				this.hist[sid] = {};
			}
			var lastChar = this.hist[sid]['char'];
			if (keycode != lastChar) {
				// if a new character is typed, reset
				// last typed character
				this.hist[sid]['char'] = '';
				// and last selected option
				this.hist[sid]['index'] = -1;
			}

			// options which matches the input character
			var filteredOptions = new Array();
			// all select options
			var options = select.find("option");

			for (var i = 0; i < options.length; i++) {

				var opt = $(options[i]);
				// Example option text
				// "  30|25   █ Magenta Mobil L mit Top-Handy"
				// "                  Sony Xperia Z2 schwarz (1,00 EUR)"
				var text = opt.text().toLowerCase();

				// Regular expression finds the first alphabetic character
				var regexp = new RegExp("[^a-z]*([a-z]{1}).*", "i");
				var result = regexp.exec(text);
				// the output will be:
				// 'm'
				// 's'
				text = result != null ? result[1] : '';

				if (opt.val() != '' && text.indexOf(keycode) == 0) {
					// add option value, if it matches
					filteredOptions.push(opt.val());
				}
			}

			var size = filteredOptions.length;
			if (size == 0) {
				return;
			}

			// Example, if we have 2 mobile devices in the list
			// Samsung Galaxy S5
			// Sony Xperia Z2
			// and type 'S', then Samsung will be selected,
			// if we type 'S' for the second time, then Sony will be selected,
			// and if we type 'S' once again, then Samsung will be selected
			// again.
			// value of the first suitable option
			var firstOpt = parseInt(filteredOptions[0]);
			// value of the last suitable option
			var lastOpt = parseInt(filteredOptions[size - 1]);
			// Last selected option value
			var lastSelected = this.hist[sid]['index'];

			if (lastSelected == -1) {
				// Character is typed for the first time
				this.hist[sid]['char'] = keycode;
				this.hist[sid]['index'] = firstOpt;
				select.val(this.hist[sid]['index']);
				select.change();

			} else if (lastSelected >= 0 && lastSelected < lastOpt) {
				// The same character is typed, just increment the option value
				this.hist[sid]['index'] = lastSelected + 1;
				select.val(this.hist[sid]['index']);
				select.change();

			} else if (lastSelected >= 0 && lastSelected == lastOpt) {
				// The same character is typed, but the last suitable option was
				// already selected before.
				// So select the first option again
				this.hist[sid]['index'] = firstOpt;
				select.val(this.hist[sid]['index']);
				select.change();
			}
		}
	}
}
```

```
<html>
<head>
<script
	src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
</head>
<body>
	<select id="devices" size="1"
		onkeypress="dimon.select.search(this, event)">
		<option value="0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Apple iPhone
			5s 64GB Gold (199,95 EUR)</option>
		<option value="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Samsung
			Galaxy S5 LTE+ weiß (1,00 EUR)</option>
		<option value="2">&nbsp;30|25&nbsp;█&amp;nbsp;Sony Xperia Z2
			Tablet LTE+ (19,95 EUR)</option>
		<option value="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sony Xperia
			Z2 schwarz (1,00 EUR)</option>
		<option value="4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sony Xperia
			Z2 weiß (1,00 EUR)</option>
	</select>
</body>
</html>
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-07-20T07:48:49.477

我做了这个，我假设你想要这样的东西：[**MyFiddle**](http://jsfiddle.net/cGbyP/)

```
<style>
    option {
    width: 40px;
    text-align: center;
    }
</style>

<SELECT id="mylist" size=5 >
   <OPTION Value="100">100</OPTION>
   <OPTION Value="200">200</OPTION>
   <OPTION Value="210">210</OPTION>
   <OPTION Value="211">211</OPTION>
</SELECT> 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2012-07-23T08:56:06.420

使用   在 IE 中获取正确的填充，并使用键事件根据按下的键选择项目。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2012-07-24T19:09:10.993

这可能是您的 IE6/7 问题的一部分：

[IE 的默认 CSS 值](https://stackoverflow.com/questions/381558/ies-default-css-values)

放置默认 CSS 值的愚蠢地方。IE8 和更高版本似乎没有这个问题。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2012-07-24T23:29:31.127

jQuery 对此有解决方案，或者您可以使用`onkeypress`Event 来选择项目。

HTML

`<element onkeypress="JavaScriptCodeHere">`

JS

`object.onkeypress="JavaScriptCodeHere"`

从这里，替换`JavaScriptCodeHere`为您的 JS 脚本以根据按键提取数字。我不会为你做这件事，因为这不是这个网站的目的，但我可以为你指明正确的方向。

`keychar`并且`numcheck`可能会有所帮助；）

# emacs - 在 emacs 中扩展/自定义现有的颜色主题

> ID：11565071
> 
> 赞同：3
> 
> 时间：2012-07-19T16:19:20.683
> 
> 标签：emacs, customization

使用 emacs-24.1，我们如何扩展/自定义 emacs 中现有的颜色主题？我试着这样做

```
(custom-theme-set-faces
'tango
'(ido-first-match ((t (:foreground "008800" :weight bold)))) 
```

当我加载探戈时，它工作得很好。但是当我把它放在 .emacs.d/init.el 文件中时，它失败了，因为那时没有加载 tango 并且 emacs 抱怨未定义的 tango。这当然无济于事，因为我倾向于使用（load-theme ...）定期更改主题。我正在看的是加载主题时运行的某种钩子。可能吗 ？

当然，我可以修改 tango-theme.el 文件，但这不是我的目标。我想扩展现有的主题。我在我的初始化文件中试过这个

```
(load-theme 'tango-dark)

    (custom-theme-set-faces
    'tango-dark
    '(ido-first-match ((t (:foreground "#00cdef" :weight bold))))

(deftheme tango)

    (custom-theme-set-faces
    'tango
    '(ido-first-match ((t (:foreground "#008800" :weight bold)))) 
```

这适用于探戈主题。但探戈暗显示与探戈相同的颜色。因此，如何在加载现有主题之前自定义它们或在加载主题时设置自定义面。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T20:02:57.497

当我想定义一个新主题时，我修改一个给定的主题，然后我调用 (color-theme-print)。此函数将生成一个函数，帮助恢复我修改后的颜色主题。将生成的函数放入/包含在 .emacs 中。

color-theme-print 用于生成新的颜色主题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T16:53:31.233

您要查找的命令是`eval-after-load`.

# linux - 从 Map Reduce 调用系统命令

> ID：11565074
> 
> 赞同：0
> 
> 时间：2012-07-19T16:19:37.557
> 
> 标签：linux, hadoop, command, mapreduce

我想从我的 map reduce 程序中调用一个系统命令。我希望这个命令只运行一次，但似乎该命令无法识别。我的测试命令是： `hadoop dfs -mv /user/test/somefile1 /user/test/somefile2`

我正在使用以下命令发出命令：

```
String envp[] = new String[1];
envp[0] = "Path=" + System.getProperty("java.library.path");
Process p = Runtime.getRuntime().exec("hadoop fs -mv /user/test/somefile1 /user/test/somefile2", envp); 
```

我有两个问题，

1.  放置此代码以便它只执行一次的最佳位置在哪里？

2.  为什么我发出此命令的环境实际上并未运行该命令？

我在其他命令中也注意到了这一点。

当我发出 hadoop 命令时，我没有收到错误，但没有发生移动。如果我从 linux 命令行运行相同的命令，它确实有效。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T18:49:21.523

一些评论：

1.  `hadoop dfs -mv`假定源和目标的文件系统是 hdfs，除非您在参数中提供模式（例如，`file:///user/test/somefile1`）。
2.  例如，如果您在 Hadoop 工具或 Job.configure 中运行此命令，那么当您可以在 Java 中本地调用它时，为什么要生成一个单独的进程（您似乎忽略了它的退出代码，因此没有错误）`srcPath.getFileSystem( cfg ).rename( srcPath, dstPath )`？

# mysql - MYSQL查询条件语句

> ID：11565079
> 
> 赞同：0
> 
> 时间：2012-07-19T16:19:52.770
> 
> 标签：mysql, conditional-statements

我有一个查询问题：我有一个表格，其中列出了客户下的订单

```
orders: customer_id, payment_method ...some other field 
```

如果客户使用特定付款方式进行了至少一次付款，我需要提取 customer_id 和“YES”

我试过这样的事情：

```
SELECT DISTINCT o.customer_id, 
CASE WHEN o.payment_method = 10 THEN 'YES' ELSE 'NO' END AS credit_card
FROM orders AS o
WHERE o.year = 2012
ORDER BY o.customer_id 
```

但是如果客户使用不同的付款方式付款，则会显示两条记录，一条为“YES”，一条为“NO”……有可能只得到一个值吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T16:22:48.490

```
SELECT   o.customer_id, 
         IF(MAX(IF(o.payment_method=10, 1, 0)) = 1, 'YES', 'NO') credit_card
FROM     orders o
WHERE    o.year = 2012
GROUP BY o.customer_id 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T16:23:56.750

您可以使用 group by 进行自联接并在联接表中测试 NULL（未经测试）：

```
SELECT customer_id, IF(p.customer_id IS NULL, 'NO', 'YES')
FROM orders o
LEFT OUTER JOIN orders p ON o.customer_id = p.customer_id AND p.payment_method = 10
    AND p.year = 2012
WHERE o.year = 2012
GROUP BY o.customer_id
ORDER BY o.customer_id 
```

不确定您是否需要该`p.year = 2012`条件。

# python - 多个 re.sub() 语句

> ID：11565083
> 
> 赞同：4
> 
> 时间：2012-07-19T16:20:16.017
> 
> 标签：python, regex, string

在我的程序中，用户输入一个我在发送之前处理的术语。此过程的一部分是将“and”、“or”和“not”的所有实例更改为大写字母，但其余部分保持不变。

我不能使用`string.upper()`，因为它将所有内容都更改为大写；或者`string.replace()`因为如果'and' 在字符串中的另一个单词中，例如'salamander'，它也会将其更改为'salamANDer'。我认为我最好的选择是正则表达式`re.sub()`函数。这使我可以更改完美的完整单词。下一个问题：我必须为`re.sub()`我想做的每一个改变做一个函数。是否可以发表一份声明来完成所有更改？我所做的并没有错，但我认为它不一定是好的做法：

```
>>import urllib2
>>import re
>>query = 'Lizards and Amphibians not salamander or newt'
>>query=re.sub(r'\bnot\b', 'NOT',query)
>>query=re.sub(r'\bor\b', 'OR',query)
>>query=re.sub(r'\band\b', 'AND',query)
>>query = urllib2.quote("'"+query+"'")

>>print query
%27Lizards%20AND%20Amphibians%20NOT%20salamander%20OR%20newt%27 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-07-19T16:22:54.197

您可以在中传递函数替换表达式`re.sub()`：

```
>>> term = "Lizards and Amphibians not salamander or newt"
>>> re.sub(r"\b(not|or|and)\b", lambda m: m.group().upper(), term)
'Lizards AND Amphibians NOT salamander OR newt' 
```

但是，我可能会使用非正则表达式解决方案：

```
>>> " ".join(s.upper() if s.lower() in ["and", "or", "not"] else s
...          for s in term.split())
'Lizards AND Amphibians NOT salamander OR newt' 
```

这也使空格标准化并适用于混合大小写的单词，例如`And`.

# class - 如何在 MapReduce 中使用 sqoop 生成的类？

> ID：11565087
> 
> 赞同：5
> 
> 时间：2012-07-19T16:20:24.787
> 
> 标签：class, import, mapreduce, sqoop

sqoop 查询生成一个 java 文件，其中包含一个类，该类包含在 mapreduce 中访问每行的列数据的代码。（Sqoop 导入是在没有 --as-sequencefile 选项的文本中完成的，每条记录有 1 行，列之间有逗号）但是我们如何实际使用它呢？

我在这个类中找到了一个公共方法 parse()，它将 Text 作为输入并填充类的所有成员，所以为了练习，我修改了 wordcount 应用程序，将映射器中 TextInputFormat 中的一行文本转换为sqoop 生成的类。但是，当我调用 parse() 方法时，这会导致“未报告的 exception.com.cloudera.sqoop.lib.RecordParser.ParseError；必须被捕获或声明为抛出”。

可以这样做还是使用每个记录中的数据填充类所需的自定义 InputFormat ？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T15:39:13.263

好的，一旦你发现这似乎很明显，但作为一个 java 初学者，这可能需要时间。

首先配置您的项目：只需在源文件夹中添加 sqoop 生成的 .java 文件。我使用 eclipse 将它导入到我的类源文件夹中。

然后只需确保您正确配置了项目的 java 构建路径：

在项目的properties/java build path/libraries/add external jar中添加以下jar文件：（对于hadoop cdh4+）：

```
/usr/lib/hadoop/hadoop-common.jar 
/usr/lib/hadoop-[version]-mapreduce/hadoop-core.jar
/usr/lib/sqoop/sqoop-[sqoop-version]-cdh[cdh-version].jar 
```

然后调整你的mapreduce源代码：首先配置它：

```
public int run(String [] args) throws exception
{
 Job job = new Job(getConf());
 job.setJarByClass(YourClass.class);
 job.setMapperClass(SqoopImportMap.class);
 job.setReducerClass(SqoopImprtReduce.class);

 FileInputFormat.addInputPath((job,"hdfs_path_to_your_sqoop_imported_file"));
 FileOutputFormat.setOutputPath((job,"hdfs_output_path"));

 // I simply use text as output for the mapper but it can be any class you designed
 // as long as you implement it as a Writable
 job.setMapOutputKeyClass(Text.Class);
 job.setMapOutputValueClass(Text.Class);

 job.setOutputKeyClass(Text.Class);
 job.setOutputValueClass(Text.Class);
 ... 
```

现在配置您的映射器类。假设您的 sqoop 导入的 java 文件名为 Sqimp.java: 并且您导入的表具有以下列：id、name、age 您的映射器类应该如下所示：

```
 public static class SqoopImportMap
 extends Mapper<LongWritable, Text, Text, Text> 
 {

 public void map(LongWritable k, Text v, Context context)
 {
  Sqimp s = new Sqimp(); 
  try
  {
  // this is where the code generated by sqoop is used.
  // it automatically casts one line of the imported data into an instance of the generated class, 
  // to let you access the data inside the columns easily
   s.parse(v);
  } 
  catch(ParseError pe) {// do something if there is an error.}

  try
  {
   // now the imported data is accessible:
   // e.g
   if (s.age>30)
   {
    // submit the selected data to the mapper's output as a key value pair.
    context.write(new Text(s.age),new Text(s.id));
   }
  }
  catch(Exception ex)
  {//do something about the error}
 }
} 
```

# css - 将 div 粘贴到稍后定义的 div 的右边框上

> ID：11565090
> 
> 赞同：3
> 
> 时间：2012-07-19T16:20:43.097
> 
> 标签：css, html

我在源代码中定义了以下 div：

```
<div id="container">
    <div id="right">Right</div>
    <div id="left">Left</div>
</div>​ 
```

我无法真正重新排序它们，所以我必须使用 CSS 以便它们出现在页面上，如下所示：

```
+---------------------+
| container           |
| +-------+-------+   |
| | left  | right |   |
| +-------+-------+   |
+---------------------+ 
```

挑战在于#left div 的内容可能是任意宽度，无论宽度是多少，我都需要#right div 贴在#left div 的右边框上。任何想法如何实现这一目标？

任何帮助表示赞赏！

此外，还有一个小限制：我需要 #left 和 #right 都与 #container div 的边框左侧对齐。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-19T16:24:21.593

您可以使用`float: right`移动`div#right`到`div#left`正确的一侧。`div#left`那也应该对齐to的右侧`div#right`。

```
#right, #left {
    float: right;
} 
```

[JS 小提琴示例](http://jsfiddle.net/MV7pB/2/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T16:32:15.017

尝试这个：

```
#container{
    margin:10px 10px;
}

#left,#right {
    float:left;
    padding:0px;
    height:100px;
    background-color:#000000;
}
#right{
background-color:#f1f1f1;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T16:45:15.980

## 更好的答案

允许`#right`设置边缘`#left`，同时仍然`#left`通过使用技巧来提供灵活性`overflow: hidden`（[参见小提琴](http://jsfiddle.net/MV7pB/10/)）：

```
#right {
    float: right;
}

#left {
    overflow: hidden; /* this causes non-floated `left` to behave different */
} 
```

## 原始答案

我会扩展 Rich 和 JSW189 的答案，因为我[不喜欢将](http://jsfiddle.net/MV7pB/3/)它们正确浮动的可能性。如果可以，请这样做，然后将容器向左浮动（[参见小提琴](http://jsfiddle.net/MV7pB/4/)），这要求`width`容器上没有设置，否则再次出现问题（[参见小提琴](http://jsfiddle.net/MV7pB/5/)）：

```
#container {
    float: left;
}

#right, #left {
    float: right;
} 
```

当然，***在某些应用程序中这是不可能的***（比如当你想要`width`在容器上时）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T16:23:27.127

在您的 CSS 中，尝试将它们都浮动到右侧，如下所示：

```
#left,#right { float:right; } 
```

**完整的 CSS**

```
 #container { 
      background:#ddd; 
      width:200px; 
      height:100px; 
 }

 #left, #right { 
      float:right;  
 }

 #left { 
      width:30%; 
      background:green; 
 }

 #right { 
      width:70%; 
      background:blue; 
 } 
```

[这是 jsFiddle 中的示例](http://jsfiddle.net/qakVd/)

**将它们都向左对齐**

如果您不使用固定百分比宽度（或根本不使用宽度），这将导致两者都`div#left`向右`div#right`浮动，如下所示：

```
+---------------------------------+
| container                       |
|             +-------+-------+   |
|             | left  | right |   |
|             +-------+-------+   |
+---------------------------------+ 
```

如果您想将它们向左对齐，请将它们包装在容器 div 中：

```
<div id="container-inner"> ... </div> 
```

并应用这个 css：

```
#container-inner { float:left; } 
```

导致：

```
+---------------------------------+
| container                       |
| +-------+-------+               |
| | left  | right |               |
| +-------+-------+               |
+---------------------------------+ 
```

希望有帮助

# jquery - 链接两个元素的悬停状态

> ID：11565094
> 
> 赞同：0
> 
> 时间：2012-07-19T16:20:54.020
> 
> 标签：jquery, hyperlink, hover

我有一个网格中的链接列表，以及这些链接的垂直菜单。我正在尝试链接这两组，以便当您将鼠标悬停在网格中的项目上时，菜单项也会突出显示，反之亦然。这是我到目前为止所得到的：

```
/* Grid */
<div class="pos-content count1"></div>
<div class="pos-content count2"></div>
<div class="pos-content count3"></div>

/* Menu */
<ul>
<li class="item177">Menu Link 1</li>
<li class="item178">Menu Link 2</li>
<li class="item179">Menu Link 3</li>
</ul>

<script type="text/javascript">
$(document).ready(function() {
    $('div.count1').click(function() {
        $("#item177").trigger("mouseover");
    });
});
</script> 
```

相关：[计算具有特定类的元素数量，然后添加对它们进行编号的 ID](https://stackoverflow.com/questions/11478777/count-the-number-of-elements-with-a-specific-class-then-add-an-id-that-numbers)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:27:46.277

没试过，但这可能有效：

```
$('.count1').hover(function(){
    $('#item77').addClass('highlight');
}, function(){
    $('#item77').removeClass('highlight');
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T16:33:30.633

你可以试试这个

```
$(document).ready(function() {
    $('div').hover(function() {
        $("ul li").eq($(this).index()).trigger("mouseover");
    }, function() {
        $("ul li").eq($(this).index()).trigger("mouseout");
    });

    $('ul li').hover(function() {
        $(this).css('background-color', 'red');
    }, function() {
        $(this).css('background-color', 'white');
    });
});​ 
```

[http://jsfiddle.net/LN2VL/](http://jsfiddle.net/LN2VL/)

# mysql - Mysql将两个表列值加载到Single中

> ID：11565097
> 
> 赞同：0
> 
> 时间：2012-07-19T16:21:12.580
> 
> 标签：mysql, join

我在数据库中有两个表。

```
Table1 -> Name
Table2 -> Name 
```

将查询从 Table1 和 Table2 中获取所有“名称”到单个列中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T16:24:55.183

此查询返回来自 Table1 的 Name 列和 Table2 的 Name 列的值，它们连接在一起形成一个结果集。

```
SELECT t1.Name FROM Table1 t1
 UNION ALL
SELECT t2.Name FROM Table2 t2 
```

（这是我对您要查找的内容的理解。）

如果您只想要名称值的“不同”列表（排除重复出现的相同值），请删除`ALL`关键字。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T16:27:11.393

如果我理解正确

[http://dev.mysql.com/doc/refman/5.0/en/union.html](http://dev.mysql.com/doc/refman/5.0/en/union.html)

从表 1 联合中选择名称 从表 2 中选择名称

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T16:25:38.723

您可以像这样从两个表中选择数据。

> SELECT CONCAT(table1.name,table2.name) as Name FROM table1,table2;

如果 table1.name 是 A 而 table2.name 是 b 你得到

姓名 = AB

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T16:27:58.287

```
SELECT Name FROM Table1 NATURAL LEFT JOIN Table2 AS t2. 
```

这将为您提供 Table1 和 Table2 中仅非重复名称的列表。

# javascript - javascript中的暂停功能

> ID：11565103
> 
> 赞同：0
> 
> 时间：2012-07-19T16:21:40.340
> 
> 标签：javascript

我有一个函数可以遍历表中的行，以便在任何给定时间只显示一个。

我想对此进行扩展，以便当我将鼠标悬停在表格上时，它会显示所有行，然后当我离开时，它会恢复一次显示一行。

我遇到的问题是，在悬停时，第一个功能继续运行，有没有办法“暂停”该功能。我查看了使用 ClearInterval() 的各种示例，但无法将它们与我的脚本匹配。

```
//Calling The function that loops through the rows    
function hideShow(time)
{   
    setInterval('showRows()',time); 
};      

//Set the time between each 'loop' and start looping 
$(document).ready(function()
{
    hideShow(2000);
}   
);

//The hover function to show / hide all the rows
$(document).ready(function()
{
    $('#dbTable1 tr').hover(function() 
        {
            $('.Group td').removeClass('RoundBottom');
            $('.Group').show();
        },  
        function()
        {
            $('.Group td').addClass('RoundBottom');
            $('.Group').hide();
        }
    ); 
}
); 
```

谁能告诉我如何将两者结合起来？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:27:23.493

您需要在调用时跟踪计时器 ID `setInterval`：

```
var timerID;

function hideShow(time){
  timerID = setInterval(showRows, time);
} 
```

然后稍后当您想停止重复时，调用`clearInterval`并传入该 ID：

```
// ...
  $('.Group td').removeClass('RoundBottom');
  $('.Group').show();
  clearInterval(timerID);
},
function()
{
  hideShow(2000);
  $('.Group td').addClass('RoundBottom');
  // ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T17:44:59.937

您可以在执行任何其他操作之前检查悬停状态，如下所示：

```
function showRows() {
    if (isHovering) {
        return;
    }

    // ...
} 
```

该`isHovering`变量只是一个具有当前悬停状态的布尔值，可以由您的回调函数设置。

使用上述方法，您可以只设置一次计时器并忘记它。

# python - pyparsing.operatorPrecedence 不会在无效字符串上引发错误

> ID：11565106
> 
> 赞同：3
> 
> 时间：2012-07-19T16:21:46.973
> 
> 标签：python, pyparsing

我希望解析一个表示布尔表达式的字符串。以下代码基于许多示例，并使用了 pyparsing 的 operatorPrecedence 帮助器。

问题是我希望代码在无法合理解析字符串时引发异常。就目前而言，许多无效的表达式只是悄悄地通过并返回错误的表达式。

```
import pyparsing

_A = pyparsing.Literal('A')
_B = pyparsing.Literal('B')

bool_operand = pyparsing.Or((_A, _B))

precedence_list = [("NOT", 1, pyparsing.opAssoc.RIGHT),
        ("AND", 2, pyparsing.opAssoc.LEFT),
        ("OR", 2, pyparsing.opAssoc.LEFT),]

bool_parser = pyparsing.operatorPrecedence(bool_operand, precedence_list)

print bool_parser.parseString('A OR B OR NOT A') # A valid string
print bool_parser.parseString('A NOT AND B') # an invalid string 
```

这输出：

```
[['A', 'OR', 'B', 'OR', ['NOT', 'A']]]
['A'] 
```

所以第一个字符串有效，但第二个字符串不会根据需要引发异常。

任何想法我怎么能做到这一点？我对 pyparsing 不是特别熟悉，所以我可能在那里遗漏了一些东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T16:25:39.970

更改 A_ 和 B_ 的定义以使用`Keyword`类而不是`Literal`类。

此外，当您调用 parseString 时，请添加`parseAll=True`以强制解析整个输入。

# c++ - 在 MFC 编辑框中单击

> ID：11565107
> 
> 赞同：4
> 
> 时间：2012-07-19T16:21:47.707
> 
> 标签：c++, windows, mfc

我在 MFC 对话框中创建了一个只读编辑框。我试图让用户点击编辑框，它是只读的，它打开一个文件对话框，然后使用 UpdateData 将此值放入文本框中。我正在捕捉`ON_EN_SETFOCUS`消息，但在文件对话框上按 OK 会重新生成它，所以我陷入了无限循环。

```
UpdateData(TRUE);
CFileDialog fileDialog(TRUE,NULL, NULL,OFN_HIDEREADONLY|OFN_FILEMUSTEXIST, _T("Text Files(*.txt)|*.txt||"));
if( fileDialog.DoModal() == IDOK )
{
    configFile=fileDialog.GetPathName(); //Note to self, this includes filename, getPathName includes filename and path.

}
else
{
    return;
}

UpdateData(FALSE); 
```

如果您对如何完成此操作有任何想法，我将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T19:24:54.877

好的，Lister 先生，我想我会添加一个答案。

首先，我可能会简单地添加一个按钮名称“...”以在编辑框右侧启动文件对话框以打开文件对话框，因为这是最简单的解决方案，也是大多数 Windows 用户所期望的。

然而，另一种选择是扩展 MFC 控件。在决定扩展控件时，您希望选择一个主要具有所需行为并且具有虚拟析构函数的控件，该析构函数适合于成为子类。由于您想要类似按钮的行为`CButton`可能是一个不错的选择。

您的类界面可能如下所示：

```
class CPathButton : public CButton
{
public:
    enum { ID /*= IDC_BUTTON1*/ };

    const CString GetPath() const;
    const CString GetFileName() const;
    const CString GetDirectory() const;
    const CString GetExtension() const;
    // other useful methods for setting file filters etc

protected:
    // add ON_CONTROL(BN_CLICKED, ID, &OnClick) or ON_BN_CLICKED(ID, &OnClick)
    DECLARE_MESSAGE_MAP()

    // CFileDialog fdlg.DoModal(), m_path = fdlg.GetPathName(), SetWindowText(fdlg.GetFileTitle()), etc
    afx_msg void OnClick();

    // additional message handlers etc

private:
    CString m_path; // save full path for after dialog is closed
}; 
```

您可以根据需要添加尽可能多或尽可能少的自定义，具体取决于控件是否将通过资源文件或其他方式动态创建。基本思想是您在按钮上显示当前选择的文件名，同时将完整路径存储为成员以供其他用途，因此用户不需要看到带有嵌套目录的长路径的混乱。

如果您不喜欢它的默认外观，您可以覆盖`OnPaint`和处理`WM_PAINT`消息并使用自定义字体、大小或为长文件标题添加省略号。您还可以通过使用文本度量来调整按钮的大小以适合文件标题，并`GetTextExtent`确保名称适合或`CToolTipCtrl`在他们将鼠标悬停在按钮上时仅显示 a 以便他们可以看到全名。VS2008+ 中的`CMFCButton`MFC 功能包具有内置的工具提示功能，因此如果您从该功能继承而不是`CButton`显示工具提示，则只需调用`SetTooltip(m_path)`

如果你想变得非常花哨，你可以使用一些[uxtheme API](http://msdn.microsoft.com/en-us/library/windows/desktop/bb773187%28v=vs.85%29.aspx)或新的[windows 动画 API](http://msdn.microsoft.com/en-us/library/windows/desktop/dd317017%28v=vs.85%29.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T16:42:58.353

您可以`PreTranslateMessage()`在对话框类中覆盖，并确定是否以这种方式单击了编辑控件：

```
CEdit m_CEditCtrl;
// ...

BOOL YourDialogClass::PreTranslateMessage(MSG *pMsg)
{
    if((pMsg->wParam == VK_LBUTTON) && (m_CEditCtrl.m_hWnd == pMsg->hwnd))
    {
       // open your file dialog
       return TRUE; // Return that the message was translated and doesn't need to be dispatched
    }
    return CDialog::PreTranslateMessage(pMsg);
} 
```

**更新：**您也可以（这可能是一个更好的主意）覆盖您的 CEdit 控件的`CWnd::PreTranslateMessage()`功能。这需要从 CEdit 派生一个类。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-20T07:20:20.560

如果您使用的是 VS2008 SP1 或更高版本，请求路径的最简单方法是使用[CMFCEditBrowseCtrl](http://msdn.microsoft.com/en-us/library/bb983421)。它显示一个带有按钮的编辑控件。使用它的步骤是：

*   将编辑控件的类更改为 CMFCEditBrowseCtrl
*   调用 EnableFileBrowseButton 告诉它您要浏览文件，而不是文件夹（您可以设置过滤器和默认扩展名）
*   当用户单击该按钮时，会出现一个文件对话框，当您在其中单击“确定”时，会将所选路径写入编辑控件中。

# php - 如何在查询中使用 LIKE 和 _？

> ID：11565108
> 
> 赞同：0
> 
> 时间：2012-07-19T16:21:51.513
> 
> 标签：php, sql

我有一个包含数千个 URL 的 sql 数据库。我不断更新它，而不使用 php5 对 Url 进行任何修改。

现在，我想只添加数据库中不存在的 url，我通过使用这个 sql 查询检查数据库来做到这一点

```
$q = $urlToCheck;
SELECT * FROM pligg WHERE rawUrl LIKE '$q%' 
```

这是问题所在，一些已经在数据库中的 Url 就像

```
http://example.com/a_b_c.html
http://example.com/a1b1c.html 
```

如果我运行查询

```
$q = 'http://example.com/a_b';
SELECT * FROM pligg WHERE rawUrl LIKE '$q%' 
```

然后它将返回两个 URL。我只想返回完全匹配的 URL。所以，我只想得到这个网址

```
http://example.com/a_b_c.html 
```

有什么帮助吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T16:23:56.177

对于**MySQL**，您需要转义`_`; 它应该是`\_`。对于**MSSQL**，它应该是`[_]`

**编辑**这是关于MySQL和转义通配符
[的手册页。](http://dev.mysql.com/doc/refman/5.0/en/string-comparison-functions.html)如果您愿意，您实际上可以指定转义字符。`_``%``_`

```
$q = 'http://example.com/a_b';
$qescaped = str_replace('_', '\_', $q);

$result = my_execute_query_function($qescaped); 
```

[这是 MSSQL 的手册页](http://msdn.microsoft.com/en-us/library/ms179859.aspx)。

```
$qescaped = str_replace('_', '[_]', $q); 
```

（另外：MSSQL 还允许您指定转义字符（我不知道））。

其他 RDBMS，如[PostgreSQL](http://www.postgresql.org/docs/9.1/static/functions-matching.html)、[Oracle](http://docs.oracle.com/cd/B19306_01/server.102/b14200/conditions007.htm)等可能有自己的转义字符和/或指定它们的方式。检查他们各自的手册页（为方便起见链接）。

# jquery - 使用 jquery 重新排列菜单：悬停事件不会在拖动时触发

> ID：11565110
> 
> 赞同：1
> 
> 时间：2012-07-19T16:21:56.397
> 
> 标签：jquery, jquery-ui

我正在尝试创建一个页面，该页面允许您使用 jquery 可排序功能重新排序菜单。菜单由一个导航栏和水平排列的链接组成；将鼠标悬停在链接上会将子菜单显示为下拉菜单，这可以按预期工作。但是，当拖动一个项目对其进行重新排序时，不会触发悬停事件，因此不会显示子菜单，从而阻止您将链接放入其中。

我认为这可能与被拖动的项目直接位于鼠标下方并阻止其他对象获取事件有关。我尝试过 mouseover 和 mouseout 而不是 hover，但这也不起作用。

有任何想法吗？

**编辑**：这是我的[jsfiddle](http://jsfiddle.net/5C8Fy/)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T17:05:30.557

您可以使用 jQuery UI`droppable`行为，然后将行为附加到`over`和`out`处理程序上。请参阅[我的 jsFiddle 分支](http://jsfiddle.net/nUBwd/4/)。

```
$('li', menu)
    .mouseover(function () { $('>ul', $(this)).show(); })
    .mouseout(function () { $('>ul', $(this)).hide(); })
    .droppable({
        over:function() { $('>ul', $(this)).show(); },
        out:function () { $('>ul', $(this)).hide(); }}); 
```

# javascript - 沿四边形的周长对点进行排序

> ID：11565111
> 
> 赞同：0
> 
> 时间：2012-07-19T16:21:59.627
> 
> 标签：javascript, algorithm, math, geometry, computational-geometry

为了计算[quadrangle 的质心](http://en.wikipedia.org/wiki/Centroid#Centroid_of_polygon)，点需要按照它们沿着***quadrangle***的周长出现的顺序进行排序。有4个点*p1，p2，p3，p4* ，每个点的坐标为*x，y ，所以对于**p1.x，p1.y，p2.x，......*沿周长对点进行排序的最有效方法是什么？

欢迎使用任何编程语言的公式或算法，Javascript 是首选。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:44:54.963

答案[https://stackoverflow.com/a/2122620/502144](https://stackoverflow.com/a/2122620/502144)可以帮助解决问题。但是，它不考虑点的顺序，只考虑点集。这是带有排序的修改表：

```
ABC  ABD  BCD  CAD  hull
------------------------
 +    +    +    -   ABCD
 +    +    -    +   ABDC
 +    -    +    +   ACBD 
```

ABC、ABD、BCD、CAD 是三角形的方向。仅考虑 4 个点形成凸四边形的情况。在其他情况下，任何排序都是有效的，导致非凸四边形。

# java - Java数据库查询/更新大量数据

> ID：11565112
> 
> 赞同：0
> 
> 时间：2012-07-19T16:22:02.423
> 
> 标签：java, database, jdbc

实现以下场景的最佳方法是什么？

我需要调用/查询包含来自 java 应用程序的数百万条记录的数据库表。然后对于表中的每条记录，我的应用程序应该调用第三方 API 并获取一个状态字段作为响应。然后我的应用程序应该再次使用来自 API 的信息（状态）更新表中的每一行。

注意-我正在尝试找出一种以最佳方式执行此操作的方法。我知道一起查询所有记录并不是最好的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T19:12:35.833

您可以使用 Oracle 功能，例如 SQL 加载器、通过 JDBC 或脚本调用的数据泵。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T16:25:06.643

不要试图一口气吃掉大象。切块。听说过分页吗？用它。请参见此处：[没有双重查询的 MySQL 分页？](https://stackoverflow.com/questions/818567/mysql-pagination-without-double-querying)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T16:26:36.020

数据库并非旨在通过 Java API 重复更新数百万条记录。这可能需要几分钟。如果这还不够，您可能需要使用嵌入在 Java 中的数据集（缓存或替换您的数据库）

# ruby-on-rails - 未知操作找不到 CarController 的操作“索引”

> ID：11565114
> 
> 赞同：0
> 
> 时间：2012-07-19T16:22:12.370
> 
> 标签：ruby-on-rails, routing, controller

我只是从我的应用程序中收到此错误，但我不知道为什么会这样。此外，我的应用程序转到了一个未指定的路线（抱歉，如果它有很多代码）。这是我的`routes.rb`：

```
Estaciones::Application.routes.draw do
  devise_for :users

   root :to => "user#index"
     resources :user do
     resources :car
   end

   get "user/new"
   post "user/create"
  get "user/:id" => "User#show"
end 
```

这是我的用户控制器（我没有问题，仅供参考）：

```
Class UserController < ApplicationController
  def new
    @user = User.new
  end

  def create
    @user = User.new(params[:user])
    if @car.save
      redirect_to :action => :show, :id => @user.id
    else
      redirect_to new_user_path
    end
  end

  def show
    @user = User.find(params[:id])
  end
end 
```

...我的汽车控制器：

```
class CarController < ApplicationController
  def new
    @car = Car.new
  end

  def create
    @user = User.find(params[:user_id])
    @car = @user.car.create(params[:car])
    if @car.save
      redirect_to :action => :show, :id => @user.id
    else
      redirect_to user_path(@user)
    end
  end
end 
```

这是我的一部分`html.erb`：

```
<h2>new car registration</h2>

  <%= form_for([@user, @user.car.build]) do |f| %>
  <p>
  <%= f.label :brand %><br />
  <%= f.text_field :brand %>
</p>
<p>
  <%= f.label :color %><br />
  <%= f.text_field :color %>
</p>
<p>
  <%= f.label :model %><br />
  <%= f.text_field :model %>
</p>
<p>
  <%= f.label :year %><br />
  <%= f.text_field :year %>
</p>
<p>
  <%= f.submit "Create new car"%>
</p> 
```

我的索引只是一个测试，但它有这个

```
<h1>WELCOME TO TANKING CONTROL ONLINE</h1>
<p>
  <strong>for new users </strong>
  <%= link_to 'sign up', :action => :new %>
</p> 
```

和用户注册的形式这个

```
<%= form_for :user, :url => { :action => :create } do |f| %>
  <p>
    <%= f.label :name %>
    <%= f.text_field :name %>
  </p>

  <p>
    <%= f.label :email %>
    <%= f.text_field :email %>
  </p>

  <p>
    <%= f.label :password %>
    <%= f.password_field :password %>
  </p>

  <p>
    <%= f.submit %>
  </p>
  <br>

  <%= link_to '<<Back', :action => :index %>
<% end %> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T16:30:27.533

您的 CarController 中缺少一个动作“索引”。

```
def index
end 
```

确保您的“汽车”视图中有一个“index.html.erb”。

[更新] 你的路线应该是

```
resources :users do
  resources :cars
end 
```

注意多个用户和汽车。

# vba - 从单元格中获取值列表

> ID：11565120
> 
> 赞同：-1
> 
> 时间：2012-07-19T16:22:21.193
> 
> 标签：vba, excel

我有一个 Excel 工作表，在该工作表上创建了一个包含许多值的列表。我还创建了一个宏，它显示了一个用户表单，其中这些值是硬编码的。

现在我希望表单中的这些值自动/以编程方式/动态添加到我的用户表单列表中，这样将来，如果我想减少列表中的值，那么我不必再次更改宏。

我一直在寻找答案，但一直未能找到我想要的东西。

我已经记录了这个宏，但我不知道如何从中检索值：

```
Sub Macro7()
'
' Macro7 Macro
'

'
Range("E1").Select
ActiveSheet.Range("$A$1:$AE$175").AutoFilter Field:=5
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T04:50:45.197

您指定的宏将为您的活动工作表打开自动筛选。这将提供允许用户过滤到感兴趣的内容的列标题。假设这种工作表的过滤是你想要的，你可以使用类似的东西：

```
Dim r As Range
'Note: set r to something useful, such as worksheet.Cells

Dim vis As Range
Set vis = r.SpecialCells(xlCellTypeVisible)

'now vis holds a special "Range" object referring to the visible cells.
'since (auto) filtering hides some cells, this vis range will help show only the cells that remain visible.
'the output of SpecialCells, you should assume holds a complex Range,
'which is composed of multiple Areas that are wrapped in one single Range object
'the separate areas help you distinguish the visible cells from the hidden cells
'fyi, various safety checks you can do: vis Is Range, vis Is Nothing

Dim a as Areas
Set a = r.Areas

Dim cr as Range
For Each cr in a
    'cr refers to a single (i.e. normal and contiguous) area range
    'where you can use cr.Row, cr.Column, cr.Rows.Count, cr.Columns.Count
Next 
```

因此，当您进行过滤时，您可以使用 SpecialCells(xlCellTypeVisible) 来显示非隐藏单元格，这些单元格表示为具有包含表示连续范围的区域的范围。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T14:11:13.500

使用一个名为 UReports 的用户表单，它有一个名为 lbxReport 的列表框，使用这样的代码用 E 列中的值填充列表框

```
Sub ShowUf()

    Dim ufReports As UReports
    Dim rCell As Range
    Dim colUnique As Collection
    Dim i As Long

    Set ufReports = New UReports
    Set colUnique = New Collection

    'loop through the cells in column E
    For Each rCell In Sheet1.Range("E2", Sheet1.Cells(Sheet1.Rows.Count, 5).End(xlUp)).Cells
        'Collections can't have duplicate keys, so we try to add all the values.  If there
        'are duplicates, the 'On Error' ignores them and we're left with a collection of
        'only unique values from column E
        On Error Resume Next
            colUnique.Add rCell.Value, CStr(rCell.Value)
        On Error GoTo 0
    Next rCell

    'loop through the collection and add them to the listbox
    For i = 1 To colUnique.Count
        ufReports.lbxReport.AddItem colUnique.Item(i)
    Next i

    'Show the form
    ufReports.Show

End Sub 
```

# xcode - 如何删除我不再关联的团队？

> ID：11565129
> 
> 赞同：11
> 
> 时间：2012-07-19T16:22:59.017
> 
> 标签：xcode, xcode-organizer

曾经与“Foo”相关联，不再是。“Foo”仍然显示在管理器中的团队下。我不希望它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-05-17T17:06:25.027

只有当您的计算机和在 Organizer 中链接的 iOS 设备上没有与该团队关联的证书、密钥或配置文件时，Xcode 才会从 Organizer 中删除该团队。

因此，您需要执行以下操作才能从您的计算机中删除密钥、登录密钥、证书和配置文件。

1.  打开“应用程序->钥匙串”
2.  从“钥匙串”部分（附加钥匙串图像左上角的框 1）中选择“登录”。
3.  从类别部分选择“我的证书”（框 2，就在钥匙串图像中的钥匙串框下方）。
4.  右键单击并从右窗格中删除与团队关联的所有证书。
5.  单击“我的证书”下的“密钥”并删除与该团队关联的所有密钥。单击“所有项目”，再次在“类别”部分中，并在搜索框中搜索团队以过滤并删除与该团队关联的所有项目。您只能使用团队的几个字符或缩写来查找和删除所有相关条目。
6.  单击钥匙串部分中的“系统”，然后按照步骤 5 中的说明搜索和删除与该团队关联的条目。

![钥匙链](../Images/ec725534165eeffcb69448fcd989ee80.png) ![钥匙扣细节](../Images/570a015019abf6570b90eeffc73a541b.png) ![退出 Xcode](../Images/184c4d662e692432ca5b9004fb293b8b.png)

这些步骤不是必需的，但强烈推荐。

1.  将 iOS 设备连接到您已在管理器中链接的计算机。
2.  转到“设置 -> 常规 -> 配置文件”并删除与您要摆脱的团队关联的配置文件。（如果未安装配置文件，则不会出现 Provisioning Profile 菜单。）
3.  对所有连接的设备执行步骤 1,2。
4.  右键单击 Dock 中的 Xcode 图标，然后选择退出。
5.  打开您的 Xcode Organizer，该团队应该从团队列表中消失。

现在，如果您仍然看到该团队在闲逛，这仅意味着您可能在钥匙串或 Xcode 管理器中仍保留与该团队关联的配置文件、密钥或证书，可能使用不同的名称或缩写，因此请执行上述步骤一次再次确保您已删除与该团队关联的所有密钥、登录密钥、证书、配置文件。相信我，这就是从 Xcode Organizer 中摆脱团队所需要做的一切。

注意：为确保公司不再出现，您需要确保执行以下两个选项之一：

1.  在 Apple Developer Portal 上请求该团队的团队代理将您从他们的团队中移除。
2.  使用您自己的 Apple ID登录 App Store Connect ( [https://appstoreconnect.apple.com )。](https://appstoreconnect.apple.com)如果您有多个团队，请确保您在要离开的团队中。从右上角的下拉菜单中选择个人详细信息。点击底部的“离开团队”。

否则，一旦您刷新 Xcode 配置文件，该团队就会回来。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-25T15:18:55.713

你必须联系前公司的人。我给 Apple 开发支持发了电子邮件，但他们无能为力。有点道理。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-21T22:07:05.803

我也被这个困扰，并找到了解决它的方法。您必须从与之前团队相关的所有证书和密钥中清理您的钥匙串。看到这个：[http ://carpeaqua.com/2012/10/12/how-to-remove-teams-from-xcode-s-organizer/](http://carpeaqua.com/2012/10/12/how-to-remove-teams-from-xcode-s-organizer/)

# android - 我在模拟器上找不到我的 Android 应用程序

> ID：11565131
> 
> 赞同：1
> 
> 时间：2012-07-19T16:23:07.640
> 
> 标签：android, android-emulator

```
[2012-07-19 23:02:35 - dailymoney] HOME 在设备 'emulator-5554' 上启动
[2012-07-19 23:02:35 - dailymoney] 将dailymoney.apk 上传到设备'emulator-5554'
[2012-07-19 23:02:36 - dailymoney] 安装dailymoney.apk...
[2012-07-19 23:03:33-dailymoney] 成功！
[2012-07-19 23:03:33 - dailymoney] \dailymoney\bin\dailymoney.apk 安装在设备上
[2012-07-19 23:03:33-dailymoney] 完成！
```

当我在模拟器中运行时，它可以正常打开，但我的应用程序在任何地方都没有明显列出。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2021-03-11T14:41:13.450

将鼠标保持在中心按钮并向上拖动鼠标以查看模拟器中的所有应用程序

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T16:39:03.943

您似乎缺少启动器意图过滤器。其中一项活动，需要标记为启动器活动。

[http://developer.android.com/guide/components/intents-filters.html#ccases](http://developer.android.com/guide/components/intents-filters.html#ccases)

查看您的 AndroidManifest.xml，并检查您是否有一个。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T17:13:40.510

您必须检查 AndroidManifest.xml 中的 android min sdk

添加例如

> 安卓：m​​inSdkVersion = 10

如果你有一个

> android:targetSdkVersion 比 android:minSdkVersion 大

你必须删除它

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T16:25:57.020

它应该在应用程序屏幕下方。按主屏幕中的中间按钮。

# php - CakeEmail - 手动发送 HTML 和纯文本消息

> ID：11565136
> 
> 赞同：2
> 
> 时间：2012-07-19T16:23:14.880
> 
> 标签：php, cakephp

我想使用内置函数从 CakePHP 发送纯文本和 html 电子邮件，但不触及 .ctp 文件。

这是我想从 CakeEmail 得到的：

```
//Send email to user
$email = new CakeEmail('default');
$email->to($customers['Customer']['email']);
$email->subject('Password reset');
$email->htmlMessage('<div>Reset the password</div>');
$email->textMessage('Password the reset');
$email->send(); 
```

但显然，这些功能不存在，所以有人知道替代解决方案吗？我不想触摸 CakePHP 的电子邮件文件夹，因为电子邮件布局和内容是动态生成的。

蛋糕版 2.0.6

基本上，我想要这个代码的 CakePHP 版本：[http](http://www.daniweb.com/web-development/php/threads/2959/sending-htmlplain-text-emails) ://www.daniweb.com/web-development/php/threads/2959/sending-htmlplain-text-emails 能够发送 HTML 和纯文本电子邮件

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T17:10:04.167

它实际上很简单。我这样做（使用html文本）：

```
$this->Email->emailFormat('both');

$text = trim(strip_tags($html));
$this->Email->viewVars(compact('text', 'html'));

if ($this->Email->send()) {...} 
```

你只需要在对应的视图ctps中回显变量

# c++ - 使用 C++ 的 Tesseract API 的包装类

> ID：11565138
> 
> 赞同：2
> 
> 时间：2012-07-19T16:23:18.620
> 
> 标签：c++, ocr, tesseract

我正在尝试使用 C++ 为 TesseractAPI 创建一个包装类。我从这里找到了一个例子 [https://groups.google.com/forum/?fromgroups#!topic/tesseract-ocr/7NIr71BQH8c](https://groups.google.com/forum/?fromgroups#!topic/tesseract-ocr/7NIr71BQH8c)

当我尝试使用以下命令编译程序时

```
 g++ -o test TessApi.cpp -l /usr/local/include/tesseract/ -l /usr/include/leptonica/ -L /usr/local/lib/ -l tesseract 
```

不走运，我收到以下错误

```
 TessApi.cpp:1:21: fatal error: baseapi.h: No such file or directory
    compilation terminated. 
```

任何人都可以帮我解决这个问题。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T16:28:34.747

看来您没有正确指定命令。`-l`指定要链接的库，而`-I`用于指定包含目录。尝试：

```
g++ -o test TessApi.cpp -I/usr/local/include/tesseract/ -I/usr/include/leptonica/ -L/usr/local/lib/ -ltesseract 
```

假设 Tesseract 实际安装在`/usr/local/`.

# node.js - Nodejs Github api gist create - 接收 Socket 挂断

> ID：11565139
> 
> 赞同：2
> 
> 时间：2012-07-19T16:23:25.647
> 
> 标签：node.js, github, github-api

我正在尝试通过 github api 创建 Gist - 使用 npm 模块“github”（https://github.com/ajaxorg/node-github/）

我有这个代码

```
 var gh = new GitHubApi({
    version: "3.0.0"
  });

  gh.authenticate({
    type: "oauth",
    token: data.token
  });

  gh.user.get({}, function (err, data) {
    console.log(err);
    console.log(data);

    var blob = {};
    blob.repo = commitData.repo;
    blob.user = commitData.user;
    blob.content = commitData.content;
    blob.encoding = commitData.encoding;
        gh.gitdata.createBlob(blob, function (err, blob) {
           console.log(err);
           console.log(blob);
           cb('failed');
       });
  }); 
```

问题是 createBlob 函数正在接收这个

```
{ 
  defaultMessage: 'Internal Server Error',
  message: 'socket hang up',
  code: '500' 
} 
```

我在 heroku 免费实例上运行我的应用程序（它基于 express）。

非常感谢，我解决了好几天，仍然无法正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T11:55:28.930

也许 api.github.com 有一些中断？

奇怪的是，7 月 19 日的[status.github.com](http://status.github.com) [**报告**](https://status.github.com/messages/2012-06-19)显示当时一切正常。

# wcf - 从控制台应用程序通过 HTTPS/SSL 使用 WCF 服务

> ID：11565141
> 
> 赞同：0
> 
> 时间：2012-07-19T16:23:31.927
> 
> 标签：wcf, ssl

我有一个在 IIS 下运行的 WCF 服务，配置为使用 SSL，并且已安装并运行有效证书。访问网站

```
https://my_website/anypage.aspx 
```

我可以访问该页面。访问网址

```
https://my_website/mywcfservice.svc 
```

我可以看到 web 服务页面：“你已经创建了一个服务。要测试这个服务，你需要创建一个客户端并使用它来调用服务（...）”。请注意，无论如何我都会收到警告页面，上面写着“此网站的安全证书存在问题”，我单击“继续访问此网站”。

在服务器端，web.config 配置为：

```
<security mode="Transport">
  <transport clientCredentialType="None" />
</security> 
```

……

在客户端，我没有使用代理或配置文件。我仅使用代码进行连接，例如：

```
this.Channel = new ChannelFactory<T>(binding, new EndpointAddress(serviceUri));
((WSHttpBinding)this.Channel.Endpoint.Binding).Security.Mode = SecurityMode.Transport;
((WSHttpBinding)this.Channel.Endpoint.Binding).Security.Transport.ClientCredentialType = HttpClientCredentialType.None;
this.Channel.CreateChannel(); 
```

我有严格的规则通过代码从客户端连接，所以我不能使用其他方式。通道打开得很好，但是当我调用任何方法时，我收到错误“根据验证程序，远程证书无效。”

没有 https 工作正常。

在客户端，我在“受信任的根证书颁发机构\证书”中有许多证书。它们都在服务器端受到信任。

问题可能出在哪里，在客户端或服务器端？也许我需要指定一个非常精确的证书在客户端使用？？

任何帮助感谢，谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T19:48:01.350

> 请注意，无论如何我都会收到警告页面，上面写着“此网站的安全证书存在问题”，我单击“继续访问此网站”。

您的客户端计算机不信任您在服务器上使用的 SSL 证书。您收到的 WCF 错误等同于您尝试在浏览器中点击服务时收到的消息。

> 在客户端，我在“受信任的根证书颁发机构\证书”中有许多证书。它们都在服务器端受到信任。

您需要配置您的客户端计算机以正确信任您的 SSL 证书。一旦您可以在浏览器中无错误地访问该服务，您的客户端代码应该可以工作。

# c++ - c++-cli DLL 加载时依赖项

> ID：11565142
> 
> 赞同：1
> 
> 时间：2012-07-19T16:23:32.743
> 
> 标签：c++, visual-studio-2010, c++-cli

在发布模式下使用 /clr /md 选项在 Visual Studio 2010 中构建 c++-cli 时，当我在构建发布程序集上运行 Dependency Walker 时，生成的程序集依赖于这些。

c:\windows\system32\MSVCR100.DLL c:\windows\system32\MSVCP100.DLL c:\windows\system32\MSVCP100D.DLL c:\windows\system32\MSVCR100D.DLL

为什么 MSVCP100D.DLL & MSVCR100D.DLL 在那里？我认为它们应该只用于调试构建模式。如何删除对调试 dll MSVCP100D.DLL 和 MSVCR100D.DLL 的依赖？

# ruby-on-rails - 在 Rails 中使用 Sunspot 和 Solr 拒绝连接

> ID：11565149
> 
> 赞同：2
> 
> 时间：2012-07-19T16:23:53.583
> 
> 标签：ruby-on-rails, ruby, solr, sunspot

我遇到了一个问题，当我尝试使用 sunspot_rails 执行搜索时出现 ECONNREFUSED 错误。宝石（sunspot_rails 和 sunspot_solr）似乎都已正确安装。我正在运行版本`1.3.3`，并且服务器运行正常。

我找到了另一篇关于此的帖子，但该帖子仅建议启动 sunspot solr 服务器。我确实这样做了，但错误仍然存​​在。

我相信问题是由于服务器所在的端口造成的。当我查看 的输出时`RAILS_ENV=development rake sunspot:solr:run`，它显示服务器正在端口上运行`8983`。我也尝试过`RAILS_ENV=production rake sunspot:solr:run`具有相同效果的命令。

如果我检查`sunspot.yml`配置文件，它会显示以下内容：

```
production:
  solr:
    hostname: localhost
    port: 8983
    log_level: WARNING

development:
  solr:
    hostname: localhost
    port: 8982
    log_level: INFO

test:
  solr:
    hostname: localhost
    port: 8981
    log_level: WARNING 
```

请注意，它*应该*在 port 上`8982`进行开发，但无论我做什么，它似乎都会继续在 port 上重新启动服务器`8983`。知道这是怎么发生的吗？

谢谢！

**更新：**我找到了一个潜在的原因。在我的项目文件夹中，该文件`/solr/conf/scripts.conf`包含以下内容：`solr_port=8983`. 无论什么 Rails 环境处于活动状态，这似乎都意味着硬编码端口。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T17:16:11.820

原来这是太阳黑子中的一个错误。这是我提交的问题的链接以获取完整描述：

[https://github.com/sunspot/sunspot/issues/262](https://github.com/sunspot/sunspot/issues/262)

我的解决方法是编辑 .yml 文件并将所有端口（测试、开发和生产）更改为 8983。

# regex - 基于文件夹的正则表达式url重写

> ID：11565150
> 
> 赞同：0
> 
> 时间：2012-07-19T16:23:54.583
> 
> 标签：regex

我需要能够获取 /calendar/MyCalendar.ics ，其中 MyCalendar.ics 可以是任何具有 ICS 扩展的内容，并将其重写为 /feeds/ics/ics_classic.asp?MyCalendar.ics

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T17:37:41.900

```
C:\x>perl foo.pl
Before: a=/calendar/MyCalendar.ics
After: a=/feeds/ics/ics_classic.asp?MyCalendar.ics

...or how about this way?
(regex kind of seems like overkill for this problem)
b=/calendar/MyCalendar.ics
index=9
c=MyCalendar.ics (might want to add check for ending with '.ics')
d=/feeds/ics/ics_classic.asp?MyCalendar.ics 
```

这是代码：

```
C:\x>type foo.pl
my $a = "/calendar/MyCalendar.ics";
print "Before: a=$a\n";
my $match = (
   $a =~ s|^.*/([^/]+)\.ics$|/feeds/ics/ics_classic.asp?$1.ics|i
);
if( ! $match ) {
   die "Expected path/filename.ics instead of \"$a\"";
}
print "After: a=$a\n";
print "\n";
print "...or how about this way?\n";
print "(regex kind of seems like overkill for this problem)\n";
my $b = "/calendar/MyCalendar.ics";
my $index = rindex( $b, "/" ); #find last path delim.
my $c = substr( $b, $index+1 );
print "b=$b\n";
print "index=$index\n";
print "c=$c (might want to add check for ending with '.ics')\n";
my $d = "/feeds/ics/ics_classic.asp?" . $c;
print "d=$d\n";
C:\x> 
```

一般想法：

如果您确实使用正则表达式解决了这个问题，那么需要确保您的捕获组（括号）排除路径分隔符。需要考虑的一些事项：

您的路径分隔符总是正斜杠吗？

正则表达式似乎对此有点过分了；我能想到的最简单的方法是获取最后一个路径分隔符的索引并进行简单的字符串操作（示例程序的第二部分）。

库通常具有解析路径的例程。例如，在 Java 中，我会查看 java.io.File 对象，特别是 getName() 返回此抽象路径名表示的文件或目录的名称。这只是路径名的名称序列中的最后一个名称

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T17:38:32.253

正则表达式用于搜索/匹配文本。通常你会使用正则表达式来定义你搜索的一些文本操作工具，然后使用工具特定的方式来告诉工具用什么来替换文本。

正则表达式语法使用圆括号来定义整个搜索模式中的捕获组。许多搜索和替换工具使用捕获组来定义要替换的匹配部分。
我们可以以 Java Pattern 和 Matcher 类为例。要使用 Java Matcher 完成任务，您可以使用以下代码：

```
Pattern p = Pattern.compile("/calendar/(.*\.(?i)ics)");

Matcher m = p.matcher(url);

String rewritenUrl = "";
if(m.matches()){
    rewritenUrl = "/feeds/ics/ics_classic.asp?" + url.substring( m.start(1), m.end(1)); 
} 
```

这将找到请求的模式，但只会使用第一个正则表达式组来创建新字符串。

这是（恕我直言）一个非常好的正则表达式信息站点中的正则表达式替换信息的链接：[http ://www.regular-expressions.info/refreplace.html](http://www.regular-expressions.info/refreplace.html)

# php - 在行之间插入值

> ID：11565154
> 
> 赞同：4
> 
> 时间：2012-07-19T16:24:05.217
> 
> 标签：php, mysql, sql, database, insert

我不知道是否可以仅使用 sql 查询来完成，或者在**缺少cid 时需要 php 代码**

**存在许多我无法手动处理的缺失值**

例如，这里我没有`cid=1`and `cid=6`。我想插入一行：

```
cid=1 tcp_sport='undefined' tcp_dport='undefined' 
```

和

```
cid=6 tcp_sport='undefined' tcp_dport='undefined' 
```

在我看来我应该创建一个程序并在行之间插入

我认为的另一种解决方案是，我将创建一个具有 cid 和 undifined 值以及相应顺序的表，然后将这个与那个连接起来，这个连接应该有例如 ifnull(tcp_sport,'')

你能帮帮我吗？

![在此处输入图像描述](../Images/170d87aa44657ba4c3014d2c2d6bdae8.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T16:26:04.397

首先，使用 MAX 来获得最大的 ID。

`SELECT MAX(cid) as max FROM table`

然后，创建一个 for 循环来检查各个 ID 是否存在：

```
for ($i = 0; $i < $max; $i++) {
    // $query = ... SELECT 1 FROM table WHERE cid = $i ...
    // check if the number of rows for $query is greater than 0
    // if not, INSERT INTO table VALUES ($i, DEFAULT, DEFAULT)
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-19T16:31:40.253

自动增量 ID 的整个想法是拥有一个只引用一件事的值。通过“插入字里行间”，您可能会面临许多无法预料的问题。图像您有另一个表，其中一些值链接到该表的 CID。如果该表已经有一个 CID=1 的条目，当您插入一个 CID=1 的新项目时，它将加入该支持记录。因此，真正属于 CID=1 的原始项目的数据将显示为可能与之无关的新项目。

您不会用完 ID 值（如果您接近整数的限制，请将其切换为 bigInt），如果可以避免，请不要重复使用 ID。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-19T16:27:29.393

您需要使用 PHP 来自动执行此操作。

```
<?php

$link = mysql_connect("localhost", "mysql_user", "mysql_password");
mysql_select_db("database", $link);

while($i < max_value_cid)//replace max_value_cid by the numeric maximum value of cid (SELECT MAX(cid) as max FROM table)
{
   $result = mysql_query("SELECT * FROM `table` WHERE cid=".$i, $link);
   if(mysql_num_rows($result) == 0)
   mysql_query("INSERT INTO `table` VALUES ($i, NULL, NULL);", $link);
   $i++;
}
?> 
```

在执行之前在样本集上测试查询，并记住备份整个表，以防万一。

# javascript - 使用javascript将画布保存为特定文件夹中的PNG图像

> ID：11565156
> 
> 赞同：1
> 
> 时间：2012-07-19T16:24:10.040
> 
> 标签：javascript, canvas, png, base64

我有一些用画布制作的图形，我想将它们作为 .png 图像保存在用户计算机的特定文件夹中。

我在客户端这样做：

```
$(".new_canvas").each( function(index) {

                var dataurl = $(".new_canvas")[index].toDataURL("image/png");

                $.ajax({
                        type: "POST",
                        url: "export_images",
                        data: dataurl,
                        }
                });
            }); 
```

在服务器端，我收到了 base64 编码的字符串，但是如何将此图像保存在特定目录中？

我已经看到了一些关于此的问题并尝试了一些事情但没有成功......

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T02:55:08.363

> 保存在用户计算机的特定文件夹中

哦亲爱的。你*绝对*不能这样做。您可以做的最好的事情是从服务器上下载一个图像，该图像将进入下载目录，或者您可以提供一个链接。您无法指定文件在用户计算机上的保存位置。

# c# - 生成基于填充对象的代码

> ID：11565163
> 
> 赞同：6
> 
> 时间：2012-07-19T16:24:31.460
> 
> 标签：c#, .net, reflection

假设我有以下课程。

```
public class MyClass {
   public string Data1 { get; set; }
   public MyOtherClass Data2 { get; set; }
   // 50+ other properties...
}

public class MyOtherClass {
   public string OtherData1 { get; set; }
   // More properties
} 
```

有一些代码可以实例化该类并用所有数据填充它。我想用那个对象来做我的测试。我可以简单地将结构序列化为 XML 并稍后重新加载。但是，我真正想要的是在代码中构建整个对象树。换句话说：

```
MyClass myClass = new MyClass {
    Data1 = "Hello",
    Data2 = new MyOtherClass {
        OtherData1 = "World",
        // More...
    },
    // More...
} 
```

我可以自己写所有这些，但这需要几个小时并且容易出错，因为有大量的属性和子类。这是我的问题：给定一个对象，您将如何生成填充该对象的代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T17:44:21.153

我会写一个[T4 模板](http://msdn.microsoft.com/en-us/library/bb126445.aspx)。查看一个正在做某事[的示例，虽然非常远程，但与您需要的类似。](http://odetocode.com/blogs/scott/archive/2009/10/27/using-t4-templates-for-simple-dtos.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T19:52:38.443

我会使用 json 作为数据格式，并使用[http://json2csharp.com 之](http://json2csharp.com)类的东西来生成用于序列化和反序列化 json 的类。或者给定已经存在的类对它们进行注释并将它们序列化。

这将处理任何任意嵌套并且是可维护的。甚至可以在不重新编译的情况下编辑值，这通常是一件好事。该链接还提供了有关如何指定特定类型、处理枚举、对象链接等的示例。

也许如果您指定为什么它绝对必须从代码生成，那么我们可以给出更好的答案。

# javascript - 如何在视网膜 iPad 上的 javascript 中防止 @2x 图像缩放？

> ID：11565164
> 
> 赞同：7
> 
> 时间：2012-07-19T16:24:42.903
> 
> 标签：javascript, ipad, mobile-safari, retina-display

我正在使用 html`<canvas>`和 javascript 开发网络游戏。游戏还必须在 iPad 上正常运行，最好是视网膜和非视网膜显示器。在这个游戏中，我使用了一个 spritesheet png。这个 spritesheet 宽 3500 像素，高 3700 像素。

在我的游戏逻辑中，我使用 canvas'`context.drawImage()`来抓取精灵并将它们绘制到我的画布中。在桌面浏览器中，这工作得非常好，一切都很好。在视网膜 iPad 上，图像仅以四分之一大小加载，这使我的许多`drawImage()`调用都失败了，以为他们试图抓取加载图像边界之外的像素。（如果我在位置 1200、1400 抓取一个精灵，并且 iPad 认为我的图像比这小，则会引发 INDEX_SIZE_ERR 错误。）

例如，下面写的代码就是我项目中的代码。当提醒宽度和高度时，我得到的结果是 875 像素宽 x 925 像素高 - 正好是原始图像大小的 1/4。

```
spritesheet = new Image();
spritesheet.onload = function() {
    splashInterval = setInterval(renderFrame, 30);
    alert(spritesheet.width); // returns 875 on retina iPad
    alert(spritesheet.height); // returns 925 on retina iPad
};
spritesheet.src = "/spritesheet.png"; 
```

对于视网膜显示器，通常的解决方案是创建一个尺寸增加的图像，因此当 iPad 缩小它时，一切都很好。但是，按照上面报告的尺寸，我必须创建一个宽度和高度为 4 倍的图像。这使得图像的宽度为 14,000 像素，高度为 14,800 像素。即使是纯白色 jpg，此图像也无法在 Photoshop 中保存，并且在 Gimp 中报告为 1.9GB 大。这自然不是解决办法。;)

因此我的问题是：有没有办法防止 iPad 视网膜显示器缩小通过 Javascript 加载的图像？当我加载我的 3500x3700 像素图像时，我需要它保持在 3500x3700 像素，所以我的`context.drawImage()`调用按预期工作。

任何和所有的想法将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:31:13.157

您可以使用以下方法确定显示器是否为视网膜：

```
var retina = window.devicePixelRatio > 1 ? true : false;

if (retina) {
    // the user has a retina display
    // do something

}
else {
    // the user has a non-retina display
    // do something else 
} 
```

# php - 检查数组值是否存在

> ID：11565165
> 
> 赞同：-2
> 
> 时间：2012-07-19T16:24:54.400
> 
> 标签：php

```
$city = $_GET['cityselect'];
add_query_arg( array ( 'city' => $city, 'key' => 'value' ); 
```

基本上我想检查 $city 是否存在，如果不存在，我想同时删除键和值，即`'city' => $city,`（包括逗号）。所以输出将是：

```
add_query_arg( array ( 'key' => 'value' ); 
```

任何的想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T16:27:42.353

仅在`city`已设置的情况下添加密钥，如下所示：

```
$arg = array( 'key' => 'value');

if( isset( $_GET['cityselect'])) 
    $arg['city'] = $_GET['cityselect'];

add_query_arg( $arg); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T16:27:50.363

试试这个

```
$data = array();
if(isset($_GET["cityselect"])){
 $data["city"] = $_GET["cityselect"];
}

add_query_arg($data); // .. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T16:29:21.440

如果您尝试删除`city`它不存在，您可以这样做：

```
$city = isset($_GET['cityselect']) ? $_GET['cityselect'] : null;
if (empty($city)) unset($yourArray['city']); 
```

这假设您已经有一个数组 ,`$yourArray`预定义了一个`city`索引。

我建议您仅`city`在验证后才插入索引，例如：

```
if (isset($_GET['cityselect']) && !empty($_GET['cityselect'])) {
    $yourArray['city'] = $_GET['cityselect'];
} 
```

**更新：**完成填充后，您还可以使用[`array_filter()`](http://us.php.net/manual/en/function.array-filter.php)删除所有缺失值的索引：

```
$yourArray = array_filter($yourArray); 
```

这将返回一个删除了所有空值的数组；在您的情况下，如果`city`为空，它将从数组中删除。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T16:36:45.497

对于简短但丑陋的单行版本：

`add_query_arg($args = (!empty($_GET['cityselect'])) ? array('city' => $_GET['cityselect'], 'key' => 'value') : array('key' => 'value');`

稍微优雅一点：

```
if(!empty($_GET['cityselect']))
    add_query_arg(array('city' => $_GET['cityselect'], 'key' => 'value'));
else
    add_query_arg(array('key' => 'value')); 
```

已假定使用，但如果适用于您的情况，请`empty`替换。`isset`

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-07-19T16:27:56.527

您可以使用[array_search()](http://se.php.net/manual/en/function.array-search.php)（在数组中搜索给定值，如果成功则返回相应的键）。

# ruby-on-rails - （欧洲/国际）ruby on rails 支付网关 2012 的选项？

> ID：11565175
> 
> 赞同：0
> 
> 时间：2012-07-19T16:25:20.893
> 
> 标签：ruby-on-rails, payment-gateway, activemerchant

作为 ruby​​ on rails 编码器，我有哪些选项可以轻松地将支付商家集成到我的应用程序中。一个不错的 API 或 gem 集成，因此它只是“即插即用”，没有太多麻烦和以下选项。我猜这适合大多数小型创业网站。那么你使用什么或什么是可取的？

我知道活跃的商家，但与来自不同银行的各种支付解决方案集成起来很麻烦。我现在需要*欧洲*的最佳选择，如果它支持美国会很好，但如果这会增加额外成本，那么欧罗巴应该会受到青睐。

**标准：**

*   国际支付处理优先
*   通过信用卡、银行账户、短信、电话号码支付
*   定期计费，如果用户同意，可以选择每月自动延长计费

**国家的**

*   欧洲（明年的主要目标）
*   美国/等（如果网关也实现了美国支付选项，那就太好了）

**定价计划：**

*   只为每笔交易付费
*   支付低费用（每月不超过 5 美元）并且每笔交易支付较低的费用

我找了一个比较，一个包含所有这些服务的 Excel 表会很好，但是需要很多时间来制作和更新，所以我想让我们在这里向其他编码人员寻求一些更新建议！谢谢

到目前为止我发现的一些：

*   [https://stripe.com](https://stripe.com)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T20:43:25.340

就国际供应商而言，您确实有一些不错的选择。Braintree 目前在欧洲处于 Beta 阶段，很快就会向所有人全面推出。如果您想尽快试用，可以在此处申请参与测试流程：[https](https://www.braintreepayments.com/tour/international) ://www.braintreepayments.com/tour/international您将能够处理来自任何地方的 100 多种货币世界。

# php - Yii：同一行上的 Cactiveform 字段

> ID：11565178
> 
> 赞同：2
> 
> 时间：2012-07-19T16:25:38.937
> 
> 标签：php, yii

我正在尝试做一些我觉得很愚蠢的事情，而且我敢肯定这很简单。但是，我很难在网上找到任何明确的例子。我试过修改 div 和 css，但无济于事。

谁能给我一个清晰的例子，说明如何在 Cactive 表单的同一行上拥有 2 个或多个表单字段，以创建新模型，而不是每行上的默认字段。

任何帮助将不胜感激！！

我尝试过 form = 'wide form'

但我得到了奇怪的格式，就像这里的例子一样：http: [//imgur.com/E5VVs](http://imgur.com/E5VVs)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:42:09.917

假设这是你的表格（取自 Yii 文档）

```
<?php $form = $this->beginWidget('CActiveForm', array(
    'id'=>'user-form',
    'enableAjaxValidation'=>true,
    'enableClientValidation'=>true,
    'focus'=>array($model,'firstName'),
)); ?>

<?php echo $form->errorSummary($model); ?>

<div class="row">
    <?php echo $form->labelEx($model,'firstName'); ?>
    <?php echo $form->textField($model,'firstName'); ?>
    <?php echo $form->error($model,'firstName'); ?>
</div>
<div class="row">
    <?php echo $form->labelEx($model,'lastName'); ?>
    <?php echo $form->textField($model,'lastName'); ?>
    <?php echo $form->error($model,'lastName'); ?>
</div>

<?php $this->endWidget(); ?> 
```

您可以使用根据页面宽度构建的默认蓝图将其拆分为 2 列，例如

```
<?php $form = $this->beginWidget('CActiveForm', array(
    'id'=>'user-form',
    'enableAjaxValidation'=>true,
    'enableClientValidation'=>true,
    'focus'=>array($model,'firstName'),
)); ?>

<?php echo $form->errorSummary($model); ?>

<div class="row">
    <div class="span-8">
        <?php echo $form->labelEx($model,'firstName'); ?>
        <?php echo $form->textField($model,'firstName'); ?>
        <?php echo $form->error($model,'firstName'); ?>
    </div>

    <div class="span-8 last">
        <?php echo $form->labelEx($model,'lastName'); ?>
        <?php echo $form->textField($model,'lastName'); ?>
        <?php echo $form->error($model,'lastName'); ?>
    </div>
</div>

<?php $this->endWidget(); ?> 
```

您可以在网络上的大量地方熟悉蓝图 css 或一般 css 规则。抱歉，如果没有看到您的代码，我无法提供更多帮助。如果已经有一个内置的神奇解决方案，也许其他人知道？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T00:16:47.857

对于以下示例：

```
<div class="row">
    <?php echo $form->labelEx($model,'firstName'); ?>
    <?php echo $form->textField($model,'firstName'); ?>
    <?php echo $form->error($model,'firstName'); ?>
</div>
<div class="row">
    <?php echo $form->labelEx($model,'lastName'); ?>
    <?php echo $form->textField($model,'lastName'); ?>
    <?php echo $form->error($model,'lastName'); ?>
</div> 
```

您需要做的就是设置更改一点 css

```
.row {
    width:200px;  /* or whatever you prefer */
    float:left;
} 
```

请记住，`clear:left`在完成浮动元素或其他元素之后可能会奇怪地包裹。

您还可以使用：

```
.row {
    width:200px;  /* or whatever you prefer */
    display:inline-block;
} 
```

这会有所不同，但对您来说可能是更好的选择。浮动时，您的行将保留在 dom 结构中，但可能会产生意想不到的结果。尝试两者，看看你想出了什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-15T00:04:17.613

只需将 CSS 类更改为“列”而不是 div 之前的“行”，然后再放在同一行上。

*示例：* 要更改以下四行 div ...

```
 <div class="row"> ... </div>
   <div class="row"> ... </div>
   <div class="row"> ... </div>
   <div class="row"> ... </div> 
```

分成三个并排放置的 div，最后一个 div 在新行上，只需执行以下操作：

```
 <div class="column"> ... </div>
   <div class="column"> ... </div>
   <div class="row"> ... </div>
   <div class="row"> ... </div> 
```

还是我完全误解了这个问题......

# .net - 如何延迟事件处理程序先运行一小段代码？

> ID：11565182
> 
> 赞同：2
> 
> 时间：2012-07-19T16:25:48.313
> 
> 标签：.net, vb.net, winforms, event-handling

我很好奇是否有一种方法可以拦截足够长的控制事件处理程序以运行一小段代码，然后继续处理该处理程序。

例如，假设我的表单上有一个 TreeView，当我单击展开一个节点时，我想在它实际展开之前为该节点运行一些代码，可能是某种子节点的按需加载或类似的东西.

现在我可以在树视图 NodeMouseClick 事件中单击它时运行代码，但我希望节点在该代码完成之前不会展开。

想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T16:31:50.533

[TreeView.BeforeExpand](http://msdn.microsoft.com/en-us/library/system.windows.forms.treeview.beforeexpand.aspx "TreeView.BeforeExpand")让您这样做。

此外，事件处理程序是阻塞的——只有一个事件处理程序会同时运行，它们也会阻塞 GUI（如果您没有明确地采取任何措施来阻止它）。

# android - setOnClickListener 强制关闭

> ID：11565186
> 
> 赞同：0
> 
> 时间：2012-07-19T16:25:59.437
> 
> 标签：android, layout, button, forceclose

当我启动应用程序并单击按钮转到活动时，我突然得到一个强制关闭。我试图把它全部抹掉，然后再写一遍，但它仍然存在。可能是什么问题呢？

```
package com.alexgascon.formuladora; 

import android.app.Activity;
import android.view.View.OnClickListener;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;

public class Matematicas extends Activity {

public void onCreate(Bundle savedInstanceState){
    super.onCreate(savedInstanceState);

    final Button BtnEcSegundoGrado = (Button)findViewById(R.id.ecsegundogrado);
    final Button BtnFracciones = (Button)findViewById(R.id.fracciones);
    final Button BtnMCD = (Button)findViewById(R.id.maximocomunBoton);

    BtnMCD.setOnClickListener(new OnClickListener(){

        @Override
        public void onClick(View arg0) {
            Intent MCDintent = new Intent(Matematicas.this,Maximocomun.class);
            startActivity(MCDintent);

        }

    });

}
} 
```

这是布局代码

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
 android:layout_width="match_parent"
 android:layout_height="match_parent"
 android:background="@drawable/pizarramatesverde"
 android:gravity="center" >

<Button
    android:id="@+id/ecsegundogrado"
    android:layout_height="wrap_content"
    android:layout_width="265sp"
    android:text="@string/ecsegundo"
    android:textColor="@color/Negro"
    />
<Button
    android:id="@+id/fracciones"
    android:layout_height="wrap_content"
    android:layout_width="265sp"
    android:text="@string/fracciones"
    android:layout_below="@id/ecsegundogrado"
    android:textColor="@color/Negro"
    />

<Button
    android:id="@+id/maximocomunBoton"
    android:layout_height="wrap_content"
    android:layout_width="265sp"
    android:text="@string/maximocomun"
    android:layout_below="@id/fracciones"
    android:layout_marginBottom="80sp"
    android:textColor="@color/Negro"
    />

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T16:27:23.437

您需要先`setContentView`致电`findViewById`：

```
setContentView(R.layout.yourlayoutxmlname);
final Button BtnEcSegundoGrado = (Button)findViewById(R.id.ecsegundogrado);
final Button BtnFracciones = (Button)findViewById(R.id.fracciones);
final Button BtnMCD = (Button)findViewById(R.id.maximocomunBoton); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T16:28:02.157

您需要调用`setContentView(R.layout.yourxmlLayout);`以在您的活动类上引用布局。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T16:29:05.507

尝试从点击监听器中弹出一个 toast，看看它是否有效。如果是这样 - 那么问题出在您要启动的活动中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T16:56:09.893

您需要添加`setContentView(R.layout.yourlayoutxmlname);`.

试试下面的代码：

```
package com.alexgascon.formuladora; 

import android.app.Activity;
import android.view.View.OnClickListener;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;

public class Matematicas extends Activity {
    public void onCreate(Bundle savedInstanceState){
        super.onCreate(savedInstanceState);
        setContentView(R.layout.yourlayoutxmlname);

        final Button BtnEcSegundoGrado = (Button)findViewById(R.id.ecsegundogrado);
        final Button BtnFracciones = (Button)findViewById(R.id.fracciones);
        final Button BtnMCD = (Button)findViewById(R.id.maximocomunBoton);

        BtnMCD.setOnClickListener( new OnClickListener(){
            @Override
            public void onClick(View arg0) {
                Intent MCDintent = new Intent(Matematicas.this,Maximocomun.class);
                startActivity(MCDintent);
            }
        });
    }
} 
```

# kohana - Kohana 访问客户端 ip

> ID：11565190
> 
> 赞同：5
> 
> 时间：2012-07-19T16:26:06.817
> 
> 标签：kohana, kohana-3, kohana-3.2

我正在使用`kohana 3.2`，我想从请求类中访问客户端 ip，在[文档](http://kohanaframework.org/3.2/guide/api/Request#property%3aclient_ip)中我可以看到`public static string $client_ip`哪个应该包含客户端 ip，现在如果我尝试访问它，我喜欢这样：

```
Request::$client_ip; 
```

我明白了：`string(3) "::1"`这根本没有意义，我做错了什么，或者可能无法访问它？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-19T18:30:01.907

您在本地访问您的脚本，您的 IPv6 地址是`::1`

# heroku - 如何防止 CopyCopter（Heroku 上的客户端和服务器）文本恢复为默认值？

> ID：11565193
> 
> 赞同：3
> 
> 时间：2012-07-19T16:26:13.367
> 
> 标签：heroku, content-management-system, copycopter

有时文本会恢复为默认值。特别是在早上。

我的猜测是，由于两者都在 Heroku 上运行，因此一个或两个应用程序在低流量的日子里都处于休眠状态。

如果我猜对了，似乎有一种最佳实践（和免费）方法可以防止应用程序在 Heroku 上休眠？也许是频繁的 ping（你用什么？），设置一些变量或一种方法来告诉应用程序在早上的某个时间唤醒并可用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T02:11:42.207

您可以尝试使用像[http://www.pingdom.com/](http://www.pingdom.com/)这样的服务来经常 ping 您的应用程序并防止测功机进入睡眠状态（我认为一个应用程序每分钟最多一次是免费的）。

第二个选项是将超时设置为更高的值。

```
#config/initializers/copycopter.rb

CopycopterClient.configure do |config|
  config.api_key = key_xxx
  config.host = site_xxx
  config.http_read_timeout = 120
  config.http_open_timeout = 120
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T19:26:44.627

如果您想阻止 Heroku 应用程序进入睡眠状态，最简单的方法是添加第二个测功机。

# ruby-on-rails - 允许子域指向机器的 Apache2 配置：端口

> ID：11565194
> 
> 赞同：1
> 
> 时间：2012-07-19T16:26:14.560
> 
> 标签：ruby-on-rails, apache2, config, virtualhost

我拥有域名“peterlee.com.cn”，并在我的域名控制面板中添加了一条 A 记录：

```
RR                  Destination IP   TTL
rs.peterlee.com.cn  10.50.10.75      1 hour 
```

我有一个正在运行的 RoR (Ruby on Rails) 项目`10.50.10.75:9051`，这意味着用户可以通过以下方式访问我的 RoR 应用程序`http://10.50.10.75:9051`

我想让用户通过[http://rs.peterlee.com.cn](http://rs.peterlee.com.cn)访问它，所以我添加了以下 VirtualHost File/Site：

```
<VirtualHost *:80>
    ServerName rs.peterlee.com.cn
    DocumentRoot /usr/website/myapp/current/public
    PassengerEnabled off
    ProxyPass / http://127.0.0.1:9051/
    ProxyPassReverse / http://127.0.0.1:9051/
    RackEnv production
    RailsEnv production

    <IfModule mod_rewrite.c>
        RewriteEngine On

        # Redirect all requests to the maintenance page if present
        RewriteCond %{REQUEST_URI} !\.(css|gif|jpg|png)$
        RewriteCond %{DOCUMENT_ROOT}/system/maintenance.html -f
        RewriteCond %{SCRIPT_FILENAME} !maintenance.html
        RewriteRule ^.*$ /system/maintenance.html [L]
    </IfModule>

</VirtualHost> 
```

启用站点并重新启动 Apache2 后，我尝试了[http://rs.peterlee.com.cn](http://rs.peterlee.com.cn)，它给了我 500 Internal Server Error：

```
Internal Server Error

The server encountered an internal error or misconfiguration and was unable to complete your request.

Please contact the server administrator, [no address given] and inform them of the time the error occurred, and anything you might have done that may have caused the error.

More information about this error may be available in the server error log.

Apache/2.2.22 (Ubuntu) Server at rs.peterlee.com.cn Port 80 
```

谢谢。

彼得

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:34:32.180

我发现以下警告`/var/log/apache2/error.log`：

```
[Thu Jul 19 10:22:20 2012] [warn] proxy: No protocol handler was valid for the URL /. If you are using a DSO version of mod_proxy, make sure the proxy submodules are included in the configuration using LoadModule.
[Thu Jul 19 10:22:20 2012] [warn] proxy: No protocol handler was valid for the URL /favicon.ico. If you are using a DSO version of mod_proxy, make sure the proxy submodules are included in the configuration using LoadModule. 
```

所以我启用了以下模块：

```
sudo a2enmod proxy proxy_balancer proxy_http 
```

重新启动 Apache2 后，它工作了！

不管怎么说，还是要谢谢你。

顺便说一句：我使用乘客启动服务：

```
passenger start -a 127.0.0.1 -p 9051 -e production -d 
```

# java - 如何强制方法在 jUnit 测试中抛出异常？

> ID：11565196
> 
> 赞同：4
> 
> 时间：2012-07-19T16:26:17.807
> 
> 标签：java, jakarta-ee, testing, junit

实际上这是为了代码覆盖，我很难覆盖到`catch`语句。有任何想法吗？

例如：

我希望我的`selectSomethingBySomething()`方法（从 db 中选择）`SQLException`在不实际接触实际源代码的情况下在测试方法上抛出一个非常困难的方法。还给出了我只能控制的是`WHERE`子句的参数的约束。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-19T16:32:53.577

您需要首先模拟包含的类`selectSomethingBySomething()`，然后记录此行为。在[模拟](/questions/tagged/mockito "显示标记为“mockito”的问题")中，您会说：

```
SomeDao someDaoMock = mock(SomeDao.class);

willThrow(new SQLException())).given(someDaoMock).selectSomethingBySomething(); 
```

然后注入`someDaoMock`您的测试类，当它调用时，`someDaoMock.selectSomethingBySomething()`它会抛出先前选择的异常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-20T10:28:33.157

使用 EasyMock，您可以模拟一个类和该特定类的方法调用。

例如：

如果 DoSomethingDAO 是 ClassName，

像 DoSomethingDAO 这样模拟类 mockDAO

```
EasyMock.createMock(DoSomethingDAO.class); 
```

现在你必须模拟从这个 mockDAO 发出的所有调用。

如果方法返回一个值，我们需要像下面那样模拟调用。

```
EasyMock.expect(mockDAO.selectSomethingBySomething()).andReturn(EasyMock.anyObject()); 
```

如果方法抛出异常下面是方法调用

```
EasyMock.expect(mockDAO.selectSomethingBySomething()).andThrow(new (typeofExecption)); 
```

对于 void 方法

```
mockDAO.selectSomethingBySomething();
EasyMock.expectLastCall().atleastOnce(); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-19T16:36:19.013

有很多方法可以做到这一点，但我的建议是不要以 100% 的代码覆盖率为目标。这根本不值得。你为了微不足道的好处让自己的生活变得困难。

但是，如果您真的想对其进行测试，最好的方法可能是更改您的代码以使其更具可测试性。让你的数据访问类实现一个接口，然后使用一个模拟框架（例如 JMock）来模拟它并抛出一个 SQLException。（你可以模拟具体的类，但这是不受欢迎的。）

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2018-09-11T11:12:31.527

你实际上不需要额外的框架来完成这个技巧。方法如下：

```
 Exception hasToBeThrown = null;
    try {
                 methodThatShouldThrow();
    } catch (Exception e) {
        assertTrue(e.getMessage().startsWith("if you want to...")); // JUnit will miss this, if not thrown, so we need more
        hasToBeThrown = e;
    }
    assertNotNull(hasToBeThrown); // but this will do 
```

# azure - 如何监视 Azure 基于角色的缓存使用了多少缓存内存

> ID：11565199
> 
> 赞同：2
> 
> 时间：2012-07-19T16:26:27.570
> 
> 标签：azure

有没有办法查看 Azure 缓存（预览版）使用了多少内存？我不太清楚使用什么序列化方法（二进制、xml、json？）所以很难提供我的缓存对象需要多少内存。任何见解都非常受欢迎。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T17:36:11.090

有人告诉我，但没有尝试过……性能计数器“AppFabric Caching:Host\Available Memory Percentage”可以为您提供可用的缓存量。从理论上讲，如果您要在角色实例之间分配它，您需要汇总数量以获得可用缓存大小的总数。

但实际上，您只想这样做以查看您是否经常遇到缓存限制并想知道您是否想要增加容量。缓存服务应在利用率增长时处理驱逐。

而且我相信缓存序列化是二进制的，但不要强迫我这样做。:)

# jquery - 无法使用 if 语句保持 css 更改状态

> ID：11565200
> 
> 赞同：0
> 
> 时间：2012-07-19T16:26:34.187
> 
> 标签：jquery

---更新的小提琴仍然无法正常工作 www.jsfiddle.net/atZPn/5 试图让输入框中的文本只有在输入数据时才保持黑暗。

[http://jsfiddle.net/atZPn/5/](http://jsfiddle.net/atZPn/5/)

代码：

```
 $(".searchbox").blur(function() {
    var searchbox = this,
        searchbox_val = $.trim( this.value );
    if (searchbox_val.length > 0) {
        return true;
    } else {
        $(searchbox).addClass("blur");
        return false;
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:30:09.470

`getElementByClassName`应该`getElementsByClassName`和`searchbox_val`应该`searchbox_val[0]`。

```
/* Search Box Leave */
$(".searchbox").blur(function() {
    var searchbox_val = document.getElementsByClassName("searchbox");
    if (searchbox_val[0].value.length > 0) {
        return true;
    }
    else {
        $(this).addClass("blur");
        return false;
    }
}); 
```

Yon也可以尝试如下：

```
$(".searchbox").blur(function() {
    var searchbox = $(this),
        searchbox_val = $.trim( searchbox.val() );
    if (searchbox_val.length > 0) {
        return true;
    } else {
        searchbox.addClass("blur");
        return false;
    }
}); 
```

### [更新]

***HTML***

```
<input class="searchbox" type="text" placeholder="Just some text" /> 
```

***jQuery***

```
$(".searchbox").blur(function() {
    var searchbox = this,
        searchbox_val = $.trim( this.value );
    if (searchbox_val.length > 0) {
        $(searchbox).addClass("blur");
        return true;
    } else {
        $(searchbox).removeClass("blur");
        return false;
    }
}); 
```

***[演示](http://jsfiddle.net/atZPn/8/)***

# ruby-on-rails-3 - rails 嵌套属性 has_many 到

> ID：11565204
> 
> 赞同：0
> 
> 时间：2012-07-19T16:26:44.453
> 
> 标签：ruby-on-rails-3, nested-attributes, simple-form

我有三个模型。父、子、类型和关系。关系是引用父、子和类型的富连接模型。

问题是，虽然创建了一个孩子并创建了关系表，但没有填充关系表中的 parent_id。只有子项和类型是自动填充的。

父.rb

```
attr_acccessible :relationships_attributes

has_many :relationships
has_many :children, :through => :relationships
has_many :types, :through => :relationships 
```

子.rb

```
attr_acccessible :relationships_attributes

has_many :relationships
has_many :parents, :through => :relationships
has_many :types, :through => :relationships

accepts_nested_attributes_for :relationships 
```

关系.rb

```
attr_accessible :parent_id, :child_id, :type_id
belongs_to :parent
belongs_to :child
belongs_to :type 
```

children.controller

```
def new
 @child = Child.new
 @child.relationships.build
end

def create
 @child = Child.new(params[:child])
 if @child.save
  redirect_to current_user
 else
  render "new"
 end
end 
```

新的.html.erb

```
<%= simple_form_for @child do |f| %>
  <%= f.input :first_name, :label => 'First Name' %>
  <%= f.input :gender, :as => :select, :collection => ['Male', 'Female'] %>
  <%= f.association :relation_types, :as => :collection_select %>

  <%= f.button :submit, :class => "primary" %>

<% end %> 
```

请帮忙。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T10:09:11.843

似乎你忘记了很多事情：

```
@child.relationships.build 
```

它应该是

```
@child.relationships.build :parent_id => ... 
```

而是在视图中

```
f.association :relation_types, :as => :collection_select 
```

利用

```
f.field_for :relationships do |g|
  g.association :types, :as => :collection_select
  g.hidden :parent_id #need to save this 
```

# java - 如何从同一个按钮暂停/恢复 MyCounter？

> ID：11565205
> 
> 赞同：0
> 
> 时间：2012-07-19T16:26:50.337
> 
> 标签：java, android, timer, countdown, countdowntimer

我对 Android 很陌生（我已经编程了将近一个月，感觉好像我大部分时间都在与这个问题作斗争！）

我正在尝试创建一个计时器应用程序。目前有两个按钮，一个是启动计时器（如果再次按下它会将时间重置回 0）和一个停止按钮，它会暂停计时器（如果再次按下则什么也不做）。

我正在尝试使这些按钮执行以下操作：

*   按钮 1 = 如果按下一次启动计时器。如果在计时器运行时按下它会暂停，如果在计时器暂停时按下它会恢复
*   按钮 2 = 如果按下它会重新启动计时器

我的java代码如下：

```
 //within on create
    start = (Button)findViewById(R.id.start);

    stop = (Button)findViewById(R.id.stop);
    tv  = (TextView)findViewById(R.id.tv);
    tv.setText("30"); // starting from 30.

    final MyCounter timer = new MyCounter(30000,1000);
    start.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View v) {
            timer.start();
        }
    });
    stop.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View v) {
            timer.cancel();
        }
    });
}

public class MyCounter extends CountDownTimer{

    public MyCounter(long millisInFuture, long countDownInterval) {
        super(millisInFuture, countDownInterval);
    }

    @Override
    public void onFinish() {
        System.out.println("Timer Completed.");
        tv.setText("Timer Completed.");
    }

    @Override
    public void onTick(long millisUntilFinished  ) {
        tv.setText((millisUntilFinished/1000 + ":" +  millisUntilFinished/100));
        System.out.println("Timer  : " + (millisUntilFinished/1000));
    }
} 
```

我想我将不得不保存和恢复实例状态以暂停和恢复计时器，我将不得不使用布尔值来更改 button1 ('start') 的 onclicklistner，即。如果计时器正在运行并且单击了 button1，请执行此操作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T16:46:04.200

在 onTick 方法中，将剩余的毫秒记录到一个变量中。然后，当您第二次按下按钮时，使用您在 onTick() 方法中记录的剩余时间创建一个新的 CountDownTimer。

# twitter-bootstrap - twitter bootstrap 自定义表单选择框

> ID：11565211
> 
> 赞同：0
> 
> 时间：2012-07-19T16:27:08.723
> 
> 标签：twitter-bootstrap

我查看了 twitter 引导组件，找不到任何自定义表单选择框。我确实找到了一个拆分按钮下拉组件，它看起来像我想要的样式。问题是我需要表单才能提交在选择框中选择的选项的值。有没有办法可以使用拆分按钮下拉菜单并让它保存所选值以通过表单提交。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-25T13:42:03.937

为此 [https://developer.snapappointments.com/bootstrap-select/使用 jQuery 插件 bootstrap-select](https://developer.snapappointments.com/bootstrap-select/)

它将您的选择转换为引导下拉按钮。它保持选择以保持表单的一致性，因此您可以提交选择的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-27T00:09:46.887

试试这个解决方案：

[http://vincentlamanna.com/BootstrapFormHelpers/select.html](http://vincentlamanna.com/BootstrapFormHelpers/select.html)

我最近在使用上面的 Chosen 或 silvio 插件之前发现了它。

或者[http://ivaynberg.github.io/select2/](http://ivaynberg.github.io/select2/)这是最先进的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-09T17:56:22.567

```
<div class="span3">
 <form class="form-horizontal">
  <fieldset>
    <div class="control-group">
       <label class="control-label" for="select01">Select list</label>
       <div class="controls">
         <select id="select01" style="width:100%;">
            <option> option1 </option>
            <option> option2 </option>
         </select>
     </div>
    </div>
    <div>
        <input type="button" id="review-btn" class="btn btn-primary" onclick="this.getvalues()" value="Save changes"/>
    </div>
   </fieldset>
 </form>
</div> 
```

在函数 getvalues() 中，您可以访问所选项目：$('#select01').val();

# mysql - MySQL varchar 大小存储——一字节、两字节转换

> ID：11565222
> 
> 赞同：0
> 
> 时间：2012-07-19T16:27:45.957
> 
> 标签：mysql, varchar

根据 MySQL 文档，`VARCHAR`将使用 1 个字节来表示字符串的长度，前提是该列中的所有值的长度为 0-255，否则将使用 2 个字节。

如果您在一列中有大量数据，并且全部为 255 或更少，并且在条目之后，输入长度为 256 的单个条目，会发生什么情况。是否会启动重新格式化操作以更新此列中的其他字符串以使用 2 个字节而不是 1 个字节？除了插入无效/忽略的数据之外，有没有办法抢占这个操作？类似的东西`myField VARCHAR(1000) not null always-use-two-bytes,`（显然它会比那更干净......但你明白了）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T16:42:54.530

文档中的实际报价是：

> 如果值需要不超过 255 个字节，则一列使用一个长度字节，如果值可能需要超过 255 个字节，则使用两个长度字节。

这对我来说意味着如果你有 varchar(256+) 那么它将从一开始就使用 2 个字节。

# django - Div row-fluid 在 Django 和 Twitter-Bootstrap 中不起作用

> ID：11565224
> 
> 赞同：0
> 
> 时间：2012-07-19T16:27:53.373
> 
> 标签：django, django-templates, twitter-bootstrap

我正在使用 Django 和 Twitter-Bootstrap 创建布局，但模板中的行 div 流体不起作用。我正在使用继承模板并尝试将 div 放在子模板中但不起作用。应该发生的是根据浏览器的分辨率调整页面大小。这是一个例子：http: [//twitter.github.com/bootstrap/examples/fluid.html#](http://twitter.github.com/bootstrap/examples/fluid.html#)

结构可能是：

```
<div class="container-fluid">
<div class="row-fluid">
<div class="span3"></div>
<div class="span9"></div>
</div>
</div> 
```

base.html：

```
<div class="container-fluid">
<div class="row-fluid">
{% block sidebarnav %} {% endblock sidebarnav %}
{% block content %} {% endblock content %}  
</div>  
</div> 
```

base_profile.html：

```
{% extends "base.html" %}     
{% block sidebarnav %} {% endblock sidebarnav %}
{% block content %} {% endblock content %} 
```

base_home.html

```
{% extends "base_profile.html" %}
{% block sidebarnav %} 
<div class="span3">
<div class="well sidebar-nav">
<ul class="nav nav-list">
    <li class="nav-header">Home</li>
    <li class="{% active request '/home/' %}"><a href="{% url 'home' %}"><i class="icon-home"></i>Home</a></li> 
    <li class="divider"></li>
</ul>
 </div>
</div>
{% endblock sidebarnav %}

{% block content %} {% endblock content %} 
```

index_home.html

```
{% extends "base_home.html" %}
{% block content %}
<div class="span9">
content
</div>
{% endblock content %} 
```

使用这种结构，流体 div 行出现在 firebug 中，但无法将布局调整为浏览器的分辨率。谢谢！

编辑（解决方案）：

需要响应完美的文件。

```
<link href="{{ STATIC_URL }}css/bootstrap-responsive.min.css" rel="stylesheet" type="text/css" media="screen" /> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T20:00:01.163

看起来您已经弄清楚了，但是[您缺少的是响应式媒体查询](http://twitter.github.com/bootstrap/scaffolding.html#responsive)：

> Bootstrap 不会自动包含这些媒体查询，但理解和添加它们非常容易，并且需要最少的设置。您有几个选项可以包含 Bootstrap 的响应式功能：
> 
> 1.  使用编译好的响应式版本，bootstrap-responsive.css
> 2.  添加 @import "responsive.less" 并重新编译 Bootstrap
> 3.  将 responsive.less 修改并重新编译为单独的文件

# java - Java中的希伯来语编码

> ID：11565228
> 
> 赞同：0
> 
> 时间：2012-07-19T16:28:03.463
> 
> 标签：java, android, encoding, hebrew, codepages

我有一个编码问题。我有一个 android 应用程序，它包含一个文本字段，允许用户使用希伯来语键盘并键入希伯来语字符。

我希望根据 pc862 希伯来语代码页对这些数据进行编码，以便我可以将其发送到打印机进行打印（打印机配置为根据此代码页接受数据）。我应该可以使用以下代码执行此操作：

```
String strData = new String(textData);
byte [] rawData = null;
try
{
    rawData = strData.getBytes("Cp862"); // Cp862: PC Hebrew
}
catch (UnsupportedEncodingException e)
{
    rawData = strData.getBytes();
} 
```

根据此处找到的文档， [http://docs.oracle.com/javase/7/docs/technotes/guides/intl/encoding.doc.html](http://docs.oracle.com/javase/7/docs/technotes/guides/intl/encoding.doc.html)

我应该能够对此代码页进行编码。但是，代码不断抛出 UnsupportedEncodingException。我正在使用 java se 7 和 jre 7，并且已经导入了 java.io。我不确定这是为什么。我已经尝试过本文档中的其他代码页以及我尝试过的代码页，其中大多数都正确编码。

有谁知道我做错了什么？任何见解将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T20:27:45.523

您是否尝试过使用名称“IBM862”？

如果我运行以下代码：

```
public static void main(String[] args) {
    Map<String, Charset> avmap = Charset.availableCharsets();
    for(String name : avmap.keySet()) {
        System.out.println("Charset: "+avmap.get(name));
    }
} 
```

我得到一个可用字符集名称列表，其中包括“IBM862”但不包括 Cp862。根据您链接的页面，“IBM862”是 Cp862 的**java.nio**名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T16:35:47.100

默认编码 (UTF-8) 支持希伯来语，那么为什么需要 CP862？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T19:25:50.660

我不知道您的应用程序的许可限制，但 GNU Classpath 有这样的编码器，而且[源代码当然是可用的](http://stderr.org/doc/libgcj7-dev/html/gnu/java/nio/charset/Cp862-source.html)。您可以将其包含在您自己的应用程序中（当然是在许可允许的情况下）。

# matlab - 计算几个时间序列之间的相关性

> ID：11565229
> 
> 赞同：1
> 
> 时间：2012-07-19T16:28:09.460
> 
> 标签：matlab, correlation

如果我有一个矩阵：

```
data = rand(365,5); 
```

计算每列与其余列的平均值之间的相关性的最合适方法是什么。例如，对于第一列：

```
 R = nonzeros(tril(corrcoef(data(:,1),mean(data(:,2:end)')'),-1)); 
```

我怎样才能重复这个过程，以便我有 5 个相关值，即每个系列？

编辑：

感谢您的评论。这也可以在一行中完成：

```
R = arrayfun(@(x)nonzeros(tril(corrcoef(data(:,x),...
    mean(data(:,setdiff(1:size(data,2),x))')'),-1)),1:size(data,2)); 
```

对于那些希望避免循环的人。尽管在这种情况下，下面显示的方法由于其可读性而更好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T17:36:04.000

```
for i=1:5
    x = data(:,i);
    y = mean(data(:,(1:5) ~= i)')';
    R(i) = nonzeros(tril(corrcoef(x,y),-1));
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-20T15:32:02.377

稍微简化的版本：

```
R = zeros(1,5);
for i=1:5
    x = data(:,i);
    y = mean(data(:,(1:5)~=i), 2);
    R(i) = corr(x,y);
end 
```

# c++ - Visual Studio 2010 X86 版本忽略 #pragma 警告和 /W0 C++

> ID：11565232
> 
> 赞同：1
> 
> 时间：2012-07-19T16:28:14.213
> 
> 标签：c++, visual-studio-2010, visual-c++, compiler-warnings

Visual Studio 2010 Win32 X86 版本忽略 #pragma 警告和 /W0 C++

所有其他组合（调试和 X64）都使用 #pragma fine 来抑制，但在 X86 版本中没有。也忽略命令行开关 /WO 以抑制所有警告。

这个有什么线索吗？

```
#pragma warning(disable:6308)

Warning 2 warning C6308: 'realloc' might return null pointer: ...

... /Zi /nologo /W0 /WX /O2 /Oi /Oy- /D "WIN32" ... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T13:47:05.353

如果您不需要/不想要代码修复，禁用 WIN32 版本的代码分析将解决此问题。

# google-sheets - 具有多个文本计数的公式

> ID：11565233
> 
> 赞同：-1
> 
> 时间：2012-07-19T16:28:16.120
> 
> 标签：google-sheets, array-formulas, google-sheets-formula

我有一个 Google 表格，其单元格类似于：

A列包含性别（`Man`或`Woman`），
B列包含选择的颜色（可以是多种颜色，即。`Black, Blue, White`）。

![样本数据](../Images/299307abc31ad5986ea44ae4dbac346d.png)

我想做的是计算`Man`选择`Black`或颜色`White`的次数。`Blue`我对每种颜色都尝试了这个公式，但它不起作用：

```
=ArrayFormula( SUM( ('Submissions'!A2:A1095 = "Man" ) * 'Submissions'!B2:B897 = "*Black*" ) ) ) 
```

你能帮我计算一下公式吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T16:01:25.833

确保您的范围大小相同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T12:24:24.163

试试这个

```
= arrayformula(COUNTIF(A:A&B:B, "Man" & "*Black*")) 
```

# ruby-on-rails-3 - 模型四层深度——Rails 3

> ID：11565238
> 
> 赞同：0
> 
> 时间：2012-07-19T16:28:52.020
> 
> 标签：ruby-on-rails-3, routes

如何建立超过两层深度的关联？我有一个资源用户 has_one 博客，其中有很多帖子，其中有很多评论，其中 has_one 联系人。已经是用户 has_may 联系人。但剩下的我该怎么办？用户是否应该拥有_many Posts :through => Blog？还是我应该直接发布参考用户？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T16:41:28.170

由于有许多可能的直接关联和通过关联，您有很多选择，并且没有任何严格的规则。所以设置你需要的东西。您在关联方面确实有很多深度，但是您真的想要 user.posts，因为它们会跨越不同的博客吗？无论如何，我在下面添加了它。

```
class User
  has_many :blogs
  has_many :contacts, :through => :user_contacts
  has_many :posts, :through => :blogs

class UserContacts
  belongs_to :user
  belongs_to :contact

class Blog
  belongs_to :user
  has_many :posts

class Post
  belongs_to :blog
  has_many :comments

class Comment
  belongs_to :post
  has_one :contact

class Contact
  has_many :comments 
```

# magento - Magento：从类别视图中完全可配置的产品

> ID：11565239
> 
> 赞同：0
> 
> 时间：2012-07-19T16:28:56.940
> 
> 标签：magento, categories, product, configurable

本质上，我试图在一个类别的产品列表中获取产品详细信息视图。我已经成功地将可配置选项拉到产品列表中，由[Catgento 和 Inchoo](http://www.catgento.com/adding-configurable-product-options-to-category-list-in-magento/)提供。此解决方案的唯一问题是价格和图像不会像使用此甜蜜[插件](http://www.magentocommerce.com/magento-connect/Matt+Dean/extension/596/simple-configurable-products)在产品详细信息页面上那样更新。

有人有这方面的经验吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-29T14:47:10.883

这个问题相当复杂。

首先，产品详情页面加载“configurable.js”来连接选项和价格。

但是，如果只是添加 JS 文件，它将不起作用。每个产品还需要变量“spConfig”。并模仿产品详细信息页面将此变量连接到“configurable.js”的方式。

然后每个产品价格的 div 可能会更改为。（只需添加一个类）这是因为当您更改可配置选项时，将调用“configurable.js”中的函数“reloadPrice”。参考line.321，你会明白的。

希望这些对你有帮助。

# android - Google Places API：使用我的位置进行文本搜索

> ID：11565250
> 
> 赞同：-1
> 
> 时间：2012-07-19T16:29:30.627
> 
> 标签：android, google-places-api

我开始关注 Google Places APi。

我正在使用 TextSearch，它通常看起来没问题。然而，这些反应并不是我想要的。

这是我的搜索：[https ://maps.googleapis.com/maps/api/place/textsearch/json?query=Reading&sensor=true&key=XxXXXXXXXXMYKEY](https://maps.googleapis.com/maps/api/place/textsearch/json?query=Reading&sensor=true&key=XxXXXXXXXXMYKEY)

上面的搜索响应 REading, PA 然后是 Reading UK，但是当我在 Reading UK 时，我希望首先返回 Reading UK。

所以，我想获得按我的位置排序的结果（但是我不想将我的结果限制在 50 公里半径范围内），是否有关于如何做到这一点的知识？（没有做我自己的距离订购......）

谢谢艾登

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T02:31:39.323

只需将`location`and`radius`参数添加到您的请求中。例如：

> [https://maps.googleapis.com/maps/api/place/textsearch/json?query=Reading&sensor=true&location=51.508315,-0.123013&radius=50000&key=your_api_key](https://maps.googleapis.com/maps/api/place/textsearch/json?query=Reading&sensor=true&location=51.508315,-0.123013&radius=50000&key=your_api_key)

这将使指定半径内的结果偏向于外部的结果，但是，如果半径内的结果不可用，则将被忽略并返回下一个最佳匹配。

有关更多信息，请阅读[文档](https://developers.google.com/places/documentation/#TextSearchRequests)。

# javascript - SignalR 计数连接

> ID：11565251
> 
> 赞同：0
> 
> 时间：2012-07-19T16:29:33.047
> 
> 标签：javascript, c#, jquery, signalr

我正在尝试跟踪并计算连接到我的 signalR 集线器的连接数，但是我做得不对。

我所做的是每次客户端连接计数时都会增加，所以当我打开其他选项卡时，我看到它知道有 2 个客户端。但是，除非我刷新，否则我希望已经连接的客户端能够获得他们没有的更新计数（第一个客户端看到“1”）。

C＃

```
public Task Connect()
{
    _connections.TryAdd(Context.ConnectionId, null);
    return Clients.tally(_connections.Count.ToString());
} 
```

JS

```
chat.tally = function (message) {
    $('#tally').replaceWith(message);
}; 
```

我查看了 Wiki，但没有了解如何实现对所有连接的客户端的回调。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-05-06T20:42:54.983

您的设置似乎没有任何重大问题，`chat.tally()`应该在您连接的客户端上调用并传递正确的参数。也许`message`没有按您的意愿显示。而不是`$('#tally').replaceWith(message);`尝试`$('#tally').html(message);`

# c++ - 带有ORB描述符的opencv FLANN？

> ID：11565255
> 
> 赞同：19
> 
> 时间：2012-07-19T16:29:42.483
> 
> 标签：c++, opencv, sift, surf

我正在尝试将 FLANN 与 ORB 描述符一起使用，但 opencv 使用以下简单代码崩溃：

```
vector<vector<KeyPoint> > dbKeypoints;
vector<Mat> dbDescriptors;
vector<Mat> objects;   

/*
  load Descriptors from images (with OrbDescriptorExtractor())
*/

FlannBasedMatcher matcher;

matcher.add(dbDescriptors); 
matcher.train() //> Crash! 
```

如果我使用`SurfDescriptorExtractor()`它效果很好。

我该如何解决这个问题？

OpenCV 说：

```
OpenCV Error: Unsupported format or combination of formats (type=0
) in unknown function, file D:\Value\Personal\Parthenope\OpenCV\modules\flann\sr
c\miniflann.cpp, line 299 
```

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-08-03T15:20:45.880

Flann 需要描述符为 CV_32F 类型，因此您需要转换它们！[find_object/example/main.cpp](http://find-object.googlecode.com/svn-history/r55/trunk/find_object/example/main.cpp)：

```
if(dbDescriptors.type()!=CV_32F) {
    dbDescriptors.convertTo(dbDescriptors, CV_32F);
} 
```

可能工作;-)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-27T21:24:50.267

这是一个错误。很快就会修复。

[http://answers.opencv.org/question/503/how-to-use-the-lshindexparams/](http://answers.opencv.org/question/503/how-to-use-the-lshindexparams/)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-04-20T19:49:38.323

使用 ORB 时，您应该像这样构建匹配器：

```
FlannBasedMatcher matcher(new cv::flann::LshIndexParams(5, 24, 2)); 
```

我还看到[了这个构造函数的建议](http://answers.opencv.org/question/503/how-to-use-the-lshindexparams/)：

```
FlannBasedMatcher matcher(new flann::LshIndexParams(20,10,2)); 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2018-10-24T13:22:58.503

**二进制字符串描述符**- ORB、BRIEF、BRISK、FREAK、AKAZE 等。

**浮点描述符**- SIFT、SURF、GLOH 等。

* * *

二进制描述符的特征匹配可以通过比较它们的**汉明距离**而不是用于浮点描述符的**欧几里德距离来有效地完成。**

要比较 OpenCV 中的二进制描述符，请使用**FLANN + LSH index**或**Brute Force + Hamming distance**。

[http://answers.opencv.org/question/59996/flann-error-in-opencv-3/](http://answers.opencv.org/question/59996/flann-error-in-opencv-3/)

* * *

默认情况下，FlannBasedMatcher 作为具有 L2 规范的 KDTreeIndex 工作。这就是为什么它可以很好地与 SIFT/SURF 描述符配合使用并为 ORB 描述符[抛出异常的原因。](https://github.com/opencv/opencv/issues/5937)

[二进制特征和局部敏感散列 (LSH)](https://stackoverflow.com/questions/14296394/binary-features-and-locality-sensitive-hashing-lsh)

[二进制和浮点描述符之间的性能比较](https://cvlab.epfl.ch/research/page-90554-en-html/research-detect-binarydescriptors/)

# ruby-on-rails - Ruby（rails）构造函数调用给出语法错误

> ID：11565259
> 
> 赞同：1
> 
> 时间：2012-07-19T16:30:00.213
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, constructor, syntax-error

我正在使用 Sam Ruby 的“Agile Web Development With Rails”一书学习 Rails 开发，当我调用模型的构造函数时出现语法错误。我找到了两种使用替代语法调用构造函数的方法，但我真的很想知道为什么书中使用的语法在我的开发环境中不起作用。

本书使用的语法中键/值对被括号括起来，类似于：

```
product = Product.new (title: "foo", description: "yyy") 
```

此代码在单元测试中。当我运行“rake test:units”时，出现以下错误：

```
product = Product.new (title: "foo", description: "yyy") 
```

****__ *_* __ *_* __ *_* __ *_* __ *_* __ *_* __ *_* __ *_* __ *_* __** ^**

 **ruby_book_demo/depot/test/unit/product_test.rb:16：语法错误，意外 tLABEL

请注意，我已经能够通过执行以下操作来解决语法错误：

```
product = Product.new title: "foo", description: "yyy" #WORKS 
```

或者

```
product = Product.new ({title: "foo", description: "yyy"}) # WORKS! 
```

但我真的很想知道为什么会出现错误。我正在使用 jruby：

jruby -v jruby 1.6.7.2 (ruby-1.9.2-p312) (2012-05-01 26e08ba)

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T16:40:22.337

Product.new 和括号之间不能有空格：

```
Product.new(title: 'foo', description: 'bar') 
```

它在没有括号的情况下工作的原因是因为它们是可选的并且在这种情况下需要一个空格。**

# json - JSONObject 的 Jackson 2 等价物是什么？

> ID：11565260
> 
> 赞同：42
> 
> 时间：2012-07-19T16:30:02.827
> 
> 标签：json, jackson

fastxml API 中的哪个类等价于 org.json.JSONObject？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-07-20T15:15:02.397

看来所寻求的课程是`ObjectNode`，不是`JSONObject`。

`ObjectNode`现在在数据绑定项目中，在`com.fasterxml.jackson.databind.node`包中。最新的 JavaDoc 位于[http://fasterxml.github.com/jackson-databind/javadoc/2.0.2/com/fasterxml/jackson/databind/node/ObjectNode.html](http://fasterxml.github.com/jackson-databind/javadoc/2.0.2/com/fasterxml/jackson/databind/node/ObjectNode.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2021-06-20T03:51:37.237

杰克逊 2.x

`com.fasterxml.jackson.databind.node.ObjectNode`

```
 ObjectMapper mapper = new ObjectMapper();
  ObjectNode json = mapper.createObjectNode();
  json.put("error", "json mapping error"); 
```

# html - CSS目标单击多个

> ID：11565264
> 
> 赞同：0
> 
> 时间：2012-07-19T16:30:18.767
> 
> 标签：html, css, ibooks

我正在写一本交互式书籍，并希望使用 CSS 目标伪选择器触发事件​​。但是，我希望允许多次单击该链接。目前，如果我有两个链接，一个到 Parrot，一个到 Leopard，我可以交替操作，单击一个链接，然后单击另一个来触发事件。我需要的是能够连续点击 Parrot 两次、三次等。

这是 HTML 标记

```
<span id="line1"><a href="#parrot">Litte Parrot</a></span>
<span id="line2"><a href="#leopard">Leopard</a></span> 
```

这是CSS

```
.parrot:target { -webkit-animation: do_something 1s;}
.leopard:target { -webkit-animation: do_something_else 1s;} 
```

谢谢

**编辑**

一直在搞乱替换 div，因此目标对象以及触发它的链接都发生了变化。似乎是一个非常混乱的解决方案，尽管它确实有效。此实例中的链接和目标是同一个对象（鹦鹉的图像）。任何人都可以提出更好的解决方案吗？

HTML 标记

```
<!-- touch activated animation -->
    <a href="#parrot2"><div id="parrot1" class="parrot" onclick="replace1()">
        <div class="left_eye"></div>
        <div class="right_eye"></div>
    </div></a>
    <!-- /touch activated animation -->
    <!-- touch activated animation -->
    <a href="#parrot1"><div id="parrot2" class="parrot" style="display: none" onclick="replace2()">
        <div class="left_eye"></div>
        <div class="right_eye"></div>
    </div></a>
    <!-- /touch activated animation --> 
```

CSS

```
.parrot:target { -webkit-animation: do_something 1s;} 
```

JavaScript

```
function replace1() {
document.getElementById("parrot1").style.display="none";
document.getElementById("parrot2").style.display="block";
}
function replace2() {
document.getElementById("parrot2").style.display="none";
document.getElementById("parrot1").style.display="block";
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T16:02:56.563

看起来你只是在两只不同的鹦鹉之间切换，如果是这样的话，我有一个例子。如果您希望它超过 2 只鹦鹉，请参见示例 2。

示例 1：http: [//jsfiddle.net/yW6T3/1/](http://jsfiddle.net/yW6T3/1/)

示例 1 说明（带注释）：

```
$(document).ready(function() {//when the document is loaded/ready
    $("#parrotlink").click(function() {//on parrotlink click
        $("#parrot1").toggle();//toggle parrot1 on if off, off if on
        $("#parrot2").toggle();//toggle parrot2 on if off, off if on
    });
});​ 
```

示例 2：http: [//jsfiddle.net/yW6T3/2/](http://jsfiddle.net/yW6T3/2/)

示例 2 说明（带注释）：

```
$(document).ready(function() {//when the document is loaded/ready
    $("#parrotlink").click(function() {//On parrotlink clicked do function
          if($(".parrot.active").next(".parrot").length==0)//if there is nothing for a next element/parrot
          {
          $(".parrot.active").removeClass("active");//remove active class from active
          $(".parrot:first-child").addClass("active");//make first parrot active
          }
          else//if there is a next element/parrot in line
          {
          $(".parrot.active").removeClass("active").next(".parrot").addClass("active");//remove active class from active and make next parrot active
          }
    });
});​ 
```

# python - 在 Python 中清除屏幕（使用 Pythonwin 时）

> ID：11565271
> 
> 赞同：1
> 
> 时间：2012-07-19T16:30:42.597
> 
> 标签：python

当我使用 Pythonwin 之类的东西时，我总是必须突出显示调试窗口中的所有内容，然后按删除以摆脱所有内容。有没有办法让程序自动清除调试窗口？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-04-08T12:50:34.907

为了让遇到这个老问题的人清楚。

PythonWin 的交互式 shell 窗口可以通过突出显示所有文本然后按删除来清除，就像它是一个文本编辑器一样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T16:32:03.503

尝试：

```
import os

os.system("cls") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-04T08:54:19.813

这是一个适用于 Pythonwin 的函数：

```
import subprocess

def cls():
  doc=subprocess.sys.stdout.GetDocument()
  Editor=doc.GetEditorView()
  Editor.SetSel(-1,0)
  Editor.ReplaceSel("")

cls() 
```

# html - 设置dataTable中所有列的宽度

> ID：11565274
> 
> 赞同：1
> 
> 时间：2012-07-19T16:30:49.340
> 
> 标签：html, jsf-2, datatable, column-width

我正在`dataTable`使用 JSF2.0 在 JSF 页面中以表格格式显示数据。以下是我拥有的代码。

```
<h:dataTable id="patentBudgetList" var="patentBudgetList" value="#{PersonalInformationDataBean.budgetInfoList}"  border="1" width="40%">
    <h:column>
        <f:facet name="header">
            <h:outputText value="Description" />
        </f:facet>
        <h:outputText value="#{patentBudgetList.budgetTitle}"/>  
    </h:column>
    <h:column>
        <f:facet name="header">
            <h:outputText value="Cost" />
        </f:facet>
        <h:outputText value="#{patentBudgetList.budgetCost}"/>
    </h:column>
</h:dataTable> 
```

我想要的是将列的宽度设置`Description`为`80%`并将列的宽度设置`Cost`为`20%`。

知道如何完成这项工作吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-20T15:06:13.677

下面是我的做法...

```
<h:dataTable id="patentBudgetList" var="patentBudgetList" 
 value="#{PersonalInformationDataBean.budgetInfoList}"  
 border="1" width="40%"
 columnClasses="setWidthOfFirstColumn,setWidthOfSecondColumn"
>
    <h:column>
        <f:facet name="header">
            <h:outputText value="Description" />
        </f:facet>
        <h:outputText value="#{patentBudgetList.budgetTitle}"/>  
    </h:column>
    <h:column>
        <f:facet name="header">
            <h:outputText value="Cost" />
        </f:facet>
        <h:outputText value="#{patentBudgetList.budgetCost}"/>
    </h:column>
</h:dataTable> 
```

在CSS中我有

```
.setWidthOfFirstColumn {
    width: 80%;
}

.setWidthOfSecondColumn {
    width: 20%;
} 
```

# php - 我在哪里可以找到这方面的文档？

> ID：11565280
> 
> 赞同：0
> 
> 时间：2012-07-19T16:30:56.777
> 
> 标签：php

在哪里可以找到以下代码的文档？

```
$a = .01 * rand(0, 100) >= .5; //I don't need doc for this line, its for generating a random boolean!
$b = "it was true!";
$c = "it was false!";

echo "Guess what, " . ( $a ? $b : $c ); // I need documentation for how this works! 
```

[http://viper-7.com/H8upUh](http://viper-7.com/H8upUh)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T16:32:42.193

它是[三元运算符](http://us2.php.net/manual/en/language.operators.comparison.php)，它是一种合并简单`if/else`表达式的方法。

从文档：

```
// Example usage for: Ternary Operator
$action = (empty($_POST['action'])) ? 'default' : $_POST['action'];

// The above is identical to this if/else statement
if (empty($_POST['action'])) {
    $action = 'default';
} else {
    $action = $_POST['action'];
} 
```

# c# - 实体框架可选关系导致“冲突多重性”

> ID：11565283
> 
> 赞同：2
> 
> 时间：2012-07-19T16:30:59.993
> 
> 标签：c#, entity-framework, ef-code-first

我首先将实体框架代码用于包含多项选择题的简单数据库。每个问题都有多个可能的答案，并指定一个作为正确答案。

```
public class Question
{
    public int QuestionId { get; set; }

    [ForeignKey("CorrectAnswer")]
    public int CorrectAnswerId { get; set; }
    public string Text { get; set; }

    public virtual ICollection<Answer> Answers { get; set; }

    public virtual Answer CorrectAnswer { get; set; }
}

public class Answer
{
    public int AnswerId { get; set; }
    [ForeignKey("Question")]
    public int QuestionId { get; set; }
    public string Text { get; set; }

    public virtual Question Question { get; set; }
}

protected override void OnModelCreating(DbModelBuilder modelBuilder)
{
    modelBuilder.Entity<Answer>()
        .HasRequired(a => a.Question)
        .WithMany(q => q.Answers)
        .HasForeignKey(a => a.QuestionId)
        .WillCascadeOnDelete(false);
} 
```

这一切都很好，但我需要避免第 22 条问题，即您无法创建问题，因为它需要正确答案，但您无法创建答案，因为它需要问题。所以我想让 CorrectAnswerId 字段可以为空，允许您创建问题，然后是答案，然后指定正确答案。

我尝试了以下变体，但总是得到“冲突多重性”异常：

```
modelBuilder.Entity<Question>()
            .HasOptional(q => q.CorrectAnswer)
            .WithRequired(a => a.Question)
            .Map(p => p.MapKey("CorrectAnswerId")); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T16:35:07.703

改变

```
 int CorrectAnswerId {get;set;} 
```

至

```
int? CorrectAnswerId {get;set;} 
```

# python - 在具有命名空间的 xml 文件中使用 lxml 库的 Xpath 问题

> ID：11565285
> 
> 赞同：0
> 
> 时间：2012-07-19T16:31:04.437
> 
> 标签：python, xml, xpath, lxml, xml-namespaces

我正在尝试使用命名空间从 xml 文件中选择一个 xml 节点。我已经有一个选择工作，但不能让它为第二个工作。

这是简化的 xml（在 python 代码中存储为 BookMetaData）：

```
<?xml version='1.0' encoding='utf-8'?>
<package xmlns="http://www.idpf.org/2007/opf" unique-identifier="calibre_id">
  <metadata xmlns:opf="http://www.idpf.org/2007/opf" 
  xmlns:dc="http://purl.org/dc/elements/1.1/" 
  xmlns:calibre="http://calibre.kovidgoyal.net/2009/metadata">
    <dc:title>De blanke masai V2</dc:title>
    <meta name="calibre:user_metadata:#origfieldvalue" content="{&quot;is_category&quot;: true, &quot;#extra#&quot;: null}"/>
  </metadata>
</package> 
```

这是我到目前为止编写的python代码：

```
#!/usr/bin/python
# All imports
import lxml.html
import lxml.etree

# namespaces
theNamespaces = {'opf' : "http://www.idpf.org/2007/opf", 
'dc' : "http://purl.org/dc/elements/1.1/", 
'calibre' : "http://calibre.kovidgoyal.net/2009/metadata",
'unique-identifier' : "calibre_id" }

# This part is working perfectly
theXMLdoc = lxml.etree.fromstring(BookMetaData)
theElement2 = theXMLdoc.xpath("//dc:title", namespaces = theNamespaces)[0]
print "lxml.html Source Value:"
print( theElement2.text)
print ""

# This part only returns an emtpy list
theOrigValueElement = theXMLdoc.xpath("//meta[@name='calibre:user_metadata:#origfieldvalue']", namespaces = theNamespaces)
print "Original value of OrigFieldValue:"
print( theOrigValueElement)
print "" 
```

我试过的东西不起作用：
[how-to-use-xpath-from-lxml-on-null-namespaced-nodes](https://stackoverflow.com/questions/6920073/how-to-use-xpath-from-lxml-on-null-namespaced-nodes) namspace“ [http://www.idpf.org/2007/opf](http://www.idpf.org/2007/opf) ”被使用了两次，一次在“包”中不带前缀，一次在“元数据”中带前缀。因此，向命名空间添加另一个前缀将无济于事。

有人可以帮我弄这个吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:58:16.020

如果您只是将 opf 前缀添加到您的 xpath 语句

```
//opf:meta[@name='calibre:user_metadata:#origfieldvalue'] 
```

这似乎可以解决问题

# objective-c - 在 Monotouch 中包装 const char*

> ID：11565287
> 
> 赞同：1
> 
> 时间：2012-07-19T16:31:06.927
> 
> 标签：objective-c, binding, xamarin.ios

我在使用 Monotouch 包装的 Dll 中的某些类时遇到了一些问题。一些方法在 Objective-C 中具有 (const char*) 类型的参数，我在创建包装器时将其转换为字符串。到目前为止一切进展顺利。问题是我有一个类尝试与 url 建立套接字连接。我创建了一个包含 url 名称的字符串变量，但在 Dll 的生成日志中，我总是看到带有特殊字符的 url，例如“X��”，它表示主机名未知。下面是 Obj-C 和 C# 中两种方法的示例：

```
- (BOOL) open:(const char*)method withUrl:(const char*)url withAsync:(BOOL)isAsync;

[Export ("open:withUrl:withAsync:")]
bool Open (string method, string url, bool isAsync); 
```

还有一个：

```
- (id)init:(const char*)url onPort:(int)port andUseSSL:(BOOL)ssl;

[Export ("init:onPort:andUseSSL:")]
IntPtr Constructor (string url, int port, bool ssl); 
```

第一个方法代表一个定制的httpRequest。我什至尝试使用 Encoding.UTF8 对字符串进行编码，但没有成功。

有人知道为什么会这样吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T17:54:18.773

MonoTouch 随附的生成器将 C# 转换`System.String`为 Objective-C `NSString`。这是在 Objective-C（iOS 和 MonoMac）中最常用的字符串表示。

然而，这与 C/C++`char*`不同（Objective-C 也支持它，因为它是 C 的超集）。

您需要使用 a `IntPtr`（而不是 a `string`）并自己编组字符串。

# mysql - MySQL 集群 - SQL 节点无法启动 - 无法分配 nodeid

> ID：11565288
> 
> 赞同：2
> 
> 时间：2012-07-19T16:31:11.127
> 
> 标签：mysql, cluster-computing

2 个数据节点现在正在运行。但是，SqlNode 不会启动。

配置文件

```
[ndbd]
hostname=192.168.177.132
datadir=/usr/local/mysql/data

[ndbd]
hostname=192.168.177.133
datadir=/usr/local/mysql/data

[mysqld]
hostname=192.168.177.131 
```

我的.cnf

```
[mysqld]
ndbcluster
ndb-connectstring=192.168.177.134
basedir=/usr/local/mysql

[mysql_cluster]
ndb-connectstring=192.168.177.134 
```

我收到这个错误...

```
[ndbd] INFO     -- Angel connected to '192.168.177.134:1186'
[ndbd] ERROR    -- Failed to allocate nodeid, error: 'Error: Could not alloc node id at 192.168.177.134 port 1186: Connection done from wrong host ip 192.168.177.131.' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T18:15:48.667

首先，您需要在 config.ini 文件中包含一个 [ndb_mgmd] 部分。

然后您需要启动 ndb_mgdm 进程，然后是您的两个 ndbd，最后是您的 mysqld。

我建议从这里的说明开始......[在多个主机上部署 MySQL 集群](http://www.clusterdb.com/mysql-cluster/deploying-mysql-cluster-over-multiple-hosts/)

您还应该尝试为每个节点设置 NodeId=x 参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-08T21:23:55.863

我通过在管理节点中禁用我的防火墙解决了这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-11T07:01:17.947

首先，确保您的 ndb_mgmd 防火墙打开允许端口 1186 工作（将此端口更改为另一个记录但不工作的端口）其次，在启动 ndb_mgmd 时尝试 --reload 或 --initiate，否则此 ndb_mgmd 将从缓存加载配置。

# mysql - 文本列应该移到最后吗？

> ID：11565295
> 
> 赞同：6
> 
> 时间：2012-07-19T16:31:33.827
> 
> 标签：mysql, sql, database, performance, memory-alignment

如果将动态行移到末尾，则获取数据的速度是否有任何差异。

例如： int , int , int , text 好于 int int text int ?

我的领导告诉我这个事实，怎么从来没有从互联网上得到这样的信息？请帮忙 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T16:34:50.163

这是由于数据对齐。`INT`占用 4 个字节，因此 32 位（相当于 4 个字节）处理器将处理 4 个字节序列中的数据。能够以最适合处理器的顺序提取数据将导致更快的结果和更好的性能。

**参考**：[http ://en.wikipedia.org/wiki/Data_structure_alignment](http://en.wikipedia.org/wiki/Data_structure_alignment)

现在，这是通过通信通道传输数据时经常发现的问题（因为某些编译器通常会通过将保留字节添加到 4 字节对齐某些成员来优化您的数据结构）。`NDBCLUSTER`然而，MySQL 也将 4 字节对齐与引擎考虑在内。这意味着通过将`TEXT`结构放置在`INT`值之间，您会强制检索不必要的数据。

因此：

`INT` `INT` `INT` `INT` `TEXT`由于处理器`INT` `INT` `TEXT` `INT` `INT`可以立即检索 16 字节（四个`INT`）而不用担心`TEXT`.

有关更多详细信息，请参阅**MySQL 文档**：

[http://dev.mysql.com/doc/refman/5.5/en/storage-requirements.html](http://dev.mysql.com/doc/refman/5.5/en/storage-requirements.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T16:59:12.733

`TEXT`并且`BLOB`数据不存储在与列本身相同的空间中。它们存储在为此目的而保留的特殊区域中。

这些列的检索速度*总是*较慢，但根据您的系统调优和数据负载，减速量会有很大差异。有时它是无关紧要的，有时它会导致严重的颠簸。请注意，如果您可以管理它，您应该在字段上使用短`VARCHAR`字段`TEXT`，因为 blob 字段的更长长度并不是免费的。

话虽如此，`TEXT`列作为指向实际数据的指针存储在行中，这使得它们比`VARCHAR`大多数情况下要小得多。如果您不选择它们，它们就不会被加载，并且您不会招致组装其数据所需的额外搜索。

为确保这适用于您的 MySQL 版本和您的调优，请构建两个充满代表性数据的大型表并自行对其进行基准测试。

# html - UL LI 水平定位居中对齐

> ID：11565298
> 
> 赞同：-2
> 
> 时间：2012-07-19T16:31:47.610
> 
> 标签：html, css, html-lists

我想在这个[例子](http://css-tricks.com/centering-list-items-horizontally-slightly-trickier-than-you-might-think/)中做一些事情，只是我需要在每个 li 的图像下方有文本。我怎样才能在图像下方放置文本而不浮动图像或使用签名`</br>`，因为这些都不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T18:04:09.003

你的意思是[这样的样本](http://jsfiddle.net/t66hM/1/)？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T17:49:46.253

尝试使图像具有块显示样式。

`display: block`将导致元素宽度与其父元素一样宽，因此如果您旁边有内联元素，则该内联元素将被强制在其下方。

# javascript - 单击时我的添加到书签 javascript 不会加载

> ID：11565300
> 
> 赞同：-1
> 
> 时间：2012-07-19T16:31:51.933
> 
> 标签：javascript, html, css

我一直在试图弄清楚为什么我的添加到书签 javascript 在单击时不会加载。我认为这与定位的 div 有关：绝对就像我删除所有 div 并且只有链接可以工作一样。我已经包含了我的 css、html 和 javascript。

```
html {
   width:100%; 
   height:100%; 
}

body {
    background: #403F3D url(images/background.png) top center fixed;
    margin:0;
    padding:0;
    font-family: Verdana, Arial, Helvetica, sans-serif;
    color:#444;
    font-size:12px;
    line-height:1.9em;
    text-align: center;
}

* {
    margin:0;
    padding:0;
}

#container {
    position:absolute;
    top: -10px;
    left: 50%;
    margin-left: -447.5px;
    text-align:left;
}

#bookmark {
    position:absolute;
    left:222px;
    top:343px;
    width:282px;
    height:46px;
}

<div id="container"> 
<div id="bookmark">
<a href="javascript:bookmarksite('WoW Mania - World of Warcraft Gameplay Guide', 'http://www.wowmania.net')">
<img src="images/bookmark.png"  class="domroll images/active-bookmark.png"></a>
</div> 
</div>

function bookmarksite(title,url){
if (window.sidebar) // firefox
    window.sidebar.addPanel(title, url, "");
else if(window.opera && window.print){ // opera
    var elem = document.createElement('a');
    elem.setAttribute('href',url);
    elem.setAttribute('title',title);
    elem.setAttribute('rel','sidebar');
    elem.click();
} 
else if(document.all)// ie
    window.external.AddFavorite(url, title);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T17:37:07.010

你使用的是什么浏览器？您的链接在我的 Firefox (V14.01) 中有效，但在 Internet Explorer 中无效。IE 总是对 JavaScript 很挑剔。

检查 IE 中的开发人员工具（按 F12），我收到错误消息：

```
SCRIPT438: Object doesn't support property or method 'addPanel' 
bookmark.js, line 10 character 2 
```

这与您的线路相关联：

```
window.sidebar.addPanel(title, url, ""); 
```

所以，我认为这是浏览器兼容性问题。最好检查：

[从 JavaScript 添加到浏览器收藏夹/书签，但适用于所有浏览器（我的在 Chrome 中不起作用）？](https://stackoverflow.com/questions/992844/add-to-browser-favorites-bookmarks-from-javascript-but-for-all-browsers-mine-do)

它看起来有点混乱，但答案就在那里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T14:17:07.650

试试这个，我从原版修改的脚本。适用于 IE、FF 和 Opera，而 chrome 和 Safari 则为用户提供提示。可悲的是，Webkit 浏览器就是不允许这样做。

```
BookMarkMe = function () {
    var isIEmac = false; /*@cc_on @if(@_jscript&&!(@_win32||@_win16)&& 
    (@_jscript_version<5.5)) isIEmac=true; @end @*/
    var isMSIE = (-[1,]) ? altIeCheck() : true; //added my own embellishment as the original (-1,]) ? false : true didn't work in ie10
    var cjTitle = document.title;
    var cjHref = location.href;

    function hotKeys() {
        var ua = navigator.userAgent.toLowerCase();
        var str = '';
        var isWebkit = (ua.indexOf('webkit') != - 1);
        var isMac = (ua.indexOf('mac') != - 1);
        var isIe = (ua.indexOf('msie') != - 1);

        if (ua.indexOf('konqueror') != - 1) {
            str = 'CTRL + B'; // Konqueror
        } else if (window.home || isWebkit || isIEmac || isMac) {
            str = (isMac ? 'Command/Cmd' : 'CTRL') + ' + D'; // Netscape, Safari, iCab, IE5/Mac
        } else if (isIe){
            str = ('CTRL + D');
        }
        return ((str) ? 'Press ' + str + ' to bookmark this page.' : str);
    }

    function altIeCheck(){
        return (navigator.userAgent.toLowerCase().indexOf('msie') != - 1);
    }

    function isIE8() {
        var rv = -1;
        if (navigator.appName == 'Microsoft Internet Explorer') {
            var ua = navigator.userAgent;
            var re = new RegExp("MSIE ([0-9]{1,}[\.0-9]{0,})");
            if (re.exec(ua) != null) {
                rv = parseFloat(RegExp.$1);
            }
        }
        if (rv > - 1) {
            if (rv >= 8.0) {
                return true;
            }
        }
        return false;
    }

    function addBookmark(a) {
        try {
            if (typeof a == "object" && a.tagName.toLowerCase() == "a") {
                a.style.cursor = 'pointer';
                if ((typeof window.sidebar == "object") && (typeof window.sidebar.addPanel == "function")) {
                    window.sidebar.addPanel(cjTitle, cjHref, ""); // Gecko
                    return false;   
                } else if (isMSIE && typeof window.external == "object") {
                    if (isIE8()) {
                        window.external.AddToFavoritesBar(cjHref, cjTitle); // IE 8                    
                    } else {
                        window.external.AddFavorite(cjHref, cjTitle); // IE <=7
                    }
                    return false;
                } else if (window.opera) {
                    a.href = cjHref;
                    a.title = cjTitle;
                    a.rel = 'sidebar'; // Opera 7+
                    return true;
                } else {
                    alert(hotKeys());
                }
            } else {
                throw "Error occurred.\r\nNote, only A tagname is allowed!";
            }
        } catch (err) {
            alert(err);
        }

    }

    return {
        addBookmark : addBookmark
    }
}(); 
```

# eclipse - Eclipse RCP 将其他插件的日志语句添加到日志插件

> ID：11565305
> 
> 赞同：0
> 
> 时间：2012-07-19T16:32:01.887
> 
> 标签：eclipse, logging, view, rcp

我想在我的 Eclipse RCP 应用程序中显示一些日志记录信息。为此，我在一个单独的插件（单例）中创建了一个 Eclipse 视图。这是我到目前为止得到的代码：

```
public class Console extends ViewPart {    
    private StyledText text;

    public Console() {}

    @Override
    public void createPartControl(Composite parent) {
        text = new StyledText(parent, SWT.READ_ONLY | SWT.MULTI | SWT.H_SCROLL
                | SWT.V_SCROLL);
    }

    @Override
    public void setFocus() {
        this.text.setFocus();
    }

    public void log(String message){
        this.text.append(message);
    } 
} 
```

和配置：

```
<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.4"?>
<plugin>
  <extension
        point="org.eclipse.ui.views">
     <view
           category="org.myApp.ui.category.myApp"
           class="org.myApp.ui.log.Console"
           icon="icons/log.png"
           id="org.myApp.ui.view.console"
           name="Console"
           restorable="true">
     </view>
     <category
           id="org.myApp.ui.category.myApp"
           name="myApp">
     </category>
  </extension>
</plugin> 
```

现在，我想将来自其他插件的消息记录到`StyledText`实例中。最方便的方法是什么？

我尝试了这种[方法](http://waynebeaton.wordpress.com/2006/10/19/displaying-the-console-in-your-rcp-application/)，它很方便，但真的很慢。我真的很感谢你的帮助:) 谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T06:42:41.000

[这](http://ekkescorner.wordpress.com/blog-series/osgi-apps/)是有关登录 OSGI 的一系列精彩文章。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-15T17:40:22.557

这是我的控制台部分的构建后方法。基本上它设置了一个新的 System.out 对象并监听它。

```
@PostConstruct
public void postConstruct(Composite parent) {

    System.out.println("[Console Part] ** Post Construct **"); 

    txtConsole = new Text(parent, SWT.READ_ONLY | SWT.MULTI | SWT.V_SCROLL | SWT.H_SCROLL | SWT.BORDER);

    out = new OutputStream() {

        @Override
        public void write(int b) throws IOException {
            if( txtConsole.isDisposed() )
                return;
            txtConsole.append(String.valueOf((char) b));
        }
    };

    // keep the old output stream
    final PrintStream oldOut = System.out;

    System.setOut(new PrintStream(out));
    txtConsole.addDisposeListener(new DisposeListener() {
        public void widgetDisposed(DisposeEvent e) {
            System.setOut(oldOut);
        }
    });
} 
```

# javascript - jQuery UI #Accordion 加载然后淡入... 怎么样？

> ID：11565309
> 
> 赞同：0
> 
> 时间：2012-07-19T16:32:13.537
> 
> 标签：javascript, jquery, jquery-ui, accordion, fadein

我正在使用一个基本的 jQuery 手风琴脚本（使用 jquery ui），我希望首先加载脚本影响的区域然后淡入（所以没有闪烁的图像，因为它们都加载没有 jquery然后手风琴折叠起来）。在加载该脚本（以及#accordion 和图像）后，我需要在下面的 JS 中添加什么函数才能具有淡入淡出效果？

谢谢，JG

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.7.2/jquery-ui.min.js"></script>

 <script type="text/javascript">
 jQuery(document).ready(function($) {

     $("#accordion").accordion( {active: 2} );

 });
 </script>

 <style>
  #accordion {
    margin: 0px 0 0;
    width: 640px;
    min-height: 650px;
    float: left;
  }

  #accordion H2 {
    background: #f8f7f5;
    color: #582802;
    border: 1px solid #cccccc;
    cursor: pointer;
    font: 12px Arial, Helvetica, sans-serif;
    line-height: 16px;
    margin: 0 0 4px 0;
    padding: 9px 9px 9px 9px;
    font-weight: bold;
  }
 </style>

 <div id="accordion">
     <h2>Click for Image 1</h2>
     <div class="content">
         <img src="img1.jpg">
     </div>

     <h2>Click for Image 2</h2>
     <div class="content">
         <img src="img2.jpg">
     </div>

     <h2>Click for Image 3</h2>
     <div class="content">
         <img src="img3.jpg">
     </div>
 </div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T17:26:57.103

尝试隐藏手风琴（显示：无），然后在文档准备好时淡入。

[http://jsfiddle.net/nQ6Uv/3](http://jsfiddle.net/nQ6Uv/3)

```
<div id="accordion" style="display:none;">...... </div>

$(document).ready(function(){
    $("#accordion").fadeIn("slow");
    $("#accordion").accordion( {active: 2} );  
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T17:39:49.263

嘿，看看我的 JsFiddle。

[http://jsfiddle.net/thewingser/qM5cD/8/](http://jsfiddle.net/thewingser/qM5cD/8/)

我相信这就是你想要的。我也用段落替换了你的图片，只是因为 jsfiddle 无法解析你的图片。

**根据 Lokase 的要求**

```
<html>
    <head>
<link type="text/css" rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/base/jquery-ui.css">
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js"></script>
        <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js"></script>
<script>
window.onload = (function(){
try{
$(document).ready(function() {
$("#accordion").accordion();
});
}catch(e){}});
</script>
        <style>
            #accordion {
    margin: 0px 0 0;
    width: 640px;
    min-height: 650px;
    float: left;
  }

  #accordion H2 {
    background: #f8f7f5;
    color: #582802;
    border: 1px solid #cccccc;
    cursor: pointer;
    font: 12px Arial, Helvetica, sans-serif;
    line-height: 16px;
    margin: 0 0 4px 0;
    padding: 9px 9px 9px 9px;
    font-weight: bold;
  }
        </style>
    </head>
<body>
<script>
    jQuery(document).ready(function(){
    $('.accordion .head').click(function() {
        $(this).next().toggle('slow');
        return false;
    }).next().hide();
});
    </script>
<div id="accordion">
     <h2>Click for Image 1</h2>
     <div class="content">
         <p>test</p>
     </div>

     <h2>Click for Image 2</h2>
     <div class="content">
         <p>test</p>
     </div>

     <h2>Click for Image 3</h2>
     <div class="content">
         <p>test</p>
     </div>
 </div>

</body>
</html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T19:06:32.827

试试这个：

**Javascript**

```
jQuery(document).ready(function ($) {

     $("#accordion").accordion({ active: 1 })
 });

 function li() {
     $(".content").fadeIn(500);
     $("#accordion").accordion({ active: this })
 } 
```

**HTML**

```
<div id="accordion">
 <a onclick="li();"><h2>Click for Image 1</h2></a> 
<div class="content"> 
     <img src="Image/cat.jpg" width="100px" height="100px">
 </div>

<a onclick="li();"> <h2>Click for Image 2</h2></a>
 <div class="content">
     <img src="Image/catUblueUeyes.jpg"  width="140px" height="140px">
 </div>

<a onclick="li();"> <h2>Click for Image 3</h2></a>
 <div class="content"  >
     <img src="Image/jquery.jpg"  width="140px" height="140px">
 </div> 
```

固定或分配给图像的百分比以避免损坏手风琴

# android - 运行时不会生成Android APK

> ID：11565311
> 
> 赞同：6
> 
> 时间：2012-07-19T16:32:19.187
> 
> 标签：android, linux, eclipse, apk

我有几个我下载/编码的 android 应用程序和示例代码。所有这些都在我的 Eclipse 工作区中。我已经在 Eclipse 上安装了 android 开发所需的所有插件/图像。

这些项目在您进行构建时完美编译（我得到“构建成功！”），并且在执行导出签名/未签名时会生成一个 APK 包。

问题就在这里：如果我确实在模拟器或连接的设备中运行，我会得到：

```
Error generating final archive: java.io.EOFException 
```

和：

```
Location : Unkown
Type : Android Packaging Problem 
```

我正在使用 Eclipse 4.2 运行 openSUSE 12.1（也尝试了 3.5 但没有运气） 最新的 ADT 和 android SDK 尝试编译所有 android 版本（1 到 16）

请帮忙，因为我很累或者正在执行 export 和 adb install 以将包放在我的设备上。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-20T08:40:38.260

删除以下文件，然后重试。

> C:\Documents and Setting\User\Local Settings\Application Data\android\debug.keystore 。

# python - 在python中的重定向上将变量传递给模板

> ID：11565313
> 
> 赞同：7
> 
> 时间：2012-07-19T16:32:27.153
> 
> 标签：python, google-app-engine, redirect, jinja2

我对 Python 比较陌生，所以请原谅任何幼稚的问题。

我有一个带有 2 个输入的主页，一个用于“产品”，一个用于“电子邮件”。当用户点击提交时，他们应该被发送到“/success”，它会说：您已请求“产品”您将在“电子邮件”中收到通知

我试图找出通过重定向将“产品”和“电子邮件”值传递到我的“/成功”模板的最佳方法。我在 Google App Enginge 中使用 webapp2 框架和 jinja。

谢谢

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-19T17:20:27.247

当您进行重定向时，请在重定向中包含您的电子邮件和产品变量。在 Google appp 引擎中，使用 webapp2，您当前的重定向可能如下所示：

```
self.redirect('/sucess') 
```

相反，您可以在 URL 中添加变量，如下所示：

```
self.redirect('/success?email=' + email + '&product=' + product) 
```

连接这些值后，上面的 URL 看起来像 '/success?email=this@email.com&product=this_product'。

/success 的处理程序可以通过以下方式获取这些值：

```
email = self.request.get('email')
product = self.request.get('product') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T16:38:04.153

最简单的方法是使用 HTML 表单，提交表单的 POST 请求应包含提交时的值。

# mysql - MySQL - 使用 AUTO_INCREMENT 列插入到 xxx SELECT

> ID：11565316
> 
> 赞同：4
> 
> 时间：2012-07-19T16:32:39.733
> 
> 标签：mysql, select, insert, auto-increment

我有一个 old_table 和一个 new_table：

```
创建表`old_table`（
        `id` bigint(20) NOT NULL AUTO_INCREMENT,
        `col1` varchar(15) 默认为空，
        `col2` int(15) 默认为空，
        ...,
        PREMARY_KEY (`id`)
);

CREATE TABLE `new_table` LIKE `old_table`;

```

然后两个表都填充了一些值。之后，我想从 old_table 中选择一些行并插入 new_table：

```
INSERT INTO `old_table` SELECT * FROM `new_table` WHERE col2 > 100;

```

但这会由于重复键而导致错误。我懒得在 SELECT 子句中指定列，因为在实际系统中，表有很多列。

解决问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T17:00:20.363

```
set @sql =  (select concat('insert into new_table SELECT NULL,',
             group_concat(column_name),' from ','old_table') from information_schema.columns
         where table_name = 'old_table' and table_schema = '<database>' and column_name != 'id'
             order by ordinal_position);

prepare stmt1 from @sql;
execute stmt1;
deallocate prepare stmt1; 
```

在哪里

```
<database> - your database 
```

[在MySQL中选择除一列之外的所有列？](https://stackoverflow.com/questions/9122/select-all-columns-except-one-in-mysql)

[如何从 mySql 中的 EXECUTE 语句插入数据？](https://stackoverflow.com/questions/5746382/how-to-insert-data-from-an-execute-statement-in-mysql)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T16:38:07.237

您可能可以创建一个插入前触发器来测试该`id`值的存在并将其替换为正确的新值（如果可行，则将其设为空 - 我不知道 MySQL 是否会拒绝或给您下一个自动递增的值）如果它是重复的。

就个人而言，我认为我不希望这种触发器持续存在，但如果您只是进行一次性插入，您可以创建触发器，执行插入，然后立即放下触发器。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-03-28T10:42:48.920

我遇到了同样的问题并像这样解决它： - 修改 new_table 的 id 列（删除自动增量和主键，允许 NULL） - 将 new_table 中的所有 ID 设置为 NULL - 现在你可以做

`INSERT INTO 'old_table' SELECT * FROM new_table`

# c++ - 我如何使用 CPU 的 MM0 到 MM7 寄存器？

> ID：11565322
> 
> 赞同：2
> 
> 时间：2012-07-19T16:32:46.067
> 
> 标签：c++, assembly, inline-assembly, x86

我正在使用 Digital-Mars C++ 和 VC++ 10 编译器，并且我有 masm32 汇编器。如何使用 mm0....mm7 64 位寄存器在 eax、eabx 32 位寄存器之间切换数据？我可以在 c++ 编译器 asm{} 或 _asm{} 中使用它们吗？

像这样的东西可能很有用：

```
mmTo32 eax,mm3
mmTo16 bx,mm6
mmTo8 cl,mm4
ToMM mm2,eax 
```

我用谷歌搜索但找不到足够的。

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T16:51:04.253

使用 SSE2，因为 XMM 更好且受支持（感谢 Harold 的评论，XMM 与 MM 寄存器无关，一定是我与 AVX/SSE 混淆了）。

请参阅 MSDN 的此页面：http: [//msdn.microsoft.com/en-us/library/dzs626wx (v=vs.71).aspx](http://msdn.microsoft.com/en-us/library/dzs626wx(v=vs.71).aspx)

您需要的所有内在函数都在这里。它们由编译器展开为内联汇编。

您需要`_mm_loadl_pi`/`_mm_loadh_pi`和`_mm_storel_pi`/`_mm_storeh_pi`将值加载/存储到内存中。

只需包含“xmmintrin.h”文件并在您的项目选项中启用 SSE 代码生成。

# css - 父/子样式css

> ID：11565325
> 
> 赞同：1
> 
> 时间：2012-07-19T16:32:54.087
> 
> 标签：css

请帮我处理这个 CSS 代码：

```
#mediaswap DIV { position: absolute; display: none; }
#mediaswap { position: relative; overflow: hidden; }
#mediaswap div:nth-child(1) { display:block; }​ 
```

我将我所有的`div`s 隐藏在 mediaswap 下`display: none`，然后只显示第一个孩子`div`。`display: block`

我怎样才能得到第一个孩子中的所有内容`display: block`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:35:13.013

尝试

```
#mediaswap div:nth-child(1) * { display: block; }​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T17:23:24.857

如果您实际上没有隐藏任何孩子，那应该不是问题。如果您要针对特定​​的孩子，第 N 个孩子很好，但您可以使用第一个孩子。你需要针对父母的第一个孩子。就像是：

```
#mediaswap { overflow: hidden; position: relative; }
#mediaswap div { display: none; position: absolute; }
#mediaswap:first-child { display:block; }​ 
```

# ms-access - 带有外语数字字段的 MS Access 数据库

> ID：11565335
> 
> 赞同：0
> 
> 时间：2012-07-19T16:33:35.463
> 
> 标签：ms-access

我有一个 MS Access 2007 数据库。我在哥伦比亚和厄瓜多尔的一些客户遇到了一个问题（我相信还会出现更多问题），他们的编号格式与美国不同，他们使用“。” 小数点（或句点）字符作为百万和千位分隔符，并使用“，”逗号字符作为小数位。这要么导致类型不匹配错误，要么我自己的验证将其作为错误捕获，尽管我只使用 IsNumeric() 函数来检查字段内容。

我假设 MS Access 可以识别用户 Windows 设置中设置的任何区域键盘格式。

任何人都可以为我阐明这一点吗？截至目前，唯一的解决方法是将用户键盘设置更改为使用“，”作为百万和千位分隔符和“。” 为小数。

任何帮助将不胜感激！:-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:41:50.987

这应该由本地 PC 上的区域设置控制。您可以设置小数分隔符和数字分组分隔符，然后 Access 与 1.000,21 交互的方式与其他语言环境中的 1,000.21 相同。

```
?Format(1000,"currency")
€1.000,00 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T16:37:57.087

一种解决方案可能是在所有相关字段上运行 replace()，将逗号转换为句点（如果存在）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T22:45:25.237

好的，这是我发现的：

首先，我很抱歉说这是“类型不匹配”。不是。这是一个错误 #2432：“您输入的表达式包含无效的语法，或者您需要将文本数据括在引号中”。我意识到错误发生在 EVAL() 函数上，必须在字符串上完成。我首先将数字转换为字符串，对于具有不同区域设置的小数和组分隔符，将“，”视为逗号而不是小数。就我而言，代码是：

```
If Eval(CStr(cCtl.Value) & ">+" & strMinVal = True Then 
```

所以我使用**了 IAmBatman**的建议并在现场做了一个 REPLACE() 。由于这只是在字段验证过程中，它不会更改实际数据，如下所示：

```
If Eval(CStr(Replace(cCtl.Value),",",".")) & ">+" & strMinVal = True Then 
```

**Remou**，你一直都是对的。我谦虚的道歉。:-)

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2018-12-15T22:37:58.703

这是一个老问题，只要求 ms-access 但也许你可能会遇到类似于我的问题。那么您也可以考虑以下选项：

1.  如果您将 Access 数据库用于您的网页，则此问题可能与 IIS 有关。感谢 Dmitriy Pavlov 的简短[回答：](https://stackoverflow.com/questions/6484053/how-to-set-date-and-time-format-in-iis-7)

    *   打开 IIS 7
    *   选择您的网站
    *   打开 .NET 全球化
    *   从文化选项卡中，选择所需的文化和 UI 文化。
    *   做 iisreset
2.  此问题可能与 Visual Studio 设置有关。感谢 Jim Mischel 的 简短[回答：](https://stackoverflow.com/questions/3752788/how-to-define-the-locale-of-an-application-in-net)

`Thread.CurrentThread.CurrentCulture = new CultureInfo("en-US", false);`

# php - 一个完整的php项目在线调试器

> ID：11565336
> 
> 赞同：0
> 
> 时间：2012-07-19T16:33:37.490
> 
> 标签：php, mysql

我正在寻找一个在线服务，我可以在其中托管我的整个 php 项目，其中包含 mySql、java 脚本等，并且能够像使用 Eclipse PDT（Zend 调试器插件等）一样逐行调试我的 php 代码.

我不是在寻找这里提到的[类似问题](https://stackoverflow.com/questions/5286199/an-online-php-debugger-code-editor)的 pastebin ，我在寻找一个完整的在线调试包，以便我们可以在线完成所有开发。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T16:35:45.347

听起来您正在寻找服务器或 VPS 解决方案。您可以使用 xdebug，安装您想要的任何软件，并以您想要的方式使用它。

# c# - C#中的datagridview按钮列？

> ID：11565337
> 
> 赞同：0
> 
> 时间：2012-07-19T16:33:40.030
> 
> 标签：c#, winforms, datagridview, visual-c#-express-2010

我遇到了一个问题，每当我的行高增加时，按钮的高度也会增加，从而创建：

![在此处输入图像描述](../Images/7055915433746fa261e9668863b9d584.png)

如何将此按钮的宽度设置为 20？另外，图像列也可以包含文本吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T19:27:36.450

您可以通过在行更改高度时更改单元格的填充来模拟这一点。

```
using System;
using System.Drawing;
using System.Linq;
using System.Windows.Forms;

class Form1 : Form
{
    [STAThread]
    static void Main()
    {
        Application.EnableVisualStyles();
        Application.SetCompatibleTextRenderingDefault(false);
        Application.Run(new Form1());
    }

    public Form1()
    {
        ClientSize = new Size(640, 480);
        DataGridView dgv = new DataGridView
            {
                Dock = DockStyle.Fill,
                Font = new Font(FontFamily.GenericSansSerif, 36),
                AutoGenerateColumns = false,
                AllowUserToAddRows = false,
                RowHeadersVisible = false,
                ColumnHeadersHeightSizeMode = DataGridViewColumnHeadersHeightSizeMode.AutoSize,
                Columns =
                {
                    new DataGridViewTextBoxColumn { HeaderText = "TextBox", DataPropertyName = "Text", AutoSizeMode = DataGridViewAutoSizeColumnMode.Fill, },
                    new DataGridViewButtonColumn { Name = "ButtonColumn", HeaderText = "Button", AutoSizeMode = DataGridViewAutoSizeColumnMode.ColumnHeader, DefaultCellStyle = new DataGridViewCellStyle { Padding = new Padding(2) } },
                },
                DataSource = Enumerable.Range(1, 5).Select(i => new { Text = "Item " + i.ToString() }).ToList(),
            };

        dgv.RowHeightChanged += (s, e) =>
            {
                DataGridViewCell cell = e.Row.Cells["ButtonColumn"];
                int pad = (e.Row.Height - 25) / 2;
                cell.Style.Padding = new Padding(2, pad, 2, pad);
            };

        Controls.Add(dgv);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T16:39:33.540

请确保按钮 `button1.AutoSize = true;`设置为 false

[http://msdn.microsoft.com/en-us/library/system.windows.forms.button.autosizemode](http://msdn.microsoft.com/en-us/library/system.windows.forms.button.autosizemode)

# android - Jelly Bean 中的离线听写功能是 AOSP 的一部分吗？如果是，它在什么包中？

> ID：11565338
> 
> 赞同：11
> 
> 时间：2012-07-19T16:33:40.877
> 
> 标签：android, speech-recognition, android-source, speech-to-text

我一直在搜寻 Jelly Bean 以查看是否可以找到离线听写功能，但我运气不佳。如您所知，来源庞大而繁琐。我找到了 /external/srec 文件夹，但其中的文档似乎来自 Nuance，当时 Android 于 2007 年首次推出。这是否仅作为封闭源 Google 应用程序 (Gms) 提供？

谢谢

贾里德

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T05:52:41.583

不幸的是，我不认为它是 AOSP 的一部分。

有一个名为 VoiceInputMethodService 的 IME，很可能是离线听写的来源。此 IME 存在于 ICS 中的 VoiceSearch.apk 下，在 JB 中已重命名为 QuickSearch.apk

比较这两个项目的 ICS 和 JB 中的类，您可以看到 Jelly Bean 版本下许多与语音识别相关的新类。名称为“Majel”、“Recognizer”和“decoder”的新类和包。

今晚我没有时间完成所有这些，我仍然需要确认 VoiceInputMethodService 是用于离线解码的 IME，但希望这会为您指明正确的方向。

# c# - 代码页 437 中旧 DOS 字符的错误显示

> ID：11565340
> 
> 赞同：1
> 
> 时间：2012-07-19T16:33:53.107
> 
> 标签：c#, visual-studio, character-encoding, console-application, codepages

我正在制作一个文本模式游戏，显然我在用 C# 显示一些关键字符时遇到了一些问题。它们来自代码页 CP437，但即使我将代码页设置为 437：

```
Console.OutputEncoding = Encoding.GetEncoding(437); 
```

当我尝试打印我需要的字符时，我唯一看到的是“？？？？？？” （一些问号），好像 Visual Studio 的控制台无法打印它们。我需要的这些字符是 0xB0、0xB1、0xB2、0xDB。

顺便说一句，我以这种编码打印了所有 256 个字符，我看到显示为“？”的字符要多得多。

TIA。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T17:21:23.327

控制台的默认代码页已经是 437。最可能的故障模式实际上是尝试写入 0xb0 等，而不是这些字符的 Unicode 版本。这确实会引起很多问号，U+0080 到 U+00ff 范围内的许多代码点未分配或在第 437 页中没有相应的字符。

代码页 437 中的 0xb0 在您的 C# 代码中是“\u2591”。检查[此页面](http://en.wikipedia.org/wiki/Code_page_437)以获取代码。

# spring-mvc - 使用 Roo 防止 Spring MVC 中的质量分配

> ID：11565342
> 
> 赞同：4
> 
> 时间：2012-07-19T16:33:56.800
> 
> 标签：spring-mvc, security, spring-roo

我正在使用 Spring Roo 开始一个新项目。我发现它生成的 MVC 控制器容易受到**批量分配**的影响。我想知道是否有一种标准方法可以只允许更新某些字段。我正在考虑使用@InitBinder，但我不知道这是否是最好的方法。

我的印象是，我所知道的大多数 Java EE 框架都忽略了这个问题和 CSRF 预防。更糟糕的是，即使在它们自己的示例代码中也经常发现这些漏洞。

旁注：我已经知道 HDIV，但我不想“丑化”我漂亮的 REST URL，除了 CSRF 预防。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T10:13:28.437

这个问题没有很好的解决方案，选项：

*   创建表单或 DTO 对象，它们的字段仅包含表单中的内容（但这不适用于 spring roo）
*   使用对象的 2 个实例，表单实例和数据库实例，然后仅将表单页面中的字段从表单实例复制到 db 实例

本文可用于帮助解决批量分配问题： [http ://blog.42.nl/articles/leveraging-the-spring-mvc-3.1-handlermethodargumentresolver-interface/](http://blog.42.nl/articles/leveraging-the-spring-mvc-3.1-handlermethodargumentresolver-interface/)

# javascript - 生产服务器上的“未捕获的类型错误：未定义不是函数”

> ID：11565344
> 
> 赞同：0
> 
> 时间：2012-07-19T16:34:04.953
> 
> 标签：javascript, jquery, ruby-on-rails, jquery-ui

我在我的 Spree 商店设置了[https://github.com/blueimp/Bootstrap-Image-Gallery 。](https://github.com/blueimp/Bootstrap-Image-Gallery) 在开发机器上一切正常。 当按下图像预览时，我在生产服务器上收到错误。 链接到我收到错误的页面：http: [//vk-magazin.com/products/krossovki-adidas-1](http://vk-magazin.com/products/krossovki-adidas-1)

![图库错误](../Images/bd54ec7adbfbf275cf48c9215b5a4ba4.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-21T16:51:10.223

我将 Twitter Bootstrap 主题与 bootstrap-sass gem 一起使用。
并且在包含 bootstrap-sass 时犯了错误。你只需要创建文件

/app/assets/stylesheets/store/ 中的 tb.css.css

其中应包含：

```
@import "bootstrap"; 
```

要找出您设置了正确的 TB，请检查源代码中的 tb.css 文件。
如果您看到带有类似注释的行

```
/* /../../..ruby-gems bla bla bla */
.clearfix { 
```

你设置了 TB css 正确
的 Javascript 包括
在 app/assets/javascripts/store/all.js

```
. . .
    //= require bootstrap
. . . 
```

在这个带有 TB 的 js 之后应该可以正常工作。

# c# - C# Mouse_Event 不同步

> ID：11565348
> 
> 赞同：1
> 
> 时间：2012-07-19T16:34:23.263
> 
> 标签：c#

我有个问题。当我使用 Sendkeys.SendWait 向应用程序发送击键时，我会更改鼠标的位置并再次发送击键。但是当我更改位置并发送击键时，它会将键发送到最后一个位置，而不是当前位置。我认为这可能是因为应用程序没有等待 mouse_event 被处理。你能给我一些关于如何等到 mouse_event 完成的例子吗？

这是代码：

```
SendKeys.SendWait("aaa");
Cursor.Position = new Point(Cursor.Position.X - 70, Cursor.Position.Y + 40);
uint X = (uint)Cursor.Position.X;
uint Y = (uint)Cursor.Position.Y;
mouse_event(MOUSEEVENTF_LEFTDOWN | MOUSEEVENTF_LEFTUP, X, Y, 0, 0);
SendKeys.SendWait("aaa1"); 
```

# javascript - jquery在回发时坏了

> ID：11565356
> 
> 赞同：0
> 
> 时间：2012-07-19T16:34:46.387
> 
> 标签：javascript, jquery, asp.net

我是 webdevelopement 和 Jquery 的新手，我有一个带有单选列表（3 个）项目和 3 个 div 的 aspx 页面，我在启动时隐藏了所有 3 个

在回帖中我正在检查，如果选择了一个按钮，我正在尝试再次使用 jquery 来显示 div 可以检查并查看我哪里出错了

```
 <asp:RadioButtonList ID="RdoListAdminTasks"  runat="server" BackColor ="SkyBlue">
    <asp:ListItem Text = "Add Employee" >Add Employee</asp:ListItem>
    <asp:ListItem Text = "EditEmployee">Edit Employee</asp:ListItem>
    <asp:ListItem Text = "AddCCB">Add CCB</asp:ListItem>
    </asp:RadioButtonList>

 <script type="text/javascript">
   var rbvalue = $("input[@name=<%=RdoListAdminTasks.UniqueID%>]:radio:checked").val();

        rbvalue=rbvalue;

        if (typeof rbvalue == 'undefined'){
                    $().ready(function() {
                    $('.AddCCB').hide();
                    $('.EditEmployee').hide();
                    $('.Add_Employee').hide();

                                           });
        }   

        else{
        switch (rbvalue){

            case 'Add Employee':
                              $('.AddCCB').fadeOut('fast');
                              $('.EditEmployee').fadeOut('fast');
                              $('.Add_Employee').fadeIn('slow'); 
                              break;
            case 'Edit Employee':            
                                $('.AddCCB').fadeOut('fast');
                                $('.Add_Employee').fadeOut('fast');        
                                $('.EditEmployee').fadeIn('slow');
                                break;
             case 'Add CCB':
                                $('.EditEmployee').fadeOut('fast');
                                $('.Add_Employee').fadeOut('fast');
                                $('.AddCCB').fadeIn('slow');
                                break;
            default:
                                alert("How'd you get here? Who sent you?");
                                $('.AddCCB').fadeOut('fast');
                                $('.EditEmployee').fadeOut('fast');
                                $('.Add_Employee').fadeOut('fast');
                                break; 

        }

        } 

     </script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T16:52:30.917

我认为您在这里做错了：缺少`doucment.ready`功能。还：

```
 $('.AddCCB').hide(); 
```

`.`这里的DOT 代表`cssClass` 这里，我看不到你已经分配了任何地方。

如果你想用 ID 隐藏：

```
 $('#<%= AddCCB.ClientID %>').hide(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T16:49:40.297

当该脚本运行时，您的页面可能未完全呈现。

尝试使用[document.ready](http://api.jquery.com/ready/)：

```
function UpdateUIDisplay() {
    var rbvalue = $("input[@name=<%=RdoListAdminTasks.UniqueID%>]:radio:checked").val();

    rbvalue=rbvalue;

    if (typeof rbvalue == 'undefined'){
                $().ready(function() {
                $('.AddCCB').hide();
                $('.EditEmployee').hide();
                $('.Add_Employee').hide();

                                       });
    }   

    else{
    switch (rbvalue){

        case 'Add Employee':
                          $('.AddCCB').fadeOut('fast');
                          $('.EditEmployee').fadeOut('fast');
                          $('.Add_Employee').fadeIn('slow'); 
                          break;
        case 'Edit Employee':            
                            $('.AddCCB').fadeOut('fast');
                            $('.Add_Employee').fadeOut('fast');        
                            $('.EditEmployee').fadeIn('slow');
                            break;
         case 'Add CCB':
                            $('.EditEmployee').fadeOut('fast');
                            $('.Add_Employee').fadeOut('fast');
                            $('.AddCCB').fadeIn('slow');
                            break;
        default:
                            alert("How'd you get here? Who sent you?");
                            $('.AddCCB').fadeOut('fast');
                            $('.EditEmployee').fadeOut('fast');
                            $('.Add_Employee').fadeOut('fast');
                            break; 

    }

    } 
 }

 $(function() { UpdateUIDisplay(); });
 </script> 
```

# asp.net - 中继器内中继器

> ID：11565360
> 
> 赞同：0
> 
> 时间：2012-07-19T16:34:52.443
> 
> 标签：asp.net, repeater, datasource

我在另一个中继器（REPEATER FATHER）中有一个中继器（REPEATER SON）......

在代码端，我`repeaterSON`使用列表 SON1 和`repeaterFATHER`列表 FATHER1 设置数据源。

在客户端（ASPX）中，在 repeaterSON 中我得到一些标签文本，在 repeaterFATHER 中得到一些标签`<%#Eval("propObjrepeaterSON)"%>...`文本`<%#Eval("propObjFATHER1")%>`。

在客户端，如何获取中继器 B 中 SON1 列表的值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T16:49:14.493

给每个转发器SON 一个唯一的ID，例如`repeaterSON_<%#Eval("sonID")#>`。然后你可以使用jQuery获取特定的repeaterSON。

# c - 使用结构的节点

> ID：11565361
> 
> 赞同：1
> 
> 时间：2012-07-19T16:34:53.570
> 
> 标签：c, struct

```
typedef struct{

      int key;
      int priority;
}array_node;

array_node *newNode(int key, int priority) {

     array_node *g;
     g = (array_node *)calloc(1,sizeof(array_node));

     if (NULL==g) {
        fprintf(stderr, "Out of mem!\n");
        return (NULL);
     }

     g->key=key;
     g->priority=priority;
     return g;
}

int main(){

    array_node *newNode;
    newNode->key = 5;
    newNode->priority = 1000;

    printf("%d\n",newNode->key);
} 
```

大家好！我需要了解为什么在编译程序时会出现分段错误。似乎一切都很好，但我不知道错误来自哪里。

我只是在实现一个节点结构。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T16:40:20.387

首先：

```
g = (array_node *)malloc(sizeof(array_node *)); 
```

它应该是

```
g = malloc(sizeof(array_node)); 
```

在第一个中，您为 array_node 指针分配内存，但您需要 array_node 对象。当你后来尝试做

```
g->key=key;
g->priority=priority; 
```

您引用的是内存中的某个位置，而不是对象组件。当然，您不必将 malloc 返回值强制转换为 (array_node*)，因为在 C 中您不必从 void* 强制转换。[在这里](https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc)你可以阅读它。

另一个更严重的错误，因为那是您的段错误的来源：

```
array_node *newNode;
newNode->key = 5;
newNode->priority = 1000; 
```

应该像另一位响应者指出的那样：

```
array_node* node = newNode(5, 1000); 
```

在您的版本中，您只需创建一个指向 array_node 对象的指针（只是一个内存地址），因此您不能引用键或优先级，因为它们不存在。

* * *

现在我看到您将 malloc 更改为

```
array_node *g;
g = (array_node *)calloc(1,sizeof(array_node)); 
```

当你想为数组分配内存时，你应该使用 Calloc。在您的情况下，您应该使用 malloc，您可以在上面找到它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-19T16:40:53.330

尝试这个

```
// use these headers
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

typedef struct{
  int key;
  int priority;
}array_node;

array_node *newNode(int key, int priority) {

  // sizeof(array_node), not sizeof(array_node) == sizeof(void*) == 4 or 8 typically
  array_node *g = malloc(sizeof(array_node));

  if (NULL==g) {
     fprintf(stderr, "Out of mem!\n");
     return (NULL);
  }

  g->key=key;
  g->priority=priority;
  return g;
}

int main(){
   /// call the function, not just type its name
   array_node* n = newNode(5, 1000);

   printf("Key = %d, Priority = %d\n", n->key, n->priority);

   return 0;
} 
```

注意右括号，它不是 Python，而是 C。 printf() 不会为您考虑。它只会打印 n 的地址。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-19T16:40:42.020

查看 main()：

```
array_node *newNode; 
```

这个指针有一个未定义的值。正确的是：

```
array_node *node = newNode(5, 1000); 
```

# django - django 中的 django-rating 过滤

> ID：11565366
> 
> 赞同：1
> 
> 时间：2012-07-19T16:35:16.240
> 
> 标签：django

我正在尝试做一些非常简单和微不足道的事情，但没有运气。

我正在使用 django-rating 对我网站上的特定对象进行评分。在我想评价的模型上，我有一个字段：

```
rating = RatingField(range=5) 
```

现在，我想要的只是过滤所有速率为 2 和 aobve 的对象。

例如，如果 rating 是 IntegerField，我只需要这样做：

```
objects.filter( rating__gte = 2) 
```

我怎样才能使用 django-rating 做同样的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T19:27:29.617

阅读[django-rate 文档](https://github.com/dcramer/django-ratings)我发现了这个按速率排序的技巧：

```
# In this example, ``rating`` is the attribute name for your ``RatingField``
qs = qs.extra(select={
    'rating': '((100/%s*rating_score/(rating_votes+%s))+100)/2' 
               % (MyModel.rating.range, MyModel.rating.weight)
                      })
qs = qs.order_by('-rating') 
```

也许您可以修改此代码示例并使用[额外的 where](https://docs.djangoproject.com/en/dev/ref/models/querysets/#django.db.models.query.QuerySet.extra)来获取结果：

```
qs = qs.extra(where=[
         '((100/%s*rating_score/(rating_votes+%s))+100)/2 >= 2 ' % 
          (MyModel.rating.range, MyModel.rating.weight)  ,
                    ]) 
```

# objective-c - Instruments 是否与 Objective-C++ 一样工作？

> ID：11565368
> 
> 赞同：1
> 
> 时间：2012-07-19T16:35:34.187
> 
> 标签：objective-c, xcode, memory, instruments, memory-leaks

我正在分析一个Objective C++程序，在负责的调用者中，它没有显示创建对象的确切方法，也没有显示释放点，它只显示“CA::Display::DisplayLink::dispatch(unsigned long long, unsigned long long) “我正在分析的程序是一个使用 cocos2d 的游戏，大多数类都是 C++ .mm。我知道 xcode 不完全支持 Obj-C++ 这就是仪器没有显示足够信息的原因吗？

PS我正在使用Xcode 4.3

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T17:17:38.273

如果对象本身是 C++，请使用分配工具，单击“i”并尝试将配置调整为“识别 C++ 对象”。如果您使用的是 Leaks，我建议您改用 Allocations 和[Heapshot analysis](http://www.friday.com/bbum/2010/10/17/when-is-a-leak-not-a-leak-using-heapshot-analysis-to-find-undesirable-memory-growth/)。在大多数情况下，我发现它比 Leaks 工具强大得多。

也就是说，dispatch() 方法可能会掩盖信息，这可能与 C++ 无关；在深入到 dispatch() 时，它可能只是对 Instruments 的限制。这有时会发生。

尽管如此*，* ObjC++ 并不是一种在整个项目中传播的好语言。用纯 C++ 编写你的低级代码。用纯 ObjC 编写您的高级代码。使用 ObjC++ 的薄胶层将它们绑在一起。与纯 C++ 或纯 ObjC 相比，ObjC++ 存在许多问题，从较差的工具支持到运行时性能问题。是胶水；它不是实质。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T20:05:52.077

最后我发现是什么让仪器无法显示实际的方法调用，不是 Obj C++，我最近更新了开发人员会员资格，我的 iPad 上似乎有 2 个应用程序副本，仪器正在分析每次都是旧的。天哪！

# arrays - Ruby gem 将文本分页到换行列中

> ID：11565369
> 
> 赞同：1
> 
> 时间：2012-07-19T16:35:34.707
> 
> 标签：arrays, ruby, text, formatting

是否有任何简单的 gem 或方法可以将数组（或 CSV 行）打印为文本表，只要终端的宽度参数没有还没用完？

例如，注意 'ls' 的对齐、节省空间的输出（从上到下然后从左到右排序）：

```
 # ls
30_os-prober                Documents         Pictures           sysadmin.geany  xorg.conf
avivotool.regdump_good.txt  Downloads         Public             Templates       xorg.conf.00
bin                         fbcmd_update.php  regdump_broke.txt  tmp
crontab.root@quant.txt      grub-mkconfig     stuck.packages     unity.log
Desktop                     Music             sync               Videos 
```

我一直在使用“文本表”gem，例如。

```
 puts $csv_rows[1].to_a.transpose.to_table.align_column 2, :right 
```

但它只能垂直垂直向下打印 100 行，即使水平方向可能只使用 30 个字符。我希望输出将右侧空间用于一列或多列项目，否则这些项目将位于第 1 列的底部。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T20:10:15.103

试验了一下。我根本不喜欢的一种方式，但只使用两列模式：

```
i=0; puts (sa=$csvrow.to_a.transpose.to_table.align_column(2, :right).to_s.split("\n") )[0..sa.size/2].map{|e| e + sa[(i+=1)+sa.size/2].to_s + "\n"} 
```

它真正做的只是循环前半部分，从项目 i=0 到 n/2，从 i + n/2 （后半部分）附加项目，并在它进行时添加一个换行符。to_table 使每个项目的字符串保持相同的固定长度，因此最后看起来都是对齐的。可能是可以建立的东西。

# perl - 比较两个文件时，如何跳过（忽略）空行？

> ID：11565370
> 
> 赞同：3
> 
> 时间：2012-07-19T16:35:43.547
> 
> 标签：perl, file, blank-line

我正在将行与两个文本文件`ref.txt`（参考）和`log.txt`. 但是我想忽略的任何一个文件中都可能有任意数量的空行；我怎样才能做到这一点？

**参考文件**

```
one

two

three

end 
```

**日志.txt**

```
one
two
three
end 
```

输出中不会有不正确的日志行，换句话说`log.txt`，与`ref.txt`.

我喜欢用伪代码完成的事情：

```
while (traversing both files at same time) {
    if ($l is blank line || $r is blank line) {
        if ($l is blank line)
            skip to next non-blank line
        if ($r is blank line)
            skip to next non-blank line
    }
    #continue with line by line comparison...
} 
```

我当前的代码：

```
use strict;
use warnings;

my $logPath    = ${ARGV [0]};
my $refLogPath = ${ARGV [1]} my $r;    #ref log line
my $l;                                 #log line

open INLOG, $logPath    or die $!;
open INREF, $refLogPath or die $!;

while (defined($l = <INLOG>) and defined($r = <INREF>)) {
    #code for skipping blank lines?
    if ($l ne $r) {
        print $l, "\n";                #Output incorrect line in log file
        $boolRef = 0;                  #false==0
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-19T16:48:59.817

如果您在 Linux 平台上，请使用：

```
diff -B ref.txt log.txt 
```

该`-B`选项会导致忽略仅插入或删除空行的更改

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T16:38:57.827

您可以通过将其与此正则表达式进行比较来跳过空白行：

```
next if $line =~ /^\s*$/ 
```

这将匹配任何可能构成空白行的空格或换行符。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-19T17:06:19.063

这种方式对我来说似乎是最“类似perl”的。没有花哨的循环或任何东西，只需 slurp 文件并 grep 出空白行。

```
use warnings;

$f1 = "path/file/1";
$f2 = "path/file/2";

open(IN1, "<$f1") or die "Cannot open file: $f1 ($!)\n";
open(IN2, "<$f2") or die "Cannot open file: $f2 ($!)\n";

chomp(@lines1 = <IN1>); # slurp the files
chomp(@lines2 = <IN2>);

@l1 = grep(!/^\s*$/,@lines1); # get the files without empty lines
@l2 = grep(!/^\s*$/,@lines2);

# something like this to print the non-matching lines
for $i (0 .. $#l1) {
   print "[$f1 $i]: $l1[$i]\n[$f2 $i]: $l2[$i]\n" if($l1[$i] ne $l2[$i]);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T16:42:57.793

您可以循环查找每一行，每次：

```
while(1) {
    while(defined($l = <INLOG>) and $l eq "") {}
    while(defined($r = <INREF>) and $r eq "") {}

    if(!defined($l) or !defined($r)) {
        break;
    }

    if($l ne $r) {
        print $l, "\n";
        $boolRef = 0;
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-19T16:46:47.810

```
man diff

diff -B ref.txt log.txt 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-19T16:47:15.967

```
# line skipping code
while (defined($l=<INLOG>) && $l =~ /^$/ ) {}  # no-op loop exits with $l that has length

while (defined($r=<INREF>) && $r =~ /^$/ ) {}  # no-op loop exits with $r that has length 
```

# ruby-on-rails-3 - 未调用 Rails 应用程序上的 Paypal IPN

> ID：11565378
> 
> 赞同：0
> 
> 时间：2012-07-19T16:36:11.400
> 
> 标签：ruby-on-rails-3, paypal-ipn, paypal-sandbox, activemerchant

我们正在使用 Paypal 自适应链式支付来允许在众筹网站上捐款。在付款成功后（在沙箱中），我已经完成了付款并返回到“return_url”的所有工作。

Paypals 关于在沙盒中测试 IPN 的文档很少。也许我错过了某处启用 IPN 回调的设置？

我希望能够使用 IPN 回调来验证付款是否成功。我想查看回调 JSON，以便知道要捕获和比较哪个字段。我找到了示例代码，但是沙盒中似乎没有调用 IPN 回调。我试图像这样输出参数（也没有调用 puts 语句）：

```
****backers_controller.rb
class BackersController < ApplicationController    
include ActiveMerchant::Billing::Integrations

  def callback_ipn
    puts "callback: ipn"
    notify = PaypalAdaptivePayment::Notification.new(request.raw_post)
    puts notify.to_yaml
  end

  def callback_return
    puts "callback: return"
    @backer = Backer.find(params[:id])
    @reward = @project.rewards.find_by_id(@backer.reward_id)
    @backer.callback

    respond_to do |format|
      format.html { render :layout => 'application_proj_back_blog' }
      format.json { render json: @backer }
    end
  end 
```

（“callback_return”操作正在运行）

```
****backer.rb
class Backer < ActiveRecord::Base
  include ActionDispatch::Routing::UrlFor
  include Rails.application.routes.url_helpers

def purchase
  project = Project.find(self.project_id)
  default_url_options[:host] = 'localhost:3000'
  proj_owner_email = User.find(project.user_id).email
  recipients = [{:email => PRIMARY_EMAIL,
               :amount => total_pledge,
               :primary => true},
              {:email => project.paypal_email,
               :amount => project_owner_cut,
               :primary => false}
  ]
  response = GATEWAY.setup_purchase(
    :action_type => "PAY_PRIMARY",
    :return_url => callback_return_project_backer_url(project, self),
    :cancel_url => callback_cancel_project_backer_url(project, self),
    :ipn_notification_url => callback_ipn_project_backer_url(project, self),
    :currency_code =>"USD",
    :receiver_list => recipients
  )
  puts response.to_yaml
  pay_key = response["payKey"]

  pledge_transactions.create!(:action => "purchase", :amount => total_pledge, :response => response)
  return response["payKey"]
end 
```

回到 backers_controller.rb，'def purchase' 调用购买：

```
****backers_controller.rb
class BackersController < ApplicationController

  def purchase
    @backer = Backer.find(params[:id])
    @backer.purchase

    redirect_to (GATEWAY.redirect_url_for(@backer.purchase))
  end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T20:44:11.420

事实证明，我的身份验证阻止了贝宝调用我的 ipn 侦听器。

# css - 如何将文本环绕在文本后面的图像周围

> ID：11565380
> 
> 赞同：1
> 
> 时间：2012-07-19T16:36:13.787
> 
> 标签：css

情况就是这样，我会尽量保持清楚：

```
<div id="text">
  text...text...
</div>
<div id="image">
  <a href=""><img></a>
</div> 
```

如何在顶部显示图像并在图像周围环绕文字？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T17:20:16.507

```
<div id="image">
    <a href="#"><img style="float:left" /></a>
    text...text...
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T17:30:08.283

将文本元素包裹在段落标签中是一种很好的做法，尽管块级和内联级元素都会包裹浮动元素：

[http://jsfiddle.net/Wexcode/UsvQd/](http://jsfiddle.net/Wexcode/UsvQd/)

```
<div id="text">
    <div id="image"><a href="#"><img src="#" alt="" /></a></div>
    <p>text...text...</p>
</div> 
```

CSS：

```
#image { float: left; } 
```

# android - 如何使用 tesseract OCR for windows XP for eclipse？

> ID：11565389
> 
> 赞同：-1
> 
> 时间：2012-07-19T16:36:46.417
> 
> 标签：android, cygwin, ocr, android-ndk

我正在尝试使用 tesseract 开发我的第一个 OCR 应用程序。我正在使用 Eclipse 在 Windows XP 下开发并针对 Android 2.1+

1.  我需要cygwin吗？
2.  我需要android ndk吗？

--->通过大量的研究和咨询，我意识到你也不需要cygwin或ndk。但是，Gautams 博客上的代码和程序仍然出错。我尝试构建应用程序并结束，但是当我按下“OCR！”时，应用程序包文件除了强制关闭之外什么都不做。应用程序上的按钮。任何的想法？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T00:14:41.263

1.  不，您不需要 Cygwin。
2.  是的，您需要安装 Android NDK。

[Gautam 的教程](http://gaut.am/making-an-ocr-android-app-using-tesseract/)是在 Android 上使用 Tesseract OCR 的最佳教程。

# css - 将 jpeg 转换为 css 的 url

> ID：11565395
> 
> 赞同：0
> 
> 时间：2012-07-19T16:37:15.230
> 
> 标签：css, url, jpeg

我是网页设计新手，我想我需要将 jpeg 转换为 url。我的计算机上本地保存了一张图像。我用作参考的示例网站有一个页面用于他们的 html/源代码和一个不同的页面用于他们的 css。所有图像都列在 css 页面下，但是，它们是作为 url 输入的。例如 url(..green sea.jpeg) 当我尝试用我的图像替换他们的 css 代码时，找不到它。我知道我是新手，所以我想我一定是犯了一个简单的错误，但是每次我尝试在网上查找时，我都会找到有关如何将 jpeg 转换为 url 的说明，看起来你需要另一种软件可以做到这一点，但我不确定。任何帮助/方向将不胜感激！

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:46:37.980

当您将图像名称替换为您在 CSS 中看到的名称时：

```
url(..green sea.jpeg) 
```

...确保您要使用的图像与绿海图像位于同一位置（文件夹/位置）。

所以如果我想替换它：

```
url(..myNewimage.jpeg) 
```

我会确保它与我要替换它的图像在同一个地方。

另外，我刚刚注意到你的路径是错误的。当它可能应该是“../”时，你有“..”。

所以试试这个：

```
url(../green sea.jpeg) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T17:44:22.973

您的代码所需的 url 就是您在服务器上发布与 css 文件相关的图像的任何位置。例如，如果您的目录结构如下：

```
/CSS
  -style.css
/JS
/images
  -green-sea.jpg
index.html 
```

那么您的网址将是 (../images/green-sea.jpg)

# jquery - 输入类型 = 搜索 - 如何获取“x”但保留我原来的输入布局

> ID：11565396
> 
> 赞同：0
> 
> 时间：2012-07-19T16:37:14.883
> 
> 标签：jquery, html, css

> **可能重复：**
> [从自动样式输入类型 = 搜索中停止 chrome](https://stackoverflow.com/questions/11538192/stop-chrome-from-auto-styling-input-type-search)

我想添加许多搜索输入框用于清除信息的小“X”，但我需要保留自己的输入背景、字体大小等。有什么建议吗？

```
input type"search" 
```

完全改变了布局...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T16:49:57.383

您可以尝试使用带有已移动到其顶部的图像的常规文本框，这样它就不会与背景图像混淆。

HTML

```
<div class="clearable">
  <input type="text"/>
  <img src="http://www.hanebutt.co.uk/uploads/content/close_x.gif" />
</div> 
```

CSS

```
 .clearable img {position: relative; left: -20px;} 
```

jQuery

```
$(document).ready(function() {
  $('.clearable img').click(function() {
    var theInput = $(this).parent().find('input');
    theInput.val("");
    theInput.focus();
  });
}); 
```

你可以在这里看到它的实际效果：http: [//jsbin.com/afafet](http://jsbin.com/afafet)

# java - JAXB 键值问题

> ID：11565400
> 
> 赞同：1
> 
> 时间：2012-07-19T16:37:30.240
> 
> 标签：java, xml, jaxb

所以我想做的是实现这个结构：

```
<root>
   <child>value</child>
   <child>value</child>
   .
   .
</root> 
```

问题是我不知道有多少孩子提前，所以需要一个清单。我已经尝试过了，但我最终得到：

```
<root>
   <child/>
   <child/>
   .
   .
</root> 
```

这是使用 JAXB。

请帮帮我。。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T17:24:40.707

您可以执行以下操作之一：

**选项1**

***根***

```
@XmlRootElement
@XmlAccessorType(XmlAccessType.FIELD)
public class Root {

    List<String> child;

} 
```

**选项 #2**

***根***

```
@XmlRootElement
@XmlAccessorType(XmlAccessType.FIELD)
public class Root {

    List<Child> child;

} 
```

***孩子***

```
@XmlAccessorType(XmlAccessType.FIELD)
public class Child {
    @XmlValue
    String value; 
```

}

**了解更多信息**

*   [http://blog.bdoughan.com/2011/06/jaxb-and-complex-types-with-simple.html](http://blog.bdoughan.com/2011/06/jaxb-and-complex-types-with-simple.html)
*   [http://blog.bdoughan.com/2010/09/jaxb-collection-properties.html](http://blog.bdoughan.com/2010/09/jaxb-collection-properties.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T15:46:23.513

好的，所以我所做的是添加了一个新的注释以及 setter 和 getter 方法，它可以工作，例如：

@XmlValue 受保护的字符串 myval；

```
 public String getMyval(){
                return this.myval;
            }

            public void setMyval(String myval){
                this.myval = myval;
            } 
```

# jersey - 部署了 Jersey 的 Tomcat 7 启动时间慢

> ID：11565401
> 
> 赞同：2
> 
> 时间：2012-07-19T16:37:38.587
> 
> 标签：jersey, tomcat7

使用 Tomcat 7、Jeresy 1.12。

没有 Jersey 的启动 Tomcat 的时间是 4 秒。

当我将 Jersey 的 jars 添加到 tomcat/lib 目录时，启动时间为 50 秒。我使用哪个 servlet 并不重要——即使 web.xml 是空的（没有 servlet），它也需要那个时间。

导致问题的 jar 是 jersey-servlet-1.12。当我从 lib 目录中删除它时，启动时间再次正常。我怀疑该 jar 中定义的服务 (\META-INF\services\*) 导致了问题，但找不到确切的原因......

顺便说一句： metadata-complete="true" 没有解决问题。

**编辑：**泽西队确认了问题（[问题 JERSEY-1317](http://java.net/jira/browse/JERSEY-1317)）。解决此问题的方法是`META-INF/services/javax.servlet.ServletContainerInitializer`从`jersey-servlet.jar`. 这将禁用某些 Servlet3 功能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-04T11:29:36.303

您还可以将 jar 添加到**catalina.properties的****tomcat.util.scan.DefaultJarScanner.jarsToSkip**列表中

 **这样，您可以获取更新版本的 jar，而无需记住您应该编辑它。

见[http://tomcat.10.x6.nabble.com/tomcat-7-0-29-startup-time-td4984446.html](http://tomcat.10.x6.nabble.com/tomcat-7-0-29-startup-time-td4984446.html)**

# c - 将二维数组传递给函数

> ID：11565412
> 
> 赞同：1
> 
> 时间：2012-07-19T16:38:28.767
> 
> 标签：c, arrays, pointers, typedef

我正在尝试在 Workbench 中编译以下简单代码：

```
 1\. typedef float matrixType[3][3]
 2\.     
 3\. void my_func(matrixType matrix)
 4\. {
 5\.     printf("matrix[0][0] = %g\n",matrix[0][0]);
 6\. }
 7\. 
 8\. void main()
 9\. {
10\.     matrixType my_matrix = {{0,1,2},{3,4,5},{6,7,8}};
11\.     matrixType* ptr_matrix = &my_matrix;
12\. 
13\.     my_func(*ptr_matrix);
14\. } 
```

我收到以下警告：

```
test.c:13: warning: passing arg 1 of `my_func' from incompatible pointer type 
```

我不明白，我做错了什么。在 Visual Studio 中编译相同代码时没有任何警告，但在 Workbench 中出现问题。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:47:32.847

您在第 1 行的末尾缺少一个分号。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-20T01:52:32.283

`gcc (GCC) 4.5.3`打开所有警告*后，*在进行以下更改后也可以正常编译：

1.  在第一行之后添加分号。
2.  `#include <stdio.h>`在顶部添加。
3.  将返回类型更改`main`为`int`。
4.  添加`return 0;`为最后一行。

`void main()`即使它出现在各种书籍、手册和网络教程中，它也是不正确的C。在某些架构上，它会导致奇怪的问题，通常是在程序终止时。

获取数组类型的地址是对工作台类型检查器的挑战。我不会拖出 C 标准来确定工作台警告是否正确。这可能是一个错误。

但我很确定，如果您以这种方式重新编码，您将不会看到任何编译器出现错误：

```
#include <stdio.h>

typedef float rowType[3];
typedef rowType matrixType[3];

void my_func(matrixType matrix) 
{ 
   printf("matrix[0][0] = %g\n",matrix[0][0]); 
} 

int main() 
{ 
    matrixType my_matrix = {{0,1,2},{3,4,5},{6,7,8}}; 
    rowType* ptr_matrix = my_matrix; 
    my_func(ptr_matrix);
    return 0; 
} 
```

原因是它`my_matrix`会自动转换为指向它在赋值中的第一个元素的指针

```
rowType* ptr_matrix = my_matrix; 
```

这就像在

```
char s[] = "hello world!"; 
char *p = s; 
```

数组名`s`被转换为指向其第一个元素的指针。

参数 in`void my_func(matrixType matrix)`具有相同的类型，`rowType*`因为所有数组也作为指向第一个元素的指针传递。因此，此代码中的所有类型都必须以 C 标准中非常明确定义的方式匹配。 `&my_matrix`可能不正确，但它是一个“边缘情况”，更有可能暴露类型检查错误。

# c# - 使用 Nhibernate 检查已用密钥的最佳方法？

> ID：11565414
> 
> 赞同：2
> 
> 时间：2012-07-19T16:38:44.577
> 
> 标签：c#, .net, asp.net-mvc, nhibernate

在我的网站上，我允许人们批量购买我网站的订阅（我称它们为优惠券）。一旦他们拥有这些代金券，他们就会将其提供给任何人，然后将代码输入他们的帐户以进行升级。

现在我正在考虑做 4 个字母数字代码（大写，小写和数字）并且会有这样的东西

```
var chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";
var stringChars = new char[4];
var random = new Random();

for (int i = 0; i < stringChars.Length; i++)
{
    stringChars[i] = chars[random.Next(chars.Length)];
}

var finalString = new String(stringChars); 
```

现在我认为这会给我足够多的组合，如果我真的用完了，我总是可以增加代码的长度。我想保持简短，因为我不希望用户输入大量的数字。

我也没有时间制定更优雅的解决方案，也许他们单击电子邮件中的链接或其他内容并激活他们的帐户，当然这会减少试图随机猜测凭证号的人。

如果每个网站都变得更受欢迎，我会处理这些事情。

我想知道如何处理同一凭证的可能重复生成。我的第一个想法是每次创建凭证时检查数据库，如果存在则创建一个新的。

但是，这似乎可能很慢。所以我想也可能首先获取所有密钥并将它们存储在内存中，然后他们会在那里检查，但如果列表不断增长，我可能会遇到内存不足异常和所有这些好东西。

那么有人有什么想法吗？还是我坚持做上面列出的两种方法之一？

我正在使用 nhibernate、asp.net mvc 和 C#。

**编辑**

```
 static void Main(string[] args)
        {
            List<string> hold = new List<string>();
            for (int i = 0; i < 10000; i++)
            {
                HashAlgorithm sha = new SHA1CryptoServiceProvider();
                byte[] result = sha.ComputeHash(BitConverter.GetBytes(i));
                string hex = null;

                foreach (byte x in result)
                {
                    hex += String.Format("{0:x2}", x);
                }

                hold.Add(hex.Substring(0,3));

                Console.WriteLine(hex.Substring(0, 4));
            }

             Console.WriteLine("Number of Distinct values {0}", hold.Distinct().Count());
        } 
```

以上是我尝试使用散列的尝试。但是，我认为我遗漏了一些东西，因为它的重复项似乎比预期的要多。

**编辑 2**

我想我添加了我所缺少的内容，但不确定这是否正是他的意思。我也不确定在我尽可能移动它的情况下该怎么做（我的似乎给了我可以移动它的 40 个位置）。

```
 static void Main(string[] args)
        {
            int subStringLength = 4;
            List<string> hold = new List<string>();
            for (int i = 0; i < 10000; i++)
            {
                SHA1CryptoServiceProvider sha = new SHA1CryptoServiceProvider();
                byte[] result = sha.ComputeHash(BitConverter.GetBytes(i));
                string hex = null;

                foreach (byte x in result)
                {
                    hex += String.Format("{0:x2}", x);
                }

                int startingPositon = 0;
                string possibleVoucherCode = hex.Substring(startingPositon,subStringLength);

                string voucherCode = Move(subStringLength, hold, hex, startingPositon, possibleVoucherCode);
                hold.Add(voucherCode);
            }

             Console.WriteLine("Number of Distinct values {0}", hold.Distinct().Count());
        }

    private static string Move(int subStringLength, List<string> hold, string hex, int startingPositon, string possibleVoucherCode)
    {
        if (hold.Contains(possibleVoucherCode))
        {
            int newPosition = startingPositon + 1;
            if (newPosition <= hex.Length)
            {
                if ((newPosition + subStringLength) > hex.Length)
                {
                    possibleVoucherCode = hex.Substring(newPosition, subStringLength);
                    return Move(subStringLength, hold, hex, newPosition, possibleVoucherCode);
                }
                // return something
                return "0";
            }
            else
            {
                // return something
                return "0";
            }
        }
        else
        {
           return possibleVoucherCode;
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T12:12:59.397

它会很慢，因为您想随机生成凭证，然后检查数据库中每个生成的代码。

我会创建一个`vouchers`带有 id、代码和 is_used 列的表。我会用足够的随机代码填充该表一次。由于这可以在单独的过程中完成，因此性能不会成为大问题。让它在晚上运行，第二天你会得到一个填满的凭证表。

如果您想防止生成重复的凭证，那将不是问题。无论如何，您都可以生成它们并将它们放在 System.Collections.Generic.HashSet 中（这可以防止添加重复项而不引发异常）或调用 Linq 方法 Distinct()，然后再将它们添加到该`vouchers`表中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T18:15:39.917

如果您坚持使用*短*代码：

使用 GUID 作为主键，生成一个随机数。您可能希望如何将其转换为 alpha-num 取决于您。

使用 guid 和随机数的最后一个或两个字节。`1234-684687` 这应该会使暴力破解优惠券*变得*不太容易。并处理任何（罕见的）碰撞异常。

缩短 int 的简单方法，更改它的基数（从 10 到 62）。`"2lkCB1"`（在 VB中，这是旧代码）`Int32.MaxValue`

```
''//given intValue as your random integer
Dim result As String = String.Empty
Dim digits as String = "0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"
Dim x As Integer
While (intValue > 0)
   x = intValue Mod digits.Length
   result = digits(x) & result 
   intValue = intValue - x
   intValue = intValue \ digits.Length
End While
Return result 
```

但现在我们已经回答了不止一个问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-26T01:05:46.657

对于像这样的批量数据操作，我建议不要使用 NHibernate，而直接使用 ADO.NET。

**批量检查**

由于您预计会一次生成大量代码，因此您应该将多个代码检查批处理到一次到数据库的往返中。如果您使用的是 SQL Server 2008 或更高版本，则可以使用表值参数执行此操作，同时检查整个代码列表。

```
SELECT DISTINCT b.Code
FROM @batch b
WHERE NOT EXISTS (
    SELECT v.Code
    FROM dbo.Voucher v
    WHERE v.Code = b.Code
); 
```

**并发**

现在，并发问题呢？如果两个用户大致同时生成相同的代码怎么办？或者只是在我们检查代码的唯一性和将其插入 Voucher 表之间的时间？

我们可以通过如下修改查询来解决这个问题：

```
DECLARE @batchid uniqueidentifier;
SET @batchid = NEWID();

INSERT INTO dbo.Voucher (Code, BatchId)
SELECT DISTINCT b.Code, @batchid
FROM @batch b
WHERE NOT EXISTS (
    SELECT Code
    FROM dbo.Voucher v
    WHERE b.Code = v.Code
);

SELECT Code
FROM dbo.Voucher
WHERE BatchId = @batchid; 
```

**通过 .NET 执行**

假设您已经定义了以下表值用户类型...

```
CREATE TYPE dbo.VoucherCodeList AS TABLE (
    Code nvarchar(8) COLLATE SQL_Latin1_General_CP1_CS_AS NOT NULL
    /* !!! Remember to specify the collation on your Voucher.Code column too, since you want upper and lower-case codes. */
); 
```

...您可以通过 .NET 代码执行此查询，如下所示：

```
public ICollection<string> GenerateCodes(int numberOfCodes)
{
    var result = new List<string>(numberOfCodes);

    while (result.Count < numberOfCodes)
    {
        var batchSize = Math.Min(_batchSize, numberOfCodes - result.Count);
        var batch = Enumerable.Range(0, batchSize)
            .Select(x => GenerateRandomCode());
        var oldResultCount = result.Count;

        result.AddRange(FilterAndSecureBatch(batch));

        var filteredBatchSize = result.Count - oldResultCount;
        var collisionRatio = ((double)batchSize - filteredBatchSize) / batchSize;

        // Automatically increment length of random codes if collisions begin happening too frequently
        if (collisionRatio > _collisionThreshold)
            CodeLength++;
    }

    return result;
}

private IEnumerable<string> FilterAndSecureBatch(IEnumerable<string> batch)
{
    using (var command = _connection.CreateCommand())
    {
        command.CommandText = _sqlQuery; // the concurrency-safe query listed above

        var metaData = new[] { new SqlMetaData("Code", SqlDbType.NVarChar, 8) };
        var param = command.Parameters.Add("@batch", SqlDbType.Structured);
        param.TypeName = "dbo.VoucherCodeList";
        param.Value = batch.Select(x =>
        {
            var record = new SqlDataRecord(metaData);
            record.SetString(0, x);
            return record;
        });

        using (var reader = command.ExecuteReader())
            while (reader.Read())
                yield return reader.GetString(0);
    }
} 
```

**表现**

在实现所有这些之后（并将命令和参数的创建移出循环，以便在批次之间重复使用），我能够以大约 500 的批次大小插入 10,000 个代码。0.5 到 2 秒，或每毫秒 5 到 20 个代码。

**代码密度/碰撞/可猜测性**

该`_collisionThreshold`字段限制了代码的密度。这是一个介于 0 和 1 之间的值。实际上，它*必须*小于 1，否则当 4 位代码用尽时，您将陷入无限循环（可能应该在代码中为此添加断言）。`0.5`出于性能原因，我建议永远不要将其调高。超过 50% 的冲突意味着它花费更多时间测试已使用的代码，而不是实际生成新代码。

保持低碰撞阈值是您控制代码难以猜测的方式。设置`_collisionThreshold`为`0.01`将生成代码，这样有人猜测代码的可能性约为 1%。

如果冲突发生得太频繁，`CodeLength`（该`GenerateRandomCode()`方法使用的）将被递增。这个值需要保存在某个地方。执行后`GenerateCodes()`，检查`CodeLength`是否有变化，然后保存新值。

**源代码**

完整代码可在此处获得：[https](https://gist.github.com/3217856) ://gist.github.com/3217856 。我是这段代码的作者，并在[MIT 许可](http://opensource.org/comment/935)下发布它。我从这个小挑战中获得了乐趣，并且还学习了如何将表值参数传递给内联参数化查询。我以前从来没有这样做过。我只将它们传递给成熟的存储过程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T16:53:58.547

一个可能的解决方案是这样的：
查找凭证的最大 ID（整数）。然后，在其上运行任何散列函数，取前 32 位并转换为要显示给用户的字符串（或使用 32 位散列函数，例如[Jenkins 散列函数](http://en.wikipedia.org/wiki/Jenkins_hash_function)）。这可能会奏效，哈希冲突非常罕见。但是在随机性方面，这个解决方案与您的解决方案非常相似。

您可以运行一个测试，*找出*前 10 个或 100 个碰撞（这对您来说应该足够了）并强制算法“跳过”它们并使用不同的起始值。然后，您根本不需要检查数据库（好吧，至少在您达到大约 4294967296 个凭证之前......）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-19T19:00:32.023

使用 nHibernate 的[HiLo](http://nhforge.org/blogs/nhibernate/archive/2009/03/20/nhibernate-poid-generators-revealed.aspx)算法怎么样？
[这](https://stackoverflow.com/a/3302799/537913)是一个关于如何获得下一个值的示例（没有数据库访问权限）。

# php - 获取推特头像实际链接

> ID：11565416
> 
> 赞同：2
> 
> 时间：2012-07-19T16:38:50.353
> 
> 标签：php, twitter, file-get-contents

我正在尝试获取 Twitter 个人资料图片的实际链接。我知道我可以通过以下链接获取个人资料图片：

```
 $test = "http://api.twitter.com/1/users/profile_image?screen_name=".$nickname."&size=original" 
```

但是当我想获取这个 url 的文件内容时，它不起作用，因为上面提到的链接被重定向到个人资料图片的实际链接。所以这不起作用：

```
 file_get_contents($test); 
```

如何获取个人资料图片的实际链接，然后使用原始尺寸？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T16:46:17.430

试试这个可能对你有帮助。

```
<?php
function getTwitterProfileImage($username) {
      $size = '_bigger';
      $api_call = 'http://twitter.com/users/show/'.$username.'.json';
      $results = json_decode(file_get_contents($api_call));
      return str_replace('_normal', $size, $results->profile_image_url);
}
$img =  getTwitterProfileImage('thetutlage');
echo '<img src="'.$img.'"/>';
 ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-24T05:56:04.567

试试这个是向上+直接的，

```
<img class="img-rounded" src="<?php 
    $size = ''; 
    echo str_replace('_normal', $size,$tweet->user->profile_image_url)
?>" 
height="250px" width="400px" /> 
```

# ruby-on-rails - 输入数据库的列值？

> ID：11565420
> 
> 赞同：1
> 
> 时间：2012-07-19T16:39:05.387
> 
> 标签：ruby-on-rails, ruby

如何在我的表中创建一个作为输入字段的列？

我到处都找不到

我希望该列的价格设置为 nil/empty，无论如何。

然后用户输入一个根据保留价格列验证的价格，如果成功，则将其添加到购物车。

这是我遇到麻烦的第一部分，因为我的购物车已经设置好了

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T16:49:13.843

您需要在数据库中添加一个字符串字段的迁移。查看[Rails 指南](http://guides.rubyonrails.org/migrations.html)以获取有关迁移的信息，但本质上是这样的：

```
add_column :my_table, :my_field, :string 
```

然后它会在从数据库中检索时自动转换为字符串。拥有该字段后，您可以使用表单助手：

```
<%= form_for @my_model do |f| %>
  <%= f.text_field :my_field %>
  <%= f.submit %>
<% end %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T16:45:11.050

您可以像这样使用 text_field：http: [//api.rubyonrails.org/classes/ActionView/Helpers/FormTagHelper.html#method-i-text_field_tag](http://api.rubyonrails.org/classes/ActionView/Helpers/FormTagHelper.html#method-i-text_field_tag)。

# amazon-web-services - 将参数传递给 Elastic MapReduce 流式步骤

> ID：11565421
> 
> 赞同：0
> 
> 时间：2012-07-19T16:39:07.360
> 
> 标签：amazon-web-services, amazon-emr

是否可以将参数传递给 Amazon EMR 中的流式处理步骤？似乎有一个“额外的参数”字段，但参数似乎被传递给流媒体 jar，而不是流媒体脚本本身。

甚至可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-20T19:42:49.510

它应该通过将它们包含在您的 --mapper 参数中来工作，以便将“arg1”和“arg2”传递给位于 s3://bucket/script 位置的映射器应用程序，您将使用该参数：

```
--mapper 's3://bucket/script arg1 arg2' 
```

它还可能取决于您用于启动作业的客户端。以上适用于 ruby[​​ elastic-mapreduce](http://aws.amazon.com/developertools/2264)客户端。当然，您还需要提供其他参数。

# c# - 使用实体框架自引用树的最有效方法

> ID：11565423
> 
> 赞同：45
> 
> 时间：2012-07-19T16:39:12.830
> 
> 标签：c#, asp.net-mvc, entity-framework-4

所以我有一个基本上是

```
ID, ParentID, MenuName, [Lineage, Depth] 
```

最后两列是自动计算的以帮助搜索，所以我们现在可以忽略它们。

我正在创建一个包含多个类别的下拉菜单系统。

不幸的是，我不认为 EF 与超过 1 级深度的自引用表配合得很好。所以我有几个选择

1) 创建查询，按深度排序，然后在 C# 中创建一个自定义类，一次填充一个深度。

2) 想办法在 EF 中急切加载数据，我认为不可能有无限数量的关卡，只有固定数量。

3）其他一些我什至不确定的方式。

欢迎任何意见！

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-07-19T17:05:46.337

我已经使用 EF 成功映射了分层数据。

`Establishment`以实体为例。这可以代表更大的组织结构中的公司、大学或其他一些单位：

```
public class Establishment : Entity
{
    public string Name { get; set; }
    public virtual Establishment Parent { get; set; }
    public virtual ICollection<Establishment> Children { get; set; }
    ...
} 
```

这是父/子属性的映射方式。这样，当您设置 1 个实体的 Parent 时，Parent 实体的 Children 集合会自动更新：

```
// ParentEstablishment 0..1 <---> * ChildEstablishment
HasOptional(d => d.Parent)
    .WithMany(p => p.Children)
    .Map(d => d.MapKey("ParentId"))
    .WillCascadeOnDelete(false); // do not delete children when parent is deleted 
```

请注意，到目前为止，我还没有包含您的 Lineage 或 Depth 属性。您是对的，EF 不适用于生成具有上述关系的嵌套分层查询。我最终决定的是添加一个新的动名词实体，以及 2 个新的实体属性：

```
public class EstablishmentNode : Entity
{
    public int AncestorId { get; set; }
    public virtual Establishment Ancestor { get; set; }

    public int OffspringId { get; set; }
    public virtual Establishment Offspring { get; set; }

    public int Separation { get; set; }
}

public class Establishment : Entity
{
    ...
    public virtual ICollection<EstablishmentNode> Ancestors { get; set; }
    public virtual ICollection<EstablishmentNode> Offspring { get; set; }

} 
```

在写这篇文章时，[hazzik 发布了一个与这种方法非常相似的答案](https://stackoverflow.com/a/11565717/304832)。不过，我会继续写下去，以提供一个稍微不同的选择。我喜欢让我的祖先和后代动名词类型成为实际的实体类型，因为它可以帮助我获得祖先和后代之间的分离（你所说的深度）。这是我如何映射这些：

```
private class EstablishmentNodeOrm : EntityTypeConfiguration<EstablishmentNode>
{
    internal EstablishmentNodeOrm()
    {
        ToTable(typeof(EstablishmentNode).Name);
        HasKey(p => new { p.AncestorId, p.OffspringId });
    }
} 
```

...最后，企业实体中的识别关系：

```
// has many ancestors
HasMany(p => p.Ancestors)
    .WithRequired(d => d.Offspring)
    .HasForeignKey(d => d.OffspringId)
    .WillCascadeOnDelete(false);

// has many offspring
HasMany(p => p.Offspring)
    .WithRequired(d => d.Ancestor)
    .HasForeignKey(d => d.AncestorId)
    .WillCascadeOnDelete(false); 
```

另外，我没有使用 sproc 来更新节点映射。相反，我们有一组内部命令，它们将根据 Parent & Children 属性派生/计算 Ancestors 和 Offspring 属性。但是最终，您最终能够像在 hazzik 的回答中那样进行一些非常相似的查询：

```
// load the entity along with all of its offspring
var establishment = dbContext.Establishments
    .Include(x => x.Offspring.Select(y => e.Offspring))
    .SingleOrDefault(x => x.Id == id); 
```

主要实体与其祖先/后代之间的桥梁实体的原因再次是因为该实体让您获得分离。此外，通过将其声明为标识关系，您可以从集合中删除节点，而无需显式调用 DbContext.Delete()。

```
// load all entities that are more than 3 levels deep
var establishments = dbContext.Establishments
    .Where(x => x.Ancestors.Any(y => y.Separation > 3)); 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-07-19T16:56:49.567

您可以使用支持层次结构表来预先加载无限级别的树。

因此，您需要添加两个集合`Ancestors`，并且`Descendants`两个集合都应该以多对多的方式映射到支持表。

```
public class Tree 
{
    public virtual Tree Parent { get; set; }
    public virtual ICollection<Tree> Children { get; set; }
    public virtual ICollection<Tree> Ancestors { get; set; }
    public virtual ICollection<Tree> Descendants { get; set; }
} 
```

Ancestors 将包含实体的所有祖先（父母、祖父母、祖父母等），`Descendants`并将包含实体的所有后代（孩子、孙子女、孙孙子女等）。

现在你必须先用 EF Code First 映射它：

```
public class TreeConfiguration : EntityTypeConfiguration<Tree>
{
    public TreeConfiguration()
    {
        HasOptional(x => x.Parent)
            .WithMany(x => x.Children)
            .Map(m => m.MapKey("PARENT_ID"));

        HasMany(x => x.Children)
            .WithOptional(x => x.Parent);

        HasMany(x => x.Ancestors)
            .WithMany(x => x.Descendants)
            .Map(m => m.ToTable("Tree_Hierarchy").MapLeftKey("PARENT_ID").MapRightKey("CHILD_ID"));

        HasMany(x => x.Descendants)
            .WithMany(x => x.Ancestors)
            .Map(m => m.ToTable("Tree_Hierarchy").MapLeftKey("CHILD_ID").MapRightKey("PARENT_ID"));
    }    
} 
```

现在有了这个结构，你可以像下面这样急切地获取

```
context.Trees.Include(x => x.Descendants).Where(x => x.Id == id).SingleOrDefault() 
```

此查询将加载实体`id`及其所有后代。

您可以使用以下存储过程填充支持表：

```
CREATE PROCEDURE [dbo].[FillHierarchy] (@table_name nvarchar(MAX), @hierarchy_name nvarchar(MAX))
AS
BEGIN
    DECLARE @sql nvarchar(MAX), @id_column_name nvarchar(MAX)
    SET @id_column_name = '[' + @table_name + '_ID]'
    SET @table_name = '[' + @table_name + ']'
    SET @hierarchy_name = '[' + @hierarchy_name + ']'

    SET @sql = ''
    SET @sql = @sql + 'WITH Hierachy(CHILD_ID, PARENT_ID) AS ( '
    SET @sql = @sql + 'SELECT ' + @id_column_name + ', [PARENT_ID] FROM ' + @table_name + ' e '
    SET @sql = @sql + 'UNION ALL '
    SET @sql = @sql + 'SELECT e.' + @id_column_name + ', e.[PARENT_ID] FROM ' + @table_name + ' e '
    SET @sql = @sql + 'INNER JOIN Hierachy eh ON e.' + @id_column_name + ' = eh.[PARENT_ID]) '
    SET @sql = @sql + 'INSERT INTO ' + @hierarchy_name + ' ([CHILD_ID], [PARENT_ID]) ( '
    SET @sql = @sql + 'SELECT [CHILD_ID], [PARENT_ID] FROM Hierachy WHERE [PARENT_ID] IS NOT NULL '
    SET @sql = @sql + ') '

    EXECUTE (@sql)
END
GO 
```

甚至您可以将支持表映射到视图：

```
CREATE VIEW [Tree_Hierarchy]
AS
    WITH Hierachy (CHILD_ID, PARENT_ID) 
    AS 
    (
        SELECT [MySuperTree_ID], [PARENT_ID] FROM [MySuperTree] AS e
        UNION ALL
        SELECT e.[MySuperTree_ID], e.[PARENT_ID] FROM [MySuperTree] AS e 
            INNER JOIN Hierachy AS eh ON e.[MySuperTree_ID] = eh.[PARENT_ID]
    )

    SELECT [CHILD_ID], [PARENT_ID] FROM Hierachy WHERE [PARENT_ID] IS NOT NULL
GO 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-06-06T13:08:25.950

我已经花了一段时间试图修复您解决方案中的错误。存储过程真的不会产生子、孙等。下面你会发现固定的存储过程：

```
CREATE PROCEDURE dbo.UpdateHierarchy AS
BEGIN
  DECLARE @sql nvarchar(MAX)

  SET @sql = ''
  SET @sql = @sql + 'WITH Hierachy(ChildId, ParentId) AS ( '
  SET @sql = @sql + 'SELECT t.Id, t.ParentId FROM dbo.Tree t '
  SET @sql = @sql + 'UNION ALL '
  SET @sql = @sql + 'SELECT h.ChildId, t.ParentId FROM dbo.Tree t '
  SET @sql = @sql + 'INNER JOIN Hierachy h ON t.Id = h.ParentId) '
  SET @sql = @sql + 'INSERT INTO dbo.TreeHierarchy (ChildId, ParentId) ( '
  SET @sql = @sql + 'SELECT DISTINCT ChildId, ParentId FROM Hierachy WHERE ParentId IS NOT NULL '
  SET @sql = @sql + 'EXCEPT SELECT t.ChildId, t.ParentId FROM dbo.TreeHierarchy t '
  SET @sql = @sql + ') '

  EXECUTE (@sql)
END 
```

错误：错误的参考。翻译@hazzik 代码是：

```
 SET @sql = @sql + 'SELECT t.ChildId, t.ParentId FROM dbo.Tree t ' 
```

但应该是

```
 SET @sql = @sql + 'SELECT h.ChildId, t.ParentId FROM dbo.Tree t ' 
```

我还添加了允许您更新 TreeHierarchy 表的代码，而不仅仅是在您填充它时。

```
 SET @sql = @sql + 'EXCEPT SELECT t.ChildId, t.ParentId FROM dbo.TreeHierarchy t ' 
```

还有魔法。此过程或更确切地说是 TreeHierarchy 允许您仅通过包含祖先（不是子代而不是后代）来加载子代。

```
 using (var context = new YourDbContext())
 {
      rootNode = context.Tree
           .Include(x => x.Ancestors)
           .SingleOrDefault(x => x.Id == id);
 } 
```

现在 YourDbContext 将返回一个 rootNode，其中包含已加载的子节点、rootName 的子节点（孙子节点）的子节点，等等。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-06-09T11:08:51.123

我知道这个解决方案一定有问题。这并不简单。使用此解决方案，EF6 需要另一个 hack 包来管理一个简单的树（fe.删除）。所以最后我找到了一个简单的解决方案，但结合了这种方法。

首先让实体保持简单：只需父级和子级列表就足够了。映射也应该很简单：

```
 HasOptional(x => x.Parent)
    .WithMany(x => x.Children)
    .Map(m => m.MapKey("ParentId"));

 HasMany(x => x.Children)
    .WithOptional(x => x.Parent); 
```

然后添加迁移（代码优先：迁移：包控制台：Add-Migration Hierarchy）或以其他方式添加存储过程：

```
CREATE PROCEDURE [dbo].[Tree_GetChildren] (@Id int) AS
BEGIN
WITH Hierachy(ChildId, ParentId) AS (
    SELECT ts.Id, ts.ParentId 
        FROM med.MedicalTestSteps ts
    UNION ALL 
    SELECT h.ChildId, ts.ParentId 
        FROM med.MedicalTestSteps ts
        INNER JOIN Hierachy h ON ts.Id = h.ParentId
) 
SELECT h.ChildId
    FROM Hierachy h
    WHERE h.ParentId = @Id
END 
```

然后，当您尝试从数据库接收树节点时，只需分两步进行：

```
//Get children IDs
var sql = $"EXEC Tree_GetChildren {rootNodeId}";
var children = context.Database.SqlQuery<int>(sql).ToList<int>();

//Get root node and all it's children
var rootNode = _context.TreeNodes
                    .Include(s => s.Children)
                    .Where(s => s.Id == id || children.Any(c => s.Id == c))
                    .ToList() //MUST - get all children from database then get root
                    .FirstOrDefault(s => s.Id == id); 
```

这一切。此查询可帮助您获取根节点并加载所有子节点。不玩介绍祖先和后代。

还请记住，当您尝试保存子节点时，请这样做：

```
var node = new Node { ParentId = rootNode }; //Or null, if you want node become a root
context.TreeNodess.Add(node);
context.SaveChanges(); 
```

这样做，而不是通过将子节点添加到根节点。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-10-31T19:34:52.370

我最近研究的另一个实现选项......

我的树很简单。

```
public class Node
{
    public int NodeID { get; set; }
    public string Name { get; set; }
    public virtual Node ParentNode { get; set; }
    public int? ParentNodeID { get; set; }
    public virtual ICollection<Node> ChildNodes { get; set; }
    public int? LeafID { get; set; }
    public virtual Leaf Leaf { get; set; }
}
public class Leaf
{
    public int LeafID { get; set; }
    public string Name { get; set; }
    public virtual ICollection<Node> Nodes { get; set; }
} 
```

我的要求，没有那么多。

> 给定一组叶子和一个祖先，显示该祖先的子孙，其后代在该集合内具有叶子

一个类比是磁盘上的文件结构。当前用户有权访问系统上的文件子集。当用户打开文件系统树中的节点时，我们只想显示最终将引导他们到他们可以看到的文件的用户节点。我们不想向他们显示他们无权访问的文件的文件路径（出于安全原因，例如，泄露某种类型的文档的存在）。

我们希望能够将此过滤器表示为`IQueryable<T>`，因此我们可以将其应用于任何节点查询，过滤掉不需要的结果。

为此，我创建了一个表值函数，它返回树中节点的后代。它通过 CTE 完成此操作。

```
CREATE FUNCTION [dbo].[DescendantsOf]
(   
    @parentId int
)
RETURNS TABLE 
AS
RETURN 
(
    WITH descendants (NodeID, ParentNodeID, LeafID) AS(
        SELECT NodeID, ParentNodeID, LeafID from Nodes where ParentNodeID = @parentId
        UNION ALL
        SELECT n.NodeID, n.ParentNodeID, n.LeafID from Nodes n inner join descendants d on n.ParentNodeID = d.NodeID
    ) SELECT * from descendants
) 
```

现在，我使用的是 Code First，所以我不得不使用

[https://www.nuget.org/packages/EntityFramework.Functions](https://www.nuget.org/packages/EntityFramework.Functions)

为了将函数添加到我的 DbContext

```
[TableValuedFunction("DescendantsOf", "Database", Schema = "dbo")]
public IQueryable<NodeDescendant> DescendantsOf(int parentID)
{
    var param = new ObjectParameter("parentId", parentID);
    return this.ObjectContext().CreateQuery<NodeDescendant>("[DescendantsOf](@parentId)", param);
} 
```

具有复杂的返回类型（无法重用 Node，正在调查）

```
[ComplexType]
public class NodeDescendant
{
    public int NodeID { get; set; }
    public int LeafID { get; set; }
} 
```

当用户在树中展开一个节点时，将它们放在一起允许我获得过滤后的子节点列表。

```
public static Node[] GetVisibleDescendants(int parentId)
{
    using (var db = new Models.Database())
    {
        int[] visibleLeaves = SuperSecretResourceManager.GetLeavesForCurrentUserLol();

        var targetQuery = db.Nodes as IQueryable<Node>;

        targetQuery = targetQuery.Where(node =>
                node.ParentNodeID == parentId &&
                db.DescendantsOf(node.NodeID).Any(x => 
                                visibleLeaves.Any(y => x.LeafID == y)));

        // Notice, still an IQueryable.  Perform whatever processing is required.
        SortByCurrentUsersSavedSettings(targetQuery);

        return targetQuery.ToArray();
    }
} 
```

重要的是要注意*该函数是在服务器上执行的，而不是在应用程序中执行的*。这是执行的查询

```
SELECT 
    [Extent1].[NodeID] AS [NodeID], 
    [Extent1].[Name] AS [Name], 
    [Extent1].[ParentNodeID] AS [ParentNodeID], 
    [Extent1].[LeafID] AS [LeafID]
    FROM [dbo].[Nodes] AS [Extent1]
    WHERE ([Extent1].[ParentNodeID] = @p__linq__0) AND ( EXISTS (SELECT 
        1 AS [C1]
        FROM ( SELECT 
            [Extent2].[LeafID] AS [LeafID]
            FROM [dbo].[DescendantsOf]([Extent1].[NodeID]) AS [Extent2]
        )  AS [Project1]
        WHERE  EXISTS (SELECT 
            1 AS [C1]
            FROM  ( SELECT 1 AS X ) AS [SingleRowTable1]
            WHERE [Project1].[LeafID] = 17
        )
    )) 
```

注意上面查询中的函数调用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-09-23T13:30:18.887

@danludwig 感谢您的回答

我为更新节点编写了一些函数，它工作得非常完美。我的代码很好还是应该以其他方式编写？

```
 public void Handle(ParentChanged e)
    {
        var categoryGuid = e.CategoryId.Id;
        var category = _context.Categories
            .Include(cat => cat.ParentCategory)
            .First(cat => cat.Id == categoryGuid);

        if (null != e.OldParentCategoryId)
        {
            var oldParentCategoryGuid = e.OldParentCategoryId.Id;
            if (category.ParentCategory.Id == oldParentCategoryGuid)
            {
                throw new Exception("Old Parent Category mismatch.");
            }
        }

        (_context as DbContext).Configuration.LazyLoadingEnabled = true;

        RemoveFromAncestors(category, category.ParentCategory);

        var newParentCategoryGuid = e.NewParentCategoryId.Id;
        var parentCategory = _context.Categories
            .First(cat => cat.Id == newParentCategoryGuid);

        category.ParentCategory = parentCategory;

        AddToAncestors(category, category.ParentCategory, 1);

        _context.Commit();
    }

    private static void RemoveFromAncestors(Model.Category.Category mainCategory, Model.Category.Category ancestorCategory)
    {
        if (null == ancestorCategory)
        {
            return;
        }

        while (true)
        {
            var offspring = ancestorCategory.Offspring;
            offspring?.RemoveAll(node => node.OffspringId == mainCategory.Id);

            if (null != ancestorCategory.ParentCategory)
            {
                ancestorCategory = ancestorCategory.ParentCategory;
                continue;
            }
            break;
        }
    }

    private static int AddToAncestors(Model.Category.Category mainCategory,
        Model.Category.Category ancestorCategory, int deep)
    {
        var offspring = ancestorCategory.Offspring ?? new List<CategoryNode>();
        if (null == ancestorCategory.Ancestors)
        {
            ancestorCategory.Ancestors = new List<CategoryNode>();
        }

        var node = new CategoryNode()
        {
            Ancestor = ancestorCategory,
            Offspring = mainCategory
        };

        offspring.Add(node);

        if (null != ancestorCategory.ParentCategory)
        {
            deep = AddToAncestors(mainCategory, ancestorCategory.ParentCategory, deep + 1);
        }

        node.Separation = deep;

        return deep;
    } 
```

# javascript - 在javascript中选择特定表格元素的最聪明的方法是什么？

> ID：11565424
> 
> 赞同：1
> 
> 时间：2012-07-19T16:39:13.547
> 
> 标签：javascript, jquery, html

我有一张桌子，上面有隐藏的行，就像这样

```
 -visible-
 -invisible-
 -visible-
 -invisible- 
```

当我单击表格行时，我希望它显示不可见的行。目前我有使用这个功能：

```
var grid = $('#BillabilityResults');
$(".tbl tr:has(td)").click(
         function () {
             $(grid.rows[$(this).index()+1]).toggle();
         } 
```

但是，如果我单击其中一个（现在可见的）隐藏行，该表也会隐藏可见行。我希望点击功能仅适用于特定的可见行。目前我所有的不可见行都有“偶数”类，所以我想我可以基于它来限制点击。但是，我似乎找不到向我的函数解释这一点的语法。我该怎么做呢？而且，更重要的是，有没有更好的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T16:50:06.870

接下来使用：

```
$(".tbl tr:has(td)").click(
  function () {
    $(this).next().toggle();
  } 
); 
```

而且，如果您有奇数或偶数的特定选择器：

```
$(".tbl tr.odd").click(
  function () {
    $(this).next().toggle();
  } 
); 
```

但我认为对我的回答的主要帮助是使用 next() 让你进入下一行，而不是你正在做的索引过程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T16:50:56.370

```
var grid = $('#BillabilityResults');
$(".tbl tr:visible").click(
         function () {
             $(this).next('tr').toggle();
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T16:56:55.370

使用 NOT 函数忽略 EVEN tr 元素：

[http://jsfiddle.net/7AHmh/](http://jsfiddle.net/7AHmh/)

```
<table class="tbl">
<tr><td>one</td></tr>
<tr class="even" style="display:none"><td>two</td></tr>
<tr><td>three</td></tr>
<tr class="even" style="display:none"><td>four</td></tr>
</table>​

$(".tbl tr:has(td)").not("tr.even").click(function() {

    alert("Click triggered.");

    $(this).next("tr").show(); 

}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-19T17:06:38.613

我想您可以在调用切换代码之前使用模运算符检查偶数/奇数行：

```
function() { // your anonymous function
    if (rowNumber % 2 == 0) { // only even rows get through here
        // toggle code here
    }
} 
```

我希望它有所帮助。

# python - 如何检查字典中的类对象值？

> ID：11565428
> 
> 赞同：-2
> 
> 时间：2012-07-19T16:39:21.617
> 
> 标签：python, class, object, dictionary, key

我有一本字典，名为

```
descendDict 
```

它包含 4 个作为类对象的键，它们的值既是字母又是其他类对象。

现在我要做的是对字典进行排序，如果字典中出现的值是类对象或者是字母，则调用不同的操作：

```
for x in descendDict:
    print x, descendDict[x]
        for y in descendDict[x][0]:
            if y != (classObject?):
                #Action
            for x in descendDict:
                for z in descendDict[x][0]:
                    if z != (classObject?):
                        if y == z:
                            dist = 0
                        else:
                            dist = float(nodeDict[y]) + float(nodeDict[z]) 
```

在 if 语句中：

```
if... != (classObject?): 
```

我试图确定字典中的变量是否是类对象，但我只是不知道该怎么做。

这是条目之一：

```
<__main__.Node instance at 0xb6738> ([<__main__.Node instance at 0xb6710>, 'A', <__main__.Node instance at 0xb6760>], '0.1') 
```

我正在对它的第一个键列表进行排序，但我试图弄清楚列表中的值是类对象还是字母。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:43:57.293

不确定您所说的“类对象”是什么意思，因为 Python 中的所有内容都是一等对象。如果您想弄清楚它是否是特定类的实例，您可以使用`isinstance`

```
if isinstance(y, someClass):
    # do stuff 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T16:44:04.717

最好在你的类中定义一个方法然后说

```
if hasattr(d[x],myClassMethodName):#then do this
else:#not a member 
```

这种检查方法允许更大的灵活性

对于@RussellBorogove

```
 try:
    d[x].myMethod(*args,**kwargs)
 except:
    print "This is not an instance of my class and maybe a letter" 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-19T16:51:44.587

你可能想要`isinstance(x,type)`：

```
x = str
isinstance(x, type)
#=> True     

class x(object):pass    
isinstance(x, type)    
#=> True

class x:pass    
isinstance(x, type)
#=> False

x = "foo"
isinstance(x, type)
#=> False 
```

显然，你必须坚持新式的课程，但无论如何你都应该这样做。

但是，听起来您好像在尝试创建自己的对象调度系统。我强烈建议您将所有对象移至某种通用基类，并使用方法分派与高阶方法相结合来实现您想要做的任何事情。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-19T17:56:36.910

在 Python 中，通常使用“请求宽恕比许可更容易”（EAFP）模型，它看起来像：

```
for y in collection:
    try:
        # treat it like it's a Node
        y.actionMethod()
    except AttributeError:
        # that method doesn't exist, so it's not a Node
        # do something else with it
        print y 
```

这比 using 更可取`isinstance()`，因为它允许您定义几个原本不相关的类，每个类都有自己的`actionMethod()`，而无需更改此调度代码。

# resources - Jenkins - 管理资源池

> ID：11565434
> 
> 赞同：6
> 
> 时间：2012-07-19T16:40:01.353
> 
> 标签：resources, jenkins, nodes, pool

我正在尝试建立一个 Jenkins 系统，其中某个程序必须在网络上的板上运行，使用 telnet 访问。我们在这里讨论了数百个这样的工作，因此我们将设置多个委员会。因此，每个作业都必须分配一个板，但问题是只有一个作业可以同时拥有某个板，否则程序会失败。

我现在拥有的解决方案是使用主从设置，我使用 SSH 连接到同一台机器（因此同一台机器上有一个主控和多个从属）。然后，每个从节点都有一个程序必须远程登录到的 IP 地址的标签。这可行，调度明智，但它可能会导致问题，因为所有节点都使用 SSH 连接到同一台机器。使用 SSH 连接到电路板不是一种选择。

有没有办法获得与上述相同的功能，但不使用 SSH 连接到同一台机器？所以基本上我想说：我们有 n 台可用的机器，当有工作进入时，给它其中一台机器并传递一个属于该机器的标签（在这种情况下是它的 IP 地址）；现在还剩下 n-1 台机器。互斥接近，但不允许上述功能，等待资源的作业占用节点的执行者之一。

非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-08-14T11:49:28.317

我意识到你的问题可能在几年前就已经解决了，但万一其他人正在寻找答案并遇到这个问题。

您可以使用“可锁定资源”插件，将IP地址设置为资源名称，并使用标签，如使用test-board-ip。简单易用。

另一种可能性是使用“外部资源调度程序”插件。它提供了更多的可能性，但它有一个错误导致它有时会挂起。而且似乎不再需要维护（2013 年的最新更新）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T20:27:54.340

也许你应该看看 Lock and Latches Plugin。您可以使用此插件锁定资源，只需要锁定您想要的板。

[https://wiki.jenkins-ci.org/display/JENKINS/Locks+and+Latches+plugin](https://wiki.jenkins-ci.org/display/JENKINS/Locks+and+Latches+plugin)

# java - 如何在不使用 IDE 或命令提示符的情况下运行 Java 应用程序

> ID：11565437
> 
> 赞同：1
> 
> 时间：2012-07-19T16:40:06.417
> 
> 标签：java, cmd

这比问题更令人好奇：

我最近想知道是否有一种方法可以在不使用 cmd 或 Eclipse 之类的 IDE 的情况下运行已编译的 Java 应用程序。我使用 Eclipse，但如果你想独立运行程序，它不是很有用。您可以在 Windows 资源管理器中保存 Java 文件以便为它们创建快捷方式吗？如果是这样，怎么做？该文件是否有某种特殊的扩展名？我听说过 .JAR 文件，但我不确定它们是什么。谁能告诉我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:46:52.677

.JAR 文件是包含 - 除其他外 - 您的已编译类和清单文件的档案。您可以在该清单中设置应用程序的主入口点。请参阅[设置应用程序的入口点](http://docs.oracle.com/javase/tutorial/deployment/jar/appman.html)。

通常，如果您在 windows 中双击一个 jar 文件，它将由`javaw.exe -jar <yourFile.jar>`. javaw.exe 将查找清单并尝试启动其中定义的主类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T18:26:20.330

使用以下语法 jar -cvf .jar 为 java 应用程序创建 jar 文件*。* 然后使用 javaw.exe -jar

# process - Java执行器服务如何一次返回总成功和总失败记录

> ID：11565443
> 
> 赞同：0
> 
> 时间：2012-07-19T16:40:37.873
> 
> 标签：process, batch-file, executorservice

我正在使用 executorserive 在数据库中插入记录。假设通过创建 5 个批次来保存 100 条记录，每个批次包含 20 条记录。

```
ExecutorService e = Executors.newFixedThreadPool(3);
Collection c= new ArrayList();
 while (someloop)
 {
    c.add(mySaveMehtod());
 }
List<Future<String>> list = e.invokeAll(c);
Iterator<Future<String>> i= list.iterator();
Future<String> f=null;
 while(i.hasNext())
 {
  f= itr.next();       
 }
 Strin str = f.get(); 
```

在处理过程中，某些记录可能会出现错误，并且某些记录会成功处理。

一旦过程完成，我想立即收集成功处理的总数和失败的记录总数。

任何人都可以让我知道如何实现这一目标吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T22:39:22.623

假设您`INSERT`在执行 SQL 后立即知道一条记录是否成功，您可以简单地使用两个`AtomicInteger`s。在运行批量插入作业之前声明它们并设置为`0`，并在这些作业中增加它们。s上的操作`AtomicInteger`是线程安全的，所以不用担心同步。例如：

```
public static void main() {
    AtomicInteger nSuccess = new AtomicInteger(0);
    AtomicInteger nFailed = new AtomicInteger(0);
    // add batch insert jobs
    // wait for jobs to finish
    System.out.println("succeeded: " + nSuccess.get() + " failed: " + nFailed.get());
}

class BatchInserter implements Runnable {
    public void run() {
        for (int i = 0; i < 20; i++) {
            if (insertRecord(i)) {
                nSuccess.getAndIncrement();
            } else {
                nFailed.getAndIncrement();
            }
        }
    }
} 
```

# windows-7 - 将 Windows 7 主机文件夹挂载到 VirtualBox 来宾 Ubuntu 12.04 目录中

> ID：11565446
> 
> 赞同：16
> 
> 时间：2012-07-19T16:40:42.223
> 
> 标签：windows-7, virtualbox, ubuntu-12.04

我知道这不是严格意义上的编程问题，但我需要挂载共享文件夹才能继续编码。

我在 VirtualBox 中有一个带有来宾 Ubuntu 12.04 操作系统的 Windows 7 操作系统。

我一直在尝试挂载在 VirtualBox 中创建的共享文件夹。虚拟文件夹基本上是`C:\`Windows 7 上的文件系统。在 VirtualBox 中，共享文件夹显示为：

文件夹路径：`C:\`

文件夹名称：Windows7

```
# sudo mount -t vboxsf Windows7 /windows7 
```

但是“mount”命令无法识别 VirtualBox 共享文件夹文件系统类型。我得到的错误是：

```
mount: unknown filesystem type 'vboxsf' 
```

相反，如果我从 DOS 提示符尝试它，我也会在长时间的停顿后得到一个错误：

```
> net use x: \\vboxsvr\Windows7 
```

（在我的语言环境中的错误基本上是：） `it is impossible to find the network path`。

所以我该怎么做。在过去的 Ubuntu 和 VirtualBox 的早期版本中，我已经能够通过安装称为“guest added”的东西来执行此操作。

有人可以说明如何解决这个问题吗？

* * *

好的，因为没有人回答我的帖子，我已经做了一些研究以及让它工作的方法（以便识别 -t 的“虚拟盒共享文件夹”类型，是安装动态内核模块支持，重新启动 Linux，然后通过提供的软件包安装来宾添加，如下所示：

```
sudo apt-get install dkms
sudo /sbin/reboot
sudo apt-get install virtualbox-ose-guest-x11
sudo mount -t vboxsf Windows7 /windows7 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-21T21:48:41.487

确保 VBoxLinuxAdditions.run 完成且没有错误。安装后重新启动您的虚拟机，以便内核加载 virtualbox 的模块。

通常，您应该能够挂载该文件夹。

见这里 [http://www.giannisakiris.com/index.php/2008/04/09/virtualbox-access-windows-host-shared-folders-from-ubuntu-guest/](http://www.giannistsakiris.com/index.php/2008/04/09/virtualbox-access-windows-host-shared-folders-from-ubuntu-guest/)

# windows - DpInst 无法安装过滤器驱动程序：无法获取与驱动程序包关联的服务

> ID：11565447
> 
> 赞同：0
> 
> 时间：2012-07-19T16:40:52.190
> 
> 标签：windows, driver, dpinst

使用 DpInst 通过 .INF 文件安装过滤器驱动程序时，它会报告以下错误：

> 错误：无法获取与驱动程序包关联的服务。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T16:42:01.907

INF 部分应命名为`[DefaultInstall.NT]`and `[DefaultInstall.NT.Services]`。

# java - 如何将 Android 自定义视图注册为观察者

> ID：11565451
> 
> 赞同：1
> 
> 时间：2012-07-19T16:40:58.667
> 
> 标签：java, android, observer-pattern, android-sensors

我有一个实现 SensorEventListener 的类*OrientationSensor*，我已将其设为**Observable**。

我有一个自定义控件*OrientationPointer*扩展 ImageView 并实现需要响应来自*OrientationSensor的更新的***Observer**。*OrientationPointer*的实例是通过 XML 布局创建的。

 **我不希望*OrientationPointer*实现 SensorEventListener，因为在同一个 Activity 中会有多个实例。

在纯 Java 中，我只需将 Observable 参数添加到*OrientationPointer*构造函数。

在 Android 中，看起来我必须用代码而不是 XML 来实例化*OrientationPointer*，这样我才能调用自定义构造函数，或者在 onFinishInflate() 期间以某种方式获取*OrientationSensor 。*

这两个选项看起来是否合理，或者是否有更好的方法来实现这一点，同时保持 SensorListener 和 View 的分离？**

# linux - 管道查找结果到 grep 以快速排除目录

> ID：11565454
> 
> 赞同：10
> 
> 时间：2012-07-19T16:41:15.607
> 
> 标签：linux, recursion, find, grep, piping

我成功地使用 find 创建了当前子目录中所有文件的列表，不包括子目录“缓存”中的文件。这是我的第一段代码：

```
find . -wholename './cach*' -prune -o -print 
```

我现在希望将其通过管道传输到 grep 命令中。看起来应该很简单：

```
find . -wholename './cach*' -prune -o -print | xargs grep -r -R -i "samson" 
```

...但这是返回的结果主要来自缓存目录。我已经尝试删除 xargs 引用，但这符合您的期望，在文件名的文本上运行 grep，而不是在文件本身上运行。我的目标是在任何没有缓存内容的文件中找到“samson”。

在这种情况下，我可能会通过使用 double greps 来解决这个问题，但我很好奇为什么这个单行代码会以这种方式运行。我很想听听关于在仍然使用这两个命令的同时修改它的方法的想法（因为这样做有速度优势）。

（这是在 CentOS 5 中，顺便说一句。）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-19T16:52:03.903

`wholename`匹配可能是它仍然包含“缓存”文件的原因。如果您在`find`包含“缓存”文件夹的目录中执行命令，它应该可以工作。如果没有，请尝试将其更改为`-name '*cache*'`。

此外，您不需要`-r`or ，它告诉它通过目录递归 - 但您正在测试单个文件。`-R``grep`

您可以使用管道版本或单个命令更新命令：

```
find . -name '*cache*' -prune -o -print0 | xargs -0 grep -il "samson" 
```

或者

```
find . -name '*cache*' -prune -o -exec grep -iq "samson" {} \; -print 
```

请注意，`-l`第一个命令`grep`中的“列出文件”而不是匹配的行。第二`-q`个做同样的事情；它告诉`grep`安静地响应，`find`然后只打印文件名。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-19T16:44:32.547

使用`-exec`find 上的选项，而不是将它们传送到另一个命令。从那里您可以使用`grep "samson" {} \;`在列出的每个文件中查找 samson。

例如：

```
find . -wholename './cach*' -prune -o -exec grep "samson" "{}" + 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-19T17:01:13.683

您已经告诉`grep`自己递归（两次！`-r`并且`-R`是同义词）。由于您传递的参数之一是`.`（顶级目录），`grep`因此正在搜索每个文件（其中一些文件两次，或者如果它们在子目录中则更多）。

如果您要使用`find`and `grep`，请执行以下操作：

```
find . -path './cach*' -prune -o -print0 | xargs -0 grep -i "samson" 
```

即使使用包含空格或标点字符的文件名，也可以使用`-print0`并让您的脚本工作。`-0`

但是，您可能不需要在`find`这里打扰，因为 GNU grep 能够排除目录：

```
grep -R --exclude-dir='cach*' -i "samson" . 
```

（这也排除`./deeply/nested/directory/cache`了 。如果您只想排除顶级缓存目录，请照常使用`find`。）

# mysql - 在 grails 中保存 2 个类的值

> ID：11565457
> 
> 赞同：0
> 
> 时间：2012-07-19T16:41:25.937
> 
> 标签：mysql, grails, groovy

我有 2 个名为 User.groovy 和 Employee.groovy 的类，我使用 MYSQL 来保存数据。我想要的是创建一个新的用户帐户并将其保存到用户表中，并将一些数据保存到员工表中。我怎样才能做到这一点？我尝试将用户扩展到员工，但数据只保存到用户而不是员工。但是如果我不扩展用户，数据只会保存到员工。我应该怎么做才能使数据同时保存到两个数据库表中？请帮我。

实际上在我的班级用户中有这个：

```
class User {

transient springSecurityService

String username
String password
boolean enabled
boolean accountExpired
boolean accountLocked
boolean passwordExpired
.....} 
```

和员工：

```
class Employee {

String name
String email
String jobDesc
....} 
```

那么接下来我该怎么做呢？对此我很抱歉，我仍然开始学习grails。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-21T04:32:05.447

Grails 范式（就脚手架而言）是一种形式 - 一个对象。只要你坚持这个范式，你就会得到所有的好处，比如免费的输入验证和错误报告（你也可以考虑在[http://grails.org/plugin/fields](http://grails.org/plugin/fields)使用 Fields 插件）。

但是，有时您需要通过单一表单收集信息并创建两个或多个对象。通常，当您需要启动新订阅并收集订阅详细信息（例如，订阅实体）和用户信息（用户实体）的信息时，就会发生这种情况。这是命令对象来救援的地方。

[http://grails.org/doc/latest/guide/theWebLayer.html#commandObjects](http://grails.org/doc/latest/guide/theWebLayer.html#commandObjects)

因此，您无需扩展/弯曲 SubscriptionController 或 UserController（或 UserController 和 EmployeeController，根据您的示例），而是创建处理 SignUpCommand 对象的 SignUpController。SignUpCommand 对象不打算保存，它用作 SignUpController.create 表单的支持对象。当它验证时，您使用 signUpCommand 对象数据来初始化 2 个域对象（即订阅和用户）并将这些对象*分别保存在同一个事务*中。

您可以将保存操作委托给服务，例如，

```
if (signUpCmd.validate()) {
    SignUpService.save(signUpCmd))
} 
```

或直接在控制器内创建并保存两个对象

```
if (signUpCmd.validate()) {
    Subscription subscription = new Subscription(plan: signUpCmd.plan, ...)
    subscription.save()
    User user = new User(username: signUpCmd.username, ...)
    user.save()
} 
```

这主要是品味和风格的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T17:23:06.167

不要直接调用 save() 到您的用户实例，而是调用一个服务类，将用户和员工保存在一个原子操作中。比如说：

```
class UserController {

/*Injection of your service in the controller class*/
def userService 
```

然后在同一个控制器的**保存操作中：**

```
userService.save(user) // userService.save(params) 
```

在此服务方法中，您将提取要保存在不同表中的数据（用户或参数，无论您的船是什么），只要是通常的用户对象。

# apache - 在 WebFlow 中强制 https

> ID：11565462
> 
> 赞同：3
> 
> 时间：2012-07-19T16:41:51.860
> 
> 标签：apache, grails, https, tomcat7, spring-webflow

我在 Tomcat7 上部署了一个 grails 应用程序，并由 Apache2 公开。grails 应用程序以标准方式在服务器的 8080 上响应，但在 Apache2 上它通过 https:// 提供给用户

除了 WebFlow 控制器外，一切正常。当 webflow 重定向用户时，它将 https:// 更改为 http:// 我如何强制 WebFlow 使用 https:// ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T21:07:05.457

您是否已将 Tomcat 配置为意识到它位于 https 反向代理之后的事实？您应该在 server.xml中的元素上设置`scheme="https"`和。`secure="true"``Connector`

还要确保您的`grails.serverURL`in`Config.groovy`是从客户的角度来看的完整 https URL。

# deployment - 通过远程桌面对 Windows Azure Web 角色的更改未传播

> ID：11565464
> 
> 赞同：1
> 
> 时间：2012-07-19T16:41:57.697
> 
> 标签：deployment, azure, azure-web-roles

我在 Windows Azure 上部署了一个 Web 角色。它仅在一个实例上运行。我设置了远程桌面来访问它。

目前，我只需要在网站的 JavaScript 文件中更改两行。

然后我连接到实例...

1.  导航到**E:\approot\Scripts**
2.  打开目标文件，编辑它

更改没有传播。（我下载旧内容）

然后我试着

1.  在 Web 角色中停止 IIS
2.  编辑文件
3.  再次启动 IIS

更改没有传播（当我在 RD 中打开文件时，我看到了我的新内容，但是当通过 http 打开时，我看到了旧内容）

然后我尝试了

1.  开放式研发
2.  导航到文件并对其进行编辑
3.  通过 Windows Azure 控制面板重启实例
4.  再次连接到 RD

我仍然在远程服务器中看到旧内容

我的问题是我应该怎么做才能只更改一个文件而不重新部署整个包？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T19:42:12.067

我的猜测是您正在编辑错误的位置。看看`e:\sitesroot\0`（或类似的东西）。如有疑问，请打开 IIS 配置 UI 并找出网站内容的确切位置。

编辑：但正如丹尼斯指出的那样，您以这种方式所做的更改不会持续存在，因此仅将其用于测试。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T17:09:52.890

我以前做过这项工作，但是这种类型的更改存在问题。如果您正在运行的硬件发生了问题并且您的实例需要“修复”，它只会从您上传的包中创建。Azure 不知道您通过 RD 进行的文件编辑。

目前还没有办法在云服务的一侧进行单个文件更改，但使用新的 Azure 网站功能，它只是一个 git push 或 tfs push 即可。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T20:36:24.973

您应该能够通过右键单击您的网站项目（而不是 azure 角色项目）来进行 Web 部署。这只会将已更改的文件部署到活动实例。我相信您的天蓝色部署配置文件（远程桌面旁边）中有一个设置可以启用此功能。

如其他答案中所述，如果天蓝色需要重新创建或提供其他实例，这些更改将丢失。尽管如此，它仍然是为开发进行增量更改的好方法。

# c# - 如何确定 SQLite UpdateException 上的正确约束违规？

> ID：11565468
> 
> 赞同：7
> 
> 时间：2012-07-19T16:42:33.407
> 
> 标签：c#, database, sqlite, try-catch, updateexception

我的本地 SQLite 数据库遇到以下问题。我正在尝试使用在线 SQL-Server 数据库更新通过同步过程存储的数据。虽然同步没有问题，但我在尝试更新本地值时经常会遇到错误。例如，每个表上可能存在与现有主键约束的冲突。另一方面，也可能违反了具体表上的唯一键。

我的问题是如何确定发生了哪种类型的错误。

我赶上数据库更新或插入

```
catch(UpdateException ue)
{
    HandleUpdateException(ue);
} 
```

处理方法如下：

```
private void HandleUpdateException(UpdateException e)
{
    // get inner exception as SQLiteException
    var innerException = e.InnerException as SQLiteException;

    if(innerException != null)
    {
        switch(innerException.ErrorCode)
        {
            case SQLiteError.Constraint:
                // handle constraint-error here
                break;
            default:
                // log error
                break;
        }
    }
} 
```

我现在怎么知道发生了哪个错误？重要的是要知道，因为对违反 PK 的处理完全不同于违反英国。

我可以试着做

```
if(e.Message.Contains("unique")) // ... 
```

或者

```
if(e.Message.Contains("foreign")) // ... 
```

但我不喜欢用“魔术”字符串检查这种错误。

所以任何帮助将不胜感激。

# c# - LINQ 查询重用和延迟执行

> ID：11565469
> 
> 赞同：1
> 
> 时间：2012-07-19T16:42:47.680
> 
> 标签：c#, linq, linq-to-objects

我的印象是我可以创建一个 LINQ 查询，然后在更改所涉及的参数时重用它。但似乎您无法更改源集合。有人可以给我一个很好的解释为什么，因为我显然误解了一些基本的东西。

这是一些示例代码。

```
var source = Enumerable.Range(1, 10);
var value = source.Where(x => x > 5);
var first = value.ToArray();

source = Enumerable.Range(11, 20);
var second = value.ToArray(); 
```

我期待第一个是 6,7,8,9,10，第二个是 11 到 20。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-19T16:45:47.133

当你这样做时：

```
source = Enumerable.Range(11, 20); 
```

您正在创建一个新对象。但是，`Where`查询仍然具有对旧对象的引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T16:52:04.373

```
source = Enumerable.Range(11, 20);
    var second = value.ToArray();

second = Enumerable.Range(11, 20);
    var second = value.ToArray(); 
```

找到不同;)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T16:52:51.637

因为`value = source.Where(x => x > 5)`急切地评估 的值`source`，而推迟对`x => x > 5`部分的评估。当您重新分配源时，原始范围仍然存在，源只是指向不同的范围。简而言之，lambda 中的值是惰性求值的。

**延迟执行示例**

```
 source = Enumerable.Range(1,10).ToArray();
 value = source.Where(x => x > 5);
 var first = value.ToArray();  // 6,7,8,9,10
 source.[0] = 100;
 var second = value.ToArray(); // 100,6,7,8,9,10 
```

**懒惰访问源代码的示例**（我不推荐这种类型的代码，这是一个示例，说明如何访问`source`lambda 中的变量会创建一个可以推迟访问的“闭包”`source`

```
source = Enumerable.Range(1,10);
value = Enumerable.Range(1).SelectMany(n => source.Where(x => x > 5));
var first = value.ToArray();
source = Enumerable.Range(11,20);
var second = value.ToArray(); 
```

# javascript - 删除使用绑定添加的事件侦听器

> ID：11565471
> 
> 赞同：197
> 
> 时间：2012-07-19T16:42:54.543
> 
> 标签：javascript, events, listener, bind

在 JavaScript 中，使用 bind() 删除作为事件侦听器添加的函数的最佳方法是什么？

例子

```
(function(){

    // constructor
    MyClass = function() {
        this.myButton = document.getElementById("myButtonID");
        this.myButton.addEventListener("click", this.clickListener.bind(this));
    };

    MyClass.prototype.clickListener = function(event) {
        console.log(this); // must be MyClass
    };

    // public method
    MyClass.prototype.disableButton = function() {
        this.myButton.removeEventListener("click", ___________);
    };

})(); 
```

我能想到的唯一方法是跟踪每个添加了绑定的侦听器。

上面这个方法的例子：

```
(function(){

    // constructor
    MyClass = function() {
        this.myButton = document.getElementById("myButtonID");
        this.clickListenerBind = this.clickListener.bind(this);
        this.myButton.addEventListener("click", this.clickListenerBind);
    };

    MyClass.prototype.clickListener = function(event) {
        console.log(this); // must be MyClass
    };

    // public method
    MyClass.prototype.disableButton = function() {
        this.myButton.removeEventListener("click", this.clickListenerBind);
    };

})(); 
```

有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：320
> 
> 时间：2014-04-04T18:46:21.590

尽管@machineghost 说的是真的，添加和删除事件的方式相同，但等式中缺少的部分是：

> 调用后会创建一个新的函数引用`.bind()`。

请参阅[bind() 是否更改函数引用？| 如何永久设置？](https://stackoverflow.com/questions/14417890/does-bind-change-the-function-reference-how-to-set-permanently?lq=1)

因此，要添加或删除它，请将引用分配给变量：

```
var x = this.myListener.bind(this);
Toolbox.addListener(window, 'scroll', x);
Toolbox.removeListener(window, 'scroll', x); 
```

这对我来说按预期工作。

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2015-10-28T08:39:35.063

对于那些在向/从 Flux 存储注册/删除 React 组件的侦听器时遇到此问题的人，请将以下行添加到组件的构造函数中：

```
class App extends React.Component {
  constructor(props){
    super(props);
    // it's a trick! needed in order to overcome the remove event listener
    this.onChange = this.onChange.bind(this);  
  }
  // then as regular...
  componentDidMount (){
    AppStore.addChangeListener(this.onChange);
  }

  componentWillUnmount (){
    AppStore.removeChangeListener(this.onChange);
  }

  onChange () {
    let state = AppStore.getState();
    this.setState(state);
  }

  render() {
    // ...
  }

}
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-19T16:44:01.273

是否使用绑定函数都没有关系；您删除它的方式与任何其他事件处理程序相同。如果您的问题是绑定版本是它自己的独特功能，您可以跟踪绑定版本，或者使用`removeEventListener`不采用特定处理程序的签名（尽管这当然会删除相同类型的其他事件处理程序）。

（附带说明一下，`addEventListener`并非在所有浏览器中都有效；您确实应该使用像 jQuery 这样的库来为您以跨浏览器的方式进行事件连接。此外，jQuery 具有命名空间事件的概念，它允许你绑定到“click.foo”；当你想删除事件时，你可以告诉 jQuery“删除所有 foo 事件”，而不必知道特定的处理程序或删除其他处理程序。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-03-30T10:23:04.337

jQuery解决方案：

```
let object = new ClassName();
let $elem = $('selector');

$elem.on('click', $.proxy(object.method, object));

$elem.off('click', $.proxy(object.method, object)); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-04-03T09:03:26.627

我们在无法更改的库中遇到了这个问题。Office Fabric UI，这意味着我们无法更改添加事件处理程序的方式。我们解决它的方法是覆盖原型`addEventListener`上的。`EventTarget`

这将在对象上添加一个新功能`element.removeAllEventListers("click")`

（原帖：[从结构对话框覆盖中删除点击处理程序](https://stackoverflow.com/questions/43977729/remove-click-handler-from-fabric-dialog-overlay/55491096#55491096)）

```
 <script>
            (function () {
                "use strict";

                var f = EventTarget.prototype.addEventListener;

                EventTarget.prototype.addEventListener = function (type, fn, capture) {
                    this.f = f;
                    this._eventHandlers = this._eventHandlers || {};
                    this._eventHandlers[type] = this._eventHandlers[type] || [];
                    this._eventHandlers[type].push([fn, capture]);
                    this.f(type, fn, capture);
                }

                EventTarget.prototype.removeAllEventListeners = function (type) {
                    this._eventHandlers = this._eventHandlers || {};
                    if (type in this._eventHandlers) {
                        var eventHandlers = this._eventHandlers[type];
                        for (var i = eventHandlers.length; i--;) {
                            var handler = eventHandlers[i];
                            this.removeEventListener(type, handler[0], handler[1]);
                        }
                    }
                }

                EventTarget.prototype.getAllEventListeners = function (type) {
                    this._eventHandlers = this._eventHandlers || {};
                    this._eventHandlers[type] = this._eventHandlers[type] || [];
                    return this._eventHandlers[type];
                }

            })();
        </script> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-10-28T20:14:28.267

**这是解决方案：**

```
var o = {
  list: [1, 2, 3, 4],
  add: function () {
    var b = document.getElementsByTagName('body')[0];
    b.addEventListener('click', this._onClick());

  },
  remove: function () {
    var b = document.getElementsByTagName('body')[0];
    b.removeEventListener('click', this._onClick());
  },
  _onClick: function () {
    this.clickFn = this.clickFn || this._showLog.bind(this);
    return this.clickFn;
  },
  _showLog: function (e) {
    console.log('click', this.list, e);
  }
};

// Example to test the solution
o.add();

setTimeout(function () {
  console.log('setTimeout');
  o.remove();
}, 5000); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-03-01T12:28:12.700

正如其他人所说，`bind`创建一个新的函数实例，因此除非以某种方式记录，否则无法删除事件侦听器。

为了获得更漂亮的代码风格，您可以将方法函数设置为惰性 getter，以便在第一次访问时自动替换为绑定版本：

```
class MyClass {
  activate() {
    window.addEventListener('click', this.onClick);
  }

  deactivate() {
    window.removeEventListener('click', this.onClick);
  }

  get onClick() {
    const func = (event) => {
      console.log('click', event, this);
    };
    Object.defineProperty(this, 'onClick', {value: func});
    return func;
  }
} 
```

如果不支持 ES6 箭头功能，请`const func = (function(event){...}).bind(this)`改用。

Raichman Sergey 的方法也很好，尤其是在课堂上。这种方法的优点是它更加自我完成，并且在其他地方没有单独的代码。它也适用于没有构造函数或启动器的对象。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2012-07-19T17:28:16.130

如果你想使用'onclick'，如上所述，你可以试试这个：

```
(function(){
    var singleton = {};

    singleton = new function() {
        this.myButton = document.getElementById("myButtonID");

        this.myButton.onclick = function() {
            singleton.clickListener();
        };
    }

    singleton.clickListener = function() {
        console.log(this); // I also know who I am
    };

    // public function
    singleton.disableButton = function() {
        this.myButton.onclick = "";
    };
})(); 
```

我希望它有所帮助。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2019-08-05T07:06:57.927

可以使用关于 ES7：

```
class App extends React.Component {
  constructor(props){
    super(props);
  }
  componentDidMount (){
    AppStore.addChangeListener(this.onChange);
  }

  componentWillUnmount (){
    AppStore.removeChangeListener(this.onChange);
  }

  onChange = () => {
    let state = AppStore.getState();
    this.setState(state);
  }

  render() {
    // ...
  }

} 
```

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2014-05-01T06:30:08.617

已经有一段时间了，但 MDN 对此有一个超级解释。这比这里的东西对我的帮助更大。

[MDN :: EventTarget.addEventListener - 处理程序中“this”的值](https://developer.mozilla.org/en-US/docs/Web/API/EventTarget.addEventListener#The_value_of_this_within_the_handler)

它为handleEvent 函数提供了一个很好的替代方案。

这是一个有和没有绑定的例子：

```
var Something = function(element) {
  this.name = 'Something Good';
  this.onclick1 = function(event) {
    console.log(this.name); // undefined, as this is the element
  };
  this.onclick2 = function(event) {
    console.log(this.name); // 'Something Good', as this is the binded Something object
  };
  element.addEventListener('click', this.onclick1, false);
  element.addEventListener('click', this.onclick2.bind(this), false); // Trick
} 
```

上面示例中的一个问题是您无法使用 bind 删除侦听器。另一种解决方案是使用一个名为 handleEvent 的特殊函数来捕获任何事件：

# php - 在 Magento 的布局中添加变量

> ID：11565477
> 
> 赞同：0
> 
> 时间：2012-07-19T16:43:25.403
> 
> 标签：php, magento, layout, checkout

我已经在 Magento 的单页结帐中添加了一个阶段，所以据我所知，我必须使用与此非常相似的代码。我想要做的是在布局中添加一个变量，我可以回显出来。

```
$layout = $this->getLayout();
$update = $layout->getUpdate();
$update->load('checkout_onepage_security');
// My attempt at adding a $test variable:
// $layout->setData('test', 'what is up');
$layout->generateXml();
$layout->generateBlocks();
$output = $layout->getOutput();
return $output; 
```

我知道如何使用块来做到这一点，但这不是块！

# c# - 认证成功后重定向

> ID：11565479
> 
> 赞同：0
> 
> 时间：2012-07-19T16:43:29.977
> 
> 标签：c#, asp.net, authentication, redirect, login

当用户点击支付账单（安全页面）选项时，系统会提示他/她登录，然后被重定向到帐户页面。我正在使用`Page.ResolveUrl`该`Login_Authenticate`方法。登录后，如果用户导航到网站上的任何其他页面，然后再次单击付款账单，我会检查`Identity.IsAuthenticated`页面加载中的状态，并根据此再次将用户重定向到帐户页面。我想知道这是否是正确的方法，或者是否有任何最佳实践，因为这涉及到大量的服务器调用。我可以使用`LoggedInTemplate`in`asp:LoginView`或 Javascript 执行此功能吗？我有你的参考代码...

```
protected void Page_Load(object sender, EventArgs e)
{
    //to directly link user to account if it's authenticated
    var userauth = System.Web.HttpContext.Current.User.Identity.IsAuthenticated;
    if (userauth)
    {
        string urlredirect = Page.ResolveUrl("~/" + SiteConfig.PageMappings["ACCOUNT"]);
        Response.Redirect(urlredirect);
        Server.TransferRequest(urlredirect);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T18:59:18.353

您不需要同时执行 Redirect 和 TransferRequest。Response.Redirect 向浏览器发送一个 302 来告诉它访问一个新页面。Server.TransferRequest 导致在现有请求中的不同页面中处理请求。如果您正在进行身份验证，您可能希望废弃当前会话并重新开始，这意味着只使用 Response.Redirect。我在这种情况下使用 Response.Redirect。我还认为让用户看到他们被重定向到另一个页面进行登录（以及对页面缓存和浏览器中的来/回导航很有用。对于身份验证和登录）。

# c# - C# WCF 服务引用在引用抽象类时公开具体类而不是继承的抽象类

> ID：11565485
> 
> 赞同：1
> 
> 时间：2012-07-19T16:43:46.497
> 
> 标签：c#, web-services, wsdl, abstract-class, service-reference

我正在使用来自 wsdl 的 Visual Studio 2010 生成 C# 服务引用。（简化示例，请原谅任何语法错误）：

```
<xs:complexType name="Constraints">
  <xs:sequence>
    <xs:element minOccurs="1" maxOccurs="unbounded" ref="p:Constraint" />
  </xs:sequence>
</xs:complexType>

<xs:element name="Constraint" type="p:ConstraintType" />

<xs:complexType abstract="true" name="ConstraintType />

<xs:complexType name="RelConstraint" >
  <xs:complexContent>
    <xs:extension base="p:ConstraintType">
     ...
    </xs:extension>
  <xs:complexContent>
</xs:complexType>

<xs:complexType name="Logic" abstract="true">
  <xs:complexContent>
    <xs:extension base="p:ConstraintType">
     ...
    </xs:extension>
  <xs:complexContent>
</xs:complexType>  

<xs:complexType name="AndLogic" >
  <xs:complexContent>
    <xs:extension base="p:Logic">
     ...
    </xs:extension>
  <xs:complexContent>
</xs:complexType> 
```

Constraints 的元素是 .Item 而不是 .Constraint （这很好，我知道这发生在抽象中）。

**但是， Constraints.Item 类型是 RelConstraint 而不是 ConstraintType，因此它不会将 AndLogic 识别为可能的类型。**

因此，如果一种具体类型被抽象一层，另一种被抽象两层，那么服务引用设置对只抽象一层的类的任何引用。

（例如，ConcreteClassA 扩展了 AbstractClassC，ConcreteClassB 扩展了 AbstractClassB，AbstractClassB 扩展了 AbstractClassC，

ConcreteClassX 有元素 AbstractClassC，它应该是那种类型。但是，该元素的类型为 ConcreteClassA)

有解决办法吗？

这与[为什么 WCF 在作为 Web 服务托管时不能“正确”使用/公开抽象类型有关](https://stackoverflow.com/questions/839696/why-doesnt-wcf-properly-consume-expose-abstract-types-when-hosted-as-a-web-se)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T13:35:34.690

所以我的第一个几乎可行的想法是从元素声明中删除 abstract="true" ，但将其保留在类型声明中。这是删除任何内容之前元素和类型的声明：

```
<xs:element abstract="true" name="Logic" substitutionGroup="p:Constraint" type="p:LogicType" />

<xs:complexType name="LogicType" abstract="true">
  <xs:complexContent>
    <xs:extension base="p:ConstraintType">
      ...
    </xs:extension>
  <xs:complexContent>
</xs:complexType> 
```

Visual Studio 实际上正确地生成了代码！据我所知，从元素中删除抽象而不是类型并不是抽象对象的错误实现。（但是，我仍然对这一点感到厌倦）。

所以我写了一些测试 xml 并将其从我的服务器发送到我的 c# 程序。当然......它不会正确序列化对象（它们都设置为空）。

所以最后还是直接看了一下Reference.cs文件，看看能不能找出问题所在。

```
[System.Xml.Serialization.XmlElementAttribute("Logic", typeof(LogicType), Order = 0)]
[System.Xml.Serialization.XmlElementAttribute("RelConstraint", typeof(RelConstraintType), Order = 0)]
public ConstraintComponentType Item 
```

它看起来是正确的，但我决定为 AndLogic 和我的其他逻辑类型添加 XmlElementAttribute 声明以查看发生了什么。它终于正确地序列化了测试数据！

```
[System.Xml.Serialization.XmlElementAttribute("And", typeof(AndType), Order = 0)]
[System.Xml.Serialization.XmlElementAttribute("Logic", typeof(LogicType), Order = 0)]
[System.Xml.Serialization.XmlElementAttribute("RelConstraint", typeof(RelConstraintType), Order = 0)]
public ConstraintComponentType Item 
```

所以我最终做的是把 abstract="true" 放回我的元素上以使我的模式正确，然后进入并执行上述步骤，同时更改它错误地生成类型的任何地方，例如

```
[System.Xml.Serialization.XmlElementAttribute("Logic", typeof(LogicType), Order = 0)]
[System.Xml.Serialization.XmlElementAttribute("RelConstraint", typeof(RelConstraintType), Order = 0)]
public RelConstraintType Item 
```

所以唯一的问题是，如果要重新生成服务引用，则必须返回并再次手动编辑 Reference.cs 文件。

# python - Python 等效于 PHP mysql_fetch_array

> ID：11565487
> 
> 赞同：7
> 
> 时间：2012-07-19T16:43:52.360
> 
> 标签：python, mysql, sql, mysql-python

我想在 MySQL 中获取一个数组。有人可以告诉我如何使用 MySQLdb 来使用 Python 吗？

例如，这就是我想在 Python 中做的事情：

```
<?php

  require_once('Config.php'); 

  $q = mysql_query("SELECT * FROM users WHERE firstname = 'namehere'");
  $data = mysql_fetch_array($q);
  echo $data['lastname'];

?> 
```

谢谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2018-07-16T15:11:27.887

在python中你有`dictionary=True`，我在python3中测试过。这将返回与 php 中的关联数组非常相似的目录。例如。

```
import mysql.connector
cnx = mysql.connector.connect(user='root', password='',host='127.0.0.1',database='test1')
cursor = cnx.cursor(dictionary=True)
sql= ("SELECT * FROM `users` WHERE id>0")
cursor.execute(sql)
results = cursor.fetchall()
print(results) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2019-02-07T22:31:14.980

您可以使用它（**dictionary=True**）：

```
import mysql.connector

db = mysql.connector.connect(user='root', password='',host='127.0.0.1', database='test1')

cursor = db.cursor(dictionary=True)
cursor.execute("SELECT * FROM table")

for row in cursor:
    print(row['column']) 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-07-19T16:54:28.200

1.  安装 MySQLdb（Python 的 MySQL 驱动程序）。类型`pip install mysql-python`
2.  阅读[Python DB API](http://www.python.org/dev/peps/pep-0249/)，这是在 Python 中访问数据库的标准方法。

然后，试试这个：

```
>>> import MySQLdb
>>> connection = MySQLdb.connect(database='test')
>>> cursor = connection.cursor()
>>> cursor.execute('SELECT * FROM users WHERE firstname = %s',('somename',))
>>> results = cursor.fetchall()
>>> for i in results:
       print i 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-19T16:58:38.453

我会使用[SQLAlchemy](http://docs.sqlalchemy.org/en/latest/orm/tutorial.html)。像这样的东西可以解决问题：

```
engine = create_engine('mysql://username:password@host:port/database')
连接 = engine.connect()
result = connection.execute("从用户中选择用户名")
结果中的行：
    打印“用户名：”，行['用户名']
连接.close()

```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-02-09T15:35:33.693

尝试：

```
import MySQLdb
connection = MySQLdb.connect(host="localhost",  # your host
                     user="root",  # username
                     passwd="password",  # password
                     db="frateData")  # name of the database)
cursor = connection.cursor(MySQLdb.cursors.DictCursor)
cursor.execute('SELECT * FROM users WHERE firstname = %s',['namehere'])
data = cursor.fetchall()
print data['lastname'] 
```

请注意，通过传递以下参数来启动游标：“MySQLdb.cursors.DictCursor”会返回一个列表而不是数组，因此您可以使用它们的键名引用数据，在您的情况下是姓氏。

# bash - 在 bash 中使用正则表达式在字符串中进行多个匹配

> ID：11565489
> 
> 赞同：4
> 
> 时间：2012-07-19T16:43:54.953
> 
> 标签：bash, bash4

一直在寻找一些关于 bash 正则表达式的更高级的正则表达式信息，但没有找到太多关于它的信息。

这是概念，带有一个简单的字符串：

```
myString="DO-BATCH BATCH-DO"

if [[ $myString =~ ([[:alpha:]]*)-([[:alpha:]]*) ]]; then
 echo ${BASH_REMATCH[1]} #first perens
 echo ${BASH_REMATCH[2]} #second perens
 echo ${BASH_REMATCH[0]} #full match
fi

outputs:
BATCH
DO
DO-BATCH 
```

第一场比赛（BATCH-DO）很好，但我如何拉第二场比赛（DO-BATCH）？我只是在这里画一个空白，找不到关于 bash 正则表达式的太多信息。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T18:10:44.473

好的，我这样做的一种方法是把它放在一个 for 循环中：

```
myString="DO-BATCH BATCH-DO"
for aString in ${myString[@]}; do
    if [[ ${aString} =~ ([[:alpha:]]*)-([[:alpha:]]*) ]]; then
     echo ${BASH_REMATCH[1]} #first perens
     echo ${BASH_REMATCH[2]} #second perens
     echo ${BASH_REMATCH[0]} #full match
    fi
done

which outputs:
DO
BATCH
DO-BATCH
BATCH
DO
BATCH-DO 
```

哪个有效，但我有点希望尽可能从一个正则表达式中提取所有内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T20:27:31.030

在您的答案中，`myString`不是数组，而是您使用数组引用来访问它。这在 Bash 中有效，因为数组的第 0 个元素可以仅由变量名引用，反之亦然。这意味着您可以使用：

```
for aString in $myString; do 
```

在这种情况下得到相同的结果。

在您的问题中，您说输出包括“BATCH-DO”。我得到“DO-BATCH”，所以我认为这是一个错字。

在不使用循环的情况下获取额外字符串的唯一方法`for`是使用更长的正则表达式。顺便说一句，我建议将 Bash 正则表达式放入变量中。它使某些类型更易于使用（例如，那些包含空格或特殊字符的类型。

```
pattern='(([[:alpha:]]*)-([[:alpha:]]*)) +(([[:alpha:]]*)-([[:alpha:]]*))'
[[ $myString =~ $pattern ]]
declare -p BASH_REMATCH    #dump the array 
```

输出：

```
declare -ar BASH_REMATCH='([0]="DO-BATCH BATCH-DO" [1]="DO-BATCH" [2]="DO" [3]="BATCH" [4]="BATCH-DO" [5]="BATCH" [6]="DO")' 
```

如果要捕获单个子字符串以及连字符短语，则需要额外的括号集。如果您不需要单个单词，则可以消除括号的内部集合。

请注意，`if`如果您只需要提取子字符串，则不需要使用。您只需要`if`根据匹配项采取有条件的操作。

另请注意，`${BASH_REMATCH[0]}`较长的正则表达式会完全不同，因为它包含整个匹配项。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T21:27:00.107

根据@Dennis Williamson 的帖子，我搞砸了，结果如下：

```
myString="DO-BATCH BATCH-DO" 
pattern='(([[:alpha:]]*)-([[:alpha:]]*)) +(([[:alpha:]]*)-([[:alpha:]]*))'

[[ $myString =~ $pattern ]] && { read -a myREMatch <<< ${BASH_REMATCH[@]}; }

echo "\${myString} -> ${myString}" 
echo "\${#myREMatch[@]} -> ${#myREMatch[@]}"

for (( i = 0; i < ${#myREMatch[@]}; i++ )); do   
  echo "\${myREMatch[$i]} -> ${myREMatch[$i]}" 
done 
```

这很好用，除了 myString 必须有 2 个值。所以我发布这个是因为它有点有趣，而且我玩得很开心。但是为了让这个更通用并解决任何数量的配对组（即 DO-BATCH），我将使用我原始答案的修改版本：

```
myString="DO-BATCH BATCH-DO" 
myRE="([[:alpha:]]*)-([[:alpha:]]*)"

read -a myString <<< $myString

for aString in ${myString[@]}; do   
  echo "\${aString} -> ${aString}"  
  if [[ ${aString} =~ ${myRE} ]]; then
    echo "\${BASH_REMATCH[@]} -> ${BASH_REMATCH[@]}"
    echo "\${#BASH_REMATCH[@]} -> ${#BASH_REMATCH[@]}"
    for (( i = 0; i < ${#BASH_REMATCH[@]}; i++ )); do
      echo "\${BASH_REMATCH[$i]} -> ${BASH_REMATCH[$i]}"
    done
  fi
done 
```

我本来希望像多重匹配这样的 perlre ，但这很好用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-25T14:58:34.193

虽然这是一个老问题（没有公认的答案），但正则表达式模式是否可以简化为：

```
myRE="([[:alpha:]]*-[[:alpha:]]*)" 
```

通过删除内括号来找到一组更小（更简洁）的单词`DO-BATCH`和`BATCH-DO`？

它适用于你 18:10 的时间回答。${BASH_REMATCH[0]} 和 ${BASH_REMATCH[1]} 导致找到 2 个单词。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-01-12T19:04:18.913

如果您实际上不知道提前会有多少场比赛，您可以使用这个：

```
#!/bin/bash

function handle_value {
  local one=$1
  local two=$2

  echo "i found ${one}-${two}"
}

function match_all {
  local current=$1
  local regex=$2
  local handler=$3

  while [[ ${current} =~ ${regex} ]]; do
    "${handler}" "${BASH_REMATCH[@]:1}"

    # trim off the portion already matched
    current="${current#${BASH_REMATCH[0]}}"
  done
}

match_all \
  "DO-BATCH BATCH-DO" \
  '([[:alpha:]]*)-([[:alpha:]]*)[[:space:]]*' \
  'handle_value' 
```

# java - 需要从 JFrame 中的单选按钮获取输入，并在另一个类中使用选定的输入

> ID：11565490
> 
> 赞同：0
> 
> 时间：2012-07-19T16:43:54.997
> 
> 标签：java, swing, jframe, jlink

我需要创建一个应用程序，我需要从单选按钮获取用户输入，然后在不同的类中使用选定的文件名。我不确定如何实现这一点，因为每次我尝试放置 getString() 方法在 MyAction 类中，它给了我一个空值。谢谢！！

```
import javax.swing.*;
import java.awt.*;
import java.awt.event.*;
import java.io.File;

public class SelectRadioButton{

    public SelectRadioButton(){

      // Directory path here
      String path = "W:\\materials"; 

      JFrame frame = new JFrame("Material Selection");
      JPanel panel = new JPanel(new GridLayout(0, 4));
      ButtonGroup bg = new ButtonGroup();

      String files;
      File folder = new File(path);
      File[] listOfFiles = folder.listFiles(); 
      JRadioButton  first;

      for (int i = 0; i < listOfFiles.length; i++) 
      {

       if (listOfFiles[i].isFile()) 
       {
       files = listOfFiles[i].getName();
           if (files.endsWith(".mtl") || files.endsWith(".MTL"))
           {

              first = new JRadioButton(files);
              panel.add(first,BorderLayout.CENTER);
              panel.revalidate(); 

              bg.add(first);
              first.addActionListener(new MyAction);
            }
         }
      }

       frame.add(panel, BorderLayout.NORTH);
       frame.getContentPane().add(new JScrollPane(panel), BorderLayout.CENTER);
       frame.setSize(1000, 400);
       frame.setVisible(true);
       frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
   }

  public class MyAction implements ActionListener{
        //String m;
      public void actionPerformed(ActionEvent e){
      String m =e.getActionCommand();
      String[] split = m.split("\\.");
      m=split[0];
      JOptionPane.showMessageDialog(null,"Your Selection is"+m+" radio button.");
   }
        /*
        public String getString(){
               return m;
        }
        */
   }
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T18:04:08.827

显然，`m`只有在特定单选按钮收到点击事件时才会设置该变量。
如果您不想更改太多代码，请执行以下操作：

```
public class MyAction implements ActionListener{
    String m;

    public MyAction(String radioButtonLabel){
        m = radioButtonLabel;
    }
    public void actionPerformed(ActionEvent e){
        JOptionPane.showMessageDialog(null,
                "Your Selection is"+m+" radio button.");
    }
    public String getString(){
        return m;
    }
} 
```

并替换：

```
first.addActionListener(new MyAction()); 
```

经过：

```
first.addActionListener(new MyAction(files)); 
```

并改进变量的名称......这有点令人困惑！
希望能帮助到你。

**更新**

要获取选定的单选按钮：

```
public static JRadioButton getSelection(ButtonGroup group) {
    for (Enumeration e = group.getElements(); e.hasMoreElements();) {
        JRadioButton b = (JRadioButton) e.nextElement();
        if (b.getModel() == group.getSelection()) {
            return b;
        }
    }
    return null;
} 
```

# python - GAE + Python + Sendmail + Form = 邮件不工作

> ID：11565492
> 
> 赞同：0
> 
> 时间：2012-07-19T16:43:56.310
> 
> 标签：python, google-app-engine, sendmail

我无法在我的谷歌应用程序中接收任何邮件。

相关代码为：

**主文件**

```
from google.appengine.ext import webapp
from google.appengine.ext.webapp.util import run_wsgi_app
from google.appengine.api import mail

# Sets the "inicio.html" website as the default page
class IndexHandler(webapp.RequestHandler):
    def get(self):
        path='inicio.html'
        if self.request.url.endswith('/'):
            path = '%sinicio.html'%self.request.url

        self.redirect(path)

    def post(self):have the following 
        self.get()

# Sends an email with the fields of the form
class OnSendFormHandler(webapp.RequestHandler):
  def post(self):
      cf_name=self.request.get('cf_name')
      cf_email=self.request.get('cf_email')
      cf_subject=self.request.get('cf_subject')
      cf_body=self.request.get('cf_message')

      message = mail.EmailMessage(sender="GAE Account <validAccount@appspot.gserviceaccount.com>",
                                  to = "personalAccount <existentAccount@gmail.com>",
                                  subject = cf_subject,
                                  body = cf_body)
      message.send()

application = webapp.WSGIApplication([('/.*', IndexHandler),
                                      ('/on_send_form', OnSendFormHandler)], debug=True)

def main():
    run_wsgi_app(application)

if __name__ == "__main__":
    main() 
```

请注意，表单“/on_send_form”有一个处理程序。

相关的html表单：

```
 <form action="/on_send_form" method="post" id="contacts-form">
        <fieldset>
          <div class="grid3 first">
            <label title="Escriba su nombre y apellidos">Nombre:<br />
              <input type="text" name="cf_name" value=""/>
            </label>
            <label title="Escriba la dirección de correo electrónico donde quiere que le enviemos la respuesta a su consulta">E-mail:<br />
              <input type="email" name="cf_email" value=""/>
            </label>
            <label title="Escriba la razón principal de su mensaje">Asunto:<br />
              <input type="text" name="cf_subject" value="" title="Escriba la razón principal de su mensaje"/>
            </label>
          </div>
          <div class="grid5">Mensaje:<br />
            <textarea name="cf_message" title="Escriba su consulta con detalle. Le responderemos a la dirección de correo electrónico indicada en un plazo máximo de 24 horas"></textarea>
            <div class="alignright">
              <a href="#" class="alt" onClick="document.getElementById('contacts-form').reset()">Limpiar Campos</a> &nbsp; &nbsp; &nbsp;<a href="#" class="alt" onClick="document.getElementById('contacts-form').submit()">Enviar</a>
            </div>
          </div>
        </fieldset>
      </form> 
```

表单和处理程序都使用 POST 方法。我使用该选项部署 GAE 应用程序。--enable_sendmail

GAE 中的日志说一切正常。

我阅读了文档，但我不知道我错过了。

提前谢谢你，DConversor

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T17:19:38.200

您的`WSGIApplication`构造函数中的处理程序顺序错误；它们按照给定的顺序进行检查，并`'/.*'`匹配所有 URL，因此`'/on_send_form'`永远不会检查 on。把包罗万象的表达式放在最后。

# hadoop - Hadoop 变量在 reducer 中设置并在驱动程序中读取

> ID：11565494
> 
> 赞同：0
> 
> 时间：2012-07-19T16:43:57.960
> 
> 标签：hadoop, mapreduce, global-variables, driver

我如何在减速器中设置一个变量，在所有任务完成执行后，驱动程序可以读取该变量？就像是：

```
class Driver extends Configured implements Tool{
  public int run(String[] args) throws Exception {
    ...
    JobClient.runJob(conf); // reducer sets some variable
    String varValue = ...;  // variable value is read by driver
  }
} 
```

**解决方法**

我想出了这个“丑陋”的解决方法。主要思想是您创建一组计数器，其中您只保存一个计数器，其名称是您希望返回的值（您忽略实际的计数器值）。代码如下所示：

```
// reducer || mapper
reporter.incrCounter("Group name", "counter name -> actual value", 0);

// driver
RunningJob runningJob = JobClient.runJob(conf);
String value = runningJob.getCounters().getGroup("Group name").iterator().next().getName(); 
```

这同样适用于映射器。虽然这解决了我的问题，但我认为这种解决方案是“丑陋的”。因此，我**将问题悬而未决**。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T20:47:16.383

您不能修改 map/reduce 任务中的配置，并期望将更改保留到其他任务和/或提交作业的作业客户端中的配置（假设您在 reducer 中写入不同的值 - 哪个赢了' 出来并坚持回来？）。

但是，您可以自己将文件写入 HDFS，然后可以在您的工作返回时读回 - 确实不那么丑，但没有办法不涉及其他技术（Zookeeper、HBase 或任何其他 NoSQL / RDB）持有价值在您的任务结束和您能够在工作成功后检索价值之间。

# java - Java 将对象映射到对象 - Moo

> ID：11565495
> 
> 赞同：1
> 
> 时间：2012-07-19T16:43:58.573
> 
> 标签：java, javabeans, object-object-mapping

我有一个关于 Moo (https://github.com/geoffreywiseman/Moo/) 的问题，我自己无法解决。我有这个类结构：

```
class Middle{
  private int id;
  private Upper upper;
  private List<Child> children;
  private List<Middle> brothers;
}

class Upper{
  private int id;
  private String name;
  private String lastname;
}

class Child{
  private int id;
  private String name;
} 
```

我想把它们翻译成：

```
class OutputMiddle{
  private int id;

  @Property(translation="Upper")
  private OutputUpper outputUpper;
  @CollectionProperty(itemTranslation = Upper.class)
  private List<OutputChild> outputChildren;
  private List<OutputMiddle> outputBrothers;
}

class OutputUpper{
  private int id;
  private String outputName;
}

class OutputChild{
  private int id;
  private String outputName;
} 
```

我不知道的是：

*   我是否能够将一个类的一个属性转换为另一个类的另一个属性？
*   除了对对象集合做同样的事情吗？
*   和同一类对象的集合一样吗？

为什么我需要这个？因为我将“Middle”类的对象作为 JSON（或 XML）返回，并且我需要它具有诸如“OutputMiddle”之类的结构，但我不想在 JSON 创建后干预它并更改名称手动的节点。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T14:09:34.537

试试[JMapper 框架](http://code.google.com/p/jmapper-framework/)，它易于使用并且需要很少的配置

# templates - 在 Play Framework 模板中的 JavaScript 中使用花括号

> ID：11565497
> 
> 赞同：5
> 
> 时间：2012-07-19T16:44:00.977
> 
> 标签：templates, scala, playframework-2.0

我已经传递了我从控制器传递的标题列表：

```
@titles:List[String] 
```

我想循环生成一些带有 {mmm} 的 html 标题：

```
@titles.map { title =>
  <h1>{title} {mmm}</h1>
} 
```

显然有一个问题，因为它会尝试找到一个名为 mmm 的变量。如何逃脱括号？

还是有一种更惯用的方式来生成不涉及映射列表的 HTML？对此非常新！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T17:01:35.700

您不需要在 Play 中转义大括号——与 Scala 的 XML 文字不同，它们在 Play 模板中没有任何特殊含义，除了`@`.

您应该能够编写以下内容：

```
@titles.map { title =>
  <h1>@{title} {mmm}</h1>
} 
```

并得到`<h1>Whatever Title {mmm}</hq>`等。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-19T17:53:38.417

Travis 的回答展示了一种可能性（对于您所要求的），它是正确的。另一方面，您也可以遇到其他情况，您需要记住其他技巧：

例如，这**将失败**：

```
@for(title <- titles){
    Title: @title {mmm} <br/>
} 
```

但这**会起作用**（感谢特拉维斯）

```
@for(title <- titles) { 
    Title: @{title} {mmm} <br/> 
} 
```

这也**将起作用**

```
@for(title <- titles){
    Title: @title - <b>something else without bracets</b> <br/>
} 
```

### 选择

或者，您可以在模型中创建示例`toBrackets()`方法并在模板中调用它（Java 示例）

```
public String toBrackets(String string) {
    return "{" + string + "}";
} 
```

在模板中：

```
@for(title <- titles){
    Title: @title @title.toBrackets("mmm") <br/>
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-11-11T13:56:15.370

如果它不是 JS 或其他代码的一部分，并且只是用于呈现在视图中，那么我们可以使用 HTML entitles

```
&#123; for left curly brace
&#125; for right curly brace 
```

结果：

```
{ for left curly brace
} for right curly brace 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-10T08:29:48.373

您可以创建变量`@LeftBracket`=`{`和`@RightBracket`= `}`，然后这应该可以工作：

```
@titles.map { title =>
  <h1>{title} @{LeftBracket}mmm@RightBracket</h1>
} 
```

与您的问题有些相关的旁注：

我的印象是，除非括号匹配（即`}`每个都匹配一个`{`），否则
模板编译会失败，所以也许`@RightBracket`是插入单个`}`? 如果您需要编写以下代码，这将很有用：

```
@titles.map { title =>
   hello :-}
} 
```

:-}

# jquery - 名称不以“某物”开头/结尾的选择元素的选择器

> ID：11565499
> 
> 赞同：7
> 
> 时间：2012-07-19T16:44:16.027
> 
> 标签：jquery, jquery-selectors

在 jQuery 中，可以选择所有以“某物”开头/结尾的元素。

```
 = is exactly equal
!= is not equal
^= starts with
$= ends with 
```

是否可以选择所有不以“某物”开头/结尾的元素？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-19T16:45:29.427

使用[`:not`](http://api.jquery.com/not-selector/)选择器：

```
:not([id^=foo]) 
```

# sql - 如果没有找到空格如何返回字符串

> ID：11565508
> 
> 赞同：1
> 
> 时间：2012-07-19T16:45:24.950
> 
> 标签：sql, sql-server, sql-server-2008

我需要在空格之前返回字符串中的所有内容：

```
select Substring('stack overflow', 1, CharIndex( ' ', 'stack overflow' ) - 1) 
```

这将产生`stack`

但是，如果我们在数据中没有空格，我想返回整个字符串：

```
select Substring('stackoverflow', 1, CharIndex( ' ', 'stackoverflow' ) - 1) 
```

我希望它回来`stackoverflow`

处理这种情况的正确方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T16:48:55.933

```
;WITH T(C) AS
(
SELECT 'stack overflow' UNION ALL
SELECT 'stackoverflow'
)
SELECT LEFT(C, CharIndex( ' ', C + ' ' ) - 1)
FROM T 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T16:50:18.573

借用@MartinSmith 的定义：

```
;WITH T(C) AS
(
  SELECT 'stack overflow' 
  UNION ALL
  SELECT 'stackoverflow'
)
SELECT SUBSTRING(C, 1, COALESCE(NULLIF(CHARINDEX(' ', C)-1, -1), 255))
FROM T; 
```

也就是说，我更喜欢马丁的。两者都避免检查长度或执行 CASE 等，但我假设您知道字符串的最大长度（这里我假设 255）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-19T17:46:44.530

我像往常一样迟到；[在 SQL Fiddle 上](http://sqlfiddle.com/#!3/1ef27/7)

```
CREATE TABLE The_Table 
    (
     TestString varchar(50)
    );

INSERT INTO The_Table
(TestString)
VALUES
('stack overflow'),
('stackoverflow');

select 
[myResult] = case 
                when CharIndex( ' ', TestString)> 0 then Substring(TestString, 1, CharIndex( ' ', TestString ) - 1)
                when CharIndex( ' ', TestString)= 0 then TestString
                else TestString
             end
from The_Table 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-19T17:14:08.180

```
;With T(C) AS
(
    Select 'Stack'
    Union All
    Select 'Stack OverFlow' 
)
Select 
    Case When CharIndex(' ', C) > 0 
        Then SUBSTRING(C, 0, CharIndex(' ', C))
    Else
        C
    End
From T 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-20T05:48:01.390

```
Declare @str varchar(100)='stack overflow'
SELECT CASE WHEN CHARINDEX(' ',@str,1) > 0 then LEFT(@str,CHARINDEX(' ',@str,1)) else @str END 
```

# expressionengine - 将 Expression Engine 与 Exp-resso 商店一起使用时如何将用户重定向到自定义表单

> ID：11565510
> 
> 赞同：1
> 
> 时间：2012-07-19T16:45:27.340
> 
> 标签：expressionengine, expresso

好的，所以我需要一点帮助。我有一个在表达式引擎上运行的商店，带有 exp-resso 商店，我需要根据他们选择的产品和修饰符将我的用户定向到自定义表单。一旦他们通过自定义表格，他们就会被放置在结帐中以查看他们的购物车。

这可能吗？谁能帮助我，谢谢！

（ps这个网站类似于www.bizfilings.com）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-04T19:36:01.133

你所要求的不是一件小事，但它是可能的。看看[购物车扩展挂钩](https://exp-resso.com/docs/store/developers/extension_hooks.html)。最好的办法是向作者发送电子邮件寻求指导，他们可以为您指明正确的方向，或者将您与扩展购物车经验丰富的人联系起来。祝你好运！

# .net - 我应该总是在函数中返回的 LINQ 查询结果上调用 .ToArray 吗？

> ID：11565512
> 
> 赞同：10
> 
> 时间：2012-07-19T16:45:32.957
> 
> 标签：.net, vb.net, linq, return, return-value

在函数中返回 LINQ 查询的结果时，我遇到了很多`Collection was modified; enumeration operation may not execute`错误情况，就像这样......（我应该添加函数作为接口的实现，结果留下这个模块以供使用在另一个。）

```
Public Function GetTheFuzzyFuzzbuzzes() As IEnumerable(of FuzzBuzz) _
    Implements IFoo.GetTheFuzzyFuzzBuzzes

    Return mySecretDataSource.Where(Function(x) x.IsFuzzy)
End Function 
```

`.ToArray`如果基础数据有可能被更改，我是否应该在函数或属性 getter 中返回 LINQ 查询的结果时始终调用？我知道这样做会降低效率，但我觉得这样做是*安全*的，因此应始终避免出现时间耦合问题。

**编辑：**

让我更好地解释问题域。

我们有一个基于图形的主要关注领域的实现，这是一个优化问题。实体表示为图形节点。用各种成本和其他参数加权的边表示节点之间的关系。当用户操作数据时，我们会创建不同的边，并根据当前状态评估他们可以采取的各种选项，从而为他们提供有关每个选项结果的反馈。其他用户和程序对服务器上的数据所做的更改会通过推送技术立即传播到客户端。我们使用了很多线程...

...所有这一切意味着我们有很多事情以非常异步的方式发生。

我们的程序被分成模块（基于单一责任原则），有一个合同项目和一个在运行时解决的实施项目，这意味着我们严重依赖接口。我们通常使用 IEnumerable 在模块之间传递数据（因为它们是*不可*变的）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T17:07:11.730

一般来说，您不应该**总是**调用`.ToArray`或`.ToList`在返回 LINQ 查询的结果时调用。

两者`.ToArray`和`.ToList`都是“贪婪”（与惰性相反）操作，实际上执行对数据源的查询。调用它们的合适地点和时间是架构决策。例如，您可以在项目中建立一个规则来实现数据访问层内的所有 linq 查询，从而处理那里的所有数据层异常。或者尽可能不执行它们，并且只在最后获得所需的数据。还有许多与此主题相关的其他细节。

但是在从您的函数返回结果时调用或不调用`.ToArray`- 这不是一个问题，在您提供更详细的示例之前它没有答案。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-19T17:53:29.727

不，我不会为此制定规则。

我理解你的担心。调用方可能不知道它的操作会影响查询结果。

在某些情况下，您确实无法做到这一点：

*   在某些示例中，这样做会导致内存不足，例如无限可枚举，或者在每次迭代产生新计算的图像的枚举器中。（我都有）。
*   如果您在查询中使用`Any()`或`First()`。两者都只需要读取第一个元素。所有其他工作都是徒劳的。
*   如果您希望 Enumerables 与管道/过滤器链接。实现中间结果只是额外的成本。

另一方面，在许多情况下，当可以想象使用数组会产生影响查询的副作用时，将查询具体化为数组会更安全。

在编写软件时，有这样的规则听起来很有吸引力：“当你需要在 X 和 Y 之间做出选择时，总是做 X”。我不相信有任何这样的规则。也许在 15% 的情况下你真的应该做 X，在 5% 的情况下你肯定需要做 Y，而对于其余的情况，这无关紧要。

对于剩下的 80% 的人来说，什么都不做可能是合适的事情。如果您在`ToArray()`任何地方插入，代码会错误地暗示这样做是有原因的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-19T17:06:30.253

如果您要返回一个 IEnumerable（或 IQueryable，或类似那些不是自包含的），则限制何时可以调用它、可以用它做什么或可以保持多长时间需要要清楚地写出来。

出于这些原因，如果这是某种 API（即层之间），我建议您返回`FuzzBuzz[]`而不是返回。`IEnumerable<FuzzBuzz>`如果这是类/模块的内部实现的一部分，则更容易证明延迟评估的合理性`IEnumerable<FuzzBuzz>`，但使用数组仍然是合理的。

除非结果的数量很大，或者被频繁调用，否则不太可能成为性能问题（在许多情况下，CPU 时间很便宜，并且分配给数组的内存不会保留很长时间）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-19T17:19:09.053

“作为一项规则”，不，您不应该总是调用 ToList/ToArray。否则，诸如查询之类的查询`myData.GetSomeSubset().WhereOtherCondition().Join(otherdata)`会花费大量时间为每个链接调用分配临时缓冲区。但 LINQ 最适用于不可变集合。您可能希望在修改`mySecretDataSource`.

具体来说，如果您的代码始终围绕频繁修改数据源而构建，那么这听起来像是急切返回数组而不是 IEnumerable 的好理由

# php - is_default 单选按钮 symfony

> ID：11565513
> 
> 赞同：0
> 
> 时间：2012-07-19T16:45:34.573
> 
> 标签：php, symfony1, checkbox, radio-button, symfony-1.4

我有以下内容：

```
abstract class BaseSellerForm extends BaseFormDoctrine
{
  public function setup()
  {
    $this->setWidgets(array(
      'id'         => new sfWidgetFormInputHidden(),
      'name'       => new sfWidgetFormInputText(),
      'commission' => new sfWidgetFormInputText(),
      'active'     => new sfWidgetFormInputCheckbox(),
      'is_default' => new sfWidgetFormInputCheckbox(),
    )); 
```

`is_default`应该是单选按钮，因为必须检查一个字段，但我不知道如何将其更改为单选按钮，正在搜索`sfWidgetFormSelectRadio`但没有成功。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T16:52:56.137

你在[sfWidgetFormChoice](http://www.symfony-project.org/api/1_4/sfWidgetFormChoice)下尝试过吗？

# ruby-on-rails - 如何为我的应用程序使用多个 Gemfile？

> ID：11565517
> 
> 赞同：5
> 
> 时间：2012-07-19T16:46:10.633
> 
> 标签：ruby-on-rails, ruby, bundler, gemfile

我正在与一个开发团队合作，我们都在使用我们存储库中的同一个 Gemfile。因为我在 Mac 上工作，而其他人在使用 Ubuntu，所以我们的存储库中有一个 Gemfile.local.example 文件，其中包含每个操作系统的适当通知 gem，所有这些都被注释掉了。

我为我的操作系统取消了 gem 的注释并保存为一个新文件，而不是在版本控制中，Gemfile.local。现在我想“捆绑安装”从两个文件中安装 gems。

我找不到任何关于这样做的好文档。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-19T16:51:59.023

为什么不只拥有一个`Gemfile`并使用诸如[组](http://bundler.io/v1.5/groups.html)之类的东西或使用[:platform](http://bundler.io/v1.5/man/gemfile.5.html#PLATFORMS-platforms-)标志仅在 OS X 上安装一些 gem，而在 Ubuntu 上仅安装其他一些 gem？

拥有两个 Gemfile 似乎很笨拙。如果您*真的*想这样做，我猜您可以提供 Gemfile 以用于`bundle config`（[手册页）。](http://bundler.io/v1.5/bundle_config.html)

 ** * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-19T19:16:55.153

我同意使用两个 Gemfile 是不好的做法，并且找到了一个解决方案，该解决方案涉及我的 Gemfile 中的`RUBY_PLATFORM`常量和`platform`标志。这可能不是最优雅的解决方案，但它确实对我有用。

这是我为好奇的读者准备的一段代码：

```
group :development, :test do
  # Mac OSX notifications
  gem 'growl_notify' if RUBY_PLATFORM.downcase.include?("darwin")
  gem 'growl' if RUBY_PLATFORM.downcase.include?("darwin")

  # Gnome notifications => aka for Linux
  gem 'libnotify' if RUBY_PLATFORM.downcase.include?("linux")

  # Guard-spork doesn't work with windows but it's
  # awesome for other Operating Systems.
  gem 'guard-spork' if RUBY_PLATFORM.downcase.include?('darwin') || RUBY_PLATFORM.downcase.include?('linux')

  # Windows Rubies (RubyInstaller)
  platforms :mswin, :mingw do
    # Windows notifications
    gem 'rb-notifu' 
  end
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T17:30:13.560

我不确定跨平台兼容性（看起来它只支持 OS X），但 RVM gemsets 值得研究。我在工作时在我的 Mac 上使用它，效果很好。

RVM 允许我通过运行 rvm use 命令来创建和使用多个 gemset 配置。gem 安装在我当前使用的 gemset 中，因此您不必担心全局 gemset 中的冲突。

[https://rvm.io//](https://rvm.io//)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T16:52:44.777

你们都应该使用相同`Gemfile`的，并且大师`Gemfile.lock`也应该在流通。至少这是理想的。

请记住，您可以使用 Ruby 来区分加载哪些部分，`Bundle.setup`并且可以使用组来定义仅与特定平台相关的内容。

`Gemfile.lock`应该代表如何部署应用程序的特定要求。它应该在版本控制系统中，因此不会混淆应用程序将使用哪个版本启动。如果这里存在平台问题，您应该小心使用什么，并在需要时`:development`仅锁定对组的依赖关系。*

# xml - Solr 或 Lucene 可以用于搜索 XML 吗？

> ID：11565521
> 
> 赞同：2
> 
> 时间：2012-07-19T16:46:28.617
> 
> 标签：xml, solr, lucene

我有一个使用 XML 标记的信息数据库。XML 表示我想在搜索和查询中考虑的层次结构。例如，如果数据是书籍元数据：

```
<book>
    <author id="jd112">John Doe</author>
    <title>John's First Publication</title>
    <summary>This is a mundane memoir of John's life that no one else would care to read </summary>
</book> 
```

我将拥有大量这样的 XML 文档。我希望搜索者将查询限制在特定字段。我还想允许搜索者对这些进行逻辑组合。

Lucene/Solr 是否提供了这样的能力，还是我应该考虑其他一些技术？如果是 Lucene，那么我可能会如何去做这件事的指针会很有帮助。

感谢您的见解。

-拉吉

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T16:50:33.187

是的，这是最好的使用方式，但文件可能需要重新格式化

[http://www.xml.com/pub/a/2006/08/09/solr-indexing-xml-with-lucene-andrest.html](http://www.xml.com/pub/a/2006/08/09/solr-indexing-xml-with-lucene-andrest.html)

和谷歌关于配置 schema.xml

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T19:04:03.803

您可以导入您的 xml 文件，而无需自己将它们转换为 Sorl xml 格式，只需使用[DataImportHandler](http://wiki.apache.org/solr/DataImportHandler)并应用[xsl 转换](http://wiki.apache.org/solr/DataImportHandler#Usage_with_XML.2BAC8-HTTP_Datasource)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-12-03T10:29:46.133

有几种方法可以索引 XML 文档。

1.  您可以使用搜索引擎技术，包括例如 Apache Sor 和 ElasticSearch，它们都基于 Lucene 进行索引。
2.  使用 NoSQL 数据库技术，例如基于 Lucene 的 LuX for XML

希望这可以帮助

# c# - 基于下拉列表隐藏/显示文本的 jquery 函数

> ID：11565522
> 
> 赞同：1
> 
> 时间：2012-07-19T16:46:30.970
> 
> 标签：c#, jquery, asp.net

大家好，提前感谢您的帮助。所以在过去的两周里，我一直在用 C# 学习 asp.net，感觉我学得很好，但是我在 jQuery 功能上遇到了一些问题。我试图设置一个具有下拉列表的表单，并且根据选择的选项，将在其面板中显示不同的帐户创建表单。我使用了以下代码：

```
 <%@ Page Title="" Language="C#" MasterPageFile="~/MasterPages/FrontEnd.master" AutoEventWireup="true" CodeFile="Default.aspx.cs" Inherits="Login_Default" %>

<asp:Content ID="Content1" ContentPlaceHolderID="head" Runat="Server">
</asp:Content>

<asp:Content ID="Content2" ContentPlaceHolderID="CPMainContent" Runat="Server">
    <asp:DropDownList ID="AccountTypeDDL" runat="server" >
        <asp:ListItem>Resident Account</asp:ListItem>
        <asp:ListItem>Student Account</asp:ListItem>
        <asp:ListItem>University Account</asp:ListItem>
    </asp:DropDownList>

    <asp:Panel ID="CreateStudentAccountPanel" runat="server" >
        <asp:Label ID="Label1" runat="server" Text="Create Student Account"></asp:Label>
    </asp:Panel>

    <asp:Panel ID="CreateUniversityAccountPanel" runat="server">
        <asp:Label ID="Label2" runat="server" Text="Create University Account"></asp:Label>
    </asp:Panel>

    <asp:Panel ID="CreateResidentAccountPanel" runat="server">
        <asp:Label ID="Label3" runat="server" Text="Create Resident Account"></asp:Label>
    </asp:Panel>
</asp:Content>

<asp:Content ID="ScriptContent" ContentPlaceHolderID="CPClientScript" runat="server">
    <script type="text/javascript">

        $(function ()
        {
            alert('hi');
            //This hides all initial textboxes
            $('#CreateStudentAccountPanel').hide();
            $('#CreateUniversityAccountPanel').hide();
            $('#CreateResidentAccountPanel').hide();

            $('#AccountTypeDDL').change(function ()
            {
                //This saves some time by caching the jquery value
                var val = $(this).index.toString;
                //this hides any boxes that the previous selection might have left open
                $('Panel').hide();
                //This just opens the ones we want based off the selection
                switch (val)
                {
                    case '0':
                        $('#CreateResidentAccountPanel').show();
                        $('#CreateUniversityAccountPanel').hide();
                        $('#CreateStudentAccountPanel').hide();
                       break;
                    case '1':
                        $('#CreateStudentAccountPanel').show();
                        $('#CreateResidentAccountPanel').hide();
                        $('#CreateUniversityAccountPanel').hide();
                        break;
                    case '2':
                        $('#CreateUniversityAccountPanel').show();
                        $('#CreateStudentAccountPanel').hide();
                        $('#CreateResidentAccountPanel').hide();
                        break;

                }
            });

        });
    </script>
</asp:Content> 
```

谁能告诉我为什么我的 jQuery 代码无法隐藏非选定面板中的文本？我搞不清楚了。再次感谢。

编辑抱歉搞砸了最后一个帖子：

```
`code`
 var val = $('#<= AccountTypeDDL.ClientID %>').index;
                //this hides any boxes that the previous selection might have left open
                $('Panel').hide();
                //This just opens the ones we want based off the selection
                switch (val)
                {
                    case 0:
                        $('#<%= CreateResidentAccountPanel.ClientID %>').show();
                        $('#<%= CreateStudentAccountPanel.ClientID %>').hide();
                        $('#<%= CreateUniversityAccountPanel.ClientID %>').hide();
                       break;
                    case 1:
                        $('#<%= CreateResidentAccountPanel.ClientID %>').hide();
                        $('#<%= CreateStudentAccountPanel.ClientID %>').show();
                        $('#<%= CreateUniversityAccountPanel.ClientID %>').hide();
                        break;
                    case 2:
                        $('#<%= CreateResidentAccountPanel.ClientID %>').hide();
                        $('#<%= CreateStudentAccountPanel.ClientID %>').hide();
                        $('#<%= CreateUniversityAccountPanel.ClientID %>').show();
                        break; 
```

`code`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T16:49:20.353

您是否尝试过使用`ClientID`

```
 $('#<%= CreateStudentAccountPanel.ClientID %>').hide();
 .... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-20T06:46:39.110

在良好的 JavaScript 调试器（例如 FireBug）中加载页面，然后尝试使用控制台通过运行以下行来隐藏部分：

```
$('#CreateResidentAccountPanel').hide() 
```

如果这不起作用，请使用 FireBug 的 html 检查器查看面板 div 的实际 ID。Asp.Net 倾向于添加它自己的垃圾 ID，除非您明确告诉它不要这样做。为避免这种情况，`ClientIDMode="Static"`请在面板标签定义中添加一个属性：

```
<asp:Panel ID="CreateResidentAccountPanel" ClientIDMode="Static" runat="server">
    <asp:Label ID="Label3" runat="server" Text="Create Resident Account"></asp:Label>
</asp:Panel> 
```

我通常对所有我知道我将通过 jQuery 操作的 ID 使用静态 - 它使生活变得更加简单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T16:51:16.947

我认为你应该使用类似的东西`#<%= CreateUniversityAccountPanel.ClientID %>` 作为你的选择器。

# c# - 无法通过 ID 找到 asp 复选框

> ID：11565532
> 
> 赞同：0
> 
> 时间：2012-07-19T16:47:11.380
> 
> 标签：c#, asp.net, findcontrol

我无法使用 FindControl 方法在我的 asp Web 应用程序上找到 asp:checkbox。我使用以下方法在表单上放置了一个复选框：

```
<asp:CheckBox ID="test" Text="Test checkbox" runat="server" /> 
```

在我的代码隐藏中，我有以下内容：

```
Control checkbox = FindControl("test");
if (checkbox != null) Debug.Print("checkbox found");
else Debug.Print("checkbox not found");

if (test.Checked) Debug.Print("checkbox is checked");
else Debug.Print("checkbox is unchecked"); 
```

但是我的输出（选中复选框）是：未找到复选框复选框已选中

有人可以告诉我我做错了什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T17:08:56.447

该`FindControl`方法**不是递归**的，只有在复选框的**直接父**级上调用它时才会找到您的控件。因此，例如，如果复选框被放置在一个`UpdatePanel`也在页面内的内部；你需要调用`FindControl`而`UpdatePanel`不是`Page.FindControl`像你正在做的那样。

您的输出显示的原因是：`checkbox not found checkbox is checked`是因为您`test.checked`直接调用，这将始终有效，因为这是您为复选框提供的 ID。

同样，`FindControl`它不是递归的，我很肯定这就是它失败的原因。您可以编写自己的“RecursiveFindControl”方法，但这几乎总是矫枉过正且效率低下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T17:09:51.293

您可以使用递归方法通过以下方式找到控件：

```
private Control RecursiveFindControl(Control root, string id)
{
    if (root.ID == id) return root;
    foreach (Control c in root.Controls)
    {
        Control t = RecursiveFindControl(c, id);
        if (t != null) return t;
    }
    return null;
} 
```

使用上面的递归方法找到控件：

```
CheckBox checkbox =  RecursiveFindControl(Page, "test") as CheckBox;
if (checkbox != null) Debug.Print("checkbox found");
else Debug.Print("checkbox not found");

if (test.Checked) Debug.Print("checkbox is checked");
else Debug.Print("checkbox is unchecked"); 
```

# java - 当我运行以下代码时，它给了我一个 NullPointerException – 我该如何修复它？

> ID：11565536
> 
> 赞同：1
> 
> 时间：2012-07-19T16:47:21.563
> 
> 标签：java

我有以下名为 sendAttachment.java 的类，还有 Piechart.java 和covertExcelTOCSV.java。我正在阅读一个将其转换为 csv 的 els 文件，然后让饼图读取数据，制作饼图保存它，然后将其发送到电子邮件附件中。波纹管类 sendAttachment.java 给了我一个空指针异常，我不知道如何解决它有人可以帮忙吗？

我得到的错误是这个

```
Exception in thread "main" java.lang.NullPointerException
    at javax.mail.internet.MimeUtility.getEncoding(MimeUtility.java:226)
    at javax.mail.internet.MimeUtility.getEncoding(MimeUtility.java:299)
    at javax.mail.internet.MimeBodyPart.updateHeaders(MimeBodyPart.java:1375)
    at javax.mail.internet.MimeBodyPart.updateHeaders(MimeBodyPart.java:1021)
    at javax.mail.internet.MimeMultipart.updateHeaders(MimeMultipart.java:419)
    at javax.mail.internet.MimeBodyPart.updateHeaders(MimeBodyPart.java:1354)
    at javax.mail.internet.MimeMessage.updateHeaders(MimeMessage.java:2107)
    at javax.mail.internet.MimeMessage.saveChanges(MimeMessage.java:2075)
    at javax.mail.Transport.send(Transport.java:123)
    at de.vogella.jfreechart.swing.pie.sendAttachment.main(sendAttachment.java:61) 
```

我的代码

```
package de.vogella.jfreechart.swing.pie;

import java.io.IOException;
import java.util.Properties;

import javax.activation.DataHandler;
import javax.activation.DataSource;
import javax.activation.FileDataSource;
import javax.mail.Message;
import javax.mail.MessagingException;
import javax.mail.Multipart;
import javax.mail.Session;
import javax.mail.Transport;
import javax.mail.internet.AddressException;
import javax.mail.internet.InternetAddress;
import javax.mail.internet.MimeBodyPart;
import javax.mail.internet.MimeMessage;
import javax.mail.internet.MimeMultipart;

public class sendAttachment
{

    public static void main(String[] args) throws AddressException, MessagingException, IOException
    {
        String host = "relay.apple.com";
        String from = "jsherif@apple.com";
        String to = "techjomana@gmail.com";

        // Get system properties
        Properties props = System.getProperties();

        // Setup mail server
        props.put("mail.smtp.host", host);

        // Get session
        Session session = Session.getDefaultInstance(props, null);

        // Define message
        MimeMessage message = new MimeMessage(session);
        message.setFrom(new InternetAddress(from));
        message.addRecipient(Message.RecipientType.TO, new InternetAddress(to));
        message.setSubject("Important Message From VMO");
        message.setText("Please see the attached Chart");

        // Handle attachment 1
        MimeBodyPart messageBodyPart1 = new MimeBodyPart();
        messageBodyPart1.attachFile("/Users/jomanasherif/Documents/mychart.jpg");

//        // Handle attachment 2
//        MimeBodyPart messageBodyPart2 = new MimeBodyPart();
//        messageBodyPart2.attachFile("c:/Temp/b.txt");

        MimeMultipart multipart = new MimeMultipart("mixed");

        multipart.addBodyPart(messageBodyPart1);
       // multipart.addBodyPart(messageBodyPart2);

        message.setContent(multipart);

        // Send message
        Transport.send(message);
        System.out.println("message sent");

    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T08:42:21.200

添加这个：

```
fileDataSource.getOutputStream().close(); 
```

在您的代码中创建和使用`FileDataSource`对象之后。它应该解决问题（假设 fileDataSource 是 FileDataSource 对象）

退房： http: [//kenai.com/projects/javamail/sources/mercurial/content/mail/src/main/java/javax/mail/internet/MimeUtility.java ?rev=469](http://kenai.com/projects/javamail/sources/mercurial/content/mail/src/main/java/javax/mail/internet/MimeUtility.java?rev=469)

此外，如果您在多部分消息中发送附件，请先尝试将它们压缩到您的代码中，然后发送 . 您在这个问题中遇到了编码问题，这些编码器对`.zip`s 很友好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T09:19:01.330

无法读取附件时会发生此错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T17:19:49.553

NullPointerException 是在 MimeUtility （第 226 行）中引发的，而不是在您发布的类中（尽管问题可能源于您的代码）。

看起来它与编码有关。如果无法深入研究代码，就很难知道。有些东西你可以尝试...

创建 MimeMultipart 时尝试删除参数：

```
MimeMultipart multipart = new MimeMultipart(); 
```

尝试附加不同类型的文件，例如文本文件。也许它无法检测到“jpg”文件的适当编码。

# javascript - 将纪元日期转换为有意义的 Javascript 日期

> ID：11565540
> 
> 赞同：5
> 
> 时间：2012-07-19T16:47:27.257
> 
> 标签：javascript, date, epoch

我`"/Date(1342709595000)/"`在 JSON 中得到一个字符串值。我试图单独提取数字并将纪元日期转换为有意义的 Javascript 日期，格式为 mm/dd/yy hh:mm:ss 。我能够实现提取数字的问题的第一部分，但无法将其转换为[http://www.epochconverter.com/中可用的日期对象人类可读格式](http://www.epochconverter.com/)

JS 小提琴：http: [//jsfiddle.net/meetravi/QzKwE/3/](http://jsfiddle.net/meetravi/QzKwE/3/)

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-19T16:53:46.930

你真的不需要做任何事情，它们已经是自纪元以来的毫秒数，而 JavaScript 日期自纪元以来需要数毫秒。

[http://jsfiddle.net/QzKwE/9/](http://jsfiddle.net/QzKwE/9/)

```
var dateVal ="/Date(1342709595000)/";
var date = new Date(parseFloat(dateVal.substr(6)));
document.write( 
    (date.getMonth() + 1) + "/" +
    date.getDate() + "/" +
    date.getFullYear() + " " +
    date.getHours() + ":" +
    date.getMinutes() + ":" +
    date.getSeconds()
); 
```

​</p>

# c++ - 返回枚举或通过引用传递枚举？

> ID：11565542
> 
> 赞同：1
> 
> 时间：2012-07-19T16:47:33.113
> 
> 标签：c++, enums

我有一个执行某些任务的过程，但根据其输入以两种略有不同的方式执行它。具体来说，它扩展了后缀树中的后缀；如果后缀在一个节点处结束，情况很简单，但是当后缀在叶边缘内结束时，需要做一些额外的工作。我提到这个细节是为了解释为什么我将这两种行为包含在一个函数中（它反映了 Dan Gusfield 对 Ukkonen 后缀树构造算法的描述的“规则 2”：http: [//www.stanford.edu/~mjkay/gusfield .pdf](http://www.stanford.edu/~mjkay/gusfield.pdf)）。

无论如何，一旦函数完成了这项工作，调用者需要知道这两种情况中的哪一种被执行了。我认为枚举将是共享此信息的好方法，因为它使案例明确（而不是将案例任意映射到布尔或整数）。

TLDR：要与调用者共享信息，我应该通过引用此过程传递一个枚举还是返回一个枚举？我觉得通过引用传递枚举更好，因为它避免了“具有副作用的函数”，但想知道是否有通常“正确”的方式来做到这一点。或者，这是否真的表明我应该用两个单独的程序替换我的单个程序？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T16:52:23.697

在我看来，返回枚举更有意义，因为它是调用函数的结果。如果您将值传递给函数，并且该函数应该修改该值，则使用引用会更有意义。

您可以在 C++ 标准库中的[`insert`](http://en.cppreference.com/w/cpp/container/unordered_map/insert)方法中看到类似的示例：`unordered_map`

```
template <class P> 
std::pair<iterator, bool> insert( P&& value ); 
```

该方法返回一个布尔值（在一对内），说明该值是否插入到映射中。这实际上与您正在处理的案例非常相似。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T16:52:47.083

我认为最好将枚举作为函数的结果返回，因为它更具可读性且更易于编写：

```
MyEnum res = myfunc(); 
```

然后

```
MyEnum res;
myfunc(res); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-19T17:01:45.800

> 我觉得通过引用传递枚举更好，因为它避免了“具有副作用的函数”

恰恰相反，实际上......通常，如果你修改你的论点，那是一个副作用。

没有理由避免退回任何东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T17:05:10.543

当枚举存储在内存中时，它们只是整数值，编译器会强制检查用于枚举的值的范围。话虽如此，整数数据类型按值返回是高效且安全的。

除非您的函数确实返回多个值，否则调用者无需将枚举作为引用传递并取回结果。

```
YourEnum result
result = MyFunc() 
```

PS：我通常遵循的规则来决定是否应该返回一个值，或者让调用者传递一个指针/引用并返回值是返回的数据是简单的还是复杂的数据类型。;)

# c++ - vc++ mktime 制作错误的月份数

> ID：11565543
> 
> 赞同：2
> 
> 时间：2012-07-19T16:47:34.173
> 
> 标签：c++, visual-c++

我不知道我在下面的代码中犯了什么错误，但是使用 Visual c++ 2010 sp1，我粘贴在下面的代码结果显示了一个月的错误。

```
struct tm timeStamp;
timeStamp.tm_year = 2012 - 1900;
timeStamp.tm_mon = 7;
timeStamp.tm_mday = 19;
timeStamp.tm_hour = 20;
timeStamp.tm_min = 55;
timeStamp.tm_sec = 22;
timeStamp.tm_isdst = -1;

time_t time_val = mktime(&timeStamp);

const int buff_size = 20;
char buff[buff_size] = {0};
strftime(buff, buff_size, "%Y-%m-%d %H:%M:%S", localtime( &time_val ));

cout << "Original time:\t"
    << timeStamp.tm_year + 1900 << "-" << timeStamp.tm_mon << "-" << timeStamp.tm_mday << " "
    << timeStamp.tm_hour << ":" << timeStamp.tm_min << ":" << timeStamp.tm_sec << endl;
cout << "Converted time:\t" << buff << endl; 
```

我编译时此代码的输出结果是：

```
Original time:  2012-7-19 20:55:22
Converted time: 2012-08-19 20:55:22 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T16:51:30.140

的`tm_mon`字段`struct tm`来自`0-11`，其中 0 == 一月和 11 == 十二月。`strftime`知道这一点并在内部进行补偿。你`cout`不能弥补这一点。

[C++ 参考](http://www.cplusplus.com/reference/clibrary/ctime/tm/)页面包含所有值范围的`struct tm`定义。

# maven - Maven 部署忽略由 maven-versions 插件设置的项目版本

> ID：11565548
> 
> 赞同：8
> 
> 时间：2012-07-19T16:47:47.223
> 
> 标签：maven, parameters, jenkins, nexus

我有一个 Maven 项目“核心”。在项目的 pom.xml 中，版本为 0.1。我在 Jenkins 中使用参数化构建并设置文本参数 myNewVersion=3.1。我还设定了以下 Maven 目标：

```
versions:set -DnewVersion=${myNewVersion} versions:commit deploy 
```

构建时，maven 将 pom.xml 中的版本正确更新为“3.1”。然而，maven 部署任务将我的项目部署为“core-0.1”，版本仍然是 0.1。我的 Nexus 中相应 0.1 目录中包含的 pom 文件声明版本号“3.1”。

我能做些什么来强制 maven 部署任务使用 maven 版本插件设置的正确版本？

非常感谢您的帮助。

**编辑 1：** 澄清我的需求：POM 中的项目版本不应说明实际的构建版本。我用它来确定我的“核心”项目与底层系统和 API 的兼容性。更详细地说：项目“core”从 jenkins 获取“interfaceVersion=3.1”或“interfaceVersion=4.0”参数。这决定了我的核心项目使用哪个版本来依赖另一个“库”包。

现在，我有两个 Jenkins 构建作业，一个用于 3.1，另一个用于核心项目的 4.0 库项目依赖项。每个都从 SVN 签出相同的项目代码，但将不同的版本参数传递给正在构建的“核心”项目。我想在 pom.xml 中使用这个版本号作为我项目的版本号，并作为我的 jar 的版本号部署到 nexus（即 core-3.1.jar 或 core-4.0.jar）。

**编辑2：** 我走得更远了。我只是使用我在 jenkins 中设置的版本参数作为参数化构建部分中的参数作为 pom 文件中项目的版本号。Maven 警告这样做，但它有效。但是，我所有依赖于“core”的项目现在也需要将“${myNewVersion}”指定为依赖版本。

所以我尝试再次使用versions-maven-plugin来设置/覆盖pom文件中的版本，就像我上面所说的那样。但是，现在我在使用 Maven 部署时收到“拒绝访问”错误。如果我删除“versions:set -DnewVersion=${myNewVersion}versions:commit”并只使用“deploy”，它就可以工作。任何线索如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-10-26T10:31:03.933

对于任何有同样问题的人，我有同样的问题，它与`versions`插件和使用[Aggregator POM](https://maven.apache.org/pom.html#Aggregation)有关。版本更改未传播到未将其父项设置为聚合器 pom 的子项目。

这可以通过[扩大](http://www.mojohaus.org/versions-maven-plugin/examples/set.html#Widening_the_scope_of_the_change)范围来解决`versions:set`，例如：

```
versions:set -DgroupId=com.company.* -DartifactId=* -DnewVersion=${myNewVersion} versions:commit deploy 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-09-06T20:21:12.300

在您的 pom.xml 中，将版本设置为变量，如下所示：

```
<version>${version}</version> 
```

然后运行maven

```
mvn deploy -Dversion=${myNewVersion} 
```

# mysql - 使用“WHERE UNIX_TIMESTAMP(date)”的 SQL 查询的性能

> ID：11565550
> 
> 赞同：3
> 
> 时间：2012-07-19T16:47:53.870
> 
> 标签：mysql, sql, performance

我正在运行一个 MySQL 服务器（5.5），它有一个大表（大约 10M 记录）。该表是某种日志，在 2 列上有一个主键：

```
id <- integer,
date <- datetime 
```

连接到该数据库的应用程序正在发送一个查询，内容如下：

```
SELECT * FROM bigtable  
INNER JOIN other_table
ON ....
WHERE UNIX_TIMESTAMP(date) BETWEEN #somevalue# AND #somevalue2#; 
```

我发现这个查询需要很长时间才能执行。我知道某些功能可以阻止 MySQL 使用索引并使其执行全表扫描。

问题：在主键列上使用函数 UNIX_TIMESTAMP 是否会影响性能，如图所示，而不是***“... WHERE date BETWEEN '2012:01:01 00:00:00' AND '2012:02:01 00:00:00'"*** ?

查询：

```
SELECT r.f_registro, r.latitud, r.longitud, r.velocidad, r.status, r.odometro, r.heading, r.sensor, a.nombre FROM registros r INNER JOIN activos a ON a.id_tracker = r.id_tracker WHERE a.id_activo = 2366 AND r.satelites > '3' AND UNIX_TIMESTAMP(r.f_registro) BETWEEN 1342159200 AND 1342760400 ORDER BY r.f_registro 
```

执行需要几秒钟甚至几分钟！运行解释返回：

```
id,select_type,table,type,possible_keys,key,key_len,ref,rows,Extra
1,SIMPLE,a,const,PRIMARY,PRIMARY,4,const,1,"Using filesort"
1,SIMPLE,r,range,"id_tracker,satelites",satelites,4,NULL,1,"Using index condition; Using where" 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-19T20:29:06.107

您是正确的，在日期列上使用函数会阻止 MySQL 使用列上的索引。

相反，将范围计算为两个日期常量并使用 BETWEEN。

另外，请注意，您没有指出日期列上有索引。索引保留最前缀，因此以 id 开头的复合索引不能用于仅要求日期的查询。

查询的 ON 部分（您已排除）可能对查询的性能同样重要，您应该评估它是否也能够使用索引。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-11-10T18:06:20.433

如果您的日期范围必须是 UNIX 时间，您可以更改：

```
UNIX_TIMESTAMP(r.f_registro) BETWEEN 1342159200 AND 1342760400 
```

到：

```
r.f_registro BETWEEN FROM_UNIXTIME(1342159200) AND FROM_UNIXTIME(1342760400) 
```

这将大大加快查询速度。就我而言（有 3.8 亿行和索引日期的列），这表示从几小时到几毫秒的变化。

# java - 在 Java 中计算 HashMap 开销

> ID：11565554
> 
> 赞同：4
> 
> 时间：2012-07-19T16:48:02.317
> 
> 标签：java, memory-management, data-structures, hashmap, overhead

假设我在哈希图中存储了 1000 个对象。这个 hashmap 被扩展为允许我将三维坐标映射到存储在其中的对象；里面的对象有固定的大小。哈希键是一个长整数。

我将如何计算（数学上）这个结构的可能开销？

1.  例如，如果内部数据约为 256mb，那么开销是否重要？
2.  有没有一种可靠的方法（除了我发现在某些情况下不可靠的分析器）来数学计算它的开销*应该是*多少？

我对哈希图的总大小不感兴趣——只有使用哈希图会产生的*开销*。例如，如果我有 10 个整数，它们是 4 个字节，所以是 40 个字节。如果我将它们放在一个数组中，我会得到 12 个字节的恒定开销 - 对象标头为 8 个字节，长度为 4 个字节。如果我将它们放在另一个结构中（例如 TreeSet），我的开销将不会是恒定的，因为树需要节点 - 所以我可能会得到以 n 表示的开销，其中 n 是集合中的项目数。

有几件事对我来说是显而易见的，我将在这里作为我的起点。

1.  我需要存储至少 1000 条长条。这些是可为空的类型，因此它们实际上是对象。因此，我假设正在使用的 8 字节长整数也有一个 8 字节的对象头。我将添加一个 16n 的因子。
2.  我还需要对每个对象的引用，无论该对象是否已从地图中调用并正在使用，这些引用都必须存在；所以这是每个对象额外的 8 个字节。我们可以将其计入数据大小，但由于引用在 hashmap 本身中，我觉得最好将它们作为开销的一部分。我的逻辑如下：如果我从 hashmap 中取出所有数据并将其存储在变量中，那么这些 n 引用仍然存在于 hashmap 中，前提是我没有*删除*这些数据对象，我不会这样做. 对象集是恒定的，尽管它们可以用不同的键回收。
3.  hashmap 本身有 8 个字节的开销。
4.  hashmap*必须*存储里面的项目数（或者我认为！）所以这是 4 个字节。
5.  我会无知地假设哈希键在一个数组中，按哈希键顺序排序。数组有 12 个字节。
6.  我也会无知地假设对象位于匹配的数组中，当它找到键时它会取消引用。我会猜另外 12 个字节。

这给了我一个多项式方程：36 + 24n

因此，我猜测使用长键的 1000 个数据对象的开销为 24036 字节。这是一个微不足道的开销，但我的问题是，真正的开销是什么，只是坐在那里？

* * *

第二个有效的问题是，这从 JVM 到 JVM 有多大不同？有没有任何独立于JVM的方法来解决它？为了举例说明我的意思，考虑一个只有 32 位对象头的 JVM - 当查看数组时，您可能会说，即使大小因 JVM 不同而异，但公平估计数组的开销将变为 8 个字节而不是12 在这种情况下。

我假设 HashMap 跨相同版本的 Java 的固定实现。

* * *

我可以尝试阅读源代码或运行分析，但这可能会根据我的 JVM 产生误导性结果。我正在寻求你的帮助——也许是知道的人——提供一些我们都不知道的信息。谢谢！

* * *

看下面的答案，实际估计可以表示如下：

每个条目 8 个字，每个 long 加上 8 个字节，以及 hashmap 对象标头的 8 个字节。

在我目前的环境（32 位操作系统）中，1 个字 = 4 个字节。

*   32 位环境中的 40n + 8：1000 个条目约 40k
*   在 64 位环境中为 72n + 8：1000 个条目约为 72k。

所以它似乎低于 100kbytes。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T17:22:04.500

以下[博客文章](http://code-o-matic.blogspot.com/2012/02/updated-memory-cost-per-javaguava.html)提供了有关该主题的一些松散数学。
这个[谷歌代码网站](https://code.google.com/p/memory-measurer/wiki/ElementCostInDataStructures)提供了这些事情是如何完成的。

在链接腐烂的情况下引用链接：

```
This is the cheat-sheet I compiled.

To compute the cost of a single (key, value) entry:

    If you use HashMap or ConcurrentHashMap, the cost is 8 words (32 bytes)

 So, consider this example from the javadoc:

   LoadingCache graphs = CacheBuilder.newBuilder()
       .maximumSize(10000)
       .expireAfterWrite(10, TimeUnit.MINUTES)
       .removalListener(MY_LISTENER)
       .build(
           new CacheLoader() {
             public Graph load(Key key) throws AnyException {
               return createExpensiveGraph(key);
             }
           });

The cost of an Entry in this structure this is computed as follows:

    It's a Cache: +12 words
    It uses maximumSize(): +4 words
    It uses expiration: +4 words

Thus, each (key, value) entry would have a footprint of 20 words (thus 80 bytes in a 32bit VM, or 160 in a 64bit one). 

To estimate the overhead imposed in the garbage collector, one could count how many references (pointers) each entry introduces, which the garbage collector would have to traverse to compute object reachability. The same list again, this time only counting references:

    If you use HashMap or ConcurrentHashMap, the cost is 5 references 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T17:00:33.533

创建一个程序，在其中创建所有对象并将它们存储在一个简单的数组中。测量使用的内存（参见[运行时](http://docs.oracle.com/javase/6/docs/api/java/lang/Runtime.html)）。

然后将它们存储在 HashMap 中。测量使用的内存。

将第一个测量的内存减去第二个使用的内存，你就有了 HashMap 的开销。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-20T10:09:09.297

> 1.  例如，如果内部数据约为 256mb，那么开销是否重要？

当然不。HashMap 中的 1000 个对象的开销在任何情况下都不值得担心：如果它们总共是 256mb，那就更少了。如果开销是 256k，而事实并非如此，那只会是 1%。不重要。

> 1.  有没有一种可靠的方法（除了我发现在某些情况下不可靠的分析器）来数学计算它的开销应该是多少？

鉴于我对（1）的回答，这个问题没有实际意义。

# php - 如何使用 jQuery 将 Div 的内容更改为不同的 PHP 文件 - 使用超链接 - 不刷新页面

> ID：11565557
> 
> 赞同：0
> 
> 时间：2012-07-19T16:48:07.107
> 
> 标签：php, jquery

如何使用 jQuery 将 Div 的内容更改为不同的 PHP 文件 - 使用超链接 - 不刷新页面

假设我有一个 id 为 statsdiv 的 div

然后假设我有这些页面：

page1.php page2.php page3.php

和3个链接。

第 1 页 | 第 2 页 | 第3页

我需要它在第一次打开文档时预加载 page1，然后我需要能够在页面的 1 div 内更改为 page1、page2 或 page3 而无需刷新页面。

我还需要该 div 每 5 秒刷新一次。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:56:55.167

您可以使用 iframe，这些框可以在其中加载完整页面而无需太多工作。

但是，我建议您使用 AJAX。每次该人单击您的链接时，您都会使用 jquery 创建一个 javascript 函数

$('#statsdiv').load('page1.html');

如果我没记错的话，这不应该重新加载整个页面，而只是你的 div。如果我错了，请告诉我，因为我现在无法尝试我的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T17:03:54.947

试试这个，我认为你的 div 有一个统计 id (#stats)，并且页面有 page1.php、page2.php 和 page3.php 之类的链接。最初它将加载 page1.php，稍后 onclick 事件将更改页面。

```
<!DOCTYPE html>
 <html lang="en">
 <head>
<meta charset="utf-8">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script type="text/javascript">
    $(function(){

        // for initial load
        pageUrl = 'page1.php';
        // after clicking links
        $('#page2').click(function(){
            pageUrl = 'page2.php';
            LoadingPages(pageUrl);
        })

        $('#page3').click(function(){
            pageUrl = 'page3.php';
            LoadingPages(pageUrl);
        })

        $('#page1').click(function(){
            pageUrl = 'page1.php';
            LoadingPages(pageUrl);
        })

        function LoadingPages(pageUrl)
        {
            $('#stats').load(pageUrl);
        }
        int = setInterval(function(){
            LoadingPages(pageUrl)
        },5000);

    })
</script>
  </head>
  <body>
<div id="stats"></div>

<a href="#" id="page1"> Page 1</a>
<a href="#" id="page2"> Page 2</a>
<a href="#" id="page3"> Page 3</a>

  </body>
  </html> 
```

# python - 每次抓取后如何阻止scrapy覆盖CSV导出文件

> ID：11565558
> 
> 赞同：0
> 
> 时间：2012-07-19T16:48:07.600
> 
> 标签：python, scrapy

目前，我使用 scrapy 爬取网页的多个页面并将数据导出到 CSV 文件。每天，蜘蛛都会爬取页面并保存数据；但是，它将覆盖前几天的数据。我想知道如何对管道进行编程，以便它从文件末尾开始写入同一个文件中的 CSV。通过这种方式，我可以将所有以前抓取的数据保存在一个地方。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T17:49:10.503

通常只需将打开文件例程中的参数更改为追加

改变

```
f = open('filename.txt','w') 
```

至

```
f = open('filename.txt','a') 
```

当然，如果我们能看到您的原始代码，这将有助于我们更加具体。

# c# - 在 C# 中测试/注入私有字段的好习惯是什么

> ID：11565560
> 
> 赞同：3
> 
> 时间：2012-07-19T16:48:22.747
> 
> 标签：c#, unit-testing, tdd, code-coverage

如果这是重复的，我深表歉意。我被赋予了为该方法添加一些覆盖范围的任务，并被告知要模拟私有`List<string>`属性。我的问题是：**有没有办法测试私有字段？**

我找到的解决方案是添加新的构造函数来注入这个私有列表。我不确定这是否是正确的方法，所以任何帮助将不胜感激。

```
public class Class1
{
    public Class1(List<string> list)//This is just for Unit Testing 
    {
        list1 = list;
    }

    private readonly InjectRepository _repository;
    //
    public Class1(InjectRepository repository)//This is the actual constructor
    {
        _repository = repository;
    }

    private List<string> list1 = new List<string>();

    public void Do_Complex_Logic()
    {
       //list1 will be set with items in it
       //Now list1 is passed to some other instance
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T16:58:17.933

一个类的私有逻辑应该在其行为的公共表达中是可见的。换句话说，理论上，根本不需要测试私有字段。

没有办法直接测试私有字段；毕竟他们是私人的。如果您确实认为需要测试私有字段，那么我建议将其改为内部字段，并通过[[InternalsVisibleTo]](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.internalsvisibletoattribute.aspx)属性将其公开给您的单元测试程序集。

话虽如此，有些框架允许这样的事情，例如[TypeMock](http://www.typemock.com/)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-19T17:04:07.180

不要测试*私有*字段或方法。测试合约的行为 - 公共或内部方法。

也就是说，您可以尝试：

**选项 A**
使*私有*成员成为*内部*成员并[`InternalsVisibleTo`](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.internalsvisibletoattribute.aspx)为被测程序集设置属性。

**选项 B**
编写一个包装类，将您的私有字段/方法包装到公共字段/方法中。这种方法的好处是您不需要将私有方法设为内部。不利的一面是，对于每个私有方法，您都将拥有一个包装器公共方法。所以方法的数量可能会翻倍。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-19T17:14:16.200

添加到 womp & oleksii 已经说过的内容 -

您想要/需要测试私有方法的事实是您的设计可能不正确的标志（气味？）。这是 TDD 的积极副作用之一（也是我个人最喜欢的）。

一个例子：

我在这里不完全了解您的域，但是一个简单的更改可能是，而不是不`Do_Complex_Logic`接受任何参数，您可以让它接受并返回 a `List<string>`：

`public List<string> Do_Complex_Logic( List<string> input )`

我知道 - 这很*简单*，但请尝试稍微解构您的课程，并首先考虑测试并重新构建它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-19T17:09:53.913

我并不反对其他答案；但在这种情况下，我认为最合适的做法是 - 给定您的代码；是改变签名

'Do_Complex_Logic'

真正的问题是您正在处理 List1 的“状态”。如果您将 List1 传递给 Do_Complex_Logic - 您的问题基本解决了。您的评论说“Do_Complex_Logic”将（大概）在 List1 上做一些工作，然后将其传递给其他东西，对吗？

使 Do_Complex_Logic 获取一个列表并返回一个列表。现在很容易测试。您可以“注入依赖项”，而不是依赖于您的班级中正确设置的 List1 的状态。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-20T01:13:27.333

私有领域如何首先做好准备？如果是通过与存储库的交互，那么您可能会模拟该对象。

一种方法是通过接口与您的存储库进行交互（让我们称之为它`IInjectRepository`而不是具体实体，然后使用类似[Moq](http://code.google.com/p/moq/)的东西（或那里的众多模拟框架之一）通过模拟填充您的数据' d存储库，因为你设置你的测试。在你打电话后，`Do_Complex_Logic`我假设你有一种询问实体的方法，以便你知道它已经完成了你期望的事情。这样你可以避免/减轻添加仅用于测试的方法和类.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-02-17T14:43:39.810

您可以在回答相关问题的[https://stackoverflow.com/a/3376157/1523402时使用](https://stackoverflow.com/a/3376157/1523402)**反射。** 我不知道私有访问器是否也适用于私有字段。但它们（至少）有助于私有方法（参见[http://msdn.microsoft.com/en-us/library/ms184807%28v=vs.80%29.aspx](http://msdn.microsoft.com/en-us/library/ms184807%28v=vs.80%29.aspx)）。

# javascript - 将变量从一个 JS 文件发送到另一个 JS 文件

> ID：11565561
> 
> 赞同：0
> 
> 时间：2012-07-19T16:48:26.667
> 
> 标签：javascript, jsp

我有 ABC.jsp 文件和相应的 ABC.js 文件。我也有 XYZ.jsp 文件和相应的 XYZ.js 文件。我在 ABC.js 文件中有一个变量 VAR。我想通过 Post 方法将该变量发送到 XYZ.js 文件，以便我可以使用 XYZ.js 中的变量 VAR 进行一些计算。这些计算将帮助我更改 XYZ.jsp 文件的内容。

我想在单击 ABC.jsp 上的按钮时调用的 javascript 函数（显然在 ABC.js 文件中）发送变量 VAR。

那么，任何人都可以帮助我通过 post 方法将变量从 ABC.js 发送到 XYZ.js。以及如何检索 XYZ.js 文件中的变量。

我是这个领域的新手。任何帮助都会对我有很大帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T23:49:11.523

使用变量制作您的 ABC.js 脚本，以通过 GET 方法将其传递给 XYZ.jsp 页面

```
XYZ.jsp?variable=1234 
```

比，当 XYZ.jsp 使用传递的 'variable' 参数呈现时，它会在某处呈现这个变量......甚至作为全局 JavaScript 变量。

// 这将在 JSP 中呈现，您只需从传递给 JSP 页面的参数中分配值

```
<script>
    myVariable="1234";   // in JPS   myVariable=\"${param.variable}\";
</script> 
```

从你的 ABC.js 脚本中读取 myVariable

# python - Paypal Sandbox 和 Google App Engine 的身份验证错误

> ID：11565563
> 
> 赞同：2
> 
> 时间：2012-07-19T16:48:27.433
> 
> 标签：python, google-app-engine, paypal, paypal-adaptive-payments

我无法让 Paypal Adaptive Payments API 与 GAE 一起使用 - 我将专门使用 Implicit Payments。

返回的错误是我的 api 凭据不正确，但从我读过的内容来看，我也应该怀疑标题格式。

这是代码片段 - 我在 GAE 中使用 urlfetch 模块：

```
headers = {
        "X-PAYPAL-USERID"               : "xxxx_123456789_biz_api1.xxxx.com",
        "X-PAYPAL-SECURITY-PASSWORD"    : "1234567890",
        "X-PAYPAL-SECURITY-SIGNATURE"   : "Ahg-XXXXXXXXXXXXXXXXXXXXXX",
        "X-PAYPAL-REQUEST-DATA-FORMAT"  : "JSON",
        "X-PAYPAL-RESPONSE-DATA-FORMAT" : "JSON",
        "X-PAYPAL-APPLICATION-ID"       : "APP-80W284485P519543T"
    }

request_body = {
        "actionType"                        : "PAY",
        "senderEmail"                       : "xxxx_123456789_biz_api1@xxxx.com",
        "receiverList.receiver(0).email"    : "xxxx_123456789_per@xxxx.com",
        "receiverList.receiver(0).amount"   : 100.00,
        "currencyCode"                      : "USD",
        "cancelUrl"                         : "some_url.com",
        "returnUrl"                         : "some_url.com",
        "requestEnvelope.errorLanguage"     : "en_US"

    }

url = "https://svcs.sandbox.paypal.com/AdaptivePayments/Pay"

result = urlfetch.fetch(url=url,payload=request_body,headers=headers) 
```

我已经删除了一些值，但我使用的所有内容都来自沙箱“API 凭据”部分。

标题格式有问题吗？我是否使用了错误的凭据集？我什至可以使用沙盒来测试隐式付款吗？

任何帮助深表感谢。谢谢！

对于任何有类似问题的人，请按照此处的*优秀*教程进行操作： [Awesome Paypal Adaptive Payments Tutorial](http://blog.widenhome.com/2012/01/27/paypal-adaptive-payments-api-integration-a-step-by-step-tutorial/) 如果不正确形成标题，则往往会导致身份验证错误。我离得很远:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-09-15T10:33:41.137

转到您的标题，并进行这样的更改

钥匙

> 'X-PAYPAL-用户 ID'

应该成为

> 'X-PAYPAL-SECURITY-USERID'。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T08:26:13.183

您忘记在`urlfetch.fetch`调用中设置 POST 方法；没有它，[有效载荷数据将被忽略](http://code.google.com/p/googleappengine/source/browse/trunk/python/google/appengine/api/urlfetch.py)。

```
result = urlfetch.fetch(url=url, 
                        payload=request_body, 
                        method=urlfetch.POST, 
                        headers=headers) 
```

`urllib2.Request`设置请求数据时，教程中使用的会自动[从](http://docs.python.org/library/urllib2.html#urllib2.Request)GET 切换到 POST。

```
req = urllib2.Request(self.request_url,paypal_request_data,header_data) 
```

# jsf-2 - PrimeFaces：如何以编程方式声明 AJAX“rowEdit”事件并将其绑定到 p:dataTable？

> ID：11565566
> 
> 赞同：1
> 
> 时间：2012-07-19T16:48:40.647
> 
> 标签：jsf-2, datatable, primefaces

我还在开发我的数据表 UI 应用程序，最后我讲到这个组件开发的最后阶段：内联单元格编辑。

首先，数据表是在Java端完全动态构建的，没有使用facelet声明来描述表。如果我有一个静态表声明，可以[像这样](http://www.primefaces.org/showcase-labs/ui/datatableEditing.jsf)指定编辑（请参阅 In-Cell Editing 章节）：

```
<p:dataTable>
    ...
    <p:ajax event="rowEdit" listener="#{tableBean.onEdit}"/>  
    ...
</p:dataTable> 
```

我可以轻松地`dataTable.setEditable(true)`在 Java 代码中指定可编辑的数据表 - 它可以工作，请注意，编辑保存/取消图标运行良好，但在后端没有效果。由于我不能以 PF ShowCase Labs 页面上指定的方式声明（我必须始终使用那里的侦听器吗？），因为数据表是动态呈现的，所以我尝试使用以下内容：

```
public static AjaxBehavior createAjaxBehavior(MethodExpression expression) {
    final AjaxBehavior behavior = new AjaxBehavior();
    behavior.addAjaxBehaviorListener(new AjaxBehaviorListenerImpl(expression));
    return behavior;
}
...
dataTable.addClientBehavior("rowEdit", createAjaxBehavior(createMethodExpression(TableBean.class, "onEdit", void.class, new Class<?>[] {RowEditEvent.class}))); 
```

但是，一旦我添加了`rowEdit`侦听器，就像我在上面尝试做的那样，哇，我突然得到：`mojarra is not defined`并且没有保存/取消行编辑按钮正在工作。好的，我发现[这里](https://stackoverflow.com/a/9263184/166589)描述并解决了类似的问题，手动包含必要的脚本，现在客户端 JavaScript 错误消失了，但是*我仍然无法退出行编辑模式，并且行仍然没有更新*。

我浪费了一整天试图弄清楚发生了什么，而且我看不到正确的方法。我是否只是错过了后面的某些内容（例如*识别某行*，或者可能在*某处指定了其他内容*——但我的 Java 代码没有生成超出 PF 示例中指定的任何内容），或者其他任何内容？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T13:47:43.103

好吧，我刚刚在以下方法中找出了真正的原因：

```
public static AjaxBehavior createAjaxBehavior(MethodExpression expression) {
    final AjaxBehavior behavior = new AjaxBehavior();
    behavior.addAjaxBehaviorListener(new AjaxBehaviorListenerImpl(expression));
    return behavior;
} 
```

事实上，该方法实际上返回`javax.faces.component.behavior.AjaxBehavior (h:ajax?)`而不是`org.primefaces.component.behavior.ajax.AjaxBehavior (p:ajax)`- 这是因为快速自动完成而发生的，所以我只是错过了这个事实。

我对 PrimeFaces 库没有回复任何错误感到沮丧。

* * *

只需完成问答：

*   莫哈拉 2.1.7
*   PrimeFaces 3.2

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2016-11-06T18:59:02.780

现在（至少对于 PF 6.0）应该是`org.primefaces.behavior.ajax.AjaxBehavior`.

# javascript - 添加两个数字的 JavaScript 函数无法正常工作

> ID：11565569
> 
> 赞同：-2
> 
> 时间：2012-07-19T16:48:50.113
> 
> 标签：javascript, html, function

我的 HTML 代码接受用户输入的数字，然后进行计算，然后显示输出。用户选择的输入被放入公式中，公式的结果被添加到用户输入的数字中，但是当它将两个数字加在一起时，它会添加一个小数点。

例如，如果选择了数字 11，则 Rchange 的结果是 0.22，因此 .22 然后添加 11 为 newResistance 的 11.22，但它显示的值改为 110.22。

```
function calc(form) {
    if (isNaN(form.resistance.value)) {
        alert("Error in input");
        return false;
    }
    if (form.resistance.value.length > 32) {
        alert("Error in input");
        return false;
    }
    var Rchange = .01 * 2 * form.resistance.value;
    var newResistance = (form.resistance.value + Rchange);
    document.getElementById("newResistance").innerHTML = chopTo4(newResistance);
}

function chopTo4(raw) {
    strRaw = raw.toString();
    if (strRaw.length - strRaw.indexOf("0") > 4) strRaw = strRaw.substring(0, strRaw.indexOf("0") + 5);
    return strRaw;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T16:51:59.957

试试`newResistance = +form.resistance.value + Rchange;`。这会将其转换为数字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T16:53:06.040

HTML DOM 元素属性始终是字符串。您需要在使用中将它们转换为数字。

```
parseInt(form.resistance.value);
parseFloat(form.resistance.value);
+form.resistance.value; 
```

（这三个中的任何一个都可以；我更喜欢前两个（使用 parseInt 除非你正在寻找一个浮点数）。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T16:54:11.670

这是因为它将值视为字符串。

form.resistance.value + Rchange 都是字符串，所以它正在附加它。

使用 parseInt JavaScript 方法获取十进制版本。

# java - 未登录时截取屏幕截图 (Windows Server 2000)

> ID：11565570
> 
> 赞同：0
> 
> 时间：2012-07-19T16:48:50.863
> 
> 标签：java, screenshot, render, jna

我已经使用 JNA 用 Ja​​va 编写了一个程序，因此我也可以执行 C 代码。

该程序启动一个 JFrame，确保窗口位于顶部，然后对窗口进行屏幕截图（使用 user32.dll 的 PrintWindow）。它将屏幕截图保存为 jpg 并退出。

它在我登录并自己启动程序时工作。我的问题是我希望程序在我未登录的某些时候在 Windows Server 2000 上自行运行。当这种情况发生时，Windows 似乎不会费心呈现窗口内容，窗口标题和边框会出现，但是窗口的内容是黑色的。

有谁知道如何欺骗 Windows 以为我已登录并专注于 JFrame 以便它实际呈现内容？启动某种桌面模拟器来启动我的程序是可以接受的。

脚注（题外话）：请制作它，以便我可以提问而无需再次创建帐户。这很麻烦，并使互联网变得更糟。

# javascript - 默认浏览器的拖动和移动功能

> ID：11565575
> 
> 赞同：1
> 
> 时间：2012-07-19T16:49:06.920
> 
> 标签：javascript, jquery, html

我有一个图像，我希望能够通过在页面上拖动来移动它。据我了解，默认情况下它应该在每个浏览器中都可以使用，但由于某种原因，它对我不起作用。这是我的页面：

```
<div style="position:relative;width:1000px; height:900px;border:solid;z-index:30;float:left">
    <div id="image-helper" style="position:absolute;width:1000px; height:900px;z-index:20;float:left" >
        <img id="image" src="images/test.jpg" style="width:500px;height:400px;cursor:pointer;z-index:10;" alt=""/>
    </div>
    </div> 
```

我错过了css中的某些东西吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T16:52:27.793

不，您不能仅通过这样做来移动图像。您必须侦听鼠标事件才能在 javascript 中更新图像的位置。

更具体地说，你必须抓住

*   [鼠标按下](http://api.jquery.com/mousedown/)
*   [鼠标移动](http://api.jquery.com/mousemove/)
*   [mouseup](http://api.jquery.com/mouseup/)

这是一个非常原始的演示：http: [//jsfiddle.net/dystroy/CvVte/](http://jsfiddle.net/dystroy/CvVte/)

**CSS：**

```
img {
 position: fixed;   
}​ 
```

**Javascript：**

```
var mouseIsDown = false;
$('img').mousedown(function(e){
    mouseIsDown = true;
    pos = $(this).offset();
    e.preventDefault();
});
$(document).mousemove(function(e){
    if (!mouseIsDown) return;
    $('img').css({left:e.pageX, top:e.pageY});
 }).mouseup(function(){
     mouseIsDown = false;
 });​ 
```

我会让你最终确定，以便更精确并使用开始拖动位置（提示：使用[偏移量](http://api.jquery.com/offset)）。您还可以在鼠标按钮打开时删除 mousemove 事件处理程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T16:53:03.903

要进行拖放，您需要 javascript，在 jquery 中，您可以使用 ui drag'n'drop：http: [//jqueryui.com/demos/draggable/](http://jqueryui.com/demos/draggable/)

# c# - 使用委托进行 C# 缓存

> ID：11565579
> 
> 赞同：0
> 
> 时间：2012-07-19T16:49:29.253
> 
> 标签：c#, caching, delegates

我正在为我的应用程序开发一个简单的缓存类。

```
using System;
namespace Program {
  public class Cache {
    public delegate int CacheMethodInt();
    public static int Get(CacheMethodInt method) {
      //todo: generate cachekey here
      return method.Invoke();
    }
  }

  public class Calculator {
    public int Add(int x, int y) {
      return x + y;
    }
  }

  class Program {
    static void Main(string[] args) {
      Calculator c = new Calculator();
      Console.WriteLine(Cache.Get(() => c.Add(1, 2)));
    }
  }
} 
```

在`Cache:Get`我需要检查返回值是否已被缓存，如果是，则在不调用该方法的情况下返回它。问题是我不知道如何生成一个好的缓存键。在这种情况下，我想要这样的东西：

```
Calculator:Add:1(int):2(int) 
```

是否可以获取此信息`Cache:Get`？我正在使用.NET 2.0。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:53:28.600

可以使用反射。

作为替代方案，在一个项目中，我出于同样的目的使用了 Postsharp。由于受益更通用和通用的方法

并且不要忘记缓存失效或过期。

相关问题显示了如何获取 MethodInfo 和方法名称：

[在匿名方法中使用 MethodInfo.GetCurrentMethod()](https://stackoverflow.com/questions/4704910/using-methodinfo-getcurrentmethod-in-anonymous-methods)

当您拥有 MethodInfo 时，您可以获得所需的一切

# java - IE8 不在元素中注册模糊事件 - 在 dataGrid 中使用消费事件

> ID：11565583
> 
> 赞同：1
> 
> 时间：2012-07-19T16:49:40.783
> 
> 标签：java, gwt, datagrid

Internet Explorer 8 不会在数据网格中执行 inputtextcells 的模糊事件。它适用于其他浏览器，包括 IE9/10。有人可以回答我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T21:09:51.127

这是一个已知问题：[http ://code.google.com/p/google-web-toolkit/issues/detail?id=7139](http://code.google.com/p/google-web-toolkit/issues/detail?id=7139)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-06T16:05:16.880

我能想到的最好的解决方法是在编辑器中添加“确定”“取消”按钮，它看起来并没有那么糟糕并且可以工作。最简单的方法是修改`com.google.gwt.cell.client.DatePickerCell`

# cocos2d-iphone - 响应popScene

> ID：11565592
> 
> 赞同：1
> 
> 时间：2012-07-19T16:50:06.723
> 
> 标签：cocos2d-iphone

我在我的 cocos2d-iphone 游戏 (1.0.1) 中使用 pushScene 和 popScene。

所以我有这个：

Scene1、Scene2（Scene2 为推送的场景）。

现在我使用 popScene，所以我有

场景1。

从 popScene 方法恢复时，有没有办法在 Scene1 中运行方法？我的意思是，我希望 Scene1 意识到它已经恢复工作。我尝试在 onEnter 方法中放入一些东西，但真的没有用（屏幕是黑色的或者触摸不起作用）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T16:57:10.077

好的，修好了。

您确实可以使用 onEnter 方法，但您必须先调用`[super onEnter]`。

我正在这样做：

```
-(void)onEnter {
      [self doSomething];
} 
```

但它应该是这样的：

```
-(void)onEnter {
      [super onEnter];
      [self doSomething];
} 
```

# java - Rally 将更改列表添加到变更集。使用 Java Toolkit for Rally REST API

> ID：11565594
> 
> 赞同：3
> 
> 时间：2012-07-19T16:50:14.410
> 
> 标签：java, rest, rally

我有一个更改列表（字符串格式），我现在需要将其添加到更改集。变更集已附加到工件，但我无法将变更添加到变更集。

任何帮助都会很棒！非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T20:43:01.637

由于 Changes 是 Changeset 上的一个字段，因此能够更新 Changeset 对象并将 Changes 设置为 Change refs 的集合似乎是合理的。但是，Rally Web 服务 API 想要的东西有点不同。

Changeset 是 Change 对象上的必填字段，因此您无法在 Rally 中创建 Change 对象而不给它一个 Changeset ref。这正是您将更改添加到变更集的方式。

假设您在名为 csRef 的字符串中有一个 Changeset ref（例如“https://rally.rallydev.com/slm/webservice/1.33/changeset/223534.js”），以下代码将创建一个 Change 对象（Changeset 和 PathAndFilename是必填字段）在 Rally 中并将其附加到该变更集：

```
JsonObject newChange = new JsonObject();
newChange.addProperty("Changeset", csRef);
newChange.addProperty("PathAndFilename", "a/b/c");  

CreateRequest cRequest = new CreateRequest("change", newChange);
CreateResponse cResponse = restApi.create(cRequest);
String cRef = cResponse.getObject().get("_ref").getAsString();
System.out.println(String.format("Created %s", cRef)); 
```

您可能已经知道这一点，但指定创建对象所需字段的 Web 服务 api 文档位于：[https ://rally1.rallydev.com/slm/doc/webservice](https://rally1.rallydev.com/slm/doc/webservice)

希望有帮助。

# c# - 如何从方法中返回字符串

> ID：11565597
> 
> 赞同：-6
> 
> 时间：2012-07-19T16:50:19.537
> 
> 标签：c#, string

如何将值作为文本而不是返回`void`？

例子：

```
private void button1_Click(object sender, EventArgs e)
{
    label1.Text = myvoid("foo", true);
    // Error: Cannot implicitly convert type void to string
}

public void myvoid(string key , bool data)
{
    if (data == true)
    {
        string a = key + " = true";
        MessageBox.Show(a); // How can I export this value to labe1.Text?
    }
    else
    {
        string a = key + " = false";
        MessageBox.Show(a); // How can I export this value to labe1.Text?
    }
} 
```

如何`a`从返回 void 的方法中分配值，而不是显示消息框，并将其应用于`label1.Text`？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-19T16:53:46.947

利用：

```
public string myvoid(string key, bool data)
{
    return key + " = " + data;
} 
```

此外，不应再调用您的方法，`myvoid`因为它实际上返回一个值。类似的东西`FormatValue`会更好。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-19T16:53:16.210

```
private void button1_Click(object sender, EventArgs e)
{
    label1.Text = myvoid("foo", true);
}

public string myvoid(string key , bool data)
{
    if (data)       
        return key + " = true";         
    else       
        return  key + " = false"; 
} 
```

正如[奥斯汀](https://stackoverflow.com/users/4068/austin-salonen)在评论中提到的那样，这会更干净

```
public string myvoid(string key , bool data)
{
   return string.Format("{0} = {1}", key, data);
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-19T16:51:32.233

将返回类型更改为字符串：

```
 public string myvoid(string key, bool data)
 {
    string a = string.Empty;
    if (data == true)
    {
        a = key + " = true";
        MessageBox.Show(a); // How can I export this value to labe1.Text?
    }
    else
    {
        a = key + " = false";
        MessageBox.Show(a); // How can I export this value to labe1.Text?
    }
    return a;
 } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-19T16:54:39.967

您必须将方法的返回类型更改为字符串。

像这样：`public string myvoid(string key , bool data)`

然后返回字符串 a;

像这样：

```
return a; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-19T17:20:02.613

使用字符串返回类型：

```
private void button1_Click(object sender, EventArgs e)
{
    label1.Text = myvoid("foo", true);
}

public string myvoid(string key, bool data)
{
    string a = string.Empty;
    if (data == true)
    {
        a = key + " = true";
        MessageBox.Show(a);
    }
    else
    {
        a = key + " = false";
        MessageBox.Show(a);
    }
    return a;
 } 
```

如果你想坚持空虚，你可以这样做

```
 private void button1_Click(object sender, EventArgs e)
 {
     myvoid("foo", true , label1);
 }

 public void myvoid(string key, bool data, label lb)
 {
     string a = string.Empty;
     if (data == true)
     {
         a = key + " = true";
         MessageBox.Show(a);
     }
     else
     {
         a = key + " = false";
         MessageBox.Show(a);
     }

     lb.Text = a;
 } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-19T16:55:35.740

查看[http://msdn.microsoft.com/en-us/library/t3c3bfhx(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/t3c3bfhx(v=vs.80).aspx)。

如果你真的想使用 a `void`，你可以`out`为此使用谓词。

# objective-c - UIWebView addSubview:UIImageView 在被触摸事件触发时不显示

> ID：11565600
> 
> 赞同：2
> 
> 时间：2012-07-19T16:50:29.093
> 
> 标签：objective-c, ios, uiwebview, subview

新的一天，新的问题！

我一直在开发一个应用程序，该应用程序需要在用户触摸屏幕时显示用户手指所在的圆圈。

我遵循了一个关于子类化 UIWindow的[教程，](http://wyldco.com/blog/2010/11/how-to-capture-touches-over-a-uiwebview/)[我的评论](http://wyldco.com/blog/2010/11/how-to-capture-touches-over-a-uiwebview/#comment-225)解释了如果您使用 Storyboards 和 ARC，如何传递这些内容。

我正在使用以下代码（基于[本教程](http://mobile.tutsplus.com/tutorials/iphone/ios-quick-tip-detecting-touches/)）来显示触摸指示器：

```
#pragma mark - Touch Events
- (void) touchesBegan:(NSSet*)touches withEvent:(UIEvent*)event {
    NSArray *subviews = [self.webView subviews];
    for (UIView *view in subviews) 
    {
        // Check if view is scrollview
        if ([view isKindOfClass:[UserTouchImageView class]])
        {
            [view removeFromSuperview];
        }
    }

    // Enumerate over all the touches and draw a red dot on the screen where the touches were
    [touches enumerateObjectsUsingBlock:^(id obj, BOOL *stop) {
        // Get a single touch and it's location
        UITouch *touch = obj;
        CGPoint touchPoint = [touch locationInView:self.webView]; 

        // Add touch indicator
        UserTouchImageView *touchView = [[UserTouchImageView alloc] initWithFrame:CGRectMake(touchPoint.x -15, touchPoint.y -15, 30, 30)];
        [self.webView addSubview:touchView];
    }];
    NSLog(@"Touches began");
}
- (void) touchesMoved:(NSSet*)touches withEvent:(UIEvent*)event {
    NSArray *subviews = [self.webView subviews];
    for (UIView *view in subviews) 
    {
        // Check if view is scrollview
        if ([view isKindOfClass:[UserTouchImageView class]])
        {
            [view removeFromSuperview];
        }
    }

    // Enumerate over all the touches and draw a red dot on the screen where the touches were
    [touches enumerateObjectsUsingBlock:^(id obj, BOOL *stop) {
        // Get a single touch and it's location
        UITouch *touch = obj;
        CGPoint touchPoint = [touch locationInView:self.webView]; 

        // Draw a red circle where the touch occurred
        UserTouchImageView *touchView = [[UserTouchImageView alloc] initWithFrame:CGRectMake(touchPoint.x -15, touchPoint.y -15, 30, 30)];
        [self.webView addSubview:touchView];
    }];
    NSLog(@"Touches moved");
}
- (void) touchesEnded:(NSSet*)touches withEvent:(UIEvent*)event {
    NSArray *subviews = [self.webView subviews];
    for (UIView *view in subviews) 
    {
        // Check if view is scrollview
        if ([view isKindOfClass:[UserTouchImageView class]])
        {
            [UIView animateWithDuration:0.5f 
                             animations:^{
                                 view.alpha = 0.0;
                             }
                             completion:^(BOOL finished) {
                                 [view removeFromSuperview];
                             }];
        }
    }
    NSLog(@"Touches ended");
}
- (void) touchesCancelled:(NSSet*)touches withEvent:(UIEvent*)event {
    NSArray *subviews = [self.webView subviews];
    for (UIView *view in subviews) 
    {
        // Check if view is scrollview
        if ([view isKindOfClass:[UserTouchImageView class]])
        {
            [view removeFromSuperview];
        }
    }
    NSLog(@"Touches cancelled");
} 
```

UserTouchImageView 是 UIImageView 的子类，默认更改为：

```
- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {
        // Initialization code
        self.image = [UIImage imageNamed:@"greyCircle.png"];
        self.alpha = 0.5f;
    }
    return self;
} 
```

我已经在没有 UIWebview 的情况下测试了这段代码（用 替换`self.webView`）`self.view`，它工作正常，在我单击并拖动的地方绘制圆圈，然后在我释放按钮时淡出。

我还成功地实例化了 UserTouchImageView 并将其从 viewController 的`viewDidLoad`方法添加到 webView。

一旦我将 UIWebview 与上面的代码一起放入，同一行 ( `[self.webView addSubview:touchView];`) 就不起作用了。我仍然将 NSLog 消息发送到控制台，但子视图没有明显添加。

谁能帮我弄清楚为什么这没有出现？是否有任何其他代码我需要注意，或者我不能这样做的任何原因？

非常感谢！

**编辑**

到目前为止，我已经上传了我的源代码[(MediaFire)](http://www.mediafire.com/?y3sfy920sfama9a)

**编辑 2**

我添加了以下两种方法：

```
-(void)listWebViewSubViews
{
    NSLog(@"BEGIN LISTING SUBVIEWS");
    for (UIView *view in [self.webView subviews]) {
        NSLog(@"Subview: %@", view.description);
    }
    NSLog(@"END LISTING SUBVIEWS");
}
-(void)view:(UIView *)view addTouchIndicatorWithCentreAtPoint:(CGPoint)point
{
    NSLog(@"View: %@, x: %f, y: %f", view.description, point.x, point.y);

    // Add touch indicator
    UserTouchImageView *touchView = [[UserTouchImageView alloc] initWithFrame:CGRectMake(point.x -15, point.y -15, 30, 30)];

    [view addSubview:touchView];

} 
```

这些是从 UIWebView 外部的两个按钮和 touchesbegan 方法中调用的：

```
- (void) touchesBegan:(NSSet*)touches withEvent:(UIEvent*)event {
    NSArray *subviews = [self.webView subviews];
    for (UIView *view in subviews) 
    {
        if ([view isKindOfClass:[UserTouchImageView class]])
        {
            [view removeFromSuperview];
        }
    }

    [touches enumerateObjectsUsingBlock:^(id obj, BOOL *stop) {
        UITouch *touch = obj;
        CGPoint touchPoint = [touch locationInView:self.webView]; 

        [self view:self.webView addTouchIndicatorWithCentreAtPoint:touchPoint];

        [self listWebViewSubViews];
    }];
    NSLog(@"Touches began");
} 
```

日志记录似乎表明，在 touches started 方法中引用的 webview`self.webView` **是**一个完全独立的实例，而不是从两个按钮引用的实例。我可以通过按钮添加多个子视图，然后列出它们，它们都显示在日志中，但是当我点击模拟器时，这些额外的子视图都没有列出。

有谁知道 UIWebView 中有任何特殊功能在触摸事件上有重复的实例？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T13:09:20.397

A`UIWebView`不是一个视图，而是视图的集合。当您将子视图添加到 UIWebView 时，新的子视图将添加到子视图的层次结构中。您的新子视图可能被添加到其他不透明视图后面。它在那里，但隐藏起来。我建议将此指示器视图添加到层​​次结构中的不同视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T13:16:14.147

`userInteractionEnabled`for`UIImageView`的默认值为`NO`. 您可能需要将其设置为`YES`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-20T16:19:00.403

问题解决了：

不幸的是，这是由完全不同的东西引起的，所以感谢大家提供的帮助。

问题出在我尝试修复代码以与情节提要一起运行。我曾尝试从情节提要访问视图控制器，并将其添加为优先接收触摸事件的视图（请参阅我链接到的教程和我的评论，我也已回复）。我应该在哪里使用 self.window.rootViewController。

我的更新评论在[这里](http://wyldco.com/blog/2010/11/how-to-capture-touches-over-a-uiwebview/#comment-228)

# apple-touch-icon - Apple Touch 图标变黑

> ID：11565603
> 
> 赞同：8
> 
> 时间：2012-07-19T16:50:43.213
> 
> 标签：apple-touch-icon

我的苹果触摸图标中的白色背景变成黑色？我的白色背景不透明。该图标有一个白色三角形、红色圆圈和黑色文本。我唯一能认出的是白色三角形和红色圆圈。知道是什么导致了这种情况以及如何使图标保持其白色背景吗？非常感激。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-19T17:16:47.727

我不确定它到底是什么，但我可能已经缩小了范围。我第一次上传图像时，它们可能具有透明背景。我第二次上传它们时添加了白色背景，但设备设置的 png 保存仍然检查了透明度。第三次上传它们时，我在没有检查透明度的情况下保存了它们，但仍然得到黑色背景。一直以来，我认为 iOS Safari 浏览器将第一组图像存储在缓存中。[清除缓存](http://browsers.about.com/od/howtousemobilebrowser1/ss/How-To-Manage-Private-Data-Components-In-Safari-For-Iphone_7.htm)后，新图像显示没有问题。

**编辑：它的透明背景使它变黑。**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-11-19T00:08:36.433

正如 gstricklind 发现的那样，如果您的 png 具有 alpha 通道透明度，iOS 将不幸地忽略任何“预组合”指令并应用其所有常用效果，此外还为您的图标提供黑色背景（白色似乎不是更好的选择？？） .

解决方案当然是预编译不透明的图标。如果黑色背景不适合您，这使得在提供 itouch 图标的同时也很难利用 Android 对 alpha 通道的支持。我发现这个工具在作曲时很有用：http: [//www.gieson.com/Library/projects/utilities/icon_slayer](http://www.gieson.com/Library/projects/utilities/icon_slayer)

此处看到的相同问题：[如何让 iOS 正确尊重“Web 应用程序”的“apple-touch-icon-precomposed”链接属性](https://stackoverflow.com/questions/6381312/how-to-get-ios-to-properly-respect-the-apple-touch-icon-precomposed-link-attri)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-13T23:32:37.320

透明的 Apple Touch Icons 确实是可能的。您需要做的是使用 ImageOptim for Mac [https://imageoptim.com/mac从 PNG 中删除所有多余的信息](https://imageoptim.com/mac)或Windows上的类似程序。我进行了广泛的研究，并通过查看 Virtual DJ 网站使用的苹果触摸图标偶然发现了答案。此图标在 iOS 和 MacOS Sierra 上保持透明背景。我查看了文件大小，并意识到它与我在 Safari 中为我的最爱制作的具有透明度的自定义苹果触摸图标相比有多么小。接下来，我使用 Mac 的 Preview 应用程序中的检查器查看了文件信息。我所有的自定义苹果触摸图标在检查器部分都有四个标签，分别名为 General、exif、PNG 和 TIFF。虚拟 DJ 图标只有两个名为 PNG 和 General 的选项卡。一旦我通过 ImageOptim 运行我的自定义图像，文件大小就会下降 90% 以上，并且额外的 TIFF 和 exif 选项卡从预览中的检查器中消失了。果然，一旦我重新加载了我的自定义图像并启动了 Safari，我所有的收藏夹标签都有透明背景！！！！请参阅附件图片为证。[透明的 Apple 触控图标](https://i.stack.imgur.com/7K40T.png)

# c# - MVC 视图：使用正则表达式进行数据验证

> ID：11565604
> 
> 赞同：1
> 
> 时间：2012-07-19T16:50:44.733
> 
> 标签：c#, asp.net-mvc

我有 2 个关于使用 System.ComponentModel.DataAnnotations 验证 MVC 视图的问题：

1.  如何验证在文本框中输入的值是否为 URI？

2.  如果在框中输入的 URL 不是以 HTTP:// 开头或以“.m3u8”结尾，我如何使用正则表达式进行验证

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T17:11:07.723

尝试这样的事情

```
[RegularExpression(@"((((ht)tp?:\/\/)?[^\/\s]+\.(m3u8))(\/\S*)?)", ErrorMessage="Not a Valid URL")]
public string URL { get; set; } 
```

# python - 在 Python 中扫描一组 URL 的最快方法是什么？

> ID：11565606
> 
> 赞同：1
> 
> 时间：2012-07-19T16:50:56.137
> 
> 标签：python, url, wsgi

我需要扫描一组给定的 URL 并在 Python 中获取 HTTP 状态代码，例如“200 OK”。我目前正在使用 urllib 来执行此操作。有没有更快的方法来做到这一点？

## Python代码

```
def get_status(url):
try:
    return urllib.urlopen(url).getcode()

except StandardError :
    return None 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T17:00:51.167

Couple remarks I would make for faster happier status checking. The first tip would be to use the http `HEAD` method. This asks the server for just the http headers (including the status code) without having it also serve the body of the page.

Second urllib works but I would recommend using the wonderful [Requests](http://docs.python-requests.org/en/latest/index.html) library which provides a much nicer api for pretty much everything you would want to do with http.

Last I would use the [gevents](http://www.gevent.org/) library to enable you to download each header asynchronously, vastly speeding up the whole process.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T16:58:17.267

您可能希望以非阻塞方式并行执行此操作。在此处查看 eventlet 库：http: [//eventlet.net/](http://eventlet.net/)。您可以从首页[http://eventlet.net/#web-crawler-example](http://eventlet.net/#web-crawler-example)中获取一个示例。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-19T17:13:36.833

为了速度，尝试使用[GRequests](https://github.com/kennethreitz/grequests)异步检查 url（不是一次一个）。

## 代码

```
import grequests

urls = [
    'http://www.heroku.com',
    'http://tablib.org',
    'http://httpbin.org',
    'http://python-requests.org',
    'http://kennethreitz.com'
]

rs = (grequests.get(u) for u in urls)
# For even faster status code checks, use the HEAD method instead of GET
# rs = (grequests.head(u) for u in urls)

for r in grequests.map(rs):
    print r.status_code, r.url 
```

## 输出

```
200 http://www.heroku.com/
200 http://tablib.org/
200 http://httpbin.org/
200 http://docs.python-requests.org/en/latest/index.html
200 http://kennethreitz.com/ 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-19T16:59:16.440

就在这里。

1.  使用多个线程同时检查不同的 URL。
2.  使用实现简单 HTTP 请求的原始套接字。一旦收到 200 响应（或任何其他代码），您就关闭连接，避免不必要的数据传输。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-19T16:59:11.867

使用线程。将您的代码放在一个 Thread 类中，并将结果存储在一个全局对象中。调用一堆线程。

# wcf - 在单元测试中托管 WCF 服务

> ID：11565610
> 
> 赞同：4
> 
> 时间：2012-07-19T16:51:11.953
> 
> 标签：wcf, unit-testing

我想对我的 custom 进行单元测试`ServiceHostFactory`。不幸的是，我`InvalidOperationException`在打电话时得到了这个`CreateServiceHost`：

> 'ServiceHostFactory.CreateServiceHost' 不能在当前宿主环境中调用。此 API 要求调用应用程序托管在 IIS 或 WAS 中。

我可以通过重构我的类来解决这个问题，以便它公开一个可以由单元测试直接调用的公共方法，而不是使用其继承的公共接口；我讨厌仅仅为了单元测试而改变我的界面。我还看到另一个建议生成 Cassini 主机的 SO 答案，但我不想以这种方式使我的单元测试复杂化。

`ServiceHostFactory`有没有办法在不采取这些措施的情况下解决这个限制？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T20:09:54.543

我弄清楚了这个问题。在我的自定义`ServiceHostFactory`中，我只覆盖了受保护的方法，`CreateServiceHost(Type serviceType, Uri[] baseAddresses)`. 通过覆盖公共`CreateServiceHost(string constructorString, Uri[] baseAddresses)`方法，我能够毫无问题地构建服务主机工厂。

前：

```
public class MyServiceHostFactory : ServiceHostFactory
{
    protected override ServiceHost CreateServiceHost(Type serviceType, Uri[] baseAddresses)
    {
        // ...
    }
} 
```

后：

```
public class MyServiceHostFactory : ServiceHostFactory
{
    public override ServiceHostBase CreateServiceHost(string constructorString, Uri[] baseAddresses)
    {
        return this.CreateServiceHost(typeof(MyService), baseAddresses);
    }

    protected override ServiceHost CreateServiceHost(Type serviceType, Uri[] baseAddresses)
    {
        // ...
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-28T15:11:35.800

这是我对这个问题的解决方案（我不是 100% 确定我们是否应该这样做）。

在单元测试夹具的设置中，设置一个托管环境（NUnit 示例）：

```
[TestFixtureSetUp]
public void TestFixtureSetup()
{
    if(!HostingEnvironment.IsHosted)
    {
        // The instance constructor hooks up the singleton hosting environment, ewww...
        new HostingEnvironment();

        // Check the hosting environment is fully initialized
        ServiceHostingEnvironment.EnsureInitialized();
    }
} 
```

然后，您应该可以`ServiceHostFactory`在单元测试中自由使用您的自定义：

```
[Test]
public void ServiceHostIsCorrect()
{
    // Arrange
    var serviceType = typeof (string);
    var factory = new UnityServiceHostFactory();

    // Act
    var serviceHost = factory.CreateServiceHost(serviceType.AssemblyQualifiedName, new Uri[] {});

    // Assert
    Expect(serviceHost, Is.TypeOf<UnityServiceHost>());
    var unityServiceHost = (UnityServiceHost)serviceHost;
    Expect(unityServiceHost.Description.ServiceType, Is.EqualTo(serviceType));
} 
```

# python - 解析这种脚本语言的最有效方法

> ID：11565618
> 
> 赞同：7
> 
> 时间：2012-07-19T16:51:41.503
> 
> 标签：python, lexer, shlex

我正在为一个过时的文本编辑器的脚本语言实现一个解释器，我在让词法分析器正常工作时遇到了一些麻烦。

这是该语言有问题的部分的示例：

```
T
L /LOCATE ME/
C /LOCATE ME/CHANGED ME/ * *
C ;CHANGED ME;CHANGED ME AGAIN; 1 * 
```

这些`/`字符似乎引用了字符串，并且还充当 -type 语法中`C`( `CHANGE`) 命令的分隔符`sed`，尽管它允许任何字符作为分隔符。

`parse_tokens(line.split())`到目前为止，我可能已经实现了大约一半最常见的命令。这又快又脏，但效果却出奇的好。

为了避免编写我自己的词法分析器，我尝试了`shlex`.

它工作得很好，除了以下`CHANGE`情况：

```
import shlex

def shlex_test(cmd_str):
    lex = shlex.shlex(cmd_str)
    lex.quotes = '/'
    return list(lex)

print(shlex_test('L /spaced string/'))
# OK! gives: ['L', '/spaced string/']

print(shlex_test('C /spaced string/another string/ * *'))
# gives   : ['C', '/spaced string/', 'another', 'string/', '*', '*']
# desired : any format that doesn't split on a space between /'s

print(shlex_test('C ;a b;b a;'))
# gives   : ['C', ';', 'b', 'a', ';', 'a', 'b', ';']
# desired : same format as CHANGE command above 
```

任何人都知道一个简单的方法来完成这个（用`shlex`或其他）？

编辑：

如果有帮助，这里是`CHANGE`帮助文件中给出的命令语法：

```
'''
C [/stg1/stg2/ [n|n m]]

    The CHANGE command replaces the m-th occurrence of "stg1" with "stg2"
for the next n lines.  The default value for m and n is 1.''' 
```

同样难以标记`X`和`Y`命令：

```
'''
X [/command/[command/[...]]n]
Y [/command/[command/[...]]n]

    The X and Y commands allow the execution of several commands contained
in one command.  To define an X or Y "command string", enter X (or Y)
followed by a space, then individual commands, each separated by a
delimiter (e.g. a period ".").  An unlimited number of commands may be
placed in the X or Y command string.  Once the command string has been
defined, entering X (or Y) followed optionally by a count n will execute
the defined command string n times.  If n is not specified, it will
default to 1.''' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T21:19:08.630

问题可能`/`是不代表引号，而仅代表分隔。我猜第三个字符总是用来定义分隔符。此外，您不需要输出中的`/`or `;`，对吗？

我刚刚对 L 和 C 命令案例进行了拆分，仅执行了以下操作：

```
>>> def parse(cmd):
...     delim = cmd[2]
...     return cmd.split(delim)
...
>>> c_cmd = "C /LOCATE ME/CHANGED ME/ * *"
>>> parse(c_cmd)
['C ', 'LOCATE ME', 'CHANGED ME', ' * *']

>>> c_cmd2 = "C ;a b;b a;"
>>> parse(c_cmd2)
['C ', 'a b', 'b a', '']

>>> l_cmd = "L /spaced string/"
>>> parse(l_cmd)
['L ', 'spaced string', ''] 
```

对于`" * *"`您可以`split(" ")`在最后一个列表元素上使用的可选部分。

```
>>> parse(c_cmd)[-1].split(" ")
['', '*', '*'] 
```

# mysql - 如何在mysql中只返回唯一值

> ID：11565621
> 
> 赞同：4
> 
> 时间：2012-07-19T16:51:45.917
> 
> 标签：mysql, sql, database, unique

```
SELECT users.mail, users.name FROM members
LEFT JOIN users ON (users.uid = members.uid) WHERE members.group = 27
AND members.uid NOT IN (SELECT subgroup_members.uid FROM subgroup_members
LEFT JOIN subgroups ON (subgroups.id = subgroup_members.sid)
LEFT JOIN users on (users.uid = subgroup_members.uid) WHERE subgroups.oid = 27 AND subgroup_members.leader = 1) 
```

此查询返回不是子组领导的组的所有成员。

members 表显示哪些`userid(uid)`属于 a `group(group)`，该`subgroup_members`表显示哪些用户属于 a `subgroup(sid)`。领导在 subgroup_members 表的领导列中用“1”表示。

我试图弄清楚如何返回一个组中不是*唯一*领导者的所有成员，我现在很困惑。

所以不是`subgroup_members.leader = 1`我需要确定它是否是唯一的价值

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:54:50.467

研究使用`GROUP BY`来隔离唯一索引。

**文档**：[https ://dev.mysql.com/doc/refman/5.5/en/group-by-modifiers.html](https://dev.mysql.com/doc/refman/5.5/en/group-by-modifiers.html)

# python - Python tkinter 菜单 + 变量

> ID：11565630
> 
> 赞同：1
> 
> 时间：2012-07-19T16:52:13.273
> 
> 标签：python, user-interface, tkinter

我有一个包含多个项目的菜单，菜单上的每个项目都使用相同的 GUI 来实现功能。每个所需的功能或菜单项只是在后台发生不同的事情。我知道可以制作我的 gui 代码的多个副本，将其分配给单独的 def，然后为菜单项提供特定的命令行。

**但是，有没有一种更简单的方法可以让我在给定的 def 中指定一次**我的 gui 代码，并让 Tkinter/python 运行识别选择了哪个选项的 def？

例如：

```
filemenu.add_command(label="Item-a", command=gui)
filemenu.add_command(label="Item-b", command=gui)
filemenu.add_command(label="Item-c", command=gui) 
```

哪个可以启动def gui，哪个在绘制界面之前可以告诉项目a、b或c被选中了？

希望这是有道理的。

有什么想法吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T17:15:34.743

如果我正确理解您的问题，您可以执行以下操作：

```
def gui(item):
    if item == 'a':
       pass # do something with a
    elif item == 'b':
       pass # do something with b 
```

现在在您的文件菜单中：

```
filemenu.add_command(label='Item-a', command=lambda : gui('a'))
filemenu.add_command(label='Item-b', command=lambda : gui('b')) 
```

等等。

# svn - SVN 中的 Maven 发布周期和版本控制

> ID：11565631
> 
> 赞同：2
> 
> 时间：2012-07-19T16:52:15.207
> 
> 标签：svn, maven, maven-release-plugin

我正在尝试找到一些关于版本号以及与 Maven 和 SVN 分支/合并的可靠信息。

我的项目使用 Maven 版本规则：

```
<major>.<minor>.<revision>([ -<qualififer> ] | [ -<build> ]) 
```

我的 Maven 版本如下，主干和发布标签中有快照

```
trunk:    1.0.0-SNAPSHOT

tag:      1.0.0

trunk:    1.0.1-SNAPSHOT

tag:      1.0.1

etc.... 
```

问题：

1.  如果我创建一个分支（从发布标签）以进行错误修复。在发布这个补丁时，maven 发布插件给它的编号是多少？它得到什么标签名称？关于将更改合并回主干的任何建议？

2.  更改 Maven 版本号的标准方法是什么？主要、次要和内部版本号何时增加？

有什么书籍或文档可以阐明推荐的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-20T00:06:11.733

来自**Better Builds with Maven** - Mergere Library Press 的引述。

第 3.6 节。解决依赖冲突和使用版本范围：

![在此处输入图像描述](../Images/0aa59ffe9f5872acbca9080248138f9e.png)

> 如果我创建一个分支（从发布标签）以进行错误修复。在发布这个补丁时，maven 发布插件给它的编号是多少？它得到什么标签名称？关于将更改合并回主干的任何建议？

这样做时`mvn release:prepare`，如果您不喜欢 Maven 生成的版本，您将有机会填写特定的版本名称（发布版本、标签版本、下一个主干版本等）。在某些特殊情况下，例如从分支构建补丁版本，我们通常会自己设置版本名称：

*   如果更改不需要合并回主干（从分支构建版本），请使用 1.0.1-1 或 1.0.1-patch-1。

*   如果更改需要合并回主干（从主干构建发布），对于重大更改，使用 2.0.0，对于次要更改，使用 1.1.0，对于错误修复，使用 1.0.2。

> 更改 Maven 版本号的标准方法是什么？主要、次要和内部版本号何时增加？

见上图。

### 更新：

> 是的，这是 Maven 版本控制的另一个令人困惑的部分。对我来说，该图与下面写的内容相矛盾：它表明发布补丁后内部版本号会增加。但我认为这就是版本字符串的错误修复部分的用途，如图所示？？

Maven 版本范围的目的是涵盖尽可能多的用例。您打算如何使用它完全取决于您。这里的重点是哪个更合理。正如我在原帖中所说，它用于某些特殊情况，例如您的团队需要同时维护两个工作流（主干上的主要工作流和分支上的第二个工作流）。

以这种情况为例，经过长时间的工作，您构建并部署版本 1.0.6 到您的客户端（在 SVN 中，1.0.6 被标记，trunk 被递增到 1.0.7-SHAPSHOT，意味着下一个预期的发布版本是1.0.7），并在主干上不断发展。然后两周后，在 1.0.6 版本中报告了一个错误，需要紧急修复，因此您从标签 1.0.6 创建一个分支，修复错误并将分支合并回主干。现在您需要为客户端构建补丁版本。由于自上次构建（两周前）以来主干已经发生了很大变化，我们必须从分支构建这个补丁版本。当然，您可以在此补丁版本中使用您喜欢的任何版本（即 1.0.7），因此需要手动更改主干中的版本（从 1.0.7-SHAPSHOT 到 1.0.8-SNAPSHOT）。但是，我更愿意在此补丁版本中使用 1.0.6-patch-1。

图表中没有任何矛盾，内部版本号在这种情况下是完美的，这就是它的意思*“而内部版本号是发布后的增量，表示已修补的版本”。*它使您有第二次机会增加针对已发布版本 (1.0.6 -> 1.0.6-patch-1) 的版本定位，而不是准备发布的开发版本 (1.0.7-SNAPSHOT -> 1.0\. 7）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T17:42:11.743

在这种情况下，我建议创建一个不同的编号模式。所以让我们假设我们从 1.0.0 Tag 创建一个分支，它可能被命名为 1.0.0-BFB。maven 工件的版本我会使用这样的东西：

```
1.0.0.1-SNAPSHOT 
```

如果您发布此工件，版本号将转到：

```
1.0.0.1 
```

这是一个针对单个更改的解决方案，可以像这样在 1.0.0 行上通过多个更改进行增强。从 1.0.0 标记创建分支并将其命名为 MB-1.0.0，工件的版本可以如下完成：

```
1.0.0.1-SNAPSHOT
1.0.0.1
1.0.0.2-SNAPSHOT
1.0.0.2
1.0.0.3-SNAPSHOT
etc. 
```

默认情况下，Maven 中的标签名称由 artifactId 的名称和版本计算得出。

可以通过发布插件来创建这样的维护分支，如下所示：

```
mvn -B -DupdateBranchVersions=true -DupdateWorkingCopyVersions=false -DreleaseVersion=1.0.1-SNAPSHOT -DbranchName=MB-1.0.0 release:branch 
```

处理这种情况的默认解决方案是使用[发布插件](http://maven.apache.org/plugins/maven-release-plugin/prepare-mojo.html)的参数，您也可以使用 developmentVersion 或 releaseVersion。仅当您在发布之前知道这一点时，这才有效。

但是通常情况下，您发布了一个版本，然后决定更改次要版本或主要版本。因此，您也可以使用发布插件，例如：

```
mvn org.apache.maven.plugins:maven-release-plugin:2.3.2:update-versions -DdevelopmentVersion=WhatEverVersionYouLike 
```

或者您可以使用versions-maven-plugin 来更新版本号。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T17:38:16.120

您可以完全控制在发布时为您的工件提供哪些版本。

通常，使用major.minor.patch 版本控制方案的想法是，补丁部分为错误修复而增加，次要 - 用于不破坏向后兼容性的新功能，主要 - 向后不兼容的更改和新的主要功能。

# java - 当前 Java 网络框架为 Android 或 JavaScript 前端提供 XML 或 JSON

> ID：11565636
> 
> 赞同：0
> 
> 时间：2012-07-19T16:52:35.660
> 
> 标签：java, xml, json, asynchronous

这是我在 stackoverflow 上的第一篇文章。我非常擅长 Java SE 和客户端 Java 编程，但对 Java Web 开发很陌生。当我搜索 Java 网络框架时，提供了大量的框架，但似乎没有什么能真正满足我的需求。我真正想要的是一个愚蠢的服务器和一个智能客户端。我希望客户端请求某些信息，服务器以 xml 或 json 格式返回请求的信息，以便客户端自己管理数据。在大多数情况下，webframeworks 在服务器端呈现 html 页面等，但我只想使用 AJAX 或 android xml 解析器来获取信息，然后在客户端填充 UI。

我不确定 Web 服务是否适合我，因为我想向服务器发出几个异步请求。

或者我应该简单地使用 servlet，它只是根据请求返回正确的 xml。

第二件事是如何处理用户的授权和身份验证，将请求发送到网络服务器。我不想让每个人都收到服务器生成的xml或json。

简而言之：是否有基于 java 的 web 框架，可以处理用户的授权和身份验证，并且只返回 xml 或 json 给智能客户端？

哪个基于 Java 的网络框架最适合我的需求？

在下面的网页上描述了我的目标，但不幸的是没有提示如何实现这样一个“愚蠢”的服务器......

> [http://seng130.wordpress.com/lectures-2/web-application-architecture/](http://seng130.wordpress.com/lectures-2/web-application-architecture/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T17:46:27.423

您可能需要使用多个框架。Spring-Security 根据权限处理您的 url 拦截。然后使用带有 Spring-MVC 的 Servlet 在 Controller 方法中处理请求。教程在这里：[http](http://static.springsource.org/spring-security/site/tutorial.html) ://static.springsource.org/spring-security/site/tutorial.html您可以让这些方法返回 JSON 或 XML 的字符串值。我建议使用 Jackson 将您的对象即时转换为 JSON 格式，并使用 javax 库用于 XML。

带有 Jackson 的 Spring-MVC 示例： [http ://www.mkyong.com/spring-mvc/spring-3-mvc-and-json-example/](http://www.mkyong.com/spring-mvc/spring-3-mvc-and-json-example/)

Jersey servlet 和 Jackson 示例 [http://www.mkyong.com/webservices/jax-rs/json-example-with-jersey-jackson/](http://www.mkyong.com/webservices/jax-rs/json-example-with-jersey-jackson/)

# ms-access - MS 访问处理 #error

> ID：11565644
> 
> 赞同：1
> 
> 时间：2012-07-19T16:52:58.240
> 
> 标签：ms-access

有时当我有一个具有#Error 的字段（例如除以0）时，有没有办法执行 isError() 或类似的东西？有时，何时发生错误并不总是很清楚，这意味着我必须通过一堆查询来查找发生某些 div/0 错误的位置，因为通常错误会无声地发生。我希望能够明确查找#Iserror，以便在它发生时找到它。

例如`SELECT sourcetable.fieldname INTO desttable IN '\\path\database.mdb'FROM sourcetable;`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T17:04:46.023

对于除以零，您应该以不同的方式进行捕获（[http://office.microsoft.com/en-us/access-help/avoiding-divide-by-zero-errors-in-access-HA001055073.aspx](http://office.microsoft.com/en-us/access-help/avoiding-divide-by-zero-errors-in-access-HA001055073.aspx)）

```
=IIf([Divisor]=0,Null,[Dividend]/[Divisor]) 
```

将 IsError 与对子表单的引用一起使用并不罕见：

```
=IIf(IsError([Form].[Subform]![SummedControl]),0,[Form].[Subform]![SummedControl]) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-05-08T07:00:55.347

您必须使用以下内容：

```
=IIF([Divisor] IS NULL OR [Divisor]=0, Null, [Dividend]/[Divisor]) 
```

# css - 指南针重置后重新“打开”子弹

> ID：11565645
> 
> 赞同：1
> 
> 时间：2012-07-19T16:52:59.530
> 
> 标签：css, sass, compass-sass, css-reset

我有一个使用 SCSS 和 Compass 的网站。我在我的 SCSS 文件顶部使用了 Compass 重置，`@import 'compass/reset';`它工作正常。

我现在有一个无序列表，实际上我确实想要默认项目符号。但是，到目前为止，无论我尝试过什么，都没有子弹。

```
.content {
    padding: 10px;
    ul {
        list-style: disc;
        li {
            list-style: disc;
            margin-bottom: 10px;
        }
    }
} 
```

我在这里想念什么？如何覆盖此列表的重置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T13:47:17.903

尝试改用。一些浏览器可能能够处理。`list-style-**type**``list-style`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-04T10:42:54.373

对我来说，您似乎需要在 ul 标签中添加左填充和列表样式类型。

```
ul {
   list-style-type: circle;
   padding-left: 20px;
   } 
```

# amazon-ec2 - 如何确定我的 Amazon EC2 实例是 32 位还是 64 位？

> ID：11565649
> 
> 赞同：18
> 
> 时间：2012-07-19T16:53:14.083
> 
> 标签：amazon-ec2, amazon-web-services

我是新手，这可能是一个非常简单的问题，但我正在运行一个 Amazon EC2 实例，我不知道我正在运行的实例是 32 位还是 64 位。

**我的问题**

有什么方法可以确定我的实例是 32 位还是 64 位？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-07-19T16:58:34.803

这应该适用于任何 linux 实例。在终端上键入以下命令：

```
> uname -a
Linux domU-XX-XX-XX-XX-XX-XX 3.2.20-1.29.6.amzn1.i686 
      #1 SMP Tue Jun 12 01:20:33 UTC 2012 i686 i686 i386 GNU/Linux 
```

最后一个“i386”表示它是 32 位的；“x86_64”表示 64 位。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2022-01-20T16:34:36.777

选择：

unname -m

```
 -m, --machine
          print the machine hardware name 
```

例如 $ unname -m

x86_64

# jquery - 如何使用 xpath 选择器获取所有子元素？

> ID：11565652
> 
> 赞同：0
> 
> 时间：2012-07-19T16:53:18.407
> 
> 标签：jquery, xpath, css-selectors

在 css 或 jquery 中：

```
#related article 
```

将选择id 为“related”的元素内的**所有文章元素。**当我使用这个 xpath 选择器时：

```
//descendant-or-self::*[@id = 'related']/descendant::article 
```

它只选择第一个文章元素。它不会选择该“相关” div 中的其余部分。如何全选？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T17:47:39.183

XPath (1.0) 做`id('related')//article`或确实选择了后代元素`//*[@id = 'related']//article`的节点集。`article`即使您的路径`//descendant-or-self::*[@id = 'related']/descendant::article`也不会将结果限制为单个元素，所以我怀疑问题在于您如何看待 XPath 结果或如何评估它。路径本身将结果限制为单个节点的唯一方法是，例如`(//*[@id = 'related']//article)[1]`，对于其他路径，我会检查 XPath API，您使用的方法（`selectSingleNode`或类似方法？）是否是罪魁祸首和使用方法`selectNodes`或类似方法。

# javascript - 页面高度受 jQuery 图像库影响

> ID：11565656
> 
> 赞同：0
> 
> 时间：2012-07-19T16:53:22.593
> 
> 标签：javascript, jquery, css

我正在构建一个使用 jQuery 图片库的网站。[你可以在这里](http://247896-7.temp-dns.com/tenants/property-details/Bradley)看到一个例子。

出于某种原因，当图库更改图像时，或者当您手动更改图像时，页面高度似乎在“闪烁”，因为需要一个更好的词。似乎页面高度正在被新图像增加，然后很快又降低到原来的高度。

有没有人对导致此问题的原因以及如何解决此问题有任何想法？

一如既往，任何帮助表示赞赏！

提前致谢，

汤姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T17:07:09.430

您可以尝试使用 jquery.lightbox-0.5.css 包含此 google 代码

[code.google.com/p/imdametadata/source/browse/trunk/guidelines/documents/web/css/jquery.lightbox-0.5.css](http://code.google.com/p/imdametadata/source/browse/trunk/guidelines/documents/web/css/jquery.lightbox-0.5.css)

# javascript - 即使值为 1.00000000001，也使用 javascript 向上舍入到下一个整数

> ID：11565657
> 
> 赞同：0
> 
> 时间：2012-07-19T16:53:25.043
> 
> 标签：javascript, math

如何将输入到文本框中的数字舍入并除以 18，UP，无论其是否低于 0.5（使用 Javascript/jQuery）。目前我正在使用：

```
nopallets=parseInt(howmany/18); 
```

但这取决于它最接近哪个整数。

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T16:55:19.113

`Math.ceil(howmany/18)`是你想要的。

[MDN Docs](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Math/ceil) ceil 返回大于或等于数字的最小整数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T16:54:40.783

[http://www.w3schools.com/jsref/jsref_ceil.asp](http://www.w3schools.com/jsref/jsref_ceil.asp)

```
nopallets=Math.ceil(howmany/18); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-19T16:55:14.543

```
nopallets= Math.ceil(number); 
```

它需要数字的上限

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-19T16:56:22.713

`Math.ceil`会为你做的。
请参阅[http://www.w3schools.com/jsref/jsref_ceil.asp](http://www.w3schools.com/jsref/jsref_ceil.asp)以供参考。

```
nopallets=Math.ceil(howmany/18); 
```

# python - 如何防止来自单个用户的多票

> ID：11565662
> 
> 赞同：1
> 
> 时间：2012-07-19T16:53:31.937
> 
> 标签：python, google-app-engine, jinja2, voting-system

我正在用 python 在谷歌应用引擎上编写一个网络应用程序。我使用 jinja2 作为模板引擎。

我目前已经设置好了，这样用户就可以对帖子投赞成票和反对票，但现在他们可以随意投票多次。我只是将投票记录保存在数据库中，然后立即计算。如何有效地防止用户投多票？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T17:22:24.497

我建议制作一个`toggleVote`方法，该方法接受您要切换投票的项目的密钥，以及进行投票的用户的密钥。

我还建议添加一个表格来记录投票，基本上包含两个字段：

```
"keyOfUserVoting", "keyOfItemBeingVotedOn" 
```

这样你就可以简单地查询键匹配的地方，如果一个项目存在，那么你就知道用户对该项目进行了投票。( `Query where keyOfUserVoting = 'param1' and keyOfItemVoted='param2'`, `if result != None`, 则表示用户投票)

对于 toggleVote() 方法，情况可能非常简单：

```
toggleVote(keyOfUserVoting, keyOfItemToVoteOn):
    if (queryResultExists):
        // delete this record from the 'votes' table
    else:
        // add record to the 'votes' table 
```

这样，您就不必担心单独跟踪用户投票的次数。

同样这样，如果你想知道一个项目有多少票，你可以做另一个查询来快速`count where keyOfItemToVoteOn = paramKeyOfItem`。同样，使用 GAE，这将非常快。

在此设置中，您还可以快速了解用户对一个项目的投票次数 ( `count where userKey = value and where itemKey = value`)，或者用户在整个系统中投票的次数 ( `count where userKey = value`)...

最后，为了获得最佳可靠性，您可以将更新包装在`toggleVote()`事务中的方法中，尤其是当您将对用户或被投票的项目执行其他操作时。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T16:57:33.320

**将投票用户与投票一起存储，并使用您的数据库**检查当前用户的现有投票。

您可以在提供页面之前执行检查（因此禁用您的投票按钮），或者在您获得投票尝试时（并显示某种消息）。如果投票对您来说真的很重要，您可能应该编写代码来处理这两种情况。

# c - 配置文件 C 执行

> ID：11565663
> 
> 赞同：5
> 
> 时间：2012-07-19T16:53:44.443
> 
> 标签：c, profiler, clock, execution-time

所以，只是为了好玩，出于好奇，我想看看在进行奇偶校验、模数或按位比较时执行得更快。

所以，我整理了以下内容，但我不确定它的行为是否正确，因为差异是如此之小。我在网上某处读到按位应该比模数检查快一个数量级。

它有可能被优化掉吗？我刚刚开始修补程序集，否则我会尝试对可执行文件进行一些剖析。

**编辑3：**这是一个工作测试，在很大程度上感谢@phonetagger：

```
#include <stdio.h>
#include <time.h>
#include <stdint.h>

// to reset the global
static const int SEED = 0x2A;

// 5B iterations, each
static const int64_t LOOPS = 5000000000;

int64_t globalVar;

// gotta call something
int64_t doSomething( int64_t input )
{
  return 1 + input;
}

int main(int argc, char *argv[]) 
{
  globalVar = SEED;

  // mod  
  clock_t startMod = clock();

  for( int64_t i=0; i<LOOPS; ++i )
  {    
    if( ( i % globalVar ) == 0 )
    {
      globalVar = doSomething(globalVar);      
    }    
  }

  clock_t endMod = clock();

  double modTime = (double)(endMod - startMod) / CLOCKS_PER_SEC;

  globalVar = SEED;

  // bit
  clock_t startBit = clock();

  for( int64_t j=0; j<LOOPS; ++j )
  {
    if( ( j & globalVar ) == 0 )
    {
      globalVar = doSomething(globalVar);
    }       
  }

  clock_t endBit = clock();

  double bitTime = (double)(endBit - startBit) / CLOCKS_PER_SEC;

  printf("Mod: %lf\n", modTime);
  printf("Bit: %lf\n", bitTime);  
  printf("Dif: %lf\n", ( modTime > bitTime ? modTime-bitTime : bitTime-modTime ));
} 
```

每个循环进行 50 亿次迭代，全局删除编译器优化产生以下结果：

```
Mod: 93.099101
Bit: 16.701401
Dif: 76.397700 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T17:22:53.470

`gcc foo.c -std=c99 -S -O0` **（注意，我特意这样做了`-O0`）** x86为两个循环提供了*相同的程序集。*运算符[强度降低](http://en.wikipedia.org/wiki/Strength_reduction)意味着两个`if`s 都使用 an`andl`来完成工作（这比 Intel 机器上的模快）：

第一个循环：

```
.L6:
        movl    72(%esp), %eax
        andl    $1, %eax
        testl   %eax, %eax
        jne     .L5
        call    doNothing
.L5:
        addl    $1, 72(%esp)
.L4:
        movl    LOOPS, %eax
        cmpl    %eax, 72(%esp)
        jl      .L6 
```

第二循环：

```
.L9:
        movl    76(%esp), %eax
        andl    $1, %eax
        testl   %eax, %eax
        jne     .L8
        call    doNothing
.L8:
        addl    $1, 76(%esp)
.L7:
        movl    LOOPS, %eax
        cmpl    %eax, 76(%esp)
        jl      .L9 
```

您看到的微小差异可能是由于`clock`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T17:12:18.670

按位检查只需要一条机器指令（“and ...,0x01”）；这很难被击败。

如果您有一个愚蠢的编译器，它实际上通过取余数来计算模数（有时包括对模数例程的子例程调用！），模数检查绝对会更慢。智能编译器知道模函数并直接为它生成代码；如果他们有任何不错的优化，他们就会知道“模（x，2）”可以用上面相同的 AND 技巧来实现。

我们的[PARLANSE](http://www.semdesigns.com/products/parlanse/index.html)编译器理所当然地做到了这一点。如果广泛使用的 C 和 C++ 编译器也不这样做，我会感到惊讶。

使用这样的“好”编译器，您编写奇数/偶数（或什至“是二的幂”）检查的方式并不重要；它会非常快。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-19T17:26:02.203

大多数编译器会将以下两者编译为完全相同的机器指令：

```
if( ( i % 2 ) == 0 )

if( ( i & 1 ) == 0 ) 
```

...即使没有打开任何“优化”。原因是您正在对常量值进行 MOD-ing 和 AND-ing，并且 %2 操作，正如任何编译器编写者都应该知道的那样，在功能上等同于 &1 操作。事实上，任何 2 的幂的 MOD 都有一个等效的 AND 操作。如果你真的想测试差异，你需要让两个操作的右边都是可变的，并且为了绝对确保编译器的聪明不会阻碍你的努力，你需要隐藏变量' 在某个地方进行初始化，此时编译器无法判断它的运行时值是多少；即您需要将值作为参数传递给全局声明（即不是“静态”）测试函数，在这种情况下编译器无法追溯到它们的定义& 用常量替换变量，因为理论上任何外部调用者都可以为这些参数传递任何值。或者，您可以将代码留在 main() 中并全局定义变量，在这种情况下，编译器不能用常量替换它们，因为它不能确定另一个函数可能已经改变了全局变量的值。

Incidentally, this same issue exists for divide operations.... Divisions by constant powers-of-two can be substituted with an equivalent right-shift (>>) operation. The same trick works for multiplication (<<), but the benefits are less (or nonexistant) for multiplications. True division operations just take a long time in hardware, though significant improvements have been made in most modern processors vs. even 15 years ago, division operations still take maybe 80 clock cycles, while a >> operation takes only a single cycle. You're not going to see an "order of magnitude" improvement using bitwise tricks on modern processors, but most compilers will still use those tricks because there is still some noticeable improvement.

编辑：在一些嵌入式处理器上（尽管它是令人难以置信的，v8 之前的原始 Sparc 桌面/工作站处理器版本），甚至根本没有除法指令。此类处理器上的所有真正除法运算必须完全在软件中执行，这可能是一项极其昂贵的操作。在那种环境下，你肯定会看到一个数量级的差异。

# android - Android：以编程方式从图块集中提取图块？

> ID：11565666
> 
> 赞同：0
> 
> 时间：2012-07-19T16:53:50.463
> 
> 标签：android

如何以编程方式从图块集中提取图块，例如： http: [//opengameart.org/sites/default/files/grassland_tiles.png](http://opengameart.org/sites/default/files/grassland_tiles.png)

我想在我的游戏中使用这些图块。我看到这里的一些图块大小不同（或者可能所有图块都是某个固定大小的倍数）。例如，如果我想在我的程序中使用其中一个树图块，我如何才能确定我必须使用的图块集图像的偏移量，以及我必须提取多大的子图像？我没有看到任何与我可以使用的这些图块集相关的元数据。

另外，是否有一个 Android API 可以用来从更大的图像中提取图像的一部分？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T17:45:04.007

回答我自己的问题。我错过了从我得到这个 png 的页面上的以下行：

> 要使用 Tiled v0.8 中的 tile 集，请从 Flare git repo 获取必要的文件。

有问题的 git repro 在[这里](https://github.com/clintbellanger/flare/tree/master/tiled/grassland)，它似乎有几个描述图块集的元数据文件。

感谢所有评论的人。

# wpf - 更改 Expander 标头 ContentPresenter HorisontalAlign 属性

> ID：11565668
> 
> 赞同：1
> 
> 时间：2012-07-19T16:53:54.023
> 
> 标签：wpf, header, styling, expander, alignment

我想在 Expander 控件中有一个自定义标题。我想要一个左对齐的标题文本和一个右对齐的图片：

```
<Expander>
    <Expander.Header>
        <DockPanel LastChildFill="True" HorizontalAlignment="Stretch">
            <TextBlock DockPanel.Dock="Left" Text="Some Header Text"/>
            <Image DockPanel.Dock="Right" HorizontalAlignment="Right"  />
         </DockPanel>
     </Expander.Header>
     <StackPanel >
         <ItemsPresenter />
     </StackPanel>
</Expander> 
```

不幸的是，标题呈现在默认情况下不会水平拉伸的元素内部。该元素是一个 ContentPresenter 控件，默认情况下它不会拉伸，因为它的 HorisontalAlign 值为 Left。如果我将其更改为 Stretch（我已在 Snoop 工具中完成此操作），则标题将按照我的需要呈现。但是如何从代码中更改它？

我尝试使用正确的 Horizo​​ntalAlignment 值将 ContentPresenter 样式添加到 Expander 资源，但不幸的是它不起作用。可能 ContentPresenter 应用了一些自定义样式，这就是它没有抓住我的样式的原因。我试过这样：

```
<Expander.Resources>
    <Converters:TodoTypeToHeaderTextConverter x:Key="TodoTypeToHeaderTextConverter" />
    <Style TargetType="ContentPresenter">
        <Setter Property="HorizontalAlignment" Value="Stretch" />
    </Style>
</Expander.Resources> 
```

那我还能尝试什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T20:54:38.907

尝试这样的事情：

XAML 文件：

```
<Expander Name="exp" Header="test" Loaded="exp_Loaded">
            <Expander.HeaderTemplate>
                <DataTemplate>
                    <DockPanel LastChildFill="True" HorizontalAlignment="Stretch">
                        <TextBlock DockPanel.Dock="Left" Text="{Binding}"/>
                        <Image Source="/ExpanderStyle;component/animation.png" Width="20"
                               DockPanel.Dock="Right" HorizontalAlignment="Right" />
                    </DockPanel>
                </DataTemplate>
            </Expander.HeaderTemplate>                
        </Expander> 
```

代码隐藏：

```
private void exp_Loaded(object sender, RoutedEventArgs e)
        {
            var tmp = VTHelper.FindChild<ContentPresenter>(sender as Expander);
            if (tmp != null)
            {
                tmp.HorizontalAlignment = System.Windows.HorizontalAlignment.Stretch;
            }
        } 
```

和助手类：

```
public static class VTHelper
    {
        public static T FindChild<T>(DependencyObject parent) where T : DependencyObject
        {
            if (parent == null) return null;

            T childElement = null; 
            int childrenCount = VisualTreeHelper.GetChildrenCount(parent); 
            for (int i = 0; i < childrenCount; i++)
            {
                var child = VisualTreeHelper.GetChild(parent, i);
                T childType = child as T; 
                if (childType == null)
                {
                    childElement = FindChild<T>(child); 
                    if (childElement != null) 
                        break;
                }
                else
                {
                    childElement = (T)child; 
                    break;
                }
            } 
            return childElement;
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T09:09:17.500

解决此问题的另一种方法是编辑模板：[http](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/28a0f2d2-70cc-4935-9613-790ec0c8895a) ://social.msdn.microsoft.com/Forums/en-US/wpf/thread/28a0f2d2-70cc-4935-9613-790ec0c8895a 。

# cakephp - PostgreSQL 中自定义查询结果的 CakePHP 基于模型的数组填充

> ID：11565674
> 
> 赞同：3
> 
> 时间：2012-07-19T16:54:02.993
> 
> 标签：cakephp

我正在将数据库从 MySQL 迁移到 PostgreSQL，并且正在使用 CakePHP 访问数据。正常的模型方法（查找、删除、创建等）似乎按预期工作，但是当我使用查询方法运行自定义查询时，它似乎并没有按照我的预期填充结果数组。

例如，当使用 CakePHP 以 MySQL 作为数据库运行时，此代码：

```
$results = $this->Table1->query('SELECT Table1.*, Table2.* FROM Table1 LEFT JOIN Table2 USING (Field)'); 
```

产生以下数组

```
array(
   array('Table1' => array(<Table1Result1>), 'Table2' => array(<Table2Result1>))
   array('Table1' => array(<Table1Result2>), 'Table2' => array(<Table2Result2>))
   ...
   array('Table1' => array(<Table1ResultN>), 'Table2' => array(<Table2ResultN>))       
) 
```

当我使用 PostgreSQL 作为数据库运行类似的查询时，我得到以下数组：

```
array(
   array(0 => array(<Table1and2Result1Combined>))
   array(0 => array(<Table1and2Result2Combined>))
   ...
   array(0 => array(<Table1and2ResultNCombined>))
) 
```

有没有办法让 PostgreSQL 结果以与 MySQL 相同的方式返回？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-05-07T02:04:10.850

您必须像这样构建查询：

```
SELECT
  table1.field1 AS "Table1__field1",
  table1.field2 AS "Table1__field2"
FROM
  table1
; 
```

# ssl - 骨干网.js https

> ID：11565676
> 
> 赞同：5
> 
> 时间：2012-07-19T16:54:12.157
> 
> 标签：ssl, backbone.js, https

整个早上都在谷歌上搜索，但找不到答案。

官方文档上甚至没有“https”或“ssl”字样。

目前我有类似的东西：

```
var A = backbone.Collection.extend({
  url : "a"
}); 
```

有没有办法在不使用绝对路径的情况下制作 url https？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T17:05:28.840

我认为您不能将 URL 更改为 HTTPS，因为它只是为您的位置构建相对 URL。为什么不做这样的事情：

```
var A = Backbone.Collection.extend({
  url: function() {
    return "https://" + this.document.location.host + "/a";
  }
}); 
```

# ios - Mapbox ios SDK 子类 contentOffset 和 contentSize 或 UIpanGestures

> ID：11565680
> 
> 赞同：0
> 
> 时间：2012-07-19T16:54:26.440
> 
> 标签：ios, gestures, mapbox

我尝试将触摸事件从另一个 UIScrollView 子类发送到 Mapbox SDK，但我发现 RMMapview 中的 UIPanGestures 不是滚动视图上使用的。

那么，如何修改 RMMapview 和 RMMapScrollView 以识别 UIPangestures？据我所知， _RMMapScrollView 有它自己的手势，而 RMMapScrollView.contentOffset 是使用的值。

我的子类 > UIScrollview myScrollview

地图框 > RMMapview > _mapscrollview > _tiledLayersSuperview > tiledLayerView

使用值：_mapscrollview.contentoffset

[https://github.com/mapbox/mapbox-ios-sdk/blob/develop/MapView/Map/RMMapScrollView.m](https://github.com/mapbox/mapbox-ios-sdk/blob/develop/MapView/Map/RMMapScrollView.m)

[https://github.com/mapbox/mapbox-ios-sdk/blob/develop/MapView/Map/RMMapView.m](https://github.com/mapbox/mapbox-ios-sdk/blob/develop/MapView/Map/RMMapView.m)

我试过添加 @property (nonatomic,assign) RMMapScrollView* _RMMapScrollView; 到 RMMapview，但是在发送值时，它会崩溃。我已经调查过：#import。有人可以给我一些关于修改这个库的建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T20:56:38.887

我是 MapBox iOS SDK 背后的开发者。

之所以`RMMapView`有自己的手势识别器是为了平移“覆盖视图”，这是标记和矢量路径所在的位置，以便识别标记拖动等。

您可能想要做的是简化事情，并且不需要在 SDK 中工作，是使用公共 API`moveBy:`来响应您的其他触摸事件。该方法采用`CGPoint`并允许您以增量和编程方式移动地图视图，以照顾其他部分，例如复合切片图层、叠加视图等。

# wcf - WCF 70-513 练习考试疑点

> ID：11565683
> 
> 赞同：1
> 
> 时间：2012-07-19T16:54:32.137
> 
> 标签：wcf

**tl;博士**

*对于这个问题，答案应该是`AB`。`A`我能理解，但我找不到任何关于独立`CreateChannnel`方法的信息，比如它在`B`*

*谁能解释为什么答案`B`被认为是正确的或**不**正确的，我最好完全放弃这些练习考试？*

* * *

**背景**

我正在尝试`WCF`使用一些练习考试来学习。我已经遇到了几个问题，我不确定给定的答案是否正确。

以下问题，除了明显的拼写错误*（interetface INameService）*，严重增加了我的疑虑。

**问题是这样的**

> 问题 21
> 
> Windows Communication Foundation (WCF) 解决方案使用以下协定。（包含的行号仅供参考。）

```
01 [ServiceContract(CallbackContract=typeof(INameService))]   
02 public interface IGreetingService   
03 {   
04  [OperationContract]   
05  string GetMessage();  
06 }  
07  
08 [ServiceContract]
09 public intetface INameService 
10 { 
11  [OperationContract] 
12  string GetName(); 
13 } 
```

> 当客户端在服务接口上调用 GetMessage 时，服务在客户端回调上调用 GetName。在客户端，类NameService实现了回调合约。客户端通道创建如下：

```
22 InstanceContext callbackContext = new Instance Context(new NameService("client"));  
23  
24  
25 DuplexChannelFactory <IGreetingService> factory = 
    new DuplexChannelFactory<IGreetingServices>(typeof(NameService),binding,address);  
26 IGreetingService greetingService = factory.CreateChannel(); 
```

> 您需要确保服务回调由 NameService 的实例处理。实现这一目标的两种可能方法是什么？（每个正确答案都代表一个完整的解决方案。选择两个。）

**我可以从以下答案中进行选择**

> A.将第25行改为如下代码段：
> DuplexChannelFactory factory = new DuplexChannelFactory(callbackContext, binding, address);
> 
> B.将第26行更改为以下代码段：IGreetingService greetingServicefactory = CreateChannel(callbackContext);
> 
> C.在第26行之后添加如下代码段：
> callbackContextIncomingChannelsAdd((IDuplexChannel)greetingService)
> 
> D.在第26行之后添加如下代码段：
> callbackContext.OutgoingChannels.Add((IDuplexChannel)greetingService)

对于这个问题，答案应该是`AB`。`A`我能理解，但我找不到任何关于独立`CreateChannnel`方法的信息，比如它在`B`

谁能解释为什么答案`B`被认为是正确的或**不**正确的，我最好完全放弃这些练习考试？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T17:42:40.833

答案 B 是印刷错误。它应该是：

```
IGreetingService greetingService = factory.CreateChannel(callbackContext); 
```

# asp.net - 动态生成的代码隐藏按钮不会触发其事件

> ID：11565684
> 
> 赞同：1
> 
> 时间：2012-07-19T16:54:35.757
> 
> 标签：asp.net, vb.net

我有一系列控件（3 个标签、3 个文本框和 2 个按钮），这些控件是在用户单击我页面上的按钮时创建的。该页面使用将生成这些控件的命令进行回发。但是，当我填写我的文本框并单击一个新生成的按钮 ( `btnCreate`) 时，什么也没有发生，页面只是再次重新加载。

我想要发生的是，当用户单击时`btnCreate`，它会触发其功能，并将其`TextBox.Text`放入数据库中。但同样，当`btnCreate`被点击时，什么也没有发生。

这是生成按钮的代码（与生成文本框的函数相同，我在此处排除了它）：

```
Protected Sub createSpecialNotes()
    Dim btnCreate As Button = New Button
    Dim btnClear As Button = New Button

    'Place properties

    lblSubject.Text = "subject"
    lblSubject.ID = "lblSubject"
    lblSubject.Width = 700
    lblAgenda.Text = "Agenda Note"
    lblAgenda.ID = "lblAgenda"
    lblAgenda.Width = 700
    lblMinutes.Text = "Minutes Note"
    lblMinutes.ID = "lblMinutes"
    lblMinutes.Width = 700

    btnCreate.Text = "Create"
    btnCreate.ID = "btnCreate"
    btnClear.Text = "Clear"
    btnClear.ID = "btnClear"

    'Add handlers for buttons
    AddHandler btnCreate.Click, AddressOf btnCreate_Click
    AddHandler btnClear.Click, AddressOf btnClear_Click

    plhCreateSpecialNotes.Controls.Add(btnCreate)
    plhCreateSpecialNotes.Controls.Add(btnClear)
End Sub 
```

为了简单起见，我们只说`btnCreate`需要显示文本框的内容。

**Edit1：**创建特殊注释的调用在 page_preInit 上。它的调用包括以下内容

```
 Protected Sub Page_PreInit(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.PreInit
    'Find the control that was fired
    Dim controlFired As Control = GetPostBackControl(Me.Page)

    If (controlFired IsNot Nothing) Then
        If (controlFired.ClientID.ToString() = "btnCreateSpecial") Then
            Call createSpecialNotes()
        End If
        If (controlFired.ClientID.ToString() = "btnCreate") Then
            'i've tried putting things here to no avail.
        End If
    End If

End Sub 
```

函数 getpostbackcontrol 看起来像这样

```
 Public Shared Function GetPostBackControl(ByVal thePage As Page) As Control
    Dim myControl As Control = Nothing
    Dim ctrlName As String = thePage.Request.Params.Get("__EVENTTARGET")
    If ((ctrlName IsNot Nothing) And (ctrlName <> String.Empty)) Then
        myControl = thePage.FindControl(ctrlName)
    Else
        For Each Item As String In thePage.Request.Form
            Dim c As Control = thePage.FindControl(Item)
            If (TypeOf (c) Is System.Web.UI.WebControls.Button) Then
                myControl = c
            End If
        Next

    End If
    Return myControl
End Function 
```

我希望这有助于弄清楚我为什么会遇到麻烦。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T16:58:17.880

这里真正有用的是知道你什么时候打电话`createSpecialNotes()`。但很可能您缺少的是页面的生命周期。

确保`createSpecialNotes()`调用`OnInit`您的页面。之后的任何事情都为时已晚，您的事件处理程序将不会被解雇。

如果`OnLoad`到达您的页面并且您尚未将处理程序绑定到您的控件，则不会触发它。

我建议你仔细阅读这篇文章。[http://msdn.microsoft.com/en-us/library/ms178472.aspx](http://msdn.microsoft.com/en-us/library/ms178472.aspx)

# android - Android ADB 再分配

> ID：11565689
> 
> 赞同：5
> 
> 时间：2012-07-19T16:54:49.577
> 
> 标签：android, installation, licensing, usb, adb

您是否允许将 Android ADB 重新分发给最终用户？

安装程序中是否包含分发包/包？

我们正在考虑使用它来在我们的 Android 应用程序和桌面应用程序之间提供 USB 连接。在这种情况下，您有什么更好的方法可以建议轻松建立 USB 桥接器吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-23T19:29:58.040

我相信分发 Android adb 可执行文件是完全合法的。[android sdk 在http://developer.android.com/sdk/terms.html](http://developer.android.com/sdk/terms.html)的 SDK 许可协议有以下条款：

> 3.5 根据开源软件许可许可的 SDK 组件的使用、复制和分发仅受该开源软件许可条款而非本许可协议的约束。

由于位于 platform/system/core/adb 的 android 树下的 adb 客户端在[http://www.apache.org/licenses/LICENSE-2.0](http://www.apache.org/licenses/LICENSE-2.0)下获得许可，因此它应该是完全合法的。

但我不是律师，所以不要认为我的话是理所当然的，并寻求专业建议。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-26T14:51:08.997

只是为了关闭这个问题，并可能在未来帮助其他人解决类似问题：

似乎不允许重新分发 Android SDK（包括 ADB）。引自[Android 的 T&C](http://developer.android.com/sdk/terms.html)：“3.3 除适用的第三方许可要求的范围外，您不得复制（出于备份目的）、修改、改编、重新分发、反编译、逆向工程、反汇编或创建 SDK 的衍生作品或SDK 的任何部分。除适用的第三方许可要求外，您不得将 SDK 的任何部分加载到手机或除个人计算机以外的任何其他硬件设备上，不得将 SDK 的任何部分与其他软件结合，或分发任何软件或设备包含 SDK 的一部分。”</p>

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T14:54:34.857

AOSP 包括 ADB 源代码并具有相当宽松的许可条款，因此如果您确定这些与您的需求兼容，您可以自己构建 ADB。在不构建其余部分的情况下构建它有点棘手，但如果您仔细构建 Makefile 并从实用程序文件夹中移动一些包含和依赖项，则可以完成。

# php - 跨多个服务器的上次修改日期

> ID：11565692
> 
> 赞同：1
> 
> 时间：2012-07-19T16:55:00.670
> 
> 标签：php, apache, http-headers

我正在努力改进浏览器缓存。我有一个有多个服务器的客户端。当发出请求时，服务器将缓存响应。我一直只使用 max-age 设置来设置浏览器缓存，但我看到谷歌说你还需要提供 max-age 和 last-modified 标头才能在所有浏览器上正确缓存。

我的情况是多个服务器上的 Last-Modified 日期可能不同，但内容相同。如果我使用最后一个 mod 日期并且浏览器看到另一台服务器有不同的日期，即使没有达到 max-age，它会重新下载文件吗？

# java - 现有文件上的 java.io.FileNotFoundException

> ID：11565694
> 
> 赞同：8
> 
> 时间：2012-07-19T16:55:13.400
> 
> 标签：java, filenotfoundexception, java-io

当我尝试打开文件时出现此错误：

```
java.io.FileNotFoundException: D:\Portable%20Programs\Android%20Development\workspace3\XXX-desktop\bin\World_X.fr (The system cannot find the path specified)
    at java.io.FileInputStream.open(Native Method)
    at java.io.FileInputStream.<init>(Unknown Source)
    at java.util.Scanner.<init>(Unknown Source) 
```

该文件存在于目录中，但我仍然收到此错误。但是，当我在 Eclipse 工作区 Project src 文件夹中复制相同的文件时，不会返回此类异常（尽管此方法还会在 bin 文件夹中创建 World_X.fr 文件）。

我实际上想做的是通过以下方式获取 .jar 文件的绝对位置：

```
fileLocation = new String(Main.class.getProtectionDomain().getCodeSource().getLocation().getPath()); 
```

然后我将“World_X.fr”附加到 fileLocation 字符串，但这不起作用。请在这方面帮助我。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-07-19T17:58:58.863

`file:`将URL 转换为实际 URL的首选方法`File`是：

```
File file = new File(url.toURI()); 
```

这负责**所有**检查和引用/转义。

相反，使用`getPath()`这些奇数位将由您决定。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-07-19T16:57:44.573

您需要取消转义`%20`to 空间。例如：

```
fileLocation = new String(
    Main.class.getProtectionDomain().getCodeSource().getLocation().getPath())
    .replaceAll("%20", " "); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-05-24T06:48:51.900

这是解决方案，仅在JDK1.5之后才有效，

```
try { f = new File("somePath".toURI().getPath()); } catch(Exception e) {} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-04-30T11:21:44.600

已确认的解决方案相当陈旧，即使它适用于这种特殊情况，使用 URLDecoder 也更方便，因为 %20 只是一个编码字符，但在您的路径中可能有很多不同的编码字符。

```
fileLocation = URLDecoder.decode(Main.class.getProtectionDomain().getCodeSource().getLocation().getPath(), "UTF-8"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-19T16:58:07.500

尝试省略 %20，并改用普通空格。此外，您在代码中使用反斜杠，如果您使用反斜杠，请确保先转义它们。

# google-app-engine - GAE：此应用程序不允许 API 服务

> ID：11565699
> 
> 赞同：1
> 
> 时间：2012-07-19T16:55:26.333
> 
> 标签：google-app-engine

我正在尝试遵循以下教程：[http ://www.youtube.com/watch?v=v9TG7OzsZqQ](http://www.youtube.com/watch?v=v9TG7OzsZqQ)

我的 Cloud Endpoint REST API 在我的本地开发机器上运行良好，但是当我部署到 App Engine 时，我在管理日志中收到错误消息，即“此应用程序不允许 API 服务”。

这是我必须启用帐单才能接收的付费功能吗？如果没有，是否有解释此问题以及如何解决此错误的文档？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T17:19:59.287

要在生产中使用 Endpoints，您需要加入受信任的测试程序。你可以[在这里](http://endpoints-trusted-tester.appspot.com)申请。在您的请求中提及此 Stack Overflow 帖子，我会看看是否可以加快批准速度。

# javascript - 检查 qunit 中的两个异步调用

> ID：11565705
> 
> 赞同：0
> 
> 时间：2012-07-19T16:55:49.287
> 
> 标签：javascript, qunit

我如何编写一个产生两个异步回调的操作并且我希望测试在两个回调都被调用时结束的场景？

```
asyncTest('Do two asynchronous things', 2, function() {
    doTwoThings(callback1, callback2);
    function callback1() {
        ok(true, 'dummy test');
        start();
    }
    function callback2() {
        ok(true, 'dummy test');
        start();
    }
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-23T09:47:44.257

答案是使用您期望的额外启动次数调用停止。asyncTest 需要一个开始，所以对于我的情况，我必须添加另一个调用来停止。

```
asyncTest('Do two asynchronous things', 2, function() {
    stop()
    doTwoThings(callback1, callback2);
    function callback1() {
        ok(true, 'dummy test');
        start();
    }
    function callback2() {
        ok(true, 'dummy test');
        start();
    }
}); 
```

# javascript - 如何使用 jQuery 从某些（多个）类中获取所有元素？

> ID：11565707
> 
> 赞同：0
> 
> 时间：2012-07-19T16:55:58.303
> 
> 标签：javascript, jquery, forms, jquery-selectors

我想获取所有具有此类的字段：“requiredField Validate”。

代码示例：

```
<form id="myForm">
<input type="text" class="requiredField X"> Text1
<input type="text" class="requiredField Y"> Text2
<input type="text" class="requiredField Validate"> Text3
<input type="text" class="requiredField Validate"> Text4
<input type="text" class="requiredField Z"> Text5
</form> 
```

如何使用 jQuery 做到这一点？

我试图这样做但没有成功：

```
$('.requiredField.Validate').each(function() {...
$('form.myForm.Validate')
$('.requiredField Validate') 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T17:04:09.637

尝试这个

```
$('.requiredField.Validate'); // Will select elements that has both classes. 
```

[这是一个示例](http://jsfiddle.net/heera/VNrpe/)，请参见控制台。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-19T17:00:10.527

You can do it this way,

**[Live demo](http://jsfiddle.net/rajaadil/LRL3v/)**

```
$('.requiredField.Validate') 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-19T16:59:35.083

试试这个：

```
$('.requiredField').filter('.Validate'); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-19T16:59:55.620

就像在 CSS 中一样

```
$('.requiredField .Validate') 
```

这意味着与 .requiredField 相关的每个 .Validate 都是 true

不同之处

```
$('.requiredField, .Validate') 
```

这意味着`.Validate`或`.requiredField`。

# php - 用户输入/单击时按钮样式丢失。

> ID：11565710
> 
> 赞同：0
> 
> 时间：2012-07-19T16:56:12.437
> 
> 标签：php, css

我有下面的按钮，我正在尝试通过 css 设置样式。不幸的是，随着用户单击按钮，样式消失了，只有在重新加载页面时才重新出现，之后，当用户单击时，样式再次丢失......等等，等等。

PHP

```
<?php
if ($users != $user->id && $users != '' && $user->id != '') 
{
    if ($followers == 'all') 
    {
    ?>
        <input type="button" name="unfollow" value="Unfollow" id="unfollow"  onclick="unfollowall(<?php echo $user->id . ',' . $users; ?>,'<?php echo $fBoardId; ?>');" />
    <?php
    } 
    else 
    {
    ?>
        <input type="button" name="followall" value="Follow All" id="followall" onclick="followall(<?php echo $user->id . ',' . $users; ?>,'<?php echo $fBoardId; ?>');"/>
    <?php
    }
}
?> 
```

我怎样才能让按钮不断地被设计？

# c# - 无法成功克隆 XMLReader（意外 EOF）

> ID：11565711
> 
> 赞同：1
> 
> 时间：2012-07-19T16:56:12.537
> 
> 标签：c#, xml, xml-serialization, clone, xmlreader

我对 XMLReader/XMLTextReader 类有一个非常奇怪的问题。

我有一个简单的文件加载：

```
public void First()
{
    XmlTextReader reader = new XmlTextReader(@"C:\MyXMLFile.xml");
    XmlReader readerToSerialize;
    XmlReader readerToLoad;
    DuplicateReaders(reader, out readerToSerialize, out readerToLoad);
    XmlSerializer serializer = new XmlSerializer(typeof(XMLTree));
    XmlFeed = (XMLDescriptor)serializer.Deserialize(readerToSerialize);
    xmlDoc.Load(readerToLoad);
}
protected void DuplicateReaders(XmlTextReader xmlReader, out XmlReader cloneOne, out readerToLoad)
{
    XmlDocument _XmlDocument = new XmlDocument();
    MemoryStream _Stream = new MemoryStream();
    _XmlDocument.Load((XmlTextReader)xmlReader);
    _XmlDocument.Save(_Stream);
    _Stream.Position = 0L;
    cloneOne = XmlReader.Create(_Stream);
    _Stream.Position = 0L;
    cloneTwo = XmlReader.Create(_Stream);
} 
```

问题是只有一个克隆元素成功读取了整个文件，下一个（xmlDoc.Load）总是在同一个地方失败（第 91 行，此 xml 文件的第 37 行字符）。如果我直接分配给 xmlDoc（即只克隆一次原始元素并直接从函数中分配它）：

```
public void First()
{
    XmlTextReader reader = new XmlTextReader(@"C:\MyXMLFile.xml");
    XmlReader readerToSerialize;
    DuplicateReaders(reader, out readerToSerialize);
    XmlSerializer serializer = new XmlSerializer(typeof(XMLTree));
    XmlFeed = (XMLDescriptor)serializer.Deserialize(readerToSerialize);
}
protected void DuplicateReaders(XmlTextReader xmlReader, out XmlReader cloneOne)
{
    XmlDocument _XmlDocument = new XmlDocument();
    MemoryStream _Stream = new MemoryStream();
    _XmlDocument.Load((XmlTextReader)xmlReader);
    _XmlDocument.Save(_Stream);
    _Stream.Position = 0L;
    cloneOne = XmlReader.Create(_Stream);
    _Stream.Position = 0L;
    this.xmlDoc.Load(_Stream);
} 
```

我仍然收到相同的错误 91/37（意外 EOF），但这次是在序列化程序中。

我最初的问题是，如果我使用`xmlDoc.Load(reader)`读取器实例会被破坏，并且以后无法对其进行序列化。我在 MSDN 论坛上找到了 Duplicate 功能，但仍然不行。我想要实现的非常简单：

仅使用一个阅读器并获得一个 XmlDocument 和一个序列化类。它能有多难？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:58:42.043

您需要先关闭第一个阅读器，然后才能使用副本。

```
reader.Close() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T18:00:27.907

您的 cloneOne 和 cloneTwo 都使用相同的底层内存流。

使用不同的 MemoryStream

```
cloneTwo = XmlReader.Create(new MemoryStream(_Stream.ToArray())); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T18:04:01.370

找到了更简单的解决方案，而不是克隆两个阅读器，我只是使用从 XmlDoc 创建第二个阅读器并使用它来反序列化。

# java - 加入线程时处理异常的最佳方法

> ID：11565720
> 
> 赞同：3
> 
> 时间：2012-07-19T16:57:01.527
> 
> 标签：java, multithreading, exception-handling, concurrency

出于某种原因，我对以下内容感到困惑：
假设我在完成处理`Thread A`后*绝对*需要执行。 一种方法是加入. 简单的例子： `Thread B`
`Thread A``Thread B`

```
public class MainThread {  
    public static void main(String[] args){   
        Thread b = new Thread (new SomeRunnable(args[0]));  
        b.start();  
        try {   
            b.join();   
        } catch(InteruptedException e) {  
        }  
        // Go on with processing  
    }
} 
```

我的问题如下：在这种情况下处理异常的正确方法是什么？

在我看到的各种示例中，即使在教科书中，也忽略了异常。
因此，如果`Thread A`需要确保`Thread B`在继续之前完全完成，如果我因异常而最终被捕获，是否`Thread B`可能仍然是实际可运行/正在运行的情况？那么处理此异常的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T17:04:18.653

> 在这种情况下处理异常的正确方法是什么？

任何时候你得到一个`InterruptedException`当前线程都应该认为自己被中断了。通常，这意味着线程应该自行清理并退出。在您的情况下，主线程被另一个线程中断，并且可能应该中断`Thread a`它依次启动的线程，然后退出。

尽管是否应该忽略中断取决于您，但我建议这是一种不好的做法。如果您将中断用作线程的某种信号，那么我会设置一些`volatile boolean`标志。

就 catch 时的最佳实践而言`InterruptedException`，我通常会这样做：

```
try {
    ...
} catch(InterruptedException e){  
    // a good practice to re-enable the interrupt flag on the thread
    Thread.currentThread().interrupt();
    // in your case you probably should interrupt the Thread a in turn
    a.interrupt();
    // quit the thread
    return;
} 
```

由于捕获`InterruptedException`清除线程的中断标志，因此在 catch 块中重新启用中断标志总是一个好主意。

> 在我看到的各种示例中，即使在教科书中，也忽略了异常。

的确。*忽略任何*异常是非常糟糕的做法，但它一直在发生。不要屈服于黑暗势力！

> 线程 B 可能实际上仍然可以运行/正在运行吗？

`Thread B`肯定还能运行。调用`join()`被中断的是主线程。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T17:07:53.523

首先，您必须了解引发此异常的原因。当前不推荐调用`stop()`线程，而是当您想要停止线程时，您可以通过调用来*中断*`thread.interrupt()`它。这对线程没有影响（！），线程必须不时地显式检查`interrupted`标志并优雅地停止处理。

但是，如果线程休眠，等待锁或另一个线程（通过`join()`在您的示例中使用类似），它无法立即或经常检查此标志。在这些情况下，JVM 会从阻塞方法中抛出一个异常（让它发生`join()`），向你的线程发出信号，表明有人刚刚尝试中断它。通常，您可以忽略该异常（意思是-不要记录它）-重要的是副作用。例如打破循环：

```
public void run() {
    try {
        while(!isInterrupted()) {
            Thread.sleep(1000);
            //...
    } catch(InterruptedException e) {
        //no need to log it, although it's a good idea.
    }
} 
```

您没有记录该异常不是问题 - 但您从循环中逃脱，有效地终止了线程。

现在回到你的问题。当您`Thread A`被中断时，意味着其他线程请求终止它，可能是因为整个 JVM 关闭或 Web 应用程序正在取消部署。在这种情况下，除了清理之外，您不应该做任何事情。

此外，它很可能意味着`Thread B`仍在运行。但是 JVM 想说的是：“*危险！危险！停止等待你等待的任何东西并运行！* ”。

# mysql - 准确计算此 JOIN

> ID：11565723
> 
> 赞同：0
> 
> 时间：2012-07-19T16:57:17.063
> 
> 标签：mysql, join

此查询工作正常。它给出了比赛参赛者的数量，他们在比赛条目中的联系人 ID 是他们在人员表中的 origin_contact。

```
SELECT c.handle, COUNT(*)        
FROM `contest_entry` ce,         
person p,                        
contest c                        
WHERE                            
p.origin_contact = ce.contact AND
c.id = ce.contest                
GROUP BY c.id 
```

我现在想查询其中有多少记录还至少有一条记录，其中联系人 ID 与 email_list_subscription_log 中的联系人 ID 匹配，但该表可能包含任何一个联系人 ID 的许多日志记录。

如何编写一个联接，使我的计数不会被多条记录夸大？

我是否应该使用我的第一个查询的版本将所有联系人 ID 放入 tmp 表中并使用它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T17:05:37.873

不确定哪个字段是联系人 ID，但您可以执行以下操作：

```
select c.handle,
    count(*) as count
from `contest_entry` ce
inner join person p on p.origin_contact = ce.contact
inner join contest c on c.id = ce.contest
where exists (
        select 1
        from email_list_subscription_log l
        where l.contact_id = ce.contact
        )
group by c.id 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T17:07:53.900

您应该使用 DISTINCT 或 GROUP 对 email_list_subscription_log 进行压缩：

```
SELECT c.handle, COUNT(*)        
    FROM `contest_entry` ce
    JOIN person p ON (p.origin_contact = ce.contact)
    JOIN contest c ON (c.id = ce.contest)
    JOIN (SELECT DISTINCT contact, email FROM email_list_subscription_log ) AS elsuniq
         ON (ce.contact = elsuniq.contact)
[ WHERE ]           
GROUP BY c.id 
```

在子查询中使用 GROUP 您可以计算记录数，同时仍为每个元素返回一行：

```
 JOIN (SELECT contact, count(*) AS elsrecords FROM email_list_subscription_log
          GROUPY BY contact) AS elsuniq 
```

使用这种 JOIN 语法，WHERE 不是必需的，但如果您需要额外的过滤，我会保留它。

# mysql - MySQL缓存何时以及如何工作？

> ID：11565724
> 
> 赞同：3
> 
> 时间：2012-07-19T16:57:17.787
> 
> 标签：mysql

```
SELECT SQ_CACHE * FROM TABLE where ID=1 
```

**问题**：

*   如果向表中添加新行，是否仍会保留缓存？
*   如果更新以外的行`ID=1`仍然保持我的缓存？
*   我知道如果同一行更新缓存丢失。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T17:00:49.980

1.  Read up on cache-invalidation (here's [the first hit I found](http://www.mysqlperformanceblog.com/2011/04/04/mysql-caching-methods-and-tips/)). MySQL (or any RDBMS) will invalidate (parts of) cached data whenever it needs to. When it *actually* does this *should* * not be of your concern; let MySQL (or any RDBMS) handle it. The actual process is (or can be) very complex; that's why this stuff is abstracted away and handled by the RDBMS for you. Same goes for actual storage of data on disk; do you care? Or do you let the RDBMS handle it for you? See? ;-)
2.  See 1.
3.  There you go. (And how is this a question? :P )

* Aside from some corner-cases or bugs maybe.

The "short" answer (note: specific to MySQL) would be: **AFAIK** MySQL caches on table level granularity; so any change on that table would invalidate all cached results for that table. Other than that, only deterministic queries will get cached, transactions might bypass/invalidate caches, the query cache doesn't support prepared statements, queries must be absolutely exactly be the same for the cache to kick in at all (so an extra space in a query would cause a cache miss) and subqueries aren't supported. And then there are still other factors involved. Maybe some things have changed in more recent versions but these are, some (not all!) of the factors that used to be involved. Correct me if I'm wrong.

# html - 将此菜单放在左上角 HTML CSS

> ID：11565725
> 
> 赞同：0
> 
> 时间：2012-07-19T16:57:21.387
> 
> 标签：html, css

我希望垂直菜单完全位于左上角，但现在仍然有大约 2px 的顶部和左侧边距，我不知道为什么，所有边距都设置为 0。有人知道吗？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T17:04:13.697

添加`margin: 0px;`到您的页面正文标记。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T16:59:38.847

正文标签上设置了边距，请尝试：

```
body { margin:0; padding:0; } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T17:00:02.040

You need to set `margin: 0` on the `body` (live editing via Developer Tools solves it for me).

And learn to use Developer Tools ;)

Using Chrome, it showed me you had something like this:

```
body {
  display: block;
  margin: 8px;
} 
```

from the user agent stylesheet.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T16:59:12.367

你使用了一些 CSS 重置？如果没有，请使用： http: [//meyerweb.com/eric/tools/css/reset/](http://meyerweb.com/eric/tools/css/reset/)。或者，如果您想要更快的解决方案，请使用`body {margin: 0; padding: 0;}`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-19T17:00:59.263

I'm guessing that there are still default margins on the page. Try using a [CSS reset file](http://www.cssreset.com/). This will make sure that the margin and padding are all 0 when you start (along with some other nice resets).

# c# - 如何将 SelectedListViewItemCollection 转换为 ListViewItemCollection

> ID：11565730
> 
> 赞同：1
> 
> 时间：2012-07-19T16:57:45.630
> 
> 标签：c#, winforms, listview

我正在尝试编写一个简单的例程来处理 ListView 中的项目列表，并能够处理所有项目或仅处理选定的项目。我希望这会起作用：

```
private void PurgeListOfStudies(ListView.ListViewItemCollection lvic)
{
    /// process items in the list...
} 
```

然后这样称呼它：

```
PurgeListOfStudies(myStudiesPageCurrent.ListView.Items); 
```

或这个

```
PurgeListOfStudies(myStudiesPageCurrent.ListView.SelectedItems); 
```

但是，这两个列表分别具有不同且不相关的`ListViewItemCollection`类型 `SelectedListViewItemCollection`。

我尝试将参数的类型更改为`object`，`ICollection<ListViewItem>`以及其他几件事。但是由于这些类型似乎完全不相关，所以无论是在编译时还是在强制转换期间的运行时，一切都会失败。

这一切对我来说似乎很奇怪，因为它们在现实中显然是相同的类型（`ListViewItem`s 列表）。

我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T17:15:32.587

使用 MSDN 文档。

*   [ListViewItemCollection](http://msdn.microsoft.com/en-us/library/system.windows.forms.listview.listviewitemcollection.aspx)
*   [SelectedListViewItemCollection](http://msdn.microsoft.com/en-us/library/system.windows.forms.listview.selectedlistviewitemcollection.aspx)

如您所见，两个类都实现了接口：[IList](http://msdn.microsoft.com/en-us/library/system.collections.ilist.aspx)、[ICollection](http://msdn.microsoft.com/en-us/library/system.collections.icollection.aspx)和[IEnumerable](http://msdn.microsoft.com/en-us/library/system.collections.ienumerable.aspx)。您应该能够将其中任何一个用作通用接口。

请注意，这些*不是*通用版本（即 IEnumerable<T>)）。您必须枚举集合并手动将它们转换为所需的对象类型。

```
private void PurgeListOfStudies(IEnumerable items)
{
    foreach(MyType currentItem in items) //implicit casting to desired type
    {
        // process current item in the list...
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-10-23T16:34:10.080

If you wanted to make PurgeListOfStudies a little more type safe, you could make it take a parameter of type `IEnumerable<ListViewItem>` like so:

```
private void PurgeListOfStudies(IEnumerable<ListViewItem> items)
{
    /// process items in the list...
} 
```

and call it like this:

```
PurgeListOfStudies(myStudiesPageCurrent.ListView.Items.OfType<ListViewItem>()); 
```

or this:

```
PurgeListOfStudies(myStudiesPageCurrent.ListView.SelectedItems.OfType<ListViewItem>()); 
```

The `OfType<ListViewItem>()` extension method turns a non-generic `IEnumerable` into the more type safe `IEnumerable<ListViewItem>`.

Edit: If you're annoyed by having to explicitly call `OfType<ListViewItem>()` you could add extension methods to ListView:

```
static class ListViewExtensions
{
    public static IEnumerable<ListViewItem> SelectedListViewItems(this ListView listView)
    {
        return listView.SelectedItems.OfType<ListViewItem>();
    }

    public static IEnumerable<ListViewItem> ListViewItems(this ListView listView)
    {
        return listView.Items.OfType<ListViewItem>();
    }
} 
```

and then call

```
PurgeListOfStudies(myStudiesPageCurrent.ListView.ListViewItems()); 
```

or

```
PurgeListOfStudies(myStudiesPageCurrent.ListView.SelectedListViewItems()); 
```

# python - Python TkInter - 将标签分配给不确定数量的图像

> ID：11565734
> 
> 赞同：1
> 
> 时间：2012-07-19T16:57:59.840
> 
> 标签：python, tkinter

我正在开发一个显示一系列壁纸图像并允许用户选择一个作为应用程序背景的应用程序。

应用程序读取目录并显示目录中的所有 .JPG 图像。因此，它需要能够允许用户从不确定长度的选项列表中单击任何选项。

问题是：单击列表中的任何壁纸只会传入选项以更改为列表中的最后一个壁纸（即循环变量迭代，我希望调用的方法来捕获循环变量的值在我分配标签的迭代中）。

以下是相关的代码块：

```
for i in range(0,(howManyWalls-1)):
    #Update position
    if i % 3 == 0:
        startX=x0+10
        startY=startY+160
    else:
        startX=startX+160

self.options.append(Image.open("../includes/wallpaper/wall"+str(i+1)+".jpg"))
self.options[i].thumbnail((150,150),Image.ANTIALIAS)
self.optionThumbs.append(ImageTk.PhotoImage(self.options[i]))
self.optionThumbsDisp.append(canvas.create_image(startX,startY,anchor=NW, image=self.optionThumbs[i]))
canvas.tag_bind(self.optionThumbsDisp[i],"<Button-1>", lambda x: self.changeWallpaper(canvas,w,h,(i+1))) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T17:29:54.900

这实际上是使用 lambdas 时经常被问到的问题。误解是`i`lambda 函数内部的变量在某种程度上与`i`外部变量不同。换句话说，你正在做这样的事情：

```
i=3
def foo():
    print i
i=4
foo()  #prints 4, when you expected 3 
```

就常规函数而言，“冻结” i 值的一种方法是使用关键字参数，因为在创建函数时会评估这些参数：

```
i=3
def foo(i=i):
    print i
i=4
foo()  #prints 3, you're happy now. 
```

同样的事情可以应用于 lambda 函数：

```
canvas.tag_bind(self.optionThumbsDisp[i],"<Button-1>", lambda x,i=i: self.changeWallpaper(canvas,w,h,(i+1)) 
```

现在，（希望）它有效。

# shell - 运行单个命令有效，但在 shell 脚本中组合时无效。为什么？

> ID：11565741
> 
> 赞同：0
> 
> 时间：2012-07-19T16:58:18.047
> 
> 标签：shell, mount

我需要在 shell 脚本中运行以下命令集

```
modprobe nbd
sudo qemu-nbd -c /dev/nbd0 path/to/image/file
sudo mount /dev/nbd0p1 /mnt/temp
python copyFiles.py
sudo umount /mnt/temp
sudo qemu-nbd -d /dev/nbd0
sudo rmmod nbd 
```

当我单独运行这些命令时，它工作正常，但是当我将它们放入 shell 脚本并执行该 shell 脚本时，我总是在`mount`命令中出现错误。

`sleep 1`所以我之前投入了一个`mount`，它按预期工作。

这背后的原因可能是什么？（某种异步呼叫注册延迟/竞争条件？）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T17:03:33.033

mount 和前面的命令都需要升级权限。当 mount 尝试运行时，它是否会导致上一个命令中的锁仍然存在？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T17:09:14.947

> 挂载错误：挂载点 /mnt/temp 不存在

因此，`/mnt/temp`当您将其作为 shell 脚本运行时，该目录似乎不存在。只需在 mount 命令之前的某个位置创建它或将其添加到脚本中：

```
mkdir /mnt/temp 2>&1 /dev/null 
```

# php - 已设置参数时通过 URL 预填充表单

> ID：11565754
> 
> 赞同：0
> 
> 时间：2012-07-19T16:58:45.540
> 
> 标签：php, forms, url, href

我想生成一个指向该网站的链接，其中已经设置了某些参数。问题是：URL 中已经设置了参数（即识别经销商的密码）。

这是表单的 URL：

> [https://www.youcangetacar.com/formstep2.php?Pin=A186&Submit=Submit+To+Final+Step](https://www.youcangetacar.com/formstep2.php?Pin=A186&Submit=Submit+To+Final+Step)

我尝试了以下方法。

> [https://www.youcangetacar.com/formstep2.php?Pin=A186](https://www.youcangetacar.com/formstep2.php?Pin=A186) **&fname=ASDF** &Submit=Submit+To+Final+Step

我也尝试在提交之后在 pin 之前添加它。我是否必须设置*所有*参数才能正常工作？我必须指定表单集吗？我已经看到使用数组完成了这项工作；那行得通吗？

另外，应该注意的是，我无权访问此网页。

感谢您的任何提示，建议！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T17:23:36.277

查询字符串中参数的顺序并不重要，但正如上面的“blockhead”所说，如果页面的作者不允许你这样做，你就不能预先填充页面。

页面背后的 PHP 可以根据程序员选择的任何逻辑生成 HTML 表单；它不会自动从查询字符串中预填充输入字段，除非代码明确打印出该数据。

可能是该页面背后的程序员没有考虑这种可能性，或者他们可能出于安全或技术原因故意避免它。

# android - iOS 和 Android 是否支持 XML 的 UTF-16 文本编码

> ID：11565755
> 
> 赞同：0
> 
> 时间：2012-07-19T16:59:09.870
> 
> 标签：android, objective-c, ios, xml, character-encoding

希望这是一个快速的答案，只需要一个可靠来源的链接。

有谁知道在哪里可以找到 iOS（特别是 NSXMLParser）支持的 XML 文本编码格式列表，并且它与 Android 等效？

**具体来说，是否支持 UTF-16？**

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T18:21:32.613

我找不到来自 Apple 的特别声明支持 UTF-16 的来源，但[XML 规范](http://www.w3.org/TR/xml/#charsets)指出所有 XML 解析器都必须接受 UTF-8 和 UTF-16 编码，所以我认为可以安全地假设 NSXMLParser 符合. 您可以随时对其进行测试，看看它是否支持任何给定的编码。

对于实际上不支持的编码，您可以使用 NSString/CFString 方法将它们转换为支持的编码。

# delphi - Delphi数学优化技术包括单纯形或遗传算法等

> ID：11565760
> 
> 赞同：0
> 
> 时间：2012-07-19T16:59:13.133
> 
> 标签：delphi, pascal, genetic-algorithm, mathematical-optimization

只是想知道是否有人对 Delphi 的优化实用程序有建议。例如单纯形，遗传算法等...

基本上我需要将我的总体模型优化为一个完整的黑盒函数，在预先确定的边界内输入变量，如倾斜角或数组大小。输出通常是平滑的曲线，通常没有假峰。

旧的 NR Pascal 东西看起来有点过时（没有函数作为变量等）。

非常感谢，布赖恩

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T10:38:16.367

I found a program, written in Pascal, that simulates the Simplex method. It's a little old, but you may convert it into Delphi. You can find it

[here](http://jean-pierre.moreau.pagesperso-orange.fr/p_linear.html)

I hope it's of some use to you.

PS: If you have some cash to spend, try

[here](http://www.dewresearch.com/delphi)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T02:21:23.753

TSimplex 类 [https://iie.fing.edu.uy/svn/SimSEE/src/rchlib/mat/usimplex.pas](https://iie.fing.edu.uy/svn/SimSEE/src/rchlib/mat/usimplex.pas)

对于混合整数单纯形 TMIPSimplex 类 [https://iie.fing.edu.uy/svn/SimSEE/src/rchlib/mat/umipsimplex.pas](https://iie.fing.edu.uy/svn/SimSEE/src/rchlib/mat/umipsimplex.pas)

用户：simsee_svn 密码：publico

# javascript - 如果条件 onclick - jQuery

> ID：11565764
> 
> 赞同：0
> 
> 时间：2012-07-19T16:59:26.257
> 
> 标签：javascript, jquery

```
$('.product-nav li a').click(function() {
  $('.product-nav li').removeClass('active');
  $(this).parent().addClass('active');
  if( $(this).hasClass('tshirts') ){
    $('product').hide();
    $('.product.tshirt').show();
  }
}); 
```

.. 活动类已正确分配，但产品未按需要隐藏/显示，因为我认为单击时无法识别 if 条件？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-19T17:02:10.577

产品是什么元素？

```
$('product').hide(); 
```

你错过了`.`

```
$('.product').hide(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T17:03:51.870

达到您的条件应该没有问题。

你似乎有一个错字。在第 5 行，您正在为`<product>`元素运行一个 jQuery 选择器。你的意思是选择带有类的元素`product`吗？（即`$('.product')`）？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T17:01:59.720

```
 $('.product-nav li').removeClass('active');
  $(this).parent().addClass('active'); 
```

第一行将其删除，第二行将其重新添加。

你的意思是：

```
$(this).parent().addClass('tshirts'); 
```

# contacts - 在 php 中获取雅虎联系人（雅虎 OAuth）

> ID：11565765
> 
> 赞同：2
> 
> 时间：2012-07-19T16:59:33.490
> 
> 标签：contacts, yahoo

我正在为网站开发一个邀请朋友工具。我阅读了这些文章并采取了以下步骤：

*   [http://anandafit.info/2011/01/06/yahoo-contact-list-reader-in-php/](http://anandafit.info/2011/01/06/yahoo-contact-list-reader-in-php/)
*   [http://nullinfo.wordpress.com/oauth-yahoo/](http://nullinfo.wordpress.com/oauth-yahoo/)

但是当我执行该操作时，最后，雅虎说：

```
{   "error": {     "lang": "en-US",     "description": "Please provide valid credentials. OAuth oauth_problem=\"token_rejected\", realm=\"yahooapis.com\""   } } 
```

:((

这些是我的代码：

getreqtok.php

```
<?php
require 'modules/invite/yahoo/globals.php';
require 'modules/invite/yahoo/oauth_helper.php';

// Callback can either be 'oob' or a url whose domain must match
// the domain that you entered when registering your application

$callback='http://www.warzone.in/modules.php?name=invite&op=yahoo_get_contacts';

// Get the request token using HTTP GET and HMAC-SHA1 signature
$retarr = get_request_token(OAUTH_CONSUMER_KEY, OAUTH_CONSUMER_SECRET,
                            $callback, false, true, true);

//echo $retarr[3]["oauth_token_secret"]."<br>
//<br>
//";

session_start();                    
$_SESSION["oauth_token_secret"] = $retarr[3]["oauth_token_secret"];

//echo $_SESSION["oauth_token_secret"]."<br>
//<br>
//<br>
//";

if (! empty($retarr)){
  list($info, $headers, $body, $body_parsed) = $retarr;
  if ($info['http_code'] == 200 && !empty($body)) {
      //print "Have the user go to xoauth_request_auth_url to authorize your app\n";
          ?>
<a href="<?php echo rfc3986_decode($body_parsed['xoauth_request_auth_url'])?>">YAHOO</a>
<?php
  }
}

/**
 * Get a request token.
 * @param string $consumer_key obtained when you registered your app
 * @param string $consumer_secret obtained when you registered your app
 * @param string $callback callback url can be the string 'oob'
 * @param bool $usePost use HTTP POST instead of GET
 * @param bool $useHmacSha1Sig use HMAC-SHA1 signature
 * @param bool $passOAuthInHeader pass OAuth credentials in HTTP header
 * @return array of response parameters or empty array on error
 */
function get_request_token($consumer_key, $consumer_secret, $callback, $usePost=false, $useHmacSha1Sig=true, $passOAuthInHeader=false)
{
  $retarr = array();  // return value
  $response = array();

  $url = 'https://api.login.yahoo.com/oauth/v2/get_request_token';
  $params['oauth_version'] = '1.0';
  $params['oauth_nonce'] = mt_rand();
  $params['oauth_timestamp'] = time();
  $params['oauth_consumer_key'] = $consumer_key;
  $params['oauth_callback'] = $callback;

  // compute signature and add it to the params list
  if ($useHmacSha1Sig) {
    $params['oauth_signature_method'] = 'HMAC-SHA1';
    $params['oauth_signature'] =
      oauth_compute_hmac_sig($usePost? 'POST' : 'GET', $url, $params,
                             $consumer_secret, null);
  } else {
    $params['oauth_signature_method'] = 'PLAINTEXT';
    $params['oauth_signature'] =
      oauth_compute_plaintext_sig($consumer_secret, null);
  }

  // Pass OAuth credentials in a separate header or in the query string
  if ($passOAuthInHeader) {

    $query_parameter_string = oauth_http_build_query($params, FALSE);

    $header = build_oauth_header($params, "yahooapis.com");
    $headers[] = $header;
  } else {
    $query_parameter_string = oauth_http_build_query($params);
  }

  // POST or GET the request
  if ($usePost) {
    $request_url = $url;
    logit("getreqtok:INFO:request_url:$request_url");
    logit("getreqtok:INFO:post_body:$query_parameter_string");
    $headers[] = 'Content-Type: application/x-www-form-urlencoded';
    $response = do_post($request_url, $query_parameter_string, 443, $headers);
  } else {
    $request_url = $url . ($query_parameter_string ?
                           ('?' . $query_parameter_string) : '' );

    logit("getreqtok:INFO:request_url:$request_url");

    $response = do_get($request_url, 443, $headers);

  }

  // extract successful response
  if (! empty($response)) {
    list($info, $header, $body) = $response;
    $body_parsed = oauth_parse_str($body);
    if (! empty($body_parsed)) {
      logit("getreqtok:INFO:response_body_parsed:");
      //print_r($body_parsed);
    }
    $retarr = $response;
    $retarr[] = $body_parsed;
  }

  return $retarr;
}
?> 
```

getacctok.php

```
<?php
session_start();
require 'modules/invite/yahoo/globals.php';
require 'modules/invite/yahoo/oauth_helper.php';

// Fill in the next 3 variables.
$request_token=$_REQUEST["oauth_token"];
$request_token_secret=$_SESSION["oauth_token_secret"];
$oauth_verifier= $_REQUEST["oauth_verifier"];

//echo $request_token."  xxxx ".$request_token_secret." yyyy  ".$oauth_verifier."<br>
//<br>
//<br>
//";

// Get the access token using HTTP GET and HMAC-SHA1 signature
$retarr = get_access_token(OAUTH_CONSUMER_KEY, OAUTH_CONSUMER_SECRET,
                           $request_token, $request_token_secret,
                           $oauth_verifier, false, true, true);
if (! empty($retarr)) {
  list($info, $headers, $body, $body_parsed) = $retarr;
  if ($info['http_code'] == 200 && !empty($body)) {
    //  print "Use oauth_token as the token for all of your API calls:\n" .
          rfc3986_decode($body_parsed['oauth_token']);
  }
}

/**
 * Get an access token using a request token and OAuth Verifier.
 * @param string $consumer_key obtained when you registered your app
 * @param string $consumer_secret obtained when you registered your app
 * @param string $request_token obtained from getreqtok
 * @param string $request_token_secret obtained from getreqtok
 * @param string $oauth_verifier obtained from step 3
 * @param bool $usePost use HTTP POST instead of GET
 * @param bool $useHmacSha1Sig use HMAC-SHA1 signature
 * @param bool $passOAuthInHeader pass OAuth credentials in HTTP header
 * @return array of response parameters or empty array on error
 */
function get_access_token($consumer_key, $consumer_secret, $request_token, $request_token_secret, $oauth_verifier, $usePost=false, $useHmacSha1Sig=true, $passOAuthInHeader=true)
{
  $retarr = array();  // return value
  $response = array();

  $url = 'https://api.login.yahoo.com/oauth/v2/get_token';
  $params['oauth_version'] = '1.0';
  $params['oauth_nonce'] = mt_rand();
  $params['oauth_timestamp'] = time();
  $params['oauth_consumer_key'] = $consumer_key;
  $params['oauth_token']= $request_token;
  $params['oauth_verifier'] = $oauth_verifier;

  // compute signature and add it to the params list
  if ($useHmacSha1Sig) {
    $params['oauth_signature_method'] = 'HMAC-SHA1';
    $params['oauth_signature'] =
      oauth_compute_hmac_sig($usePost? 'POST' : 'GET', $url, $params,
                             $consumer_secret, $request_token_secret);
  } else {
    $params['oauth_signature_method'] = 'PLAINTEXT';
    $params['oauth_signature'] =
      oauth_compute_plaintext_sig($consumer_secret, $request_token_secret);
  }

  // Pass OAuth credentials in a separate header or in the query string
  if ($passOAuthInHeader) {
    $query_parameter_string = oauth_http_build_query($params, false);
    $header = build_oauth_header($params, "yahooapis.com");
    $headers[] = $header;
  } else {
    $query_parameter_string = oauth_http_build_query($params);
  }

  // POST or GET the request
  if ($usePost) {
    $request_url = $url;
    logit("getacctok:INFO:request_url:$request_url");
    logit("getacctok:INFO:post_body:$query_parameter_string");
    $headers[] = 'Content-Type: application/x-www-form-urlencoded';
    $response = do_post($request_url, $query_parameter_string, 443, $headers);
  } else {
    $request_url = $url . ($query_parameter_string ?
                           ('?' . $query_parameter_string) : '' );
    logit("getacctok:INFO:request_url:$request_url");
    $response = do_get($request_url, 443, $headers);
  }

  // extract successful response
  if (! empty($response)) {
    list($info, $header, $body) = $response;
    $body_parsed = oauth_parse_str($body);
    if (! empty($body_parsed)) {
      logit("getacctok:INFO:response_body_parsed:");
      //print_r($body_parsed);
    }
    $retarr = $response;
    $retarr[] = $body_parsed;
  }

  return $retarr;
}

$guid = $retarr[3]["xoauth_yahoo_guid"];
$access_token = $retarr[3]["oauth_token"];
$access_token_secret = $retarr[3]["oauth_token_secret"];

// Call Contact API
$retarr = callcontact(OAUTH_CONSUMER_KEY, OAUTH_CONSUMER_SECRET,
                      $guid, $access_token, $access_token_secret,
                      false, true);

function callcontact($consumer_key, $consumer_secret, $guid, $access_token, $access_token_secret, $usePost=false, $passOAuthInHeader=true)
{
  $retarr = array();  // return value
  $response = array();

  $url = 'http://social.yahooapis.com/v1/user/' . $guid . '/contacts;count=5';
  $params['format'] = 'json';
  $params['view'] = 'compact';
  $params['oauth_version'] = '1.0';
  $params['oauth_nonce'] = mt_rand();
  $params['oauth_timestamp'] = time();
  $params['oauth_consumer_key'] = $consumer_key;
  $params['oauth_token'] = $access_token;

  // compute hmac-sha1 signature and add it to the params list
  $params['oauth_signature_method'] = 'HMAC-SHA1';
  $params['oauth_signature'] =
      oauth_compute_hmac_sig($usePost? 'POST' : 'GET', $url, $params,
                             $consumer_secret, $access_token_secret);

  // Pass OAuth credentials in a separate header or in the query string
  if ($passOAuthInHeader) {
    $query_parameter_string = oauth_http_build_query($params, true);
    $header = build_oauth_header($params, "yahooapis.com");
    $headers[] = $header;
  } else {
    $query_parameter_string = oauth_http_build_query($params);
  }

  // POST or GET the request
  if ($usePost) {
    $request_url = $url;
    logit("callcontact:INFO:request_url:$request_url");
    logit("callcontact:INFO:post_body:$query_parameter_string");
    $headers[] = 'Content-Type: application/x-www-form-urlencoded';
    $response = do_post($request_url, $query_parameter_string, 80, $headers);
  } else {
    $request_url = $url . ($query_parameter_string ?
                           ('?' . $query_parameter_string) : '' );
    logit("callcontact:INFO:request_url:$request_url");
    $response = do_get($request_url, 80, $headers);
  }

  // extract successful response
  if (! empty($response)) {
    list($info, $header, $body) = $response;
    if ($body) {
      logit("callcontact:INFO:response:");
      print(json_pretty_print($body));
    }
    $retarr = $response;
  }

  return $retarr;
}

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-07-16T10:42:37.233

```
 class YahooContacts
    {
        protected static $oauthConsumerKey ="";
        protected static $OauthConsumerSecret ="";
        protected static $oauthDomain="";

        public function __construct(){
            //Check Session is Start Or not 
            if (session_status() == PHP_SESSION_NONE) {
                        session_start();
            }

        }

       /**
         * Authentication user And Access Refresh and access token
         *
         * @author <Pawan Kumar>
         * @return type boolean
         **/
       protected function getAuthorization($code)
       {
            $url = "https://api.login.yahoo.com/oauth2/get_token";

            $data="grant_type=authorization_code&redirect_uri=".self::$oauthDomain."&code=".$code;
            $auth =  base64_encode(self::$oauthConsumerKey.":".self::$OauthConsumerSecret);  

            $headers = array(
                 'Authorization: Basic '.$auth,
                 'Content-Type: application/x-www-form-urlencoded'
            );

            try{
                $resultSet =self::makeRequest($url,$data,$headers);
                if($resultSet->access_token){
                    $this->setAccessToken($resultSet->access_token);
                    $this->setRefreshToken($resultSet->refresh_token);
                    $this->setGuidToken($resultSet->xoauth_yahoo_guid);
                    return true;
                }
            }catch(Exception $ex){
                throw($ex);
            }

       }
        /**
         * Get All Contacts list From Yahoo API using Auth Access Token And oAuth Guid Token
         *
         * @author <Pawan Kumar>
         * @return type Object
         **/
        public function getUserContactsDetails()
        {
            /** Refresh Access Token is Expired **/
            $this->generateAccessToken();

            $guid  =$this->getGuidToken(); 
            $token =$this->getAccessToken();

            $contactUrl="https://social.yahooapis.com/v1/user/$guid/contacts?format=json";

            $opts = array(
                      'http'=>array(
                        'method'=>"GET",
                        'header'=>"Authorization: Bearer $token" 
                      )
                    );

            $context = stream_context_create($opts);
            $file = file_get_contents($contactUrl, false, $context);

            $output =json_decode($file);
            return $output;
        }

        /**
         * Get New Access Token using Refresh Token
         *
         * @author <Pawan Kumar>
         * @return type boolean
         **/
        protected function generateAccessToken()
        {

            $url = "https://api.login.yahoo.com/oauth2/get_token";

            $refreshToken = $this->getRefreshToken();
            $data="grant_type=refresh_token&redirect_uri=".self::$oauthDomain."&refresh_token=".$refreshToken;

            $auth =  base64_encode(self::$oauthConsumerKey.":".self::$OauthConsumerSecret);  
            $headers = array(
                 'Authorization: Basic '.$auth,
                 'Content-Type: application/x-www-form-urlencoded'
            );

            try{

                $resultSet =self::makeRequest($url,$data,$headers);

                if($resultSet->access_token){
                    $this->setAccessToken($resultSet->access_token);
                    return true;
                }else{
                    return false;
                }
            }catch(Exception $ex){
                throw($ex);
            }

        }

        /**
         * Build a login url using oAuth Consumber Key And Redirect Domain
         *
         * @author Pawan Kumar
         * @return type String
         **/
        public static function getLoginUrl()
        {
           $loginUrl = "https://api.login.yahoo.com/oauth2/request_auth";
           $buildUrl =$loginUrl."?client_id=".self::$oauthConsumerKey."&redirect_uri=".self::$oauthDomain."&response_type=code&language=en-us"; 
           return $buildUrl;
        }

        /**
         * Make  a Remote Post Request using MakeRequest Function
         *
         * @param Url String
         * @param $postData String Send Post Data With Request
         * @param headers Array Contain Auth basic information
         * @author Pawan Kumar
         * @return type Object
         **/

        public static function makeRequest($url,$postData,$headers){

            try{

                if (empty($url))throw new Exception("Url is Not Format."); 
                if (empty($postData))throw new Exception("Post Parameters is Not Defined");

                $ch = curl_init();

                curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
                curl_setopt($ch, CURLOPT_VERBOSE, 1);
                curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, 0);
                curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 0);
                curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);
                curl_setopt($ch, CURLOPT_POSTFIELDS,$postData);
                curl_setopt($ch, CURLOPT_URL,$url);

                $result = curl_exec($ch);
                $output =json_decode($result);

                return $output;

            }catch(\Exception $ex){
                throw($ex);
            }

        }

        /**
         * @param RefreshToken to set String Token Into Session
         */
        public function setRefreshToken($token)
        { 
          $_SESSION['refresh_token']=$token;
        }

        /**
         * @return String Refresh Token From Session
         */
        public function getRefreshToken()
        { 
            return $_SESSION['refresh_token'];
        }

        /**
         * @param AccessToken to set String Token into Session
         */
        public function setAccessToken($token)
        { 
            $_SESSION['access_token']=$token;
        }

        /**
         * @return String Access Token From Session
         */
        public function getAccessToken()
        {
            return $_SESSION['access_token'];
        }

        /**
         * @param GuidToken to set String Token into Session
         */
        public function setGuidToken($token)
        {
            $_SESSION['xoauth_yahoo_guid']=$token;
        }
        /**
         * @return String Guid Token from Session
         */
        public function getGuidToken()
        {
            return $_SESSION['xoauth_yahoo_guid'];
        }

    }

    // Initialize Session If Session is Not Start
    session_start();

    if(isset($_GET['code'])){
        $code = $_GET['code'];
        if(!empty($code)){
            // create a instance of yahoo contacts
            $obj = new YahooContacts();
            //Successfully Authorization Process
            $obj->getAuthorization($code); 
            Header("Location:http://yahoo.fansunite.com.au");die;
        }
    }else{
        if(isset($_SESSION['access_token'])){

            // create a instance of yahoo contacts
            $obj = new YahooContacts();

            //After Authorization Get User Contacts Email
            $res =  $obj->getUserContactsDetails(); 
            print "<pre>";
            print_r($res);
        }else{
            $url = YahooContacts::getLoginUrl();
            echo "<center><strong><a href='$url'>Login With Yahoo Mail !</a></strong></center>";
        }

    } 
```

# iphone - 登录 facebook 错误

> ID：11565768
> 
> 赞同：2
> 
> 时间：2012-07-19T16:59:46.143
> 
> 标签：iphone, ios, xcode, facebook, ios6

我已经在我的项目中实现了新的 FacebookSDK 3.0 测试版，并且我的 loginview 可以正常工作，但是有时当我单击登录按钮并显示“您已经为此应用授权此帐户”并点击确定按钮时，它会转到另一个登录屏幕要求我输入我的 Facebook 用户名/密码，当我点击登录时，它不会消失。大约 50% 的时间会发生这种情况。同样在控制台中它说的是这样的：

```
scheduled GC timer for 9125.000000
 seconds
scheduled GC timer for 2.227783
 seconds
scheduled GC timer for 1.041191
 seconds
scheduled GC timer for 43625.000000
 seconds
scheduled GC timer for 28.036632
 seconds
scheduled GC timer for 9.426318
 seconds
scheduled GC timer for 4.049851
 seconds
scheduled GC timer for 1.891804
 seconds
scheduled GC timer for 0.917706
 seconds
scheduled GC timer for 191475.000000
 seconds
scheduled GC timer for 124.658203
 seconds
scheduled GC timer for 62.329102
 seconds
scheduled GC timer for 31.164551
 seconds
scheduled GC timer for 15.264270
 seconds 
```

只要我继续点击登录，这种情况就会持续下去。

这是 Facebook 部分的错误吗？还是我做错了什么

另外，我使用的是 xcode 4.5，这是在 ios 6.0 iphone 模拟器上。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-20T00:11:27.237

“计划的 GC 计时器”与您正在使用的 iOS 6 beta SDK 有关。我在做与 Facebook 完全无关的事情时得到同样的结果（我正在使用 发布 HTTP 帖子`NSURLConnection`）

我不认为这将是 Facebook 的问题 - 更可能只是 beta SDK 中的错误/调试。

# algorithm - Delaunay：使用最佳拟合网格对两个点集进行三角剖分

> ID：11565771
> 
> 赞同：4
> 
> 时间：2012-07-19T16:59:47.797
> 
> 标签：algorithm, math, computational-geometry, triangulation

我得到了一个具有随机分布点的云和另一个具有相同点但随机移动的云。所以云 A 的每个点在云 B 中都有一个对应的点。

现在我想用相同的三角形网格对两朵云进行三角剖分，找到两朵云中交点最少的网格。

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T13:19:22.317

第一种非常简单的方法，对半移动位置进行（Delaunay）三角剖分，并将其用于两朵云。如果运动不是太大，那可以产生良好的效果。

如果存在负向三角形，则三角剖分具有交点。因此，两个云的良好三角剖分由两个云中正向的三角形组成。

方法可以非常类似于和提到的，在云 A 上创建初始三角剖分并尝试在云 B 中局部修复负向三角形。可能标准翻转可以解决它。

我认为可以检查在两朵云中哪些点（区域）不能很好地进行三角剖分，方法是在两朵云上制作正向三角形的交点，并寻找不在交点的任何三角形中的点。为此，（需要）为相邻区域（具有相邻节点）取三角形节点就足够了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T17:38:20.087

创建云 A 中点的随机三角剖分，并测量 A 和 B 中的交叉点数。然后应用[模拟退火](http://en.wikipedia.org/wiki/Simulated_annealing)来随机添加/删除/移动边缘，以保留您感兴趣的三角剖分特征并测量每次迭代后的交点。

作为起点，如果您不想从一组随机边开始，您可以从 A 中的 Delauny 三角剖分开始，然后测量 B 中的交点总数。像以前一样继续模拟退火方法.

# java - 谁能解释 Windows（7 Pro N）和 Linux（Ubuntu 12-04）之间的套接字吞吐量差异

> ID：11565777
> 
> 赞同：2
> 
> 时间：2012-07-19T16:59:56.540
> 
> 标签：java, windows, linux, winsock

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T10:02:02.120

Microsoft 在 Windows（客户端）操作系统中专门针对 TCP 连接实施了限制，以防止将其用作服务器（[参考](http://www.mydigitallife.info/windows-xp-sp2-tcp-connection-limit-event-id-4226/)）。在 Windows Server 2008 R2 上再次运行测试，看看是否有任何不同。

# javascript - Jquery - print an array with append()

> ID：11565780
> 
> 赞同：0
> 
> 时间：2012-07-19T17:00:07.033
> 
> 标签：javascript, jquery, arrays, append

I have a huge table (temporary) of different videos. Every video has a link "Choose thumbnails" for that specific video.

When you click on that link, there's a popup showing, with 8 different thumbnails for that vid.

This is my link:

```
 <a class="bigThumbnailLink" onclick="showThumb({{stat.video_id}})">Choose</a> 
```

**Note that the curly bracket {{ }} is the TWIG syntax, its just an "echo"

Here im just building an array

```
var videos = [];

{% for statThumb in stats %}
    videos[{{ statThumb.video_id }}] = [];

    {% for thumb in statThumb.thumbnails %}
        videos[{{ statThumb.video_id }}].push('{{ thumb }}');
    {% endfor %}
{% endfor %} 
```

The outputed array looks like:

```
 var videos = [];   
     videos[609417] = [];
            videos[609417].push('http://1.jpg');
            videos[609417].push('http://2.jpg');
            videos[609420] = []; 
```

My function

```
function showThumb(id){
        $("#bigThumbnailArea").show();

        jQuery.each(videos[id], function(i, val) {
            $("#bigThumbnailArea").find("ul").append("<li><img src=" + val + "></li>");
        });
    } 
```

That code is working. But everytime I click on a link, instead of showing me only the thumbnails for that video, it's adding to the array. So first time I click = 8 thumb (good), 2nd link I click = 16 thumb, 3tr link = 24 etc...

I know that is probably only the way "append()" works...I tried to replace with some other insertion method like .html() but its never the result I want. html() is returning my only 1 thumbnail every time)

Im a bit confused here on how I should do that...

Any helps?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T17:03:08.147

You should `empty()` the ul, then append the lis to it.

```
function showThumb(id){
    $("#bigThumbnailArea").show();
    var $ul = $("#bigThumbnailArea").find("ul").empty();

    $.each(videos[id], function(i, val) {
        $ul.append("<li><img src=" + val + "></li>");
    });
} 
```

# java - JavaCompiler：是否可以在运行时输入变量

> ID：11565783
> 
> 赞同：0
> 
> 时间：2012-07-19T17:00:11.400
> 
> 标签：java, compiler-construction, javac

在不久的将来我将不得不使用 JavaCompilers，所以我现在正在尝试学习基础知识并选择最好的学习，我遇到了一个我无法很好地在线回答的问题

目前我正在查看 JavaCompiler。如果我有一个正在评估的程序 X，它从 System.in 获取输入并将输出打印到 System.out，我可以编译并运行它，同时为其提供一些特定的输入并将其输出捕获到文件中吗？

如果是这样，是否有任何在线示例，以便我可以尝试更好地理解它？

编辑：

编译时传入的简单测试用例

```
import java.util.Iterator;

public class TestSet
{
public static void main(String[] args)
{
  try
  {
     System.out.print(   "[1]--constructor 1, size, isEmpty: ");
     LinkedSet<String> s1 = new LinkedSet<String>();
     if (s1.size() != 0)
        System.out.print("*** size? ***");
     if (!s1.isEmpty())
        System.out.print("*** isEmpty? ***");
     System.out.println();
  }
  catch(Exception e)
  {
     System.out.println("*** CRASH !!! ***");
  }
  try
  {
     System.out.print(   "[2]--constructor 2, size, isEmpty: ");
     LinkedSet<String> s1 = new LinkedSet<String>( "alpha");
     if (s1.size() != 1)
        System.out.print("*** size? ***");
     if (s1.isEmpty())
        System.out.print("*** isEmpty? ***");
     System.out.println();
  }
  catch(Exception e)
  {
     System.out.println("*** CRASH !!! ***");
  }
  try
  {
     System.out.print(   "[3]--contains: ");
     LinkedSet<String> s1 = new LinkedSet<String>("alpha");
     if (!s1.contains("alpha"))
        System.out.print("*** elt. not found ***");
     if (s1.contains("beta"))
        System.out.print("*** non-elt ``found'' ***");
     System.out.println();
  }
  catch(Exception e)
  {
     System.out.println("*** CRASH !!! ***");
  }
  try
  {
     System.out.print(   "[4]--add: ");
     LinkedSet<String> s1 = new LinkedSet<String>();
     s1.add("alpha");
     s1.add("beta");
     s1.add("gamma");
     if (s1.size() != 3)
        System.out.print("*** size? ***");
     if (!s1.contains("alpha") ||
        !s1.contains("beta") ||
        !s1.contains("gamma"))
        System.out.print("*** elt. not found ***");
     if (s1.contains("delta"))
        System.out.print("*** non-elt ``found'' ***");
     s1.add("beta");
     if (s1.size() != 3)
        System.out.print("*** size/duplicates? ***");
     System.out.println();
  }
  catch(Exception e)
  {
     System.out.println("*** CRASH !!! ***");
  }
  try
  {
     System.out.print(   "[5]--remove: ");
     LinkedSet<String> s1 = new LinkedSet<String>();
     s1.add("alpha");
     s1.add("beta");
     s1.add("gamma");
     s1.remove("beta");
     s1.remove("alpha");
     s1.remove("gamma");
     if (s1.size() != 0)
        System.out.print("*** size? ***");
     if (s1.contains("alpha") ||
        s1.contains("beta") ||
        s1.contains("gamma"))
        System.out.print("*** non elt. ``found'' ***");
     System.out.println();
  }
  catch(Exception e)
  {
     System.out.println("*** CRASH !!! ***");
  }
  try
  {
     System.out.print(   "[6]--print: ");
     LinkedSet<String> s1 = new LinkedSet<String>();
     s1.add("this");
     s1.add("is");
     s1.add("assignment");
     s1.add("four");
     s1.print();
  }
  catch(Exception e)
  {
     System.out.println("*** CRASH !!! ***");
  }
  try
  {
     System.out.print(   "[7]--addAll: ");
     LinkedSet<String> s1 = new LinkedSet<String>();
     s1.add("alpha");
     s1.add("beta");
     s1.add("gamma");
     LinkedSet<String> s2 = new LinkedSet<String>();
     s2.add("beta");
     s2.add("delta");
     s1.addAll(s2);
     if (!s1.contains("alpha") || ! s1.contains("beta") ||
        !s1.contains("gamma") || !s1.contains("delta"))
        System.out.print("*** elt. ``dropped'' ***");
     if (s1.size() != 4)
        System.out.print("*** size ? ***");
     System.out.println();
  }
  catch(Exception e)
  {
     System.out.println("*** CRASH !!! ***");
  }

  try
  {
     System.out.print(   "[8]--containsAll: ");
     LinkedSet<String> s1 = new LinkedSet<String>();
     s1.add("alpha");
     s1.add("beta");
     s1.add("gamma");
     LinkedSet<String> s2 = new LinkedSet<String>();
     s2.add("beta");
     s2.add("delta");
     if (s1.containsAll(s2))
        System.out.print("*** non-containment incorrect ***");
     LinkedSet<String> s3 = new LinkedSet<String>();
     s3.add("beta");
     s3.add("alpha");
     if (!s1.containsAll(s3))
        System.out.print("*** containment incorrect ***");
     System.out.println();
  }
  catch(Exception e)
  {
     System.out.println("*** CRASH !!! ***");
  }
  try
  {
     System.out.print(   "[9]--removeAll: ");
     LinkedSet<String> s1 = new LinkedSet<String>();
     s1.add("alpha");
     s1.add("beta");
     s1.add("gamma");
     s1.add("delta");
     LinkedSet<String> s2 = new LinkedSet<String>();
     s2.add("beta");
     s2.add("delta");
     s1.removeAll(s2);
     if (s1.contains("beta") || s1.contains("delta"))
        System.out.print("*** some  elts not removed? ***");
     if (!s1.contains("alpha") || !s1.contains("gamma"))
        System.out.print("*** wrong elts removed? ***");
     System.out.println();
  }
  catch(Exception e)
  {
     System.out.println("*** CRASH !!! ***");
  }
  try
  {
     System.out.print(   "[10]--retainAll: ");
     LinkedSet<String> s1 = new LinkedSet<String>();
     s1.add("alpha");
     s1.add("beta");
     s1.add("gamma");
     s1.add("delta");
     LinkedSet<String> s2 = new LinkedSet<String>();
     s2.add("beta");
     s2.add("delta");
     s1.retainAll(s2);
     if (s1.contains("alpha") || s1.contains("gamma"))
        System.out.print("*** wrong elts retained? ***");
     if (!s1.contains("beta") || !s1.contains("delta"))
        System.out.print("*** wrong elts removed? ***");
     System.out.println();
  }
  catch(Exception e)
  {
     System.out.println("*** CRASH !!! ***");
  }
  try
  {
     System.out.print(   "[11]--elements: ");
     LinkedSet<String> s1 = new LinkedSet<String>();
     s1.add("alpha");
     s1.add("beta");
     s1.add("gamma");
     s1.add("delta");
     Iterator<String> list = s1.elements();
     System.out.print("("+list.hasNext()+") ");
     if (list.hasNext())
        System.out.print(list.next()+"; ");
     System.out.print("("+list.hasNext()+")");
     if (list.hasNext())
        System.out.print(list.next()+"; ");
     System.out.print("("+list.hasNext()+")");
     if (list.hasNext())
        System.out.print(list.next()+"; ");
     System.out.print("("+list.hasNext()+")");
     if (list.hasNext())
        System.out.print(list.next()+"; ");
     System.out.print("("+list.hasNext()+")");
     if (list.hasNext())
        System.out.print(list.next()+"; ");   
     System.out.println();
  }
  catch(Exception e)
  {
     System.out.println("*** CRASH !!! ***");
  }
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T17:03:43.380

这不是一个真正的编译器问题。我很确定您想要的只是输入/输出重定向，可能需要一些脚本。

基本情况是：

*   您可以使用文本文件作为带有`<`字符的程序的输入
*   您可以将文本文件用作带有`>`字符的程序的输出

例如，如果我在 Foo.java 中有一个程序，我想从 in.txt 给它输入，并将其结果存储在 out.txt 中，我可以键入：

```
javac Foo.java
java Foo <in.txt >out.txt 
```

Foo 运行后，out.txt 会将 Foo 打印到 System.out 的内容。查看您的 shell 文档以获取有关文本输入和输出的更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T17:13:09.330

是的，你可以......

**1.**你在谈论命令行参数吗，如果是，那么它可能..

**例如：**

```
javac Test.java
enter code herejava Test Hello       // Hello is the Input 
```

在 Java 中，这个**“Hello”输入被发送到 String[] 数组中的 main() 方法**。

`public static void main(String[] args)`

因此，要访问`Hello`您作为参数传递给`main()`方法参数的 this，您需要执行此操作..

```
 String s = args[0]; 
```

**2.**现在，如果您想**从程序内部将其写入文件，**请执行此操作。

```
 String s = args[0];
 File f = new File(d:\\vivek.txt);
 FileWriter fw = new FileWriter(f);
 BufferedWriter bw = new BufferedWriter(fw);

 bw.write(s); 
```

# php - 使用while循环限制PHP中的结果

> ID：11565792
> 
> 赞同：0
> 
> 时间：2012-07-19T17:01:21.713
> 
> 标签：php

我有一个返回的子类别列表。我只能访问模板显示而不能访问 MySQL 查询，所以不，我不能限制查询。

现在所有结果都返回了。我想将列表限制为 5 个，如果结果超过 5 个，则添加一个“更多”链接。

我知道我做错了，因为我认为`count`实际上与以下内容无关`foreach`：

```
<ul class="sub-categories">
    <?php
    while (count($category->getChildren()) <= 5) { // line I added for while loop
        foreach ($category->getChildren() as $child) {
            if (!$child->totalItemCount())
                continue;

            $link = $this->app->route->category($child);
            $item_count = ($this->params->get('template.show_sub_categories_item_count')) ? ' <span>('.$child->totalItemCount().')</span>' : '';
                echo '<li><a href="'.$link.'" title="'.$child->name.'">'.$child->name.'</a>'.$item_count.'</li>';
        }
    } // line I added for while loop
    ?>
</ul> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T17:08:28.467

在达到限制时`foreach`跟踪：`break;`

```
<ul class="sub-categories">
    <?php
        $i = 0;
        foreach ($category->getChildren() as $child) {
            if (!$child->totalItemCount()) continue;
            $i++; if($i>5) break;
            $link = $this->app->route->category($child);
            $item_count = ($this->params->get('template.show_sub_categories_item_count')) ? ' <span>('.$child->totalItemCount().')</span>' : '';
            echo '<li><a href="'.$link.'" title="'.$child->name.'">'.$child->name.'</a>'.$item_count.'</li>';
        }
    ?>
</ul> 
```

# svn - SVN - 忽略符号链接

> ID：11565794
> 
> 赞同：3
> 
> 时间：2012-07-19T17:01:30.137
> 
> 标签：svn, version-control

是否可以让 SVN 忽略所有符号链接？

我试图达到的特殊情况是这样的：

独立于源代码控制下的 Web 框架

对框架的补充都是模块化的，并与框架分开，并在需要时进行符号链接。

这些单独的模块也都在 svn 下。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-27T16:32:08.500

Subversion 不会将符号链接识别为指向其他文件或目录的链接，而是将其识别为它们链接到的实际文件和目录。你可以在 VIM 中看到这个工作，假设你有文件 a.ext 并且你 ln -s a.ext - b.ext 然后你 vi/vim b.ext，如果它将打开进行编辑，就好像它是它自己的文件一样对，而不是链接。

不幸的是，您需要手动忽略您不想提交的任何符号链接。

# javascript - 如果存在 Cookie，则 JavaScript 重定向

> ID：11565796
> 
> 赞同：0
> 
> 时间：2012-07-19T17:01:32.943
> 
> 标签：javascript, jquery, drupal, redirect, cookies

如果用户已经填写了表格，我正在使用 javascript 和通配符将用户重定向到感谢页面。

```
<script type="text/javascript">
    if (document.cookie.search(/\bwebform-\S*=/) >= 0)   {
        location.href = "/thanks"; 
    }
</script> 
```

Drupal 模块生成的 cookie 是`webform-62[1234356]`.

随机生成的数字。重定向不起作用。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T18:17:55.810

```
if ( /webform-\d/.test( document.cookie ) ) {
    location.href = '/thanks';
} 
```

正则表达式的意思是：匹配`webform-`加上任何数字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T18:11:02.987

利用：

```
document.location.href = "/thanks"; 
```

代替：

```
location.href = "/thanks"; 
```

# windows-phone-7 - WP7：是否可以在创建/存储日志缩略图之前拦截 backstack

> ID：11565798
> 
> 赞同：4
> 
> 时间：2012-07-19T17:01:37.047
> 
> 标签：windows-phone-7, windows-phone-7.1, windows-phone

你们都知道 Windows Phone 的后台堆栈是对的。如果您浏览某些应用程序，请在启动每个应用程序后点击 Home 键。现在点击并按住 Backkey 以查看 Backstack。您现在可以看到您的应用程序的一些小图像，并且可以选择要向右移动的图像。

问题：是否可以在创建backstack图像之前进行拦截？我试图在各种事件中模糊我的页面（包括 OnNavigatingFrom）但无济于事。

我的猜测是触发了其他事件（可能是我们无权访问的事件）并创建了位图，因为当您使用 Backstack 进行导航时，您只能看到从保存的图像到真实页面的轻微过渡 IMO。

有谁知道是否可以在后台拦截或操纵这些图像？

Backstack 缩略图的 WP 模拟器的示例屏幕截图![在此处输入图像描述](../Images/b3346f005f469faa624c3eb721bae297.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T18:04:27.877

根据我的评论，我刚刚尝试过这个：

1.  在代码的任意位置设置断点
2.  启动带有调试器的应用程序，然后让它到达断点
3.  当调试器停止执行时，长按后退按钮
4.  即使托管代码执行已停止，也会显示任务切换 UI

从那里，我认为我们可以有把握地得出结论，任务切换和缩略图完全由本机代码处理。因此，您无能为力。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-18T11:32:16.337

我最近写了一篇博文，讨论了我尝试从应用程序快照中隐藏数据的方式。（你可以在这里阅读：[http](http://corstianboerman.com/trying-to-hide-crucial-data-from-an-application-snapshot/) ://corstianboerman.com/trying-to-hide-crucial-data-from-an-application-snapshot/ ）

结果：你就是无法隐藏它。

# php - 从 php 中的现有数组创建一个可行的数组

> ID：11565805
> 
> 赞同：2
> 
> 时间：2012-07-19T17:02:01.517
> 
> 标签：php, mysql, multidimensional-array

我无法理解数组，我想知道是否有人可以帮助我重新格式化 php.ini 中的现有数组。

**这是现有的数组：**

```
Array
(
[item] => Array
(
    [0] => item listing 1
    [1] => item listing 2
)

[description] => Array
(
    [0] => item testing description
    [1] => item testing description
)

[rate] => Array
(
    [0] => 1.00
    [1] => 2.00
)

[itemid] => Array
(
    [0] => 1
    [1] => 2
)
) 
```

**我希望它看起来像这样：**

```
Array
(
[0] => Array
(
    [item] => item listing 1
    [description] => item testing description
    [rate] => 1.00
    [itemid] => 1
)
[1] => Array
(
    [item] => item listing 2
    [description] => item testing description
    [rate] => 2.00
    [itemid] => 2
) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T17:07:08.923

如果第一个中所有子数组的长度相同，则应该可以。

假设上面的第一个数组在一个变量中`$inArray`；新数组是`$outArray`.

```
$outArray = array();
$iLength  = count($inArray['item']);
for($i=0; $i<$iLength; $i++) {
    $outArray[] = array(
        'item'        => $inArray['item'][$i],
        'description' => $inArray['description'][$i],
        'rate'        => $inArray['rate'][$i],
        'itemid'      => $inArray['itemid'][$i]);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T17:11:58.913

好的，如果你的主数组被称为 $master。然后你会做这样的事情：

```
$newArr = array();
foreach ($master as $key => $subArray) {
    foreach ($subArray as $k2 => $value) {
        $newArr[$k2][$key] = $value;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T17:14:16.327

为您的特定用例工作（在空白 php 上复制/粘贴）：

```
$master = array( 
  'itemid' => array(1, 2),
  'items' => array('item listing 1', 'item listing 2'),
  'description' => array('item testing description', 'item testing description'),
  'rate' => array(1.10, 2.10)
);

$newItems = array();
foreach($master['itemid'] as $index => $id) {
  $newItem = array(
    'itemid' => $id,
    'item' => $master['items'][$index],
    'description' => $master['description'][$index],
    'rate' => $master['rate'][$index],
  );
  $newItems[] = $newItem;
}

echo '<pre>';
print_r($newItems);
echo '</pre>'; 
```

# asp.net - 使用 EmployeeID 的 asp.net 会员登录

> ID：11565809
> 
> 赞同：0
> 
> 时间：2012-07-19T17:02:23.227
> 
> 标签：asp.net, asp.net-mvc

我正在尝试在 ASP.NET 项目中使用 ASP.NET 成员资格。我唯一的要求是用户需要使用 EmployeeID 作为用户名而不是电子邮件登录。这是否可以使用默认会员提供程序轻松配置？

我在 aspnet_Membership 表中看到一个 MobilePin 列，我想知道是否有办法将其用作用户名。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T02:32:26.117

您可以推出自己的会员提供程序并使用提供的值检查数据库。由于您可能已经有一个使用 UserName 属性的 LogonModel，因此您可以将其更改为 EmployeeId。您可能还必须使用更改的属性重新生成登录视图。

所以而不是视图

```
 @Html.TextBoxFor(m => m.UserName) 
```

它会像

```
 @Html.TextBoxFor(m => m.EmployeeId) 
```

无论您将 Logon 模型类重命名为什么。

然后，您将需要拥有自己的 MembershipProvider 并覆盖 ValidateUser 方法，以便它针对数据库进行验证。然后在 HttpPost 操作的控制器方法中使用您的成员资格提供程序实现。

除非您希望针对域进行身份验证，在这种情况下，请参阅以下链接

[http://msdn.microsoft.com/en-us/library/ff650308.aspx](http://msdn.microsoft.com/en-us/library/ff650308.aspx)

# python - 如何在 Python 中创建一个由对象的所有实例共享的变量？

> ID：11565812
> 
> 赞同：-1
> 
> 时间：2012-07-19T17:02:30.633
> 
> 标签：python

我想在 Python 中创建一个由所有对象实例共享的变量。

```
class myobj:
  shared = []

  def add(item):
     self.shared.append(item)

  def get():
     return self.shared

item = myobj()
item.add("Hello")

item2 = myobj()
item2.add("Dave")

item.get()  # this should return [Hello, Dave]
item2.get() # this also should return [Hello, Dave] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T17:05:55.503

如果您修复了代码中与您的问题无关的两个错误，那么您的代码将*完全按照*您的要求执行。

两个错误要改：

```
def add(item): 
```

至

```
def add(self, item): 
```

和改变

```
def get(): 
```

至

```
def get(self): 
```

那时，运行您的代码*确实*会`["Hello", "Dave"]`从每个返回。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T17:07:10.877

在方法中提供参数后，您的代码将按预期工作`self`：

```
class myobj:
  shared = []

  def add(self, item): # added self parameter
     self.shared.append(item)

  def get(self): # added self parameter
     return self.shared 
```

我建议通读[Python 'self' 解释](https://stackoverflow.com/questions/2709821/python-self-explained)的答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T17:06:43.823

这将起作用：

```
class myobj:
  shared = []

  def add(self, item):
     self.shared.append(item)

  def get(self):
     return self.shared

item = myobj()
item.add("Hello")

item2 = myobj()
item.add("Dave")

item.get()  # returns [Hello, Dave]
item2.get() # also returns [Hello, Dave] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T17:09:04.357

以下是三张海报的证明：

```
>>> class Foo:
...      shared = []
...
...      def add(self, item):
...           self.shared.append(item)
...
...      def get(self):
...           return self.shared
... 
>>> item = Foo()
>>> item.add('hello')
>>> item2 = Foo()
>>> item2.add('world')
>>> item2.get()
['hello', 'world'] 
```

# javascript - 检查网址是否为 YouTube 视频

> ID：11565816
> 
> 赞同：1
> 
> 时间：2012-07-19T17:03:11.900
> 
> 标签：javascript

如何检查给定的 URL 是否指向有效的 YouTube 视频？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-30T13:58:37.580

以下函数将在传递 url 时返回 true 或 false：

```
function matchYoutubeUrl(url){
var p = /^(?:https?:\/\/)?(?:www\.)?    (?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/;
 return (url.match(p)) ? true : false ;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T17:08:54.177

用正则表达式匹配它。

```
if($parsed[0].match(/youtube\.com/) {
    // affirmative
} else {
    // negative
} 
```

我调用`match()`的是 的第一个元素`$parsed`，但如果您的 URL 字符串以“http://”开头，那么您的“域”部分很可能是第三个元素。

您可以在那里使用更可靠的正则表达式，但如果字符串包含`youtube.com`域，则评估结果为真。

# c++ - c++ lambda 委托

> ID：11565817
> 
> 赞同：3
> 
> 时间：2012-07-19T17:03:16.583
> 
> 标签：c++, visual-c++, lambda, c++11, visual-studio-2012

编辑：嗯，在其他人的建议下，我创建了一个最小的例子......它很有效，所以我会在这里与任何人分享它。这是工作代码：

```
#include <iostream>
#include <functional>

using namespace std;

class myClass
{
    char* str;
public:
    myClass()
    {
        str = "";
    }

    void funcA()
    {
        funcB([](myClass* mc)
            {
                mc->str = "HelloWorld";
            }
        );
    }

    void funcB(std::function<void (myClass*)> otherFunc)
    {
        otherFunc(this);
    }     

    void printStr()
    {
        cout << str;
    }
};

int main()
{
    myClass mc;
    mc.funcA();
    mc.printStr();
    int done;
    cin >> done;
} 
```

我的原始代码不起作用的原因是因为我将 funcB 的声明和实现分为两部分（.h 和 .cpp），并且在 .h 中我这样做了

```
void funcB(std::function<void (myClass*)> otherFunc = NULL) 
```

据我所知，你绝对不能在这里传递 NULL，这对我来说很烦人，希望是一个错误。但除此之外，它还有效。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T18:41:55.650

你不能通过`NULL`，但你可以通过`nullptr`。

# javascript - 当我使用最新版本的 jQuery 时，小提琴不起作用

> ID：11565818
> 
> 赞同：0
> 
> 时间：2012-07-19T17:03:16.230
> 
> 标签：javascript, jquery

为什么当我使用 jQuery 1.5.2 时这个小提琴才起作用？

[http://jsfiddle.net/azZVk/17/](http://jsfiddle.net/azZVk/17/)

![在此处输入图像描述](../Images/91a65fbdb30a7baf3f396e1401c2e4df.png)

当我将它设置为 jQuery 1.7.2 时，什么都没有显示

![在此处输入图像描述](../Images/577c149d1dc7cde3e05ff12ec8293d07.png)

此处未选择 jQuery Mobile 1.0.1 是 display ：

![在此处输入图像描述](../Images/ce0c2f9dc88090678fb9be9d8f844cc2.png)

而这应该显示：

![在此处输入图像描述](../Images/69c4180679012d9b8caded9d257a4159.png)

小提琴代码：

```
<div data-role="page" id="firstpage">

        <div data-role="header">
                <h1>First Page</h1>
        </div>

<div data-role="content" id="links">

</div>

        <div data-role="footer">
                <h4>Page Footer</h4>
        </div>

</div>

<div data-role="page" id="secondpage">

        <div data-role="header">
                <a href='#' class='ui-btn-left' data-icon='arrow-l' onclick="history.back(); $('#pagecontent').empty(); return false">Back</a><h1>Bar</h1>
        </div>

        <div id="pagecontent" data-role="content">

        </div>

        <div data-role="footer">
                <h4>Page Footer</h4>
        </div>
</div>

$(document).ready(function() {

for (var i = 0; i < 4; i++) {  
    $('#links').append(buildButton());     
}

   function buildButton() {
    var button= '<a data-role="button" href="#secondpage" data-theme="c" class="ui-btn ui-btn-corner-all ui-shadow ui-btn-up-c"><span class="ui-btn-inner ui-btn-corner-all"><span class="ui-btn-text">Link Button</span></span></a>';

    return $(button).click(function () {
        $("#secondpage").data("val", "test value")
    });       
   }

    $('#secondpage').live('pageshow', function() {
        var val1= $(this).data('val');
        $("#pagecontent").html(val1);
        console.log('val is '+ val1);
    });

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T17:05:36.737

问题是当你选择`1.7.2`

你也打勾`Mobile 1.0.1`

**编辑**：您在这里使用了错误的版本

![在您的资源中](../Images/ef8817911594755cb264675023e6410b.png)

将它们更新到最新版本以使用 1.7.2

`CSS`：[http ://code.jquery.com/mobile/1.1.0jquery.mobile-1.1.0.css](http://code.jquery.com/mobile/1.1.0jquery.mobile-1.1.0.css)

和

`JS`： [http ://code.jquery.com/mobile/1.1.0/jquery.mobile-1.1.0.min.js](http://code.jquery.com/mobile/1.1.0/jquery.mobile-1.1.0.min.js)

在`1.7.2` 这里工作：http: [//jsfiddle.net/azZVk/25/](http://jsfiddle.net/azZVk/25/)

也不要使用`live`我们`on`。

# r - 启动 R 并从批处理文件调用脚本

> ID：11565820
> 
> 赞同：3
> 
> 时间：2012-07-19T17:03:29.697
> 
> 标签：r, batch-file, startup

我有一个基于 R 的 GUI，允许一些非技术用户访问统计模型。就目前而言，用户必须先加载 R，然后`loadGui()`在命令行中键入。

虽然这并不太具有挑战性，但我不喜欢让非技术人员在命令行中键入*任何内容。*我有编写一个启动 R GUI，然后自动运行该命令的 .bat 文件的想法（用户都在运行 Windows，尽管多平台解决方案也很受欢迎）。

我的第一个问题是从命令行打开 RGui。虽然我可以提供一个明确的路径，例如

```
"%ProgramW6432%\R\R-2.15.1\bin\i386\Rgui.exe" 
```

每次升级 R 时都需要更新。从`%path%`环境变量中检索 RGui 的位置会更好，但我不知道解析它的简单方法。

第二个更大的问题是如何在启动时从命令行调用 R 的命令。我的第一个想法是我可以获取 的副本`~/.Rprofile`，附加额外的命令，然后在加载 R 后替换文件的原始副本。不过，这非常混乱，所以我想要一个替代方案。

在批处理模式下运行 R 不是一种选择，首先因为我无法说服 GUI 显示自己，其次因为我希望 R 控制台可用，即使用户*不需要*使用它。

如果你想要一个玩具 GUI 来测试你的想法，试试这个：

```
loadGui <- function()
{
  library(gWidgetstclck)
  win <- gwindow("test")
  rad <- gradio(letters[1:3], cont = win)
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T17:11:50.327

问题 1：我根本*不*安装在 Windows 上建议的默认目录中，而是将 R 和一些相关的东西放在`c:/opt/`我安装 R 本身的地方，比如说，`c:/opt/R-current`这样路径`c:/opt/R-current/bin`将保持不变。升级时，我首先重命名为`R-previous`，然后安装到新的`R-current`.

问题 2：我想我在很久以前就用脚本解决了。您现在可以使用`Rscript.exe`来启动这些，并且有等待提示的 tcltk 示例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T18:37:42.163

我做过几次类似的事情。在我的情况下，客户端使用的是 Windows，所以我只是在他们的计算机上安装了 R，并在他们的桌面上创建了一个快捷方式来运行 R。然后我右键单击快捷方式并选择属性以获取属性对话框。然后，我将“开始于”文件夹更改为我希望它从中运行的文件夹（其中包含具有正确数据的 .Rdata 文件以及 .Rdata 文件中的 .First 函数或文件夹中的 .Rprofile ）。还有一个“运行：”选项，其中有一个“最小化”选项来最小化运行主 R 窗口。

我已经创建了我想要运行的函数（通常是使用 tcltk 的专用 gui）和任何需要的数据，并将它们保存在 .Rdata 文件中，还创建了 .First 或 .Rprofile 来运行显示 gui 的命令。用户双击桌面上的图标并弹出我的 GUI，他们可以使用它而忽略其他部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T17:31:40.530

查看 ProjectTemplate 库。它做你想做的事。它从批处理文件加载使用过的库并在加载后自动运行 R 文件以及许多其他有用的东西......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-08-09T13:30:46.400

[使用来自https://stackoverflow.com/a/27350487/41338](https://stackoverflow.com/a/27350487/41338)的答案和来自上面[Richie Cotton](https://stackoverflow.com/questions/11565820/starting-r-and-calling-a-script-from-a-batch-file/11567220#comment15319597_11565945)的评论，我得出了以下解决方案，通过检查指向窗口的指针是否在关闭窗口之前保持脚本处于活动状态有效的。

对于使用以下命令创建和显示的 RGtk2 窗口：

```
library(RGtk2)
mainWindow <- gtkWindow("toplevel", show = TRUE) 
```

创建一个检查指向它的指针是否存在的函数：

```
isnull <- function(pointer){
  a <- attributes(pointer)
  attributes(pointer) <- NULL
  out <- identical(pointer, new("externalptr"))
  attributes(pointer) <- a
  return(out)
} 
```

在你的脚本的最后：

```
while(!isnull(mainWindow)) Sys.sleep(1) 
```

# javascript - 奇怪的 JS 行为：执行功能需要额外的行吗？

> ID：11565823
> 
> 赞同：1
> 
> 时间：2012-07-19T17:03:40.710
> 
> 标签：javascript, jquery, function, console

我只是不明白。

```
function init() {

    $(document).on('click', '#listFilter .option:not(".darr"), #listSort .option:not(".darr")', function() {
        var selected = $(this).data('ajax-link'),
            dropDown = $(this).parent().parent(),
            filter = '',
            sort = '';

        if ( dropDown.attr('id') == "weaveListFilter" ) {
            filter = selected;
            sort = $('#listSort .darr').data('ajax-link');
        } else if ( dropDown.attr('id') == "weaveListSort" ) {
            filter = $('#listFilter .darr').data('ajax-link');
            sort = selected;
        }

        if ( selected != dropDown.find('.darr').data('ajax-link') )
            console.log('why?')
            sortList(filter, sort, dropDown.parent());
            //console.log('wtf!')
    });

} 
```

没有这个`console.log('why?')`函数`sortList()`是不会被调用的！！！为什么没有这条线就不会被调用？

最奇怪的是，这个“为什么？” 甚至没有登录我的控制台。但是没有它， sortList() 函数就不会执行。“wtf！” 在函数调用将被记录后，但我还是没有得到它。

想法？我是笨还是笨？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T17:07:19.037

因为你`if`失败了。`{ }`主体周围没有大括号`if`，因此只有第一个语句被认为是`if`. 通过添加`console.log`，您将`sortList`不再是`if`.

首先，在你的周围加上大括号`if`：

```
if ( selected != dropDown.find('.darr').data('ajax-link') ) {
    sortList(filter, sort, dropDown.parent());
} 
```

然后去找出你的`if`条款失败的原因。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-19T17:09:20.187

`{ }`在此之后您忘记了该块`if`：

```
if ( selected != dropDown.find('.darr').data('ajax-link') ) 
```

这种情况显然是错误的，所以会发生什么：

*   `console.log()`不执行
*   `sortList()`不附加到`if`，所以它总是运行。

如果您注释掉`console.log()`，则两个语句都不会运行，因为

*   `console.log()`被评论
*   `sortList()`处于虚假状态

# objective-c - 我必须使用按钮吗？

> ID：11565834
> 
> 赞同：0
> 
> 时间：2012-07-19T17:04:14.580
> 
> 标签：objective-c, ios, cocoa-touch, interface-builder

我正在制作一个应用程序。这是一种捉迷藏。我正在考虑划分单独的区域，并让应用程序对您触摸屏幕的位置说出不同的内容。它会为您提供下一步需要触摸屏幕位置的线索。所以，这些是我的问题：
最简单的方法是什么？我想制作一个圆形矩形按钮网格 - 放置每个按钮并为每个按钮制作一个插座 - 还是我可以在屏幕上制作其他按钮网格。如果我放置每个按钮，我将有一个 9x12 的按钮制作 108 个按钮。然后我需要有一种方法来选择一个随机按钮来确定问题所在的位置。我会使用按钮还是有更简单的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T17:17:03.597

108 个按钮太多了，无法放入 xib :) 如果您想使用按钮，那么我会`viewDidLoad`在您的控制器中以编程方式创建它们。

但是，我根本不会使用按钮！

我会使用附加到您的背景视图的[TapGestureRecognizer 。](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIGestureRecognizer_Class/Reference/Reference.html)当你收到一个水龙头时，看看它在哪里（使用`locationInView:self.view`）并用它来计算如何处理新闻。

# ckeditor - 我的 ckeditor 没有加载工具栏

> ID：11565835
> 
> 赞同：1
> 
> 时间：2012-07-19T17:04:15.037
> 
> 标签：ckeditor

我试图在 php 中安装 ckeditor 但没有结果：S。

我已将 ckeditor 文件上传到站点的根目录，并且我有一个 editor.html 文件，其中包含以下代码：

```
<html> 
```

```
<script type="text/javascript" src="/ckeditor/ckeditor.js"></script> 
```

```
<form method="post">
    <p>
        My Editor:<br />
        <textarea id="editor1" name="editor1">&lt;p&gt;Initial value.&lt;/p&gt;</textarea>
        <script type="text/javascript">
            CKEDITOR.replace( 'editor1' );
        </script>
    </p>
    <p>
        <input type="submit" />
    </p>
</form> 
```

当我打开页面时，它不显示工具栏，除了一个简单的文本区域。

你们中有人知道我在这里实际上缺少什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-24T13:03:21.107

Maybe you can try this:

```
CKEDITOR.replace('editor1', {width: 1050, height: 500,  uiColor: '#e1e1e1'}); 
```

that means, you change the size....

So, can be, that it is better to use this CODE

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-10T04:28:24.207

我不知道这是否是您的情况，但以防将来对其他人有所帮助...

我正在将 CKEditor 添加到我的项目中，但工具栏也没有显示给我。我可以告诉 javascript 文件已加载（和 css 文件）。也没有javascript错误。

最终，我将其缩小为 jquery 插件 (jquery.stylish-select) 和 CKEditor 之间的冲突。当我删除插件时，工具栏完美显示。

# vba - 如何以编程方式遍历 Word 文档中的下标、上标和方程式

> ID：11565839
> 
> 赞同：4
> 
> 时间：2012-07-19T17:04:23.010
> 
> 标签：vba, ms-word

我有几个 Word 文档，每个文档包含数百页的科学数据，其中包括：

*   化学式（H2SO4 和所有正确的下标和上标）
*   科学数字（使用上标格式化的指数）
*   大量的数学方程。使用 Word 中的数学方程式编辑器编写。

问题是，以 Word 的形式存储这些数据对我们来说效率不高。因此，我们希望将所有这些信息存储在数据库（MySQL）中。我们想将这些格式转换为 LaTex。

有没有办法使用 VBA 遍历所有下标和上标和方程？

遍历数学方程怎么样？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-26T05:49:28.033

**根据您对迈克尔回答的[评论](https://stackoverflow.com/questions/11565839/how-to-programmatically-iterate-through-subscripts-superscripts-and-equations-fo#comment15302569_11566989)**

> 不！我只想用 _{ subscriptcontent } 替换下标中的内容，并用 ^{ superscriptcontent } 替换类似的上标内容。那将是Tex等价物。现在，我将所有内容复制到一个文本文件中，该文件将删除格式但保留这些字符。问题解决了。但为此我需要访问文档的下标和上标对象

```
Sub sampler()
    Selection.HomeKey wdStory
    With Selection.find
        .ClearFormatting
        .Replacement.ClearFormatting
        .Font.Superscript = True
        .Replacement.Text = "^^{^&}"
        .Execute Replace:=wdReplaceAll
        .Font.Subscript = True
        .Replacement.Text = "_{^&}"
        .Execute Replace:=wdReplaceAll
    End With
End Sub 
```

**编辑**

**或者，如果您还想转换`OMaths`为`TeX / LaTeX`，请执行以下操作：**

*   ***遍历 Omaths > 将每个转换为 MathML > [将 MathML 保存到磁盘] + [在描述 MathML 文件引用的文档中放置一些标记代替 OMath] > 将 Word 文件转换为文本***
*   ***现在准备一个像[MathParser](http://www.tilman.de/programme/mathparser/anleitung_en.html)这样的转换器并将 MathML 文件转换为 LateX。***
*   ***解析文本文件 > 相应地搜索和替换 LaTeX 代码。***

**对于完全不同的想法，请访问[David Carlisle 的博客](http://dpcarlisle.blogspot.in/2007/04/xhtml-and-mathml-from-office-20007.html)，这可能会让您感兴趣。**

**更新**

***`The module`***

```
Option Explicit

'This module requires the following references:
'Microsoft Scripting Runtime
'MicroSoft XML, v6.0

Private fso As New Scripting.FileSystemObject
Private omml2mml$, mml2Tex$

Public Function ProcessFile(fpath$) As Boolean
    'convPath set to my system at (may vary on your system):
    omml2mml = "c:\program files\microsoft office\office14\omml2mml.xsl"
    'download: http://prdownloads.sourceforge.net/xsltml/xsltml_2.0.zip
    'unzip at «c:\xsltml_2.0»
    mml2Tex = "c:\xsltml_2.0\mmltex.xsl"

    Documents.Open fpath

    'Superscript + Subscript
    Selection.HomeKey wdStory
    With Selection.find
        .ClearFormatting
        .Replacement.ClearFormatting

        'to make sure no paragraph should contain any emphasis
        .Text = "^p"
        .Replacement.Text = "^&"
        .Replacement.Font.Italic = False
        .Replacement.Font.Bold = False
        .Replacement.Font.Superscript = False
        .Replacement.Font.Subscript = False
        .Replacement.Font.SmallCaps = False
        .Execute Replace:=wdReplaceAll

        .Font.Italic = True
        .Replacement.Text = "\textit{^&}"
        .Execute Replace:=wdReplaceAll

        .Font.Bold = True
        .Replacement.Text = "\textbf{^&}"
        .Execute Replace:=wdReplaceAll

        .Font.SmallCaps = True
        .Replacement.Text = "\textsc{^&}"
        .Execute Replace:=wdReplaceAll

        .Font.Superscript = True
        .Replacement.Text = "^^{^&}"
        .Execute Replace:=wdReplaceAll

        .Font.Subscript = True
        .Replacement.Text = "_{^&}"
        .Execute Replace:=wdReplaceAll
    End With

    Dim dict As New Scripting.Dictionary
    Dim om As OMath, t, counter&, key$
    key = Replace(LCase(Dir(fpath)), " ", "_omath_")
    counter = 0

    For Each om In ActiveDocument.OMaths
        DoEvents
        counter = counter + 1
        Dim tKey$, texCode$
        tKey = "<" & key & "_" & counter & ">"
        t = om.Range.WordOpenXML

        texCode = TransformString(TransformString(CStr(t), omml2mml), mml2Tex)
        om.Range.Select
        Selection.Delete
        Selection.Text = tKey

        dict.Add tKey, texCode

    Next om

    Dim latexDoc$, oPath$
    latexDoc = "\documentclass[10pt]{article}" & vbCrLf & _
                "\usepackage[utf8]{inputenc} % set input encoding" & vbCrLf & _
                "\usepackage{amsmath,amssymb}" & vbCrLf & _
                "\begin{document}" & vbCrLf & _
                "###" & vbCrLf & _
                "\end{document}"

    oPath = StrReverse(Mid(StrReverse(fpath), InStr(StrReverse(fpath), "."))) & "tex"
    'ActiveDocument.SaveAs FileName:=oPath, FileFormat:=wdFormatText, Encoding:=1200
    'ActiveDocument.SaveAs FileName:=oPath, FileFormat:=wdFormatText, Encoding:=65001
    ActiveDocument.Close

    Dim c$, i
    c = fso.OpenTextFile(oPath).ReadAll()

    counter = 0

    For Each i In dict
        counter = counter + 1
        Dim findText$, replaceWith$
        findText = CStr(i)
        replaceWith = dict.item(i)
        c = Replace(c, findText, replaceWith, 1, 1, vbTextCompare)
    Next i

    latexDoc = Replace(latexDoc, "###", c)

    Dim ost As TextStream
    Set ost = fso.CreateTextFile(oPath)
    ost.Write latexDoc

    ProcessFile = True

End Function

Private Function CreateDOM()
    Dim dom As New DOMDocument60
    With dom
        .async = False
        .validateOnParse = False
        .resolveExternals = False
    End With
    Set CreateDOM = dom
End Function

Private Function TransformString(xmlString$, xslPath$) As String
    Dim xml, xsl, out
    Set xml = CreateDOM
    xml.LoadXML xmlString
    Set xsl = CreateDOM
    xsl.Load xslPath
    out = xml.transformNode(xsl)
    TransformString = out
End Function 
```

***`The calling(from immediate window):`***

```
?ProcessFile("c:\test.doc") 
```

**结果将如`test.tex`.`c:\`**

* * *

***该模块可能需要修复一些地方。如果是这样，请告诉我。***

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T18:21:23.583

Word 中的 Document 对象有一个 oMaths 集合，它代表文档中的所有 oMath 对象。oMath 对象包含 Functions 方法，该方法将返回 oMath 对象内的函数集合。所以，方程应该不是那么大的问题。

但是，我想您不仅要捕获下标和上标，还需要包含这些下标和上标的整个方程。这可能更具挑战性，因为您必须定义起点和终点。如果您要使用 .Find 方法查找下标，然后选择它之前的第一个空格字符和它之后的第一个空格字符之间的所有内容，这可能有效，但前提是您的方程不包含空格。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-25T17:19:07.770

这个 VBA sub 应该遍历文档中的每个文本字符，并在插入 LaTeX 表示法时删除上标和下标。

```
Public Sub LatexConversion()

Dim myRange As Word.Range, myChr
For Each myRange In ActiveDocument.StoryRanges
  Do
    For Each myChr In myRange.Characters

        If myChr.Font.Superscript = True Then
            myChr.Font.Superscript = False
            myChr.InsertBefore "^"
        End If

        If myChr.Font.Subscript = True Then
            myChr.Font.Subscript = False
            myChr.InsertBefore "_"
        End If

    Next
    Set myRange = myRange.NextStoryRange
  Loop Until myRange Is Nothing
Next
End Sub 
```

如果某些方程式是使用 Word 的内置方程式编辑器或通过构建块 (Word 2010/2007) 创建的并且存在于内容控件中，则上述内容将不起作用。在执行上述操作之前，这些方程式将需要单独的 VBA 转换代码或手动转换为纯文本方程式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-01-05T14:41:12.990

使用 Open XML SDK 将 OpenMath (OMath) 实现到 LaTex 的 C# 实现。从这里下载 MMLTEX XSL 文件[http://sourceforge.net/projects/xsltml/](http://sourceforge.net/projects/xsltml/)

```
 public void OMathTolaTeX()
    {
        string OMath = "";
        string MathML = "";
        string LaTex = "";
        XslCompiledTransform xslTransform = new XslCompiledTransform();
        // The MML2OMML.xsl file is located under 
        // %ProgramFiles%\Microsoft Office\Office12\
        // Copy to Local folder
        xslTransform.Load(@"D:\OMML2MML.XSL");
        using (WordprocessingDocument wordDoc =
                  WordprocessingDocument.Open("test.docx", true))
        {
            OpenXmlElement doc = wordDoc.MainDocumentPart.Document.Body;

            foreach (var par in doc.Descendants<Paragraph>())
            {
               var math in par.Descendants<DocumentFormat.OpenXml.Math.Paragraph>().FirstOrDefault();
               File.WriteAllText("D:\\openmath.xml", math.OuterXml);
               OMath = math.OuterXml;

           }
        }
        //Load OMath string into stream
        using (XmlReader reader = XmlReader.Create(new StringReader(OMath)))
        {
            using (MemoryStream ms = new MemoryStream())
            {
                XmlWriterSettings settings = xslTransform.OutputSettings.Clone();

                // Configure xml writer to omit xml declaration.
                settings.ConformanceLevel = ConformanceLevel.Fragment;
                settings.OmitXmlDeclaration = true;

                XmlWriter xw = XmlWriter.Create(ms, settings);

                // Transform our MathML to OfficeMathML
                xslTransform.Transform(reader, xw);
                ms.Seek(0, SeekOrigin.Begin);

                StreamReader sr = new StreamReader(ms, Encoding.UTF8);

                MathML= sr.ReadToEnd();

                Console.Out.WriteLine(MathML);
                File.WriteAllText("d:\\MATHML.xml", MathML);
                // Create a OfficeMath instance from the
                // OfficeMathML xml.
                sr.Close();
                reader.Close();
                ms.Close();

                // Add the OfficeMath instance to our 
                // word template.

            }
        }
        var xmlResolver = new XmlUrlResolver();
        xslTransform = new XslCompiledTransform();
        XsltSettings xsltt = new XsltSettings(true, true);
        // The mmtex.xsl file is to convert to Tex 
        xslTransform.Load("mmltex.xsl", xsltt, xmlResolver);

        using (XmlReader reader = XmlReader.Create(new StringReader(MathML)))
        {
            using (MemoryStream ms = new MemoryStream())
            {
                XmlWriterSettings settings = xslTransform.OutputSettings.Clone();

                // Configure xml writer to omit xml declaration.
                settings.ConformanceLevel = ConformanceLevel.Fragment;
                settings.OmitXmlDeclaration = true;

                XmlWriter xw = XmlWriter.Create(ms, settings);

                // Transform our MathML to OfficeMathML
                xslTransform.Transform(reader, xw);
                ms.Seek(0, SeekOrigin.Begin);

                StreamReader sr = new StreamReader(ms, Encoding.UTF8);

                LaTex = sr.ReadToEnd();
                sr.Close();
                reader.Close();
                ms.Close();
                Console.Out.WriteLine(LaTex);
                File.WriteAllText("d:\\Latex.txt", LaTex);
                // Create a OfficeMath instance from the
                // OfficeMathML xml.

                // Add the OfficeMath instance to our 
                // word template.

            }
        }
    } 
```

希望这对 C# 开发人员有所帮助。

# javascript - 对嵌套的 JSON 数组进行排序

> ID：11565841
> 
> 赞同：0
> 
> 时间：2012-07-19T17:04:38.533
> 
> 标签：javascript

我正在尝试对这个 JSON 对象进行排序：

```
JSONObject = {
    "command": [{
        "geobox": [...],
        "jobName": "...",
        "keywords": ["..."],
        "users": ["..."]
    }, {
        "geobox": [...],
        "jobName": "...",
        "keywords": ["...", "..."],
        "users": ["...", "...", "..."]
    }],
    "type": "..."
} 
```

它有“命令”，它是一个嵌套的 json 对象数组和我并不真正关心的“类型”。我希望它根据 jobName 值按字母顺序对“命令”中的嵌套 json 对象数组进行排序。我尝试过这样的事情，但没有奏效。

```
JSONObject.command.sort(function (a, b) {
    return JSONObject.command[a].jobName - JSONObject.command[b].jobName
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T17:08:28.343

```
var compareStr = function (a, b) { 
   if (a.jobName == b.jobName) 
       return 0; 
   if (a.jobName > b.jobName) 
       return 1; 
   return -1;
};
JSONObject.command.sort(compareStr); 
```

# c# - WPF MultiValueConverter 数据绑定到字符串值不引用

> ID：11565844
> 
> 赞同：0
> 
> 时间：2012-07-19T17:04:47.893
> 
> 标签：c#, wpf, data-binding

我是 WPF 和数据绑定的新手，所以我很容易在我的研究中遗漏一些东西，或者我一直在使用错误的搜索词（更有可能）来找到解决方案。

绑定的值似乎正在传递，而不是对对象的引用，因此当值在后面的代码中设置时，它不会得到更新。

在尝试概括 OpenFileDialog 以在选项卡控件的某些不同选项卡上有用。我创建了一个包含参数（路径、过滤器和文本框）的自定义数据对象

```
class OpenFileCommandParameters
{
    public string Filter { get; set; }
    public string Path { get; set; }
    public string TextBox { get; set; }
}
class OpenFileCommandParamtersConverter : IMultiValueConverter
{
    public object Convert(object[] values, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        OpenFileCommandParameters parameters = new OpenFileCommandParameters();
        if (values[0] is string) parameters.Filter = (string)values[0];
        if (values[1] is string) parameters.Path = (string)values[1];
        if (values[2] is string) parameters.TextBox = (string)values[2];
        return parameters;
    }
    public object[] ConvertBack(object value, Type[] targetTypes, object parameter, System.Globalization.CultureInfo culture)
    {
        throw new NotImplementedException();
    }
} 
```

用于传递信息的 XAML 如下所示：

```
<TextBox Name="ButtonTagImportFileName" Text="{Binding Path=TagImportTabVM.TbFileName}" Height="23" HorizontalAlignment="Left" Margin="83,17,0,0" VerticalAlignment="Top" Width="221" />
<Button Name="TagImportOpenFile" Content="Open File" Command="{Binding Path=OpenFileCommand}" Height="23" HorizontalAlignment="Left" Margin="342,17,0,0" VerticalAlignment="Top" Width="98" >
  <Button.CommandParameter>
      <MultiBinding Converter="{StaticResource openFileCommandParametersConverter}">
          <MultiBinding.Bindings>
              <Binding Source="XML files (*.xml)|*xml|All files (*.*)|*.*"/>
              <Binding Path="AppPath"/>
              <Binding Path="TagImportTabVM.TbFileName"/>
          </MultiBinding.Bindings>
      </MultiBinding>
  </Button.CommandParameter> 
```

文本框和打开文件按钮都绑定到相同的字符串属性。

属性通过执行命令更新

```
private void OpenFile(object parameter)
    {
       var parameters = parameter as OpenFileCommandParameters;
       FileDialog.Filter = parameters.Filter;
       FileDialog.InitialDirectory = parameters.Path;
       if (parameters == null) return;
       var result = FileDialog.ShowDialog();
       if (result == true)
       {
           parameters.TextBox = FileDialog.SafeFileName;
       }
    } 
```

一旦这个命令完成，我希望 TbFileName 的值与来自文件对话框的值相同。不是这种情况。从 OpenFile 块结束前的断点看。

![在此处输入图像描述](../Images/27dfdda766b2b1d0a4bf1d7130791086.png)

我很感激你能给我的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T23:13:08.037

我相信这不起作用，因为 MultiBinding 从不尝试更新其源绑定。有可能以某种方式强制执行此操作，但是当我尝试使用时

```
BindingOperations.GetBindingExpression(TagImportOpenFile, Button.CommandParameterProperty) 
```

它总是返回 null，所以我不确定绑定 CommandParameters 的方法是否可行。获取 CommandProperty 的表达式工作正常，CommandParameters 必须不同......不知何故。

我认为一种绝对可行的方法是：

a）将您的参数类转换为 ViewModel（或至少将其作为 INotifyPropertyChanged/DependencyObject 进行双向绑定），TextBox 属性可能需要重命名为“FileName”之类的东西。

b) 将此类的实例放在您的屏幕 ViewModel 上（在这种情况下为“TagImportTabVM”？），

c) 将您的 XAML 更改为以下内容：

```
<TextBox Name="ButtonTagImportFileName" Text="{Binding Path=OpenFileVM.FileName}" Height="23" HorizontalAlignment="Left" Margin="83,17,0,0" VerticalAlignment="Top" Width="221" />
<Button Name="TagImportOpenFile" Content="Open File" Command="{Binding Path=OpenFileCommand}" CommandParameter="{Binding OpenFileVM}" 
        Height="23" HorizontalAlignment="Left" Margin="342,17,0,0" VerticalAlignment="Top" Width="98" /> 
```

这是假设您在创建参数的新实例时不介意在代码中设置文件过滤器（因为我假设您无论如何都为 AppPath 做了类似的事情）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T17:19:15.300

我对这个解决方案非常满意，@一只小绵羊用他的解决方案帮助我完成了剩下的路。只是想完全结束这个问题。

我在想，因为源没有得到更新，所以我在通过代码设置值时破坏了绑定。不是这种情况。只是根本不知道值已更改，因此不知道更新源。

一旦我发现了这一点，就很容易找到如何通知系统让它知道它需要更新源。这被添加到`private void OpenFile(object parameter)`

```
BindingExpression binding = BindingOperations.GetBindingExpression(parameters.PassedTextBox, TextBox.TextProperty);
binding.UpdateSource(); 
```

这就是为了让它正确更新而添加的所有内容。

# javascript - Javascript 对象属性和函数

> ID：11565846
> 
> 赞同：5
> 
> 时间：2012-07-19T17:04:57.557
> 
> 标签：javascript, oop, object

在 JavaScript 中，我看到了几种不同的方式，可以在对象中执行某些任务，例如我下面的对象 Egg。

谁能告诉我每个之间的区别，为什么我会使用一个而不是另一个等

```
 var Egg = function(){

    //Properties

    var shell = "cracked" // private property 

    this.shell = "cracked" // public property

    shell: "cracked" // what is this??

    //functions

    function cook(){

        //standard function
    }

    cook: function(){
        //what kind of function is this?
    }

    //not sure what this is

    details: {
        //What is this? an array :S it holds 2 elements?
        cost: 1.23,
        make: 'Happy Egg';
    }

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-19T17:18:03.450

您的代码片段不太有效，但它提出了以下几点：

## 属性初始化器、对象初始化器

你问的是什么`shell: cracked`。它是一个*属性初始化器*。您可以在[*对象初始值设定项*](http://ecma-international.org/ecma-262/5.1/#sec-11.1.5)（又名“对象文字”）中找到它们，它们的写法如下：

```
var obj = {
    propName: "propValue"
}; 
```

这相当于：

```
var obj = {};
obj.propName = "propValue"; 
```

以上两者都创建了一个对象，该对象具有一个名为的属性，该属性`propName`具有一个字符串 value `"propValue"`。请注意，`this`它不会进入它。

## 职能

有几个地方通常会针对对象使用函数：

### 构造函数

有*构造函数*，它们是您通过[`new`操作符](http://ecma-international.org/ecma-262/5.1/#sec-11.2.2)调用的函数。这是一个例子：

```
// Constructor function
function Foo(name) {
    this.name = name;
}

// Usage
var f = new Foo("Fred"); 
```

请注意其中关键字的使用`this`。这就是你看到的地方（很可能）。当你通过 调用构造函数时`new`，`this`指的是`new`操作符创建的新对象。

`this``this`在 JavaScript 中是一个滑溜的概念（与C++、Java 或 C# 中的完全不同），我在我的博客上推荐这两个*（咳咳）帖子：*

*   [你必须记住`this`](http://blog.niftysnippets.org/2008/04/you-must-remember-this.html)
*   [神话方法](http://blog.niftysnippets.org/2008/03/mythical-methods.html)

### 生成器/工厂函数

您不必使用构造函数和`new`，另一种模式使用“builder”或“factory”函数代替：

```
// A factory function
function fooFactory(name) {
    var rv = {}; // A new, blank object

    rv.name = name;

    return rv;
}

// Usage
var f = fooFactory("Fred"); 
```

## 私人财产

您在问题中提到了“私有”属性。JavaScript 根本没有私有属性（不过，它们正在开发中）。*但是您会看到人们通过将他们在对象上使用的函数定义为执行上下文（通常是对构造函数或工厂函数的调用）的闭包*来模拟它们，其中包含其他人无法看到的变量，如下所示：

```
// Constructor function
function EverUpwards() {
    var counter = 0;

    this.increment = function() {
        return ++counter;
    };
}

// Usage:
var e = new EverUpwards();
console.log(e.increment()); // "1"
console.log(e.increment()); // "2" 
```

（该示例使用构造函数，但您可以使用工厂函数执行相同的操作。）

请注意，即使我们分配给的功能`increment`可以访问`counter`，但其他任何东西都不能。`counter`实际上是私有财产。这是因为该函数是一个闭包。更多：[*闭包并不复杂*](http://blog.niftysnippets.org/2008/02/closures-are-not-complicated.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-19T17:33:30.280

当然，本。

这种方式触及了 JavaScript 活力的底层。首先，我们将了解基础知识——如果您来自了解基于类的语言的地方，例如 Java 或 C++/C#，那么最有意义的是构造函数模式很早就包括在内：

```
function Egg (type, radius, height, weight) {
    // private properties (can also have private functions)
    var cost = (type === "ostrich") ? 2.05 * weight : 0.35 * weight;

    // public properties
    this.type = type;
    this.radius = radius;
    this.height = height;
    this.weight = weight;
    this.cracked = false;

    // this is a public function which has access to private variables of the instance
    this.getCost = function () { return cost; };
}

// this is a method which ALL eggs inherit, which can manipulate "this" properly
// but it has ***NO*** access to private properties of the instance
Egg.prototype.Crack = function () { this.cracked = true; };

var myEgg = new Egg("chicken", 2, 3, 500);

myEgg.cost; // undefined
myEgg.Crack();
myEgg.cracked; // true 
```

这很好，但有时有更简单的方法来解决问题。有时你真的不需要上课。

如果你只是想用一个鸡蛋怎么办，因为这就是你的食谱所要求的？

```
var myEgg = {};  // equals a new object
myEgg.type = "ostrich";
myEgg.cost = "......";
myEgg.Crack = function () { this.cracked = true; }; 
```

这很好，但那里仍然有很多重复。

```
var myEgg = {
    type : "ostrich",
    cost : "......",
    Crack : function () { this.cracked = true; }
}; 
```

这两个“myEgg”对象完全相同。

这里的问题是 myEgg 的每一个属性和每一个方法对任何人都是 100% 公开的。

解决方案是立即调用函数：

```
// have a quick look at the bottom of the function, and see that it calls itself
// with parens "()" as soon as it's defined
var myEgg = (function () {
    // we now have private properties again!
    var cost, type, weight, cracked, Crack, //.......

    // this will be returned to the outside var, "myEgg", as the PUBLIC interface
    myReturnObject = {
        type : type,
        weight : weight,
        Crack : Crack, // added benefit -- "cracked" is now private and tamper-proof
        // this is how JS can handle virtual-wallets, for example
        // just don't actually build a financial-institution around client-side code...
        GetSaleValue : function () { return (cracked) ? 0 : cost; }
    };

    return myReturnObject;
}());

myEgg.GetSaleValue(); // returns the value of private "cost"
myEgg.Crack();
myEgg.cracked // undefined ("cracked" is locked away as private)
myEgg.GetSaleValue(); // returns 0, because "cracked" is true 
```

希望这是一个不错的开始。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T17:12:19.830

您正在混合对象属性声明和简单的 javascript 语句之间的语法。

```
// declare an object named someObject with one property
var someObject = {
    key: value
};

// declare an anonymous function with some statements in it
// and assign that to a variable named "someFunction"
var someFunction = function () {
    // any javascript statements or expressions can go here
}; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T17:14:37.307

在 JavaScript 中，对象和函数之间有一个关键的区别。对象包含一堆数据（包括函数），函数可以用来制作或修改对象，但它们本质上不是一回事。JavaScript 中的 OOP 是基于将函数用作类。例如，参加以下课程：

```
Test = function(){
    this.value = 5;
} 
```

如果你只是调用函数`Test()`，那么什么都不会发生。即使你说`var x = Test()`，x 的值也会`undefined`。然而，使用`new`关键字，奇迹发生了！因此，如果我们说`var x = new Test()`，那么现在变量`x`将包含一个 Test 对象。如果你这样做`console.log(x.value)`，它将打印 5。

这就是我们可以使用函数来制作对象的方式。语法上还有一个关键的不同——一个函数可以包含你想要的任何类型的 JavaScript 块，无论是 if 语句还是 for 循环或者你有什么。但是，在声明对象时，您必须使用`key: value`语法。

希望能把事情弄清楚一点！

# r - 用空格对字符串进行排序 - R 的 Ubuntu 版本中的结果不正确

> ID：11565854
> 
> 赞同：1
> 
> 时间：2012-07-19T17:05:44.357
> 
> 标签：r, sorting, whitespace

> **可能重复：**
> [R 排序规则是什么？](https://stackoverflow.com/questions/7229408/what-are-the-r-sorting-rules)

我们正在尝试对我的数据矩阵中的基因位置坐标进行排序。该列的格式为：

> xx xxxxxx

其中 xx 是从 1 到 23 的染色体编号，xxxxxx 是基因位置的数字字符串。

特别是，我有兴趣首先按染色体编号然后按基因位置对数据矩阵进行升序排序，例如，染色体 5 上的基因 1，位置 21 位于染色体 17，位置 34 上基因 2 的顶部。

在 Windows 上的 R (2.15.0 x64) 中，我看到以下结果：

```
> '5 21' < '12 14'
[1] FALSE
> ' 5 21' < '12 14' # white space prefixed to first digit corrects sort order.
[1] TRUE 
```

在 Ubuntu 12.04 LTS 上的 R (2.15.1 x64) 中，我看到以下结果：

```
> '5 21' < '12 14'
[1] FALSE
> ' 5 21' < '12 14' # white space does not correct sort order.
[1] FALSE 
```

这对我来说很奇怪，因为 Windows 版本通过忽略空格然后考虑数字排序（05 vs 11）来纠正排序顺序，而 Linux 版本按字符排序（5 vs 1）。Windows 版本假定前缀空格为 0（我猜），然后考虑两位数进行比较，但 Linux 版本忽略空格并将第一个字符串的第二个数字与第二个字符串的第一个数字进行比较。

我在 R 中找到了混合排序 {gtools} 函数来克服这个问题，但认为这值得报告并获得解决此问题的帮助。

谢谢！

# c# - 在 Rx 中从数组创建 hot observable

> ID：11565856
> 
> 赞同：3
> 
> 时间：2012-07-19T17:05:45.697
> 
> 标签：c#, system.reactive, reactive-programming

我怎样才能做到这一点？

我有一个代码：

```
new int[]{1,2,3}.ToObservable().Subscribe(myObserver); 
```

问题是这个第一次调用是一个冷的可观察的，所以在另一个这样的调用中：

```
new int[]{4,5,6}.ToObservable().Subscribe(myObserver); 
```

myObserver 根本不会触发 onNext。显然是因为第一个电话发布了`1,2,3, END`. 我不想让 observable 调用“END”，因为我想稍后继续订阅。是否有一个功能可以轻松为我做到这一点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-20T01:25:06.840

你需要做这样的事情：

```
new int[] { 1, 2, 3, }
    .ToObservable()
    .Concat(Observable.Never<int>())
    .Subscribe(myObserver); 

new int[] { 4, 5, 6, }
    .ToObservable()
    .Concat(Observable.Never<int>())
    .Subscribe(myObserver); 
```

关键是对`.Concat(Observable.Never<int>())`observable 做 a 以防止它永远结束。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T17:44:33.853

在不知道如何在上下文中使用这些 observables 的情况下，我的第一个建议是订阅之前`Concat`的两个 observables（或s）。`IEnumerable`

```
(new int[]{1,2,3}.ToObservable())
.Concat(new int[]{4,5,6}.ToObservable())
.Subscribe(myObserver) 
```

据我所知，没有一种方法可以在代码中的`ToObservable`and`Subscribe`调用之间插入来获得您所追求的行为。可以编写这样的方法，但它不能很好地与库的其余部分配合使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-20T14:05:06.183

Fwiw，要将 Cold Observable 变成 Hot Observable，请使用多播：

```
var obs = new[] {1,2,3}.ToObservable()
    .Multicast(new Subject<int>())

// TODO: Subscribe as many people as you want

obs.Connect();  // Everyone subscribed gets 1,2,3,Completed now

obs.Subscribe(...);  // This guy gets no results 
```

# django - 如何将我的站点的基本模板用于 Django 管理区域？

> ID：11565857
> 
> 赞同：1
> 
> 时间：2012-07-19T17:05:47.703
> 
> 标签：django

我知道我可以通过创建一个名为`admin/base.html`并编写类似以下内容的模板来覆盖管理模板：

```
<h1>Hello!</h1>
{% block content %}
{% endblock %} 
```

但是，我的网站有自己的基本模板（对内容块使用“内容”），我希望将其用于管理网站。除了站点的基本 HTML 之外，我还需要添加管理 CSS 和脚本，例如：

```
<link rel="stylesheet" type="text/css" href="{% block stylesheet %}{% static "admin/css/base.css" %}{% endblock %}" /> 
```

因此，我将使用从我的站点的基本模板继承的模板覆盖管理模板。但是，如果我在此模板中定义一个内容块来插入内容，它会立即被各个管理视图模板覆盖。更改块名称似乎是错误的解决方案，因为它用于管理模板这一事实表明它是 Django 中使用的正确约定。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T08:20:54.993

好的做法是复制原始 admin/base_site.html 并在此处进行调整（编辑标题、品牌、添加`{% block extrahead %}`或`{% block extrastyle %}`使用您自己的 css/js 等。

管理站点预计不会集成在自定义模板中，但您可以轻松地将样式与您自己的喜好相一致。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-07-19T21:21:18.510

只需创建一个**admin/base.html**文件，并将其放入：

```
{% extends "base.html" %}
# according base.html to the name of your base layout file 
```

# php - 防止“腐败”

> ID：11565862
> 
> 赞同：0
> 
> 时间：2012-07-19T17:06:01.703
> 
> 标签：php, mysql, sql, mysqli

我正在使用 PHP 创建一个应用程序并涉及 MySQL。如果在请求的中途出现错误，我将如何“将查询组合在一起”，检查它是否成功，然后对真实表进行实际影响。如果对表的实际更新失败，则恢复到更新前的状态，并给出用户错误。

我使用 MySQLi，如果这很重要。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T17:08:41.717

您将需要用户进行交易： [http ://dev.mysql.com/doc/refman/5.0/en/commit.html](http://dev.mysql.com/doc/refman/5.0/en/commit.html)

下面的问题很好地解释了它： [PHP + MySQL transactions examples](https://stackoverflow.com/questions/2708237/php-mysql-transactions-examples)

# jquery - jQuery click 事件未在 optgroup 上触发

> ID：11565864
> 
> 赞同：5
> 
> 时间：2012-07-19T17:06:04.583
> 
> 标签：jquery

我有以下代码 - [jsFiddle 上的示例](http://jsfiddle.net/NWDC8/1/)

```
<select>
 <optgroup label="Group1">
   <option value="11">Option 1</option>
   <option value="12">Option 2</option>
 </optgroup>
 <optgroup label="Group2">
   <option value="21">Option 1</option>
   <option value="22">Option 2</option>
 </optgroup>
</select>​ 
```

和一些jQuery代码：

```
$(document).ready(function() {
$("select optgroup").click(function() {
    alert("Clicked " + $(this).attr("label"));            
}); 
```

这似乎很简单。如果我添加`onclick="javascript:alert(...);"`这似乎可行......除了点击无论点击什么都会触发。

为什么这不起作用？

谢谢你的帮助！

**编辑**

我在这里尝试做的事情似乎存在误解，所以我需要稍微扩展代码以提供更好的想法。

我的目标是能够做到以下几点：

```
$(document).ready(function() {
   $("select optgroup").children().hide();
   $("select optgroup").click(function() {
      $(this).children().show();
   }); 
```

如您所见，在选项上捕获单击事件然后确定组将不起作用，因为选项将全部隐藏。我希望在单击组 (optgroup) 时显示选项。话虽如此，Chrome 似乎并不尊重对组的单击，IE 仅返回所选项目的组（当您单击 optgroup 时）项目。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T17:08:11.747

```
$(document).ready(function() {
    $("select").change(function() {
        var clicked = $(this)
                         .find('option:selected') // get selected option
                         .parent()   // get that option's optgroup
                         .attr("label");   // get optgroup's label

        alert( clicked );
    });
}); 
```

**[演示](http://jsfiddle.net/NWDC8/5/)**

### 笔记

`.click()`是您使用的错误事件。见[评论](https://stackoverflow.com/questions/11565864/jquery-click-event-not-firing-on-optgroup/11565895#comment15299624_11565895)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-14T17:43:46.237

有一种复杂的解决方案允许您在多选中侦听 optgroup 上的点击事件。这个想法是监听父选择项的点击，并计算用户是否点击了 optgroup 标题。

```
$('#multipleSelectId').click(function(event) {
    var y = event.pageY - $(this).offset().top;
    var row = Math.floor((y - 4) / 15);
    $(this).find('optgroup').each(function() {
        if (row == 0) {
            onOptgroupClick($(this));       
            return false;
        }
        row -= $(this).children().length + 1; 
    });
}); 
```

这种方法已经在 Chromium 30、Firefox 25、IE 9 中进行了测试。

我不知道它是否可以应用于单选，但是使用“multiple=multiple”它就像一个魅力。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-04T05:24:50.323

这是使用 jQuery 解决它的方法。

首先将事件分配给 optgroup，然后查看传播是否停止。

```
$('optgroup').on('click',function(e) {
    if(!e.isPropagationStopped()){
        if ($(this).find('option:visible').length == $(this).children().length) {
            $(this).children().hide();
        }
        else {
            $(this).children().show();
        }
    }
}); 
```

接下来，我们要防止在单击其中一个子选项时触发前一段代码。

```
$('optgroup > option').on('click',function(e) {
    e.stopPropagation();
    $(this).parent().trigger('change');
}); 
```

在函数末尾调用的“触发器”事件是为了确保更改事件上的任何其他已分配触发器仍然被触发。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-12-30T19:46:58.747

```
<select>
<optgroup onclick="$(this).children().toggle();">
<option>Item 1</option>
<option>Item 2</option>
<option>Item 3</option>
</optgroup>
</select>
<script>
    $( "option" ).click(function( event ) {
      event.stopPropagation();
    }); 
</script> 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-07-20T13:05:46.370

因此，对此的简短回答似乎是这是不可能的。无法使用 optionGroups 进行普通选择并将其转换为手风琴样式的选择列表，其中最初仅显示选项组项目，单击选项组项目会展开其子项（选项）。

似乎没有浏览器真正支持单击选择列表中的组项。虽然存在 onClick 事件，但该事件的行为更像是您单击了所选项目。

# asp.net-mvc-3 - Cookie 添加另一个条目而不是替换现有值

> ID：11565868
> 
> 赞同：1
> 
> 时间：2012-07-19T17:06:32.043
> 
> 标签：asp.net-mvc-3, cookies, session-cookies, jquery-cookie

我正在使用流行的 jquery cookie 插件通过 javascript 设置会话 cookie 值，如下所示：

```
function ChangeLoginUser(sel) {
    var selectedUser = sel.options[sel.selectedIndex].value;
    $.cookie("LoginUser", selectedUser);
    location.reload(true); //refresh
} 
```

用户从站点全局下拉框选项中选择后调用此函数。

*   更改 page1 上的值 - cookie 设置为 CookieName = Value1。
*   转到第 2 页 - cookie 正确保留
*   将下拉值更改为 value2 - Fiddler 现在显示两个具有相同名称的 cookie，两个值如下所示：

> ```
> CookieName = value2
> CookieName = value1 
> ```

我不明白为什么会这样。我只需要保留一个同名的 cookie。新值应该替换旧值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T17:46:26.577

好的。看起来问题出在cookie路径上。每个 URL 可以有一个单独的同名 cookie。解决方案是将路径设置为域范围，如下所示：

```
$.cookie("LoginUser", selectedUser, { path: '/' }); 
```

或者，如果您需要将其缩小到只有您的应用程序，您可以这样做：

```
$.cookie("LoginUser", selectedUser, { path: AppPath }); 
```

可以在共享布局的开头设置 AppPath

```
<script type="text/javascript">
    var AppPath = '@Url.Content("~/")'
</script> 
```

# joomla - 增量更新远程 joomla 网站？

> ID：11565869
> 
> 赞同：0
> 
> 时间：2012-07-19T17:06:32.840
> 
> 标签：joomla, joomla1.5

我的本地主机上有一个 Joomla 1.5 站点。它也托管在公共托管服务器上。

我想知道对网站进行增量更新的最佳方法是什么？我的意思是我不想更新整个站点，如果我只是更改了一个源文件（html、php、图像等）或对数据库进行了更改。我知道，为了安全起见，我每次都必须更新数据库（从本地导出并在远程导入），但我确信我们可以避免不必要地上传未更改的文件。

我看过[https://www.akeebabackup.com](https://www.akeebabackup.com)并没有提供我需要的东西。一种选择是使用进行文件夹同步的 ftp 客户端（如 Filezilla），但我不确定它们是否工作得很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T06:59:07.370

对于数据库，您可以使用主-主复制，这很容易设置，但您需要 MySQL 中的 GRANT 权限，这在共享主机上很可能是不可能的。我还建议通过 VPN 连接两台机器以使其更安全。

如果您使用的是 phpmyadmin，另一种同步数据库的简单方法是“同步”工具。如果没有，请查看任何 MySQL 计划软件，例如 MySQL Workbench，它也内置了此功能。

* * *

您没有说明访问公共托管服务器的权限。

如果您是管理员，您可以安装并配置 SVN 管理员以将文件与本地数据同步。您还可以使用 GIT 存储库来执行完全相同的操作，或者通过 VPN 设置 LDAP 以保持文件同步。

如果您不是管理员，只需查看或询问您的托管公司以上有哪些可用的，我相信他们将能够为您提供帮助。如今，托管公司已经安装了 SVN 或 GIT，这应该是您所需要的。

我经常使用 PHP Designer 8 中内置的 SVN 工具，但您也可以在 NetBeans 中使用 SVN、GIT 等。

# perl - 如何在 Windows 7 中为 Strawberry Perl 安装 Net::Pcap？

> ID：11565874
> 
> 赞同：6
> 
> 时间：2012-07-19T17:06:51.513
> 
> 标签：perl, perl-module, winpcap, strawberry-perl

我尝试在 Windows 中安装[Net::Pcap](http://p3rl.org/Net%3a%3aPcap)，但它给出了以下错误消息：

```
c:\P P> cpan
cpan> 安装 Net::Pcap

socket.h 已修补...好的
寻找-lwpcap ...是的
检查 -lwpcap 中的 pcap_lib_version() ... 否
- - - - - - - - - - - - - - - - - - - - - - - - - - - -
您似乎缺少 WinPcap 开发人员包。

如果安装在非标准位置，请尝试设置 LIBS
和命令行上的 INC 值。例如，如果您已解压缩
C:\WpdPack 中的开发者包，你应该执行：

    perl Makefile.PL INC=-IC:/WpdPack/Include "LIBS=-LC:/WpdPack/Lib -lwpcap"

或从以下位置获取并安装 WinPcap 开发人员包
  http://www.winpcap.org/install/
- - - - - - - - - - - - - - - - - - - - - - - - - - - -
检测可用功能...好的

检查您的套件是否完整...

看起来不错

注意（可能无害）：未找到 -lwpcap 的库
```

我该如何解决这个问题？我没有安装任何 WinPcap 开发者包；但我确实安装了 Wireshark。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T17:37:11.233

CPAN 安装诊断非常清楚地解释了您的问题

> 您似乎缺少 WinPcap 开发人员包

他们还告诉您从哪里下载它们

> [或者从http://www.winpcap.org/devel.htm](http://www.winpcap.org/devel.htm)获取并安装 WinPcap 开发者包

# .net - 这是 WPF 数据网格错误吗？

> ID：11565875
> 
> 赞同：5
> 
> 时间：2012-07-19T17:06:52.073
> 
> 标签：.net, wpf, datagrid

我有以下概念证明：

XAML 窗口：

```
<Window x:Class="WpfApplication1.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow" Height="350" Width="525">

<DataGrid ItemsSource="{Binding Items}" AutoGenerateColumns="False" >
    <DataGrid.Columns>
        <DataGridTextColumn Binding="{Binding Name}" />
        <DataGridTemplateColumn >
            <DataGridTemplateColumn.CellTemplate>
                <DataTemplate>
                    <CheckBox IsChecked="{Binding Mode=TwoWay, Path=Enabled}" />
                </DataTemplate>
            </DataGridTemplateColumn.CellTemplate>
        </DataGridTemplateColumn>
    </DataGrid.Columns>
</DataGrid>
</Window> 
```

后面的代码：

```
using System.Collections.ObjectModel;
using System.Windows;

namespace WpfApplication1
{
public partial class MainWindow : Window
{
    public ObservableCollection<Data> Items { get; private set; }

    public MainWindow()
    {
        InitializeComponent();
        this.Items = new ObservableCollection<Data>();
        this.DataContext = this;
        for (int index = 0; index < 30; index++)
        {
            this.Items.Add(new Data() {Enabled = true });   
        }
    }
}

public class Data
{
    public bool Enabled { get; set; }
}
} 
```

执行应用程序，取消选中顶部的一些框，向下滚动，再次更改一些框并向上滚动。瞧，复选框再次被选中！

我是否遗漏了什么，或者我应该向 Microsoft 填写一个错误？

**编辑**：感谢您的回复，但它与 INotify 或复选框无关，TextBox 和 INotify 也会发生同样的情况。滚动后您不需要单击复选框，只需取消选中一些，向下滚动，向上滚动并瞧，它们会再次被选中。检查此代码：

```
<DataGrid ItemsSource="{Binding Items}" AutoGenerateColumns="False" >
    <DataGrid.Columns>
        <DataGridTemplateColumn >
            <DataGridTemplateColumn.CellTemplate>
                <DataTemplate>
                    <StackPanel Orientation="Horizontal">
                        <CheckBox IsChecked="{Binding Mode=TwoWay, Path=Enabled}" />
                        <TextBox Text="{Binding Text}" />
                    </StackPanel>
                </DataTemplate>
            </DataGridTemplateColumn.CellTemplate>
        </DataGridTemplateColumn>
    </DataGrid.Columns>
</DataGrid>
</Window> 
```

以及背后的代码：

```
using System.Collections.ObjectModel;
using System.ComponentModel;
using System.Windows;

namespace WpfApplication1
{
public partial class MainWindow : Window
{
    public ObservableCollection<Data> Items { get; private set; }

    public MainWindow()
    {
        InitializeComponent();
        this.Items = new ObservableCollection<Data>();
        this.DataContext = this;
        for (int index = 0; index < 30; index++)
        {
            this.Items.Add(new Data() { Enabled = true, Text = index.ToString() });
        }
    }
}

public class Data : INotifyPropertyChanged
{
    private bool _enabled;
    public bool Enabled
    {
        get { return _enabled; }
        set
        {
            if (value != _enabled)
            {
                _enabled = value;
                this.OnPropertyChanged("Enabled");
            }
        }
    }

    private string _text;
    public string Text
    {
        get { return _text; }
        set
        {
            if (value != _text)
            {
                _text = value;
                this.OnPropertyChanged("Text");
            }
        }
    }

    #region INotifyPropertyChanged Members

    public event PropertyChangedEventHandler PropertyChanged;

    protected virtual void OnPropertyChanged(string name)
    {
        if (this.PropertyChanged != null)
        {
            this.PropertyChanged(this, new PropertyChangedEventArgs(name));
        }
    }

    #endregion
}
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-20T12:52:10.177

此问题与回收无关。事实上，禁用回收隐藏了真正的问题：您的`Data`对象属性永远不会更新。尝试在`Enabled`or`Text`设置器中设置断点，您会发现当您更改文本或选中/取消选中该框时不会发生任何事情。当您滚动并向后滚动时，会从对象中重新读取该属性，并且由于它没有更改，因此复选框会正确更新以匹配该`Enabled`属性。

A`DataGrid`意味着默认情况下所有行都处于显示模式，用户在需要时切换到当前选定行的编辑模式。在用户验证整行之前，不会提交这些值。

在幕后，[`BindingGroup`](http://msdn.microsoft.com/en-us/library/system.windows.data.bindinggroup.aspx)为整行创建了一个隐式，有效地将所有绑定设置为[`UpdateSourceTrigger.Explicit`](http://msdn.microsoft.com/en-us/library/system.windows.data.updatesourcetrigger.aspx). 当用户完成对行的编辑时，将提交此绑定组。在您的情况下，由于没有`BeginEdit`，因此不会有任何`CommitEdit`值，并且这些值将永远不会更新。

您在这里有几种解决方案：

*   使用另一个没有这种“切换到编辑模式”行为的控件，例如`ListView`.
*   在每个绑定上强制使用`UpdateSourceTrigger`to`PropertyChanged`或。`LostFocus`
*   更改用户使用网格的方式以符合`DataGrid`行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-20T12:15:58.133

Finally I've entered a defect at Microsoft because this is not the expected way of working wherever or not VirtualRows are used.

Bug report [here](https://connect.microsoft.com/VisualStudio/feedback/details/754753/wrong-data-in-wpf-datagrid-when-using-enablerowvirtualization-and-datagridtemplatecolumns)

# sql - SQL Server 的以下 sql 查询有什么区别？

> ID：11565879
> 
> 赞同：0
> 
> 时间：2012-07-19T17:06:57.247
> 
> 标签：sql, sql-server

> **可能重复：**
> [SQL Server NOLOCK 关键字](https://stackoverflow.com/questions/2107314/sql-server-nolock-keyword)

这些sql查询有什么区别？

1.  SQL查询：

    ```
    SELECT 
    U.ID_USER AS ID,
    U.USERNAME AS NICK,
    U.PASSWORD AS PASS
    FROM T_USERS AS U WITH (NOLOCK) 
    ```

2.  SQL查询：

    ```
    SELECT 
    U.ID_USER AS ID,
    U.USERNAME AS NICK,
    U.PASSWORD AS PASS
    FROM T_USERS AS U 
    ```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T17:11:41.763

即使它正在读取的数据被排他地锁定并且可以返回尚未提交的行，第一个（不带锁的查询）也不会被阻止。如果读取未提交的数据没有问题，则通常使用 NOLOCK 来减少阻塞。Nolock 指定在读取数据时不要尝试对表、行、页等资源进行锁定。

如果任何行正在修改或被独占锁定，第二个（不带锁的查询）将被阻止。它永远不会读取尚未提交的数据，因为它将被正在更改数据的进程阻止。这通常是当您不想读取未提交的数据并且准确性至关重要时。

# git - 如何将 git 存储库从 github 移动到运行 gitolite 的本地服务器

> ID：11565882
> 
> 赞同：4
> 
> 时间：2012-07-19T17:07:08.120
> 
> 标签：git, gitolite

我想知道将我目前托管在 github 上的所有 git 存储库移动到基于 gitolite 的新 git 服务器的更好方法。

只是为了知道，我这样做的原因是采用 Redmine 来支持我们的项目管理流程。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-19T17:41:51.243

在 gitolite-admin/conf/gitolite.conf 中添加新的仓库

```
repo my-new-repo
    RW+            = your-user 
```

添加、提交并将更改推送到 gitolite-admin

```
git add conf/gitolite.conf
git commit -m "Added my-new-repo"
git push origin 
```

克隆你的 github repo 并检查所有存在的分支

```
git clone github.com:/USERNAME/YOUR_REPO.git
cd YOUR_REPO
for branch in `git branch -a | grep remotes | grep -v HEAD | grep -v master`; do     git branch --track ${branch##*/} $branch; done 
```

移除 github 遥控器，并添加您的 gitolite 遥控器：

```
git remote rm origin
git remote add origin YOURSERVER:my-new-repo.git 
```

将所有 refs 推送到 gitolite 管理的 repo 上：

```
git push --all origin 
```

我验证了我的测试存储库中的步骤，并且所有参考似乎都传播到了新的存储库中。

**更新：**就像 Seth 指出的那样，除了分支之外的任何其他参考都不会传播到新的 repo。我也觉得**镜子**会是一个更好的选择。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-19T17:26:59.630

参考这个： http: [//gitolite.com/gitolite/basic-admin/#appendix-1-bringing-existing-repos-into-gitolite](http://gitolite.com/gitolite/basic-admin/#appendix-1-bringing-existing-repos-into-gitolite)。怎么样：

1.  在 gitolite 服务器上，使用以下命令制作 github 存储库的镜像`git clone --mirror <github git repo path>`
2.  将镜像仓库移动到上面链接中的正确位置，然后按照**将现有仓库移动到指南的 gitolite**部分进行操作？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-19T17:19:34.543

我能想到的最好的事情是拉一个本地副本，将源更改为新服务器，然后推送：

```
git pull --all
git remote rm origin
git remote add origin <new repo address>
git push --all --repo=origin 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-22T14:53:30.250

也许您还想将标签带到新服务器。这可以通过

```
 git push --tags 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-16T13:11:46.530

要将 GitHub 存储库镜像到 Gitolite，首先在 Gitolite 上创建一个新存储库（使用存储`gitolite-admin`库 - 我假设 Gitolite 管理员知道如何执行此操作），但这里有一个示例配置条目：

```
repo github/<gh-user>/<gh-repo>
desc = "Repository description [https://github.com/<gh-user>/<gh-repo>]"
owner = "My Name"
category = "GitHub"
RW+ = my_key 
```

`<gh-user>`GitHub 用户在哪里，`<gh-repo>`被镜像的 GitHub 存储库在哪里。此示例将镜像放置在 GitHub 和用户子目录中，但您可以使用任何`repo`适合的路径。

然后，从可以访问 GitHub 和 Gitolite 的任何地方：

```
$ git clone --mirror https://github.com/<gh-user>/<gh-repo>
$ cd <gh-repo>.git
$ git push --mirror gitolite git@git:github/<gh-user>/<gh-repo>
$ cd ..
$ rm -rf <gh-repo>.git 
```

`git@git`用于连接 Gitolite 的 SSH 用户和主机名在哪里。本地克隆是临时的，之后会被删除。

OP 仅询问有关移动存储库的问题，在这种情况下，他可能会停在这里。但是，如果希望在 GitHub 上托管一个 repo 的本地镜像并定期同步本地镜像，那么这里有一种方法可以做到这一点。

要将 Gitolite 镜像与 GitHub 同步，请以 Gitolite admin ( `git`) 用户身份登录 Gitolite 服务器并执行以下配置：

```
$ cd ~git/repositories/github/<gh-user>/<gh-repo>
$ git remote add origin https://github.com/<gh-user>/<gh-repo>
$ git config remote.origin.fetch "+*:*" 
```

命令中的参数在[这里](https://stackoverflow.com/a/33461528/712506)解释清楚。

然后，同步 repo：

```
$ git fetch --prune 
```

提取可以通过`cron`作业自动化。

# c++ - 用函数构造 std::thread

> ID：11565886
> 
> 赞同：1
> 
> 时间：2012-07-19T17:07:15.833
> 
> 标签：c++, multithreading, visual-c++, c++11, visual-studio-2012

这有效：

```
 std::thread t = std::thread(printf, "%d", 1); 
```

这不起作用：

```
t2 = std::thread(my_thread_func , std::ref(context)); 
```

或者

```
std::thread t1 = std::thread(my_thread_func , context_add); 
```

my_thread_func 定义：

```
int my_thread_func(long long *context_add) 
```

context 是一些结构 .. 我正在尝试“通过引用”

错误：

```
function call missing argument list;

error C2661: 'std::thread::thread' : no overloaded function takes 2 arguments 
```

*>>> 编辑 <<<*

很抱歉混淆......实际上我在 MainPage 的公共定义 my_thread_func，所以我不能使用本机类型，因此我认为值得长时间尝试并给它地址。

```
/* test data types, context for thread function, in .cpp (not in namespace) */
typedef struct _test_context
{
    HANDLE hHandle;
    unsigned int flag;
}test_context_t;

test_context_t *context;
//Do something with its member
context_add = (long long *)context;
std::thread t2 = std::thread(sem_waiting_thread, context_add); 
```

错误：

```
error C3867: 'App1::MainPage::my_thread_func': function call missing argument list; use '&App1::MainPage::my_thread_func' to create a pointer to member
error C2661: 'std::thread::thread' : no overloaded function takes 2 arguments 
```

我的命名空间看起来像：

```
namespace App1
{
    public ref class MainPage sealed
    {
   public:
    MainPage();
       public:
           MainPage();
           int my_thread_func(long long cotext);
      ..
    };
} 
```

*<<<< EDIT 2 >>>* 我现在很好奇.. 这个简单的也行不通！

```
void f1(int n)
{
    for(int i=0; i<5; ++i) {
        // Print n
        std::this_thread::sleep_for(std::chrono::milliseconds(10));
    }
} 
.
.
.

int n=0;
std::thread t2(f1, n+1); (//This didn't work,same error!)

.
.
.
but this worked!
std::thread t2;
.
.
.
t2= std::thread (f1, n+1); 
```

从这里尝试：[http ://en.cppreference.com/w/cpp/thread/thread/thread](http://en.cppreference.com/w/cpp/thread/thread/thread)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T17:09:59.617

最好将您的功能定义为：

```
int my_thread_func(context& ctx); 
```

然后，您将能够传递对 a 的引用`context`。如果该函数不应该修改，`context`那么最好使用：

```
int my_thread_func(const context& ctx); 
```

然后你可以像这样创建线程：

```
test_context_t context;
/* ... */
std::thread t = std::thread(my_thread_func , std::ref(context)); 
```

从您的代码看来，您有一个指向`context`. 您可能想重新考虑这一点，并像我上面那样使用一个对象实例。如果上下文作为指针传递给函数，您可能也希望将该指针更改为引用。但是，如果这不可能（或不可取），那么您仍然可以通过执行以下操作来创建线程：

```
test_context_t* context;
/* ... */
std::thread t = std::thread(my_thread_func , std::ref(*context)); 
```

或者，您可以只使用普通指针：

```
int my_thread_func(context* ctx); // notice the different function's signature

test_context_t* context;
/* ... */
std::thread t = std::thread(my_thread_func , context); 
```

# cocos2d-iphone - Cocos2D 2.0 - 试图用图层和精灵来理解这个难题

> ID：11565889
> 
> 赞同：0
> 
> 时间：2012-07-19T17:07:40.190
> 
> 标签：cocos2d-iphone

考虑一下：您在 Cocos2D 2.0 上创建了一个新项目。您拥有传统的 Helloworld 层。您使用以下结构向其添加层：

```
Helloworld (cclayer)
   │
   ┕━ baseLayer (cclayer)
        │
        ┕━ myReducedNode [CCSprite node]
              │
              ┕━ myFullSprite (ccsprite)
                    │
                    ┕━ smallSprite (ccsprite) 
```

*   myReducedNode 是 baseLayer 中的一个节点，使用 [CCSprite 节点] 创建并应用了比例尺，因此，当我应用该比例尺时，我同时减少了 myFullSprite 和所有 smallSprites。
*   myFullSprite 是 myReducedNode 内的 1024x768 点精灵。
*   smallSprites 是 myFullSprite 中的 230x348 点精灵。

考虑一下这种疯狂：

*   首先，我将 1 的比例应用于 myReducedNode。当我拖动 smallSprite 并检查它的坐标时，一切都很好。如果我将 smallSprite 定位在 myFullSprite 的左上角，我将 smallSprite 的中心坐标读取为 (115,594)，这是正确的值。
*   我将 0.8 比例应用于 myReducedNode。将 smallSprite 拖到 myFullSprite 的左上角，cocos 现在报告 smallSprite 的中心为 (17,641) ?????????!!!!!!

我说的是局部坐标，我的意思是，smallSprite 的位置在 myFullSprite 内部。

这是什么原因造成的？这个数字没有明显的逻辑......这个数字与应用于顶部节点的比例无关。

我在这里想念什么？我在墙上敲了几天的头，试图弄清楚这个谜题！！！！谢谢。

* * *

更多信息。我希望这有助于弄清楚为什么坐标有这些值......

*   baseLayer 在 Helloworld 上的位置是 (612, 389)。
*   myReducedNode 在 baseLayer 上的位置是 (0,0)。
*   myFullSprite 在 myReducedNode 上的位置是 (0,0)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T17:29:24.263

我认为您应该看一下`convertToWorldSpace:`，因为您正在缩放和嵌套事物，所以转换很可能适用于这些坐标。

在这里你有一个可能有用的[问题](https://stackoverflow.com/questions/5045115/cocos2d-converttoworldspace)和 cocos2d上的这篇[文章](http://www.cocos2d-iphone.org/forum/topic/507)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T01:24:30.663

试试这个：

```
CGPoint smallSpriteLocalPosition;
smallSpriteLocalPosition = 
[smallSprite.parent convertToNodeSpace:smallSprite.position]; 
```

然后打印出这些坐标，看看它们是否正确注册。这应该为您提供 smallSprite 相对于其父级 fullSprite 的节点（本地）坐标。您还应该能够 convertToWorldSpace 以获取窗口范围内的坐标。

这就是过去在处理子精灵时对我有用的方法；这可能有点棘手。确保在转换调用中使用正确的变量，否则您将无法获得正确的数据。让我知道这是否有效，因为我还没有尝试过三层深的层。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-21T17:35:32.787

经过一些代码更改和几天的研究和尝试，我得出结论这是 Cocos2D 的一个错误，或者层、精灵和节点的工作方式之间缺乏一致性（正如 LearnCocos2d 所建议的那样），因为没有办法解释获得的值。我将尝试对此填写错误报告。

# php - 如何减少社交网络元素的加载时间？

> ID：11565890
> 
> 赞同：0
> 
> 时间：2012-07-19T17:07:40.520
> 
> 标签：php, facebook, facebook-graph-api, facebook-like

我的网站每页有 10 篇文章，每篇文章都有 facebook 喜欢、tweet 和 google+ 按钮，并且在侧边栏中它有 facebook 喜欢和订阅按钮。这些社交元素需要更多时间并增加我的网站加载时间。请给出你的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T03:31:03.313

您要做的是使用 XFBML 标记，使用 调用`FB.init`，`xfbml: false`然后*在*页面加载后调用`FB.XFBML.parse()`. 这将有效地推迟 Facebook 插件的加载，直到您的页面完成。

现在，如果您想要更早地渲染其中的一些，那么您可以将父节点传递给`parse`并且只渲染这些。

或者，将 all.js 的引用放在 DOM 的底部，并确保使用异步模式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T17:12:59.487

您对此无能为力...社交插件的加载时间大约等于（facebook示例）：您的页面加载+ Facebook调用和应答时间+ facebook库解析您的页面

所以你什么都做不了，因为你依赖于第三方......

我知道提高加载性能的唯一方法是使用如下所述的频道网址：http: [//developers.facebook.com/docs/reference/javascript/FB.init/](http://developers.facebook.com/docs/reference/javascript/FB.init/)

# excel - 将每个单元格的名称设置为其内容/值

> ID：11565893
> 
> 赞同：3
> 
> 时间：2012-07-19T17:07:55.020
> 
> 标签：excel, vba, loops, range

我想创建一个宏来选择矩形范围的单元格并将每个单元格的名称设置为单元格的值/内容。

就我到目前为止的想法而言，尽管 cell.Name 行出现了错误。

```
Public Sub NameCell()
Dim rng As Range
Dim cell As Range
Set rng = Range("A1:D1")
For Each cell In rng
    cell.Name = CStr(cell.Value)
Next
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T20:46:34.993

我相信这可能对你有用，除非我也误解了这个问题。

```
Dim r As Range
Dim cell As Range

Set r = Sheet1.UsedRange

For Each cell In r
    Sheet1.Names.Add Name:=cell.Value, RefersTo:=cell
Next 
```

但请记住，您需要检查`cell.Value`命名范围的 是否有效（无空格等）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T17:26:05.587

这是你的意思吗？

```
Sub setVal()
    Range("A1:C6").Select
    Selection = "value"
End Sub 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-19T17:23:21.670

要将一系列单元格替换为其值（从该范围内删除任何公式），您将使用类似这样的东西。

```
Public Sub NameCell()
    Dim rng As Range
    Set rng = Range("A1:D1")
    rng.Value = rng.Value
End Sub 
```

# c# - 实现 DependencyObject 和 INotifyPropertyChanged

> ID：11565898
> 
> 赞同：1
> 
> 时间：2012-07-19T17:08:29.403
> 
> 标签：c#, .net, wpf, xaml

我有一个依赖对象，它定义了一个名为“Renderer”的单一依赖属性。

```
public class Renderer {
  public string ResourceKey{get; set;}
  public string[] Params{get; set;}
}

public class CellInfo : DependencyObject {
  public static readonly DependencyProperty RendererProperty=
  DependencyProperty.Register("Renderer", typeof(Renderer), typeof(CellInfo), null);

  public Renderer Renderer {
    get { return (Renderer)GetValue(RendererProperty); }
    set { SetValue(RendererProperty, value); }
  }

  public void UpdateRenderer(string resourceKey, params string[] parameters) {
    this.Renderer.ResourceKey = resourceKey;
    this.Renderer.Params = parameters;
    //force refresh - this does not work
    Renderer tmp = this.Renderer;
    this.Renderer = null;
    this.Renderer = tmp;
  }
} 
```

在 XAML 中，我这样声明：

```
<local: CellInfo x:key="cellInfo" /> 
```

再往下，我像这样绑定到它：

```
 <ControlTemplate x:Key="MyDisplayTemplate" >
    <TextBlock VerticalAlignment="Center" HorizontalAlignment="Stretch"  >
  <TextBlock.Text>
    <MultiBinding Converter="{StaticResource MyConverter}" >
      <Binding Path="Value" />
      <Binding Source="{StaticResource cellInfo}" Path="Renderer"/>
    </MultiBinding>
  </TextBlock.Text>
    </TextBlock>
</ControlTemplate> 
```

上述控件模板用作网格单元格的显示模板。`INotifyPropertyChanged` 出于性能原因，我想在此处使用依赖对象/属性，因为据我所知，它们确实具有性能和内存资源优势。

我遇到的问题是，当 Renderer 对象的数据发生更改时，要触发单元格的更新。在代码中，我试图绕过这样一个事实，即如果值相同，则依赖属性不会触发更新，方法是首先设置为 null，然后设置回原始属性值。这不起作用。

我唯一能够开始工作的就是让对象实现并在setter中`INotifyPropertyChanged`触发`PropertyChanged`事件。`CellInfo.Renderer`

我的猜测是必须实现`INotifyPropertyChange`否定 using only 的性能优势，对`DependencyObjects`吗？在这一点上，如果我被迫实施`INotifyPropertyChanged`，我什至不扩展`DependencyObject`，对吗？

感谢您的任何意见。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T17:15:10.173

要么换出一个实例`Renderer`而不是修改现有实例（因此你也可以让它不可变），或者让它扩展`DependencyObject`并公开依赖属性。

将属性设置为 null 并再次返回不起作用的原因是 WPF 永远不会有机会将属性“视为”为 null。您的代码在调度程序消息中运行，绑定更新将在单独的消息中发生。由于该消息直到您的消息之后才会运行，因此它永远不会看到更改。这里有一种解决方法，即在一条消息中更新为 null，然后在另一条消息中重新设置。但是，您将所有性能提升都很好地、真正地抛到了窗外。更不用说以“正确”的方式来做这件事无论如何都要容易得多。

# scala - Finagle 中服务、过滤器和编解码器之间的边界

> ID：11565906
> 
> 赞同：11
> 
> 时间：2012-07-19T17:09:01.713
> 
> 标签：scala, netty, finagle

Finagle 中使用的 Netty 使用“处理程序”管道来顺序处理输入和输出数据。Netty 示例和包含的库显示了用于身份验证、协议编解码器和服务的实际业务逻辑等各种处理程序。

Finagle 似乎采用了处理程序的概念，而是直接为 API 用户提供编解码器、过滤器和服务。虽然这些具有不同的签名，但 Finagle 的新用户需要决定使用哪个来实现其整个服务器的每个部分。他们现在需要决定哪个部分应该是编解码器的一部分，而不是任何过滤器，还是链末端的单一服务，而不是仅仅决定在哪里将链分解为各种 Netty 处理程序。总而言之，虽然 Finagle 是一个比 Netty 更高级别的库，并且应该使构建服务的任务更容易，但 API 用户可能有更多的选择。

将处理流的特定部分放入编解码器与过滤器与单一服务的关键决策点和优点/缺点是什么？如果管道有可能进一步扩展，是否应该将服务逻辑放入过滤器中，在管道末端使用“noop”服务？鉴于排序过滤器（作为管道中的处理程序）的灵活性，而不是一端的单一编解码器和另一端的服务，为什么“一切”不应该是一个过滤器？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-07-21T05:40:41.380

Finagle 和 Netty 的结构完全不同。

服务、过滤器和编解码器实际上是非常正交的概念。让我试着解释一下。作为用户——即。不是编解码器的实现者——您应该只需要了解服务和过滤器。

首先，编解码器负责将字节流转换为离散的请求或响应。例如，HTTP 编解码器读取字节流，并生成`HttpRequest`或`HttpResponse`对象。

A`Service`是一个对象，给定一个请求，它会产生`Future`一个回复——它是一个简单的函数（实际上它是 extends `Function`）。服务的有趣之处在于它们是对称的。客户端*使用*服务，服务器*提供*服务。服务的重要之处在于（1）它们对离散的请求和响应进行操作，以及（2）它们将请求与响应相匹配——所有这些都隐含在其类型中。这就是我们将 finagle 称为“RPC”系统的原因——请求/响应对是 RPC 的定义特征。

所以，我们有服务，但*独立于服务本身*修改服务行为是有用且重要的。例如，我们可能想要提供超时功能或重试。这就是我们`Filter`要做的。它们提供了一种*独立于服务*的方法来修改服务行为。这增强了模块化和重用性。例如，finagle 中的超时被实现为过滤器，并且可以应用于任何服务。

[您可以在Scala School](http://twitter.github.com/scala_school/finagle.html)中找到有关服务和过滤器的更多详细信息。

*

因此，让我们将其与 Netty 的处理程序进行对比。这些是通用事件处理程序，也是可堆叠的。您可以用它们做许多类似的事情，但底层模型是附加到连接的事件*流。*这使得编写通用模块变得更加困难（例如，实现重试、超时、故障累积、跟踪、异常报告等），因为您无法对正在使用的管道做出很多假设。

Netty 管道还将协议实现与应用程序处理程序混为一谈。Finagle 将两者完全分开，并因此增强了模块化。

Netty 是一组很棒的抽象，但是对于 RPC 服务器，finagle 提供了更大的模块化和可组合性。

*

粗略地总结一下，你可以说 Netty 是“面向流的”，而 finagle 是“面向服务的”。这是一个重要的区别，它使我们能够以模块化的方式实现健壮的 RPC 服务。例如，连接池和负载平衡（对 RPC 客户端至关重要）自然会从服务模型中分离出来，但不适合流模型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T18:22:00.030

我认为这不应该是编解码器或过滤器之间的决定。编解码器宁愿被包裹在过滤器中。

至于决策逻辑，放置它的位置将取决于必须做出的决策。业务决策应该符合您的业务逻辑，而路由、负载平衡、某些类型的访问控制等某些决策可以很好地适应过滤器。

服务通常位于线路的末端，Finagle 及其过滤器将带您到达那里。

不知道这是否有意义？

暂时离开技术细节，看看逻辑。什么应该负责什么，然后让技术适合你的设计。不要过度弯曲您的设计以适应技术。

顺便说一句，我在 Finagle 上实现了一个网关服务器，我必须说：这是一个很好的库。

我不知道您要构建什么，但也可以看看可能的替代方案：Spray、Blueeyes、Unfiltered、Play-Mini 等。它可能会帮助您更好地了解什么去哪里。

# php - 计算表中的热门行，将 ID 与 OTHER 表中的名称匹配

> ID：11565910
> 
> 赞同：0
> 
> 时间：2012-07-19T17:09:19.450
> 
> 标签：php, count

我正在尝试调用在名为 postmeta 的表中输入的 10 个最受欢迎的 post_id。

还有一个单独的表，称为帖子，它包含帖子标题、帖子内容和 ID。

我要做的是首先找出哪些 post_ids 具有最多的 postmeta 条目，然后还查询“posts”表并将 post_ids 与帖子名称匹配。我想输出与 10 个最受欢迎的 id 相关的帖子名称，然后是条目数。前任：

苹果(152)
熊(80)
馅饼(31)
橙子(12)

我对 PHP 有点陌生，不知道如何查询这两个表来得到我想要的。到目前为止，我有这个来计算：

```
global $wpdb;
$popularity = "
select post_id, count(post_id) as cnt
from $wpdb->postmeta
group by post_id
order by cnt desc
limit 10";
}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T17:14:03.893

```
$popularity = "SELECT pm.post_id, COUNT(pm.post_id) AS cnt, p.title
                FROM $wpdb->postmeta pm JOIN $wpdb->posts p
                ON pm.post_id = p.id GROUP BY pm.post_id ORDER BY cnt DESC LIMIT 10"; 
```

您没有在单独的表上提供足够的信息，所以我假设该表中的列名是`title`and `id`。

# iphone - 从 UIView 调用父方法

> ID：11565912
> 
> 赞同：1
> 
> 时间：2012-07-19T17:09:19.773
> 
> 标签：iphone, ios, xcode, ios5

（这应该很简单。但它已经让我发疯了好几个小时。）我只是想从它的 UIView 内部调用一个 ViewController 方法。

myViewController 声明并创建一个 UIView：

```
myUIView = [[viewCreator alloc] init…]; 
```

我的 myViewController 也有一个方法：

```
-(void)inABottle{
    NSLog(@"Hello.");
} 
```

在 UIView 内部，创建了一个 UIButton。这个按钮有一个方法的“选择器”——在 UIView 中——然后尝试调用 ViewController 中的“inABottle”方法。在 UIView 内部：

```
...
[myButton addTarget:self action:@selector(isPressed) forControlEvents:UIControlEventTouchUpInside];

-(void)isPressed{
    [myViewController inABottle];// <<< This is where I have spent my day.
} 
```

（ViewController 头文件是 UIView 中的 #import 。）

非常感谢一些帮助。当然这应该很简单！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T17:26:17.783

这就是协议和委托的用途。想想如何`UITableView`处理这个问题。

```
@class MyView;
@protocol MyViewDelegate
- (void)myViewIsInABottle:(MyView *)view;
@end

@interface MyView : UIView
@property (weak) id<MyViewDelegate> delegate;
@end

@implementation MyView
-(void)isPressed{
  [self.delegate myViewIsInABottle:self];
}
...
@end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T17:22:37.117

在视图中创建一个属性，并在创建时将其设置为当前视图控制器：

视图控制器.m：

```
myUIView = [[viewCreator alloc] init...];
myUIView.myViewController = self; 
```

视图.h：

```
@property (weak) ViewController *myViewController;//weak or assign depending if you are using ARC or not, and ViewController should be the class of your view controller 
```

视图.m：

```
@synthesize myViewController; 
```

然后就像在问题中的代码中一样调用该方法。

您还应该研究如何使用委托，这是您何时应该使用委托的完美示例。

# java - 编译和解释之间的技术混淆

> ID：11565917
> 
> 赞同：7
> 
> 时间：2012-07-19T17:09:41.557
> 
> 标签：java, compilation, interpretation

我已经阅读了许多关于“解释”和“编译”的定义和陈述。但我仍然很困惑。

从技术上讲，解释和编译之间的真正区别是什么？让我详细说明（请纠正我可能有的任何错误概念）：

在java中，源代码被“编译”成字节码，然后被“解释”和/或“即时编译”成机器码。但是及时编译和解释之间有什么区别？我的意思是，最后，据我猜测，主机的 CPU 将只运行机器代码。因此，在解释中，指令也被转换为 CPU 可以理解的机器代码。那么，我们在哪里划定即时编译和解释之间的界限呢？

PS这是我的想法。这可能是完全错误的。在那种情况下，请原谅我的愚蠢并纠正我。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T17:17:23.917

*编译*代码时，生成的工件可以直接被硬件理解。基本上它是直接发送到 CPU 的机器代码。这也意味着针对给定 CPU 架构编译的工件不会在另一个上运行。优点是立即启动和出色的性能。

在*解释*环境中，要么根本没有编译，要么此步骤的结果是中间代码。该代码是直接发送到处理单元的两个摘要。相反，需要一个单独的层（虚拟机、解释器）来读取此工件并在某些沙盒环境中执行它。这种方法的优点是可移植性——中间代码可以在任何有本地解释器的平台上运行。不幸的是，性能几乎总是更差。

Java 中的 JIT 是一种混合技术。第一个字节码被*解释*，每个字节码指令由解释器执行。然而，在某个时间点（在某些条件下）字节码会被翻译成机器码并直接发送到 CPU 以提高性能。这种方法带来了两全其美 - 中间代码的可移植性和本机代码的速度。此外，JIT 对代码的运行时行为了解得更多（给定循环平均被调用多少次？这个方法真的是虚拟的吗？），所以机器代码可以比普通编译器生成的更快（！ )

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-19T17:26:56.480

**1.**坦率地说，**java同时具有编译器和解释器的想法是一个神话**，它的**行为被标记**为编译器和解释器。

**2\. Java 编译器**将人类可读的代码编译成字节码。然后在运行时由**JIT（即时编译器）**将其转换为机器级可执行代码。

**3.**在运行时 JIT 识别代码的运行时密集部分，然后将其转换为机器级可执行代码，**这部分代码**被称为`Hot-Spot`，这就是为什么**JIT 被称为 Hot-Spot 编译器**。

**4.** JIT uses the **Virtual Memory Table** ( V-table), **which is a pointer to the method in the class**. **The Hot-Spot code is then converted to its machine level executable code, its address is stored here, and when this part is called again, then its directly fetched by this stored address**. `This behavior of JIT to keep compiling small amount of code during Run time is assumed to be` **Interpreted Behavior**, And `the JIT behaviour of storing this for later use is assumed as` **Compilation**.

**5.** Virtual Memory Table also has a table which stores the address of the byte code, which can be used if needed.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T17:16:25.320

没错，最终一切都必须转换为机器代码。基本区别在于，在解释器的情况下，每次代码运行时都会发生这种翻译，而编译器会提前进行这种翻译，之后编译器就不需要运行程序了。

即时编译是两者的结合，运行程序仍需要 JIT 编译器，并且代码在运行时编译。

编译需要时间，但是当同一段代码运行多次时它是有利的，例如。在一个循环中。Java HotSpot VM 进一步采用了这种方法，最初直接解释字节码，然后在一段代码运行一定次数后对其进行 JIT 编译。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-19T17:16:49.677

解释器逐行解释代码，并在运行时决定机器码；

编译器按块消费代码，并在编译时决定机器码；

JIT 编译器是一种混合方法，其中代码在运行时生成（但可能已经被缓存以提高性能），但以块的形式使用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-19T17:16:49.720

**解释环境**涉及在解析后立即执行的指令，其中解析和执行均由解释器完成。这意味着您运行代码的机器必须具有解释器才能运行程序。[¹](http://www.dsbscience.com/freepubs/start_programming/node6.html)

**编译器**会将指令解析为机器代码并存储它们以供以后执行。然而，Java 是字节编译的[²](http://en.wikipedia.org/wiki/Java_bytecode)，这意味着该过程将指令转换为字节码，然后由解释器使用。

# macos - 如何使用 Valgrind 在 Mac OS X 中查找进程的 CPU 和内存使用情况？

> ID：11565924
> 
> 赞同：0
> 
> 时间：2012-07-19T17:09:58.723
> 
> 标签：macos, memory-management, valgrind, cpu-usage

Valgrind 中是否有特定工具可用于查找给定进程的 CPU 和内存使用情况？我浏览了[http://valgrind.org/docs/manual/manual.html](http://valgrind.org/docs/manual/manual.html)中给出的工具。只是不确定用于 CPU 和内存分析的工具。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T17:13:51.497

使用 massif 工具获取内存使用信息。我不确定您所说的“CPU 使用率”是什么意思，您到底想分析什么？如果您想知道您有多少 chache-hits/misses，那么 cachegrind 是适合您的工具。

# c# - 如何从电子表格中删除过滤的数据？

> ID：11565928
> 
> 赞同：2
> 
> 时间：2012-07-19T17:10:06.337
> 
> 标签：c#, excel, range

只是我一直在做的事情一直困扰着我，我不禁想到其他人会为我指出一个简单的解决方案。

我正在编写的程序的一部分涉及以下内容：

我有一个 C# 程序，它使用自动排序将一系列过滤器应用于电子表格。我想删除已排序的数据，目前它使用特殊单元格，但我认为我的方法并不出色。

在删除数据之前，我删除了第一行，即我的标题，以便不将其包含在删除中。但是，这可能会导致问题，如果我删除标题并且过滤后的数据实际上返回的行数不超过 0 行，那么当我调用我的特殊单元格来删除它时，它将标记某种错误，说明没有范围。什么是最好的解决方案，理想情况下我可以抓取过滤范围并检查数据是否超过 1 行，但我一直在尝试的属性（如 rows.count）标记了错误类型的数据。这是我的代码的简化版本

```
Excel.Range AllRange = mySheet.UsedRange;
Excel.Range filtered = AllRange.SpecialCells(Microsoft.Office.Interop.Excel.XlCellType.xlCellTypeVisible, Type.Missing);

if (//SOME SORT OF COUNT SHOULD GO HERE IM GUESSING > 1)
{
 mySheet.Rows.EntireRow[1].Hidden = true;
 filtered = mySheet.UsedRange.SpecialCells(Microsoft.Office.Interop.Excel.XlCellType.xlCellTypeVisible, Type.Missing);

filtered.EntireRow.Delete(Excel.XlDirection.xlUp);
mySheet.Rows.EntireRow[1].Hidden = false;       
} 
```

类似的东西，希望对你有帮助。感谢您就此事提供任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T16:36:36.737

我找到了一个可行的解决方案。基本上你想参加`Areas.Count`.

```
Excel.Range AllRange = mySheet.UsedRange;
Excel.Range filtered = AllRange.SpecialCells(Microsoft.Office.Interop.Excel.XlCellType.xlCellTypeVisible, Type.Missing);

long colstuff = filtered.Areas.Count;

if (colstuff > 1)
{
  mySheet.Rows.EntireRow[1].Hidden = true;
  filtered = mySheet.UsedRange.SpecialCells(Microsoft.Office.Interop.Excel.XlCellType.xlCellTypeVisible, Type.Missing);

  filtered.EntireRow.Delete(Excel.XlDirection.xlUp);
  mySheet.Rows.EntireRow[1].Hidden = false;   
} 
```

# jquery - 相对于窗口大小调整两个 DIV 的大小

> ID：11565929
> 
> 赞同：0
> 
> 时间：2012-07-19T17:10:16.267
> 
> 标签：jquery

每当用户像这样调整浏览器的大小时，我目前都有一个 DIV 调整到窗口的完整高度：

```
$(window).resize(function() {
    $("#selected-folders-area").height($(window).height()-350);
}); 
```

**注意：**`-350`标题内容的帐户

我想在这个页面上添加第二个 DIV，当浏览器调整大小时，两个 DIV 需要共享窗口的大小，用它们自己的高度填充到窗口底部。

我不确定我是否足够清楚，所以如果您需要我扩展，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T17:13:42.183

这有什么问题？

```
$(window).resize(function() {
    var h = $(window).height()-350;
    $("#div1,#div2").height(h/2);
}); 
```

请注意，如果您想要与内容成比例地调整大小......嗯......这是布局表格难以击败的情况之一。

你可以有不同的尺寸，像这样：

```
$(window).resize(function() {
    var h = $(window).height()-350;
    $("#div1").height(h*0.45);
    $("#div2").height(h*(1-0.45));
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T17:23:35.320

```
$(window).resize(function() {
    var availableHeight = $(window).height()-350;
    var usedHeight = $('#div1').outerHeight() + $('#div2').outerHeight();
    var remainingHeight = availableHeight - usedHeight;
    //distribute remaing height to the divs as you like,this is 50/50
    //note that hight will decrease if it takes more than widow height already
    //if dont want that add your condition
    $("#div1,#div2").each(function(){
        $(this).height($(this).height() + remainingHeight/2);
        });

}); 
```

# java - 如何使用 Swing 创建拖放组件 GUI 构建器？

> ID：11565930
> 
> 赞同：0
> 
> 时间：2012-07-19T17:10:18.527
> 
> 标签：java, swing, drag-and-drop, gui-builder

我想开发一个程序来创建 Swing 应用程序，并并排创建其 Java 源代码（例如，将一个按钮拖放到要创建源代码的框架上）。

1.  需要多少时间？
2.  我应该使用 JInternalFrame 还是简单的 Frame？
3.  我应该如何生成源代码？拖放组件时如何将代码放入 .java 文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T17:21:03.357

您可以使用诸如[GMF 之](http://www.eclipse.org/modeling/gmp/)类的东西来创建生成代码的图形编辑器。从头开始构建这样的东西需要几个月或几年的时间，这取决于你的技能水平和你需要的范围。

# java - 如何在 ADF 表单中重置 inputFile 控件？

> ID：11565935
> 
> 赞同：0
> 
> 时间：2012-07-19T17:10:45.047
> 
> 标签：java, jdeveloper, oracle-adf

我的 ADF 表单工作正常，除了一个奇怪的缓存问题。我有一个不使用数据库的 ADF 表单。它有一个输入文件字段，用户可以选择电子表格。当他们单击处理文件按钮时，它会读取电子表格，进行一些数据操作并写入一个固定文件。当他们点击处理文件按钮时，包含文件名的文本框基本上变成了一个标签，没有显示任何框，它显示了他们上传的文件的名称。当我关闭浏览器并重新打开它时，页面会返回，最后选择的文件仍显示在标签中。我还注意到，在程序开始时初始化为零的全局变量（在类内）的值从它在第一次测试结束时的最后一个值开始。在浏览器中多次刷新页面并没有重置页面。为什么会这样？我认为如果再次打开页面时关闭浏览器，它应该重新开始。我通过在程序中进一步设置为零来解决全局变量的问题，但我无法将文件名值设置为空。似乎在单击按钮之前它不会生效。我应该做一些刷新吗？我尝试使用 Java 刷新整个页面，但这似乎不起作用。在单击按钮之前生效。我应该做一些刷新吗？我尝试使用 Java 刷新整个页面，但这似乎不起作用。在单击按钮之前生效。我应该做一些刷新吗？我尝试使用 Java 刷新整个页面，但这似乎不起作用。

我还应该提到我使用的是 Internet Explorer 浏览器，当我在之前没有调出页面的不同浏览器 Chrome 中尝试它时，它仍然选择了文件。似乎只有在我重新部署应用程序时才会重新开始。

我正在使用 jDeveloper 11.1.1.4。（也使用 11.1.1.6 尝试过）Weblogic 服务器是 10.3.6。我可以告诉你，我检查了 weblogic-application.xml 文件中的会话选项卡。唯一检查的是 Enable SessionTracking 和 Enable URL Rewriting for Session Tracking。内存中的会话是无限的。在 Cookies 下，选中启用 cookie 和启用 cookie 的 HTTP 代理缓存。在 Cookie 生命周期下，选择了 Cookies never expire。不过，我没有设置任何 cookie，除非这是在幕后做某事。持久存储设置为内存。

其他一切都是空白的。我尝试取消选中启用会话跟踪和启用 URL 重写和重新部署，但页面只是挂起并且根本无法加载。

所以，这就是我所在的地方。我一直在尝试寻找一种方法来重置 inputFile 对象，但到目前为止还没有运气。我是 ADF 和 Java 的新手，所以请考虑到这一点提出任何建议，我可能需要更多细节。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-23T06:31:11.767

假设您没有将 inputFile 组件的 value 属性显式绑定到托管 bean 属性，您只需在组件实例上调用 resetValue() 即可。

1.  在 request 或 backingBeanScope 中创建托管 bean
2.  使用 af:inputFile 组件“绑定”属性创建对此 bean 的引用（JSF 组件引用）
3.  有一个命令按钮或事件，您可以监听以访问组件引用并在其上调用 resetValue()

以上使其工作。现在，让我们对其进行润色：

在 JSF 开发人员中，不推荐使用支持 bean 和组件绑定，而是首选动态组件查找。所以你可以跳过第 3 步，直接使用 FacesContext.getCurrentInstance().getViewRoot().findComponent('id_of_inputFileComp'); 获取 RichInputFile 实例的句柄。这种方法的棘手之处在于您需要注意命名容器。

坦率

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-12-14T18:57:29.333

您可以在 inputFile 的 valueChageListener (ValueChangeEvent vce) 中使用以下行：

```
oracle.adf.view.rich.util.ResetUtils
ResetUtils.reset(vce.getComponent()) 
```

Jdeveloper 版本 12.1.3

# haskell - 将单子线组合成更一般的东西

> ID：11565936
> 
> 赞同：1
> 
> 时间：2012-07-19T17:10:57.600
> 
> 标签：haskell

我正在编写一些 mysql-simple 数据库代码，并且我正在使我的数据类型成为 QueryResults 类型类的成员，以便轻松解除它们。

但我最终得到了很多功能，比如：

```
data FullName {
  first_name :: String,
  middle_name :: String,
  last_name :: String
} deriving Show

newtype UID = UID Integer deriving Show

go :: [(String, String)] -> Maybe FullName
go fvs = do
  first  <- lookup "first_name" fvs
  middle <- lookup "middle_name" fvs
  last   <- lookup "last_name" fvs
  return $ FullName first middle last

go :: [(String, String)] -> Maybe UID
go fvs = do
  uid <- lookup "uid" fvs
  return $ UID (read uid) 
```

查找只是返回的地方（也许是一个）。其中一些数据类型有十几列，所以这很乏味。

所以有很多这样的数据类型，我希望能够编写一个我会这样调用的函数：

```
go RealName ["first_name","middle_name","last_name"] fvs
go UID ["uid"] fvs 
```

但我不知道这样的事情应该是什么类型，或者我将如何去做。也许这甚至是不可能的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T17:39:20.057

使用[Template Haskell](http://www.haskell.org/ghc/docs/latest/html/users_guide/template-haskell.html)，我怀疑您最终可能会得到如下代码：

```
makeGo ''FullName 
```

扩展到

```
goFullName :: [(String, String)] -> Maybe FullName
goFullName fvs = do
  first  <- lookup "first_name" fvs
  middle <- lookup "middle_name" fvs
  last   <- lookup "last_name" fvs
  return $ FullName first middle last 
```

* * *

顺便说一句：如果你`import Control.Applicative`，`goFullName`可以写得更简洁，像这样：

```
goFullName :: [(String, String)] -> Maybe FullName
goFullName fvs
   = FullName <$> lookup "first_name" fvs
              <*> lookup "middle_name" fvs
              <*> lookup "last_name" fvs 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T17:47:44.067

我会把这个函数写成

```
import Control.Applicative

go :: [(String, String)] -> Maybe FullName
go fvs = FullName <$> l "first_name" <*> l "middle_name" <*> l "last_name"
    where l field = lookup field fvs 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T21:44:23.717

如果您的目标是最终获得`QueryResults`实例，为什么不这样做：

```
{-# LANGUAGE GeneralizedNewtypeDeriving,OverloadedStrings #-}

Module Main where

import Database.MySQL.Simple
import Database.MySQL.Simple.QueryResults
import Database.MySQL.Simple.Result
import Database.MySQL.Simple.Param

data FullName =
  FullName {
       first_name  :: String
     , middle_name :: String
     , last_name   :: String
  } deriving Show

newtype UID = UID Integer deriving (Show,Param)

instance QueryResults FullName where
  convertResults fs@[_,_,_] vs@[_,_,_] = FullName first middle last
    where [first,middle,last] = zipWith convert fs vs
  convertResults fs vs  = convertError fs vs 3

instance QueryResults UID where
  convertResults fs@[fuid] vs@[vuid] = UID (convert fuid vuid)
  convertResults fs vs  = convertError fs vs 1

uidToFullName :: UID -> IO FullName
uidToFullName (UID uid) =
  do conn <- connect defaultConnectInfo
     [fn] <- query conn
         "SELECT first_name,middle_name,last_name FROM user WHERE uid = ?" [uid]
     return fn 
```

一个示例会话：

```
λ> :load Main.sh
λ> uidToFullName (UID 23)
FullName {first_name = "John", middle_name = "Horatio", last_name = "Smith"} 
```

这是随附的 SQL：

```
CREATE TABLE user (
  uid Integer PRIMARY KEY,
  email Text,
  first_name Text,
  middle_name Text,
  last_name Text
);

INSERT INTO user VALUES (23,'john.horation@smith.com','John','Horatio','Smith'); 
```

# android - 应用程序启动时 LogCat 中的双倍日志

> ID：11565942
> 
> 赞同：0
> 
> 时间：2012-07-19T17:11:22.187
> 
> 标签：android, logcat

当我启动我的应用程序并调用每个构造函数时，我会在该构造函数中以 LogCat 形式获得双倍的日志。之后一切正常。我应该担心吗？

例如，如果我输入 onCreate 这一行：

```
Log.i("a", "42"); 
```

当我运行应用程序时，我在 LogCat 中得到类似的东西：

```
07-19 18:56:41.086: I/a(3343): 42
07-19 18:56:41.505: I/a(3343): 42 
```

如果我将任何 Log.i(...) 放在 onTouchEvent 中，则每个 touchEvent 只有一个日志。

[编辑]
我将一条记录插入数据库的行。每次我运行我的应用程序时，都会添加两条记录，所以 LogCat 运行良好，而 Android 本身就坏了。
我的 android: 2.3.5, HTC Sense 3.5, mod: Android Revolution HD 7.0.4 by mike1986 有
什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T17:49:21.397

您可以尝试重新启动 adb。“adb kill-server”然后是“adb usb”，如果那是你正在使用的。我以前见过 adb 的奇怪问题。

# mysql - 启用mysql查询日志导致错误

> ID：11565947
> 
> 赞同：2
> 
> 时间：2012-07-19T17:11:56.283
> 
> 标签：mysql

我不知道这个问题是否特定于我的设置，但是当我添加该行时

```
log = /var/log/mysql.log 
```

到复制的 my-large.cnf 文件的 mysqld 部分并尝试重新启动 mysql 服务器我收到错误

```
Starting MySQL. ERROR! The server quit without updating PID file (/var/lib/mysql/centos-server.pid). 
```

我创建了文件 /var/log/mysql.log，将其所有者和组设置为 mysql，并将 /var/log 的权限设置为 777（目前）

我在 centos 上，使用 mysql 5.6.5 m8（开发版本）。

这是 my.cnf 文件的片段

```
[mysqld]
port            = 3306
socket          = /var/lib/mysql/mysql.sock
skip-external-locking
key_buffer_size = 256M
max_allowed_packet = 1M
table_open_cache = 256
sort_buffer_size = 1M
read_buffer_size = 1M
read_rnd_buffer_size = 4M
myisam_sort_buffer_size = 64M
thread_cache_size = 8
query_cache_size= 16M
# Try number of CPU's*2 for thread_concurrency
thread_concurrency = 8
log = /var/log/mysql.log 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-20T12:06:19.283

似乎 log 指令已过时，而 my.cnf 需要该指令

```
general-log = 1 
```

如果这样指定，日志文件将在默认位置创建（在 centos 上是 /var/lib/mysql/centos-server.log）

# html - ravendb上传文件错误

> ID：11565951
> 
> 赞同：2
> 
> 时间：2012-07-19T17:12:16.643
> 
> 标签：html, asp.net-mvc, nosql, ravendb, attachment

我正在尝试将附件保存在 ravenDb 中。我收到文件未找到错误。

MVC视图：

```
 <input type="file" name="file" id="Ids2" style="float:right"/> 
```

通过 ajax 调用，我将在上述控件中选择的文件名的值传递给控制器​​方法——这反过来将文件名发送给一个名为“Upload”的自定义方法

```
public virtual string Upload(string fileName)
   {
      IDocumentSession session = GetCurrentDocumentSession();
      var id = "upload/" + randomGen();

      session.Advanced.DatabaseCommands.PutAttachment(id,null, 
                           File.ReadAllBytes(fileName), optionalMetaData);    
      return id;
   } 
```

我得到 C:\ProgramFiles (x86)....没有指定文件。让我们在视图中说 - 我浏览到 C:/Doc1.txt 并单击添加按钮，该按钮在视图中保存了一堆其他字段，还从文件上传控件中获取文件名/路径。

我在 session.advance.databasecommands... 行收到错误

> 找不到文件“C:\Program Files (x86)\Common Files\Microsoft Shared\DevServer\10.0\Doc1.txt”。

如果我手动将 Doc1.txt 文件移动到上述位置，ravenDB 会保存附件，我可以从 localhost:8080/static/upload/keyvalue 看到它

如何让 ravenDB 从用户选择的位置获取文件，而不是从它看起来像 c:programfiles 的默认位置......

编辑：

```
 function () {

var iFile = iContainer.find( '#Ids2' ).val();  

var DataToSave = {

    'Attachment' : iFile 
};

var encodedData = $.toJSON(DataToSave);

$.ajax({
    type: 'POST' ,
    url: '/AttController/Attach' ,
    data: encodedData,
    contentType: 'application/json; charset=utf-8' ,
    success: function (rc) {
        if (rc.Success) {
           // more javascript reroutes..business logic
        }
        else {

            alert(rc.Message);
        }
    },
    error: function (xhr, ajaxOptions, thrownError) {

        alert( 'Error attaching \n' + xhr.response);
    }
 });

 }; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T20:54:16.843

取决于浏览器 html 文件控件不存储文件的完整路径。如果您使用 Chrome 并调试脚本

```
var iFile = iContainer.find( '#Ids2' ).val(); 
```

将返回类似 C:\fakepath\yourfile.txt 的内容。与 IE 一样，返回完整路径。

此外，在您的 Ajax 中，您不是推送文件的字节，而是推送文件名，这意味着除非您只在网络服务器上的浏览器中运行该网站，否则文件与网络服务器位于同一位置的机会是苗条的。

如果您尝试通过 ajax 将文件上传到 MVC 控制器，我建议您使用 uploadify。

```
 $("#Ids2").uploadify(
            {
                uploader: '/AttController/Attach',
                swf: 'your/path/to/uploadify.swf',
                cancelImg: 'your/path/to/cancel.jpg',
                buttonText: 'Select File',
                fileSizeLimit: '300KB',
                fileTypeDesc: 'Image Files',
                fileTypeExts: '*.gif; *.jpg; *.png',
                auto: 'true',
                multiple: 'false',
                onError: function(type, info) {

                },
                onUploadSuccess: function(file, data, response) {

                }
            }); 
```

然后只需将您的控制器操作更改为

```
public virtual ActionResult Upload(HttpPostedFileBase FileData) 
```

FileData 将具有 FileName 之类的内容，并且还将文件包含在输入流中。

# android - 如何将现有的 Activity 类更改为片段类

> ID：11565954
> 
> 赞同：3
> 
> 时间：2012-07-19T17:12:26.303
> 
> 标签：android, android-widget, android-fragments, android-fragmentactivity

我正在尝试更新我现有的 Android 应用程序以在手机和平​​板电脑上运行。所以我想把Activity类改成片段。下面是我的活动课。

```
Individual Activity class

package FXPAL.Unity.Android;

import FXPAL.Unity.Android.Person.CalendarEntry;
import FXPAL.Unity.Android.Person.IM;
import FXPAL.Unity.Android.Person.Person;
import FXPAL.Unity.Android.Person.Status;
import android.app.Activity;
import android.app.Dialog;
import android.content.Intent;
import android.content.SharedPreferences;
import android.net.Uri;
import android.os.Bundle;
import android.os.Handler;
import android.os.Message;
import android.preference.PreferenceManager;
import android.view.Menu;
import android.view.MenuItem;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.ImageView;
import android.widget.LinearLayout;
import android.widget.TableLayout;
import android.widget.TableRow;
import android.widget.TextView;
import android.widget.Toast;

public class IndividualViewActivity extends Activity {

private static final String DB_TAG = "IndividualView";

//private static final String DB_TAG_PING = "ShowPingView";

private TextView displayName, presence, phoneNum, cellNum, emailAddr, btLocation, calInfo, status;
private ImageView userImage;
private Person personToDisplay;
private String phoneNumber, cellNumber, username, emailAddress;

private TableRow fxpalIMrow, skypeIMrow, msLiveIMrow, gtalkIMrow;
private TableLayout imTable;
private TextView fxpalIMstatus, skypeIMstatus, msLiveIMstatus, gtalkIMstatus, pingText;
private Button nudgeButton, pingButton, clearPingButton, calendarButton;
private LinearLayout pingLayout, pingNudgeButtonLayout;
protected String numToCall, numtype;
private DatabaseHelper db;

//private int pingID = -1;

private UnityMobileApp appCtx;

private static final int DIALOG_CALL_OFFICE_ID = 0;
private static final int DIALOG_CALL_CELL_ID = 1;
protected static final int DIALOG_VIEW_CALENDAR = 2;

private static final int REFRESH_MENU_ID = 0;
protected static final String OFFICE = "office";
private static final String CELL = "cell";

protected static final int MESSAGE_CONNECTION_ERROR_TOAST = 0;
//private static final String DEBUG_TAG = "unity.IndividualViewActivity";

private final Handler mHandler = new Handler() {
    public void handleMessage(Message msg) {
        switch (msg.what) {
        case MESSAGE_CONNECTION_ERROR_TOAST:
            Toast.makeText(IndividualViewActivity.this, Consts.CONNECTION_ERROR_MESSAGE, Toast.LENGTH_SHORT).show();
            break;
        }
    }
};
private SharedPreferences prefs;

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    //doBindService();
    setContentView(R.layout.individual_view);

    db = new DatabaseHelper(this);
    appCtx = (UnityMobileApp) getApplication();
    prefs = PreferenceManager.getDefaultSharedPreferences(this);

    //Setup View      
    displayName = (TextView)findViewById(R.id.individualName);        
    presence = (TextView)findViewById(R.id.individualPresence);
    userImage = (ImageView)findViewById(R.id.individualUserImage);
    phoneNum = (TextView)findViewById(R.id.individualPhone);
    cellNum = (TextView)findViewById(R.id.individualCellPhone);
    emailAddr = (TextView)findViewById(R.id.individualEmail);
    btLocation = (TextView)findViewById(R.id.individualLocation);
    calInfo = (TextView)findViewById(R.id.individualCalendarInfo);
    status = (TextView)findViewById(R.id.individualStatus);

    fxpalIMrow = (TableRow)findViewById(R.id.im_fxpal);
    skypeIMrow = (TableRow)findViewById(R.id.im_skype);
    msLiveIMrow = (TableRow)findViewById(R.id.im_ms_live);
    gtalkIMrow = (TableRow)findViewById(R.id.im_gtalk);

    fxpalIMstatus = (TextView)findViewById(R.id.im_status_fxpal); 
    skypeIMstatus = (TextView)findViewById(R.id.im_status_skype);
    msLiveIMstatus = (TextView)findViewById(R.id.im_status_ms_live);
    gtalkIMstatus = (TextView)findViewById(R.id.im_status_gtalk);

    imTable = (TableLayout)findViewById(R.id.individualIMStatus);

    nudgeButton = (Button)findViewById(R.id.individual_nudge_button);
    pingButton = (Button) findViewById(R.id.individual_ping_button);
    calendarButton = (Button)findViewById(R.id.individualViewCalendarButton);

    pingText = (TextView)findViewById(R.id.individualPingText);;
    clearPingButton = (Button) findViewById(R.id.individualClearPingButton);
    pingLayout = (LinearLayout)findViewById(R.id.individualPingInfo);
    pingNudgeButtonLayout = (LinearLayout)findViewById(R.id.individual_nudge_ping_layout);

    calendarButton.setOnClickListener(new OnClickListener() {

        public void onClick(View v) {
            showDialog(DIALOG_VIEW_CALENDAR);
            db.viewEvent(DB_TAG + ":CalendarDialog", username);

        }
    });

    nudgeButton.setOnClickListener(new OnClickListener() {

        public void onClick(View v) {               
            startActivity(new Intent(IndividualViewActivity.this, SendNudgeActivity.class)
                .putExtra(Consts.EXTRA_USERNAME, personToDisplay.getUsername())
                .putExtra(Consts.EXTRA_DISPLAY_NAME, personToDisplay.getDisplayName()));
        }
    });

    pingButton.setOnClickListener(new OnClickListener() {

        public void onClick(View v) {               
            startActivity(new Intent(IndividualViewActivity.this, SendPingActivity.class)
                .putExtra(Consts.EXTRA_USERNAME, personToDisplay.getUsername())
                .putExtra(Consts.EXTRA_DISPLAY_NAME, personToDisplay.getDisplayName()));
        }
    });
}

public void onPause(){
    super.onPause();
}

public void onDestroy(){
    super.onDestroy();
    //doUnbindService();
    db.close();
}

public void onResume(){
    super.onResume();

    Intent mIntent = getIntent();
    username = mIntent.getStringExtra(Consts.EXTRA_USERNAME);

    if(username.equalsIgnoreCase(prefs.getString(Consts.PREF_USERNAME, "")))
        pingNudgeButtonLayout.setVisibility(View.GONE);
    else
        pingNudgeButtonLayout.setVisibility(View.VISIBLE);

    personToDisplay = appCtx.getEveryone().get(username);
    updateView();
    updateInfo();

    if (personToDisplay == null || personToDisplay.getCalendar() == null ||
            personToDisplay.getCalendar().getCalendar().size() == 0)
        calendarButton.setEnabled(false);
    else
        calendarButton.setEnabled(true);        

        db.viewEvent(DB_TAG, username);
        pingLayout.setVisibility(View.GONE);
    //}
}

private void updateInfo(){
    ServerHelper.RequestListener listener = new ServerHelper.RequestListener() {
        public void onCompleted(ServerHelper.Request request) {
            if (request.isUnauthorized())
                startActivity(new Intent(IndividualViewActivity.this, LoginActivity.class));
            else if (request.isSuccess()) {
                Person.PersonHelper.getEveryoneAsync(IndividualViewActivity.this, appCtx.everyone, null, request.getResponseString(),
                        new Runnable() {
                    public void run () {
                        personToDisplay = appCtx.everyone.get(username);
                        updateView();
                    }
                });
            }
        }
    };
    ServerHelper.appCtx = appCtx;
    ServerHelper.getStatus (prefs, listener);
}

private void updateView(){
    if (personToDisplay == null)
        return;
    displayName.setText(personToDisplay.getDisplayName());
    presence.setText(personToDisplay.getPresenceState()); 

    Status mStatus = personToDisplay.getStatus();
    if( mStatus!= null && mStatus.toString().length()>0){
        status.setVisibility(View.VISIBLE);
        status.setText(mStatus.toString());
    }

    userImage.setImageBitmap(personToDisplay.getRoundedImage(Consts.LARGE_USER_IMAGE_SIZE, Consts.LARGE_USER_IMAGE_BORDER));

    phoneNumber = personToDisplay.getPhoneNum();
    if(phoneNumber.length()>0){
        phoneNum.setText(OFFICE + ": " + phoneNumber);
        phoneNum.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {
                numToCall = phoneNumber;
                numtype = OFFICE;
                showDialog(DIALOG_CALL_OFFICE_ID);
            }
        });}
    else
        phoneNum.setVisibility(View.GONE);

    cellNumber = personToDisplay.getCellPhoneNum();
    if(cellNumber.length()>0){
    cellNum.setText(CELL + ": " + cellNumber);
    cellNum.setOnClickListener(new OnClickListener() {

        public void onClick(View v) {
            numToCall = cellNumber;
            numtype = CELL;
            showDialog(DIALOG_CALL_CELL_ID);
        }
    });}
    else
        cellNum.setVisibility(View.GONE);

    emailAddress = personToDisplay.getEmailAddress();
    emailAddr.setText(emailAddress);
    emailAddr.setOnClickListener(new OnClickListener() {

        public void onClick(View v) {
            db.communicate(DB_TAG, "email", username);
            Intent emailIntent = new Intent();
            emailIntent.setAction(android.content.Intent.ACTION_SENDTO);
            emailIntent.setData(Uri.parse("mailto:" + emailAddress));
            startActivity(Intent.createChooser(emailIntent, "Select Email Client"));
        }
    });
    if(personToDisplay.hasLocation()){
        btLocation.setVisibility(View.VISIBLE);
        btLocation.setText(personToDisplay.getLocation().toString());
    }

    CalendarEntry usefulCalInfo = personToDisplay.getCalendar().getMostUseful();
    if(usefulCalInfo != null){
        calInfo.setVisibility(View.VISIBLE);
        calInfo.setText("Calendar: " + usefulCalInfo.toString());
    }

    if(personToDisplay.hasIM()){
        imTable.setVisibility(View.VISIBLE);
    }
    for(IM mIM : personToDisplay.getIMList().values()){
        switch(mIM.getId()){
        case(IM.FXPAL_ID):
            fxpalIMrow.setVisibility(View.VISIBLE);
            fxpalIMstatus.setText(mIM.getStatus());
        break;
        case(IM.SKYPE_ID):
            skypeIMrow.setVisibility(View.VISIBLE);
            skypeIMstatus.setText(mIM.getStatus());
        break;
        case(IM.MS_LIVE_ID):
            msLiveIMrow.setVisibility(View.VISIBLE);
            msLiveIMstatus.setText(mIM.getStatus());
        break;
        case(IM.GTALK_ID):
            gtalkIMrow.setVisibility(View.VISIBLE);
            gtalkIMstatus.setText(mIM.getStatus());
        break;
        default:

        }
    }

}

protected Dialog onCreateDialog(int id) {
    Dialog dialog = null;

    switch(id) {
    case DIALOG_CALL_OFFICE_ID: 

    case DIALOG_CALL_CELL_ID:

        dialog = CommDialog.getCallDialog(displayName.getText().toString(), numToCall,     numtype, IndividualViewActivity.this, db);
        break;
    case DIALOG_VIEW_CALENDAR:
        return CalendarListDialog.getDialog(username, IndividualViewActivity.this, appCtx);
    default:
        dialog = null;
    }
    return dialog;
}

public boolean onCreateOptionsMenu(Menu menu){

    menu.add(Menu.NONE, REFRESH_MENU_ID, Menu.NONE, "Refresh")
    .setIcon(R.drawable.ic_menu_refresh)
    .setAlphabeticShortcut('r');

    return(super.onCreateOptionsMenu(menu));
}

@Override
public boolean onOptionsItemSelected(MenuItem item){
    switch (item.getItemId()) {

    case REFRESH_MENU_ID:
        refresh();
        break;
    }
    return (super.onOptionsItemSelected(item));
}

void refresh() {
    // update the location and report it to the server
    ReportingService.startLocationRequest(appCtx, true);
    // this may still retrieve the old location
    updateInfo();
}
  } 
```

请帮帮我。很长一段时间以来，我一直被这个问题困扰。

问候， 拉克什

# iis-7 - 以编程方式添加的应用程序池（应用程序池）未显示在 Internet 信息服务 (IIS) 管理器中

> ID：11565957
> 
> 赞同：0
> 
> 时间：2012-07-19T17:12:54.253
> 
> 标签：iis-7, application-pool

（使用 IronPython），我按如下方式添加应用程序池，但应用程序池不会显示在 Internet 信息服务 (IIS) 管理器中。

有谁知道为什么会发生这种差异？这是有效的，因为我在查看应用程序池 ( `serverManager.ApplicationPools`) 时看到了我添加的应用程序池。

```
import clr
clr.AddReference("Microsoft.Web.Administration")

from Microsoft.Web.Administration import *
import getpass

current_user = System.Security.Principal.WindowsIdentity.GetCurrent().Name

serverManager = ServerManager()
app_pool = serverManager.ApplicationPools.Add("my pool name")
app_pool.AutoStart = True
app_pool.ManagedPipelineMode = ManagedPipelineMode.Integrated
app_pool.ManagedRuntimeVersion = "v2.0"
app_pool.ProcessModel.IdentityType =   ProcessModelIdentityType.SpecificUser
app_pool.ProcessModel.UserName = current_user
app_pool.ProcessModel.Password = getpass.getpass("Password:")

serverManager.CommitChanges() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T21:55:37.707

尝试这个：

```
// Create the Server Manager Object:
ServerManager defaultManager = new ServerManager();

// Add the Application-Pool:
ApplicationPool defaultAppPool = defaultManager.ApplicationPools.Add("DefaultAppPool");

// Configure the Pool to Automatically Start.
defaultAppPool.AutoStart = true;

// If IIS Application-Pool Exceeds the CPU Limit Property:
defaultAppPool.Cpu.Action = ProcessorAction.KillW3wp;

// Pipeline:
defaultAppPool.ManagedPipelineMode = ManagedPipeLineMode.Integrated;

// Set Runtime:
defaultAppPool.ManagedRuntimeVersion = "v2.0";

// User Network Service Account:
defaultAppPool.ProcessModel.IdentityType = ProcessModelIdentityType.NetworkService;

// Idle:
defaultAppPool.ProcessModel.IdleTimeout = TimeSpan.FromMinutes(5);

// Max Number of IIS Worker Processes: (W3wp)
defaultAppPool.ProcessModel.MaxProcess = 1;

// Commit the Changes:
defaultManager.CommitChanges();

// Dispose:
defaultManager.Dispose(); 
```

这可能是因为您没有启动新的 ServerManager / Application-Pool。然后当它去创建用户时；它可能不是可以实际创建用户帐户的帐户。如果您想验证应用程序确实也可以进行此类更改；你可以使用：

```
WindowsIdentity userIdentity = WindowsIdentity.GetCurrent();

// Test Operating System Version Vista or Greater for UAC
if (Environment.OSVersion.Platform != PlatformID.Win32NT || Environment.OSVersion.Version.Major < 6)
{

return false;

}

else
{

// If UserIdentity came back Null
if (userIdentity == null)
{

throw new InvalidOperationException("Unable to get current user");

}

else 
{
// Set Security Principal to ensure user is in proper role.
WindowsPrincipal userPolicy = new WindowsPrincipal(userIdentity);

if (userPolicy.IsInRole(WindowsBuiltInRole.Administrator))
{ 
return true;
}
else
{
MessageBox.Show("Application isn't in proper administrative user role; please restart.");
return false;
}
}
} 
```

# java - 如何在 android-uitableview 中添加选中按钮

> ID：11565959
> 
> 赞同：0
> 
> 时间：2012-07-19T17:13:00.103
> 
> 标签：java, android, onclicklistener

我尝试在[android-uitableview中实现选中按钮](https://github.com/thiagolocatelli/android-uitableview)

但我无法处理选中按钮和 UItableView 中的点击。

我该如何解决这个问题？

多谢你们

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T17:14:53.417

试试这个...

```
button1.setOnClickListener(new onClickListener(){

      public void onClick(View v){

      mButton1.setChecked(true);

      }

 } 
```

**编辑：**

提供您的`Checkboxes with Ids`...然后**在它们上设置 setOnClickListener** ..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T18:27:11.347

我必须添加几个可点击区域：[http ://android.cyrilmottier.com/?p=525](http://android.cyrilmottier.com/?p=525)

# android - 从传入的 SMS 中检测关键字并显示通知

> ID：11565960
> 
> 赞同：1
> 
> 时间：2012-07-19T17:13:06.267
> 
> 标签：android, notifications, sms, broadcastreceiver

您好，我是 Android 新手，我正在尝试从传入的 SMS 中检测关键字并在警报中显示通知，但我尝试了各种方法来使其正常工作，但它似乎不起作用。在 Android 模拟器 2.2 和我的 Android 手机本身 4.0.4 上尝试过，但它不起作用。代码中没有错误，我不知道如何让它工作。

电话查找器.java

```
package com.example.phonefinder2;

import java.math.BigInteger;   
import java.security.MessageDigest;   
import java.security.NoSuchAlgorithmException;   

import android.app.Activity;   
import android.content.SharedPreferences.Editor;   
import android.os.Bundle;   
import android.util.Log;   
import android.view.View;   
import android.view.View.OnClickListener;   
import android.widget.Button;   
import android.widget.EditText;   
import android.widget.TextView;   

public class PhoneFinder extends Activity {   
    private EditText edit01;   
    private EditText edit02;   
    private Button button_ok;   
    private TextView textview;   
    static final String PASSWORD_PREF_KEY = "passwd";   
    /** Called when the activity is first created. */   
    @Override   
    public void onCreate(Bundle savedInstanceState) {   
        super.onCreate(savedInstanceState);   
        setContentView(R.layout.main);   

        edit01 = (EditText)findViewById(R.id.password);   
        edit02 = (EditText)findViewById(R.id.password_confirm);   
        textview = (TextView)findViewById(R.id.text1);   
        button_ok = (Button)findViewById(R.id.ok);   
        button_ok.setOnClickListener(listener);   
        /*SharedPreferences setting = getSharedPreferences(PASSWORD_PREF_KEY, 0);  
        String t1 = setting.getString("PASSWORD", null);  
        edit01.setText(t1);  
        edit02.setText(t1);*/   
    }   

    OnClickListener listener = new OnClickListener() {   
        public void onClick(View v) {   
            String p1 = edit01.getText().toString();   
            String p2 = edit02.getText().toString();   
            if(p1.equals(p2)) {   
                if(p1.length() >= 6 && p2.length() >= 6) {   
                    Editor edit = getSharedPreferences(PASSWORD_PREF_KEY, MODE_PRIVATE).edit();   
                    String md5hash = getMd5Hash(p1);   
                    edit.putString("PASSWORD", md5hash);   
                    edit.commit();   
                    textview.setText("password updated");   
                } else {   
                    textview.setText("password must be at least 6 characters");   
                }   
            } else {   
                edit01.setText("");   
                edit02.setText("");   
                textview.setText("password do not match");   
            }   
        }   
    };   

    public static String getMd5Hash(String input) {    
        try {    
            MessageDigest md = MessageDigest.getInstance("MD5");    
            byte[] messageDigest = md.digest(input.getBytes());    
            BigInteger number = new BigInteger(1,messageDigest);    
            String md5 = number.toString(16);    

            while (md5.length() < 32)    
                md5 = "0" + md5;    
                return md5;    
        } catch(NoSuchAlgorithmException e) {    
            Log.e("MD5", e.getMessage());    
            return null;    
        }    
    }    
} 
```

FinderReceiver.java

```
package com.example.phonefinder2;

import android.app.Notification;   
import android.app.NotificationManager;   
import android.app.PendingIntent;   
import android.content.BroadcastReceiver;   
import android.content.Context;   
import android.content.Intent;   
import android.content.SharedPreferences;   
import android.location.Location;   
import android.location.LocationManager;   
import android.os.Bundle;   
import android.telephony.SmsManager;   
import android.telephony.SmsMessage;   
import android.widget.Toast;

public class FinderReceiver extends BroadcastReceiver {

    Context context;   
    @Override    
    public void onReceive(Context context, Intent intent) {    
        this.context = context;   
        SharedPreferences passwdfile = context.getSharedPreferences(    
                PhoneFinder.PASSWORD_PREF_KEY, 0);    

        String correctMd5 = passwdfile.getString(PhoneFinder.PASSWORD_PREF_KEY,    
                null);    
        if (correctMd5 != null) {    

              Bundle bundle = intent.getExtras();   
              Object pdus[] = (Object[]) bundle.get("pdus");
              SmsMessage smsMessage[] = new SmsMessage[pdus.length];   

              for(int i = 0; i < smsMessage.length; i++) {   
                  smsMessage[i] = SmsMessage.createFromPdu((byte[])pdus[i]);   
                if (smsMessage[i].getMessageBody().contains("RING:")) {    
                    String[] tokens = smsMessage[i].getMessageBody().split(":");    
                    if (tokens.length >= 2) {    
                        String md5hash = PhoneFinder.getMd5Hash(tokens[1]);    

                        if (correctMd5.equals(md5hash)) {    
                            String to = smsMessage[i].getOriginatingAddress (); 
                            SmsManager sm = SmsManager.getDefault(); 

                             sm.sendTextMessage (to, null, "success!", null, null);
                            NotificationManager nm =  
                                (NotificationManager) context.getSystemService (Context.NOTIFICATION_SERVICE); 
                            Notification notification = new Notification(android.R.drawable.ic_dialog_info, "Alert", System.currentTimeMillis());
                            PendingIntent contentIntent = PendingIntent.getActivity (context, 0, new Intent (context, PhoneFinder.class), 0);
                            notification.setLatestEventInfo (context, "GPS address", "You have been detected", contentIntent);
                            nm.notify (R.string.service_start, notification);
                        }    
                    }    
                } }   
            //}    
        }   
    }    
} 
```

# windows-7 - 查询已安装的 ACT 垫片列表

> ID：11565962
> 
> 赞同：1
> 
> 时间：2012-07-19T17:13:19.583
> 
> 标签：windows-7, inventory, shim, act

有谁知道我如何以编程方式获取给定计算机上已安装 ACT 垫片的列表？名称是否存储在注册表中的某个地方？我不需要脚本方面的帮助，只需一点帮助就可以指出我在哪里看。特别是对于 Windows 7。TIA！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T17:33:31.633

我想到了。它存储在 HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall 下的注册表中。每个条目只有两个值：“DisplayName”（仅显示 .SDB 文件的文件名）和“UninstallString”，提供“sdbinst.exe /u [path]\filename.sdb”或 GUID 语法： %windir%\system32\sdbinst.exe -u "C:\Windows\AppPatch\Custom{...GUID...}.sdb"

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-09-06T15:58:09.460

这可能找不到所有的垫片。不幸的是，如果垫片是通过 MSI 自定义操作安装的，卸载记录可能已被删除。请参阅[https://technet.microsoft.com/en-us/library/dd837647(v=ws.10).aspx](https://technet.microsoft.com/en-us/library/dd837647(v=ws.10).aspx)

PS：对于您的查询，我也没有比您更好的答案。它可能需要剖析安装垃圾的 sdb。

蒂姆

# ios - 打包操作失败

> ID：11565964
> 
> 赞同：1
> 
> 时间：2012-07-19T17:13:31.327
> 
> 标签：ios, xcode4, app-store, package

我试图在 appstore 上更新我的应用程序，并不断收到“打包操作失败”我很确定名称、捆绑标识符、发布配置、版本名称等与旧应用程序相同，已经在这里检查了许多帖子和网络，但也不能正常工作....有什么建议吗？使用 Xcode 4.3

编辑：我认为有什么问题，当我归档时，我在组织者中看到：“估计的应用商店大小：7 kb”7 kb？

编辑 2：

我正在使用库 ShareKIT 与社交网络、facebook、delicious 等集成，通常与 IOS 模拟器一起使用，或者在我自己的设备上使用。被告没有记录任何错误，但经过多次试验和错误，删除库并再次尝试，我工作正常。这是我找到的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T04:20:15.603

要查看“日志信息”，在 Xcode 中，使用 View->Navigators->Show-Log-Navigator

# android - 我如何在android中刷新listview？

> ID：11565975
> 
> 赞同：0
> 
> 时间：2012-07-19T17:14:32.340
> 
> 标签：android

这是我的代码： 这里 _alProduct 是在主类中静态定义的 ArrayList。我在长按列表视图时从 _alProduct 中删除一个项目。现在我想显示删除了已删除项目的列表视图。

公共类 MCRActivity2 扩展 Activity {

```
TextView tvShoppingCart;
ListView lvSelectedItems;

@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.mcractivity2);

    lvSelectedItems = (ListView) findViewById(R.id.lvSelectedItems);

    ArrayAdapter<String> adapter = new ArrayAdapter<String>(getApplicationContext(), android.R.layout.simple_list_item_1, MobileCashRegisterActivity._alProduct);

    lvSelectedItems.setAdapter(adapter);

    lvSelectedItems.setOnItemLongClickListener(new OnItemLongClickListener() {

        public boolean onItemLongClick(AdapterView<?> adapter, View view,
                int position, long arg3) {
            // TODO Auto-generated method stub  
            String text = "Clicked item is " + adapter.getItemAtPosition(position);

            Toast.makeText(getApplicationContext(),text,Toast.LENGTH_LONG).show();//    ""+ lvSelectedItems.getSelectedItem().toString(),Toast.LENGTH_LONG).show();

            MobileCashRegisterActivity._alProduct.remove(position);
            MobileCashRegisterActivity._alPrice.remove(position);
            MobileCashRegisterActivity._alQuantity.remove(position);

            return false;
        }
    });
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T17:15:56.663

调用`remove()`你的，`ArrayAdapter`而不是调用`remove()`. `ArrayList`这将从中删除项目`ArrayList`并告诉`AdapterView`刷新其内容。

# php - 努力从字符串中提取内容（PHP）

> ID：11565976
> 
> 赞同：-1
> 
> 时间：2012-07-19T17:14:34.597
> 
> 标签：php, regex, preg-match

我正在努力从字符串中提取内容（存储在数据库中）。每个div就是一个章节，h2内容就是标题。我想分别提取每章的标题和内容（div）

```
<p>
<div>
   <h2>Title 1</h2>
   Chapter Content 1 with standard html tags (ex: the following tags)
   <strong>aaaaaaaa</strong><br />
   <em>aaaaaaaaa</em><br />
   <u>aaaaaaaa</u><br />
   <span style="color:#00ffff"></span><br />
</div>
<div>
   <h2>Title 2</h2>
   Chapter Content 2
</div>
...
</p> 
```

我在php中尝试过preg_match_all，但是当我有标准的html标签时它不起作用

```
function splitDescription($pDescr)
{
    $regex = "#<div.*?><h2.*?>(.*?)</h2>(.*?)</div>#";
    preg_match_all($regex, $pDescr, $result);

    return $result;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T17:17:35.573

在您尝试使用正则表达式解析 HTML 之前，我建议您[阅读这篇文章。](https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags/1732454#1732454)

您可以使用许多优秀的[XML](http://www.w3schools.com/php/php_xml_simplexml.asp) / [HTML解析器。](http://simplehtmldom.sourceforge.net/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T17:25:19.593

不要为此使用正则表达式，它不是该工作的正确工具。使用 HTML 解析器，例如 PHP 的[`DOMDocument`](http://php.net/domdocument)：

```
libxml_use_internal_errors( true);
$doc = new DOMDocument;
$doc->loadHTML( $html);
$xpath = new DOMXPath( $doc);

// For each <div> chapter
foreach( $xpath->query( '//div') as $chapter) {

    // Get the <h2> and save its inner value into $title
    $title_node = $xpath->query( 'h2', $chapter)->item( 0);
    $title = $title_node->textContent;

    // Remove the <h2>
    $chapter->removeChild( $title_node);

    // Save the rest of the <div> children in $content
    $content = '';
    foreach( $chapter->childNodes as $child) {
        $content .= $doc->saveHTML( $child);
    }
    echo "$title - " . htmlentities( $content) . "\n";
} 
```

[演示](http://viper-7.com/Kmm2eH)

# html - Ruby Locales 迷失在页面导航中

> ID：11565978
> 
> 赞同：0
> 
> 时间：2012-07-19T17:14:37.637
> 
> 标签：html, ruby-on-rails, ruby, ruby-on-rails-3, locale

所以我对不同的网址（语言环境）有不同的页面。我的问题是，当我从一个页面导航到下一个页面时，会出现默认 url，并且您会看到默认站点，而不是特定于初始 url 请求的站点。

所以基本上我最初访问

```
 htttp://localhost:3000/?locale=ru 
```

对于我的应用程序的第一页，俄罗斯网站出现了。当我导航到下一页时，它会返回

```
 htttp://localhost:3000 
```

并加载此页面。我不知道为什么。有人会知道吗？

```
def set_locale
    I18n.locale = params[:locale] || I18n.default_locale
end 
```

我已经做到了。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T17:20:45.387

您需要在会话中保留语言环境；否则信息将在请求之间丢失，就像您所经历的那样。做这样的事情：

```
class ApplicationController <  ActionController::Base
  before_filter :set_locale

  private

  def set_locale
    @locale ||= params[:locale] || session[:locale] || I18n.default_locale
    I18n.locale = session[:locale] = @locale
  end

end 
```

这将设置`@locale`为参数中的任何内容，或者会话中的任何内容，或者 default_locale 是什么，然后基于此设置会话和 I18n 语言环境。

# entity-framework-4.3 - EF 4.3 - 为什么现有导航引用属性在分配给父级时会再次插入到数据库中？

> ID：11565979
> 
> 赞同：1
> 
> 时间：2012-07-19T17:14:44.577
> 
> 标签：entity-framework-4.3

**问题：**

用户创建一个新帐户。必填字段之一是`BusinessGroup`。`BusinessGroup`是导航参考属性。用户`BusinessGroup`从下拉框中选择，代码`BusinessGroup`在数据库中搜索，检索它并将其分配给帐户。听起来很简单，对吧？

出于某种原因，每次您保存一个新帐户时，它也会`BusinessGroup`在 BusinessGroups 的数据库表中插入另一个帐户，即使它已经存在，因为我从数据库中检索它并直接将其分配给帐户。EF上下文仍然认为它是一个新的。

顺便说一句，我使用代码优先，因为我遵循 TDD 方法。

这是我的 POCO：

```
 [Table("Account")]
    public class Account
    {
        [HiddenInput]
        public int Id { get; set; }

        [Required(ErrorMessage = "The Name is required")]
        public string Name { get; set; }

        public Guid? BusinessGroupId { get; set; }
        [Required(ErrorMessage = "The Business Group is required")]            
        public BusinessGroup BusinessGroup { get; set; }
    } 
```

因为我想覆盖在数据库中生成的外键的命名约定，所以我还在上面指定了外键 BusinessGroupId。

这是商业集团 POCO：

```
 [Table("BsuinessGroup")]
        public class BusinessGroup
        {
            [HiddenInput]
            [Key, DatabaseGenerated(DatabaseGeneratedOption.Identity)]
            public Guid Id { get; set; }

            [Required]                
            public string Name { get; set; }
        } 
```

这是根据用户从下拉框中选择的内容从数据库中获取 BusinessGroup 的代码，Id 是 GUID（请注意，此代码位于 MVC 自定义模型绑定器中，因此它公开了 ModelBinderContext：

```
 public object BindModel(ControllerContext controllerContext, ModelBindingContext bindingContext)
        {
            //see if there is an existing model to update and create one if not
            var account = (Account) bindingContext.Model ?? new Account();
            //find out if the value provider has a required prefix
            bool hasPrefix = bindingContext.ValueProvider.ContainsPrefix(bindingContext.ModelName);
            var prefix = hasPrefix ? String.Format("{0}.", bindingContext.ModelName) : String.Empty;
            _context = bindingContext;
            _prefix = prefix;

            //map the fields of the model object
            account.Id = Convert.ToInt32((GetValue("Id")));
            account.Name = (GetValue("Name"));
            account.Phone = (GetValue("Phone"));
            account.Fax = (GetValue("Fax"));
            account.Email = (GetValue("Email"));
            account.Website = (GetValue("Website"));

            account.Audit = new Audit{Created = DateTime.Now, CreatedBy = "renso"};

            //I changed this to assign the ID rather than assign the BusinessGroup itself since that did not work 
            //and causes a new BusinessGroup to be inserted into the DB on every save of an account,
                           // this solution seems to work but I am not sure if this is the correct behavior.
            **var tempBusinessGroup = ((Controllers.AccountController)controllerContext.Controller).
                BusinessGroupRepository.Find(GetGuidValue("BusinessGroup"));
            account.BusinessGroupId = tempBusinessGroup.Id;**

            return account;
        }
        private Guid GetGuidValue(string key)
        {
            var vpr = _context.ValueProvider.GetValue(_prefix + key);
            return vpr == null ? new Guid() : new Guid(vpr.AttemptedValue);
        }
        private string GetValue(string key)
        {
            var vpr = _context.ValueProvider.GetValue(_prefix + key);
            return vpr == null ? null : vpr.AttemptedValue;
        }
.............
    } 
```

上面的粗体代码我为 BusinessGroupId 分配了一个值（GUID），而不是`BusinessGroup`似乎可以正常工作。这是 EF 的预期行为、错误还是什么？

如果我将其更改为下面的代码，则会导致`BusinessGroup`在我保存新帐户时创建新帐户的问题：

```
 account.BusinessGroup = ((Controllers.AccountController)controllerContext.Controller).
        BusinessGroupRepository.Find(GetGuidValue("BusinessGroup")); 
```

这是我的行动：

```
[HttpPost]
public ActionResult Create(Account account)
{
    if (ModelState.IsValid)
    {
        AccountRepository.InsertOrUpdate(account);
        AccountRepository.Save();
        return RedirectToAction("List");
    }
    var viewData = new AccountControllerViewData { Account = account, BusinessGroups = BusinessGroupRepository.All };
    return View(viewData);
} 
```

保存也失败了，由于某种原因，我需要在 AccountRepository 上的 Save 中关闭 ValidateOnSaveEnabled=false，不知道为什么它可以工作，它抱怨在`BusinessGroup`我设置帐户的 BusinessGroupId 属性时丢失：

```
public void InsertOrUpdate(Account account)
{
    if (account.Id == default(Int32))
    {
        // New entity
        _context.Account.Add(account);
    }
    else
    {
        // Existing entity
        _context.Entry(account).State = EntityState.Modified;
    }
}

public void Save()
{
    //need the validation switched off or it fails with an error
    _context.Configuration.ValidateOnSaveEnabled = false;
    _context.SaveChanges();
} 
```

感觉就像我在这里遗漏了一些东西。我在 EF 2ed、Code-First 或 DbContext 书籍中找不到答案。似乎当您在 POCO 中定义自己的外键时，每当您想在我的示例中将导航引用从 Account 分配给 BusinessGroup 时，您不能直接分配给 BusinessGroup，您必须将值/键分配给外键，在本例中为 BusinessGroupId。难道我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T21:02:24.560

实际上，重构了代码，以便它使用相同的 DbContext 来检索帐户和业务组，这可以按预期工作，谢谢！现在的问题是，对于我的存储库模式，我从一个抽象类继承，该类为我提供了一个新的上下文，但这仍然不能解决我遇到的每个存储库都有自己的上下文的问题，你们是如何解决这个问题的? 例如，您创建一个新帐户，它具有业务组、国家/地区、州（如 PA、NJ）等的导航参考，每个都有自己的存储库，例如用于维护数据库中的国家/地区列表。一个帐户有一个国家导航参考，应该遵循什么模式来共享相同的上下文，我认为每个 http 请求一个？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T19:11:47.530

您`BusinessGroupRepository`和您很可能`AccountRepository`有自己的上下文实例。当您`BusinessGroup`从其中加载时，`BusinessGroupRepository`它发生在另一个上下文中，而不是`AccountRepository`您保存新的上下文的上下文中`account`。对于第二个上下文`BusinessGroup`是一个未知实体，EF 会将其保存为一个新实体。

重构您的代码以确保两个存储库将使用相同的上下文实例。上下文不应在存储库中创建，而应在外部创建并注入两者。或者将两个存储库合并到一个存储库中。

# ruby-on-rails - 金额无效 paypal_adaptive gem rails

> ID：11565980
> 
> 赞同：0
> 
> 时间：2012-07-19T17:14:45.110
> 
> 标签：ruby-on-rails, ruby-on-rails-3, paypal, paypal-adaptive-payments

我在日志控制台中收到此错误：

```
The amount is invalid 
```

我在开发环境中工作，与`http://localhost:3000/`

我的控制器中有：

```
def pay
 pay_request = PaypalAdaptive::Request.new
     data = {
       "returnUrl" => user_orders_url(current_user),
       "requestEnvelope" => {"errorLanguage" => "en_US"},
       "currencyCode" => "USD",
       "receiverList" =>
               { "receiver" => [
                 {"receiver"=> [{"email"=>"email1", "amount"=>"10.00", "primary" => true}, {"email"=>"email2", "amount"=>"9.00", "primary" => false}]}
               ]},
       "cancelUrl" => user_orders_url(current_user),
       "actionType" => "PAY",
       "ipnNotificationUrl" => ipn_notification_user_orders_url(current_user)
     }
     pay_response = pay_request.pay(data)

     if pay_response.success?
         # Send user to paypal
         redirect_to pay_response.preapproval_paypal_payment_url
     else
         puts pay_response.errors.first['message']
         redirect_to root_url, alert: "Something went wrong. Please contact support."
     end
end 
```

**我在做什么坏事？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T17:24:43.323

你能用

```
"amount"=>10 
```

或者

```
"amount"=>"10" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T09:56:55.630

错误已修复：

错误在`"primary" => true`和中`"primary" => false`。

**我已经删除了这段代码，现在控制器可以正常工作了。**

非常感谢你！

# jquery - jquery keyup 直到用户首先点击页面才被触发

> ID：11565988
> 
> 赞同：1
> 
> 时间：2012-07-19T17:15:37.863
> 
> 标签：jquery

我正在尝试使用 jQuery 中的按键设置一些简单的页面导航。例如，如果用户按下左箭头键，我希望页面加载一些东西。

除了用户必须首先单击浏览器窗口以注册关键事件外，一切正常。

这是我正在使用的代码：

```
$(document).ready(function() {
  $(document.documentElement).live("keyup", function(event) {
      if (event.keyCode == 37) {//left arrow
        //do something here
      }
  });
}); 
```

这似乎是一个焦点问题，但我读过使用`document.documentElement`意味着我不必特别关注任何事情。

如果用户在页面上单击一次然后点击左箭头，它就会起作用。但是如果他们加载页面并点击左箭头而不点击它不会触发。

有任何解决这个问题的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T17:18:21.380

尝试使用**[`.on()`](http://api.jquery.com/on)**和不使用委托事件处理。

```
$(document).ready(function() {
   $(document).on("keyup", function(event) {
      if (event.which == 37) {//left arrow
        //do something here
      }
   });
}); 
```

**或**使用**[`.keyup()`](http://api.jquery.com/keyup/)**如下方法：

```
$(document).ready(function() {
   $(document).keyup(function(event) {
      if (event.which == 37) {//left arrow
        //do something here
      }
   });
}); 
```

在这里你不需要`live`（不推荐）和`document.documentElement`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T17:25:04.683

您的页面上没有`focus`这就是您`need to click`在页面上的原因。将重点放在某些控件上，然后它将起作用。在这种情况下，live 不会造成任何麻烦，而是开始使用`on`，因为 live 已被弃用。

我通过状态设置焦点`$('#txt1').focus();`评论这个语句，你会注意到你必须点击页面来获取 keyup 事件。

**[现场演示](http://jsfiddle.net/rajaadil/bQPCd/1/)**

```
$(document).ready(function() {
  $('#txt1').focus();  //This is the statement that puts focus on page
  $(document.documentElement).live("keyup", function(event) {

      if (event.keyCode == 37) {//left arrow
        //do something here
          alert("");
      }
  });
});​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T17:19:29.347

-`.live()`函数已弃用。试试这个：

```
$(document).ready(function() {
  $('body').on("keyup", function(event) {
      if (event.keyCode == 37) {//left arrow
        //do something here
      }
  });
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T17:20:12.483

无需使用已弃用的`live`nor `on`，因为您还拥有该文档。

此外，无需使用`document.documentElement`.

简单地做

```
$(document).keydown(function(){
}); 
```

这很好用，不需要点击。

# java - 安卓操作栏首页

> ID：11565989
> 
> 赞同：1
> 
> 时间：2012-07-19T17:15:49.190
> 
> 标签：java, android, annotations, android-actionbar

够简单，

操作栏的左上角是应用程序的默认图标。在大多数应用程序中，单击它会返回主页。我正在使用 2 个设备，一个 3.2 和一个 2.3.3，我正在尝试在 3.2 上实现操作栏而不影响另一个。

我想它是这样实现的：

```
case android.R.id.home:            
         Intent intent = new Intent(this, ActOnThisActivity.class);            
         intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP); 
         startActivity(intent);            
         return true; 
```

最后一件事是设置标志

```
getActionBar().setHomeButtonEnabled(true); 
```

这应该可以，但任何熟悉 android 的人都知道，这不能在 11 或更低的 API 上运行。所以它将在 3.2+ 上运行，但不是 2.3.3。有没有办法指定此方法仅适用于 api11 及更高版本？

请注意，@TargetApi(11) 注释可能有效，但我遇到了一些奇怪的错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T17:28:53.233

从 sdk 示例中查看`ActionBarCompat`将让您清楚地了解如何执行此操作。

类中的以下代码`ActionBarHelper`（来自示例）决定不同版本的实例。

```
public static ActionBarHelper createInstance(Activity activity) {
    if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.ICE_CREAM_SANDWICH) {
        return new ActionBarHelperICS(activity);
    } else if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.HONEYCOMB) {
        return new ActionBarHelperHoneycomb(activity);
    } else {
        return new ActionBarHelperBase(activity);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T17:51:10.247

看看 ActionbarSherlock - 我在一些应用程序中使用它，它完美无缺。在 Honeycomb (3.0) 以下的 Android 版本中完美模仿 Action Bar。

[http://actionbarsherlock.com/](http://actionbarsherlock.com/)

> 几乎所有与操作栏交互的主要 API。这是*getSupportActionBar()*公开的确切 API。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-20T11:24:46.967

> 有没有办法指定此方法仅适用于 api11 及更高版本？

```
if (Build.VERSION.SDK_INT>=Build.VERSION_CODES.HONEYCOMB) {
  getActionBar().setHomeButtonEnabled(true);
} 
```

# objective-c - 关于属性的保留/释放

> ID：11565990
> 
> 赞同：-1
> 
> 时间：2012-07-19T17:15:52.033
> 
> 标签：objective-c

我的 .h 文件中有这个：

```
@property (nonatomic,retain) CCTexture2D *tempScreenshot; 
```

因为它说“保留”，所以我假设存储的任何值都`tempScreenshot`被保留。

我必须`tempScreenshot`在我的班级的 dealloc 方法中释放吗？

另外，如果我使用该`set`方法为 赋予一个新值`tempScreenshot`，这个新值将被保留，对吗？值会发生什么变化`old`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T17:20:33.207

关键字将`retain`属性标记为*在赋值时保留*，这意味着在集合上，`retain`将在新值上调用，**并将** `release`在旧值上调用。

您将需要`release`将对象放在`dealloc`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T17:20:38.020

*既然您说“保留”，我假设这是手动内存管理代码。如果可能，您应该切换到自动引用计数 (ARC)。它极大地简化了这项工作，并且比等效的手动代码更快。除了支持旧操作系统之外，几乎没有理由再进行手动内存管理了。*

> 由于它说“保留”，我假设存储在 tempScreenshot 中的任何值都被保留。

每当您调用`[self setTempScreenshot:]`时，访问器都会保留参数并释放旧值。直接分配 ivar 不会给您任何这些。除了 init 和 dealloc 之外，您应该始终使用访问器。

> 我必须在班级的 dealloc 方法中释放 tempScreenshot 吗？

是的。

> 另外，如果我使用 set 方法给 tempScreenshot 一个新值，这个新值将被保留，对吗？旧值会发生什么变化？

只要您使用访问器，它将被释放。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T17:23:05.023

在您的 dealloc 方法中，执行： self.tempScreenshot = nil; 这将导致对象被释放。假设没有其他东西保留它，它将被释放。

如果您要编写自己的 setter 方法来保留对象，它将如下所示。

```
//Assume an instance variabled name obj for this example
- (void)setAndRetainObjectExample:(NSObject *)newObj {
    [obj release];
    obj = newObj;
    [obj retain];
} 
```

使用合成的方法要干净得多，但是这样看可能会消除任何混乱。

# java - 石英性能

> ID：11565993
> 
> 赞同：20
> 
> 时间：2012-07-19T17:16:06.420
> 
> 标签：java, quartz-scheduler

Quartz 调度程序每秒可以运行的作业数量似乎是有限制的。在我们的场景中，我们每秒有大约 20 个作业以 24x7 的方式启动，quartz 工作良好，达到每秒 10 个作业（对于 JDBC 支持的 JobStore 有 100 个石英线程和 100 个数据库连接池大小），但是，当我们将其增加到 20每秒作业，石英变得非常非常慢，并且其触发的作业与实际预定时间相比非常晚，导致许多Misfires并最终显着降低系统的整体性能。一个有趣的事实是，`JobExecutionContext.getScheduledFireTime().getTime()`对于此类延迟触发，它们会在其预定时间之后 10 到 20 分钟甚至更多分钟。

石英调度程序每秒可以运行多少个作业而不影响作业的预定时间，对于这种负载，石英线程的最佳数量应该是多少？

或者我在这里错过了什么？

### 关于我们想要实现的目标的详细信息：

我们有将近 10k 个项目（分为 2 个或更多类别，在当前情况下我们有 2 个类别），我们需要以给定的频率对其进行一些处理，例如 15,30,60... 分钟，这些项目应在该频率内处理每分钟给定的油门。例如，假设 60 分钟频率，每个类别的 5k 个项目应以每分钟 500 个项目的节流进行处理。因此，理想情况下，这些项目应在一天中每小时的前 10 (5000/500) 分钟内处理，每分钟有 500 个要处理的项目均匀分布在每分钟的每一秒内，因此我们将有大约 8-一个类别每秒 9 个项目。

现在为了实现这一点，我们使用 Quartz 作为调度程序来触发处理这些项目的作业。但是，我们不会在 Job.execute 方法中处理每个项目，因为每个涉及 Web 服务调用的项目处理需要 5-50 秒（平均为 30 秒）。**我们宁愿为JMS**队列上的每个项目处理推送一条消息，并且单独的服务器机器处理这些作业。我注意到 Job.execute 方法所花费的时间不超过**30 毫秒**。

### 服务器详情：

Solaris Sparc 64 位服务器，具有 8/16 核/线程 cpu，用于调度程序，具有 16GB RAM，我们在调度程序集群中有两台这样的机器。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-19T18:29:54.957

在之前的项目中，我遇到了同样的问题。在我们的例子中，Quartz 的性能可以达到一秒的精度。亚秒级调度是一个延伸，正如您所观察到的，经常发生失火并且系统变得不可靠。

通过创建 2 级调度解决了这个问题： Quartz 将调度 n 个连续作业的作业“集”。对于集群 Quartz，这意味着系统中的给定服务器将“设置”这个作业来执行。然后集合中的 n 个任务由“微调度程序”接收：基本上是一种计时工具，它使用本机 JDK API 将作业进一步计时到 10ms 粒度。

为了处理单个作业，我们使用了 master-worker 设计，其中 master 负责将作业按计划交付（节流）到一个多线程的 worker 池。

如果我今天必须再次这样做，我将依靠[ScheduledThreadPoolExecutor](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ScheduledThreadPoolExecutor.html)来管理“微调度”。对于您的情况，它看起来像这样：

```
ScheduledThreadPoolExecutor scheduledExecutor;
...
    scheduledExecutor = new ScheduledThreadPoolExecutor(THREAD_POOL_SIZE);
...

// Evenly spread the execution of a set of tasks over a period of time
public void schedule(Set<Task> taskSet, long timePeriod, TimeUnit timeUnit) {
    if (taskSet.isEmpty()) return; // or indicate some failure ...
    long period = TimeUnit.MILLISECOND.convert(timePeriod, timeUnit);
    long delay = period/taskSet.size();
    long accumulativeDelay = 0;
    for (Task task:taskSet) {
        scheduledExecutor.schedule(task, accumulativeDelay, TimeUnit.MILLISECOND);
        accumulativeDelay += delay;
    }
} 
```

这让您大致了解如何使用 JDK 工具来微调度任务。（免责声明：您需要为 prod 环境提供强大的功能，例如检查失败的任务、管理重试（如果支持）等...）。

通过一些测试和调优，我们在 Quartz 作业和一个计划集中的作业数量之间找到了最佳平衡。

通过这种方式，我们体验了 100 倍的吞吐量提升。网络带宽是我们的实际限制。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-19T17:23:52.907

首先检查[*如何提高 JDBC-JobStore 的性能？*](http://quartz-scheduler.org/documentation/faq#FAQ-jdbcPerf)在石英文档中。

正如您可能猜到的那样，存在绝对值和确定的度量。这完全取决于您的设置。但是这里有一些提示：

*   每秒 20 个作业意味着每秒大约 100 个数据库查询，包括更新和锁定。这是相当多的！

*   考虑将您的 Quartz 设置分发到集群。但是，如果数据库是一个瓶颈，它不会帮助你。也许[`TerracottaJobStore`](http://quartz-scheduler.org/documentation/quartz-2.x/tutorials/tutorial-lesson-09)会来救援？

*   在系统中拥有`K`所有核心都`K`不会充分利用您的系统。如果您的工作是 CPU 密集型的，`K`那很好。如果他们正在调用外部 Web 服务、阻塞或休眠，请考虑更大的值。但是，由于上下文切换，超过 100-200 个线程会显着降低系统速度。

*   你试过剖析吗？你的机器大部分时间都在做什么？你可以发布线程转储吗？我怀疑数据库性能不佳而不是 CPU，但这取决于您的用例。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-19T17:19:51.973

您应该将线程数限制在可用处理器数量之间`n`的某个`n*3`位置。`n`启动更多线程将导致大量上下文切换，因为它们中的大多数大部分时间都会被阻塞。

就每秒作业而言，它实际上取决于作业运行的时间以及它们因网络和磁盘 io 等操作而被阻塞的频率。

此外，需要考虑的是，也许石英不是您需要的工具。如果您每天发送 1 到 2 百万个工作岗位，您可能需要研究定制解决方案。每天有 200 万个工作，你在做什么？！

另一种选择，这是解决问题的一种非常糟糕的方法，但有时可以......它正在运行的服务器是什么？它是旧服务器吗？它可能会增加内存或其他规格，这会给你一些额外的“嗡嗡声”。当然，这不是最好的解决方案，因为这会延迟问题，而不是解决问题，但是如果您处于紧要关头，它可能会有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-08-19T10:49:15.310

在每秒有大量作业的情况下，请确保您的 sql server 使用行锁而不是表锁。在 mysql 中，这是通过使用 InnoDB 存储引擎完成的，而不是默认的仅提供表锁的 MyISAM 存储引擎。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-10-09T18:27:43.210

从根本上说，当您在如此短的时间内处理如此大量的事情时，一次只做一件事情的方法注定是低效的。您需要将事情分组 - 使用工作集的建议方法然后对每个单独的工作进行微调度是第一步，但这仍然意味着每个工作几乎什么都不做。更好的是改进您的网络服务，以便您可以告诉它一次处理 N 个项目，然后使用要处理的项目集调用它。更好的是避免通过 web 服务做这种事情，并在数据库中处理它们，作为集合，这是数据库的优点。任何一次处理一个项目的工作基本上都是不可扩展的设计。

# c# - ADOX 或 SQL DDL

> ID：11565997
> 
> 赞同：0
> 
> 时间：2012-07-19T17:16:25.887
> 
> 标签：c#, ddl, adox

我尝试了两种方法在 ADOX 目录类生成的新 Ms Access 数据库中创建表。第一种方法是使用 ADOX 类和属性来创建列和表，并最终在创建数据库的同时将它们添加到数据库中。第二种方法是使用 OleDbConnection 类并执行 SQL DDL 命令两个在空数据库中创建表。

对我来说，这两种方法都很好，但我真的需要知道哪种方法在现实中实施得更好？

谢谢

# elisp - Elisp/texi2dvi：如何从 Emacs 调用 texi2dvi？

> ID：11565998
> 
> 赞同：0
> 
> 时间：2012-07-19T17:16:34.593
> 
> 标签：elisp, pdflatex

我尝试根据以下代码编写一个函数：[Latex，Emacs：出现错误时自动打开 *TeX Help* 缓冲区并在更正错误后关闭它？](https://stackoverflow.com/questions/9249458/latex-emacs-automatically-open-tex-help-buffer-on-error-and-close-it-after-c)

我想用texi2dvi替换latexmk，但`TeX-master-file`不包含文件结尾`.tex`（这似乎是texi2dvi所必需的）。我发现可以`.tex`通过使用添加`TeX-master-file t`。但是，我无法让它工作（我不是 elisp 程序员）。这是我尝试过的：

```
;; texi2dvi 
(defun run-texi2dvi ()
  (interactive)
  (let ((TeX-save-query nil)
        (TeX-process-asynchronous nil)
        (master-file (expand-file-name (TeX-master-file t)))); append `.tex`
    (TeX-save-document "")
    (TeX-run-TeX "texi2dvi"
         (TeX-command-expand "PDFLATEX='pdflatex -synctex=1' texi2dvi -p %s" 'TeX-master-file)
                 master-file)
    (if (plist-get TeX-error-report-switches (intern master-file))
        (TeX-next-error t)
      (progn
    (demolish-tex-help)
    (minibuffer-message "texi2dvi: done."))))) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T22:05:24.863

不知道是否有更好的方法，但这个版本应该可以工作。基本上，TeX-command-expand 被赋予函数 TeX-master-file 作为内部调用的符号，并且在没有 I-want-the-extension 参数的情况下调用它。替换 lambda 强制执行此操作。

```
(defun run-texi2dvi ()
  (interactive)
  (let ((TeX-save-query nil)
        (TeX-process-asynchronous nil)
        (master-file (expand-file-name (TeX-master-file t)))); append `.tex`
    (TeX-save-document "")
    (TeX-run-TeX "texi2dvi"
         (TeX-command-expand
          "PDFLATEX='pdflatex -synctex=1' texi2dvi -p %s"
          (lambda (ext-ignored nondir)
            (TeX-master-file t nondir)))
                 master-file)
    (if (plist-get TeX-error-report-switches (intern master-file))
        (TeX-next-error t)
      (progn
    (demolish-tex-help)
    (minibuffer-message "texi2dvi: done."))))) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T09:16:03.080

有关问题的更详细描述和简单的解决方法，请参见此处：[https ://tex.stackexchange.com/questions/67244/how-to-set-up-texi2dvi-with-synctex-and-error-handling/67384 #67384](https://tex.stackexchange.com/questions/67244/how-to-set-up-texi2dvi-with-synctex-and-error-handling/67384#67384)