# StackOverflow 问答 10323000-10323999

# javascript - 如何在 jquery mobile 中添加到 'data-role="content"'

> ID：10323011
> 
> 赞同：0
> 
> 时间：2012-04-25T20:10:42.657
> 
> 标签：javascript, jquery, jquery-mobile

要更新以下 div ：

```
 <div id="toadd" data-role="content">
        <p>Page 1 content</p>
                <ul data-role="listview" data-theme="g">
    <li><a href="bmw.html">BMW</a></li>
</ul>
    </div> 
```

我正在使用 ：

```
 $(document).ready(function() {                   
          $("#toadd ul").append("<li><a href=\"acura.html\">tes</a></li>");
       }   
    }); 
```

问题是链接被添加为标准 href ：

![在此处输入图像描述](../Images/4f2f29f23fcd0d50d57b37e1b22e4b73.png)

如何更新代码以使“测试”使用与附加图像中的“宝马”相同的 jquery 移动样式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T20:17:26.987

尝试`$("#toadd ul").append("<li><a href=\"acura.html\">tes</a></li>").listview('refresh');`

[检查另一个帖子](https://stackoverflow.com/questions/5925810/dynamically-adding-li-to-ul-in-jquery-mobile)

# django - 是否仍然可以在 Google App Engine 上使用 django-mediagenerator

> ID：10323013
> 
> 赞同：0
> 
> 时间：2012-04-25T20:10:50.647
> 
> 标签：django, google-app-engine, django-nonrel, django-mediagenerator

我一直在一家新公司从事现有项目，我们遇到的问题之一是 Javascript 代码重复。我们正在使用 Google App Engine，我听说过[Django 媒体生成器资产管理器](http://www.allbuttonspressed.com/projects/django-mediagenerator)，它似乎可以解决我们的一些问题。[但是，在阅读了该页面上的文档以及在 Google App Engine 中运行 Django 的类似](https://developers.google.com/appengine/articles/django)页面之后，我不确定是否可以在 Google App 引擎上运行 django-mediagenerator。

是否仍然可以在 Google App Engine 上使用 django-mediagenerator？项目过时了吗？我应该在应用引擎中使用其他媒体生成器吗？

任何帮助，将不胜感激。谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T08:19:36.890

Django-mediagenerator 在开发时考虑了 app-engine，正如您在[这篇博](http://www.allbuttonspressed.com/blog/django/2010/08/django-mediagenerator-total-asset-management)文中看到的那样。

所以：是的，您可以使用它;-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T16:38:16.750

作为替代方案，我在 Google App Engine 中使用[webassets](https://github.com/miracle2k/webassets)作为资产管理器取得了一些成功，尽管由于生产环境的限制，它在部署之前是一个命令行过程。

存储库中有一个基本的应用程序引擎示例，因此设置起来相当快。

# c# - 从静态函数写入标签

> ID：10323016
> 
> 赞同：1
> 
> 时间：2012-04-25T20:11:00.600
> 
> 标签：c#, asp.net

我正在尝试做一些我认为很容易但不知道如何在我的声明函数中写入标签的事情。

```
public static void StartProcessing(object data)
{

   lblError.Text = "Blah Blah"
} 
```

我收到错误“非静态字段、方法或属性需要对象引用...”

因此，我尝试创建标签的新实例并将其添加到控件（面板）的新实例中，但未显示 lblError

```
 public static void StartProcessing(object data)
    {
       Panel Panel1 = new Panel();
       Label lblError= new Label();
       Panel1.Controls.Add(lblError);

       lblError.Visible = true;
       lblError.Text = "Blah Blah";

    } 
```

必须有一个简单的方法来做到这一点？我忽略了..

该函数被调用如下：如果我将上面的内容更改为不是静态的，我会在下面的第二行收到一条错误消息，上面写着同样的“非静态字段、方法或属性需要对象引用...... " 当这个函数不是静态的？

```
public object LaunchNewProcess(object data)
{
ThreadPool.QueueUserWorkItem(
                new WaitCallback(ProcessStatuses.StartProcessing),
                new object[] {newProcess, allProcesses}
                ); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T20:13:42.003

调用时将标签传递给静态函数：

```
public static void StartProcessing(object data, Label lblError)
{

   lblError.Text = "Blah Blah"
} 
```

静态函数无权访问控件，因为控件属于页面（类）的*实例*。

**静态**意味着类的所有实例共享相同的函数或变量。因此，类的实例可以访问静态变量或函数。然而，由于静态不“知道”类的任何实例，它不能访问实例的成员。实际上，静态方法或变量甚至不需要类的任何实例存在，那怎么可能呢？

正如其他人所提到的，从您的函数中删除`static`关键字也将起作用，但我假设您将其设为静态是有原因的。

*编辑* 好吧，这更复杂。

所以，你有一些类启动了一堆线程，如果出现问题，你希望它显示给用户？好吧，您当前的方法是有缺陷的，因为您无法在没有页面实例的情况下访问页面的控件。另外，我不确定这种方法如何适合页面生命周期。

您最好的方法（抱歉缺少代码，这在很大程度上取决于您的实现）可能是这样的：

```
//do this before you start spawning threads
List<bool> successes = new List<bool>();

ThreadPool.QueueUserWorkItem(
            new WaitCallback(ProcessStatuses.StartProcessing),
            new object[] {newProcess, allProcesses, successes}
            );

//you MUST wait for all your threads to complete before proceeding!
if(successes.Any(s => !s))
{
    //update your error label
}

public static void StartProcessing(object data, Label lblError)
{
    var dataArray = (object[3]) data;
    //if there is an error
    dataArray[2] = false;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T20:40:42.503

你想要做的其实是相当困难的。

您想创建一个页面，启动一个异步任务，将页面发送给用户，然后在异步作业完成后更新页面上的内容。

问题是，当异步任务完成时，页面已经被发送，并且基于 HTTP 的工作方式，一旦你发送了响应，你就完成了；您无需与客户进行更多沟通。如果要更新它们，则需要等待客户端发送另一个请求。

这意味着您需要让 JavaScript 代码不断地轮询服务器，基本上询问“你完成了吗，你完成了吗，你完成了吗？” 直到最终服务器说，“是的，这是要在页面上显示的内容”。

幸运的是，您不需要从头开始。 [在这里](http://code.msdn.microsoft.com/CSASPNETBackgroundWorker-dda8d7b6/view/SourceCode)，您将找到 Microsoft 的一个示例，它可以完成所有这些操作；您可以修改它以满足您的需要。还值得一提的是，除了编程不简单之外，不断轮询服务器也会消耗大量资源，因此请确定您确实需要这样做。

选项 2 是不在新线程中启动其他任务，而是在页面返回给用户之前串行执行代码。他们会盯着空白屏幕一会儿，但编程会容易得多。如果任务真的长时间运行，这里要注意的一个缩小是超时。

# c++ - 如何从 T、T& 或 T* 模板参数中获取 T*

> ID：10323018
> 
> 赞同：2
> 
> 时间：2012-04-25T20:11:19.553
> 
> 标签：c++, templates, pointers, reference

我正在尝试找到一种方法来获取模板参数的基类。

考虑以下类：

```
template <class C>
class Foo
{
    public:
        Foo(){};
        ~Foo(){};
        C* ptr;
}; 
```

如果**C**是引用（例如*Test&*），则*ptr*是类型 C&*

但无论 C 是引用、指针还是其他任何东西，我都需要获取基类的指针。

*   如果**C**是**Test&**然后*ptr*需要是**Test***，
*   如果**C**是**Test***那么*ptr*需要是**Test***，
*   如果**C**是**Test**那么*ptr*需要是**Test***等等。

反正有没有得到 C 的“基”类，所以我可以创建我需要的指针？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-25T20:22:48.300

如果你真的需要底层元素类型，你可以使用移除类型操作特征的递归应用：

```
#include <type_traits>

// precv = pointer, reference, extents, const, and volatile
template <typename T>
struct remove_precv
{
    typedef typename std::remove_pointer<
            typename std::remove_reference<
            typename std::remove_all_extents<
            typename std::remove_cv<T>::type>::type>::type>::type type;
};

template <typename T, typename U>
struct element_type_impl
{
    typedef typename element_type_impl<
            typename remove_precv<T>::type, T>::type type;
};

template <typename T>
struct element_type_impl<T, T>
{
    typedef T type;
};

template <typename T>
struct element_type
{
    struct null_type { };
    typedef typename element_type_impl<T, null_type>::type type;
}; 
```

例如，`element_type<int***[42]>::type`是`int`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-25T20:18:54.023

做这个：

```
#include <type_traits>

template <typename T>
class Foo
{
    typedef typename std::remove_pointer<typename std::decay<T>::type>::type C;
    // ...
}; 
```

`decay`删除引用和 CV 限定，并`remove_pointer`删除指针。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-25T20:18:46.467

怎么用[`std::remove_reference`](http://en.cppreference.com/w/cpp/types/remove_reference)？

```
#include <type_traits>

template <class C>
class Foo
{
    public:
        Foo(){};
        ~Foo(){};
        std::remove_reference<C>::type *ptr;
}; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-25T20:26:13.773

您可以通过一些模板元编程来做到这一点，例如：

```
#include <cassert>
#include <typeinfo>

template <typename T>
struct unpoint {
  typedef T type;
};

template <typename T>
struct unpoint<T*> {
  typedef typename unpoint<T>::type type;
};

int main() {
  int *a;
  int **b;
  int ***c;
  int ****d;

  const std::type_info& t1=typeid(unpoint<decltype(a)>::type);
  const std::type_info& t2=typeid(unpoint<decltype(b)>::type);
  const std::type_info& t3=typeid(unpoint<decltype(c)>::type);
  const std::type_info& t4=typeid(unpoint<decltype(d)>::type);
  assert(t1 == t2);
  assert(t1 == t3);
  assert(t1 == t4);
} 
```

的特化`unpoint`删除指针并递归调用自身，直到类型中没有指针为止。

# .net - 单元测试写入 HttpWebRequest 的请求流

> ID：10323020
> 
> 赞同：3
> 
> 时间：2012-04-25T20:11:29.670
> 
> 标签：.net, unit-testing, httpwebrequest

我回来在我们的应用程序中填写一些单元测试，并遇到了以下方法。

```
public virtual void WriteBodyToRequestStream(HttpWebRequest webRequest, byte[] redirectBodyBuffer) {
    var requestStream = webRequest.GetRequestStream();
    requestStream.Write(redirectBodyBuffer, 0, redirectBodyBuffer.Length);
    requestStream.Close();
} 
```

我正在尝试编写一个简单的测试，在流中插入一些文本。我遇到的问题是弄清楚如何在将文本写入流后对其进行验证。这是我到目前为止所拥有的。

```
[Test, Ignore("not working yet")]
public void Should_write_to_request_stream()
{
    var request = WebRequest.Create("http://localhost/") as HttpWebRequest;
    request.Method = "POST";
    var encoding = new System.Text.UTF8Encoding();
    var bytes = encoding.GetBytes("testing");
    _helper.WriteBodyToRequestStream(request, bytes);

    var stream = request.GetRequestStream() as MemoryStream;
    var result = System.Text.Encoding.UTF8.GetString(stream.ToArray());

    Assert.AreEqual("testing", result);
} 
```

当我运行这个测试时，`stream`var 为空。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T15:16:18.613

你真的需要传递`HttpWebRequest`给你的`WriteBodyToRequestStream`方法吗？您真的不在乎`HttpWebRequest`您感兴趣的流越多：

```
public virtual void WriteBodyToRequestStream(Stream requestStream , byte[] redirectBodyBuffer) {
//var requestStream = webRequest.GetRequestStream(); remove this line.
requestStream.Write(redirectBodyBuffer, 0, redirectBodyBuffer.Length);
requestStream.Close();
} 
```

这使您的方法易于测试（无论是单元测试还是集成测试，我将留待讨论；P）

# java - 自定义 JScrollPane。在 ScrollBar 行上添加组件

> ID：10323021
> 
> 赞同：1
> 
> 时间：2012-04-25T20:11:30.067
> 
> 标签：java, swing, jscrollpane, jlabel, jscrollbar

这就是我想要实现的目标：

![在此处输入图像描述](../Images/19ff0a71447b27ac105d3e7dde3fb516.png)

如您所见，水平滚动已更改，应在同一行中添加 JLabel("text")。目前我找到了改变水平滚动的方法（比如在图像上），但我找不到任何方法在它放置在图像上的地方添加 JLabel("text")。

有什么建议么？提前致谢！

```
import java.awt.Component;
import java.awt.Container;
import java.awt.Point;

import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.ScrollPaneLayout;
import javax.swing.WindowConstants;

public class Test {

    public static void main(String[] args) {
        JFrame jFrame = new JFrame();
        jFrame.setSize(300, 300);

        JPanel myPanel = new JPanel();
        myPanel.add(new JLabel("Check Check Check Check Check Check Check Check"));
        MyScrollPane scrollPane = new MyScrollPane(myPanel);

        jFrame.add(scrollPane);
        jFrame.setVisible(true);
        jFrame.setDefaultCloseOperation(WindowConstants.DISPOSE_ON_CLOSE);
    }

}

class MyScrollPane extends JScrollPane {

    JLabel label = new JLabel("text");

    public MyScrollPane(Component view) {
        super(view, VERTICAL_SCROLLBAR_ALWAYS, HORIZONTAL_SCROLLBAR_ALWAYS);
        this.setLayout(new MyLayout(label));
        add(label);
    }
}

class MyLayout extends ScrollPaneLayout {

    JLabel label;

    public MyLayout(JLabel aLabel) {
        super();
        label = aLabel;
    }

    public void layoutContainer(Container parent) {
        super.layoutContainer(parent);

        hsb.setSize(hsb.getWidth() - 100, hsb.getHeight()); // drift
        Point location = hsb.getLocation();
        label.setLocation(location.x + 12, location.y - 12);
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T20:33:10.433

您可能要考虑制作自己的 JScrollPane 实现。听起来可能很吓人，但本质上，一个 JScrollPane 就是 2 个 JScrollBars 和一些调用 g.translate() 的图形逻辑 如果你玩弄 g.translate，你会发现滚动你自己的东西非常容易。

制作自己的组件的优点是您可以完全控制布局、显示和事件。如果我处于你的位置，这就是我会采取的路线。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T08:11:57.807

这是我的尝试：

```
import java.awt.*;
import java.awt.font.*;
import javax.swing.*;
import javax.swing.border.*;

public class Test2 {
  public JComponent makeUI() {
    JPanel myPanel = new JPanel();
    myPanel.add(new JLabel("Check Check Check Check Check Check Check Check"));
    JScrollPane scrollPane = new JScrollPane(myPanel,
        JScrollPane.VERTICAL_SCROLLBAR_ALWAYS,
        JScrollPane.HORIZONTAL_SCROLLBAR_ALWAYS);
    JScrollBar hsb = scrollPane.getHorizontalScrollBar();
    hsb.setBorder(new StringBorder(hsb, "Test"));
    JPanel p = new JPanel(new BorderLayout());
    p.add(scrollPane);
    return p;
  }
  public static void main(String[] args) {
    EventQueue.invokeLater(new Runnable() {
      @Override public void run() {
        createAndShowGUI();
      }
    });
  }
  public static void createAndShowGUI() {
    JFrame f = new JFrame();
    f.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);
    f.getContentPane().add(new Test2().makeUI());
    f.setSize(300, 300);
    f.setLocationRelativeTo(null);
    f.setVisible(true);
  }
}
class StringBorder implements Border {
  private final JComponent parent;
  private final Insets insets;
  private final Rectangle rect;
  private final String str;
  public StringBorder(JComponent parent, String str) {
    this.parent = parent;
    this.str = str;
    FontRenderContext frc = new FontRenderContext(null, true, true);
    rect = parent.getFont().getStringBounds(str, frc).getBounds();
    rect.width = Math.max(rect.width, 100);
    insets = new Insets(0,5,0,rect.width);
  }
  @Override public Insets getBorderInsets(Component c) {
    return insets;
  }
  @Override public boolean isBorderOpaque() {
    return false;
  }
  @Override public void paintBorder(
      Component c, Graphics g, int x, int y, int width, int height) {
    Graphics2D g2 = (Graphics2D)g;
    float tx = x + width - insets.right + insets.left;
    float ty = y - rect.y + (height - rect.height)/2;
    g2.setPaint(Color.BLACK);
    g2.drawString(str, tx, ty);
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-02T11:42:27.567

可能实现此类目标的最佳方法是将您自己的布局与`JScrollPane`. 这是一个允许任何组件作为左下角组件的示例：

```
public class CustomScrollPaneLayout extends ScrollPaneLayout {
    @Override
    public void layoutContainer(Container parent) {
        super.layoutContainer(parent);

        JScrollBar scrollBar = getHorizontalScrollBar();
        if (lowerLeft == null || !lowerLeft.isVisible() || scrollBar == null)
            return;

        Dimension size = lowerLeft.getPreferredSize();
        Rectangle bounds = lowerLeft.isVisible()
                ? lowerLeft.getBounds() : scrollBar.getBounds();
        if (size.width > bounds.getWidth()) {
            int right = scrollBar.getX()+scrollBar.getWidth();
            if (size.width + scrollBar.getMinimumSize().width > right)
                size.width = right - scrollBar.getMinimumSize().width;
            if (bounds.x + size.width < scrollBar.getX())
                size.width = scrollBar.getX() - bounds.x;

            lowerLeft.setBounds(bounds.x, bounds.y, size.width, bounds.height);
            int x = bounds.x + size.width;
            scrollBar.setBounds(x, bounds.y, right - x, bounds.height);
        }
        lowerLeft.setVisible(true);
    }
} 
```

请注意，`ScrollPaneConstants.HORIZONTAL_SCROLLBAR_ALWAYS`如果您希望控件始终可见，则需要使用水平滚动条策略。

# java - jess中如何定义另一种模板类型的槽

> ID：10323024
> 
> 赞同：2
> 
> 时间：2012-04-25T20:11:40.753
> 
> 标签：java, jess

我有一个名为 Person 的模板，这个模板有眼睛、手、身体和许多其他插槽。但是这些插槽中的每一个都是其他模板。
那么如何为其他模板类型的模板定义插槽？
以及如何定义事实？

这是我主要的一个例子：

```
(deftemplate Eyes
(slot colorOfEye (type STRING))
(slot ShapeOfEye (type STRING)))
(deftemplate Person 
(slot eye (type Eyes))
)
(deffacts People
(Person (eye ....))
)
(reset) 
```

定义人模板不是这样工作的，我不知道如何定义事实

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T21:49:37.673

您必须将它们都定义为单独的模板。然后您可以`fact-id`在主事实中存储“子事实”的任何一个或其他标识符，然后使用该值将主事实模式与“子事实”模式连接起来：

```
(defrule blue-eyed-person
    (person (name ?name) (eyes ?eyes))
    ?eyes <- (eyes (color blue))
    =>
    (printout t ?name " has blue eyes." crlf)) 
```

或者，

```
(defrule blue-eyed-person
    (person (name ?name) (eyes ?eyes))
    (eyes (id ?eyes) (color blue))
    =>
    (printout t ?name " has blue eyes." crlf)) 
```

首先要创建事实，您可能会说

```
(bind ?eyes (assert (eyes (color blue))))
(assert (person (name Fred) (eyes ?eyes))) 
```

# iphone - 为什么黑色半透明 UIToolbar 的顶部与黑色半透明 UISearchBar 不同，如何使它们看起来相同？

> ID：10323025
> 
> 赞同：0
> 
> 时间：2012-04-25T20:11:41.073
> 
> 标签：iphone, ios, uisearchbar, uitoolbar

当我将 UIToolbar 添加到 XIB 中的视图时，将其设为黑色半透明样式（而不是不透明），它的顶部有一个 2 像素的黑色描边。同时，黑色半透明样式、非不透明 UISearchBar 在顶部有一个 1 像素的黑色描边。它们都位于同一个位置（向下 44 像素，位于导航栏的正下方）。

![工具栏与搜索栏](../Images/5777a4346984a97d298a97fd566e5b30.png)

我更喜欢 UIToolbar 上的 1px 黑色描边顶部，以使视图与搜索栏相匹配，并使其与导航栏更加融合。我可以在不继承工具栏的情况下实现这一点吗？例如，有没有办法使用搜索栏并隐藏输入字段？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T20:16:51.403

# 为什么他们不同

它们是不同的，因为*它们的放置方式不同*。工具栏应放置在屏幕*底部，2px 黑色笔触看起来不错。*

例如，查看邮件应用程序 (iPhone)，您可以看到（即使它不是半透明的）工具栏有 2 像素的黑色描边，而搜索栏只有 1 像素的描边。您还可以看到*它们的放置方式*：

*   导航栏下方的搜索栏
*   屏幕底部的工具栏。

# 如何改变它们

*抱歉，这些都不是一个优雅的解决方案。*

## 自己画工具栏

您可以使用 Core Graphics 或 CAGradientLayer 自己绘制整个视图。这会很麻烦，但你可以让它看起来像你喜欢的那样。

## 剪辑笔画的顶部

您可以将工具栏放置在 43px 视图中并设置`clipsToBounds`为`YES`. 通过将工具栏定位在`(0, -1)`笔划的第一个点/像素处，将被剪裁并且不会显示。工具栏将小一像素（高度 = 43），因此您必须将超级视图高度设置为 44 像素，工具栏高度设置为 45 像素（仍为 (0,-1)）以使其再次变为 44 像素。这将稍微改变渐变，因此最终结果将具有一些其他视觉效果，而不仅仅是移除描边的顶部像素。

# iphone - 在服务器端从 iPhone 验证 Twitter 登录

> ID：10323026
> 
> 赞同：7
> 
> 时间：2012-04-25T20:11:46.370
> 
> 标签：iphone, ios, authentication, twitter, verification

好的，所以我目前通过以下方式在我的应用中实现了 Facebook 登录：

我使用官方的FB框架来登录用户。当我登录时，我会得到一个身份验证令牌，该令牌会发送到我的服务器。然后我对用户进行另一次验证（例如，使用身份验证令牌从 Facebook 获取“我”），然后返回 32 字符随机密钥，用于在后续 API 调用（到我的服务器）中识别用户。[一个例子](https://stackoverflow.com/questions/4623974/design-for-facebook-authentication-in-an-ios-app-that-also-accesses-a-secured-we)。

我试图弄清楚如何对 twitter 做同样的事情，但我不明白如何在 iOS 中获取 oath 令牌？我的服务器端部分在另一个应用程序中工作，但没有要验证的令牌......

请建议——这是（FB方式）我应该怎么做，或者你将如何进行验证过程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-15T16:28:45.990

Sean Cook，工程师@Twitter 有一个[github 存储库](https://github.com/seancook/TWReverseAuthExample)，其中包含一个简单的应用程序，可以完全按照您的要求执行操作，我在我的应用程序中使用了这段代码，它就像一个魅力。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-14T18:33:17.643

[dev.twitter.com](https://dev.twitter.com/docs/ios/using-reverse-auth)上有一篇很好的文章准确地描述了这一点。基本上，您必须首先通过将`x_auth_mode`参数设置为值来获取特殊请求令牌`reverse_aut`，然后通过将您在第一步中获得的内容发送为`x_reverse_auth_parameters`.

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-07-11T03:36:42.677

如果您要寻求`iOS 5`解决方案，可以将其导入头文件

```
 #import < Twitter/TWTweetComposeViewController.h > 
```

然后在`.m`要进行身份验证的文件中

```
if ([TWTweetComposeViewController canSendTweet])
{

            TWTweetComposeViewController* twc = [[TWTweetComposeViewController alloc] init];
            [twc addImage:uiImage
            [self presentModalViewController:twc animated:YES];
            twc.completionHandler = ^(TWTweetComposeViewControllerResult result) 
            {

                if (result == TWTweetComposeViewControllerResultCancelled)
                    NSLog(@"Tweet compostion was canceled.");
                else if (result == TWTweetComposeViewControllerResultDone)
                    NSLog(@"Tweet composition completed.");

                // Dismiss it
                [self dismissModalViewControllerAnimated:YES];
            };
            [twc release];
        } else
        {
            //can't tweet

        } 
```

您还可以添加 URL、文本和其他类型的信息。

编辑：您可以在此处找到有关将所需库添加到项目的教程， [https://dev.twitter.com/docs/ios/how-add-twitter-framework-your-ios-project](https://dev.twitter.com/docs/ios/how-add-twitter-framework-your-ios-project)

# css - 线性梯度等效于 moz-线性梯度

> ID：10323031
> 
> 赞同：0
> 
> 时间：2012-04-25T20:12:07.680
> 
> 标签：css

我想替换以下 Mozilla 特定的 CSS 规则：

```
background: -moz-linear-gradient(center top , #F5F5F5, #E4E4E4); 
```

使用使用标准的等效规则`linear-gradient`。换句话说，我怎样才能完成以下规则，使其具有与上述规则相同的效果（在 Firefox 中）

```
background: linear-gradient /* what goes here? */ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T20:18:35.153

这就是我处理所有浏览器的所有渐变的方式，我希望这会有所帮助；

```
background: -moz-linear-gradient(top,  rgba(0,0,0,0.65) 0%, rgba(0,0,0,0) 100%); /* FF3.6+ */
background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(0,0,0,0.65)), color-stop(100%,rgba(0,0,0,0))); /* Chrome,Safari4+ */
background: -webkit-linear-gradient(top,  rgba(0,0,0,0.65) 0%,rgba(0,0,0,0) 100%); /* Chrome10+,Safari5.1+ */
background: -o-linear-gradient(top,  rgba(0,0,0,0.65) 0%,rgba(0,0,0,0) 100%); /* Opera 11.10+ */
background: -ms-linear-gradient(top,  rgba(0,0,0,0.65) 0%,rgba(0,0,0,0) 100%); /* IE10+ */
background: linear-gradient(top,  rgba(0,0,0,0.65) 0%,rgba(0,0,0,0) 100%); /* W3C */
filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#a6000000', endColorstr='#00000000',GradientType=0 ); /* IE6-9 */ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T20:24:40.727

如果您遇到一些困难或只是为了加快进程，您也可以使用一些梯度生成器。
**示例**： http:
[//www.colorzilla.com/gradient-editor/](http://www.colorzilla.com/gradient-editor/)
[http://westciv.com/tools/gradients/](http://westciv.com/tools/gradients/)
[http://gradients.glrzad.com/](http://gradients.glrzad.com/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T20:44:27.197

`center`不是线性梯度规范的一部分。（我不知道为什么它被忽略而不是 CSS 错误。）然而，据我所知，Firefox 支持的最新语法`-moz-linear-gradient(to bottom, #F5F5F5, #E4E4E4);`尚未达到 CR 状态，所以这仍然可能会改变。

# flash - flex/flash/actionscript 中的水平触摸板 scolling

> ID：10323033
> 
> 赞同：0
> 
> 时间：2012-04-25T20:12:20.787
> 
> 标签：flash, apache-flex, actionscript

我有一个比我的屏幕还大的可换肤容器。我想让滚动条不可见 - 这很有效 - 并进一步使用鼠标滚轮和触摸板进行水平和垂直滚动。MOUSE_WHEEL 鼠标事件非常适合垂直滚动，由鼠标滚轮和触摸板垂直移动触发。我无法收听水平触摸板滚动事件。有没有官方的方法可以这样做或变通？

编辑：我在此页面上找到了一个自定义公共课程：http: [//blog.hiraash.org/2010/08/09/finally-touchpad-and-mouse-wheel-scrolling-for-your-flash-application/](http://blog.hiraash.org/2010/08/09/finally-touchpad-and-mouse-wheel-scrolling-for-your-flash-application/)。不幸的是，直到现在我才能让它工作。同样，我仍然不确定是否有必要进行此 hack。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T20:59:44.833

取决于硬件和操作系统版本，但您可以尝试多点触控手势事件：http: [//help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/ui/Multitouch.html#supportedGestures](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/ui/Multitouch.html#supportedGestures)

这是一个很好的开端：http: [//lucamezzalira.com/2009/12/02/multitouch-with-actionscript-3-and-air-2-0/](http://lucamezzalira.com/2009/12/02/multitouch-with-actionscript-3-and-air-2-0/)

但它可能仅适用于触摸板并且仅适用于新设备。

# javascript - Ajax 在 IE 8/9 中提取缓存页面，但在 FF 中工作正常

> ID：10323035
> 
> 赞同：0
> 
> 时间：2012-04-25T20:12:30.033
> 
> 标签：javascript, ajax, internet-explorer

这很奇怪——我的 ajax 调用返回缓存在 IE 中，而它们在 FF 中的行为正常；任何想法为什么？

```
function createRequestObject(){
    var req;
    if(window.XMLHttpRequest){
        //For Firefox, Safari, Opera
        req = new XMLHttpRequest();
    }
    else if(window.ActiveXObject){
        //For IE 5+
        req = new ActiveXObject("Microsoft.XMLHTTP");
    }
    else{
        //Error for an old browser
        alert('Your browser is not IE 5 or higher, or Firefox or Safari or Opera');
    }
    //alert (req);
    return req;
}

//Make the XMLHttpRequest Object
var http = createRequestObject();      

var head;

function sendRequestTwo(method, url, head1){
    head = head1
    if(method == "get" || method == "GET"){
        http.open(method,url);
        http.onreadystatechange = handleResponseTwo;
        http.send(null);
            }
}

function handleResponseTwo(){
    if(http.readyState == 4 && http.status == 200){
        var response = http.responseText;
        if(response){  
            document.getElementById(head).innerHTML = response;
            //window.scrollBy(0, 200);
        }
    }      
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T20:21:09.133

我有同样的问题。IE 可以非常积极地缓存。

尝试在您的网址中添加时间戳：

```
url += '?ts=' + new Date().getTime(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T20:20:18.073

IE 积极缓存 ajax - 添加具有日期或其他唯一内容的查询字符串以防止它发生。

# python - 从列表中创建实例名称 (Python)

> ID：10323040
> 
> 赞同：3
> 
> 时间：2012-04-25T20:12:59.157
> 
> 标签：python

我有一个函数可以构建随机数量的对象实例。为了演示总体思路，我们将假设这是一种构建一系列类似 nethack 的房间的算法。

要求是这样的，我不会提前知道会有多少实例；这些是随机和即时生成的。

作为一个简短的说明：我完全意识到以下代码是非功能性的，但它应该（希望！）证明我的目标。

```
import random

class Levelbuild(object):

    def __init__(self):
        self.l1 = dict({0:'a',1:'b',2:'c',3:'d',4:'e',5:'f',6:'g',7:'h',8:'i'})
        # Pick a random number between 4 and 9.
        for i in range(random.randint(4,9)):
            self.l1[i] = Roombuilder() 
```

如果我们假设选择的随机整数是 5，理想的结果是 5 个 Roombuilder() 实例；分别标记为 a、b、c、d 和 e。

有没有一种简单的方法可以做到这一点？这个时期有办法吗？

- 编辑 -

对 Nick ODell 的回答表示巨大的“谢谢”。这不是完整的复制/粘贴——但它是一种适合我需要的变体；

```
import random

class Room(object):
    def __init__(self):
        self.size = (5,5)

class Level(object):

    def __init__(self):
        roomnames = ['a','b','c','d','e','f','g','h','i']
        self.rooms = {}
        for i in range(random.randint(4, 9)):
            self.rooms[roomnames[i]] = Room() 
```

与其手工建造每个“房间”，我现在可以...

```
test = Level()
print test.rooms['a'].size
>>> (5,5) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T20:21:03.207

```
import string
import random

class Levelbuild(object):

  def __init__(self,min_room_count,max_room_count):

    rooms_temp = [new RoomBuilder() for i in range(random.randint(min_room_count,max_room_count))]
    self.l1 = dict(zip(string.ascii_lowercase, rooms_temp)) 
```

注意：如果给定超过 26 个房间，这将静默失败。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T20:17:23.970

事实上，你已经很接近了。你不需要听写；只需使用一个列表。（而且，顺便说一句，`{...}`已经是一个 dict，所以将它包装进去`dict()`并没有任何作用。）

```
roomnames = ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i']
self.rooms = []
for i in range(random.randint(4, 9)):
    self.rooms.append(Roombuilder(roomnames[i])) 
```

对于它的价值，`builder`输入一个类的名称有点时髦。对象是房间，对吧？所以类型应该只是`Room`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T20:32:48.740

作为更通用解决方案的另一个答案（主要作为[Nick ODell 的答案](https://stackoverflow.com/a/10323136/722121)的伴侣，如果您想处理任意数量的名称，这是一个非常简单的无限生成器解决方案：

```
import string
import itertools

def generate_names(characters):
    for i in itertools.count(1):
        for name in itertools.product(characters, repeat=i):
            yield "".join(name) 
```

然后，您可以像使用任何其他生成器一样使用它：

```
>>>print(dict(zip(generate_names(string.ascii_lowercase), range(30))))
{'aa': 26, 'ac': 28, 'ab': 27, 'ad': 29, 'a': 0, 'c': 2, 'b': 1, 'e': 4, 'd': 3, 'g': 6, 'f': 5, 'i': 8, 'h': 7, 'k': 10, 'j': 9, 'm': 12, 'l': 11, 'o': 14, 'n': 13, 'q': 16, 'p': 15, 's': 18, 'r': 17, 'u': 20, 't': 19, 'w': 22, 'v': 21, 'y': 24, 'x': 23, 'z': 25} 
```

如果您需要生成实际*名称*，那么您有几个选择。如果您需要一个真实的单词，请从字典文件中挑选（大多数 Linux 用户都有一个`/usr/share/dict`）。如果你需要类似单词的东西，那么我实际上已经编写[了一个 Python 脚本来使用 Markov Chains 生成这样的“单词”](http://www.lattyware.co.uk/projects/wordgenerator)，它在 GPL 下可用。自然，您必须检查这些的唯一性。

# visual-c++ - 如何通过按下按钮 vc++ 摆脱文本框？

> ID：10323044
> 
> 赞同：0
> 
> 时间：2012-04-25T20:13:27.570
> 
> 标签：visual-c++

如何通过按下 vc++ 2008 中的按钮来完全删除（销毁）文本框（不删除其中的文本）？Windows 窗体应用程序，我创建了 textBox1，并且我希望该文本框在用户点击某个按钮时消失（不是通过使用可见功能，我希望它被破坏）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T20:32:05.223

我假设您正在谈论 C++/CLR 应用程序。如果是这种情况，您需要使您的控件不可见，并将其从容器表单的控件集合中删除（并将 NULL 分配给指向它的任何其他变量......）。

您的代码应如下所示：

```
private: System::Void button1_Click(System::Object^  sender, System::EventArgs^  e) {
             this->textBox1->Visible = false;
             this->Controls->Remove(this->textBox1);
             this->textBox1 =  nullptr; // if you do not have any other reference to this object, it should be disposed eventually by garbage collection
         } 
```

# linux - 如何以编程方式或通过命令行（linux）设置歌曲的“专辑艺术家”

> ID：10323046
> 
> 赞同：8
> 
> 时间：2012-04-25T20:13:31.283
> 
> 标签：linux, perl, audio, command-line, metadata

有多种命令行工具可用于编辑音频文件的元数据。但他们都不能编辑音频文件的“专辑艺术家”标签。是否有任何命令行工具或 perl 模块可以做同样的事情？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T22:33:07.597

`mid3v2`附带[诱变剂](http://code.google.com/p/mutagen/)库，是我所知道的用于此目的的最佳命令行工具。当使用`-f`参数调用时，`TPE2`标记被列为支持。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-25T21:05:45.877

MP3::Tag 支持。

```
#!/usr/bin/perl

use MP3::Tag;

$mp3 = MP3::Tag->new($filename);
$mp3->new_tag("ID3v2");
$mp3->{ID3v2}->add_frame("TALB", "Album title");
$mp3->{ID3v2}->add_frame("TPE2", "Album artist");
$mp3->{ID3v2}->write_tag;
$mp3->close(); 
```

或者

```
#!/usr/bin/perl

use MP3::Tag;

$mp3 = MP3::Tag->new($filename);
$mp3->select_id3v2_frame_by_descr('TPE2', 'album artist'); # Edit in memory
$mp3->update_tags(); # commit
$mp3->close(); 
```

# visual-studio-2010 - 将 TFS 工作文件夹移动到网络共享

> ID：10323047
> 
> 赞同：1
> 
> 时间：2012-04-25T20:13:33.763
> 
> 标签：visual-studio-2010, tfs

我们的 IT 人员告诉我们（开发组），我们不会在本地硬盘驱动器上存储任何文件，包括我们的 TFS 工作文件夹。由于各种原因，这很荒谬，但在我确信这是一个好主意之前，我会继续努力，当没有人在寻找时，制作一个本地工作文件夹。

有没有人在网络共享上有他们的工作文件夹？效果如何？每个开发人员在共享中都有自己的文件夹，但它会在网络上。我主要关心的是性能，我们需要始终保持联系才能工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T20:24:52.207

从 TFS 的角度来看，它可以正常工作，但要远离 TFS/VS11 的本地工作区。

从编译的角度来看，我对您有强烈的感觉，编译存储在网络上的解决方案在性能方面绝对是一场灾难。

您没有提到它，但我假设您的网络共享使用网络驱动器。

顺便说一句，我能知道为什么这些人不希望你在本地存储文件吗？

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-25T21:43:33.120

虽然这不是我通常会推荐的东西，但如果这是政策并且您必须遵守它，那么考虑简单地让您的开发人员 RDP 进入服务器端开发 VM 可能是值得的。我以前见过公司这样做，最大的缺点是如果您没有连接到网络，您将无能为力。

不过也有一些好处。由于虚拟化基础架构，能够轻松增加资源（RAM、磁盘空间、CPU 等）。如果某人的笔记本电脑死机了，他们并没有受到委托，只需在他们的 VM 中找到一台借用机器和 RDP，它们就会启动并运行。如果有人离开，您将拥有他们的整个工作机器的副本，您可以将其提供给他们的替代品。所有机器都可以轻松备份。等等。一般来说，在 VS 中编译和工作应该比尝试使用本地 Visual Studio 读取/写入网络驱动器要快得多。

# ruby - Page Objects中元素的接口应该抽象多少？

> ID：10323053
> 
> 赞同：1
> 
> 时间：2012-04-25T20:14:10.907
> 
> 标签：ruby, cucumber, watir-webdriver, pageobjects

我有一个名为 LineItemsPage 的页面对象

```
class LineItemsPage
  attr_accessor :add_line_item_button

  def initialize(test_env)
    @browser              = test_env[:browser]
    @action_bar           = @browser.div(:id => 'lineitems_win').div(:class => 'window-body').div(:class => 'actionbar')
    @add_line_item_button = @action_bar.img(:class => 'button add')
  end

  def method_missing(sym, *args, &block)
    @browser.send sym, *args, &block
  end

end 
```

我像这样使用它：

```
When /^I click on Add Item and enter the following values:$/ do |table|
  @line_items_page = LineItemsPage.new(@test_env)
  @line_items_page.add_line_item_button.when_present.click
end 
```

我想知道是否应该通过在我的 LineItemsPage 类中添加以下内容来抽象点击：

```
def add_item
  self.add_line_item_button.when_present.click
end 
```

然后像这样使用它：

```
@line_items_page.add_item 
```

我正在寻找最佳实践，特别是关于页面对象或一般的 Ruby。我觉得通过 using 封装接口`add_item()`有点远，但我想知道我是否不知道如果我不这样做可能会遇到问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T16:43:38.323

就个人而言，我尝试让我的页面对象方法使用领域语言，而不参考实现。

我曾经做过类似的事情`@line_items_page.add_line_item_button.when_present.click`，但是它在以下情况下引起了问题：

1) 添加行项目从按钮更改为链接。

2) 添加行项目的过程发生了变化 - 比如说现在通过右键单击完成，或者它已成为一个两步过程（例如打开一些下拉菜单，然后单击添加行）。

无论哪种情况，您都必须找到添加订单项的所有位置并更新它们。如果您在`add_item`页面对象方法中拥有所有逻辑，则只需更新一个地方。

从实现的角度来看，我发现 Cheezy 的页面对象访问器工作得很好。但是，对于图像按钮（或任何应用程序的自定义控件），我会在[PageObject::Accessors 模块](https://github.com/cheezy/page-object/blob/master/lib/page-object/accessors.rb)中添加其他方法。或者，如果它们是一次性控件，您可以将方法直接添加到特定页面对象。

**更新**- 回复关于一些起点的评论：

我没有遇到太多文档，但这里有几个链接可能会有所帮助：

1) [Cheezy Page Object 项目 wiki](https://github.com/cheezy/page-object/wiki/page-object) - 给出一个简单的例子来开始

2) [Cheezy 的博客文章](http://www.cheezyworld.com/2010/12/16/ui-tests-putting-it-all-together/)，页面对象 gem 首次开始的地方。请注意，这里的内容可能与 gem 当前的实现方式并不完全一致，但我认为它为理解他想要实现的目标提供了良好的基础。当您必须打开并修改 gem 以满足您的需要时，这反过来又使您更容易理解正在发生的事情。

# .net - ASP.Net 4 中的 ThreadAbortException 泄漏文件句柄？

> ID：10323058
> 
> 赞同：3
> 
> 时间：2012-04-25T20:14:45.487
> 
> 标签：.net, multithreading, exception-handling, thread-safety, resource-leak

有时，如果我们的文件服务器很慢并且页面在超时之前没有完成，ASP.Net 会使用 ThreadAbortException 对其进行处理。如果这种情况发生在 Win32Native.CreateFile 中，它将使文件句柄处于锁定状态，直到我们执行 iisreset。

这是 .NET 中的缺陷吗？我们能做些什么来解决这个糟糕的想法，比如将超时时间提高到某个巨大的数字......我认为 ThreadAbort.Reset 不会有帮助，因为损坏已经完成，我什至没有返回文件句柄从 FileStream 自己关闭它。

* * *

在 Microsoft.Win32.Win32Native.CreateFile（字符串 lpFileName，Int32 dwDesiredAccess，FileShare dwShareMode，SECURITY_ATTRIBUTES securityAttrs，FileMode dwCreationDisposition，Int32 dwFlagsAndAttributes，IntPtr hTemplateFile）

在 Microsoft.Win32.Win32Native.SafeCreateFile（字符串 lpFileName，Int32 dwDesiredAccess，FileShare dwShareMode，SECURITY_ATTRIBUTES securityAttrs，FileMode dwCreationDisposition，Int32 dwFlagsAndAttributes，IntPtr hTemplateFile）

在 System.IO.FileStream.Init（字符串路径、FileMode 模式、FileAccess 访问、Int32 权限、Boolean useRights、FileShare 共享、Int32 bufferSize、FileOptions 选项、SECURITY_ATTRIBUTES secAttrs、String msgPath、Boolean bFromProxy、Boolean useLongPath）

在 System.IO.FileStream..ctor（字符串路径，FileMode 模式，FileAccess 访问，FileShare 共享，Int32 bufferSize，FileOptions 选项，字符串 msgPath，布尔 bFromProxy）

在 System.IO.FileStream..ctor（字符串路径，FileMode 模式）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-30T19:29:32.243

看起来您也向 Microsoft Connect 提交了这个问题，但没有在此处更新他们的答案：

[http://connect.microsoft.com/VisualStudio/feedback/details/739044/threadabortexception-in-asp-net-4-during-new-filestream-leaking-file-handle](http://connect.microsoft.com/VisualStudio/feedback/details/739044/threadabortexception-in-asp-net-4-during-new-filestream-leaking-file-handle)

以下是微软的回复：

> 不建议在 ASP.NET 中的同步请求中执行长时间运行的操作。如果您达到超时期限，您可以选择简单地增加配置的请求超时或更改为使用异步请求，异步操作执行期间不会超时，因此不会引发线程中止异常。

我猜线程中止（或任何异步异常），最终可以并且将会这样做。

但似乎框架将`SafeFileHandle`在内部使用打开文件，所以当它悠闲地处理它时，它应该被垃圾收集器关闭。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-03T02:46:41.273

`finally`您是否通过在子句中关闭或使用该方法在代码中正确关闭文件`using`？

# c - 在 C 中使用 stat(2) 打印文件权限，如“ls -l”

> ID：10323060
> 
> 赞同：20
> 
> 时间：2012-04-25T20:15:20.527
> 
> 标签：c, stat

我正在尝试编写一个模拟 unix 命令的小型 C 程序 `ls -l`。为此，我正在使用`stat(2)`系统调用并且在编写权限时遇到了一个小问题。我有一个`mode_t`变量来保存来自 的文件权限`st_mode`，并且不难将该值解析为 s 字符串表示形式，但我只是想知道是否有比这更好的方法。

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2012-04-25T20:20:16.587

来自谷歌的例子

```
#include <unistd.h>
#include <stdio.h>
#include <sys/stat.h>
#include <sys/types.h>

int main(int argc, char **argv)
{
    if(argc != 2)    
        return 1;

    struct stat fileStat;
    if(stat(argv[1], &fileStat) < 0)    
        return 1;

    printf("Information for %s\n", argv[1]);
    printf("---------------------------\n");
    printf("File Size: \t\t%d bytes\n", fileStat.st_size);
    printf("Number of Links: \t%d\n", fileStat.st_nlink);
    printf("File inode: \t\t%d\n", fileStat.st_ino);

    printf("File Permissions: \t");
    printf( (S_ISDIR(fileStat.st_mode)) ? "d" : "-");
    printf( (fileStat.st_mode & S_IRUSR) ? "r" : "-");
    printf( (fileStat.st_mode & S_IWUSR) ? "w" : "-");
    printf( (fileStat.st_mode & S_IXUSR) ? "x" : "-");
    printf( (fileStat.st_mode & S_IRGRP) ? "r" : "-");
    printf( (fileStat.st_mode & S_IWGRP) ? "w" : "-");
    printf( (fileStat.st_mode & S_IXGRP) ? "x" : "-");
    printf( (fileStat.st_mode & S_IROTH) ? "r" : "-");
    printf( (fileStat.st_mode & S_IWOTH) ? "w" : "-");
    printf( (fileStat.st_mode & S_IXOTH) ? "x" : "-");
    printf("\n\n");

    printf("The file %s a symbolic link\n", (S_ISLNK(fileStat.st_mode)) ? "is" : "is not");

    return 0;
} 
```

结果：

```
2.c 的信息
--------------------------
文件大小：1223 字节
链接数：1
文件索引节点：39977236
文件权限：-rw-r--r--

该文件不是符号链接
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-04-25T20:20:31.717

基础很简单；棘手的位是 SUID 和 SGID 位以及修改“x”位的粘性位。考虑将权限拆分为用户、组、所有者的 3 个八进制数字，并使用这些数字来索引 3 个字符的字符串数组，例如`rwx`和`---`。`x`然后根据其他模式位调整适当的位。文件类型必须单独处理，但您可以使用 12 位右移（可能带有屏蔽）和 16 条目表来处理 16 个可能的值（并非所有这些值在任何给定系统上都有效） . 或者您可以处理已知类型，如下面的代码所示。

```
+----+---+---+---+---+
|type|SSS|USR|GRP|OTH|
+----+---+---+---+---+ 
```

4 种类型位，三个 S 位（setuid、setgid、sticky）和用户、组和其他位。

这是我用于转换`mode_t`为字符串的代码。它是为一个很好的无线程程序编写的，所以它使用静态数据；修改它以将输出字符串作为输入参数将是微不足道的：

```
/* Convert a mode field into "ls -l" type perms field. */
static char *lsperms(int mode)
{
    static const char *rwx[] = {"---", "--x", "-w-", "-wx",
    "r--", "r-x", "rw-", "rwx"};
    static char bits[11];

    bits[0] = filetypeletter(mode);
    strcpy(&bits[1], rwx[(mode >> 6)& 7]);
    strcpy(&bits[4], rwx[(mode >> 3)& 7]);
    strcpy(&bits[7], rwx[(mode & 7)]);
    if (mode & S_ISUID)
        bits[3] = (mode & S_IXUSR) ? 's' : 'S';
    if (mode & S_ISGID)
        bits[6] = (mode & S_IXGRP) ? 's' : 'l';
    if (mode & S_ISVTX)
        bits[9] = (mode & S_IXOTH) ? 't' : 'T';
    bits[10] = '\0';
    return(bits);
}

static int filetypeletter(int mode)
{
    char    c;

    if (S_ISREG(mode))
        c = '-';
    else if (S_ISDIR(mode))
        c = 'd';
    else if (S_ISBLK(mode))
        c = 'b';
    else if (S_ISCHR(mode))
        c = 'c';
#ifdef S_ISFIFO
    else if (S_ISFIFO(mode))
        c = 'p';
#endif  /* S_ISFIFO */
#ifdef S_ISLNK
    else if (S_ISLNK(mode))
        c = 'l';
#endif  /* S_ISLNK */
#ifdef S_ISSOCK
    else if (S_ISSOCK(mode))
        c = 's';
#endif  /* S_ISSOCK */
#ifdef S_ISDOOR
    /* Solaris 2.6, etc. */
    else if (S_ISDOOR(mode))
        c = 'D';
#endif  /* S_ISDOOR */
    else
    {
        /* Unknown type -- possibly a regular file? */
        c = '?';
    }
    return(c);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-06-16T04:12:01.883

我不喜欢`if/ else if`语法。

我更喜欢使用`switch`语句。经过一番挣扎后，我找到了使用不同宏的方法，例如：

```
S_ISCHR (mode) 
```

相当于：

```
((mode & S_IFMT) == S_IFCHR) 
```

这使我们可以像这样构建一个 switch 语句：

```
char f_type(mode_t mode)
{
    char c;

    switch (mode & S_IFMT)
    {
    case S_IFBLK:
        c = 'b';
        break;
    case S_IFCHR:
        c = 'c';
        break;
    case S_IFDIR:
        c = 'd';
        break;
    case S_IFIFO:
        c = 'p';
        break;
    case S_IFLNK:
        c = 'l';
        break;
    case S_IFREG:
        c = '-';
        break;
    case S_IFSOCK:
        c = 's';
        break;
    default:
        c = '?';
        break;
    }
    return (c);
} 
```

在我看来，这比这种`if/else if`方法更优雅一些。

# iphone - 如何在监控核心数据时复制 NSFetchedResultsController 正在做的事情？

> ID：10323063
> 
> 赞同：3
> 
> 时间：2012-04-25T20:15:34.667
> 
> 标签：iphone, ios, core-data, ios5, nsfetchedresultscontroller

我有一个模型可以处理核心数据，我目前使用 NSFetchedResultsController 在核心数据发生变化时获得通知。我不是从这个驱动 UITableView 的，获取结果控制器的 API 有点尴尬。我想用更简单的东西代替它。我的问题是，NSFetchedResultsController 如何监听 Co​​re Data 的变化，以及如何在更好的 API 后面复制它？我正在使用 iOS 5+

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T20:55:11.137

看起来，至少，[您可以从您的 MOC 收到通知，](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/CoreDataFramework/Classes/NSManagedObjectContext_Class/NSManagedObjectContext.html)如下所示：

```
Core Data uses these string constants as keys in the user info dictionary in aNSManagedObjectContextObjectsDidChangeNotification notification.

NSString * const NSInsertedObjectsKey;
NSString * const NSUpdatedObjectsKey;
NSString * const NSDeletedObjectsKey;
NSString * const NSRefreshedObjectsKey;
NSString * const NSInvalidatedObjectsKey;
NSString * const NSInvalidatedAllObjectsKey; 
```

作为一种方法，也许您可​​以从存根您希望 Apple 提供给我们的完整协议开始，然后根据需要添加实现和小测试。

# c# - Linq to SQL 多个条件 where 子句

> ID：10323066
> 
> 赞同：10
> 
> 时间：2012-04-25T20:16:09.847
> 
> 标签：c#, sql, linq

目前我正在检索我的结果如下：

```
public List<claim> GetClaims()
{
    return _db.claims.OrderBy(cl => cl.claimId).ToList();
} 
```

但是现在我正在尝试根据我的列表视图上方的过滤器添加多达 8 个条件 where 子句。

于是我变成了：

```
public List<claim> GetFilteredClaims(string submissionId, string claimId,
                                     string organization, string status,
                                     string filterFromDate, string filterToDate,
                                     string region, string approver)
{
    return _db.claims.Where(cl => cl.submissionId == 5).ToList();
} 
```

如何检查每个过滤器以仅在它们包含值时添加 where 子句？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-04-25T22:14:45.750

您没有理由不能通过`.Where`多次调用来继续过滤结果。由于 LINQ to SQL 的延迟执行，它将全部在一个 SQL 语句中执行：

```
public List<claim> GetFilteredClaims(string submissionId, string claimId,
                                     string organization, string status,
                                     string filterFromDate, string filterToDate,
                                     string region, string approver)
{
    IQueryable<claim> filteredClaims = _db.claims;

    if (!string.IsNullOrWhiteSpace(submissionId))
    {
        filteredClaims = filteredClaims.Where(claim => claim.submissionId == submissionId);
    }

    if (!string.IsNullOrWhiteSpace(claimId))
    {
        filteredClaims = filteredClaims.Where(claim => claim.claimId == claimId);
    }

    ...

    return filteredClaims.ToList();
} 
```

如果您需要添加 OR 条件，可以查看[PredicateBuilder](http://www.albahari.com/nutshell/predicatebuilder.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T20:30:02.380

您可以使用 OR 空条件对每个过滤器选项进行分组，并使用 AND 将它们全部链接在一起，如下所示：

```
public List<claim> GetFilteredClaims(string submissionId, string claimId, string organization, string status, string filterFromDate, string filterToDate, string region, string approver)
    {
        return _db.claims
            .Where(cl => (cl.submissionId == submissionId || submissionId == null)
            && (cl.claimId == claimId || claimId == null)
            && so on and so on... ).ToList();

    } 
```

因此，如果 submitId == null 和 claimId == "123"，它只会过滤 claimId 上的结果。您可以将每个替换`null`为空字符串或任何您的“无价值”条件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T22:50:42.707

看看 LINQKIT [http://www.albahari.com/nutshell/linqkit.aspx](http://www.albahari.com/nutshell/linqkit.aspx) 它将允许您构建谓词

这是我使用的代码，但阅读了上面的文档。谓词将允许您链接一堆 OR 或 AND 或它们的组合。

```
private static IEnumerable<SurveyResult> filterData(string firstName, string lastName, List<SurveyResult> results)
{
    var predicate = PredicateBuilder.True<SurveyResult>();

    IEnumerable<SurveyResult> a;
    if (excludeBadData)

    if (firstName != string.Empty)
    {
        predicate = predicate.And(p => p.User.FirstName.ToLower().Contains(firstName.ToLower()));
    }

    if (lastName != string.Empty)
    {
        predicate = predicate.And(p => p.User.LastName.ToLower().Contains(lastName.ToLower()));
    }

    a = from r in results.AsQueryable().Where(predicate) select r;
    return a;
} 
```

# android - 找不到类 oauth.signpost.commonshttp.CommonsHttpOAuthConsumer

> ID：10323069
> 
> 赞同：0
> 
> 时间：2012-04-25T20:16:15.293
> 
> 标签：android, oauth, signpost

我昨天必须格式化并重新开始，我正试图让我的项目重新启动并运行。

我使用路标库进行 OAuth 身份验证。我已经导入了我的项目，Eclipse 在文本编辑器中没有给我任何错误。但是，当我运行我的应用程序并点击 oauth 代码时，我的应用程序会出现以下错误：

```
04-25 15:07:04.485: E/dalvikvm(344): Could not find class 'oauth.signpost.commonshttp.CommonsHttpOAuthConsumer', referenced from method com.myapp.app.ws.WebService.addHeaders 
```

该项目似乎找到了 jar 文件就好了。它们显示在 Java Build Path -> Libraries 选项卡中。

我不确定我在这里缺少什么。想法？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-25T20:29:01.040

我的猜测是这个错误与 ADT 17 有关。它现在应该将 jar 放入 libs 文件夹中。如果您不这样做，请转到`configure build path`-> `Order and Export`。单击 jar 的复选框。

# c# - 两个字符串数组的交集（忽略大小写）

> ID：10323071
> 
> 赞同：48
> 
> 时间：2012-04-25T20:16:30.577
> 
> 标签：c#, .net, linq, intersection

我有两个数组：

```
string[] array1 = { "Red", "blue", "green", "black" };
string[] array2 = { "BlUe", "yellow", "black" }; 
```

我只需要一个数组中的匹配字符串（忽略大小写）。

结果应该是：

```
string[] result = { "blue", "black" } or { "BlUe", "black" }; 
```

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2012-04-25T20:17:56.260

[`Enumerable.Intersect`](http://msdn.microsoft.com/en-us/library/bb355408.aspx)一个和[`StringComparer`](http://msdn.microsoft.com/en-us/library/system.stringcomparer_properties.aspx)组合怎么样：

```
// other options include StringComparer.CurrentCultureIgnoreCase
// or StringComparer.InvariantCultureIgnoreCase
var results = array1.Intersect(array2, StringComparer.OrdinalIgnoreCase); 
```

# jquery - 加载资源失败 - 服务器在 Rails 3 项目中以 404 状态错误响应

> ID：10323073
> 
> 赞同：1
> 
> 时间：2012-04-25T20:16:33.827
> 
> 标签：jquery, ruby-on-rails, ruby-on-rails-3

我正在尝试在我的应用程序中加载 jquery masonry 脚本，但它不起作用。

调试时，我看到此错误：

```
Failed to load resource: the server responded with a http://localhost:3000/app/assets/javascripts/jquery.masonry.min.js status of 404 (Not Found) 
```

如果我尝试通过链接[http://localhost:3000/app/assets/javascripts/jquery.masonry.min.js](http://localhost:3000/app/assets/javascripts/jquery.masonry.min.js)直接从浏览器访问脚本，我会收到此错误：

```
No route matches [GET] "/Users/fkhalid2008/loand/app/assets/javascripts/jquery.masonry.min.js" 
```

我在这里做错了什么？

下面附上相关代码。

谢谢，

费萨尔

**POSTS>INDEX.HTML.ERB（这是我试图加载 Jquery Masonry 脚本的地方）**

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js"></script>
<script src="/app/assets/javascripts/jquery.masonry.min.js">     
</script>

.....

<script type="text/javascript"> 
$('#container').masonry({
  itemSelector: '.box',
   columnWidth : 120 
});
</script> 
```

**应用程序.JS 文件**

```
//= require jquery
//= require jquery_ujs
//= require jquery.masonry.min
//= require twitter/bootstrap
//= require_tree . 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T22:26:56.300

在处理资产管道时，您只需要告诉 Rails 应用程序该文件在您的资产文件夹中。像：

```
<script src="/assets/jquery.masonry.min.js"></script> 
```

并将 jquery.masonry.min.js 放在 /app/assets/javascripts

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T20:19:59.523

您的 jquery API 源不正确 - 它在本地目录中查找，但看起来好像您正在尝试使用 google API

# javascript - 如何在使用 JQuery 更改 CSS 时添加淡入淡出效果

> ID：10323078
> 
> 赞同：3
> 
> 时间：2012-04-25T20:16:47.937
> 
> 标签：javascript, jquery, css, mobile

对于不支持固定位置的移动浏览器，我正在为移动网站上的页脚伪造固定位置。（iOS 5 之前的 iOS，Andriod 2.2 之前的等等）

这是我正在使用的 JQuery 代码，它运行良好并且可以满足我的要求：

```
function changeFooterPosition() {   
  $('.not-fixed').css('top', window.innerHeight + window.scrollY - 56 + "px");
}

$(document).bind('scroll', function() {
  changeFooterPosition();
}); 
```

所以这行得通。

我的问题是，我想稍微延迟一下，让页脚淡入视野，而不是在每次小滚动后快速捕捉。我环顾四周，发现了以下我可以使用的方法，但我不确定它们是否正确，或者在哪里将它们添加到上面的 js 中。

```
.delay(1000).fadeTo('slow', 1) 
```

我知道 JQuery Mobile 中存在此功能，但我不想将整个 JQuery Mobile 用于这件小事。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T20:22:15.867

你想要做的是限制你的滚动回调：

```
(function() {
  var scrollTimer = 0,
      $notFixed = $('.not-fixed');

  function changeFooterPosition() {   
    $notFixed.css('top', window.innerHeight + window.scrollY - 56 + "px").show(300);
  }

  $(document).bind('scroll', function() {
    $notFixed.hide();
    clearTimeout(scrollTimer);
    setTimeout(changeFooterPosition, 50);
  });
}()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T20:20:09.313

尝试动画功能[http://api.jquery.com/animate/](http://api.jquery.com/animate/)

这不会褪色，但应该平稳移动。

```
function changeFooterPosition() {   
  $('.not-fixed').animate({'top': window.innerHeight + window.scrollY - 56 + "px"}, 2000);
}

$(document).bind('scroll', changeFooterPosition); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T20:20:22.383

改变

```
$(document).bind('scroll', function() {
  changeFooterPosition();
}); 
```

至

```
$(document).bind('scroll', changeFooterPosition); 
```

改变

```
$('.not-fixed').css('top', window.innerHeight + window.scrollY - 56 + "px"); 
```

至

```
var WantedSpeed = 2000;
$('.not-fixed').delay(1000).animate({
    top: window.innerHeight + window.scrollY - 56 + "px"
}, WantedSpeed, function() {
    // Animation complete.
}) 
```

# mysql - mySql 为每个用户选择最后一个条目

> ID：10323082
> 
> 赞同：2
> 
> 时间：2012-04-25T20:17:01.533
> 
> 标签：mysql, greatest-n-per-group

我有两张桌子：

```
users:
user_id    user_name

data:
user_id    user_data    user_time 
```

我想从数据表中选择最新的条目，但返回`user_name, user_id, user_data`and `user_time`。

我尝试了以下查询，但它返回第**一个**条目，而不是每个用户的最后一个条目：

```
sql = "SELECT users.user_name, users.user_id, data.user_data, data.user_time
FROM users 
INNER JOIN data ON data.user_id = users.user_id
GROUP BY users.user_name
ORDER BY data.user_time DESC"; 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-25T20:52:21.997

使用 GROUP BY 和 MAX，WHERE...IN：

```
SELECT u.user_id, u.user_name, d.user_data, d.user_time
FROM users u
    INNER JOIN data d ON d.user_id = u.user_id
WHERE (d.user_id, d.user_time) = 
    (SELECT user_id, MAX(user_time) FROM data GROUP BY user_id) 
```

我认为您最好将`data_id`列添加到数据表中。除非 data_id，否则 user_id 和 user_time 都是必需的`PRIMARY KEY`（并且 user_time 并不总是唯一的，不可靠）

如果有data_id，可能有点简单：

```
SELECT u.user_id, u.user_name, d.user_data, d.user_time
FROM users u
  INNER JOIN data d ON d.data_id =
    (SELECT data_id FROM data
       WHERE user_id = u.user_id ORDER BY data_time DESC LIMIT 1) 
```

# sencha-touch-2 - 如何在 Sencha Touch 2 上设置从右到左的动画过渡？

> ID：10323083
> 
> 赞同：4
> 
> 时间：2012-04-25T20:17:06.110
> 
> 标签：sencha-touch-2

我想在面板上激活卡片时为过渡设置动画。有什么想法吗？

main.setActiveItem(1) 正在更改卡片，但我想为从右到左的过渡设置动画（不是从左到右的默认设置）

我有这个功能：

```
buttonBackImageDetalle: function(button, e, options) {

    var main = this.getMain();
    //Ext.fx.Animation.setDirection('right');
    main.setActiveItem(1);
    console.log('<-- back');

} 
```

谢谢你的时间！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-26T02:07:12.813

试试这个：

`main.animateActiveItem(1, {type: 'slide', direction: 'right'})`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-24T11:03:01.493

嗨，如果您使用控制器，请使用 ref 作为 main 并按如下方式传递视图的 xtype。

```
this.getMain().animateActiveItem(your_xtype, {type: 'slide', direction: 'right'}); 
```

# c# - 如何找到带有 params 参数的方法的用法，以使参数不为空？

> ID：10323086
> 
> 赞同：4
> 
> 时间：2012-04-25T20:17:15.323
> 
> 标签：c#, c#-4.0, reflection, params, il

我有一个方法，它的最后一个参数是`params string[]`. 我希望搜索一个程序集并计算使用`params`至少一个值传递参数的使用次数。

有数百次对该方法的调用，其中大多数都没有将任何内容传递给最后一个`params`参数，因此使用 ReSharper 的 Find Usages 之类的方法并计算那些没有将任何内容传递给`params`参数的用法是不切实际的。

我将如何使用反射/反汇编来做到这一点？或者，有没有可以做到这一点的工具？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-25T20:23:15.610

一种简单的方法：

*   添加一个不带任何参数的重载。
*   重建 - 将优先使用新的`params`重载
*   使用您通常使用的任何重构工具来重命名无参数重载
*   用简单的“查找”计算调用次数
*   放弃所有代码更改:)

# ios - ios 通知“死”对象

> ID：10323087
> 
> 赞同：6
> 
> 时间：2012-04-25T20:17:21.867
> 
> 标签：ios, exc-bad-access, nsnotificationcenter

我有许多 UIViews 进入视野，然后离开视野并未被使用。但是，我相信他们中的一些人即使在他们离开后仍然会收到通知，这会导致问题。

在 UIView“父”容器上：

```
if(self._content != nil && [self._content respondsToSelector:@selector(presentMe:)]) {
    [self._content presentMe:NO];
} 
```

在 UIView“孩子”：

```
[[NSNotificationCenter defaultCenter] <-- EXC_BAD_ACCESS (code=1, address=0x70000008
 postNotificationName:PRESENTING 
 object:self 
 userInfo:[NSDictionary dictionaryWithObjectsAndKeys:[NSNumber numberWithBool:prepareToEnter], PRESENTING, nil]]; 
```

第一次一切正常，但如果我第二次启动相同的视图，我会得到一个 EXC_BAD_ACCESS。这不是说缺少什么吗？

*仅供参考，这一切都在 ARC 中-xcode 4.3.2*

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-25T20:43:42.113

如果您正在调用`addObserver`视图中的项目，则需要`removeObserver`在 dealloc 期间调用。即使使用 ARC。

# java - J2SSH - 添加密钥交换算法

> ID：10323092
> 
> 赞同：1
> 
> 时间：2012-04-25T20:17:42.317
> 
> 标签：java, scp, j2ssh

我正在尝试使用 j2ssh 将文件从我的应用程序发送到服务器。远程服务器正在运行 TECTIA。

从命令行（部署我的应用程序的 Solaris 机器）使用我们交换的密钥对，scp 可以正常工作。

在我的应用程序中，j2ssh 无法建立连接，抛出异常：

```
Caused by: com.sshtools.j2ssh.transport.TransportProtocolException: The connection did not complete 
```

j2ssh 的调试日志显示如下：

```
com.sshtools.j2ssh.transport.TransportProtocolCommon.beginKeyExchange(Unknown Source) | Starting key exchange
com.sshtools.j2ssh.transport.TransportProtocolCommon.determineAlgorithm(Unknown Source) | Determine Algorithm
com.sshtools.j2ssh.transport.TransportProtocolCommon.determineAlgorithm(Unknown Source) | Client Algorithms: [diffie-hellman-group1-sha1]
com.sshtools.j2ssh.transport.TransportProtocolCommon.determineAlgorithm(Unknown Source) | Server Algorithms: [diffie-hellman-group14-sha1, diffie-hellman-group-exchange-sha1]
com.sshtools.j2ssh.transport.TransportProtocolCommon.sendMessage(Unknown Source) | Sending SSH_MSG_DISCONNECT
com.sshtools.j2ssh.transport.TransportProtocolCommon.run(Unknown Source) | The Transport Protocol has been stopped 
```

从上面我可以看到我的应用程序和服务器之间的密钥交换没有匹配算法（调试实际上表明这个问题的根源是`AlgorithmNotAgreedException`没有服务器和客户端算法匹配所以我知道这是根本原因）。

如何向 j2ssh 添加新算法以便找到匹配项？j2ssh 文档非常少。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T21:24:59.300

您应该在 j2ssh 发行版中有一个 sshtools.xml 文件。在该文件中，您可以添加一个额外的 ExtensionAlgorithm 条目来映射

```
diffie-hellman-group14-sha1 to
com.maverick.ssh.components.jce.DiffieHellmanGroup14Sha1 
```

或者

```
com.maverick.ssh.components.standalone.DiffieHellmanGroup14Sha1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T20:45:22.797

我对你的问题没有确切的答案，但我有一个建议。看看 jsch 库。我在几个应用程序中成功使用了 jsch。

# php - 发布到脸书墙

> ID：10323093
> 
> 赞同：0
> 
> 时间：2012-04-25T20:17:42.580
> 
> 标签：php, facebook

我想这个问题以前在这里被问过很多次，但我找不到任何适合我的解决方案。

这是很常见的事情，你可以在互联网上看到。用户可以通过一些图片将一件衣服添加到我的网站。在他这样做之后，我想让他有机会在他的 facebook 墙上分享它，并附上图片、描述和指向我网站的链接。

任何人都可以帮助我，因为我找不到一个好的起点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T20:41:10.990

您需要发送`Post object`到`Users.stream`连接。例如，看看下面的工具来玩 API 调用。单击“获取访问令牌”并在“扩展权限”下授予“publish_stream”调用。您可以通过单击“添加字段”尝试简单的 POST 到您的墙上，然后添加一个名称为“消息”的字段，其值设置您的消息。

[https://developers.facebook.com/tools/explorer/?method=POST&path=me%2Ffeed](https://developers.facebook.com/tools/explorer/?method=POST&path=me%2Ffeed)

这是文档描述了 Post 对象的结构。看起来您想查看“图片”字段以及“链接”字段。

[https://developers.facebook.com/docs/reference/api/post/](https://developers.facebook.com/docs/reference/api/post/)

# css - 切换兼容性视图时导航栏发生移动

> ID：10323098
> 
> 赞同：1
> 
> 时间：2012-04-25T20:18:07.777
> 
> 标签：css, position, compatibility, mode, shift

当我打开/关闭 IE9 的兼容性视图时，我的导航栏会移动位置：

* * *

当兼容性视图：**开：**

```
navbar is centred fine. :) 
```

当兼容性视图：**关闭：**

```
navbar is shifted to the right slightly. :( 
```

* * *

**注意：**由于某些网站限制，我无法附上屏幕截图。:(

* * *

显然我想纠正这个，但不能；因此，为什么我在这里发帖。:)

**我的 CSS 文件如下所示：**

```
/*background image for outside area*/
#outside {
    background-image:url('/images/body_bg.gif');
}

/*style for main area*/
#main {
    font:16px "Trebuchet MS", arial, verdana, serif, monospace;
    margin-left:auto;
    margin-right:auto;
    width:1020px;
    border:5px outset darkgrey;
    background-color:white;
}

/*background image*/
#bg {
    background-image:url('/images/content_bg.gif');
}

/*horizontal list item widths*/
ul.two li{width:50%;}
ul.four li{width:25%;}
ul.five li{width:20%;}

/*submenu list item widths*/
ul.sfour li a{width:25em;} /*alternate value = 19.1em*/
ul.sfive li a{width:18.5em;} /*alternate value = 15.3em*/

/*top navigation bar*/
#topnav ul {
    list-style-type:none;
    margin-left:auto;
    margin-right:auto;
    width:100%;
    overflow:hidden;
}

#topnav li {
    float:left;
}

#topnav li a {
    background-color:#606060;
    color:white;
    display:block;
    font-size:large;
    font-weight:bold;
    font-variant:small-caps;
    padding-top:4px;
    padding-bottom:4px;
    text-align:center;
    text-decoration:none;
}

#topnav li a:active {
    color:yellow;
}

#topnav li a:hover {
    background-color:#888888;
}

/*topnav submenus*/
#topnav li ul {
    display:none;
    position:absolute;
}

#topnav li:hover ul {
    display:block;
}

#topnav li:hover li {
    float:none;
}

#topnav li:hover a {
    background-color:#888888;
}

#topnav li:hover li a {
    display:block;
    font-size:small;
    font-weight:normal;
    font-variant:normal;
    text-align:center;
    text-decoration:none;
}

#topnav li:hover li a:hover {
    background-color:#B0B0B0
}

/*page title*/
h1 {
    border-bottom:3px solid black;
    color:gray;
    margin-left:auto;
    margin-right:auto;
    width:90%;
}

/*content*/
#content {
    margin-left:auto;
    margin-right:auto;
    width:90%;
} 
```

**我的 _Layout.cshtml 文件如下：**

```
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <title>C4DP - @Page.Title</title>
        <link href="@Href("~/Styles/Style.css")" rel="stylesheet" type="text/css" />
        <script type="text/javascript" src="/scripts/functions.js"></script>
        <script type="text/javascript" src="/scripts/sorttable.js"></script>
    </head>
    <body id="outside">
        <div id="main">
            <img src="/images/title_c4dp.gif" alt="C4DP" width="100%"/>
            <div id="bg">
                <div id="topnav">@RenderPage("~/navbar_Top.cshtml")</div>
                <h1>@Page.Title</h1>
                <div id="content">
                    @RenderBody()
                </div>
                <div id="bottomnav">@RenderPage("~/navbar_Bottom.cshtml")</div>
            </div>
            <p id="copyright">&copy; 2012 C4DP. All rights reserved.</p>
        </div>    
    </body>
</html> 
```

导航栏文件如下所示：

```
@if (WebSecurity.IsAuthenticated) {
    if (!Roles.IsUserInRole("admin")) {
        <ul class="four">
            <li><a href="@Href("~/Account/News.cshtml")">News</a></li>
            <li><a href="#">Stats</a>
                <ul class="sfour">
                    <li><a href="@Href("~/Account/Earnings.cshtml")">Earnings</a></li>
                    <li><a href="@Href("~/Account/SessionAverage.cshtml")">Session Average</a></li>
                    <li><a href="@Href("~/Account/Ranking.cshtml")">Ranking</a></li>
                </ul>
            </li>
            <li><a href="#">Profile</a>
                <ul class="sfour">
                    <li><a href="@Href("~/Account/UserProfile.cshtml")">Personal Info.</a></li>
                    <li><a href="@Href("~/Account/ChangePassword.cshtml")">Change Password</a></li>
                </ul>
            </li>
            <li><a href="@Href("~/Account/Logout.cshtml")">Logout</a></li>
        </ul> 
    } else { //logged in as administrator
        <ul  class="five">
            <li><a href="@Href("~/Account/News.cshtml")">News</a></li>
            <li><a href="#">Stats</a>
                <ul class="sfive">
                    <li><a href="@Href("~/Account/Earnings.cshtml")">Earnings</a></li>
                    <li><a href="@Href("~/Account/SessionAverage.cshtml")">Session Average</a></li>
                    <li><a href="@Href("~/Account/Ranking.cshtml")">Ranking</a></li>
                </ul>
            </li>
            <li><a href="#">Admin</a>
                <ul class="sfive">
                    <li><a href="@Href("~/Admin/Cardrooms.cshtml")">Cardrooms</a></li>
                    <li><a href="@Href("~/Account/Events.cshtml")">Events</a></li>
                    <li><a href="@Href("~/Account/Members.cshtml")">Members</a></li>
                </ul>
            </li>
            <li><a href="#">Profile</a>
                <ul class="sfive">
                    <li><a href="@Href("~/Account/UserProfile.cshtml")">Personal Info.</a></li>
                    <li><a href="@Href("~/Account/ChangePassword.cshtml")">Change Password</a></li>
                </ul>
            </li>
            <li><a href="@Href("~/Account/Logout.cshtml")">Logout</a></li>
        </ul> 
    }
} else {
    // nav bar when NOT logged in
    <ul class="four">
        <li><a href="@Href("~/Default.cshtml")">Home</a></li>
        <li><a href="@Href("~/Rules.cshtml")">Rules</a></li>
        <li><a href="@Href("~/Account/Login.cshtml")">Login</a></li>
        <li><a href="@Href("~/Account/RequestMembership.cshtml")">Request Membership</a></li>
    </ul>
} 
```

请帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T12:24:29.230

事实证明，我的导航栏需要`{display:inline;} and {padding:0;}`添加到它的属性才能使其工作。

在这方面不是真正的专家，我假设该`INLINE`属性阻止它被其相邻元素“推过”，并且该`PADDING:0;`属性确保导航栏正确适合其父元素。

如果“真正的大师”（比我更有经验的人）可以证实我的假设，那将不胜感激。先感谢您。

# javascript - 使用 JavaScript/jQuery 移动表单中的输入字段位置

> ID：10323102
> 
> 赞同：0
> 
> 时间：2012-04-25T20:18:29.823
> 
> 标签：javascript, jquery, html, forms

我的网站上有以下表格

```
input a
input b
input c 
```

是否可以使用 jQuery 完成以下操作？

```
input a
input c
input b 
```

请记住，表单仍然需要正确收集数据。

请指教。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T20:20:05.947

是的，这是可能的，虽然使用相同的技术，但使用`id`s 更容易，但如果您只知道要移动哪一个，那么：

```
$('input:text:nth-child(3)').insertAfter($('input:text:nth-child(1)')); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/p43y6/)

[JS Fiddle of `id`-based 方法（由 Vega 慷慨提供）](http://jsfiddle.net/skram/MQqHF/)。

或者，类似地：

```
$('input:text:nth-child(3)').appendTo($('input:text:nth-child(1)').parent()); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/p43y6/1/)。

[`id`基于方法的JS Fiddle 演示](http://jsfiddle.net/davidThomas/MQqHF/2/)。

参考：

*   [`appendTo()`](http://api.jquery.com/appendTo/).
*   [`insertAfter()`](http://api.jquery.com/insertAfter/).
*   [`:nth-child()`选择器](http://api.jquery.com/nth-child-selector/)。
*   [`:text`选择器](http://api.jquery.com/text-selector/)。

# c# - 我可以避免或优化这种动态调用吗？

> ID：10323105
> 
> 赞同：2
> 
> 时间：2012-04-25T20:18:40.060
> 
> 标签：c#, generics, optimization, dynamic

我正在尝试编写一个可以处理许多不同类型的输入的类，所有这些都实现相同的接口。

我有以下代码：

```
private IEnumerable<IPlan> DevisePlans(ITile tile, IEnumerable<ISpace> spaces)
{
    MethodInfo method = GetType().GetMethod("DevisePlans",
                                            BindingFlags.NonPublic | BindingFlags.Instance,
                                            null,
                                            new[] {tile.GetType(), typeof(ISpace)},
                                            null);
    var type = typeof(Func<,,>).MakeGenericType(tile.GetType(), typeof(ISpace), typeof(IEnumerable<IPlan>));
    var planner = Delegate.CreateDelegate(type, this, method);
    return spaces.SelectMany(s => (IEnumerable<IPlan>)planner.DynamicInvoke(tile, s));
} 
```

类中有很多不同的实现`DevisePlans`，每个都有一个实现的第一个参数类型`ITile`。

```
private IEnumerable<IPlan> DevisePlans(Foo tile, ISpace space) { /* ... */ }
private IEnumerable<IPlan> DevisePlans(Bar tile, ISpace space) { /* ... */ } 
```

这行得通，但我呼吁`DynamicInvoke`我的可枚举的每一次迭代。即使我不能完全避免动态调用，有没有办法优化这个方法，使动态调用不再驻留在我的循环中？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T20:28:16.407

**看起来**您正在使用它来调用所提供的最具体的**重载**（而不是覆盖）。假设我的理解是正确的（如果我错了，请告诉我），然后使用- 它有一个内置缓存并为此进行了优化：`DevisePlans``tile``dynamic`

```
return spaces.SelectMany(s =>
    (IEnumerable<IPlan>)DevisePlans((dynamic)tile, (dynamic)s)
); 
```

而且……*就是这样*！

但是，我很想寻找涉及多态性（反对`ITile`）或 C# 4.0 方差的答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T20:24:13.993

创建一个表达式树（从 Expression.Call 开始），编译它，您将拥有一个快速委托。您应该根据类型缓存委托，这样您就不会多次编译相同的类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T20:59:31.923

想想你在这里寻找的是[访问者模式](http://en.wikipedia.org/wiki/Visitor_pattern)。为每种类型定义一个带有重载的 ITileVisitor 接口，然后 ITile 有一个以访问者为参数的 Visit 方法。它的访问实现将导致正确的设计重载被调用。

# mysql - 年龄计算 - 来自时间戳字段的最快年龄计算公式

> ID：10323107
> 
> 赞同：0
> 
> 时间：2012-04-25T20:18:42.130
> 
> 标签：mysql

我正在使用此查询来计算用户年龄：

```
SELECT 
((YEAR(CURDATE())-YEAR(um.date_birth)) - (RIGHT(CURDATE(),5)<RIGHT(um.date_birth,5))) 
FROM user_meta AS um
WHERE um.uid = 2 
```

我想知道是否有最快/更轻的方法来做到这一点。我在更大的选择中使用它，所以我不介意以某种方式提高整体性能。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T20:24:36.653

如果您发现需要经常计算某个字段，我建议您 ALTER 您的表格以添加新列以方便您的计算。

例如，不是在每个查询中计算每个出生日期的 YEAR，而是简单地添加一个 YEAR 列，用出生年份更新表 ONCE，并将年份存储为 INT。

这样，每次您需要赶上年份时，只需选择该字段即可。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T20:29:11.650

```
select (CURDATE()-birth_dt)/365 from dual 
```

# ruby-on-rails-3 - Rails 3.2 Mountable App 语言环境被重复

> ID：10323112
> 
> 赞同：3
> 
> 时间：2012-04-25T20:18:54.283
> 
> 标签：ruby-on-rails-3, routes

我看到一个场景，一旦我进入可安装的应用程序，我的语言环境参数就会被复制。我的应用看起来像这样：

```
#routes.rb

resources :blogs

scope "(:locale)" do
  mount Auth::Engine => '/auth'
end 
```

如果我在博客页面并查看身份验证链接，它看起来像这样`/en-us/auth/signout`，效果很好，但是一旦我加载到可安装应用程序呈现的任何页面，例如个人资料页面`/en-us/auth/myprofile'`，退出链接现在看起来像`/en-us/auth/signout?locale=en-us`

我不希望查询字符串变得混乱，是什么导致应用程序正确设置语言环境参数，然后在查询字符串中复制它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-06T03:10:19.653

我敢打赌，您的应用程序控制器具有以下内容：

```
def set_locale
  # code here
end

def default_url_options
  # code here
end 
```

由于您的引擎控制器继承自应用程序控制器，因此 set_locale 可能会被触发两次。

可能的解决方案：检查代码是否在引擎中，然后不要触发语言环境设置。

这可以通过以下方式完成：`self.controller_path().split("/").first == engine_name`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T15:27:44.820

我有同样的问题。我在控制器上设置了默认的 url 选项（通过重新定义`default_url_options`或使用`self.default_url_options=`）。

解决方案是`Rails.application.routes.default_url_options =`改用。

# com - 类型库 HELPDIR 错误

> ID：10323113
> 
> 赞同：1
> 
> 时间：2012-04-25T20:18:55.373
> 
> 标签：com, registration

我正在开发一个注册的 COM 类型库。当我构建它时，Visual Studio 会自动注册该库。我可以在 OleView 中查看类型库。

我有这个库的两个分支，在不同的目录中，这导致了问题：HELPDIR 指向错误的分支。我的注册表如下所示：

```
[HKEY_CLASSES_ROOT\TypeLib\{6C964648-D0B3-4c8a-B7D5-53D176CBCC68}]

[HKEY_CLASSES_ROOT\TypeLib\{6C964648-D0B3-4c8a-B7D5-53D176CBCC68}\1.0]
@="My Type Library"

[HKEY_CLASSES_ROOT\TypeLib\{6C964648-D0B3-4c8a-B7D5-53D176CBCC68}\1.0\0]

[HKEY_CLASSES_ROOT\TypeLib\{6C964648-D0B3-4c8a-B7D5-53D176CBCC68}\1.0\0\win32]
@="c:\\path\\right_dir\\mylib.dll"

[HKEY_CLASSES_ROOT\TypeLib\{6C964648-D0B3-4c8a-B7D5-53D176CBCC68}\1.0\FLAGS]
@="0"

[HKEY_CLASSES_ROOT\TypeLib\{6C964648-D0B3-4c8a-B7D5-53D176CBCC68}\1.0\HELPDIR]
@="c:\\path\\wrong_dir" 
```

当我构建和注册我的库时，如何让 Visual Studio 更正 HELPDIR 路径？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T20:25:31.240

我曾经`regsvr32`注销然后重新注册类型库。当我取消注册时，注册表项被删除。然后，当我再次注册时，添加了正确的值。

# ruby - 无法加载此类文件 -- script/rails：通过 RubyMine 进行远程调试时出现此错误

> ID：10323119
> 
> 赞同：6
> 
> 时间：2012-04-25T20:19:41.937
> 
> 标签：ruby, ruby-on-rails-3, debugging, rubymine

通过 RubyMine IDE 进行远程调试时出现以下错误。

```
$ bundle exec rdebug-ide --port 1234 -- script/rails server
Fast Debugger (ruby-debug-ide 0.4.9) listens on :1234
    /home/amit/.rvm/gems/ruby-1.9.3-p125/gems/ruby-debug-ide19-0.4.12/lib/ruby-debug-ide.rb:123:in `debug_load'
    /home/amit/.rvm/gems/ruby-1.9.3-p125/gems/ruby-debug-ide19-0.4.12/lib/ruby-debug-ide.rb:123:in `debug_program'
    /home/amit/.rvm/gems/ruby-1.9.3-p125/gems/ruby-debug-ide19-0.4.12/bin/rdebug-ide:87:in `<top (required)>'
    /home/amit/.rvm/gems/ruby-1.9.3-p125/bin/rdebug-ide:19:in `load'
    /home/amit/.rvm/gems/ruby-1.9.3-p125/bin/rdebug-ide:19:in `<main>'
Uncaught exception: cannot load such file -- script/rails 
```

我按照[此链接](http://rails.vandenabeele.com/blog/2011/12/21/installing-ruby-debug19-with-ruby-1-dot-9-3-on-rvm/)安装了远程调试所需的 gem。

这是用于远程调试的 Gemfile 配置

```
#To Debug
  gem 'linecache19', '0.5.13', :path => "~/.rvm/gems/ruby-1.9.3-p125/gems/linecache19-0.5.13/"
  gem 'ruby-debug-base19', '0.11.26', :path => "~/.rvm/gems/ruby-1.9.3-p125/gems/ruby-debug-base19-0.11.26/"
  gem 'ruby-debug19', :require => 'ruby-debug'
  gem 'ruby-debug-ide19' 
```

该应用程序使用**Ruby 1.9.3**和**Rails 3.0.11**运行。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-25T23:14:38.453

您正在使用一些奇怪的调试 gem，只需要以下内容：

*   `ruby-debug-base19x`
*   `ruby-debug-ide`

首先，删除所有`ruby-debug*`gem，然后使用以下命令安装所需的 gem：

```
gem install ruby-debug-base19x --pre
gem install ruby-debug-ide --pre 
```

您应该获得以下（或更新的）版本：

```
ruby-debug-base19x (0.11.30.pre10)
ruby-debug-ide (0.4.17.beta9) 
```

调整您`Gemfile`以仅包含这**两个**gem（应用程序特定的 gem 除外）。

如果您收到`linecache19`相关错误，请按如下方式安装：

```
curl -OL http://rubyforge.org/frs/download.php/75414/linecache19-0.5.13.gem
gem install linecache19-0.5.13.gem 
```

@Anjan 为调试贡献了完整的 Gemfile 更改：

```
gem 'linecache19', '>= 0.5.13', :git => 'https://github.com/robmathews/linecache19-0.5.13.git'
gem 'ruby-debug-base19x', '>= 0.11.30.pre10'
gem 'ruby-debug-ide', '>= 0.4.17.beta14' 
```

不要忘记**更新**捆绑包。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-26T05:40:12.140

[我已经按照他在回答中提到的](https://stackoverflow.com/a/10325110/517483)所有说明在[@CrazyCoder](https://stackoverflow.com/users/104891/crazycoder)的帮助下解决了这个问题。

我在这里回答只是为了说明对我有用的东西，因此可能对社区有用。

这是我的 Gem 文件的最终条目

```
gem 'linecache19', '0.5.13', :path => "~/.rvm/gems/ruby-1.9.3-p125/gems/linecache19-0.5.13"
gem 'ruby-debug-base19x', '0.11.30.pre10'
gem 'ruby-debug-ide', '0.4.17.beta9' 
```

没有我得到以下错误`:path`。`linecache19`

```
You have requested:
  linecache19 = 0.5.13

The bundle currently has linecache19 locked at 0.5.12.
Try running `bundle update linecache19` 
```

# objective-c - 交换 WebView 的内容

> ID：10323120
> 
> 赞同：1
> 
> 时间：2012-04-25T20:19:44.750
> 
> 标签：objective-c, xcode, cocoa

我有 2 个 WebView，它们加载 2 个网页。

如何交换它们的内容？所以我会得到一个 WebView 的内容，并将另一个 WebView 的内容设置为此，反之亦然？

任何帮助将不胜感激。

提前致谢。

我想它会是这样的

```
[_mainWebView setContent:_subWebView]; 
```

但我找不到任何东西。

编辑：我想我必须使用 WebView 的 WebFrame，但是我该如何设置呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T21:59:00.003

像下面这样的东西可能会起作用。

示例 GitHub 项目位于：[https ://github.com/NSGod/SwapWebViews](https://github.com/NSGod/SwapWebViews)

我`NSBox`在窗口中使用了两个 s，两个`WebView`s 是分开的，如下图所示：

![在此处输入图像描述](../Images/35a8d22fef81d06fe5a4559664d6e07e.png)

Swap Webviews 按钮的方法只是用所需的 s 调用`NSBox`' s。[`setContentView:`](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/ApplicationKit/Classes/NSBox_Class/Reference/Reference.html#//apple_ref/occ/instm/NSBox/setContentView:)`WebView`

![在此处输入图像描述](../Images/d4ed60286caa864281f4c4cdd1e77a76.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T22:00:23.343

只需交换 2 个 webview 的位置和大小：

```
NSRect tempRect = WebviewOne.frame;
WebviewOne.frame = WebViewTwo.frame;
WebviewTwo.frame = tempRect; 
```

# html - 如何将文本和图像居中在 %width div 内的一行上？

> ID：10323121
> 
> 赞同：0
> 
> 时间：2012-04-25T20:19:48.567
> 
> 标签：html, css, centering

我真的很挣扎，我不知道为什么。我想在 1 行上有文本和图像，并在 100% 宽度的 div 内居中。这是一个jsfiddle ..

[http://jsfiddle.net/JnbeJ/](http://jsfiddle.net/JnbeJ/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T20:24:04.937

浮动元素自动变为块级。不可能通过`text-align: center`. 您要做的唯一方法是使它们像这样的内联块：`display: inline-block`. 我添加`vertical-align: top;`了`h`在顶部。工作示例在这里：http: [//jsfiddle.net/skip405/JnbeJ/4/](http://jsfiddle.net/skip405/JnbeJ/4/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T20:23:39.390

您的图像和文字不能向左浮动并同时居中...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T20:26:09.010

你有一个 100% 宽度的 div（btw/ div 开始时是 100%），并试图将一个 div 居中，它也是 100% 宽度。您可以在内部 div 上设置宽度，也可以将其设置为`inline-block`.

[更新了小提琴。](http://jsfiddle.net/3TuSh/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-25T21:02:06.480

您正在使用类名“居中”的包装器，因此不要同时制作两个元素（显示：内联块；），只需添加以下内容来设置包装器的样式：

```
.centered {display: inline-block; margin: 0 auto;} 
```

您的容器 css 中还有一个额外的 (text-align: center;) 不需要存在。

# google-app-engine - 如何使用 GAE 中的转换 API 将文本转换为 PDF？

> ID：10323123
> 
> 赞同：0
> 
> 时间：2012-04-25T20:20:04.987
> 
> 标签：google-app-engine, python-2.7

我正在处理一项任务，我想使用 GAE 中的转换 API 将文本文件转换为 PDF，我尝试如下：[https ://developers.google.com/appengine/docs/python/conversion/overview](https://developers.google.com/appengine/docs/python/conversion/overview)

这是我使用的代码：

```
from __future__ import with_statement
from google.appengine.api import files
import cgi, cgitb ; cgitb.enable()
import StringIO
from google.appengine.ext import webapp
from google.appengine.ext.webapp.util import run_wsgi_app
import mimetypes
from google.appengine.ext import blobstore
from mimetypes import guess_type
from google.appengine.api import conversion

def mime_type(filename):
    return guess_type(filename)[0]
class get(webapp.RequestHandler):
    def post(self):

        form = cgi.FieldStorage() 
        file_upload = form['file']  
        name=file_upload.filename  

        m=mimetypes.guess_type(name)[0]

        data=file_upload.file.read()
        buf = StringIO.StringIO()
        asset = conversion.Asset("text/plain", data, file_upload.filename)
        conversion_obj = conversion.ConversionRequest(asset, "application/pdf")
        result = conversion.convert(conversion_obj)
        if result.assets:
             for asset in result.assets:
                buf.write(asset.data)

        else:
             print "ERROR" 

        u_file = files.blobstore.create(mime_type="application/pdf",_blobinfo_uploaded_filename="test.pdf")
        data=buf.getvalue()
        with files.open(u_file, 'a') as f:
            f.write(data)
        files.finalize(u_file)
        blob_key = files.blobstore.get_blob_key(u_file)
        blob_info = blobstore.get(blob_key)
        name2 =  blob_info.filename   
        self.response.out.write("""<html><br><body style="background-color:#CC9999"><b><font size="5" face="Batang" ><center> <li ><a href="download.py?blob_key=%s" style="color:black">%s

               </center></font><hr></body></html>            
                """ % (str(blob_key),str(name2)))

def main():

    application = webapp.WSGIApplication( [(r'/get.py', get)], debug=True)

    run_wsgi_app(application)

if __name__ == "__main__":
    main() 
```

下载.py：

```
from __future__ import with_statement
from google.appengine.ext import blobstore
from google.appengine.ext import webapp
from google.appengine.ext.webapp import blobstore_handlers
from google.appengine.ext.webapp.util import run_wsgi_app
from mimetypes import guess_type

def mime_type(filename):
    return guess_type(filename)[0]
class Thumbnailer(blobstore_handlers.BlobstoreDownloadHandler):
    def get(self):
        blob_key = self.request.get("blob_key")
        if blob_key:
            blob_info = blobstore.get(blob_key)

            if blob_info:
                save_as1 =  blob_info.filename
                type2=mime_type(blob_info.filename)
                self.send_blob(blob_info,content_type=type2,save_as=save_as1)

                return

def main():

    application = webapp.WSGIApplication([
            (r'/download.*', Thumbnailer),
        ], debug=True)
    run_wsgi_app(application)

if __name__ == '__main__':
    main() 
```

编辑：我编辑了代码，当我尝试时`print buf.getvalue()`，我得到：加载pdf文档失败。但是当我尝试打开这个 PDF 时，我无法打开它，并且 adobe reader 立即给出错误，它无法打开文件。对不起，我还是初学者，有什么帮助吗？欢迎任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T17:01:43.010

这是我的工作代码示例（虽然它适用于 Python2.7 运行时）。祝你好运！

```
 import os
import StringIO

from google.appengine.api import conversion
from google.appengine.api import files
from google.appengine.ext import blobstore
from google.appengine.ext import webapp
from google.appengine.ext.webapp import blobstore_handlers

import jinja2

template_dir = os.path.join(os.path.dirname(__file__), 'templates')

jinja2_env = jinja2.Environment(
    loader=jinja2.FileSystemLoader(template_dir))

class MainHandler(webapp.RequestHandler):
    def get(self):
        tmpl = jinja2_env.get_template('index.jinja2')
        self.response.out.write(tmpl.render())

class PostHandler(blobstore_handlers.BlobstoreDownloadHandler):
    def post(self):
        data = self.request.get('file')
        asset = conversion.Asset('text/plain', data, 'test.txt')
        conversion_obj = conversion.Conversion(asset, 'application/pdf')
        result = conversion.convert(conversion_obj)
        buf = StringIO.StringIO()
        if result.assets:
            for asset in result.assets:
                buf.write(asset.data)
        else:
            raise Exception('Conversion failed.')
        u_file = files.blobstore.create(mime_type='application/pdf',
                                        _blobinfo_uploaded_filename='test.pdf')
        with files.open(u_file, 'a') as f:
            f.write(buf.getvalue())
        files.finalize(u_file)
        blob_key = files.blobstore.get_blob_key(u_file)
        blob_info = blobstore.get(blob_key)
        self.send_blob(blob_info)

app = webapp.WSGIApplication([
    ('/', MainHandler),
    ('/post_file', PostHandler),
],
debug=True) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T06:24:01.487

您确定您的“数据”（由 检索`data=file_upload.file.read()`）是正确的吗？

也许您可以停止使用 cgi 模块，而只需使用 webapp 为您创建的请求对象，例如：

```
data = self.request.get('file') 
```

顺便说一句，请不要使用私有属性，例如`asset._data`，使用`asset.data`。此外，StringIO 的用途是什么？您是否考虑过直接写入`asset.data`打开的文件？

*更新：我想我找到了原因。*

转换后，请执行以下操作：

```
if result.assets:
    for asset in result.assets
    buf.write(asset.data) 
```

# multithreading - 如何使用线程上下文重新初始化 Hibernate 中的会话？

> ID：10323133
> 
> 赞同：1
> 
> 时间：2012-04-25T20:20:43.880
> 
> 标签：multithreading, hibernate, session, session-management

注意：这个问题与我[之前](https://stackoverflow.com/questions/8723596/spring-hibernate-session-management-across-multiple-threads)的问题有关。

我`hibernate.current_session_context_class=thread`在我的 Hibernate 配置中使用并根据需要获取 Hibernate 会话`SessionFactory.getCurrentSession()`。所以它会在需要时创建或给我现有的会话，所以我不关心这个。

这一切都很好，但是当我得到 a 时该怎么办`HibernateException`，`ConstraintViolationException`例如？然后我之前获得的当前会话变得无效，我不能再使用它，甚至不能读取更多数据（根据我读过的许多论坛）。如何丢弃并在特定范围内获取新会话？我认为`SessionFactory.getCurrentSession()`第二次打电话仍然会给我同样的无效会话！？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T00:48:05.593

对于[`ThreadLocalSessionContext`](http://docs.jboss.org/hibernate/orm/4.1/javadocs/org/hibernate/context/internal/ThreadLocalSessionContext.html)，会话将在事务完成时关闭。因此，在这种情况下，您应该调用`tx.rollback()`，然后`sessionFactory.getCurrentSession()`重新开始。

# ruby - 在类中调用方法的 Ruby 语法

> ID：10323140
> 
> 赞同：2
> 
> 时间：2012-04-25T20:21:26.777
> 
> 标签：ruby, methods

我正在做一个练习，我必须创建一个罗马到阿拉伯数字转换器。据我所知，下面的代码完全符合 kosher 标准，但是在运行测试时我不断收到错误消息。Ruby 认为第 37 行有一个未定义的方法或变量（在下面的注释中注明）。

我想知道我的 snytax 是关闭还是其他原因。建议？

```
class ArabicNumeral

  def replace_troublesome_roman_numerals(letters)
   tough_mappings = {"CM" => "DCCCC",  "CD" => "CCCC", "XC" => "LXXXX", "XL" => "XXXX", "IX"=> "VIIII", "IV" => "IIII"}
   tough_mappings.each { |roman, arabic|   letters = letters.gsub(roman, arabic) } 
   letters
  end

  def convert_and_add(letters)
    digits = { "M" => 1000, "CM" => 900, "D" => 500, "C" => 100, "XC" => 90, "L" => 50, "XL" => 40, "X" => 10, "IX" => 9, "V" => 5, "IV" =>  4, "I" => 1}
    letters = letters.split("")
    letters.inject(0) do |sum, letter|
      arabic = digits[letter]
      sum += arabic
    end  
  end

  def self.convert(letters)
    roman_string = replace_troublesome_roman_numerals(letters)  ###LINE 37!
    arabic_number = convert_and_add(roman_string)
    arabic_number
  end
end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T20:33:10.517

这里的问题是您在第 37 行调用的方法`replace_troublesome_roman_numerals(letters)`。问题是方法`self.convert(letters)`是类方法。你可以这样称呼它：

```
ArabicNumeral.convert(letters) 
```

但是，它包含对实例变量的调用（`replace_troublesome_roman_numerals(letters)`我之前提到过。

```
def self.convert(letters)
    roman_string = ArabicNumeral.new.replace_troublesome_roman_numerals(letters)
    ArabicNumeral.new.convert_and_add(roman_string)

end 
```

这将创建一个实例`ArabicNumeral`并调用您需要的方法，而无需将其保存到变量中并占用内存。我还`arabic_number`从您的方法中删除了变量，因为您正在调用`convert_and_add(roman_string)`，将其添加到变量中，然后返回变量。因为`convert_and_add(roman_string)`是该方法处理的最后一件事，所以无论如何它都会在没有变量的情况下返回它。

如果您从不打算在实例中使用这些方法，`ArabicNumeral`那么我建议您将所有方法设为类级别或将它们包装在`Module`您将包含在项目中的类中。如果您根本不打算在`ArabicNumeral`课堂外使用它们，请考虑将它们放在后面`protected`或`private`留空时`convert(letters)`使用。

```
class ArabicNumberal

def self.convert(letters)
   # Code...
end

private

def self.replace_troublesome_roman_numerals(letters)
   # Code...
end

def self.convert_and_add(roman_string)
   # Code...
end

end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T20:26:07.963

好的...首先，您正在尝试使用一个类的实例方法。

该问题可以通过更改方法转换来解决：

```
def self.convert(letters)
    roman_string = replace_troublesome_roman_numerals(letters)  ###LINE 37!
    arabic_number = convert_and_add(roman_string)
    arabic_number
end 
```

到：

```
def convert(letters)
    roman_string = replace_troublesome_roman_numerals(letters)  ###LINE 37!
    arabic_number = convert_and_add(roman_string)
    arabic_number
end 
```

然后你需要创建一个实例并调用 convert 方法：

```
x = ArabicalNumeral.new()
x.convert('param') 
```

就是这样。

顺便说一句，我建议你添加一个构造方法（在 Ruby 中被命名为 initialize）。

完整的脚本如下：

```
class ArabicNumeral

  def replace_troublesome_roman_numerals(letters)
   tough_mappings = {"CM" => "DCCCC",  "CD" => "CCCC", "XC" => "LXXXX", "XL" => "XXXX", "IX"=> "VIIII", "IV" => "IIII"}
   tough_mappings.each { |roman, arabic|   letters = letters.gsub(roman, arabic) } 
   letters
  end

  def convert_and_add(letters)
    digits = { "M" => 1000, "CM" => 900, "D" => 500, "C" => 100, "XC" => 90, "L" => 50, "XL" => 40, "X" => 10, "IX" => 9, "V" => 5, "IV" =>  4, "I" => 1}
    letters = letters.split("")
    letters.inject(0) do |sum, letter|
      arabic = digits[letter]
      sum += arabic
    end  
  end

  def convert(letters)
    roman_string = replace_troublesome_roman_numerals(letters)  ###LINE 37!
    arabic_number = convert_and_add(roman_string)
    arabic_number
  end
end

x = ArabicNumeral.new()
puts x.convert('MDC') 
```

# sql - 有没有用触发器替换引用约束的通用方法？

> ID：10323146
> 
> 赞同：3
> 
> 时间：2012-04-25T20:22:07.257
> 
> 标签：sql, sap-ase

将应用程序从 MSSQL+Oracle 移植到 Sybase，并且“on delete cascade”存在问题 - Sybase 没有该选项。

Sybase有一个实现级联删除的触发器链接：http: //infocenter.sybase.com/help/index.jsp?topic=/com.sybase.help.ase_15.0.sqlug/html/sqlug/ [sqlug815.htm](http://infocenter.sybase.com/help/index.jsp?topic=/com.sybase.help.ase_15.0.sqlug/html/sqlug/sqlug815.htm) 但是在将其用作“删除级联”的上下文中时，该解决方案存在问题。

问题是，在检查任何引用约束后触发触发器。此处说明了该问题：

```
--drop table A
--drop table B
create table A (c int primary key)
create table B (c int primary key)

alter table A
add constraint Ac FOREIGN KEY (c) REFERENCES B(c)

create trigger delBA on B for delete 
as delete A from A, deleted where A.c = deleted.c

insert into B values (1)
insert into A values (1)

delete B where c = 1 
```

由于 'Ac' 约束，'delete' 语句将失败。如果触发器在检查引用约束之前（而不是之后）触发，它将从表“A”中删除值“1”并且不会有问题。

出于这个原因，我正在考虑通过使用触发器来实现引用约束。所以我必须创建一个插入和更新触发器，我相信。有没有我可以使用的模板？

我想确保我没有忽略任何东西，乍一看这个问题，我错过了应该编写更新触发器，以便它可以验证更新后约束仍然有效。- 这就是我正在寻找模板的原因，所以我不会错过任何类似的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T20:26:21.797

Triggers are often sources of trouble. A common approach would be to set up your data access layer that will create a transaction, delete the 'children' (cascade part) then delete the parent.

# mysql - 在较大日期范围内的日期范围内查找 n 个匹配项

> ID：10323148
> 
> 赞同：0
> 
> 时间：2012-04-25T20:22:24.133
> 
> 标签：mysql, max, min, datediff

在 MySQL 中，我有一个记录用户“操作”的表（操作可以是任意数量的事物：点击、购买等）。该表如下所示，其中 action_id 是唯一的：

```
+--------------------------------------------+
|               table_actions                |
+--------------------------------------------+
| action_id | user_id |     date_created     |
+-----------+---------+----------------------+
|         1 |     321 |  2011-01-21 06:00:00 |
+-----------+---------+----------------------+
|         2 |     123 |  2011-02-21 06:00:00 |
+-----------+---------+----------------------+
|         3 |     456 |  2011-03-21 06:00:00 |
+-----------+---------+----------------------+
|         4 |     654 |  2011-04-21 06:00:00 |
+--------------------------------------------+ 
```

我想在 30 个月的日期范围内找到相隔不超过一年的三个不同的 user_ids 的数量。我的第一次尝试是这样的：

```
select ta.user_id
from table_actions ta
where ta.date_created > DATE_SUB(now(),interval 30 month)
group by ta.user_id
having COUNT(ta.action_id) > 2 AND DATEDIFF(MAX(ca.created_at),MIN(ca.created_at)) > 364; 
```

这运行得很好，但是仅检查用户第一次和最后一次操作之间的差异时会出错。如果用户的第一次和最后一次操作相隔 30 个月，但在这段时间的某个时间段内，他们在 3 天内采取了 3 次操作，则我的查询不会计算它们。

我的研究发现了一些关于日期范围的帖子，但没有一个帖子在某个范围内的某个范围内查找特定数量的事件。

我假设这可能涉及某种循环或行编号，但我很快就达到了我的知识极限。

**更新1：**

如果一个真实世界的例子会有所帮助：

Jane 在 2010 年 3 月、2011 年 3 月、2011 年 4 月和 2011 年 12 月采取行动。

John 在 2010 年 1 月、2011 年 1 月、2011 年 2 月和 2012 年 3 月采取行动。

每个人在过去 30 个月内采取了 3 次或更多行动，但只有 Jane 在过去 30 个月内的 12 个月内采取了 3 次或更多行动。我正在寻找一个返回所有 Janes 的查询。

我遇到困难的地方是考虑到用户在过去 30 个月内可以采取任意数量的操作这一事实。如果它们仅限于 3 个动作，这将很简单。但是，我不知道如何让一个在过去 30 个月内采取 5 次行动的用户检查其中 3 次行动是否在一年内下降。

希望这有助于澄清。感谢大家。

# google-maps-api-3 - 使用 Google Maps API V3，确定标记是否在 KML 图层边界内

> ID：10323150
> 
> 赞同：6
> 
> 时间：2012-04-25T20:22:27.810
> 
> 标签：google-maps-api-3, gis, kml

有没有办法确定标记是否进入了 KmlLayer 覆盖的区域？我的 .kml 主要由 a`<Polygon>`和一堆定义边界的坐标组成。

我发现有一篇文章描述了一些类似于我正在寻找的内容，使用覆盖创建：http: [//www.paulmcilwaine.com/api/google-maps-detecting-markers-in-a-particular-boundary](http://www.paulmcilwaine.com/api/google-maps-detecting-markers-in-a-particular-boundary)

该方法具有使用 getBounds() 的优势，但我正在寻找一种使用 KmlLayer 边界的方法。KmlLayer 似乎没有像 getBounds() 这样方便的函数，但我确实在 KML 文件本身中有所有可用的坐标，所以我想有一种方法可以创建我自己的 getBounds() 函数。我只需要一种方法来确定标记（或 latlang）是否在 KML 文件中的这些坐标内。

感谢您的任何想法！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-25T20:59:37.693

KmlLayer 上没有这个功能。但是，如果您可以提取多边形边界并创建一个多边形，您可以使用 Maps API 的几何库来确定该点是否位于多边形内： [https ://developers.google.com/maps/documentation/javascript/参考#poly](https://developers.google.com/maps/documentation/javascript/reference#poly)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-13T22:33:59.940

我要求提供有关我如何实现此功能的更多详细信息。你可以在这里看到一个例子：[http ://www.usinternet.com/fiber-info/map.php](http://www.usinternet.com/fiber-info/map.php)

我在地图上有几个标记，我想测试它们是在边界内还是边界外。我这样设置它们：

```
 var userLocation = new google.maps.LatLng(44.928633,-93.298919);    //Lyndale Park

        var wendysLocation = new google.maps.LatLng(44.948056,-93.282222);  //Wendy's on Lake St

        var userMarker = new google.maps.Marker({
            position: userLocation,
            map: map,
            title:"Your Location",
            draggable: true
        });

        var wendysMarker = new google.maps.Marker({
            position: wendysLocation,
            map: map,
            title:"Wendy's on Lake St",
            draggable: true
        }); 
```

要创建多边形，您需要读取 KML 文件并构建一组坐标，然后可以将其添加到多边形的路径：属性。不幸的是，您似乎无法仅使用 Google Maps API 从 KML 转到 Polygon，但如果我错了，请有人纠正我！

```
var sector3PillburyPleasant = new google.maps.KmlLayer('http://usinternet.com/fiber-info/kml/Sector3Pillbury-Pleasant.kml', kmlOptions);
            sector3PillburyPleasant.setMap(map);

            var coordsSector3PillburyPleasant = [
                new google.maps.LatLng(44.91615269014508, -93.28382953316716),
                new google.maps.LatLng(44.91619137463104, -93.28120338511586), 
                new google.maps.LatLng(44.93046751403393, -93.28114057929436),
                new google.maps.LatLng(44.93046991974436, -93.28055243604703),
                new google.maps.LatLng(44.94815274527994, -93.28053962401711),
                new google.maps.LatLng(44.94815856171297, -93.28364017122617),
            ];

            var polySector3PillburyPleasant = new google.maps.Polygon({
                paths: coordsSector3PillburyPleasant,
                strokeColor: "#FFFFFF",
                strokeOpacity: 0.0,
                fillColor: "#FFFFFF",
                fillOpacity: 0.0
            }); 
```

我从 KML 向下解析了多边形的路径，构成路径的坐标嵌套如下：（如果要关闭路径，则不需要最后一个坐标对。）

```
<kml>
<Document>
    <Placemark>
        <Polygon>
            <tessellate>1</tessellate>
            <outerBoundaryIs>
                <LinearRing>
                    <coordinates>
                        -93.28382953316716,44.91615269014508,0 -93.28120338511586,44.91619137463104,0 -93.28114057929436,44.93046751403393,0 -93.28055243604703,44.93046991974436,0 -93.28053962401711,44.94815274527994,0 -93.28364017122617,44.94815856171297,0 -93.28382953316716,44.91615269014508,0 
                    </coordinates>
                </LinearRing>
            </outerBoundaryIs>
        </Polygon>
    </Placemark>
</Document>
</kml> 
```

然后我测试我得到的标记是在多边形内部还是外部：

```
 var markerIn = google.maps.geometry.poly.containsLocation(wendysMarker.getPosition(), polySector3PillburyPleasant);

        var markerOut = google.maps.geometry.poly.containsLocation(userMarker.getPosition(), polySector3PillburyPleasant);

        console.log(markerIn);

        console.log(markerOut); 
```

然后，如果您在 KML 图层内部或外部，您就可以对自己进行真假测试，尽管将 KML 图层转换为多边形需要绕道而行。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-09-12T14:20:44.273

这是关于如何将 KML 转换为 Google Maps V3 的一个很好的答案：

[如何检查点是否在 KML 多边形中（GIS Shapefile）](https://stackoverflow.com/questions/15264735/how-to-check-if-a-point-is-in-kml-polygon-gis-shapefile)

使用 geoxml3 或 geoxml-v3 等第三方解析器将您的 KML 呈现为原生 Google Maps API v3 多边形，然后使用您知道的方式。使用 geoxml3 的示例

给出的示例将 KML 转换为多边形，将地址作为输入，对其进行地理定位以获取纬度/经度，然后确定该点所在的多边形：

[http://www.geocodezip.com/geoxml3_test/v3_collection-map2e.html](http://www.geocodezip.com/geoxml3_test/v3_collection-map2e.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-12-01T11:37:44.157

[现在您可以直接从 API](https://developers.google.com/maps/documentation/javascript/reference/kml)获取 LatLngBoundary 到您的 KML 层

我认为这仅适用于简单的 KML 图层，但是一旦加载图层，您就可以使用**getDefaultViewport**获取边界并使用它的**contains**方法来检查 LatLng 对象是否在边界内。这是检查一对坐标是否适合 KML 图层的一种极其简单的方法。

# php - 扩展长期访问令牌

> ID：10323152
> 
> 赞同：3
> 
> 时间：2012-04-25T20:22:32.647
> 
> 标签：php, facebook, authentication, oauth

我一直在阅读有关[删除 offline_access](https://developers.facebook.com/roadmap/offline-access-removal/)权限的信息。

我的目标是扩展长期访问令牌。

所以我想要做的是在 60 天到期之前刷新长寿命令牌，可能是在第 55 天到第 59 天。

问题是，文档说**您只能扩展短期访问令牌**。

但是，当我在[如何处理过期令牌](http://developers.facebook.com/blog/post/2011/05/13/how-to--handle-expired-access-tokens/)发布中执行解决方案时，客户端和服务器端身份验证流程都会为我提供长期访问令牌。

所以我的具体问题是，我在哪里可以获得一个新的短期令牌？

一旦我得到这个短期令牌，我将对其进行扩展并替换现有的即将过期的长期令牌，从而提供无缝体验。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-14T01:44:13.500

实际上，我无法使用[如何处理过期令牌](http://developers.facebook.com/blog/post/2011/05/13/how-to--handle-expired-access-tokens/)中的解决方案，因为我的 access_token 尚未过期。正如我所说，我将在第 55-59 天执行此操作，在长寿命令牌到期之前。

似乎用户已授予`offline_access`应用程序的先前权限。这就是为什么客户端和服务器端身份验证流都返回长期访问令牌的原因。即使在应用程序设置中启用了迁移，也会发生这种情况。Facebook 也应该在他们的文档中说明这一点。解决方案是让用户撤销`offline_access`权限。

希望`offline_access`一旦他们强制在 5 月 2 日进行迁移，所有权限都将被撤销，[请参阅开发者路线图](https://developers.facebook.com/roadmap/)。

**结案。**愿这篇文章对遇到这种罕见情况的其他用户有所帮助。

# php - 如何读取/更改目录以进行文件浏览？

> ID：10323153
> 
> 赞同：0
> 
> 时间：2012-04-25T20:22:37.560
> 
> 标签：php, directory

我在如何做到这一点上有一个真正的脱节——部分原因是我没有使用文件系统的经验。我正在尝试创建一个脚本来导航文件夹下面的文件。该文件当前通过列出其所在目录的内容（又名“.”）来工作。我不知道如何让它列出下面文件夹的内容以及最好的方法。我的脚本需要如何修改才能达到这个目标？

[代码]

```
// sets ordering variables
$a = $_GET['a'];

// are you allowed to delete?
if($_SESSION['delete'] == "ON") {
    $do_del = true;
    }
else {
    $do_del = false;
    }

// scandir to opendir coversion from stackoverflow.com/questions/6823489/
$files_dir = ".";
$dir_handle = opendir($files_dir);
while ($dir_temp = readdir($dir_handle)) {
    $arr_dir[] = $dir_temp;
    }
closedir($dir_handle);

// function created by "acecream" on php.net; modified to include reverse sort
function sortArray($array, $key, $reverse = false)
    {
    if(isset($array)) {
        foreach ($array as $i => $k)
            { $sort_values[$i] = $array[$i][$key]; }

        if ($reverse == true)
            { arsort ($sort_values); }
        else
            { asort ($sort_values); }
        reset ($sort_values);

        while (list ($arr_key, $arr_val) = each ($sort_values))
            { $sorted_arr[] = $array[$arr_key]; }

        return $sorted_arr;
        }
    }

foreach($arr_dir as $file)
    {
    if(!preg_match("/(_vti)|(_borders)|(_private)|(hidden)|(~_)|(\.php)/", $file) && ($file != ".") && ($file !=".."))
        {
        $full   = "$files_dir/$file";

        $name   = strval($file);
        $size   = sprintf("%u", filesize($full));
        $kind   = pathinfo($file, PATHINFO_EXTENSION); // strval(end(explode(".", $file)));
        $mtime  = filemtime($full); // modify date
        $ctime  = filectime($full); // creation date

        $arr_files[] = array($name, $size, $kind, $mtime, $ctime);
        }
    }
$arr_count = count($arr_files);

switch ($a) {
    case 1 : $arr_files = sortArray($arr_files, 0); break;
    case 2 : $arr_files = sortArray($arr_files, 0, true); break;
    case 3 : $arr_files = sortArray($arr_files, 1); break;
    case 4 : $arr_files = sortArray($arr_files, 1, true); break;
    case 5 : $arr_files = sortArray($arr_files, 2); break;
    case 6 : $arr_files = sortArray($arr_files, 2, true); break;
    case 7 : $arr_files = sortArray($arr_files, 3); break;
    case 8 : $arr_files = sortArray($arr_files, 3, true); break;
    default: $arr_files = sortArray($arr_files, 3, true); break;
    }
unset($a);

function myFileSize($value) {
    // convert raw byte site to friendlier forms
    if($value > 1000)       { $sizestr = round(($value/1024), 1) . " KB"; }
        else                { $sizestr = "$value B"; }
    if($value > 1000000)    { $sizestr = round(($value/1048576), 1) . " MB"; }
    if($value > 1000000000) { $sizestr = round(($value/1073741824), 1) . " GB"; }
    return $sizestr;
    }
function myDate($value) {
    $date = date("j M y G:i", $value);
    return $date;
    }

if($arr_count > 0)
    {
    if($do_del == true) {
        print "<form method=\"post\" action=\"./?d=delete\">\n";
        }
        print "<table>\n";
        print "     <tr>\n";
        print "         <td>File Name</td>\n";
        print "         <td>Size</td>\n";
        print "         <td>Type</td>\n";
        print "         <td>Modified</td>\n";
        print "         <td>Created</td>\n";
    if($do_del == true) {
        print "         <td>Delete?</td>\n";
        }
        print "     </tr>\n";
        print "     <tr style=\"vertical-align: middle; background-color: #fff; border: 1px solid #000;\">\n";
        print "         <td>\n";
        print "             <a href=\"./?a=1\"><img src=\"./~_arr-asc.gif\" border=\"0\"></a>\n";
        print "             <a href=\"./?a=2\"><img src=\"./~_arr-dsc.gif\" border=\"0\"></a>\n";
        print "         </td>\n";
        print "         <td>\n";
        print "             <a href=\"./?a=3\"><img src=\"./~_arr-asc.gif\" border=\"0\"></a>\n";
        print "             <a href=\"./?a=4\"><img src=\"./~_arr-dsc.gif\" border=\"0\"></a>\n";
        print "         </td>\n";                       
        print "         <td>\n";
        print "             <a href=\"./?a=5\"><img src=\"./~_arr-asc.gif\" border=\"0\"></a>\n";
        print "             <a href=\"./?a=6\"><img src=\"./~_arr-dsc.gif\" border=\"0\"></a>\n";
        print "         </td>\n";
        print "         <td>\n";
        print "             <a href=\"./?a=7\"><img src=\"./~_arr-asc.gif\" border=\"0\"></a>\n";
        print "             <a href=\"./?a=8\"><img src=\"./~_arr-dsc.gif\" border=\"0\"></a>\n";
        print "         </td>\n";
        print "         <td>&nbsp;</td>\n";
    if($do_del == true) {
        print "         <td>&nbsp;</td>\n";
        }
        print "     </tr>\n";

    for ($beat = 0; $beat < $arr_count; $beat++)
        {
        $name   = $arr_files[$beat][0];
        $size   = $arr_files[$beat][1];
        $ext    = strtolower($arr_files[$beat][2]);
        $mdate  = $arr_files[$beat][3];
        $cdate  = $arr_files[$beat][4];

        $size   = myFileSize($size);
        $mdate  = myDate($mdate);
        $cdate  = myDate($cdate);

        // pick the image for file type based on file extension
        if(is_dir($name)) {
            $pic = "~_folder.png";
            }
        else {
            $pic = "~_file.png";
            }

        $url  = "<a href=\"$files_dir/$name\">$name</a>";   // create hard link

            print " <tr>\n";
            print "     <td style=\"width: 300px;\"><img src=\"./$pic\"> $url</td>\n";
            print "     <td style=\"width:  75px;\">$size</td>\n";
            print "     <td style=\"width:  50px;\">$ext</td>\n";
            print "     <td style=\"width: 150px;\">$mdate</td>\n";
            print "     <td style=\"width: 150px;\">$cdate</td>\n";
        if($do_del == true) {
            print "     <td><input type=\"checkbox\" name=\"list[$files_dir/$name]\" value=\"ON\"></td>\n";
            }
        print " </tr>\n";
        }
    print "</table>\n";

    if($do_del == true) {
        print " <p><input name=\"Submit1\" type=\"submit\" value=\"submit\">\n";
        print " <input name=\"Reset1\" type=\"reset\" value=\"reset\"></p>\n";
        print "</form>\n";
        }
    }
else
    {
    print "There are no files available for download.";
    } 
```

[/代码]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T21:14:53.203

使您的脚本成为接受路径的函数。

然后在 if(is_dir($file)) 内部的 while 语句中调用您的函数并将其传递给 $file。

例如，

```
function myFileSize($value) {...}
function myDate($value) {...}

function list_contents($path)
{
    $dir_name = $path;
    .
    .
    .
    $dir = opendir($path);
    .
    .
    .
    while ($file = readdir($dir)) {
        // do some stuff
        if (is_dir($file)) {
            list_contents($file);
        }
    }
} 
```

根据您要执行的操作，您需要修改 list_contents() 函数的输出以使用递归。您可以使用数组生成一些树结构，然后稍后将树打印出来，例如：

```
// return an array representing tree structure
function list_contents($path, &$tree)
{
    // ...
    while ($file = readdir($dir)) {
        $tree[$path][] = $file;
        if (is_dir($file)) {
            list_contents($file, $tree[$path]);
        }
    }

    return $tree;
}

function print_tree($tree)
{
    // code to display array using tree structure
}

$path = '.';
$dir_name = $path;

$tree_array = array();
$tree = list_contents($path, $tree_array)

print_tree($tree); 
```

或者您可以添加一个变量来计算方法中的级别数是

```
function list_contents($path, $level = 0)
{
    //...
    // indent output text by $level number of tabs
    while($file = readdir($dir) {
        if (is_dir($file)) {
            list_contents($file, $level++)
        }
    }
}

list_contents($path); 
```

输出看起来像

```
> Root
    > Folder1 in root
    > Folder2 in root
        > Folder1 in Folder2
        > Folder2 in Folder2
    > Folder3 in root
        > Folder1 in Folder3
              > Folder1 in Folder1/Folder3
        > File1 in Folder1
    > File1 in root
    > File2 in root 
```

作为建议，我会采用与获取文件信息或操作文件相关的任何函数并将它们放在自己的文件 file_functions.php 中，然后将其包含在脚本的顶部。

# ios - cellForRowAtIndexPath 没有被调用？

> ID：10323154
> 
> 赞同：0
> 
> 时间：2012-04-25T20:22:39.773
> 
> 标签：ios, objective-c, uitableview

我正在做一个项目，我需要在表格中填充单元格并将它们显示在屏幕上。我有要显示的表格，但现在数据显示在单元格中。我试过使用断点，发现这个方法永远不会被调用。它之前的方法（numberOfRowsInSection）确实被调用了。有什么建议么？

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

        static NSString *CellIdentifier = @"Cell";

        UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
        if (cell == nil) {
            cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
        }
        Resident *aResident = (Resident *)[appDelegate.residents objectAtIndex:indexPath.row];   
        cell.textLabel.text = aResident.name;
        cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;

        return cell;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T20:25:26.793

您是否为 TableView 设置了委托和数据源？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T20:26:22.237

是的，numberOfRowsInSection 可能返回 0。显示它以及填充数据源的位置。

# c - GSL 求解钟摆运动的 ODE

> ID：10323155
> 
> 赞同：2
> 
> 时间：2012-04-25T20:22:42.613
> 
> 标签：c, gsl, ode, differential-equations

我正在尝试求解摆锤运动的微分方程，给定摆锤初始角度 (x)、重力加速度 (g)、线长 (l) 和时间步长 (h)。我用欧拉法试过这个，一切都很好。但现在我要使用 GSL 中实现的 Runge-Kutta 方法。我试图从 gsl 手册中学习实现它，但我遇到了一个问题。钟摆不想停下来。假设我从初始角度 1 rad 开始，它总是在 1 rad 处具有峰值倾斜，无论它已经做了多少次摆动。这是我用来将其提供给 GSL 的方程式和函数：

```
x''(t) + g/l*sin(x(t)) = 0 
```

改造它：

```
x''(t) = -g/l*sin(x(t)) 
```

并分解：

```
y(t) = x'(t)
y'(t) = -g/l*sin(x(t)) 
```

这是代码片段，如果这还不够，我可以发布整个程序（它不会太长），但也许这是某个地方的问题：

```
 int func (double t, const double x[], double dxdt[], void *params){
        double l = *(double*) params;
        double g = *(double*) (params+sizeof(double));
        dxdt[0] = x[1];
        dxdt[1] = -g/l*sin(x[0]);
        return GSL_SUCCESS;
    } 
```

参数`g`和`l`正确传递给函数，我已经检查过了。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-25T20:45:45.963

正如 Barton Chittenden 在评论中指出的那样，钟摆*应该*在没有摩擦的情况下继续前进。这是意料之中的。

至于为什么在使用欧拉方法时它会变慢并停止，这涉及到一个微妙而有趣的主题。（理想的、无摩擦的）物理钟摆具有系统中能量守恒的特性。不同的集成方案在不同程度上保留了该属性。通过一些集成方案，系统中的能量会*增长*，钟摆会逐渐摆动得更高。对于其他人，能量会丢失，钟摆会停止。这两种情况发生的速度部分取决于方法的顺序；更准确的方法通常会更慢地失去能量。

您可以通过为不同的积分方案绘制系统中的总能量（势能 + 动能）来轻松观察到这一点。

最后，积分方法有一个完整的子领域，它保留了像这样的系统的某些守恒量，称为辛方法。

# asp-classic - 指定字符串中变量的小数位

> ID：10323159
> 
> 赞同：2
> 
> 时间：2012-04-25T20:23:08.517
> 
> 标签：asp-classic, decimal-point

在短暂寻找了几个小时后，我看到了解决我的问题的多种解决方案，但我正在努力实施它们，希望有人可以帮助一个菜鸟。

问题是我在一个 ASP/MySQL Web 应用程序中有一个下拉框，它错误地显示了一些价格。例如，如果数据为 32.00，则显示的数字将返回为 32，类似地，如果它为 6.50，则显示为 6.5 数据类型或价格在 db 表中设置为 Decimal(19,2) 长度，并且价格在其他地方正确显示除了在下拉框中显示的这一选项实例。我很确定有一个简单的修复方法，并且非常感谢修复。我以为我可以添加 .toFixed(2) ，所以实际上它就像这样 <%=DealCartsDB("price").toFixed(2)%>，但它说不支持。

```
<select name="deal" class="qty" onChange="swapDeal()">
<option value="-1">CHOOSE YOUR DEAL</option>
<% while not DealCartsDB.Eof %>
<option value="<%=DealCartsDB("dealid")%>"<% if clng(dealID)=DealCartsDB("dealid") then %> selected<% end if %>><%=DealCartsDB("dealname")%>........&pound;<%=DealCartsDB("price")%></option>
<% DealCartsDB.MoveNextWend %></select> 
```

非常感谢任何帮助，谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-25T20:27:43.470

尝试这个：

```
<%= FormatNumber(DealCartsDB("price"), 2) %> 
```

# php - 使用 Zend_Search_Lucene fopen 失败 .fnm 文件

> ID：10323160
> 
> 赞同：0
> 
> 时间：2012-04-25T20:23:08.580
> 
> 标签：php, zend-framework, lucene, zend-search-lucene

我在一个不基于 ZF 的独立项目中使用 Zend_Search_Lucene。我成功索引内容，并搜索它们，但问题是它无法创建 .fnm 文件

这是我正在使用的代码

```
Zend_Search_Lucene_Analysis_Analyzer::setDefault(new Zend_Search_Lucene_Analysis_Analyzer_Common_Utf8());
Zend_Search_Lucene_Search_QueryParser::setDefaultEncoding('utf-8');
Zend_Search_Lucene_Analysis_Analyzer::setDefault(new Zend_Search_Lucene_Analysis_Analyzer_Common_Utf8_CaseInsensitive());

$this->index = Zend_Search_Lucene::create(self::PATH_INDEX);

$doc = new Zend_Search_Lucene_Document();

$doc->addField(Zend_Search_Lucene_Field::keyword('id',$content['id'],'UTF-8'));
$doc->addField(Zend_Search_Lucene_Field::text('summary',$summary,'UTF-8'));
$doc->addField(Zend_Search_Lucene_Field::keyword('module',$module,'UTF-8'));

$this->index->addDocument($doc); 
```

我也试过

```
$doc->addField(Zend_Search_Lucene_Field::keyword('module',utf_encode($module),'UTF-8')); 
```

我的内容是可搜索的，但我不知道为什么它不创建 fnm 文件，它会创建其余的文件，如 cfs 文件和 fdx、锁、段......等等，所以这不是目录或权限问题，问题在于我的锁猜测。

这是例外

```
Fatal error: Uncaught exception 'Zend_Search_Lucene_Exception' with message 'fopen(dict/_1.fnm): failed to open stream: No such file or directory' in Zend/Search/Lucene/Storage/File/Filesystem.php on line 67

Zend_Search_Lucene_Exception: fopen(dict/_1.fnm): failed to open stream: No such file or directory in Zend/Search/Lucene/Storage/File/Filesystem.php on line 67

Call Stack:
    0.0882    7819976   1\. Zend_Search_Lucene_Proxy-&gt;__destruct() Zend/Search/Lucene/Proxy.php:0
    0.0882    7819976   2\. Zend_Search_Lucene-&gt;removeReference() Zend/Search/Lucene/Proxy.php:63
    0.0882    7819976   3\. Zend_Search_Lucene-&gt;_close() Zend/Search/Lucene.php:607
    0.0882    7819976   4\. Zend_Search_Lucene-&gt;commit() Zend/Search/Lucene.php:569
    0.0882    7819976   5\. Zend_Search_Lucene_Index_Writer-&gt;commit() Zend/Search/Lucene.php:1419
    0.0882    7819976   6\. Zend_Search_Lucene_Index_SegmentWriter_DocumentWriter-&gt;close() Zend/Search/Lucene/Index/Writer.php:757
    0.0882    7819976   7\. Zend_Search_Lucene_Index_SegmentWriter-&gt;_dumpFNM() Zend/Search/Lucene/Index/SegmentWriter/DocumentWriter.php:212
    0.0882    7820112   8\. Zend_Search_Lucene_Storage_Directory_Filesystem-&gt;createFile(???) Zend/Search/Lucene/Index/SegmentWriter.php:280
    0.0882    7820912   9\. Zend_Search_Lucene_Storage_File_Filesystem-&gt;__construct(???, ???) Zend/Search/Lucene/Storage/Directory/Filesystem.php:184 
```

Anyhelp将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T16:31:06.723

在将目录设置为绝对目录后终于工作了。

# android - Android - 安排一个事件每 10 毫秒发生一次？

> ID：10323166
> 
> 赞同：3
> 
> 时间：2012-04-25T20:23:18.697
> 
> 标签：android, performance, audio, timer, timedelay

我正在创建一个允许通过高频声波进行非常低带宽通信的应用程序。我已经到了可以创建频率并进行傅立叶变换的地步（借助 Moonblink 的 Audalyzer 开源代码[）](http://code.google.com/p/moonblink/wiki/Audalyzer)。

但这是我的问题：我无法让代码以正确的时间运行。假设我希望每 10 毫秒执行一段代码，我该怎么做呢？

我尝试过使用 TimerTask，但在代码实际执行之前有一个巨大的延迟，比如长达 100 毫秒。

我也尝试了这种方法，只需 ping 当前时间并仅在该时间过去时执行。但是仍然存在延迟问题。你们有什么想法吗？

```
Thread analysis = new Thread(new Runnable()
{
    @Override
    public void run()
    {
        android.os.Process.setThreadPriority(android.os.Process.THREAD_PRIORITY_URGENT_DISPLAY);

        long executeTime = System.currentTimeMillis();

        manualAnalyzer.measureStart();
        while (FFTransforming) 
        {          
            if(System.currentTimeMillis() >= executeTime)
            {
                //Reset the timer to execute again in 10ms
                executeTime+=10;

                //Perform Fourier Transform
                manualAnalyzer.doUpdate(0);

                //TODO: Analyze the results of the transform here...

            }
        }
        manualAnalyzer.measureStop();
    }
});
analysis.start(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T19:31:56.010

我会推荐一种非常不同的方法：不要尝试实时运行*您的代码。*

相反，仅依靠实时运行的低级音频代码，通过在一段时间内连续录制（或播放）包含感兴趣的事件。

然后，您的代码与此有些异步运行，与音频缓冲区分离。您的代码的时间感不是由执行时的系统时钟决定的，而是由您使用的音频数据的定义的采样间间隔决定的。（即，如果您使用 48 Ksps，则 10 毫秒后是 480 个样本）

您可能需要修改控制设备之间交互的协议，以扩大预计发生传输的时间窗口。即，您可以对“数据包”中的实际调制和符号进行精确计时，但您不应期望在确定何时发送或接收数据包时具有几乎相同的精度顺序 - 您必须“找到”它在包含噪音的较长录音中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T20:37:11.977

您的线程/循环策略可能大致与您将要获得的一样接近。但是，10ms 并不是很多时间，大多数 Android 设备都不是超级强大的，而且傅里叶变换需要做很多工作。我发现你不太可能在 10 毫秒内完成这么多的工作。我怀疑你将不得不增加这个时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-27T19:25:21.103

我更改了您的代码，以便将 doUpdate 的执行时间考虑在内。System.nanoTime() 的使用也应该提高准确性。

```
 public void run() {
android.os.Process.setThreadPriority(android.os.Process.THREAD_PRIORITY_URGENT_DISPLAY);

long executeTime=0;        
long nextTime = System.nanoTime();

manualAnalyzer.measureStart();
while (FFTransforming) 
{          
    if(System.nanoTime() >= nextTime)
    {
        executeTime = System.nanoTime();
        //Perform Fourier Transform
        manualAnalyzer.doUpdate(0);
        //TODO: Analyze the results of the transform here...
        executeTime = System.nanoTime() - executeTime;
        //guard against the case that doUpdate took longer than 10ms
        final long i = executeTime/10000000;
        //set the timer to execute again at the next full 10ms intervall
        nextTime+= 10000000+ i*10000000 
    }
}
manualAnalyzer.measureStop();
    } 
```

**你还能做什么？**

*   消除垃圾收集
*   使用 NDK 原生化（只是一个想法，这也可能没有任何好处）

# mysql - 通过 mysql_query 限制和排序

> ID：10323170
> 
> 赞同：1
> 
> 时间：2012-04-25T20:23:43.113
> 
> 标签：mysql, sql-order-by, limit, insert-into

下面的脚本可以很好地将不同的 rss 提要插入到 mysql 数据库中，在网站上回显一些项目。但是当我尝试在“mysql_query”中订购和限制时，事情就停止了。我怀疑 ORDER BY 和 LIMIT 放置在错误的位置，但我看到的唯一可能是将它们放入 mysql_query。有谁知道吗？

```
$feeds = array('https://www.ictu.nl/rss.xml', 'http://www.vng.nl/smartsite.dws?id=97817');
foreach( $feeds as $feed ) {
    $xml = simplexml_load_file($feed);

    foreach($xml->channel->item as $item)
    {
    $date_format = "j-n-Y"; // 7-7-2008
            echo date($date_format,strtotime($item->pubDate));
            echo '&nbsp;';
            echo '&nbsp;';
            echo '<a href="'.$item->link.'" target="_blank">'.$item->title.'</a>';
            echo '<div>' . $item->description . '<br><br></div>';

    mysql_query("INSERT INTO rss_feeds (id, title, description, link, pubdate) 
                VALUES (
        '', 
        '".mysql_real_escape_string($item->title)."', 
        '".mysql_real_escape_string($item->description=htmlspecialchars(trim($item->description)))."', 
        '".mysql_real_escape_string($item->link)."', 
        '".mysql_real_escape_string($item->pubdate)."')")ORDER BY 'title' LIMIT 0,10;       
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T20:25:56.713

ORDER BY 和 LIMIT 不与 INSERT 语句一起使用，它们需要与 SELECT 语句一起使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T19:52:34.410

不要在列名周围使用单引号，如果有的话，请使用 ` 来包装列名。您的 $selSQL 周围也没有引号，请参见下文并尝试一下：

```
$selSQL = "SELECT * FROM `rss-feeds` ORDER BY `title`";      
$insSQL = "INSERT INTO `rss_feeds` (`id`, `title`, `description`, `link`, `pubdate`) 
           VALUES (
            '', 
            '".mysql_real_escape_string($item->title)."', 
            '".mysql_real_escape_string($item->description=htmlspecialchars(trim($item->description)))."', 
            '".mysql_real_escape_string($item->link)."', 
            '".mysql_real_escape_string($item->pubdate)."')"; 

$selres = mysql_query($selsql);
$insRes = mysql_query($insSQL); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T18:21:06.947

我不确定 mysql_query 和符号。还是有问题。

```
$selSQL = SELECT * FROM rss-feeds ORDER BY 'title';      
$insSQL = "INSERT INTO 'rss_feeds' (id, title, description, link, pubdate) 
                    VALUES (
            '', 
            '".mysql_real_escape_string($item->title)."', 
            '".mysql_real_escape_string($item->description=htmlspecialchars(trim($item->description)))."', 
            '".mysql_real_escape_string($item->link)."', 
            '".mysql_real_escape_string($item->pubdate)."'); 

$selres = mysql_query($selsql);
$insRes = mysql_query($insSQL); 
```

# asp.net - 使用 IIS 7 进行 Windows 身份验证

> ID：10323172
> 
> 赞同：0
> 
> 时间：2012-04-25T20:23:51.193
> 
> 标签：asp.net, iis-7

我使用带有 IIS 7 的**Windows 身份验证**，我需要不显示或不显示提示。提示不显示的正确方法是什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T21:05:42.280

有点难以理解你在问什么。
但是我正在尝试并假设您已经使用 建立了一个网站`Windows Authentication`，当您使用网络浏览器浏览它时，您会看到一个登录对话框，要求输入用户名和密码。
我的假设正确吗？

其原因可能是事物的清单。不幸的是，无论您使用的是基于 Intranet 的网站还是面向 Internet 的网站，您都没有提及任何内容。如果是前者，那就有希望，如果是后者，那就没有希望了。

假设您在公司网络的边界内，这是一个 Intranet 解决方案。首先，确保您使用的是支持 Windows 身份验证的 Web 浏览器。Microsoft Internet Explorer 是一个好的开始。如果使用 IE，请确保将其设置为`Enable Windows Authentication`in `Tools->Internet Options->Advanced`。并且您正在访问的主机名是 IE 安全选项卡中本地 Intranet 区域的一部分。这样，您就可以利用自动登录功能。

其次，如果您不在网站上使用模拟，请确保运行应用程序池的帐户对所有需要的资源具有所有必要的权限。（比如它可能需要访问的文件、数据库访问等等。）

如果您使用模拟，请确保运行浏览器会话的帐户对您的 Web 应用程序可能访问的所有最终资源具有所有必要的权限。（见上）

如果您使用的是面向互联网的网站，那么对不起，您不走运。

你知道，如果你的问题更具体，你会给出一个更好的答案。

# c# - 如何在 sql server 2005 中为列创建动态行？

> ID：10323173
> 
> 赞同：0
> 
> 时间：2012-04-25T20:23:55.717
> 
> 标签：c#, asp.net, sql, sql-server-2005, visual-studio-2008

我正在使用带有 c# 的 SQL Server 2005 和 asp.net 2008 ...我有 2 个表 Result 和 Stud_Info ....

```
1] Stud_Info

CREATE TABLE Stud_Info
(Enroll_Number varchar(20) NOT NULL,  
Salutation varchar(10) NULL,  
First_Name varchar(20) NULL,  
Middle_Name varchar(20) NULL,  
Last_Name varchar(20) NULL,  
Course_Id varchar(20) NULL,  
Batch varchar(20) NULL)

INSERT into Stud_Info values(11161,'Mr.','Mack','B','Botha','MECH','Batch1');    
INSERT into Stud_Info values(11162,'Mr.','John','A','Los','CIVIL','Batch2');    
INSERT into Stud_Info values(11163,'Ms.','Merry','F','Dsuza','ELCT','Batch1');    
INSERT into Stud_Info values(11164,'Mr.','Pow','B','Janero','MECH','Batch2');    
INSERT into Stud_Info values(11165,'Mr.','Martin','J','Smith','MECH','Batch1');    

SELECT * from Stud_Info 
```

第二张桌子是这样的...

```
2] Exam_Result

CREATE TABLE Exam_Result
(Result_Id numeric(18, 0) IDENTITY(1,1) NOT NULL,  
Enroll_Number varchar(50) NULL,  
Student_Name varchar(100) NULL,  
Course_Id varchar(50) NULL,  
Semester varchar(50) NULL,  
Subject_Id varchar(50) NULL,  
Subject_Name varchar(50) NULL,  
MarksObtained numeric(18, 0) NULL,  
Exam_Type varchar(50) NULL)

INSERT into Exam_Result values(11161,'Mack B Botha','MECH',1,'MT','Maths',25,'Internal1');  
INSERT into Exam_Result values(11161,'Mack B Botha','MECH',1,'EN','English',22,'Internal1');  
INSERT into Exam_Result values(11161,'Mack B Botha','MECH',1,'SC','Science',20,'Internal1');  
INSERT into Exam_Result values(11166,'Barden V John','CIVIL',1,'SS','Social',21,'Internal2');  
INSERT into Exam_Result values(11161,'Mack B Botha','MECH',2,'SM','Simple Maths',24,'Internal2');  
INSERT into Exam_Result values(11161,'Mack B Botha','MECH',2,'SM','Simple Maths',69,'Final');  

SELECT * from Exam_Result 
```

&

Exam_Result 是这样的......

```
Result_Id  Enroll_No  Student_Name  Course_ID  Semester  Subject_Id  Subject_Name   Marks    Type    

1          11161      Mack B Botha   MECH       1         MT          Maths           25     Internal1

2          11161      Mack B Botha   MECH       1         EN          English         22     Internal1

3          11161      Mack B Botha   MECH       1         SC          Science         20     Internal1

4          11166      Barden V John  CIVIL      1         SS          Social          21     Internal2

5          11161      Mack B Botha   MECH       2         SM          Simple Maths    24     Internal2

6          11161      Mack B Botha   MECH       2         SM          Simple Maths    69     Final 
```

我正在使用此 PIVOT 查询将主题的行动态转换为列......并且效果很好。

```
declare @subjname varchar(100)  
declare @subjects varchar(7000)  
declare @subjectsselection varchar(7000)  

set @subjects = ''  
set @subjectsselection = ''  

DECLARE subject_cursor CURSOR  
FOR SELECT distinct Subject_Id FROM Result  
OPEN subject_cursor  
FETCH NEXT FROM subject_cursor  
INTO @subjname  
WHILE @@FETCH_STATUS = 0  
BEGIN  
set @subjects = @subjects + '[' + @subjname + ']'  
set @subjectsselection = @subjectsselection + 'Isnull([' + @subjname + '],0) As ' + @subjname  

set @subjects = @subjects + ','  
set @subjectsselection = @subjectsselection + ','  

FETCH NEXT FROM subject_cursor  
INTO @subjname  
End  
CLOSE subject_cursor;  
DEALLOCATE subject_cursor;  

select @subjects = LEFT(@subjects, LEN(@subjects) - 1)  
select @subjectsselection = LEFT(@subjectsselection, LEN(@subjectsselection) - 1)  

print @subjects  
print @subjectsselection  

declare @query nvarchar(4000)  

set @query = 'select Enroll_Number, ' + @subjectsselection + ' From '  
set @query = @query + '(select Enroll_Number, Subject_Id, MarksObtained from Result ) ps '  
set @query = @query + 'pivot(sum(MarksObtained) for Subject_Id in (' + @subjects + ')) as pvt'  

exec sp_executesql @query 
```

目前我越来越喜欢....

```
Enroll_Number    MT    EN    SC    SS    SM    

11161            25    22    20    0     83
11166            0     0     0     21    0 
```

**在这里，我得到子 SM 的总和，即 24 + 69 = 83**，但我希望每个学生的总数和平均值

**现在的问题是我想通过根据用户的选择来显示结果....**例如，如果用户只想查看**Course_Id = MECH 和 Semester = 1** ....o/p 应该是....

```
Enroll_No    Student_Name    Course_ID    Semester    Maths    English    Science     Type         Grand_Total    Avg

11161        Mack B Botha     MECH         1          25        22        20        internal1       67          66.22 
```

每门课程和学期都没有固定的科目..它可能会改变....并且**需要按 Course_Id 和 Semester 分组**给我指导和查询，以便我实施您的答案....我希望这些信息足以解释我的东西....请帮帮我先生....谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T06:45:57.800

您可以查看 SQL Server 中的 PIVOT 功能：http: [//msdn.microsoft.com/en-us/library/ms177410.aspx](http://msdn.microsoft.com/en-us/library/ms177410.aspx)

但是，该语句可能需要使用存储过程动态构建。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T14:44:31.560

我们可以使用 PIVOT 和动态 sql 语句来实现这一点。例如，我们有一个名为 sales 的表，如下所示。

```
create table Sales (SalesPerson varchar(100), Product varchar(50), SamesAmount numeric (18,2))

insert into Sales (SalesPerson, Product, SamesAmount)
select 'Bob',   'Pickles', 100.00
union all
select 'Sue',   'Oranges', 50.00
union all
select 'Bob',   'Pickles', 25.00
union all
select 'Bob',   'Oranges', 300.00
union all
select 'Sue',   'Oranges', 500.00 
```

PIVOT 查询是

```
select salesperson, Isnull([Oranges],0) As Oranges, Isnull([Pickles],0) As Pickles
From
(select SalesPerson, Product, SamesAmount from Sales ) ps
pivot(sum(SamesAmount) for product in ([Oranges],[Pickles])) as pvt 
```

由于主题的数量可以改变，我们必须构建动态 sql 查询。

```
declare @productname varchar(100)
declare @products varchar(7000)
declare @productsselection varchar(7000)

set @products = ''
set @productsselection = ''

DECLARE product_cursor CURSOR
    FOR SELECT distinct Product FROM Sales
OPEN product_cursor
FETCH NEXT FROM product_cursor
INTO @productname
WHILE @@FETCH_STATUS = 0
BEGIN
    set @products = @products + '[' + @productname + ']'
    set @productsselection = @productsselection + 'Isnull([' + @productname + '],0) As ' + @productname

    set @products = @products + ','
    set @productsselection = @productsselection + ','

    FETCH NEXT FROM product_cursor
    INTO @productname
End
CLOSE product_cursor;
DEALLOCATE product_cursor;

select @products = LEFT(@products, LEN(@products) - 1)
select @productsselection = LEFT(@productsselection, LEN(@productsselection) - 1)

print @products
print @productsselection

declare @query nvarchar(4000)

set @query = 'select salesperson, ' + @productsselection + ' From '
set @query = @query + '(select SalesPerson, Product, SamesAmount from Sales ) ps '
set @query = @query + 'pivot(sum(SamesAmount) for product in (' + @products + ')) as pvt'

exec sp_executesql @query 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-27T09:32:19.623

将代码移动到存储过程

```
 /*
    GetExamResults 'MECH', '2'
*/
Create Proc GetExamResults (@Course_Id varchar(100), @Semester varchar(10))
as
begin
    declare @subjname varchar(100)  
    declare @subjects varchar(7000)  
    declare @subjectsselection varchar(7000)  
    declare @SumSelection varchar(7000)  
    declare @NoOfSubjects int
    set @NoOfSubjects = 0

    set @subjects = ''  
    set @subjectsselection = '' 
    set @SumSelection = ''

    DECLARE subject_cursor CURSOR  
    FOR SELECT distinct Subject_Name FROM Exam_Result where course_id = @Course_Id And Semester = @Semester 

    OPEN subject_cursor  

    FETCH NEXT FROM subject_cursor  
    INTO @subjname  

    WHILE @@FETCH_STATUS = 0  
    BEGIN  
        set @subjects = @subjects + '[' + @subjname + '],'  
        set @subjectsselection = @subjectsselection + 'Sum(Isnull([' + @subjname + '],0)) As [' + @subjname + '],' 
        set @SumSelection = @SumSelection + 'Sum(Isnull([' + @subjname + '],0))+' 

        set @NoOfSubjects = @NoOfSubjects + 1

        FETCH NEXT FROM subject_cursor  
        INTO @subjname  
    End  
    CLOSE subject_cursor;  
    DEALLOCATE subject_cursor;  

    select @subjects = LEFT(@subjects, LEN(@subjects) - 1)  
    select @subjectsselection = LEFT(@subjectsselection, LEN(@subjectsselection) - 1)  
    select @SumSelection = LEFT(@SumSelection, LEN(@SumSelection) - 1)  

    print @subjects  
    print @subjectsselection  
    print @SumSelection

    declare @query nvarchar(4000)  

    set @query = 'select S.Enroll_Number, pvt.Student_Name, pvt.Course_Id, pvt.Semester, ' + @subjectsselection + ',' 
    set @query = @query + 'Exam_Type,' + @SumSelection + ' As Grand_Total, '
    set @query = @query + '(' + @SumSelection + ')' + '/' + convert(varchar(10),@NoOfSubjects) + ' As Avg'
    set @query = @query + ' From '  
    set @query = @query + '(select Enroll_Number, Student_Name, Course_Id, Semester, Subject_Name, MarksObtained, Exam_Type from Exam_Result ) ps '  
    set @query = @query + ' pivot(sum(MarksObtained) for Subject_Name in (' + @subjects + ')) as pvt'  
    set @query = @query + ' inner join Stud_Info S on S.Enroll_Number = pvt.Enroll_Number '
    set @query = @query + ' where pvt.Course_Id = ''' + @Course_Id + ''' and pvt.Semester = ''' + @Semester + ''''
    set @query = @query + ' group by S.Enroll_Number, pvt.Student_Name, pvt.Course_Id, pvt.Semester, Exam_Type'
    print @query
    exec sp_executesql @query  
end 
```

# wordpress - Wordpress - Tubepress Javascript 错误

> ID：10323180
> 
> 赞同：0
> 
> 时间：2012-04-25T20:24:14.530
> 
> 标签：wordpress, tubepress

想知道是否有人可以帮助我解决这个问题。我正在使用带有 tubepress 插件的 wordpress。出于某种原因，当您单击视频进行查看时，什么也没有发生。您可以滚动视频，它似乎是一个链接，但当您单击缩略图或文本时，它不会做任何事情。

有什么想法吗？

[http://www.cruxn.com/videos/](http://www.cruxn.com/videos/)

谢谢！

-马特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T07:15:32.307

你检查了 PHP error_log 吗？

另请查看您的浏览器控制台以查看是否有任何 JavaScript 错误。

# php - Drupal 预览/编辑损坏？CCK的任何自动保存？

> ID：10323182
> 
> 赞同：1
> 
> 时间：2012-04-25T20:24:20.453
> 
> 标签：php, drupal

## 对于“名称”的文本框页面，我有一个简单的内容类型。允许所有用户进行编辑，我注意到如果我有一个具有该内容类型的单个页面显示单个 CCK 字段，并且我想从 Jacob 更改为 John：

## 姓名：雅各布

有两个选项“编辑”和“查看”

当我点击“编辑”时，它允许我编辑约翰说“约翰”。

然后我单击“预览”来预览我的更改。

我注意到“Johnn”拼写错误，所以我点击页面顶部的“编辑”。

我注意到“Johnn”更改丢失了，文本框中显示的是“Jacob”

从预览切换回编辑模式时，是否有一些模块或东西可以保留更改/自动保存？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T20:30:28.270

在预览中，您应该能够直接在预览输出下方编辑内容。无需再次单击“编辑”选项卡进行编辑，因为这将刷新页面，这意味着您确实会丢失未保存的更改。

# ios - 如何使用相机将图片添加到表单？

> ID：10323184
> 
> 赞同：-1
> 
> 时间：2012-04-25T20:24:38.120
> 
> 标签：ios, camera

嗨，我想知道如何将相机添加到在线表格。

例如，用户添加他们的信息名称、标题等......他们也可以添加照片。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T20:38:29.900

您的意思是通过网页访问 iPhone 摄像头吗？目前这是不可能的。

# c++ - 使用向量读取输入文件

> ID：10323187
> 
> 赞同：0
> 
> 时间：2012-04-25T20:24:45.467
> 
> 标签：c++, file

我已经编写了一个代码来读取下面的文件，但它不起作用。输入文件：

```
2 1 16
16 0 0
1 1 1234
16 0 0
1 1 2345 
```

代码是：

```
std::ifstream input_file;
evl_wire wire;
int num_pins,width,cycles,no;
std::vector<int>IP;
while(input_file)
{
    input_file >> num_pins;//num_pins=2
    if (pins_.size() != num_pins) return false;
    for (size_t i = 0; i < pins_.size(); ++i)
    {
        input_file >> width;//width=1 for 1=0 ,=16 for i=2
        if (wire.width != width) return false;
        pins_[i]->set_as_output();
    }
    for (size_t i = 1; i < file_name.size(); i=i+1)
        input_file>>cycles;
    input_file>>no;
    pins_=IP;
} 
```

其中`std::vector<pin *> pins_;`在门类和`void set_as_output();`引脚类 2 中表示没有引脚，第一个引脚的宽度为 1，第二个引脚的宽度为 16。从文件 16 的第二行开始，没有周期引脚必须保持在 0 0，对于接下来的 1 个周期引脚必须分配 1 和 1234 作为输入。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T20:39:18.620

我不完全理解你的代码，但我没有看到你在任何地方打开输入文件。我认为应该是：

```
std::ifstream input_file;
evl_wire wire;
int num_pins,width,cycles,no;
std::vector<int>IP;
input_file.open("name of the file");
if(input_file.is_open())
{
    while(input_file >> num_pins) //num_pins=2
    {
        if (pins_.size() != num_pins) return false;
        for (size_t i = 0; i < pins_.size(); ++i)
        {
            input_file >> width;//width=1 for 1=0 ,=16 for i=2
            if (wire.width != width) return false;
            pins_[i]->set_as_output();
        }
        for (size_t i = 1; i < file_name.size(); i=i+1)
            input_file>>cycles;
        input_file>>no;
        pins_=IP;
    }
    input_file.close();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T20:42:29.803

您的代码的某些部分几乎可以肯定是错误的。其他部分我不太确定——它们对我来说没有多大意义，但也许我只是错过了一些东西。

```
while(input_file) 
```

这几乎总是一个错误。直到尝试从文件读取失败*后*，它才会感知文件的结尾。在典型情况下，您的循环将比预期多执行一次迭代。你可能想要的是这样的：

```
while (input_file >> num_pins) 
```

这将从文件中读取数据（或尝试读取），如果失败则退出循环。

```
if (pins_.size() != num_pins) return false; 
```

这不太清楚。如果我们已经知道它需要什么值，那么我们为什么要从文件中读取它根本不清楚（ vs.`num_pins`似乎也是如此）。`width``wire.width`

```
for (size_t i = 1; i < file_name.size(); i=i+1)
        input_file>>cycles; 
```

这让我觉得最令人费解的部分。保存文件名的字符串的大小与*什么*有关？这已经相当令人费解了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T04:34:45.500

我使用的功能：

```
bool input::validate_structural_semantics() 
    {
        evl_wire wire;
        std::ifstream input_file;std::string line;
        int x[]={1000};
        for (int line_no = 1; std::getline(input_file, line); ++line_no)
        std::string s; int i=0;
        std::istringstream iss; 
        do 
        { 
            std::string sub; 
            iss >> sub; 
            x[i]=atoi(sub.c_str());
            i++;
        }
        while (iss); 
        if (pins_.size()!=x[0]) return false;
        for (size_t i = 0; i < pins_.size(); ++i)
        {
            if (wire.width != x[i+1]) return false;
            pins_[i]->set_as_input();
        }
        for(size_t i=4;i<1000;i++)
        {
            for(size_t j=0;j<pins_.size();j++)
                pins_.assign(x[i-1],x[i+j]);
        }
        return true;
    } 
```

**此实现使用数组，但它不起作用，尽管没有任何编译错误。**

# ssas - 在 SSAS 中创建父子引用时出现问题

> ID：10323189
> 
> 赞同：1
> 
> 时间：2012-04-25T20:24:59.983
> 
> 标签：ssas

在我的数据仓库中，我有以下要创建父子层次结构的维度。我的问题是这个。主键是OfficerPeopleID，它既不是父项也不是子项。父级是 MgrPeopleID，子级是 PeopleID。
如果在将维度创建为 PeopleID 时更改默认键，它看起来好像可以工作，但随后我在处理时收到错误，因为它看到了 PeopleID 的多个副本。有多个的原因是因为它是 SCD 类型 2，主键 (OfficerPeopleID) 是表的代理键。我知道我不是唯一一个尝试在主键以外的字段上创建父子引用的人？谢谢！

![方面](../Images/54f525ba69abf8eaf88665c3951ada10.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T23:57:30.157

我不认为你会想要那样做。如果我理解正确，PeopleID 是您的自然密钥或源系统密钥，OfficerPeopleID 是您的 DW 代理密钥。在这种情况下，您需要有一列存储父代理键而不是父自然键。换句话说，您应该能够为表自己创建一个外键。根据您现在所拥有的，您可能拥有多个经理的记录，这会使您无法确定哪条记录是正确的。此外，为了让父子为您工作，子必须是表的键。

如果您想正确执行此操作，则应在 ETL 过程中填充 MgrOfficerPoepleID（新列）。如果您打算这样做，请确保在因为 SCD2 而有新行时更新管理器键值。但是，如果您仍希望将其作为 SSAS DSV 中的命名查询，您可以执行以下操作

```
SELECT        
    OffcerPeopleID,
    -- ... insert other columns here
    PeopleID,
    MgrPeopleID,

    (SELECT OfficerPeopleID
     FROM dbo.Employee
     WHERE(e.MgrPeopleID = PeopleID) AND (IsCurrent = 1)) AS MgrOfficerPoepleID
FROM dbo.OfficerPeopleDim AS e
WHERE IsCurrent = 1 -- this is your SCD2 flag. you could also use two date range columns 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T08:37:15.073

如果 PeopleID 包含重复记录，则不能这样做，要么使其唯一，要么使用这两个字段创建关系。

我还建议您在 DSV 上创建两个单独的条目，一个用于经理，另一个用于员工，查询如下：

经理：

```
select PeopleID as ManagerID, name as Name from OfficerPeopleDim 
```

员工：

```
select PeopleID as EmployeeID, name, MgrPeopleId as Manager
from OfficerPeopleDim
where MgrPeopleId is not null 
```

所以它看起来像这样（左）并在右边产生结果： ![在此处输入图像描述](../Images/e47f97a9c709f9dccac9b6b0c2c5e59d.png)

# php - PHP 调用返回 XML/JSON 的 url

> ID：10323191
> 
> 赞同：1
> 
> 时间：2012-04-25T20:25:02.340
> 
> 标签：php, xml

我是 PHP 的绝对初学者。很抱歉有一个非常基本的 API 问题。我在编码时卡住了，我需要调用一个返回 XML 或 JSON 的 URL。现在我必须在一个变量中捕获它。

例如，我编写了以下代码：

```
class Search {
   private $documents = array();
   public function __construct() {
      $xmlDoc = new DOMDocument();
      $xmlDoc->load("solr.xml");
      ..... 
```

现在我直接加载一个 XML。我不想这样做，而是：

第 1 步：我想调用一个返回 XML 或 JSON 的 http url。
Step2：我需要将它存储在像上面的 xmlDoc 这样的变量中
Step3：然后我当然想解析它。

我对第 3 步没有任何问题，但我只需要一些关于如何完成第 1 步和第 2 步的指示或帮助？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T20:29:29.753

`load`应该接受一个 URL 作为参数。

```
$xmlDoc = new DOMDocument();
$xmlDoc->load('http://example.com/path/to/file.xml'); 
```

或者，您可以使用`file_get_contents`将 URL 下载到字符串。

```
$xml = file_get_contents('http://example.com/path/to/file.xml');
$xmlDoc = new DOMDocument();
$xmlDoc->loadXML($xml); 
```

或者对于 JSON：

```
$json = json_decode(file_get_contents('http://example.com/path/to/file.json')); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T20:42:13.897

要使用 Json 执行此操作，您首先需要一个包含一些 json 变量的页面。

1.  您可以通过键入以下内容自己执行此操作：

    ```
    $jsonVar = array('var1','var2'); // several variables
    echo encode_json($jsonVar); 
    ```

2.  您可以通过键入以下内容访问这些变量：

    ```
    $jsonUrl = 'http://example.com/json.php';
    $jsonUrl = json_decode(file_get_contents($jsonUrl)); 
    ```

3.  要显示这些变量之一，您可以键入：

    ```
    echo $jsonUrl[1]; // you can use print_r($jsonUrl); //for displaying the right array numbers to access the vars 
    ```

# ruby-on-rails - Lynda Rails 培训中的 ActiveRecord::RecordNotFound 错误（第 9 章 - 删除/销毁）

> ID：10323192
> 
> 赞同：0
> 
> 时间：2012-04-25T20:25:11.887
> 
> 标签：ruby-on-rails

我是新人，所以请原谅我完全的无知。我在 Rails 3.2.3 上，正在学习 Lynda Ruby on Rails Essentials 课程。我已完成标题中列出的章节，但在确认删除按钮后出现错误页面。这是一个视频，向您展示[操作中的错误](http://screencast.com/t/0a1d3gUxyZ)。

我查看了以下文档以确认我没有输入错误。

这是我的 list.html.erb

```
<div class="subject list">
<h2>Subjects</h2>

<%= link_to("Add New Subject", {:action => 'new'}, :class => 'action new') %>

<table class="listing" summary="Subject List">
    <tr class="header">
        <th>&nbsp;</th>
        <th>Subject</th>
        <th>Visible</th>
        <th>Pages</th>
        <th>Actions</th>
    </tr>
    <% @subjects.each do |subject| %>
    <tr>
        <td><%= subject.position %></td>
        <td><%= subject.name %></td>
        <td class="center"><%= subject.visible ? 'Yes' : 'No' %></td>
        <td class="center"><%= subject.pages.size %></td>
        <td class="actions">
            <%= link_to("Show", {:action => 'show', :id => subject.id}, :class => 'action show') %>
            <%= link_to("Edit", {:action => 'edit', :id => subject.id}, :class => 'action edit') %>
            <%= link_to("Delete", {:action => 'delete', :id => subject.id}, :class => 'action delete') %>
        </td>
    </tr>
    <% end %>
</table> 
```

这是我的 delete.html.erb

```
<%= link_to("<< Back to List", {:action => 'list'}, :class => 'back-link') %>

<div class="subject delete">
    <h2>Delete Subject</h2>

<%= form_for(:subject, :url => {:action => 'destroy'}, :id => @subject.id) do |f| %>

    <p>Are you sure you want to permanently delete this subject?</p>

    <p class="reference-name">Subject name: <%= @subject.name %></p>

    <div class ="form-buttons">
        <%= submit_tag("Delete Subject") %>
        </div>

    <% end %>

</div> 
```

这是我的subjects_controller.rb

```
class SubjectsController < ApplicationController

    def index
    list
    render('list')
end

def list
    @subjects = Subject.order("subjects.position ASC")
  end

  def show
    @subject = Subject.find(params[:id])
  end

  def new
    @subject = Subject.new
  end

  def create
    # Instantiate a new object using form parameters
    @subject = Subject.new(params[:subject])
    # Save the object
    if @subject.save
      # If save succeeds, redirect to the list action
      redirect_to(:action => 'list')
    else
      # If save fails, redisplay the form so user can fix problems
      render('new')
    end
  end

  def edit
     @subject = Subject.find(params[:id])
  end

  def update
     # Find object using form parameters
      @subject = Subject.find(params[:id])
      # Update the object
      if @subject.update_attributes(params[:subject])
        # If save succeeds, redirect to the list action
        redirect_to(:action => 'show', :id => @subject.id)
      else
        # If save fails, redisplay the form so user can fix problems
        render('edit')
      end
  end

  def delete
    @subject = Subject.find(params[:id])
  end

  def destroy
     Subject.find(params[:id]).destroy
     redirect_to(:action => 'list')
  end
end 
```

这是上面视频中引用的[结果错误页面。](http://screencast.com/t/lngHci1gR)

如果我能得到一些帮助来理解为什么我不能正确删除文件，那就太好了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T06:41:06.550

抱歉，我从未听说过“Lynda Ruby on Rails Essentials 课程”，但我可以从您发布的代码中看到，您的删除表单看起来完全一团糟，您有一个 form_for，但您使用的是 submit_tag！那没有意义。问题是，如果您查看日志文件，您会看到传递给删除操作的参数不包含 id，因此当您使用时，`@subject = Subject.find(params[:id])`您将收到您所看到的错误。

解决方案 - 将 submit_tag 更改为 f.submit 或将 form_for 更改为 form_tag 并确保调用了正确的路由，这样 id 应该通过 params 哈希传回。

你的日志文件堆栈跟踪总是你最好的朋友，尽快学会理解它，你会发现你的生活更轻松。

**更新**

出于多种原因，我认为您最好的选择是将您的表单更改为如下所示

```
<%= link_to("<< Back to List", {:action => 'list'}, :class => 'back-link') %>

<div class="subject delete">
    <h2>Delete Subject</h2>

    <p>Are you sure you want to permanently delete this subject?</p>

    <p class="reference-name">Subject name: <%= @subject.name %></p>

    <div class ="form-buttons">
        <%= button_to "Delete", subject_path(@subject), method: :delete %>
    </div>

</div> 
```

第一种方法不起作用的原因是因为您错过了前导开始标记“<”，这就是显示文本而不是按钮的原因

您不需要该表格，您没有输入任何数据，因此只需使用 button_to 并告诉它执行删除操作。

我还没有测试代码，但它应该没问题

# jquery - 在引导 2.0 的页面加载时更改正文标记

> ID：10323193
> 
> 赞同：0
> 
> 时间：2012-04-25T20:25:14.150
> 
> 标签：jquery, html, css, twitter-bootstrap

我正在使用引导程序，并且我有一个带有引导程序的 scrollspy 页面。我无法将 scrollspy 添加到其他页面，因为我的链接意外触发。是否可以使用简单的 jQuery 函数来添加：

`data-spy="scroll"`以及`data-target=".subnav"`该特定页面加载的页面正文。

将滚动间谍添加到 a`div="span12"`似乎不起作用，但是，该功能在放置在 body 上时确实有效。

如果其他人有使用此方法或其他方法的简单解决方案，请告诉我。

这是我目前的代码：

```
<body> <!-- Add it here to make it work -->
 <div class="span12" style="background: #fff;"> <!-- OR add it here and see if it works, if so then I can avoid the function all together. -->
  <div class="span11">
  <header>
     <h1>TITLE</h1>
     <h3>The full history of..<small>By Jane Doe</small></h3>
     <div class="subnav">
       <ul class="nav nav-pills">
       <li class="active"><a href="#overview">Introduction</a></li>
       ...
       </ul>
  </div>
  </header>

  <section id="overview"></section>
  <section id....
 </div>
</div> 
```

我用来修复 topnav 的脚本：

```
$(document).scroll(function(){
    // If has not activated (has no attribute "data-top"
if (!$('.subnav').attr('data-top')) {
    // If already fixed, then do nothing
    if ($('.subnav').hasClass('subnav-fixed')) return;
    // Remember top position
    var offset = $('.subnav').offset()
    $('.subnav').attr('data-top', offset.top);
}

if ($('.subnav').attr('data-top') - $('.subnav').outerHeight() <= $(this).scrollTop())
    $('.subnav').addClass('subnav-fixed');
else
    $('.subnav').removeClass('subnav-fixed');
}); 
```

和`$('#navbar').scrollspy();`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T20:29:55.923

尝试

```
$(document).load(function() {
    $('body').attr('data-spy', 'scroll').attr('data-target', '.subnav');
}); 
```

# .net - 哪些编程习惯会影响窗口句柄的数量？

> ID：10323197
> 
> 赞同：3
> 
> 时间：2012-04-25T20:25:29.447
> 
> 标签：.net, windows, winforms, window-handles

我收到运行时错误“创建窗口句柄时出错”。根据我的研究，我知道此错误通常表明应用程序已超过 Windows 的 10,000 个句柄限制，我应该通过确保没有不必要地创建句柄并正确处理来解决该错误。

但是，我找不到任何有关导致创建窗口句柄的原因的文档。每次我实例化一个窗体时都会创建一个窗口句柄吗？每次我实例化一个控件？每次我实例化一个类？要不然是啥？

是不是说对于light-UI的应用，使用的句柄数量不需要特别在意，但是对于图形元素较多的应用，程序员就必须采取措施限制窗口句柄的数量？这就是“无窗口控件”和“轻量级控件”的全部意义吗？还有其他我应该了解的相关概念吗？

到目前为止，我还没有认为我的应用程序是 UI 密集型的。但是，它确实显示了一个图表网格，其中每个图表都是由几个组件控件组成的用户控件。对于大型分析，控制的总数可能达到数千。假设我想保留这个网格，有没有我可以应用的特定技术来保持句柄倒计时？例如，有没有办法“渲染”一个控件，使其仍然可见，但不再需要窗口句柄？

-TC

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T20:36:57.983

> 但是，我找不到任何有关导致创建窗口句柄的原因的文档。

这可能是因为 .net 是一种抽象。

在 Win32 的“真实”世界中，窗口句柄由类型表示，`HWND`并赋予几乎所有东西。每个按钮、菜单等都可以有一个`HWND`.

实际上，这并不完全正确。您可以创建的每个对象*类*（在 C Windows API 中）都有一个句柄。每个类通常只绘制整个控件 - 但是，某些控件可能会绘制更复杂的控件，例如额外的按钮。他们要么可以创建另一个窗口（控件），要么可以使用 GDI 来绘制它。

因此，并非您看到的所有内容都会生成 HWND - 但大多数情况都会生成。

有趣的是，您可能想知道要在 C/Win32 中创建控件，您使用`CreateWindow()`. *一切都是一个窗口*。

所以现在回到你的.net APP。如果您依赖的控件通过其底层`CreateWindow`调用创建大量对象，您将发出大量`HWND`变量并最终用完唯一标识符。

[Mark Russinovich 在他推动 Windows 的限制时](http://blogs.technet.com/b/markrussinovich/archive/2009/09/29/3283844.aspx)涵盖了实际限制，他故意尝试耗尽他的应用程序的分配。

那么是什么编程习惯导致了这种情况呢？创建太多 Window 对象。这可能与应用程序窗口意义上的实际 Windows 不对应，而是对应于控件的数量。避免这种情况的唯一方法是减少使用，或者如果第三方导致问题，请根据您一次可以显示的实际限制来设计您的应用程序。

另一种方法是生成您自己的控件，而不是使用子控件，而是绘制它们。然而，这可能是很多工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T20:57:29.607

简而言之，窗口句柄被赋予每个交互的 UI 元素。每个真实的窗口、每个文本框、网格单元、按钮、菜单等等。尽管非交互式控件不需要窗口句柄，但如果编写不当，它们仍可能使用它们。

通常很难达到窗口句柄限制。如果发生这种情况并且您的应用程序不是特别密集的 UI，这通常意味着您正在泄漏句柄。如果您使用编写不当的可视化组件库而没有在应该释放资源时发生这种情况。窗口句柄是非托管资源，在不再需要时必须小心释放它。如果您碰巧使用库并观察到句柄泄漏，最好是更改库。它通常比听起来更难，因此作为一个**糟糕**的解决方法，您可以尝试强制垃圾收集器收集对象并**希望**在终结器/析构函数中释放所有非托管资源。

```
GC.Collect(); 
```

不能保证这会有所帮助，因为如果您使用的控件写得不好，即使在它们的终结器中，它们也可能不会释放句柄。同样，这是不好的做法，但如果您别无选择，可能会有所帮助。

如果您只使用标准的 .NET 控件，请确保您`Close()`在使用后的每个表单，而不仅仅是隐藏它。这将处理一个非对话框窗体及其所有控件，如果它们是标准控件，则不会泄漏。对话框表单需要在代码中处理。详细的文档在[这里](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.close.aspx)。

# c - OpenSSL：EVP_DecryptFinal_ex 中发生错误

> ID：10323199
> 
> 赞同：3
> 
> 时间：2012-04-25T20:25:37.867
> 
> 标签：c, linux, openssl, encryption

我有以下openssl解密代码：

```
int decrypt(unsigned char *plain, unsigned char *key, unsigned char *iv, unsigned char *cipher, int len)
{
    int i;

    unsigned char outbuf[2000];
    int outlen, tmplen;
    EVP_CIPHER_CTX ctx;
    EVP_CIPHER_CTX_init(&ctx);
    EVP_DecryptInit_ex(&ctx, EVP_aes_128_cbc(), NULL, key, iv);

    if(!EVP_DecryptUpdate(&ctx, outbuf, &outlen, cipher, len))
    {
            EVP_CIPHER_CTX_cleanup(&ctx);
            return 0;
    }

    printf("\nBytes decrypted (outlen) : %d\n",outlen);

    if(!EVP_DecryptFinal_ex(&ctx, outbuf + outlen, &tmplen))
    {
            EVP_CIPHER_CTX_cleanup(&ctx);
            return 0;
    }

    printf("\nBytes decrypted (tmplen) : %d\n",tmplen);

    outlen += tmplen;
    EVP_CIPHER_CTX_cleanup(&ctx);

    printf("\nLength decrypted :%d\n",outlen);

    printf("\nOutbuf: ");
    for(i=0; i<outlen; i++){
       plain[i] = outbuf[i];    
       printf(" %02x ",outbuf[i]);
    }
    printf("\n");
        return outlen;
} 
```

ctx 初始化如下：

```
SSL_library_init();
SSL_load_error_strings();
meth = SSLv23_server_method();
ctx = SSL_CTX_new (meth);
if (!ctx) {
     ERR_print_errors_fp(stderr);
     exit(1);
}
SSL_CTX_set_verify(ctx,SSL_VERIFY_PEER,NULL); 
SSL_CTX_load_verify_locations(ctx,CACERT,NULL);

if (SSL_CTX_use_certificate_file(ctx, "./server.pem", SSL_FILETYPE_PEM) <= 0) {
       ERR_print_errors_fp(stderr);
       exit(1);
}
if (SSL_CTX_use_PrivateKey_file(ctx, "./server.key", SSL_FILETYPE_PEM) <= 0) {
    ERR_print_errors_fp(stderr);
    exit(1);
} 
```

server.key 文件是使用以下命令生成的：

```
openssl genrsa -des3 -out server.key 1024 
```

我向解密函数传递了一个 unsigned char* 类型的密码，密码长度为 16 个字节（纯文本为 2 个字节），长度为 16 个字节（unsigned char）的密钥和长度为 8 个字节（unsigned char）的 IV。

我从解密函数得到以下输出：

```
 Bytes decrypted (outlen) : 0
 19637:error:06065064:digital envelope routines: EVP_DecryptFinal_ex: bad decrypt: evp_enc.c: 337: 
```

以下是evp_enc.c的源码：

```
 int EVP_DecryptFinal_ex(EVP_CIPHER_CTX *ctx, unsigned char *out, int *outl)
{
int i,n;
unsigned int b;

*outl=0;
b=ctx->cipher->block_size;
if (ctx->flags & EVP_CIPH_NO_PADDING)
    {
    if(ctx->buf_len)
        {
        EVPerr(EVP_F_EVP_DECRYPTFINAL_EX,EVP_R_DATA_NOT_MULTIPLE_OF_BLOCK_LENGTH);
        return 0;
        }
    *outl = 0;
    return 1;
    }
if (b > 1)
    {
    if (ctx->buf_len || !ctx->final_used)
        {
        EVPerr(EVP_F_EVP_DECRYPTFINAL_EX,EVP_R_WRONG_FINAL_BLOCK_LENGTH);
        return(0);
        }
    OPENSSL_assert(b <= sizeof ctx->final);
    n=ctx->final[b-1];
    if (n == 0 || n > (int)b)
        {
        EVPerr(EVP_F_EVP_DECRYPTFINAL_EX,EVP_R_BAD_DECRYPT);
        return(0);
        }
    for (i=0; i<n; i++)
        {
        if (ctx->final[--b] != n)
            {
             EVPerr(EVP_F_EVP_DECRYPTFINAL_EX,EVP_R_BAD_DECRYPT); // 337
            return(0);
            }
        }
    n=ctx->cipher->block_size-n;
    for (i=0; i<n; i++)
        out[i]=ctx->final[i];
    *outl=n;
    }
else
    *outl=0;
return(1);
} 
```

任何人都可以提出解决方案/指出问题吗？

谢谢。

# c - 如何使用 Opencv SparseMatrix

> ID：10323201
> 
> 赞同：3
> 
> 时间：2012-04-25T20:25:51.070
> 
> 标签：c, opencv, sparse-matrix

我想在 OpenCV 中创建一个稀疏矩阵。

如何对该矩阵进行基本操作，例如：

从矩阵元素放置或访问数据。

干杯

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-27T11:01:10.153

使用 C++ 接口可能更合适。请注意，文档 [1] 中的示例代码缺少模运算，因此失败。

```
const int dims = 2;
int size[] = {3, 20}; // rows and columns if in two dimensions
SparseMat sparse_mat(dims, size, CV_32F);
for(int i = 0; i < 1000; i++) {
    // create a random index in dims dimensions
    int idx[dims];
    for(int k = 0; k < dims; k++)
        idx[k] = rand() % size[k];

    sparse_mat.ref<float>(idx) += 1.f;
}

cout << "bottom right element @ (2,19) = " << sparse_mat.ref<float>(2,19) << "\n";

Mat dense;
sparse_mat.convertTo(dense, CV_32F);
cout << dense; 
```

给出以下输出

```
bottom right element @ (2,19) = 19
[9, 23, 13, 26, 18, 13, 18, 15, 13, 17, 13, 18, 19, 6, 20, 20, 12, 15, 15, 15;
 17, 17, 14, 16, 12, 14, 17, 15, 15, 18, 24, 18, 13, 22, 18, 11, 18, 22, 17, 15;
 19, 16, 14, 10, 18, 19, 10, 17, 18, 15, 24, 22, 18, 18, 18, 23, 21, 16, 14, 19] 
```

[1] OpenCV 参考手册。2.4.3 版。2012 年，第 46.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T21:05:52.610

[集和稀疏矩阵](http://www.micc.unifi.it/ballan/downloads/ocv_tutorial.pdf)，第 23 页：

> OpenCV 中的稀疏矩阵使用 CvSet 来存储元素。

```
CvSparseMat* get_color_map( const IplImage* img ) 
{
  int dims[] = { 256, 256, 256 };
  CvSparseMat* cmap = cvCreateSparseMat(3, dims, CV_32SC1);
  for( int i = 0; i < img->height; i++ ) for( int j = 0; j < img->width; j++ )
  { 
    uchar* ptr=&CV_IMAGE_ELEM(img,uchar,i,j*3);
    int idx[] = {ptr[0],ptr[1],ptr[2]};
    ((int*)cvPtrND(cmap,idx))[0]++; 
  }

  // print the map
  CvSparseMatIterator it;
  for(CvSparseNode *node = cvInitSparseMatIterator( mat, &iterator );
       node != 0; node = cvGetNextSparseNode( &iterator )) 
  {
    int* idx = CV_NODE_IDX(cmap,node); 
    int count=*(int*)CV_NODE_VAL(cmap,idx);
    printf( “(b=%d,g=%d,r=%d): %d\n”, idx[0], idx[1], idx[2], count ); 
  }

  return cmap; 
} 
```

# operators - “<>”是什么意思？

> ID：10323203
> 
> 赞同：1
> 
> 时间：2012-04-25T20:25:55.547
> 
> 标签：operators

查看我的演讲幻灯片中的代码示例，我注意到这一点：

```
c = head();
s = null;

while (c <> null && s == null) {
  if (c.value().matches("33812"))
    s = c

  c = next
} 
```

虽然我基本上了解代码的作用，但我不了解 while 循环条件“c <> null”的这个特定部分。

提前致谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-25T20:26:53.440

`!=`几乎可以肯定，这只是（“不等于”）的错字/大脑。`<>`在 Basic 和 SQL 中使用，但在我熟悉的任何类 C 语言中都没有。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T20:26:55.297

`c <> null`等于`c != null`，表示`c`不等于`null`。我想不出任何使用它的语言，但我知道它们存在。（Haskell 使用`<>`，但它用于*完全*不同的东西，并且使用`/=`null 因为它看起来像符号≠。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T20:32:12.897

如前所述，<> 表示 != 或不等于。这背后的原因是，如果一个操作数严格大于/小于另一个操作数，则它不能相等，因此 <> 实际上意味着除了 == 之外的所有数字可能性，即 !=。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-25T20:28:54.470

`<>`并`!=`表示“不等于”。SQL 使用`<>`一般；根据语言的不同，这要么等同`!=`于其词法分析器，要么不受其支持。

# php - Show db row with a specific not null column in foreach loop before others are displayed

> ID：10323214
> 
> 赞同：0
> 
> 时间：2012-04-25T20:26:38.733
> 
> 标签：php, mysql, database, loops, foreach

I have a listings table, and each listing has column called 'top'. Basically, if top is not null, I want that listing to show up first, then the others.

Right now, my code is like this:

```
foreach ($results as $result):
    echo $result->name;
endforeach; 
```

This will show me everything, but I want the rows with 'top' not null to show up first. What's the best way to go about this?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T20:28:29.023

Can't you apply an `ORDER BY` to the query that feeds `$results`?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T20:33:08.053

I agree with Aaron... the best thing to do is to order them so that they are first in the query.

If for some reason you couldn't do that you could do a few other things:

1.  Sort the object or array in PHP... may have to use a custom function .. if that's the case see: [Sort Object in PHP](https://stackoverflow.com/questions/124266/sort-object-in-php)

2.  Grab the rows that only have the NULL first, print them, then grab the ones that aren't null.

3.  You could loop through the array twice. First only printing the NULLs, then again to print the others.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T20:37:17.810

Try

`foreach ($result as $row){`

Then specify each element you want in order.

`echo $row['top']`

`echo $row['your next data row']...` and have them space exactly how you want.

And if you need it formated, try using `<pre>` first.

You can also add a `if` statment.

`$data = $row['top'] if($top == 1) { then echo this } else {echo the values that are null }`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-25T20:42:29.570

Based on your comment below @Aaron Bertrand's answer, you would need an order clause in your sql like:

```
ORDER BY ISNULL(`top_ad`), the_rest_of_your_order_clause 
```

# perl - 如何使用 perl 在两个变量之间建立关系，类似于代谢网络

> ID：10323222
> 
> 赞同：2
> 
> 时间：2012-04-25T20:27:22.797
> 
> 标签：perl

假设我生成了一些随机字母和随机数

```
A 1
Z 2
C 3
L 2
E 4 
```

和类似的另一组

```
1 K
4 I
2 P
5 R
6 S
7 U 
```

现在我们可以找到在第一种情况下链接到并且类似地`2`在`Z`第二组中链接到我们可以说并且被链接到 所以最初我已经生成了前两个步骤。我有点困惑如何进行休息？`L``2``P``Z``L``P`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T21:27:24.703

只是为了推荐一种截然不同的方法，如果您比 perl 更熟悉 SQL，可能更容易考虑，您可以查看[DBD::CSV](http://search.cpan.org/~hmbrand/DBD-CSV-0.33/lib/DBD/CSV.pm)。然后，您可以使用简单的连接语句完成您想要的操作。只需按照链接页面上的示例进行操作即可。如果您不了解 SQL，那么使用已经发布的数组散列可能会更好。当我到达安装了 DBD::CSV 的机器时，我将发布实际代码......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-25T23:41:13.847

也许你需要的是所有的关系，就像你向我们展示的那样？

这是一个执行此操作的示例程序。如果您需要不同的东西，请说明。

```
use strict;
use warnings;

my %data1 = qw(
  A 1
  Z 2
  C 3
  L 2
  E 4
);

my %data2 = qw(
  1 K
  4 I
  2 P
  5 R
  6 S
  7 U
);

#  Convert to arrays indexed by the numbers
#
my @data1;
push @{ $data1[$data1{$_}] }, $_ for keys %data1;

my @data2;
push @{ $data2[$_] }, $data2{$_} for keys %data2;

# Find all the mappings between the datasets
#
for my $i (0 .. $#data1) {
  my $data1 = $data1[$i] or next;
  my $data2 = $data2[$i] or next;
  print "@$data1 => @$data2\n";
} 
```

**输出**

```
A => K
Z L => P
E => I 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-25T21:51:59.397

```
#!/usr/bin/perl -w
use strict;
use Data::Dumper;
my (@n,@s);

sub generate_random_string
{
    my @chars=('a'..'z');
    my $random_string;
    $random_string.=$chars[rand @chars];
    return $random_string;
}

print "one\n";
foreach(1..5)
{
    my $range = 10;
    my $random_number = int(rand($range));
    push (@n,$random_number);
    my $random_string=&generate_random_string;
    push(@s,$random_string);
    print $random_number." ".$random_string."\n";
}
my (@nn,@ss);
print "two\n";
foreach(1..6)
{
    my $range = 10;
    my $random_number = int(rand($range));
    push (@nn,$random_number);
    my $random_string=&generate_random_string;
    push(@ss,$random_string);
    print $random_number." ".$random_string."\n";
}

my %h1;

# prepare data
for (my $i=0;$i<=$#n;$i++)
{
    $h1{$i}{'a'}=$s[$i];
    $h1{$i}{'i'}=$n[$i];
}
my %h2;
for (my $i=0;$i<=$#nn;$i++)
{
    $h2{$i}{'a'}=$ss[$i];
    $h2{$i}{'i'}=$nn[$i];
}
# end prepare data

my %result;

foreach (keys %h2)
{
    my $letter=$h2{$_}{'a'};
    my $number=$h2{$_}{'i'};
    my @rarr;
    foreach (keys %h1)
    {
    if ($h1{$_}{'i'}==$number)
        {
            push(@rarr,$h1{$_}{'a'});
        }
    }
    if ($#rarr>=0)
    {
        @{$result{$letter}}=@rarr;
    }
    @rarr=undef;
}
foreach (keys %result)
{
    print join(',',@{$result{$_}})." connected to ".$_."\n";
} 
```

结果：

```
one
8 s
2 g
6 z
7 g
7 a
two
7 e
8 w
3 r
1 c
0 t
7 h
a,g connected to e
s connected to w
a,g connected to h 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-26T01:11:35.557

[图形](http://search.cpan.org/perldoc/Graph)模块可以提供帮助。事实上，[图论](http://en.wikipedia.org/wiki/Graph_theory)中的概念是思考这类问题的正确方法，而不是用哈希和数组来试图重新解决已经解决的问题。

```
#!/usr/bin/env perl

use strict; use warnings;
use Graph::Directed;
use Set::CrossProduct;

my $g = Graph::Directed->new;

my %first = qw(A 1 Z 2 C 3 L 2 E 4);
my %second = qw(1 K 4 I 2 P 5 R 6 S 7 U);

for my $h (\ (%first, %second) ) {
    $g->add_edge($_, $h->{$_}) for keys %$h;
}

print "All weakly connected components\n";

for my $wcc ( $g->weakly_connected_components ) {
    print "[@$wcc]\n";
}

my $it = Set::CrossProduct->new([ [keys %first], [values %second]]);

print "Connectedness tests\n";

while (my $case = $it->get) {
    my $is_connected = $g->same_weakly_connected_components(@$case);
    printf(
        "%s are %s in the same weakly connected component\n",
        "[@$case]", $is_connected ? '' : 'not'
    );
} 
```

## 输出

### 所有弱连接组件

```
[R 5]
[E 4 我]
[K 1 A]
[2 ZLP]
[S 6]
[7U]
[C 3]
```

### 连通性测试

```
[ZS] 不在同一个弱连通分量
[ZI] 不在同一个弱连通分量中
[ZK] 不在同一个弱连接分量中
[ZU] 不在同一个弱连通分量
[ZP] 在同一个弱连通分量中
[ZR] 不在同一个弱连通分量中
[AS] 不在同一个弱连通分量中
[AI] 不在同一个弱连接分量中
[AK] 在同一个弱连接分量中
[AU] 不在同一个弱连接分量中
[AP] 不在同一个弱连接组件中
[AR] 不在同一个弱连接分量中
[CS] 不在同一个弱连通分量中
[CI] 不在同一个弱连接分量中
[CK] 不在同一个弱连接分量中
[CU] 不在同一个弱连接分量中
[CP] 不在同一个弱连通分量中
[CR] 不在同一个弱连通分量中
[ES] 不在同一个弱连接分量中
[EI] 在同一个弱连通分量中
[EK] 不在同一个弱连接分量中
[EU] 不在同一个弱连通分量中
[EP] 不在同一个弱连通分量中
[ER] 不在同一个弱连接分量中
[LS] 不在同一个弱连接分量中
[LI] 不在同一个弱连通分量中
[LK] 不在同一个弱连通分量中
[LU] 不在同一个弱连通分量中
[LP] 在同一个弱连接分量中
[LR] 不在同一个弱连接分量中
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-25T20:53:35.553

您可能希望使用数组的哈希来解决您的问题。例如，如果您已经知道 Z、L 和 P 是通过 2 连接的，并且您有这样的数据结构

```
my %hash_of_arrays = ( '2' => ['Z', 'L', 'P' ]); 
```

已经。现在你发现'Q'也连接到'2'你会

```
push(@{hash_of_arrays{'2'}}, 'Q'); 
```

其他情况是当您遇到新的 $key 时，您可能希望将新数组插入哈希中：

```
my $array = []
$hash_of_arrays{$key} = $array 
```

希望我理解你的正确...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-25T20:33:15.917

你会想要一个数组的散列，这将需要使用数组引用。

```
#! /usr/bin/perl -w

my @a1 = qw( 1 K 4 I 2 P 5 R K 6 S 7 U );

my %HoA1;

for ( my $i = 0; $i < scalar @a1 - 1; $i++ ) {
    unless( defined $HoA1{ $a1[$i] } ) {
        $HoA1{ $a1[$i] } = [];
        push @{$HoA1{ $a1[$i] }}, $a1[$i+1];
    } else {
        push @{$HoA1{ $a1[$i] }}, $a1[$i+1];
    }
}

for my $key ( sort keys %HoA1 ) {
    print "$key: @{$HoA1{ $key }} \n";
} 
```

# c# - 取消选择 ContextMenuStrip 上的 ToolStripItem

> ID：10323224
> 
> 赞同：1
> 
> 时间：2012-04-25T20:27:31.497
> 
> 标签：c#, winforms, contextmenustrip, toolstripitem

简单的问题：

我可以`.Select`（`ToolStripItem`比如，如果我在打开上下文菜单条时想要一个预选选项），但我似乎找不到设置`.Selected`为 false 或以某种方式取消选择它的方法！

是否可以？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T21:23:09.987

ToolStrip 类中有一个私有方法 ClearAllSelections，它可以从项目中删除选择。您可以通过反射调用它：

```
MethodInfo method = typeof(ToolStrip).GetMethod("ClearAllSelections", BindingFlags.NonPublic | BindingFlags.Instance);
method.Invoke(yourContextMenuStrip, null); 
```

所有选择都将被删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T20:35:22.600

您正在寻找 Checked 财产吗？

```
public void mnuUncheck()
{
    foreach (ToolStripMenuItem Item in mnuStripMain.Items)
    {
       Item.Checked = false;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-12T20:36:20.047

采用 Sergey 的方法，ToolStripItem 上还有一个内部方法，您可以调用它：

```
MethodInfo methodInfo = typeof(ToolStripItem).GetMethod("Unselect", BindingFlags.NonPublic | BindingFlags.Instance);
methodInfo.Invoke(yourToolStripItem, null); 
```

# mdbg - MDBG 调试 - 如何检查静态变量的值

> ID：10323226
> 
> 赞同：0
> 
> 时间：2012-04-25T20:27:41.223
> 
> 标签：mdbg

我正在使用 MDBG 调试正在运行的进程，但我不知道如何检查静态变量的值。有什么办法吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T12:38:49.137

MDbg 可以捕获“本地”变量——我认为这也意味着 staic。如果变量与堆栈帧相关联，您可以使用 GetActiveLocalVars 函数获取该值。

```
MDbgThread t = proc.Threads.Active;
MDbgFrame f=t.CurrentFrame;
foreach (MDbgValue v in f.Function.GetActiveLocalVars(f))
                                {
                                    Console.WriteLine(v.Name);
                                    Console.WriteLine(v.Value);
                                } 
```

# ruby - 如何让 DataMapper 返回特定数量的元素？

> ID：10323227
> 
> 赞同：0
> 
> 时间：2012-04-25T20:27:42.727
> 
> 标签：ruby, datamapper

说我有

```
class MyClass
  include DataMapper::Resource
  property :id, Serial
  property :my_property, Text
end 
```

如何拨打电话以返回最多 3 个项目
，例如

```
MyClass.all(:my_property => "some_text", :max => 3) 
```

:max => n 表示返回 n 项。

我很确定存在一个内置函数，但我找不到它。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T20:39:06.813

利用`:limit`

```
MyClass.all(:my_property => "some_text", :limit => 3) 
```

# wordpress - 音频 HTML5 标记在 Wordpress 中不起作用

> ID：10323231
> 
> 赞同：0
> 
> 时间：2012-04-25T20:27:55.927
> 
> 标签：wordpress, html5-audio

我正在将我当前的网站迁移到 Wordpress 中，并且无法让音频 HTML5 标记正常工作。我基本上使用的是我在当前网站上使用的现有代码的复制和粘贴版本（见下文，另请注意，我只编辑了源 src 位置以使用整个 URL，替换了 php echo，并包装了div 中的音频标签）。

我也已经检查了文件以查看它们是否有效。

WordPress代码：

```
 <div><audio controls="controls" preload="none" onPlay="_gaq.push(['_trackEvent', 'Audio', 'Play', 'Radio-2011-08-01']);">

        <source src="http://www.thelovelydaze.com/files/music/TLZRADIO08012011.ogg" type="audio/ogg" />        
        <source src="http://www.thelovelydaze.com/files/music/TLZRADIO08012011.mp3" type="audio/mp3" />

        Your browser does not support audio streaming.

</audio></div> 
```

当前代码：

```
<audio controls="controls" preload="none" onPlay="_gaq.push(['_trackEvent', 'Audio', 'Play', 'Radio-2011-08-01']);">

        <source src="../files/music/TLZRADIO08012011.ogg" type="audio/ogg" />        
        <source src="../files/music/TLZRADIO08012011.mp3" type="audio/mp3" />

        <?php echo $AudioNote ?>

</audio> 
```

供参考：Wordpress 网站：[http](http://thelovelydaze.com/WP/2011/08/01/the-lovely-daze-radio-2/) ://thelovelydaze.com/WP/2011/08/01/the-lovely-daze-radio-2/ 当前网站：[http ://www.thelovelydaze.com/music/tlz-radio -20110801.php](http://www.thelovelydaze.com/music/tlz-radio-20110801.php)

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T21:38:33.097

我没有在您的网站中找到 html5 js。请补充一点，因为所有浏览器仍然不支持 html 5 和 css 3

# git - 将具有多个初始提交的 git repo 导入 svn

> ID：10323233
> 
> 赞同：1
> 
> 时间：2012-04-25T20:28:11.853
> 
> 标签：git, import, git-svn

我基本上有以下 git repo 布局

```
x ---- a -------------- b  -------------- c  ---->
         y -- 1 -- 2 -- ┛  z -- i -- j -- ┛ 
```

其中`x`, `y`,`z`是初始提交。我有这些多个初始提交，因为我使用将多个 git 存储库合并到一个大存储库中

```
git fetch git://github.com/<user>/<repo>.git refs/heads/master:refs/heads/<repo>
git merge --no-commit <repo>
git read-tree --reset -u HEAD
git read-tree -u --prefix=lib/<repo> <repo>
git commit -m "Pulling <repo>"
git branch -d <repo> 
```

多次。所有子模块基本上具有相同的文件布局。

要将 git repo 导入 svn，我初始化了一个空的 svn 存储库并通过克隆它

```
git svn clone http://some/svn/repo/my-project 
```

然后我尝试了

```
cd my-project
git remote add dev /path/to/working/git/big-repository
git pull dev master
git svn rebase 
```

但是由于所有子模块在其顶级`pom.xml`(

有什么方法可以将 git 存储库导入 svn 以保留历史记录？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T20:40:54.693

希望其他人会提供更优雅的答案，但如果问题确实是这个冲突文件，您可能会使用`git filter-branch`该文件从项目历史记录中删除该文件。

[这个页面](http://help.github.com/remove-sensitive-data/)有一个例子。

# javascript - jQuery，运行 jQuery 语句时出现“500 内部服务器错误”

> ID：10323237
> 
> 赞同：-2
> 
> 时间：2012-04-25T20:28:18.663
> 
> 标签：javascript, jquery

每当触发 jQuery 时，我都会收到错误`500 Internal Server Error`，有没有人知道为什么下面的代码可能会导致这种情况？

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<script src="../meta/js/jquery-1.7.2.js"></script>
<script>

    $(document).ready(function() {
        $('#form1').submit(function(e){
            e.preventDefault();
            alert('I clicked it');
        });
    });

</script>
</head>
<body>

<form name="form1" method="post">
    <button id="button">grab user data</button>
    <select></select>
</form>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T20:30:39.873

我猜是因为这个变量：

```
<%=button.ClientID %> 
```

没有其他任何东西（显示）可以表示任何其他会引发错误的东西。

你能澄清'jQuery被触发'的意思吗？这是否意味着“点击”？或者只是加载这个页面（我假设是后者）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T20:33:03.647

我猜想这行给出了错误：

```
$('#<%=button.ClientID %>') 
```

硬编码一个值并测试它：

```
$('#buttonID') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T20:35:24.287

您的按钮位于带有 action="" 的标签内。这将导致回发到“/”。如果您的服务器无法正确处理此问题，您将收到内部服务器错误。

~~如果您只想显示警报，您可以在 jQuery 事件对象上调用 preventDefault。请参阅下面的示例：~~

 ~~```
$(document).ready(function() {
     $('#<%=button.ClientID %>').click( function(e) {
        e.preventDefault();
        alert("i clicked it");
     });
}); 
```~~  ~~**编辑：** 忘记我上面写的。它不起作用。相反，使用表单上的提交事件。像这样：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
    <script src="@{'/public/javascripts/jquery-1.6.4.min.js'}" type="text/javascript" charset="${_response_encoding}"></script>
    <script>
        $(document).ready(function() {
            $('#form1').submit(function(e){
                e.preventDefault();
                alert('I clicked it');
            });
        });

    </script>
</head>
<body>

<form id="form1" method="post" action="">
    <button id="button">grab user data</button>
    <select></select>
</form>

</body>
</html> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-25T20:43:44.787

为了实现你想要的，这将完成这项工作：

```
<html>
<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script>
    $(document).ready(function() {
         $('#myButton').on('click',function(){
            alert("i clicked it");
          });
    });
</script>
</head>
<body>
    <button id="myButton">Click Me!</button>
</body>
</html> 
```

`$(document).ready`用于在您的页面被渲染后执行您的代码，然后`$('myButton')`将获取任何具有 id 为“myButton”的元素，然后您将使用方法“on”来附加您想要的任何事件，在这种情况下，您将要选择“点击”事件，那么您应该提供一个匿名函数，您将在其中放置您想要在该操作上执行的代码。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2015-11-18T13:50:09.527

您将`submit`事件附加到，`#form1`但您的表单没有 ID，只有名称。您必须按名称选择表单，`$("form[name='form1']")`或者给它一个 id `id="form1"`。~~

# ember.js - 当 Ember.Select 没有被子类化时，为什么 Ember.Select 上的 selectionBinding 不尊重 contentBinding？

> ID：10323238
> 
> 赞同：1
> 
> 时间：2012-04-25T20:28:21.923
> 
> 标签：ember.js

当我继承 Ember.Select 时，选择绑定可以成功设置为控制器`'content.selection'`在哪里。`content`当我尝试在模板中内联执行此操作时，绑定没有连接。这个问题可以在这个演示中看到：http: [//jsfiddle.net/cmQsX/](http://jsfiddle.net/cmQsX/)

模板：

```
<script type="text/x-handlebars" >
    {{view Ember.Select contentBinding="ResAdmin.adminController" selectionBinding="content.selection" optionLabelPath="content.name" optionValuePath="content.id" }}
    {{view ResAdmin.foo}}

    Selected: {{ResAdmin.selectedRestaurant.priceCategory.name}}
</script>​ 
```

编码：

```
ResAdmin = Ember.Application.create({});

ResAdmin.adminController = Ember.ArrayProxy.create({
    selection: null,
    content: [
        {
        id: '92E9862E-DAE5-4CC8-ACDF-7E6418641F7D',
        name: "$"},
    {
        id: '889C0E73-1587-41D5-8073-FD29FF76CF00',
        name: "$$"},
    {
        id: '47A56B26-A64A-4967-A9F6-B9D69B2CA145',
        name: "$$$"},
    {
        id: '417993DB-48BF-4BA9-BE0A-D6A53C6D8325',
        name: "$$$$"}
    ],
    getObjectById: function(id) {
        return this.get('content').filterProperty('id', id).get('firstObject');
    }
});

ResAdmin.selectedRestaurant = Ember.Object.create({
    priceCategoryBinding: 'ResAdmin.adminController.selection'
});

ResAdmin.foo = Ember.Select.extend({
    contentBinding:"ResAdmin.adminController",
    selectionBinding:"content.selection",
    optionLabelPath:"content.name",
    optionValuePath:"content.id"})

var defaultItem = ResAdmin.adminController.getObjectById('47A56B26-A64A-4967-A9F6-B9D69B2CA145');
console.log(defaultItem);
ResAdmin.adminController.set('selection', defaultItem); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T21:51:48.943

当您将选择指定为时，它会起作用`selectionBinding="ResAdmin.adminController.selection"`，请参阅[http://jsfiddle.net/pangratz666/rXudx/](http://jsfiddle.net/pangratz666/rXudx/)：

```
{{view Ember.Select
    contentBinding="ResAdmin.adminController"
    selectionBinding="ResAdmin.adminController.selection"
    optionLabelPath="content.name"
    optionValuePath="content.id" }} 
```

* * *

这似乎是一个错误。[您应该在GitHub 上](https://github.com/emberjs/ember.js/issues)提交票证。

# python - django-storages with Amazon S3 - 防止覆盖

> ID：10323241
> 
> 赞同：13
> 
> 时间：2012-04-25T20:28:39.133
> 
> 标签：python, django, file-upload, amazon-s3

我注意到 django-storages（或者可能是 Django 的存储 API 本身）会覆盖同名的文件。这对我来说是个问题，因为我的网站允许用户上传，所以我需要确保文件永远不会被覆盖。

理想情况下，我希望能够从视图级别将文件名传递给存储后端，但我正在努力寻找一种优雅的方式来做到这一点。如果在某个地方有一个开关，我可以做类似的事情`overwrite=False`并让后端提出自己的替代名称，我会同样高兴。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-04-25T21:04:13.600

如果您在 django-storages 中使用的是 s3boto 后端而不是旧的 s3 后端，那么您可以使用以下`AWS_S3_FILE_OVERWRITE`设置进行更改：[https ://bitbucket.org/david/django-storages/src/83fa2f0ba20c/storages/backends/s3boto.py #cl-43](https://bitbucket.org/david/django-storages/src/83fa2f0ba20c/storages/backends/s3boto.py#cl-43)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-08-22T22:50:25.863

[@Mark Lavin 的回答](https://stackoverflow.com/a/10323773/2800876)恰当地指出了`AWS_S3_FILE_OVERWRITE`避免`False`这个问题的设置。

您可能还想稍微改进一下文件名间距。您可以在 S3 上以您想要的任何名称保存文件（它不必是用户上传的文件的名称）。因此，您可以使用名称“user_uploads/[user_id]/[user_generated_file_name]”保存文件。作为下载的一部分，您还可以将文件名设置为您想要的任何名称。如果您将用户上传的文件名保存为模型上的字段，则可以将其指定为下载文件的视图中的文件名。

# scala - 使用（自我）类型参数实现类的对象集合的类型推断

> ID：10323246
> 
> 赞同：1
> 
> 时间：2012-04-25T20:29:02.483
> 
> 标签：scala, type-inference, scala-collections, type-parameter, existential-type

考虑以下类定义：

```
class Person[+T <: Person[T]]
class Student() extends Person[Student]
class Professor() extends Person[Professor] 
```

我想要一个学生和教授的名单：

```
val persons = List(new Student(), new Professor()) 
```

但这无法编译并出现以下错误：

```
type arguments [Person[Person[Any]]] do not conform to class Person's type parameter bounds [+T <: Person[T]] 
```

感谢 Daniel C. Sobral 对我之前的相关问题[How to define case classes with members with unbound type parameters?的回答。](https://stackoverflow.com/questions/10025815/how-to-define-case-classes-with-members-with-unbound-type-parameters)我知道存在类型会在这里解决问题。这编译：

```
val persons = List[Person[T] forSome {type T <: Person[T]}](new Student(), new Professor()) 
```

`<: Person[T]`问题是由类 Person 的声明的类型参数中的上限引起的。删除上限可以让编译器推断列表的类型参数，使其编译：`List[Person[Person[Person[Any]]]]`据我所知。

**问题**

1.  为什么编译器不能推断出可以编译的列表的任何类型？
2.  存在类型是最不冗长的，而且可能更棘手（参见丹尼尔对我上面链接的上一个问题的回答）：是否有替代显式存在类型来创建学生和教授列表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T07:41:33.673

我相信你在第二条评论中已经提到了一个可能的替代方案

```
val persons = List[Person[_]](new Student(), new Professor()) 
```

但据我了解，Scala 中执行此类操作的惯用方式是在 Person 中使用类型声明，并在 Student 和 Professor 中定义它：

```
trait Person {
  type PersonImpl <: Person
  def colleagues: Seq[PersonImpl]
}

class Student extends Person {
  type PersonImpl = Student
  def colleagues = Seq(this)
}

class Professor extends Person {
  type PersonImpl = Professor
  def colleagues = Seq(this)
}

val persons = List(new Student, new Professor) 
```

Martin Odersky 在 Scala 语言中也提到，[他正在考虑统一类型参数和抽象类型成员](https://groups.google.com/d/msg/scala-language/PV4q6O1qIh8/yG4p8PA2Jf8J)。

根据您的实际用例，最简单的解决方案可能是依赖方法覆盖：

```
trait Person {
  def colleagues: Seq[Person]
}

class Student extends Person {
  def colleagues: Seq[Student] = Seq(this)
}

class Professor extends Person {
  def colleagues: Seq[Professor] = Seq(this)
}

val persons = List(new Student, new Professor) 
```

# grails - Grails 数据库迁移 - dbm-gorm-diff 混淆

> ID：10323248
> 
> 赞同：0
> 
> 时间：2012-04-25T20:29:10.523
> 
> 标签：grails, grails-plugin

我刚刚为已经包含大约 100 个域的 Grails 1.3.7 应用程序安装了数据库迁移插件。我运行了最初的 dbm-generate-gorm-changelog，它生成了一个看起来不错的 changelog.groovy。

我添加了一个具有 3 个属性的域，然后运行：

dbm-gorm-diff testing.groovy

我期望的是一个可以创建我的新域的变更日志。我得到的是一个包含 1260 行变更集的变更日志。现在，它确实包含我的新域。但它也包含我的大多数（不是全部）其他域，这些域在脚本之间的 60 秒内没有变化。我是否理解这是如何工作不正确的？还是我运行了错误的命令？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T22:28:11.320

您需要“运行”第一次迁移以将其放入 Liquibase 表中，因此当您运行第二次时，它会产生差异。您刚刚生成了两个独立的文件。

[请参阅http://grails-plugins.github.com/grails-database-migration/docs/manual/guide/2%20Getting%20Started.html](http://grails-plugins.github.com/grails-database-migration/docs/manual/guide/2%20Getting%20Started.html)上的“典型初始工作流程”

# jquery - 用meteorJS中的服务数据填充mongodb

> ID：10323249
> 
> 赞同：4
> 
> 时间：2012-04-25T20:29:11.487
> 
> 标签：jquery, mongodb, meteor

好的，所以我正在玩meteorJS，并且正在使用雅虎金融服务来使用jquery 获取一些json 格式的数据。收到数据后，我想将其存储到我的 mongo DB 中。我为此目的的代码如下

```
Stocks = new Meteor.Collection("stocks");
$.ajax({
  type:'GET',
  url:'http://query.yahooapis.com/v1/public/yql?q=select*from%20yahoo.finance.quotes%20where%20symbol%20in%20(%22GOOG%22)&env=store://datatables.org/alltableswithkeys&format=json',
  success:function(data){
    if (Meteor.is_server) {
          Meteor.startup(function () {
            if (Stocks.find().count() === 0) {
                Stocks.insert(data);
            }
          });
        }
    }
}); 
```

现在你可以看到我不知道我所做的是否正确。我知道您可以使用我所拥有的 json 结构插入 mongo db，但不确定这是否正确。任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-25T22:18:36.563

你快到了，只是稍微倒退了一点。您应该先检查它是否是服务器，然后再获取数据。你也应该使用 Meteor 内置的 http 方法。

首先，您需要添加 http 包。在你的流星项目的根目录中，从终端运行它：

`meteor add http`

那么相关代码就是：

```
if(Meteor.is_server){
  Meteor.startup(function () {
    if(Stocks.find().count() === 0){
      var url = "http://query.yahooapis.com/v1/public/yql" + 
                "?q=select*from%20yahoo.finance.quotes%20where" +
                "%20symbol%20in%20%28%22GOOG%22%29&env=" +
                "store://datatables.org/alltableswithkeys&format=json"
      Meteor.http.get(url, function(error,results){
        var stock_data = JSON.parse(results.content).query.results.quote
        Stocks.insert(stock_data)
      });
    }
  });
} 
```

**Meteor 的 http 方法的文档：http:** [//docs.meteor.com/#meteor_http](http://docs.meteor.com/#meteor_http)

# java - Java 搜索：“块”

> ID：10323257
> 
> 赞同：2
> 
> 时间：2012-04-25T20:29:40.090
> 
> 标签：java, search

有没有人在Java中见过以下内容？

```
public void methodName(){ 
   search:
     for(Type[] t : Type[] to){
       do something...
   }
} 
```

有人可以指出我在这种情况下使用“搜索：”的文档吗？搜索“搜索：”一直没有成效。

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-25T20:31:57.833

这是一个*标签*。来自Java 语言规范的[§14.7](http://docs.oracle.com/javase/specs/jls/se7/html/jls-14.html#jls-14.7)：

> 语句可能有标签前缀...
> 
> *（枯燥的语法省略了，标记起来很痛苦）*
> 
> 与 C 和 C++ 不同，Java 编程语言没有`goto`语句；标识符语句标签与出现在标记语句中的任何位置的`break`(§14.15) 或(§14.16) 语句一起使用。`continue`

您经常看到标签的一个地方是嵌套循环，您可能希望尽早跳出两个循环：

```
void foo() {
    int i, j;

    outerLoop:                     // <== label
    for (i = 0; i < 100; ++i) {
        innerLoop:                 // <== another label
        for (j = 0; j < 100; ++j) {
            if (/*...someCondition...*/) {
                break outerLoop;   // <== use the label
            }
        }
    }
} 
```

通常，`break`在内循环中只会破坏内循环，但不会破坏外循环。但是因为它是使用标签的 *定向* `break`，所以它打破了外循环。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T20:32:44.643

这是一个标记循环的例子。

它允许您`break`或`continue`目标循环而不是当前循环。

```
Outer:
    for(int intOuter=0; intOuter < intArray.length ; intOuter++)
    {
      Inner:
      for(int intInner=0; intInner < intArray[intOuter].length; intInner++)
      {
        if(intArray[intOuter][intInner] == 30)
        {
          blnFound = true;
          break Outer; // this line breaks the outer loop instead of the inner loop.
        }  

      }
    } 
```

示例取自：[http ://www.java-examples.com/java-break-statement-label-example](http://www.java-examples.com/java-break-statement-label-example)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T20:32:05.513

它是 JLS 中定义的 Java 标签：http: [//docs.oracle.com/javase/specs/jls/se5.0/html/statements.html#78994](http://docs.oracle.com/javase/specs/jls/se5.0/html/statements.html#78994)

# java - 并行调用mysql数据库时的注意事项

> ID：10323259
> 
> 赞同：0
> 
> 时间：2012-04-25T20:29:43.077
> 
> 标签：java, mysql, database, parallel-processing, connector-j

我必须第一次创建一个 mysql 数据库以供多个应用程序并行使用。到目前为止，我对 mysql 数据库的唯一经验是单个程序（例如网络服务器）查询数据库。现在我正在进入一个场景，我将拥有几个 CXF java servlet 类型的程序，以及在相同模式上编辑和读取的后台服务器。我在所有实例中都使用 Connector/J JDBC 驱动程序连接到数据库。

我的问题是：我需要做什么才能确保并行访问不会成为问题。我意识到我需要在适当的地方使用交易，但我真正迷失的地方是管理。例如。每次 servlet 完成一项工作时，我是否需要关闭连接？每个访问数据库的程序都需要一个唯一的用户吗？我必须对我的 Connector/J 对象做些什么吗？我必须以不同的方式声明我的表吗？我错过了什么还是我没有想到什么？我对如何处理事务和 SQL 本身有一个很好的想法，但是当谈到设置我的数据库时我需要做的事情时，我很迷茫。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T20:34:13.917

您应该维护一个连接池。在几百毫秒的数量级上创建连接真的很昂贵。因此，对于大容量应用程序，缓存和重用它们是有意义的。

对于您的 servlet，它取决于您使用的容器。JBoss 之类的东西将提供池作为容器的一部分。可以通过数据源定义来定义，通过JNDI访问。其他容器，如 tomcat，可能依赖于 C3PO 之类的东西。

这些框架中的大多数都返回 JDBC 连接的自定义实现，这些实现实现了 close() 方法，其逻辑将连接返回到池。您应该熟悉具体实施的细节，以确保您以受支持的方式做事

至于并发方面的考虑，您应该熟悉乐观/悲观锁定和事务隔离级别的概念。这些都有权衡，只有在给定应用程序的操作环境时才能确定正确答案。

考虑到用户，大多数应用程序都有一个代表应用程序的用户，称为读/写用户。此用户应仅有权从与您的应用程序关联的表、索引、序列等中读取和写入记录。应用程序的所有实例都将在其连接字符串中指定此用户。

如果您熟悉上述概念，您将完成 95% 的工作。

还有一件事。正如管理方面的评论所指出的，您的数据库引擎是一个重要的考虑因素。您应该熟悉这些差异和调整/配置选项。

# xml - 如何使用经典 ASP 读取 XML 根节点中的属性？

> ID：10323260
> 
> 赞同：2
> 
> 时间：2012-04-25T20:29:45.370
> 
> 标签：xml, asp-classic

我正在尝试使用经典 ASP 读取此 XML 的根节点中的“ts”属性，但我似乎无法获得正确的语法。我能够读取下面各种节点和嵌套节点中的属性，但我需要来自根节点的信息。

任何人都可以提出解决方案吗？

XML 代码片段：

```
<?xml version="1.0" encoding="utf-8"?>
<results ts="2012-04-24 17:10:45" nm="Test project" fin="0" bal="131494" vot="131494" tab="614" cltab="172" pol="1737" clpol="72" stpol="1735">
    <choices>
        <choice id="1" tot="1" vot="211" e="1" />
        <choice id="2" tot="1" vot="196" e="-1" />
    </choices>
    <area id="1" bal="131494" vot="131494" bal2="131494" vot2="131494" tab="614" cltab="172" pol="1737" clpol="72" stpol="1735">
        <tab>
            <cg cgId="1" tot="132" clos="131" />
            <cg cgId="2" tot="23" clos="23" />
            <cg cgId="3" tot="459" clos="18" />
        </tab>
    </area>
    </areas>
</results> 
```

用于读取工作正常的典型节点的 ASP 代码片段...

```
Dim objResultXML
Set objResultXML = Server.CreateObject("Microsoft.XMLDOM")
objResultXML.async = False
objResultXML.Load (Server.MapPath("FileToParse.xml"))

ReDim ResultArray(3,0)
Set NodeList = objResultXML.documentElement.selectNodes("choices/choice")
For Each Node In NodeList
    If CStr(ResultArray(0,0))<>"" Then  ''< Balance signs
        ReDim Preserve ResultArray(3,UBound(ResultArray,2)+1)
    End if
    ResultArray(0,UBound(ResultArray,2)) =CLng(Node.getAttribute("id"))
    ResultArray(1,UBound(ResultArray,2)) =CLng(Node.getAttribute("tot"))
    ResultArray(2,UBound(ResultArray,2)) =CLng(Node.getAttribute("vot"))
    ResultArray(3,UBound(ResultArray,2)) =CStr(Node.getAttribute("e"))

Next
Set NodeList=Nothing 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T22:55:25.420

`.documentElement`是`results`元素。

您所需要的只是：`objResultXML.documentElement.getAttribute("ts")`

# asp.net - vb.net 单选按钮选择

> ID：10323261
> 
> 赞同：2
> 
> 时间：2012-04-25T20:29:45.830
> 
> 标签：asp.net, vb.net

我在 vb.net 中有以下内容

```
 <asp:RadioButtonList ID="rbEdit5" runat="server"  RepeatDirection="horizontal" >
  <asp:ListItem Value="1" >Yes</asp:ListItem>
  <asp:ListItem Value="0" >No</asp:ListItem>
 </asp:RadioButtonList> 
```

我需要以编程方式选择 2 个列表项之一。如何在 vb.net 中以编程方式选择上面说“是”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T20:39:08.937

这应该有效：

```
rbEditTop25.Items.FindByText("Yes").Selected = True 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T20:32:39.730

```
For Each li As ListItem In rbEditTop25.Items
     If li.Text= "Yes" Then
       li.Selected = True
     End If
Next 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T20:36:28.130

```
rbEditTop25.SelectedValue = "1" 
```

应该做的伎俩！

# database - VB.NET NHibernate 配置

> ID：10323262
> 
> 赞同：0
> 
> 时间：2012-04-25T20:29:52.493
> 
> 标签：database, vb.net, nhibernate, orm

我似乎在 Visual Basic 2010 Express 上找不到任何适合 VB.NET 的（和最近的）NHibernator 示例。然而，我一直在努力拼凑我能做的一切。

但是我似乎**总是得到这个错误。**

```
A first chance exception of type 'System.IO.FileNotFoundException' occurred in System.Xml.dll
A first chance exception of type 'NHibernate.Cfg.HibernateConfigException' occurred in NHibernate.dll
A first chance exception of type 'NHibernate.Cfg.HibernateConfigException' occurred in NHibernate.dll
a: An exception occurred during configuration of persistence layer. 
```

我`nhibernator.cfg.xml`在项目的根目录下包含以下内容

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-configuration xmlns="urn:nhibernate-configuration-2.2">

  <!-- For simplicity, the NHibernate configuration is stored in this file.
  It must be named hibernate.cfg.xml and marked in Visual Studio to be copied
  to the output folder.  -->

  <session-factory>

    <!-- By default NHibernate is aggressive in closing connections between
    SQL statments.  This unfortunately causes a problem when reading ID
    numbers assigned by Access (e.g. in AutoNumber fields).  See comments
    in the Test 1 section of Program.cs. -->

    <property name="hibernate.connection.release_mode">on_close</property>

    <property name="connection.provider">NHibernate.Connection.DriverConnectionProvider</property>
    <property name="dialect">NHibernate.JetDriver.JetDialect, NHibernate.JetDriver</property>
    <property name="connection.driver_class">NHibernate.JetDriver.JetDriver, NHibernate.JetDriver</property>

    <!-- The Sample.mdb file is located in the folder containing the
    solution file.  This is three folders upward.  Relative paths
    are supported in Jet connection strings.  -->

    <property name="connection.connection_string">Provider=Microsoft.ACE.OLEDB.12.0;Data Source=database.accdb</property>
  </session-factory>
</hibernate-configuration> 
```

任何帮助和见解表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T22:47:49.243

> 我在项目的根目录中有 nhibernator.cfg.xml 包含以下内容

我想你想`hibernate.cfg.xml`默认命名它。否则将配置指向新文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T20:35:27.940

文件是否设置为复制到输出文件夹？它位于 Visual Studio 的属性中。您应该将其设置为始终复制。

# asp.net-mvc-3 - 布局导航上的 MVC3 操作链接

> ID：10323263
> 
> 赞同：1
> 
> 时间：2012-04-25T20:29:53.597
> 
> 标签：asp.net-mvc-3, razor

我正在编写我的第一个 MVC3 Web 应用程序。我在我的 SiteLayout.cshtml 中有这样的导航编码。

```
<table width="950" border="0" align="center" cellpadding="0" cellspacing="0" style="height: 40px;">
            <tr align="center">
                <td>@Html.ActionLink( 
                    "Home", 
                    "Index", 
                    null, 
                    new { @class= "link1"}) 
                </td>
                <td><img src="@Url.Content("~/Content/images/img3.gif")" alt="" width="2" height="40" /></td>
                <td>@Html.ActionLink( 
                    "Events", 
                    "Events", 
                    null, 
                    new { @class= "link1"}) 
                </td>
                <td><img src="@Url.Content("~/Content/images/img3.gif")" alt="" width="2" height="40" /></td>
                <td>@Html.ActionLink( 
                    "Membership", 
                    "Membership", 
                    null, 
                    new { @class= "link1"}) 
                </td>
                <td><img src="@Url.Content("~/Content/images/img3.gif")" alt="" width="2" height="40" /></td>
                <td>@Html.ActionLink( 
                    "Photos", 
                    "Photos", 
                    null, 
                    new { @class= "link1"} )
                </td>
                <td><img src="@Url.Content("~/Content/images/img3.gif")" alt="" width="2" height="40" /></td>
                <td>@Html.ActionLink( 
                    "About Us", 
                    "AboutUS", 
                    null, 
                    new { @class= "link1"})
                </td>
                <td><img src="@Url.Content("~/Content/images/img3.gif")" alt="" width="2" height="40" /></td>
                <td>@Html.ActionLink( 
                    "Contact Us", 
                    "ContactUs", 
                    null, 
                    new { @class= "link1"})</td>
            </tr>
        </table>`` 
```

每当我切换到使用相同 layout.cshtml 的第二个控制器注册时，操作链接返回的结果是

```
http://localhost:49365/registration/Photos 
```

即使当前在注册控制器上，我如何使操作链接指向站点控制器？我已经尝试将“站点”放在我当前具有空值的位置。如果我这样做，那么它可以正常工作，但会显示这个 url

```
http://localhost:49365/Site/Photos?class=link1 
```

并且 css 类不再应用于链接。我希望的网址是相同的网址

[http://localhost:49365/site/photos](http://localhost:49365/site/photos)

如果我使用默认站点控件中的链接，则会显示该链接。任何指导将不胜感激。

许多祝福，

贾里德

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T20:58:06.113

这只是一个重载决议的问题。所有重载的列表可以在[MSDN](http://msdn.microsoft.com/en-us/library/system.web.mvc.html.linkextensions.actionlink.aspx)上找到。

正如所写，你最终使用了`HtmlHelper, string, string, object, object` [重载](http://msdn.microsoft.com/en-us/library/dd492124.aspx)，你的第一个`null`是`routeValues`，所以匿名对象是你的`htmlAttributes`.

你在正确的轨道上通过`"Site"`而不是`null`获得正确的控制器，但这会让你使用`HtmlHelper, string, string, string, object, object` [超载](http://msdn.microsoft.com/en-us/library/dd504972.aspx)。第一个对象仍然是`routeValues`，这就解释了为什么它变成了一个查询字符串。

要指定`htmlAttributes`，您可以继续传递一个`null`占位符`routeValues`

```
@Html.ActionLink( 
                "Photos", 
                "Photos",
                "Site", 
                null, 
                new { @class= "link1"} ) 
```

或者你使用[了命名参数](http://msdn.microsoft.com/en-us/library/dd264739.aspx)

```
@Html.ActionLink( 
                "Photos", 
                "Photos",
                "Site", 
                htmlAttributes: new { @class= "link1"} ) 
```

# ruby-on-rails - after_sign_in_path_for 操作未在 Rails 中加载 Geokit

> ID：10323272
> 
> 赞同：0
> 
> 时间：2012-04-25T20:30:32.057
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, devise, geokit

我试图在用户登录后将 Geokit 位置刷新到会话。我有以下代码。

```
# app/controllers/application_controller.rb
def after_sign_in_path_for(resource_or_scope)
  session[:geo_location] = User.geocode(current_user.city)
end 
```

但我收到以下错误。

```
NoMethodError in Devise::SessionsController#create

undefined method `model_name' for Geokit::GeoLoc:Class 
```

似乎 Geokit 没有在设计控制器之前加载。任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T21:58:30.610

问题是`after_sign_in_path_for`必须返回一个有效的 url 对象，而您没有检查它的[文档](http://rubydoc.info/github/plataformatec/devise/master/Devise/Controllers/Helpers#after_sign_in_path_for-instance_method)。

# javascript - Html5 postMessage 使用 jQuery，但不是 jQuery-postMessage 脚本

> ID：10323273
> 
> 赞同：2
> 
> 时间：2012-04-25T20:30:33.053
> 
> 标签：javascript, jquery, html, dom

因此，我在[Html5 Demos](http://html5demos.com/postmessage2)中搞乱了 Html5 PostMessage 示例，并创建了一个示例[jsfiddle](http://jsfiddle.net/shelbyz/Ksd7R/)，看看我是否理解它是如何协同工作的。

该演示使用了`document.getElementById(...)`我认为可以用 jQuery 选择器替换的`$("#...")`，但我被卡住了，因为从 jQuery 选择器返回的对象无法访问`contentWindow`while `document.getElementById(...)`。

```
document.getElementById("frame1").contentWindow.postMessage("Hello from another domain", "http://dl.dropbox.com"); // works

$("#frame1").contentWindow.postMessage("Hello from another domain", "http://dl.dropbox.com"); // no dice 
```

我并不完全精通 jQuery，无法知道从选择器调用结果对象的众多方法中的哪一个，以返回我将从`document.getElementById(...)`.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-25T20:31:54.083

```
$("#frame1")    // This a jQuery object that encapsulate the DOM element.
$("#frame1")[0] // this is the DOM element.
//Or
$("#frame1").get(0) // this is the DOM element. 
```

完整代码：

```
$("#frame1")[0].contentWindow.postMessage("Hello from another domain", "http://dl.dropbox.com"); // DICE! 
```

[**更新小提琴**](http://jsfiddle.net/Ksd7R/4/)

但是我发现使用 jQuery 选择`id`然后从中提取 DOM 元素而不使用 jQuery 很尴尬。怎么了`document.getElementById`？那15个额外的字符？

# django - 知道模型中 def __unicode__ 语句中的日期时间字段，以及它在模板中的表示？

> ID：10323284
> 
> 赞同：1
> 
> 时间：2012-04-25T20:31:14.707
> 
> 标签：django, django-models, django-templates

我有时会在模板中使用模型实例。例如，在下面的模型中，我可以使用 {{ leg }}，我希望它会在 def **unicode** (self): 部分中显示信息。然而，时区使事情变得复杂。有没有办法让我的 def **unicode** (self): 当模型实例嵌入到带有模板标签的模板中时，参数可以感知时区？现在，它强制字符串（这是我的默认时区）的感知 unicode 日期表示，但这对用户没有意义。

```
class Leg(models.Model):
    startpoint = models.CharField(max_length=50)
    endpoint = models.CharField(max_length=50)
    drive_date_time = models.DateTimeField(verbose_name='Start date and time', blank=True, null=True)
    riders = models.ManyToManyField(Rider, blank=True)
    drivers = models.ManyToManyField(Driver, blank=True)
    carpool = models.ForeignKey(Carpool,  blank=True, null=True)
    open_to_prefs = models.BooleanField(default=True)

    class Meta:
        ordering = ['drive_date_time']
        verbose_name = 'Drive leg'

    def __unicode__(self):
        return  str(self.drive_date_time)  + ' | to: ' + self.endpoint 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T14:35:29.533

我发现如果你需要渲染一个与 datetimefield 关联的文本字符串，你可以使用 pytz 关联的 .astimezone() 方法。这在很多情况下都有帮助，包括上述情况。

# javascript - Javascript字符串数组是否自动用逗号分隔？

> ID：10323285
> 
> 赞同：0
> 
> 时间：2012-04-25T20:31:27.713
> 
> 标签：javascript

在阅读[了这个讨论](https://stackoverflow.com/questions/201724/easy-way-to-turn-javascript-array-into-comma-separated-list)和[这篇文章](http://www.hunlock.com/blogs/Mastering_Javascript_Arrays)之后，我仍然有这个问题。假设我有以下代码段：

```
var arr = new Array(3);
arr[0] = "Zero";
arr[1] = "One";
arr[2] = "Two";

document.write(arr.join(",")); 
```

如果我用 替换该`document.write()`行`document.write(arr);`，它们是否等效？替换语句是否自动以逗号作为分隔符连接数组元素？

提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T20:38:07.407

“但我不知道为什么”

这是因为一切都具有`toString`作为其原型的一部分的功能。当你把它写出来时，这个函数被调用来获取它的字符串表示形式。对于数组，默认处理方式与`join`.

```
Array.prototype.toString.apply([1,2,3]) == Array.prototype.join.apply([1,2,3])
> true 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T20:35:00.197

默认情况下，将数组传递给 document.write() 将用逗号分隔它们。

[http://jsfiddle.net/XnW7V/](http://jsfiddle.net/XnW7V/)

```
var arr = new Array(3);
arr[0] = "Zero";
arr[1] = "One";
arr[2] = "Two";

document.write(arr); //outputs Zero,One,Two 
```

# java - 启动从文件导出的 Eclipse 程序

> ID：10323289
> 
> 赞同：0
> 
> 时间：2012-04-25T20:31:54.810
> 
> 标签：java, console, manifest, launch

我已经阅读了许多相同主题的问题，但没有一个能解决我的问题..

我知道我可以在控制台 java -jar myappname.jar 上使用此命令轻松启动我的应用程序

但我想要的是点击我的 .jar 文件导出的 eclipse 并启动控制台，里面有我的应用程序，你明白吗？

我使用此配置完成了导出：

File>Export>Jar File 选中我项目的所有类选中“Export generated class files and resources”选中“Export java source files and resources”选中“Compress the contents of the Jar File”

按下一个

选择“导出带有编译错误的类文件” 选择“导出带有编译警告的类文件”

按下一个

选择“生成清单文件”选择密封罐子

在“选择应用程序入口点的类：”我选择我的类，其中 void main 方法。

jar 出现在我的桌面上，但是当我双击它时，它不会启动控制台。为什么？？提前致谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T20:41:14.553

通过双击文件（或快捷方式）启动 jar 将不会显示终端。一种解决方法是更改​​操作系统中 .jar 文件的默认执行操作，以打开终端并从终端内执行命令。像下面这样的脚本可能会成功（使用 Bash）：

```
#!/bin/sh
/usr/bin/gnome-terminal -x java -jar $*
sleep 3 
```

然后右键单击 jar 文件并选择脚本作为该文件类型运行的默认程序。

免责声明：上面的脚本对我来说实际上是失败的。如果在终端中运行的命令是“top”，它工作正常，所以看起来你可能需要稍微调整一下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-02T17:36:45.610

这取决于您的操作系统。如果您使用 Windows，则可以创建 .bat 或 .exe 文件。您可以在 Internet 上找到“如何创建”教程。如果您使用基于 Unix 的操作系统，您可以将 jar 设置为可执行文件。第三方操作系统可能有自己的设置为可执行的方式。这是我知道的唯一方法。

# hibernate - 我如何编写休眠标准

> ID：10323291
> 
> 赞同：0
> 
> 时间：2012-04-25T20:32:02.867
> 
> 标签：hibernate, hql, hibernate-mapping, hibernate-criteria

我们可以在哪些条件下添加限制？

对于 HQL-1#

```
select activity from EmployeeActivity activity
   join activity.activityStep as step
   where
   activity.currentStep = 1;

Criteria ctr = getSession().createCriteria(EmployeeActivity.class)
   .createCriteria("activityStep")//Where activityStep is the another entity which is joined
   .add(Restrictions.eq("currentStep", 1)) 
```

但是我应该如何为下面的 HQL 查询编写？而且，最佳做法是什么。

```
select activity from EmployeeActivity activity
   join activity.activityStep as step
   where
   activity.currentStep = step.stepNumber; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T06:00:47.527

虽然我不确定查询应该做什么

```
Criteria ctr = getSession().createCriteria(EmployeeActivity.class)
   .createAlias("activityStep", "step")
   .add(Restrictions.propertyEq("currentStep", "step.stepNumber")); 
```

# facebook - 应用程序页面未显示 - 是否与 javascript 冲突？

> ID：10323296
> 
> 赞同：0
> 
> 时间：2012-04-25T20:32:11.270
> 
> 标签：facebook

我在将一些内容拉入 Facebook 时遇到了一些麻烦

这是应该拉入facebook的页面

[http://urbanhistoryx.com/facebook](http://urbanhistoryx.com/facebook)

它应该显示在这里

[http://apps.facebook.com/uhx-magazine](http://apps.facebook.com/uhx-magazine)

如果我从页面中剥离所有代码并编写测试，我可以看到它，这意味着页面中有一些它不喜欢的东西，但我无法解决 - 请给点建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T03:43:21.557

您是否有此页面的 https 连接？如果没有，那么这是你的问题。

# facebook - 自定义下方的“发布到 Facebook”副本 添加评论

> ID：10323298
> 
> 赞同：0
> 
> 时间：2012-04-25T20:32:14.967
> 
> 标签：facebook, facebook-graph-api, user-interface, interface

我有一个客户要求通过“发布到 Facebook”来点赞。不利的一面是他们希望 Like 指向 Facebook URL facebook.com/CLIENTSPAGE URL。有没有办法更改添加评论框下方的图标和标题和描述。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T21:55:45.673

如果您将点赞按钮指向 Facebook 上的某个页面，则会提取该页面的信息。如果您将其指向您自己服务器上的页面，您可以使用 Open Graph 元标记来设置元数据（标题、描述、图片等）

您需要选择其中一个选项，您无法更改 Facebook 通过您的点赞按钮插件在 Facebook 页面上检测到的信息

# python - 为什么 python 的 win32gui.SendMessageTimeout 失败并删除了我的大部分环境变量？

> ID：10323300
> 
> 赞同：1
> 
> 时间：2012-04-25T20:32:23.210
> 
> 标签：python, bash, windows-7, operating-system, environment-variables

此代码段非常标准：（您会在许多网站上找到它）

```
rc, dwReturnValue = win32gui.SendMessageTimeout(win32con.HWND_BROADCAST, win32con.WM_SETTINGCHANGE, 0, "Environment", win32con.SMTO_ABORTIFHUNG, 5000 ) 
```

在一台机器上，它删除了大部分环境变量，但不是全部：这些变量被删除：（和其他）

```
Path
PYTHONPATH
VS100COMNTOOLS
windir
XEDK 
```

当我说已删除时，我的意思是原始 shell 具有完整的环境，但所有后续环境 shell 都没有这些环境变量，至少可以说，这“有点”麻烦。

我已经在至少 4 台其他机器上尝试过这段代码，没有任何问题。该代码完美运行。

在一台有问题的机器上，注销/登录似乎可以解决问题，（并恢复丢失的环境变量）

我在全能的 google 上进行了很多研究，并没有发现 win32gui.SendMessageTimeout 方法的错误。只发现未正确调用该方法的人的线程。（也许这个线程会加入这些行列！:)）

我一直在运行 spy++（我是 spy++ 菜鸟），可以看到 WM_SETTINGCHANGE 消息被有问题的机器上的几个不同窗口正确接收。

```
print str(rc),"<- return code"
print str(dwReturnValue), "<- return value" 
```

产量

```
1 <- return code
0 <- return value 
```

这是我的设置：

*   操作系统 - Windows 7
*   蟒蛇2.7.1
*   赛温 19.5

进程是一个批处理文件（install.bat）（这会设置 %CYGWIN_ROOT%）

```
(...)
:BASH_INSTALL_SCRIPT
::write paths file that will be used to modify system paths
set PATH=%CYGWIN_ROOT%\bin;%PATH%
::call bash install sequence
"%BASH_EXE%" install.sh %CYGWIN_ROOT%\bin %* 
```

install.sh 片段：

```
function setCygwinPath {
# Install script of Cygwin set CYGWIN_ROOT in current env variables.
setEnvVar "CYGWIN_PATH" $CYGWIN_ROOT
}

function setEnvVar {
"$PythonRoot/python.exe" ../utils/${project}/setEnvVar.py $1 $2
(...)    } 
```

设置环境变量.py

```
from install.installUtils import *
setUserEnvVar( sys.argv[1], sys.argv[2]) 
```

installUtils.py

```
def setUserEnvVar( varName, content, type=wreg.REG_EXPAND_SZ, override=0 ):
    """ Set the specified environment variable """
    setEnvVarAndBroadcast( wreg.HKEY_CURRENT_USER, getUserEnvKey(), varName, content, type, override )

def setEnvVarAndBroadcast( domain, regKey, varName, content, type=wreg.REG_EXPAND_SZ, override=0 ):
    """ Set an environment variable and broadcast to opened application """
    if override == 0 :
        # If the variable exist reuse its current type
        varInfo = getEnvVarEx( domain, regKey, varName )
        if varInfo[0] <> "" :
            type = varInfo[1]

    key = wreg.OpenKey(domain, regKey, 0, wreg.KEY_WRITE )    
    wreg.SetValueEx( key, varName, 0, type, content)
    wreg.CloseKey( key )

    HWND_BROADCAST = 0xffff
    WM_SETTINGCHANGE = 0x001A
    SMTO_ABORTIFHUNG = 0x0002

    rc, dwReturnValue = win32gui.SendMessageTimeout(win32con.HWND_BROADCAST, win32con.WM_SETTINGCHANGE, 0, "Environment", win32con.SMTO_ABORTIFHUNG, 5000 ) 
```

我已经完全隔离了调用 win32gui.SendMessageTimeout 是破坏机器环境变量的原因。

这段代码以前在这台机器上工作，直到一周前（不知道发生了什么变化；我什么也不说，

问题：这似乎有点像一个漏洞......我错了吗？我不太确定要调查什么，所以我会欢迎一个解决方案（显然），但即使是调查的想法也会受到欢迎。我在有问题的机器上只有 win32gui.pyd （没有来源）。

机器从 73 个环境变量变为 46 个（ c:> set ）。其中很多是用户安装的应用程序，但有些是系统（如 PATH、windir）。

# php - cakephp：在 find('all') 中过滤子表中的字段

> ID：10323310
> 
> 赞同：0
> 
> 时间：2012-04-25T20:33:10.183
> 
> 标签：php, model, cakephp-2.0

我的问题扩展了之前发布的[CakePHP：Limit Fields associated with a model](https://stackoverflow.com/questions/7244237/cakephp-limit-fields-associated-with-a-model)。我使用此解决方案有效地通过此调用限制父表的返回字段

```
$data = $this->SOP10100->find('all', 
        array('fields' => $this->SOP10100->defaultFields)); 
```

但是，此方法返回过滤的父字段和未过滤的子字段。我有 131 个子字段，其中我只需要 7 个。我在子表中有相同的 defaultFields 数组构造。如何修改此调用（或创建一个新调用），它将返回同一数组中父模型和子模型的过滤字段？

以下是父表数组的结构：

```
 public $defaultFields = array(
    'SOP10100.SOPNUMBE',
    'SOP10100.INVODATE',
    'SOP10100.DOCDATE',
    'SOP10100.DOCAMNT',
    'SOP10100.SUBTOTAL'); 
```

感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T22:36:27.283

分数！哇，一天解决了两个大问题。我终于在许多资源的帮助下弄清楚了：

```
 $this->InvoiceHeader->Behaviors->attach('Containable');
    $data = $this->InvoiceHeader->find('all', array(
        'fields' => $this->InvoiceHeader->defaultFields,
        'contain' => array(
            'InvoiceDetail' => array(
               'fields' => $this->InvoiceDetail->defaultFields))
            )
    ); 
```

就像我想要的那样返回我的数组数据：

```
array(
(int) 0 => array(
    'InvoiceHeader' => array(
        'SOPNUMBE' => 'SVC0202088           ',
        'INVODATE' => '2012-04-17 00:00:00',
        'DOCDATE' => '2012-04-17 00:00:00',
        'DOCAMNT' => '.00000',
        'SUBTOTAL' => '.00000'
    ),
    'InvoiceDetail' => array(
        (int) 0 => array(
            'ITEMNMBR' => 'SERVICE                        ',
            'QUANTITY' => '1.00000',
            'UOFM' => 'EA       ',
            'UNITPRCE' => '.00000',
            'TAXAMNT' => '.00000',
            'CONTSTARTDTE' => '2012-04-17 00:00:00',
            'CONTENDDTE' => '2012-04-30 00:00:00',
            'SOPNUMBE' => 'SVC0202088           '
        ), 
```

# swing - Clojure 代理：速率限制？

> ID：10323313
> 
> 赞同：2
> 
> 时间：2012-04-25T20:33:12.030
> 
> 标签：swing, events, clojure, agents, seesaw

好的，所以我在 Clojure 中有这个小的[程序 SVG 编辑器。](http://roma1n.github.com/cutndry/)

它有一个代码窗格，用户可以在其中创建生成 SVG 文档的代码，以及一个预览窗格。每当代码更改时，预览窗格都会更新。

现在，在文本更改事件中，代码在 UI 线程（Ewwwww！）上重新编译，并且预览窗格更新。编译步骤应该是异步进行的，代理似乎是解决这个问题的好方法：要求代理在更新时重新编译代码，并将结果传递给图像窗格。

我还没有使用代理，我不知道它们是否与隐式队列一起使用，但我怀疑是这样。就我而言，我对计算“中间”步骤的兴趣为零（想想快速击键：如果击键发生在重新编译开始之前，我只想放弃重新编译）——即我想要`send`覆盖任何待处理的代理计算。

我该如何做到这一点？有什么提示吗？甚至是代码示例？我的胡言乱语还有意义吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T20:44:39.077

代理确实在队列上工作，因此每个函数都获取代理的状态并产生代理的下一个状态。代理随着时间的推移跟踪身份。这听起来比你需要的多一点，**原子更适合你的任务**，并且以非常相似的方式使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T21:06:53.280

您描述了一个更多地处理执行流控制而不是共享状态管理的问题。因此，您可能希望暂时将 STM 分开，并研究一下**future**：它们仍然作为代理在线程池中执行，但可以通过调用而不是代理来停止它们`future-cancel`，并使用 检查它们的状态`future-cancelled?`。

没有强有力的保证未来正在执行的线程[可以有效地停止](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/Future.html)。尽管如此，您的代码将能够尝试取消未来，并继续安排下一次重新编译。

# opengl - glAlphaFunc 在较新的 GPU 上的性能

> ID：10323316
> 
> 赞同：0
> 
> 时间：2012-04-25T20:33:17.993
> 
> 标签：opengl, fragment-shader

我几乎完成了一个只使用顶点数组而没有着色器的应用程序。我使用 glAlphaFunc 绘制了很多多边形，而且速度出乎意料地慢。这是因为它已被硬件贬值且不受硬件支持，或者如果我有一个纹理着色器和一个 alpha 测试来丢弃片段，它会同样慢吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T07:44:26.677

启用 alpha 混合后，每个片段都被着色并混合到帧缓冲区中，而不管其深度值如何，这意味着大量的写入操作。但是如果没有 alpha 混合，管道可以在片段着色之前利用 Z 缓冲区来丢弃那些在早期 Z 测试中失败的片段。这可以大大减少写操作。

# osx-snow-leopard - 批处理 pandoc 转换

> ID：10323317
> 
> 赞同：11
> 
> 时间：2012-04-25T20:33:22.630
> 
> 标签：osx-snow-leopard, batch-processing, pandoc

我搜索了高低，试图找出如何批处理[pandoc](http://johnmacfarlane.net/pandoc/README.html)。

如何将包含 html 文件的文件夹和嵌套文件夹转换为 markdown？

我正在使用 os x 10.6.8

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-04-25T20:52:13.283

您可以使用以下命令对目录树中的文件应用任何命令`find`：

```
find . -name \*.md -type f -exec pandoc -o {}.txt {} \; 
```

将`pandoc`在所有带有后缀的文件上运行`.md`，创建带有`.md.txt`后缀的文件。（如果你想得到一个`.txt`没有 的后缀`.md`，或者用 subshel​​l 调用做丑陋的事情，你将需要一个包装脚本。） `{}`从`-exec`到终止的任何单词`\;`都将被文件名替换。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-12-09T01:29:47.840

我制作了一个无法递归工作的 bash 脚本，也许您可​​以根据自己的需要对其进行调整：

```
#!/bin/bash    
newFileSuffix=md # we will make all files into .md

for file in $(ls ~/Sites/filesToMd );
do
  filename=${file%.html} # remove suffix
  newname=$filename.$newFileSuffix # make the new filename
#  echo "$newname" # uncomment this line to test for your directory, before you break things
   pandoc ~/Sites/filesToMd/$file -o $newname # perform pandoc operation on the file,
                                                     # --output to newname

done
# pandoc Catharsis.html -o test 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2020-11-29T05:23:01.570

这建立在[geekosaur 的答案之上](https://stackoverflow.com/a/10323583/)，以避免`.old.new`扩展并`.new`改为使用。请注意，它以静默方式运行，不显示任何进度。

```
find -type f -name '*.docx' -exec bash -c 'pandoc -f docx -t gfm "$1" -o "${1%.docx}".md' - '{}' \; 
```

转换后，当您准备删除原始格式时：

```
find -type f -name '*.docx' -delete 
```

# sql - 在经典的 asp/vbscript SQL 字符串中连接

> ID：10323318
> 
> 赞同：1
> 
> 时间：2012-04-25T20:33:29.153
> 
> 标签：sql, join, concatenation

我想选择列和连接表，其中连接条件将选定的列连接到点上。例如

```
SELECT TBL1.ID,
TBL1.COUNTRY As A,
TBL1.STATE As B,
TBL1.CODE As C
FROM TBL1, TBL2
WHERE TBL2.ID = A+'.'+B+'.'+C 
```

数据`TBL2.ID`看起来像“ **US.NY.61** ”，其中**US**是`TBL1.COUNTRY`，**NY**是`TBL1.STATE`，等等。

更新：SQL 小提琴：[http ://sqlfiddle.com/#!3/26b6b/4](http://sqlfiddle.com/#!3/26b6b/4)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T20:45:40.487

试试这样的东西怎么样

```
SELECT TBL1.ID,
TBL1.COUNTRY As A,
TBL1.STATE As B,
TBL1.CODE As C
FROM TBL1 
  INNER JOIN TBL2 ON CAST(TBL1.COUNTRY AS varchar(20)) + '.' + CAST(TBL1.STATE AS varchar(20)) + '.' + CAST(TBL1.CODE AS varchar(20)) = CAST(TBL2.ID AS varchar(20)) 
```

在组合和比较它们之前，添加了将 4 个字段转换为 varchar 的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T21:14:53.963

```
SELECT T.name,T2.nam FROM
T INNER JOIN T2
ON T.id = (T2.one + '.' + CAST(T2.two as varchar(50)) + '.' + CAST( T2.thr as varchar(50) )) 
```

# sql-server - 无法使用 SQL Server 管理工作室连接到数据库引擎

> ID：10323319
> 
> 赞同：3
> 
> 时间：2012-04-25T20:33:31.977
> 
> 标签：sql-server, installation

我在 Windows 7 Home Premium 上从 Microsoft 站点安装了 SQLManagementStudio_x64_ENU。它给了我兼容性警告，但我仍然安装了，因为 Microsoft 网站指定我会收到警告，但建议单击*Run Program*，我这样做了。

它已成功安装。我检查了*Services.msc*，我可以看到两个 SQL Server 服务正在运行。我检查了 SQL Server 配置，可以看到服务在自动模式下运行，并且代理已关闭。

当我打开我的管理工作室并尝试使用“服务器名称”选项进行连接时，我在浏览选项中看不到任何服务器实例。没有要连接的服务器。我无法连接到数据库引擎。我已经尝试了至少 10 次，但仍然无法连接。

我收到以下错误：

```
A network-related or instance-specific error occurred while establishing a 
connectionto SQL Server. The server was not found or was not accessible. 
Verify that the instance name is correct and that SQL Server is configured to 
```

允许远程连接。（提供者：命名管道提供者，错误：40 - 无法打开与 SQL Server 的连接）（.Net SqlClient 数据提供者）

有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T21:18:08.200

在SQL Server Management Studio (SSMS)的*连接到服务器*`<your machine name>\SQLServer2008`对话框中，键入以连接到*SQLServer2008*实例。否则，`<your machine name`请在服务器名称文本框中单独键入 > 以连接到默认实例*SQLExpress*。

以下链接讨论了如何修复错误*Microsoft.SqlServer.Management.Dmf.PolicyStore*

[**连接对象资源管理器时，Windows 7 上的 SSMS 2008 引发异常**](http://social.msdn.microsoft.com/Forums/en/sqltools/thread/1115cd55-721d-4974-99b1-d142d1e6a927)

# python - 在python中获取ruby函数的返回值

> ID：10323320
> 
> 赞同：0
> 
> 时间：2012-04-25T20:33:37.093
> 
> 标签：python, ruby, command-line

我有一个由 py​​thon 脚本执行的 ruby​​ 脚本。从 python 脚本中，我想访问 ruby​​ 函数的返回值。

想象一下，我会有这个**ruby​​ 脚本** *test.rb*：

```
class TestClass
    def self.test_function(some_var)
        if case1
            puts "This may take some time"
            # something is done here with some_var
            puts "Finished"
        else
            # just do something short with some_var
        end
        return some_var
    end
end 
```

现在，我想将该函数的返回值放入我的**python 脚本**中，打印的输出应该转到 stdout。

我尝试了以下方法（**示例 1**）：

```
from subprocess import call
answer = call(["ruby", "-r", "test.rb", "-e", "puts TestClass.test_function('some meaningful text')"]) 
```

但是，这给了我标准输出的全部输出，`answer`只是退出代码。

因此我尝试了这个（**示例2**）：

```
from subprocess import check_output
answer = check_output(["ruby", "-r", "test.rb", "-e", "puts TestClass.test_function('some meaningful text')"]) 
```

这几乎立即为我提供了*else 情况下*函数的返回值（参见 test.rb）。但是，如果*case1*为真，则`answer`包含整个输出，但在运行 test.rb 时不会打印任何内容。

有什么方法可以获取 ruby​​ 函数的返回值和打印到 stdout 的语句？理想情况下，该解决方案不需要安装额外的模块。此外，我无法更改 ruby​​ 代码。

编辑：

也试过这个，但这在运行 ruby​​ 脚本时也没有在 stdout 上给出输出（**示例 3**）：

```
import subprocess
process = subprocess.Popen(["ruby", "-r", "test.rb", "-e", "puts TestClass.test_function('some meaningful text')"], stdout=subprocess.PIPE)
answer = process.communicate() 
```

我还认为这与将输出刷新到 ruby​​ 脚本中的标准输出无关。示例 1 立即给了我输出。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T03:09:48.577

不尝试将 ruby​​ 脚本作为外部进程调用的另一种方法是使用 Ruby 脚本设置 xmlrpc（或 jsonrpc）服务器，并从 Python jsonrpc 客户端（或 xmlrpc）调用远程函数 - 该值将可以在 Python 程序中使用，甚至使用的 sntax 就像您处理普通的 Python 函数一样。

在 Python 中设置这样的服务器以远程公开几个函数非常容易，并且在 Ruby 中应该是相同的，但我从未尝试过。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T20:43:56.590

查看[http://docs.python.org/library/subprocess.html#popen-constructor](http://docs.python.org/library/subprocess.html#popen-constructor)并查看 ruby​​ 刷新标准输出的方法。

# c++ - ifstream read 和 fread 不返回相同的数据，C++

> ID：10323321
> 
> 赞同：0
> 
> 时间：2012-04-25T20:33:44.503
> 
> 标签：c++, ifstream, fread

我的问题是在文件描述符上使用 ifstream read 和 fread 似乎不会产生相同的结果。

我打开一个文件并在 ios::binary 模式下使用 ifstream open/read 读取它的输入。然后我把这个缓冲区写到一个文件中。出1。

接下来，我打开同一个文件，使用 FILE* 文件描述符和 fread 读取其输入。然后我把这个缓冲区写到另一个文件out2。

当我将 out1 与 out2 进行比较时，它们不匹配。使用 FILE* 的 out2 似乎在接近尾声时停止读取。

更令人担忧的是，两个缓冲区都与输入文件不匹配。ifstream::read 方法似乎正在修改行尾字符，即使我将输入文件打开为 ios::binary。

fread 方法似乎返回的值小于长度（199），即使它读取的字符比这要多得多，因为我可以看到读取的缓冲区。这与 seekg 命令确定的长度不匹配。

我很困惑，任何帮助将不胜感激。附上代码。

谢谢！-朱利安

```
 ifstream read_file;
   read_file.open("V:\\temp\\compressiontest\\out\\test_20224-5120_256x256.jpg", ios::binary);

   read_file.seekg(0, ios::end);
   unsigned long length = read_file.tellg();
   cout << "Length: " << length << endl;
   read_file.seekg(0, ios::beg);

   unsigned char* buffer = new unsigned char[length];
   unsigned char* buf = new unsigned char[length];
   for(int i = 0; i < length; i++)
   {
      buffer[i] = 0;
      buf[i] = 0;
   }

   if(read_file.is_open())
   {
      read_file.read((char*)buffer, length);
   }
   else
   {
      cout << "not open" << endl;
   }

   read_file.close();

   FILE* read_file_1 = NULL;
   read_file_1 = fopen("V:\\temp\\compressiontest\\out\\test_20224-5120_256x256.jpg", "r");
   size_t read_len = fread(buf, 1, length, read_file_1);
   fclose(read_file_1);

   if(read_len != length)
      cout << "read len != length" << " read_len: " << read_len << " length: " << length << endl;

   int consistent = 0;
   int inconsistent = 0;
   for(int i = 0; i < length; i++)
   {
      if(buf[i] != buffer[i])
         inconsistent++;
      else
         consistent++;
   }

   cout << "inconsistent:" << inconsistent << endl;
   cout << "consistent:" << consistent << endl;

   FILE* file1;
   file1 = fopen("V:\\temp\\compressiontest\\out1.jpg", "w"); 
   fwrite((void*) buffer, 1, length, file1);
   fclose(file1);

   FILE* file2;
   file2 = fopen("V:\\temp\\compressiontest\\out2.jpg", "w"); 
   fwrite((void*) buf, 1, length, file2);
   fclose(file2);

   return 0; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T20:42:03.620

您正在调用[fopen()](http://msdn.microsoft.com/en-us/library/yeby3zcb(v=vs.100).aspx)来读取使用`mode r`而不是`mode rb`和写入使用`mode w`而不是`mode wb`，这在 Windows（默认）上意味着您正在使用文本翻译进行读写，而不是在二进制模式下。

# php - PHP 处理致命错误，并将它们存储在文件中

> ID：10323323
> 
> 赞同：2
> 
> 时间：2012-04-25T20:33:51.540
> 
> 标签：php, error-handling

我正在使用以下代码来捕获未捕获的异常和错误，

```
function my_exception_handler($e) {
        $dataToStore = array("error" => $e, "server" => $_SERVER, "request" => $_REQUEST, "backtrace" => debug_backtrace());

                //Store $dataToStore in a file
}

function my_error_handler($no, $str, $file, $line) {
    $e = new ErrorException($str, $no, 0, $file, $line);
    my_exception_handler($e);
}

set_error_handler('my_error_handler');
set_exception_handler('my_exception_handler'); 
```

我想知道是否有一种方法可以使此存储仅在文件中出现 FATAL ERRORS，$e 数组的严重性显然始终为 0。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T20:39:16.627

您需要`register_shutdown_function`执行此任务：

```
register_shutdown_function(function() {
  $err = error_get_last(); 

  if(!is_null($err)) {
     if ($err['type'] == E_ERROR || $err['type'] == E_CORE_ERROR) { // extend if you want
       // write to file..
     }
  }
}); 

// test it with
ini_set('max_execution_time', 1); 
sleep(5); 
```

`$err['type']`可以包含在此页面上定义的常量：[错误处理 > 预定义常量](http://php.net/manual/en/errorfunc.constants.php)

有关更多信息，请参阅：[在 PHP 中捕获致命错误](https://barelysufficient.org/2011/03/catching-fatal-errors-in-php/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T20:40:13.400

```
function my_error_handler($no, $str, $file, $line) {
    switch($no){
        case E_CORE_ERROR:    
            $e = new ErrorException($str, $no, 0, $file, $line);
            my_exception_handler($e);
            break;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T20:44:17.520

根据 PHP 在[set_error_handler](http://php.net/manual/en/function.set-error-handler.php)上的文档，指定的处理程序应采用以下形式：

> *处理程序*( int *$errno* , string *$errstr* [, string *$errfile* [, int *$errline* [, array *$errcontext* ]]] )
> 
> （……）
> 
> 第一个参数***errno***包含引发的错误级别，作为一个整数。

这意味着您应该以这种方式制作错误处理程序：

```
<?php

function my_error_handler($errno, $errstr, $errfile, $errline, $errcontext) {
    // Only process fatal errors
    if ($errno == E_ERROR) {
        // Do your error processing
    }
}

set_error_handler('my_error_handler');

?> 
```

使用这种方法，您可以精确控制如何处理每种错误。

* * *

如果你只想处理致命错误，你可以做的更容易：

> 混合**set_error_handler** ( 可调用 $error_handler [, int $error_types = E_ALL | E_STRICT ] )

第二个参数`$error_types`允许您指定应使用自定义错误处理程序处理哪些错误。您可以只传递`E_ERROR`常量，如下所示：

```
<?php

// Use your existing function

set_error_handler('my_error_handler', E_ERROR);

?> 
```

# tsql - 使用 T-SQL 将 VARCHAR 中的单个字节转换/连接到 BIGINT

> ID：10323325
> 
> 赞同：1
> 
> 时间：2012-04-25T20:33:58.170
> 
> 标签：tsql, byte, varchar, bigint

在两个数据库系统之间工作，我需要将 VARCHAR 标识符转换为 BIGINT。我的 VARCHAR 始终采用“###-XXX-XXX-###”的形式，其中 # 是任何数字，X 是任何字母数字字符（例如“103-AF7-GGB-005”）。这两个### 条目保证低于 256，因此我想将它们中的每一个存储在 BIGINT 的单个字节中（分别是第一个和最后一个字节），而其他 6 个字符中的每一个都存储为一个字节。

我已经在数据库之外实现了这个，它解决了我需要它的问题，但现在我需要在 t-sql 中创建函数，但我无法弄清楚如何做到这一点。

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T22:52:00.097

你可以这样做：

```
DECLARE @inp VARCHAR(100) = '223-ABC-DEF-234'
    , @BITS BIGINT;

SELECT @BITS = 
        CASE 
            WHEN CONVERT(BIGINT, LEFT(@inp, 3)) > 127
                THEN (CONVERT(BIGINT, LEFT(@inp, 3))-128) * POWER(CONVERT(BIGINT, 2), 56) 
                     -9223372036854775808
            ELSE CONVERT(BIGINT, LEFT(@inp, 3)) * POWER(CONVERT(BIGINT, 2), 56)
        END
    + CONVERT(BIGINT, ASCII(substring(@inp, 5, 1))) * POWER(CONVERT(BIGINT, 2), 48)
    + CONVERT(BIGINT, ASCII(substring(@inp, 6, 1))) * POWER(CONVERT(BIGINT, 2), 40)
    + CONVERT(BIGINT, ASCII(substring(@inp, 7, 1))) * POWER(CONVERT(BIGINT, 2), 32)
    + CONVERT(BIGINT, ASCII(substring(@inp, 9, 1))) * POWER(CONVERT(BIGINT, 2), 24)
    + CONVERT(BIGINT, ASCII(substring(@inp, 10, 1))) * POWER(CONVERT(BIGINT, 2), 16)
    + CONVERT(BIGINT, ASCII(substring(@inp, 11, 1))) * POWER(CONVERT(BIGINT, 2), 8)
    + CONVERT(BIGINT, RIGHT(@INP, 3));

select CONVERT(binary(8), @bits);
-- Returns 0xDF414243444546EA

SELECT CONVERT(VARCHAR, CONVERT(INT, 0XDF))
    + '-' + CHAR(0X41)
    + CHAR(0X42)
    + CHAR(0X43)
    + '-' + CHAR(0X44)
    + CHAR(0X45)
    + CHAR(0X46)
    + '-' + CONVERT(VARCHAR, CONVERT(INT, 0XEA));

-- Returns 223-ABC-DEF-234: our original string 
```

最大的减法是翻转符号位。如果第一个数字超过 127，则使用所有 64 位。仅乘以 2^56 就会溢出数据类型，因为 BIGINT 是有符号的。

# javascript - 添加文本值以动态创建文本输入

> ID：10323326
> 
> 赞同：0
> 
> 时间：2012-04-25T20:34:00.573
> 
> 标签：javascript, jquery

我正在尝试构建一个动态表单。我将克隆和屏蔽连同它一起提交并发布到我的数据库，但现在我试图从以前的 id #endtime_* 中获取值，并将其设置为 #starttime_* 的新动态创建的输入字段的值。id 以 1 开头。例如：第一行是：然后下一行是 2，依此类推。

作为奖励，也许有人还可以告诉我如何使每个创建的行交替颜色。奇数行蓝色和偶数行白色说。

提前非常感谢！

这是到目前为止的代码。

```
 <script type="text/javascript">
        function maskInput(){
            $.mask.definitions['~'] = "[+-]";
            $(".time").mask("99:99 aa");

            $("input").blur(function() {
            $("#info").html("Unmasked value: " + $(this).mask());
        }).dblclick(function() {
            $(this).unmask();
        });
        }
        var clone;
        function cloneRow(){
            var rows=document.getElementById('TimeCard').getElementsByTagName('tr');
            var index=rows.length-1;
            clone=rows[index-0].cloneNode(true);
            var inputs=clone.getElementsByTagName('input'), inp, i=0,n ;
            while(inp=inputs[i++]){
                inp.name=inp.name.replace(/\d/g,'')+(index+1);
            }
            var select=clone.getElementsByTagName('select'), sel, i=0,n ;
            while(sel=select[i++]){
                sel.name=sel.name.replace(/\d/g,'')+(index+1);
            }
        maskInput();
        }
        function addRow(){
            var tbo=document.getElementById('TimeCard').getElementsByTagName('tbody')[0];
            tbo.appendChild(clone);
            cloneRow();
        }
        function checkDOM(){
            var rows=document.getElementById('TimeCard').getElementsByTagName('tr');
            for(var i=0;i<rows.length;i++){
                alert(rows[i].getElementsByTagName('input')[0].name);
            }
        }
        onload=cloneRow;
        </script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T20:40:48.130

当您在 cloneRow 中创建新输入时，在它们位于 dom 中之后，您可以获取您的名称/索引并使用它们。

```
$('#starttime_'+index).attr('value',$('#endtime_'+index-1).attr('value')); 
```

对于你的行，你只需要给每个人一个不同的/额外的类，然后相应地设置它

```
.odd { background-color:#cfcfcf; } 
```

然后，在您的 cloneRow()

```
clone=rows[index-0].cloneNode(true);
if (index%2) $(clone).addClass("odd");  //added this line
var inputs=clone.getElementsByTagName('input'), inp, i=0,n ; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T20:52:57.363

当您没有提供 HTML 代码时，很难猜测您真正想要什么，但我构建的东西至少应该为您指明正确的方向。我把它做成了一个[jsfiddle](http://jsfiddle.net/qf7n6/)，但我也会在这里发布。所以假设你的 HTML 是这样的：

```
<div id="inputs">
    <input class="endtime" id="endtime_123" type="text" value="endtime_123"/>
</div> 
```

然后，此 JavaScript 将为您创建新输入，其开始时间等于另一个输入的结束时间：

```
$(function() {
    $('#inputs .endtime').each(function(index) {
        var endtime = $(this).attr('id').substring(8);
        $('#inputs').append("<input class='starttime' id='starttime_'"+endtime+"' value='starttime_"+endtime+"'/>");
    });
}); 
```

# database - 自动分片postgresql？

> ID：10323327
> 
> 赞同：19
> 
> 时间：2012-04-25T20:34:01.617
> 
> 标签：database, postgresql, partitioning, sharding

我有一个问题，我需要非常快速地将大量数据（5+ 十亿行）加载到数据库中（理想情况下少于 30 分钟，但越快越好），最近有人建议我研究 postgresql（我用 mysql 失败了并且正在查看 hbase/cassandra)。我的设置是我有一个生成大量数据的集群（目前有 8 个服务器），我正在考虑在集群中的每台机器上本地运行数据库，它在本地快速写入，然后在最后（或在整个数据生成过程中）数据是合并在一起。数据没有任何顺序，所以我不在乎它在哪个特定的服务器上（只要它最终在那里）。

我的问题是，有没有什么好的教程或地方可以学习 PostgreSQL 自动分片（我发现像 sykpe 这样的公司在做自动分片但没有教程，我想自己玩这个）？我正在尝试做的事情可能吗？因为数据没有任何顺序，我打算使用自动递增的 ID 号，如果合并数据会导致冲突（这不再是一个大问题了）？

更新：下面弗兰克的想法消除了我所询问的自动递增冲突问题。现在的问题基本上是，我如何了解自动分片，它是否支持将数据分布式上传到多个服务器？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-26T03:22:02.657

第一：您真的需要将集群中生成的数据直接插入到关系数据库中吗？你不介意最后合并它，那么为什么还要插入数据库呢？在你的位置上，我会让你的集群节点编写平面文件，可能是 gzip 的 CSV 数据。然后，我将使用[pg_bulkload 之](http://pgbulkload.projects.postgresql.org/)类的工具批量导入和合并该数据。

如果您确实需要直接插入关系数据库：这就是 PgPool-II 和（尤其是）PgBouncer 的（[部分](http://pgfoundry.org/projects/pgbouncer/)[）](http://www.pgpool.net/)用途。将 PgBouncer 配置为跨不同节点进行负载平衡，您应该已经很有序了。

请注意，PostgreSQL 是一个事务性数据库，具有强大的数据持久性保证。这也意味着，如果您以简单的方式使用它，执行大量小写入可能会很慢。您必须考虑您愿意在数据持久性、速度和硬件成本之间做出哪些权衡。

在一个极端情况下，每个都`INSERT`可以是自己的事务，在返回成功之前同步提交到磁盘。这将每秒事务的数量限制为磁盘子系统可以执行的 fsync() 数量，这通常只有每秒几十或几百次（没有电池备份 RAID 控制器）。如果你没有做任何特别的事情并且你没有将你`INSERT`的 s 包装在 a`BEGIN`和中，这是默认设置`COMMIT`。

在另一个极端，您说“我真的不在乎我是否会丢失*所有*这些数据”并使用未记录的[表](http://www.postgresql.org/docs/current/static/sql-createtable.html#AEN67434)进行插入。如果它不能保证它是好的，这基本上给了数据库丢弃你的数据的权限 - 例如，在操作系统崩溃、数据库崩溃、断电等之后。

中间地带是你可能想要的地方。这涉及到[异步提交](http://www.postgresql.org/docs/current/static/wal-async-commit.html)、[组提交](http://www.postgresql.org/docs/current/static/wal-configuration.html)（[commit_delay](http://www.postgresql.org/docs/current/static/runtime-config-wal.html#GUC-COMMIT-DELAY)和[commit_siblings](http://www.postgresql.org/docs/current/static/runtime-config-wal.html#GUC-COMMIT-SIBLINGS)）、批处理插入到显式`BEGIN`和包装的组中的某种组合`END`。代替 INSERT 批处理，您可以`COPY`一次加载几千条记录。所有这些都以数据的持久性与速度为代价。

对于快速批量插入，您还应该考虑插入到除了主键之外没有任何索引的表中。也许甚至不是。完成批量插入后创建索引。这将快得多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T20:51:51.617

以下是一些可能会有所帮助的事情：

*   每台服务器上的数据库都应该有一个具有该服务器独特特征的小型元数据表。比如是哪个服务器；服务器可以按顺序编号。除了该表的内容之外，尝试使每台服务器上的架构尽可能相似可能是明智的。

*   对于数十亿行，您将需要 bigint id（或 UUID 等）。使用 bigints，您可以为每个服务器分配一个大范围，并设置其顺序以使用它。例如，服务器 1 获得 1..1000000000000000，服务器 2 获得 1000000000000001 到 2000000000000000 等。

*   如果数据是简单的数据点（例如每秒恰好从 10 台仪器读取的温度读数），您可以通过将其存储在带有列的表中`(time timestamp, values double precision[])`而不是更正确的表中来获得效率提升`(time timestamp, instrument_id int, value double precision)`。这是为了提高效率而进行的显式非规范化。（我[在博客](http://ejrh.wordpress.com/2011/03/20/vector-denormalisation-in-postgresql/)上讲述了我自己对这个方案的体验。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-08-17T11:55:59.237

使用[citus](https://docs.citusdata.com/en/stable/aboutcitus/what_is_citus.html#when-to-use-citus)进行 PostgreSQL 自动分片。[这个链接](http://www.craigkerstiens.com/2012/11/30/sharding-your-database/)也很有帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-26T00:03:21.237

抱歉，我手头没有教程，但这里有一个可能的解决方案的概要：

*   将八分之一的数据加载到每台服务器上的 PG 实例中
*   为了获得最佳加载速度，不要使用插入，而是使用[COPY](http://www.postgresql.org/docs/9.1/static/sql-copy.html)方法
*   加载数据时，不要将八个数据库合二为一。相反，使用[plProxy](http://plproxy.projects.postgresql.org/doc/faq.html)启动单个语句来一次查询所有数据库（或满足您查询的正确语句）

如前所述，密钥可能是一个问题。使用不重叠的序列或 uuid 或带有字符串前缀的序列号，应该不难解决。

您应该从其中一台服务器上的 COPY 测试开始，看看您离 30 分钟的目标有多近。如果您的数据不重要并且您有最新的 Postgresql 版本，您可以尝试使用应该更快（但不是崩溃安全）的未[记录表。](http://www.postgresql.org/docs/9.1/static/sql-createtable.html)听起来像一个有趣的项目，祝你好运。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2014-07-01T19:09:37.283

您可以使用 mySQL - 它支持跨集群的自动分片。

# ruby-on-rails - 在我的 rails 答案中删除不必要的 HTTP 标头

> ID：10323331
> 
> 赞同：6
> 
> 时间：2012-04-25T20:34:22.677
> 
> 标签：ruby-on-rails, http

我目前正在开发一个大小很重要的 API：我希望答案包含尽可能少的字节。我优化了我的 JSON 答案，但 rails 仍然响应许多奇怪的标题

```
HTTP/1.1 200 OK
Server: nginx/0.7.67                            # Not from Rails, so ok.
Date: Wed, 25 Apr 2012 20:17:21 GMT             # Date does not matter. We use ETag Can I remove this?
ETag: "678ff0c6074b9456832a710a3cab8e22"        # Needed.
Content-Type: application/json; charset=utf-8   # Also needed.
Transfer-Encoding: chunked                      # The alternative would be Content-Length, so ok.
Connection: keep-alive                          # Good, less TCP overhead.
Status: 200 OK                                  # Redundant! How can I remove this?
X-UA-Compatible: IE=Edge,chrome=1               # Completely unneded.
Cache-Control: no-cache                         # Not needed.
X-Request-Id: c468ce87bb6969541c74f6ea761bce27  # Not a real header at all.
X-Runtime: 0.001376                             # Same goes for this
X-Rack-Cache: invalidate, pass                  # And this. 
```

所以有很多不必要的 HTTP 标头。我可以在我的服务器（nginx）中过滤它们，但是有没有办法直接在 rails 中阻止它？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-25T21:43:35.557

你可以用一个 Rack 中间件来做到这一点。请参阅[https://gist.github.com/02c1cc8ce504033d61bf](https://gist.github.com/02c1cc8ce504033d61bf)以获取合二为一的示例。

将其添加到您的应用配置时，请使用类似`config.middleware.insert_before(ActionDispatch::Static, ::HeaderDelete)`

您想在运行时显示的列表中的第一项之前插入它`rake middleware`，在我的例子中是`ActionDispatch::Static`。

如果您之前没有在 Rails 上下文中接触过 Rack， http: [//guides.rubyonrails.org/rails_on_rack.html可能会有所帮助。](http://guides.rubyonrails.org/rails_on_rack.html)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-07-09T07:17:56.110

由于您使用的是 Nginx，另一个选择是[HttpHeadersMoreModule](http://wiki.nginx.org/HttpHeadersMoreModule)。这将允许您精确控制通过线路发送的标头。

在您的情况下，您特别希望使用[more_clear_headers](http://wiki.nginx.org/HttpHeadersMoreModule#more_clear_headers)指令，例如：

`more_clear_headers Server Date Status X-UA-Compatible Cache-Control X-Request-Id X-Runtime X-Rack-Cache;`

这也清除了`Server`标头，因为它并不是真正需要的，如果您尝试保存字节，每一点都会有所帮助。

这个模块确实需要你自己编译 Nginx，但这真的不应该吓到你。Nginx 非常容易编译，只需按照[安装说明](http://wiki.nginx.org/HttpHeadersMoreModule#Installation)进行即可。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-27T16:21:55.433

`x1a4`我同意和提出的两种解决方案`Stephen McCarth`都很好。

理想情况下，`HttpHeadersMoreModule`如果有人像我一样喜欢带有安全更新的本机 Ubuntu NginX 软件包（或者你没有时间，或者只是懒惰），那么你绝对应该使用它，你不需要这样做。

另一种方法是使用`proxy_hide_header`

```
server {

  location @unicorn {

    # ...
    proxy_hide_header X-Powered-By;
    proxy_hide_header X-Runtime;
    # ...
  }
} 
```

注意：`@unicorn`只是上游服务器，位置可以是任何东西`/`，，，`/assets`..

现在反对该解决方案的一个论点是，如果您在配置中使用多个服务器块，您需要`proxy_hide_header`为每个块指定它们。是的，但是您可以创建文件并包含它

```
# /etc/nginx/sites-enabled/my_app
server {

  location @unicorn {

    # ...
    include /etc/nginx/shared/stealth_headers
    # ...
  }
}

# /etc/nginx/shared/stealth_headers
proxy_hide_header X-Powered-By;
proxy_hide_header X-Runtime 
```

那么为什么我认为这个解决方案比使用中间件解决方案更好`x1a4`？

我之前有类似的中间件解决方案，几个月来它运行良好。然后有一天，我们通过异常监控工具[party_foul gem](https://github.com/dockyard/party_foul)停止接收异常错误。长话短说中间件很棘手，我们做了一些代码更改，这个中间件正在抛出异常，但它抛出的异常没有被假定监视异常的中间件捕获。所以是的，整件事都是我的错，我应该更好地关注我的代码，不要做愚蠢的事情，不管我有过难以消除的不愉快经历，所以我只是建议你是否可以在 NginX 级别上处理这个问题，不在中间件级别

+ 如果您的 NginX 正在处理多个配置，则更有意义（如果有一些更改，您不必更新多个应用程序）

# xml - 如何在 XSLT 中解析 CDATA 元素内的 XML DOM？

> ID：10323332
> 
> 赞同：5
> 
> 时间：2012-04-25T20:34:34.540
> 
> 标签：xml, xslt, xpath, cdata

假设我有一个 XML 文件，例如：

```
<library>
 <books>
  <![CDATA[<genre><name>Sci-fi</name><count>2</count></genre>]]>
  <book>
   <name>
    Some Book
   </name>
   <author>
    Some author
   </author>
  <book>
  <book>
   <name>
    Another Book
   </name>
   <author>
    Another author
   </author>
  <book>
 <books>
</library> 
```

我想读取 xslt 转换器中的 CDATA 元素“名称”，并将其值放在标记值的某个位置。我该怎么做呢？AFAIK，我们不能对 CDATA 的内容使用 xpath。是否有一些破解/解决方法？我想在 XSLT 中严格执行此操作。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-26T08:24:05.120

一些 XSLT 产品具有扩展功能，例如 saxon:parse()，它允许您获取包含词法 XML 的字符串并将其转换为节点树。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-25T21:32:27.127

您还可以选择 CDATA 部分，然后将结果传递给第二个 XSL。

例如，如果您像这样获取 CDATA 部分：

```
<xsl:template match="//books/text()">
  <xsl:value-of select="." disable-output-escaping="yes"/>
</xsl:template> 
```

您最终会得到如下结果：

```
<genre><name>Sci-fi</name><count>2</count></genre> 
```

如果只处理 DOM，您可以应用另一个 XSL 或 XPATH。那是假设您的 CDATA 始终是有效的 XML。否则，马丁的正则表达式答案就是这样。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-25T20:51:54.243

由于 CDATA 块是（部分）文本节点，因此您可以提取两个“标签”之间的文本，例如：

```
<xsl:template match="text()">
  <xsl:value-of select="substring-before(substring-after(., '&lt;name>'), '&lt;/name>')"/>
</xsl:template> 
```

这只是一个快速的想法。如果 CDATA 中有多个名称“元素”，只需递归多次应用上述表达式即可。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-08-02T02:34:33.317

也许我的答案来得太晚了，但无论如何我都会给出答案。我遇到了同样的问题，找不到易于使用的答案，所以我自己编写了一个模板“STR2XML”来做这件事。如果有人有兴趣，我很乐意分享模板。让我知道。

其工作原理的两个示例：

```
<xsl:variable name="text">
    <![CDATA[
        <div style="color:red;">
            <p>hello world</p>
        </div>
    ]]>
</xsl:variable>
<p>
    <xsl:value-of select="$text"/>
</p>
<xsl:call-template name="str2xml">
    <xsl:with-param name="text" select="$text"/>
</xsl:call-template> 
```

将给出以下输出：

```
<div style="font-weight:bold;"> <p>hello world</p> </div> (non parsed plain text) 
```

**你好世界**

但是当然你也可以使用它来创建一个可以作为节点访问的变量：

```
<xsl:variable name="text2">
    <![CDATA[
        <div>hello world</div>
        <p>goodbye world</p>
    ]]>
</xsl:variable>
<xsl:variable name="var1">
    <xsl:call-template name="str2xml">
        <xsl:with-param name="text" select="$text2"/>
    </xsl:call-template>
</xsl:variable>
<xsl:for-each select="xalan:nodeset($var1)/*">
    <p>
        <xsl:value-of select="concat(name(.),': ',.)"/>
    </p>
</xsl:for-each> 
```

输出：

div：你好世界

p：再见世界

# wcf - 通过报告服务连接到 WCF Web 服务，仅 Windows 身份验证？

> ID：10323334
> 
> 赞同：0
> 
> 时间：2012-04-25T20:34:42.663
> 
> 标签：wcf, reporting-services, basic-authentication, ssrs-2008

我正在尝试通过 SSRS 2008 R2 使用**基本身份验证**连接到 WCF Web 服务，但我得到的只是一个错误，抱怨我应该使用 Windows 身份验证。

这真的是唯一的方法吗？我找不到任何提到此限制的官方文档。

你能想到这种情况的任何解决方法吗？（除了切换到 Windows 身份验证）。

谢谢你的时间。问候。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T14:04:59.643

您是否尝试连接到 SSRS 网络服务？

如果是，这是一个 SSRS 配置。您必须打开 RSReportServer.config 文件并编辑标签

更多信息[在这里](http://msdn.microsoft.com/en-us/library/cc281310%28v=sql.100%29.aspx)

# regex - 多行正则表达式组匹配

> ID：10323337
> 
> 赞同：1
> 
> 时间：2012-04-25T20:35:21.773
> 
> 标签：regex, ms-access, vbscript, match, multiline

我正在尝试使用正则表达式解析模板格式。

这是一个示例

```
Type of Change:                 Modify
Metavance:                      None
AutoSys :                       None
Informatica Migration:          None
FTP Details:                    None
Device/Server:                  DWEIHPRD
DB Objects:                     Delete
                                 ARC_MEDICAL_CLAIM_DETAIL_FK1
DB Name:                        DWEIHPRD
Schema-Table(s):            UTIL
Interface(s):                     IF0515
Reports (RAPS):              None
Ancillary Systems:            None 
```

基本上一切都是

字段：数据（可能是多行，如上面的 DB 对象示例）

```
^(.+?):(.*) 
```

非常接近于做我想做的事，除了它只抓住了数据库对象的第一行。如果我打开 dotall，那么所有内容都会贪婪匹配，并且所有内容都在“第一个字段”结果中。

字段和数据中的最佳额外空白将被修剪，但如果它不作为正则表达式的一部分发生，那并不是什么大问题。

作为一个额外的麻烦，我必须在访问 97 vbscript 中完成这项工作，因此它可能无法使用一些更好的现代正则表达式功能:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T21:37:29.217

**注意**：这是一个丑陋的解决方案，但也许它会帮助你。正如@anubhava 建议的那样，可能有一个非正则表达式的解决方案。我只是不太了解VBA，无法说出它可能是什么。

根据这篇[文章](http://msdn.microsoft.com/en-us/library/1400241x%28v=vs.85%29.aspx)，Microsoft Office 的 VBScript 支持前瞻、后瞻和非捕获（文章上的日期是 2009 年），但如果支持可以追溯到 Access 97，我会感到非常惊讶——尽管我可能是错的。

通常，我会为此使用前瞻和非捕获组，但避免使用它们，因为 Office 97 不太可能支持它们。所以请注意，您只需忽略捕获组 3（它仅用于测试可选多行匹配的行尾字符）。请注意，这只会找到传播两行的匹配项。

```
^(.+):\s+(.+)(\r\n\s+(.+))*
note this has four capture groups, but you will ignore \3\. Use \1, \2, and \4 (four will be empty for single line matches) 
```

解释：

```
^         # beginning of line
(.+):     # capture one or more characters up to a colon
\s+(.+)   # skip past whitespace, then capture characters up to end of line
(         # open a capturing group (to be thrown away. See explanation above)
  \r\n\s+ # peek ahead to see if there are EOL characters followed by whitespace
  (.+)    # if we got this far, capture whatever characters come after the whitespace
)*        # and make this group optional (and you will ignore it anyway) 
```

# jquery - 动态链接未正确定向

> ID：10323338
> 
> 赞同：1
> 
> 时间：2012-04-25T20:35:21.773
> 
> 标签：jquery, codeigniter

我在为我的按钮提供正确的 window.location.href 值时遇到问题。只是为了让您知道这是在所有页面上动态完成的。所以我想要它做的是转到驻留在他们当前所在的当前模块控制器中的 addnew 函数。例如说用户在标题模块（文件夹）和标题控制器中我希望它转到titles(module)/titles(controller)/addnew(method)，但这只是一个例子。它适用于这个例子但是说我去一个不同的页面说titleStatuses控制器在titles模块里面，如果我点击同一个按钮，它会去titles(module)/titles （控制器）/addnew（方法）。

```
$('.addnew').append('<button>Add New</button>').css('float', 'right').css('margin', '5px 0 0 10px').css('padding-right', '10px');
$('.addnew button').css('width', '100px').click(function() {
    window.location.href = 'addnew';
    return false;
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T21:04:57.803

试试这个：

```
window.location.href = window.location.href+'addnew'; 
```

链接上的 href 值将添加到现有 URL，这似乎是您正在尝试做的事情。但是，通过 Javascript 设置 URL 时，“addnew”与“/addnew”相同，即与“http://domain.com/addnew”相同。

使用上面的方法（假定 URL 末尾有一个斜杠）将 addnew 函数附加到当前 URL 的其余部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T21:37:33.917

我通常在我的标题中有一个脚本，它允许我在 JavaScript中使用[URL 辅助函数。](http://codeigniter.com/user_guide/helpers/url_helper.html "网址助手")您当然需要加载帮助程序。

```
<script>
    var base_url = <?=base_url()?>
    var current_url = <?=current_url()?>
</script> 
```

对于您的特定 jQuery 函数，您可以将`click`事件绑定到：

```
$('.addnew button').css('width', '100px').click(function() {
    window.location.href = current_url + '/addnew'; /* or something similar */
    return false;
}); 
```

# knockout.js - 来自单个数组的 Knockoutjs 多个下拉列表

> ID：10323344
> 
> 赞同：0
> 
> 时间：2012-04-25T20:35:37.000
> 
> 标签：knockout.js

```
var dropdownData = [
   {City: "New York City", State:"New York" },
   {City: "Albany", State:"New York" },
   {City: "Bufflo", State:"New York" },
   {City: "Rochester", State:"New York" },
   {City: "San Francisco", State:"California" },
   {City: "Los Angeles", State:"California" },
   {City: "San Diego", State:"California" }
]; 
```

我想显示两个下拉列表，其中第一个下拉列表显示所有纽约城市，第二个下拉列表显示加利福尼亚城市列表。有人可以阐明如何在knockoutjs中完成它吗？“dropdownData”列表是动态的，因此如果将其他状态添加到列表中，则应动态生成下拉列表。

任何帮助是极大的赞赏！

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T20:49:56.083

您可以添加两个dependentObservables，它们返回数组的过滤视图（无论如何您都应该将其转换为observableArray）。一个只是州的唯一值（您可以为此使用 ko.utils.arrayGetDistinctValues），另一个是与所选州相对应的城市（使用 ko.utils.arrayFilter）。请参阅[此处](http://www.knockmeout.net/2011/04/utility-functions-in-knockoutjs.html)以帮助您入门。

# jquery-ui - jquery-ui 选项卡 - 添加选项卡

> ID：10323346
> 
> 赞同：0
> 
> 时间：2012-04-25T20:35:46.000
> 
> 标签：jquery-ui, tabs

我有一个显示在一个选项卡中的项目列表，我希望能够单击其中一个项目并打开一个新选项卡并在新选项卡上显示其详细信息。我通过执行以下操作添加新选项卡：

```
$(".btn-opener").click(function(){

$('#tabs').tabs('add', 'http://localhost/GetItem/' + $(this).attr('href'), "View Details");

} 
```

我的问题是 url 实际上是一个返回 JSON 的服务端点。我希望能够将 js 模板应用于返回的数据。我该怎么做呢？我需要挂钩标签的加载事件吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T21:20:54.933

我想我将通过在标签容器中添加一个带有我需要的 HTML 的 div 来解决这个问题，然后使用它的 id 来设置新标签的片段。例如：

```
$('.btn-opener').click(function () {

    var $this = $(this),
        itemID = $this.data("item-id");

            $.get("http://localhost/GetItem/" + itemID,

                function (data, textStatus, jqXHR) {

                    var html = Mustache.to_html($("#item-template").html(), data);                          

                    $("#tabs").append('<div id="' + id + '">' + html + '</div>');
                    $('#tabs').tabs("add", "#" + id, $this.text());

                },  
                "json"
            );

            return false;
        }); 
```

在将此标记为答案之前，我将等待看看是否有人提出了更好的解决方案。

# iphone - 在 Mac 上为 iOS 编译 ARM

> ID：10323350
> 
> 赞同：2
> 
> 时间：2012-04-25T20:35:51.760
> 
> 标签：iphone, macos, assembly, arm, jailbreak

这有点类似于[在 Mac 上编译 ARM .s 文件](https://stackoverflow.com/questions/9150909/compiling-arm-s-file-on-mac)

尤其是 Simon Urbanek 的回复，谢谢！

我基本上想知道如何让这个 asm 文件在越狱的 iPhone 上工作。目前，我正在交叉编译并尝试将对象放在 iPhone 上并运行它但没有成功，因为它显然不适用于 iPhoneOS，它只是没有 Mach-O 标头的 ARM 代码。知道如何让它工作吗？-isysroot 可能是答案，但我提供了 SDK 文件作为其输入，但我没有得到 mach-o 标头。

另外，我也很想知道是否有一种方法可以在不使用内联 gcc 的情况下在 iphone 本身上编译 ASM 代码。

无论如何，这是当前的工作流程：

# [在 Mac 上]

```
$ cat foo.s
mov r0, r1

$/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/usr/llvm-gcc-4.2/bin/llvm-gcc-4.2 -arch armv6 -c foo.s

$ file foo.o
foo.o: Mach-O object arm

$ otool -v -t foo.o
foo.o:
(__TEXT,__text) section
00000000    e1a00001    mov r0, r1 
```

# [在 iPhone 上]

```
$ file foo.o
foo.o: Mach-O object arm

$ otool -v -t foo.ofoo.o:
(__TEXT,__text) section
00000000    e1a00001    mov r0, r1 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T20:39:08.590

编译代码是不够的，您还必须*链接*它以从目标代码生成可执行文件：

```
$/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/usr/llvm-gcc-4.2/bin/llvm-gcc-4.2 -arch armv6 foo.o -o foo
$./foo 
```

如果您省略其中的 C/C++ 部分，并从组装步骤开始，您可以使用此文档进行理解： [http ://markuskimius.wikidot.com/programming:explain:compiling](http://markuskimius.wikidot.com/programming:explain:compiling)

# javascript - 我如何在 jQuery 中做到这一点？（匹配一个特定的单词并使其成为一种颜色）

> ID：10323351
> 
> 赞同：1
> 
> 时间：2012-04-25T20:35:58.963
> 
> 标签：javascript, jquery, dom

我有几个 html 文本段落，我想浏览 .content 中的每个段落，如果它包含单词“Hello”或“hello”（或任何大小写变体），我只想将那个单词设为蓝色。和“再见”一样，除了把它变成红色。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T20:39:44.613

您可以为此使用一个名为 highlight 的 jQuery 插件。

[http://johannburkard.de/blog/programming/javascript/highlight-javascript-text-higlighting-jquery-plugin.html](http://johannburkard.de/blog/programming/javascript/highlight-javascript-text-higlighting-jquery-plugin.html)

```
$('li').highlight('bla'); 
```

稍作修改的版本以适应不同的风格。
[http://jsfiddle.net/ReNvf/](http://jsfiddle.net/ReNvf/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T20:40:13.940

我有一个插件可以让这很容易，这里有一个小提琴：http: [//jsfiddle.net/NFDqe/8/](http://jsfiddle.net/NFDqe/8/)

```
$(document).ready(function(){
    $("#content").highlightText("hello","hello",true);
    $("#content").highlightText("goodbye","goodbye",true);
});​ 
```

[https://github.com/tentonaxe/jQuery-highlightText](https://github.com/tentonaxe/jQuery-highlightText)

**更新**
由于这个插件实际上没有文档，我想我应该发布一些。

```
$(selector).highlightText(string, class, onlyfullmatches) 
```

`string`可以是任何字符串或正则表达式。如果是字符串，则不区分大小写，即 hello 将匹配 HeLlO。如果它是一个正则表达式，它将按原样使用。

`class`可以是单个类，也可以是空格分隔的类列表。

`onlyfullmatches`应该是一个布尔值，默认为 false。如果为真，插件将只匹配完全匹配，而不是部分匹配。例如，如果为 false，`hello`则匹配字符串`hellow`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T20:42:15.013

遍历每个 p 标签，检查文本，分配 css：

jsFiddle（[http://jsfiddle.net/fM7MP/26/](http://jsfiddle.net/fM7MP/26/)）

```
$('p').each( function(index)
{
    replaceWithColors( $(this) , "hello" , "blue" );
    replaceWithColors( $(this) , "goodbye" , "red" );
});

function replaceWithColors( object , word , color )
{
    var index = $(object).html().toLowerCase().indexOf( word );  

    if ( index > -1 )
    {
        var before = $(object).html().substring( 0 , index );
        var theWord = $(object).html().substring( index , index + word.length );
        var after = $(object).html().substring( index + word.length );

        $(object).html( before + "<span style='color:" + color + "'>" + theWord + "</span>" + after);
    }
} 
```

​</p>

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-25T20:37:54.597

为了突出整行：

```
$("div:contains('hello')").css("color", "blue"); 
```

**编辑：**由于问题已更改为仅突出显示单词，因此您可以在此处找到答案： [使用 jQuery 突出显示单词](https://stackoverflow.com/questions/119441/highlight-a-word-with-jquery) 或仅使用其他人提到的插件。

**编辑：** 或者只是这样：

```
​$("div"​)​.each(function() {
    this.innerHTML = this.innerHTML.replace(/(hello)/g, "<span style='color: red'>$1</span>");
    this.innerHTML = this.innerHTML.replace(/(goodbye)/g, "<span style='color: blue'>$1</span>");
})​;​ 
```

要忽略但保留大小写，请使用`/(hello)/ig`正则表达式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-25T21:04:09.577

您可以在不需要插件的情况下执行此操作：

```
$("p").each(function() {
    if ($(this).children().length == 0) {
        var txt = $(this).text();
        var blue = /hello/i.exec(txt);
        var red = /goodby/i.exec(txt);
        if (blue) {
            $(this).html(txt.replace(/hello/i, '<span class="blue">' + blue + '</span>'));
        } else if (red) {
            $(this).html(txt.replace(/goodbye/i, '<span class="red">' + red + '</span>'));
        }
    }
}); 
```

见[http://jsfiddle.net/99mg7/1/](http://jsfiddle.net/99mg7/1/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-25T21:06:09.147

像这样的东西

```
$('p').each(function() {
    var html = $(this).html().replace(/L/gi, function(str) {
        var cls;
        if (str == str.toLowerCase()) {
            cls = 'blue';
        } else if (str == str.toUpperCase()) {              
            cls = 'red'; 
        }            
        return '<span class="' + cls + '">' + str + '</span>';
    });

    $(this).html(html);
}); 
```

[演示](http://jsfiddle.net/eJjsu/2/)

# c# - 从 C# 读取 XML 配置数据文件

> ID：10323352
> 
> 赞同：2
> 
> 时间：2012-04-25T20:36:00.327
> 
> 标签：c#, xml

我有一个名为 config.xml 的独立 XML 文件，它与我的应用程序一起使用，它基本上包含两个部分：

1) 全局设置 2) 服务器列表，包括设置

基本上，全局设置将包含我的程序将用于每个服务器列表的数据库用户名和数据库密码。

服务器列表条目包含服务器列表，以及一些文件名、数据库用户名和数据库密码。这里唯一重要的是，如果我在服务器列表中指定用户名/密码，那么它将使用它而不是全局数据库用户名和密码。或者，换一种说法，如果在 serverwr 列表条目中未定义数据库用户名和密码，它将使用全局数据库用户名密码。

我的程序基本上循环遍历 xml 配置文件并对每个 DB2 服务器执行一些数据库查询，处理信息并创建报告。它今天有效，但我确实有一些问题......

1) 每次我向我的 XML 配置文件添加一个新元素时，我都必须为我创建的每个节点添加它，否则我会收到 XML 解析错误。

2) 我想对我的配置 XML 文件进行分类，而不是将所有内容集中在同一个节点中并包含空元素。

示例 XML 如下：

```
<?xml version="1.0" encoding="utf-8" ?>
<Config>
    <Global>
    <OutputFolder>C:\DATA\Configs\DB2\</OutputFolder>
    <DBUser>DB2ADMIN</DBUser>
    <DBPassword>%SecretPassword%</DBPassword>
    <FTPFiles>false</FTPFiles>
    <FTPTcpIp>127.0.0.1</FTPTcpIp>
    <FTPUser>FTPLogin1</FTPUser>
    <FTPPassword>P@ssw0rd</FTPPassword>
    <FTPRemoteFolder>/configs</FTPRemoteFolder>
    </Global>
    <Servers>
        <Server enabled="true">
        <Category>Report1</Category>
        <TcpIp>192.168.26.107</TcpIp>
        <Database>SampleData</Database>
        <User></User>
        <Password></Password>
        <Report1FileNameList>List1.txt</Report1FileNameList>
        <Report1FileNameRoutes>Routes1.txt</Report1FileNameRoutes>
        <Report1FileNameRouteTimeouts>Timeouts1.txt</Report1FileNameRouteTimeouts>
        <Report1FileNameEndpoints></Report1FileNameEndpoints>
        <Report2FilenameServers></Report2FilenameServers>
        <Report2FilenameRoutingGroup></Report2FilenameRoutingGroup>
     </Server>
     <Server enabled="true">
         <Category>Report1</Category>
         <TcpIp>192.168.26.107</TcpIp>
         <Database>SampleDataB</Database>
         <User></User>
         <Password></Password>
         <Report1FileNameList>List1.txt</Report1FileNameList>
         <Report1FileNameRoutes>Routes1.txt</Report1FileNameRoutes>
         <Report1FileNameRouteTimeouts>Timeouts1.txt</Report1FileNameRouteTimeouts>
         <Report1FileNameEndpoints></Report1FileNameEndpoints>
         <Report2FilenameServers></Report2FilenameServers>
         <Report2FilenameRoutingGroup></Report2FilenameRoutingGroup>
      </Server>
      <Server enabled="true">
          <Category>Report2</Category>
          <TcpIp>192.168.26.107</TcpIp>
          <Database>SampleDataE</Database>
          <User></User>
          <Password></Password>
          <Report1FileNameList></Report1FileNameList>
          <Report1FileNameRoutes></Report1FileNameRoutes>
          <Report1FileNameRouteTimeouts></Report1FileNameRouteTimeouts>
          <Report1FileNameEndpoints>Endpoints2.txt</Report1FileNameEndpoints>
          <Report2FilenameServers>Servers2.txt</Report2FilenameServers>
          <Report2FilenameRoutingGroup>Groups2.txt</Report2FilenameRoutingGroup>
      </Server>
      <Server enabled="true">
          <Category>Report2</Category>
          <TcpIp>192.168.26.108</TcpIp>
          <Database>SampleDatabase1_D</Database>
          <User></User>
          <Password></Password>
          <Report1FileNameList></Report1FileNameList>
          <Report1FileNameRoutes></Report1FileNameRoutes>
          <Report1FileNameRouteTimeouts></Report1FileNameRouteTimeouts>
          <Report1FileNameEndpoints>Endpoints2.txt</Report1FileNameEndpoints>
          <Report2FilenameServers>Servers2.txt</Report2FilenameServers>
          <Report2FilenameRoutingGroup>Groups1.txt</Report2FilenameRoutingGroup>
       </Server>
    </Servers> 
```

示例代码如下：

```
 // load XML file
        try
        {
            // Config/Global
            System.Xml.XPath.XPathDocument doc = new System.Xml.XPath.XPathDocument(@"config.xml");

            foreach (System.Xml.XPath.XPathNavigator child in doc.CreateNavigator().Select("Config/Global"))
            {
                xml_global_outputFolder = child.SelectSingleNode("OutputFolder").Value;
                xml_global_DBuser = child.SelectSingleNode("DBUser").Value;
                xml_global_DBpassword = child.SelectSingleNode("DBPassword").Value;
                xml_global_FTPFiles = bool.Parse(child.SelectSingleNode("FTPFiles").Value);
                xml_global_FTPTcpIp = child.SelectSingleNode("FTPTcpIp").Value;
                xml_global_FTPUser = child.SelectSingleNode("FTPUser").Value;
                xml_global_FTPPassword = child.SelectSingleNode("FTPPassword").Value;
                xml_global_FTPRemoteFolder = child.SelectSingleNode("FTPRemoteFolder").Value;
            }

            // Config/Servers
            //System.Xml.XPath.XPathDocument doc = new System.Xml.XPath.XPathDocument(@"config.xml");
            foreach (System.Xml.XPath.XPathNavigator child in doc.CreateNavigator().Select("Config/Servers/*"))
            {

                //string xml_enabled = child.GetAttribute("Enabled", "");
                string xml_category = child.SelectSingleNode("Category").Value;
                string xml_tcpip = child.SelectSingleNode("TcpIp").Value;
                string xml_database = child.SelectSingleNode("Database").Value;
                string xml_user = child.SelectSingleNode("User").Value;
                string xml_password = child.SelectSingleNode("Password").Value;

                Console.WriteLine("Connecting to {0} using database {1} for {2} information...", xml_tcpip, xml_database, xml_category);

                // if node user value is empty, use global
                if (xml_user == string.Empty)
                {
                    DB2_user = xml_global_DBuser;
                }
                else
                {
                    DB2_user = xml_user;
                }

                // if node password value is empty, use global
                if (xml_password == string.Empty)
                {
                    DB2_password = xml_global_DBpassword;
                }
                else
                {
                    DB2_password = xml_password;
                }

                string txtFilename = string.Empty;
                string csvFilename = string.Empty;

                switch (xml_category.ToUpper())
                {
                    case "SAMPLE":
                        txtFilename = Path.Combine(xml_global_outputFolder, @"EMPLOYEE.csv");
                        csvFilename = Path.Combine(xml_global_outputFolder, Path.GetFileNameWithoutExtension(@"EMPLOYEE.csv"));
                        ExecuteQuery(xml_category, "SAMPLE", xml_tcpip, DB2_user, DB2_password, xml_database, csvFilename, txtFilename, option_debug);
                        break;
                }
                Console.WriteLine("");

            }
        }
        catch (Exception e)
        {
            Console.WriteLine("Exception: {0}", e.Message);
            Environment.Exit(1);
        }

        Environment.Exit(0);
    } 
```

我想理想情况下，我想创建特定于节点的配置，如果元素为空白，代码应该能够处理丢失的元素或空元素。也许使用类别的属性，而不是？就像是：

```
 <Config>
  <Global>
     <OutputFolder></OutputFolder>
     <DBUser></DBUser>
     <DBPassword><DBPassword>
  </Global>
  <Servers category="Report1">
     <Server>
        <TcpIP>whatever</TcpIP>
        <User>whatever></User>
        <Password>whatever></Password>
     </Server>
     <Server>
        <TcpIP>whatever</TcpIP>
        <User>whatever></User>
        <Password>whatever></Password>
     </Server>
     <Server>
        <TcpIP>whatever</TcpIP>
        <User>whatever></User>
        <Password>whatever></Password>
     </Server>
 </Server>
  <Servers category="Report2">
     <Server>
        <TcpIP>whatever</TcpIP>
        <User>whatever></User>
        <Password>whatever></Password>
     </Server>
     <Server>
        <TcpIP>whatever</TcpIP>
        <User>whatever></User>
        <Password>whatever></Password>
     </Server>
     <Server>
        <TcpIP>whatever</TcpIP>
        <User>whatever></User>
        <Password>whatever></Password>
     </Server>
 </Server>
  <Servers category="AccessList">
     <Server>
        <TcpIP>whatever</TcpIP>
        <Database>whatever></Database>
        <Active>whatever</Active>
     </Server>
     <Server>
        <TcpIP>whatever</TcpIP>
        <Database>whatever></Database>
        <Active>whatever</Active>
     </Server>
     <Server>
        <TcpIP>whatever</TcpIP>
        <Database>whatever></Database>
        <Active>whatever</Active>
     </Server>
 </Server>
</Config> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T00:04:37.163

您需要做的是创建一组类，每个类代表每组节点。如果您想使用[这些扩展](https://github.com/ChuckSavage/XmlLib/blob/master/XElementExtensions.cs)，它们将帮助您处理空节点和默认值：

在全局中读取和写入 OutputFolder：

```
DirectoryInfo outputFolder = ConfigFile.Read.Global.OutputFolder;
ConfigFile.Write(file => file.Global.OutputFolder = outputFolder); 
```

课程：

```
public class ConfigFile : IDisposable
{
    internal XElement self;
    string file = "path to a file";

    public ConfigFile()
    {
        if(File.Exists(file))
            self = XElement.Load(file);
        else
            self = new XElement("Config");
    }

    public void Dispose() { self.Save(file); }

    public static ConfigFile Read { get { return new ConfigFile(); } }

    public static void Write(Action<ConfigFile> action)
    {
        using(ConfigFile file = new ConfigFile())
            action(file);
    }

    public Global Global
    { get { return _Global ?? (_Global = new Global(self.GetElement("Global"))); } }
    Global _Global;

    public Servers Servers
    { get { return _Servers ?? (_Servers = new Servers(self.GetElement("Servers"))); } }
    Servers _Servers

    public class Global
    {
        internal XElement self;
        public Global(XElement self) { this.self = self; }

        public DirectoryInfo OutputFolder
        {
            get { return self.Get<DirectoryInfo>("OutputFolder", null); }
            set { self.Set("OutputFolder", value, false); }
        }
    }

    public class Servers
    {
        internal XElement self;
        public Servers(XElement self) { this.self = self; }

        public void Add(Server server)
        {
            self.Add(server.self);
        }

        public string Category
        {
            get { return self.Get("category", string.Empty); }
            set { self.Set("category", value, true); }
        }

        public Server[] Items
        { get { return self.GetEnumerable("Server", x => new Server(x)).ToArray(); } }

        public class Server
        {
            internal XElement self;

            public Server() { self = new XElement("Server"); }

            public Server(XElement self) { this.self = self; }

            public bool Active
            {
                get { return self.Get("Active", false); }
                set { self.Set("Active", value, true); }
            }
        }
    }
} 
```

`GetElement()`优于，`Element()`因为它处理元素节点不存在的情况。 `Get()`采用默认值，因此它总是有一个值。

一旦有了类区别，向文件添加新值就更简单了，因为您可以简单地将另一个属性写入一个类，如果它不存在则让它返回一个默认值。

# solver - GLPK MathProg 集和组

> ID：10323353
> 
> 赞同：4
> 
> 时间：2012-04-25T20:36:01.790
> 
> 标签：solver, ampl, mathprog

我希望这对某人来说是显而易见的。我只使用了 GLPK/MathProg。我无法弄清楚 GNU MathProg（在 GLPK 中）执行以下操作的语法，例如：

```
set PartsOfWeek;
set WeekDays;

data;
set PartsOfWeek := WorkWeek WeekEnd;

set WorkWeek := Mon Tue Wed Thu Fri;
set WeekEnd := Sat Sun;

set WeekDays := setof{d in (WorkWeek union WeekEnd)}(d); 
```

问题是这被 MathProg 拒绝了。

一般来说，我只想能够： - 声明一个分区（这里是 PartsOfWeek）和一个集合（这里是 Weekdays） - 从数据构建分区 - 用分区中集合的元素填充集合。

一个更好的例子可能是季节和月份。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-26T21:02:58.233

借助@ALi 的文献参考帮助：

```
set seasons;
set months;
set monthsOfseason {seasons} within months;

data;
set seasons := winter spring summer fall;
set months := jan feb mar apr may jun jul aug sep oct nov dec;
set monthsOfseason[winter] := dec jan feb;
set monthsOfseason[spring] := mar apr may;
set monthsOfseason[summer] := jun jul aug;
set monthsOfseason[fall]   := sep oct nov; 
```

# c# - 带有 C# 列表增量的 ASP.net 回发

> ID：10323356
> 
> 赞同：0
> 
> 时间：2012-04-25T20:36:15.433
> 
> 标签：c#, asp.net, postback

我有一个奇怪的问题。在我的程序中，用户操作下拉框并按下 ADD 按钮以用所选项目填充列表框。最终，我使用 INSERT 命令将这些项目发送到 MYSQL 数据库。当用户点击添加按钮时，项目被添加到通用列表和列表框中，并且在回发时一切似乎都很好，我可以整天添加东西。但是，当我点击提交/保存按钮，将数据发送到服务器时，列表会在每次回发时一遍又一遍地将添加的数据复制到自身，无论是什么原因导致回发。我可以在 lstbox 中看到结果，并且可以看到 List.count 上升。

我的 page_load 部分中没有代码。我确实使用会话属性来保存列表数据。

```
public List<string> activityProp
    {
        get
        {
            if (HttpContext.Current.Session["codelist"] == null)
            {
                HttpContext.Current.Session["codelist"] = new List<string>();
            }
            return HttpContext.Current.Session["codelist"] as List<string>;
        }
        set
        {
            HttpContext.Current.Session["codelist"] = value;
    }

} 
```

这是按钮的代码。sqlsetter() 方法只有一个通用的 SQL 命令结构和一个插入字符串。它仅从此按钮触发。

```
protected void cmdSave_Click(object sender, EventArgs e)
    {
        //this will use the 'test' class to do a rule check on the day
        test therules = new test();
        bool comp = therules.check(dayProp, timeProp, activityProp);

        if (comp == true)
        {
            lblComp.Text = "You're ok!";
            lblComp.ForeColor = Color.Green;
            lblError.Text = "";
            SQLdaysetter();
        }
        else
        {   
            string zeerror = therules.getError();
            lblComp.Text = "You're not ok!";
            lblError.Text = "at " + zeerror;
            lblComp.ForeColor = Color.Red;
            lblError.ForeColor = Color.Red;
        }

    } 
```

SQL的东西：

```
using (MySqlConnection conn = new    MySqlConnection(ConfigurationManager.ConnectionStrings["theConnectionString"].ConnectionString))
            {
                conn.Open();
                using (MySqlCommand cmdIns = new MySqlCommand(sqlstate, conn))
                {
                    cmdIns.ExecuteNonQuery();
                    cmdIns.Dispose();

                }
                conn.Close();
            } 
```

也许这些东西甚至与问题无关，有什么想法在哪里看？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T22:33:18.750

> 我在 OnInit 事件中有一些东西，显然每次重新加载页面时它们都会运行。我仍然不确定为什么

Jake，请花 10 分钟时间阅读页面生命周期（尤其是事件部分）。它将为您节省未来宝贵的时间。

[http://msdn.microsoft.com/en-us/library/ms178472.aspx](http://msdn.microsoft.com/en-us/library/ms178472.aspx)

# fortran90 - 如何在 FORTRAN90 中获得最多 7 位有效数字？

> ID：10323357
> 
> 赞同：0
> 
> 时间：2012-04-25T20:36:17.080
> 
> 标签：fortran90, significant-digits

```
INTEGER, PARAMETER :: SINGLE=SELECTED_REAL_KIND(7)
REAL(KIND=SINGLE) :: K
REAL::X
...
K=X
WRITE(*,*) K 
```

当我在里面写 5 或 6`SELECTED_REAL_KIND`时，它会输出 6 个有效数字，但当我尝试 7 时，它会输出超过 7。你能告诉我为什么吗？我哪里弄错了？赋值有问题？

带 5 和 6 输出-> 1.39256

有 7 个输出-> 1.3925623893

好吧，我在问一个简单的问题。我怎样才能输出这个数字 1.3925623893 的 7 个有效数字？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T19:36:51.947

来自 gfortran 的文档：

> SELECTED_REAL_KIND(P,R) 返回具有至少 P 位小数精度的实数数据类型的 kind 值

*至少*是重要的。浮点数大部分时间使用 4 个字节（单精度）或 8 个字节（双精度）存储，仅此而已。这从要求 6 到 7 个有效数字实际上增加了更多数字：您从单精度切换到双精度。

你真正想要的是有一个足够大的空间来存储你想要的精度，并且你已经正确地做到了，然后使用如下格式只*显示7 个有效数字：*

```
write(*,'(F12.7)') K 
```

# sql-server-2008 - 当一个线轴有多个时它表示什么

> ID：10323359
> 
> 赞同：0
> 
> 时间：2012-04-25T20:36:42.963
> 
> 标签：sql-server-2008, sql-execution-plan

![表线轴](../Images/2a26c4d877bfbfc3b54a37f6d5d832a0.png)

根据[MSDN](http://msdn.microsoft.com/en-us/library/ms181032.aspx)，

> 表假脱机操作员扫描输入并将每一行的副本放在一个隐藏假脱机表中，该假脱机表存储在 tempdb 数据库中，并且仅在查询的生命周期内存在。

首先，在这一步之前的计划中没有任何输入......这个文字表明它应该和[其他](http://www.simple-talk.com/sql/learn-sql-server/operator-of-the-week---spools,-eager-spool/)在线资源已经说了这么多。

> 假脱机操作员总是与另一个操作员一起使用。当它存储值时，它需要知道这些值是什么，因此它必须从另一个运算符接收它们。

其次，当悬停在输出列表中包含多个表时。所有这些都被假脱机到单独的桌子上吗？如果是这样，为什么不显示多个步骤？如果它们都被假脱机到一张桌子上，它们是否在假脱机之前被连接起来？如果你愿意的话，可以让表格“变平”。

第三，正如我在下面解释的那样，我认为我有 1 和 2 的答案......但现在我看到原始步骤的成本百分比为 0%，当该阀芯在另一个分支中重复使用时，成本百分比为 12%。为什么读回来比原来写出来的成本更高？

编辑：文本计划

```
StmtText
  |--Compute Scalar(DEFINE:([so].[SLS_ORG_OPR_UNT_SRC_KEY]=[Expr1021], [so].[SLS_ORG_PROD_SRC_KEY]=[Expr1022], [cal].[WEEK_END_DATE]=[Expr1023], [so].[SLS_ORG_EMPL_SRC_KEY]=[Expr1024], [so].[SLS_ORG_JOBCODE]=[Expr1025]))
       |--Hash Match(Inner Join, HASH:([Expr1021], [Expr1022], [Expr1023], [Expr1024], [Expr1025])=([Expr1016], [Expr1017], [Expr1018], [Expr1019], [Expr1020]), RESIDUAL:([Expr1016] = [Expr1021] AND [Expr1017] = [Expr1022] AND [Expr1018] = [Expr1023] AND [Expr1019] = [Expr1024] AND [Expr1020] = [Expr1025]))
            |--Compute Scalar(DEFINE:([Expr1021]=[DMRPT].[dbo].[DIM_SALES_ORG].[SLS_ORG_OPR_UNT_SRC_KEY] as [so].[SLS_ORG_OPR_UNT_SRC_KEY], [Expr1022]=[DMRPT].[dbo].[DIM_SALES_ORG].[SLS_ORG_PROD_SRC_KEY] as [so].[SLS_ORG_PROD_SRC_KEY], [Expr1023]=[DMRPT].[dbo].[DIM_CALENDAR].[WEEK_END_DATE] as [cal].[WEEK_END_DATE], [Expr1024]=[DMRPT].[dbo].[DIM_SALES_ORG].[SLS_ORG_EMPL_SRC_KEY] as [so].[SLS_ORG_EMPL_SRC_KEY], [Expr1025]=[DMRPT].[dbo].[DIM_SALES_ORG].[SLS_ORG_JOBCODE] as [so].[SLS_ORG_JOBCODE]))
            |    |--Compute Scalar(DEFINE:([Expr1011]=CONVERT_IMPLICIT(int,[Expr1059],0)))
            |         |--Stream Aggregate(GROUP BY:([so].[SLS_ORG_OPR_UNT_SRC_KEY], [so].[SLS_ORG_PROD_SRC_KEY], [cal].[WEEK_END_DATE], [so].[SLS_ORG_EMPL_SRC_KEY], [so].[SLS_ORG_JOBCODE]) DEFINE:([Expr1059]=COUNT([Expr1015])))
            |              |--Sort(DISTINCT ORDER BY:([so].[SLS_ORG_OPR_UNT_SRC_KEY] ASC, [so].[SLS_ORG_PROD_SRC_KEY] ASC, [cal].[WEEK_END_DATE] ASC, [so].[SLS_ORG_EMPL_SRC_KEY] ASC, [so].[SLS_ORG_JOBCODE] ASC, [Expr1015] ASC))
            |                   |--Table Spool
            |                        |--Compute Scalar(DEFINE:([Expr1015]=[Expr1013]+[Expr1014]))
            |                             |--Hash Match(Inner Join, HASH:([so].[SLS_ORG_GK])=([f].[SLS_ORG_GK]), RESIDUAL:([DMRPT].[dbo].[FACT_PRODUCER_SPREAD_HOURS].[SLS_ORG_GK] as [f].[SLS_ORG_GK]=[DMRPT].[dbo].[DIM_SALES_ORG].[SLS_ORG_GK] as [so].[SLS_ORG_GK]))
            |                                  |--Clustered Index Scan(OBJECT:([DMRPT].[dbo].[DIM_SALES_ORG].[SYS_SLS_ORG_GK] AS [so]))
            |                                  |--Hash Match(Inner Join, HASH:([c].[CONTR_GK])=([f].[CONTR_GK]), RESIDUAL:([DMRPT].[dbo].[FACT_PRODUCER_SPREAD_HOURS].[CONTR_GK] as [f].[CONTR_GK]=[DMRPT].[dbo].[DIM_CONTRACTOR].[CONTR_GK] as [c].[CONTR_GK]))
            |                                       |--Compute Scalar(DEFINE:([Expr1014]=CONVERT_IMPLICIT(numeric(38,0),[DMRPT].[dbo].[DIM_CONTRACTOR].[CONTR_SRC_KEY] as [c].[CONTR_SRC_KEY],0)))
            |                                       |    |--Index Scan(OBJECT:([DMRPT].[dbo].[DIM_CONTRACTOR].[nc_csk] AS [c]))
            |                                       |--Hash Match(Inner Join, HASH:([r].[REQ_POS_GK])=([f].[REQ_POS_GK]), RESIDUAL:([DMRPT].[dbo].[FACT_PRODUCER_SPREAD_HOURS].[REQ_POS_GK] as [f].[REQ_POS_GK]=[DMRPT].[dbo].[DIM_REQUISITION_POS].[REQ_POS_GK] as [r].[REQ_POS_GK]))
            |                                            |--Compute Scalar(DEFINE:([Expr1013]=CONVERT_IMPLICIT(numeric(38,0),[DMRPT].[dbo].[DIM_REQUISITION_POS].[REQ_POS_JOB_REQ_SRC_KEY] as [r].[REQ_POS_JOB_REQ_SRC_KEY],0)+[DMRPT].[dbo].[DIM_REQUISITION_POS].[REQ_POS_POSITION_NO] as [r].[REQ_POS_POSITION_NO]))
            |                                            |    |--Clustered Index Scan(OBJECT:([DMRPT].[dbo].[DIM_REQUISITION_POS].[SYS_C00600262] AS [r]))
            |                                            |--Hash Match(Inner Join, HASH:([cal].[DATE_GK])=([f].[WEEK_END_DATE_GK]), RESIDUAL:([DMRPT].[dbo].[FACT_PRODUCER_SPREAD_HOURS].[WEEK_END_DATE_GK] as [f].[WEEK_END_DATE_GK]=[DMRPT].[dbo].[DIM_CALENDAR].[DATE_GK] as [cal].[DATE_GK]))
            |                                                 |--Clustered Index Scan(OBJECT:([DMRPT].[dbo].[DIM_CALENDAR].[SYS_C00599872] AS [cal]), WHERE:([DMRPT].[dbo].[DIM_CALENDAR].[FULL_DATE] as [cal].[FULL_DATE]>=getdate()-'1900-01-31 00:00:00.000'))
            |                                                 |--Clustered Index Scan(OBJECT:([DMRPT].[dbo].[FACT_PRODUCER_SPREAD_HOURS].[PK_FCT_PRDCR_SPRD_HRS] AS [f]))
            |--Compute Scalar(DEFINE:([Expr1016]=[DMRPT].[dbo].[DIM_SALES_ORG].[SLS_ORG_OPR_UNT_SRC_KEY] as [so].[SLS_ORG_OPR_UNT_SRC_KEY], [Expr1017]=[DMRPT].[dbo].[DIM_SALES_ORG].[SLS_ORG_PROD_SRC_KEY] as [so].[SLS_ORG_PROD_SRC_KEY], [Expr1018]=[DMRPT].[dbo].[DIM_CALENDAR].[WEEK_END_DATE] as [cal].[WEEK_END_DATE], [Expr1019]=[DMRPT].[dbo].[DIM_SALES_ORG].[SLS_ORG_EMPL_SRC_KEY] as [so].[SLS_ORG_EMPL_SRC_KEY], [Expr1020]=[DMRPT].[dbo].[DIM_SALES_ORG].[SLS_ORG_JOBCODE] as [so].[SLS_ORG_JOBCODE]))
                 |--Hash Match(Aggregate, HASH:([so].[SLS_ORG_OPR_UNT_SRC_KEY], [so].[SLS_ORG_PROD_SRC_KEY], [cal].[WEEK_END_DATE], [so].[SLS_ORG_EMPL_SRC_KEY], [so].[SLS_ORG_JOBCODE]), RESIDUAL:([DMRPT].[dbo].[DIM_SALES_ORG].[SLS_ORG_OPR_UNT_SRC_KEY] as [so].[SLS_ORG_OPR_UNT_SRC_KEY] = [DMRPT].[dbo].[DIM_SALES_ORG].[SLS_ORG_OPR_UNT_SRC_KEY] as [so].[SLS_ORG_OPR_UNT_SRC_KEY] AND [DMRPT].[dbo].[DIM_SALES_ORG].[SLS_ORG_PROD_SRC_KEY] as [so].[SLS_ORG_PROD_SRC_KEY] = [DMRPT].[dbo].[DIM_SALES_ORG].[SLS_ORG_PROD_SRC_KEY] as [so].[SLS_ORG_PROD_SRC_KEY] AND [DMRPT].[dbo].[DIM_CALENDAR].[WEEK_END_DATE] as [cal].[WEEK_END_DATE] = [DMRPT].[dbo].[DIM_CALENDAR].[WEEK_END_DATE] as [cal].[WEEK_END_DATE] AND [DMRPT].[dbo].[DIM_SALES_ORG].[SLS_ORG_EMPL_SRC_KEY] as [so].[SLS_ORG_EMPL_SRC_KEY] = [DMRPT].[dbo].[DIM_SALES_ORG].[SLS_ORG_EMPL_SRC_KEY] as [so].[SLS_ORG_EMPL_SRC_KEY] AND [DMRPT].[dbo].[DIM_SALES_ORG].[SLS_ORG_JOBCODE] as [so].[SLS_ORG_JOBCODE] = [DMRPT].[dbo].[DIM_SALES_ORG].[SLS_ORG_JOBCODE] as [so].[SLS_ORG_JOBCODE]) DEFINE:([Expr1010]=SUM([DMRPT].[dbo].[FACT_PRODUCER_SPREAD_HOURS].[SPREAD_LCL] as [f].[SPREAD_LCL])))
                      |--Table Spool 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T20:58:21.130

好吧，我发现如果您看到该操作，请按照[此处](http://www.simple-talk.com/sql/learn-sql-server/showplan-operator-of-the-week---lazy-spool/)所述在计划中查找其他位置。

因此，计划的一个分支的结果被写出，临时表在另一个分支中再次使用。所以现在我看到了源代码，我看到了前辈/输入，并看到它已经将表连接在一起并且正在假脱机连接的行。

# java - 启动和停止 Thread-JButton 对齐

> ID：10323366
> 
> 赞同：0
> 
> 时间：2012-04-25T20:37:13.317
> 
> 标签：java, multithreading, actionlistener, timertask

我正在尝试创建一个带有开始停止和重置按钮的简单计时器。我是使用线程和 ActionListeners 的新手。我有这个工作，可以让我的计时器开始，我的按钮可以从开始到停止更改文本。但在那之后我被困住了。如果我按下开始按钮，我需要停止计时器，然后重新启动它。然后当然重置将其变回零。我不想使用`java.util.Timer`，我只想使用线程。一旦开始，我将如何让我的线程暂停然后恢复。我尝试使用内置方法，但无法正确编译。

```
import javax.swing.*;
import java.awt.Font;
import java.lang.String;
import java.awt.*;

public class Timer extends JPanel {

  // Here are the fields from below!

  private static JLabel label = new JLabel("   0.00 seconds");
  private static javax.swing.JButton start = new javax.swing.JButton("Start");
  private static javax.swing.JButton reset = new javax.swing.JButton("reset");

  /**
   * Here is the Timer method- Begins with JLabel with medium alignment.
   */
  public Timer() {
    //new Thread(this).start();
    //label = new JLabel("   0.00 Seconds");
    //this.label = label;
    reset();
  }

  /**
   * Here is the Reset method- pressing this button from below will 
   * stop the thread and reset the text.
   */
  public static void reset() {
    label.setFont(new Font("Arial",Font.BOLD,36));
    label.setText("   0.00 Seconds");

  }

  public static void startStop() {
    //start.setText("stop");
    //validate();

  }

  public static void countDown() {
    int Msec=0,min=0,sec=0;
    while(sec < 60) {
          label.setText(min+":"+sec+":"+Msec);
          //label.setLayout(new BorderLayout.CENTER);
          //label.
          Msec++;
          if(Msec==60) {
            Msec=0;
            sec++;
            //label.setText(min+":"+sec+":"+Msec);
          }
          if(sec ==60) {
            Msec =0;
            sec = 0;
            min++;
          }
          try
        {
          Thread.sleep(10);
        }
        catch(Exception e)
        {}
      }
  }      

public static void main(String [] args) {

  // we need a JFrame to put these elements into
  javax.swing.JFrame win = new javax.swing.JFrame("Timer");
  // here we are instantating a new timer
  final Timer time = new Timer();

  //Annonymous inner class
  start.addActionListener(new java.awt.event.ActionListener() {
    // here is the action performed method to start this.
    public void actionPerformed(java.awt.event.ActionEvent e) {
      //here we are creating a new thread to run throwable
      // every click creates a new Thread ( so it goes faster)
      String text = (String)e.getActionCommand();
      if (text.equals("Start")){
        start.setText("Stop");
      }
      else{
        start.setText("Start");
      }
      Thread restart = new Thread(new Runnable() {
        public void run() {
          countDown();
          //startStop();
        }

      });
      restart.start();
    }
  });

  //Look at the below abstract actionlistener below to get reset to work
  javax.swing.JButton reset = new javax.swing.JButton("reset");

  // here we are creating a new annonomys inner class.... check the
  // curly braces
  reset.addActionListener(new java.awt.event.ActionListener() {
    public void actionPerformed(java.awt.event.ActionEvent e) {
      Thread restart = new Thread(new Runnable() {
        public void run() {
          reset();
          //Thread.stop();
        }

      });
      restart.destroy();
    }
  });

  //label.setVisible(true);

  javax.swing.JPanel tb = new javax.swing.JPanel();
  tb.add(reset);
  tb.add(start);
  //tb.add(circle);
  win.add(tb,java.awt.BorderLayout.NORTH);
  win.setSize(300,300);
  //win.add(tb);
  win.add(label,java.awt.BorderLayout.CENTER);

  win.setDefaultCloseOperation(javax.swing.JFrame.DISPOSE_ON_CLOSE);
  // hiding inside setVisible is borderLayout
  win.setVisible(true);
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T20:47:03.703

你想通过线程练习和改进是令人钦佩的，也是一个伟大的目标，但这真的不是它的舞台。问题是 Swing 是单线程的——只有 ui 线程应该更新图形环境。

对于涉及图形的操作，您应该使用 javax.swing.Timer 和 javax.swing.SwingWorker，因为它们是**线程安全**的。一方面，你在这里学习线程安全，所以你正在进步！

# c# - Application.Exit() 会杀死后台线程吗？

> ID：10323372
> 
> 赞同：3
> 
> 时间：2012-04-25T20:37:50.540
> 
> 标签：c#, multithreading, application-shutdown

我创建了一个运行多个后台线程的表单。我添加了另一个处理异常和错误（如果有）的类。当代码运行时，如果发生应该强制应用程序关闭的错误，我可以使用`Application.Exit()`吗？这也会杀死后台线程吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-25T20:39:39.150

不，它不会。Application.Exit() 将简单地强制 Windows 消息泵发布退出消息，这将终止您的应用程序的主线程。但是，进程本身将继续运行，直到后台线程完成。

**更新**：正如评论者正确指出的那样，如果您的线程的 IsBackground 属性设置为 True，则通过 Application.Exit() 终止主线程将关闭该进程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T20:39:47.250

不，线程终止是合作的。

# regex - 获取/拆分括号/括号内的文本

> ID：10323374
> 
> 赞同：0
> 
> 时间：2012-04-25T20:37:58.340
> 
> 标签：regex, vb.net

只要有一个单词列表，例如：

```
gram (g)
kilogram (kg)
pound (lb) 
```

只是想知道如何获取括号内的单词，例如在“gram (g)”中获取“g”并将其调暗为新字符串。可能使用正则表达式？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T20:43:49.843

使用拆分功能..

```
strArr  = str.Split("(")  ' splitting 'gram (g)' returns an array ["gram " , "g)"] index 0 and 1
strArr2 = strArr[1].Split(")") ' splitting 'g)' returns an array ["g " ..] 
```

字符串在

```
strArr2[0] 
```

**编辑**

你希望 getAbbrev 和 getAbbrev2 是数组

尝试

```
Dim getAbbrev As String() = Str.Split("(") 
Dim getAbbrev2 as String() = getAbbrev[1].Split(")") 
```

要在不声明数组的情况下做到这一点，您可以这样做

```
"gram (g)".Split("(")[1].Split(")")[0] 
```

但那是不可读的

**编辑**

你有一些非常微不足道的错误。我建议您首先加强对对象和声明的理解。然后你可以查看调用方法。我宁愿让你明白也不愿给你。重新阅读您拥有的书或寻找基本教程。

```
Dim unit As String = 'make sure this is the actual string you are getting, not sure where you are supposed to get the string value from => ie grams (g)

Dim getAbbrev As String() = unit.Split("(") 'use unit not Str - Str does not exist
Dim getAbbrev2 As String() = getAbbrev[1].Split(")") 'As no as - case sensitive 
```

最后一行参考`getAbbrev2`而不是未知`abbrev2`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T21:49:42.557

正则表达式的乐趣（我真的不是这里的专家，但经过测试和工作）

```
Imports System.Text.RegularExpressions
.....

Dim charsToTrim() As Char = { "("c, ")"c }
Dim test as String = "gram (g)" + Environment.NewLine +   
         "kilogram (kg)" + Environment.NewLine +   
         "pound (lb)"  

Dim pattern as String = "\([a-zA-Z0-9]*\)"
Dim r As Regex = new Regex(pattern, RegexOptions.IgnoreCase)
Dim m As Match = r.Match(test)
While(m.Success)
   System.Diagnostics.Debug.WriteLine("Match" + "=" + m.Value.ToString())
   Dim tempText as String = m.Value.ToString().Trim(charsToTrim)
   System.Diagnostics.Debug.WriteLine("String Trimmed" + "=" + tempText)
   m = m.NextMatch()
End While 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T22:13:04.170

您可以在空格处拆分并从第二个标记中删除括号（通过将它们替换为空字符串）。

正则表达式也是一种选择，非常简单，它的模式是

`\w+\s+\((\w+)\)`

这意味着，一个单词，然后是至少一个空格，然后是左括号，然后在真正的正则表达式中搜索一个单词，最后是一个右括号。内括号是捕获括号，可以引用单位 g、kg、lb。

# android - 套接字连接 - 网络运营商上的阻塞端口

> ID：10323384
> 
> 赞同：3
> 
> 时间：2012-04-25T20:39:11.243
> 
> 标签：android, sockets

我正在开发一个使用套接字连接作为其消息传递系统的一部分的 Android 应用程序。但是，我遇到了一个问题，即所有端口（标准电子邮件/http 等端口除外）似乎都被英国的网络运营商阻止了。我做错了什么吗？看起来套接字连接在任何移动运营商网络上都几乎没有用。

# android - 使用额外的捆绑传递 lng/lat 不起作用

> ID：10323385
> 
> 赞同：0
> 
> 时间：2012-04-25T20:39:14.733
> 
> 标签：android, map

我正在创建一个包含三个主要活动的项目（我们称它们为活动 1、2 和 3）。在活动 1 中，我额外传递了我的捆绑包中的数字。

```
newActivity.putExtra("LAT", getText(R.string.LAT1));
newActivity.putExtra("LNG", getText(R.string.LNG1)); 
```

然后，在第二个中，我得到这样的：

```
 double Lata;
    double Lnga;

//in onCreate..
        Bundle extras = getIntent().getExtras();

        Lata = extras.getDouble("LAT");
        Lnga = extras.getDouble("LNG"); 
```

然后，我将它们传递给第三个活动，如下所示：

```
newActivity.putExtra("LAT",Lata);
newActivity.putExtra("LNG",Lnga); 
```

最后，在第三个活动中：

```
public class mapview extends MapActivity
{
 @Override  
 public void onCreate(Bundle savedInstanceState)
 {
 super.onCreate(savedInstanceState);
 requestWindowFeature(Window.FEATURE_NO_TITLE);

 setContentView(R.layout.map);

 MapView mapView = (MapView) findViewById(R.id.mapview);
 mapView.setBuiltInZoomControls(true);
 //mapView.setSatellite(true);
 //mapView.setStreetView(true);
 List<Overlay> mapOverlays = mapView.getOverlays();
  Drawable drawable = this.getResources().getDrawable(R.drawable.pin);
 HelloItemizedOverlay itemizedoverlay = new HelloItemizedOverlay(drawable,this);

 Bundle extras = getIntent().getExtras();
final double Latc = extras.getDouble("LAT");
 final double Lngc = extras.getDouble("LNG");
Integer txt_map = extras.getInt("MAP_NAME");

 TextView mapname=(TextView)findViewById(R.id.museum_address_name);
 mapname.setText(getText(txt_map));

 Double lat = Double.valueOf(Latc*1E6);

    Double lng = Double.valueOf(Lngc*1E6);

    //---------------------------------------------------
    GeoPoint center = new GeoPoint(Double.valueOf(Latc*1E6).intValue(), Double.valueOf(Lngc*1E6).intValue());
    MapController controller = mapView.getController();
        controller.setCenter(center);
    controller.setZoom(15);
    //---------------------------------------------------

    GeoPoint point = new GeoPoint(lat.intValue(), lng.intValue());
 OverlayItem overlayitem = new OverlayItem(point, "", "");

 itemizedoverlay.addOverlay(overlayitem);

 mapOverlays.add(itemizedoverlay);
 }
 @Override
 protected boolean isRouteDisplayed()
 {
 return false;
 }
} 
```

结果在南美洲的某个地方，但我的经纬度都在欧洲……我做错了什么？我试图修复它超过 2 小时……:(

编辑

```
04-25 23:58:19.001: W/KeyCharacterMap(3746): No keyboard for id 0
04-25 23:58:19.081: W/KeyCharacterMap(3746): Using default keymap: /system/usr/keychars/qwerty.kcm.bin
04-25 23:58:22.461: W/Bundle(3746): Key LAT expected Double but value was a java.lang.Integer.  The default value 0.0 was returned.
04-25 23:58:22.481: W/Bundle(3746): Attempt to cast generated internal exception:
04-25 23:58:22.481: W/Bundle(3746): java.lang.ClassCastException: java.lang.Integer
04-25 23:58:22.481: W/Bundle(3746):     at android.os.Bundle.getDouble(Bundle.java:1017)
04-25 23:58:22.481: W/Bundle(3746):     at android.os.Bundle.getDouble(Bundle.java:1000)
04-25 23:58:22.481: W/Bundle(3746):     at kostas.menu.athensmuseums.museum_item.onCreate(museum_item.java:39)
04-25 23:58:22.481: W/Bundle(3746):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
04-25 23:58:22.481: W/Bundle(3746):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627)
04-25 23:58:22.481: W/Bundle(3746):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
04-25 23:58:22.481: W/Bundle(3746):     at android.app.ActivityThread.access$2300(ActivityThread.java:125)
04-25 23:58:22.481: W/Bundle(3746):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
04-25 23:58:22.481: W/Bundle(3746):     at android.os.Handler.dispatchMessage(Handler.java:99)
04-25 23:58:22.481: W/Bundle(3746):     at android.os.Looper.loop(Looper.java:123)
04-25 23:58:22.481: W/Bundle(3746):     at android.app.ActivityThread.main(ActivityThread.java:4627)
04-25 23:58:22.481: W/Bundle(3746):     at java.lang.reflect.Method.invokeNative(Native Method)
04-25 23:58:22.481: W/Bundle(3746):     at java.lang.reflect.Method.invoke(Method.java:521)
04-25 23:58:22.481: W/Bundle(3746):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
04-25 23:58:22.481: W/Bundle(3746):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
04-25 23:58:22.481: W/Bundle(3746):     at dalvik.system.NativeStart.main(Native Method)
04-25 23:58:22.481: W/Bundle(3746): Key LNG expected Double but value was a java.lang.Integer.  The default value 0.0 was returned.
04-25 23:58:22.491: W/Bundle(3746): Attempt to cast generated internal exception:
04-25 23:58:22.491: W/Bundle(3746): java.lang.ClassCastException: java.lang.Integer
04-25 23:58:22.491: W/Bundle(3746):     at android.os.Bundle.getDouble(Bundle.java:1017)
04-25 23:58:22.491: W/Bundle(3746):     at android.os.Bundle.getDouble(Bundle.java:1000)
04-25 23:58:22.491: W/Bundle(3746):     at kostas.menu.athensmuseums.museum_item.onCreate(museum_item.java:40)
04-25 23:58:22.491: W/Bundle(3746):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
04-25 23:58:22.491: W/Bundle(3746):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627)
04-25 23:58:22.491: W/Bundle(3746):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
04-25 23:58:22.491: W/Bundle(3746):     at android.app.ActivityThread.access$2300(ActivityThread.java:125)
04-25 23:58:22.491: W/Bundle(3746):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
04-25 23:58:22.491: W/Bundle(3746):     at android.os.Handler.dispatchMessage(Handler.java:99)
04-25 23:58:22.491: W/Bundle(3746):     at android.os.Looper.loop(Looper.java:123)
04-25 23:58:22.491: W/Bundle(3746):     at android.app.ActivityThread.main(ActivityThread.java:4627)
04-25 23:58:22.491: W/Bundle(3746):     at java.lang.reflect.Method.invokeNative(Native Method)
04-25 23:58:22.491: W/Bundle(3746):     at java.lang.reflect.Method.invoke(Method.java:521)
04-25 23:58:22.491: W/Bundle(3746):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
04-25 23:58:22.491: W/Bundle(3746):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
04-25 23:58:22.491: W/Bundle(3746):     at dalvik.system.NativeStart.main(Native Method)
04-25 23:58:24.251: W/MapActivity(3746): Recycling dispatcher com.google.googlenav.datarequest.DataRequestDispatcher@44ec4318 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T20:55:23.293

我怀疑`getText`返回 a`String`或 a`CharSequence`所以你将一个字符串放入包中但将其作为双精度读取。相反，请确保先将其转换为双精度：

```
newActivity.putExtra("LAT", Double.parseDouble(getText(R.string.LAT1)));
newActivity.putExtra("LNG", Double.parseDouble(getText(R.string.LNG1))); 
```

这是假设您已经正确验证了您`TextView`的 s 确实包含有效的双精度。

# android - 在线程中插入progressDialog

> ID：10323389
> 
> 赞同：0
> 
> 时间：2012-04-25T20:39:22.537
> 
> 标签：android, multithreading

我有一个调用在活动中填充列表的函数的线程，我会在函数运行时放置一个progressDialog，我想知道我要如何更改调用活动时调用的进度对话框，遵循当前代码：

```
new Thread(){            
         public void run() {

                runOnUiThread(new Runnable() {       
                    @Override
                    public void run() {
                        loadList();
                    }
                });
            }
         }.start(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T20:42:59.907

我认为您最好使用 AsyncTask，轻松将进度对话框附加到此。

这是一个例子：[http ://droidapp.co.uk/?p=177](http://droidapp.co.uk/?p=177)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T21:16:51.930

在 UI-Thread 中创建并启动您的进度对话框，然后启动您的 Thread。创建一个 Runnable 对象，该对象 dissmiss() 您的进度。当您完成使用 runOnUiThread 填充列表时调用此 Runnable。

# c# - 在 WPF 面板上添加和删除用户控件的正确方法

> ID：10323390
> 
> 赞同：1
> 
> 时间：2012-04-25T20:39:32.723
> 
> 标签：c#, wpf

在面板上添加和删除用户控件的正确方法。

我对此有一些疑问：

1.  这样做是正确的（更好的方法）吗？
2.  一段时间后在内存中留下一些浪费来运行应用程序？

目前我有一个主窗口如下：

```
<!-- MainWindow.xaml -->
<Window x:Class="Empresas.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Empresas" Height="480" Width="640"
        MinHeight="480" MinWidth="640">
    <DockPanel HorizontalAlignment="Stretch" Width="Auto" Margin="0">

        <!-- Menu -->
        <Menu x:Name="MainWindowClientesMenu" Width="Auto" Height="25"
              DockPanel.Dock="Top">
            <MenuItem Header="_Archivo">
                <MenuItem Header="Agregar _Nueva empresa" x:Name="MainWindowClientesAgregarEmpresa" Click="MainWindowClientesAgregarEmpresa_Click" />
                <Separator/>
                <MenuItem Header="Salir"/>
            </MenuItem>
        </Menu>
        <!-- Fin Menu -->

        <!-- Barra de Estado -->
        <StatusBar x:Name="MainWindowClientesStatusBar" Width="Auto" Height="25"
                   DockPanel.Dock="Bottom" Background="#ddd" HorizontalAlignment="Stretch">
            <StatusBarItem x:Name="MainWindowClientesCurrentAction" HorizontalContentAlignment="Right"
                           Margin="0 0 5 0"></StatusBarItem>
        </StatusBar>

        <StackPanel x:Name="MainWindowClientesContenido"></StackPanel>
        <!-- Fin Lista isquierda de Empresas/Clientes -->

    </DockPanel>
</Window> 
```

我的用户控件如下

```
<!-- NuevaEmpresa.xaml -->
<UserControl x:Class="Empresas.View.NuevaEmpresa"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d" Height="300" Width="350">
    <Grid>
        <Label Content="Razon Social" Height="28" HorizontalAlignment="Left" Margin="12,12,0,0" Name="label1" VerticalAlignment="Top" />
        <TextBox Height="23" HorizontalAlignment="Left" Margin="118,14,0,0" Name="NuevaEmpresaRazonSocialTxtBox" VerticalAlignment="Top" Width="220" />
        <Label Content="Nit" Height="28" HorizontalAlignment="Left" Margin="12,52,0,0" Name="label2" VerticalAlignment="Top" />
        <TextBox Height="23" HorizontalAlignment="Left" Margin="118,54,0,0" Name="NuevaEmpresaNitTxtBox" VerticalAlignment="Top" Width="220" />
        <Button Content="Crear Empresa" Height="23" HorizontalAlignment="Left" Margin="223,114,0,0" Name="NuevaEmpresaCrearButton" VerticalAlignment="Top" Width="115" Click="NuevaEmpresaCrearButton_Click" />
        <Button Content="Cancelar" Height="23" HorizontalAlignment="Left" Margin="93,114,0,0" Name="NuevaEmpresaCancelarButton" VerticalAlignment="Top" Width="115" Click="NuevaEmpresaCancelarButton_Click" />
    </Grid>
</UserControl> 
```

以及他们如何添加和删除控件如下：

```
// MainWindow.xaml.cs
private void MainWindowClientesAgregarEmpresa_Click(object sender, RoutedEventArgs e)
        {
            MainWindowClientesContenido.Children.Add(new View.NuevaEmpresa(MainWindowClientesContenido));
        }

// NuevaEmpresa.xaml.cs
public partial class NuevaEmpresa : UserControl
{
    // ...
    private Panel _parent;    

    public NuevaEmpresa(Panel parent)
    {
        InitializeComponent();
        _parent = parent;
        // ...

    }

    // ...

    private void NuevaEmpresaCancelarButton_Click(object sender, RoutedEventArgs e)
    {
        _parent.Children.Clear();
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T20:51:28.113

我不明白为什么这可能是错误的。您正在设置它的孩子，然后清除它。这对我来说似乎很理智。也不明白为什么内存可能会泄漏。一旦父母清除其孩子，则必须将其处置。

# javascript - 在 Javascript/jQuery 中，(e) 是什么意思？

> ID：10323392
> 
> 赞同：112
> 
> 时间：2012-04-25T20:39:41.090
> 
> 标签：javascript, jquery, function, parameters, parameter-passing

我是 JavaScript/jQuery 的新手，我一直在学习如何制作函数。括号中的 (e) 出现了很多函数。让我告诉你我的意思：

```
$(this).click(function(e) {
    // does something
}); 
```

这个函数似乎总是不使用 (e) 的值，那为什么它经常出现呢？

* * *

## 回答 #1

> 赞同：117
> 
> 时间：2012-04-25T20:40:20.017

`e``event`是将传递给事件处理程序的对象的短 var 引用。

事件对象本质上具有许多可以在事件处理程序中使用的有趣方法和属性。

在您发布的示例中，单击处理程序是`MouseEvent`

```
$(<element selector>).click(function(e) {
    // does something
    alert(e.type); //will return you click
} 
```

[**DEMO**](http://jsfiddle.net/skram/rY3Tj/2/) - 鼠标事件 DEMO 使用`e.which`和`e.type`

一些有用的参考：

[http://api.jquery.com/category/events/](http://api.jquery.com/category/events/)

[http://www.quirksmode.org/js/events_properties.html](http://www.quirksmode.org/js/events_properties.html)

[http://www.javascriptkit.com/jsref/event.shtml](http://www.javascriptkit.com/jsref/event.shtml)

[http://www.quirksmode.org/dom/events/index.html](http://www.quirksmode.org/dom/events/index.html)

[http://www.w3.org/TR/DOM-Level-3-Events/#event-types-list](http://www.w3.org/TR/DOM-Level-3-Events/#event-types-list)

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2016-09-22T22:26:09.483

> *免责声明：*这是对这篇特定帖子的非常晚的回复，但是当我一直在阅读对这个问题的各种回复时，我感到震惊的是，大多数答案都使用了只有经验丰富的编码人员才能理解的术语。这个答案试图以新手观众的身份来解决原始问题。

### 介绍

小 ' *(e)* ' 东西实际上是 Javascript 中称为事件处理函数的更广泛范围的一部分。每个事件处理函数都接收一个事件对象。出于本次讨论的目的，将对象视为拥有一堆属性（*变量*）和方法（*函数*）的“事物”，就像其他语言中的对象一样。句柄，即小*(e)中的“* *e* ” ，就像一个允许您与对象交互的变量（我非常宽松地使用术语*变量）。*

 **考虑以下 jQuery 示例：

```
$("#someLink").on("click", function(e){ // My preferred method
    e.preventDefault();
});

$("#someLink").click(function(e){ // Some use this method too
    e.preventDefault();
}); 
```

### 解释

*   "#someLink" 是您的元素选择器（哪个 HTML 标记会触发它）。
*   “单击”是一个事件（当单击选定的元素时）。
*   “function(e)”是事件处理函数（在事件中，对象被创建）。
*   “e”是对象处理程序（对象可访问）。
*   “preventDefault()”是对象提供的方法（函数）。

***发生了什么？***
当用户单击 id 为*“#someLink”*（可能是锚标记）的元素时，调用匿名函数*“function(e)”*，并将生成的对象分配给处理程序*“e”*。现在使用该处理程序并调用其方法之一*“e.preventDefault()”*，这应该会阻止浏览器对该元素执行默认操作。

***注意：***句柄几乎可以命名为您想要的任何名称（即“ *function(billybob)* ”）。'e' 代表 'event'，这对于这种类型的功能来说似乎是相当标准的。

尽管 'e.preventDefault()' 可能是事件处理程序最常见的用法，但对象本身包含许多可以通过事件处理程序访问的属性和方法。

可以在 jQuery 的学习站点[http://learn.jquery.com](http://learn.jquery.com)上找到有关该主题的一些非常好的信息。请特别注意[使用 jQuery Core](http://learn.jquery.com/using-jquery-core/)和[事件](http://learn.jquery.com/events/)部分。

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2012-04-25T20:45:09.677

`e`没有任何特殊意义。当`e`参数为`event`.

有可能

```
$(this).click(function(loremipsumdolorsitamet) {
    // does something
} 
```

也是。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-04-25T20:44:38.030

在该示例中，`e`它只是该函数的一个参数，但它是`event`通过它传入的对象。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-04-25T20:47:22.320

该`e`参数是事件对象的缩写。例如，您可能希望为取消默认操作的锚创建代码。为此，您将编写如下内容：

```
$('a').click(function(e) {
    e.preventDefault();
} 
```

这意味着当一个`<a>`标签被点击时，阻止点击事件的默认动作。

尽管您可能经常看到它，但即使您已将其指定为参数，也不必在函数中使用它。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2015-10-28T17:39:00.333

在 jQuery中，是当前事件对象的`e`缩写。`event`它通常作为要触发的事件函数的参数传递。

演示：[jQuery 事件](http://codepen.io/Gothburz/pen/jbxxao/)

在我使用的演示中`e`

```
$("img").on("click dblclick mouseover mouseout",function(e){
        $("h1").html("Event: " + e.type);
}); 
```

我也可能用过`event`

```
 $("img").on("click dblclick mouseover mouseout",function(event){
            $("h1").html("Event: " + event.type);
    }); 
```

一样！

程序员很懒，我们使用了很多速记，部分减少了我们的工作，部分有助于提高可读性。理解这一点将有助于你理解编写代码的心态。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2017-04-19T09:32:49.397

今天我刚刚写了一篇关于“为什么我们在 e.preventDefault() 中使用“e”之类的字母？我认为我的回答会有些道理...

首先，让我们看看 addEventListener 的语法

通常它将是： **target.addEventListener(type, listener[, useCapture]);**

而addEventlistener的参数**定义为：**

> **type**：表示要监听的事件类型的字符串。
> 
> **listener**：当指定类型的事件发生时接收通知的对象（实现Event接口的对象）。这必须是实现 EventListener 接口的对象或 JavaScript 函数。

（来自 MDN）

**但我觉得有一点需要说明：** 当你使用Javascript函数作为监听器时，实现Event接口的对象（对象事件）会自动赋值给函数的**“第一个参数”**。所以，如果你使用function(e) ，对象将被分配给“e”，因为“e”是函数的唯一参数（绝对是第一个参数！），那么你可以使用 e.preventDefault 来防止某些事情....

让我们试试下面的例子：

```
<p>Please click on the checkbox control.</p>
<form>
    <label for="id-checkbox">Checkbox</label>
    <input type="checkbox" id="id-checkbox"/>

    </div>
</form>
<script>
    document.querySelector("#id-checkbox").addEventListener("click", function(e,v){
         //var e=3;
         var v=5;
         var t=e+v;
         console.log(t);
        e.preventDefault();

    }, false);
</script> 
```

结果将是：**[object MouseEvent]5**，您将阻止点击事件。

但是如果您删除评论标志，例如：

```
<script>
       document.querySelector("#id-checkbox").addEventListener("click", function(e,v){
            var e=3;
            var v=5;
            var t=e+v;
            console.log(t);
            e.preventDefault();

       }, false);
   </script> 
```

你会得到：**8**和一个**错误**：“Uncaught TypeError: e.preventDefault is not a function at HTMLInputElement. (VM409:69)”。

当然，这次不会阻止点击事件。因为在函数中再次定义了“e”。

但是，如果您将代码更改为：

```
<script>
       document.querySelector("#id-checkbox").addEventListener("click", function(e,v){
            var e=3;
            var v=5;
            var t=e+v;
            console.log(t);
            event.preventDefault();

       }, false);
   </script> 
```

每件事都会再次正常工作......你会得到**8并且点击事件被阻止**......

因此，“e”只是您的函数的一个参数，您需要在 function() 中使用“e”来接收“事件对象”，然后执行 e.preventDefault()。这也是为什么你可以将“e”更改为任何不被js保留的单词的原因。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-04-25T20:41:27.760

它是对当前事件对象的引用

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2019-08-08T12:35:23.893

```
$(this).click(function(e) {
    // does something
}); 
```

参考上面的代码
`$(this)`是作为一些变量的元素。
`click`是需要执行的事件。
该参数`e`会自动从 js 传递给您的函数，该函数保存 value 的`$(this)`值，并且可以在您的代码中进一步使用以执行某些操作。**

# scala - 演员模型是否仅限于特定语言？

> ID：10323393
> 
> 赞同：9
> 
> 时间：2012-04-25T20:39:43.617
> 
> 标签：scala, architecture, erlang, actor

我正在阅读一篇关于 Erlang/OTP 和 actor 模型的[有趣博文。](http://smyck.net/2012/04/22/why-erlang/)我还听说 Scala 支持演员模型。从我目前收集的少量信息来看，actor 模型将处理分解为通过传递消息相互通信的组件。通常，这些过程是不可变的。

这些功能在架构级别是特定于语言还是更多？更具体地说，你不能用几乎任何语言实现相同的actor模型，并且只使用某种形式的消息队列在工作进程之间传递消息吗？（例如，使用像[celery](http://celeryproject.org/)这样的东西）。还是像 Erlang 和 Scala 这样的语言只是透明且[更快](https://stackoverflow.com/q/3358044/305019)地做到这一点？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-25T22:18:40.457

当然，您几乎可以用任何语言定义“Actor Library”，但在 Erlang 中，该模型已融入该语言，并且实际上是唯一可用的并发模型。

尽管 Scala 的 actor 系统实现得很好，但归根结底，它仍然容易受到 Erlang 无法避免的一些危害的影响。我会提请你注意这篇[论文](http://www.hpl.hp.com/techreports/2009/HPL-2009-148.pdf)。

对于以任何支持共享可变状态的命令式语言实现的任何 Actor 库都是如此。

一个有趣的例外是 Nodes.js。正在对节点之间的参与者进行一些工作，这些参与者可能表现出与 Erlang 相同的隔离属性，仅仅是因为没有共享的可变状态。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-25T21:17:50.693

Actor模型**不限**于任何特定的平台或编程语言，它毕竟只是一个模型。

Erlang 和 Scala 对这个模型有非常好的和有用的实现，它非常适合这些平台的典型技术堆栈，并有助于有效地解决某些类型的任务。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-26T14:25:35.627

除了上面提到的几点之外，在 Erlang 中，actor 模型是您可以编程的唯一方式这一事实，使您的代码从一开始就可扩展。Erlang 进程是轻量级的，你可以在一台机器上生成 10-100K（我认为你不能用 python 做到这一点），这改变了你处理问题的方式。例如，在我们的产品中，我们使用 Erlang 解析 Web 服务器日志并生成一个 Erlang 进程来处理每一行。这样，如果一个日志行损坏，或者处理它的进程崩溃，其他日志行不会发生任何事情。另一个区别是，当您开始使用 OTP 时，您将获得流程主管，并且您可以使流程连接起来，因此如果一个终止了其他所有流程。除此之外，Erlang 还有一些其他不错的功能（可以通过库在其他语言中找到，但在这里再次强调）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-26T13:20:17.560

不，Actor 模型没有特定于语言的内容。实际上，您已经在问题中提到了 Scala，其中演员不是语言的一部分，而是作为库实现的。（实际上是三个相互竞争的库。）

然而，就像函数式编程或面向对象编程一样，直接支持 Actor 编程，或者至少支持一些使其更容易实现的抽象，在语言中将导致非常不同的编程体验。任何曾经用 C 语言进行过函数式编程或面向对象编程的人都可能会理解这一点。

# asp.net-mvc - MVC - 有条件地使用基于对象类型的操作

> ID：10323394
> 
> 赞同：1
> 
> 时间：2012-04-25T20:39:43.693
> 
> 标签：asp.net-mvc

我有一个视图，它显示我发送的对象列表中的数据。这些对象都是同一个基类，但可以是许多不同的派生类型。所以我有：

```
class Item { public string Description {get;set;}
class VideoItem : Item { public int VideoId {get;set;} }
class PdfItem : Item { public pdfLocation {get;set;} } 
```

我将这些都显示在一个列表中，并希望能够拥有一个我可以调用的控制器方法来处理其中的每一个。为该方法提供重载也可以。

我将它作为 ActionLink 连接，但我不知道如何将整个对象传递给控制器​​。当我尝试传递类时，它只传递类名（我假设它使用了 .ToString() 方法。

我可以使用某种唯一的 id，然后重新查询数据库并重新创建对象，但似乎如果我已经创建了对象，我应该能够将它完整地传递给控制器​​，不是吗？

也许 ActionLink 不是最好的解决方案。我不在乎控制器是如何被调用的。

想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T20:57:14.750

像这样的东西可以为您工作（假设您想将每个项目的内容显示为链接）：

创建一个自定义 HtmlHelper 方法：

```
public static class LinkExtensions
{
    public static MvcHtmlString CustomActionLink(this HtmlHelper htmlHelper, Item item )
    {
        MvcHtmlString returnString = "";

        if(item is VideoItem) 
        {
            VideoItem currentItem = item as VideoItem;
            returnString = htmlHelper.ActionLink(currentItem.VideoId, "Video", "Item");
        }        
        if(item is PdfItem) 
        {
            PdfItem currentItem = item as PdfItem;
            returnString = htmlHelper.ActionLink(currentItem.pdfLocation, "Pdf", "Item");
        }
        else
        {
            returnString = htmlHelper.ActionLink(currentItem.Description, "Item", "Item");
        }

        return returnString;
    }
} 
```

像这样使用它（假设 itemList 是一个`List<Item>`类型列表）：

```
<%= foreach(var item in itemList) { Html.CustomActionLink(item) } %> 
```

注意：我没有运行此代码，因此可能需要进行一些调整。

# android - 我认为我的 aboutButton 中的 NullPointerException

> ID：10323399
> 
> 赞同：0
> 
> 时间：2012-04-25T20:39:55.973
> 
> 标签：android

我的第二本书 Android 编程你好，Android，作者 Ed Burnette。我正在使用日食。该代码与本书匹配，并且与从本书网站下载的代码匹配。但我知道我在这里做错了什么。我添加了一堆断点，我认为（主要是猜测）问题可能发生在哪里。我得到的是这行代码是罪魁祸首（SudokuActivity.java 第 21 行）您可以在此处下载整个代码 [http://kbsoftware.dlinkddns.com/Sudoku.zip](http://kbsoftware.dlinkddns.com/Sudoku.zip)

aboutButton.setOnClickListener(this);

但我就是不知道为什么？这一定是我在其他地方做错了什么的结果。我已经删除并重新创建了 avd 并没有什么区别，所以不是。我在这里迷路了。

```
public class SudokuActivity extends Activity implements OnClickListener {
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    View aboutButton = findViewById(R.id.about_button);
    aboutButton.setOnClickListener(this);
} 
```

我要感谢所有回复的人，一切都已修复且正常工作，如果没有您的帮助，我无法做到。我在这个问题上学到了更多的知识，然后我会在几周内（如果不是几个月的话）无问题的编程。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T20:43:32.963

Yout aboutButton 没有正确绑定。

做类似的事情

按钮 aboutButton = (Button) findViewById(R.id.about_button);

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T21:40:21.507

我下载了你的代码，它在我的手机上运行正常。因此，如果您的代码相同，它应该运行。似乎 findViewById 没有找到视图，然后在空对象上调用方法导致空指针异常。

我的愚蠢问题：您是否尝试过清理项目？您甚至可以尝试保存您的课程、删除项目并创建一个新项目。希望能帮助到你

# javascript - 中键 JS 功能

> ID：10323400
> 
> 赞同：3
> 
> 时间：2012-04-25T20:39:56.997
> 
> 标签：javascript, jquery, html, href, sprite-sheet

我正在处理的网站上有一个按钮，它使用精灵表动画，因此需要设置为背景图像。我需要定期单击按钮以将重定向到另一个页面延迟几分之一秒才能播放动画，但是我仍然希望鼠标中键能够在新选项卡中打开，没有延迟。

目前我有这个在 Javascript 中工作，但对于所有事情都以这种方式处理而不只是有一个 href 似乎是一个非常糟糕的主意。

所以我做了这个：

```
 <script type="text/javascript">

    function delayed(){
    window.stop();
    setTimeout('window.location = "http://www.dog.com";', 800);}

    </script>

<a href="http://www.google.com" onclick="delayed();return false">I am a link</a> 
```

这个想法是常规单击会触发该功能并导致延迟，而鼠标中键单击将直接转到 href 链接。

这适用于 Firefox。然而，在 Chrome 和 Safari 中，中间点击会触发该功能，结果会在同一窗口中打开狗链接（在完成的版本中，链接当然是相同的）。

基本上我只需要一个在点击时延迟但在中间点击时仍能正常工作的href。我的工作解决方案使用 Javascript 在中键单击时在新选项卡中打开，但令我震惊的是，这可能会覆盖浏览器设置，这可能是一个坏主意。

编辑：

与此同时，我使用 Jquery 找到了这个解决方案：

```
$(document).ready(function() {
      $(".delayed").click(function() {
        var href = $(this).attr('href');
        setTimeout(function() {window.location = href}, 800);
        return false;
    });
}); 
```

...和 ​​HTML：

```
<a href="http://www.google.com/" class='delayed'></a> 
```

这可行，但遇到了与 Chrome 将中键单击视为左键单击并因此在同一窗口中打开它的问题相同的问题。

我现在已经对其进行了修改，以包含来自 sransara 的内容，以便……我认为……一切都已解决。再次使用 Jquery：

```
$(document).ready(function() {
      $(".delayed").click(function(event) {
          var href = $(this).attr('href');
          if(event.button == 0){
        event.preventDefault ? event.preventDefault():event.returnValue = false;
        setTimeout(function() {window.location = href}, 800);    
         }
    });
}); 
```

似乎适用于所有浏览器。希望这些可以对将来偶然发现此页面的任何人有用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T00:36:58.630

这只是一个快速的解决方案，但我认为它最适合您的需求。

标签代码`HTML anchor`：

```
<a href="http://www.google.com" onclick="delayed(event);">I am a link</a> 
```

这是Javascript：

```
function delayed(event){
    window.stop();
    if(event.button == 0){
        event.preventDefault ? event.preventDefault():event.returnValue = false;
        setTimeout(function(){ window.location = "http://www.yahoo.com"; }, 800);

    }
} 
```

有几个简单的变化：

*   我已经**删除**了`return false`from`onclick`事件，但是新的代码行会`event.preventDefault ? event.preventDefault():event.returnValue = false;`阻止[单击](https://stackoverflow.com/questions/1000597/event-preventdefault-function-not-working-in-ie-any-help)左键时的默认操作。
*   并在 Javascript 中**添加**了一个[按钮代码检查。](https://developer.mozilla.org/en/DOM/event.button)

工作演示代码在[这里](http://jsfiddle.net/dvkT3/1/)。

这是一个快速的解决方案，需要改进的地方是：取出内联`onclick`事件并使用 JS 动态添加事件侦听器。

# java - 网球锦标赛算法

> ID：10323403
> 
> 赞同：15
> 
> 时间：2012-04-25T20:40:11.930
> 
> 标签：java, algorithm

网球比赛结束后，每个球员都被问到他有多少场比赛。一名运动员不能与另一名运动员进行多于一场比赛。作为输入，您唯一拥有的是运动员人数和每位运动员参加的比赛。作为输出，如果可以根据运动员的回答完成比赛，则为 1，否则为 0。例如：

```
Input: 4 3 3 3 3      Output: 1  
Input: 6 2 4 5 5 2 1  Output: 0  
Input: 2 1 1          Output: 1  
Input: 1 0            Output: 0  
Input: 3 1 1 1        Output: 0  
Input: 3 2 2 0        Output: 0  
Input: 3 4 3 2        Output: 0 
```

输入的第一个数字不是运动员答案的一部分，它是参加比赛的运动员人数，例如在 6 2 4 5 5 2 1 我们有 6 名运动员参加，他们的答案是 2 4 5 5 2 1.

到目前为止，这是我们写的，但效果不是很好：

```
import java.util.Scanner;
import java.util.Arrays;

public class Tennis {

    public static void main(String[] args) {
        Scanner input = new Scanner(System.in);

        String N;
        int count;
        int sum = 0;
        int max;
        int activeAthletes;
        int flag;

        System.out.printf("Give: ");
        N = input.nextLine();

        String[] arr = N.split(" ");
        int[] array = new int[arr.length];

        for (count = 0; count < arr.length; count++) {
            array[count] = Integer.parseInt(arr[count]);
            //System.out.print(arr[count] + " ");
        }

        for (count = 1; count < arr.length; count++) {
            sum += array[count];
        }
        //System.out.println("\n" + sum);

        activeAthletes = array[0];

        for (count = 1; count < array.length; count++) {
            if (array[count] == 0) {
                activeAthletes--;
            }
        }

        max = array[1];
        for (count = 2; count < array.length; count++) {
            if (array[count] > max) {
                max = array[count];
            }
        }
       // System.out.println(max);

        if ((sum % 2 == 0) && (max < activeAthletes)) {            
            flag = 1;
        } else{
            flag = 0;
        }

        System.out.println(flag);
    }
} 
```

我不想要一个直接的解决方案，也许只是一些提示和提示，因为我们真的不知道还能做什么，我重复一遍，即使我会把它标记为家庭作业（因为我觉得版主会再次关闭它）它不是，这只是我兄弟发现的问题，我们正在努力解决。

好吧，你们中的许多人已经回答了，我真的很感激，但是因为我明天有工作，所以我需要睡觉，所以我明天可能会阅读其余的答案，看看有什么用

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-25T21:40:48.320

不确定它是否100％有效，我会喜欢：

1.  排序输入
2.  对于数组中从右到左的每个元素（从大到小）

    *   基于索引 i 处元素的值 n 将 n 左元素减 1
    *   如果由于到达列表末尾或值 0 而不能减少，则返回失败
3.  返回成功。

这种逻辑（如果正确）可以导致对 O(N*log(N)) 解决方案进行一些修改，但我目前认为这对于新手程序员来说太过分了。

**编辑：**

这在输入2 2 1 1上不起作用

然后所有步骤（没有排序）：

1.  而列表 L 中的任何元素都不为 0：

    *   在列表 L 中找到最大元素 N
    *   如果值 >= 1，则将列表 L 中的 N 个其他值减少 1（不减少此最大元素）
        *   如果在这一步失败，则返回失败
    *   将此元素 N 设置为 0
2.  返回确定

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-25T20:50:11.017

这里有一个提示。回答这些问题

1.  给定 N 名运动员，最多可以参加多少场比赛？
2.  给定运动员 X，他最多可以做多少场比赛？
3.  这足以检查这些吗？如果您不确定，请尝试编写一个程序来生成所有可能的玩家匹配，并检查是否至少有一个满足输入。这仅适用于少数运动员，但这是一项很好的锻炼。或者只是手工完成

问这个问题的另一种方法是，我们能否创建一个由 1 和 0 组成的对称矩阵，其行的值相等。这将是“谁扮演谁”的表格。把它想象成一个 N×N 网格，其中 grid[i][j] = grid[j][i] （如果你扮演某人，他们扮演你）和 grid[i][i] = 0 （没有人扮演自己）

例如

```
Input: 4 3 3 3 3 Output: 1 
```

好像

```
 0 1 1 1
 1 0 1 1
 1 1 0 1
 1 1 1 0 
```

但是，我们不能用这个来做到这一点：输入：3 2 2 0 输出：0

***编辑***

这相当于这个（来自[度（图论）](https://en.wikipedia.org/wiki/Degree_%28graph_theory%29)）

> Hakimi (1962) 证明*(d1, d2, ..., dn)*是简单图的度数序列当且仅当*(d2 − 1, d3 − 1, ..., dd1+1 − 1, dd1+ 2, dd1+3, ..., dn)*是。这一事实导致了一种简单的算法，用于找到具有给定可实现度数序列的简单图：
> 
> 1.  从没有边的图开始。
> 2.  按照剩余度要求的非递增顺序维护其度要求尚未满足的顶点列表。
> 3.  将第一个顶点连接到此列表中的下一个*d1*顶点，然后将其从列表中删除。重新排序列表并重复，直到满足所有学位要求。
> 
> 查找或估计具有给定度数序列的图数的问题是[图枚举](https://en.wikipedia.org/wiki/Graph_enumeration)领域的问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-25T20:54:30.017

也许您可以获取运动员的比赛数量数组，并确定其中的最大数量。

然后看看您是否可以将该数字拆分为 1，并从数组的其他几个成员中减去这些 1。

将最大数量的数组成员清零，并将其从数组中删除，并使用减少的值更新其他成员。

现在，重复这个过程——确定新的最大数，然后从数组的其他成员中减去它。

如果在任何时候没有足够的数组成员从中减去 1，则让应用程序返回 0。否则继续执行此操作，直到数组中没有更多成员，此时您可以让应用程序返回 1。

此外，请记住删除减少到零的数组成员。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-25T20:57:17.920

编辑：下面的解决方案将一些无效输入传递为有效。这是检查明确否定的快速方法，但它允许误报。

* * *

以下是数学家的建议：

1.  匹配数的总和必须是偶数。`3 3 4 2 1`总和为`13`，这意味着有人与自己进行了一场比赛。
2.  对于`n`球员来说，如果每场比赛都淘汰了一名球员，则至少`n-1`必须进行不同的比赛。（淘汰赛。）要查看这一点，请为 2、4、8、16、32... 名玩家绘制比赛树，需要 1、3、7、31... 场比赛来决定获胜者。
3.  对于`n`玩家来说，如果每个人都玩一次，假设没有重复比赛，则最大比赛次数是`n choose 2`，或`(n!)/(2!)(n-2)!`（循环赛）。`n!`是阶乘函数，`n! = n * n-1 * n-2 * ... * 3 * 2 * 1.`。

所以标准是：

1.  匹配数的总和必须是偶数。
2.  匹配数的总和必须至少为`2n-2`。（注意乘以 2 - 每场比赛都会导致**双方**玩家的计数都增加 1。）
3.  匹配数的总和最多为`2 * n choose 2`。
4.  [编辑] 每个玩家必须至少参加一场比赛。

如果您的比赛是淘汰赛和循环赛之间的交叉，您可能会有介于`n-1`和`n choose 2`比赛之间的地方。

编辑：

如果任何球员的比赛超过了`n-1`比赛，他们至少与某人比赛了两次。

如果您的锦标赛是淘汰赛，以便每个玩家参加尽可能少的比赛，那么每个玩家最多可以参加大约2`log_2(n)`场比赛（以`log`2 为基础并向上取整。）在 16 名玩家的锦标赛中，最多 4火柴。在 1024 名玩家的比赛中，最多 10 场比赛。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-25T21:42:53.620

您的示例都可以通过计算匹配项并查看它们是否除以 2 来轻松解决。

您的示例未涵盖的问题是一个玩家，他的游戏比其他玩家的总和多：

*   输入：4 5 1 1 1 输出：0

如果我们添加更多玩家，这可能会很复杂：

*   输入：6 5 5 5 1 1 1 输出：0

如何解决这个问题？好吧，从最大和最小玩家中成对删除一个游戏，看看会发生什么：

*   输入：6 5 5 5 1 1 1
*   输入： 5 5 5 4 1 1 -
*   输入：4 5 4 4 1 - -
*   输入： 3 4 4 4 - - -

它违反了规则：

> 一名运动员不能与另一名运动员进行多于一场比赛。

如果剩下 3 名玩家，他们每人的比赛不能超过 2 场。

# c - 为什么这个hostent会导致段错误？

> ID：10323412
> 
> 赞同：0
> 
> 时间：2012-04-25T20:40:36.840
> 
> 标签：c, network-programming, hostent

```
struct hostent *hostName;

struct in_addr ipv4addr;

inet_pton(AF_INET, inet_ntoa(client.sin_addr), &ipv4addr);

hostName = gethostbyaddr(&ipv4addr, sizeof(ipv4addr), AF_INET);

printf("Host name: %s\n", hostName->h_name); 
```

它在最后一行出现段错误。我查找了 hostent 的正确使用方法，msdn 文档显示它完全像这样使用。什么会导致段错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T20:43:31.400

该`gethostbyaddr()`函数`NULL`在发生错误时返回，我没有看到您在代码中检查它。尝试取消引用`NULL`指针会导致段错误。

你需要类似的东西：

```
if (hostName == NULL) {
  printf("There was an error!\n");
  exit(1);
} 
```

您可以使用该`herror()`函数打印出解析器遇到的实际错误（尽管手册页表明该错误`herror()`已过时）。

# sql-server - JPA 和 SQL Server 列加密

> ID：10323418
> 
> 赞同：0
> 
> 时间：2012-04-25T20:40:50.397
> 
> 标签：sql-server, jpa, websphere

我正在使用 WebSphere 7 和他们的基于 OpenJPA 的 JPA 2.0 实现，我有一些东西让我发疯。我必须连接到使用数据库列加密的 SQL Server 2008 数据库。加密由几个数据库命令完成：

1 - 通过认证打开对称密钥解密

2 - 使用数据库方法 EncryptByKey 或 DecryptByKey 执行插入/选择/更新/等

3 - 关闭对称键

我已经搜索过，OpenJPA 似乎不支持此功能。有人知道如何让 OpenJPA 与这种类型的加密很好地配合使用吗？或者我应该跳过这个项目的 JPA 并使用老式的 PreparedStatements？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T13:40:29.090

所以，是的，看起来做本机查询是唯一的方法。所以结果是这样的：

```
EntityManager em = getEntityManager();
Query openKey = em.createNativeQuery("OPEN SYMMETRIC KEY MY_KEY  DECRYPTION BY CERTIFICATE MY_CERT");
openKey.executeUpdate();

Query query = em.createNativeQuery("SELECT FIRSTNAME, LASTNAME, CONVERT(varchar, DECRYPTBYKEY(SSN)) as SSN from report where record_id = ?", Report.class);
query.setParameter(1, recordId);
report = (Report) query.getSingleResult();

Query closeKey = em.createNativeQuery("CLOSE SYMMETRIC KEY MY_KEY");
closeKey.executeUpdate(); 
```

# haskell - GHC 有类似 distcc 的工具吗？

> ID：10323419
> 
> 赞同：6
> 
> 时间：2012-04-25T20:40:51.680
> 
> 标签：haskell, ghc, cabal, distcc

有没有类似 distcc 的 GHC 工具？或者其他更原始的分布式编译技巧？

我意识到 GHC 对版本非常敏感。[由于GHC 还不支持交叉编译，](http://hackage.haskell.org/trac/ghc/wiki/CrossCompilation)这不切实际吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-25T20:48:47.240

过去，我配置了 distcc 以调用 GHC 作为其编译器——这在异构集群环境（通过 ssh）中运行良好。我不知道任何其他机制。

# c - 为 x86-64 预取数据以缓存

> ID：10323420
> 
> 赞同：16
> 
> 时间：2012-04-25T20:40:54.693
> 
> 标签：c, linux, caching, x86-64, prefetch

在我的应用程序中，有一次我需要对一大块连续的内存数据（100 MB）执行计算。我的想法是继续预取我的程序将来会触及的块的一部分，这样当我对该部分执行计算时，数据已经在缓存中。

有人可以给我一个简单的例子来说明如何用 gcc 实现这一点吗？我在某处读过`_mm_prefetch`，但不知道如何正确使用它。另请注意，我有一个多核系统，但每个核心将并行处理不同的内存区域。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-25T21:05:35.697

`gcc`使用内置函数作为低级指令的接口。特别是对于您的情况[`__builtin_prefetch`](http://gcc.gnu.org/onlinedocs/gcc-4.7.0/gcc/Other-Builtins.html#Other-Builtins)。但是，只有在访问模式不容易自动预测的情况下，您才应该看到可测量的差异。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-04-25T20:45:41.277

现代 CPU 具有非常好的自动预取功能，如果您尝试启动软件预取，您可能会发现弊大于利。如果您发现自己确实存在性能问题，则很可能还有更多“低悬的果实”可供您专注于优化。当您迫切需要更多百分比的吞吐量时，预取往往是您可能尝试的最后一件事。

# git - 在网络视图中与 master 在同一行上的分支

> ID：10323429
> 
> 赞同：1
> 
> 时间：2012-04-25T20:41:35.450
> 
> 标签：git, github, git-branch

我在使用 github 时遇到了一个小问题。我主要尝试使用分支，并在我有工作时立即将代码合并回主控中。

问题是，我在 github 的网络视图中的所有分支都显示在同一行，这使得它完全没用。 [https://github.com/jlengrand/FaceMovie/network](https://github.com/jlengrand/FaceMovie/network)

你能解释一下原因吗？

在本地创建分支时，它不会自动显示在 github 中。当我执行

```
git push -u origin master 
```

它穿鞋，但与主人在同一条线上。

让我感到困惑的是，在我的其他项目中，我没有这个问题，我真的不知道我做了什么不同的事情。 [https://github.com/jlengrand/FaceMovie/network](https://github.com/jlengrand/FaceMovie/network)

任何帮助将非常感激 ！

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T20:45:36.993

如果您将一个分支合并回 master 并且自从您创建分支以来没有在 master 上发生任何提交，它不会创建合并提交（即具有两个父级的提交），而是将 master 分支快速转发到另一个。

为防止这种情况，`--no-ff`请在合并时使用选项。这将强制合并提交。

# asp.net - ASP.NET Comet 方法与 WCF 回调

> ID：10323430
> 
> 赞同：0
> 
> 时间：2012-04-25T20:41:54.807
> 
> 标签：asp.net, comet, wcf-callbacks

我想/必须在我的网络应用程序中实现聊天（如 Facebook）。通过我的研究，我发现了两种不同的方法，但我不知道我应该采取哪种方法（老实说，我尝试了一种，但它有一种奇怪的行为，但让我稍后再谈）。

关于我的申请的一些事实。它有两个不同的客户。一个是 Web 应用程序，另一个是 wpf 客户端。这两个客户端都应该实现了聊天。它们通过 WCF 服务通过服务器进行通信。

因此，正如我发现的那样，彗星方法意味着 AJAX 长轮询。另一方面，我可以使用 WCF 回调服务。

WCF 回调/彗星方法有什么缺点/优点吗？

对我来说，回调方法非常简单，ajax long pooling 听起来要复杂得多。

谢谢你提前

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T15:40:04.737

[我会为您提供通过PokeIn](http://pokein.com)尝试 Reverse Ajax并从内置的[WebSocket](http://www.pokein.com/Help/WebSocketFeature.aspx)功能中受益。你不需要其他任何东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T23:06:14.633

由于您正在研究 MS 技术，因此您可能会对阅读 Brian Raymor 的这篇文章感兴趣，他是 Microsoft Windows 网络组的高级项目经理。

*   [WebSockets：稳定且为开发人员准备就绪](http://www.sitepoint.com/websockets-stable-and-ready-for-developers/)

[SignalR](https://github.com/SignalR/SignalR)是一个很好的解决方案，因为它会选择适合正在建立连接的 Web 浏览器的传输类型。在 Windows Server 8 之前，它不能与 IIS 一起使用。

您的其他选项是[XSockets](http://xsockets.net)、[SuperWebSocket](http://superwebsocket.codeplex.com/)等等。请参阅此[实时网络技术指南](http://www.leggetter.co.uk/real-time-web-technologies-guide)（免责声明：我维护）

您还可以查看托管服务。同样，我在上面提供了链接的指南中提供了一些选项。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-25T20:47:53.197

我至少会检查 Web 应用程序端的 SignalR [http://geekswithblogs.net/jeroenb/archive/2011/12/14/signalr-starter-application.aspx](http://geekswithblogs.net/jeroenb/archive/2011/12/14/signalr-starter-application.aspx)

# php - Cakephp 错误：调用非对象上的成员函数 find()

> ID：10323435
> 
> 赞同：0
> 
> 时间：2012-04-25T20:42:14.327
> 
> 标签：php, cakephp-1.3

我的代码有问题。当我尝试调试我的 Web 应用程序时，我收到以下错误消息......调用非对象上的成员函数 find()......这是我的代码

类 TeamsController 扩展 AppController {

```
var $name = 'Teams';

function index() {
$this->set('teams', $this->team->find('all'));

}

function Welcome() {

} 
```

}

我正在尝试显示我的 MySQL 数据库中的记录。话虽如此，我完成了本教程，并按照说明一直到发球台......但不知何故我的代码有错误。我的代码和我所做的教程代码之间的唯一区别是变量名称......和控制器名称......而且我没有 hello world 函数......这是来自的代码示例我做过的教程......

类 PostsController 扩展 AppController {

```
var $name = 'Posts';

function index() {
    $this->set('posts', $this->Post->find('all'));
}

function hello_world() {

} 
```

}

话虽如此，我是否应该声明一个对象的实例以使其正常工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T21:04:12.017

这可能是区分大小写的问题：

```
function index() {
    $this->set('teams', $this->Team->find('all'));
} 
```

如果没有，请确保您的控制器可以访问*Teams*模型（例如`$uses`）。

# c++ - 打印浮点值时的问题

> ID：10323437
> 
> 赞同：1
> 
> 时间：2012-04-25T20:42:24.983
> 
> 标签：c++, c, printf

```
#include<stdio.h>
#include<math.h> 
int main()
{
   float i = 2.5;
   printf("%d\n%d\n%d",i,i,i);
} 
```

当我使用 gcc 编译并运行它时，我得到它作为输出：

```
0
1074003968
0 
```

为什么它不打印

```
2
2
2 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-25T20:46:11.517

您将 a `float`（将转换为 a `double`）传递给`printf`，但告诉`printf`期望 a `int`。结果是未定义的行为，因此至少在理论上，任何事情都可能发生。

*通常*会发生的是从堆栈中`printf`检索`sizeof(int)`字节，并将它们保存的任何位模式解释为`int`，并打印出碰巧表示的任何值。

您几乎可以肯定想要的是在将其传递`float`给`int`之前将其转换为`printf`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T20:44:37.090

格式说明`"%d"`符用于十进制整数。改为使用`"%f"`。

并花点时间阅读[`printf()`手册页](http://linux.die.net/man/3/printf)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T20:57:18.360

“%d”是十进制整数（通常是 32 位整数）的说明符，而“%f”说明符用于十进制浮点。（通常是双精度或浮点数）。

如果您只想要浮点数的非小数部分，您可以将精度指定为 0。

IE

```
float i = 2.5;
printf("%.0f\n%.0f\n%.0f",i,i,i); 
```

请注意，您还可以将每个值强制转换为 int，它会给出相同的结果。

```
printf("%d\n%d\n%d",int(i),int(i),int(i)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-25T20:45:48.403

`%d`打印十进制`(int)`s，而不是`(float)`s。 `printf()`无法判断您是否将 a 传递`(float)`给它（C 没有本机对象；您不能询问值它是什么类型）；您需要为您传递的类型使用适当的格式字符。

# php - MySQL 语句中的语法错误

> ID：10323441
> 
> 赞同：-3
> 
> 时间：2012-04-25T20:42:31.760
> 
> 标签：php, mysql, syntax-error

编辑：我知道错误就在这里：

```
$connection = @mysql_connect($server, $dbusername, $dbpassword) or die(mysql_error());

$db = @mysql_select_db($db_name,$connection) or die(mysql_error());

$sql = "SELECT * FROM authorize WHERE username = '$_SESSION[user_name]' and password = '$_SESSION[password]'";

$result = @mysql_query($sql, $connection) or die(mysql_error());

$num = mysql_num_rows($result);

$lstbalance = 0;
$balance = 0;

//set session variables if there is a match
if ($num != 0) 
{
    while ($sql = mysql_fetch_object($result)) 
    {
    $lstbalance = $sql -> lostbalance;
    $balance = $sql -> balance;
    }
}

if ($win==true) 
{
$sql = "update users set lostbalance='($lstbalance+(($payouts[$result1.\'|\'.$result2.\'|\'.$result3])*(int)$_POST[\'bet\']))' WHERE username = '$_SESSION[user_name]' and password = '$_SESSION[password]'";
}
else
{
$sql = "update users set lostbalance='(lstbalance-(int)$_POST[\'bet\'])' WHERE username = '$_SESSION[user_name]' and password = '$_SESSION[password]'";
}
$result = @mysql_query($sql, $connection) or die(mysql_error()); 
```

* * *

我能够将错误缩小到这段代码，感谢帮助。问候。

当我将其注释掉时，一切似乎都正常工作，所有连接变量都来自不同的文件并且是有效的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T20:51:29.970

```
$lostbalance = $lstbalance+(($payouts[$result1])*(int)$_POST['bet']));
$sql = "update users set lostbalance='$lostbalance' WHERE username = '".$_SESSION['user_name']."' and password = '".$_SESSION['password']."'"; 
```

我不了解您在 $payout[$result1.\'|\'.$result2.\'|\'.$result3] 上的代码

# php - 您如何标记/突出显示文本/字母，就像在 word 或 PDF 文件中一样，但现在在 PHP 和 jquery 中？

> ID：10323442
> 
> 赞同：1
> 
> 时间：2012-04-25T20:42:34.430
> 
> 标签：php, jquery, highlight, highlighting

你如何标记文本/字母，就像在 word 或 PDF 文件中一样？

我正在尝试创建一个人们必须标记单词或某些字符的练习。
例如

```
<h3>find the number in this sentence</h3>
<p>I like the movie Moneyball</p> 
```

***解决方案：***

`<h3>find the number in this sentence</h3>`

`I like the movie M`**一**`yball`

*   对于每个练习，您都知道问题、句子和答案。
*   我想要的是，你选择的词的价值
*   *   很好，如果您选择一个单词或一些字母（取决于您松开鼠标按钮的时间），那么背景颜色会变为绿色（下一次，前一个标记将消失并重新开始......

我想到了 jquery --> .selectet() 但是信息太少了，我对此没有任何经验。

欢迎所有帮助，

亲切的问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T20:49:41.140

你可以使用这个[jQuery Selectable](https://github.com/jairajs89/jquery-selectable/blob/master/jquery-selectable.js)插件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T21:33:06.033

我将此视为个人挑战，因为我可以想象很多用途。这是一个[简单的要点，它将所有单词拆分为 dom 元素](https://gist.github.com/2493590)并跟踪它之前和之后的单词。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T20:47:04.133

我个人会将要突出显示的文本包装在跨度标记中，并设置跨度的背景颜色：

```
Your text and the <span class="highlight">text you want to highlight</span> 
```

为了澄清......我会用跨度预先包装“正确”区域并附加一个点击事件，以便您可以检测到它何时被选中。这样您就可以轻松地检测到他们何时点击了正确的位置并从那里开始工作。

如果您想以不同的方式进行操作，您可以设置输入元素的样式，使其看起来像常规文本，然后使用其中的选择信息。您应该能够将值字符串放入内存并使用选择信息来子串出他们选择的部分。

# c# - 将自定义的类似 XAML 的文档解析为 C# 等效文件？（或二进制文件）

> ID：10323445
> 
> 赞同：0
> 
> 时间：2012-04-25T20:43:02.360
> 
> 标签：c#, parsing, xaml, xna

我正在为 Xbox 360 开发一个 XNA 项目。

为此，我构建了一个广泛的 UI 库，所有这些库都有相对位置、数十个控件和类似的东西。

目前来说，所有的设计元素都是在页面类中创建的，这需要大量的代码（想想边距、对齐、标签等）。

所以我在想，难道不应该创建一个文件，例如 XAML 文件，然后使用 C# 将其解析为对象吗？

XNAML 使用这种方法（我认为），所以我知道它一定是可能的，我只是想知道如何。我可以采用逐行手动解析文件并创建每个对象的方法，但考虑到不同对象的数量，我认为这将是非常复杂和讨厌的代码。非常感谢任何输入！

仅供参考，XNAML 已被弃用（我什至认为它从未上线）

# linux - 为tomcat / JKS Keystore转换PKCS12格式的证书

> ID：10323447
> 
> 赞同：3
> 
> 时间：2012-04-25T20:43:12.823
> 
> 标签：linux, tomcat, ssl, webserver

我有来自 GlobalSign Authority 的以下通配符证书文件。

```
root.crt
intermediate.crt
private.key 
```

我想使用上述证书文件配置 tomcat HTTPS。我相信 Tomcat 支持 PKCS12 格式。

如何将这些证书文件转换为 PKSC12 格式？另外我如何将它们导入tomcat密钥库，特别是中间证书？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-26T08:46:16.803

使用 openssl 创建您的 PKCS12 文件

首先使用中间件和 CA 创建一个 intcacerts.pem 文件，一个接一个地粘贴（它们必须是 PEM 格式）。

然后调用 openssl

`openssl pkcs12 -export -in myservercert.pem -inkey private.key -certfile intcacerts.pem -name "aFriendlyName" -out keyandcerts.p12`

（myservercert.pem 是 PEM 中的服务器证书，intcacerts.pem 包含如上所述的中间体和 CA，private.key 是与服务器证书关联的私钥）

openssl pkcs12 的文档在[这里](http://www.openssl.org/docs/apps/pkcs12.html)

要将生成的 PKCS12 转换为 JKS 密钥库，请执行以下操作

`keytool -importkeystore -srckeystore keyandcerts.p12 -srcstoretype PKCS12 -destkeystore myJKS.jks`

# c - 将任何程序转换为语义等价的程序

> ID：10323451
> 
> 赞同：6
> 
> 时间：2012-04-25T20:43:31.933
> 
> 标签：c, performance, optimization, compiler-construction

[我最近在这里](http://research.microsoft.com/en-us/um/people/tball/papers/XmasGift/)发现了这个定理，（在底部）：

`Any program can be transformed into a semantically equivalent program of one procedure containing one switch statement inside a while loop.`

文章接着说：

`A corollary to this theorem is that any program can be rewritten into a program consisting of a single recursive function containing only conditional statements`

我的问题是，这两个定理今天都适用吗？类似地转换程序是否有任何好处？我的意思是说，这样的代码是否经过优化？（虽然递归调用比较慢，我知道）

[我从这里](http://c2.com/cgi/wiki?SwitchStatement)读到，当编译器优化时，switch-cases*几乎总是更快。*这有什么区别吗。?

[PS：我试图从这里](http://en.wikipedia.org/wiki/Compiler_optimization)了解编译器优化

我添加了`c`标签，因为这是我见过的唯一优化的语言。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-25T21:04:08.157

这是真的。图灵机本质上是一个永远重复的符号开关语句，因此它非常直接地基于图灵机计算一切。switch 语句只是一堆条件，因此您可以清楚地将这样的程序编写为仅带有条件的循环。一旦你有了它，从递归中创建循环就很容易了，尽管如果你的语言没有真正的词法作用域，你可能必须传递很多状态变量作为参数。

在实践中几乎没有理由这样做。此类程序的运行速度通常比原始程序慢，并且可能占用更多空间。那么为什么你可能会减慢你的程序，和/或让它的加载图像更大呢？

唯一有意义的地方是如果您打算混淆代码。这种技术通常被用作“控制流混淆”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-25T21:13:57.510

这基本上是编译器将程序翻译成机器代码时发生的情况。机器代码在处理器上运行，处理器在循环中一个接一个地执行指令。程序的复杂结构已经成为内存中数据的一部分。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-25T21:16:02.463

通过 switch 语句的递归循环可用于创建基本虚拟机。如果你的虚拟机是图灵完备的，那么理论上，任何程序*都可以*被重写以在这台机器上工作。

```
int opcode[] {
   PUSH,
   ADD
   ....
};

while (true) {
    switch (*opcode++) {
    case PUSH:
        *stack++ = <var>;
        break;
    case ADD:
        stack[-1] += stack[0];
        --stack;
        break;
     ....
    }
} 
```

当然，为这个虚拟机编写编译器是另一回事。:-)

# c# - C# Web 服务 XmlSerializer 问题

> ID：10323453
> 
> 赞同：0
> 
> 时间：2012-04-25T20:43:41.447
> 
> 标签：c#, web-services, xml-serialization

我有一个 C# Web 服务正在序列化我的简单类：

```
 [Serializable]
    [XmlInclude(typeof(Bitmap))]
    [XmlTypeAttribute(Namespace = "http://tempuri.org/")]
    public class Class1 
    {
        private static Bitmap _myImage = new Bitmap(@"C:\WebApplication1\ClassLibrary1\Untitled.png");

        public Bitmap MyImage
        {
            get { return _myImage; }

            set
            {
                _myImage = value;
            }
        }
    } 
```

这是执行序列化的 asmx.cs 代码：

```
[WebMethod]
public string HelloWorld()
{
    var c = new Class1();
    XmlSerializer serializer = new XmlSerializer(typeof(Class1));

    return XMLSerializer(c);
}

public string XMLSerializer(object pObject)
{
    try
    {
        XmlSerializer xs = new XmlSerializer(pObject.GetType());
        using (StringWriter stream = new StringWriter())
        {
            xs.Serialize(stream, pObject);
            stream.Flush();
            return stream.ToString();
        }
    }
    catch (Exception ex)
    {
        return ex.ToString();
    }

} 
```

看起来很直接。但是，当我尝试对其进行反序列化时，由 XmlSerializer 生成的 XML 正在生成并出错。

```
{"There is an error in XML document (5, 5)."}
{"Parameter is not valid."} 
```

当我尝试将生成的 XML 加载到 IE 中时，出现此错误。

```
Switch from current encoding to specified encoding not supported. Error processing resource 'file:///C:/Users/mhall15/Deskt...

<?xml version="1.0" encoding="utf-16"?> 
```

这是生成的 XML：

```
<?xml version="1.0" encoding="utf-16"?>
<Class1 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <MyImage xmlns="http://tempuri.org/">
    <Palette />
  </MyImage>
</Class1> 
```

有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T20:47:22.543

在序列化过程中，将“encoding="utf-16" 替换为 "encoding="utf-8"" 就可以了。问题的根源 - 我不确定，但我已经多次遇到它，我就是这样处理的。

这就是处理IE问题的方法。

反序列化应该在这些行中。我发布了我通常使用的任意代码：

```
public static object DeserializeFromXML<T>(string _input)
    {
        object _temp = Activator.CreateInstance<T>();
        Type expected_type = _temp.GetType();
        _temp = null;
        XmlSerializer serializer = new XmlSerializer(expected_type);
        StringReader stringWriter = new StringReader(_input);
        object _copy = serializer.Deserialize(stringWriter);
        return _copy;
    } 
```

在上面的示例中，为了可重用性，我使用模板。您应该能够通过说**DeserializeFromXML < Class1 >(_xml_input)**来调用该方法，其中 xml 输入是字符串。这将强制编译器使用给定类的定义来反序列化 XML 输入。这样，您甚至不必更改序列化中的编码。如果这也是您可能知道或可能不知道要反序列化的数据类型的情况，您可以使用策略设计模式，在其中注册 XML 的根类型及其关联的泛型类型。稍后，只要根类型已注册，您就可以引用该注册表并任意反序列化任何 XML 输入。这也是我通常使用的技巧。如果需要更多信息，请告诉我，我会详细解释。

此外，如果您运行的是 IE 9，则 IE 9 的新更新使查看 XML 变得困难。按 F12 - 转到开发人员工具并更改您的浏览器模式以运行 IE 8 而不是 IE 9。

# c# - 子字符串转到字符串结尾

> ID：10323461
> 
> 赞同：14
> 
> 时间：2012-04-25T20:43:52.610
> 
> 标签：c#

我试图让一个子字符串从字符串的开头到某个位置，另一个子字符串从最后一个位置的结尾到字符串的结尾。但不知道结局会怎样。它将是多个长度。有没有办法直接到字符串的末尾而不给出特定的字符位置，如下所示？

```
StartVariable.Substring(0, 14)
EndVariable.Substring(15, Substring.Length) 
```

谢谢！

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-04-25T20:45:35.943

只需使用`EndVariable.Substring(15)`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-25T20:57:36.073

怎么样：

```
string start = input.Remove(15);
string end = input.Substring(15); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-02-28T16:13:26.423

我认为应该是这样的：

```
EndVariable.Substring(14); 
```

# android - 操作栏外的下拉微调器？（冰淇淋三明治风格，带 ActionBarSherlock）

> ID：10323471
> 
> 赞同：12
> 
> 时间：2012-04-25T20:44:35.757
> 
> 标签：android, android-actionbar, actionbarsherlock, android-theme

有没有办法为 Android 2.3.3 创建下拉微调器？我正在使用 ActionbarSherlock。

这是我的意思的一个例子：

![在此处输入图像描述](../Images/49794179c3b4c9251fa4f587671700ed.png)

谢谢

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-04-25T21:17:59.917

就目前而言，你很幸运。它可以使用 ActionBarSherlock 完成，并且适用于 4.0 之前的版本。但是，我不能 100% 确定 Jake Wharton 会希望我们这样使用它，因为它不完全是“公共 api”，AFAIK（我本来想问的）。无论如何，您必须首先创建自己的类来扩展 ActionBarSherlock 类：

```
public class MyIcsSpinner extends IcsSpinner {

  public MyIcsSpinner(Context context, AttributeSet attrs) {
    super(context, attrs, com.actionbarsherlock.R.attr.actionDropDownStyle);

  }

  public MyIcsSpinner(Context context, AttributeSet attrs, int defStyle) {
    super(context, attrs, defStyle);

  }
} 
```

要将其包含在布局中：

```
<com.blah.blah.blah.MyIcsSpinner
    android:layout_width="wrap_content"
    android:layout_height="fill_parent"
    android:layout_gravity="center"
    android:textAllCaps="true"
    android:background="@drawable/abs__spinner_ab_holo_light"
    android:textColor="#000000"
    android:gravity="center"/> 
```

现在您必须创建一个 custom `SpinnerAdapter`，并且您需要覆盖以下方法以获得正确的外观：

```
@Override
  public View getView(int position, View convertView, ViewGroup parent) {
    final TextView filterName;
    if (convertView == null) {
      filterName = (TextView) layoutInflater.inflate(R.layout.filter_item, parent, false);
    } else {
      filterName = (TextView) convertView;
    }

    filterName.setText(getItem(position));
    return filterName;
  }

  @Override
  public View getDropDownView(int position, View convertView, ViewGroup parent) {
    final TextView filterName;
    if (convertView == null) {
      filterName = (TextView) layoutInflater.inflate(R.layout.sherlock_spinner_dropdown_item, parent, false);
      filterName.setEllipsize(TruncateAt.END);
    } else {
      filterName = (TextView) convertView;
    }

    filterName.setText(getItem(position));
    return filterName;
  } 
```

YMMV，特别是。关于主题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-17T12:01:51.643

我遇到了同样的问题，我的解决方案很简单。（我没有使用 HoloEverywhere。）

这个想法来自 ABS 示例项目，它的下拉菜单也可以通过使用子菜单显示在 4.0 之前的设备上。所以，我的想法是使用子菜单来伪装 3 点图标。这是代码：

```
@Override
public boolean onCreateOptionsMenu(Menu menu) {

    SubMenu sub = menu.addSubMenu("More");
    sub.getItem().setShowAsAction(MenuItem.SHOW_AS_ACTION_ALWAYS);
    sub.getItem().setIcon(R.drawable.ic_menu);

    getSupportMenuInflater().inflate(R.menu.activity_main, sub);

    return true;
} 
```

由于“更多”菜单没有 MenuItem.SHOW_AS_ACTION_WITH_TEXT 属性，因此“更多”（或您命名的任何名称）实际上不会显示在操作栏上。唯一显示的图标 R.drawable.ic_menu 可以从名为“abs__ic_menu_moreoverflow_normal_holo_dark.png”的 ABS 源代码 res/drawable-xxdpi 文件夹中复制，也就是所谓的 3 点图标。而 R.menu.activity_main 是您的菜单 xml。

有用！

# asp.net - 退出后网站仍处于登录状态

> ID：10323478
> 
> 赞同：1
> 
> 时间：2012-04-25T20:44:46.790
> 
> 标签：asp.net, iis-7, forms-authentication

我有一个带有 ASP.NET 表单身份验证的网站。我最近实现了在用户登录时保存 cookie，现在我发现了一个问题。如果问题仍然存在，我不是 100%。

重现的步骤是：

1.  通过 www (www.mysite.com) 访问我的网站
2.  登录网站。
3.  访问没有 www 的网站 (mysite.com)
4.  它会要求我再次登录，所以我做到了。
5.  登出网站。它将我重定向到登录页面。
6.  在地址栏中输入 www.mysite.com，我发现它仍然登录。

所以访问我的网站有或没有（www）就像访问两个不同的网站一样。从 www.mysite.com 注销不会从 mysite.com 注销。登录也是如此，反之亦然。

登录页面

```
 Login1_Authenticate Handles Login1.Authenticate

     Dim result As Boolean = UserLogin(userName, password)
     If (result) Then
        e.Authenticated = True
        If Login1.RememberMeSet = True Then
            SetCookies(userName)
        End If
        LoginCounter(userName)
     Else
        e.Authenticated = False
     End If 
```

设置Cookies()

```
 Dim tkt As FormsAuthenticationTicket
    Dim cookiestr As String
    Dim ck As HttpCookie

    tkt = New FormsAuthenticationTicket(1, userName, DateTime.Now(), DateTime.Now.AddDays(7), False, "")
    cookiestr = FormsAuthentication.Encrypt(tkt)
    ck = New HttpCookie(FormsAuthentication.FormsCookieName(), cookiestr)
    ck.Expires = tkt.Expiration
    ck.Path = FormsAuthentication.FormsCookiePath()
    HttpContext.Current.Request.Cookies.Remove(".ASPXAUTH")
    Response.Cookies.Add(ck)

    End Sub 
```

母版页上的登录状态控制

```
 LoginStatus1_LoggingOut Handles LoginStatus1.LoggingOut

    FormsAuthentication.SignOut()
    Session.Clear()
    Session.Abandon()
    Dim cookie1 As New HttpCookie(FormsAuthentication.FormsCookieName, "")
    cookie1.Expires = DateTime.Now.AddYears(-1)
    Response.Cookies.Add(cookie1)

    Dim cookie2 As New HttpCookie("ASP.NET_SessionId", "")
    cookie2.Expires = DateTime.Now.AddYears(-1)
    Response.Cookies.Add(cookie2) 
```

网页配置

```
 <authorization>
    <deny users="?"/>
    </authorization>

    <authentication mode="Forms">
    <forms name=".ASPXAUTH" loginUrl="Login.aspx" defaultUrl="Default.aspx" cookieless="UseCookies"  timeout="1440" path="/" protection="All"/>
    </authentication> 
```

**解决方案：** *把它放在 Global.asax ..*

```
 Sub Application_BeginRequest(ByVal sender As Object, ByVal e As EventArgs)
     Dim fromurl As String = "http://mysite.com"
     Dim tourl As String = "http://www.mysite.com"
     If HttpContext.Current.Request.Url.ToString().ToLower().Contains(fromurl) Then
        HttpContext.Current.Response.Status = "301 Moved Permanently"
        HttpContext.Current.Response.AddHeader("Location", tourl)
     End If
     End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T20:49:23.753

我会说会话 cookie 是（子）域特定的。

您需要将所有请求从一个域重定向到另一个域，以强制浏览器仅使用一个会话。

# python - 使用其自身的简化副本对复杂列表进行重复数据删除

> ID：10323479
> 
> 赞同：1
> 
> 时间：2012-04-25T20:44:52.253
> 
> 标签：python

我有两个传递给函数的字符串列表。它们或多或少是相同的，除了已经通过正则表达式过滤器运行以删除某些样板子字符串（例如，从“Blues Brothers LLC”中删除“LLC”）。

此函数用于在内部对修改后的列表进行重复数据删除，并删除未修改列表中的关联项。您可以假设这些列表在通过正则表达式过滤器之前按字母顺序排序，并保持相同的顺序（即 original[x] 和 modified[x] 指的是同一个实体，即使 original[x] != modified[ X]）。必须在输出中的两个列表之间保持相对顺序。

这就是我到目前为止所拥有的。它在 99% 的时间都有效，除了非常罕见的输入和样板字符串组合（千分之一），其中一些输出字符串将与单个列表位置不匹配。输入列表是“原始的”和“修改的”。

```
# record positions of duplicates so we're not trying to modify the same lists we're iterating
dellist_modified = []
dellist_original = []

# probably not necessary, extra precaution against modifying lists being iterated.
# fwiw the problem still exists if I remove these and change their references in the last two lines directly to the input lists
modified_copy = modified
original_copy = original

for i in range(0, len(modified)-1):
    if modified[i] == modified[i+1]:
dellist_modified.append(modified[i+1])
dellist_original.append(original[i+1])

for j in dellist_modified:
    if j in modified:
        del modified_copy[agg_match.index(j)]
        del original_copy[agg_match.index(j)]

# return modified_copy and original_copy 
```

这很丑，但这是我的全部。我的测试表明问题是由最后一段代码造成的。

修改或全新的方法将不胜感激。我的下一步是尝试使用字典。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T21:10:42.823

这是一种干净的方法：

```
original = list(range(10))
modified = list(original)
modified[5] = "a"
modified[6] = "a"

def without_repeated(original, modified):
    seen = set()
    for (o, m) in zip(original, modified):
        if m not in seen:
            seen.add(m)
            yield o, m

original, modified = zip(*without_repeated(original, modified))

print(original)
print(modified) 
```

给我们：

```
(0, 1, 2, 3, 4, 5, 7, 8, 9)
(0, 1, 2, 3, 4, 'a', 7, 8, 9) 
```

我们同时遍历两个列表。我们保留一组我们已经看到的项目（集合具有非常快速的所有权检查），然后产生我们还没有看到的任何结果。

然后我们可以再次使用 zip 给我们两个列表。

请注意，我们实际上可以这样做：

```
seen = set()
original, modified = zip(*((o, m) for (o, m) in zip(original, modified) if m not in seen and not seen.add(m))) 
```

除了使用单个生成器表达式外，它的工作方式相同，使用条件语句将项目添加到被破解的集合中（因为 add 总是返回 false，我们可以这样做）。但是，这种方法很难阅读，因此我建议不要使用它，这只是一个示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T21:53:28.867

为什么要使用平行列表？为什么不是一个类实例列表？这样可以轻松地将事物分组，并减少您的列表查找。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T20:53:07.470

python中的A`set`是不同元素的集合。这些元素的顺序是否重要？像这样的东西可能会起作用：

```
distinct = list(set(original)) 
```

# css - @font-face 与飞碟

> ID：10323480
> 
> 赞同：6
> 
> 时间：2012-04-25T20:44:59.887
> 
> 标签：css, itext, font-face, flying-saucer

我希望有人可以帮助我……看来我想做的事情应该很简单，但是我已经与这件事斗争了一天多，而且没有想法。我在 StackOverflow 和整个 Internet 上找到了很多信息，但没有什么能帮助我解决这个问题。

我正在尝试使用 itext-2.0.8 和 core-renderer-R8 来创建带有嵌入字体的 PDF。我正在尝试从有效的 XHTML 生成 PDF，并使用 @font-face 样式标签嵌入字体。我已通过在浏览器中打开文件确认 @font-face 标记包含字体。而且我总是小心地保持 TTF 字段与 XHTML/CSS 文档相关。

为了尝试解决这个问题，我创建了一个小的“Hello World”类型程序来尝试嵌入字体。我采取了两种不同的方法，但都未能产生预期的结果。我在[http://christopherluft.com/FlyingSaucer.zip放置了这个小 Eclipse 程序的副本](http://christopherluft.com/FlyingSaucer.zip)

该程序在这两种情况下都会生成 PDF，但都没有按预期嵌入 PDF。使用带有 setDocument 的文件的第一种方法不会产生错误，但也不会产生字体。第二种方法生成 PDF，但在调试输出中显示 java.net.MalformedURLException。

我尝试了各种路径和 URL 的多种排列方式；然而，没有一个不能产生预期的结果。我的怀疑是我无法理解 ITextRenderer.setDocument; 但是，我很难找到任何适合我的用例的文档。

我尝试的第一种方法是：

```
public static void main(String[] args) throws IOException, DocumentException {

    System.getProperties().setProperty("xr.util-logging.loggingEnabled",
            "true");
    XRLog.setLoggingEnabled(true);

    String inputFile = "sample.xhtml";
    String url = new File(inputFile).toURI().toURL().toString();
    String outputFile = "firstdoc.pdf";

    OutputStream os = new FileOutputStream(outputFile);

    ITextRenderer renderer = new ITextRenderer();
    renderer.setDocument(url);
    renderer.layout();
    renderer.createPDF(os);

    os.close();
} 
```

我使用的第二种方法（更接近我们在应用程序中使用它的实际方式）是：

```
public static void main(String[] args)  throws IOException, DocumentException {

    System.getProperties().setProperty("xr.util-logging.loggingEnabled", "true");
    XRLog.setLoggingEnabled(true);

    String inputFile = "sample.xhtml";
    String url = new File(inputFile).toURI().toURL().toString();

    DocumentBuilder documentBuilder;
    org.w3c.dom.Document xhtmlContent;

    try 
    {
        documentBuilder = DocumentBuilderFactory.newInstance().newDocumentBuilder();
        documentBuilder.setEntityResolver(new XhtmlEntityResolver(new SuppressingEntityResolver()));
        xhtmlContent = documentBuilder.parse(url);

        System.out.println(url);

        String outputFile = "firstdoc.pdf";
        OutputStream os = new FileOutputStream(outputFile);
        ITextRenderer renderer = new ITextRenderer();

        renderer.setDocument(xhtmlContent,".");
        renderer.layout();
        renderer.createPDF(os);

        System.out.println("Finishing up....");
        os.close();
    } 
    catch (SAXException e) 
    {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } 
    catch (ParserConfigurationException e) 
    {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }   
} 
```

XHTML 中的 @font-face 包含如下所示：

```
@font-face {

    font-family: 'MisoRegular';

    src: url("miso-regular-webfont.ttf");

    -fs-pdf-font-embed: embed;

    -fs-pdf-font-encoding: Identity-H;
} 
```

现在我觉得这是一个非常常见的用例，我想我只是没有执行一个简单的步骤才能让它工作......问题是我已经有一段时间了，我认为我是无法透过树木看到森林。任何人可以为我提供的任何帮助将不胜感激。感谢您的时间。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-27T02:10:21.353

我在使用 Flying Saucer 时遇到过问题，字体似乎没有正确嵌入，最终导致我尝试嵌入的字体已损坏或至少不完整。缺少有关字体系列和描述的属性。当我尝试在 OS XI 上使用 FontBook 中的 Validate File 选项验证我的字体时，会立即出现警告说：

*   “名称”表可用性
*   “名称”表结构

然而，FlyingSaucer 默默地失败了，只是继续嵌入 Times-Roman 和 Times-Bold 作为默认字体。当我尝试使用通过 FontBook 验证的字体时，我发现该字体已正确嵌入。

我花了几个小时试图增加从 FlyingSaucer 记录的详细程度以获取更多信息，但直到我逐步完成整个渲染过程并碰巧注意到 FontFamily 在加载后在调试器中设置为“”时才发现这种情况字体并且它不包括我希望它注册的名称。

**底线：** *如果您在使用 FlyingSaucer 和字体时遇到问题，并且正在用头撞墙，请确保您的字体有效。*

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-10-20T21:21:16.990

我遇到了像 tekrunt 一样的问题，但最后我得到了一个嵌入了自定义字体（现代计算机）的 PDF。我的经历：

*   字体的 OTF 格式不起作用（在 iText 函数中崩溃）
*   在我进行以下更改后，TTF 格式确实有效：在 CSS 中，使用与字体中编码的字体系列名称相同的字体系列名称。在中设置断点

    ```
    org.xhtmlrenderer.pdf.ITextFontResolver.addFontFaceFont()
    ```

    并找出变量“fontFamily”得到的值。如果这与 CSS 字体系列不同，我想它不会起作用。

当然这些问题应该由图书馆报告给用户。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-09-15T11:22:26.207

我遇到了类似的问题，字体没有被应用到最终的 pdf 中，并且`m4t`关于调试的建议确实帮助我确定了这个问题。所以谢谢你！

就我而言，实际上有两个问题：

1.  作为规则的一部分指定的`src`属性`@font-face`有 2 个值，即 url 和格式。它看起来像

```
@font-face {
   src: url("../../static/fonts/OpenSans-Regular.ttf") format("ttf");
} 
```

由于第二个值`format`，CSSParser 中断，导致该`src`属性被完全无声地跳过。结果，在进一步处理中，渲染器不知道从哪里挑选字体。一旦我`format`从值中删除了部分，问题就得到了解决。

2.  一旦 url 被 CSSParser 成功解析，它就无法正确解析，因为 css 中指定的 url 是相对的，并且在调用`setDocumentAsString`渲染器时没有明确指定 baseUrl（可选的第二个参数）。我通过使用类加载器在我的代码中显式加载静态资源的 uri，然后将其设置为基本 url，从而解决了这个问题。之后更改字体文件的路径成功解决并应用于我的pdf。

> 这里要注意的关键是，提供给的基本 url `setDocumentAsString`必须是一个 URI（文件：/文件夹/结构/静态/），并且必须以斜杠 ('/') 结尾。否则文件和 url 无法正确解析。

希望这可以帮助面临类似问题的人。

# xcode - 线程 1：在断点 1 处停止

> ID：10323481
> 
> 赞同：6
> 
> 时间：2012-04-25T20:45:02.150
> 
> 标签：xcode, debugging, xcode4, breakpoints

我对 XCode 4.3.2 有疑问，我不知道它是什么。我已经设置了一个断点，但是 XCode 在设置断点的行处停止，它向我显示了线程日志。我在这里疯了。

所以，这是我在 XCode 中看到的断点页面。这是几个项目，并在启用和不启用僵尸的情况下进行了尝试。

![XCode 结果](../Images/ea195de7d23694e594ffdfd0bbcdc0b1.png)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-25T21:09:01.470

我在谷歌搜索重置 XCode，似乎这篇文章帮助了我：

[http://www.developers-life.com/uninstallresetting-xcode.html](http://www.developers-life.com/uninstallresetting-xcode.html)

但是，我在终端中执行了此操作（在我关闭 XCode 之后）：

```
defaults delete com.apple.dt.Xcode.LSSharedFileList
defaults delete com.apple.dt.Xcode 
```

我重新启动了 XCode，同意了条款并再次尝试了断点……到目前为止一切都很好！:)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-12-02T07:36:44.497

关闭 Xcode 然后在终端中执行以下操作。

```
defaults delete com.apple.dt.Xcode.LSSharedFileList

defaults delete com.apple.dt.Xcode 
```

然后重新启动 Xcode。

# c# - 建模关系客户、会议、客人

> ID：10323497
> 
> 赞同：0
> 
> 时间：2012-04-25T20:45:50.950
> 
> 标签：c#, entity-framework, database-design, poco

我已经在 EF 中看到了使用代码优先的多对多关系的几个示例，但我遇到了一种我不知道如何解决的情况。

我试图模拟这种情况

实体是客户、客人、活动 1。）客户注册活动 2。）每个客户都有客人可以带到他注册的活动中（例如，如果他已注册活动 1 并且数量为 3，他可以分配 2客人）

我使用一个简单的场景进行了尝试，在该场景中，我建立了多对多关系 b/w 客人和活动，它工作正常，我可以使用 events.guests 导航属性将客人添加到活动中

但是我需要让它与客户一起工作，我很难把我的头包起来，客户在哪里适合这个模型？

```
public class Guest
{
    public int GuestId { get; set; }
    public string GuestName { get; set; }
    public virtual ICollection<Event> Events { get; set; }
}

public class Event
{
    public int EventId { get; set; }
    public string EventName { get; set; }
    public virtual ICollection<Guest> Guests { get; set; }
} 
```

这会生成一个映射表 GuestEvent，其中包含 GuestId、EventId

据我了解，添加了客户实体 customerId、EventId、GuestId 的映射表应该看起来像这样，但我该如何设置呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T21:06:04.550

类`CustomerEvent`需要持有`Guests`，因为客人需要与特定客户和特定事件相关联。同一位客人可以参加不同的活动，也可以被不同的客户邀请。

```
public class Customer
{
    public int CustomerId { get; set; }
    public string CustomerName { get; set; }
    public virtual ICollection<CustomerEvent> CustomerEvents { get; set; }
}

publix class CustomerEvent
{
    public int CustomerEventId { get; set; }
    public virtual int CustomerId { get; set; }
    public virtual Customer Customer { get; set; }
    public virtual int EventId { get; set; }
    public virtual Event Event { get; set; }
    public virtual ICollection<Guest> Guests { get; set; }
}

public class Event
{
    public int EventId { get; set; }
    public string EventName { get; set; }
    public virtual ICollection<CustomerEvent> CustomerEvents { get; set; }
}

public class Guest
{
    public int GuestId { get; set; }
    public string GuestName { get; set; }
    public virtual ICollection<CustomerEvent> CustomerEvents { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T21:04:57.523

像这样的东西应该可以工作：这假设客户和事件之间的关系是 1:1，并且所有名称信息都在来宾对象上......

```
public class Guest
{
    public int GuestId { get; set; }
    public string GuestName { get; set; }
    public int CustomerId { get; set; }
    public virtual Customer Patron { get; set; }
    public virtual ICollection<Event> Events { get; set; }
}

public class Event
{
    public int EventId { get; set; }
    public string EventName { get; set; }
    public virtual ICollection<Guest> Guests { get; set; }
    public virtual ICollection<Customer> Customers { get; set; }
}

public class Customer
{
    public int CustomerId { get; set; }
    public int EventId { get; set; }
    public virtual ICollection<Guest> Guests { get; set; }
    public virtual Event Event { get; set; }
} 
```

# c# - 使用 C# 更新 mySQL 表

> ID：10323498
> 
> 赞同：1
> 
> 时间：2012-04-25T20:45:57.227
> 
> 标签：c#, mysql

我编写了一些 C# 来更新 MySql 表，但每次调用 ExecuteNonQuery() 方法时都会出现异常。我在网上对此进行了研究，发现的每个解决方案都会产生相同的错误。我有一个与数据库的开放连接，并且对数据库的更新查询已正确写入。到目前为止，我提出的代码是：

```
public int executeUpdate()
{
  int result = 0;
  if (isConnected)
  {
    try
    {
      MySqlConnection cn = new  MySqlConnection(connection.ConnectionString);
      MySqlCommand cmd = new MySqlCommand();

      cmd.Connection = cn; 
      cmd.CommandText = "UPDATE test SET status_id = 1 WHERE test_id = 1";
      int numRowsUpdated = cmd.ExecuteNonQuery(); 
    }
    catch (MySqlException exSql)
    {
      Console.Error.WriteLine("Error - SafeMySql: SQL Exception: " + query);
      Console.Error.WriteLine(exSql.StackTrace);
    }
    catch (Exception ex)
    {
      Console.Error.WriteLine("Error - SafeMySql: Exception: " + query);
      Console.Error.WriteLine(ex.StackTrace);
    }
  }
  else
    Console.Error.WriteLine("Error - SafeMySql: executeQuery failed. Not connected to DB");
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T21:10:48.353

将您的尝试部分更改为以下代码：

```
try
{
    using(MySqlConnection cn = new  MySqlConnection(connection.ConnectionString))
    {        
        MySqlCommand cmd = new MySqlCommand();
        cmd.Connection = cn; 
        cmd.CommandText = "UPDATE test SET status_id = 1 WHERE test_id = 1";
        cn.Open();
        int numRowsUpdated = cmd.ExecuteNonQuery();
        cmd.Dispose(); 
     }
} 
```

在执行命令之前必须打开连接。在上面的示例中，命令对象将立即被释放，而连接对象将在您离开 using 部分时隐式关闭和释放。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-25T20:56:35.197

**我没有看到正在打开的连接**。

[这是来自MSDN](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.executenonquery.aspx)的示例：即使在 using 块内，它们也会显式打开连接

```
private static void CreateCommand(string queryString,
    string connectionString)
{
    using (SqlConnection connection = new SqlConnection(
               connectionString))
    {
        SqlCommand command = new SqlCommand(queryString, connection);
        command.Connection.Open();
        command.ExecuteNonQuery();
    }
} 
```

**编辑**：[MySQL](https://dev.mysql.com/doc/refman/5.0/es/connector-net-examples-mysqlcommand.html#connector-net-examples-mysqlcommand-executenonquery)的原理与SQL Server 的原理相同：

```
public void CreateMySqlCommand(string myExecuteQuery, MySqlConnection myConnection) 
{
  MySqlCommand myCommand = new MySqlCommand(myExecuteQuery, myConnection);
  myCommand.Connection.Open();
  myCommand.ExecuteNonQuery();
  myConnection.Close();
} 
```

# javascript - 淘汰赛：写入和读取计算属性

> ID：10323503
> 
> 赞同：2
> 
> 时间：2012-04-25T20:46:22.733
> 
> 标签：javascript, knockout.js

我有一个具有两个属性的模型：标题和内容，我想要做的是：

如果标题有值，请使用它，但如果它是空白的，请使用内容中的前 20 个字符 +“...”。

这是模型：

```
 function Note(title, content) {
        var self = this;

        self.content = ko.observable(content);
        self.title = ko.computed({
          read: function(){
            if(!title){
              var content = self.content();
              if(content) return content.substring(0,19) + "...";
            }
          },
          write: function(title){
           return title;
          }
        });
       } 
```

标题值可以从内容中正确更新，但（对我而言）不可能直接在标题上工作..

**RP Niemeyer 回答中的唯一问题是我必须只拥有用于读/写的属性，这可能吗？**

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-25T22:00:08.900

在创建可写计算 observable 时，您将需要一个单独的 observable 来包含实际标题。

更像：

```
function Note(title, content) {
    var self = this;

    self.content = ko.observable(content);
    self.title = ko.observable(title);

    self.displayTitle = ko.computed({
        read: function() {
            var title = self.title();
            if (!title) {
                var content = self.content();
                if (content) return content.substring(0, 19) + "...";
            }

            return title;
        },
        write: self.title
    });
}​ 
```

# asp.net - 如果满足数据库中的数字，则在页面上显示不同的内容

> ID：10323504
> 
> 赞同：1
> 
> 时间：2012-04-25T20:46:27.237
> 
> 标签：asp.net, vb.net, visual-studio-2010, ms-access

基本上我有一个页面，我希望它根据 ms access 数据库表中数字字段中的数字显示不同的内容。

例如，如果字段中的数字等于或大于 7，则它会显示文本标签“访问授权”，如果它小于 7，那么它将显示文本标签“访问被拒绝”</p>

我在如何在 vb 中做到这一点时遇到了麻烦。任何人都知道如何做到这一点？艾米的帮助将接近谢谢

# javascript - 如何在 jQuery 中使用占位符？

> ID：10323509
> 
> 赞同：0
> 
> 时间：2012-04-25T20:46:53.857
> 
> 标签：javascript, jquery, jquery-plugins

我想创建一个文本模板并在其中设置占位符并填充此占位符并在我的页面中使用它？像 ..

```
var temp = '<div class="persons">';
temp += '<p> <span class="firstname">First Name :</span> <span> [firstname]</span> </p>';
temp += '<p> <span class="lastname">Last Name :</span> <span> [lastname]</span> </p>';
temp += '<p> <span class="tel">Telephone :</span> <span> [tel]</span> </p>';
temp += '</div>'; 
```

并用我的价值观改变`[firstname]`,并在页面中显示？或任何其他想法？`[lastname]``[tel]`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T20:55:25.633

快速而肮脏的 JS 模板引擎：

```
// Create a matching object for each of your replacement
var matches = {
    "[firstname]": "fred",
    "[lastname]": "smith",
    "[tel]": "123456789"
}

// Loop through the keys of the object
Object.keys( matches ).forEach( function( key ) {
    // Replace every key with its value
    temp = temp.replace( key, matches[ key ] )
} ) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T20:50:08.350

你可以简单地替换它们。

```
temp.replace("[firstname]", "fred").replace("[lastname]", "smith").replace("[tel]", "123456789");
```

不确定您是否使用 jQuery 模板。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-25T20:53:30.813

你试过`.replace()`吗？

[http://jsfiddle.net/KL9kz/](http://jsfiddle.net/KL9kz/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-12T12:09:53.100

试试这样的东西，非常基本

```
function replaceall(tpl, o, _p, p_) {
    var pre = _p || '%',
        post = p_ || '%',
       reg = new RegExp(pre + '([A-z0-9]*)' + post, 'g'),
        str;
    return tpl.replace(reg, function (str, $1) {
        return o[$1];
    });
};
var temp = '<div class="persons">'+
        '<p> <span class="firstname">First Name :</span> <span> [firstname]</span> </p>'+
        '<p> <span class="lastname">Last Name :</span> <span> [lastname]</span> </p>'+
        '<p> <span class="tel">Telephone :</span> <span> [tel]</span> </p>'+
    '</div>',
    data = {
        'firstname':'Fede',
        'lastname':'Ghe',
        'tel' : '+00 012 3456789' 
    };
alert(replaceall(temp, data, '\\\[', '\\\]')); 
```

如果需要，可以避开占位符界限并调整内部正则表达式希望它有所帮助

# ruby-on-rails - 如何将模型和控制器连接到视图中的按钮

> ID：10323515
> 
> 赞同：1
> 
> 时间：2012-04-25T20:47:09.753
> 
> 标签：ruby-on-rails

我有一个现有的 Ruby On Rails，它工作正常（我继承了它）。

我需要向应用程序添加一些功能，并且我构建了一个模型和控制器，我希望按下按钮来路由到控制器。

我想我需要做类似的事情： <%= form_tag(url_for(:controller => "do_something", :action => "sup"), ...

我有一个看起来像这样的控制器：class DoSomething < ApplicationController ... end

我如何告诉框架按下该按钮会触发控制器？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T21:13:41.217

您不会触发控制器；您在该控制器中触发一个动作。

```
class SomethingController < ApplicationController
  def panic
    # some code here
  end
end 
```

然后在你的`config/routes.rb`，有一个指向该动作的路线：

```
match '/something/panic' => 'something#panic', :as => 'panic_button' 
```

然后在您的视图文件中，

```
button_to 'press me in emergency', panic_button_path 
```

或者

```
button_to 'press me in emergency', '/something/panic' 
```

# php - 比较 iPhone 上 UIImage 上的 MD5 哈希值和服务器上的文件

> ID：10323521
> 
> 赞同：3
> 
> 时间：2012-04-25T20:47:24.310
> 
> 标签：php, iphone, ios, hash, md5

我正在尝试在 iOS 应用程序中计算 MD5 哈希，以比较应用程序中保存的文件与使用 PHP 存储在 Web 服务器上的相同文件之间的哈希值。

这是 iOS 应用程序的代码：

```
unsigned char result[CC_MD5_DIGEST_LENGTH];

NSData* data = [NSData dataWithContentsOfFile:@"advert.png"];
const void* src = [data bytes];

CC_MD5(src, [data length], result);

    NSString *imageHash = [[NSString stringWithFormat:
                       @"%02X%02X%02X%02X%02X%02X%02X%02X%02X%02X%02X%02X%02X%02X%02X%02X",
                       result[0], result[1], result[2], result[3], 
                       result[4], result[5], result[6], result[7],
                       result[8], result[9], result[10], result[11],
                       result[12], result[13], result[14], result[15]]
                       lowercaseString];

NSLog(@"%@", imageHash); 
```

Web服务器的代码：

```
$file = 'advert.png';
echo 'MD5 file hash of ' . $file . ': ' . md5_file($file); 
```

该应用程序生成：D41D8CD98F00B204E9800998ECF8427E

PHP 生成：3ef9386b1dd50e8e166efbe48f0f9401

md5sum 生成：3ef9386b1dd50e8e166efbe48f0f9401

**更新**：

只需通过模拟器运行应用程序，它就会正确计算哈希：3ef9386b1dd50e8e166efbe48f0f9401。

在运行 iOS 5.1 的 iPhone 4 上运行时，计算结果为：ddf017003e063e353a5e4ec2cc4a5095

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-25T21:25:29.127

`D41D8CD98F00B204E9800998ECF8427E`是一个空文件的 MD5 和。您没有正确读取文件，原因可能是 dataWithContentsOfFile: 需要绝对路径。尝试：

```
NSString *path = [[NSBundle mainBundle] pathForResource:@"advert" ofType:@"png"];
NSData *plistData = [NSData dataWithContentsOfFile:path]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-25T21:18:27.743

我的猜测是您刚刚见证了 iPhone PNG 优化器的运行。

# c++ - 带有隐式参数的 C++ 函数模板实例化

> ID：10323528
> 
> 赞同：5
> 
> 时间：2012-04-25T20:47:59.463
> 
> 标签：c++, compiler-errors, function-templates

我不明白为什么下面的代码编译得很好：

```
#include <iostream>                                                                 

void bar(int x) {                                                                   
  std::cout << "int " << x << std::endl;                                            
}                                                                                   

void bar(double x) {                                                                
  std::cout << "double " << x << std::endl;                                         
}                                                                                   

template <typename A, typename B>    // Note the order of A and B.                                               
void foo(B x) {                                                                     
  bar((A)x);                                                                        
}                                                                                   

int main() {                                                                        
  int x = 1;                                                                        
  double y = 2;                                                                     

  foo<int>(x);        // Compiles OK.                                                              
  foo<double>(y);     // Compiles OK.                                               

  return 0;                                                                         
} 
```

但是，如果我将`A`and的顺序切换`B`如下，那么它将无法编译：

```
#include <iostream>                                                                 

void bar(int x) {                                                                   
  std::cout << "int " << x << std::endl;                                            
}                                                                                   

void bar(double x) {                                                                
  std::cout << "double " << x << std::endl;                                         
}                                                                                   

template <typename B, typename A>    // Order of A and B are switched.
void foo(B x) {                                                                     
  bar((A)x);                                                                        
}                                                                                   

int main() {                                                                        
  int x = 1;                                                                        
  double y = 2;                                                                     

  foo<int>(x);        // error: no matching function for call to ‘foo(int&)’
  foo<double>(y);     // error: no matching function for call to ‘foo(double&)’                                                              

  return 0;                                                                         
} 
```

编辑：欢迎临时解释，但如果有人能指出具体的规范会更好。说。谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-25T20:53:02.933

在第一个中，编译器知道这`A`是`int`因为您专门用 告诉它`foo<int>`，并且它知道这`B`也是`int`因为您传递给它的参数。所以`A`和`B`都是已知的或可以推导出来的（你可以说：`A`是*提供*的，`B`是*隐含*的）。

但是，在第二个中，由于出现在`B`第一个并且`A`没有出现在参数列表中，编译器无法判断是什么`A`并给你一个错误。您明确地告诉它`B`with 是什么`foo<int>`，然后您传递的参数也是 a `B`which，在调用时，`int`它与您先前的明确定义一致`B`，但没有隐式或显式地提及`A`，因此编译器必须停止和错误。

你真的不需要这个标准，这只是常识。第二个到底是`A`什么？

不过感谢您提出这个问题，因为我没有意识到您可以在此之前显式指定一些参数并在参数列表中隐式指定其他参数。

# python - 无法在我的 Mac 上为 Python2.7 安装 YAML

> ID：10323530
> 
> 赞同：2
> 
> 时间：2012-04-25T20:48:10.873
> 
> 标签：python, yaml, pyyaml

我正在尝试在我的 Mac 上为 Python 2.7 安装 YAML 模块（PyYAML3.10）。我收到以下错误消息：

```
$ python setup.py install
running install
running build
running build_py
running build_ext
running install_lib
creating /Library/Python/2.7/site-packages/yaml
error: could not create '/Library/Python/2.7/site-packages/yaml': Permission denied 
```

谁能帮我解决这个问题？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T20:49:46.237

这是权限问题...尝试：`sudo python setup.py install`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T21:00:25.870

我建议您使用[pip](http://pip-installer.org/)安装包和[virtualenv](http://pypi.python.org/pypi/virtualenv)以您的用户身份制作 pip 安装包。这样你就不会再收到`Permission denied`消息了。请参阅[本指南](http://simononsoftware.com/virtualenv-tutorial/)以了解有关 virtualenv 的更多信息。一开始似乎有点难以掌握，但我向你保证，这种努力是值得的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T20:49:57.327

错误很明显：

```
error: could not create '/Library/Python/2.7/site-packages/yaml': Permission denied 
```

您无权写入此目录。如果您`setup.py`使用 using运行`sudo`，您将使用 root 权限运行它，这样您就可以安装它：

```
sudo python setup.py install 
```

您可能想研究一下[macports](http://www.macports.org)之类的东西，它为您提供了一种方便的方式来安装（和卸载、升级等）各种开源软件。它包括 YAML 模块的打包版本。

# android - 带有嵌套布局的 TranslateAnimation

> ID：10323532
> 
> 赞同：0
> 
> 时间：2012-04-25T20:48:21.283
> 
> 标签：android, animation

我正在设置“菜单展开”动画。扩展选项是 2`RelativeLayout`嵌套在一个垂直的`LinearLayout`. `TranslateAnimation`应用于周围环境并使`LinearLayout`选项从底部扩展。

问题是只`RelativeLayout`显示第一个嵌套。第二个在没有动画的情况下变得可见。

下面是相关的 XML 布局、应用动画的方法和调用。非常感谢您的想法

```
<LinearLayout
    android:id="@+id/bmb_navigation_expanded"
    style="@style/bmb_RelativeLayout"
    android:layout_above="@id/bmb_bottom_bar"
    android:orientation="vertical"
    android:visibility="gone" >

    <RelativeLayout
        style="@style/bmb_RelativeLayout">

     option 1 stuff

    </RelativeLayout>

    <RelativeLayout            
        style="@style/bmb_RelativeLayout">

     option 2 stuff

    </RelativeLayout>

</LinearLayout> 
```

将动画应用到 LinearLayout 的方法：

```
 public static void setSlideIn(ViewGroup panel, Context ctx) {

      AnimationSet set = new AnimationSet(false);

      Animation animation = new TranslateAnimation(
          Animation.RELATIVE_TO_SELF, 0.0f, Animation.RELATIVE_TO_SELF, 0.0f,
          Animation.RELATIVE_TO_SELF, 1.0f, Animation.RELATIVE_TO_SELF, 0.0f
      );
      animation.setDuration(200);
      set.addAnimation(animation);

      LayoutAnimationController controller = new LayoutAnimationController(set, 0);
      panel.setLayoutAnimation(controller);

    } 
```

这就是我所说的动画：

```
 layout.setVisibility(View.VISIBLE);
        setSlideIn(layout, getActivity()); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T13:42:29.467

在这里回答我自己的问题。`LayoutAnimationController` 将动画分发给所有`ViewGroup`孩子。如果我想将动画`ViewGroup`作为单个实体，我必须执行以下操作：

```
panel.setAnimation(set);
set.start(); 
```

# twitter-bootstrap - Twitter Bootstrap - 折叠时，导航栏选项不会变成显示选项的按钮

> ID：10323537
> 
> 赞同：3
> 
> 时间：2012-04-25T20:48:48.553
> 
> 标签：twitter-bootstrap

我有这个标记：

```
<div class='navbar'>
            <div class='navbar-inner'>
              <div class='container'>
                <a class='btn btn-navbar' data-target='.nav-collapse' data-toggle='collapse'>
                  <span class='icon-bar'></span>
                  <span class='icon-bar'></span>
                  <span class='icon-bar'></span>
                </a>
                <div class='nav-collapse'>
                  <ul class='nav'>
                    <li class='active'>
                      <a href='#'>Home</a>
                      <a href='#'>Option 2</a>
                      <a href='#'>Option 3</a>
                    </li>
                  </ul>
            </div>
          </div>
        </div>
      </div> 
```

当屏幕已满时它呈现正常，但是当我折叠屏幕时，它不显示展开以显示选项的按钮。有什么我做的不对吗？知道为什么屏幕折叠后按钮不显示吗？

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-26T01:52:04.113

正如 Andres 所说，您需要确保包含`bootstrap-responsive.cs`. 您还需要确保加载`bootstrap.js`文件，以便单击折叠按钮显示菜单列表。

此外，您应该将每个链接包装在其自己的`<li>`标签中，如下所示：

```
<ul class='nav'>
  <li class='active'><a href='#'>Home</a></li>    
  <li><a href='#'>Option 2</a></li>
  <li><a href='#'>Option 3</a></li> 
</ul> 
```

否则你会得到一个看起来很奇怪的菜单。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-25T21:02:04.233

您需要包含折叠插件 js 文件。像这样：http: [//twitter.github.com/bootstrap/javascript.html](http://twitter.github.com/bootstrap/javascript.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-25T22:09:16.690

您需要包含`bootstrap-responsive.css`样式表才能使响应功能起作用。

[http://getbootstrap.com/2.3.2/scaffolding.html#responsive](http://getbootstrap.com/2.3.2/scaffolding.html#responsive)

# java - 长数字删除第一位 - 快速方式 JAVA

> ID：10323538
> 
> 赞同：2
> 
> 时间：2012-04-25T20:48:58.957
> 
> 标签：java

我在一个长数组中有一系列长数字。我想获取每个 Long 数字并想要获取它的第一位，并且根据第一位，我想处理其他位。就像下面的伪代码一样，

```
i = 1000000 ;
long[] a = new long[i];
for j = 0  to i
 do,
  get long lo = a[i];

  // get first bit of lo

  if first bit = 0
     print long number (by removing first bit) in file a1

  else 
     print long number (by removing first bit) in file a2 
```

任何人都可以帮助我，“获得那个长数字的第一位”和“删除第一位并获得数字”的最快方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T20:57:21.583

用 1 位掩码数字。

```
long temp = a[i];
int bit = (temp >> 63) & 1; 
```

这会将数字移动 63 位并按位移动数字和 1。如果该位为 1，则为 1，如果该位为 0，则为 0。

如果您想要最低位，则无需移动

```
int bit = temp & 1; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-25T20:59:48.593

twain249 在测试部分击败了我，但这是您问题另一部分的答案：

```
long longWithoutTheFirstBit = a[i] & 0x7fffffff; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T21:00:19.810

long 是一个 8 字节的数字，所以要获得第一位，你可以做

```
 long l = ...
long firstBit = l & 0x80000000; // this will be 0 if the first bit is 0 
```

请注意，在二进制补码中，第一位是符号位。

要获得没有第一位的数字，您可以执行 l - firstBit 或者您可以执行

长 noFirstBit = l & 0x7FFFFFFF

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-25T21:01:14.453

获取第一位：`number >>> 63`-- 注意三个 > 符号 -- 那是**无符号**右移！

删除第一位：`number & ~(1L << 63)`

# c# - 如何对实体框架代码优先映射进行单元测试？

> ID：10323547
> 
> 赞同：12
> 
> 时间：2012-04-25T20:49:27.630
> 
> 标签：c#, unit-testing, ef-code-first, entity-framework-4.3

我正在使用 Code First 将类映射到现有数据库。我需要一种方法来对这些映射进行单元测试，这些映射混合了基于约定、基于属性和 fluent-api。

要进行单元测试，我需要确认类的属性映射到数据库中正确的表名和列名。此测试需要针对上下文执行，并且应首先涵盖代码的所有配置选项。

在非常高的层次上，我希望断言类似（伪代码）：

```
Assert.IsTrue(context.TableFor<Widget>().IsNamed("tbl_Widget"));
Assert.IsTrue(context.ColumnFor<Widget>(w => w.Property).IsNamed("WidgetProperty")); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-06-01T06:30:58.327

另一个要考虑的想法是使用 Linq 和 ToString()。

例如：

```
context.Widget.Select(c => c.Property).ToString() 
```

将导致 SQL Server Provider 出现这种情况：

```
"SELECT [Var_3].[WidgetProperty] AS [WidgetProperty] FROM [dbo].[Widget]..." 
```

现在我们可以将它全部隐藏在一些扩展方法中并解析生成的 SQL，它看起来几乎就像你的伪代码：

```
Assert.IsTrue(context.Widgets.GetSqlColumnNameFor(w => w.Property).IsNamed("WidgetProperty")); 
```

延期草案：

```
public string GetSqlColumnNameFor<TSource>(this DbSet<T> source, Expression<Func<TSource, TResult>> selector)
{
    var sql = source.Select(selector).ToString();

    var columnName = sql... // TODO : Some regex parsing

    return 
       columnName;
} 
```

类似地，我们可以创建 GetSqlTableNameFor()。

更新：我决定寻找一些专用的 SQL 解析器，所以这个解决方案更通用，显然 .NET 有这样的事情：

[http://www.dpriver.com/blog/list-of-demos-illustrate-how-to-use-general-sql-parser/generate-internal-query-parse-tree-in-xml-for-further-加工/](http://www.dpriver.com/blog/list-of-demos-illustrate-how-to-use-general-sql-parser/generate-internal-query-parse-tree-in-xml-for-further-processing/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T14:27:39.270

如果你写了一个方法

```
public static string ToMappingString(this Widget obj) 
```

然后您可以通过批准测试（www.approvaltests.com 或 nuget）轻松地对此进行测试

这里有一个视频：[http ://www.youtube.com/watch?v=vKLUycNLhgc](http://www.youtube.com/watch?v=vKLUycNLhgc)

但是，如果您要测试“我的对象保存并自行检索”，那么这是“基于理论的测试”的理想场所

**基于理论的测试** 大多数单元测试采用以下形式

```
Given A,B expect C 
```

基于理论的测试是

```
Given A,B expect Theory 
```

这样做的好处是无需担心 A 和 B 采用哪种特定形式，因为您不需要知道 C，因此任何随机生成器都可以工作。

示例 1：测试 Add 和 Subtract 方法

通常你会有类似的东西

```
Assert.AreEqual(5, Add(2,3));
Assert.AreEqual(9, Add(10,-1));
Assert.AreEqual(10, Add(5,5));
Assert.AreEqual(7, Subtract(10,3)); 
```

但是，如果您编写了一个理论测试，它看起来像

```
for(int i = 1; i < 100; i++)
{ 
    int a = random.Next();
    int b = random.Next();
    Assert.AreEqual(a, Subtract(Add(a,b),b, string.Format("Failed for [a,b] = [{0},{1}], a,b));        
} 
```

既然您了解了基于理论的测试，那么您要测试的理论是

```
Given Model A
When A is stored to the database, and retrieved the resulting object is equal to A 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T04:54:48.187

我能想到的涵盖所有可能选项的唯一方法是使用 Entity Framework Power Tools 来预编译 DbContext 的视图，并且可能结合使用对生成的类型的反射和对生成的代码本身的 RegEx验证一切都按照您想要的方式映射。对我来说听起来很痛苦。

想到的另一件事是围绕 DbModelBuilder 创建一个外观来拦截和检查通过它的所有内容，但我不知道这是否会处理基于约定的内容。听起来也很痛苦。

作为一个不太完整但更简单的替代方案，您可以通过尽可能切换到基于属性的映射来消除其中的很大一部分。这将允许您创建一个基本测试类，例如 ModelTesting<TEntity>，其中包括一些使用反射来验证 TEntity 具有的测试方法：

*   单个 TableAttribute。
*   每个属性都有一个 ColumnAttribute 或 NotMappedAttribute。
*   至少一个具有 KeyAttribute 的属性。
*   每个属性类型都映射到一个兼容的数据库类型。

您甚至可以根据属性和类的名称强制执行命名约定（需要注意每个层次结构的表类型）。也可以检查外键映射。这是一个只写一次的基类，您可以为每种模型类型派生一次，并捕获您的大部分错误（好吧，它捕获了我的大部分错误）。

任何不能用属性表示的东西，比如 TPH 继承等等，都会变得有点困难。假设您的 DbContext 没有为您生成数据库，那么启动 DbContext 并在 Set<TEntity>() 上执行 FirstOrDefault 的集成测试可能会涵盖大部分这些基础。

# regex - 在两个字符串之间添加变量空格

> ID：10323548
> 
> 赞同：3
> 
> 时间：2012-04-25T20:49:34.507
> 
> 标签：regex

我没有使用编码语言。这必须是直接的正则表达式。

我需要在两个字符串之间添加可变长度的空格。我传递给正则表达式的字符串在字符串本身中有空格数，需要替换：

```
string1 *27* string2 
```

所以我需要在 string1 和 string 2 之间的这个字符串中插入 27 个空格

```
\*(\d+)\* 
```

这是我的捕获，它似乎正在工作，但我试图用这个来设置我的替换：

```
\s{$1} 
```

或这个：

```
$&\s{$1} 
```

那么你会怎么做呢？我使用 expresso 进行验证，但我使用的文本引擎并不支持所有正则表达式模式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T20:52:03.357

这对于直接的正则表达式是不可能的。正则表达式需要某种解析功能才能使用捕获的变量并将其转换为重复空格。

您希望替换工作的方式也是不可能的。由于正则表达式的替换部分是直接文本替换，而不是另一个正则表达式评估器....虽然有某种递归正则表达式会很酷:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T21:06:04.947

使用`perl`风味正则表达式的一种方法：

```
perl -e '
  $s = q[string1 *27* string2]; 
  $s =~ s/\s+\*(\d+)\*\s+/" " x $1/e; 
  print $s
' 
```

输出：

```
string1                           string2 
```

# .net - 使用命名空间对 XML 进行排序

> ID：10323560
> 
> 赞同：0
> 
> 时间：2012-04-25T20:50:16.533
> 
> 标签：.net, xml

我发现的大多数关于对 XML 查询进行排序的示例都不包含名称空间。其中一些确实如此，但我没有找到任何在有命名空间时执行查询和排序的示例。

```
 <Search xmlns="http://whatever.whatever.com/gg/whatever">
 <BinSet Type="Category">
 <Bin>
  <BinName>Clothing</BinName>
  <BinItemCount>804</BinItemCount>
   <BinParameter>
    <Name>Category</Name>
    <Value>Women's Apparel</Value>
  </BinParameter>
</Bin>
 <Bin>
  <BinName>Tools</BinName>
  <BinItemCount>126</BinItemCount>
   <BinParameter>
    <Name>Category</Name>
    <Value>Tools, handtools and hardware</Value>
  </BinParameter>
</Bin>
</BinSet>
</Search> 
```

我对 XML 没有任何控制权，所以我必须处理名称空间。此外，XML 中大约有 50 条这样的记录，它只是一个更大的 XML 文件的一部分。

```
Dim nsuri as string = "http://whatever.whatever.com/gg/whatever"
Dim xpath as string = "dd:Search/dd:BinSet[Type="Category"]/*"
Dim nav As XPathNavigator = doc.CreateNavigator()
Dim exp As XPathExpression = nav.Compile(xpath)
Dim nsmgr As New XmlNamespaceManager(nav.NameTable)
nsmgr.AddNamespace("dd", nsuri)
exp.SetContext(nsmgr)

exp.AddSort("BinParameter/Value", XmlSortOrder.Ascending, XmlCaseOrder.UpperFirst, "en-US", XmlDataType.Text)

' now process in sorted order
Dim iterator As XPathNodeIterator = nav.Select(exp)
While iterator.MoveNext
    Dim nav2 As XPathNavigator = iterator.Current.Clone
    nav2.MoveToFirstChild()
    Debug.WriteLine(nav2.Value) 
End While 
```

我看到的所有示例都显示了如何对直接子节点进行排序，例如我的示例 XML 中的 BinName 或 BinItemCount。但我需要所有这些信息，并且需要在 BinParameter/Value 节点上进行排序。我已经尝试了所有我能想到的方法...

最后要注意的一件事，当一切都说完了，我真的不关心使用 XPathNodeIterator 或 XPathNavigator。以前我返回一个包含所有这些记录的 XmlNodeList，我的调用例程将遍历节点列表以形成链接，如下所示：

```
<a href="mypage.aspx?si=Tools">Tools, handtools and hardware (126)</a>
<a href="mypage.aspx?si=Clothing">Women's Apparel (804)</a> 
```

有谁知道如何使用命名空间通过嵌套的子节点“值”对这个 XML 进行排序？

此外，您是否知道在 XmlNodeList 或其他 .Net 对象中返回排序结果的最快方法，以便我可以访问所有值：BinName、BinItemCount、Name 和 Value？我不熟悉 XPathNavigator 或 XPathNodeIterator。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T21:16:57.430

尝试将`xpath`变量设置为

```
/dd:Sets/dd:Bin/dd:BinParameter 
```

并使用以下 AddSort 行

```
exp.AddSort("dd:Value", XmlSortOrder.Ascending, XmlCaseOrder.UpperFirst, "en-US", XmlDataType.Text) 
```

（注意`dd:`所有元素的前缀）

编辑：

```
Dim iterator As XPathNodeIterator = nav.Select(exp, nsmgr) 
```

# database - 通用实体的模型，非常适合 JPA

> ID：10323561
> 
> 赞同：0
> 
> 时间：2012-04-25T20:50:22.447
> 
> 标签：database, database-design, jpa

是否有很好的资源来查找常见/标准实体的模型？我的意思是通常我想在我的数据库中定义一些实体，例如地址、公司等......现在我需要考虑需要哪些字段、什么类型、什么大小等......当成千上万的人过去遇到过同样的问题并解决了。因此，我非常确信我可以在某处找到现成的模型（最好是 JPA 实体）。任何的想法？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T09:28:24.350

对于我不熟悉的主题的概念模型，我喜欢 Database Answers [http://www.databaseanswers.org/data_models/ 。](http://www.databaseanswers.org/data_models/)

我不认为你看到的模型是你正在寻找的形式。但它们会向您展示 databaseanswers 认为相关的实体、关系和属性。从那里，您可以以适合您的形式构建自己的模型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T15:28:20.023

只是一个补充，erdiagrams.com 也可能是一个很好的资源/起点： [http](http://www.erdiagrams.com) ://www.erdiagrams.com 大多数“标准”，常见的实体都在那里提到。此外，数据模型资源书可能会有所帮助：通用数据模型。

# c# - 使用 T4 生成 WMAppManifest.xml

> ID：10323563
> 
> 赞同：2
> 
> 时间：2012-04-25T20:50:47.950
> 
> 标签：c#, .net, visual-studio, windows-phone-7, t4

我有一个只返回 AssemblyInfo.cs 中的值的类（此代码适用于 Windows Phone）：

```
using System.Runtime.InteropServices;
using System.Reflection;

namespace Tiletoons
{
    class AppInfo
    {
        public static readonly string Id = string.Empty;
        public static readonly string Product = string.Empty;
        public static readonly string Company = string.Empty;
        public static readonly string Version = string.Empty;

        static AppInfo()
        {
            Assembly assembly = Assembly.GetExecutingAssembly();

            foreach (object attribute in assembly.GetCustomAttributes(false)) {
                if (attribute.GetType() == typeof(GuidAttribute)) {
                    Id = (attribute as GuidAttribute).Value;
                } else if (attribute.GetType() == typeof(AssemblyProductAttribute)) {
                    Product = (attribute as AssemblyProductAttribute).Product;
                } else if (attribute.GetType() == typeof(AssemblyCompanyAttribute)) {
                    Company = (attribute as AssemblyCompanyAttribute).Company;
                } 
            }

            Version = assembly.FullName.Split('=')[1].Split(',')[0];
        }
    }
} 
```

...我想用它通过 T4 转换自动生成我的 WMAppManifest.xml；这是我的 ttinclude 文件：

```
<#@ assembly name="System.Core" #>
<#@ assembly name="EnvDTE" #>
<#@ import namespace="EnvDTE" #>
<#@ import namespace="System" #>
<# 
IServiceProvider hostServiceProvider = Host as IServiceProvider;
EnvDTE.DTE dte = hostServiceProvider.GetService(typeof(EnvDTE.DTE)) as EnvDTE.DTE;
EnvDTE.ProjectItem containingProjectItem = dte.Solution.FindProjectItem(Host.TemplateFile);
Project project = containingProjectItem.ContainingProject;
var projectName = project.FullName;
ProjectItem deploymentConfiguration = GetProjectItem(project, "AppInfo.cs");

if (deploymentConfiguration == null) {
    throw new Exception("Unable to resolve AppInfo.cs");
}

var codeModel = deploymentConfiguration.FileCodeModel;

string id = null;
string product = null;
string company = null;
string version = null;

foreach (CodeElement codeElement in codeModel.CodeElements) {
    if (codeElement.Name == "AppInfo") {
        CodeClass codeClass = codeElement as CodeClass;

        foreach (CodeElement memberElement in codeClass.Members) {
            CodeVariable variable = memberElement as CodeVariable;

            switch (memberElement.Name) {
                case "Id":
                    id = variable.InitExpression as string;
                    break;
                case "Product":
                    product = variable.InitExpression as string;
                    break;
                case "Company":
                    company = variable.InitExpression as string;
                    break;
                case "Version":
                    version = variable.InitExpression as string;
                    break;
             }
        }
    }
} 
#>
<#+ EnvDTE.ProjectItem GetProjectItem(Project project, string fileName)
{
    foreach (ProjectItem projectItem in project.ProjectItems) {
        if (projectItem.Name.EndsWith(fileName)) {
            return projectItem;
        }

        var item = GetProjectItem(projectItem, fileName);

        if (item != null) {
            return item;
        }
    }

    return null;
}

EnvDTE.ProjectItem GetProjectItem(EnvDTE.ProjectItem projectItem, string fileName)
{
    if (projectItem.ProjectItems != null && projectItem.ProjectItems.Count > 0) {
        foreach (ProjectItem item in projectItem.ProjectItems) {
            if (item.Name.EndsWith(fileName)) {
                return item;
            }
        }
    }

    return null;
} 
#> 
```

...最后是我的清单模板：

```
<#@ template debug="false" hostspecific="true" language="C#" #>
<#@ output extension=".xml" #>
<#@ include file="AppInfo.ttinclude" #>
<?xml version="1.0" encoding="utf-8"?>
<Deployment xmlns="http://schemas.microsoft.com/windowsphone/2009/deployment" AppPlatformVersion="7.0">
    <App xmlns="" ProductID="<#= id #>" Title="<#= product #>" RuntimeType="XNA" Version="<#= version #>" Genre="apps.games" Author="Gonzo" Description="<#= description #>" Publisher="<#= company #>">
    <IconPath IsRelative="true" IsResource="false">
    ...
  </App>
</Deployment> 
```

是否可以使用像我的（AppInfo）这样的类来填充清单模板？我不想重复在 AssemblyInfo.cs 中已经定义的常量，也就是说，我的想法是从那里查看发布我的 WP 应用程序所需的所有信息。

任何想法都会受到欢迎:-)

j3d

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T07:15:25.687

好吧，我的应用程序有两种不同的部署配置（精简版或专业版），对于每个配置，我都需要一个特定的 Guid、标题名称、版本等。我可以通过像这样修改 WMAppManifest.tt 来解决我的问题：

```
<#@ template debug="false" hostspecific="true" language="C#" #>
<#@ output extension=".xml" #>
<#@ assembly name="$(TargetPath)" #>
<?xml version="1.0" encoding="utf-8"?>
<Deployment xmlns="http://schemas.microsoft.com/windowsphone/2009/deployment" AppPlatformVersion="7.0">
    <App xmlns="" ProductID="<#= AppInfo.Id #>" Title="<#= AppInfo.Product + " " + AppInfo.Edition #>" RuntimeType="XNA" Version="<#= AppInfo.Version #>" Genre="apps.games" Author="Gonzo" Description="<#= AppInfo.Description #>" Publisher="<#= AppInfo.Company #>">
        ...
    </App>
</Deployment> 
```

在上面的代码片段中，我在程序集指令中指定了 $(TargetPath)（这指向我在 bin 目录中编译的程序集），最终我能够从 AssemblyInfo 中查看自定义属性。这样，我只定义了一次 Guid 和其他需要的数据 - 这是我的 AssemblyInfo 的一部分：

```
...
#if !LITE_EDITION
[assembly: Guid("716ab9de-f88e-9a14-8d81-65sn67dbf99e")]
[assembly: AssemblyEdition("Pro")]
#else
[assembly: Guid("91e6742f-6273-1a8b-55a69-e70ad5644827")]
[assembly: AssemblyEdition("Lite")]
#endif
... 
```

根据当前配置（例如 Debug、Debug Lite、Release、Release Lite），我会生成一个包含正确信息的应用清单。我希望这会有所帮助。

j3d

# c# - ReportViewer 2010 控件在单独的页面上打印表格的一部分或打印额外的空白页面

> ID：10323565
> 
> 赞同：0
> 
> 时间：2012-04-25T20:51:20.307
> 
> 标签：c#, reportviewer, report-viewer2010

我刚开始使用 ReportViewer 控件 VS2010（网络，本地）。
我的报告非常简单 - 4 列，都可以很好地显示在屏幕上。
当我单击“打印”按钮时，报告打印在 2 页上（一页 2 列，另一页 2 列）。
如果我更改页面上的边距，所有 4 页都打印在同一页上，但我仍然打印了第二个空白页。如果报告跨越多个页面（例如 2 页），边距更改我得到第一页，第二页为空，然后第三页正常，第四页为空。

任何建议如何使报告打印时没有空白页？谢谢你，珍妮

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T16:09:57.000

根据我的经验（这是一个痛苦的经历......），我发现如果报表打印额外的页面，这意味着在某个地方，您的子报表的页边距或页面大小（如果您正在使用）不等于8.5 X 11（或您使用的任何尺寸的纸张）。确保您的桌子（我假设这就是您正在使用的？）在一张纸的范围内。请记住，您需要在每一侧取一英寸（如果您使用 0.5 英寸边距 [每侧 0.5 英寸]）以将表格保持在一页上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-22T02:10:11.910

我遇到了同样的问题，m.webster 的回答对我来说是正确的。

检查报告 BODY 的 SIZE 属性是否在您的 REPORTs Pagesize 和 Margin 属性中。

就我而言，我将报告设置为 A4，报告的属性（单击设计的灰色区域）显示：PageSize：21cm，29.7cm。我建立了我的报告，但打印导致内容溢出到第二页。

当我打开 RULER 选项时，很明显我的报告 BODY（白色内容区域）比报告页面大小的 PageSize 更宽。

当我将 BODY 的 size->width 属性减小到 21cm（重新排列我的所有内容以允许调整大小之后）时，我发现我仍然遇到第二页问题。将报告边距快速更改为 0 即可解决此问题。

我遇到的最后一个空白问题是我的一些报告的末尾出现了一个空白页面。这是通过降低报告 BODY 的高度来解决的，这样我的内容之后就没有空格了。因为最初的报告正文出现在一个漂亮的纵向布局中，我以为它只是代表最后一页，但事实并非如此。

它对这个问题的回答有点晚了，但我添加它是为了节省其他人在使用这个稍微不直观的工具包时浪费的时间。

# c# - 更改 WPF 中的选定元素

> ID：10323571
> 
> 赞同：0
> 
> 时间：2012-04-25T20:51:34.230
> 
> 标签：c#, wpf, binding, mvvm, selection

我对 WPF 完全陌生。

我正在 MVVM 模式中制作一个简单的应用程序。

我有一个视图模型，其中引用了一个模型。该模型包含一些我想放入组合框中的网络元素。

这是视图模型的相关部分：

```
public class MainWindowVM : ViewModelBase
{
    private Model _model = null;

    public Model Model
    {
        get
        {
            return _model;
        }
    }

    #region ActiveElement

    private NetElement _activeElement = null;

    public NetElement ActiveElement
    {
        get
        {
            return _activeElement;
        }
        set
        {
            if (_activeElement != value)
            {
                _activeElement = value;
                RaisePropertyChanged("ActiveElement");
                if (ActiveElementChanged != null)
                    ActiveElementChanged(this, EventArgs.Empty);
            }
        }
    }
} 
```

我希望能够在组合框中选择一个 NetElement 并将 ActiveElement 设置为它。

这是我当前 XAML 的相关部分：

```
<ItemsControl Background="White" IsTabStop="True" ItemsSource="{Binding Path=Model.RootNet.Elements}">
    <ItemsControl.ItemTemplate>
        <DataTemplate>
            <TextBlock Margin="2,6">
            <Hyperlink Command="{Binding Path=I'm not able to figure out what to write here}">
              <TextBlock Text="{Binding Path=Name}" />
            </Hyperlink>
          </TextBlock>
        </DataTemplate>
    </ItemsControl.ItemTemplate>
</ItemsControl> 
```

这不是一个组合框，而是一个文本块列表，但您可以看到它的去向。

如何从视图中设置 ActiveElement？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T20:59:25.823

为 ComboBox 的 SelectedItem 属性创建一个绑定到您的 ActiveElement 属性：

```
 <ComboBox SelectedItem="{Binding Path=ActiveElement}" ... /> 
```

然后将视图的 DataContext 属性设置为您的视图模型。

# c# - 操作返回 ASP.Net MVC 后运行代码的风险

> ID：10323573
> 
> 赞同：0
> 
> 时间：2012-04-25T20:51:43.073
> 
> 标签：c#, asp.net-mvc, shared-hosting

我在共享主机上运行 MVC 3 应用程序，并且有一些页面需要大量处理，不应让用户等待。（例如：发送几百封带附件的邮件，在数据库中创建几千条记录。）

现在我不是在问如何实现这一目标，因为我知道如何实现，我想知道的是。如果我的应用程序正在执行操作 60 秒，它是否有停止的风险？

如果是这样，你能做些什么来防止它（知道应用程序不能完全信任地运行）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T21:33:42.127

由于您使用的是共享主机，您可能想查看[HostingEnvironment.IncreaseBusyCount](http://msdn.microsoft.com/en-us/library/system.web.hosting.hostingenvironment.incrementbusycount.aspx)和[DecreaseBusyCount](http://msdn.microsoft.com/en-us/library/system.web.hosting.hostingenvironment.decrementbusycount.aspx)。

您可能还想看看[HostingEnvironment.RegisterObject](http://msdn.microsoft.com/en-us/library/system.web.hosting.hostingenvironment.registerobject.aspx)，它可以让您有机会在应用程序停止之前取消正在发生的任何事情。

话虽如此，我没有尝试过任何这些，它们可能不是特别可靠。这篇[文章](http://haacked.com/archive/2011/10/16/the-dangers-of-implementing-recurring-background-tasks-in-asp-net.aspx)非常相关，为什么从站点内执行此操作不是一个好主意，但我知道你在这方面被困住了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T21:37:24.677

我为此使用了Task，例如

```
Task.Factory.StartNew(() => this.SendRequestApprovedNotification(requestId, 
    userName, 
    comments)); 
```

我遇到的一个问题是我天真地将请求对象传递给任务。不要这样做，而是复制出您需要的位并将其传递下来，因为当您可以使用请求对象时，管道可能已经处理了它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T21:22:33.403

您可以从 web.config 控制请求执行的持续时间：

```
 <location path="Controller/ProcessFile">
    <system.web>
      <httpRuntime executionTimeout="900" />
    </system.web>
  </location> 
```

executionTimeout - 允许的时间（以秒为单位）

但是，我在专用服务器上使用它，而不是共享主机。

# yii - 调用另一个控制器的动作

> ID：10323576
> 
> 赞同：3
> 
> 时间：2012-04-25T20:51:52.217
> 
> 标签：yii

我有一个网格视图，我想从另一个动作控制器获取列的值。现在我在控制器 1 中有这个

```
 array(
        'name'=>'title',
        'value'=>array($this,'Action2'),
    ), 
```

我得到这个错误：

```
controller1 and its behaviors do not have a method or closure named "Action2". 
```

如果我将 $this 替换为“controller2”

```
 array(
        'name'=>'title',
        'value'=>array('controller2','Action2'),
    ), 
```

我得到这个错误

```
call_user_func_array() [<a href='function.call-user-func-array'>function.call-user-func-array</a>]: First argument is expected to be a valid callback, 'controller2::action2' was given 
```

也许这是不好的做法，但这可行吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T23:07:50.473

以这种方式使用控制器操作是不好的做法。最好将您的代码放在模型的方法中。但如果你仍然想这样做，这里有一种方法：

```
'value' => function() {
    list($controller) = Yii::app()->createController('controllerId');
    return $controller->actionTest();
} 
```

这是另一个：

```
'value' => function() {
    $controller = new TestController('test');
    return $controller->actionTest();
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-02-08T04:55:13.913

您可以使用此解决方案：

```
Yii::app()->runController('category/view/id/1'); 
```

# java - Google Drive SDK - Java 示例不工作

> ID：10323579
> 
> 赞同：4
> 
> 时间：2012-04-25T20:52:04.987
> 
> 标签：java, google-drive-api

我正在尝试使用官方 Java 示例来熟悉 Google Drive API。但是，在浪费了几个小时并尝试设置样本两次之后，我仍然无法按预期使用它。

它不会显示文件的内容，而是在 FileServlet（/svc 路径）中引发 404 错误。更具体地说，`service.files().get(fileId).execute();`似乎返回 null。我已经直接从 Google Drive 以及使用 Google File Picker 尝试了不同的文件、不同的 MIME 类型。

我已经尽可能地遵循了[https://developers.google.com/drive/examples/java中描述的步骤。](https://developers.google.com/drive/examples/java)

有没有人能够让样本运行？

**编辑：** 这是请求 URL 时 FileServlet 的日志输出`/svc?file_id=0B08R9MrOE-ejZTY2M2I5MjAtYmVjZS00OTkyLWI4ZTEtOTg4OGM3YTIxMWEw`（第 78 行抛出 404 错误）：

```
2012-04-26 08:21:36.077
com.google.api.client.http.HttpRequest execute: -------------- REQUEST  --------------
GET https://www.googleapis.com/drive/v1/files/0B08R9MrOE-ejZTY2M2I5MjAtYmVjZS00OTkyLWI4ZTEtOTg4OGM3YTIxMWEw
Accept-Encoding: gzip
User-Agent: Google-HTTP-Java-Client/1.8.3-beta (gzip)

D 2012-04-26 08:21:36.263
com.google.api.client.http.HttpResponse <init>: -------------- RESPONSE --------------
403 OK
content-type: application/json; charset=UTF-8
content-encoding: gzip
date: Thu
date: 26 Apr 2012 06:21:36 GMT
expires: Thu
expires: 26 Apr 2012 06:21:36 GMT
cache-control: private
cache-control: max-age=0
x-content-type-options: nosniff
x-frame-options: SAMEORIGIN
x-xss-protection: 1; mode=block
content-length: 188
server: GSE
x-google-cache-control: remote-fetch
via: HTTP/1.1 GWA

D 2012-04-26 08:21:36.265
com.google.api.client.http.HttpResponse getContent: Response size: 188 bytes
D 2012-04-26 08:21:36.271
com.google.api.client.http.HttpResponse getContent: {
 "error": {
  "errors": [
   {
    "domain": "usageLimits",
    "reason": "dailyLimitExceededUnreg",
    "message": "Daily Limit Exceeded. Please sign up",
    "extendedHelp": "https://code.google.com/apis/console"
   }
  ],
  "code": 403,
  "message": "Daily Limit Exceeded. Please sign up"
 }
} 
```

这听起来很像“我不认识你”，所以我再次查看了我的客户端 ID 和客户端密码：我注意到 API 控制台中显示了两个客户端 ID 和客户端密码，一个“Web 应用程序的客户端 ID”和另一个“Drive SDK 的客户端 ID”。我以前用过那个用于 Web 应用程序，所以我尝试切换到用于 Drive SDK 的那个。不幸的是，这并没有改变任何东西。同样的错误...：/

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-26T07:57:29.980

根据您的日志，您的 404 错误似乎是由对 Drive API 的请求返回的 403 错误引起的。

来自 Google API 的错误通常在其正文中包含解释。在你的情况下：

```
"error": {
  "errors": [
   {
    "domain": "usageLimits",
    "reason": "dailyLimitExceededUnreg",
    "message": "Daily Limit Exceeded. Please sign up",
    "extendedHelp": "https://code.google.com/apis/console"
   }
  ],
  "code": 403,
  "message": "Daily Limit Exceeded. Please sign up"
 }
} 
```

这通常意味着您没有在您的 Google API 控制台项目上启用对 Google Drive API 的访问。为此：

*   [在Google API 控制台](http://code.google.com/apis/console/)中打开您的项目
*   转到**服务**部分
*   通过单击开/关切换启用**Drive SDK**和**Drive API**
*   不要忘记在**Drive SDK**部分配置您的应用，并在 **API Access" 部分配置您的 OAuth 设置

这一切都在我们文档的[开始 > 注册应用](https://developers.google.com/drive/register)部分中进行了描述。您还应该确保您阅读了**“入门**”的其他子部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T10:17:20.497

我最终设法让它工作。我不确定之前的问题是什么，但这里有一些提示给那些面临类似问题的人：

*   “Web 应用程序的客户端 ID”和“Drive SDK 的客户端 ID”让我感到困惑。不幸的是，文档并没有告诉您在哪个地方使用哪一个，但您似乎只需要“Web 应用程序的客户端 ID”。

*   如果您更新 Chrome 扩展程序或 API 控制台，则 Drive 可能需要一些时间才能识别这些更改。例如，在 API 控制台中更改 OAuth 客户端 ID 可能需要一些时间才能生效，因为每个人都在缓存。如果您正在测试您的应用程序，删除缓存和 cookie 有助于加快该过程。

祝你的申请好运，感谢所有帮助过我的人！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-20T14:31:10.887

根据我的经验，“403 Quota Exceeded”总是源于未设置 HTPP 授权标头。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-24T15:12:24.310

我将 Google 的 dredit 示例中分发的 java OAuth 代码用于通过“打开方式”流程并同样收到 403 错误的程序。

我不得不深入研究 OAuth 代码才能找到问题所在，关于 403 错误，我还没有在其他地方看到过问题的根源。本质上，CredentialMediator 的 ExchangeCode 方法假定只有一个重定向 uri，这是您希望访问的那个。这对我来说不是这种情况，并导致了 CodeExchangeException。

要解决此问题，您可以按摩 client_secrets 中的 uri 列表，以便您希望重定向到的 uri 是第一个或类似的，但如果此方法可以转到多个 uri 中的任何一个，则需要参数化。

我希望这可以帮助某人根除他们的 403 gremlin。

# git - 我的 git 存储库中的所有这些隐藏（'._' 前缀）文件是什么？

> ID：10323580
> 
> 赞同：15
> 
> 时间：2012-04-25T20:52:07.363
> 
> 标签：git

当我在我的目录上执行“git status”时，它会显示一堆似乎是重复的未跟踪文件。唯一的区别是它们都有前缀`._`。例如：我需要添加的未跟踪文件之一是... `app/assets/stylesheets/categories.css`，另一个文件将显示为`app/assets/stylesheets/._categories.css`.

有谁知道这是怎么一回事？GitHub 上似乎没有好的文档。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-25T20:54:20.923

如此[处所述](https://stackoverflow.com/a/600998/6309)：

> 如果对于文件 foo，您有另一个 ._foo，并且您在 Mac 上，则点下划线文件是保存文件资源叉/元数据的位置。

[（在“ DS_Store、点下划线 ( `._`)、资源分叉和恼人的 Windows 用户](http://www.routeofqueue.com/2008/05/ds_store-dot-underscore-_-resource-forks-and-annoyed-windows-users/)”中有更详细的描述）

> 该文件[`.DS_Store`](http://en.wikipedia.org/wiki/.DS_Store)类似于`thumbs.db`Windows XP 创建的文件，用于存储“文件夹的自定义属性，例如图标的位置或背景图像的选择。”</p>
> 
> [点下划线 ( `._`) 文件](http://en.wikipedia.org/wiki/Resource_fork)是讨厌的小虫子。似乎当您使用 Finder 将文件传输到非 Mac 系统（在这种情况下为 Windows Server）时，它会将文件分成两部分 - 数据和资源分叉。当您将文件复制回 Mac 时，Finder 会再次合并这两个位。Windows 不能使用资源分叉，所以不需要它，你可以删除它，但是要在其他人之后清理很麻烦！

另请参阅“[有什么方法可以防止 Mac 创建点下划线文件？](https://superuser.com/questions/212896/is-there-any-way-to-prevent-a-mac-from-creating-dot-underscore-files) ”

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-11-26T05:53:01.013

如果你更新你的全局`.gitignore`（在`C:/Users/user/.gitignore`你的用户主目录或任何地方），你可以添加这一行：

```
._* 
```

当您执行 a 时，它将阻止这些显示`git status`，并且它们不会通过添加`git add -A`。

这是我添加到我的，以防止各种操作系统将垃圾插入我们的存储库。

```
# OS generated files #
######################
.DS_Store?
ehthumbs.db
._*
# Icon?
Thumbs.db 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-25T20:54:16.967

`git` *它们与本身*无关；它们是 OS X 创建的元数据文件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-03-26T08:35:52.763

Mac 提供命令行命令，可从 App Store 免费下载命令行实用程序。这会清理 ._ 文件。命令是 $dot_clean

# php - PHP 问题我让它将数据从 DB 输出到表中，但是我需要用户输入才能插入

> ID：10323581
> 
> 赞同：0
> 
> 时间：2012-04-25T20:52:08.033
> 
> 标签：php, mysql, html, sql

我有一个表单页面，用户在其中输入一些数据，并在点击“提交”时在我们的数据库中执行一个查询，该查询会提取相关信息。

因此，用户在表单中输入了两件事：类名和时间。

之后，我们的 php 文件会拉出一个包含部分信息的表格。

例如：ENG 212 有两个部分：ENG212-001 和 ENG212-101。因此，在表格中，它包含有关该部分的信息，例如最大注册人数和位置等。它还显示了当前在该部分注册的人数。

现在我希望用户选择一个部分。如果最大注册人数为 10 且当前注册人数为 10 名学生，则用户无法选择。如果当前注册的人数 < 最大注册人数，则用户可以选择该部分。

因此，带有表单的 HTML 页面 --> 拉起表格的 php 文件 ---> 现在我需要一种方法让用户选择其中一个部分，但如果它们已满，我希望他们甚至无法选择它.

我正在考虑做单选按钮，但我不知道如何为这个特定场景实现它们

我该如何实施？我已经尝试在网上查找，但我不知道如何实现这一点。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T20:57:14.243

一个简单的`if`语句来评估类是否已满就可以了。

```
if($row['status'] == '1') {
    //Display code here
} else {
    //Display class is full message here
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T20:59:01.887

如果您只是试图不允许最终用户选择输入，请尝试使用 html [disabled](http://www.w3schools.com/tags/att_input_disabled.asp)属性。如果您确定要完整设置一个部分，则将您的输入法设置为禁用。您仍然需要在后端设置逻辑障碍。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T21:22:32.750

提交 HTML 表单并获得最大注册值后，在 PHP 中检查它并根据您获得的值从 PHP 中打印单选按钮。

```
if ($max_of_section_1>10) 
    echo "<input type='radio' disabled='disabled' value='Section01'/>Section 01";
else
    echo "<input type='radio'  value='Section01'/>Section 01";
if ($max_of_section_2>10) 
    echo "<input type='radio' disabled='disabled' value='Section02'/>Section 02";
else
    echo "<input type='radio'  value='Section02'/>Section 02"; 
```

# python - 创建一个有点像 borg 的类

> ID：10323582
> 
> 赞同：3
> 
> 时间：2012-04-25T20:52:08.440
> 
> 标签：python, design-patterns

我正在尝试制作一个类似博格的课程。我希望所有实例共享一个特定属性，但我希望其他属性对实例是唯一的。这是我到目前为止所拥有的：

```
class SharedFacility:
  _facility = None

  def __init__(self):
    entries = {'facility': self._facility}
    self.__dict__.update(entries) 

  def _getfacility(self):
    return self._facility

  def _setfacility(self, value):
    self._facility = value

  facility = property(_getfacility, _setfacility)

class Warning(SharedFacility):
  def __init__(self, warnlevel, warntext):
    SharedFacility.__init__(self)
    print "Warning.__init__()"
    self.warntext = warntext
    self.warnlevel = warnlevel

  def __call__(self):
    self.facility(self.warnlevel, self.warntext)

def functionOne(a,b):
  print 'functionOne: a=%s, b=%s' % (a,b)

def functionTwo(a,b):
  print 'functionTwo: a=%s, b=%s' % (a,b)

####################################################
w1 = Warning(1, 'something bad happened')
w1.facility = functionOne
w2 = Warning(5, 'something else bad happened')
import pdb; pdb.set_trace()

if w1.facility is w2.facility:
  print "They match!"

w1() # functionOne: a=1, b='something bad happened'
w2() # functionOne: a=5, b='something else bad happened'

w2.facility = functionTwo
if w1.facility is w2.facility:
  print "They match!"

w1() # functionTwo: a=1, b='something bad happened'
w2() # functionTwo: a=5, b='something else bad happened' 
```

上面的代码不起作用。我希望 w1.facility 和 w2.facility 是对同一个对象的引用，但是 w1.warntext 和 w2.warntext 两个是两个不同的值。我正在使用 python 2.4.3 （没有意义提到我升级，因为我不能）。

**解决方案**：

```
class Warning(object):
  _facility = None

  def __init__(self, warnlevel, warntext):
    print "Warning.__init__()"
    self._warntext = warntext
    self._warnlevel = warnlevel

  def __call__(self):
    Warning._facility(self._warnlevel, self._warntext)

  def _getfacility(self):
    return Warning._facility

  def _setfacility(self, value):
    Warning._facility = value

  facility = property(_getfacility, _setfacility)

@staticmethod
def functionOne(a,b):
  print 'functionOne: a=%s, b=%s' % (a,b)

@staticmethod
def functionTwo(a,b):
  print 'functionTwo: a=%s, b=%s' % (a,b) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-25T21:07:56.233

这是我要做的：

```
class BorgLike:
    _shared = 'default'
    def __init__(self, unique):
        self.unique = unique
    @property
    def shared(self):
        return BorgLike._shared
    @shared.setter
    def shared(self, value):
        BorgLike._shared = value 
```

我希望你知道如何将这个例子用于你自己的目的。我不确定你想要你的代码是什么，所以我避免猜测并写了一个最小的例子。

# c++ - C++ 默认参数错误

> ID：10323587
> 
> 赞同：8
> 
> 时间：2012-04-25T20:52:27.083
> 
> 标签：c++, default-arguments

知道为什么在编译时会出现此错误吗？

```
ComplexNumber.cpp:21: error: default argument given for parameter 1 of ‘void ComplexNumber::print(std::ostream&) const’
ComplexNumber.h:17: error: after previous specification in ‘void ComplexNumber::print(std::ostream&) const’ 
```

这是我在这些特定区域的代码：

复数.cpp

```
21    void ComplexNumber::print(ostream & out = cout) const { 
```

复数.h

```
17    void print(ostream & out = cout) const; 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-04-25T20:53:13.050

您应该只在函数声明中指定默认参数，即在标题中。你的实现应该是这样的：

```
void ComplexNumber::print(ostream & out) const { ..... } 
```

# oracle - Hibernate SequenceGenerator 返回不正确的 nextval

> ID：10323589
> 
> 赞同：3
> 
> 时间：2012-04-25T20:52:50.360
> 
> 标签：oracle, hibernate, sequence-generators

这是我关于休眠的第二篇文章。自从我开始使用 hibernate 以来，它带来的问题比它解决的问题还多。这几乎让我觉得我应该坚持使用普通的旧 JDBC。反正，

这是我试图解决的问题之一。

我在 .hbm 文件中的序列生成器如下所示。

```
<id name="id" type="long" column="ID">
    <generator class="sequence">
        <param name="sequence">ADVENTURES_ID_SEQ</param>
        <param name="allocationSize">1</param>
        <param name="initialValue">17599</param>
    </generator>
</id> 
```

请注意：初始值为 17599。这是因为 oracle 序列中的 LAST_NUMBER 为：17599

```
CREATED         25-APR-12
LAST_DDL_TIME   25-APR-12
SEQUENCE_OWNER  ADVENTURE_ADMIN
SEQUENCE_NAME   ADVENTURES_ID_SEQ
MIN_VALUE       1
MAX_VALUE       9999999999999999999999999999
INCREMENT_BY    1
CYCLE_FLAG      N
ORDER_FLAG      N
CACHE_SIZE      20
LAST_NUMBER     17599 
```

当我运行代码时，我看到在 Hibernate Debug 语句中生成的下一个序列为 200、201。

```
DEBUG SQL - select ADVENTURES_ID_SEQ.nextval from dual
DEBUG SequenceGenerator - Sequence identifier generated: 201 
```

我预计 nextval 应该是 17600。似乎 oracle 序列根本没有被使用。

我的配置有什么问题以及如何修复它。任何帮助是极大的赞赏。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T21:35:00.283

自我回答（解决方法）：我仍然看到问题，但现在我有一个解决方法。因为它对我有用，所以我选择这个问题是完整的。

我让 Oracle 使用 Trigger 生成 nextId：

```
create or replace
TRIGGER ADVENTURE_ADMIN.ADVENTURES_ID_TRIG 
BEFORE INSERT ON ADVENTURE_ADMIN.ADVENTURES FOR EACH ROW
WHEN (new.ID IS NULL)
BEGIN
    SELECT ADVENTURES_ID_SEQ.NEXTVAL INTO :new.ID FROM DUAL;  
END; 
```

然后我让休眠使用 Oracle 触发器生成的 ID。有两种方法可以做到这一点。

**首先**是使用 Hibernate [select](http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/mapping.html#mapping-declaration-id)。这种方法的缺点是您将需要表中具有唯一约束的另一列，hibernate 将其用作获取行的键。它对我来说真的不起作用，因为我有以主键作为唯一唯一键的表。

**其次**是使用由 Jean-Pol Landrain、Martin Zeltner 创建的 TriggerAssignedIdentityGenerator。来源可以在[这里](https://el4j.svn.sourceforge.net/svnroot/el4j/branches/el4j_3_1/el4j/framework/modules/hibernate/src/main/java/ch/elca/el4j/services/persistence/hibernate/TriggerAssignedIdentityGenerator.java)找到。这使我能够解决为表找到另一个唯一键的问题。

以下是我如何使用它：

```
<id name="id" type="long" column="ID">
    <generator class="org.hibernate.id.TriggerAssignedIdentityGenerator" />
</id> 
```

请注意：您使用的 Hibernate 版本很重要。我正在使用 3.5.4。休眠 3.6 对我不起作用。JDBC 和 Oracle 驱动程序版本也很重要。您可以参考源文件中的文档。

# php - Apache Benchmarks 真的很糟糕，有什么建议吗？

> ID：10323590
> 
> 赞同：0
> 
> 时间：2012-04-25T20:52:50.500
> 
> 标签：php, apache, windows-server-2008, apachebench

使用 Apache Bench，我网站的主页每秒只能处理 0.42 个请求。一个简单的 phpinfo() 页面每秒可以处理 31.99 个请求，对于这样一个简单的脚本来说，这似乎真的很慢。显然我的主页处理 0.42 个请求是不可接受的。

我在 Windows Server 2008 上运行 Apache 2.2。4 GB RAM，2.4 GHz Intel Xeon CPU。

该站点建立在带有 MySQL 数据库的 PHP CMS 表达式引擎上。Expression Engine 具有非常积极的页面缓存，因此主页对于所有意图和目的都是静态的（正在进行一些处理，但最终只是将静态文件存储在硬盘上）。我也打开了 SQL 缓存（分配了 200 mb）。页面不缓存的时候，首页有84个查询，看起来也不算太疯狂。

任何人对我如何使这件事运行得更好有任何明显的想法吗？我应该检查某种 php.ini、my.ini 或 httpd.conf 设置吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T20:59:59.703

您可以使用反向代理，例如[Varnish](https://www.varnish-cache.org/)，因为最快的应用程序是未执行的应用程序。尤其是[ESI-Support](https://www.varnish-cache.org/trac/wiki/ESIfeatures)非常酷，可以加速高度动态的页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T22:20:33.820

可以说是很可怜了。在我坐的机器上，我使用 ab -c 30 -n 1000 [http://localhost/phpinfo.php](http://localhost/phpinfo.php)获得 42 页/秒，这是一台更基本的机器，它也可以做很多其他的事情。虽然它正在运行 Linux ;)

你确定瓶颈是PHP吗？如果是这样，请尝试使用[操作码缓存](http://en.wikipedia.org/wiki/List_of_PHP_accelerators)。除此之外，这是通常的调整过程。

> 主页上有84个查询，看起来并不太疯狂。

我的天啊！也许不在你的星球上。如果您期望任何流量，那么您应该查看 ESI 帧。

# c# - 在 LINQ/C# 中保存对象时的问题

> ID：10323600
> 
> 赞同：0
> 
> 时间：2012-04-25T20:53:21.890
> 
> 标签：c#, linq

在 LINQ/C# 中保存对象时出现问题

当我尝试保存新记录时，出现此错误：

```
Cannot insert the value NULL into column 'EmpresaID', table 'mydb.dbo.Empresa'; column does not allow nulls. INSERT fails.
The statement has been terminated. 
```

使用 SQL Server Management Studio 2012 制作表格

```
USE [mydb]
GO

/****** Object:  Table [dbo].[Empresa]    Script Date: 25/04/2012 03:40:00 p.m. ******/
DROP TABLE [dbo].[Empresa]
GO

/****** Object:  Table [dbo].[Empresa]    Script Date: 25/04/2012 03:40:00 p.m. ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[Empresa](
    [EmpresaID] [int] NOT NULL,
    [RazonSocial] [nvarchar](210) NOT NULL,
    [Nit] [nchar](20) NOT NULL,
 CONSTRAINT [PK_Empresa] PRIMARY KEY CLUSTERED 
(
    [EmpresaID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO 
```

我做了一个处理数据的类

```
[Table(Name = "Empresa")]
class Empresa
{
    private int _EmpresaID;
    private string _RazonSocial;
    private string _Nit;

    [Column(DbType = "int", IsPrimaryKey = true, IsDbGenerated = true)]
    public int EmpresaID
    {
        set { _EmpresaID = value; }
        get { return _EmpresaID; }
    }

    [Column(DbType = "nvarchar(210)", CanBeNull = false)]
    public string RazonSocial
    {
        set { _RazonSocial = value; }
        get { return _RazonSocial; }
    }

    [Column(DbType = "nchar(20)", CanBeNull = false)]
    public string Nit
    {
        set { _Nit = value; }
        get { return _Nit; }
    }

} 
```

制作，这是哪种方法：

```
Entity.Empresa empresa = new Entity.Empresa() {                
    Nit = NuevaEmpresaNitTxtBox.Text,
    RazonSocial = NuevaEmpresaRazonSocialTxtBox.Text
};

MyDataContext.GetTable<Entity.Empresa>().InsertOnSubmit(empresa);
MyDataContext.SubmitChanges(); 
```

## 可以告诉我对我的代码有影响吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T20:58:22.050

您忘记在 EmpressaId 上声明身份。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T20:58:40.237

您的映射说`EmpresaID`是由数据库 ( `IsDbGenerated = true`) 生成的，但是表定义不会为关联的表生成 id。

您可能希望将 EmpresaID 的列类型更改为`IDENTITY`以便生成主键值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T20:59:46.047

您没有设置 EmpresaID。

在您的代码中明确设置它，或者更改您的 SQL TABLE 以将 IDENTITY 添加到您的 EmpresaID 列。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-25T21:00:32.853

你永远不会为你的主键提供一个 ID。有两种解决方案：

*   从您的代码中给它一个明确的 ID（您需要确保它始终是唯一的）
*   在 [EmpresaID] [int] NOT NULL 行上添加关键字 IDENTITY 以使您的 id 字段成为一个 INT IDENTITY，该字段将在每次插入时分配一个唯一值。

# iphone - 从另一个类 (MFMailComposeViewController) 呈现模式视图

> ID：10323605
> 
> 赞同：1
> 
> 时间：2012-04-25T20:53:39.690
> 
> 标签：iphone, ios

我正在尝试创建一个负责使用 MFMailComposeViewController 发送电子邮件的类，以便我可以从我的应用程序中的差异视图控件中使用此方法。

这个类称为 apoio。

在这个类中有下面的方法。

```
-(void) enviarGraficoPorEmail: (NSData*) _pdfGrafico {

if (![MFMailComposeViewController canSendMail]) {
    // show message box for user that SMS cannot be sent
} else {
    MFMailComposeViewController *picker = [[MFMailComposeViewController alloc] init];
    picker.mailComposeDelegate = self;
    [picker setSubject:@"Dashboard"];

    [picker addAttachmentData:_pdfGrafico mimeType:@"application/pdf" fileName:@"grafico.pdf"];

    NSString *emailBody = @"Anexando gráfico";
    [picker setMessageBody:emailBody isHTML:NO];        

     [self presentModalViewController:picker animated:YES];         
       }
} 
```

我有另一个视图控制器，它在用户单击电子邮件按钮时调用 apoio 方法。就是下面这段代码

```
-(IBAction) enviarGraficoPorEmail {

Apoio *apoio = [[Apoio alloc] init];
[apoio enviarGraficoPorEmail:[barChart dataForPDFRepresentationOfLayer]];
} 
```

但我不知道为什么，电子邮件视图没有出现。该方法被称为正确的，因为我调试过等等。

如果我将代码从 apoio 方法复制到 enviarGraficoPorEmail 方法，则一切正常。

但我不想这样做，因为我会从其他视图控制器发送电子邮件。

我究竟做错了什么 ？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T00:06:26.493

你可以用几种不同的方式来做。

选项1：将调用视图控制器作为参数传递给类方法

```
-(IBAction) enviarGraficoPorEmail {
Apoio *apoio = [[Apoio alloc] init];
[apoio enviarGraficoPorEmail:[barChart dataForPDFRepresentationOfLayer] callingController:self];
}

-(void) enviarGraficoPorEmail: (NSData*) _pdfGrafico callingController:(UIViewController*)_callingController {
...
[_callingController presentModalViewController:picker animated:YES];
...
} 
```

选项 2：为调用视图控制器添加类变量

```
-(IBAction) enviarGraficoPorEmail {
Apoio *apoio = [[Apoio alloc] init];
apoio.callingController = self;
[apoio enviarGraficoPorEmail:[barChart dataForPDFRepresentationOfLayer]];
}

-(void) enviarGraficoPorEmail: (NSData*) _pdfGrafico callingController:(UIViewController*)_callingController {
...
[callingController presentModalViewController:picker animated:YES];
...
} 
```

然后你将callingController作为一个retain属性添加到你的类中，将它初始化为nil，然后在dealloc中释放它。

选项 #1 可能是满足您需求的更好方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T13:33:30.483

非常感谢！。它现在正在工作，但我仍然有一个问题。

我的泛型类上有该方法，该方法应该负责隐藏mailController。

```
- (void)mailComposeController:(MFMailComposeViewController*)controller      didFinishWithResult:(MFMailComposeResult)result error:(NSError*)error 
{
switch (result)
{
    case MFMailComposeResultCancelled:
        break;
    case MFMailComposeResultSaved:
        break;
    case MFMailComposeResultSent:
        // FAILS
        [self.parentViewController dismissModalViewControllerAnimated:YES];
        break;
    case MFMailComposeResultFailed:
        break;
    default:
        break;
}
[self dismissModalViewControllerAnimated:YES];
} 
```

在创建 mailController 的方法中具有属性

```
picker.mailComposeDelegate = self; 
```

我试图改变为

```
picker.mailComposeDelegate = _callingController.self; 
```

我已经在我的泛型类上设置了 MFMailComposeViewControllerDelegate。

但它仅在我复制方法 didFinishWithResult 并将其放在源控制器上时才有效，这不是我的意图，因为我想将所有这些代码放在通用类上。

我究竟做错了什么 ？？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-26T19:30:17.837

好的，这是您第二个问题的答案（您将其作为第一个问题的答案发布）。

以下是我将如何设置它：

在您的调用视图控制器 .h 文件中：

```
@interface MyViewController : UIViewController <MyMailDelegate> {
    Apoio *apoio;
} 
```

在您的调用视图控制器 .m 文件中：

```
-(IBAction) enviarGraficoPorEmail {
    apoio = [[Apoio alloc] init];
    apoio.callingController = self;
   [apoio enviarGraficoPorEmail:[barChart dataForPDFRepresentationOfLayer]];
}

-(void) enviarCompleto {
    //do whatever here after send email completes
    [apoio release];
} 
```

在您的 Apoio .h 文件中

```
@protocol MyMailDelegate
@required
-(void) enviarCompleto;
@end

@interface OfferObject : NSObject {
    UIViewController <MyMailDelegate> *callingController;
}

@property (nonatomic, retain) UIViewController <MyMailDelegate> *callingController; 
```

在您的 Apoio .m 文件中

```
-(void) enviarGraficoPorEmail: (NSData*) _pdfGrafico callingController:(UIViewController*)_callingController {
    ...
    [callingController presentModalViewController:picker animated:YES];
    ...
}

-(void)mailComposeController:(MFMailComposeViewController*)controller      didFinishWithResult:(MFMailComposeResult)result error:(NSError*)error 
{
    switch (result)
        {
            ...
        }
    [callingController dismissModalViewControllerAnimated:YES];
    [callingController enviarCompleto];
} 
```

然后不要忘记在 init 上执行此操作：

```
callingController = nil; 
```

在dealloc上：

```
[callingController release]; 
```

另外，不要忘记您最重要的一步：对我的两个答案都投赞成票:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-25T21:11:06.387

你需要调用 [self presentModalViewController:picker animated:YES];
从 UIViewController 类，然后它会向您显示电子邮件编写器，您可以这样做，每当您从某个视图控制器调用时，您都可以传递它的引用，您可以将上面的行更改为

[callingController presentModalViewController:picker animated:YES];

# javascript - 简化代码

> ID：10323608
> 
> 赞同：3
> 
> 时间：2012-04-25T20:53:49.523
> 
> 标签：javascript, dom

我的代码有点长，我认为有一种方法可以简化它，看看它：

```
var slidernav = document.getElementsByTagName('li');
slidernavinital = 20;
slidernavadd = 30;
slidernav[0].style.top = slidernavinital + slidernavadd*0 + 'px';
slidernav[1].style.top = slidernavinital + slidernavadd*1 + 'px';
slidernav[2].style.top = slidernavinital + slidernavadd*2 + 'px';
slidernav[3].style.top = slidernavinital + slidernavadd*3 + 'px';
slidernav[4].style.top = slidernavinital + slidernavadd*4 + 'px';
slidernav[5].style.top = slidernavinital + slidernavadd*5 + 'px';
slidernav[6].style.top = slidernavinital + slidernavadd*6 + 'px';
slidernav[7].style.top = slidernavinital + slidernavadd*7 + 'px';
slidernav[8].style.top = slidernavinital + slidernavadd*8 + 'px';
slidernav[9].style.top = slidernavinital + slidernavadd*9 + 'px';
slidernav[10].style.top = slidernavinital + slidernavadd*10 + 'px';
slidernav[11].style.top = slidernavinital + slidernavadd*11 + 'px'; 
```

不可能做这样的事情：

```
document.getElementsByTagName('li')[x].style.top = 20 + 30*x + 'px'; 
```

提前非常感谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T20:57:28.483

是的。将其包裹在一个`for`循环中。

```
for(var i = 0; i < sliderNav.length; i++) {
    sliderNav[i].style.top = sliderNavInitial + sliderNavAdd*i + "px";
} 
```

但是，如果您不了解循环，我认为您应该选择一本 Intro to Programming 一书（如果计算机不为您处理重复的内容，那它还有什么意义？）

编辑：顺便说一句，`for`循环是以下`while`循环结构的简写：

```
var i = 0;
while(i < sliderNav.length) {
    sliderNav[i].style.top = sliderNavInitial + sliderNavAdd*i + "px";
    i++;
} 
```

它只是将所有“簿记”放在循环的第一行，因此您可以更轻松地预测它将循环多少次。（while 循环只会循环直到满足条件，然后停止，因此如果您忘记包含该`i++;`部分，它将永远不会停止。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T20:59:22.167

使用循环循环遍历元素。

```
var slidernav = document.getElementsByTagName('li');
slidernavinital = 20;
slidernavadd = 30;
for (var n = 0; n<slidernav.length; n++) {
    slidernav[n].style.top = slidernavinital + slidernavadd*n + 'px';
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T20:59:16.483

你可以使用 for

像这样

```
var ln = slidernav.length;
for(var i = 1;i<=ln;i++)
{
    slidernav[i].style.top = slidernavinital + slidernavadd*i + 'px';
} 
```

它是一个非常简单的编程结构。

# iphone - 如何在表格中间初始化一个 UITableView

> ID：10323609
> 
> 赞同：2
> 
> 时间：2012-04-25T20:53:51.733
> 
> 标签：iphone, ios, uitableview

如何初始化 UITableView 以便它开始在表格中间显示（我选择的）内容，而不是顶部的内容？我希望表格中的某个单元格始终从屏幕顶部开始，因此您可以从那里向上或向下滚动。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T21:01:05.967

[`- (void)scrollToRowAtIndexPath:(NSIndexPath *)indexPath atScrollPosition:(UITableViewScrollPosition)scrollPosition animated:(BOOL)animated`](http://developer.apple.com/library/ios/#documentation/uikit/reference/UITableView_Class/Reference/Reference.html#//apple_ref/occ/instm/UITableView/scrollToRowAtIndexPath%3aatScrollPosition%3aanimated%3a)您可以通过发送到表格视图滚动到某个单元格。

正如您所描述的，您希望您选择的单元格出现在“表格中间”，因此您应该使用`UITableViewScrollPositionMiddle`scrollPosition 参数。

如果您在表格初始化后立即执行此操作，或者在您的视图加载动画参数设置为时立即执行此操作，`NO`则表格视图将出现在中间，您的单元格位于中间，正如您所描述的那样。

* * *

您还写道：“我希望表格中的某个单元格始终从屏幕顶部开始”。

通过选择该单元格和 scrollPosition `UITableViewScrollPositionTop`，您可以使该单元格位于表格视图的顶部。

# javascript - Javascript通过变量设置变量名

> ID：10323616
> 
> 赞同：0
> 
> 时间：2012-04-25T20:54:24.633
> 
> 标签：javascript, variables

> **可能重复：**
> [Javascript 变量变量](https://stackoverflow.com/questions/592862/javascript-variable-variables)

请看下面的代码

```
var selected_id=1;   
resetVar("selected");

function resetVar(foo){
 foo+"_id"=0; // I want to set selected_id into 0
}​​​​​ 
```

那可能吗？有什么建议吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-25T20:56:57.597

如果您的变量是全局变量，那么它们是`window`对象的隐式属性，您可以将它们作为`window`对象的属性引用，如下所示：

```
function resetVar(foo){
    window[foo + "_id"] = 0; 
}​​​​​

var selected_id = 1;   
resetVar("selected"); 
```

如果您的变量不是全局变量，那么您将需要使它们成为某个已知对象的属性，以便您可以使用相同的技术。

一般来说，这通常是一个糟糕的编程想法，我们经常看到这个问题，哪里有更好的方法来处理这种情况。您没有透露整体情况，因此我们无法提供非常具体的建议，但您通常应该直接使用已知对象的属性，或者您应该使用数组来保存数组中的多个相关值，或者您应该只是直接引用变量。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-25T20:56:14.610

如果 selected 是全局变量：

```
function resetVar(foo){
    window[foo+"_id"] = 0;
}​​​​​ 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-25T20:56:51.117

您可以在拥有该方法的对象（在您的情况下为全局对象）上使用[方括号表示法](http://www.jibbering.com/faq/faq_notes/square_brackets.html)调用函数。`window`

`window['selected_id'] = value`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-25T20:56:18.053

这是初学者经常提出的“解决方案”（这不是坏事，每个人都从某个地方开始）。答案是; 不要那样做，使用数组（或其他集合）。

使用变量名来确定程序逻辑是一个糟糕的想法，这将不可避免地导致混乱、无法维护的代码。更改变量的名称不应更改程序的逻辑。取而代之的是，将对象分组到一个集合中，如果需要，可以使用集合中的键，或者简单地使用索引。

# sql - 更新了 SQL 条件插入

> ID：10323619
> 
> 赞同：0
> 
> 时间：2012-04-25T20:54:38.550
> 
> 标签：sql, insert, sql-server-2008-r2

我有一种情况，我需要将数据从 table1 插入 table2。在插入之前检查 table2 中是否已经存在某一行，如果存在则只需更新该行的 col2、col4。如果它不存在，则插入一个新行。

我正在使用 SQLSERVER 2008 R2。我怎么能做到这一点？

现在情况发生了一些变化。我需要这样的东西。

```
DECLARE @table1 TABLE 
(id int not null, ahccs int not null, info varchar(25), flag varchar(2))
DECLARE @table2 TABLE 
(id int not null, ahccs int not null, info varchar(25), flag varchar(2))

INSERT INTO @table1
VALUES(1, 1223, 'et', 'X')
INSERT INTO @table1
VALUES(2, 321, 'et', 'X')
INSERT INTO @table1
VALUES(3, 134, 'et', 'X' )
INSERT INTO @table1
VALUES(4, 168, 'et', 'X' )
INSERT INTO @table1
VALUES(5, 123, 'et', 'X' )

INSERT INTO @table2
VALUES(1, 1223, 'dt', 'y' )
INSERT INTO @table2
VALUES(2, 456, 'dt', 'y' )
INSERT INTO @table2
VALUES(3, 123, 'dt', 'y' )
INSERT INTO @table2
VALUES(4, 193, 'dt', 'y' )
--SELECT * FROM @table1

SELECT * FROM @table2

MERGE
INTO    @table2 t2
USING   @table1 t1
ON      t2.id = t1.id or t2.ahccs = t1.ahccs
WHEN NOT MATCHED THEN
UPDATE
SET     flag = 'z'
INSERT VALUES (100, t1.ahccs, t1.info, 'l'); 
```

我遇到的两个问题是：1）我相信合并不支持多个步骤。2) WHEN NOT MATCHED 情况下不允许更新。

请指教。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T20:59:39.857

您需要使用[merge](http://technet.microsoft.com/en-us/library/bb510625.aspx)，它可以让您将尝试更新或插入的数据（“upsert”）与表中当前的数据进行匹配，并根据匹配的存在与否执行不同的操作。

```
MERGE Stock S
USING Trades T ON S.Stock = T.Stock
WHEN MATCHED THEN
    UPDATE SET Qty += Delta
WHEN NOT MATCHED THEN
    INSERT VALUES (Stock, Delta); 
```

这个例子来自[这里](http://sqlserverperformance.wordpress.com/2007/07/13/more-merge-examples-in-sql-server-2008/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T20:59:00.833

```
MERGE
INTO    table2 t2
USING   table1 t1
ON      t2.id = t1.t2_id
WHEN NOT MATCHED THEN
INSERT  
VALUES  (t1.col1, t1.col2, ...)
WHEN MATCHED THEN
UPDATE
SET     col2 = t1.col2,
        col4 = t1.col4 
```

# javascript - SharePoint 2010 更改要求字段

> ID：10323621
> 
> 赞同：0
> 
> 时间：2012-04-25T20:54:40.807
> 
> 标签：javascript, jquery, sharepoint, sharepoint-2010

我已将以下代码添加到 SharePoint 页面 - 代码根据**标题查找请求的****选择，并在选择“** **Decision** ”**值**时发出警报。

 ******希望删除警报并替换为找到特定**选择**（title$=test）并将其更改为强制/必需的代码。

你对 SP2010 怎么看？

```
<script type="text/javascript" src="/Deploy/jquery.min.js"></script>
<script type="text/javascript" src="/Deploy/jquery.SPServices-0.7.1a.min.js"></script>

<script type="text/javascript">
$(document).ready(function() {
    $("select[title$='Based on']").change(function() {
        var text = $("select[title$='Based on'] :selected").text();
        if (text == "Decision") {
            alert('you must provide reason for suspending this order');
        }
     });
});
</script> 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T21:09:55.173

如果您想对表单字段进行验证，最好的`PreSaveAction`办法是按照Giles Hamson 的这篇[文章挂钩该方法。](http://ghamson.wordpress.com/2011/01/25/useful-javascript-function-presaveaction-sp2010-sharepoint-ps2010-projectserver-in/)在您的更改事件中，您可以执行以下操作以根据需要标记您的字段：

```
$("select[title$='test']").attr('required','true'); 
```

然后，在您的`PreSaveAction`方法中，您可以检查是否需要下拉列表以及它是否具有值。使用它，您可以允许保存继续，或者您可以停止它并显示验证错误。

```
function PreSaveAction() 
{
    var dropdown = $("select[title$='test']");

    if(dropdown.attr('required') == 'true' && dropdown.val() == "")
    {
        alert("The field 'test' is required'");
        return false;
    }

    return true;
} 
```******

# java - Java API 设计 - 内部设计

> ID：10323622
> 
> 赞同：7
> 
> 时间：2012-04-25T20:54:43.050
> 
> 标签：java, api

我正在制作我的第一个 API，它可以从网站获取数据并解析它。所以里面有很多网络和解析。我读到 API 有一个不应该公开的内部包；就像在 Javadocs 中一样。所以我的问题是什么应该和不应该放在内部包中。这是我的包装设计，我忽略了不重要的。

```
.networkstats
.networkstats.model
.networkstats.parser 
```

包里面`networkstats`有一个类叫做`NetworkStats`. 这是处理和检索所有网络连接的主要类。然后它使用`parser`包内的类来处理数据。在它返回一个保存包内数据的模型类之后`model`。我想包含内部包，因为会有一些类和接口不打算由用户使用。

例如，我想让一个类处理所有网络连接，以便其他类`NetworkStats`可以访问它。我想这样做的原因是因为我不想在其他类中复制代码，因为它可以在一个地方。当然我不希望其他用户使用这个类，所以我会把它放在内部包中？我也会把我的`parser`包裹放在内部的。所以我的主要问题是，您是否将不打算公开使用的类和接口放在内部包中？我知道他们仍然*可以*访问它。

```
.networkStats.internal.DataManager // class that handles network connections
.networkStats.internal.parser 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-25T21:24:14.543

您可能会发现此 Java API 设计清单很有帮助。第一部分是关于包装设计。

[http://theamiableapi.com/2012/01/16/java-api-design-checklist/](http://theamiableapi.com/2012/01/16/java-api-design-checklist/)

费伦茨

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-25T20:59:48.807

首先我想说的是子包和其他包一样，普通java中没有私有包这样的东西，如果你想要那种功能，你必须使用OSGi

也就是说，如果您想保护类不被访问，只需删除类名上的 public，只保留“API”类，即您的用户将访问的类（将用户称为使用框架）。

您创建的包越多，您必须公开的“私有功能”就越多。

# c# - C# - 计算多个文件的总统计数据

> ID：10323623
> 
> 赞同：2
> 
> 时间：2012-04-25T20:54:44.947
> 
> 标签：c#, linq, file, parsing

这是我之前问过的一个类似问题，不同之处在于我正在获取多个文件并计算这些文件的总和。我已经到了从特定目录读取所有文件的地步，但由于某种原因，它没有正确分组。

这是我拥有的代码：

```
public void CalculateMonthlyStatistics(string monthlyFiles)
        {
            string monthlyFileName = monthlyFiles + ".log";

            var statistics = File.ReadLines(monthlyFileName)

            .GroupBy(items => items[0])
            .Select(g =>
            new
            {

                Division = g.Key,
                ZipFiles = g.Sum(i => Convert.ToInt32(i[1])),
                Conversions = g.Sum(i => Convert.ToInt32(i[2])),
                ReturnedFiles = g.Sum(i => Convert.ToInt32(i[3])),
                TotalEmails = g.Sum(i => Convert.ToInt32(i[4]))
            });

            statistics
               .ToList()
               .ForEach(d => Console.WriteLine("{0}\t{1}\t{2}\t{3}\t{4}", 
                        d.Division, 
                        d.ZipFiles, 
                        d.Conversions, 
                        d.ReturnedFiles,  
                        d.TotalEmails));
               Console.Read();
               //.ForEach(d => Log.Open(tempFileName.TrimEnd(charsToTrim), d.Division, d.ZipFiles, d.Conversions, d.ReturnedFiles, d.TotalEmails));
        }
    }
} 
```

我放入其中的日志文件如下所示：

```
 Division   Zip Files   Conversions Returned Files  Total E-Mails   
Corporate   0   5   0   5   
Energy  0   1   0   5   
Global Operations   0   3   0   3   
Oil & Gas   1   5   0   5   
Capital 5   18  0   12 
```

所以我想做的是按“公司”、“能源”等分组。然后计算所有正在读取的文件的总数，以创建一个月度统计文件。我目前正在获取总数，但是我认为它与我传入的标题有关，我不知道如何告诉它跳过该行。

提前致谢

**编辑**

这是我的处理器，它最初读取目录等。

```
public void ProcessMonthlyLogFiles()
    {
        DateTime currentTime = DateTime.Now;

        int month = currentTime.Month - 1;
        int year = currentTime.Year;

        string path = Path.GetDirectoryName(Settings.DailyPath + year + @"\" + month + @"\");

        foreach (string monthlyFileNames in Directory.GetFiles(path))
        {
            string monthlyFiles = path + @"\" + Path.GetFileNameWithoutExtension(monthlyFileNames);
            new MonthlyReader().CalculateMonthlyStatistics(monthlyFiles);
        }
    } 
```

处理器找到适当的目录进行搜索，以便从中获取文件。它使用当前日期，并找到上个月。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T21:31:12.110

跳过标题很简单：

`File.ReadLines(monthlyFileName).Skip(1).<rest of your chain>`

但是，当您想读取所有文件然后计算统计信息时，似乎一次读取一个文件？

首先如何：

```
public IEnumerable<String> ReadLinesInDirectory(string path)
{
    return Directory.EnumerateFiles(path)
                    .SelectMany(f => 
                        File.ReadLines(f)
                        .AsEnumerable()
                        .Skip(1));
} 
```

并替换`ReadLines`为（确保您指向正确的路径等）。

* * *

好的，这是完整的解释，但我认为您可能需要更多地学习 C#。首先，定义`ReadLinesInDirectory`我上面写的函数。

然后`ProcessMonthlyLogFiles`用这个代替：

```
public void ProcessMonthlyLogFiles()
{
    DateTime currentTime = DateTime.Now;

    int month = currentTime.Month - 1;
    int year = currentTime.Year;

    string path = Path.GetDirectoryName(Settings.DailyPath + year + @"\" + month + @"\");

    CalculateMonthlyStatistics(path);
} 
```

并且`CalculateMonthlyStatistics`在前三行（在 之前`GroupBy`）如下：

```
 public void CalculateMonthlyStatistics(string path)
    {
        var statistics = ReadLinesInDirectory(path)
                         // .GroupBy etc... 
```

# json - 如何使用 Spring MVC 和多种响应类型支持 JSONP

> ID：10323625
> 
> 赞同：3
> 
> 时间：2012-04-25T20:55:01.010
> 
> 标签：json, spring, spring-mvc, jsonp, jackson

我在控制器中有一个方法，它将根据要求返回 HTML 或 JSON。这是这种方法的精简示例，以我在[此问题](https://stackoverflow.com/questions/4403643/supporting-multiple-content-types-in-a-spring-mvc-controller/)中找到的有关如何执行此操作的信息为模型：

```
@RequestMapping(value="callback")
public ModelAndView callback(@RequestParam("c") String c) {
    Map response = new HashMap<String, String>();
    response.put("foo", "bar");
    return new ModelAndView("fake", "data", new JSONPObject(c, response));
} 
```

我将 JSONPObject 放入模型中，因为如果请求 HTML，我必须能够从呈现的视图中访问它。但是当我使用回调渲染 JSON 时，这会带来一个问题：

```
curl 'http://localhost:8080/notes/callback.json?c=call'
{"data"call(:{"foo":"bar"})} 
```

如您所见，因为我将数据放在模型的“数据”槽中，所以当模型呈现为 JSON 时，会有额外的包装。我正在寻找的是呈现的 JSON（技术上是 JSONP）看起来像这样：

```
call({"data":{"foo":"bar"}}) 
```

任何人都可以在不破坏在渲染期间返回访问 JSONPObject 的视图的能力的情况下找到一种方法来获得我想要去的地方吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-26T06:29:56.797

这就是我在 Spring MVC 中使用 JSONP 的方式，只需根据您的需要进行修改：

在服务器端：

```
@RequestMapping(value="/notes/callback.json", method=RequestMethod.GET)
public void jsonpCallback(@RequestParam("callback") String callback, HttpServletResponse response) {
   response.setContentType("text/javascript; charset=UTF-8");
   PrintWriter out = response.getWriter();
   out.print(callback + "(" + jsonDataString + ")");
} 
```

在客户端：

```
<script src="http://code.jquery.com/jquery-1.6.2.min.js"></script>
<script type="text/javascript">

function yourfunction() {
    jQuery.getJSON("http://localhost:8080/notes/callback.json?callback=?", 
        function(data) {
            alert(data.someParam);
        });
}

</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T12:27:31.380

我想通了。渲染 JSON 时，Spring 根据我的配置使用 MappingJacksonJsonView。该视图有一个属性告诉它在地图中查找单个项目并在渲染之前将其提取出来。设置该属性后，现在可以使用。

```
 <property name="defaultViews">
        <list>
            <bean class="org.springframework.web.servlet.view.json.MappingJacksonJsonView" >
                <property name="extractValueFromSingleKeyModel" value="true" />
            </bean>
        </list>
    </property> 
```

# rdf - ERD和RDF之间的确切区别是什么

> ID：10323628
> 
> 赞同：3
> 
> 时间：2012-04-25T20:55:18.050
> 
> 标签：rdf, semantic-web, erd

有人可以解释一下 ERD 模型（我们谈论实体、关系和属性）与 RDF （我们谈论主语、谓词和宾语）之间的确切区别吗？我已经检查了各种资源，例如[http://www.w3.org/DesignIssues/RDFnot.html](http://www.w3.org/DesignIssues/RDFnot.html)，但是我仍然不清楚其中一种资源的优越性。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T21:13:35.857

这不是优越性的问题，而只是哪个最适合您的问题。

两者都很有用。

当您需要表示图形结构，或者当您需要与许多其他您无法控制的系统进行交换时，RDF 是最好的选择。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-26T02:48:18.517

ERD 非常适合结构化数据建模。因此，如果您的问题涉及使用半结构化内容，ERD 很快就会变得一团糟。另一个区别是 ERD 主要用于封闭式数据库设计，您可以强制客户端应用程序使用定义的模式，另一方面 RDF 面向解决开放世界问题，没有严格的模式或术语约定，信息往往是公开的和疏散。

# c# - C#：如何取消选择和散焦文本框？

> ID：10323629
> 
> 赞同：4
> 
> 时间：2012-04-25T20:55:22.263
> 
> 标签：c#, winforms, textbox, focus

我正在用 C# WinForms 编写一个简单的基于计算的应用程序。我的问题是我有文本框来显示无法单击/聚焦的结果，因为按钮绑定到键盘。文本框必须有 ContextMenuStrip，但只有这个动作应该在文本框内处理。此外，此应用程序要求是它不能有任何可聚焦的控件。类似于 Windows 的 Calc 结果框。有什么建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T22:12:52.583

创建自定义文本框：

```
public class TextBoxWithoutFocus : TextBox
{
    private const int WM_SETFOCUS = 0x7;

    protected override void WndProc(ref Message m)
    {
        if (m.Msg == WM_SETFOCUS)
            return;

        base.WndProc(ref m);
    }
} 
```

就这样。文本框永远不会获得焦点（实际上它会获得焦点，但不会改变它的外观）。如果要禁用用户输入，还可以考虑抑制 WM_CHAR 消息 (0x102)。

更新（可以与按钮一起使用的技巧）：

```
public class ButtonWithoutFocus : Button
{
    public ButtonWithoutFocus()
    {
        SetStyle(ControlStyles.Selectable, false);
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T21:48:52.377

使其成为标签，而不是文本框。您可以设置尺寸和背景，使其看起来像一个文本框，并且它具有 ContextMenuStrip。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T21:05:16.983

尝试两者`TextBox.Enabled = False;`和`TextBox1.ReadOnly = True;`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-14T10:22:37.853

散焦只需这样做：

```
TextBox.Select(0, 0); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-25T20:57:55.960

是否`TextBox.Enabled = false`满足您的需求？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-25T20:58:11.810

尝试这个

```
TextBox1.ReadOnly = True; 
```

# c# - 授予 Windows 服务权限以将文件移动到需要的远程目录。用户/通行证

> ID：10323632
> 
> 赞同：0
> 
> 时间：2012-04-25T20:55:37.723
> 
> 标签：c#, windows-services, active-directory

我正在使用 EWS 从收件箱中的电子邮件中获取文件附件，并且需要将这些文件（如果它们符合某些条件）放到一个网络目录路径中，该路径需要一个与机器不同的活动目录用户/通行证运行服务正在使用。

可能有多种方法可以攻击它。无需设置该目录路径以允许运行 Windows 服务的用户/通行证具有读/写权限，有没有一种方法可以在代码中设置用户/通行证，然后再尝试将文件放在该路径中?

在 Windows 服务的安装程序设置中，我尝试了以下操作：

```
this.serviceProcessInstaller1.Account = System.ServiceProcess.ServiceAccount.User;
this.serviceProcessInstaller1.Password = "password";
this.serviceProcessInstaller1.Username = @"\\serverName\user"; 
```

当我尝试安装时，我收到关于映射用户通行证的错误，所以我尝试了这个：

```
this.serviceProcessInstaller1.Account = System.ServiceProcess.ServiceAccount.NetworkService;
this.serviceProcessInstaller1.Password = "password";
this.serviceProcessInstaller1.Username = @"\\serverName\user"; 
```

安装程序工作，服务显示并且我可以启动它，但是当我调试/附加到进程时，它在尝试写入有关访问权限的目录时抛出异常。

所以也许我什至没有攻击正确的问题/部分，因为这可能是一个活动目录问题并且没有在代码中完成。

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T03:38:56.870

What you tried there is irrelevant to your problem.

If you're on windows 7, you may workaround by going to [Control Panel]->[User Accounts]->[Credential Manager] to store login information of target machines.

# c# - 在 C# 中使用纵横比调整图像大小并裁剪中心图像，因此没有间隙

> ID：10323633
> 
> 赞同：24
> 
> 时间：2012-04-25T20:55:44.367
> 
> 标签：c#, asp.net

我正在尝试将用户上传的图像调整为横向尺寸，例如 450w 和 250h，同时保持纵横比，但为了避免调整大小的图像（如侧面有间隙的肖像图像）我想裁剪图像的中心以填充调整后的尺寸.

我发现了很多代码来调整图像大小，同时保持纵横比，但不是我在上面寻找的，我希望有人能提供帮助。

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2012-04-25T21:17:31.330

你应该通过 needToFill = true：

```
public static System.Drawing.Image FixedSize(Image image, int Width, int Height, bool needToFill)
{
    #region calculations
    int sourceWidth = image.Width;
    int sourceHeight = image.Height;
    int sourceX = 0;
    int sourceY = 0;
    double destX = 0;
    double destY = 0;

    double nScale = 0;
    double nScaleW = 0;
    double nScaleH = 0;

    nScaleW = ((double)Width / (double)sourceWidth);
    nScaleH = ((double)Height / (double)sourceHeight);
    if (!needToFill)
    {
        nScale = Math.Min(nScaleH, nScaleW);
    }
    else
    {
        nScale = Math.Max(nScaleH, nScaleW);
        destY = (Height - sourceHeight * nScale) / 2;
        destX = (Width - sourceWidth * nScale) / 2;
    }

    if (nScale > 1)
        nScale = 1;

    int destWidth = (int)Math.Round(sourceWidth * nScale);
    int destHeight = (int)Math.Round(sourceHeight * nScale);
    #endregion

    System.Drawing.Bitmap bmPhoto = null;
    try
    {
        bmPhoto = new System.Drawing.Bitmap(destWidth + (int)Math.Round(2 * destX), destHeight + (int)Math.Round(2 * destY));
    }
    catch (Exception ex)
    {
        throw new ApplicationException(string.Format("destWidth:{0}, destX:{1}, destHeight:{2}, desxtY:{3}, Width:{4}, Height:{5}",
            destWidth, destX, destHeight, destY, Width, Height), ex);
    }
    using (System.Drawing.Graphics grPhoto = System.Drawing.Graphics.FromImage(bmPhoto))
    {
        grPhoto.InterpolationMode = InterpolationMode.HighQualityBicubic;
        grPhoto.CompositingQuality = CompositingQuality.HighQuality;
        grPhoto.SmoothingMode = SmoothingMode.HighQuality;

        Rectangle to =  new System.Drawing.Rectangle((int)Math.Round(destX), (int)Math.Round(destY), destWidth, destHeight);
        Rectangle from = new System.Drawing.Rectangle(sourceX, sourceY, sourceWidth, sourceHeight);
        //Console.WriteLine("From: " + from.ToString());
        //Console.WriteLine("To: " + to.ToString());
        grPhoto.DrawImage(image, to, from, System.Drawing.GraphicsUnit.Pixel);

        return bmPhoto;
    }
} 
```

# android - 找不到 GPS 位置

> ID：10323644
> 
> 赞同：0
> 
> 时间：2012-04-25T20:56:29.283
> 
> 标签：android, android-emulator

我有一个将 gps 点发送到我的服务器的单线程类。该类保持并刷新 gps 位置。

查找线程：

```
public class FinderThread extends Thread {
    private static FinderThread SINGLETON;
    public boolean isinterrupt = true;
    public int maxage;
    public int minage;
    public int distance;
    public String gender;
    public String latitude;
    public String longitude;
    public String sid;
    public Context ctx;
    LocationManager gps;
    boolean nav;
    SharedPreferences pref;
    private Handler dlh;
    private Handler myLocationHandler;
    boolean pause=false;

    private FinderThread(Context ctx,Handler dlh, Handler myLocationHandler) {
        this.ctx = ctx;

        gps = (LocationManager) ctx.getSystemService(Context.LOCATION_SERVICE);
        gps.requestLocationUpdates( LocationManager.GPS_PROVIDER,60000, 20, llistener);

        pref = ctx.getSharedPreferences("NFF", 0);
        sid = pref.getString("sid", "");

        this.dlh = dlh;

        if (myLocationHandler!=null)
        {
            this.myLocationHandler = myLocationHandler;
        }
        if(myLocationHandler != null)
        {
            myLocationHandler.sendEmptyMessage(0);
        }

    }
    public static synchronized FinderThread getInstance(Context ctx,Handler dlh, Handler myLocationHandler) 
    {
         if (SINGLETON == null) // falls null 
         { 
               SINGLETON = new FinderThread (ctx,dlh,myLocationHandler);//instanzieren 
         }
         else
         {
             SINGLETON.myLocationHandler= myLocationHandler;
             SINGLETON.dlh = dlh;
             myLocationHandler.sendEmptyMessage(0);
         }
         return SINGLETON;
    }

    /*
    @Override
    public synchronized void start() {
        if(SINGLETON != null)
        {
            SINGLETON.start();
        }
    }
    public synchronized void pause()
    {
        if(SINGLETON.getState()==State.RUNNABLE || SINGLETON.getState()==State.WAITING)
        {
                SINGLETON.pause = true;

        }
    }
    public synchronized void tcontinue ()
    {
        if(SINGLETON.getState()==State.RUNNABLE || SINGLETON.getState()==State.WAITING)
        {
                SINGLETON.pause = false;

        }
    }
    public synchronized boolean isPaused()
    {
        return SINGLETON.pause;
    }
    */

    public synchronized void pause()
    {
        this.pause = true;
    }
    public synchronized boolean isPaused()
    {
        return this.pause;
    }
    public synchronized void tcontinue ()
    {
                this.pause = false;
    }

    @Override
    public void run() {
        //String locationProvider = LocationManager.GPS_PROVIDER;
        //Location lastpoint = gps.getLastKnownLocation(locationProvider);

        //longitude = String.valueOf(lastpoint.getLongitude());
        //latitude = String.valueOf(lastpoint.getLatitude());

        try
        {
            while (isinterrupt) {
                if(!pause)
                {
                    Log.e("NFF", "Finder Thread Begin");
                    RestConnection r = new RestConnection("finder", dlh, "POST");
                    r.setParameter("minage", String.valueOf(minage));
                    r.setParameter("maxage", String.valueOf(maxage));
                    r.setParameter("distance", String.valueOf(distance));
                    r.setParameter("gender", String.valueOf(gender));
                    r.setParameter("latitude", String.valueOf(latitude));
                    r.setParameter("longitude", String.valueOf(longitude));
                    r.setParameter("sid", sid);
                    Log.e("NFF Finder Paramater", String.valueOf(minage)+" "+String.valueOf(maxage)+" "+String.valueOf(distance)+" "+String.valueOf(gender) + " "+String.valueOf(latitude)+" " +String.valueOf(longitude)+ " " + sid  );

                    r.start();
                }

                Thread.sleep(10000);
            }
        }
        catch (InterruptedException e) {
            Log.e("NFF FT", "InterruptedException");
            isinterrupt = false;
        }
    }
    private LocationListener llistener = new LocationListener (){

        @Override
        public void onLocationChanged(Location location) {
            if(String.valueOf(location.getLatitude())!= null)
            {
                latitude = String.valueOf(location.getLatitude());
                longitude =  String.valueOf(location.getLongitude());
                if(myLocationHandler != null)
                {
                    myLocationHandler.sendEmptyMessage(0);
                }
            }

        }

        @Override
        public void onProviderDisabled(String provider) {
            Log.e("NFF", "GPS Disabled");
            isinterrupt = true;

        }

        @Override
        public void onProviderEnabled(String provider) {
            Log.e("NFF", "GPS Enabled");

        }

        @Override
        public void onStatusChanged(String provider, int status, Bundle extras) {
            // TODO Auto-generated method stub

        }

    };
    public void saveProperties ()
    {
        Editor editor = pref.edit();
        editor.putInt("maxage", maxage);
        editor.putInt("minage", minage);
        editor.putInt("distance", distance);
        editor.putString("gender", gender);
        editor.putString("lat", latitude);
        editor.putString("long", longitude);
        editor.commit();

    }
    public void loadProperties ()
    {
        maxage = pref.getInt("maxage", -1);
        minage = pref.getInt("minage", -1);
        distance = pref.getInt("distance", -1);
        gender = pref.getString("gender", "f");
        latitude = pref.getString("lat", "f");
        longitude = pref.getString("long", "f");
    }
    public synchronized void pushSettings()
    {
        SINGLETON.maxage = maxage;
        SINGLETON.minage = minage;
        SINGLETON.distance = distance;
        SINGLETON.gender = gender;
        SINGLETON.latitude = latitude;
        SINGLETON.longitude = longitude;
    }

} 
```

当我在模拟器上测试我的应用程序并使用模拟器控制设置位置时，一切正常。当我在手机上测试时，机器人找不到位置。我已经测试了应用程序“GPS Test”，它在 3 分钟内找到了 5 个卫星的位置。

请帮忙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T00:15:38.407

看起来你在那里拥有一切。

您在清单中授予自己 FINE_LOCATION 的权限，对吗？

我会提出的一个建议是改变你的`requestLocationUpdates()`，以便它要求修复它们之间的时间为 0，它们之间的距离为 0。我见过的所有 GPS 接收器都会使用此设置为您提供大约每秒一次的修复，这几乎是大多数 gps 引擎的工作方式。只是很有可能您提出的请求中的一分钟和 20 m 把您搞砸了。如果您对此建议进行了修复，则可以从那里开始工作以最大程度地减少 gps 的运行时间。

祝你好运！

# ruby-on-rails - 如何在 ruby on rails 中将参数传递给控制器 动作

> ID：10323645
> 
> 赞同：0
> 
> 时间：2012-04-25T20:56:30.420
> 
> 标签：ruby-on-rails, controller, params

如果有人可以在 ruby​​ on rails 上帮助我，我将不胜感激。我可以将 params[:something] 传递给控制器​​吗？

在我的索引视图中，我有

```
 <button value="1" name="most_recent" type="submit" class="btn" data-toggle="button">Most Recent</button>
       <button value="1" name="score" type="submit" class="btn" data-toggle="button">Score</button> 
```

本质上，如果按下按钮，该值将进入我的索引控制器，我可以通过这样做来接收它

```
 params[:score] 
```

查看是否按下了分数按钮。但是，在我的索引模板上我也有

```
 <%= form_tag search_photos_path, :method => 'get' do %>
        <p>
            <%= text_field_tag :search, params[:search], 
                :class => "input-medium search-query expand" %>
            <%= submit_tag 'Search', :name => nil, :class => "btn" %>
        </p>
    <% end %> 
```

当用户点击搜索时，它会转到我的搜索操作。有没有办法发送 params[:score] 是什么？如果它已被点击，我希望能够知道它已被点击。我尝试在我的搜索操作中执行 params[:search]，但即使我单击了搜索按钮，它也会返回 nil。

谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T21:16:40.357

在模板内的表单中添加隐藏的输入字段，其值为

```
params[:score] 
```

# java - JSP 错误页面

> ID：10323653
> 
> 赞同：0
> 
> 时间：2012-04-25T20:56:58.107
> 
> 标签：java, jsp

有没有办法在维护 HTTP 错误代码的同时拥有自定义错误页面（不使用本身具有 200 代码的错误页面捕获错误）？是否必须使用 in web.xml 来完成，或者我可以直接在 JSP 中完成吗？

如果我使用 response.sendError 发送 HTTP 错误代码，则页面上不会出现其他文本。我可以使用 out.println() 在页面上获取文本，但它似乎无法打印出 html，只能打印基本文本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T21:05:11.587

是的，在您的 web.xml 中，您可以使用“错误页面”标签和“错误代码”和“位置”的子元素配置错误代码

```
<error-page>
   <error-code>400</error-code>
   <location>/WEB-INF/jsp/errorpages/errorPage400.jsp</location>
</error-page> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T21:03:42.810

您应该使用 response.setStatus(int statusCode) 将状态设置为 404，同时仍然允许您发送自定义错误页面。

# django - Django 通过 apache

> ID：10323654
> 
> 赞同：0
> 
> 时间：2012-04-25T20:57:03.420
> 
> 标签：django, apache

我在使用 django 1.4 和 wsgi 部署为 1.3 编写的 django 网站时遇到了很多麻烦。还有一个 wordpress 站点也在同一个域上运行。理想情况下，我希望 django 站点在 [domain]/app/ 上运行。

有没有人有一个好的教程的链接。我在确定将 wsgi.py 文件放在哪里时遇到了很多麻烦。一直说找不到。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T23:24:46.013

当我最近在部署我的第一个 django 项目时，我发现[本教程](http://blog.stannard.net.au/2010/12/11/installing-django-with-apache-and-mod_wsgi-on-ubuntu-10-04/)很有帮助。它独立地测试 django 和 wsgi 是否都在使用简单的“hello world”应用程序工作，并给出了如何使 wsgi.py 文件正常工作的示例。我认为将 wsgi.py 放在正确的位置并不是真正的问题。这更像是告诉 Apache wsgi.py 在哪里的问题。如果您可以使教程正常工作，那么让您的完整 django 站点正常工作应该相对简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T00:18:43.260

对于 Django 站点，应该只是拥有：

```
WSGIScriptAlias /app /some/path/project/wsgi.py 
```

换句话说，'/app' 挂载点与 WSGIScriptAlias 一起使用，而不是许多示例使用的 '/'。

如果使用登录功能，您可能还需要在 Django 设置文件中设置 LOGIN_URL 等，因为它不会自动合并到挂载点中。

# ruby-on-rails - 如何在 Ruby on Rails 中自定义 mongodb (mongoid) 字段名称？

> ID：10323659
> 
> 赞同：0
> 
> 时间：2012-04-25T20:57:20.943
> 
> 标签：ruby-on-rails, mongodb, mongoid

我目前正在尝试自定义我的错误消息，但我无法将数据库表字段名称更改为更具可读性。

我已经尝试更新 config/locales/en.yml 文件，但是在发生验证错误时它不会更改它：

```
en:
  mongoid:
    attributes:
      user:
        restaurant_name: "Restaurant Name" 
```

MongoDB 表：`users`
MongoDB 字段名称：`restaurant_name`

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T19:03:01.313

本地化是针对字段值而不是针对字段名称。

如果您在使用字段值进行本地化时遇到问题，可能是因为您没有在模型中启用本地化。

如果是这种情况，只需添加`localize: true`到字段定义中。

# matlab - 用 MATLAB 中从较小矩阵中提取的平均值替换矩阵值

> ID：10323661
> 
> 赞同：1
> 
> 时间：2012-04-25T20:57:23.917
> 
> 标签：matlab, matrix, mean, convolution

假设我有一个`10 x 10`矩阵。然后我要做的是用一个矩阵遍历整个`3 x 3`矩阵（除了边缘以使其更容易），并从这个矩阵中我得到这个空间`3 x 3`的平均值/平均值。`3 x 3`然后我想做的是用那些新的平均值/平均值替换原始矩阵值。

有人可以向我解释我该怎么做吗？一些代码示例将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T21:49:31.243

您尝试做的事情称为[卷积](http://en.wikipedia.org/wiki/Convolution)。在 MATLAB 中，您可以执行以下操作（详细了解卷积及其在 MATLAB 中的完成方式）。

```
conv2( myMatrix , ones(3)/9 , 'same' ); 
```

稍微破译一下就可以了。`myMatrix`是您正在处理的矩阵（您提到的 10x10 矩阵）。该`ones(3)/9`命令创建一个所谓的*过滤器内核**掩码*，即

 *```
1/9 1/9 1/9
1/9 1/9 1/9
1/9 1/9 1/9

```

当您使用此遮罩并移动它时，将遮罩的条目与图像的 3x3 条目相乘，然后添加结果（本质上是点积），您将得到最终位于下方的 9 个值的平均值这个面具。因此，一旦您将此掩码放置在矩阵的每个 3x3 段上（我想是图像）并将中间的值替换为平均值，您就会得到该命令的结果。欢迎您进一步尝试。该`'same'`标志仅表示您要返回的矩阵与原始矩阵的大小相同。这很重要，因为正如您自己意识到的那样，有多种处理边缘的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T21:51:52.837

为此，您需要保持原件完好无损，直到您掌握了所有方法。这意味着如果您使用循环来实现这一点，则必须将平均值存储在不同的矩阵中。要获得边界，最简单的方法是将原始矩阵复制到新矩阵，尽管只需要复制边界。

该`average3x3`函数将输入复制`Matrix`到`AveragedMatrix`，然后遍历所有不在任何边界上的元素，计算 3x3 空间的平均值并将其存储在 的对应元素中`AveragedMatrix`。

```
function [AveragedMatrix] = average3x3(Matrix)

AveragedMatrix = Matrix;

if ((size(Matrix, 1) < 3) || (size(Matrix, 2) < 3))
    fprintf('Matrix is too small, minimum matrix size is 3x3.\n');
    return
end

for RowIndex = 2:(size(Matrix, 1)-1)
    Rows = RowIndex-1:RowIndex+1;

    for ColIndex = 2:(size(Matrix, 2)-1)
        Columns = ColIndex-1:ColIndex+1;
        AveragedMatrix(RowIndex,ColIndex) = mean(mean(Matrix(Rows,Columns)));
    end
end

return 
```

要使用此功能，您可以尝试：

```
A = randi(10,10);

AveragedA = average3x3(A); 
```*

# assembly - 在装配中使用中断

> ID：10323666
> 
> 赞同：4
> 
> 时间：2012-04-25T20:57:33.430
> 
> 标签：assembly

我被要求用中断[（完整说明）](http://dl.dropbox.com/u/16641927/lab13.txt)重写下面的代码。我们还没有真正在课堂上讨论过中断，我不确定它们是如何使用或如何实现的。这是我在没有使用中断的情况下编写的代码，这些中断基本上使键盘变成钢琴或可以播放为[摩托罗拉 68hc11](http://www.ele.uri.edu/courses/ele205/6811-Instructions/index.html)编写的歌曲（lamb，chromsc，hall） ：

```
PORTA      EQU  $1000  ;The speaker port
SPEAKER    EQU  PORTA
SPEAKERBIT   EQU  %00100000

SCSR    EQU  $6400    ; Serial communications status register
SCDR    EQU  $6401    ; Serial communcations data register
TDRE    EQU  %00000010    ; mask for TDRE flag in SCSR
RDRF    EQU  %00000001    ; mask for RDRF flag in SCSR

ORG     $8000;  Place data at 8000
LAMB    FCB  'trerttttrrrrtuuutrerttttrrtre',$00
CHROMSC FCB  'q2we4r5ty7u8i9op-[=]',$00
HALL    FCB  'qwertet5w5r2rqwertetiutetu',$00

KEYMAP  FDB  'q', 220, 758  ;  A    ;key, frequency, and 1/4 second "period"
        FDB  '2', 233, 715  ;  A#
        FDB  'w', 247, 675  ;  B
        FDB  'e', 262, 636  ;  C
        FDB  '4', 277, 602  ;  C#
        FDB  'r', 294, 567  ;  D
        FDB  '5', 311, 536  ;  D#
        FDB  't', 330, 505  ;  E
        FDB  'y', 349, 478  ;  F
        FDB  '7', 370, 450  ;  F#
        FDB  'u', 392, 425  ;  G
        FDB  '8', 415, 402  ;  G#
        FDB  'i', 440, 379  ;  A
        FDB  '9', 466, 358  ;  A#
        FDB  'o', 494, 337  ;  B
        FDB  'p', 523, 319  ;  C
        FDB  '-', 554, 301  ;  C#
        FDB  '[', 587, 284  ;  D
        FDB  '=', 622, 268  ;  D#
        FDB  ']', 659, 253  ;  E
        FDB  $00            ;  Null termination character

PROMPT  FCB  $0D, 'Piano program - use QWERTY row to play notes', $0D, $00  ;Prompt String

        ORG  $8800
        LDS  #$DFFF

;;;;;;;;;;  Main Start  ;;;;;;;;;;
        LDX    #PROMPT

        PSHX  ;Push the argument to the stack
        JSR    printString  ;Print the promp string
        PULX

ALWAYS  DES
        JSR    getChar  ;Get a character from the keyboard
        JSR    putChar
        PULA  ;put the character in A

        PSHA  ;Push character to the stack
        JSR    playTone  ;Play the tone
        PULA

        CMPA   #'a'
        BNE    SKIPLAMB

        LDX    #HALL
        PSHX
        JSR    playSong
        PULX

SKIPLAMB CMPA   #'s'
        BNE    BRAALW

        LDX    #LAMB
        PSHX
        JSR    playSong
        PULX

BRAALW  BRA    ALWAYS  ;Loop to the top and continue playing
;;;;;;;;;;  Main End  ;;;;;;;;;;

;;;;;;;;;;  playTone Start  ;;;;;;;;;; Passed an ascii character and a length on the stack
playTone    PSHB  ;for transparency
            PSHA
            PSHX
            PSHY

            TSY    ;make Y point to the top of the stack

            LDAA   8,Y  ;load A with the passed argument
            LDX    #KEYMAP  ;make Y point to the KEYMAP
CBAALWAYS   LDAB   1,X  ;load B with the ascii value
            BEQ    EXITPT  ;If current value is $00, end of table, no key match, exit routine
            CBA        ;Compare B to A
            BEQ    SKIPTESTS  ;If value are equal, skip rest of test to play tone
            XGDX
            ADDD   #6  ;Make X point to the next character to compare
            XGDX
            BRA    CBAALWAYS  ;Branch until the end of table is reached

SKIPTESTS   LDD     2,X  ;Load D with the frequency
            LSRD  ;Number of times to toggle the speaker in a 1/4 second
            LSRD    ;this shortens the tone to an 1/8 note
            ;LSRD    ;this plays a 1/16 note
            ;LSRD    ;this plays a 1/32 note
PERIODLOOP  LDY     4,X  ;Load Y with the delay between toggles
FREQLOOP    DEY    ;Decrement Y until it's 0

            BNE   FREQLOOP    ;Branch until X is 0

            PSHB    ;preserve D
            PSHA

            LDAA  PORTA  ;Load A with the speaker
            EORA  #SPEAKERBIT  ;Toggle the speaker bit
            STAA  PORTA    ;Store back into the speaker

            PULA    ;restore D
            PULB

            SUBD  #1  ;Decrement D
            CPD    #0  ;Compare D to 0
            BNE    PERIODLOOP    ;Branch until D is 0

EXITPT      PULY
            PULX
            PULA
            PULB  ;return the stack to normal

            RTS    ;return to the main program
;;;;;;;;;;  playTone End  ;;;;;;;;;;

;;;;;;;;;;  playSong Start;;;;;;;;;;
playSong    PSHB    ;Reference is passed on the stack
            PSHA    ;Pushes for transparency
            PSHX
            PSHY

            TSX
            LDX     8,x     ;Load X with the passed value

LOOPSTRING  LDAA    0,X     ;Load A with the ith character of the string
            BEQ     ENDPSTRING          ;Skips to end of subroutine if current character is null character
            PSHA            ;Pass the argument in A to putChar
            JSR     playTone
            INS             ;Return the stack to normal
            INX             ;increments X to point to the next character
            BRA     LOOPSTRING

ENDPSTRING  PULY
            PULX
            PULA
            PULB

            RTS

;;;;;;;;;;  playSong End  ;;;;;;;;;;

;;;;;;;;;;  putChar start  ;;;;;;;;;; Passed argument should be an ascii value
putChar     PSHB    ;is passed an argument on the stack
            PSHA    ;for transparency
            PSHX
            PSHY
            TSY     ;stack frame

            LDX     #SCSR            ;Load in address of SCSR (Serial Communication Status Register)
GCWAIT      BRCLR   0,X TDRE GCWAIT    ;Loop
            LDAA    8,Y   ;Load A with the passed value
            STAA    SCDR  ;Write A to the SCDR

            PULY
            PULX
            PULA
            PULB

            RTS
;;;;;;;;;;  putChar end  ;;;;;;;;;;

;;;;;;;;;;  getChar start  ;;;;;;;;;; ascii value is returned
getChar     PSHB    ;No argument. Passes result back on the stack.
            PSHA    ;For transparency
            PSHX
            PSHY
            TSY

            LDX     #SCSR            ;Load in address of SCSR (Serial Communication Status Register)
PCWAIT      BRCLR   0,X RDRF PCWAIT    ;Loop when the
            LDAA    SCDR  ;Load A with what's in the SCDR (should be the pressed key)
            STAA    8,Y   ;Store it to the stack to be passed back

            PULY
            PULX
            PULA
            PULB

            RTS
;;;;;;;;;;  getChar  end  ;;;;;;;;;;

;;;;;;;;;;  printString start   ;;;;;;;;;;  argument passed on the stack in ascii
printString PSHB    ;Reference is passed on the stack
            PSHA    ;Pushes for transparency
            PSHX
            PSHY

            TSX
            LDX     8,x     ;Load X with the passed value

LOOPSTRING1 LDAA    0,X     ;Load A with the ith character of the string
            BEQ    ENDPSTRING1          ;Skips to end of subroutine if current character is null character
            PSHA            ;Pass the argument in A to putChar
            JSR     putChar
            INS             ;Return the stack to normal
            INX             ;increments X to point to the next character
            BRA    LOOPSTRING1

ENDPSTRING1 PULY
            PULX
            PULA
            PULB

            RTS
;;;;;;;;;;  printString end  ;;;;;;;;;; 
```

有人可以给我一个如何有效实现的例子，或者只是提示如何开始编码中断，以便我可以用它们重写我的代码。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T22:09:52.487

要在 hc11 上使用中断，您必须做四件事：

1.  首先决定你想使用什么样的中断。hc11 有许多不同的类型，因此您必须查阅手册以找到适合您要执行的操作的类型。

对于接下来的步骤，我假设您正在使用 IRQ 中断。它只是 hc11 上的一个简单中断引脚，当系统电压降至低时会中断系统。然而，对于任何其他中断，这些步骤将非常相似。

1.  您需要初始化中断服务程序的起始位置。当中断被触发时，处理器将检查一个向量表以确定它需要去哪里。因此，例如，当触发 IRQ 时，它将转到对应于 IRQ ($FFF2) 的表条目，然后跳转到存储在那里的地址。我们将标记中断服务程序`IRQ_INT`并将其存储在对应于 IRQ 的表条目中，以便在触发 IRQ 时它将开始执行 label 处的代码`IRQ_INT`。

    ```
    ORG   $FFF2
    FDB   IRQ_INT 
    ```

2.  接下来，您需要启用中断，以便处理器在触发时识别它。您将不得不再次查看手册，了解您必须将值存储在哪个寄存器中才能启用它。要启用 IRQ，必须在中断控制寄存器 (INTCR) 中将 IRQ 启用位 (IRQEN) 设置为 1。然后可以使用`CLI`命令启用它。

    ```
    INTCR    EQU   $001E   ;address of interrupt control register
    INTCR_IN EQU   $60     ;sets IRQEN bits

             LDAA  #INTCR_IN
             STAA  INTCR
             CLI 
    ```

3.  最后，您需要编写中断服务程序。这是每次触发中断时将执行的代码。它将从我们之前在向量表中设置的标签开始，并在到达指令时结束`RTI`。从中断返回指令告诉处理器服务程序已经完成，它应该返回到中断触发之前它正在执行的任何内容。

    ```
    IRQ_INT
           <instructions go here>
           RTI 
    ```

我的猜测是，您会希望在键盘端口上出现某种中断，该中断会在按下键时触发。一旦按键被击中，中断将触发处理器进入中断服务程序。在那里，您必须编写代码来确定按下哪个键并播放正确的音符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T22:38:11.137

您必须编写两个 ISR，基本上是子程序。每个似乎都是由计时器触发的硬件中断。

一个 isr 是切换扬声器音调并自行触发（开/关）从而产生 N 个周期的音调的那个。首先熟悉了解如何对定时器 TOC3 进行编程

另一个是计时器 int 循环，每 1 ms 查找输入并监视 RDRF 标志并通过您之前所做的某个项目读取数据。熟悉 TOC2 编程

您需要初始化 ISR，这意味着您必须设置 CPU 以告诉它 ISR 例程所在的位置。您的说明已指示如何为 TOC3 执行此操作，并且应该类似于 TOC2，阅读您的讲义以查看 jmp 表在 toc2 的位置，他告诉您 toc3 在哪里。

```
 Memory $FFE4 contains 
 $00D9, so insert a JMP XXXX instruction at $00D9 (where XXXX is the 
 address of your TOC3 service routine.  Note: the opcode for JMP is $7E. 
```

所以做这样的事情：

```
 org $00d9 
 jmp YourTOC3ISR 
```

;;;;;;;;;;;;;; 主程序

```
 initialize timer registers ie setup toc2 and toc3
 initialize interrupt registers

 2) Read the current Timer Count from TCNT (pg. 374), add your DELAY to it, 
 and store the result in TOC3 (pg. 409).  This defines when you want the 
 first interrupt to occur.
 3) Set OC3I bit in TMSK1 to enable TOC3 interrupts (pg. 410).
 4) Clear the OC3F bit in TFLG1 to clear any previous interrupt condition.
 (pg. 410).  IMPORTANT!!!  Note that you must write a 1 to this bit to 
 clear it!  Do not use BSET!  See the discussion on page 387.
 5) Optional: Write to OM3 and OL3 bits in TCTL1 register to define how the 
 OC3 output pin will behave when the interrupt occurs (pg. 412).
 6) Enable interrupts globally. (See SEI and CLI instructions.)

 do lab 7 code 
```

;;;;;;;;;;;;;;;;; toc3 isr 例程 YourTOC3Isr, playtone ?

```
 save the regs and flags

 1) Define when the next interrupt should occur by adding your DELAY to TOC3.
 2) Do whatever it is you want done in the service routine ie speaker togggle stuff
 3) Clear the OC3F bit in TFLG1 to clear the interrupt condition (SEE ABOVE).
4) Return from interrupt when done (pg. 181).
unsave reg and flags
rti 
```

;;;;;;;;;;;;;;; toc2 isr 例程

保存注册和标志

然后它将检查 RDRF 标志，如果未设置则返回。如果设置，它将从接收寄存器读取字符，将其写入发送寄存器（您可以使用旧的 putchar 例程），然后调用 playtone 并从中断返回。

这部分听起来他想让你调用另一个中断例程 toc3，所以只需写入启动定时器的 TOC3 控制寄存器，中断应该注意它自己。

取消保存 reg 和标志 rti

希望这会有所帮助，M

# java - Java Abacus，用 for 循环画我的计数器有问题

> ID：10323675
> 
> 赞同：0
> 
> 时间：2012-04-25T20:58:10.530
> 
> 标签：java, swing

正如标题所说，当最终在我的算盘上绘制计数器时，我的 Java 代码遇到了问题。代码编译并运行，但计数器是从第一行而不是第一行开始绘制的。最重要的是，计数器不会在每一列中堆叠，一个计数器会出现并在列上下移动，具体取决于单击哪个按钮是正确的，但计数器应该在我左键单击时添加或在我右键单击时减去。

我在这上面花了几个小时，我确信这很愚蠢，但我的大脑已经停止工作，我想不出任何解决方案。

无论如何，这是我的代码。

*AbacusPanel.java*

```
public void paint(Graphics g)
{
    g.setColor(Color.gray);
    g.fillRect(0,0,getWidth(), getHeight());
    g.setColor(Color.black);

    Graphics2D g2 = (Graphics2D)g;
    // we'll use Graphics2D for it's "draw" method -
    // neater than the Graphics "drawRect" suppled
    // (which you could also use)

    for (int i = 0;i<numCols;i++)
    {
        for(int j = 0;j<numRows;j++)
        {
            g2.draw(getRect(i,j));
        }
    }

    for(int thisCol= 0; thisCol < numCols; thisCol++)
    {
        for(int thisRow = 0; thisRow < numRows; thisRow++)
        {
            for(int counters=0; counters<=myAbacus.getNumCounters(thisCol); counters++)
            {
                Rectangle r2 = getRect(thisCol,myAbacus.getNumCounters(thisCol));
                g2.setColor(Color.red);
                g2.fillOval(r2.x, r2.y, r2.width, r2.height);
            }
        }
    }

} 
```

希望有人可以为我指出正确的方向，如果其中任何内容的格式不符合您的要求，我们深表歉意。这是我的第一个问题帖子，我试图让它变得容易。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T22:08:30.630

根据我的评论：

当您绘制石头的占位符时，您会遍历列然后遍历行。但是当绘制计数器时，您只遍历列而不是行。为什么不也行？getNumCounters() 的结果不应该同时将列和行作为输入，因为您试图获取曼卡拉板上每个位置的计数器数量，对吧？

在回答您的第二个问题时，我不得不相信必须`getNumCounters()`将行和列都作为输入。由于你在 mancala 板上有两行，并且石头的数量取决于列以及它是在第一行还是第二行，否则就没有意义了。

另外，要考虑的第三件事。在您的矩形中，当您绘制计数器时，似乎需要改变它们的位置 - 在我看来，您的每个计数器都会堆叠在一起，所以 20 个计数器看起来不会不同于1。

# jquery - Jquery：单个选择器的多个内容？

> ID：10323680
> 
> 赞同：0
> 
> 时间：2012-04-25T20:58:22.943
> 
> 标签：jquery, jquery-selectors, modal-dialog

我正在使用一个在点击时显示内容的模态系统，我将在一个集成在 CMS 中的项目上使用它，但我想知道是否可以使用与下面相同的结构、相同的 id 和类来使用它。

```
<div id="test">
    <a class="link" href="#">Link 1</a>
    <div id="basic-modal-content">
        Description 1
    </div>
</div>

<div id="test">
    <a class="link" href="#">Link 2</a>
    <div id="basic-modal-content">
        Description 2
    </div>
</div> 
```

我已经尝试了以下 jquery 代码，但它只适用于第一个：

```
 $('#test').click(function (e) {
    $(this).find('#basic-modal-content').modal();

    return false;
}); 
```

我认为可能有一些技巧或其他东西，而不需要动态地参加每个模态的 id/class。如果有选择器可以帮助我，请告诉我。

感谢您阅读我的问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T21:00:14.770

不要使用 ID，除非它是一个独特的元素。改用类。如果您使用 ID 选择某些内容，则返回的 jQuery 对象将仅引用它找到的第一个对象，因此为什么 ID 应该只用于唯一项目。

让我改写更好。ID 应该是唯一的。可以在不唯一的元素上使用 ID，但不应在页面上的其他任何地方使用相同的 ID。

# multithreading - 什么是事件驱动编程？

> ID：10323681
> 
> 赞同：6
> 
> 时间：2012-04-25T20:58:27.477
> 
> 标签：multithreading, process, distributed, event-driven

什么是事件驱动编程，事件驱动编程与线程有什么关系？我来到这个问题阅读有关服务器以及它们如何处理用户请求和管理数据的信息。如果用户发送请求，服务器开始处理数据并将状态写入表中。为什么呢？服务器是否停止为该用户处理数据并开始为另一个用户处理数据或每个用户的处理在不同的线程（多线程服务器）中运行？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-25T21:15:54.267

事件驱动编程！= 线程编程，但它们可以（并且应该）重叠。

当系统需要“同时”处理多个动作时，使用线程编程。我同时使用松散，因为大多数操作系统对线程活动使用时间共享模型，或者至少当线程多于可用处理器时它们会这样做。无论哪种方式，都与您的 Q 无关。

当我需要一个应用程序来做两件事或更多事情时，我会使用线程编程——比如从键盘接收用户输入（线程 1）并根据接收到的输入（线程 2）运行计算。

事件驱动编程有点不同，但为了使其扩展，它必须利用线程编程。我可以有一个线程等待事件/中断，然后在事件发生时处理事情。如果它真的是单线程的，那么在处理第一个事件时，任何进入的额外事件都会被阻塞或丢失。如果我有一个多线程事件处理模型，那么随着事件的到来，额外的线程将被启动。我在掩饰所需的生产者/工作者机制，但同样，与你的问题水平无关。

为什么服务器在收到事件时开始处理/存储状态信息？好吧，因为它被编程为。:-) 状态处理可能与事件处理相关，也可能不相关。状态处理是独立于事件处理的主题，就像事件不同于线程一样。

这应该回答你提出的所有问题。Jonny 的第一条评论/观点值得留意 - 更具体地说明您不了解的内容将为您提供更好的答案。

# javascript - 在正文之前滚动 div

> ID：10323685
> 
> 赞同：1
> 
> 时间：2012-04-25T20:58:39.467
> 
> 标签：javascript, jquery, dom

我有可滚动的 div。我想在 scrolldown 或 keydown 上滚动框，但我必须单击 div 才能实现。因为当我在页面加载后尝试滚动它时，滚动的是正文。

我应该做什么来首先滚动 div 并在该正文之后？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T21:02:36.930

尝试将焦点设置在 div 上。

使用 jQuery 之类的`$("#myDiv").focus();`.

# python - 执行 ImageEnhance.Sharpness() 时出现“无法过滤调色板图像”错误

> ID：10323692
> 
> 赞同：5
> 
> 时间：2012-04-25T20:59:10.933
> 
> 标签：python, image, image-processing, python-imaging-library, pillow

我有一个 GIF 图像文件。我使用它打开它[`PIL.Image`](http://effbot.org/imagingbook/image.htm)并对其进行了一些尺寸变换。然后我试着用[`ImageSharpness.Enhance()`](http://effbot.org/imagingbook/imageenhance.htm#tag-ImageEnhance.Sharpness)它...

```
sharpener = PIL.ImageEnhance.Sharpness(img)
sharpened = sharpener.enhance(2.0) 
```

这导致异常：

```
<type 'exceptions.ValueError'>
('cannot filter palette images',) 
```

我试图用谷歌搜索这个错误，但没有找到任何东西。有人可以帮我弄清楚出了什么问题吗？

仅供参考，输入图像的模式是`'P'`。如果我使用 jpg 图像，我没有这个问题。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-25T21:31:05.753

```
sharpener = PIL.ImageEnhance.Sharpness (img.convert('RGB')) 
```

算法无法使用基于调色板的图像是很常见的。上面的`convert`将其更改为在每个像素位置具有完整的 RGB 值。

# sql - 阻止 SQL Server Management Studio 破坏我的视野

> ID：10323699
> 
> 赞同：6
> 
> 时间：2012-04-25T20:59:36.320
> 
> 标签：sql, view, format, ssms

我有一个工作正常的视图，大致如下：

```
 WITH xxx AS ( ... ),
      yyy AS ( SELECT ... FROM xxx )

 SELECT ... FROM yyy 
```

非常简单，而且效果很好。但是，出现了一种情况，我需要对`xxx`. 我进入视图编辑器，对 xxx 进行小改动，但是当我保存/执行时，突然 Server Management Studio 的自动格式接管并决定将我的视图更改为：

```
 WITH yyy AS ( SELECT ... FROM xxx),
      xxx AS ( ... )

 SELECT ... FROM yyy 
```

基本上，它无缘无故地切换了我的 WITH 语句的第一部分和第二部分！我尝试将视图编写为新查询的脚本，在那里进行更改并重新创建它，它做同样的事情。

有没有办法关闭自动格式化！？还有其他建议吗！？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-05T15:13:10.943

获胜的唯一方法是完全停止使用视图设计器。

你必须做出选择

*   要么您*确实*关心视图中代码的布局 - 在这种情况下，您将自己在查询编辑器窗口中编写它，或者，
*   您将视图视为完全由视图设计器生成，在这种情况下，您需要忽略它最终的样子。

# google-app-engine - 登录 Google App Engine 会用完任何配额吗？

> ID：10323701
> 
> 赞同：1
> 
> 时间：2012-04-25T20:59:39.223
> 
> 标签：google-app-engine

我正在使用 Google App Engine 并希望减少对数据存储区进行的读/写操作的数量。日志记录会用完这些或任何其他配额吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T22:59:37.970

它们不计入读/写，但它们计入存储。

[https://developers.google.com/appengine/kb/billing#logs_counted_storage_quota](https://developers.google.com/appengine/kb/billing#logs_counted_storage_quota)

# macos - HTML文件的Netbeans代码折叠？

> ID：10323708
> 
> 赞同：3
> 
> 时间：2012-04-25T20:59:49.203
> 
> 标签：macos, html, netbeans, netbeans-7.1

我一直在寻找有关如何使用 Netbeans 将代码折叠到 HTML 文件中的任何信息。有人知道吗？我在使用 Netbeans 7.1.1 的 Mac 上，并且已经打开了 Preferences>General 区域...我在这里遗漏了什么吗？对这个新手的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T00:13:22.720

Code folding is already enabled on elements in an HTML file. You can collapse the individual tags, or groups of tags.

![Code Folding in XHTML  Page](../Images/2bb588ac63a634d43b1c9a20ce5f7cac.png)

# html - 减少标志图形的 HTML 语义

> ID：10323709
> 
> 赞同：1
> 
> 时间：2012-04-25T20:59:53.207
> 
> 标签：html, css

![在此处输入图像描述](../Images/14a5220aa4082d41d8c6aec81555e376.png)
[**jsFiddle 示例**](http://jsfiddle.net/VRXjc/)

我正在寻找最时髦的方法来减少 HTML 语义（css 可以根据需要很大）这个 4 色徽标*不使用图片*，任何结构都可以改变。唯一的要求是它可以在 IE8 中运行。我正在使用 selectivr 和 modernizr 所以大多数选择器类等应该可以工作。此外，我使用的 CSS 较少，所以如果你也可以这样写。

```
 <ul class="logo">
    <li class="webBG"></li>
    <li class="designBG"></li>
    <li class="videoBG"></li>
    <li class="audioBG"></li>
  </ul> 
```

CSS

```
ul.logo{margin: 0 0 0 10px;padding: 0;list-style-type: none;}
ul.logo li{display: inline-block; width:5px;height:5px; padding:0;margin:0; float:left;}
.designBG{background:#00c8e8}
.videoBG{background:#33cc77}
.webBG{background:#ec8544}
.audioBG{background:#E58} 
```

**更新最终解决方案**

```
#boilerplate > div{
margin-left:10px;

width:20px;
height:5px;

/*cross browser definitions follow..*/
background-image: -o-linear-gradient(left,
                        #ec8544 0%, #ec8544 25%,
                        #00c8e8 26%, #00c8e8 50%,
                        #33cc77 51%, #33cc77 75%,
                        #Ee5588 76%, #Ee5588 100%);
background-image: -moz-linear-gradient(left,
                        #ec8544 0%, #ec8544 25%,
                        #00c8e8 26%, #00c8e8 50%,
                        #33cc77 51%, #33cc77 75%,
                        #Ee5588 76%, #Ee5588 100%);
background-image: -webkit-linear-gradient(left,
                        #ec8544 0%, #ec8544 25%,
                        #00c8e8 26%, #00c8e8 50%,
                        #33cc77 51%, #33cc77 75%,
                        #Ee5588 76%, #Ee5588 100%);
background-image: -ms-linear-gradient(left,
                        #ec8544 0%, #ec8544 25%,
                        #00c8e8 26%, #00c8e8 50%,
                        #33cc77 51%, #33cc77 75%,
                        #Ee5588 76%, #Ee5588 100%);
background-image: linear-gradient(left,
                        #ec8544 0%, #ec8544 25%,
                        #00c8e8 26%, #00c8e8 50%,
                        #33cc77 51%, #33cc77 75%,
                        #Ee5588 76%, #Ee5588 100%); 
```

}​</p>

**HTML**

```
<div></div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T21:14:49.057

您可以使用背景线性渐变..

**html**

```
<div class="logo"></div> 
```

**css**

```
.logo{
    margin-left:10px;

    width:20px;
    height:5px;

    /*cross browser definitions follow..*/
    background-image: -o-linear-gradient(left,
                            #ec8544 0%, #ec8544 25%,
                            #00c8e8 26%, #00c8e8 50%,
                            #33cc77 51%, #33cc77 75%,
                            #Ee5588 76%, #Ee5588 100%);
    background-image: -moz-linear-gradient(left,
                            #ec8544 0%, #ec8544 25%,
                            #00c8e8 26%, #00c8e8 50%,
                            #33cc77 51%, #33cc77 75%,
                            #Ee5588 76%, #Ee5588 100%);
    background-image: -webkit-linear-gradient(left,
                            #ec8544 0%, #ec8544 25%,
                            #00c8e8 26%, #00c8e8 50%,
                            #33cc77 51%, #33cc77 75%,
                            #Ee5588 76%, #Ee5588 100%);
    background-image: -ms-linear-gradient(left,
                            #ec8544 0%, #ec8544 25%,
                            #00c8e8 26%, #00c8e8 50%,
                            #33cc77 51%, #33cc77 75%,
                            #Ee5588 76%, #Ee5588 100%);
    background-image: linear-gradient(left,
                            #ec8544 0%, #ec8544 25%,
                            #00c8e8 26%, #00c8e8 50%,
                            #33cc77 51%, #33cc77 75%,
                            #Ee5588 76%, #Ee5588 100%);
} 
```

演示在[http://jsfiddle.net/gaby/yGkhQ/](http://jsfiddle.net/gaby/yGkhQ/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T21:17:28.720

最少的html：

[http://jsfiddle.net/VRXjc/7/](http://jsfiddle.net/VRXjc/7/)

1.  创建 1 个 div

2.  使用 CSS 渐变来制作颜色

3.  将边距、高度和宽度设置为样式

HTML：

```
<div id="logo"></div> 
```

CSS：

```
#logo{
background: #ec8544; /* Old browsers */
background: -moz-linear-gradient(left,  #ec8544 25%, #00c8e8 25%, #00c8e8 50%, #33cc77 50%, #33cc77 75%, #ee5588 75%); /* FF3.6+ */
background: -webkit-gradient(linear, left top, right top, color-stop(25%,#ec8544), color-stop(25%,#00c8e8), color-stop(50%,#00c8e8), color-stop(50%,#33cc77), color-stop(75%,#33cc77), color-stop(75%,#ee5588)); /* Chrome,Safari4+ */
background: -webkit-linear-gradient(left,  #ec8544 25%,#00c8e8 25%,#00c8e8 50%,#33cc77 50%,#33cc77 75%,#ee5588 75%); /* Chrome10+,Safari5.1+ */
background: -o-linear-gradient(left,  #ec8544 25%,#00c8e8 25%,#00c8e8 50%,#33cc77 50%,#33cc77 75%,#ee5588 75%); /* Opera 11.10+ */
background: -ms-linear-gradient(left,  #ec8544 25%,#00c8e8 25%,#00c8e8 50%,#33cc77 50%,#33cc77 75%,#ee5588 75%); /* IE10+ */
background: linear-gradient(left,  #ec8544 25%,#00c8e8 25%,#00c8e8 50%,#33cc77 50%,#33cc77 75%,#ee5588 75%); /* W3C */
filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#ec8544', endColorstr='#ee5588',GradientType=1 ); /* IE6-9 */
margin: 0px 0px 0px 15px;
width:20px;
height:5px;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T21:10:26.790

HTML：

```
 <div id="boilerplate">
      <ul>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
      </ul>
  </div> 
```

CSS：

```
div#boilerplate{}
div#boilerplate ul{margin: 0 0 0 10px;padding: 0;list-style-type: none;}
div#boilerplate ul li{display: inline-block; width:5px;height:5px; padding:0;margin:0; float:left;}
div#boilerplate ul li:first-child {background:#00c8e8;}
div#boilerplate ul li:nth-child(2) {background:#33cc77;}
div#boilerplate ul li:nth-child(3) {background:#ec8544;}
div#boilerplate ul li:last-child {background:#E58;} 
```

# jquery - 用于状态消息的 JQuery UI 模式对话框直到最后都不会更新

> ID：10323711
> 
> 赞同：2
> 
> 时间：2012-04-25T20:59:55.803
> 
> 标签：jquery, internet-explorer, user-interface, modal-dialog, status

原始问题似乎存在两个问题：1）睡眠功能没有正确模拟长时间运行的操作，例如 HTML 请求。2) IE，至少 v8 和 v9 似乎没有像 Firefox 那样正确更新它们的显示。有人知道强制 IE 处理 UI 更新的方法吗？以下在 Firefox 上运行良好，但 IE 直到最后才更新运行计数的显示，除非我插入强制暂停的警报。如果有 50 个项目并且批量大小为 10，我希望显示运行计数的 HTML 显示 10、20、30、40、50。在 IE 中，它最后从 10 跳到 50，而 Firefox 正确更新。

```
while (done == false) {
    var url = 'myLongRunningOperation.com/doSomething.html&LastID='+lastPriorIndex;
    $.ajax({
    type: 'GET',
    url: url,
    dataType: 'json',
    success: function(data) { 
        soFar += data.Succeeded + data.Failed;
        $('#numCompleted').val(soFar).show();
        LastPriorIndex= data.LastID;
        if (soFar >= totalNumberOFDocs) {
        done = true;
        }
    },
    data: {},
    async: false
    });
} 
```

我正在尝试使用 JQuery UI 模式对话框作为状态对话框。首先它应该显示，然后在长时间运行的操作完成并添加到 HTML 时处理更新消息。但是，对话框直到最后才显示，然后显示所有消息。如果我在显示对话框后立即发出警报，它会显示，但在操作全部完成后会立即显示消息更新。我希望我所需要的只是某种检查消息队列功能来更新它，因为警报会导致对话框显示。或者可能是我模拟日志运行操作的方法，这是模拟睡眠的问题。

```
 $(function() {
        $("#dialog2").dialog({
            bgiframe: false
            ,height: 140
            ,modal: true
            ,autoOpen: false
        });

    });
    function TestModalUpdate2() {
        $('#dialog2').dialog("open");
        //alert('foo'); //if this alert is present the dialog shows before the doSomething calls execute but wont update till all of them are done
        $('#dialog2').show();
        var i
        for(i = 0; i < 5; i++) {
            doSomething($('#dialog2'));
            $('#dialog2').show();
        }
    }

    function doSomething(obj1) {
        wait(1000);
        obj1.html(obj1.html()+"<p>new line</p>")
                //alert('this will also cause the dialog to update in between doSomethings')
    }
    function wait(msecs) {
        var start = new Date().getTime();
        var cur = start
        while(cur - start < msecs) {
            cur = new Date().getTime();
        }
    } 
<input type="button" id="Test2" onclick="TestModalUpdate2();" value="Test2"/> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T05:20:43.950

除此之外，我也有同样的问题，但我也在使用 jqgrid，并使用 jqgrid saveRow 函数。我认为这可能会导致问题，但不能 100% 确定。

它甚至会在我的对话框中阻止动画 gif 的渲染，所以至少可以这么说：)

我正在做类似的事情

`$("#WOTaskList").jqGrid('saveRow', rowArray[rowIndex], onSave, null, null, null, onSaveError)`

在我的 onSave

`$(".waitUIText").html("<span>Saved " + nSavedRows + " of " + nEditeddRows + "</span>");`

而且......现在我已经解决了...... jqgrid同步默认阻止保存调用：/

将 ajaxRowOptions: { async: true } 添加到 jqgrid 默认初始化中，并且对话框现在按预期更新..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T18:56:21.960

在进一步研究表明在同步模式下运行可能很麻烦后，我将其转换为可以工作的递归版本。

```
function processBatch() {
    var url = 'DoSomethingLongRunning.html&StartingIndex='+startingIndex+'&BatchSize='+batchSize;
    $.getJSON(url 
        ,function(data) { 
            soFar1 += data.Succeeded + data.Failed;
            $('#numCompleted').val(soFar1).show();
            startingIndex = data.LastID;
            if (soFar1 < totalNumberOfDocs) {
                processBatch();
            }
        }
    );  
} 
```

# javascript - 如何从 web2py 中的视图动态检查登录状态

> ID：10323714
> 
> 赞同：2
> 
> 时间：2012-04-25T21:00:06.737
> 
> 标签：javascript, python, ajax, web2py

我需要检查用户是否仍然登录，以便我可以阻止他们在会话过期时甚至打开表单（注销但页面尚未刷新）。

这是我试图做的伪代码，显然不起作用。

```
// some view.html
$('#someform').click(function() {
    ajax(URL('login_status'), [], '');
});

// some controller.py
def login_status():
    if not auth.user:
        redirect('index') 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T21:23:34.870

如果您希望整个页面作为 Ajax 请求的结果进行重定向，则必须通过客户端上的 Javascript 而不是通过服务器端重定向（只会重定向 Ajax 请求本身）来完成。为此，您可以在`ajax()`函数中指定 ":eval" 作为目标，这将导致返回的响应作为 Javascript 代码执行（参见[此处](http://web2py.com/books/default/chapter/29/11#Eval-target)）。所以，像：

```
$('#someform').click(function() {
    ajax("{{=URL('default', 'login_status')}}", [], ':eval');
});

// some controller.py
def login_status():
    if auth.user:
        return 'this.show()' # or appropriate Javascript code to show the form
    else:
        return 'window.location = "%s"' % URL('default', 'index') 
```

因此，Ajax 调用返回显示表单或重定向页面的 Javascript，具体取决于用户是否登录。

另外，请注意该`URL()`函数是服务器端 Python 函数，因此您不能只在`ajax()`函数内调用它，因为它是客户端 Javascript 函数。相反，您必须将它放在 web2py 的模板分隔符 ( `{{ }}`) 中，以便在服务器上的模板中生成 URL。

更新：而不是：

```
return 'window.location = "%s"' % URL('default', 'index') 
```

你现在可以这样做：

```
redirect(URL('default', 'index'), client_side=True) 
```

这将在幕后做同样的事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-23T20:22:51.887

此外，这可能会有所帮助：

```
{{if auth.is_logged_in():}} 
```

# c# - 为什么这个字符串不格式化为货币？

> ID：10323716
> 
> 赞同：5
> 
> 时间：2012-04-25T21:00:15.090
> 
> 标签：c#, asp.net, formatting

我有以下行：

```
//Send Email
clntMailBody = clntMailBody + "Order Total: " + String.Format("{0:C}", strOrderTotal + "\n"); 
```

观看节目：

```
String.Format("{0:C}", strOrderTotal + "\n")    "35\n"  string 
```

但它只输出“35”。我预计“35.00 美元” 为什么这没有按预期工作？

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-25T21:02:48.273

我猜 strOrderTotal 是一个字符串？我认为`{0:C}`仅适用于十进制或整数类型。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-25T21:34:20.450

我不敢相信所有这些答案，也没有人提到这一点，请将您的代码更改为

```
clntMailBody = clntMailBody + "Order Total: " + String.Format("{0:C}", strOrderTotal) + "\n"; 
```

看看这是否能解决你的问题，但是更好的方法是

```
clntMailBody = String.Format("{0}Order Total: {1:C}\n", clntMailBody, strOrderTotal); 
```

更容易看到发生了什么并删除了很多字符串连接。

如果你愿意做更多的重写，一个更好的解决方案是：（我做了一些逻辑来展示我的例子）

```
StringBuilder clntMailBody = new StringBuilder();

clntMailBody.AppendLine("Some Fixed body Text")

foreach(string lineItem in Invoice)
{
    clntMailBody.AppendLine(lineItem);
}

clntMailBody.AppendFormat("Order Total {0:C}", strOrderTotal).AppendLine();

return clntMailBody.ToString(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-25T21:03:49.800

看起来（基于变量 name `strOrderTotal`）您的总数已经是一个字符串。“C”格式说明符将数字转换为货币格式，而不是已经是字符串的东西。

因此，您需要手动将字符串格式化为货币，或者在订单总额最初转换为字符串时应用货币格式（当它存储在 中时`strOrderTotal`）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-25T21:02:40.303

你没有显示声明，`strOrderTotal`但我假设它已经是一个`string`. 由于它已经是一个字符串，因此格式将不起作用。

如果您希望格式化工作，您需要将订单总数作为数字传递 - 最好是`decimal`.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-04-25T21:02:53.053

因为它是一个字符串。

尝试格式化字符串会返回...字符串。

您需要一个数值才能将其格式化为货币。

您将看到`C`格式说明符是在 MSDN 上的[标准**数字**格式字符串](http://msdn.microsoft.com/en-us/library/dwhawy9k.aspx)页面中定义的。数字，而不是“字符串”。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-04-25T21:02:53.093

我认为 strOrderTotal 是字符串？它必须是十进制或双精度等

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-04-25T21:02:53.950

我将假设这`strOrderTotal`是一个字符串。您应该使用数字类型，例如 double 或 Decimal。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-04-25T21:08:27.483

如果 strOrderTotal 是一个字符串，您可以使用此代码将其格式化为货币

```
clntMailBody = clntMailBody + "Order Total: " + String.Format("{0:C}", decimal.Parse(strOrderTotal) + "\n"); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-12-22T03:00:23.350

以货币格式显示字符串：

```
StringBuilder sb= new StringBuilder("Your total amount is ");
sb.AppendFormat("{0:C} ", 25 );
Console.WriteLine(sb); 
```

输出：

> 您的总金额为 25.00 美元

# iphone - 检查 youtube 视频何时从全屏中消失

> ID：10323717
> 
> 赞同：0
> 
> 时间：2012-04-25T21:00:19.223
> 
> 标签：iphone, objective-c, ios, ipad

我有一个 UIWebView，其中有时里面有一个用于播放视频的 youtube 播放器。用户也可以全屏观看视频。但是问题是当用户全屏观看视频，然后旋转它时，它不会调用 willAnimateToInterfaceOrientation。所以我打算手动调用它。问题是我如何检查何时有人关闭了 youtube 视频？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T23:48:15.753

尝试注册`UIDeviceOrientationDidChangeNotification`自己`viewDidLoad`

```
 [[NSNotificationCenter defaultCenter] addObserver:self
               selector:@selector(didRotate:)
               name:@"UIDeviceOrientationDidChangeNotification" object:nil];

- (void) didRotate:(NSNotification *)notification{  
UIDeviceOrientation orientation = [[UIDevice currentDevice] orientation];

  //Handle rotation 

} 
```

# scala - Scala 短类型安全转换运算符

> ID：10323725
> 
> 赞同：8
> 
> 时间：2012-04-25T21:01:01.953
> 
> 标签：scala

我不喜欢 Scala 的 isInstanceOf 和 asInstanceOf 方法——它们很长而且 asInstanceOf 会抛出异常，所以我们需要同时使用它。更好的方法是使用模式匹配：[Scala: How do I cast a variable?](https://stackoverflow.com/questions/931463/scala-how-do-i-cast-a-variable) 但对于非常简单的操作，它也可能相对较长。在 C# 中，我们有 'is' 和 'as' 运算符，所以我想在 Scala 中用 this 实现隐式定义。我的代码如下所示：

```
scala> class TypeCast(x:Any){
     | def is[T](t:Class[T]) = t.isInstance(x) 
     | def as[T](t:Class[T]):Option[T] = if(t.isInstance(x)) Option(t.cast(x)) else None
     | }
defined class TypeCast

scala> implicit def TypeCastID(x:Any)=new TypeCast(x)
TypeCastID: (x: Any)TypeCast

scala>  123 as classOf[String]
res14: Option[String] = None

scala> "asd" as classOf[String]
res15: Option[String] = Some(asd) 
```

它有一个优点 - 实现空对象模式，但也有缺点：

*   需要使用 classOf[T] 运算符 - 它太长了

*   对于这种简单的操作，与隐式 def 相关的开销

所以没有实际的理由使用它。我想知道有没有什么方法可以在不需要使用 classOf[T] 的情况下实现这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-25T21:13:42.317

好吧，您可以在 TypeCast 类中创建的 def 中将其缩短。因此，您可以只依赖类型，而不是为其提供参数。这样会缩短很多。例如，这可能类似于：

```
class TypeCast(x : Any) {
    def is[T : Manifest] = manifest.erasure.isInstance(x)
    def as[T : Manifest] : Option[T] = if (manifest.erasure.isInstance(x)) Some(x.asInstanceOf[T]) else None
} 
```

未来的调用可能如下所示：

```
scala> 123.as[String]
res0: Option[String] = Some(123)
scala> class A; class B extends A
defined class A
defined class B
scala> new B
res1: B
scala> res1.is[Int]
res2: Boolean = false
scala> res1.as[Int]
res3: Option[Int] = None 
```

更新：我添加了清单以避免类型检查错误

# go - Go - 具有数组和丢失值的递归结构

> ID：10323731
> 
> 赞同：1
> 
> 时间：2012-04-25T21:01:16.783
> 
> 标签：go

我创建了一个具有父级和子级的 Element 结构，创建了一个名为 SubElement 的辅助函数，以及一个遍历所有子级以进行打印的 String 方法：

```
package main

import "fmt"

type Element struct {
  parent *Element
  children []Element
  tag string
}

func SubElement(parent *Element, tag string) Element {
  el := Element{}
  el.parent = parent
  el.tag = tag
  parent.children = append(parent.children, el)
  return el
}

func (el Element) String() string {
  s := "<" + el.tag + ">"
  for _, child := range el.children {
    s += child.String()
  }
  s += "</" + el.tag + ">"
  return s
}

func main() {
  root := Element{}
  root.tag = "root"

  a := SubElement(&root, "a")
  b := SubElement(&a, "b")
  SubElement(&b, "c")

  fmt.Println(root) // prints: <root><a></a></root>
  fmt.Println(a) // prints: <a><b></b></a>
  // and so on
} 
```

我遇到的问题是，我选择打印的根节点只有第一层子节点可用。我确定这与在 parent.children 上使用 append 有关，但缺乏对如何正确解决此问题的理解。

为了解决这个问题，我`children`改为`map[int]Element`. 然后在我的 SubElement 函数中，我用`parent.children[len(parent.children)] = el`. 然后以正确的顺序迭代，String 方法 for-loop 是`for i:= 0; i < len(el.children); i++`，访问`el.children[i]`.

不过，我想知道如何使用数组正确执行此操作。谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T23:48:48.973

解释为什么 []Element 版本不起作用的答案。

结构被复制为值。在`SubElement`中，您创建一个`Element`结构，然后在附加它时，实际上附加了该结构的全新副本。当您返回 el 并将其分配给 时`a`，会生成另一个副本。的地址`a`不是`Element`附加的地址。

因此，您可能会变得棘手并获取实际位于切片中的元素的地址，这甚至可能看起来像是在测试用例中工作，但是保留这些指针存在一个问题，例如您在将其存储回来时所做的那样在`Element.parent`. 问题是后续追加可以重新分配切片，现在您保留的指针指向一些孤立的内存，而不是当前有效的切片。

如果 []*Element 版本解决了其他一些问题，那么它们很可能是存储随后被孤立的指针的问题。

可以使用结构切片来实现树，但需要清楚地理解，将指针保留到切片中通常是错误的。由于存储父指针不安全，因此最好将其从结构中删除。

```
package main

import "fmt"

func main() {
    tree := Element{tag: "head"}
    tree.SubElement("tier-1")
    tree.children[0].SubElement("tier-2")
    tree.children[0].SubElement("tier-2")
    tree.SubElement("tier-1")
    tree.children[1].SubElement("tier-2")
    fmt.Println(tree)
}

type Element struct {
    children []Element
    tag      string
}

func (parent *Element) SubElement(tag string) {
    parent.children = append(parent.children, Element{tag: tag})
}

func (el Element) String() string {
    s := "<" + el.tag + ">"
    for _, child := range el.children {
        s += child.String()
    }
    s += "</" + el.tag + ">"
    return s
} 
```

至少，这段代码有效；但是，如果您有其他使用指针的代码，或者使用父指针的代码，则必须重新考虑。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T22:43:22.920

第一条线索是 SubElement 没有像你有它那样编译（编辑：有它）（最初）。你可以尝试让它工作，但我建议你将 Element.children 更改为`[]*Element`而不是`[]Element`. 这是一个工作示例：

```
package main

import "fmt"

func main() {
    tree := &Element{tag: "head"}
    t1 := SubElement(tree, "tier-1")
    SubElement(t1, "tier-2")
    SubElement(t1, "tier-2")
    t1 = SubElement(tree, "tier-1")
    SubElement(t1, "tier-2")
    fmt.Println(tree)
}

type Element struct {
    parent   *Element
    children []*Element
    tag      string
}

func SubElement(parent *Element, tag string) *Element {
    el := &Element{parent: parent, tag: tag}
    parent.children = append(parent.children, el)
    return el
}

func (el *Element) String() string {
    s := "<" + el.tag + ">"
    for _, child := range el.children {
        s += child.String()
    }
    s += "</" + el.tag + ">"
    return s
} 
```

输出：

```
<head><tier-1><tier-2></tier-2><tier-2></tier-2></tier-1><tier-1><tier-2></tier-2></tier-1></head> 
```

# java - 从活动运行或后台 JFrame 调用 JFrame 而无需调用新的 JFrame

> ID：10323732
> 
> 赞同：0
> 
> 时间：2012-04-25T21:01:21.160
> 
> 标签：java, swing, jframe

我在使用 JFrame 时遇到问题。

目前我有 2 个 JFrames 正在运行，MainFrame 带有一个调用 Frame2 的按钮。从带有 JButton 的 Frame2 开始，我想调用当前运行/后台 MainFrame 而无需调用另一个新的 MainFrame。

实际上我在 Frame2 上做了一个搜索功能，当点击按钮搜索时，想在主框架中显示结果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T08:54:50.580

如果 Frame2 继承 MainFrame 则执行以下操作：

```
Frame2.getParent().getBackground(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T10:48:41.803

此类问题有多种解决方案。这实际上取决于最适合您的用例。

在下面的示例中，我使用一个接口向`MainFrame`from发出回调`Frame2`。我假设后者是`MainFrame`. 这种解决方案使您可以轻松地`Frame2`在多个实现中使用相同的实现`MainFrame`（共同搜索多个帧）。

请注意，下面的代码只是用于演示正在使用的模式的骨架代码。

```
public class Frame2 extends JFrame {

    private final Controller controller;
    private JButton button;

    public Frame2(Controller controller) {
        this.controller = controller;
        button = new JButton("Search");
        button.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent e) {
                // do search and create result object
                Object results = new Object();
                Frame2.this.controller.displaySearchResults(results);
            }
        });
    }

    public interface Controller {
        // users implement this
        public void displaySearchResults(Object results);
    }
} 
```

```
public class MainFrame extends JFrame {

    private Frame2 search;
    private JButton button;

    public MainFrame() {
        search = new Frame2(new ControllerImplementation());
        button = new JButton("Show search");
        button.addActionListener(new ShowSearch());
    }

    private class ShowSearch implements ActionListener {
        public void actionPerformed(ActionEvent e) {
            search.setVisible(true);
        }
    }

    private class ControllerImplementation implements Frame2.Controller {
        public void displaySearchResults(Object results) {
            // display results by accessing members of MainFrame
        }

    }
} 
```

这可以帮助你实现你想要的。

# clojure - 在 Incanter 中添加误差线以绘制的惯用方法

> ID：10323733
> 
> 赞同：4
> 
> 时间：2012-04-25T21:01:27.970
> 
> 标签：clojure, incanter

我正在创建一个机器人相信它与地标的距离的情节。x 轴是测量次数，y 轴是到地标的距离，其中应包括误差条以指示此估计的置信度。

我还没有找到一种根据方差值向图中添加误差线的好方法。目前，我正在通过生成关于平均值的样本数据和我的方差值来在每次测量时创建一个箱线图。这显然不理想，因为它的计算效率低下，并且是我试图显示的信息的不精确表示。

关于如何做到这一点的任何想法？理想情况下，它将在 xy 绘图上，并且无需借助 JFreeChart 命令即可完成。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T16:25:51.417

我想我有一些非常接近的东西。首先让我们创建一些随机数据来绘制图表：

```
(def y (for [i (range 20)] (rand-int 100)))
user> (11 14 41 33 25 71 52 34 83 90 80 35 81 63 94 69 97 92 4 91) 
```

现在创建一个情节。你可以使用`xy-plot`，但我喜欢`scatter-plot`更好的外观。

```
(def plot (scatter-plot (range 20) y))
(view plot) 
```

这给了我以下情节

![随机数据](../Images/7b61e5106d63ce70605b95296fce7306.png)

现在我们必须定义一个函数，它接受一个点 (x,y) 并返回一个误差线上下界的向量。我将使用一个简单的方法，它只计算 y 值上下 5%。

```
(defn calc-error-bars [x y]
  (let [delta (* y 0.05)]
    [(- y delta) (+ y delta)])) 
```

现在我们`map`使用这样的函数对数据集进行该`add-lines`函数...

```
(map #(add-lines plot [%1 %1] (calc-error-bars %1 %2)) (range 20) y) 
```

这给了我们这个情节：

![带有误差线的随机数据](../Images/6a06fce4b7fe405f99cb3795f21b27c3.png)

主要问题是所有的条都是不同的颜色。我不确定是否有办法在不使用 JFreeChart 调用的情况下解决这个问题。希望有人会看到这个并告诉我如何解决它。无论如何，这非常接近。

# sencha-touch - 在 Sencha 中设置文本字段的样式

> ID：10323734
> 
> 赞同：0
> 
> 时间：2012-04-25T21:01:45.503
> 
> 标签：sencha-touch, sencha-touch-2

我试图覆盖 Sencha Touch 2 中文本字段组件的默认样式。我尝试过单独的样式表，我也尝试过这个：

```
 xtype: 'textfield',
        name: 'name',
        label: 'Blah',
        disabled: true,
        style: 'color:#000 !important',
        value: 'blah blah', 
```

如何将此 texfield 的字体颜色更改为黑色？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T14:55:29.113

要设置标签样式，请添加`labelCls`config.

要设置文本字段的样式，请使用选择器：

```
input.x-form-field[name="name"]{
  color: your_desired_color;
} 
```

# git - git，如何在不更改当前目录的情况下获取文件的旧版本

> ID：10323735
> 
> 赞同：0
> 
> 时间：2012-04-25T21:01:46.447
> 
> 标签：git

在我的项目中，我做了一些更改，但现在没有任何效果。我找不到我改变了什么。但是，我使用 git。我最近才开始做。我想在不更改当前目录的情况下获取文件的先前版本。我该怎么做？

编辑：我想要将文件反向到特定的版本

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T21:04:46.010

要查看哪些文件已更改：

```
git status 
```

要撤消对特定文件的更改：

```
git checkout <<FileYouChanged>> 
```

如果您想放弃自上次提交以来的所有更改：

```
git reset --hard HEAD 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T21:30:12.963

你可以检查你改变了什么

`git status`

如果你还没有提交，你可以做

`git stash`或者`git reset --hard HEAD`

如果您确实提交但想保留您的更改您可以使用下面的命令和 x 作为您要重置的提交数

`git reset --mixed HEAD~x`

如果您确实提交并且想要摆脱您的更改，请执行上面的命令`--hard`而不是`--mixed`

但是，如果您提交并想要了解您的更改并推送到任意存储库（将更改推送到另一台服务器），请不要忘记强制推送存储库

`git push -f origin branch`

要撤消一个文件，请使用

`git checkout filename`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T21:06:22.887

也使用

```
 git diff 
```

找出这些变化是什么

# c# - rollingfileappender datepattern 设置不是每分钟创建文件

> ID：10323737
> 
> 赞同：0
> 
> 时间：2012-04-25T21:01:53.490
> 
> 标签：c#, asp.net, log4net, rollingfileappender

```
 <appender name="RollingFileAppender" type="log4net.Appender.RollingFileAppender">
    <file value="c:\temp\mylogfile.txt"/>
    <appendToFile value="true"/>
    <rollingStyle value="Date"/>
    <datePattern value="yyyyMMdd" />
    <maxSizeRollBackups value="5"/>
    <maximumFileSize value="9KB"/>
    <staticLogFileName value="true"/> 
```

如何设置 datePattern 值以便每分钟创建一个文件？我用谷歌搜索并尝试了不同的设置，但它们不起作用。请帮忙。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T12:28:56.713

```
<datePattern value="yyyy-MM-dd HH:mm" /> 
```

应该可以工作，但文件名有一个限制，你不能使用：所以你必须删除：像这样的表单文件名

```
<datePattern value="yyyy-MM-dd HH mm" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T21:24:09.253

您需要调整 datePattern 以在分钟内结束。

```
<datePattern value="yyyy-MM-dd HH:mm" /> 
```

来源： http: [//geekswithblogs.net/rgupta/archive/2009/03/03/tips-on-using-log4net-rollingfileappender.aspx](http://geekswithblogs.net/rgupta/archive/2009/03/03/tips-on-using-log4net-rollingfileappender.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T21:24:15.533

> RollingFileAppender 可以根据 RollingStyle 属性的设置基于大小或日期或两者滚动日志文件。当设置为 Size 时，日志文件将在其大小超过 MaximumFileSize 时滚动。当设置为 Date 时，一旦越过 DatePattern 属性中指定的日期边界，日志文件就会滚动。

您的 DatePattern 设置为每天而不是每分钟翻转。您需要在 datePattern 属性中包含小时和分钟。

# c++ - 我们什么时候不应该在构造函数中使用初始化列表？

> ID：10323739
> 
> 赞同：4
> 
> 时间：2012-04-25T21:02:00.317
> 
> 标签：c++, constructor

当我们不应该在构造函数中使用初始化列表时，有人可以引用一个示例代码，以及如何通过赋值来克服它？

我正在寻找以下语句的示例

> 当您的类有两个需要以`this`不同顺序初始化对象的数据成员的构造函数时，可能会发生这种情况。或者，当两个数据成员是自引用的时，它可能会发生。或者当数据成员需要对 this 对象的引用，并且您希望避免编译器警告在开始构造函数主体的 { 之前使用 this 关键字（当您的特定编译器恰好发出该特定警告时）。或者当您需要在使用该变量初始化您的 this 成员之一之前对变量（参数、全局等）进行 if/throw 测试时。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T21:07:21.377

我相信您的陈述作者所指的主要概念是，对初始化列表中的变量的调用**不是按照您在初始化列表中看到它们的顺序发生的，而是按照变量在****类**中列出的顺序发生的**定义**。

这意味着

*   如果您有两个使用初始化列表的不同构造函数，它们**必须**以相同的顺序初始化它们
*   您对排序的控制（如果您有相互依赖的成员，这可能很重要）是有限的

我建议您看一下`Effective C++`涵盖此内容的 Scott Meyer（在许多其他有用且信息丰富的主题中）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T22:32:00.803

这里有些例子：

> 当您的类有两个需要以不同顺序初始化 this 对象的数据成员的构造函数时，可能会发生这种情况。

```
class Example1 {
 public:
  Example1(std::string decoded, std::string encoded)
      : decoded_(decoded),
        encoded_(encoded) {}
  explicit Example1(std::string encoded)
      : decoded_(),  // Can't use "decoded_(Decode())" since "encoded_" isn't initialised
        encoded_(encoded) {
    decoded_ = Decode();  // Assign here instead of initialising
  }
 private:
  std::string Decode();  // decodes class member "encoded_"
  std::string decoded_, encoded_;
}; 
```

在此示例中，`decoded_`将始终在之前初始化，`encoded_`因为这是它们在类中声明的顺序，即使我们在初始化列表中交换它们的顺序。

> 或者当数据成员需要对 this 对象的引用，并且您希望避免在开始构造函数主体的 { 之前使用 this 关键字的编译器警告（当您的特定编译器恰好发出该特定警告时）。

```
class Example2 {
 public:
  Example2() : functor_() {
    functor_ = std::bind(&Example2::Do, this);
  }
 private:
  void Do();
  std::function<void()> functor_;
}; 
```

在这里，`functor_`需要在`this`初始化/分配时使用。如果我们要`functor_`在初始化列表中进行初始化，则`this`指针将指向一个当时尚未完全初始化的对象。根据特定情况，这可能是安全的，但万无一失的选项是将设置推迟`functor_`到构造函数主体内部，此时`this` *确实*引用了完全初始化的对象。

> 或者当您需要在使用该变量初始化您的 this 成员之一之前对变量（参数、全局等）进行 if/throw 测试时。

```
class Example3 {
 public:
  Example3(int force, int acceleration)
      : force_(force),
        acceleration_(acceleration),
        mass_(0) {
    if (acceleration_ == 0)
      throw std::exception("Can't divide by 0");
    mass_ = force_ / acceleration_;
  }
 private:
  int force_, acceleration_, mass_;
}; 
```

希望这是不言自明的。

我不确定是什么意思

> 当两个数据成员是自引用的

所以恐怕我不能举一个例子。

# caching - 通过 iframe 预取第 3 方页面（用于浏览器缓存）

> ID：10323749
> 
> 赞同：1
> 
> 时间：2012-04-25T21:02:43.717
> 
> 标签：caching, iframe, browser, httpwebrequest

我将用户发送到响应时间不同的各种第三方站点。当一个网站速度很慢时，它真的会扼杀用户体验。

在用户点击第三方站点之前，他们浏览的页面与第三方站点的页面具有一对一的关系。

我正在考虑在我的页面上打开一个 1px iframe，它（理论上）会在用户的浏览器中缓存来自第三方站点的资产。

这听起来很有趣吗？从浏览器缓存的角度来看它是否有效（我知道它取决于第 3 方站点的浏览器缓存指令）。我也明白这将是一种模棱两可的互联网做法。

谢谢，本

# c# - C# .NET - 存储一些非常小规模的持久信息的方法？

> ID：10323755
> 
> 赞同：26
> 
> 时间：2012-04-25T21:03:12.697
> 
> 标签：c#, .net, persistent-storage

我有一个应用程序需要极少的持久存储。实际上，我们谈论的是 < 30 个整数。应用程序所需要的只是在下次启动时知道这些整数（并且整数在运行时会发生变化）。

数据库对此太过分了，但我也不想只使用文本文件。

C# 是否有任何机制可以在运行之间保持这样的小值？我注意到您可以将内容存储在资源文件和其他一些地方 - 我不知道您是否可以在运行时更改它们。我只是为了一份新工作而学习 C# 和 .NET，如果这是一个愚蠢的问题，我深表歉意！

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-04-25T21:14:01.763

这是[另一篇 SO](https://stackoverflow.com/questions/453161/best-practice-to-save-application-settings-in-a-windows-application)帖子的摘要，解释了如何设置应用程序设置，这是一个基于文件的简单解决方案，用于读取/写入值。

"*如果您使用 Visual Studio，那么很容易获得持久设置。**右键单击解决方案资源管理器中的项目，选择属性。选择设置选项卡，如果设置不存在，请单击超链接。**使用设置选项卡创建应用程序设置。Visual Studio 创建文件 Settings.settings 和 Settings.Designer.settings，其中包含从 ApplicationSettingsBase 继承的单例类 Settings。您可以从代码中访问此类以读取/写入应用程序设置：* “

```
Settings.Default["SomeProperty"] = "Some Value";
Settings.Default.Save(); // Saves settings in application configuration file 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-25T21:11:40.693

您可以将列表序列化为 xml 文件。这是您保存它的方式：

```
var xs = new System.Xml.Serialization.XmlSerializer(typeof(List<int>));
List<int> ints = new List<int> { 1, 2, 3 };

using (FileStream fs = new FileStream(@"C:\store.xml", FileMode.OpenOrCreate))
{
    xs.Serialize(fs, ints); 
} 
```

检索它同样容易：

```
using (FileStream fs = new FileStream(@"C:\store.xml", FileMode.OpenOrCreate))
{
    ints = xs.Deserialize(fs) as List<int>;
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-04-25T21:06:00.067

我会使用嵌入的 sqlite 数据库。

[http://www.codeproject.com/Articles/22165/Using-SQLite-in-your-C-Application](http://www.codeproject.com/Articles/22165/Using-SQLite-in-your-C-Application)

SQLite 是一个小型、快速且可嵌入的数据库，其中数据库引擎和接口组合到一个库中。它还能够将所有数据存储在一个文件中。因此，如果您的应用程序需要一个独立的数据库，SQLite 可能是您的完美选择。当然，选择 SQLite 还有其他原因，包括：

SQLite 内存占用小，访问数据库只需要一个库，非常适合嵌入式数据库应用程序。SQLite 已被移植到许多平台，甚至可以在 Windows CE 和 Palm OS 上运行。SQLite 符合 ACID，满足所有四个标准 - 原子性、一致性、隔离性和持久性。SQLite 实现了 ANSI-92 SQL 标准的一个大子集，包括视图、子查询和触发器。没有额外的数据库驱动程序的问题，需要 ODBC 配置。只需将库和数据文件包含在您的应用程序中即可。SQLite 有用于 C/C++、PHP、Perl、Python、Tcl 等的原生语言 API。C# 的原生 API 仍然不存在。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-04-25T21:29:30.857

如果您使用的是 c# 4.0 及更高版本，您可能想看看新的[Memory Mapped Files](http://msdn.microsoft.com/en-us/library/dd997372.aspx)。

使用 Persisted Memory Mapped 文件可以让您轻松使用文件，但可以加快映射到内存的速度。当然，您仍然必须自己管理文件格式。

> *   持久化内存映射文件
> 
> 持久文件是与磁盘上的源文件相关联的内存映射文件。当最后一个进程完成对文件的处理后，数据将保存到磁盘上的源文件中。这些内存映射文件适用于处理非常大的源文件。

对于 30 个整数来说，这可能有点过分了，但这是另一种选择，尤其是在速度很关键的情况下。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-04-25T21:14:38.883

我会选择文件存储并避免使用数据库或注册表作为框架的第一个它需要的第二个......哦，好吧，永远不要玩 Registry :)

使用 XML 作为文件存储，这是一本很好的读物：

> [如何解析 XML 文件？](https://stackoverflow.com/questions/55828/best-practices-to-parse-xml-files)

您可以创建文件以将所有 ID 保存在同一个节点中，或者为每个节点编写一个 ID，这取决于您，这样就可以了：

```
<?xml version="1.0" encoding="utf-8" ?> 
<settings>
    <selected>
        <id>1</id>
        <id>8</id>
        <id>12</id>
        <id>15</id>
    </selected>
</settings> 
```

为了创建这样的文件：

```
 XmlDocument doc = new XmlDocument();
  XmlElement set = (XmlElement)doc.AppendChild(doc.CreateElement("settings"));
  XmlElement sel = (XmlElement)set.AppendChild(doc.CreateElement("selected"));

  int[] selectedIds = new int[] { 1, 2, 3, 4, 5 };

  foreach (int id in selectedIds)
     sel.AppendChild(doc.CreateElement("id")).InnerText = id.ToString();

  string path = Path.GetDirectoryName(Application.ExecutablePath);
  doc.Save(path + "/settings.xml"); 
```

为了阅读，您可以使用`XmlReader`, `XmlTextReader`,`XDocument`等...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-02-11T11:18:38.557

您可以使用`IMemoryCache`和`AcroFS`库作为持久性的附加层！

您只需要调用`.Persistent()`方法来获取内存缓存的持久实例。

```
_memoryCache
   .Persistent()
   .Set(key, value, TimeSpan.FromMinutes(1)); 
```

如果您不需要缓存，您可以简单地使用`AcroFS`without `IMemoryCache`：

```
var _repository = FileStore.CreateStore();

// store the model with a custpm key
_repository.Store("my-model", MyModel);

// load model
var model = _repository.Load<MyModel>("my-model"); 
```

# ios - Youtube 解雇事件 (iOS)

> ID：10323756
> 
> 赞同：5
> 
> 时间：2012-04-25T21:03:13.943
> 
> 标签：ios, xcode, youtube, notifications

再会，

通过使用 UIWebview，我现在有了一种在我的应用程序中显示 youtube 视频的工作方法（使用标签，在 webview 中找到播放按钮并触发触摸事件）。

奇迹般有效。视频弹出并播放。但是，我想在视频结束或用户单击完成按钮时收到一个事件。

在互联网上我发现有一个事件： MPAVControllerItemPlaybackDidEndNotification 可以收听。但是，这个不会被调用。

经过进一步研究，我发现对于通过 UIWebView 嵌入的 Youtube 视频，另一个通知被调用（ UIMoviePlayerControllerDidExitFullscreenNotification ）。不幸的是，那个也不再起作用了。（[在这里找到](https://stackoverflow.com/questions/8518719/how-to-receive-nsnotifications-from-uiwebview-embedded-youtube-video-playback/8554040#8554040)）

有谁知道在视频播放完毕或被关闭后我可以如何做一些动作？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-01T21:38:14.150

用户点击完成按钮后，使用`UIMoviePlayerControllerWillExitFullscreenNotification`获取通知。在`UIMoviePlayerControllerDidExitFullscreenNotification`iOS6 上似乎确实被省略了。

请注意***...做了...***与***...将...***不同！

有关该主题的更多信息，请再次检查您在问题中引用的帖子中的更新答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-21T08:44:22.053

让我们看一下这个场景：

![在此处输入图像描述](../Images/92d6e41c40d22ae81d303b2d88c25007.png)

在您看来，您有一个按钮。单击它时，您想直接播放视频。为了做到这一点，你打开 webview 作为你的视图的模式视图：

```
[self presentModalViewController:videoWebView animated:NO]; 
```

对于您的 webview，您应该使用 Youtube API 来集成和自动播放视频。在此处查看建议的工作示例：[https ://stackoverflow.com/a/15538968](https://stackoverflow.com/a/15538968)

您将看到视频在您的 webview 视图的模态视图中启动。检测视频何时关闭（单击“完成”按钮时）的一种方法是使用`viewDidAppear`webview 视图类。在这种方法中，您也将关闭 webview 视图，但是......当这个视图首先启动时，您不想关闭它。您可以添加一个布尔属性来避免这种情况。

```
- (void)viewDidAppear:(BOOL)animated {
    [super viewDidAppear:animated];

    if (_videoLaunched) {
        [self dismissModalViewControllerAnimated:YES];
    }
} 
```

在`viewDidLoad`方法中，将此属性设置为 NO，并在`webViewDidFinishLoad`方法（webview 的委托方法）中将其设置为 YES。

我认为它回答了你问题的一部分。关于视频结束的检测，您必须修改`YT_Player.html`文件以收听状态更改。

```
ytPlayer = new YT.Player('media_area', {height: '100%', width: '100%', videoId: 'SbPFDcspRBA',
                                 events: {'onReady': onPlayerReady, 'onStateChange': onPlayerStateChange}

function onPlayerStateChange(e) {
        var result = JSON.parse(event.data);
        if (result.info == 0) { // Video end
            window.location = "videomessage://end";
        }
    }
                                 }); 
```

然后，您将在 webview 视图中捕获该事件并像这样将其关闭：

```
-(BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType {
    NSURL *url = request.URL;
    if ([[url scheme] isEqualToString:@"videomessage"]) {
        [self dismissModalViewControllerAnimated:YES];
        return YES;
    }
    return YES;
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-25T18:58:31.163

你在这里需要的是这样的：

```
- (void)playerWillExitFullscreen:(NSNotification *)notification
{
//do something...
}

[[NSNotificationCenter defaultCenter] addObserver:self
                                     selector:@selector(playerWillExitFullscreen:) 
name:@"MPMoviePlayerWillExitFullscreenNotification" object:nil]; 
```

# grep - grep 无法找到所有模式匹配 "\[\[\[\["

> ID：10323757
> 
> 赞同：3
> 
> 时间：2012-04-25T21:03:15.050
> 
> 标签：grep

我在使用 grep 和管道时遇到问题。场景如下：我正在运行一个 python 脚本，它输出（使用打印）到屏幕调试消息。我`./prog | grep "\[\[\[\["`用来捕捉带有“[[[[”的字符串。它返回的匹配结果很少，但不返回其他结果（另一个观察结果：grep 找到的结果在文件中 grep 未找到的结果之前）。我已经运行了`./prog`无管道和 grep，它以“[[[[”模式输出所有字符串。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T21:11:53.407

问题是左方括号是正则表达式中的特殊字符。“grep”不仅仅是一个字符串匹配器。正则表达式是一种涉及语言，可让您描述文本模式。Grep 试图解释`[[[[`为一个正则表达式，而不仅仅是一个字符串。

正如您的问题主题所暗示的，您通常可以使用反斜杠转义特殊字符。所以以下可能有效：

```
./prog | grep '\[\[\[\[' 
```

您还可以通过将方括号放在方括号内来“转义”方*括号*。因此，`[[][[][[][[]`或者`[[]{4}`如果您的 grep 版本可以处理它。

您还需要确定您的程序`./prog`是发送输出到“标准输出”还是“标准错误”。您可以使用以下命令将所有 stderr 通过管道：

```
./proc 2>&1 | egrep '[[]{4}' 
```

**更新：**

```
[ghoti@pc ~]$ printf '[[[[\n[[[\n[[[[\n[[[[[\n[[\n' | grep '\[\[\[\['
[[[[
[[[[
[[[[[
[ghoti@pc ~]$ printf '[[[[\n[[[\n[[[[\n[[[[[\n[[\n' | egrep '[[]{4}'
[[[[
[[[[
[[[[[
[ghoti@pc ~]$ 
```

显然，我的结果与您的结果不符。如果您可以提供有关您正在处理的数据的更多详细信息，这将有助于尝试复制您的结果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T21:10:06.863

错误消息通常发送到`stderr`，而不是`stdout`；您的管道正在过滤`stdout`。（您的“另一个观察”暗示了这一点。）您可以重定向`stderr`到`stdout`管道：

```
./prog 2>&1 | grep '\[\[\[\[' 
```

# java - 字符串中的二进制搜索多维数组

> ID：10323759
> 
> 赞同：-3
> 
> 时间：2012-04-25T21:03:26.673
> 
> 标签：java, search, binary-search

事实上，我正在做我的家庭作业。而且，我真的被困住了。

我需要以正确的方式学习 Java。我的老师没有教我们使用字符串进行二分搜索。所以，我不得不至少花几个小时研究这个话题。

我需要一些简单的解释和代码。

**例如**：

```
String[][] data={{"John abc","123"},{"Nike cbd","321"}}; 
```

我需要输入来搜索“ *John* ”，它会显示输出“ *John abc, 123* ”。

有人可以就二分搜索的原则提出一些指导吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T21:09:15.883

字符串可以像数字一样进行排序和比较，使用字母字符串比较。为简单起见，我们假设只有英语，“ABD”大于“ABC”等等。

因此，您为数字找到的任何二进制搜索算法示例都适用于字符串，前提是您拥有的列表当然是排序的。这个想法当然很简单 - 每次迭代将候选人缩小一半，直到找到合适的候选人。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-11T16:24:05.490

`Arrays.binarySearch`目前支持一维数组。

因此，您必须将数组缩小到一维，然后调用`binarySearch()`.

例子：

```
for(String[] oneDimension : multiDimension ){
   Arrays.sort(oneDimension);
   Arrays.binarySearch(oneDimension, 'search-field');
} 
```

# php - 有人可以帮我解决这个问题吗

> ID：10323761
> 
> 赞同：0
> 
> 时间：2012-04-25T21:03:32.280
> 
> 标签：php, javascript, gd

这是我的网站。我正在尝试制作自己的测试 URL：

[http://boats.instantonlinesuccess.co.uk/boat-names.html](http://boats.instantonlinesuccess.co.uk/boat-names.html)

如果你看它，你可以看到我正在尝试做的事情。我正在尝试将 JavaScript 链接到我的 PHP，因此文字会出现效果/效果颜色/颜色。这一切都是通过我正在尝试编写的 PHP 脚本生成的。

这是我的PHP：

```
<?php header("Content-type: image/png");
    $string = $_GET['text'];
    $currentFont =$_GET['font'];
    $currentTextColour = $_GET['colour'];
    $currentEffect = $_GET['effect'];
    $currentEffectColour = $_GET['effectcolour'];
    $im = imagecreatefrompng("images/test.png");
    $px = (imagesx($im) - 7.5 * strlen($string)) / 2;
    //if you exactly know the RGB color indexes//
    $rgb = imagecolorexact($im, 0, 0, 0);
    //or keep the rgb color by position so at top 0 left 0 
    $rgb = imagecolorat($im, 0, 0);
    imagecolortransparent($im, $rgb);
    imagestring($im, 64, $px, 16, $string, $currentTextColour);
    imagepng($im); imagedestroy($im); 
?> 
```

如果您需要 JavaScript，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T21:15:42.820

您可以尝试将第一行更改为此来调试问题：

`header('Content-Type: text/plain');`

# mysql - MYSQL插入错误信息

> ID：10323765
> 
> 赞同：0
> 
> 时间：2012-04-25T21:03:53.203
> 
> 标签：mysql

我正在插入价值

```
insert into user (name,fbid) Values ('Adi Mathur',100000564553314) 
```

但是在数据库中我看到了 fbid 的值

> 2147483647

为什么 ？我应该如何解决？

> fbid int(50)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T21:05:06.377

如[手册](http://dev.mysql.com/doc/refman/5.5/en/integer-types.html)中所述，a (signed) 的`INT`最大值为 2,147,483,647，占用 4 字节/32 位；对于整数数据类型，[括号中](http://dev.mysql.com/doc/refman/5.5/en/data-types.html)的数字是显示宽度，它只影响数据的显示方式，而不影响分配给存储的空间大小：

> `M`表示整数类型的最大显示宽度。对于浮点和定点类型，`M`是可以存储的总位数（精度）。对于字符串类型，`M`是最大长度。M 的最大允许值取决于数据类型。

你可能想要一个`BIGINT`.

# .net - 正确使用数据表

> ID：10323767
> 
> 赞同：1
> 
> 时间：2012-04-25T21:04:00.160
> 
> 标签：.net, powershell, datatable, oledb

我有一个按需运行的 powershell 进程，它通过 Web 服务调用从应用程序收集所有“请求历史记录”日志。结果请求被强制转换为对象，并且 NoteProperty 值（属性-值对）每周以一个大列表数组（通常 1400 个项目）结束。

我想要做的是存储所有这些请求以用于历史目的，这样应用程序就不会自行清除它们。因此，我在数据库上创建了一个简单的表，该表存储了我新创建的数据库中尚不存在的每个请求的所有属性值对。

然后，我在 powershell 脚本中设置了与 MSSQL 服务器的 OleDB 连接，并从表中选择所有记录来填充 DataTable（我不擅长使用 OleDB 或 DataTables）。之后，我循环遍历列表数组中的每个项目以验证它在 DataTable 中不存在。对于每条不存在的记录，我在 DataTable 中添加一个带有属性值对的新行。从那里我假设命令生成器有助于插入语句，因此我不必检查每个属性值是否为空或空白，甚至根本不需要编写查询。最后，我用新添加的 DataTable“更新”了 OleDBAdapter。

虽然这个过程有效，但我意识到它正在做的是从数据库中提取所有数据，然后与我的列表数组进行比较并重新提交新添加的记录。数据库越大，所需的时间就越长。无论如何，无需编写任何 SQL 语句就可以快速、更有效地做到这一点吗？我喜欢 CommandBuilder 如何为 DataTables 工作。

以下是获取所有“请求历史记录”对象后调用以更新数据库的函数

```
function UpdateDatabase([Parameter(Mandatory=$true)] $allRequests)
{
    $objOleDbConnection = New-Object "System.Data.OleDb.OleDbConnection"
    $objOleDbCommand = New-Object "System.Data.OleDb.OleDbCommand"
    $objOleDbAdapter = New-Object "System.Data.OleDb.OleDbDataAdapter"
    $objDataTable = New-Object "System.Data.DataTable"

    $objOleDbConnection.ConnectionString = "Provider=SQLNCLI10;Server=SERVER;Database=DB1;Trusted_Connection=yes;"
    $objOleDbConnection.Open()

    $objOleDbCommand.Connection = $objOleDbConnection
    $objOleDbCommand.CommandText = "SELECT * FROM dbo.RequestLog"

    ##set the Adapter object and command builder
    $objOleDbAdapter.SelectCommand = $objOleDbCommand
    $objOleDbCommandBuilder = New-Object "System.Data.OleDb.OleDbCommandBuilder"
    $objOleDbCommandBuilder.DataAdapter = $objOleDbAdapter

    ##fill the objDataTable object with the results
    [void] $objOleDbAdapter.Fill($objDataTable)
    [void] $objOleDbAdapter.FillSchema($objDataTable,[System.Data.SchemaType]::Source)

    #store all the primary keys in a list for kicking out dups
    $sql_id = @()
    $objDataTable.Rows | foreach { $sql_id += $_.PKID}

    #####

    #loop through all the requests
    trap {
    "Error: $($i)"
    }
    $i = 0
    $total = $allRequests.count
    foreach ($request in $allRequests)
    {       
        $i++
        write-progress -activity "Filling DataTable" -status "% Complete: $($i/$total*100)" -PercentComplete ($i/$total*100)
        #check to see if entry already exists in our table (by primary key)
        if (!($sql_id -contains $request.PKID.Value))
        {
            #shouldn't have to do this but i noticed sometimes requests are duplicate in the list? (probably restarted the script and caught some old requests
            $sql_id += $request.PKID.Value

            $row = $objDataTable.Rows.Add($request.PKID.Value)
            #go through all the attributes from the request and add them to the table
            $list = get-member -in $request | Where-Object { $_.MemberType -eq "NoteProperty" }
            foreach ($attr in $list)
            {
                if ($request.($attr.name) -ne $null)
                {
                    $row.($attr.name) = $request.($attr.name)
                }
            }

        } else { 
            #PKID already in DB
        }

    }
    #update the database with our new records
    $objOleDbAdapter.Update($objDataTable)

    ## close the connection 
    $objOleDbConnection.Close()
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T16:13:50.837

您将需要编写一些 T-SQL 代码来提高该过程的效率。您需要将新行发送到 SQL Server，以便在 SQL Server 上进行处理。一种解决方案是使用表值参数，它允许您将 DataTable 传递给 SQL Server。我在这里写了一个例子：

[http://sev17.com/2012/04/appending-new-rows-only/](http://sev17.com/2012/04/appending-new-rows-only/)

# asp.net-mvc-3 - 根据角色注册后重定向

> ID：10323775
> 
> 赞同：2
> 
> 时间：2012-04-25T21:04:23.217
> 
> 标签：asp.net-mvc-3, entity-framework-4

用户注册后如何根据角色将用户重定向到不同的页面

我试图在没有任何运气的情况下将以下内容实施到帐户控制器中。

```
// POST: /Account/Register
         [AllowAnonymous]
         [HttpPost]
         public ActionResult Register(RegisterModel model)
         {

             if (ModelState.IsValid)
             {
                 // Attempt to register the user
                 MembershipCreateStatus createStatus;
                 Membership.CreateUser(model.UserName, model.Password, model.Email, null, null, true, null, out createStatus);

                 if (createStatus == MembershipCreateStatus.Success)
                 {
                     FormsAuthentication.SetAuthCookie(model.UserName, false /* createPersistentCookie */);
                     Roles.AddUserToRole(model.UserName, model.Role);

                     {
                         if (Roles.IsUserInRole("Student"))
                         {

                             return RedirectToAction("create, "Student");
                         }
                         else if (Roles.IsUserInRole("Teacher"))
                         {

                             return RedirectToAction("create, "Teacher");
                         }

                         return RedirectToAction("index", "Home");
                     }

                     List<SelectListItem> list = new List<SelectListItem>();
                     SelectListItem item;
                     foreach (String role in Roles.GetAllRoles())
                     {
                         item = new SelectListItem { Text = role, Value = role };
                         list.Add(item);
                     }

                     ViewBag.roleList = (IEnumerable<SelectListItem>)list;

                     ModelState.AddModelError("", ErrorCodeToString(createStatus));

                     // If we got this far, something failed, redisplay form
                     return View(model);
                 }
             }
         } 
```

欢迎任何帮助或建议

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T22:35:09.437

创建了一个新视图并添加了以下代码，

```
@{
        ViewBag.Title = "CreateProfilePage";
    }

    <h2>CreateProfilePage</h2>

    @if (User.IsInRole("Student"))
     {  

      <div> @Html.ActionLink("Create Landlord Profile", "Create", "Student") </div> 

     } 

      @if (User.IsInRole("Teacher"))
     {  

      <div> @Html.ActionLink("Create Teacher Profile", "Create", "Teacher") </div> 
```

帐户控制器中注册的重定向也更改为新视图。

```
// POST: /Account/Register
         [AllowAnonymous]
        [HttpPost]
        public ActionResult Register(RegisterModel model)
        {

            if (ModelState.IsValid)
            {
                // Attempt to register the user
                MembershipCreateStatus createStatus;
                Membership.CreateUser(model.UserName, model.Password, model.Email, null, null, true, null, out createStatus);

                if (createStatus == MembershipCreateStatus.Success)
                {
                    FormsAuthentication.SetAuthCookie(model.UserName, false /* createPersistentCookie */);
                    Roles.AddUserToRole(model.UserName, model.Role);
                   /////changed here/// return RedirectToAction("CreateProfilePage", "Property");
                }
                else
                {

                    List<SelectListItem> list = new List<SelectListItem>();
                    SelectListItem item;
                    foreach (String role in Roles.GetAllRoles())
                    {
                        item = new SelectListItem { Text = role, Value = role };
                        list.Add(item);
                    }

                    ViewBag.roleList = (IEnumerable<SelectListItem>)list;

                    ModelState.AddModelError("", ErrorCodeToString(createStatus));
                }
            } 
```

该代码仅显示一个链接，具体取决于登录用户的角色。

# google-analytics - 谷歌分析没有正确跟踪目录

> ID：10323783
> 
> 赞同：0
> 
> 时间：2012-04-25T21:05:13.490
> 
> 标签：google-analytics, google-analytics-api, web-analytics

我在为具有多个目录的域设置 Google Analytics 时遇到问题。这是我所拥有的：

```
www.mydomain.com
www.mydomain.com/site-one/
www.mydomain.com/site-two/
www.mydomain.com/site-three/
www.mydomain.com/site-four/
www.mydomain.com/site-five/ 
```

这些目录中的每一个实际上都是独立的网站，但它们都属于 mydomain.com。我的问题是我已经将它们设置为 mydomain.com 是主帐户，站点一、站点二、站点三等每个都是该帐户下的属性。

对于每个属性，我都有相关的 url。例如：

对于 mydomain.com/site-one/ 默认 URL，我已将其设置为[http://www.mydomain.com/site-one/](http://www.mydomain.com/site-one/)

我注意到的是，自从这样做以来，我似乎只在 mydomain.com 上跟踪访问，但没有任何子域属性。

我敢肯定，我可能做的不对……所以如果有人可以提供帮助，我将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T22:17:15.337

不完全确定您到底想要实现什么，您希望它们都在一份报告中还是在不同的报告中？无论如何，我认为这就是你想要的。

编辑每个站点的配置文件编号。

```
www.mydomain.com UA-12345678-1
www.mydomain.com/site-one/ UA-12345678-2
www.mydomain.com/site-two/ UA-12345678-3
www.mydomain.com/site-three/ UA-12345678-4
www.mydomain.com/site-four/ UA-12345678-5
www.mydomain.com/site-five/ UA-12345678-6 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T19:48:11.167

您可能需要`_setCookiePath()`在`<head>`.

[https://developers.google.com/analytics/devguides/collection/gajs/gaTrackingSite#singleSubDirectory](https://developers.google.com/analytics/devguides/collection/gajs/gaTrackingSite#singleSubDirectory)

# java - 如何创建一个工具来删除文件中的评论？

> ID：10323785
> 
> 赞同：0
> 
> 时间：2012-04-25T21:05:17.360
> 
> 标签：java

我是 Java 编程新手。我想创建一个扫描整个目录树、搜索评论并删除它们的 Java 程序。我找到了这段代码：

删除评论：

```
import java.io.*;

public class RemoveComments {
    public void readAndPrintFile(String fileName) {
        int ch;
        boolean tokenCheck = false;
        boolean slashCommentFound = false;
        boolean starCommentFound = false;
        boolean firstSlashFound = false;
        boolean firstStarFound = false;
        boolean closingStarFound = false;
        boolean startDoubleQuoteFound = false;
        int lastChar;

        try {

            BufferedReader reader = new BufferedReader(new FileReader(fileName));

            while ((ch = reader.read()) != -1) {

                lastChar = ch;

                if (ch == '\"') {
                    if (startDoubleQuoteFound == false) {
                        startDoubleQuoteFound = true;
                    } else if (startDoubleQuoteFound == true) {
                        startDoubleQuoteFound = false;
                    }
                }

                if (startDoubleQuoteFound
                        && (starCommentFound == true || slashCommentFound == true)) {
                    continue;
                }
                if (ch == '/') {
                    if (starCommentFound == true && closingStarFound == false) {
                        continue;
                    }
                    if (closingStarFound && starCommentFound == true) {
                        starCommentFound = false;
                        closingStarFound = false;
                        firstStarFound = false;
                        continue;
                    } else if (firstSlashFound && slashCommentFound == false
                            && starCommentFound == false) {
                        slashCommentFound = true;
                        firstSlashFound = false;
                        continue;
                    } else if (slashCommentFound == false
                            && starCommentFound == false
                            && startDoubleQuoteFound == false) {
                        firstSlashFound = true;
                        continue;
                    }
                }
                if (ch == '*') {
                    if (starCommentFound) {
                        closingStarFound = true;
                        continue;
                    }
                    if (firstSlashFound && starCommentFound == false) {
                        starCommentFound = true;
                        firstSlashFound = false;
                        continue;
                    } else if (firstStarFound == false
                            && starCommentFound == true) {
                        firstStarFound = true;
                        continue;
                    }
                }
                if (ch == '\n') {
                    if (slashCommentFound) {
                        slashCommentFound = false;
                        firstStarFound = false;
                        firstSlashFound = false;
                        starCommentFound = false;
                        System.out.print((char) ch);
                        continue;
                    }
                }

                if (starCommentFound == true && closingStarFound == false) {
                    continue;
                }

                if (ch != '/' && ch != '*') {
                    if (closingStarFound) {
                        System.out.print((char) lastChar);
                    }

                    closingStarFound = false;
                    firstSlashFound = false;
                    firstStarFound = false;
                    closingStarFound = false;

                }

                if (slashCommentFound == false && starCommentFound == false) {
                    System.out.print((char) ch);
                }
            }

            reader.close();

        } catch (FileNotFoundException ex) {
            System.out.println(fileName + " not found");
        } catch (Exception ex) {
            System.out.println("Error reading file " + fileName);
            ex.printStackTrace();
        }
    }

    public static void main(String[] args) {
        RemoveComments reader = new RemoveComments();
        reader.readAndPrintFile("D://Callback.java");
    }
} 
```

而这个列出目录树的代码：

```
public static void main(String[] args) {
    final Collection<File> all = new ArrayList<File>();
    addFilesRecursively(new File("."), all);
    System.out.println(all);
}

private static void addFilesRecursively(File file, Collection<File> all) {
    final File[] children = file.listFiles();
    if (children != null) {
        for (File child : children) {
            all.add(child);
            addFilesRecursively(child, all);
        }
    }
} 
```

上面的代码适用于 java 源代码文件，但我不确定它是否适用于 XML 文件、CSS 文件、Javascript 和 HTML 文件。我还需要帮助以正确的方式编写代码。

最好的祝愿

# java - 如何防止 JAXB 创建中间对象

> ID：10323787
> 
> 赞同：1
> 
> 时间：2012-04-25T21:05:32.267
> 
> 标签：java, xml, jaxb

我想要以下 XML

```
<doc>
   <items>
      <item />
      <item />
      <item />
   </items>
   <things>
      <thing />
      <thing />
      <thing />
   </things>
</doc> 
```

架构将类似于

```
<schema>
   <element name="doc">
      <complexType>
          <all>
              <element name="items" minOccurs="1">
                  <complexType>
                       <sequence>
                           <element name="item" minoccurs="0" maxoccurs="unbounded" />
                       </sequence>
                  </complexType>
              </element>
              <element name="things" minOccurs="1">
                  <complexType>
                       <sequence>
                           <element name="thing" minoccurs="0" maxoccurs="unbounded" />
                       </sequence>
                  </complexType>
              </element>
          </all>
      /<complexType>
   </element>
</schema> 
```

现在使用 JAXB，它创建了一个名为 Doc 的类，该类将具有一个 Items 类型，该类型具有一个 Item。因此，要添加第一个元素，我必须这样做。

```
Doc doc = new Doc();
Items items = new Items();
items.getItem().add(new Item());
doc.setItems(items); 
```

我希望能够执行以下操作：

```
Doc doc = new Doc();
doc.getItems().add(new Item()); 
```

甚至更好：

```
Doc doc = new Doc();
doc.addItem(new Item()); 
```

无论如何通过 JAXB 绑定来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T21:16:50.310

[根据nsfyn55](https://stackoverflow.com/questions/10323787/how-do-you-prevent-jaxb-from-creating-an-intermediate-object/10323938#comment13295534_10323873)的评论，似乎没有任何方法可以使用绑定来做到这一点。

但是，如果您使用 JAXB 注释，您可以这样做：

```
@XmlRootElement
@XmlAccessorType(XmlAccessType.FIELD)
public class Doc {
    @XmlElementWrapper(name = "items")
    @XmlElement(name="item")
    List<Item> items = new ArrayList<Item>();

    public void addItem(Item item) {
        this.items.add(item);
    }

    // ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T21:12:16.503

您需要包装标签。它将元素定义为分组序列，而不仅仅是一堆任意元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T00:01:31.673

> 我希望能够执行以下操作：
> 
> 文档文档 = 新文档（）；
> 
> doc.getItems().add(new Item());

我相信您可以（至少到 JAXB 2.1）生成的 getItems() 代码将检查空成员集合，并在必要时在返回之前创建它。所以它总是返回一个“活动”列表对象。

# android - 如何在 achartengine 上绘制、书写或简单地使用 Canvas？

> ID：10323788
> 
> 赞同：1
> 
> 时间：2012-04-25T21:05:32.163
> 
> 标签：android, canvas, achartengine

我正在使用 achartengine，我需要一些方法在图表上绘制文本和注释。此外，当我水平滑动图表时，注释也会移动。有没有办法做到这一点，还是我必须实现自己的绘图方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T02:33:59.790

我编辑了 achartengine 源代码以添加注释功能。你可以[在这里](https://groups.google.com/forum/?fromgroups=#!topic/achartengine/mNAv9owZ7JY "这里")看到它。

# asp.net-mvc - ASP MVC 3 移动策略

> ID：10323790
> 
> 赞同：1
> 
> 时间：2012-04-25T21:05:42.330
> 
> 标签：asp.net-mvc

我正在启动一个 group uni 项目，我们正在使用 ASP MVC 3。我们将拥有一个移动（Web）组件以及一个“传统”Web 应用程序。一些视图将重叠（如事件移动视图和事件普通视图）。ASP MVC 4 具有我们想要的移动功能，但我们不想冒险使用 Beta 版本。

我们想做的是在我们的解决方案中包含两个 MVC 3 项目，一个用于移动设备，一个用于 Web 应用程序。或者，我们正在考虑拥有一些仅限移动设备的控制器，并将所有东西都放在一个 MVC 项目中。例如（/AccountMobileController/Signup 和 /AccountController/Signup）？

大家有什么推荐的？使用 ASP MVC 4 Beta 傻吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T03:15:07.107

您可以在 MVC 3 中相当轻松地获得移动视图支持。看看他们是如何在 Stackoverflow 上解决这个问题的。

[http://kevinmontrose.com/2011/07/17/mobile-views-in-asp-net-mvc3/](http://kevinmontrose.com/2011/07/17/mobile-views-in-asp-net-mvc3/)

在大多数情况下，您的控制器对于移动站点和完整站点应该是相同的，但视图会有所不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T03:22:23.837

我会说去 MVC4 Beta。

虽然，是的，它处于 Beta 版，但它几乎已准备好投入生产。

System.Web.Mvc 确实没有太大变化，实际上，来自 MVC4 的“移动模板”大多只是与模板预先捆绑的 Html、Css 和 Js 模板。

MVC4 中主要的新移动功能是为不同设备交换视图。

此外，Web API 非常适合创建 API。

[http://www.asp.net/mvc/tutorials/mvc-4/aspnet-mvc-4-mobile-features](http://www.asp.net/mvc/tutorials/mvc-4/aspnet-mvc-4-mobile-features)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T21:24:59.340

我建议您查看 Bootstrap 和 Less 之类的框架，它们将帮助您轻松构建响应式网站。请注意不要从 mvc 代码中注入任何 css 或样式，因为它可能会干扰它们。

# css - 使用百分比作为字体大小？

> ID：10323792
> 
> 赞同：55
> 
> 时间：2012-04-25T21:05:45.597
> 
> 标签：css, font-size

我最近读了很多关于调整字体大小的文章，其中大部分都嘲笑使用 px 作为不可原谅的罪行（好吧，也许没那么糟糕，你明白了），因为它在旧浏览器中无法正确调整大小。

我真的很想有一个我自己使用的标准，过去一直是 px，只是因为它简单、易于理解并且相当容易实现设计中指定的确切字体大小 - 但我现在怀疑使用像素。

我最近在一个项目中使用了 em，因为它需要我使用 jQuery 制作的文本大小调整功能。但是我发现它非常令人沮丧，因为如果您在彼此内部有两个元素都指定了 em 大小，那么 em 放大的方式（希望这是有道理的）

所以我想知道使用 % 来调整字体大小，我已经看到几个大网站使用这种技术（即雅虎），据我了解，它似乎具有 em 的所有优点，而没有令人难以置信的烦人放大的东西。

**简而言之，我只是想知道在 CSS 中使用 % 进行字体大小调整是否有任何问题？在字体大小调整方面会比使用 PX 更好吗？有什么明显的缺点吗？**

如果问题之前的简介有点多，我深表歉意：/我仍然有点习惯整个 QA 的事情

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2014-07-06T17:29:09.387

在 CSS3 中，使用`rem`(root `em`)。大小不会受到父元素的 em 大小的影响。

根字体大小是通过设置`:root`伪元素上的字体大小来设置的，如下所示：

```
:root {
    font-size: 16px;
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-04-26T16:06:36.330

尝试使用这个

```
body {
  margin: 0px;
  padding: 0px;
  font-size: 62.5%;
}

body>#wrapper {
  font-size:1em;
} 
```

因此，当您在“包装器”中说 1em 之类的内容时，您的大小将非常类似于 10px。这是一个示例表：

```
3em == 30px
.5em == 5px
8.5em == 85px 
```

这将帮助您完成过渡

Pd：当然，在正文之后需要一个包装标签

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-26T21:43:45.333

据我所知，网页设计的标准是使用百分比来设置正文中的字体大小，然后使用 ems 来更改字体大小。您可以在 body 标签之外使用百分比，而不会产生不利的副作用，但我认为许多开发人员发现 ems 更容易使用（任何人都可以自由地检查我）。

如果使用 em 设置正文字体大小，危险就来了；较旧的浏览器会阻塞并错误地显示文本，尤其是在缩放时。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-26T15:10:24.573

[有一个名为FitText](http://fittextjs.com/)的 jQuery 插件。它根据百分比调整文本大小。如果访问者由于某种原因禁用了 JavaScript，它只会正常显示，因此请设置合理的 PX 或 EM 备份。

它依赖于 jQuery，因此您需要将它包含在您的页面中（如果您还没有它）。

* * *

[jquery.fittext.js](https://github.com/davatron5000/FitText.js/blob/master/jquery.fittext.js)供参考：

```
/*global jQuery */
/*! 
* FitText.js 1.0
*
* Copyright 2011, Dave Rupert http://daverupert.com
* Released under the WTFPL license 
* http://sam.zoy.org/wtfpl/
*
* Date: Thu May 05 14:23:00 2011 -0600
*/

(function( $ ){

    $.fn.fitText = function( kompressor, options ) {

        var settings = {
        'minFontSize' : Number.NEGATIVE_INFINITY,
        'maxFontSize' : Number.POSITIVE_INFINITY
      };

            return this.each(function(){
                var $this = $(this);              // store the object
                var compressor = kompressor || 1; // set the compressor

        if ( options ) { 
          $.extend( settings, options );
        }

        // Resizer() resizes items based on the object width divided by the compressor * 10
                var resizer = function () {
                    $this.css('font-size', Math.max(Math.min($this.width() / (compressor*10), parseFloat(settings.maxFontSize)), parseFloat(settings.minFontSize)));
                };

                // Call once to set.
                resizer();

                // Call on resize. Opera debounces their resize by default. 
        $(window).resize(resizer);

            });

    };

})( jQuery ); 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-04-25T22:33:22.027

也许这对制作字体调整脚本更有意义。我制作了一个完全符合您要求的脚本，但我再也找不到它了。

**伪代码：**

```
var fontSize = 15; // (em) input
var fontResize = -1;// (em)input
fontSize = fontSize+fontResize; //current div

for(every inherent parent classname == 'classname-em')
document.classnameParentSize[numberofclass] = classnameChildSize[numberOfClass]/100*90; 
```

所以用文字来解释。脚本需要调整一些字体的大小，完成后它还会寻找一些父 div 来调整这些字体的大小，除了它们的大小将比其固有的小 10%。有了一些令人费解的问题，您将获得正确的转换。还要尽量避免填充和边框宽度。

# c# - 模拟一个抛出异常（moq）的方法，但在其他方面表现得像被模拟的对象？

> ID：10323794
> 
> 赞同：79
> 
> 时间：2012-04-25T21:05:48.733
> 
> 标签：c#, unit-testing, mocking, moq

我有一个`Transfer`类，简化它看起来像这样：

```
public class Transfer
{
    public virtual IFileConnection source { get; set; }
    public virtual IFileConnection destination { get; set; }

    public virtual void GetFile(IFileConnection connection, 
        string remoteFilename, string localFilename)
    {
        connection.Get(remoteFilename, localFilename);
    }

    public virtual void PutFile(IFileConnection connection, 
        string localFilename, string remoteFilename)
    {
        connection.Get(remoteFilename, localFilename);
    }

    public virtual void TransferFiles(string sourceName, string destName)
    {
        source = internalConfig.GetFileConnection("source");
        destination = internalConfig.GetFileConnection("destination");
        var tempName = Path.GetTempFileName();
        GetFile(source, sourceName, tempName);
        PutFile(destination, tempName, destName);
    }
} 
```

界面的简化版本`IFileConnection`如下所示：

```
public interface IFileConnection
{
    void Get(string remoteFileName, string localFileName);
    void Put(string localFileName, string remoteFileName);
} 
```

真正的类应该处理`System.IO.IOException`当`IFileConnection`具体类失去与远程的连接时抛出的一个，发送电子邮件等等。

我想使用 Moq 创建一个`Transfer`类，并将其用作我`Transfer`在所有属性和方法中的具体类，除非`GetFile`调用该方法 - 然后我希望它抛出 a`System.IO.IOException`并确保`Transfer`该类正确处理它。

我是否使用了正确的工具来完成这项工作？我会以正确的方式解决这个问题吗？我将如何为该单元测试编写设置`NUnit`？

* * *

## 回答 #1

> 赞同：103
> 
> 时间：2012-04-25T21:16:05.950

这是您可以模拟的方法`FileConnection`

```
Mock<IFileConnection> fileConnection = new Mock<IFileConnection>(
                                                           MockBehavior.Strict);
fileConnection.Setup(item => item.Get(It.IsAny<string>,It.IsAny<string>))
              .Throws(new IOException()); 
```

然后实例化您的 Transfer 类并在您的方法调用中使用模拟

```
Transfer transfer = new Transfer();
transfer.GetFile(fileConnection.Object, someRemoteFilename, someLocalFileName); 
```

**更新：**

首先，您必须仅模拟您的依赖项，而不是您正在测试的类（在这种情况下为传输类）。在构造函数中声明这些依赖关系可以很容易地查看您的类需要哪些服务才能工作。当您编写单元测试时，它还可以用假货替换它们。目前不可能用假货替换这些属性。

由于您使用另一个依赖项设置这些属性，我会这样写：

```
public class Transfer
{
    public Transfer(IInternalConfig internalConfig)
    {
        source = internalConfig.GetFileConnection("source");
        destination = internalConfig.GetFileConnection("destination");
    }

    //you should consider making these private or protected fields
    public virtual IFileConnection source { get; set; }
    public virtual IFileConnection destination { get; set; }

    public virtual void GetFile(IFileConnection connection, 
        string remoteFilename, string localFilename)
    {
        connection.Get(remoteFilename, localFilename);
    }

    public virtual void PutFile(IFileConnection connection, 
        string localFilename, string remoteFilename)
    {
        connection.Get(remoteFilename, localFilename);
    }

    public virtual void TransferFiles(string sourceName, string destName)
    {
        var tempName = Path.GetTempFileName();
        GetFile(source, sourceName, tempName);
        PutFile(destination, tempName, destName);
    }
} 
```

这样你就可以模拟 internalConfig 并让它返回你想要的 IFileConnection 模拟。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-04-25T23:51:49.590

我认为这就是你想要的，我已经测试过这段代码并且可以工作

使用的工具有：（所有这些工具都可以作为 Nuget 包下载）

[http://fluentassertions.codeplex.com/](http://fluentassertions.codeplex.com/)

[http://autofixture.codeplex.com/](http://autofixture.codeplex.com/)

[http://code.google.com/p/moq/](http://code.google.com/p/moq/)

[https://nuget.org/packages/AutoFixture.AutoMoq](https://nuget.org/packages/AutoFixture.AutoMoq)

```
var fixture = new Fixture().Customize(new AutoMoqCustomization());
var myInterface = fixture.Freeze<Mock<IFileConnection>>();

var sut = fixture.CreateAnonymous<Transfer>();

myInterface.Setup(x => x.Get(It.IsAny<string>(), It.IsAny<string>()))
        .Throws<System.IO.IOException>();

sut.Invoking(x => 
        x.TransferFiles(
            myInterface.Object, 
            It.IsAny<string>(), 
            It.IsAny<string>()
        ))
        .ShouldThrow<System.IO.IOException>(); 
```

**编辑：**

让我解释：

当你写一个测试时，你必须确切地知道你想测试什么，这被称为：“被测对象（SUT）”，如果我的理解是正确的，在这种情况下你的 SUT 是：`Transfer`

所以考虑到这一点，你不应该模拟你的 SUT，如果你替换你的 SUT，那么你就不会真正测试真正的代码

当您的 SUT 具有外部依赖项（非常常见）时，您需要替换它们以便单独测试**您**的 SUT。当我说替代品时，我指的是根据您的需要使用模拟、虚拟、模拟等

在这种情况下，您的外部依赖项是`IFileConnection`您需要为此依赖项创建模拟并将其配置为抛出异常，然后只需调用您的 SUT 真实方法并断言您的方法按预期处理异常

*   `var fixture = new Fixture().Customize(new AutoMoqCustomization());`：这个 linie 初始化一个新的 Fixture 对象（Autofixture 库），这个对象用于创建 SUT，而不必显式地担心构造函数参数，因为它们是自动创建或模拟的，在这种情况下使用 Moq

*   `var myInterface = fixture.Freeze<Mock<IFileConnection>>();`: 这冻结了`IFileConnection`依赖。冻结意味着 Autofixture 在被询问时将始终使用此依赖项，为简单起见，就像单例一样。但有趣的是我们正在创建这个依赖的 Mock，你可以使用所有的 Moq 方法，因为这是一个简单的 Moq 对象

*   `var sut = fixture.CreateAnonymous<Transfer>();`：这里 AutoFixture 正在为我们创建 SUT

*   `myInterface.Setup(x => x.Get(It.IsAny<string>(), It.IsAny<string>())).Throws<System.IO.IOException>();`在这里，您将依赖项配置为在调用方法时抛出异常`Get`，此接口中的其余方法未配置，因此如果您尝试访问它们，您将收到意外异常

*   `sut.Invoking(x => x.TransferFiles(myInterface.Object, It.IsAny<string>(), It.IsAny<string>())).ShouldThrow<System.IO.IOException>();`：最后，是时候测试你的 SUT，这一行使用 FluenAssertions 库，它只是`TransferFiles` **从 SUT 调用真实方法，**并作为参数接收模拟的参数，`IFileConnection`所以每当你在 SUT方法`IFileConnection.Get`的正常流程中调用`TransferFiles`模拟对象将调用抛出配置的异常，这是断言您的 SUT 正确处理异常的时候了，在这种情况下，我只是确保使用`ShouldThrow<System.IO.IOException>()`（来自 FluentAssertions 库）抛出异常

推荐参考：

[http://martinfowler.com/articles/mocksArentStubs.html](http://martinfowler.com/articles/mocksArentStubs.html)

[http://misko.hevery.com/code-reviewers-guide/](http://misko.hevery.com/code-reviewers-guide/)

[http://misko.hevery.com/presentations/](http://misko.hevery.com/presentations/)

[http://www.youtube.com/watch?v=wEhu57pih5w&feature=player_embedded](http://www.youtube.com/watch?v=wEhu57pih5w&feature=player_embedded)

[http://www.youtube.com/watch?v=RlfLCWKxHJ0&feature=player_embedded](http://www.youtube.com/watch?v=RlfLCWKxHJ0&feature=player_embedded)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-04-26T17:38:38.480

这就是我设法做我想做的事情的方式：

```
[Test]
public void TransferHandlesDisconnect()
{
    // ... set up config here
    var methodTester = new Mock<Transfer>(configInfo);
    methodTester.CallBase = true;
    methodTester
        .Setup(m => 
            m.GetFile(
                It.IsAny<IFileConnection>(), 
                It.IsAny<string>(), 
                It.IsAny<string>()
            ))
        .Throws<System.IO.IOException>();

    methodTester.Object.TransferFiles("foo1", "foo2");
    Assert.IsTrue(methodTester.Object.Status == TransferStatus.TransferInterrupted);
} 
```

如果这种方法有问题，我想知道；其他答案表明我做错了，但这正是我想要做的。

# hsqldb - 以编程方式启动 hsqldb 数据库

> ID：10323798
> 
> 赞同：3
> 
> 时间：2012-04-25T21:05:57.670
> 
> 标签：hsqldb

我想以编程方式启动 HSQLdb 服务器。我创建了一个如下所示的可运行文件，然后在线程中启动它。

```
 Runnable hsqlRunnable = new Runnable() {
                public void run()
                {

                    HsqlProperties props = new HsqlProperties();
                    props.setProperty("server.database.0", "file:C:\Documents and Settings\BThirup\Application Data\Rockwell Automation\FactoryTalk ProductionCentre\logs\ApplicationLog\mydb;shutdown=true;");
                    props.setProperty("server.dbname.0", "xdb");
org.hsqldb.Server server = new org.hsqldb.Server();

                    try {
                        server.setProperties(props);
                    } catch (Exception e) {
                        return;
                    }

                    server.start();
}
} 
```

我收到错误消息：[Thread[HSQLDB Server @4db602,6,main]]: Shutdown because there are no open databases

谁能帮忙指出我哪里出错了。

谢谢你帮助巴拉

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-09-03T10:05:17.910

您可以使用单独的类来管理您的 HSQLdb 服务器实例：

```
public class DBManager {

    final String dbLocation = "c:\\temp\\"; // change it to your db location
    org.hsqldb.server.Server sonicServer;
    Connection dbConn = null;

    public void startDBServer() {
        HsqlProperties props = new HsqlProperties();
        props.setProperty("server.database.0", "file:" + dbLocation + "mydb;");
        props.setProperty("server.dbname.0", "xdb");
        sonicServer = new org.hsqldb.Server();
        try {
            sonicServer.setProperties(props);
        } catch (Exception e) {
            return;
        }
        sonicServer.start();
    }

    public void stopDBServer() {
        sonicServer.shutdown();
    }

    public Connection getDBConn() {
        try {
            Class.forName("org.hsqldb.jdbcDriver");
            dbConn = DriverManager.getConnection(
                    "jdbc:hsqldb:hsql://localhost/xdb", "SA", "");
        } catch (Exception e) {
            e.printStackTrace();
        }
        return dbConn;
    }
} 
```

并使用这个类：

```
public class WFProcess extends Thread {

    DBManager dbm = new DBManager();

    public static void main(String[] args) {
        (new WFProcess()).start();
    }

    public void run() {
        dbm.startDBServer();

        // some usefull server work here
        Connection conn = dbm.getDBConn();
        try {
            Statement stmt = conn.createStatement();
            stmt.executeQuery("CREATE TABLE IF NOT EXISTS answers (num INT IDENTITY, answer VARCHAR(250))");
            stmt.executeQuery("INSERT INTO answers (answer) values ('this is a new answer')");
            ResultSet rs = stmt.executeQuery("SELECT num, answer FROM answers");
            while (rs.next()) {
                System.out.println("Answer number: " + rs.getString("num")
                        + "; answer text: " + rs.getString("answer"));
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
        // end of usefull server work

        dbm.stopDBServer();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T22:21:10.223

正如您所评论的， server.setTrace(true) 有助于进行故障排除。server.setSilent(false) 也是如此。

但是您不应该创建并启动 Runnable 来启动服务器。Server 类完成所有这些并启动必要的线程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-13T08:17:29.313

对于 HSQL 2.3.x，请参阅下文以将 HSQL 作为 WebServer 运行（使用端口 80 进行网络的 HSQL 服务器。）

[https://stackoverflow.com/a/37784679/15789](https://stackoverflow.com/a/37784679/15789)

# c#-4.0 - WSE 3.0 创建 UsernameToken 但 Username 和 Password 值为空

> ID：10323800
> 
> 赞同：0
> 
> 时间：2012-04-25T21:06:02.553
> 
> 标签：c#-4.0, authentication, ws-security, wse, soapheader

```
<?xml version="1.0" encoding="utf-8"?>
    <soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" 
        xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/" 
        xmlns:tns="http://tempuri.org/" 
        xmlns:types="http://tempuri.org/encodedTypes" 
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
        xmlns:xsd="http://www.w3.org/2001/XMLSchema">
            <soap:Header>
                <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" soap:mustUnderstand="1">
                    <wsse:UsernameToken xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" wsu:Id="unt_PQxtsT0a8iV1KN2Y">
                        <wsse:Username></wsse:Username>
                        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText"></wsse:Password>
                        <wsse:Nonce EncodingType="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary">i03CXze0uiIYG8+q8MhEMYHiMcL/NOpCwvEVpQ5xo+M=</wsse:Nonce>
                        <wsu:Created>2012-04-25T22:59:23Z</wsu:Created>
                    </wsse:UsernameToken>
                    <wsu:Timestamp xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
                        <wsu:Created>2012-04-25T22:59:23Z</wsu:Created>
                        <wsu:Expires>2012-04-25T22:60:23Z</wsu:Expires>
                    </wsu:Timestamp>
                </wsse:Security>
            </soap:Header> 
```

客户端代码：

```
MessageServiceWse client = new MessageServiceWse();

UsernameToken usernameToken = new UsernameToken(token.Username, token.Password, PasswordOption.SendPlainText);

client.RequestSoapContext.Security.Tokens.Add(usernameToken);
client.RequestSoapContext.Security.Timestamp.TtlInSeconds = 60; 
```

client.SomeMethod(request);

这是我在 VS 2010 中安装和使用 WSE 3.0 的噪音太大后设法创建的漂亮的肥皂安全标头。但是，我调用这个 Web 服务（我无法控制）的地狱仍在继续，虽然一切看起来都很好，但我无法通过最后一个问题。

如果您注意到请求标头，您可以看到一切看起来都不错，除了我传递的用户名和密码不存在！！！

有人遇到过类似的情况吗？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T22:35:39.763

不确定您是否仍然遇到此问题，但是您可以尝试这样的事情吗？我不知道您为什么要尝试从令牌对象中获取用户名/密码。这是客户需要提供给服务的东西。

```
UsernameToken token = new UsernameToken("myusername", "mypwd", PasswordOption.SendPlainText );

client.SetClientCredential(token);
client.SetPolicy("ClientPolicy"); 
```

# ios - iOS5进阶编程书籍/教程

> ID：10323804
> 
> 赞同：0
> 
> 时间：2012-04-25T21:06:08.643
> 
> 标签：ios, objective-c, ios5

作为 iOS 新手，有大量书籍可以满足学习基础知识的需求。现在，我想继续阅读一些高级读物，例如 OAuth 和 SQLite 以及动态 API 派生的表视图等。您会推荐哪些资源？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T21:12:55.310

这里有一对：

更多 iOS 5 开发书还不错： [http ://www.amazon.com/More-iOS-Development-Further-Explorations/dp/1430238070/ref=sr_1_15?ie=UTF8&qid=1335388180&sr=8-15](https://rads.stackoverflow.com/amzn/click/com/1430238070)

还没有完成所有这些，但它是相当不错的 Pro iOS 表格视图：适用于 iPhone、iPad 和 iPod touch： [http ://www.amazon.com/Pro-iOS-Table-Views-iPhone/dp/1430233486 /ref=sr_1_24?ie=UTF8&qid=1335388229&sr=8-24](https://rads.stackoverflow.com/amzn/click/com/1430233486)

我知道 Apress 对其他 iOS 主题也有更深入的了解，也许可以查看他们的网站……但您可能需要依赖博客、苹果文档和其他在线资源来进行更高级的开发

# javascript - 我应该使用什么数据库进行跨域 json 调用和身份验证？

> ID：10323807
> 
> 赞同：0
> 
> 时间：2012-04-25T21:06:15.980
> 
> 标签：javascript, database, encryption, cross-domain, userscripts

我正在创建一个用户脚本，它根据编写文本的用户解密加密文本。我需要使用数据库来存储和调用浏览器内的解密密钥。

因此，例如，我希望 twitter 用户 A 接收来自 twitter 用户 B 的加密帖子。然后用户脚本打开一个窗口来验证 twitter 用户 A 以使用带有解密密钥的数据库。然后识别它收到的帖子来自 twitter用户 B 并要求数据库发送推特用户 B 所需的解密密钥。

所以数据库必须：

```
1.Use authentication to access the user's keys
2.Have a javascript API
3.Send the decryption keys in jsonp format so it can be cross domain
4.Have a share function so user A can share with user B the decryption keys upon request 
```

是否有任何开源数据库可以做到这一切？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T23:07:29.197

我正在将跨域身份验证作为一个大型项目的一部分，让用户能够在相关的本地化网站上保持登录状态。正如 Quassnoi 所说，您的大部分任务与数据库无关。

我自己的偏好是使用 .NET 和 Javascript。这些站点实际上具有 XML 格式的数据存储，用于本地化所有内容。这是外部不可用的，因此 SQL 被用于中央用户数据库，以便它易于连接：从任何地方存储/检索。这个 g 搜索提供了很多很好的例子： [https ://www.google.dk/search?q=asp.net+cross+domain+authentication](https://www.google.dk/search?q=asp.net%20cross%20domain%20authentication)

使用 .NET 可以轻松创建满足您需要的 Web 服务，该服务可以处理收集的数据的加密和解密并将其传递。

至于开源数据库，实际上支持 MS SQL 的托管托管帐户每月只需 4 美元。否则，我会选择 MySql 并使用数据连接器与应用程序通信并节省 4 美元的成本。

# android - Android 图库自动加载

> ID：10323808
> 
> 赞同：0
> 
> 时间：2012-04-25T21:06:16.527
> 
> 标签：android, gallery, autoload

想知道是否有人可以帮助更改此代码，使其自动加载而不必点击搜索按钮？我只想调用该活动并让它加载 Flickr 照片……现在我必须点击“搜索”按钮才能加载……非常感谢！

```
package com.windmillagency;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.Reader;
import java.net.HttpURLConnection;
import java.net.MalformedURLException;
import java.net.URL;

import org.apache.http.HttpEntity;
import org.apache.http.client.ClientProtocolException;
import org.apache.http.client.HttpClient;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.impl.client.DefaultHttpClient;
import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;

import android.app.Activity;
import android.app.ProgressDialog;
import android.content.Context;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.os.Bundle;
import android.os.Handler;
import android.os.Message;
import android.view.View;
import android.view.ViewGroup;
import android.view.ViewGroup.LayoutParams;
import android.widget.BaseAdapter;
import android.widget.Button;
import android.widget.EditText;
import android.widget.Gallery;
import android.widget.ImageView;
import android.widget.Toast;

public class AndroidFlickrActivity extends Activity {

    public String thisActivityName = "Flickr";

    ProgressDialog progressDialog;
    BackgroundThread backgroundThread;

    public class FlickrImage {
        String Id;
        String Owner;
        String Secret;
        String Server;
        String Farm;
        String Title;

        Bitmap FlickrBitmap;

        FlickrImage(String _Id, String _Owner, String _Secret, 
                String _Server, String _Farm, String _Title){
            Id = _Id;
            Owner = _Owner;
            Secret = _Secret;
            Server = _Server;
            Farm = _Farm;
            Title = _Title;

            FlickrBitmap = preloadBitmap();
        }

        private Bitmap preloadBitmap(){
            Bitmap bm= null;

            String FlickrPhotoPath = 
                    "http://farm" + Farm + ".static.flickr.com/" 
                    + Server + "/" + Id + "_" + Secret + "_m.jpg";

            URL FlickrPhotoUrl = null;

            try {
                FlickrPhotoUrl = new URL(FlickrPhotoPath);

                HttpURLConnection httpConnection 
                    = (HttpURLConnection) FlickrPhotoUrl.openConnection();
                httpConnection.setDoInput(true);
                httpConnection.connect();
                InputStream inputStream = httpConnection.getInputStream();
                bm = BitmapFactory.decodeStream(inputStream);

            } catch (MalformedURLException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

            return bm;
        }

        public Bitmap getBitmap(){
            return FlickrBitmap;
        }

    }

    class FlickrAdapter extends BaseAdapter{
        private Context context;
        private FlickrImage[] FlickrAdapterImage;;

        FlickrAdapter(Context c, FlickrImage[] fImage){
            context = c;
            FlickrAdapterImage = fImage;
        }

        public int getCount() {
            // TODO Auto-generated method stub
            return FlickrAdapterImage.length;
        }

        public Object getItem(int position) {
            // TODO Auto-generated method stub
            return FlickrAdapterImage[position];
        }

        public long getItemId(int position) {
            // TODO Auto-generated method stub
            return position;
        }

        public View getView(int position, View convertView, ViewGroup parent) {
            // TODO Auto-generated method stub
            ImageView image;  
            if (convertView == null) {
                image = new ImageView(context);  
                image.setLayoutParams(new Gallery.LayoutParams(LayoutParams.MATCH_PARENT, LayoutParams.MATCH_PARENT));  
                image.setScaleType(ImageView.ScaleType.FIT_CENTER);  
                image.setPadding(8, 8, 8, 8);   
            } else {  
                image = (ImageView) convertView;    
            }  

            image.setImageBitmap(FlickrAdapterImage[position].getBitmap());

            return image; 
        }

    }

    FlickrImage[] myFlickrImage;

    /*
     * FlickrQuery = FlickrQuery_url 
     * + FlickrQuery_per_page 
     * + FlickrQuery_nojsoncallback 
     * + FlickrQuery_format
     * + FlickrQuery_tag + q
     * + FlickrQuery_key + FlickrApiKey
     */

    String FlickrQuery_url = "http://api.flickr.com/services/rest/?method=flickr.people.getPublicPhotos&api_key=fdd73dc07613841fbe325b5103d673b7&user_id=65005067@N08&per_page=25&format=json";
    String FlickrQuery_per_page = "&per_page=10";
    String FlickrQuery_nojsoncallback = "&nojsoncallback=1";
    String FlickrQuery_format = "&format=json";
    String FlickrQuery_tag = "&tags=";
    String FlickrQuery_key = "&api_key=";

    //  Apply your Flickr API:
    //  www.flickr.com/services/apps/create/apply/?
    String FlickrApiKey = "fdd73dc07613841fbe325b5103d673b7";

    //final String DEFAULT_SEARCH = "Bill_Gate";
    final String DEFAULT_SEARCH = "new_york";

    EditText searchText;
    Button searchButton;

    Gallery photoBar;

    Bitmap bmFlickr;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        searchText = (EditText)findViewById(R.id.searchtext);
        searchText.setText(DEFAULT_SEARCH);
        searchButton = (Button)findViewById(R.id.searchbutton);

        photoBar = (Gallery)findViewById(R.id.photobar);

        searchButton.setOnClickListener(searchButtonOnClickListener);
    }

    private Button.OnClickListener searchButtonOnClickListener
    = new Button.OnClickListener(){

        public void onClick(View arg0) {
            // TODO Auto-generated method stub
            progressDialog = ProgressDialog.show(AndroidFlickrActivity.this, 
                    "ProgressDialog", "Wait!");

            backgroundThread = new BackgroundThread();
            backgroundThread.setRunning(true);
            backgroundThread.start();

        }};

    private String QueryFlickr(String q){

        String qResult = null;

        String qString = 
                FlickrQuery_url 
                + FlickrQuery_per_page 
                + FlickrQuery_nojsoncallback 
                + FlickrQuery_format 
                + FlickrQuery_tag + q  
                + FlickrQuery_key + FlickrApiKey;

        HttpClient httpClient = new DefaultHttpClient();
        HttpGet httpGet = new HttpGet(qString);

        try {
            HttpEntity httpEntity = httpClient.execute(httpGet).getEntity();

            if (httpEntity != null){
                InputStream inputStream = httpEntity.getContent();
                Reader in = new InputStreamReader(inputStream);
                BufferedReader bufferedreader = new BufferedReader(in);
                StringBuilder stringBuilder = new StringBuilder();

                String stringReadLine = null;

                while ((stringReadLine = bufferedreader.readLine()) != null) {
                    stringBuilder.append(stringReadLine + "\n");
                    }

                qResult = stringBuilder.toString();
                inputStream.close();
            }

        } catch (ClientProtocolException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

        return qResult;
    }

    private FlickrImage[] ParseJSON(String json){

        FlickrImage[] flickrImage = null;

        bmFlickr = null;
        String flickrId;
        String flickrOwner;
        String flickrSecret;
        String flickrServer;
        String flickrFarm;
        String flickrTitle;

        try {
            JSONObject JsonObject = new JSONObject(json);
            JSONObject Json_photos = JsonObject.getJSONObject("photos");
            JSONArray JsonArray_photo = Json_photos.getJSONArray("photo");

            flickrImage = new FlickrImage[JsonArray_photo.length()];
            for (int i = 0; i < JsonArray_photo.length(); i++){
                JSONObject FlickrPhoto = JsonArray_photo.getJSONObject(i);
                flickrId = FlickrPhoto.getString("id");
                flickrOwner = FlickrPhoto.getString("owner");
                flickrSecret = FlickrPhoto.getString("secret");
                flickrServer = FlickrPhoto.getString("server");
                flickrFarm = FlickrPhoto.getString("farm");
                flickrTitle = FlickrPhoto.getString("title");
                flickrImage[i] = new FlickrImage(flickrId, flickrOwner, flickrSecret,
                        flickrServer, flickrFarm, flickrTitle);
            }

        } catch (JSONException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

        return flickrImage;
    }

    public class BackgroundThread extends Thread{
        volatile boolean running = false;
        int cnt;

        void setRunning(boolean b){
            running = b;    
            cnt = 10;
        }

        @Override
        public void run() {
            // TODO Auto-generated method stub
            String searchQ = searchText.getText().toString();
            String searchResult = QueryFlickr(searchQ);

            myFlickrImage = ParseJSON(searchResult);

            handler.sendMessage(handler.obtainMessage());
        }
    }

    Handler handler = new Handler(){

        @Override
        public void handleMessage(Message msg) {
            // TODO Auto-generated method stub

            progressDialog.dismiss();
            photoBar.setAdapter(new FlickrAdapter(AndroidFlickrActivity.this, myFlickrImage));
            Toast.makeText(AndroidFlickrActivity.this, 
                    "Flickr images loaded", Toast.LENGTH_LONG).show();
        }

    };

}

XML File

<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    >
<TextView  
    android:layout_width="fill_parent" 
    android:layout_height="wrap_content" 
    android:text="@string/hello"
    />
<EditText
    android:id="@+id/searchtext"
    android:layout_width="fill_parent" 
    android:layout_height="wrap_content" 
    />
<Button
    android:id="@+id/searchbutton"
    android:layout_width="fill_parent" 
    android:layout_height="wrap_content" 
    android:text="Search"
    />
<TextView  
    android:id="@+id/queryresult"
    android:layout_width="fill_parent" 
    android:layout_height="wrap_content" 
    />
<Gallery  
    android:id="@+id/photobar"  
    android:layout_width="fill_parent"  
    android:layout_height="fill_parent"  
    android:spacing="10dp"  
    />  
</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T21:19:11.340

在主线程中，您需要调用 Adapter.notifyDataSetChanged()。使用处理程序发布到主线程。

```
BaseAdapter mBaseAdapter;

// ... some init stuff 

mHandler = new Handler(Looper.getMainLooper()) {
    @Override public void handleMessage(Message msg) {
        mBaseAdapter.notifyDataSetChanged();

        mHandler.sendEmptyDelayedMessage(-1, 100);
    }
}; 
```

# ruby - 带有 svn 绑定的 rvm

> ID：10323812
> 
> 赞同：0
> 
> 时间：2012-04-25T21:06:28.287
> 
> 标签：ruby, svn, rvm

Mac OS X 上的系统 ruby`require 'svn/client'`​​ 内置了 svn 绑定 ( )。但是，我需要使用没有 svn 绑定的 RVM。如何将 svn 绑定到 RVM 的 ruby​​ 中？

# java - 最快的（每秒事务数）Java FIX 引擎是什么？

> ID：10323816
> 
> 赞同：0
> 
> 时间：2012-04-25T21:06:45.197
> 
> 标签：java, trading, fix-protocol

我目前正在使用 QuickFix/J（开源），它运行良好。

现在我正在考虑改用更好的/商业的 FIX 引擎，所以基本上我想知道哪个是最快的！

必须支持 FIX5.0SP2，但不支持 FAST 协议。

具体来说，我们正在讨论在框架中以最小的延迟接收市场更新。

成本不是主要问题（我认为）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T21:00:13.810

2012 年 7 月在同一英特尔实验室和相同条件下进一步优化代码后进行的测量

[高性能解决方案堆栈中的 C++ 测试](http://www.b2bits.com/performance_lab/fix_antenna_cpp/fix-antenna-cplusplus-in-high-performance-stack.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T11:42:19.247

英特尔已经发布了适用于高频的引擎的基准，因此在公共领域有信息。

[http://fixglobal.com/content/high-performance-trading-fix-messaging-testing-low-latency](http://fixglobal.com/content/high-performance-trading-fix-messaging-testing-low-latency)

和额外的纸

[http://ref.onixs.biz/infonotes/OnixS_InfoNote_C%2B%2B_FIX_engine_benchmarks.pdf](http://ref.onixs.biz/infonotes/OnixS_InfoNote_C%2B%2B_FIX_engine_benchmarks.pdf)

我从不相信供应商基准，这些基准几乎没有可信度，因为只使用了一种消息类型。将 C++ 实现与 ..Net 进行比较也没有什么意义，我认为 Rapid Addition 的结果非常糟糕。我们重复了这些测试和其他测试，在 .net 世界中，我更喜欢 Rapid Addition，因为尽管它比其他测试（FixForge）慢一点，但它的抖动极低。在 C++ 和 Java Linux 世界中，Onix 获胜，但如果你想 HFT，我永远不会考虑使用 Java

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-25T06:58:40.733

我可以自信地说，CameronFix 是最佳选择。我交易期货并且心痛，因为我听取了其他供应商的炒作。就个人而言，我会说，如果你能说服你的客户放弃使用 FIX 解决方案，那么就这样做，因为无论如何 FIX 网关都是优先考虑的，而且当出现问题时有太多的错误需要追踪。延迟可以通过关注物理硬件和算法瓶颈来最小化恕我直言。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-26T01:01:23.580

几年前我为 CameronFIX 做了一些工作，它显然受到了高度评​​价，并且它的使命是提供最快的。当然，它支持他发明的 FAST 协议。

目前没有隶属关系。

# r - R：来自 p.adjust (FDR) 的意外结果

> ID：10323817
> 
> 赞同：14
> 
> 时间：2012-04-25T21:06:49.090
> 
> 标签：r

当我尝试使用`p.adjust`对 p 值向量运行 FDR 调整时，出现了这个问题。问题是许多结果 p 值是相同的。我认为这可能是我的数据的一些怪癖，但我已经用任意输入向量重现了同样的问题。例如：

```
temp <- runif(40, min = 0, max = 1) 
temp

# [1] 0.81563482 0.17471363 0.74697979 0.88755248 0.69676260 0.58207008
# [7] 0.87138747 0.76432908 0.64352955 0.06501659 0.70680646 0.81557281
#[13] 0.58480274 0.19476004 0.01035137 0.46119840 0.17783440 0.71828874
#[19] 0.30978182 0.76902202 0.01615609 0.93122152 0.37936458 0.52369562
#[25] 0.90997054 0.30098383 0.70873206 0.71159740 0.38148526 0.78415579
#[31] 0.64605509 0.18898361 0.76770495 0.40651004 0.42255944 0.68395505
#[37] 0.51844368 0.25855720 0.12090991 0.50110836

p.adjust(temp, method="fdr")

# [1] 0.9062609 0.9062609 0.9062609 0.9312215 0.9062609 0.9062609 0.9312215
# [8] 0.9062609 0.9062609 0.8668878 0.9062609 0.9062609 0.9062609 0.9062609
#[15] 0.3231218 0.9062609 0.9062609 0.9062609 0.9062609 0.9062609 0.3231218
#[22] 0.9312215 0.9062609 0.9062609 0.9312215 0.9062609 0.9062609 0.9062609
#[29] 0.9062609 0.9062609 0.9062609 0.9062609 0.9062609 0.9062609 0.9062609
#[36] 0.9062609 0.9062609 0.9062609 0.9062609 0.9062609 
```

我想认为我犯了一些错误。我认为 FDR 将 p 值调整为相同的值是不合理的。大多数数据是相同的，并非全部都与原始 p 值一致。任何想法这里有什么问题？谢谢。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-04-26T04:11:06.223

该方法工作正常。你只是不完全理解算法在做什么。我建议阅读一些有关该过程的信息[（Wikipedia Link）](http://en.wikipedia.org/wiki/False_discovery_rate)。

```
n <- 40
p <- runif(n, 0, 1)
adjusted.p <- p.adjust(p, "fdr") #same as p.adjust(p, "BH")

## Let's recreate.  Going back to the paper we
## can construct a q-value by sorting the p-values
## and then applying the transformation:
## q_i = p_i*n/i
## Where p_i is the ith smallest p-value

## Sort the p-values and keep track of the order
id <- order(p)
tmp <- p[id]
(q <- tmp*n/(1:n))
# [1] 2.0322183 1.0993436 1.2357457 1.1113084 0.9282536 0.7877181 0.7348436
# [8] 0.7204077 0.6587102 0.6289974 0.9205222 0.8827835 0.8600234 0.8680704
#[15] 1.1532693 1.1055951 1.0451330 1.1314681 1.1167659 1.1453142 1.1012847
#[22] 1.0783747 1.0672471 1.0500311 1.0389407 1.0089661 1.0117881 0.9917817
#[29] 0.9892826 0.9668636 0.9844052 0.9792733 1.0000320 0.9967073 0.9707149
#[36] 0.9747723 0.9968153 0.9813367 1.0058445 0.9942353

## However there is one more portion to the adjustment
## We don't want a p-value of .02 getting
## a larger q-value than a p-value of .05
## so we make sure that if a smaller q-value
## shows up in the list we set all of
## the q-values corresponding to smaller p-values
## to that corresponding q-value.

## We can do this by reversing the list
## Keeping a running tally of the minimum value
## and then re-reversing
new.q <- rev(cummin(rev(q)))

## Put it back in the original order
new.q[order(id)]
# [1] 0.6289974 0.9668636 0.6289974 0.6289974 0.6289974 0.9707149 0.9707149
# [8] 0.8600234 0.9668636 0.6289974 0.9707149 0.9668636 0.9668636 0.9813367
#[15] 0.9668636 0.9668636 0.9668636 0.9707149 0.9668636 0.9668636 0.6289974
#[22] 0.9942353 0.8600234 0.6289974 0.9668636 0.6289974 0.6289974 0.8680704
#[29] 0.9668636 0.9668636 0.9668636 0.9942353 0.9707149 0.9813367 0.9668636
#[36] 0.8600234 0.6289974 0.9668636 0.9668636 0.9747723

## This should match the adjustment
adjusted.p
# [1] 0.6289974 0.9668636 0.6289974 0.6289974 0.6289974 0.9707149 0.9707149
# [8] 0.8600234 0.9668636 0.6289974 0.9707149 0.9668636 0.9668636 0.9813367
#[15] 0.9668636 0.9668636 0.9668636 0.9707149 0.9668636 0.9668636 0.6289974
#[22] 0.9942353 0.8600234 0.6289974 0.9668636 0.6289974 0.6289974 0.8680704
#[29] 0.9668636 0.9668636 0.9668636 0.9942353 0.9707149 0.9813367 0.9668636
#[36] 0.8600234 0.6289974 0.9668636 0.9668636 0.9747723 
```

# javascript - jQuery 可排序

> ID：10323820
> 
> 赞同：0
> 
> 时间：2012-04-25T21:06:54.270
> 
> 标签：javascript, jquery, grid, jquery-ui-sortable, fixed

我正在开发一个 javascript 应用程序，它允许用户在网格样式布局中排列一堆元素，我决定使用[jQuery 的可排序](http://jqueryui.com/demos/sortable/#display-grid)库来允许他们移动东西。不同之处在于元素可以是不同大小的，也就是单单元、双单元，最后是可变大小的岛单元。sortable 的说明说使用相同大小的单位，所以在我开始这个项目之前，我做了一个快速演示，看看它是否可以在概念上工作，而且效果很好。例如：

[http://cms.memeflash.ca/sortable/demos/sortable/display-grid.html](http://cms.memeflash.ca/sortable/demos/sortable/display-grid.html)

所以我满怀热情地开始了这个项目，一切都很顺利，直到我遇到了一个我以前没有测试过的盒子样式——参见上面演示中的框 32（我在最初的演示中没有制作这种元素样式）。当您有一个元素的高度大于一个元素但没有整个宽度那么宽时，就会出现问题。您不能将元素放在其左侧超过行的位置，因为可排序使用的机制是浮动的。我知道用于技术的 sortable 使用浮动，但我没有想到这种情况。所以我几乎完成了这个项目，我首先遇到了糟糕假设的砖墙。

我想我在问是否有人对可以容纳不同大小元素的固定布局类型库有任何建议。我正在查看 jquery 的可拖动选项，并且在我发布此内容后可能会开始拼凑一些东西，但我希望那里的某个人能够提供一个不会让我完全重新编程我的应用程序的建议。（原因是我只是将元素作为有序元素的单个列表发布回服务器端，然后服务器转换为用于导出的网格）。

# cordova - 在 PHONEGAP 上使用 XFORM

> ID：10323821
> 
> 赞同：-1
> 
> 时间：2012-04-25T21:06:56.573
> 
> 标签：cordova, phonegap-plugins, xforms

我想在 PhoneGap 上使用 xform（不在 Mozilla 中），但我找不到任何教程，是否有人可以帮助我知道一些教程或这两个方面的任何经验，我知道这个问题是一般性的，但没关系地区或项目。

我如何在 phonegap 上使用 xform。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T05:31:05.170

我也想在 PhoneGap 上使用 XForms！

不幸的是，移动浏览器本身并不支持 XForms。所以我测试了我自己的 XForms 实现 (XSLTForms)，它现在可以在 Android 上运行。

我的问题是关于在 PhoneGap 中使用 XSLT，因为 XSLTForms 基于 XSLT 1.0 将 XForms 转换为 HTML+Javascript。

你在 PhoneGap 中试验过 XSLT 了吗？？？

谢谢！

-阿兰

# c# - 为什么 MouseHover 事件只有在 messagebox.show() 或断点发生在它之前才被调用？

> ID：10323824
> 
> 赞同：0
> 
> 时间：2012-04-25T21:07:35.450
> 
> 标签：c#, winforms, mouseevent, mouseover

我有一个布尔值，用于跟踪 FlowLayoutPanel 上的右键 MouseDown 事件和相应的后续 MouseUpEvent 之间的状态：

```
 bool TextBoxesRespondingToMouseMoveEvents = false; 
```

...这是 FlowLayoutPanel 的 MouseDown 和 MouseUp 事件中的代码，以及 FlowLayoutPanel 上的所有 TextBox 共享的共享 MouseHover 处理程序：

```
 private void flowLayoutPanelGreatGooglyMooglyMain_MouseDown(object sender, MouseEventArgs e) {
        if (e.Button == MouseButtons.Right) {
            TextBoxesRespondingToMouseMoveEvents = true;
            //MessageBox.Show("TextBoxesRespondingToMouseMoveEvents is now true");
            selectionStart = PointToClient(MousePosition);
        }
    }

    private void flowLayoutPanelGreatGooglyMooglyMain_MouseUp(object sender, MouseEventArgs e) {
        if (e.Button == MouseButtons.Right) {
            TextBoxesRespondingToMouseMoveEvents = false;
            selectionEnd = PointToClient(MousePosition);
        }
    }

    // This event is shared by all of the buttons on flowLayoutPanelGreatGooglyMooglyMain
    private void textBoxQH1_MouseHover(object sender, EventArgs e) {
        if (TextBoxesRespondingToMouseMoveEvents) {
            TextBox tb = (TextBox)sender;
            if (tb.BackColor.Equals(SystemColors.Window)) {
                tb.BackColor = System.Drawing.Color.Gainsboro;
            }
        }
    } 
```

只要 MouseDown 事件中的 MessageBox.Show() 没有被注释掉，或者如果我在该事件中有断点，这就是有效的。但是，如果您只是让代码运行，同时注释掉 MessageBox.Show()，则 MouseHover() 事件永远不会触发。

为什么，我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T21:21:24.223

看看[这个问题](https://stackoverflow.com/questions/1772409/bubbling-events-not-occurring)的答案；虽然他们没有直接解释没有/没有 MessageBox（或断点）之间的行为差​​异，但它开始解释文本框将吞噬鼠标事件，并且您应该改为挂钩 PreviewXXX 事件。

# .net - 如何强制 ANYCPU .net 应用程序以 32 位或 64 位运行？

> ID：10323828
> 
> 赞同：0
> 
> 时间：2012-04-25T21:08:09.697
> 
> 标签：.net, registry, processstartinfo

我有一个 Office 插件。当需要在 HKLM 中设置许可证密钥时，它会使用 runas=admin 启动应用程序。最高到 Office 2007 Office 是 32 位的。但是，Office 2010 提供 32 位或 64 位版本。该版本确定 HKLM 密钥是否在 WoW 或笔记中。

因此，我需要以与 Office（和我的插件）匹配的位数启动应用程序。我怎样才能做到这一点？

或者，在 64 位模式下运行时如何访问 WoW 注册表和在 WoW 中运行时如何访问 64 位（常规）注册表？

我在 .NET 3.5 上。

谢谢 - 戴夫

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-25T22:26:59.450

您可以使用[CorFlags](http://msdn.microsoft.com/en-us/library/ms164699.aspx)修改 .exe ：

```
CorFlags.exe MyAssembly.exe /32Bit+ 
```

将强制 32 位，并且：

```
CorFlags.exe MyAssembly.exe /32Bit- 
```

将再次将其关闭。[这篇博文](http://lostechies.com/gabrielschenker/2009/10/21/force-net-application-to-run-in-32bit-process-on-64bit-os/)中有一些替代方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T22:20:13.890

您需要分别编译两个不同的exe。您不能事先强制执行 exe 的位数。

# javascript - 带有函数的 JavaScript 三元运算符示例

> ID：10323829
> 
> 赞同：96
> 
> 时间：2012-04-25T21:08:18.337
> 
> 标签：javascript, jquery

我正在使用 jQuery 1.7.1

我刚刚开始使用 JavaScript 三元运算符来替换简单的 if/else 语句。我已经在几个地方成功地做到了。当我成功地让其他东西工作时，我感到很惊讶，而我认为它肯定不会，但我还是尝试了。

这是原始声明：

```
function updateItem() {
    $this = $(this);
    var IsChecked = $this.hasClass("IsChecked");
    if (IsChecked == true){
        removeItem($this);
    } else {
        addItem($this);
    }
} 
```

这是使用三元运算符的相同函数：

```
function updateItem() {
    $this = $(this);
    var IsChecked = $this.hasClass("IsChecked");
    (IsChecked == true) ? removeItem($this) : addItem($this);
} 
```

我很惊讶，因为我看到的所有示例都只是设置如下变量：

```
x = (1 < 2) ? true : false; 
```

我的问题是这是否是“正常”使用，它是否适用于大多数版本的 JavaScript？它会在哪里失败？它还有其他不太明显的用途吗？

**更新——感谢“现实世界”的建议！！！**

我将其用作我的功能：

```
function updateItem() {
    $this = $(this);
    $this.hasClass("IsChecked") ? removeItem($this) : addItem($this);
} 
```

* * *

## 回答 #1

> 赞同：195
> 
> 时间：2012-04-25T21:17:11.497

嘿，您的问题中有一些非常令人兴奋的三元语法用法；我最喜欢最后一张了。。。

```
x = (1 < 2) ? true : false; 
```

在这里使用三元是完全没有必要的——你可以简单地写

```
x = (1 < 2); 
```

同样，三元语句的条件元素始终被评估为布尔值，因此您可以表示：

```
(IsChecked == true) ? removeItem($this) : addItem($this); 
```

简单来说：

```
(IsChecked) ? removeItem($this) : addItem($this); 
```

事实上，我也会删除`IsChecked`临时的，这会给你留下：

```
($this.hasClass("IsChecked")) ? removeItem($this) : addItem($this); 
```

至于这是否是可接受的语法，肯定是！这是在不影响可读性的情况下将四行代码减少为一条的好方法。我要给你的唯一建议是避免在同一行嵌套多个三元语句（这种方式很疯狂！）

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-04-25T21:22:19.650

三元样式一般用于节省空间。从语义上讲，它们是相同的。我更喜欢使用完整的 if/then/else 语法，因为我不喜欢牺牲可读性——我是老派，我更喜欢大括号。

完整的 if/then/else 格式用于几乎所有内容。如果您在每个分支中进入较大的代码块，则它特别受欢迎，您有一个多分支的 if/else 树，或者一个长字符串中的多个 else/ifs。

当您基于一个简单的条件为变量赋值或您正在做出具有非常简短结果的多个决策时，三元运算符很常见。您引用的示例实际上没有意义，因为表达式将评估为两个值之一而没有任何额外的逻辑。

好主意：

```
this > that ? alert(this) : alert(that);  //nice and short, little loss of meaning

if(expression)  //longer blocks but organized and can be grasped by humans
{
    //35 lines of code here
}
else if (something_else)
{
    //40 more lines here
}
else if (another_one)  /etc, etc
{
    ... 
```

不太好：

```
this > that ? testFucntion() ? thirdFunction() ? imlost() : whathappuh() : lostinsyntax() : thisisprobablybrokennow() ? //I'm lost in my own (awful) example by now.
//Not complete... or for average humans to read.

if(this != that)  //Ternary would be done by now
{
    x = this;
}
else
}
    x = this + 2;
} 
```

一个**非常基本**的经验法则——你能在一行上理解整个事情还是更好地理解？三元没问题。否则展开。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2016-05-17T08:51:31.270

我也想从我这里添加一些东西。

使用三元运算符调用函数的其他可能语法是：

```
(condition ? fn1 : fn2)(); 
```

如果您必须将相同的参数列表传递给两个函数，这会很方便，因此您只需编写一次。

```
(condition ? fn1 : fn2)(arg1, arg2, arg3, arg4, arg5); 
```

您甚至可以将三元运算符与成员函数名称一起使用，我个人非常喜欢这样以节省空间：

```
$('.some-element')[showThisElement ? 'addClass' : 'removeClass']('visible'); 
```

或者

```
$('.some-element')[(showThisElement ? 'add' : 'remove') + 'Class']('visible'); 
```

另一个例子：

```
var addToEnd = true; //or false
var list = [1,2,3,4];
list[addToEnd ? 'push' : 'unshift'](5); 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-04-25T21:17:01.990

您发布的示例没有什么特别棘手的。

在三元运算符中，计算第一个参数（条件），如果结果为`true`，则计算并返回第二个参数，否则计算并返回第三个参数。这些参数中的每一个都可以是任何有效的代码块，包括函数调用。

这样想：

```
var x = (1 < 2) ? true : false; 
```

也可以写成：

```
var x = (1 < 2) ? getTrueValue() : getFalseValue(); 
```

这是完全有效的，这些函数可以包含任意代码，无论是否与返回值有关。此外，三元运算的结果不必分配给任何东西，就像函数结果不必分配给任何东西一样：

```
(1 < 2) ? getTrueValue() : getFalseValue(); 
```

现在只需用任意函数替换那些，你就会得到类似你的例子的东西：

```
(1 < 2) ? removeItem($this) : addItem($this); 
```

现在你的最后一个例子根本不需要三元组，因为它可以这样写：

```
x = (1 < 2);  // x will be set to "true" 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2013-11-13T19:49:17.267

如果你要嵌套三元运算符，我相信你会想做这样的事情：

```
 var audience = (countrycode == 'eu') ? 'audienceEU' :
                  (countrycode == 'jp') ? 'audienceJP' :
                  (countrycode == 'cn') ? 'audienceCN' :
                  'audienceUS'; 
```

写/读比：

```
var audience = 'audienceUS';
if countrycode == 'eu' {
   audience = 'audienceEU';
} else if countrycode == 'jp' {
   audience = 'audienceJP';
} else if countrycode == 'cn' {
   audience = 'audienceCN';
} 
```

与所有优秀的编程一样，对于在项目完成后必须阅读代码的人来说，空白会让一切变得美好。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-12-22T13:36:22.737

我知道问题已经回答了。

但让我在这里补充一点。这不仅是真假的情况。见下文：

```
var val="Do";

Var c= (val == "Do" || val == "Done")
          ? 7
          : 0 
```

这里如果 val 是 Do 或 Done 那么 c 将为 7 否则它将为零。在这种情况下，c 将为 7。

这其实是这个算子的另一个视角。

# javascript - 对象属性比较

> ID：10323830
> 
> 赞同：0
> 
> 时间：2012-04-25T21:08:18.417
> 
> 标签：javascript, arrays, object, comparison

为了找到多个用户设置的“交集”（布尔值），我需要将他们的设置对象相互比较。例如：如果您单击一个用户，您会看到他的设置并可以对其进行编辑，但是如果您选择多个可以具有不同设置的用户，我希望能够显示一个不确定的状态以显示已设置特定设置对某些用户为真，对另一些用户为假。在多选的情况下，相同的设置将应用于所有选定的用户。

这是我到目前为止提出的一个示例，并且想知道是否有更优雅的方法来做到这一点（只要至少有两个具有不同设置的用户，那么我可以忽略其余的）：[http ://jsfiddle.net/kT7UP/](http://jsfiddle.net/kT7UP/)

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T21:12:54.000

您可以将每个属性测试变成一个通用函数，您可以在其中传递属性名称。所以你所有的重复`for`循环都变成了这样：

```
function checkCommonValue(prop) {
    for (var j = 0; j < userAll.length; j++) {
        if (userAll[j][prop] != model[prop]) {
            console.log('Indeterminate status');
            return(false);
        }
    }
    return(true);
}

checkCommonValue("Printing");
checkCommonValue("Sharing");
checkCommonValue("Reading");
checkCommonValue("AccountEnabled");
checkCommonValue("Fax"); 
```

记住基本的编码原则 DRY（不要重复自己）。如果您发现您正在重复几乎相同的代码块，那么是时候想办法将该代码分解为可以从多个位置调用的通用函数，而不是将相同的代码复制/粘贴到多个位置。

# c# - 以编程方式确定要在页面上输出什么类型的 html 元素——这个逻辑应该放在哪里？

> ID：10323831
> 
> 赞同：0
> 
> 时间：2012-04-25T21:08:22.933
> 
> 标签：c#, .net, asp.net-mvc, asp.net-mvc-3

我有一个下拉列表，代表与文档相关的各种“属性”字段。例如，一个文档可能有一个标签字段，它需要一个文本框来输入您的标签。或者它可能有一个位置字段，并且会有一个用户可以选择的各种位置类型的预填充下拉列表。或者它可能是一个截止日期字段，我们有一个用于选择日期的自定义日期选择器。

我的问题：我想在选择适当的属性字段时在控制器动作中声明一个HTMLHELPER。我将切换 Attribute.Type 是什么，并且根据类型，我将在我的视图模型中返回适当的 html 以在视图中呈现。如果我这样做，我可以对我的 switch 语句进行单元测试。

我正在阅读所有在控制器中声明 HtmlHelper 是一个坏主意。我能理解这种情绪——有没有更好的方法可以做到这一点？我想尽可能避免在我的视图中使用逻辑，因为我根本无法对其进行单元测试。

我看到的另一种方法是在视图模型中传递 Attribute.Type，并在视图上执行切换逻辑以确定调用哪个 HtmlHelper 方法。这是要走的路吗？提前致谢。

编辑：我说的是想在代码隐藏中做这样的事情。我的单元测试会针对 viewModel.FieldHtml 断言。我听到的是我应该把它放在另一个类中并让控制器调用它。但这就是它在控制器中的样子。这只是伪代码，所以它并不完美，但它为我所问的内容提供了上下文。

```
public ActionResult GetValueInput(Guid attributeFieldUid)
{
    //you have to pass some stuff into the constructor but essentially this
    HtmlHelper html = new HtmlHelper();
    AttributeField field = GetAttributeFieldFromDb(attributeFieldUid);

    AttributeViewModel viewModel = new AttributeViewModel();
    switch(field.type)
    {
        case Dropdown:
            viewModel.FieldHtml = html.DropDownList();
            break;
        case Text:
            viewModel.FieldHtml = html.TextBox();
            break;
        case Date:
            // our own extension method
            viewModel.FieldHtml = html.OurDatePicker();
            break;
    }
} 
```

我最初看到的另一个选项基本上是在剃刀视图上执行此 switch 语句。但我想我喜欢在控制器最常调用的单独类中执行此操作的想法。

这真的是一个设计问题——我在问什么方法来实现这个最有意义？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T06:08:33.187

您可以为此编写自定义 HTML 帮助程序。所以控制器动作将负责填充视图模型并将其传递给视图：

```
public ActionResult GetValueInput(Guid attributeFieldUid)
{
    AttributeField field = GetAttributeFieldFromDb(attributeFieldUid);
    AttributeViewModel viewModel = new AttributeViewModel();
    viewModel.FieldType = field.type;
    return View(viewModel);
} 
```

然后写一个助手：

```
public static class HtmlExtensions
{
    public static IHtmlString Field(this HtmlHelper html, FieldType type)
    {
        switch(field.type)
        {
            case Dropdown:
                return html.DropDownList(... you will probably need some more info on your view model to be passed here to generate a dropdown)
            case Text:
                return html.TextBox(...);
            case Date:
                return html.OurDatePicker();
        }

        return MvcHtmlString.Empty;
    }
} 
```

这个助手将在视图中使用：

```
@model AttributeViewModel
@Html.Field(Model.FieldType) 
```

另一种可能性是使用编辑器模板。这是[一个例子](https://stackoverflow.com/a/6333898/29407)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T20:18:37.480

嗯，听起来像是 AOP 的工作。

这很简单，创建一个自定义属性，您可以在其中指定字段的类型以及所需的任何其他参数，例如。

```
public class CustomAttribute : Attribute
{
    private readonly FieldType _fieldType;
    public CustomAttribute(FieldType fieldType)
    {
        _fieldType = fieldType;
    }
    public FieldType FieldType { get { return _fieldType; } }
} 
```

并在视图模型上注释属性。

```
[Custom(FieldType.CheckBox)]
public int SomeField { get; set; } 
```

然后编写一个 html helper 扩展方法 ex。

```
public static class CustomHtmlHelperExtensions
{
    public MvcHtmlString CustomControlFor<TModel, TProperty>(this HtmlHelper<TModel> htmlHelper, Expression<Func<TModel,TProperty>> memberExpression)
    {
        var member = ((MemberExpression)model.Body).Member;
        var customAttribute = member.GetAttributes().OfType<CustomAttribute>().Cast<CustomAttribute>().SingleOrDefault();
        if(customAttribute == null)
        //Perform certain logic if the property doesn't have the attribute specified
        //ex. return null;
        switch(customAttribute.FieldType)
        {
            case FieldType.TextBox: 
                {
                    //Do something
                    return htmlHelper.TextBoxFor(memberExpression);
                }
            default: break;
        }
        return null;
    }
} 
```

这至少应该让你开始:)

# nhibernate - 用 NHibernate 3.2 和 FluentNHibernate 1.3 截断的十进制字段

> ID：10323833
> 
> 赞同：4
> 
> 时间：2012-04-25T21:08:27.153
> 
> 标签：nhibernate, fluent-nhibernate

我有一个案例，当保存到数据库时，十进制字段被截断到小数点后五位。即使我以小数点后 10 位的精度映射它们，也会发生这种情况。

我在 SQL Server 2008 中使用 NHibernate 3.2.0.4000 和 FluentNHibernate 1.3.0.717。

这是我的 C# 属性：

```
public virtual decimal? MyDecimalField { get; set; } 
```

我试过做一个自动映射覆盖：

```
mapping.Map(x => x.MyDecimalField).Precision(28).Scale(10); 
```

我也尝试过对该字段进行显式映射：

```
Map(x => x.MyDecimalField).Precision(28).Scale(10); 
```

进行模式导出时，表会正确创建：

```
create table MyTable (
    Id UNIQUEIDENTIFIER not null,
   MyDecimalField DECIMAL(28, 10) null,
   primary key (Id)
) 
```

使用值 5.1234567890，以下是生成的 SQL 更新语句的参数片段：

```
@p31 decimal(28,5)
@p31=5.12345 
```

如果我使用 XML 映射，我可以正常工作：

```
<property name="Decimal01" precision="28" scale="10"/> 
```

我已经删除了十进制字段的所有约定，但仍然存在问题。

由于基于 XML 的映射有效，这让我相信这是 Fluent 的问题。关于我可能错过的其他事情的任何建议？

谢谢，跳过

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-27T20:39:10.747

我将在这里回答我自己的问题。感谢@Firo 给了我一些提示，让我找到了解决方案。

我有一个约定为我的字符串字段设置默认长度：

```
 public void Apply(IPropertyInstance instance)
    {
        instance.Length(350);
    } 
```

但我的接受标准并没有排除十进制字段。我添加了一些验收标准以排除小数：

```
 public void Accept(IAcceptanceCriteria<IPropertyInspector> criteria)
    {
        criteria
            .Expect(x => x.Type != typeof(decimal) && x.Type != typeof(decimal?));
    } 
```

这样做更正了我的小数精度。

有趣的是，我的默认字符串长度 350 没有出现在我导出的十进制字段的 XML 映射文件中。但似乎 FNH 仍在以某种方式使用它。这对我来说似乎是一个 FNH 错误。

# jquery - blockUI jquery 插件 - 图像未在 Firefox 中加载

> ID：10323840
> 
> 赞同：0
> 
> 时间：2012-04-25T21:09:02.700
> 
> 标签：jquery, blockui, jquery-blockui

我正在使用 bockUI 插件在处理过程中显示等待消息。我的消息的 html 是：

```
<font style="font-size:15px; color: #333333"> <img src="images/busy.gif" />  Please wait...</font> 
```

该图像在 IE 中显示没有任何问题，但 Firefox 不显示该图像。只是一个图像占位符。

有没有人遇到过这个问题并且知道修复。

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-01-25T13:09:52.260

您可以在 blockUI 代码之前预加载图像。

```
img1 = new Image();
img1.src = "images/busy.gif"; 
```

…………其他脚本…………

```
<font style="font-size:15px; color: #333333"> <img src="images/busy.gif" />  Please wait...</font> 
```

这让我的 gif 出现了，但动画并不一致。

# ruby-on-rails - Rails 3 - PaperClip - 大量目录的存储选项

> ID：10323841
> 
> 赞同：0
> 
> 时间：2012-04-25T21:09:09.333
> 
> 标签：ruby-on-rails, paperclip, storage

我想使用回形针插件，我在文档中看到了更改存储路径的方法。

由于我的模型（以及同一级别的目录）将拥有数千个项目，因此我想知道如何格式化我的 :id （并将其分解）以执行某些操作，例如，如果 id 为 32768，例如：

```
:path => ":rails_root/public/system/:class/:attachment/3/2/7/6/8/:style/:basename.:extension" 
```

爆炸 :id 并将新路径发送到回形针的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T21:57:40.287

您想使用[Paperclip::Interpolations](https://github.com/thoughtbot/paperclip/wiki/Interpolations)。您可以创建使用分解 id 的自定义插值。首先，您需要在路径中使用自定义插值：

```
 :path => ":rails_root/public/system/:class/:attachment/:exploded_id/:style/:filename" 
```

然后像这样向模型添加一个定义：

```
Paperclip.interpolates :exploded_id do |attachment, style|
  attachment.instance.exploded_id
end 
```

以及爆炸 id 的方法：

```
def exploded_id
  self.id.to_s.scan(/./).join('/')
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T09:40:57.863

Paperclip 提供了一种处理文件夹结构的内置方法：

```
:path => ":rails_root/public/system/:class/:attachment/:id_partition/:style/:basename.:extension" 
```

这将给出目录结构

```
.../:attachment/000/032/768/:style/... 
```

这不使用您请求的文件夹格式，但可能更有效。

**奖金**

如果您要从现有文件夹结构转换到这个 id 分区结构，请检查并查看这个[Ruby 脚本](https://gist.github.com/3313170)，它会为您移动文件夹。以防万一，请在运行之前对服务器上的虚拟文件夹进行一些测试。

# jquery-ui - 在 jquery-ui 对话框中调整画布大小

> ID：10323844
> 
> 赞同：0
> 
> 时间：2012-04-25T21:09:16.570
> 
> 标签：jquery-ui, canvas

我有一个包含画布的 jquery-ui 对话框，并且棋盘被绘制到画布上，如下所示：

```
<html>
<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/jquery-ui.min.js></script>
<script>
$(function) {
    $("#chessboard").dialog({
        autoOpen: true,
        height: 500,
        width: 500,
        modal: false
    }

    function drawboard() {
        ctxt = document.getElementByID("chessboard").getContext("2d");

        // draw the board into the context
        ...
    }

    drawboard();
    </script>
    </head>
    <body>
    <canvas id="chessboard" width="400" height="400" />
    </body>
    </html> 
```

棋盘填满了整个对话框，但是当我发现棋盘可以与对话框一起调整大小时，我感到非常惊讶。然后我尝试了以下操作，以便将例如游戏符号与棋盘一起安排到对话框中：

```
<html>
<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/jquery-ui.min.js></script>
<script>
$(function) {
    $("#chessboard-container").dialog({
        autoOpen: true,
        height: 500,
        width: 500,
        modal: false
    }

    function drawboard() {
        ctxt = document.getElementByID("chessboard").getContext("2d");

        // draw the board into the context
        ...
    }

    drawboard();
    </script>
    </head>
    <body>
    <div id="chessboard-container">
        <canvas id="chessboard" width="400" height="400" />
        <div id="notation"></div>
    </div>
    </body>
    </html> 
```

现在板子仍然渲染到画布上，但不能用对话框调整它的大小。

是否可以与 canas 一起调整 chessboard-container 元素的大小？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T21:33:06.143

看起来您想绑定到“resize”事件，然后在该事件期间重新绘制棋盘。

添加一个

```
resize: function(event, ui) { drawChessBoard() } 
```

到你的初始化代码

# javascript - 从已使用 Javascript 放置的 html5 画布中删除图像

> ID：10323847
> 
> 赞同：0
> 
> 时间：2012-04-25T21:09:44.870
> 
> 标签：javascript, html5-canvas, dom-events

我有以下函数使用 JavaScript 将图像绘制到 HTML5 画布上：

```
function drawStartButton(){
            image.onload = function(){
                context.drawImage(image, 260.5, 60);
            };
            image.src = "StartButton.png";

            var boundingBox = myGameCanvas.getBoundingClientRect();

            boundingBox.onmousemove = function(e){
                var mouseX = e.pageX - this.offsetLeft;
                var mouseY = e.pageY - this.offsetTop;
                var pixels = context.getImageData(mouseX, mouseY, 1, 1);
            }
        } 
```

该图像将用作按钮，单击时将调用另一个函数。单击按钮时我要调用的函数是：

```
function drawLevelOneElements(){
            image.onload = function(){
                context.drawImage(image, 50, 30, 20, 20); 

            };
            image.src = "1.png";
} 
```

我在画布上添加了一个事件监听器，它监听按钮的点击，并在点击发生时调用该函数。这目前可以正常工作，但是，虽然`drawLevelOneElements()`调用了函数，并绘制到画布上，调用绘制的图像`drawStartButton()`也仍然显示在画布上，所以我将两个函数的内容同时显示在画布上.

我想要发生的是，当单击按钮时，按钮然后消失，并且绘制的元素`drawLevelOneElements`是画布上显示的内容，而开始按钮不再存在。

有人能告诉我在画布上绘制后如何清除`drawStartButton()`画布上绘制的图像吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T01:59:30.973

通常，您可以通过设置其宽度或高度值来清除整个画布。

如果要清除画布的一个区域，可以通过在该区域上绘制一个 fillRect 来实现 - 例如，将 fillStyle 设置为与画布的背景颜色相同的颜色。

```
 context.fillStyle = this.fill;
 context.fillRect( x, y, width, height ); 
```

# c - 如何使用 void 函数操作两个数组

> ID：10323848
> 
> 赞同：1
> 
> 时间：2012-04-25T21:09:48.247
> 
> 标签：c

此代码要求用户填写矩阵，然后调用 void 函数将它们加在一起。我有一个[www.ideone.com](http://ideone.com/9Ulbo) 我也无法更改很多代码。要求所有这些定义语句和一个 void 函数。

```
#include <stdio.h>
#include <math.h>

#define NCOL1 2
#define NCOL2 2
#define NROW1 2
#define NROW2 2
#define NCOL3 2
#define NROW3 2

int main (void)
{
    //Initiate variables
    double a, b;
    int    i, j;
    void   addarray(double a, double b);
    double ans;
    double arr1[NCOL1][NROW1], arr2[NCOL2][NROW1];

    //Ask user to enter numbers for the first matrix
    printf("Please enter numbers for Matrix 1 :\n ");
    for (i = 0; i < NCOL1; i++) {
        for (j = 0; j < NROW1; j++) {
            scanf("%lf", &arr1[i][j]);
        }
    }

    //Ask user to enter numbers for the second matrix
    printf("Please enter numbers for Matrix 2 :\n ");
    for (i = 0; i < NCOL2; i++) {
        for (j = 0; j < NROW2; j++) {
            scanf("%lf", &arr2[i][j]);
        }
    }

    //Iterate through void function and print out result
    for (i = 0; i < NCOL3; i++) {
        for (j = 0; j < NROW3; j++) {
            addarray(arr1[i][j], arr2[i][j]);
            printf("%lf", ans);
        }
    }
    return 0;
}

void addarray (double a, double b)
{
    int i,j;
    double arrsum[NCOL3][NROW3];
    for (i = 0; i < NCOL3; i++) {
        for (j = 0; j < NROW3; j++) {
            arrsum[i][j] = a + b;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T21:20:15.213

你的问题是什么？感谢您提供代码，但目前尚不清楚您到底要做什么或代码当前做错了什么。请更新您的问题，详细说明您要完成的工作以及您需要帮助的具体内容。

一般建议：如果要使用函数操作数组，则函数需要将指向数组的指针作为参数。

此外，您的`addarray()`函数仅修改位于`arrsum`该函数范围内的数组。由于该函数`arrsum`在初始化其元素后从不做任何事情，因此整个函数本质上是一个空操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T21:20:51.540

**编辑：该问题的更好解决方案是：**

```
#include<stdio.h>
#include<math.h>
#define NCOL1 2
#define NCOL2 2
#define NROW1 2
#define NROW2 2
#define NCOL3 2
#define NROW3 2

void addarray(double a[NROW1][NCOL1], double b[NROW1][NCOL1], double (*c)[NCOL1]);

int main(void)
        {
  //Initiate variables
  double a,b;
  int i,j;
  double ans;
  double arr1[NCOL1][NROW1], arr2[NCOL2][NROW1];
  double arrsum[NCOL1][NROW1];

  //Ask user to enter numbers for the first matrix
  printf("Please enter numbers for Matrix 1 :\n ");
    for(i=0;i<NCOL1;i++){
       for(j=0;j<NROW1;j++){
         scanf("%lf",&arr1[i][j]);
       }
    }
  //Ask user to enter numbers for the second matrix
    printf("Please enter numbers for Matrix 2 :\n ");
    for(i=0;i<NCOL2;i++){
      for(j=0;j<NROW2;j++){
        scanf("%lf",&arr2[i][j]);
      }
    }

    addarray( arr1, arr2, &arrsum[0] );

    printf("Output of added arrays\n");
    for(i=0;i<NCOL3;i++){
            for(j=0;j<NROW3;j++){
                    printf("%lf ", arrsum[i][j]);
            }
        printf("\n");
    }

    return 0;
}

void addarray(double a[NROW1][NCOL1], double b[NROW1][NCOL1], double (*c)[NCOL1])
{
    int i,j;

    for(i=0;i<NCOL3;i++)
    {
        for(j=0;j<NROW3;j++)
        {
            c[i][j] = a[i][j] + b[i][j];
        }
    }
} 
```

**但是，只需进行最小的更改，以下内容也将起作用。**

看起来 addarray() 正在将其结果放入一个名为 arrsum[][] 的本地矩阵中。要使该程序正常工作，您很可能希望将 arrsum[][] 提供给程序的其余部分（尽管全局数组不是一个好主意）。

在不测试或编译代码的情况下，您至少应该进行以下更改：

1-`double arrsum[NCOL3][NROW3];`从`addarray()`

```
void addarray(double a,double b)
{
        int i,j;

        for(i=0;i<NCOL3;i++){
                for(j=0;j<NROW3;j++){
                        arrsum[i][j]=a+b;
                }
} 
```

2-`arrsum[][]`全球化

```
#include<stdio.h>
#include<math.h>
#define NCOL1 2
#define NCOL2 2
#define NROW1 2
#define NROW2 2
#define NCOL3 2
#define NROW3 2

/****  add declaration of arrsum[][] here ****/
double arrsum[NCOL3][NROW3]; 
```

我已经重写了部分程序，编译并测试了它。新代码如下。

```
#include<stdio.h>
#include<math.h>
#define NCOL1 2
#define NCOL2 2
#define NROW1 2
#define NROW2 2
#define NCOL3 2
#define NROW3 2

void addarray(double a,double b);

double arrsum[NCOL3][NROW3];

int main(void)
        {
  //Initiate variables
  double a,b;
  int i,j;
  double ans;
  double arr1[NCOL1][NROW1], arr2[NCOL2][NROW1];
  //Ask user to enter numbers for the first matrix
  printf("Please enter numbers for Matrix 1 :\n ");
    for(i=0;i<NCOL1;i++){
       for(j=0;j<NROW1;j++){
         scanf("%lf",&arr1[i][j]);
       }
    }
  //Ask user to enter numbers for the second matrix
    printf("Please enter numbers for Matrix 2 :\n ");
    for(i=0;i<NCOL2;i++){
      for(j=0;j<NROW2;j++){
        scanf("%lf",&arr2[i][j]);
      }
    }
    //Iterate through void function and print out result
    for(i=0;i<NCOL3;i++){
      for(j=0;j<NROW3;j++){
        addarray(arr1[i][j],arr2[i][j]);
//        printf("%lf",ans);
      }
    }

    printf("Output of added arrays\n");
    for(i=0;i<NCOL3;i++){
            for(j=0;j<NROW3;j++){
                    printf("%lf ", arrsum[i][j]);
            }
        printf("\n");
    }

    return 0;
}

void addarray(double a,double b)
{
        int i,j;

        for(i=0;i<NCOL3;i++){
                for(j=0;j<NROW3;j++){
                        arrsum[i][j]=a+b;
                }
        }
} 
```

# background - 背景滚动和缩放

> ID：10323849
> 
> 赞同：0
> 
> 时间：2012-04-25T21:09:51.177
> 
> 标签：background, playn

*注意*我对 playN 世界真的很陌生，并且迈出了使用这个工具的第一步。

我的问题是使用 playN 时创建滚动背景效果的最有效方法是什么？我已经想到了几个想法，但我想知道 playN 是否有特定的解决方案。playN版愤怒的小鸟中显示的多级滚动和缩放很像我正在寻找的效果。任何人都可以为我指出正确的方向来使用功能/如何在逻辑上设置这样的效果吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T19:37:40.733

缩放的想法：使用`Animator.tweenScale()`方法。

对于多级滚动，您可以构建一个解决方案`Animator.tweenTranslation()`

# filtering - Tridion Taxonomy 查询示例的任何好的来源

> ID：10323853
> 
> 赞同：12
> 
> 时间：2012-04-25T21:10:14.480
> 
> 标签：filtering, taxonomy, tridion2009, tridion

我有一个场景，我发布了数千个按特定类别/关键字分类的组件演示文稿，但这些组件还具有与定义前*n*相关的自定义元数据字段。将显示。本质上，我需要根据关键字过滤一组组件，根据自定义元数据对它们进行排序，并且只选择前 N 个。

我了解如何列出项目并创建基本过滤器（来自 API 中的过滤器项目列表），但我需要过滤元数据字段（例如，具有*最新*元数据“priorityDate”的三个项目）。

从我正在阅读的内容来看，我应该从分类搜索中获取所有记录（使用 TaxonomyKeywordCriteria），然后手动（对 QueryRunner 执行 SQL）检索所有组件的元数据以进行过滤/排序。

我肯定错过了一些东西（感觉不对，有 1/2 API 调用，然后在页面 SQL 脚本中）......如果没有，QueryRunner 查询是否会与分类 Query.executeQuery() 的结果一起缓存

示例代码：

```
ItemTypeCriteria isComponent = new ItemTypeCriteria(16);
TaxonomyKeywordCriteria taxonomyKeywordCriteria = new TaxonomyKeywordCriteria(taxURI, taxKeywordURI, true);
Criteria[] allCriteria = {isComponent, isTDIPublication, isArticle, taxonomyKeywordCriteria}; 
AndCriteria andCriteria = CriteriaFactory.And(allCriteria);
Query query = new Query();         
query.setCriteria(andCriteria); 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-26T00:27:12.900

在您的 JSP 中使用 SQL 似乎并不合适，因为它是数据层逻辑，不应出现在演示文稿中。此外，如果 Tridion 使用新版本更新数据库结构，则您的自定义 SQL 可能会停止工作。您最好使用 Broker API，而不是依赖于 Broker DB 中的自定义 SQL 语句。

我认为你最好的选择是尽量减少所需的数据库命中次数。API 允许按关键字过滤（您也可以按自定义元进行过滤，但这对您没有帮助，因为您提到要按给定的自定义元字段排序）。您有两个选项可以按关键字获取 CP 列表，然后您可以对其进行排序：

1.  查询.execureQuery()。这将返回一个 tcm URI 列表，这意味着必须进行单独的 DB 命中来检索 CustomMetadata 对象和 CP (ComponentPresentationFactory.GetComponentPresetation(tcmUri))。在所有内容都被充分缓存之前，这可能（并且可能会）变得很重。
2.  ComponentPresentationFactory.getTaxonomyComponentPresentations()。您可以将一组关键字传递给此方法并获取更大的 CP 集。这意味着一个快速的数据库查询。在 CM 方面，在组件模板中添加自定义元字段值的呈现作为 HTML 注释。然后回到交付端，只需从返回集的每个 CP 中解析出该值，并在应用程序服务器（而不是 DB）上进行排序。这将比执行许多数据库查询更快。

您的问题主题要求提供一些分类查询示例。查看 2011 文档中的 sdllivecontent 门户。API 与 2009 年的 API 几乎相同（只有细微的差别，但是，这里提供了一些关于构建过滤器的示例： [http ://sdllivecontent.sdl.com/LiveContent/web/pub.xql?action=home&pub =SDL_Tridion_2011&lang=en-US#addHistory=true&filename=DevelopingAFilter.xml&docid=concept_0AB6D192D7AB4EC18892631F519EF1DD&inner_id=&tid=&query=&scope=&resource=&eventType=lcContent.loadDocconcept_0AB6D192D7AB4EC18892631F51EF](http://sdllivecontent.sdl.com/LiveContent/web/pub.xql?action=home&pub=SDL_Tridion_2011&lang=en-US#addHistory=true&filename=DevelopingAFilter.xml&docid=concept_0AB6D192D7AB4EC18892631F519EF1DD&inner_id=&tid=&query=&scope=&resource=&eventType=lcContent.loadDocconcept_0AB6D192D7AB4EC18892631F519EF1DD)

如果您浏览主题，sdltridionworld 论坛是另一个好地方。以下是一些带有一些示例代码的线程：

1.  [https://forum.sdltridion.com/topic.asp?TOPIC_ID=6690&SearchTerms=taxonomy,query](https://forum.sdltridion.com/topic.asp?TOPIC_ID=6690&SearchTerms=taxonomy,query)
2.  [https://forum.sdltridion.com/topic.asp?TOPIC_ID=5619&SearchTerms=taxonomy,query](https://forum.sdltridion.com/topic.asp?TOPIC_ID=5619&SearchTerms=taxonomy,query)

# c# - 无法连接到服务器

> ID：10323862
> 
> 赞同：0
> 
> 时间：2012-04-25T21:10:51.340
> 
> 标签：c#, asp.net, cassini, cassini-dev

我在我的项目中使用[CassiniDevServer](http://cassinidev.codeplex.com/)。我创建了 CassiniDevServer 类的一个对象，然后调用它的 start() 方法传递适当的参数。

服务器在浏览器中正确托管和呈现网页。但过了一段时间，当刷新时，浏览器说

> 无法连接到本地主机：*端口号*

似乎服务器在一段时间后停止了。为什么会这样？我怎样才能避免这种情况？是否正在收集垃圾？

我有一个 MyCassiniDevUtil 类，它具有以下方法：

```
public CassiniDevServer launchWebsite(string path, string navigate, int _portNo)
  {
    CassiniDevServer _server = new CassiniDevServer();  ///server

    cassiniServerList.Add(_server);
    _server.StartServer(path, _portNo, "/", "localhost");
    portNo = _portNo;

    System.Diagnostics.Process.Start("http://localhost:" + portNo + 
          "/" + navigate);
    return _server;           
  } 
```

在调用代码中，我创建了一个对象，`MycassiniDevUtil`然后调用此方法。此方法返回对当前创建的服务器实例的引用。我在调用代码类中分配了这个引用。

所以实际上我确实引用了这两个类，但我仍然觉得它正在收集垃圾。或者，如果不是，我不明白为什么几分钟后刷新浏览器时显示无法连接...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T16:23:54.980

而不是在 CassiniDev 中创建 CassiniDevServer 类的对象；包，我创建了一个服务器类的对象如下（因为它允许指定超时属性）

```
 System.Net.IPAddress ip = System.Net.IPAddress.Parse("127.0.0.1");
        Server _server1 = new Server(_portNo, "/", path, ip, "localhost", 1800000);
        _server1.Start(); 
```

_portNo 是任何端口号 - 可能在未使用的端口号范围内。我动态随机生成了一个，如下所示：

```
 Random rn = new Random();
        int _portNo = rn.Next(1500, 4000); 
```

path 是网站文件夹的物理路径（包含 web.config、AppCode、AppData 的路径）。

1800000 相当于 30 分钟的毫秒数。

/ 指定获取托管在地址[http://localhost](http://localhost) :<_portNo>/的网站

**但是任何人都可以澄清 CassiniDevServer 和 CassiniDev 包中的 Server 类之间的区别。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T23:35:02.497

您应该查看 CassiniDevServer 对象上的 TimeOut 选项。

这是服务器在*自行关闭*之前将处于空闲状态的时间量（以毫秒为单位） 。我看不到你在哪里设置这个，所以，很可能服务器本身正在关闭。

现在，只要您保持对它的引用，它就不会被垃圾收集。但由于上述原因，这是一个红鲱鱼。

# java - 休眠：一对一关系的查询太多

> ID：10323863
> 
> 赞同：3
> 
> 时间：2012-04-25T21:10:55.170
> 
> 标签：java, sql, hibernate, one-to-one

**简洁版本**

Hibernate 正在执行多个选择查询而不是仅两个查询来检索一对一的关系

**长版**

人物类：

```
@Entity
@Table(name = "people")
public class Person{

  @Id
  @GeneratedValue
  @Column
  private Integer id;

  @Column
  private String name;

  @OneToOne(optional=false, fetch=FetchType.EAGER)
  private Job job;
} 
```

工作类别：

```
@Entity
@Table(name = "jobs")
public class Job{

  @Id
  @GeneratedValue
  @Column
  private Integer id;

  @Column
  private String name;
} 
```

显示所有人员及其工作：

```
Session session = HibernateUtil.getSessionFactory().getCurrentSession();
session.beginTransaction();
List<Person> people = session.createQuery("from Person").list();
for(Person p : people){
    System.out.println(p.getName() + " | " + p.getJob().getName());
} 
```

我所期望的：两个选择，五个人一个，三个不同工作的一个（三个人有相同的工作）

我得到了什么：四个选择，一个用于人员，三个用于每个不同的工作

```
Hibernate: select person0_.id as id1_, person0_.job_id as job3_1_, person0_.name as name1_ from people person0_
Hibernate: select job0_.id as id0_0_, job0_.name as name0_0_ from jobs job0_ where job0_.id=?
Hibernate: select job0_.id as id0_0_, job0_.name as name0_0_ from jobs job0_ where job0_.id=?
Hibernate: select job0_.id as id0_0_, job0_.name as name0_0_ from jobs job0_ where job0_.id=?
Jim | Programmer
Andrew | DBA
Tomas | Sysadmin
Henry | Sysadmin
Jerry | Sysadmin 
```

如果我有 1000 个人从事 1000 个不同的工作，我会看到 1000 个选择被执行。我怎样才能让 Hibernate 只做两个选择？

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-25T21:26:37.700

这是`n + 1`问题的一个示例， [Hibernate 手册](http://docs.jboss.org/hibernate/orm/3.5/reference/en/html/performance.html#performance-fetching-custom)建议使用`JOIN`fetch 模式。您可以使用特定于休眠的注释启用此功能

```
@Fetch(FetchMode.JOIN) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T21:27:39.750

你没有一对一的关系，你有一个一对多的关系。一个工作可以有多个人参与其中。Hibernate 假设实际上存在一对一的关系，并且没有注意到三个人指向一份工作。然后你必须解决 N+1 选择问题，正如 beerbajay 指出的那样。

# java - Java - 如何将内部类中的变量分配给外部类/或任何其他类中的变量？

> ID：10323868
> 
> 赞同：0
> 
> 时间：2012-04-25T21:11:46.550
> 
> 标签：java, string, swing, inner-classes

我有一个包含文本字段的类，并且在该类中包含一个包含操作执行方法的内部类。在输入文本并按 Enter 键时，我希望将文本分配给实现动作侦听器的内部类之外的字符串“s”。我想在另一个类中使用该字符串。

```
public class Peaches extends JFrame {
    private JTextField item1;

    public Peaches() {
        super("the title");
        setLayout(new FlowLayout());        
        item1 = new JTextField(10);
        add(item1);

    thehandler handler = new thehandler(); //object of thehandler inner class
    item1.addActionListener(handler);      

    // I want to use the textfield content here, or in other classes, updated
    // with the new text everytime i hit enter after entering new text in the textfield 

    //String s = the content of the textfield
}

private class thehandler implements ActionListener { // inner class
    @Override
    public void actionPerformed(ActionEvent event) {
        String string = "";           
        string = String.format(event.getActionCommand());            
        JOptionPane.showMessageDialog(null, string);           
    }
} 
```

有没有办法做到这一点？必须可以在程序的其他部分使用文本字段的输入。我希望我能说清楚，谢谢大家。

编辑感谢您的回复，因此使变量字符串成为类变量而不是在构造函数中声明它允许整个类访问它，简单但我只是不明白。谢谢马尔科

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T21:22:24.700

我建议你这样做：

```
public class Peaches extends JFrame {
  private JTextField item1;
  private String string;

  public Peaches() {
    super("the title");
    setLayout(new FlowLayout());
    item1 = new JTextField(10);
    add(item1);
    item1.addActionListener(new ActionListener() {
      @Override public void actionPerformed(ActionEvent event) {
        string = String.format(event.getActionCommand() );
        JOptionPane.showMessageDialog(null, string);
    }});
  }
} 
```

这使用了一个匿名类，比周围有几十个内部类更简单。加上这些，您可以制作闭包（使用在匿名类之外声明的局部变量）。你的字符串在外面，所以你可以访问它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T21:34:49.687

*我想在此处或其他类中使用文本字段内容，每次在文本字段中输入新文本后按回车键时都会使用新文本进行更新*

简短的回答是，如果您希望每次更改文本字段中的值时都执行代码，则必须将侦听器附加到文本字段并通过侦听器触发该代码。这就是监听器的用途......唯一知道文本已更改的是文本字段，他将通知其监听器有关已进行更改的事实（[观察者模式](http://en.wikipedia.org/wiki/Observer_pattern)）

如果您想在多个课程中了解此更改，您可以

*   提供 API 以从当前类外部将侦听器附加到此特定文本字段
*   提供 API 以从当前类外部直接访问文本字段
*   将一个侦听器附加到更新某种模型的文本字段，并在不同类之间共享模型。当然，模型应该能够触发事件并通知侦听器有关更改，否则您将无法判断值何时更改。

是否使用内部类、匿名类、成熟类作为侦听器并不重要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T21:14:18.493

如果您将 s 移动为类变量而不是方法变量（目前在构造函数中已注释掉），它将起作用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-25T21:14:40.327

您可以将外部类作为内部类的构造函数中的参数传递。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-25T21:37:35.197

您根本不需要内部类。只需在其中实现一个 ActionListener`Peaches`并让它监听`ActionEvent`：

```
public class Peaches extends JFrame implements ActionListener
{
    private JTextField item1;

    public Peaches()
    {
        super("the title");
        setLayout(new FlowLayout());        
        item1 = new JTextField(10);
        add(item1);

        item1.addActionListener(this);      
    }

    public void actionPerformed(ActionEvent event)
    {
        if (event.getSource() == item1){
            String string = "";           
            string = String.format(event.getActionCommand() );            
            JOptionPane.showMessageDialog(null, string);   
        }        
    }
} 
```

# jquery - jQuery 表格列/行隐藏或更改颜色

> ID：10323876
> 
> 赞同：1
> 
> 时间：2012-04-25T21:12:35.280
> 
> 标签：jquery, html, datatable, html-table

现在我正在玩一个想法，我想改变颜色（可能最终删除/隐藏）一列或一行数据现在我的目标是列。到目前为止，我已经部分工作但不完全

有了这个：

```
$('#'+arry[0]+' tr td:eq('+arry[1]+')').css({"background-color":"FF0"}); 
```

我能够影响该列，但只能影响一行，而不是该列中的所有行，并且它似乎影响“tbody”中的行/列，而不是“thead”或“tfoot”我需要影响所有 3 .

我正在使用的表格示例如下：

```
<table id="testerTable">
    <thead>
        <th>First</th>
        <th>Second</th>
        <th>Third</th>
        <th>Fourth</th>
        <th>Fifth</th>
    </thead>
    <tbody>
        <tr>
            <td>1</td>
            <td>2</td>
            <td>3</td>
            <td>4</td>
            <td>5</td>
        </tr>
        <tr>
            <td>1</td>
            <td>2</td>
            <td>3</td>
            <td>4</td>
            <td>5</td>
        </tr>
        <tr>
            <td>1</td>
            <td>2</td>
            <td>3</td>
            <td>4</td>
            <td>5</td>
        </tr>
        <tr>
            <td>1</td>
            <td>2</td>
            <td>3</td>
            <td>4</td>
            <td>5</td>
        </tr>
        <tr>
            <td>1</td>
            <td>2</td>
            <td>3</td>
            <td>4</td>
            <td>5</td>
        </tr>
        <tr>
            <td>1</td>
            <td>2</td>
            <td>3</td>
            <td>4</td>
            <td>5</td>
        </tr>
        <tr>
            <td>1</td>
            <td>2</td>
            <td>3</td>
            <td>4</td>
            <td>5</td>
        </tr>
        <tr>
            <td>1</td>
            <td>2</td>
            <td>3</td>
            <td>4</td>
            <td>5</td>
        </tr>
    </tbody>
</table> 
```

我在想我的方法很简单，所以我需要一些想法。这最终将与来自 d​​atatables.net 的数据表一起使用，但首先我需要弄清楚这部分。

****编辑****

该`arry`变量当前取自其他东西的 rel 属性`arry[0]`是表 id..`arry[1]`在这种情况下是列的位置 0-4

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T21:17:07.270

我会用`<colgroup>`它来为列着色，因为它操作起来既快速又容易。

[http://www.w3schools.com/tags/tag_col.asp](http://www.w3schools.com/tags/tag_col.asp)

一个例子，你可以把：

```
<colgroup>
  <col style="background-color:FF0" />
  <col span="4" />
</colgroup> 
```

并使用 jquery 或其他方式编辑整个 colgroup。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T21:31:05.637

### *[演示 jsBin](http://jsbin.com/oremav/edit#javascript,html,live)*

```
var string= 'testerTable::2'; // your data // test with: 0,1,2,3,4
var arry= string.split('::'); // split to separate values

var $tr = $('#'+arry[0]+' tr');

$('#'+arry[0]+' th').eq(arry[1]).css({"background-color":"FF0"});

$tr.each(function(el){ // iterate through all 'tr' to find relative 'td' .eq()
  $(this).find('td').eq(arry[1]).css({"background-color":"FF0"});
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T21:24:01.907

您可以只为第 1 列中的每个元素指定类 'c1'，然后执行 $('.c1').css... 这将节省 th/tr/td 区别的麻烦。当然，你会为每一列都这样做。

顺便说一句，它的拼写是“数组”:)

# vbscript - 使用 VBS 从一个网页转到下一个低谷超链接

> ID：10323877
> 
> 赞同：0
> 
> 时间：2012-04-25T21:12:43.250
> 
> 标签：vbscript

我正在编写一个脚本来处理 600 多个超链接并从中获取信息，但这是我以前从未编写过 vbs 脚本的问题

所以我得到了我非常基本的“转到站点 X 脚本”，一旦我想在那个页面上点击一个超链接，问题我不能使用链接的字符串地址，因为稍后我想去站点 Y（相同网站，但我正在查找不同的单词） Y 将具有与 X 相同的超链接按钮，但它后面的字符串会有所不同

任何人都知道如何使脚本转到 X 的链接，然后转到 Y 的链接（所以不使用超链接的字符串

谢谢

```
>Option Explicit
>Dim objCHR
>Set objCHR = CreateObject("InternetExplorer.Application")
>objCHR.Navigate "http://www.yeastgenome.org/cgi-bin/locus.fpl?locus=YGR084C"
>objCHR.visible = true 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T10:53:28.613

如果您需要学习脚本语言，请学习 Ruby 或 Python。这是一个简单的 Ruby 脚本，显示页面上的所有链接，这个使用 nokogiri 作为库，您也可以使用 mechanize。

```
require 'nokogiri' 
require 'open-uri' 

doc = Nokogiri::HTML(open("http://www.yeastgenome.org/cgi-bin/locus.fpl?locus=YGR084C" ).read) 
hrefs = doc.css("a").map do |link| 
  if (href = link.attr("href")) && !href.empty? 
    URI::join(url, href) 
  end 
end.compact.uniq 
STDOUT.puts(hrefs.join("\n")) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T10:50:20.663

我想知道如果这是您的第一个程序，为什么要使用 vbscript，有些语言在做这些事情方面做得更好（例如 Ruby），并且有大量的库可以进行网络爬虫等。stackoverflow 上有很多例子。我在这里发布了一个 Ruby 示例作为另一个答案。

无法通过 XY 链接关注您，但这是加载页面内容的方法，您必须通过简单的 instr 和 mid 或使用正则表达式提取所需的信息。如果您让我们知道您到底想要实现什么，我可以进一步帮助您。

```
Set objCHR = CreateObject("InternetExplorer.Application") 
objCHR.Navigate "http://www.yeastgenome.org/cgi-bin/locus.fpl?locus=YGR084C" 
objCHR.visible = true 
Do while not objCHR.ReadyState = 4 'wait till the page is loaded
  Wscript.Sleep(100)
Loop
Wscript.Echo objCHR.Document.body.InnerHTML 'show entire contents as HTML 
```

# c# - 无法使用 runat="server" 动态呈现 html 控件

> ID：10323878
> 
> 赞同：1
> 
> 时间：2012-04-25T21:12:46.637
> 
> 标签：c#, asp.net, runatserver, htmlcontrols

这是我的一段代码，我通过它使用 runat="server" 呈现 html 控件

```
 var sb= new StringBuilder();
 sb.AppendLine(" <div class='ItemDiv'>");
 sb.AppendLine(" <h2>More Products </h2>");
 sb.AppendLine("  <span class='separator'></span> <ul class='ulProducts'>");
 foreach (var lead in list)
 {
    var name = lead.ProductName;
    if (name.Length > 17)
    {
       name = string.Format("{0}...", name.Substring(0, 17));
    }
    sb.AppendLine(string.Format("<li><img src='{0}' align='absmiddle' alt='{1}'/> 
                                    <span class='separator'> </span>
                                     <a href='~/Item/{2}/{1}.aspx' runat='server' // issue is with runat='server' 
                                      style='font-size:8pt; text-transform:                      
                                      capitalize;'>{1}</a></li>", 
                                lead.ProductImagePath, name,lead.Id));
 }
 sb.AppendLine("</ul> </div>");
 ProductsBySame1.GetHtml = sb.ToString(); // ProductsbySame is usercontrol and GetHtml is property of innerHtml of div placed in the usercontrol. That is dynamically populated. 
```

我的输出：

```
<div id="ctl00_cphMain_ProductsBySame1_ltlProducts"> <div class='ItemDiv'>

 <h2>More Products </h2>

 <span class='separator'></span> <ul class='ulProducts'>

<li><img src='Uploads/Images/8e4c426aa1464af0b45f43c8c773e8ae.jpg' align='absmiddle' alt='Ceftriaxone Injec...'/> <span class='separator'> </span><a href='~/Item/659/Ceftriaxone Injec....aspx' **runat='server'**  style='font-size:8pt; text-transform: capitalize;'>Ceftriaxone Injec...</a> </li>

<li><img src='Uploads/Images/9efa7b61cf9f467393089ca111fc5f51.jpg' align='absmiddle' alt='Clavulanate Potas...'/> <span class='separator'> </span><a href='~/Item/660/Clavulanate Potas....aspx' **runat='server'**  style='font-size:8pt; text-transform: capitalize;'>Clavulanate Potas...</a> </li>

</ul> </div>

</div> 
```

往上看。实际上我正在使用 UrlRewriting.Net 模块来重写 url。根据他们的文档，以 ~/ 开头的链接仅适用。所以我正在构建我的 url，因为 ~/ 仅适用于 runat='server'。

所以最后我的问题是我上面的 href 不起作用，因为 runat='server' 在渲染时没有解决。根据我的使用场景，请在渲染 html 时帮助我。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T21:19:10.103

当您`runat="server"`从设计器添加控件时，Visual Studio 会在`.designer.cs`文件中为其创建对象。因此，您的控件是在标记和代码隐藏中定义的。如果您正在动态构建站点，则`Page`元素上没有对象。

我建议您`Page`在`CreateChildControls`方法中添加控件。像这样的东西：

```
Page.Controls.Add(new Hyperlink() { Url="http://www.example.com" }); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T21:32:04.450

只需使用`Repeater`控件而不是从头开始构建 html：

```
<asp:Repeater ID="MyRepeater" runat="server">
    <HeaderTemplate>
        <div class="ItemDiv">
            <h2>More Products </h2>
            <span class='separator'></span>
            <ul class='ulProducts'>
    </HeaderTemplate>

    <ItemTemplate>
        <li>
            <img src="<%...%>" align="absmiddle" alt="<%...%>" /> 
            <span class='separator'> </span>
            <a href="<%...%>" runat="server" style="font-size:8pt; text-transform:capitalize;"><%...%></a>
        </li>
    </ItemTemplate>

    <FooterTemplate>
            </ul>
        </div>
    </FooterTemplate>
</asp:Repeater> 
```

（为绑定添加了虚拟占位符）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T21:25:30.277

runat="server" 仅用于告诉编译器在将 aspx 标记编译为类时要创建什么对象。您所做的是设置已编译控件的文本属性，因此不会发生额外的编译。

# .net - DateTime.Now 抛出异常

> ID：10323881
> 
> 赞同：10
> 
> 时间：2012-04-25T21:12:57.167
> 
> 标签：.net, exception, datetime

我在运行几个网站的服务器上的 DateTime.Now 上抛出异常。在过去的 3 天里，这在我身上发生了两次。真的很奇怪。我想知道最新的 Windows 更新是否已经开始发生这种情况，以及你们中是否有人看到类似的行为出现。

抛出的异常是：

```
BASE EXCEPTION:
  TYPE: System.ArgumentOutOfRangeException
  MESSAGE: Value to add was out of range.
Parameter name: value
  STACK TRACE:
   at System.DateTime.Add(Double value, Int32 scale)
   at System.TimeZoneInfo.TransitionTimeToDateTime(Int32 year, TransitionTime transitionTime)
   at System.TimeZoneInfo.GetDaylightTime(Int32 year, AdjustmentRule rule)
   at System.TimeZoneInfo.GetIsDaylightSavingsFromUtc(DateTime time, Int32 Year, TimeSpan utc, AdjustmentRule rule, Boolean& isAmbiguousLocalDst)
   at System.TimeZoneInfo.GetDateTimeNowUtcOffsetFromUtc(DateTime time, Boolean& isAmbiguousLocalDst)
   at System.DateTime.get_Now()
   at (my code).FrontEnd.FrontEndPage.Page_Load(Object sender, EventArgs e) in (my code file)\code\presentation\FrontEndPage.cs:line 118
   at (my code).purchase.Page_Load(Object sender, EventArgs e) in (my code file)\purchase.aspx.cs:line 94
   at System.Web.Util.CalliHelper.EventArgFunctionCaller(IntPtr fp, Object o, Object t, EventArgs e)
   at System.Web.Util.CalliEventHandlerDelegateProxy.Callback(Object sender, EventArgs e)
   at System.Web.UI.Control.OnLoad(EventArgs e)
   at System.Web.UI.Control.LoadRecursive()
   at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) 
```

发生这种情况的代码是 if 语句中的第一行：

```
HttpCookie loggedIn = Request.Cookies[Config.Instance.LoggedInCookieName];
if (loggedIn != null)
{
    loggedIn.Expires = DateTime.Now.AddHours(4);
    Response.Cookies.Add(loggedIn);
} 
```

虽然那里有一个 AddHours 并且异常是在谈论 DateTime.Add，但我认为它与 AddHours 没有任何关系，而是由对 Now 的调用引起的，正如您在堆栈跟踪中看到的那样。

我所在的服务器运行的是 Windows Server 2003，并且运行的是英语（英国）语言环境。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T15:12:19.383

查看 Reflector 中的代码，当`AddDays`在`TransitionTimeToDateTime`.

`AddDays`过程`transitionTime.DayOfWeek`where `transitionTime`is`rule.DaylightTransitionStart`或`rule.DaylightTransitionEnd`from的两次出现`GetDaylightTime`（以及`time.DayOfWeek`，但始终是`Mod 7`）。

这似乎意味着`GetTimeZoneInformation`偶尔会返回错误数据，其中`AdjustmentRule`生成的`GetOneYearLocalFromUtc`调用`GetCurrentOneYearLocal`。

因为它很少发生，我认为这不会是由于注册表损坏（我希望它每次都会发生。），但为了帮助进一步检查[TIME_ZONE_INFORMATION](http://msdn.microsoft.com/en-us/library/windows/desktop/ms725481%28v=vs.85%29.aspx)的 MSDN 文档，描述了要检查的注册表项。

[请注意，此信息不会被缓存，并且每次调用时都会被检索`DateTime.Now`，（这当然是正确的做法，因为 DST 可能刚刚更改，或者用户可能已经更改了当前时区）这是一些过早优化的好借口`DateTime.UtcNow`尽可能多地使用并`.ToLocalTime`仅在需要向用户显示时间时应用。]

# c++ - 编译器 C++ 中的 fstream 错误

> ID：10323882
> 
> 赞同：1
> 
> 时间：2012-04-25T21:12:59.757
> 
> 标签：c++, for-loop, compiler-errors, fstream

这是一个真正的新手问题，但我的编译器给了我错误：

```
std::fstream has no member named getc 
```

它是相对于这行代码：

```
char ch;

for ((ch=fpin.getc());!fpin.eof();(ch=fpin.getc())) 
```

fpin 是一个文件，我检查了是否打开等。没关系。我也不担心代码的质量，只是担心让它工作。我一直盯着它看太久了，我看不出问题所在。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T21:14:56.940

您尝试调用的方法是`std::fstream::get`. 你可以在`std::fstream` [这里](http://en.cppreference.com/w/cpp/io/basic_fstream)阅读。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-25T21:16:02.033

好吧，编译器是对的，`getc()`不是`ifstream`. 以下是您的选择：

[http://en.cppreference.com/w/cpp/io/basic_ifstream](http://en.cppreference.com/w/cpp/io/basic_ifstream)

通常

```
while(std::getline(myInStream, sstr)) 
{ 
    // ... 
} 
```

是你想要的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-25T21:19:13.690

djechlin 说了什么，但如果你确实想按字符获取，你可以这样做`ch = fpin.get()`，这将抓住一个字符。或者您可以`fpin >> ch;`获取单个字符但忽略空格。

# java - Parsing HTML table data with xpath and selenium in java

> ID：10323884
> 
> 赞同：1
> 
> 时间：2012-04-25T21:13:02.097
> 
> 标签：java, html, xpath, selenium, webdriver

I want to take the data and organize it without the tags. It looks something like this

```
<table class="SpecTable">
    <col width="40%" />
    <col width="60%" />
    <tr>
        <td class="LightRowHead">Optical Zoom:</td>
        <td class="LightRow">15x</td>
    </tr>
    <tr>
        <td class="DarkRowHead">Digital Zoom:</td>
        <td class="DarkRow">6x</td>
    </tr>
    <tr>
        <td class="LightRowHead">Battery Type:</td>
        <td class="LightRow">Alkaline</td>
    </tr>
    <tr>
        <td class="DarkRowHead">Resolution Megapixels:</td>
        <td class="DarkRow">14 MP</td>
    </tr>
</table> 
```

and I want to be able to extract all the strings of information so that I can store in a plaintext file with just this:

> Optical Zoom: 15x Digital Zoom: 6x Battery Type: Alkaline Resolution Megapixels: 14 MP

```
public static void main(String[] args) {

        FirefoxProfile profile = new FirefoxProfile();
        profile.setPreference("general.useragent.override", "some UA string");
        WebDriver driver = new FirefoxDriver(profile);

        String Url = "http://www.walmart.com/ip/Generic-14-MP-X400-BK/19863348";
        driver.get(Url);
        List<WebElement> resultsDiv = driver.findElements(By.xpath("//table[contains (@class,'SpecTable')//td"));

        System.out.println(resultsDiv.size());
        for (int i=0; i<resultsDiv.size(); i++) {
            System.out.println(i+1 + ". " + resultsDiv.get(i).getText());
        } 
```

I am programming in Java with Selenium and I cannot figure out the correct XPath expression for it.

Can someone figure out why I err on this and maybe give me some pointers on how I can parse this data correctly? Im very new to Selenium and XPaths but I need this for work.

Also if anyone has any good sources for me to learn Selenium and XPath fast, those would also be greatly appreciated!

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T21:43:47.997

[The spec](http://www.w3.org/TR/xpath/) is surprisingly a *very* good read on XPath.

You might also try [CSS selectors](http://www.w3.org/TR/CSS2/selector.html).

Anyway, one way to get the data from a table can be as following:

```
// gets all rows
List<WebElement> rows = driver.findElements(By.xpath("//table[@class='SpecTable']//tr"));
// for every line, store both columns
for (WebElement row : rows) {
    WebElement key = row.findElement(By.XPath("./td[1]"));
    doAnythingWithText(key.getText());
    WebElement val = row.findElement(By.XPath("./td[2]"));
    doAnythingWithText(val.getText());
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T21:37:19.250

Probably this will suite your needs:

```
string text = driver.findElement(By.cssSelector("table.SpecTable")).getText(); 
```

String `text` will contain all text nodes from the table with class SpecTable. I prefer using [css](http://www.w3.org/TR/selectors/), because it's supported by IE and faster than xpath. But as for xpath tutorials try [this](http://msdn.microsoft.com/en-us/library/ms256086.aspx) and [this](http://www.w3.org/TR/xpath/).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T23:28:45.200

As another option you could grab all the cells of the table into one array and access them that way. EG.

```
ReadOnlyCollection<IWebElement> Cells = driver.FindElements(By.XPath("//table[@class='SpecTable']//tr//td")); 
```

This will get you all the cells in that table as an array which you can then use to access the text iteratively.

```
string forOutput = Cells[i].Text; 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-17T01:03:54.030

CSharp method to extract any table in a 2 dimension array:

```
private string[,] getYourSpecTable(){
    return getArrayBy(By.CssSelector("table.SpecTable tr"), By.CssSelector("td"));
}

private string[,] getArrayBy(By rowsBy, By columnsBy){
    bool init=false;
    int nbRow=0, nbCol=0;
    string[,] ret = null;
    ReadOnlyCollection<OpenQA.Selenium.IWebElement> rows = this.webDriver.FindElements(rowsBy);
    nbRow = rows.Count;
    for(int r=0;r<nbRow;r++) {
        ReadOnlyCollection<OpenQA.Selenium.IWebElement> cols = rows[r].FindElements(columnsBy);
        if(!init) {
            init= true;
            nbCol = cols.Count;
            ret = new string[rows.Count, cols.Count];
        }                
        for(int c=0;c<nbCol;c++) {
            ret[r, c] = cols[c].Text;
        }
    }
    return ret;
} 
```

# django - django mod_wsgi 和 apache 404 的时髦重写规则

> ID：10323885
> 
> 赞同：0
> 
> 时间：2012-04-25T21:13:26.840
> 
> 标签：django, apache, mod-wsgi

我刚刚在使用 Apache 和 mod_wsgi 的生产环境中设置了我的 django。一切似乎都很好。我已授予对静态文件夹（用于管理资源）的访问权限，并且服务器正在按预期工作。

尝试通过 Django 查看与 URL 不匹配的网页时似乎有一件奇怪的事情。当达到这个明显的 404 时（我暂时打开了调试）。

这个问题源于我希望禁用静态文件夹中的目录列表。

我添加了 Options -Indexes 参数，它似乎有效。

唯一的问题是 apache 重写引擎似乎在找不到资源（或资源是文件夹）时将 404.shtml 附加到 URL。但是 append 并不是一个正确的词。相反，它将请求 URL 的最后 9 个字符替换为 404.shtml。然后我的 Django 404 调试屏幕出现，我的原始请求有一个无意义的版本。

这是一个例子：

请求网址：http: [//mobile.mywebsite.com/static/unknown_file](http://mobile.mywebsite.com/static/unknown_file)

Django 收到：

找不到页面 (404) 请求方法：GET 请求 URL：http: [//mobile.mywebsite.com/static/un/404.shtml](http://mobile.mywebsite.com/static/un/404.shtml)

但是，如果我请求 [http://mobile.mywebsite.com/static/404.shtml](http://mobile.mywebsite.com/static/404.shtml)

然后它被相同的文本覆盖，所以[http://mobile.mywebsite.com/static/404.shtml](http://mobile.mywebsite.com/static/404.shtml)出现了，显然没有改变。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T21:17:30.000

听起来您在 apache 配置中定义了自定义 http 文档，例如：

```
ErrorDocument 404 /un/404.shtml 
```

# objective-c - 如果它不知道它是孩子，如何从它里面取出一个孩子

> ID：10323886
> 
> 赞同：0
> 
> 时间：2012-04-25T21:13:27.973
> 
> 标签：objective-c, ios, cocos2d-iphone, removechild

我有一个很好的标题:)

我的主要课程是

```
@interface StartLayer : CCScene 
```

我用了

```
HelpView* hp = [[HelpView alloc]initWithFrame:CGRectMake(0, 0, 320, 520)];
CCUIViewWrapper* wrapper = [CCUIViewWrapper wrapperForUIView:hp];
[self addChild:wrapper]; 
```

添加类

```
@interface HelpView : UIView 
```

我还有两个将 HelpView 作为其超类的类

```
@interface GameOverMenu : HelpView <UITextFieldDelegate>

@interface PlayScene : HelpView 
```

在我的 GameOverMenu 或 PlayScene 中，作为 StartLayer 的子项，我需要删除 HelpView（我猜所有子视图也将被删除），我完全需要 HelpView 才能将 UIView 作为超类。有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T21:38:46.923

[self.parent removeFromParentAndCleanup:YES] 不工作？

# .net - 如何确定用户是否可以以管理员身份运行？

> ID：10323887
> 
> 赞同：3
> 
> 时间：2012-04-25T21:13:35.000
> 
> 标签：.net, windows-identity, windows-principal

当用户需要输入他们的许可证密钥时，如果可以，我们希望将其放入 HKLM，如果不能，我们希望将其放入 HKCU。如果它在 HKLM 中，则计算机上的所有用户都拥有许可证，而无需每个人都输入它。

我们是 Office 的附加组件，因此我们使用 Office 权限运行。通常这不是管理员权限（除非他们关闭了 UAC）。因此，无论用户可以做什么，WindowsPrincipal.IsInRole(Administrator) 都会返回 false。

如果用户有本地管理员权限，我们想启动一个具有 runas=admin 的小程序，然后他们可以在 HKLM 中设置它。但是，如果他们没有本地管理员权限，那么我们将其放入 HKCU。

那么...我如何确定用户是否可以执行 runas=admin？我们在 .net 3.5 上。

谢谢 - 戴夫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T22:09:26.913

我一般在我们写的一些客户端软件中使用的流程是这样的：

1.  尝试启动提升的进程以设置注册表项。
2.  等到进程完成或抛出异常。
3.  通过尝试读取预期的键来验证注册表键（非管理员可以这样做）
4.  如果未设置键，则运行回退方法（例如，写入 HKCU）

我有一个帮助函数来运行看起来像这样的提升代码（VB.Net）。由于我只是使用带有命令行标志的同一应用程序来运行提升的进程，因此您可以看到我正在使用当前程序集作为进程名称。您可以替换为您的特定过程。

```
Private Function RunElevated(commandLine As String, Optional ByVal timeout As Integer = 0) As Boolean
    Dim startInfo As New ProcessStartInfo
    startInfo.UseShellExecute = True
    startInfo.WorkingDirectory = Environment.CurrentDirectory
    Dim uri As New Uri(Assembly.GetEntryAssembly.GetName.CodeBase)
    startInfo.FileName = uri.LocalPath
    startInfo.Verb = "runas"
    startInfo.Arguments = commandLine

    Dim success As Boolean
    Try
        Dim p As Process = Process.Start(startInfo)
        ' wait thirty seconds for completion
        If timeout > 0 Then
            If Not p.WaitForExit(30000) Then
                ' did not complete in thirty seconds, so kill
                p.Kill()
                success = False
            Else
                success = True
            End If
        Else
            p.WaitForExit()
            success = True
        End If
    Catch ex As Win32Exception
        success = False
    Catch ex As Exception
        MsgBox("Error occurred while trying to start application as administrator: " & ex.Message)
        success = False
    End Try
    Return success
End Function 
```

在上面的代码中，我将异常作为失败代码处理，并且我将环境的执行时间限制为 30 秒。您可能不希望在您的情况下有时间限制，因此您可以删除该部分代码。

在管理员模式过程中，我首先使用此帮助函数仔细检查我实际上是管理员：

```
Public Function IsAdmin() As Boolean
    Dim id As WindowsIdentity = WindowsIdentity.GetCurrent
    Dim p As New WindowsPrincipal(id)
    Return p.IsInRole(WindowsBuiltInRole.Administrator)
End Function 
```

一旦我知道我是管理员，然后我继续设置注册表项并返回。调用程序然后验证密钥是否已成功设置，以确定是否需要运行回退过程。这是`RunElevated`返回给调用者的时间，因为那时子进程已经完成并且设置键成功或失败。该代码如下所示：

```
Public Function UpdateSettings(...) As Boolean
    Dim success As Boolean
    Try
        If Not IsAdmin() Then
            ' try to create the registry keys as administrator
            success = RunElevated(Command() & " /admin", 30000)
        Else
            ' if we're already admin, then just update directly
            success = UpdateSettingsAdmin(...)
        End If
        success = success And ValidateUpdateSettings(...)
    Catch ex As Exception
        success = False
    End Try
    Return success
End Function 
```

# javascript - javascript模块模式变量范围

> ID：10323895
> 
> 赞同：1
> 
> 时间：2012-04-25T21:13:54.267
> 
> 标签：javascript, scope, module-pattern

我正在学习 javascript 和模块模式，但我在代码中犯了一个错误，事实证明，我认为关于这种模式的一些概念是错误的。我的基本代码是这样的：

```
(function(window,$){

//global menu object
var menu = (function(){

    //menu tab component
    var tab = (function(){

        //public properties
        var tab = {
            init:doStuff
        }

        //private properties
        function doStuff(){
            alert("initialising Tab")
        }

        //return public properties
        return tab;
    })();

    //menu curtain component
    var curtain = (function(){

        //public properties
        var curtain = {
            init:doStuff
        }

        //private properties
        function doStuff(){
            alert("initialising Curtain")
        }

        //return public properties
        return curtain;
    })();

    //menu content component
    var content = (function(){

        //public properties
        var content = {
            init:doStuff
        }

        //private properties
        function doStuff(){
            alert("initialising Content")
        }

        //return public properties
        return content;
    })();

    //public properties
    var menu = {
        init:initialiseMenu
    }

    //private properties
    function initialiseMenu(){
        //initialise each component of the menu system
        tab.init();
        curtain.init();
        content.init();

    }

    //final menu object
    return menu;
})();

window.menu = menu;
})(window,jQuery); 
```

然后当我的页面加载并调用代码时：

```
menu.init(); 
```

它按顺序给出警报：

```
initialising tab
initialising curtain
initialising content 
```

正如我所料。但是，如果我将内容组件更改为这样：

```
 //menu content component
    var content = (function(){

        //public properties
        var content = {
            init:doStuff
        }

        //private properties
        function doStuff(){
            alert("initialising Content")
        }

        //CHECK ACCESS TO PREVIOUS VARIABLES
        curtain.init();

        //return public properties
        return content;
    })(); 
```

它按顺序发出警报：

```
initialising curtain
initialising tab
initialising curtain
initialising content 
```

所以我看到它能够访问窗帘变量，即使它没有作为参数传递到模块中。我认为每个模块都是自包含的，但我发现事实并非如此，是否有办法让一个模块也只能访问你想要的变量？特别是对我的例子会有帮助，谢谢丹。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T21:23:18.107

每个模块都不是自包含的，而是创建一个新范围，该范围是创建它的那个的超集。在 Javascript 中唯一定义新范围的是`function`语句。在新范围内，外部范围内的所有内容都是可见的，除非被同名变量覆盖。内部范围内的任何东西对它外部的东西都是不可见的。

```
var global;
function outer() {
    var outerVar;

    function inner() {
        var innerVar;

        // global, outerVar, and innerVar are visible

    }   
    function inner2() {
        var inner2var, outerVar;

        // global and inner2var are visible
        // outerVar hides the previous outerVar, which is no longer accessible

    }

    // global and outerVar (the first one) are visible

} 
```

您的函数是自动执行的这一事实并没有什么不同。在外部范围内创建的任何内容都将在您的内部范围内可见，除非您创建一个新的同名局部变量来取代它。

就您的内部范围而言，在其外部创建的任何内容都与全局相同。（全局只是在默认范围内创建的变量，即浏览器中的“窗口”）。

您可以将内部范围想象为单向玻璃后面。你仍然可以看到世界上的一切，但世界看不到你。而且您始终可以选择挡住单向玻璃，这样您就再也看不到外面了。但是什么都看不到。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T21:25:40.190

任何函数的当前作用域都可以看到它的包含作用域。因此，内容仍然可以访问菜单中的任何变量，包括窗帘。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T21:45:03.267

发生这种情况是因为当您在每个对象中调用“return”时，您正在为组件变量分配返回值，该值是每个组件中的内部“公共属性”对象。

```
var tab = (function(){

    //public properties
    var tab = {
        init:doStuff
    }

    //private properties
    function doStuff(){
        alert("initialising Tab")
    }

    //return public properties
    return tab;
})(); 
```

在这里，您将使用您正在执行的匿名函数的结果分配原始变量“选项卡”。本例中的对象是：

```
 var tab = {
        init:doStuff
    } 
```

因为您在函数执行结束时返回此对象。

要实现您所追求的，请尝试返回一个对象，该对象具有访问函数范围内的变量的“公共”修饰函数。在函数内创建的任何变量都只对该函数或在其范围内的函数具有作用域，从而使它们实际上是私有的（Javascript 是函数作用域的）。以下示例应该可以帮助您编写代码：

```
var tab = (function(){

    //public properties
    var PublicProperties = {
        init:doStuff,
        modifyPrivateVar: function(value){
            this.somePrivateVariable = value;
        }
    }

    //private variables/properties
    var doStuff = function(){
        alert("initialising Tab")
    }

    var somePrivateVariable = 'private!';

    //return public properties
    return PublicProperties;
})(); 
```

现在，您的变量 'tab' 将被赋予执行匿名函数返回给它的值（PublicProperties 对象）。您将可以访问函数“init”和“modifyPrivateVar”，但不能直接调用“doStuff”或更改“somePrivateVariable”。这表明您可以通过修饰函数更改变量，但不能直接访问它，从而使其有效地成为私有的。

如果你希望你的“init”函数作为构造函数被调用，你必须在组件的匿名函数执行过程中执行你的“构造函数”，或者直接编写代码，它将作为组件的匿名函数执行函数执行......否则，如果它是私有的，则不应返回与 init 函数相关的任何内容，只返回可用于以安全方式修改/激活对象的函数。

# jquery - 使用 Jquery 将用户操作记录到数组中

> ID：10323899
> 
> 赞同：0
> 
> 时间：2012-04-25T21:14:11.697
> 
> 标签：jquery, arrays

我正在尝试在 jquery 中制作一个简单的用户点击动作记录器，但遇到了一些麻烦。我希望用户单击记录按钮，然后单击记录他单击的内容。然后按停止按钮停止录制。到目前为止，我所拥有的是：

```
var stack = new Array();
var recordmode = false;

$('#record').click(function(){
recordmode = true;
alert('You are now in record mode');
});

$('#stop').click(function(){
recordmode = false;
console.log(stack);//output what's in the array
stack = []; //erase the array
});

$('#note_markers').click(function(){
if(recordmode){
$('.one_0').click( function(){ stack.push('one_0'); })
$('.one_1').click( function(){ stack.push('one_1') ; })
}
}); 
```

以及后来的开始和停止按钮。

```
<a id='record'>R</a>
<a id='stop'>stop</a>
                           <div id="one_notes">
                                <a class="one_0"></a>
                                <a class="one_1"></a>
                                <a class="one_2"></a>
                                <a class="one_3"></a>
</div> 
```

同样在停止和擦除阵列之前..我想以 /one_0/one_1/one_0 等形式构建一个 URL，其中记录了阵列中的内容。（虽然还没有到那部分）

发生的情况是没有记录第一次点击，然后它开始放入两个相同的元素。我不知道为什么我会得到当前的行为。

有任何想法吗？

作为旁注，有没有办法获得任何点击元素的名称？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T21:17:51.117

您可能想尝试为要跟踪的每个操作分离点击处理程序。

```
$('.one_0').click( function(){ 
    if(recordmode){
      stack.push('one_0'); 
    }
});

$('.one_1').click( function(){ 
    if(recordmode){
      stack.push('one_1'); 
    }
}); 
```

这看起来像很多重复的代码......让我们试着清理一下。为什么不更进一步，给你所有的“可记录”动作赋予一个`rel`可能具有独特属性的同一个类......

[使用更新的 1.7+ jQuery 语法。]

```
<a class="recordable" rel="one_1"></a>
<a class="recordable" rel="one_2"></a>

$('.recordable').on('click', function(){ 
    if(recordmode){
      stack.push($(this).attr('rel'); 
    }
}); 
```

至于从生成的操作数组构建 URL，您可以使用 JavaScript`join()`函数。

```
var targetURL = _base_url + stack.join('/'); 
```

* * *

[您可以使用上面评论](https://stackoverflow.com/questions/10323899/recording-user-action-to-an-array-with-jquery#comment13292157_10323899)中提到的方法捕获对任何元素的点击...但是我建议您准确标记要捕获的操作，而无需捕获所有内容...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T21:35:07.197

你的问题是当它冒泡时你得到点击`#note_markers`和点击。`.one_1`

尝试这个：

```
$('#note_markers a').click(function(){
    if(recordmode)
        stack.push($(this).attr('class'));
}); 
```

您可以更改事件侦听器以侦听您实际需要的任何内容，但这将根据提供的 html 执行您想要的操作

# php - Symfony 2 中的 REST 控制器：如何处理字段名称？

> ID：10323900
> 
> 赞同：1
> 
> 时间：2012-04-25T21:14:12.137
> 
> 标签：php, symfony

我刚刚在 Symfony2 上使用 SensioGeneratorBundle 生成了一些实体和一个 CRUD，我正在将生成的 CRUD 转换为 REST API。我在使用字段名称时遇到问题...我想要自定义字段名称，而 Symfony 的 bindRequest 需要“acme_demobundle_tabletype_field”才能正常工作和验证，我只想拥有“字段”。

如何使用自定义字段名称进行 POST 并让控制器理解并绑定正确的值？例如：

邮政

一根香蕉

b：巧克力

Symfony 地图：

a => 标题

b => 内容

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-26T03:36:57.143

你的问题有两个部分。首先是字段名称前面的前缀和字段名称本身。

要摆脱前缀，请使用@m2mdas 描述的技巧，如果您在`2.1`. 如果您不在`2.1`，最好的办法是使用创建表单`createNamed`并在创建表单时提供一个空名称。像这样的东西：

```
$this->formFactory->createNamed(new CustomType(), '', $data, $optionsArray); 
```

从未测试过此表单，`2.0.x`但可以确认`2.1`使用空名称删除字段的前缀。

`formFactory`服务的实例在哪里`FormFactory`( `@form.factory`)。

对于字段，您可以使用自定义名称并告诉 Symfony 它应该在哪里映射属性。为此，您使用该`property_path`选项。这将指示 symfony 将属性映射到这个路径而不是默认路径。在这里定义它时应该如何在表单类型中使用它：

```
public function buildForm(FormBuilder $builder, array $options)
{
    $builder->add('a', 'text', array(
        'property_path' => 'title',
    ));

    $builder->add('b', 'text', array(
        'property_path' => 'content',
    ));
} 
```

使用这个，当 Symfony`a`从 POST 数据中接收到字段时，它会将其映射到属性`title`，反之亦然。您的对象将需要一个`setTitle`方法和一个`setContent`方法。

希望这可以帮助。

问候，
马特

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T22:00:54.187

我查看了github。根据[此](https://github.com/symfony/symfony/commit/7e7244ea53eb818716e98e753e1a33c6d372243d)PR，您可以设置空的父名称。`getName`因此，在您的表单类型类中，只需在方法中返回空字符串。

# php - SimplePie 缓存功能（可能扩展它）

> ID：10323902
> 
> 赞同：3
> 
> 时间：2012-04-25T21:14:22.410
> 
> 标签：php, mysql, simplepie

我有一个个人项目，可以在我的 NAS 驱动器上本地缓存一些 rss 提要（使用它的内置 Web 服务器和一个 chron 作业），这样当我的台式机关闭时，我就不会错过“帖子”。

到目前为止，我已经设置了一个简单的 php 脚本，它将单个提要的缓存存储在 MySQL 数据库中。我将扩展它以包含多个提要并循环遍历它们，但现在我只想确保我想做的事情是可能的。当 SimplePie 过期时清除缓存时，我正在考虑创建“cache_data”和“items”表的副本以像存档一样使用 - 如果我将所有新记录复制到新表中，那么 SimplePie 是否无关紧要清除它自己的缓存表，因为我已经有了这些项目的副本。

我现在需要做的是创建输出 rss/xml 文件，我想知道 SimplePie 是否可以用于此。我看到了两种可能性；

1.  让 SimplePie 使用“存档”表，因为它是缓存位置，禁用过期功能，因此不会删除任何内容。
2.  自己从“arcive”表中读取数据，并使用 SimplePie 处理数据并构建 rss 提要。

我已经查看了 SimplePie 文档并通过 SimplePie.inc 来查看是否可以找到任何可以为我指明正确方向的东西，但这是我的第一个真正的 php 项目，SimplePie 包含很多看起来很复杂的代码。任何建议或指示将不胜感激:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T06:07:56.547

创建您自己的 SimplePie_Cache 类，使用从缓存表、memcached、文件系统或任何地方获取和设置的代码填充方法。您唯一需要知道的是使用*$this->name*作为每个函数的缓存键的名称。

```
class MySimplePie_Cache extends SimplePie_Cache {
/**
 * Create a new cache object
 *
 * @param string $location Location string (from SimplePie::$cache_location)
 * @param string $name Unique ID for the cache
 * @param string $type Either TYPE_FEED for SimplePie data, or TYPE_IMAGE for image data
 */
  function __construct($location, $name, $extension) {
    $this->name = $name;
  }

  static function create($location, $filename, $extension) {
    return new MySimplePie_Cache($location, $filename, $extension);
  }

  function save($data) {
     // TODO: save $data to $this->name cache entry
     return true;
  }

  function load() {
     // TODO: load $data from $this->name cache entry
     return $data;
  }

  function mtime() {
    return time(); // this will disable any expiration checks
  }

  function touch() {
    return true; // not necessary, we don't need to update times, no expiration
  }

  function unlink() {
    return true;  // nothing will be removed from the cache
  }
} 
```

然后，将缓存类注册到您的提要：

```
$feed = new SimplePie();
$feed->set_cache_class("MySimplePie_Cache"); 
```

# php - 更新了 VPS。增加内存？

> ID：10323909
> 
> 赞同：-1
> 
> 时间：2012-04-25T21:14:38.780
> 
> 标签：php, debian

我刚刚更新了我的 VPS 服务器，增加了 CPU，内存从 1GB 增加到 16GB。但是，我看不到性能有任何改进。查询仍然运行缓慢。我是否需要更新一些文件以利用新的性能？

它是一个 Linux、debian 服务器，带有 apace2 和 phpmyadmin。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T21:38:50.197

通常更多的 RAM 会使 MySQL 服务器更快。检查 MySQL 服务器配置，Oracle 也提供支持。打电话给他们，他们通常很有帮助。

# python - wxpython演示代码错误

> ID：10323913
> 
> 赞同：1
> 
> 时间：2012-04-25T21:14:53.253
> 
> 标签：python, user-interface, widget, wxpython

请原谅我问了这么一个业余的问题，但我刚刚开始使用 wxPython。当我尝试将 GridLabelRenderer.py 的演示代码复制并粘贴到新的 python 文件中时，我总是收到一条错误消息：

```
IDlE Subprocess: no IP port passed in sys. argv. 
```

我相信该消息与我的文件不再保存在 demos 文件夹中的方式有​​关，并且错误是在谈论这段代码，我也相信：

```
if __name__ == '__main__':
    import sys, os
    import run
    run.main(['', os.path.basename(sys.argv[0])] + sys.argv[1:]) 
```

每当我将演示代码复制并粘贴到新位置的新文件中以使其完美运行时，我必须做些什么吗？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T13:21:56.030

我在 wxPython wiki 上写了一些关于此的内容：[http ://wiki.wxpython.org/Using%20wxPython%20Demo%20Code](http://wiki.wxpython.org/Using%20wxPython%20Demo%20Code)

这也可能对您将来有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T22:32:35.103

wxPython 演示的代码在演示框架内运行。为了使用代码，最好的方法是获取类并在您的应用程序框架中实例化它们。

GridLabelRenderer.py 最简单的方法可能是：

```
imports....
classes...

class TestPanel(wx.Panel):
    ...................

if __name__ == '__main__':
    app = wx.PySimpleApp()
    class MyFrame(wx.Frame):
        def __init__(self, *args, **kargs):
            wx.Frame.__init__(self, *args, **kargs)
            self.p = TestPanel(self, None)

    MyFrame(None).Show()
    app.MainLoop() 
```

不要忘记将 images.py 从演示目录复制到您的目录或 pythonpath 中的目录，以便通过 MyCornerLabelRenderer 类导入 images.py

# web-services - 将其他文件系统集成到谷歌驱动器中？

> ID：10323917
> 
> 赞同：2
> 
> 时间：2012-04-25T21:15:04.500
> 
> 标签：web-services, filesystems, google-drive-api

现在 Google Drive 已经推出，我想知道是否可以将其他文件系统直接集成到其中。我想到了用于 Google Drive 的 FUSE 或 DOKAN 之类的东西。虽然 Google Drive 将是根文件系统，但其他文件系统可以以文件夹的形式集成。

例如，可以将 DropBox 安装到 Google Drive 中，然后直接通过任何 Google Drive 客户端访问他的 DropBox 文件。

明白了吗？

这也将允许人们使用他们自己的服务器的存储并将其添加到 Google Drive。这将使其更加私密和安全，同时他们可以从 Google Drive 提供的所有优势中受益。

您知道是否可以通过 Google Drive API 创建类似的东西？如果没有，将来添加此类功能的可能性有多大？

Google Drive 或任何其他首先实现此功能的网络存储服务都可能成为网络文件系统。所有的 web 服务只需要支持一个这样的服务，而对所有其他文件系统的支持是通过这样的文件系统扩展来实现的。

这将是网络的未来。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T21:46:11.967

理论上绝对有可能编写一个工具，使 Drive 文件夹与另一个存储系统保持同步。

Google 提供的当前 Google Drive 同步客户端属于此类：

```
Google Drive root folder <-> local file folder 
```

同样，任何人都可以为以下任意组合编写同步工具：

*   Google 云端硬盘文件夹
*   投递箱
*   保险丝
*   ...

我现在只需使用[Google Document List API](https://developers.google.com/google-apps/documents-list/)来执行此操作。它有一个非常好的[更改提要](https://developers.google.com/google-apps/documents-list/#detecting_changes_to_resources)，可用于轮询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T12:31:00.660

我正在阅读您对答案的一些评论以及您的原始帖子。我不确定我们是否就“文件系统”是什么在同一页面上。（我不确定我肯定知道它是什么，但我会尝试列出一些东西，其他人可以纠正我。）

一个文件系统可能有：

1.  一些二进制数据、文件、目录结构等。
2.  一些元数据，例如上面 1\. 的索引
3.  此外，我们可能希望在更广泛的定义中包括：一些计算逻辑（规范（规范）和实现规范的“驱动程序”）告诉计算机规则是什么，用于读取/写入数据到 1\. 和 2。 .

如果我们把 Gdrive 看成一个文件系统，那么驱动规范就是 Google 的 List API 文档，任何实现该文档的应用程序本质上都是一个“Gdrive 驱动”；同样，如果我们将 Dropbox 视为文件系统，那么驱动规范就是 Dropbox API 文档，任何实现该文档的应用程序都是“Dropbox 驱动程序”。

现在我要问，你打算在哪里实施你的驱动程序？你和我当然不能在 Gdrive 服务器集群上实现 Dropbox 驱动程序——我认为 Google 不会让我们这样做（尽管他们可能有一天会这样做）。因此，看到您的 Dropbox 文件夹作为文件夹安装在“云端”的 Gdrive 中，这是您在标准[https://drive.google.com](https://drive.google.com)用户界面中查看的内容，不会很快发生。（也没有看到你的 Gdrive 安装在后者网站上的“云端”Dropbox 文件夹中。）

*但是*，您当然可以在您的个人计算客户端设备（台式机/笔记本电脑/手机/平板电脑等）上实现 Dropbox 和 Gdrive 驱动程序。因此，您的客户可以同时访问 Dropbox 和 Gdrive 的“云”存储，并将其中的数据同步到**客户磁盘驱动器上**的同一个文件夹。（我几乎可以肯定他们已经发出建议，这样做会导致“未定义”的行为，但你可以试一试。）

# php - 有没有办法让 PHP 在语义上呈现 HTML？

> ID：10323919
> 
> 赞同：0
> 
> 时间：2012-04-25T21:15:18.227
> 
> 标签：php, browser, render, semantics

有没有办法让 PHP 在语义上呈现 HTML？每当我在“查看源代码”中预览我的脚本时，HTML 呈现就像在一行中压缩在一起并且难以阅读。只是想知道是否有这样的方法，或者只是我如何输入我的 PHP

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T21:34:14.740

没有语义，也没有渲染 PHP 需要特别注意 HTML 输出。

就您关心的换行符和空格而言，在 HTML 中称为空白，它没有任何语义。

所以看起来一切都已经很好了。如果您在浏览自己的源代码时遇到问题，请使用浏览器的“检查元素”功能。或者在提供帮助的查看器/编辑器中打开源代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T22:03:17.167

这实际上是[先前问题](https://stackoverflow.com/questions/6716683/php-html-formatter-beautifier)的重复，但是那里的答案比您在 Google 中输入“html beautifier”还要糟糕。

[HTML tidy](http://tidy.sourceforge.net/docs/tidy_man.html)已经存在了很长时间并且相对完善。但是，如果您的代码产生丑陋的输出，那么也许您应该修复您的代码？

# c++ - 写入 PGM 文件

> ID：10323921
> 
> 赞同：1
> 
> 时间：2012-04-25T21:15:36.897
> 
> 标签：c++, pgm

我正在尝试使用此代码编写一个 pgm 文件..

```
myfile << "P5" << endl;
 myfile << sizeColumn << " " << sizeRow << endl;
 myfile << Q << endl;
 myfile.write( reinterpret_cast<char *>(image), (sizeRow*sizeColumn)*sizeof(unsigned char)); 
```

如果我尝试将其写入 .txt 文件，则它已写入 char 表示形式。

如何将我的值写入 pgm 文件以便它们正确显示？有没有人有任何链接，因为我在上面找不到太多！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T23:30:49.613

您可能不想使用[std::endl](http://www.cplusplus.com/reference/iostream/manipulators/endl/)，因为它会刷新输出流。

此外，如果您希望与 Windows（以及可能来自 Microsoft 的任何其他操作系统）兼容，则必须以二进制模式打开文件。微软默认以文本模式打开文件，这通常有一个没人想要的不兼容特性（ancient-DOS-backward-compatibility）：它将每个“\n”替换为“\r\n”。

PGM 文件格式标头为：

```
"P5"                           + at least one whitespace (\n, \r, \t, space)
width (ascii decimal)          + at least one whitespace (\n, \r, \t, space) 
height (ascii decimal)         + at least one whitespace (\n, \r, \t, space) 
max gray value (ascii decimal) + EXACTLY ONE whitespace (\n, \r, \t, space) 
```

这是将 pgm 输出到文件的示例：

```
#include <fstream>
const unsigned char* bitmap[MAXHEIGHT] = …;// pointers to each pixel row
{
    std::ofstream f("test.pgm",std::ios_base::out
                              |std::ios_base::binary
                              |std::ios_base::trunc
                   );

    int maxColorValue = 255;
    f << "P5\n" << width << " " << height << "\n" << maxColorValue << "\n";
    // std::endl == "\n" + std::flush
    // we do not want std::flush here.

    for(int i=0;i<height;++i)
        f.write( reinterpret_cast<const char*>(bitmap[i]), width );

    if(wannaFlush)
        f << std::flush;
} // block scope closes file, which flushes anyway. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T21:27:05.893

`ios::binary`确保使用标志以二进制模式打开文件。如果您使用的是 Windows ，则可能需要将`endl`s替换为。`"\r\n"`

# html - 文件布局和资产链接？

> ID：10323924
> 
> 赞同：0
> 
> 时间：2012-04-25T21:15:45.443
> 
> 标签：html, css

这是我的站点文件夹结构：

```
index.html
assets>img>all my images are here
css>my css files here 
```

在我的索引文件中，我引用了图像“assets/img/myimage.jpg”

在 CSS 中，我尝试对 backgroundi mages 做同样的事情，但它不起作用，有人知道链接应该是什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T21:25:24.847

在您的 css 中，它应该是`../assets/img/myimage.jpg/`“`../`从 css 文件夹中查找资产文件夹”的意思。而在您的情况下，css文件是在css文件夹内的assets目录中搜索的）希望这很清楚;）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T21:25:25.540

它应该是

```
../assets/img/all/myimage.jpg 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T21:25:47.287

您必须升级文件夹级别，因为您的 css 文件不在根目录中。您必须在文件路径之前添加 ../ 才能导航回根目录，就像这样。

```
../assets/img/myimage.jpg 
```

如果您的 css 文件位于根目录中，则无需执行此操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-25T21:26:09.073

您需要**先退出**您的 css 文件夹，然后进入您的 img 文件夹

要退出，请使用此逻辑“../”

因此，在您的 html 页面上，您可以通过以下方式链接到图像：

```
<img src='img/myimage.jpg'> 
```

但是在你的css文件中你需要这样做：

```
.class{
  background: url('../img/myimage.jpg');
} 
```

# android - 适用于 Android 的 Google Analytics + EasyTracker 有时会发送错误的 URL

> ID：10323927
> 
> 赞同：1
> 
> 时间：2012-04-25T21:15:59.593
> 
> 标签：android, google-analytics

我正在使用 EasyTracker 来跟踪活动。

我在应用程序中有一个点几乎同时启动了 2 个活动（TabActivity 和第一个选项卡中的活动）。两者都必须被跟踪。

这有效 - 几乎。我激活了 Google Analytics 的调试模式，有时我在控制台中看到它发送 2 个具有相同活动名称（托管的）的 GET 请求，而不是 TabActivity 发送 1 个，托管活动发送 1 个。

我下载了 EasyTracker 的源代码以便逐步完成它。我在最后一行添加了一个输出，该输出在调用 Google Analytics 代码（没有源代码）之前执行：

GoogleAnalyticsTrackerDelegateImpl.java

```
@Override
public void trackPageView(String pageUrl) {
    Log.d("TEST", "TRACKING:" + pageUrl);
    tracker.trackPageView(pageUrl);
} 
```

在这里，我看到它正确输出了名称 - 一旦我的 TabActivity 和托管活动。但稍后，当谷歌分析发送：

```
04-25 23:50:05.287: V/GoogleAnalyticsTracker(1194): Called dispatch
04-25 23:50:05.297: V/GoogleAnalyticsTracker(1194): Scheduled next dispatch
04-25 23:50:05.297: V/GoogleAnalyticsTracker(1194): Sending 2 hits to dispatcher
04-25 23:50:05.297: V/GoogleAnalyticsTracker(1194): dispatching hits in dry run mode 
```

我看到 2 个具有相同活动名称（托管的）的 GET 请求（我没有发布）。GET中这个参数的key是utmp。

澄清 - 托管活动是指出现在 TabActivity 的第一个选项卡中的活动。不确定它的“正确”名称。

那么这可能是什么原因呢？也许是因为这些活动几乎同时启动而出了问题？也许谷歌分析没有预料到这一点，因为这不是通常的工作流程......或者不知道。

我也不知道如何进一步调试。我看不到谷歌分析，我能得到的最后一个输出是正确的。

有任何想法吗？。

# php - 需要想法：在表格中选择行

> ID：10323931
> 
> 赞同：4
> 
> 时间：2012-04-25T21:16:11.820
> 
> 标签：php, jquery, mysql

我正在为客户开发一个网站。它需要一种特殊的方式来创建计算。在表中，我必须创建具有相同“% End”的行组。

![桌子](../Images/5eb352720077c1bae9e8623a2f81c8fc.png)

由于在开始时（日期为 2011 年 11 月 24 日）只有一行 90%，因此您只需忽略它。例如，我必须选择带有日期的行

2011 年 11 月 26 日 2011 年 11 月 28 日 2011 年 11 月 29 日

然后进行计算，稍后选择日期

2011 年 12 月 4 日 2011 年 12 月 5 日 2011 年 12 月 6 日

日期为 2011 年 12 月 07 日和 2011 年 12 月 9 日的行也会被忽略，因为在它们之前或之后没有相同百分比的行。

等等。

我很不知道该怎么做。如何创建日期组来计算它们？有没有简单有效的方法来做到这一点？

我的“资源”是 PHP、jQuery 和 MySQL

任何帮助表示赞赏，从星期一开始我就一直坚持下去。

编辑：表的信息由存储过程获取 EDIT2：表必须以 90% 的最终 percert 开始和结束

开始 90%....任何值...90% 结束

edit3：这是我的存储过程（也许它可以帮助更好地理解[http://pastebin.com/cZM1j72u](http://pastebin.com/cZM1j72u)）

为了解决我的问题，我可以使用 php、Javascript( jQuery ) 或 mysql

这个想法是从 2011 年 12 月 17 日开始获取口袋妖怪的值并从 2012 年 12 月 14 日减去。

该值将与 12 月 14 日的“加隆”值相除。<---这就是我要找的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T21:25:23.677

你需要什么样的计算？我认为这是 MySQL 的基础。例如：

```
SELECT percent_end, SUM(cakes) as sumcakes
FROM table
GROUP BY percent_end 
```

这只是`SUM`每个 %_END 的蛋糕。使用`GROUP BY`.

如果您不需要只有一条记录的 %_END：

```
SELECT percent_end, SUM(cakes) as sum_cakes, COUNT(date) as date_amount
FROM table
GROUP BY percent_end
HAVING date_amount > 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T21:52:07.850

详细说明上面的 Tosins 答案，您可以通过遵循与此类似的过程来避免计算单个日期条目：

```
SELECT percent_end, SUM(cakes) as sum_cakes, COUNT(DISTINCT(date)) as date_amount
FROM table
WHERE date_amount > 1
GROUP BY percent_end 
```

在这种情况下，除非有 2 个或更多不同的日期范围，否则不会返回记录。但是，如果您需要更复杂的日期比较函数，SQL 确实会开始看起来相当复杂。如果您需要检查 - 例如 - 如果某个日期在相同百分比的记录之前或之后是“x”天之前或“x”天之后，那将是一场全新的球赛。对于更复杂的计算，我个人会求助于使用 PHP 数组并执行各种排序和省略功能。许多人可能不同意我的观点，但我发现有时您会花费数天时间尝试编写一些看起来像是来自火星的繁琐 SQL 查询。

*** 编辑 ***我刚刚意识到我上面的例子有一个可怕的错误！当然它不起作用，我在 where 子句中使用了 date_amount，而 date_amount 是一个 AS 字段，换句话说不是实际的列名。因为 SQL 是从内向外计算的，所以 WHERE 子句发生在 AS 子句之前，因此会抛出错误并告诉您 date_amount 不存在。对于那个很抱歉。我将它留在纯粹以防它对某人有帮助。

但是，可以更改 SQL 并使用 HAVING 子句来获得相同的预期效果：

```
SELECT percent_end, SUM(cakes) as sum_cakes, COUNT(DISTINCT(date)) as date_amount
FROM table
GROUP BY percent_end
HAVING date_amount > 1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T21:25:13.560

就像是：

```
for(i=0; i<data.length-1; i++) {
  arr = []
  while(data[i].end_value == data[i+1].end_value) {
    arr.append(data[i].end_value)
    i++;
  }
  arr.append(data[i+1].end_value)
  if(arr.length > 1)
    // Then you've found a group and do the calculation with the values in the array
} 
```

为您需要的任何工作调整语法；您可能想要在服务器端执行此操作。

# iphone - 使用 Facebook iOS SDK 检索生日

> ID：10323932
> 
> 赞同：1
> 
> 时间：2012-04-25T21:16:13.913
> 
> 标签：iphone, ios, xcode, facebook-graph-api

我是使用 API 的新手，所以我不确定如何正确执行它。

我正在尝试获取用户朋友的所有生日。到目前为止，我成功地获得了他们的朋友列表，然后理论上我可以简单地 ping 每个 ID 并从中获取生日。

但是我不确定如何实现这些方法。

当我的 viewController 加载时：`[facebook requestWithGraphPath:@"me/friends" andDelegate:self];`

这发送了请求，我实现了 FBRequestDelegate 方法来接收它：

```
-(void)request:(FBRequest *)request didLoad:(id)result{
    NSLog(@"result is : %@", result);
} 
```

到目前为止工作得很好，我得到了一个包含所有朋友姓名和 ID 的对象。但是，现在我想遍历每个 ID，然后再发送几百个请求。我已经知道如何设置循环和请求调用，但是我已经在这个 viewController 中使用了 didLoad 方法，而且我显然需要在数据对象返回后以不同的方式处理数据。

与（FBRequest *）有关吗？那是什么，也许我可以使用 if(request == something) 之类的东西？谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-26T00:27:57.923

您可以通过单个 fql 请求检索您（或用户）的 Facebook 朋友的生日。

您可以在此处阅读有关 fql 的信息：http: [//developers.facebook.com/docs/reference/fql/](http://developers.facebook.com/docs/reference/fql/)

但这里有一些代码供参考（此代码在定义为 FBSessionDelegate 和 FBRequestDelegate 的类中）

```
- (void)request:(FBRequest *)request didLoad:(id)result {
    // result is a NSDictionary of your friends and their birthdays!
}

- (void)fbDidLogin {
    //some best practice boiler plate code for storing important stuff from fb
    NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
    [defaults setObject:[facebook accessToken] forKey:@"FBAccessTokenKey"];
    [defaults setObject:[facebook expirationDate] forKey:@"FBExpirationDateKey"];
    [defaults synchronize];

    //now load all my friend's birthdays
    NSMutableDictionary * params = 
                         [NSMutableDictionary dictionaryWithObjectsAndKeys:
                         @"select birthday, name, uid, pic_square from user where uid in (select uid2 from friend where uid1=me()) order by name", 
                         @"query",
                         nil];

    [self.facebook requestWithMethodName: @"fql.query" andParams: params andHttpMethod: @"POST" andDelegate: self];
}

- (void) loginWithFacebook {
    self.facebook = [[[Facebook alloc] initWithAppId:@"<your app id here>" andDelegate:self] autorelease];
    //IMPORTANT - you need to ask for permission for friend's birthdays
    [facebook authorize:[NSArray arrayWithObject:@"friends_birthday"]];
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T19:31:27.180

您应该使用此代码（我将其与 Hackbook 代码示例一起使用，并且效果很好）：

在 APICallsViewController.m 添加这些函数：

```
/*
/* Graph API: Method to get the user's friends.
*/
- (void)apiGraphFriendsWithBirthdays {
      [self showActivityIndicator];
      HackbookAppDelegate *delegate = (HackbookAppDelegate *)[[UIApplication sharedApplication] delegate];
      NSMutableDictionary * params = [NSMutableDictionary dictionaryWithObjectsAndKeys:
      @"picture,id,name,link,birthday,gender,last_name,first_name",@"fields",
 nil];

      [[delegate facebook] requestWithGraphPath:@"me/friends" andParams:params andHttpMethod:@"GET" andDelegate:self]; 
```

}

以上将获取大量数据，您只能使用 id、name 和生日...

```
/*
* Helper method to first get the user's friends and birthdays then
* do something with it.
*/
- (void)getFriendsForSetBirthday {
     // Call the friends Birthday API first
     currentAPICall = kAPIFriendsForSetBirthday;
     [self apiGraphFriendsWithBirthdays];
} 
```

将此添加到案例部分的“- (void)request:(FBRequest *)request didLoad:(id)result”中：

```
 case kAPIFriendsForSetBirthday:
    {
        NSMutableArray *friends = [[NSMutableArray alloc] initWithCapacity:1];
        NSArray *resultData = [result objectForKey:@"data"];
        if ([resultData count] > 0) {
            for (NSUInteger i=0; i<[resultData count] && i < 25; i++) {
                [friends addObject:[resultData objectAtIndex:i]];

                NSDictionary *friend = [resultData objectAtIndex:i];
                long long fbid = [[friend objectForKey:@"id"]longLongValue];
                NSString *name = [friend objectForKey:@"name"];
                NSString *birthday = [friend objectForKey:@"birthday"];
                NSLog(@"id: %lld - Name: %@ - Birthday: %@", fbid, name,birthday);

            }

        } else {
            [self showMessage:@"You have no friends."];
        }
        [friends release];
        break;

    } 
```

您需要请求生日读数的权限（我在喜欢权限部分做了，但您可以在任何地方进行，请注意，您必须先请求它才能工作）：

```
- (void)apiPromptExtendedPermissions {
   currentAPICall = kDialogPermissionsExtended;
   HackbookAppDelegate *delegate = (HackbookAppDelegate *)[[UIApplication sharedApplication] delegate];
   NSArray *extendedPermissions = [[NSArray alloc] initWithObjects:@"user_likes",@"friends_birthday", nil];
   [[delegate facebook] authorize:extendedPermissions];
   [extendedPermissions release];
 } 
```

在 .h 文件中不要忘记为 apicall 添加 kAPIFriendsForSetBirthday。

在 Dataset.m 添加：

```
NSDictionary *graphMenu7 = [[NSDictionary alloc] initWithObjectsAndKeys:
                                @"Get friends birthday", @"title",
                                @"You can get all friends birthdays.", @"description",
                                @"Get friends birthday", @"button",
                                @"getFriendsForSetBirthday", @"method",
                                nil]; 
```

并将graphMenu7添加到该文件的菜单中，不要忘记释放它。

我已经对其进行了测试，并且效果很好，希望对您有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T23:05:15.650

您可以将一个子类`NSObject`化，将其称为“BirthdayLoader”并在那里实现请求。现在，在您的控制器中，只需创建这些加载器对象的实例来检索生日。这些可以在成功检索生日时使用委托方法进行报告。

```
@protocol BirthDayLoaderDelegate 
-(void)didFinishLoadingRequest:(FBRequest *)request withResult:(id)result;
@end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-11-28T07:05:11.423

考虑到要获得生日（以及一些其他属性，如用户简历），应用程序必须由 Facebook 审查。否则，尽管已正确授予权限，但 Graph API 调用将不会检索此属性。

# .net - 比原来大的缩小的png

> ID：10323934
> 
> 赞同：2
> 
> 时间：2012-04-25T21:16:26.130
> 
> 标签：.net, png, gdi+, image-resizing, filesize

我写了一个小应用程序来缩小和转换图像，解决带宽问题，我遇到了一些奇怪的事情。保存为 png 时，如果图像被缩小，生成的文件会比我仅仅转换为 png 并保持较大的分辨率*更大。*

我正在使用 GDI+ 通过 System.Drawing 命名空间进行大小调整/转换。

起初我认为这是一个 PixelFormat 问题，但我已经通过隐式指定使用传入的像素格式来排除这种情况。

谁能告诉我为什么[这张图片](http://www.teamroberts.org/joflash/scaled.png)的文件大小[比这张](http://www.teamroberts.org/joflash/unscaled.png)大，即使第二张的像素是它的三倍？它们都是每像素 24 位的 png。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T21:18:48.107

看起来抗锯齿已经咬了你。由于图像不再是纯黑/白，因此更难有效压缩。

# python - 处理具有多个侧面碰撞的简单平台游戏问题

> ID：10323937
> 
> 赞同：0
> 
> 时间：2012-04-25T21:16:46.660
> 
> 标签：python, collision-detection, pygame, collision, gravity

到目前为止，我从一个平面平台开始，我的角色在上面。

我已经实现了重力和跳跃功能。

所以重力概念的工作原理如下，继续向下坠落，直到玩家与他下方的物体发生碰撞。

所以，当我的英雄下面有一个平坦的平台时，这很有效，但是当我想实现一个屋顶时。所以我的播放器顶部和下方都有一个平坦的平台。

我的重力功能一直在下降。我的地形都在 pygame.Rect 列表中。

我的重力函数遍历我的所有地形并检查玩家是否在地板物体上方，如果如此，则继续下落。

我注意到的问题是，因为我的角色上方有物体，所以它一直在下降。我似乎无法找到一种方法来忽略角色上方的图块，而只关注玩家下方的图块并检查是否存在勾结。

一旦我发现了这个共谋问题，我确信我可以在跳起来检查与屋顶的碰撞并左右移动时弄清楚它。

帮助表示赞赏。

编辑：地形是我的对象瓷砖的列表。现在地形只有 2 个对象

```
#this is not correct way initialize just displaying my 2 object's rect
terrain = [<rect(400, 355, 50, 49)>,<rect(500, 198, 50, 49)>]

def GRAVITY(self, terrain):
    '''----------break is cutting of parsing the rest of the terrain.
    ----------Need to search through each terrain. Keep falling until collide with an object under the hero ONLY.
    '''
    for i in range(len(terrain)):
        print i
        #stop falling when colliding with object
        if terrain[i].top > self.rect.bottom:
            print 'above tile while falling'
            self.y += JUMPRATE
            break
        #continue falling if not standing on the object. Also catch when walking of an object then fall.
        elif terrain[i].top <= self.rect.bottom and not self.rect.colliderect(terrain[i]):
            print 'whoops missed tile'
            self.y +=JUMPRATE
            break
        else:
            print 'on tile'
            self.y = self.y
            break 
```

这是玩家跳跃时调用的函数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T12:07:33.140

在您的代码中，每个子句中都有一个 break 语句，因此循环将始终运行一次，无论`Rect`列表中有多少个。

您可以做的是使用`collided`标志，并且仅在发生碰撞时才中断。

```
def fall(self, terrain):
   collided = False
   for rect in terrain:
       if self.rect.colliderect(rect):
           collided = True
           break
   if not collided:
       self.y += JUMPRATE 
```

如果没有碰撞，角色就会倒下。否则，它不会移动。不过，您必须添加一些东西来处理它从侧面碰撞的情况。此外，角色的脚会稍微穿过地板，因此一旦发生碰撞，您应该将角色的脚设置`rect.bottom`为地形。`top`

# ruby-on-rails - 夏令时的 RoR in_time_zone 问题

> ID：10323941
> 
> 赞同：0
> 
> 时间：2012-04-25T21:17:01.230
> 
> 标签：ruby-on-rails, ruby, timezone, timezone-offset

我在 Ruby 1.8.7 和 Rails 2.3.12 上运行。当我在时区 EDT (-4) 中使用 object_time 运行以下代码时：

```
object_time.in_time_zone(ActiveSupport::TimeZone[-4]) 
```

我得到与 object_time 相同的值，这很棒。但是，当我运行时：

```
object_time.in_time_zone(ActiveSupport::TimeZone[-3]) 
```

我得到的值与上面的代码行相同。

有人知道会发生什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T15:27:00.173

```
(object_time.in_time_zone(ActiveSupport::TimeZone[0]) + timezone_offset.hours) 
```

你会给任何 DateTime 对象，你想要的任何 timzone 偏移量......享受吧。

# python - 我正在尝试将程序写入文件

> ID：10323951
> 
> 赞同：-3
> 
> 时间：2012-04-25T21:17:50.380
> 
> 标签：python, python-2.7

这就是我所拥有的。

```
"""

Author: Michael Wellman (wellmanm)
Title: pa10.py
Description: Deciphering a document using pennymath.

"""

def decode(inputfile,outputfile):
    **inputfile = open("superDuperTopSecretStudyGuide.txt","rU").read()
    outputfile = open("translatedguide.txt","w")**
    count = 0
    aList = []
    for words in inputfile:
        aList.append(words)
        charCount = len(aList)
        **outpufile.write(aList)**
        while count<charCount:
            print aList[count],
            if (aList[count].isalpha()):            
               if (ord(aList[count])>90):           
                   count = count + ord(aList[count])-95     
               else:                                
                   count = count + ord(aList[count])-63     
            else:
                if (aList[count].isdigit()):       
                   count = count + ord(aList[count])-46             
                else:
                   count = count + 6                        
    **inputfile.close()
    outputfile.close()** 
```

txt 文件来自我的教授：P

我相信，加粗的部分是最重要的。

有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T21:53:17.227

您是否尝试过运行代码？

我想如果你愿意，你会收到一条关于这条线的错误消息

```
outpufile.write(aList) 
```

看，`file.write()`方法的文档字符串清楚地指出：

> 写（str）-> 无。将字符串 str 写入文件。
> 
> 请注意，由于缓冲，在磁盘上的文件反映写入的数据之前，可能需要使用 flush() 或 close()。

您提供的是 a`list`而不是 a `str`。尝试将其更改为

```
outpufile.write(''.join(aList)) 
```

或者

```
outputfile.write(aList[-1]) 
```

或任何适合您的需求。此外，您永远不会清除列表，因此，当您迭代时`inputfile`，您将编写第一个字符，然后是第一个字符和第二个字符，然后是前三个字符，等等。这是故意的吗？

最后，您试图关闭`inputfile`它实际上是 a `str`，而不是文件，因为`file.read()`方法返回 a `str`。

PS请不要调用你的变量`inputfile`，如果它是一个字符串，`words`如果它是一个字符。那永远不会帮助任何人。

# javascript - 将 JS 事件委托给不同的对象

> ID：10323954
> 
> 赞同：0
> 
> 时间：2012-04-25T21:17:54.233
> 
> 标签：javascript, html, jquery, file-upload, jquery-events

我正在尝试重新设置输入类型文件元素的外观。

我通过将两个元素放在一起来做到这一点。其中一个是输入标签，另一个是一个不错的按钮。像这样的东西：

```
<input type="file" id="filesButton" multiple>
<input type="button" id="filesButtonOverlay" value="Add Files"> 
```

当用户悬停、点击等时，该按钮有一些很好的效果（全部由 CSS 完成）。但是，由于输入类型文件具有更高的 z-index（必须是这种情况，因为您无法模拟单击它）所有这些效果都不会显示。

有没有一种很好的方法来委托输入类型文件获取的所有事件并在按钮上触发它们？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T21:21:02.233

如果您将输入包装在 div 中并将事件附加到 div 会怎样？然后用您的更改来定位您的按钮？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T21:21:26.500

我认为您应该能够与共享的父母一起做到这一点。然后将`hover`放在父级而不是按钮本身上。

```
<span id="wrapper">
    <input type="file" id="filesButton" multiple>
    <input type="button" id="filesButtonOverlay" value="Add Files">
</span> 
```

* * *

```
$("#wrapper").hover(function(){
    $("#filesButtonOverlay").dosomething();
}); 
```

或在 CSS 中：

```
#wrapper:hover #filesButtonOverlay{
  stuff:
} 
```

如果您可能在同一页面上有多个，您希望更改为使用 classes 而不是`id`s

# asp.net - 如何在独立的 ascx 控件中包含引用？

> ID：10323956
> 
> 赞同：1
> 
> 时间：2012-04-25T21:18:05.497
> 
> 标签：asp.net, dll, ascx

我有一个 ASP.NET ascx 控件。在文件后面的代码中，我需要添加一些参考（Sharepoint Libraries）来做一些查询。我怎样才能做到这一点？是一个独立的控件，我的意思是我只有 .ascx 和 ascx.cs 文件。它们不是任何项目的一部分，因此我在解决方案资源管理器中没有典型的 Property 文件夹，它们是使用 SmartPart 控件加载到共享点页面中的。所以我在这里有点迷失，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T23:16:25.260

简单的答案是您不能，在 ASP.NET 中，引用被添加到应用程序的 web.config 文件中，而不是单个控件。您必须编辑 SharePoint web.config 文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-12T02:27:22.263

我发现如果我将dll放在控件同级的**\bin文件夹中，我可以毫无问题地使用其中定义的代码。**所以我不需要添加引用，按照惯例，该文件夹中的所有 dll 都可供我控制。更清楚的文件结构是这样的：

```
\UserControls\bin\AnyCompiledLibrary.dll
\UserControls\AnyControl.ascx 
```

# json - 将 JSON 发布到 REST API

> ID：10323957
> 
> 赞同：16
> 
> 时间：2012-04-25T21:18:07.977
> 
> 标签：json, spring, rest, curl, jackson

我正在创建一个将接受 JSON 请求的 REST API。

我正在使用 CURL 对其进行测试：

```
curl -i -POST -H 'Accept: application/json' -d '{"id":1,"pan":11111}' http://localhost:8080/PurchaseAPIServer/api/purchase 
```

但得到以下错误：

```
HTTP/1.1 415 Unsupported Media Type
Server: Apache-Coyote/1.1
Content-Type: text/html;charset=utf-8
Content-Length: 1051
Date: Wed, 25 Apr 2012 21:36:14 GMT

The server refused this request because the request entity is in a format not supported by the requested resource for the requested method (). 
```

在调试时，它甚至不会进入我在控制器中的创建操作。

```
import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.HttpStatus;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.ResponseBody;
import org.springframework.web.bind.annotation.ResponseStatus;

import com.app.model.Purchase;
import com.app.service.IPurchaseService;

@Controller
public class PurchaseController {

    @Autowired
    private IPurchaseService purchaseService;

    @RequestMapping(value = "purchase", method = RequestMethod.GET)
    @ResponseBody
    public final List<Purchase> getAll() {
        return purchaseService.getAll();
    }

    @RequestMapping(value = "purchase", method = RequestMethod.POST)
    @ResponseStatus( HttpStatus.CREATED )
    public void create(@RequestBody final Purchase entity) {
        purchaseService.addPurchase(entity);
    }
} 
```

## 更新

我将 Jackson 配置添加到 AppConfig.java：

```
@Configuration
@ComponentScan(basePackages = "com.app")
public class AppConfig {

    @Bean
    public AnnotationMethodHandlerAdapter annotationMethodHandlerAdapter()
    {
        final AnnotationMethodHandlerAdapter annotationMethodHandlerAdapter = new AnnotationMethodHandlerAdapter();
        final MappingJacksonHttpMessageConverter mappingJacksonHttpMessageConverter = new MappingJacksonHttpMessageConverter();

        HttpMessageConverter<?>[] httpMessageConverter = { mappingJacksonHttpMessageConverter };

        String[] supportedHttpMethods = { "POST", "GET", "HEAD" };

        annotationMethodHandlerAdapter.setMessageConverters(httpMessageConverter);
        annotationMethodHandlerAdapter.setSupportedMethods(supportedHttpMethods);

        return annotationMethodHandlerAdapter;
    }
} 
```

我的 GET 现在工作正常：

```
curl -i -H "Content-Type:application/json" -H "Accept:application/json" http://localhost:8080/PurchaseAPIServer/api/purchase

HTTP/1.1 200 OK
Server: Apache-Coyote/1.1
Content-Type: application/json
Transfer-Encoding: chunked
Date: Thu, 26 Apr 2012 21:19:55 GMT

[{"id":1,"pan":111}] 
```

但是我在尝试 POST 时得到以下信息：

```
curl -i -X POST -H "Content-Type:application/json" -H "Accept:application/json" http://localhost:8080/PurchaseAPIServer/api/purchaseMe -d "{"id":2,"pan":122}"

HTTP/1.1 400 Bad Request
Server: Apache-Coyote/1.1
Content-Type: text/html;charset=utf-8
Content-Length: 971
Date: Thu, 26 Apr 2012 21:29:56 GMT
Connection: close

The request sent by the client was syntactically incorrect (). 
```

我的模型：

```
@Entity
@XmlRootElement
public class Purchase implements Serializable {

    /**
     * 
     */
    private static final long serialVersionUID = 6603477834338392140L;

    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    private Long id;

    private Long pan;

    public Long getId() {
        return id;
    }

    public void setId(Long id) {
        this.id = id;
    }

    public Long getPan() {
        return pan;
    }

    public void setPan(Long pan) {
        this.pan = pan;
    }

} 
```

有什么想法我哪里出错了吗？

谢谢

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-28T13:21:33.040

正如[sdouglass 所](https://stackoverflow.com/users/433789/sdouglass)建议的，Spring MVC 会自动检测 Jackson 并设置 MappingJacksonHttpMessageConverter 来处理与 JSON 的转换。但正如他所指出的，我确实需要明确配置转换器以使其正常工作。

我添加了以下内容，并且我的 CURL GET 请求正在工作..万岁。

AppConfig.java

```
@Configuration
@ComponentScan(basePackages = "com.app")
public class AppConfig {

    @Bean
    public AnnotationMethodHandlerAdapter annotationMethodHandlerAdapter()
    {
        final AnnotationMethodHandlerAdapter annotationMethodHandlerAdapter = new AnnotationMethodHandlerAdapter();
        final MappingJacksonHttpMessageConverter mappingJacksonHttpMessageConverter = new MappingJacksonHttpMessageConverter();

        HttpMessageConverter<?>[] httpMessageConverter = { mappingJacksonHttpMessageConverter };

        String[] supportedHttpMethods = { "POST", "GET", "HEAD" };

        annotationMethodHandlerAdapter.setMessageConverters(httpMessageConverter);
        annotationMethodHandlerAdapter.setSupportedMethods(supportedHttpMethods);

        return annotationMethodHandlerAdapter;
    }
} 
```

```
curl -i -H "Content-Type:application/json" -H "Accept:application/json" http://localhost:8080/PurchaseAPIServer/api/purchase

HTTP/1.1 200 OK
Server: Apache-Coyote/1.1
Content-Type: application/json
Transfer-Encoding: chunked
Date: Thu, 26 Apr 2012 21:19:55 GMT

[{"id":1,"pan":111}] 
```

但是以下 CURL POST 仍然无法正常工作（永远不要点击控制器操作并且不提供控制台调试信息。

```
curl -i -X POST -H "Content-Type:application/json"  http://localhost:8080/PurchaseAPIServer/api/purchaseMe -d "{"id":2,"pan":122}"

HTTP/1.1 400 Bad Request
Server: Apache-Coyote/1.1
Content-Type: text/html;charset=utf-8
Content-Length: 971
Date: Thu, 26 Apr 2012 21:29:56 GMT
Connection: close

The request sent by the client was syntactically incorrect (). 
```

所以我添加了[Logback](http://logback.qos.ch/)来开始一些详细的调试。

```
<configuration>

    <appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">
        <encoder>
            <pattern>%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n
            </pattern>
        </encoder>
    </appender>

    <appender name="FILE" class="ch.qos.logback.core.FileAppender">
        <file>/home/thomas/springApps/purchaseapi.log</file>
        <encoder>
            <pattern>%date %level [%thread] %logger{10} [%file:%line] %msg%n
            </pattern>
        </encoder>
    </appender>

    <logger name="org.hibernate" level="DEBUG" />

    <logger name="org.springframework" level="TRACE" />
    <logger name="org.springframework.transaction" level="INFO" />
    <logger name="org.springframework.security" level="INFO" /> <!-- to debug security related issues (DEBUG) -->
    <logger name="org.springframework.web.servlet.mvc" level="TRACE" /> <!-- some serialization issues are at trace level here: org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod -->

    <!-- our service -->
    <logger name="com.app" level="DEBUG" />
    <!-- <logger name="com.app" level="INFO" /> --><!-- to follow if setup is being executed -->

    <root level="INFO">
        <appender-ref ref="FILE" />
    </root>

</configuration> 
```

*在org.springframework.web.servlet.mvc*中 添加 TRACE 级别的调试给了我问题的答案。

```
2012-04-28 14:17:44,579 DEBUG [http-bio-8080-exec-3] o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor [AbstractMessageConverterMethodArgumentResolver.java:117] Reading [com.app.model.Purchase] as "application/json" using [org.springframework.http.converter.json.MappingJacksonHttpMessageConverter@74a14fed]
2012-04-28 14:17:44,604 TRACE [http-bio-8080-exec-3] o.s.w.s.m.m.a.ServletInvocableHandlerMethod [InvocableHandlerMethod.java:159] Error resolving argument [0] [type=com.app.model.Purchase]
HandlerMethod details: 
Controller [com.app.controller.PurchaseController]
Method [public void com.app.controller.PurchaseController.create(com.app.model.Purchase)]

org.springframework.http.converter.HttpMessageNotReadableException: Could not read JSON: Unexpected character ('p' (code 112)): was expecting double-quote to start field name 
```

我将 CURL POST 更改为以下内容，一切正常：

```
curl -i -X POST -H "Content-Type:application/json" http://localhost:8080/PurchaseAPIServer/api/purchase -d '{"pan":11111}'
HTTP/1.1 201 Created
Server: Apache-Coyote/1.1
Content-Length: 0
Date: Sat, 28 Apr 2012 13:19:40 GMT 
```

希望有人觉得这很有用。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-25T22:11:08.287

如果我没记错的话，Spring 文档说 Spring MVC 将自动在类路径上检测 Jackson 并设置 MappingJacksonHttpMessageConverter 来处理与 JSON 的转换，但我认为我遇到过必须手动/显式配置该转换器才能获得的情况工作的事情。您可能想尝试将其添加到您的 MVC 配置 XML 中：

```
<bean class="org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter">
    <property name="messageConverters">
        <list>
            <bean class="org.springframework.http.converter.json.MappingJacksonHttpMessageConverter">
        </list>
    </property>
</bean> 
```

**更新**：这是加上正确格式化所发布的 JSON，请参阅[https://stackoverflow.com/a/10363876/433789](https://stackoverflow.com/a/10363876/433789)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-03-19T19:29:25.460

它是 2014 年，我想为这个问题添加一些更新，帮助我解决同样的问题。

1.  代码更新以替换 Spring 3.2 中已弃用的 AnnotationMethodHandlerAdapter

    ```
        @配置
        公共类 AppConfig {

    ```
     @Bean
        public RequestMappingHandlerAdapter  annotationMethodHandlerAdapter()
        {
            final RequestMappingHandlerAdapter annotationMethodHandlerAdapter = new RequestMappingHandlerAdapter();
            final MappingJackson2HttpMessageConverter mappingJacksonHttpMessageConverter = new MappingJackson2HttpMessageConverter();

            List<HttpMessageConverter<?>> httpMessageConverter = new ArrayList<HttpMessageConverter<?>>();
            httpMessageConverter.add(mappingJacksonHttpMessageConverter);

            String[] supportedHttpMethods = { "POST", "GET", "HEAD" };

            annotationMethodHandlerAdapter.setMessageConverters(httpMessageConverter);
            annotationMethodHandlerAdapter.setSupportedMethods(supportedHttpMethods);

            return annotationMethodHandlerAdapter;
        }
    } 
    ```

    ```

2.  HTTP/1.1 415 不支持的媒体类型错误

在花了好几个小时试图弄清楚为什么即使在添加了正确的 JSON 配置之后我仍然收到 415 错误后，我终于意识到问题不在于服务器端，而在于客户端。为了让 Spring 接受您的 JSON，您必须确保将“Content-Type : application/json”和“Accept: application/json”作为 http 标头的一部分发送。对我来说，它是一个 Android 应用程序 HttpUrlConnection，我必须将其设置为：

```
 public static String doPost(final String urlString,final String requestBodyString) throws IOException {
        final URL url = new URL(urlString);

        final HttpURLConnection urlConnection = (HttpURLConnection) url.openConnection();
        try {
          urlConnection.setReadTimeout(10000 /* milliseconds */);
          urlConnection.setConnectTimeout(15000 /* milliseconds */);
          urlConnection.setRequestProperty("Content-Type", "application/json");
          urlConnection.setRequestProperty("Accept", "application/json");
          urlConnection.setDoOutput(true);
          urlConnection.setRequestMethod("POST");
          urlConnection.setChunkedStreamingMode(0);

          urlConnection.connect();

          final PrintWriter out = new PrintWriter(urlConnection.getOutputStream());
          out.print(requestBodyString);
          out.close();

          final InputStream in = new BufferedInputStream(urlConnection.getInputStream());
          final String response =  readIt(in);

          in.close(); //important to close the stream

          return response;

        } finally {
          urlConnection.disconnect();
        }
    } 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-25T21:21:34.870

尝试添加 POST 请求中内容的描述符。也就是说，添加到`curl`标题：

```
Content-Type: application/json 
```

如果您不添加它，无论您实际发送什么，`curl`都将使用默认值。`text/html`

此外，`PurchaseController.create()` 您必须添加接受的类型是`application/json`.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-12-11T07:24:46.577

我有同样的问题，这通过我的代码中的两个更改来解决：

1.  在我的方法参数中缺少@PathVariable，我的方法没有任何
2.  在我的 SpringConfig 类中使用以下方法，因为我使用处理程序拦截器的方法已被弃用并出现一些问题：

    ```
    public RequestMappingHandlerAdapter RequestMappingHandlerAdapter()
    {
        final RequestMappingHandlerAdapter requestMappingHandlerAdapter = new RequestMappingHandlerAdapter();
        final MappingJacksonHttpMessageConverter mappingJacksonHttpMessageConverter = new MappingJacksonHttpMessageConverter();
        final String[] supportedHttpMethods = { "POST", "GET", "HEAD" };

        requestMappingHandlerAdapter.getMessageConverters().add(0, mappingJacksonHttpMessageConverter);
        requestMappingHandlerAdapter.setSupportedMethods(supportedHttpMethods);

        return requestMappingHandlerAdapter;
    } 
    ```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-10-22T03:13:55.517

这是一个类似于 yoram givon 的答案的单元测试解决方案 - [https://stackoverflow.com/a/22516235/1019307](https://stackoverflow.com/a/22516235/1019307)。

```
public class JSONFormatTest
{
    MockMvc mockMvc;

    // The controller used doesn't seem to be important though YMMV
    @InjectMocks
    ActivityController controller;  

    @Before
    public void setup()
    {
        MockitoAnnotations.initMocks(this);

        this.mockMvc = standaloneSetup(controller).setMessageConverters(new MappingJackson2HttpMessageConverter())
                .build();
    }

    @Test
    public void thatSaveNewDataCollectionUsesHttpCreated() throws Exception
    {
        String jsonContent = getHereJSON02();
        this.mockMvc
                .perform(
                     post("/data_collections").content(jsonContent).contentType(MediaType.APPLICATION_JSON)
                                .accept(MediaType.APPLICATION_JSON)).andDo(print()).andExpect(status().isCreated());
    }

    private String getHereJSON01()
    {
        return "{\"dataCollectionId\":0,\"name\":\"Sat_016\",\"type\":\"httpUploadedFiles\"," ...
    }
} 
```

运行单元测试，`print()`应该打印出包含异常的 MockHttpServletRequest。

在 Eclipse 中（不确定如何在其他 IDE 中执行此操作），单击 Exception 链接，应该会打开该异常的属性对话框。勾选“启用”框以中断该异常。

调试单元测试，Eclipse 会因异常而中断。检查它应该会发现问题。就我而言，这是因为我的 JSON 中有两个相同的实体。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-16T09:51:02.633

我经历过一次，最后通过添加jar文件jackson-mapper-asl.jar解决了。去检查你是否包含了所有这些依赖项，尽管异常本身并没有告诉你。

而且你真的不需要显式配置bean，也不需要在@RequestMapping 语句中放入“consumes”。我正在使用 Spring 3.1 顺便说一句。

contentType : "application/json" 是您唯一需要配置的。是的，客户端。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-02-23T00:08:24.817

尝试在您的应用配置中添加以下代码

```
<mvc:annotation-driven>
  <mvc:message-converters>
      <bean class="org.springframework.http.converter.json.MappingJackson2HttpMessageConverter">
          <property name="objectMapper" ref="jacksonObjectMapper" />
      </bean>
  </mvc:message-converters> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-08-29T01:06:17.403

我有同样的问题，我解决了。

1 添加 MappingJackson2HttpMessageConverter 如该线程中所述（另请参阅第 4 节[http://www.baeldung.com/spring-httpmessageconverter-rest](http://www.baeldung.com/spring-httpmessageconverter-rest)）

2 使用正确的命令（带有转义符号）：

```
curl -i -X POST -H "Content-Type:application/json" -d "{\"id\":\"id1\",\"password\":\"password1\"}" http://localhost:8080/user 
```

# image - 使透明图像更小的想法？

> ID：10323959
> 
> 赞同：1
> 
> 时间：2012-04-25T21:18:09.647
> 
> 标签：image, png

在我的网站[http://www.derekbeck.com/1775/](http://www.derekbeck.com/1775/)上，由于需要透明度而嵌入为 png 的标题图像是最大的下载内容，为 197 kb。关于大幅缩小其尺寸的任何建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T15:20:41.620

使用[ImageAlpha](http://pngmini.com)降低颜色深度，然后使用[ImageOptim](http://imageoptim.com)应用最大压缩。

如果您不在 Mac 上，那么[TinyPNG](http://tinypng.org)和 pnggauntlet 也会这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T21:25:43.310

你不能真的压缩太多 - 这是一个“令人困惑”的图像，因为没有明显的图案或清晰的颜色矩形，所以以无损格式压缩并不容易。您可以将其拆分为大约 3 张图像，因为有时以这种方式下载会更快一些。无论如何，现在 200kb 并不算多，而且它是缓存的，所以这不是太大的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-26T02:38:37.117

没什么可做的，真的。如果你将它分成 32 级并以最大压缩（例如使用 XnView）保存，你会得到 121kb，但有一些退化。

你也可以试试[pngcrush](http://pmt.sourceforge.net/pngcrush/)

我一直在我的 PNGJ 库中尝试有损 png 压缩，但它还没有真正可用 - 如果你有兴趣，这里有一个 95kb 的结果[http://img221.imageshack.us/img221/9659/1775headerwithimagebw37。 PNG](http://img221.imageshack.us/img221/9659/1775headerwithimagebw37.png)

# c - 带有 ctags 和 omnicomplete 的 Vim 未完成 C 结构字段

> ID：10323960
> 
> 赞同：2
> 
> 时间：2012-04-25T21:18:17.760
> 
> 标签：c, vim, ctags, omnicomplete

我有我的 vim 设置来使用带有 ctags 的omnicomplete 并且它运行良好。我已将 .ctags 设置为标记结构成员，它们位于标记文件中，但omnicomplete 仅显示

```
Omni completion (^O^N^P) Pattern not found 
```

当我做类似 mystruct 的事情时。或 mystruct-> 其他一切都提供了良好的完成。

我还需要在 vim、omnicomplete 或 ctags 中启用什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T18:07:29.683

你的意思是“ *omnicppcomplete* ”而不是“ *omnicomplete* ”？如果不是，那么您可能想要使用[omnicppcomplete](http://goo.gl/lFqXr)。

此外，请查看[clang_complete](http://goo.gl/v7wXQ)以完美完成 C/C++/Objective-C 代码。

# php - jquery 在单击特定 div 时获取数据，我希望当我们单击 Ajax 1 时

> ID：10323966
> 
> 赞同：-1
> 
> 时间：2012-04-25T21:18:53.860
> 
> 标签：php, jquery, ajax

我希望当我们点击 Ajax 1 时，ajax1 的内容会发生变化，但 Ajax 2 将保持不变，反之亦然，请帮助我想用 jquery 做到这一点

```
<html>
<head>
<script src="http://code.jquery.com/jquery-latest.js"></script>
<script type="text/javascript">
$(document).ready(function(){
$("#pas").click(function(){
  $.ajax({url:"001.php?q=1 & l=111", success:function(result){
    $("#pas").html(result);
  }});
});});
</script>
</head>
<body>
<div id="pas"><h2>AJAX 1</h2></div>
<div id="pas"><h2> AJAX2 </h2></div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T21:25:34.503

两个元素不能有相同的`id`。您应该更改为使用类。

```
<div class="pas"><h2>AJAX 1</h2></div>
<div class="pas"><h2> AJAX2 </h2></div> 
```

完成此操作后，您可以使用`this`来定位正确的项目。

```
$(document).ready(function(){
    $(".pas").click(function(){
        var $this = $(this);    // "this" is the clicked element

        $.ajax({url:"001.php?q=1 & l=111", success:function(result){
            $this.html(result);
        }});
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T21:25:42.967

您必须区分 div 的 id：给它们两个不同的 id（即 pas1 和 pas2 ）和相同的类“pas”，然后在 div.pas 上触发操作

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T21:27:32.810

不要使用重复的 id，而是使用类。使用对单击对象的引用来更新您的内容。这是您修改后的代码：

```
<html>
<head>
<script src="http://code.jquery.com/jquery-latest.js"></script>
<script type="text/javascript">
$(document).ready(function(){
$("div").click(function(){
  var _this = this;
  $.ajax({url:"001.php?q=1 & l=111", success:function(result){
    $(_this).html(result);
  }});
});});
</script>
</head>
<body>
<div><h2>AJAX 1</h2></div>
<div><h2> AJAX2 </h2></div>
</body>
</html> 
```

# hibernate - 最小查询休眠

> ID：10323967
> 
> 赞同：0
> 
> 时间：2012-04-25T21:18:58.673
> 
> 标签：hibernate

我有一个名为 PriceChange 的表。它具有以下列：Sno、Time、Price、ShareID。

我想选择具有最低 Sno 值的给定 shareID 的价格。如何使用 Hibernate 实现这一目标？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T21:28:56.377

那这个呢？

```
Query q = session.
  createQuery("SELECT Price FROM PriceChange WHERE ShareID = ? ORDER BY Sno");
q.setFirstResult(1); 
q.setMaxResults(1); 
```

# javascript - 从js浏览fileReference，在flash变通方法中模拟按键

> ID：10323976
> 
> 赞同：0
> 
> 时间：2012-04-25T21:20:01.443
> 
> 标签：javascript, flash, actionscript, external, filereference

我正在尝试从 Flash SWF 外部调用 fileReference.browse，我读了一些文章，这些文章通常说由于 Flash 10 安全问题，这是不可能的。所以我想知道从 js 向 Flash 发送一个命令来模拟一个命令是否可行闪存内的按键，这（此按键）将触发文件引用。

提前谢谢你，丹尼尔！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T22:36:32.603

这是不可能的（这会造成相当严重的安全风险）。您可以通过检查任何使用 Flash 的 FileReference 的上传模块来确认这一点......所有这些都使用透明的 Flash 覆盖来注册点击，或者上传按钮本身是可自定义的 SWF（直到最近 gmail 使用透明覆盖，现在我认为它使用本机上传）。

# c++ - 模板编译：gcc vs VS2010

> ID：10323980
> 
> 赞同：1
> 
> 时间：2012-04-25T21:20:21.133
> 
> 标签：c++, visual-studio-2010, templates, visual-c++, gcc

摘自本书 - C++ 模板：David, Nicolai 的完整指南

> 因此，模板被编译两次：
> 
> 1.  在没有实例化的情况下，将检查模板代码本身的语法是否正确。发现语法错误，例如缺少分号。
> 2.  在实例化时，会检查模板代码以确保所有调用都有效。发现无效调用，例如不支持的函数调用。

保持第一点，我写道 -

```
template<typename T>
void foo( T x)
{
   some illegal text
}

int main()
{
   return 0;
} 
```

它在 Visual Studio 2010 上构建良好，没有任何警告关闭优化。但是，[它在 gcc-4.3.4 上失败了](http://ideone.com/TJK6y)。哪一个符合 C++ 标准？即使没有模板实例化，模板代码是否也必须编译？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-25T21:41:28.070

有问题的程序格式错误，但 C++ 标准在这种情况下不需要诊断，因此 Visual Studio 和 GCC 都以兼容的方式运行。来自 C++03 标准的第 14.6/7 节（强调我的）：

> 知道哪些名称是类型名称可以检查每个模板定义的语法。对于可以生成有效特化的模板定义，不应发出诊断。**如果无法为模板定义生成有效的特化，并且该模板未实例化，则模板定义格式错误，无需诊断。**如果在非依赖名称中使用的类型在定义模板时是不完整的，但在实例化完成时是完整的，并且如果该类型的完整性影响程序是否良好 -形成或影响程序的语义，程序是非良构的；不需要诊断。[*注：*如果模板被实例化，错误将根据本标准中的其他规则进行诊断。准确诊断这些错误的时间是实施质量问题。] [*示例：*
> 
> ```
> int j;
> template<class T> class X {
>     // ...
>     void f(T t, int i, char* p)
>     {
>         t = i; // diagnosed if X::f is instantiated
>                // and the assignment to t is an error
>         p = i; // may be diagnosed even if X::f is
>                // not instantiated
>         p = j; // may be diagnosed even if X::f is
>                // not instantiated
>     }
>     void g(T t) {
>         +; //may be diagnosed even if X::g is
>            // not instantiated
>     }
> }; 
> ```
> 
> —<em>结束示例]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T21:38:15.767

您正在看的这本书似乎（主要）反映了作者对编译器实际工作方式的观察，而不是标准的要求。该标准并没有对模板中的格式错误的代码给予额外的宽大处理，只是因为它没有被实例化。

同时，这本书是正确的，编译器在实例化之前确实无法做太多检查。例如，您可以使用从属名称作为函数的名称（或者像函数一样调用它，无论如何——如果它是仿函数，那也可以）。如果您在作为函数的类上实例化该模板，那*很好*。如果你在一个真正是 的类上实例化它，那么`int`尝试调用它无疑会失败。在您实例化它之前，编译器无法分辨哪个是哪个。

`concepts`这是真正打算添加到 C++ 中的大部分内容。您可以直接指定（例如）模板 X 将`T::y`像函数一样调用。然后编译器可以将模板的内容与概念中的声明进行比较，并确定模板的主体是否与概念中的声明相匹配。在另一个方向上，编译器只需将一个类（或其他）与*概念*进行比较，以确定实例化该模板是否有效。如果它不起作用，它可以直接将错误报告为违反相关概念（就像现在一样，它会尝试实例化模板，并且您经常会收到一些奇怪的错误消息，表明真正的问题很糟糕，如果有的话）。

# validation - 验证失败时设置 Spark TextInput 背景

> ID：10323982
> 
> 赞同：1
> 
> 时间：2012-04-25T21:20:30.803
> 
> 标签：validation, apache-flex, error-handling, textinput, flex-spark

如何指定 TextInput 在错误状态下的样子？关于这个主题的文档似乎真的很稀缺！

没有错误状态，但是您可以指定一个 errorSkin（它必须是 ErrorSkin 的子类吗？）。

我想设置 TextInput 的背景颜色并在验证失败时增加边框的厚度。我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T20:35:13.127

这就是我最终得到的结果：

```
public class ObviousErrorSkin extends ErrorSkin
{
    private static var glowFilter:GlowFilter = new GlowFilter(0xFF0000, 0.85, 8, 8, 3, 1, true, true);

    private static var rect:Rectangle = new Rectangle();

    private static var filterPt:Point = new Point();

    override protected function processBitmap():void
    {
        rect.x = rect.y = 0;
        rect.width = bitmap.bitmapData.width;
        rect.height = bitmap.bitmapData.height;
        glowFilter.color = target.getStyle("errorColor");
        bitmap.bitmapData.applyFilter(bitmap.bitmapData, rect, filterPt, glowFilter);
    }

    override protected function updateDisplayList(unscaledWidth:Number, unscaledHeight:Number):void
    {
        // Early exit if we don't have a target object
        if (!target)
            return;

        super.updateDisplayList(unscaledWidth, unscaledHeight);

        graphics.clear();
        graphics.beginFill(target.getStyle("errorColor"), 0.25);
        graphics.drawRect(bitmap.x, bitmap.y, bitmap.width, bitmap.height);
        graphics.endFill();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T06:29:26.027

您应该使用 errorString 属性来激活错误状态

[Flex，有什么方法可以像验证器那样以编程方式突出显示红色字段？](https://stackoverflow.com/questions/10272041/flex-any-way-to-programmatically-highlight-a-field-in-red-the-way-the-validator/10272292#10272292)

看看这个答案，我想它会帮助你理解

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T07:43:01.317

据我所知，没有简单的方法可以实现这一目标。问题是在错误状态组件不会改变它自己的皮肤，它只是将 errorSkin 的实例添加为新的孩子。这是来自的代码`SkinnableComponent`

```
mx_internal function updateErrorSkin():void
{
    if (errorString != null && errorString != "" && getStyle("showErrorSkin"))
    {
        if (!errorObj)
        {
            var errorObjClass:Class = getStyle("errorSkin");

            if (errorObjClass)
                errorObj = new errorObjClass();

            if (errorObj)
            {
                if ("target" in errorObj)
                    errorObj["target"] = this;
                super.addChild(errorObj);
            }
        }
    }
    else
    {
        if (errorObj)
            super.removeChild(errorObj);

        errorObj = null;
    }
} 
```

如果您要添加 errorSkin 并从中扩展它，`SparkSkin`则它的大小将为零。当然你可以将它的 width 和 height 属性设置为父组件，但是它会与这个父组件重叠。

如果您使用继承自`ErrorSkin`. `bitmap`但是你需要对它的属性做点什么。它仍然会超过您的主要组件。是的，您可以交换错误皮肤和主皮肤，然后使主皮肤透明，也许可以达到您的需要，但我建议您创建自己的组件，如下所示：

**TextInputWithError.as**

```
package
{
    import spark.components.TextInput;

    [SkinState("error")]

    public class TextInputWithError extends TextInput
    {

        public function TextInputWithError()
        {
            super();
        }

        protected var useErrorSkin:Boolean;

        override public function set errorString(value:String):void
        {
            super.errorString = value;
            setStyle("errorSkin", null);
            if (value != "")
                useErrorSkin = true;
            else
                useErrorSkin = false;
            invalidateProperties();
        }

        override protected function commitProperties():void
        {
            super.commitProperties();

            if (useErrorSkin != "")
                skin.currentState = "error";
            else
                skin.currentState = getCurrentSkinState();
        }

    }
} 
```

**TextInputWithErrorSkin.mxml**

```
<?xml version="1.0" encoding="utf-8"?>
<s:SparkSkin xmlns:fx="http://ns.adobe.com/mxml/2009" xmlns:s="library://ns.adobe.com/flex/spark"
    xmlns:fb="http://ns.adobe.com/flashbuilder/2009" 
    alpha.disabledStates="0.5" blendMode="normal">

    <fx:Metadata>
    <![CDATA[ 
        /** 
         * @copy spark.skins.spark.ApplicationSkin#hostComponent
         */
        [HostComponent("TextInputWithError")]
    ]]>
    </fx:Metadata> 

    <s:states>
        <s:State name="normal"/>
        <s:State name="error"/>
        <s:State name="disabled" stateGroups="disabledStates"/>
        <s:State name="normalWithPrompt"/>
        <s:State name="disabledWithPrompt" stateGroups="disabledStates"/>
    </s:states>

    <s:Rect id="background" left="1" right="1" top="1" bottom="1">
        <s:fill>
            <s:SolidColor id="bgFill" color="0xFFFFFF" color.error="0x00FF00" />
        </s:fill>
    </s:Rect>

    <s:Rect left="0" right="0" top="0" bottom="0" id="border">
        <s:stroke>     
            <s:SolidColorStroke id="borderStroke" weight="1" weight.error="2" color.error="0xFF0000" />
        </s:stroke>
    </s:Rect>

    <s:Rect left="1" top="1" right="1" height="1" id="shadow">
        <s:fill>
            <s:SolidColor color="0x000000" alpha="0.12" />
        </s:fill>
    </s:Rect>

    <s:RichEditableText id="textDisplay"
              verticalAlign="middle"
              widthInChars="10"
              left="1" right="1" top="1" bottom="1" />

    <s:Label id="promptDisplay" maxDisplayedLines="1"
                verticalAlign="middle"
                mouseEnabled="false" mouseChildren="false"
                includeIn="normalWithPrompt,disabledWithPrompt" 
                includeInLayout="false"
                />

</s:SparkSkin> 
```

如果有人能指导我更好地解决这个问题，我将不胜感激，因为我也有 =)

# ruby-on-rails - 为方法参数指定允许的值

> ID：10323984
> 
> 赞同：1
> 
> 时间：2012-04-25T21:20:53.553
> 
> 标签：ruby-on-rails, ruby

就像在标题中一样-例如，我有一个方法，并且我希望在参数等于以下值之一`DrawMe(what)`时允许运行此方法： -如果不是，则应停止此方法并应打印错误。有任何想法吗？`what``{"house", "garden", "cat", "dog"}`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T21:24:30.563

```
class Draw
  ALLOWED = %w[house garden cat dog]
  def self.me(what)
    raise ArgumentError, "Unknown drawable '#{what}'" unless ALLOWED.include?(what)
    # Otherwise, carry on!
    puts "I'm going to draw a #{what}!"
  end
end

Draw.me('garden') #=> I'm going to draw a garden!
Draw.me('cat'   ) #=> I'm going to draw a cat!
Draw.me('morals') #=> RuntimeError: Unknown drawable 'morals' 
```

但是，请注意，*大多数时候*您不应该确保开发人员将正确类型的值传递给您的方法。如果由于误用而发生爆炸，您的方法将引发自己的错误；尝试检查和捕获此类错误是浪费您的时间和计算机的时间。

**编辑**：如果您需要经常使用它，您可以在任何地方进行猴子补丁：

```
class Object
  def ensure_in( enumerable )
    unless enumerable.include?( self )
      raise ArgumentError, "#{self} must be one of #{enumerable}"
    end
  end
end

def me(what)
  what.ensure_in( ALLOWED )
  # Go ahead
end 
```

# ios - -scrollViewDidScroll: 是否在后台线程上调用？

> ID：10323986
> 
> 赞同：0
> 
> 时间：2012-04-25T21:21:01.297
> 
> 标签：ios, multithreading, concurrency, uiscrollview

我在使用 -scrollViewDidScroll 时遇到了一些奇怪的事情：

在每次调用中，我都会从 NSMutableArray 中获取最后一个对象，并将另一个对象添加到该 NSMutableArray。

但似乎 NSMutableArray 在下一次调用之前没有及时存储对象，当我尝试获取最后一个插入的对象时，它不是我插入的最后一个。发生了一些异步的事情。

这是一个已知的问题？如何查看它是否在主线程中调用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T21:26:03.800

它在主线程上调用。您可以通过在 Xcode 中添加断点`-scrollViewDidScroll:`并查看调用堆栈来检查。

或者 NSThread 在这里有一些非常有用的方法，例如 +isMainThread 或 +callStackSymbols。

[NSThread 文档](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/nsthread_Class/Reference/Reference.html)

# ide - 是否有任何用于处理字符串的日常工作的强大语言的交互式控制台？

> ID：10323994
> 
> 赞同：1
> 
> 时间：2012-04-25T21:21:35.987
> 
> 标签：ide, console, text-processing

最近开始从事 IT 工作

有一定的编程背景，

有很多场合需要处理大量数据。

我猜主要是字符串..

例如：

*   有 2 组大的线条，我们需要两组中的所有线条
*   将连续的一个或多个白色字符替换为一个换行符...
*   取每行的第 4 到第 7 个字符并将它们打印在一行中，并以逗号作为分隔符

这些不是最好的例子，但通常是任何类型的文本解析、操作和查询。

在任何编程语言中，这项任务通常都非常简单，但打开这种语言的 IDE 只是令人沮丧......

我正在寻找某种方式来编写代码（使用智能/自动完成），在一个简单的快速窗口中......使用简单的输入和输出文本框......

你明白我的需要吗？你能想到什么可以帮助的吗？

我知道有些问题可以使用 excel 解决。但我真的更喜欢一些好的旧程序。除非有人坚信我错了。

如果我自己构建一些东西，可以选择添加任意数量的无限多行文本框。它们将被自动命名，尽管名称是可变的（名称将是变量的名称）。

您还可以添加任意数量的具有名称的输出文本框...

并且您有编辑器窗口，您可以在其中编写程序.....它将具有一些交互式智能界面...

你能明白我在说什么吗？你知道类似的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T22:01:11.420

似乎[Python](http://www.python.org/)会很好。

有一个交互式键盘界面，非常好的抽象设施，以及作为对象的字符串以及用于处理此类字符串的良好库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T01:11:49.753

听起来很多你想要的东西都可以在标准控制台中使用 sed、awk 或 perl 使用**正则表达式来处理。**自动完成将非常有限，但无论如何您的脚本都会很短 - 处理上面的第三种情况，例如：

```
sed 's/^...\(....\).*/\1/g' < input.txt | tr "\n" ',' > output.csv 
```

您可以做的是使用**交互式正则表达式测试器**。网上有很多这样[的](http://regex.powertoy.org/)。

您还可以查看斯坦福的[Data Wrangler](http://vis.stanford.edu/wrangler/)等工具，这些工具旨在更易于访问，但与传统的 shell 工具一样强大。

（请注意，您的第一个问题 - 相交的行集 - 有点不同，可以在 shell[中](http://mywiki.wooledge.org/BashFAQ/036)使用`comm`.在此文件中”或“仅此文件中的文件也在此其他文件中”。）

# java - 如何将源绑定到插件

> ID：10323996
> 
> 赞同：0
> 
> 时间：2012-04-25T21:22:08.240
> 
> 标签：java, eclipse, eclipse-plugin, eclipse-pde

我想将源绑定到 Eclipse 插件。

我已经从 eclipse indigo 更新站点创建了自定义目标，并且有带有源代码的插件，所以我尝试为 egit 插件制作这样的源插件。我不知道如何使用 eclipse 制作这样的插件，所以我只是从现有的源插件中获取清单并使用 egit 特定信息对其进行更新。

然后我将此插件添加到我的自定义目标平台。但是，尽管添加了插件，我仍然无法从 egit.ui 插件访问类的源代码。

我为源插件创建了以下清单：

```
Manifest-Version: 1.0
Eclipse-SourceBundle: org.eclipse.egit.ui;version="1.3.0.201202151440-r"
 ;roots="."
Bundle-Vendor: Eclipse Project
Bundle-Name: EGit Source
Bundle-SymbolicName: org.eclipse.egit.ui.source;singleton:=true
Bundle-Version: 1.3.0.201202151440-r
Bundle-ManifestVersion: 2 
```

我上传到Dropbox的插件文件本身：http: [//dl.dropbox.com/u/14767221/org.eclipse.egit.ui.source_1.3.0.201202151440-r.jar](http://dl.dropbox.com/u/14767221/org.eclipse.egit.ui.source_1.3.0.201202151440-r.jar)

当前源插件有什么问题？如何修复？修复这个插件或使用 eclipse 从 egit 源代码生成源插件更容易？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T00:28:14.573

一种可能的解决方案是按照建议的 Eshika 导入源：[如何将源绑定到插件](https://stackoverflow.com/questions/10323996/how-to-bind-source-to-plugin#comment13300918_10323996)

我通过从软件站点导入源代码插件以及包含二进制代码的普通插件解决了这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T17:57:01.743

如果您想快速查看而不添加源代码或根本没有源代码，有时在您的“工具箱”中有一个反编译器也很好。我使用： http://java.decompiler.free.fr/?q= [jdeclipse](http://java.decompiler.free.fr/?q=jdeclipse)安装在 eclipse 3.7.2 上。