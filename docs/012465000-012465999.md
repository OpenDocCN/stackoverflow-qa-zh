# StackOverflow 问答 12465000-12465999

# ios - 使用故事板将数据从第一个模式视图控制器传递到第二个模式视图控制器

> ID：12465000
> 
> 赞同：1
> 
> 时间：2012-09-17T18:19:54.433
> 
> 标签：ios, objective-c, cocoa-touch, storyboard, segue

我正在开发一个新的 iOS 应用程序我的情节提要中有一个视图控制器，它有一个文本字段。使用 UITextFieldDelegate，按键盘上的搜索后，我执行对表视图控制器的 segue。但是第二个表格视图控制器嵌入在导航视图控制器中。第一个视图控制器不是它的一部分。Segue 使用以下方法完成：

```
 UIStoryboard *storyboard = [UIStoryboard storyboardWithName:@"MainStoryboard" bundle:nil];
    UIViewController *vc = [storyboard instantiateViewControllerWithIdentifier:@"SearchTableViewController"];
    [vc setModalPresentationStyle:UIModalPresentationFlipHorizontal];

    [self presentModalViewController:vc animated:YES]; 
```

我想要做的是，将数据从第一个视图控制器的文本字段传递到 NSString 中的另一个视图控制器。我该怎么做呢？

在第一个文本字段上有一个 IBOutlet，searchField。而在第二个头文件中的一个属性

```
@property (nonatomic, strong) NSString *searchText. 
```

那么如何将 searchField.text 传递给 searchText？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T19:48:55.300

当您实例化您的视图控制器时，您应该将其转换为您的自定义视图控制器子类。如果这样做，您可以设置`searchText`属性值。

```
SearchTableViewController *vc = (SearchTableViewController*)[storyboard instantiateViewControllerWithIdentifier:@"SearchTableViewController"];

vc.searchText = self.searchField.text; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-30T19:33:56.080

另一种方法是：

```
 UINavigationController *nav  = [segue destinationViewController];
 [((YourViewController *) [nav.viewControllers objectAtIndex:0]) setObject: object]; 
```

# xslt - 使用 XSLT 从 XSLT 样式表中删除命名空间声明

> ID：12465002
> 
> 赞同：4
> 
> 时间：2012-09-17T18:20:02.553
> 
> 标签：xslt, xslt-1.0, xml-namespaces

我有一个 XSLT 样式表，如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="2.0"
                xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                  xmlns:XQHeaderFunc="java:com.sonicsw.xq.service.xform.HeaderExtension"
                  xmlns:saxon="http://saxon.sf.net/">

  <saxon:script language="java" implements-prefix="XQHeaderFunc" src="java:com.sonicsw.xq.service.xform.HeaderExtension" />

  <xsl:output indent="yes" omit-xml-declaration="yes"/>

  <xsl:template match="/">
    <xsl:variable name="processId" select="XQHeaderFunc:getProperty(XQHeaderFunc:new(),'processId',-1)" />
    <xsl:value-of select="XQHeaderFunc:setProperty(XQHeaderFunc:new(),'processId',string(@id),-1)"/>

    <root>
      <xsl:apply-templates />
    </root>

  </xsl:template>

  <!-- Other stuff -->

</xsl:stylesheet> 
```

我想使用第二个 XSLT 样式表转换此样式表，以删除与 XQHeaderFunc 和 saxon 命名空间有关的任何内容。有没有办法我可以做到这一点？

* * *

我现在尝试了以下方法，它成功地处理了元素，但命名空间声明似乎不想消失。

```
<xsl:stylesheet version="1.0"
                xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                xmlns:XQHeaderFunc="java:com.sonicsw.xq.service.xform.HeaderExtension"
                xmlns:saxon="http://saxon.sf.net/"
                exclude-result-prefixes="XQHeaderFunc saxon">

  <xsl:param name="XQHeaderReplacement" />
  <xsl:variable name="apos">'</xsl:variable>

  <!-- Copy all nodes -->
  <xsl:template match="node()|@*">
    <xsl:copy>
      <xsl:apply-templates select="node()|@*"/>
    </xsl:copy>
  </xsl:template>

  <!-- Remove saxon script tag -->
  <xsl:template match="saxon:script" />

  <!-- Remove elements with setProperty calls -->
  <xsl:template match="*[starts-with(@select, 'XQHeaderFunc:setProperty')]" />

  <!-- Replace getProperty calls with replacement value-->
  <xsl:template match="@select[starts-with(., 'XQHeaderFunc:getProperty')]">
      <xsl:attribute name="select">
        <xsl:value-of select="concat($apos, $XQHeaderReplacement, $apos)"/>
      </xsl:attribute>
    </xsl:template>
</xsl:stylesheet> 
```

输出：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="2.0" 
                xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 
                xmlns:XQHeaderFunc="java:com.sonicsw.xq.service.xform.HeaderExtension" 
                xmlns:saxon="http://saxon.sf.net/">

  <xsl:output indent="yes" omit-xml-declaration="yes" />

  <xsl:template match="/">
    <xsl:variable name="processId" select="''" />

    <root>
      <xsl:apply-templates />
    </root>

  </xsl:template>

  <!-- Other stuff -->

</xsl:stylesheet> 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-17T20:35:09.673

我会补充

```
 exclude-result-prefixes="foo" 
```

到你的

```
 <xsl:stylesheet> 
```

元素。`foo`然后，如果可能，将省略命名空间声明，即如果该命名空间中没有要输出的元素或属性。

仅供参考，这条线的原因

```
<xsl:template match="xsl:stylesheet/@xmlns:foo" />` 
```

抛出错误是因为`xmlns:foo`在输入文档中没有属性；这是一个伪属性。您的匹配模式要求匹配的是一个名为的属性，该属性`foo`位于与命名空间前缀相对应的命名空间中`xmlns`。由于您没有`xmlns`在样式表中声明命名空间前缀，因此您会收到错误“未定义前缀 xmlns”。

## 更新：

我从您发布的输出（和我自己的测试）中看到，`exclude-result-prefixes`在删除命名空间声明方面没有效果。

1）首先我会问为什么它很重要。它不会更改输出 XSLT 中任何内容的名称空间。您是否只是出于审美原因而试图将其删除？

2）查看[XSLT 1.0 规范，在我看来](http://www.w3.org/TR/xslt#copying)，`<xsl:copy>`没有注意`exclude-result-prefixes`：

> 实例化 xsl:copy 元素会创建当前节点的副本。当前节点的命名空间节点也会自动复制...

AFAICT，只有文字结果元素会省略基于`exclude-result-prefixes`.

在此基础上，我会尝试`<xsl:copy>`在您的身份模板（用于元素）中替换为它的`<xsl:element name="{name()}">`变体或变体。然后，您将需要一个单独的非元素节点标识模板。

我用以下两个模板替换了您的身份模板：

```
<!-- Copy elements -->
<xsl:template match="*" priority="-1">
   <xsl:element name="{name()}">
      <xsl:apply-templates select="node()|@*"/>
   </xsl:element>
</xsl:template>

<!-- Copy all other nodes -->
<xsl:template match="node()|@*" priority="-2">
   <xsl:copy />      
</xsl:template> 
```

这给出了我认为是所需的输出，没有多余的 ns 声明：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="2.0">
   <xsl:output indent="yes" omit-xml-declaration="yes" />

   <xsl:template match="/">
      <xsl:variable name="processId" select="''" />
      <root>
         <xsl:apply-templates />
      </root>
   </xsl:template>

   <!-- Other stuff -->
</xsl:stylesheet> 
```

（为了清楚起见，我调整了空格。）

# java - Java MouseEvent 位置不准确

> ID：12465003
> 
> 赞同：1
> 
> 时间：2012-09-17T18:20:03.580
> 
> 标签：java, mouse, jpanel, mouselistener, coordinate

我在 Java 中使用我创建的“画布”类（它是一个扩展`JPanel`的 ）来绘制动画环形图时遇到了问题。此图表使用 a`MouseListener`来获取点击事件。

问题是鼠标位置似乎不准确，这意味着它似乎与“画布”无关，而是相对于窗口（在左上角，y 坐标约为 30px）。

这是我的代码：

我创建了一个类，它扩展了 JPanel 并且确实有一个 BufferedImage 作为成员。

```
public class Canvas extends JPanel {

    public BufferedImage buf;
    private RingChart _parent;

    public Canvas(int width, int height, RingChart parent){
        buf = new BufferedImage(width, height, 1);
    ... 
```

在绘制组件方法中，我只绘制缓冲图像，因此我可以通过在公共的缓冲图像上进行绘制，从“外部”在画布上进行绘制。

```
public void paintComponent(Graphics g) {
        super.paintComponent(g);

        Graphics2D g2 = (Graphics2D)g; 
        g2.drawImage(buf, null, 0, 0); 

    } 
```

现在有一个包含“画布”的类 RingChart：

```
public class RingChart extends JFrame{

    public Canvas c;
    ... 
```

我从画布类中的 bufferedImage 创建了一个 Graphics2D。这个 g2d 用于绘画：

```
public RingChart(){
    c = new Canvas(1500,980,this);
    add(c);
    setSize(1500, 1000);
    setTitle("Hans");
    setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    g2d = (Graphics2D)c.buf.createGraphics();
    ... 
```

我现在想要实现的是一个鼠标监听器，它监听画布上发生的鼠标事件。因此，当用户单击画布时，我可以通过事件变量在画布上检索他单击的位置。

所以我创建了一个鼠标监听器：

```
class MouseHandler implements MouseListener {

    @Override
    public void mouseClicked(MouseEvent e){
        RingChart r = ((Canvas)e.getSource()).getParent();
        r.mouseClick(e);
    }
    ... 
```

...并将此鼠标侦听器添加到 RingChart 类的画布（myChart 是 RingChart 的一个实例，c 是它包含的画布）：

```
 ...
        MouseHandler mouse = new MouseHandler();
        myChart.c.addMouseListener(mouse);
        ... 
```

但正如我上面提到的，调用单击事件时返回的鼠标位置似乎并不准确。我认为错误一定是我创建那个mouseListener的方式，或者可能将它分配给错误的元素或类似的东西。但是我已经尝试了很多东西，但并没有改变。也许有人可以告诉我，我做错了什么？

更新：

作为 RingChart 成员并在鼠标侦听器中调用的函数“mouseClick”的代码：

```
public void mouseClick(MouseEvent evt){
    //evt = SwingUtilities.convertMouseEvent(this, evt, c);
    if(evt.getButton() == MouseEvent.BUTTON1 && animation == null){
        for(Element e : elements){
            if(e.getShape() != null && e.getShape().contains(evt.getPoint())){
                //do some stuff
            }
        }
    }
} 
```

同样，我的类的层次结构：RingChart --contains a--> Canvas --got a--> MouseListener。此函数中的形状是已在画布 c 上绘制的形状。现在我想检查用户是否点击了其中一个。所以正如我所想，形状应该在画布坐标中，事件位置应该在画布坐标中，一切都应该放在一起。但事实并非如此。现在用户 MadProgrammer 告诉我，使用 ConvertMouseEvent 函数。但我目前不知道应该以哪种方式明智地使用它。

更新：

我找到了一个解决方案：我所要做的就是不直接将画布添加到 the中，`JFrame`而是添加到 the`ContentPane`中`JFrame`：

所以与其：

```
public RingChart(){
    c = new Canvas(1500,980,this);
    add(c);
    ... 
```

我愿意：

```
public RingChart(){
    c = new Canvas(1500,980,this);
    getContentPane().add(c);
    ... 
```

然后我`MouseListener`给`ContentPane`.

```
getContentPane().addMouseListener(new MouseHandler());
getContentPane().addMouseMotionListener(new MouseMoveHandler()); 
```

我不知道这是否是一个优雅的解决方案，但它确实有效。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T20:21:51.483

鼠标事件会自动转换为相对于它发生的组件，即点 0x0 始终是组件的左上角。

通过使用`RingChart r = ((Canvas)e.getSource()).getParent()`，您有效地更改了引用，这意味着该位置不再有效。

您需要转换位置，使其坐标位于父组件的上下文中。看看[SwingUtilities.convertMouseEvent(Component, MouseEvent, Component)](http://docs.oracle.com/javase/7/docs/api/javax/swing/SwingUtilities.html#convertMouseEvent(java.awt.Component,%20java.awt.event.MouseEvent,%20java.awt.Component))

**更新图片**

让我们举这个例子......

![样本](../Images/225b4bf77cb9b968be0ff866d9f6eb66.png)

蓝色框与红色框的相对位置为 50px x 50px。如果您单击蓝色框，假设在 25x25，鼠标坐标将相对于蓝色框（0x0 将是蓝色框的左上角）。

如果您随后将此事件传递给红色框并尝试使用其中的坐标，您会发现坐标现在将位于红色框左上角和蓝色框之间的中间，因为坐标是上下文相关的。

为了让它工作，您需要将鼠标事件位置从蓝色框转换为红色框，这将使其成为 75x75

现在，当您将鼠标事件传递给时，我不知道您在做什么，`RingChart`所以我只是猜测这是您面临的问题。

**使用点击代码更新**

好吧，假设你有一个`Canvas`100x100 的图像。`Canvas`您在 50x50 处单击它。然后，您将该值传递回链。

```
public void mouseClick(MouseEvent evt){
    //evt = SwingUtilities.convertMouseEvent(this, evt, c);
    if(evt.getButton() == MouseEvent.BUTTON1 && animation == null){
        for(Element e : elements){
            // Here, we are asking the shape if it contains the point 50x50...
            // Not 150x150 which would be the relative position of the click
            // in the context to the RingChart, which is where all your objects
            // are laid out.
            // So even the original Canvas you clicked on will return 
            // false because it's position + size (100x100x width x height) 
            // does not contain the specified point of 50x50...
            if(e.getShape() != null && e.getShape().contains(evt.getPoint())){
                //do some stuff
            }
        }
    }
} 
```

**更新**

我认为你的参考文献是错误的......

```
public static MouseEvent convertMouseEvent(Component source,
                       MouseEvent sourceEvent,
                       Component destination) 
```

我认为它应该像

```
evt = SwingUtilities.convertMouseEvent(evt.getComponent(), evt, this); 
```

**更新代码示例**

好的，所以，我把这个小例子放在一起......

```
public class TestMouseClickPoint extends JFrame {

    private ContentPane content;

    public TestMouseClickPoint() throws HeadlessException {

        setSize(600, 600);
        setDefaultCloseOperation(EXIT_ON_CLOSE);
        setLocationRelativeTo(null);

        setLayout(new BorderLayout());

        content = new ContentPane();
        add(content);

    }

    protected void updateClickPoint(MouseEvent evt) {
        content.updateClickPoint(evt);
    }

    protected class ContentPane extends JPanel {

        private Point relativePoint;
        private Point absolutePoint;

        public ContentPane() {
            setPreferredSize(new Dimension(600, 600));
            setLayout(null); // For testing purpose only...

            MousePane mousePane = new MousePane();
            mousePane.setBounds(100, 100, 400, 400);

            add(mousePane);
        }

        protected void updateClickPoint(MouseEvent evt) {
            absolutePoint = new Point(evt.getPoint());
            evt = SwingUtilities.convertMouseEvent(evt.getComponent(), evt, this);
            relativePoint = new Point(evt.getPoint());

            System.out.println(absolutePoint);
            System.out.println(relativePoint);

            repaint();
        }

        protected void paintCross(Graphics2D g2d, Point p) {
            g2d.drawLine(p.x - 5, p.y - 5, p.x + 5, p.y + 5);
            g2d.drawLine(p.x - 5, p.y + 5, p.x + 5, p.y - 5);
        }

        /*
         * This is not recommended, but I want to paint ontop of everything...
         */
        @Override
        public void paint(Graphics g) {
            super.paint(g);

            Graphics2D g2d = (Graphics2D) g;

            if (relativePoint != null) {
                g2d.setColor(Color.BLACK);
                paintCross(g2d, relativePoint);
            }

            if (absolutePoint != null) {
                g2d.setColor(Color.RED);
                paintCross(g2d, absolutePoint);
            }

        }
    }

    protected class MousePane extends JPanel {

        private Point clickPoint;

        public MousePane() {

            addMouseListener(new MouseAdapter() {

                @Override
                public void mouseClicked(MouseEvent e) {
                    clickPoint = e.getPoint();
                    TestMouseClickPoint.this.updateClickPoint(e);
                    repaint();
                }
            });

            setBorder(new LineBorder(Color.RED));

        }

        @Override
        protected void paintComponent(Graphics g) {

            super.paintComponent(g);

            Graphics2D g2d = (Graphics2D) g;
            g2d.setColor(Color.BLUE);

            if (clickPoint != null) {
                g2d.drawLine(clickPoint.x, clickPoint.y - 5, clickPoint.x, clickPoint.y + 5);
                g2d.drawLine(clickPoint.x - 5, clickPoint.y, clickPoint.x + 5, clickPoint.y);
            }

        }
    }

    /**
     * @param args the command line arguments
     */
    public static void main(String[] args) {
        try {
            UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
        } catch (ClassNotFoundException ex) {
        } catch (InstantiationException ex) {
        } catch (IllegalAccessException ex) {
        } catch (UnsupportedLookAndFeelException ex) {
        }

        new TestMouseClickPoint().setVisible(true);
    }
} 
```

基本上，它将绘制三个点。鼠标被点击的点（相对于事件源）、父容器中未转换的点和父容器中的转换点。

![在此处输入图像描述](../Images/3a6c5dea971560f7a385edae23156f8f.png)

您需要做的下一件事是确定鼠标位置实际上已被转换，但失败了。我可能需要查看您的代码的工作示例以确定您实际在做什么。

# ios - CLLocationManager 编译器警告

> ID：12465006
> 
> 赞同：-1
> 
> 时间：2012-09-17T18:20:08.210
> 
> 标签：ios, cllocationmanager

我实现了以下几行以开始发送标题更新：

```
if ([locationManager headingAvailable])
    [locationManager startUpdatingHeading]; 
```

我收到一个编译器警告，上面写着：

> 标题可用已弃用

知道为什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T18:54:39.627

[文档](http://developer.apple.com/library/ios/#DOCUMENTATION/CoreLocation/Reference/CLLocationManager_Class/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/occ/instp/CLLocationManager/headingAvailable)对此非常清楚：

> （在 iOS 4.0 中**已弃用。请改用**`headingAvailable` **类方法**。）

现在`headingAvailable`是类方法（实际上更有意义），而不是实例方法。所以就这样使用它。

```
if ([CLLocationManager headingAvailable])
{
    [locationManager startUpdatingHeading];
} 
```

# java - Oracle WebLogic Server JAX-WS 错误代码

> ID：12465008
> 
> 赞同：1
> 
> 时间：2012-09-17T18:20:10.230
> 
> 标签：java, wcf, service, web, wcf-security

我们正在尝试从`C# WCF 4.0`客户端使用托管在 Oracle WebLogic Server（按照 JAX-WS 规范实施）上的 Java Web 服务。

服务器端跟踪上抛出的错误代码是

```
Error codes: 3001 3201 4008 4208 6408 Error code:3001 
```

我们无法弄清楚这些是什么意思？这些似乎没有记录。（我们可能错了或看错了地方）。

# objective-c - 为子视图应用头文件和实现文件

> ID：12465011
> 
> 赞同：2
> 
> 时间：2012-09-17T18:20:43.987
> 
> 标签：objective-c, ios, header, views, implementation

您可以使用创建子视图

```
myView *newView = [[myView alloc] initWithFrame:self.view.bounds];
[self.view addSubview:newView]; 
```

你也有它的实现和头文件。但是，视图不会自动在情节提要中弹出。如何将头文件和实现文件分配给我在情节提要中添加的视图？我对 Objective-C 和 iOS 开发非常陌生，所以尽量不要太复杂或技术性太强。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T18:33:51.963

在 Interface Builder 中，拖入一个自定义视图，然后在该视图的 Identity Inspector 上，在自定义类部分中，选择您的类。

# ruby-on-rails - 在 ActiveAdmin 中获取 Formtastic 以使用自定义表单输入构建器

> ID：12465020
> 
> 赞同：2
> 
> 时间：2012-09-17T18:21:31.873
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activeadmin, formtastic

**更新：**所以，我发现[了这个](http://rdoc.info/github/justinfrench/formtastic#Modified___Custom_Inputs)，显然这就是为什么这种旧的做事方式不起作用的原因，ActiveAdmin 必须使用 Formtastic 2.x。按照指示，我现在创建了一个`app/inputs/date_picker_input.rb`如下所示的文件：

```
class DatePickerInput
  include Formtastic::Inputs::Base

  def to_html
    puts "this is my datepickerinput"
  end
end 
```

我的控制器现在看起来像这样：

```
 f.input :open_date, :as => :date_picker
  f.input :close_date, :as => :date_picker 
```

但现在我遇到了这个错误：

`ActionView::Template::Error (undefined method 'html_safe' for nil:NilClass): 1: render renderer_for(:edit)`

有什么想法吗？

当我尝试渲染时，我遇到了 Formtastic 自动将日期格式化为我不想要的格式（Ymd h:i:s Z）的问题，`:as => string`因此我可以在该字段上使用日期选择器。在试图解决这个问题时，我遇到了[这个解决方案](https://groups.google.com/forum/?fromgroups=#!topic/formtastic/P78txfizLtM)。

这似乎是有道理的，并且与我正在处理的问题完全相同。但是，我似乎无法实施修复，我想知道是不是因为通过 ActiveAdmin 使用了 Formtastic。所以，这就是我试图做的：

在控制器中，我将方法更改为：

`f.input :open_date, :as => :date`

我也试过这个，虽然我的问题甚至无法达到这一点：

`f.input :open_date, :as => :date_input`

我`lib/datebuilder.rb`使用以下代码创建了一个文件：

```
class DateBuilder < Formtastic::SemanticFormBuilder 
  def date_input(method, options) 
    current_value = @object.send(method) 
    html_options ||= {:value =>  current_value ? I18n.l (current_value) : @object.send("#{method}_before_type_cast")} 
    self.label(method, options.delete(:label), options.slice (:required)) + 
    self.send(:text_field, method, html_options) 
  end 
end 
```

我不确定是否会根据需要修复格式，但我假设如果我可以让 Formtastic 使用这种方法，我可以根据需要更改它（目前是从上面链接中提到的解决方案中获取的）。

[本文](http://ballardhack.wordpress.com/2011/02/10/adding-a-custom-jquery-ui-control-to-formtastic-in-ruby-on-rails/)提到您需要在您的 formtastic 初始化程序中添加一行以使用此自定义输入：

`Formtastic::SemanticFormHelper.builder = Formtastic::DateBuilder`

我没有这个初始化文件，`config/initializers`所以我`config/initializers/formtastic.rb`在上面的行中添加了它（）。我现在遇到的问题是尝试启动 Rails 应用程序时出现此错误：

`../config/initializers/formtastic.rb:1:in '<top (required)>': uninitialized constant Formtastic::SemanticFormHelper (NameError)`

我也在该文件中尝试了这种语法：

```
module Formtastic
  module SemanticFormHelper
    self.builder = DateBuilder
  end
end 
```

这给了我这个错误：`../config/initializers/formtastic.rb:3:in '<module:SemanticFormHelper>': uninitialized constant Formtastic::SemanticFormHelper::DateBuilder (NameError)`

如果我以完全错误的方式处理此问题，请告诉我，否则任何帮助 Formtastic 使用此自定义输入类型的帮助都将是惊人的！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-17T19:54:01.623

好吧，终于找到了正确的方法。

我的控制器与上面在更新中看到的保持一致。但是，我将 DatePicker 自定义输入文件 ( `app/inputs/date_picker_input.rb`) 更改为如下所示：

```
class DatePickerInput < Formtastic::Inputs::StringInput
  def to_html
    "<li class='string input required stringish' id='question_#{method.to_s}_input'>" +
    "<label class=' label' for='question_#{method.to_s}'>#{method.to_s.gsub!(/_/, ' ').titleize}*</label>" +
    "<input id='question_#{method.to_s}' name='question[#{method.to_s}]' type='text' value='#{object.send(method)}' class='hasDatePicker'>" +
"</li>"
  end
end 
```

Hopefully this will help someone else running into the same problem! Btw, the hard-coded "question" and "required" is because I will only use this custom input on question objects. There is likely a way to dynamically get this information, but I decided against putting more work in to figure that out (this was enough of a headache on its own!)

# php - php & mysql 查询 - 无法从 MySQL 返回我需要的变量

> ID：12465022
> 
> 赞同：1
> 
> 时间：2012-09-17T18:21:40.603
> 
> 标签：php, mysql, syntax-error

**更新**：在 $_GET 变量的一些随附验证中必须存在轻微的语法错误。我仔细重写了所有内容，脚本现在可以正常工作。谢谢你们！

我花了 5 个多小时试图找出我的代码有什么问题。

第一页：数据库查询从数据库中检索一些 vimeo 视频，并为每个视频提供一个“编辑”链接，该链接动态获取视频的 id（vimeo 8 位 id）。为此，我只需调用以下函数：

```
function edit_portfolio_videos() {
global $connection;
$query = "SELECT * FROM portfolio_videos ORDER BY video_id ASC";
$portfolio_videos_set = mysql_query($query, $connection);
confirm_query($portfolio_videos_set);
while ($portfolio_video = mysql_fetch_array($portfolio_videos_set)) {
    echo "<iframe src=\"http://player.vimeo.com/video/";
    echo $portfolio_video['video_code'];
    echo "?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff\" width=\"400\" height=\"230\" frameborder=\"0\" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe><br />";
    echo "<a href=\"edit_portfolio_video.php?videocode={$portfolio_video['video_code']}\">Edit this Video</a>";
    }
} 
```

第二页：这是每个视频将由管理员编辑的页面。示例 URL 类似于“http://www.my_website.com/edit_portfolio_video.php?videocode=34956540”。在此页面上，我使用以下函数从上一页的脚本中获取数组：

```
function get_selected_video_by_id($video_code) {
global $connection;
$query = "SELECT * FROM portfolio_videos ";
$query .= "WHERE video_code = '$video_code' ";
$query .= "LIMIT 1";
$videos_set = mysql_query($query, $connection);
confirm_query($videos_set);
if ($video = mysql_fetch_array($videos_set)) {
    return $video;
} else { $video = NULL; } 
```

}

接着...

```
$selected_video = get_selected_video_by_id($_GET['videocode']); 
```

为了将与所选视频相关的各种数据放入编辑表单中：

```
<form action="edit_portfolio_video.php?videoid=<?php echo $selected_video['video_code']; ?>" method="post">
            <input type="text" name="video_title" value="<?php echo $selected_video['video_title']; ?>" />  
            </p>
            <p>Video Code (vimeo):<br />
            <input type="text" name="video_code" value="<?php echo $selected_video['video_code']; ?>" />
            </p>
            <p>Video Description:<br/>
            <textarea name="video_description" rows="5" cols="70"><?php echo $selected_video['video_description']; ?></textarea>    
            </p>
            <p>
            <input type="submit" name="submit" value="Save Video" />    
            </p>
</form> 
```

但是表单的字段没有被填充，因为我试图获取的 $video 变量似乎存在问题（从 get_selected_video_by_id 函数返回）。视频代码在数据库中存储为“INT”（长度：11），并在第二页的 URL 中打印为字符串。我尝试以多种方式编写函数的查询，但我无法让它工作。

我会很感激这方面的帮助，谢谢大家。

注意：confirm_query 函数做这个简单的工作：

```
function confirm_query($result_set) {
if (!$result_set) {
    die("Database query failed: " . mysql_error());
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T19:01:43.710

您的表单看起来很奇怪：您正在使用 POST 模式来传递 GET 值（edit_portfolio_video.php?videoid=...等...）。但这不应该是问题。

在这一行：

`$selected_video = get_selected_video_by_id($_GET['videocode']);`

你确定你传递的 GET 参数是视频代码吗？还是videoid？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T18:44:49.177

我认为您应该为您的 get_selected_video_by_id SQL 查询尝试这个。

```
$query = "SELECT * FROM portfolio_videos WHERE video_code = ".$video_code; 
```

当然要注意参数中的 SQL 注入，而且，正如有人已经建议的那样，请考虑使用 PDO 或 MySQLi。

# .net - GetHashCode() 值对于字符串对象是否唯一？

> ID：12465025
> 
> 赞同：2
> 
> 时间：2012-09-17T18:21:44.453
> 
> 标签：.net, string, unique, hashcode

谁能帮我理解 GetHashCode() 方法如何处理字符串值？

从[MSDN](http://msdn.microsoft.com/en-us/library/system.string.gethashcode.aspx)我发现：

*如果两个字符串对象相等，则 GetHashCode 方法返回相同的值。但是，每个唯一的字符串值都没有唯一的哈希码值。不同的字符串可以返回相同的哈希码。*

所以，**不同的字符串可以返回相同的哈希码**，哈希码对于字符串来说不是唯一的。它会导致程序核心出现错误吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T18:23:52.657

如果您假设匹配的哈希码意味着匹配的字符串，则可能会导致错误。通常，您使用哈希码将字符串分类到存储桶中，以便快速搜索和选择。如果您检测到两个字符串具有匹配的哈希码，那么您通常会比较字符串本身是否相等。

如果这不能回答你的问题，那么我不明白这个问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-17T18:24:35.890

好吧，如果您的算法依赖于每个字符串具有唯一的哈希值，这可能会导致错误。

例如，哈希映射（.NET 中的字典）可能会因冲突而失败（即具有相同哈希但不相等的两个对象），或者它在处理冲突时不会失败，这取决于确切的实现。在这种情况下失败意味着：如果您向映射添加一个新对象，并且映射中已经有一个对象与新对象具有相同的哈希值，那么新对象将覆盖旧对象，而不是仅仅被添加。据我所知，.NET 中的 Dictionary 类可以处理冲突。

如果您需要更具体的建议，您需要提出一个更具体的问题：您要存档什么，您打算如何存档等。

作为旁注：字符串的哈希值通常不是唯一的，因为哈希值的大小是有限的，而字符串的长度不是。可以这样想：假设哈希函数是 MD5（它不是 .Net 中的默认值），并且您有一个字符串都由十六进制字符（0-9A-Z）组成，并且字符串长度为 200 个字符：有字符串有 200^16 个可能的值，但其哈希值只有 32^16 个可能的值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-17T18:28:51.323

> 所以，不同的字符串可以返回相同的哈希码，哈希码对于字符串来说不是唯一的。它会导致程序核心出现错误吗？

如果哈希值按预期使用，它不应该导致错误。返回的`GetHashCode()`哈希并不是为了提供唯一的哈希——这是不可能的，因为只有大约 40 亿个可能的哈希码（因为该方法返回一个`Int32`），但可能的字符串数量是无限的。

哈希旨在提供*很少的*集合，而不是没有冲突。因此，您*永远*不应假设哈希是基于值的*唯一表示。*您得到的唯一保证是两个不同字符串的两个不同哈希码意味着字符串不相等，因为两个相等的值应该始终产生相同的哈希。然而，两个相等的哈希码并不一定意味着两个字符串值相等。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-17T18:29:17.317

Hashcode 用于加快在 Hash 集合中搜索对象的速度。在内部，它们将对象存储在许多桶中。持有的对象根据其哈希码分为桶。因此，例如，当您打电话时

`var value = Dictionary["someKey"]`

字典而不是在所有内部存储桶中搜索，而是直接转到应该在该键下包含值的存储桶。字典搜索只在那个桶里。

也许这不完全是它的实现方式，但它或多或少应该是它。所以在这种情况下，字典中的不同键具有相同的哈希码并不重要。这仅意味着该键下的值将最终在同一个存储桶中。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-09-17T18:31:13.947

实际上，该文档对方法所做的保证非常准确。哈希码只是遵循以下两条规则（为便于阅读，`a == b`参考`a.Equals(b)`，`#a`参考）：`a.GetHashCode()`

*   如果`a == b`那么`#a == #b`
*   如果`#a != #b`那么`a != b`

请注意，这*不是*`Equals`和匹配哈希之间的等价。如果您依赖的不止于此，那么您的代码显然有错误。`GetHashCode`旨在将对象用作字典中的键，以便从对象快速映射到数字，但它不需要是可逆的。如果您查看字符串，您可以很容易地看到可能的字符串数量很快超过了可能的哈希码数量，因此您可以自己回答这个问题。您已经超过了 2 ^(32 个)可能的字符串，并且已经超过了两个字符。

# java - 在云上部署 Web 服务

> ID：12465026
> 
> 赞同：2
> 
> 时间：2012-09-17T18:21:48.650
> 
> 标签：java, web-services, jax-ws, amazon

开发了一个网络服务，以下是步骤

1）创建一个Web服务端点接口..

```
import javax.jws.WebMethod;
import javax.jws.WebService;
import javax.jws.soap.SOAPBinding;
import javax.jws.soap.SOAPBinding.Style;

//Service Endpoint Interface
@WebService
@SOAPBinding(style = Style.RPC)
public interface HelloWorld{

    @WebMethod String getHelloWorldAsString(String name);

} 
```

2.创建一个Web服务端点实现..

```
import javax.jws.WebService;

//Service Implementation
@WebService(endpointInterface = "com.abc.ws.HelloWorld")
public class HelloWorldImpl implements HelloWorld{

    @Override
    public String getHelloWorldAsString(String name) {
        return "Hello World JAX-WS " + name;
    }

} 
```

1.  创建端点发布者...

导入 javax.xml.ws.Endpoint；导入 com.abc.ws.HelloWorldImpl；

```
//Endpoint publisher
public class HelloWorldPublisher{

    public static void main(String[] args) {
       Endpoint.publish("http://localhost:9999/ws/hello", new HelloWorldImpl());
    }

} 
```

现在，我还通过 URL “http://localhost:9999/ws/hello?wsdl” 访问生成的 WSDL（Web 服务定义语言）文档来测试部署的 Web 服务。

但是我的疑问是，当我刚接触云世界时，我想将我的 web 服务部署到像亚马逊这样的云上，这样如果我向世界上的任何人提供 wsdl，他就可以在我的 web 服务部署时通过他的浏览器访问我的 wsdl在云上。

请告诉我如何实现这一目标.. !!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-27T18:58:21.560

当您将应用程序部署到云上的真实服务器时，此方法将不起作用，因为您无法执行`main`发布 Web 服务的方法。

当您的应用程序在服务器上启动时，您需要配置一些东西来发布您的 Web 服务。

例如，使用 Spring，要在 Tomcat 上运行 SOAP Web 服务，您需要注入您的 WS bean 并使用`SimpleJaxWsServiceExporter`bean 来发布它，这些配置在您`application-context.xml`或等效设备上实现。

在您的情况下，请查看此[链接](http://www.mkyong.com/webservices/jax-ws/deploy-jax-ws-web-services-on-tomcat/)，它是如何使用 JAX-WS RI 分发发布 WSDL Web 服务的示例。

对于测试，您可以将 WAR 应用程序部署到[Openshift](https://www.openshift.com/)。

希望它有所帮助，最好的问候。

# sql-server - 我在哪里可以找到 sql server 2005 的数据库/表文件？

> ID：12465027
> 
> 赞同：0
> 
> 时间：2012-09-17T18:21:48.940
> 
> 标签：sql-server, database, sql-server-2005, portability

在我的 sql server 2005 中，我有一个名为*movies*的数据库。在这个数据库中，我有一个名为*list*的表。我想在另一台机器上测试我的应用程序。有什么方法可以随身携带该数据库或表，以便无需在那里再次创建它们。除了重新创建新的数据库和表之外，如果有其他出路，它们是什么类型的文件

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T18:23:15.547

您可以做的一件事是对数据库进行本地备份（如果您希望所有事务也包括事务日志文件）。然后将该 .BAK 文件放在拇指驱动器上并转到另一台机器。在另一台机器上，您可以“恢复”.BAK 作为这台新机器上的数据库。

这是“备份...”和恢复选项的屏幕截图：

![在此处输入图像描述](../Images/f5ea41eb26edeb46e33da8aa545be050.png)

您首先需要将其备份到网络位置，甚至备份到第一台机器的桌面上。进行备份时，您可以保留大部分默认设置，我建议您使用“完整备份”。单击确定后，它将生成一个 Database.BAK 文件。然后，您可以在另一台机器上执行“还原”时使用此文件。还原可以在这第二台机器上具有相同的数据库名称或不同的数据库名称。

# regex - Perl 中的匹配计数

> ID：12465028
> 
> 赞同：0
> 
> 时间：2012-09-17T18:21:51.687
> 
> 标签：regex, perl, hash

我有一个带有各种关键字的哈希。现在，我想在字符串中找到这些关键字的计数。

我刚刚用 foreach 循环编写了部分代码。

```
use strict;
use warnings;

my $string = "The invitro experiments are conducted on human liver microsom. "
          . " These liver microsom can be cultured in rats.";

my %hash = (
    "human"     => 1,
    "liver"     => 1,
    "microsom"  => 1,
);

for my $nme (keys %hash){
        # Some code which I am not sure
} 
```

预期输出：`human:1; liver:2; microsom:3`

有人可以帮助我吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T19:06:37.067

以下代码段应该足够了。

```
#!/usr/bin/perl -w

use strict;

my $string="The invitro experiments are conducted on human liver microsom. These liver   microsom can be cultured in rats.";

my %hash = (
'human' => 1,
'liver' => 1,
'microsom' => 1,
);

my @words = split /\b/, $string;

my %seen;

for (@words) {
    if ($_ eq 'human' or $_ eq 'liver' or $_ eq 'microsom') {
        $seen{$_}++;
    }
}

for (keys %hash) {
    print "$_: $seen{$_}\n";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T19:17:01.603

可能不是解决此问题的最佳方法，但它应该可以工作。

```
my $string = "The invitro experiments are conducted on human liver microsom. These liver microsom can be cultured in rats.";

my %hash = (
    'human' => 1,
    'liver' => 1,
    'microsom' => 1,
);

foreach my $nme (keys %hash){
    $hash{$nme} = scalar @{[$string =~ /$nme/g]};
    print "$hash{$nme}\n";
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T18:25:24.223

那是家庭作业吗？:) 好吧，取决于散列中的单词数和字符串（字符串）中的单词数，它会更好地迭代散列，或者迭代字符串中的单词，找到时增加适当的值。由于您需要检查所有单词，因此您将以一个列表结尾，其中一些标记为“0”，一些标记为大于零。

# parameter-passing - Joomla 2.5：将参数传递给联系表格

> ID：12465032
> 
> 赞同：0
> 
> 时间：2012-09-17T18:22:16.117
> 
> 标签：parameter-passing, joomla2.5, contact-form

我有一个临时组件来管理车辆，如果用户想要有关车辆的更多信息，我想将他重定向到一个联系表单，将车辆的 ID 作为参数传递给表单，以便事先获取车辆的名称和其他信息发送邮件。我怎样才能做到这一点？现在我正在使用 Fox 联系表，但如果有更好的选择，我可以更改它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T15:19:53.810

我不熟悉 Fox Contact Form 的功能，但我们在几个使用 ChronoForms 的汽车网站上正是这样做的。这是一个两步的过程。首先，您必须决定如何打包原始页面上的信息。

如果更多信息是一个链接，那么您需要将信息作为查询字符串的一部分传递给表单。您的链接必须形成如下：

```
http://www.yoursite.com/index.php?option=com_chronoforms&view=form&year=2000&make=Ford&model=Mustang 
```

您可以添加任意数量的参数以传递给表单。

如果更多信息可以提交到表单中，那么您可以将隐藏字段添加到表单中，其中包含您要传递给联系表单的所有数据。

任务的第二部分是向联系表单中的字段添加一些代码，以便项目自动填充到表单中。例如：

```
<input type="text" name="year" value="<?php JRequest::getVar('year',''); ?>">
<input type="text" name="make" value="<?php JRequest::getVar('make',''); ?>">
<input type="text" name="model" value="<?php JRequest::getVar('model',''); ?>"> 
```

这将为您提供用户随后可以编辑的输入字段，但您可以轻松地将字段设置为只读或隐藏字段而不是文本框。

# ios - iOS PDF 到纯文本解析器

> ID：12465034
> 
> 赞同：2
> 
> 时间：2012-09-17T18:22:20.450
> 
> 标签：ios, pdf, text, extract, cgpdf

我在这个问题上很迷茫。我已经阅读了几乎所有关于它的帖子，如果有人能将我推向正确的方向，我将非常感激。

我有一个 PDF，我想提取它的文本，我只对单词和空格感兴趣。我已经设置了一个 CGPDFScanner 和它的回调方法。我读到的是，就提取文本而言，我只需要考虑 4 个运算符 TJ、Tj、qout(') 和 doubleqout(")。

我想我还需要跟踪文本空间，以便能够确定字母是应该放在一起形成一个单词还是应该用空格分隔。但我不知道我将如何做到这一点。

在 PDF 中，所有文本都采用格式

```
[(X)-24.2524(X)-24.2524(X)-24.2524(Y)-24.2524(Y)-24.2524]TJ 
```

但我无法弄清楚（使用 PDF 规范）这些数字的含义。SO上有人说你不应该害怕PDF规范，但坦率地说，我觉得它们不太容易阅读/理解。

我研究了有用的 PDFKitten 代码。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-17T18:39:45.547

我不能给你建议如何从 PDF 中提取单词，但是格式

```
[(X)-24.2524(X)-24.2524(X)-24.2524(Y)-24.2524(Y)-24.2524]TJ 
```

例如，在[PDF 1.7 Specification](http://wwwimages.adobe.com/www.adobe.com/content/dam/Adobe/en/devnet/pdf/pdfs/PDF32000_2008.pdf)的“9.4.3 Text-Showing Operators”部分中进行了解释。运营商的描述`TJ`是：

> 显示一个或多个文本字符串，允许单独的字形定位。数组的每个元素应为字符串或数字。如果元素是字符串，则此运算符应显示字符串。如果是数字，则操作者将文本位置调整该数量；也就是说，它将翻译文本矩阵 Tm。数字应以文本空间单位的千分之一表示。

所以数字是对字母之间距离的调整。

# android - Facebook JSON Parser（Android）不返回相册中的所有照片

> ID：12465040
> 
> 赞同：2
> 
> 时间：2012-09-17T18:22:49.357
> 
> 标签：android, facebook, json, parsing

我正在尝试编写一个从某个组页面的相册中检索所有照片的应用程序。我正在使用 Facebook SDK 来检索 JSON 数据。获取专辑列表有效，但问题在于获取照片。在用户从微调器列表中选择一张专辑后，它应该使用 Facebook SDK 使用专辑 ID 检索该专辑的 JSON 数据，然后从该数据中获取所有“源”字段以获取指向的链接图片。不幸的是，这不能正常工作。例如，当我加载 Wall Photos 时，我只得到 1 张照片。当我加载其他一些相册时，我没有得到任何图片。我得到 3 张照片的情况很少见。

这是我的项目文件夹的链接 [http://www.shadownet.net76.net/safe/bm.zip](http://www.shadownet.net76.net/safe/bm.zip)

# c# - 插入删除反斜杠

> ID：12465043
> 
> 赞同：0
> 
> 时间：2012-09-17T18:23:09.070
> 
> 标签：c#, .net, entity-framework

使用实体框架，我插入了一个所有引号都转义的 json 字符串。
例如：

`"{\"PDFName\":\"Test \",\"PDFDesc\":\"test desc\"}"`

在插入之前以某种方式从我的字符串中删除了反斜杠，并且数据库中的值是：

`"{"PDFName":"Test ","PDFDesc":"test desc"}"`

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T18:25:19.297

听起来你错过了一级“逃脱”。即再次转义你的字符串（基本上用 ; 替换所有的`\`，`\\`但也不要忘记非转义的 " ）。

在其他情况下也会发生类似的事情，例如在 SQL 语句中使用字符串时，

# php - php图像复制/裁剪/调整内存限制

> ID：12465046
> 
> 赞同：2
> 
> 时间：2012-09-17T18:23:12.300
> 
> 标签：php, image-processing, gd

> **可能重复：**
> [PHP 重建图像：内存使用](https://stackoverflow.com/questions/7092404/php-rebuilding-images-memory-usage)

我有一个简单的图片上传脚本。允许用户上传最大文件大小为 10MB 的图像（gif、jpg 或 png）。用户还可以对图像应用裁剪，因此我将脚本的内存限制设置为 256MB。我认为 256MB 的内存足以裁剪 10MB 的图像。我错了。当用户上传一张大图像（大约 5000x5000）并且几乎没有裁剪它时，脚本总是会抛出内存不足的错误。我发现[这个简洁的工具](http://www.dotsamazing.com/en/labs/phpmemorylimit)可以帮助确定使用 php 调整图像大小时的内存限制。我也遇到过这个公式

```
$width * $height * $channels * 1.7 
```

以确定图像需要多少内存。我正在找人解释这里发生了什么。我很清楚 10MB jpeg 在加载到内存时不是 10MB，但是我如何确定它将占用多少内存？上面的公式正确吗？有没有更有效的方法来裁剪大图像，还是我必须使用大量内存？

对于任何感兴趣的人，这里是裁剪图像的代码。

```
function myCropImage(&$src, $x, $y, $width, $height) {
    $src_width = imagesx($src);
    $src_height = imagesy($src);

    $max_dst_width = 1024;
    $dst_width = $width;

    $dst_height = $height;
    $max_dst_height = 768;

    // added to restrict size of output image.
    // without this check an out of memory error is thrown.
    if($dst_width > $max_dst_width || $dst_height > $max_dst_height) {
        $scale = min($max_dst_width / $dst_width, $max_dst_height  / $dst_height);
        $dst_width *= $scale;
        $dst_height *= $scale;
    }

    if($x < 0) {
        $width += $x;
        $x = 0;
    }
    if($y < 0) {
        $height += $y;
        $y = 0;
    }

    if (($x + $width) > $src_width) {
        $width = $src_width - $x;
    }

    if (($y + $height) > $src_height) {
        $height = $src_height - $y;
    }

    $temp = imagecreatetruecolor($dst_width, $dst_height);
    imagesavealpha($temp, true);
    imagefill($temp, 0, 0, imagecolorallocatealpha($temp, 0, 0, 0, 127));
    imagecopyresized($temp, $src, 0, 0, $x, $y, $dst_width, $dst_height, $width, $height);

    return $temp;
} 
```

# eclipse - Eclipse：在持久性单元中未定义名为“system-uuid”的生成器

> ID：12465048
> 
> 赞同：15
> 
> 时间：2012-09-17T18:23:15.570
> 
> 标签：eclipse, hibernate, persistence.xml

我有一个启用 Maven 的项目导入 Eclipse。从 Eclipse 中，我在以下行的 system-uuid 部分收到错误“没有名为“system-uuid”的生成器在持久性单元中定义”：

```
@Id @GeneratedValue(generator = "system-uuid")
@GenericGenerator(name = "system-uuid", strategy = "uuid")
@Column(length = 36)
public String getId() {
    return id;
} 
```

该项目从命令行正确构建。是什么导致 Eclipse 生成此错误，我该如何解决？

持久性文件看起来像这样..

```
<persistence xmlns="http://java.sun.com/xml/ns/persistence"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/persistence 
    http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd"
    version="1.0">
    <persistence-unit name="xxxx"/>
</persistence> 
```

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-09-18T01:27:39.423

您可以通过将错误“生成器未在持久性单元中定义”更改为警告，在“查询和生成器”下的“首选项”->“Java 持久性”->“JPA”->“错误/警告”下关闭/关闭错误。

这看起来像是 Eclipse 中 Dali 的 Hibernate Tools 扩展中的一个错误。您可以将此报告给 Hibernate Tools，或者这可能已在更新的版本中得到修复。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2017-05-31T11:25:39.953

Eclipse Luna：这似乎有效

```
Project -> Clean 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-08-05T08:51:34.667

较新版本的 Eclipse 的 JPA 支持似乎取决于注释的顺序。在您尝试使用 em 之后，您正在定义生成器。

这将起作用：

```
@Id
@GenericGenerator(name = "system-uuid", strategy = "uuid")
@GeneratedValue(generator = "system-uuid")
@Column(length = 36)
public String getId() {
    return id;
} 
```

然而，Java 中注解的顺序必须没有意义。所以凯伦是对的，这似乎是一个错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-01-12T09:26:16.717

从 github 导入我的项目后，我在 eclipse mars 中使用了我的自定义 id 生成器几乎相同的错误。

错误： **在持久性单元中没有定义名为“idGenEchantillon”的生成器**

所以我的回答并不是针对主要问题，而是针对与我有相同错误的其他开发人员，可以在这里看到。

编码 ：

```
@Id
@GenericGenerator(name = "idGenEchantillon", strategy = "com.labo.model.KeyGenaratorForEchantillon")
@GeneratedValue(generator ="idGenEchantillon")
@Column(name = "ID_ECHANTILLON", length = 12)
private String idEchantillon; 
```

我使用 maven 来管理依赖项。

1.  我已经从我的项目中删除了 JPA 方面 => 每次我使用 Maven 更新我的项目时，项目都会再次使用 JPA 方面 => 错误仍然存​​在。
2.  我禁用了 Maven 的“JPA Configurator”选项：Window >> Preferences >> Maven >> Java EE Integration，然后取消选中“JPA CONFIGURATOR”，之后我使用 Maven 更新了我的项目 => 错误消失了。

# php - php中的输出缓冲具有高命中率

> ID：12465050
> 
> 赞同：0
> 
> 时间：2012-09-17T18:23:23.467
> 
> 标签：php, performance, buffer

我有一个每天有 200 000 次访问的网站，并且使用 php 输出缓冲区，我有一个问题：

有了这些命中数，是否使用输出缓冲？

我使用 MVC 框架，我应该使用输出缓冲区！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T18:30:14.343

输出缓冲永远不会受到伤害，具体取决于您正在缓存的内容以及您是否希望它过期。我会使用 Memcache 或 APC，将您的页面缓存一段时间。使用传统的密钥系统在每个页面或资源上获取正确的标识符，并在更新某些内容时创建触发器以自动重置缓存。（例如使用 PEAR 守护程序）

如果数据库利用率很高，我会缓存数据集并让页面自然服务。使用 APC，您已经释放了大量 I/O 资源。

# java - 如何为井字游戏逻辑引用 JButtons 对象（Java 中的井字游戏）

> ID：12465051
> 
> 赞同：2
> 
> 时间：2012-09-17T18:23:37.663
> 
> 标签：java, swing, object, reference, jbutton

我正在开发井字游戏。我添加了 9 个带有 ActionListener 的 JButton。每个按钮都正确地监听动作事件。最后，我正在研究游戏的逻辑组件，但我被困在如何去做。

如果您看一下我的 TicTacToeButton 类，我决定为扩展 JButton 的 TicTacToeButton 对象提供两个实例变量：一个表示按钮编号的整数变量（所以我知道按下了哪个按钮。数字零是第一个数字) 和一个字符变量，它将被分配一个“o”字符到字符数组中，该数组称为 boardLogic 用于玩家 1 和“x”用于玩家 2。

问题是我不知道如何在我的 TicTacToeBoard 类中的 TicTacToeButton 数组中引用我的元素来执行游戏中实际按下的 JButton。Java 对象中是否有一个方法可以告诉您是按下了编号为 0 的 JButton 还是按下了编号为 1 的 JButton，这与我在下面说明的代码相对应。

```
import java.awt.BorderLayout;
import java.awt.Container;
import java.awt.Dimension;
import java.awt.GridLayout;
import java.awt.Point;
import javax.swing.JFrame;
import javax.swing.JPanel;

/*
 * The TicTacToeBoard is an object that has characterisitics of a JFrame 
 */
public class TicTacToeBoard extends JFrame {

    /* create an array of characters that holds 9 elements 
     *  to create a model for the tic-tac-toe board logic since the board has 9 boxes
     *  create the board from a separate class to minimize bugs and for easier debugging
     *  simulate the game's logic by creating an array of characters
     */
    public static char[] boardLogic = {};
    // number of buttons in the game
    static int numOfButtons = 9;
    // TicTacToeButton is an object that extends JButton
    static TicTacToeButton[] buttons;

    public TicTacToeBoard() {
        // setTitle to the frame
        setTitle("TicTacToe Game");
        /* call this method to the GameFrame object if you do not call this 
         * method the JFrame subclass will not actually close
         */
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        /* set size to an appropriate size create a dimension object 
         * notice my Dimension object does not have a variable this is 
         * a prefer way to create this object since no further 
         * operations will be perform on this object besides this operation 
         */
        setSize(new Dimension(1000, 1000));
        // upon creating the object set the location of the frame to the center of the screen
        setLocation(new Point(0, 0));
        // prevent the user from resizing the GameFrame object
        // uncomment bottom to prevent window maximumization 
        //setResizable(false);
    }

    public void printButtons(Container contentPane) {
        JPanel gamePanel = new JPanel();
        gamePanel.setLayout(new GridLayout(3, 3));
        // the idea of boardLogic is creating a 9 element character array to simulate the game's logic
        boardLogic = new char[numOfButtons];
        // creates the objects of the type JButtons
        buttons = new TicTacToeButton[numOfButtons];
        // create 9 buttons for the game using a for loop
        for (int i = 0; i < buttons.length; i++) {
            // create a new JButton object every loop   
            buttons[i] = new TicTacToeButton(i);
            // set a default value. I use '-' for simplicity.
            boardLogic[i] = buttons[i].getButtonChar();
            // and add it to the frame
            gamePanel.add(buttons[i]);
        }
        contentPane.add(gamePanel, BorderLayout.CENTER);
    }
} 
```

.

```
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.ImageIcon;
import javax.swing.JButton;

/* the class design is that we will create a class that has characteristics
 * of what a JButton can do but can also hear for action events
 */
public class TicTacToeButton extends JButton implements ActionListener {

    /* referring my Buttons with names denoted as String type
     * set it empty for now. I will name the JButtons using a for loop
     * the program will use buttonNumber assigned to each button
     * to create the game's logic
     */
    private int buttonNumber = 0;
    // Each character assigned to each button is assigned a hyphen by default
    private char buttonChar = '-';

    public TicTacToeButton(int buttonNumber) {
        // call the JButton super class constructor to initialize the JButtons
        super();
        // set the name of the parameter to the data member of the JButton object 
        this.buttonNumber = buttonNumber;
        // upon creating of the JButton the button will add ActionListener to itself
        addActionListener(this);
    }

    // a get method that retrieves the button's object data member
    public int getButtonNumber() {
        return buttonNumber;
    }

    // everytime the user press a button set the number 10 as the button number
    public void setButtonChar(char buttonChar) {
        if (buttonChar == 'O' || buttonChar == 'X') {
            this.buttonChar = buttonChar;
        }
    }

    public static void printArray() {
        for (int i = 0; i < TicTacToeBoard.boardLogic.length; i++) {
            System.out.println(TicTacToeBoard.boardLogic[i]);
        }
    }

    public char getButtonChar() {
        return buttonChar;
    }

    public void actionPerformed(ActionEvent e) {
        /* both cases must be true before this code can happen
         *  After Player A turn, then is Player B turn
         */
        if (e.getSource() instanceof JButton && TicTacToeBoard.currentPlayerTurn.equals(TicTacToeMain.firstPlayerName)) {
            // Player A uses circle 
            /* the state of the image for the Buttons will change depending on the player's turn 
             *  Player A will use the cross sign , Player B will use Circle Sign
             */
            ImageIcon icon = new ImageIcon("buttonImages/circle-sign.png");
            TicTacToeBoard.currentPlayerTurn = TicTacToeMain.secondPlayerName;
            // set the appropriate picture as the JButton icon
            setIcon(icon);
            // prevent user from clicking the button more than once
            setEnabled(false);
            //increment buttonClick variable by one for each mouse click 
            TicTacToeBoard.buttonClicks += 1;
            //notify both players whose turn is it
            TicTacToeMain.contentPane.remove(TicTacToeBoard.currentPlayerTurnLabel);
            TicTacToeBoard.printCurrentPlayerTurnLabel(TicTacToeMain.contentPane);
            // Tests the Winning conditions of the player's 
            TicTacToeBoardLogic boardLogic = new TicTacToeBoardLogic();
            boardLogic.checksWinningConditions();
        } else {// After Player B turn, then is Player A turn
            // Player B uses cross 
            /* the state of the image for the Buttons will change depending on the player's turn 
             *  Player A will use the cross sign , Player B will use Circle Sign
             */
            ImageIcon icon = new ImageIcon("buttonImages/x-sign.jpg");
            TicTacToeBoard.currentPlayerTurn = TicTacToeMain.firstPlayerName;
            // set the appropriate picture as the JButton icon
            setIcon(icon);
            // prevent user from clicking the button more than once
            setEnabled(false);
            //increment buttonClick variable by one for each mouse click 
            TicTacToeBoard.buttonClicks += 1;
            //notify both players whose turn is it
            TicTacToeMain.contentPane.remove(TicTacToeBoard.currentPlayerTurnLabel);
            TicTacToeBoard.printCurrentPlayerTurnLabel(TicTacToeMain.contentPane);
        }
        // if all buttons been pressed, the game makes a decision
        // Tests the Winning conditions of the player's 
        TicTacToeBoardLogic boardLogic = new TicTacToeBoardLogic();
        boardLogic.checksWinningConditions();
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T18:51:33.500

您的赢家是稍微扩展此方法：

```
public TicTacToeButton(int buttonNumber) { 
    // call the JButton super class constructor to initialize the JButtons 
    super(); 
    // set the name of the parameter to the data member of the JButton object  
    this.buttonNumber = buttonNumber; 
    // upon creating of the JButton the button will add ActionListener to itself 
    addActionListener(this); 
    setActionCommand(Integer.toString(buttonNumber));*************
} 
```

（我的加法以星号为后缀）

这将“命名”与按钮关联的动作事件。

然后在 Actionperformed (ActionEvent e) 中，您可以使用 e.getActionCommand() 获取该 ActionCommand。有九个，你最简单的可能是一个 switch 语句。请记住使用 varName.equals(e.getActionCommand()) 进行比较。

高温高压

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T19:03:53.050

要知道在 TicTacBoard 类中按下了哪个按钮，我建议在 TicTacToe 类而不是 TicTacToeButton 类中实现动作侦听器。

这是 Window 类的一个小演示代码，在您的情况下是 TicTacToeBoard。

```
import java.awt.GridLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.JFrame;
import javax.swing.JPanel;

public class Window implements ActionListener{

static Buttons[] buttons = new Buttons[2];

public Window(){
    JFrame f = new JFrame();
    f.setSize(400,400);
    JPanel p = new JPanel();
    GridLayout gl = new GridLayout(1,2);
    p.setLayout(gl);
    for(int i = 0; i<2; i++){
        buttons[i] = new Buttons(i);
        buttons[i].addActionListener(this);
        p.add(buttons[i]);
    }
    f.add(p);
    f.setVisible(true);
}

public static void main(String... args){
    new Window();
}

@Override
public void actionPerformed(ActionEvent e) {
    // TODO Auto-generated method stub
    if(e.getSource() == buttons[0] ){
        System.out.println("0");
    }

}

} 
```

这是 Buttons 类的演示，在您的情况下是 TicTacToeButton。

```
import javax.swing.JButton;

public class Buttons extends JButton{

int num = 0;

public Buttons(int num){
    this.num = num;
}

} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T19:29:11.013

您可能需要考虑将模型（带有 X 和 O 的 tictactoe 板）从视图（JButtons）中分离出来。这将允许您将游戏的当前状态传递给您希望的任何方法，而不会产生 Swing 组件的开销。

# php - 贝宝通知网址表单中的多个自定义字段

> ID：12465052
> 
> 赞同：1
> 
> 时间：2012-09-17T18:23:43.917
> 
> 标签：php, paypal

Paypal 在其 API 中有 CUSTOM 参数...我希望在 CUSTOM 字段中传递多维数组...

```
 <form id="paypal_form" action="https://sandbox.paypal.com/cgi-bin/webscr" method="post">
    <!-- Identify your business so that you can collect the payments. -->
    <input type="hidden" name="business" value="user@paypal.com">
    <!-- Specify a Buy Now button. -->
    <input type="hidden" name="cmd" value="_xclick">
    <!-- Specify details about the item that buyers will purchase. -->
    <input type="hidden" name="item_name" value="Hot Sauce-12 oz. Bottle">
    <input type="hidden" name="amount" value="10">
    <input type="hidden" name="currency_code" value="USD">
    <!-- Prompt buyers to enter their desired quantities. -->
    <input type="hidden" name="quantity" value="1">
    <input type="hidden" name="notify_url" value="http://www.myurl.com" />
    <!-- Display the payment button. -->
    <input type="image" name="submit" border="0" src="https://www.paypal.com/en_US/i/btn/btn_buynow_LG.gif" alt="PayPal - The safer, easier way to pay online" />
    <input type="hidden" value="1" name="custom[]" />
    <input type="hidden" value="11" name="custom[]" />
  </form> 
```

它在单个自定义字段上工作正常，但多自定义字段不起作用......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T08:24:25.717

您应该传递所有值，例如 1,2,3,4,5,6....

返回 url 您将获得自定义字符串并将其转换为字符串数组

# c# - 有没有办法使用 C# 获取 Word 和 Office STARTUP 文件夹路径？

> ID：12465054
> 
> 赞同：0
> 
> 时间：2012-09-17T18:23:55.943
> 
> 标签：c#, ms-word, ms-office

要获取 Winodws 启动文件夹，我可以使用：

```
textBox1.Text = Environment.GetFolderPath(Environment.SpecialFolder.Startup); 
```

是否有类似的方法可以同时获取 Office 启动文件夹和 Word 启动文件夹？

例如。以下是我正在寻找的两个示例：

```
"C:\Program Files (x86)\Microsoft Office\Office14\STARTUP"
"C:\Users\Jim\AppData\Roaming\Microsoft\Word\STARTUP" 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T21:15:39.090

您需要查看注册表以找到该信息。请查看[此页面](http://support.microsoft.com/kb/210860)以获取更多信息。它将向您展示在 Visual Basic 中查看的地方并为您提供示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-05-13T15:24:54.733

我在为 Word 插件安装 .dotm 文件时遇到了这个问题。我发现最好的方法是创建一个 Word App 对象并查询它的启动路径。这将为您提供与使用 Application.StartupPath 从 Word 中的 VBA 获得的文件夹相同的文件夹。获得启动路径后，您需要关闭 Word 应用程序。这需要一些时间（比如一秒钟），您需要等到完成后再继续。这是执行此操作的安装脚本代码：

```
try
  set wordApp = CoCreateObject("Word.Application");
  wordStartupPath = wordApp.StartupPath;
  // Without delays wordApp.quit sometimes fails
  Delay(1);
  wordApp.quit;
  Delay(2);
  set wordApp = NOTHING;
catch
   MessageBox("Word Startup Path Cannot be found", INFORMATION);
endcatch; 
```

在 C# 中也是如此。在这里它等待进程完成或最多 5 秒。可能有更好的方法来等待，但这有效：

```
// Get the startup path from Word
Type wordType = Type.GetTypeFromProgID("Word.Application");
object wordInst = Activator.CreateInstance(wordType);
string wordStartupPath = (String)wordType.InvokeMember("StartupPath", BindingFlags.DeclaredOnly |
                        BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.Instance | BindingFlags.GetProperty, null,
                        wordInst, null); 
Thread.Sleep(1000);
wordType.InvokeMember("Quit", BindingFlags.InvokeMethod, null, wordInst, null);
// Make sure Word has quit or wait 5 seconds
for (int i = 0; i < 50; i++)
{
    Process[] processes = Process.GetProcessesByName("winword");
    if (processes.Length == 0)
        break;
    Thread.Sleep(100);
} 
```

在文件的顶部，您将需要

```
 using System.Diagnostics; 
```

# security - 何时询问验证码规则？

> ID：12465056
> 
> 赞同：2
> 
> 时间：2012-09-17T18:24:09.677
> 
> 标签：security, captcha, ddos

虽然有很多关于 Captcha 实施的讨论，但我找不到任何关于在什么情况下应该要求 Captcha 的详细信息，尤其是对于为消费者服务的金融应用程序。

我想到的一些规则：

1.  如果 3 次登录/注册尝试失败
2.  如果用户已经登录，则如果 3 个重复呼叫。

我相信这些规则是通过安全风险驱动的，有没有更好的方法来管理这个？任何图书馆，这有助于解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T18:35:46.667

不幸的是，在这种情况下，您总是需要在安全性和便利性之间做出妥协。我认为您选择的具体数字很好；一个人*可能*不会做这些事情，如果有什么事情，它*可能*不是合法用户。我建议在您开始要求 CAPTCHA 继续执行之后，您还可以继续计算这些案例并在某个时候记录警报，如果他们的行为失控，最终会禁止 IP 地址。

您必须妥协的一个地方是您如何跟踪用户。如果您通过 cookie 执行此操作，它会更准确，但机器人在大多数情况下无法发送 cookie，从而躲避您的跟踪。因此，唯一真正的解决方案是通过 IP 地址进行跟踪。这样做的问题是共享 IP 地址后面的任何用户看起来都是一样的，所以如果三个用户都失败了一次登录，它看起来和一个用户失败 3 次一样（大部分）。此外，如果有人因滥用您的网站而被合法禁止并且使用共享 IP 地址，则其他合法客户可能会受到影响。

总而言之，您需要在安全性和便利性之间找到所需的平衡点。

# swt - SWT - TableViewer - 刷新选择

> ID：12465061
> 
> 赞同：1
> 
> 时间：2012-09-17T18:24:30.750
> 
> 标签：swt, tableviewer

我有一个运行方法的按钮。该方法获取表中选定的行并将它们添加到数组列表中。这在第一次执行时效果很好。但是如果用户选择了错误的行，他们将能够重新选择不同的行并将该选择数据添加到 arraylist。

但是使用我当前的代码，用户第二次选择哪一行并不重要，第一次选择的数据总是被添加到数组列表中。就像在用户选择新行之前需要重置或刷新选择一样。

按钮代码

```
Button pdfButton = new Button(composite, SWT.PUSH);
   pdfButton.setText("Get Plotter List");
   pdfButton.setEnabled(true);
   pdfButton.addSelectionListener(new SelectionAdapter() {
       public void widgetSelected(SelectionEvent e) {
          getPlotterSelection();
       }
   }); 
```

方法代码

```
 public void getPlotterSelection() {
    selectedPlotters.clear(); <-- Clearing the ArrayList
    int[] row = viewer.getTable().getSelectionIndices(); <-- Getting Current Selections
    Arrays.sort(row);

    if (row.length > 0) {
       for(int i = row.length-1; i >= 0; i--){
          PrinterProfile pp = new PrinterProfile(aa.get(i).getPrinterName(), aa.get(i).getProfileName());
          selectedPlotters.add(pp);
        }
     }
     viewer.getTable().deselectAll();
   } 
```

在我写这篇文章时，我认为问题可能出在 getSelectionIndices() 中。似乎获得了选择的行数，但不是实际的行数

***编辑***

问题出在我的逻辑上。我得到了正确的索引，但是在 for 循环中使用 i 变量来获取值。

```
for(int i = row.length-1; i >= 0; i--){
          PrinterProfile pp = new PrinterProfile(aa.get(i).getPrinterName(), aa.get(i).getProfileName()); 
```

将其更改为

```
aa.get(row[i].getPrinterName(), etc... 
```

它就像我想的那样工作

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T18:39:56.730

既然您已经在使用 a `TableViewer`，为什么不从中获得选择呢？

```
IStructuredSelection selection = (IStructuredSelection) viewer.getSelection();
YourObject[] array = (YourObject[])selection.toArray(); 
```

然后你可以遍历数组并将它们添加到你的`ArrayList`.

# sql - 如果在引用的表 sql 访问中为 null，则没有值

> ID：12465065
> 
> 赞同：0
> 
> 时间：2012-09-17T18:24:48.703
> 
> 标签：sql, ms-access-2007

我有“评论者”作为 id 和名称的表

```
ID |  Name
1  |  Coolboy 
```

现在我有一个表“订单”，它有一个外键到“reviwers”表

```
Order No  | Date | ID  | 
```

现在“订单”表中的某些字段为空，

所以在这种情况下，sql不起作用：

```
select o.[order no], o.[date], r.[name] orders o, reviewers r where o.ID = r.ID 
```

如果“订单”表中有空值，那么如何显示行。

如何将此查询与 where 子句混合使用：

```
SELECT O.[Order No], O.[Date], [R.Name], i.[inv_date] FROM Reviewers R, Invoices i
LEFT JOIN Orders O ON O.ID = R.ID where  o.[inv_no] =  i.[inv_numb] 
```

我提出了一个新问题：

[替换访问sql中的多个左连接](https://stackoverflow.com/questions/12466127/replace-multiple-left-joins-in-access-sql)

谢谢

普拉久特

# oracle - 通过 SSH 隧道在 SQLDeveloper 中调试

> ID：12465067
> 
> 赞同：2
> 
> 时间：2012-09-17T18:24:57.527
> 
> 标签：oracle, oracle-sqldeveloper

我正在通过 SSH 隧道使用 SQL Developer 到我的数据库服务器，没有任何问题。但是，当我尝试使用调试器时它失败了。调试窗口显示：

```
Executing PL/SQL: CALL DBMS_DEBUG_JDWP.CONNECT_TCP( '10.72.227.252', '52413' ) 
```

但后来我得到了错误：

```
ORA-30683: failure establishing connection to debugger
ORA-12535: TNS:operation timed out
ORA-06512: at "SYS.DBMS_DEBUG_JDWP", line 68
ORA-06512: at line 1 
```

是否有一个特殊的侦听器必须在数据库服务器上运行才能通过网络进行调试？每次我运行 CONNECT_TCP 调用时，它似乎都试图连接到不同的端口（上例中的 52413）。如何通过 SSH 隧道在 SQL Developer 中进行调试？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-01T23:06:37.263

经验丰富的同样问题，请尝试以下解决方案：

1- 将调试连接会话授予 urUser；将调试任何程序授予 urUser；

2-工具->首选项->调试器并标记询问主机进行调试...

3-编译时一定要给出运行sql developerper的机器的ip地址，如果仍然无法正常工作，请尝试关闭防火墙并重新测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-11T22:38:23.997

跑

```
Solution 
```

SQL> 授予调试连接会话，调试任何程序到

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T18:34:23.973

orr 命令显示此`ORA-30683`错误：

> ORA-30683: 与调试器建立连接失败

`Cause:`尝试建立与调试器的连接时显示错误。通常，TNS 错误会与此消息一起显示以进一步解释问题，但如果您选择捕获错误，则可能会隐藏此 TNS 错误。在您的情况下，您还会收到 ORA-12535 操作超时错误。

`Action:`更正指示的参数值并重试。

详情[请查看这里](http://www.dba-oracle.com/t_ora_30683_failure_establishing_connection_to_debugger.htm)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-12-07T06:58:05.860

临时解决方案：将调试器从 jdwp 切换到旧版本。在***ide.properties***末尾添加：

```
DatabaseDebuggerDisableJDWP=true 
```

该文件位置：

```
C:\Users\username\AppData\Roaming\SQL Developer\system${VERSION}\o.sqldeveloper.${SYSTEM_VERSION} 
```

# shell - Shell Script：菜单驱动的脚本，包含多个选项

> ID：12465074
> 
> 赞同：2
> 
> 时间：2012-09-17T18:25:42.030
> 
> 标签：shell

我需要一些关于我的菜单驱动的 shell 脚本的建议。我希望此脚本的最终用户能够在提示输入选项时提供多个选项。用户也可以输入一个选项，或者他/她可以输入多个选项。

例如。该脚本应该能够处理这两个选项：

```
Please enter any option or options between [1 - 4]: 1 2 3 

Please enter any option or options between [1 - 4]: 1 
```

请让我知道如何更改我的脚本以反映这一点。

以下是我的脚本代码供您参考：

```
#!/bin/sh

while :
do
 clear
 echo " ******** Task performing script ******** "
 echo "1\. task1 "
 echo
 echo "2\. task2 "
 echo
 echo "3\. task3"
 echo
 echo "4\. Exit"
 echo
 echo -n "Please enter any option or options between [1 - 4]"
     read opt;
 case $opt in
1)
 echo "Performing task1 . . . .";
 for i in `cat test`
 do
 ...............
 ...............
 done;;
2)
 echo "Performing task2 . . . .";
 for i in `cat test`
 do
 ...............
 ...............
 done;;
3)
 echo "Performing task3 . . . .";
 for i in `cat test`
 do
 ...............
 ...............
 done;;
4)
 echo "Bye $USER";
 exit 1;;
*)
 echo "$opt is an invaild option";
 echo "Press [enter] key to continue. . .";
 read enterKey;;
  esac
done 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T18:34:33.460

将您的语句包装`case`在一个`for`循环中，该循环遍历您从`read`语句中获得的值。

```
while : do;
    # print menu
    read opts

    for opt in $opts; do  # To allow for multiple space-separated choices

        case $opt in
        ...
        esac
    done
done 
```

# java - 将 Table 模型上的选定项目转换为对象

> ID：12465077
> 
> 赞同：0
> 
> 时间：2012-09-17T18:26:13.877
> 
> 标签：java, jtable, tablemodel

我有我创建的组件，它们被放入具有如下两列的表模型中。

```
if (!newAcList.isEmpty()) {
    for (Acronym acc : newAcList) {
        tableModel.addRow(new String[]{acc.getName(), acc.getDefinition()});

    }
} 
```

我需要的是当用户在表模型上选择一个项目时，它会将项目转换回我的首字母缩写词对象。我正在使用 Listselectionevent 侦听器。

这是 valueChanged 选择事件``

```
 @Override
            public void valueChanged(ListSelectionEvent e) {
                String selectedAcData = null;
                String selectDefData = null;

                int[] selectedRow = accTable.getSelectedRows();
                int[] selectedColumns = accTable.getSelectedColumns();

                for (int i = 0; i < selectedRow.length; i++) {
//                    for (int j = 0; j < selectedColumns.length; j++) {
                    selectedAcData = (String) accTable.getValueAt(selectedRow[i], 0);
                }
            } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T20:09:34.660

您可能希望创建一个为首字母缩略词实现 TableModel 接口的类。它可能被调用`AcronymTableModel`并由`List<Acronym>`首字母缩略词列表支持。然后把这个模型放到你的桌子上。

`accTable.getValueAt(selectedRow[i], 0);`然后，在您的方法中调用`valueChanged`将返回 Acronym 的一个实例。

这是一个简单的例子。

```
 public class Example {

        public static void main(String [] a) {
            JFrame f = new JFrame();

            JPanel p = new JPanel();

            List<Acronym> acronyms = new ArrayList<Acronym>();
            acronyms.add(new Acronym("FBI", "Federal Bureau of Investigation"));
            acronyms.add(new Acronym("CIA", "Central Intelligence Agency"));

            final TableModel tModel = new AcronymTableModel(acronyms);

            JTable t = new JTable(tModel);
            t.getSelectionModel().addListSelectionListener(new ListSelectionListener() {
                @Override
                public void valueChanged(ListSelectionEvent e) {
                    Acronym a = (Acronym)tModel.getValueAt(e.getFirstIndex(), 0);
                    System.out.println(a.acronym + ": " + a.definition);
                }});

            p.add(t);

            f.getContentPane().add(p);

            f.pack();

            f.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);

            f.setVisible(true);
        }

    }
    class Acronym {
        String acronym;
        String definition;

        public Acronym(String a, String d) {
            acronym = a;
            definition = d;
        }
    }
    class AcronymTableModel implements TableModel {

        private List<Acronym> acronyms;

        public AcronymTableModel(List<Acronym> acs) {
            this.acronyms = new ArrayList<Acronym>(acs);
        }

        @Override
        public int getRowCount() {
            return this.acronyms.size();
        }

        @Override
        public int getColumnCount() {
            return 2;
        }

        @Override
        public String getColumnName(int columnIndex) {
            switch(columnIndex) {
            case 0:
                return "Acronym";
            case 1:
                return "Definition";
            }

            return null;

        }

        @Override
        public Class<?> getColumnClass(int columnIndex) {
            return String.class; // Since both columns are simply
        }

        @Override
        public boolean isCellEditable(int rowIndex, int columnIndex) {
            return false;
        }

        @Override
        public Object getValueAt(int rowIndex, int columnIndex) {
            return acronyms.get(rowIndex);
        }

        @Override
        public void setValueAt(Object aValue, int rowIndex, int columnIndex) {
        }

        @Override
        public void addTableModelListener(TableModelListener l) {
        }

        @Override
        public void removeTableModelListener(TableModelListener l) {
        }
    } 
```

Java 教程总是很好并且有很好的例子。 [http://docs.oracle.com/javase/tutorial/uiswing/events/listselectionlistener.html](http://docs.oracle.com/javase/tutorial/uiswing/events/listselectionlistener.html)

# windows - 如何在 Komodo 7.1 中启用 mysql 支持？

> ID：12465079
> 
> 赞同：1
> 
> 时间：2012-09-17T18:26:19.733
> 
> 标签：windows, linux, komodo

在 Komodo 6 中我可以连接到我的 mysql 数据库，但在 Komodo 7.1 中不能？当我想将我的 mysql 连接添加到 Komodo 时，它只给我 sqlite 3 支持？！如何将我的 mysql 连接添加到 Komodo 7.1？![在此处输入图像描述](../Images/7591e1d83d526b3f7bda0773a763ff3f.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T12:28:16.333

我在 Komodo 中安装了 mysql.xpi 扩展：http: [//community.activestate.com/xpi/mysql-database-explorer](http://community.activestate.com/xpi/mysql-database-explorer)![在此处输入图像描述](../Images/16ed1d561426b5b20611812298afd4e2.png)

# matlab - Interection of two planes

> ID：12465081
> 
> 赞同：0
> 
> 时间：2012-09-17T18:26:27.113
> 
> 标签：matlab, intersection, mesh

I am trying to find the intersection between two planes in MATLAB.

```
x = -10:10;
y = x;

[X Y] = meshgrid(x,y);
Z1 = 3+X+Y;
Z2 = 4-2.*X-4.*Y;

mesh(X,Y,Z1)
hold on
mesh(X,Y,Z2) 
```

I know I can find the locations of the elements of Z1 and Z2 where they are equal by setting a new array equal to (Z1==Z2), but that only gives me an arrays of 0s and 1s. How do I find the array containing the actual values of the line segment?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T18:39:16.380

The following equation results from setting Z1=Z2:

```
3+X+Y=4-2X-4Y 
```

solve it and you will get the equation of the intersection line.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T18:37:41.910

The output from `Z1 == Z2` is a logical array that can be used to index into `Z1` or `Z2`. This will give you the array of points you are after, if I understood the question. If this is homework, I can't imagine that an array of points would be a valid answer, so you may want to include the motivation for this question.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T00:04:00.287

If I understand the question correctly, you are asking what is the syntax to use logicals to index a matrix? If so, no one has provided it thus far, so here it is:

```
S = Z1(Z1 == Z2); 
```

Or equivalently in your case, `S = Z2(Z1 == Z2)`. This is essentially what macduff is talking about, but without providing the syntax (sorry macduff I would have made this a comment on your answer but I don't have the rep).

# javascript - 进行链接时如何使内部函数不超出主函数范围？

> ID：12465082
> 
> 赞同：2
> 
> 时间：2012-09-17T18:26:26.287
> 
> 标签：javascript, scope, chaining

例子：

```
function testFunc() {
  this.insideFunc = function(msg) {
    alert(msg);
  }
  return this;
}

testFunc().insideFunc("Hi!");
insideFunc("Hi again!"); 
```

为什么内部函数在全局范围内可见，如何防止？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T18:30:10.213

那是因为`this`是`window`。

要`this`以这种方式使用，您必须使用：

```
var _testFunc = new testFunc(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T18:37:02.483

你可以尝试这样的事情：

```
var testFunc = function() {
    function insideFunc(message) {
        alert(message);
    }
    return {
        insideFunc: insideFunc
    }
}
testFunc().insideFunc("Hi!");
insideFunc("Hi again!"); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-17T18:36:10.640

在 ethagnawl 的回答的基础上，`new`如果调用者忘记了，您可以使用此技巧强制您的函数自行执行：

```
function testFunc() {
    // if the caller forgot their new keyword, do it for them
    if (!(this instanceof testFunc)) {
        return new testFunc();
    }

    this.insideFunc = function(msg) {
        alert(msg);
    }
    return this;
} 
```

[http://jsfiddle.net/qd7cW/](http://jsfiddle.net/qd7cW/)

# jquery - Jquery Supersized：将幻灯片加载到特定的 div

> ID：12465083
> 
> 赞同：4
> 
> 时间：2012-09-17T18:26:31.230
> 
> 标签：jquery, supersized

似乎[Jquery Supersized](http://buildinternet.com/project/supersized)目前只允许为整个身体附加背景图像？是否可以使用 css 选择器告诉他在哪里加载背景幻灯片？

我试过类似的东西

```
$('#custom-div').supersized(); 
```

但它不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-30T02:59:58.417

我刚刚发现了一个很棒的滑块——Nerve [，](http://www.ryanbruzan.net/work/projects/nerve-slider)它更简单但易于定制。它可以是全屏的，也可以是 div 中的。

实际上，我正试图对 SUPERSIZED 做同样的事情，但无法让它发挥作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-06T15:44:40.150

试试这些说明，它们效果很好:) [http://arushad.org/how-to-use-supersized-inside-a-div-for-a-background-image-slideshow](http://arushad.org/how-to-use-supersized-inside-a-div-for-a-background-image-slideshow)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-01T07:17:09.517

在您的 HTML 中创建一个 id="supersized" 的 div，它将在那里加载。我只是简单地测试了这个，但它看起来很有效。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-10-31T00:56:21.113

是的，[看起来](https://github.com/buildinternet/supersized/blob/master/core/js/supersized.core.3.2.1.js#L17-19) Supersized 仅适用于全屏背景。

我建议像[循环](http://jquery.malsup.com/cycle/)这样的东西:)

# php - 想要 TinyMCE 的专用按钮 AjaxFileManager

> ID：12465086
> 
> 赞同：2
> 
> 时间：2012-09-17T18:26:35.857
> 
> 标签：php, javascript, tinymce

我想在 tinyMCE 编辑器中添加一个按钮，它将打开 AjaxFileBrowser 并选择一个文件并单击**选择**按钮将在编辑器中返回文件路径，就像在插入图像/媒体窗口的图像/媒体 url 字段中一样。

实际上，我需要一种方法来添加直接访问 AjaxFileManager 的方法。

```
setup : function(ed) {
    ed.addButton('MyButton', {
        title : 'MyButton',
        image : './images/copy.jpg',
        onclick : function() {
        ajaxfilemanager('','','file',window); // The first arguement is return field as I know but how to use it??
            ed.focus();
            ed.selection.setContent('<tittle>' + ed.selection.getContent() + '</tittle>');
        }
    });
} 
```

有没有很好的文档。请建议我！

# git - 为什么 'git rebase' 会保留重新设置的分支历史记录？

> ID：12465093
> 
> 赞同：0
> 
> 时间：2012-09-17T18:26:52.667
> 
> 标签：git, git-rebase

正如我从[http://www.kernel.org/pub/software/scm/git/docs/git-rebase.html](http://www.kernel.org/pub/software/scm/git/docs/git-rebase.html)了解到的，重新定位的分支被“移动”到另一个分支。

但是，我在测试中看到的内容表明，来自重新定位的分支的提交仍保留在历史记录中，因此它们被有效地复制了。

![变基之前：](../Images/d4e3094e08c5b3dd8cfa69ddf8e47dbd.png)

![变基后：](../Images/54bd81bf9acb2af2e3e4c0c7a7a9d0ae.png)

也许我遗漏了一些东西，或者完全不理解变基的目的，或者两者兼而有之。

如果我看到的是预期的行为，那为什么会这样？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T18:34:53.787

简而言之，`rebase`这是一种将提交从树的一部分应用到不同起点的方法。它可能会*复制*这些更改，但不会*移动*它们。

请记住，git 提交是不可变的——一旦有哈希值，它就永远不会改变。这意味着当您在另一个更改之上重新设置一些更改时，哈希值必然不同，因此 git 将保留旧的和新的。

但是，如果没有分支名称指向旧提交（在您的示例中为“add file2”），那么几周后 git 的自动垃圾收集器将从您的存储库中删除旧提交。（为什么要两周？那样的话，如果你改变主意，你可以从`git reflog`.您可以使用`git prune`和的组合`git gc`来修剪冗余数据。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-18T09:54:42.437

这里有两种不同的现象。

1.  您发布的来自 gitk 的屏幕截图仍然显示旧的提交。这就是 gitk 的工作方式；如果您通过点击`Ctrl`+`F5`而不仅仅是`F5`（对于鼠标用户来说是文件 > 重新加载而不是文件 > 更新）重新加载，您会看到旧的提交消失了，因为它不再相关。

2.  Git 中有*很多*创建提交的操作。甚至更多的是在文件存储中创建文件或树对象。许多这些对象不再使用的事实是无关紧要的。

    这有很多优点。在您的示例中，这意味着如果您认为 rebase 是一个坏主意，那么您的旧提交仍然存在并且可以恢复。它甚至有一个方便的语法：`topic@{1}`指`topic`在上次移动之前指向的提交；在这里，这将是在变基之前。

    Git 对象模型在这类事情上很聪明。像这样的额外提交占用*很少*的额外空间。对于像您所描述的那样的变基，我希望保留旧分支最多会花费几百字节。

    当然，这确实会随着时间的推移而增加。因此`git gc`（由某些命令每隔一段时间自动运行）运行`git prune`. 并且`git prune`会寻找旧的并且不再相关的提交和对象并为你清除它们。

这并不意味着你的变基没有工作，只是变基“移动”提交的想法是一种简化。rebase 实际上所做的是将每个提交与其父级之间的差异应用到新分支，并为旧分支上的每个提交创建一个具有这些差异的新提交。然后它会更新分支，这样，如果您查看分支历史记录，就好像这些提交已被移动。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T18:34:42.570

Rebase 是一个重写历史的命令。但是多亏了 git，您的历史并没有丢失。您可以回滚，直到 git 垃圾收集器清除那些悬空提交。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-19T06:46:04.613

*...重新定位的分支被“移动”到另一个分支。*

这是一种表达方式，但并不完全准确。

考虑 git repo 的最佳方式是将其视为两件事的组合：一个有向的、非循环的不可变提交图，每个代表您的软件版本（或 repo 中的任何内容），以及一组分支指针变量（*master*等）。

假设您从一个包含三个提交的 repo 开始，如下所示：

```
a--> b
 \-> c 
```

其中*origin/master*分支指针指向，`b`master*分支*指针指向`c`。您实际上在这里拥有三个不同版本的软件`a`，`b`和`c`.

如果你决定重新`c`基于 to `b`，你最终会得到一个如下所示的 repo：

```
a--> b--> c'
 \-> c 
```

将*主*分支指针更改为指向`c'`. “推送此提交”将导致提交`c'`被发送到原始仓库，原始仓库的*主*分支指针被更改为指向`c'`，并且您的*原始/主*分支指针被更改以匹配它。

你会注意到这`c'`是一个不同的提交`c`，它仍然存在，你现在有四个版本的软件。`c'`提交在道德上对所做的更改进行了相同的更改（或者人们`b`希望如此，假设您适当地编辑了任何冲突）。`c``a`

`c`不再有任何指向它的分支指针（实际上，在 reflog 之外），因此在正常 git 操作期间的某个时间点将被垃圾收集。

（与单独检出它们相比，Git 还执行了一些花哨的压缩技巧，以将软件的所有这些不同 [和完整] 版本存储在更少的空间中，但这并不是您真正需要甚至不应该考虑的事情。 )

在闲聊中，我们将此操作称为“更改*master*分支”，但实际上，您所做的是创建一个新分支并将*master*所指的内容从旧分支更改为新分支。

# jquery - ckFinder - 使用 jQuery 模拟刷新点击

> ID：12465095
> 
> 赞同：0
> 
> 时间：2012-09-17T18:26:58.297
> 
> 标签：jquery, ckfinder

我试图让 jQuery 在加载选项卡时模拟单击 ckFinder 的刷新按钮。无论我使用什么代码，点击都不会注册/提醒。使用 Firebug，我抓取了刷新按钮源：

```
 <a onclick="window.parent.CKFinder._.callFunction(3, this); return false;" 
    onfocus="window.parent.CKFinder._.uiButtonFocus(1, event);" 
    onkeydown="window.parent.CKFinder._.uiButtonKeydown(1, event);" 
    onblur="this.style.cssText = this.style.cssText;" aria-labelledby="cke_10_label" 
    role="button" hidefocus="true" tabindex="-1" title="Refresh" 
    href="javascript:void('Refresh')" class="cke_button_refresh cke_off" id="cke_10" style="">
    <span class="cke_icon"></span>
    <span class="cke_label" id="cke_10_label">Refresh</span></a> 
```

我已经尝试了以下代码示例，甚至去根/通用标签，这不起作用。

```
 $('span').click(function(){
     var t = $(this).text();
     alert(t);
   });

  $("#cke_10").click(function() { alert('cke_10'); });
  $("a").click(function() { alert('a click'); });
  $("a#cke_10").click(function() { alert('a cke click'); });
  $("#cke_10_label").click(function() { alert('cke label'); });
  $("span#cke_10_label").click(function() { alert('span cke label'); }); 
```

任何人都有任何运气让刷新按钮在单击时发出警报？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T19:09:31.563

事实证明，我有两个 ID 都设置为“id”，这使刷新感到困惑。然后使用此代码：[https](https://stackoverflow.com/a/4249906/850904) ://stackoverflow.com/a/4249906/850904我设法根据需要刷新 iFrame。

# java - 使用 Jenkins 内部版本号安装/部署 Maven

> ID：12465096
> 
> 赞同：4
> 
> 时间：2012-09-17T18:26:59.657
> 
> 标签：java, maven, jenkins, hudson, version

**更新 #1 9/18**

我的公司决定彻底改变他们的开发/发布周期，以适应越来越多的开发人员。

git 过程将类似于[成功的分支模型](http://nvie.com/posts/a-successful-git-branching-model/)，但有一些更改。开发人员不需要直接推送访问“开发”分支，而是需要提出合并/拉取请求，需要代码审查和基本单元测试。

版本系统将是 Major.Minor.Patch，其中主要版本标记向后兼容性中断，次要版本标记新功能和小错误修复，而补丁标记关键热修复。这个新版本系统将删除 Jenkins 内部版本号作为有用的信息，但将其附加到已部署的工件以用于历史目的。

Jenkins 将跟踪“开发”分支以构建和部署 SNAPSHOT 到我们本地的 Nexus，因此开发人员可以使用未发布但已接受的功能。Jenkins 还将跟踪“master”分支以构建和部署发布工件。

发布过程将：

*   根据发布的特性更新 POM 版本
*   Git 用新版本标记分支
*   执行单元、集成和系统测试。
*   构建、混淆和部署发布工件到我们的 Nexus
*   将“develop”分支版本更新为“Major.Minor++-SNAPSHOT”，用于新的开发 SNAPSHOT。

**原帖**

我正在尝试构建一个混淆的 JAR 库，使用基于 Jenkins/Hudson 构建的动态构建号，并部署到内部 Sonatype Nexus。

我的问题是 Maven 安装/部署不遵守对 finalName 的更改，并且使用如下表达式设置版本被认为是“不好的做法”：

```
 <version>1.0.${buildNumber}</version> 
```

尽管这是一种不好的做法，但它会正确安装/部署具有正确版本的工件，包括本地和远程。内部版本号基于一对配置文件，这些配置文件与 Jenkins 构建系统的内部版本号环境变量的存在相关联，并且在没有该变量的情况下默认为 0：

```
 <profile>
        <id>static_build_number</id>
        <activation>
            <property>
                <name>!env.BUILD_NUMBER</name>
            </property>
        </activation>
        <properties>
            <buildNumber>0</buildNumber>
        </properties>
    </profile>
    <profile>
        <id>dynamic_build_number</id>
        <activation>
            <property>
                <name>env.BUILD_NUMBER</name>
            </property>
        </activation>
        <properties>
            <buildNumber>${env.BUILD_NUMBER}</buildNumber>
        </properties>
    </profile> 
```

我们不使用 SNAPSHOT 版本，因为任何提交并推送到 Nexus 的版本都被视为经过测试的发布版本。

是否有一种“正确”的方法可以根据 Jenkins/Hudson 动态内部版本号设置 Maven 版本，从而允许使用该更新版本进行部署？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T19:14:53.360

maven 方式说版本仅在您发布代码时才会更改，并且相同版本的两个连续构建应该产生相同的输出。

在你的情况下，你违背了这两个*好的做法*。

如果真的**每一次**提交都是一个新版本，那么你所做的事情听起来并没有什么大错（但对我来说听起来确实很有趣）。一个缺点是它看起来不像是从 VCS 创建标签（这是另一种好的做法）。

我会诚实的。我不敢相信每次提交都是生产就绪版本。我从未见过这种情况，即使在持续交付环境中，每次提交都需要通过大量自动化测试，有时修订被拒绝（可能出于功能或性能原因）。

# objective-c - 了解用户是否启动了应用程序

> ID：12465100
> 
> 赞同：1
> 
> 时间：2012-09-17T18:27:23.860
> 
> 标签：objective-c, macos, launch

好吧，这个标题可能看起来很奇怪，但请耐心等待。我有一个应用程序，用户可以在其首选项中设置它以在登录时启动。这意味着我可以预期有时该应用程序将由用户启动（单击 Dock/Finder 等），但有时该应用程序将在登录时由系统自动启动。

我想在用户启动应用程序时显示一个窗口，而不是在自动启动时显示一个窗口（我想这对用户来说会很痛苦）。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T19:00:41.533

尽管这可能取决于您打算如何自动启动应用程序，但您可以使用命令行参数来区分系统启动与用户启动。

所以，命令行启动可能是这样的：

```
MyApp -autoLaunch "Y" 
```

要解析 Cocoa 应用程序中的命令行参数，您可以使用`NSUserDefaults`（是的，[您可以](http://perspx.com/archives/parsing-command-line-arguments-nsuserdefaults/)！）：

```
if( ![[NSUserDefaults standardUserDefaults] objectForKey:@"autoLaunch"] isEqualToString:"Y"] ) {
    // do something for user initiated launch
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T00:44:57.647

我对你的问题没有确切的答案。但是，如果用户上次退出您的应用程序时窗口是可见的，我是否可以建议您的应用程序显示该窗口？

这可能更符合 Mac UI 指南关于恢复应用程序和窗口的建议，并且在用户的预期之内。

此外，将您的应用程序设置为在登录时启动的用户可能会理解关闭窗口并且下次不恢复它，或者让系统在登录期间也隐藏您的应用程序。

# wordpress - 在同一域中复制整个 Wordpress 站点

> ID：12465103
> 
> 赞同：0
> 
> 时间：2012-09-17T18:27:31.013
> 
> 标签：wordpress

我在 www.site.com/name1 有一个用 Wordpress 构建的实时网站。

客户想要一个新主题。我已经使用自定义代码对当前主题进行了大量修改，并且需要使用新主题进行修改，所有这些都不会中断实时站点，因此这不会像将站点从一个主题移动到另一个主题那样简单。因此，我*认为*我需要在 www.site.com/name2 上创建该站点的副本，因为内容都是相同的。这样做会给我一个重新设计工作的地方。

这样做的最佳方法是什么？我是否应该都使用相同的数据库？当我准备上线时，我应该简单地将域重定向到 /name2 还是将 /name2 中的所有内容移动到 /name1？

任何帮助表示赞赏。

谢谢，克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T07:07:03.677

如果您想要相同的数据，您可以使用相同的数据库，但在 Wordpress 数据库中有一些选项表和元表，那么如果您在一个站点上更改参数，它将影响另一个站点。

如果您只是重新编码主题而不触及配置中的任何内容，您可以使用相同的数据库来使用有效数据测试您的主题，但如果您认为必须更改参数，我宁愿将生产数据库复制到测试数据库以确保安全生产网站。

当您上线时，您只需将您的主题移动到生产网站并复制您的选项和元表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T03:58:15.400

如果您处于拥有客户的地步，那么您绝对应该在本地开发。这将使您免于错误地弄乱生产站点的麻烦。

1.  在您自己的机器上安装 Apache、MySQL 和 PHP。
2.  从生产中复制数据库和文件。
3.  更改您想要的任何内容，而不会将其暴露在 Internet 上。
4.  准备好上线后，将您量身定制的新主题上传到生产环境。

# appfabric - AppFabric 1.1 用于使用 windows XP 进行 Windows 服务器开发

> ID：12465106
> 
> 赞同：0
> 
> 时间：2012-09-17T18:27:39.297
> 
> 标签：appfabric, distributed-caching, appfabric-cache

我已经在 64 位 Windows Server 2008 R2 上为 Windows 服务器安装并配置了 AppFabric 1.1。

我想使用我的 32 位 Windows XP 开发机器的缓存功能。如何将缓存客户端组件安装到我的 XP 机器上？MSDN 文档建议不支持 XP，至少，我需要 Vista。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T19:23:47.137

只需尝试为客户端程序集安装[Nuget](http://nuget.org/packages/ServerAppFabric.Client)包。你会看看它是否正常！

# android - 带有特定拨号器的 ACTION_CALL 意图

> ID：12465107
> 
> 赞同：2
> 
> 时间：2012-09-17T18:27:44.757
> 
> 标签：android, android-intent

我有一个通过 ACTION_CALL 打开语音通道的应用程序。目前，它工作得很好，但在用户拥有多个拨号器的情况下。

此应用程序是关于跌倒检测，因此用户没有时间（生死攸关）在他拥有的多个拨号器中进行选择，然后我想将其作为配置，甚至使用系统默认拨号器拨打电话。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T21:16:50.630

为了避免选择器，您应该设置组件名称：

```
// i.e. Applications.getIntentForActivity(new Intent(Intent.ACTION_SEND), "Messaging");
public static Intent getIntentForActivity(Intent intent, String hint) {
    ResolveInfo info = getActivityForIntent(intent, hint);
    if (info == null)
        return intent;
    ComponentName name = Applications.getComponentForActivity(info);
    if (name == null)
        return intent;
    // intent.addCategory(Intent.CATEGORY_LAUNCHER);
    intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK| Intent.FLAG_ACTIVITY_REORDER_TO_FRONT);
    // | Intent.FLAG_ACTIVITY_RESET_TASK_IF_NEEDED);
    intent.setComponent(name);
    return intent;
} 
```

# html - 背景没有出现

> ID：12465109
> 
> 赞同：1
> 
> 时间：2012-09-17T18:28:01.573
> 
> 标签：html, css

我注意到[这里的背景图片](http://tinyurl.com/8dz55kx)（在“cont”元素上）不像在[我的主页上](http://tinyurl.com/8eczmsv)那样出现。
我看到它与高度有关，因为当我添加高度时它可以工作，除了它也会以某种方式弄乱页脚......
我怎样才能让背景在页面上工作，就像它在主页上工作一样？

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T18:33:05.570

添加`overflow: hidden;`到您的`.cont`元素。问题是，由于其中的元素是`floated`，它不会调整大小以适应它们的高度。

通常，这可以通过多种方法来解决，而不仅仅是`overflow: hidden;`. [Google for clearfix](http://google.com/search?q=clearfix)查找资源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T18:38:41.990

由于您`background-image`被设置为元素`div.cont`并且它没有任何 clearfix，因此它的**高度为 0**，因此您的背景没有空间出现。*添加一个clearfix，它会工作*。一种方法是：

```
<div class="cont">
  <div class="body">
  ...
  </div>

  <br style="clear: both" />
</div> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T18:34:56.397

使用清除修复：

追加`<div style="clear: both"></div>`到`#cont`div 的末尾。

在我正在使用的生产网站中：

```
<br class="clear"/> 
```

加上CSS：

```
br.clear { display: block; width: 1px; height: 0px; clear: both; } 
```

# linq - 从按钮执行查询 - LightSwitch 2012

> ID：12465110
> 
> 赞同：1
> 
> 时间：2012-09-17T18:28:03.370
> 
> 标签：linq, visual-studio-lightswitch

我有一个自定义 LINQ 查询，我试图将其绑定到搜索屏幕上的按钮。我在屏幕上添加了一个按钮，并修改了 Can_Execute 代码，并添加了以下查询。

```
 partial void DistrictQuery_Execute()
    {

        query = (from myProjects in query
                 where myProjects.SYP_PRO_DISTNO == Int16.Parse(DistrictNo)
                 orderby myProjects.SYP_PRO_DISTNO descending
                 select myProjects);
    } 
```

出现编译错误“当前上下文中不存在名称‘查询’”。如何将按钮连接到自定义查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T00:42:41.757

您需要创建一个*参数化查询*。

[从数据源检索信息](http://msdn.microsoft.com/library/vstudio/ee256728.aspx)

# django - 是否有可能在 dateTime 的月份的某一天有一个“大于等于”的 django queryset 过滤器？

> ID：12465112
> 
> 赞同：1
> 
> 时间：2012-09-17T18:28:13.260
> 
> 标签：django, django-queryset

我想做的是：

```
MyModel.filter(start_date__day__gte=25) 
```

但这不起作用。有没有办法为日期指定 a`gte`或 a `range`，但只能在当天？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T19:12:17.007

我认为这样的事情在不回退到原始查询或请求`__day__gte`方法的情况下是最有效的：

```
from django.db.models import Q

day_filter = Q()
for i in xrange(25,32):
    day_filter = day_filter | Q(start_date__day=i)
objects = MyModel.filter(day_filter) 
```

# ios - CoreData 模型选项选择树

> ID：12465114
> 
> 赞同：0
> 
> 时间：2012-09-17T18:28:22.823
> 
> 标签：ios, core-data, data-modeling

我有一个应用程序，用户可以在其中选择一组选项，但每一步可用的选项取决于先前选择的选项。选择的路径可以建模为一棵树，但是，选择选项 A 后可用的选项与选择选项 B 后可用的选项不同。它可能看起来像这样：

```
 Option 1
                      /   |    \
                     /    |     \
                    /     |      \
                A,B,C    D,E      F,G,H
               /  |  \   / \      / |
              I  J,K  L  M  N,O  P  Q 
```

我为这个模型的粗鲁道歉；我没有时间按比例构建它。

基本上，将向用户呈现一组初始选项。这些选项中的每一个都可以有一组子选项，与它们选择其他同级选项相比，这将是唯一的。在他们的选择结束时，他们将拥有一个 Product 对象。

我正在寻找有关如何在 CoreData 中对这种层次结构建模的建议。我认为叶节点应该是 Product 对象，并且中间选项应该只是常规的 NSManagedObjects，并带有可以选择的子选项列表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T19:00:15.770

听起来您可能希望一个实体代表一个决策，与它本身和一个产品实体有一对多的关系。就像是：

```
实体：决定
    关系：决定 ->> 决定
    关系：产品->>产品

实体：产品
    属性：名字
    属性：价格
    属性：颜色
    ...

```

这样，一个决定可以导致一个或多个其他决定，就像您的“选项 1”节点导致另外三个决定一样。或者，它可以导致一种或多种产品，或两者的某种组合。

# java - 如何在 Android 上制作日期微调器

> ID：12465115
> 
> 赞同：19
> 
> 时间：2012-09-17T18:28:34.210
> 
> 标签：java, android, date, spinner

如何创建打开日期选择器对话框的 Android 微调器？

我想要一个看起来像日历应用程序中的 Spinner，如下面的屏幕截图所示。

![Android 日历应用程序的屏幕截图，突出显示了所需的 GUI 元素](../Images/a178e8fe2725b799077e7f4949094648.png)

我已经尝试过的：

我在布局 XML 中创建了一个微调器，并尝试设置 onclick 属性以调用显示对话框的方法。当我在“单击时”中输入方法名称时，出现错误提示“找不到以下类：- Spinner（更改为 android.widget.Spinner，修复构建路径，编辑 XML）”。

```
<Spinner
    android:id="@+id/spinner1"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:onClick="showDatePickerDialog" /> 
```

showDatePickerDialog 在正确的类中：

```
public void showDatePickerDialog(View v) {
    DialogFragment newFragment = new DatePickerFragment();
    newFragment.show(getFragmentManager(), "Date");
} 
```

这是 DatePickerFragment （从另一个网站复制）：

```
import java.util.Calendar;

import android.app.DatePickerDialog;
import android.app.Dialog;
import android.app.DialogFragment;
import android.os.Bundle;
import android.widget.DatePicker;

public class DatePickerFragment extends DialogFragment
                        implements DatePickerDialog.OnDateSetListener {

    @Override
    public Dialog onCreateDialog(Bundle savedInstanceState) {

        // Use the current date as the default date in the picker
        final Calendar c = Calendar.getInstance();
        int year = c.get(Calendar.YEAR);
        int month = c.get(Calendar.MONTH);
        int day = c.get(Calendar.DAY_OF_MONTH);

        // Create a new instance of DatePickerDialog and return it
        return new DatePickerDialog(getActivity(), this, year, month, day);
    }

    public void onDateSet(DatePicker view, int year, int month, int day) {
        // Do something with the date chosen by the user
    }
} 
```

解决方案：

我在[另一个问题](https://stackoverflow.com/questions/3928071/android-setting-a-spinner-onclicklistener?rq=1)上找到了解决方案。

我在布局文件中使用了常规微调器，然后在我的活动类中使用了以下代码：

```
dateSpinner = (Spinner)findViewById(R.id.spinner_date);

View.OnTouchListener Spinner_OnTouch = new View.OnTouchListener() {
    public boolean onTouch(View v, MotionEvent event) {
        if (event.getAction() == MotionEvent.ACTION_UP) {
            showDatePickerDialog(v);
        }
        return true;
    }
};

View.OnKeyListener Spinner_OnKey = new View.OnKeyListener() {
    public boolean onKey(View v, int keyCode, KeyEvent event) {
        if (keyCode == KeyEvent.KEYCODE_DPAD_CENTER) {
            showDatePickerDialog(v);
            return true;
        }
        else {
            return false;
        }
    }
};

dateSpinner.setOnTouchListener(Spinner_OnTouch);
dateSpinner.setOnKeyListener(Spinner_OnKey); 
```

它似乎有点被黑客入侵，但它确实有效。有谁知道更清洁的方法吗？它不会让我 setOnClickListener() 或 setOnItemClickListener() 在微调器上。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-05-30T16:18:29.073

我能够很容易地实现它。它看起来与日历应用程序完全一样 :)

使用 TextView 并给它一个微调器样式：

```
<TextView
   android:layout_width="wrap_content"
   android:layout_height="wrap_content"
   style="@android:style/Widget.Holo.Spinner" /> 
```

对于没有 Holo 主题的 API 10 及更低版本，请使用：

```
style="@android:style/Widget.Spinner" 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-09-17T19:09:11.837

我认为通常人们在这种情况下所做的是使用按钮并将其设置为微调器（[这里的一种方法](https://stackoverflow.com/questions/8619576/android-drawing-a-button-as-a-spinner)，[我认为一种更好的方法](https://groups.google.com/forum/?fromgroups=#!topic/android-developers/zqlX_Hdyrbk)，主要只是将样式设置为 `android.R.attr.spinnerStyle`），或者他们使用微调器但重载点击动作创建一个对话框。

当然，困难的部分是创建自定义对话框，其中包含漂亮的月/日/年旋转事物（它们不是旋转器......它们有点像老虎机或其他东西）！

有几种方法可以解决这个问题，这里有一些谷歌文档，你总是可以直接提取[android 源代码](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/1.5_r4/android/widget/DatePicker.java#DatePicker)（尽管有明显的缺点）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-30T23:16:32.160

按钮是最好的方法，您只需要更改按钮样式。我尝试将默认的 android 微调器样式设置为我的按钮，但它无法正常工作。所以我制作了自己的样式（它是默认微调器样式的副本）。这里是：

```
 `<selector xmlns:android="http://schemas.android.com/apk/res/android">
        <item android:state_enabled="false"
              android:drawable="@drawable/spinner_disabled_holo_light" />
        <item android:state_pressed="true"
              android:drawable="@drawable/spinner_pressed_holo_light" />
        <item android:state_pressed="false" android:state_focused="true"
              android:drawable="@drawable/spinner_focused_holo_light" />
        <item android:drawable="@drawable/spinner_default_holo_light" />
    </selector> 
```

`

您将在**..\sdk\platforms\android-%%\data\res\drawable**中找到的图像。

这对我来说很好。这是一种制作按钮微调器样式的简单方法，就像 Google 日历上的微调器一样。

# c# - Asp.net 异步 http 网络请求

> ID：12465116
> 
> 赞同：0
> 
> 时间：2012-09-17T18:28:39.737
> 
> 标签：c#, httpwebrequest

我在从响应中读取全部内容时遇到问题，解码器的长度不是按照响应内容的长度来的，我遇到了问题

```
int read = responseStream.EndRead(asyncResult); 
```

//根据响应，读取的值非常小。

```
int len = rs.StreamDecode.GetChars(rs.BufferRead, 0, read, charBuffer, 0); 
```

下面是我的相同代码

```
private void ReadQtoRCallBack(IAsyncResult asyncResult)
{
   // Get the RequestState object from AsyncResult.
   RequestState rs = (RequestState)asyncResult.AsyncState;

   // Retrieve the ResponseStream that was set in RespCallback. 
   Stream responseStream = rs.ResponseStream;

   // Read rs.BufferRead to verify that it contains data. 
   int read = responseStream.EndRead(asyncResult);
   if (read > 0)
   {
      // Prepare a Char array buffer for converting to Unicode.
      Char[] charBuffer = new Char[BUFFER_SIZE];

      // Convert byte stream to Char array and then to String.
      // len contains the number of characters converted to Unicode.
      int len = rs.StreamDecode.GetChars(rs.BufferRead, 0, read, charBuffer, 0);

      String str = new String(charBuffer, 0, len);

      // Append the recently read data to the RequestData stringbuilder
      // object contained in RequestState.
      RequestData.Append(PureAnalyzer_WebApp.DoubleAt + rs.ResultName + PureAnalyzer_WebApp.DoubleColon);

      // ESResultBE ESObj = new ESResultBE();
      System.Web.Script.Serialization.JavaScriptSerializer JsonSerializer = new System.Web.Script.Serialization.JavaScriptSerializer();
      ESResultBE ObjESResultBE;
      string Result = "";         

      RequestData.Append(Encoding.ASCII.GetString(rs.BufferRead, 0, read).ToString());

      // Continue reading data until 
      // responseStream.EndRead returns –1.
      IAsyncResult ar = responseStream.BeginRead(
                           rs.BufferRead, 0, BUFFER_SIZE,
                           new AsyncCallback(ReadQtoRCallBack), rs);
   }
   else
   {
      // Close down the response stream.
      responseStream.Close();
      if (ResponseFlag[rs.ResultName] != "1")
      {
        ResponseFlag[rs.ResultName] = "1";
        CompleteCount++;
      }
      // Set the ManualResetEvent so the main thread can exit.
      allDone.Set();
   }
   return;
} 
```

# java - 使用 Eclipse 项目中的 JDK

> ID：12465117
> 
> 赞同：2
> 
> 时间：2012-09-17T18:28:43.273
> 
> 标签：java, eclipse

我们正在为我们的项目使用 Eclipse，我们希望对我们使用的 JDK 进行修订控制。（不同的项目需要使用不同的JDK）。我们不想在 Eclipse 中将每个人的系统都配置为具有相同名称的相同 JDK，而是希望将 JDK 作为我们项目的一部分包含在我们的源代码控制工具中，并让项目指向作为项目一部分的 JDK。

我们不知道如何告诉 Eclipse 使用在项目中找到的 JDK。它一直想要一个 JDK 的绝对路径。是否可以使用作为项目一部分的 JDK 并使用相对于项目的路径？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T20:22:01.503

> 是否可以使用作为项目一部分的 JDK 并使用相对于项目的路径？

直接回答：**NO**

您要求绕过 Eclipse 在已安装的运行时环境（在工作区级别定义）和项目的编译器配置（在项目级别定义）之间提供的基本抽象。如果您想使用 Eclipse 中的所有 JDT 功能，您只需要在每个开发人员的每个工作空间上配置已[安装的 JRE 。](http://help.eclipse.org/indigo/topic/org.eclipse.jdt.doc.user/tasks/task-add_new_jre.htm)

但是，我可以想到一种可能不那么标准的方式（我看到 -1 会这么说，这太疯狂了！）来实现您想要的：分发`.metadata`您拥有的预配置工作区的文件夹已经设置了所有 JRE，因此您不必在每台机器上进行安装。这还包括提交每个项目`.settings`的文件夹和`.project .classpath`文件。想要包含 JDK？好吧，您可以将它们中的每一个作为单独的项目放在 SCM 中，并要求每个开发人员导入和配置它们。如果您在分发模板工作区之前对其进行了此操作，那么它将不仅具有 JDK，而且还具有`.metadata`指向它们的指向。

这有什么问题？**可能一切。**

高手是怎么做到的？Maven 和`maven-compiler-plugin`（并且不提交任何 IDE 特定文件）。这让开发人员可以自由选择他们想要的任何 IDE，并且大多数支持从 POM 文件自动配置项目：目标 JDK、依赖项等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T19:00:42.813

这可能不是您正在寻找的方法，但一种选择是使用`SUBST` 用于项目根目录的驱动器号。

在所有开发机器上使用相同的项目路径具有许多优势。这种策略对于在单个代码行上工作的开发人员最有用，但即使我的机器上有多个代码行，我也成功地使用了它，并根据需要更改 subst。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T18:40:25.980

您可以在 Eclipse 中配置 JDK 版本。右键单击您的项目，选择属性，转到 Java 编译器，然后您可以为您的项目选择特定于项目的 Java 版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-18T02:50:15.823

一种方法是在所有机器上安装所有 JDK，并根据需要使用 JAVA_HOME/PATH 变量来指向适当的 JDK 安装。您只需双击即可编写一个简单的批处理文件来处理环境变量设置。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-18T05:56:13.880

不，那是不可能的。

要么使用 Maven 来声明所有依赖项，包括要使用的 SDK。或者使用[Yoxos](https://yoxos.eclipsesource.com/)或[Secure Delivery Center](http://www.genuitec.com/sdc/)集中定义 Eclipse 配置，然后在启动 Eclipse 时将其部署到您的开发人员桌面。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-09-17T18:45:46.823

您要检查整个 JDK 吗？这似乎可能会大大降低您的 SCM 速度，因为它必须尝试跟踪很多大的二进制文件，而这些文件的差异并不大。为什么不使用像 Maven 这样的工具来声明要使用的 JRE 版本？

# c# - 如何使用 gsm 调制解调器接听电话并在接听电话后检测来电者的按键

> ID：12465122
> 
> 赞同：4
> 
> 时间：2012-09-17T18:29:13.353
> 
> 标签：c#, modem, at-command

我想编写代码，使用 gsm 调制解调器接听电话并在接听电话后检测来自呼叫者的按键。我可以使用移动调制解调器接听电话，但对于边缘调制解调器，它显示“NO CARRIER”并且来电者听到忙音。另外，我想接听来自 gsm 调制解调器的电话并检测来电者手机上的按键。我正在使用 C#。我只需要AT命令。

# ruby-on-rails-3 - Rails：从嵌套模型中检索多态数据

> ID：12465125
> 
> 赞同：0
> 
> 时间：2012-09-17T18:29:16.707
> 
> 标签：ruby-on-rails-3, activerecord, controller

我正在尝试从一个盒子中检索所有项目的数据，一个盒子可以有隔间，我想在盒子级别获取所有隔间信息。物品是多态的，因为盒子不一定有隔间。

模型

```
class Box < ActiveRecord::Base
  has_many :compartments
  has_many :items, :as => :itemable
end 
```

在我的控制器中，我可以通过以下方式获得结果：

```
@box = Box.find(params[:id])

@itemable = @box.compartments.first

@itemable = @box.compartments.last 
```

看法

```
<% @items.each do |item| %>
<%= item.name %>
<% end %> 
```

但如果我再试试

```
@itemable = @box.compartments 
```

或者

```
@itemable = @box.compartments.find(:all) 
```

我得到错误

```
undefined method `items' for #<ActiveRecord::Array> 
```

或者

```
undefined method `items' for #<ActiveRecord::Relation> 
```

任何人都可以帮助从所有隔间获取结果吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T01:57:23.720

所以在隔间里你有

```
belongs_to :box
has_many :items, :as => :itemable 
```

是这样吗？ `@box.compartments`应该返回一组隔间对吗？听起来好像是被某种`items`方式调用了`@box.compartments`

# java - 简单的 Java 倒数计时器

> ID：12465127
> 
> 赞同：2
> 
> 时间：2012-09-17T18:29:22.893
> 
> 标签：java, timer, countdown

我正在用 Java 做一个学校项目，需要弄清楚如何创建一个计时器。我正在尝试构建的计时器应该从 60 秒开始倒计时。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T18:34:42.413

您可以使用：

```
 int i = 60;
 while (i>0){
  System.out.println("Remaining: "i+" seconds");
  try {
    i--;
    Thread.sleep(1000L);    // 1000L = 1000ms = 1 second
   }
   catch (InterruptedException e) {
       //I don't think you need to do anything for your particular problem
   }
 } 
```

或类似的东西

编辑，我知道这不是最好的选择，否则你应该创建一个新类：

## 这样做的正确方法：

```
public class MyTimer implements java.lang.Runnable{

    @Override
    public void run() {
        this.runTimer();
    }

    public void runTimer(){
        int i = 60;
         while (i>0){
          System.out.println("Remaining: "+i+" seconds");
          try {
            i--;
            Thread.sleep(1000L);    // 1000L = 1000ms = 1 second
           }
           catch (InterruptedException e) {
               //I don't think you need to do anything for your particular problem
           }
         }
    }

} 
```

然后你在你的代码中做： Thread thread = new Thread(MyTimer);

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T18:37:18.950

查看[Timer](http://docs.oracle.com/javase/6/docs/api/javax/swing/Timer.html)，[ActionListener](http://docs.oracle.com/javase/6/docs/api/java/awt/event/ActionListener.html)，[Thread](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Thread.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-14T12:21:53.157

**用Java倒计时很简单。假设你想倒计时 10 分钟，所以试试这个。**

```
 int second=60,minute=10;
            int delay = 1000; //milliseconds
ActionListener taskPerformer = new ActionListener() {
  public void actionPerformed(ActionEvent evt) {
      second--;
      // put second and minute where you want, or print..
      if (second<0) {
          second=59;
          minute--; // countdown one minute.
          if (minute<0) {
              minute=9;
          }
      }
  }
};
new Timer(delay, taskPerformer).start(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-17T18:32:57.093

有很多方法可以做到这一点。考虑使用睡眠功能，让它在每次迭代之间睡眠 1 秒并显示剩余的秒数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-17T18:34:18.033

由于您没有提供详细信息，因此如果您不需要它完全准确，这将起作用。

```
for (int seconds=60 ; seconds-- ; seconds >= 0)
{
    System.out.println(seconds);
    Thread.sleep(1000);
} 
```

# javascript - Ember.js 嵌套的 ArrayController 和模型

> ID：12465128
> 
> 赞同：1
> 
> 时间：2012-09-17T18:29:25.497
> 
> 标签：javascript, ember.js, javascript-framework, javascriptmvc

我有一个嵌套数据结构如下：

```
Job:{  
     JobId: 1,  
     NumberTrackr: 2,  
     Trackrs: [  
                1 : { TaskTrackrID: a, 
                      NumberSlots:1, 
                      slots: [
                             slot1: {uniqueId:foo, you: get, the:[point, by, now]}
                              ]
                    },
                2 : { TaskTrackrID: b, 
                      NumberSlots:1, 
                      slots: [
                             slot1: {uniqueId:bar, you: get, the:[point, by, now]}
                              ]
                    }
            ]
} 
```

我的应用程序使用此数据层次结构（计算特定 Trackr 的 'children's' foo 属性的总和）以及作为一个整体的每个数据级别（例如，从所有插槽的内容计算统计信息，而不考虑它们的“父”TaskTracker） .

我是 Ember 的新手，但我正在考虑为每个对象级别（TaskTrackr、Slot 等）创建一个模型。该模型将包含上面显示的所有属性，以及某种子模型数组（使用数组控制器？）。所述子模型也将具有属性以及它们自己的子模型阵列。重要的是，高级对象可以具有从其子对象计算的计算属性。我可以作为一个整体访问每个级别并修改特定属性也很重要。

什么样的代码可以让我以树的形式以及在级别的基础上访问这些数据？

非常感谢你的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T03:16:26.643

看看[Ember 数据](https://github.com/emberjs/data)。它支持这些类型的关系。

```
App.Job = DS.Model.extend({
  trackers: DS.hasMany('App.Tracker')
})

App.Tracker = DS.Model.extend({
  job: DS.belongsTo('App.Job');
})

// ... and so on

var job = App.Job.createRecord();
job.get('trackers').pushObject(App.Tracker.createRecord()); 
```

只是要注意。您提到 using`ArrayController`并且您可能会在 Ember 应用程序中使用它。但是，在对数据/关系建模时，您不会使用任何控制器。你应该能够做你上面粘贴的只使用`DS.Model`

# postgresql - Postgres：在更新之前获取目标记录的锁定

> ID：12465132
> 
> 赞同：0
> 
> 时间：2012-09-17T18:29:36.237
> 
> 标签：postgresql, deadlock

我正在使用 PostgreSQL 语句。我的目标是修改语句以避免死锁问题。目前，有 2 个语句更新相同的记录。这必须在某些时候发生并且无法避免，因为这是生产中的实际操作。

我想要做的是创建`UPDATE`将获得锁定所有将被更新的记录的语句。我已经尝试过`SELECT FOR UPDATE`, `LOCK TABLE as exclusive mode`,`UPDATE`在一个`LOOP`“。两者都没有为我工作。僵局仍然发生。你们对此有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T09:52:55.690

请注意使用[咨询锁定](http://www.postgresql.org/docs/9.1/static/explicit-locking.html#ADVISORY-LOCKS)，以防您无法确定要锁定的确切关系或记录。

# c# - 以编程方式将多个类别添加到 Outlook 2010

> ID：12465136
> 
> 赞同：3
> 
> 时间：2012-09-17T18:29:58.047
> 
> 标签：c#, outlook-2010

我正在尝试使用 C# 在 Outlook 2010 中创建多个类别。我能够成功生成将创建一个类别的可执行文件，但是当我添加代码以创建第二个类别时，它仍然只会添加第一个而不是第二个。如果第一个类别存在，它将添加第二个类别，但不会同时从头开始创建两者。

下面是我的代码。任何帮助是极大的赞赏。

```
using System;
using System.Linq;
using Outlook = Microsoft.Office.Interop.Outlook;
using Microsoft.Office.Interop.Outlook;

namespace OutlookCategory
{
    class Program
    {
        static void Main(string[] args)
        {
            AddACategory();
        }

        private static void AddACategory()
        {
            var app = new Application();
            Outlook.Categories categories = app.Session.Categories;
            if (!CategoryExists("TEST 1", app))
            {
                categories.Add("TEST 1", Outlook.OlCategoryColor.olCategoryColorDarkBlue);
            }
            if (!CategoryExists("TEST 2", app))
            {
                categories.Add("TEST 2", Outlook.OlCategoryColor.olCategoryColorDarkBlue);
            }

        }

        private static bool CategoryExists(string categoryName, Application app)
        {
            try
            {
                Outlook.Category category =
                    app.Session.Categories[categoryName];
                if (category != null)
                {
                    return true;
                }
                else
                {
                    return false;
                }
            }
            catch { return false; }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T17:40:37.260

我最终通过创建一个带有我的类别名称及其相关类别颜色的管道分隔文本文件来完成此操作。

然后，我循环浏览了在 Outlook 中创建所有类别的文本文件。

```
using System;
using System.IO;
using Microsoft.Office.Interop.Outlook;
using Outlook = Microsoft.Office.Interop.Outlook;

namespace OutlookCategory
{
    class Program
    {
        static void Main(string[] args)
        {
            AddACategory();
        }
        private static void AddACategory()
        {
            string[] lines = File.ReadAllLines(@"C:\CategoryList.txt");
            var app = new Application(); 
            foreach (string line in lines)
            {
                string[] LineArray = line.Split('|');                               
                var color = LineArray[1];

                Outlook.Categories categories = app.Session.Categories;
                //Add categories
                if (CategoryExists(LineArray[0], app) == false)
                {
                    categories.Add(LineArray[0], color);
                }
            }
        }
        private static bool CategoryExists(string categoryName, Application app)
        {
            try
            {
                Outlook.Category category =
                    app.Session.Categories[categoryName];
                if (category != null)
                {
                    return true;
                }
                else
                {
                    return false;
                }
            }
            catch { return false; }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-03T02:03:58.617

已经提供的答案对我没有帮助。在添加和删除类别时，我仍然会得到参差不齐的结果。我可以通过尝试添加/删除来解决这个问题，然后重新获取类别并循环直到根据需要添加/删除项目。

这是从 LinqPad 截取的代码，我将在其中删除所有类别，添加回我自己的类别，然后列出一些类别及其值。自从我切换到 while/loop 检查以来，这一直没有问题。我尝试了几个不同的睡眠时间，似乎并没有太大的不同。我猜在新类别真正“进入”数据存储之前，outlook 必须做一些事情。无论如何，我不想在这上面花费大量时间，这对我有用。我在 Windows 7 上使用 Outlook 2010。不确定新版本的 Office 是否有同样的问题。

```
void Main()
{

    //using Microsoft.Office.Interop.Outlook
    Application oApp = new Application();
    NameSpace oSes = oApp.Session;
    Categories oCats = oSes.DefaultStore.Categories;

    //remove existing categories
    var catids = (from a in oCats.Cast<Category>() select a.CategoryID).ToArray();
    for (int i = 0; i < catids.Count(); i++)
    {
        var cid = catids[i];
        cid.Dump();
        while(oCats[cid] != null)
        {
            oCats.Remove(cid);
            oCats = oSes.DefaultStore.Categories;
            Thread.Sleep(100);
        }
    }

    //dictionary to hold my categories
    Dictionary<string,OlCategoryColor> dCats = new Dictionary<string,OlCategoryColor>();
    dCats.Add("Category One",OlCategoryColor.olCategoryColorRed);
    dCats.Add("Category Two",OlCategoryColor.olCategoryColorOrange);
    dCats.Add("Category Three",OlCategoryColor.olCategoryColorPeach);
    dCats.Add("Category Four",OlCategoryColor.olCategoryColorYellow);

    foreach (var dCat in dCats)
    {
        var cid = dCat.Key;
        cid.Dump();
        while(oCats[cid] == null)
        {
            oCats.Add(cid,dCat.Value);
            oCats = oSes.DefaultStore.Categories;
            Thread.Sleep(100);
        }
    }

    //show categories
    var cats = from c in oCats.Cast<Category>() select new {
        c.CategoryBorderColor,
        c.CategoryGradientBottomColor,
        c.CategoryGradientTopColor,
        c.CategoryID,
        c.Class,
        c.Color,
        c.Name,
        c.ShortcutKey
    };
    cats.Dump();

} 
```

# java - Spring LDAP：对等方重置连接

> ID：12465138
> 
> 赞同：7
> 
> 时间：2012-09-17T18:30:09.023
> 
> 标签：java, spring, ldap

我正在使用 Spring LdapTemplate 类来访问 ldap。我正在使用一个 ldap 连接池（PoolingContextSource 类）来避免在运行时一直创建连接。但是，有时在我的应用程序中会遇到此异常：

```
javax.servlet.ServletException: org.springframework.ldap.CommunicationException: Connection reset; 
nested exception is javax.naming.CommunicationException: Connection reset [Root exception is java.net.SocketException: Connection reset]; 
Remaining name: 'ou=memberlist,ou=mygroups,o=mycompany.com' 
```

(...)

我的 ldap 类在以下 xml 中定义

```
<bean id="contextSource" class="com.ibm.tp4.spring.ldap.CustomPoolingContextSource">
  <property name="contextSource" ref="contextSourceTarget" />
  <property name="testWhileIdle" value="true" />
  <property name="minEvictableIdleTimeMillis" value="300000" />
  <property name="timeBetweenEvictionRunsMillis" value="10000"/>
  <property name="dirContextValidator">
    <bean class="org.springframework.ldap.pool.validation.DefaultDirContextValidator" />
  </property>
</bean>

<bean id="contextSourceTarget" class="org.springframework.ldap.core.support.LdapContextSource">
  <property name="url" value="${ldap.url}" />
  <property name="pooled" value="false" />
  <property name="anonymousReadOnly" value="true" />
</bean>

<bean id="ldapTemplate" class="org.springframework.ldap.core.LdapTemplate">
  <constructor-arg ref="contextSource" />
</bean>

<bean id="myLdapResolver" class="com.ibm.tp4.model.service.user.MyLdapResolver">
  <constructor-arg ref="ldapTemplate" />
  <property name="ldapUserSearchBase" value="${ldap.user.search_base}" />
  <property name="ldapUserEmailAddressField" value="${ldap.user.email_address}" />
  <property name="ldapAttributes" value="${ldap.user.attributes}" />
</bean> 
```

有没有人遇到过这个问题并可以提出解决方案？

我考虑过在池属性中使用 testOnReturn 参数，而不是现在使用的连接驱逐器。当我这样做时，当我在浏览器中运行我的 Web 应用程序时收到以下警告：

```
WARN [org.springframework.ldap.pool.validation.DefaultDirContextValidator] - 
DirContext 'javax.naming.ldap.InitialLdapContext@d150d15' failed validation with an 
exception.javax.naming.OperationNotSupportedException: [LDAP: error code 53 - Unwilling To Perform]; 
Remaining name: '' 
```

不久之后，我得到了这个例外：

```
org.springframework.dao.DataAccessResourceFailureException: Failed to borrow DirContext from pool.; nested exception is java.util.NoSuchElementException: Could not create a validated object, cause: ValidateObject failed  
org.springframework.ldap.pool.factory.PoolingContextSource.getContext(PoolingContextSource.java:425) 
```

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T04:54:36.093

看起来超时定义太低了。Oracle 有一个官方站点，可以让您找出问题的根源，很可能不是“Spring”，而是 Sun Ldap 连接器或您的 Ldap 服务器。很多人反对提供链接，但我根本无法复制此页面，也许您可​​以尝试他们网站上的“原始”声明，看看它是否也会发生。它将使您更接近您的解决方案。（可能是 ldap 超时配置）

[http://docs.oracle.com/javase/tutorial/jndi/newstuff/readtimeout.html](http://docs.oracle.com/javase/tutorial/jndi/newstuff/readtimeout.html)

```
env.put(Context.INITIAL_CONTEXT_FACTORY,
    "com.sun.jndi.ldap.LdapCtxFactory");
env.put("com.sun.jndi.ldap.read.timeout", "1000");
env.put(Context.PROVIDER_URL, "ldap://localhost:2001");

Server s = new Server();

try {

    // start the server
    s.start();

   // Create initial context
   DirContext ctx = new InitialDirContext(env);
   System.out.println("LDAP Client: Connected to the Server");
        :
        :
} catch (NamingException e) {
   e.printStackTrace();
} 
```

# ios - 自定义表格单元格、自定义 XIB 和长按识别器 - 不能让它们一起工作

> ID：12465142
> 
> 赞同：0
> 
> 时间：2012-09-17T18:30:16.350
> 
> 标签：ios, uitableview, uigesturerecognizer

我有一个自定义单元格，上面有一个按钮。我想尝试使用长按。

创建单元格的代码如下所示：

```
CustomCell *cell = (CustomCell *)[aTableView dequeueReusableCellWithIdentifier:@"CustomCell"];
if (!cell) 
{
    cell = [[[NSBundle mainBundle] loadNibNamed:@"CustomCell" owner:self options:nil] lastObject];

} 
```

（ETC）

所以我这样做了：

```
 CustomCell *cell = (CustomCell *)[aTableView dequeueReusableCellWithIdentifier:@"CustomCell"];
    if (!cell) 
    {
//      cell = [[[NSBundle mainBundle] loadNibNamed:@"CustomCell" owner:self options:nil] lastObject];
        cell = [[[NSBundle mainBundle] loadNibNamed:@"CustomCellDwellToSpeak" owner:self options:nil] lastObject];

    } 
```

然后我复制了原始的xib。删除了按钮。在单元格上放置一个 UILongPressGestureRecognizer，并通过从识别器向文件所有者控制拖动来创建目标：

```
- (IBAction)longPress:(UILongPressGestureRecognizer *)sender; 
```

![在此处输入图像描述](../Images/c598b74e2d42b63745dd6dccf973464f.png) 但是，一旦我开始生成单元格，就会出现以下错误：

```
TypOHD[41541:c07] -[UILongPressGestureRecognizer label]: unrecognized selector sent to instance 0x17d0be60 
```

那是怎么回事？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T05:46:12.367

我从来没有得到或找到这个问题的答案。我学到的是这个计划有潜在的缺陷。显然，将您赢得的手势识别器与表格视图混合在一起是灾难的根源，或者至少是令人心碎的。

在我的情况下，我决定使用一个固定的布局，它只包含无论如何都会显示的项目数量。在我的应用程序中，出于历史原因，我实际上只使用了一个表格，并且从不需要显示超过 7 个项目。

一种解决方法和一种技巧，但它对我有用。

# c# - WebBrowser 控制截图

> ID：12465146
> 
> 赞同：0
> 
> 时间：2012-09-17T18:30:33.927
> 
> 标签：c#, webbrowser-control, screenshot

我正在尝试使用 c# windows 窗体应用程序获取屏幕截图。源代码链接：http: [//4rapiddev.com/csharp/c-generate-website-screenshot-and-save-thumbnail/](http://4rapiddev.com/csharp/c-generate-website-screenshot-and-save-thumbnail/)

我用注册表项更改了浏览器仿真。(HKLM > SOFTWARE > Microsoft > Internet Explorer > Main > FeatureControl > FEATURE_BROWSER_EMULATION)。

但是我生成的图像仍然出现错误，背景图像必须是全屏（超大）。

示例网址：[http ://www.fotografcisec.com/fotografci-adi/serkan-baydemir](http://www.fotografcisec.com/fotografci-adi/serkan-baydemir)

![true_image](../Images/4d4b7469f057c0d039b59c62834b3c18.png) ![错误的图像](../Images/24c0f1142256bda655de0ed3df5f863e.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T19:00:09.967

您的背景是使用 JavaScript 绘制的。可能是浏览器控件不能很好地处理 JavaScript。尝试将 Web 浏览器控件添加到表单中，在控件中加载该 URL，然后查看页面呈现方式。也许一旦它完全渲染，再试一次 DrawToBitmap。例如，在页面上添加一个按钮，并在浏览器控件完成渲染后让它保存到位图。

# jquery-mobile - 如何使用 jquery mobile 在复选框标签旁边添加一个文本框？

> ID：12465148
> 
> 赞同：0
> 
> 时间：2012-09-17T18:30:39.047
> 
> 标签：jquery-mobile, checkbox, textbox, label

如何使用 jquery mobile 在复选框标签旁边添加一个文本框？它应该在一行中（复选框->标签（用于复选框）->文本框）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T01:10:26.110

如果要在与其引用元素相同的行中添加标签，例如：

> 我的图例 [ ] 复选框标签

您可能想尝试使用字段容器，带有`data-role="fieldcontain"`.

例如：

```
<div data-role="fieldcontain">
    <fieldset data-role="controlgroup">
        <legend>Agree to the terms:</legend>
        <input type="checkbox" name="checkbox-2" id="checkbox-2" class="custom" />
        <label for="checkbox-2">I agree</label>
    </fieldset>
</div> 
```

上面的代码将为您提供：

> 同意条款：[] 我同意

**查看在线文档以获取更多信息：http:** [//jquerymobile.com/demos/1.1.1/docs/forms/checkboxes/](http://jquerymobile.com/demos/1.1.1/docs/forms/checkboxes/)

* * *

现在，如果您想在一行中添加多个元素（= 不同列中的多个元素），我的意思不仅仅是一个标签及其元素，您可能想查看 jQuery Mobile 的：http `Layout grids`: [//jquerymobile.com/demos/1.1 .1/docs/content/content-grids.html](http://jquerymobile.com/demos/1.1.1/docs/content/content-grids.html)

* * *

考虑到您的示例案例，我认为您可能想尝试结合使用上述两种方法。所以，你可以尝试这样的事情：

```
<div class="ui-grid-a">

    <!-- FIRST COLUMN -->
    <div class="ui-block-a">
        <div data-role="fieldcontain">
            <fieldset data-role="controlgroup">
                <legend>Agree to the terms:</legend>
                <input type="checkbox" name="checkbox-2" id="checkbox-2" class="custom" />
                <label for="checkbox-2">I agree</label>
            </fieldset>
        </div>
    </div>

    <!-- SECOND COLUMN -->
    <div class="ui-block-b">
        <input type="text"/>
    </div>

</div> 
```

希望这可以帮助。

# xcode - 如何使用情节提要正确地转到嵌入式选项卡栏和导航控制器？

> ID：12465150
> 
> 赞同：1
> 
> 时间：2012-09-17T18:31:03.867
> 
> 标签：xcode, uinavigationcontroller, uitabbarcontroller, uistoryboardsegue

我有一个应用程序，用户可以从选择轮中选择他们的国家。出现警报并要求他们确认更改。如果他们确认，它会将他们带到不同的视图，然后他们可以从类别列表中选择以显示信息......

类别列表嵌入在导航控制器中，以方便从详细视图“返回”移动到类别选择视图。

整个应用程序嵌入在标签栏控制器中。

它工作正常（在选择他们的国家后，他们被带到选择类别屏幕），除了现在选择类别失去了与选项卡栏控制器的连接，并且无法返回应用程序的其他部分。

这是我的警报视图代码：

```
- (void)alertView:(UIAlertView *)actionSheet clickedButtonAtIndex:(NSInteger)buttonIndex {

if (buttonIndex == 0) {
NSLog(@"ok");

//I tried the following but it doesn't do anything
//SelectCategory *switchtocategory = [[SelectCategory alloc] init];
//[self.navigationController pushViewController:switchtocategory animated:YES];

//the following works but loses the tab/navigation bars
[self performSegueWithIdentifier: @"GoToCategory" sender: self];

    } else {

    NSLog(@"cancel");

} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T17:25:57.240

找到答案实际上是关于了解 Tab Bar Controller 的角色，它如何默认为根视图控制器，然后如何使用它来访问各种视图控制器，而不是试图进行 segue。阅读 Apple 文档对此有所帮助，但代码变得非常简单：

```
- (void)alertView:(UIAlertView *)actionSheet clickedButtonAtIndex:(NSInteger)buttonIndex
{

if (buttonIndex == 0) {

    NSLog(@"ok");

//the following transitions to tab #3 when the alertView is touched/clicked/dismissed

    [self.tabBarController setSelectedIndex:2];

    } else {

    NSLog(@"cancel");

}
} 
```

# android - 如何确定进度条的结束位置（像素坐标或其他）？

> ID：12465154
> 
> 赞同：2
> 
> 时间：2012-09-17T18:31:25.987
> 
> 标签：android

简单地说，我有一个带有文本的进度条，如下所示：

```
<ProgressBar
    android:id="@+id/progressbar"
    style="?android:attr/progressBarStyleHorizontal"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_alignParentRight="true"
    android:layout_marginLeft="20dp"
    android:layout_marginRight="20dp"    
     />

<TextView
    android:id="@+id/text_on_progressbar"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBottom="@+id/progressbar"
    android:layout_alignLeft="@+id/progressbar"
    android:text="text"
/> 
```

问题是，我希望“文本”只直接出现在当前进度的左侧。因此，它对当前端点是正确的。关于如何做到这一点的任何想法？因此，文本随着进度而移动。

那么有没有办法找到显示进度的当前端点的像素坐标呢？这样我就可以动态地将 textview 放在那里。

或者有没有办法实际访问progressbar.xml 本身来编辑它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T19:06:02.340

您可以根据视图的完整宽度和当前进度计算显示进度的端点。简单示例：如果视图为 400 像素宽且进度为 50%，则端点将是 400 的 50%，即 200（当然加上进度视图的左侧位置，例如边距或填充...）

# php - AWeber API：subscribers->create() 在脚本中没有按预期工作

> ID：12465156
> 
> 赞同：2
> 
> 时间：2012-09-17T18:31:44.317
> 
> 标签：php, aweber

AWeber API 没有明确记录的程度不能被足够强调（他们的示例脚本也不能很好地工作）。编写了以下脚本，因此我可以为一个用户订阅从表单中选择的多个列表。

无论如何，当订阅者->创建方法被注释掉时，这个脚本就可以工作。我可以看到我单独的列表 id 提供给列表 url，然后获取并返回列表数组数据。但是一旦重新添加了 create 方法，它只会遍历一次循环，将 email 参数订阅到它找到的第一个列表，然后脚本停止：

```
<!DOCTYPE html>
<html>
<body>
<?php

require_once('aweber_api/aweber_api.php');
require_once('aweber_api/aweber_creds.php');

print "----<br>";
$aweber->adapter->debug = true;
   print "----<br>";
//call the api key...
$aweber = new AWeberAPI($consumerKey, $consumerSecret);
$account = $aweber->getAccount($accessKey, $accessSecret);

$feeds = array_values($_GET);
//print form array
print "FORM ARRAY ";
print_r ($feeds);
echo "--<br>";
foreach($feeds[1] as $feed){
    echo "--<br>";
try {
       print "<br> Feed : $feed";
       $listURL = "/accounts/{$account_id}/lists/{$feed}";
       $list = $account->loadFromUrl($listURL);
       $lists = $account->lists->find(array('name' => $listName));
       print_r ($list);
     print "<br><br><br>";
        # create a subscriber
         $params = array(
             'email' => $feeds[0],
          );
      $subscribers = $list->subscribers;
      $new_subscriber = $subscribers->create($params);
      print "HERE " . $new_subscriber->email;
      # success!
      print "$new_subscriber->email was added to the $list->name list!";

} catch(AWeberAPIException $exc) {
    print "<h3>AWeberAPIException:</h3>";
    print " <li> Type: $exc->type              <br>";
    print " <li> Msg : $exc->message           <br>";
    print " <li> Docs: $exc->documentation_url <br>";
    print "<hr>";
}
}
?>
</body>
</html> 
```

为了上下文，这里有一些表单参数被传递到这个脚本中：

```
somehostnamehere.com/phptest/aweber_api/hltmt_addsubsv1.php?email=user22344%40gmail.com&aweber_list%5B%5D=2531241&aweber_list%5B%5D=2531242&aweber_list%5B%5D=2531243&aweber_list%5B%5D=2531244 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-02T16:21:34.643

你应该有这样的：`...php?email=user22344@gmail.com` 所以，使用`urldecode()`，例如：

```
 $final = 'somehostnamehere.com/phptest/aweber_api/hltmt_addsubsv1.php?'. urldecode('email=user22344%40gmail.com&aweber_list%5B%5D=2531241&aweber_list%5B%5D=2531242&aweber_list%5B%5D=2531243&aweber_list%5B%5D=2531244');
 echo $final; 
```

# php - 如何实现接受无限数量的客户端的套接字服务器？

> ID：12465165
> 
> 赞同：1
> 
> 时间：2012-09-17T18:32:19.390
> 
> 标签：php, sockets

我正在为未知数量的客户端实现套接字服务器，我在互联网上发现了很多示例，其中最大数量的客户端被传递给 socket_listen 方法，但我不知道我的客户端数量可能是多少。

如果我在没有 $backlog 的情况下调用 socket_listen($sock)，它将适用于多客户端服务器吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T19:29:08.707

您可以在本地执行此操作 - 但对于这个[0MQ 是答案](http://vimeo.com/20605470)- 请参阅[Ian](https://github.com/ianbarber/ZeroMQ-Talk/tree/master/chat)精彩演讲中的聊天示例

例如 Server.php：

```
$ctx = new ZMQContext();
$pub = $ctx->getSocket(ZMQ::SOCKET_PUB);
$pub->bind('tcp://*:5566');
$pull = $ctx->getSocket(ZMQ::SOCKET_PULL);
$pull->bind('tcp://*:5567');

while(true) {
    $message = $pull->recv();
    echo "Got ", $message, PHP_EOL;
    $pub->send($message);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T18:58:05.903

已经有一段时间了，但让我试一试。

通常，当您在侦听器上获得连接时，您应该创建一个线程来处理该连接并返回侦听。该线程将占用您服务器上的内存，因此不能有无限数量，因为您没有无限内存。一旦线程（或分叉）完成连接，应该关闭连接以释放内存并允许另一个线程。

但是，一旦达到限制，新请求仍将获得连接，但它们将排队等待，直到关闭旧连接后才会处理。

虽然我在负载共享方面没有任何经验，但我认为可以将请求发送给其他服务器以增加可以同时保持打开的连接数量。

这就是 TCP 的工作原理。也许您需要一个带有发布/订阅方案的 UDP 实现？由于 UDP 没有连接，它可以以更少的内存发布到更多的接收器。

# ruby - 如何使用正确的 gemset 加载 rvm 然后执行 rake 任务

> ID：12465166
> 
> 赞同：1
> 
> 时间：2012-09-17T18:32:26.940
> 
> 标签：ruby, bash, scripting, rvm

编写一个 cds 到另一个目录的脚本，加载正确的 rvm rvmrc 文件，然后允许我执行 rake 任务。

我有以下脚本在我的计算机上运行，​​但是当其他人将其拉到他们的机器上时，他们会收到以下错误“Ruby rvmrc is not installed”。

```
Bundler.with_clean_env do
  Dir.chdir("../some_dir") do
    puts `source ~/.rvm/scripts/rvm && rvm --with-rubies rvmrc exec -- rake some_task`
  end
end 
```

我有最新版本的 rvm（他们也是），我在 mt.lion

我试过像这样创建一个bash函数......

```
function foo {
  [[ -s "$HOME/.rvm/scripts/rvm" ]] && . "$HOME/.rvm/scripts/rvm" && rvm use @my_gemset
} 
```

或者，替换此行

```
rvm --with-rubies rvmrc exec 
```

与...之类的东西

```
rvm rvmrc load
rvm use <gemset>
rvm env --path -- ree-1.8.7@some_gemset 
```

但没有一个奏效。谢谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T11:07:37.333

这应该工作：

```
~/.rvm/bin/rvm rvmrc trust ../some_dir
~/.rvm/bin/rvm in ../some_dir do rake some_task 
```

# php - Symfony2 异常类，为什么要使用 throw new $class？

> ID：12465176
> 
> 赞同：3
> 
> 时间：2012-09-17T18:33:19.293
> 
> 标签：php, symfony

我正在查看 Symfony2 类，我发现了类似的东西

```
try {
            return $this->parseSelectorGroup($stream);
        } catch (\Exception $e) {
            $class = get_class($e);

            throw new $class(sprintf('%s at %s -> %s', $e->getMessage(), implode($stream->getUsed(), ''), $stream->peek()), 0, $e);
        } 
```

他们为什么使用

```
 $class = get_class($e);

        throw new $class 
```

这样的语法。这样做的目的是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T18:40:19.063

我不是那行代码的原作者，所以我只能*假设*为什么这样做。

如代码所示，异常的标准消息正在使用字符串处理类的附加信息（getUsed，peek - 听起来像流缓冲区/解析器/扫描器/窥视器）进行扩展。

消息被编辑，然后抛出同一类的新对象。

*通常：*当您在变量中有一个类名并想要创建该类的新实例时，您可以简单地使用：

```
$className = "ClassName";
$instance = new $className(); 
```

这是使用捕获的异常类名在此处完成的，请参阅[`get_class`](http://php.net/get_class).

*进一步说明：*此代码在概念上被破坏，因为它使用了一个具有未定义接口的类作为其构造函数。然后它使用构造函数而不知道它的构造函数。

可能隐藏了一些信息，但这种情况不会发生。所以这只是一个进一步的说明。你应该有具体的理由来做这样的事情，所以这样做是有原因的，可能有一些设计决策没有被你发布的一些代码行记录。所以要小心处理。

# mysql - 使用 LIMIT 和 ORDER BY col ASC 获取最后 X 行

> ID：12465180
> 
> 赞同：1
> 
> 时间：2012-09-17T18:33:35.833
> 
> 标签：mysql, sql-order-by, limit

此查询用于检索一些消息，它会返回所有消息：

```
$q = "
    SELECT *
    FROM pms
    WHERE
        (
            (id_to = $id and id_from = ".sesion().") 
            OR 
            (id_from = $id and id_to = ".sesion().")
        )
        AND (id > $from)
    ORDER by fecha ASC"; 
```

问题是我想获得最后 50 个元素，但我认为它唯一可能使用 DESC 排序..

我该怎么做？

我需要先计算多少行然后我可以使用`LIMIT $many-$ipp,$many`吗？或者有没有办法反转结果顺序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T18:36:33.787

只需将您的查询设为子查询：

```
SELECT * FROM
(
    SELECT *
    FROM pms
    WHERE
        (
            (id_to = $id AND id_from = ".sesion().")
            OR (id_from = $id and id_to = ".sesion().")
        )
        AND id > $from
    ORDER BY fecha DESC
    LIMIT 50
) q1
ORDER BY fecha ASC 
```

# ssh - EC2重启后无法通过ssh访问

> ID：12465181
> 
> 赞同：12
> 
> 时间：2012-09-17T18:33:38.640
> 
> 标签：ssh, amazon-ec2, amazon-web-services

我通过 ssh 很好地连接了我的 ec2 实例，在添加新的 EBS 卷后通过“sudo shutdown -r now”重新启动了机器

之后我尝试使用以下命令进行访问：

```
ssh -v  -i primary_key.pem ubuntu@ec2-23-22-245-160.compute-1.amazonaws.com 
```

这是重新调整如下：

```
OpenSSH_5.6p1, OpenSSL 0.9.8r 8 Feb 2011
debug1: Reading configuration data /Users/caveman/.ssh/config
debug1: Reading configuration data /etc/ssh_config
debug1: Applying options for *
debug1: Connecting to ec2-23-22-245-160.compute-1.amazonaws.com [23.22.245.160] port 22.
debug1: Connection established.
debug1: identity file primary_key.pem type -1
debug1: identity file primary_key.pem-cert type -1
debug1: Remote protocol version 2.0, remote software version OpenSSH_5.9p1 Debian-5ubuntu1
debug1: match: OpenSSH_5.9p1 Debian-5ubuntu1 pat OpenSSH*
debug1: Enabling compatibility mode for protocol 2.0
debug1: Local version string SSH-2.0-OpenSSH_5.6
debug1: SSH2_MSG_KEXINIT sent
debug1: SSH2_MSG_KEXINIT received
debug1: kex: server->client aes128-ctr hmac-md5 none
debug1: kex: client->server aes128-ctr hmac-md5 none
debug1: SSH2_MSG_KEX_DH_GEX_REQUEST(1024<1024<8192) sent
debug1: expecting SSH2_MSG_KEX_DH_GEX_GROUP
debug1: SSH2_MSG_KEX_DH_GEX_INIT sent
debug1: expecting SSH2_MSG_KEX_DH_GEX_REPLY
debug1: Host 'ec2-23-22-245-160.compute-1.amazonaws.com' is known and matches the RSA host key.
debug1: Found key in /Users/caveman/.ssh/known_hosts:31
debug1: ssh_rsa_verify: signature correct
debug1: SSH2_MSG_NEWKEYS sent
debug1: expecting SSH2_MSG_NEWKEYS
debug1: SSH2_MSG_NEWKEYS received
debug1: Roaming not allowed by server
debug1: SSH2_MSG_SERVICE_REQUEST sent
debug1: SSH2_MSG_SERVICE_ACCEPT received
debug1: Authentications that can continue: publickey
debug1: Next authentication method: publickey
debug1: Trying private key: primary_key.pem
debug1: read PEM private key done: type RSA
debug1: Authentications that can continue: publickey
debug1: No more authentication methods to try.
Permission denied (publickey). 
```

怎么了？我错过了什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-06T06:30:29.497

这是正常的 Amazon EC2 行为。重新启动实例后，关联的公共 IP（您的原来是`ec2-23-22-245-160.compute-1.amazonaws.com`）将被更改。

有 2 种方法可以通过 ssh 连接您的实例

1.  登录您的 Amazon AWS 控制台并检查正在运行的实例，然后复制公共 DNS 并尝试使用 ssh 连接。（ssk键是一样的）

2.  如果您不希望实例的公共 IP 在每次重新启动/终止时更改，请使用弹性 IP。与账户（而非实例）关联的弹性 Ip，因此您可以在所需的任何实例上分配弹性 Ip。

您可以使用 ssh 连接`ssh -v -i primary_key.pem ubuntu@<ElasticIp>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-02-18T04:01:25.960

我有类似的问题。这就是我所做的..！

```
ssh -i < .pem file> -vvv <server IP> 
```

上面的命令将显示调试日志，在 ECDSA 密钥被接受后，你就进入了。

# c# - SharpZipLib 中的“试图读取流的末尾”

> ID：12465182
> 
> 赞同：0
> 
> 时间：2012-09-17T18:33:42.283
> 
> 标签：c#, excel, zip

我在生产系统中有一个错误，当用户在软件中选择要上传的 excel (.xlsx) 文件时，应用程序会引发异常：`Attempted to read past the end of the stream. - at ICSharpCode.SharpZipLib.Zip.ZipHelperStream.ReadLEShort()`

我正在使用`ExcelDataReader`SharpZipLib 更新到 0.65。有人有想法吗？

ExcelDataReader Extract Method that using SharpZipLib: Exception was throwed in zipFile = new ZipFile(filestream);

谢谢。

```
public bool Extract(Stream fileStream)

    {
        if (null == fileStream) return false;

        CleanFromTemp();

        NewTempPath();

        _isValid = true;

        ZipFile zipFile = null;

        try
        {
            zipFile = new ZipFile(fileStream);

            IEnumerator enumerator = zipFile.GetEnumerator();

            while (enumerator.MoveNext())
            {
                ZipEntry entry = (ZipEntry)enumerator.Current;

                ExtractZipEntry(zipFile, entry);
            }
        }
        catch (Exception ex)
        {
            _isValid = false;
            _exceptionMessage = ex.Message;
            Log.Trace(string.Format("{0} - {1}",ex.Message ,ex.StackTrace), this.GetType());

            CleanFromTemp();
        }
        finally
        {
            fileStream.Close();

            if (null != zipFile) zipFile.Close();
        }

        return _isValid ? CheckFolderTree() : false;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T19:24:18.567

如果 zip 文件不遵循 ZIP 标准，则会发生这种情况。该 xlsx 文件中有一些东西会导致解压缩器失效。

您可以尝试使用另一个 zip 库（或检查现有库的更新[0.86 是当前版本](http://www.icsharpcode.net/OpenSource/SharpZipLib/Download.aspx)）并使用它将文件解压缩到流中，不幸的是我没有其他库的建议作为时间尝试我必须解决同样的问题，我只能修复 zip 标头而不是找到新的 zip 库。

# git - 比较 Git 中变基的差异

> ID：12465184
> 
> 赞同：40
> 
> 时间：2012-09-17T18:33:44.797
> 
> 标签：git, git-rebase, git-diff

假设我只是`foo`在 , 上重新建立了分支`master`，有冲突。我想确保我没有`foo`在解决冲突期间通过引入额外的更改或丢失更改（不适合解决冲突的更改）意外损坏内容。我通过以下方式做到了这一点：

```
diff -u <(git diff `git merge-base master foo@{1}` foo@{1}) \
        <(git diff `git merge-base master foo    ` foo    ) 
```

（更新：或我刚刚被提醒的等效`...`语法：）`git-diff`

```
diff -u <(git diff master...foo@{1}) <(git diff master...foo) | mate 
```

*`master..foo`这向我展示了所有被视为补丁*的更改，这正是我想要检查的最小化。但是，调用很复杂，并且输出并不完全易于解释。

有没有更好的方法来完成这项任务——提供相同的信息，但使用更好的方法或格式——或者我应该把上面的内容封装在一个脚本中？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2016-10-21T18:47:44.837

我们真正想要展示的是冲突组合差异，它产生的好像我们已经完成了从 (a) 到 (b) 的合并，其中 (a) 以前基于 (upstream-old) 而 (b) 现在是基于（上游新）。

我们不想要一个直接的差异。

相反，我们基本上可以进行合并，但强制生成的树为 $b^{tree} ，我们已经知道这是我们想要的正确“结束”点。

或多或少，让我们假设我们有

```
newcommit -> the new version of the series
oldcommit -> the old version of the series
upstream -> the (new) version of the base of the series 
```

我们可以通过生成合并

```
git commit-tree newcommit^{tree} -p oldcommit -p upstream -m "message" 
```

然后使用“git show”显示结果，这将生成一个组合的差异格式，将所有必要的位显示为冲突解决方案，它会自动忽略实际上不是解决冲突的一部分的更改。

这甚至也适用于简单地修改更改，您可以做更多的工作来确保生成的合并提交具有准确的作者和提交时间戳，以便在多次调用中保持一致（因为我们*将*松散的 ref 存储到对象中数据库）。

不幸的是，我还没有弄清楚如何在不实际生成树的情况下让“git diff”以相同的方式进行差异化。我不确定我们必须通过什么论据才能达到这一点。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2018-08-21T21:06:47.520

甚至更好`interdiff`，现在有了 Git 2.19（2018 年第三季度），您拥有`git range-diff`.
请参阅“ [Git diff - 两个不相交的修订范围](https://stackoverflow.com/a/51956694/6309)”

该[`git range-diff`文档包括以下示例](https://github.com/git/git/blob/81eab6871e03869a8e47799c10ec1e1cb95ca34a/Documentation/git-range-diff.txt#L89-L142)：

> 当 rebase 需要解决合并冲突时，使用以下命令**直接比较 rebase 引入的更改**：
> 
> ```
> $ git range-diff @{u} @{1} @ 
> ```
> 
> 的典型输出`git range-diff`如下所示：
> 
> ```
> ------------
> -:  ------- > 1:  0ddba11 Prepare for the inevitable!
> 1:  c0debee = 2:  cab005e Add a helpful message at the start
> 2:  f00dbal ! 3:  decafe1 Describe a bug
>     @@ -1,3 +1,3 @@
>      Author: A U Thor <author@example.com>
> 
>     -TODO: Describe a bug
>     +Describe a bug
>     @@ -324,5 +324,6
>       This is expected.
> 
>     -+What is unexpected is that it will also crash.
>     ++Unexpectedly, it also crashes. This is a bug, and the jury is
>     ++still out there how to fix it best. See ticket #314 for details.
> 
>     Contact
> 3:  bedead < -:  ------- TO-UNDO
> ------------ 
> ```
> 
> 在此示例中，有 3 个旧提交和 3 个新提交，其中开发人员：
> 
> *   删除了第 3 个，
> *   在前两个之前添加了一个新的，并且
> *   修改了第二次提交的提交消息及其差异。
> 
> 当输出到终端时，默认情况下它是彩色编码的，就像常规`git diff`的输出一样。另外，第一行（添加一个提交）是绿色，最后一行（删除一个提交）是红色，第二行（完美匹配）是黄色的，就像`git show`'s output 的提交头一样，第三行颜色旧的提交是红色的，新的提交是绿色的，其余的就像`git show`'s 提交头。

* * *

使用 Git 2.20，新类型的（范围）差异更好地支持颜色

请参阅[提交 2543a64](https://github.com/git/git/commit/2543a64187bb80078e493268e683cb0661be754f)、[提交 8d5ccb5](https://github.com/git/git/commit/8d5ccb59def8c1737b3e055a5984eaaa4e881ce9)、[提交 7648b79](https://github.com/git/git/commit/7648b79eeefc23e773a41b24e3ecdadb9fe93643)（2018 年 8 月 17 日）和[提交 4441067](https://github.com/git/git/commit/444106791ee2c4c4575db439ef74d5db5ede6a27) [、](https://github.com/stefanbeller)提交[f103a6f](https://github.com/git/git/commit/f103a6faef97b062aa039d8e6c361340cfd8bc02)、[提交 29ef759](https://github.com/git/git/commit/29ef759d7ca039590240890a604be8308b30a069)、[提交 017ac45](https://github.com/git/git/commit/017ac45e87074a51e7bf926b8f87152a1af9a441)、[提交 9d1e1​​6b](https://github.com/git/git/commit/9d1e16bf59cd35e1019e63b171ddf9209e0f53a1)、[提交 84120cc](https://github.com/git/git/commit/84120cca09002453649abf40e1873c4041247d64)、[提交 c5e64ca](https://github.com/git/git/commit/c5e64caaa9c45988b474765182a508f305f05e6b)、[提交 991eb4f](https://github.com/git/git/commit/991eb4fc6ab1942cbd86060da2846813d990459e)（8 月 14日[）](https://github.com/stefanbeller)^(（由)^([Junio C Hamano 合并 --](https://github.com/gitster)) ^([--](https://github.com/gitster))^在^([提交 30035d1](https://github.com/git/git/commit/30035d1d60053e2999041ca14ab607d40206e201))^(中，2018 年 9 月 17 日）)[`stefanbeller`](https://github.com/stefanbeller)
^([`gitster`](https://github.com/gitster))

> ## `range-diff`: 缩进特殊行作为上下文
> 
> `+++`当涉及到差异的特殊行时，范围差异着色有点模糊，例如用and指示新旧文件`---`，因为它会拾取第一个字符并解释它的颜色，这在常规差异中看起来很烦人, 这些行通过 . 以粗体显示 `DIFF_METAINFO`。
> 
> 通过用空格缩进这些行，它们将被视为更有用的上下文，范围差异系列本身的示例：
> 
> ```
> git range-diff pr-1/dscho/branch-diff-v3...pr-1/dscho/branch-diff-v4 
> ```

（来自存储库[`github.com/gitgitgadget/git`](https://github.com/gitgitgadget/git)）

> ```
> [...]
>     + diff --git a/Documentation/git-range-diff.txt b/Documentation/git-range-diff.txt
>     + new file mode 100644
>     + --- /dev/null
>     + +++ b/Documentation/git-range-diff.txt
>     +@@
>     ++git-range-diff(1)
> [...]
>     +
>       diff --git a/Makefile b/Makefile
>       --- a/Makefile
>       +++ b/Makefile
> [...] 
> ```
> 
> 为手册页介绍新文件的第一行将带有“ `+`”符号，该行的其余部分将是粗体。
> 
> 后面指示更改的`Makefile`行将被视为外部和内部差异中的上下文，以便这些行保持常规颜色。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-26T16:10:51.780

`git-cherry`在一个分支上搜索不在另一个分支上的提交。您可以将其用作：

```
git cherry -v OLDTIP TIP UPSTREAM 
```

即查找已打开`OLDTIP`但未打开的提交`UPSTREAM..TIP`。它查看补丁签名以查看是否包含补丁，因此如果在 rebase 期间添加、删除或修改了补丁，那么它将显示在列表中。不会出现未经更改而应用的内容。

回到`OLDTIP`doing可以达到类似的效果`git rebase -i TIP`，因为它使用相同的逻辑来填充提交列表。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-24T20:33:45.893

由于它是变基而不是合并，因此您可能希望`foo`在合并之前与自身进行比较。如果我没记错的话，`foo@{1}`将产生当前提交的父级`foo`，也许这不是你要找的。

我认为您可以执行以下操作（假设您尚未完成 a `git gc`）：

在变基后的分支`foo`上：

```
$ git reflog 
```

这将显示您的分支的 HEAD 是如何移动的。您应该会看到一些这样的记录（取决于您是否以交互方式变基）：

```
64d3c9e HEAD@{15}: rebase -i (finish): returning to refs/heads/master
64d3c9e HEAD@{16}: rebase -i (fixup): Fixes external dependencies
049169e HEAD@{17}: rebase -i (fixup): updating HEAD
d4c2e69 HEAD@{18}: rebase -i (pick): Fixes external dependencies
049169e HEAD@{19}: rebase -i (fixup): Imports futures
e490bed HEAD@{20}: rebase -i (fixup): updating HEAD
...
etc
... 
```

期待`foo`合并前的最后一次提交。根据您所做的，这可能会很困难，也可能不会。这就是为什么我没有提供一个 do-it 脚本的原因。

选取在变基之前具有最后一次提交的提交 id，`foo`然后与该提交 id 进行比较。假设提交 id 是: `XXXX`:

```
 git diff XXXX...foo 
```

也许这就是你想要的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-09-20T13:16:59.570

master 和 rebase foo 的区别：

`git diff master..foo`

对比

分支 master 后 pre-rebase foo 的差异（注意三个点）：

`git diff master...foo@{1}`

?

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-26T12:45:04.653

稍微不同的方法：Git 很好地支持在合并的情况下显示这一点。即“相对于 parent-1 发生了什么变化，而 parent-2 无法解释？”

有几种方法可以利用这种支持来支持你的 rebase：

选项1：

1.  首先进行一次性合并（而不是变基）。然后正常的合并显示将显示合并更改的内容。检查这是你想要的。

2.  返回并重新设置基准，并将重新设置的提示与合并结果进行比较——它们应该是相同的。

选项 2（如果变基比合并更容易）：

1.  做rebase。
2.  使用移植使其看起来像本地/临时合并。

为此，请使用一行创建一个 .git/info/grafts：

```
TIP UPSTREAM OLDTIP 
```

其中 TIP 是您的 rebase 分支的提交 ID，其他是两个所需的父级（即，如果您进行合并，您将合并的两件事）。然后检查它，就好像它是一个真正的合并一样。

我不确定是否将其自动化；我倾向于在打开 gitk 的情况下做这些事情，因为它使比较正确的修订变得容易（使用右键菜单）。

如果您真的想比较两个差异，那么您可能想查看 interdiff(1)，但我不确定它在处理不同的基本文件时的效果如何。

# maven - 为什么 Maven 使用“？” 作为我的主目录

> ID：12465186
> 
> 赞同：4
> 
> 时间：2012-09-17T18:33:48.460
> 
> 标签：maven, settings, environment-variables

有谁知道为什么 Centos 5.x 上的 Maven 找不到用户设置，除非我使用“-s”？

*   主页设置为**/home/build**
*   $HOME/.m2/settings.xml 存在，归用户所有，用户可以读取
*   我正在使用 mvn 3.0.4 的全新下载（3.0.3 也失败）

我怀疑我的环境中有些东西妨碍了我，但我不确定是什么。

**找不到用户设置 - 未使用“-s”**

```
[build@...]$ echo $HOME; mvn clean -X|grep setting 

/home/build
[DEBUG] Reading global settings from .../apache-maven-3.0.4/conf/settings.xml
[DEBUG] Reading user settings from ?/.m2/settings.xml
[DEBUG]   Imported: org.apache.maven.settings < plexus.core 
```

**查找用户设置——使用“-s”**

```
[build@...]$ echo $HOME; mvn clean -X -s $HOME/.m2/settings.xml|grep setting 

/home/build
[DEBUG] Reading global settings from .../apache-maven-3.0.4/conf/settings.xml
[DEBUG] Reading user settings from /home/build/.m2/settings.xml
[DEBUG]   Imported: org.apache.maven.settings < plexus.core 
```

谢谢

彼得

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T23:12:04.680

“su”命令是这个特定问题的核心。“su”可以作为另一个用户执行命令。当不带**“-”**使用时，它不会处理用于该用途的启动脚本，这在某些情况下会导致混合环境。

在编写 init.d 启动脚本时，请确保在调用命令时使用“su -”，否则您的构建系统用户将使用 root 用户的环境变量（包括 HOME）执行

**某些操作系统上的问题，因为 BAMBOO_USER 在 root 用户的环境中运行**

```
 su $BAMBOO_USER -c "cd ${BAMBOO_HOME}; nohup java -Dbamboo.home=${BAMBOO_HOME} ... &" 
```

**更合适的 init.d 脚本**

```
 su - $BAMBOO_USER -c "cd ${BAMBOO_HOME}; nohup java -Dbamboo.home=${BAMBOO_HOME} ... &" 
```

# trigger.io - 当应用程序进入后台时，Trigger.io 应用程序重置为 index.html

> ID：12465190
> 
> 赞同：1
> 
> 时间：2012-09-17T18:34:08.867
> 
> 标签：trigger.io

我现在正在 Android 模拟器上进行测试。我有一个预先存在的移动 web 应用程序，我将它放入一个新的 Forge 工作区的 src/ 目录中。一切都很好，但是...

当应用程序进入后台时（在这种情况下，由于我按下了主页按钮，但也可能由于来电而发生）然后我返回到它，它回到 index.html，不管哪个我进入后台之前所在的页面。

有没有办法让它像真正的应用程序一样保持其状态？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T18:57:30.080

我没有看到这个问题，因为我使用了带有主干.js 的单个 .html 页面应用程序。但是，您可以尝试使用[事件模块](http://docs.trigger.io/en/v1.4/modules/event.html)来缓解此问题。

您可以在此事件中“保存”当前页面：

```
forge.event.appPaused 
```

然后您可以使用此事件“恢复”您的页面：

```
forge.event.appResumed 
```

# c# - 带有 IE 的 SwitchTo() 的 C# WebDriver 问题

> ID：12465192
> 
> 赞同：3
> 
> 时间：2012-09-17T18:34:19.527
> 
> 标签：c#, internet-explorer, webdriver, selenium-webdriver

当 IE 使用 onclick.window.open() 打开第二个浏览器窗口时，我需要对第二个窗口进行一些处理，然后关闭窗口。

我已尝试在 stackoverflow 上找到以下有关窗口句柄的建议：

```
 string popupHandle = string.Empty;
    ReadOnlyCollection<string> windowHandles = selObj.Driver.WindowHandles;
    foreach (string handle in windowHandles)
    {
        if (handle != originalHandle)
        {
            popupHandle = handle;
            break;
        }
    }

    selObj.Driver.SwitchTo().Window((popupHandle));

    selObj.Driver.Close();

    selObj.Driver.SwitchTo().Window(originalHandle); 
```

在执行此代码之前，我尝试单击新窗口的控件以更改焦点。

Webdriver 找不到控件（我也尝试使用 WebDriverWait 类等待第二次浏览完全加载。

WebDriverWait 在等待几秒后也会引发异常。

在尝试执行时：

```
selObj.Driver.SwitchTo().Window((popupHandle)); 
```

我收到以下异常：

```
No response from server for url http:// 
```

我知道这是 C# 和 IE，想知道是否有人找到了解决此问题的方法？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T11:34:28.560

我的三重奏 C#+WebDriver+Ie 工作正常。

是的 - IE 必须集中注意力。请尝试我的代码。代码适用于 IE、Chrome 和 Firefox

```
protected void SwitchToWindow(string name)
    {
        foreach (string item in _driver.WindowHandles)
        {
            if (_driver.SwitchTo().Window(item).Title.Contains(name))
            {
                _driver.SwitchTo().Window(item);
                break;
            }
        }
    } 
```

对于您的情况，_driver 是 selObj.Driver 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-13T12:26:11.593

有点晚但可能有效：

```
var ieOptions = new InternetExplorerOptions
                {
                    IntroduceInstabilityByIgnoringProtectedModeSettings = true
                };

                ieOptions.ForceCreateProcessApi = true;
                ieOptions.BrowserCommandLineArguments = "-private";
                driver = new InternetExplorerDriver(IE_DRIVER_PATH, ieOptions); 
```

您必须将 ForceCreateProcessApi 设置为 true。只有使用 IE 才能设置此类选项。

如果程序抛出其他错误，例如：

“当以下注册表项设置为 0 时会出现此问题：HKEY_CURRENT_USER\Software\Microsoft\Internet Explorer\Main\TabProcGrowth”

您必须在寄存器中创建一个键（使用 regedit）并将此键设置为 0（类型：REG_DWORD 和值类型：十进制）。

# redis - 是否可以确定易失性密钥的初始 TTL？

> ID：12465193
> 
> 赞同：4
> 
> 时间：2012-09-17T18:34:19.840
> 
> 标签：redis

在我要移植到 Redis 的键值持久性 API 中，我正在尝试实现一个函数来更新键的生存时间。原始代码将 ttl 存储为时间戳和分钟数；ttl 通过写入新的时间戳来更新（密钥在时间戳 + delta 之后过期）。

我注意到 Redis 提供了一个`TTL`命令，但它只提供了剩余时间。

我想知道是否有办法从 Redis 中检索原始 TTL（使用`EXPIRE`等设置），或者我是否需要将 TTL 元字段添加到我存储的值中（就像原始代码一样）。

编辑：我正在使用 Redis Server v2.4.10

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T04:03:30.070

在内部，Redis 存储将 TTL 转换为 unix 时间戳。请参阅[db.c 中的函数 expireGenericCommand](https://github.com/antirez/redis/blob/unstable/src/db.c#L513)。因此，Redis 无法返回您指定的 TTL，仅仅是因为它没有以那种格式存储它。

如果对您的应用程序很重要，您将需要添加一个 TTL 元字段。

# ruby-on-rails - Rails nested_attributes 具有三种方式 has_many

> ID：12465195
> 
> 赞同：3
> 
> 时间：2012-09-17T18:34:25.867
> 
> 标签：ruby-on-rails, forms, activerecord

我有 3 个表 ( `products`, `custom_attribute`, `attribute_value`) 需要链接在一起。我有`attribute_value_maps`一张有`product_id`,`custom_attribute_id`和的桌子`attribute_value_id`。

我的产品型号`accepts_nested_attributes_for :attribute_value_maps`和`accepts_nested_attributes_for :attribute_values`.

我的产品表单有一个新的属性值字段，如下所示：

```
<input id="product_attribute_values_attributes_1_custom_attribute_id" name="product[attribute_values_attributes][1][custom_attribute_id]" value="1" type="hidden">
<input id="product_attribute_values_attributes_1_attribute_value_name" name="product[attribute_values_attributes][1][name]"> 
```

控制器是基本的`@product.update_attributes(paras[:product])`。

这会`attribute_value`正确创建记录，但`attribute_value_map`记录会保存为 nil `custom_attribute_id`。

**问题1：**有没有一种简单的方法可以让`attribute_value_map`记录以`custom_attribute_id`这种方式正确保存？

**问题 2：**假设已经有一个地图记录，如果我添加一个带有 name 的输入`product[attribute_values_attributes][1][attribute_value_map_id]`，它只会对我大喊大叫，说这不是一个有效的字段。如何在创建新的属性值时更新现有的地图记录？

***编辑 1：要求提供更多详细信息***

产品型号：

```
has_many :custom_attributes, :through => :attribute_value_maps
has_many :attribute_value_maps, :dependent => :destroy
has_man :attribute_values, :through => :attribute_value_maps
accepts_nested_attributes_for :attribute_value_maps
accepts_nested_attributes_for :attribute_values 
```

custom_attribute 模型

```
has_many :attribute_value_maps 
```

属性值模型

```
belongs_to :custom_attribute
has_many :attribute_value_maps 
```

属性值映射模型

```
belongs_to :product
belongs_to :custom_attribute
belongs_to :attribute_value 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T08:38:07.500

如果我了解您在这里尝试做什么，我想您可能会为使用 ActiveRecord 带来很多痛苦。

这种动态属性是创建 NoSQL 数据库的原因。您可能需要考虑 Mongoid/MongoDB 之类的东西是否是更好的选择：

至少，您可能需要考虑查看 ActiveRecord 的序列化功能：

[http://api.rubyonrails.org/classes/ActiveRecord/Base.html](http://api.rubyonrails.org/classes/ActiveRecord/Base.html)查看底部的序列化函数。

如果您使用的是 Postgres，您可能需要查看使用本机数据库格式的 hstore 扩展来允许对属性字段进行索引：

[https://github.com/softa/activerecord-postgres-hstore](https://github.com/softa/activerecord-postgres-hstore)

希望以上内容对您有所帮助:)

# perl - 对数组的哈希进行排序，在 Perl 中查找另一个哈希中的比较

> ID：12465197
> 
> 赞同：1
> 
> 时间：2012-09-17T18:34:35.173
> 
> 标签：perl, sorting, hash

假设我想`%hash`通过在另一个哈希 ( ) 中查找比较来对数组的哈希 ( ) 进行排序`%comparator`：

我认为以下方法会起作用，但事实并非如此。

```
for ($bin_ix=1; $bin_ix<scalar(keys(%cluster_bins)); $bin_ix++) {    
   $hash{$bin_ix} = sort {$comparator{$a} <=> $comparator{$b} $hash{$bin_ix}};
} 
```

它抱怨：`Missing operator before %hash`。我错过了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T18:36:19.653

实际上，它说

```
Scalar found where operator expected at -e line 2, near "} $hash"
        (Missing operator before  $hash?) 
```

它在抱怨您的 misplaced `}`，但还有第二个问题：`$hash{$bin_ix}`仅仅是对数组的引用，而不是数组。你要

```
@{ $hash{$bin_ix} } =
   sort { $comparator{$a} <=> $comparator{$b} }
      @{ $hash{$bin_ix} }; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T19:05:52.993

Ikegami 已经回答了您的直接问题，但我想指出，如果您确实想对 中的*所有*数组进行排序`%hash`，编写循环的更简单方法是：

```
foreach my $array ( values %hash ) {
    @$array = sort { $comparator{$a} <=> $comparator{$b} } @$array;
} 
```

即使您确实只想从`1`to对键的数组进行排序`scalar keys %cluster_bins`，TLP 的建议仍然会更清晰：

```
foreach my $bin_idx ( 1 .. keys %cluster_bins ) {
    my $array = $hash{ $bin_idx };
    @$array = sort { $comparator{$a} <=> $comparator{$b} } @$array;
} 
```

# jquery - 从下拉列表助手中删除元素

> ID：12465200
> 
> 赞同：4
> 
> 时间：2012-09-17T18:34:48.050
> 
> 标签：jquery, asp.net-mvc, razor, asp.net-mvc-4

我有一个包含两个`@Html.DropDownListFor`助手的视图：

```
 <div class="editor-field">
        @Html.DropDownListFor(model => model.Employee, (IEnumerable<SelectListItem>)ViewBag.emps, "--Select--", new { style = "width:150px", id = "ddl1"})
        @Html.ValidationMessageFor(model => model.Employee)
    </div>
    <div class="editor-field">
        @Html.DropDownListFor(model => model.Employee2, (IEnumerable<SelectListItem>)ViewBag.emps, "--Select--", new { style = "width:150px", id = "ddl2"})
        @Html.ValidationMessageFor(model => model.Employee2)
    </div> 
```

它们的填充方式如下：

```
public ActionResult Create()
    {
        List<Employees> emps = new List<Employees>();
        emps.Add(new Employees { Id = 0, Name = "Michael Jordan" });
        emps.Add(new Employees { Id = 1, Name = "Magic Johnson" });
        emps.Add(new Employees { Id = 2, Name = "Larry Bird" });

        var items = emps.Select(i => new SelectListItem
        {
            Value= i.Id.ToString(),
            Text =i.Name
        });
        ViewBag.emps = items;
        return View();
    } 
```

如何从第二个 DDL 中删除第一个 DDL 的选定项？我设法使用这样的jQuery获取选定的项目：

```
<script type="text/javascript">
$(function () {
    $("#ddl1").change(function () {
        alert($("#ddl1").val());
    });
});
</script> 
```

但是，我找不到将它用于我的目的的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T19:14:08.213

像这样的东西必须为你工作：

```
$(function(){
    var lists = $('#ddl1, #ddl2');
    lists.change(function(){
        var elm = $(this);
        lists.find('option').show();
        var option = lists.not('#' + this.id)
            .find('option[value="' + elm.val() +'"]').hide();

        if(option.is(':selected'))
        {
            var select = option.closest('select');
            select.val(select.find('option:visible:first').val());
        }
    });
}); 
```

Link for demo: [jsfiddle.net](http://jsfiddle.net/cxZ2H/)

**Added:** Posted solution have problems with IE, alternative way is use disabled attribute: [jsfiddle.net/cxZ2H/1/](http://jsfiddle.net/cxZ2H/1/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T18:53:31.943

这绝对是一个客户端脚本问题，而不是服务器端 ASP.NET MVC 问题。

这是我的建议：

1.  在服务器端创建您的项目列表。
2.  但是当你把它带给客户时，保留一个不可变的主副本。使用它来填充您的第一个`select`.
3.  当用户从第一个列表中选择一个项目时，对第一个列表进行克隆，减去所选项目。

这是一个 JSFiddle：http: [//jsfiddle.net/Fsf7g/1/](http://jsfiddle.net/Fsf7g/1/)

# heroku - Heroku 更新说我没有工具带

> ID：12465204
> 
> 赞同：3
> 
> 时间：2012-09-17T18:35:00.313
> 
> 标签：heroku, command-line-interface

我有一个使用 heroku_san 进行部署的 Rails 项目。我想试一试 heroku 的新工具带，所以我将它安装在我的 Mac OS X 系统上，然后运行 ​​heroku upgrade，我收到以下消息：

> `heroku update`仅可从 Heroku Toolbelt 获得。
> 
> [从https://toolbelt.heroku.com](https://toolbelt.heroku.com)下载并安装

不过，我已经安装了它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-02-03T07:31:49.587

以下步骤对我有用：

1.  [下载并安装工具带： https](https://toolbelt.heroku.com/) ://toolbelt.heroku.com/
2.  在终端中，“gem uninstall heroku”，如果有多个，则选择“所有版本”。

你提到你有一个依赖于heroku gem的gem，所以我不知道除了试图消除这种依赖之外还能告诉你什么。

# c# - 将值插入数据库

> ID：12465207
> 
> 赞同：-4
> 
> 时间：2012-09-17T18:35:12.033
> 
> 标签：c#, mysql, database, insert

我一直在使用以下代码将值插入 MySQL 数据库。代码构建时没有错误消息，但是一旦我尝试运行它就会说：

> MySql.Data.MySqlClient.MySqlException：列“名称”不能为空

请告诉我代码中的错误。

这是我正在使用的插入功能：

```
public int insert (int id, string name, string sname, int marks )
{
     string connection= ConfigurationManager.ConnectionStrings["Conn"].ConnectionString;
       MySqlConnection con = new MySqlConnection(connection);

    MySqlCommand com = new MySqlCommand("INSERT INTO Student_details(id,name,sname,marks) values(@id,@name, @sname, @marks)");

   // com.Connection = com;
   com.Connection = con;
    con.Open();

    //com.Parameters.Add("@id", id);
    //com.Parameters.Add("@name", name);
    //com.Parameters.Add("@sname", sname);
    //com.Parameters.Add("@marks", marks);
    com.Parameters.AddWithValue("@id", id);
    com.Parameters.AddWithValue("@name", name);
    com.Parameters.AddWithValue("@sname", sname);
    com.Parameters.AddWithValue("@marks", marks);
   //// com.Parameters.a
    //com.ExecuteNonQuery();
    int ret = Convert.ToInt32(com.ExecuteScalar());

    return ret;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T18:38:26.937

你能用参数验证重写你的方法吗？这会给你的编程风格**+1 。**另外，如果输入不符合预期的合同，您会更快地知道。

```
public int insert (int id, string name, string sname, int marks )
{
    if(name == null) throw new ArgumentNullException("name");
    ...
} 
```

好像您正在传递一个`name`参数，即`null`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T07:22:37.430

嗨，我正在使用简单的以下前端函数将数据字段的值插入具有函数 Insert() 的数据访问层类中......请注意我哪里出错了......

```
try
{
    DataAccessLayer dal = new DataAccessLayer();
    int id = 23;
    string name = "mayank";
    string sname = "agarwal";
    int marks = 34;
    int a = dal.insert(id, name, sname, marks);
    LblUserName.Text = a.ToString();
}
catch (Exception ex)
{
    Console.Write(ex.Message.ToString());
        throw;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T18:38:30.603

你确定名字不为空吗？你不验证你的参数。

# php - 从数据库中检索和显示评论/查询

> ID：12465209
> 
> 赞同：1
> 
> 时间：2012-09-17T18:35:16.270
> 
> 标签：php, sql, web-application-design

我正在用 php/sql 开发一个 Web 应用程序，用户可以在其中发布他们想要出售的商品（有点像 ebay）。我希望非会员能够对项目发表评论或询问有关项目的问题。

我的问题是我想以与 Facebook 墙的工作方式类似的方式显示每个项目以及对该项目所做的任何评论/查询。

我想为每个项目“附加评论”（如果有的话）。评论表通过列 item_id 链接到项目表。并且项目表通过列 user_id 链接到用户表。我已经离开加入用户表和项目表以显示项目详细信息，我也尝试离开加入评论表，以便有 3 个加入表。

这失败了，因为没有显示评论并且只显示一个项目，尽管每个表中有多个条目。这是我正在使用的代码。

```
$database->query
    ('
    SELECT sale.*, query.*, users.id AS userid, users.username as user 
    FROM sale 
    LEFT JOIN users ON sale.user_id = users.id 
    LEFT JOIN query on sale.id = query.item_id
    where category = "$category" ORDER BY sale.id DESC
    ');

    $show = " "; //variable to hold items and comments

    if ($database->count() == 0) {

      // Show this message if there are no items  

      $show .= "<li class='noitems'>There are currently no items to display.</li>" ; 

    } else {

        $show .= "<li>";

        while ( $items = $database->statement->fetch(PDO::FETCH_ASSOC) )  
        {

            $show .= "
                //show item details in html
               ";

            while( $query = $database->statement->fetch(PDO::FETCH_ASSOC) )
            {

                $show .= "
                  //show queries below item details
                        ";                    
            }     

      $show .= "</li>" ; 
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T18:57:13.900

欢迎来到 Stackoverflow！

我建议你看看[pdo](http://php.net/manual/en/book.pdo.php)。如果您已经在使用`mysql_`函数，那么我建议您切换。更多信息可以在[这里](https://stackoverflow.com/questions/866860/mysql-versus-pdo)找到。

* * *

现在您已经指出了在连接/运行查询时要使用哪些函数的方向，您现在应该创建表。我使用[phpmyadmin](http://www.phpmyadmin.net/home_page/index.php)来管理我的数据库，我觉得它非常好，但取决于你使用什么。一旦你决定了你用来管理你的数据库的服务，你就应该通过一些谷歌搜索来学习如何使用它。

* * *

现在您需要设置表格并正确构建表格。如果你说你有物品，那么你应该制作一个名为`items`. 接下来为项目的属性创建列。此外，我建议阅读有关[Database Normalization](http://databases.about.com/od/specificproducts/a/normalization.htm)的内容，这是设置 SQL 表等的关键方面。

* * *

完成所有设置后，您就已成功连接到数据库等。您现在需要设置*“动态页面”*。我的意思是，只有一页，比如说“动态”，然后将一个变量传递给`url`. 这些称为`GET`HTTP 请求。这是一个看起来像的示例：[http](http://example.com/item?id=345) ://example.com/item?id=345 。

如果您注意到了，您会看到`?`定义`id`为`345`. 您可以**通过**访问`url`名为`$_GET[]`. `[]`然后，您可以在's 中输入要获取的变量名称。这是一个例子。

```
<?php
$data = $_GET['varname']; // get varname from the url
if(isnumeric($data)){ // is it totally made out of numbers?
    $query = "SELECT fieldname FROM table WHERE id=:paramname";
    $statement = $pdo->prepare($query); // prepare's the query
    $statement->execute(array(
        'paramname'=>$data // binds the parameter 'paramname' to the $data variable.
    ));
    $result = $statement->fetch(PDO::FETCH_ASSOC); // grabs the result of the query
    $result = $result['fieldname'];
    echo 'varname was found in the database with the id equal to:'.$data.', and the             result being: '.$result;
}
?> 
```

因此，现在您可以看到如何从 url 中获取变量并从中动态更改页面中的内容！

希望这有帮助:)

# c# - SQL UPDATE 的实体框架等价物是什么？

> ID：12465213
> 
> 赞同：2
> 
> 时间：2012-09-17T18:35:22.490
> 
> 标签：c#, entity-framework

我查看了整个互联网，但仍然找不到解决方案。

我尝试了附加方法：

```
 public static void updatePhoto(string name, string albumName, string newName, string newPath)
    {
        //updates photo... no delete and adding...
        var photo = new Image(){Label=newName, Path = newPath};
        using (var db = new EzPrintsEntities())
        {
            db.Images.Attach(photo);
            db.SaveChanges();
        }

    } 
```

但这根本没有做任何事情。

**那么问题来了，如何在下面的代码中通过 EF 实现对 sql 数据库的 UPDATE？**

```
 public static void updatePhoto(string name, string albumName, string newName, string newPath)
    {
         EzPrintsEntities db = new EzPrintsEntities();

    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T18:39:09.303

如果要更新现有照片，则需要加载它并更改现有值：

```
public static void updatePhoto(string name, string albumName, string newName, string newPath)
{
    using (var db = new EzPrintsEntities())
    {
        // Load photo
        var photo = db.Images.FirstOrDefault(i => i.Label == name && i.Album == albumName);
        if (photo == null)
        {
           // no matching photo - do something
        }

        // Update data
        photo.Label = newName;
        photo.Path = newPath; 

        db.SaveChanges();
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T18:40:49.513

最简单的方法是：

```
public static void updatePhoto(string name, string albumName, string newName, string newPath)   
{   
    //updates photo... no delete and adding...       

    using (var db = new EzPrintsEntities())   
    {   
        var photo = (from p in db.Images
                 where p.name == name &&
                 p.albumname == albumName 
                 select p).First();
        photo.name = newName;
        photo.path = newPath;
        db.SaveChanges();   
    }   

} 
```

您只需使用 Linq 选择现有`photo`对象，对其进行修改，然后`SaveChanges()`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T18:41:35.450

您还想要将实体`updatePhoto`上主键的值传递给您的方法。`Image`然后，您无需创建新`Image`实体并附加它并保存上下文，而是`Image`从上下文中获取实体，然后更新其属性。

这些方面的东西：

```
using (var db = new EzPrintsEntities())
{
    var image = db.Images.SingleOrDefault(i => i.Id == id); // Assuming Id is the PK on Image, and we sent in the PK in a variable called id.
    if (image != null)
    {
        image.Label = newName;
        image.Path = newPath;

        db.SaveChanges();
    }
    else
    {
        // Invalid PK value sent in, do something here (logging, error display, whatever).
    }
} 
```

# mysql - MySQL - 使用增量连接将重复值转换为唯一值

> ID：12465221
> 
> 赞同：-2
> 
> 时间：2012-09-17T18:36:12.003
> 
> 标签：mysql

就在之前，我发布了一个关于[为列中的每个重复值获取计数器的问题](https://stackoverflow.com/questions/12463628/mysql-get-a-counter-for-each-duplicate-value)

现在我将扩展这个问题，例如：

```
+------+------+------+
| id   | data | num  | 
+------+------+------+
| 1    | a    |      | 
| 2    | a    |      |
| 3    | a    |      |
| 4    | b    |      |
| 5    | b    |      |
| 6    | c    |      |
| 7    | d    |      |
| 8    | a    |      |
| 9    | b    |      | 
+------+------+------+ 
```

可以更新为：

```
+------+------+------+
| id   | data | num  | 
+------+------+------+
| 1    | a    |   a1 | 
| 2    | a    |   a2 |
| 3    | a    |   a3 |
| 4    | b    |   b1 |
| 5    | b    |   b2 |
| 6    | c    |   c1 |
| 7    | d    |   d1 |
| 8    | a    |   a4 |
| 9    | b    |   b3 | 
+------+------+------+ 
```

[无论如何，向蓝脚](https://stackoverflow.com/users/426671/bluefeet)鞠躬！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T18:46:21.563

看起来您只想将[`CONCAT()`](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_concat)这些值放在一起：

```
select data, group_row_number, 
  concat(data, cast(group_row_number as char)) as num,
  overall_row_num
from
(
  select data,
        @num := if(@data = `data`, @num + 1, 1) as group_row_number,
        @data := `data` as dummy, overall_row_num
  from
  (
    select data, @rn:=@rn+1 overall_row_num
    from yourtable, (SELECT @rn:=0) r
  ) x
  order by data, overall_row_num
) x
order by overall_row_num 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/bb591/59)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T19:36:01.893

## 解决了：

```
UPDATE mytable
SET num = ( SELECT num FROM 
(
select id,
  concat(data, cast(group_row_number as char)) as num
from
(
  select id, data,
        @num := if(@data = `data`, @num + 1, 1) as group_row_number,
        @data := `data` as dummy
  from
  (
    select id, data
    from mytable, (SELECT @rn:=0) r
  ) x
  order by data, id
) x  order by id
) tempSort

 WHERE mytable.ID = tempSort.ID ); 
```

再次感谢@bluefeet！

# spring-mvc - Spring MVC杰克逊自动序列化？

> ID：12465224
> 
> 赞同：1
> 
> 时间：2012-09-17T18:36:32.093
> 
> 标签：spring-mvc, jackson

我想在spring MVC中用jackson序列化一个对象。

我有一个控制器，它返回一个 ObjectTest1，它有一个属性 ObjectTest2。

```
public class ObjectTest1{
 private ObjectTest2;
 // setters getters...
}

public class ObjectTest2{
 private String value;
 // setters getters...
}

public @ResponseBody ObjectTest1 test() throws IOException ... 
```

我有一个映射器，我有一个 ObjectTest2 的序列化程序，我已经用 @JsonSerialize(using = ObjectTest2.class) 注释了 ObjectTest1.getObjectTest2 方法。

它工作正常！但我想在很多对象中使用这个序列化程序，而不仅仅是在 ObjectTest1 中。

我应该怎么做才能避免在每个 getter 方法中添加注释？可以为ObjectTest2的所有属性自动使用spring这个序列化程序吗？

**更新：**

我已经在我的代码中使用了它：

```
<mvc:annotation-driven> 
```

在 ajax 响应中正确生成为 json 的对象。也许我应该尝试用另一种方式解释。

所以。我有这些对象：

```
public class DTO{
  private InnerThing innerThing;

  @JsonSerialize(using=ThingSerializer.class)
  public InnerThing getThing(){...}
}

public class InnerThing{
  private String value;
} 
```

生成的 json 看起来像：

```
{"innerThing":{"value":"something"}} 
```

在我编写了一个序列化程序之后，json 是：

```
{"innerThing":"something"} 
```

没关系，但要获得第二个版本的 json，我必须用 @JsonSerialize 注释 DTO 类中的 getInnerThing 方法...

我不想注释我使用 InnerThing 作为属性的所有方法。所以我的问题是，spring 可以自动序列化 InnerThing 类型的每个属性吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T18:44:12.703

默认情况下，如果您将 Jackson 添加到类路径并使用`<mvc:annotation-driven>`或，Spring 将自动处理 JSON 的序列化和反序列化`@EnableWebMvc`。

Spring 参考文档的链接：

Spring 3.0：[<mvc:annotation-driven>](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/mvc.html#mvc-annotation-driven)
Spring 3.1：[<mvc:annotation-driven> 和@EnableWebMvc](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/mvc.html#mvc-config-enable)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-20T22:42:21.550

您希望 Jackson 始终使用您的自定义 JsonSerializer 或 JsonDeserializer 来序列化/反序列化特定类型？

我最终编写了一个自定义 Jackson 模块，让 Jackson 找到属于 Spring bean 的序列化器和反序列化器。我正在使用 Spring 3.1.2 和 Jackson 2.0.6

简化版：

```
public class MyObjectMapper extends ObjectMapper {
    @Autowired
    public MyObjectMapper(ApplicationContext applicationContext) {
        SpringComponentModule sm = new SpringComponentModule(applicationContext);
        registerModule(sm);
    }
} 
```

模块：

```
public class SpringComponentModule extends Module {
    private ApplicationContext applicationContext;
    public SpringComponentModule(ApplicationContext applicationContext) {
        this.applicationContext = applicationContext;
    }
    @Override public String getModuleName() {
        return "jackson-spring-component";
    }
    @Override public Version version() {
        return SpringComponentModuleVersion.instance.version();
    }
    @Override
    public void setupModule(SetupContext context) {
        context.addSerializers(new SpringComponentSerializers(this.applicationContext));
        context.addDeserializers(new SpringComponentDeserializers(this.applicationContext));
    }
} 
```

组件序列化器类：

```
public class SpringComponentSerializers extends Serializers.Base {
    private ApplicationContext applicationContext;
    public SpringComponentSerializers(ApplicationContext applicationContext) {
        this.applicationContext = applicationContext;
    }
    @Override
    public JsonSerializer<?> findSerializer(SerializationConfig config, JavaType type, BeanDescription beanDesc) {
        Class<?> raw = type.getRawClass();
        Map<String,JsonSerializer> beanSet = applicationContext.getBeansOfType(JsonSerializer.class);
        for(String beanName : beanSet.keySet()) {
            JsonSerializer<?> serializer = beanSet.get(beanName);
            if(serializer.handledType().isAssignableFrom(raw)) {
                return serializer;
            }
        }
        return null;
    }
} 
```

# java - 使用 hashmap 的 NULL 指针

> ID：12465228
> 
> 赞同：0
> 
> 时间：2012-09-17T18:36:53.933
> 
> 标签：java, android

有人可以告诉我为什么我得到`null pointer exception`这个代码吗？在我的`Nutrition`课堂上，我实现了一个`hash map`：

```
public class Nutrition implements Serializable{

private final String TAG = Nutrition.class.getSimpleName();
//class variables
    ...

//hash map declaration
HashMap<String, String> nutrition; 

public Nutrition(JSONObject jo) throws JSONException{

    //create hash map
    this.nutrition = new HashMap<String, String>(); 

    //place data in hashmap
    this.serving_size = jo.optString("serving_size");
    nutrition.put("serving_size", serving_size); 
    Log.i(TAG, serving_size + " : Serving Size");
           ....
    }
   //method to get hashmap
   public HashMap<String, String> getHashMap(){
    return nutrition; 
} 
```

然后在另一堂课上，我打电话给`getHashMap()`我`null pointer`：

```
//nutrition item
    Nutrition nutritionInfo  = dish.getNutrition();
    nutInfo = nutritionInfo.getHashMap(); 
```

有人可以告诉我我做错了什么以及如何解决吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T18:38:44.860

如果 disc.getNutrition() 返回 null，第二行将抛出 NPE。

```
Nutrition nutritionInfo  = dish.getNutrition();
nutInfo = nutritionInfo.getHashMap(); 
```

由于您没有向我们展示 Dish 类中的代码，因此我假设它出现在此处。

# javascript - Highcharts 系列 [数据]

> ID：12465231
> 
> 赞同：0
> 
> 时间：2012-09-17T18:37:12.330
> 
> 标签：javascript, jquery

我正在使用 Highcharts 来绘制我的饼图。我的问题是系列。`data[]` 我正在将数据传递给 Series`data[]`静态方式，现在的情况是我想动态地将数据发送到 Jquery。我无法理解**如何？**

我的数据是这样的：

```
series: [{
    type: 'pie',
    name: 'Percentage',
    data: [
        ['Holy',   rr1],
        ['Molly',    rr3],
    ]
}] 
```

我现在想输入数据 Jolly，而不是转到 jquery 并为 jolly 提供数据，我可以直接从代码中发送。顺便说一句，我正在使用 PHP 。

提前致谢

# html - 无法右对齐分页 div

> ID：12465237
> 
> 赞同：1
> 
> 时间：2012-09-17T18:37:50.557
> 
> 标签：html, css

编辑：我刚刚删除了我之前的内容，但我发现了以前的编码人员从哪里获取了这段代码，我认为这会更好地问我的问题。我正在尝试正确对齐此分页，但它没有正确对齐。

这是一个小提琴： http: [//jsfiddle.net/Zd8sC/5/](http://jsfiddle.net/Zd8sC/5/) 这是代码：html：

```
<ul id="pagination-clean">
<li class="previous-off">«Previous</li>
<li class="active">1</li>
<li><a href="?page=2">2</a></li>
<li><a href="?page=3">3</a></li>
<li><a href="?page=4">4</a></li>
<li><a href="?page=5">5</a></li>
<li><a href="?page=6">6</a></li>
<li><a href="?page=7">7</a></li>
<li class="next"><a href="?page=2">Next »</a></li>
</ul> 
```

CSS：

```
ul{border:0; margin:0; padding:0;}

#pagination-clean li{
border:0; margin:0; padding:0;
font-size:11px;
list-style:none;
}
#pagination-clean li, #pagination-clean a{
border:solid 1px #DEDEDE
margin-right:2px;
}
#pagination-clean .previous-off,
#pagination-clean .next-off {
color:#888888
display:block;
float:left;
font-weight:bold;
padding:3px 4px;
}
#pagination-clean .next a,
#pagination-clean .previous a {
font-weight:bold;
border:solid 1px #FFFFFF;
} 
#pagination-clean .active{
color:#00000
font-weight:bold;
display:block;
float:left;
padding:4px 6px;
}
#pagination-clean a:link,
#pagination-clean a:visited {
color:#0033CC
display:block;
float:left;
padding:3px 6px;
text-decoration:none;
}
#pagination-clean a:hover{
text-decoration:none;
}​ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T18:41:31.427

```
div
{
    display: block;
    text-align: right;
}

#pagination-clean
{
    display: inline-block;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T18:51:34.927

设置 div 标签的宽度

```
<div style="width:200px;float:right"></div> 
```

这样，您的 div 标签将不会一个接一个。

# php - 正则表达式匹配良好，但 HTML 输出不好

> ID：12465238
> 
> 赞同：1
> 
> 时间：2012-09-17T18:38:07.590
> 
> 标签：php, regex

我有这个正则表达式，取自 PHP.net 以捕获 [code][/code] 标签。

```
function code_highlight($code)
{
    return $code = preg_replace_callback('#\[code]((?:[^[]|\[(?!/?code])|(?R))+)\[/code]#', 'code_highlight_callback', $code);
} 
```

我的回调函数是：

```
function code_highlight_callback($matches)
{
    return "<pre class='highlighted_code'>" . $matches[0] . "</pre>";
} 
```

如果我回显该行`htmlentities()`而不是返回它，我会得到以下内容：

```
<pre class='highlighted_code'>
    [code]int main()</div> 
    <div>{</div> 
    <div>}</div> 
    <div>[/code]
</pre> 
```

就正则表达式而言，一切似乎都很好。但是，如果我输出返回值，源代码最终看起来像这样：

```
<div>
    <div>
        <pre class="highlighted_code">[code]int main()</pre>
    </div>
    <div>{</div>
    <div>}</div>
    <div>[/code] </div>
</div> 
```

为什么 PRE 标签会被移动并缩短？正则表达式清楚地捕获了字符串的整个 [code] [/code] 部分，但在某处，某些东西正在把它弄乱，我无法弄清楚。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T18:41:33.657

您是否通过浏览器的 DOM 检查器检查结果？如果是这样，它将自动“更正”您的标签以正确的顺序关闭。我认为你`code_highlight_callback`应该是：

```
function code_highlight_callback($matches) {
    return "<pre class='highlighted_code'>".htmlspecialchars($matches[0])."</pre>";
} 
```

# c# - 如何在 C# 中使用列表创建循环

> ID：12465241
> 
> 赞同：2
> 
> 时间：2012-09-17T18:38:26.747
> 
> 标签：c#, asp.net-mvc-3, list, razor

在我的 asp mvc 3 应用程序中，我想显示一个相册。这样就会有选中的图片和相册中其他图片的缩略图列表。用户可以看到的缩略图列表仅包含 8 张图片，其他所有图片都将被隐藏。我想要的是从选定的项目开始这个列表，当列表到达末尾而没有完成所有项目时，它将从头开始。

我设法用这段代码做到了，但我发现它又快又脏。有没有我可以使用的内置 C# 函数？

```
@{int i = 0;}
@foreach (AlbumPhoto albmphoto in Model.AlbumPhotoList
  .Where(p => p.AlbumPhotoId > int.Parse(SinglePhoto))
  .OrderBy(p => p.AlbumPhotoId))
{
    i++;
    string show = "none";
    if (i < 8)
    {
        show = "block";
    }
    <a href="#" style="display: @show">
        <img src="@Url.Content(albmphoto.AlbumPhotoPath)" width="70" height="47" border="0" alt="@albmphoto.AlbumPhotoDescription" />
    </a>                   
}

@foreach (AlbumPhoto albmphoto in Model.AlbumPhotoList
  .Where(p => p.AlbumPhotoId < int.Parse(SinglePhoto))
  .OrderBy(p => p.AlbumPhotoId))
{
    i++;
    string show = "none";
    if (i < 8)
    {
        show = "block";
    }
    <a href="#" style="display: @show">
        <img src="@Url.Content(albmphoto.AlbumPhotoPath)" width="70" height="47" border="0" alt="@albmphoto.AlbumPhotoDescription" />
    </a>                   
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T18:50:51.510

我认为没有内置任何东西可以对 进行“翻转`foreach`” `IEnumerable`，但是您可以使用 Concat 稍微不那么恶心地解决它，基本上将对象集再次附加到自身。

```
var photos = Model.AlbumPhotoList
  .Where(p => p.AlbumPhotoId < int.Parse(SinglePhoto))
  .OrderBy(p => p.AlbumPhotoId);

@foreach(var albumphoto in photos.Concat(photos))
{
  i++;
      string show = "none";
      if (i < 8)
      {
          show = "block";
      }
      <a href="#" style="display: @show">
          <img src="@Url.Content(albmphoto.AlbumPhotoPath)" width="70" height="47" border="0" alt="@albmphoto.AlbumPhotoDescription" />
      </a>       
} 
```

如果它跑到最后，它会滚动到下一组。

或者，作为更好的解决方案，您可以 ToList IEnumerable 并使用 a`%`进行更好的索引：

```
var photos = Model.AlbumPhotoList
      .Where(p => p.AlbumPhotoId < int.Parse(SinglePhoto))
      .OrderBy(p => p.AlbumPhotoId)
      .ToList();

@for(int i = 0; i < 8; ++i)
{
 if(i < 8)
 {
  show = "block";
 }
 var albumphoto = photos[i % photos.Count];
 <a href="#" style="display: @show">
  <img src="@Url.Content(albmphoto.AlbumPhotoPath)" width="70" height="47" border="0" alt="@albmphoto.AlbumPhotoDescription" />
 </a> 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T19:01:28.730

`display`一旦你有 8 个条目 ( `break;`) ，就可以离开循环，而不是改变你的值。

我还没有使用过 asp.net/Linq（试图进入它），但我会尝试做这样的事情（因此认为它是伪代码；如果这是完整的 BS 或其他什么，我愿意接受反馈！ ):

```
@{
    var index = int.Parse(SinglePhoto); // starting index
    var list = Model.AlbumPhotoList.OrderBy(...); // get all images
    // Now duplicate the first 8 elements of the list, then skip the images not visible
    // and then limit the number of visible items to 8
    list = list.Union(list.Top(8)).Skip(index).Top(8).ToList();
}
@foreach(AlbumPhoto photo in list){
    // html output
} 
```

# java - 如何从使用 java 的网页上提供的下载链接下载文件？

> ID：12465243
> 
> 赞同：-1
> 
> 时间：2012-09-17T18:38:28.383
> 
> 标签：java, url, hyperlink

如何从使用 java 的网页上提供的下载链接下载文件？例如，我想 使用 Java 从[http://edition.cnn.com/services/rss/下载这个文件：](http://edition.cnn.com/services/rss/) [http: //rss.cnn.com/rss/edition.rss。](http://rss.cnn.com/rss/edition.rss)完成它的最初步骤应该是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T18:42:28.363

嗯，[httpunit？](http://httpunit.sourceforge.net/)它很复杂，但我不知道任何其他方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T18:41:36.887

使用像[JSoup 这样的 Java 库。](http://jsoup.org/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T18:45:54.763

从技术上讲，RSS 是一个 XML 文件。如果需要，您可以将其作为常规文件下载。查看以下链接是否有帮助

[如何使用 Java 从 Internet 下载和保存文件？](https://stackoverflow.com/questions/921262/how-to-download-and-save-a-file-from-internet-using-java)

# c# - 用于开发 Microsoft Surface 应用程序的语言

> ID：12465246
> 
> 赞同：-1
> 
> 时间：2012-09-17T18:38:40.843
> 
> 标签：c#, .net, silverlight

我需要知道如何为**Microsoft Surface 平板电脑**
开发应用程序 以及是否有很多选项是最好的？
最好使用**C#**还是**Silverlight**？**或者**还有其他方法吗？！

什么是最好的方法： -可扩展性- 耗时
-Powerflite- 可写性-可 重用 性

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T18:40:51.027

如果您想针对所有版本的 Surface 平板电脑，您需要针对[Windows 应用商店应用程序的 Windows API 进行](http://msdn.microsoft.com/en-us/library/windows/apps/br211377.aspx)开发。这可以通过 JavaScript、C#、Visual Basic 和 C++ 完成。

API 的设计使得所有四个选项都应该执行得相当好。话虽如此，C++ 确实提供了更多的控制（因为您更直接地处理内存 - 类似于 COM），因此可能会为您的标准提供最大的控制。但是，对于许多应用程序，考虑到框架和库的设计，上述任何一种语言都足够了。

# javascript - 为什么使用 while 循环填充新数组的速度如此之快？

> ID：12465251
> 
> 赞同：6
> 
> 时间：2012-09-17T18:38:48.353
> 
> 标签：javascript, performance

我正在考虑使用本机方法创建包含默认值的数组的方法，最终得到

```
function pushMap(length, fill){
    var a = [], b = [];
    a.length = length;
    b.push.apply(b,a);
    return b.map(function(){return fill;});
} 
```

期望它比 while 循环慢**2**或**3**倍，因为本机方法必须循环两次，而 while 只循环一次，所以我在[**jsperf 上将其**](http://jsperf.com/make-filled-array)与

```
function whileLengthNew(len, val) {
    var rv = new Array(len);
    while (--len >= 0) {
        rv[len] = val;
    }
    return rv;
} 
```

它实际上慢了**18**到**27**倍（在 Ubuntu 上使用 Google Chrome 进行测试，欢迎使用浏览器/操作系统）。

是什么导致了如此大的差异？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T19:09:37.190

我预计这是由于两个主要因素：

1.  内存分配——`whileLengthNew`首先创建一个正确大小的数组，然后对其进行操作，`pushMap`创建最终的数组，一次一个元素`map`。这可能会导致多次分配，尤其是在源数组很大的情况下。（您创建初始`a`和`b`数组的方式基本上是无关紧要的，因为`map`正在构建一个新数组以返回 - 它实际上并没有改变任何东西`b`）

2.  函数调用开销——在调用 时`map`，您正在为数组的每个元素调用一个函数。这涉及相当多的开销；设置激活记录和作用域链、堆栈操作以及传回返回值。-- 所有这些都是为了访问一个在函数中是常量的变量。最重要的是，您已经设置了一个闭包，因此即使*访问*该`fill`变量也比它在`whileLengthNew`版本中要慢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T18:49:05.340

我不是 javascript 专家，我没有为任何 javascript 引擎做出贡献，所以以下只是猜测：

在你的`pushMap`功能中，你有很多事情要做。
1\. 首先，您`var a`以一种可能非常低效的方式扩展到您想要的大小。 `length`只是数组上的一个属性，因此底层实现在属性更改时具有回调，或者底层实现可以处理长度属性的更改，并在下次访问其中的某些内容时进行处理。
2\. 创建`var b`似乎效率更低，因为您正在调用反射类型方法`apply`来创建`b`特定长度的数组。
3.然后您基本上以函数方式调用foreach循环，这可能会比while循环慢一点，因为内部函数的开销（我猜是因为它是JS而关闭）

`var b`如果您创建与创建相同的方式，您可能会得到更均匀的结果`var rv`。希望这可以帮助。*编辑*在这种情况下当然不起作用，因为 map 仅适用于数组的初始化值。这意味着这种方法较慢的另一个原因（并且 OP 在他的问题中提到了这一点）您正在初始化地图两次，一次使用空值，另一次使用您想要的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T18:54:47.590

您对每个单个值都进行了不必要的函数调用，因此 JavaScript 虚拟机难以优化此模式，而且您的数组不会在内部被视为简单数组，而是被视为非常复杂的数据结构，另一方面，在您的 while 循环中，您使用非常简单数组访问模式，我怀疑如果您将使用带有 rv.length 作为停止条件的 for 循环，它会更快

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-17T18:55:10.933

我认为调用 map() 的作用与 while 循环的作用相同，而且每次迭代时都会调用一个函数。一般来说，函数调用非常慢。

# java - JPA + Hibernate - 父表和子表之间的内部联接

> ID：12465260
> 
> 赞同：0
> 
> 时间：2012-09-17T18:39:28.963
> 
> 标签：java, hibernate, jpa, jdbc

**编辑（完全重新制定的方法）：**

我正在尝试在一个新项目中推广 JPA 的使用，但我正在努力解决一个所谓的微不足道的问题：两个表（父表和子表）之间的 INNER JOIN。

我将只提供基本信息，其余的都省略了。如果需要，请随时询问更多信息。有两个表 LANGUAGE 和 MESSAGE_RESOURCE，其中父表是 LANGUAGE（主键 ID_LANGUAGE），子表有一个外键到父表也称为 ID_LANGUAGE。

语言（父）类：

```
@Entity
@Table(name = "PF_LANGUAGE")
public class Language {
    @Id
    @Column(name = "ID_LANGUAGE", nullable = false)
    @GeneratedValue(strategy = GenerationType.AUTO)
    private int idLanguage;

    @OneToMany(mappedBy="language",targetEntity=MessageResource.class, fetch=FetchType.EAGER)
    private Collection<MessageResource> messageResources;
} 
```

子类：

```
@Entity
@Table(name = "PF_MESSAGE_RESOURCE")
public class MessageResource {

    @Id
    @Column(name = "ID_MESSAGE_RESOURCE", nullable = false)
    @GeneratedValue(strategy = GenerationType.AUTO)
    private int idMessageResource;

    @ManyToOne(optional=false)
    @JoinColumn(name="ID_LANGUAGE")
    private Language language;
} 
```

我正在使用命名查询获取结果：

```
entityManager.createNamedQuery("select l, r from Language l join l.messageResources r"); 
```

这会产生一个结果对象数组，其中每个条目包含一个 Language、MessageResource 对。问题是这是在单独的查询中完成的。

我可以在调试输出中看到，第一个查询是两个表之间的 INNER JOIN，包含输出中两个表的列，所以这应该足够了。但是 JPA 正在执行 2 个额外的查询（LANGUAGE 记录的数量）再次为每个父表获取子表值，这应该是没有必要的。

第一个足以获取所有数据的查询：

```
select
   language0_.ID_LANGUAGE as ID1_5_0_,
   messageres1_.ID_MESSAGE_RESOURCE as ID1_4_1_,
   language0_.CODE as CODE5_0_,
   language0_.DATE_INS  as DATE3_5_0_,
   language0_.DESCRIPTION  as DESCRIPT4_5_0_,
   messageres1_.DATE_INS  as DATE2_4_1_,
   messageres1_.KEY as KEY4_1_,
   messageres1_.ID_LANGUAGE as ID5_4_1_,
   messageres1_.VALUE as VALUE4_1_ 
from
   PF_LANGUAGE language0_ 
inner join
   PF_MESSAGE_RESOURCE messageres1_ 
on language0_.ID_LANGUAGE=messageres1_.ID_LANGUAGE 
```

在第一次内部连接之后，还会对数据库运行两个冗余查询，如下所示（它们对每个 LANGUAGE 表记录运行一次）：

```
select
    messageres0_.ID_LANGUAGE as ID5_5_1_,
    messageres0_.ID_MESSAGE_RESOURCE as ID1_1_,
    messageres0_.ID_MESSAGE_RESOURCE as ID1_4_0_,
    messageres0_.DATE_INS  as DATE2_4_0_,
    messageres0_.KEY as KEY4_0_,
    messageres0_.ID_LANGUAGE as ID5_4_0_,
    messageres0_.VALUE as VALUE4_0_ 
from
    PF_MESSAGE_RESOURCE messageres0_ 
where
    messageres0_.ID_LANGUAGE=? 
```

我需要消除 JPA 生成的两个多余的附加查询。第一个内部连接足以获取所有数据。

在这方面需要帮助。有什么线索吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T03:50:36.017

我不确定这是否是实际的解决方案，但我对 Eager fetch 的体验很糟糕。它总是以某种我不期望的方式获取。

您的查询很奇怪，您同时选择 Language 和 MessageResource 没有意义

你可以试试：

删除`fetch=FetchType.EAGER`语言与 MessageResource 的关系，并将查询更改为某事

```
select l from Language l join fetch l.messageResources where .... 
```

它应该在一个 SQL 中为您提供语言和该实例的聚合消息资源。

一些题外话，我想知道为什么你有 MessageResource.language `insertable=false, updatable=false`。这似乎与语言中的矛盾，您指定了此字段映射的关系，但您现在使其不可插入/可更新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-19T07:44:02.587

尝试将`fetch=FetchType.EAGER`messageResources 更改为`fetch=FetchType.LAZY` 由于您明确加入，更改`FetchType`为`LAZY`可能会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T19:08:52.053

我不太明白你为什么期望`inner join`在这种情况下。

`optional = "false"`at`@ManyToOne`表示 each`MessageResource`必须有 a `Language`，但并不意味着 each`Language`必须至少有一个`MessageResource`，因此在这种情况下`left join`加载`Language`正确时 -`Language`您加载的可能没有`MessageResource`s 与之关联。

**编辑：**的目的`find()`是加载具有给定 id 的对象（如果它存在于数据库中）。如果你想要一些语义不同的东西（例如，加载所有`Language`至少有一个 s 的 s `MessageResource`），你需要为它写一个查询，比如`select l from Language l join l.messageResources`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-17T19:48:45.830

通过使用标准注释来强制生成内部查询似乎没有标准方法（JPA 是一种标准，您正在使用实现提供程序，例如 Hibernate、TopLink、Open JPA 等）。不同的 JPA 实现使用不同的连接策略。有关更多详细信息，请通过[this](http://victor-ichim.blogspot.in/2012/04/inner-joins-in-jpa.html)和[this](http://vard-lokkur.blogspot.in/2010/09/jpa-demystified-episode-1-onetomany-and.html)。

# python - Python 的多处理 map_async 在 Windows 上生成错误

> ID：12465270
> 
> 赞同：4
> 
> 时间：2012-09-17T18:40:20.897
> 
> 标签：python, multiprocessing, pool

下面的代码在 Unix 上完美运行，但在 Windows 7 上生成 multiprocessing.TimeoutError（两个操作系统都使用 python 2.7）。

知道为什么吗？谢谢。

```
from multiprocessing import Pool

def increment(x):
    return x + 1

def decrement(x):
    return x - 1

pool = Pool(processes=2)
res1 = pool.map_async(increment, range(10))
res2 = pool.map_async(decrement, range(10))

print res1.get(timeout=1)
print res2.get(timeout=1) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T18:47:09.460

您需要将实际的程序逻辑放在一个`if __name__ == '__main__':`块中。

在 Unixy 系统上，Python 分叉，产生多个工作进程。Windows 没有分叉。Python 必须启动一个新的解释器并重新导入所有模块。这意味着每个子进程都将重新导入您的主模块。对于您编写的代码，重新导入模块将导致每个新启动的进程启动自己的进程。

请参阅：[http ://docs.python.org/library/multiprocessing.html#windows](http://docs.python.org/library/multiprocessing.html#windows)

**编辑**这对我有用：

```
from multiprocessing import Pool

def increment(x):
    return x + 1

def decrement(x):
    return x - 1

if __name__ == '__main__':
    pool = Pool(processes=2)
    res1 = pool.map_async(increment, range(10))
    res2 = pool.map_async(decrement, range(10))

    print res1.get(timeout=1)
    print res2.get(timeout=1) 
```

# sql-server - VS2010：错误的 IL 范围错误

> ID：12465279
> 
> 赞同：3
> 
> 时间：2012-09-17T18:41:01.370
> 
> 标签：sql-server, visual-studio-2010, sql-server-2005

我正在尝试通过 VS2010 中的“添加连接”连接到数据库。数据库运行SQL2005，可在VS2008中访问。当我尝试在 VS2010 中连接时，我收到以下错误：

> 无法添加数据连接。
> 未能为此请求检索数据。
> 调用的目标已引发异常。
> 错误的 IL 范围。

奇怪的是“测试连接”工作正常。
我试图通过注册表重新初始化 VS2010，但没有成功。我正在寻找有关原因的任何建议，或者我接下来可以在哪里寻找根本原因。

附加信息
当我尝试附加到数据库时，我在系统事件日志中注意到 2 个错误：
1）生成了以下致命警报：48。内部错误状态为 552。和
2）从远程服务器收到的证书是由不受信任的证书颁发机构颁发。因此，无法验证证书中包含的任何数据。SSL 连接请求失败。附加数据包含服务器证书。

我试图卸载并重新安装 VS2010。没运气。尝试在另一台机器上连接似乎可行，但我的主要开发机器继续失败，并出现上述错误。我宁愿不必重新格式化我的机器，并且迫切希望找到答案或合理的行动方案来找到问题......帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T14:15:57.540

清理您的应用程序并重建通常可以解决此问题。

# vba - 循环文件并使用 VBA 为每个文件自动填充公式

> ID：12465283
> 
> 赞同：0
> 
> 时间：2012-09-17T18:41:09.627
> 
> 标签：vba

我有以下 VBA 代码：

```
 BD.Sheets("Sheet1").Range("F" & Cells(Rows.Count, 6).End(xlUp).Offset(1, 0).Row).Formula = "=SUMIF('" & spath & "[" & itm & "]Sheet1'!$D$13:$D$" & LastRow2 & ",D" & BD.Sheets("Sheet1").Cells(Rows.Count, 6).End(xlUp).Offset(1, 0).Row & ",OFFSET('" & spath & "[" & itm & "]Sheet1'!$D$13:$D$" & LastRow2 & ",0,MATCH(E" & BD.Sheets("Sheet1").Cells(Rows.Count, 6).End(xlUp).Offset(1, 0).Row & ",'" & spath & "[" & itm & "]Sheet1'!$D$12:$R$12,0)-1))"
        With BD.Sheets("Sheet1")
            .Range("F" & .Cells(Rows.Count, 6).End(xlUp).Offset(1, 0).Row).AutoFill Destination:=.Range("F" & .Cells(Rows.Count, 6).End(xlUp).Offset(1, 0).Row & ":F" & .Cells(Rows.Count, 4).End(xlUp).Row)
        End With 
```

（不要介意很长的 SUMIF 公式）

我正在使用以下代码循环文件：

```
spath = "P:\Actuary\Cash Flow Forecast\Annual and Quarterly Budget Data\"

''Retrieve the current files in directory
sfile = Dir(spath)
Do While sfile <> ""
    strFileNames = strFileNames & "," & sfile
    sfile = Dir()
Loop

''Open each file found
For Each itm In Split(strFileNames, ",")
    If itm <> "" Then
        Set wb = Workbooks.Open(spath & itm)

        ''DO LOTS OF CALCULATIONS (code above included)

    End If
Next itm 
```

对于每个文件，假设我有以下列，我希望该公式执行的操作是放在第 6 列中的下一个可用单元格（根据我的代码，第 6 列是数量）并向下拖动直到最后一行列4（同样，根据我的代码，第 4 列是 RptLOB）

前任：

```
RptLOB       ECMAccount  Amount
Disability   GEP         20   ---> (=SUMIF formula for file 1)
MSL          GEP         ..
Contingency  GEP         ..   ---> drag down to here (end of file 1)
Disability   GEP         30   ---> (=SUMIF formula for file 2)
MSL          GEP         ..
Contingency  GEP         ..   ---> drag down to here (end of file 2) 
```

依此类推每个文件。

我认为我的第一个代码实际上将 SUMIF 公式放在 Amount 列的下一个可用单元格并将其向下拖动会起作用，但它只是将 SUMIF 公式放在 Amount 之后的第一行（Amount 在 F1 中 - 所以只有 20 是显示）并且没有其他任何内容被拖下......我不太确定我的代码有什么问题，无论是自动填充还是它如何读取每个文件。

如果有人对此问题有任何见解或需要更多说明，请随时发表评论/询问。

任何帮助将不胜感激！

编辑：即使我只使用一个文件并输入另一个类似的代码

```
With BD.Sheets("Sheet1")
            .Range("F" & .Cells(Rows.Count, 6).End(xlUp).Offset(1, 0).Row).Select
            Selection.AutoFill Destination:=.Range("F" & .Cells(Rows.Count, 6).End(xlUp).Offset(1, 0).Row & ":F" & .Cells(Rows.Count, 4).End(xlUp).Row)
End With 
```

... F2 中只显示一个值，下面什么都没有

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T21:45:13.830

您的选择是否有可能不在打开的工作表上起作用？我不确定 BD 设置在哪里，但可以这么说，确保它完全按照你认为它的作用。

我可能会修改代码以确保这样：

```
...
''Open each file found
For Each itm In Split(strFileNames, ",")
    If itm <> "" Then
        Set wb = Workbooks.Open(spath & itm)
        Set ws = ws.sheets(whateversheet)

        ws.Range("F" & Cells(Rows.Count, 6).End(xlUp).Offset(1, 0).Row).Formula = "=SUMIF('" & spath & "[" & itm & "]Sheet1'!$D$13:$D$" & LastRow2 & ",D" & BD.Sheets("Sheet1").Cells(Rows.Count, 6).End(xlUp).Offset(1, 0).Row & ",OFFSET('" & spath & "[" & itm & "]Sheet1'!$D$13:$D$" & LastRow2 & ",0,MATCH(E" & BD.Sheets("Sheet1").Cells(Rows.Count, 6).End(xlUp).Offset(1, 0).Row & ",'" & spath & "[" & itm & "]Sheet1'!$D$12:$R$12,0)-1))"
        With ws
            .Range("F" & .Cells(Rows.Count, 6).End(xlUp).Offset(1, 0).Row).AutoFill Destination:=.Range("F" & .Cells(Rows.Count, 6).End(xlUp).Offset(1, 0).Row & ":F" & .Cells(Rows.Count, 4).End(xlUp).Row)
        End With
    End If
Next itm 
```

我也可以确保

```
Rows.Count 
```

正确出现。不确定它是如何计算的，但在调用 AutoFill 时可能会引起一些麻烦。

# .net - WebApi 中的条件 DataContract 序列化

> ID：12465285
> 
> 赞同：2
> 
> 时间：2012-09-17T18:41:12.007
> 
> 标签：.net, rest, serialization, datacontractserializer, asp.net-web-api

我正在尝试在我的 .net WebApi 项目中找到有条件地从我的数据合同序列化中包含和删除属性的最佳方法。在我的 Api 中，我希望允许用户指定他们想要返回的字段。

例如，假设我希望我的 API 返回以下类的实例。

```
public class Car
{
    public int Id { get; set; }
    public string Year { get; set; }
    public string Make { get; set; }
    public string Model { get; set; }
    public string Color { get; set; }
} 
```

但是，API 调用不是请求整个对象，而是只需要 Id 和 Make 字段。所以返回 JSON 将是

```
 { "Id": 12345, "Make": "Ford"} 
```

而不是整个对象。

DataContract Serializer 有没有一种方法可以有条件地从返回对象中添加和删除属性？

**编辑我查看了 IgnoreDefault 属性，但我不相信它会完全满足我的需要。问题是我想根据 api 请求包含和排除属性，不一定取决于它们是否有数据。

有什么方法可以挂钩反序列化过程并跳过某些属性？我可以做某种定制合同吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-17T19:18:33.970

如果您使用的是`DataContractSerializer`（或在本例中为`DataContractJsonSerializer`），则可以`DataMember(EmitDefaultValue = false)]`在您的班级中使用装饰。这样，您可以将*不*希望序列化的属性设置为它们的默认值（即，`null`对于字符串，0 表示整数等），它们不会被序列化。

如果您使用的是 ASP.NET Web API，那么您应该知道默认的 JSON 序列化程序不是`DataContractJsonSerializer`(DCJS)，而是 JSON.NET。因此，除非您明确配置您`JsonMediaTypeFormatter`使用 DCJS，否则您需要另一个属性来获得相同的行为（`JsonProperty`及其`DefaultValueHandling`属性）。

下面的代码仅使用两个序列化器序列化在此 Car 对象中分配的两个成员。请注意，如果您只打算使用其中一个属性，则可以删除其中一个属性。

```
public class StackOverflow_12465285
{
    [DataContract]
    public class Car
    {
        private int savedId;
        private string savedYear;
        private string savedMake;
        private string savedModel;
        private string savedColor;

        [DataMember(EmitDefaultValue = false)]
        [JsonProperty(DefaultValueHandling = DefaultValueHandling.Ignore)]
        public int Id { get; set; }
        [DataMember(EmitDefaultValue = false)]
        [JsonProperty(DefaultValueHandling = DefaultValueHandling.Ignore)]
        public string Year { get; set; }
        [DataMember(EmitDefaultValue = false)]
        [JsonProperty(DefaultValueHandling = DefaultValueHandling.Ignore)]
        public string Make { get; set; }
        [DataMember(EmitDefaultValue = false)]
        [JsonProperty(DefaultValueHandling = DefaultValueHandling.Ignore)]
        public string Model { get; set; }
        [DataMember(EmitDefaultValue = false)]
        [JsonProperty(DefaultValueHandling = DefaultValueHandling.Ignore)]
        public string Color { get; set; }

        [OnSerializing]
        void OnSerializing(StreamingContext ctx)
        {
            this.savedId = this.Id;
            this.savedYear = this.Year;
            this.savedMake = this.Make;
            this.savedModel = this.Model;
            this.savedColor = this.Color;

            // Logic to determine which ones to serialize, let's say I only want Id, Make; so make all others default.
            this.Color = default(string);
            this.Model = default(string);
            this.Year = default(string);
        }

        [OnSerialized]
        void OnSerialized(StreamingContext ctx)
        {
            this.Id = this.savedId;
            this.Year = this.savedYear;
            this.Make = this.savedMake;
            this.Model = this.savedModel;
            this.Color = this.savedColor;
        }
    }

    public static void Test()
    {
        Car car = new Car { Id = 12345, Make = "Ford", Model = "Focus", Color = "Red", Year = "2010" };
        JsonSerializer js = new JsonSerializer();
        StringBuilder sb = new StringBuilder();
        StringWriter sw = new StringWriter(sb);
        js.Serialize(sw, car);
        Console.WriteLine("Using JSON.NET: {0}", sb.ToString());

        MemoryStream ms = new MemoryStream();
        DataContractJsonSerializer dcjs = new DataContractJsonSerializer(typeof(Car));
        dcjs.WriteObject(ms, car);
        Console.WriteLine("Using DCJS: {0}", Encoding.UTF8.GetString(ms.ToArray()));
    }
} 
```

# c# - 从表达式选择器获取非常量构造函数参数

> ID：12465286
> 
> 赞同：2
> 
> 时间：2012-09-17T18:41:12.063
> 
> 标签：c#, .net, reflection, lambda, expression-trees

我有一个看起来像这样的方法：

```
public static T GenerateProxy<T>(params object[] ctorArgs)
{
    return proxyGenerator.CreateProxy(typeof(T), ctorArgs);
} 
```

基本上，它根据类型 T 和我提供的任何参数调用适当的构造函数以找到匹配的构造函数。这可行，但是如果构造函数发生更改，如果我更改构造函数更改的参数数量，我不会收到任何编译时错误。我找到了一个很好的实用方法，它使用 an`Expression`来获取构造函数参数，如下所示：

```
public static object[] GetCTorArgumentsFromSelector<T>(Expression<Func<T>> ctorCall) where T : class
{
    if (ctorCall == null) throw new ArgumentNullException("ctorCall");

    var newCall = ctorCall.Body as NewExpression;
    if (newCall == null)
    {
        throw new ArgumentException("Not a constructor call.", "ctorCall");
    }

    int argumentCount = newCall.Arguments.Count;

    var ctorArgs = new object[argumentCount];
    for (int i = 0; i < ctorArgs.Length; i++)
    {
        var param = newCall.Arguments[i] as ConstantExpression;
        if (param == null)
            throw new ArgumentException("You may only place constant values in calls to the constructor.");

        ctorArgs[i] = param.Value;
    }

    return ctorArgs;
} 
```

所以它可以像这样使用：

```
SomeClass arg = new SomeClass();
var ctorArgs = GetCTorArgumentsFromSelector(() => MyClass(arg));
var proxy = GenerateProxy<MyClass>(ctorArgs); 
```

...这将是很好的强类型。所以......因为我对表达式不太了解，所以我想知道是否可以以任何方式解决仅使用常量的限制。我上面的例子不起作用，因为`arg`它不是一个常数，但以这种方式使用它会很好。

我想我理解为什么存在限制，但我希望其他人可能对这里的替代方法有一个好主意。提前致谢。

**编辑**- 因此，经过更多搜索，似乎我可以替换`ConstantExpression`为，然后使用[此处](https://stackoverflow.com/questions/2616638/access-the-value-of-a-member-expression)`MemberExpression`答案中的方法编译和调用它......但我不知道这会产生什么后果。

# c# - 每 X 分钟运行一次线程并更新表单组件 c#

> ID：12465288
> 
> 赞同：0
> 
> 时间：2012-09-17T18:41:24.983
> 
> 标签：c#, multithreading, forms, class

这是我的问题...我有一个带有 ListBox 和 RichTextBox 的 Windows 窗体，以及一个带有一些功能的单独类文件...

我知道如何更新一个简单的文本框，但不是一个列表视图，因为如果我使用相同的代码，我会为 myFunc 的每一步获得 1 个新项目，重点是：

```
//myFunc loads
var lv = listProcess.Items.Add("This is my item");
//myFunc step1
lv.SubItems.Add("Column2 step1 status");
lv.SubItems.Add("Column3 step1 status");
lv.SubItems.Add("Column4 step1 status");
//myFunc step2
lv.SubItems.Add("Column2 step2 status");
lv.SubItems.Add("Column3 step2 status");
lv.SubItems.Add("Column4 step2 status");
//myFunc ends
//Remove item "lv" from listview. 
```

我希望有一个人可以帮助我...

> form1.cs

```
public Form1()
    {
        InitializeComponent();
        var func = new System.Threading.Timer(otherclass.myFunc, null, 0, 60000);
    } 
```

> 其他类.cs

```
public class otherclass
{
    public static void myFunc(object sender)
    {
        var lv = listProcess.Items.Add("This is my item");
        for(int i; i <= x; i++)
        // Update lv subitems here
        next
        // Update richTextBox1 here when all steps are done

    }
} 
```

我希望有人能帮助我，因为我很迷茫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T18:46:40.803

```
public class otherclass   // otherclass means: should not know about ListViews or RTBs
{
    public static void myFunc(object sender)
    {
        var lv = listProcess.Items.Add("This is my item");
        for(int i; i <= x; i++)
        // Update lv subitems here
        next
        // Update richTextBox1 here when all steps are done

    }
} 
```

对于您的一般问题：

1.  使用 WinForms 计时器（不是 Threading.Timer）
2.  当它滴答作响时，启动一个Backgroundworker
3.  Bgw 执行 DOWork 中的函数，更新 Completed 中的 ListView。

因此，您需要的是`List<string>`从`MyFunc()`.

# .net - ADO.NET 命令和连接对象 (odp.net) 的生命周期

> ID：12465294
> 
> 赞同：2
> 
> 时间：2012-09-17T18:41:38.057
> 
> 标签：.net, ado.net, odp.net

我正在更新我们公司用来调用 Oracle 数据库上的存储过程的数据访问库。该库当前允许调用应用程序使用单个 OracleCommand (IDbCommand) 对象和单个 OracleConnection (IDBConnection) 进行多个调用。这意味着调用者将为调用添加参数，进行调用，清除参数并重复。完成后，消费者应用程序调用 dispose 来清理所有内容。

我可以通过在库中使用“使用”语句来确保在每次调用后清理命令和连接对象来使事情变得更干净，但这意味着上述功能将丢失并且每次调用都会创建一个新的命令/连接. 我发现在我发现的大多数示例中都这样做了，但它们通常只是简单的示例。

我的问题：允许命令和/或连接在调用之间持续存在是否值得？每次重新创建它们是否过于昂贵？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T18:57:43.350

这是关于可扩展性的。创建和处理命令的成本很低。保持连接打开是昂贵的部分。如果您有 1000 个活动客户端持有 1000 个打开的连接，那么这就是数据库的负载。我经常持有连接对象，但只是关闭连接。这减轻了数据库的负担，并且在 .NET 中保存连接对象的开销非常小。在典型的最终用户程序中，连接仅在一小部分时间使用，因此在不使用时关闭连接，这 1000 个用户可能只有 10 个活动连接。现在，像数据加载器这样的程序使用连接 1/2 的时间，然后保持连接打开。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-06T02:13:10.563

请注意，默认情况下，OracleConnection 对象实际上是一个连接池。因此，您可以让它为您完成实际打开和关闭连接的工作，同时仍然保持良好的性能。您可以使用许多连接字符串属性来控制池的大小和连接的生命周期。

克里斯蒂安·谢伊

甲骨文

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T09:04:44.277

同意布拉姆。连接对象应该使用数据访问类创建，并且每个执行数据库调用的方法都应该打开和关闭它，除非您在方法之间有某种事务控制，但总的来说，对于简单的 CRUD 操作，这是方法我建议你采取

# asp.net - 数据源不支持服务器端分页

> ID：12465296
> 
> 赞同：0
> 
> 时间：2012-09-17T18:41:44.733
> 
> 标签：asp.net, paging, objectdatasource

嗨，我已经看到了这个问题的几个答案，但我有一个特殊的案例。当用户单击后面代码中的下拉菜单时，我想使用网格视图控件控制 ASP.NET Web 表单上显示的内容。像这样：

```
If ddlProducts.SelectedValue <> "-1" Then
        gvCategories.DataSource = obj.getAll().Where(Function(c) c.productId = Integer.Parse(ddlProducts.SelectedValue)).Skip(0).Take(10)

        gvCategories.DataBind() 
```

在使用 ObjectDatasource 时，我得到一个错误-

```
Both DataSource and DataSourceID are defined on 'gvCategories'.  Remove one definition. 
```

但是，我需要在后面的代码中过滤列表，并且只能将其设置为 Datasource 而不是 DatasourceID。他们都强调不需要背后的代码。我该怎么做。如果它已被回答，请原谅我，但我没有看到它可能是因为我很着急。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T18:44:34.753

您可以使用 过滤列表`ObjectDataSource`，您可以通过向其中添加一个新列表`SelectParameter`并以某种方式（例如以编程方式）传递参数的值来完成此操作。然后，将该值传递给您的数据提供者类（`ObjectDataSource`请求数据的类），以便您可以在查询数据源时使用它。

# android - 异步任务的带有文本和图像的列表视图

> ID：12465298
> 
> 赞同：0
> 
> 时间：2012-09-17T18:41:49.400
> 
> 标签：android

您好，我想开发一个带有缩略图和产品名称的产品列表。我削减了产品名称，`JSON`但我想在左侧添加缩略图。是否可以`AsyncTask`与图像和`Strings`. 我该怎么做？如何将图像和文本一起返回。我想在如下所示的代码中调用图像：

```
package com.eticaret.hakan;

import java.io.BufferedInputStream;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;

import org.apache.http.NameValuePair;
import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;

import android.app.ListActivity;
import android.app.ProgressDialog;
import android.content.Intent;

import android.os.AsyncTask;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.widget.AdapterView;

import android.widget.ListAdapter;
import android.widget.ListView;
import android.widget.SimpleAdapter;
import android.widget.TextView;
import android.widget.AdapterView.OnItemClickListener;

public class ProductActivity extends ListActivity {
    int intid;
    // Progress Dialog
    private ProgressDialog pDialog;

    // Creating JSON Parser object
    JSONParser jParser = new JSONParser();

    ArrayList<HashMap<String, String>> productsList;

    // url to get all products list
    private static String url_all_products = "http://10.0.2.2/projeler/e-ticaret/get_all_products.php";

    // JSON Node names
    private static final String TAG_SUCCESS = "success";
    private static final String TAG_PRODUCTS = "urunler";
    private static final String TAG_PID = "pid";
    private static final String TAG_PNAME = "pname";
    private static final String TAG_PPRICE = "pprice";
    private static final String TAG_PDESCRIPTION = "pdescription";
    private static final String TAG_CREATEDAT = "created_at";
    private static final String TAG_CATID = "cat_Id";

    // products JSONArray
    JSONArray products = null;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.products);
        Bundle extras = getIntent().getExtras(); 
        String id = extras.getString("cat_Id");
        intid=Integer.parseInt(id);

        // Hashmap for ListView
        productsList = new ArrayList<HashMap<String, String>>();

        // Loading products in Background Thread
        new LoadAllProducts().execute();

        // Get listview
        ListView lv = getListView();

        // on seleting single product
        // launching Edit Product Screen
        lv.setOnItemClickListener(new OnItemClickListener() {

            public void onItemClick(AdapterView<?> parent, View view,
                    int position, long id) {
                // getting values from selected ListItem
                String pid = ((TextView) view.findViewById(R.id.pid)).getText()
                        .toString();

                // Starting new intent
                Intent in = new Intent(getApplicationContext(),
                        Details.class);
                // sending pid to next activity
                in.putExtra(TAG_PID, pid);

                // starting new activity and expecting some response back
                startActivityForResult(in, 100);
            }
        });

    }

    // Response from Edit Product Activity
    @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {
        super.onActivityResult(requestCode, resultCode, data);
        // if result code 100
        if (resultCode == 100) {
            // if result code 100 is received 
            // means user edited/deleted product
            // reload this screen again
            Intent intent = getIntent();
            finish();
            startActivity(intent);
        }

    }

    /**
     * Background Async Task to Load all product by making HTTP Request
     * */
    class LoadAllProducts extends AsyncTask<String, String, String> {

        /**
         * Before starting background thread Show Progress Dialog
         * */
        @Override
        protected void onPreExecute() {
            super.onPreExecute();
            pDialog = new ProgressDialog(ProductActivity.this);
            pDialog.setMessage("Loading products. Please wait...");
            pDialog.setIndeterminate(false);
            pDialog.setCancelable(false);
            pDialog.show();
        }

        /**
         * getting All products from url
         * */
        protected String doInBackground(String... args) {
            // Building Parameters
            List<NameValuePair> params = new ArrayList<NameValuePair>();
            // getting JSON string from URL
            JSONObject json = jParser.makeHttpRequest(url_all_products, "GET", params);

            // Check your log cat for JSON reponse
            Log.d("All Products: ", json.toString());

            try {
                // Checking for SUCCESS TAG
                int success = json.getInt(TAG_SUCCESS);

                if (success == 1) {
                    // products found
                    // Getting Array of Products
                    products = json.getJSONArray(TAG_PRODUCTS);

                    // looping through All Products
                    for (int i = 0; i < products.length(); i++) {
                        JSONObject c = products.getJSONObject(i);

                        // Storing each json item in variable
                        String id = c.getString(TAG_PID);
                        String name = c.getString(TAG_PNAME);
                        String price = c.getString(TAG_PPRICE);
                        String description = c.getString(TAG_PDESCRIPTION);
                        String created_at = c.getString(TAG_CREATEDAT);
                        String catid = c.getString(TAG_CATID);
                        int intcatid=Integer.parseInt(catid);

                        // creating new HashMap
                        HashMap<String, String> map = new HashMap<String, String>();
                        if(intcatid==intid){
                            // adding each child node to HashMap key => value
                            map.put(TAG_PID, id);
                            map.put(TAG_PNAME, name);
                            map.put(TAG_PPRICE, price);
                            map.put(TAG_PDESCRIPTION, description);
                            map.put(TAG_CREATEDAT, created_at);

                            // adding HashList to ArrayList
                            productsList.add(map);

                        }

                    }
                } else {
                    // no products found
                    // Launch Add New product Activity
                    Intent i = new Intent(getApplicationContext(),
                            ProductActivity.class);
                    // Closing all previous activities
                    i.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
                    startActivity(i);
                }
            } catch (JSONException e) {
                e.printStackTrace();
            }

            return null;
        }

        /**
         * After completing background task Dismiss the progress dialog
         * **/
        protected void onPostExecute(String file_url) {
            // dismiss the dialog after getting all products
            pDialog.dismiss();
            // updating UI from Background Thread
            runOnUiThread(new Runnable() {
                public void run() {
                    /**
                     * Updating parsed JSON data into ListView
                     * */
                    ListAdapter adapter = new SimpleAdapter(
                            ProductActivity.this, productsList,
                            R.layout.plist_item, new String[] { TAG_PID,
                                    TAG_PNAME,TAG_PPRICE},
                                    new int[] { R.id.pid, R.id.pname,R.id.pprice});
                    // updating listview
                    setListAdapter(adapter);
                }
            });

        }

    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T19:03:08.427

`onPostExecute`在 UI 线程上运行，因此无需在其中调用`runOnUiThread()`。您应该解析 doInBackground 中的数据，然后将数据传递给 onPostExecute，`return result;` 这是我通常做的：

我创建了一个空成员 ArrayList（比如说产品列表）并在 onCreate() 中用它初始化列表适配器。在 onPostExecute 中，我将项目添加到列表中（不要覆盖它）并在列表适配器上调用 notifyDataSetChanged()，瞧！

# wordpress - wordpress wp电子商务产品数据进入另一个数据库？

> ID：12465301
> 
> 赞同：1
> 
> 时间：2012-09-17T18:42:24.237
> 
> 标签：wordpress

wordpress 内容是否可以在当前数据库中获取。但是 wordpress 电子商务产品页面将产品获取到另一个数据库中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T08:49:26.160

查看 HyperDB：

[http://codex.wordpress.org/HyperDB](http://codex.wordpress.org/HyperDB)

> HyperDB 是标准 wpdb 类的替代品，它增加了使用多个数据库的能力。**HyperDB 支持数据分区**和复制。

# php - php中关联数组变量的变量？

> ID：12465304
> 
> 赞同：-3
> 
> 时间：2012-09-17T18:42:35.263
> 
> 标签：php, arrays

我有数组`$arr=array("a"=>array("b"=>123))` ，我需要像这样处理它：

```
$a='[a][b]';
echo $arr{$a}; 
```

但它不起作用；

`echo $arr[a][b];`- 工作正常，但这不是我需要的。=(

PHP手册说：

*如果您编写 $$a [1](http://php.net/manual/en/language.variables.variable.php)，那么解析器需要知道您是否打算使用 $a [1](http://php.net/manual/en/language.variables.variable.php)作为变量，或者您是否希望 $$a 作为变量，然后是该变量的[1](http://php.net/manual/en/language.variables.variable.php)索引。解决这种歧义的语法是： ${$a [1](http://php.net/manual/en/language.variables.variable.php) } 用于第一种情况， ${$a} [1](http://php.net/manual/en/language.variables.variable.php)用于第二种情况。*>> [php手册](http://php.net/manual/en/language.variables.variable.php)

但是“回声 ${$a};” 和“回声 $arr{$a};” 并且所有其他变体都没有输出。

**更新**

简而言之，我需要通过表单删除关联数组的一个元素。例如，我有 $a=array('abc'=>'def'); 和html表单

```
<form><input name="deleteIT" value="[abc]"></form> 
```

所以，提交后我想从 $a 变量中删除 $deleteIT 值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T18:46:41.567

这是否足够接近您的需要？

```
$a = "a,b";
list( $i, $j ) = explode( ",", $a );
echo $arr[$i][$j]; 
```

* * *

**附录：**`$arr`如果数组总是恰好有两个级别，则上面的答案将起作用。如果它可能有更多（或更少），则可以使用以下方法：

```
function array_get_nested ( $array, $keys ) {
    $value = $array;
    foreach ( $keys as $index ) {
        $value = $value[ $index ];
    }
    return $value;
} 
```

上面的函数接受两个数组作为参数：一个包含我们想要的值，另一个列出我们需要在第一个数组中定位它的键。例如，如果我们有一个这样的数组：

```
$arr = array( "a" => array( "b" => array( "c" => 123 ) ) ); 
```

然后

```
echo array_get_nested( $arr, array( "a", "b", "c" ) ); 
```

会打印`123`.

将字符串键转换为适合第二个参数的数组`array_get_nested()`取决于键的格式，但它可以像`explode()`使用合适的分隔符调用一样简单。例如，上面的最后一行代码可以重写为：

```
$k = "a,b,c";
echo array_get_nested( $arr, explode( ",", $k ) ); 
```

要修改嵌套数组，我们可以使用类似的函数：

```
function array_set_nested ( &$array, $keys, $value ) {
    $ref =& $array;
    foreach ( $keys as $index ) {
        $ref =& $ref[ $index ];
    }
    $ref = $value;
} 
```

请注意，PHP 方便地为我们“自动激活”数组，因此我们可以，例如，获取一个以前未定义的变量`$foo`并将其转换为三级嵌套数组，只需：

```
array_set_nested( $foo, array( "a", "b", "c" ), 123 ); 
```

# objective-c - 给 UIButton 的自定义子类

> ID：12465305
> 
> 赞同：0
> 
> 时间：2012-09-17T18:42:36.487
> 
> 标签：objective-c, xcode

我想给我的 UIButton 的自定义子类，以便每个按钮跟踪它的左侧、右侧、顶部和底部的按钮。

例如（在 6x5 按钮布局上），我希望按钮我的按钮`button23`（在位置 (2,3)）具有`button23.left = button22` `button23.right = button24` `button23.top = button33`和`button23.bottom = button13`. 解决这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T19:20:38.897

如果要创建控件的二维链接列表，则可以这样做。但是除了隐藏 UIButton 子类中的实际结构外，子类化对您没有多大帮助。

你需要一个类来管理这个结构的创建，Interface Builder 不会为你做。因此，如果您要创建一个 UIButton 的子类，并为每个维度创建两个链表节点 prev 和 next，然后手动创建所有按钮并将链表指针设置为适当的控件。

在垂直情况下，prev 和 next 表示顶部或底部。

如果您不创建子类，只需创建一个二维链表管理器，并在外部添加节点和指向节点相关节点的指针。

# c# - 在 VB6 应用程序中使用 .NET dll

> ID：12465306
> 
> 赞同：4
> 
> 时间：2012-09-17T18:42:38.383
> 
> 标签：c#, vb6

我在 c#.net 中编写了一个 dll，它在应用程序中调用另一个第三方 .NET dll。当我使用用 c#.NET 编写的控制台应用程序以及使用以下代码对其进行测试时，这可以正常工作：

```
 Assembly u = Assembly.LoadFrom(dllLocation);
 Type t = u.GetType("MyLIB.CLass");
 MethodInfo m = t.GetMethod("Method");
 object[] myparam = new object[1];
 myparam[0] = fileLocation;
 result = (string)m.Invoke(null, myparam); 
```

请注意，某些文件也会在最初加载 dll 的位置加载：

```
 string path = Assembly.GetExecutingAssembly().Location;
  path = Path.GetDirectoryName(path); 
```

但问题是，当我尝试使用 VB6 调用它时，我收到一个错误，即它无法加载第三方 dll。请帮忙，因为我似乎不知道发生了什么。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-17T18:53:09.847

我想给你更多细节，以便 .NET 程序集向 COM 公开

你需要生成`tbl - type library`

使用`RegAsm /tlb: MyLIB.tlb MyLIB.dll`

有一些**指南**可以将 .NET 类型暴露给 COM，并确保您能够应对。例如声明**ComVisibleAttribute** ，要求公共默认构造函数对 COM 可见，例如在

您可以参考 [如何从 Visual Basic 6.0 调用 Visual Basic .NET 或 Visual Basic 2005 程序集](http://support.microsoft.com/default.aspx?scid=kb;en-us;817248)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-17T18:45:23.170

您需要在程序集上指定[ComVisibleAttribute](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.comvisibleattribute%28v=vs.71%29.aspx)才能从 VB6 调用它。

# html - IE9 不正确地显示内联块 div

> ID：12465307
> 
> 赞同：0
> 
> 时间：2012-09-17T18:42:39.460
> 
> 标签：html, css

我有一个带有子 div 的 div，我正在尝试用它来创建幻灯片。我显示了子 div `inline-block`，除了 IE<=9 之外，一切看起来都很棒。在 IE<=9 中，每个`div.contentItem`都垂直显示。

我使用`white-space: nowrap`and `inline-block`（而不是`float:left`），因为更多`div.contentItem`是异步添加的，我不想`div.content`每次添加新元素时都必须重新计算宽度。因此，出于这个原因，我宁愿远离，`float:left`除非有一种方法可以使用浮动而不必指定宽度。

**注意**我无法更改文档类型，因为它位于母版页上并被我们 cms 中的许多其他页面使用。太多的回归测试。

html

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:og="http://ogp.me/ns#" xmlns:fb="http://www.facebook.com/2008/fbml">
<head></head>
<body>
    <div class="content">
        <div class="contentItem">...</div>
        <div class="contentItem">...</div>
        <div class="contentItem">...</div>
        <div class="contentItem">...</div>
        <div class="contentItem">...</div>
        <div class="contentItem">...</div>
        <div class="contentItem">...</div>
    </div>
</body>
</html> 
```

css

```
.content {
    white-space: nowrap;
    margin-left: 256px;
    position: relative;
    padding-top: 14px;
}

.contentItem {
    display: -moz-inline-stack;
    display: inline-block !important;
    *display: inline;
    margin: 0 14px 0 0;
    vertical-align: top;
    zoom: 1;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T20:04:03.740

我将其更改`div.contentItem`为`span.contentItem`. 现在项目显示内联，不需要更改 css。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T18:56:01.617

如果您保留您`white-space: nowrap`的父 div，您应该能够`float: left`在您的孩子上使用，而无需为父级定义宽度。

请参阅我之前为另一篇文章所做的[小提琴插图。](http://jsfiddle.net/scrimothy/e6rbk/2/)它也适用于这里。您可以调整结果窗口的大小以查看`white-space`设置为的两个版本`nowrap`（无论是浮动块还是内联块）它们始终保持在一行上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T18:53:42.890

内联块在涉及空白时很敏感，如果内容与其父级一样宽，它可能会中断并转到下一行..也许你需要这样的东西

```
<body>
    <div class="content">
        <div class="contentItem">...</div><div class="contentItem">...</div><div class="contentItem">...</div>
    </div>
</body> 
```

从内联元素周围删除所有空格应该使它们完全符合您希望它们的大小

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-17T18:52:17.960

IE <= 8 不完全支持`display: inline-block`. [在这里阅读。](http://www.quirksmode.org/css/display.html)

而不是使用`inline-block`，尝试将此代码应用于您的幻灯片：http: [//jsfiddle.net/9ACNT/](http://jsfiddle.net/9ACNT/)

# javascript - 谷歌地图信息窗口内的滑块

> ID：12465310
> 
> 赞同：8
> 
> 时间：2012-09-17T18:42:46.890
> 
> 标签：javascript, jquery, google-maps

**问题：**我试图在谷歌地图的信息窗口中集成一个滑块（轮播）。

**1.滑块的jQuery代码：**

```
<head>
...
    <script src="js/jquery.anythingslider.js"></script>
    <script>
       // Set up Sliders
        // **************         
        $(function(){
            $('#mySlider').anythingSlider({
                mode                : 'f',   // fade mode - new in v1.8!
                resizeContents      : false, // If true, solitary images/objects in the panel will expand to fit the viewport
                expand              : true,
                navigationSize      : 3,     // Set this to the maximum number of visible navigation tabs; false to disable

                onSlideBegin: function(e,slider) {
                    // keep the current navigation tab in view
                    slider.navWindow( slider.targetPage );
                }
            });
        });
    </script>
  ...
 </head> 
```

**2.HTML代码。**这是滑块在常规 html 页面中的工作方式：

```
 <div style="width:450px;height:150px;">        
    <ul id="mySlider">  <!-- id corresponds to id used in Jquery code  -->

       <li>
         Content of Slide 1
       </li>
       <li>
          Content of Slide 2
       </li>
       <li>
          Content of slide 3
       </li>

     </ul>
  </div> 
```

现在，我对 JavaScript 没有太多经验，所以如何使 jquery 代码在信息窗口中可访问。换句话说，我应该把他的滑块代码放在哪里？

**编辑：** 这是我迄今为止尝试过的，但没有运气

```
(function() {  
// Defining variables that need to be available to some functions
var map, infoWindow;
window.onload = function() {
    // Creating a map
    var options = {
        zoom: 3,
        center: new google.maps.LatLng(37.09, -95.71),
        mapTypeId: google.maps.MapTypeId.ROADMAP
    };
    map = new google.maps.Map(document.getElementById('map'), options);
    // Adding a marker to the map
    var marker = new google.maps.Marker({
        position: new google.maps.LatLng(40.756054, -73.986951),
        map: map,
        title: 'Click me'
    });
    google.maps.event.addListener(marker, 'click', function() {

        // add some content to userLi1 
        var userLi1 = '<li>Some awesome content for the 1st list item</li>';

        // add some content userLi2
        var userLi2 = '<li>Some awesome content for the 2nd list item</li>'

        // Check to see if an InfoWindow already exists
        if (!infoWindow) {
            infoWindow = new google.maps.InfoWindow();

        }

        // Setting the content of the InfoWindow to the detail map
        //infoWindow.setContent(detailDiv);

        infoWindow.setContent('<div style = "width:450px;height:150px;"><ul id="mySlider">' + userLi1 + userLi2 + '</ul></div>');

        // Opening the InfoWindow
        infoWindow.open(map, marker);   

    });

    // initiate slider here
    $('#mySlider').anythingSlider({
        mode                : 'f',   // fade mode - new in v1.8!
        resizeContents      : false, // If true, solitary images/objects in the panel will expand to fit the viewport
        expand              : true,
        navigationSize      : 3,     // Set this to the maximum number of visible navigation tabs; false to disable

        onSlideBegin: function(e,slider) {
            // keep the current navigation tab in view
            slider.navWindow( slider.targetPage );
        }
    });
};
})(); 
```

当我运行代码时，Jquery 根本不会被触发。

**编辑 2：解决方案**我通过使用 McMaster 代码并将相关的 jquery 代码包装起来解决了这个问题

```
 google.maps.event.addListener(infowindow, 'domready', function(){
 }); 
```

所以这是整个代码：

```
 $(document).ready(function() {   // runs jquery when document is ready

function initialize() {
    var mapDiv = document.getElementById('map');
    map = new google.maps.Map(mapDiv, {
        zoom: 3,
        center: new google.maps.LatLng(37.09, -95.71),
        mapTypeId: google.maps.MapTypeId.ROADMAP
    });
    infowindow = new google.maps.InfoWindow({
        content: "holding..."
    });

    // looks for map, when tiles are loaded, fire function addmarkers                 
    google.maps.event.addListenerOnce(map, 'tilesloaded', addMarkers);

}

function addMarkers() {
    var lat =37.09;
    var lng = -95-71;
    var latLng = new google.maps.LatLng(
        lat,
        lng);
    var marker = new google.maps.Marker({
        position: latLng,
        map: map
    });
    // add some content to userLi1
    var userLi1 = '<li>Some awesome content for the 1st list item</li>';

    // add some content userLi2
    var userLi2 = '<li>Some awesome content for the 2nd list item</li>'
    // set marker content
    marker.html = '<div style = "width:450px;height:150px;"><ul id="mySlider">' + userLi1 + userLi2 + '</ul></div>';
    // add listener
    google.maps.event.addListener(marker, 'click', function() {
        infowindow.setContent(marker.html);
        infowindow.open(map, marker);
    });

}

initialize();      
google.maps.event.addListener(infowindow, 'domready', function(){
    // initiate slider here
    $('#mySlider').anythingSlider({
        mode                : 'f',   // fade mode - new in v1.8!
        resizeContents      : false, // If true, solitary images/objects in the panel will expand to fit the viewport
        expand              : true,
        navigationSize      : 3,     // Set this to the maximum number of visible navigation tabs; false to disable

        onSlideBegin: function(e,slider) {
            // keep the current navigation tab in view
            slider.navWindow( slider.targetPage );
        }
    });
}); 

}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T18:51:45.637

您实际上是在文档上直接创建一个 DOM 元素

你需要使用这样的东西：

```
infoWindow.setContent('<div id="mySlider"><ul><li>' + userLi1 + '</li><li>' + userLi2 + '</li></ul></div>'); 
```

编辑：

这是从我的一个项目修改的完全有效的脚本，以满足您的需求：

```
$(document).ready(function() {   // runs jquery when document is ready

     function initialize() {
            var mapDiv = document.getElementById('map');
            map = new google.maps.Map(mapDiv, {
                 zoom: 3,
                center: new google.maps.LatLng(37.09, -95.71),
                mapTypeId: google.maps.MapTypeId.ROADMAP
            });
            infowindow = new google.maps.InfoWindow({
                content: "holding..."
            });

           // looks for map, when tiles are loaded, fire function addmarkers                 
            google.maps.event.addListenerOnce(map, 'tilesloaded', addMarkers);

          }

          function addMarkers() {
                var lat =37.09;
                var lng = -95-71;
              var latLng = new google.maps.LatLng(
                                                lat,
                                                lng);
              var marker = new google.maps.Marker({
                position: latLng,
                map: map
              });
             // add some content to userLi1 
            var userLi1 = '<li>Some awesome content for the 1st list item</li>';

            // add some content userLi2
            var userLi2 = '<li>Some awesome content for the 2nd list item</li>'
              // set marker content
              marker.html = '<div style = "width:450px;height:150px;"><ul id="slider2">' + userLi1 + userLi2 + '</ul></div>';
             // add listener 
             google.maps.event.addListener(marker, 'click', function() {
                    infowindow.setContent(marker.html);
                  infowindow.open(map, marker);
                });

          }

          initialize();      
          // initiate slider here
        $('#mySlider').anythingSlider({
            mode                : 'f',   // fade mode - new in v1.8!
            resizeContents      : false, // If true, solitary images/objects in the panel will expand to fit the viewport
            expand              : true,
            navigationSize      : 3,     // Set this to the maximum number of visible navigation tabs; false to disable

            onSlideBegin: function(e,slider) {
                // keep the current navigation tab in view
                slider.navWindow( slider.targetPage );
            }
        });

});​ 
```

# xml - 使用 带有 XSD 和 XML 解析器错误

> ID：12465314
> 
> 赞同：0
> 
> 时间：2012-09-17T18:43:33.110
> 
> 标签：xml, xml-parsing, xsd

我不明白这里发生了什么。据我所知，我的小解析器程序通过了我的 XML 和 XSD 更改并很好地加载了东西，但是如果我把这些东西放在我们的生产系统中，它就会爆炸。

我现在才开始使用 XSD 导入语句。如果取出一些用户定义的类型并将它们全部放入 XSD，我会做什么。

以下是一些典型的错误

文件“/home/dfcuser/dataElementsTrans.xsd”出错，行 = 7，列 = 37，XML 元素 =，导入的架构 'DFCTypes.xsd' 具有不同的 targetNameSpace 'http://www.quikq.com/xsd/ dataElementsTrans 来自声明的“http://www.quikq.com/DFCTypes”

文件“/home/dfcuser/dataElementsTrans.xsd”错误，行 = 29，列 = 55，XML 元素 =，模式表示约束：命名空间 'http://www.quikq.com/DFCTypes' 被引用但没有声明

以下是示例文档的序言：

```
 DFCTypes.xsd
    ------------
    <xs:schema
        targetNamespace="http://www.quikq.com/DFCTypes" 
        xmlns:xs="http://www.w3.org/2001/XMLSchema"
        elementFormDefault="qualified"> 

    dataElementsTrans.xsd
    ---------------------
    <xs:schema 
        xmlns:xs="http://www.w3.org/2001/XMLSchema" 
        xmlns:dfct="http://www.quikq.com/DFCTypes" 
        targetNamespace="http://www.quikq.com/xsd/dataElementsTrans" 
        xmlns="http://www.quikq.com/xsd/dataElementsTrans"
        elementFormDefault="qualified" >

        <xs:import schemaLocation="DFCTypes.xsd" namespace="http://www.quikq.com/DFCTypes" />

    XML
    ---
    <dataElementsTrans 
        xmlns="http://www.quikq.com/xsd/dataElementsTrans" 
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
        xsi:schemaLocation="http://www.quikq.com/xsd/dataElementsTrans dataElementsTrans.xsd"> 
```

我的示例解析器程序和生产代码必须以不同的方式打开某些东西。我对此仍然很陌生，所以我有点挠头。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T15:54:51.800

如果我将实体解析器代码放入示例解析器中，它会像我的生产程序一样爆炸。我得说我对使用实体解析器知之甚少。

类定义：

```
 class MyResolver : public EntityResolver {
    private :
        string m_path;

    public :
        MyResolver(string path) { m_path = path; }

        InputSource* resolveEntity(const XMLCh* const publicId, const XMLCh* const systemId)
        {
            CStr2XStr path(m_path);

            if (XMLString::compareString(systemId, path.unicodeForm())) {
                return new LocalFileInputSource(path.unicodeForm());
            } else {
                return 0;
            }
        }
    }; 
```

实际使用：

```
 MyResolver *resolver = new MyResolver("/home/dfcuser/authNotify.xsd");
    parser->setEntityResolver(resolver); 
```

我想直接的解决方案是删除或更正我的实体解析器的东西。我很想听听一些评论！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T20:01:32.107

乍一看，您显示的开始标签的 xs:schema 元素看起来不错。我不希望他们引出这些错误消息。

您显示的错误消息表明您的生产系统上的 DFCTypes.xsd 副本将其目标命名空间声明为`http://www.quikq.com/xsd/dataElementsTrans`而不是`http://www.quikq.com/DFCTypes`- 可能是复制/粘贴错误或只是模式早期阶段的人工制品？（您*不仅*将用户定义的类型移动到它们自己的架构文档中，还将它们移动到它们自己的命名空间中。）您引用的第二条错误消息表明他正在处理的 Trans.xsd 副本缺少命名空间声明`xmlns:dfct="http://www.quikq.com/DFCTypes"`（正如对`xs:import`第 8 行中的元素在第 7 行中）。因此，如果我是您，我的第一件事是确保生产服务器上的模式处理器正在查找您认为正在查找的文档。（我通常的做法是在我认为应该阅读的文档中植入语法错误，并查看它们是否被标记。这对于生产服务器来说可能有点苛刻，但如果它无论如何都失败了......）

# c++ - 如何定义要使用的功能？

> ID：12465315
> 
> 赞同：1
> 
> 时间：2012-09-17T18:43:36.673
> 
> 标签：c++

我对 C++ 很陌生，并且 ClanLib 中的 CL_String8 函数出现错误。

当我尝试编译时：

```
CL_String now() {
    CL_DateTime now = CL_DateTime::get_current_local_time();
    return CL_String8(now.get_hour()) + " " + CL_String8(now.get_minutes()) + " " + CL_String8(now.get_seconds());
} 
```

我收到此错误（重复 3 次）：

```
src/utils.cpp: In function ‘CL_String now()’:
src/utils.cpp:15:34: error: call of overloaded ‘CL_String8(unsigned char)’ is ambiguous
src/utils.cpp:15:34: note: candidates are:
/usr/include/ClanLib-2.3/ClanLib/Core/Text/string8.h:74:2: note: CL_String8::CL_String8(const wchar_t*) <near match>
/usr/include/ClanLib-2.3/ClanLib/Core/Text/string8.h:74:2: note:   no known conversion for argument 1 from ‘unsigned char’ to ‘const wchar_t*’
/usr/include/ClanLib-2.3/ClanLib/Core/Text/string8.h:63:2: note: CL_String8::CL_String8(const char*) <near match>
/usr/include/ClanLib-2.3/ClanLib/Core/Text/string8.h:63:2: note:   no known conversion for argument 1 from ‘unsigned char’ to ‘const char*’
/usr/include/ClanLib-2.3/ClanLib/Core/Text/string8.h:55:2: note: CL_String8::CL_String8(const CL_String8&) <near match>
/usr/include/ClanLib-2.3/ClanLib/Core/Text/string8.h:55:2: note:   no known conversion for argument 1 from ‘unsigned char’ to ‘const CL_String8&’
/usr/include/ClanLib-2.3/ClanLib/Core/Text/string8.h:50:2: note: CL_String8::CL_String8(const string&) <near match>
/usr/include/ClanLib-2.3/ClanLib/Core/Text/string8.h:50:2: note:   no known conversion for argument 1 from ‘unsigned char’ to ‘const string& {aka const std::basic_string<char>&}’ 
```

如何定义我要使用的功能之一？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T18:52:41.613

根据文档，函数“get_hour()”等返回一个无符号字符，这反过来意味着没有一个函数模板与您的调用匹配。

就像这个功能是为苹果、樱桃或香蕉而设计的，而你给它的是梨。

为了解决你的问题，我建议要么使用 C-Function 'sprintf'，然后通过 CL_String8-Function 运行它......或者使用 std::string。

使用 sprintf 的解决方案：

```
#include <stdio.h>
char Buffer[50];
sprintf(Buffer, "%02d %02d %02d", now.get_hour(), now.get_minutes(), now.get_seconds());
return CL_String8(Buffer); 
```

这将以 hh:mm:ss 格式返回数据，所有小于 9 的值都为 0。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T19:06:57.790

ClanLib 有一个格式化函数，您可以使用它来避免低级 C 格式化代码：

```
CL_DateTime now = CL_DateTime::get_current_local_time();
return cl_format("%1 %2 %3", now.get_hour(), now.get_minutes(), now.get_seconds()); 
```

`cl_format`自动接受大多数基本类型。

其次，`CL_DateTime`有一个`to_long_time_string()`返回时间为*hh:mm:ss*，所以你可以使用它，除非你需要你的特定格式：

```
return now.to_long_time_string(); 
```

第三，不需要`CL_String8`直接使用。根据 unicode 编译设置`CL_String`将使用`CL_String8`或`CL_String16`内部。`CL_String8`不是您需要在代码中显式使用的东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T18:54:00.933

now.get_minutes() 等正在重新返回无符号字符，我确信 CL_String8 没有任何采用此类参数的重载版本。

在将值传递给 CL_String8 之前将它们传递给此函数

```
#include <sstream>
#include <string> // not sure if necessary

const char* unsignedChar2string(unsigned char c) {
    stringstream stream;
    stream << static_cast<char>(c); // I'm not 100% sure if the cast is necessary
                                    // I'm also not sure whether it should be static, dynamic, or reinterpret.
    return stream.str().c_str();
} 
```

# java - 带有 actionlistener 的 JButton 不执行其代码

> ID：12465319
> 
> 赞同：1
> 
> 时间：2012-09-17T18:44:30.127
> 
> 标签：java, jframe, jpanel, jbutton, actionlistener

我在空闲时间开发一个小游戏，但我遇到了一个我不太明白为什么会发生的问题。

```
public class PauseMenu extends JFrame {
       ...
/**
 * Create the frame.
 */
public PauseMenu() {
           ...
    JButton btnContinue = new JButton("Continue");

    btnContinue.addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent e) {

            GamePanel.var.setPause(false);
            dispose();
        }
    });
    contentPane.add(btnContinue);

    ...
} 
```

这是实际上不起作用的代码。它是一个带有三个按钮的 JFrame（我剪掉了另外两个）。它应该是一个暂停菜单，按下“p”键时的“弹出”菜单。效果很好，问题是

> GamePanel.var.setPause(false);

这条线应该设置一个布尔值 false，然后继续我的游戏循环。但由于某些原因，它永远不会执行，布尔值保持为真。此问题仅在我将主游戏窗口从 JPanel 更改为 JFrame 后发生，因此我可以显示其他 jframe。我链接它们是因为它们很长：

这是 JPanel 的旧代码。该按钮使用此代码。

> [https://github.com/westerwave/dogfight_remake/blob/master/main/Dogfight.java](https://github.com/westerwave/dogfight_remake/blob/master/main/Dogfight.java)

这是当前代码（JPanel）

> [https://github.com/westerwave/dogfight_remake/blob/master/main/GamePanel.java](https://github.com/westerwave/dogfight_remake/blob/master/main/GamePanel.java)

(JFrame)

```
 public static GameFrame frame;
    public GamePanel game;

    public GameFrame() {
       setUndecorated(true);
       setResizable(false);
       setTitle("Dogfight-Frame");
       setSize(dim);
       setVisible(true);
       game = new GamePanel();
       getContentPane().add(game);
       frame = this;
    } 
```

我希望我对这个问题说清楚了，希望你能帮助我。

编辑：我犯了一个错误，并依靠我的paintComponent 方法向我提供有关布尔值的信息。我现在发现布尔值已更改，因此一切都按预期工作。但是在我单击该按钮后，不知何故我的游戏循环没有恢复

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T18:52:22.867

那应该可以正常工作，我怀疑这里有些混乱。

如果你在`actionPerformed()`方法中放置一个断点（或者只是在`System.out.println()`其中放置一个语句）怎么办？是否达到/执行？

祝项目好运，看起来很有趣！

# vb.net - vb.net调试价格

> ID：12465320
> 
> 赞同：-1
> 
> 时间：2012-09-17T18:44:31.190
> 
> 标签：vb.net, debugging

我在这里遇到问题，无法弄清楚我的代码哪里出错了，所以我决定问你们。我为运费制作了一个 vb.net 程序，它会根据总价计算它。问题是，如果我输入 1000.34，它会给我零作为运费，而它应该给我 14 美元。我在这里遗漏了一些非常简单的东西，没有语法错误。

谢谢你。

```
Dim totPrice As Decimal
Dim Ship As Integer

Decimal.TryParse(txtTot.Text, totPrice)

Select Case totPrice
    Case Is <= 1.0
        Ship = 0
    Case 1 To 100
        Ship = 2
    Case 50 To 450
        Ship = 12
    Case 301 To 1000
        Ship = 14
    Case Is >= 1001
        Ship = 16
End Select

lblshi.Text = Ship.ToString("C0") 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T18:48:25.353

1000.34 不符合任何条件，因此它返回默认船舶值，即 0，因为您没有设置它。它大于 1000，这就是为什么它不将船设置为 14 但小于 1001，这就是为什么它不设置为 16。

要纠正这个问题，您可以将 301 的值提高到 1000，但您可能仍会遇到边缘情况。我认为您可能需要考虑为此切换到 If 语句，以便您可以使用大于号进行与运算。

```
If totPrice <= 1
  ' All of your other cases
Else If totPrice >301 and totPrice<1001
     'do work
Else If totPrice >= 1001

End If 
```

# mysql - 从表中高效选择每种类型

> ID：12465321
> 
> 赞同：3
> 
> 时间：2012-09-17T18:44:30.927
> 
> 标签：mysql

我有一个类似这样的表：[http ://sqlfiddle.com/#!2/8c877](http://sqlfiddle.com/#!2/8c877)

例如，假设它是由“用户”完成的“活动”表。

从表中为每个 user_id 选择一个随机行的最有效方法是什么？

例如，给定上表，我的选择将返回 5 行。`user_id` **3个**1个，**4个**1个，**8**个1个，**23**个1个，**90**个1个。

我在这个应用程序中使用 PHP，所以我在想的一件事就是查询所有活动的位列表，然后在 PHP 中循环遍历它们，并以这种方式随机拉出每个 user_id 的一行。这将导致只对 MySQL 服务器进行一次 SELECT 调用。

或者，我认为这可以在一系列子选择中完成，但我不确定如何设置语法。而且我不确定这是否会更慢......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T19:10:22.820

你不能试试这个查询：

```
select * from (
select activity, user_id from activities order by rand()
) as x group by user_id; 
```

第一个查询将随机排序记录，第二个查询将只返回每个 user_id 的顶行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T18:54:17.493

使用 mysql 很幸运，因为 mysql 允许使用一个特殊的“技巧”：

```
select user_id, activity
from activities
group by user_id; 
```

请参阅[sqlfiddle 中的此查询](http://sqlfiddle.com/#!2/8c877/1)。

在 mysql (only, afaik) 中，你不必聚合非 group-by 列，当你这样做时，mysql 返回它为每个组找到的 (first* 行。

在所有其他数据库中，我知道这个查询会导致语法错误。

现在，虽然这个查询理论上给你随机行 - SQL 标准说，当没有排序时，行可能是任何顺序 - 实际上这个查询将为每个用户返回相同的“随机”行，除非你更改行顺序通过执行一些插入/删除来磁盘。

如果您真的想要“随机 - 即每次都不同 - 每个用户的行，您需要使用此 uqery 从随机排序的行集中进行选择，如下所示：

```
select user_id, activity
from (select * from activities order by rand()) x
group by user_id; 
```

[在 sqlfiddle 中](http://sqlfiddle.com/#!2/8c877/14)查看此查询

# ruby-on-rails - 在 ApplicationController 中覆盖 current_user 会引发未定义的方法错误

> ID：12465324
> 
> 赞同：2
> 
> 时间：2012-09-17T18:44:44.293
> 
> 标签：ruby-on-rails, devise

基于用于覆盖设计的 current_user 的 stackoverflow 问题，我写了如下内容：

```
class ApplicationController < ActionController::Base
    alias_method :devise_current_user, :current_user
    def current_user
        if !devise_current_user.nil?
            return # my logic
        end
        return nil
    end
end 
```

两个问题： 1\. 它在我定义 alias_method 的地方抛出一个未定义的方法错误 .... 2\. 在 devise_for 方法中，我的覆盖 current_user 将被传递还是设计的 current_user？

# c++ - 这是一种什么样的排序，它的运行时间是多少？

> ID：12465327
> 
> 赞同：1
> 
> 时间：2012-09-17T18:44:55.383
> 
> 标签：c++, algorithm, sorting

我想知道下面的排序是什么样的排序，大 O 表示法的运行时间是多少？我的朋友在没有任何算法知识的情况下编写了这个排序函数，现在我们正在争论它的速度/内存效率如何。所以请你帮我们分析一下。

```
void sort(int* a, int size)
{
    if (size <= 1) return;
    else if (size == 2)
    {
        if (a[0] > a[1])
            swap (a[0], a[1]);
        return;
    }
    else
    {
        int i = size / 2;
        sort(a, i);
        sort(a+i, size - i);
        int j = 0, k = i ;
        while (k < size && j < k)
        {
            if (a[j] > a[k])
            {
                int temp = k;
                while (temp > j)
                {
                    swap(a[temp - 1], a[temp]);
                    temp--;
                }
                k++;
            }
            j++;
        }
    }
} 
```

谢谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T19:00:23.483

这基本上是合并排序，但有一个 ^2 就地合并步骤。如果你做标准数学，就像分析归并排序一样，你会发现它有 n^2 的运行时间。为此，您需要求解的相关方程是`f(n) = n^2 + 2f(n/2)`。

# android - Android 应用程序中的 API 密钥等敏感全局信息在哪里存储？

> ID：12465328
> 
> 赞同：10
> 
> 时间：2012-09-17T18:44:55.710
> 
> 标签：android, security, android-resources

我需要在 Android 应用程序中存储一些敏感信息。如果我将它放在资源文件中，似乎另一个应用程序只需使用[PackageManager.getResourcesForApplication()](http://developer.android.com/reference/android/content/pm/PackageManager.html#getResourcesForApplication%28java.lang.String%29)就可以浏览和读取该文件是微不足道的。

在哪里放置我们不希望人们能够轻易窥探的此类信息的正确位置？

它应该在编译的java文件中吗？还是类文件也易于阅读？此外，如果它们在 java 文件中，是否可以从需要它们的 XML 文件中引用它们（例如，对于 google maps api 密钥）？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-17T19:10:32.567

无论如何，您的 APK 将从设备中检索并撕裂。（毕竟，有些设备是有根的。）无论你在哪里硬编码，无论在哪里，都将被找到并提取。当然，如果潜在的收益证实了这种努力。否则，通过模糊来实现安全性，例如混淆，可能是要走的路。

处理真正的秘密应该基于某种输入，尤其是密码。

令人高兴的是，API 密钥，如果按预期使用，不一定是真正的秘密。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-12T10:18:09.547

[Google 在billing](http://developer.android.com/guide/google/play/billing/billing_best_practices.html)下对此有一些很好的建议。总结一下：使用远程服务器，混淆并使用安全随机数。在你的 apk 中没有什么是安全的，因为它总是可以被逆向工程，并且混淆只适用于简单的攻击。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-09-17T19:12:19.400

如果您只想拒绝其他应用程序访问您的数据，您可以使用 SharedPreferences。只需使用 Contex.getSharedPreferences(/ *prefs 文件名*/, Context.MODE_PRIVATE); 根据文档 MODE_PRIVATE 意味着创建的文件只能由调用应用程序（或共享相同用户 ID 的所有应用程序）访问。

# visual-studio - Visual Studio 12 是否有任何插件可以自动缩放图像？

> ID：12465329
> 
> 赞同：0
> 
> 时间：2012-09-17T18:44:57.930
> 
> 标签：visual-studio, windows-8, microsoft-metro, visual-studio-2012, windows-store

在 Win 8 (Metro) 应用程序中，您可以为高分辨率或低分辨率创建不同的缩放图像（[更多](http://blogs.msdn.com/b/b8/archive/2012/03/21/scaling-to-different-screens.aspx)）。我想要一个 VS 插件或内置功能来缩小图像，所以我不必自己做。我错过了 Visual Studio 中的任何内置功能，或者有人知道对此有很好的扩展吗？

基本上我只会创建 180% 的比例，扩展程序应该会自动生成 140%、100% 和 80% 的比例图像。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T20:29:56.320

如果您想将图像缩放到不同的分辨率，我建议您查看[缩放到屏幕的指南](http://msdn.microsoft.com/en-us/library/windows/apps/hh780612.aspx)
ViewBox 是使应用程序适合所有分辨率的更好解决方案。

# .net - 从关系数据库中检索“硬”值的最佳实践

> ID：12465330
> 
> 赞同：2
> 
> 时间：2012-09-17T18:45:10.427
> 
> 标签：.net, database

我想知道人们如何处理以下情况（这是假设的想法）......

*   `TABLE A (Orders): OrderId, StatusId`等（状态表上的外键）
*   `TABLE B (Statuses): StatusId, Name,`ETC

表 B 需要存在（IOW，例如，我不能只创建一个状态枚举），因为订单状态列表需要随着业务需求和实践的变化而动态变化，并且您的程序中有方法，如`GetAllOrders()`, `GetAllStatuses()`,`GetOrderByStatus(int statusId)`等。但是，您似乎一直需要访问“硬编码”状态。例如，当第一次创建订单时，它的状态是“新建”，您需要在没有任何用户干预的情况下将其设置为该状态。也许您有一个 GetUnfilledOrders 报告，它返回所有正在“处理”的订单，同样无需用户选择他们正在寻找的状态，因为报告的名称暗示了他们想要的东西。我希望你能明白。

在这些情况下，我一直在做的是创建一个设置，例如`DefaultNewOrderStatus (int)`并将其设置为我想用于新订单的状态的 id，或者`StatusesForUnfilledOrdersReport (int[])`再次设置要使用的状态列表。如果我们的状态“架构”发生变化，我可以即时更改这些设置。问题是需要使用的“硬编码”值的数量似乎在增加（也许现在我需要一个默认状态来设置已完成的订单，或者一个状态列表用于显示“打开”订单 UI 视图，等）以及随之而来的，处理它们的设置数量也是如此。

我非常想知道其他人如何处理这些情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T19:22:19.990

我不确定我是否抓住了您的问题的重点，但看起来您正在尝试以“硬编码”方式实施业务流程管理器。你真正需要的不是动态的状态列表，而是动态的进程列表，实际上是如何使用状态的场景。此外，您需要操作，这将触发状态更改。因此，例如，您有一个状态列表：

1.  新的
2.  加工
3.  送货
4.  完成的

接下来是动作列表：

1.  创建新的
2.  开始加工
3.  进入交货
4.  完成交货
5.  回来

现在，您可以设计一个流程：

*   [开始] ->（创建新）-> 新
*   新 -> （开始处理）-> 处理
*   处理 -> （进入交付） -> 交付
*   交付 ->（退回）-> 处理
*   交付->（完成交付）->完成

您的应用程序需要有一组可以对上述内容进行操作的方法（通常是表单、一些向导等）。当某些事情发生变化时，您添加新的状态，复制和修改流程并且您的应用程序已经知道如何处理它，例如您需要处理取消订单。您将取消添加到您的操作，取消添加到您的订单并创建新流程（或修改旧流程）添加：

*   处理中->（取消）->已取消

所以，总而言之，你的问题不仅仅是状态变化，而是业务流程的变化。在这种情况下，您需要拥有动态流程，而不仅仅是状态。比，问题消失了——但你需要重建你的应用程序——或者更确切地说是构建一个新的应用程序。

**编辑**

关于报道，情况完全不同。如果您找到一种方法来准备能够生成任何报告的通用架构，那么您将挑战商业智能的实际形​​式、数据仓库概念等。:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T08:55:18.873

我喜欢@WojtusJ 的回答，反正还有另一种选择：

您可以创建一个状态设置页面，您可以在其中设置具体`statusId`的状态情况，所以它看起来像这样：

```
New status:         [Select a status]
Received status:    [Select a status]
Processing status:  [Select a status]
Complete status:    [Select a status] 
```

并且您将通过一个键存储这些设置，例如`'new'`,`'received'`等。然后您可以获得新订单`statusId`的`'new'`状态并继续 -`'new'` `statusId`与 name 的状态无关`Completed`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T19:25:04.417

这就是我的处理方式。常见的场景是 int, string 以 int 为 key。将流体列表读入 ctor 中的字典。所以我定义了流体，因为他们需要重新启动应用程序才能获得一个新的列表。

```
 public static Dictionary<int, string> FluidStatus { get; private set; }  // poulate in ctor
    public class FluidBus
    {
        public Int32 ID { get; set; }  // in set need error checking the ID is in range
        public String Status { get { return FluidStatus[ID]; } }  // need to check the ID is in range
        public FluidBus() { ID = 0; } // default
        public FluidBus(Int32 id) { ID = id; }
        // alternative is to pass a reference to Dictionary in the ctor as then  
        // can change out the status without changing the class
    } 
```

实际上，我主要将它与 SysName 和 DispName 一起使用，规则 SysName 不能有空格。DispName 是用户看到的内容。但是对于类似 XML 的导出，我使用 SysName。这样管理员就可以处理用户的突发奇想并为他们保留一些半静态的名称。

如果它是程序需要使用的状态，那么每次都使用 Enum。在 SQL 方面，我将有一个 C# 不使用的 FK 表，但作为一个公共约束，当我在 SQL 中时，我可以查找名称。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-17T18:56:06.093

制作枚举。此枚举适用于您的业务逻辑。您仍然可以从数据库查询中显示可用状态列表。

当您将 StatusId 转换为 StatusEnum 值时，您需要在数据库中有一个新值的案例。但是，您的所有逻辑都应该没问题，因为 New 仍然是 New。如果您需要编写使用新创建状态的逻辑，请更新 Enum。

对于状态之类的东西，没有理由在现有行上更改 StatusId。如果删除了行，则您的 Enum 很好，该值将永远不会被使用。您可以在进行其他维护时将其移除。

# symfony - Symfony2 中 AJAX 的 URL 模板

> ID：12465331
> 
> 赞同：0
> 
> 时间：2012-09-17T18:45:15.103
> 
> 标签：symfony, twig

遵循表单原型的相同逻辑，有没有办法在 Symfony2 中创建 URL 模板？

目前，当我想创建一个用于 AJAX 的 URL 模板时，我只是使用任意数字`99999`，然后在请求 URL 之前将它们替换为实际 id。
前任：

```
twig:
<select data-source="{{ path('api_route', {id: 99999}) }}">

html:
<!-- inellegant and arbitrary -->
<select data-source="path/to/api/99999">

js:
$.get(
    $(element).data('source').replace('99999', $(element).val()),
    // ...
) 
```

有没有办法打印这样的东西？

```
<!-- perfect for mustache, underscore, coffeescript... -->
<select data-source="path/to/api/{{id}}"> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T19:47:21.097

您可以使用[FOSJsRoutingBundle](https://github.com/FriendsOfSymfony/FOSJsRoutingBundle)。您将能够在您的 javascript 中生成 url，例如：

```
Routing.generate('my_route_to_expose', { id: 10 }); 
```

# android - R.layout.main 无法解析为变量

> ID：12465332
> 
> 赞同：2
> 
> 时间：2012-09-17T18:45:16.903
> 
> 标签：android

我从 Raghav Sood 的 Pro Android Augmented Reality 书中找到了这段代码。我尝试执行书中写的代码，但我面临很多困难。我尝试清理和构建项目。将复选框打勾放在项目的属性对话框中。在我的代码中检查了 import Android.R 的存在。即使我卸载了我的 AndroidSDK 并使用不同的 Android 版本和 API 重新安装它。卸载并重新安装 Eclipse。

这是我的 ProAndroidAR3Activity.java 文件

```
 package com.paar.ch3widgetoverlay;

    import android.app.Activity;
    import android.hardware.Camera;
    import android.hardware.Sensor;
    import android.hardware.SensorEvent;
    import android.hardware.SensorEventListener;
    import android.hardware.SensorManager;
    import android.location.Location;
    import android.location.LocationListener;
    import android.location.LocationManager;
    import android.os.Bundle;
    import android.util.Log;
    import android.view.SurfaceHolder;
    import android.view.SurfaceView;
    import android.widget.TextView;

    public class ProAndroidAR3Activity extends Activity{
SurfaceView cameraPreview;
SurfaceHolder previewHolder;
Camera camera;
boolean inPreview;

final static String TAG = "PAAR";   
SensorManager sensorManager;

int orientationSensor;
float headingAngle;
float pitchAngle;
float rollAngle;

int accelerometerSensor;
float xAxis;
float yAxis;
float zAxis;

LocationManager locationManager;
double latitude;
double longitude;
double altitude;

TextView xAxisValue;
TextView yAxisValue;
TextView zAxisValue;
TextView headingValue;
TextView pitchValue;
TextView rollValue;
TextView altitudeValue;
TextView latitudeValue;
TextView longitudeValue;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main); //here is the problem. every part of the code with       R. is having problem

    locationManager = (LocationManager) getSystemService(LOCATION_SERVICE);
    locationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 2000, 2, locationListener);

    sensorManager = (SensorManager) getSystemService(SENSOR_SERVICE);
    orientationSensor = Sensor.TYPE_ORIENTATION;
    accelerometerSensor = Sensor.TYPE_ACCELEROMETER;
    sensorManager.registerListener(sensorEventListener, sensorManager.getDefaultSensor(orientationSensor), SensorManager.SENSOR_DELAY_NORMAL);
    sensorManager.registerListener(sensorEventListener, sensorManager.getDefaultSensor(accelerometerSensor), SensorManager.SENSOR_DELAY_NORMAL);

    inPreview = false;

    cameraPreview = (SurfaceView)findViewById(R.id.cameraPreview);
    previewHolder = cameraPreview.getHolder();
    previewHolder.addCallback(surfaceCallback);
    previewHolder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);

    xAxisValue = (TextView) findViewById(R.id.xAxisValue);
    yAxisValue = (TextView) findViewById(R.id.yAxisValue);
    zAxisValue = (TextView) findViewById(R.id.zAxisValue);
    headingValue = (TextView) findViewById(R.id.headingValue);
    pitchValue = (TextView) findViewById(R.id.pitchValue);
    rollValue = (TextView) findViewById(R.id.rollValue);
    altitudeValue = (TextView) findViewById(R.id.altitudeValue);
    longitudeValue = (TextView) findViewById(R.id.longitudeValue);
    latitudeValue = (TextView) findViewById(R.id.latitudeValue); 
```

这是我项目的 AndroidManifest.xml 文件：

```
 <?xml version="1.0" encoding="utf-8"?>
    <manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.paar.ch3widgetoverlay"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk android:minSdkVersion="7" />

    <application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name" >
    <activity
        android:label="@string/app_name"
        android:name=".ProAndroidAR3Activity" 
        android:screenOrientation = "landscape"
        android:theme="@android:style/Theme.NoTitleBar.Fullscreen"
        android:configChanges = "keyboardHidden|orientation">
        <intent-filter >
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    </application>
    <uses-feature android:name="android.hardware.camera" />  
    <uses-permission android:name="android.permission.CAMERA" />
    <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
    </manifest> 
```

下面是res/layout/main.xml文件

```
 <RelativeLayout 
    xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/relativeLayout1"
android:layout_width="fill_parent"
android:layout_height="fill_parent" >
<SurfaceView
    android:id="@+id/cameraPreview"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" />

<TextView
    android:id="@+id/xAxisLabel"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_alignParentTop="true"
    android:layout_marginLeft="18dp"
    android:layout_marginTop="15dp"
    android:text="@string/xAxis" />

<TextView
    android:id="@+id/yAxisLabel"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignLeft="@+id/xAxisLabel"
    android:layout_below="@+id/xAxisLabel"
    android:text="@string/yAxis" />

<TextView
    android:id="@+id/zAxisLabel"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignLeft="@+id/yAxisLabel"
    android:layout_below="@+id/yAxisLabel"
    android:text="@string/zAxis" />

<TextView
    android:id="@+id/headingLabel"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignLeft="@+id/zAxisLabel"
    android:layout_below="@+id/zAxisLabel"
    android:layout_marginTop="19dp"
    android:text="@string/heading" />

<TextView
    android:id="@+id/pitchLabel"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignLeft="@+id/headingLabel"
    android:layout_below="@+id/headingLabel"
    android:text="@string/pitch" />

<TextView
    android:id="@+id/rollLabel"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignLeft="@+id/pitchLabel"
    android:layout_below="@+id/pitchLabel"
    android:text="@string/roll" />

<TextView
    android:id="@+id/latitudeLabel"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignLeft="@+id/rollLabel"
    android:layout_below="@+id/rollLabel"
    android:layout_marginTop="34dp"
    android:text="@string/latitude" />

<TextView
    android:id="@+id/longitudeLabel"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignLeft="@+id/latitudeLabel"
    android:layout_below="@+id/latitudeLabel"
    android:text="@string/longitude" />

<TextView
    android:id="@+id/altitudeLabel"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignLeft="@+id/longitudeLabel"
    android:layout_below="@+id/longitudeLabel"
    android:text="@string/altitude" />

<TextView
    android:id="@+id/xAxisValue"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBottom="@+id/xAxisLabel"
    android:layout_marginLeft="56dp"
    android:layout_toRightOf="@+id/longitudeLabel"
    android:text="@string/empty" />

<TextView
    android:id="@+id/yAxisValue"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBaseline="@+id/yAxisLabel"
    android:layout_alignBottom="@+id/yAxisLabel"
    android:layout_alignLeft="@+id/xAxisValue"
    android:text="@string/empty" />

<TextView
    android:id="@+id/zAxisValue"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_above="@+id/headingLabel"
    android:layout_alignLeft="@+id/yAxisValue"
    android:text="@string/empty" />

<TextView
    android:id="@+id/headingValue"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBaseline="@+id/headingLabel"
    android:layout_alignBottom="@+id/headingLabel"
    android:layout_alignLeft="@+id/zAxisValue"
    android:text="@string/empty" />

<TextView
    android:id="@+id/pitchValue"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBaseline="@+id/pitchLabel"
    android:layout_alignBottom="@+id/pitchLabel"
    android:layout_alignLeft="@+id/headingValue"
    android:text="@string/empty" />

<TextView
    android:id="@+id/rollValue"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_above="@+id/latitudeLabel"
    android:layout_alignLeft="@+id/pitchValue"
    android:text="@string/empty" />

<TextView
    android:id="@+id/latitudeValue"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBottom="@+id/latitudeLabel"
    android:layout_alignLeft="@+id/rollValue"
    android:text="@string/empty" />

<TextView
    android:id="@+id/longitudeValue"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBaseline="@+id/longitudeLabel"
    android:layout_alignBottom="@+id/longitudeLabel"
    android:layout_alignLeft="@+id/latitudeValue"
    android:text="@string/empty" />

<TextView
    android:id="@+id/altitudeValue"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBaseline="@+id/altitudeLabel"
    android:layout_alignBottom="@+id/altitudeLabel"
    android:layout_alignLeft="@+id/longitudeValue"
    android:text="@string/empty" />

    </RelativeLayout>` 
```

以下是 res/values/strings.xml 文件

```
 <?xml version="1.0" encoding="utf-8"?>
    <resources>

    <string name="hello">Hello World, ProAndroidAR3Activity!</string>
    <string name="app_name">Pro Android AR 3 Widget Overlay</string>
    <string name="xAxis">X Axis:</string>
    <string name="yAxis">Y Axis:</string>
<string name="zAxis">Z Axis:</string>
<string name="heading">Heading:</string>
<string name="pitch">Pitch:</string>
<string name="roll">Roll:</string>
<string name="altitude">Altitude:</string>
<string name="longitude">Longitude:</string>
<string name="latitude">Latitude:</string>
<string name="empty"></string>
    </resources> 
```

我已将 minsdk 版本设置为 2.1，即 API 7，编译 SDK 版本为 4.1，即 API 16 ...

请帮帮我...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T18:54:12.420

您是否在 Eclipse (/gen/[yourpackage]/R.java) 的“gen”文件夹下正确生成了新的 R.java 类？如果和你的activity在同一个包里，就不用手动导入了！

如果 XML 正确，它应该在那里！如果 XML 中存在语法错误，则 Eclipse 将不会生成 R.java。

Besieds，你的布局文件末尾有一个奇怪的'`'字符，我不知道你的帖子是否是偶然的，但这可能是一个问题：

```
</RelativeLayout>` 
```

我希望它有帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T00:06:02.643

（在 user1649030 的帖子上展开，因为这太大而不能发表评论：）

好的，“R not found”错误通常有两个原因。一个是任何 xml 文件中的错误，导致 R.java 根本无法构建。在您的“gen”目录下查找 R.java。如果没有找到，那就是你的问题。查找错误的 xml 文件。

*如果正在*构建R.java ，请注意它的目录路径。这将匹配清单中指定的包名称。在您的情况下，它将是 gen/com/paar/ch3widgetoverlay/R.java。

此类由 src/com/paar/ch3widgetoverlay/ 中的所有源文件隐式导入

需要访问 R 的任何其他目录中的任何源文件都需要显式导入 com.paar.ch3widgetoverlay.R

那应该几乎涵盖了它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T18:48:46.863

您需要从 java 导入*您的*R 类，而不是 Android 的。如果你导入 android.R 会导致冲突。R 类已生成，可能与 ch3widgetoverlay 在同一个包中，也可能不在同一个包中，特别是如果您从教程中获得代码。在 eclipse 的 gen 文件夹中查看 R 类所在的包。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-17T18:50:18.243

尝试导入 com.paar.ch3widgetoverlay.R

# android - Android：跟踪 GPS 位置

> ID：12465334
> 
> 赞同：0
> 
> 时间：2012-09-17T18:45:26.477
> 
> 标签：android, location

我想知道一些事情：

1.  有没有办法跟踪没有 wifi 的安卓设备的 GPS 位置？
2.  如果是这样，我怎么能在我的 android 地图应用程序上追踪路径（即一条红线直观地代表我要去的地方）

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T19:02:48.093

如果是电话，您可以编写一个应用程序，使用基站信号对您的位置进行三角测量，但准确性会有所不同。

您还可以购买一个外部 GPS USB 设备 - 例如：Garmin GPS18x，然后编写一个应用程序通过串行端口对其进行轮询。这并不难。

如果您需要上传到服务器，则需要连接，因此除了 wifi 之外，蜂窝计划是您的下一个最佳选择。如果您不需要实时上传，您可以存储照片和 GPS 数据以方便您上传。

要跟踪路线，请遍历您的点并在连续点之间创建折线，例如：0-1,1-2,2-3 等。[请参阅相关问题](https://stackoverflow.com/questions/2176397/drawing-a-line-path-on-google-maps)。

# php - 如何处理多个视图和控制器通用的表单？

> ID：12465346
> 
> 赞同：1
> 
> 时间：2012-09-17T18:45:54.183
> 
> 标签：php, codeigniter, codeigniter-2

我有一个网站，其中大多数页面都显示了一个通用表单。表单代码位于单独的文件中，并在每个视图中加载，如下所示：

```
<?php $this->load->view('includes/quote'); ?> 
```

我这样做是为了不必在每个控制器和视图中复制代码。表单数据将用于创建电子邮件。表单显示正确，但我不知道如何处理输入数据。由于涉及多个控制器，我是否需要创建一个单独的控制器来处理数据？处理这种情况的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T08:20:36.503

Raheel 所说的（具有处理表单提交功能的通用控制器），或者创建一个库，当您需要进行处理时，您可以调用该库方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T08:26:28.217

我会从每个控制器传递一个变量来识别当前正在使用的控制器。您可以使用它来更改表单的`action`属性，使其指向正确的控制器。

此外，您还可以使用该变量在表单中创建一个隐藏字段，因此，通过检查您的该变量，您`$_POST`将能够知道提交了哪个表单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T07:23:32.520

使用我的控制器，它将扩展 ci_controller。之后，每个控制器都会扩展 my_controller。在 my_controller 创建在所有其他控制器之间共享的方法。这样你就不必写它们了。它们将可用。同样，在每个控制器上，您都可以通过编写 ectra 代码提交表单，只需处理我的意思是您来自哪个控制器的 url。为此，请使用 current_url() 方法。这会有所帮助。

# c# - 使用 WindowsFormsHost WPF 在 StoryBoard 之后强制重绘

> ID：12465357
> 
> 赞同：1
> 
> 时间：2012-09-17T18:47:31.687
> 
> 标签：c#, wpf, windowsformshost

我正在寻找一种方法来强制 WindowsFormsHost 控件在动画完成移动后重新绘制自身，但我没有找到解决方案。

我按照[http://bitsbobsetc.wordpress.com/2011/07/10/creating-a-sliding-panel-in-wpf/在我的 WPF 应用程序中有一个滑动面板的示例](http://bitsbobsetc.wordpress.com/2011/07/10/creating-a-sliding-panel-in-wpf/)

在示例中，他仅使用基本的 wpf 控件。在我的滑动面板中，它的主要部分是 WindowsFormsHost。我遇到的问题是动画按原样发生，但 WindowsFormsHost 直到用户与其他东西交互后才会被绘制。就像刷新主窗口使其可见。

当滑动面板被隐藏时也会发生同样的事情。WindowsFormsHost 仍然显示并且可以交互，直到用户与其他东西交互。

从[Animating WindowsFormsHost](https://stackoverflow.com/questions/11542283/animating-windowsformshost)看来这是一个已知问题，但我并不太关心动画，只是显示和隐藏面板。

下面是一些有助于描述当前行为的图像。

![侧面板关闭](../Images/672868626abf9dee62739aefe87621ef.png) ![SidePanelOpenNotDrawn](../Images/b40c88e167f4d01b1ed96f8ed80c16e4.png) ![侧面板打开并绘制](../Images/ceecf6229bcc799a741830bab677e0e3.png) ![侧面板关闭但仍然绘制](../Images/6ea9266f4969a59422a026c9ca924a53.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-05T14:13:44.953

通过研究这个问题，我发现课程中有一些活动可用 `Storyboard`。事件之一是`Completed`事件。

通过将其他帖子中的信息联系起来，`.InvalidateVisual()`这会强制重绘`WindowsFormsHost`. 这适用于动画的滑出部分。对于向后滑动，我只是简单地隐藏了它，`WindowsFormsHost`因为它开始关闭动画。这样，当面板关闭时，它就不会在用户空间中徘徊。

xml:

```
<Storyboard x:Key="expandStoryBoard" 
    TargetProperty="RenderTransform.(TranslateTransform.X)"
    AccelerationRatio=".4"
    DecelerationRatio=".4" Completed="Storyboard_Completed">
        <DoubleAnimation Storyboard.TargetName="SidePanel" Duration="0:0:0.6"
    From="0" To="250">
</Storyboard> 
```

后面的代码：

```
private void Storyboard_Completed(object sender, EventArgs e)
{
    this.InvalidateVisual();
}

private void OpenPanel()
{
    SidePanel.BeginStoryboard((Storyboard)this.Resources["expandStoryBoard"]);
    expanded = !expanded;
} 
```

# putty - 使用 Putty 的 modbus 消息传递

> ID：12465358
> 
> 赞同：1
> 
> 时间：2012-09-17T18:47:41.197
> 
> 标签：putty, modbus, hyperterminal

我有一个 Modbus 计量设备。如何使用 putty 或超级终端发送 modbus 消息？我只想获取那些计量数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T17:03:28.677

@avra 是正确的：如果您想使用终端尝试轮询 Modbus 寄存器，则要确保您的设备可以支持 Modbus ASCII。然而，即使使用 Modbus ASCII 协议也需要一些 Modbus 经验，即使您知道要轮询的单元 ID 和寄存器，您也需要计算消息的 CRC。

您能否就您希望完成的任务添加更多细节？

此外，这里有一些关于 Modbus RTU 与 ASCII 的简单阅读：[http ://www.simplymodbus.ca/ASCII.htm](http://www.simplymodbus.ca/ASCII.htm)

祝你好运！

# visual-studio-2012 - 如何更改 Visual Studio 2012、2013 或 2015 许可证密钥？

> ID：12465361
> 
> 赞同：62
> 
> 时间：2012-09-17T18:47:43.047
> 
> 标签：visual-studio-2012, visual-studio-2013, visual-studio-2015

我的机器上有一个 Visual Studio 2012 Pro 的副本，带有一个我不再想使用的串行密钥，因为我必须使用另一个。我的问题是我一直在卸载 Visual Studio，但重新安装后注册信息仍然存在，我无法确定我必须删除哪个注册表路径（我删除了一些），但没有运气。

有没有一种简单的方法可以删除 tha reg 信息或交换我的密钥？

谢谢

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2013-02-11T10:51:27.647

我遇到了同样的问题，想将产品密钥更改为另一个。不幸的是，它不像在 VS2010 上那么容易。

以下步骤有效：

*   删除包含许可证信息的注册表项：HKEY_CLASSES_ROOT\Licenses\77550D6B-6352-4E77-9DA3-537419DF564B

*   如果找不到密钥，请使用 sysinternals [ProcessMonitor](https://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)检查 VS2012 的注册表访问，以找到始终在 HKEY_CLASSES_ROOT\Licenses 中的正确密钥

*   删除此密钥后，VS2012 会告诉您它的许可证信息不正确。转到“程序和功能”并修复VS2012。

*   修复后，VS2012 恢复为 30 天试用，您可以输入新的产品密钥。这也可以用于留在试用版循环中，并且从不输入生产密钥。

* * *

## 回答 #2

> 赞同：55
> 
> 时间：2015-09-09T14:28:22.543

对于需要从 Visual Studio 2015 中删除产品密钥的用户：

1.  删除注册表项`HKCR\Licenses\4D8CFBCB-2F6A-4AD2-BABF-10E28F6F2C8F`
2.  修复 Visual Studio 安装

就是这样，现在您可以根据需要更改产品密钥。

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2014-03-07T18:38:54.617

对我来说，使用 Visual Studio 2013，删除许可证密钥并执行修复是不够的（修复恢复了许可证密钥而不是恢复到试用版，并且在没有修复的情况下运行它（删除密钥后）声称许可证已过期，但不允许我输入新密钥）。

我不得不：

*   使用 Process Monitor 发现 Visual Studio 在注册表中寻找的许可证密钥（它是`HKCR\Licenses\E79B3F9C-6543-4897-BBA5-5BFB0A02BB5C`）
*   完全卸载 Visual Studio 2013（先保存 CurrentSettings.vssettings）
*   在 regedit 中手动从注册表中删除许可证密钥
*   使用公开可用的 Web 安装程序安装 Visual Studio（它没有任何内置的许可证密钥——它安装了 30 天试用版）
*   输入我的新许可证密钥
*   （重新）安装更新（此时更新 1）
*   通过导入我对 CurrentSettings.vssettings 所做的备份来恢复设置

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2017-06-20T09:34:32.217

对于使用 Visual Studio 2017 Professional 的用户，注册表项为：

> HKCR\许可证\5C505A59-E312-4B89-9508-E162F8150517

我还建议您先导出注册表项，然后再删除它，这样如果您不小心删除了错误的键，您将有一个备份。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2015-12-13T05:54:17.260

要查看这些 HKCR\License 中的内容，请使用 [API Monitor v2](http://www.rohitab.com/apimonitor#Download)

```
API-Filter find 

    RegQueryValueExW 
        ^-Enable all from Advapi32.dll

    CryptUnprotectData
        ^- Enable all from Crypt32.dll
         + Breakpoint / after Call 
```

来自[CryptUnprotectData](https://msdn.microsoft.com/en-us/library/aa380882(v=vs.85).aspx)的示例数据：

```
HKEY_CLASSES_ROOT\Licenses\4D8CFBCB-2F6A-4AD2-BABF-10E28F6F2C8F\07078  [length 0x1C6 (0454.) ]
    00322-20000-00000-AA450                 <- PID2
    7d3cbcbb-90b1-411f-9981-6e28039a9b82    <- Ver
    7C3WXN74-VRMXH-J8X3H-M8F7W-CPQB8        <- PID3

HKEY_CLASSES_ROOT\Licenses\4D8CFBCB-2F6A-4AD2-BABF-10E28F6F2C8F\0bcad  [length 0xbcad (0534.) ]

    0000  00000025 ffffffff 7fffffff   07064\. 00000007   07078\. 00000007 ffffffff
    0020  7fffffff ffffffff 7fffffff ffffffff 7fffffff ffffffff 7fffffff ffffffff
    0040  7fffffff ffffffff 7fffffff ffffffff 7fffffff ffffffff 7fffffff ffffffff
    0060  7fffffff ffffffff 7fffffff ffffffff 7fffffff ffffffff 7fffffff ffffffff
    0080  7fffffff ffffffff 7fffffff ffffffff 7fffffff ffffffff 7fffffff ffffffff
    00a0  7fffffff ffffffff 7fffffff ffffffff 7fffffff ffffffff 7fffffff ffffffff
    00c0  7fffffff ffffffff 7fffffff ffffffff 7fffffff ffffffff 7fffffff ffffffff
    00e0  7fffffff ffffffff 7fffffff ffffffff 7fffffff ffffffff 7fffffff ffffffff
    0100  7fffffff ffffffff 7fffffff ffffffff 7fffffff ffffffff 7fffffff ffffffff
    0120  7fffffff ffffffff 7fffffff 10.2015\. c2a6 11.
    0134                             ^installation date^ 
```

此处有用的可能是安装时间戳（此处为 11.10.2015） *更改这将需要调用“CryptProtectData”。这样做需要一些努力，例如编写一个小程序或在这个地方停止 ollydebug 并手动“制作”一个 CryptProtectData 调用......*

注意：在此示例中，我使用的是**Microsoft® Visual Studio 2015**

-> 为了快速**潜入过期的**VS，我建议阅读[这篇](https://stackoverflow.com/questions/26512908/visual-studio-2015-ctp-trial-expired/34243422#34243422)文章。然而，这只是偶尔使用的好处，直到您再次正确完成所有注册和登录废话；）

好吧，真正的肉在这里：
%LOCALAPPDATA%\Microsoft\VisualStudio\14.0\Licenses\ ^- 这个路径来自 HKCU\Software\Microsoft\VisualStudio\14.0\Licenses\715f10eb-9e99-11d2-bfc2-00c04f990235\1

1_3jdh3uyw**.crtok**

- 经过一些[Base64](http://www.arndt-bruenner.de/mathe/scripts/base64.htm)解码后：

```
<ClientRightsContainer 
    xmlns="http://schemas.datacontract.org/2004/07/Microsoft.VisualStudio.Services.Licensing" 
    xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
    <CertificateBytes>
        00000000   30 82 06 41 30 82 04 29  A0 03 02 01 02 02 13 5A   0‚ A0‚ )       Z
        00000010   00 00 BC CB 23 AC 52 9C  E8 93 F9 0A 00 01 00 00     ¼Ë#¬Rœè“ù     
        00000020   BC CB 30 0D 06 09 2A 86  48 86 F7 0D 01 01 0B 05   ¼Ë0   *†H†÷     
        00000030   00 30 81 8B 31 0B 30 09  06 03 55 04 06 13 02 55    0 ‹1 0   U    U
        00000040   53 31 13 30 11 06 03 55  04 08 13 0A 57 61 73 68   S1 0   U    Wash
        00000050   69 6E 67 74 6F 6E 31 10  30 0E 06 03 55 04 07 13   ington1 0   U   
        00000060   07 52 65 64 6D 6F 6E 64  31 1E 30 1C 06 03 55 04    Redmond1 0   U 
        00000070   0A 13 15 4D 69 63 72 6F  73 6F 66 74 20 43 6F 72      Microsoft Cor
        00000080   70 6F 72 61 74 69 6F 6E  31 15 30 13 06 03 55 04   poration1 0   U 
        00000090   0B 13 0C 4D 69 63 72 6F  73 6F 66 74 20 49 54 31      Microsoft IT1
        000000A0   1E 30 1C 06 03 55 04 03  13 15 4D 69 63 72 6F 73    0   U    Micros
        000000B0   6F 66 74 20 49 54 20 53  53 4C 20 53 48 41 32 30   oft IT SSL SHA20
        000000C0   1E 17 0D 31 35 30 33 30  35 32 31 32 39 35 36 5A      150305212956Z
        000000D0   17 0D 31 37 30 33 30 34  32 31 32 39 35 36 5A 30     170304212956Z0
        000000E0   25 31 23 30 21 06 03 55  04 03 13 1A 61 70 70 2E   %1#0!  U    app.
        000000F0   76 73 73 70 73 2E 76 69  73 75 61 6C 73 74 75 64   vssps.visualstud
        00000100   69 6F 2E 63 6F 6D 30 82  01 22 30 0D 06 09 2A 86   io.com0‚ "0   *†
        ...
        000002B0   6E 86 36 68 74 74 70 3A  2F 2F 6D 73 63 72 6C 2E   n†6http://mscrl.
        000002C0   6D 69 63 72 6F 73 6F 66  74 2E 63 6F 6D 2F 70 6B   microsoft.com/pk
        000002D0   69 2F 6D 73 63 6F 72 70  2F 63 72 6C 2F 6D 73 69   i/mscorp/crl/msi
        000002E0   74 77 77 77 32 2E 63 72  6C 86 34 68 74 74 70 3A   twww2.crl†4http:
        000002F0   2F 2F 63 72 6C 2E 6D 69  63 72 6F 73 6F 66 74 2E   //crl.microsoft.
        00000300   63 6F 6D 2F 70 6B 69 2F  6D 73 63 6F 72 70 2F 63   com/pki/mscorp/c
        00000310   72 6C 2F 6D 73 69 74 77  77 77 32 2E 63 72 6C 30   rl/msitwww2.crl0
        00000320   70 06 08 2B 06 01 05 05  07 01 01 04 64 30 62 30   p  +        d0b0
        00000330   3C 06 08 2B 06 01 05 05  07 30 02 86 30 68 74 74   <  +     0 †0htt
        00000340   70 3A 2F 2F 77 77 77 2E  6D 69 63 72 6F 73 6F 66   p://www.microsof
        00000350   74 2E 63 6F 6D 2F 70 6B  69 2F 6D 73 63 6F 72 70   t.com/pki/mscorp
        00000360   2F 6D 73 69 74 77 77 77  32 2E 63 72 74 30 22 06   /msitwww2.crt0" 
        00000370   08 2B 06 01 05 05 07 30  01 86 16 68 74 74 70 3A    +     0 † http:
        00000380   2F 2F 6F 63 73 70 2E 6D  73 6F 63 73 70 2E 63 6F   //ocsp.msocsp.co
        00000390   6D 30 4E 06 03 55 1D 20  04 47 30 45 30 43 06 09   m0N  U   G0E0C  
        000003A0   2B 06 01 04 01 82 37 2A  01 30 36 30 34 06 08 2B   +    ‚7* 0604  +
        000003B0   06 01 05 05 07 02 01 16  28 68 74 74 70 3A 2F 2F           (http://
        000003C0   77 77 77 2E 6D 69 63 72  6F 73 6F 66 74 2E 63 6F   www.microsoft.co
        000003D0   6D 2F 70 6B 69 2F 6D 73  63 6F 72 70 2F 63 70 73   m/pki/mscorp/cps
        000003E0   00 30 27 06 09 2B 06 01  04 01 82 37 15 0A 04 1A    0'  +    ‚7    
        000003F0   30 18 30 0A 06 08 2B 06  01 05 05 07 03 01 30 0A   0 0   +       0 
        00000400   06 08 2B 06 01 05 05 07  03 02 30 25 06 03 55 1D     +       0%  U 
        00000410   11 04 1E 30 1C 82 1A 61  70 70 2E 76 73 73 70 73      0 ‚ app.vssps
        00000420   2E 76 69 73 75 61 6C 73  74 75 64 69 6F 2E 63 6F   .visualstudio.co
        00000430   6D 30 0D 06 09 2A 86 48  86 F7 0D 01 01 0B 05 00   m0   *†H†÷      
        ...                                                U
    </CertificateBytes>
    <Token>
    {
        "typ":"JWT",
        "alg":"RS256",
        "x5t":"i7qX-NUrehXBYdQC5PSH-TdvzXA"
    }
    </Token>
</ClientRightsContainer> 
```

似乎 M$ ​​正在使用 JSON Web 令牌 ( [JWT](http://jwt.io) ) 来包装许可证数据。我猜**CertificateBytes**内部会以某种方式成为有效负载 - 您是电子邮件和其他详细信息。

到目前为止，大致了解一下里面的数据是什么。

如需更多愿望，请获取[ILSpy](http://ilspy.net) + [Reflexil](http://reflexil.net)（<- 更改/纠正小事！），然后获取“浏览器和更正”文件，如 c:\Program Files (x86)\Microsoft Visual Studio 14.0\Common7\IDE**Microsoft.VisualStudio.Licensing。 dll** 或查看“Microsoft.VisualStudio.Services.WebApi.dll”

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-03-01T13:40:04.563

在阅读以下答案之前，请在最后查看我的更新。

我有 Windows 8 和另一台装有 Windows 8.1 的电脑

我有许可证错误说“预发布软件。许可证已过期”。

我发现受上述解决方案启发的唯一解决方案（谢谢！）是运行进程监视器并查看启动 VS2013 时访问的确切注册表项，它们是：

HKCR\许可证\E79B3F9C-6543-4897-BBA5-5BFB0A02BB5C

就像以前的帖子中提到的那样。然而，进程监视器说这个注册表被拒绝访问。

所以我打开了regedit，找到了那个注册表项，我无法打开它。它说我无权查看它。

所以我不得不改变它的许可：

1.  右键单击“HKCR\Licenses\E79B3F9C-6543-4897-BBA5-5BFB0A02BB5C”键
2.  权限
3.  添加
4.  在“输入要选择的对象名称”中，我添加了我的 Windows 用户名。好的。
5.  检查完全控制
6.  先进的
7.  业主点击“更改”
8.  在“输入要选择的对象名称”中，我添加了我的 Windows 用户名。好的。
9.  好的。好的。好的。

我发现这个注册表项有几个子项，但是您必须重新启动 regedit 才能看到它们。

通过查看进程监视器中哪些其他注册表项被拒绝访问，我知道 VS2013 将专门处理这些也被拒绝访问的子项：06181 0bcad

并且这些子项应该像上面一样更改它们的权限。

进行这些权限更改后，一切正常。

Microsoft Visual Studio 2010 也发生了同样的事情，因为许可证中也存在错误，并且解决方案运行良好。

更新：事实证明，以管理员身份启动 Visual Studio 解决了这个问题而没有这个注册表按摩。更改用户设置中删除的“登录所需密码”后，这似乎发生在我的电脑上。（我想让电脑在从崩溃或其他任何情况下重新启动后无需任何密码即可开始运行）。这使得很多程序无法写入临时文件夹等文件夹，除非我以管理员身份启动应用程序。如果 excel 没有以管理员身份启动，即使从 excel 打印也不起作用。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-10-20T06:22:27.333

ISO可能是预先确定的。您需要从设置文件中删除密钥。然后它应该在安装过程中要求您提供密钥。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-01-31T06:56:07.297

从注册表中删除许可证信息的解决方案也适用于 Visual Studio 2013，但如上面的答案所述，在 Visual Studio 上执行“修复”很重要。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-09-27T12:20:46.677

对于使用 Visual Studio 2019 Professional 的用户，注册表项为：

```
HKCR\Licenses\41717607-F34E-432C-A138-A3CFD7E25CDA 
```

之后在 Visual Studio 上执行“修复”。

# ios - 按顺序添加注释 - 但地图视图不会以相同的顺序返回注释

> ID：12465363
> 
> 赞同：0
> 
> 时间：2012-09-17T18:47:48.443
> 
> 标签：ios, mkmapview, mkannotation

我添加注释如下：

```
 [mapView addAnnotations:annotationArray]; 
```

然后我想访问 mapView 上的每个注释，如下所示：

```
for (id<MKAnnotation> ann in mapView.annotations) 
```

问题是地图视图上的注释没有以链表的方式添加。这就是为什么它没有按照我向 annotationsArray 添加注释的顺序返回。

为了显示：，

```
 [annotationArray addObject: annotation1]; 

 [annotationArray addObject: annotation2];

 [annotationArray addObject: annotation3];

 [mapView addAnnotations:annotationArray];  

 for (id<MKAnnotation> ann in mapView.annotations)
 {

  //not returning in same order as added above//

  } 
```

mapView 注释中是否存在错误？

原始代码：

```
 NSMutableArray *attrArray=[[NSMutableArray alloc]init];
for (NSArray *row in latt)
{
    NSNumber *attr=[row valueForKey:@"attr"];
    NSNumber *attr2=[attr valueForKey:@"ozone_level"];
    NSLog(@"values:%@",attr2);
    NSNumber *comp=[NSNumber numberWithInt:-1];
    if(attr2!=comp)
    {
        if([attrArray count]==0)
        {attrArray=[[NSMutableArray alloc]initWithObjects:attr2, nil];
        }
        else
        {
            [attrArray addObject:attr2];
        }
        NSNumber *latt2=[row valueForKey:@"lat"];
        NSNumber *longt2=[row valueForKey:@"lng"];
        CLLocationCoordinate2D coordinate;
        coordinate.latitude=latt2.doubleValue;
        coordinate.longitude=longt2.doubleValue;
        if(test<5)
        {
        Annotation *annotation = [[Annotation alloc] init];
        annotation.coordinate = coordinate;
        annotation.title = [attr2 stringValue];
        int colorvalue=[attr2 intValue];
        pinColor = [self colorForAcceleration2:colorvalue];
        annotation.color = pinColor;

            if([annotationArray count]==0)
            {
                annotationArray=[[NSMutableArray alloc]initWithObjects:annotation,nil];
               // NSMutableArray *ad =[[NSMutableArray alloc]init];
            }
            else 
            {
                [annotationArray addObject:annotation];

            }

        }

        test++;

    }//if attr2
}//for
if( test == 5)
{
  [mapView addAnnotations:annotationArray];  
}
if(test>=5)
{
    //for (id<MKAnnotation> ann in mapView.annotations)
    for(int i=0;i<5;i++)  
    {   //Annotation *a = (Annotation *)ann;
         Annotation *a = ((Annotation*)[annotationArray objectAtIndex:i]);

        //((Annotation *)mapView.annotations).
        NSLog(@"%@",((Annotation*)[annotationArray objectAtIndex:i]).title);
        NSLog(@"%@",[attrArray objectAtIndex:i]);
        //NSLog(@"annotation array size:%d",[annotationArray count]);
       // NSLog(@"attr array size:%d",[attrArray count]);
        if([((Annotation*)[annotationArray objectAtIndex:i]).title isEqualToString:[[attrArray objectAtIndex:i] stringValue]])
        {
        }
        else{
            MKAnnotationView *av1=[mapView viewForAnnotation:((Annotation*)[annotationArray objectAtIndex:i])];
                a.title=[NSString stringWithFormat:[[attrArray objectAtIndex:i] stringValue]];
                int colorvalue=[[attrArray objectAtIndex:i] intValue];
                pinColor = [self colorForAcceleration2:colorvalue];
                a.color=pinColor;
                av1.image=[ZSPinAnnotation pinAnnotationWithColor:a.color];
                av1.annotation=a;}//else

        }//for
    }//if 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T19:22:26.137

> mapView 注释中是否存在错误？

除非您能找到一些说明地图视图将保留您添加注释的顺序的文档。MKMapView 很可能将它们存储在一些内部结构中，该结构可以有效地选择那些实际出现在地图上的注释。

不要使用地图视图作为存储注释的机制。以您喜欢的任何顺序自行存储它们，这样您就不必依赖 MKMapView 中不存在的行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-03T10:06:58.827

MKMapView 将注解添加到其内部列表中，然后通过自己的逻辑显示这些注解视图。您可以通过 MKMapView 的属性“注释”检索注释列表。但是，没有直接的方法可以更改注释视图的 z 顺序。

# php - 排除文件扩展名

> ID：12465364
> 
> 赞同：1
> 
> 时间：2012-09-17T18:47:54.683
> 
> 标签：php

我最近将我的网站移到了一个新主机上，现在我必须在导航所有 php 文件时包含 .php 文件扩展名。与我以前的主人一起，我能够以任何一种方式找到他们。

```
http://example.com/myphpfile.php 
```

或者

```
http://example.com/myphpfile 
```

谁能告诉我如何解决这个问题，这样我就不需要 .php 扩展名来导航到该页面？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T18:53:00.483

如果您有权访问 .htaccess

在要启用此功能的目录和该文件类型中创建一个 .htaccess 文件

```
SetHandler php-script 
```

这应该强制所有页面作为 apache 的 PHP 处理

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T19:23:16.893

解决了我猜。在 .htaccess 中有这个似乎有效。

```
RewriteCond %{REQUEST_FILENAME}.php -f 
```

# excel - 使用 VBA 复制多个范围

> ID：12465368
> 
> 赞同：2
> 
> 时间：2012-09-17T18:48:06.243
> 
> 标签：excel, copy, vba

我正在尝试使用 Excel VBA 复制多个范围。我知道为了选择多个范围，使用类似于以下的语法：

```
Range("A1:B4000, F1:F4000").Select 
```

*这在选择*适当的范围时效果很好。但是，以下内容：

```
Range("A1:B4000, F1:F4000").Copy 
```

...仅复制 A1:B4000 范围。这是我面临的第一个问题。

其次，我想将数据动态复制到最底行，不一定是#4000行。如果选择单个范围，语法如下：

```
Range("A1", Range("B1").End(xlDown)).Copy 
```

上面的代码成功地将 A1 中的所有内容复制到 B 列的底部。我在网上找不到任何解释如何为多项选择执行此操作的材料。

我实际上想做的是复制 A1:B(bottom) 和 F1:F(bottom)，但上述两个问题阻止了我。我认为这是一个语法问题..？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T18:58:33.033

使用“联合”方法。

```
Dim range1 as Range, range2 as Range, multipleRangeAs Range    
Set range1 = Sheets("Sheet1").Range("A1:B4000")    
Set range2 = Sheets("Sheet1").Range("F1:F4000")    
Set multipleRange= Union(range1, range2) 
```

然后你可以像往常一样乱用 mutipleRange 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T11:11:00.557

@Scott Holtzman 在评论中提供了解决方案：

> 我只想调整以下内容，因为 OP 要求提供动态范围名称，因此 Set range1 = Range("A1:B" & Range("B" & Rows.Count).End(xlUp).Row) 以获得真正的最后B列中的单元格。对F列也执行相同的操作

# c# - EF 代码优先 - 获取 DynamicProxies 而不是对象。为什么？

> ID：12465369
> 
> 赞同：4
> 
> 时间：2012-09-17T18:48:08.033
> 
> 标签：c#, linq, entity-framework, ef-code-first

我有以下查询：

```
using (var forumsDb = new ForumsDb())
{
   forumsDb.Configuration.LazyLoadingEnabled = false;
   var categoryList = forumsDb.Categories.Select(c => c).ToList();
   /***some code here***/
} 
```

现在，`categoryList`包含 4 个项目（我在数据库中有 4 个类别），但它们都是 type `dynamicproxies`，而不是（如我所料）`Category`。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T18:52:52.683

你没有做错什么。EF 将您的实体包装在版本跟踪代理中，以便它可以检测对您的对象的更改并支持延迟加载。

`DbContext.Configuration.ProxyCreationEnabled`如果要删除代理，可以从上下文中分离对象，或者可以通过指定false完全关闭版本跟踪

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T18:52:27.580

动态代理是围绕您的对象自动创建的包装器，用于处理更改跟踪，以确保在您运行 SaveChanges 时保存正确的对象。

从您的对象继承（在您的情况下`Category`）并且可以用作相应的对象。

# wpf - DataGrid RowHeader 以编程方式设置 - 文本为空白但内容已设置

> ID：12465370
> 
> 赞同：2
> 
> 时间：2012-09-17T18:48:07.850
> 
> 标签：wpf, datagrid, datagridrowheader

我正在以编程方式创建一个 DataGrid，它工作正常，但 RowHeaders 没有正确显示。文本显然在那里，因为工具提示显示了正确的内容，但它在标题中显示为空白。显然我无法发布屏幕截图 - 它显示了一个大约 10 行的网格，标题为 150 宽，但其中没有任何内容，然后是几列数据。

下面是创建 DataGrid 的代码：

```
 seisTraceHeaderGrid = new DataGrid
        {
            AutoGenerateColumns = false,
            HorizontalAlignment = HorizontalAlignment.Stretch,
            VerticalAlignment = VerticalAlignment.Stretch,
            HorizontalScrollBarVisibility = ScrollBarVisibility.Visible,
            VerticalScrollBarVisibility = ScrollBarVisibility.Visible,
            HorizontalContentAlignment = HorizontalAlignment.Stretch,
            HeadersVisibility = DataGridHeadersVisibility.All,
            IsReadOnly = true,
            CanUserAddRows = false,
            CanUserDeleteRows = false,
            CanUserReorderColumns = false,
            CanUserResizeColumns = true,
            CanUserResizeRows = true,
            CanUserSortColumns = false,
            SelectionMode = DataGridSelectionMode.Single,
            SelectionUnit = DataGridSelectionUnit.Cell,
            RowHeight = 25,
            ColumnWidth = 75,
        };

        seisTraceHeaderGrid.AlternatingRowBackground = (Brush)Resources["AlternateRowBackgroundBrush"];
        seisTraceHeaderGrid.ColumnHeaderStyle = (Style)Resources["ColumnHeaderStyle"];
        seisTraceHeaderGrid.LoadingRow += dg_LoadingRow;

        // set up the row headers
        DataTemplate rowHeaderTemplate = new DataTemplate();
        rowHeaderTemplate.DataType = typeof(RowHeaderNode);
        FrameworkElementFactory textHolder = new FrameworkElementFactory(typeof(Label));
        textHolder.SetBinding(ContentProperty, 
            new Binding("RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type DataGridRow}}, Path=Header"));
        rowHeaderTemplate.VisualTree = textHolder;
        seisTraceHeaderGrid.RowHeaderTemplate = rowHeaderTemplate;

        // add a column for each trace
        for (int traceId = 0; traceId < ViewModel.Nodes[0].Count; traceId++) {
            seisTraceHeaderGrid.Columns.Add(
                new DataGridTextColumn
                    {
                        Header = string.Format(" {0}", traceId + 1),
                        Binding = new Binding(string.Format("[{0}]", traceId))
                    }
                );
        }
        // add some dummy columns to make it prettier
        for (int traceId = ViewModel.Nodes[0].Count; traceId < 5; traceId++) {

            seisTraceHeaderGrid.Columns.Add(
                new DataGridTextColumn
                    {
                        Header = string.Format(" {0}", ""),
                        Binding = new Binding(string.Format("[{0}]", ""))
                    }
                );
        }

        seisTraceHeaderGrid.RowHeaderWidth = 150;
        seisTraceHeaderGrid.ItemsSource = ViewModel.Nodes;

        baseGrid.Children.Add(seisTraceHeaderGrid); 
```

以及将文本放入 RowHeader 标签的方法：

```
 private void dg_LoadingRow(object sender, DataGridRowEventArgs e)
    {
        e.Row.Header = string.Format("[{0:000}]", ViewModel.RowHeaders[e.Row.GetIndex()].Offset) + " : " + ViewModel.RowHeaders[e.Row.GetIndex()].Name;
    } 
```

我没有做什么？蒂亚！

珍妮

# xaml - 如何在 SwapChainBackgroundPanel 中约束/布局 D3D 渲染？

> ID：12465371
> 
> 赞同：0
> 
> 时间：2012-09-17T18:48:09.880
> 
> 标签：xaml, layout, windows-runtime, directx-11

从 C++/CX XAML 应用程序中，我如何以及何时从 XAML 布局引擎获取信息以了解特定控件或网格位置的最终位置，以便我可以将我的渲染定位到 SwapChainBackgroundPanel 以专门针对该区域？

在立即创建一个页面并将其分配给应用程序的 Current::Window->Content 之后，我假设我需要等待某种布局传递才能给我回电等。然后，一旦发生了，我在哪里可以找到网格位置或任何占位符 XAML 元素的最终布局位置（在窗口相对像素坐标中）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T21:24:30.093

一旦您的后代控件引发 Loaded 事件（需要从 C# 转换为 C++/CX），这应该可以工作：

```
Rect descendantControlBoundsInWindowCoordinateSpace = DescendantControl
    .TransformToVisual(Window.Current.Content)
    .TransformBounds(
        new Rect(
            0,
            0,
            DescendantControl.ActualWidth,
            DescendantControl.ActualHeight)) 
```

# python - Scapy 不显示 HTTP 响应

> ID：12465373
> 
> 赞同：0
> 
> 时间：2012-09-17T18:48:20.597
> 
> 标签：python, http, scapy

我正在从[这里](https://github.com/invernizzi/scapy-http)运行 Scapy 的 HTTP 扩展。这就是我所做的：

1.  开始scapy并做到了`sniff(filter="tcp",count=100)`
2.  打开浏览器并搜索图像
3.  回到 Scapy 并做到`a=_`了`if HTTPResponse in a: print a.show()`

似乎没有 HTTPResponse 数据包，这是不可能的，因为我在浏览器中看到了响应。为什么会这样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T20:01:27.410

`sniff`返回一个数据包向量，您需要对其进行迭代并检查每个数据包是否具有您正在寻找的 HTTP 层：

```
a = sniff(...)
for packet in a:
    if HTTPResponse in packet:
        packet.show() 
```

这应该有效。

# javascript - 为什么我没有得到内容数组结果 0、1、2？

> ID：12465383
> 
> 赞同：1
> 
> 时间：2012-09-17T18:49:15.913
> 
> 标签：javascript

我有一个代码： [演示 jsFiddle](http://jsfiddle.net/centerwow/GEnPf/12/)

which 循环 3 次，每次创建一个返回循环序列号的新函数。

我希望看到循环序列插入到数组：**0、1 和 2。**

```
a[i] = function() {
            return i;
        } 
```

一切看起来都很正常但是当我尝试打印我得到的数组时

结果：

```
arr[0] is =>function () { return i; }
arr[1] is =>function () { return i; }
arr[2] is =>function () { return i; } 
```

编码：

```
function f() {
    var a = [];
    var i;
    for (i = 0; i < 3; i++) {
        a[i] = function() {
            return i;
        }
    }
    return a;
}
var arr = f();

for (var index = 0; index < arr.length; index++) {
    document.write("<b>arr[" + index + "] is </b>=>" + arr[index] + "<br>");
}​ 
```

为什么我没有得到结果**0、1 和 2。**？

很多谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T19:00:00.620

因为`a[i]`是一个函数，而不是函数的返回值。所以基本上你用三个函数体填充你的数组，所以当你检索它们中的任何一个时，你就会取回函数体。您可以尝试`a[i].call()`调用返回的函数，但每次调用都会得到 3，这与 Pointy 在评论中指出的一致。因为这是调用循环时的最后一个值，所以在循环停止之前 i 变成了 3

看[小提琴](http://jsfiddle.net/Gj4ms/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T19:09:42.007

我想我理解为什么您希望所有数组元素都返回`i`构造函数时的值。这并不是什么大的飞跃，但是这些功能中的每一个都共享一个范围。这些值没有链接到创建的函数，它是比*“母亲”*函数更有效的范围。在此范围内，有一个名为的变量`i`会递增，直到`3`. *如果你真的非常*想使用闭包，你唯一能做的就是：

```
function f()
{
    var a = [];
    var i;
    for (i = 0; i < 3; i++)
    {
        a[i] = (function(currentI)
        {//create a separate scope, pass current value of i to it
            return function()
            {
                return currentI;
            }
        })(i);
    }
    return a;
}
var arr = f();
for (var index = 0; index < arr.length; index++)
{
    document.write("<b>arr[" + index + "] is </b>=>" + arr[index]() + "<br>");
}​ 
```

这会产生预期的结果，[如您在此处所见](http://jsfiddle.net/GEnPf/14/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T19:17:41.370

仅作记录，如果您*真的*想要一个包含三个函数的数组，其中每个函数返回的值与`i`创建函数时的值相同，您只需在`i`将函数分配给时传递一个副本`a[i]`：

```
function f() {
    var a = [];
    var i;
    for (i = 0; i < 3; i++) {
        a[i] = (function(n) {
            return function() {
                return n;
            };
        }(i));
    }
    return a;
}

var arr = f();

for (var index = 0; index < arr.length; index++) {
    document.write("<b>arr[" + index + "]() is </b>=> " + arr[index]() + "<br>");
}​ 
```

输出：

> arr[0]() 是 => 0
> arr[1]() 是 => 1
> arr[2]() 是 => 2

[**JSFiddle**](http://jsfiddle.net/Mc86T/)

# actionscript-3 - 沿（x，y）坐标轴转换数据？

> ID：12465389
> 
> 赞同：-3
> 
> 时间：2012-09-17T18:49:30.123
> 
> 标签：actionscript-3, flash, graph, coordinates

我有这样的数据

x 轴数据值 -20.49, -12.23, -9.99, -1.00 0 , 1.12, 2.23, 3.45, 4.56, 8.99, 20.99, 30.23

y轴数据值10,20,20,40,50,60........

![在此处输入图像描述](../Images/7e4825dcf22b39c5f98c25e1d56c7b33.png)

我想将上面给定的数据转换为 xy 坐标系。

请看图。

例如：

沿 x 轴 (min, max ) 数据值 (-20.49, 30.23)，

沿 y 轴 (min, max ) 数据值 (10,60)

![在此处输入图像描述](../Images/39df2785d684a7cbb0bd699d2ef13697.png)

现在如果我想在图像中绘制数据（-20.49, 10），X 坐标将是 = 200，Y 坐标将是 = 220。

像这样我想绘制所有数据适合矩形范围。

希望这能提供所有细节

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T05:39:00.690

这更多是数学问题，与任何编程语言无关。谈到 Actionscript 3，它的 Y 轴是从上到下，而不是从下到上。无论如何：如果您想将轴上的两个点映射到您选择的屏幕坐标，则记录`xmin`为较小的原生值、`xmax`较大的原生值，并将坐标记录为`xleft`和`xright`。然后，当您需要接收给定的屏幕坐标时`x`，您可以将`xcoord`值计算为：

```
xcoord = xleft + (x - xmin)*(xright - xleft)/(xmax - xmin); 
```

类似的方法将为您提供正确的 Y 轴值。

# php - 添加 WHERE YEAR 中断计算

> ID：12465390
> 
> 赞同：4
> 
> 时间：2012-09-17T18:49:35.400
> 
> 标签：php, mysql

我有一个非常简单的查询：

```
SELECT a, b, a+b as c FROM records 
```

效果很好。他是结果中的一个例子：

```
Array ( [a] => 100.92 [b] => 21.00 [c] => 121.92 ) 
```

但是我尝试按年份过滤记录的那一刻：

```
SELECT a, b, a+b as c FROM records
WHERE YEAR(`mydate`) = '2011' 
```

a+b 计算消失：

```
Array ( [a] => 100.92 [b] => 21.00 [c] => ) 
```

我错过了一些明显的东西吗？

更新：

1.  我被要求提供实际的 SQL，这里是：

    从交易中选择贷方、借方、贷方+借方作为总金额 WHERE YEAR( `transaction_date`) = '2011'

2.  transaction_date 是**DATE**字段类型。

3.  此外，贷方或借方字段始终为零。

4.  PHP代码：

**代码**

```
include($_SERVER["DOCUMENT_ROOT"] . "/pool/_/db.php");

$sql = "SELECT credit, debit, credit+debit as total FROM transactions
            WHERE YEAR(`transaction_date`) = 2011";

$result = mysql_query($sql) or die(mysql_error());

while($row = mysql_fetch_assoc($result)) {
        print_r($row);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T19:53:17.600

我唯一能想到的是`credit`or `debit`is `NULL`(not `0`) 反过来也会使 total 的值`NULL`。试试这个，看看它是否改变了什么：

```
... COALESCE(credit, 0) + COALESCE(debit, 0) as total ... 
```

# tsql - TSQL 查询和 CTE 查询的语法

> ID：12465394
> 
> 赞同：-3
> 
> 时间：2012-09-17T18:50:10.863
> 
> 标签：tsql, syntax, common-table-expression

我将在本文末尾发布我的查询，但首先需要说明。请忽略列名和表名，但我在两个地方有语法错误。当我将此查询与我的 CTE 一起使用时，它告诉我必须首先“用 ; 终止前一个语句” 然后我在 CTE 中使用别名列名，然后它说“无法绑定多部分标识符“E.ActiveAGVs”。

我希望我能很好地解释我的问题。如果有人能看到我正在尝试做的事情并让我知道它是否会起作用或纠正我的语法错误，我将非常感激。

```
Select A.move_hour as 'Hour', 
       isnull(B.move_count,0) as 'Current_Count', 
       isnull(C.move_count,0) as '1_Day_Previous', 
       isnull(D.move_count,0) as '2_Day_Previous',
       ISNULL (E.ActiveAGVs,0) as 'Active AGV''s'
           --^ Error right here
from
   (select distinct(DATEPART(HH, Move_History.Move_Dt)) as move_hour 
   from Move_History 
   where Plant_Id = 1 and Building_Id = 1) as A
left outer join
   (select datepart(HH,Move_History.Move_Dt) as move_hour, 
           Move_History.Move_Cnt as move_count 
   from Move_History 
Group by datepart(HH,Move_History.Move_Dt), Move_Cnt) as B on A.move_hour = B.move_hour
left outer join
(select datepart(HH,Move_History.Move_Dt) as move_hour, Move_History.Move_Cnt as       move_count 
from Move_History 
Group by datepart(HH,Move_History.Move_Dt), Move_Cnt) as C on A.move_hour = C.move_hour
left outer join
(select datepart(HH,Move_History.Move_Dt) as move_hour, Move_History.Move_Cnt as move_count 
from Move_History 
Group by datepart(HH,Move_History.Move_Dt), Move_Cnt) as D on A.move_hour = D.move_hour;
with const as (
    select cast(cast(getdate() as date) as datetime) as midnight
    ),
allhours as (
    select 0 as m_hour, midnight as timestart, dateadd(hour, 1, midnight) as timeend from const union all
   ...
    select 23 as m_hour, dateadd(hour, 23, midnight) as timestart, dateadd(hour, 24, midnight) as timeend from const
   ) 
(select ah.m_hour,
   (sum(datediff(SECOND, timestart), ah.timeend else dt.End_Dt end)) 
   / 18000.0) * 5 as ActiveAGVs              
from allhours as ah
 left outer join AGV_Report as dt
 on ah.timestart< coalesce(dt.End_dt, getdate()) and
    ah.timeend >= dt.Begin_Dt
Group by datepart(SECOND,ah.hour), ah.timestart) as E on A.move_hour = E.move_hour
                                   --^ 'Incorrect syntax near "as"'
 where A.move_hour is not null
order by ah.m_hour asc 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T20:06:25.767

您需要为语句定义的所有 CTE 必须位于语句的开头。即使 CTE 仅用于其中一个子查询，语法仍然要求将它们放置在整个语句的开头，*而不是*实际引用它们的特定子查询的开头。

因此，您的陈述应该看起来像这样：

```
**;  -- required if there are statements preceding
with const as (
    select cast(cast(getdate() as date) as datetime) as midnight
    ),
allhours as (
    select
       0 as m_hour,
       midnight as timestart,
       dateadd(hour, 1, midnight) as timeend
    from const
    union all
   ...
    select
       23 as m_hour,
       dateadd(hour, 23, midnight) as timestart,
       dateadd(hour, 24, midnight) as timeend
    from const
   )**
Select A.move_hour as 'Hour', 
       isnull(B.move_count,0) as 'Current_Count', 
       isnull(C.move_count,0) as '1_Day_Previous', 
       isnull(D.move_count,0) as '2_Day_Previous',
       ISNULL (E.ActiveAGVs,0) as 'Active AGV''s'
from
   (
      select distinct
         DATEPART(HH, Move_History.Move_Dt) as move_hour 
      from Move_History 
      where Plant_Id = 1 and Building_Id = 1
   ) as A
left outer join
   (
      select
         datepart(HH,Move_History.Move_Dt) as move_hour, 
         Move_History.Move_Cnt as move_count 
      from Move_History 
      Group by datepart(HH,Move_History.Move_Dt), Move_Cnt
   ) as B on A.move_hour = B.move_hour
left outer join
   (
      select
         datepart(HH,Move_History.Move_Dt) as move_hour,
         Move_History.Move_Cnt as move_count 
      from Move_History 
      Group by datepart(HH,Move_History.Move_Dt), Move_Cnt
   ) as C on A.move_hour = C.move_hour
left outer join
   (
      select
         datepart(HH,Move_History.Move_Dt) as move_hour,
         Move_History.Move_Cnt as move_count 
      from Move_History 
      Group by datepart(HH,Move_History.Move_Dt), Move_Cnt
   ) as D on A.move_hour = D.move_hour
**left outer join  -- assuming...
   (
      select
         ah.m_hour,
         (sum(datediff(SECOND, timestart), ah.timeend else dt.End_Dt end))
         / 18000.0) * 5 as ActiveAGVs              
      from allhours as ah
      left outer join AGV_Report as dt
         on ah.timestart < coalesce(dt.End_dt, getdate())
        and ah.timeend >= dt.Begin_Dt
      Group by datepart(SECOND,ah.hour), ah.timestart
   ) as E on A.move_hour = E.move_hour**
where A.move_hour is not null
order by ah.m_hour asc 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T19:26:46.427

公用表表达式 (CTE) 必须用分号 (;) 与任何先前的语句分隔。如果在 the 之前没有语句，`with`则不需要分号。

您可以在单个`with`. 一个例子如下：

```
with
  -- Counting numbers.
  Numbers as (
    select 1 as Number
    union all
    select Numbers.Number + 1
      from Numbers
      where Number < 10 ),
  -- Squares of counting numbers.
  Squares as (
    select Number, Number * Number as Square
      from Numbers )
  -- Result.
  select Number, Square
    from Squares 
```

像其他试图提供帮助的人一样，我不知道你的 SQL 试图做什么。

# java - 如何使用 JPA 有条件地删除记录？

> ID：12465395
> 
> 赞同：1
> 
> 时间：2012-09-17T18:50:12.423
> 
> 标签：java, jpa

我的数据库表中有以下数据

1 我的名字@email.com 2323
2 我的名字@email.com 3432
3 我的名字2@gmail.com 4433

我想删除表中的所有记录`email == myname@email.com`

下面是我的 EJBQL - 我不知道哪里出错了，但是查询不起作用。

```
Query query = em.createQuery("DELETE FROM ResetPasswordEntity r WHERE r.email=:email");
query.setParameter("email", email); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T18:58:50.687

查询是正确的。我缺少一行代码。这是为了那些可能面临这个问题的人的利益。

```
query.executeUpdate(); 
```

# python - 根据索引列表返回子列表的最简单和最有效的函数是什么？

> ID：12465403
> 
> 赞同：2
> 
> 时间：2012-09-17T18:50:56.177
> 
> 标签：python, list

说我有一个清单`l`：

```
['a','b','c','d','e'] 
```

和索引列表`idx`：

```
[1,3] 
```

将返回的最简单和最有效的函数是什么：

```
['b','d'] 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-17T18:53:44.840

尝试使用这个：

```
[l[i] for i in idx] 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-17T18:52:39.630

你想要`operator.itemgetter`。

在我的第一个示例中，我将展示如何使用它`itemgetter`来构造可用于任何可索引对象的可调用对象：

```
from operator import itemgetter
items = itemgetter(1,3)
items(yourlist)  #('b', 'd') 
```

现在我将展示如何使用参数解包将索引存储为列表

```
from operator import itemgetter
a = ['a','b','c','d','e']
idx = [1,3]
items = itemgetter(*idx)
print items(a)  #('b', 'd') 
```

当然，这给了你 a `tuple`，而不是 a `list`，但是如果你真的需要的话，从一个元组构造一个列表是微不足道的。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-17T18:52:31.660

这是一个使用列表推导的选项：

```
[v for i, v in enumerate(l) if i in idx] 
```

`idx`如果您先转换为集合，这将更有效。

一个替代方案`operator.itemgetter`：

```
import operator
operator.itemgetter(*idx)(l) 
```

如评论中所述，`[l[i] for i in idx]`这可能是您最好的选择，除非`idx`可能包含大于长度的索引`l`，或者如果`idx`未排序并且您希望保持与 相同的顺序`l`。

# javascript - Xmlhttprequest 跨站点域问题？

> ID：12465404
> 
> 赞同：0
> 
> 时间：2012-09-17T18:51:00.080
> 
> 标签：javascript, xmlhttprequest

一段时间以来一直被困在一个问题上，但还没有找到最好的解决方案。我正在从驻留在服务器上的 javascript 调用 xmlhttprequest (POST) 说“http://localhost:8080”到另一台服务器“http://localhost:9090”

出现浏览器错误如下所述：异常...“组件返回失败代码：0x80004005 (NS_ERROR_FAILURE)”nsresult:“0x80004005 (NS_ERROR_FAILURE)”该错误也没有指向任何特定的内容。通过从同一台服务器调用进行了相同的测试并且工作正常。但我正在研究两种服务器架构。

任何决议/想法？看到一些关于将跨域来源的响应标头设置为“*”的帖子，但不确定如何为 xmlhhtprequest 调用设置响应标头？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T18:59:54.447

由于尝试通信的实体的来源在主机部分相同，但在端口部分不同（localhost:8080 <-> localhost:9090）——这违反了相同的来源策略，浏览器会抛出错误。有关更多信息，请参见：[http ://en.wikipedia.org/wiki/Same_origin_policy](http://en.wikipedia.org/wiki/Same_origin_policy)

解决这个问题的方法是在服务器返回的 HTTP 响应中使用 CORS 标头。您使用 XHR 生成 HTTP 请求这一事实没有任何区别。基本上，您需要做的是在您对 POST 请求的响应中添加一个`Access-Control-Allow-Origin: *`或。这当然假设您可以控制要发布到的服务器资源，以便您可以修改响应标头。有关更多信息，请参见：http: [//enable-cors.org/](http://enable-cors.org/)和[http://en.wikipedia.org/wiki/Cross-Origin_Resource_Sharing](http://en.wikipedia.org/wiki/Cross-Origin_Resource_Sharing)`Access-Control-Allow-Origin: http://localhost:8080``http://localhost:9090`

# ios - 需要在 iOS 应用中实现用户驱动裁剪

> ID：12465405
> 
> 赞同：0
> 
> 时间：2012-09-17T18:51:07.040
> 
> 标签：ios, image-processing

是否可以实现 iOS 5 >“照片”应用裁剪机制？这正是我的应用程序所需要的。我需要允许用户选择图像并使用“照片”应用程序提供的东西来裁剪该照片。有这方面的图书馆吗？我可以从 SDK 直接连接到它吗？我在这里有什么选择？我浏览了谷歌和 Github，没有运气。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T19:20:05.247

标准 SDK 提供了一种获取图片的方法，让用户对其进行裁剪，并将其导入您的 App，请参阅：http: [//developer.apple.com/library/IOS/#documentation/AudioVideo/Conceptual/CameraAndPhotoLib_TopicsForIOS/Articles /TakingPicturesAndMovies.html](http://developer.apple.com/library/IOS/#documentation/AudioVideo/Conceptual/CameraAndPhotoLib_TopicsForIOS/Articles/TakingPicturesAndMovies.html)

# javascript - 将 history.popstate 与 DIV 和 AJAX 一起使用

> ID：12465406
> 
> 赞同：0
> 
> 时间：2012-09-17T18:51:09.207
> 
> 标签：javascript, ajax, browser-history, popstate, html5-history

我正在为一个网站创建一个“门户”类型的页面，其中网站上的初始“登陆”阶段包含背景图像和非常少的内容，但单击标题为“关于我们”的链接会触发 AJAX 命令来加载页面' about.php' 到名为 'MoreDiv' 的 DIV 中 - 此外，触发 javascript 命令以将 'MoreDiv' 设置为可见，同时还隐藏初始文本 div（称为 'phototext'）和一个称为 'bottomlinks' 的附加 div。然后，文件“about.php”包含一个链接列表，这些链接调用 AJAX 以在名为“InnerContent”的不同 Div 中加载内容......这个 div 在“MoreDiv”中，因此链接列表保持在原位，并且只有底部页面的一部分发生变化。在链接列表中是“返回首页”

我已经使用 history.pushstate 来获取 URL 以查看我想要的方式，因为该页面是一个 PHP 文件，因此直接输入显示的 URL 将加载页面，并将正确的子页面加载到相应的 Div 中。

我现在遇到的问题是如何使用 history.popstate 将这些变体保存到浏览器历史记录中的页面，以便单击浏览器中的后退按钮将更改 Div 的内容....

Javascript：

```
function setVisibility(id, visibility) {
document.getElementById(id).style.display = visibility;
}
setVisibility('MoreDiv', 'none');

function ResetToHome(){
setVisibility('MoreDiv', 'none');
setVisibility('PhotoText', 'inline');
setVisibility('bottomlinks', 'inline');
history.pushState(null, null, "?home=y");
document.getElementById('MoreDiv').innerHTML = "";
}

function ahah(url,target) {

  document.getElementById(target).innerHTML = ' Fetching page...<br>(slow? <a href="Javascript:dud()" onclick="ResetToHome();">Reset Page</a>)';
  if (window.XMLHttpRequest) {
    req = new XMLHttpRequest();
  } else if (window.ActiveXObject) {
    req = new ActiveXObject("Microsoft.XMLHTTP");
  }
  if (req != undefined) {
    req.onreadystatechange = function() {ahahDone(url);};
    req.open("GET", url, true);
    req.send("");
  }
}  

function ahahDone(url) {
var target = "MoreDiv"
var ExtraDiv = 'Extra text here';
  if (req.readyState == 4) { // only if req is "loaded"
    if (req.status == 200) { // only if "OK"
      document.getElementById(target).innerHTML = req.responseText;
    } else {
      document.getElementById(target).innerHTML=" AJAX Error:\n"+ req.status + "\n" +req.statusText;
}
  }
}

function AjaxIt(url){

setVisibility('MoreDiv', 'inline');
setVisibility('PhotoText', 'none');
setVisibility('bottomlinks', 'none');

ahah(url,"MoreDiv");
history.pushState(null, null, "?page=about.php");

}

function haha(url) {
var target = "InnerContent";
  document.getElementById(target).innerHTML = ' Fetching page...';
  if (window.XMLHttpRequest) {
    req = new XMLHttpRequest();
  } else if (window.ActiveXObject) {
    req = new ActiveXObject("Microsoft.XMLHTTP");
  }
  if (req != undefined) {
req.onreadystatechange = function() {hahaDone(url);};
req.open("GET", url, true);
req.send("");
  }
  history.pushState(null, null, "?page="+url);

}  

function hahaDone(url) {
var target = "InnerContent";
var ExtraText = 'extra text';
  if (req.readyState == 4) { // only if req is "loaded"
    if (req.status == 200) { // only if "OK"
      document.getElementById(target).innerHTML = req.responseText+ExtraText;
    } else {
      document.getElementById(target).innerHTML=" AJAX Error:\n"+ req.status + "\n" +req.statusText;
    }
  }
} 
```

然后页面在页面中有以下HTML（分别标记了主页和about.php）：

```
MAIN PAGE 

<div ID="PhotoMain" name="PhotoMain" class="PhotoMain" style="position:relative; -webkit-border-radius: 10px;  -moz-border-radius: 10px; min-width:600px; max-width:60%">
<p><img src="http://www.ukastle.co.uk/discussion/gallery/image.php?album_id=67&image_id=2640" class="MainImage" ID="MainImage" name="MainImage" style=" -webkit-border-radius: 10px;  -moz-border-radius: 10px; border-radius: 10px; -khtml-border-radius: 10px; max-width:100%;"/></p>
<div name="MoreDiv" ID="MoreDiv" style="position: absolute;top: 10px; left: 15px; width: 95%; font-size:1.3em; background: rgb(0, 0, 0); background: rgba(0, 0, 0, 0.7); padding:10px; -webkit-border-radius: 10px;  -moz-border-radius: 10px; border-radius: 10px; -khtml-border-radius: 10px; visibility:none; display:none;">text</div>

<div name="PhotoText" ID="PhotoText" style="position: absolute;top: 15px; left: 15px; width: 400px; font-size:1.3em; background: rgb(0, 0, 0); background: rgba(0, 0, 0, 0.7); padding:10px; -webkit-border-radius: 10px;  -moz-border-radius: 10px; border-radius: 10px; -khtml-border-radius: 10px;"><h1>Welcome</h1>
Welcome to the website. this page is being built<br /><br />

 <br /><br /><a href="Javascript:dud()" onclick="AjaxIt('/about.php')">About Us</a>    </div>

<div name="bottomlinks" id="bottomlinks" style="width=100%; position: absolute;bottom: 15px; left: 15px;margin: 0;padding: 0;list-style-type: none;text-align: center; font-size:1.3em; background: rgb(0, 0, 0); background: rgba(0, 0, 0, 0.6); -webkit-border-radius: 10px;  -moz-border-radius: 10px; border-radius: 10px; -khtml-border-radius: 10px;">
<p style="display: inline; padding-left:20px; padding-right:20px; padding-top:20px; padding-bottom:20px; font-size:1.1em;">This is currently a test style.</p></div>

</div>

ABOUT.PHP

<div style="position:relative;">
<div name="Linklist" id="Linklist" style="position: absolute;top: 50px; left: -10px; width: 35%; font-size:1.3em; background: rgb(0, 0, 0); background: rgba(0, 0, 0, 0.7); padding:1px; -webkit-border-radius: 10px;  -moz-border-radius: 10px; border-radius: 10px; -khtml-border-radius: 10px; text-align:left;">
<ul class="QuickLinks">

<li><span><a  href="?page=tc" onclick="haha('/tc.php'); return false;">Terms of Use &amp; Privacy Policy</a></span></li>
<li><span><a  href="?page=cg" onclick="haha('/cg.php'); return false;">Guide Page</a></span></li>
<li><span><a  href="?page=mm" onclick="haha('/mm.php'); return false;">Management</a></span></li> 
<li><span><a  href="?page=lp" onclick="haha('/lp.php'); return false;">Links</a></span></li>
<li><span><a href="javascript:dud();" onclick="ResetToHome(); return false;">Return to main page</a></span></li>
</ul>
<div name="InnerContent" id="InnerContent" style="position: absolute;top: 350px; width:275%; max-height:95%; left: 0px; font-size:1em; background: rgb(0, 0, 0); background: rgba(0, 0, 0, 0.7); padding:10px; -webkit-border-radius: 10px;  -moz-border-radius: 10px; border-radius: 10px; -khtml-border-radius: 10px; text-align:left; margin-bottom:30px;"><h2>About The Site</h2>
This is a page where we say stuff about Bob behind his back! Bob has funny feet!</div> 
```

这就是页面的基本设置（一些文本只是为了填充空间）......所以我怎样才能让 history.popstate 工作以保持当前基于 javascript/AJAX 的链接到位但也改变基于历史状态的各个 DIV 的内容（和可见性）？谢谢。

（ps。此外，我希望能够使用“返回主页”链接来重置使用 history.pushstate 对 URL 所做的任何更改......因为目前我无法让它做任何事情，即使更改 URL添加“？home = y”）

# php - 更改上传图片的文件扩展名

> ID：12465415
> 
> 赞同：2
> 
> 时间：2012-09-17T18:51:55.167
> 
> 标签：php, file-upload

我正在创建一个 Zend Framework 应用程序，用户可以在其中上传个人资料图像。可接受的文件类型是 png、jpg 和 gif。图像最终被存储为用户的 id + 文件扩展名。

我想知道的是，假设用户上传了 png 或 gif 文件，将文件扩展名更改为 jpg 是否安全？

这样所有的个人资料图像最终都将具有相同的文件扩展名，我只是不确定像这样更改文件类型是否是个好主意。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T20:45:13.740

即使我从未尝试过，所以我不能说它是否真的有效，我认为更改文件扩展名不是一个好主意，因为如果 Web 服务器使用文件扩展名来确定内容类型响应，浏览器无法显示图像。
在我看来，您应该在上传后将 gif/png 图像转换为 jpeg 格式，然后最终移动、重命名或删除原始图像，只将转换后的 jpg 图像留在上传文件夹中。
例如，如果您启用了[GD 扩展](http://php.net/manual/en/book.image.php)，您可以执行以下操作：

```
<?php

/**
 * Convert gif or png image to jpg format
 *  
 * @param string  original image file name
 * @param int     output image quality (0..100) 
 * @return string output jpg file name
 */
function img2jpeg($filename, $quality = 100) {
    if (file_exists($filename) && is_readable($filename)) {
        $p = pathinfo($filename);
        $ext = strtolower($p['extension']);
        if ($ext == "jpg") {
            return($filename);
        } else if ($img = imagecreatefromstring(file_get_contents($filename))) {
            $newname = $p['dirname'].'/'.$p['filename'].'.jpg';
            if (imagejpeg($img, $newname, $quality)) {
                imagedestroy($img);
                return($newname);
            } else {
                imagedestroy($img);
                die("Error creating ".$newname."\n");
            }
        }
    }
    die("Error loading ".$filename."\n");
}

?> 
```

# jar - Gradle Jar 压缩

> ID：12465418
> 
> 赞同：4
> 
> 时间：2012-09-17T18:52:11.027
> 
> 标签：jar, gradle

有没有办法让 Gradle 在使用“jar”任务时不压缩文件？

我一生都找不到任何关于为 jar 设置压缩设置的参考。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2015-09-28T01:28:43.610

这可能只存在于较新版本的 gradle 中，但您现在可以[`entryCompression`](https://docs.gradle.org/current/dsl/org.gradle.api.tasks.bundling.Jar.html#org.gradle.api.tasks.bundling.Jar:entryCompression)为您的`jar`任务指定：

> `ZipEntryCompression entryCompression`
> 
> 存档条目的压缩级别。如果设置为 ZipEntryCompression.DEFLATED（默认值），则使用 DEFLATE 算法压缩每个条目。如果设置为 ZipEntryCompression.STORED，存档的条目将保持未压缩状态。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T21:51:47.067

Gradle 的 Jar 任务目前不支持任何压缩选项。要生成未压缩的 Jar，请使用 Ant 任务。

# java - 在 PCB 类中创建寄存器设置值

> ID：12465423
> 
> 赞同：-1
> 
> 时间：2012-09-17T18:52:29.770
> 
> 标签：java, operating-system

我的 OS 类作业的一部分要求我在 Java 中创建一个具有各种字段的 Process Control Block 类。我已经创建了包含所有不同字段的类，例如名称、状态、到达时间等。但是当被要求这样做时，我被卡住了：

*   寄存器设置值（“RegisterSet”类的对象，包含以下字段：XAR、XDI、XDO、PC、IR、EMIT、RR、PSW、R0、R1、R2、R3、R4、R5、R6、R7）。

似乎我必须创建另一个名为 RegisterSet 的类，其中包含所有这些不同的字段，但是我一直坚持我应该如何做到这一点，然后是如何在我的 PCB 类中创建设置值......

任何帮助将不胜感激。

这就是我所拥有的。我有 RegisterSet 类，每个 Register 都有 setter 和 getter，然后在我的 PCB 类中，我有一个 setValues 函数，如下所示：

```
public void setValues(String XAR,
                        String XDO, String PC, String IR,
                        String EMIT, String RR, String PSW,
                        String R0, String R1, String R2,
                        String R3, String R4, String R5, String R6,
                        String R7){
    RegisterSet reg = new RegisterSet();
    reg.setXAR(XAR);
    reg.setXDO(XDO);
    reg.setPC(PC);
    reg.setIR(IR);
    reg.setEMIT(EMIT);
    reg.setRR(RR);
    reg.setPSW(PSW);
    reg.setR0(R0);
    reg.setR1(R1);
    reg.setR2(R2);
    reg.setR3(R3);
    reg.setR4(R4);
    reg.setR5(R5);
    reg.setR6(R6);
    reg.setR7(R7);
} 
```

然后我有运行我在 RegisterSet 类中创建的 ToString() 的 getValues 方法：

```
public String getValues(){
    RegisterSet reg = new RegisterSet();
    return reg.ToString();
} 
```

最后，这是我试图在我的 sim 中运行的内容：

```
//Remaining are Registers
String xar = st.nextToken();
String xdi = st.nextToken();
String xdo = st.nextToken();
String pc = st.nextToken();
String ir = st.nextToken();
String emit = st.nextToken();
String rr = st.nextToken();
String psw = st.nextToken();
String r0 = st.nextToken();
String r1 = st.nextToken();
String r2 = st.nextToken();
String r3 = st.nextToken();
String r4 = st.nextToken();
String r5 = st.nextToken();
String r6 = st.nextToken();
String r7 = st.nextToken();
PCB.setValues(xar, xdi, xdo, pc, ir, emit, rr, psw,
        r0, r1, r2, r3, r4, r5, r6, r7); 
```

我尝试编译时得到的错误是这样的：

```
 required:     String,String,String,String,String,String,String,String,String,String,String,String,String,String,String
 found: String,String,String,String,String,String,String,String,String,String,String,String,String,String,String,String
 reason: actual and formal argument lists differ in length 
```

基本上，我从许多进程中读取不同的细节，将数据填充到 PCB 中，然后将 PCB 添加到进程表中，这实际上只是一个 ArrayList。之后，我遍历 ArrayList，并打印出每个进程。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T00:28:37.773

您是否尝试过类似的方法：

```
class PCB {
    ...
    RegisterSet registerSet = new RegisterSet();

    public RegisterSet getRegisterSet() { return this.registerSet; }
    public void setRegisterSet(RegisterSet rs) { this.registerSet = rs; }
    ...
} 
```

这回答了您的直接问题，但不知何故，我不确定您要问的是什么。

# c# - C#-WebService 肥皂异常

> ID：12465428
> 
> 赞同：0
> 
> 时间：2012-09-17T18:52:50.273
> 
> 标签：c#, web-services

我正在尝试从数据库中检索下拉项目列表。如果我不使用 Web 服务访问数据库，该代码运行良好，但是当我使用 Web 服务访问数据库时，它给了我一个 Soap 异常。这是代码，请帮助。

例外是：

```
System.Web.Services.Protocols.SoapException: Server was unable to process request. --->
System.InvalidOperationException: There was an error generating the XML document. --->
System.InvalidOperationException: Cannot serialize the DataTable. DataTable name is not set.
    at System.Data.DataTable.WriteXmlSchema(XmlWriter writer, Boolean writeHierarchy) 
```

这是方法：

```
private void retrieveStates()
        {
            dataService = new PCDDA.Service();
            DataTable dt = new PCDDA.Service().GetStates();
            DDLSelectState.DataSource = dt;
            DDLSelectState.DataTextField = "RegionName";
            DDLSelectState.DataValueField = "RegionID";
            DDLSelectState.DataBind();
            DDLSelectState.Items.Insert(0, new ListItem("<Select State>", "0"));
        } 
```

这是 Web 服务的 Service.cs 类中的 GetStates() Web 方法：

```
[WebMethod]
    public DataTable GetStates()
    {
        DbPostcardOTR db = new DbPostcardOTR();
        try
        {
            DataTable loadstates = db.LoadStates();
            return loadstates;

        }
        catch (Exception ex)
        {
            throw new Exception("Unable to retrieve or load States from the database. The Exception is :" + ex.Message);
        }

    } 
```

这是 DbPostcardOTR.cs 中的 LoadStates() 方法：

```
 public DataTable LoadStates()
    {
        DataTable States = new DataTable();
        SqlConnection con = OpenConnection();
        try
        {
            string selectSQL = "Select RegionID, RegionName from PCDDev.dbo.tblDistributionArea";
            SqlCommand cmd = new SqlCommand(selectSQL, con);
            SqlDataReader dr = cmd.ExecuteReader();
            States.Load(dr);
            return States;
        }
        finally
        {
            if (con != null)
                con.Close();
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T18:55:55.407

来自微软：

> DataTable、DataRow、DataView 和 DataViewManager 对象不能被序列化并且不能从 XML Web 服务返回。要返回不完整的 DataSet，您必须将要返回的数据复制到新的 DataSet。

来源：[使用返回 DataTable 的 XML Web 服务的问题](http://support.microsoft.com/kb/306134)

注意：上述来源包含可能适用于您的情况的替代方法。简而言之，返回一个 DataSet。

# javascript - 重定向后强制 IE9 加载未缓存的位置

> ID：12465432
> 
> 赞同：0
> 
> 时间：2012-09-17T18:52:55.327
> 
> 标签：javascript, internet-explorer, redirect, browser-cache

我们最近对我们的网站进行了地理定位，现在它可以检测浏览器选项中设置的用户首选语言。例如，如果您首先设置了法国法语，您将使用 HTTP301 重定向到法国主页 (/fr-fr)。

问题是，如果您想在根 (/) 处设置返回英文美国主页，IE9 在缓存中显示它是重定向并直接请求重定向的 URL。起初我坚持认为它是服务器端，但使用 Fiddler2 我发现它是 IE 抽搐。我试图在 URL 中添加一个时间戳，但它并没有改变任何东西。

有没有办法强制 IE 在不重新连接请求的情况下加载页面？我试过 document.location 但它不起作用。

如果您想查看，该网站位于 www.sherweb.com。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T18:54:12.820

使用 302 重定向，它应该可以解决问题。

# java - 维基百科用于版本比较功能的算法是什么

> ID：12465434
> 
> 赞同：2
> 
> 时间：2012-09-17T18:53:02.087
> 
> 标签：java, algorithm, comparison, versioning, revision

我目前正在实现某种文本版本（修订）比较可视化，并试图找到一些有关维基百科如何实现其“查看历史”功能的信息，在该功能中他们允许将当前修订与旧版本进行比较。

您可以在此处找到一个示例（关于 stackoverflow！）：

[http://en.wikipedia.org/w/index.php?title=Stack_Overflow&diff=512241244&oldid=458578615](http://en.wikipedia.org/w/index.php?title=Stack_Overflow&diff=512241244&oldid=458578615)

到目前为止，我已经实现了几个想法，并尝试重现维基百科的做法。为此，我实现了 Levenshtein-distance 算法（[http://en.wikipedia.org/wiki/Levenshtein_distance](http://en.wikipedia.org/wiki/Levenshtein_distance)）。

假设我有两个列表。如果找到的字符串超过 50% 相等，我正在遍历第一个列表并检查第二个列表中第一个列表的索引位置。如果是，我将在比较视图中并排打印两个字符串，然后继续第一个列表的下一项。如果不是，我会检查第二个列表中的下一项，直到找到它，如果找不到，则将第二个列表的字段留空。（虽然我基本上更喜欢第二个列表中的一个句子也总是出现在比较视图中，而不是把它排除在外，例如，第一个列表字段有一个空白字段）

这种方法有一些缺点。起初，如果某些句子被删除，我需要检查索引周围的位置，而不是简单地“忘记”它。但我仍然需要注意，如果我这样做，文本位置不会倒置。

你们有没有人尝试过用java实现类似的东西？如果有一些代码示例，其他人或您是如何实现的，我很乐意看看并从中学习。

当然，如果您对用于修订比较的算法维基百科（以及我假设的一般维基？）有所了解，我会很高兴听到它。

非常感谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T19:01:29.137

维基百科解释了 wiki 差异引擎的工作原理 - [http://en.wikipedia.org/wiki/Help:Diff](http://en.wikipedia.org/wiki/Help:Diff)

您可以点击页面底部的链接了解更多信息，但[此页面](http://en.wikipedia.org/wiki/Template%3aWiki_diff)列出了使用的模板。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-17T18:57:35.727

除了 Wikipedia 的版本控制之外，另一个实现是`diff`在 Unix 风格的系统上。GNU 实际上为[diff](http://en.wikipedia.org/wiki/Diff)提供了源代码，这可以让您在此处查看他们的算法：

[http://ftp.gnu.org/gnu/diffutils/](http://ftp.gnu.org/gnu/diffutils/)

# c# - PLINQ 没有提高性能

> ID：12465436
> 
> 赞同：4
> 
> 时间：2012-09-17T18:53:12.510
> 
> 标签：c#, linq, plinq

我编写了一个 LINQ 来找出文本文件中唯一字符的频率。我还在 select 的帮助下将我的初始结果转换为一个对象。最终结果以列表的形式出现。以下是我使用的查询。

```
charNodes = inputString.GroupBy(ch => ch)
            .Select((ch) => new TNode(ch.Key.ToString(),ch.Count()))
            .ToList<TNode>(); 
```

我有一台四核机器正在运行，上面的查询在 15 毫秒内运行。但奇怪的是，当我对相同的查询进行 PLINQ 处理时，它花费了更多时间。下面的查询花了大约 40 毫秒。

```
charNodes = inputString.GroupBy(ch => ch).AsParallel
            .Select((ch) => new TNode(ch.Key.ToString(),ch.Count()))
            .ToList<TNode>(); 
```

最糟糕的是下一个查询大约需要 83 毫秒

```
charNodes = inputString.AsParallel().GroupBy(ch => ch)
                               .Select((ch) => new TNode(ch.Key.ToString(), ch.Count()))
                               .ToList<TNode>(); 
```

这里出了什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T20:49:28.943

当这类问题出现时，答案总是相同的：PLINQ 开销高于收益。

发生这种情况是因为工作项非常小（按字符分组，或从琐碎的输入创建新对象）。当它们更大时效果会更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T18:59:46.557

严格根据您提供的代码很难判断那里发生了什么。

TPL 使用线程池线程。线程池以大约 10 个正在运行的线程启动。 ~~如果您需要更多线程，那么只要需要一个新线程，线程池就会大约每秒创建一次新线程。如果您的循环导致超过 10 个并行操作，则需要花时间启动一个新线程。~~**更正**：并行循环需要的线程数从线程池中的可用线程中删除。线程池尝试在该池中保持最小数量的可用线程，如果它注意到线程花费的时间太长，它将启动新的线程来补偿——这会占用资源。框架的许多部分都使用线程池，因此存在各种可能给线程池带来压力的机会。启动线程相当昂贵。

另一种可能是，如果您的迭代次数多于*可用*CPU 的数量，则会导致大量上下文切换。上下文切换很昂贵，并且会影响 CPU 的负载以及操作系统在线程之间切换的速度。

如果您提供更多详细信息，例如输入数据，我可以在答案中提供更多详细信息。

# arrays - 关于动作脚本的问题

> ID：12465439
> 
> 赞同：0
> 
> 时间：2012-09-17T18:53:27.810
> 
> 标签：arrays, actionscript-3, for-loop, array-push, array-splice

我有几个不同的问题，我决定把它们放在一起。所以第一个问题：如果我有一个相同的代码（例如）：

```
buttonsA.buton1a.addEventListener(MouseEvent.MOUSE_DOWN , buton1a_function);
buttonsA.buton2a.addEventListener(MouseEvent.MOUSE_DOWN , buton2a_function);
buttonsA.buton3a.addEventListener(MouseEvent.MOUSE_DOWN , buton3a_function);
buttonsA.buton4a.addEventListener(MouseEvent.MOUSE_DOWN , buton4a_function);
buttonsA.buton5a.addEventListener(MouseEvent.MOUSE_DOWN , buton5a_function);
buttonsA.buton6a.addEventListener(MouseEvent.MOUSE_DOWN , buton6a_function);
buttonsA.buton7a.addEventListener(MouseEvent.MOUSE_DOWN , buton7a_function);
buttonsA.buton8a.addEventListener(MouseEvent.MOUSE_DOWN , buton8a_function);
buttonsA.buton9a.addEventListener(MouseEvent.MOUSE_DOWN , buton9a_function);
buttonsA.buton10a.addEventListener(MouseEvent.MOUSE_DOWN , buton10a_function); 
```

我想把它放在几个地方（在不同的条件下）我可以把它们放在一个函数中调用一个函数而不是复制大量文本（我想过从不同的文件中“包含”，但我想保留所有一个文件中的信息）。

第二个问题是关于数组：在我的情况下，我有一个数组，我 *.push()*里面有一个不同的数字。但它可能是“1,51,11,2,13' 或“1,2,3,4 ,5" 所以每次数字（和数字本身）的位置都是不同的。我怎么能在函数中对 AS3 说，以准确删除（.splice）数字 5 或 6（尽管它们在数组中的位置）。

第三个问题又是关于问题上方的“代码”。我可以用循环*for*用更少的代码来制作所有这 10 个 addEventListen 吗（我认为应该是这样的：）

```
 for(var i:int = 1; i <= 100; i++){
   //buttonsA.buton'i'a.addEventListener(MouseEvent.MOUSE_DOWN , buton'i'a_function);
    } 
```

长话短说，也许我不必提出这么多问题，也许我的想法不正确，但我认为我的问题很简单，但我无法解决它们。欢迎任何决定和回复:) 谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T19:13:19.103

## 第一个问题：

不确定我是否理解您的第一个问题。我会尝试一下，并说您希望在应用程序状态的不同上下文中启用按钮鼠标按下的功能，但是您不想一直重复所有事件侦听器？

如果是这样，您应该为所有按钮创建一个子类来继承。它可能看起来像这样：

```
public class ButtonSubClass extends Sprite {  //or simple button, or whatever
    public function ButtonSubClass():void {
        this.addEventListener(MouseEvent.MOUSE_DOWN,downHandler,false,0,true);
    }

    private function downHandler(e:MouseEvent):void {
        //do something common to all your buttons here
    }
} 
```

然后，让你的所有按钮都继承自这个类。

## 第二个问题：

```
function removeFromArray(elementVal:*):void {
    var index:int = array.indexOf(elementVal);  //get the index of the first element whose value is the passed parameter;
    if(index >= 0){
        array.splice(index,1); //remove that element/index from the array.
    }
} 
```

## 第三个问题：

如果`ButtonA`是一个精灵，其唯一的孩子是您想要监听器的所有按钮，那么您可以这样做：

```
var i:int = buttonA.numChildren;
while(i--){
    buttonsA.getChildAt(i).addEventListener(MouseEvent.MOUSE_DOWN , button_function);
}

function button_function(e:Event):void {
    switch(e.currentTarget){
        case button1a:
            //do something with button 1a
            break;

        case button2a
            //do something with button 2a
            break;
    }
} 
```

或者，更**草率**，效率更低，不推荐，这个：

```
for(var i:int=1;i<=10;i++){
    this["buton" + i.toString() + "a"].addEventListener(MouseEvent.MOUSE_DOWN, this["buton" + i.toString() + "a_function"]); 
} 
```

# php - 总结输出的 db 表播放器统计信息（多个条目）

> ID：12465440
> 
> 赞同：2
> 
> 时间：2012-09-17T18:53:27.720
> 
> 标签：php, mysql

我正在尝试输出曲棍球运动员的“记分牌”/“排名”列表。我目前有一个这样的 MySQL 表：

```
统计ID | 匹配ID | 玩家ID | 目标 | 助攻
120 | 2 | 3 | 4 | 1
121 | 2 | 4 | 2 | 2
122 | 3 | 3 | 0 | 3

```

因此，对于每场比赛，球员都会加上进球和助攻。这意味着每个玩家都有多个条目（几个匹配项）。

所以基本上，有没有一种很好的方法来获取球员数据，总结目标和助攻（+总分）并将其输出到列表中？

现在，我有一个基本查询，只是输出每一行（就我目前的知识而言）。那么我怎样才能只输出每个玩家的一个条目以及他的统计数据呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T18:56:43.647

您需要使用 group by 子句。

```
SELECT playerID, SUM(goals + assist) overall points
FROM   table_name
GROUP BY playerID 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T18:57:59.167

这是一种方法：

```
SELECT t.playerID
     , SUM(t.goals)    AS total_goals
     , SUM(t.assists)  AS total_assists
  FROM sometable t
 GROUP BY t.playerID
 ORDER BY t.playerID 
```

不清楚您对“总分”使用什么计算，如果您只是添加目标和助攻，那么您可以在 SELECT 列表中使用它：

```
 , SUM(t.goals)+SUM(t.assists)  AS overall_points 
```

# installation - 如何在 InstallShield 中的安装序列中强制卸载序列

> ID：12465447
> 
> 赞同：0
> 
> 时间：2012-09-17T18:53:59.760
> 
> 标签：installation, installshield, uninstallation, installscript

如果所选安装目录中已存在安装，我希望我的安装程序在安装新安装之前提示用户卸载现有安装。

现在我试图只调用卸载对话框并让它从那里继续正常执行，但由于它已经在安装序列中，它继续运行安装功能，而不是卸载。

这甚至可能吗？如果没有，我还能如何完成同样的事情。

我正在使用基本 MSI 项目，由于我的安装性质，我不相信我能够设置主要升级。

# jquery - jquery toggle 在子元素上触发两次？

> ID：12465459
> 
> 赞同：0
> 
> 时间：2012-09-17T18:54:48.290
> 
> 标签：jquery, show-hide

我的页面上有一个 div (id="menu")，onclick="toggledropdown()"。这个 div 有子 img 元素和文本。当单击图像以外的任何内容时，切换代码就可以正常工作。但是，当单击图像时，div 会向下滑动，然后再次向上滑动。

切换代码：

```
function toggledropdown()
{
    if ($("#dropdown").is(":hidden"))
    {   
        $("#dropdown").slideDown(400);      
    }
    else
    {
        $("#dropdown").slideUp(50);     
    }
} 
```

如果页面被点击，body.click 隐藏下拉菜单：

```
$(document.body).click(function(event)
{
    var targetID = $(event.target).attr("id");
    if (targetID !== "dropdown" && targetID !== "menu")
    {
        if (!$("#dropdown").is(":hidden"))
            toggledropdown();
    }
}); 
```

下拉。单击以否定正文。单击

```
$("#dropdown").click(function(e)
{
    e.stopPropagation();
}); 
```

html div（省略了一些与问题无关的东西）：

```
<div class="menu" id="menu" onclick="toggledropdown();">
    <img id="dropdownthumbnail" (blahsrc/styleblah) />
    Text
    <img id="dropdownarrow" (blahsrc/styleblah) />
</div> 
```

因此，重申一下，单击菜单 div（减去图像）会正确滑出菜单，再次单击它（包括图像）或页面上的任何其他位置都可以正常工作，但是在隐藏下拉菜单时单击图像切换两次（您可以看到它滑出并再次滑入）。

孩子imgs是否触发了父母的onclick两次？一次给孩子，一次给父母？为什么？如何使其按预期工作：单击 div 上的任意位置会触发一次 onclick？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T21:31:48.470

您需要使用[event.stopPropagation](http://api.jquery.com/event.stopPropagation/)来阻止事件冒泡。

> 描述：防止事件在 DOM 树中冒泡，防止任何父处理程序收到事件通知。

这将阻止父处理程序触发他们的事件

# html - 画布元素中的 3d 变换

> ID：12465462
> 
> 赞同：1
> 
> 时间：2012-09-17T18:55:00.313
> 
> 标签：html, dom, css, canvas

我正在使用 html5 游戏引擎构建游戏。我想创建类似的东西： [http](http://cubiq.org/building-a-pure-css-3d-city) ://cubiq.org/building-a-pure-css-3d-city 有可能通过某种方式（javascript矩阵？）在html5画布渲染的图像中应用3d变换（没有树.js) 像 css3 一样对 DOM 渲染的图像做些什么？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-11-04T13:34:43.867

我没有想法。如果需要网络几何，请使用[https://github.com/Alexei03a/shapyjs](https://github.com/Alexei03a/shapyjs)中的脚本。在画布元素中使用 DOM CSS3 转换。

WebKit Utils 在转换后的 DOM 元素中获取点：

*   [https://developer.apple.com/documentation/webkitjs/webkitpoint](https://developer.apple.com/documentation/webkitjs/webkitpoint)
*   [https://developer.apple.com/documentation/webkitjs/domwindow_additions](https://developer.apple.com/documentation/webkitjs/domwindow_additions)

# iphone - 如何部署 iPhone 应用程序？

> ID：12465464
> 
> 赞同：1
> 
> 时间：2012-09-17T18:55:17.047
> 
> 标签：iphone, publishing, ios-provisioning

我的问题实际上比这更具体一点。我被要求为我的高中开发一个 iPhone 应用程序。我已经完成了上述应用程序，但我已经到了发布应用程序供他们使用的阶段。

我的学校拥有 300 美元的企业许可证，允许他们发布内部应用程序，这是我计划做的。

我无权访问此开发者帐户，也无权访问开发者帐户，我想知道是否有人可以澄清/概述编译/签署 .ipa 然后在内部分发它的过程。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T19:12:09.790

您需要找到负责您学校的开发人员计划订阅的人员。只有该程序的“团队代理”才能构建和签署您的应用程序以进行分发。如果他们愿意，他们还可以将您添加到他们的开发人员计划团队中，这样您就可以获得开发证书并访问各种在线文档和其他资源。您仍然无法自行分发应用程序，但这将是一个改进。

[Apple 的iOS 工具工作流程指南中](http://developer.apple.com/library/ios/DOCUMENTATION/Xcode/Conceptual/ios_development_workflow/00-About_the_iOS_Application_Development_Workflow/introduction.html#//apple_ref/doc/uid/TP40007959-CH1-SW1)描述了构建和分发过程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T19:17:38.663

您必须要求管理员“企业程序”将其添加为成员开发人员。

与每一步生成链接：http: [//www.apple.com/business/accelerator/deploy/](http://www.apple.com/business/accelerator/deploy/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T19:09:01.507

您需要访问开发者帐户，以获取发布此应用程序所需的证书和移动配置，或者您需要其他有此能力的人为您获取它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-17T20:17:24.890

以下链接可以帮助您：

[http://manuals.info.apple.com/en_US/Enterprise_Deployment_Guide.pdf](http://manuals.info.apple.com/en_US/Enterprise_Deployment_Guide.pdf)

[https://help.apple.com/iosdeployment-apps/#app43ad8905](https://help.apple.com/iosdeployment-apps/#app43ad8905)

[iPhone应用企业分发流程](https://stackoverflow.com/questions/1568360/iphone-application-enterprise-distribution-process)

希望对你有帮助...

# c# - 调试混合模式应用程序（c# 和非托管 c++）时出现“当前不会命中断点”错误

> ID：12465468
> 
> 赞同：0
> 
> 时间：2012-09-17T18:56:00.940
> 
> 标签：c#, c++, windows, debug-symbols, mixed-mode

在 VS2010 中调试混合模式应用程序时，在非托管 c++ dll 源文件（从托管 c# 包装器类调用）中包含的一行代码上设置的断点显示臭名昭著的“断点当前不会被命中。没有符号被将鼠标悬停在相关行的断点上时，为该文档加载”信息消息。断点本身是一个带有黄色信息三角形的红色圆圈，而不是通常的实心红色球体。当然，执行调试器时不会命中断点。我为这个警告找到的大多数答案都表明断点设置不正确，或者没有加载预期的 dll，或者相关的 pdb 文件没有位于正确的位置等等。这不是问题。应用程序确实正确加载并执行了引用的 dll。我已经验证了正确的 pdb 文件，其文件日期与其 dll 相同，与目标 dll 本身一起位于可执行文件的工作目录中。调试器根本不会加载 dll 的符号，并且 dll 不会显示在 Modules 列表中。

我在网上找到的解决方案都没有解决这个问题。该 dll 未显示在“调试->Windows->模块”菜单选择中可用的模块列表中......即使它实际上已加载。包装类中设置的断点可以正常工作。

删除 bin 和 obj 目录，清理和重建解决方案也无济于事。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-18T02:59:49.863

此问题的解决方案是设置位于应用程序属性页的“调试”选项卡中的“启用非托管代码调试”标志

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-17T19:18:33.647

您没有点击代码，也没有在模块列表中显示 dll，因为它没有被程序加载。因此，无论您的 C# 包装器调用的是什么，它都不是 - 或者可能没有正确调用。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-09-17T19:11:11.850

有点不清楚你的错误是什么，但如果你收到“断点当前不会被命中”的消息，这意味着它所说的 - 你没有达到你设置的断点。试着回顾一下你的程序，看看断点在哪里（它们应该是边缘的红点），然后看看你是否真的找到了它们

# asp.net - 在 IIS7 中使用表单身份验证保护静态文件

> ID：12465471
> 
> 赞同：2
> 
> 时间：2012-09-17T18:56:10.603
> 
> 标签：asp.net, iis-7, forms-authentication

我们有一个使用表单身份验证和在 IIS7 中启用匿名身份验证的站点。

但是，通过上述设置，每个人都可以访问本站点中的静态文件，例如 CSS、JavaScript 和 Html。

如果我禁用匿名身份验证，用户将无法访问登录页面，因为他们尚未登录。

据我了解，表单身份验证需要启用匿名身份验证。

那么如何保护所有资源文件呢？

谢谢 ！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T19:17:04.663

为了使每个文件都受到表单身份验证的保护，请通过 asp .net 管道路由所有请求。这不是 IIS 的默认行为。对于静态内容的文件，IIS 通常根据站点级别描述的设置（即匿名、基本、Windows、摘要）来分发它们。

虽然你可以做我提到的事情，但我会质疑你为什么要这样做。这增加了开销，因为 .NET 管道将开始处理每个文件以确定是否提供它。

可行，但不推荐。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T20:17:57.903

我想我有点找到答案了。

根据@Josh 的回答，我发现这个[页面](http://www.iis.net/learn/application-frameworks/building-and-running-aspnet-applications/how-to-take-advantage-of-the-iis-integrated-pipeline)讨论了如何对整个应用程序使用表单身份验证。

我认为它就像我想要的那样工作。

1.  您需要安装 Url Authorization 功能

2.  将以下内容添加到您的 web.config

    <系统.web服务器>

    <模块>

    <remove name="FormsAuthenticationModule" />

    < add name="FormsAuthenticationModule" type="System.Web.Security.FormsAuthenticationModule" />

    <remove name="UrlAuthorization" />

    < add name="UrlAuthorization" type="System.Web.Security.UrlAuthorizationModule" />

    < 删除名称="默认身份验证" />

    < add name="DefaultAuthentication" type="System.Web.Security.DefaultAuthenticationModule" />

# java - Java Executors 和每个线程（不是每个工作单元）对象？

> ID：12465473
> 
> 赞同：3
> 
> 时间：2012-09-17T18:56:17.123
> 
> 标签：java, thread-safety, threadpool, executor

我有一项可以从线程池设计模式中受益的任务（许多小任务要并行执行）。我最初从头开始实现了一个简单的线程池，n 个 Runnables 都从同一个线程池中提取工作单元，`ConcurrentLinkedQueue`直到队列为空，然后终止。然后我决定“嘿，让我们试试 Java 中的 Executor，因为它可能比我天真的设计的系统测试得更好，更可靠。” 问题：在我的实现中，每个线程一直持续到队列为空，使用一段时间`(!queue.isEmpty())`，并获得了自己的非线程安全对象实例，我们称之为它`SlowObject foo`，构造起来很耗时。尝试将所有`Runnable`进入`Executor`s 池的 s 传递给时间效率低的对象的实例失败，因为它不是线程安全的。`SlowObject`因为每个`Runnable`都是不可取的，因为它们的建造成本很高。

有没有办法说“我们正在使用多少个线程？让我们`SlowObject`为每个线程创建一个，然后让 Runnables 检测我们正在使用的线程并查找要使用的正确对象？” 这听起来很脆弱且容易失败——不过，我不确定我应该看什么设计模式。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T19:22:54.870

你最好使用资源池。使用这样的东西：

```
public class SlowObjectPool {
    private static final int POOL_SIZE = 10;
    private BlockingQueue<SlowObject> slowObjectQueue = new ArrayBlockingQueue(POOL_SIZE);

    public SlowObjectPool() {
        for (int i = 0; i < POOL_SIZE; i++) {
            slowObjectQueue.put(new SlowObject());
        }
    }

    public SlowObject take() throws InterruptedException {
        return slowObjectQueue.take();
    }

    public void release(SlowObject slowObject) {
        // TODO You may want to log a warning if this is false
        slowObjectQueue.offer(slowObject);
    }
} 
```

您可能也希望将其设为单例。然后在您的可运行文件中：

```
public class MyRunnable implements Runnable {

    private SlowObjectPool pool;

    public MyRunnable(SlowObjectPool pool) {
        this.pool = pool;
    }

    @Override
    public void run() {
        // The next line blocks until a SlowObject is available
        SomeObject someObject = null;
        try {
            someObject = pool.take()
            // Do something with someObject
        } catch (InterruptedException ex) {
            // Thread is being ended, allow to end
        } finally {
            if (someObject != null)
                pool.release(someObject);
        }
    }
} 
```

这将在首次创建池时立即创建所有对象，而不是动态创建它们，这样您的任何可运行对象都不必等待`SomeObject`创建实例。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-17T19:13:55.530

Java 提供了[ThreadLocal](http://docs.oracle.com/javase/6/docs/api/java/lang/ThreadLocal.html)变量的概念。
您可以像这样在[Runnable](http://docs.oracle.com/javase/6/docs/api/java/lang/Runnable.html)中使用它。

```
 public class MyJob implements Runnable {
     private static final ThreadLocal < SlowObject > threadLocal = 
       new ThreadLocal < SlowObject > () {
         @Override protected SlowObject initialValue() {
           // construct and return your SlowObject 
         }
       };

     public void run() {
       // work with threadLocal.get()
     }
   } 
```

因此，对于运行 Runnable 的每个线程，只会创建一个 SlowObject 类的实例。

# javascript - 访问 DOM 元素，当单击按钮获取 (name[i].firstChild.nodeValue;)，

> ID：12465474
> 
> 赞同：0
> 
> 时间：2012-09-17T18:56:24.330
> 
> 标签：javascript

当单击按钮时，我试图仅提醒第一个 nodeValue 而不是全部。按钮和表格是从 SQL 动态创建的。

```
function dodb() {
    var name = document.getElementsByName('prezime');
    var elements = document.getElementsByName('bt');

    for (var i = 0; i <= elements.length; i++) { 

        if (elements[i].type == 'button') {

            var name1 = name[i].firstChild.nodeValue;
            alert ("The " + elements[i].value + " button is click");
            alert(name1);

        }

    }       
} 
```

我解决了这个问题：

```
for (var i = 0; i <= elements.length; i++) { 

    // if (elements[i].type == 'button') {

        var oelements = elements[i];
        oelements.onclick = (function(value) {
            var name1 = name[i].firstChild.nodeValue;
            return function() {
                alert(value);
                // alert ("The " + elements[i].value + " button is click");
                alert(name1);
            }
        })(i);
    }
} 
```

# javascript - Express.js 路由在一台服务器上运行的多个项目

> ID：12465475
> 
> 赞同：0
> 
> 时间：2012-09-17T18:56:24.687
> 
> 标签：javascript, node.js, express

我对 node.js 很陌生，对 Javascript 也很陌生（我不计算使用 jQuery 作为 js 的简单动画）。作为一名网络开发人员，我正在从 PHP/MySQL 迁移到 Express/mongo。

我喜欢整洁的想法——只要性能没有明显的损失。由于 node 发展如此迅速，我发现很难找到针对当前版本 node 的路由方法的具体意见和答案（我发现的大多数帖子似乎无关紧要并且超过 2 年）。

```
|- app.js
    |- routes
        |- blog.js 
```

我使用 blog.js 作为所有博客相关内容的网关。这包括使用函数注册 GET 和 POST 请求，以及处理页面呈现。

这一切都被一个电话点燃了。

我的 app.js 有以下内容：

```
... //basic express installation
var db = ... //mongoose database connection

require('./routes/blog')(app, db, '/blog'); //starts the blog up 
```

blog.js 看起来像这样：

```
var db = null;
var basedir = null;

module.exports = function(app, _db, _basedir){
  db = _db;
  basedir = _basedir;

  app.get (basedir, pages.home );
  app.get (basedir + '/show/:id', pages.getBlog );

  /*app.get(basedir + '/*', function(req, res) {
    res.redirect(basedir);
  });*/ 
};

var pages = {
      home : function(req, res) {
        // whatever
    }

    , getBlog : function(req, res) {
        // whatever
    }
} 
```

我知道这行得通——我的问题是，这是否是传统的？这是不推荐的东西吗？是不是很浪费内存？为什么人们将 app.gets 放在 app.js 中而不是外部文件中？当前主要使用的路由方法是什么（我在同一台服务器上开发了多个小型应用程序，因此我希望我的 app.js 尽可能少）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T19:11:49.883

您概述的方式是完全可以接受的，并且在我看来，宁愿只拥有一个包含所有路线和其他所有内容的大 app.js 文件。

许多人对代码的分离比您所概述的要深入得多，尤其是在尝试遵循 MVC 和类似 MVC 的模式时。

例如，这是我一直在做的一个样板项目，它甚至可能在分离方面有点过火。它不是成品，只是我正在玩的东西，它从其他样板、框架等中汲取了一些我喜欢的不同部分。从那时起我学到了一些东西，我可能会在某个时候对其进行调整。

[NemoJS - 我的 node/express/mongoose/jade/stylus/twitter_bstrap 样板项目](https://github.com/sbabigian/NemoJS)

要记住的一件事是，您将其分离得越多，追踪问题就越困难。不过，这不是一个足够好的理由不保持井井有条。这基本上就是我们的目标，对吧？

# html - ul, li menu - IE9 内边距？

> ID：12465477
> 
> 赞同：0
> 
> 时间：2012-09-17T18:56:33.817
> 
> 标签：html, css, internet-explorer-9, html-lists

我对 IE 9 和 CSS 有一些问题。我想像每天一样制作一个 ul,li 菜单（只是开玩笑，不是每天），然后遇到一些我以前从未遇到过的错误。我有 2 个问题的屏幕截图。第一个 IE 9： [问题 IE9](http://img4.fotos-hochladen.net/uploads/screenshot065a6z78vufj1.jpg)

在这里，我们有我想要的方式并在 Firefox、Chrome、Safari 中获取它： [没问题 Firefox、Chrome、Safari](http://www.fotos-hochladen.net/uploads/screenshot0667noi13kd4v.jpg)

这是整个菜单的 CSS：

```
#menu {
background: white url(images/menu.jpg);
width: 940px;
height: 58px;
margin: 40px auto;
}
#menu ul {
margin: 0px 0px 0px -50px;
padding: 0px 0px 0px 0px;
list-style: none;
line-height: normal;
text-align: center;
}
#menu li {
list-style: none;
line-height: normal;
float: left;
margin-left: 160px;
}
#menu a {
display: block;
float: left;
height: 55px;
padding: 0px 30px 0px 30px;
line-height: 56px;
letter-spacing: 1px;
text-decoration: none;
text-transform: uppercase;
font-family: 'Oswald', sans-serif;
font-size: 19px;
font-weight: normal;
color: #B5B5B5;
border: none;
}
#menu .current_page_item a {
color: #FFFFFF;
}
#menu a:hover {
text-decoration: none;
color: #FFFFFF;
} 
```

这是菜单的 HTML 代码：

```
<div id="menu">
        <ul>
            <li><a href="index.html"><strong>Startseite</strong></a></li>
            <li><a href="programm.html"><strong>Programm</strong></a></li>
            <li><a href="karten.html"><strong>Karten</strong></a></li>
            <li class="current_page_item"><a href="#"><strong>Sponsoren</strong></a></li>               
        </ul>
</div> 
```

我希望有人可以帮助我解决这个问题..

顺便说一句：[http](http://adtime.agasoft.net/bako) ://adtime.agasoft.net/bako在那里你可以找到整个 HTML 页面的东西！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T19:16:20.163

```
<?xml version="1.0" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
```

标签和 IE9 之前的这段代码运行良好...... :)

# objective-c - 子类属性

> ID：12465479
> 
> 赞同：2
> 
> 时间：2012-09-17T18:56:55.610
> 
> 标签：objective-c, properties, subclass

我想以抽象的方式执行以下操作：

```
// .h
@interface SomeObject : NSObject
@property (readonly) NSArray myProperty;
@end

// .m
@interface SomeObject ()
@property (readwrite) NSMutableArray myProperty;
@end

@implementation SomeObject
@end 
```

根据[Mac 开发人员库中的使用属性子类](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/ObjectiveC/Chapters/ocProperties.html#//apple_ref/doc/uid/TP30001163-CH17-SW4)化部分，允许`readonly`使用`readwrite`. 不起作用的是使用属性类型的子类。*我以 NSMutableArray 为例，但它可以是任何其他类/子类组合。*

根据继承规则，应该没问题。`readonly`只生成也允许返回子类对象的getter。

**当您需要某些属性的子类类型供内部使用时，您如何处理这种情况？**

以下是一种丑陋的方式，但我想避免这种情况，因为这意味着`self.`在访问子类方法时我不能使用 getter 和 setter。

```
// .h
@interface SomeObject : NSObject
@property (readonly) NSArray myProperty;
@end

// .m
@implementation SomeObject {
    NSMutableArray _myProperty;
}
@synthesize myProperty = _myProperty;
@end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T19:49:25.473

**编辑**（基于您的编辑）：您在编辑后的具体情况有点特殊和常见（如果可以同时出现），需要仔细考虑。

这是一个特殊的原因是因为子类是暴露类的可变形式。调用者可能期望它在收到它之后不会改变。但是如果你交还你的内部对象，那么它可能会发生变异。你有几个选择：

*   返回一个不可变的副本。这通常是小型收藏的最佳解决方案。这当然是最简单的。但是如果访问器可能被经常调用并且集合很大，那么它可能会非常昂贵。

*   使您的内部属性不可变。如果对属性的请求比对属性的更改更常见，那么在对象发生变异时重新创建对象会更有效（使用`arrayByAddingObject:`等`subarrayWithRange:`）。

*   警告调用者返回的对象可能会改变......呃......我在一个需要性能的情况下这样做了，但这很危险。

*   我从来没有真正这样做过，但您也可以通过这种方式创建自己的写时复制：直接返回可变版本并标记它现在“脏”的标志。当内部需要突变时，制作一个可变副本并将其存储在您的属性中（放开旧集合）。这看起来很复杂，但在某些情况下可能很有用，特别是如果读取和写入倾向于分开聚集（大量读取，然后是大量写入）。

* * *

*基于 NSObject 与 NSString 的旧答案：*

我假设您的目标是`myProperty`成为某种不透明的类型，而不是泄露它是`NSString`? 也许这样您以后可以改变主意，了解它的实际实施方式？有几个选项。最简单的方法是将其定义为 type `id`。然后在内部将其视为字符串。`id`可以是任何东西。它通常比`NSObject*`.

如果你想要更多的内部类型安全，那么你可以创建一个具有另一个类型名称的私有属性，`NSString`并像这样返回它`myProperty`：

## 一些对象.h

```
@interface SomeObject : NSObject
@property (readonly) id myProperty;
@end 
```

## 一些对象.m

```
@interface SomeObject ()
@property (readwrite) NSString *myInternalProperty;
@end

@implementation SomeObject
- (id)myProperty {
  return myInternalProperty;
}
@end 
```

您可以使用的另一种隐藏技术（如果隐藏对您非常重要）是子类。例如：

## 一些对象.h

```
@class MyOpaque;
@interface SomeObject : NSObject
@property (readonly) MyOpaque *myProperty;
@end 
```

## 一些对象.m

```
@interface MyOpaque : NSString
@end
@implementation MyOpaque
@end

@implementation SomeObject
@end 
```

由于调用者没有 的`@interface`定义`MyOpaque`，因此他无法在没有编译器警告的情况下向其发送消息。

* * *

## 回答 #2

> 赞同：-7
> 
> 时间：2012-09-17T19:00:37.210

> 当您需要某些属性的子类类型供内部使用时，您如何处理这种情况？

属性明确不供*内部使用*，它们是公共接口的成员。

如果您需要内部值，请定义一个成员字段并覆盖属性的设置器以设置您的内部值。

# xml - XSLT 2.0，从后代递归获取名为 enum 的祖先::child 元素

> ID：12465480
> 
> 赞同：1
> 
> 时间：2012-09-17T18:57:01.333
> 
> 标签：xml, xslt-2.0, data-conversion, node-set, nodesets

更新：2012 年 9 月 18 日，下午晚些时候 101.(a) 在这里是额外的，并且是我需要的祖先::*[@belcode] 之上的。它们在下面的 XML 示例中，我无法弄清楚如何不获取它们。

错误的 XML 输出示例：

```
<p style="I24">101.(a)(e)(1)(A) If the Attorney General determines that a licensee under this section has willfully violated any provision of this chapter or any regulation prescribed under this chapter, the Attorney General may&mdash;</p> 
```

XSL 中只有带有 belcode 的 for-each 表现不佳：

```
<xsl:choose>
<xsl:when test="../@display-inline='yes-display-inline'">

<xsl:for-each select="ancestor-or-self::*[@belcode!='' and not(../@belcode/text or ../@belcode/header)]/enum">      
<xsl:value-of select="."/>   
</xsl:for-each> 

<xsl:for-each select="ancestor-or-self::*[@display-inline='yes-display-inline']/enum">      
<xsl:value-of select="."/>   
</xsl:for-each> 
</xsl:when>
<xsl:otherwise>
<xsl:value-of select="../enum"/>
<xsl:text></xsl:text>
</xsl:otherwise>
</xsl:choose> 
```

* * *

更新：2012 年 9 月 18 日我测试了你给我的代码，但我的外部条件不起作用......另外，我使用的是 XSLT 2.0，所以不需要 for-each。

新的 XML 输出不能正常工作（祖先太多），但我*只*在正确的 p 元素上获取它们：

```
<section number="101">
<title style="I72">SEC. 101\. SECTION TITLE.</title>
<p style="I20">(a)cpk2 In General.&mdash;Section 923...</p>
<p style="I20">(e)</p>
<p style="I22">(1)</p>
<p style="I24">&ensp;&ensp;&ldquo;I 101\. (a) (e) (1) (A)cpk1 If the ... may&mdash;</p>
<p style="I26">(i)cpk2 if the violation is of a minor nature&mdash;</p>
</section> 
```

XSLT 代码非常接近，我“认为”它需要更多的工作。我只需要从具有 belcode 属性的第一个祖先获取子枚举元素，然后返回到作为我的文本元素父元素的子元素的枚举。

我想我需要用可以让我回到我想要的顶级祖先的东西替换 value-of 中的 *，我对 XPath/XSLT 还很陌生，并且与语法作斗争。

```
<xsl:choose>
<xsl:when test="../@display-inline='yes-display-inline' and ancestor::*/@belcode[1]">
<xsl:value-of select="ancestor-or-self::*/enum"/>
<xsl:text>cpk1</xsl:text>
</xsl:when>
<xsl:otherwise>
<xsl:value-of select="../enum"/>
<xsl:text>cpk2</xsl:text>
</xsl:otherwise>
</xsl:choose> 
```

* * *

提前感谢您提供任何可能的建议。

如何从子条款文本节点（我保证我没有命名元素文本）向上爬树，直到我到达有代码的祖先，并且没有 display-inline="yes-display -inline”，并获得所有子“枚举”的包容性？途中的所有祖先元素也没有标题或文本子元素，但有一个枚举。（是的，有一个 XML 示例）。

背景：

我已经将 XML**输入**嵌套在 section/subsection/paragraph/subparagraph/clause 中（每个都可以有一个 enum、header、text child），它被展平以 **输出**一个充满“p”的部分，其中使用了不同的样式成为子级别，其中“枚举”、“标题”、“文本”都放入“p”中。

我遇到问题的地方是，在某些情况下，就像我下面的示例一样，只有一个或多个级别的枚举。输出段落应该获得没有“标题”或“文本”的 FIRST 级别的代码属性（转换为样式），以及该级别与具有“文本”的级别之间的所有“枚举”，这就是“p”包装器获得输出，以便适当地进行*展平。*用英文来说，我需要一个 (p style="P20")(e)(1)(A)。

嵌套 XML 输入：

```
<section code="P72">
<enum>101.</enum>
<header>SECTION TITLE.</header>
<subsection code="P20">
<enum>(e)</enum>
<paragraph display-inline="yes-display-inline">
<enum>(1)</enum>
<subparagraph display-inline="yes-display-inline">
<enum>(A)</enum>
<text>If the ... may—&lt;/text>
<clause belcode="I24">
<enum>(i)</enum>
<text>if the violation is of a minor nature—&lt;/text>
</clause>
</subparagraph>
</paragraph>
</subsection>
</section> 
```

期望的输出：

```
<section number="101">
<title style="I72">SEC. 101\. SECTION TITLE.</title>
<p style="I20">(a) In General.&mdash;Section 923...</p>
<p style="I20">(e)(1)(A) If the ... may&mdash;</p>
<p style="I24">(i) if the violation is of a minor nature&mdash;</p>
</section> 
```

我得到的输出：

```
<section number="101">
<title style="I72">SEC. 101\. SECTION TITLE.</title>
<p style="I20">(a) In General.&mdash;Section 923...</p>
<p style="I20">(e)</p>
<p style="I22">(1)</p>
<p style="I24">(A) If the ... may&mdash;</p>
<p style="I26">(i) if the violation is of a minor nature&mdash;</p>
</section> 
```

不起作用的 XSL 代码段：

```
<xsl:template match="//subparagraph/text">
<p><xsl:attribute name="style"><xsl:value-of select="parent::subparagraph/@code"/></xsl:attribute>
<xsl:choose>
<xsl:when test="ancestor::*/enum and not(boolean(ancestor::*/header) or boolean(ancestor::*/text))"><xsl:value-of select="ancestor-or-self::*/enum"/><xsl:text> </xsl:text>
</xsl:when>
<xsl:otherwise>
<xsl:value-of select="../enum"/><xsl:text> </xsl:text>
</xsl:otherwise>
</xsl:choose>
</p><xsl:text>&#10;</xsl:text>
</xsl:when>
</xsl:template> 
```

我意识到这只是 //subparagraph/text 片段，但它是需要显示输出枚举的部分，并且我知道如何停止它们在其他地方显示，一旦我将它们放在我想要的位置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T20:17:42.950

我认为您必须在 XSLT 1.0 中工作，如果`xsl:value-of`元素被赋予多个节点作为参数，它将采用第一个节点的值并忽略其他节点。如果您使用的是 1.0，我想您可能想尝试替换

```
<xsl:when test="ancestor::*/enum 
                and not(boolean(ancestor::*/header) 
             or boolean(ancestor::*/text))">
  <xsl:value-of select="ancestor-or-self::*/enum"/>
  <xsl:text> </xsl:text>
</xsl:when> 
```

和

```
<xsl:when test="ancestor::*/enum 
                and not(boolean(ancestor::*/header) 
                     or boolean(ancestor::*/text))">
  <xsl:for-each select="ancestor-or-self::*/enum">
     <xsl:value-of select="concat(., ' ')"/>
  </xsl:for-each>
</xsl:when> 
```

注意没有测试（并且容易出错：我用`xsl:for-each`的不多，因为我发现我用它犯了很多错误），所以仔细测试。

# php - 列表中的随机产品

> ID：12465486
> 
> 赞同：-3
> 
> 时间：2012-09-17T18:57:23.207
> 
> 标签：php, list, loops, random

> **可能重复：**
> [列表中的 php 循环随机产品](https://stackoverflow.com/questions/12464453/php-loop-random-product-from-the-list)

我需要产品列表，从女巫那里我可以随机显示 4 件商品。

我曾尝试编写 php 代码，但需要语法和变量方面的帮助才能完成。

```
<?php 

// my product list
function productlistX {
    $array = array( 

        $product {$name = 'product name', $link = 'product link', $img = "product image"};
        $product {$name = 'product name', $link = 'product link', $img = "product image"};
        $product {$name = 'product name', $link = 'product link', $img = "product image"};
        $product {$name = 'product name', $link = 'product link', $img = "product image"};
        $product {$name = 'product name', $link = 'product link', $img = "product image"};
        $product {$name = 'product name', $link = 'product link', $img = "product image"};
        $product {$name = 'product name', $link = 'product link', $img = "product image"};
        $product {$name = 'product name', $link = 'product link', $img = "product image"};
        $product {$name = 'product name', $link = 'product link', $img = "product image"};
        $product {$name = 'product name', $link = 'product link', $img = "product image"};
        $product {$name = 'product name', $link = 'product link', $img = "product image"};
        $product {$name = 'product name', $link = 'product link', $img = "product image"};
        $product {$name = 'product name', $link = 'product link', $img = "product image"};
        $product {$name = 'product name', $link = 'product link', $img = "product image"};
        $product {$name = 'product name', $link = 'product link', $img = "product image"};

    )

    // need to display 4 random products from the array above 
    foreach  {
        echo "<li>".$name . $link . $img . "</li>"
    }
}

// display these random products in my ajax tab (products.php?order=mytab)
$data['mytab'] = $productlistX;

if (isset($data[$_GET['order']])) { 
    echo $data[$_GET['order']];
} 
?> 
```

提前致谢！

# mysql - 为什么在 perl Catalyst 的两个克隆实例之一上出现 DBIx“没有这种关系”错误？

> ID：12465489
> 
> 赞同：0
> 
> 时间：2012-09-17T18:57:38.403
> 
> 标签：mysql, perl, web-applications, relationship, catalyst

我在新服务器上复制了一个 Perl Catalyst Web 应用程序，确保 Catalyst、MySQL 和所有必需的 Perl 模块在两台服务器上具有相同的版本。但是当我尝试登录一台服务器时，我不断收到一条奇怪的 DBIx 错误消息。

这是错误。

> [错误] DBIx::Class::ResultSet::search(): No such relationship Committee_members on Committee at /mnt/data/www/apps/org/script/../lib/org/Controller/Users.pm line 57 [调试] 响应码：500；内容类型：文本/html；字符集=utf-8；内容长度：204782

这种关系显然存在于数据库中。其他人遇到过这个问题吗？

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T16:53:51.117

这就是问题所在 - 模块 DBIx::Class::Schema::Loader 不是最新的。

原始版本的催化剂和相关模块可以正常使用代码（使用旧时代的关系/表命名法），但一些模块（不是全部）在此过程中进行了更新，破坏了上述模块的向后兼容性。当它也被更新时，会报告警告并自动解析关系名称（我仍然需要查看详细信息..）。

它能够解决中间版本中遗漏的一些向后兼容性问题。见 [http://metacpan.org/pod/DBIx::Class::Schema::Loader::Manual::UpgradingFromV4](http://metacpan.org/pod/DBIx%3a%3aClass%3a%3aSchema%3a%3aLoader%3a%3aManual%3a%3aUpgradingFromV4)

# xcode - 将以前的文档集和 ios SDK 移至 XCode 4.5

> ID：12465499
> 
> 赞同：4
> 
> 时间：2012-09-17T18:58:05.390
> 
> 标签：xcode, installation

我的 Internet 连接速度很慢，并试图避免下载以前的 XCode 文档集和 SDK。

我刚刚安装了 XCode 4.5，发现它们没有包含任何 iOS 版本的文档集。也只有适用于 iOS 6 的 SDK。

我在 iOS 4.2 及更高版本上部署。我还有许多用于测试的 iOS SDK 和所有文档集。

将我的 4.2、4.3、5.0 等文档集和 SDK 复制到 XCode 4.5 是否有问题？

新的安装位置不同，所以我什至想知道我会将它们移到哪里。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T00:57:12.877

我的旧 Developer 文件夹位于根 HD 文件夹中。不知道这算不算典型。文档集位于此处：HD/Developer/Documentation/DocSets

模拟器位于：HD/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs

不幸的是，我无法让 XCode 4.5 识别我从 XCode 4.2 安装中移动的任何文档集。我不得不让 XCode 4.5 下载它们。

我确实成功地将内容从我的开发人员 XCode 4.5 GM 移动到 AppStore XCode 4.5。

.docset 文件存储在这里：~/Library/Developer/Shared/Documentation/DocSets

无需执行任何操作，因为来自 AppStore 的 XCode 4.5 识别了我使用 XCode 4.5 GM 下载的内容。这是个好消息，因为这意味着未来的 XCode 版本也可能会识别它们。

模拟器文件存储在 XCode.app 本身中：/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/

我刚刚将这些文件夹从 XCode 4.5 GM 复制到 App Store XCode 4.5 到上面的文件夹中：

*   iPhoneSimulator4.3.sdk
*   iPhoneSimulator5.0.sdk
*   iPhoneSimulator5.1.sdk

我的理解是 Xcode 4.5 或更高版本支持的最低部署目标是 iOS 4.3，所以我没有移动任何其他模拟器 SDK。

当然，在导航到 Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/ 文件夹之前，您需要按住 Control 键单击（或鼠标右键单击）XCode 应用程序并选择 Show Package Contents。

当新的 Xcode 发布并且 App Store 安装更新时，我不知道这意味着什么。它会清除我移动的这些 SDK 吗？我已经对修改后的 XCode 4.5 进行了备份，以防它们在通过 App Store 升级 XCode 时丢失。

希望这会有所帮助。

# sql - SQL Server：查找在过程中调用的存储过程

> ID：12465509
> 
> 赞同：5
> 
> 时间：2012-09-17T18:59:05.793
> 
> 标签：sql, sql-server, stored-procedures

我是一家大量使用存储过程（500+）的公司的新手。为了帮助学习系统，我希望有一种简单的方法来构建一个树型列表，显示系统中的所有存储过程以及它们自己调用的存储过程......从而创建一个可以执行的存储过程的映射. 有没有一种简单的方法可以通过 SQL Server 中的查询来做到这一点？有没有可以做到这一点的工具/实用程序？

例如，我想查看以下类型的列表，而不必费力地尝试遵循每个过程中的逻辑并手动制作列表。

```
build_house
  -->pour_foundation
    -->order_cement_truck
  -->frame_house
    -->hire_workers
    -->buy_nails_and_hammers
  -->wire_house
    -->hire_electricians
      -->check_certifications
    -->test_wiring 
```

到目前为止，我发现的唯一内容是：

[http://www.codeproject.com/Articles/10019/Find-Stored-Procedures-called-within-a-procedure](http://www.codeproject.com/Articles/10019/Find-Stored-Procedures-called-within-a-procedure)

需要明确的是，我希望传入/选择一个存储过程名称，并将它调用/使用的所有存储过程都返回给我。

@JackLock，我下载并安装了 SQL Search，但我不明白这如何解决我的问题。此工具有助于按名称搜索存储过程，或搜索存储过程中的文本，但它如何帮助我自动列出从特定存储过程中调用的所有存储过程？也许我错过了什么？例如，在我上面的示例中，我希望能够运行一个系统查询或工具，它返回一个存储过程列表，这些存储过程由我传递给它的任何存储过程名称调用。因此，在示例中，如果我提供查询或工具“build_house”，它将返回示例中的结果。

编辑/更新：

好的，我想尝试通过查询来解决这个问题，但需要一些帮助。我“认为”我想要做的是查询 sys.procedures 以获取系统中所有存储过程的名称。拥有它们后，我想将它们传递给以下查询，以确定从中调用了多少存储过程：

```
SELECT referenced_entity_name
FROM sys.dm_sql_referenced_entities (@ProcName, 'OBJECT') 
```

调用 sys.procedures 返回的每一行都会传入@ProcName。

在 t-sql (2008) 中执行此操作的最有效方法是什么？

在此先感谢，迈克尔

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-09-23T09:15:14.350

您可以在下面的代码中输入特定的程序名称并检查，您将获得其他人使用的特定程序

```
SELECT OBJECT_NAME(id) 
FROM syscomments 
WHERE [text] LIKE '% procedure_or_function_name %' 
GROUP BY OBJECT_NAME(id) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T19:04:10.263

您还没有提到您正在使用哪个版本的 SQL Server。但是 RedGate 有一个名为[SQL Search](http://www.red-gate.com/products/sql-development/sql-search/)的免费实用程序（实际上是 SSMS 插件） 。我让它在 SSMS 2005、2008、R2 和 2012 上工作

它应该可以解决您的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-06-26T01:00:07.043

我知道这个问题已经存在了一段时间，但是我想我找到了一个解决方法，我想分享它，我使用了 Aaron 的 Bertrand 函数来查找文本中的模式和这种[排序](https://social.technet.microsoft.com/wiki/contents/articles/21062.t-sql-hierarchical-table-sorting-with-a-parent-child-relation.aspx)方式，

功能 ：

```
CREATE FUNCTION dbo.FindPatternLocation
(
    @string NVARCHAR(MAX),
    @term   NVARCHAR(255)
)
RETURNS TABLE
AS
    RETURN 
    (
      SELECT pos = Number - LEN(@term) 
      FROM 
      (
        SELECT Number, Item = LTRIM(RTRIM(SUBSTRING(@string, Number, CHARINDEX(@term, @string + @term, Number) - Number)))
        FROM (
                SELECT ROW_NUMBER() OVER (ORDER BY [object_id])
                FROM sys.all_columns) AS n(Number)
            WHERE Number > 1 AND Number <= CONVERT(INT, LEN(@string)+1)
        AND SUBSTRING(@term + @string, Number, LEN(@term)) = @term
        ) 
        AS y
    ); 
```

最终查询：

```
declare @object_name varchar(1000) = 'stored_procedure_name'
; 
with cte as ( 
    SELECT o.name AS parent_object_name
    , SUBSTRING( m.definition, rs_fn.pos+4, CHARINDEX( ' ' , stuff( m.definition, 1, rs_fn.pos + 4 , '' )) ) as child_object
    , cast(row_number()over(partition by o.object_id order by o.name) as varchar(max)) as [path]
    , 0 as level
    , row_number()over(partition by o.object_id order by o.name) / power(10.0,0) as x
    FROM sys.sql_modules m 
    INNER JOIN sys.objects o ON m.object_id = o.object_id 
    cross apply ( 
        select * 
        from dbo.FindPatternLocation( m.definition, 'EXEC ' ) as res
    ) as rs_fn
    WHERE 1=1
    and o.name like @object_name
    union all 
    SELECT o.name AS parent_object_name
    , SUBSTRING( m.definition, rs_fn.pos+4, CHARINDEX( ' ' , stuff( m.definition, 1, rs_fn.pos + 4 , '' ))  ) as child_object
    , [path] +'-'+ cast(row_number()over(partition by o.object_id order by o.name) as varchar(max))
    , level+1 
    , c.x + row_number()over(partition by o.object_id order by o.name) / power(10.0,level+1)
    FROM sys.sql_modules m 
    INNER JOIN sys.objects o ON m.object_id = o.object_id 
    inner join cte c on c.child_object = o.name
    cross apply ( 
        select * 
        from dbo.FindPatternLocation( m.definition, 'EXEC ' ) as res
    ) as rs_fn
    WHERE 1=1
    -- and o.name like @object_name
) 

select * from cte 
order by x
; 
```

随意使用它。

# f# - 如何使这个简单的递归关系（差分方程）尾递归？

> ID：12465510
> 
> 赞同：2
> 
> 时间：2012-09-17T18:59:12.010
> 
> 标签：f#, tail-recursion

```
let rec f n =
    match n with
    | 0 | 1 | 2 -> 1
    | _ -> f (n - 2) + f (n - 3) 
```

如果没有 CPS 或 Memoization，怎么能做到尾递归呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T19:47:12.447

```
let f n = Seq.unfold (fun (x, y, z) -> Some(x, (y, z, x + y))) (1I, 1I, 1I)
          |> Seq.nth n 
```

甚至更好：

```
let lambda (x, y, z) = x, (y, z, x + y)
let combinator = Seq.unfold (lambda >> Some) (1I, 1I, 1I)
let f n = combinator |> Seq.nth n 
```

要了解这里发生了什么，请参阅[此](https://stackoverflow.com/questions/35940/elegant-snippets-of-f/3763473#3763473)代码段。它定义了斐波那契算法，和你的非常相似。

*UPD*这里包含三个组件：

1.  得到第-个元素的**lambda ；**`i`
2.  运行递归的**组合**`i`器；和
3.  启动整个运行然后获取值的**包装器（从三元组中，就像在@Tomas 的代码中一样）。**

你已经要求一个尾递归代码，实际上有两种方法：制作你自己的组合器，就像@Tomas 所做的那样，或者利用现有的组合器，`Seq.unfold`这肯定是尾递归的。我更喜欢第二种方法，因为我可以将整个代码拆分为一组`let`语句。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-17T20:51:14.787

@bytebuster 的解决方案很好，但他没有解释他是如何创建它的，所以它只有在你解决这个特定问题时才会有所帮助。顺便说一句，您的公式看起来有点像斐波那契（但不完全是），它可以在[没有任何循环的情况下进行分析计算](http://www.maths.surrey.ac.uk/hosted-sites/R.Knott/Fibonacci/fibFormula.html)（即使没有隐藏在 中的循环`Seq.unfold`）。

您从以下功能开始：

```
let rec f0 n = 
  match n with 
  | 0 | 1 | 2 -> 1 
  | _ -> f0 (n - 2) + f0 (n - 3) 
```

该函数需要`f0`参数`n - 2`和`n - 3`，因此我们需要知道这些值。诀窍是使用[动态编程](http://en.wikipedia.org/wiki/Dynamic_programming)（可以使用 memoization 完成），但由于您不想使用 memoization，我们可以手动编写。

我们可以编写`f1 n`which 返回一个三元素元组，其当前值和两个过去值值为`f0`。这意味着`f1 n = (f0 (n - 2), f0 (n - 1), f0 n)`：

```
let rec f1 n = 
  match n with 
  | 0 -> (0, 0, 1)
  | 1 -> (0, 1, 1)
  | 2 -> (1, 1, 1)
  | _ -> 
    // Here we call `f1 (n - 1)` so we get values
    //   f0 (n - 3), f0 (n - 2), f0 (n - 1)
    let fm3, fm2, fm1 = (f1 (n - 1))
    (fm2, fm1, fm2 + fm3) 
```

这个函数不是尾递归，而是只递归调用自己*一次*，这意味着我们可以使用累加器参数模式：

```
let f2 n =
  let rec loop (fm3, fm2, fm1) n = 
    match n with 
    | 2 -> (fm3, fm2, fm1)
    | _ -> loop (fm2, fm1, fm2 + fm3) (n - 1)
  match n with
  | 0 -> (0, 0, 1)
  | 1 -> (0, 1, 1)
  | n -> loop (1, 1, 1) n 
```

我们需要处理参数`0`，`1`特别是在`fc`. 对于任何其他输入，我们从初始三个值（即`(f0 0, f0 1, f0 2) = (1, 1, 1)`）开始，然后循环 n 次执行给定的递归步骤，直到达到 2。递归`loop`函数是 @bytebuster 的解决方案使用 实现的`Seq.unfold`。

因此，您的函数有一个尾递归版本，但这仅仅是因为我们可以简单地将过去的三个值保留在一个元组中。通常，如果计算您需要哪些先前值的代码执行更复杂的操作，这可能是不可能的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-18T00:18:13.230

甚至比尾递归方法更好，您可以利用矩阵乘法来减少使用 O(log *n* ) 操作的解决方案的任何递归。我把正确性的证明留给读者作为练习。

```
module NumericLiteralG =
    let inline FromZero() = LanguagePrimitives.GenericZero
    let inline FromOne() = LanguagePrimitives.GenericOne

// these operators keep the inferred types from getting out of hand
let inline ( + ) (x:^a) (y:^a) : ^a = x + y
let inline ( * ) (x:^a) (y:^a) : ^a = x * y

let inline dot (a,b,c) (d,e,f) = a*d+b*e+c*f
let trans ((a,b,c),(d,e,f),(g,h,i)) = (a,d,g),(b,e,h),(c,f,i)
let map f (x,y,z) = f x, f y, f z

type 'a triple = 'a * 'a * 'a
// 3x3 matrix type
type 'a Mat3 = Mat3 of 'a triple triple with
    static member inline ( * )(Mat3 M, Mat3 N) = 
        let N' = trans N
        map (fun x -> map (dot x) N') M
        |> Mat3
    static member inline get_One() = Mat3((1G,0G,0G),(0G,1G,0G),(0G,0G,1G))
    static member (/)(Mat3 M, Mat3 N) = failwith "Needed for pown, but not supported"

let inline f n =
    // use pown to get O(log n) time
    let (Mat3((a,b,c),(_,_,_),(_,_,_))) = pown (Mat3 ((0G,1G,0G),(0G,0G,1G),(1G,1G,0G))) n
    a + b + c

// this will take a while...
let bigResult : bigint = f 1000000 
```

# android - Android 4x1 小部件尺寸

> ID：12465512
> 
> 赞同：0
> 
> 时间：2012-09-17T18:59:14.770
> 
> 标签：android, widget

我正在开发一个支持小部件尺寸 4x1、4x2 和 5x2 的应用程序。一切都很好，除了 4x1 小部件采用 4x2 小部件的大小。我检查了小部件提供文件，它似乎没问题：

布局也很好（我已经尝试按照其他人的建议将其宽度和高度更改为 fill_parent ）但是无论我做什么，当我将它放在主屏幕上时，它的大小为 4x1，但它垂直居中于 4x2 大小屏幕上。就像布局的大小是正确的（我添加了背景颜色以查看它的高度），但是有些东西迫使小部件的大小为 4x2。

任何人都知道问题可能是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T19:04:06.270

对于小部件，minWidth 和 minHeight 必须为每 1x1 块 72 dp。你很可能有 72 dp 以外的东西，而 144 和 73 dp 之间的所有东西都使它使用 2 个方块而不是 1 个方块。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-03-15T03:25:48.630

可能是迟到的回复，但 Google 似乎已将 Widget Dimension 的公式更改为 (n * 70) - 30。

[http://developer.android.com/guide/practices/ui_guidelines/widget_design.html#anatomy_determining_size](http://developer.android.com/guide/practices/ui_guidelines/widget_design.html#anatomy_determining_size)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-22T08:31:40.953

将 minHeight 值设置为 40dp 解决了这个问题。

# javascript - 我可以使用数字、可能相等（非唯一）键的 URL 查询吗？

> ID：12465513
> 
> 赞同：2
> 
> 时间：2012-09-17T18:59:16.173
> 
> 标签：javascript, query-string

我正在构建一个 HTML5 单页应用程序，我希望允许用户保留当前应用程序状态以供以后使用。我想通过使用特制查询部分创建指向我的页面的链接 URL 来实现这一点。当再次使用 URL 调用时，应用程序将解析查询部分并重新创建存储的状态。

现在，状态的某些部分是一个列表，其项目是数值和相关的文本。浮点数值以及文本不需要是唯一的。

像这样：

```
4.54  first
12.1  another
12.1  more
34    more 
```

我的意图是创建一个这样的 URL：

```
www.myappdomain.com/SinglePage.html?4.54=first&12.1=another&12.1=more&34=more 
```

**这是合法的网址吗？给定文本的正确编码，这会在野外工作吗？**

我已阅读[Alan Skorkin 的 What Every Developer Should Know About URLs](http://www.skorks.com/2010/05/what-every-developer-should-know-about-urls/)，我通常可以推荐有关 URL 的内容以及[有关 URL 字符使用的答案](https://stackoverflow.com/a/1455639/79485)。

对我来说，这样做似乎是合法的，但我仍然感到有点不舒服，因为我还没有找到关于我可能拥有的可能非唯一键以及关于一般查询部分中作为键的数字的信息。

编辑：我已经把它带到了工作中，见下文（如果链接中断，请告诉我）： http://quir.li/player.html?media=http%3A%2F%2Fwww.youtube.com%2Fwatch% [3Fv %3D0VqTwnAuHws&title=What%20makes%20you%20beautiful&artist=%20piano%20guys%20covering%20One%20Republic&album=Youtube&6.49=Intro&30.12=Knocking%20part&46.02=Real%20playing&51.5=Piano%20forte&93.32=Stringified& .35=人声&139.38=Key%20cover%20jam&150.16=Good%20morning%20sky&173.96=Final%20chord](http://quir.li/player.html?media=http%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3D0VqTwnAuHws&title=What%20makes%20you%20beautiful&artist=The%20piano%20guys%20covering%20One%20Republic&album=Youtube&6.49=Intro&30.12=Knocking%20part&46.02=Real%20playing&51.5=Piano%20forte&93.32=Stringified&123.35=Vocals&139.38=Key%20cover%20jam&150.16=Good%20morning%20sky&173.96=Final%20chord)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T19:19:28.087

这是 URI 规范的合法 URL - [https://www.rfc-editor.org/rfc/rfc3986](https://www.rfc-editor.org/rfc/rfc3986)。然而，这是否会在野外工作是一个不同的问题，因为规范只定义了 URI 的通用语法。

由于没有关于查询部分中的重复键应该做什么的规范（请参阅[重复 HTTP GET 查询键的权威位置](https://stackoverflow.com/questions/1746507/authoritative-position-of-duplicate-http-get-query-keys)）不同的软件框架会以不同的方式处理这些 URI。但是，大多数框架会正确地将重复键检测为具有相同键的多个值，并将这些值分组到给定键的单个数组/值列表中（而不是使用给定键的最后一个值并丢弃所有先前的值）那把钥匙）。使用数字作为键也可以，因为键被解析为文本字符串。简而言之：你应该是安全的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T19:11:32.433

我不认为这是传递数据的好方法，查询字符串参数通常被视为可以通过其名称访问的参数，这里您实际上将一些数据作为参数传递，而从技术角度来看，这可以做到代码有些混淆，我会使用 JSON 编码在单个参数中传递这些数据

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T19:46:42.400

这篇文章表明没有规范说非唯一键是无效的。

[重复 HTTP GET 查询键的权威位置](https://stackoverflow.com/questions/1746507/authoritative-position-of-duplicate-http-get-query-keys)

我似乎找不到任何关于数字键的具体内容。

However, this might be a workaround if you don't want to use non-unique numeric keys for any reason: Use some basic encoding to map numbers to strings. Something basic could be 1-a, 2-b, 3-c, 4-d...9-i, 0-j. And '.' could be 'k' (if there is not spec about whether '.' is a legal character in a URL parameter) Then, e.g., `21.3` would encode to `bakc`. Also you can add a number in the end of the encoded key to ensure that keys are unique. These numbers would be ignored while decoding (or could help differentiate between the parameters). Then the first 21.3 would encode to bakc1, the next bakc2 etc)

# ruby - 编译 Ruby C 扩展时如何静态链接外部库

> ID：12465514
> 
> 赞同：3
> 
> 时间：2012-09-17T18:59:23.000
> 
> 标签：ruby, windows, static-linking, ruby-c-extension, extconf.rb

我正在 Windows 上构建一个 Ruby C 扩展，它需要一些外部 C 库，特别是 libcurl 及其依赖项。我有 curllib dll 和 .a 文件。但是，当我使用 extconf.rb 构建时，它总是动态链接库，这需要有人安装 curl 并在他们的 Windows 路径中使用已编译的扩展。相反，我希望 extconf.rb 静态链接 curl 及其依赖项，以便任何人都可以在 windows 上使用扩展，而无需先将 curllib 添加到他们的路径中。

这是我的 extconf.rb

```
require 'mkmf'

# Name the extension.
extension_name = 'ConnectionManager'
dir_config("curl")

# Make sure the cURL library is installed.
have_library("curl")

# Create the Makefile.
create_makefile(extension_name) 
```

这是我生成我的makefile的命令

```
ruby extconf.rb --with-curl-dir=C:/Knapsack/x86-windows 
```

有什么我可以添加到我的 extconf.rb 文件或命令来强制 ruby​​ 将外部库静态链接到我的 c 扩展的东西吗？任何帮助将不胜感激，如果您需要更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-05-14T11:25:23.403

我在 linux 上使用 gif_lib 编写本机扩展时遇到了类似的问题。

尝试将以下内容添加到您的 extconf.rb：

```
unless find_library("curl", "curl_version")
  abort "curl is not installed, please install and try again"
end 
```

如果库和入口点存在，find_library 函数返回 true，并且具有将其添加到 gcc 的 -l 选项的副作用。

我发现这些链接很有用： http: [//tenderlovemaking.com/2010/12/11/writing-ruby-c-extensions-part-2.html](http://tenderlovemaking.com/2010/12/11/writing-ruby-c-extensions-part-2.html)

这是 C 扩展（一个工作示例）： [https ://github.com/egr-ellis/ruby-giflib](https://github.com/e-g-r-ellis/ruby-giflib)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T12:33:02.647

当我使用 Visual Studio Express 构建我的 Ruby C 扩展时`nmake`，我必须将编译器标志从 更改`-MD`为`-MT`以避免对 MSVCRT 的依赖。

我在我的文件 中设置了`$CFLAGS`变量。不确定这是否是修改这些标志的正确方法，但它确实有效。`extconf.rb``$CFLAGS = '-MT -Ot -Ox -W4'`

[https://bitbucket.org/thomthom/sketchup-ruby-c-extension/commits/3e87351be87f177b8ed43798587f6e798064492d](https://bitbucket.org/thomthom/sketchup-ruby-c-extension/commits/3e87351be87f177b8ed43798587f6e798064492d)

# multithreading - 信号丢失

> ID：12465515
> 
> 赞同：0
> 
> 时间：2012-09-17T18:59:30.117
> 
> 标签：multithreading, multiprocessing

我有这个信号丢失的问题。我的意思是我有这个系统，其中信号由子进程生成并由父进程的其他子进程接收。我已经使用 sigwait 和 sigprocmask 来实际阻塞然后等待信号接收子进程中的信号，而不是注册异步处理程序。

现在当我运行这个系统时。我可以看到，最初，子进程生成的信号被接收子进程阻塞，然后使用 sigwait 他们实际处理这些挂起的信号。因此信号处于待处理状态，然后使用 sigwait 获取，然后继续。

但是随着时间的流逝，我可以看到信号的消耗量不如以前。我的意思是产生了很多信号，并且接收进程没有处理它们。如果我有很多信号未决，是否有可能导致信号丢失？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T19:10:26.220

未决信号没有排队，如果您不明确检查或处理它们，这将导致它们丢失。这就是为什么您应该检查所有孩子是否终止。

资料来源：[链接到一些旧的讲座材料。](http://www.thefengs.com/wuchang/work/courses/cs201/slides/17ExceptionsSyscallsII.pdf)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T19:12:16.623

只有实时信号（介于`SIGRTMIN`和之间的信号`SIGRTMAX`），如果您的操作系统支持它们，则保证被排队（最多`SIGQUEUE_MAX`排队信号）。如果接收进程已经有一个具有相同代码的未决信号，则其他信号可能会丢失。

从规范中[`sigaction`](http://pubs.opengroup.org/onlinepubs/7908799/xsh/sigaction.html)：

> 如果生成了后续出现的未决信号，则取决于实现依赖于在实时信号扩展选项下需要排队的情况之外的情况下是否多次传递或接受信号。

# jekyll - 对于 Liquid 中的循环：将 reversed 与 limit:1 结合使用

> ID：12465521
> 
> 赞同：20
> 
> 时间：2012-09-17T18:59:58.360
> 
> 标签：jekyll, liquid

我正在使用 Jekyll 构建一个简单的博客，我正在努力解决这个问题。

该网站的索引页面旨在展示一篇最新的文章，其结构如下所示（请原谅混乱）：

```
{% for post in site.posts reversed limit:1 %}
    <div class="post">
        <div class="post-inner">
            <h3 class="posttitle"><a href="{{ post.url }}">{{ post.title }}</a></h3>
            <p class="postdate">{{ post.date | date: "%d %B %Y" }}</p>
            {{ post.content }}
            <a href="{{ post.url }}#disqus_thread" class="commentLink"></a>
        </div>
    </div>
{% endfor %} 
```

当限制不受限制（即不存在或设置为数组的长度）时，上述模板可以正常工作。似乎只有当限制*实际上*限制了循环忽略的结果时才会反转。

我试过清除浏览器缓存，这就是它不受限制地工作的原因：1，但进度到此为止。

感谢您的帮助，如果这还不够，我很乐意提供更多详细信息。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-09-24T23:20:51.573

Jekyll 实际上为你输出了什么？

据我了解，最后应用了反向过滤器。因此，假设您发布了 8 月的前 15 天，还假设您执行了以下操作：

```
{% for post in site.posts limit:5 %}
    {{ post.content }}
{% endfor %} 
```

您发布的数组将按以下模式排序

[8月15日、8月14日、8月13日、8月12日、8月11日]

然后如果你把它倒过来

```
{% for post in site.posts reversed limit:5 %}
    {{ post.content }}
{% endfor %} 
```

您发布的数组将按以下模式排序

[8月11日、8月12日、8月13日、8月14日、8月15日]

说了这么多，我对你为什么不使用有点困惑

```
{% for post in site.posts limit:1 %} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2015-04-06T11:20:46.453

黑客通过自定义字段进行自定义反向排序并限制：

```
{% assign items = site.items | sort: 'some_field' | reverse %}
{% for item in items limit:10 %}
    <li><a href="{{ item.url }}">{{ item.title }}</a></li>
{% endfor %} 
```

分配给一些自定义变量很重要，在那里排序（和反向），然后才循环限制。

# php - 在选择中设置选定的值

> ID：12465523
> 
> 赞同：1
> 
> 时间：2012-09-17T19:00:08.327
> 
> 标签：php, jquery, select, joomla

我的表单中有很多选择框。每个人都有相同的选择，但我不知道如何设置应该选择的值。

这是我的代码：

```
function addSelect(id,id_status)
    {

        $('#sel_'+id)
        .find('option')
        .remove()
        .end();

        $.ajax({
            type: "POST",
            url: "",
            data:{
                option: 'com_zamowienia',
                view: 'zamowienia_lista',
                task: 'getStatusy'
            },
            success: function(data){

                var obj = $.parseJSON(data);         
                var tabela = [];
                for (x=0; x<obj.length; x++) {
                    tabela[x] =  
                        obj[x].nazwa;    

                }
                var zmienna =0;
                $.each(tabela, function(key, value) {
                    $('#sel_'+id)
                    .append($('<option>', { value : obj[zmienna].id_status})

                    .text(tabela[zmienna])
                    .css("color", "#"+obj[zmienna].kolor)

                ); 

                    zmienna++;
                });
               $('#sel_'+id).eq(id_status).attr('selected', 'selected')

            }
        }); 
```

我像这样使用这个功能：

```
for(x=0;x<obj.length; x++)
                    {
                        id = obj[x].id_produkt_lista;   
                        id_status =  obj[x].id_status;

                        $("#tab").find('tbody').append(
                        "<tr id='"+id+"'><td id ='' class =''>"+obj[x].nazwa_produkt+"</td>"
                            +"<td id=''>"
                            +"<select class = 'sel_' id='sel_"+id+"' id="+id+" ></select>"   
                            +"</td>" 
                            +"</tr> ");   

                               addSelect(id,id_status);
                            //$('#sel_'+id).eq(id_status).attr('selected', 'selected');
                    } 
```

id -> id sleectbox id_status 它的值应该被选择为具有 id = "#sel_"+id 的选择

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T10:21:04.393

如果您知道这种情况下的“值”（id_status），那么最快的方法是将值设置为给定的选择框：

```
$('#sel_' + id).val(id_status); 
```

# php - 我们如何在 sugarcrm 中以编程方式将文件上传到上传文件夹

> ID：12465525
> 
> 赞同：2
> 
> 时间：2012-09-17T19:00:08.853
> 
> 标签：php, html, file-upload, upload, sugarcrm

我正在使用 Sugar Pro 6.4，在自定义视图中，我想在 sugarcrm 的上传文件夹中上传一个文件。为此，我使用标准输入类型 =“文件”。

```
<input name="file" type="file" /> 
```

用户可以成功选择文件，但是如何以编程方式将所选文件上传到 Sugarcrm 目录结构中的 Upload 文件夹中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T17:03:29.683

在必要时更改字段名后尝试此操作

```
<?php

require_once('include/upload_file.php');

$upload_file = new UploadFile('uploadfile');
$do_final_move = 0;
if (isset($_FILES['uploadfile']) && $upload_file->confirm_upload())
{
  $this->bean->filename = $upload_file->get_stored_file_name();
  $this->bean->file_mime_type = $upload_file->mime_type;

  $do_final_move = 1;
}
$this->bean->save();
if ($do_final_move)
{
  $upload_file->final_move($this->bean->id);
}

?> 
```

# c# - 使用 lambda 表达式获取数组中的值

> ID：12465526
> 
> 赞同：1
> 
> 时间：2012-09-17T19:00:13.447
> 
> 标签：c#, arrays, lambda, indexing

好吧，这就是交易。我正在进行数据转换，我从两个数据库中获取数据并将其放入另一个数据库。我正在添加一个联系人列表，然后我正在添加一个通信记录列表。为了简化这个过程，我把所有的通讯记录和联系人的家庭地址做了一个小数组。现在我正在尝试使用 lambda 表达式从数组中整理出电子邮件地址，但我遇到了问题。到目前为止的代码如下：

```
 DataRow[] Comms = dtComms.Select("household_id = " + previousID);

            if (Comms.Where(x => x.Field<string>("communication_type") == "Home Phone").Count() > 0)
            {
                string HomePhone = rNDigits.Replace(Comms[0].Field<string>("communication_value").ToString().Trim(), "");
                if (HomePhone.Length > 6)
                    oAddress._Phone = HomePhone;
            }
            if (Comms.Where(x => x.Field<string>("communication_type") == "Email").Count() > 0)
            {
                string FamilyEmail = rNDigits.Replace(Comms[0].Field<string>("communication_value").ToString().Trim(), "");
                if (FamilyEmail.Contains('@') && FamilyEmail.Contains('.'))
                    oAddress._FamilyEmail = FamilyEmail;
            } 
```

问题是，很明显，这总是会返回数组中的第一个值，这可能并不总是我想要的。如何更改代码以使其仅从数组中选择与包含电子邮件的条目匹配的值？或者，有没有更好的方法来搜索数组中的值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T19:03:57.603

我建议在这种情况下使用简单的 for 或 foreach 循环，LINQ 不能修改数据，只能选择它。

# c# - 使用 MonoMac 创建一个简单的 NSOutlineView 数据源

> ID：12465528
> 
> 赞同：6
> 
> 时间：2012-09-17T19:00:22.837
> 
> 标签：c#, cocoa, mono, nsoutlineview, monomac

我似乎无法弄清楚如何创建一个具有 2 列的简单 NSOutlineView，以及一个深度超过 1 级的数据结构（层次结构）。

我已经研究了好几天了，我能找到的只是Objective C示例，我真的不能用于任何事情。

我知道这样做有不同的模式，一种是 DataSource 模式。我尝试创建一个继承自 NSOutlineViewDataSource 的类，但这就是我所得到的，我不知道接下来应该做什么！

假设我想在我的 NSOutlineView 中显示以下类：

```
public class Person
{
    public string Name {get;set;} // First column
    public int Age {get;set} // Second column
    public List<Person> Children {get;set} // Children
} 
```

实现这一目标最简单的方法是什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-20T17:32:37.353

## 振作起来……MonoMac 中与级别无关的 NSOutlineView！

经过数百次谷歌搜索，并查看了 ObjC 和 C# 代码，我终于想出了如何去做！我会在这里发布我的解决方案，以防其他人需要它。

*这可能是也可能不是最好的方法，但它对我有用。*

* * *

**第 1 步**：在 Interface Builder 中，添加一个 NSOutlineView。向其中添加 2 列，并将它们的 Identifier 设置为`colName`, 和`colAge`。

此外，当您使用它时，请在表单中添加一个按钮。

* * *

**第 2 步**：为 NSOutlineView 创建一个插座 - 我之所以叫我的插座，是`lvMain`因为我来自 VCL 背景。此外，为您的按钮创建一个操作（这将是 onClick 处理程序）。

* * *

**第 3 步：**保存您的 XIB 文件，然后返回 Mono - 它会更新您的项目文件。现在，我们要创建希望用于视图的模型。

对于这个例子，我将使用一个简单的 Person 对象：

```
public class Person:NSObject
{
    public string Name {
        get;
        set;
    }

    public int Age {
        get;
        set;
    }

    public List<Person> Children {
        get;
        set;
    }

    public Person (string name, int age)
    {
        Name = name;
        Age = age;
        Children = new List<Person>();
    }
} 
```

那里没有什么太复杂的地方。

* * *

**第 4 步：**创建数据源。对于这个例子，这就是我所做的：

```
public class MyDataSource:NSOutlineViewDataSource
{
    /// The list of persons (top level)
    public List<Person> Persons {
        get;
        set;
    }
    // Constructor
    public MyDataSource()
    {
        // Create the Persons list
        Persons = new List<Person>();
    }

    public override int GetChildrenCount (NSOutlineView outlineView, NSObject item)
    {
        // If the item is not null, return the child count of our item
        if(item != null)
            return (item as Person).Children.Count;
        // Its null, that means its asking for our root element count.
        return Persons.Count();
    }

    public override NSObject GetObjectValue (NSOutlineView outlineView, NSTableColumn forTableColumn, NSObject byItem)
    {
        // Is it null? (It really shouldnt be...)
        if (byItem != null) {
            // Jackpot, typecast to our Person object
            var p = ((Person)byItem);
            // Get the table column identifier
            var ident = forTableColumn.Identifier.ToString();
            // We return the appropriate information for each column
            if (ident == "colName") {
                return (NSString)p.Name;
            }
            if (ident == "colAge") {
                return (NSString)p.Age.ToString();
            }
        }
        // Oh well.. errors dont have to be THAT depressing..
        return (NSString)"Not enough jQuery";
    }

    public override NSObject GetChild (NSOutlineView outlineView, int childIndex, NSObject ofItem)
    {
        // If the item is null, it's asking for a root element. I had serious trouble figuring this out...
        if(ofItem == null)
            return Persons[childIndex];
        // Return the child its asking for.
        return (NSObject)((ofItem as Person).Children[childIndex]);
    }

    public override bool ItemExpandable (NSOutlineView outlineView, NSObject item)
    {
        // Straight forward - it wants to know if its expandable.
        if(item == null)
            return false;
        return (item as Person).Children.Count > 0;
    }
} 
```

* * *

**第 5 步 - 最好的一步：**绑定数据源并添加虚拟数据！我们还想在每次添加新元素时刷新我们的视图。这可能可以优化，但我仍然在“哦，我的上帝它的工作”区域，所以我目前不在乎。

```
 // Our Click Action
    partial void btnClick (NSObject sender)
    {
        var p = new Person("John Doe",18);
        p.Children.Add(new Person("Jane Doe",10));
        var ds = lvMain.DataSource as MyDataSource;
        ds.Persons.Add(p);
        lvMain.ReloadData();
    }

    public override void AwakeFromNib ()
    {
        base.AwakeFromNib ();
        lvMain.DataSource = new MyDataSource();

    } 
```

* * *

我希望这些信息可以帮助像我这样的 MonoMac 新人的困扰。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-14T01:44:26.427

我花了一点时间来追踪这个，但**Xamarin 有一个如何做到这一点的例子[这里](http://docs.xamarin.com/samples/OutlineView/)**

# ruby-on-rails - Rails Scaffold 破坏未按预期工作

> ID：12465531
> 
> 赞同：0
> 
> 时间：2012-09-17T19:00:26.153
> 
> 标签：ruby-on-rails

我正在向负责用户注册的模型添加唯一性验证。用户名应该是唯一的。几天前我在测试时创建了一个用户，我们称之为“example-guy”。然后我从脚手架用户界面中删除了他，现在当尝试将新用户注册为“example-guy”时，它返回该名称已被占用。那么如何在不恢复到其“出生状态”的情况下从数据库中修复此问题并修改控制器以实际销毁表条目？

或者，Rails 是否正在跟踪写入 DB 的内容，即使在销毁之后也是如此？

我使用omniauth-identity，用户模型：

```
class User < ActiveRecord::Base
  attr_accessible :name, :provider, :uid, :email
  # This is a class method, callable from SessionsController
  # hence the "User."
  def User.create_with_omniauth(auth)
    user = User.new()
    user.provider = auth["provider"]
    user.uid = auth["uid"]
    user.name = auth["info"]["name"]
    # ADD EMAIL
    user.email = auth["info"]["email"]
    user.save
    return user
  end
end 
```

用户控制器的销毁功能：

```
 # DELETE /users/1
  # DELETE /users/1.json
  def destroy
    @user = User.find(params[:id])
    @user.destroy

    respond_to do |format|
      format.html { redirect_to users_url }
      format.json { head :no_content }
    end
  end
end 
```

验证是通过从omniauth的活动记录继承的“身份”模型进行的：

```
class Identity < OmniAuth::Identity::Models::ActiveRecord
  attr_accessible :email, :name, :password_digest, :password, :password_confirmation
  #attr_accessible :email, :name, :password_digest :password, :password confirmation
  validates_presence_of :name
  validates_uniqueness_of :name
  validates_length_of :name, :in => 6..24
  validates_format_of :name, :with => /^[a-z]+$/
  validate :name_blacklist

  validates_uniqueness_of :email, :case_sensitive => false
  validates_format_of :email,
  :with => /\A([^@\s]+)@((?:[-a-z0-9]+\.)+[a-z]{2,})\Z/i,
  :message => "doesn't look like a proper email address"
  #validates_presence_of :password, on: :create
  #validates_presence_of :password_confirmation
  validates_length_of :password, :in => 6..24

  def name_blacklist
    unless self.name.blank? then
      case self.name
      when "user", "photo", "photos",
        "application", "sessions",
        "identities", "home"
          self.errors.add(:name, "prohibited")
      end
    end
  end
end 
```

身份控制器管理发送到omniauth 并调用new.html.erb 的注册表单：

```
class IdentitiesController < ApplicationController
  def new
    @identity = env['omniauth.identity']
  end
end 
```

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T10:41:06.970

我不完全确定导致问题的原因，但我遇到了类似的问题，但电子邮件地址是基于 Devise 的用户。

我想在不同的用户上重复使用相同的电子邮件。我将原始用户更改为另一封电子邮件，但是当我尝试使用“现在唯一”电子邮件更新第二个用户时，它未能通过唯一验证。

使用该电子邮件对用户进行查询没有返回任何结果。

它似乎与唯一性约束有关的缓存，因为在删除电子邮件地址后重新启动服务器，解决了这个问题。

# jquery - 滚动时将侧边栏框锁定到窗口顶部

> ID：12465534
> 
> 赞同：2
> 
> 时间：2012-09-17T19:00:41.423
> 
> 标签：jquery, scroll, fixed, css-position

我正在尝试使用 jQuery 创建一个功能，您可以在侧边栏中的 div 上设置一个类（例如“密码箱”），并且当您滚动它们时它们将锁定到窗口顶部。

但我想在侧边栏中实现几个不同的框，当你滚动它们时它们会相互推开。我可以使用的最好的比较是与 iPhone 联系人应用程序，每个字母 AZ 都有一个锁定在顶部的标题栏。但是当您滚动过去 A 时，该栏会被推出以供 B 标题栏填写。这是我正在谈论的屏幕截图：

![联系人应用截图](../Images/01255ad9104d51b55191ded7ab975790.png)

创建此类功能的最佳技术是什么？我对 jQuery 很熟悉，但我从来没有使用过像 .offset() 这样的属性，所以我什至在构建这个接口的第一步都在苦苦挣扎。

提前感谢任何帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T21:51:56.543

我创建了一个工作小提琴。[链接](http://jsfiddle.net/wKvjc/6/)。

**HTML：**

```
<html>
<head></head>
<body>
    <div id="outer_div">
    <div class="lockdiv">Div A</div>
    <div class="lockdivcontent">
        <div class="regular">Text A 1</div>
        <div class="regular">Text A 2</div>
        <div class="regular">Text A 3</div>
        <div class="regular">Text A 4</div>
    </div>
    <div class="lockdiv">Div B</div>
    <div class="lockdivcontent">
        <div class="regular">Text B 1</div>
        <div class="regular">Text B 2</div>
        <div class="regular">Text B 3</div>
        <div class="regular">Text B 4</div>
    </div>
    <div class="lockdiv">Div C</div>
    <div class="lockdivcontent">
        <div class="regular">Text C 1</div>
        <div class="regular">Text C 2</div>
        <div class="regular">Text C 3</div>
        <div class="regular">Text C 4</div>
    </div>
    <div class="lockdiv">Div D</div>
    <div class="lockdivcontent">
        <div class="regular">Text D 1</div>
        <div class="regular">Text D 2</div>
        <div class="regular">Text D 3</div>
        <div class="regular">Text D 4</div>
    </div>
    <div class="lockdiv">Div E</div>
    <div class="lockdivcontent">
        <div class="regular">Text E 1</div>
        <div class="regular">Text E 2</div>
        <div class="regular">Text E 3</div>
        <div class="regular">Text E 4</div>
    </div>
    <div class="lockdiv">Div F</div>
    <div class="lockdivcontent">
        <div class="regular">Text F 1</div>
        <div class="regular">Text F 2</div>
        <div class="regular">Text F 3</div>
        <div class="regular">Text F 4</div>
    </div>
    <div>
</body>
</html>​ 
```

**Javascript：**

```
$(document).ready(function() {

    $('#outer_div').scroll(function(){

        $('.lockdivcontent').each(function(){
            var top = $(this).offset().top;
            var lockdiv = $(this).prev();
            if(top<lockdiv.height() && top>-1*($(this).height())) {
               lockdiv.offset({top:1});
            } else {
                lockdiv.offset({top:top-lockdiv.height()-1});
            }
        });

    });            
}); 
```

**​CSS：**

```
#outer_div {
    width: 90%;
    height: 300px;
    overflow-y: auto;
    overflow-x: hidden;
    border: 1px solid lightgray;
    padding: 0 10px;
}

.lockdiv {
    width: 100%;
    background-color: lightgray;
    border: 1px solid;
    height: 20px;
}

.regular {
    width: 100%;
    background-color: #FAFAFA;
    height: 20px;
}
​ 
```

看看有没有帮助！

# nhibernate - NHibernate：使用“反向”和内连接连接映射

> ID：12465536
> 
> 赞同：0
> 
> 时间：2012-09-17T19:00:52.930
> 
> 标签：nhibernate, join, nhibernate-mapping, inner-join

我必须使用返回 (TransactionDeclarationId,AccessRightId) 的参数函数 fp_Transaction_ACL(userId) 加入表 TransactionDeclaration(Id,...)。连接必须是内部连接。

我使用 Fluent NHibernate 完成了以下映射：

```
 public TransactionDeclarationMap()
    {
        this.Id(transactionDeclaration => transactionDeclaration.Id);                   
        this.Join(
            "fp_TransactionDeclaration_ACL(:AclFilter.userId)",
            join =>
            {
                join.KeyColumn("TransactionDeclarationId");
                join.Map(transactionDeclaration => transactionDeclaration.AccessRight, "AccessRightType").CustomType
                    <AccessRight>().Generated.Always().ReadOnly();
                join.Inverse();
                join.Fetch.Join();
            });
     } 
```

由于不得插入或更新该函数，因此我添加了“join.Inverse()”，如下所述：

[Nhibernate/hibernate 避免在连接表或视图中插入](https://stackoverflow.com/questions/5535429/nhibernate-hibernate-avoid-insert-in-joined-table-or-view?answertab=oldest#tab-top)

但是当我添加这个逆时，连接变成了左外连接，这对于我的用例来说是不合适的。我需要一个内部连接来过滤函数未返回的表“TransactionDeclaration”的记录。

如何获得内部联接？或者有没有替代“逆”以避免插入函数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T19:04:26.303

我不知道如何在 Fluent 中执行此操作，但您必须在某处指定您要加入的密钥不可为空。

像这样的东西，也许：

```
public TransactionDeclarationMap()
{
    this.Id(transactionDeclaration => transactionDeclaration.Id);                   
    this.Join(
        "fp_TransactionDeclaration_ACL(:AclFilter.userId)",
        join =>
        {
            join.KeyColumn("TransactionDeclarationId");
            join.Map(transactionDeclaration => transactionDeclaration.AccessRight, "AccessRightType").CustomType
                <AccessRight>().Generated.Always().ReadOnly();
            join.Inverse();
            join.SetAttribute ("optional", false);
            join.Fetch.Join();
        });
 } 
```

[点击](http://codeinsanity.com/archive/2009/05/14/fluentnhibernate-mappings-join.aspx)了解更多信息。

# java - 在 Oracle 11g 中选择 DBMS_CRYPTO 密码哈希

> ID：12465539
> 
> 赞同：1
> 
> 时间：2012-09-17T19:01:05.910
> 
> 标签：java, oracle11g, password-hash, dbms-crypto

我目前在我的 Oracle 数据库中使用`DBMS_CRYPTO.HASH`. 然而，此时，我需要让我的 Java 应用程序能够以类似于 MySQL 的方式验证用户输入的密码。就像是：

```
SELECT *
FROM user_login_table
WHERE password = SHA1('MyPassword'); 
```

我目前正在通过以下过程进行散列：

```
CREATE OR REPLACE PROCEDURE 
  MUNGAI.p_auth_insert_user (
    par_username in varchar2,
    par_password in varchar2,
    par_work in varchar2
  )
IS l_hash raw(2000);
  BEGIN
    l_hash :=
      dbms_crypto.hash(
        utl_i18n.string_to_raw(par_password || par_work || upper(par_username),
        'AL32UTF8'
      ),
      dbms_crypto.hash_sh1
    );

    INSERT INTO user_login_table (user_name, p_word, work_class)
    VALUES (par_username, l_hash, par_work);
  END p_auth_insert_user;
/ 
```

然后我执行如下过程，插入表中：

```
EXEC MUNGAI.p_auth_insert_user('MUNGAI', 'gatungo', '999') 
```

在我的情况下有没有更好的方法来实现这一点？如果这很重要，我正在使用 Oracle 11g。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T19:14:20.193

我建议您在数据库外部的代码中进行哈希处理。这样，您就可以独立于数据库供应商，并且您只需将散列实现写入一个位置。DB 列可以是常规的 varchar。

它会是这样的：

1.  添加用户/更改密码时，哈希在插入/更新之前为密码提供了适当的算法和盐。我建议至少 SHA-256。把盐也放在哈希旁边！

2.  在身份验证期间，为用户获取哈希和盐，用盐对提供的密码进行哈希，并与数据库中的哈希进行比较。

例如这里的散列/加盐技巧：http: [//crackstation.net/hashing-security.htm](http://crackstation.net/hashing-security.htm)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-17T20:42:45.657

假设哈希密码存储在 中的`RAW`列中`user_login_table`，您可以简单地调用`dbms_crypto.hash`SQL 语句。根据您进行初始哈希的方式（特别是您如何将纯文本密码转换为`RAW`以及您使用的算法和选项），这样的事情会起作用

```
select * 
  from user_login_table 
 where password = dbms_crypto.hash( utl_i18n.string_to_raw( 'MYPassword', 'AL32UTF8' ),
                                    <<whatever hash algorithm you want to use>> ); 
```

当然，作为良好编码实践的一般问题，您几乎肯定希望定义自己的哈希密码函数，以便您可以嵌入如何将字符串转换为 a 的逻辑，`RAW`并在一个地方指定哈希算法。然后，您将从 SQL 语句中调用该新函数。这就是你可能会添加适当盐的功能。然后，您将使用该函数对表中的散列数据进行初始播种，并在将来验证密码散列。

我还假设您的实际查询`username`除了密码之外还有一个谓词

```
select * 
  from user_login_table 
 where password = new_function_name( 'MYPassword' )
   and username = 'YourUserName' 
```

否则，您发布的查询只会验证密码是否与数据库中某人的密码匹配，而不是尝试登录的特定人员。此外，如果两个人具有相同的密码哈希，它将返回多行。

因此，在您的具体情况下，我希望您希望创建一个新函数`hash_password`

```
CREATE OR REPLACE function MUNGAI.hash_password(par_username in varchar2,
                              par_password in varchar2,
                              par_work in varchar2
                             )
  return raw
is
  l_hash raw(2000);
begin
  l_hash :=
   dbms_crypto.hash
     (utl_i18n.string_to_raw (par_password || par_work || upper(par_username),
                              'AL32UTF8'
                             ),
      dbms_crypto.hash_sh1
     );
  return l_hash;
end; 
```

然后，您将从您的插入过程中调用此函数

```
CREATE OR REPLACE procedure MUNGAI.p_auth_insert_user (par_username in varchar2,
                              par_password in varchar2,
                              par_work in varchar2
                             )
is
  l_hash raw(2000);
begin
  l_hash := hash_password( par_username, par_password, par_work );

  insert into user_login_table
    (user_name, p_word, work_class)
   values
    (par_username, l_hash, par_work);
end p_auth_insert_user;
/ 
```

您的查询将是

```
select * 
  from user_login_table 
 where password = new_function_name( username, 
                                     'MYPassword', 
                                     <<whatever `par_work` is supposed to be>> )
   and username = 'YourUserName' 
```

# android - 滚动侦听器 - 第一个距离对于向下滚动总是负数？

> ID：12465540
> 
> 赞同：5
> 
> 时间：2012-09-17T19:01:10.687
> 
> 标签：android

我有一个连接到 ListView 的 GestureDetector.OnGestureListener。当用户向下滚动时，我正在尝试监听滚动事件：

```
private GestureDetector.OnGestureListener mOnGesture = new GestureDetector.OnGestureListener() {
    @Override
    public boolean onScroll(MotionEvent e1, MotionEvent e2, float distanceX, float distanceY) {
    }
} 
```

但我看到一个非常奇怪的“distanceY”值流：

```
distanceY: -417.02252  // <-- huh?
e1: null
e2: MotionEvent{4097ac08 action=2 x=233.6657 y=417.02252 pressure=0.79999995 size=0.33333334}

distanceY: 1.5640259
e1: null
e2: MotionEvent{4097ac08 action=2 x=233.6657 y=415.4585 pressure=0.79999995 size=0.33333334}

distanceY: 1.5640259
e1: null
e2: MotionEvent{4097ac08 action=2 x=233.6657 y=413.89447 pressure=0.79999995 size=0.40000004}

... rest of values are positive, as expected ... 
```

第一个“distanceY”值是负数（出乎意料），但随后的都是正数。这有什么可以解释的？我每次都可以重现这种行为。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T19:13:58.833

`distanceY`是当前事件和上一个事件之间的距离`onScroll`。由于这是第一个此类事件，我假设它从零开始计算。

```
distanceY: ____-417.02252____  // Same value as...
e1: null
e2: MotionEvent{4097ac08 action=2 x=233.6657 y=____417.02252____ // ...here... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-24T16:09:47.937

我有同样的问题。

但就我而言，我对 onInterceptTouchEvent(...) 和 onTouchEvent(...) 方法使用不同的 OnGestureListener-s。

因此，我只是在拦截侦听器中设置了一个标志，以忽略传递给实际触摸事件侦听器的第一个滚动事件

```
private class GestureInterceptListener extends GestureDetector.SimpleOnGestureListener {

    @Override
    public boolean onScroll(MotionEvent e1, MotionEvent e2, float distanceX, float distanceY) {
        final boolean shouldIntercept = ...; // here we decide should we intercept this event, or should it be passed further 
        if (shouldIntercept) {
            mGestureProcessListener.setFirstScrollEventIgnored(true);
        }
        return shouldIntercept;
    }

}

private class GestureProcessListener extends GestureDetector.SimpleOnGestureListener {

    private boolean ignoreFirstBuggyScrollEvent = false;

    /**
     * For some reason first scroll event on half-visible settings list gets strange incorrect negative values
     * @param isIgnored - should next scroll event be ignored? value resets to false afterwards
     */
    public void setFirstScrollEventIgnored(boolean isIgnored) {
        ignoreFirstBuggyScrollEvent = isIgnored;
    }

    @Override
    public boolean onScroll(MotionEvent e1, MotionEvent e2, float distanceX, float distanceY) {
        if (ignoreFirstBuggyScrollEvent) {
            ignoreFirstBuggyScrollEvent = false;
            return true;
        }
        ... // process scroll event here
        return true;
    }

} 
```

为我工作

# php - PHP数据库显示在具有不同锚标签的相同字段中

> ID：12465545
> 
> 赞同：2
> 
> 时间：2012-09-17T19:01:32.027
> 
> 标签：php, mysql, database

我四处寻找，看看这是否可能，却空手而归。首先，这是我的代码：

```
 <div id="information" style="display:none">
 </div>

<?php $seat = mysql_query("SELECT * FROM people WHERE seat='C3-24'"); $row = mysql_fetch_array($seat); ?>

     <ul>
        <li> <?= $row['first_name']; ?></li>
        <li> <?= $row['last_name']?> </li>          
        <li> <?= $row['seat']?></li>            
     </ul>                   

 </div><!-- information -->

 <div id="c3-24" class="seat">
    <a class="trigger" onClick="document.getElementById('information').style.display='block';"></a></div>
</div> 
```

基本上我想`li`在选择`div id "c3-25"`. 现在我知道`WHERE seat="C3-25"`将只输出数据库行，但我想将此结构与其他位置重用。从我读到的这是不可能的。理想情况下，我希望有一个 div 列表（c3-24 到 c3-50）并在`li`字段中单击锚标记时显示相应的信息。

我尝试过放置多个“信息”div，但信息最终会堆叠在一起。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T19:29:25.393

问题在于时机。有两个非常独立的执行上下文值得考虑以了解您的问题：

1.  页面构建 (PHP) - Web 服务器创建 HTML 以发送到浏览器；
2.  用户交互 (JavaScript) - 用户的浏览器已呈现页面并且用户正在与之交互。

由于页面构建时间发生在浏览器获取信息之前，它不可能实现用户决策（稍后发生）。

这种解决方案的典型解决方案是将应用程序分解为多个请求。作为最佳实践，最好将 JavaScript 拆分到一个单独的文件中，并使用一种称为委托的技术来减少代码量。

这就是我的做法。首先，下发页面结构（PHP/HTML）：

```
<div id="information">
  <!-- leave empty -->
</div>
<div class="seats">
  <div class="seat">
    <a class="trigger">c3-24</a></div>
  </div>
  <div class="seat">
    <a class="trigger">c3-25</a></div>
  </div>
  ...
</div> 
```

然后在单独的 JavaScript 文件中设置用户交互：

```
// setup a click handler on the parent 'seats' div
document.querySelector('.seats').addEventListener('click', function(e){
  // check if the target of the click was actually an anchor tag with class=target
  if (e.target.classList.contains('target')) {
    var
      // use the text of the anchor tag to get the seat
      seat = e.target.textContent,
      // create an XMLHttpRequest to asynchronously get the seat details
      req = new XMLHttpRequest();
    // handle server result by inserting details
    req.onreadystatechange = function() {
      if(req.readyState === 4){
        document.getElementById('information').innerHTML = req.responseText;
      }
    };
    req.open("GET", "seatdata.php?seat=" + encodeURIComponent(seat), true);
    req.send(null);
  }
}); 
```

最后，实现一个单独的 PHP 脚本来获取特定座位的数据（例如，seatdata.php）。您的脚本应该`seat`通过获取 URL 参数`$_GET['seat']`并在查询中使用它。

根据 Madara 的评论，不要`mysql_query`直接使用该功能，因为它已被弃用，而是使用更好的东西。

# c# - 为什么当有空数据库字段时，这个实体框架查询会失败？

> ID：12465550
> 
> 赞同：0
> 
> 时间：2012-09-17T19:01:47.617
> 
> 标签：c#, asp.net-mvc-3, entity-framework-4

我正在使用 MVC3 C#.NET。我有一个查询（到目前为止有效），它根据 companyID 返回行：

```
var records = db.groupsToClassesMapping.Where(r => r.CompanyID == CompanyId); 
```

该模型如下所示：

```
[Table("Rpt_GroupsToClasses")]
public class GroupToClass
{
    public int id { get; set; }
    public string GroupName { get; set; }
    public string ClassName { get; set; }
    public int ClassIndex { get; set; }
    public int CompanyID { get; set; }
} 
```

DBContext 看起来像这样：

```
 public DbSet<GroupToClass> GroupsToClassesMapping { get; set; } 
```

它曾经是所有表条目都已填充，查询将返回结果：

```
ID | Group Name | ClassName | ClassIndex | CompanyID
-----------------------------------------------------
1  | Pine       | Merch     | 1          | 1
2  | Oak        | Non-merch | 4          | 1 
```

但是，我发现自己需要将一些条目留空：

```
ID | Group Name | ClassName | ClassIndex | CompanyID
-----------------------------------------------------
1  | Pine       | Merch     | 1          | 1
2  | Oak        | NULL      | NULL       | 1 
```

我的查询 (where(r => r.companyID == CompanyId)) 没有返回任何内容。我需要对模型字段做些什么来使这项工作正确吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T19:03:43.470

通过将数据类型更改为 使 ClassIndex 可以为空`int?`。

# android - Android.widget,textView 无法转换为 android.widget,button

> ID：12465551
> 
> 赞同：27
> 
> 时间：2012-09-17T19:01:48.970
> 
> 标签：android, android-layout, android-intent, android-widget

启动我的活动时，我不断收到运行时错误，它说 android.widget.textview 不能转换为 android.widget.button？

XML:

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:tools="http://schemas.android.com/tools"
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/RelativeLayout1"
    android:layout_width="fill_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    tools:ignore="HardcodedText" >

    <TextView
        android:id="@+id/textViewName"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="false"
        android:layout_alignParentTop="false"
        android:text="Name:"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <TextView
        android:id="@+id/textViewLevel"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentRight="true"
        android:layout_below="@+id/textViewName"
        android:text="Level:"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <TextView
        android:id="@+id/textViewClass"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="false"
        android:layout_below="@+id/textViewLevel"
        android:text="Class:"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <TextView
        android:id="@+id/textViewTitle"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBaseline="@+id/textViewClass"
        android:layout_alignBottom="@+id/textViewClass"
        android:layout_centerHorizontal="true"
        android:text="Title:"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <TextView
        android:id="@+id/textViewXP"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_above="@+id/textViewTitle"
        android:layout_alignLeft="@+id/textViewTitle"
        android:text="XP:"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <TextView
        android:id="@+id/textViewGold"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/textViewXP"
        android:layout_alignParentTop="true"
        android:text="Gold:"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <TextView
        android:id="@+id/textViewLineBreak"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_below="@+id/textViewClass"
        android:text="________________________________________"
        android:textAppearance="?android:attr/textAppearanceMedium"
        android:visibility="invisible" />

    <TextView
        android:id="@+id/textViewGoldValue"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentTop="true"
        android:layout_toRightOf="@+id/textViewGold"
        android:text="0"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <Button
        android:id="@+id/button3"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:layout_alignParentLeft="true"
        android:layout_toLeftOf="@+id/textViewTitle"
        android:text="Stats" />

    <Button
        android:id="@+id/button2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_above="@+id/button3"
        android:layout_alignParentLeft="true"
        android:layout_marginBottom="20dp"
        android:layout_toLeftOf="@+id/textViewTitle"
        android:text="Equipment" />

    <Button
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_above="@+id/button2"
        android:layout_alignParentLeft="true"
        android:layout_alignRight="@+id/button2"
        android:layout_marginBottom="22dp"
        android:text="Inventory" />

    <Button
        android:id="@+id/Button01"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBaseline="@+id/button1"
        android:layout_alignBottom="@+id/button1"
        android:layout_alignLeft="@+id/button4"
        android:layout_alignParentRight="true"
        android:text="Shop" />

    <Button
        android:id="@+id/button5"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_below="@+id/button2"
        android:layout_toRightOf="@+id/textViewXP"
        android:text="Class Training" />

    <Button
        android:id="@+id/button4"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/button5"
        android:layout_alignParentRight="true"
        android:layout_below="@+id/button1"
        android:text="Crafting" />

    <TextView
        android:id="@+id/textView4"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_below="@+id/textViewLineBreak"
        android:text="HP:"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <TextView
        android:id="@+id/textViewStrTitle"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_above="@+id/textViewLineBreak"
        android:layout_alignLeft="@+id/textViewGoldValue"
        android:text="N/A"
        android:textAppearance="?android:attr/textAppearanceSmall" />

    <TextView
        android:id="@+id/textViewXPValue"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/textViewGoldValue"
        android:layout_below="@+id/textViewGoldValue"
        android:text="0"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <TextView
        android:id="@+id/textViewLevelValue"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_above="@+id/textViewClass"
        android:layout_toRightOf="@+id/textViewName"
        android:text="1"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <TextView
        android:id="@+id/TextViewStrClass"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_above="@+id/textViewLineBreak"
        android:layout_alignLeft="@+id/textViewLevelValue"
        android:textAppearance="?android:attr/textAppearanceSmall" />

    <TextView
        android:id="@+id/textViewRace"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_below="@+id/textViewClass"
        android:text="Race:"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBaseline="@+id/textView4"
        android:layout_alignBottom="@+id/textView4"
        android:layout_toLeftOf="@+id/TextViewStrClass"
        android:text="10"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <Spinner
        android:id="@+id/spinnerMonsters"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_below="@+id/textView4"
        android:layout_marginTop="50dp"
        android:layout_toLeftOf="@+id/btnBattle"
        android:entries="@array/Monsters"
        android:prompt="@string/MonsterPrompt" />

    <TextView
        android:id="@+id/textView2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_above="@+id/spinnerMonsters"
        android:layout_alignRight="@+id/textViewXPValue"
        android:text="10"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <Button
        android:id="@+id/btnBattle"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_alignTop="@+id/spinnerMonsters"
        android:text="Battle!" />

    <TextView
        android:id="@+id/textView3"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_above="@+id/textViewStrTitle"
        android:layout_alignRight="@+id/spinnerMonsters"
        android:layout_marginRight="14dp"
        android:text="/"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <TextView
        android:id="@+id/textViewXpNextLevel"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBaseline="@+id/textViewLevel"
        android:layout_alignBottom="@+id/textViewLevel"
        android:layout_alignLeft="@+id/btnBattle"
        android:text="100"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <TextView
        android:id="@+id/textViewBattleResults"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_below="@+id/spinnerMonsters"
        android:textAppearance="?android:attr/textAppearanceSmall" />

    <TextView
        android:id="@+id/textViewStrRace"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_above="@+id/textView1"
        android:layout_toRightOf="@+id/textViewClass"
        android:text="l"
        android:textAppearance="?android:attr/textAppearanceSmall" />

    <TextView
        android:id="@+id/textViewStrAlliance"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_above="@+id/textView2"
        android:layout_alignParentRight="true"
        android:layout_toRightOf="@+id/textViewStrTitle"
        android:text="Small Text"
        android:textAppearance="?android:attr/textAppearanceSmall" />

    <TextView
        android:id="@+id/textViewAlliance"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_below="@+id/textViewTitle"
        android:layout_toRightOf="@+id/button1"
        android:text="Alliance:"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <TextView
        android:id="@+id/textView6"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/textViewAlliance"
        android:layout_below="@+id/textViewLineBreak"
        android:text="MP:"
        android:textAppearance="?android:attr/textAppearanceMedium" />

</RelativeLayout> 
```

这里发生了什么？我已经经历了几次，找不到任何东西

编辑：

```
09-17 18:28:51.485: E/AndroidRuntime(724): FATAL EXCEPTION: main
09-17 18:28:51.485: E/AndroidRuntime(724): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.intent_buttontests/com.example.intent_buttontests.PlayScreen}: java.lang.ClassCastException: android.widget.TextView cannot be cast to android.widget.Button
09-17 18:28:51.485: E/AndroidRuntime(724):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1956)
09-17 18:28:51.485: E/AndroidRuntime(724):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)
09-17 18:28:51.485: E/AndroidRuntime(724):  at android.app.ActivityThread.access$600(ActivityThread.java:123)
09-17 18:28:51.485: E/AndroidRuntime(724):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147)
09-17 18:28:51.485: E/AndroidRuntime(724):  at android.os.Handler.dispatchMessage(Handler.java:99)
09-17 18:28:51.485: E/AndroidRuntime(724):  at android.os.Looper.loop(Looper.java:137)
09-17 18:28:51.485: E/AndroidRuntime(724):  at android.app.ActivityThread.main(ActivityThread.java:4424)
09-17 18:28:51.485: E/AndroidRuntime(724):  at java.lang.reflect.Method.invokeNative(Native Method)
09-17 18:28:51.485: E/AndroidRuntime(724):  at java.lang.reflect.Method.invoke(Method.java:511)
09-17 18:28:51.485: E/AndroidRuntime(724):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
09-17 18:28:51.485: E/AndroidRuntime(724):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
09-17 18:28:51.485: E/AndroidRuntime(724):  at dalvik.system.NativeStart.main(Native Method)
09-17 18:28:51.485: E/AndroidRuntime(724): Caused by: java.lang.ClassCastException: android.widget.TextView cannot be cast to android.widget.Button
09-17 18:28:51.485: E/AndroidRuntime(724):  at com.example.intent_buttontests.PlayScreen.onCreate(PlayScreen.java:110)
09-17 18:28:51.485: E/AndroidRuntime(724):  at android.app.Activity.performCreate(Activity.java:4465)
09-17 18:28:51.485: E/AndroidRuntime(724):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
09-17 18:28:51.485: E/AndroidRuntime(724):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1920)
09-17 18:28:51.485: E/AndroidRuntime(724):  ... 11 more 
```

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2012-09-17T21:20:19.340

> 我添加了logcat。但我不知道发生了什么

这是 LogCat 文件中的重要信息：

```
Caused by: java.lang.ClassCastException: android.widget.TextView cannot be cast to android.widget.Button
  at com.example.intent_buttontests.PlayScreen.onCreate(PlayScreen.java:110) 
```

您正确阅读了错误，它是一个`ClassCastException`. 下面的几行`Caused by...`告诉你错误是在哪里抛出的，`PlayScreen.onCreate()`在第 110 行。尽我所能告诉你第 110 行是：

```
Button btnBattle = (Button) findViewById(R.id.btnBattle); 
```

但是这条线很好，XML`btnBattle`看起来也很好......

我自己用你的布局运行了你的活动，没有收到任何错误。你清理过你的项目吗？这通常会消除这些“幻影”错误。（在 Eclipse 中，**项目**->**清理...**）

* * *

我确实有一个建议，你有很多按钮可以完成类似的任务。`onClick`如果您使用 XML属性，您可以用更少的代码执行相同的操作。`launchClick()`首先在您的 Activity 中创建一个方法（调用它），如下所示：

```
public void launchClick(View v) {
    Intent intent;

    switch(v.getId()) {
    case R.id.button1:
        intent = new Intent(PlayScreen.this, Inventory.class);
        break;

    case R.id.button2:
        intent = new Intent(PlayScreen.this, Equipment.class);
        break;

    // etc, etc
    }
    startActivityForResult(intent, 0);
}; 
```

并将属性添加`android:onClick`到您应该具有此行为的每个按钮`play_screen.xml`：

```
<Button
    android:id="@+id/button3"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true"
    android:layout_alignParentLeft="true"
    android:layout_toLeftOf="@+id/textViewTitle"
    android:onClick="launchClick"
    android:text="Stats" /> 
```

希望有帮助！

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2013-07-07T12:03:31.380

**项目 -> 清洁**可以帮助你。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-17T19:18:09.973

您正在尝试投射`TextView`到`Button`.

为此`TextView`：

```
TextView tv = (TextView)findviewById(R.id.your textviewid present in xml layout file); 
```

对于`Button`：

```
Button btn1 = (Button)findviewById(R.id.your buttonid present in xml layout file); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-15T19:58:34.073

在 Eclipse 中转到 Project > Clean，选择您的项目，这就是全部...您的应用程序将正常运行...

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-07-06T07:31:53.383

首先确保您的 .java 文件中的所有`TextView`地址都是正确`TextView`的。像这样..

```
TextView textview1 = (TextView) findViewById(R.id.textview1); 
```

像 Android.widget,textView 之类的错误不能转换为 android.widget,button 因为有时我们提到`Button`而不是`TextView`.

如果一切正常，那么清理你的项目并刷新..它对我有用..

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-09-10T21:33:39.580

我正在使用带有 3 个文本视图和 2 个按钮的 RelativeLayout。当我使用图形界面编辑器移动 textViews 的位置时，我得到了同样的奇怪错误。如果我将它们设置回原来放置的位置，错误就会消失。

我可以通过以下方式摆脱错误：

1.  将有问题的 XML 文件中的所有数据剪切到剪贴板。
2.  保存项目。
3.  清理项目（查看 XML 文件中的错误）
4.  粘贴回 XML 代码并保存
5.  干净的
6.  跑

这似乎是一个错误，因为 XML 代码是合法的，但没有在运行时正确构建。

希望对你有效。面向 Web 开发人员的 Eclipse Java EE IDE。

版本：Indigo Service Release 2 内部版本 ID：20120216-1857

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-17T19:06:10.157

请附上您的 java 代码以找出问题所在。当您尝试将 textview 转换为按钮时，就会出现此问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-10-18T21:13:40.720

1.  项目 > 清洁

或者

2.  更改项目 ID

它有帮助：D

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-10-19T04:16:44.677

我刚刚遇到了同样的问题。但是，我决定只使用“视图”而不进行投射。它完美地工作。“setOnClickListener”对我们的案例同样有效。

例如 `View button = v.findViewById(button_id); button.setOnClickListener(...)`

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-06-23T15:19:40.173

如果项目清理不起作用。原因可能与在多个项目上**使用相同的 ID有关。**

确保在通过布局或以编程方式分配 ID 时，**不重复。**

我在将低数字分配为 ID 时遇到了这个问题（可能不是最佳实践），因为 ID 与 RadioButton 检查的 ID 冲突。

干杯

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-04-24T17:22:38.787

我也遇到过类似的问题，我的是使用 ImageView 而不是 TextView，当我回去检查我的活动时，我发现我已经将一个变量声明为 Button，然后我将变量分配给 findViewById(R.id. ivrest)，其中 ivRest 指的是 ImageView，所以只要确保你声明一个具有特定类型的变量，在重新分配变量时它应该是相同的类型

# c++ - C++ 和 Xlib - 中心窗口

> ID：12465552
> 
> 赞同：1
> 
> 时间：2012-09-17T19:01:49.740
> 
> 标签：c++, linux, window, center, xlib

我已经开始直接研究基于 XLib 的 GUI 应用程序编程，我正在尝试在屏幕上创建一个居中的窗口。我不知道用来实现这一点的常用技术。我的代码（不起作用）是这个（我使用 CodeBlocks）

```
#include <stdio.h>
#include <stdlib.h>
#include <X11/Xlib.h>
#include <X11/Xutil.h>
#include <X11/Xos.h>
#include <X11/Xatom.h>
#include <X11/keysym.h>
#include <GL/glew.h>
#include <GL/freeglut.h>

int screen;
Display *display;
XSetWindowAttributes window_attributes;
Window mainwindow;
XEvent events;

int main(int argc, char** argv) {
    display = XOpenDisplay(NULL);screen = DefaultScreen(display);
    window_attributes.background_pixel = XWhitePixel(display, screen);
    window_attributes.border_pixel = XBlackPixel(display, screen);
    window_attributes.win_gravity = SouthWestGravity;

    mainwindow = XCreateWindow(display,
                             RootWindow(display, screen),
                             1, 1,
                             600, 400,
                             0,
                             CopyFromParent,
                             InputOutput,
                             CopyFromParent,
                             CWBackPixel|CWBorderPixel,
                             &window_attributes
                            );
    XMapWindow(display, mainwindow);
    XFlush(display);
    XSelectInput(display, mainwindow, ExposureMask|KeyPressMask|ButtonPressMask);
    while (1)  {
        XNextEvent(display, &events);
        switch  (events.type) {
            case Expose:
                // Lots of code that doesn't matter for my problem
            break;
        }
    }
    return 0;
} 
```

所以，我认为这`window_attributes.win_gravity`可以解决问题，但似乎我做错了什么，或者它一定是与操作系统相关的问题。
谢谢你的帮助！

**更新**
我已将 X（左侧位置）更改为 100，将 y（顶部位置）更改为 100，但窗口的位置没有更改。所以，我的问题是窗口的位置不能改变，不管它是什么。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T19:38:32.237

1.  重力适用于窗口自身的内容和子窗口，而不适用于它在父窗口中的位置。
2.  窗口管理器可以并且确实覆盖顶级窗口位置请求。通话`XMoveWindow` *后*使用。`XMapWindow`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-03-29T13:21:48.720

在您创建窗口的函数中，您应该计算屏幕中窗口的起始 x,y 坐标：

```
XDisplayWidth(dpy, sreen); XDisplayHeight(dpy, sreen); 
```

之后，您应该进行计算（例如 .../2 + win.size.x ....）以使窗口居中。

# ssl - 不安全的内容从股票代码加载到页面选项卡上 Facebook 应用程序的右侧

> ID：12465561
> 
> 赞同：0
> 
> 时间：2012-09-17T19:02:52.250
> 
> 标签：ssl, facebook-apps, facebook-page, facebook-iframe, facebook-canvas

我有一个在页面选项卡上完美运行的 Facebook 应用程序，通过 HTTPS 加载，并且在初始加载后不显示 SSL 警告。

但过了一会儿，所有页面选项卡右侧的 fb 自动收报机提要（它在其中流式传输您的朋友正在做的事情）异步加载新故事，但它会加载不安全的内容。

我收到这样的控制台警告：

```
the page [secure facebook page tab url] displayed insecure 
content from http://static.ak.fbcdn.net/rsrc.php/v2/yw/r/drP8vlvSl_8.gif. 
```

它会加载 1x1 的 gif、新项目之间的灰线和小轮廓图片缩略图，例如：

```
http://profile.ak.fbcdn.net/hprofile-ak-snc6/623516_13908061_1656526379_q.jpg 
```

这些显然会破坏浏览器中的 https 连接，这在 IE9 中默认会导致相当大的问题。

所有这些都是从 Facebook 加载的，位于画布 iframe 之外。那么如何让 FB 加载安全内容，或者不加载新的提要故事？

其他人有这个问题吗？

# xamarin.ios - 带有外部显示视频的应用内音频

> ID：12465562
> 
> 赞同：0
> 
> 时间：2012-09-17T19:02:59.663
> 
> 标签：xamarin.ios

我正在构建一个需要播放音频文件的应用程序，以便在设备扬声器上播放音频，而在外部显示器上播放视频 - 通过 HDMI 显示适配器或 Apple TV 连接。是否可以指定音频播放的位置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T15:51:55.693

您可以通过设置 AudioSession.RoutingOverride 来设置 AudioSession 音频路由。坏消息是，除了 None 和 Speakers 之外，这并没有提供太多控制。

有关更多信息，请参阅：

[http://developer.apple.com/library/ios/#documentation/AudioToolbox/Reference/AudioSessionServicesReference/Reference/reference.html#//apple_ref/doc/constant_group/Audio_Session_Category_Route_Overrides](http://developer.apple.com/library/ios/#documentation/AudioToolbox/Reference/AudioSessionServicesReference/Reference/reference.html#//apple_ref/doc/constant_group/Audio_Session_Category_Route_Overrides)

# python - 解析xml后如何使用pyodbc在python中创建/附加列表到mysql

> ID：12465565
> 
> 赞同：0
> 
> 时间：2012-09-17T19:03:07.600
> 
> 标签：python, xml, parsing, odbc

我需要从一个数据库（sql server）解析xml（xmldata），然后将它们提取并加载到一个干净的表中，然后使用python将它们存储到另一个数据库（mysql）

这是我的代码

```
import pyodbc
from lxml import etree
from StringIO import StringIO

con_c = pyodbc.connect('DSN=database1;Database=y;UID=x;PWD=y')
con_a = pyodbc.connect('DSN=database2;Database=x;UID=x;PWD=y')

cur_a = con_a.cursor() 
cur_c = con_c.cursor() 

cur_c.execute("""
select top 100
id,
xmldata
from table1
""")

rows_c = cur_c.fetchall()
for row in rows_c:

     x = str(row.xmldata)
     root = etree.fromstring(x)                  
     build_text_list = etree.XPath("//text()")   
     texts = build_text_list(root)              

     print((texts)) 
```

现在..这就是我所坚持的。“文本”现在是价值的“列表”......我可以将 [scott,xx,...] 打印出来，但是如何将列表存储到 Database2

![在此处输入图像描述](../Images/0d0235b71518b8fae937852d6472e612.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T20:44:09.137

```
con_a.execute("INSERT INTO table2 (variable1, variable2) VALUES(?, ?)", *texts[:2])
con_a.commit() 
```

或使用[executemany](http://code.google.com/p/pyodbc/wiki/Cursor#executemany)

```
params = [ ('A', 1), ('B', 2) ]
con_a.executemany("insert into t(name, id) values (?, ?)", params)
con_a.commit() 
```

一些额外的想法：

*   variable1、variable2 等是列名的错误选择。

*   您可以使用多少列名称和转义参数（问号）可能存在限制。

*   一张表中的 300 列看起来非常多，可能是糟糕设计的标志。

所以我希望你能保持你的表格[规范化](http://en.wikipedia.org/wiki/Database_normalization)，并给表格的列赋予有意义的名字。另外，请注意有一个更易于使用的用于 python 的 Mysql 适配器，称为 MySQLdb。它可以让您避免连接字符串的麻烦。

# php - php递归无限页面加载

> ID：12465566
> 
> 赞同：4
> 
> 时间：2012-09-17T19:03:15.197
> 
> 标签：php, recursion

我有一个连续运行并请求一个 php 页面的 linux bash 脚本。php 页面做了一些魔术，500 毫秒后 bash 脚本再次请求 php 页面，php 做了一些魔术。这会日复一日地运行，但有时 bash 会崩溃，这意味着我需要登录机器并再次运行脚本。不，我正在寻找一个完全由 php 驱动的解决方案。

我进行了以下测试，但不起作用。文件））;

```
recursiveStopStart(true,$basepath);

function recursiveStopStart($mayrun = true,$basepath){
    if ($mayrun == true){
        sleep(1);
        exec("C:\wamp\bin\php\php5.3.13\php.exe ".$basepath."/scripts/StopStart.php");
        exec("C:\wamp\bin\php\php5.3.13\php.exe ".$basepath."/scripts/TestStopStart.php");
        flush();
        exit();
    }
}
?> 
```

StopStart.php 是具有魔力的脚本。TestStopStartphp 是实现递归思想的主要 php 页面。

我正在寻找一种解决方案，我在该解决方案上请求 1 页，该页面调用魔术页面并调用自身以重新运行所有内容。

转向 php 的第二个原因是我可以让它独立于平台（bash 不会在 Windows 上运行......）。

希望有人可以帮助我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T19:18:42.753

创建一个 PHP 守护进程。你会省去很多麻烦。

[http://pear.php.net/package/System_Daemon](http://pear.php.net/package/System_Daemon)

**System_Daemon 是一个 PHP 类，允许开发人员在 Linux 系统上创建自己的守护程序应用程序**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T19:32:27.180

流行的守护程序库似乎不能跨操作系统工作。我确信这是由于 *NIX 和 windows 之间处理服务/进程的方式截然不同。

看起来您将不得不使用任意数量的流行库 System_Daemon、Supervisord 在 linux 中创建一个守护进程，

然后在 Windows [http://www.akchauhan.com/create-windows-service-to-schedule-php-script-execution/](http://www.akchauhan.com/create-windows-service-to-schedule-php-script-execution/)中创建一个。这是创建服务的秘诀，该服务可以像 cron 一样按时间间隔执行您的 php 脚本。

# php - PHP unicode 解码

> ID：12465574
> 
> 赞同：5
> 
> 时间：2012-09-17T19:04:00.030
> 
> 标签：php, unicode, decode

我有一个 PHP 脚本，它从 .xls 文件中读取字符串数据（通过[PHP Excel Reader](http://code.google.com/p/php-excel-reader/)）。但是它以 unicode 编码格式返回一些特殊字符。例如，代替“é”返回“\xe9”。

有什么办法，在 PHP 5.2 中，如何用 "\x??" 解码字符串 字符转换为经典 UTF-8？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T19:23:06.947

只需使用`utf8_encode()`

这是一个例子： [http ://codepad.org/62STmyAl](http://codepad.org/62STmyAl)

# c++ - IdSMTP 卡在 Connect 方法上

> ID：12465579
> 
> 赞同：1
> 
> 时间：2012-09-17T19:04:17.803
> 
> 标签：c++, delphi, smtp, indy, smtpclient

我正在使用 IdSMTP 并在我的表单中动态创建/销毁 TIdSMTP 组件。大多数时候 smtp.Connect 没有问题，但我发现在某些情况下主 UI 会卡住并变得无响应。

我添加了 ConnectTimeout 和 ReadTimeout 属性，但仍然遇到同样的问题。应用程序变得无响应并迫使我们终止该进程。

```
 smtp.ConnectTimeout := 10000;
  smtp.ReadTimeout := 10000;
  smtp.Connect;
  if smtp.Connected then
  begin
    smtp.Send(Mess);
    smtp.Disconnect;
  end 
```

我有一个绑定到 stmp 的 OnStatus 事件，该事件由 idstmp 控件引发

但是由于某种原因，Connect 仍然使应用程序免费并且无响应。

# javascript - 计算所有具有相同未知类名的兄弟元素

> ID：12465583
> 
> 赞同：2
> 
> 时间：2012-09-17T19:04:26.267
> 
> 标签：javascript, jquery, css, arrays

我需要帮助处理具有不同类名的大量兄弟元素。

1.  获取具有相同类名的元素数量并将它们放入数组中
2.  查找该类组中的第一个元素（可以是数字或名称）。
3.  运行函数的语句：if element = group do 的第一个元素`console.log("first element");`

这是前 3 个类的示例，但这将从 groupA 到 Groupz

```
<div class = 'slider'>
    <div class = 'item1 groupA'> <!-- Start Group A -->
        <img  src='xyz'  />
    </div>
    <div class = 'item1 groupA'>
        <img  src='xyz'  />
    </div>                  
    <div class = 'item1 groupA'>
        <img  src='xyz'  />
    </div>                  
    <div class = 'item1 groupA'>
        <img  src='xyz'  />
    </div>
    <div class = 'item1 groupB'> <!-- Start Group B -->
        <img  src='xyz'  />
    </div>
    <div class = 'item1 groupB'>
        <img  src='xyz'  />
    </div>                  
    <div class = 'item1 groupB'>
        <img  src='xyz'  />
    </div>                  
    <div class = 'item1 groupC'> <!-- Start Group C -->
        <img  src='xyz'  />
    </div>          
    <div class = 'item1 groupC'>
        <img  src='xyz'  />
    </div> <!-- All the way to group Z -->
</div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T19:16:51.660

编辑：您的要求非常具体。下面只是一个示例，用于遍历所有子元素并将计数和第一个元素存储在匹配计数中。让我来

```
$(function () {
    $.fn.benton = function () {
        //just the immediate childrens
        var $chds = $(this).children();

        var lc = {
            firstEl: {},
            classCount: {}
        };

        $.each ($chds, function (idx, el) {
            if (el.className) {
               var tokens = el.className.split(' ');
               for (var i = 0; i < tokens.length; i++) {
                   if (lc.classCount.hasOwnProperty(tokens[i])) {
                       lc.classCount[tokens[i]] += 1;
                   } else {
                       lc.classCount[tokens[i]] = 1;
                       lc.firstEl[tokens[i]] = $(el);
                   }
               }
            }
        });

        return lc;                   
    };

    var stats = $('.slider').benton();
    console.log(stats.classCount['groupA']);
    stats.firstEl['item1'].css({border: '1px solid red', width: 100, height: 10});
}); 
```

**演示：http:** [//jsfiddle.net/LhwQ4/1/](http://jsfiddle.net/LhwQ4/1/)

* * *

我认为您需要的是使用滑块的上下文来获取子元素..见下文，

```
var $slider = $('.slider') 
```

现在使用 $slider 上下文，

```
$('.groupA', $slider)
//Returns Array of jQuery object with elements has class `groupA`

$('.groupA:first', $slider)
//Returns first element in collection of element with class `groupA` 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T19:09:37.373

要获取具有相同类名的所有元素，您只需要使用一个简单的 jQuery 选择器。返回值是一个包含所有匹配元素的数组。

```
var groupA = $(".groupA"); 
```

要获取项目数，您只需访问数组的长度参数。

```
var groupALength = groupA.length; 
```

如果你只想提取任何匹配元素的第一个元素，你可以使用 jQuery 的`:first`选择器。

```
var firstElement = $(".groupA:first"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T19:36:38.290

好的，所以这个解决方案非常敏感。我正在对您的 HTML 做一些假设。

在您的示例中，您为每个项目提供了一个`item1`. 我假设这只是复制和粘贴元素的问题。每个“项目”应该具有相同的类，以便您可以使用一个选择器检索所有项目。对于我的例子，我假设一个`item`.

应该只有这个`item`类加上一个额外的“组”类。赋予该项目的任何其他类都会使该解决方案无效。

```
// fetch ALL items
var allItems = $(".item");

// initialize groups array
var groups = {};

$.each(allItems,function(index,elem){
  var item = $(this);
  var itemClass = item.attr('class');

  // remove the "item" class and any leftover whitespace
  itemClass = $.trim(itemClass.replace('item','')); // should now be groupA/groupB...

  // add item to array at the index of the group
  if (groups[itemClass] == undefined){
    groups[itemClass] = [];
  }

  groups[itemClass].push(item);
}); 
```

现在应该留下一个包含所有项目的数组数组。要查看此操作，您可以查看[此 jsFiddle](http://jsfiddle.net/sHYxr/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-17T19:41:49.253

```
var groups = {};
$(".slider").children().each(function(i, el) {
    var classes = el.className.split(/\s+/);
    for (var i=0; i<classes.length; i++)
        if (classes[i] in groups)
            groups[classes[i]].push(el);
        else
            groups[classes[i]] = [el];
}); 
```

`groups["groupA"]`现在，您可以通过etc（jQuery 集合：）访问组的所有元素，`$(groups["groupB"])`并通过`groups["groupC"][0]`. 组中元素的数量只是`length`数组的数量。

请注意，这会将所有元素放入组中`"item1"`- 我不知道您需要该类做什么。

# javascript - 检测溢出内容

> ID：12465584
> 
> 赞同：2
> 
> 时间：2012-09-17T19:04:28.437
> 
> 标签：javascript, jquery, html, css, overflow

我试图找到答案很长时间，但我没有找到任何东西。

我正在使用 contentEditable div 在 210x297mm 页面上准确编写文本。当页面结束时 javascript 添加下一个：

```
if(container.scrollHeight > container.clientHeight)
{
    page_number = page_number+1
    $('#editor').append('<div id="page_'+page_number+'" class="page" onkeyup="javascript:check_page(this);" contentEditable></div><div class="marginbottom"></div>');
    $("#page_"+page_number).attr("tabindex",-1).focus();
} 
```

一切正常，除非我在每页末尾的 div 中粘贴任何更长的文本。然后只有文本的一部分出现，其余部分在 div 之外（并且由于“溢出：隐藏”是不可见的）。

是否有任何 javascript/jquery 方法来检测溢出的内容并将其移动到下一页（我没有找到）或任何允许我分隔每个 div 内的文本的 CSS 样式？我读过 CSS3 多列，我需要做类似的操作，但分隔行，而不是列。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T19:10:17.433

我认为你最好的选择是不使用`overflow: hidden`但是`auto`并尝试通过检查滚动高度来检测是否存在溢出。

在这种情况下，您可以动态地开始移动部分文本（可能是逐字移动），直到内容适合可用空间。

对于一些具体的技术检查这个线程例如：[detect elements overflow using jquery](https://stackoverflow.com/questions/2059743/detect-elements-overflow-using-jquery)

# api - 我可以通过 Instagram 用户名查看帐户的照片吗？

> ID：12465585
> 
> 赞同：0
> 
> 时间：2012-09-17T19:04:38.130
> 
> 标签：api, photo, instagram

嗨，我想知道您是否可以通过 api 的用户名查看 istagram 的图片。

我有一个成员的博客，如果可以通过 Instagram 用户的用户名分享他们的照片，我想这样做。

这个网站如何[http://listagr.am](http://listagr.am)虽然我不认为这是一个正式的......

tnx 获取信息 :)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T19:10:32.803

根据[文档](http://instagram.com/developer/authentication/)：

> OAuth 2.0 规范允许您指定您向用户请求的访问范围。
> 
> [...]
> 
> **基本**- 读取与用户相关的任何和所有数据（例如，关注/关注列表、**照片**等）（默认授予）

我没有使用 API，但检索用户照片（一旦您授予访问权限）、流行照片（如[listagr.am](http://listagr.am/)的主页等）似乎是可行的。

**编辑：**如果您希望能够检索您知道其用户名的任何用户的照片，如果我理解错误，对不起，我对 API 没有足够的了解。

相关[讨论](https://groups.google.com/forum/?fromgroups=#!topic/instagram-api-developers/vLfi1TbodhY)，从 2011 年开始。

# java - （如何）我可以使用 JSoup 下载图像吗？

> ID：12465586
> 
> 赞同：36
> 
> 时间：2012-09-17T19:04:46.970
> 
> 标签：java, jsoup

我已经知道图像在哪里，但为了简单起见，我想使用 JSoup 本身下载图像。（这是为了简化获取 cookie、referrer 等）

这是我到目前为止所拥有的：

```
//Open a URL Stream
Response resultImageResponse = Jsoup.connect(imageLocation).cookies(cookies).ignoreContentType(true).execute();

// output here
OutputStreamWriter out = new OutputStreamWriter(new FileOutputStream(new java.io.File(outputFolder + name));
//BufferedWriter out = new BufferedWriter(new FileWriter(outputFolder + name));
out.write(resultImageResponse.body());          // resultImageResponse.body() is where the image's contents are.
out.close(); 
```

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-09-17T19:05:51.530

在通过 JSoup 和一些实验找到答案之前，我什至没有写完问题。

```
//Open a URL Stream
Response resultImageResponse = Jsoup.connect(imageLocation).cookies(cookies)
                                        .ignoreContentType(true).execute();

// output here
FileOutputStream out = (new FileOutputStream(new java.io.File(outputFolder + name)));
out.write(resultImageResponse.bodyAsBytes());  // resultImageResponse.body() is where the image's contents are.
out.close(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-08-08T11:43:21.597

只需您可以使用这些方法-

```
public static String storeImageIntoFS(String imageUrl, String fileName, String relativePath) {
    String imagePath = null;
    try {
        byte[] bytes = Jsoup.connect(imageUrl).ignoreContentType(true).execute().bodyAsBytes();
        ByteBuffer buffer = ByteBuffer.wrap(bytes);
        String rootTargetDirectory = IMAGE_HOME + "/"+relativePath;
        imagePath = rootTargetDirectory + "/"+fileName;
        saveByteBufferImage(buffer, rootTargetDirectory, fileName);
    } catch (IOException e) {
        e.printStackTrace();
    }
    return imagePath;
}

public static void saveByteBufferImage(ByteBuffer imageDataBytes, String rootTargetDirectory, String savedFileName) {
   String uploadInputFile = rootTargetDirectory + "/"+savedFileName;

   File rootTargetDir = new File(rootTargetDirectory);
   if (!rootTargetDir.exists()) {
       boolean created = rootTargetDir.mkdirs();
       if (!created) {
           System.out.println("Error while creating directory for location- "+rootTargetDirectory);
       }
   }
   String[] fileNameParts = savedFileName.split("\\.");
   String format = fileNameParts[fileNameParts.length-1];

   File file = new File(uploadInputFile);
   BufferedImage bufferedImage;

   InputStream in = new ByteArrayInputStream(imageDataBytes.array());
   try {
       bufferedImage = ImageIO.read(in);
       ImageIO.write(bufferedImage, format, file);
   } catch (IOException e) {
       e.printStackTrace();
   } 
```

}

# python - 将 JSON 模式转换为 python 类

> ID：12465588
> 
> 赞同：37
> 
> 时间：2012-09-17T19:05:21.913
> 
> 标签：python, json, jsonschema

是否有用于将 JSON 模式转换为 python 类定义的 python 库，类似于 jsonschema2pojo - [https://github.com/joelittlejohn/jsonschema2pojo](https://github.com/joelittlejohn/jsonschema2pojo) - 用于 Java？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-11-01T17:25:14.420

到目前为止，我能找到的最接近的东西是[warlock](http://pypi.python.org/pypi/warlock)，它宣传了这个工作流程：

**构建您的架构**

```
>>> schema = {
    'name': 'Country',
    'properties': {
        'name': {'type': 'string'},
        'abbreviation': {'type': 'string'},
    },
    'additionalProperties': False,
} 
```

**创建模型**

```
>>> import warlock
>>> Country = warlock.model_factory(schema) 
```

**使用您的模型创建对象**

```
>>> sweden = Country(name='Sweden', abbreviation='SE') 
```

然而，这并不是那么容易。术士生产的物品缺乏内省的好东西。如果它在初始化时支持嵌套字典，我无法弄清楚如何让它们工作。

提供一点背景知识，我正在研究的问题是如何使用[Chrome 的 JSONSchema API](http://trac.webkit.org/browser/trunk/Source/WebCore/inspector/Inspector.json)并生成请求生成器和响应处理程序树。Warlock 似乎并不太离谱，唯一的缺点是 Python 中的元类不能真正变成“代码”。

其他有用的模块寻找：

*   [jsonschema](http://pypi.python.org/pypi/jsonschema) - （术士建立在其之上）
*   [valideer](http://pypi.python.org/pypi/valideer) - 类似于 jsonschema 但名称更差。
*   [一堆](http://pypi.python.org/pypi/bunch)- 一个有趣的结构构建器，介于[dotdict](http://parand.com/say/index.php/2008/10/24/python-dot-notation-dictionary-access/)和[结构之间](http://construct.wikispaces.com/)

如果您最终为此找到了一个好的一站式解决方案，请跟进您的问题 - 我很想找到一个。我翻遍了 github、pypi、googlecode、sourceforge 等。只是找不到任何真正性感的东西。

由于缺乏任何预先制定的解决方案，我可能会自己与术士一起拼凑一些东西。所以如果我打败你，我会更新我的答案。:p

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2014-10-16T07:35:05.087

[python-jsonschema-objects](https://github.com/cwacek/python-jsonschema-objects)是 Warlock 的替代品，建立在 jsonschema 之上

python-jsonschema-objects 提供了一个基于类的自动绑定到 JSON 模式，以便在 python 中使用。

**用法：**

示例 Json 架构

```
schema = '''{
    "title": "Example Schema",
    "type": "object",
    "properties": {
        "firstName": {
            "type": "string"
        },
        "lastName": {
            "type": "string"
        },
        "age": {
            "description": "Age in years",
            "type": "integer",
            "minimum": 0
        },
        "dogs": {
            "type": "array",
            "items": {"type": "string"},
            "maxItems": 4
        },
        "gender": {
            "type": "string",
            "enum": ["male", "female"]
        },
        "deceased": {
            "enum": ["yes", "no", 1, 0, "true", "false"]
            }
    },
    "required": ["firstName", "lastName"]
} ''' 
```

将模式对象转换为类

```
 import python_jsonschema_objects as pjs
 import json
 schema = json.loads(schema)   
 builder = pjs.ObjectBuilder(schema)   
 ns = builder.build_classes()   
 Person = ns.ExampleSchema   
 james = Person(firstName="James", lastName="Bond")   
 james.lastName  
  u'Bond'  james      
 example_schema lastName=Bond age=None firstName=James 
```

验证 ：

> james.age = -2 python_jsonschema_objects.validators.ValidationError: -2 小于或等于 0

但问题是，它仍在使用 draft4validation，而 jsonschema 已移至 draft4validation，我在 repo 上提交了一个关于此的**问题。**除非您使用旧版本的 jsonschema ，否则上述软件包将如图所示工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-03-16T09:37:40.407

我刚刚创建了这个小项目来从 json 模式生成代码类，即使处理 python 我认为在业务项目中工作时也很有用：

```
pip install jsonschema2popo 
```

运行以下命令将生成一个包含 json-schema 定义的类的 python 模块（它使用 jinja2 模板）

```
jsonschema2popo -o /path/to/output_file.py /path/to/json_schema.json 
```

更多信息：[https ://github.com/frx08/jsonschema2popo](https://github.com/frx08/jsonschema2popo)

# django - 在 Django 中生成随机词

> ID：12465590
> 
> 赞同：0
> 
> 时间：2012-09-17T19:05:37.640
> 
> 标签：django, django-models, django-templates, django-views

我正在尝试在 Django 中进行民意调查，该民意调查从文本文件（单词列表）中获取单词以生成问题。例如，问题将是：你喜欢“披萨”吗？每次回答问题时，“ ”中的单词都会改变。除了随机词之外，我已经设置了所有内容。

我写了一个视图来随机选择一个单词并将其存储在一个数组中。

```
def selection(request):
           j = []
       with open('textFiles/food.txt', 'r') as f:
         for rida in f:
             rida = rida.rstrip()
            if rida: j.append(rida)
          else: break

       i = j[(randrange(0,4))] 
```

我的问题是：如何在模板中实现我的随机单词“i”来显示句子？我需要写另一个模型吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T19:25:45.083

放入`i`用于呈现 HTML 输出的上下文中。然后您可以使用`{{ i }}`模板内的语法访问它。

在您的视图结束时：

```
return render("some_template.html", {'i': i}) 
```

在视图中：

```
<p>Do you like {{ i }}?</p> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T19:20:48.047

您可以创建自定义模板标签。

[https://docs.djangoproject.com/en/dev/howto/custom-template-tags/#simple-tags](https://docs.djangoproject.com/en/dev/howto/custom-template-tags/#simple-tags)

# regex - 如何使用正则表达式检查第二个字母是否等于 a？

> ID：12465594
> 
> 赞同：-1
> 
> 时间：2012-09-17T19:05:59.290
> 
> 标签：regex, grep

我需要匹配一个第二个字母是“a”的字符串，我当前的正则表达式是： `^([^a-zA-Z]*[a-zA-Z][^a-zA-Z]*)a+` 但这比我需要的要少，我什至不知道它不匹配但你知道问题出在哪里，或者是否有更好的这样做的方式？例如我需要匹配这些：

```
"  kamcnn"
",.,ya..--/**+-00"
"0        0   q    a" 
```

我匹配了我能想象到的每一个字符串，但我得到的结果仍然比我应该得到的要低。编辑：“字母”是指来自 [a-zA-Z] 类的字符。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T19:09:23.347

尝试这个：

```
^[^a-zA-Z]*[a-zA-Z][^a-zA-Z]*a.* 
```

如果第二个 ASCII 字母是，则匹配整个字符串`a`：

```
^           # Start of string
[^a-zA-Z]*  # Match any number of non-letters
[a-zA-Z]    # Match one ASCII letter
[^a-zA-Z]*  # Match any number of non-letters
a           # Match an a
.*          # Match whatever follows 
```

# javascript - firebug 不断停止执行脚本

> ID：12465595
> 
> 赞同：3
> 
> 时间：2012-09-17T19:06:01.670
> 
> 标签：javascript, debugging, firebug

我一定是在 Firebug 中意外点击了某些东西，因为在我的网站上，它一直在停止执行，脚本控制台的空白处有一个小黄色箭头。

我似乎无法阻止这种情况的发生，而且我团队中的其他人都没有在同一页面上遇到 Firefox 的这个问题。

有没有办法重置调试器？

截图：[http ://chovy.dyndns.org/test/bug.png](http://chovy.dyndns.org/test/bug.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T19:07:52.773

在脚本选项卡中，清除所有断点（应在右侧的选项卡中列出）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-17T09:11:56.327

在 URL 栏中输入`about:config`，并确保将`extensions.firebug.breakOnErrors`首选项设置为 false 以*不*因错误而中断。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-07-01T04:53:24.997

从浏览器工具栏中的 Firebug 按钮打开菜单并选择最后一个选项“清空激活列表”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-11T15:10:33.653

如果您停用 Firebug（工具->Webdeveloper->Firebug->停用 Firebug），只要您保持 Firebug 关闭，问题就会消失。删除并重新安装 Firebug 可以永久解决它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-17T22:10:25.373

我无法解决这个问题。即使删除了 Firefox 配置文件 firebug 文件夹中的 breakpoints.json，它也会重新出现。我必须创建一个全新的配置文件并重新安装我所有的插件。这解决了问题。

在 mac 上，您可以执行此操作以调出配置文件管理器：

/Applications/Firefox.app/Contents/MacOS/firefox-bin -p

[http://support.mozilla.org/en-US/kb/profile-manager-create-and-remove-firefox-profiles](http://support.mozilla.org/en-US/kb/profile-manager-create-and-remove-firefox-profiles)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-17T19:16:29.523

在脚本选项卡中，单击向下箭头。并取消选择最后两个选项。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-09-16T15:46:52.370

您可以只停用脚本选项卡而不是整个萤火虫工具。

调出萤火虫，导航到脚本选项卡，单击向下箭头取消单击“启用”选项。然后再次做同样的事情，但这次启用它。

有一个类似的问题，很烦人，但这解决了它。

# java - 将 JScrollPane 的组件向左对齐？

> ID：12465600
> 
> 赞同：2
> 
> 时间：2012-09-17T19:06:17.220
> 
> 标签：java, swing, layout, alignment, jscrollpane

目前，我有一个 JScrollPane 嵌套在具有 BorderLayout 的面板中。更重要的是，在 JScrollPane 中，我打算垂直列出多个文本区域，其宽度不超过 JScrollPane 的宽度，以及所需的高度（滚动窗格只有一个垂直滚动条）。

我的问题是文本区域相对于最大的文本区域似乎在 JScrollPane 中居中，并且它们都是一行。

谁能告诉我，看看我的代码，我怎样才能让文本区域在滚动窗格的右侧之前换行，以及它们如何左对齐？

```
private JPanel generateStateView(State state) {
        //Create a new panel, and the info label.
        JPanel container = new JPanel(new BorderLayout());
        JLabel infoLabel = new JLabel("The state of " + state.getName() + 
                ", with " + state.getElectoralVotes() + " Electoral Votes.");
        container.add(infoLabel, BorderLayout.NORTH); //Put the label on top.
        //Will scroll through polls.
        JScrollPane pollViewer = new JScrollPane();
        //This will be the scroll pane's "viewport".
        JViewport pollViewport = new JViewport();
        //And finally, this will actually hold the individual polls.
        JPanel pollPanel = new JPanel(new GridLayout(
                state.getPolls().size(), 1));
        pollPanel.setAlignmentX(LEFT_ALIGNMENT);
        //Iteratively add the polls to the container
        for (Poll poll : state.getPolls()) {
            //Holds individual polls
            Box pollBox = Box.createHorizontalBox();
            //Create the poll's panel and add it to the poll container.
            pollBox.add(generatePollPanel(poll));
            pollBox.add(Box.createHorizontalGlue()); //Fill to the right
            pollBox.setAlignmentX(LEFT_ALIGNMENT);
            pollPanel.add(pollBox); //Put the box into the pollPanel.
        }
        //Put the panel into the viewport.
        pollViewport.add(pollPanel);
        //Put the viewport "into" the scroll pane
        pollViewer.setViewport(pollViewport);
        //Put the pane into the state view.
        container.add(pollViewer, BorderLayout.CENTER);
        return container; //And give back the container.
    }

    /**
     * Method: generatePollPanel
     * Purpose: Generates a panel containing information on a particular poll.
     * @param poll The poll to have information generated from.
     * @return The JPanel.
     */
    private JPanel generatePollPanel(Poll poll) {
        //Create a new panel, then a text area to fill with the info.
        JPanel pollPanel = new JPanel();
        JTextArea pollInfo = new JTextArea("Conducted by " + poll.getAgency() + 
                " on day " + poll.getDate() + " for " + poll.getNumDays() + 
                " days, " + poll.getPercentVoteDem() +
                "% voted Democrat, and " + poll.getPercentVoteRep() +
                "% voted Republican.");
        pollInfo.setEditable(false); //We don't want the user editing this.
        pollPanel.add(pollInfo); //Throw the area in, and return the panel.
        pollPanel.setAlignmentX(LEFT_ALIGNMENT);
        return pollPanel;
    }

    /**
     * Method: valueChanged
     * Purpose: Handle the event of a different list item being selected.
     * @param event The object containing information about this event.
     */
    public void valueChanged(ListSelectionEvent event) {
        //Instantiating JList with a type of ? seems to solve the issue of
        //eclipse complaining about an unchecked cast (originally to
        //JList<String>, so I should be able to cast child values directly
        //to string later on anyways.
        JList<?> stateList = (JList<?>) event.getSource();
        //Account for keyboard and mouse actions
        if (!event.getValueIsAdjusting()) {
            State chosenState; //Keep track of the picked state.
            try {
                //Try to get the currently selected state
                chosenState = db.findState((String) stateList.getSelectedValue());
            }
            catch (NoSuchElementException exception) {
                //Somehow the picked state was not found, notify the user.
                reportError("The selected state is not available.");
                return;
            }
            //Find the container for the gui window.
            Container container = getContentPane();
            //Remove the empty state view container by generating a new one.
            container.remove(currentStateView);
            //Generate the state view and add that to the container.
            currentStateView = generateStateView(chosenState);
            container.add(currentStateView, BorderLayout.CENTER);
            //Redraw everything.
            revalidate();
        }
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T09:28:24.863

看起来像一个严重*的嵌套丢失*案例:-)

虽然嵌套可以是实现布局要求的一种手段，但如果它没有给出预期的输出，就很难找出到底出了什么问题。此外，还有一般的警告信号，表明嵌套基本上有问题

*   具有不同管理器的深层容器
*   只有一个孩子的容器

在您的情况下，除了顶级边框布局之外的所有内容都有一个“netto”（即，不打算解决布局问题）子级，具有以下级别：

```
BorderLayout (the state view)
   GridLayout (the panel that's the scrollPane's view)
      BoxLayout (the panel that contains a single pollBox)
         FlowLayout (the panel that contains the textArea) 
```

遇到的问题：

*   文本区域是单行的，没有换行
*   文本区域居中

都是由于 LayoutManagers 的特性，部分（第一）或完全（第二）：

*   经理不应该的部分是 textArea 默认情况下不换行，您必须明确配置它才能这样做。由于管理器（== FlowLayout）的部分原因是它*总是*根据他们的 prefSize 布置它的孩子，没有别的。这归结为有一个固定的孩子大小，无论有多少空间可供父母使用。因此，即使 textArea 被配置为换行，它也会保持初始大小，无论其父级可以得到多宽。
*   内部 FlowLayout 对齐其子级...居中。因此，您在 BoxLayout 级别上设置的任何对齐方式都没有任何效果。胶水不是这样：只有当其他孩子/人在该维度上具有最大尺寸时，它才会占用*所有*多余的空间（带有 FlowLayout 的面板没有，仅仅是因为简单的 LayoutManager 没有最大，只有 LayoutManager2 类型的管理器有）

是时候退后一步并查看初始要求了：

> 垂直列出的多个文本区域，其宽度不超过 JScrollPane 的宽度，以及所需的高度

零阶解是

*   根据需要配置 textArea
*   丢弃所有布局嵌套（在 scrollPane 内）

在代码中：

```
JComponent overview = new JPanel(new BorderLayout());
overview.add(new JLabel("All polls for state XY"), BorderLayout.NORTH);

JComponent pollPanel = new JPanel(); 
pollPanel.setLayout(new BoxLayout(pollPanel, BoxLayout.PAGE_AXIS));
for (int i = 0; i < 10; i++) {
    pollPanel.add(generatePollTextArea(i)); //Put the box into the pollPanel.
}
pollPanel.add(Box.createVerticalGlue());
JScrollPane pollViewer = new JScrollPane(pollPanel);
overview.add(pollViewer);
showInFrame(overview, "layout text only");

protected JComponent generatePollTextArea(int i) {
    String agency = "agency ";
    // simulates different size text
    for (int j = 0; j < i; j++) {
        agency += i;
    }
    String text = "Conducted by " + agency + 
            " on day " + "today" + " for " + 20 + 
            " days, " + 99 +
            "% voted Democrat, and " + 0.2 +
            "% voted Republican.";
    JTextArea pollInfo = new JTextArea(text); 
    // give it some reasonable initial width
    // in terms of content
    pollInfo.setColumns(20);
    pollInfo.setLineWrap(true);
    pollInfo.setWrapStyleWord(true);
    pollInfo.setEditable(false); //We don't want the user editing this.
    return pollInfo;
} 
```

“Das Wort zum Dienstag”：嵌套布局并不是一种避免学习嵌套布局的各个级别上使用的 LayoutManager 特征的方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-17T19:56:41.023

首先，我不认为`Box`应该与其他任何东西一起使用`BoxLayout`（我可能是错的，但这就是我的阅读方式）

就个人而言，我会使用其中一个`GridBagLayout`或[`VerticalLayout`](http://download.java.net/javadesktop/swinglabs/releases/0.8/docs/api/org/jdesktop/swingx/VerticalLayout.html)来自 SwingLabs。

为了方便横向限制，你还会想看看[Scrollable](http://docs.oracle.com/javase/7/docs/api/javax/swing/Scrollable.html)界面，特别是[`getScrollableTracksViewportWidth`](http://docs.oracle.com/javase/7/docs/api/javax/swing/Scrollable.html#getScrollableTracksViewportWidth%28%29)

# python - 从函数中退出（）是不好的形式吗？

> ID：12465605
> 
> 赞同：1
> 
> 时间：2012-09-17T19:06:37.233
> 
> 标签：python, function

`exit()`从函数内部是不好的形式吗？

```
def respond_OK():
    sys.stdout.write('action=OK\n\n')
    sys.stdout.flush() # redundant when followed by exit()
    sys.exit(0) 
```

而不是设置退出代码并`exit()`从`__main__`名称空间中获取？

```
def respond_OK():
    global exit_status
    sys.stdout.write('action=OK\n\n')
    sys.stdout.flush()
    exit_status = 0

sys.exit(exit_status) 
```

从功能的角度来看，差异可以忽略不计，只是想知道在形式上的共识是什么。如果你在别人的代码中找到了先验，你会看两次吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-17T19:13:49.957

我希望看到从主入口点引发和处理的异常，其类型被转换为退出代码。在 python 中子类化异常非常简单，几乎很有趣。

正如这个答案的评论中所发布的：使用 sys.exit 还意味着终止点需要知道实际的状态代码，而不是它遇到的错误类型。当然，这可以通过一组常数来解决。但是，使用异常还有其他优点：如果一种方法失败，您可以尝试另一种方法而无需重新输入，或者打印一些事后调试信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-17T19:09:33.570

它在功能方面没有区别，但它可能会使您的代码更难遵循，除非您采取适当的步骤，例如注释来自可能导致退出的主命名空间的每个调用。

更新：请注意@mgilson 的回答是捕获异常的效果[有可能捕获`system.exit`引发的异常，从而防止退出]。这样你可以让你的代码更加混乱。

更新 2：注意 @sapht 建议使用异常来协调退出。这是一个很好的建议，如果你真的想做一个非本地出口。比设置全局要好得多。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-17T19:52:10.723

在某些情况下，它是相当地道的。

如果用户给你错误的命令行参数，而不是这个：

```
def usage(arg0):
  print ... % (arg0,)
  return 2

if __name__ == '__main__':
  if ...:
    sys.exit(usage(sys.argv[0])) 
```

你经常会看到这样的：

```
def usage():
  print ... % (sys.argv[0],)
  sys.exit(2)

if __name__ == '__main__':
  if ...:
    usage() 
```

我能想到的唯一其他常见情况是初始化某些库（通过 ctypes 或低级 C 扩展模块）意外失败并让您处于无法推理的状态，因此您只想尽快退出尽可能（例如，减少段错误或打印垃圾的机会）例如：

```
if libfoo.initialize() != 0:
  sys.exit(1) 
```

有些人可能会反对，因为`sys.exit`实际上并没有尽快退出解释器（它抛出并捕获异常），所以这是一种错误的安全感。但是你仍然经常看到它。

# node.js - 安装 Yeoman 时遇到问题

> ID：12465607
> 
> 赞同：3
> 
> 时间：2012-09-17T19:06:44.800
> 
> 标签：node.js, npm, yeoman

大家好，我正在尝试安装 Yeoman，但是当我尝试通过 npm 安装软件包时，出现以下错误。

```
sudo npm install -g yeoman
npm http GET https://registry.npmjs.org/yeoman
npm http 200 https://registry.npmjs.org/yeoman
npm http GET https://registry.npmjs.org/yeoman/-/yeoman-0.9.1.tgz
npm http 200 https://registry.npmjs.org/yeoman/-/yeoman-0.9.1.tgz
npm ERR! error rolling back Error: ENOTEMPTY, rmdir '/usr/local/share/npm/lib/node_modules/yeoman/node_modules/grunt/node_modules/nodeunit/node_modules/tap/node_modules/runforcover/node_modules/bunker/node_modules/burrito/node_modules/.bin'
npm ERR! error rolling back  yeoman@0.9.1 { [Error: ENOTEMPTY, rmdir '/usr/local/share/npm/lib/node_modules/yeoman/node_modules/grunt/node_modules/nodeunit/node_modules/tap/node_modules/runforcover/node_modules/bunker/node_modules/burrito/node_modules/.bin']
npm ERR! error rolling back   errno: 53,
npm ERR! error rolling back   code: 'ENOTEMPTY',
npm ERR! error rolling back   path: '/usr/local/share/npm/lib/node_modules/yeoman/node_modules/grunt/node_modules/nodeunit/node_modules/tap/node_modules/runforcover/node_modules/bunker/node_modules/burrito/node_modules/.bin' }
npm ERR! Error: ENOTEMPTY, rmdir '/usr/local/share/npm/lib/node_modules/yeoman/node_modules/grunt/node_modules/nodeunit/node_modules/tap/node_modules/runforcover/node_modules/bunker/node_modules/burrito/node_modules/.bin'
npm ERR! If you need help, you may report this log at:
npm ERR!     <http://github.com/isaacs/npm/issues>
npm ERR! or email it to:
npm ERR!     <npm-@googlegroups.com>

npm ERR! System Darwin 11.4.0
npm ERR! command "node" "/usr/local/bin/npm" "install" "-g" "yeoman"
npm ERR! cwd /Users/chris
npm ERR! node -v v0.8.9
npm ERR! npm -v 1.1.61
npm ERR! path /usr/local/share/npm/lib/node_modules/yeoman/node_modules/grunt/node_modules/nodeunit/node_modules/tap/node_modules/runforcover/node_modules/bunker/node_modules/burrito/node_modules/.bin
npm ERR! code ENOTEMPTY
npm ERR! errno 53
npm ERR! 
npm ERR! Additional logging details can be found in:
npm ERR!     /Users/chris/npm-debug.log
npm ERR! not ok code 0 
```

我以前使用过 node 和 npm，但我从来没有遇到过这样的错误。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-17T23:53:12.810

`notempty`尝试使用 删除某个文件夹时出现错误`rmdir`。我不完全确定为什么会这样……但是……

```
rm -rf /usr/local/share/npm/lib/node_modules/yeoman
sudo npm install -g yeoman 
```

# python - python：带有中位数和CI的散点图

> ID：12465608
> 
> 赞同：1
> 
> 时间：2012-09-17T19:06:46.660
> 
> 标签：python, median, scatter-plot

我正在寻找关于[http://www.r-bloggers.com/visually-weighted-watercolor-plots-new-variants-please-vote/行的 python 图](http://www.r-bloggers.com/visually-weighted-watercolor-plots-new-variants-please-vote/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2017-10-03T21:15:52.303

这给出了标准偏差带的等价物：

```
# generate random variables
x,y = generate_random()

# bin the values and determine the envelopes
df = bin_by(x, y, nbins=25, bins = None)

###
# Plot 1
###
# determine the colors
cols = ['#EE7550', '#F19463', '#F6B176']

with plt.style.context('fivethirtyeight'): 
    # plot the 3rd stdv
    plt.fill_between(df.x, df['5th'], df['95th'], alpha=0.7,color = cols[2])
    plt.fill_between(df.x, df['10th'], df['90th'], alpha=0.7,color = cols[1])
    plt.fill_between(df.x, df['25th'], df['75th'], alpha=0.7,color = cols[0])
    # plt the line
    plt.plot(df.x, df['median'], color = '1', alpha = 0.7, linewidth = 1)
    # plot the points
    plt.scatter(x, y, facecolors='white', edgecolors='0', s = 5, lw = 0.7)

plt.savefig('fig1.png', facecolor='white', edgecolor='none')
plt.show()

def bin_by(x, y, nbins=30, bins = None):
    """
    Divide the x axis into sections and return groups of y based on its x value
    """
    if bins is None:
        bins = np.linspace(x.min(), x.max(), nbins)

    bin_space = (bins[-1] - bins[0])/(len(bins)-1)/2

    indicies = np.digitize(x, bins + bin_space) 
```

[![水彩情节](../Images/27cf7eeda8962c66109106fffd6ecffc.png)](https://i.stack.imgur.com/rK6DG.png)

[一些讨论并从我的博客](https://reckoningrisk.com/watercolor-regression/)链接到我的 Github

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-02T16:27:43.100

从我的大段代码中剪切粘贴。它没有给我想要的东西。我根据 Evert 的建议发布

```
 fig = plt.figure(figsize=(8, 8))
    plt.plot(xlist, ylist, 'b,')
    plt.plot([0.0,0.8],[0.0,0.8],'y-')
    data2d=zip(xlist,ylist)
    bins = np.linspace(0.0, 0.2, 21)
    medianlist=binpercentile(data2d,bins)
    c10list=binpercentile(data2d,bins,0.1)
    c90list=binpercentile(data2d,bins,0.9)    
    centerbins=[(x+y)/2.0 for x,y in zip(bins[:-1],bins[1:])]
    centerbins.insert(0,0)
    medianlist.insert(0,0)
    c10list.insert(0,0)
    c90list.insert(0,0)
    plt.plot(centerbins,c10list,'r--')
    plt.plot(centerbins,c90list,'r--')
    plt.plot(centerbins,medianlist,'r-')
    imagefilename='%s.%s'%('.'.join(infile.split('.')[0:-1]),'diffmed.pdf')
    plt.savefig(imagefilename) 
```

# javascript - 如何使用 WORD 作为分隔符在 JavaScript 中溢出字符串？

> ID：12465610
> 
> 赞同：1
> 
> 时间：2012-09-17T19:07:02.627
> 
> 标签：javascript, regex, string, delimiter

感谢您的关注！

使用 JavaScript，如何使用整个单词作为分隔符来拆分字符串？例子：

```
var myString = "Apples foo Bananas foo Grapes foo Oranges";
var myArray = myString.split(" foo ");

//myArray now equals ["Apples","Bananas","Grapes","Oranges"]. 
```

提前致谢。

## 更新

非常抱歉，我有一个不相关的错误阻止了它之前的工作。我如何关闭这个问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-17T19:08:35.630

……就像你展示的那样？

```
> "Apples foo Bananas foo Grapes foo Oranges".split(" foo ")
["Apples", "Bananas", "Grapes", "Oranges"] 
```

您还可以使用正则表达式作为分隔符：

```
> "Apples foo Bananas foo Grapes foo Oranges".split(/ *foo */)
["Apples", "Bananas", "Grapes", "Oranges"] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-17T19:15:53.673

如果它只能是一个*完整*单词（浆果，但不是黑莓）的分隔符，则可以在正则表达式中使用*单词边界：*

```
var arr = fruityString.split(/\bfoo\b/); 
```

请注意[，](https://stackoverflow.com/questions/832257/javascript-multiple-replace/9514142#9514142)*破折号*（`-`_

# java - 在不同的类中使用监听器

> ID：12465611
> 
> 赞同：0
> 
> 时间：2012-09-17T19:07:05.630
> 
> 标签：java, swing, listener, jtree

我有一个 MainInterface 和其他一些类。其他类是我添加到 MainInterface 的 GUI 元素。在 TreeClass 中，我使用 Tree 来选择不同的事物。在这个类中，我有一个 TreeListener 对 TreeSelection 做出反应。

我的目标是，当我在树中选择某些内容时，MainInterface 会根据选择做出反应。我必须在命名的类（JPanel Red 和 JPanel Blue）旁边进行类。根据选择，必须出现两个类（扩展 JPanel）。

我已经在 MainInterface 中使用 Buttons 进行了尝试，并且成功了。但我不知道该怎么做是，这两个类基于 TreeClass 中的 TreeSelectionListener 切换......所以我的主要问题是，我不知道 MainInterface 如何监听树......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T13:24:54.497

听起来您`MainInterface`应该将自己注册为树模型的[树选择侦听](http://docs.oracle.com/javase/tutorial/uiswing/events/treeselectionlistener.html)器。页面底部有一个示例。

# mysql - MySQL 将多列拆分为多行

> ID：12465613
> 
> 赞同：1
> 
> 时间：2012-09-17T19:07:23.407
> 
> 标签：mysql, select

我有一个客户提供的数据集，如下所示：（简化）

```
|ForiegnKey|Code1|Code2|Code3|  
|==========|=====|=====|=====|  
|A         |10   |20   |30   |  
|A         |10   |20   |30   |  
|B         |100  |200  |     |  
|C         |25   |35   |40   |  
|D         |1000 |     |     | 
|E         |     |     |9999 | 
```

对于最终产品，我需要一次将其输入到新的表 1 代码中，如下所示：

```
|ForiegnKey|Sequence|Code|
|A         |1       |10  |
|A         |2       |20  |
|A         |3       |30  |
|B         |1       |100 |
|C         |1       |25  |
|C         |2       |35  |
|C         |3       |40  |
|D         |1       |1000|
|E         |1       |9999| 
```

对于我的问题，是否有一种简单的方法可以在不涉及使用联合的查询中执行此操作？
我必须根据 ForiegnKey 的值生成序列号（即在 ForiegnKey E 的情况下，即使它在列 Code3 中，我也需要它的序列为 1。）我目前的思路是，如果我可以在不使用联合的情况下将其从表中取出，我可以在同一语句中生成序列 ID。
应跳过 D-2 和 3 以及 E-1 和 2 等空代码值。
我已经开始使用临时表来解决这个问题，但我想我会在这里检查一下，看看是否有更简单的方法。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T20:16:12.370

与避免 UNIONS 相比，您听起来更有兴趣在一批中获得结果。干得好：

```
set @last_key = null;
set @seq = 1;
select foreignkey, case when @last_key is null or @last_key != foreignkey then @seq := 1 else @seq := @seq + 1 end as sequence, code, @last_key := foreignkey as foo  from (
  select foreignkey, code1 as code
  from dataset
  where code1 is not null
  union
  select foreignkey, code2
  from dataset
  where code2 is not null
  union
  select foreignkey, code3
  from dataset
  where code3 is not null
  order by 1
) foo; 
```

# node.js - 使用咖啡脚本的节点中的全局变量

> ID：12465615
> 
> 赞同：2
> 
> 时间：2012-09-17T19:07:44.470
> 
> 标签：node.js, coffeescript, express

我检查了这个[如何在 CoffeeScript 中定义全局变量？](https://stackoverflow.com/questions/4214731/coffeescript-global-variables) 用于声明全局变量，即在 app.js 中声明并在 routes/index.coffee 中访问

我在 app.coffee 中声明 (exports ? this).db = redis.createClient() 并尝试使用 db.set('online',Date.now(), (err ,reply) -> console.log(reply.toString()) ) 这似乎不起作用......发生了什么......我在节点 0.8.9

还有其他方法可以使用，但很想知道发生了什么……还尝试了 app.coffee 中的 @db = redis.createClient() ，但它也不起作用

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-17T20:24:44.107

`exports`没有定义“*全局*”；它定义了模块的“*公共*”成员，可通过`require`. 此外，`exports`最初总是定义和`exports === this`，因此`(exports ? this)`实际上并没有做任何事情。

然而，由于全局变量通常不受欢迎（并且确实破坏了 Node 模块系统的某些意图），Web 应用程序的一种常见方法是定义一个自定义中间件，允许访问`db`作为`req`or`res`对象的属性：

```
# app.coffee
app.use (req, res, next) ->
  req.db = redis.createClient()
  next() 
```

```
# routes/index.coffee
exports.index = (req, res) ->
  req.db.set('online', Date.now(), (err,reply) -> console.log(reply)) 
```

可以在[npmjs.org](https://npmjs.org/)后面的存储库[`decorate.js`](https://github.com/isaacs/npm-www/blob/c54bac79fd99403ae1341eec98a05fb703eac13b/decorate.js#L57-185)中找到一个示例：[`npm-www`](https://github.com/isaacs/npm-www)

```
function decorate (req, res, config) {
  //...

  req.model = res.model = new MC

  // ...

  req.cookies = res.cookies = new Cookies(req, res, config.keys)
  req.session = res.session = new RedSess(req, res)

  // ...

  req.couch = CouchLogin(config.registryCouch).decorate(req, res)

  // ...
} 
```

不过，如果您仍想定义`db`为全局`global`变量，Node.JS 定义了一个您可以附加到的变量：

```
global.db = redis.createClient() 
```

# java - JInternalFrame 不会出现

> ID：12465619
> 
> 赞同：1
> 
> 时间：2012-09-17T19:07:59.153
> 
> 标签：java, swing, concurrency, event-dispatch-thread, jinternalframe

我有一个名为 GameUpdater 的 java 类，它扩展了 JInternalFrame。当我将类作为程序单独运行时，它曾经扩展 JFrame，但我将其更改为 JInternalFrame 以成为更大应用程序的一部分 - 现在可以通过菜单按钮访问。

当我按下这个菜单按钮时调用的函数如下：

```
private void update(){

    GameUpdater gu = new GameUpdater();
    desktop.add(gu); //add to JDesktopPane
    gu.setSize(400, 300);
    gu.setVisible(true);

    gu.readMatches();//this function takes ages

    gu.setMatch("Updating database...");//this is some output to the user, displays info in the internal frame
    //try and insert into database
    for(Match m : gu.getMatches()){
        db.insertMatch(m);
    }
    gu.setMatch("DONE"); //now it shows the frame, way too late
} 
```

gu.readMatches() 方法执行需要很长时间，因此它会定期更新 JInternalFrame 中的内容以显示其进度。但是，在此更新功能完成之前，不会显示框架！

就像 setVisible(true) 一直等到函数结束......

当它是 JFrame 时，它​​工作得非常好。JInternalFrame 是否有任何奇怪的属性会导致这种情况？

干杯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T19:39:37.737

[听起来您正在事件调度线程](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/dispatch.html)(EDT)中执行一个耗时的过程，这将防止事件队列处理（除其他外）重绘请求。

这将使您的程序看起来好像它已“挂起”。

您需要将此任务卸载到后台线程。

阅读[Swing 中的 Concurrency](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/index.html)，尤其是关于[Worker Threads 和 SwingWorker的部分](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/worker.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T19:40:25.283

问题是您正在阻止您的[EDT](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/dispatch.html)，这可以通过简单地创建一个新的`Thread`/ `Runnable`thar 调用 `gu.readMatches();`该方法来解决：

```
SwingUtilities.invokeLater(new Runnable() {
@Override
public void run() {
gu.readMatches(); //gu will have to be declared `final`

gu.setMatch("Updating database...");//this is some output to the user, displays info in the internal frame
//try and insert into database
for(Match m : gu.getMatches()){
    db.insertMatch(m);
}
}
}); 
```

当然，尽管您可能想要实现 a`JProgressBar`以便用户可以跟踪*读数*的距离。

# c# - 将依赖元素添加到尚未创建的博客 - asp.net

> ID：12465620
> 
> 赞同：0
> 
> 时间：2012-09-17T19:08:27.543
> 
> 标签：c#, asp.net

我在标题中提到了 asp.net，因为这是我正在使用的技术，但这可能是一个更普遍的“最佳实践”问题。

我有一个“创建博客”页面，我想允许用户在第一页上添加所有图像 - 但是，没有 BlogID，因为它实际上还没有被创建。当没有 parentID 关联时，添加 imageID 的最佳方法是什么？

我一直在研究一些方法，例如将图像添加到 a `static DataTable`，然后在创建博客后循环遍历并添加 imageID。我还考虑过将 imageID 存储在会话中并循环播放。我还考虑过将它们添加到数据库中的挂起表中，并以 Guid 作为标识符，然后在创建博客后处理这些。不过，这些方法对我来说似乎都不是特别干净——有没有更好的方法是我没有想到的？

谢谢

# cakephp - 将 Cakephp 表单嵌入 Wordpress

> ID：12465621
> 
> 赞同：1
> 
> 时间：2012-09-17T19:08:30.807
> 
> 标签：cakephp, wordpress

我有一个 Wordpress 博客，我正在使用 Cakephp 开发一个后端应用程序。

我想使用 cake 开发博客的联系表（因为输入的信息可以从后端应用程序中获得）。

现在，我尝试使用 ajax 将蛋糕视图包含到 wp 中。这种方法的问题是我要么使用 a `Js->submit`，这使得将文件附加到表单非常复杂，要么我使用 a `Form->submit`，这使得显示验证错误有问题。此外，它还会导致 recaptcha 插件不显示的问题。

有没有办法使用 php 集成表单？我不需要身份验证（它是一个公共表单），但我需要能够在表单上显示验证错误并在表单上上传文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T21:16:10.963

实际上，您可以使用 CURL 将任何网站加载到字符串中，如果您使用 wordpress 中的占位符加载空白页面，则可以将其用作布局

```
<?php 
$url = "http://www.yourdomain.com/emptypage";
$curl = curl_init($url);
curl_setopt($curl, CURLOPT_RETURNTRANSFER, TRUE);
$output = curl_exec($curl);
curl_close($curl)

$placeholder = "{{CONTENT}}"
$placeholderPos = strpos($output,$placeholder);

$beginning = substr($output,0,$placeholderPos);
$end = substr($output,$placeholderPos+strlen($placeholder));

echo $beginning;

////// your form ////// 

echo $end;

?> 
```

之后您可能必须处理相对路径，但这应该可以帮助您入门。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-25T20:01:16.090

所以，我终于找到了一种我认为最好的方法，因为它使用了蛋糕类。

我在 webroot 上创建了一个文件 new_file.php，它基本上是 index.php 的副本，但它没有使用通用请求，而是请求我正在寻找的特定页面：

```
$Dispatcher = new Dispatcher();
$Dispatcher->dispatch(new CakeRequest('CONTROLLER/ACTION'), new CakeResponse(array('charset' => Configure::read('App.encoding')))); 
```

当然，您必须将“控制器/操作”更改为您的控制器。

之后，您只需要将文件包含在 WordPress 插件中。

只有一个变化。有些方法与 WP 声明冲突。当您包含上述文件时，PHP 会报错。您必须找到这些方法并将它们包装到 if 中以确保该方法未被重新声明。这可能会破坏某些功能，例如本地化（函数 __()），但如果您包含的不是一个非常复杂的蛋糕应用程序，那也没关系。

```
if (!function_exists('methodName')) { 
```

希望一旦 Cake 3 支持命名空间，最后一个问题将得到解决。

# git - 使用 git 推送时显示进度条

> ID：12465639
> 
> 赞同：9
> 
> 时间：2012-09-17T19:09:59.483
> 
> 标签：git, git-push

我正在尝试使用将一个大文件推送到`git`存储库，`git push -u origin master`但它在中途失败了。如果我能看到它何时失败，那将有很大帮助。有没有办法显示类似进度条的东西`git push`？

**编辑：**在我的第 7 次或第 8 次试验中，我终于可以用蛮力推送文件，但我仍然对这个问题感到好奇。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-01-13T23:47:47.377

```
git push -v origin 
```

告诉我足够了。

# html - 浏览器是否会在 CSS 文件中预加载图像，而不管在页面上使用什么？

> ID：12465641
> 
> 赞同：0
> 
> 时间：2012-09-17T19:10:14.597
> 
> 标签：html, css, performance, yslow, preloading

我的一个朋友在[http://analyze.websiteoptimization.com/](http://analyze.websiteoptimization.com/)上扔了一个我通过该工具制作的网站。当他回到我身边时，他坚持说我的浏览器只在网站的主页上预加载了大量不相关的图像。

我回到他身边，坚持认为 YSlow（以及浏览器中的其他“网络”标签）证明只有专门显示的图像和内容才会加载到主页上——没有别的。我坚持认为该站点的统计数据仅用于*完整*访问该站点并下载所有必需的图像。

然而，他并不相信，认为某些浏览器（即 IE）无论如何都会预加载那些不相关的内容。出于这个原因，他使用全局 CSS 样式表，然后通过加载单独的样式表将更改应用于各个页面。

我认为最好的做法是*尽量减少*对服务器的请求，而不是添加更多，这就是我们有 CSS sprites 的原因。我还认为浏览器*永远不会*加载图像，除非需要它们来显示页面。

***我不相信我可以接受没有健康讨论的答案。***

*   我是否正确，因为浏览器没有在每个页面上加载所有内容？
*   上面的工具不正确吗？
*   我朋友从工具结果中学到的教训不正确吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T19:50:19.810

浏览器通常只会加载页面中实际显示的内容。（然而，在一些异国情调的浏览器中可能会有例外，比如 Opera Mini。）

WebSiteOptimization 工具只会查看 HTML 和 CSS 中引用了哪些图像，而不是页面中实际使用了哪些图像。

当我分析我自己的网页时，该网页有八张不同的背景图像，每次显示一张随机选择，该工具说所有八张图像都已加载，只是因为它们在 CSS 中。检查 Firebug 和 IE 开发人员工具中的网络流量表明它们不是。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-17T19:16:49.710

据我说

浏览器有时会加载缓存的图像，但较新的更新可以检查图像是否已更改。还有一些权限，编码人员可以设置是否允许浏览器缓存。当使用 yslow 或**Google page speed**时，这是一个更好的工具，请尝试使用 control+f5 刷新您的页面，以便在没有任何脱机文件的情况下强制重新加载网站。您还可以根据自己的喜好设置浏览器权限。

我还想补充一点关于您的最后一行的信息，即使隐藏了 css 属性，浏览器也会加载代码中链接的所有图像。

它总是先加载 img 标签中的东西，然后加载 css 代码中的所有图像。

它还将按顺序处理图像请求，即先到先服务器

我希望这会有所帮助。

# sql - 从日期时间和星期几名称计算多少小时

> ID：12465642
> 
> 赞同：0
> 
> 时间：2012-09-17T19:10:14.360
> 
> 标签：sql, sql-server

我需要一些关于我的 SQL 的帮助。如何添加一周中的某一天并计算当天工作了多少小时。

```
 SELECT CONVERT(date,startTimeStamp) AS DATE
      ,CONVERT(time,[startTimeStamp])AS StartTime
      ,CONVERT(time,[endTimeStamp])AS EndTime
      ,CONVERT(time,[startTimeStamp])+ CONVERT(time,[endTimeStamp])
  FROM [TaskManagementSystem_DB].[dbo].[Timesheet_entry] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T19:22:06.760

在 MSSQL 中，这应该有效

```
 SELECT CONVERT(date,startTimeStamp) AS DATE
      , datename(dw,CONVERT(date,startTimeStamp)) as dayOfWeek
      ,CONVERT(time,[startTimeStamp])AS StartTime
      ,CONVERT(time,[endTimeStamp])AS EndTime
      ,CONVERT(time,[startTimeStamp])+ CONVERT(time,[endTimeStamp])
  FROM [TaskManagementSystem_DB].[dbo].[Timesheet_entry] 
```

# python - 在 Python 中查找具有非常大数字的未知指数

> ID：12465649
> 
> 赞同：-1
> 
> 时间：2012-09-17T19:10:54.320
> 
> 标签：python, modulo, exponent

我试图`d`在 Python 中找到，这样

```
(2 ** d) mod n = s2 
```

在哪里`n =`

```
132177882185373774813945506243321607011510930684897434818595314234725602493934515403833460241072842788085178405842019124354553719616350676051289956113618487539608319422698056216887276531560386229271076862408823338669795520077783060068491144890490733649000321192437210365603856143989888494731654785043992278251 
```

和`s2 =`

```
18269259493999292542402899855086766469838750310113238685472900147571691729574239379292239589580462883199555239659513821547589498977376834615709314449943085101697266417531578751311966354219681199183298006299399765358783274424349074040973733214578342738572625956971005052398172213596798751992841512724116639637 
```

我不是在寻找解决方案，而是在寻找一种相当快速的方法来做到这一点。我尝试过使用`pow`和插入不同的值，但这很慢并且永远不会得到解决方案。我怎样才能找到`d`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T19:25:45.933

没有已知的算法可以解决您的问题。它被称为[离散对数问题](http://en.wikipedia.org/wiki/Discrete_logarithm)，一些密码系统取决于它的复杂性（除非你知道 n 的因式分解，否则你无法快速找到它的解决方案）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T19:49:27.727

查看[Is it possible to get RSA private key known public key 和一组“原始数据=>加密数据”条目的第二个答案？](https://stackoverflow.com/questions/2659477/is-it-possible-to-get-rsa-private-key-knowing-public-key-and-set-of-original-da). 已知明文攻击并不比已知密文容易。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T19:41:08.107

唯一已知的离散对数求解器是围绕知道这些因素而构建的。如果您没有因子，则需要生成它们。

最好的合理时间算法是[Shor 算法](http://en.wikipedia.org/wiki/Shor%27s_algorithm)。问题是您需要一台具有足够量子比特的量子计算机，而目前还没有人为您的样本数据构建足够大的量子计算机。看起来还需要几年时间才能有人这样做。目前人们仍然对像 15 和 21 这样的因式分解感到兴奋。

如果您想使用经典计算，那么最知名的算法远非“相当快”。我相信最近有人表明 2^1039-1 的波恩结果应该可以在 4 个月内用现代 PC 重现。再过5年，也许会缩短到一个月。

没有已知的合理的快速算法，你不应该感到惊讶，因为如果有，大多数私钥加密将是可破解的，因此毫无价值。如果有人给了您您正在寻找的答案，那将是重大新闻。（是否有“P = NP？”的问题）

# android - 如何优化 Android 上的外部存储文件搜索

> ID：12465652
> 
> 赞同：0
> 
> 时间：2012-09-17T19:11:04.020
> 
> 标签：android, file, path, android-sdcard, dir

**要求**

扫描外部存储上的所有文件夹和文件以查找所有 apk 文件，并为每个 apk 文件获取信息并显示进度。

**到目前为止我是怎么做到的**

我最初的想法是，这是一件很容易实现的事情。但是好吧......即使它有点工作，它也没有达到预期的效果。

我使用 AsyncTask 在后台执行扫描。这是我的做法：

```
 private ArrayList<String> sdcardAppsPath;

  protected class ScanTask extends AsyncTask<Context, Scanner, ArrayList<Apk>> {
     private ArrayList<Apk> sdcardApps;  
    @Override
        protected ArrayList<App> doInBackground(Context... params) {

            visitAllDirsAndFiles(Environment.getExternalStorageDirectory());
            for (String path : sdcardAppsPath) {
                //get info about apk file and
                publishProgress(values)  //show in some textviews number of files scanned, total files
                sdcardApps.add(currentScannedItemFoundInfo);
            }
          return sdcardApps
    }

    @Override
        protected void onProgressUpdate(Scanner... values) {
            super.onProgressUpdate(values);
           // update some textView texts based on values
       }   
    } 
```

和

```
 // Process all files and directories under dir
        public void visitAllDirsAndFiles(File dir) {
            if (dir != null) {
                if (dir.getAbsoluteFile().toString().endsWith(".apk")) {
                    sdcardAppsPath.add(dir.getAbsoluteFile().toString());
                }

                if (dir.isDirectory()) {
                    String[] children = dir.list();
                    if (children != null) {
                        for (int i = 0; i < children.length; i++) {
                            visitAllDirsAndFiles(new File(dir, children[i]));
                        }
                    }
                }
            }
        } 
```

正如您在`vistitAllDirsAndFiles`获得所需的`ArrayList<String>`所有 apk 文件后所看到的，因此我可以检查每个我想要的。`sdcardAppsPath`不利的一面是，如果卡上有很多文件并且应用程序在找到路径时没有显示任何进度，则可能需要花费大量时间来构建它。

**我想要达到的目标**

我希望能够`doInBackground`以某种方式为每个找到的文件，获取我需要的信息，更新进度，然后继续扫描。任何想法如何更新我的代码以像这样工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T19:33:51.407

我认为，如果您想在搜索文件时更新进度，而不是事后遍历列表然后调用它，那么您会想`publishProgress`在您的方法内部调用...`visitAllDirsAndFiles`

# grails - 在 liferay 6 上部署 grails portlet 时出错

> ID：12465655
> 
> 赞同：2
> 
> 时间：2012-09-17T19:11:19.200
> 
> 标签：grails, plugins, deployment, liferay, war

**我想用 grails 测试一个简单的 liferay portlet。**

**我正在使用：** Liferay 版本 liferay-portal-6.1.1-ce-ga2 嵌入了 tomcat 版本 tomcat-7.0.27 ，Grails 2.1.0 ，IDE Groovy/Grails Tool Suite 版本：3.0.0.RELEASE 和JDK1.7.0_05

**我安装了**plugins.portlets=0.9.2 和 plugins.portlets-liferay=0.4

**在项目中安装 grails 插件后，我只需运行以下命令：** create-portlet directoryio.testLiferay 和 generate-portlet-views directoryio.testLiferay

[我已经像http://grails.org/plugin/portlets-liferay](http://grails.org/plugin/portlets-liferay)一样配置了 Config.groovy

**我的 portlet 类如下所示：**

```
package directorio 
```

导入 javax.portlet.*

类 TestLiferayPortlet {

```
def title = 'Grails test'
def description = '''Portlet de pruebas.'''
def displayName = 'GrailsTest'
def supports = ['text/html':['view', 'edit', 'help']]

//uncomment to declare events support
//def events = [publish: ["event-1"], process: ["event-2"]]

//uncomment to declare public render parameter support
//def public_render_params = ["prp-1","prp-2"]

// DEFINITIONS FOR liferay-display.xml
def liferay_display_category = 'SCRD'

// DEFINITIONS FOR liferay-portlets.xml
def liferay_portlet_ajaxable = 'true'
def liferay_portlet_header_portlet_css = [
        '/css/protoFlow.css'
]
def liferay_portlet_header_portlet_javascript = [
        '/plugins/richui-0.5/js/flow/lib/prototype.js',
        '/plugins/richui-0.5/js/flow/lib/scriptaculous.js',
        '/plugins/richui-0.5/js/reflection/reflection.js',
        '/plugins/richui-0.5/js/flow/protoFlow.js'
]

def actionView = {
    //TODO Define action phase for 'view' portlet mode
    portletResponse.setRenderParameter("prp-1", "value-1");
}

def eventView = {
    //TODO Define event phase for 'view' portlet mode.
    def eventValue = portletRequest.event.value
}

def renderView = {
    //TODO Define render phase for 'view' portlet mode.
    //Return the map of the variables bound to the view,
    //in this case view.gsp if it exists or render.gsp if not
    ['mykey':'myvalue']
}

def resourceView = {
    //TODO define resource phase for 'view' portlet mode.
    //Render HTML as response
    render {
        html {
            head()
            body {
                "Render me!!"
            }
        }
    }
}

def actionEdit = {
    //TODO Define action phase for 'edit' portlet mode
    portletResponse.setEvent("event-1","event-1")
    portletResponse.setPortletMode(PortletMode.VIEW)
}

def renderHelp = {
    //TODO Define render phase for 'help' portlet mode
    //Return the map of the variables bound to the view,
    //in this case help.gsp if it exists or render.gsp if not
    ['mykey':'myvalue']
}

def doResource = {
    //TODO Define handling for default resource URL handling method, independent of porlet mode
    //Return the map of the variables bound to the view,
    //in this case resource.gsp
    ['mykey':'myvalue']
}

//invoked by setting 'action' param in resourceURL (as an example) to 'doSomethingAjaxy'
def doSomethingAjaxy =  {
    //render JSON
    render(contentType:"text/json") {
        example(mykey:"myvalue")
    }
}

//invoked by setting 'action' param in eventURL (as an example) to 'handleThisEvent'
def handleThisEvent =  {
    //render thisEvent.gsp
    render(view:"thisEvent")
} 
```

}

如果我执行 run-app 和 war，它工作正常。但是，当我将战争放入部署 liferay 目录并启动 tomcat 时，出现错误：

```
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
18:44:16,665 ERROR [GrailsDispatcherPortlet:276] Context initialization failed
java.lang.NullPointerException
    at org.codehaus.grails.portlets.container.AbstractPortletContainerAdapter.getInstance(AbstractPortletContainerAdapter.java:25)
    at org.codehaus.grails.portlets.GrailsPortletApplicationContext.initPortletContainerAdapter(GrailsPortletApplicationContext.java:37)
    at org.codehaus.grails.portlets.GrailsPortletApplicationContext.setPortletContext(GrailsPortletApplicationContext.java:28)
    at org.springframework.web.portlet.FrameworkPortlet.createPortletApplicationContext(FrameworkPortlet.java:349)
    at org.springframework.web.portlet.FrameworkPortlet.initPortletApplicationContext(FrameworkPortlet.java:294)
    at org.springframework.web.portlet.FrameworkPortlet.initPortletBean(FrameworkPortlet.java:268)
    at org.springframework.web.portlet.GenericPortletBean.init(GenericPortletBean.java:116)
    at javax.portlet.GenericPortlet.init(GenericPortlet.java:107)
    at com.liferay.portlet.InvokerPortletImpl.init(InvokerPortletImpl.java:256)
    at com.liferay.portlet.PortletInstanceFactoryImpl.init(PortletInstanceFactoryImpl.java:221)
    at com.liferay.portlet.PortletInstanceFactoryImpl.create(PortletInstanceFactoryImpl.java:140)
    at com.liferay.portlet.PortletInstanceFactoryUtil.create(PortletInstanceFactoryUtil.java:41)
    at com.liferay.portlet.PortletBagFactory.create(PortletBagFactory.java:310)
    at com.liferay.portal.deploy.hot.PortletHotDeployListener.initPortlet(PortletHotDeployListener.java:546)
    at com.liferay.portal.deploy.hot.PortletHotDeployListener.doInvokeDeploy(PortletHotDeployListener.java:321)
    at com.liferay.portal.deploy.hot.PortletHotDeployListener.invokeDeploy(PortletHotDeployListener.java:120)
    at com.liferay.portal.deploy.hot.HotDeployImpl.doFireDeployEvent(HotDeployImpl.java:188)
    at com.liferay.portal.deploy.hot.HotDeployImpl.fireDeployEvent(HotDeployImpl.java:96)
    at com.liferay.portal.kernel.deploy.hot.HotDeployUtil.fireDeployEvent(HotDeployUtil.java:27)
    at com.liferay.portal.kernel.servlet.PluginContextListener.fireDeployEvent(PluginContextListener.java:151)
    at com.liferay.portal.kernel.servlet.PluginContextListener.doPortalInit(PluginContextListener.java:141)
    at com.liferay.portal.kernel.util.BasePortalLifecycle.portalInit(BasePortalLifecycle.java:42)
    at com.liferay.portal.kernel.util.PortalLifecycleUtil.register(PortalLifecycleUtil.java:64)
    at com.liferay.portal.kernel.util.PortalLifecycleUtil.register(PortalLifecycleUtil.java:56)
    at com.liferay.portal.kernel.util.BasePortalLifecycle.registerPortalLifecycle(BasePortalLifecycle.java:52)
    at com.liferay.portal.kernel.servlet.PluginContextListener.contextInitialized(PluginContextListener.java:103)
    at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4779)
    at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5273)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:895)
    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:871)
    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:615)
    at org.apache.catalina.startup.HostConfig.deployDirectory(HostConfig.java:1099)
    at org.apache.catalina.startup.HostConfig$DeployDirectory.run(HostConfig.java:1621)
    at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)
    at java.util.concurrent.FutureTask.run(FutureTask.java:166)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:722)
18:44:16,667 ERROR [pool-2-thread-1][PortletBagFactory:313] java.lang.NullPointerException
java.lang.NullPointerException
    at org.codehaus.grails.portlets.container.AbstractPortletContainerAdapter.getInstance(AbstractPortletContainerAdapter.java:25)
    at org.codehaus.grails.portlets.GrailsPortletApplicationContext.initPortletContainerAdapter(GrailsPortletApplicationContext.java:37)
    at org.codehaus.grails.portlets.GrailsPortletApplicationContext.setPortletContext(GrailsPortletApplicationContext.java:28)
    at org.springframework.web.portlet.FrameworkPortlet.createPortletApplicationContext(FrameworkPortlet.java:349)
    at org.springframework.web.portlet.FrameworkPortlet.initPortletApplicationContext(FrameworkPortlet.java:294)
    at org.springframework.web.portlet.FrameworkPortlet.initPortletBean(FrameworkPortlet.java:268)
    at org.springframework.web.portlet.GenericPortletBean.init(GenericPortletBean.java:116)
    at javax.portlet.GenericPortlet.init(GenericPortlet.java:107)
    at com.liferay.portlet.InvokerPortletImpl.init(InvokerPortletImpl.java:256)
    at com.liferay.portlet.PortletInstanceFactoryImpl.init(PortletInstanceFactoryImpl.java:221)
    at com.liferay.portlet.PortletInstanceFactoryImpl.create(PortletInstanceFactoryImpl.java:140)
    at com.liferay.portlet.PortletInstanceFactoryUtil.create(PortletInstanceFactoryUtil.java:41)
    at com.liferay.portlet.PortletBagFactory.create(PortletBagFactory.java:310)
    at com.liferay.portal.deploy.hot.PortletHotDeployListener.initPortlet(PortletHotDeployListener.java:546)
    at com.liferay.portal.deploy.hot.PortletHotDeployListener.doInvokeDeploy(PortletHotDeployListener.java:321)
    at com.liferay.portal.deploy.hot.PortletHotDeployListener.invokeDeploy(PortletHotDeployListener.java:120)
    at com.liferay.portal.deploy.hot.HotDeployImpl.doFireDeployEvent(HotDeployImpl.java:188)
    at com.liferay.portal.deploy.hot.HotDeployImpl.fireDeployEvent(HotDeployImpl.java:96)
    at com.liferay.portal.kernel.deploy.hot.HotDeployUtil.fireDeployEvent(HotDeployUtil.java:27)
    at com.liferay.portal.kernel.servlet.PluginContextListener.fireDeployEvent(PluginContextListener.java:151)
    at com.liferay.portal.kernel.servlet.PluginContextListener.doPortalInit(PluginContextListener.java:141)
    at com.liferay.portal.kernel.util.BasePortalLifecycle.portalInit(BasePortalLifecycle.java:42)
    at com.liferay.portal.kernel.util.PortalLifecycleUtil.register(PortalLifecycleUtil.java:64)
    at com.liferay.portal.kernel.util.PortalLifecycleUtil.register(PortalLifecycleUtil.java:56)
    at com.liferay.portal.kernel.util.BasePortalLifecycle.registerPortalLifecycle(BasePortalLifecycle.java:52)
    at com.liferay.portal.kernel.servlet.PluginContextListener.contextInitialized(PluginContextListener.java:103)
    at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4779)
    at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5273)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:895)
    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:871)
    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:615)
    at org.apache.catalina.startup.HostConfig.deployDirectory(HostConfig.java:1099)
    at org.apache.catalina.startup.HostConfig$DeployDirectory.run(HostConfig.java:1621)
    at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)
    at java.util.concurrent.FutureTask.run(FutureTask.java:166)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:722)
18:44:16,668 INFO  [GrailsDispatcherPortlet:98] Initializing portlet 'TestLiferay'
18:44:16,671 INFO  [GrailsDispatcherPortlet:263] FrameworkPortlet 'TestLiferay': initialization started
18:44:16,672 ERROR [GrailsDispatcherPortlet:276] Context initialization failed
java.lang.NullPointerException
    at org.codehaus.grails.portlets.container.AbstractPortletContainerAdapter.getInstance(AbstractPortletContainerAdapter.java:25)
    at org.codehaus.grails.portlets.GrailsPortletApplicationContext.initPortletContainerAdapter(GrailsPortletApplicationContext.java:37)
    at org.codehaus.grails.portlets.GrailsPortletApplicationContext.setPortletContext(GrailsPortletApplicationContext.java:28)
    at org.springframework.web.portlet.FrameworkPortlet.createPortletApplicationContext(FrameworkPortlet.java:349)
    at org.springframework.web.portlet.FrameworkPortlet.initPortletApplicationContext(FrameworkPortlet.java:294)
    at org.springframework.web.portlet.FrameworkPortlet.initPortletBean(FrameworkPortlet.java:268)
    at org.springframework.web.portlet.GenericPortletBean.init(GenericPortletBean.java:116)
    at javax.portlet.GenericPortlet.init(GenericPortlet.java:107)
    at com.liferay.portlet.InvokerPortletImpl.init(InvokerPortletImpl.java:256)
    at com.liferay.portlet.PortletInstanceFactoryImpl.init(PortletInstanceFactoryImpl.java:221)
    at com.liferay.portlet.PortletInstanceFactoryImpl.create(PortletInstanceFactoryImpl.java:140)
    at com.liferay.portlet.PortletInstanceFactoryUtil.create(PortletInstanceFactoryUtil.java:41)
    at com.liferay.portal.deploy.hot.PortletHotDeployListener.initPortletApp(PortletHotDeployListener.java:598)
    at com.liferay.portal.deploy.hot.PortletHotDeployListener.doInvokeDeploy(PortletHotDeployListener.java:328)
    at com.liferay.portal.deploy.hot.PortletHotDeployListener.invokeDeploy(PortletHotDeployListener.java:120)
    at com.liferay.portal.deploy.hot.HotDeployImpl.doFireDeployEvent(HotDeployImpl.java:188)
    at com.liferay.portal.deploy.hot.HotDeployImpl.fireDeployEvent(HotDeployImpl.java:96)
    at com.liferay.portal.kernel.deploy.hot.HotDeployUtil.fireDeployEvent(HotDeployUtil.java:27)
    at com.liferay.portal.kernel.servlet.PluginContextListener.fireDeployEvent(PluginContextListener.java:151)
    at com.liferay.portal.kernel.servlet.PluginContextListener.doPortalInit(PluginContextListener.java:141)
    at com.liferay.portal.kernel.util.BasePortalLifecycle.portalInit(BasePortalLifecycle.java:42)
    at com.liferay.portal.kernel.util.PortalLifecycleUtil.register(PortalLifecycleUtil.java:64)
    at com.liferay.portal.kernel.util.PortalLifecycleUtil.register(PortalLifecycleUtil.java:56)
    at com.liferay.portal.kernel.util.BasePortalLifecycle.registerPortalLifecycle(BasePortalLifecycle.java:52)
    at com.liferay.portal.kernel.servlet.PluginContextListener.contextInitialized(PluginContextListener.java:103)
    at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4779)
    at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5273)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:895)
    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:871)
    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:615)
    at org.apache.catalina.startup.HostConfig.deployDirectory(HostConfig.java:1099)
    at org.apache.catalina.startup.HostConfig$DeployDirectory.run(HostConfig.java:1621)
    at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)
    at java.util.concurrent.FutureTask.run(FutureTask.java:166)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:722)
18:44:16,673 ERROR [pool-2-thread-1][HotDeployImpl:191] com.liferay.portal.kernel.deploy.hot.HotDeployException: Error registering portlets for testLiferayPortlet-0.1
com.liferay.portal.kernel.deploy.hot.HotDeployException: Error registering portlets for testLiferayPortlet-0.1
    at com.liferay.portal.kernel.deploy.hot.BaseHotDeployListener.throwHotDeployException(BaseHotDeployListener.java:46)
    at com.liferay.portal.deploy.hot.PortletHotDeployListener.invokeDeploy(PortletHotDeployListener.java:123)
    at com.liferay.portal.deploy.hot.HotDeployImpl.doFireDeployEvent(HotDeployImpl.java:188)
    at com.liferay.portal.deploy.hot.HotDeployImpl.fireDeployEvent(HotDeployImpl.java:96)
    at com.liferay.portal.kernel.deploy.hot.HotDeployUtil.fireDeployEvent(HotDeployUtil.java:27)
    at com.liferay.portal.kernel.servlet.PluginContextListener.fireDeployEvent(PluginContextListener.java:151)
    at com.liferay.portal.kernel.servlet.PluginContextListener.doPortalInit(PluginContextListener.java:141)
    at com.liferay.portal.kernel.util.BasePortalLifecycle.portalInit(BasePortalLifecycle.java:42)
    at com.liferay.portal.kernel.util.PortalLifecycleUtil.register(PortalLifecycleUtil.java:64)
    at com.liferay.portal.kernel.util.PortalLifecycleUtil.register(PortalLifecycleUtil.java:56)
    at com.liferay.portal.kernel.util.BasePortalLifecycle.registerPortalLifecycle(BasePortalLifecycle.java:52)
    at com.liferay.portal.kernel.servlet.PluginContextListener.contextInitialized(PluginContextListener.java:103)
    at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4779)
    at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5273)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:895)
    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:871)
    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:615)
    at org.apache.catalina.startup.HostConfig.deployDirectory(HostConfig.java:1099)
    at org.apache.catalina.startup.HostConfig$DeployDirectory.run(HostConfig.java:1621)
    at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)
    at java.util.concurrent.FutureTask.run(FutureTask.java:166)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:722)
Caused by: java.lang.NullPointerException
    at org.codehaus.grails.portlets.container.AbstractPortletContainerAdapter.getInstance(AbstractPortletContainerAdapter.java:25)
    at org.codehaus.grails.portlets.GrailsPortletApplicationContext.initPortletContainerAdapter(GrailsPortletApplicationContext.java:37)
    at org.codehaus.grails.portlets.GrailsPortletApplicationContext.setPortletContext(GrailsPortletApplicationContext.java:28)
    at org.springframework.web.portlet.FrameworkPortlet.createPortletApplicationContext(FrameworkPortlet.java:349)
    at org.springframework.web.portlet.FrameworkPortlet.initPortletApplicationContext(FrameworkPortlet.java:294)
    at org.springframework.web.portlet.FrameworkPortlet.initPortletBean(FrameworkPortlet.java:268)
    at org.springframework.web.portlet.GenericPortletBean.init(GenericPortletBean.java:116)
    at javax.portlet.GenericPortlet.init(GenericPortlet.java:107)
    at com.liferay.portlet.InvokerPortletImpl.init(InvokerPortletImpl.java:256)
    at com.liferay.portlet.PortletInstanceFactoryImpl.init(PortletInstanceFactoryImpl.java:221)
    at com.liferay.portlet.PortletInstanceFactoryImpl.create(PortletInstanceFactoryImpl.java:140)
    at com.liferay.portlet.PortletInstanceFactoryUtil.create(PortletInstanceFactoryUtil.java:41)
    at com.liferay.portal.deploy.hot.PortletHotDeployListener.initPortletApp(PortletHotDeployListener.java:598)
    at com.liferay.portal.deploy.hot.PortletHotDeployListener.doInvokeDeploy(PortletHotDeployListener.java:328)
    at com.liferay.portal.deploy.hot.PortletHotDeployListener.invokeDeploy(PortletHotDeployListener.java:120)
    ... 24 more 
```

我真的很感激任何帮助。

许多交易。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T04:35:07.663

这是 liferay 6.1.1 中的一个错误

[http://issues.liferay.com/browse/LPS-29103](http://issues.liferay.com/browse/LPS-29103)

似乎热部署在合并时会重新排列 web.xml 中的侦听器。坚持使用 6.1.0 可能会更好，或者每次重新部署时手动修复 web.xml

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-10T17:22:15.700

添加`compile 'javax.portlet:portlet-api:2.0'`您的依赖项`BuildConfig.groovy`

:D

# javascript - 在 json 字符串化数组对象时排除对象属性

> ID：12465657
> 
> 赞同：4
> 
> 时间：2012-09-17T19:11:29.977
> 
> 标签：javascript, json, serialization, stringify

嘿，我有一个类似这样的数组对象

```
[{
    public: "public",
    private: "private",
    [{
        properties: {...
        },
        instance: {.....
        }
    }, {...
    }, {...
    }]
}, {...
}, {....
}] 
```

这里最外面的数组包含 A 类的对象，它有一些公共道具，一些私有 porps，它还包含一个包含 B 类对象的数组，其中还包含一些公共和私有字段。

所以基本上这是我的层次结构

```
array = [A1,A2,A3,A4,....]//object of A

var A = function(){
  var Const = function(){
    this.public_prop;
    this.private_prop;
    this.list = [B1,B2,B3,B4]// objects of B
  }
 //.........
 return Const;
}();

var B = function(){

  var Const = function(){
   this.public_prop;
   this.private_prop;
  }
 //.........
 return Const;
}(); 
```

现在，在对其进行字符串化（序列化）时，我只想在序列化字符串中包含公共道具和数组。

例如对于上面的 JSON 表示，我想要这样的东西

```
[{
        public: "public",
        [{
            properties: {...
            }
        }, {...
        }, {...
        }]
    }, {...
    }, {....
    }] 
```

现在我可以在每个类中创建一个函数*getState() ，*它只会返回需要字符串化的字段，但我似乎无法找到一种方法来让 JSON.stringify 的本机实现在序列化之前调用该方法。有没有办法做到这一点？

我[在 JSON.stringify() 的输出中引用了隐藏某些值](https://stackoverflow.com/questions/4910567/json-stringify-how-to-exclude-certain-fields-from-the-json-string)，但它只解释了如何在单个层次结构中排除简单的数字或字符串道具，但如何在多个层次结构中排除道具？

*注意：我所有的课程都遵循模块模式*

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-17T19:18:59.443

```
var result = JSON.stringify(myjson, function(key, val) {
    if (key !== "private")
        return val;
}); 
```

顶部的对象示例不是有效的语法，但要排除名为 的属性`"private"`，这应该可以工作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-17T23:33:59.540

假设您按照问题标签的建议编写 JavaScript（尽管您的示例代码看起来几乎是 c#！）：您需要覆盖您正在序列化的对象的“toJSON”方法，而不是“stringify”或“getState” .

因此，如果你有一个对象“Message”具有公共和“私有”属性，则需要定义一个只返回公共属性的“toJSON”方法，如下所示：

```
var Message = function() {
    this.myPrivateProperty = "Secret message";
    this.myPublicProperty = "Message for the public";

    this.toJSON = function() {
        return {
            "public": this.myPublicProperty
        };
    };
}

alert(JSON.stringify(new Message()));    // {"public":"Message for the public"} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-05-04T18:37:18.907

也许有点晚了，但`JSON.stringify`签名接受一个`replacer`函数/数组。您可以根据需要定义数组白名单和函数。

[MDN 文档](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify#The_replacer_parameter)

# javascript - WebBrowser 控件脚本错误

> ID：12465673
> 
> 赞同：0
> 
> 时间：2012-09-17T19:12:27.763
> 
> 标签：javascript, html, winforms, bots

我正在制作一个访问特定网址的机器人，以表单形式输入并通过单击提交按钮提交...

让我解释一下我的情况。当我启动我的机器人时，首先它访问 URL，在加载网页后，我必须在那里手动检查一个单选按钮，然后我按下提交按钮（Windows 表单控制按钮来填充网页的所有字段并提交它通过使用调用点击方法）提交表单。

我正在使用 Web 浏览器控件（以 C#.NET 窗口形式编码），问题是当我单击单选按钮时，会弹出一个带有标题“脚本错误”的弹出窗口并说![在此处输入图像描述](../Images/196351971243fe09a95b149d10e56bc9.png)

下面是我使用IE开发工具复制的单选按钮标签（弹出错误）。

```
<input name="array(BlastDatabaseType)" onchange="changeQuestion(); changeAlgorithms();"
type="radio" value="Proteins"/> 
```

在普通的网络浏览器上不会发生此错误。我想解决这个错误而不是隐藏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-19T15:56:31.853

我从您的问题中了解到，您需要修复由于 Web 浏览器控制而生成的 javascript 错误，

**有两个基本的解决方案，**

**1)**强制 Web Browser 控件模拟最新的 IE 浏览器。您需要为此进行注册表更改，您将能够使用安装在 PC 上的 IE 浏览器。

*改编自[Mikel 解决方案](https://stackoverflow.com/questions/4612255/regarding-ie9-webbrowser-control#4613025)*您可以在 HTML 页面
中使用元标记。`<meta http-equiv="X-UA-Compatible" content="IE=9" >`

但最好将注册表项添加到：`(goto > start > run > type 'regedit' enter)`

`HKEY_LOCAL_MACHINE (or HKEY_CURRENT_USER) > SOFTWARE > Microsoft > Internet Explorer > Main > FeatureControl > FEATURE_BROWSER_EMULATION > contoso.exe = (DWORD) 00009000`

用于`10000 (0x02710)`Internet Explorer 10

**2）**使用GeckoFX包装器，它包装了Gecko引擎，
*下载*[GeckoFX](http://mirrors.directorymix.com/mozilla/xulrunner/releases/1.9.1.2/runtimes/xulrunner-1.9.1.2.en-US.win32.zip)[包装器](http://code.google.com/p/geckofx/)
*下载*XulRunner

首先提取 GeckoFX 并阅读 readme.txt 文件。

在您的工具栏中添加 Gecko.dll 的引用，然后将控件拖放到您的窗体上。

```
public Form1()
    {
        InitializeComponent();
        //you need to extract the Xulrunner in the soultion directory
        //  (preferable) b/c wrapper relies on these dlls.
        Skybound.Gecko.Xpcom.Initialize(@"C:\Xulrunner");
    }

    private void Form1_Load(object sender, EventArgs e)
    {
       geckoWebBrowser1.Navigate("http://tritrypdb.org/tritrypdb/"); 
    } 
```

**其他有用的链接：**
[http://msdn.microsoft.com/en-us/library/ee330730%28VS.85%29.aspx#browser_emulation](http://msdn.microsoft.com/en-us/library/ee330730%28VS.85%29.aspx#browser_emulation)
[IE9 WebBrowser 控件是否支持 IE9 的所有功能，包括 SVG？](https://stackoverflow.com/questions/4612255/regarding-ie9-webbrowser-control)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T19:47:57.713

IE 以不同的方式处理 onchange 事件。IE 仅在元素失去焦点时触发 onchange 事件。

如果我正确理解了您的问题，您可能想改用 onkeypress 事件。

# java - 如何使用单词创建 IF 语句？

> ID：12465675
> 
> 赞同：0
> 
> 时间：2012-09-17T19:12:36.217
> 
> 标签：java, if-statement

通常是一个 if 语句：`if(variable==60) {system.out.println("60");}`

但我想测试是否`variable`与单词完全匹配。

例如，用户输入文本框'hello' 我将如何创建一个if 语句来说明用户是否输入'hello' system.out.println....？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-17T19:13:43.237

你需要[equals](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/String.html#equals%28java.lang.Object%29)方法：

```
if ("hello".equals(variable)) { 
```

请注意，还有一个[equalsIgnoreCase](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/String.html#equalsIgnoreCase%28java.lang.String%29)方法，如果用户可以输入“Hello”而不是“hello”，该方法可能很有用。

首先使用“hello”进行测试通常是一个好主意，这样如果变量为 null，您将不会得到`NullPointerException`. 如果变量为空，则 if 返回 false。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-17T19:15:41.037

许多人通常对此感到困惑，因为他们尝试`==`在字符串（即对象）上使用，并收到意想不到的结果。您将不得不使用. 请记住，该方法适用于对象，并且通常适用于原语。`if ("hello"**.equals**(var)) {...}``equals``==`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T19:35:49.423

这是一个明显的例子：

```
 String pool1 = "funny";
    String pool2 = "funny";
    String not_pooled = new String("funny");
    System.out.println("pool1 equals pool2 ? "+(pool1==pool2)); //Equal because they point to same pooled instance
    System.out.println("pool1 equals not_pooled ? "+(pool1==not_pooled)); //Not equal because 'not_pooled' not pooled.
    System.out.println("pool1 equals not_pooled ? " +(pool1.equals(not_pooled))); //Equal because the contents of the object is checked and not the reference 
```

输出：

pool1 等于 pool2 吗？真的

pool1 等于 not_pooled ？错误的

pool1 等于 not_pooled ？真的

# geometry - 放置矩形最大化矩形交点

> ID：12465677
> 
> 赞同：2
> 
> 时间：2012-09-17T19:12:41.947
> 
> 标签：geometry, intersection, maximize, rectangles

我有这个问题：给定一组矩形 {R1,R2...Rn} 和一个新矩形 Rq，找到放置 Rq 的位置，使其相交（不管面积多少）矩形的最大数量集。我正在寻找一个不涉及太复杂数据结构的简单解决方案，但是，非常感谢任何有效的答案，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T08:59:20.767

这是一个`O(n^2)`或`O(n (log n + m))`（仅平均情况）复杂度算法（其中`m`是相交矩形的最大数量）。**方法见后`O(n log n)`文。**

第一个想法是考虑到有`n`地方可以寻找解决方案。也就是说，对于每个矩形`Ri`，`Ri`最右边的矩形相交`Rq`的情况是候选解。

您将从左到右扫描。将矩形按最小 x 坐标的顺序添加到缓冲区容器，以及优先级队列（基于最大 x 坐标）。添加每个矩形时，还要检查需要删除哪些矩形（基于优先级队列），以便`Rq`如果您暂时忽略 y 轴，缓冲区中的矩形范围可以与矩形相交。

在将每个矩形添加到缓冲区之前，您可以考虑如果需要相交`Ri`，缓冲区中可以相交多少个矩形（与相交的最右边的矩形）。这可以在线性时间内完成。`Rq``Ri``Ri``Rq`

因此总体复杂度为`O(n^2)`。

通过对存储在缓冲区中的任何矩形节点使用[区间树](http://en.wikipedia.org/wiki/Interval_tree)，可以改进算法的运行时间。由于 Wikipedia 提供了大量关于这方面的信息，以及它是如何实现的，我不会在这里解释它是如何工作的，特别是因为它的平衡可能相当复杂。这会将平均复杂度提高到`O(n (log n + m))`，答案在哪里- 相交矩形的最大数量（在最坏的情况下`m`仍然可能一样大）。`n`这是由于查询间隔树的算法复杂性（`O(log n + m)`每次查询的时间）。最坏的情况仍然是`O(n^2)`，因为`m`对于返回的结果数（对于区间树），可能高达`O(n)`，即使答案不是`n`.

* * *

## 这里遵循一种随`O(n log n)`时间变化的方法，但相当复杂。

除了将矩形存储为排序数组、自平衡二叉搜索树（仅基于最小 y）或区间树，矩形还可以存储在自定义数据结构中。

考虑自平衡二叉搜索树（基于最大 y）。我们可以为此添加一些元数据。值得注意的是，由于我们尝试最大化缓冲区中相交的矩形，并不断寻找随着缓冲区从左到右扫描时最大值如何变化，如果缓冲区中的每个矩形都是最底部的，我们可以考虑相交的矩形数量长方形。

如果我们可以存储矩形的数量，我们也许可以更快地查询它。

解决方案是以不同的方式存储它，以降低更新成本。二叉搜索树有许多边。假设每个节点应该知道如果该节点是要相交的最底部矩形，则可以相交多少个矩形。相反，我们可以存储与每条边任一侧的节点相交的矩形数量的变化（称为`diff`）。例如，对于以下树（具有最小和最大 y 的矩形）：

```
 (3,4)
      / \
   (2,3) (5,6) 
```

对于`Rq`高度为 2 的情况，如果`(2,3)`是最底部的，我们总共可以相交 2 个矩形，对于`(3,4)`，它是 2，对于`(5,6)`，它是 1。

因此，edges'`diff`可以是 0 和 -1，代表答案从孩子到父母的变化。

使用权重，如果每个节点也在其子树中存储子路径的最大总和（称为 this `maxdiff`），我们可以快速找到最大数。对于叶子，它是 0，但是对于`(3,4)`，0 和 -1 的最大值是 0，因此，我们可以将 0 存储为根节点中子路径的边的最大和。

因此，我们知道最优答案比根节点的答案多 0。我们可以找到根节点的答案，但保留更多的元数据。

但是，所有这些元数据都可以及时查询和更新`log n`。这是因为当我们添加一个矩形时，将其添加到自平衡二叉搜索树需要`log n`时间，因为我们可能需要进行`log n`旋转。当我们进行旋转时，我们可能需要更新边缘以及`maxdiff`受影响节点上的权重 - 但是这是`O(1)`针对每次旋转的。

此外，`diff`需要更新额外矩形对边缘的影响。但是，最多`O(log n)`边必须更新，具体来说，如果我们通过新矩形的 min y 和 max y 搜索树，我们会找到所有需要更新的边（尽管遍历的边是否必须更新取决于我们是带左孩子还是右孩子——这里需要一些仔细的工作来确定确切的规则）。

删除一个矩形正好相反，所以需要`O(log n)`时间。

这样，我们可以及时更新缓冲区，`O(log n)`及时查询`O(log n)`，整体算法复杂度为`O(n log n)`.

**注意：**要找到缓冲区中相交的最大矩形，我们使用`maxdiff`，这是最优答案与根节点答案之间的差异。要找到实际答案，我们必须找到二叉搜索树中最低排序矩形的答案与根节点之间的差异。这很容易及时完成，沿着最左边的路径走，并在边缘`O(log n)`总结。`diff`最后，在排序最低的矩形上找到答案。这是通过存储按最小 y 排序的第二个自平衡二叉搜索树来完成的。如果按最大 y 排序时最底部的矩形是排序最低的矩形，我们可以使用它来查找相交的矩形的数量。

更新这个额外的 BST 和查询也需要`O(log n)`时间，所以这个额外的工作不会改变整体的复杂性。

# python - 在 Python / Django 中定义另一个缓存控制而不是设置缓存超时

> ID：12465682
> 
> 赞同：1
> 
> 时间：2012-09-17T19:13:14.567
> 
> 标签：python, django, django-views, django-cache

我想缓存我的视图如下：

```
@cache_page(10)
def myview:
    return HttpResponse('content') 
```

这会自动将我的视图缓存 10 秒，并自动设置 Cache-Control/Expire 标头。我只想将我的视图缓存 10 秒，但最大年龄为 3600 秒。

例如以这种方式尝试过：

```
@cache_page(10)
def myview:
    response = HttpResponse('content')
    patch_response_headers(response, 3600) 
```

或者这样：

```
@cache_page(10)
def myview:
    response = HttpResponse('content')
    response['Cache-Control'] = 'max-age=3600' 
```

但是当在我的 Django-View 中指定其中一个时，它会将视图缓存 3600 秒而不是 10 秒。还尝试了像'cache_control'这样的装饰器，但没有任何帮助。

这个问题有解决方案吗？我正在使用 Django 1.4.1。

不知道是不是相关的，我激活的中间件类是

*   django.middleware.common.CommonMiddleware
*   django.contrib.sessions.middleware.SessionMiddleware
*   django.middleware.csrf.CsrfViewMiddleware
*   django.contrib.auth.middleware.AuthenticationMiddleware
*   django.contrib.messages.middleware.MessageMiddleware
*   django.middleware.http.ConditionalGetMiddleware

我已激活 ConditionalGetMiddleware 以确保将根据最后修改的标头发送 304。

非常感谢！

霍尔格

# animation - 自定义 Segue 不允许目标控制器中的 IBAction

> ID：12465687
> 
> 赞同：0
> 
> 时间：2012-09-17T19:13:35.673
> 
> 标签：animation, segue, ibaction, superview

我有两个带视图的视图控制器。第一个是登录屏幕，第二个是从网络上获取内容（无关紧要）。

我使用了自定义的 segue 动画，并且不得不对 superview 做一些奇怪的事情，以使 sourceViewController.view 位于destinationViewController.view 的“顶部”（视觉上）

我只能假设这就是为什么当我尝试从第二个视图调用 IBAction 方法时，它们不会调用。

这是segue类的实现：

```
- (void) perform {

    UIViewController *sourceViewController = (UIViewController *) self.sourceViewController;
    UIViewController *destinationViewController = (UIViewController *) self.destinationViewController;

    UIView *parent = sourceViewController.view.superview;
    [sourceViewController.view removeFromSuperview];
    [parent addSubview: destinationViewController.view];
    [parent addSubview:sourceViewController.view];
    sourceViewController.view.layer.masksToBounds = NO;
    sourceViewController.view.layer.cornerRadius = 8; // if you like rounded corners
    sourceViewController.view.layer.shadowOffset = CGSizeMake(0,0);
    sourceViewController.view.layer.shadowRadius = 10;
    sourceViewController.view.layer.shadowOpacity = 1;

    destinationViewController.view.frame = CGRectMake(0, 20, destinationViewController.view.frame.size.width, destinationViewController.view.frame.size.height);
    sourceViewController.view.frame = CGRectMake(0, 20, sourceViewController.view.frame.size.width, sourceViewController.view.frame.size.height);

    [UIView animateWithDuration:.6
                          delay:0.0
                        options:UIViewAnimationCurveEaseInOut
                     animations:^{

                         sourceViewController.view.frame = CGRectMake(-sourceViewController.view.frame.size.width-10, 20, sourceViewController.view.frame.size.width, sourceViewController.view.frame.size.height);
                     }
                     completion:^(BOOL finished){
                         //[destinationViewController.view removeFromSuperview];
                         [sourceViewController.navigationController pushViewController:destinationViewController animated:NO];
                     }];
} 
```

我的问题是，是否可以从其超级视图中删除源视图并以在第二个视图上调用 IBActions 的方式来解决这个问题？

IBAction 方法只是让应用程序崩溃，例如按下按钮。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T20:37:35.850

我通过将代码更改为此解决了我的问题：

```
UIViewController *sourceViewController = (UIViewController *) self.sourceViewController;
    UIViewController *destinationViewController = (UIViewController *) self.destinationViewController;
UIView *parent = sourceViewController.view.superview;
[parent addSubview:destinationViewController.view];
[parent sendSubviewToBack: destinationViewController.view];
    sourceViewController.view.layer.masksToBounds = NO;
    sourceViewController.view.layer.cornerRadius = 8; // if you like rounded corners
    sourceViewController.view.layer.shadowOffset = CGSizeMake(0,0);
    sourceViewController.view.layer.shadowRadius = 10;
    sourceViewController.view.layer.shadowOpacity = 1;
destinationViewController.view.frame = CGRectMake(0, 20, destinationViewController.view.frame.size.width, destinationViewController.view.frame.size.height);
    sourceViewController.view.frame = CGRectMake(0, 20, sourceViewController.view.frame.size.width, sourceViewController.view.frame.size.height);

    [UIView animateWithDuration:.6
                          delay:0.0
                        options:UIViewAnimationCurveEaseInOut
                     animations:^{

                         sourceViewController.view.frame = CGRectMake(-sourceViewController.view.frame.size.width-10, 20, sourceViewController.view.frame.size.width, sourceViewController.view.frame.size.height);
                     }
                     completion:^(BOOL finished){
                         [sourceViewController presentViewController:destinationViewController animated:NO completion:NULL];
                     }]; 
```

一些事情发生了变化，但值得注意的是，我使用了

```
[sourceViewController presentViewController:destinationViewController animated:NO completion:NULL]; 
```

正确初始化控制器。希望这对将来的其他人有所帮助。

# php - mysql表中的php / jquery自动完成

> ID：12465688
> 
> 赞同：2
> 
> 时间：2012-09-17T19:13:35.453
> 
> 标签：php, jquery, mysql, autocomplete

在参考了许多以前关于这个主题的问题和答案之后，我仍然很难过。我试图引用存储用户联系人列表的数据库。作为最初的开始，我保持简单，只允许通过电子邮件（而不是电子邮件、名字和姓氏等）进行参考。

我有以下链接：

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.23/jquery-ui.min.js"></script>
<script type="text/javascript">
$(document).ready(function() {
    $( ".emaillist" ).autocomplete({
        source: "contacts.php"}); });
</script> 
```

联系人**.php：[更新]**

```
<?php
session_start();
include "scripts/sqlconnect.php";
$id = $_SESSION['id'];
$csql = mysql_query("SELECT * FROM db WHERE id='$id' AND email LIKE '%".mysql_real_escape_string($_GET['term'])."%'");
$contactlist = array();
while($row = mysql_fetch_assoc($csql)){
    $contactlist[] = $row['email'];
}
$contactlist = json_encode($contactlist);
header('Content-Type: application/json');
echo "$contactlist";
?> 
```

最后是相关的 HTML 片段：

```
<input name="semail" type="text" class="emaillist" id="semail"/> 
```

关于我做错了什么有什么建议吗？我似乎无法确定问题所在。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T19:16:13.610

我注意到的两件事：

1.  你永远不会输出的内容`$contactlist`
2.  您没有设置适当的`Content-Type`标题。

所以你想这样做：

```
$contactlist = json_encode($contactlist);
header('Content-Type: application/json');
echo $contactlist; 
```

根据[文档](http://jqueryui.com/demos/autocomplete/)，传递给 AJAX 源的值被调用`term`，因此您应该在查询中使用它，而不是`semail`：

```
...  AND email LIKE "%'. mysql_real_escape_string($_GET['term']) .'%"');
                                                         ^^^^-- Here 
```

# javascript - 在drupal中执行ajax调用而不是bind（）

> ID：12465690
> 
> 赞同：0
> 
> 时间：2012-09-17T19:13:45.203
> 
> 标签：javascript, jquery, ajax, drupal-7

我有一个绑定到窗口 popstate 事件的 AJAX 调用。它有效，除了我正在解析查询字符串中的参数。问题是 ajax 调用在页面加载时绑定到窗口，所以当 url 发生时我的参数不会改变。我在想如果我向窗口添加一个侦听器，如果我可以只执行 ajax 调用而不是绑定它，它每次都会重新解析查询字符串。

例如，如果页面加载 domain.com?x=1&y=2 那么我的调用发送 x=1 和 y=2。但是当 popstate 触发并变为 domain.com?x=1&y=2&z=3 时，它仍然发送 x=1 和 y=2。

这是我的电话

```
var ajax_path = Drupal.settings.views.ajax_path;
$.each(Drupal.settings.views.ajaxViews, function (i, settings) {
    var view = '.facetapi-facetapi-links';
    element_settings = {
        url: ajax_path,
        submit: settings,
        setClick: false,
        event: 'popstate',
        selector: view,
        progress: { type: 'throbber' }
    };
    var viewData = {};
    $.extend(
        viewData,
        settings,
        Drupal.Views.parseQueryString(document.URL),
        Drupal.Views.parseViewArgs(document.URL, settings.view_base_path)
    );
    $.extend(viewData, Drupal.Views.parseViewArgs(document.URL, settings.view_base_path));
    element_settings.submit = viewData;
    var ajax = new Drupal.ajax(false, window, element_settings);
}); 
```

我在想的是做这件事，但我不知道怎么做。或者是否可以以某种方式使用 Drupal.ajax.prototype.beforeSend？

```
window.addEventListener("popstate", function(e) {
    //execute ajax here so it reparses document.url
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T23:57:23.443

我想出了这个解决方案，我正在使用自定义事件，这样我就可以手动触发事件

```
window.addEventListener("popstate", function(e) {        
    $(window).unbind('custom');
    $.each(Drupal.settings.views.ajaxViews, function (i, settings) {
        element_settings = {
            url: Drupal.settings.views.ajax_path,
            submit: settings,
            setClick: false,
            event: 'custom',
            selector: '.facetapi-facetapi-links',
            progress: { type: 'throbber' }
        };

        var viewData = {};
        $.extend(
            viewData,
            settings,
            Drupal.Views.parseQueryString(document.URL),
            // Extract argument data from the URL.
            Drupal.Views.parseViewArgs(document.URL, settings.view_base_path)
        );

        $.extend(viewData, Drupal.Views.parseViewArgs(document.URL, settings.view_base_path));

        element_settings.submit = viewData;

        var ajax = new Drupal.ajax(false, window, element_settings);
        console.log(element_settings);
    });
    $(window).trigger('custom');
}); 
```

# c# - 无法将类型 'object[][]' 转换为 'System.Collections.Generic.List' I'm trying to create and consume a web service... I'm using .NET Framework 4.0 (c#). The service exposes a method like this: public List <object[]>G 问问题 问问题 2012-09-17T19:14:08.480 3613 次 This question shows research effort; it is useful and clear 0 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. I'm trying to create and consume a web service... I'm using .NET Framework 4.0 (c#). The service exposes a method like this: public List <object[]>GetData(string strRegion, List <string>lstBrand, List <string>lstColor) Then on the client application, I declare a list of objects: List <object[]>lst = new List<object[]>(); ... and attempt to fill it like so: MyService.MyClient os = new MyClient(); lst = os.GetData(myRegionString, myBrandList, myColorList); ... but I get, "Cannot implicity convert type 'object[][]' to 'System.Collections.Generic.List'". What am I doing wrong? Thanks! Try MyService.MyClient os = new MyClient(); lst = os.GetData(myRegionString, myBrandList, myColorList).ToList(); Lists will get serialized into arrays as they are passed from the web service to the client, so you'll need to convert it back to a list again. c#asp.netweb-serviceslistienumerable 4 4 回答 4 This answer is useful 3 In the solution explorer, right click your service and do configuration. You may have set the data collection default type to array. You can set it to be a list type. Also, I would rethink sending an object over a web service. You typically want a well defined data type. I don't think you can even send type object over a web service. 于 2012-09-17T19:16:32.800 回答 This answer is useful 2 尝试 MyService.MyClient os = new MyClient(); lst = os.GetData(myRegionString, myBrandList, myColorList).ToList(); 列表在从 Web 服务传递到客户端时将被序列化为数组，因此您需要再次将其转换回列表。 于 2012-09-17T19:16:06.293 回答 This answer is useful 0 The MyClient.GetData() method is returning a jagged array. To convert this array into a list, you should be able to use the ToList() method from the System.Linq namespace: lst = os.GetData(myRegionString, myBrandList, myColorList).ToList(); 于 2012-09-17T19:16:52.593 回答 This answer is useful 0 Obviously you return a jagged array, not a generic list of object[]. One solution is already suggested - just change the type of the return value. But what I think is better is to use interfaces everywhere - both the array and the generic list implement IList, so if you make your method to return a value of type IList, and your lst variable is IList as well, then you shouldn't have problems even if your method returns a jagged array. 于 2012-09-17T21:26:21.517 回答 Related 0 github-api - 无法访问 api.github 2 windows-8 - 检查是否启用了执行禁用位 3 java - Excel表格编写JAVA+POI API 2 c# - 如何获取对象内部类型的属性 1 php - 使用 javascript 和 postgres 的 php 文本框自动完成功能 1 php - Android php web服务访问错误 2 javascript - JavaScript 中的动态实例化 2 c# - .NET 4.0 与 3.5 的性能 0 email - 哪些设置使 vim 成为方便的电子邮件编辑器？ 1 perl - 在 Perl 中覆盖现有的 WorkSheet Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641</object[]></object[]></string></string></object[]></object[]>

> ID：12465695
> 
> 赞同：0
> 
> 时间：
> 
> 标签：c#, asp.net, web-services, list, ienumerable

I'm trying to create and consume a web service... I'm using .NET Framework 4.0 (c#). The service exposes a method like this:

```
 public List<object[]> GetData(string strRegion, List<string> lstBrand, List<string> lstColor) 
```

Then on the client application, I declare a list of objects:

```
 List<object[]> lst = new List<object[]>(); 
```

... and attempt to fill it like so:

```
 MyService.MyClient os = new MyClient();
  lst = os.GetData(myRegionString, myBrandList, myColorList); 
```

... but I get, "Cannot implicity convert type 'object[][]' to 'System.Collections.Generic.List'". What am I doing wrong?

Thanks!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T19:16:32.800

In the solution explorer, right click your service and do configuration. You may have set the data collection default type to array. You can set it to be a list type. Also, I would rethink sending an `object` over a web service. You typically want a well defined data type. I don't think you can even send type `object` over a web service.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T19:16:06.293

尝试

```
MyService.MyClient os = new MyClient();
  lst = os.GetData(myRegionString, myBrandList, myColorList).ToList(); 
```

列表在从 Web 服务传递到客户端时将被序列化为数组，因此您需要再次将其转换回列表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T19:16:52.593

The MyClient.GetData() method is returning a jagged array. To convert this array into a list, you should be able to use the ToList() method from the System.Linq namespace:

```
lst = os.GetData(myRegionString, myBrandList, myColorList).ToList(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-17T21:26:21.517

Obviously you return a jagged array, not a generic list of object[]. One solution is already suggested - just change the type of the return value. But what I think is better is to use interfaces everywhere - both the array and the generic list implement IList, so if you make your method to return a value of type IList, and your lst variable is IList as well, then you shouldn't have problems even if your method returns a jagged array.

# asp.net - JSON 不能与 Wookmark 一起使用

> ID：12465697
> 
> 赞同：2
> 
> 时间：2012-09-17T19:14:13.380
> 
> 标签：asp.net, vb.net, json

当我尝试执行以下脚本时..我得到一个`error`。我正在尝试使用 JSON 接收数据。

```
function loadData() {
      isLoading = true;
      $('#loaderCircle').show();
      alert("OOOOO");
      $.ajax({

          url: apiURL,
          dataType: 'json',
          data: { page: page }, // Page parameter to make sure we load new data
          success: function(data) {
              isLoading = false;
              $('#loaderCircle').hide();

              // Increment page index for future calls.
              page++;

              // Create HTML for the images.
              var html = '';
              var i = 0, length = data.length, image;
              alert(data.length);
              for (; i < length; i++) {
                  image = data[i];

                  html += '<li class="polaroid"><div class="optionbg"></div><div class="optionback"><span>Necklaces</span></div><div class="options"><span class="favs">14</span><span class="fav">like it!</span></div><a href="http://www.google.co.in"><img src="' + image.preview + '" width="180" height="' + Math.round(image.height / image.width * 180) + '"></a></li>';

              }

              // Add image HTML to the page.
              $('#tiles').append(html);

              // Apply layout.
              applyLayout();
          },
          error: function(result) {
              $('#qqq').text(JSON.stringify(result));
              //alert(JSON.stringify(result));
          }
      });
    }; 
```

**网络服务：**

```
 <WebMethod(Description:="Gets the Categories")> _
    <ScriptMethod(ResponseFormat:=ResponseFormat.Json)> _
    Public Function GetCategories() As String
        Dim details As New List(Of Nodes)()

        Using ds As Data.DataSet = db.ExecuteDataSet(CommandType.Text, "SELECT NodeID,NodeName FROM Nodes WHERE ParentID='1'")
            Dim JaggedArray As String()() = New String(ds.Tables(0).Rows.Count - 1)() {}
            Dim i As Integer = 0
            For Each rs As DataRow In ds.Tables(0).Rows
                Dim node As New Nodes()
                node.NodeId = rs("NodeId").ToString
                node.NodeName = rs("NodeName").ToString
                details.Add(node)
                'JaggedArray(i) = New String() {rs("NodeName").ToString(), rs("NodeID").ToString()}
                i = i + 1
            Next
        End Using
        Dim js As New JavaScriptSerializer()
        Dim strJSON As String = js.Serialize(details.ToArray)
        Return strJSON
    End Function 
```

**JSON输出：**

`<string xmlns="http://localhost:54511/"> [{"NodeId":"BK01","NodeName":"Books","ParentId":null,"Likes":null},{"NodeId":"CO01","NodeName":"Computers","ParentId":null,"Likes":null},{"NodeId":"GA01","NodeName":"Gaming","ParentId":null,"Likes":null},{"NodeId":"MO01","NodeName":"Mobile & Accessories","ParentId":null,"Likes":null}] </string>`

**错误：**

`{"readyState":4,"responseText":"<html>\r\n <head>\r\n <title>Request format is unrecognized for URL unexpectedly ending in '/GetCategories'.</title>\r\n <style>\r\n body {font-family:\"Verdana\";font-weight:normal;font-size: .7em;color:black;} \r\n p {font-family:\"Verdana\";font-weight:normal;color:black;margin-top: -5px}\r\n b {font-family:\"Verdana\";font-weight:bold;color:black;margin-top: -5px}\r\n H1 { font-family:\"Verdana\";font-weight:normal;font-size:18pt;color:red }\r\n H2 { font-family:\"Verdana\";font-weight:normal;font-size:14pt;color:maroon }\r\n pre {font-family:\"Lucida Console\";font-size: .9em}\r\n .marker {font-weight: bold; color: black;text-decoration: none;}\r\n .version {color: gray;}\r\n .error {margin-bottom: 10px;}\r\n .expandable { text-decoration:underline; font-weight:bold; color:navy; cursor:hand; }\r\n </style>\r\n </head>\r\n\r\n <body bgcolor=\"white\">\r\n\r\n <span><H1>Server Error in '/EntLib5' Application.<hr width=100% size=1 color=silver></H1>\r\n\r\n <h2> <i>Request format is unrecognized for URL unexpectedly ending in '/GetCategories'.</i> </h2></span>\r\n\r\n <font face=\"Arial, Helvetica, Geneva, SunSans-Regular, sans-serif \">\r\n\r\n <b> Description: </b>An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code.\r\n\r\n <br><br>\r\n\r\n <b> Exception Details: </b>System.InvalidOperationException: Request format is unrecognized for URL unexpectedly ending in '/GetCategories'.<br><br>\r\n\r\n <b>Source Error:</b> <br><br>\r\n\r\n <table width=100% bgcolor=\"#ffffcc\">\r\n <tr>\r\n <td>\r\n <code>\r\n\r\nAn unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.</code>\r\n\r\n </td>\r\n </tr>\r\n </table>\r\n\r\n <br>\r\n\r\n <b>Stack Trace:</b> <br><br>\r\n\r\n <table width=100% bgcolor=\"#ffffcc\">\r\n <tr>\r\n <td>\r\n <code><pre>\r\n\r\n[InvalidOperationException: Request format is unrecognized for URL unexpectedly ending in '/GetCategories'.]\r\n System.Web.Services.Protocols.WebServiceHandlerFactory.CoreGetHandler(Type type, HttpContext context, HttpRequest request, HttpResponse response) +405913\r\n System.Web.Services.Protocols.WebServiceHandlerFactory.GetHandler(HttpContext context, String verb, String url, String filePath) +212\r\n System.Web.Script.Services.ScriptHandlerFactory.GetHandler(HttpContext context, String requestType, String url, String pathTranslated) +47\r\n System.Web.HttpApplication.MapHttpHandler(HttpContext context, String requestType, VirtualPath path, String pathTranslated, Boolean useAppConfig) +193\r\n System.Web.MapHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +93\r\n System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean&amp; completedSynchronously) +155\r\n</pre></code>\r\n\r\n </td>\r\n </tr>\r\n </table>\r\n\r\n <br>\r\n\r\n <hr width=100% size=1 color=silver>\r\n\r\n <b>Version Information:</b>&nbsp;Microsoft .NET Framework Version:2.0.50727.4971; ASP.NET Version:2.0.50727.4971\r\n\r\n </font>\r\n\r\n </body>\r\n</html>\r\n<!-- \r\n[InvalidOperationException]: Request format is unrecognized for URL unexpectedly ending in '/GetCategories'.\r\n at System.Web.Services.Protocols.WebServiceHandlerFactory.CoreGetHandler(Type type, HttpContext context, HttpRequest request, HttpResponse response)\r\n at System.Web.Services.Protocols.WebServiceHandlerFactory.GetHandler(HttpContext context, String verb, String url, String filePath)\r\n at System.Web.Script.Services.ScriptHandlerFactory.GetHandler(HttpContext context, String requestType, String url, String pathTranslated)\r\n at System.Web.HttpApplication.MapHttpHandler(HttpContext context, String requestType, VirtualPath path, String pathTranslated, Boolean useAppConfig)\r\n at System.Web.HttpApplication.MapHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()\r\n at System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously)\r\n-->","status":500,"statusText":"Internal Server Error"}`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-09T22:16:14.420

我在这里你可以找到解决方案： http: [//aspadvice.com/blogs/ssmith/archive/2007/09/04/FIX-Request-format-is-unrecognized-for-URL-unexpectedly-ending-in.aspx](http://aspadvice.com/blogs/ssmith/archive/2007/09/04/FIX-Request-format-is-unrecognized-for-URL-unexpectedly-ending-in.aspx)

# character-encoding - 引号字符变成问号

> ID：12465698
> 
> 赞同：0
> 
> 时间：2012-09-17T19:14:14.720
> 
> 标签：character-encoding

在我的本地服务器上，某个页面内容显示此字符：`“</kbd> (quotation mark). But exactly the same page on my online server displays : `?` (question mark). How can I fix that ?`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T19:28:05.727

确保服务器正在发送编码，或者您在`<head>`此处描述的部分中有元标记：http: [//www.w3.org/TR/html4/charset.html](http://www.w3.org/TR/html4/charset.html)（或两者都有）。

# android - 为什么 setSelection 方法在 onLoadFinished 中不起作用？

> ID：12465704
> 
> 赞同：1
> 
> 时间：2012-09-17T19:14:46.523
> 
> 标签：android

我想在 onLoadFinished 方法的 ListFragment 中设置选择，但是 Log.v(TAG, " onLoadFinished: Selected id -> " + getSelectedItemId()); 行返回 onLoadFinished: Selected id -> -9223372036854775808 ？

有什么问题？

```
 public void onLoadFinished(Loader<LoaderResult> loader, LoaderResult data) {
    adapter.swapCursor(data.cursor);

    // The list should now be shown.
    if (isResumed()) {
        setListShown(true);
    } else {
        setListShownNoAnimation(true);
    }
    if (data.cursor.getCount() > 0) {
        setSelection(0);
        Log.v(TAG, " onLoadFinished: Selected id -> " + getSelectedItemId());
    }        
} 
```

谢谢！

# opengl - 了解 GL 坐标 - 设置透视图和使用 gluLookAt

> ID：12465705
> 
> 赞同：2
> 
> 时间：2012-09-17T19:14:47.917
> 
> 标签：opengl

我正在使用 QGlWidget 来绘制几个点。我遇到的问题是我似乎无法正确设置视角并建立正确的观点。我一定是在某个地方误解了坐标或者做了其他愚蠢的事情，但是在阅读了一堆指南和教程后，我仍然被卡住了。屏幕是黑的，没有点。这是代码：

```
 void CGLWidget::initializeGL()
 {
    glEnable(GL_DEPTH_TEST);
    glDisable(GL_ALPHA_TEST);
    glDisable(GL_BLEND);
    glEnable(GL_POINT_SPRITE);
    glClearColor(0, 0, 0, 1);
    assert (glGetError() == GL_NO_ERROR);
 }

void CGLWidget::resizeGL(int w, int h)
 {
    glViewport(-w/2, -h/2, w/2, h <= 0 ? 1 : h/2);

    glMatrixMode(GL_PROJECTION); //Switch to setting the camera perspective
    //Set the camera perspective
    glLoadIdentity(); //Reset the camera
    gluPerspective(80.0,   //The camera FoV
    w/(double)h, //The width-to-height ratio
    1,                   //The near z clipping coordinate
    100);                //The far z clipping coordinate
 }

 void CGLWidget::paintGL()
 {
    glClearColor(0.0f, 0.0f, 0.0f, 1.0f);
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT | GL_STENCIL_BUFFER_BIT);

    glMatrixMode(GL_MODELVIEW);
    glLoadIdentity();
    gluLookAt(0, 0, 5, 0, 0, 0, 0, 1, 0);
    glLoadIdentity();

    glColor3i(255, 255, 255);
    glBegin(GL_POINTS);
        glVertex3d(0,0, -2);
        glVertex3d(0,0, -3);
        glVertex3d(0,0, +3);
        glVertex3d(0,0, 0);
        glVertex3f(-0.75f, -0.25f, -5.0f);
    glEnd();

    assert (glGetError() == GL_NO_ERROR);
 } 
```

我已经尝试在 gluLookAt 中操纵“眼睛”的 z 坐标但无济于事，所以我一定是弄错了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T19:28:52.353

为了更清楚地了解如何`gluPerspective()`和工作，我建议使用[Nate Robins](http://user.xmission.com/~nate/tutors.html)`gluLookAt()`的教程，更具体地说是**投影**演示。

 **相信我，*这就是你要找的机器人*！

![在此处输入图像描述](../Images/53b3d615019cf0c90387d6f9805c4839.png)

无论如何，几天前我在 Qt 中写了 Nehe 第[5 课（3D 形状）的增强版：](http://nehe.gamedev.net/tutorial/3d_shapes/10035/)

**GLWidget.cpp**：

```
#include "GLWidget.h"

#include <iostream>
#include <QKeyEvent>
#include <QTimer>

GLWidget::GLWidget(QWidget *parent)
: QGLWidget(parent)
{
    angle_tri = 0.f;
    angle_quad = 0.f;
    _eye_x = 0.f;
    _eye_y = 0.f;
    _mouse_is_moving = false;
    _width = 0;
    _height = 0;
}

GLWidget::~GLWidget()
{

}

void GLWidget::_tick()
{
    update(); // triggers paintGL()
    QTimer::singleShot(33, this, SLOT(_tick()));
}

void GLWidget::initializeGL()
{
//    glShadeModel(GL_SMOOTH);                          // Enable Smooth Shading
    glClearColor(0.0f, 0.0f, 0.0f, 1.0f);               // Black Background
//    glClearDepth(1.0f);                                   // Depth Buffer Setup
//    glEnable(GL_DEPTH_TEST);                          // Enables Depth Testing
//    glDepthFunc(GL_LEQUAL);                               // The Type Of Depth Testing To Do
//    glEnable ( GL_COLOR_MATERIAL );
//    glHint(GL_PERSPECTIVE_CORRECTION_HINT, GL_NICEST);

    _tick();
}

void GLWidget::paintGL()
{    
    if (_mouse_is_moving)
    {
        glMatrixMode   ( GL_PROJECTION );  // Select The Projection Matrix
        glLoadIdentity ( );                // Reset The Projection Matrix

        gluPerspective ( 60, ( float ) _width / ( float ) _height, 1.0, 50.0 );
        gluLookAt(0.0,  0.0, 2.0,           // eye
                  _eye_x,  _eye_y, 0.0,     // center
                  0.0,  1.0, 0.0);          // up

        std::cout << "paintGL: eye " << _eye_x << "," << _eye_y << std::endl;

    }

    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT); // Clear Screen And Depth Buffer

    glMatrixMode   ( GL_MODELVIEW );  // Select The Model View Matrix
    glLoadIdentity();                                   // Reset The Current Modelview Matrix

    glPushMatrix();
    glTranslatef(-1.5f,0.0f,-6.0f);                     // Move Left 1.5 Units And Into The Screen 6.0
    glRotatef(angle_tri,0.0f,1.0f,0.0f);                // Rotate The Triangle On The Y axis
    glBegin(GL_TRIANGLES);                              // Drawing Using Triangles
        glColor3f(1.0f,0.0f,0.0f);          // Red
        glVertex3f( 0.0f, 1.0f, 0.0f);          // Top Of Triangle (Front)
        glColor3f(0.0f,1.0f,0.0f);          // Green
        glVertex3f(-1.0f,-1.0f, 1.0f);          // Left Of Triangle (Front)
        glColor3f(0.0f,0.0f,1.0f);          // Blue
        glVertex3f( 1.0f,-1.0f, 1.0f);          // Right Of Triangle (Front)

        glColor3f(1.0f,0.0f,0.0f);          // Red
        glVertex3f( 0.0f, 1.0f, 0.0f);          // Top Of Triangle (Right)
        glColor3f(0.0f,0.0f,1.0f);          // Blue
        glVertex3f( 1.0f,-1.0f, 1.0f);          // Left Of Triangle (Right)
        glColor3f(0.0f,1.0f,0.0f);          // Green
        glVertex3f( 1.0f,-1.0f, -1.0f);         // Right Of Triangle (Right)

        glColor3f(1.0f,0.0f,0.0f);          // Red
        glVertex3f( 0.0f, 1.0f, 0.0f);          // Top Of Triangle (Back)
        glColor3f(0.0f,1.0f,0.0f);          // Green
        glVertex3f( 1.0f,-1.0f, -1.0f);         // Left Of Triangle (Back)
        glColor3f(0.0f,0.0f,1.0f);          // Blue
        glVertex3f(-1.0f,-1.0f, -1.0f);         // Right Of Triangle (Back)

        glColor3f(1.0f,0.0f,0.0f);          // Red
        glVertex3f( 0.0f, 1.0f, 0.0f);          // Top Of Triangle (Left)
        glColor3f(0.0f,0.0f,1.0f);          // Blue
        glVertex3f(-1.0f,-1.0f,-1.0f);          // Left Of Triangle (Left)
        glColor3f(0.0f,1.0f,0.0f);          // Green
        glVertex3f(-1.0f,-1.0f, 1.0f);          // Right Of Triangle (Left)
    glEnd();                                            // Finished Drawing The Triangle

    glLoadIdentity();                   // Reset The Current Modelview Matrix
    glTranslatef(1.5f,0.0f,-9.0f);              // Move Right 1.5 Units And Into The Screen 6.0
    glRotatef(angle_quad,1.0f,0.0f,0.0f);           // Rotate The Quad On The X axis
    glBegin(GL_QUADS);                                  // Draw A Quad
        glColor3f(0.0f,1.0f,0.0f);          // Set The Color To Green
        glVertex3f( 1.0f, 1.0f,-1.0f);          // Top Right Of The Quad (Top)
        glVertex3f(-1.0f, 1.0f,-1.0f);          // Top Left Of The Quad (Top)
        glVertex3f(-1.0f, 1.0f, 1.0f);          // Bottom Left Of The Quad (Top)
        glVertex3f( 1.0f, 1.0f, 1.0f);          // Bottom Right Of The Quad (Top)

        glColor3f(1.0f,0.5f,0.0f);          // Set The Color To Orange
        glVertex3f( 1.0f,-1.0f, 1.0f);          // Top Right Of The Quad (Bottom)
        glVertex3f(-1.0f,-1.0f, 1.0f);          // Top Left Of The Quad (Bottom)
        glVertex3f(-1.0f,-1.0f,-1.0f);          // Bottom Left Of The Quad (Bottom)
        glVertex3f( 1.0f,-1.0f,-1.0f);          // Bottom Right Of The Quad (Bottom)

        glColor3f(1.0f,0.0f,0.0f);          // Set The Color To Red
        glVertex3f( 1.0f, 1.0f, 1.0f);          // Top Right Of The Quad (Front)
        glVertex3f(-1.0f, 1.0f, 1.0f);          // Top Left Of The Quad (Front)
        glVertex3f(-1.0f,-1.0f, 1.0f);          // Bottom Left Of The Quad (Front)
        glVertex3f( 1.0f,-1.0f, 1.0f);          // Bottom Right Of The Quad (Front)

        glColor3f(1.0f,1.0f,0.0f);          // Set The Color To Yellow
        glVertex3f( 1.0f,-1.0f,-1.0f);          // Bottom Left Of The Quad (Back)
        glVertex3f(-1.0f,-1.0f,-1.0f);          // Bottom Right Of The Quad (Back)
        glVertex3f(-1.0f, 1.0f,-1.0f);          // Top Right Of The Quad (Back)
        glVertex3f( 1.0f, 1.0f,-1.0f);          // Top Left Of The Quad (Back)

        glColor3f(0.0f,0.0f,1.0f);          // Set The Color To Blue
        glVertex3f(-1.0f, 1.0f, 1.0f);          // Top Right Of The Quad (Left)
        glVertex3f(-1.0f, 1.0f,-1.0f);          // Top Left Of The Quad (Left)
        glVertex3f(-1.0f,-1.0f,-1.0f);          // Bottom Left Of The Quad (Left)
        glVertex3f(-1.0f,-1.0f, 1.0f);          // Bottom Right Of The Quad (Left)

        glColor3f(1.0f,0.0f,1.0f);          // Set The Color To Violet
        glVertex3f( 1.0f, 1.0f,-1.0f);          // Top Right Of The Quad (Right)
        glVertex3f( 1.0f, 1.0f, 1.0f);          // Top Left Of The Quad (Right)
        glVertex3f( 1.0f,-1.0f, 1.0f);          // Bottom Left Of The Quad (Right)
        glVertex3f( 1.0f,-1.0f,-1.0f);          // Bottom Right Of The Quad (Right)
    glEnd();                                            // Done Drawing The Quad
    glPopMatrix();

    angle_tri += 3.2f;                      // Increase The Rotation Variable For The Triangle ( NEW )
    angle_quad -= 3.15f;                    // Decrease The Rotation Variable For The Quad     ( NEW )

}

void GLWidget::resizeGL( int w, int h)
{
    _width = w;
    _height = h;
    glViewport     ( 0, 0, w, h );
    glMatrixMode   ( GL_PROJECTION );  // Select The Projection Matrix
    glLoadIdentity ( );                // Reset The Projection Matrix
    if ( h==0 )  // Calculate The Aspect Ratio Of The Window
       gluPerspective ( 60, ( float ) w, 1.0, 50.0 );
    else
       gluPerspective ( 60, ( float ) w / ( float ) h, 1.0, 50.0 );

    gluLookAt(0.0,  0.0, 2.0,   // eye
              0.0,  0.0, 0.0,   // center
              0.0,  1.0, 0.0);  // up

    glMatrixMode   ( GL_MODELVIEW );  // Select The Model View Matrix
    glLoadIdentity ( );    // Reset The Model View Matrix
}

void GLWidget::mousePressEvent(QMouseEvent *event)
{
    std::cout << "mousePressEvent:" << std::endl;
    _mouse_is_moving = true;
}

void GLWidget::mouseReleaseEvent(QMouseEvent *event)
{
    std::cout << "mouseReleaseEvent:" << std::endl;
    _mouse_is_moving = false;
}

void GLWidget::mouseMoveEvent(QMouseEvent *event)
{
    if (_mouse_x == 0)
        _mouse_x = event->pos().x();

    if (_mouse_y == 0)
        _mouse_y = event->pos().y();

    std::cout << "mouseMoveEvent: " << event->pos().x() << "," << event->pos().y() << std::endl;

    if (event->pos().x() > _mouse_x)
    {
        _eye_x += 0.10;
    }
    else if (event->pos().x() < _mouse_x)
    {
        _eye_x -= 0.10;
    }

    if (event->pos().y() > _mouse_y)
    {
        _eye_y += 0.10;
    }
    else if (event->pos().y() < _mouse_y)
    {
        _eye_y -= 0.10;
    }

    _mouse_x = event->pos().x();
    _mouse_y = event->pos().y();
} 
```

**GLWidget.h**：

```
#include <QGLWidget>

class GLWidget : public QGLWidget
{
    Q_OBJECT
public:
    explicit GLWidget(QWidget* parent = 0);
    virtual ~GLWidget();

    /* OpenGL initialization, viewport resizing, and painting */

    void initializeGL();

    void paintGL();

    void resizeGL( int width, int height);

    /* enable the user to interact directly with the scene using the mouse */

    void mousePressEvent(QMouseEvent *event);
    void mouseReleaseEvent(QMouseEvent *event);    
    void mouseMoveEvent(QMouseEvent *event);

private:
    float angle_tri;            // Angle For The Triangle
    float angle_quad;           // Angle For The Quad
    float _eye_x;
    float _eye_y;
    bool _mouse_is_moving;
    int _mouse_x;
    int _mouse_y;
    int _width;
    int _height;

protected slots:
    void _tick();

}; 
```

**主.cpp**：

```
#include <QApplication>
#include "glwidget.h"

int main(int argc, char* argv[])
{
    QApplication app(argc, argv);

    GLWidget gl_widget;
    gl_widget.show();

    return app.exec();
} 
```

![在此处输入图像描述](../Images/a7895ebf239c644334b90c44280d7b01.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T19:27:56.290

我认为你在那里得到的东西看起来大多是正确的，尽管你的 glViewport 参数看起来是错误的。glViewport 应该是（左，下，宽，高），但你使用的是别的东西。

将 glViewport 设置为`glViewport(0,0,width,height);`.

更多解释：

通过 modelViewProjection 矩阵（和透视分割）进行转换后，所有坐标都位于所谓的标准化设备坐标（缩写为 NDC）中。NDC 在每个轴上的范围从 -1 到 1，这将 (0,0,0) 放在查看区域的中心。

当您的点直接位于相机前面时，它会转换为标准化设备坐标中的 xy (0,0)。

如果您查看 glViewport 上的公式，这些公式会将 NDC 映射到屏幕上的实际像素。

因此，如果您提供`(0,0,1024,768)`参数，它会被映射如下：

```
screen X = ( Xnd + 1 ) ( width / 2) + x;
screen Y = ( Ynd + 1 ) ( height / 2) + y; 
```

替换我们的 glViewport 值：

```
screen X = ( 0 + 1 ) ( 1024 / 2) + 0;
screen Y = ( 0 + 1 ) ( 768  / 2) + 0;

screen X = ( 1 ) ( 1024 / 2) ;
screen Y = ( 1 ) ( 768  / 2) ;

screen X = ( 1 ) ( 512 ) ;
screen Y = ( 1 ) ( 384 ) ;

screen X =  512 ; //center of screen X
screen Y =  384 ; //center of screen Y 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-17T19:23:59.070

老实说，您的 near 值非常大，通常这必须是一个较低的值，这样如果您有一个 2D 环境作为示例，您仍然可以渲染对象。我会说`0.1(0.5)`视角的近值应该很好。

注意：如果您将 near 值设置为较大的数字，您的几何体将被相机裁剪（透视平截头体）。**

# session - Symfony2.1 - 一遍又一遍地存储新会话

> ID：12465710
> 
> 赞同：0
> 
> 时间：2012-09-17T19:15:11.203
> 
> 标签：session, symfony

我想知道为什么我正在编写的网站页面的每次刷新或在不同页面之间移动都会创建新的会话记录（我将它们存储在数据库中而不是使用标准解决方案）。换句话说，每次单击（我没有使用 JS/AJAX）都会创建新记录/新会话。

这是我在配置文件中的会话配置：

```
session:
    lifetime:       7200
    domain:  MY_SERVER
    handler_id:     session.handler.pdo

parameters:
  pdo.db_options:
    db_table:    session
    db_id_col:   session_id
    db_data_col: session_value
    db_time_col: session_time

services:
  pdo:
    class: PDO
    arguments:
        dsn:            HOST
        user:           USER
        password:       PSWD

session.handler.pdo:
    class:     Symfony\Component\HttpFoundation\Session\Storage\Handler\PdoSessionHandler
    arguments: [@pdo, %pdo.db_options%] 
```

我尝试使用：

```
 auto_start:     false 
```

但是我从 Symfony2.1 得到以下错误：

```
 The auto_start setting is deprecated. Just remove it from your configuration file. 
```

那么我应该怎么做才能有正常的会话呢？

**更新**我还使用了以下内容：

```
 arguments:
      - "mysql:host=%database_host%;dbname=%database_name%"
      - %database_user%
      - %database_password% 
```

也就是说，我对整个项目的基本数据库设置（存储在 parameters.yml 中）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-21T18:57:42.920

如果您没有将 session_id 设置为主键，则可能会发生这种情况。使用（来自文档，MySQL）创建会话表：

```
CREATE TABLE `session` (
    `session_id` varchar(255) NOT NULL,
    `session_value` text NOT NULL,
    `session_time` int(11) NOT NULL,
    PRIMARY KEY (`session_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8; 
```

对于其他数据库，请参阅[如何使用 PdoSessionHandler 将 Sessions 存储在数据库中](http://symfony.com/doc/current/cookbook/configuration/pdo_session_storage.html "如何使用 PdoSessionHandler 将 Sessions 存储在数据库中")

# ios - 如何在 iOS 中计算地理边界框？

> ID：12465711
> 
> 赞同：7
> 
> 时间：2012-09-17T19:15:15.453
> 
> 标签：ios, geolocation, bounding-box

我想在 iOS 中进行地理边界框计算。它可以是aprox。

**输入参数：**

当前位置（例如：41.145495、-73.994901）

以米为单位的半径：（示例：2000）

**所需输出：**

闽龙：（例：41.9995495）

MinLat：（示例：-74.004901）

MaxLong：（例如：41.0005495）

MaxLat：（示例：-73.004901）

**要求：** 无网络通话

有任何想法吗？Mapkit / CoreLocation 似乎没有提供这种类型的东西？

我可以使用的任何其他地理 SDK 吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-26T17:30:14.367

我认为您可以使用标准的 MapKit 函数：[MKCoordinateRegionMakeWithDistance](http://developer.apple.com/library/ios/documentation/MapKit/Reference/MapKitFunctionsReference/Reference/reference.html#//apple_ref/c/func/MKCoordinateRegionMakeWithDistance)，这将返回一个[MKCoordinateRegion](http://developer.apple.com/library/ios/#documentation/MapKit/Reference/MapKitDataTypesReference/Reference/reference.html#//apple_ref/doc/c_ref/MKCoordinateRegion)，它实际上只是一个中心点（纬度，经度）和纬度和经度方向的跨度（以度为单位）。分别从纬度和经度添加/减去跨度的一半，您就有了您正在寻找的值。

```
CLLocationCoordinate2D centerCoord = CLLocationCoordinate2DMake(41.145495, −73.994901);
MKCoordinateRegion region = MKCoordinateRegionMakeWithDistance(centerCoord, 2000, 2000);

double latMin = region.center.latitude - .5 * startRegion.span.latitudeDelta;
double latMax = region.center.latitude + .5 * startRegion.span.latitudeDelta;
double lonMin = region.center.longitude - .5 * startRegion.span.longitudeDelta;
double lonMax = region.center.longitude + .5 * startRegion.span.longitudeDelta; 
```

顺便说一句：这仅代表小跨度的经度，大约为几公里。[引用苹果的](http://developer.apple.com/library/ios/documentation/MapKit/Reference/MapKitFunctionsReference/Reference/reference.html#//apple_ref/c/func/MKCoordinateSpanMake)话：

> ***latitudeDelta***
> 用于跨度的南北距离量（以度为单位）。与因纬度而异的纵向距离不同，一个纬度始终约为 111 公里（69 英里）。
> 
> ***longitudeDelta***
> 用于跨度的东西距离量（以度为单位）。经度范围跨越的公里数根据当前纬度而变化。例如，1 度经度在赤道处跨越大约 111 公里（69 英里）的距离，但在两极缩小到 0 公里。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-20T22:55:29.407

我知道我参加聚会有点晚了，但我刚刚建立了一个`GTBoundingBox`可能（或可能没有）帮助的课程：

[https://github.com/wpearse/ios-geotools](https://github.com/wpearse/ios-geotools)

# regex - 如何匹配在已知模式之后出现的模式

> ID：12465725
> 
> 赞同：0
> 
> 时间：2012-09-17T19:16:25.903
> 
> 标签：regex, awk, match

考虑绑定 dns 区域文件的格式：

```
zone "mydomain.com" {
    type slave;
    file "db.mydomain";
    masters {
            192.168.5.15;
    };
}; 
```

...

对 conf 文件中的其他区域重复多次。

我需要在脚本中发现有关 zone.conf 文件的一些详细信息。

我知道我正在寻找的域，所以我可以正则表达式为'^zone“mydomain.com”'

但是我需要发现在我正在查看的区域名称之后首先出现的文件行。

我还想在 master 列表中发现 ip 地址。

我们的配置只有一个主 ip，所以我不必担心多个 ip。

想法赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T19:39:59.317

`sed`可用于隔离 dns 文件的右侧部分，然后在模式匹配后打印下一行：

```
# sed -n '/"mydomain.com"/,/^};$/{/^zone "mydomain.com"/{n;p}}' dnsfile
   type slave;
# sed -n '/"mydomain.com"/,/^};$/{/masters/{n;p}}' dnsfile
        192.168.5.15; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T20:07:03.337

这里的一种方法是使用 sed 首先输出您感兴趣的区域块，然后只获取您想要的行。这可能类似于以下内容：

```
sed -n '/^zone "mydomain.com"/,/^};/p' zone.conf | sed -n -e '2p' -e '/[0-9]/p' 
```

`2p`将仅打印第二行（区域名称后的第一行），并且`/[0-9]/p`仅打印包含数字（IP 地址）的行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T20:58:40.767

要获得带有修剪 IP 的下一行：

```
awk -F';' '/^ *masters/ { getline; sub(/^ */, "", $1); print $0 }' file 
```

### 输出

```
192.168.5.15 
```

获取区域线：

```
awk -F';' '/^zone "mydomain.com"/ { getline; sub(/^ */, "", $1); print $0}' file 
```

### 输出

```
192.168.5.15 
```

# wordpress - wordpress 无法将具有查询的脚本/样式出列

> ID：12465730
> 
> 赞同：8
> 
> 时间：2012-09-17T19:16:36.400
> 
> 标签：wordpress

不确定我的措辞是否正确，但基本上我只想在使用实际插件的页面上加载插件 CSS/JS。我已经通过插件文件搜索插件中使用的任何句柄完成了很多工作，`wp_enqueue_script`并且只是`wp_dequeue_script`他们在functions.php

但是，有一些包含 .php 而不是 css 文件的样式排队，例如.. 在插件中它排队一个文件

```
wp_enqueue_style("myrp-stuff", MYRP_PLUGIN_URL . "/myrp-hotlink-css.php"); 
```

所以我试过：

```
wp_dequeue_style('myrp-stuff');
wp_deregister_style('myrp-stuff'); 
```

它不起作用

但是，当呈现页面/帖子时，它显示为

```
<link rel='stylesheet' id='myrp-stuff-css'  href='http://www.modernlogic.co/wp/wp-content/plugins/MyRP/myrp-hotlink-css.php?ver=3.4.2' type='text/css' media='all' /> 
```

它将 -css 添加到 id 并拒绝出队/注销和移动。

我也试过以下没有运气

```
wp_dequeue_style('myrp-stuff-css');
wp_deregister_style('myrp-stuff-css'); 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-04-12T02:37:26.587

脚本和样式可以在`wp_print_*`触发操作之前的任何时间以任何顺序排列。这使得在输出之前很难将它们从队列中删除。

为了使出队工作始终挂钩`wp_print_styles`或`wp_print_scripts`具有高优先级，因为这将在输出之前删除脚本和样式。

例如，在您的插件加载器代码或模板`functions.php`文件中，您可以有一个函数和操作挂钩，如下所示：

```
function remove_assets() {
    wp_dequeue_style('myrp-stuff');
    wp_deregister_style('myrp-stuff');
}
add_action( 'wp_print_styles', 'remove_assets', PHP_INT_MAX ); 
```

挂钩到动作时设置高`priority`（第三个参数`add_action`）将有助于确保回调`remove_assets`被调用*last*，就在打印脚本/样式之前。

请注意，虽然这种技术对于*删除*脚本/样式是合法的，但它不应该用于*添加*资产。有关更多信息，请参阅此[Wordpress Core 博客文章](http://make.wordpress.org/core/2011/12/12/use-wp_enqueue_scripts-not-wp_print_styles-to-enqueue-scripts-and-styles-for-the-frontend/)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-29T19:30:40.457

可以肯定的是，您是否将代码放在由这样的操作调用的函数中？：

```
add_action('wp_enqueue_scripts', 'dequeue_function');
function dequeue_function() {
    wp_dequeue_style( array('myrp-stuff', 'myrp-stuff-css') );
    wp_deregister_style( array('myrp-stuff', 'myrp-stuff-css') );
} 
```

# java - Java：在运行时获取泛型类参数

> ID：12465738
> 
> 赞同：1
> 
> 时间：2012-09-17T19:17:01.067
> 
> 标签：java, generics, parameterized

我有两个类，一个抽象的，一个具体的：

```
abstract class Generator<T>;
class ConGenerator<T extends Complex<Z,Y>, Z extends Something1, Y extends Something2> extends Generator<T>; 
```

由于参数数量的变化（我认为），我无法使用通常的方法在运行时获取参数类`ParametrizedType`，即

```
ParameterizedType genericSuperclass = (ParameterizedType)getClass().getGenericSuperclass();
Type[] type = genericSuperclass.getActualTypeArguments(); 
```

我得到的只是我用于参数的名称，`T`. 我将不胜感激解决此问题的任何帮助，我已经在网上搜索并使用了其他人为此类问题编写的一些库；到目前为止没有运气。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T19:45:24.047

**问题**

给定运行时类，并不总是可以推断类型参数，而您的情况就是这样。根本问题是泛型类的所有实例（无论它们的类型参数如何）共享相同的运行时类，即：

```
new ArrayList<Integer>().getClass() == new ArrayList<String>().getClass() 
```

因此，如果该类是泛型的并且该类的不同实例可以对类型参数使用不同的值，则不可能发现仅给定运行时类的类型参数。（是的，我们可以找到 class 的类型参数`X<T extends String>`，因为 String 是 final，因此是唯一可能的参数。同样，如果我们知道运行时类是，我们可以找到 List 的类型参数`class MappedList<T> implements List<String> { ... }`）。

相反，如果运行时类不是泛型的，则总是可以推断出超类的类型参数——这就是所有那些在网上漂浮的库和代码示例所做的各种复杂程度的操作。例如，如果您有：

```
class StringArrayList extends ArrayList<String> { ... } 
```

您会发现 ArrayList 的类型参数是`String`. 这也适用于匿名类（只要它们不是通用的），因为：

```
new ArrayList<String>() {}.getClass() != new ArrayList<Integer>() {}.getClass() 
```

但使用泛型类失败，例如

```
ArrayList<T> makeList(T t) {
    return new ArrayList<T>(t) {};
} 
```

因为

```
makeList("2").getClass() == makeList(2).getClass() 
```

**解决方案**

如果您在运行时需要该类型，则需要通过其他方式提供它，通常是通过将`Class`对象传递给构造函数。您还可以使用超类型标记（所需类型的非泛型，通常是匿名的子类的实例，它允许您通过反射发现类型参数）。这样做的好处是也可以表达本身是泛型的类型参数。

如果您只需要特定事物的类，则可能有更简单的选择。例如，如果您只需要创建类型参数的新实例，工厂（方法）模式就简单多了:-)

# mongodb - 如何使用 UTC 时间戳导出 Mongo 数据？

> ID：12465742
> 
> 赞同：0
> 
> 时间：2012-09-17T19:17:19.070
> 
> 标签：mongodb

我正在尝试使用 mongoexport 以 json 格式导出一堆数据，以便我可以在不同的程序中读取它。我使用命令：

```
mongoexport --jsonArray -h some_ip -d some_db -c some_collection -o mongo_dump.json 
```

问题是，我所有的日期时间对象最终看起来像：

```
"time_created" : { "$date" : 1344000402000 }
"time_created" : { "$date" : 1343999298000 } 
```

这是特殊的 64 位 mongo 时间格式。我可以指定一些简单的东西来获取unixtimestamps吗？Mongo 时间对我来说毫无用处，而且转换起来很烦人。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T20:14:15.167

不幸的是，我认为在输出中没有更改它们的标志。

但是，由于差异只是末尾的额外三位数字，因此您可以执行以下操作：

```
sed -e 's/{ "\$date" : \([0-9]*\)[0-9]\{3\}/{ "\$date" : \1/' mongo_dump.json > unixstyle.json 
```

它转换为：

```
"time_created" : { "$date" : 1344000402000 }
"time_created" : { "$date" : 1343999298000 } 
```

到：

```
"time_created" : { "$date" : 1344000402 }
"time_created" : { "$date" : 1343999298 } 
```

**编辑以修复它以处理各种数字，而不仅仅是 0**

# java - 其他电脑上的Netty连接超时

> ID：12465743
> 
> 赞同：0
> 
> 时间：2012-09-17T19:17:22.877
> 
> 标签：java, client-server, netty

我使用 Netty 在 Java 上编写了服务器和客户端。当我在我的 PC 上运行客户端时，它工作得很好。当我试图在其他 PC 上运行客户端时，它会抛出我：

```
java.net.ConnectException：连接超时
   在 org.jboss.netty.channel.socket.nio.NioClientSocketPipelineSink$Boss.processConnectTimeout(NioClientSocketPipelineSink.java:391)
   在 org.jboss.netty.channel.socket.nio.NioClientSocketPipelineSink$Boss.run(NioClientSocketPipelineSink.java:289)
   在 java.util.concurrent.ThreadPoolExecutor$Worker.runTask（未知来源）
   在 java.util.concurrent.ThreadPoolExecutor$Worker.run（未知来源）
   在 java.lang.Thread.run（未知来源）
2012 年 9 月 17 日上午 10:58:55 org.jboss.netty.channel.SimpleChannelHandler

```

这是什么原因？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T19:31:38.313

检查连接参数。

*   服务器是否从另一个客户端可见？（尝试从客户端 ping 服务器）。
*   中间有防火墙吗？尝试关闭它们。
*   检查连接字符串。确保您没有连接到本地主机。
*   检查服务器配置。它是否在正确的网络接口上侦听。

如果您检查了所有内容，并且看起来还可以。在此处发布网络连接代码。

快乐编码:)

# c# - asp.net，Gridview RowEditing 事件仅适用于第一行

> ID：12465744
> 
> 赞同：1
> 
> 时间：2012-09-17T19:17:26.840
> 
> 标签：c#, asp.net

我正在使用 c# 在 asp.net 上工作。我有一个带有模板字段列的网格视图，数据来自一个 sql 数据库。我在项目模板上有链接按钮，链接按钮调用 Rowediting 事件来启用编辑。这在第一行工作正常。但是，当我单击任何其他行时，什么也没有发生，该事件永远不会触发。

我该如何解决这个问题？

谢谢..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T19:20:42.657

您很可能在 Page_Load 事件中对网格进行数据绑定。如果是这种情况，[ASP.NET 页面生命周期](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&frm=1&source=web&cd=1&cad=rja&ved=0CCIQFjAA&url=http://msdn.microsoft.com/en-us/library/ms178472%28v=vs.100%29.aspx&ei=E3hXUNCHAbOByQHbu4DoCg&usg=AFQjCNH7k8oXjBvm9VNxhszmprCq5wkVvw)就会妨碍您。（请务必阅读提供的链接中的文章。每个 .NET 开发人员都需要了解 Page_Lifecycle。它解释了许多否则会导致混淆的行为，例如这种行为。）

Page_Load 事件在每次回发时发生——每次按钮点击，或任何触发回发的事件。

如果是这种情况，有两种可能的选择：

1.  将数据绑定代码移动到 Page_Init
2.  将您的数据绑定放在 Page_Load`if(!Page.IsPostback)`块内。

本质上，问题在于您的页面在第一次加载时是数据绑定的。然后编辑事件由一些客户端操作触发，这会触发回发。在这个回发中，Page_Load 首先触发，它重新绑定 GridView，擦除之前加载时与其关联的所有数据。因此，当 RowEditing 事件触发时（控制事件总是在 Page_Load 之后发生），它没有什么可做的。对回发之前存在的数据的所有引用都消失了。

如果你也移动你的绑定代码Page_Init，你可以绕过这个，因为页面将被绑定，然后所有的Viewstate将被重新应用到它，恢复在上面的场景中回发中丢失的数据。

# c# - 索引超出了数组的范围（第 500 个？）

> ID：12465748
> 
> 赞同：0
> 
> 时间：2012-09-17T19:17:58.757
> 
> 标签：c#, asp.net

在加载时调用该函数并且错误指向该函数。仅在发布时，我不会在调试时出现索引超出范围错误。

```
 {
        string strLogonUser = Request.ServerVariables["LOGON_USER"];
        var credential = strLogonUser.Split(@"\".ToCharArray())[1];

        cnn.Open();
        SqlTransaction tran = cnn.BeginTransaction();
        cmd.Connection = cnn;
        cmd.Transaction = tran;
        cmd.CommandText = "StoredProcedure";
        cmd.CommandType = CommandType.StoredProcedure;
        cmd.Parameters.Add("@UserLogin", SqlDbType.NVarChar).Value = credential;
        cmd.ExecuteNonQuery();

    }

    [IndexOutOfRangeException: Index was outside the bounds of the array.]
   _Default.ReadUser() +357
   _Default.Page_Load(Object sender, EventArgs e) +46
   System.Web.Util.CalliHelper.EventArgFunctionCaller(IntPtr fp, Object o, Object t, EventArgs e) +25
   System.Web.Util.CalliEventHandlerDelegateProxy.Callback(Object sender, EventArgs e) +42
   System.Web.UI.Control.OnLoad(EventArgs e) +132
   System.Web.UI.Control.LoadRecursive() +66
   System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +2428 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T19:20:36.010

`LOGON_USER`好吧，如果服务器变量不包含反斜杠，那么您肯定会收到该错误...您将采用单元素数组的元素 1（第二个元素）。

听起来您应该在拆分之前添加更多日志记录以记录该值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T19:21:48.693

你可以添加一个`"LOGON_USER"`变量检查​​：

```
string strLogonUser = Request.ServerVariables["LOGON_USER"];

if(String.IsNullOrEmpty(strLogonUser))  // <<<<<<
    throw new ArgumentException();  

var credential = strLogonUser.Split(@"\".ToCharArray())[1]; 
```

好像没有设置这个变量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T19:22:21.003

很可能您允许匿名访问，因此您将在该变量中有一个空白字符串

# php - 在 div 中换行时出错

> ID：12465758
> 
> 赞同：3
> 
> 时间：2012-09-17T19:18:34.577
> 
> 标签：php, mysql, html, css

你能告诉我为什么`varun09`在下面的图片中会出现中断吗？这有点奇怪，因为只有当语句大于实际宽度时才会发生这种情况`<div>`，我想知道如何包装文本？我想要垂直滚动选项，而不是水平滚动条。

我正在`<div>`通过 PHP 填充 Mysql 数据。

代码是：

```
while ($row = mysql_fetch_assoc($query_run)) {
    echo '<p>'.$row['user_name'].' '.$row['chat_body'].'</p><br> ';
} 
```

![为什么换行？](../Images/38ce52941d09072de89e3527a4ab68e5.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T19:20:14.303

**[jsBin 演示](http://jsbin.com/ahiyeg/1/edit)**

为您的元素使用 CSS 属性`word-wrap`：

```
word-wrap: break-word; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T19:22:55.777

您可以使用自动换行属性：

```
selector {
    word-wrap: break-word;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T19:21:16.463

您需要设置空格以便它为您换行，但 varun09 之后的空格将导致下一个进入下一行。试试这个组合：

[jsFiddle 演示](http://jsfiddle.net/XqStw/)

```
p { word-wrap: break-word; white-space:pre; }​ 
```

[**关于空白的**信息在这里](http://www.w3schools.com/cssref/pr_text_white-space.asp)

# php - 以最佳方式计算特定id的mysql表中的行数

> ID：12465760
> 
> 赞同：1
> 
> 时间：2012-09-17T19:18:36.847
> 
> 标签：php, mysql, optimization, query-optimization

我正在使用此代码

```
$sql1 = mysql_query("SELECT section_id FROM forum_posts WHERE section_id='$sectionID'  ");
$num_rows = mysql_num_rows($sql1); 
```

统计特定类别下的帖子数量，以在论坛主页上显示特定部分中有多少帖子。那么有没有更好的选择来浏览该类型的所有帖子。我认为如果我使用它，这将是一个巨大的性能消耗。

编辑1：我只需要显示论坛中每个部分下的帖子数量，所以我想在主页中查看每个部分现在有多少主题。什么是它的最佳 mysql 查询。

编辑 2：我应该按照 phpmanual 中的说明替换 mysql_query 函数吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T19:25:02.780

只需在 sql 本身中使用 count 即可。

```
$sql1 = mysql_query("SELECT count(post_id) as 'count_of_posts' FROM forum_posts WHERE section_id='$sectionID' "); 
```

如果您想同时获取所有部分计数，您可以这样做：

```
$sql1 = mysql_query("SELECT section_id, count(post_id) as 'count_of_posts' FROM forum_posts WHERE section_id='$sectionID' group by section_id"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T19:32:20.667

使用 COUNT() 聚合函数来计算行数是更普通的 SQL。如果您需要一次计算多个部分，请使用 GROUP BY。但你知道的，对吧？

先对标，再优化。

1.  使用生产大小的数据负载加载您的测试服务器（必须是生产规格）；将所有参数配置为与生产服务器相同。
2.  反复运行代码并计时。
3.  如果它似乎没有变慢，你就完成了。

我的建议：

1.  解释查询。如果它正在运行全表扫描，则在 Section ID 上添加索引。这应该减少全表扫描，至少减少全索引扫描。这可能仍然太慢。
2.  如果这仍然太慢，请考虑在某处缓存结果。当帖子被添加、删除或移动到另一个部分时，您可以使此缓存无效。
3.  如果缓存不方便或不起作用 - 例如，如果缓存的命中率低于 90%，请考虑永久存储计数并手动调整它们。然后，当其帖子未更改时，您无需重新计算该部分的计数。

假设您有 1e9 个帖子，分 1e3 个部分。大多数时候，大多数版块的帖子都不会改变。因此，您只需修改受操作影响的部分的计数 - 例如，对于添加/删除，您只需更新一个部分，对于移动，两个部分，保留 998 个部分的计数未修改并避免昂贵的计数操作。

但我认为你极不可能有 1e9 个帖子（我确信 Stackoverflow 没有）。

考虑调查 Stack Overflow 如何管理其标签问题计数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T19:20:14.560

`SELECT distinct section_id, count(section_id) as num_of_posts FROM forum_posts WHERE section_id='$sectionID' group by section_id` 然后做一个 $num_of_rows = $sql1['num_of_posts'];

或者保持您的查询不变，执行`count($sql1)`;

# grails - Grails启动错误：groovy.lang.Closure.rehydrate(Ljava/lang/Object;Ljava/lang/Object;Ljava/lang/Object;)Lgroovy/lang/Closure;

> ID：12465764
> 
> 赞同：1
> 
> 时间：2012-09-17T19:19:03.093
> 
> 标签：grails, ubuntu, tomcat6, elasticsearch

在 Tomcat 6 / Ubuntu 12.04 上启动 Grails 2.1.0 应用程序时出现以下错误。

```
Error 500 - Internal Server Error.

groovy.lang.Closure.rehydrate(Ljava/lang/Object;Ljava/lang/Object;Ljava/lang/Object;)Lgroovy/lang/Closure; 
```

此应用程序`run-app`在 Windows 7 上的 STS 3.0 中运行良好，在 Windows 上也使用 Tomcat6。

我已经`war`手动部署了。

我已经看到部署到 Cloud Foundry 的应用程序报告了类似的问题： [错误 500：在 cloud Foundry 上部署 grails 应用程序时的 Closure.rehydrate](https://stackoverflow.com/questions/11904385/error-500-closure-rehydrate-at-deploying-grails-app-on-cloud-foundry)但没有给我任何线索。

该应用程序以前运行良好。我最近做了一些代码更改，包括安装 ElasticSearch 插件，但日志中的错误是指从`gsps`.

```
INFO: Initializing Spring FrameworkServlet 'grails'
17-Sep-2012 11:34:47 org.apache.catalina.core.ApplicationDispatcher invoke
SEVERE: Servlet.service() for servlet grails threw exception
java.lang.NoSuchMethodError: groovy.lang.Closure.rehydrate(Ljava/lang/Object;Ljava/lang/Object;Ljava/lang/Object;)Lgroovy/lang/Closure;
    at org.codehaus.groovy.grails.web.taglib.GroovyPageTagBody.<init>(GroovyPageTagBody.java:65)
    at org.codehaus.groovy.grails.web.taglib.GroovyPageTagBody.<init>(GroovyPageTagBody.java:49)
    at org.codehaus.groovy.grails.web.pages.GroovyPage.createTagBody(GroovyPage.java:630)
    at org.codehaus.groovy.grails.web.pages.GroovyPage$createTagBody.callCurrent(Unknown Source)
    at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCallCurrent(CallSiteArray.java:44)
    at org.codehaus.groovy.runtime.callsite.AbstractCallSite.callCurrent(AbstractCallSite.java:141)
    at org.codehaus.groovy.runtime.callsite.AbstractCallSite.callCurrent(AbstractCallSite.java:153)
    at gsp_bipboxindex_gsp.run(index.gsp:4) 
```

任何线索非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T03:28:19.467

[Closure.rehydrate](http://groovy.codehaus.org/api/groovy/lang/Closure.html#rehydrate%28java.lang.Object,%20java.lang.Object,%20java.lang.Object%29)是在 Groovy 1.8.5 中引入的。看起来战争中有一个旧版本的groovy。检查您的 war 文件中的 WEB-INF/lib 目录，看看它是否包含重复的旧版本的 groovy。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-19T13:56:12.403

对于遇到此问题的其他人。David 在 9 月 18 日的评论是正确的，有时您的插件会引入一些服务器不支持的旧版本的 Groovy。这是解决此问题所需要做的事情：

在 BuildConfig.groovy 中找到这些条目，并添加一行以排除 groovy。

```
grails.project.dependency.resolution = {
    inherits("global") {
        excludes "groovy" //ADD THIS LINE
} 
```

# optimization - Microsoft Solver Foundation Services 中是否有与 Excel 中的 Solver 匹配的指令？

> ID：12465766
> 
> 赞同：3
> 
> 时间：2012-09-17T19:19:21.637
> 
> 标签：optimization, excel-2010, solver, linear-programming, ms-solver-foundation

我有一个 Excel 工作簿，它使用 Solver 加载项来最大化其中包含平方根的一组方程（例如，它是非线性的）。我正在尝试使用 Microsoft Solver Foundation 在 C# 中重新实现这一点。我尝试了一些不同的指令，但无法找到一个求解器来重现我在 Excel 中得到的结果。

我尝试使用混合本地搜索，但结果完全错误，并且结果最大化并没有接近 excel。如果我使用内点法并删除平方根（从 excel 和 c# 中），我非常接近 excel 优化，但这对我没有用，因为我试图匹配包含正方形的 excel 模型根。

我认为混合本地搜索的问题在于我没有获得全局最大值。我没有找到任何其他支持 NLP 的内置指令。

我认为 Excel Solver 使用 GRG2 算法。有什么方法可以重现 MSF 中 Excel 求解器使用的算法？

作为参考，下面是 MSF 附带的 QP 示例，其中我在注释 '// #######' 之前所做的更改：

```
public string Solve()
        {
            /***************************
            /*Construction of the model*
            /***************************/
            SolverContext context = SolverContext.GetContext();
            //For repeating the solution with other minimum returns
            context.ClearModel();

            //Create an empty model from context
            Model portfolio = context.CreateModel();

            //Create a string set with stock names
            Set setStocks = new Set(Domain.Any, "Stocks");

            /****Decisions*****/

            //Create decisions bound to the set. There will be as many decisions as there are values in the set
            Decision allocations = new Decision(Domain.RealNonnegative, "Allocations", setStocks);
            allocations.SetBinding(StocksHistory, "Allocation", "Stock");
            portfolio.AddDecision(allocations);

            /***Parameters***/

            //Create parameters bound to Covariant matrix
            Parameter pCovariants = new Parameter(Domain.Real, "Covariants", setStocks, setStocks);
            pCovariants.SetBinding(Covariants, "Variance", "StockI", "StockJ");

            //Create parameters bound to mean performance of the stocks over 12 month period
            Parameter pMeans = new Parameter(Domain.Real, "Means", setStocks);
            pMeans.SetBinding(StocksHistory, "Mean", "Stock");

            portfolio.AddParameters(pCovariants, pMeans);

            /***Constraints***/

            //Portion of a stock should be between 0 and 1
            portfolio.AddConstraint("portion", Model.ForEach(setStocks, stock => 0 <= allocations[stock] <= 1));

            //Sum of all allocations should be equal to unity
            portfolio.AddConstraint("SumPortions", Model.Sum(Model.ForEach(setStocks, stock => allocations[stock])) == 1);

            /***Goals***/

            portfolio.AddGoal("Variance", GoalKind.Maximize,
                // ####### Include a inner product of the means and weights  to form utility curve
                Model.Sum
                (
                    Model.ForEach
                        (
                            setStocks, x =>
                                        Model.Product(
                                            allocations[x],
                                            pMeans[x])
                        )
                )
                -
                // ####### Use square root of variance to get volatility instead.  This makes the problem non-linear
                Model.Sqrt(
                    Model.Sum
                    (
                        Model.ForEach
                        (
                            setStocks, stockI =>
                            Model.ForEach
                            (
                                setStocks, stockJ =>
                                Model.Product(pCovariants[stockI, stockJ], allocations[stockI], allocations[stockJ])
                            )
                        )
                    )
                )
             );
            // ####### remove event handler        

            /*******************
            /*Solve the model  *
            /*******************/

            // ####### Use an NLP algorithm directive
            Solution solution = context.Solve(new HybridLocalSearchDirective());

            // ####### remove conditions on propagate
                context.PropagateDecisions();

            // ####### Remove save.  Can't save an NLP Model

            Report report = solution.GetReport();
            return report.ToString();
        } 
```

# powershell - 在返回数组的函数中获取 QADUser

> ID：12465769
> 
> 赞同：0
> 
> 时间：2012-09-17T19:19:42.603
> 
> 标签：powershell, quest

```
function getNTAccounts {
    Add-PSSnapin Quest.ActiveRoles.ADManagement
connect-QADService

    $accounts = @()
   Get-QADUser -CreatedAfter (Get-Date).AddDays(-3) -SerializeValue | Select-Object "samaccountname" | Foreach-Object{ 
        $accounts += $_.samaccountname
   }

   Disconnect-QADService

   return ,$lastaccounts
}

$tmpResult = getNTAccounts 
```

你能告诉我为什么我得到这个：

```
{Quest.ActiveRoles.ArsPowerShellSnapIn.Data.ArsADConnection, Account1 Account2} 
```

我想得到一个简单的数组，但它在数组的第一个元素中包含这个字符串。

提前致谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T19:27:59.677

尝试以下更改：

```
function getNTAccounts {
    Add-PSSnapin Quest.ActiveRoles.ADManagement
connect-QADService | Out-Null

    $accounts = @()
   Get-QADUser -CreatedAfter (Get-Date).AddDays(-3) -SerializeValue | Select-Object "samaccountname" | Foreach-Object{ 
        $accounts += $_.samaccountname
   }

   Disconnect-QADService

   return ,$accounts
}

$tmpResult = getNTAccounts 
```

将 Connect-QADService 设置为 null 可防止您退出的额外条目。请记住，发送到管道的所有内容都将被视为从函数返回。你也有 $lastaccounts 而不是 $accounts，但我怀疑这是在发布问题时无意中完成的。

# sed - 如何使用 awk 或 sed 从文件名中删除字符？

> ID：12465770
> 
> 赞同：2
> 
> 时间：2012-09-17T19:19:47.807
> 
> 标签：sed, awk

我有 1000 多个看起来像这样的文件。

```
kkk1a2o_A.txt
kkk1a73_A.txt
kkk2chj_A.txt 
```

我想更改每个文件的名称如下

```
1a2o.txt
1a73.txt
2chj.txt 
```

如何使用 awk 或 sed 执行此操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T19:25:16.243

`sed`并`awk`操作文件的内容，而不是文件名。您可以`mv`在循环中使用：

```
for file in kkk*.txt ; do
    new=${file#kkk}
    mv "${file}" "${new%_A.txt}.txt"
done 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T19:29:12.850

不需要`sed`or `awk`，只是`bash`参数扩展：

```
for f in *.txt
do
    dest=${f#kkk}
    dest=${dest%_A.txt}.txt
    mv "$f" "$dest"
done 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T20:14:07.607

这可能对您有用（GNU sed）：

```
 printf "%s\n" * | sed 'h;s/kkk\([^_]*\)_A/\1/;H;g;s/^\(.*\)\n/mv -v \1 /e' 
```

# ubuntu - 在 64 位 Ubuntu 中构建 32 位软件包失败

> ID：12465772
> 
> 赞同：1
> 
> 时间：2012-09-17T19:19:55.137
> 
> 标签：ubuntu, packaging, deb

我正在创建一个仅 32 位二进制包，它在 64 位的 Ubuntu 环境中。我已经安装了 ia32-libs，但是当我运行时：

> 解构-ai386 -b

我收到以下错误：

> dh_strip 无法执行“i686-linux-gnu-strip”：/usr/share/perl5/Debian/Debhelper/Dh_Lib.pm 第 215 行没有这样的文件或目录。 dh_strip: i686-linux-gnu-strip --remove -section=.comment --remove-section=.note --strip-unneeded PATH_TO_LIB_IN_PACKAGE

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T20:58:13.437

我找到的唯一解决方案是拥有两个虚拟系统，一个安装 32 位，一个安装 64 位。

# php - 表格排序后更新html表格单元格数据

> ID：12465773
> 
> 赞同：-1
> 
> 时间：2012-09-17T19:19:59.967
> 
> 标签：php, javascript, jquery

我有从 mysql 获取数据的 html 表。每隔 5 秒，我使用 ajax 检查 mysql 表中是否有任何更改并更新特定的 html 表单元格。

现在我想使用这个不错的 jquery 插件： http: [//mitya.co.uk/scripts/Table-sort---now-REGEXP-friendly-111](http://mitya.co.uk/scripts/Table-sort---now-REGEXP-friendly-111)

所以有一个计划： 1\. 加载表 2\. 每 5 秒检查是否有任何单元格需要更新 3\. 运行 jquery 表排序插件。

问题是如何找到我要更新的 html 单元格？排序后所有数据都在表中移动。

我尝试通过以下方式从我的 sql 加载表：

```
while ($row = mysql_fetch_assoc($result))
{
    echo "<tr id='{$row[id]}'> 
```

但是排序插件只移动数据。不是整个 html 行...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T19:26:23.703

你可以使用jquery的empty()函数来清空表格然后重绘所有的行吗？

或者，您可以使用 id 属性来使用表的唯一索引来引用特定行。
前任：`<tr id="row<?=$row->id?>"><td id="name<?=$row->id?>"><?=$row->name?></td><td id="count<?=$row->id?>" ><?=$row->count?></td></tr>`

然后使用 jquery 相应地更新每一行的内容

# jsf - 使用JSF上传文件、图片的附件服务器

> ID：12465775
> 
> 赞同：0
> 
> 时间：2012-09-17T19:20:05.277
> 
> 标签：jsf, file-upload, upload, primefaces, image-uploading

我有一个不同的 Http 服务器（服务器 B）计划用于上传文件，但要弄清楚我需要运行什么以及我应该如何对其进行编程以使其可用于我的主要 Web 应用程序（服务器 A）来上传和下载文件。因此，如果我们转移到集群环境，我们仍然可以指向同一个附件服务器来上传图像/文件等，如果我们每小时上传大量文件，我们就不会烧毁主服务器。所以服务器 B 专门用于通过服务器 A 上传和下载附件。我们的主要应用程序主要建立在 primefaces 和 JSF 之上。我相信如果我们使用纯 html，我们可以在表单中为不同的服务器定义“动作”参数，如何在 JSF 中做同样的事情。到目前为止，我们不想使用第三方 CDN，我们希望找到可以将自己托管在单独服务器中的替代解决方案。

# javascript - 有没有办法在仅带有 JS/HTML 的 AIR 应用程序中使用 Webkit 浏览器？

> ID：12465787
> 
> 赞同：0
> 
> 时间：2012-09-17T19:20:52.970
> 
> 标签：javascript, html, air, webkit, adobe

我想构建一个 AIR 应用程序并嵌入一个 webkit 浏览器，而不使用 flex/flash，只使用 Javascript 和 HTML。可能吗？如果是这样，怎么做？如果不是，为什么不呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T20:14:02.743

AFAIK AIR 包含一个 webkit 实例，因此您绝对可以制作基于 html 的 AIR 应用程序，以下是 Adob​​e 在 Dreamweaver 中的说明：

[http://help.adobe.com/en_US/air/build/WS5b3ccc516d4fbf351e63e3d118666ade46-7f7f.html](http://help.adobe.com/en_US/air/build/WS5b3ccc516d4fbf351e63e3d118666ade46-7f7f.html)

以下是使用 SDK 的方法：

[http://help.adobe.com/en_US/AIR/1.5/devappshtml/WS5b3ccc516d4fbf351e63e3d118666ade46-7ecc.html](http://help.adobe.com/en_US/AIR/1.5/devappshtml/WS5b3ccc516d4fbf351e63e3d118666ade46-7ecc.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T20:17:33.250

是的，这是可能的。无需嵌入 WebKit，因为它已[融入 Adob​​e AIR。](https://en.wikipedia.org/wiki/Adobe_Integrated_Runtime#Application_development)

# javascript - 将 dijit.TitlePane 转换为下拉按钮

> ID：12465788
> 
> 赞同：1
> 
> 时间：2012-09-17T19:21:00.980
> 
> 标签：javascript, html, dojo, arcgis-server

我有一个使用 javascript API 构建的应用程序，并在标题中创建了 3 个标题窗格，这些标题窗格打开以显示信息（底图库、图例、图层）。它完全按照我想要的方式运行，现在我想通过为每个窗格提供自己的图像来使其“看起来很漂亮”，当您单击图像时，它会以相同的方式打开窗格。

但是，我尝试过覆盖 CSS，这会为所有标题窗格提供相同的图像。看起来我需要将标题窗格转换为切换按钮。阅读一些示例，我似乎需要在 html 更改之外添加其他代码。有没有最好的方法来进行这个编辑？

这是创建标题窗格的 html 示例，“basemapGallery” div 是窗格内的信息，我想在其中制作下拉菜单或可以控制图像的任何其他类型的按钮。

```
<div dojoType="dijit.TitlePane" title="Switch Basemap" closable="false" open="false" style="float:right; margin-right:10px;">
                <div dojoType="dijit.layout.ContentPane"  style="width:275px; height:560px; overflow:auto;">
         <div id="basemapGallery"></div>
                </div>
  </div> 
```

标题有一个灰色的矩形框，我想成为一个图像，您在其中单击图像，它会打开按钮内的内容。

**编辑** 最终目标是使按钮具有与标题中的按钮相似的外观：http: [//localgovtemplates2.esri.com/ParkFinder/default.htm](http://localgovtemplates2.esri.com/ParkFinder/default.htm)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T12:23:12.970

我最终通过引用 fx.toggler 的旧帖子找到了一些帮助。像魅力一样工作。现在它只是按照我想要的方式设计它，但基本功能就在那里。

# mysql - MySQL 查询 Where NOT

> ID：12465790
> 
> 赞同：0
> 
> 时间：2012-09-17T19:21:13.990
> 
> 标签：mysql, sql

我将如何创建这样的 MySQL 查询：

```
SELECT * FROM users WHERE ip NOT '66.249.73.202' ORDER BY lastlogin DESC 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T19:22:21.850

试试这个：

```
SELECT * FROM users WHERE ip != '66.249.73.202' ORDER BY lastlogin DESC 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T19:22:27.943

MySQL 101：

```
SELECT * FROM users WHERE ip != '66.249.73.202' ORDER BY lastlogin DESC 
```

# c# - 将模板列的可见性绑定到基础数据

> ID：12465794
> 
> 赞同：0
> 
> 时间：2012-09-17T19:21:24.683
> 
> 标签：c#, wpf, wpf-controls, wpfdatagrid

我试图弄清楚如何将 DataGrid 模板列的可行性绑定到作为数据网格的数据上下文的可观察集合。注意：虽然我是这个东西的初学者，所以你可能需要像对一个 10 岁的孩子一样解释......

我知道这与这个[stackoverflow](https://stackoverflow.com/questions/5341403/wpf-datagridtemplatecolumn-visibility-binding-under-mvvm)有关，但我似乎仍然无法让它去。

我在转换器中有一个断点，但是当将数据添加到可观察集合时它永远不会被击中......

我希望这是有道理的......非常感谢

```
 <DataGrid AutoGenerateColumns="False" AlternatingRowBackground="LightBlue" ItemsSource="{Binding historyColl}" Margin="0,75,6,26" Name="historyDataGrid" FontSize="12" HorizontalAlignment="Right" Width="381">
                    <DataGrid.Columns>
                        <DataGridTemplateColumn Header="Date (dd-mm)" Width="80*">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding Date}" Background="{Binding Converter={StaticResource TradedBackground}}"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>

                        <DataGridTemplateColumn Header="Test" Width="50" Visibility="{Binding RelativeSource={x:Static RelativeSource.Self}, 
                                Path=FrameworkElement.DataContext, Converter={StaticResource booleanToVisiblityConverter}}">
                           <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding Test}"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>

                    </DataGrid.Columns>
                </DataGrid> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T12:40:10.037

我会加入问题下方的讨论，但我没有足够的分数来这样做。我很确定这`Path=FrameworkElement.DataContext`是问题所在。转换器需要一个布尔值，但取而代之的是一个 DataContext。

我希望`bool`DataContext 本身有一个类型的属性，您可以使用转换器将可见性绑定到该属性。

在窗口资源中定义转换器就好了。

# cocoa - NSPopUpButton 未选择正确

> ID：12465796
> 
> 赞同：1
> 
> 时间：2012-09-17T19:21:32.810
> 
> 标签：cocoa, selection, objective-c-2.0, nspopupbutton

我正在使用此代码将弹出按钮添加到`NSView`：

```
if (popupButton) [popupButton release];
popupButton = [[NSPopUpButton alloc] initWithFrame:NSMakeRect(0, 0, SHEET_WIDTH/2, 32) pullsDown:true];
NSMenu *menu = [[NSMenu alloc] init];
for (NSString *title in anArray)
    [menu addItemWithTitle:title action:NULL keyEquivalent:@""];
[popupButton setMenu:menu];
[self addView:popupButton aligned:KOAlignmentCenter]; 
```

当我启动我的应用程序时，按钮没有选择。当用户单击它并选择其中一项时，该按钮保持为空。例如，如果有 3 个可能的选择（item1、item2 和 item3），并且用户单击第二个，而不是显示“item2”，它什么也不显示：

![空选](../Images/a317bb64f3d23cca589252a8bd58df0c.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T16:11:31.687

我不知道为什么您没有显示任何内容，因为当我尝试您的代码时，我确实得到了 anArray 中的第一项显示。但是，从列表中选择一个项目不会改变显示的内容，这是下拉类型按钮的预期行为。来自 Apple 的文档：

> 下拉列表通常显示在弹出按钮旁边，就像子菜单显示在其父项旁边一样。与弹出列表不同，显示下拉列表的弹出按钮的标题不是基于当前选定的项目，因此保持固定，除非您使用单元格的 setTitle: 方法进行更改。

您也不需要任何菜单语句，您可以在循环中使用 NSPopupButton 方法 addItemWithTitle:。因此，请尝试不使用菜单命令，并明确使用 setTitle:，如果您最初仍然没有得到任何显示。或者，你可以改为弹出而不是下拉，那么你就没有设置标题的问题了。

这就是我所做的测试：

```
- (void)applicationDidFinishLaunching:(NSNotification *)aNotification {

    NSArray *anArray = @[@"One",@"Two",@"Three",@"Four"];
    _popupButton = [[NSPopUpButton alloc] initWithFrame:NSMakeRect(100, 200, 200, 32) pullsDown:TRUE];
    for (NSString *title in anArray)
        [_popupButton addItemWithTitle:title];
    [self.window.contentView addSubview:_popupButton];
} 
```

# sql - 一个触发器从两个表中读取

> ID：12465797
> 
> 赞同：0
> 
> 时间：2012-09-17T19:21:34.217
> 
> 标签：sql, oracle, sqlplus

我们可以在一个触发器中使用两个表吗？我有历史表，我需要从两个表中放置数据。

IE。

```
Guest (Guestno, firstname,lastname,address,city, state, zip.....)
Booking (BookingId, Hotelno, Guestno, datefrom, datefrom)
Boogking history (bookingid,guestno, fristname,lastname, address, city, state, zip, hotelno, datefrom, dateto) 
```

所以我想要创建的触发器是，每当在预订表中更新 datefrom 时，它应该更新 booking_history 表中的所有信息（除了 dateto ....如果没有输入 dateto）

我尝试创建以下内容，但它给出了错误，因为在此未提及来宾表，但我不确定该放在哪里

```
CREATE OR REPLACE TRIGGER BOOKING_DATETO_UPDATE
AFTER UPDATE OF DATETO ON BOOKING
FOR EACH ROW
BEGIN 

INSERT INTO BOOKINGHISTORY
(BOOKINGID, GUETNO, FIRSTNAME, LASTNAME, ADDRESS, CITY, STATE, ZIP, HOTELNO, DATETO, DATFROM)

VALUES (:OLD.bookingid,:OLD.guestno, :OLD.FirstName, :OLD.LastName,
:OLD.Address, :OLD.City, :OLD.State, :OLD.Zip, :OLD,Hotelno, :OLD.Dateto, :OLD.Datefrom);

end; 
```

我得到的错误如下。下面是示例，但所有字段都来自 Guest 表（guestno、firstname、lastname、ADDRESS、CITY、STATE）

错误（9,38）：PLS-00049：错误的绑定变量“OLD.FIRSTNAME”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T19:29:27.743

首先请解释触发器何时给出错误和错误的确切文本。正如我所看到的，触发器不正确： 1\. IF UPDATEING - 拼写问题 + 如果触发器声明为 ON UPDATE，我不明白为什么要使用它 2\. 如果您想检查是 :OLD.DATETO 是否已更改只需将其与 :new id 进行比较。3\. IF 之后应该是 THEN

尝试添加这些修复并显示错误文本

BOOKING 表上的触发器可以处理 BOOKING 表中存在的字段。您正在尝试使用不可能的 GUEST 表的旧/新字段。只能在 GUEST 表上的触发器中访问新旧 GUEST。而已。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T19:57:36.930

您的触发器当然可以查询它所定义的表以外的表（尽管将这种逻辑放入触发器中会使您很可能会回来并询问如何在未来解决变异表异常）。

```
CREATE OR REPLACE TRIGGER BOOKING_DATETO_UPDATE
  AFTER UPDATE OF DATETO ON BOOKING
  FOR EACH ROW
DECLARE
  l_guest_rec guest%rowtype;
BEGIN 
  -- If `guestno` can change, you'll need to tell us whether you want to use the old or the 
  -- new `guestno` to look up the appropriate row in the `guest` table.
  SELECT *
    INTO l_guest_rec
    FROM guest
   WHERE guestno = :old.guestno;

  INSERT INTO BOOKINGHISTORY( BOOKINGID, 
                              GUESTNO, 
                              FIRSTNAME, 
                              LASTNAME, 
                              ADDRESS, 
                              CITY, 
                              STATE, 
                              ZIP, 
                              HOTELNO, 
                              DATETO, 
                              DATFROM)
   VALUES (:OLD.bookingid,
           :OLD.guestno, 
           l_guest_rec.FirstName, 
           l_guest_rec.LastName,
           l_guest_rec.Address, 
           l_guest_rec.City, 
           l_guest_rec.State, 
           l_guest_rec.Zip, 
           :OLD,Hotelno, 
           :OLD.Dateto, 
           :OLD.Datefrom);
end; 
```

# javascript - 在 Wordpress 主题中调整滑块图像的大小

> ID：12465799
> 
> 赞同：0
> 
> 时间：2012-09-17T19:21:44.187
> 
> 标签：javascript, wordpress

有人可以通过检查这个 wordpress 主题的源代码来告诉我滑块图像是否可以调整大小吗？

[http://pixelthemes.net/?theme=immersion](http://pixelthemes.net/?theme=immersion)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T19:40:05.230

当然这是可能的。您可以使用以下脚本使其可调整大小：

[https://github.com/filamentgroup/Responsive-Images](https://github.com/filamentgroup/Responsive-Images)

# jquery - JQuery $get 或 $getJSON 似乎不起作用？

> ID：12465805
> 
> 赞同：0
> 
> 时间：2012-09-17T19:22:14.983
> 
> 标签：jquery

我尝试使用以下代码发出 HTTP GET 请求以从服务器获取一些数据。看起来，HTTP 请求根本没有到达服务器。我在这里错过了什么吗？

我也试过`$.get(url, function(data){alert(data);}, "json").error(onHttpError)`了。但没有运气。

```
$(document).ready(function()
{
     $.getJSON(url, onHttpSuccess).error(onHttpError);

    /**
    *onHttpSuccess
    */
    function onHttpSuccess( response )
    {

        alert("ASG Data Received:" + response);
    }

    /**
    *onHttpError
    */
    function onHttpError() 
    {
        var     errorMsg        = "HTTP Error!!!";

        $('#message').html(errorMsg);

        alert(errorMsg);
    }
}); 
```

请高手帮忙。谢谢！

丹麦

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T20:10:18.983

不确定这是否是答案，但我遇到过很多 AJAX 调用工作正常的情况，但是从服务器返回的 JSON 没有被 jQuery 解析，因此整个操作似乎失败了。

通常原因是服务器没有指定响应的内容类型，但无论是什么原因，下一个故障排除步骤都是执行 $.get 请求而不指定“json”作为返回类型。尝试将“文本”指定为返回类型，并查看是否从服务器获得响应。

有时我什至幸运地接收到纯文本形式的服务器响应，然后在成功函数中手动运行 JSON.parse()。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T14:18:59.793

是的。URL 已在此代码之前定义，它是一个有效的 URL。我的意思是，当我直接在浏览器中使用 url 并按回车键时，我看到，服务器接收到请求并发出响应。

# haskell - 如何处理将函数应用于不正确的值？

> ID：12465807
> 
> 赞同：2
> 
> 时间：2012-09-17T19:22:16.827
> 
> 标签：haskell

如果我有数据并且我不确定这是整数还是字符串，但我想对它应用 (+1)，如果它是一个很好的整数，但如果它是一个字符串 - 什么都不做，我将如何处理这？这是`Nothing`进来的地方吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-17T19:29:38.783

好吧，Haskell 函数是强类型的，这意味着它们指定了输入和输出的类型。为了首先接受多个类型的值，您需要使用`Either`将它们保存在同一类型中。因此，例如，如果您想接收 a`String`或 an `Integer`，那么您的函数必须具有类型：

```
f :: Either String Integer -> ... 
```

然后，您编写函数的方式是在 上进行模式匹配`Either`以查看您收到的值类型。你会写这样的东西：

```
-- str is a String
f (Left  str) -> ... 
-- int is an Integer
f (Right int) -> ... 
```

所以，做你想做的最简单的方法是只增加数字，如果它是一个`Integer`，但`String`保持不变。你会这样写：

```
-- Don't do anything if it is a string
f (Left  str) = Left  str
-- Increment it if it is an integer
f (Right int) = Right (int + 1) 
```

如果您要求编译器推断上述函数的类型，您将得到：

```
f :: Either String Int -> Either String Int 
```

Haskell 有一个很好的技巧来避免上面的样板，这是`fmap`从`Functor`类中使用的。这让我们可以自动在`Right`一半上编写函数，`Either`而完全忽略一半中的任何内容`Left`，如下所示：

```
f = fmap (+1) 
```

如果我们推断上述函数的类型，它实际上是：

```
f :: (Functor f, Num a) => f a -> f a 
```

但在我们的例子中，我们可以通过设置`a`to`Integer`和`f`to来专门化类型`Either String`：

```
f :: Either String Int -> Either String Int 
```

换句话说，`Either String`是一个类的实例的一个例子`Functor`，其中有很多。

但是，请注意，为了在整数或字符串上使用此函数，您必须首先将它们包装在`Left`或`Right`构造函数中。例如，这些不会进行类型检查：

```
f 1   -- WRONG!
f "a" -- WRONG! 
```

但这些将：

```
f (Right  1) -- Correct!
f (Left "a") -- Correct! 
```

这意味着，如果你有一个整数列表和一个字符串，你将不得不这样写：

```
list = [Right 1, Left "a", Right 2] 
```

请注意，如果您尝试在列表中混合整数和字符串，则会收到类型错误：

```
list = [1, "a", 2] -- WRONG! 
```

然后我们可以映射`f`第一个正确`list`的得到：

```
map f list = [Right 2, Left "a", Right 3] 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-17T20:56:42.400

# 我们不想混合类型Willy-Nilly

你说

> 所以说我有一个列表，但这个列表可能是 ["a"] 或者它可能是 [1]，如果我想在不知道列表中确切类型的情况下应用一些函数，

Haskell 不允许您制作这样的列表——列表中的所有元素都必须具有相同的类型。你可以有`[1,2,3]`or `["a","cheese","4"]`，但没有`["a",1]`。Haskell 将确保只应用适用于列表中元素的函数。Haskell 和您将始终能够计算出列表中元素的类型。这种类型知识被称为静态类型，乍一看似乎没有必要死板，但实际上它确实非常灵活。黄金法则是：编译器一直都知道你有什么数据。

> 我该如何处理类型问题？

**你不会遇到这样的类型问题！**这就是静态类型的乐趣——在数据类型或数据类型之间转换时出错的程序*不会编译*——你会在代码运行之前发现错误！

也许你有一个可能混合字符串和数字的数据流。您需要问的*第一个*问题是“我想用它们做什么，我*真的*需要将它们混合在一起吗？”。有没有更好的方法将它们分开？例如，在 Haskell 中，编写功能齐全的静态类型解析器非常容易（如果需要，请查找 parsec）。

* * *

# 新：忽略非整数

（在重新阅读您的问题标题时，也许这就是您所追求的。）

忽略非整数很容易。就像你提到的，你可以使用`Nothing`和它的对应物`Just`，像这样

```
myData = ["nan","45","3454.5","that's not an int, it's a float!","4","6"]

maybeInts :: [String] -> [Maybe Integer] -- type signature needed so Haskell knows you want Integers
maybeInts = map maybeRead 
```

它使用一个方便的函数`maybeRead`来转换每个值，但你需要`import Network.CGI.Protocol (maybeRead)`或者因为它无权不 in `Data.Maybe`，所以复制并粘贴代码：

```
maybeRead :: Read a => String -> Maybe a
maybeRead = fmap fst . listToMaybe . reads 
  -- take all parses, grab the first one, ignore the remaining text 
```

您将获得的价值`maybeInts myData`将是

```
[Nothing, Just 45, Nothing, Nothing, Just 4, Just 6] 
```

但也许你不想要所有这些`Nothing`/`Just`绒毛，而宁愿只得到整数。如果你[hoogle](http://www.haskell.org/hoogle/?hoogle=%5bMaybe+a%5d+-%3E+%5ba%5d)为`[Maybe a] -> [a]`你会`catMaybes`从`Data.Maybe`模块中找到，那么让我们`import Data.Maybe`定义

```
intsOnly :: [String] -> [Int]
intsOnly = catMaybes.map maybeRead  -- read them, ignore Nothings and unwrap Justs 
```

所以当`intsOnly myData`你得到

```
[45,4,6] 
```

然后如果你想给它们都加一个，你可以做

```
map (+1) (intsOnly myData) 
```

这是

```
[46,5,7] 
```

按要求。

# 有条不紊地混合类型

如果你必须混合整数和字符串，你可以这样做

```
[Left 5, Right "a", Right "hello", Left 6] 
```

这是一个`Int`egers 或`String`s 的列表，所以 type `Either Int String`，但也许你想混合的不仅仅是数字和文本，也许你想要一个整数、一个字符串、一个时间或一个字符串列表。你可以自己滚动：

```
data MyStuff = MyInt Int | MyString String | MyDate DateTime | MyList FilePath [String] 
  deriving Show 
```

可以在一个列表中，例如

```
mystuff = [MyInt 6,  MyString "Hello",  MyString "MyString isn't a great name", 
    MyList "C:/temp/stuff.txt" ["yeah","give","them","problem-specific", "names"], 
    MyInt 12,  MyString "instead"] 
```

（注意 Haskell 区分大小写；`MyStuff`是一种类型，`MyString`是一种类型构造函数（一种将数据包装成类型的函数）并且`mystuff`是一个变量。所有变量都是常量！）

您的数据最终将如何像这样包装在`My___`标签中？好吧，也许它从文件中的整个文本负载或从网络连接或其他东西开始，然后您的解析器将其拆分为整数、字符串、日期和字符串列表，并在执行过程中对其进行标记（很容易做到）。

...并且您可以通过编写一个根据获取的数据定义不同的函数来将它们分开：

```
report :: MyStuff -> IO ()
report (MyInt n) = mapM_ print [1..n]   -- turn the numbers 1..n into print commands, then combine them
report (MyString xs) = print xs         -- just print the string.
report (MyList filename contents) 
    = writeFile filename (unlines contents) -- write them on seperate lines in the file
report _ = return ()                    -- if it's anything else, ignore it and do nothing. 
```

现在，如果您愿意，您可以这样做

```
mapM_ report mylist 
```

它会打印一些数字，几个字符串，保存文件，打印更多数字，最后打印一个字符串。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T19:29:18.547

如果您的值可能是两种类型之一，则可以使用该`Either`值的类型。`Either`将另外两种类型作为参数，因此type或 type`Either a b`的 value 也是如此。这两种情况由两个不同的构造函数标识，分别表示左 ( ) 或右 ( ) 类型。在您的情况下，您将使用. 要操作值，您可以使用模式匹配。例如，`a``b``Left``Right``a``b``Either String Integer`

```
foo :: Either String Int -> Either String Int
foo (Left s) = Left s
foo (Right n) = Right (n+1) 
```

实现您在问题中询问的转换。

# jquery - 点击事件仅在刷新后触发

> ID：12465809
> 
> 赞同：0
> 
> 时间：2012-09-17T19:22:19.847
> 
> 标签：jquery, jquery-mobile

正如标题所说：

我有一个带有几个按钮和 jquery 脚本的页面，如下所示：

```
 $( document ).bind( 'mobileinit', function(){
  $.mobile.loader.prototype.options.text = "loading";
  $.mobile.loader.prototype.options.textVisible = false;
  $.mobile.loader.prototype.options.theme = "a";
  $.mobile.loader.prototype.options.html = "";
});

$(document).bind('pagecreate', function(event){
// New model form submittion

     $('#new-model-submit').click(function(){
          // do
     });

     // Compatibility

     // Switch brands
     $('#brands').change(function(){
         // do something
     });

     // Add model to compatibility
     $('input[type=checkbox]').live("change", function(){
         // do something

     });

     // Specificaties
     $("#add-product-spec").click(function(){
         // do something
     });

     $("#save-product-specs").click(function(){
         // Do something
     });

     // Foto's
     $("#add-product-foto").click(function(){
        // Do something
     });

     $("#save-product-fotos").click(function(){
        // Do something
     });

}); 
```

问题是这些事件在页面首次加载时不会被触发。但是，当我按下`F5`并刷新页面时，按钮确实起作用。为什么是这样？有没有人有办法解决吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T19:29:15.950

JQuery Mobile 的工作方式略有不同。如果链接将您定向到同一域上的页面，则 JQuery mobile 将拦截该事件，并改为发出 ajax 请求，然后将其插入 DOM。解决此问题的一种方法是`live`用于您的点击事件。IE

```
// Specificaties
$("#add-product-spec").live("click", function(){
 // do something 
}); 
```

这将告诉浏览器留意任何匹配“#add-product-spec”选择器的“click”事件，无论它何时插入 DOM。

*编辑*

您可以尝试的另一件事是使用`PageShow`而不是`PageCreate`. `PageCreate`如果我没记错的话，JQuery mobile 的事件只会在您第一次加载页面时触发。

# php - 如何从此数组树中获取子数组的键

> ID：12465812
> 
> 赞同：-1
> 
> 时间：2012-09-17T19:22:21.580
> 
> 标签：php

如何从此嵌套数组中获取键 151,152 并将它们存储为单独的数组

```
Array  
   (  
    [151] => Array  
        ( 
            [152] => Array  
                (  
                )  

        )  

   ) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T19:31:20.777

```
function recursive_keys($input){ 
    $output = array_keys($input);
    foreach($input as $val){
        if (is_array($val)){
            $output = array_merge($output, recursive_keys($val));
        }
    }
    return $output;
} 
```

递归扩展它可以处理的数组的深度。

链接：[array_merge](http://php.net/manual/es/function.array-merge.php)，[array_keys](http://php.net/manual/en/function.array-keys.php)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T19:26:41.653

```
$newArray = array();
foreach($array as $key => $val){
    $newArray[] = $key;
    foreach($val as $key2 => $val2){
        $newArray[] = $key2;
    }
} 
```

# ruby-on-rails - 为现有应用程序将 Sqlite3 切换到 PostgreSQL

> ID：12465817
> 
> 赞同：2
> 
> 时间：2012-09-17T19:22:34.340
> 
> 标签：ruby-on-rails, postgresql, heroku, sqlite

我正在尝试将开发（和测试/生产）数据库切换到 PostgreSQL，以便我可以将我的 rails 应用程序部署到 Heroku。

按照他们的指示和 railscast 并在 StackOverflow 和 Google 周围寻找重写我的 database.yml 文件并做其他所有事情的正确方法，但我遇到了很多问题，所以我希望有人能帮我弄清楚我还需要做什么。我将在下面解释我尝试过的内容。

一个主要问题是如何处理我的 database.yml 文件。许多站点不同意，或者根本没有任何池或用户名或编码条目（或者，就此而言，整个生产环境）。这是我环顾四周并结合后得到的结果。这应该工作吗？：

```
development:
  adapter: postgresql
  encoding: unicode
  database: <appname>_development
  pool: 5
  username: <username>
  password: <password>

test:
  adapter: postgresql
  database: <appname>_test
  username: <username>
  password: <password>
  host: localhost 
```

什么是池？我需要编码吗？为什么这么多示例在 yml 文件中没有生产部分？

根据 Railscast 的建议，我自制安装了 PostgreSQL，然后初始化了数据库，然后执行了这一行。

```
pg_ctl -D /usr/local/var/postgres -l /usr/local/var/postgres/server.log start 
```

在另一个 StackOverflow 回答之后，我确保我的 Postgres 位于 /usr/local/bin/postgres 目录中，并将这一行添加到我的 .bash_profile 文件中。

```
export PATH="/Applications/Postgres.app/Contents/MacOS/bin:$PATH" 
```

同样根据 Railscast 的建议，我安装了 taps gem，并执行了以下几行：

```
taps server sqlite://db.development.sqlite3 <username> <password> 
```

然后打开一个新选项卡并执行：

```
taps pull postgresql://<username>@localhost/<appname>_development http://localhost//5000 
```

但是当我输入时，我收到以下错误：

```
Failed to connect to database:
  Sequel::AdapterNotFound -> LoadError: cannot load such file -- sequel/adapters/postgresql 
```

当然我做错了。（例如，我应该从 sqlite3 数据库中提取吗？我怎么知道它的 url？）。但我不知道如何开始故障排除，所以我想我会寻求帮助。

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-17T19:42:45.543

## Heroku，以及“database.yml”文件的“生产”部分

Heroku 将忽略您的`database.yml`文件对生产的任何内容。`production`Heroku 将自动为 Bamboo 和 Cedar 堆栈注入自己的配置。换一种说法 -`production`留空 - 部署到 Bamboo 或 Cedar 堆栈时不需要它。

另一方面，如果您要部署到 Amazon Web Services，但使用Heroku[托管的 Postgres 解决方案](https://postgres.heroku.com/)作为您的后端数据库（它本身运行在 AWS 之上），您**需要**`production`在`database.yml`.

## “水龙头”宝石

这似乎是一个允许您将数据从现有数据库（SQLite，为您）迁移到新数据库（PostgreSQL，我希望您从现在开始用于本地开发）的 gem。我没有读太多，但我猜它`taps`使用 ActiveRecord（或其他 ORM 解决方案）从它支持的任何数据库中读取记录，然后使用 ActiveRecord 将数据写回目标数据库。通过使用 ActiveRecord 作为一种数据库间翻译器，您无需编写特定于数据库的查询来移动数据。

**话虽如此，**如果您的本地数据库只是开发数据，并假设它可以重新创建（应该是 - 它只是开发数据），那么您可能可以`taps`完全放弃使用。简单地**不要**将您的开发数据从 SQLite 迁移到 Postgres - 只需停止使用 SQLite 并开始使用带有空数据库的 Postgres，并且所有迁移都已运行，或者`db:schema:load`在其上运行。

[可以通过Populator](http://railscasts.com/episodes/126-populating-a-database)创建易于随心所欲地重新创建的出色开发数据（为了您未来的需求 - 我现在不会太担心）。

## “无法连接到数据库：”错误

你安装[了`pg`gem](http://rubygems.org/gems/pg)吗？那是您在 Rails 中与 PostgreSQL 服务器通信所需的宝石。我对该错误的解释表明您只是缺少`pg`宝石，因此，“Sequel::AdapterNotFound”

## 游泳池

池是您希望从您的应用程序向数据库提供的并发连接数。使用 SQLite，您可以指定它以允许一定数量的并发读取。SQLite [（与其文档所暗示的相反）不支持并发写入](https://stackoverflow.com/questions/5732815/how-to-debug-locked-sqlite3-database)。

当您的应用程序由多个 Web 实例提供服务时，该池在生产环境中很有用。池指定与数据库的最大并发连接数，通常您的 Web 服务器将使用一个连接，每个活动请求，每个线程，或大约。我在这里捏造了技术细节，但关键是您需要支持的并发性（同时请求越多），您*可能*需要的可用连接就越多。

如前所述，无论如何，这在 Heroku 上都会被忽略，因此指定它是没有意义的，并且在本地开发中，您可能一次只会发出一个请求，因此将其设置为`1`可能看起来与将其设置为`5`.

那么，当池中的所有连接当前都在使用时会发生什么？任何后续请求都会排队，直到连接可用或连接超时，以先到者为准。

[这里](http://api.rubyonrails.org/classes/ActiveRecord/ConnectionAdapters/ConnectionPool.html)有更多关于连接池的信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-18T16:24:22.777

Taps 使用 Sequel，而 Sequel 使用`postgres://...`而不是`postgresql://...`用于连接字符串。试试：`taps pull postgres://<username>@localhost/<appname>_development http://localhost//5000`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T19:33:18.607

我最近这样做了，我的 database.yml 只使用：

```
development:
  adapter: postgresql
  username: my_user
  database: my_project_development 
```

如果你在 Heroku 上的 Postgres 数据库中有数据，你可以做一个`heroku db:pull`填充你的 Postgres 开发数据库。否则，您可能会将*您* `db:push`的 Sqlite 数据（来自您的机器，使用旧的 database.yml 配置）传输到 Heroku，更新您的 database.yml，然后执行`db:pull`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-18T12:12:18.290

这通常是我用于 postgres 的：

```
production:
  adapter: postgresql
  encoding: utf8
  database: app_name
  pool: 5
  host: localhost
  username: username
  password: password 
```

另外，请记住 yaml 可能会很糟糕，因此请务必避免使用制表符并在格式中仅使用空格。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-06-27T17:54:47.683

# 10 分钟将您的 RoR 应用程序从 SQLite 迁移到 Postgres

这是假设您在 sqlite 中有一个开发数据库，​​并且您希望将结构和数据移动到 postgres。

*您需要先使用具有您的用户名的用户在本地安装和配置 Postgres，[这里是 postgres 安装文档](https://wiki.postgresql.org/wiki/Detailed_installation_guides)*

* * *

**所需软件：postgresql、pgloader**

* * *

### 脚步

1.  安装 pgloader / postgres，并确保你的系统上正在运行 postgresql
2.  备份 sqlite - 将 development.sql 复制到 development_old.sql
3.  添加`gem 'pg'`到 Gemfile 的主要部分
4.  捆绑安装
5.  更新 config/database.yml（参见下面的示例）
6.  耙分贝：设置
7.  cd [应用程序根目录]
8.  使用来自 sqlite 的数据加载 postgres db

`pgloader ./db/development.sqlite3 postgresql:///[name of postgres dev db]`

9.  `gem 'sqlite3'`从您的 gemfile中删除
10.  捆绑安装
11.  启动服务器 -`rails server`
12.  [通过在 localhost:3000 访问应用程序进行测试](http://localhost:3000)

* * *

如果您遇到问题或边缘情况，这里有一些资源可以提供帮助。

### 资源：

*   [https://pgloader.io](https://pgloader.io)
*   [postgres 安装文档](https://wiki.postgresql.org/wiki/Detailed_installation_guides)
*   [也想搬到heroku吗？](https://stackoverflow.com/questions/51068610/how-do-i-move-my-existing-rails-app-onto-heroku-sqlite-to-postgres/51068611#51068611)

**database_sample.yml**

```
default: &default
  adapter: postgresql
  encoding: unicode
  host: localhost
  port: 5432
  # For details on connection pooling, see Rails configuration guide
  # http://guides.rubyonrails.org/configuring.html#database-pooling
  pool: <%= ENV.fetch("RAILS_MAX_THREADS") { 5 } %>
  timeout: 5000

development:
  <<: *default
  database: [name of app]_dev

test:
  <<: *default
  database: [name of app]_test

staging:
  <<: *default
  database: [name of app]

production:
  <<: *default
  database: [name of app] 
```

# powershell - Powershell - 比较两个数组返回错误结果

> ID：12465819
> 
> 赞同：4
> 
> 时间：2012-09-17T19:22:36.973
> 
> 标签：powershell, powershell-2.0

我希望有人能够帮助解决我在比较数组时遇到的问题。

这里有一些背景。我有一个 powershell 脚本，它生成域控制器列表，检查它们是否在线，然后将数据写入 csv 文件。这工作正常。

我想每周运行一次，并在添加或删除任何域控制器时发送警报。

我有另一个脚本将先前生成的 CSV 导入到一个数组中，然后我生成一个新的域控制器列表并将该列表发送到一个新数组。我正在尝试使用 compare-object 比较两者，并导出一个带有差异列表的新 CSV。

但是，我通过手动修改旧的 CSV 对此进行测试，我发现无论我从上一个列表中删除哪个域控制器或添加新域控制器，它总是报告更改是最后一个域控制器在名单上。

例如，这是我的 CSV 文件的样子：

```
"DC_Name","Ping_Response"
"dc1.testcompany.com","online"
"dc2.testcompany.com","online"
"dc3.testcompany.com","online"
"dc4.testcompany.com","online" 
```

如果我通过删除 "dc3.testcompany.com","online" 并再次运行脚本来测试它，它知道列表已更改，但它报告新条目是 "dc4.testcompany.com","online"而不是“dc3.testcompany.com”、“在线”。

同样，如果我将旧 csv 修改为如下所示：

```
"DC_Name","Ping_Response"
"dc1.testcompany.com","online"
"dc2.testcompany.com","online"
"dc5.testcompany.com","online"
"dc3.testcompany.com","online"
"dc4.testcompany.com","online" 
```

它将报告与新列表不同的是“dc4.testcompany.com”、“online”，而不是我在中间添加的那个。

我的比较一定是做错了什么。这是我正在使用的脚本的相关部分：

```
$newDCArray = @(Import-CSV DC_List.csv)

$oldDCArray = @(Import-CSV Last_DC_List.csv)

$diff = Compare-Object $oldDCArray $newDCArray

if($diff -eq $null)
    {
    Write-Host "No changes to DCs"
    }
else    
    {
    Write-Host "There have been changes to DCs"
    $diff| Export-CSV DC_Change_List.csv -notypeinformation
    Send-MailMessage –From "xxxx@xxxxxxxx.com" –To "xxxx@xxxxxxxx.com" –Subject "Alert - Domain Controllers Added or Removed" –Body "DC Report Attached" –SmtpServer "smtp.xxxxxxxxxxx.net" -Attachments "DC_Change_List.csv"
    } 
```

如果有人有任何想法，请告诉我！

谢谢！约翰

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T19:53:31.003

返回的对象`Import-Csv`不是您应该与之进行比较的“真实”对象。它们是动态生成的自定义对象。您会注意到，如果您对 进行显式检查`$newDCArray[0] -eq $oldDCArray[0]`，它将返回`$false`。由于根本不存在检查平等的适当管道，`Compare-Object`因此没有希望正常工作。

不过没关系。 `Compare-Object`有一个`-Property`参数允许您查看给定对象的 1 个或多个特定属性。属性*是*真实的对象（字符串），所以比较有效。在您的情况下，您对 2 个属性感兴趣 -`DC_Name`并且`Ping_Response`，因为您想知道服务器是否是新的/已删除的，以及已知服务器是否已离线。

这应该适合你：

```
Compare-Object $oldDCArray $newDCArray -Property 'DC_Name','Ping_Response' 
```

此外，请确保它`-SyncWindow`足够大，以便比较准确。或者有时在比较之前简单地对数组进行排序是最简单的，这样您就不必担心这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-08T15:18:39.127

这是自动确定属性的已接受答案的版本：

```
$newDCArray = Import-CSV DC_List.csv
$oldDCArray = Import-CSV Last_DC_List.csv

$propNew = ($newDCArray | Get-Member | ?{$_.MemberType -eq "NoteProperty" | Select -expand Name})
$propOld = ($oldDCArray | Get-Member | ?{$_.MemberType -eq "NoteProperty" | Select -expand Name})
$prop = ($propNew + $propOld) | Get-Unique

$diff = Compare-Object $oldDCArray $newDCArray -Property $prop 
```

请注意，`Get-Unique`执行不同联合的东西仅在 csv-File 的列不同时才相关。否则，您可以使用任一对象的属性。

# css - div：高度为封闭 div 的 100%

> ID：12465821
> 
> 赞同：0
> 
> 时间：2012-09-17T19:22:37.610
> 
> 标签：css

我正在尝试使侧边栏扩展以适合容器的高度。我错过了什么？
​</p>

```
.container {
    border: 1px solid red;
    overflow:hidden;
}

.sidebar {
    border: 1px solid blue;
    width: 50px;
    float: left;
    min-height: 10px;
    height: 100%;
}

.column {
    border: 1px solid black;
    width: 100px;
    height: 200px;
    float: left;
}​ 
```

小提琴：[链接](http://jsfiddle.net/andrewtomici/8vPYc/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T19:24:30.280

```
.container {
    border: 1px solid red;
    overflow:hidden;
    position:relative;
}

.sidebar {
    border: 1px solid blue;
    width: 50px;
    min-height: 10px;
    position:absolute;
    top:0;
    bottom: 0;
}

.column {
    border: 1px solid black;
    width: 100px;
    height: 200px;
    margin-left: 50px;
}​ 
```

使容器位置相对，以便您可以将侧边栏绝对定位在其中。然后将侧边栏的顶部和底部位置设置为 0，使其拉伸整个高度。您还必须将列 div 从左侧推出侧边栏的宽度。

[演示](http://jsfiddle.net/8vPYc/3/)

# jquery - jquery UI datepicker，是否有可能使某些日期无法选择？

> ID：12465823
> 
> 赞同：3
> 
> 时间：2012-09-17T19:22:54.917
> 
> 标签：jquery, datetime, widget

我的客户想要一个程序，该程序将使用日期选择器，该程序将某些日期不可点击、禁用或灰显，因为它们已满或不适用于她的工作时间。

有没有办法在给定日期数组的情况下提醒用户该选项是机器人可行的或将其屏蔽/灰显，因此不能将其选为日期？我更喜欢后一种选择。

我正在查看 Jquery UI 命运选择器工具来尝试解决这个问题。

链接：http: [//jqueryui.com/demos/datepicker/](http://jqueryui.com/demos/datepicker/)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T19:25:06.460

大卫沃尔什前段时间发布了这件事......

[http://davidwalsh.name/jquery-datepicker-disable-days](http://davidwalsh.name/jquery-datepicker-disable-days)

您需要使用“beforeShowDay”事件

# mysql - 如何从具有不同行的mysql中的表中获取最小最大值和平均值？

> ID：12465825
> 
> 赞同：1
> 
> 时间：2012-09-17T19:22:54.667
> 
> 标签：mysql

我有一张表，下面给出了记录。我想要的是单选查询，它按 mediaid 显示第一条记录最小值第二条记录平均值和第三条记录最大值组？

```
trans_id      playtime       mediaid(F.K.) 
--------      --------       -------------
1              32             2
2              65             2
3              45             3
4              55             4
5              60             3
6              78             2
7              45             4
8              35             3 
```

结果应该看起来像

```
 playtime       mediaid(F.K.) 
   --------       -------------
    32             2             (Min value)
    58.33          2             (avg value)
    78             2             (Max value)
    35             3             (Min value)
    46.66          3             (avg value)
    60             3             (Max value)
    45             4             (Min value)
    50             4             (avg value)
    55             4             (max value) 
```

这是我给出结果的真实查询，但这不是由 medtitle 安排的

```
select  t.medTitle as 'Media',
    min(TIMESTAMPDIFF(SECOND,s.dmtViewStart,s.dmtViewEnd))platime
        from dbedetailing.tblmedia t
        left outer join dbedetailing.tbldoctormediatracktest s on s.dmtMedId = t.medId 
        GROUP BY t.medTitle
        union all
        select  t.medTitle as 'Media',
    avg(TIMESTAMPDIFF(SECOND,s.dmtViewStart,s.dmtViewEnd))platime
        from dbedetailing.tblmedia t
        left outer join dbedetailing.tbldoctormediatracktest s on s.dmtMedId = t.medId 
        GROUP BY t.medTitle
        union all
        select  t.medTitle as 'Media',
    max(TIMESTAMPDIFF(SECOND,s.dmtViewStart,s.dmtViewEnd))platime
        from dbedetailing.tblmedia t
        left outer join dbedetailing.tbldoctormediatracktest s on s.dmtMedId = t.medId 
        GROUP BY t.medTitle ; 
```

这是我给出结果的真实查询，但这不是由 medtitle 安排的

===数据库详细信息

== 表 tbldoctormediatracktest 的表结构

```
|------
|Column|Type|Null|Default
|------

    |//**dmtId**//|int(10)|No|
    |dmtDocId|int(10)|No|
    |dmtMedId|int(10)|No|
    |dmtViewingDate|datetime|No|
    |dmtViewStart|datetime|Yes|NULL
    |dmtViewEnd|datetime|Yes|NULL
    |dmaIsActive|enum('0', '1')|No|
    |insDate|datetime|No|
    |modDate|datetime|No|
    == Dumping data for table tbldoctormediatracktest
  Medid    dmtViewStart         dmtViewEnd
    |56|2012-08-24 11:41:14|2012-08-24 11:41:20
    |52|2012-08-24 11:41:24|2012-08-24 11:42:12
    |56|2012-08-24 11:41:14|2012-08-24 11:41:20
    |52|2012-08-24 11:41:24|2012-08-24 11:42:00
    |53|2012-08-25 12:32:27|2012-08-25 12:32:42
    |55|2012-08-27 06:48:51|2012-08-27 06:49:19
    |53|2012-08-27 06:49:25|2012-08-27 06:49:42
    |53|2012-08-28 02:56:16|2012-08-28 02:56:47
    |54|2012-08-28 02:57:58|2012-08-28 02:58:10
    |52|2012-08-28 05:48:14|2012-08-28 05:49:03
    |55|2012-08-28 07:16:00|2012-08-28 07:17:11
    |52|2012-08-22 04:03:00|2012-08-22 04:03:55
    |56|2012-08-28 07:16:00|2012-08-28 07:17:22
    |56|2012-08-23 09:00:00|2012-08-23 09:02:00
    |53|2012-08-16 04:00:00|2012-08-16 04:01:01
    |54|2012-08-20 12:33:00|2012-08-20 12:34:14
    |55|2012-08-16 04:00:20|2012-08-16 04:01:01
    |52|2012-08-20 12:31:00|2012-08-20 12:31:14
    |54|2012-08-20 12:33:14|2012-08-20 12:34:14
    |55|2012-08-20 12:48:00|2012-08-20 12:49:14
    |56|2012-08-20 12:33:00|2012-08-20 12:34:14
    |53|2012-08-20 12:43:00|2012-08-20 12:44:14
    |54|2012-08-20 12:33:00|2012-08-20 12:34:45
    |55|2012-08-20 12:33:00|2012-08-20 12:34:34
    |56|2012-08-20 12:33:00|2012-08-20 12:34:23
    |52|2012-08-20 12:33:00|2012-08-20 12:34:18
    |53|2012-08-20 12:33:00|2012-08-20 12:34:56
    |54|2012-08-20 12:33:00|2012-08-20 12:33:56
    |56|2012-08-20 12:33:00|2012-08-20 12:33:14
    |56|2012-08-20 12:33:00|2012-08-20 12:34:14

===Database dbedetailing

== Table structure for table tblmedia

|------
|Column|Type|Null|Default
|------
|//**medId**//|int(10)|No|
|medTitle|varchar(250)|No|
|medDesc|varchar(250)|No|
|medPath|varchar(250)|No|
|medType|int(10)|No|
|medSpeciality|int(10)|No|
|medProduct|int(10)|No|
|medIsActive|enum('0', '1')|No|
|insDate|datetime|No|
|modDate|datetime|No|
== Dumping data for table tblmedia 
```

===数据库详细信息

```
== Dumping data for table tblmedia

|51|Tplanin
|52|Casfung
|53|Knee Surgery
|54|Doriglen
|55|Colymonas
|56|inem
|57|Casfungtest 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-17T19:29:32.290

如果您想要单行中的值，您可以这样做：

```
select max(playtime), min(playtime), avg(playtime)
from yourtable
group by mediaid; 
```

如果您希望它们在单独的行中，请使用`UNION ALL`：

```
select max(playtime) playtime, mediaid, 'Max' Type
from yourtable
group by mediaid
union all
select min(playtime) playtime, mediaid, 'Min'
from yourtable
group by mediaid
union all
select avg(playtime) playtime, mediaid, 'Avg'
from yourtable
group by mediaid
order by mediaid, playtime; 
```

# 见[SQL Fiddle with Demo](http://sqlfiddle.com/#!2/27a4b/8)

编辑 #1，使用添加的示例数据：

```
select m.medTitle, 
  min(TIMESTAMPDIFF(SECOND, s.dmtViewStart, s.dmtViewEnd)) playtime
from tbldoctormediatracktest s
left join tblmedia m
  on s.MedId = m.MedId
group by m.medTitle
union all

select m.medTitle, 
  avg(TIMESTAMPDIFF(SECOND, s.dmtViewStart, s.dmtViewEnd)) playtime
from tbldoctormediatracktest s
left join tblmedia m
  on s.MedId = m.MedId
group by m.medTitle
union all

select m.medTitle, 
  max(TIMESTAMPDIFF(SECOND, s.dmtViewStart, s.dmtViewEnd)) playtime
from tbldoctormediatracktest s
left join tblmedia m
  on s.MedId = m.MedId
group by m.medTitle
order by medTitle,  playtime 
```

# 请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/cf37a/9)

# entity-framework - 实体框架表关系未显示

> ID：12465828
> 
> 赞同：0
> 
> 时间：2012-09-17T19:23:09.567
> 
> 标签：entity-framework

我有以下表格：

# 用户

ItemID(int), identity --Primary Key UserID varchar(25) --唯一索引

# 用户项

ItemID(int), identity --主键 UserID varchar(25) UserItems varchar(100)

users.userID 和 userItems.userid 之间存在关系，但是在加载模型时它不显示关系。

有什么理由吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T19:42:00.057

我发现： 具有唯一约束的继承支持 – EF4 不支持基于唯一约束而不是主键的映射继承。

参考资料：http: [//blogs.msdn.com/b/efdesign/archive/2011/03/09/unique-constraints-in-the-entity-framework.aspx](http://blogs.msdn.com/b/efdesign/archive/2011/03/09/unique-constraints-in-the-entity-framework.aspx)

谢谢

# c# - RowUpdate 事件实际上并未更新数据库

> ID：12465832
> 
> 赞同：0
> 
> 时间：2012-09-17T19:23:34.407
> 
> 标签：c#, asp.net, sql-server-2008, gridview

我的 Gridview 是一种让我查看数据库表并在需要时执行编辑和更新的方法

数据实际上是由 moth 、 year 和 DaysPerMonth （可工作天数）组成的

所有字段都是类型`Int`

所以为了显示当前月份而不是给定月份的 int 值/格式，我使用两种方式的翻译，在数据库之外 - 在 gridview 中显示为月份名称（字符串）

```
 public static CultureInfo ILci = CultureInfo.CreateSpecificCulture("he-IL");

   public static string GetMonthName(int mInt, int mYear=2012)
   {
        DateTime fullDate = new DateTime(mYear, mInt, 2);
        string[] tempDayArray = fullDate.ToString("MMMM", ILci).Split(' ');
        return ILci.DateTimeFormat.GetMonthName(mInt);

    } 
```

并通过“翻译器”/格式化程序返回数据库

```
 public static int GetMonthAsInt(string mStr)
    {
        return DateTime.ParseExact(mStr, "MMMM", ILci).Month;

    } 
```

从开始所有阶段都可以 - 查看模式到编辑 - 即使在更新模式下也可以编辑模式，

我可以使用 VS 调试器检查实际上是“Good To Go”的 SQL 数据源更新命令的值，并在 SQL 服务器查询中执行它的命令会返回一个成功的结果。

所以问题仍然存在于更新结束或更新 DataBind() 之后；最后一行我得到的错误/异常是：

**输入字符串的格式不正确。**

这是 GV_DaysPerMonth_RowUpdating 事件处理程序代码

```
 protected void GV_DaysPerMonth_RowUpdating(object sender, GridViewUpdateEventArgs e)
    {

        // by recived i ment what is taken by sql command from gridview

        string recivedNameMonth=string.Empty;
        int recivedYears = 0;
        int recivedDprM = 0;
        int RowNo = 0;

        GridViewRow CurRow = GV_DaysPerMonth.Rows[e.RowIndex];
        string[] formValues = new string[CurRow.Cells.Count-1];
        bool note = ((TextBox)(CurRow.Cells[0].Controls[1])).Text != null;
        if (note)
        {
            for (int i = 0; i < CurRow.Cells.Count-1; i++)
            {
                formValues[i] = ((TextBox)(CurRow.Cells[i].Controls[1])).Text;
            }
            //recivedNameMonth = ((TextBox)(CurRow.Cells[0].Controls[1])).Text;
        }

        RowNo = e.RowIndex + 1;

        recivedNameMonth = formValues[0];
        int Montint = RobCS.RDates.GetMonthAsInt(recivedNameMonth);
        recivedYears = Convert.ToInt32(formValues[1]);
        recivedDprM = Convert.ToInt32(formValues[2]);

        dsWorkDayPerMonth.UpdateCommand = "UPDATE [tblWorkDaysPerMonth] SET [theMonth] = " + Montint+ ", [theYear] = "+recivedYears+",[WorkDaysPerMonth] = " + recivedDprM + " WHERE [recordID] = " + RowNo;

        GV_DaysPerMonth.DataBind();

    } 
```

使用它

SqlDataSource

```
<asp:sqldatasource runat="server" id="dsWorkDayPerMonth" 
ConnectionString="Data Source=(local);Initial Catalog=hental;Integrated Security=True" 
ProviderName="System.Data.SqlClient" 
SelectCommand="SELECT * FROM [tblWorkDaysPerMonth]"
UpdateCommand="UPDATE [tblWorkDaysPerMonth] SET [theMonth] = @theMonth, [theYear] = @theYear, 
                                    [WorkDaysPerMonth] = @WorkDaysPerMonth WHERE [recordID] = @recordID" 
DeleteCommand="DELETE FROM [tblWorkDaysPerMonth] WHERE [recordID] = @recordID" 
InsertCommand="INSERT INTO [tblWorkDaysPerMonth]">
<UpdateParameters> 
    <asp:Parameter Name="theMonth" Type="Int32" /> 
    <asp:Parameter Name="theYear" Type="Int32" /> 
    <asp:Parameter Name="WorkDaysPerMonth" Type="Int32" /> 
    <asp:Parameter Name="recordID" Type="Int32" /> 
</UpdateParameters> 
<DeleteParameters> 
    <asp:Parameter Name="recordID" Type="Int32" /> 
</DeleteParameters> 
</asp:sqldatasource> 
```

使用 GridView

```
 <asp:TemplateField HeaderText="Month" ControlStyle-Width="100" HeaderStyle-Width="120" ItemStyle-HorizontalAlign="Center"> 
                    <ItemTemplate> 
                        <%# Eval("theMonth")%> 
                    </ItemTemplate> 
                    <EditItemTemplate> 
                        <asp:TextBox ID="TBX_theMonth" runat="server" Text='<%# Bind("theMonth")%>' /> 
                    </EditItemTemplate> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T05:46:18.317

因为它是在没有要求的第一个代码示例中实现的

```
 //your connection string here 

        SqlConnection con = RobCS_109.RDB.HentlConn;

        con.Open();
        string updateCMD = dsWorkDayPerMonth.UpdateCommand;
        DataSet ds = new DataSet();
        SqlDataAdapter da;

        //use a select command and SqlConnection
        da = new SqlDataAdapter(dsWorkDayPerMonth.SelectCommand, con);

        //same here i have used all values recived in the example(top one)code
        // event -RowUpdating above, then i am using
       //stored sqlUpdate string for the command below
        da.UpdateCommand = new SqlCommand(SQLUP);
        da.Fill(ds, "tblWorkDayPerMonth");

        dsWorkDayPerMonth.Update();

        con.Close(); 
```

现在它确实起作用了，如果您在更新事件时遇到问题，您可以在这里尝试，稍后我将进一步尝试通过`using`statemet 改进它，一旦我将学习如何

# .net - 为什么Microsoft.Win32.Registry.LocalMachine.CreateSubKey在VS2010和VS2012中不会抛出异常？

> ID：12465833
> 
> 赞同：0
> 
> 时间：2012-09-17T19:23:45.217
> 
> 标签：.net, exception, registry

> **可能重复：**
> [VS2010 在 64 位版本的 Windows 上的 WinForms 应用程序中不显示未处理的异常消息](https://stackoverflow.com/questions/4933958/vs2010-does-not-show-unhandled-exception-message-in-a-winforms-application-on-a)

考虑以下创建或打开注册表项的代码：

```
using Microsoft.Win32;
//...
var registryKey = Registry.LocalMachine.CreateSubKey("SOFTWARE\\Some Key"); 
```

所有版本的 Visual Studio 都在同一台 Windows 7 x64 SP1 机器上运行。如果我在 Visual Studio 2008 中运行它，它会引发 System.UnauthorizedAccessException（除非我使用“以管理员身份运行”选项启动 IDE）。在 Visual Studio 2010 和 2012 中，无法创建密钥，但不会引发异常。它只是默默地失败。为什么？

# zend-framework2 - Zend Framework 2：尝试获取模块控制器和操作的列表

> ID：12465841
> 
> 赞同：0
> 
> 时间：2012-09-17T19:24:18.547
> 
> 标签：zend-framework2

试图为我正在开发的 ACL 模块获取一系列模块控制器和操作。仍在学习框架，并尝试从自动加载器或从引导程序中存储信息的地方提取信息。如果不需要，尝试减少额外的请求。这是我最终输出所需的示例：

*   应用（模块）
    *   索引控制器
        *   查看动作
        *   编辑动作
        *   删除动作
*   ZfcUser（模块）
    *   用户控制器
        *   IndexAction
        *   登录动作

任何帮助将不胜感激。我不反对抓取文件的目录并检查方法的类，但我希望有一个更干净的解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T20:08:37.070

对于任何给定的请求，您可能只应该将一个控制器实际加载到内存中（除非您使用诸如 forward() 之类的东西）。这样做的原因是您将从 ControllerManager 中提取路由到的特定控制器实例，从而为您提供一个实例。

如果你想要一个所有控制器的列表，你可以自省 ControllerManager 服务。由于该插件管理器实现扩展了 ServiceManager，因此您可以调用方法“getRegisteredServices()”，该方法按服务类型提供服务名称列表。从那里，您可以遍历每个控制器并检索每个控制器（因为服务名称可能与类名称没有 1:1 的关系）。

这让你的控制器。

对于操作，这取决于实施。如果控制器是 AbstractActionController 实现，则在类上使用反射来获取方法列表，任何以“Action”结尾的方法都将是一个动作。对于 AbstractRestfulController 实现，这也是正确的，但您还将拥有 getList、get、create、update 和 delete 方法。最后，请记住，控制器只是实现 Zend\Stdlib\DispatchableInterface 的任何对象；因此，“行动”的概念可能并不总是相关的。（例如，我构建了许多只定义 dispatch() 的“页面”控制器和服务端点。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-21T12:01:25.440

你可以使用这个组件来获得你想要的东西：Zend\Code，这是一个可以帮助你入门的例子：

```
public function testGetAllRessources() {
    $sc = new DirectoryScanner();
    $sc->addDirectory('Path/to/Your/Module/src/Module/Controller/');
    $sc->addDirectory('Path/to/Your/SecondModule/src/SecondModule/Controller/');
    foreach ($sc->getClasses(true) as $classScanner) {
        $classname = $classScanner->getName();
        echo 'Controller: ' . $classname . PHP_EOL;
            foreach ($classScanner->getMethods(true) as $method) {
                if($this->endsWith($method->getName(),'Action')) {
                        echo 'Action: ' . $method->getName() . PHP_EOL;
                }
        }
    }
}

function endsWith($haystack, $needle) {
    $length = strlen($needle);
    if ($length == 0) {
        return true;
    }
    return (substr($haystack, -$length) === $needle);
} 
```

# regex - RewriteCond REQUEST_URI - ^ 没有按预期工作

> ID：12465842
> 
> 赞同：5
> 
> 时间：2012-09-17T19:24:20.327
> 
> 标签：regex, codeigniter, mod-rewrite

我正在codeigniter中建立一个站点。我在 .htaccess 文件中有一系列重写条件和规则。第一组规则根据 uri 的第一段打开或关闭 SSL。

然后它再次循环，如果找到匹配项，则适当地重定向页面。如果不匹配，并且 uri 不以列出的任何字符串开头，它会将您重定向到另一个页面。如果不满足任何条件，则转到索引页面。

问题在于我的第一组打开和关闭 SSL 的规则。我想指定 uri 必须以管理员或安全方式开始。但是，如果我将 ^ 添加到字符串的开头，一切都会中断。这是我所拥有的：

```
RewriteCond %{HTTPS} off
RewriteCond %{REQUEST_URI} ^/?(admin|secure)
RewriteRule ^(.*)$ https://%{HTTP_HOST}/$1 [R=301,L]

RewriteCond %{HTTPS} on 
RewriteCond %{REQUEST_URI} !^/?(admin|secure)
RewriteRule ^(.*)$ http://%{HTTP_HOST}/$1 [R=301,L]

...specific rewrites here
RewriteRule ^secure-form1$ secure/contract/secure-form1 [L]
RewriteRule ^secure$ secure/article/secure [L]

RewriteCond %{HTTP_HOST} ^www.example.com$ 
RewriteCond %{REQUEST_URI} !^/(admin|form|secure|page)/
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php/page/article/$1 [L]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php/$1 [L] 
```

如果我在前 2 个重写条件（https 开启和关闭）中保留 ^ 符号，则 [http://www.example.com/secure](http://www.example.com/secure) 重写为 [https://www.example.com/index.php/secure/article/安全](https://www.example.com/index.php/secure/article/secure) ，这是最后的重写规则。url 实际上在浏览器中更改为此。

如果我从前 2 个重写条件中取出 ^ 符号，那么它会转到正确的页面。但我确实需要指定 uri 的开头，因为在 uri 中间（并在斜线后面）有其他页面不应该使用 SSL。

我想不通这个。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-17T19:53:31.983

试试这个：

```
RewriteCond %{HTTPS} off 
RewriteCond %{HTTP_HOST} ^(.*)$ 
RewriteRule ^/?(admin|secure)$ https://%1/$1 [R=301,L] 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-01-09T18:04:42.363

老问题，我知道，但如果你真的想坚持这个`%{REQUEST_URI}`条件，还有另一种解决方案可能会更好：

```
RewriteCond %{HTTPS} !=on
RewriteCond %{REQUEST_URI} ^/?(admin|secure)$
RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [R=301,L] 
```

与 OP 的主要区别在于包含`/?`检查 URI 开头是否存在正斜杠。AFAIK，不同的 Apache 安装可能会或可能不会在`%{REQUEST_URI}`.

这样做的一个好处是您可以将规则应用于多个条件：

```
RewriteCond %{HTTPS} !=on
RewriteCond %{REQUEST_URI} ^/?admin$ [OR]
RewriteCond %{REQUEST_URI} ^/?secure$ [OR]
RewriteCond %{REQUEST_URI} ^/?top-secret$
RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [R=301,L] 
```

就我认为的方式而言，这比一长串以管道分隔的字符串更容易使用。与单个正则表达式相比，这是以潜在的效率损失为代价的，但是您可以进行一些其他改进来抵消这一点：

*   使用*lexographically equal* operator `!=on`。如果您只是使用`off`它，它会被视为正则表达式。

*   消除 RewriteRule 模式，将其替换为单个插入符号，然后使用环境 vars`%{HTTP_HOST}`和`%{REQUEST_URI}`. 这节省了更长的正则表达式模式以及反向引用的开销。

# unix - 目录权限的区别

> ID：12465845
> 
> 赞同：1
> 
> 时间：2012-09-17T19:24:31.720
> 
> 标签：unix, symfony, permissions, file-permissions, user-permissions

我对目录的权限有以下问题。
实际上我安装了`symphony2.0`，我收到以下错误：

```
RuntimeException: Unable to write in the cache directory   
(/Users/someUser/Sites/someApp/app/cache/dev) 
```

如果我列出我得到的目录

```
ll /Users/someUser/Sites/someApp/app/cache
(1)
drwxr-xr-x someUser 
```

我有另一个安装，它的工作和权限是

```
(2)
drwxr-xr-x+ someUser 
```

所以我的问题是如何获得 (2) ？
我运行以下命令（3）来获得（1），但我不知道如何获得（2）。

```
(3)
sudo chmod +a "`whoami` allow delete,write,append,file_inherit,directory_inherit" app/cache app/logs 
```

* * *

PS：
关于（1）和（2）的区别只是`+`最后。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T19:36:50.007

查看[http://symfony.com/doc/current/book/installation.html](http://symfony.com/doc/current/book/installation.html)

1) 在支持 chmod +a 的系统上使用 ACL

```
$ rm -rf app/cache/*
$ rm -rf app/logs/*

$ sudo chmod +a "www-data allow delete,write,append,file_inherit,directory_inherit" app/cache app/logs
$ sudo chmod +a "`whoami` allow delete,write,append,file_inherit,directory_inherit" app/cache app/logs 
```

2) 在不支持 chmod +a 的系统上使用 Acl

```
$ sudo setfacl -R -m u:www-data:rwx -m u:`whoami`:rwx app/cache app/logs

$ sudo setfacl -dR -m u:www-data:rwx -m u:`whoami`:rwx app/cache app/logs 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T19:46:12.330

`+`权限末尾的符号表示存在 ACL 列表，它是 *nix 正常权限的扩展。您可以使用 打印出来`ls -lZ`。然后您可以`setfacl`设置它们。

# c# - 使用 HtmlHelper DisplayFor 的字符串值“Boolean”问题

> ID：12465856
> 
> 赞同：4
> 
> 时间：2012-09-17T19:25:10.437
> 
> 标签：c#, asp.net-mvc-3, linq

我遇到了一个问题，我试图通过迭代对象并使用 HtmlHelpers 向用户显示值。目前一列将携带我写入屏幕的项目的数据类型，它们是字符串值。当我尝试使用 DisplayFor 方法呈现数据类型字符串的值“布尔”时遇到了一个问题。我收到一个 FormatException 说“字符串未被识别为有效的布尔值”。我尝试过几种方式将其转换为字符串，但没有成功。如果我将字符串从“布尔”更改为其他任何内容，它就可以正常工作。有什么建议么？

```
<%foreach (var matrixColumnView in Model.MatrixColumns)
  {%>
<tr id="<%="ColRow_" + matrixColumnView.Key %>" class="columnRow">
    <td class="ui-helper-hidden">
        <%=Html.HiddenFor(x => x.MatrixColumns[matrixColumnView.Key].EntityId)%>
    </td>
    <td>
        <%=Html.HiddenFor(x => x.MatrixColumns[matrixColumnView.Key].Sequence)%>
        <%=Html.DisplayFor(x => x.MatrixColumns[matrixColumnView.Key].Sequence, matrixColumnView.Value.Sequence.ToString())%>
    </td>
    <td>
        <%=Html.HiddenFor(x => x.MatrixColumns[matrixColumnView.Key].Name)%>
        <%=Html.DisplayFor(x => x.MatrixColumns[matrixColumnView.Key].Name, matrixColumnView.Value.Name)%>
    </td>
    <td>
        <%=Html.HiddenFor(x => x.MatrixColumns[matrixColumnView.Key].DataTypeName) %>
        <%=Html.DisplayFor(x => x.MatrixColumns[matrixColumnView.Key].DataTypeName, (string)matrixColumnView.Value.DataTypeName) %>
    </td>
</tr>
<%} %> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T19:39:13.700

代替：

```
<%=Html.DisplayFor(x => x.MatrixColumns[matrixColumnView.Key].DataTypeName, (string)matrixColumnView.Value.DataTypeName) %> 
```

你试一试：

```
<%=Html.DisplayFor(x => x.MatrixColumns[matrixColumnView.Key].DataTypeName) %> 
```

通过传入`(string)matrixColumnView.Value.DataTypeName`（可能）计算结果为“Boolean”作为第二个参数，您告诉 MVC 寻找一个名为“Boolean”的显示模板。显然，它找到的模板不能显示 String 值。通常，您最好让框架决定使用哪个显示模板。

这里有一篇有用的文章讨论了 MVC 如何解析显示/编辑器模板：

[http://bradwilson.typepad.com/blog/2009/10/aspnet-mvc-2-templates-part-3-default-templates.html](http://bradwilson.typepad.com/blog/2009/10/aspnet-mvc-2-templates-part-3-default-templates.html)

# c# - Process.Start 为 Combobox 列表抛出一个 win32 异常

> ID：12465858
> 
> 赞同：0
> 
> 时间：2012-09-17T19:25:26.337
> 
> 标签：c#, process.start

下面是我已经使用了大约两个星期的代码，我认为我一直在工作，直到我输入最后一个信息（MyClient 类），现在我在 Process.Start(url); 说找不到指定的文件。我尝试将其设置为“iexplorer.exe”以使其为 URL 加载 IE，但没有任何变化。

```
public partial class Form1 : Form
{
    List<MyClient> clients;
    public Form1()
    {
        InitializeComponent();
        clients = new List<MyClient>();
        clients.Add(new MyClient { ClientName = "Client 1", UrlAddress = @"http://www.google.com" });
        BindBigClientsList();
    }

    private void BindBigClientsList()
    {
        BigClientsList.DataSource = clients;
        BigClientsList.DisplayMember = "ClientName";
        BigClientsList.ValueMember = "UrlAddress";
    }

    private void BigClientsList_SelectedIndexChanged(object sender, EventArgs e)
    {
        MyClient c = BigClientsList.SelectedItem as MyClient;
        if (c != null)
        {
            string url = c.ClientName;
            Process.Start("iexplorer.exe",url);
        }
    }
}
class MyClient
{
    public string ClientName { get; set; }
    public string UrlAddress { get; set; }
} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T19:32:59.857

您使用的`ClientName`是 URL，这是不正确的...

```
string url = c.ClientName; 
```

...应该...

```
string url = c.UrlAddress; 
```

你也不应该指定`iexplorer.exe`。默认情况下，操作系统使用默认 Web 浏览器打开 URL。除非您真的需要您的用户使用 Internet Explorer，否则我建议让系统为您选择浏览器。

**更新**
*响应OP的评论...*

这取决于您所说的“空白”是什么意思。如果你的意思是`null`，不，这是不可能的。当您尝试调用时，将`null`其用作列表中的第一个条目将导致 NullReferenceException `c.UrlAddress`。您也许可以使用`MyClient`具有虚拟值的占位符实例...

```
clients = new List<MyClient>();
clients.Add(new MyClient { ClientName = "", UrlAddress = null });
clients.Add(new MyClient { ClientName = "Client 1", UrlAddress = @"http://www.google.com" }); 
```

但是，您将不得不将您的操作方法更改为这样的...

```
private void BigClientsList_SelectedIndexChanged(object sender, EventArgs e)
{
    MyClient c = BigClientsList.SelectedItem as MyClient;
    if (c != null && !String.IsNullOrWhiteSpace(c.UrlAddress))
    {
        string url = c.ClientName;
        Process.Start("iexplorer.exe",url);
    }
    else
    {
        // do something different if they select a list item without a Client instance or URL
    }
} 
```

# lua - 从 Lua pinfo 中的列中检索文本

> ID：12465862
> 
> 赞同：4
> 
> 时间：2012-09-17T19:26:06.117
> 
> 标签：lua, wireshark-dissector

我正在使用**Wireshark 1.8.2**和**Lua 5.1** --

有没有办法从**pinfo.cols**列之一检索文本？我没有看到对该函数的`get()`补充`set()`，如果我只是执行类似`message(pinfo.cols.protocol)`or的操作`message(tostring(pinfo.cols.protocol))`，它总是只打印**协议**……而不是该位置的实际文本字符串。

我正在为**IEEE802a OUI Extended Ethertype**帧构建一个非常简单的解析器。
问题是，在我的代码的一个分支中，我可以很好地设置协议和信息列中的文本。在另一个分支中，在我的解剖器被调用*后*，这些列不断被**以太网**和**以太网 II覆盖。** 这就是我要追查的...

# sql-server-2005 - 提取多列的案例

> ID：12465865
> 
> 赞同：0
> 
> 时间：2012-09-17T19:26:24.433
> 
> 标签：sql-server-2005

我想知道是否有类似案例的东西，我可以在 SQL 中使用 SQL Server 2005 中的 1 个案例表达式来获取多列。我是 SQL 的新手。希望这不是太容易，我错过了。先感谢您！！

```
Select RD.RepDailyInfoID, RD.TypeofDayID
Case WHEN RD.TypeofDayID = 1
THEN 
    isnull(cast(S.AmountSold as numeric(10,2)), 0) as AmountSold,
    isnull(cast(S.S_AmountCollected as numeric(10,2)), 0) as AmountCollected,
    S.S_PaymentMethod as PaymentMethod

When RD.TypeofDayID = 9
THEN
    isnull(cast(U.AmountUpgraded as numeric(10,2)), 0) as AmountUpgraded,
    isnull(cast(U.U_UpgradedCollected as numeric(10,2)), 0) + isnull(cast(U.RenewalCollected as numeric(10,2)), 0) as AmountCollected,
    U.U_PaymentMethod as PaymentMethod
END
from RepDailyInfo RD
left outer join SellingInfo S on S.RepDailyInfoID = RD.RepDailyInfoID
left outer join UpgradingInfo U on U.RepDailyInfoID = RD.RepDailyInfoID
where RepID = @RepID 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T19:33:31.907

在 case 语句的 THEN 部分中不能有多个字段。您可以使用相同的逻辑来构建多个案例语句：

```
Case WHEN RD.TypeofDayID = 1 THEN isnull(cast(S.AmountSold as numeric(10,2)), 0) END as AmountSold,
Case WHEN RD.TypeofDayID = 1 THEN isnull(cast(S.S_AmountCollected as numeric(10,2)), 0) END as AmountCollected 
```

等等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T19:35:52.070

这未经测试，但应该可以帮助您入门。你必须为每个领域都有一个案例。

```
 select  RD.RepDailyInfoID, RD.TypeofDayID
    , AmountSold = case when RD.TypeofDayID = 1 THEN  isnull(cast(S.AmountSold as numeric(10,2)), 0) else 0 end
    , AmountUpgraded = case when RD.TypeofDatID = 9 THEN isnull(cast(U.AmountUpgraded as numeric(10,2)), 0) else 0 end
    , AmountCollected = case when RD.TypeofDayID = 1 then isnull(cast(S.S_AmountCollected as numeric(10,2)), 0) else
                when RD.TypeofDayID = 9 then isnull(cast(U.U_UpgradedCollected as numeric(10,2)), 0) + isnull(cast(U.RenewalCollected as numeric(10,2)), 0) end
    , PaymentMethod = case when RD.TypeofDayID = 1 then S.S_PaymentMethod else
                when RD.TypeofDayID = 9 then U.U_PaymentMethod end
from RepDailyInfo RD
left outer join SellingInfo S on S.RepDailyInfoID = RD.RepDailyInfoID
left outer join UpgradingInfo U on U.RepDailyInfoID = RD.RepDailyInfoID
where RepID = @RepID 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T19:58:24.393

案例确实存在。它记录[在这里](http://msdn.microsoft.com/en-us/library/ms181765.aspx)。

不过，我认为您的格式可能有点偏离。尝试：

```
SELECT RD.RepDailyInfoID, AmountSold = 
  CASE RD.TypeofDayID
    WHEN '1' THEN isnull(cast(S.AmountSold as numeric(10,2)), 0)
  END
FROM RepDailyInfo RD
left outer join SellingInfo S on S.RepDailyInfoID = RD.RepDailyInfoID
left outer join UpgradingInfo U on U.RepDailyInfoID = RD.RepDailyInfoID
WHERE RepID = @RepID 
```

我尚未对其进行测试，但这只是我快速查看文档后对格式的看法。

祝你好运！

编辑：看起来像 Lance Ninja'd 我。他的代码更完整，但（部分）证实了我的想法。

# linux - grep'ing 先前 grep 的文件输出

> ID：12465867
> 
> 赞同：0
> 
> 时间：2012-09-17T19:26:39.047
> 
> 标签：linux, grep, pipe

我不知道这是否可能，或者 grep 是否是错误的工具，或者是什么，但我想要做的是：

```
grep -rsI "some_string" *.c 
```

然后将找到结果**的文件列表通过**管道传输到第二个 grep 中：

```
grep -rsI "second_string" <list of files from first grep> 
```

我知道我可以通过以下方式将确切的行传递给第二个 grep：

```
grep -rsI "some_string" *.c | grep "second_string" 
```

但这**不是**我要找的，我不想只搜索以前点击的行，而是搜索这些行所在的整个文件。这可能吗？有任何想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-17T19:28:18.040

```
grep -rsIl "some_string" *.c | xargs grep -sI "second_string" 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-17T19:28:35.013

使用`-l`选项列出匹配的文件，然后`xargs`命令应用于`grep`这些文件。

```
grep -l -rsI "some_string" *.c | xargs grep "second_string" 
```

# ruby - 遍历 ruby 哈希并选择一个正则表达式值

> ID：12465870
> 
> 赞同：0
> 
> 时间：2012-09-17T19:26:57.580
> 
> 标签：ruby, regex, hash, iterator

嗨，我遇到了一些意想不到的事情，在任何地方都找不到答案..

我有一个哈希：

```
hash = {:thiskey => /value/, :anotherkey => /anothervalue/} 
```

当我像这样遍历哈希时：

```
hash.each do |key, value| 
   puts key
   puts value
end 
```

如果值是正则表达式 /calendar/ .... 迭代器产生：

```
>>> thiskey
>>>(?-mix:calendar) 
```

关于为什么会这样的任何想法？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T19:30:51.777

```
(?-mix:...) 
```

表示“对于这部分正则表达式，dotall 模式、不区分大小写模式和详细模式已关闭”（这是默认设置）。表示只是明确表示。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T19:29:50.110

`(?-mix:calendar)`是使用 ruby​​ 时正则表达式的字符串表示形式。

```
>> a = /test(er)/
=> /test(er)/
>> print a.source
test(er)=> nil
>> print a
(?-mix:test(er))=> nil
>> 
```

# rest - ServiceStack.net 与 Custom CredentialsAuthProvider 返回“未经授权”？

> ID：12465871
> 
> 赞同：1
> 
> 时间：2012-09-17T19:27:17.477
> 
> 标签：rest, servicestack

我正在尝试使用 ServiceStack.net，所以我的第一个服务已经实现了一个 Custom CredentialsAuthProvider，它的 TryAuthenticate 方法现在只返回 True。

我遇到的问题是客户首先调用（并成功）

```
var rc = new JsonServiceClient("http://localhost:1337/");

var ar = rc.Send<AuthResponse>(new Auth
{
  provider = CredentialsAuthProvider.Name,
  UserName = "user",
  Password = "p@55word",
  RememberMe = true
}); 
```

其次是：

```
var newJob = rc.Post<BladeJob>("/jobs", new BladeJob { Name = "TestJob" }); //todo.Id = 
```

它只是返回“未经授权”（异常）。

服务很简单：

```
[Authenticate()]
public class BladesService : RestServiceBase<BladeJob>
{
  public JobRepository Repository { get; set; }

  public override object OnPut(BladeJob request)
  {
    return Repository.Store(request);
  }

public override object OnPost(BladeJob job)
{
  return Repository.Store(job);
}

  public override object OnGet(BladeJob request)
  {
    IAuthSession session = this.GetSession();

    if (request.JobID != default(ulong))
      return Repository.GetByID(request.JobID);

    return Repository.GetAll();
    }
} 
```

我在 TryAuthenticate 中放了一个断点，它就很好地命中了，我做错了什么？

整个主机配置在这里：

```
public override void Configure(Funq.Container container)
{
  //Register Web Service dependencies
  container.Register(new JobRepository());
  //Register all Authentication methods you want to enable for this web app.
  Plugins.Add(new AuthFeature(() => new AuthUserSession(),
      new AuthProvider[] {
        new CustomCredentialsAuthProvider() //HTML Form post of UserName/Password credentials
      }
  ));

  //Register user-defined REST-ful routes         
  Routes
    .Add<BladeJob>("/jobs")
    .Add<BladeJob>("/jobs/{JobID}"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T21:31:55.203

您应该注册一个`ICacheClient`会话[提供者](https://github.com/ServiceStack/ServiceStack/wiki/Sessions)应该使用的。

例如，您可以使用以下方式注册内存中缓存：

```
container.Register<ICacheClient>(new MemoryCacheClient()); 
```

以下是可用于[ServiceStack的其他](http://www.servicestack.net/)[缓存提供程序](https://github.com/ServiceStack/ServiceStack/wiki/Caching)。

注意：由于这被一些人意外发现，所以在下一个版本的 ServiceStack (v3.9.12+) 中，如果未指定，我们将自动注册以使用 InMemory Cache。

# javascript - 发布复选框值

> ID：12465873
> 
> 赞同：1
> 
> 时间：2012-09-17T19:27:27.537
> 
> 标签：javascript, jquery, backbone.js, handlebars.js, mustache

我的网页上有一组复选框。在保存时，我序列化并发布表单。

```
<div>
<label for="ViewAsWebpage">
{{#if this.ViewAsWebpage}}
   <input type="hidden" id="ViewAsWebpage" name="ViewAsWebpage" value="true"/> 
   <input type="checkbox" class="enable-checkbox" checked /> 
{{else}}
   <input type="hidden" id="ViewAsWebpage" name="ViewAsWebpage"  value="false"/> 
   <input type="checkbox" class="enable-checkbox"  /> 
{{/if}}
<span>View as Webpage</span>
</label>
</div> 
```

使用上面的代码：

*   在 GET 上 - 根据属性 ViewAsWebpage 选中/取消选中复选框
*   在 POST 上 - 用户选择的任何内容都应该发布。

但是当我发布时，它没有发送正确的值。有人可以建议正确的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T19:31:42.057

您的`<input type="checkbox">`元素缺少`name`属性，因此在您发布表单时它们不会对应于请求参数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T19:34:35.543

我认为问题在于您没有使用**name**属性。

```
<input type="checkbox" class="enable-checkbox" name="key_in_post" /> 
```

使用它，您应该在 POST 数据中看到它，在这种情况下，如果选中它，则 key_in_post 的值为“on”。

# c# - F# 类型是否可以从 C# 类“继承”？

> ID：12465874
> 
> 赞同：7
> 
> 时间：2012-09-17T19:27:32.013
> 
> 标签：c#, f#, c#-to-f#

我在我的日子里使用过一点 Haskell，但那是很久以前的事了，所以我决定看看 F#。我使用 C、C++ 和 C# 进行大量日常开发。

我注意到在将 F# 编译为 dll 时，您可以将 F# 类型公开为 C# 中的类。但后来我开始思考。我有一些 C# 类，我想将其逻辑放入 F# 中（尝试一下）。但是很多现有的 C# 代码通过它们的基类处理很多对象（这是非常初级的）。是否可以使用 C# 中的该基类作为 F# 类型的基础？还是 F# 只能从其他 F# 类型继承？

这背后的原因是将基类保留为主要 C# 项目的一部分，并且可以用 F# 编写特定的 dll（类似于基于基类给定合同的插件）。如果无法完成，我将不得不添加另一个 F# 项目，该项目仅包含感觉有点过于复杂的基类。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-17T19:30:19.917

是的。有可能的。

```
type SomeClass =
    inherit SomeCSharpBase 
```

以下是更多细节：

[继承 (F#)](http://msdn.microsoft.com/en-us/library/dd233225.aspx)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-20T07:19:26.340

F# 类可以从 .NET 类继承：

```
type FSharpClass() =
    inherit System.AccessViolationException() 
```

其他一些 F# 类型，例如记录、可区分联合不能从类继承，但它们可以实现接口：

```
type FSharpRecord =
    { d : System.IDisposable }
    interface System.IDisposable with
        member this.Dispose() = this.d.Dispose() 
```

# php - php xpath 可以仅使用以下轴向前搜索直到特定标签吗？

> ID：12465881
> 
> 赞同：0
> 
> 时间：2012-09-17T19:28:00.403
> 
> 标签：php, xpath

我正在尝试解析格式错误的 html 表：

其中有几行是：

```
 Food:</b> Yes<b><br>
 Pool: </b>Beach<b></b><b><br>
  Centre:</b> Yes<b><br> 
```

使用 php 的 domdocument xpath 我可以选择所有的标题标签，比如 Food、center 和 pool，但是一旦我有了每个我想向前搜索，直到我点击下一个标题标签。

我知道正则表达式可以期待一个特定的模式。xpath 可以为特定标签做同样的事情吗？

谢谢，

账单

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T21:31:08.183

使用 following-sibling::br[1]/following-sibling::text()[1] 似乎是您所需要的。

但是，在对结构不佳的数据进行复杂查询时，最好的建议通常是先进行 XSLT 转换以创建更好的结构。

# android - 应用程序在 new FTPClient() 处崩溃；

> ID：12465884
> 
> 赞同：1
> 
> 时间：2012-09-17T19:28:04.400
> 
> 标签：android, eclipse, apache, import, ftp

所以我正在使用一个应用程序来编辑 FTP 服务器上的文本文件。我已经导入了附有源代码的 apache commons .jar。Eclipse 中的代码不会读取任何错误。

我已将其范围缩小到出现故障的代码行。

```
View.OnClickListener myhandler1 = new View.OnClickListener() {
    public void onClick(View v) {

        EditText et = (EditText) findViewById(R.id.editText1);
        String g = et.getText().toString();
        et.setText("");
        FTPClient con;
        try{
            /*con = new FTPClient();
            con.connect("xx.xxx.xxx.xxx");

            if (con.login("xxxxx", "xxxxx"))
            {
                con.enterLocalPassiveMode(); // important!
                con.setFileType(FTP.BINARY_FILE_TYPE);
                String data = "/public_html/prompt/status.txt";

                FileInputStream in = new FileInputStream(new File(data));
                boolean result = con.storeFile("/status.txt", in);
                in.close();
                con.logout();
                con.disconnect();
            }*/
        } catch (Exception e) {
        }
    }
}; 
```

在这个代码片段中，最后一段没有被注释掉的代码是：

```
FTPClient con; 
```

当我运行它时，它运行良好。

但是，当我取消注释时：

```
con = new FTPClient(); 
```

即使它在“try-catch”中，应用程序也会崩溃。

我相信我正确导入了 .jar。还有什么我可能做错了吗？

LogCat 说：

```
Could not find class "org.apache.commons.net.ftp.FTPClient" 
```

所以我猜测这意味着我没有导入它吗？

# c# - 将自定义路由映射到嵌套对象属性

> ID：12465894
> 
> 赞同：2
> 
> 时间：2012-09-17T19:28:46.583
> 
> 标签：c#, servicestack

给定以下 DTO：

```
[DataContract]
public class Foo
{
    [DataMember]
    public string Boo { get; set; }
    [DataMember]
    public string Far { get; set; }
}

[DataContract]
public class Bar
{
    [DataMember]
    public Foo Test { get; set; }

    // other members
} 
```

我想添加一条路线，例如：

```
Add<Bar>("/...(other members).../{Test.Boo}/{Test.Far}/ 
```

这可能吗？如果是这样，情况将如何变化？

```
[DataMember]
public Foo Test { get; set; } 
```

改为：

```
[DataMember]
public Foo[] Test { get; set; } 
```

?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T21:29:27.357

您不能映射到路由中的嵌套属性。对于通用服务 API 设计，您的目标应该是尽可能保持 DTO 平坦，因为它更容易被客户访问。

尽管 ServiceStack 允许您使用[JSV 格式](https://github.com/ServiceStack/ServiceStack.Text/wiki/JSV-Format)（即不带引号的 JSON）通过 QueryString 发送复杂类型。

所以你可以这样做：

```
Routes.Add<Bar>("/bar"); 
```

并且能够通过以下方式调用您的服务：

```
/bar?Test={Foo:foo,Bar:bar} 
```

[有关ServiceStack 中路由的](https://stackoverflow.com/a/12165439/85785)更多详细信息，请参阅此答案。

# php - 需要帮助更改产品页面价格 magento

> ID：12465904
> 
> 赞同：-1
> 
> 时间：2012-09-17T19:29:29.190
> 
> 标签：php, css, magento, html

我在 Magento 开发的网站上完成了 90% 的工作。我一生都无法弄清楚如何在产品页面上更改价格跨度的类别，以便我可以使该价格具有独立的风格。我搜索了整个 interwebz 上的每个页面和论坛，并扫描了 price.phtml 的每一行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T15:39:21.440

查看价格模板：

```
template/catalog/product/price.phtml
template/catalog/product/price_msrp.phtml 
```

您可以修改类

```
<span class="price-excluding-tax">
    <span class="label"><?php echo $this->helper('tax')->__('Excl. Tax:') ?></span>
    <span class="price my-price" id="price-excluding-tax-<?php echo $_id ?><?php echo $this->getIdSuffix() ?>">
        <?php echo $_coreHelper->currency($_price+$_weeeTaxAmount,true,false) ?>
    </span>
</span> 
```

我建议您在需要的地方添加额外的类，但也保留在当前类中以避免破坏某些功能。

然后，您可以根据需要添加样式

```
span.price.my-price { color: #ff0000; } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T08:10:40.580

您可以在 skin/frontend/YOUR_PACKAGE/YOUR_STYLE/css/styles.css 中更改价格类的样式并搜索“.price”。.price 类有几个不同的条目，但您可能需要仅显示“.price”的条目。在默认 CSS 中，您可以搜索“< 产品价格”，您需要编辑的行就在该评论的下方。

编辑：

要仅在产品视图中编辑价格，请添加一个新的特定 css 块：

```
.product-view .price {
  *your css changes here* 
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T20:59:36.167

`price.phtml`是最难更改的文件之一。您可以创建一个扩展模型`Mage_Catalog_Model_Product.php`，创建一个名为 的函数`getPrice()`，然后执行您的逻辑。Vut 每次 magento 需要价格时，它都会调用您的方法。所以，做你的逻辑，并提出一个条件：

```
if(youcondition)

else
parent::getPrice(); 
```

这样你就不需要再做所有的逻辑`getPrice`了。这是最好的方法之一。但是，如果您想从 magento 的核心更改价格文件，只需转到 app/design/default/default/2012/template/catalog/product/price.phtml

# stream - 新帖子现在出现在 Like Box 中

> ID：12465906
> 
> 赞同：1
> 
> 时间：2012-09-17T19:29:33.047
> 
> 标签：stream, facebook-like

我已经看到其他人在哪里发布过这个。我在客户的网站上有一个点赞框，新帖子显示在“旧帖子”下的时间轴上，即使它们是几个小时前才发布的——这使得它们不会出现在点赞框中。他们的 FB 页面上是否有可能导致此问题的设置。我的 Like Box 设置正确（show_faces=true&border_color=%23555555&stream=true&header=false&appId=180146438719420;force_wall=true&"），甚至在有人建议后添加了最后一部分（force_wall）。仍然没有。

有人弄清楚了吗？谢谢！

# c++ - 如何在 C++ 中安全地破坏 Posix 线程池

> ID：12465909
> 
> 赞同：2
> 
> 时间：2012-09-17T19:29:49.757
> 
> 标签：c++, pthreads, threadpool, boost-bind, boost-function

我正在尝试使用 pthread 在 C++ 中实现线程池。我想将与线程管理相关的逻辑封装在一个拥有这些线程所有权的对象中。这意味着每当该对象被销毁时，必须停止并清理线程。

停止和销毁线程的最佳方法是什么？开始时分离和停止时取消是一个好的解决方案吗？还是取消和加入线程更好？请参阅我的代码，我将不胜感激任何相关评论。

WorkerThreadManager.h：

```
#include "WorkerThreadManagerInterface.h"
#include "utils/mutex.h"
#include <queue>
#include <semaphore.h>

#include <iostream>

class WorkerThreadManager : public WorkerThreadManagerInterface
{
    public:
        WorkerThreadManager(unsigned threadsNumber = 5);
        virtual ~WorkerThreadManager();

        virtual void    PushTask(thread_function_t A_threadFun, result_function_t A_resultFun);
        void    SignalResults();

    private:
        static void*    WorkerThread(void* A_data);

        void    PushResult(int A_result, result_function_t A_resultFun);

        typedef boost::function<void ()> signal_function_t;

        struct worker_thread_data_t
        {
            worker_thread_data_t(thread_function_t A_threadFun, result_function_t A_resultFun) :
                threadFun(A_threadFun), resultFun(A_resultFun) {}
            worker_thread_data_t() {}

            thread_function_t       threadFun;
            result_function_t       resultFun;
        };

        const unsigned                      m_threadsNumber;
        pthread_t*                          m_pthreads;

        utils::Mutex                        m_tasksMutex;
        sem_t                               m_tasksSem;
        std::queue<worker_thread_data_t>    m_tasks;

        utils::Mutex                        m_resultsMutex;
        std::queue<signal_function_t>       m_results;
}; 
```

WorkerThreadManager.cpp：

```
#include "WorkerThreadManager.h"
#include "gateway_log.h"
#include <pthread.h>

/**
 * @brief Creates semaphore and starts threads.
 */
WorkerThreadManager::WorkerThreadManager(unsigned threadsNumber) : m_threadsNumber(threadsNumber)
{
    if ( sem_init(&m_tasksSem, 0, 0) )
    {
        std::stringstream ss;
        ss << "Semaphore could not be initialized: " << errno << " - " << strerror(errno);
        LOG_FATAL(ss);
        throw std::runtime_error(ss.str());
    }

    m_pthreads = new pthread_t[m_threadsNumber];
    for (unsigned i = 0; i < m_threadsNumber; ++i)
    {
        int rc = pthread_create(&m_pthreads[i], NULL, WorkerThreadManager::WorkerThread, (void*) this );
        if(rc)
        {
            std::stringstream ss;
            ss << "Pthread could not be started: " << errno << " - " << strerror(errno);
            LOG_FATAL(ss.str());

            if ( sem_destroy(&m_tasksSem) )
                LOG_ERROR("Semaphore could not be destroyed: " << errno << " - " << strerror(errno));

            delete [] m_pthreads;

            throw std::runtime_error(ss.str());
        }
        else
        {
            LOG_DEBUG("Worker thread started " << m_pthreads[i]);

            if(pthread_detach(m_pthreads[i]))
                LOG_WARN("Failed to detach worker thread");
        }
    }
}

/**
 * @brief Cancels all threads, destroys semaphore
 */
WorkerThreadManager::~WorkerThreadManager()
{
    LOG_DEBUG("~WorkerThreadManager()");

    for(unsigned i = 0; i < m_threadsNumber; ++i)
    {
        if ( pthread_cancel(m_pthreads[i]) )
            LOG_ERROR("Worker thread cancellation failed");
    }

    if ( sem_destroy(&m_tasksSem) )
        LOG_ERROR("Semaphore could not be destroyed: " << errno << " - " << strerror(errno));

    delete [] m_pthreads;
}

/**
 * @brief Adds new task to queue, so worker threads can
 * @param A_threadFun function which will be executed by thread
 * @param A_resultFun function which will be enqueued for calling with return value of A_threadFun as parameter
 *          after worker thread executes A_threadFun.
 */
void WorkerThreadManager::PushTask(thread_function_t A_threadFun, result_function_t A_resultFun)
{
    utils::ScopedLock mutex(m_tasksMutex);

    worker_thread_data_t    data(A_threadFun, A_resultFun);
    m_tasks.push( data );
    sem_post(&m_tasksSem);
    LOG_DEBUG("Task for worker threads has been added to queue");
}

/**
 * @brief   Executes result functions (if there are any) to give feedback 
 *  to classes which requested task execution in worker thread.
 */
void WorkerThreadManager::SignalResults()
{
    while(true)
    {
        signal_function_t signal;
        {
            utils::ScopedLock mutex(m_resultsMutex);
            if(m_results.size())
            {
                signal = m_results.front();
                m_results.pop();
            }
            else
                return;
        }

        signal();
    }
}

/**
 * @brief Enqueues result of function executed in worker thread.
 * @param A_result return value of function executed in worker thread
 * @param A_resultFun function which will be enqueued for calling with A_result as a parameter.
 */
void WorkerThreadManager::PushResult(int A_result, result_function_t A_resultFun)
{
    utils::ScopedLock mutex(m_resultsMutex);

    signal_function_t signal = boost::bind(A_resultFun, A_result);
    m_results.push( signal );
}

/**
 * @brief   worker thread body
 * @param A_data pointer to WorkerThreadManager instance
 */
void* WorkerThreadManager::WorkerThread(void* A_data)
{
    WorkerThreadManager* manager = reinterpret_cast<WorkerThreadManager*>(A_data);
    LOG_DEBUG("Starting worker thread loop");
    while (1)
    {
        if ( -1 == sem_wait(&manager->m_tasksSem) && errno == EINTR )
        {
            LOG_DEBUG("sem_wait interrupted with signal");
            continue;
        }
        LOG_DEBUG("WorkerThread:::::: about to call lock mutex");

        worker_thread_data_t data;
        {
            utils::ScopedLock mutex(manager->m_tasksMutex);
            data = manager->m_tasks.front();
            manager->m_results.pop();
        }

        LOG_DEBUG("WorkerThread:::::: about to call resultFun");
        int result  = data.threadFun();
        LOG_DEBUG("WorkerThread:::::: after call resultFun");
        pthread_testcancel();

        manager->PushResult(result, data.resultFun);
    }

    return NULL;
} 
```

主.cpp：

```
#include "gateway_log.h"
#include "WorkerThreadManager.h"
#include <memory>

class A {
public:
    int Fun() { LOG_DEBUG("Fun before sleep"); sleep(8); LOG_DEBUG("Fun after sleep");return 0; }
    void Result(int a) { LOG_DEBUG("Result: " << a); }
};

int main()
{
    sd::auto_ptr<WorkerThreadManager> workerThreadManager = new WorkerThreadManager;
    A a;
    workerThreadManager->PushTask(boost::bind(&A::Fun, &a), boost::bind(&A::Result, &a, _1));
    sleep(3);
    LOG_DEBUG("deleting workerThreadManager");
    workerThreadManager.reset();                    // <<<--- CRASH
    LOG_DEBUG("deleted workerThreadManager");
    sleep(10);
    LOG_DEBUG("after sleep");    

    return 0;
} 
```

请注意[这里](https://stackoverflow.com/questions/12466613/crash-related-to-boostfunction-usage-in-thread-pool)描述的这段代码有问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T19:54:23.440

关于安全停车：我更喜欢`pthread_join`. 我不使用`pthread_cancel`- 我正在使用特殊的停止消息，但我总是有事件驱动的线程（意味着带有一些消息队列的线程）。当线程得到`exit-message`它时，它会停止它的循环，然后加入返回到我的`main`代码。

关于您的代码 - 我建议创建`class Thread`封装单线程。池应该`Thread`在堆上创建对象 - 就像现在你有`pthread_t`. 如果您需要池和线程之间的同步 - 那么您不能在确定`Thread`对象被销毁的情况下退出池析构函数。

# opengl-es - Cocos2d：CCSpriteBatch 节点是否只绘制可见属性设置为 true 的精灵？

> ID：12465911
> 
> 赞同：0
> 
> 时间：2012-09-17T19:30:07.253
> 
> 标签：opengl-es, cocos2d-iphone, sprite, spritebatch

CCSpriteBatch 节点是否仅绘制可见属性设置为 true 的精灵？

还是它也考虑屏幕尺寸？换句话说。如果节点内的精灵在屏幕之外，opengl 绘制调用的性能会反映这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T08:18:22.793

没有也没有。

CCSpriteBatchNode 总是绘制所有子精灵。我不确定是什么让可见 = NO 的精灵不会出现在屏幕上，但从技术上讲，它每次都会绘制所有四边形。它也没有考虑屏幕区域。

未批处理的精灵表现不同。如果一个非批处理的精灵不可见，它就不会被绘制。然而，屏幕外的精灵被绘制。Cocos2D 没有跳过在屏幕/窗口边界之外绘制节点的功能。

*以下是我过去几年读到的传闻，因此请持保留态度：*

太多的批处理精灵仍然会对性能产生负面影响，即使它们不可见或不在屏幕之外。GPU 负责取消由于完全在屏幕之外而不可见的四边形绘制。它仍然需要处理这些四边形。

这是 cocos2d 的 tilemap 实现的主要问题，也是为什么它在大型 tilemap 上如此缓慢。内部瓷砖地图也使用相同的精灵批处理技术。

# php - 什么是跳过 MySQL INSERT 的正确方法

> ID：12465913
> 
> 赞同：2
> 
> 时间：2012-09-17T19:30:07.877
> 
> 标签：php, mysql, foreach

我有一个 foreach 语句循环遍历 JSON 数据并将内容插入 MySQL。如果为 $author 字符串显示特定的用户名，我想跳过插入。下面的方法可以吗，还是在数据库级别处理更好？

```
foreach ($response['data'] as $data) {      
        $id = $data['id'];
        $created_time = $data['created_time'];
        $thumbnail = $data['images']['low_resolution']['url'];
        $author = $data['user']['username'];
        $caption = mysql_real_escape_string($data['caption']['text']);
        $link = $data['link'];
        $likes = $data['likes']['count'];

        if ($author == 'USERNAME') {
            mysql_close($con);
        } else {

        $query = "INSERT IGNORE INTO pbr (id, created_time, thumbnail, author, caption, link, likes, hash) VALUES ('$id', '$created_time', '$thumbnail', '$author', '$caption', '$link', '$likes', '$hash')";
        $result = mysql_query($query) or die(mysql_error());        

    mysql_close($con);
        }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T19:33:27.613

为什么在每次循环迭代时关闭 SQL 连接？

为什么不简单地做：

```
if ($author == 'USERNAME')
  continue; // next iteration

$query = "INSERT IGNORE INTO pbr (id, created_time, thumbnail, author, caption, link, likes, hash)
  VALUES ('$id', '$created_time', '$thumbnail', '$author', '$caption', '$link', '$likes', '$hash')";
$result = mysql_query($query) or die(mysql_error()); 
```

顺便说一句，您应该将参数绑定到您的查询，或者至少使用**mysql_real_escape_string()**否则会遇到包含引号的值的问题（目前，您只对变量**$caption**这样做，我猜**$link**，**$thumbnail**和**$username**可以包含单个引号）。

# ffmpeg - 如何针对多个比特率输出文件优化 ffmpeg w/x264

> ID：12465914
> 
> 赞同：12
> 
> 时间：2012-09-17T19:30:11.717
> 
> 标签：ffmpeg, x264

目标是创建多个输出文件，这些输出文件仅在比特率上与单个源文件不同。记录在案的解决方案有效，但效率低下。我发现最有效的解决方案没有记录在我能看到的任何地方。我将其发布在这里以供审查，并询问其他人是否知道可以进行的其他优化。

```
Source file       MPEG-2 Video (Letterboxed) 1920x1080 @>10Mbps
                  MPEG-1 Audio @ 384Kbps
Destiation files  H264 Video 720x400 @ multiple bitrates
                  AAC Audio @ 128Kbps
Machine           Multi-core Processor 
```

每个比特率的视频质量很重要，因此我们在 2-Pass 模式下运行，预设为“中等”

`VIDEO_OPTIONS_P2 = -vcodec libx264 -preset medium -profile:v main -g 72 -keyint_min 24 -vf scale=720:-1,crop=720:400`

第一种方法是在并行过程中对它们进行编码

```
ffmpeg -y -i $INPUT_FILE $AUDIO_OPTIONS_P2 $VIDEO_OPTIONS_P2 -b:v 250k -threads auto -f mp4 out-250.mp4 &
ffmpeg -y -i $INPUT_FILE $AUDIO_OPTIONS_P2 $VIDEO_OPTIONS_P2 -b:v 500k -threads auto -f mp4 out-500.mp4 &
ffmpeg -y -i $INPUT_FILE $AUDIO_OPTIONS_P2 $VIDEO_OPTIONS_P2 -b:v 700k -threads auto -f mp4 out-700.mp4 &

```

明显的低效率是源文件的读取、解码、缩放和裁剪对于每个进程都是相同的。我们怎样才能做到这一点，然后将结果提供给编码器？

希望是在单个 ffmpeg 命令中生成所有编码将优化重复步骤。

```
ffmpeg -y -i $INPUT_FILE \
$AUDIO_OPTIONS_P2 $VIDEO_OPTIONS_P2 -b:v 250k -threads auto -f mp4 out-250.mp4 \
$AUDIO_OPTIONS_P2 $VIDEO_OPTIONS_P2 -b:v 500k -threads auto -f mp4 out-500.mp4 \
$AUDIO_OPTIONS_P2 $VIDEO_OPTIONS_P2 -b:v 700k -threads auto -f mp4 out-700.mp4 
```

然而，编码时间几乎与之前的多进程方法相同。这使我相信所有步骤都再次重复执行。

为了强制 ffmpeg 只读取、解码和缩放一次，我将这些步骤放在一个 ffmpeg 进程中，并将结果通过管道传送到另一个执行编码的 ffmpeg 进程中。这将整体处理时间缩短了 15%-20%。

```
INPUT_STREAM="ffmpeg -i $INPUT_FILE -vf scale=720:-1,crop=720:400 -threads auto -f yuv4mpegpipe -"

$INPUT_STREAM | ffmpeg -y -f yuv4mpegpipe -i - \
$AUDIO_OPTIONS_P2 $VIDEO_OPTIONS_P2 -b:v 250k -threads auto out-250.mp4 \
$AUDIO_OPTIONS_P2 $VIDEO_OPTIONS_P2 -b:v 500k -threads auto out-500.mp4 \
$AUDIO_OPTIONS_P2 $VIDEO_OPTIONS_P2 -b:v 700k -threads auto out-700.mp4 
```

有没有人看到这样做的潜在问题，或者知道更好的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-21T20:18:26.730

如果将音频/视频选项应用于第一个进程的管道输出，则可以节省一些 CPU，因为它将 3 个编码交换为一个。

```
ffmpeg -i $INPUT_FILE -vf scale=720:-1,crop=720:400 $AUDIO_OPTIONS_P2 $VIDEO_OPTIONS_P2  -f yuv4mpegpipe -\
    | ffmpeg -y -f yuv4mpegpipe -i - \
          -b:v 250k out-250.mp4 \
          -b:v 500k out-500.mp4 \
          -b:v 700k out-700.mp4 
```

这是旧版本 ffmpeg 的推荐方式。自本月初以来，有一种更新的方法（未测试）可用：http: [//ffmpeg.org/trac/ffmpeg/wiki/Creating%20multiple%20outputs](http://ffmpeg.org/trac/ffmpeg/wiki/Creating%20multiple%20outputs)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-10T12:44:20.390

我认为 OP 更想要的是一次使用过滤器，多次编码。使用的方法很好，尽管您可能会使用“tee”过滤器获得更快的速度，另请参阅最近添加到[http://ffmpeg.org/trac/ffmpeg/wiki/Creating%20multiple%20outputs](http://ffmpeg.org/trac/ffmpeg/wiki/Creating%20multiple%20outputs)底部的“多种编码”对于相同的输入“

# java - Android MediaMetadataRetriever 从大多数键返回空值

> ID：12465915
> 
> 赞同：14
> 
> 时间：2012-09-17T19:30:14.047
> 
> 标签：java, android, metadata, media, android-mediaplayer

我想从我的媒体文件（主要是 mp3）中获取信息，而我从我想要的那些值中只得到空值。我已经尝试了所有的键`extractMetadata(key)`。我是否跳过/错过了什么？

代码基础：

```
MediaMetadataRetriever f = new MediaMetadataRetriever();
f.setDataSource(item.getFilePath());

String title = f.extractMetadata(MediaMetadataRetriever.METADATA_KEY_TITLE); 
```

`(MediaMetadataRetriever.METADATA_KEY_DURATION)`我确实使用 duration key和 mimetype key得到了正确的值`(MediaMetadataRetriever.METADATA_KEY_MIMETYPE)`，这表明数据源/文件路径正在工作。

Poweramp（流行的媒体播放器）能够读取元数据值，如标题/作者/作曲家等，因为它会在 UI 中显示这些额外的值。或者 Poweramp 可能从其他来源或方法获得这些值？

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T20:08:15.090

这可能听起来很傻，但您尝试过许多不同的 mp3 文件吗？根据我的经验，如果您非法获取您的 mp3 文件，则密钥有时不存在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-25T11:15:22.087

成功时与给定 keyCode 关联的元数据值；失败时为空。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-19T19:53:34.567

Poweramp 在 /data/data/com.maxmpz.audioplayer/databases/folders.db 中维护自己的数据库。您需要有根设备来调查此数据库。如果您想了解更多详情，可以给我发信息

# javascript - 编辑可见性隐藏的字段

> ID：12465917
> 
> 赞同：-4
> 
> 时间：2012-09-17T19:30:26.490
> 
> 标签：javascript, html

是否可以在字段可见性：隐藏时使用 javascript 编辑输入字段？这似乎是不可能的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T19:33:43.967

是的。当字段为“可见性：隐藏”时，可以使用 javascript 编辑输入字段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T19:33:56.237

没关系，它是可见的。它可以通过 javascript 访问，因为它是可见的。如果在页面上**呈现。**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T19:34:53.647

好吧，只要您现在对元素进行一些识别，它就会起作用。例如`document.getElementById('lol').value = 'hello';`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-17T19:37:06.877

可以以编程方式编辑元素。例如：http: [//jsfiddle.net/xTpRa/](http://jsfiddle.net/xTpRa/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-17T19:37:21.423

伪如下：

```
if document.getElementById.style is visible    

then 

document.getElementById.val() == "new value" 
```

对？？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-17T19:48:51.677

如果`visibility:hidden`您的意思是 CSS 属性，那么可以，可以像修改任何其他元素一样修改它。

```
document.getElementById('controlID').value = 'new value'; 
```

但是，如果您谈论的是具有该`Visible=False`属性的 ASP.NET 控件，则此元素甚至不会呈现在页面上，因此不可编辑。

编辑：根据您的评论，您尝试过：

```
$('mydiv').val("blah blah"); 
```

这段代码的问题是你忘记了你的`#`，它向 jQuery 选择器指定你正在寻找一个带有 id 的元素`mydiv`。没有`#`，这意味着您正在寻找 type 的元素`<mydiv>`，它不会匹配任何东西。试试这个：

```
$('#mydiv').val("blah blah"); 
```

# dependency-injection - Ninject：使用哪种注入模式来注入多个依赖项？

> ID：12465918
> 
> 赞同：3
> 
> 时间：2012-09-17T19:30:33.727
> 
> 标签：dependency-injection, ninject

如果我有 10 个依赖项，我需要注入并且不想在构造函数中有 10 个参数，我应该使用哪种注入模式？

```
public class SomeClass
{
    private IDependency1 _dependency1;
    private IDependency2 _dependency2;
    private IDependency3 _dependency3;
    //...
} 
```

我应该使用setter方法注入吗？

```
public class SomeClass
{
    private IDependency1 _dependency1;
    private IDependency2 _dependency2;
    private IDependency3 _dependency3;
    //...

    [Inject]
    public void SetDependency1(IDependency1 dependency1)
    {
        _dependency1 = dependency1;
    }
    //...
} 
```

还是属性注入？

```
public class SomeClass
{
    [Inject]
    public IDependency1 Dependency1 { private get; set; }
    [Inject]
    public IDependency2 Dependency2 { private get; set; }
    [Inject]
    public IDependency3 Dependency3 { private get; set; }
    //...
} 
```

根据 Ninject wiki，只写像上面这样的属性被认为是不好的做法，但它与上面的 setter 方法注入不一样，只是代码更少吗？

对于这种情况，哪种模式最有意义？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-18T11:58:30.533

构造函数注入始终是进行依赖注入的首选方式。只有在无法进行构造函数注入时才应该恢复到属性注入，例如，在处理依赖循环时（其中 A 依赖于 B，B 依赖于 A）。

您可能会问这个问题的原因是，您在编写和维护具有这么多参数的构造函数时变得不舒服。

拥有这么多参数是一种反模式（[构造函数过度注入反模式](http://jeffreypalermo.com/blog/constructor-over-injection-smell-ndash-follow-up/)），但解决此问题的方法不是回退到属性注入。一般来说，当有这么多依赖时，有问题的类会做很多事情。它违反了[单一职责原则](http://en.wikipedia.org/wiki/Single_responsibility_principle)。在违反 SRP 时，拥有数量令人尴尬的依赖项实际上是最少的问题。违反 SRP 的代码更难理解、维护和测试。我可以谈谈经验。每次我发现自己对为课程编写单元测试感到不舒服时，我的设计就有问题。除了 SRP 之外，还有其他四个重要原则，分组在[SOLID](http://en.wikipedia.org/wiki/SOLID_%28object-oriented_design%29)首字母缩略词。遵循这些原则，您将成为拥有更多可维护软件的更快乐的程序员。

当一个类违反 SRP 时，通常这意味着它应该被分成多个类，每个类都有一个单一的职责。当你这样做时，你会看到依赖的数量减少了。

# php - Amazon AWSSDKforPHP 太慢了

> ID：12465919
> 
> 赞同：5
> 
> 时间：2012-09-17T19:30:41.607
> 
> 标签：php, amazon-s3, amazon-web-services

Amazon AWSSDKforPHP 太慢了

你好呀，

我正在使用 Amazon AWSSDKforPHP 将我的 Web 应用程序与 S3 连接起来。但是，该过程或向服务发出请求时存在问题，导致速度太慢。

例如，我有这个代码：

```
// Iterate an array of user images
foreach($images as $image){
    // Return the Bucket URL for this image
    $urls[] = $s3->get_object_url($bucket, 'users/'.trim($image).'.jpg', '5 minutes');
} 
```

假设 $images 是一个用户图片数组，这将返回一个名为 $urls 的数组，该数组具有（正如他的名字所说）带有 5 分钟凭据的图片的 URL。这个请求至少需要 6 秒，包含 35 张图像，没关系。但是....当存储桶中不存在图片时，我想为用户分配一个默认图像，例如“images/noimage.png”。这是代码：

```
// Iterate an array of user images
foreach($images as $image){

    // Check if the object exists in the Bucket
    if($s3->if_object_exists($bucket, 'users/'.trim($image).'.jpg')){
        // Return the Bucket URL for this image
        $urls[] = $s3->get_object_url($bucket, 'users/'.trim($image).'.jpg', '5 minutes');
    } else { 

        // Return the default image
        $urls[] = 'http://www.example.com/images/noimage.png';
    }

} 
```

条件有效，但慢。在条件“$s3->if_object_exists()”的情况下，该脚本至少需要 40 秒才能处理 35 张图像！

我修改了我的脚本，使用 cURL 发出请求：

```
// Iterate an array of user images
foreach($images as $image){

    // Setup cURL
    $ch = curl_init($s3->get_object_url($bucket, 'users/'.trim($image).'.jpg', '1 minutes') );
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    $response = curl_exec($ch);
    // Get Just the HTTP response code
    $res = curl_getinfo($ch,CURLINFO_HTTP_CODE);

    if($res == 200){ //the image exists
        $urls[] = $s3->get_object_url($bucket, 'users/'.trim($image).'.jpg', '5 minutes');
    }else{ // The response is 403
        $urls[] = 'http://www.example.com/images/noimage.png';
    }
} 
```

而这个修改后的脚本需要 16 到 18 秒。这是一个很大的区别，但仍然需要很多时间:(。

拜托，非常感谢任何帮助。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T19:37:05.400

为什么不改变您进行检查的方式。将图像的位置/存储桶本地存储在数据库中，这样您就不必担心此检查？

通过这种方式，您可以最大限度地减少您正在执行的 API 调用数量，在您的情况下为 35，但这可能会随着时间的推移呈指数级增长。而且，您不仅要对每张图像进行一次调用，而且在大多数情况下每张图像进行两次调用。这是非常低效的并且依赖于您的网络连接相当快。

就该区域的性能而言，移动位置数据以及图像是否存在于本地是一个更好的选择。此外，如果您提前存储结果，则只需执行一次检查即可。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-05T07:19:48.670

这很慢，因为您在[`if_object_exists()`](http://docs.amazonwebservices.com/AWSSDKforPHP/latest/#m=AmazonS3/if_object_exists)循环中的每次迭代中都进行了调用，从而启动了对 AWS 的网络请求。

用户“thatidiotguy”说：

> 我不了解 S3 API，但您能否要求提供存储桶中的文件列表并在脚本中自己进行字符串匹配/搜索？在 PHP 脚本中，34 个字符串匹配测试不可能花费这么长的时间。

他是对的。

除了调用`if_object_exists()`，您可以调用`get_object_list()`一次（在脚本的开头），然后使用 PHP 的`in_array()`函数将您的用户照片 URL 与列表进行比较。

您应该会看到大约百分之几的加速。不过，不要引用我的话。;)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T20:29:12.497

我认为，如果您希望能够从 S3 读取目录类型的信息，最好使用 s3fs 之类的东西将存储桶挂载为系统驱动器。s3fs 也可以配置本地缓存以加快速度（如果您使用的是 EC2，则缓存在快速临时存储上）。

这将允许您轻松地进行常规 PHP 目录处理（DirectoryIterator 等）。

如果这超出了您的要求，至少将文件名数据存储在数据库中，并且只期望文件位于适当的 S3 位置，或者以某种方式在本地缓存单个 API 检查的结果，以便不需要每个类似请求的 API 调用。

# python - Python中的参数命名约定

> ID：12465921
> 
> 赞同：3
> 
> 时间：2012-09-17T19:31:01.437
> 
> 标签：python, coding-style, naming-conventions

对于形式参数密切相关的函数，例如

```
def add_two_numbers(n1, n2):
    return n1 + n2

def multiply_two_numbers(n1, n2):
    return n1 * n2 
```

如上所示，为两个函数中的参数赋予相同的名称是一个好主意吗？

另一种方法是重命名函数之一中的参数。例如：

```
def add_two_numbers(num1, num2):
    return num1 + num2 
```

在两个函数中保持它们相同看起来更一致，因为每个函数采用的参数是相似的，但这更令人困惑吗？

同样，对于下面的示例，哪个更好？

```
def count(steps1, steps2):
    a = 0
    b = 0

    for i in range(steps1):
        a += 1

    for j in range(steps2):
        b += 1

    return a, b

def do_a_count(steps1, steps2):
    print "Counting first and second steps..."
    print count(steps1, steps2) 
```

否则，更改第二个函数中的参数会给出：

```
def do_a_count(s1, s2):
    print "Counting first and second steps..."
    print count(s1, s2) 
```

同样，我有点不确定哪种方式最好。保持相同的参数名称使两个函数之间的关系更清晰，而第二个意味着两个函数中的参数没有混淆的可能性。

我做了一些搜索（包括浏览 PEP-8），但找不到明确的答案。（我发现的关于 SO 的类似问题包括： [Python 函数中可选参数的命名实践](https://stackoverflow.com/questions/5369576/naming-practice-for-optional-argument-in-python-function) 和 [在 Python 中，避免对 __init__ 参数和实例变量使用相同名称的最佳方法是什么？](https://stackoverflow.com/questions/5821387/in-python-whats-the-best-way-to-avoid-using-the-same-name-for-a-init-argum)）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-17T19:33:14.540

除非您有充分的理由使用不同的名称，否则我会保持名称相同......请记住，即使是位置参数也可以通过关键字调用，例如：

```
>>> def foo(a,b):
...     print a
...     print b
... 
>>> foo(b=2,a=1) 
```

保持“关键字”相同有助于解决这种罕见但合法的极端情况......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T20:16:55.500

一般来说，你应该给你的函数的参数起一个有意义的名字，当你选择这些名字时，甚至不要考虑与其他函数有任何关系。两个函数的参数名称之间根本没有任何关系，即使函数做了类似的事情。

虽然......如果函数*做*类似的事情，也许这表明你错过了重构？:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T20:17:26.357

这里的重要指导原则是您应该给它们起合理的名称——理想情况下，当您一年后回到您的代码时，您会猜到参数具有的名字。

每个程序员都有一套约定。有些人喜欢将整数参数调用为二进制函数`n1`和`n2`; 其他人喜欢`n`，`m`; 或`lhs`, `rhs`; 或者是其他东西。只要你选择一个并坚持下去（只要它是合理的），其他任何人都可以阅读你的代码，并在几秒钟内了解你的风格后理解它。如果你到处使用不同的名字，他们将不得不做更多的猜测。

正如 mgilson 指出的那样，这允许您根据需要使用关键字参数。这也意味着具有自动完成功能的 IDE 更有用——当您看到`(…n1…, …n2…)`弹出窗口时，您就知道您想要传递两个整数。但主要是为了可读性。

当然，如果有不同的含义，就给他们不同的名字。`add_two_numbers(augend, addend)`在某些情况下，拥有和可能是合理的`multiply_two_numbers(factor, multiplicand)`。

# c# - 最大化拉伸画布

> ID：12465922
> 
> 赞同：0
> 
> 时间：2012-09-17T19:31:16.630
> 
> 标签：c#, wpf, wpf-controls

（无法添加图片，所以我会尝试解释它）所以我的程序基本上由两部分组成：一个扫描并显示在主窗口（在画布上）的位图图像，以及我制作的画布派生类基本上从图像中获取数据（b&w 值范围为 0-255）并以直方图格式（基本上是条形图）表示它，并覆盖位图图像（它是透明的，因此您仍然可以看到图像）。

好吧，所以我的程序开始工作了，唯一的问题是我的画布派生类在我“刷新”屏幕之前不会伸展。班级的孩子（窗户形状的矩形）不会随着窗户伸展。

到目前为止看起来还不错

但后来我最大化它......

然后，这些矩形恰好停留在它们所在的位置。直到我点击“显示直方图”按钮，它才会消失，然后再次点击它，我得到......

...正是我想要的，直方图在屏幕上的正确位置。所以这是我的问题，我怎样才能让直方图与主窗口一起拉伸？而不是每次都刷新它？

```
<Border Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="3" BorderBrush="Black" BorderThickness="5" x:Name="testview">
        <local:DrawingCanvas x:Name="pbHistogram" IsHitTestVisible="False"
                                Width="Auto"
                Background="Transparent"
                Height ="{Binding Path=ActualHeight, ElementName=testview}"/>
    </Border> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T20:27:57.597

也许最快、最简单的方法就是把你的画布放在一个 Viewbox 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T07:09:18.297

我知道这不是一个真正的答案，但我认为问题在于画布类本身。它没有自动布局或调整其子元素的大小。链接到 msdn： http: [//msdn.microsoft.com/en-us/library/ms609101 (v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/ms609101(v=vs.100).aspx)

您可以尝试连接到主窗口的调整大小事件并调用 buttonpress 调用的相同函数。

# zend-framework - 如何创建一个zend表单对象？

> ID：12465925
> 
> 赞同：1
> 
> 时间：2012-09-17T19:31:25.703
> 
> 标签：zend-framework, zend-form

在我的用户控制器中，我有一个 editAction。以下声明来自editAction。

```
$form = $this->_getEditForm();//here I need to pass $user->email to the form class. 
```

我在同一个控制器中有另一个类 _gerEditForm() 。

```
 private function _getEditForm()
   {
    $form = new Form_Admin_Users_Add(array(
            'method' => 'post',
            'action' => $this->_helper->url('edit', 'users'),

    ));
    return $form;
   }
enter code here 
```

//表单类

```
class Form_Admin_Users_Add extends Form_Abstract
{

    public function __construct($mail=null)
    {
        parent::__construct();
        $this->setName('user');
        //$userId = new Zend_Form_Element_Text('userId');
        //$userId->addFilter('Int');
        //$this->addElement($userId);

        $this->setAttrib('id', 'addUserForm');
        $this->setAttrib('class', 'formInline');

        $firstName = new Zend_Form_Element_Text('firstName');
        $firstName->setRequired(true)
        ->addFilter('StringTrim')
        ->addValidator('NotEmpty', false, array('messages'=>'First name cannot be empty'))
        ->addValidator('StringLength', false, array(1, 256))
        ->setLabel('First Name:');
        $this->addElement($firstName);

        $lastName = new Zend_Form_Element_Text('lastName');
        $lastName->setRequired(true)
        ->addFilter('StringTrim')
        ->addValidator('NotEmpty', false, array('messages'=>'Last name cannot be empty'))
        ->addValidator('StringLength', false, array(1, 256))
        ->setLabel('Last Name:');
        $this->addElement($lastName);

        $email = new Zend_Form_Element_Text('email');
        $email->setLabel('Email :')
        ->addValidator('NotEmpty', false, array('messages'=>'email cannot be empty'))
        ->addFilter('StripTags')
        ->addFilter('StringTrim')
        ->addValidator('EmailAddress')
        ->addValidator(new BusinessForum_Validate_UniqueEmail($mail)); 
```

现在我需要将电子邮件传递给表单类。但我不知道该怎么做。请在这方面帮助我。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T20:02:10.700

我有点困惑。该`__construct`函数接受一个参数，`$mail`。你把它传给你的`BusinessForum_Validate_UniqueEmail`班级。

但是在您的`_getEditForm`函数中，您将一个数组传递给该`$mail`参数，看起来它具有表单设置，而不是电子邮件信息。

如果这就是你命名东西的方式，那就是它的工作方式，很好。然后你应该只需要在你的`__construct`函数中添加第二个参数：

```
public function __construct($mail=null, $emailAddress="") 
```

从您的`_getEditForm`函数中传递它：

```
private function _getEditForm($emailAddress="")
{
    $form = new Form_Admin_Users_Add(array(
        'method' => 'post',
        'action' => $this->_helper->url('edit', 'users')
    ), $emailAddress);
    return $form;
} 
```

并将电子邮件地址传递给您的`_getEditForm`函数：

```
$form = $this->_getEditForm($user->email); 
```

# python - 在 Google App Engine 中编码 PKCS7（python、passbook）

> ID：12465931
> 
> 赞同：3
> 
> 时间：2012-09-17T19:31:41.603
> 
> 标签：python, google-app-engine, encryption, pkcs#7, passbook

这个问题与接下来几天处于 NDA 下的 Passbook 有关，但这是一个通用的 PKCS7 问题。

我有一个从我的钥匙串中导出的 .p12 文件。我可以使用以下命令将其分成 2 个 pem

```
openssl pkcs12 -in "mycert.p12" -clcerts -nokeys -out certificate.pem
openssl pkcs12 -in "mycert.p12" -nocerts -out key.pem 
```

下一步是使用此密钥和证书创建签名的 PKCS7 文件。使用 openssl 很容易做到这一点：

```
openssl smime -binary -sign \
    -signer certificate.pem -inkey key.pem \
    -in <datafile> -out signature \
    -outform DER 
```

问题是，假设我有证书和密钥，在 Google App Engine 中执行此操作的最佳方法是什么？不幸的是，我对密码学有点陌生，但我一直在谷歌搜索，发现 PyCrypto 和 keyczar。在 App Engine 上是否有一种可接受的方式来执行此操作，或者我需要写一些东西吗？关于从哪个包开始有什么建议吗？
我知道 Openssl 在 AppEngine 上不可用，但如果您使用 python 2.7，PyCrypto 是可用的，对吗？我已经看到人们让 keyczar 使用它的帖子。不过，在给定密钥和证书的情况下，我还没有找到一种生成 PKCS7 编码数据的简单方法。

提前感谢您的任何指导。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T14:34:32.617

这是一种使用取自[https://github.com/devartis/passbook的 M2Crypto 的方法](https://github.com/devartis/passbook)

```
def passwordCallback(*args, **kwds):
    return password

smime = SMIME.SMIME()
smime.load_key('key.pem', 'certificate.pem', callback=passwordCallback)        
pk7 = smime.sign(SMIME.BIO.MemoryBuffer(manifest), flags=SMIME.PKCS7_DETACHED | SMIME.PKCS7_BINARY)                
pem = SMIME.BIO.MemoryBuffer()
pk7.write(pem)
# convert pem to der
der = ''.join(l.strip() for l in pem.read().split('-----')[2].splitlines()).decode('base64')        

open('signature', 'w').write(der) 
```

# spring - 带有 Spring 3.1 控制器单元测试的 NoClassDefFoundError

> ID：12465932
> 
> 赞同：1
> 
> 时间：2012-09-17T19:31:43.710
> 
> 标签：spring, model-view-controller, junit4, noclassdeffounderror

我有一个简单的`autowired`控制器和一个测试。当项目使用 mvn 和代码覆盖目标 emma:emma 和 emma:check 构建时，测试用例失败并出现以下错误。

简单的“mvn test”命令成功。“mvn 测试艾玛：艾玛艾玛：检查”失败。

```
java.lang.NoClassDefFoundError: org/springframework/web/bind/support/WebDataBinderFactory 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T01:31:24.703

尝试使用 cobertura，将其添加到您的报告部分：

```
<reporting>
    <plugins>
        <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>cobertura-maven-plugin</artifactId>
            <version>2.5.1</version>
            <configuration>
              <check>
                <lineRate>120</lineRate>
              </check>
            </configuration>
        </plugin>
    </plugins>
</reporting> 
```

然后做：

```
mvn site 
```

然后在浏览器中打开：

```
target/site/index.html 
```

您将在那里看到 cobertura 报告。最好将这些插件添加到您的父 pom.xml 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T15:28:58.560

你在测试中是否有 spring-web 的依赖。如果没有，然后尝试添加依赖`org.springframework:spring-web`

# asp.net - 基于 SqlSiteMapProvider 的菜单需要刷新

> ID：12465935
> 
> 赞同：0
> 
> 时间：2012-09-17T19:32:06.877
> 
> 标签：asp.net, sql-server, sitemap

在 ASP .Net 4.0 Web Forms 'Site' 项目中：我的母版页上有一个菜单，其中填充了 SqlSiteMapProvider。它可以工作，但有时需要手动刷新浏览器才能真正出现在屏幕上。

页面标记：

```
<div class="clear hideSkiplink">
    <asp:SiteMapDataSource ID="SiteMapSource" runat="server" ShowStartingNode="false" />
    <asp:Menu ID="NavigationMenu"  runat="server" DataSourceID="SiteMapSource" CssClass="menu" EnableViewState="false"     IncludeStyleBlock="false" Orientation="Horizontal">
</asp:Menu>                
</div> 
```

我知道连接和配置是正确的，因为点击刷新后一切正常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T19:33:43.007

调整 `EnableViewState="true"`以在不绑定每个负载或帖子的情况下持续存在。

尝试

```
<div class="clear hideSkiplink">
    <asp:SiteMapDataSource ID="SiteMapSource" runat="server" ShowStartingNode="false" />
    <asp:Menu ID="NavigationMenu"  runat="server" DataSourceID="SiteMapSource" 
    CssClass="menu" 

EnableViewState="true"     

    IncludeStyleBlock="false" 
    Orientation="Horizontal">
</asp:Menu>                
</div> 
```

链接：http: [//msdn.microsoft.com/en-us/library/ms972976.aspx#viewstate_topic5](http://msdn.microsoft.com/en-us/library/ms972976.aspx#viewstate_topic5)

# macos - CFBundleTypeIconFile 图标未显示给定文件扩展名

> ID：12465937
> 
> 赞同：7
> 
> 时间：2012-09-17T19:32:19.093
> 
> 标签：macos, cocoa

我的应用程序有以下 Info.plist，问题是我用扩展名 myapp 保存的文件似乎没有在我从图标集创建的 MyApp 图标上找到（应用程序正确使用图标）所以猜测有什么plist 中的错误。

我假设如果我在运行我的应用程序时得到这个工作，我保存的文档会突然显示给定的图标。

万一这很重要，文档是从一组基于 NSCoder 的类中保存的。单击这些文档还会打开我的应用程序并正确加载文件，所以很困惑我缺少什么来让图标显示在文件上......

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
    <key>CFBundleDevelopmentRegion</key>
    <string>en</string>
    <key>CFBundleDocumentTypes</key>
    <array>
        <dict>
            <key>CFBundleTypeExtensions</key>
            <array>
                <string>myapp</string>
            </array>
            <key>CFBundleTypeIconFile</key>
            <string>MyApp</string>
            <key>CFBundleTypeOSTypes</key>
            <array>
                <string>ASWM</string>
            </array>
            <key>CFBundleTypeName</key>
            <string>MyApp project file</string>
            <key>CFBundleTypeRole</key>
            <string>Editor</string>
        </dict>
    </array>
    <key>CFBundleExecutable</key>
    <string>${EXECUTABLE_NAME}</string>
    <key>CFBundleIconFile</key>
    <string>MyApp</string>
    <key>CFBundleIdentifier</key>
    <string>com.workmonkeys.${PRODUCT_NAME:rfc1034identifier}</string>
    <key>CFBundleInfoDictionaryVersion</key>
    <string>6.0</string>
    <key>CFBundleName</key>
    <string>${PRODUCT_NAME}</string>
    <key>CFBundlePackageType</key>
    <string>APPL</string>
    <key>CFBundleShortVersionString</key>
    <string>1.0</string>
    <key>CFBundleSignature</key>
    <string>ASWM</string>
    <key>CFBundleVersion</key>
    <string>1</string>
    <key>LSApplicationCategoryType</key>
    <string>public.app-category.developer-tools</string>
    <key>LSMinimumSystemVersion</key>
    <string>${MACOSX_DEPLOYMENT_TARGET}</string>
    <key>NSHumanReadableCopyright</key>
    <string>Copyright © 2012 Me. All rights reserved.</string>
    <key>NSMainNibFile</key>
    <string>MainMenu</string>
    <key>NSPrincipalClass</key>
    <string>NSApplication</string>
</dict>
</plist> 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-17T20:53:27.590

原来，当我最初创建我的应用程序时，系统必须缓存了 plist 的旧副本。所需要的只是重建启动服务数据库。

我使用了此处记录的 lsregister 命令...

[http://www.tuaw.com/2009/06/11/terminal-tips-rebuild-your-launch-services-database-to-clean-up/](http://www.tuaw.com/2009/06/11/terminal-tips-rebuild-your-launch-services-database-to-clean-up/)

重新运行应用程序并宾果游戏文档现在具有关联的相应图标。

# c - WAIT 不等待孩子

> ID：12465939
> 
> 赞同：1
> 
> 时间：2012-09-17T19:32:24.990
> 
> 标签：c, fork, wait, pid

```
#include <stdio.h>
#include <sys/types.h>
#include <unistd.h>
#include <assert.h>
#include <stdlib.h>
#include <sys/wait.h>
#include <string.h>

char *getdir()  /*find working directory*/
{
  char *buffer;/*buffer is going to be used in getcwd function to get the current directory*/
  char *path_buffer;//path_buffer is going to contain the directory//
  long maxsize = pathconf(".", _PC_PATH_MAX);/* we set maxsize as the maximum pathname length*/
  if((buffer=(char*) malloc((size_t)maxsize))!=NULL)
    {
      path_buffer=getcwd(buffer,maxsize); /*get the current directory*/
      printf("\nMy working directory = %s",path_buffer);
      return path_buffer;
    }
  else{
    exit(-1);
  }
}

char * getcmline() /*get command from stdin by the user*/
{
  int bytes_read;
  int nchars=200;/*max possible number for the input of the user*/
  int nbytes=(sizeof(char))*nchars; /*size of chars in bytes*/
  char *line=(char*) malloc(nbytes+1);
  bytes_read=getline(line,&nbytes,stdin);/*read line from stdin*/
  if(bytes_read == -1){
    printf("Read line error");
    exit(-1);
  } /*error handling for bytes_read*/
  else{
    if(line[strlen(line)-1]=='\n')
      {
        line[strlen(line)-1]='\0'; /*change new line character in the end of the line of stdin*/
      }
  }
  return line;
}

int main(void)
{
  pid_t pid,child_pid;
  int rv=0;
  char* exit_string="exit";
  char *path_buffer=NULL;
  int nchars=200;
  int nbytes=(sizeof(char))*nchars;
  char *line=malloc(nbytes+1);
  char *commands[2];
  while(1){
    switch(pid = fork())
      {
      case -1:
        perror("fork"); /* something went wrong */
        exit(1);
      case 0:
        printf(" CHILD: This is the child process!\n");
        child_pid=getpid();
        printf(" CHILD: My PID is %d\n", child_pid);
        path_buffer=getdir();/*get the directory path*/
        line=getcmline();/*get a command by the user*/
        if(strcmp(line,exit_string)==0)
          {
            rv=3;
            exit(rv);
          }
        commands[0]=line;
        commands[1]=NULL;
        execvp(commands[0],commands);
        perror("Execution error");
        exit(-1);

      default:
        waitpid(-1, &rv, 0);
        if(WIFEXITED(rv)){
          printf("Child exited normally and child's exit status is: %d\n", WEXITSTATUS(rv));
          if((WEXITSTATUS(rv))==3){
            exit(1);
          }
        }
      }
  }
  return 0;
} 
```

我在 中进行了更改`getline`，`rv`并为`execvp`. 但是现在发生的错误是在我输入例如“ls”之后。它说：

> 执行错误：没有这样的文件或目录。

再次感谢您的帮助和我缺乏知识。

错误似乎在行变量中，但我无法理解问题所在！

[C中的字符数组和getline](https://stackoverflow.com/questions/12468994/char-array-and-getline-in-c/12469542?iemail=1#12469542)

这里给出了解决方案。它应该是 line[(strlen)-1] 而不是 line[(strlen-1)]

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T19:39:58.523

父母永远不会得到孩子的 pid，因此 waitpid 不会等待它。waitpid(-1,...) 将等待任何子进程完成后再继续。

我还建议缩进 case 并以 break 结束每个 case 语句；

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T21:06:13.200

所以，对于警告：你*知道*这些数字指的是什么行，我不得不猜测：你可以让这更容易！

```
int rv=NULL; 
```

> 初始化从没有强制转换的指针生成整数 [默认启用] 第 42 行

NULL 是一个指针值，rv 是一个整数。`0`如果这就是您的意思，请将其设置为。

```
execvp(line[0],line); 
```

> 传递 'execv' 的参数 1 使指针从没有强制转换的整数 [默认启用] 第 64 行从不兼容的指针类型 [默认启用] 第 64 行传递'execv' 的参数 2

如果您正在调用`execv`，则您正在编译的代码*不是*您发布的代码。然而 ...`line`是 a `char *`，`line[0]`a 也是`char`。`execv`or的第一个参数`execvp`是`const char *`。

execv 试图完成什么？它需要一个程序名称来运行（第一个参数，const char *）和一个参数数组（这些将形成`argv[]`传递给新程序`main`函数的数组，并且数组中的最后一项必须为 NULL）。

```
char *line=(char*) malloc(nbytes+1);
bytes_read=getline(&line,&nbytes,stdin);/*read line from stdin*/ 
```

> 从不兼容的指针类型[默认启用]第 29 行传递“getline”的参数 2

`getline`需要缓冲区的地址才能将字符放入......`line` *就是*这样一个地址。`&line`但是，是*指针的地址*。只需取出`&`.

* * *

您的代码中存在更多问题，但这些警告都有一些共同点：

*   你似乎不明白函数需要什么类型，
*   你的变量是什么类型，
*   你实际传递的是什么类型，
*   或者编译器抱怨您的类型不匹配时的含义

在开始尝试编写多进程程序*之前*，您需要了解这一点。*用一些简单*的东西来学习它，学习阅读文档，并理解编译器警告。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T19:41:56.847

```
default:
waitpid(child_pid, &status, 0);
//wait(&rv);
printf("PARENT:My child's exit status is: %d\n", WEXITSTATUS(rv));
if((WEXITSTATUS(rv))==3){exit(1);} 
```

您将未初始化的变量传递`child_pid`给`waitpid`，该变量仅在子进程中设置。你应该通过`pid`。使用未初始化的变量会导致未定义的行为，因此无法预测会发生什么。`WEXITSTATUS`你也用另一个未初始化的变量调用`rv`，你应该通过`status`那里。

孩子在这里什么都不做，因为

```
path_buffer=getcwd(buffer,sizeof(buffer)); 
```

传递给的 size 参数`getcwd`是 a 的大小`char*`，通常是 4 或 8 个字节，这对于大多数目录的绝对路径来说太短了，`path_buffer is set to`NULL `and the child immediately exits. You should pass the size of the buffer,`maxsize` 在那里。

# .net - 如何从 DirectX for Managed Code (VB.Net) 中的 DeviceLostException 中恢复？

> ID：12465941
> 
> 赞同：2
> 
> 时间：2012-09-17T19:32:32.310
> 
> 标签：.net, vb.net, graphics, directx

注意：（我知道托管代码的 DX 已被弃用，我计划在获得一些额外时间时使用 SlimDX 重写代码。）我在尝试处理 DeviceLostException 时遇到了很多麻烦。与大多数 DX 应用程序不同，我不会持续渲染帧，我只会在屏幕上的内容需要更改时才渲染。这使得遵循处理 DeviceLostExceptions 的指南有点棘手。我正在编写一个程序，它使用 Nvidia 的 3D Vision 技术来显示立体图像。我的显示类是拉伸到全屏的无边框窗口窗体类。我有一个名为 BaseStimulusDisplay 的基类，它设置基本表单和 DirectX 设备，然后我从它继承以创建用于显示立体图像的 StereoStimulusDisplay 对象。（我这样做是因为我有一些其他类型的显示用于程序的不同方面。）该类的工作方式是我有两个对象列表（stereoObjects 和 singleEyeObjects），它们基本上只是包含一些 DX 表面和一些位置的对象信息来确定应在屏幕上绘制表面的位置。当我想在屏幕上显示对象时，我调用 RenderScene 方法，该方法循环遍历对象列表中的每个对象，并使用 StretchRectangle 方法将对象表面绘制到后台缓冲区，然后调用 preset()。为了尝试处理 DeviceLostException，我将位于 Render Scene 方法末尾的 device.Present() 放在一个如下所示的 try 块中：) 类的工作方式是我有两个对象列表（stereoObjects 和 singleEyeObjects），它们基本上只是包含一些 DX 表面和一些位置信息的对象，以确定表面应该在屏幕上绘制的位置。当我想在屏幕上显示对象时，我调用 RenderScene 方法，该方法循环遍历对象列表中的每个对象，并使用 StretchRectangle 方法将对象表面绘制到后台缓冲区，然后调用 preset()。为了尝试处理 DeviceLostException，我将位于 Render Scene 方法末尾的 device.Present() 放在一个如下所示的 try 块中：) 类的工作方式是我有两个对象列表（stereoObjects 和 singleEyeObjects），它们基本上只是包含一些 DX 表面和一些位置信息的对象，以确定表面应该在屏幕上绘制的位置。当我想在屏幕上显示对象时，我调用 RenderScene 方法，该方法循环遍历对象列表中的每个对象，并使用 StretchRectangle 方法将对象表面绘制到后台缓冲区，然后调用 preset()。为了尝试处理 DeviceLostException，我将位于 Render Scene 方法末尾的 device.Present() 放在一个如下所示的 try 块中：当我想在屏幕上显示对象时，我调用 RenderScene 方法，该方法循环遍历对象列表中的每个对象，并使用 StretchRectangle 方法将对象表面绘制到后台缓冲区，然后调用 preset()。为了尝试处理 DeviceLostException，我将位于 Render Scene 方法末尾的 device.Present() 放在一个如下所示的 try 块中：当我想在屏幕上显示对象时，我调用 RenderScene 方法，该方法循环遍历对象列表中的每个对象，并使用 StretchRectangle 方法将对象表面绘制到后台缓冲区，然后调用 preset()。为了尝试处理 DeviceLostException，我将位于 Render Scene 方法末尾的 device.Present() 放在一个如下所示的 try 块中：

```
 Try
        Me._device.Present()
    Catch ex As DeviceLostException
        'Indicate that the device has been lost
        deviceIsLost = True
        'Send a message to the debug output that the device was lost
        Debug.WriteLine("Device was lost... Attempting to recover device")
        waitForDeviceRecovery()
        renderScene()
    End Try 
```

这是waitForDeviceRecovery。我确保在调用 device.Reset() 之前处理所有使用视频内存的对象，并在调用后重新分配表面。

```
Public Overridable Sub waitForDeviceRecovery()
    Do
        Try
            _device.TestCooperativeLevel()
        Catch ex As DeviceLostException

        Catch ex2 As DeviceNotResetException
            Try
                For Each Val As StereoObject In stereoObjectList
                    Val.Dispose()
                Next
                For Each Val As SingleEyeImage In singleEyeList
                    Val.Dispose()
                Next

                Me._offScreenSurface.Dispose()
                Me._backBuffer.Dispose()
                Me._blankScreenSurface.Dispose()
                Me._leftEyeSurface.Dispose()
                Me._rightEyeSurface.Dispose()
                Me._backBuffer.Dispose()

                _device.Reset(presentParams)
                deviceIsLost = False

                For Each Val As StereoObject In stereoObjectList
                    Val.loadSurfaces(Val.objName)
                Next
                For Each Val As SingleEyeImage In singleEyeList
                    Val.loadSurface(Val.objName)
                Next
                createSurfaces()

                'Send a message to debug out put that the device was recovered
                Debug.WriteLine("The device was successfully recoverd")
            Catch ex As DeviceLostException

            End Try
        End Try
    Loop Until deviceIsLost = False
End Sub 
```

现在，如果我运行代码并按 Alt-Tab 循环浏览我打开的程序并返回到 DX 应用程序，则代码在 renderScene 方法的下一行崩溃，并出现 InvalidCallException；

```
 Me._device.ColorFill(Me._leftEyeSurface, New Rectangle(0, 0, Me._size.Width, Me._size.Height), color) 
```

此外，如果我 Alt-Tab 进入另一个程序（不仅仅是循环通过应用程序列表返回我的应用程序）然后尝试恢复应用程序。该程序永远不会恢复它只是卡在 waitForDeviceRecovery 方法的 do 循环中。我的意思是 device.TestCooperativeLevel() 调用不断抛出 DeviceLostException 而不是 DeviceNotResetException。我正在为下面的两个显示类添加完整的代码。

下面是基本刺激显示的代码。

```
Imports System
Imports System.Collections.Generic
Imports System.ComponentModel
Imports System.Data
Imports System.Drawing
Imports System.Text
Imports System.Windows.Forms
Imports System.IO

Imports Microsoft.DirectX
Imports Microsoft.DirectX.Direct3D
Imports Microsoft.DirectX.Direct3D.PresentParameters

Public MustInherit Class BaseStimulusDisplay

Public displaySettings As DisplaySettings
Public _size As Rectangle                                          'Size of screen
Public _device As Device                                           'DX device object to interface with graphics card
Protected _offScreenSurface As Surface                                'Surface on which to draw the SteroScreen images
Protected _blankScreenSurface As Surface                              'Surface of all background color
Protected _backBuffer As Surface                                      'The DX backbuffer
Protected _adapter As Integer = Direct3D.Manager.Adapters.Default.Adapter
Protected presentParams As PresentParameters
Protected deviceIsLost As Boolean = False

Public Sub New(ByVal displaySettings As DisplaySettings)
    'Make windows happy
    Me.components = Nothing
    Me.InitializeComponent()

    Me.displaySettings = displaySettings
    Me._size = New Rectangle(0, 0, Me.displaySettings.xResolution, Me.displaySettings.yResolution)
    MyBase.SetStyle((ControlStyles.AllPaintingInWmPaint Or ControlStyles.Opaque Or ControlStyles.ContainerControl), True)
    Me.InitializeDevice()   'Set the device parameters and create the device

    Invalidate()
End Sub

Public Overridable Sub InitializeDevice()
    presentParams = New PresentParameters
    presentParams.Windowed = False
    presentParams.BackBufferFormat = Format.X8R8G8B8
    presentParams.BackBufferWidth = Me._size.Width
    presentParams.BackBufferHeight = Me._size.Height
    presentParams.BackBufferCount = 1
    presentParams.SwapEffect = Direct3D.SwapEffect.Discard
    presentParams.PresentationInterval = PresentInterval.One
    Me._device = New Device(_adapter, DeviceType.Hardware, CType(Me, Control), CreateFlags.HardwareVertexProcessing, New PresentParameters() {presentParams})
End Sub

Public Overridable Sub createSurfaces()
    Me._offScreenSurface = Me._device.CreateOffscreenPlainSurface(Me._size.Width, Me._size.Height, Format.X8R8G8B8, Pool.Default)
    Me._backBuffer = Me._device.CreateOffscreenPlainSurface(Me._size.Width, Me._size.Height, Format.X8R8G8B8, Pool.Default)
    Me._blankScreenSurface = Me._device.CreateOffscreenPlainSurface(Me._size.Width, Me._size.Height, Format.X8R8G8B8, Pool.Default)
End Sub

Public Overridable Overloads Sub Dispose()
    Me._offScreenSurface.Dispose()
    Me._backBuffer.Dispose()
    Me._blankScreenSurface.Dispose()

    MyBase.Dispose()
End Sub

Public MustOverride Sub renderScene()

Public MustOverride Sub closeDisplay()

End Class 
```

下面是我的 StereoStimulsDisplay 以及 StereoObject 和 SingleEyeObject 的代码：

```
Imports System
Imports System.Collections.Generic
Imports System.ComponentModel
Imports System.Data
Imports System.Drawing
Imports System.Text
Imports System.Windows.Forms
Imports System.IO

Imports Microsoft.DirectX
Imports Microsoft.DirectX.Direct3D
Imports Microsoft.DirectX.Direct3D.PresentParameters

Public Class StereoStimulusDisplay
Private Const colorFormat As Format = Format.A8B8G8R8           'The sufrace color format to use
Private Const poolType As Pool = Pool.Default                   'The sufrace memory pool type NOT SURE WHAT THIS IS FOR

Dim stereoObjectList As List(Of StereoObject)
Dim singleEyeList As List(Of SingleEyeImage)

Dim _leftEyeSurface As Surface
Dim _rightEyeSurface As Surface

Public Sub New(ByVal displaySettings As DisplaySettings)
    MyBase.New(displaySettings)
    InitializeComponent()

    stereoObjectList = New List(Of StereoObject)
    singleEyeList = New List(Of SingleEyeImage)

    createSurfaces()

    renderScene()   'Double render call is a hack to make sure the stereo display gets triggerd
    renderScene()
End Sub

Public Sub addStereoObject(ByRef sObject As StereoObject)
    stereoObjectList.Add(sObject)
End Sub

Public Sub addSingleEyeObject(ByRef sObject As SingleEyeImage)
    singleEyeList.Add(sObject)
End Sub

Public Function removeStereoObject(ByRef sObject As StereoObject)
    sObject.Dispose()
    Return stereoObjectList.Remove(sObject)
End Function

Public Function removeSingleEyeObject(ByRef sObject As SingleEyeImage)
    sObject.Dispose()
    Return singleEyeList.Remove(sObject)
End Function

Public Overrides Sub createSurfaces()
    MyBase.createSurfaces()
    Me._offScreenSurface = Me._device.CreateOffscreenPlainSurface((Me._size.Width * 2), (Me._size.Height + 1), Format.A8R8G8B8, Pool.Default)
    Me._leftEyeSurface = Me._device.CreateOffscreenPlainSurface((Me._size.Width), (Me._size.Height), Format.A8R8G8B8, Pool.Default)
    Me._rightEyeSurface = Me._device.CreateOffscreenPlainSurface((Me._size.Width), (Me._size.Height), Format.A8R8G8B8, Pool.Default)
    Me._blankScreenSurface = Me._device.CreateOffscreenPlainSurface((Me._size.Width * 2), (Me._size.Height + 1), Format.A8R8G8B8, Pool.Default)
End Sub

Public Sub displayBlankScene(ByVal color As Color)
    'Erase the lase frame from surfaces
    Me._device.ColorFill(Me._leftEyeSurface, New Rectangle(0, 0, Me._size.Width, Me._size.Height), color)
    Me._device.ColorFill(Me._rightEyeSurface, New Rectangle(0, 0, Me._size.Width, Me._size.Height), color)

    Dim destRect As New Rectangle(0, 0, Me._size.Width, Me._size.Height)

    'If Not useData Then
    Me._device.StretchRectangle(Me._leftEyeSurface, CType(Me._size, Rectangle), Me._offScreenSurface, CType(destRect, Rectangle), TextureFilter.None)
    destRect.X = Me._size.Width
    Me._device.StretchRectangle(Me._rightEyeSurface, CType(Me._size, Rectangle), Me._offScreenSurface, CType(destRect, Rectangle), TextureFilter.None)
    'End If
    Dim gStream As GraphicsStream = Me._offScreenSurface.LockRectangle(LockFlags.None)
    Dim data As Byte() = New Byte() {78, 86, 51, 68, 0, 15, 0, 0, 56, 4, 0, 0, 32, 0, 0, 0, 2, 0, 0, 0}
    gStream.Seek(CLng((((Me._size.Width * 2) * Me._size.Height) * 4)), SeekOrigin.Begin)
    gStream.Write(data, 0, data.Length)
    gStream.Close()
    Me._offScreenSurface.UnlockRectangle()

    Me._device.BeginScene()

    Me._backBuffer = Me._device.GetBackBuffer(0, 0, BackBufferType.Mono)
    Me._device.StretchRectangle(
        Me._offScreenSurface, CType(New Rectangle(0, 0, (Me._size.Width * 2), (Me._size.Height + 1)), Rectangle),
        Me._backBuffer, CType(New Rectangle(0, 0, Me._size.Width, Me._size.Height), Rectangle), TextureFilter.None)
    Me._backBuffer.ReleaseGraphics()
    Me._device.EndScene()

    Try
        Me._device.Present()
    Catch ex As DeviceLostException
        'Indicate that the device has been lost
        deviceIsLost = True

        'Send a message to the debug output that the device was lost
        Debug.WriteLine("Device was lost... Attempting to recover device")
        waitForDeviceRecovery()
        displayBlankScene(color)
    End Try

    MyBase.Invalidate()
End Sub

Public Overrides Sub renderScene()
    'Erase the last frame from surfaces
    Me._device.ColorFill(Me._leftEyeSurface, New Rectangle(0, 0, Me._size.Width, Me._size.Height), Color.Black)
    Me._device.ColorFill(Me._rightEyeSurface, New Rectangle(0, 0, Me._size.Width, Me._size.Height), Color.Black)

    'Write all steroscopic objects to both eye surfaces
    For Each stereoObj As StereoObject In stereoObjectList
        Me._device.StretchRectangle(stereoObj.leftSurface, CType(stereoObj.leftSourRect, Rectangle), Me._leftEyeSurface, CType(stereoObj.leftDestRec, Rectangle), TextureFilter.None)
        Me._device.StretchRectangle(stereoObj.rightSurface, CType(stereoObj.rightSourRect, Rectangle), Me._rightEyeSurface, CType(stereoObj.rightDestRec, Rectangle), TextureFilter.None)
    Next

    'Write all single eye objects to their proper surface 
    For Each SingleEyeObj In singleEyeList
        If SingleEyeObj.displayEye = SingleEyeImage.EYE.Left Then
            Me._device.StretchRectangle(SingleEyeObj.surface, CType(SingleEyeObj.sourRect, Rectangle), Me._leftEyeSurface, CType(SingleEyeObj.destRec, Rectangle), TextureFilter.None)
        ElseIf SingleEyeObj.displayEye = SingleEyeImage.EYE.Right Then
            Me._device.StretchRectangle(SingleEyeObj.surface, CType(SingleEyeObj.sourRect, Rectangle), Me._rightEyeSurface, CType(SingleEyeObj.destRec, Rectangle), TextureFilter.None)
        ElseIf SingleEyeObj.displayEye = SingleEyeImage.EYE.Both Then
            Me._device.StretchRectangle(SingleEyeObj.surface, CType(SingleEyeObj.sourRect, Rectangle), Me._leftEyeSurface, CType(SingleEyeObj.destRec, Rectangle), TextureFilter.None)
            Me._device.StretchRectangle(SingleEyeObj.surface, CType(SingleEyeObj.sourRect, Rectangle), Me._rightEyeSurface, CType(SingleEyeObj.destRec, Rectangle), TextureFilter.None)
        End If
    Next

    Dim destRect As New Rectangle(0, 0, Me._size.Width, Me._size.Height)

    Me._device.StretchRectangle(Me._leftEyeSurface, CType(Me._size, Rectangle), Me._offScreenSurface, CType(destRect, Rectangle), TextureFilter.None)
    destRect.X = Me._size.Width
    Me._device.StretchRectangle(Me._rightEyeSurface, CType(Me._size, Rectangle), Me._offScreenSurface, CType(destRect, Rectangle), TextureFilter.None)

    Dim gStream As GraphicsStream = Me._offScreenSurface.LockRectangle(LockFlags.None)
    Dim data As Byte() = New Byte() {78, 86, 51, 68, 0, 15, 0, 0, 56, 4, 0, 0, 32, 0, 0, 0, 2, 0, 0, 0}
    gStream.Seek(CLng((((Me._size.Width * 2) * Me._size.Height) * 4)), SeekOrigin.Begin)
    gStream.Write(data, 0, data.Length)
    gStream.Close()
    Me._offScreenSurface.UnlockRectangle()

    Me._device.BeginScene()

    Me._backBuffer = Me._device.GetBackBuffer(0, 0, BackBufferType.Mono)
    Me._device.StretchRectangle(
        Me._offScreenSurface, CType(New Rectangle(0, 0, (Me._size.Width * 2), (Me._size.Height + 1)), Rectangle),
        Me._backBuffer, CType(New Rectangle(0, 0, Me._size.Width, Me._size.Height), Rectangle), TextureFilter.None)
    Me._backBuffer.ReleaseGraphics()
    Me._device.EndScene()

    Try
        Me._device.Present()
    Catch ex As DeviceLostException
        'Indicate that the device has been lost
        deviceIsLost = True
        'Send a message to the debug output that the device was lost
        Debug.WriteLine("Device was lost... Attempting to recover device")
        waitForDeviceRecovery()
        renderScene()
    End Try
    MyBase.Invalidate()

End Sub

Public Overridable Sub waitForDeviceRecovery()
    Do
        Try
            _device.TestCooperativeLevel()
        Catch ex As DeviceLostException

        Catch ex2 As DeviceNotResetException
            Try
                For Each Val As StereoObject In stereoObjectList
                    Val.Dispose()
                Next
                For Each Val As SingleEyeImage In singleEyeList
                    Val.Dispose()
                Next

                Me._offScreenSurface.Dispose()
                Me._backBuffer.Dispose()
                Me._blankScreenSurface.Dispose()
                Me._leftEyeSurface.Dispose()
                Me._rightEyeSurface.Dispose()
                Me._backBuffer.Dispose()

                _device.Reset(presentParams)
                deviceIsLost = False

                For Each Val As StereoObject In stereoObjectList
                    Val.loadSurfaces(Val.objName)
                Next
                For Each Val As SingleEyeImage In singleEyeList
                    Val.loadSurface(Val.objName)
                Next
                createSurfaces()

                'Send a message to debug out put that the device was recovered
                Debug.WriteLine("The device was successfully recoverd")
            Catch ex As DeviceLostException

            End Try
        End Try
    Loop Until deviceIsLost = False
End Sub

Public Overrides Sub closeDisplay()
    For Each val As StereoObject In stereoObjectList
        val.Dispose()
    Next

    For Each val As SingleEyeImage In singleEyeList
        val.Dispose()
    Next

    MyBase.Dispose()
    Dispose()
    Close()
End Sub

Public Shared Function computeDispayableDisparity(ByVal requestedLevel As Double,
                                                  ByVal displaySettings As DisplaySettings,
                                                  ByVal numSubPixelShifts As Integer) As Double
    Dim arcPerSub As Double = displaySettings.arcSecsPerPixel / numSubPixelShifts
    Dim leftOver As Double = requestedLevel Mod arcPerSub
    If leftOver < arcPerSub / 2 Then
        Return requestedLevel - leftOver
    Else
        Return requestedLevel - leftOver + arcPerSub
    End If
End Function
End Class 
```

Public Class StereoObject Public pos As Point Public objName As String Public actualDisparty As Double Public numSubPixelLevels As Integer

```
Private subPixelSurfaces As Surface()
Private subPixelImages As Image()
Private parentDisplay As StereoStimulusDisplay

Public leftDestRec As Rectangle
Public rightDestRec As Rectangle
Public leftSourRect As Rectangle
Public rightSourRect As Rectangle

Public leftSurface As Surface
Public rightSurface As Surface

Public Sub New(ByVal objName As String, ByVal pos As Point, ByVal disparity As Double, ByVal numSubPixelLevels As Integer, ByRef parentDisplay As StereoStimulusDisplay)
    Me.objName = objName
    Me.pos = pos
    Me.numSubPixelLevels = numSubPixelLevels
    Me.parentDisplay = parentDisplay
    ReDim subPixelSurfaces(numSubPixelLevels - 1)
    ReDim subPixelImages(numSubPixelLevels - 1)

    ' Create and load the surfaces for all of the diffrent sub pixels images
    loadSurfaces(objName)
    Me.actualDisparty = updateDisparity(disparity)
End Sub

Public Function updateDisparity(ByVal newDisparty As Double) As Double
    Dim disparityDirection As Integer, pxlDisparity As Double, halfShift As Double, nPixelShift As Integer, fracDisparity As Double
    Dim nSubPixelShift As Integer, halfSubR As Double, halfSubL As Double, pxlR As Integer, pxlL As Integer, subR As Integer, subL As Integer
    Dim actualDisparity As Double

    'disparityDirection + backward;  - forward(crossed)
    If newDisparty > 0.0 Then
        disparityDirection = 1
    Else
        disparityDirection = -1
        newDisparty *= -1
    End If

    Dim test As Double = Me.parentDisplay.displaySettings.arcSecsPerPixel()
    pxlDisparity = newDisparty * Me.parentDisplay.displaySettings.pixelsPerArcSec()
    halfShift = pxlDisparity / 2.0
    nPixelShift = CType(Math.Truncate(halfShift), Integer)
    fracDisparity = halfShift - nPixelShift
    nSubPixelShift = CType(Math.Round(fracDisparity * 32), Integer)
    halfSubR = nSubPixelShift \ 2
    halfSubL = nSubPixelShift - halfSubR
    pxlR = nPixelShift
    subR = halfSubR
    pxlL = -nPixelShift
    If nSubPixelShift = 0 Then
        subL = 0
    Else
        subL = Me.numSubPixelLevels - halfSubL
        pxlL -= 1
    End If
    If pxlR = 0 And subR = 0 And pxlL = 0 And subL = 0 Then
        subR = 1
    End If
    actualDisparity = Me.parentDisplay.displaySettings.arcSecsPerPixel() * (Math.Abs(pxlL * Me.numSubPixelLevels + subL) + Math.Abs(pxlR * Me.numSubPixelLevels + subR)) / Me.numSubPixelLevels
    If actualDisparity = 0 Then
        subR = 1
        actualDisparity = Me.parentDisplay.displaySettings.arcSecsPerPixel() / Me.numSubPixelLevels
    End If

    If disparityDirection > 0 Then
        Me.leftDestRec = New Rectangle(pos.X + pxlL, pos.Y, subPixelImages(subL).Width, subPixelImages(subL).Height)
        Me.rightDestRec = New Rectangle(pos.X + pxlR, pos.Y, subPixelImages(subR).Width, subPixelImages(subR).Height)
        Me.leftSourRect = New Rectangle(0, 0, subPixelImages(subL).Width, subPixelImages(subL).Height)
        Me.rightSourRect = New Rectangle(0, 0, subPixelImages(subR).Width, subPixelImages(subR).Height)

        Me.leftSurface = subPixelSurfaces(subL)
        Me.rightSurface = subPixelSurfaces(subR)
    Else
        Me.leftDestRec = New Rectangle(pos.X + pxlR, pos.Y, subPixelImages(subR).Width, subPixelImages(subR).Height)
        Me.rightDestRec = New Rectangle(pos.X + pxlL, pos.Y, subPixelImages(subL).Width, subPixelImages(subL).Height)
        Me.rightSourRect = New Rectangle(0, 0, subPixelImages(subL).Width, subPixelImages(subL).Height)
        Me.leftSourRect = New Rectangle(0, 0, subPixelImages(subR).Width, subPixelImages(subR).Height)

        Me.leftSurface = subPixelSurfaces(subR)
        Me.rightSurface = subPixelSurfaces(subL)
    End If

    Return actualDisparity
End Function

Public Sub loadSurfaces(ByVal fileName As String)
    Dim name As String = ""
    For i As Integer = 0 To numSubPixelLevels - 1
        name = Application.StartupPath & "\input\StereoObjectFiles\" & fileName & "\" & fileName & "_" & i.ToString() & ".bmp"
        subPixelImages(i) = Image.FromFile(name)
        subPixelSurfaces(i) = Surface.FromBitmap(parentDisplay._device, CType(DirectCast(subPixelImages(i), Bitmap), Bitmap), Pool.Default)
    Next
End Sub

Public Sub Dispose()
    leftSurface.Dispose()
    rightSurface.Dispose()
    For Each surf As Surface In subPixelSurfaces
        surf.Dispose()
    Next

    For Each img As Image In subPixelImages
        img.Dispose()
    Next
End Sub

Public Sub setPos(ByVal pos As Point)
    Me.pos = pos
    Me.updateDisparity(Me.actualDisparty)
End Sub

Public Sub setToTrueZeroDepth()
    Me.leftDestRec = New Rectangle(pos.X, pos.Y, subPixelImages(0).Width, subPixelImages(0).Height)
    Me.rightDestRec = Me.leftDestRec
    Me.leftSourRect = New Rectangle(0, 0, subPixelImages(0).Width, subPixelImages(0).Height)
    Me.leftSourRect = New Rectangle(0, 0, subPixelImages(0).Width, subPixelImages(0).Height)
    Me.leftSurface = subPixelSurfaces(0)
    Me.rightSurface = subPixelSurfaces(0)
End Sub 
```

结束类

公共类 SingleEyeImage Enum EYE As Integer Left = 0 Right = 1 Both = 3 End Enum

```
Public pos As Point
Public objName As String
Private parentDisplay As StereoStimulusDisplay

Public displayEye As Integer
Public destRec As Rectangle
Public sourRect As Rectangle
Public surface As Surface

Public Sub New(ByVal objName As String, ByVal pos As Point, ByVal eye As EYE, ByRef parentDisplay As StereoStimulusDisplay)
    Me.objName = objName
    Me.pos = pos
    displayEye = eye
    Me.parentDisplay = parentDisplay
    loadSurface(objName)
End Sub

Public Sub loadSurface(ByVal fileName As String)
    'Dim path As String = Application.StartupPath & "\input\SingleEyeObjectFiles\" & fileName & ".bmp"
    Dim path As String = Application.StartupPath & "\input\SingleEyeObjectFiles\" & fileName
    Dim img As Image = Image.FromFile(path)
    surface = surface.FromBitmap(parentDisplay._device, CType(DirectCast(img, Bitmap), Bitmap), Pool.Default)
    sourRect = New Rectangle(0, 0, img.Width, img.Height)
    destRec = New Rectangle(Me.pos.X, Me.pos.Y, img.Width, img.Height)
    img.Dispose()
End Sub

Public Sub setPos(ByVal pos As Point)
    Me.pos = pos
    Me.destRec.X = pos.X
    Me.destRec.Y = pos.Y
End Sub

Public Sub Dispose()
    surface.Dispose()
End Sub 
```

结束类

# facebook - 如何从 Facebook 自定义 Open Graph 对象中取回 fb_ref

> ID：12465945
> 
> 赞同：2
> 
> 时间：2012-09-17T19:32:47.847
> 
> 标签：facebook, facebook-graph-api, facebook-like

我在接收带有自定义 Open Graph 对象的 fb_ref 时遇到了困难。

Facebook 提供的 OpenGraph 对象（例如 Article）生成使用 Facebook 重定向的 URL（即[https://www.facebook.com/connect/uiserver.php](https://www.facebook.com/connect/uiserver.php) ?....），然后带来我们分配的“fb_ref”属性到令牌以跟踪用户来源。当用户通过设置共享此类链接并留下墙贴时，它会生成格式如下的共享：

'Bob 喜欢 Sitename 上的文章'

...连同一个通过 FB 的 URL，然后通过 fb_ref 属性到达我们的站点。

我注意到，如果我通过 Open Graph 创建自定义对象，当有人喜欢并在墙上发布我配置为该对象的内容时，它的格式为：

“鲍勃分享了一个链接”

...以及指向我们网站的纯 URL，没有 FB 重定向，也没有我想用于指标的 fb_ref 参数。

这是我的配置中的问题，还是所有自定义 Open Graph 对象在活动 Facebook 共享（如 + 评论）上都以这种方式表现？

额外的上下文：我可以通过 FB 对象调试器确认传入的共享被识别为我的自定义对象，这让我相信这是预期的行为，而不是错误配置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-01-27T22:17:51.340

确保您从 Facebook 个人资料上的“最近活动”而不是“查看活动日志”（去除参数）测试打开的图表链接。

在图片中：

*   正确的地方看：http: [//imgur.com/vR3uyNE](http://imgur.com/vR3uyNE)
*   看错地方了：http: [//imgur.com/02MIx57](http://imgur.com/02MIx57)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T00:21:54.580

不确定您是否正在做与我相同的事情，但它对我和我的自定义打开图形操作和对象都有效。

这是带有自定义操作的自定义对象的屏幕截图（注意，指向我的网站的链接包括我的 fb_ref 参数`fb_ref=123`。我的应用名称是“ES1”）：

![带有 fb_ref 参数的 cog 动作和对象](../Images/1657ddf10b7d0d5147c419fdd47cc3c6.png)

那个有类似故事的自定义对象（鼠标悬停在链接上显示`fb_ref=123`）：

![像故事一样的齿轮对象](../Images/c20f7b6abfa881795c0f21ab6531bb5d.png)

我的自定义对象：

```
<meta property="fb:app_id"      content="3814291xx" />
<meta property="og:type"        content="esmithy_one:bar" />
<meta property="og:url"         content="http://www.plooza.com/og/bar6.html?fb_ref=123" />
<meta property="og:title"       content="Bar Six" />
<meta property="og:description" content="Six drinking place" />
<meta property="og:image"       content="http://www.recipebits.com/media/food-icons/cookie-icon.jpg" /> 
```

我的喜欢按钮：

```
<div class="fb-like" data-href="http://www.plooza.com/og/bar6.html?fb_ref=123" data-send="false" data-width="450" data-show-faces="true"></div> 
```

您没有包含生成喜欢和 OG 操作的代码，因此我无法说明您是如何生成故事的。

# solr - Solr facet 中断属性名称

> ID：12465946
> 
> 赞同：0
> 
> 时间：2012-09-17T19:32:55.140
> 
> 标签：solr, facet

我有一个如下所示的 solr 架构： ... ...

我想从 solr 中提取所有可能的 grand_cat （大类别），所以我做了一个方面搜索，计算了所有 grand_cat；问题是它会拆分所有 grand_cat 字符串。

例如，大类别“foo and bar”将被拆分为“foo”、“and”、“bar”

有没有办法像在 sql 中那样：从 myTable 中选择不同的（字段）？

谢谢理查德

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T19:37:13.560

事实证明，如果 grand_cat 字段的类型为 String 而不是 text_general，则它不会拆分值。

# c# - “ReferenceEquals（myObject，null）”比“myObject == null”更好吗？

> ID：12465961
> 
> 赞同：52
> 
> 时间：2012-09-17T19:33:44.303
> 
> 标签：c#, .net, vb.net

我有一位同事喜欢编写如下的空检查：

```
if (!ReferenceEquals(myObject, null)) 
```

另一方面，我发现这种语法阅读起来很麻烦并且更喜欢：

```
if (myObject != null) 
```

我发现一些文章和堆栈溢出问题讨论了 ReferenceEquals 在运算符重载方面的优点，但在运算符重载场景之外，ReferenceEquals 与 == 有什么好处吗？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-09-17T19:36:10.073

> 但是在运算符重载场景之外， ReferenceEquals vs == 有什么好处吗？

不 - 显式使用的唯一优势（我认为这不是什么优势）`Object.ReferenceEquals`是它永远不会使用重载的运算符等于。在非重载的情况下，[== 运算符](http://msdn.microsoft.com/en-us/library/53k8ybth.aspx)被定义为“如果它的两个操作数引用同一个对象，则返回 true”，以用于所有“除字符串之外的引用类型”。因此，它的等价物（只要它没有重载）。

我个人也赞成使用第二种语法，并且发现它更易于维护以进行空检查。我还认为，任何重载`operator==`也应该提供适当的检查`null`，如果由于某种原因它没有（这很奇怪），那么该决定背后可能有一个特定的理由会导致你想要使用重载，而不是`ReferenceEquals`.

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2017-11-11T00:44:55.930

使用 c# 7，您可以使用：

```
if ( !(myObject is null) ) 
```

相当于

```
if (!ReferenceEquals(myObject, null)) 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-17T19:38:00.150

好吧，如果有人要覆盖 == 或 != 运算符，他们可以让他们为所欲为。甚至可以让它做一些真正的意思，比如`return true;`or `return false;`。此外，如果有一个重载的运算符，那么它很有可能不会表现得那么好`ReferenceEquals`（不能保证，它可能还不够重要，但仍然如此）。

话虽如此，因为任何重载运算符的任何合理实现都不太可能成为问题。我个人不使用`ReferenceEquals`，除非我有令人信服的理由不使用该`==`类型或特定情况下的运算符。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-09-17T19:41:48.490

在空值检查方面，两者应该总是返回相同的结果。如果非空引用曾经等于空（即使使用空对象模式），无论是使用 ReferenceEquals 还是 == 运算符，这都是一件*非常*糟糕的事情。所以，在那种情况下，我会使用 ==/!=。

我想说，如果 == 运算符重载，使用 ReferenceEquals*可能*会*稍微*快一些。重载 == 应该做的第一件事是查看两个变量是否指向同一个对象，因此在重载运算符的情况下，您最终会在调用堆栈上获得额外的帧。使用 ReferenceEquals 还可以保证这是*唯一*执行的检查。

我通常也会在几乎任何其他情况下使用 ==/!= 。整个想法是运算符定义“平等”；这并不总是引用的（事实上，大多数复合对象应该在结构上比较是否相等；如果它们的成员相等，它们就相等）。从理论上讲，对象知道如何最好地将自己与另一个对象进行比较，例如相等、相对顺序等，因此与其硬编码一个非常具体且可能不正确的逻辑，您应该使用语言的面向对象特性来让对象告诉你它是否等于其他任何东西。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-18T08:24:08.280

VB.NET 标记可能不应该包含在这个问题中，因为它没有另外提及，但为了完整起见，`Is`它等同于`Object.ReferenceEquals`，因此总是可以用来代替那个调用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-08-31T23:25:28.670

所以，即使它已经有一百万年的历史了，我也想加入这个谈话。

假设我们要编写一个检查 null 的扩展方法。我们可以做到以下几点：

```
public static bool IsNull<T>(this T value) where T : class, new()
{ 
   return value == null;
} 
```

但是这段代码很无聊。

原因是 T 必须是一个类。为什么？因为我们无法将值类型与 null 进行比较。这使得编写体面的通用代码变得非常痛苦。

或者，您可以将相同的方法附加到对象，而不必关心该对象是什么。

```
public static bool IsNull(this object value)
{
   return object.ReferenceEquals(value, null);
} 
```

这打开了其他可能性，例如为 Linq 编写容错 monad 或您拥有的东西 - 而无需实际限制您的通用代码。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-02-12T15:54:29.517

ReferenceEquals 可能会稍微快一些。如前所述，它确保没有调用重载的 Equals 运算符。ReferenceEquals 还确保仅执行一次比较，而不是可能执行 2 次，具体取决于重载的 Equals 运算符的实现。尽管重载运算符很可能将 ReferenceEquals 本身用作第一条语句。

我个人确实使用 ReferenceEquals，但仅在我真正调整以挤出最后一个时钟周期的地方（可能被称为每秒数百万次的地方）。或者当我无法控制类型时，比如泛型。......但只有当性能真的很关键时。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-10-11T19:43:45.570

真的，真的很晚才回复——但我在阅读 EFCore 库时遇到了这篇文章并遇到了这种方法......

Microsoft.EntityFrameworkCore.Utilities 中有一个 Check 类，它使用此逻辑进行空检查....

```
 internal static class Check
    {
        [ContractAnnotation("value:null => halt")]
        public static T NotNull<T>([NoEnumeration] T value, [InvokerParameterName] [NotNull] string parameterName)
        {
#pragma warning disable IDE0041 // Use 'is null' check
            if (ReferenceEquals(value, null))
#pragma warning restore IDE0041 // Use 'is null' check
            {
                NotEmpty(parameterName, nameof(parameterName));

                throw new ArgumentNullException(parameterName);
            }

            return value;
        } 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-10-28T08:06:12.233

正如其他答案中所解释的，这两个调用的语义略有不同。

如果您想使用`ReferenceEquals`简化语法的语义，对于**引用类型**，您还可以使用：

```
if (myObject is object) 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-05-12T19:33:13.617

在 C# 9 中，您可以使用`if (myObject is not null)`. [该参考文件](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/operators/is)规定了以下安全保证：

> 当您将表达式与 null 匹配时，编译器保证不会调用用户重载的 == 或 != 运算符。

# java - 我真的可以将对 Web 服务的引用连接到拦截器吗？

> ID：12465963
> 
> 赞同：1
> 
> 时间：2012-09-17T19:33:53.217
> 
> 标签：java, web-services, cxf

我是 CXF 和 Web 服务的新手。

因此 CXF 根据文档为每个请求创建一个新的拦截器堆栈。我想获取 SOAP、有效负载和所有内容，并将其用于持久性到异常表。我已经编写了一个基于 LoggingInterceptor 的拦截器，它可能会正常工作，我的 IDE 说接线很好，我关心的是线程和/或何时创建 Web 服务。

出于某种原因，我一直怀疑这是否可行，并且与线程有关。我只是不能把我的手指放在它上面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T19:39:44.757

CXF 为每个请求创建一个新的“PhaseInterceptorChain”对象，但拦截器本身并不是每个请求都创建的。因此，只要确保handleMessage（和handleFault）方法是正确的线程安全的，对拦截器使用单例是完全可以的。

# java - 使用Iterator和Vector的未知并发修改异常java

> ID：12465965
> 
> 赞同：2
> 
> 时间：2012-09-17T19:33:56.233
> 
> 标签：java, concurrency, iterator, concurrent-programming

我不断收到并发修改异常

```
String[] permsList = Constants.CUST_MKT_PERMS_FIELDS;
String hiddenFieldVector = new Vector<String>(permsList.length);
Iterator<String> itr = hiddenFieldVector.iterator();

for(int i = 0; i < arrayLength; i++){    //arrayLength is never null or 0

    ...a lot of code...
    String target = fromDatabase();     //this is never null

   while(itr.hasNext() && hiddenFieldVector.contains(target)){
    hiddenFieldVector.remove(target);
    Logger.debug("itr.next() = " + itr.next());
   }

    ...a lot of code...
} 
```

任何想法为什么？

当前解决方案：

```
while(itr.hasNext() && hiddenFieldVector.contains(target) && (itr.next().equals(target))){
                        itr.remove();
                        Logger.debug("itr.next() = " + itr.next());
                    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-17T19:34:39.763

```
hiddenFieldVector.remove(target); 
```

循环时`remove`不要调用。`list`在循环抛出时修改列表`ConcurrentModificationException`。

使用`iterator`并调用`remove`而`iterator`不是`list`.

例子：

```
while(itr.hasNext() && hiddenFieldVector.contains(target)){
    itr.remove();
    Logger.debug("itr.next() = " + itr.next());
   } 
```

# c# - Try/Catch 未在 ReportDocument.ExportToHttpResponse 中捕获 System.Threading.ThreadAbortException

> ID：12465967
> 
> 赞同：6
> 
> 时间：2012-09-17T19:34:08.110
> 
> 标签：c#, asp.net, crystal-reports, try-catch, threadabortexception

我正在尝试使用`ExportToHttpResponse`如下方式导出 Crystal ReportDocument：

```
report.ExportToHttpResponse(exportOptions, HttpContext.Current.Response, true, "test"); 
```

当我第一次尝试运行它时，我收到了一个`System.Threading.ThreadAbortException`. 在阅读了 this question 中的已知错误后`ExportToHttpResponse`，[我](https://stackoverflow.com/questions/8968194/thread-was-being-aborted-exception-in-crystal-reports)尝试实施建议的解决方法，将语句包装在 try/catch 块中，如下所示：

```
try
{
    report.ExportToHttpResponse(expOptions, HttpContext.Current.Response, true, "test");
}
catch (System.Threading.ThreadAbortException e)
{
} 
```

据我了解，这应该捕获并忽略错误，然后继续。但是，我仍然得到`System.Threading.ThreadAbortException`了 catch 语句的右括号。我的问题是为什么即使我显然已经捕获了异常仍然会收到异常，我该如何修复它以便忽略异常？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-17T19:44:50.717

您可以捕获 ThreadAbortException 并调用[Thread.REsetAbort](http://msdn.microsoft.com/en-us/library/system.threading.thread.resetabort.aspx)方法，以取消异常的冒泡。但是，请记住 response.end 是一个坏主意。每当您可以尝试调用 HttpApplication.CompleteRequest() 并阅读[这个 SO](https://stackoverflow.com/questions/1087777/is-response-end-considered-harmful)问题时，它在这方面对我来说非常有用。

# vb.net - 文件存在后如何查找和更新匹配的控件

> ID：12465968
> 
> 赞同：0
> 
> 时间：2012-09-17T19:34:17.993
> 
> 标签：vb.net, winforms, visual-studio-2010, file-io, controls

我编写了一个 WinForm 项目，该项目显示一个`ListBox`包含文件名列表。当用户单击提交按钮时，应用程序会动态加载并`PictureBox`为每个文件显示一个控件，然后在处理它们时等待。由于为每个文件生成 PDF 文件，因此`PictureBox`需要更新该文件的匹配项以显示图像。

这是我到目前为止所拥有的：

```
Private Sub ButtonSubmit_Click(sender As System.Object, e As System.EventArgs) Handles ButtonSubmit.Click

    Dim x As Integer = 790
    Dim y As Integer = 91
    For i As Integer = 0 To ListBox1.Items.Count - 1

        Dim key As String = ListBox1.Items(i).ToString()

        'adds picturebox for as many listbox items added
        Dim MyPictureBox As New PictureBox()
        MyPictureBox.Name = "pic" + key
        MyPictureBox.Location = New Point(x, y)
        MyPictureBox.Size = New Size(12, 12)
        MyPictureBox.SizeMode = PictureBoxSizeMode.StretchImage
        Me.Controls.Add(MyPictureBox)
        MyPictureBox.Image = My.Resources.Warning1
        ToolTipSpooling.SetToolTip(MyPictureBox, "Creating PDF...")
        x += 0
        y += 13

    Next i

    Call CheckPDFs()

End Sub

Public Sub CheckPDFs()
    Dim ListboxTicketIDs = (From i In ListBox1.Items).ToArray()

    For Each Item In ListboxTicketIDs
        Dim ID = Item.ToString

        Dim Watcher As New FileSystemWatcher()
        Watcher.Path = "C:\Temp\"
        Watcher.NotifyFilter = (NotifyFilters.Attributes)
        Watcher.Filter = ID + ".pdf"

        AddHandler Watcher.Changed, AddressOf OnChanged

        Watcher.EnableRaisingEvents = True
    Next

End Sub

Private Sub OnChanged(source As Object, e As FileSystemEventArgs)

    Dim p As PictureBox = CType(Me.Controls("pic" + ListBox1.Items.ToString()), PictureBox)
    p.Image = My.Resources.Ok1

End Sub 
```

一旦列表框中列出的项目存在，我无法将 更改`PictureBox`为不同的图片，基于`FileSystemWatcher`. 例如，文件并不总是按照它们在`ListBox`.

**编辑**

下面的工作代码。

```
Public Class Form1

Private WithEvents Watcher As FileSystemWatcher

Public Sub CheckPDFs()
    For i As Integer = 0 To ListBox1.Items.Count - 1
        Watcher = New FileSystemWatcher()
        Watcher.SynchronizingObject = Me
        Watcher.Path = "C:\Temp\"
        Watcher.NotifyFilter = NotifyFilters.Attributes
        Watcher.Filter = "*.pdf"

        Watcher.EnableRaisingEvents = True
    Next
End Sub

Private Sub Watcher_Changed(ByVal sender As Object, ByVal e As FileSystemEventArgs) Handles Watcher.Changed

    Dim key As String = Path.GetFileNameWithoutExtension(e.Name)
    Dim p As PictureBox = CType(Me.Controls("pic" + key), PictureBox)
    p.Image = My.Resources.Ok

End Sub

Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click

    ListBox1.Items.Add(TextBox1.Text)
    TextBox1.Text = ""

    Dim x As Integer = 5
    Dim y As Integer = 5
    For i As Integer = 0 To ListBox1.Items.Count - 1

        Dim key As String = ListBox1.Items(i).ToString()

        'adds picturebox for as many listbox items added
        Dim MyPictureBox As New PictureBox()
        MyPictureBox.Name = "pic" + key
        MyPictureBox.Location = New Point(x, y)
        MyPictureBox.Size = New Size(15, 15)
        MyPictureBox.SizeMode = PictureBoxSizeMode.StretchImage
        Me.Controls.Add(MyPictureBox)
        MyPictureBox.Image = My.Resources.Info
        x += 0
        y += 18

    Next i

    Call CheckPDFs()
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T21:00:53.040

首先，您不需要创建多个文件观察程序。您只需要一个文件观察器来观察文件夹的任何更改。我建议使用关键字在表单顶部将其声明为私有字段，`WithEvents`这样您就不必担心添加和删除事件处理程序。

接下来，当观察者引发更改事件时，您可以通过查看事件 args 对象的属性来获取更改文件的文件名。您需要获取更改的文件的名称，然后使用文件名作为查找匹配图片框控件的关键。

```
Public Class Form1
    Private WithEvents Watcher As FileSystemWatcher

    Public Sub CheckPDFs()
        Watcher = New FileSystemWatcher()
        Watcher.Path = "C:\Temp\"
        Watcher.NotifyFilter = NotifyFilters.Attributes
        Watcher.Filter = "*.pdf"
    End Sub

    Private Sub Watcher_Changed(ByVal sender As Object, ByVal e As FileSystemEventArgs) Handles Watcher.Changed
        Dim key As String = Path.GetFileNameWithoutExtension(e.Name)
        Dim p As PictureBox = CType(Me.Controls("pic" + key), PictureBox)
        p.Image = My.Resources.Ok1
    End Sub
End Class 
```

但是，由于您在下面的评论中说文件名与列表框中的文本不同，而是仅以该文本*开头*，因此您可以执行以下操作：

```
Private Sub Watcher_Changed(ByVal sender As Object, ByVal e As FileSystemEventArgs) Handles Watcher.Changed
    Dim p As PictureBox = Nothing
    For Each item As Object In ListBox1.Items
        If e.Name.StartsWith(item.ToString()) Then
            p = CType(Me.Controls("pic" + item.ToString()), PictureBox)
            Exit For
        End If
    Next
    If p IsNot Nothing Then
        p.Image = My.Resources.Ok1
    End If
End Sub 
```

# tomcat - 使用 64 位版本时，最新的 JRE (7u7) 和最新的 Tomcat (7.0.30) 出现问题？

> ID：12465973
> 
> 赞同：1
> 
> 时间：2012-09-17T19:34:49.390
> 
> 标签：tomcat, java, jvisualvm

我想在 Windows 7 上安装独立版本的 Tomcat，以便使用 jvisualvm 分析 Web 应用程序（服务版本只能使用 jmx 进行分析，这有一些限制）。我利用这个机会试用了 64 位版本的 JRE 和 Tomcat，但效果并不好。

Tomcat 没有启动，也不会创建日志文件。Tomcat 在运行*startup.bat*后实际运行的新控制台窗口几乎立即关闭，所以我看不到它显示了什么错误。我尝试了很多我在网上找到的技巧，以便在第一个命令提示符上显示此输出，但它们似乎适用于旧版本，因为我没有设法使它们中的任何一个工作。

我卸载了所有东西，然后使用相同的步骤安装了 32 位版本，现在它可以工作了。这种组合（JRE 64 和 Tomcat 7 64）是否存在已知问题？有没有人对这些版本有类似的问题？谢谢。

# python - python/matplotlib - 指定寄生轴长度

> ID：12465975
> 
> 赞同：2
> 
> 时间：2012-09-17T19:34:55.113
> 
> 标签：python, matplotlib, axis

我正在绘制来自多个来源的数据，并且需要[多个 x 轴](http://uairp.wff.nasa.gov/browse/file/ozone/natal/2011/nat20110526-1519.html)，最好是偏移量，例如链接中看到的那些。我非常希望我的 x 轴具有可变长度，允许我在同一个图上放置许多图。到目前为止我所做的是：

```
import matplotlib.pyplot as plt
from mpl_toolkits.axes_grid1 import host_subplot
import mpl_toolkits.axisartist as AA
host = host_subplot(111, axes_class=AA.Axes,yscale='log')
plt.subplots_adjust(bottom=0.25)

par1 = host.twiny()

offset = 60

new_fixed_axis = par1.get_grid_helper().new_fixed_axis
par1.axis['bottom'] = new_fixed_axis(loc='bottom',
                                     axes=par1,
                                     offset=(0, -60))

host.set_xlim(200, 350)
host.set_ylim(1050, 100)
par1.set_xlim(0, 1)

host.set_xlabel('Temperature (K)')
host.set_ylabel('Pressure (hPa)')
par1.set_xlabel('Relative Humidity (%)')

p1, = host.plot(T,P)
p2, = host.plot(pT,P)
p2, = par1.plot(RH,P) 
```

所以我让轴下降，但在我的一生中，无法弄清楚如何让轴实际水平压缩（例如上面链接图中的蓝色轴）。

我的问题是如何做到这一点（如果有的话）？

* * *

@Oz123

这是我所拥有的：

```
host = host_subplot(111, axes_class=AA.Axes,yscale='log')
plt.subplots_adjust(bottom=0.25)

par1 = host.twiny()

new_fixed_axis = par1.get_grid_helper().new_fixed_axis

cax1 = plt.axes(axisbg='none',frameon=False)
cax1 = plt.add_axes(plt.get_position(), frameon=False)
par1.axis['bottom'] = new_fixed_axis(loc='bottom',
                                     axes=cax1,
                                     offset=(0, -60)) 
```

当我到达：

```
cax1 = plt.add_axes(plt.get_position(), frameon=False) 
```

我以前的 x/y 轴消失了，我只剩下一个只有 cax1 的灰色屏幕。

抱歉，我只是拿起 matplotlib，所以恐怕我在这里还是个新手。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T09:01:56.050

您正在`par1.axis['bottom']`使用主要`ax`对象进行创建，因此您实际上可以做的事情非常有限。
相反，您应该创建 2 个或更多`axes`实例。并将它们放在图形实例上。

# 添加新轴实例

cax1 = plt.axes(axisbg='none', frameon=False)

像这样，您可以对湿度秤的大小进行细粒度控制。

以下行：

```
par1.axis['bottom'] = new_fixed_axis(loc='bottom',
                                     axes=par1,
                                     offset=(0, -60)) 
```

应该是例如：

```
par1.axis['bottom'] = new_fixed_axis(loc='bottom',
                                     axes=cax1, # custom axis number 1
                                     offset=(0, -60)) 
```

请注意，使用[IPython](http://ipython.org)，您可以快速找到可用于控制新创建的轴实例的方法。

```
In [38]: cax1.set_ #tab pressed
cax1.set_adjustable            cax1.set_axis_bgcolor          cax1.set_frame_on              cax1.set_subplotspec           cax1.set_xticks
cax1.set_agg_filter            cax1.set_axis_off              cax1.set_gid                   cax1.set_title                 cax1.set_ybound
cax1.set_alpha                 cax1.set_axis_on               
# many more options trimmed, but I think you might want to take a look in: 
```

# 控制新创建实例的位置：

```
In [38]: cax1.set_position?
Type:       instancemethod
String Form:<bound method AxesSubplot.set_position of <matplotlib.axes.AxesSubplot object at 0x2d7fb90>>
File:       /usr/lib/pymodules/python2.7/matplotlib/axes.py
Definition: cax1.set_position(self, pos, which='both')
Docstring:
Set the axes position with::

  pos = [left, bottom, width, height] 
```

# security - 一个 AWS 账户上的 AWS 安全组可以引用另一个 AWS 账户中的安全组吗？

> ID：12465978
> 
> 赞同：19
> 
> 时间：2012-09-17T19:35:10.710
> 
> 标签：security, amazon-web-services

例如，我有一个主要公司 AWS 账户，其安全组为 xxxxx。现在，我拥有安全组 yyyyy 的个人 aws。这些帐户根本​​不相关。我可以将 accept group-yyyyy 添加到 group-xxxxx 中，从而允许我的个人实例访问公司实例吗？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2013-11-05T01:01:25.307

您可以使用 Web UI 添加

`other-aws-account-id/account-security-group-id`

IE

`951413000000/sg-deadbeef`作为源

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2016-03-26T06:13:49.900

对于现在正在为这个问题寻找解决方案的人来说，如果他们的 vpc 是对等的，则可以从跨账户引用安全组。！它是 aws 的新功能！干杯

[链接到文章](https://aws.amazon.com/about-aws/whats-new/2016/03/announcing-support-for-security-group-references-in-a-peered-vpc/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-19T19:31:14.387

我知道这已经很老了，但我发现了一个更老的[AWS 开发人员论坛主题，它讨论了这个问题，并且通过使用](https://forums.aws.amazon.com/message.jspa?messageID=222413)**ec2-authorize**命令（例如，`ec2-authorize your-account-security-group-id -P tcp -p 10050 -u other-aws-account-id -o other-account-security-group-id`）似乎可以使用 EC2 API 工具。我还没有测试它，但我会在这里发布我的结果。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-07-02T14:37:40.453

您无法使用 VPC 中的安全组来执行此操作，并且由于您无法再创建不在 VPC 中的安全组（至少我看不到如何操作），我不相信这是可能的。

您必须查看 VPC 对等连接，但这超出了我的想象。

# python - 可以帮助从python应用程序中控制excel的模块比pywin32更需要什么？

> ID：12465979
> 
> 赞同：0
> 
> 时间：2012-09-17T19:35:27.307
> 
> 标签：python, excel, wxpython

我有一个使用 WXPython 构建的查看器。查看器基本上是一个浏览器（基于 IE wx.lib.iewin），它加载我在目录中的 txt 或 htm 文件，然后让我按顺序浏览这些文件。不必去目录选择下一个文件来查看查看器/浏览器有一个下一个按钮，可以加载队列中的下一个文件。

我希望能够添加一个新功能，该功能允许我突出显示浏览器中可见的一些文本，然后按下按钮并将该文本传递到 Excel 中的单元格中。

很多事情都会发生，比如我需要能够找到并启动一个新的 Excel 实例。我需要能够添加一个新工作表并根据我正在查看的文件传递一些值来填充工作表上的单元格，然后如果我想从文件中收集一些数据，我希望能够突出显示其中的数据查看器，然后按查看器上的按钮并将数据传递给excel。

我想我将从 PyWin32 开始，但我想知道是否还有其他我需要的东西，但我知道的还不够多。

如果有人知道一个示例，其中文本从 Python 应用程序通过管道传输到用户控制下的 excel 中，我将不胜感激指向该方向的指针。我认为从应用程序到创建（但未显示）的文件很容易做到这一点，但我希望从浏览器转到 excel 文件，以便用户可以评估他们正在进行的工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T19:40:17.900

我建议使用 python excel 模块之一，如 python-excel。它适用于任何操作系统，无需安装任何其他 Excel 应用程序。

[http://www.python-excel.org/](http://www.python-excel.org/)

将代码写入新的 xls 文档时，代码看起来有点像，与打开现有文档略有不同。

```
import xlwt
wbk = xlwt.Workbook()
sheet = wbk.add_sheet('sheet 1')
# indexing is zero based, row then column
sheet.write(0,1,'test text')
wbk.save('test.xls') 
```

希望这可以让您走上正确的道路，然后如果您遇到问题，您将能够发布更具体的问题。

注意：另一个选项是 openpyxl：

[http://packages.python.org/openpyxl/tutorial.html](http://packages.python.org/openpyxl/tutorial.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T20:18:09.790

如果您使用的是 wxPython（我假设您是由于标签），您应该查看 XLSGrid： http: [//www.blog.pythonlibrary.org/2011/08/20/wxpython-new-widget-announced- xlsgrid/](http://www.blog.pythonlibrary.org/2011/08/20/wxpython-new-widget-announced-xlsgrid/)

如果您只想使用 Excel，我会推荐[xlwt](http://pypi.python.org/pypi/xlwt)或[xlrd](http://pypi.python.org/pypi/xlrd)，尽管您也可以通过 COM 使用 PyWin32 来使用它：http: [//www.blog.pythonlibrary.org/2010/07/16/python-and -microsoft-office-使用-pywin32/](http://www.blog.pythonlibrary.org/2010/07/16/python-and-microsoft-office-using-pywin32/)

# .net - 实施 WF4 工作流程无书签简历

> ID：12465980
> 
> 赞同：1
> 
> 时间：2012-09-17T19:35:29.973
> 
> 标签：.net, workflow-foundation-4, conceptual

有没有其他方法可以在不使用**bookMarks**的情况下在某些状态（状态机）下恢复工作流？

谢谢，

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-18T20:50:47.933

不，书签是工作流程恢复的*方式。*您可以[在 MSDN 上阅读有关书签的更多信息](http://msdn.microsoft.com/en-us/library/dd489442.aspx)。

# jquery - chrome 问题 - jquery play() 控件

> ID：12465982
> 
> 赞同：1
> 
> 时间：2012-09-17T19:35:32.893
> 
> 标签：jquery, html, video, playback, mediaelement.js

行，

我正在使用 medialement.js 播放和控制视频。目的很简单。单击视频的封面图像后，我会播放视频。它在 Firefox 中运行良好，在 IE 中我仍然必须允许它或其他东西，但在 Chrome 中，单击封面后视频变得不可见。

```
$("document").ready(function() {

    $("video").click(function() {

    player2.play();
    $("nav").delay(4500).fadeIn(3000);

    });

}); 
```

可在 evo.lopezi.com 上找到在线示例

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T21:28:09.513

这是chrome中的一个错误，您可以通过单击使其显示。尝试调整视频元素，在播放之前执行以下操作（或更改其不透明度）：

```
$('#player2').attr('controls', true);
$('#player2').attr('controls', false);
player2.play(); 
```

# powershell - 列出所有以前加载的 PowerShell 变量

> ID：12465989
> 
> 赞同：32
> 
> 时间：2012-09-17T19:36:01.877
> 
> 标签：powershell, powershell-2.0

是否有 PowerShell 命令列出所有以前加载的变量？

我在 Visual Studio 中运行一些 PowerShell 脚本，并想列出当前 PowerShell 会话中可用的所有变量。

我试过命令：

```
ls variable:*; 
```

但它返回以下内容：

```
System.Management.Automation.PSVariable
System.Management.Automation.PSVariable
System.Management.Automation.PSVariable
System.Management.Automation.PSVariable
System.Management.Automation.PSVariable
System.Management.Automation.PSVariable
System.Management.Automation.PSVariable
System.Management.Automation.PSVariable
System.Management.Automation.PSVariable
System.Management.Automation.PSVariable 
```

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-09-17T20:59:23.287

`ls variable:*`应该工作，或者`Get-Variable`。如果这些导致输出不良，那是由于主机实现不佳，而不是 powershell 本身。如果您打开标准控制台主机（运行 powershell.exe），您将看到这些工作正常。

如果您需要解决一个坏主机，您可能会更好地将所有内容转储到显式字符串：

```
Get-Variable | Out-String 
```

或者

```
Get-Variable |%{ "Name : {0}`r`nValue: {1}`r`n" -f $_.Name,$_.Value } 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2017-10-30T20:04:31.790

有趣的是，您只需键入`variable`，这也可以！

我想通了这一点，因为我很好奇`ls variable:*`在做什么。`Get-Help ls`告诉我们它是 PowerShell 的 Get-ChildItem 的别名，我知道它会列出对象的所有子项。所以，我试过了`variable`，瞧！

基于[this](https://stackoverflow.com/a/33740980/1599699)和[this](https://technet.microsoft.com/en-us/library/ee692793.aspx)，似乎正在做的是告诉它使用列表上的 (all/any) 通配符进行`ls variable:*`某种范围/命名空间查找，在这种情况下，这似乎是无关紧要的 ( == == ) .`*``variable``ls variable:*``ls variable:``variable`

# c# - 如何使用 IQueryable 填充 dataGridView

> ID：12465993
> 
> 赞同：1
> 
> 时间：2012-09-17T19:36:18.373
> 
> 标签：c#, winforms, entity-framework, iqueryable

我添加了必需的列和正确的 DataPropertyName s，我使用以下代码填充 datagridview。但是，我的 dataGridView 仅显示列标题和一个空行。我的代码有什么问题？

```
public static IQueryable<Kolon> kolonlistele()
{
    using (Pehlivan.pehkEntities ctx = new Pehlivan.pehkEntities())
    {
        var result = from k in ctx.Kolons
                     select k;

        return result;
    }
}

private void Form1_Load(object sender, EventArgs e)
{
    dataGridView1.DataSource = veritabani_islemleri.kolonlistele();
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T19:57:01.033

这里的问题是延迟执行。 `result`实际上不是结果。这不是查询的结果，而只是查询本身。这就是一个`IQueryable`。您可以将其视为 SQL 查询的复杂版本，而不是结果集。在您对其进行迭代或使用某种对其进行迭代的方法之前，不会执行实际的查询。（例如调用`ToList`，将其放入 a `foreach`，或者像这里的情况一样，将其绑定到 a `DataGridView`）。

这种延迟执行在这里特别成问题，因为涉及一次性资源。直到您在`using`块之外，您才真正执行查询，这意味着在`DataSource`您实际尝试执行查询时已经处理了。

解决此问题的一种方法是急切地执行查询：

```
public static IQueryable<Kolon> kolonlistele()
{
    using (Pehlivan.pehkEntities ctx = new Pehlivan.pehkEntities())
    {
        return ctx.Kolons.ToList();
    }
} 
```

通过调用`ToList` *内部*查询在`using`数据源被处理之前执行。另请注意，我删除了，`from k in ctx.Kolons select k`因为它实际上并没有完成任何事情；这完全是多余的。

您的另一个选择是增加数据源的范围。如果不是在`kolonlistele`方法内部声明它，而是在“更高范围”声明数据源，以便在对象尚未释放时设置数据源，那么它也可以工作。这在数据源创建成本更高的情况下更合适，或者当查询的大小如此之大以至于流式传输它很重要（如果您需要流式传输数据然后急切地将其评估为 a`List`将是问题）。

# inversion-of-control - 如何使用代码在 Castle Windsor v3+ 中添加设施配置？

> ID：12465997
> 
> 赞同：0
> 
> 时间：2012-09-17T19:36:29.497
> 
> 标签：inversion-of-control, castle-windsor, ioc-container, windsor-facilities

在 Castle Windsor v3+ 中，该`IWindsorContainer.AddFacility<T>(string idlnConfiguration)`方法已被弃用。在旧版本中，您可以使用此方法通过调用`IConfigurationStore.AddFacilityConfiguration(string key, IConfiguration config)`“idlnConfiguration”和“key”在调用中相同的位置来添加动态配置。

例如：

```
store.AddFacilityConfiguration("quartzNet", facilityConfig);
container.AddFacility<QuartzFacility>("quartzNet"); 
```

在 Windsor 3 中推荐的执行此操作的方法是什么？ObsoleteAttribute 上的消息指向使用`container.AddFacility<T>()`，但我看不出如何。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T21:03:36.970

推荐的方法是使用

```
container.AddFacility<SomeFacility>(f => f.Configure("me").Here()); 
```

显然该设施必须支持这一点。

# rdf - 从java中的多个本体文件（ttl文件）中提取三元组

> ID：12465998
> 
> 赞同：0
> 
> 时间：2012-09-17T19:36:31.970
> 
> 标签：rdf, semantic-web, ontology, rdfs

我有 8 个本体文件（ttl 文件）。我的任务是从中提取所有三元组并显示具有所有属性的输出。该任务必须在java中完成。期待您的回复。

拉克什

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T12:11:08.307

[Jena](http://jena.apache.org)或[RDF4J](http://rdf4j.org)（以前称为 Sesame）是在 Java 中使用 RDF 的两个最佳选择。我更喜欢 RDF4J 而不是 Jena；我发现它更容易使用，因为它更轻量级，但是 ymmv。Jena 提供了一个简单的[教程](http://jena.apache.org/tutorials/index.html)，将向您展示 API 的基础知识，[这里](https://rdf4j.org/documentation/programming/rio/)有一篇关于如何使用 RDF4J RIO 读写 RDF 的文章。