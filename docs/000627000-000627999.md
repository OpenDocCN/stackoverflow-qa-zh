# StackOverflow 问答 000627000-000627999

# ruby-on-rails - 如何在 Rails 应用程序中删除 URL 的尾部斜杠？（在 SEO 视图中）

> ID：627006
> 
> 赞同：7
> 
> 时间：2009-03-09T16:35:16.403
> 
> 标签：ruby-on-rails, ruby, seo, url-rewriting

为了避免内容重复，我想避免我网站的页面可以通过多个 URL 访问（带有或不带有斜杠）。

目前，网址

```
catalog/product/1 
```

和

```
catalog/product/1/ 
```

导致相同的页面。我的目标是第二个 URL 重定向到第一个（重定向 301，当然）。除了我的主页 / 显然之外，我的网站的任何页面都不应使用斜杠访问。

做这个的最好方式是什么？使用 .htaccess 或 routes.rb？你会怎么做？

注意：我正在使用 Ruby on Rails 1.2.3 进行开发

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2010-08-25T21:10:31.930

您可以使用[http://github.com/jtrupiano/rack-rewrite](http://github.com/jtrupiano/rack-rewrite)进行 url 重写，以独立于网络服务器的差异。

Rails 应用程序中的示例用法：

```
config.gem 'rack-rewrite', '~> 1.0.0'
require 'rack/rewrite'
config.middleware.insert_before(Rack::Lock, Rack::Rewrite) do
  r301 %r{(.+)/$}, '$1'
end 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-09T16:50:20.313

我会使用[Apache 的 mod_rewrite](http://httpd.apache.org/docs/1.3/mod/mod_rewrite.html)。试试这个：

```
RewriteEngine on
RewriteRule ^(.+)/$ $1 [R=301,L] 
```

**编辑：**添加 R=301。我猜这与默认的 302 相比有 SEO 优势。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-08-25T19:14:48.540

您可以使用 rack-rewrite gem 来做到这一点。方法如下： http: [//nanceskitchen.com/2010/05/19/seo-heroku-ruby-on-rails-and-removing-those-darn-trailing-slashes/](http://nanceskitchen.com/2010/05/19/seo-heroku-ruby-on-rails-and-removing-those-darn-trailing-slashes/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T17:08:29.537

您无法使用 routes.rb 获得重定向。我想您可以构建一个控制器，它只发出重定向并将所有以“/”结尾的 URL 指向它，但这似乎不必要地复杂。相反，我会在 .htaccess 文件中使用 mod_rewrite ：

```
RewriteRule ^(.+)/$ $1 [R=301,L] 
```

# ant - 如何“动态”生成文件集？

> ID：627007
> 
> 赞同：1
> 
> 时间：2009-03-09T16:35:18.807
> 
> 标签：ant

如何根据用户输入动态生成文件集？

鉴于此目录：

```
root
--dir1
----filesA.txt
----subdir1_1
--dir2
----filesB.xml
--dir3
----filesC.java
----subdir3_1
--dir4
----filesD.txt
----subdir4_1
------subdir4_1_1 
```

和那个命令行调用：

```
ant -Ddirectory="dir1 dir3"

<target name="zip">
  <zip destfile="${root}/archive.zip">
    <fileset dir="${root}">
      <include name="**/*"/>
    </fileset>
  </zip>
</target> 
```

我只想压缩用户指定的目录（及其子文件）。我曾考虑过使用 PropertyRegex 任务，但我认为这是一种丑陋的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T17:16:38.333

使用来自 antcontrib foreach 的[foreach](http://ant-contrib.sourceforge.net/tasks/tasks/foreach.html)：

```
ant -Ddirectory="dir1,dir3"

<project name="build" default="zip" basedir=".">
<!-- declare ant-contrib -->
<taskdef resource="net/sf/antcontrib/antcontrib.properties">
  <classpath>
    <pathelement location="${basedir}/ant-contrib-1.0b3.jar"/>
  </classpath>
</taskdef>

<property name="root" value ="folder"/>
<target name="zip">
    <delete file="${root}/archive.zip"/>
    <foreach list="${directory}" param="folder" target="zipdir"/>
</target>

<target name="zipdir">
    <echo>${folder}</echo>
    <zip destfile="${root}/archive.zip" update="true">
        <fileset dir="${root}">
            <include name="${folder}/**/*"/>
        </fileset>
    </zip>
</target> 
```

# asp.net - 如何在也能够运行 javascript 的网页上托管 PDF 内容？ASP.Net 解决方案请

> ID：627010
> 
> 赞同：1
> 
> 时间：2009-03-09T16:35:58.493
> 
> 标签：asp.net, pdf

第一个问题，请对我温柔一点，并提前感谢您的帮助！

我将添加相当多的上下文来解释我为什么要问我这个问题以及为什么我想做我想做的事。忍受我，这一切都是值得的。

我应该提一下，这个应用程序不会被公众看到，我们对我们的用户有一些限制（只使用 IE 5.5 之类的东西）。

我有一个必须添加到的现有网络应用程序。

当前，一个 aspx 页面使用一些作为查询字符串传入的 ID 导航到，并且在页面加载中调用一个业务对象，传入页面的 Response 对象。该业务对象获取 PDF 字节内容（通过业务对象从 sql 服务器），并在标头中设置必需项后，将 PDF 字节数据写入 Response 对象。用户可以看到 PDF 并且一切正常。

但是，现在我们有一个要求，当页面导航到应用程序时，将获取 PDF 字节数据，并且除了显示它之外，我们还将其发送到基于本地网络客户端的专有系统（我们已经通过java applet 应用程序工作流程中的其他点并且它可以工作）。

问题是，当用户导航到“查看动态生成的 pdf 文档”页面时，我需要（取决于某些用户设置或其他设置）显示一个模式对话框，以询问用户是否要将 PDF 发送到这个专有系统。为此，我需要能够运行客户端 javascript 来调用 showModalDialog（使用 showModalDialog 很方便，因为我可以将所有 java 小程序调用的东西和 java 小程序本身放在这个显示为模式对话框的页面上）。

问题是我们目前显示 PDF 的方式不允许我们运行 javascript，因为所有发送到客户端的页面都是带有一堆 pdf 数据并标记为此类的页面。

到目前为止，我已经尝试过 IFrames（是的，是的，我知道，从 Lucifer 的基础中流出），其中 src 被动态设置为 PDF 显示页面的 url 以及该页面需要的查询字符串。从某种意义上说，我的模态对话框显示哪个很棒，并且 PDF 显示在页面顶部的一个舒适的小两英寸处（至少这是一些东西），这不是那么好:(

我也尝试过使用对象标签，但我什至不知道从哪里开始将其排序为“runat=server”。当我尝试在客户端执行此操作时，我的 java 脚本中出现了 object required 错误。

所以我真正想要的只是某种“容器”，我可以放置在标准的 aspx 页面上，我可以使用它来动态引用另一个页面，从中将它赋予视口中的“全高”。IFrame 看起来像那个家伙，但它们似乎有点……嗯……便便。

哦，以防万一你没有猜到：我不像在 WinForms 中那样有经验的 web 开发人员。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T17:42:25.180

> 从某种意义上说，我的模态对话框显示哪个很棒，并且 PDF 在页面顶部的一个舒适的小两英寸处显示（至少是这样）

然后给 iframe 一个更大的高度。通过'height'属性，如果你能猜出一个合理的像素大小，或者如果你想做一些基于页面高度的事情，可以使用CSS：

```
<iframe src="pdfscript?id=123" style="position: absolute; top: 10%; left: 10%; width: 80%; height: 80%;"></iframe> 
```

虽然您*可以*使用 <object> 标签将 PDF 嵌入网页中，但强烈建议不要这样做。至少使用 iframe 选项，如果您没有安装 PDF 插件，它会提示您下载为文件；object-version 只会给您一个损坏的插件图标，并且可能会提示您安装 Acrobat 插件。

（而且您绝对*不*希望安装 Acrobat 插件，因为目前所有安全漏洞都在将我们的桌面控制权交给俄罗斯黑客。感谢 Adob​​e。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T17:01:09.897

请尝试这样的事情：

<form id="form1" runat="server"> <div style="width:99%;height:99%;border:1px 纯绿色;"> <iframe id="frame1" runat="server" scrolling= "auto" frameborder="0" marginheight="0" marginwidth="0" src="Userguide.pdf" style="height:99.5%;width:99.5%;border:1px 实心黄色;"></iframe> > </div> </form>

# objective-c - 读取接收和发送的网络流量字节

> ID：627013
> 
> 赞同：2
> 
> 时间：2009-03-09T16:36:42.110
> 
> 标签：objective-c, xcode, macos

在 Objective-C 中获取网络流量发送和接收字节的最简单方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-10T05:39:03.227

这并不容易，它来自 C 而不是 Objective-C，但您需要的所有信息都存储在**getifaddrs(3)**返回给您的接口地址的 ifa_data 字段中。您可以在 libtop_p_networks_sample 函数中的“top”实用程序的[源代码](http://src.gnu-darwin.org/DarwinSourceArchive/expanded/top/top-15/libtop.c)中看到一个如何访问此功能的示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T09:28:02.273

cleaneast 解决方案可能是 cdespinosa 的。

替代品可能是

1/ 在 NSTask 中包装 netstat 调用

```
diciu$ netstat -bi en0
Name  Mtu   Network       Address            Ipkts Ierrs     Ibytes    Opkts Oerrs     Obytes  Coll
en0   1500  <Link#4>    xx:xx:xx:xx:xx    86259     0   86175096    64485     0   10090152     0 
```

2/ 阅读 sysctl vars 可以获得一些网络统计信息，但这些似乎与特定接口无关：

```
diciu$ sysctl -b net.inet.ip.stats > /tmp/tt
diciu$ hexdump /tmp/tt
0000000 d2 4a 01 00 00 00 00 00 00 00 00 00 00 00 00 00
0000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 
```

在转储中，“d2 4a 01 00”是总 ip 数据包（即 0x14ad2 = 84690 个数据包）。

你得到的结构在 netinet/ip_var.h 中定义：

```
struct  ipstat {
        u_int32_t       ips_total;              /* total packets received */
[..] 
```

# asp.net-ajax - 没有为 ASP.Net 页面方法呈现对象定义

> ID：627014
> 
> 赞同：0
> 
> 时间：2009-03-09T16:36:47.913
> 
> 标签：asp.net-ajax, pagemethods

我正在使用 ASP.Net Ajax 的页面方法，但我遇到了一个问题，即未呈现枚举的定义。这是我所拥有的：

```
public class Contact
{
    public string FirstName{get;set;}
    public IList<PhoneNumber> PhoneNumbers{get;set;}
}

public class PhoneNumber
{
   public string Number{get;set;}
   public PhoneNumberType {get;set;}
}

public enum PhoneNumberType
{
   Home,
   Work,
   Fax,
   Cell
} 
```

然后我有一个简单的网络方法，例如：

```
[WebMethod]
public static Contact GetContact(Guid id)
{
   return ....;
} 
```

在客户端，我最终得到了一个 MyNamespace.Contact 类；但是，我没有 MyNamespace.PhoneNumber 或 MyNameSpace.PhoneNumberType。我发现如果我显式添加只返回这些类型的虚假网络方法，那么客户端类型就会被呈现。有没有办法强制将该枚举呈现为假网络方法？

我想要枚举，因为我需要遍历 List<> 并基于 PhoneNumberType 做一些不同的事情。我宁愿不硬编码幻数或硬编码枚举定义。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-09T16:53:18.187

我需要将 GenerateScriptType 属性添加到方法签名中。

所以我的页面方法是现在

```
[WebMethod]
[GenerateScriptType(typeof(PhoneNumberType))]
[GenerateScriptType(typeof(PhoneNumber))]
public static Contact GetContact(Guid id)
{
} 
```

# django - 单选按钮分配作为搜索过滤器

> ID：627017
> 
> 赞同：0
> 
> 时间：2009-03-09T16:37:15.040
> 
> 标签：django, search, variable-assignment

模板：

```
<form method="POST" action="/Bycategory/">
<input type="radio" name="andor1" value=1 checked>
<input type="radio" name="andor1" value=2>
<select id="pathology_id" name="pathology_id">
    {% for pathology in pathology_list %}
        <option value="{{ pathology.id }}">{{ pathology.pathology }}</option>
    {% endfor %}
</select> 
```

实际上有三个搜索选择（病理、商品、技术）用户可以做和/或混合或匹配这三个，这就是为什么我需要在 views.py 中的和/或选项。

意见.py：

```
def Bypub(request):
    andor1 = request.POST['andor1']
    pathology_id = request.POST['pathology_id']
    p = get_object_or_404(Pathology, pk=pathology_id)
    pub1=Publication.objects.exclude(pathpubcombo__pathology__id= 1).filter(pathpubcombo__pathology=p)
    list=[]
    andlist=[]
    for publication in pub1:
        if andor1 == 1:
            if publication not in list:
                list.append(publication)
        if andor1 == 2:
            if publication in list:
                andlist.append(publication)
                #list=andlist
    return render_to_response('search/categories.html', {
        'andor1' : andor1,
        'pub1': pub1,
        'pathology': p,
        'list' : list,
        'andlist' : andlist,
    },
        context_instance=RequestContext(request)
    ) 
```

我知道我的所有代码都可以正常工作，但是 (if andor1 ==1:) 和 (if andor1 ==2:) 行被忽略了。我怀疑 andor1 的值没有出现在我使用它的地方。我认为它直到返回 render_to_response 之后才真正呈现，因为它作为一个值出现在下一个模板中，否则我会在模板中的 if andor1 ==1: 处看到某种响应。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T16:53:02.210

的值`andor1`是从 HTML 表单传递的字符串，`"1" == 1`在 Python 中为 False。尝试以下操作：

```
try:
    andor1 = int(request.POST['andor1'])
except (KeyError, ValueError):
    andor1 = 0 
```

现在它是一个整数，您在 ( `if andor1 == 1`) 下面的检查应该会成功。

或者测试字符串：

```
if andor1 == "1":
    ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T16:39:06.520

dpaste 代码： [http ://dpaste.com/10899/](http://dpaste.com/10899/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T17:02:27.180

谢谢你！报价有效。我的想法停留在该值是数字并且不需要引号的事实上，所以我没有尝试。

# ip-address - 相当于 eth0 的 Windows

> ID：627021
> 
> 赞同：6
> 
> 时间：2009-03-09T16:38:28.580
> 
> 标签：ip-address, ethernet, sctp, device-name

是否有类似于 Linux 和 Solaris 使用的“eth0”的 Windows 通用 IP 设备名称？

我正在尝试监视 SCTP 流量，这似乎成功地传递了 IP 地址，但这意味着每台使用此应用程序的机器都会更改为使用主机地址。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-15T07:40:23.637

找到“默认”接口的最佳方法是查询路由表中的 0.0.0.0（默认）路由。这将与一个接口相关联。当然，在动态环境中，这是一个快照。

```
C:\> route PRINT 0.0.0.0

Active Routes:
Network Destination        Netmask          Gateway       Interface  Metric
          0.0.0.0          0.0.0.0   10.117.254.254     10.117.1.68       20
Default Gateway:    10.117.254.254 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T16:41:17.760

不，没有“标准”或“默认”设备。事实上，在笔记本电脑上，很难说无线或有线设备是否会“更默认”。此外，还有用于防火墙、虚拟机实例等的假设备。

您需要监控所有设备，或至少监控所有活动设备（未“断开连接”的设备。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-15T07:09:52.883

您是否正在使用 Wireshark 进行监控，并且担心必须打开两个 Wireshark 才能监控单个 SCTP 关联？

如果是这种情况，那么您可以在混杂模式下进行监控，并将*sctp*应用为过滤器或*端口 2905*（或运行 SCTP 关联的端口）。然而，混杂模式需要 root（或管理员）权限。

如果您没有混杂模式，那么正如 Jason 建议的那样，您将必须监控属于该关联的所有 IP。当然，您可以将所有单独的 pcap 文件合并为一个，然后分析关联流量。

当然，如果这与 Wireshark 无关，那么这一切都是胡言乱语:)

# dependency-injection - 为什么将 IoC/DI 容器称为“容器”？

> ID：627024
> 
> 赞同：2
> 
> 时间：2009-03-09T16:39:36.550
> 
> 标签：dependency-injection, naming-conventions, inversion-of-control, conventions

我只是想了解标签“容器”的来源。有人知道吗？

似乎很多东西都可以称为“容器”。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-09T16:44:42.340

因为它充当对象的容器。它是管理其生命周期的框架。它负责实例化、解析引用并销毁它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T16:48:52.907

为了将其与**工厂区**分开来，工厂不会使实例保持活动状态。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T16:45:43.180

可能是因为它“包含”对象定义（并管理对象的创建和销毁）。

名字里有什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T16:50:22.733

集合一词旨在隐藏事物集合或容器的实现。您不能将其称为列表、数组或堆栈，因为它们是特定类型的实现。Collection 也可以，但 Container 是流行的词。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-03-09T16:41:44.233

因为它听起来比框架更友好。

# wix - Defining Wix properties and values based on VS active configuration

> ID：627027
> 
> 赞同：14
> 
> 时间：2009-03-09T16:40:07.390
> 
> 标签：wix, wix3

How can I define Wix properties and values that change depending on which Visual Studio configuration is active? e.g. For our release build, var x = 1 and for the export build, var x = 2.

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-09T17:43:40.093

We pass properties into WiX from the wixproj files using

```
<DefineConstants>configuration=$(Configuration)</DefineConstants> 
```

In a PropertyGroups section. Then you can use them inside wix as $(var.configuration)

```
<?if $(var.configuration) = Debug ?>
  <?define x=1 ?>
<?endif ?> 
```

The WiX help file has a whole section on preprocessor stuff, give that a look for other things you can do.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-09-28T16:18:50.517

I am using WiX 3.10 and `$(var.Configuration)` just worked for me.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-07-19T15:12:56.540

You can use Project Reference Variables for that. No need to specify constants.

**Sample steps:**

1.  Add a project reference (of the application) to your setup project

Right Click 'References', 'Add References'

2.  Use project reference values in your wxs file

> $(var.ProjectName.Configuration)

```
<?if $(var.ProjectName.Configuration)  = Debug ?>
  <?define x=1 ?>
<?endif ?> 
```

Resources:

[Complete list of Candle preprocessor variables](http://blogs.msdn.com/b/jrock/archive/2008/01/29/complete-list-of-candle-preprocessor-variables.aspx)

[Using Project references and variables](http://wixtoolset.org/documentation/manual/v3/votive/votive_project_references.html)

# visual-studio-2008 - VS.NET 构建后本地 IIS 挂起

> ID：627034
> 
> 赞同：2
> 
> 时间：2009-03-09T16:41:47.247
> 
> 标签：visual-studio-2008, iis, web-applications

我有一个 ASP.NET Web 应用程序，它在构建后偶尔会挂起。它是断断续续的，没有规律可循。当我之后尝试访问它时，IE 只是等待 IIS 响应，它不会这样做，除非我重新启动 IIS。

这是在我的本地机器上，运行 Vista Ultimate x64、VS 2008、1 个 Web 应用程序、8 个附加类库。

**- 更新 -**

在系统日志中，每次发生时都有一个条目：

> 为应用程序池“MyCustomAppPool”提供服务的工作进程“8068”未能在分配的时间内停止协议“http”的侦听器通道。数据字段包含错误号。

事件 ID：5138 [http://technet.microsoft.com/en-us/library/cc734995.aspx](http://technet.microsoft.com/en-us/library/cc734995.aspx)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-09T16:43:37.850

检查 Windows 事件日志以查看您的 ASP.net 工作进程有什么问题（可能在构建未完全完成时加载 DLL 时遇到问题，并且快速失败导致工作进程停止）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T16:51:53.227

您可以尝试在 Application_Start、Application_Stop、Session_Start 和 Session_End 事件中添加一些日志记录，以检查 Web 应用程序是否真的被命中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T17:31:08.640

也许很长一段时间，但如果您安装了防病毒软件，请尝试禁用其网络检查功能。（如果有的话。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T18:13:31.130

确保您已将所有可用更新应用于您的机器；包括 SP1。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-05T14:34:02.553

我相信我终于找到了一个合适的答案。

Tess Ferrandez 在加载 ASP.NET 程序集时挂起的帖子可能是问题所在：

[http://blogs.msdn.com/tess/archive/2009/09/22/asp-net-case-study-hang-when-loading-assemblies.aspx](http://blogs.msdn.com/tess/archive/2009/09/22/asp-net-case-study-hang-when-loading-assemblies.aspx)

听起来 GC 变得混乱并挂断了电话。

# php - 使用“mysql_fetch_row”从数据库中检索结果并使用 PHP 和 mysqli 插入数组？

> ID：627036
> 
> 赞同：5
> 
> 时间：2009-03-09T16:42:41.317
> 
> 标签：php, mysql, arrays, loops, mysqli

我需要从几行中检索数据，然后将结果插入到枚举数组中，这样我就可以使用“for”循环来回显它......

我有这个（我已经连接到数据库）：

```
$genres_sql = 'SELECT genreID FROM genres WHERE imdbID = ?';
if ($stmt->prepare($genres_sql)) {
    // bind the query parameters
    $stmt->bind_param('i', $movieid);
    // bind the results to variables
    $stmt->bind_result($genre);
    // execute the query
    $stmt->execute();
    $stmt->fetch();
} 
```

在这里，我将第一个结果（行）放入一个变量中。但是我需要将它插入到一个枚举数组中，这样我就可以使用这个来回显每个结果：

```
if (!empty($genre)) {
for ($i = 0; $i + 1 < count($genre); $i++)
{
    echo $genre[$i].', '; 
}
echo $genre[$i];
} 
```

这将回显：`$genre[0], $genre[1], $genre[2],`等等，直到最后一个。

我知道`mysql_fetch_row`可以完成这项工作，但我是编程新手，所以我需要一个非常详细的解释.. 谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T16:50:14.993

我对 mysqli 不是 100% 熟悉，但我玩过很多 pgsql 命令来做这种事情，我认为你要找的是[mysqli-result->fetch_assoc](http://us2.php.net/manual/en/mysqli-result.fetch-assoc.php)。这将产生一个关联数组，您可以像这样轻松地循环它：

```
while ($row = $result->fetch_assoc()) {
    printf ($row["genre"]);
} 
```

**编辑：** [Alnitak](https://stackoverflow.com/users/6782/alnitak)的解释比我在这个答案的评论中得到的更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T16:46:19.543

您可以使用以下方法循环`MySQLi_Statement::fetch`：

```
$stmt->bind_result($genre);
$stmt->execute();
$genres = array();
while ($stmt->fetch()) {
    $genres[] = $genre;
} 
```

基本上`fetch`提供了一个迭代器，`while`可以用来迭代每个结果。`bind_result`（在这种情况下）中的变量在`$genre`每次迭代时都会重新分配。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T17:10:05.477

这并不是问题的真正答案，但是如果您想将数组打印为逗号分隔的列表，最好使用[implode](http://www.php.net/implode)命令而不是 for 循环：

```
//Replaces the for loop in the question
echo implode(', ', $genre); 
```

...除了最后一个元素后没有逗号。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T16:53:26.017

只是为了完成@Mykroft 的回复，如果你真的只是想要一个枚举数组，只需使用 $result->fetch_array(MYSQLI_NUM)，尽管关联数组在大多数情况下使用起来非常简单。

# sql-server - 在 SQL Server 2005 中使用 XQuery 获取 XML 内部文本

> ID：627041
> 
> 赞同：1
> 
> 时间：2009-03-09T16:44:18.440
> 
> 标签：sql-server, xml, tsql, xquery

如何使用 XQuery 选择 XML 节点的内部文本？

Microsoft 联机丛书显示了如何检索以下属性：

```
DECLARE @myDoc xml
DECLARE @ProdID int
SET @myDoc = '<Root>
<ProductDescription ProductID="1" ProductName="Road Bike">
<Features>
  <Warranty>1 year parts and labor</Warranty>
  <Maintenance>3 year parts and labor extended maintenance is available</Maintenance>
</Features>
</ProductDescription>
</Root>'

SET @ProdID =  @myDoc.value('(/Root/ProductDescription/@ProductID)[1]', 'int' )
SELECT @ProdID 
```

我将如何获得保修节点的内部文本值？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-09T16:58:50.200

像这样的东西：

```
DECLARE @Warranty VARCHAR(50)

SET @Warranty = @myDoc.value('(/Root/ProductDescription/Features/Warranty/text())[1]', 'varchar(50)' )

SELECT @Warranty 
```

马克

# asp.net - 使用 ViewState 的 Asp.net BasePage 属性在回发时被清除

> ID：627049
> 
> 赞同：1
> 
> 时间：2009-03-09T16:47:40.477
> 
> 标签：asp.net, viewstate, page-lifecycle

以下是我的设置的基础知识：

我有一个继承自 System.Web.UI.Page 的 BasePage 类。BasePage 实现了两个属性，以便它们的 get/set 从 ViewState 集合中的两个不同项目（例如来自 BasePage 的 this.ViewState["Year"]）中执行。

我有另一个类，然后从 BasePage 继承，我们称之为 SpecificBasePage。

最后，我有一个继承SpecificBasePage 的aspx 页面。

我已经添加了断点并在我的代码中做了很多单步调试，发现在初始页面加载时，我的两个视图状态属性都被分配了值，并且这些值在第一个页面加载生命周期中持续存在。

但是，当页面回发时，在 Page_Load 事件和其他事件处理程序期间（应加载 ViewState 时），这两个属性都返回 null。检查 this.ViewState.Count 显示集合中有零个对象。

谁能想到我在某处可能会影响 ViewState 并导致这种行为的事情？

--另外我已经把它隔离到我的一部分代码中。在初始加载时，我在 OnInit 中给出了 viewstate 属性值，我发现当我将其移至 OnLoad 时，这些值在回帖中仍然存在。我猜即使添加的视图状态值在整个初始页面生命周期中都存在，但它们在回发中被放弃了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T17:01:28.727

页面可能在 aspx 上有 EnableViewState = false

也可能在应用程序的 web.config 上被禁用，甚至在 element 上的整个计算机上也可能被禁用。

**更新 1：**在 asp.net 生命周期中， ViewState 在 Init 之后和 Load [more info](http://msdn.microsoft.com/en-us/library/ms972976.aspx#)之前加载。看到它就像 init 上的任何东西都被认为是页面声明的一部分。稍后 asp.net 将加载视图状态，然后开始跟踪视图状态的更改。在此之后，asp.net 将看到视图状态的初始信息和更改的信息之间的任何差异，因此将其移动到加载可以避免问题（因为初始状态不存在，而新状态是您在视图状态上放置的任何内容） . 从上面的链接：

> “原因是因为 StateBag 类仅在调用其 TrackViewState() 方法后跟踪对其成员的更改。也就是说，如果您有一个 StateBag，则在进行 TrackViewState() 之前所做的任何和所有添加或修改都不会在调用 SaveViewState() 方法时保存。TrackViewState() 方法在初始化阶段结束时调用，这发生在实例化阶段之后。因此，在实例化阶段的初始属性分配——同时写入 ViewState 中属性的设置访问器——在保存视图状态阶段的 SaveViewState() 方法调用期间不会持久化，因为尚未调用 TrackViewState() 方法。”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T19:16:23.490

[这是另一个用户发布的关于ASP.NET 页面生命周期](https://stackoverflow.com/questions/597042/what-is-the-page-lifecycle-of-an-asp-net-webform/597068#597068)的绝佳答案，值得一看 ViewState 问题。

另外，看看“[真正了解 ViewState](http://weblogs.asp.net/infinitiesloop/archive/2006/08/03/Truly-Understanding-Viewstate.aspx) ”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T18:27:16.243

正如我在稍后添加的部分中所述，显然您不能在页面加载之前在视图状态中设置任何内容，即使 Asp.net 不会引发错误，并且它将在整个初始页面生命周期中存在于视图状态中，它不会在后续回发的生命周期中持续存在。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T19:13:01.720

看看您在哪里设置 ViewState 值。可能连接您的 OnUnload 事件并检查 ViewState 对象，以确保实际设置了值。

# textbox - 为什么所有文本框都不会选择？

> ID：627050
> 
> 赞同：1
> 
> 时间：2009-03-09T16:47:45.780
> 
> 标签：textbox, controls

我有一个带有 18 页的选项卡控件的表单。当我单击一个选项卡时，它会打开页面并选择该页面上的一个文本框 ( `txtTextbox1.Select()`)。这适用于前 8 页，但不适用于其余 10 页。虽然在这些页面上我可以鼠标单击文本框，输入信息，保存然后单击我的添加按钮，该按钮清除文本框并具有代码（`txtTextbox1.Select()`）。文本框被选中就好了。

除了选项卡名称和控件名称外，我所有页面的代码都是相同的。tab 键将在所有页面上按顺序将选择移动到下一个文本框，并且 Enter 键被编码为执行相同操作。前 8 页共有 256 个标签、按钮、列表框、文本框和复选框。

我正在寻找任何能够解释为什么会发生这种情况并且可能有解决方法或解决方案的人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-23T00:57:44.307

我很好奇：

> 除了选项卡名称和控件名称外，我所有页面的代码都是相同的。

我猜你是从头开始创建第一个页面，并做了很多复制/粘贴/编辑来创建每个后续页面。我对吗？

我要检查的第一件事是查看是否有多个页面在同一个 TextBox 上调用 Select()。这意味着其中一个正在尝试选择其他页面上的 TextBox，而不是正在显示的页面。例如，如果您在粘贴上一页的代码后错过了编辑，则可能会发生这种情况。（如果您调用 Select 的唯一位置是页面显示时，您可以尝试通过在文件中查找“.Select”来检查整个项目，并在结果中查找重复项。）

如果不是这样，您可以将非选择页面之一移动到选择页面之一的位置吗？例如，将第 18 页移动到第 1 页和第 2 页之间。它是否正确选择了其文本框？如果是这样，那么这个位置就有问题了。如果没有，那么它是关于页面的。

# discrete-mathematics - 使用离散方法计算导数

> ID：627055
> 
> 赞同：10
> 
> 时间：2009-03-09T16:49:09.460
> 
> 标签：discrete-mathematics, derivative

我正在寻找一种使用离散和快速方法计算导数的方法。因为现在我不知道我所拥有的方程的类型，所以我正在寻找类似于我们可以找到的积分方法的离散方法，例如欧拉方法。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-10T22:27:04.443

我认为您正在寻找以点计算的导数。如果是这种情况，这里有一个简单的方法可以做到这一点。你需要知道一点的导数，比如**a**。它由 h->0 的差商的极限给出：

![差商](https://upload.wikimedia.org/math/2/e/1/2e182ba47dd0ff925c5b7a4acf0522a2.png)

您实际上需要实现限制功能。那么你：

*   定义一个 epsilon，设置得越小越精确，越大越快
*   计算起始h的差商，假设h=0.01，存入**f1**
*   现在在 DO-WHILE 循环中：

    1- 将 h 除以 2（或除以 10，重要的是使其更小）
    2- 再次计算与 h 的新值的差商，并将其存储在**f2**
    3- 设置**diff = abs(f2-f1)**
    4 - 分配**f1 = f2**
    5- 从点 1 重复**while (diff>epsilon)**

*   您最终可以将 f1（或 f2）作为 f'(a) 的值返回

请记住：您假设函数在 a 中是可微**的**。由于您的计算机可以处理的有限十进制数字的错误，您将得到的每个结果都是错误的，这是无法逃脱的。

python中的示例：

```
def derive(f, a, h=0.01, epsilon = 1e-7):
    f1 = (f(a+h)-f(a))/h
    while True: # DO-WHILE
        h /= 2.
        f2 = (f(a+h)-f(a))/h
        diff = abs(f2-f1)
        f1 = f2
        if diff<epsilon: break
    return f2

print "derivatives in x=0"
print "x^2: \t\t %.6f" % derive(lambda x: x**2,0)
print "x:\t\t %.6f" % derive(lambda x: x,0)
print "(x-1)^2:\t %.6f" % derive(lambda x: (x-1)**2,0)

print "\n\nReal values:"
print derive(lambda x: x**2,0)
print derive(lambda x: x,0)
print derive(lambda x: (x-1)**2,0) 
```

输出：

```
derivatives in x=0
x^2:         0.000000
x:       1.000000
(x-1)^2:     -2.000000

Real values:
7.62939453125e-08
1.0
-1.99999992328 
```

由于只使用结果的前 6 位，我第一次得到“精确”值”，注意我使用 1e-7 作为 epsilon。之后打印了 REAL 计算值，它们显然在数学上是错误的。选择多小的 epsilon 取决于您希望结果有多精确。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-09T17:07:21.023

在计算数值（“有限”）导数方面有相当多的理论（和既定实践）。让所有细节正确，让您相信结果，这并非易事。如果有任何方法可以获得函数的解析导数（使用笔和纸，或计算机代数系统，如[Maple](http://www.maplesoft.com/)、[Mathematica](http://www.wolfram.com)、[Sage](http://www.sagemath.org/)或[SymPy](http://code.google.com/p/sympy/)），这是迄今为止最好的选择。

如果你不能得到解析形式，或者你不知道函数（只是它的输出），那么数值估计是你唯一的选择。C 语言中的数值方法的这一[章是一个好的开始。](http://www.fizyka.umk.pl/nrbook/c5-7.pdf)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-09T17:00:06.967

一个简单的方法是计算您感兴趣的导数的每个点的 f 在一个小值上的变化。例如，要计算 ∂f/∂x，您可以使用以下命令：

```
epsilon = 1e-8
∂f/∂x(x, y, z) = (f(x+epsilon,y,z) - f(x-epsilon, y, z))/(epsilon * 2); 
```

其他部分在 y 和 z 中是相似的。

为 epsilon 选择的值取决于 f 的内容、所需的精度、使用的浮点类型以及可能的其他因素。我建议你用你感兴趣的函数来试验它的值。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-12T10:09:13.857

要进行数值微分（始终是近似值），有两种常见情况：

1.  您有一种方法（算法、方程）来计算任何给定 x 处的 f(x) 的值，或者
2.  您在一组等距的 x 值（f(1)、f(1.5)、f(2) 等）处获得 f(x) 的值：

1.  如果你有算法，那么你最好看看[Andrea Ambu 的答案](https://stackoverflow.com/questions/627055/compute-a-derivative-using-discrete-methods/632538#632538)*：
    1.  从 f(a+h) 和 f(ah) 的值开始，然后执行
        f'(a) = { f(a+h)-f(ah) } / 2h
        这称为中心差。
    2.  根据 Andrea 的回答，减小偏移量 h 的大小，直到 f'(a) 停止变化。
    *   请注意不要在不检查它是否大于 0 的情况下除以 2h，否则会出现除以零错误。
2.  [如果你有一组 f(x) = f(x n] ) = f [n]的值的函数值，那么我们可以做类似上述方法的事情，但我们的准确性会受到 x 值的限制[n]以及它们之间的差距。
3.  第一个近似只是使用与上面相同的中心差分算子；
    f' [n] = (f [n+1] - f [n-1] )/2h，
    其中 h 是 x [n]值之间的相等间距。
4.  接下来是使用[五点模板](http://en.wikipedia.org/wiki/Five-point_stencil)，尽管它只有 4 个系数，如该维基百科页面上所述。这使用从 f [n-2]到 f [n+2]的值：f' [n] = (-f [n+2] + 8f [n+1] - 8f [n-1] +f [n-2] )/12h。
5.  有使用更多点的更高阶近似值，但它们越来越难以计算收益递减，并且在数值上变得更加不稳定。
6.  [**注意**：这些有限差分公式依赖于 f 与 x n-1] ≤ x ≤ [n+1]范围内的多项式的形状大致相同。对于像正弦波这样的函数，它们在计算导数方面可能非常糟糕，而且精度很高。

* Andrea 的答案使用前向差分算子 {f(a+h) - f(a)}/h 而不是中心差分算子 {f(a+h) - f(ah)}/2h，但是前向差分算子在数值解中不太准确。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-09T17:02:19.553

如果不使用 Maple 之类的符号数学语言，您能做的最好的事情就是在各个点近似导数。（然后插值，如果你需要一个函数。）

如果您已经获得了要使用的功能，那么您应该使用[后向除差论坛la](http://www.ece.uwaterloo.ca/~ece204/TheBook/12Differentiation/backward/complete.html)和[Richardson 外推](http://www.ece.uwaterloo.ca/~ece204/TheBook/12Differentiation/richardson/complete.html)来改善您的错误。

还要记住，这些方法适用于一个变量的函数。但是，每个变量的偏导数将其他变量视为常数。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-08-01T18:21:36.223

[自动微分](http://en.wikipedia.org/wiki/Automatic_differentiation)是做这种事情的最准确和概念上最棒的方式。只是稍微复杂一点。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-09T17:50:49.607

正式地，没有。您正在描述离散函数的（偏）导数，或者您正在要求一种数值方法来近似连续函数的（偏）导数。

离散函数没有导数。如果您查看导数的 epsilon-delta 定义，您会发现您需要能够在接近您想要导数的点处评估函数。如果函数的值只有 x、y 和 z 的整数值，这没有任何意义。所以没有办法找到任何快速值的离散函数的导数。

如果您想要一种数值方法来精确计算连续函数的导数，那么您也不走运。导数的数值方法是启发式的，而不是算法的。没有数值方法可以保证精确解。幸运的是，存在许多好的启发式方法。Mathematica默认使用[Brent 主轴方法的专用版本。](http://reference.wolfram.com/mathematica/tutorial/UnconstrainedOptimizationPrincipalAxisMethod.html)我建议你使用[GNU Scientific Library](http://www.gnu.org/software/gsl/)，它很好地实现了 Brent 的方法。我的一门数学课程的全部成绩都归功于 GSL。如果这是你的事，红宝石绑定非常好。如有必要，大多数数值微分库都有一些可用的不同方法。

如果你真的想要，我可以拿出一些示例代码。让我知道。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-09T16:53:09.387

我假设您的函数比您发布的简单函数更复杂，因为封闭形式的解决方案太简单了。

当您使用“离散”一词时，我认为您需要“有限差异”。您需要一些离散化来计算近似值。

Df/Dx ~ (f2-f1)/(x2-x1)等

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-10T21:56:51.287

我希望这可能对[数值微分有所帮助。](http://math.fullerton.edu/mathews/n2003/NumericalDiffMod.html)

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-03-09T17:24:32.027

如果函数如您所指出的那样是线性的，那么导数是微不足道的。关于“x”的导数是“a”；关于“y”的导数是“b”，关于“z”的导数是“c”。如果方程是更复杂的形式，并且您需要一个表示解的公式而不是经验解，那么请提交更复杂的方程形式。

问候

# sql-server - 将 SQL Server 2000 从 x86 升级到 x64？

> ID：627059
> 
> 赞同：3
> 
> 时间：2009-03-09T16:49:29.817
> 
> 标签：sql-server, sql-server-2000

我有一个当前为 x86 的 SQL Server，我想将它升级到 x64。它在 x64 版本的 Windows 上运行，我认为它就像在配置服务器时安装了错误的版本一样简单。这是一个生产服务器，所以我最关心的是让登录保持不变，因为每个用户都有自己的 SQL 登录。我进行了一些搜索，发现了一个[专家交换线程](http://www.experts-exchange.com/Microsoft/Development/MS-SQL-Server/SQL-Server-2005/Q_23800128.html)，它给出了以下步骤，尽管他从未报告过它是否有效。

1.  分离数据库 - alluser dbs、model 和 msdb。
2.  脚本登录 ( [http://support.microsoft.com/kb/918992/](http://support.microsoft.com/kb/918992/) ) 和作业
3.  保存数据库文件和脚本
4.  卸载 SQL
5.  安装 sql x64
6.  附上数据库
7.  文件在正确位置后重新附加 dbs。
8.  如果未重新附加 msdb，则为登录和作业运行脚本。

除了您不需要将系统数据库转移到新实例之外（所以第 1 步并不完全正确，除了编写任何特殊 XP 或您创建的任何其他内容之外），任何人都可以想到其他任何事情那需要做吗？更重要的是，有人真的尝试过吗？你能分享任何故事或陷阱，或者进展顺利吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T16:57:19.610

我已经在 SQL Server 2005 和 2008 上做过几次——据我所知没有任何问题。因此，根据我的经验，只要您没有任何旧的东西，例如可能依赖于 32 位和 64 位的扩展存储过程，我就不会遇到任何麻烦。数据库部分应该没问题。

马克

跟进：参考另一个答案 - 我没有 SQL Mail 也没有大量的 DTS 包要升级，所以我无法评论这些。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T16:58:34.490

我做到了，但并不好玩。有几个问题领域。

1.  x64 Sql Server 不支持 Sql Mail。当时我们正在广泛使用它。
2.  我们的很多 DTS 包都不容易转换为 SSIS。如果您有任何 DTS 包，请确保在升级服务器之前进行大量测试。

# oop - 具有变体的类：存储/检索参数？还是子类？

> ID：627062
> 
> 赞同：0
> 
> 时间：2009-03-09T16:49:55.230
> 
> 标签：oop

假设一个人有一个执行某种类型任务的类。假设该任务有许多变体。动作是相同的，只是改变了一些参数（*例如*，对于软煮鸡蛋，动作 = 煮沸，时间 = 5 分钟；对于硬煮鸡蛋，动作 = 煮沸，时间 = 11 分钟*等*）。变化的参数数量约为 10。

我看到有三种方法可以做到这一点：

*   使用开关并根据类型在代码中设置参数。

*   将参数保存在数据库或文件中，并根据任务类型检索它们。

*   子类化任务，覆盖父类的参数并实例化子类对象以执行相关任务。

第一个选项很笨拙。但是我如何在其他两者之间做出决定？

1) 从文件或数据库中检索参数。

*   PRO：不需要子类化或工厂。简单的。
*   CON：需要额外的查询或文件访问。参数在代码中不再可见。

2) 子类化任务。

*   PRO：不需要额外的查询或文件访问。代码中维护的参数。
*   CON：课程激增，需要制造工厂。

我是否正确识别了利弊？我应该使用哪些其他标准来决定问题？

请指教。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-12T11:28:22.093

如果只是参数发生变化而算法保持不变，那么我将创建一个包含算法的不可变类并创建该类的多个实例，每个实例具有不同的参数。将配置实例存储在常量或某些数据结构中。像这样在伪代码中：

```
constant SOFT_BOILED_EGG = new EggBoilingStrategy(BOIL, 5 min)
constant HARD_BOILED_EGG = new EggBoilingStrategy(BOIL, 11 min) 
```

这也使得创建包含不同算法的子类成为可能。

很大程度上取决于您访问配置所需的方式。您可以将它们存储在地图中，这样可以轻松添加新配置。或者，您可以硬编码对它们的引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T17:11:53.960

我认为您的 CON 对于 DB-parameters 选项可能被低估了。如果可以变化的参数数量约为 10，那么您仍然可能会在提取这些参数的例程中处理 if/switch 逻辑。

根据您的描述，编写子类和工厂方法的开销听起来比变量参数中涉及的逻辑要小。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T17:23:02.903

我的直觉告诉我，如果对象在逻辑上属于不同的类，它们就需要在物理上属于不同的类。

对于特定问题，选项 1 可能是可以接受的，但选项 2 是出路。一个类应该是自定义的，而不考虑运行时数据。（可能也有例外，但我喜欢夸张）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T17:23:37.987

我有机会在 2 个不同的项目中使用 2 个类似的系统。第一个通过子类路由，第二个通过配置路由（在我们的例子中是 db）。

第一个让团队觉得他们有很大的能力来定制它，因为它的子类也可以有非常具体的行为。随着时间的推移，对系统的理解并不那么直接，因为这些行为隐藏在子类中。

在第二个系统上，配置非常清楚地读取了每个特定案例的预期，包括数据+行为。测试类变得专注于测试他们很好地处理了这些设置。随着时间的推移，添加了一些基本配置，可以在需要时覆盖特定功能。为了减少主类处理的代码量，一些行为被移动到特定的类中，并根据配置加载它们。

我发现第二种方法在高度动态的环境中非常强大，其中新数据/对其工作方式的理解不断涌入。设置/行为由类明确定义/处理，没有系统数据的打开键不明白。

也就是说，这并不意味着需要在外部维护此配置。您可以轻松地拥有将不同配置添加到活动配置列表的代码。如果您将它与构建器模式一起使用，并为其提供默认值，您可以使用类似的基本配置方法而无需太多代码。

# c++ - 使用前验证指针的 API

> ID：627066
> 
> 赞同：0
> 
> 时间：2009-03-09T16:50:24.870
> 
> 标签：c++, winapi

> **可能重复：**
> [测试指针的有效性（C/C++）](https://stackoverflow.com/questions/551069/testing-pointers-for-validity-c-c)

在将指针用于写操作之前，是否有任何简单的 Win32 API 来检查指针是否指向有效的内存位置？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-09T16:57:15.650

有一整套 IsBadXXXPtr() 函数，但你[永远不应该使用它们](http://blogs.msdn.com/oldnewthing/archive/2006/09/27/773741.aspx)。

# .net - FileSystemWatcher 如何在另一台计算机目录上工作？

> ID：627068
> 
> 赞同：6
> 
> 时间：2009-03-09T16:51:12.637
> 
> 标签：.net, winapi, design-patterns, filesystemwatcher

有些东西让我很感兴趣，我没有找到任何资源。

FileSystemWatcher 如何知道计算机“A”上的文件何时创建/删除/更改/重命名？

我认为这适用于轮询（观察者轮询服务器以检查更新），但在使用 Wireshark 验证网络活动后，我发现没有使用轮询。SMB 协议是否使用可观察/观察者模式？

在这种情况下，服务器如何知道客户端何时不再观察他？

当网络在观察期间下降并在之后立即恢复时会产生什么后果？

在另一台计算机上使用 FileSystemWatcher 似乎太容易了……

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-09T17:06:49.353

> 在另一台计算机上使用 FileSystemWatcher 似乎太容易了……

有点像。底层 API -[`ReadDirectoryChanges()`](http://msdn.microsoft.com/en-us/library/aa365465.aspx)打开与服务器的连接，服务器负责在发生变化时做出响应。如果该连接由于某种原因被丢弃，或者您遇到了您正在连接的操作系统的连接限制，那么您将不会收到通知。

我发现定期轮询（间隔相当长）更可靠，并且`FileSystemWatcher`仅用作快速响应轮询之间变化的一种方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T17:01:04.127

我认为 FileSystemWatcher 确实使用了基于底层 Win32 API 的观察者/可观察模式。不确定实际事件，但大概是当您初始化 FileSystemWatcher 对象以监视网络路径并设置 EnableRaisingEvents 属性时，它通过附加到 Win32 API 引发的事件，将自身作为观察者在幕后附加到文件夹，就像它们会该文件夹位于同一台计算机上。

在观察者设计模式中，主体（可观察者）永远不知道观察者的数量或类型，因此关于另一台计算机知道 FSW 何时不再观看的点是无关紧要的。

如果在引发事件的过程中网络中断，这有点棘手 - 其他人将不得不在那里帮助您。

# c# - javascript:history.back() 在机器上触发回发，但在预编译时不会

> ID：627084
> 
> 赞同：0
> 
> 时间：2009-03-09T16:55:24.420
> 
> 标签：c#, asp.net, javascript, visual-studio-2008, .net-2.0

在我的机器上，当我在 javascript:history.back() 触发我的应用程序中的回发之后测试我的 web 应用程序（无论是调试还是正常）时。另一方面，当我预编译应用程序时它不会发生。最后，当我在别人的机器上测试相同的页面时，根本不会发生回发。

我正在使用带有 AutoEventWireup="false" 的 vs2008、asp.net 2.0

我检查了无法比较的文件，检查了 metadata.xml，但我不明白为什么在我的本地它会回发。

可能是什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T16:58:39.280

这样做：javascript:history.back(); 返回假；

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T17:31:32.197

> 另一方面，当我预编译应用程序时它不会发生。最后，当我在别人的机器上测试相同的页面时，根本不会发生回发。

那么很可能是缓存问题。如果 IE 可以记住前一页，它可能不必重新加载它。不同的部署选项会导致将不同的缓存标头传递回浏览器，并且不同的浏览器选项可能会合谋在不同的时间点使缓存过期。

一般来说，您希望使用[Post/Redirect/Get](http://en.wikipedia.org/wiki/Post/Redirect/Get)模式来避免回发，并且几乎没有充分的理由使用 'history.back()' 或 'javascript:' URL。

# apache-flex - 3D flex，围绕容器的随机点旋转（部分解决方案！）

> ID：627087
> 
> 赞同：2
> 
> 时间：2009-03-09T16:55:38.727
> 
> 标签：apache-flex, flash, actionscript, 3d

我正在尝试使用flash 10 for flex 中的matrix3D 功能来找到旋转容器（或其他任何东西）的最佳方法。

我已经设法让一个容器围绕一个不是其注册点的点旋转，但我只是通过关闭容器上的剪辑然后将内容放置在 (0,0,0) 以外的某个位置来解决这个问题。这确实有效，但它不是很直观，并且在尝试放置多个项目时或者即使您需要移动旋转点时也很糟糕。

使用 matrix3D 类似乎是要走的路，但我不确定具体如何。

干杯

附加信息 - 如果我的容器位于舞台上的 (0,0,0) 并且我希望围绕容器的中间 X 坐标旋转，那么我通过 container.width/2 平移 X，然后旋转并再次平移回来。这工作正常。但是，如果我的容器位于 (10, 0, 0) 处，那么如果我翻译与上述相同并添加额外的 10 则它不起作用。

**解决方案（这完全是垃圾 - 如果可以，请解释）** 正如建议的那样，您需要翻译，旋转，然后 -traslate。我知道这一点，但它从来没有奏效。
但是请参阅下面的解决方案，我不明白。（面板是我正在旋转的对象，我调用函数 both() ）

```
private function rotateOnly() : void {
        panel.transform.matrix3D.appendRotation(36, Vector3D.Y_AXIS);
}

private var valueToMove : Number = 300;
private var translateUpOrDown : Boolean = false;
private function translateOnly() : void {
    if(translateUpOrDown){
            panel.transform.matrix3D.appendTranslation(valueToMove, 0, 0);
    translateUpOrDown = false;
} else {
    panel.transform.matrix3D.appendTranslation(-valueToMove, -0,0);
    translateUpOrDown = true;
}
 }

 //I do not run both chunks of code here at once, this is only to show what I've tried   
 private function both() : void {
     //IF I call this function and call this chunk then the rotation works
        translateOnly();
        rotateOnly();
        translateOnly(); 

     //If I call this chunk which does the exact same as the above it does NOT work!!
        panel.transform.matrix3D.appendTranslation(valueToMove, 0,0);
panel.transform.matrix3D.appendRotation(36, Vector3D.Y_AXIS);
panel.transform.matrix3D.appendTranslation(-valueToMove, 0,0); 
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T17:09:01.190

旋转矩阵总是围绕原点旋转。

围绕任意点旋转对象`P`通常需要：

1.  对象的翻译`-P`
2.  根据需要旋转对象
3.  对象的翻译`P`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T12:16:26.507

好的，解决方案是 -

1 - 使用原始 X、Y、Z 以及宽度和高度的变量创建您自己的组件。这些将用于方便以节省额外的矩阵运算。EG 扩展 Box 类并将这些 var 添加到新类中。

2 - 将组件添加到应用程序，如下所示。（原始值是因为实际的 x、y、z 等会在旋转过程中发生变化，但您需要原始值来计算正确的旋转。

```
<local:RotationContainer 
        id="movingBox" 
        width="50"
        origWidth="50"
        height="60"
        origHeight="60"
        x="80"
        origX="80"
        y="70"
        origY="70"
        z="0"
        origZ="0"
        enterFrame="rotateObject(event)"
        /> 
```

3 - 旋转时使用如下代码，在上面的enterFrame事件中调用

```
private var translateUpOrDown : Boolean = false;
        private function translateOnly(obj : Object, valueToMoveX : Number,  valueToMoveY : Number) : void {

            if(translateUpOrDown){
                obj.transform.matrix3D.appendTranslation(valueToMoveX, valueToMoveY, 0);
                translateUpOrDown = false;
            } else {
                obj.transform.matrix3D.appendTranslation(-valueToMoveX, -valueToMoveY, 0);
                translateUpOrDown = true;
            }
        }

        private function rotateOnly(obj : Object) : void {
            obj.transform.matrix3D.appendRotation(rotationAmount, Vector3D.Y_AXIS);
        }

        private function rotateObject(event : Event) : void {

            var offsetX : Number = (event.currentTarget.origWidth / 2) + event.currentTarget.origX;
            var offsetY : Number = (event.currentTarget.origHeight / 2) + event.currentTarget.origY;

            translateOnly(event.currentTarget, offsetX, offsetY);
            rotateOnly(event.currentTarget);
            translateOnly(event.currentTarget, offsetX, offsetY);
        } 
```

4 - 就是这样。这将在 Y 轴上围绕中心点旋转。更改不同旋转点的偏移值。

更新 正如所指出的，您不需要将调用移动到单独的函数中，但您需要使用上面的方法，以便您可以获得原始宽度、高度、x 和 y（前提是您没有对所有值进行硬编码）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T01:39:31.483

您是否考虑过简单地移动枢轴矢量？

```
var matrix:Matrix3d = new Matrix3d();
matrix.appendRotation(degrees, axis, new Vector3d(container.width/2,container.height/2,0)); 
```

# xml - 如何确定 XmlNode 是否具有特定属性？

> ID：627089
> 
> 赞同：5
> 
> 时间：2009-03-09T16:55:55.497
> 
> 标签：xml, vb.net

我想在 sub 中放置一个 if 条件，当带有属性 TEST="test.doc" 的 xml 节点 STORE 不存在时，它会告诉它运行。任何建议都会很棒。我是 vb 的新手。

```
Sub InsertNode(ByVal doc As XmlDocument)   
    Dim City As XmlNode = doc.DocumentElement

    Dim Location As XmlElement = doc.CreateElement("store")
    Location.SetAttribute("test", "test.doc")

    Dim books As XmlElement = doc.CreateElement("books")
    books.InnerXml = "New Words"
    Location.AppendChild(books)

    City.AppendChild(store)
End Sub 'InsertNode 
```

* * *

XML 文件示例

```
<city>
    <store test="test.doc">
        <books>
        "New Words" 
        </books>
    </store>
</city> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-09T17:18:00.793

尝试这样的事情：

```
If Not doc.SelectSingleNode("//store[@test='test.doc']") Is Nothing Then
    Exit Sub
End If 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-09T17:05:49.170

假设*Location*是您要检查属性是否存在的节点：

```
If Location.Attributes.ItemOf("test") Is Nothing Then
    'Attribute doesnt exist
Else
    'Attribute does exist
End If 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-09T17:17:25.100

**编辑：**我的帖子试图回答@Judy 提出的原始问题。它没有直接解决目前存在的问题（和标题）的高度修改版本。

* * *

您可以通过以下方式检查元素“Store”是否存在：

```
Dim storeNode as XmlNode = doc.SelectSingleNode("Store")
If storeNode isnot Nothing Then
  'The "Store" node was found.
Else
  'The "Store" node was not found.
End If 
```

因此，您可以通过以下方式检查 StoreNode 中是否存在属性 test：

```
Dim testAttribute as XmlAttribute = CType(storeNode.Attributes.GetNamedItem("Test"),  XmlAttribute)

If testAttribute isnot nothing then
  'The "Test" attribute was found.
Else
  'The "Test" attribute was found.
End If 
```

最后，您可以通过以下方式检查“Test”属性是否包含值“test.doc”：

```
If testAttribute.Value = "test.doc" Then
  'The value matches.
End If 
```

我相信您现在可以将这三个检查组合成一个块。我在这个明显冗长的解释中的目的是澄清这个概念。

# c# - 使用 Visual Studio 制作非 aspx 代码隐藏页面

> ID：627094
> 
> 赞同：3
> 
> 时间：2009-03-09T16:57:28.130
> 
> 标签：c#, .net, visual-studio, intellisense

我想构建自己的“代码背后”，例如页面，这样我就可以在 HTML 文件中包含 HTML，在 cs 文件中包含代码，但能够为 HTML 文件中的令牌提供 Intellesense。（我知道这就是 .NET 页面类所做的，但我想要更轻松的东西）

EG：在 .html 文件中：

```
<%@ Directive classname="HTMLSnippet" %>
<html>
   <body>
     <div>[%message%]
   </body>
</html> 
```

并在 .cs 文件中

```
public class MyClass : HTMLSnippet
{
   public class MyClass () {
      snippet.message = "message goes here"
   }
} 
```

所以我的问题是如何制作 HTMLSnippet 类，以便自动创建它的成员，并在我将令牌添加到 .html 文件时特别显示在 Intellesense 中？

我知道.net目前通过创建designer.cs文件来完成它，并且基本上构建了一个包含页面中所有元素的类，这可以正常工作，但是我怎样才能让Visual Studio在编译之前生成它，以便它出现在 Intellesense 中。谢谢！

**澄清** 我还没有将它用作处理程序，我想用它来使带有标记的 HTML 片段可在代码中用作具有属性的对象。所以几乎就像一个自定义控件。我认为我要做的是创建一个 VS 加载项，等待我将令牌输入到 .html 文件中，然后它会自动创建一个 .cs 文件，其中包含每个令牌的成员。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T17:07:46.450

首先，如果您不想膨胀，那么 ASPX 页面中不会有太多膨胀。除了@ Page 指令标签之外，你几乎可以去掉所有东西。如果您不想在客户端膨胀，您也可以关闭视图状态，所以我认为没有理由重新发明轮子。

如果您想减少臃肿，请考虑使用 ASP.NET MVC。如果我猜对了，你会在 MIX 上看到 RTM，因为微软喜欢在会议上发布东西。如果不是，那就是RC2，所以RTM也不是那么遥远。在 ASP.NET MVC 中，ASPX 页面可以非常薄，因为它们只是视图。

如果您想以自己的方式解决这个问题，您可以使用 HTTP 处理程序来处理类型。我不会将其保留为 .htm 或 .html，因为您将制作它，因此您无法在服务器上提供标准的 .html 文件，这不好。这解决了处理问题，这只是你成功的一半。

我不确定处理 Intellisense 的最佳方法。一种方法是参考，如 Stagner 的博客所示： [http ://weblogs.asp.net/joestagner/archive/2008/05/12/add-custom-javascript-intellisense.aspx](http://weblogs.asp.net/joestagner/archive/2008/05/12/add-custom-javascript-intellisense.aspx)

尽管它应该可以工作，但我还没有尝试过使用自定义扩展。您还可以创建自己的自定义 XSD (XML) 文件，ala：http: [//vyasashutosh.blogspot.com/2007/05/providing-custom-intellisense-in-vsnet.html](http://vyasashutosh.blogspot.com/2007/05/providing-custom-intellisense-in-vsnet.html)

就个人而言，我会使用 ASPX 模型并减少不需要的部分。如果您愿意，您甚至可以修改模板，这样您就可以在每个页面上执行此操作。您无法摆脱 @page 指令，但如果它过于臃肿，我不确定 ASP.NET 是否是您希望使用的模型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T17:10:37.050

并不是我同意你的观点，但你可以在后面的代码上创建受保护的变量，并按照你尝试的方式使用它们。

在代码后面：

```
protected string myVar1 = "Hello World" 
```

在 HTML 中：

```
<html>
   <body>
     <div><%= myVar1 %>
   </body>
</html> 
```

再次，我只想明确表示，以这种方式工作会倒退一步，我建议不要这样做。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T17:12:11.400

试试[MVC 框架](http://www.asp.net/mvc/)。

否则使用 PHP、DJANGO、ROR 或其他一些完全支持模板的框架。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-06-14T22:27:56.297

或者尝试使用 spark for asp.net 它尝试通过使用 xml 标记 IE 来消除对内联脚本标签的需要

```
<% foreach( string key in collectionOfItems.Keys ) %>
<div><% =key %></div>
<% } %> 
```

变成类似的东西

```
<foreachcollectionOfItems.Keys >
<div>$key</div>
</foreach> 
```

注意我的例子是更好的废话和错误，但你明白了。谷歌它...火花

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-09T17:33:27.917

我相信如果您从抽象 UI.TemplateControl 继承您的类，您将获得此功能。我正在浏览接口，看看是否只需实现一个特定的接口就可以为您提供此功能，但是，我猜您是否需要此功能，这就是您需要做的。

# operating-system - 是否可以不使用一行 C/C++ 代码来编写整个操作系统？

> ID：627095
> 
> 赞同：14
> 
> 时间：2009-03-09T16:57:28.393
> 
> 标签：operating-system

是否可以不使用一行 C/C++ 代码来编写整个操作系统？

编辑：要添加到列表中的另一个 - 程序集

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2009-03-09T17:23:14.290

是和不是。

首先，重要的是要记住无论您选择哪种语言，最终编译的产品都是汇编语言（或更准确地说是机器代码）。甚至解释器（例如 cpython 解释器）最终也会将您的脚本翻译成机器代码。

但这可能过于技术性并且错过了您问题的核心：

“我可以用高级语言编写操作系统吗？”

这个问题的答案既有个人的，也有技术的。

首先，个人方面：如果还不知道如何用汇编语言和 C 语言混合编写操作系统，那么您绝对没有机会尝试操作系统设计。

那些刚接触编程的人经常会遇到这类问题，因为他们想做一些像编写新操作系统一样酷的事情，甚至不需要尝试这样的项目所需的所有学习。他们想知道高级语言是否可以成为绕过所有混乱学习的一种方式。

所以，如果，在你的内心深处，这就是你所追求的，现在就停下来。停，停，停。擅长某事是一项艰苦的工作。没有捷径。准备好卷起袖子，患上腕管综合症。

这并不排除遵循最终操作系统设计的道路！如果那是你的激情所在，那就从头开始，一路向下。获取有关网络协议、内存管理、线程等方面的书籍，处理每个主要子系统并深入了解它。如果你不能使用旧的，你就不能写一个新的！

然后阅读有关操作系统设计和实现的书籍，直到您梦想着进程管理方法。

请记住，所需的知识量（不仅是计算机操作，还包括 API 等社会结构）是巨大的。这是一段漫长的旅程，也是一次收获颇丰的旅程。如果你真的像我一样喜欢这门手艺，即使你从未真正编写过操作系统，你也会很高兴你花时间。

现在，技术答案。您将需要一个引导加载程序，并且必须用汇编语言编写。毕竟，你的处理器不懂 C#。在引导加载程序阶段之后，您可以用任何您想要的语言编写您的操作系统代码并且它会运行，假设您的语言可以编译为机器代码二进制文件（而不是字节码！）

然而，即使在我们当前的“循环过剩”计算环境中，操作系统也必须精简高效，而这几乎不可能在更高级别的语言中实现，在解释语言中更是如此。

很有可能，您需要编写自己的给定语言的编译器/解释器作为操作系统的核心组件。该核心编译器可能只允许该语言的受限子集（并且您可以通过在受限子语言中编写更强大的编译器来引导）。否则性能会很差。

但所有这些都非常复杂，真正讨论这些问题需要您目前可能缺乏的知识深度。但是，如果您有这样做的动力，您可以轻松地改变它，然后我会很高兴整天讨论方法！

如果它让你感觉好些，我确实知道编写一个操作系统，但我仍然坐在那里做白日梦，试图弄清楚我可以用 python 编写多少操作系统。;)

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-03-09T16:59:37.157

是的。使用汇编程序。我会使用 Forth。Genera 是一个用 Lisp 编码的符号** 制作的操作系统。主要使用 C 是因为它是受信任的，我们知道它是如何工作的。宇宙中的每个 CPU 都存在 c 编译器。c 的编译器很容易构建。

** Symbolics 在互联网上注册了第一个域。（有趣的事实）

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-03-09T16:59:29.980

当然。您可以使用纯汇编程序或选择其他高级语言。

但你通常不想这样做。因为现代操作系统中所需的汇编代码量相当少。操作系统中的大多数代码不需要那么低的级别。

C 提供了一个很好的中间抽象级别，它仍然允许编写相当低级的代码，而不必处理汇编程序开发人员需要处理的*所有细节。*

编辑：一旦从方程式中删除程序集，它就会变得更加复杂。建立一个像样的操作系统需要执行几个机器代码指令，这些指令根本没有用高级语言表示（因为它们非常非常特定于机器）。从理论上讲，您可以在二进制 blob 中生成纯机器代码并从高级语言跳转到该位置，但我认为这是作弊，因为您必须首先提出该二进制 blob。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-03-09T17:00:19.510

是的，[MenuetOS](http://www.menuetos.net/)是仅使用汇编程序编写的操作系统示例。

由于您似乎对汇编程序不感兴趣，另请参阅[JNode](http://www.jnode.org/)，一个用 Java 编写的操作系统和[Singularity](http://research.microsoft.com/en-us/projects/singularity/)，一个用 C# 编写的操作系统。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-03-09T17:13:10.587

有许多尝试创建 JVM 的硬件实现。当然，此类硬件的操作系统将用 Java 编写。参见例如：[http ://www.jopdesign.com/](http://www.jopdesign.com/)

此外，[诺基亚的 S40](http://www.forum.nokia.com/Resources_and_Information/Explore/Software_Platforms/Series_40/)似乎主要是用 Java 开发的。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-03-09T17:01:21.940

当然。C/C++ 代码被编译成 ASM 代码，但是您可以以同样的方式使用许多其他语言。

您可能无法使用 Java 或 C#，因为它们依赖于虚拟机并且可以用 C 编写。

实际上，我相信有一个项目可以创建基于 LISP 的操作系统，但它失败了。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-03-09T16:59:53.363

当然。只要有可用的编译器可以生成适当的机器代码，任何语言都可以。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-03-09T17:19:24.393

查看[http://common-lisp.net/project/movitz/](http://common-lisp.net/project/movitz/)。这是一个完全用 Lisp 编写的操作系统。我认为它有自己的汇编程序，例如 Lisp 到机器代码翻译器。

我喜欢没有 C/C++ 的操作系统的想法，尤其是基于 Lisp 的操作系统。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-03-09T17:00:16.110

是的。显然，在组装中任何事情都是可能的，但通常不切实际。已经有一些尝试在托管代码（.NET、Java）中制作操作系统，并取得了不同程度的成功。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2014-01-07T23:31:46.320

如果你真的想要，那么是的，你可以在不使用汇编、C 或 C++ 的情况下编写一个完整的操作系统，但我认为这只会浪费时间。如果你愿意，你可以得到一个二进制编辑器并用二进制或十六进制对整个语言进行编程，这需要很长时间，但这是完全可能的。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-07-25T18:55:02.387

你可以用*机器代码*写吗？但这只是二进制。你可以在汇编中编写它，但这有一个复杂的结构。您可能应该用 C 编写它，因为它在编译时直接转换为机器代码，因此它比 C#/C++ 更快并且比汇编更简单

# html - 如何判断浏览器是否处于“怪癖”模式？

> ID：627097
> 
> 赞同：134
> 
> 时间：2009-03-09T16:57:55.100
> 
> 标签：html, browser, quirks-mode

假设您的页面具有相对严格的 doctype 和 HTML 标记，非常接近合规性，但可能会以一些愚蠢的方式遗漏，可能是因为用户内容超出了您的控制...假设您正在处理内容管理系统或内容管理系统的主题，您可以在其中控制一些基本结构并需要一些 javascript，但您不对页面中的其他所有内容负责。

当浏览器决定进入“怪癖”模式而不是使用它更符合标准的引擎时，你如何判断（或：什么将决定）？

我正在寻找每个主要浏览器的答案，因为 IE、Chrome、Safari 和 Firefox 当然都会以不同的方式处理这些问题。一个错误足以迫使它发生还是你有一些回旋余地？

* * *

## 回答 #1

> 赞同：164
> 
> 时间：2009-03-09T17:02:44.513

在**Firefox 和 Opera**中，您可以通过检查页面信息来确定您的浏览器是否处于“怪癖模式”。

使用`document.compatMode`, 将告诉您您在大多数浏览器中所处的模式。

在**Chrome、Safari 和 IE**中，在地址栏中运行此 javascript：

```
 javascript:window.alert('You are in ' + (document.compatMode==='CSS1Compat'?'Standards':'Quirks') + ' mode.') 
```

`javascript:`（请注意，由于最近的安全更改，您需要在粘贴到地址栏后重新输入该部分）

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-10-30T09:53:05.550

由于您可以在 JavaScript 中查询渲染模式，因此您可以拥有一个[Bookmarklet](http://en.wikipedia.org/wiki/Bookmarklet "维基百科关于书签的文章")，它会告诉您页面正在使用哪种渲染模式。

我发现[这个渲染模式小书签](http://dorward.me.uk/www/bookmarklets/qors/ "多尔沃德.me.uk")很适合我：

```
javascript:m=(document.compatMode=='CSS1Compat')?'Standards':'Quirks';window.alert('You%20are%20in%20'%20+%20m%20+%20'%20mode.'); 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-03-09T17:23:24.493

您的实际具体问题的完整答案是“一个错误是否足以迫使它发生，还是您有一些回旋余地？” 是它完全取决于错误。例如，

```
<!-- Comment -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> 
```

将在 IE 6 和 7 中强制使用 quirks 模式，尽管这并不是真正的错误（当文件的第一行不是声明时，它们只会抛出一个完全不稳定的问题）。可以在[此处找到类型/怪癖的快速列表](http://alastairc.ac/testing/IE_Doctypes/)

尝试在您的 HTML 中粘贴以下行进行测试（非常糟糕的 javascript 行为我在这里传递 - 抱歉...确保这永远不会上线 :)

```
<a href="javascript:alert(document.compatMode);">What mode am I?</a> 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-09T17:06:56.997

根据[http://www.quirksmode.org/css/quirksmode.html](http://www.quirksmode.org/css/quirksmode.html)：“问题在于某些以 quirks 模式编写的页面确实具有 doctypes。因此每个浏览器都有自己的列表，其中包含触发 quirks 模式的 doctypes。请参阅此浏览器这些列表概述的比较图表：http: [//hsivonen.iki.fi/doctype/](http://hsivonen.iki.fi/doctype/) “

希望这可以帮助

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-09T17:02:58.707

如果您告诉 IE 它应该是严格的（通过 doctype），它不会在页面中途改变主意。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-09T17:23:30.313

如果我正确理解了 quirks 模式，那么一个不针对其声明的 doctype 进行验证的页面不足以触发 quirks 模式。它只是无法正确显示。

我找到的用于确定不同浏览器如何处理每种文档类型的最佳资源在[这里](http://hsivonen.iki.fi/doctype/)。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-07-15T08:14:19.183

对于添加了 Web Developer Toolbar 的 Firefox，您可以查看工具栏右侧的三个图标。最左边的一个告诉你你处于什么模式。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-08-07T13:39:53.860

在 IE 中，您将在开发人员工具中看到它（按 F12），它在菜单中显示：文档模式：... 您还可以在那里强制使用不同的模式。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-03-05T08:09:06.993

在html5页面中，写“ `<!DOCTYPE html>`”开头的页面可以改为document.compatMode='CSS1Compat'

# java - 在 Java 中，我应该使用什么来首先返回最大元素的 PriorityQueue？

> ID：627130
> 
> 赞同：2
> 
> 时间：2009-03-09T17:04:41.357
> 
> 标签：java, compare, compareto

Java 的[PriorityQueue](http://java.sun.com/j2se/1.5.0/docs/api/java/util/PriorityQueue.html)将最小的元素放在列表的头部，但是我需要它将最大的元素放在头部。获得这样的优先级队列的最佳方法是什么。

由于我编写了存储在此队列中的类，因此我可以简单地反转 的结果`compareTo`，它不在此队列之外使用。

但是，我喜欢使代码准确地表示我正在建模的内容，我想做的是首先获得最大的，所以代码应该这样说，而不是首先使用不寻常的最少定义。

[编辑]只是快速感谢大家，Comparator 听起来就像我自学如何编写一个时所需要的。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-09T17:07:46.933

[当您实例化PriorityQueue](http://java.sun.com/javase/6/docs/api/java/util/PriorityQueue.html "Priority Queue JavaDoc")时，传递一个反转自然顺序的[Comparator](http://java.sun.com/javase/6/docs/api/java/util/Comparator.html "比较器 JavaDoc")。

它看起来像这样：

```
public class ReverseYourObjComparator implements Comparator<YourObj> {
    public int compare(final YourObj arg0, final YourObj arg1) {
        return 0 - arg0.compareTo(arg1);
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-09T17:09:31.190

您的问题基本上有解决方案：您可以将[Comparator传递给](http://java.sun.com/j2se/1.5.0/docs/api/java/util/Comparator.html)[PriorityQueue](http://java.sun.com/j2se/1.5.0/docs/api/java/util/PriorityQueue.html)的构造函数。比较器将影响物品的订购方式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-09T17:08:48.693

我只会使用比较器。这样排序顺序仅在您的队列中使用，而不是附加到您的班级。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-09T17:09:20.423

只需通过构造函数提供`PriorityQueue`自定义并更改元素的顺序。`Comparator<? super E>`

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-09T17:09:22.313

从javadocs：

```
PriorityQueue(int initialCapacity, Comparator<? super E> comparator) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-09T17:36:01.547

要添加到比较器评论，请查看：

```
Collections.reverseOrder(); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-09T17:12:24.677

PriorityQueue 上的 api 文档说：“这个队列的头部是相对于指定排序的最小元素”。因此，最小的定义是基于您的特定顺序的主观定义，这就是您可以选择提供比较器的原因。

# c++ - GetDiskFreeSpaceEx 报告错误的可用字节数

> ID：627131
> 
> 赞同：3
> 
> 时间：2009-03-09T17:05:06.753
> 
> 标签：c++, winapi, types, windows-ce

```
__int64 i64FreeBytes
unsigned __int64 lpFreeBytesAvailableToCaller,
                 lpTotalNumberOfBytes,
                 lpTotalNumberOfFreeBytes; // variables used to obtain 
                                           // the free space on the  drive

GetDiskFreeSpaceEx (Manager.capDir,
(PULARGE_INTEGER)&lpFreeBytesAvailableToCaller,
(PULARGE_INTEGER)&lpTotalNumberOfBytes,
(PULARGE_INTEGER)&lpTotalNumberOfFreeBytes);

i64FreeBytes = lpTotalNumberOfFreeBytes;
_tprintf(_T ("Number of bytes free on the drive:%I64u \n"),
     lpTotalNumberOfFreeBytes); 
```

我正在研究一个数据管理例程，它是一个 Windows CE 命令行应用程序。上面的代码显示了我如何获取包含文件夹 Manager.capdir 的特定驱动器上的可用字节数（它是包含目录完整路径名的变量）。

我的问题是，上述代码（_tprintf 语句）报告的空闲字节数与驱动器的空闲字节数不匹配（我通过右键单击驱动器来检查）。

我想知道这种差异的原因是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T19:59:23.963

引用（编辑）[GetDiskFreeSpaceEx](http://msdn.microsoft.com/en-us/library/aa364937(VS.85).aspx)的文档，强调我的：

> lpFreeBytesAvailable [out, optional]-
> 
> **指向变量的指针，该变量接收与调用线程关联的用户可用**的磁盘上可用字节总数。
> 
>  **此参数可以为 NULL。
> 
> **如果正在使用每用户配额，则此值可能小于磁盘上的可用字节总数。**
> 
> lpTotalNumberOfBytes [out, optional]-
> 
> 指向变量的指针，该变量接收**与调用线程关联的用户可用的磁盘上的总字节数。**
> 
> 此参数可以为 NULL。
> 
> **如果正在使用每用户配额，则此值可能小于磁盘上的总字节数。**
> 
> 要确定磁盘或卷上的总字节数，请使用 IOCTL_DISK_GET_LENGTH_INFO。**

 **换句话说，这个数字取决于用户，如果你想匹配资源管理器返回的值，使用`lpFreeBytesAvailable`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T20:26:46.580

我有一台没有磁盘配额的单用户机器在运行。我将您的代码发布到基于对话框的 MFC 应用程序中并运行它，附带条件是我使用“C:\”作为 lpDirectoryName 参数，以便与系统报告的驱动器可用空间进行比较。这似乎是合乎逻辑的，因为可用空间仅对驱动器有意义，而不是文件夹。

起初我以为我遇到了类似的问题，但后来我重新运行了检查（我将它绑定到一个按钮），并得到了与当时的属性对话框相同的**结果**。似乎驱动器上的可用空间是一个相当动态的数量 - 如果它是系统驱动器，这并不令人惊讶 - 即使没有其他海报完全正确报告的标准，您可能看不到与属性完全相同的数字对话框在运行时报告。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T17:09:42.687

我想到了一种可能性。也许没有考虑到分区丢失的空间（Windows 通常在驱动器末尾留下 8MB 作为松弛空间）。基本上，物理驱动器上的剩余空间与分区所代表的逻辑空间之间存在差异。或者文件系统本身丢失的空间。

我不能说这些是否真的是这样，但我会调查一下。

# c++ - 如何处理子类和父类中的通知消息？

> ID：627143
> 
> 赞同：1
> 
> 时间：2009-03-09T17:08:15.933
> 
> 标签：c++, winapi, mfc, tabcontrol

我有一个自定义的 CTabCtrl，我正在尝试自定义（自动更改页面）。

如果我`ON_NOTIFY_REFLECT(TCN_SELCHANGE, ...)`在我的选项卡控件中处理，`ON_NOTIFY(TCN_SELCHANGE, ...)`则父类不会收到。

如何在子类和父类中同时接收通知消息？

目前我正在使用手动将 WM_NOTIFY 消息发送到父类的“解决方法”：

```
void CMyTabControl::OnSelChange(NMHDR *pHeader, LRESULT *pResult)
{
    const int index = this->GetCurSel();
    this->ShowTab(index);

    const CWnd *const pParent = this->GetParent();
    if (pParent != NULL)
    {
        *pResult = pParent->SendMessage(WM_NOTIFY, TCN_SELCHANGE, 
            reinterpret_cast<LPARAM>(pHeader));
    }
} 
```

**编辑：**我已经尝试过 *pResult = 0 和 *pResult = 1 但它仍然没有将消息发送到父级。另外，我注意到当我将消息发送给父级时，我最终陷入了一个几乎无限的循环（由于某种原因，它确实会在多次迭代后中断）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T12:45:17.010

我找到了答案：

[http://msdn.microsoft.com/en-us/library/eeah46xd.aspx](http://msdn.microsoft.com/en-us/library/eeah46xd.aspx)

基本上，您必须使用`ON_NOTIFY_REFLECT_EX`然后从您的函数中返回 FALSE 才能触发父通知消息。

# .net - 在 .Net @ VS. 中使用 MySQL 准备语句？

> ID：627155
> 
> 赞同：0
> 
> 时间：2009-03-09T17:10:38.753
> 
> 标签：.net, mysql, prepared-statement

根据[MySQL .Net 连接器文档](http://dev.mysql.com/doc/refman/5.0/en/connector-net-using-prepared.html)，在运行准备好的语句时，@ 符号用于定义参数。尝试此操作时出现错误。然后页面底部的用户评论说如果您有问题，请替换 ? 对于@ 字符。有什么方法可以控制 MySQL 对准备好的语句期望什么字符？我希望它习惯于“@”符号，因为它会使它更类似于我试图从中迁移的 SQL Server。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T14:07:17.653

> [Old Syntax, OldSyntax](http://dev.mysql.com/doc/refman/5.0/en/connector-net-examples-mysqlconnection.html#connector-net-examples-mysqlconnection-connectionstring) : 允许使用“@”符号作为参数标记。此选项在 Connector/NET 5.2.2 中已弃用。所有未来的代码都应使用“@”符号编写。

```
MySqlConnection myConnection = new MySqlConnection();
myConnection.ConnectionString = "**OldSyntax=true**; server=myHost; database=myDB; Username=myUser; pwd=myPass; ";
myConnection.Open(); 
```

# php - CodeIgniter - 模型的多个实例

> ID：627166
> 
> 赞同：1
> 
> 时间：2009-03-09T17:15:32.407
> 
> 标签：php, codeigniter

我使用 CodeIginter 作为我的 PHP 框架。我正在解释以下情况：-

我需要三个名为：-

*   用户模型
*   关系模型
*   提醒_型号

现在考虑一下情况：

`User_Model`已经写好了。我在写`Relation_Model`。我的朋友会写`Reminder_Model`。

`Relation_Model``User_Model`在其方法之一中实例化并使用它：`getRelation($userID)`

`Reminder_Model`还`User_Model`为其运行实例化一个实例。

`Reminder_Model`需要调用`getRelation`Relation_Model 的方法。

因此，应该至少有两个`User_Model`. 一进一`Relation_Model`进`Reminder_Model`。

问题是我如何确保**在里面** `Relation_Model`，我的`User_Model`实例不会干扰`User_Model`我朋友`Reminder_Model`班级的实例？

也就是说，要编码`Reminder_Model`，朋友应该没有内行`Relation_Model`，只是用了它的一种方法`getRelation`。

如果您想知道对此的需求，例如： Reminder_Model 加载已登录用户（例如 user-A）的模型，Relation_Model 与作为 user-A 团队成员的用户的模型一起使用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T21:31:30.823

我不确定我是否理解为什么你不能使用 User_Model 类的同一个实例，但可能会加载模型两次，一次使用普通的旧**$this->load->model('User_Model')**，第二次使用**$this ->load->model('Use_Model', 'Second_User_Model')**会有所帮助。或者您可以像**$this->second_user_model = clone $this->user_model那样**[克隆](http://www.php.net/language.oop5.cloning)对象。

 **# usability - 我如何知道用户的带宽以提供我的 Web 应用程序的最佳版本？

> ID：627168
> 
> 赞同：1
> 
> 时间：2009-03-09T17:16:10.407
> 
> 标签：usability, progressive-enhancement

我们正在开发一个具有异构用户群的 Web 应用程序。此外，我们必须提供视觉上吸引人的体验。因此，我想知道是否有任何方法可以以这种方式获得用户带宽的估计值，以便我们可以决定是提供给定版本还是另一个版本。

还是我应该瞄准最低分母？

无论涉及何种技术：对于这种情况，我与平台无关（例如，用于估计用户能力的 flash 小程序就可以了）。我只是想听听你的建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T17:26:17.607

IMO 在需要选择的情况下，这些事情最好留给用户来决定。有些人会很高兴地等待更丰富的体验，而另一些人则无论如何都想要快速和快速。

您可以有一个带有图像/闪存的登录页面，该页面可以计算使用时间，然后提供指向两者的链接以及建议，这将是考虑到用户带宽的最佳体验。将此选项存储为 Cookie，然后在将来绕过加载页面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T17:23:59.330

如果您想确定特定客户端的吞吐量，您可以计算将已知大小的有效负载传输到客户端所需的时间，并从中推断出它们的带宽。或者您可以让 Flash 存根加载剩余的内容，如果花费的时间太长，则默认为不同的版本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T15:33:19.823

网络上最受欢迎的网站的界面几乎不包含任何图形。（当然，我说的是谷歌。）

设计一个为所有用户快速加载的网站，具有他们想要的功能，并且美观，并且您的用户会喜欢它。通过充分利用颜色、文本布局和备用图像，可以在很少的字节内实现视觉吸引力。不需要庞大的 Flash 应用程序、声音、动画或其他带宽杀手。人们对邀请他们加入并正确对待他们的网站做出回应。

寻找低带宽的方式来提供惊喜，例如微妙地改变颜色的鼠标悬停行为，或提供重音的小图像。

# sql-server - SSIS：如何使用单个包配置文件使用部署实用程序

> ID：627169
> 
> 赞同：0
> 
> 时间：2009-03-09T17:16:11.203
> 
> 标签：sql-server, ssis

我正在尝试使用跨包共享的单个包配置文件为解决方案创建部署实用程序。
当我尝试构建解决方案来创建部署实用程序时，构建过程失败，说包配置文件已经存在......

有任何想法吗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T02:16:04.230

Is there an option to overwrite that file? There are similar settings in Reporting services concerning datasources...

Don't know about that though - we set an env variable on the server which points to the sql instance with the ssis config db and then the package finds the ssis configurations database in that instance.

# c# - Resharper Trap“转换为'return'语句”

> ID：627172
> 
> 赞同：6
> 
> 时间：2009-03-09T17:17:23.557
> 
> 标签：c#, resharper, ternary-operator

给定以下例程：

```
private static object ParseNumber(string token, FieldDefinition def)
{
  if (def.Fraction > 0)
    return Double.Parse(token);
  else
    return Int64.Parse(token);
} 
```

Resharper 为我提供了使用三元运算符将其重构为语句的选项：

```
private static object ParseNumber(string token, FieldDefinition def)
{
  return def.Fraction > 0 ? Double.Parse(token) : Int64.Parse(token);
} 
```

谁能发现陷阱？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-09T17:26:12.037

好的，换成上一个答案。`Int64`因为存在从to的隐式转换`Double`（但反之亦然），所以这将是表达式的结果类型。因此，当您期望得到一个 boxed`Int64`时，您实际上得到了一个 boxed `Double`（但其值最初来自`Int64.Parse`）。

以防万一还不够清楚，让我们更改所有`return`语句，使它们只返回一个变量。这是原始代码：

```
private static object ParseNumber(string token, FieldDefinition def)
{
  if (def.Fraction > 0)
    return Double.Parse(token);
  else
    return Int64.Parse(token);
} 
```

适当地转换它：

```
private static object ParseNumber(string token, FieldDefinition def)
{
  if (def.Fraction > 0)
  {
    double d = Double.Parse(token);
    object boxed = d; // Result is a boxed Double
    return boxed;
  }
  else
  {
    long l = Int64.Parse(token);
    object boxed = l; // Result is a boxed Int64
    return boxed;
  }
} 
```

现在让我们对带有条件运算符的版本做同样的事情：

```
private static object ParseNumber(string token, FieldDefinition def)
{
  return def.Fraction > 0 ? Double.Parse(token) : Int64.Parse(token);
} 
```

变成

```
private static object ParseNumber(string token, FieldDefinition def)
{
  // The Int64.Parse branch will implicitly convert to Double
  double d = def.Fraction > 0 ? Double.Parse(token) : Int64.Parse(token);
  object boxed = d; // *Always* a Double
  return boxed;
} 
```

编辑：根据要求，提供更多信息。表单的条件表达式的类型

```
X ? Y : Z 
```

取决于 and 的类型`Y`，`Z`我将其称为`TY`and `TZ`。有几个选项：

*   `TY`并且`TZ`是同一类型：结果是该类型
*   `TY`有一个从to`TZ`但不是 from `TZ`to的隐式转换`TY`：结果是类型`TZ`，如果使用第一个分支，则使用转换。
*   `TZ`有一个从to`TY`但不是 from `TY`to的隐式转换`TZ`：结果是类型`TY`，如果使用第二个分支，则使用转换。
*   在两个方向都有一个隐式转换：编译时错误
*   两种方式都没有转换：编译时错误

这有帮助吗？

# php - Web 框架的可维护性

> ID：627185
> 
> 赞同：0
> 
> 时间：2009-03-09T17:21:10.567
> 
> 标签：php, ruby-on-rails, django

希望这是为这个 Web 应用程序选择实现语言的最后一个问题，但在向任何人推销之前，我们想知道您在维护应用程序方面的经验。

我们维护了一个基于 Perl 的 Web 门户（并且后来迁移到了托管解决方案）。

问题是我们遇到过更新 Perl 或更新模块的情况，并且由于整个网站是相互连接的，因此很容易成为一场噩梦，因为 CPAN 模块中的一个小改动可能会导致整个网站死掉（这是一个开放的源门户，我们没有创建它）因为门户中的某些内容非常具体地说明了它将接受什么版本的模块。

有几次，一组无害的安全更新可能会导致网站在很长一段时间内崩溃。

那么，在决定创建基于 PHP、Django 或 Ruby on Rails 的 Web 应用程序时，人们能否分享在升级全部或部分框架或语言时对网站进行的维护？

尝试为您未创建的模块/gem 安装安全修复程序时，破坏或故障 Web 应用程序有多“容易”？还是真的不是问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T17:40:39.460

如果这些天我正在部署一个 python 应用程序，我肯定会检查[virtualenv](http://pypi.python.org/pypi/virtualenv)。

从他们的页面：

> virtualenv 是一个创建隔离 Python 环境的工具。
> 
> 正在解决的基本问题是依赖关系和版本之一，以及间接权限。想象一下，您有一个应用程序需要 LibFoo 版本 1，但另一个应用程序需要版本 2。您如何同时使用这两个应用程序？如果您将所有内容都安装到 /usr/lib/python2.4/site-packages（或任何您平台的标准位置），很容易导致您无意中升级不应升级的应用程序。
> 
> 或者更一般地说，如果你想安装一个应用程序并让它保持不变怎么办？如果应用程序正常工作，其库或这些库版本的任何更改都可能破坏应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T17:26:56.170

使用 Django，在点修订之间升级时我从来没有遇到过任何问题（我的一些项目从 0.96 左右开始就一直在比特腐烂，所以它们更复杂）。就可重用应用程序而言，它实际上取决于应用程序。不过，总的来说，有足够纪律性来发布他们的应用程序（而不是假设人们会运行开发版本）的开发人员往往擅长确保版本之间的迁移是无痛的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T18:12:41.363

只需在您的[tests.py](http://docs.djangoproject.com/en/dev/topics/testing/)中包含一些[回归测试](http://en.wikipedia.org/wiki/Regression_testing)。如果你不测试，你做错了......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T19:01:06.473

Python 的 easy_install 和 distutils 为您提供了一种非常可靠的方法来确定您需要哪些版本。很少有使接口失效的意外安全更改。

# php - PHP语法检查？

> ID：627193
> 
> 赞同：1
> 
> 时间：2009-03-09T17:23:04.837
> 
> 标签：php, syntax, text-editor

我正在使用 TextWrangler 来编辑 PHP 代码。我经常遇到代码在我的开发环境中只是显示为空白页的问题。有没有更好的方法来进一步定位我应该在代码中查找问题的哪个位置？

现在，我只是在遇到此问题时手动运行每一行，但我猜有某种解决方案，但我无法找到它的名称。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T17:26:27.263

您应该确保您的开发 php.ini 文件包含：

```
display_errors = On
error_reporting  =  E_ALL 
```

或者

```
display_errors = On
error_reporting  =  E_ALL | E_STRICT 
```

即使打开这些，有时内存不足错误也会导致空白页。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T17:26:33.207

将 php.ini 设置`error_reporting`为 E_ALL

```
display_error = On
error_reporting = E_ALL 
```

您也可以在您的代码中执行此操作。

```
error_reporting(E_ALL); 
```

或者

```
ini_set('error_reporting', E_ALL); 
```

您可以在此处阅读有关[错误报告的更多信息。](http://is.php.net/error_reporting)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T17:27:57.667

在开发过程中，您应该始终将[错误报告](http://docs.php.net/manual/en/function.error-reporting.php)设置为最高级别（[`E_ALL`](http://docs.php.net/manual/en/errorfunc.constants.php#errorfunc.constants.errorlevels.e-all)/ [`E_STRICT`](http://docs.php.net/manual/en/errorfunc.constants.php#errorfunc.constants.errorlevels.e-strict)）以获取报告的每个错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-16T22:22:12.593

我已经为此苦苦挣扎了一段时间（学生在我的一些课程中学习 PHP），因为我尝试使用

```
ini_set('display_errors', 1); 
```

正如建议的那样（例如 Ullman 的 PHPv6 和 MySQL 5），但是将它放在您的代码中并没有捕获任何解析错误。相反，我继续看到空白页。

PHP Manual 网页中的[评论](http://is.php.net/manual/en/function.error-reporting.php#85096)给了我一个关于为什么设置的线索

```
display_errors = On 
```

在 php.ini 中与添加不太一样

```
ini_set('display_errors', 1); 
```

在您的 php 脚本的顶部。似乎 PHP 有一个 2 阶段操作，并在开始执行任何脚本文件之前完全解析脚本文件。如果由于缺少“;”而导致解析失败 或“）”，然后

```
ini_set('display_errors', 1); 
```

gets parsed but never executed and so the parse error is not reported. The same comment offers a way to report parse errors if you do not have the means to change the php.ini settings.

# php - 混用 PHP 的 mysqli 数据访问功能？

> ID：627197
> 
> 赞同：0
> 
> 时间：2009-03-09T17:23:17.427
> 
> 标签：php, sql, mysqli

在过去的几天里，我看到了几个问题，`mysqli`但这些问题的答案似乎没有认识到`$stmt->execute()`和之间的区别`$db->query()`。

据我了解，有两种不同的模型可用于访问`mysqli`.

这个使用原始 SQL 并要求程序员转义输入以防止 SQL 注入攻击，但允许程序员检索包含`column => value`映射的关联数组（或普通数组）：

```
$result_set = $db->query("SAFE SQL QUERY HERE");
while ($row = $result_set->fetch_assoc()) {
     # do something with $row['fieldname'];
} 
```

或者，您可以这样做，它允许很好地绑定参数和结果，但不能（AFAIK）为您提供任何类型的简单数组结果：

```
$stmt = $db-prepare("SQL QUERY WITH ? PLACEHOLDERS");
$stmt->bind_param("s", $input_variable);
$stmt->execute();
$stmt->bind_results($output_col1, $output_col2);
while ($stmt->fetch()) {
     # do something with $output_col1 and $output_col2
} 
```

我的问题是 - 有没有办法`mysqli`获得第一个模式中显示的简单数组输出，但仍然按照第二个模式使用安全绑定的输入参数？

我无论如何都找不到这样做（除了`PDO`改用！）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T17:57:46.750

阿尔尼塔克，

AFAIK，您不能自动将整个数组绑定到获取的结果。很遗憾。但是，如果您正在寻找其中的数组行为（大概是这样更容易传递结果），您可以试试这个：

```
<?php
 $dbh = new mysqli( ... );
 $arr = array();
 if( $stmt = $dbh->prepare( 'SELECT id, email FROM email_list' );
 {
  $stmt->execute();
  $stmt->bind_result( $arr['id'], $arr['email'] );

  while( $stmt->fetch() )
   DoSomething( $arr );
 }
?> 
```

这将为您提供上面所要求的行为。但是，它不会动态地将数组字段绑定到数组中的关联索引——也就是说，您必须指定将 id 绑定到 $arr['id'] 等。

如果您的方案确实需要动态绑定到关联索引，您总是可以编写一个简单的类，首先解析所选字段的查询，然后设置关联数组索引，然后执行查询。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T18:05:46.793

在 php 手册的此页面的评论中，有多种函数实现来执行此类操作：[mysqli_stmt::fetch](http://php.net/manual/en/mysqli-stmt.fetch.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T17:48:06.417

我会说不。以为我没有`mysqli`大量使用或准备语句，我相信您的第二个示例中的每个步骤都是离散且必要的。我能给您的唯一安慰是，您的第一个示例掩盖了一些 SQL 转义，您可以在第二个示例中安全且真正地忽略这些转义。

# c# - 你能在一个实际的例子中帮助我理解抽象类与接口的用法吗？

> ID：627199
> 
> 赞同：5
> 
> 时间：2009-03-09T17:23:26.070
> 
> 标签：c#, interface, abstract-class

您能否对抽象类与继承的使用有一个几乎过于简单化的理解并帮助我，以便我能够真正理解这个概念以及如何实现？我有一个我正在尝试完成的项目，但不知道如何实施。我一直在和我的教授聊天并且被告知很多，说如果我想不通，我可能还没有准备好参加这门课程。我已经覆盖了预先要求的课程，但仍然无法理解这些概念。

为了澄清，我到目前为止所做的项目如下。我还没有填写狗/猫课程等。能给我指点一下吗。我不要求任何人给我“答案”。我只是不知道该去哪里。我参加在线课程，他与我的沟通努力一直令人不安。我刚刚完成了所有其他课程的 4.0，所以我愿意付出努力，但我对这些概念的理解以及如何实际应用它们迷失了方向。

有什么意见或帮助可以让我在这个项目中取得进一步进展吗？

我要实现的描述如下：

> 概述：
> 
> 本练习的目的是演示接口、继承、抽象类和多态性的使用。您的任务是获取提供的程序外壳并添加适当的类和相应的类成员/方法，以使该程序正常运行。您不能对提供的任何代码进行更改，您只能添加您编写的类。尽管有很多方法可以让程序正常工作，但您必须使用能够演示接口、
> 继承、抽象类和多态性的技术。同样，为了清楚起见，您可以添加到提供的代码中，但不能更改或删除任何代码。提供的代码只需要很少的附加代码即可满足练习的要求。
> 
> 如果您成功完成分配，您的程序在运行时应输出以下语句：
> 
> 我的名字是斑点，我是一只狗
> 
> 我叫菲利克斯，我是一只猫
> 
> 要求：
> 
> 1) 您必须有一个名为“Animal”的抽象基类，Dog 和 Cat 类从该基类派生而来。
> 
> 2) Animal 基类必须从接口“IAnimal”派生，它是唯一应该从 IAnimal 派生的类。
> 
> 3) 由于所有动物都有名字，而且名字不是狗或猫特有的属性，因此 Animal
> 
> 基类应该是存储名称和实现 WhatIsMyName 获取属性的位置。
> 
> 4) 您将需要创建仅从 Animal 基类派生的 Dog 和 Cat 类。
> 
> 5) Dog 和 Cat 类应该实现 WhatAmI 获取属性并返回适当的字符串值。

您无法更改的代码：

```
using System;

namespace IT274_U2
{
    public interface IAnimal
    {
        string WhatAmI { get; }
        string WhatIsMyName { get; }
    }

    public class TesterClass
    {
        public static void DescribeAnimal(IAnimal animal)
        {
            Console.WriteLine("My name is {0}, I am a {1}", animal.WhatIsMyName, animal.WhatAmI);
        }

        static void Main(string[] args)
        {
            Dog mydog = new Dog("Spot");
            Cat mycat = new Cat("Felix");
            DescribeAnimal(mydog);
            DescribeAnimal(mycat);
        }
    }
} 
```

/////////////////////

到目前为止我写的代码：

```
using System;

namespace IT274_U2
{
    public interface IAnimal
    {
        string WhatAmI { get; }
        string WhatIsMyName { get; }
    }

    public class Dog
    {
        public abstract string WhatAmI
        {
            get;
            set;
        }
    }//end public class Dog

    public class Cat
    {
    public abstract string WhatIsMyName  
    {
        get;
        set;
    }
    }//end public class Cat

    public abstract class Animal : IAnimal
    {
    // fields
    protected string Dog;
    protected string Cat;

                  // implement WhatIsMyName 

    //properties
    public abstract String Dog
    {
        get;  
        set;
    }
    public abstract String Cat
    {
        get;
        set;
    }
    public abstract string WhatIsMyName();

    } //end public abstract class Animal

    public class TesterClass
    {
        public static void DescribeAnimal(IAnimal animal)
        {
            Console.WriteLine("My name is {0}, I am a {1}", animal.WhatIsMyName, animal.WhatAmI);
        }

        static void Main(string[] args)
        {

            Dog mydog = new Dog("Spot");
            Cat mycat = new Cat("Felix");
            DescribeAnimal(mydog);
            DescribeAnimal(mycat);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-09T17:35:12.313

接口和抽象类之间的主要区别在于，在接口中，您只定义实现该接口的对象的公共方法和属性。抽象类提供了一些基本实现，但有一些“差距”——继承者需要实现的抽象方法。

我不会为你做功课，而是一个提示：Animal 类不应该包含任何特定于狗和猫的东西。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-09T18:17:11.230

**编辑：**

我已经取出了每个类的代码主体 - 如果你想看到我的答案，请查看编辑修订 :)

首先我们定义[接口](http://msdn.microsoft.com/en-us/library/ms173156.aspx)

```
public interface IAnimal
{
    string WhatAmI { get; }
    string WhatIsMyName { get; }
} 
```

任何实现此接口的类都必须实现这些属性。接口就像合约；实现接口的类同意提供接口方法、属性事件或索引器的实现。

接下来，我们需要定义你的抽象 Animal 类

```
public abstract class Animal : IAnimal
{
    //Removed for Training, See Edit for the code
} 
```

[类是抽象](http://msdn.microsoft.com/en-us/library/sf985hc5(VS.71).aspx)的这一事实表明该类仅用作其他类的基类。我们已经实现了接口的两个属性，并且还有一个私有字段来存储动物名称。此外，我们将`WhatAmI`属性访问器抽象化，以便我们可以在每个派生类中实现我们自己的特定属性访问器逻辑，并且还定义了一个接受字符串参数并将值分配给`_name`私有字段的构造函数。

现在，让我们定义我们的`Cat`和`Dog`类

```
public class Dog : Animal
{
    //Removed for Training, See Edit for the code
}

public class Cat : Animal
{
    //Removed for Training, See Edit for the code
} 
```

这两个类都继承自`Animal`并且每个类都有一个构造函数，该构造函数定义一个字符串参数并将该参数作为参数传递给基本构造函数。此外，每个类都实现了自己的属性访问器`WhatAmI`，分别返回其类型的字符串。

对于其余的代码

```
public class Program
{
    public static void DescribeAnimal(IAnimal animal)
    {
        Console.WriteLine("My name is {0}, I am a {1}", animal.WhatIsMyName, animal.WhatAmI);
    }

    static void Main(string[] args)
    {
        Dog mydog = new Dog("Spot");
        Cat mycat = new Cat("Felix");
        DescribeAnimal(mydog);
        DescribeAnimal(mycat);
        Console.ReadKey();
    }
} 
```

静态方法`DescribeAnimal`接受 a作为参数，并为传入的`IAnimal`写出`WhatIsMyName`和属性访问器返回的值。`WhatAmI``IAnimal`

由于`Animal`implements `IAnimal`and both `Dog`and `Cat`inherit from `Animal`，任何`Cat`或`Dog`对象都可以作为参数传递给`DescribeAnimal`方法。

我希望我已经清楚地解释了这一点，如果有人觉得我的措辞需要收紧，请发表评论，我很乐意编辑我的答案。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-09T17:39:29.713

你已经很接近了，但是这比它需要的更难。

我不想给你答案；）但这里有一些建议。

首先，您要创建 3 个类和 1 个接口。但是，我认为您可能缺少的一件事是您需要 3 种不同类型的对象（从“最少定义”到“最多定义”）：

1) 接口
这是 IAnimal - 可以由任何可以像动物一样行动的东西来实现

2) 抽象基类 这是 Animal 类 - 任何是动物的东西都应该从 Animal 派生，但这些不能直接创建。如果你假装自己是上帝，你不会创造动物，你会创造狗、猫、松鼠或 FuzzyBunny

3) Animal 的具体实现这些是实际的类本身。这就是你创造的。狗或猫在你的情况下。

这里的技巧是你只能创建具体的类，但你可以使用 IAnimal 或 Animal（接口或抽象基类）来操作和使用任何动物（或者，在接口的情况下，任何像动物一样的东西）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-09T18:50:55.920

一般来说：

*   接口描述对象将响应的方法。这是对象承诺满足的契约。

*   抽象类描述了基本功能，并将专门的功能赋予子类。

因此，基本上，当您希望对象本质上不同时，您可以使用接口，响应相同的特定方法。

当您需要某个类的专门版本时，您可以使用抽象类。

假设您想创建一个系统，其中任何类型的对象都可以由唯一的 id 标识，并且您不关心它们所属的类。

你可能有：

*   动物

*   运输

*   电脑小工具。

*   任何。

由于它们是不相关的主题，您可以选择实现和接口，假设：

```
public interface IIdentifiable 
{ 

      public long GetUniqueId();
} 
```

并且所有想要满足这个契约的类都将实现那个接口。

```
public class IPod: IIdentifiable 
{
      public long GetUniqueId() 
      {
           return this.serialNum + this.otherId;
      }
}

public class Cat: IIdentifiable 
{
      public long GetUniqueId()
      { 
           return this.....
      }
} 
```

iPod 和 Cat 两者具有非常不同的性质，但它们都可能响应将在目录系统中使用的“GetUniqueId()”方法。

那么它可以像这样使用：

```
 ...

    IIdentifiable ipod = new IPod(); 
    IIdentifiable gardfield = new Cat();

    store( ipod );
    store( gardfield );

    ....
    public void store( IIdentifiable object )  
    {

         long uniqueId = object.GetUniqueId();
        // save it to db or whatever.
    } 
```

另一方面，您可能有一个抽象类来定义对象可能具有的所有常见行为，并让子类定义专门的版本。

```
 public abstract class Car 
  {
       // Common attributes between different cars
       private Tires[] tires; // 4 tires for most of them 
       private Wheel wheel; // 1 wheel for most of them.

        // this may be different depending on the car implementation.
       public abstract void move(); 
  }

  class ElectricCar: Car 
  {
      public void move()
      {
         startElectricEngine();
         connectBattery();
         deploySolarShields();
         trasnformEnertyToMovemetInWheels();
      }
  }

  class SteamCar: Car 
  {     
       public void move() 
       {
          fillWithWather();
          boilWater();
          waitForCorrectTemperature();
          keepWaiting();
          releasePreasure....
        }
   } 
```

在这里，两种汽车，以不同的方式实现“移动”方法，但它们在基类中仍然共享共同的东西。

为了让事情更有趣，这两辆车可能也实现了 de IIdentifiable 接口，但这样做，它们只是承诺响应 GetUniqueId 方法，而不是作为汽车的性质。这就是为什么 Car 它自己可能无法实现该接口的原因。

当然，如果标识可以基于汽车可能具有的公共属性，则 GetIdentifiableId 可以由基类实现，子类将继承该方法。

// case 1 ... 每个子类都实现了接口

```
 public class ElectricCar: Car, IIdentifiable 
   {
       public void move()
       {
         .....
       }
       public long GetUniqueId() 
       { 
         ....
       }
   }

   public class SteamCar: Car, IIdentifiable 
   {
       public void move()
       {
         .....
       }
       public long GetUniqueId() 
       { 
         ....
       }
  } 
```

情况2，基类实现接口，子类从中受益。

```
 public abstract class Car: IIdentifiable 
   {
       // common attributes here
       ...
       ...
       ...

       public abstract void move();
       public long GetUniqueId()
       {
          // compute the tires, wheel, and any other attribute 
          // and generate an unique id here.
       }
   }

   public class ElectricCar: Car
   {
       public void move()
       {
         .....
       }
   }

   public class SteamCar: Car
   {
       public void move()
       {
         .....
       }
  } 
```

我希望这有帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-09T17:41:40.253

1.  接口是一种契约。这是您要描述您将提供的功能的地方，没有任何实现细节

2.  抽象类是一个类，其目的是在其子类之间共享实现细节。由于它在这里仅用于代码共享/分解目的，因此无法实例化

3.  您的实际类将从您的抽象类继承，并在需要时使用抽象类中共享的代码来实现其特定于类的功能。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-09T18:23:15.363

老实说，无论这是否是一个家庭作业问题，我都让业内不知道这一点的人感到害怕。因此我会回答。

接口抽象实现，抽象类也是如此。没有“vs”，因为您也可以创建一个实现接口的抽象类。所以不要以为他们在互相打仗。

因此，当您不希望消费者对实现了解太多时，可以使用 EITHER。接口在这项工作中要好一些，因为它没有实现，它只是说明消费者可以按下哪些按钮，然后将返回的值发送到抽象类可能声明的更多信息（甚至更多！） . 因此，如果您只是将这一点纳入船上，那么您实际上只需要接口。因此，第二点：

当您想在接口的两个不同实现之间共享公共代码时，使用抽象类。在这种情况下，两个具体的实现都继承自实现接口的抽象类。

简单的例子是 IDataStore。SavingToATextFile 数据存储只是一个实现 IDataStore 的类。但是 MsSqlDataStore 和 MySqlDataStore 将共享公共代码。它们都将继承自实现 IDataStore 的抽象类 SqlDataStore。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-09T17:36:09.580

抽象类：为派生类建立基础，它们为所有派生类提供契约。它强制执行层次结构

接口：

接口不是类，它是方法的定义。

一个类可以继承多个接口，但只能继承一个抽象类。

我希望这会有所帮助

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-09T17:44:25.630

基本上，接口定义了所有实现者必须提供的“契约”（即一组操作/属性）。在这种情况下，IAnimal 接口需要 WhatAmI 和 WhatIsMyName 属性。抽象类可能提供某些功能，但也会留下一些必须由其子类实现的操作。

在您的示例中，Animal 基类能够提供 WhatIsMyName 功能，因为“名称”是所有动物的属性。但是，它不能提供“WhatAmI”属性，因为只有特定的子类知道它们是什么“类型”。

您发布的示例代码的问题是，动物类知道它的子类，它不应该知道

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-09T18:11:09.683

另一个建议 - （稍微偏离主题，但仍然相关）

出于学习目的，我建议避免使用自动属性。如果您明确实施它们，它将帮助您了解正在发生的事情。

例如，不要这样做：

```
class SomeClass
{
   public string MyProperty
   {
       get;
       set;
   }
} 
```

尝试自己实现：

```
class SomeClass
{
    public string MyProperty
    {
        get
        {
             return "MyValue"; // Probably a private field
        }
        set
        {
             // myField = value; or something like that
        }
} 
```

我提到这一点是因为它会在这种特定情况下为您提供帮助。由于您使用的是自动属性，因此编译器会为您“填补空白”，在您的情况下，我认为它会阻止您获得一些非常有用的编译器错误。当试图理解这些概念是如何工作的时，自己动手通常会更容易，而不是更难。

# c - 为什么我必须在指针上使用 free 而不是普通声明？

> ID：627201
> 
> 赞同：12
> 
> 时间：2009-03-09T17:23:36.443
> 
> 标签：c, pointers, free

为什么我在声明指针时必须使用 free()，例如：

```
int *temp = (int*)malloc(sizeof(int))
*temp = 3; 
```

但不是当我这样做时：

```
int temp = 3; 
```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-03-09T17:25:24.893

普通声明放在堆栈上。当函数返回时，堆栈指针恢复到调用函数之前的值，因此内存被自动回收。

基于 Malloc 的声明是从“堆”分配的，这需要程序员管理分配和释放。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-09T17:29:33.637

您不必总是在指针上使用 free，只需使用 malloc 声明的指针。您可以声明一个指向堆栈上的内存位置的指针

```
int a = 3;
int* p = &a; 
```

当它超出范围时，这个内存（连同指针）也将被自动释放。使用 malloc 会在堆上分配相同的内存，因此您必须手动处理清理。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-09T17:30:56.533

因为该语言让您在堆栈和堆之间进行选择。

**您要在堆栈和堆之间进行选择的原因：**

*   堆上的变量故意不释放自己，以便您可以在代码块或函数的范围之外使用它们。
*   与堆相比，使用堆栈更有效
*   在大多数编译器上，您无法在运行时选择堆栈上的对象或数组的大小，因此此处将使用堆。

**为什么堆不能自动释放：**

因为没有办法知道你何时完成了记忆。有很多方法可以模拟垃圾收集，但这涉及到堆栈和堆中没有更多变量时持有指向堆上数据的指针。

**有关堆栈与堆的更多信息：**

C 语言让您选择是否要在堆栈或堆上定义变量。

*   堆栈上的变量在超出[范围](http://en.wikipedia.org/wiki/Scope_(programming))时会自动释放。
*   堆上的变量不会自动释放。

malloc 在堆上创建变量。一个简单的声明，例如 int x; 在堆栈上创建一个变量。

[在我的回答中查看关于堆栈与堆的进一步阅读](https://stackoverflow.com/questions/79923/what-and-where-are-the-stack-and-heap/79936#79936)。

**指针：**

只是为了澄清：指针变量是在堆栈上创建的，它们保存在堆上分配的数据的内存地址。它们在 32 位系统上占用堆栈上的 4 个字节，在 64 位系统上占用堆栈上的 8 个字节。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-09T18:59:58.130

应该注意的是，C 没有堆栈或堆的概念，尽管前面的答案在大约 99% 的情况下是正确的，并且给出了很好的见解。

C 定义了对象的三个存储持续时间：*静态*、*自动*和*分配*。（§6.2.4.1）

静态对象（例如全局变量）在整个程序期间都可用。

只要变量在范围内，自动对象就存在。一旦超出范围，它们就会不复存在。

请注意，这是两个极端。C 给你一个介于两者之间的点：*分配*的对象。（搜索词将*动态分配内存*。）通过这些，**您可以**告诉计算机对象应该何时开始和结束它们的存在。这是通过使用标准函数*malloc()*（或衍生物）和*free()*来完成的。

严格来说，您不必**调用**free *()*。或者你可能会这样做（你必须阅读标准以获得权威点），但你可以在程序终止之前在*main()结束时完成所有操作。*或者，将它留给操作系统为您完成（如果不是全部的话，大多数情况下都会这样做）。但这又是一个极端——当您调用*malloc()*时对象就会存在，当您的程序终止时就会消失。

我不必在这里详细讨论实际含义：内存是有限的。在内存不足之前，您只能分配这么多字节。对所有东西都使用*静态*对象太浪费了；尝试重用大块或一大块*静态*内存将是困难的，并且在任何情况下都类似于动态分配方法。对长寿命对象使用*自动*存储将迫使您使其范围尽可能大，无论如何大致对应于*静态对象的范围。*

--

现在，一些注意事项：

```
{
    int *temp = malloc(sizeof(int));
    *temp = 5;
    //free(temp);
} 
```

请注意，`temp`这里是一个自动对象。它只会在它的作用域内存活，它以 } 结尾。*但是，它指向*的对象已分配。它会一直存在，直到您在其地址上调用 free()。由于`temp`包含该地址的唯一副本，一旦`temp`超出范围，您将失去调用 free() 的机会。一些内存将被永久分配，但不可用。这称为*内存泄漏*。

*垃圾收集*是另一种管理对象存储的方法。C 中的实现可能如下所示：

```
{
    int *temp = gc_malloc(sizeof(int));
    *temp = 5;
} 
```

在 } 处，计算机将决定`temp`对分配对象的最后一个引用 , 丢失了，释放它是个好主意。

这是一种权衡，您不必担心释放对象（这不是一件小事，因为简单的示例可能会让您想到），但是这里的 gc_malloc() 比简单的 malloc() 更复杂)，并且在`temp`超出范围的} 处执行了不可见的代码。计算机如何决定这`temp`是最后一个参考，这是一个完全不同的话题。（一些实用的解决方案可能涉及您围绕“int *temp”编写更多代码。）

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-09T17:39:25.767

阿尔尼塔克是正确的。我想指出“在[堆栈](http://en.wikipedia.org/wiki/Call_stack)上”的真正含义。

当程序调用函数时，它希望函数完成一些工作，然后返回并继续下一行代码。当函数完成时，函数无法知道返回到哪里。因此，机器对每个程序都有一个调用栈，用于在调用函数之前将程序中以下语句的地址压入。“return”语句只是弹出程序地址并跳转到它。

堆栈也是一个方便的临时空间便笺簿。可以写入堆栈的未使用区域。在 C 函数中声明一个局部变量就是这样做的。当函数返回时，堆栈不需要被清理、释放或以其他方式处理，因为它只是一个临时空间，现在超出了范围。

相反，调用`malloc()`从堆中分配内存，堆显式地为程序留出内存并在程序运行期间保持在范围内。因此，如果您没有`free()`内存，它将保持分配状态并被视为内存泄漏。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-09T17:49:12.310

需要`free()`不取决于您是否声明了指针，而是取决于您是否已`malloc()`编辑内存。

正如 Brian Bondy 之前所说，变量（“ `int number`”、“ `char string[10]`”、“ `float your_boat`”等）在超出范围时消失，例如当您的代码离开功能块时。因此，您的问题中的指针（“ `temp`”）在您调用时不会消失`free()`- 相反，无论您在调用时分配的代码`malloc()`都会消失。你的指针仍然停留在那里，即在你的示例代码之后你可以说“ `temp = &some_other_variable`”而不必（再次）说“ `int *temp;`”。

如果有人实现了一个函数，他们也碰巧调用了这个函数，`malloc()`它会为你的程序申请内存，*并且不需要你释放那个数据*，那么你可以说

```
int * temp = (int*)malloc(sizeof(int)); 
```

后话不说

```
free(temp); 
```

但这不是`malloc()`实施的方式。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-09T17:36:35.507

进一步指出，[这篇文章](http://www.programmingforums.org/thread8786.html#9)进一步澄清了事情。

* * *

## 回答 #8

> 赞同：-9
> 
> 时间：2009-03-09T17:33:53.407

这是一个很好的问题，虽然很多人会回答这是堆栈分配和堆分配之间的区别，但基本的答案是底层系统向您暴露了一些不应该的东西。

当您分配内存时，您不必担心将其归还。系统应该足够聪明，可以确定您不再可以访问（指向或引用）它，因此它可以自动收回内存。

Java 和 C# 等较新的语言已经做到了这一点。

# sql - 使用 MySQL 搜索多个表

> ID：627210
> 
> 赞同：1
> 
> 时间：2009-03-09T17:24:58.360
> 
> 标签：sql, mysql, search

我正在编写一个 PHP/MySQL 程序，我想知道如何使用 MySQL 搜索多个表。

基本上，我在大多数网站的右上角都有一个搜索框，当用户在该框中搜索某些内容时，它需要在 users.username、users.profile_text、uploads.title、uploads.description、sets.description 和评论.文本。我需要获取 ID（存储在每个表的 id 字段中），如果可能的话，还需要一个类似 google 的摘录。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-09T17:28:13.453

您可以编写程序来单独查询这些表中的每一个，也可以创建一个相对简单的视图，将重要表的所有可搜索列与显示它们来自哪个表的指示符合并在一起。除了正常编写语句之外，没有真正的神奇方法来搜索多个表。

第二种方法看起来像这样：

```
(SELECT 'Table 1' AS TableName, id as Id, text as Searchable
FROM table1)
UNION
(SELECT 'Table 2' AS TableName, table2_id as Id, name as Searchable
FROM table2)
UNION
... 
```

然后搜索结果视图。需要注意的是，这种方法不会很快。

一个类似且更快的替代方法是将一个表专用于该任务而不是一个视图，并在实际表的插入/更新/删除时填充它，而不是在访问时重新计算它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T17:31:30.417

要编写为每个表量身定制的选择查询，您可以合并结果以获得一个结果集。它看起来像这样：

```
 select 'user-name', id, username from users where  username like '%term%'
 union
 select 'user-profile', id, profile from users where profile like '%term%'
 union
 select 'uploads-title', id, title from uploads where title like '%term%'
 union
 select 'uploads-description', id, description from uploads where description like '%term%' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-11T02:42:56.413

可能全文搜索就是你所需要的。

看着

*   [全文搜索的相关问题](https://stackoverflow.com/questions/394041/mysql-how-to-search-multiple-tables-for-a-string-existing-in-any-column)
*   [MySQL 文档](http://dev.mysql.com/doc/refman/5.0/en/fulltext-search.html)

# xslt - 如何使用 XSLT 1.0 将 ISO 8601 持续时间转换为秒

> ID：627212
> 
> 赞同：2
> 
> 时间：2009-03-09T17:26:00.133
> 
> 标签：xslt

看起来这在 XSLT 2.0 中很容易做到，但微软以其无限的智慧在 Visual Studio 2005 中不支持 XSLT 2.0。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T17:44:36.893

使用 XSLT 1.0，您必须使用 substring-before() 和 substring-after() 将其拆分为单独的字段。然后乘以。毫无疑问这是可能的，尽管它看起来很费力。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T17:51:21.180

一种选择是在 XSLT 中进行所有解析和计算。

但是，另一种选择是使用 C# 中的自定义脚本函数扩展 XSLT：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0"
                xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                xmlns:msxsl="urn:schemas-microsoft-com:xslt"
                xmlns:myext="urn:myExtension"
                exclude-result-prefixes="msxsl myext">

  <xsl:output method="xml" indent="yes"/>

  <msxsl:script language="C#" implements-prefix="myext">

    <![CDATA[

        public int SecondsFromIsoDuration(string isoDuration)
        {
            // parse and convert here;
        }

    ]]>

  </msxsl:script>

  <xsl:template match="@* | node()">
    <root durationInSeconds="{myext:SecondsFromIsoDuration(@duration)}" />
  </xsl:template>
</xsl:stylesheet> 
```

脚本函数将在运行时编译为临时程序集，然后执行。但是，请注意缓存您的 XSLT，因为每次 XSLT 编译都会创建一个新程序集，该程序集仅在您的应用程序退出时卸载。

# c++ - 是否有与 VS2008 或 Eclipse CDT 集成到 CPPUnit 的插件？

> ID：627218
> 
> 赞同：5
> 
> 时间：2009-03-09T17:27:13.767
> 
> 标签：c++, visual-studio-2008, eclipse, unit-testing, user-interface

我们有一些项目具有 CPPUnit 测试，这些测试是使用 ant 脚本构建和运行的（现在我们使用 Borland C++，但我们正在转向 VS2008）。

问题是运行和查看测试结果的界面令人不快（命令提示符）。让它们在 eclipse 或 VS2008 中运行会很棒。

如果一个插件可以让我选择我想要运行的测试并获得一些视觉反馈（绿色条/红色条），将我指向失败的测试和消息，那就更好了。

这存在于 Eclipse 中的 JUnit（对于 java），但是对于使用 Eclipse CDT 或 VS2008 的 C++ 是否有类似的东西？UI 测试运行器也会很有用，因此我可以将 UI 作为 Post build 操作启动。

**编辑（可能的答案）：**

我找到了这个项目：[ECUT](http://sourceforge.net/project/screenshots.php?group_id=236439)，但是我还没有测试它。看起来很有希望。我会在获得更多项目经验后立即更新这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T13:08:21.900

他们似乎不是 Visual Studio 中的测试运行器，只是[MfcTestRunner](http://apps.sourceforge.net/mediawiki/cppunit/index.php?title=MfcTestRunner)和[QtTestRunner](http://apps.sourceforge.net/mediawiki/cppunit/index.php?title=QtTestRunner)。

对于 Visual Studio，[Resharper](http://www.jetbrains.com/resharper/)和[TestDriven.Net](http://www.testdriven.net/)是通常首先寻找测试运行器的嫌疑人，但它们都不支持 CPPUnit。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-22T03:19:24.970

我在寻求与 Eclipse CDT 进行简单 CppUnit 集成的过程中发现了您的帖子，因此对于像我这样正在寻求与 Eclipse CDT 进行简单 CppUnit 集成的每个人来说：

我创建了一个 Eclipse 插件来支持带有官方 Eclipse CDT C/C++ 单元测试支持插件的 vanilla CppUnit XML 测试报告。

我已经在[GitHub 上提供了它](https://github.com/jmrharris/eclipse.cppunit.testsrunner)

所以**是**的，现在有:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T18:09:00.267

我相信 cppunit 附带一个 GUI 测试运行器，您可以在构建后事件中使用它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-20T10:34:34.607

> cxxunit 是测试框架的另一种解决方案。

[http://web-cat.cs.vt.edu/eclipse/cxxtest/](http://web-cat.cs.vt.edu/eclipse/cxxtest/)

# xml - XSLT：如何从某个目录获取文件名？

> ID：627226
> 
> 赞同：20
> 
> 时间：2009-03-09T17:29:54.510
> 
> 标签：xml, xslt, file, filesystems

XSLT 中是否有一个函数可以接收目录路径并返回其中的所有文件？

我有一个 xml 文件现在看起来像这样

```
<filelist>
    <file>fileA.xml</file>
    <file>fileB.xml</file>
</filelist> 
```

现在，有一个名为 的目录`dir`，里面有文件`fileX.xml`，`fileY.xml`还有一堆其他的 xml 文件。我想将这些文件添加到原始 xml 文件中，以便我可以得到：

```
<filelist>
    <file>fileA.xml</file>
    <file>fileB.xml</file>
    <file>fileX.xml</file>
    <file>fileY.xml</file>
    .... <!-- other files -->
</filelist> 
```

有没有一种 XSLT 方法可以做到这一点？接受目录根目录的东西，并且能够迭代其中的所有文件？然后我可以调用类似的东西：

```
<xsl:element name = file >
     <xsl:copy> <!--whatever file name--> <xsl:copy>
</xsl:element>0 
```

## [编辑解决方案]

所有的答案都非常有帮助。我最终找到了一个外部解决方案（使用撒克逊语）。我认为其他人在这里发布我的解决方案可能会有所帮助，尽管它非常适合我自己的情况。

我使用 Ant 构建一个 java web 应用程序，需要在部署之前翻译一些 xml 文件。因此，我`xslt`通过在类路径中添加“saxon9.jar”来使用该任务来完成这项工作。在我的 xsl 文件中，我只是做了这样的事情：

```
<xsl:for-each select="collection('../dir/?select=*.xml')" >
     <xsl:element name='file'>
        <xsl:value-of select="tokenize(document-uri(.), '/')[last()]"/>
     </xsl:element>
</xsl:for-each> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T17:51:55.220

XSLT 没有为此任务内置任何内容。XSLT 是一种转换语言——对于动态输出，您通常需要一个已经包含所有内容的转换*源*（只是以不同的形式）——您不能从无到有创建 XML。

您可以解决问题的三种方法是：

1.  用编程语言构建 XML，完全不考虑 XSLT。这是获得所需结果的最简单方法。
2.  构建一个接受参数的 XSL 样式表，将（预构建的）分隔文件列表放入该参数，让 XSLT 处理字符串并从中生成 XML。这也涉及到外部处理，基本上这是选项 1。另外，您必须编写一个 XSL 样式表来处理字符串（XSL 尚未适应的东西）
3.  使用扩展函数并从 XSL 中进行目录处理。可以在[我对这个问题的回答](https://stackoverflow.com/questions/546152/xslt-get-the-file-current-folder-path/546247)中找到如何开始的示例。这不是很便携，因为扩展功能是特定于平台的。

归结为：

*   您*将*需要外部编程语言的帮助
*   您并不*一定需要*XSLT 来完成这项任务，因为您只需要 XML 输出并且不需要转换。

Ergo：不要为此使用 XSL。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T17:45:42.897

您不能在本机 XSLT 中做到这一点，但各种实现允许您向功能添加扩展。

例如，在 C# 中，您可以添加用户定义的 URN：

```
 <xsl:stylesheet {snipped the usual xmlns stuff}
    xmlns:user="urn:user" > 
```

然后使用“用户”中的功能

```
 <xsl:value-of select="user:getdirectory( @mydir )" /> 
```

在 C# 中，您将“用户”关联到 C# 类：

```
 XSLThelper xslthelper      = new XSLThelper( );  // your class here
 xslArgs.AddExtensionObject( "urn:user", xslthelper ); 
```

并且您的班级定义了“getdirectory”功能：

```
public class XSLThelper
{
public string getdirectory(System.Xml.XPath.XPathNavigator xml, string strXPath, string strNULL)
{
       //blah
    }
} 
```

大量的作业留在这里！ [MSDN 资源](http://msdn.microsoft.com/en-us/magazine/cc302079.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-01-09T15:36:20.587

Q 已经六岁了，已经回答了。只需为那些再次登陆这里的人投入我的 2 美分。

我需要一个表示目录中文件名的 XML 文件。我已经通过三种方式做到了：

1.  XSLT 2.0 document() 正如其他人在此线程中指出的那样。缺点是性能，因为它将文件读入 dom 解析器，而您真正想要的只是名称。同样正如 LarsH 在 OP 评论中指出的那样，这仅适用于有效的 XML 文件。如果您在递归中有一个非 xml 或格式错误的 xml 文件，它会使转换崩溃。

2.  带有命令的工具[xmlstarlet](http://xmlstar.sourceforge.net/ "XML小星星")`xmlstarlet ls > filenames.xml`

3.  我编写的一个粗略的 bash 脚本（可以优化）：

```
目录=$1
结果文件=$2

# 将目录列表放入临时文件
# 根据需要修改 ls 命令
ls -A1 $DIRECTORY > /tmp/zFiles.txt

# 移除碎屑并将行包裹在 <file> 元素中
sed -i -e's/^[^$]*$/ <file filename="&"\/>/' /tmp/zFiles.txt

# 构建文件
echo '<?xml version="1.0" encoding="UTF-8"?>' > $RESULTFILE
回声“<文件>”>> $RESULTFILE
猫 /tmp/zFiles.txt >> $RESULTFILE
回声“</files>”>> $RESULTFILE

```

我已经使用 bash 脚本很长时间了，但现在我只使用 xmlstarlet 方法。结果 starlet 文件包含特定的文件属性，例如权限和日期，我发现这很有帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T17:42:57.473

您应该能够使用[document()](http://www.w3schools.com/Xsl/func_document.asp)函数来读取 XML 文件。不过，我不确定它在各种 XSLT 引擎上的支持程度如何。

这是一个[很好的例子](http://www.ibm.com/developerworks/xml/library/x-tipcombxslt/)，展示了它的使用。

但这并不能解决从目录中读取文件名的问题。另一个答案提供了一种方法。

# javascript - Opera/Mac：覆盖 cmd+S 事件？

> ID：627234
> 
> 赞同：2
> 
> 时间：2009-03-09T17:32:14.427
> 
> 标签：javascript, macos, opera

看起来 Opera/Mac 不允许您在用户按下 ⌘S 时覆盖操作（当然，默认设置是保存页面）。我发现我的旧脚本在其中不起作用。它通过 Ajax 将表单内容保存到服务器。

这是一个 onkey* 处理程序：

```
key = ev.keyCode
if (!key) key = ev.charCode

if (ev.type == 'keypress' && 115 == key && ev.ctrlKey) return false
if (83 == key && ev.ctrlKey) {
  if (ev.type != 'keypress') save_text ()
  return false
} 
```

Opera/Mac 的第一个奇怪之处在于它在 ⌘ 键上生成 ctrlKey 而不是实际的`Ctrl`键。所以在 Safari 中，这个可以完美地用我的代替标准的 ^S 动作。但是在 Opera 中，它完全忽略了 ^S，因为 ctrlKey 是 ⌘ ，但是无论你做什么， ⌘S 都会带来标准的保存对话框。

当我按下 ⌘S 时，我试图实际监控 Opera 中的所有 key* 事件序列，它是使用 keyCode 17 的 keydown，然后是使用 keyCode 17 的 keypress，两者都发生在我按下 ⌘ 之后。按 S 后根本不会产生任何事件。

所以看起来我运气不好。任何人都知道如何强制 Opera 让我覆盖⌘S？:-)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-12-30T00:41:39.103

我会称之为功能。它*不应该*让你覆盖一切。接下来你会问如何在 Linux 上覆盖 Ctrl-Q，这样它就不会关闭浏览器......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-04T13:47:08.543

我没有方便的 Mac，但我希望使用 keydown 事件中的 preventDefault() （可能是 S 事件，如果一个被触发）来阻止它。

如果你去这里，勾选“防止默认”框并按命令-s，你会得到一个保存对话框吗？

[http://cross-browser.com/x/examples/key_events.php](http://cross-browser.com/x/examples/key_events.php)

# reporting-services - 如何在 Reporting Services 数据集中“参数化”DB2/iSeries 文件？

> ID：627241
> 
> 赞同：1
> 
> 时间：2009-03-09T17:33:44.377
> 
> 标签：reporting-services, oledb, dynamic-sql, ibm-midrange

这是我的 Microsoft Reporting Services 报告 (.rdl) 中数据集的示例查询

```
SELECT ORDNO FROM INTERFACET.DOPPRMAH 
```

这是通过 IBM 的 OLE DB 驱动程序连接到 iSeries。

我如何“参数化”“接口”部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T23:00:57.053

您至少不会轻易... SELECT 嵌入到 RDML 文件或报告定义文件中。

这是我能想到的两种解决方法，创建多个数据集，将一个命名为 PROD，另一个命名为 TEST。在将环境作为参数传递给报表时，报表文件知道要使用哪个数据集。

第二个选项是生成一些自定义代码和 dll 来配置 RDML 文件，就像使用资源文件进行本地化一样。

如果我有选择，我可能会选择多个数据集......

# statistics - java 或相关库中可用的任何函数，用于在正态分布中生成随机数据

> ID：627244
> 
> 赞同：1
> 
> 时间：2009-03-09T17:34:34.887
> 
> 标签：statistics

我想生成正态分布的随机数据矩阵。是否有任何 java 或相关函数可用于实现这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T17:36:03.730

这是内置在标准库中的。

使用`Random.nextGaussian()` [这里定义](http://java.sun.com/j2se/1.4.2/docs/api/java/util/Random.html#nextGaussian())。

`0.0`这将返回具有均值和标准差的正态分布的浮点数`1.0`。

`m`如果您需要来自均值和标准差分布的随机数`s`，请使用以下表达式：

```
( Random.nextGaussian() * s ) + m 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-09T17:36:36.757

看看[Uncommons Maths](https://uncommons-maths.dev.java.net/) - 它应该能够提供帮助。

# asp.net - SMTP 通过 ASP.Net 2 会话大小问题

> ID：627247
> 
> 赞同：0
> 
> 时间：2009-03-09T17:35:24.403
> 
> 标签：asp.net, session, error-handling, smtp

长期以来，我们一直遇到我编写的群发邮件组件的问题，并且困难的确切性质，如何衡量它以及如何减轻它仍然难以捉摸。

已经到了这些问题变得至关重要的地步，我需要一些直接的答案，所以我希望这里有人可以提供它们。

基本上，这个群发邮件小部件一次只向邮件列表发送大约 25k 封电子邮件。这是我们更喜欢的消息，因为这意味着每个收件人都会收到一封发给他们个人的邮件，所以我们对这个循环很满意。

我们不满意的是，如果您在大约 6k 封电子邮件之后离开程序进行处理，我们会收到一个错误，即“最大会话大小”已达到并且它不会再发送任何邮件。

目前我们没有真正的方法知道它收到了哪封邮件，我们唯一的节流方法是基于猜测工作，包括通过手动按钮每 90 秒发送 1k 封电子邮件。

我一直在搜索，直到我头疼为止，以寻找有关如何在电子邮件发出时跟踪它们，如何测量会话大小或仅允许按一个按钮并使小部件自我节流的某些指示但似乎没有人想在网上谈论它。

我对相关查询提出了一些建议，这些建议建议完全修改小部件，甚至编写定制的群发邮件应用程序。

最后，我们要做的就是限制外发邮件，这样它就不会导致错误，或者，如果这是不可避免的，允许它计算发送的邮件并给我们一些线索，在哪里接收，甚至优雅地处理错误。某物。任何事物。

有没有人有任何切实可行的建议来跟踪来自原始服务器的 .Net 2.0 生成的电子邮件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T17:49:13.840

为什么会话增长？您是否在请求的生命周期内执行此操作？

我假设您通过保留有关会话状态中发送的电子邮件的信息来“跟踪”。我会编写一个跟踪器，可以将跟踪信息批量写入外部存储，例如磁盘上的 xml 文件或 sql 数据库。

如果跟踪部分不是导致问题的原因，而是一次一封的电子邮件（或发送它们的小部件），您可以尝试批量发送电子邮件并密件抄送它们，而不是一次发送一封。Blind Carbon Copies 始终是个人地址，并且不会向收件人透露它是大量邮寄的。您只需要弄清楚您可以通过密件抄送发送的电子邮件数量的限制。

第三种选择是，在您的网络应用程序中，将生成这些电子邮件所需的内容放到一个公共存储位置，并拥有一个 Windows 服务应用程序（或计划任务应用程序），该应用程序会定期检查新的电子邮件作业并在您的网络之外处理它们应用程序...甚至可能在您的网络应用程序的主机服务器之外。当然，这种事情在共享托管服务器上是行不通的……

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T18:09:35.100

我们做很多相同的事情，但我们每分钟一次处理 500 封电子邮件。发送前 500 个，然后页面自行重新加载，工作继续下一个 500 个。

这需要一些记录和存储有关当前 500 队列的信息，允许超时、提前重新加载等，但它已经工作了几年（在任何给定的晚上发送大约 10,000 封电子邮件）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-07-29T12:38:25.513

我从未使用 ASP.NET 编写过一行代码，因此无法在编码方面为您提供帮助，但我能做的就是帮助您指出错误。我对 SMTP 协议有较高的了解，并且有运行 SMTP 服务器的经验，平均每天有大约一百万封电子邮件。

您提到的“最大会话大小”错误是造成混淆的实际原因。即使这个错误清楚地表明“大小”实际问题是“数字”，您的电子邮件服务器可以接受一个非常大的数字。出于安全原因，每个电子邮件 (SMTP) 服务器的配置方式都限制了各种因素，例如个人电子邮件号码、最终收件人号码等。假设有人尝试向一千个收件人发送 1MB 大小的电子邮件，用户只需将大约 1MB 的数据从他们的主机端传输到 SMTP 服务器，服务器本身必须传输 1GB 的数据才能成功发送到所有这些电子邮件。超过 2GB 的数据，以防退回每封电子邮件。为了保护这种对邮件中继服务器的攻击，SMTP 守护进程设置了某种限制。在您的情况下，您的脚本一次连接到 SMTP 服务器并开始中继数千封单独的电子邮件，而永远不会断开连接。服务器实际上并不关心您从 ASP.NET 程序或任何其他电子邮件客户端发送它，当数量超过限制时它会限制并拒绝您。

正如您所说的用于生成每封电子邮件的“循环”，只需为每完成 500 封电子邮件中继设置另一个循环以断开连接并连接到 SMTP。请记住，您的 SMTP 服务器拒绝您不是因为您超出了某些大小限制，而是您达到了任何单个连接的最大允许电子邮件中继。连接，中继固定数量的电子邮件，断开连接，然后再次连接以发送下一批邮件并循环它，直到您完成中继需要发送的每封邮件。

快乐的电子邮件（不是垃圾邮件）....

# stored-procedures - 如何在 MySQL 存储过程中模拟打印

> ID：627248
> 
> 赞同：13
> 
> 时间：2009-03-09T17:35:59.813
> 
> 标签：stored-procedures, mysql

我有一个带有几个游标的 MySQL 存储过程。我想打印一个值以将输出发送回客户端。[SQLyog 企业版](http://www.webyog.com/en/)。

我尝试将变量声明为 TEXT 并在循环内连接，但这不起作用，至少不是我尝试这样做的方式。

```
DECLARE _output TEXT;
DECLARE _ID INT DEFAULT 0;
DECLARE cur1 CURSOR FOR SELECT ID FROM CodeID;
DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = 1;

OPEN cur1;

REPEAT
  FETCH cur1 INTO _ID;
  IF NOT done THEN
    SET _output = _ID; /*SEE ALT BELOW*/

  END IF;
UNTIL done END REPEAT;
CLOSE cur1;

SELECT _output; 
```

我试过了：

```
SET _output = _output + _ID 
```

和

```
SET _output = CONCAT(_output,_ID) 
```

但他们都只返回 NULL

`SET _output = _ID;`只是给了我最后获取的行。这很有帮助，但不完全是我想要的。

让每个获取的行输出到屏幕以在 MySQL 存储过程中重现 MySQL 打印的最佳方法是什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-09T18:26:16.480

您使用 SELECT _output 正确执行此操作；任何没有 INTO 子句的选择都将返回给客户端。

要获得所有这些，您可以将 SELECT 移动到循环中（单独打印每个），或者您可以将它们连接在一起。你的 concat 返回 NULL 的问题是因为你没有将 _output 初始化为任何东西，所以它是 NULL。将任何内容与 NULL 连接将返回 NULL。

尝试以下操作：

```
DECLARE _output TEXT DEFAULT '';
DECLARE _ID INT DEFAULT 0;
DECLARE cur1 CURSOR FOR SELECT ID FROM CodeID;
DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = 1;

打开cur1；

重复
  FETCH cur1 INTO _ID;
  如果没有完成 那么
    SET _output = CONCAT(",", _ID); /*见下面的替代*/

  万一;
直到完成 END REPEAT；
关闭cur1；

选择_输出；

```

# c# - 主机页面 - 用户控制通信 ASP.NET

> ID：627250
> 
> 赞同：0
> 
> 时间：2009-03-09T17:36:02.420
> 
> 标签：c#, asp.net, user-controls

我有许多用户控件。用户控件可以在不同的页面上使用。用户控件的行为根据它们在哪个页面上使用而有所不同。

如何在所有用户控件都可以访问的主机页面上设置参数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T17:38:53.397

您的描述“用户控件的行为根据它们所使用的页面而有所不同”表明存在设计缺陷。ASP.NET 中的控件模型是围绕[封装](http://en.wikipedia.org/wiki/Encapsulation_(computer_science))和[OOP](http://en.wikipedia.org/wiki/Object-oriented_programming)设计的，这意味着控件应该与其周围的上下文无关。你应该重新考虑你的设计。

话虽如此，完全有可能（**警告-不好的做法**）在您的页面上设置控件可以读取的公共属性：

```
class MyPage : Page
{
    public string MyProperty;
}

class MyUserControl : UserControl
{
    void Page_Load(object sender, EventArgs e)
    {
        ((MyPage)this.Page).MyProperty //casts Page as the specific page
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T17:43:52.433

我同意 Rex，我对这个要求持怀疑态度。

也就是说，我发现将它放在 HttpContext.Current.Items 集合上会更干净。该页面将最好在其 OnInit 上设置该值，使用一个很好的类围绕它来获取信息。

如果你愿意，你可以让包装器实际读取当前的 Url，或者检查页面的类型（通常是当前的处理程序 HttpContext.Current.Handler /不记得是否 ajax 影响它），这可以让你根本不需要页面设置任何东西的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T17:46:48.150

正如 Rex M 所提到的，由于多种原因，这是一种不好的做法。如果我发现我*需要*从控件引用父页面，我会将对该页面的引用传递给控件，​​而不是让控件引用父页面。

我可能会考虑制作一个所有这些页面都可以实现的接口并将其传递给控件。该接口将保证类型安全。如果您开始在新页面上使用此控件，则该页面需要先实现该接口，然后才能将其与控件一起使用。这将有助于您将控件放在新页面上并忘记控件与父级之间存在这种关系的情况（这种关系可能很脆弱，这是它被拒绝的原因之一）。

# c++ - 在 MSMQ 消息中发送具有 BSTR 值类型的 COM 对象

> ID：627254
> 
> 赞同：2
> 
> 时间：2009-03-09T17:36:21.263
> 
> 标签：c++, com, msmq, send, bstr

我正在尝试通过 C++ 中的 MSMQ 消息发送 COM 对象。这是我的对象：

```
类 ATL_NO_VTABLE CANalisis ：
    公共 CComObjectRootEx,
    公共 CComCoClass，
    公共 ISupportErrorInfo，
    公共IDispatchImpl，
    公共 IPersistStreamInit
{
私人的：
    类型定义结构{
        双倍尺寸；
        浮动颜色；
        浮灯；

        BSTR imgName;

        BSTR 名称；

    } 图片;

    图像图像；
    标准方法（加载）（IStream *pStm）；
    STDMETHOD(Save)(IStream *pStm, BOOL fClearDirty);

```

一切都很好，我可以得到整个对象，但 BSTR 类型。浮点数和整数被正确发送和接收。但是 BSTR 类型不起作用。我正在尝试发送字符串，但找不到路。我确实尝试使用 VARIANT，但结果也是错误的。不知何故，看起来字符串没有序列化。

这些是我的 ATL 组件的一些 get 和 set 函数：

这个工作正常：

```
STDMETHODIMP CANalisis::getLight(FLOAT* light)
{

    *light=img.light;
    返回 S_OK；
}

STDMETHODIMP CANalisis::setLight(FLOAT light)
{
    img.light=光；
    返回 S_OK；
}

```

这个没有：

```
STDMETHODIMP CANalisis::getImgName(BSTR* imgName)
{
    *imgName = img.imgName;

    返回 S_OK；
}

STDMETHODIMP CANalisis::setImgName(BSTR imgName)
{

    img.imgName=imgName;
    返回 S_OK；
}

```

这就是我创建 MSMQ 消息并在生产者中填充值的方式：

```
// 对于这些 ActiveX 组件，我们只需要智能接口指针
        IMSMQQueueInfosPtr pQueueInfos；
        IMSMQQueueInfoPtr pQueueInfo;
        IMSMQQueuePtr pQueue；
        IUnknownPtr pIUnknown;
        // 实例化以下 ActiveX 组件
        IMSMQQueryPtr pQuery(__uuidof(MSMQQuery));
        IMSMQMessagePtr pMessage(__uuidof(MSMQMessage));

        IAnalisisPtr pAnalisis(__uuidof(Analisis));

                WCHAR * 图像；        
        imagen = L"imagen1.jpg";
                pAnalisis->setImgName(imagen);

                 (...)

                pAnalisis->setFruitSize(20.00);

                 (...)

                pQueueInfo = new IMSMQQueueInfoPtr( __uuidof(MSMQQueueInfo) );

        pQueueInfo->PathName = "MYCOMPUTER\\private$\\myprivatequeue";

            pQueue = pQueueInfo->Open(MQ_SEND_ACCESS, MQ_DENY_NONE);
        pMessage->Body = static_cast(pAnalisis);
                pMessage->发送（pQueue）；

```

这是序列化代码

```
STDMETHODIMP CANalisis::Load( IStream *pStm )
{
    乌龙cb；
    HRESULT 小时；
    如果 (NULL==pStm)
        返回 ResultFromScode(E_POINTER);
    // 从流中读取一个对象。
    //
    hr=pStm->Read(&img, sizeof(Image), &cb);
    如果（失败（小时））
        返回小时；
    如果（大小（图像）！= cb）
        返回 E_FAIL；

    返回无错误；
}

STDMETHODIMP CANalisis::Save( IStream *pStm, BOOL bClearDirty )
{
    乌龙cb；
    HRESULT 小时；
    如果 (NULL==pStm)
        返回 ResultFromScode(E_POINTER);

    // 将对象写入流中。
    hr=pStm->Write(&img, (ULONG)sizeof(Image), &cb);
    if (FAILED(hr) || sizeof(Image)!=cb)
       返回 ResultFromScode(STG_E_WRITEFAULT);

    返回无错误；
}

```

如果我在生产者中获得 BSTR 值（在序列化之前） `pAnalisis-getImgName()`，它工作正常。相反，当我尝试在消费者中获取它时，在从队列中读取消息后，它不会返回任何内容。其他值（例如大小）可以毫无问题地返回。

有谁知道如何通过 MSMQ 在 COM 对象内发送 BSTR 值？

我试图找到一些类似的例子，但完全是徒劳的。

问题是我得到了一个带有奇怪字符的非常奇怪的值或一个十六进制值，这取决于我如何提取值..问题是我永远不会得到正确的值。

我想知道，但是......我们确定可以发送 BSTR 值吗？如果我没记错的话，它是一个指向字符串的指针......我正在运行两个不同的进程（即生产者和消费者），所以它们使用不同的内存块，它们应该在不同的机器上运行。 ..

我试图将此信息作为 VARIANT 类型发送..但也迷路了。但是，这似乎比发送 BSTR 更牵强。

对此有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T09:59:42.553

问题是 Image 类的序列化将其视为连续的内存块。由于 BSTR 实际上是一个指针，因此只有指针值被序列化并且 BSTR 有效负载丢失。

相反，您应该将除 BSTR 之外的所有字段写入二进制文件并单独处理 BSTR。例如，您可以先将 BSTR 长度写入整数，然后再写入其有效负载。读取时会先读取长度，调用 SysAllocStringLen() 分配缓冲区，然后读取有效负载。

保持简单字段的序列化（IPersistStreamInit::Save()）：

```
pStm->Write(&(img.color), (ULONG)sizeof(float), &cb); 
```

对于 BSTR，请执行以下操作：

```
int length = SysStringLen( img.uname );
pStm->Write(&length, (ULONG)sizeof(int), &cb);
if( length > 0 ) {
   pStm->Write( img.uname, (ULONG)(length * sizeof(WCHAR) ), &cb);
} 
```

读取类似（IPersistStreamInit::Load()）：

```
int length;
pStm->Read(&length, (ULONG)sizeof(int), &cb);
if( length > 0 ) {
   img.uname = SysAllocStringLen( 0, length );
   pStm->Read( img.uname, (ULONG)( length * sizeof( WCHAR) ), &cb);
} else {
   img.uname = 0;
} 
```

请注意，此代码写入/读取字符串长度，然后写入/读取由 Unicode 字符组成的有效负载。Unicode 字符每个占用一个以上字节 - 因此 IStream 读/写方法调用中的乘法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T17:42:18.520

如果您只是传递一个 WCHAR - 长度信息将丢失。BSTR 格式不正确，这可能会让您感到非常痛苦。您需要`SysAllocString`使用它来跨组件使用它。请参阅[MSDN](http://msdn.microsoft.com/en-us/library/ms221069.aspx) -**备注**部分。尝试：

```
BSTR imagen = SysAllocString(L"imagen1.jpg"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T21:43:51.903

好的，这个答案取决于你这些天做了一些奇怪的事情，但可能适用。很久很久以前，我不得不从 VB 应用程序中传递 VB6 和 VC++6(pro) 下的 VB 字符串。到 VC++ 应用程序。长度还可以，但我经常在另一边收到一个字符。

问题是接收应用程序。不是为 unicode 编译的，而是作为 ANSI 项目编译的。在传输的另一端解包它的 COM 层代码做了一个有趣的技巧，我只在 MSDN 的一个不起眼的角落在一本书摘录中发现它：它创建了一个 ABSTR。

ABSTR 实际上不是一种类型。没有办法声明一个。它实际上是对 BSTR 底层存储的重新格式化，以便您可以假装它是 C++ 中的 ASCII char*。这是通过首先确保 BSTR 指向其标头之后的第一个字符（对于 C++、IIRC 中的此类结构而言通常是典型的），*然后*对实际的字符串数据进行混洗，使其包含所有第一个字节，然后是所有第二个字节字节。另一个名字是“纯粹的邪恶”。

这种方式可能会发生两件*非常* *糟糕的* *事情*：如果完成了这种转换，并且您将结果视为仍然是一个宽字符串，那么您就会得到乱码。如果没有完成并且您将结果视为 ASCII 字符数组，则通常会得到一个字符，如果原始字符仅包含 ASCII 范围的字符，因为在宽表示中，每隔一个字节都是零，高字节排在第二位。

从你的描述我无法完全判断这是否发生在你身上。但我建议在调试器中停止这个东西，并查看接收到的值下的所有字符串数据，看看它是否以某种意想不到的方式被重新洗牌。如果它被改组了，问问自己为什么，看看你构建项目的方式。

几乎没有记录的格式嵌入到现有类型中，作为一种很难找到的替代内存布局这一事实，即使按照 MS 开发的 how-many-string-formats-can-we-make-up 标准，也几乎让我尖叫。这几乎与第一次尝试将“GetModuleFileName”识别为用于获取当前可执行文件路径的函数一样糟糕。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T21:48:15.793

您的对象需要在 getter 和 setter 中创建字符串的副本：

```
STDMETHODIMP CAnalisis::getImgName(BSTR* imgName)
{
    *imgName = SysAllocString(img.imgName);

    return S_OK;
}

STDMETHODIMP CAnalisis::setImgName(BSTR imgName)
{
    SysFreeString(img.imgName);
    img.imgName=SysAllocString(imgName);
    return S_OK;
} 
```

当然，您需要释放析构函数中的字符串，检查 NULL ptrs 等。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-10T01:19:20.997

或者，您可以使用 CComBSTR 代替 BSTR。CComBSTR 比 BSTR 更智能，它负责分配和释放内存。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-08-09T06:03:50.950

我的建议是将您的字段放在一个 Variant 中（即使是临时的），然后使用 Variant 流代码来展平数据，并在另一端反序列化它。

这是您可以使用的流式代码（对不起，它已经有 20 年的历史了:)）

链接：[https ://github.com/kasajian/VariantStream/blob/master/VariantStream.h](https://github.com/kasajian/VariantStream/blob/master/VariantStream.h)

粘贴在这里的代码有点冗长。

# css - 面向对象的 CSS：重要吗？

> ID：627261
> 
> 赞同：8
> 
> 时间：2009-03-09T17:39:24.737
> 
> 标签：css, oop, oocss

我刚刚发现了这个关于“面向对象的 CSS”概念的[有趣演示。](http://www.slideshare.net/stubbornella/object-oriented-css?type=presentation)这似乎是一个好主意，但演示文稿很短，并没有提供很多示例。

我的问题：

*   这个概念是否相关？
*   OOCSS 有什么好处？
*   你能给我提供“面向对象的CSS”的复杂例子吗？

也许，你认为这个概念无关紧要

*   为什么？
*   您改用什么样的工作流程（和规则）？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-10T15:59:14.203

## 是否相关？

我认为是的，它基本上是为 CSS 作者使用的方法命名，与创建样式指南大致相同。有用吗？是的。继承别人的OOCSS工作容易吗？可能不是。

## OOCSS 有什么好处？

抽象某个组件的样式属性总是有利于整个站点的样式一致性。假设您想更改组件的边框样式以获得全新的外观：您通常会更改几行有关边框样式主样式的行。

## 一个例子

我创建了一个 UI 开发人员样式指南（或样式词汇表），涉及我们 Web 应用程序中的所有“小部件”。每个小部件将根据其预期内容进行分类。每个小部件可以有任意数量的预定义框样式、背景样式。每个小部件还可以根据其所在的父元素来布置其内容。

这相当于代码：`<div class="free bg_neutral form_search">`被用于每个包装器/容器，每个类分别为：“框样式、背景样式、内容”。处理 HTML / 视图的开发人员可以轻松切换任何预定义样式并用更合适的样式替换它们。例如，替换`bg_neutral`为`bg_gradient_fff_eee`渐变背景。

我认为我们节省了无数行 CSS 代码，因为我们可以在几个核心“小部件”上使用可互换的属性，而不是定义每个“小部件”的每一个独特的化身。它还使跨浏览器修复变得更加容易，因为您可以独立处理“小部件”样式。（大多数浏览器错误与框尺寸和位置/布局有关）

在我看来，更多的 UI 人员在设计和实现其网站的前端时需要通过 StyleGuide / Style Vocab 练习。在网站上使用的视觉元素中创建一致性。一致的视觉效果通常会产生一致且高效的 CSS！

希望有帮助，nd

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-09T17:52:05.237

我看不出这个概念有什么好处，因为当前的 CSS 定义在*某种程度上*已经是面向对象的，具有级联、选择器、通配符等。

他们提到将容器与内容分离，对我来说这正是 CSS 已经做的事情。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-30T14:47:01.207

与问题相关的演示文稿由雅虎的性能工程师[Nicole Sullivan提供。](http://www.stubbornella.org/content/)

在 Yahoo Developer Network 站点上有一段[原始演示的视频，](http://developer.yahoo.net/blogs/theater/archives/2009/03/website_and_webapp_performance.html)在 github 上有一个[OOCSS 项目的存储库。](http://wiki.github.com/stubbornella/oocss)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-09T18:04:40.777

幻灯片放映是一套很好的标准和指导方针。我一直在使用它们，在我的设计中寻找模式和重复，然后将它们分解为组件。

Navigation、Panel、Grid、Repeater、Card等。这些都是我为每个站点设计的通用组件。

我还有用于实用程序、页面和内容的单独 CSS 文件。Utilities 存储我的 clearfix 或 margin normalizer 之类的东西，Page 存储整个站点布局（页眉、页脚、主要），而 Content 是用于站点范围内的标题、段落、链接、列表等的通用规则集。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-09T19:06:15.603

“面向对象”在这里有点用词不当，至少在严格意义上是这样。但他提出的设计指南是合理且有用的，并且在一定程度上缓解了 CSS 标准的“破碎”。

他指出的问题——脆弱的设计、大文件、低可维护性等等，是标准过于松散、过于面向特定并且基于不再有效的原始设计目标的结果。他正确地观察到成功的设计需要清醒的头脑和大量的纪律。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-10T04:43:21.160

听起来像流行语跟我说话。正如 John Rasch 所说 - CSS 已经有点面向对象了。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-10T04:59:14.227

在相关说明中，您可能需要查看[compass](http://wiki.github.com/chriseppstein/compass)样式表框架。另请参阅[底漆](http://acts-as-architect.blogspot.com/2008/11/compass-primer.html)。它看起来很有趣，虽然我还没有机会在项目中使用它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-10T16:04:23.833

我很想*在*CSS 中看到某种形式的继承。完蛋了哦？这可能是矫枉过正，但继承会成倍地缩小我的样式表的大小。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-04-20T07:10:28.377

好处是能够扩展对象并保持代码干燥和可读。那些反对它的人通常要么 a) 讨厌这个名字，要么 b) 从未使用过它。让我们这样说......

# 例子

每个站点都有不同类型的导航。您可以在标题正文中的侧边栏中进行导航。也许，您的页面上甚至还有标签或面包屑？您甚至可能需要一个用于页面上的富文本编辑器的工具栏。这就是 .nav 抽象发挥作用的地方。

```
.nav
{
    margin-bottom:              24px;

    margin-left:                0;

    padding-left:               0;

    list-style:                 none;
}

.nav--right
{
    float:                      right;
}

.nav--stack .nav__item
{
    float:                      none;
}

.nav__item
{
    float:                      left;
}

.nav__item--active .nav__link
{
    font-weight:                bold;
}

.nav__link
{
    display:                    block;

    color:                      inherit;

    text-decoration:            none;
}

.nav__link:hover
{
    text-decoration:            underline;
} 
```

这与我的所有控件中出现的代码相同。现在，我所要做的就是为它创建一些皮肤。

## 侧边栏皮肤

```
.side .nav__item
{
    border-bottom:              1px dotted rgba(0, 0, 0, 0.2);
}

.side .nav__link
{
    padding:                    12px 0;
} 
```

## 标签皮肤

```
.tabs
{
    border-bottom:              1px solid #aaa;
}

.tabs .nav__item
{
    margin-right:               8px;
}

.tabs .nav__item--active .nav__link
{
    margin-top:                 -2px;

    position:                   relative;

    border-bottom:              1px solid #fff;

    bottom:                     -1px;

    color:                      #000;
} 
```

## 主菜单皮肤

```
.menu .nav__item--active .nav__link
{
    border-radius:              2px;

    color:                      #fff;

    background-color:           #007bc3;
}

.menu .nav__link
{
    padding:                    12px 8px;
} 
```

# 把它放在一起

我所做的只是为类属性编写对象的名称和皮肤的名称。这包括两者的属性。

```
<ul class="side nav nav--stack">

      <li class="nav__item nav__item--active">

        <a class="nav__link" href="#">

          Item

        </a>

      </li>

 <li class="nav__item nav__item--active">

        <a class="nav__link" href="#">

          Item

        </a>

      </li>

 <li class="nav__item nav__item--active">

        <a class="nav__link" href="#">

          Item

        </a>

      </li> 
```

不要惊慌看到 .nav_ *item 和 .nav* _link。大多数使用 li's 和 a's 但我想让它独立标记。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-01-14T02:10:30.053

正如 Tor Haugen 所指出的，术语“面向对象的 CSS”是用词不当。

“面向对象的 CSS”实际上只是一种如何充分利用 CSS 的设计模式，与 Jonathan Snooks 所说的[SMACSS](http://smacss.com/)基本相同。

无论您将其称为 OOCSS 还是 SMACSS，该方法的关键在于您创建通用 UI 元素，例如[nav 抽象](http://csswizardry.com/2011/09/the-nav-abstraction/)。然后可以通过向元素和/或容器元素添加额外的类来增强这些 UI 元素的特定功能。或者，作为替代方案，您可以使用元素的 ID 或语义类添加您自己的自定义 CSS 规则。

有关 OOCSS 的真实示例，请查看[Cascade Framework](http://jslegers.github.io/cascadeframework/)、[Scally](https://github.com/chris-pearce/scally)和[InuitCSS](https://github.com/inuitcss)等框架。

* * *

**进一步阅读：**

*   [面向对象 CSS (OOCSS) 简介](https://www.smashingmagazine.com/2011/12/an-introduction-to-object-oriented-css-oocss/)
*   [OOCSS + Sass = CSS 的最佳方式](http://ianstormtaylor.com/oocss-plus-sass-is-the-best-way-to-css/)

# c# - 大对象缓存

> ID：627267
> 
> 赞同：1
> 
> 时间：2009-03-09T17:40:45.090
> 
> 标签：c#, collections, caching, .net-2.0, garbage-collection

我有一个 .NET2.0 C# 网络应用程序。它具有可变数量的大型、初始化昂贵的对象，这些对象在多个请求之间共享，但不与任何给定用户进行会话。因此，我需要将它们保存在查找结构中。这些对象需要根据需要创建，而不是应用程序的生命周期所必需的，只是它们的使用生命周期。

再加一点。

执行此操作的内存泄漏方式是一个简单的字典，执行此操作的内存安全方式是一个弱引用支持的字典，但我遇到的问题是 GC 太快了。实际上，这可能不是问题，因为对象的流量应该使它们能够保持活力而不会被迫重新生成太多，但理想情况下我也希望它们按比例缩小。

是否有某种我没有想到的中间解决方案可以让对象在一段时间内安全地隐藏在 GC 中 X，但也允许在那个时间结束时收集它们，最好是那个时间的地方每次以类似于会话令牌的方式使用计数器时都会重置？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-09T17:43:48.313

我不确定为什么[HttpRuntime 缓存](http://msdn.microsoft.com/en-us/library/system.web.caching.cache.aspx)在这里不起作用。插入缓存的项目每次被触摸时都会“更新”，从而使它们保持活动状态，直到不再需要它们；之后，它们将继续留在缓存中，直到它们过期（滑动或滚动时间）或由于内存压力而被强制退出。无论使用情况如何，它们也可以在明确设置的绝对时间被强制退出：

*   **绝对时间**：系统时钟经过某个日期时间后，项目被强制退出

*   **滑动（滚动）时间**：每次触摸物品时，都会重置其死亡倒计时。倒计时的持续时间是滑动时间（例如 5 分钟）。

示例用法：

```
//adds itemObject to cache under name "UniqueItemKey"
//set to expire 5 minutes after last touched
HttpRuntime.Cache.Add("UniqueItemKey", 
                      itemObject, 
                      null,
                      Cache.NoAbsoluteExpiration,
                      new TimeSpan(0, 5, 0),
                      CacheItemPriority.Normal,
                      null); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T17:43:47.690

为什么不使用框架中的 Cache 对象并在其上设置滑动过期时间。说10分钟。如果它至少每 10 分钟使用一次，它将保留在缓存中，如果 10 分钟过去，它将过期并且 GC 会将其删除。

一个例子：（我相信这是完整的语法

```
Cache.Add("myKey", MyLargeObject, null, DateTime.Now.AddMinutes(10), Cache.SlidingExpiration, CacheItemPriority.High) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T17:45:40.617

听起来您已经在描述自己的问题的解决方案；一种缓存结构，它在一段时间内保存强引用，但如果经过一段时间而没有“访问”对象，则将它们降级为弱引用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T17:48:35.323

关键部分是“它们的使用期限”。你如何定义它？如果您可以以不需要了解未来的方式精确定义它，那么其余的可能很容易。

# java - FindBugs 不接受 ANT 脚本中的 bcel.jar

> ID：627269
> 
> 赞同：1
> 
> 时间：2009-03-09T17:41:40.067
> 
> 标签：java, ant, findbugs, task, bcel

我将 findbugs 安装到我的 ant lib 目录中，并将以下代码添加到我的主 ANT 脚本中：

```
<target name="findbugs" depends="init">

    <findbugs home="C:\\findbugs\\" output="html outputFile="C:\\findbugs\\out.html" jvmargs="-Xms512M">
        <sourcePath path="${messageaggregator.src}" />
        <class location="${messageaggregator.src}"/>

    </findbugs>
</target> 
```

在 init 目标中调用以下 xml：

```
<taskdef name="findbugs" classname="edu.umd.cs.findbugs.anttask.FindBugsTask"> 
```

在运行 ANT 脚本时，我得到的只是以下输出：

```
发现错误：
    [findbugs] 从 ant 任务执行 findbugs
    [findbugs] 运行 FindBugs...
    [findbugs] BCEL 类兼容性错误。
    [findbugs] 发现的类 org.apache.bcel.generic.ObjectType 的版本不兼容
    [查找错误] 查找错误。请删除任何可能干扰的 BCEL 库。这可能会发生
    [findbugs] 如果你有旧版本的 BCEL 或包含旧版本 BCEL 的库
    [findbugs] 在“认可”目录中。
    [findbugs] 输出保存到 C:\\findbugs\\out.html

```

为什么 findbugs 不起作用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T17:45:09.620

您与必须摆脱的旧版本 BCEL 发生冲突。它可能在您的 jre/lib/ext 目录中（坏主意），或者您为项目获得的 CLASSPATH 的一部分，或者可能是 Ant /lib 的一部分。在任何情况下，您都应该在 CLASSPATH 中找到所有 BCEL JAR，删除它们，并使用 FindBugs 所需的版本更新它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-03-11T14:37:06.233

我发现该`xalan:xalan:jar:2.6.0`库（这是我项目中库的传递依赖项`org.apache.xmlgraphics:batik-bridge:jar:1.7`）包含`org.apache.bcel.generic.ObjectType`该类（可能是错误的版本）。此类可能会导致以下错误：

```
[INFO] 文件编码为 UTF-8
BCEL 类兼容性错误。
找到的类 org.apache.bcel.generic.ObjectType 的版本与
查找错误。请删除任何可能干扰的 BCEL 库。这可能会发生
如果您有旧版本的 BCEL 或包含旧版本 BCEL 的库
在“认可”目录中。
[信息] --------------------------------------------- -------------------------
[错误] 致命错误
[信息] --------------------------------------------- -------------------------
[信息] Java 返回：1
[信息] --------------------------------------------- -------------------------
[信息] 追踪
：Java 返回：1
        在 org.apache.tools.ant.taskdefs.Java.execute(Java.java:108)
        在 sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        在 sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        在 sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        在 java.lang.reflect.Method.invoke(Method.java:597)
        在 org.apache.tools.ant.dispatch.DispatchUtils.execute（DispatchUtils.java:106）
        在 org.apache.tools.ant.Task.perform（Task.java:348）
        在 groovy.util.AntBuilder.nodeCompleted(AntBuilder.java:199)
        在 groovy.util.BuilderSupport.doInvokeMethod(BuilderSupport.java:153)
        在 groovy.util.AntBuilder.doInvokeMethod(AntBuilder.java:149)
        在 groovy.util.BuilderSupport.invokeMethod(BuilderSupport.java:64)
        在 org.codehaus.groovy.runtime.InvokerHelper.invokePogoMethod(InvokerHelper.java:784)
        在 org.codehaus.groovy.runtime.InvokerHelper.invokeMethod(InvokerHelper.java:758)
        在 org.codehaus.groovy.runtime.ScriptBytecodeAdapter.invokeMethodN(ScriptBytecodeAdapter.java:170)
        在 org.codehaus.mojo.findbugs.FindBugsGui.execute（FindBugsGui.groovy:163）
        在 org.apache.maven.plugin.DefaultPluginManager.executeMojo（DefaultPluginManager.java:490）
        在 org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoals（DefaultLifecycleExecutor.java:694）
        在 org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeStandaloneGoal（DefaultLifecycleExecutor.java:569）
        在 org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoal（DefaultLifecycleExecutor.java:539）
        在 org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoalAndHandleFailures（DefaultLifecycleExecutor.java:387）
        在 org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeTaskSegments（DefaultLifecycleExecutor.java:348）
        在 org.apache.maven.lifecycle.DefaultLifecycleExecutor.execute（DefaultLifecycleExecutor.java:180）
        在 org.apache.maven.DefaultMaven.doExecute（DefaultMaven.java:328）
        在 org.apache.maven.DefaultMaven.execute（DefaultMaven.java:138）
        在 org.apache.maven.cli.MavenCli.main(MavenCli.java:362)
        在 org.apache.maven.cli.compat.CompatibleMain.main(CompatibleMain.java:60)
        在 sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        在 sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        在 sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        在 java.lang.reflect.Method.invoke(Method.java:597)
        在 org.codehaus.classworlds.Launcher.launchEnhanced（Launcher.java:315）
        在 org.codehaus.classworlds.Launcher.launch(Launcher.java:255)
        在 org.codehaus.classworlds.Launcher.mainWithExitCode(Launcher.java:430)
        在 org.codehaus.classworlds.Launcher.main(Launcher.java:375)

```

由于编译不需要工件（在我们的例子中），我们只是将其范围更改为`runtime`在 Maven`pom.xml`文件中，这个错误消失了并且`mvn clean findbugs:findbugs findbugs:gui`再次工作（至少对我来说）：

```
  ...
  <依赖项>
    <依赖>
      <groupId>org.apache.xmlgraphics</groupId>
      <artifactId>蜡染桥</artifactId>
      <版本>1.7</版本>
      <scope>运行时</scope>
    </依赖>
  </依赖>
  ...

```

希望这可以挽救某人的屁股...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-22T22:45:17.067

Java 版本 1.6.0_06 包含旧的 BCEL 库。

java 版本“1.6.0_06”Java(TM) SE 运行时环境（构建 1.6.0_06-b02）Java HotSpot(TM) 客户端 VM（构建 10.0-b22，混合模式）

一旦我更改为 1.5.0_17 它对我来说很好。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-10T09:21:42.413

如果 findbugs 有自己的 BCEL 版本，那么为什么会出现此错误：

```
[findbugs] Executing findbugs from ant task
[findbugs] Running FindBugs...
[findbugs] The java class is not found:  org.apache.bcel.classfile.ClassFormatException
[findbugs] Output saved to C:\\findbugs\\out.html 
```

如果我从 findbugs.home 目录中删除 bcel.jar，则会出现此错误。

# c++ - auto_ptr 会防止这种情况吗？

> ID：627273
> 
> 赞同：4
> 
> 时间：2009-03-09T17:42:38.363
> 
> 标签：c++, auto-ptr

我不太清楚 auto_ptr 在这种情况下是否会帮助我：

```
class A
{
  A(const B& member)
   : _member(B)
  {};

...
  const B& _member;
};

A generateA() {
   auto_ptr<B> smart(new B());
   A myA(*smart);
   return myA;
} 
```

离开其封闭范围时，`myA._member`引用是否有效？`smart`如果 auto_ptr 不是这里的答案，那是什么？

编辑：我看到我让每个人都感到困惑的地方；我必须将 myA 返回范围之外，这就是为什么我关心 _member 在 smart 退出范围后是否有效。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-09T17:45:55.890

它不会帮助你。_member 将成为一个悬垂的句柄。这是因为`auto_ptr`保证在范围结束时销毁：不多*也不少*。

有2个可能的答案。

*   您可以制作 _member 的类型`boost::shared_ptr<const B>`。
*   或者，如果类 B 是**small**、**copyable**、**monomorphic ，并且****不需要保留**对象标识，则可以将 _member 设为值，并将参数的副本存储在那里。这是迄今为止最简单的选择，但显然它非常有限。

**回应您的编辑：**这确实是我所说的情况。通过按值返回 myA ，创建了一个副本，并且该副本的 _member 引用了已经破坏的本地。如前所述，`shared_ptr`值语义和值语义都解决了这个问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T17:47:31.800

该类`auto_ptr`是普通指针的包装器。当堆栈展开时，它们会负责解除分配（`auto_ptr`调用的析构函数又会释放您包含的对象）。

请注意，您的`A`对象也是在堆栈上创建的。当作用域结束时，A 和 auto_ptr 都将被释放。超过这一点，试图访问该`A`对象会给你一个编译时错误。

假设`A`对象是在块之外的某个地方创建的，那么你就有一个真正的问题。由于对象在块范围之外`A`存储了对该对象的**引用，因此该引用变得无效。**`B`

另请注意，对于 C++0x，`auto_ptr`已弃用。改用 a `unique_ptr`。请查看C++0x 中出现的[通用智能指针。](http://en.wikipedia.org/wiki/C%2B%2B0x#General-purpose_smart_pointers)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T18:40:38.473

```
{
   auto_ptr<B> smart(new B());
   A myA(*smart);
} 
```

保存在“smart”中的指针和对象“myA”都将在此范围的末尾被销毁。但这应该是你想要的这段代码。

一旦范围结束，“myA”将首先被销毁（最后声明）。
然后这个 smart 将被销毁，其析构函数将删除指针。

由于无法引用“smart”或“myA”，我希望您此时希望删除该指针。

或者，您可以这样做：

```
{
    B  myB;
    A  myA(myB);
} 
```

# apache-flex - Flex 3 是否可以为浏览器的默认主页生成一个新浏览器？

> ID：627275
> 
> 赞同：1
> 
> 时间：2009-03-09T17:42:47.317
> 
> 标签：apache-flex, flash, air

我的 Windows 应用程序通过 IE ocx 托管一个 Flex 应用程序。我的 flex 画布上有一个按钮，按下该按钮时应该会生成用户的默认浏览器，打开到他或她的主页。

当点击处理程序看起来像这样时，它可以正常工作：

```
 private function OnClickedInternetImage() : void
{
 var url:String = "http://stackoverflow.com";
 var request:URLRequest = new URLRequest(url);
 flash.net.navigateToURL(request);  // default browser instantiated, opens url
} 
```

如果 url 是一个空字符串，我希望它会打开默认浏览器到其默认 url，但相反，navigationToUrl 语句会被忽略。

我可以将一个事件从我的 Flash 画布传回宿主 Windows 应用程序，它知道如何将浏览器生成到其默认页面，但这很麻烦。

Flex 3 是否可以为浏览器的默认主页生成一个新浏览器？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-11T14:42:05.580

```
navigateToURL(new URLRequest("about:blank"), "_blank"); 
```

弹出窗口阻止程序等会妨碍您。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-14T23:53:35.900

Adam 是最接近的，但 Flash 不能做我想做的事，我必须使用 Windows 应用程序中的 Windows api，它构成了我的 Flash 应用程序。

# ruby-on-rails - Rails 引擎是否适合管理应用的多个版本？

> ID：627277
> 
> 赞同：2
> 
> 时间：2009-03-09T17:43:16.770
> 
> 标签：ruby-on-rails

我有一个具有核心功能（布局、用户、消息传递等）和 3 个不同版本的 Rails 应用程序，它们在核心集之上添加了自己的独特功能。它们中的每一个当前都位于单独的目录中，并且目前单独部署。

当我对核心功能进行更改时，我不得不手动将它们复制到每个应用程序中，并且非常混乱。

我想让这 3 个文件夹成为核心应用程序，这样我就可以通过 git 提取更改，并通过插件文件夹中的引擎拥有独特的功能。这样，我可以保留一个版本的核心功能并将独特的功能分开。

这是解决这个问题的可行方法吗？

我以前从未使用过引擎，只是通过 Rails 2.3 了解它们。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T17:56:00.670

我不知道 Rails 引擎是否是这里的解决方案，但让我告诉你我们如何在我们的一个项目中解决这个问题。

我们有一个核心项目，还有两个项目几乎使用了大部分相同的数据（主要是 rails 模型）。以下是我们的设置方式：

3 git repos:
- 核心项目
- 子项目 1
- 子项目 2

核心项目是一个完全正常的 git repo，但在子项目中，核心项目是一个 git 子模块。然后，通过 git 添加和跟踪符号链接。例如：

```
/subproject $: git submodule add git@git.repo:core.git core
/子项目 $: cd 应用程序
/subproject/app $: ln -s ../core/models 模型

```

现在， subproject/app/models 从核心项目中提取。您可以对任意数量的文件执行此操作。

从核心回购更新：

/subproject $: git 子模块更新 && git commit

显然这比复制文件容易得多。我希望这对你有用。

# windows - 本机 Windows 脚本的选择

> ID：627278
> 
> 赞同：4
> 
> 时间：2009-03-09T17:43:24.897
> 
> 标签：windows, scripting

什么是一种好的 windows/xp 或 Vista 脚本语言，可以提供类似于 ksh 或 bsh 为 unix 所做的基本功能？希望执行简单/快速的任务、构建参数、调用可执行文件 (.exe)、重定向输出。

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-09T17:46:33.127

[Powershell](http://www.microsoft.com/windowsserver2003/technologies/management/powershell/default.mspx)是显而易见的候选者，尽管您上面描述的所有内容都可以在普通的旧[命令文件中实现（有些痛苦）。](http://commandwindows.com/index.html) 请注意，命令文件支持相当多的 shell 风格的变量替换、重定向和其他功能，但它们在这方面不如 unix shell。[在http://www.ss64.com/ntsyntax/](http://www.ss64.com/ntsyntax/)有一个很好的命令文件语法参考；[这个 Stackoverflow 问题](https://stackoverflow.com/questions/33559/how-to-get-started-with-powershell)有很多指向 Powershell 资源的链接。

您还可以获得在 Windows 上运行的 unix shell 端口；最有用的是[cygwin](http://www.cygwin.com/)、[unxutils](http://unxutils.sourceforge.net/)和[Microsoft Windows Services for Unix](http://technet.microsoft.com/en-us/interopmigration/bb380242.aspx)。Cygwin 是一个真正为移植 unix 软件以在 Windows 上运行而设计的完整环境。它非常重量级，并将 Windows 驱动器号映射到表单中的路径`/cygdrive/c/...`，因此路径与本机 win32 命令不兼容。Unxutils 基于 mscvrt.dll 并将使用本机 win32`C:\`样式路径，这意味着它与本机 windows 命令兼容。这使得将 unix 脚本类型功能（包括 sed 和 awk）与现有的 Windows 命令行实用程序集成得更好。

Windows 还附带了[Windows 脚本主机](http://en.wikipedia.org/wiki/Windows_Script_Host)，它可以让您编写支持 COM API 的脚本。这支持[vbscript](http://en.wikipedia.org/wiki/VBScript)和[javascript](http://en.wikipedia.org/wiki/JavaScript)，并且有自己的各种 API。

最后，还有一系列第三方脚本语言，例如 Python 或 Perl，可以在 Windows 上运行。这些语言的良好 windows 发行版可以从[Activestate](http://www.activestate.com)获得- Activestate python 是一个非常成熟和稳定的系统。您还可以使用名为[IronPython](http://www.codeplex.com/Wiki/View.aspx?ProjectName=IronPython)的 Python 的 .Net 版本，它本机使用 .Net 库。

事实上，大多数脚本语言都有相当成熟的 windows 端口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T20:17:27.553

如果我今天有更多投票，我会投票支持 NXC 的回答。我自己使用一点 Perl (ActiveState)、一些批处理文件和 javascript。Powershell 是最新添加的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T17:46:49.930

好像您正在寻找[Windows Powershell](http://www.microsoft.com/windowsserver2003/technologies/management/powershell/default.mspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-05T15:08:29.840

PowerShell、Ruby、Python 或 Cygwin 和 AT&T Research UWIN 之一。

# iphone - 使用自定义文本字段处理 iPhone 键盘？

> ID：627281
> 
> 赞同：0
> 
> 时间：2009-03-09T17:43:48.157
> 
> 标签：iphone, cocoa-touch

是否可以在 iPhone 上创建自定义文本字段？我想做的是有一个看起来适合应用程序设计的“alertview”，并使用图像作为对话框/警报，而不仅仅是标准的警报视图。因此，我将处理所有图形和输入处理，但是如何在不创建 TextField 的情况下弹出键盘并处理输入？

附带问题 - 这会违反 Apple 的输入标准吗？

在此先感谢，本

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T19:03:14.427

UITextField 已经非常可定制。我不确定您是否需要对其进行子类化。

除了它自己的属性来控制文本和覆盖之外，UITextView 是 UIView 的子类，因此您可以控制背景颜色并添加自己的子视图。如果你做后者，你必须小心打破 UITextView 中的事件处理。

UITextView 还处理您应该查看的所有键盘行为`UIKeyboardWillShowNotification`和相关通知。

没有人能说苹果会接受什么，不接受什么，但只要你的自定义 UI 清晰可用，你应该没问题

# php - 如何使用 PHP 和 GD 截取网站的屏幕截图？

> ID：627301
> 
> 赞同：2
> 
> 时间：2009-03-09T17:47:38.087
> 
> 标签：php, gd

如何使用 PHP 和 GD 库创建网站的屏幕截图。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-09T17:53:38.243

虽然您可能可以用它做某事，[`imagegrabscreen`](http://www.php.net/manual/en/function.imagegrabscreen.php)或者[`imagegrabwindow`](http://www.php.net/manual/en/function.imagegrabwindow.php)您只能在 Windows 机器上使用它，但即便如此，它也会很棘手。

您必须打开一个浏览器窗口到指定的 url（您可以使用 来执行此操作`exec`）并使用上述方法截取屏幕截图。

以下是手动输入的示例[`imagegrabwindow`](http://www.php.net/manual/en/function.imagegrabwindow.php)：

```
<?php
$browser = new COM("InternetExplorer.Application");
$handle = $browser->HWND;
$browser->Visible = true;
$browser->Navigate("http://www.libgd.org");

/* Still working? */
while ($browser->Busy) {
    com_message_pump(4000);
}
$im = imagegrabwindow($handle, 0);
$browser->Quit();
imagepng($im, "iesnap.png");
imagedestroy($im);
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T17:55:52.777

网站呈现在客户端，而 PHP 和 GD 是服务器端。你也可以看看[这个网站](http://www.zubrag.com/scripts/website-thumbnail-generator.php)。希望能帮助到你。

# asp.net - 使用基本 HTTP 身份验证和 ASP.NET (VB) 对 Google Search Appliance 进行身份验证

> ID：627302
> 
> 赞同：0
> 
> 时间：2009-03-09T17:48:06.167
> 
> 标签：asp.net, vb.net, http-authentication, google-search-appliance

我遇到了一个障碍，这与 Google Search Appliance 和 ASP 之间的身份验证有关。通常，当从 Search Appliance 请求安全页面时，Search Appliance 会请求凭据，然后使用这些凭据尝试访问安全结果。如果此尝试成功，该页面将显示在结果列表中。由于 ASP 代表客户与 Search Appliance 联系，因此它需要收集凭据并将其传递给 Search Appliance。我已经尝试了几种不同的记录方法来实现这一点，但它们似乎不起作用。以下是我尝试过的代码：

```
'Bypass SSL since discovery.gov.mb.ca does not have valid SSL cert (NOT PRODUCTION SAFE)
ServerCertificateValidationCallback = New System.Net.Security.RemoteCertificateValidationCallback(AddressOf customXertificateValidation)

googleUrl = "https://removed.com"

Dim rdr As New XmlTextReader(googleUrl)

Dim resolver As New XmlUrlResolver()

Dim myCred As New System.Net.NetworkCredential("USERNAME", "PASSWORD", Nothing)

Dim credCache As New CredentialCache()

credCache.Add(New Uri(googleUrl), "Basic", myCred)

resolver.Credentials = credCache

rdr.XmlResolver = resolver

doc = New System.Xml.XPath.XPathDocument(rdr)
path = doc.CreateNavigator()

Private Function customXertificateValidation(ByVal sender As Object, ByVal certificate As System.Security.Cryptography.X509Certificates.X509Certificate, ByVal chain As System.Security.Cryptography.X509Certificates.X509Chain, ByVal sslPolicyErrors As Net.Security.SslPolicyErrors) As Boolean

Return True

End Function 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-14T12:19:06.120

在这里看看这个项目： [GSALib on CodePlex](http://www.codeplex.com/GSALib)。它是用于 GSA 和 GSA 迷你设备的开源 API。它可以处理来自任何 .NET 应用程序的传递凭据、查询结果等。虽然是用 C# 编写的，但您可以查看代码并了解它们如何处理身份验证例程或使用它来代替您自己的自定义代码，这可以为您节省大量时间。

旁注：我在 VB.NET Web 应用程序中使用过 GSALib dll，过去没有任何问题。

# c# - WPF ComboBox 中以编程方式清除选择

> ID：627304
> 
> 赞同：17
> 
> 时间：2009-03-09T17:48:13.233
> 
> 标签：c#, wpf

我在 WPF 中有一个 ComboBox，其 ItemsSource 以编程方式设置为列表。我将如何清除事件处理程序中的选择？我试过了：

```
comboBox.SelectedIndex = -1;
comboBox.SelectedItem = null;
comboBox.SelectedValue = null;
comboBox.SelectedValue = ""; 
```

它们都没有任何效果。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-03-09T18:08:21.717

`comboBox.SelectedIndex = -1;`为我工作。

你在你的事件处理程序中做其他事情吗？你在使用数据绑定吗？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-09T18:11:34.033

```
comboBox.SelectedIndex = -1; 
```

是要走的路。我不知道为什么它对你不起作用；`SelectedIndexChanged`也许是用于更改值的事件处理程序？

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-06-07T10:07:20.010

我发现我还需要添加：

```
comboBox.Text = ""; 
```

清除文本

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-06T18:38:38.080

我想清除另一个`ComboBox`. 因此我在第一个事件中使用了以下代码`DropDownClosed``ComboBox``ComboBox` `DropDownClosed`

```
private void comboBox1_DropDownClosed(object sender, EventArgs e)
{
  this.comboBox.ItemsSource = null;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-04-02T23:13:28.277

在下面的示例中，我展示了它对我的工作方式，这适用于来自用户控件的 ComboBox：

用户控件中的组合框：

```
<ComboBox x:Name="OFFSE_INI_CMBX" HorizontalAlignment="Left" Margin="26,106,0,0" VerticalAlignment="Top" Height="20" Width="100" DropDownClosed="OFFSE_INI_CMBX_DropDownClosed">
        <ComboBoxItem x:Name="NV" Content="           NV" ToolTip="Sub Command &#10;Tooltip 1" Height="20" Selected="NV_Selected"></ComboBoxItem>
    </ComboBox> 
```

有效的功能

```
private void OFFSE_INI_CMBX_DropDownClosed(object sender, EventArgs e)
    {
        this.OFFSE_INI_CMBX.SelectedIndex = -1;
        this.OFFSE_INI_CMBX.Text = "";
    } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-06-18T10:10:22.887

ComboBox.SelectedIndex = -1 对我不起作用，可能是因为我在自定义 ComboBox 中使用了自定义 ControlTemplate？无论如何，重置 ItemsSource 确实有效。我从行为中调用它。

```
 var items = comboBox.ItemsSource;
            comboBox.ItemsSource = null;
            comboBox.ItemsSource = items; 
```

# .net - 关于关闭 .NET 2.0 应用程序的 watson 博士崩溃对话框

> ID：627306
> 
> 赞同：1
> 
> 时间：2009-03-09T17:48:32.530
> 
> 标签：.net, crash, drwatson

我们偶尔会在进程退出时收到 dr watson 崩溃对话框。该过程是.NET 2.0。该对话框不是很有帮助。它说进程停止工作，在细节中我可以看到它是关于 System.NullReferenceException 的，很好但是回溯在哪里？

通常，当 .net 进程出现错误时，会将回溯打印到标准错误。但不是在这种情况下，可能是因为进程退出。出现此对话框时，谁能给我指点如何获取有关崩溃原因的更多信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T18:01:28.723

我倾向于在开发机器上[禁用 Dr Watson](http://support.microsoft.com/default.aspx/kb/188296)，并使用 Visual Studio 作为即时调试器，当应用程序爆炸时会启动它。我发现这种方式在根本原因分析方面更有用，特别是如果您有可用的调试信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T17:56:39.967

使用 WinDBG 附加。异常很可能是在非托管代码中引发的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T17:56:56.533

如果崩溃是可重现的，那么在关闭应用程序之前，可能值得将调试器设置为在所有异常（可能包括本机和 CLR）上中断。通常崩溃可能是由于较早的错误导致的，因此这可能会为您提供线索。

您查看过 Watson 博士的转储文件吗？这些通常应该至少告诉您是哪个模块导致了问题。如果您正在处理本机代码，您将能够将 Dr Watson 提供的 minidump 文件加载到 Visual Studio 中，并在该机器上提供调试符号文件和源代码，您将能够在以下位置查看应用程序的状态崩溃的时间，有问题的线程的调用堆栈，以及导致崩溃的代码行。我不知道托管代码会发生什么，但可能值得一试。

此链接应为您提供有关分析小型转储文件的更多信息 [Link to CodeProject](http://www.codeproject.com/KB/debug/postmortemdebug_standalone1.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-11-10T09:44:15.530

I use [DILE](http://sourceforge.net/projects/dile/) to debug applications on production servers.

> Dotnet IL Editor (DILE) allows disassembling and debugging .NET 1.0/1.1/2.0/3.0/3.5 applications without source code or .pdb files. It can debug even itself or the assemblies of the .NET Framework on IL level.

It has saved my life multiple times where applications would crash and no more information was available. It has a high learning curve though, but worth knowing about for those situations where you don't have access to Visual Studio or other tools.

I believe the newer versions can also read dump files.

# c# - 我们可以使用 nant 在 C# 中构建 .sln 文件吗？

> ID：627315
> 
> 赞同：5
> 
> 时间：2009-03-09T17:50:56.457
> 
> 标签：c#, nant

我们可以使用 nant 在 C# 中构建 .sln 文件吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-09T17:54:19.583

根据我的经验，最简单的方法是使用 NAnt 调用 MSBuild，并让 MSBuild 自己构建解决方案文件。以我的[Protocol Buffers 构建文件](http://github.com/jskeet/dotnet-protobufs/blob/8e1b456365efe0b082ea79d8221297879d1a155c/ProtocolBuffers.build)为例。

我使用有一个任务的[NAntContrib ：](http://nantcontrib.sourceforge.net/)`msbuild`

```
<property name="nantcontrib-dir"
   value="${path::combine(nant::get-base-directory(), '../../NAntContrib')}"
   overwrite="false" />

<loadtasks assembly=
    "${path::combine(nantcontrib-dir, 'bin/NAnt.Contrib.Tasks.dll')}" 
 />  

...

<target name="build"
        description="Builds all C# code">
  <msbuild project="${src}/ProtocolBuffers.sln">
    <property name="Configuration"
              value="${build-configuration}" />
  </msbuild>
</target> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-09T17:55:37.943

[msbuild](http://nantcontrib.sourceforge.net/release/0.85-rc4/help/tasks/msbuild.html)任务，既可以构建您的解决方案，也可以执行整个 msbuild 脚本：

```
<target name="compile">
       <msbuild project="xxx.sln">
              <arg value="/property:Configuration=release" />                                  
              <arg value="/t:Rebuild" />
       </msbuild>
</target> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-09T17:54:10.583

`msbuild`您可以作为 nant 任务调用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-09T17:54:13.170

[解决](http://nant.sourceforge.net/release/0.85/help/tasks/solution.html)任务可能会有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-09T17:55:38.097

您可以使用解决方案任务，尽管它不支持 nant Beta 版本之外的 VS2008 解决方案。不过它来了。

# vim - Vim：使用表达式作为文件名

> ID：627316
> 
> 赞同：1
> 
> 时间：2009-03-09T17:51:03.630
> 
> 标签：vim, scripting, editing

我正在做一些调试，其中涉及检查日志文件名称“blah N.log”，其中 N 是整数。定期添加一个新的日志文件，我只想跳到下一个日志文件，而不是明确地做`:e blah\ N.log`. 我不能只做`% vim *.log`然后`:n`，b/c 并不是所有的日志文件都存在。

我有一个产生下一个日志文件名称的表达式：

```
:echo substitute(expand('%'), ' \zs\d\+', \=submatch(0) + 1', '') 
```

但我不知道如何将该表达式的结果传递给`:e`命令。有小费吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T18:04:23.413

这是**一种**方法-尽管我希望有一种更优雅的方法。

```
:execute ':e ' . substitute(substitute(expand('%'), ' \zs\d\+', \=submatch(0) + 1', ''), ' ', '\\ ', '') 
```

我必须添加第二个`substitute()`命令来转义文件名中的空格。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T18:06:24.623

或者你可以将它包装在一个函数中。我会做以下事情：

```
function! GetNextLogfile()
    "" store expression in a
    "" let a=...
    return a
endfunction 
```

然后

:执行“编辑”GetNextLogfile()

您可能需要映射或缩写。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T18:27:40.750

还有一种方式：`:e <CTRL-R>=`调出表情提示。输入适当的表达式（包括用 up 表示表达式历史），然后点击`<Enter>`替换原始提示中的值。

这使得击键：

```
:e <CTRL-R>=<Up><Enter><Enter> 
```

这不仅仅是`:<Up><Enter>`重做我的`:exec`命令，而是一个有用的技巧，尽管如此。

# c++ - 如何让进程在 linux 中重新加载自身？

> ID：627319
> 
> 赞同：3
> 
> 时间：2009-03-09T17:51:23.630
> 
> 标签：c++, linux, process, reload, restart

我有一个服务，比如 foo，用 C++ 编写，以 root 身份运行。有通常的脚本，/etc/init.d/foo start|stop|restart。

在某些时候， foo 需要重新加载自己。通常在升级完成后。但是做这样的事情：

```
system("/etc/init.d/foo restart") 
```

不起作用，因为只要重新启动杀死 foo，system() 调用显然也会被杀死，并且重新启动脚本永远不会执行完成。

是否可以使用另一个调用来代替 system() 作为调用进程的同级异步运行，而不是创建同步子进程？

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-09T17:55:07.257

你考虑过`exec[*]`家庭吗？这里有一个—— [`execve`](http://linux.die.net/man/2/execve)。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-09T17:57:29.670

您可以将它放在 inittab 中，让 init 在它因任何原因退出时担心重新启动进程。如果您的进程碰巧崩溃或 assert() 或以其他方式意外退出，这也将负责自动重启。

然后，为了处理您的用例，该过程将简单地自行终止。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-09T17:55:58.160

fork() 后跟 exec() 怎么样？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-09T20:59:19.200

考虑实施

```
/etc/init.d/foo reload 
```

对于您的守护进程（通过我的 Debian 盒子的 grep 判断非常标准）。

这通常通过向进程发送 SIGHUP 信号来完成；守护程序应该有一个信号处理程序，它可以捕获并重新加载任何配置。

如果进程知道它需要重新加载，它可以自己发出信号。

如果您确实需要重新启动以获取新库，请使用`exec*()`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-09T17:57:26.237

结合到目前为止的两个答案，使用[fork-exec](http://en.wikipedia.org/wiki/Fork-exec)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-09T18:10:29.980

补充一下 Ori 已经说过的内容，一些 Linux 发行版仍然使用 initab，但 Ubuntu 和可能的其他发行版已经切换到 /etc/event.d。您将文件放在那里（复制并编辑现有文件之一），然后使用“sudo start ssh_tunnel”或您的文件被调用的任何内容启动守护程序。

然后当你需要它重启的时候，你可以用一个信号杀死它，系统会重启它。或者它可以通过调用“exit(0);”自行决定是时候重新启动了。管他呢。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-09T18:58:27.603

`exec*()`单独在原始命令行上应该可以解决问题。您可能可以省略分叉，因为您运行了两个不需要的副本，然后需要退出原始副本。

但还要根据您的发行版查看 inittab 和 event.d，看看它是否会以更好的方式满足您的需求。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-10T12:26:35.633

Ori 和 Paul 建议的第三种可能性是使用 daemontools。它更便携，但不太可能可用。您创建一个名为 /service/foo/run 的脚本，并且 daemontools 将在它退出时重新生成您的服务。

[http://cr.yp.to/daemontools.html](http://cr.yp.to/daemontools.html)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-09T18:44:46.263

查看 inittab 的手册页。

它描述了如果系统死亡（重生），系统将如何自动重新启动您的进程。

正确设置后，您的服务所要做的就是退出，系统将自动为您处理重新启动（重生）。

# asp.net - ASP.Net 多个源文件

> ID：627327
> 
> 赞同：3
> 
> 时间：2009-03-09T17:53:46.683
> 
> 标签：asp.net

在未编译的 .aspx 中，一个 aspx 是否可以有 2 个部分类文件？我正在尝试做类似的事情：

```
    <%@ 页
        语言="C#"
        继承="_Default"
        src="默认.aspx.cs"
        src="Default2.aspx.cs" %>

```

Default 和 Default2 都定义了部分类

更新：是的..它没有被编译或者这点没有实际意义，因为我只是将相应的 dll 放在 /bin 目录中。我需要不编译它，因为需要定期更改源。我可能会想出一种方法来更新 aspx，但我不想这样做。

我使用两个源文件的原因是有很多源代码连接到我的数据库等等。我有一个人会搞砸数据库的东西，另一个人会搞砸其他逻辑。我希望将这些文件分开，这样他们就不必混淆他们不需要查看的代码

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-09T18:01:32.750

是和不是。是的，您可以拥有任意数量的部分类。不，您不能（也不必！）在 Page 指令中指定它们。

```
<%@ Page 
        Language="C#" 
        inherits="Default" %> 
```

在 Default.aspx.cs 中：

```
public partial class Default
{ /*yadda*/ } 
```

在 Default2.aspx.cs 中：

```
public partial class Default
{ /* even more yadda */ } 
```

部分类是编译器的错觉。就 CLR 而言，它们并不存在。C# 编译器在编译期间将所有分部类拼接在一起；从 asp.net 编译器的角度来看，只有一个 Default 类。

* * *

从您的更新中听起来，您需要的不是多个部分类，而是重构您的代码。您应该放弃部分类的想法并使用依赖注入/控制反转。分离出您的数据库逻辑和其他关注领域，使用接口定义它们，然后在运行时使用 DI 容器框架注入这些“提供者”的所需实现。

这将您的代码分开，并为您的应用程序提供更大的灵活性、可测试性和易于更新；比仅仅将代码分成两个或多个文件要好得多。DI 也很容易理解和实现。我正在使用[Unity](http://www.theserverside.net/news/thread.tss?thread_id=48415)进行 DI 并喜欢它。花了大约一天的时间来加快速度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T17:55:54.993

`Src`不，最多可以指定一个属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T18:51:50.023

虽然不是您问题的直接答案，但您是否考虑过从基本页面继承来合并代码？

在您的 Default.aspx.cs 中：

```
public partial class Default : CustomBasePage
{
    protected void Page_Load(object sender, EventArgs e)
    {

    }
} 
```

在您的 CustomBasePage.cs 中：

```
public class BasePage: System.Web.UI.Page
{
    protected override void OnPreInit(EventArgs e)
    {
        base.OnPreInit(e);

        //Your custom code
    }
} 
```

如果您需要在 default.aspx.cs 中覆盖事件方法等，请务必调用基本方法。

# svn - 创建一个新文件夹会破坏颠覆吗？

> ID：627350
> 
> 赞同：-2
> 
> 时间：2009-03-09T17:57:35.707
> 
> 标签：svn

我有一个 subversion 存储库，但有些事情我不希望它搞砸。例如，SVN 会破坏 mac 资源文件，因为 unix 不知道资源分叉。

但是，我仍然想要某种形式的备份/版本控制。我希望能够在顶级存储库文件夹中创建一个文件夹，并将我的东西放在那里。但是，该文件夹中的 readme.txt 文件说“除非你知道自己在做什么，否则不要碰它”。

那么，这样做安全吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T09:27:07.687

这样做我会非常紧张。

虽然它可能不会立即主动破坏 subversion，但 subversion 会假设它完全控制了存储库中的所有文件夹，并且它知道它们都是什么。如果某些工具、脚本或进程对所有文件执行一些通用操作，您可能会发现备份损坏和/或存储库损坏。

并且仅仅因为它不会在当前版本中破坏它，并不意味着它不会在下一个版本中引起问题。所以基本上 - 我真的会避免这样做，这会让一切变得非常混乱。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T18:07:29.210

你永远不应该直接弄乱存储库文件夹。

使用 svn 客户端并通过 file:/// url 访问存储库或设置服务器（svn、apache），然后通过 svn:// 或 http(s):// 访问存储库。

然后您可以毫无问题地创建子文件夹。

但我强烈建议您先阅读[Subversion 书籍](http://svnbook.red-bean.com/)（可在线免费获得），因为您似乎缺乏一些关于存储库以及如何正确使用 Subversion 的基本知识。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T18:10:30.777

简短的回答，不。我假设您想要一个备份文件夹，您只需存储在 svn 存储库路径（文件层次结构）下。我刚试了一下，效果很好。当然，它不包含 svn 方式的文件——只是老式的文件层次结构。例如，如果您想保存手动备份之类的内容，或者您​​的 svn repo 目录实际上位于 RAID 驱动器上，则此方法有效。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T18:11:13.163

补充 Stefan 的答案：确保您了解存储库位置（保存该存储库的数据库和配置）与 Subversion 呈现给用户的虚拟文件夹结构之间的区别。

# c - 实施无中断自动保存

> ID：627351
> 
> 赞同：1
> 
> 时间：2009-03-09T17:57:37.283
> 
> 标签：c, gtk, gnome, autosave

为了添加自动保存功能，我一直在修改 Xournal 的代码。我最初的实现非常愚蠢：每 60 秒左右进行一次保存。该功能表面上有效。

然而，在测试了一段时间后，我注意到当自动保存运行时，应用程序会暂时冻结，如果你正处于笔画的中间，这会很烦人。我试图弄清楚如何解决这个问题。

我想到的一种可能性是自动保存在自动保存之前检查笔是否正在触摸屏幕；如果它被触摸，请附加一个仅在笔抬起后一秒钟安排的一次回调。（如果发生同样的事情，重复）。另一种可能性是充分优化保存功能，以便没有间隙（似乎不太可能）。

有人对此有什么建议吗？Xournal 使用 Gnome/GTK 工具包，并用 C 编写。

**更新：**我实现了反破坏逻辑，我对由此产生的自动保存粒度和性能非常满意。其中一个时间线程（谢天谢地）是不必要的！谢谢大家的建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T18:17:01.650

如果 UI 在任何明显的时间段内冻结，则可能要使用单独的线程。如果您注意到 UI 冻结的唯一原因是因为您当时正在写作并且中断只是非常短暂，那么您的方法可能会奏效。您的修复可能比创建另一个线程更容易，因此请先尝试。

如果您最终使用线程，请使用 g_threads 而不是 pthreads，因为您使用的是 GTK+。它们将更便携。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T18:35:24.883

虽然我同意使用线程是一个“正确”的文本框答案，但这并不总是你必须做的事情。如果您不小心，多线程往往会引发大量问题——这里的主要问题可能是在自动保存期间锁定对数据的访问。然后，如果主线程进入等待访问数据的状态，你就回到了开始的地方。因此，您创建了一个待处理更改或其他内容的队列，并且您忘记了正在发生的事情。根据底层数据结构的复杂程度，制作副本也可能会冻结主线程。

**无论如何**，我会尝试你的第一个选择。它快速、简单、切中要害，我不明白为什么它不起作用。

（注意：我没有看过 Xournal 的引擎盖，所以把它和一粒盐一起拿。或者盐瓶。或者什么）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T18:03:40.123

您可以将自动保存功能推送到单独的线程吗？通过在第二个线程上运行，您将能够与 gui 并行运行保存并避免冻结窗口。

我对c的经验很少，但我认为[这个网站](https://computing.llnl.gov/tutorials/pthreads/)可以提供帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T18:40:51.267

我过去也遇到过类似的情况，这是我解决它的方法（.Net）：

1.  后台计时器以 x 秒为间隔计时
2.  在滴答声上，禁用计时器并处理适当的事件。
3.  在事件处理程序中，保存并启用计时器。

我们看到的唯一实际发生的缺陷是有人在调用事件处理程序之前杀死了应用程序并失去了 1 分钟的工作量。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-09T18:54:26.770

这个怎么样？

使用回调的想法，但除了每 60 秒外，还让它每 10 个输入运行一次。使用基于时间的自动保存，存在一个问题，即丢失的内容量与用户的工作速度成正比。

如果您想更进一步，除了完整保存之外，还可以在每次更改后将部分撤消日志保存到磁盘。这样，崩溃可能发生的最糟糕的事情就是丢失最后一个输入笔划。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-09T19:54:10.060

我的重点是使用 hipervisor 线程通过一些哈希算法比较文件内容每 N 秒发生更改事件，然后通知父线程并回调自动保存函数。

# c# - Silverlight/WCF 登录会话

> ID：627353
> 
> 赞同：1
> 
> 时间：2009-03-09T17:57:55.377
> 
> 标签：c#, .net, wcf, silverlight, security

我正在使用 Silverlight 开发一个系统，并使用 WCF 调用服务来完成服务器端的所有工作。

我需要让用户登录系统，一旦验证通过，对服务器的所有调用都需要包含用户信息，以便服务器可以检查安全策略并根据用户执行其他操作。

做这个的最好方式是什么？我可以创建某种用户类并在每次调用时将其发送到服务器，但是有没有更好的方法来使用 Silverlight 和/或 WCF 来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T18:56:46.640

我会使用基于标准令牌的方法。当您登录到服务器时（按照您的建议通过用户类传递所有必需的信息），服务器将使用令牌进行响应。每个其他服务器调用都需要一个有效的令牌。然后服务器验证令牌是否仍然有效（它会在一段时间后自动过期）并且它来自同一台机器/用户（例如，您可以检查 IP 地址）。

这可能是我实现它的方式。您不想在每次服务器调用时都传递所有用户信息。（如果您在 Intranet 上，您可能想要使用模拟或类似的东西。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T06:57:06.587

Silverlight 控件不能直接访问会话变量，因为 Silverlight 控件是客户端控件。但是我们可以调用 WCF 服务来管理 Silverlight 中的会话。

我们必须在 wcf 服务中设置会话变量，如下所示。

```
<ServiceContract(Namespace:="")> _
<AspNetCompatibilityRequirements
(RequirementsMode:=AspNetCompatibilityRequirementsMode.Allowed)> _
Public Class PersonService
    <OperationContract()> _
    Public Sub DoWork()
        ' Add your operation implementation here
    End Sub
    ' Add more operations here and mark them with <OperationContract()>

   <OperationContract()> _
   Public Sub SetSessionVariable(ByVal Sessionkey As String)
        System.Web.HttpContext.Current.Session("Key") = Sessionkey
        System.Web.HttpContext.Current.Session.Timeout = 20
    End Sub
    <OperationContract()> _
    Public Function GetSessionVariable() As String
        Return System.Web.HttpContext.Current.Session("Key")
    End Function

End Class 
```

通过将服务引用到 silverlight 应用程序，我们可以在 .xaml 页面中设置会话变量，如下所示。

```
Dim client As Service.PersonServiceClient = New Service.PersonServiceClient()
'Calls the SetSessionVariable() and store values in the session.
client.SetSessionVariableAsync("Soumya")

We will get the session variable in the .xaml page by calling GetSessionVariable() where we want to check the session

Dim client As Service.PersonServiceClient = New Service.PersonServiceClient()
AddHandler client.GetSessionVariableCompleted, AddressOf client_GetSessionVariableCompleted
client.GetSessionVariableAsync()

Private Sub client_GetSessionVariableCompleted(ByVal sender As Object, ByVal e As GetSessionVariableCompletedEventArgs)
        Try
            If Not String.IsNullOrEmpty(e.Result) Then
                MessageBox.Show(e.Result)
            Else
                MessageBox.Show("Your session has been expired")
            End If
        Catch ex As FaultException        
        End Try
End Sub 
```

# delphi - 为什么我的自定义组件会在 IDE 中引发 AV？

> ID：627355
> 
> 赞同：0
> 
> 时间：2009-03-09T17:58:21.943
> 
> 标签：delphi, components, sdl, access-violation

我正在尝试编写一个简单的组件，它允许您使用 SDL 1.3 API 在 Delphi 窗口中嵌入一个或多个 SDL 渲染表面。它可以很好地编译和安装，但是当我尝试在表单设计器中使用该组件时，每当我尝试在对象检查器中访问其属性、保存表单或删除组件并将其放置在然后尝试运行的表单会出现链接器错误：无论出于何种原因，它显然都无法正确读取 DFM。

DLL 可以在[http://www.libsdl.org/tmp/SDL-1.3-dll.zip](http://www.libsdl.org/tmp/SDL-1.3-dll.zip)找到，我的组件的源代码可以在[这里](http://turbu-rpg.com/downloads/sdlframe.zip)下载。SDL.pas 是 JEDI-SDL 头文件；其余的是我自己的代码。

我认为没有任何理由在表单设计器中提出 AV。如果我在运行时动态创建控件，我没有任何稳定性问题。任何人都可以看看这个，也许可以提供一些反馈来帮助我清理它？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-09T18:10:09.000

你可以自己调试这个。打开包含您的组件的包项目。然后转到运行|参数并输入 IDE 本身作为主机应用程序。从 IDE 中运行 IDE。然后重复您的步骤来重现 AV，IDE 应该会停止并向您显示哪里出了问题。您可以从那里使用正常的调试技术。

# c# - 如何不序列化 JSON 对象的 __type 属性

> ID：627356
> 
> 赞同：65
> 
> 时间：2009-03-09T17:59:01.193
> 
> 标签：c#, asp.net, json, asmx, javascriptserializer

`WebMethod`我从a返回的每个对象`ScriptService`都被包装到一个 JSON 对象中，其中的数据位于名为 的属性中`d`。没关系。但我不希望将附加`__type`属性提供给客户端，因为我使用 jQuery 进行手动处理。

可能吗？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-04-22T16:09:14.660

我发现，如果我将我的类的默认构造函数设为我的 web 方法返回除 public 以外的任何内容，它不会序列化该`__type:ClassName`部分。

您可能想要声明您的默认构造函数`protected internal ClassName() { }`

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2010-10-01T13:33:31.940

John 的解决方案对我不起作用，因为我返回的类型位于单独的 DLL 中。我可以完全控制那个 DLL，但是如果构造函数是内部的，我就不能构造我的返回类型。

我想知道返回类型是否是库中的公共类型甚至可能是原因 - 我已经做了很多 Ajax 并且以前没有见过这个。

快速测试：

*   暂时将返回类型声明移至 App_Code。还是要`__type`连载。

*   同上并为每个 JM 应用受保护的内部构造函数。这行得通（所以他得到了投票）。

奇怪的是，我没有得到`__type`一个通用的返回类型：

```
[WebMethod]
public static WebMethodReturn<IEnumerable<FleetObserverLiteAddOns.VehicleAddOnAccountStatus>> GetAccountCredits() 
```

然而，对我来说，**解决方案**是将我的返回类型保留在 DLL 中，但**将 WebMethod 返回类型更改为 object**，即

```
[WebMethod]
public static object ApplyCredits(int addonid, int[] vehicleIds) 
```

代替

```
[WebMethod]
public static WebMethodReturn ApplyCredits(int addonid, int[] vehicleIds) 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2010-12-19T11:18:52.207

我一直在使用 .NET 4 WCF 服务尝试其中一些建议，但它们似乎不起作用 - JSON 响应仍然包含 __type。

我发现删除类型提示的最简单方法是将端点行为从 enableWebScript 更改为 webHttp。

```
 <behavior name="MapData.MapDataServiceAspNetAjaxBehavior">
      <webHttp />
    </behavior> 
```

如果您使用的是 ASP.NET AJAX 客户端，则需要默认 enableWebScript 行为，但如果您使用 JavaScript 或 jQuery 操作 JSON，那么 webHttp 行为可能是更好的选择。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2012-10-12T16:51:58.227

如果您使用的是[ServiceStack.Text JSON Serializer](http://www.servicestack.net/docs/text-serializers/json-serializer)，您只需要：

```
JsConfig.ExcludeTypeInfo = true; 
```

此功能在[v2.28](https://github.com/ServiceStack/ServiceStack/wiki/Release-Notes)中自动添加回，但上面的代码将其排除在序列化之外。您还可以通过以下方式更改此行为`Type`：

```
JsConfig<Type>.ExcludeTypeInfo = true; 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-10-17T22:31:07.293

我想我已经缩小了神秘出现的“__type”的根本原因！

这是一个可以重新创建问题的示例。

```
[WebService(Namespace = "http://tempuri.org/")]
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
[System.ComponentModel.ToolboxItem(false)]
[System.Web.Script.Services.ScriptService]
public class Test : System.Web.Services.WebService
{
    public class Cat
    {
        public String HairType { get; set; }
        public int MeowVolume { get; set; }
        public String Name { get; set; }
    }

    [WebMethod]
    public String MyMethodA(Cat cat)
    {
        return "return value does not matter";
    }

    [WebMethod]
    public Cat MyMethodB(String someParam)
    {
        return new Cat() { HairType = "Short", MeowVolume = 13, Name = "Felix the Cat" };
    }
} 
```

**这是关键部分！**

仅仅因为 MyMethodA() 存在于同一个 .asmx 文件中**，并且**将 Cat 类作为参数.... __type 将被添加到调用另一个方法返回的 JSON 中：MyMethodB()。

**虽然方法不同！！**

我的理论如下：

1.  在编写这样的 Web 服务时，Microsoft 的代码会自动为您连接 JSON 序列化/反序列化行为，因为您使用了正确的属性，例如 [WebMethod] 和 [ScriptService]。
2.  当这个自动魔术 Microsoft 代码执行时，它会找到一个将 Cat 类作为参数的方法。
3.  它数字......哦......好吧......好吧，因为我将从JSON接收一个Cat对象......因此......如果我从当前Web服务中的任何方法返回一个Cat对象作为**JSON**类...我会给它一个 __type 属性，以便稍后在反序列化回 C# 时很容易识别。
4.  呐～哈哈哈哈……

**重要外卖注意事项**

您可以避免 __type 属性出现在生成的 JSON 中，方法是避免将有问题的类（在我的例子中为 Cat）作为 Web 服务中任何 WebMethods 的参数。因此，在上面的代码中，只需尝试修改 MyMethodA() 以删除 Cat 参数。这会导致**不**生成 __type 属性。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-11-24T03:02:57.857

为 JavaScriptTypeResolver 传入 null 并且 __type 不会被序列化

```
JavaScriptSerializer serializer = new JavaScriptSerializer(null);
string json = serializer.Serialize(foo); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-03-03T19:54:50.043

我不确定这是一个好的解决方案，但是如果您使用[**Json.net**](http://www.codeplex.com/Json) 库，您可以通过添加**[JsonIgnore]**属性来忽略某些属性。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-10-03T19:18:41.693

除了 John Morrison 对DataContract 类中的**内部**或**受保护的内部**构造函数的建议之外，它对 Web 服务和大多数 WCF 都非常有效，您可能需要在 web.config 文件中进行额外的更改。而不是用于您的端点行为的`<enableWebScript/>`元素`<webHttp/>`，例如：

```
<endpointBehaviors>
  <behavior name="MyServiceEndpoint">
    <webHttp/>
  </behavior>
</endpointBehaviors> 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2015-03-08T10:21:25.100

我的 2 美分，但在当天很晚：正如其他人所提到的，似乎有两种方法可以防止“__type”属性：

a) 保护无参数构造函数

b) 避免将类作为参数传递给 Web 方法

如果您永远不需要将类作为参数传递，那么您可以使构造函数“受保护的内部”。如果您需要创建一个空对象，请添加工厂方法或其他带有虚拟参数的构造函数。

但是，如果您需要将类作为参数传递给Web方法，那么您会发现如果无参数构造函数受到保护，这将不起作用（ajax调用失败，大概是因为传入的json数据无法反序列化到您的类中）。

这是我的问题，所以我不得不使用 (a) 和 (b) 的组合：保护无参数构造函数并创建一个虚拟派生类，专门用于 Web 方法的参数。例如：

```
public class MyClass
{
    protected internal MyClass() { }
    public MyClass(Object someParameter) { }
    ...
}

// Use this class when we need to pass a JSON object into a web method
public class MyClassForParams : MyClass
{
    public MyClassForParams() : base() { }
} 
```

任何需要接受 MyClass 的 web 方法然后使用 MyClassForParams 代替：

```
[WebMethod]
[ScriptMethod(ResponseFormat = ResponseFormat.Json)]
public MyClass DoSomething(MyClassForParams someObject)
{
    // Do something with someObject
    ...
    // Maybe return a MyClass object
    ...
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-06-03T08:32:00.047

不要使用 [Serializable] 属性。

以下应该做到这一点

> JavaScriptSerializer ser = new JavaScriptSerializer(); 字符串 json = ser.Serialize(objectClass);

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-05-22T05:09:05.130

线程有点晚了，但这里有。

当添加到 json 字符串的属性是 List<T> 时，我们遇到了同样的问题。我们所做的是添加另一个属性，它是一个 T 数组，类似于。

前。

```
[DataMember]
public List<Person> People { get; set; } 
```

后。

```
public List<Person> People { get; set; }

[DataMember(Name = "People")]
public Person[] Persons {
    get {
        return People.ToArray();
    }
    private set { }
} 
```

虽然不是一个理想的解决方案，但它可以解决问题。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2018-11-05T20:52:44.317

这是一种解决方法

```
 [WebMethod]
    [ScriptMethod(UseHttpGet = true, ResponseFormat = ResponseFormat.Json)]
    public void Status()
    {
        MyObject myObject = new MyObject(); // Your class here
        var json = Newtonsoft.Json.JsonConvert.SerializeObject(myObject);

        HttpContext.Current.Response.Write(json);
    } 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2010-08-09T21:50:38.363

这应该解决它。

在 System.WebExtensions.dll 中 JavaScriptSerializer 的私有 SerializeValue 方法中，如果可以解析 __type，则将其添加到内部字典中。

从反射器：

```
private void SerializeValue(object o, StringBuilder sb, int depth, Hashtable objectsInUse)
{
    if (++depth > this._recursionLimit)
    {
        throw new ArgumentException(AtlasWeb.JSON_DepthLimitExceeded);
    }
    JavaScriptConverter converter = null;
    if ((o != null) && this.ConverterExistsForType(o.GetType(), out converter))
    {
        IDictionary<string, object> dictionary = converter.Serialize(o, this);
        if (this.TypeResolver != null)
        {
            string str = this.TypeResolver.ResolveTypeId(o.GetType());
            if (str != null)
            {
                dictionary["__type"] = str;
            }
        }
        sb.Append(this.Serialize(dictionary));
    }
    else
    {
        this.SerializeValueInternal(o, sb, depth, objectsInUse);
    }
} 
```

如果无法确定类型，序列化仍将继续，但类型将被忽略。好消息是，由于匿名类型继承 getType() 并且返回的名称是由编译器动态生成的，因此 TypeResolver 为 ResolveTypeId 返回 null 并且“__type”属性随后被忽略。

为了以防万一，我还采用了内部构造函数的 John Morrison 的建议，尽管仅使用这种方法，我仍然在我的 JSON 响应中获得 __type 属性。

```
//Given the following class
[XmlType("T")]
public class Foo
{
    internal Foo()
    {

    }

    [XmlAttribute("p")]
    public uint Bar
    {
        get;
        set;
    }
}

[WebService(Namespace = "http://me.com/10/8")]
[System.ComponentModel.ToolboxItem(false)]
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
[ScriptService]
public class MyService : System.Web.Services.WebService
{

    //Return Anonymous Type to omit the __type property from JSON serialization
    [WebMethod(EnableSession = true)]
    [System.Web.Script.Services.ScriptMethod(UseHttpGet = false, ResponseFormat = ResponseFormat.Json, XmlSerializeString = false)]
    public object GetFoo(int pageId)
    {
        //Kludge, returning an anonymois type using link, prevents returning the _type attribute.
        List<Foo> foos = new List<Foo>();
        rtnFoos.Add( new Foo(){
            Bar=99
        }};

        var rtn = from g in foos.AsEnumerable()
                   select g;

        return rtn;
    }
} 
```

**注意：** 我使用的是继承的 JSON 类型转换器，它从序列化类型中读取 XML 序列化属性以进一步压缩 JSON。感谢[CodeJournal](http://www.coderjournal.com/2007/08/creating-a-more-accurate-json-net-serializer/comment-page-1/#comment-25472)。奇迹般有效。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-03-27T15:42:56.293

除了@sean 对 using 的回答`JavaScriptSerializer`。

当使用 JavaScriptSerializer 并标记方法的`ResponseFormat = WebMessageFormat.Json`时，结果响应具有双 JSON 编码加上如果结果响应是`string`，它将被放在双引号之间。

为避免这种情况，请使用[此出色答案](https://stackoverflow.com/a/3079326/1225421)中的解决方案将内容类型定义为 JSON（覆盖）并将`JavaScriptSerializer`.

来自上述答案的代码示例：

```
public Stream GetCurrentCart()
{
    //Code ommited
    var j = new { Content = response.Content, Display=response.Display,
                  SubTotal=response.SubTotal};
    var s = new JavaScriptSerializer();
    string jsonClient = s.Serialize(j);
    WebOperationContext.Current.OutgoingResponse.ContentType =
        "application/json; charset=utf-8";
    return new MemoryStream(Encoding.UTF8.GetBytes(jsonClient));
} 
```

`JavaScriptSerializer`在默认情况下不引用的`System.Web.Script.Serialization`命名空间中。`System.Web.Extensions.dll`

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-09-15T07:13:52.590

您可以使用创建自己的返回类型来发送响应。并且在发送响应时使用对象作为返回类型 .so _type 属性将被忽略。

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2019-08-05T00:45:22.260

```
var settings = new DataContractJsonSerializerSettings();
settings.EmitTypeInformation = EmitTypeInformation.Never;
DataContractJsonSerializer serializerInput = new DataContractJsonSerializer(typeof(Person), settings);
var ms = new MemoryStream();
serializerInput.WriteObject(ms, personObj);
string newRequest = Encoding.UTF8.GetString(ms.ToArray()); 
```

* * *

## 回答 #17

> 赞同：-7
> 
> 时间：2011-06-14T20:38:40.783

这有点 hack，但这对我有用（使用 C#）：

```
s = (JSON string with "__type":"clsname", attributes)
string match = "\"__type\":\"([^\\\"]|\\.)*\",";
RegEx regex = new Regex(match, RegexOptions.Singleline);
string cleaned = regex.Replace(s, ""); 
```

适用于两者`[DataContract]`和`[DataContract(Namespace="")]`

# http-compression - 谁能推荐一个（免费）工具来测试 Web 服务器是否使用 http 压缩？

> ID：627357
> 
> 赞同：1
> 
> 时间：2009-03-09T17:59:26.327
> 
> 标签：http-compression

我看到有很多网站可以做到这一点，但我真的很想要一些我可以运行的东西来诊断我们没有暴露在互联网上的内部 Intranet 服务器。

而且，根据这个项目的预算，免费几乎是我唯一的选择。有没有人可以推荐任何很酷的工具？还是有一些我不知道的酷 Firefox 小部件？

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-09T18:03:06.957

如果您使用[Firebug](http://getfirebug.com/)，您可以进入“net”选项卡并查看下载的所有资源。寻找“Content-Encoding”，它会告诉你服务器是否使用 gzip/etc 发送数据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T18:05:26.263

您可以使用[LiveHeader](http://livehttpheaders.mozdev.org) for Firefox 查看响应标头。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-09T18:05:47.433

我使用“实时 HTTP 标头”，一个 FF 插件。

在标题中，您应该看到 Content-Encoding: {...}

对于stackoverflow.com，我看到：“内容编码：gzip”

编辑：根据评论的建议，修复了要查找的标题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-09T18:07:27.243

只需查看服务器发送的 HTTP 标头即可。内容编码字段应包含有关压缩的信息。

您可以使用[Wireshark](http://www.wireshark.org/)监控您的网络接口，包括服务器之间的通信，这将允许您查看原始标头和有效负载。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-09T18:16:59.590

您也可以使用提琴手。

[http://www.fiddlertool.com/fiddler/](http://www.fiddlertool.com/fiddler/)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-09T18:21:56.320

如果你没有 firefox 或者不想安装一些扩展来检查站点是否支持压缩，你可以使用普通的旧 telnet：

```
telnet stackoverflow.com 80
Trying 69.59.196.211...
Connected to stackoverflow.com.
Escape character is '^]'.
HEAD / HTTP/1.0
Host: stackoverflow.com
Accept-Encoding: gzip, deflate

HTTP/1.1 200 OK
Cache-Control: private
Content-Length: 26213
Content-Type: text/html; charset=utf-8
Content-Encoding: gzip
Expires: Mon, 09 Mar 2009 18:20:28 GMT
Vary: Accept-Encoding
Server: Microsoft-IIS/7.0
Date: Mon, 09 Mar 2009 18:20:27 GMT
Connection: close 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-09T18:28:00.860

我刚刚从meatspace 获悉firefox 开发人员的工具栏也有一个view headers 选项，所以你也可以在那里检查编码类型。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-25T06:05:50.853

另一个 Firefox 插件：[HttpFox](https://addons.mozilla.org/en-US/firefox/addon/6647)。

# c - 零长度数组与指针

> ID：627364
> 
> 赞同：22
> 
> 时间：2009-03-09T18:02:04.290
> 
> 标签：c, arrays, pointers

编辑：显然其中一些是不允许的/在各种 C 标准中已经改变。为了我自己的假设利益，让我们假设我们正在使用`gcc test.c`没有标准或警告选项。

特别是，我正在研究引擎盖下的细节。我已经添加了我目前的理解。我对吗？

```
char **c1;   //Size for a pointer is allocated on the stack. sizeof(c1) == sizeof(void*)
char *c2[0]; //Nothing is allocated on the stack.  sizeof(c2) == 0 
```

我不知道的这两种情况之间是否还有其他区别（除了sizeof）？

```
struct a {
   int i;
   char c[0]; //sizeof(a) is sizeof(int)?  a.c == (&i)+1?
}; 
```

据我了解，这通常用于结构末尾的可变长度数组。但是关于

```
struct b {
   char *c[0] //sizeof(b) is 0?  where does c point?
};

int j;
struct b myb; //myb.c == (&j)+1 == $esp? 
```

此外，如果它的指针空间从未在任何地方分配，如何知道零长度数组的地址？我想与已知常规数组地址的方式相同，但目前我正在努力解决它。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-09T18:18:13.020

我见过的唯一一次实际使用的零长度数组是当你想要一个可变长度结构时。

如本例所示，取自[此处](http://gcc.gnu.org/onlinedocs/gcc-4.1.2/gcc/Zero-Length.html)

```
 struct line {
       int length;
       char contents[0];
     };

     struct line *thisline = (struct line *)
       malloc (sizeof (struct line) + this_length);
     thisline->length = this_length; 
```

您不想在上述结构中使用指针，因为您希望内容成为结构分配内存的一部分。

如果您对上述结构执行 sizeof，则它不包含任何内容空间。我不确定这是否会成为标准，它会在各种编译器上发出警告。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-09T18:16:10.343

ISO C 禁止`0`-length 数组。

```
char **c1; 
```

这定义了一个`c1`指针到指针到字符类型的对象。

```
char *c2[0]; 
```

这是一个编译错误。不允许。不在 C 中，不在 C++ 中。

```
struct a {
  int i;
  char c[0]; //sizeof(a) is sizeof(int)?  a.c == (&i)+1?
}; 
```

如前所述的错误——数组的大小必须大于零。

```
 struct a {
  int i;
  char c[1]; 
}; 
```

也称为*struct-hack*。在几乎所有操作系统（Linux、Windows）上的低级代码中都被滥用。

C99 确实为我们提供了一个无大小的数组，更好地称为灵活数组成员：

```
struct a {
  int i;
  char c[]; /* note: no size */ 
}; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-12-23T20:03:33.790

您可能会从[GCC 文档](http://gcc.gnu.org/onlinedocs/gcc-4.1.2/gcc/Zero-Length.html)中得到一些答案。但这侧重于将零长度数组作为结构的最后成员的主题。它没有给出关于 sizeof 的直接答案。

（正如其他人已经明确指出的，零长度数组不在标准 C 中，但它们在 GNU C 中。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-09T18:36:19.670

从 C99 标准 (7.20.3) 开始，处理分配函数：

> 每个这样的分配都应产生一个指向与任何其他对象不相交的对象的指针。
> 
> [...]
> 
> 如果请求的空间大小为零，则行为由实现定义：要么返回空指针，要么行为好像大小是某个非零值，但返回的指针不应用于访问对象。

换句话说，如果在`b`没有初始化程序的情况下在堆栈上声明（其中`b`is`c`声明为`c[]`而不是`c[0]`），实际`b`使用的空间的实际大小将 > 0，因为您无法访问`b`. 如果它是通过 分配的`malloc`，它将作为`0`或作为某些无法访问的唯一值返回（如果您使用`sizeof(b)`）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-03-06T16:57:55.143

数组的大小不能为零。

```
ISO 9899:2011 6.7.6.2:

If the expression is a constant expression, it shall have a value greater than zero. 
```

上述文本对于普通数组（§1）和 VLA（§5）都是正确的。这是 C 标准中的规范性文本。不允许编译器以不同的方式实现它。

gcc -std=c99 -pedantic 对此给出警告。

# excel - 如何在 Excel 中自动创建命名引用？我希望每一行的第一个字段作为我的参考

> ID：627377
> 
> 赞同：0
> 
> 时间：2009-03-09T18:05:31.053
> 
> 标签：excel, excel-2007

我的电子表格的第一列是唯一键（数据方面，与 excel 无关）。我的另一列包含指向其他行的链接（指向该行的唯一键）。当我插入这些超链接时，我需要指向“定义的名称”，因为行顺序会随着时间而改变。

我不想每次插入新行时都必须创建定义的名称。有没有办法自动将列的文本定义为“定义的名称”？

我希望这很清楚。

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T00:42:08.323

您应该查看[Workbook.Names](http://msdn.microsoft.com/en-us/library/microsoft.office.tools.excel.workbook.names(VS.80).aspx)或[Worksheet.Names](http://msdn.microsoft.com/en-us/library/microsoft.office.tools.excel.worksheet.names(VS.80).aspx)（如果您希望将定义的名称限制为工作表）。

上面链接中显示的示例非常好。在您的情况下，您可能希望使用在单元格中找到的 Range.Value 或 Range.Text 用作作为 Names.Add() 方法的“名称”参数传入的字符串。

使用 VBA 可能看起来像这样：

```
ThisWorkbook.Names.Add _
    Name:=Sheet1.Range("A1").Text, _
    RefersTo:=Sheet1.Range("A:A"), _
    Visible:=True 
```

上面将列 A 的定义名称设置为在标题单元格 A1 中找到的值（文本）。

希望这可以帮助！

麦克风

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T16:40:08.833

知道了。Mike R. 让我走上了正轨。谢谢。

请注意需要删除名称的非字母数字字符。此外，复制名称只会覆盖旧的引用。

```
Private Sub Worksheet_Change(ByVal Target As Range)
    If (Target.Column = 1 And Target.Text <> "" And Target.Cells.Count = 1) Then
        ThisWorkbook.Names.Add _
            Name:=StripChar(Target.Text), _
            RefersTo:=Target, _
            Visible:=True
    End If
End Sub

Function StripChar(s As String) As String
    With CreateObject("vbscript.regexp")
        .Global = True
        .ignorecase = True
        .Pattern = "[^\dA-Z]"
        StripChar = .Replace(s, "")
    End With
End Function 
```

# asp.net - UpdatePanel asyncpostback 后页面丢失标题

> ID：627378
> 
> 赞同：15
> 
> 时间：2009-03-09T18:05:34.143
> 
> 标签：asp.net, asp.net-ajax, master-pages

我最近刚刚注意到，在我从主页内部执行异步回发后，我的页面标题将重置为标准的“无标题页面” `UpdatePanel`。在从母版页内部回发期间，标题不会丢失（例如，当我单击母版页内的搜索框按钮时）。

我假设通过使用不同的`contentplaceholder`专门设置文档标题我会避免这样的问题，但显然我错了。除了必须在 ASPX 页面的代码隐藏中明确设置标题（我希望通过下面的设置方式避免这种情况）之外，我还缺少其他什么吗？

这是我的页面的基本要点，它调用了母版页（下面的母版页代码）

```
<asp:Content ID="Content1" ContentPlaceHolderID="title" Runat="Server">
    Page Title
</asp:Content>
<asp:Content ID="Content2" ContentPlaceHolderID="head" Runat="Server">
    <script type="text/javascript">
        //random javascript validators
    </script>   
</asp:Content>
<asp:Content ID="Content3" ContentPlaceHolderID="content" Runat="Server">
    <div class="title">
        Account Management
    </div>
    <asp:UpdatePanel ID="UpdatePanel1" runat="server">
        <ContentTemplate>
            //Username + Password Set Form
        </ContentTemplate>       
    </asp:UpdatePanel>

</asp:Content> 
```

这是母版页。`<form>`ASP.NET AJAX ScriptManager 放在正文中标记之后的第一件事。

```
<head id="Head1" runat="server">
    <title>
        <asp:ContentPlaceHolder id="title" runat="server">
        </asp:ContentPlaceHolder>
    </title>
        //Stylesheet references

    <script type="text/javascript">
        //Random javascript functions
    </script>

    <asp:ContentPlaceHolder id="head" runat="server">
    </asp:ContentPlaceHolder>
</head> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-09T18:25:27.637

我们在我们的一个网站上遇到了这个确切的问题。

立即修复是在母版页代码隐藏 page_load 方法中重置标题。

显然，当发生 ajax 调用时，它正在重新运行母版页。这导致我们的标题消失了。

例如：

```
protected void Page_Load(object sender, EventArgs e) {
    this.Page.Title = "whatever title you have...";
} 
```

更好的解决方法是放弃 MS updatepanel 废话并开始使用 JSON / jQuery，您实际上可以对调用进行一些不错的控制。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-09T18:27:17.773

您反对使用 Content Page 的 Title 属性吗？

```
<%@ Page Title="Your Page Title" Language="vb" AutoEventWireup="false" MasterPageFile="~/MasterPages/... 
```

您还可以在页面加载中以编程方式访问它...

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-02-19T11:31:33.123

如果您删除标题标签中的空格，可以解决一个奇怪的错误，例如：

```
<title><asp:ContentPlaceHolder id="title" runat="server"></asp:ContentPlaceHolder></title> 
```

在 Sharepoint 2010 上测试

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-08-16T10:01:38.823

与其更改服务器端代码，不如直接在 JS 中修复它：

```
$(function(){
    var prm = Sys.WebForms.PageRequestManager.getInstance();
    if (!(prm)) return;
    document.orginalTitle=document.title;
    prm.add_endRequest(function(s, e){
        if (document.title.replace(/\s/g,"").length==0)
            document.title=document.orginalTitle;
        });
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-06-01T09:05:49.093

当您以编程方式设置标题并且仅当不是 PostBack 时才会发生这种情况。只需重写保存/加载回发方法以将标题保存在视图状态包中。

```
 protected override void LoadViewState(object savedState)
    {
        object[] allStates = (object[])savedState;
        if (allStates[0] != null)
            base.LoadViewState(allStates[0]);
        if (allStates[1] != null)
            Page.Title = (string)allStates[1];
    }

    protected override object SaveViewState()
    {
        object[] allStates = new object[2];
        object baseState = base.SaveViewState();
        string pageTitle = Page.Title;
        allStates[0] = baseState;
        allStates[1] = pageTitle;
        return allStates;
    } 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-12-09T23:33:28.980

您可以将页面标题放在 Viewstate 中，然后在按钮回发 Click 事件中获取字符串并将其分配给 Page.Title

```
 public string MyPageTitle
    {
        get
        {
            return (string)ViewState["MyPageTitle"];
        }
        set
        {
            ViewState["MyPageTitle"] = value;
        }
    } 
```

在页面加载时分配：MyPageTitle = "My Cool Web Page Title"; 然后在按钮单击事件中：

```
protected void MyLinkButton_Click(object sender, EventArgs e)
    {

       Page.Title = MyPageTitle;

    } 
```

# sql - 有没有办法在 SQL 中按日期的一部分进行选择？

> ID：627379
> 
> 赞同：0
> 
> 时间：2009-03-09T18:05:36.747
> 
> 标签：sql, mysql

我在 MySQL 表中有一个 datetime 列，我想选择具有相同年、月和日（但可能不同的小时和分钟）的记录。在其他情况下，我会选择具有相同年份和月份的那些。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-09T18:10:15.957

最快的方法是使用`BETWEEN`，例如：

```
SELECT fields FROM table WHERE
datecolumn BETWEEN '2001-01-01 00:00:00' AND '2001-12-31 23:59:59'; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-09T18:09:05.757

您可以使用一些[MySQL 日期和时间函数](http://dev.mysql.com/doc/refman/5.0/en/date-and-time-functions.html#function_date)来提取/比较您感兴趣的日期部分。

```
SELECT * FROM table WHERE DATE(datetime1) = DATE(datetime2);

SELECT * FROM table WHERE YEAR(datetime1) = YEAR(datetime2) AND MONTH(datetime1) = MONTH(datetime2)

etc 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T18:08:15.057

我以前在 SQL Server 中看到过以这种方式完成的日期转换（不确定这是否适用于 MySQL）：

```
select convert(varchar(10), getdate(), 120) 
```

（这只是如何将日期转换为 YYYY-MM-DD 的示例）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T18:08:55.693

有诸如 year() 和 hour() 之类的[函数](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html)可以为您执行此操作。

```
 select * from users where year(lastlogin) = year(now()) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-09T18:09:35.147

```
SELECT
  foo
FROM
  FooTable
WHERE
  DATEADD(dd, 0, DATEDIFF(dd, 0, TheDate)) = DATEADD(dd, 0, DATEDIFF(dd, 0, @SomeDate)) 
```

这：`DATEADD(dd, 0, DATEDIFF(dd, 0, TheDate))`

*   计算与日期 0 的日期（以天为单位）差异
*   将结果（以天为单位）添加到日期 0

`DATETIME`有效地将值的时间部分设置为`00:00:00`，而无需进行字符串转换等。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-09T18:12:17.607

我知道我要离开时间，但概念是一样的......假设日期时间是这样的：2009 年 12 月 25 日

```
SELECT * FROM table
WHERE SUBSTRING(datetime, 6, 4) = targetYear
AND SUBSTRING(datetime, 0, 2) = targetMonth 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-09T18:12:55.280

是的，您想在您的选择中使用以下[日期函数之一](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html)

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-03-10T04:26:38.207

你也可以做

`SELECT * FROM table WHERE datetime LIKE '2008-08-01%`'

或者

```
SELECT * FROM table WHERE datetime LIKE '2007-05%' 
```

# lisp - 解决斐波那契的 lisp 方法

> ID：627382
> 
> 赞同：11
> 
> 时间：2009-03-09T18:06:10.553
> 
> 标签：lisp, common-lisp, fibonacci

我想尝试学习 Lisp，但很快就放弃了。我想我会再试一次。我正在研究[欧拉计划中的问题 2——](http://projecteuler.net/index.php?section=problems&id=2)找出所有低于 400 万的偶数斐波那契数的总和。

我编写了以下代码，它可以工作，但很丑陋。其中最主要的是它非常慢 - 因为它一直在进行天真的递归。

当我用 Python 编写这个程序时，我在计算并且从不重新计算数字时建立了一个列表。我知道我可以在这里（以某种方式）做到这一点，但这似乎不符合 lisp 和函数式编程的精神。我在 #3 之后放弃了，当我达到递归深度限制并且不得不重写我的代码以使用循环而不是递归时。

所以我想我的问题是：

1.  解决这个问题的“正确、笨拙的方式”是什么？
2.  你如何协调递归和“计算一切”的概念与计算一切的实际限制？
3.  除了 The Little Schemer 和 Project Euler 之外，还有什么学习 lisp 的建议吗？

这是我的代码：

```
 (defun fib(i)
   (if (= i 1)                   ;Could rewrite this as a case statement
     1
     (if (= i 2)
       1
       (+ (fib (- i 1)) (fib (- i 2))))))

 (defun solve(i)
   (let ((f (fib i)))            ;Store result in local variable
     (print f)                   ;For debugging
     (if (< 4000000 f)
       0                         ;return
       (if (= 0 (mod f 2))
         (+ f (solve (+ i 1)))   ;add number
         (solve (+ i 1))))))     ;don't

 (print (solve 1)) 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-09T18:15:28.910

[http://fare.tunes.org/files/fun/fibonacci.lisp](http://fare.tunes.org/files/fun/fibonacci.lisp)有一个解决斐波那契的演练，逐步提高实现的时间和内存性能。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-09T19:48:07.423

[记忆](http://en.wikipedia.org/wiki/Memoization)是一种将结果缓存到函数的方法，以避免一遍又一遍地重新计算中间结果。记忆化基本上意味着你第一次用一些参数调用一个函数，计算答案并返回它，然后缓存那个答案；对于具有相同参数的函数的后续调用，只需返回缓存值。

在 Lisp 中，您可以轻松地使用高阶函数和宏来透明地记忆函数。Clojure 具有`memoize`包含的标准功能。[另请参阅 On Lisp](http://www.paulgraham.com/onlisptext.html)的第 65 页，了解`memoize`. 这是在 Clojure 中：

```
(defn fib-naive [i]
  (if (or (= i 1) (= i 2))
    1
    (+ (fib-naive (- i 1)) (fib-naive (- i 2)))))

(def fib-memo
     (memoize (fn [i]
                (if (or (= i 1) (= i 2))
                  1
                  (+ (fib-memo (- i 1)) (fib-memo (- i 2)))))))

user> (time (fib-naive 30))
"Elapsed time: 455.857987 msecs"
832040
user> (time (fib-memo 30))
"Elapsed time: 0.415264 msecs"
832040
user> 
```

如果您在一个大整数上调用它，这仍然会导致堆栈溢出。例如，立即做`(fib 10000)`会破坏堆栈，因为它仍然必须非常深入地递归（一次）。但是，如果您先启动缓存，则不再需要深度递归，并且可以避免这种情况。只需先执行此操作（在 Clojure 中）：

```
(dorun (map fib-memo (range 1 10000))) 
```

就足以让你`(fib 10000)`没有问题。

（计算斐波那契数的具体主题最近出现在[Clojure 邮件列表](http://groups.google.com/group/clojure/browse_frm/thread/57a12f1a0dab5e1b/e191d200c80667c6?lnk=gst&q=fibonacci#e191d200c80667c6)上。那里有一个基于[卢卡斯数](http://en.wikipedia.org/wiki/Lucas_number)的解决方案，我一点也不了解，但据说比简单算法快 40 倍。）

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-09T18:14:43.810

使用[尾递归](http://en.wikipedia.org/wiki/Tail_recursion)而不是朴素递归。大多数 Lisp 实现应该执行尾调用优化；不再有递归深度限制。

除此之外，试着从列表和可以在这些列表上执行的抽象操作的角度来思考问题。要考虑的两个更相关的操作：

*   [筛选](http://en.wikipedia.org/wiki/Filter_(higher-order_function) "关于“过滤器”高阶函数的维基百科")
*   [折叠](http://en.wikipedia.org/wiki/Fold_(higher-order_function) "关于“折叠”高阶函数的维基百科")

关于其他 Lisp 资源：

*   Common Lisp——[关于 Lisp](http://www.paulgraham.com/onlisp.html)
*   Scheme——[计算机程序的结构和解释](http://mitpress.mit.edu/sicp/full-text/book/book.html)

更新：尾递归方案`fib`功能：

```
(define (fib n)
  (fib-tr n 1 0))

(define (fib-tr n next result)
  (cond ((= n 0) result)
        (else (fib-tr (- n 1) (+ next result) next)))) 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-09T20:57:04.713

```
(let ((a 1) (b 1))
  (flet ((nextfib ()
           (prog1 a
             (psetf a b b (+ a b)))))
    (loop for fib = (nextfib)
          while (<= fib 4000000)
          when (evenp fib)
            sum fib))) 
```

Above defines a function NEXTFIB which will generate the next fibonacci number for each call. The LOOP sums the even results upto the limit of 4000000.

PROG1 returns the value of the first of its subexpressions. PSETF sets a and b in 'parallel'.

That's a common pattern. There is a generator function and one calls it repeatedly, filters the results and combines them.

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-09T18:20:10.550

解决这个问题的方法是自下而上地工作，一个接一个地生成每个斐波那契项，如果它是偶数，则将其添加到总和中，并在达到 400 万阈值时停止。我的 LISP 生锈了，所以这里是伪代码：

```
one_prior = 1
two_prior = 1
curr = 2
sum = 0
while curr < 4000000000
  if curr % 2 == 0
    sum = sum + curr
  two_prior = one_prior
  one_prior = curr
  curr = one_prior + two_prior 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-09T20:45:11.543

danio 的回答将极大地帮助解决性能问题。

这是对您的风格的简短评论：

```
 (defun fib(i)
   (if (= i 1) ;//Could rewrite this as a case statement
     1
     (if (= i 2)
       1
       (+ (fib (- i 1)) (fib (- i 2)))
     )
   )
 ) 
```

将嵌套的 IF 重构为 COND。

不要将括号单独放在一行中。

```
(defun 解决(i)
   (let ((f (fib i))) ;//将结果存入局部变量
     (print f) ;//用于调试
     （如果 （

使用 ZEROP 更清晰。

```
         (+ f (solve (+ i 1))) ;//加数
         (solve (+ i 1)) ;//不要

```

你为什么把那些//放进去？分号后跟一个空格就足够了。

       )
     )
   )
 )
 （打印（解决1））

```

你最后的 PRINT 声明让我有点怀疑。你是从文件还是从 REPL 运行这个程序？如果你做前者，那么你应该考虑做后者。如果你做后者，你可以说 (solve 1) 得到结果。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-17T13:58:23.997

**除了所有有用的答案之外，以下公式可能会提供更高的效率**——以 O(Log(n)) 而不是 O(2^n) 计算 Fn。这必须与记忆相结合，并且是解决问题的坚实基础：

```
F(2*n) = F(n)^2 + F(n-1)^2

F(2*n + 1) = ( 2*F(n-1) + F(n) )   *   F(n) 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-09T19:50:21.083

为了扩展 Danio 的答案，http://fare.tunes.org/files/fun/fibonacci.lisp 上的文章[介绍](http://fare.tunes.org/files/fun/fibonacci.lisp)了两种使代码运行得更快的方法。使用直接递归（尾调用或否）是 O(2^n) 并且非常慢。困难在于每个值都被一遍又一遍地计算。你必须以不同的方式做事。这两个建议是：

1.  使用迭代方法。

> ```
> (defun bubble-fib (n)
>   (declare (optimize (speed 3) (safety 0) (debug 0)))
>   (check-type n fixnum)
>   (loop repeat n
>   with p = 0 with q = 1
>   do (psetq p q
>         q (+ p q))
>   finally (return p))) 
> ```

2.  使用记忆。这意味着记住之前看到的值并重新调用它们，而不是重新计算它们。这篇文章提供了一个 CL 包来做这件事，以及一些代码来自己做。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-09T19:54:18.157

我对“lisp 精神”的理解是让自己摆脱任何固定的、教条主义的、自大的 lisp 精神观念，并使用最能反映解决问题所需的计算结构的 lisp 结构。例如，

```
(defun euler2 (&optional (n 4000000))
  (do ((i 1 j)
       (j 2 (+ i j))
       (k 0))
      ((<= n i) k)
    (when (evenp i) (incf k i)))) 
```

如果你坚持递归，这里有另一种方式：

```
(defun euler2 (&optional (n 4000000))
  (labels ((fn (i j k) 
             (if (<= n i) k (fn j (+ i j) (if (oddp i) k (+ k i))))))
    (fn 1 2 0))) 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-18T20:28:04.183

创建斐波那契数列的简单有效的方法：

```
(defun fibs (n &optional (a 1) (b 1))
  (loop repeat n 
        collect (shiftf a b (+ a b))))
```

(shiftf) 取任意数量的位置，最后取一个值。每个位置都设置为下一个变量的值，最后一个变量取其后的值。它返回第一个位置的值。换句话说，它将所有值左移一。

但是，您不需要完整列表（您只需要偶数）并且您根本不需要列表（您只需要总和），因此可以直接将其用于函数。每三个斐波那契数都是偶数，所以...

```
(defun euler-2 (limit &optional (a 1) (b 1))
  (loop for x upfrom 1
        until (> a limit)
        if (zerop (mod x 3)) 
           sum a
        do (shiftf a b (+ a b))))
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-11T14:30:09.260

```
(defun fib (x &optional (y 0) (z 1))
           (if (< x z)
               nil
               (append (list z) (fib x z (+ y z)))))

CL-USER> (reduce #'+ (remove-if-not #'evenp (fib 1000000))) 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-09T18:41:53.837

查看位于以下位置的视频和文本：[http ://groups.csail.mit.edu/mac/classes/6.001/abelson-sussman-lectures/](http://groups.csail.mit.edu/mac/classes/6.001/abelson-sussman-lectures/)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-03-01T06:26:45.730

这是一个记忆版本。在这种情况下，由于您必须计算每个斐波那契数，直到找到超过 400 万个数，所以使用封闭形式的解决方案没有多大用处。

`let`这种方法通过;创建了一个词法环境。在该环境中创建字典`fib-table` 和函数。`fib-memoed`最终产品`fib-table`可以从其他地方访问，`fib-memoed`但无法从其他地方访问。

现在是踢球者：因为我们必须计算`fib`顺序值直到满足某些条件，所以我们从 开始求解器`fib 1`。从这里开始，计算下一个 fib 数字最多需要 2 次字典查找和一个加法：`O(1)`BOOM！

```
;; memoised fib function: make a hash table, then create                                      
;; the fib function in the lexical scope of the hash table                                    
(let ((fib-table (make-hash-table)))
  (setf (gethash 0 fib-table) 1)
  (setf (gethash 1 fib-table) 1)
  (defun fib-memoed (n)
    (let ((x (gethash n fib-table)))
      (cond ((not (null x))
             x)
            (t
             (let ((y (+ (fib-memoed (- n 1))
                         (fib-memoed (- n 2)))))
               (setf (gethash n fib-table) y)
               y))))))

(defun solve ()
  (let ((maxval 4000000))
    (labels ((aux (i acc)
               (let ((x (fib-memoed i)))
                 (cond ((> x maxval) acc)
                       ((evenp x)
                        (aux (1+ i) (+ x acc)))
                       (t (aux (1+ i) acc))))))
      (aux 1 0)))) 
```

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2019-02-27T09:30:05.430

;;; 我尝试按照@PESTO 的建议编写代码

(defun Fibo-Test (n / one_prior two_prior curr sum i)

(setq i 2) (setq one_prior 1 two_prior 1 )

（条件

((= n 0) (setq sum 0) )

((= n 1) (setq sum 1) )

((= n 2) (setq sum 1) )

（T

(while (and (< in) (< sum (* 4 1e6)))

;;; 转换为实数

(setq sum (+ (float one_prior) (float two_prior)))

(setq i (1+ i))

(setq 当前总和) (setq
one_prior two_prior two_prior curr
)

) ; 结束时

) ; 结束条件(T)

) ; 结束条件

(princ (strcat "\nF(" (itoa i) ") = " (RTOS sum) " . "))

（原则）

) ; 结束函数 Fibo-Test

# java - 定位复杂 Bean 中的序列化问题

> ID：627389
> 
> 赞同：0
> 
> 时间：2009-03-09T18:08:09.957
> 
> 标签：java, serialization

我有一个正在尝试序列化的大型 bean 图。获取序列化异常（非特定异常）。任何人都可以帮助找到问题的课程？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-09T18:16:21.137

在 JDK6 中，您应该能够通过设置 sun.io.serialization.extendedDebugInfo 系统属性来获取额外信息：

```
-Dsun.io.serialization.extendedDebugInfo=true 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T18:10:52.943

编写一个或多个单元测试来序列化部分图或整个图。这会让你把问题分解成更小的部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T18:28:51.153

您可以使用一个特殊的输出流来执行一些额外的检查。请参阅[此页面](http://crazybob.org/2007/02/debugging-serialization.html)作为参考。

# .net - 以安全的方式向页面传递参数

> ID：627395
> 
> 赞同：0
> 
> 时间：2009-03-09T18:09:29.733
> 
> 标签：.net, security

您好我想知道在 .NET 2.0 中在页面之间传输参数的最佳方式是什么？我不能允许用户修改这些参数，所以我在考虑使用 Session 变量。这是一种安全的方法吗？有没有办法让用户修改它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T18:11:31.587

用户不能修改您存储在 Session[] 中的变量。

但是您仍然应该注意其他会话攻击，例如会话固定和会话劫持。ASP.Net 抽象了很多这种安全性并为您处理它，但知道它仍然很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T18:15:22.013

您也可以将其存储在 ViewState 中并将 enableViewStateMAC 设置为 true。如果有人篡改了视图状态数据，视图状态验证将失败。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T18:12:22.333

为了保证 100% 的安全，它应该保存在服务器上。会话是一个不错的选择（也是数据库，但它需要更多资源-> 性能较低）。
虽然我说 100%，但这取决于你如何实现它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T18:12:37.700

用户无法在不欺骗您的应用程序为他们修改的情况下修改会话状态。因此，为了在响应之间保持用户信息的安全，这是一个不错的起点。

[但是不要认为会话状态是完全安全的......](http://www.owasp.org/index.php/2.0_Session_State_(in)security_(and_the_dangers_of_State_Server))

# language-agnostic - 计算页面浏览量

> ID：627408
> 
> 赞同：2
> 
> 时间：2009-03-09T18:10:33.100
> 
> 标签：language-agnostic

我有一个网站，我想记录一个条目获得了多少独特的视图。目前我将每个视图存储在一个表中（见下文），但我不禁觉得这太重了。

```
+--------+---------------+
| postid |  remote_addr  |
+--------+---------------+
|   1    |  192.168.0.0  |
|   2    |  127.0.0.1    |
+--------+---------------+ 
```

显然，除了页面的其余内容之外，这需要每页至少有一个查询，那么有没有更简单/更轻松的方法呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T18:19:31.317

我强烈建议您使用[Google Analytics](http://www.google.com/analytics/)或任何其他类似工具，它可以为您提供非常好的报告和有关访问者的详细统计信息。独特访问、网站停留时间、回访者等。

它也很容易安装，您只需添加一些您在该站点上获得的 JavaScript 代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T18:11:56.890

这里有一些很好的信息：

[计算忽略搜索引擎的页面的浏览量？](https://stackoverflow.com/questions/45824/counting-number-of-views-for-a-page-ignoring-search-engines)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-09T18:13:12.767

这是你可以从你的网络日志中得到的东西吗？如果是这样，您只需获取日志解析器并过滤您的页面和唯一访问者即可。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-09T18:18:43.223

这是我过去尝试做的事情，并放弃了让我的日志分析器做它擅长的事情。当我这样做时，我使用了您描述的技术。它并没有产生太多开销，但我确实必须编写我自己的所有逻辑来报告和过滤机器人……不好玩。

我还要指出，仅存储 IP 地址并不能保证您记录的是唯一性。您的访问者来自代理服务器的情况并不少见（尤其是我在过去几年注意到的 AOL）。

# c# - 如何克服 Active Directory 搜索中的后期绑定

> ID：627428
> 
> 赞同：1
> 
> 时间：2009-03-09T18:14:51.577
> 
> 标签：c#, active-directory

我有一个函数可以根据用户名和域检索用户的全名。此函数在模拟用户下的 ASP.NET 线程中运行。当我在远程 AD 分支上使用目录搜索器时，我相信我得到的是 SID 号而不是属性（无法验证它是否出现在不同的盒子上）。

```
public string GetUserFullName(string userName, string domainName)
{  
    DirectoryEntry rootEntry = new DirectoryEntry("GC://dc=company,dc=net");
    string filter = string.Format("(&(objectCategory=person)(objectClass=user)(!(userAccountControl:1.2.840.113556.1.4.803:=2))(userPrincipalName={0}@{1}.company.net))", userName, domainName);
    DirectorySearcher searcher = new DirectorySearcher(rootEntry, filter, new string[] { "displayName" });
    rootEntry.AuthenticationType = AuthenticationTypes.Secure;
    searcher.PageSize = 1000;
    searcher.ServerTimeLimit = new TimeSpan(0, 10, 0);
    searcher.ReferralChasing = ReferralChasingOption.All;
    searcher.Asynchronous = false;

    SearchResult result = searcher.FindOne();
    if (result != null)
    {
        return (string) result.Properties["displayName"][0];
    }
    else
    {
        throw new Exception("Active Directory could not resolve your user name");
    }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T20:38:33.900

您正在使用哪个版本的 .NET 框架？AD 的东西在 .NET 3.5 中得到了相当广泛的改进，现在为用户和组提供了强类型的构造以及类似的东西。

查看我的好友 Joe Kaplan 和 Ethan Wilansky 在 MSDN 上撰写的优秀文章“[在 .NET Framework 3.5 中管理目录安全主体”。](http://msdn.microsoft.com/en-us/magazine/cc135979.aspx)确实很棒的东西。

首先，您会得到一个名为 UserPrincipal 的强类型类，例如，所有基本属性都是对象的属性。确实很有帮助。

其次，您可以使用 PrincipalSearcher 获得一个不错的“示例查询”方法 - 查看 Joe 和 Ethan 文章中的这个示例：

```
// create a principal object representation to describe
// what will be searched 
UserPrincipal user = new UserPrincipal(adPrincipalContext);

// define the properties of the search (this can use wildcards)
user.Enabled = false;
user.Name = "user*";

// create a principal searcher for running a search operation
PrincipalSearcher pS = new PrincipalSearcher();

// assign the query filter property for the principal object 
// you created
// you can also pass the user principal in the 
// PrincipalSearcher constructor
pS.QueryFilter = user;

// run the query
PrincipalSearchResult<Principal> results = pS.FindAll();

Console.WriteLine("Disabled accounts starting with a name of 'user':");
foreach (Principal result in results)
{
    Console.WriteLine("name: {0}", result.Name);
} 
```

如果有任何机会，请尝试使用 .NET 3.5 获取您的 AD 内容！

马克

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T18:31:34.860

我已经将 AD 打包成一个方便的帮助程序库，并且一直使用这种方法：

```
 /// <summary>
    /// Returns AD information for a specified userID.
    /// </summary>
    /// <param name="ntID"></param>
    /// <returns></returns>
    public ADUser GetUser(string ntID)
    {          
        DirectorySearcher search = new DirectorySearcher();        

        search.Filter = String.Format("(cn={0})", ntID);

        search.PropertiesToLoad.Add("mail");
        search.PropertiesToLoad.Add("givenName");
        search.PropertiesToLoad.Add("sn");
        search.PropertiesToLoad.Add("displayName");
        search.PropertiesToLoad.Add("userPrincipalName");
        search.PropertiesToLoad.Add("cn");

        SearchResult result = search.FindOne();

        return new ADUser(result);
    } 
```

ADUser 是一个将 SearchResult 映射到强类型属性的自定义类。

我不确定您的具体问题是什么，但这一直对我有用。

**编辑：**比较我们的代码，我看到你没有告诉搜索预加载属性......这可能是你的问题。

# python - 如何按索引从列表中删除元素

> ID：627435
> 
> 赞同：1951
> 
> 时间：2009-03-09T18:16:11.060
> 
> 标签：python, list, indexing

如何在 Python 中按索引从列表中删除元素？

我找到了`list.remove`方法，但是说我想删除最后一个元素，我该怎么做？似乎默认删除搜索列表，但我不希望执行任何搜索。

* * *

## 回答 #1

> 赞同：2223
> 
> 时间：2009-03-09T18:21:24.400

使用`del`并指定要删除的元素的索引：

```
>>> a = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
>>> del a[-1]
>>> a
[0, 1, 2, 3, 4, 5, 6, 7, 8] 
```

还支持切片：

```
>>> del a[2:4]
>>> a
[0, 1, 4, 5, 6, 7, 8, 9] 
```

[这](http://docs.python.org/tutorial/datastructures.html#the-del-statement)是教程中的部分。

* * *

## 回答 #2

> 赞同：805
> 
> 时间：2009-03-09T18:17:48.233

你可能想要`pop`：

```
a = ['a', 'b', 'c', 'd']
a.pop(1)

# now a is ['a', 'c', 'd'] 
```

默认情况下，`pop`不带任何参数会删除最后一项：

```
a = ['a', 'b', 'c', 'd']
a.pop()

# now a is ['a', 'b', 'c'] 
```

* * *

## 回答 #3

> 赞同：173
> 
> 时间：2014-06-22T15:21:00.613

像其他人提到的 pop 和 del 是删除给定索引项*的*有效方法。然而只是为了完成（因为在 Python 中可以通过多种方式完成同样的事情）：

**使用切片（这不会从原始列表中删除项目）：**

（这也是使用 Python 列表时效率最低的方法，但在使用不支持 pop 但定义 a 的用户定义对象时，这可能很有用（但效率不高，我重申`__getitem__`）：

```
>>> a = [1, 2, 3, 4, 5, 6]
>>> index = 3 # Only positive index

>>> a = a[:index] + a[index+1 :]
# a is now [1, 2, 3, 5, 6] 
```

**注意：**请注意，此方法不会像`pop`和那样修改列表`del`。相反，它制作了两个列表副本（一个从开始到索引但没有它（`a[:index]`），一个在索引之后直到最后一个元素（`a[index+1:]`）），并通过添加两者来创建一个新的列表对象。然后将其重新分配给列表变量 ( `a`)。旧的列表对象因此被取消引用并因此被垃圾收集（假设原始列表对象没有被除 a 之外的任何变量引用）。

这使得这种方法效率非常低，并且还会产生不良的副作用（尤其是当其他变量指向未修改的原始列表对象时）。

感谢@MarkDickinson 指出这一点......

[这个](https://stackoverflow.com/a/509295/3244627)Stack Overflow 答案解释了切片的概念。

另请注意，这只适用于正指数。

在与对象一起使用时，`__getitem__`必须定义方法，更重要的是，**`__add__`**必须定义方法以返回包含两个操作数中的项目的对象。

本质上，这适用于类定义如下的任何对象：

```
class foo(object):
    def __init__(self, items):
        self.items = items

    def __getitem__(self, index):
        return foo(self.items[index])

    def __add__(self, right):
        return foo( self.items + right.items ) 
```

这适用于`list`哪些定义`__getitem__`和`__add__`方法。

**三种方式在效率方面的比较：**

假设以下是预定义的：

```
a = range(10)
index = 3 
```

**`del object[index]`方法：**

迄今为止最有效的方法。它适用于定义方法的所有对象`__del__`。

拆解如下：

代码：

```
def del_method():
    global a
    global index
    del a[index] 
```

拆卸：

```
 10    0 LOAD_GLOBAL     0 (a)
       3 LOAD_GLOBAL     1 (index)
       6 DELETE_SUBSCR   # This is the line that deletes the item
       7 LOAD_CONST      0 (None)
      10 RETURN_VALUE
None 
```

**`pop`方法：**

它比 del 方法效率低，在需要获取已删除项时使用。

代码：

```
def pop_method():
    global a
    global index
    a.pop(index) 
```

拆卸：

```
 17     0 LOAD_GLOBAL     0 (a)
        3 LOAD_ATTR       1 (pop)
        6 LOAD_GLOBAL     2 (index)
        9 CALL_FUNCTION   1
       12 POP_TOP
       13 LOAD_CONST      0 (None)
       16 RETURN_VALUE 
```

**切片和添加方法。**

效率最低的。

代码：

```
def slice_method():
    global a
    global index
    a = a[:index] + a[index+1:] 
```

拆卸：

```
 24     0 LOAD_GLOBAL    0 (a)
        3 LOAD_GLOBAL    1 (index)
        6 SLICE+2
        7 LOAD_GLOBAL    0 (a)
       10 LOAD_GLOBAL    1 (index)
       13 LOAD_CONST     1 (1)
       16 BINARY_ADD
       17 SLICE+1
       18 BINARY_ADD
       19 STORE_GLOBAL   0 (a)
       22 LOAD_CONST     0 (None)
       25 RETURN_VALUE
None 
```

注意：在所有三个反汇编中，忽略最后两行基本上是`return None`. 此外，前两行正在加载全局值`a`和`index`.

* * *

## 回答 #4

> 赞同：59
> 
> 时间：2013-10-19T13:10:02.877

[`pop`](https://docs.python.org/library/stdtypes.html#mutable-sequence-types)对于从列表中删除和保留项目也很有用。在哪里`del`实际丢弃该项目。

```
>>> x = [1, 2, 3, 4]

>>> p = x.pop(1)
>>> p
    2 
```

* * *

## 回答 #5

> 赞同：46
> 
> 时间：2018-07-24T02:38:14.260

如果要删除列表中特定位置的元素，例如第 2、第 3 和第 7 个元素，则不能使用

```
del my_list[2]
del my_list[3]
del my_list[7] 
```

由于删除第二个元素后，您删除的第三个元素实际上是原始列表中的第四个元素。您可以过滤原始列表中的第 2、第 3 和第 7 个元素并得到一个新列表，如下所示：

```
new_list = [j for i, j in enumerate(my_list) if i not in [2, 3, 7]] 
```

* * *

## 回答 #6

> 赞同：31
> 
> 时间：2019-08-20T13:13:03.670

已经提到如何从列表中删除单个元素以及不同方法具有哪些优点。但是请注意，删除**多个**元素可能会出错：

```
>>> l = [0,1,2,3,4,5,6,7,8,9]
>>> indices=[3,7]
>>> for i in indices:
...     del l[i]
... 
>>> l
[0, 1, 2, 4, 5, 6, 7, 9] 
```

原始列表的元素 3 和 8（不是 3 和 7）已被删除（因为列表在循环期间被缩短），这可能不是本意。如果你想安全地删除多个索引，你应该先删除索引最高的元素，例如：

```
>>> l = [0,1,2,3,4,5,6,7,8,9]
>>> indices=[3,7]
>>> for i in sorted(indices, reverse=True):
...     del l[i]
... 
>>> l
[0, 1, 2, 4, 5, 6, 8, 9] 
```

* * *

## 回答 #7

> 赞同：22
> 
> 时间：2017-06-04T11:05:12.903

使用[`del`](https://docs.python.org/3/tutorial/datastructures.html#the-del-statement)语句：

```
del listName[-N] 
```

例如，如果要删除最后 3 项，您的代码应为：

```
del listName[-3:] 
```

例如，如果要删除最后 8 项，您的代码应为：

```
del listName[-8:] 
```

* * *

## 回答 #8

> 赞同：21
> 
> 时间：2017-08-11T00:17:13.620

这取决于你想做什么。

如果要返回已删除的元素，请使用`pop()`：

```
>>> l = [1, 2, 3, 4, 5]
>>> l.pop(2)
3
>>> l
[1, 2, 4, 5] 
```

但是，如果您只想删除一个元素，请使用`del`：

```
>>> l = [1, 2, 3, 4, 5]
>>> del l[2]
>>> l
[1, 2, 4, 5] 
```

此外，`del`允许您使用切片（例如`del[2:]`）。

* * *

## 回答 #9

> 赞同：20
> 
> 时间：2015-10-05T12:23:32.047

一般来说，我使用以下方法：

```
>>> myList = [10,20,30,40,50]
>>> rmovIndxNo = 3
>>> del myList[rmovIndxNo]
>>> myList
[10, 20, 30, 50] 
```

* * *

## 回答 #10

> 赞同：19
> 
> 时间：2017-10-30T09:21:31.850

另一种按索引从列表中删除元素的方法。

```
a = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]

# remove the element at index 3
a[3:4] = []
# a is now [0, 1, 2, 4, 5, 6, 7, 8, 9]

# remove the elements from index 3 to index 6
a[3:7] = []
# a is now [0, 1, 2, 7, 8, 9] 
```

a[x:y] 指向从 index`x`到的元素`y-1`。当我们将列表的该部分声明为空列表 ( `[]`) 时，这些元素将被删除。

* * *

## 回答 #11

> 赞同：14
> 
> 时间：2017-02-15T13:09:53.250

您可以只搜索要删除的项目。这真的很简单。例子：

```
 letters = ["a", "b", "c", "d", "e"]
    letters.remove(letters[1])
    print(*letters) # Used with a * to make it unpack you don't have to (Python 3.x or newer) 
```

输出：acde

* * *

## 回答 #12

> 赞同：11
> 
> 时间：2017-05-14T13:29:14.453

使用以下代码从列表中删除元素：

```
list = [1, 2, 3, 4]
list.remove(1)
print(list)

output = [2, 3, 4] 
```

如果要从列表中删除索引元素数据，请使用：

```
list = [1, 2, 3, 4]
list.remove(list[2])
print(list)
output : [1, 2, 4] 
```

* * *

## 回答 #13

> 赞同：10
> 
> 时间：2016-06-28T03:15:54.550

如前所述，最佳实践是 del(); 或 pop() 如果您需要知道该值。

另一种解决方案是仅重新堆叠您想要的那些元素：

```
 a = ['a', 'b', 'c', 'd'] 

    def remove_element(list_,index_):
        clipboard = []
        for i in range(len(list_)):
            if i is not index_:
                clipboard.append(list_[i])
        return clipboard

    print(remove_element(a,2))

    >> ['a', 'b', 'd'] 
```

eta：嗯...不适用于负索引值，将思考和更新

我想

```
if index_<0:index_=len(list_)+index_ 
```

会修补它......但突然间这个想法似乎很脆弱。不过有趣的思想实验。似乎应该有一种“正确”的方式来使用 append() / 列表理解来做到这一点。

*琢磨*

* * *

## 回答 #14

> 赞同：10
> 
> 时间：2017-09-25T16:46:31.047

**l** - 值列表；我们必须从**inds2rem**列表中删除索引。

```
l = range(20)
inds2rem = [2,5,1,7]
map(lambda x: l.pop(x), sorted(inds2rem, key = lambda x:-x))

>>> l
[0, 3, 4, 6, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19] 
```

* * *

## 回答 #15

> 赞同：9
> 
> 时间：2016-12-27T14:29:51.257

听起来您不是在处理列表列表，所以我会保持简短。你想使用 pop 因为它会删除元素而不是列表元素，你应该使用 del 。要调用python中的最后一个元素，它是“-1”

```
>>> test = ['item1', 'item2']
>>> test.pop(-1)
'item2'
>>> test
['item1'] 
```

* * *

## 回答 #16

> 赞同：7
> 
> 时间：2018-09-23T06:13:08.727

或者如果应该删除多个索引：

```
print([v for i,v in enumerate(your_list) if i not in list_of_unwanted_indexes]) 
```

当然也可以这样做：

```
print([v for i,v in enumerate(your_list) if i != unwanted_index]) 
```

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2016-02-01T03:00:01.150

可以使用 del 或 pop，但我更喜欢 del，因为您可以指定索引和切片，从而使用户可以更好地控制数据。

例如，从显示的列表开始，可以`del`使用切片删除其最后一个元素，然后可以使用 删除结果中的最后一个元素`pop`。

```
>>> l = [1,2,3,4,5]
>>> del l[-1:]
>>> l
[1, 2, 3, 4]
>>> l.pop(-1)
4
>>> l
[1, 2, 3] 
```

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2016-12-13T04:59:14.353

您可以使用 del 或 pop 根据索引从列表中删除元素。Pop 将打印它正在从列表中删除的成员，而列表删除该成员而不打印它。

```
>>> a=[1,2,3,4,5]
>>> del a[1]
>>> a
[1, 3, 4, 5]
>>> a.pop(1)
 3
>>> a
[1, 4, 5]
>>> 
```

# c# - 您可以在 Dictionary 集合或其他类型的集合中拥有 2 个以上的项目吗？

> ID：627442
> 
> 赞同：3
> 
> 时间：2009-03-09T18:17:55.237
> 
> 标签：c#, collections

我怀疑这是可能的，但我很好奇字典中是否可以有超过 2 个项目（键、值）。也许是一个键和 2 个值。是否有允许这样做的集合对象？我实际上想要做的是存储一个键和一个键的值以及另一个值来保存找到该键的次数。例如，我可能有一个遍历颜色列表的 for 循环，并且每种颜色都有一个唯一的值。当我浏览列表时，我不仅想将颜色、颜色的唯一值存储在字典中，还想存储红色在列表中出现的次数。

我放入了以下声明，现在我想弄清楚如何测试它是否已经包含该值，如果不包含，则将其添加到计数为 1 的列表中，如果包含，则增加计数. 在我发布声明后，我将只用一本字典发布我是如何做到的。

```
Dictionary<string, Dictionary<int,int>> colors = 
                          new Dictionary<string, Dictionary<int,int>>(); 
```

这是我之前如何处理它的代码：

```
Dictionary<string, int> colors = new Dictionary<string, int>();

 foreach (Color color in ColorList)
        {
            if (colors.ContainsKey(color.ToString()))
                colors[color]++;
            else
                colors.Add(color, 1);
        } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-09T18:28:57.877

您可以创建一个简单的 Tuple 类，例如 Triple。它本质上是一个通用键控字典，但包含一个附加对象。这种情况很常见，人们制作了将其扩展为 4 到 10 个对象的库。这是一个例子：

```
 public struct Triple<X, Y, Z>
    {
        public X First;     
        public Y Second;    
        public Z Third;     

        public Triple(X x, Y y, Z z)
        {
            First = x;
            Second = y;
            Third = z;
        }
    } 
```

然后像这样使用它：

```
 var myTriple =  new Triple<string, Color, int>(
                        "key", 
                        myColor, 
                        count
                    ) 
```

,

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-09T18:22:00.517

你能不能有一个结构字典来跟踪颜色和它发生的次数？

编辑：正如其他地方所建议的，这也可以通过构建您自己的小型自定义类来完成。基本上将以相同的方式工作。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-09T18:26:13.610

好吧，一种方法是：

```
Dictionary<key, KeyValuePair<value, int>> 
```

如果我理解你的问题。

* * *

编辑：

实际上，如果颜色和值是一致的——意味着“红色”总是 3 或 19 或任何你用作红色值的值，那么名称“红色”和值，比如 19，实际上只是一个复合键和所以你可以做这样的事情：

```
Dictionary<KeyValuePair<string, int>, int> mydict; 
```

然后为更新做这样的事情：

```
mydict[key] = mydict[key] + 1; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-09T18:22:46.050

您可以为此使用两个字典，或者简单地创建一个同时具有颜色和计数的数据类，并将中间类实例存储在字典中。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-03-24T13:24:54.713

从 C# 4.0 开始，有**Tuple**类，它提供了用于创建元组对象的静态方法。

请参阅：http: [//msdn.microsoft.com/en-us/library/system.tuple.aspx](http://msdn.microsoft.com/en-us/library/system.tuple.aspx)

```
// Create a 7-tuple. 
var population = new Tuple<string, int, int, int, int, int, int>(
                           "New York", 7891957, 7781984, 
                           7894862, 7071639, 7322564, 8008278);
// Display the first and last elements.
Console.WriteLine("Population of {0} in 2000: {1:N0}",
                  population.Item1, population.Item7);
// The example displays the following output: 
//       Population of New York in 2000: 8,008,278 
//       Population of New York in 2000: 8,008,278 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-09T18:23:26.393

您正在寻找 MultiMap。

我写了以下内容（未完全测试）：

```
 using System.Collections.Generic;

public class MultiMapSet<TKey, TValue>
{
    private readonly Dictionary<TKey, HashSet<TValue>> _ht = new Dictionary<TKey, HashSet<TValue>>();

    public void Add(TKey key, TValue value)
    {
        HashSet<TValue> valueSet;
        if (_ht.TryGetValue(key, out valueSet))
        {
            valueSet.Add(value);
        }
        else
        {
            valueSet = new HashSet<TValue> { value };
            _ht.Add(key, valueSet);
        }
    }

    public bool HasValue(TKey key, TValue value)
    {
        HashSet<TValue> valueSet;
        if (_ht.TryGetValue(key, out valueSet))
        {
            return valueSet.Contains(value);
        }
        return false;
    }

    public HashSet<TValue> GetValues(TKey key)
    {
        HashSet<TValue> valueSet;
        _ht.TryGetValue(key, out valueSet);
        return valueSet;
    }

    public void Remove(TKey key, TValue value)
    {
        HashSet<TValue> valueSet;
        if (!_ht.TryGetValue(key, out valueSet))
        {
            return;
        }

        if (valueSet.Contains(value))
        {
            valueSet.Remove(value);
        }
    }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-09T18:37:37.873

你能做类似的事情吗

```
Dictonary<string,string> dh = new dictonary<string,string>();

dh.add("x","Something:0");

foreach keyvaluepair kvp in dh
{

    if kvp.key == x
    {
        string[] hold= kvp.value.split(':');
        //to update it the count it would be something like

        int y = convert.toint(hold[1])+1;
        kvp.value=hold[0]+":"+y.tostring();

     }

} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-09T18:38:17.590

这些答案中的大多数都说几乎相同（正确）的事情。只需将您的“外部”字典的值设置为您认为对执行所需操作最有用的某种对象。就个人而言，没有考虑它，我会带着一本字典去。

```
Dictionary<key1, Dictionary<key2, value>> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-08-22T09:04:27.193

字典> KeyValuePair = 新字典>();

KeyValuePair.Add("LoadType", new List { "PassiveLoad", "SocketLoad" });

# api - 如何组织API？

> ID：627446
> 
> 赞同：3
> 
> 时间：2009-03-09T18:18:53.487
> 
> 标签：api, architecture

我正在设计一个 API，我希望它易于使用。所以，如果我有客户、报表和付款。拥有以下对象是否有意义：Customer、CustomerHandler、Statement、StatementHandler、Payment、PaymentHandler？这样，当开发人员想对客户做某事时，他/她知道创建一个 CustomerHandler，然后所有可能希望对客户执行的功能都在处理程序中。

方法如：

*   客户处理程序：

    *   添加客户（客户）
    *   获取客户（客户 ID）
    *   获取客户计数（）
*   语句处理程序：

    *   添加声明（客户 ID）
    *   获取语​​句（语句 ID）
    *   GetStatementCount(客户 ID)
*   付款处理程序：

    *   GetPaymentsByCustomer(customerID)
    *   获取付款（付款ID）
    *   GetPaymentCountByCustomer(customerID)

这样，如果开发人员想要接收付款，他/她就知道要去 PaymentHandler。我的同事认为像 GetPayments(customerID) 这样的函数属于管理客户的类。所以，它就像 Customer.GetPayments() AS Payments。但是如果我有一些其他实体，比如 Worker，就会有 Worker.GetPayments() AS Payments。所以，我看到了这两种方法的逻辑。第一个将事物组合在一起，以便无论付款来自谁，您都可以通过 GetPaymentsByCustomer(CustomerID) 和 GetPaymentsByWorker(WorkerID) 等函数从一个类中获取所有款项。这样一来，人们就不必偶然发现不同的处理程序或管理器对象来获得付款。这两种方法对我来说都有意义，你呢？或者，我们都离开了，还有更好的方法吗？提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T18:35:11.200

如果您正在设计 API，那么也许您可以尝试从目标用户的角度编写一些模型。实施一些用例，即使只是在白板上，看看哪种方法更有价值。

在您的付款示例中，Worker 和 Customer 都可以实现 Payable 接口。如果您后来必须添加一个可以“付费”的对象，您只需让它实现相同的接口。如果您有一个支付处理程序并且需要添加一种可以支付的新类型的东西，您将不得不通过添加一个新方法来更改处理程序。我想随着时间的推移，这可能会变得很麻烦。您当然可以将两者结合使用，并使用一个处理程序实用程序作为您的支付系统的前端。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T18:36:53.863

您几乎描述了两种数据访问方式（模式）：

*   活动记录 - [http://martinfowler.com/eaaCatalog/activeRecord.html](http://martinfowler.com/eaaCatalog/activeRecord.html)
*   数据映射器 - [http://martinfowler.com/eaaCatalog/dataMapper.html](http://martinfowler.com/eaaCatalog/dataMapper.html)

请阅读 Martin Fowler 的《[企业应用程序架构模式》](https://rads.stackoverflow.com/amzn/click/com/0321127420)一书，并阅读所有优点和缺点。特别是如果您尝试将对象和 API 公开为 Web 服务，您可能希望使用数据映射器方法（如您所建议的那样）。

活动记录非常流行，因为它更简单。自己决定什么最适合您的需求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T18:25:19.710

在“它属于哪里”的辩论中，我通常根据它返回的东西来决定它属于哪里。如果您有一个返回付款对象列表的 GetPayments() 方法，它应该在 PaymentHandler 上。

这确实是一件非常主观的事情，但是通过返回类型来确保创建 Payment 对象的所有内容都将在 PaymentHandler 中，在 CustomerHandler 中的 Customer 对象等。

当您稍后需要进行更改时，这可以稍微简化一些事情，并且正如您所提到的，您的 API 用户可以很容易地确定他们需要调用哪个处理程序 - 如果他们需要客户，他们将使用 CustomerHandler .

如果您有一个像 GetPayments(customerId, workerId) 这样的假设方法可以为客户和工人获得付款，它也可以消除混淆。使用您的同事的建议，由于涉及付款、客户和工人，尚不清楚该方法将走向何方。按返回类型进行分类几乎总是很清楚，因为函数只返回一件事。

# asp.net-mvc - ASP.Net MVC - 关联对象的下拉列表

> ID：627447
> 
> 赞同：3
> 
> 时间：2009-03-09T18:19:12.237
> 
> 标签：asp.net-mvc, drop-down-menu

我的应用程序中有两个模型：`Product`和`ProductType`. `Product`有一个引用`ProductType`（在它被命名的数据库中`ProductTypeId`），同时`ProductType`有两列（`Id`和`Name`）。

我可以使用以下代码正确填充下拉列表并在论坛上显示：

### 控制器：

```
var typeList = new SelectList(_entities.ProductType.ToList(), "Id", "Name");
ViewData["Types"] = typeList; 
```

### 看法：

```
<%= Html.DropDownList("ProductType", (IEnumerable<SelectListItem>) ViewData["Types"]) %> 
```

但是我的问题是它没有更新控制器中的模型。如果我将代码保持原样，则 ModelState 由于`ProductType`视图中的字符串而无效，但是，如果我将其更改为其他任何内容，似乎我无法再在控制器中引用它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T08:23:29.360

我只是尝试了同样的事情，它对我来说很好

控制器：

```
 public ActionResult Create()
    {
    configuratorDataContext dc = new configuratorDataContext();
    SelectList typelist = new SelectList(dc.Product_types.ToList(), "id", "Name");
    ViewData["Product_Types"] = typelist;
    ViewData.Model = new Product(); 
    return View();
    } 

    [AcceptVerbs(HttpVerbs.Post)]
    public ActionResult Create(Product createProduct)
    {
    // createProduct here contains correct type_id wich 
    } 
```

看法：

```
 <%= Html.DropDownList("type_id", (IEnumerable<SelectListItem>) ViewData["Product_Types"])%> 
```

# zend-framework - Zend Framework：奇怪的 url 重写行为

> ID：627460
> 
> 赞同：3
> 
> 时间：2009-03-09T18:23:20.123
> 
> 标签：zend-framework, mod-rewrite, routing

我的 Zend Framework 应用程序出现了奇怪的行为。

我运行这个 url，希望让索引控制器运行 1234567890 动作。

```
http://hello.com/index/1234567890?test=http%3A%2F%2Fworld.com%2Findex.php 
```

但是我得到这样的例外：

```
Message: Invalid controller specified (4567890) 
```

奇怪的是，页面上的所有 URL 现在都链接到：

```
http://hello.com/index.php/index/1234567890 
```

代替：

```
http://hello.com/index/1234567890 
```

请注意，错误注入到 URL 中的 index.php 字符串有 9 个字符，它与截断**index/123** 4567890 字符串的数字相同，以获取错误的控制器名称。

另一件事是注入的 index.php 与示例中的 url 编码获取参数中的 index.php 相关。

怎么了？它是 Zend 中的错误吗？还是我做错了什么？

这是我的 .htaccess：

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} -s [OR]
RewriteCond %{REQUEST_FILENAME} -l [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^.*$ - [NC,L]
RewriteRule ^.*$ /index.php [NC,L] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-17T21:52:06.567

你没有在你试图调试这个的方式上投入太多，所以我徘徊到我自己的本地主机并给你的 url 一个镜头。低，我的做同样的事情，我尝试了两种不同的 modrewrite 方法：

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule .* index.php 
```

和

```
RewriteCond %{REQUEST_FILENAME} -s [OR]
RewriteCond %{REQUEST_FILENAME} -l [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^.*$ - [NC,L]
RewriteRule ^.*$ /index.php [NC,L] 
```

他们俩都在做同样的事情。在花了相当长的时间处理 url 并查看了我的错误页面上的请求参数后，我所能想到的要么是 Zend Framework 中的默认路由模式存在重大故障，要么使用您的 modrewrite 在 url 中发送请求的文件名。

所以我将我的主 index.php 文件更改为 main.php 并分别在我的 modrewrite 中，它工作正常，仔细检查在 url 中有 main.php 不会弄乱它，它不会。

因此，尽管没有做出任何承诺，但如果您将 index.php（被写入并包含您的引导程序）重命名为 main.php 或任何您喜欢的名称，并在您的 modrewrite 中反映出来，您应该一切就绪！

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T18:25:29.803

[`MultiViews`](http://httpd.apache.org/docs/2.2/content-negotiation.html#multiviews)可能导致此行为。尝试禁用它：

```
Options -MultiViews 
```

# c# - 我如何测试素数？

> ID：627463
> 
> 赞同：14
> 
> 时间：2009-03-09T18:24:07.030
> 
> 标签：c#, math, primes

我正在编写一个带有一些素数相关方法的小库。由于我已经完成了基础工作（又名工作方法），现在我正在寻找一些优化。当然，互联网是这样做的好地方。然而，我偶然发现了一个舍入问题，我想知道如何解决这个问题。

在循环中，我用来测试一个数字的素数，搜索直到 sqrt(n) 而不是 n/2 甚至 n - 1 更有效。但是由于舍入问题，一些数字被跳过，因此一些素数被跳过！例如，第 10000 个素数应为：104729，但“优化”版本最终为：103811。

一些代码（我知道它可以进行更多优化，但我一次只能处理一件事）：

```
/// <summary>
/// Method for testing the primality of a number e.g.: return IsPrime(29);
/// History:
/// 1\. Initial version, most basic form of testing: m smaller then n -1
/// 2\. Implemented m smaller then sqrt(n), optimization due to prime factoring
/// </summary>
/// <param name="test">Number to be tested on primality</param>
/// <returns>True if the number is prime, false otherwise</returns>
public static bool IsPrime(int test)
{
    // 0 and 1 are not prime numbers
    if (test == 0 || test == 1) return false;

    // 2 and 3 are prime numbers
    if (test == 2) return true;

    // all even numbers, save 2, are not prime
    if (test % 2 == 0) return false;

    double squared = Math.Sqrt(test);
    int flooredAndSquared = Convert.ToInt32(Math.Floor(squared));

    // start with 5, make increments of 2, even numbers do not need to be tested
    for (int idx = 3; idx < flooredAndSquared; idx++)
    {
        if (test % idx == 0)
        {
            return false;
        }
    }
    return true;
} 
```

I know the squared part fails me (or I fail), tried Math.Ceiling as well, with about the same results.

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-09T18:32:38.960

I guess this is your problem:

```
for (int idx = 3; idx < flooredAndSquared; idx++) 
```

This should be

```
for (int idx = 3; idx <= flooredAndSquared; idx++) 
```

so you don't get square numbers as primes. Also, you can use "idx += 2" instead of "idx++" because you only have to test odd numbers (as you wrote in the comment directly above...).

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-09T19:33:19.610

I don't know if this is quite what you are looking for but if you are really concerned about speed then you should look into probablistic methods for testing primality rather than using a sieve. [Rabin-Miller](http://mathworld.wolfram.com/Rabin-MillerStrongPseudoprimeTest.html) is a probabilistic primality test used by Mathematica.

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-10T10:50:24.477

Sadly, I haven't tried the algorithmic approaches before. But if you want to implement your approach efficiently, I'd suggest doing some caching. Create an array to store all prime numbers less than a defined threshold, fill this array, and search within/using it.

In the following example, finding whether a number is prime is O(1) in the best case (namely, when the number is less than or equal to `maxPrime`, which is 821,461 for a 64K buffer), and is somewhat optimized for other cases (by checking mod over only 64K numbers out of the first 820,000 -- about 8%).

(Note: Don't take this answer as the "optimal" approach. It's more of an example on how to optimize your implementation.)

```
public static class PrimeChecker
{
    private const int BufferSize = 64 * 1024; // 64K * sizeof(int) == 256 KB

    private static int[] primes;
    public static int MaxPrime { get; private set; }

    public static bool IsPrime(int value)
    {
        if (value <= MaxPrime)
        {
            return Array.BinarySearch(primes, value) >= 0;
        }
        else
        {
            return IsPrime(value, primes.Length) && IsLargerPrime(value);
        }
    }

    static PrimeChecker()
    {
        primes = new int[BufferSize];
        primes[0] = 2;
        for (int i = 1, x = 3; i < primes.Length; x += 2)
        {
            if (IsPrime(x, i))
                primes[i++] = x;
        }
        MaxPrime = primes[primes.Length - 1];
    }

    private static bool IsPrime(int value, int primesLength)
    {
        for (int i = 0; i < primesLength; ++i)
        {
            if (value % primes[i] == 0)
                return false;
        }
        return true;
    }

    private static bool IsLargerPrime(int value)
    {
        int max = (int)Math.Sqrt(value);
        for (int i = MaxPrime + 2; i <= max; i += 2)
        {
            if (value % i == 0)
                return false;
        }
        return true;
    }
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-09T19:01:20.810

I posted a class that uses the sieve or Eratosthenes to calculate prime numbers here:

[Is the size of an array constrained by the upper limit of int (2147483647)?](https://stackoverflow.com/questions/573692/is-the-size-of-an-array-constrained-by-the-upper-limit-of-int-2147483647/573770#573770)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-10T09:52:07.113

As Mark said, the Miller-Rabin test is actually a very good way to go. An additional reference (with pseudo-code) is the [Wikipedia article](http://en.wikipedia.org/wiki/Miller%E2%80%93Rabin_primality_test) about it.

It should be noted that while it is probabilistic, by testing just a very small number of cases, you can determine whether a number is prime for numbers in the int (and nearly long) range. See [this part of that Wikipedia article](http://en.wikipedia.org/wiki/Miller%E2%80%93Rabin_primality_test#Deterministic_variants_of_the_test), or [the Primality Proving reference](http://primes.utm.edu/prove/prove2_3.html) for more details.

I would also recommend reading [this article](http://en.wikipedia.org/wiki/Modular_exponentiation) on modular exponentiation, as otherwise you're going to be dealing with very very large numbers when trying to do the Miller-Rabin test...

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-09T21:36:09.613

You might want to look into [Fermat's little theorem](http://en.wikipedia.org/wiki/Fermat%27s_little_theorem).

Here is the pseudo code from the book [Algorithms by S. Dasgupta, C.H. Papadimitriou, and U.V. Vazirani](http://cseweb.ucsd.edu/~dasgupta/book/), where n is the number you are testing for primality.

```
Pick a positive integer a < n at random
if a^n-1 is equivalent to 1 (mod n)
   return yes
else
   return no 
```

Implementing Fermat's theorem should be faster then the sieve solution. However, there are Carmichael numbers that pass Fermat's test and are NOT prime. There are workarounds for this. I recommend consulting [Section 1.3 in the fore mentioned book](https://people.eecs.berkeley.edu/~vazirani/algorithms/chap1.pdf). It is all about primality testing and might be helpful for you.

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-09T18:32:23.907

Here is a halfway decent function I wrote to solve one of the Euler:

```
private static long IsPrime(long input)
{
    if ((input % 2) == 0)
    {
        return 2;
    }
    else if ((input == 1))
    {
        return 1;
    }
    else
    {
        long threshold = (Convert.ToInt64(Math.Sqrt(input)));
        long tryDivide = 3;
        while (tryDivide < threshold)
        {
            if ((input % tryDivide) == 0)
            {
                Console.WriteLine("Found a factor: " + tryDivide);
                return tryDivide;
            }
            tryDivide += 2;
        }
        Console.WriteLine("Found a factor: " + input);
        return -1;
    }
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-09T18:33:26.667

Try this...

```
if (testVal == 2) return true;
if (testVal % 2 == 0) return false;

for (int i = 3; i <= Math.Ceiling(Math.Sqrt(testVal)); i += 2)
{
   if (testVal % i == 0)
       return false;
}

return true; 
```

Ive used this quite a few times.. Not as fast as a sieve.. but it works.

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-11-14T03:36:39.130

First and foremost, primes start from 2\. 2 and 3 are primes. Prime should not be dividable by 2 or 3\. The rest of the primes are in the form of 6k-1 and 6k+1\. Note that you should check the numbers up to SQRT(input). This approach is very efficient. I hope it helps.

```
public class Prime {

    public static void main(String[] args) {
        System.out.format("%d is prime: %s.\n", 199, isPrime(199)); // Prime
        System.out.format("%d is prime: %s.\n", 198, isPrime(198)); // Not prime
        System.out.format("%d is prime: %s.\n", 104729, isPrime(104729)); // Prime
        System.out.format("%d is prime: %s.\n", 104727, isPrime(982443529)); // Prime
    }

    /**
     * Tells if a number is prime or not.
     *
     * @param input the input
     * @return If the input is prime or not
     */
    private boolean isPrime(long input) {
    if (input <= 1) return false; // Primes start from 2
    if (input <= 3) return true; // 2 and 3 are primes
    if (input % 2 == 0 || input % 3 == 0) return false; // Not prime if dividable by 2 or 3
    // The rest of the primes are in the shape of 6k-1 and 6k+1
    for (long i = 5; i <= Math.sqrt(input); i += 6) if (input % i == 0 || input % (i + 2) == 0) return false;
    return true;
    }

} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-07-19T01:24:49.737

Repeat mode operations will run very slowly. Use the eratosthenes grid to get the prime list in order.

```
/*
The Sieve Algorithm
http://en.wikipedia.org/wiki/Sieve_of_Eratosthenes
*/
numbers = new MyBitArray(limit, true);
for (long i = 2; i < limit; i++)
    if (numbers[i])
        for (long j = i * 2; j < limit; j += i)
            numbers[j] = false;
        }

public class MyBitArray: IDisposable
    {
        byte[] bytes;
        public MyBitArray(long limit, bool defaultValue = false)
        {
            long byteCount = (limit & 7) == 0 ? limit >> 3 : (limit >> 3) + 1;
            this.bytes = new byte[byteCount];
            for(long i = 0; i < byteCount; i++)
            {
                bytes[i] = (defaultValue == true ? (byte)0xFF : (byte)0x00);
            }
            this.limit = limit;
        }

        public MyBitArray(long limit, byte[] bytes)
        {
            this.limit = limit;
            this.bytes = bytes;
        }

        public bool this[long index]
        {
            get
            {
                return getValue(index);
            }
            set
            {
                setValue(index, value);
            }
        }

        bool getValue(long index)
        {
            if (index < 8)
            {
                return getBit(bytes[0], (byte)index);
            }

            long byteIndex = (index & 7) == 0 ? ((index >> 3) - 1) : index >> 3;
            byte bitIndex = (byte)(index & 7);
            return getBit(bytes[byteIndex], bitIndex);
        }
        void setValue(long index, bool value)
        {
            if (index < 8)
            {
                bytes[0] = setBit(bytes[0], (byte)index, value);
                return;
            }

            long byteIndex = (index & 7) == 0 ? (index >> 3) - 1 : index >> 3;
            byte bitIndex = (byte)(index & 7);

            bytes[byteIndex] = setBit(bytes[byteIndex], bitIndex, value);
        }

        bool getBit(byte byt, byte index)
        {
            return ((byt & (1 << index)) >> index) == 1;
        }

        byte setBit(byte byt, byte index, bool value)
        {
            return (byte)((byt & ~(1 << index)) + (value ? 1 << index : 0));
        }

        public void Dispose()
        {
            GC.Collect(2, GCCollectionMode.Optimized);
        }

        private long limit;
        public long Limit { get { return limit; } }
        public byte[] Bytes { get { return this.bytes; } } 
    } 
```

However, I would suggest you a much better method for prime number testing. For 64 bit numbers, no matter how large the number is, it gives the exact result in milliseconds.

```
public static bool IsPrime(ulong number)
{
    return number == 2 
        ? true 
        : (BigInterger.ModPow(2, number, number) == 2 
            ? (number & 1 != 0 && BinarySearchInA001567(number) == false) 
            : false)
}

public static bool BinarySearchInA001567(ulong number)
{
    // Is number in list?
    // todo: Binary Search in A001567 (https://oeis.org/A001567) below 2 ^ 64
    // Only 2.35 Gigabytes as a text file http://www.cecm.sfu.ca/Pseudoprimes/index-2-to-64.html
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-09T18:29:34.850

Try the [sieve of eratosthenes](http://en.wikipedia.org/wiki/Sieve_of_Eratosthenes) -- that should take out getting the root and floating point issues.

As for the `floor`, you will be better served by taking the `ceiling`.

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-09T22:02:49.283

```
private static bool IsPrime(int number) {
    if (number <= 3)
        return true;
    if ((number & 1) == 0)
        return false;
    int x = (int)Math.Sqrt(number) + 1;
    for (int i = 3; i < x; i += 2) {
        if ((number % i) == 0)
            return false;
    }
    return true;
} 
```

I can't get it any faster...

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-11-02T10:20:05.257

I thought [Prime numbers and primality testing](http://www.i-programmer.info/babbages-bag/432-prime-numbers.html) was useful and the AKS algorithm sounds interesting even if it isn't particularly practical compared to a probabily based tests.

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2015-11-10T09:49:23.753

This works very fast for testing primes (vb.net)

```
Dim rnd As New Random()
Const one = 1UL

    Function IsPrime(ByVal n As ULong) As Boolean
        If n Mod 3 = 0 OrElse n Mod 5 = 0 OrElse n Mod 7 = 0 OrElse n Mod 11 = 0 OrElse n Mod 13 = 0 OrElse n Mod 17 = 0 OrElse n Mod 19 = 0 OrElse n Mod 23 = 0 Then
           return false
        End If

        Dim s = n - one

        While s Mod 2 = 0
            s >>= one
        End While

        For i = 0 To 10 - 1
            Dim a = CULng(rnd.NextDouble * n + 1)
            Dim temp = s
            Dim m = Numerics.BigInteger.ModPow(a, s, n)

            While temp <> n - one AndAlso m <> one AndAlso m <> n - one
                m = (m * m) Mod n
                temp = temp * 2UL
            End While

            If m <> n - one AndAlso temp Mod 2 = 0 Then
                Return False
            End If
        Next i

        Return True
    End Function 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2017-12-26T09:06:18.357

In case anyone else is interested, here's my conversion of Mohammad's procedure above to VBA. I added a check to exclude 1, 0, and negative numbers as they are all defined as not prime.

I have only tested this in Excel VBA:

```
Function IsPrime(input_num As Long) As Boolean
    Dim i As Long
    If input_num < 2 Then '1, 0, and negative numbers are all defined as not prime.
        IsPrime = False: Exit Function
    ElseIf input_num = 2 Then
        IsPrime = True: Exit Function '2 is a prime
    ElseIf input_num = 3 Then
        IsPrime = True: Exit Function '3 is a prime.
    ElseIf input_num Mod 2 = 0 Then
        IsPrime = False: Exit Function 'divisible by 2, so not a prime.
    ElseIf input_num Mod 3 = 0 Then
        IsPrime = False: Exit Function 'divisible by 3, so not a prime.
    Else
        'from here on, we only need to check for factors where
        '6k ± 1 = square root of input_num:
        i = 5
        Do While i * i <= input_num
            If input_num Mod i = 0 Then
                IsPrime = False: Exit Function
            ElseIf input_num Mod (i + 2) = 0 Then
                IsPrime = False: Exit Function
            End If
            i = i + 6
        Loop
        IsPrime = True
    End If
End Function 
```

* * *

## 回答 #16

> 赞同：-3
> 
> 时间：2009-03-09T19:41:36.767

Your for loop should look like this:

```
for (int idx = 3; idx * idx <= test; idx++) { ... } 
```

That way, you avoid floating-point computation. Should run faster and it'll be more accurate. This is why the `for` statement conditional is simply a boolean expression: it makes things like this possible.

# c# - 扩展方法帮助

> ID：627478
> 
> 赞同：0
> 
> 时间：2009-03-09T18:28:31.437
> 
> 标签：c#, .net

我正在编写一个扩展方法，其中我碰巧需要扩展方法中需要扩展方法的字段名称。我不知道该怎么做。

## 我的代码：

* * *

### 扩展方法：

```
public static Validate Demand<T>(this T parameter)
{
    string name = ...
    var field = GetField(parameter);
    return Validation.CreateValidation(parameter, field, name);
} 
```

### 用例：

```
void SomeMethod(T someParameter)
{
   someParameter.Demand();
} 
```

我`name`想抱`someParameter`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T18:42:29.310

你不能。在某些情况下会很好，特别是对于参数检查，但这是不可能的。作为一个方便的例子，我有这个方法：

```
internal static void ThrowIfNull<T>(this T argument, string name)
    where T : class
{
    if (argument == null)
    {
        throw new ArgumentNullException(name);
    }
} 
```

我必须打电话给：

```
foo.ThrowIfNull("foo"); 
```

总比没有好，但不必提供“foo”位会很好。不幸的是，没有办法做到这一点。您可能可以编写一个构建后的 IL 重写器，它确定如何调用该方法并从中重建它，但我怀疑这比好处更多的工作:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T19:13:09.050

这是获得我认为您所要求的一种方法：

```
static class Argument
{
    public static void NotNull(Expression<Func<Func<object>>> arg)
    {
        if (arg.Compile()()() == null)
        {
            var body1 = (Expression<Func<object>>)arg.Body;
            var body2 = (MemberExpression)body1.Body;
            throw new ArgumentNullException(body2.Member.Name);
        }
    }
} 
```

像这样使用：

```
void F(string foo)
{
    Argument.NotNull(() => () => foo); 
```

这样做的好处是在 IDE中重命名`foo`将获得所有引用。（如果你有`foo`一个字符串，它会被错过。）

如果在紧密循环中使用它，可能会导致性能问题，因为它`.Compile()()`每次都会调用。您可以通过添加此重载来优化性能：

```
 public static void NotNull(object value, Expression<Func<Func<object>>> arg)
    {
        if (value == null)
        {
            var body1 = (Expression<Func<object>>)arg.Body;
            var body2 = (MemberExpression)body1.Body;
            throw new ArgumentNullException(body2.Member.Name);
        }
    } 
```

这是这样使用的：

```
Argument.NotNull(foo, () => () => foo); 
```

它仍然可以正确重命名，并在每次迭代时保存该调用。

我建议您在编写代码时使用第一个版本，然后在分析器下运行它，并在重要的情况下切换到第二个版本。

# wpf - 当组合框移动时，如何防止 WPF 组合框弹出窗口分离？

> ID：627491
> 
> 赞同：2
> 
> 时间：2009-03-09T18:33:54.323
> 
> 标签：wpf, xaml, animation, combobox

我有一个文本框堆叠在 ComboBox 的顶部。TextBox 在获得焦点时会变高（通过动画），而在失去焦点时会缩小。

当文本框失去对组合框的焦点时，问题就开始了。发生这种情况时，选择 Popup（“下拉”的部分）出现在 ComboBox 的正下方，正如预期的那样，但随着 ComboBox 开始向上移动（因为上面的 TextBox 现在正在缩小），选择 Popup 不会跟随，现在看起来与 ComboBox 分离。

这可能是因为选择 Popup（与所有 Popup 一样）与 TextBox 和 ComboBox 不属于同一可视树的一部分，因此它的布局不会随着动画的进行而重新计算。

如何保持我的 ComboBox 完整？

下面是一个片段，您可以将其粘贴到 XamlPad 中以重现此内容。任何帮助深表感谢！

```
<Page xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:sys="clr-namespace:System;assembly=mscorlib" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" >
  <StackPanel Width="100" Orientation="Vertical">
    <TextBox Height="19">
      <TextBox.Triggers>
        <EventTrigger RoutedEvent="UIElement.GotFocus">
          <EventTrigger.Actions>
            <BeginStoryboard>
              <Storyboard TargetProperty="Height">
                <DoubleAnimation From="19" To="100" Duration="0:0:0.2"/>
              </Storyboard>
            </BeginStoryboard>
          </EventTrigger.Actions>
        </EventTrigger>
        <EventTrigger RoutedEvent="UIElement.LostFocus">
          <EventTrigger.Actions>
            <BeginStoryboard>
              <Storyboard TargetProperty="Height">
                <DoubleAnimation From="100" To="19" Duration="0:0:0.2"/>
              </Storyboard>
            </BeginStoryboard>
          </EventTrigger.Actions>
        </EventTrigger>
      </TextBox.Triggers>
    </TextBox>
    <ComboBox>
      <ComboBoxItem>Item 1</ComboBoxItem>
      <ComboBoxItem>Item 2</ComboBoxItem>
    </ComboBox>
  </StackPanel>
</Page> 
```

这也已在 Microsoft Connect 站点上作为错误发布：

[https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=422254](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=422254)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-09T21:46:08.810

这是一个非常蹩脚的解决方法，但您可以使组合框的弹出窗口相对于文本框而不是组合框打开：

```
<Page xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:sys="clr-namespace:System;assembly=mscorlib" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <StackPanel Width="100" Orientation="Vertical">
        <TextBox x:Name="myTextBox" Height="19">
            <TextBox.Triggers>
                <EventTrigger RoutedEvent="UIElement.GotFocus">
                    <EventTrigger.Actions>
                        <BeginStoryboard>
                            <Storyboard TargetProperty="Height">
                                <DoubleAnimation Duration="0:0:0.2" From="19" To="100"/>
                            </Storyboard>
                        </BeginStoryboard>
                    </EventTrigger.Actions>
                </EventTrigger>
                <EventTrigger RoutedEvent="UIElement.LostFocus">
                    <EventTrigger.Actions>
                        <BeginStoryboard>
                            <Storyboard TargetProperty="Height">
                                <DoubleAnimation Duration="0:0:0.2" From="100" To="19"/>
                            </Storyboard>
                        </BeginStoryboard>
                    </EventTrigger.Actions>
                </EventTrigger>
            </TextBox.Triggers>
        </TextBox>
        <ComboBox>
            <ComboBox.Resources>
                <Style TargetType="{x:Type Popup}">
                    <Setter Property="PlacementTarget" Value="{Binding ElementName=myTextBox}"/>
                    <Setter Property="PlacementRectangle" Value="0,39,0,0"/>
                </Style>
            </ComboBox.Resources>
            <ComboBoxItem>Item 1</ComboBoxItem>
            <ComboBoxItem>Item 2</ComboBoxItem>
        </ComboBox>
    </StackPanel>
</Page> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T18:59:56.837

我不知道这里有解决方法。但是，我绝对会将其归类为错误，并将其提交到[Microsoft Connect](http://connect.microsoft.com/)站点。

# javascript - 定位元素，但确保它仍在屏幕上

> ID：627499
> 
> 赞同：1
> 
> 时间：2009-03-09T18:36:48.530
> 
> 标签：javascript, jquery

我有一个 jQuery UI 对话框，当用户单击按钮时会打开，我希望对话框出现在按钮附近。这并不难，例如：

```
var pos = $('#mybutton').offset();
$('#mydlg').dialog({
    // ...
    autoOpen: false,
    position: [pos.left, pos.top]
}); 
```

问题是当按钮位于屏幕的最右侧或屏幕的最底部时。新打开的对话框将导致窗口滚动，因为它离开屏幕。

如何计算位置以便对话框向左/向上打开，以便仅在这些情况下保持在屏幕上？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T19:10:20.057

```
 var pos = $('#mybutton').offset();

    //if dialog height/width are known

    var dialogTop = pos.Top;
    var dialogLeft = pos.left;

    if((dialogHeight + pos.top) > $(window).height())
    {
        dialogTop -= dialogHeight;
    }

    if((dialogWidth + pos.left) > $(window).width())
    {
        dialogLeft -= dialogWidth;
    }

    $('#mydlg').dialog({
        autoOpen: false,
        position: [dialogLeft, dialogTop]
    });

    //if the dialog height/width are unknown then move this to a function in the   dialog onLoad 
```

# python - 如何在装饰器中使用命名参数？

> ID：627501
> 
> 赞同：6
> 
> 时间：2009-03-09T18:37:20.573
> 
> 标签：python, language-features, decorator

如果我有以下功能：

```
 def intercept(func):
  # do something here

@intercept(arg1=20)
def whatever(arg1,arg2):
  # do something here 
```

我希望仅在**arg1**为 20 时才触发拦截。我希望能够将命名参数传递给函数。我怎么能做到这一点？

这是一个小代码示例：

```
 def intercept(func):
    def intercepting_func(*args,**kargs):
        print "whatever"
        return func(*args,**kargs)
    return intercepting_func

@intercept(a="g")
def test(a,b):
    print "test with %s %s" %(a,b)

test("g","d") 
```

**这会引发以下异常 TypeError: intercept() got an unexpected keyword argument 'a'**

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-09T22:38:50.990

请记住

```
@foo
def bar():
    pass 
```

相当于：

```
def bar():
    pass
bar = foo(bar) 
```

所以如果你这样做：

```
@foo(x=3)
def bar():
    pass 
```

这相当于：

```
def bar():
    pass
bar = foo(x=3)(bar) 
```

所以你的装饰器需要看起来像这样：

```
def foo(x=1):
    def wrap(f):
        def f_foo(*args, **kw):
            # do something to f
            return f(*args, **kw)
        return f_foo
    return wrap 
```

换句话说，`def wrap(f)`实际上是装饰器，并且`foo(x=3)`是一个返回装饰器的函数调用。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-09T18:43:30.823

```
from functools import wraps

def intercept(target,**trigger):
    def decorator(func):
        names = getattr(func,'_names',None)
        if names is None:
            code = func.func_code
            names = code.co_varnames[:code.co_argcount]
        @wraps(func)
        def decorated(*args,**kwargs):
            all_args = kwargs.copy()
            for n,v in zip(names,args):
                all_args[n] = v
            for k,v in trigger.iteritems():
                if k in all_args and all_args[k] != v:
                    break
            else:
                return target(all_args)
            return func(*args,**kwargs)
        decorated._names = names
        return decorated
    return decorator 
```

例子：

```
def interceptor1(kwargs):
    print 'Intercepted by #1!'

def interceptor2(kwargs):
    print 'Intercepted by #2!'

def interceptor3(kwargs):
    print 'Intercepted by #3!'

@intercept(interceptor1,arg1=20,arg2=5) # if arg1 == 20 and arg2 == 5
@intercept(interceptor2,arg1=20)        # elif arg1 == 20
@intercept(interceptor3,arg2=5)         # elif arg2 == 5
def foo(arg1,arg2):
    return arg1+arg2

>>> foo(3,4)
7
>>> foo(20,4)
Intercepted by #2!
>>> foo(3,5)
Intercepted by #3!
>>> foo(20,5)
Intercepted by #1!
>>> 
```

`functools.wraps`做 wiki 上的“简单装饰器”所做的事情；更新`__doc__`，`__name__`以及装饰器的其他属性。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-09T18:45:26.217

您可以通过在装饰器中使用 *args 和 **kwargs 来做到这一点：

```
def intercept(func, *dargs, **dkwargs):
    def intercepting_func(*args, **kwargs):
        if (<some condition on dargs, dkwargs, args and kwargs>):
            print 'I intercepted you.'
        return func(*args, **kwargs)
    return intercepting_func 
```

由你决定如何传递参数来控制装饰器的行为。

为了使这对最终用户尽可能透明，您可以使用[Python wiki](http://wiki.python.org/moin/PythonDecoratorLibrary)上的“简单装饰器”或 Michele Simionato 的[“装饰器装饰器”](http://www.phyast.pitt.edu/~micheles/python/documentation.html#id9)

# c# - 在 C# 中递归复制内容的最佳方法是什么？

> ID：627504
> 
> 赞同：16
> 
> 时间：2009-03-09T18:38:19.820
> 
> 标签：c#, asp.net, recursion

使用 C# 和 ASP.NET 将文件夹内容递归复制到另一个文件夹的最佳方法是什么？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-03-09T18:43:10.557

那么你可以试试这个

```
DirectoryInfo sourcedinfo = new DirectoryInfo(@"E:\source");
DirectoryInfo destinfo = new DirectoryInfo(@"E:\destination");
copy.CopyAll(sourcedinfo, destinfo); 
```

这是完成所有工作的方法：

```
public void CopyAll(DirectoryInfo source, DirectoryInfo target)
{
    try
    {
        //check if the target directory exists
        if (Directory.Exists(target.FullName) == false)
        {
            Directory.CreateDirectory(target.FullName);
        }

        //copy all the files into the new directory

        foreach (FileInfo fi in source.GetFiles())
        {
            fi.CopyTo(Path.Combine(target.ToString(), fi.Name), true);
        }

        //copy all the sub directories using recursion

        foreach (DirectoryInfo diSourceDir in source.GetDirectories())
        {
            DirectoryInfo nextTargetDir = target.CreateSubdirectory(diSourceDir.Name);
            CopyAll(diSourceDir, nextTargetDir);
        }
        //success here
    }
    catch (IOException ie)
    {
        //handle it here
    }
} 
```

我希望这个能帮上忙 ：）

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-03-09T18:43:32.930

只是`Microsoft.VisualBasic.FileIO.FileSystem.CopyDirectory`在`Microsoft.VisualBasic.dll`组装中使用。

添加对的引用`Microsoft.VisualBasic`

```
Microsoft.VisualBasic.FileIO.FileSystem.CopyDirectory(source, destination); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-12-15T16:05:41.050

您可以使用`SearchOption.AllDirectories`递归搜索文件夹，您只需要在复制之前创建目录...

```
// string source, destination; - folder paths 
int pathLen = source.Length + 1;

foreach (string dirPath in Directory.GetDirectories(source, "*", SearchOption.AllDirectories))
{
    string subPath = dirPath.Substring(pathLen);
    string newpath = Path.Combine(destination, subPath);
    Directory.CreateDirectory(newpath );
}

foreach (string filePath in Directory.GetFiles(source, "*.*", SearchOption.AllDirectories))
{
    string subPath = filePath.Substring(pathLen);
    string newpath = Path.Combine(destination, subPath);
    File.Copy(filePath, newpath);
} 
```

# asp.net-mvc - 用于表单提交和即时结果显示的良好 ASP.NET MVC 模式

> ID：627511
> 
> 赞同：4
> 
> 时间：2009-03-09T18:41:03.980
> 
> 标签：asp.net-mvc, postback, return-value

我听说每个人都建议在用户提交表单（HTTP POST）后重定向用户（HTTP GET）。它很干净，没有“你想重新发送”警报，很简单......

但是，如果我想向用户显示一些结果怎么办？

好的，我可以向 GET url 添加一些参数，例如“/?message=1”，然后检查那个 parameter.orm

但是，如果我想显示更多信息怎么办？例如，用户提交表单，结果是一个简单的结构，比方说......我想向用户显示 5 个不同的属性。

比如，“您在购物车中添加了一个产品，这里还有其他 5 个其他产品也添加了。”。现在，这被简化了，不要告诉我“啊，只需传递 ?productId=xy 然后根据该 ID 执行另一个查询”。

我应该坚持使用 POSTBACK 模型吗？

假设用户是匿名的并且没有启用 cookie。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T19:58:24.510

这就是 TempData 的用途。它[专门且仅适用于您重定向的情况](http://blogs.teamb.com/craigstuntz/2009/01/23/37947/)。像 ViewData 一样使用它，除了它可以在重定向中存活。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-09T18:47:49.440

像这样的东西怎么样：

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Index(string something) {
    if (something == "example") {
        ViewData["Something"] = something;
        ViewData["SOmethingElse"] = 23;
        return View("MyView");
    } else {
        return View("MyView");
    }
}

[AcceptVerbs(HttpVerbs.Get)]
public ActionResult Index() {
    return View("TheForm");
} 
```

第一种方法将处理您的发布事件，您可以根据需要将数据传入其中并返回。第二种方法将处理操作的初始获取请求。注意动作的 AcceptVerbs 属性。

此选项不会更改 URL。如果您希望更改 url，您唯一的选择是使用查询字符串。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-09T19:44:19.617

当发布成功时，在您的控制器中为用户保留一个事务标识符（您可以为此使用 ASP.NET 配置文件提供程序）并重定向到已完成的页面 (GET)。

在您已完成的页面 GET 处理程序中，您可以查找用户的最后一个事务 ID，并根据此显示您想要的内容。

“交易标识符”是一些标识符，您以后可以参考它来查找交易的详细信息。

这是我正在考虑的 URL 序列：

1.  GET /orders/create - 显示表格
2.  POST /orders/create - 验证并创建订单（订单 ID == 10），重定向到 /orders/details/{orderId}
3.  GET /orders/details/10 - 查找订单 10，显示订单和与之相关的任何额外信息

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T22:50:55.793

您想使用 TempData["mykey"]=ObjectIWantToUseOnTheNext Page。

有关更多信息，请参阅此博客文章：

[http://blogs.teamb.com/craigstuntz/2009/01/23/37947/](http://blogs.teamb.com/craigstuntz/2009/01/23/37947/)

# c++ - 帮助声明 C++ 结构，将浮点数组作为其成员之一

> ID：627512
> 
> 赞同：2
> 
> 时间：2009-03-09T18:41:47.380
> 
> 标签：c++, arrays, structure, declaration

我想知道是否有人能发现我的结构声明和使用有什么问题。目前我有一个结构并希望将浮点数组存储为它的成员之一。

### 我的代码：

```
struct Player{
float x[12];
float y[12];
float red,green,blue;
float r_leg, l_leg;
int poly[3];
bool up,down;
}; 
```

然后我尝试填充结构：

```
float xcords[12] = {1,1,1,1,1,1,1,1,1,1,1,1 };
float ycords[12] = {1,1,1,1,1,1,1,1,1,1,1,1 };
Player player = {xcords,ycords,1,1,1,2,2,true,true}; 
```

### 错误：

```
1>.\template_with_console.cpp(35) : error C2440: 'initializing' : cannot convert from 'float [12]' to 'float'
1>        There is no context in which this conversion is possible
1>.\template_with_console.cpp(35) : error C2440: 'initializing' : cannot convert from 'float [12]' to 'float'
1>        There is no context in which this conversion is possible 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T18:46:20.410

尝试

```
Player player = {{1,1,1,1,1,1,1,1,1,1,1,1 },
                 {1,1,1,1,1,1,1,1,1,1,1,1 },
                 1,1,1,
                 2,2,
                 {},
                 true,true}; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-09T18:50:14.440

在大多数情况下，数组会衰减为指向数组的第一个元素的指针，就像`xcords`and一样`ycords`。您不能像这样初始化结构。因此，您必须明确初始化成员：

```
Player player = {
        {1,1,1,1,1,1,1,1,1,1,1,1 }, // xcords
        {1,1,1,1,1,1,1,1,1,1,1,1 }, // ycords
        1,1,1,                      // red, green, blue
        2,2,                        // right, left
        {0,1,2},                    // poly[3]   -- missing?          
        true,true};                 // up, down 
```

如果我理解正确，您还缺少 poly[3] 的初始化程序。输入适当的值。否则会有默认初始化——这就是你想要的吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T18:47:42.340

我认为您期望初始化将每个数组的元素复制到您的结构中。尝试单独初始化结构中的数组元素，例如使用`for`循环。

没有用于复制另一个数组元素的浮点数组的“构造函数”。

# xcode - 在 Xcode 3.1 的本地化列表中添加新语言

> ID：627516
> 
> 赞同：2
> 
> 时间：2009-03-09T18:43:07.423
> 
> 标签：xcode, localization, internationalization, xcode3.1

在 Xcode 中，我试图向 xib 文件添加另一个本地化。在下拉列表中，我有 4 种语言：

*   英语
*   日本人
*   法语
*   德语。

如何将中文添加到列表中，这样我每次添加到另一个 xib 文件时都不必键入它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T20:03:32.213

您必须每次都输入它。不幸的是，这被硬编码到 Xcode 中。据我所知，他们在 DevToolsCore（Xcode 使用的私有框架，也是硬编码字符串的常见嫌疑人之一）中对其进行了硬编码。

有趣的是，Xcode 甚至在项目文件中记录了这个新条目（查找“knownRegions”）。它只是不将其用于下拉菜单。

我建议打开雷达。

# c# - 通过 Skype4COM.dll COM API 控制 Skype

> ID：627517
> 
> 赞同：6
> 
> 时间：2009-03-09T18:43:08.733
> 
> 标签：c#, com, skype

我正在使用 C# 使用[Skype4COM.dll COM API](https://developer.skype.com/Docs/Skype4COM)，它非常适合我们需要的所有通信功能。我们正在尝试在嵌入到我们应用程序中的 Skype 之上放置一个更易于使用的界面。

我的麻烦在于控制或禁用哪些 Skype 窗口使用和不使用。我认为我需要的唯一 Skype 窗口是 Skype 视频电话/会议窗口。我想隐藏和控制 Skype 可以显示的所有其他窗口。我什至想禁用在来电时弹出的来电对话窗口，因为我们将呈现我们自己的应答提示。除了窗口管理之外，我对 API 很满意。

使用 API，我可以看到如何启用 Windows，但我似乎无法弄清楚如何隐藏它们，除非将 Windows 消息黑客攻击到 Skype 应用程序。我错过了什么吗？

谢谢你的帮助，肯尼

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-10T13:54:21.227

仔细研究了一下，我们发现您可以通过以下方式发送“Skype 命令”

```
skypeobj.SendCommand ( Command cmd ); 
```

这对于我们需要的大部分内容都非常有效。这是[Skype 开发者网站上的参考](https://developer.skype.com/Docs/ApiDoc/Controlling_Skype_user_interface)：

一些代码：

```
 void _SendSkypeCommand ( string cmdToSend )
    {
        Command cmdSkype = new Command ();
        cmdSkype.Blocking = true;
        cmdSkype.Timeout = 2000;
        cmdSkype.Command = cmdToSend;
        Trace.WriteLineIf ( _TracingDetailed, string.Format ( "skype command sent '{0}'", cmdToSend ) );
        _skype.SendCommand ( cmdSkype );
    }

    void _hideSkypeWindows ()
    {
        _SendSkypeCommand ( "SET SILENT_MODE ON" );
        _SendSkypeCommand ( "SET WINDOWSTATE HIDDEN" );
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T18:49:24.460

不幸的是，该界面实际上并没有让您控制实际的窗口，只有显示和修改它们的方法（通过包装器）。

正如您所说，您必须以某种方式获取窗口的句柄，然后发送消息将其隐藏。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-30T03:32:37.213

我有同样的问题，并且

_SendSkypeCommand ( "SET SILENT_MODE ON" );

已经坏了，正如这篇文章所说： http: [//devforum.skype.com/t5/Desktop-API/How-to-keep-hidden-Skype-UI-using-Skype4COM/td-p/12338](http://devforum.skype.com/t5/Desktop-API/How-to-keep-hidden-Skype-UI-using-Skype4COM/td-p/12338)

我的解决方案是通过将其窗口移出显示区域来使 Skype UI 不可见。

现在代码：

```
 [DllImport("user32.dll", SetLastError = true, CharSet = CharSet.Auto)]
    public static extern IntPtr FindWindowEx(IntPtr parentHandle, IntPtr childAfter, string lclassName, string windowTitle);
    [DllImport("user32.dll", SetLastError = true)]
    internal static extern bool MoveWindow(IntPtr hWnd, int X, int Y, int nWidth, int nHeight, bool bRepaint);        
    IntPtr hwnd = FindWindowEx(IntPtr.Zero, IntPtr.Zero, "tSkMainForm", null);//find skype window                  
    MoveWindow(hwnd, 2300, 2300, 300, 400, true); 
```

# visual-studio-2008 - 可本地化的用户控件

> ID：627520
> 
> 赞同：2
> 
> 时间：2009-03-09T18:43:32.087
> 
> 标签：visual-studio-2008, localization, windows-forms-designer

如果我有一个本地化的表单并且具有本地化的用户控件，我如何以 VS 属性中指定的语言查看表单和控件？

现在，当我更改语言时，我所有不属于用户控件的控件都会适当调整，但我的用户控件没有。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-04T11:00:59.580

在设计器中设计每个用户控件时，您必须单独本地化它。然后您可以将用户控件上的属性 Localizable 设置为 true 并选择您的语言。不幸的是，在设计 Form 时，周围的 Form 并没有将这两个属性升级到其用户控件。这是一个问题，但仅限于设计时。但是在运行时它会起作用，并且您的用户控件应该显示正确的本地化值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T12:14:20.387

只是为了确保：用户控制 Localizable=true 吗？它可能不应该为自己定义一种语言，以使其使用父级上设置的语言。

# vb.net - 无法创建 PDB 文件

> ID：627523
> 
> 赞同：39
> 
> 时间：2009-03-09T18:44:25.297
> 
> 标签：vb.net, visual-studio, visual-studio-2005, pdb-files

由于某种原因，这个错误今天开始在我的一个项目中出现。

> 错误 1 ​​无法写入输出文件“C:\MyProject\Release\MyProject.pdb”：未指定的错误

如果我进入高级编译选项并将其更改为不生成和调试信息，我的项目编译得很好。

我已经尝试将 Release 文件夹的权限设置为每个人的完全权限，所以我认为这不是权限问题。此外，我的日志文件中没有任何内容可以为我提供有关该问题的更多信息。

有谁知道为什么这个错误会开始出现或修复它的方法？

谢谢。

* * *

更新：我已经重新启动了我的机器，多次重新启动 VS，甚至完全删除了发生问题的现有 OBJ 文件。它仍然给我同样的错误。

这是一个简单的项目解决方案，上周运行良好。VS 尝试构建 PDB 文件似乎是一个问题，因为我可以毫无问题地将它们从 Release 和 Debug 文件夹中删除。当我尝试重建它们时，VS 将开始创建文件（大小约为 1.4MB），但我仍然收到错误消息。

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2009-03-09T19:16:30.120

在把我的头撞在墙上一段时间后，通过源代码控制挖掘试图回到工作副本，结果证明 PDB 文件根本不是问题。当我试图找到该文件以创建调试信息时，有人删除了导致 VS 阻塞的源文件。

因此，如果有人遇到此错误并且无法弄清楚，请确保您没有在某处丢失源文件。

如果 VS 会告诉我文件丢失，而不仅仅是告诉我它在创建 PDB 文件时有一个未指定的错误，那将会非常有帮助。

谢谢。

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2013-01-18T00:40:49.953

[这是解决此问题](http://lajak.wordpress.com/2011/06/28/error-3-unable-to-write-to-output-file-filename-pdb-unspecified-error/)的更好方法。

基本上关闭您的解决方案并在不编译的情况下重新打开它。检查错误列表，它将显示哪些文件丢失。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-19T08:27:49.973

这对我有用，其他答案在这里失败了：

[无法写入输出文件 [FileName] .pdb：未指定的错误 Visual Studio](http://lajak.wordpress.com/2011/06/28/error-3-unable-to-write-to-output-file-filename-pdb-unspecified-error/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-09T18:46:50.923

也许其他东西打开了文件，比如编辑器或 Visual Studio 的另一个副本？

尝试关闭并重新启动 VS，甚至重新启动计算机以查看是否可以解决问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-09T18:46:57.680

在最坏的情况下尝试重新启动 Visual Studio。您可以尝试的另一个好工具是SysInternals的[Process Explorer ，它允许您查看谁在处理您的 PDB 文件。](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)这样您就可以确切地知道要杀死/重新启动什么才能访问该文件。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-09T18:57:44.143

如果您在解决方案中包含多个**项目**，则可能会出现**错误的编译顺序**。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-11-17T07:06:58.083

检查将在 Visual Studio 中显示的带有感叹号图标的丢失文件，并且这些文件可能不存在于项目源文件夹中。如果您不希望这些文件在 Visual Studio 中删除它们，则将这些文件添加到源文件夹中。清洁或刷新..

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-05-03T13:43:59.840

我收到了同样的错误，它最终成为需要更新的网络参考。更新所有网络参考后，问题仍然存在。最后，我添加了相同的 Web 引用作为相同的 url 和名称，并且添加 Web 引用告诉我有一个相同名称的引用，并提供了一个使用最新信息更新它的选项。这终于奏效了，项目再次运行。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-12-31T19:43:32.143

我想在典型的基础上添加一些*`Turn it off and on again`*有用的原因。

Visual Studio 在构建项目时可能会绕轴转，因此它无法弄清楚为什么它缺少特定的依赖项，它只知道它无法构建项目。

以下是重建失败后的描述性错误消息：

![无用的错误](https://i.imgur.com/Q9OM4vS.png)

解决方案是：

1.  关闭 Visual Studio
2.  打开 Visual Studio
3.  **不要*编译***- 查看错误列表以获取新的描述性错误**：**

![有用的错误](https://i.imgur.com/gBnnt95.png)

许多现有的说明都缺少第三步，所以我认为这可能会有所帮助。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-09T18:46:54.510

原因几乎可以肯定是另一个进程挂在该文件的句柄上，从而防止它被覆盖。不幸的是，VS 通常是罪魁祸首。如果是这种情况，重新启动 VS 将解决问题。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-09T18:47:53.247

Visual Studio 有时会对文件被锁定感到“困惑”，尤其是在之前的调试运行期间，被调试的应用程序意外崩溃、Visual Studio 意外崩溃，或者有时您只是停止调试。

通常，解决方案是关闭并重新打开 Visual Studio。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-24T20:15:29.647

是的 - 如果您从 VSS 中获取项目，请务必检查未从 VSS 中提取的文件。只需查找带有感叹号的文件。一旦项目中的所有文件都位于它们应该在本地的位置，PDB 就会生成而不会出现问题。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-07-25T20:06:31.783

我遇到了同样的错误。原来“服务参考”文件夹已过时。我再次删除并添加了服务引用，它开始工作。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-10-28T19:37:15.250

同样的错误也发生在我身上，但原因不同。有人删除了项目文件但没有更新项目文件；因此该项目正在寻找该文件。该文件上方显示一个黄色警告图标。当我从项目中排除该文件时，问题已解决。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-02-12T19:39:09.497

我在 VS2005 上，当我将 Web 项目作为“解决方案”打开时遇到了这个错误——打开了 .sln 文件——然后点击构建/重建。一旦我关闭了解决方案并将其作为“项目”重新打开——打开了 .vbproj 文件——我在编译/重新编译时得到了特定的缺失源代码错误。我确保所有文件都存在，瞧，它成功完成了构建！

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2020-04-01T16:04:28.957

*我在VS2010*解决方案中遇到了这个问题，我尝试了上面所有接受的答案，但仍然无法弄清楚为什么编译器找不到（*Test.vb*）文件。正如一些答案已经提到的那样，*.pdb*文件不是实际的错误。

该错误是重新打开解决方案而不构建它后出现在错误列表中的错误，即*Unable to open module 'C:\Test\Test.vb'*。但是，重新打开解决方案对我不起作用。错误提示*“Test.vb”*丢失，即使*“Test.Vb”*文件存在于我的本地副本中。那为什么找不到呢？

我为此找到的解决方案是：

1.  关闭解决方案，关闭*VS2010并在**VS2015*中重新打开解决方案。*VS2013*可能也可以，但我没有尝试过。
2.  我在*VS2015*中构建了解决方案，当然失败了，但是这次错误（特别是在输出窗口中，它显示构建行，包括编译期间发生的错误）显示了*“Test.vb”*文件的完整路径编译器试图定位。路径是***“C:\Test\..\..\Test.vb”***，这表明在构建*“Test.vbproj”项目时，编译器在**“C\Test”*文件夹中开始构建，然后附加了*.vb*文件，在*.sln*文件中定义，即*'..\..\Test.vb'*以读取*'Test.vb'*文件并构建项目。只有它不能'*'C:\Test\..\..\Test.vb'*文件夹，其中*'Test.vb'*是。

通过更正*.sln文件中**“Test.vb”*的位置，它构建得很好。

 *# c# - 如何在 asp.net 中扩展用户控件？

> ID：627528
> 
> 赞同：2
> 
> 时间：2009-03-09T18:45:43.017
> 
> 标签：c#, asp.net

我创建了一个用户控件，其中包含在 aspx 文件中定义的 Web 控件，并使其成为代码隐藏类抽象。我用另一个用户控件扩展了这个类，但是初始标记文件中的控件没有生成。如何为扩展抽象类的每个用户控件生成它们以及如何使它们可访问？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T18:49:14.303

用户控件确实无法真正扩展。您可以将代码基于抽象/扩展类，但无法使用标记来做到这一点。

考虑创建基于服务器的自定义控件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T19:47:34.583

创建一个复合控件[http://wiki.asp.net/page.aspx/217/composite-controls/](http://wiki.asp.net/page.aspx/217/composite-controls/)并查看[http://msdn.microsoft.com/en-us/library/aa479016.aspx](http://msdn.microsoft.com/en-us/library/aa479016.aspx)

基本上你可以创建一个自定义控件并在后端添加其他控件

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T18:48:23.883

如果通过生成您的意思是在 ASPX 文件中生成您不能的标签。它不是那样工作的。

# java - Java RegExp 问题 - .*(www).* 与 (www)

> ID：627545
> 
> 赞同：1
> 
> 时间：2009-03-09T18:49:35.440
> 
> 标签：java, regex

我的一个朋友目前正在修补 Java 中的[JpCap](http://netresearch.ics.uci.edu/kfujii/jpcap/doc/index.html)，我们发现了一些关于 Java 中的正则表达式的有趣（也许？）问题。

仅捕获 HTTP 流量并随后对其进行分析。为此，他使用了这样的模式：

```
Pattern p = Pattern.compile("(www)"); 
```

但是我们俩都没有弄清楚：为什么上面的模式根本不产生匹配，而下面的却是：

```
Pattern p = Pattern.compile(".*(www).*"); 
```

就我所见，这两者应该是相同的，不是吗？我对正则表达式没有太多经验，所以这个问题可能有一个非常简单的答案:)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-09T18:52:30.223

您的第一个模式只接受字符串“www”。

第二种模式在任何地方接受任何带有“www”的字符串。

这个[网站](http://java.sun.com/javase/6/docs/api/java/util/regex/Pattern.html)有更多关于 Java 正则表达式的信息。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-09T18:56:09.577

哦，没关系，我刚刚发现我们都有点 API 盲 ;)

我们正在使用

```
Matcher.matches() 
```

它将模式与整个字符串匹配，而不是

```
Matcher.find() 
```

它试图在给定字符串的任何地方找到模式。

不过，感谢您的回答！:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T18:55:38.297

我假设您正在使用该`matches()`方法，因此在这种情况下将正则表达式应用于行。这意味着任何正则表达式都在“幕后”添加了行首和行尾字符。

因此，`"(www)"`您实际上并没有得到`"^(www)$"`，而且正如您所看到的，这显着改变了正则表达式的含义。

有关 java 细微差别的更多信息：[http ://www.regular-expressions.info/java.html](http://www.regular-expressions.info/java.html)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-09T18:53:58.707

正则表达式需要分隔符。

" 符号仅用于声明字符串，因此作为分隔符无效。

你的第二个例子有分隔符，所以它有效。

# enterprise-library - 企业库：日志记录块和电子邮件

> ID：627557
> 
> 赞同：7
> 
> 时间：2009-03-09T18:53:59.503
> 
> 标签：enterprise-library

有没有人有关于如何使用日志记录块发送错误电子邮件的教程链接或示例？

杰克

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-11-13T16:10:07.020

您需要在 Logging Application Block 中设置一个 EmailTraceListener。

您可以使用 Enterprise Library UI，但 web.config 部分最终看起来像这样：

```
<loggingConfiguration name="Logging Application Block" tracingEnabled="true" defaultCategory="Default" logWarningsWhenNoCategoriesMatch="true">
    <listeners>
      <add toAddress="admin@company.com" fromAddress="fromemail@company.com"
        subjectLineStarter="" subjectLineEnder="" smtpServer="127.0.0.1"
        smtpPort="25" formatter="" listenerDataType="Microsoft.Practices.EnterpriseLibrary.Logging.Configuration.EmailTraceListenerData, Microsoft.Practices.EnterpriseLibrary.Logging, Version=4.1.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"
        traceOutputOptions="None" filter="All" type="Microsoft.Practices.EnterpriseLibrary.Logging.TraceListeners.EmailTraceListener, Microsoft.Practices.EnterpriseLibrary.Logging, Version=4.1.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"
        name="Email" />
    </listeners>
    <categorySources>
      <add switchValue="All" name="Default">
        <listeners>
          <add name="Email" />
        </listeners>
      </add>    
    </categorySources>
</loggingConfiguration> 
```

如果您的 SMTP 服务器设置正确，这将起作用。您可以使用 Telnet 通过发送命令行电子邮件来检查。

# php - PHP中的日期范围？

> ID：627558
> 
> 赞同：0
> 
> 时间：2009-03-09T18:54:19.207
> 
> 标签：php, sql, datetime

我有一个由第三方供应商创建的数据库，我现在正在为其编写新的 UI。

数据库将事件开始时间存储为 unix 时间戳（在 GMT 中）。我需要做的是查询这一天的范围。所以大概我只需要做一个：

```
SELECT * WHERE start > $last_night_at_midnight AND start < $tonight_at_midnight 
```

我遇到的问题是一种简单的方法来组合 PHP 中的日期/时间函数来创建这些变量。感觉我所做的一切对于这么简单的程序来说都太复杂了。

有没有人有一个简单的解决方案？

干杯

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-09T19:00:25.057

查看 PHP 的[strtotime()](http://php.net/strtotime)以了解纯英语到 unix 时间的转换。

正如 Paolo Bergantino 所演示的，这使您可以使用“今天午夜”和“明天午夜”和其他类似的结构。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-09T19:00:46.413

[strtotime](http://www.php.net/strtotime) - 有史以来最棒的 PHP 时间函数。

```
$last_night_at_midnight = strtotime("today midnight");
$tonight_at_midnight = strtotime("tomorrow midnight"); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-10T01:45:24.413

这是一种非常倒退的方式，但是如果您需要能够执行各种日期范围，而不仅仅是今天或一天，您可以结合两种语言的奇数时间/日期功能并使用：

```
$php_start = strtotime("Some valid date expression");
$php_end = strtotime("Some other valid date expression");

$result = my_sql_query("
          Select * FROM someDB 
          WHERE DATE(FROM_UNIXTIME(date_column)) 
          BETWEEN FROM_UNIXTIME($php_start) AND FROM_UNIXTIME($php_end)"); 
```

在查询中使用 DATE() 确保 sql 不会费心查看数据的时间部分，并且对所有三个使用 FROM_UNIXTIME 意味着 sql 服务器在派生日期的方式上是一致的。

我最喜欢的获取今天日期范围的方法是：

```
 $today_start = strtotime("today");
  $today_end = strtotime("+1 day", $today_start); 
```

我发现 strtotime 实际上更好，然后添加 86400 或类似的东西，因为 strtotime 处理 DST 更好。上周发现的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-09T19:03:23.893

[strtotime](http://php.net/strtotime)在这里很有用...

```
$t1=strtotime("today");
$t2=strtotime("tomorrow");

$sql="select * from foo where timecol between $t1 and $t2"; 
```

在撰写本文时 (09-03-2009 19:06)，今天相当于 09-03-2009 00:00:00，明天相当于 10-03-2009 00:00:00

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-09T19:06:48.490

如果您需要选择任意日期，请使用[gmmktime](http://ca3.php.net/manual/en/function.gmmktime.php)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-09T18:59:19.177

PHP 中的 time() 函数可能在这里有用：http: [//be2.php.net/manual/en/function.time.php](http://be2.php.net/manual/en/function.time.php)

更具体地说，该页面上给出的示例可能会告诉您您需要了解的内容。看看第三个回声语句

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-03-09T19:06:06.853

您可以在 PHP 或 Mysql 中创建这些变量...

```
$tonight_at_midnight    = mktime(0,0,0);
$last_night_at_midnight = $tonight_at_mindnight - 86400; 
```

另一种可能性是在 SQL 中：

```
 SELECT * FROM tbl1 WHERE start > UNIX_TIMESTAMP(DATE_SUB(CURDATE(), INTERVAL 1 DAY) 
AND start < UNIX_TIMESTAMP(CURDATE()) 
```

（未测试）

# algorithm - 计算 3D 中两条线（线段）之间的最短距离

> ID：627563
> 
> 赞同：23
> 
> 时间：2009-03-09T18:55:40.683
> 
> 标签：algorithm, geometry

我有两条线段： X1,Y1,Z1 - X2,Y2,Z2 和 X3,Y3,Z3 - X4,Y4,Z4

我试图找到两个段之间的最短距离。

我一直在寻找几个小时的解决方案，但它们似乎都适用于线条而不是线段。

有什么想法可以解决这个问题，或者有什么来源吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-03-31T17:36:02.593

我会用matlab来回答这个问题，但也可以使用其他编程环境。我要补充一点，这个解决方案对于解决任意数量的维度（> = 3）的问题都是有效的。

假设我们在空间中有两条线段，PQ 和 RS。这里有一些随机的点集。

```
> P = randn(1,3)
P =
     -0.43256      -1.6656      0.12533

> Q = randn(1,3)
Q =
      0.28768      -1.1465       1.1909

> R = randn(1,3)
R =
       1.1892    -0.037633      0.32729

> S = randn(1,3)
S =
      0.17464     -0.18671      0.72579 
```

无限线 PQ(t) 很容易定义为

```
PQ(u) = P + u*(Q-P) 
```

同样，我们有

```
RS(v) = R + v*(S-R) 
```

看到对于每一行，当参数为 0 或 1 时，我们在返回的行上得到一个原始端点。因此，我们知道 PQ(0) == P、PQ(1) == Q、RS(0) == R 和 RS(1) == S。

这种以参数方式定义线的方式在许多情况下都非常有用。

接下来，假设我们沿着 PQ 线往下看。我们能找到从线段 RS 到无限长线 PQ 的最小距离的点吗？这很容易通过投影到 PQ 行的零空间中来完成。

```
> N = null(P-Q)
N =
     -0.37428     -0.76828
       0.9078     -0.18927
     -0.18927      0.61149 
```

因此，null(PQ) 是一对跨越与线 PQ 正交的二维子空间的基向量。

```
> r = (R-P)*N
r =
      0.83265      -1.4306

> s = (S-P)*N
s =
       1.0016     -0.37923 
```

本质上，我们所做的是将向量 RS 投影到与线 PQ 正交的二维子空间（平面）中。通过减去 P（线 PQ 上的一个点）得到 r 和 s，我们确保无限线通过该投影平面中的原点。

所以实际上，我们已经将其简化为找到从线 rs(v) 到投影平面中原点 (0,0) 的最小距离。回想一下 rs(v) 行由参数 v 定义为：

```
rs(v) = r + v*(s-r) 
```

线 rs(v) 的法线向量将为我们提供所需的东西。由于原始空间是 3-d，因此我们已将其减少为 2 维，因此我们可以简单地做到这一点。否则，我只会再次使用 null 。这个小技巧适用于二维：

```
> n = (s - r)*[0 -1;1 0];
> n = n/norm(n); 
```

n 现在是一个单位长度的向量。从无限线 rs(v) 到原点的距离很简单。

```
> d = dot(n,r)
d =
       1.0491 
```

看到我也可以使用 s 来获得相同的距离。实际距离是 abs(d)，但事实证明，d 在这里无论如何都是正数。

```
> d = dot(n,s)
d =
       1.0491 
```

我们可以由此确定 v 吗？是的。回想一下，原点距离连接点 r 和 s 的直线的距离为 d 个单位。因此，对于标量 v 的某个值，我们可以写成 d *n = r + v* (sr)。用向量 (sr) 形成该等式每一边的点积，并求解 v。

```
> v = dot(s-r,d*n-r)/dot(s-r,s-r)
v =
       1.2024 
```

这告诉我们线段 rs 最接近原点的方法发生在线段的端点之外。所以实际上 rs 上离原点最近的点是点 rs(1) = s。

从投影中退出，这告诉我们线段 RS 上离无限线 PQ 最近的点是点 S。

分析中还有一个步骤要采取。线段 PQ 上最近的点是什么？该点是否落在线段内，还是也落在端点之外？

我们将点 S 投影到线 PQ 上。（这个 u 的表达式很容易从与我之前所做的类似逻辑中得出。请注意，我已经使用 \ 来完成这项工作。）

```
> u = (Q-P)'\((S - (S*N)*N') - P)'
u =
      0.95903 
```

看到 u 位于区间 [0,1] 中。我们已经解决了这个问题。PQ线上的点是

```
> P + u*(Q-P)
ans =
      0.25817      -1.1677       1.1473 
```

并且，两条线段上最近点之间的距离为

```
> norm(P + u*(Q-P) - S)
ans =
        1.071 
```

当然，所有这些都可以压缩成几行代码。但它有助于扩展它以了解它的工作原理。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-03-09T19:00:26.477

一种基本方法与计算 2 条线之间的最短距离相同，但有一个例外。

如果您查看大多数用于查找 2 条线之间最短距离的算法，您会发现它会找到每条线上最近的点，然后计算它们之间的距离。

将此扩展到线段（或射线）的技巧是查看该点是否超出线的端点之一，如果是，则使用端点而不是无限线上的实际最近点。

具体示例见：

[http://softsurfer.com/Archive/algorithm_0106/algorithm_0106.htm](http://softsurfer.com/Archive/algorithm_0106/algorithm_0106.htm)

进一步来说：

[http://softsurfer.com/Archive/algorithm_0106/algorithm_0106.htm#dist3D_Segment_to_Segment()](http://softsurfer.com/Archive/algorithm_0106/algorithm_0106.htm#dist3D_Segment_to_Segment())

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-09T18:59:29.990

我会将两个线段参数化为每个使用一个参数，范围在 0 和 1 之间，包括 0 和 1。然后找出两个线函数之间的差异，并将其用作以参数为变量的线性优化问题中的目标函数。

所以说你有一条从 (0,0,0) 到 (1,0,0) 的线和另一条从 (0,1,0) 到 (0,0,0) 的线（是的，我使用的是简单的） . 这些线可以像 (1*t,0*t,0*t) 一样参数化，其中 t 位于 [0,1] 和 (0*s,1*s,0*s) ，其中 s 位于 [0,1 ]，独立于 t。

那么你需要最小化 ||(1*t,1*s,0)|| 其中 t, s 位于 [0,1] 中。这是一个很容易解决的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T19:04:44.907

如何将线段延伸成无限的线并找到两条线之间的最短距离。然后找到每条线上作为最短距离线段端点的点。

如果每条线的点都在原始线段上，那么您就有答案了。如果每条线的点不在原始线段上，则该点是原始线段的端点之一。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-03-05T08:04:40.767

基于找到两条无限线之间的距离然后将无限线绑定到有限线来找到两条有限线之间的距离并不总是有效。例如尝试这一点

```
Q=[5 2 0]
P=[2 2 0]
S=[3 3.25 0]
R=[0 3 0] 
```

基于无限接近算法选择R和P进行距离计算（距离=2.2361），但在R和S中间的某处距离P点的距离更近。显然，从 R 到 S 线选择 P 和 [2 3.166] 的距离较小，为 1.1666。通过精确计算并找到从 P 到 RS 线的正交线，即使这个答案也可以变得更好。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-04-09T02:58:27.863

首先，找到在它们的延长线之间桥接的最接近线段。我们称之为 LineSeg BR。

如果 BR.endPt1 落在 LS1 上，而 BR.endPt2 落在 LS2 上，你就完成了……只需计算 BR 的长度。

如果网桥 BR 与 LS1 相交但不与 LS2 相交，则使用以下两个距离中的较短者：smallerOf(dist(BR.endPt1, LS2.endPt1), dist(BR.endPt1, LS2.endPt2))

如果网桥 BR 与 LS2 相交但不与 LS1 相交，则使用以下两个距离中的较短者：smallerOf(dist(BR.endPt2, LS1.endPt1), dist(BR.endPt2, LS1.endPt2))

如果这些条件都不成立，则最近距离是相对线段上最近的一对端点。

# java - Java小程序中的drawImage在Safari中闪烁

> ID：627570
> 
> 赞同：2
> 
> 时间：2009-03-09T18:57:50.290
> 
> 标签：java, macos, safari, applet, flicker

我在 Safari (Mac) 中的 Java 小程序中遇到闪烁问题。但是，这不是通常的双缓冲问题。

我已将其隔离为一个`drawImage`调用（没有多余的重绘，没有`clear`调用），它在绘制图像之前会出现白色闪烁，但不是在每次重绘时都会闪烁。事实上，我测量了`drawImage`调用的持续时间，通常约为 1 毫秒，但大约每 5 次调用paint 时最长可达 30 毫秒，也就是它闪烁的时候。当我拖动组件或滚动窗口时会触发重绘。

这是 OSX 上的 java 实现中的错误，是否有修复？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-09T20:22:51.740

你提供的信息非常少。这很难回答。

您是否在绘制图像之前重新创建图像？然后你可以缓冲它或使用媒体跟踪器。

如果您使用旧的 Java 版本，请更新它。OSX 的旧版本有很多错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-04-29T20:44:49.687

我假设您的问题是通用闪烁小程序问题。

解决方案就在那里：[BackBuffer](http://profs.etsmtl.ca/mmcguffin/learn/java/07-backbuffer/)

我希望它有帮助。

# javafx - 在网页中运行 JavaFX 程序，而不是启动新窗口

> ID：627579
> 
> 赞同：2
> 
> 时间：2009-03-09T19:00:32.543
> 
> 标签：javafx

我在阅读中看到了很多 JavaFX 示例，但是我看到的每个 JavaFX 应用程序都需要在单独的窗口中启动。这些应用程序不在网页内运行。

JavaFX 应用程序能否在网页中运行，就像我们期望 Flash 应用程序（或者，就此而言，小程序）运行一样？人们为什么不让 JavaFX 应用程序在他们的网页中运行是有原因的吗？

是否需要使用特定的 HTML 代码来让 JavaFX 应用程序运行 Flash/applet 样式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T14:16:03.953

是的，只需在 NetBeans 中构建一个演示 JavaFX 应用程序。如果他们没有为您提供某种类型的“Hello World”测试应用程序，我会感到惊讶。然后看看它创建的 HTML 页面。

如果您在让 JavaFX 应用程序在网页上运行时遇到问题，请查看[此问题](https://stackoverflow.com/questions/530775/javafx-wont-load-on-my-webpage)。简而言之，您不能只复制 jar 文件并将适当的 HTML 复制并粘贴到您的网页中。您需要包含 NetBeans 创建的 JNLP 文件，并且您必须在 JNLP 文件中编辑一些 NetBeansy 内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T09:08:14.333

是的，只需将运行应用程序用作 Java Applet。NetBeans 将为包括 Java Applet 在内的所有平台正确部署所有 FX 内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-10T14:15:12.190

看....

[http://www.javafx.com/samples/SimpleVideoPlayer/index.html](http://www.javafx.com/samples/SimpleVideoPlayer/index.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T16:29:40.580

是的，你可以做到。

寻找关于[JNLPAppletLauncher](https://applet-launcher.dev.java.net)

# flash - sIFR 3.0 和 swmode

> ID：627580
> 
> 赞同：0
> 
> 时间：2009-03-09T19:00:45.150
> 
> 标签：flash, sifr

以前版本的 sIFR 允许用户输入“sWmode: 'transparent'”，以避免 Flash 对象被覆盖在屏幕上的常规 HTML 对象上的常见问题，无论任一元素的 z-index 是多少。

如何在 sIFR 3.0 中复制这种行为？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T08:14:50.683

我认为您只需要添加：

```
wmode: 'transparent' 
```

在您发送到 sIFR.replace() 的对象中

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T09:25:51.920

确实，您可以使用

```
wmode: 'transparent' 
```

或者

```
wmode: 'opaque' 
```

但是也

```
transparent: true 
```

或者

```
opaque: true 
```

无论你的船漂浮什么:)

请注意，浏览器通常会出现透明 Flash 电影的问题，因此通常指定背景颜色是更好的选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-04-23T17:04:46.603

表达式不会以相同的方式解释。例如，在 Chrome 10`wmode: 'transparent'`中，被替换的文本后面会出现黑色背景，而`wmode: 'opaque'`它应该可以正常工作。奇怪的！

# python - 表单字段 API？

> ID：627583
> 
> 赞同：2
> 
> 时间：2009-03-09T19:01:00.890
> 
> 标签：python, django, django-forms

我正在遍历表单字段列表。如何识别每个字段的类型？对于复选框，我可以调用 field.is_checkbox ...列表、多项选择字段等是否有类似的方法？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T19:13:14.743

查看表单上每个字段的类：

```
for f_name, f_type in my_form_instance.fields.items():
    print "I am a ",type(f_type)
    # or f_type.__class__ 
```

这将产生类似于 的输出`<class 'django.forms.fields.BooleanField'>`。

如果您愿意，可以将名称作为简单的字符串获取，使用：

```
print type(f_type).__name__
# produces 'BooleanField' 
```

编辑：还要注意字段和小部件之间的区别。Django 中没有 Checkbox 字段，只有 CheckboxInput 小部件，这是 BooleanField 的默认值。您是要查找小部件（非常特定于渲染）还是字段（与该表单字段的数据类型和验证有更多关系）？如果是小部件，您可以使用以下方法获取小部件类型：

```
f_type.widget 
```

希望有帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T19:22:29.277

我不确定这是否是您想要的，但如果您想知道它最终会出现在 HTML 中的字段类型，您可以通过以下方式进行检查：

```
{% for field in form %}
    {{ field.field.widget.input_type }}
{% endfor %} 
```

widget.input_type 将保存文本、密码、选择等。

PS我直到5秒前才知道这一点。#django irc.freenode.net 总是有很好的帮助。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-09T19:03:52.647

假设您在这里使用 HTML ......因为它不是很清楚。

给它一个额外的课程怎么样。

如果你还不知道，class 属性会识别这一点：

```
class="hello there you" 
```

因为有 3 节课。“你好”类、“那里”类和“你”类。因此，如果他们已经有一个类，只需添加一个空格和您的自定义类名。

# php - 如何在 Symfony 1.2 中以表单形式获取用户数据？

> ID：627585
> 
> 赞同：7
> 
> 时间：2009-03-09T19:01:11.390
> 
> 标签：php, symfony1

我在标准的 Propel 表单类中使用 Symfony 1.2。

```
public function configure()
{
    $this->setWidgets(array( 
'graduate_job_title' => new sfWidgetFormInput( array(), array( 'maxlength' => 80, 'size' => 30, 'value' => '' ) )
    ));
    //etc
} 
```

但是，我希望此字段的值来自用户信息，我通常使用`$this->getUser()->getAttribute( '...' )`. 但是，这似乎不适用于表格。

我应该使用什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2010-05-27T11:49:41.507

依赖 sfContext 实例是一个非常糟糕的主意。最好在 options 数组参数中传递 sfForm 初始化期间所需的内容。

[http://www.symfony-project.org/api/1_4/sfForm](http://www.symfony-project.org/api/1_4/sfForm)

__construct 方法

例如在你的行动中：

```
$form = new myForm(null, 
                   array('attributeFoo' => 
                         $this->getUser()->getAttribute('attributeFoo')); 
```

然后检索表单类中的值：

> $this->getOption('attributeFoo');

环波

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-09T19:25:53.513

~~那样有用吗？~~

 ~~```
sfContext::getInstance()->getUser()->getAttribute('...'); 
```~~  ~~**// 编辑**：参见 cirpo 关于使用 sfContext 的建议。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-03-18T08:42:16.423

如果有人在管理员（后端）中需要相同的解决方案：http: [//blog.nevalon.de/en/wie-nutze-ich-die-rechteverwaltung-in-symfony-admin-generator-formularen-20100729](http://blog.nevalon.de/en/wie-nutze-ich-die-rechteverwaltung-in-symfony-admin-generator-formularen-20100729)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2016-02-08T12:32:19.560

在 Symfony 1.4 中，对象**$sf_user**

# arrays - 将数组发送到 PL/SQL 过程

> ID：627587
> 
> 赞同：0
> 
> 时间：2009-03-09T19:01:28.610
> 
> 标签：arrays, plsql, service, cursor

我创建了一个 Web 服务来将一堆信息发送到 PL/SQL 过程，但是其中一个是数组。我用什么类型的？我还想在该数组进入后将该数组放入游标中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-09T19:34:48.657

我对 PL/SQL 没有任何经验，如果这不适用，请见谅。在 MS SQL 2000/2005 中，没有办法将数组传递给过程。我假设 PL/SQL 也有类似的限制。我过去使用的解决方法是传入一个分隔字符串（通常是管道分隔，因为数据中存在逗号），然后有一个函数可以接受一个分隔字符串并将其分解为一个表结果每个值的行。然后在你的过程中，你只需调用你的 split 函数，将分隔字符串传递给它，你就有一个表结果，你可以做任何你想做的事情（光标，加入其他表等）。

编辑：刚刚为“PL/SQL 表参数”做了一个谷歌搜索并获得了一些点击；可能值得调查，看看这些结果是否对您有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T19:41:03.600

[这个链接](http://www.orafaq.com/forum/t/70369/0/)可能有用。或者你可以按照其他海报所说的去做，基本上将你的数据序列化成一个字符串，传递它，然后在另一端反序列化它。

# java - 如何在我的 Eclipse 项目中包含 JavaHelp？

> ID：627588
> 
> 赞同：0
> 
> 时间：2009-03-09T19:01:33.820
> 
> 标签：java, swing, javahelp

我正在编写一些需要绑定帮助内容系统的应用程序。我遇到了[JavaHelp](http://java.sun.com/javase/technologies/desktop/javahelp/)，它似乎非常适合我的需要。

我遇到的问题是，当您下载 JavaHelp 时，它带有自己的 bin 文件夹，看起来您应该单独使用。但是，我很确定如果我只是复制一些 JAR 文件，我应该能够将它们放在我的 Eclipse 的层次结构中并在项目中使用它。

我需要复制哪些 JAR 才能在我的应用程序中使用 JavaHelp？

**更新**

我让 JavaHelp 工作起来相当容易。不过，我对内置的 Eclipse 帮助有疑问。但我很欣赏你的两个答案！

如果有人有兴趣了解如何将 JavaHelp 添加到您的项目中（不必特定于 Eclipse），我将非常乐意在这里提供答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T19:57:08.290

虽然 JavaHelp 是一个很好的 api，但 Eclipse 有自己的 api 来寻求帮助，而且（IMO）对于基于 SWT 的应用程序来说，它是一个更好的选择。请参阅[这篇](http://www.ibm.com/developerworks/opensource/library/os-echelp/)关于使用 Eclipse 帮助系统开发帮助的 developerworks 文章。

如果你实际上是在创建一个 swing 应用程序，并且想用它打包 java 帮助，你需要创建帮助文档（帮助主题、帮助集文件、地图文件、TOC、索引、全文搜索数据库），然后将这些文件打包到一个 jar 中，以便与您的应用程序一起分发。有关详细信息，请参阅[JavaHelp 用户指南](https://cds.sun.com/is-bin/INTERSHOP.enfinity/WFS/CDS-CDS_Developer-Site/en_US/-/USD/ViewProductDetail-Start?ProductRef=javahelp-2_0_05-guide-oth-JPR@CDS-CDS_Developer)。

要从 Eclipse IDE（以及在运行时从您的应用程序）运行帮助查看器，您只需要来自 JavaHelp 发行版的 jar 文件 jhall.jar。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T21:07:52.847

JavaHelp [README](http://java.sun.com/javase/technologies/desktop/javahelp/README.html#contentsoftherelease)详细介绍了下载中提供的可再发行 jar 文件。选择适合您需要的 jar 并将其添加到您的 Eclipse 项目中。

# .net - WPF 或 WinForms 用于内部工具？

> ID：627590
> 
> 赞同：4
> 
> 时间：2009-03-09T19:03:23.847
> 
> 标签：.net, wpf, winforms

在我的公司，我们开发了许多内部工具，从简单的实用程序到成熟的编辑器。这些工具的优先级是稳定性、可用性和周转时间（意味着可以多快地添加新功能）。

到目前为止，我们一直在使用 WinForms，但绘图板上有几个新工具，我正在权衡我们应该继续使用 WinForms 还是转向 WPF。当我们控制环境时，我们不必担心 .NET 版本等（尽管我们暂时必须在 XP 上运行）。

我熟悉 WPF 提供的图形优势（基于矢量、硬件加速、换肤能力），但我想知道 WPF 是否还有其他方面可以为它在 WinForms 上的使用提供令人信服的论据。

谢谢，

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-09T19:47:22.947

不要低估学习曲线。WPF 可以很好地使用，它可能是一场噩梦。我见过只有 WinForms 的开发人员对 WPF 比对 ASP.NET 更无助（即使对 Web 开发知之甚少）。虽然大多数开发人员能够在不阅读任何书籍的情况下就开始使用 WinForms 和 ASP.NET，并且在某种程度上具有生产力，但使用 WPF 似乎是不可能的。

并且不要忘记第三方组件。是的，市场上甚至还有新的参与者，在 .NET 3.0 之后的*几年*，例如 SoftwareFX 终于设法发布了他们的 WPF 图表解决方案（仅作为示例），但 WPF 的组件市场仍然小得多（商业以及开源），而且 WPF 组件通常仍然不如 WinForms 对应的组件强大。

我同意架构（例如数据绑定概念）很棒，如果您遵循 MVVM 之类的模式，但是 MSDN 中关于最佳实践的文档很少，例如关于 MVVM，因此您必须将您的团队指向关于网络和书籍等。

而且数据绑定在 WinForms 2.0 中已经非常强大并且实际上非常相似。看起来很少有人知道并充分利用它。（可能他们只在 1.1 中尝试过，觉得太复杂了……）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-09T19:09:48.717

我同意亚历克斯 - 转到 WPF。不过，一个可能的限制是 WPF 仅适用于 XPSP2 及更高版本。

WPF 相对于 WinForms 的优势之一是 WPF 的数据绑定比 WinForms 强大得多。它使得将数据绑定的 UI 组合在一起变得非常容易。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-09T22:21:25.260

选择一个要在 WPF 中完成的小项目，并在了解 WPF 可以做什么以及如何正确使用它时准备好重构它。将项目视为“培训”，因为它需要一段时间才能熟悉 WPF。不过要坚持，因为值得。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-09T19:06:54.277

对于新的应用程序，我会转而使用 WPF，因为它总体上更易于使用，而且正如他们所说，“未来”。

不过 WinForms 并没有什么问题，所以如果你想坚持下去，应该不会有任何问题。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-09T19:09:49.590

我喜欢 WPF 提供的许多架构更改。更新后的 DataBinding 模型本身值得为 IMO 进行更改。但是，我会权衡维护工具跟上 WPF 速度的团队所涉及的任何潜在开销。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-09T20:09:21.303

我会根据项目的大小和数量使用 WPF。您要做的工作越多，利用 WPF 的力量就越有意义。对于 CRUD 应用程序，除了一些吸引眼球的东西之外，您不会从 WPF 中获得太多功能。您将在中期生产力方面取胜，因为 WPF 遵循一种干净的方法，而不是一种已经经过多年发展并且经过高度修补的方法，即使它穿着得非常好，例如 Windows 窗体。用 XML 布局屏幕确实有它的好处。

但是，对于快速的小工具，我会坚持使用 Windows 窗体，直到达到 WPF 熟练程度，除非目的之一是所引用的熟练程度本身。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-10T11:30:56.690

如果您的公司正在考虑在未来迁移到 WPF 的战略决策，那么从内部工具开始可能是一个好地方。如果您没有任何此类计划，那么承担理解 WPF 的主要任务根本不值得。如果您认为也许有人应该考虑是否对 WPF 进行战略性迁移，而这将是一个很好的起点，请确保有人有足够的影响力来倾听。

# api - 有维基百科 API 吗？

> ID：627594
> 
> 赞同：127
> 
> 时间：2009-03-09T19:04:49.897
> 
> 标签：api, wikipedia, mediawiki-api

在我的 Wikipedia 用户页面上，我运行一个 Wikipedia 脚本来显示我的统计数据（编辑的页面数、新页面数、每月活动等）。

我想把这些信息放在我的博客上。

是否有一个 API 可以让我做这样的事情？

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2009-03-09T19:08:45.957

MediaWiki 的[API](http://www.mediawiki.org/wiki/API)在 Wikipedia ( [docs](http://en.wikipedia.org/w/api.php) ) 上运行。您还可以使用[Special:Export](http://en.wikipedia.org/wiki/Special:Export)功能转储数据并自行解析。

[更多信息](http://en.wikipedia.org/wiki/Wikipedia:Creating_a_bot#APIs_for_bots)。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-03-09T19:07:56.550

维基百科建立在 MediaWiki 之上，这里是[MediaWiki API](http://www.mediawiki.org/wiki/API)。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2010-12-14T04:46:20.547

如果你想从维基百科中提取结构化数据，你可以考虑使用 DbPedia [http://dbpedia.org/](http://dbpedia.org/)

它提供了使用 SPARQL 使用给定条件查询数据的方法，并从解析的 Wikipedia 信息框模板返回数据

这是一个快速示例，如何在 .NET 中完成[http://www.kozlenko.info/blog/2010/07/20/executing-sparql-query-on-wikipedia-in-net/](http://www.kozlenko.info/blog/2010/07/20/executing-sparql-query-on-wikipedia-in-net/)

有一些 SPARQL 库可用于多个平台，以使查询更容易

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2011-01-18T13:54:03.170

JWPL - 基于 Java 的维基百科库——维基百科的应用程序编程接口

[http://code.google.com/p/jwpl/](http://code.google.com/p/jwpl/)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2011-07-19T11:28:45.957

以下是来自 infochimps.com 的 2 个：

[http://www.infochimps.com/datasets/wikipedia-articles-abstract-search](http://www.infochimps.com/datasets/wikipedia-articles-abstract-search)

[http://www.infochimps.com/datasets/wikipedia-articles-title-autocomplete](http://www.infochimps.com/datasets/wikipedia-articles-title-autocomplete)

# python - 使用 Python 获取 Windows 系统内部信息

> ID：627596
> 
> 赞同：1
> 
> 时间：2009-03-09T19:06:09.567
> 
> 标签：python, windows-xp

我想编写一些快速的 Python 代码来评估我的 Windows XP 系统的 CPU、内存、磁盘和网络使用情况。

是否有现有的 Python 库可以让我访问这些信息？或者，是否有我可以从 Python 调用的 DLL？（如果是这样，将不胜感激代码示例）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T19:12:58.850

我认为 WMI 是要使用的资源。特别是，查看[`Win32_PerfFormattedData*`MSDN 中的类](http://msdn.microsoft.com/en-us/library/aa394084(VS.85).aspx)。

快速搜索发现了这一点（除其他外）：

[http://timgolden.me.uk/python/wmi.html](http://timgolden.me.uk/python/wmi.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T22:47:46.477

MS [Scriptomatic](http://www.microsoft.com/downloads/details.aspx?DisplayLang=en&FamilyID=09dfc342-648b-4119-b7eb-783b0f7d1178)工具可以在 Python 以及 VBScript、JScript 和 Perl 中生成 WMI 脚本。

# iphone - iPhone 的移动 Safari：特殊字符

> ID：627605
> 
> 赞同：1
> 
> 时间：2009-03-09T19:08:40.263
> 
> 标签：iphone, safari

我正在开发的 iPhone 应用程序使用 html 帮助文件和特殊字符，例如

```
 ü  and ê 
```

正在损坏我的 iPhone 的移动 Safari。我能做些什么来纠正这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T19:12:42.937

如果您使用的是 XHTML，请确保文件的内容确实是 doctype 中指定的编码。如果您只使用纯 HTML，请考虑改用 XHTML，或者

*   使用 HTML 实体（例如`&eacute;`）
*   [使用 META 标签指定编码](http://tlt.its.psu.edu/suggestions/international/web/tips/declare.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T19:13:35.540

您是否尝试过使用[数字字符引用](http://en.wikipedia.org/wiki/Unicode_and_HTML#Numeric_character_references)？或者，也许您可​​以使用一个`<meta http-equiv="content-type" ...`元素。此外，也许有更好的方法来告诉移动 Safari HTML 文件的字符编码（相当于服务器的 HTTP Content-Type 标头）

# asp.net - 解析器错误消息 - 为什么我的 ASP.NET 部署需要 cs 文件？

> ID：627607
> 
> 赞同：0
> 
> 时间：2009-03-09T19:08:59.530
> 
> 标签：asp.net, .net-3.5, deployment

很长一段时间以来，我不得不对 ASP.NET 做一些小修复，而且我从未部署过 ASP.NET 2.0/3.5 应用程序，所以我可能只是缺少一些简单的东西，但我肯定需要帮助。

基本上，我们有一个写得很糟糕的 .NET 1.1 Web 应用程序，我们有一些承包商进来破坏我们的一些第三方依赖项，并将其更新为一个写得很糟糕的 .NET 3.5 Web 应用程序（写得不好的部分将在稍后解决） .

所以现在我正在像我们的部署环境一样设置的虚拟机上练习部署场景。

1.  我安装了3.5框架
2.  我编译了新代码，并按照承包商的建议使用了 Visual Studio 的 Build>Publish 选项，仅输出应用程序所需的文件。
3.  我将所有文件复制到 VM 上 Inetpub 内的新目录并配置了 web.config
4.  我创建了一个新的应用程序池
5.  我创建了一个指向新目录并使用新应用程序池的新 IIS 网站。我将它配置为在 IIS ASP.NET 选项卡下使用 2.0 版

但是导航到我得到的登录页面：

```
Parser Error Message: The file '/View/LoginPage.aspx.cs' does not exist.

Line 1:  <%@ Page Language="C#" MasterPageFile="~/MasterPage/LoginMasperPage.Master" AutoEventWireup="true"
Line 2:      CodeFile="LoginPage.aspx.cs" Inherits="MyApp.View.LoginPage" Title="MyApp - Login Page" %> 
```

是什么赋予了？在 .NET 1.1 版本的应用程序中，所有 c# 代码都被编译到 MyApp.dll 中，并且应用程序知道要查看那里。使用反射器进行双重检查，所有代码也都在这里的二进制文件中，只是服务器没有在那里寻找它。

会发生什么？我可以等待承包商明天进来，或者将包括 aspx 文件在内的所有内容编译成二进制文件，但我们有充分的理由不编译 aspx 文件，如果可能的话，我想今天部署。

请注意，这不是 ASP.NET MVC，视图命名空间/目录只是保存所有 web 表单的地方

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-09T19:12:29.990

您可能已经将网站模型用于更新的应用程序。请考虑改用 Web 应用程序项目。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-09-09T21:04:47.040

在“<%@ Page”指令中将 CodeFile= 引用更改为 CodeBehind=。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-09T19:14:46.457

在视觉工作室试试这个。单击您的 Web 应用程序项目。转到构建 > 发布 > 选择位置 > 单击发布。这将构建所有内容并将所有 .cs 文件放入单个 dll 文件中。它还将您的 html/aspx 文件留在相同的位置。这使您可以使用 aspx 代码执行您需要执行的操作，同时将所有 cs 隐藏起来。

# reporting - 报告与编码 - 想法？

> ID：627614
> 
> 赞同：10
> 
> 时间：2009-03-09T19:11:52.423
> 
> 标签：reporting

最近我有一个项目，我必须从特定的软件系统获取一些数据到一个 portlet。该软件使用数据库，我花了相当多的时间对我想要的数据进行建模，然后创建一个 Web 服务，以便我的 portlet 可以获取信息。

然后我突然意识到我在浪费时间。我抓住了 BIRT，把它扔进了一个 portlet，然后写了一些直接从数据库中获取必要数据的报告。我一个下午就完成了。

我知道报道是一条单行道，但这让我开始思考。报告工具可以非常有效地从您的实际数据创建报告 (duh)，但是当您这样做时，您会绕过您的模型，除非在简单的情况下，它不是您的数据的直接表示，因为它存在于您的数据库中。

如果您正在编写一个数据密集型应用程序并且需要能够执行重要的报告，您是否会绕过您的应用程序并使用 BIRT 或 Crystal Reports 之类的东西？作为整个流程的一部分，您如何管理这些工具？你是否认为你写的报告是你申请的一部分并这样对待它们？报告是一个视图、一个模型和一个控制器（如果你愿意的话），你会如何处理、解释和计划呢？

修改后的问题：报告执行某些业务计算是可能的，甚至很常见，在理想情况下，您希望在应用程序中包含这些计算。这可能导致返回给用户的信息不匹配。另一方面，报告工具使收集和显示信息变得如此容易，以至于很难采取纯粹主义者的方法并在应用程序内完成所有事情。是否有任何好的技术可以确保报告中的数据与您可能在常规 GUI 中显示的数据相匹配？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-07-30T14:17:30.027

我认为报告只是数据的另一种视图，而不是视图/模型/控制器合二为一（好吧，也许是视图和控制器合二为一）。

我们的报告（内置 sql 2008 报告服务）在我们的应用程序层使用服务来获取数据（符合我们的标准，数据访问位于存储库中）。这些函数可以执行简单的查询或处理非常复杂的处理，这在您的报告环境或存储过程中将是一场噩梦。在实践中，我们发现这只需编写一些一次性存储过程，随着您的系统不断增长，这些过程将成为维护的噩梦。

将报告视为一次性的或未集成到您的应用程序设计中是一个巨大的错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T19:39:29.363

报告至关重要。报告对于向外部用户分享在一个系统中收集的价值至关重要，例如不直接使用系统的用户（例如销售数据的管理）。因此，报告不仅仅是显示事实和数据，而且是几乎所有推动商业广告的系统的核心。

至少更高级的系统允许您增强它们：使用您自己的可重用“控件”。如果您只使用正确的插件，甚至可以实现返回方式。有一次我写了一个系统来发送邮件出报告，因为系统不允许更改。它起作用了-尽管它不应该以这种方式使用；）

报告是应用程序的重要组成部分，如果您为客户制作可更改的报告，您将获得很大的自由度。有时，您想出的可能性比您最初构建系统时所想的要多。

所以是的，对我来说，报告是系统的一部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T19:30:48.463

报告是您的应用程序的一部分，但因为它们通常是用户对数据捕获 UI 有强烈想法的东西，所以我会为了方便/交付速度而牺牲纯度并回到“真实”编码...... :-)

一旦您完成报告，用户就会想要另一个报告，或者更改颜色或可选分组或更多过滤或......让你远离令人兴奋的东西......所以我不会破坏保持纯度的直觉。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-13T20:43:09.630

这确实是一条细线。您不想花费太多时间来构建报告（无论如何用户都希望您随时更改），但您不想通过将业务逻辑放入报告中来重复逻辑！通过我们在 Data Dynamimcs 的报告产品，我认为我们已经在这两种权衡之间达到了一个愉快的平衡。

通过使用 ObjectDataProvider（有关详细信息，请参阅下面的链接），您可以将报表直接绑定到业务对象（普通旧对象），这样您就不必绕过业务层来获取数据。同时，我们提供了一种在您的报告中引用和使用来自其他库的函数的方法。这样，如果您已经配置了一些代码来执行一些业务逻辑计算，您可以直接在报表中重用这些函数。您也可以在下面的链接中看到一个示例。

*   为您的数据绑定到对象（请参阅“对象提供程序”部分）：[http ://www.datadynamics.com/Help/ddReports/ddrconDataSetAndObjectDataSource.html](http://www.datadynamics.com/Help/ddReports/ddrconDataSetAndObjectDataSource.html)
*   将自定义代码添加到您的报告演练：[http ://www.datadynamics.com/Help/ddReports/ddrwlkCustomCode.html](http://www.datadynamics.com/Help/ddReports/ddrwlkCustomCode.html)
*   使用自定义程序集（引用报告中的共享库[/dll）：http://www.datadynamics.com/Help/ddReports/ddrconCustomCode.html](http://www.datadynamics.com/Help/ddReports/ddrtskCreatingAnInstanceMethod.html)和[http://www.datadynamics.com/Help/ddReports/ddrtskCreatingAnInstanceMethod.html](http://www.datadynamics.com/Help/ddReports/ddrconCustomCode.html)

斯科特·威勒克

数据动态 / GrapeCity

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-13T20:53:02.587

我一直使用报告的方式是将部分报告视为代码库的一部分，并与应用程序一起存储在源代码中。在某些情况下，报告比应用程序更重要，因为管理层根据报告数据做出业务决策，拥有错误信息可能导致他们取消产品线、取消活动或解雇销售人员。显然，这在很大程度上取决于您的管理和您的应用程序。

关于保持模型一致，这是一个有点棘手的问题。确保报表和应用程序之间模型一致的一种方法是使用存储过程（或视图）来检索数据，具体取决于应用程序的体系结构。

# model-view-controller - What are some patterns for creating views and controllers in an MVC or MVP app?

> ID：627625
> 
> 赞同：0
> 
> 时间：2009-03-09T19:13:52.560
> 
> 标签：model-view-controller, controller, mvp, factory, presenter

I'm working on a MVC/MVP GUI for editing a document. The document has a tree structure, with some nodes representing text, others images. The app model also includes a command stack, with commands operating directly on the model.

Since different nodes have radically different controls, I'm planning on implementing individual MVC/MVP triads for each node. Where I'm running into trouble is how to synchronize creation and destruction of the peer V and C components.

My ideas:
- listen on each node for "childAdded" type events, and then create peers based on those events
- use a factory for creating nodes in the model, and have that factory also create the peers

What are some common patterns or best practices for dynamic view/controller generation?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T19:41:33.490

I recommend looking at some of the UI Patterns at this [site](http://www.martinfowler.com/eaaDev/)

As for your specific question I would do the following

The form displaying the nodes would implement a INodeView Interface

One Method of the INodeTreeForm interface would be the ability to add a individual node. It would be passing a Node class created in the NodeTreeScreen object. There will be two key property. The first is the key of the node, and the second is the type of node.

You would add the node in such a way that there is a field on the control that has the key.

Along with INodeTreeForm Interface you would have a INodeView interface. This would cover the view area or the new form you will be switching too.

When you click on the node it passes the key to NodeTreeScreen which tend looks at what type of node it is. It has a collection of INodeView objects. One of the properties of INodeView will be which type of node it is.

You retrieve the right INodeView. You close the current INodeview, set the current INodeView to the one you retrieved, pass it the node, and tell it do display itself.

You have a choice as to what INodeView will talk do. You can have a form/control registered for each of the different type. For example a INodeViewText, INodeViewImage, etc. Or just one omnibus INodeViewForm and let the object implementing INodeView take care of the actual drawing.

Depending on your GUI toolkit this could mean that one form could be implementing a lot of different interfaces.

As for adding, deleting, and creating nodes, this would be done through the interaction between the form implementing INodeTreeForm and NodeTreeScreen. Among the things this will be doing is executing the commands you already created to modify the model.

By implementing every thing behind an interface you can change the implementation without screwing up the rest of the software. The object implementing the different interfaces can change without impacting the other objects as long as they continue to implement the interfaces correctly.

This is a variant of Passive View on Martin Fowler's site.

# wpf - xaml 如何引用动态资源而不是作为属性而是作为元素

> ID：627632
> 
> 赞同：3
> 
> 时间：2009-03-09T19:16:23.893
> 
> 标签：wpf, silverlight, xaml

我有一张图片需要在我的应用程序中的几个地方使用。我想在资源字典中只定义一次图像，并让我的其他 xaml 文件只是那个定义。我可以 我无法弄清楚的一件事是如何引用定义为 xaml 元素而不是 xaml 属性内部的属性的东西。

这是我的资源字典

```
# resourceDictionary.xaml

<LinearGradientBrush x:Key="MyGradient" StartPoint="0,0.5" EndPoint="1,0.5">
    <GradientStop Color="#A5000000" Offset="0"/>
    <GradientStop Color="#00000000" Offset="1"/>
</LinearGradientBrush>

<Image x:Key="MyImage" Source="MyGlyph.png" Width="20" Height="20" /> 
```

所以在我的 xaml 中，我知道如何将渐变引用为控件对象的属性

```
<TextBlock Text="Sample Text" Background="{DynamicResource MessageGradient}"/> 
```

但是我想弄清楚他如何引用一个完整的控制对象的图像。此示例仅创建一个按钮，按钮中包含文本“{DynamicResource MyImage}”而不是图像。

```
<!-- Want MyImage to be content of the button -->
<Button>
   {DynamicResource MyImage}
</Button> 
```

有没有一种简单的方法可以做到这一点，或者我必须创建一个只包含我的图像的控件模板，然后在我的 xaml 中有一个使用控件模板的图像标签？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-09T19:34:19.123

由于您希望图像成为按钮的内容，因此您应该能够将其绑定到`Content`属性：

```
<Button Content="{DynamicResource MyImage}" /> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-10-17T09:46:20.640

```
<!-- Want MyImage to be content of the button --> 
<Button> 
   <DynamicResource  ResourceKey="MyImage"/>
</Button> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T19:51:05.730

如果您尝试将图像作为任何控件的背景

```
 <Button  Content="My Button">
        <Button.Background>
            <ImageBrush   ImageSource="MyGlyph.png"/>
        </Button.Background>
    </Button> 
```

# flash - Flash 8 FileReference 和文件完整性检查

> ID：627640
> 
> 赞同：0
> 
> 时间：2009-03-09T19:21:21.043
> 
> 标签：flash, actionscript, filereference

Flash 8 FileReference API 使您可以定期检查正在传输的字节数：

```
listener.onProgress = function(file:FileReference, bytesLoaded:Number, bytesTotal:Number):Void {
    trace("onProgress with bytesLoaded: " + bytesLoaded + " bytesTotal: " + bytesTotal);
} 
```

（更多信息[在这里](http://livedocs.adobe.com/flash/8/main/wwhelp/wwhimpl/common/html/wwhelp.htm?context=LiveDocs_Parts&file=00002204.html)和[这里](http://livedocs.adobe.com/flash/8/main/wwhelp/wwhimpl/common/html/wwhelp.htm?context=LiveDocs_Parts&file=00002204.html)）

如果上传，**您是否建议使用此方法检查上传文件的完整性**？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-09T20:00:49.733

只需收听 onComplete 事件即可检查文件何时正确上传。如果到目前为止没有引发错误事件，则该文件*应该*在服务器上。

如果您不想相信 FlashPlayer 已发布文件的*完整性*（例如，您的服务器未能将其从 /tmp 文件夹中移出等），则可能需要采取一些措施来确保该过程正确完成：

*   检查文件大小（最好是校验和，但不要认为你能得到那个）客户端。
*   在文件上传请求中发布此信息。
*   收到 post 数据后，在服务器端从接收到的文件中收集相同的信息（大小、校验和），并将其与客户端生成的信息进行比较。
*   发回状态（失败/成功）

...除非您的应用程序非常明智，否则我会跳过这个，只是因为它可能会产生比您根本没有任何完整性检查更多的问题:)

更好：根据您发送的文件，您可能能够找到一个服务器脚本来检查文件是否正常，并根据该文件返回一个状态。

# c++ - TR1 共享数组

> ID：627641
> 
> 赞同：15
> 
> 时间：2009-03-09T19:22:25.363
> 
> 标签：c++, boost, tr1

我很难在 TR1 文档中找到有关共享数组的参考资料。Boost 文档非常清楚 C++“new”和“new[]”表达式之间存在显着差异。shared_ptr 模板旨在正确保存指向使用“new”创建的动态分配对象的指针。shared_array 模板旨在使用“new[]”正确保存指向动态分配数组的指针。

我正在更新一些代码以使用 TR1 shared_ptr 模板和相关函数，但我发现没有提到 shared_array。TR1 shared_ptr 实现是否区分“new”和“new[]”，并正确销毁这些指针？据我从 TR1 规范中可以看出，它似乎没有。如果是这种情况，我是否仍应将 boost shared_array 模板用于“new[]”样式分配？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-09T19:31:21.237

没错，TR1 中没有 shared_array。

但是，如果您希望使用此构造函数，可以提供自己的删除器对象来执行“删除 []”：

```
template<class Other, class D>
   shared_ptr(Other* ptr, D dtor); 
```

例如：

```
template<typename T>
struct my_array_deleter
{
   void operator()(T* p)
   {
      delete [] p;
   }
};

shared_ptr<int> sp(new int[100], my_array_deleter<int>()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T19:32:21.547

我怀疑大多数使用 TR1 的人不使用数组，而是使用 vector<> 代替。

没看过TR1，所以我就在Boost的基础上回答，大概够用了。boost::shared_ptr<> 处理单个对象，而不是数组。这就是 boost::shared_array<> 的用途。

如果您正在使用数组，并且有理由转换为 shared_array<> 而不是 vector<>，请使用 shared_array<>。

# apache-flex - Flash/Flex 应用程序中的鼠标滚轮

> ID：627645
> 
> 赞同：1
> 
> 时间：2009-03-09T19:23:16.610
> 
> 标签：apache-flex, scroll, mouse, scrollbar

我正在 Flex 中构建一个应用程序，但我的滚动窗口很少。当我尝试使用鼠标滚轮时，窗口不会向上/向下滚动。另外，如果可以使窗口向上/向下滚动，那么是否可以向右/向左滚动。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T21:08:06.293

在 as3 中有一个 mouseevent.mouse_wheel 事件。监听这个将产生属性增量。delta 属性会告诉您鼠标滚轮是向上还是向下滚动。不幸的是，这不适用于 mac。幸运的是，有一些课程 [互联网] 可以解决这个问题。关于第二位，左右，我想你可以利用上/下运动来左右移动滚动条，但我不认为那是你的追求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-19T15:41:59.400

正确的。这个人让这成为可能。一些例子和解释：[http ://blog.pixelbreaker.com/flash/as30-mousewheel-on-mac-os-x/](http://blog.pixelbreaker.com/flash/as30-mousewheel-on-mac-os-x/)

# reporting-services - 如果行中表示的字段为空，则隐藏 .NET rdlc 报告中的表行？

> ID：627647
> 
> 赞同：1
> 
> 时间：2009-03-09T19:25:05.607
> 
> 标签：reporting-services, .net-2.0

> **可能重复：**
> [如何在 RDLC 中折叠一行而不是隐藏它？](https://stackoverflow.com/questions/7489357/how-to-collapse-a-row-in-rdlc-rather-than-just-hide-it)

我看到了 tablerow.Visibility 属性和另一个名为“ToggleItem”的属性，但不知道如何使它工作。如果只有文本字段（在本例中为用户评论字段）为空，我想动态隐藏 tablerow。'CanShrink' 似乎不能胜任这项工作。

表格行高 0.25 英寸，即使没有要显示的数据，它也会占用这么多空间。因此，我最终在报告的每一行之间有 0.25 英寸的差距。

我正在使用带有内置 rdlc 报告功能的 Visual Studio 2005。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-09T19:34:08.487

只需将 Hidden 属性设置为 True 或 False 或某个表达式。

```
= (Fields!UserComment.Value.ToString() = "") 
```

请参阅[表达式示例 (Reporting Services)](http://msdn.microsoft.com/en-us/library/ms157328.aspx#Properties)

# c# - 在 foreach 循环中从 WCF 异步方法获取数据

> ID：627649
> 
> 赞同：0
> 
> 时间：2009-03-09T19:25:41.923
> 
> 标签：c#, wcf, asynchronous

在下面的代码中，我有一个 List 对象。我想遍历每一个并为每个 Item 对象上的属性之一分配一个值。要获取该值，我需要调用 WCF 服务的异步方法。

当对我的 WCF 服务的调用完成时，我如何获取该数据并将其分配给 itemsList 中的当前实例 (i)？有没有办法从我的 xxxCompleted 事件中访问 i？

```
private void SomeMethod()
{
    List<Item> itemsList = GetItems();

    foreach(Item i in itemsList)
    {  
      MyClient client = new MyClient();
      client.GetSomeValueCompleted += client_GetSomeValueCompleted;
      client.GetSomeValueAsync(i.ID);
    } 
}   

private void client_GetSomeValueCompleted(object sender, GetSomeValueEventArgs e)
{
  int id = e.Result;
  //  how do I assign this ID to my itemsList object, i  ???
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T19:52:10.797

您可以将 MyClient 类的实例作为用户状态传递给异步方法调用。

看看这个[链接](http://www.danrigsby.com/blog/index.php/2008/03/18/async-operations-in-wcf-event-based-model/)

```
 private void SomeMethod()
{    
   List itemsList = GetItems();    
   foreach(Item i in itemsList)    
   {        
      MyClient client = new MyClient();      
      client.GetSomeValueCompleted += client_GetSomeValueCompleted;      
      **client.GetSomeValueAsync(i.ID, client);**
   } 
}   

private void client_GetSomeValueCompleted(object sender, GetSomeValueEventArgs e)
{  
   int id = e.Result;  

   //  how do I assign this ID to my itemsList object, i  ???
   **(e.UserState as MyClient).ID = id;**
} 

```

# sharepoint - 获取 SPWeb 的所有网页和在 Sharepoint 中具有具有值的字段的子网站？

> ID：627652
> 
> 赞同：1
> 
> 时间：2009-03-09T19:27:02.840
> 
> 标签：sharepoint, sharepoint-2007

我在 Sharepoint 2007 中有一个网站。我想查询其中网页的“主页”字段在一个特定的 SPWeb 和（这是重要的部分）它的子 SPweb 中等于 1。我可以在有问题的网站而不是子网站上进行这项工作。也就是说：它不是递归的，但我在“webs scope='recursive'”子句中指出了它。

我还包括我想使用的列表，也就是说，页面（不是文档、母版页或其他）这是我寻找“850”基本模板（用于页面的模板）的原因。

我正在使用的代码是这样的（我尝试过使用相同查询的其他方法，结果是相同的）：

> ```
>  string campo="home";
>   SPSiteDataQuery qry = new SPSiteDataQuery();
> 
>                   qry.Query = "<Where><Eq><FieldRef Name='";
>                   qry.Query += campo + "'/><Value 
> ```

```
Type='Boolean'>1</Value></Eq>"; 
```

> ```
>  qry.Query += "</Where><OrderBy><FieldRef 
> ```
> 
> 名称='修改'升序='假'> />";

```
 qry.Webs = "<Webs Scope='Recursive'/>"; 
```

> ```
>  qry.ViewFields = "<FieldRef Name='Title'/><FieldRef 
> ```
> 
> 名称='修改'/>";
> 
> ```
>  //this gives me system privileges
>                   using (SPSite site = new SPSite(CurrentSite.ID, 
> ```
> 
> GetSystemToken(CurrentSite))) {
> 
> ```
>  using (SPWeb web = site.OpenWeb("/News/"))
>                       {
> 
>                           StringBuilder sb = new StringBuilder();
> 
>                           sb.Append("<Lists>");
> 
>                           foreach (SPList list in web.Lists)
>                           {
> 
>                               if (list.BaseTemplate.ToString() == 
> ```
> 
> “850”）{
> 
> ```
>  sb.Append("<List ID=\"" + 
> ```
> 
> list.ID.ToString() + "\"/>");
> 
> ```
>  }
> 
>                           }
> 
>                           sb.Append("</Lists>");
>                           qry.Lists = sb.ToString();
> 
>                           dt = web.GetSiteData(qry);
> 
>                       .................. 
> ```

所以，我找到的唯一解决方案是通过网络在先例代码之后进行循环，但我认为这不是一种非常优化的方式：

```
 foreach (SPWeb w2 in web.Webs)
                              {
                                 sb = new StringBuilder();
                                      sb.Append("<Lists>");
                                      foreach (SPList list in w2.Lists)

                           {
                                              if (list.BaseTemplate.ToString() 
== "850")
                                              {

      sb.Append("<List ID=\""
     + list.ID.ToString() + "\"/>");
                                              }
                                          }

                                      sb.Append("</Lists>");
                                              qry.Lists = sb.ToString();

                                          DataTable dttmp = w2.GetSiteData(qry);
                                          if (dttmp != null
 && dttmp.Rows.Count > 0)
                                          {
                                              dt.Merge(dttmp);
                                          }

                                  w2.Dispose();
                              } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T09:39:08.283

最后我做了以下事情，我不知道最后有什么效果，我改变了我询问列表的方式，我已经包括了 RowLimit：

数据表 dt = null; 数据视图 dv = null;

```
 SPSiteDataQuery qry = new SPSiteDataQuery();

    qry.Query = "<Where><Eq><FieldRef Name='";
    qry.Query += campo + "'/><Value Type='Boolean'>1</Value></Eq>";
    qry.Query += "</Where><OrderBy><FieldRef Name='Modified' Ascending='false' /></OrderBy>";
    qry.Webs = "<Webs Scope='Recursive'/>";
    qry.Lists = "<Lists ServerTemplate='850' Hidden='FALSE' MaxListsLimit='50'/>";
    qry.RowLimit = 3;

    qry.ViewFields = "<FieldRef Name='Title'/><FieldRef Name='Modified'/><FieldRef Name='FileRef'/>";

    using (SPSite site = new SPSite(CurrentSite.ID, GetSystemToken(CurrentSite)))
    {
        using (SPWeb web = site.OpenWeb(webUrl))
        {   
            dt = web.GetSiteData(qry);

            dv = dt.DefaultView;

        }
    }

    return dv; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T20:07:51.290

您谈论将 webs 范围设置为递归，但在您的（格式错误的）示例代码中，您将 webs 属性留空，这意味着站点数据查询将仅通过指定的 web.xml 进行搜索。

代码的这个特定（省略）细节*非常*重要，因为在 innerXML 规范中即使是最轻微的拼写错误也会默默地将行为恢复为默认值，这意味着只会搜索当前的 Web。一个典型的陷阱是在 Webs 或 Scope 中的大小写错误。

作为记录，指定它的正确方法是

```
qry.Webs = "<Webs Scope='Recursive' />"; 
```

作为快速检查，您可以尝试将范围设置为 SiteCollection，看看是否有效。

**[编辑]**同意，现在您的 Webs 属性显示它看起来不错:-)。您是否尝试在 Campo 字段的 fieldref 中设置 Nullable='TRUE' 属性？如果任何子站点中不存在（或损坏或其他）该字段，这可能会有所帮助。**[/编辑]**

# iphone - 原生可可触控 iPhone 应用程序中的 Google Adsense

> ID：627653
> 
> 赞同：1
> 
> 时间：2009-03-09T19:27:14.773
> 
> 标签：iphone, cocoa-touch

我计划中的 iphone 应用程序将非常努力地运行远程 https Web 服务，因此在用户决定从我的应用程序的免费版升级到专业版之前，我需要为每个免费用户产生少量点击收入。

我想在原生可可触控 iPhone 应用程序中嵌入单行 Adsense 小部件。我想到的 UI 控件可能不存在，但会像这样工作。该控件将占据我的应用程序默认视图的固定部分，并由我的代码初始化并提供由我的应用程序确定的关键字。然后，该控件会定期 ping Google 的 adsense 系统并显示一个可点击的广告链接。

如果用户对链接感兴趣，点击会导致我的应用程序退出，然后在 Safari 中打开广告商的链接。

以前有过这样的事情吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T19:42:15.830

您必须使用带有 Adsense 单元的 UIWebView。我认为当您设置广告单元时，您可以输入关键字。
不过，这很可能违反了他们的条款。尝试使用[http://www.admob.com/](http://www.admob.com/)之类的其他内容可能是一个更好的主意。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T21:09:01.580

Since AdSense requires the content of the page it's on to serve up relevant ads, you're likely to get nothing but PSA ads, since Google can't crawl your app.

And like Isaac says, I'm sure it's against the AdSense terms.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-23T18:56:39.410

Google 的 Mobile Adsense 正在运行：

[TechCrunch 文章](http://www.techcrunch.com/2009/06/24/googles-mobile-adsense-for-iphone-and-android-apps-now-in-public-beta/)

# c# - 在 C# 中使用反射确定参数是否使用“参数”？

> ID：627656
> 
> 赞同：27
> 
> 时间：2009-03-09T19:29:41.633
> 
> 标签：c#, .net, reflection, params

考虑这个方法签名：

```
public static void WriteLine(string input, params object[] myObjects)
{
    // Do stuff.
} 
```

如何确定 WriteLine 方法的“myObjects”参数使用 params 关键字并且可以采用可变参数？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-03-09T19:30:54.203

检查`[ParamArrayAttribute]`它的存在。

with 的参数`params`将始终是最后一个参数。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-03-09T19:33:03.340

检查[ParameterInfo](http://msdn.microsoft.com/en-us/library/system.reflection.parameterinfo.aspx)，如果[ParamArrayAttribute](http://msdn.microsoft.com/en-us/library/system.paramarrayattribute.aspx)已应用于它：

```
static bool IsParams(ParameterInfo param)
{
    return param.GetCustomAttributes(typeof (ParamArrayAttribute), false).Length > 0;
} 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2016-12-14T19:27:20.280

一种更短且更易读的方式：

```
static bool IsParams(ParameterInfo param)
{
    return param.IsDefined(typeof(ParamArrayAttribute), false);
} 
```

# perl - 如何从 Perl 输出 UTF-8？

> ID：627661
> 
> 赞同：121
> 
> 时间：2009-03-09T19:30:50.427
> 
> 标签：perl, unicode, utf-8

我正在尝试使用`utf8`编译指示编写 Perl 脚本，但得到了意想不到的结果。我正在使用 Mac OS X 10.5 (Leopard)，并且正在使用 TextMate 进行编辑。我的编辑器和操作系统的所有设置都默认为以 utf-8 格式写入文件。

但是，当我在文本文件中输入以下内容，将其保存为“.pl”并执行它时，我会得到友好的“带问号的菱形”来代替非 ASCII 字符。

```
#!/usr/bin/env perl -w

use strict;
use utf8;

my $str = 'Çirçös';
print( "$str\n" ); 
```

知道我做错了什么吗？我希望在输出中得到“Çirçös”，但我得到的是“ir��s”。

* * *

## 回答 #1

> 赞同：169
> 
> 时间：2009-03-09T19:34:08.360

`use utf8;`不启用 Unicode*输出*- 它使您可以在程序中键入 Unicode。将此添加到程序中，在您的`print()`声明之前：

```
binmode(STDOUT, ":utf8"); 
```

看看是否有帮助。那应该`STDOUT`以 UTF-8 而不是普通的 ASCII 输出。

* * *

## 回答 #2

> 赞同：87
> 
> 时间：2009-03-09T20:47:57.357

您可以使用[open pragma](http://perldoc.perl.org/open.html)。

例如。下面将 STDOUT、STDIN 和 STDERR 设置为使用 UTF-8....

```
use open qw/:std :utf8/; 
```

* * *

## 回答 #3

> 赞同：72
> 
> 时间：2009-04-21T13:02:51.090

[TMTOWTDI](http://www.perlfoundation.org/perl5/index.cgi?tmtowtdi)，选择最适合您工作方式的方法。我使用环境方法，所以我不必考虑它。

在[环境中](http://perldoc.perl.org/perlrun.html#PERL_UNICODE)：

```
export PERL_UNICODE=SDL 
```

在[命令行](http://perldoc.perl.org/perlrun.html#*-C-[_number/list_]*)上：

```
perl -CSDL -le 'print "\x{1815}"'; 
```

或使用[binmode](http://perldoc.perl.org/functions/binmode.html)：

```
binmode(STDOUT, ":utf8");          #treat as if it is UTF-8
binmode(STDIN, ":encoding(utf8)"); #actually check if it is UTF-8 
```

或使用[PerlIO](http://perldoc.perl.org/PerlIO.html)：

```
open my $fh, ">:utf8", $filename
    or die "could not open $filename: $!\n";

open my $fh, "<:encoding(utf-8)", $filename
    or die "could not open $filename: $!\n"; 
```

或使用[开放式编译指示](http://perldoc.perl.org/open.html)：

```
use open ":encoding(utf8)";
use open IN => ":encoding(utf8)", OUT => ":utf8"; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-08-12T08:33:07.597

您还想说，您的代码中的字符串是 utf-8。请参阅[为什么现代 Perl 默认避免使用 UTF-8？](https://stackoverflow.com/questions/6162484/why-does-modern-perl-avoid-utf-8-by-default). 所以不仅要设置`PERL_UNICODE=SDAL`，还要设置`PERL5OPT=-Mutf8`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-02T03:57:40.083

谢谢，终于找到了一个解决方案，不要把 utf8::encode 全部放在代码上。用于其他情况的合成和完成，例如在 utf8 中写入和读取文件，并且还可以与 utf8 中的 YAML 文件的 LoadFile 一起使用

```
use utf8;
use open ':encoding(utf8)';
binmode(STDOUT, ":utf8");

open(FH, ">test.txt"); 
print FH "something éá";

use YAML qw(LoadFile Dump);
my $PUBS = LoadFile("cache.yaml");
my $f = "2917";
my $ref = $PUBS->{$f};
print "$f \"".$ref->{name}."\" ". $ref->{primary_uri}." "; 
```

其中 cache.yaml 是：

```
---
2917:
  id: 2917
  name: Semanário
  primary_uri: 2917.xml 
```

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2009-03-09T19:43:14.003

在你的 shell 中做： $ env |grep LANG

这可能表明您的 shell 没有使用 utf-8 语言环境。

# asp.net - Asp.net Cookie 域/范围

> ID：627670
> 
> 赞同：2
> 
> 时间：2009-03-09T19:33:40.610
> 
> 标签：asp.net

我有一个非常适合我的“cookie”处理程序/实用程序类。它抽象了很多我在处理 cookie 时让我发疯的问题，例如如何处理响应（写入）操作，然后在同一回发中处理请求（读取）操作，如何处理加密等。

让我感到困惑的一件事是如何将我的 cookie 隔离在不同的“虚拟”域中。我的应用程序都在具有相同主机/服务器名称的 Intranet 环境中运行：

[http://server/app1/](http://server/app1/)

[http://server/app2/](http://server/app2/)

如果它们使用相同的名称，我不希望这些不同的应用程序共享 cookie 值。请求/响应对象的方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-09T19:37:19.710

将 的`Path`属性设置`Cookie`为`/app1`或`/app2`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T19:41:24.490

```
Response.Cookies["CookieName"].Path= "/app1"; 
```

() 而不是 [] 如果您使用的是 VB 语法。

# c - 在 C 程序中使用 sed 等效项

> ID：627676
> 
> 赞同：2
> 
> 时间：2009-03-09T19:35:15.037
> 
> 标签：c, string, sed

我有一个字符串输入到我的程序的形式：

骗子*.cc

我希望它代表正则表达式 con.*.cc。

如何在 C 程序中执行此操作？我可以使用类似 sed 的东西吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T19:42:56.140

我猜你真的只是想要[globbing](http://en.wikipedia.org/wiki/Glob_(programming))而不是完整的正则表达式。如果你在 Linux 下运行，你可以使用[glob](http://www.gnu.org/software/libtool/manual/libc/Globbing.htm)函数。我想有一种更便携的方法，但我不知道有一种方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T19:41:59.513

您可以使用[PCRE](http://www.pcre.org/)来匹配正则表达式。实际表达式可以存储为 char 数组（与任何其他字符串一样）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T19:43:21.037

你到底想用那个正则表达式做什么？假设您想要对代码中已有的一组字符串进行搜索，您将需要使用正则表达式库。C 本身不支持正则表达式。查阅 gcc 手册 -[此处](http://www.gnu.org/software/libtool/manual/libc/Regular-Expressions.html)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-10T10:25:42.210

[此页面](http://linux.die.net/man/3/regex)描述了 <regex.h> 标头，它实现了对 C 的 POSIX 正则表达式支持。要使用它，您只需执行以下操作：

```
#include <sys/types.h>
#include <regex.h> 
```

它们相当不错且易于使用，但正如@Chickencha 在另一个答案中所说，看起来您只是在查找文件名，而不是进行真正的正则表达式匹配。只是想我会指出 C 确实支持正则表达式，因为没有人支持。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-09T20:24:12.593

在您的程序中使用 sed：

1.  叉（）
2.  在子进程中设置标准输入/标准输出
3.  exec(sed s/X/Y/) 在孩子（或任何你想要的操作）
4.  parent 将数据推入 sed，从 sed 中读取数据
5.  完成后，父母会收获 sed

# project-planning - 寻找“规范”项目的好方法

> ID：627677
> 
> 赞同：0
> 
> 时间：2009-03-09T19:35:35.923
> 
> 标签：project-planning

我注意到在编写规范时你会浪费很多时间在事情上，后来，当你编写你的应用程序时可以忽略不计，你会忘记一些重要的东西。
我发现（对我来说）编写一个概念验证应用程序（没有好的错误处理程序和安全性东西，风格上的小故障等）并将其用作加入我的人的规范会更快（对我来说）。

不过，我觉得我也在这种方法上浪费时间，关于如何做到这一点有什么好的想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T19:37:56.947

Joel On Software 有[一篇](http://www.joelonsoftware.com/articles/fog0000000033.html)关于此的文章，您可能会觉得有帮助。我认为这个问题和答案是相当用户特定和主观的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T19:51:39.083

好像你在争论支持[敏捷开发](http://www.objectmentor.com/omSolutions/agile_why.html)

使用这个迭代过程，我们的团队能够根据重要性对功能进行“排名”，然后权衡发布日期和他们想要的功能（简而言之）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-09T19:59:05.773

一个有趣的规范方法是“测试”。对于高层次的东西，你使用[Fitnesse](http://fitnesse.org)之类的工具编写验收测试，对于低层次的东西，你编写单元测试。

开发人员完成编码后，运行测试套件会验证所有规范是否确实有效。

这种方法期望编写规范的人能够用测试来表达自己。这通常是不正确的，因此这种方法更像是一个乌托邦。但是，您仍然可以尝试一下。

# c# - 如何获取已编译资源的路径？

> ID：627680
> 
> 赞同：0
> 
> 时间：2009-03-09T19:36:41.850
> 
> 标签：c#, .net, resources

我在我的项目中包含了一个可执行文件（即，当您在 VS2008 的解决方案资源管理器中展开该项目时，您会看到它以及所有其他类）。这个可执行文件需要由我的程序启动。如何以编程方式检索其路径？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T19:46:39.983

我以前从未使用可执行文件这样做过...但是，如果它是嵌入式资源，则可以枚举应用程序中的嵌入式资源列表（或直接按名称引用），当您找到合适的资源时，请编写它到磁盘，然后执行它。

提取：

```
Assembly assembly = Assembly.GetExecutingAssembly();
using (Stream stream = assembly.GetManifestResourceStream("resource name")
{
  using FileStream fs= new FileStream("executable name")
  {
    byte[] buffer = new byte[32*1024];
    int bytesRead;
    while ((bytesRead= stream.Read(buffer, 0, buffer.Length)) > 0)
    {
      fs.Write(buffer, 0, bytesRead);
    }
  }
} 
```

执行：

```
using System.Diagnostics;

Process someProc;
someProc= Process.Start("executable name"); 
```

正如 Daniel L 指出的那样，不要忘记将资源标记为“嵌入式资源”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T19:40:36.660

下面是从文本资源中获取文本的示例：

```
Assembly assembly = Assembly.GetExecutingAssembly();
Stream stream = assembly.GetManifestResourceStream("ResourceTextFileName");
StreamReader textStreamReader = new StreamReader( stream ); 
```

希望你能收集到如何用这个来做一个可执行文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T19:41:27.593

如果将可执行文件与项目一起部署到同一个文件夹，则可以使用 Environment 类来获取可执行文件的工作目录。那将是：Environment.CurrentDirectory。

您可以在解决方案资源管理器中将可执行文件的“复制到输出目录”属性设置为“始终复制”或“如果较新则复制”以完成此操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T20:12:20.623

这不完全是您所要求的，但在使用其他人发布的建议之一时可能很有用：

请注意，如果您的应用程序是 Windows 窗体应用程序，并且最终安装在 C:\Program Files... 如果启动应用程序的用户未以管理员身份运行，则您可能没有对应用程序文件夹的写入权限。

如果您想“提取”嵌入式资源并将其保存到与您的应用程序相同的文件夹中的磁盘，这可能是一个问题。

我会推荐：

1.  不将 .exe 作为资源嵌入。只需将其复制到输出目录设置为始终。然后将其与您的主 .exe 一起部署

2.  将其作为资源嵌入，但在将其保存到磁盘时，使用 Windows 临时文件夹（如果它只是一次性的）或用户的数据文件夹（C:\Documents and Settings\[user]\Application Data）

您可以获得当前操作系统的正确文件夹，如下所示：

```
// for the Windows temp folder
Path.GetTempPath() 

// for the user's application data folder
Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData)) 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-03-09T19:40:40.060

您可以使用`Assembly`该类-

```
Assembly.GetExecutingAssembly().Location 
```

应该指向您正在运行的应用程序。使用该路径，去掉 .EXE 并添加可执行文件的文件名。

```
string filename = Assembly.GetExecutingAssembly().Location;
filename = filename.Substring(0, filename.LastIndexOf("\\") + 1);
filename += "my_exe_name.exe";
Process.Start(filename); 
```

但是请注意，这不适用于 web 应用程序，因为 Location 属性可能指向随机位置，例如 GAC。

# c# - 有时连接的 CRUD 应用程序 DAL

> ID：627687
> 
> 赞同：4
> 
> 时间：2009-03-09T19:38:04.543
> 
> 标签：c#, winforms, linq, data-access-layer

我正在开发一个有时连接的 CRUD 应用程序，该应用程序将主要由社会工作者和护士团队 (2-4) 使用，以计划的形式跟踪患者信息。该应用程序是在我之前创建的 ASP.Net 应用程序的重新可视化。4 个数据库中大约有 200 个表。Web App 版本严重依赖 SP，但由于此版本是一个 winform 应用程序，它将指向本地数据库，我认为没有理由继续使用 SP。另外值得注意的是，我曾计划使用合并复制来处理同步部分，这两者似乎存在一些问题。

我试图了解 DAL 使用什么方法。我最初计划使用 LINQ to SQL，但我读过一些花絮，说明它在有时连接的设置中不起作用。因此，我一直在尝试阅读和尝试多种解决方案；SubSonic、NHibernate、实体框架。这是一个相对简单的应用程序，并且由于“迫在眉睫”的版本 3 重新设计，这项工作可能是临界“一次性”。这里的重点是尽快启动和运行桌面版本。

我在这里要问的是任何有任何使用这些技术（或我没有列出的技术）经验的人来借给我你来之不易的智慧。在你看来，我最好的方法是什么？关于创建此类应用程序的任何其他见解？我真的在为这个程序的 DAL 部分苦苦挣扎。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-18T16:12:24.393

如果存储过程执行您希望它们执行的操作，我不得不说我怀疑您是否会通过丢弃它们并重新实现它们来获得好处。此外，在将数据复制回主数据库时，是否使用存储过程或 LINQ to SQL 样式的数据访问并不重要，因此担心使用哪个 DAL 似乎是一个红鲱鱼。

有时连接的应用程序的棘手部分是提出一个好的冲突解决系统。我的建议：

*   始终使用 RowGuids 作为表的主键。如果您始终拥有唯一键控的新记录，则合并复制效果最好。
*   意识到合并复制只能做这么多：它*非常*适合将不同系统中的新数据整合在一起。它甚至可以找出单方面的更新。它*不能*神奇地确定你的新记录和我的新记录*实际上是一样的*，也不能在没有人为干预或优先规则的情况下真正处理双方的变化。
*   因此，您将需要“匹配”规则来解析声称是新的但实际上不是的记录。请注意，这是一个模糊的步骤：您很少能依靠唯一的密钥在双方都输入完全相同且没有错误。*这意味着在您的许多*指标相同或相似的情况下进行加权匹配。
*   用于解决冲突并将“新”记录与原始记录匹配的用户界面需要易于操作。我使用的东西看起来类似于许多源代码控制系统使用的经典三路合并：记录 A、记录 B、合并记录。他们可以通过单击标题按钮将合并记录默认为 A 或 B，也可以通过单击它们来选择每个字段。最后，Merged Records 字段可供编辑，因为有时您需要从 A*和*B获取部分地址（例如）。

这些都不会对您的数据访问层产生丝毫影响：这都是比您的 DAL 更低级别（合并复制，由数据库本身提供）或更高级别（冲突解决，由您的业务规则提供用于解决）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T19:44:42.283

如果您可以在本地安装数据库系统，请选择您熟悉的东西。我认为最大的问题是同步和合并部分。您必须考虑几种可能性： 更改了其他人在服务器上删除的内容。谁来决定？

自己从来没有用过 Sync 框架，只是看了一篇文章。但这可能会给你一个坚实的基础。但是，无论您采用哪种方式访问​​数据，业务逻辑的解决方案都可能会产生更广泛的影响......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-10T00:33:23.757

微软在 2004 年推出了一个名为 issueVision 的示例应用程序。
[http://windowsclient.net/downloads/folders/starterkits/entry1268.aspx](http://windowsclient.net/downloads/folders/starterkits/entry1268.aspx)

在 joelonsoftware.com 的旧线程上找到链接。 [http://discuss.joelonsoftware.com/default.asp?joel.3.25830.10](http://discuss.joelonsoftware.com/default.asp?joel.3.25830.10)

其他想法...
移动宽带呢？明天可以使用几张 3G 蜂窝卡，您的应用无需更改大页面/图形。

现场使用的 Excel 电子表格。DTS 或 SSIS 将数据导入应用程序。虽然创建了“更好”的解决方案。

祝你好运！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-17T15:14:55.637

如果您所说的 SP 是指存储过程……我不确定我是否理解您试图摆脱它们的原因。考虑到它们快速、经过验证并且已经为您编写（即经过测试）。

当然，如果您正在制作一个模仿原始代码的应用程序，那么保留尽可能多的原始（工作）代码库肯定有好处 - 其中最不重要的是速度。

我会尝试安装数据库的本地副本，然后在连接时将自上次连接期间以来的所有受影响记录推送到主数据库。

# sorting - 用于按多列对表格进行排序的用户界面

> ID：627696
> 
> 赞同：8
> 
> 时间：2009-03-09T19:41:21.183
> 
> 标签：sorting, user-interface

我需要一个用户界面，允许用户根据多列对表格进行排序（例如按颜色排序，然后按颜色排序，或者按价格排序，然后按价格排序）。我熟悉的唯一这样的界面是在 Excel 中的 data > sort 下找到的对话框，但这相当笨重，并且不能在视图之间快速切换。我更喜欢 iTunes 风格的界面，它允许通过单击列标题进行快速排序。然而，这样的界面通常只允许按一列排序（iTunes 本身有一个非常有限的、显然是硬编码的能力，可以通过单击专辑标题按“按艺术家的专辑”和“按年份的专辑”进行排序）。

我可以设想一个界面，其中每个列标题都有一些数字，例如单击 1 使列成为主排序键，单击 2 成为辅助键，依此类推。或者，在列标题上单击（或右键单击）可能会出现一个带有“初级排序”、“二级排序”等的下拉菜单。但是，我从未见过这样的接口实现，而且我没有对可能出现的可用性问题有很好的直觉。

是否有允许使用列标题按多列排序的应用程序？你能指点我这些吗？关于这些接口是否有任何有用的可用性结果——哪个效果更好，哪个效果更差？

此外，虽然我对接口的规范最感兴趣，但任何传递给实现它的人的提示都会受到赞赏，例如提供部分解决方案（尤其是 Java）的公开可用的库。

编辑：有两个人建议使用 Excel 样式的对话框。这是行不通的。对于我的应用程序，用户需要在现有表条目中找到“最佳匹配”（通常不是完美匹配）。表格太大了，记不住，所以需要不断扫描相关部分，重复排序表格以获得多个视图很有用。每次改变视图都必须通过一个包含多个选项的对话框，这太慢了；当您完成该框时，您已经忘记了前一个视图的结果。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-09T20:12:16.723

我在一些应用程序中看到了 caparcode 提到的 shift-click 界面，但是我现在无法命名。 [这是一个很好的基于网络的例子。](http://tablesorter.com/docs/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-09T19:50:55.700

我认为 Outlook 支持按多列排序。单击列标题后，您可以按住 shift 单击其他列标题。我不再使用 Outlook，因此无法验证这一点。希望这将是您的起点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-09T20:29:39.240

我建议使用 Ctrl-Click（或 Shift-click 或其他单击）方法让用户选择多个列。在没有 Ctrl 的情况下单击只会按选定的列排序，但按住 Ctrl 键会将该列添加到排序器中。再次单击会改变方向。[并提供与这些图片类似](http://bbsinc.biz/articles/jtables.html)的有关当前分拣机的反馈。大多数时候，无论如何用户只会使用单列排序器，只有高级用户才会想要按多列排序。但是你应该在手册和“你知道”的事情中以某种方式记录行为。

但是由于[用户不阅读](http://www.joelonsoftware.com/uibook/chapters/fog0000000062.html)，因此存在没有人会发现该功能的风险。但是为此，您可能会在第一次开始时拥有像 Windows 这样的功能，希望您单击一次开始按钮以确保您找到该按钮。当您看到用户根本不使用排序器时，请告诉他单击列标题将进行排序。稍后，当您看到他没有使用多重排序功能时，一旦该功能存在，就向他展示。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-09-01T21:19:00.410

像 Excel 那样做，或者更确切地说，像真正的人使用 Excel 那样做，这几乎从不涉及你理所当然希望避免的那个笨重的对话框。基本上，Excel 会尽可能多地保留您当前的排序顺序 - 因此，如果您当前按价格降序排序，现在按颜色排序（使用工具栏上的 A 到 Z 按钮，而不是对话框)，颜色内的价格将保持降序排列。

这种方法确实需要用户进行一些逆向思考，因为您首先按最不重要的列进行排序，但是一旦获得它就非常直观。（是的，我知道，这听起来自相矛盾，但我不知道还能如何形容它。）

要实现它，您必须将用户的排序历史存储在某处；但就界面而言，您所需要的只是每列中的一个向上箭头和一个向下箭头。或者，如果您只想允许 A 到 Z 排序，只需将列标题本身变成链接或按钮或其他任何内容。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-09T19:44:48.210

你看过Excel吗？这是一个关于如何对多列进行排序的完美示例。

此外，我有时会使用详细的列表视图，并让用户在选择一列或多列时按住 Ctrl 键对信息进行排序。（在列上单击两次进行降序排序。）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-09T20:04:00.113

说真的，你想要什么，Excel 可以。为什么不使用人们已经知道如何驾驶的界面。我会建议。否则你要么必须从第三方购买，要么自己动手。

VSTO（用于 Office 的 Visual Studio .NET 工具）促进了使用 Office 进行开发。您希望在 Excel 的生命周期内实现多少自动化 :)。可以办到。

事实上，这就是我必须做的。我必须阅读电子表格、提取数据、转换为对象，然后坚持到 Access（不要问）。每张纸代表一个记录，每个目录代表一个位置，你明白了。全部使用 Office PIA 互操作程序集完成。

只是一个想法。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-10T00:39:44.243

下面的呢？在表格顶部边缘标有“排序”的单个下拉列表。下拉列表列出了所有要排序的字段。每个字段出现两次，一次用于升序，一次用于降序。下拉菜单旁边是一个标有“更多”或可能只是“+”的按钮。用户从下拉列表中选择主排序键的字段。排序立即应用（没有“排序”命令按钮）。如果需要第二个排序键，则用户单击更多按钮，然后插入并打开另一个下拉列表供用户选择第二个键。连续点击更多按钮可以添加额外的低阶键。每个下拉菜单都包含一个“清除”项以删除一个键。

这为单个排序键的最简单和最常见的情况（不像 Excel 的排序对话框或列标题有数字）提供了一个紧凑、简单和整洁的 UI，同时还支持对不确定数量的键进行排序（再次不像 Excel 的排序对话框）。用户可以一目了然地看到排序顺序（与 Excel 不同，并且比列中的数字更容易）。它避免了最笨拙的对话框。

可点击的列标题是一个事实上的标准，与上述内容一起包含也是一个好主意。做 Outlook 和 Windows Explorer 所做的事情并从以前的排序顺序中创建较低顺序的键是一种很好的做法。因此，例如，如果表格按日期排序，而用户按类别排序，则表格首先按类别排序，然后按日期排序。因此，用户可以通过首先选择最低顺序的排序字段并进行处理来进行多顺序排序。然而，这种方法的可发现性很差，用户可能会发现“向后”工作是违反直觉的，因此应该补充一些类似下拉菜单和更多按钮的东西。依靠 shift 单击或 ctrl 单击同样存在可发现性问题。

# javascript - 无法删除在服务器上的 JavaScript 中设置的 cookie

> ID：627699
> 
> 赞同：5
> 
> 时间：2009-03-09T19:41:30.573
> 
> 标签：javascript, php, firefox, cookies

我正在尝试编写 PHP 代码来删除我域上的所有用户 cookie。

这是我得到的：

```
<?php
$domain = 'www.example.com';
$deleteExpiration = time() - 60*60*24*365*10; // 10 years ago
foreach (array_keys($_COOKIE) as $cookie) {
    setcookie($cookie, 0, $deleteExpiration, '/', $domain);
} 
```

[在http://www.example.com/delete_cookies.php](http://www.example.com/delete_cookies.php)上运行此代码会删除在服务器上设置的所有 cookie，但不会删除在 JavaScript 中设置的 cookie。

我使用 Firefox Cookies 对话框验证了有问题的 cookie 确实来自 (path=/; domain=www.example.com)。使用 Live HTTP 标头，我可以看到发送了以下标头：

```
Set-Cookie: CookieName=0; expires=Fri, 12-Mar-1999 19:36:15 GMT; path=/; domain=www.example.com 
```

所以我相信 setcookie 命令按预期工作。Firefox 只是不尊重该请求。

我注意到的另一件事是，如果我`domain=www.example.com`在服务器上设置了一个 cookie，那么它会在 Firefox cookie 对话框中列出`domain=".www.example.com"`，但如果我使用 JavaScript 代码设置以下 cookie，则不会添加前导点。

我究竟做错了什么？如何删除这些 cookie？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-09T21:20:52.347

我有一个类似的问题，它只是通过不传递域来解决。

`setcookie($cookie, '', 1, '/');`

在[cookie_spec](http://curl.haxx.se/rfc/cookie_spec.html)的旁注中“*将路径设置为更高级别的值不会覆盖其他更具体的路径映射。如果给定的 cookie 名称有多个匹配项，但具有单独的路径，则将发送所有匹配的 cookie。* ”因此，如果您在不同的路径位置有相同名称的 cookie，您将不得不删除每一个。

# c# - .Net WebDAV 服务器

> ID：627705
> 
> 赞同：8
> 
> 时间：2009-03-09T19:42:24.083
> 
> 标签：c#, .net, webdav

我希望在 ASP.Net 中实现 WebDAV 服务器。该应用程序将部署到 IIS 6。我已经看到了一些提供此功能的框架，但我似乎无法确定它们如何在不（显然）修改 IIS 设置的情况下完成它。

我的具体问题是如何配置 IIS 和 ASP.Net，以便 IHttpModule/IHttpHandler 可能有机会处理任何其他 WebDAV 动词（即 LOCK、OPTIONS、PROFIND 等）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-12T18:50:36.373

如果不修改 IIS 设置，就无法在 IIS 6 中配置 WebDAV 谓词。只有 IIS 7 及更高版本才有可能。

要在 IIS 6 中处理 WebDAV 所需的所有动词，您需要创建一个应用程序 wildacrd 映射。在 IIS 6 MMC 控制台中右键单击您的 Web 应用程序，然后转到*Properties* -> *Virtual Directory* Tab-> *Configuration*。单击*插入*以添加新的通配符映射。

*   可执行文件 - \Microsoft.NET\Framework\<.Net Framework 版本>\aspnet_isapi.dll
*   **验证文件是否存在 - 未选中**

![在此处输入图像描述](https://i.stack.imgur.com/ZB0Zp.gif)

在应用程序属性的*主目录选项卡上，将**执行权限*设置为*仅脚本*并允许读取。

这是 web.config 示例：[http ://www.webdavsystem.com/server/prev/v2/documentation/hosting_iis_asp_net/webconfig_example](http://www.webdavsystem.com/server/prev/v2/documentation/hosting_iis_asp_net/webconfig_example)

请注意，此 web.config 示例是专门在 Server 2003 上的 IIS 6 和 XP 上的 IIS 5.1 上使用 ASP.NET 2.0 创建和测试的。它不处理 &、%、+ 和尾随点 (.)。

ASP.NET 4.x 提供了处理 WebDAV 服务器中任何特殊字符、[配置 web.config](http://www.webdavsystem.com/server/documentation/special_characters_asp_net_iis)的方法，包括 &、% 和 '.'。支持 IIS 版本 6-8 的 web.config 由[IT Hit WebDAV Server Engine Wizard](http://www.webdavsystem.com/server)生成。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-09T20:09:31.317

查看 Geoff Lane 关于 WebDAV 的文章：

*   [http://www.zorched.net/2006/01/20/aspnet-web-application-without-aspx-extension/](http://www.zorched.net/2006/01/20/aspnet-web-application-without-aspx-extension/) - 显示 IIS 和 HttpModule 设置中的动词配置。
*   [http://www.zorched.net/2006/02/02/custom-webdav-server-using-net/](http://www.zorched.net/2006/02/02/custom-webdav-server-using-net/)
*   [http://www.zorched.net/2006/03/01/more-webdav-tips-tricks-and-bugs/](http://www.zorched.net/2006/03/01/more-webdav-tips-tricks-and-bugs/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-10T15:06:24.237

我会看看这个项目[http://sourceforge.net/projects/webdav/](http://sourceforge.net/projects/webdav/)在 C# 中的 webdav 实现。如果您必须自己构建，最好参考已完成的；如果您可以重复使用它，那就更好了。

是的，您需要修改 IIS6 设置以支持将 .NET 的 ISAPI 模块绑定到所有请求类型，并且不检查文件是否存在。在 IIS6 上没有其他方法可以执行此操作，因为在检查 webdav 支持时，Windows 上的 Web 开发客户端将在网站的根 (/) 上执行 OPTIONS 请求。

II7 为您提供更多选择...

# apache-flex - 如何从 AdvancedDataGrid 的 dataProvider 创建分层游标？

> ID：627706
> 
> 赞同：1
> 
> 时间：2009-03-09T19:42:35.003
> 
> 标签：apache-flex, actionscript-3, hierarchical-data, advanceddatagrid, cursors

在我之前编写的应用程序中，我有一个扩展类**`AdvancedDataGrid`**（ADG）。它包含以下代码：

```
package
{
    public class CustomADG extends AdvancedDataGrid
    {
        ....

        // This function serves as the result handler for a webservice call that retrieves XML data.
        private function webServiceResultHandler(event:ResultEvent):void
        {
            var resultXML:XML = new XML(event.result);

            dataProvider = new HierarchicalData(resultXML.children);
        }

        ....

        public function setOpenNodes(maxDepth:int = 0):void
        {
            var dataCursor:IHierarchicalCollectionViewCursor = dataProvider.createCursor();

            while (dataCursor.current != null)
            {
                if (dataCursor.currentDepth < maxDepth)
                    dataProvider.openNode(dataCursor.current);

                dataCursor.moveNext();
            }

            dataProvider.refresh();
        }
    }
} 
```

在这个实现中，该函数**`setOpenNodes()`**运行良好——它完全按照我的意图去做——传递一个数字，并打开**`dataProvider`**该级别或低于该级别的所有节点。

现在，我正在创建一个新的 ADG 类并希望重现此功能：

```
package view
{
    import mx.collections.IHierarchicalCollectionViewCursor;

    public class ReportADG extends AdvancedDataGrid
    {
        public function ReportADG()
        {
            super();
        }

        public function setOpenNodes(maxDepth:int = 0):void
        {
            var dataCursor:IHierarchicalCollectionViewCursor = 
                dataProvider.createCursor();

            while (dataCursor.current != null)
            {
                if (dataCursor.currentDepth < maxDepth)
                    dataProvider.openNode(dataCursor.current);

                dataCursor.moveNext();
            }

            dataProvider.refresh();
        }
    }
} 
```

在**`dataProvider`**父组件中设置：

```
<view:ReportADG id="reportADG" dataProvider="{reportData}" /> 
```

**`reportData`**在另一个文件中设置：

```
reportData = new HierarchicalData(resultXML.children); 
```

但是，我收到运行时错误：

```
TypeError: Error #1034: Type Coercion failed: cannot convert ListCollectionViewCursor@6f14031 to mx.collections.IHierarchicalCollectionViewCursor. 
```

我试过铸造**`dataProvider`**为**`ICollectionView`**. 我试过然后铸造**`ICollectionView`**as **`IHierarchicalCollectionView`**。我尝试了各种铸造，但似乎没有任何效果。为什么这在这个新的实现中不能像在过去的实现中那样工作？我需要做什么？

*** 更新：

我开始调试这个。我在我的 ADG 类中添加了一个覆盖设置器，以查看何时设置了 dataProvider：

```
override public function set dataProvider(value:Object):void
{
    super.dataProvider = value;
} 
```

我在这个设置器和我的 setOpenNodes() 函数中添加了一个断点。果然，dataProvider 是在调用 setOpenNodes() 之前设置的，它是 HierarchicalData。但是，当 setOpenNodes() 调试器说 dataProvider 是一个空的 ArrayCollection 时。看来这是根本问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T14:19:45.473

在尝试访问 dataProvider 属性之前，我需要调用 commitProperties。

```
public function setOpenNodes(maxDepth:int = 0):void
{
    super.commitProperties();

    var dataCursor:IHierarchicalCollectionViewCursor = 
        dataProvider.createCursor();

    while (dataCursor.current != null)
    {
        if (dataCursor.currentDepth < maxDepth)
            dataProvider.openNode(dataCursor.current);

        dataCursor.moveNext();
    }

    dataProvider.refresh();
} 
```

# firefox-addon - 哪些灯箱在 Firefox 扩展中工作？

> ID：627712
> 
> 赞同：1
> 
> 时间：2009-03-09T19:43:36.637
> 
> 标签：firefox-addon, xul, lightbox

我想在 Firefox 扩展中使用像[Shadowbox或类似的灯箱。](http://mjijackson.com/shadowbox/index.html)但是 Shadowbox 会导致这样的 Javascript 错误：

```
Error: document.write is not a function
Source file: chrome://iframe/content/shadowbox/shadowbox.js
Line: 1557 
```

哪个灯箱支持 IFRAME 并且可以在扩展中正确运行（即添加到覆盖 XUL）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-01T11:13:32.477

您在寻找哪种功能？

您是否可以在内容上弹出“叠加层”？覆盖层的 XUL 等效物是面板。您还可以使用 HTML 命名空间轻松地将 iframe 添加到 XUL。不过我不推荐它，而是使用一些简单的 javascript 来更改面板的内容。

您也可以尝试使用堆栈。这是一个小例子：

```
<?xml version="1.0"?>
<!DOCTYPE window PUBLIC "-//MOZILLA//DTD XUL V1.0//EN" "http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul">
<?xml-stylesheet href="chrome://global/skin/global.css" type="text/css"?>
<window id="test"
        title="test"
        xmlns:html="http://www.w3.org/1999/xhtml"
        xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"
        xmlns:svg="http://www.w3.org/2000/svg">
    <stack>
        <hbox>
            <vbox>
                <hbox>
                    <label value="123"/>
                </hbox>
                <hbox>
                    <label value="456"/>
                </hbox>
                <html:iframe style="width: 800px; height: 400px;" src="http://www.google.com"/>
            </vbox>
        </hbox>
        <vbox style="position: absolute;opacity: 0.5;">
            <html:iframe style="position: absolute; top: 100px; left: 100px; width: 500px;" src="http://www.google.com"/>
        </vbox>
    </stack>
</window> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T20:30:12.453

很可能没有。灯箱适用于 (X)HTML，而不是 XUL。

# generics - 字符串字典与字典

> ID：627716
> 
> 赞同：77
> 
> 时间：2009-03-09T19:44:23.873
> 
> 标签：generics, .net-3.5, collections, dictionary, stringdictionary

有谁知道 System.Collections.Specialized.StringDictionary 对象和 System.Collections.Generic.Dictionary 之间的实际区别是什么？

我过去都使用过它们，并没有过多考虑哪个性能更好，与 Linq 一起工作更好，或者提供任何其他好处。

关于为什么我应该使用一个而不是另一个的任何想法或建议？

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2009-03-09T19:49:05.143

`Dictionary<string, string>`是一种更现代的方法。它实现`IEnumerable<T>`并且更适合 LINQy 的东西。

`StringDictionary`是老派的方式。它在仿制药时代之前就已经存在。我只会在与遗留代码交互时使用它。

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2011-01-12T14:33:48.117

还有一点。

这将返回 null：

```
StringDictionary dic = new StringDictionary();
return dic["Hey"]; 
```

这会引发异常：

```
Dictionary<string, string> dic = new Dictionary<string, string>();
return dic["Hey"]; 
```

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2011-07-22T17:28:07.720

正如 Reed Copsey 指出的那样，StringDictionary 将您的键值小写。对我来说，这完全出乎我的意料，而且是一个阻碍。

```
private void testStringDictionary()
{
    try
    {
        StringDictionary sd = new StringDictionary();
        sd.Add("Bob", "My name is Bob");
        sd.Add("joe", "My name is joe");
        sd.Add("bob", "My name is bob"); // << throws an exception because
                                         //    "bob" is already a key!
    }
    catch (Exception ex)
    {
        MessageBox.Show(ex.Message);
    }
} 
```

我添加这个回复是为了引起人们对这个**巨大**差异的更多关注，IMO 比现代与老式的差异更重要。

* * *

## 回答 #4

> 赞同：39
> 
> 时间：2009-03-09T19:50:34.857

我认为 StringDictionary 已经过时了。它存在于框架的 v1.1 中（泛型之前），所以它在当时是一个优越的版本（与非泛型字典相比），但在这一点上，我不相信它有任何特定的优势在字典。

但是，StringDictionary 也有缺点。StringDictionary 自动将您的键值小写，并且没有用于控制它的选项。

看：

[http://social.msdn.microsoft.com/forums/en-US/netfxbcl/thread/59f38f98-6e53-431c-a6df-b2502c60e1e9/](http://social.msdn.microsoft.com/forums/en-US/netfxbcl/thread/59f38f98-6e53-431c-a6df-b2502c60e1e9/)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-11-10T14:44:28.200

`StringDictionary`来自 .NET 1.1 并实现`IEnumerable`

`Dictionary<string, string>`来自 .NET 2.0 并实现`IDictionary<TKey, TValue>,IEnumerable<KeyValuePair<TKey, TValue>>, IEnumerable`

IgnoreCase 只为 Key in 设置`StringDictionary`

`Dictionary<string, string>`对 LINQ 有好处

```
 Dictionary<string, string> dictionary = new Dictionary<string, string>();
        dictionary.Add("ITEM-1", "VALUE-1");
        var item1 = dictionary["item-1"];       // throws KeyNotFoundException
        var itemEmpty = dictionary["item-9"];   // throws KeyNotFoundException

        StringDictionary stringDictionary = new StringDictionary();
        stringDictionary.Add("ITEM-1", "VALUE-1");
        var item1String = stringDictionary["item-1"];     //return "VALUE-1"
        var itemEmptystring = stringDictionary["item-9"]; //return null

        bool isKey = stringDictionary.ContainsValue("VALUE-1"); //return true
        bool isValue = stringDictionary.ContainsValue("value-1"); //return false 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-02-15T23:15:29.267

除了作为一个更“现代”的类之外，我注意到 Dictionary 比 StringDictionary 的内存效率大大提高。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-11-12T05:28:57.433

另一个相关点是（如果我在这里错了，请纠正我）`System.Collections.Generic.Dictionary`不能在应用程序设置（`Properties.Settings`）中使用，而`System.Collections.Specialized.StringDictionary`is.

# database - SubSonic.Query 与 SubSonic.SqlQuery

> ID：627719
> 
> 赞同：1
> 
> 时间：2009-03-09T19:44:53.373
> 
> 标签：database, ado.net, subsonic

我一直在使用 SubSonic.Query，直到有一天我无法通过添加 WHERE 来执行“IS NULL”，然后我意识到 SubSonic.SqlQuery 存在并且它具有“IsNull()”的功能。查了源码，Query和SqlQuery并没有以任何方式继承，那么它们的主要区别是什么，如何决定使用哪个呢？

编辑：我刚刚意识到我实际上可以通过使用“Comparison.Is”来执行“IS NULL”。这让我更加困惑，因为 SqlQuery 和 Query 几乎可以做同样的事情

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T21:56:55.973

SqlQuery 是在 2.1 版中添加的。它大大优于 Query，因为它支持 null 并且特别是 join。这是一篇[涵盖它](http://subsonicproject.com/2-1-pakala/subsonic-version-2-1-pakala-preview-the-new-query-tool/)的帖子（当时称为 Query2）或查看我的[3 部分系列，了解我如何使用 SubSonic](http://john-sheehan.com/blog/category/subsonic/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T20:13:05.377

我不确定您的目标是什么数据库，但 IsNull 方法对于 Oracle 提供程序无法正常工作。我必须修改几行才能让它在我的机器上工作。

# python - PHP 之后的下一步：Perl 还是 Python？

> ID：627721
> 
> 赞同：17
> 
> 时间：2009-03-09T19:45:26.167
> 
> 标签：python, perl

似乎它已被多次询问，但实际上并没有。我做了我的研究，现在我很想听听*别人的意见*。

我有使用**PHP 5**的经验，包括函数式和面向对象的编程方法。我创建了一些功能简约的网站。

专业人士可能会同意 PHP 不是一种鼓励良好开发习惯的编程语言。（我相信这不是该工具的任务，但这没关系。）此外，**它的性能也存在争议**，并且与竞争对手相比通常被认为是差的。

在[Stack Overflow 博客的第 42 期播客中，](https://blog.stackoverflow.com/2009/02/podcast-42/)一位来自波兰的开发人员询问他应该学习什么语言来提高自己的技能。Jeff 和 Joel 建议他们**每个人都会有所帮助**，尽管在某些方面有些特定的更好。尽管他们提出了一些很好的观点，但这对我没有多大帮助。

从初学者的角度来看，**Perl 和 Python之间**~~没有~~很多不同之处（ [S. Lott](https://stackoverflow.com/users/10661/s-lott)建议更正） 。我希望您强调他们的优势和劣势，并列举一些独特的服务。

 **当然，这不公平，因为我也可以同时检查它们。所以这是我的愿望清单和要求，以帮助你帮助我。

首先，我想遵循**OOP 结构**并从根本上使用它。我部分计划了一个使用 MySQL 和 XML 的多用户**CMS**，所以实现越多越好。由于其可预见的性质，将大量使用**字符串操作。**

如果没有很大的差异，比较可能首先应该提到语法和其他无关紧要的微小细节。

所以，这是我的问题：我应该先尝试哪一个**——Perl** || Python？

* * *

## 结论

Perl 和 Python 都有自己的粉丝，这很棒。我想说我很感谢所有的参与——没有任何火焰战争的痕迹。

我接受了最有价值的答案，尽管下面有很多很棒的迷你文章。正如更经常建议的那样，我将首先使用 Python。然后我稍后会尝试 Perl。让我看看哪一个更适合我的想法。

在开发我的特殊 CMS 的过程中，我将询问更多关于编程的疑惑——因为开发人员现在可以互相依赖了！谢谢你。

**编辑：**有些人建议选择 Ruby 或 Java。Java实际上让我失望了。也许它有很棒的功能，也许它没有。我不会喜欢使用它。

此外，我被告知要使用 Ruby。到目前为止，与我交流的大多数开发人员对 Ruby 的看法都很差。我自己会看到，但这是我优先级列表中的最后一个元素。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-03-09T20:20:42.790

Perl 是一门非常好的语言，CPAN 有大量成熟的模块可以为您节省大量时间。此外，Perl 现在确实在向前发展，有很多有趣的项目（不像不知情的粉丝喜欢传播的东西）。即使是[Perl 6 实现](http://rakudo.org/)现在也发布了可以工作的 Perl 6。

如果你想做 OO，我会推荐[Moose](http://search.cpan.org/dist/Moose/lib/Moose.pm)。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-09T19:56:31.473

老实说，我的“大部分”编程都是在 Perl 和 PHP 中进行的，我最近决定用 Python 来做我的最新项目，我必须承认用它来编程非常好。我对整个没有花括号的事情犹豫不决，因为这就是我一直在做的事情，但它真的很干净。不过，归根结底，您可以使用所有 3 个来制作出色的 Web 应用程序，但是如果您一心想放弃 PHP 来尝试新的东西，我会推荐 Python 和 Django 框架。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-03-09T19:48:40.853

我会选择 Perl。不是每个人都同意我的观点，但它是一门非常适合系统管理工作的优秀语言，它会让您接触到更多函数式编程结构。它也是学习如何为给定任务使用最少量代码的一门很棒的语言。

不过，对于您提到的使用场景，我认为 PHP 可能仍然是您最好的选择。然而，Python 确实有一些很棒的 Web 框架，所以如果你只是想尝试一种新的语言来开发 Web 应用程序，那么 Python 可能是你的选择。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-03-09T20:01:48.920

我没有使用 Python 的经验。我强烈保证学习 Perl，不是因为消耗，而是因为在这个平台上有一个 TON 需要学习。Perl 的关键概念是：按我的意思做 ( [DWIM](http://en.wikipedia.org/wiki/DWIM) ) 和做它的方法不止一种( [TMTOWTDI](http://en.wikipedia.org/wiki/There_is_more_than_one_way_to_do_it) )。这意味着，假设问题得到充分解决，通常不会有错误的方法来解决问题。

从学习 Perl 的基础语言开始，然后扩展自己学习关键 Perl 模块，如 IO::File、DBI、HTML::Template、XML::LibXML 等[。search.cpan.org](http://search.cpan.org)将是您的资源. [perlmonks.org](http://perlmonks.org)将成为您的向导。几乎所有有用的事情都可能会发布一个模块。

请记住，Perl 是一种动态且结构松散的语言。Perl 不是强制执行严格的 OOP 标准的平台，但这是有充分理由的。您会发现该语言非常灵活。

Perl 在哪里使用？如前所述，系统管理员大量使用它。您仍然可以通过简单的 CGI 或 MVC 框架来制作出色的 Web 应用程序。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-03-09T20:02:32.723

我使用 Python 的次数不多，但我可以说出我在使用 Perl 时为什么*不*喜欢它。

1.  OO 支持感觉得到了加强。perl 中的 OO 与我使用的其他语言（包括 PHP、Java 和 C#）中的 OO 支持非常不同
2.  TMTOWTDI（有不止一种方法可以做到）。理论上的好主意，实践中的糟糕主意，因为它降低了代码的可读性。
3.  Perl 使用了很多魔法符号。
4.  Perl 不支持命名函数参数，这意味着您需要深入研究 @_ 数组以获取传递给函数的参数（或者更确切地说，作为 perl 的 sub 没有 function 关键字）。这意味着您会看到很多类似下面示例的内容（移动，因为 SO 不喜欢编号列表中的代码）

说了这么多，我会研究Python。除非你想使用更重的东西，比如 C++ 或 C#/Java。

哦，在我忘记之前：我想为上面的 4 举一个例子，但是 SO 不喜欢将代码放在编号列表中：

```
sub mySub {
    #extremely common to see in Perl, as built-ins operators operate on the $_ scalar or @_ array implicitly
    my $arg1 = shift;
    my $arg2 = shift;
} 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-03-10T10:32:52.397

在只使用 Perl 的几年之后，我最近从 Perl 迈向 Python。不久之后，我发现我已经开始阅读各种 Python 代码，就像阅读任何其他易于阅读的文本一样——这是我在使用 Perl 时从未做过的事情。不得不深入研究第三方 Perl 代码对我来说一直是一场噩梦，所以这是一个非常非常好的惊喜！

对我来说，这意味着 Python 代码更容易维护，从长远来看，这使得 Python 比 Perl 更具吸引力。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-03-10T20:24:03.210

Python 干净而优雅，而且大量的 C API 已被封装，这为您提供了强大的钩子。我也喜欢《[Python之禅](http://www.python.org/dev/peps/pep-0020/)》。

*   美丽总比丑陋好。
*   显式优于隐式。
*   简单胜于复杂。
*   复杂胜于复杂。
*   平面优于嵌套。
*   稀疏比密集好。
*   可读性很重要。
*   特殊情况不足以打破规则。
*   虽然实用胜过纯洁。
*   错误永远不应该悄无声息地过去。
*   除非明确沉默。
*   面对模棱两可，拒绝猜测的诱惑。
*   应该有一种——最好只有一种——明显的方法来做到这一点。
*   虽然这种方式一开始可能并不明显，除非你是荷兰人。
*   现在总比没有好。
*   虽然从来没有比*现在*更好。
*   如果实现很难解释，那是个坏主意。
*   如果实现很容易解释，那可能是个好主意。
*   命名空间是一个很棒的想法——让我们做更多的事情！

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-03-09T20:02:01.257

作为一个 Perl 程序员，我通常会说 Perl。但是来自 PHP，我认为 Perl 太相似了，你实际上不会从中得到太多。（不是因为没有太多要学的东西，而是你很可能在 Perl 中使用与在 PHP 中编程相同的风格进行编程。）

我会建议一些完全不同的东西：Haskell（由 Joel 建议）、Lisp、Lua、JavaScript 或 C。其中任何一种都会通过开辟新的看待世界的方式让你成为更好的程序员。

但是在此期间没有理由停止学习 PHP。

为了更好地了解这些语言的阴暗面，我衷心推荐：[你最喜欢的语言有哪五件事是你讨厌的？](https://stackoverflow.com/questions/282329/what-are-five-things-you-hate-about-your-favorite-language)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-03-10T04:33:54.693

我建议通过每个初学者教程，然后自己决定哪个更适合你。你会发现你可以做你需要做的事情：

**[Python 教程](http://docs.python.org/tutorial/index.html)**（ [Python 类](http://docs.python.org/tutorial/classes.html#class-objects)）

**[Perl 教程](http://www.perl.com/pub/a/2000/10/begperl1.html)**（ [Perl 类](http://perldoc.perl.org/perltoot.html)）（找不到一个“官方”perl 教程，请随意推荐一个）

* * *

根据我的经验，python 提供了更清晰、更直接的体验。

我的 perl 问题：

*   ['使用严格;'，污点，警告？](http://www.perl.com/pub/a/2001/01/begperl6.html)- 理想情况下不需要这些。

*   传递变量：@ *; 与 $* , 与 shift

*   确定[我的](http://perldoc.perl.org/functions/my.html)、[本地](http://perldoc.perl.org/functions/local.html)的、[我们](http://perldoc.perl.org/functions/our.html)的？（local 的定义似乎特别指出了与 perl 的一些混淆，“你可能真的想改用 my，因为 local 并不是大多数人认为的“local”。）

一般来说，凭借我的 perl 技能，我仍然可以找到内置功能的自参考文档。在 python 中，我发现这不那么重要。*（我在两者中工作的时间大致相同，但我的一般编程经验随着时间的推移而增长。换句话说，我现在可能会成为一个更好的 perl 程序员）*

但是，如果您是 unix 命令行专家，那么 perl 对您来说可能会更自然。或者，如果您主要将其用作命令行管理任务的替代或扩展，它可能适合您的需求。在我看来，perl 在命令行上比 python 的“绘制速度更快”。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-03-09T20:23:34.060

为什么你的名单上没有 Ruby？也许你应该试一试。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-03-09T20:46:48.717

"I'd like to follow OOP structure..." advocates for Python or, even more so if you're open, Ruby. On the other hand, in terms of existing libraries, the order is probably Perl > Python >> Ruby. In terms of your career, Perl on your resume is unlikely to make you stand out, while Python and Ruby may catch the eye of a hiring manager.

As a PHP programmer, you are probably going to see all 3 as somewhat "burdensome" to get a Web page up. All have good solutions for Web frameworks, but none is quite as focussed on rendering a Web page as is PHP.

I think that Python is quite likely to be a better choice for you than Perl. It has many good resources, a large community (although not as large as Perl, probably), "stands out" a little on a resume, and has a good reputation.

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-03-09T20:27:15.800

如果这两个是你唯一的选择，我会选择 Python。

否则你应该学习javascript。

不，我的意思是*真正*学习它...

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-03-09T21:55:09.350

如果您不会使用这种语言进行 Web 开发，那么他们中的任何一个都可以。如果你是，你可能会发现在 perl 中进行 web 开发有点复杂，因为所有的框架都需要更多的语言知识。你可以在这两种情况下都做得很好，但我认为 perl 允许更快速的开发。
此外，perl 的正则表达式摇滚！

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-09-04T16:40:52.167

每一种动态语言都来自同一个家族。不管你怎么做，你使用哪个工具都没有关系。

[PHP VS Python OT PERL 还是 Ruby？停下来](http://blog.oykko.com/2013/09/python-or-php.html)

正如许多评论提到的那样，python有时更干净，其花括号完全使用。你只需要练习。

# asp.net - 根路由中断路径

> ID：627722
> 
> 赞同：0
> 
> 时间：2009-03-09T19:45:36.087
> 
> 标签：asp.net, asp.net-mvc

我正在将 ASP.NET MVC 应用程序部署到 IIS 6，但遇到了根路径的问题。

在 Global.asax 中，我映射了根路径：

```
routes.MapRoute("Root", "", 
    new { controller = "Dashboard", action = "Index", id = "" }); 
```

当我导航到[http://servername:70/test2/](http://servername:70/test2/)时，应用程序会显示正确的页面，但未加载样式表和 JavaScript 文件。查看源代码，路径显示如下：

```
<script src="test2/Scripts/MicrosoftAjax.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" 
    href="test2/Content/stylesheets/app.css" /> 
```

这使浏览器寻找

> [http://servername:70/test2/test2/Content/stylesheets/app.css](http://servername:70/test2/test2/Content/stylesheets/app.css)

当我直接进入控制器（[http://servername:70/test2/Dashboard.aspx](http://servername:70/test2/Dashboard.aspx)）时，路径是正确的：

```
<link rel="stylesheet" type="text/css" href="Content/stylesheets/app.css" /> 
```

使用 ActionLink 生成的任何链接也会发生这种情况。样式表和脚本路径是使用 Url.Content 生成的：

```
<link rel="stylesheet" type="text/css" 
    href="<%= Url.Content("~/Content/stylesheets/app.css") %>" /> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-09T23:40:54.680

I have recently answered a [question](https://stackoverflow.com/questions/612584/asp-net-mvc-returns-wrong-path-for-url-content/612741#612741) similar to this which uses Rob Conery's [Script Registration Helper](http://blog.wekeroad.com/blog/asp-net-mvc-script-registration-helper/). I'll copy the answer in here for you, and add an example HtmlHelper for stylesheets.

```
public static string RegisterJS(this System.Web.Mvc.HtmlHelper helper, string scriptLib) {
  //get the directory where the scripts are
  string scriptRoot = VirtualPathUtility.ToAbsolute("~/Scripts");
  string scriptFormat="<script src=\"{0}/{1}\" type=\"text/javascript\"></script>\r\n";
  return string.Format(scriptFormat,scriptRoot,scriptLib);
}

public static string RegisterCSS(this System.Web.Mvc.HtmlHelper helper, string styleLink, string rel) {
  //get the directory where the css is
  string stylesheetRoot = VirtualPathUtility.ToAbsolute("~/Content/Stylesheets");
  string styleFormat="<link type='text/css' href='{0}/{1}' rel='{1}' />\r\n";
  return string.Format(styleFormat, stylesheetRoot, styleLink, rel);
} 
```

Usage:

```
<%= Html.RegisterJS("myscriptFile.js") %>
<%= Html.RegisterCSS("app.css") %> 
```

Hope this helps.

**Also**, I note that there was another response on that question by [Levi](https://stackoverflow.com/users/59641/levi):

> This should have been fixed in RC2\. If you are using RC2 and are still seeing this problem, please file a bug at [http://forums.asp.net/1146.aspx](http://forums.asp.net/1146.aspx).

If this is your preferred answer, the please upvote Levi's [response](https://stackoverflow.com/questions/612584/asp-net-mvc-returns-wrong-path-for-url-content/612741#618214).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-11T16:51:48.237

或者，使用 Url.Content ...

`<link href="<%=Url.Content("~/Content/Site.css") %>" rel="stylesheet" type="text/css" />`

# javascript - jquery排序复杂的静态对象

> ID：627723
> 
> 赞同：0
> 
> 时间：2009-03-09T19:45:38.567
> 
> 标签：javascript, object

我想对方法的键或名称进行排序.. 以下是对象 [http://pastie.org/411854](http://pastie.org/411854)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T20:03:21.130

如果我理解正确，您想根据键或方法名称（相同的值）对成员进行排序吗？这对 Object 没有任何意义，因为成员没有顺序。

但是，如果您将这些对象放在这样的数组中：

```
var apiDocs = [
    {
        "methodName": "friendsGetByUser",
        "methodDescription": "Returns user ids of friends of the specified user.",
        ...
    }, {
        "methodName": "friendsGetBestFriends",
        "methodDescription": "Returns user ids of best friends of the logged in user.",
        ...
    }
    ...
]; 
```

然后，您可以通过调用传入比较函数的 Array.sort 轻松对数组进行排序。

```
apiDocs.sort(function (a, b) {
        return a.methodName < b.methodName;
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T20:02:31.710

要获取函数名称的排序数组，您可以使用以下命令：

```
var functions = [];
for(functionName in apiDocs) {
  functions.push(functionName);
}
functions.sort(); 
```

如果你想执行某种更复杂的排序，你可以按照以下方式做一些事情

```
var functions = [];
for(functionName in apiDocs) {
  functions.push(apiDocs[functionName]);
}
functions.sort(//put sorting closure here) 
```

您可以在此处获取有关自定义排序的更多信息：[Array Sorting Explained](http://www.javascriptkit.com/javatutors/arraysort.shtml)

# c# - 为什么在字节中反转位时会得到以下输出？

> ID：627728
> 
> 赞同：0
> 
> 时间：2009-03-09T19:47:53.163
> 
> 标签：c#, .net, endianness

*假设：*

> 将 byte[] 从 Little Endian 转换为 Big Endian 意味着反转 byte[] 的每个字节中的位顺序。

假设这是正确的，我尝试了以下方法来理解这一点：

```
byte[] data = new byte[] { 1, 2, 3, 4, 5, 15, 24 };
byte[] inverted = ToBig(data);

var little = new BitArray(data);
var big = new BitArray(inverted);

int i = 1;

foreach (bool b in little)
{
    Console.Write(b ? "1" : "0");
    if (i == 8)
    {
        i = 0;
        Console.Write(" ");
    }
    i++;
}

Console.WriteLine();

i = 1;

foreach (bool b in big)
{
    Console.Write(b ? "1" : "0");
    if (i == 8)
    {
        i = 0;
        Console.Write(" ");
    }
    i++;
}

Console.WriteLine();

Console.WriteLine(BitConverter.ToString(data));
Console.WriteLine(BitConverter.ToString(ToBig(data)));

foreach (byte b in data)
{
    Console.Write("{0} ", b);
}

Console.WriteLine();

foreach (byte b in inverted)
{
    Console.Write("{0} ", b);
} 
```

转换方法：

```
private static byte[] ToBig(byte[] data)
{
    byte[] inverted = new byte[data.Length];

    for (int i = 0; i < data.Length; i++)
    {
        var bits = new BitArray(new byte[] { data[i] });
        var invertedBits = new BitArray(bits.Count);

        int x = 0;

        for (int p = bits.Count - 1; p >= 0; p--)
        {
            invertedBits[x] = bits[p];
            x++;
        }

        invertedBits.CopyTo(inverted, i);
    }

    return inverted;
} 
```

这个小应用程序的输出与我的预期不同：

```
00000001 00000010 00000011 00000100 00000101 00001111 00011000

00000001 00000010 00000011 00000100 00000101 00001111 00011000 

80-40-C0-20-A0-F0-18

01-02-03-04-05-0F-18

1 2 3 4 5 15 24 

1 2 3 4 5 15 24 
```

由于某种原因，数据保持不变，除非使用 BitConverter 打印。

我不明白什么？

**更新**

新代码产生以下输出：

```
10000000 01000000 11000000 00100000 10100000 11110000 00011000 

00000001 00000010 00000011 00000100 00000101 00001111 00011000 

01-02-03-04-05-0F-18

80-40-C0-20-A0-F0-18

1 2 3 4 5 15 24 

128 64 192 32 160 240 24 
```

但正如我现在被告知的那样，我的方法无论如何都是不正确的，因为我应该反转字节而不是位？

我正在与之合作的这位硬件开发人员告诉我要反转位，因为他无法读取数据。

**我使用它的上下文**

将使用它的应用程序实际上不适用于数字。

我应该将比特流保存到文件中

1 = 白色，0 = 黑色。

它们代表 256x64 位图的像素。

字节 0 到字节 31 表示第一行像素，字节 32 到字节 63 表示第二行像素。

我有输出这些位的代码......但开发人员告诉我它们的顺序错误......他说字节很好，但位不是。

所以我很困惑：p

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-09T19:52:08.817

不，字节顺序是指**字节**的顺序，而不是位。大端系统首先存储最重要的字节，而小端系统首先存储最不重要的字节。一个字节中的位保持相同的顺序。

您的 ToBig() 函数似乎返回原始数据而不是位交换数据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T19:54:40.887

此时您的方法可能是正确的。字节序有不同的含义，它取决于硬件。

通常，它用于在计算平台之间进行转换。大多数 CPU 供应商（现在）对不同的芯片组使用相同的位顺序，但字节顺序不同。这意味着，如果您将一个 2 字节的 int 从一个系统传递到另一个系统，您可以不理会这些位，而是交换字节 1 和 2，即：

```
int somenumber -> byte[2]: somenumber[high],somenumber[low] ->  
byte[2]: somenumber[low],somenumber[high] -> int newNumber 
```

然而，这并不总是正确的。一些硬件仍然使用倒置的 BIT 排序，所以你所拥有的可能是正确的。您需要信任您的硬件开发人员。或进一步调查。

我建议在 Wikipedia 上阅读此内容 - 总是一个很好的信息来源：

[http://en.wikipedia.org/wiki/Endianness](http://en.wikipedia.org/wiki/Endianness)

* * *

您的 ToBig 方法有一个错误。

在末尾：

```
 invertedBits.CopyTo(data, i);
}

return data; 
```

您需要将其更改为：

```
byte[] newData = new byte[data.Length];
invertedBits.CopyTo(newData, i);
}
return newData; 
```

您正在重置输入数据，因此您将接收到两个数组。问题是数组是引用类型，所以你可以修改原始数据。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-09T20:02:05.017

正如 grayfade 已经说过的，字节顺序与位排序无关。

您的代码不符合您的预期的原因是 ToBig 方法更改了您发送给它的数组。这意味着在调用该方法之后，数组被反转，并且`data`只是`inverted`指向同一个数组的两个引用。

这是该方法的更正版本。

```
private static byte[] ToBig(byte[] data) {
   byte[] result = new byte[data.length];
   for (int i = 0; i < data.Length; i++) {
      var bits = new BitArray(new byte[] { data[i] });
      var invertedBits = new BitArray(bits.Count);
      int x = 0;
      for (int p = bits.Count - 1; p >= 0; p--) {
         invertedBits[x] = bits[p];
         x++;
      }
      invertedBits.CopyTo(result, i);
   }
   return result;
} 
```

编辑：
这是一个改变字节数组字节序的方法：

```
static byte[] ConvertEndianness(byte[] data, int wordSize) {
    if (data.Length % wordSize != 0) throw new ArgumentException("The data length does not divide into an even number of words.");
    byte[] result = new byte[data.Length];
    int offset = wordSize - 1;
    for (int i = 0; i < data.Length; i++) {
        result[i + offset] = data[i];
        offset -= 2;
        if (offset < -wordSize) {
            offset += wordSize * 2;
        }
    }
    return result;
} 
```

例子：

```
byte[] data = { 1,2,3,4,5,6 };
byte[] inverted = ConvertEndianness(data, 2);
Console.WriteLine(BitConverter.ToString(inverted)); 
```

输出：

```
02-01-04-03-06-05 
```

第二个参数是字长。由于字节顺序是单词中字节的顺序，因此您必须指定单词的大小。

编辑2：
这是一种更有效的反转位的方法：

```
static byte[] ReverseBits(byte[] data) {
    byte[] result = new byte[data.Length];
    for (int i = 0; i < data.Length; i++) {
        int b = data[i];
        int r = 0;
        for (int j = 0; j < 8; j++) {
            r <<= 1;
            r |= b & 1;
            b >>= 1;
        }
        result[i] = (byte)r;
    }
    return result;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T19:53:22.683

我看到的一个大问题是 ToBig 更改了`data[]`传递给它的数组的内容。

您在名为 的数组上调用 ToBig ，然后`data`将结果分配给.`inverted``data``inverted`

# c# - Linq 获取所有控件（有序）

> ID：627730
> 
> 赞同：2
> 
> 时间：2009-03-09T19:48:22.350
> 
> 标签：c#, .net, linq, .net-3.5

有没有办法使用 linq 获取所有控件。

我想做的是这样的（按标签索引排序控件）：

```
foreach (Control control in this.Controls.OrderBy(c => c.TabIndex)
{
    ...
} 
```

当我得到一个 List<...> 时，我会使用这种查询

我使用 c# 和 .Net 3.5

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-09T19:54:11.993

`ControlCollection`只有工具`IEnumerable`，没有`IEnumerable<T>`。不过，这很容易解决 - 添加对`Cast()`：

```
foreach (Control control in Controls.Cast<Control>()
                                    .OrderBy(c => c.TabIndex))
{
} 
```

或者您可以使用查询表达式，它会`Cast()`在必要时调用：

```
var controls = from Control c in Controls
               orderby c.TabIndex
               select c;

foreach (Control control in controls)
{
} 
```

# flash - 从数组动画文本

> ID：627732
> 
> 赞同：0
> 
> 时间：2009-03-09T19:49:02.147
> 
> 标签：flash, actionscript-3, arrays

我有这段代码，它应该接受一个包含一些单词的数组，并以指定的超时时间将补间一个一个地应用于它们。我想我必须用它们制作一个空的电影剪辑，然后使用带有超时的 foreach 循环为它们制作动画，但我不知道如何准确地做到这一点。

这就是我所在的位置：

```
var array:Array = new Array("word", "is", "here");

var bounce:Function = function(mc:MovieClip):void {
mc.bounce1 = new Tween(mc, "_y", Bounce.easeOut, 35, 75, 1, true);
mc.bounce2 = new Tween(mc, "_xscale", Bounce.easeOut, 0, 400, 4, true);
mc.bounce3 = new Tween(mc, "_yscale", Bounce.easeOut, 0, 400, 4, true);
mc.bounce4 = new Tween(mc, "_alpha", Regular.easeInOut, 100, 0, 2, true);
};
array.forEach(bounce, me); 
```

可能真的需要一些帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-10T03:03:36.393

我没有 CS3，但我使用名为 Tweener 的免费补间库创建了一个快速示例。你可以在[这里](http://code.google.com/p/tweener/)找到它。

```
import flash.events.Event;
import flash.display.MovieClip;
import flash.text.TextField;    
import flash.text.TextFormat;
import flash.text.TextFieldAutoSize;
/* this is a free Tweening library. I don't have flash CS3 but this is analogous to fl.transitions.Tween */

import caurina.transitions.Tweener; 

public class Main extends MovieClip 
{
    public function Main():void 
    {
        if (stage) init();
        else addEventListener(Event.ADDED_TO_STAGE, init);
    }

    private function init(e:Event = null):void 
    {
        removeEventListener(Event.ADDED_TO_STAGE, init);

        /* your array of words */
        var array: Array = new Array("word", "is", "here")

        /*we'll use this to control the position of each word*/
        var x : int = 0

        var delay : Number = 0.0

        for each(var s : String in array)
        {
            var word: TextField = new TextField()
            word.autoSize = TextFieldAutoSize.LEFT

            /* here we can adjust text format */
            word.defaultTextFormat = new TextFormat(null, 75, 0xff0000)

            word.text = s
            word.x = x
            word.y = 75

            /* put the new word into our MovieClip */
            addChild(word)

            /* apply some tweens */
            bounceText(word, delay)

            /* adjust our animation and position variables */
            delay += 1.3
            x += word.width
        }
    }

    private function bounceText(a_textField : TextField, a_delay : Number) : void
    {
        /* duration of each tween */
        var t:Number = 0.75

        /* this is the "up" part of the tween, from y=75 to y=35 */
        Tweener.addTween(a_textField, { y:35, delay:a_delay, time:t, transition:"easeOutQuad" } );

        /* this is the "down" part of the tween. note the "delay" parameter is offset by the time of the first tween.
         * the "onComplete" function calls BounceText again when the second Tween is complete. If you are using fl.transitions.Tween,
         * you can add an event listener for a TweenEvent.MOTION_FINISH event, or set the "looping" property of the Tween to true.
         * */
        Tweener.addTween(a_textField, { y:75, delay:a_delay + t, time:t, transition:"easeInQuad", onComplete:bounceText, onCompleteParams:[a_textField, 0.25] } );
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T20:19:37.737

根据您的 Tween 引擎，您可能可以*链接*Tween 。不确定您的 Tween 引擎到底是什么，这是一种更经典的方法。animateNext() 函数在开始时调用一次，此后只能由最后一个 Tweens onComplete 处理程序（或 Timer 方法）调用：

```
var wordList:Array = new Array('one','two','three');

// Keeps track of the current showing word
var currentIndex:int = -1;

// Starts the animation
animateNext();

function animateNext():void
{
   // increments the word counter
   currentIndex ++;

   // resets the word count if all the words are done
   if(currentIndex >= wordList.length)
      currentIndex = 0;

   // Apply the right word here
   var word:String = wordList[currentIndex];
   trace(word);

   // animation tweens here :
   ...

   // place callback function onComplete to animateNext()

} 
```

# asp.net - 收集数据：动态文本框

> ID：627734
> 
> 赞同：1
> 
> 时间：2009-03-09T19:49:10.103
> 
> 标签：asp.net, forms, dynamic, view

**编辑：如果有人还可以提出一种更明智的方法来使我在下面尝试的事情发生，那也将不胜感激**

我正在构建一个多页表单，该表单从 POST 方法中获取（产品）数量，并显示依赖于该数字的表单序列。当用户转到下一页时，表单应该收集并显示此信息（用于确认），然后将此信息发送到将提供要显示的 URL 的服务。

不用说，我在完成这项工作时遇到了问题。这是我的（匿名）代码的相关部分：

```
public partial class foo : System.Web.UI.Page
{
    Int quantityParam    = 3;
    ArrayList Users  = new ArrayList();
    //the information for each user is held in a hashtable the array list will be an array list of the user hashtables

protected void Page_Init(object sender, EventArgs e)
{
    if(null != Request["quantity1"])
       { 
             this.quantityParam = Request["quantity1"];
       }
}
protected void Page_Load(object sender, EventArgs e)
{
    int quantity = this.quantityParam;
    if(quantity < 1){ mviewThankYou.SetActiveView(View4Error);} 
    else 
    { //create a form for each user
        mviewThankYou.SetActiveView(View1EnterUsers);
        for(int user = 0;user < quantity; user++)
        {
            createUserForm(user);       
        }
    }   
}
protected void BtnNext1_Click(object sender, EventArgs e)
{
    if(Page.IsValid)
    {
        for(int i = 0; i < quantity; i++)
        {
            String ctrlName = "txtUser" + i.ToString();
            String ctrlEmail = "txtEmail" + i.ToString();
            TextBox name = (TextBox)FindControl(ctrlName);
            TextBox email = (TextBox)FindControl(ctrlEmail);

            /*BONUS QUESTION: How can I add the Hashtables to the Users Array without them being destroyed when I leave the function scope?

            this is where the failure occurs: 
            System.NullReferenceException: Object reference not set to an instance of an object. on: "tempUser.Add("name",name.Text); 
            */

            Hashtable tempUser = new Hashtable();
            tempUser.Add("name",name.Text);
            tempUser.Add("email",email.Text);
            this.Users.Add(tempUser);
        }
        for(int i = 0; i < quantity; i++)
        {
            v2Content.Text +="<table><tr><td>Name: </td><td>"+
            ((Hashtable)Users[i])["name"]+
            "</td></tr><tr><td>Email:</td><td>"+
            ((Hashtable)Users[i])["email"]+
            "</td></tr></table>";
        }
        mviewThankYou.SetActiveView(View2Confirm);
    }
}
private void createUserForm(int userNum){
    DataTable objDT = new DataTable();
        int rows = 2;
        int cols = 2;

    //create the title row..
    TableRow title = new TableRow();
    TableCell titleCell = new TableCell();
    formTable.Rows.Add(title);
    Label lblUser = new Label();
    lblUser.Text = "<b>User "+ (userNum+1) + "</b>";
    lblUser.ID = "lblTitle"+ userNum;
    titleCell.Controls.Add(lblUser);
    title.Cells.Add(titleCell);

    for(int i = 0; i < rows; i++)
    {
        TableRow tRow = new TableRow();     
        formTable.Rows.Add(tRow);
        for(int j = 0; j < cols; j++)
        {
            TableCell tCell = new TableCell();
            if(j == 0){
                Label lblTitle = new Label();
                if(i == 0){
                    lblTitle.Text = "User Name:";
                    lblTitle.ID = "lblUser" + userNum;
                }
                else{
                    lblTitle.Text = "User Email:";
                    lblTitle.ID = "lblEmail" + userNum;
                }
                tCell.Controls.Add(lblTitle);
            } else {
                TextBox txt = new TextBox();
                if(i==0){
                    txt.ID = "txtUser" + userNum;
                }
                else{
                    txt.ID = "txtEmail" + userNum;
                }
                RequiredFieldValidator val = new RequiredFieldValidator();
                val.ID = txt.ID + "Validator";
                val.ControlToValidate = txt.UniqueID;
                val.ErrorMessage = "(required)";

                tCell.Controls.Add(txt);
                tCell.Controls.Add(val);
            }
            tRow.Cells.Add(tCell);
        }//for(j)
    }//for(i)

    //create a blank row...
    TableRow blank = new TableRow();
    TableCell blankCell = new TableCell();
    formTable.Rows.Add(blank);
    Label blankLabel = new Label();
    blankLabel.Text = " ";
    blankLabel.ID = "blank" + userNum;
    blankCell.Controls.Add(blankLabel);
    blank.Cells.Add(blankCell);         

}//CreateUserForm(int) 
```

对不起（业余代码）的数量。我怀疑如果失败是 FindControl() 不起作用，但我不知道为什么......

如果可以提供任何帮助，我将非常感激。

编辑：显示错误可能会有所帮助：

错误（第 112 行）异常详细信息：System.NullReferenceException：对象引用未设置为对象的实例。

源错误：

第 111 行：哈希表 tempUser = new Hashtable();
第 112 行： tempUser.Add("name",name.Text);
第 113 行：tempUser.Add("email",email.Text);
第 114 行：this.Users.Add(tempUser);

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-11T17:18:16.843

您的问题在于您每次都在 Page_Load 中重新加载表单。确保只加载一次动态文本框，并且在需要确认时能够找到它们。只要 Page_Load 重建，您将找不到答案，并且可能找不到任何东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T19:28:32.103

我想到了：

FindControl() 直接搜索它所调用的控件的子项。

当我调用它时，它（自动）是 Page.FindControl() 我已经将表创建嵌套在一个字段和一个表控件中

当我调用 tableID.FindControl() 时，它找到了应有的控件。

感谢您的帮助，格雷戈里，以及大家的所有评论。

-马特

# vb.net - 比较两个字节数组的最快方法是什么？

> ID：627742
> 
> 赞同：6
> 
> 时间：2009-03-09T19:51:12.237
> 
> 标签：vb.net, arrays, compare

我正在尝试比较 VB.NET 中的两个长字节数组并遇到了障碍。比较两个 50 兆字节的文件几乎需要两分钟，所以我显然做错了。我在具有大量内存的 x64 机器上，所以那里没有问题。这是我目前正在使用并希望更改的代码。

`_Bytes`并且`item.Bytes`是要比较的两个不同数组并且长度已经相同。

```
For Each B In item.Bytes
   If B <> _Bytes(I) Then
        Mismatch = True
        Exit For
   End If
   I += 1
Next 
```

我需要能够尽可能快地比较可能有数百兆字节甚至可能是一两个千兆字节的文件。任何可以更快地做到这一点的建议或算法？

`Item.bytes`是一个从数据库/文件系统中取出的对象，返回比较，因为它的字节长度与用户想要添加的项目相匹配。通过比较这两个数组，我可以确定用户是否向数据库添加了新内容，如果没有，我可以将它们映射到另一个文件，而不会浪费硬盘驱动器空间。

[更新]

我将数组转换为 Byte() 的局部变量，然后进行相同的比较，相同的代码，它运行了大约一秒钟（我必须对其进行基准测试并将其与其他变量进行比较），但是如果你对 local 做同样的事情变量并使用通用数组会变得非常慢。我不知道为什么，但它对我提出了更多关于数组使用的问题。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-09T19:57:26.870

电话在做什么`_Bytes(I)`？它不是每次都加载文件，是吗？即使有缓冲，那也是个坏消息！

将有很多方法可以在一次查看多头时对此进行*微优化*，可能会使用不安全的代码等 - 但我只专注于首先获得*合理*的性能。显然，发生了一些非常奇怪的事情。

我建议您将比较代码提取到一个单独的函数中，该函数需要两个字节数组。这样你就知道你不会做任何奇怪的事情。我也会使用一个简单的`For`循环而不是`For Each`在这种情况下 - 它会更简单。哦，先检查长度是否正确:)

编辑：这是我要使用的代码（未经测试，但足够简单）。它暂时在 C# 中 - 我将在几秒钟内转换它：

```
public static bool Equals(byte[] first, byte[] second)
{
    if (first == second)
    {
        return true;
    }
    if (first == null || second == null)
    {
        return false;
    }
    if (first.Length != second.Length)
    {
        return false;
    }
    for (int i=0; i < first.Length; i++)
    {
        if (first[i] != second[i])                
        {
            return false;
        }
    }
    return true;
} 
```

编辑：这是VB：

```
Public Shared Function ArraysEqual(ByVal first As Byte(), _
                                   ByVal second As Byte()) As Boolean
    If (first Is second) Then
        Return True
    End If

    If (first Is Nothing OrElse second Is Nothing) Then
        Return False
    End If
    If  (first.Length <> second.Length) Then
         Return False
    End If

    For i as Integer = 0 To first.Length - 1
        If (first(i) <> second(i)) Then
            Return False
        End If
    Next i
    Return True
End Function 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-12-15T19:21:26.097

比较大小相等的两个字节数组的最快方法是使用互操作。在控制台应用程序上运行以下代码：

```
using System;
using System.Runtime.InteropServices;
using System.Security;

namespace CompareByteArray
{
    class Program
    {
        static void Main(string[] args)
        {
            const int SIZE = 100000;
            const int TEST_COUNT = 100;

            byte[] arrayA = new byte[SIZE];
            byte[] arrayB = new byte[SIZE];

            for (int i = 0; i < SIZE; i++)
            {
                arrayA[i] = 0x22;
                arrayB[i] = 0x22;
            }

            {
                DateTime before = DateTime.Now;
                for (int i = 0; i < TEST_COUNT; i++)
                {
                    int result = MemCmp_Safe(arrayA, arrayB, (UIntPtr)SIZE);

                    if (result != 0) throw new Exception();
                }
                DateTime after = DateTime.Now;

                Console.WriteLine("MemCmp_Safe: {0}", after - before);
            }

            {
                DateTime before = DateTime.Now;
                for (int i = 0; i < TEST_COUNT; i++)
                {
                    int result = MemCmp_Unsafe(arrayA, arrayB, (UIntPtr)SIZE);

                    if (result != 0) throw new Exception();
                }
                DateTime after = DateTime.Now;

                Console.WriteLine("MemCmp_Unsafe: {0}", after - before);
            }

            {
                DateTime before = DateTime.Now;
                for (int i = 0; i < TEST_COUNT; i++)
                {
                    int result = MemCmp_Pure(arrayA, arrayB, SIZE);

                    if (result != 0) throw new Exception();
                }
                DateTime after = DateTime.Now;

                Console.WriteLine("MemCmp_Pure: {0}", after - before);
            }
            return;
        }

        [DllImport("msvcrt.dll", CallingConvention = CallingConvention.Cdecl, EntryPoint="memcmp", ExactSpelling=true)]
        [SuppressUnmanagedCodeSecurity]
        static extern int memcmp_1(byte[] b1, byte[] b2, UIntPtr count);

        [DllImport("msvcrt.dll", CallingConvention = CallingConvention.Cdecl, EntryPoint = "memcmp", ExactSpelling = true)]
        [SuppressUnmanagedCodeSecurity]
        static extern unsafe int memcmp_2(byte* b1, byte* b2, UIntPtr count);

        public static int MemCmp_Safe(byte[] a, byte[] b, UIntPtr count)
        {
            return memcmp_1(a, b, count);
        }

        public unsafe static int MemCmp_Unsafe(byte[] a, byte[] b, UIntPtr count)
        {
            fixed(byte* p_a = a)
            {
                fixed (byte* p_b = b)
                {
                    return memcmp_2(p_a, p_b, count);
                }
            }
        }

        public static int MemCmp_Pure(byte[] a, byte[] b, int count)
        {
            int result = 0;
            for (int i = 0; i < count && result == 0; i += 1)
            {
                result = a[0] - b[0];
            }

            return result;
        }

    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-09T19:53:20.110

如果您不需要知道字节，请使用 64 位整数，一次给您 8 个。实际上，一旦将其隔离为一组 8 个字节，您就可以找出错误的字节。

使用[BinaryReader](http://msdn.microsoft.com/en-us/library/system.io.binaryreader.aspx)：

```
saveTime  = binReader.ReadInt32() 
```

或者对于整数数组：

```
Dim count As Integer = binReader.Read(testArray, 0, 3) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T20:12:33.993

我看到两件事可能会有所帮助：

首先，不要总是以 item.Bytes 的形式访问第二个数组，而是使用局部变量直接指向数组。也就是说，在开始循环之前，请执行以下操作：

```
 array2 = item.Bytes 
```

这将节省每次您想要一个字节时从对象取消引用的开销。这在 Visual Basic 中可能会很昂贵，尤其是在该属性上有 Getter 方法的情况下。

此外，使用“确定循环”而不是“for each”。您已经知道数组的长度，因此只需使用该值对循环进行编码。这将避免将数组视为集合的开销。循环看起来像这样：

```
For i = 1 to max Step 1
   If (array1(i) <> array2(i)) 
       Exit For
   EndIf 
Next 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-09T20:38:46.007

与比较算法不严格相关：

您确定您的瓶颈与可用内存和加载字节数组的时间无关吗？加载两个 2 GB 字节数组只是为了比较它们可能会使大多数机器屈服。如果程序设计允许，请尝试使用流来读取较小的块。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-09-06T15:44:36.610

更好的方法...如果您只是想看看两者是否不同，那么不必遍历整个字节数组并将每个字节数组的哈希生成为字符串并比较字符串，从而节省一些时间。MD5 应该可以正常工作并且非常有效。

# c# - 如何在多线程中从 TargetInvocationException 中优雅地恢复？

> ID：627753
> 
> 赞同：2
> 
> 时间：2009-03-09T19:53:31.963
> 
> 标签：c#, multithreading, exception

我在另一个线程中执行长进程时遇到了 TargetInvocationException，这是由 UI 线程（进度条）上的 Windows 控件引起的。此异常导致我的应用程序崩溃（在调试中转到 main 方法）并且无法被 try catch 捕获。我弄清楚是什么造成了这个异常，并修复了它（试图通过超过最大值的值分配“Value”属性）。但这让我想知道如何捕获这样的异常（在生产代码中），所以我可以选择恢复我的应用程序而不是终止应用程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T20:30:20.003

您可能无法恢复很多。就您的操作而言，大量堆栈帧（以及从这些堆栈帧引用的对象）的状态可能由于错误而无效。

因此，充其量您可以恢复到非常高的水平并再次尝试操作。

如果您正在访问的资源能够包含在事务中，那么我建议您这样做，这样您就不必担心持久数据的不一致。

此外，您可能想在 SO 上查看此线程：

[Windows 窗体应用程序中异常处理的最佳实践？](https://stackoverflow.com/questions/183589/c-windows-forms-best-practice-exception-handling)

以及来自 Microsoft 的异常处理应用程序块：

[http://msdn.microsoft.com/en-us/library/cc309505.aspx](http://msdn.microsoft.com/en-us/library/cc309505.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T21:44:23.460

您可以通过静态事件在 GUI 线程上“处理”异常（实际上，您只是收到它们的通知）`Application.UnhandledException`。

当您将处理程序附加到此事件时，将针对 WinForms UI（消息泵）线程上的所有未处理异常调用它。您附加了此处理程序的事实意味着`Application`不会退出。没有它，WinForms 将关闭您的应用程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T20:33:02.383

捕获异常并找到一种机制将其传递回主代码或调用代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T22:53:15.247

不确定您使用的是哪个版本的 .net，如果它是 3.0+，您可以按照这些方式做一些事情。

```
private void UpdateValue(int newValue)
{
    Action myAction = () => progressBar.Value = newValue;

    if (progressBar.InvokeRequired)
        progressBar.Invoke(myAction);
    else
        myAction();
} 
```

使用进度条的新值调用此方法，它将检查调用是否需要编组并进行适当的调用。注意 InvokeRequired 相对昂贵，所以只在需要的地方使用它。如果需要，您可以将其作为扩展方法，以便将此模式用于其他控件。

希望这可以帮助。

# comparison - 比较或分配哪个更昂贵？

> ID：627760
> 
> 赞同：21
> 
> 时间：2009-03-09T19:55:19.463
> 
> 标签：comparison, variable-assignment

我已经开始阅读[算法](http://www.cs.berkeley.edu/~vazirani/algorithms.html)，我一直想知道，在处理相同类型的原语时，哪个是更昂贵的操作、赋值或比较？这在语言之间是否有很大差异？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-09T19:59:29.627

你怎么看？

在最低级别，一个执行两次读取，另一个执行读取和写入。

但你为什么要真正关心？你不应该关心这个级别的性能。针对[Big-O进行优化](http://en.wikipedia.org/wiki/Big_O_notation)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-09T20:07:30.340

微优化几乎总是错误的做法。除非程序运行得太慢，否则甚至不要从它开始，并且您使用分析器来确定慢速部分的确切位置。

一旦你这样做了，我的建议是看看改进代码和数据的局部性，因为缓存未命中几乎肯定比次优指令更糟糕。

这样做后，在相当奇怪的情况下，您可以使用基于分配或基于比较的方法，尝试两者并计时。微优化是一场数字游戏。如果数字不够好，找出原因，然后验证你所做的是否真的有效。

那么，比较是什么意思？条件跳转会给任何模糊不清的现代处理器带来问题，但不同的处理器做不同的事情，并且不能保证任何给定的处理器都会减慢速度。此外，如果其中任何一个导致缓存未命中，那么无论如何这可能是较慢的一个。

最后，语言通常被编译成机器代码，像比较和赋值这样的简单事情通常会被编译成相同的。最大的区别在于 CPU 的类型。

# php - 如何使用循环绑定mysqli参数并将结果存储在数组中？

> ID：627763
> 
> 赞同：5
> 
> 时间：2009-03-09T19:56:00.460
> 
> 标签：php, arrays, mysqli

```
$genre = array(
    'Action',
    'Adventure',
    'Fantasy'
);
$selectGenre_sql = 'SELECT genreID FROM genres WHERE dbGenre = ?';

if ($stmt->prepare($selectGenre_sql)) {
    // bind the query parameters
    $stmt->bind_param('s', $genre);
    // bind the results to variables
    $stmt->bind_result($genres);
    // execute the query
    $stmt->execute();
    $array1 = array();
    while ($stmt->fetch()) {
        $array1[] = $genres;
    }
} 
```

上面的代码从`genreID`when `dbGenre`is equal to获取值`$genre`。然后将结果存储在一个数组中。但它不起作用，因为它`$genre`是一个数组，所以我需要遍历它以从`genreID`每次获取不同的值。

'genres' 表包含两列：**genreID (INT)**和**dbGenre (VARCHAR)**

我只需要每个genreID（即一个数字）...假设当dbGenre 等于Action 时，将genreID 存储在array1 中，然后循环$genre 数组以获取下一个值的genreID 并再次存储在数组 1 中。

我该如何解决？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-09T20:47:54.657

您不能将数组绑定到 SQL 参数。您可以在 SQL 中使用参数来代替*单个文字值*。不是值列表、表达式、列名或表名。

要解决您的情况下的任务，您可以使用以下两种解决方案之一：

**第一个解决方案：**遍历`$genre`数组，一次绑定每个值，并为每个值执行 SQL 查询。

```
$stmt->prepare($selectGenre_sql);
$genre = array();
foreach ($gengre as $genreID) {
    $stmt->bind_param('s', $genreID);
    $stmt->execute();
    $stmt->bind_result($genres);
    while ($stmt->fetch()) {
        $genre[] = $genres;
    }
} 
```

**第二种解决方案：**执行一次查询，带有多个参数，数组中的每个值一个。这需要一些棘手的代码来在 SQL 查询中构建可变数量的`?`占位符，用逗号分隔。

```
$selectGenre_sql = 'SELECT genreID FROM genres WHERE dbGenre IN ('
 . join(',', array_fill(0, count($genre), '?')) . ')'; 
```

您还需要根据数组`bind_param()`中的元素使用可变数量的参数进行棘手的调用：`$genre`

```
$stmt->prepare($selectGenre_sql);
$temp = array();
foreach ($genre as $key => $value) {
    $temp[] = &$genre[$key];
}

array_unshift($genre, str_repeat('i', count($genre)));
call_user_func_array(array($stmt, 'bind_param'), $genre);

$stmt->execute();

$stmt->bind_result($genres);

$array1 = array();
while ($stmt->fetch()) {
    $array1[] = $genres;
} 
```

您可能要考虑使用`PDO_MYSQL`，因为从数组中绑定参数更容易。MySQLi 界面在这种情况下非常尴尬。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-03-09T20:03:47.870

一些东西。

*   可能不是因为您覆盖了 $genre var，尝试在 sedond 情况下将其更改为 $genreArray 吗？
*   确保数据库实际上正在返回东西（在 phpMyAdmin 或类似的东西中尝试）

*   尝试像这样处理：

.

```
 $genreId = -1;
 $stmt->bind_results($genreId);
 $stmt->execute();
 while($stmt->fetch()){
  $genreArray[] = $genreId;
 } 
```

# visual-studio-2008 - 找不到“Visual Studio 2008 SP1”ADO.NET 实体数据模型模板

> ID：627768
> 
> 赞同：10
> 
> 时间：2009-03-09T19:57:31.970
> 
> 标签：visual-studio-2008, entity-framework, ado.net

我已经安装了 Visual Studio Team System 2008 架构版本：9.0.30729.1 SP 和 Microsoft Net Framework 3.5 SP1。

当我要添加一个新项目时，我找不到 ADO.NET 实体数据模型模板。

发生了什么？

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-02T16:23:03.997

确保您有[VS2008 sp1 (http://www.microsoft.com/downloads/details.aspx?FamilyId=FBEE1648-7106-44A7-9649-6D9F6D58056E&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyId=FBEE1648-7106-44A7-9649-6D9F6D58056E&displaylang=en) )。我安装了 .Net Framework 3.5 SP1，但没有安装 VS2008 SP1。...至少那是我做错了。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-09T20:15:44.890

**总结** 正如许多其他答案所表明的那样，这个问题似乎有多种原因。

1.  确保首先安装 Framework 3.5 sp1
2.  确保已安装 Visual Studio 2008 sp1
3.  确保项目以 3.5 框架为目标
4.  将数据模型添加到现有项目，而不是单独的项目类型

**结束总结**

您*可能*正在查看错误的级别。实体框架数据模型是您添加到项目中的东西，它不是一个单独的项目类型。

右键单击现有项目选择添加，新建项目

然后选择 ADO.Net Entity Data Model...

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-31T22:04:27.207

所以，回顾一下：

需要 Visual Studio 2008 Service Pack 1（包括 .Net Framework 3.5 SP1）

*   您必须使用**.Net Framework 3.5**项目*   在解决方案资源管理器中，右键单击并选择“添加”->“新建项目”*   为了便于查找，请在左侧树视图中选择“数据”项*   选择 ADO.NET 实体数据模型并在下面的文本框中指定名称

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-03-25T15:43:30.330

我想你们中的大多数人都将 .net 的 sp1 与 vs2008 的服务包混淆了。很可能你们都有.net 3.5 sp1。您需要同时拥有 .net 3.5 sp1 + vs2008 sp1 ....根据您的网速，后者将花费大量时间来下载和安装..

试试看，这个问题就会得到解决。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-31T21:49:34.903

我遇到了同样的问题，但我的解决方案最终很简单：我的项目默认为 .Net 2.0 项目，需要将其设置为 .Net 3.5，然后才能在“添加新项目”框中为我提供实体框架选项.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-08T14:09:23.253

我有同样的问题。我安装了 Visual Studio SP1 并应用了 .Net Framework 3.5 SP1。

我下载了 Visual Studio SP1 ISO 并将其刻录到 DVD。

我发现我必须卸载 Visual Studio 然后重新安装。只有这样我才能应用 DVD 中的 SP1。

我的 Visual Studio 是一个相对较新的安装。在尝试升级到 SP1 之前，我确实安装了 .Net Framework 3.5 SP1 和 ASP.NET MVC 1.0。这些可能与 SP1 升级产生了冲突。

ISO：[http ://www.microsoft.com/downloads/details.aspx?FamilyID=27673c47-b3b5-4c67-bd99-84e525b5ce61&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyID=27673c47-b3b5-4c67-bd99-84e525b5ce61&displaylang=en)

奥利弗

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-29T10:17:18.547

首先，您需要在以下链接中安装最新版本的 ADO.NET Entity Framework 表单：http: [//www.microsoft.com/downloads/details.aspx? familyid=15DB9989-1621-444D-9B18-D1A04A21B519&displaylang=en](http://www.microsoft.com/downloads/details.aspx?familyid=15DB9989-1621-444D-9B18-D1A04A21B519&displaylang=en)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-01-09T00:35:11.340

我遇到过同样的问题。问题是 ASP.NET MVC 应该在 .NET 3.5 SP1 和 VS2008 SP1 之后安装，如果您之前安装过 - 尝试卸载 ASP.NET MVC、.NET 3.5 SP1 和 VS2008 SP1，然后以正确的顺序安装它。

谢谢，阿蒂

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-09-21T14:53:53.083

我重新安装了 Visual Studio 2008 SP1，然后它工作了！

在这里找到 SP1：http: [//www.microsoft.com/downloads/en/details.aspx? FamilyID=27673c47-b3b5-4c67-bd99-84e525b5ce61&displaylang=en](http://www.microsoft.com/downloads/en/details.aspx?FamilyID=27673c47-b3b5-4c67-bd99-84e525b5ce61&displaylang=en)

# java - 如何从另一个文件导入 Tomcat Server.xml 的 Host 指令？

> ID：627769
> 
> 赞同：0
> 
> 时间：2009-03-09T19:58:16.167
> 
> 标签：java, tomcat, web-applications

我的公司希望能够将其他 Hosts 指令添加到我们的 server.xml（Tomcat 的配置文件）中。这个 Host 指令进入 Engine 指令。我想导入第二个文件，例如 hosts.xml，这样我就可以在这些单独的文件中定义主机。

```
<Host name="localhost" ...>
 ...
<Valve className="org.apache.catalina.valves.AccessLogValve"
     prefix="localhost_access_log." suffix=".txt"
     pattern="common"/>
 ...
</Host> 
```

我查看了 WROX ISBN: 0-7645-4372-5 的 Professional Apache Tomcat 书籍，但那里没有答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T20:32:51.510

为此，您可以将上下文 xml 文件放在适当的位置：

```
${catalina.home}/conf/Catalina/www.example.com/ROOT.xml
${catalina.home}/conf/Catalina/www.foobar.com/ROOT.xml
${catalina.home}/conf/Catalina/www.foobar.com/other-webapp.xml
```

不幸的是，您的 server.xml 仍然必须包含根主机元素：

```
<Engine defaultHost="www.example.com" name="Catalina">
  <主机名="www.example.com"></主机>
  <主机名="www.foobar.com"></主机>
  ...

```

# python - Django 表单

> ID：627772
> 
> 赞同：2
> 
> 时间：2009-03-09T19:58:35.713
> 
> 标签：python, django, django-admin

我曾问过一个与此有关的问题。但我认为直接问我的问题会更好。我有一个与其他两个表“域”和“组”有多对多关系的“用户”表。因此，在管理界面中，我将 Groups 和 Domains 视为 2 ModelMultipleChoiceFields。但我想以更加用户友好的方式在 UI 上呈现它们。我想在域和组中显示每个可用的选项，并根据用户属性选择/取消选择复选框。想知道我是否可以在管理员中执行此操作，或者我需要独立于管理员编写自己的视图。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T20:39:20.467

我认为内置小部件`CheckboxSelectMultiple`可以满足您的需求。如果没有，您将不得不创建自己的小部件。小部件的[文档](http://docs.djangoproject.com/en/dev/ref/forms/widgets/#ref-forms-widgets)是一个很好的起点。最简单的开始方法是从 Django 源中复制现有的小部件并对其进行修改。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-10T14:27:24.160

准确地说，它是 Django 管理员在 ManyToManyField 的情况下选择显示的小部件。在这种情况下，您觉得它的 SelectMultiple 小部件对用户不太友好。

很简单的部分是，您始终可以在使用自己的 ModelForm 时选择小部件。但是如果你想在 Django Admin 中这样做，你需要一个往返。看一下这个。

```
from django.forms import widgets
from django.contrib import admin

class MyModelAdmin(admin.ModelAdmin):
    def formfield_for_manytomany(self, db_field, request=None, **kwargs):
    """
    Get a form Field for a ManyToManyField.
    """
    # If it uses an intermediary model, don't show field in admin.
    if db_field.rel.through is not None:
        return None

    if db_field.name in self.raw_id_fields:
        kwargs['widget'] = admin.widgets.ManyToManyRawIdWidget(db_field.rel)
        kwargs['help_text'] = ''
    elif db_field.name in (list(self.filter_vertical) + list(self.filter_horizontal)):
        kwargs['widget'] = admin.widgets.FilteredSelectMultiple(db_field.verbose_name, (db_field.name in self.filter_vertical))
    else:
        kwargs['widget'] = widgets.CheckboxSelectMultiple()
        kwargs['help_text'] = ''

    return db_field.formfield(**kwargs) 
```

现在，在 admin.py 中定义您的例程管理员为

```
class SomeModelAdmin(MyModelAdmin):
    search_fields = ['foo', 'bar']
    list_display   = ('foo',)
    ordering       = ('-bar',)

admin.site.register(SomeModel, SomeModelAdmin) 
```

您现在将在 DJango Admin 中获得复选框。当然，您将需要一些 CSS 更改。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-10T07:36:02.290

它实际上在管理员中默认使用模型表单。所以，你需要覆盖它。

```
from django import forms
from django.forms import widgets

class DomainForm(forms.ModelForm):

    field2 = YourField(widget=widgets.CheckboxSelectMultiple)

    class Meta:
        model = Domain()
        fields = ('field1', 'field2') 
```

所以，在这种情况下，我已经覆盖了默认的 FIELD2 字段类型。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T20:52:04.740

I'm not completely sure I understand what you are attempting to do, but perhaps something like [filter_horizontal](http://docs.djangoproject.com/en/dev/ref/contrib/admin/#filter-horizontal) would do what you want.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-11-26T13:47:34.643

您可以更改 django 管理界面字段小部件

```
from django.forms import widgets

class UserAdmin(admin.ModelAdmin):
    model = User

    def formfield_for_manytomany(self, db_field, request=None, **kwargs):
        if db_field.name == 'domain' or db_field.name == 'groups':
        kwargs['widget'] = widgets.CheckboxSelectMultiple()

        # or just make all the manytomany fields as checkbox

        kwargs['widget'] = widgets.CheckboxSelectMultiple()

        return db_field.formfield(**kwargs)

    # for other field
    def formfield_for_dbfield(self, db_field, **kwargs):
        .....
        return super(UserAdmin, self).formfield_for_dbfield(db_field, **kwargs)

admin.site.register(User, UserAdmin) 
```

# web-services - 通过 Web 服务将 MS Excel 数据移动到网站

> ID：627773
> 
> 赞同：1
> 
> 时间：2009-03-09T19:58:43.497
> 
> 标签：web-services, excel

我有一个带有数据和图表的 Excel 电子表格模板。我希望能够使用 Web 服务接口将原始数据（可重复地）发布到 Web 服务器。我想用普通的 Excel 来做这件事——没有附加组件或必需的 ActiveX 控件等。

我愿意接受有关 Web 服务技术的建议：REST 等。

是否有任何内置的 API 可以做到这一点？有人可以指出我的文档吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-18T15:10:15.603

在与 Microsoft 开发人员传道者 (J Sawyer) 讨论该主题后，我相信最好的方法是使用 VSTO（Visual Studio Tools for Office）。我将创建一个 clickonce 程序集，该程序集将直接与 Excel 模板交互，读取 Excel 数据并将数据推送到 Web 服务。

似乎没有任何机制只使用香草 Excel 和 VBA。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T20:02:26.687

是的，使用 OLEDB 驱动程序并直接从 Excel 读取数据。（不过，这不会读取图表图像）。

[例子](http://cheeso.members.winisp.net/srcview.aspx?dir=MSOffice&file=adonet-excel.cs)。

然后你可以以任何你认为合适的方式暴露它。休息会很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T22:57:18.187

Microsoft 使用 Microsoft Excel Services 提供了执行此操作的功能，它是 Office SharePoint Server 的一部分。

[SpreadsheetGear for .NET](http://www.spreadsheetgear.com/)可以通过多种方式利用 ASP.NET（aspx 页面或 Web 服务）中的 Excel 工作簿。

查看[实时 ASP.NET 示例](http://www.spreadsheetgear.com/support/samples/)，这些示例展示了如何生成 Excel 工作簿、从 Excel 图表和范围生成图像/仪表板、进行与 Excel 兼容的计算等...

[您可以在此处](https://www.spreadsheetgear.com/downloads/register.aspx)下载免费评估。

免责声明：我拥有 SpreadsheetGear LLC

# php - PHP将函数名作为参数传递然后调用该函数？

> ID：627775
> 
> 赞同：48
> 
> 时间：2009-03-09T19:58:55.557
> 
> 标签：php, function, parameters

我需要将一个函数作为参数传递给另一个函数，然后从函数内部调用传递的函数......这对我来说可能更容易在代码中解释......我基本上想做这样的事情：

```
function ($functionToBeCalled)
{
   call($functionToBeCalled,additional_params);
} 
```

有没有办法做到这一点.. 我正在使用 PHP 4.3.9

谢谢！

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2009-03-09T20:00:36.660

我想你正在寻找[`call_user_func`](http://us2.php.net/function.call-user-func).

PHP手册中的一个例子：

```
<?php
function barber($type) {
    echo "You wanted a $type haircut, no problem";
}
call_user_func('barber', "mushroom");
call_user_func('barber', "shave");
?> 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-03-09T20:04:42.453

```
function foo($function) {
  $function(" World");
}
function bar($params) {
  echo "Hello".$params;
}

$variable = 'bar';
foo($variable); 
```

此外，您可以这样做。请参阅[变量函数](http://us.php.net/manual/en/functions.variable-functions.php)。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2009-03-09T20:13:45.020

在 php 中，这非常简单。

```
<?php

function here() {
  print 'here';
}

function dynamo($name) {
 $name();
}

//Will work
dynamo('here');
//Will fail
dynamo('not_here'); 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-05-07T23:06:59.870

你也可以使用[`call_user_func_array()`](http://php.net/manual/en/function.call-user-func-array.php). 它允许您将参数数组作为第二个参数传递，因此您不必确切知道要传递的变量数量。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2013-12-06T18:20:27.950

我知道最初的问题是关于 PHP 4.3，但现在已经过了几年，我只是想提倡我在 PHP 5.3 或更高版本中的首选方式。

PHP 5.3+ 现在包括对[匿名函数（闭包）](http://www.php.net/manual/en/functions.anonymous.php)的支持，因此您可以使用一些标准的函数式编程技术，例如在 JavaScript 和 Ruby 等语言中（有一些注意事项）。用“闭包风格”重写上面的 call_user_func 示例看起来像这样，我发现它更优雅：

```
$barber = function($type) {
    echo "You wanted a $type haircut, no problem\n";
};

$barber('mushroom');
$barber('shave'); 
```

显然，在这个例子中这并没有给你带来太多好处——当你将这些匿名函数传递给其他函数时（如原始问题中所示），功能和灵活性就来了。因此，您可以执行以下操作：

```
$barber_cost = function($quantity) {
    return $quantity * 15;
};

$candy_shop_cost = function($quantity) {
    return $quantity * 4.50;   // It's Moonstruck chocolate, ok?
};

function get_cost($cost_fn, $quantity) {
    return $cost_fn($quantity);
}

echo '3 haircuts cost $' . get_cost($barber_cost, 3) . "\n";
echo '6 candies cost $' . get_cost($candy_shop_cost, 6) . "\n"; 
```

当然，这可以使用 call_user_func 来完成，但我发现这种语法更加清晰，尤其是在涉及命名空间和成员变量时。

一个警告：我将是第一个承认我不确切知道这里发生了什么的人，但你不能总是调用包含在成员或静态变量中的闭包，可能在其他一些情况下也是如此。但是将其重新分配给局部变量将允许调用它。因此，例如，这会给您一个错误：

```
$some_value = \SomeNamespace\SomeClass::$closure($arg1, $arg2); 
```

但是这个简单的解决方法解决了这个问题：

```
$the_closure = \SomeNamespace\SomeClass::$closure;
$some_value = $the_closure($arg1, $arg2); 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2016-05-16T08:59:55.660

如果您需要将参数作为参数的传递函数，您可以尝试以下操作：

```
function foo ($param1){
   return $param1;
}

function bar ($foo_function, $foo_param){
    echo $foo_function($foo_param);
}

//call function bar
bar('foo', 'Hi there');  //this will print: 'Hi there' 
```

[phpfiddle 示例](http://phpfiddle.org/lite?code=%3C?php%5Cnfunction%20foo%20($param1)%7B%5Cn%20return%20$param1;%5Cn%7D%5Cn%5Cnfunction%20bar%20($foo_function,%20$foo_param)%7B%5Cn%20echo%20$foo_function($foo_param);%5Cn%7D%5Cn%5Cn//call%20function%20bar%5Cnbar(%27foo%27,%20%27Hi%20there%27);%5Cn%5Cn?%3E%5Cn)

希望它会有所帮助...

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2018-11-20T02:28:32.947

如果您想在 PHP 类中执行此操作，请查看以下代码：

```
// Create a sample class
class Sample
{

    // Our class displays 2 lists, one for images and one for paragraphs
    function __construct( $args ) {
        $images = $args['images'];
        $items  = $args['items'];
        ?>
        <div>
            <?php 
            // Display a list of images
            $this->loop( $images, 'image' ); 
            // notice how we pass the name of the function as a string

            // Display a list of paragraphs
            $this->loop( $items, 'content' ); 
            // notice how we pass the name of the function as a string
            ?>
        </div>
        <?php
    }

    // Reuse the loop
    function loop( $items, $type ) {
        // if there are items
        if ( $items ) {
            // iterate through each one
            foreach ( $items as $item ) {
                // pass the current item to the function
                $this->$type( $item ); 
                // becomes $this->image 
                // becomes $this->content
            }
        }
    }

    // Display a single image
    function image( $item ) {
        ?>
        <img src="<?php echo $item['url']; ?>">
        <?php 
    }

    // Display a single paragraph
    function content( $item ) {
        ?>
        <p><?php echo $item; ?></p>
        <?php 
    }
}

// Create 2 sample arrays
$images = array( 'image-1.jpg', 'image-2.jpg', 'image-3.jpg' );
$items  = array( 'sample one', 'sample two', 'sample three' );

// Create a sample object to pass my arrays to Sample
$elements = { 'images' => $images, 'items' => $items }

// Create an Instance of Sample and pass the $elements as arguments
new Sample( $elements ); 
```

# c# - 有没有什么简单的方法可以根据 C# 中的键对 NameValueCollection 进行排序？

> ID：627779
> 
> 赞同：6
> 
> 时间：2009-03-09T19:59:30.873
> 
> 标签：c#, namevaluecollection

我正在寻找一种简单的方法来根据键对 NameValueCollection 进行排序 - 但它不应该是一个沉重的性能。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-09T20:07:26.860

`SortedDictionary<string,string>`从or开始`SortedList<string,string>`，你已经在那里了......

如果每个键需要多个项目，请考虑使用`SortedDictionary<string,List<string>>`. 有一些方法可以通过扩展方法来简化加法等 - 它不必很可怕。

另请注意，这`NameValueCollection`是不区分大小写的，因此您可能需要使用其中一种不区分大小写的比较 - 例如：

```
Dictionary<string,string> data = new Dictionary<string,string>(
            StringComparer.InvariantCultureIgnoreCase); 
```

（编辑）这是使用扩展方法在 C# 3.0 中针对单个键填充多个值的示例：

```
 static void Main()
    {
        var data = new Dictionary<string, List<string>>(
            StringComparer.InvariantCultureIgnoreCase);
        data.Add("abc", "def");
        data.Add("abc", "ghi");
    }

    static void Add<TKey, TValue>(this IDictionary<TKey, List<TValue>> lookup,
        TKey key, TValue value)
    {
        List<TValue> list;
        if (!lookup.TryGetValue(key, out list))
        {
            list = new List<TValue>();
            lookup.Add(key, list);
        }
        list.Add(value);
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T20:28:17.093

这是我不太引以为豪的蛮力破解，但如果您需要快速而肮脏的东西，它就可以工作。

```
public static void Sort(this NameValueCollection nameValueCollection)
    {
        // Create a temporary collection the same size as the original
        NameValueCollection tempNameValueCollection = new NameValueCollection(nameValueCollection.Count);

        // Sort the keys
        string[] keys = nameValueCollection.AllKeys;
        Array.Sort(keys);

        foreach (string key in keys)
        {
            // Sort the values
            string[] values = nameValueCollection[key].Split(',');
            Array.Sort(values);

            // Add each value to the temporary collection
            foreach (string value in values)
            {
                tempNameValueCollection.Add(key, value);
            }
        }

        // Clear the original collection
        nameValueCollection.Clear();

        // Add the sorted entries back
        nameValueCollection.Add(tempNameValueCollection);
    } 
```

# webserver - 网站分区和 URL 空间

> ID：627780
> 
> 赞同：2
> 
> 时间：2009-03-09T19:59:32.043
> 
> 标签：webserver, load-balancing, partitioning, website-hosting

我的网站正在增长。我需要将功能集分区到不同的服务器组，而不是让所有功能在单个服务器副本上运行。我在 Windows 网络负载平衡设置中有 8 台相同的服务器。

问题是：我需要保持 URL 空间相同。什么是可行的解决方案？我不想为功能集启动新域。我正在考虑某种具有基于 URL 的重写/路由功能的反向代理（？！？）。在软件或硬件方面有什么建议吗？这将取代 WNLB 设置，因为它没有我需要的功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T22:18:51.133

确实有几种实现负载均衡的方案：

1.  DNS 循环
2.  DNS 负载平衡（使用 lbnamed）
3.  代理循环
4.  硬件/TCP 循环

我理解 1) 和 2) 在这里不是一个选择，所以......如果你有钱并且**真的需要高性能**，那就选择 4)。否则，请选择 3)。

对于 Proxy Round-Robin，有几种解决方案是可能的：[Apache mod_rewrite](http://httpd.apache.org/docs/2.0/mod/mod_rewrite.html)、[Apache mod_proxy](http://httpd.apache.org/docs/2.0/mod/mod_proxy.html)、[Squid](http://wiki.squid-cache.org/SquidFaq/ReverseProxy)（当然还有许多我不知道的其他解决方案）。

*   对于“哑”负载平衡，Apache mod_rewrite 的[URL 重写指南](http://httpd.apache.org/docs/2.0/misc/rewriteguide.html#content)中有一个示例（请参阅*代理吞吐量循环*部分）。

*   Apache mod_proxy 可以充当代理将客户端连接到互联网，但**通常用作反向代理将 url 重定向到另一台服务器**。它没有缓存功能（但可以与 mod_cache 和 mod_rewrite...一起使用）。

*   Squid 是一种代理缓存，通常用于将客户端连接到 Internet。但它也可以用作反向代理并配置为缓存请求并加速内容交付。

如您所见，选择其中之一取决于您要代理的内容和方式。在你的情况下，如果你想在 Linux 上缓存（如果它是一个选项），我会考虑运行 Apache mod_proxy 或 Squid。

关于硬件，我不是专家，但我认为“小型”到“中型”专用服务器就足够了。只是不要忘记所有请求都将通过这台机器，因此它的大小很大程度上取决于您的流量，这看起来不错。这可能需要对现实生活中的数据进行一些挖掘。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T20:34:40.177

如果您有 8 台服务器，我建议使用其中的 7 台来分担工作负载，并使用一台前端服务器充当代理。

您的前端服务器可以运行 Apache 并使用 mod_proxy 将每个 HTTP 请求委托给 7 个后端服务器之一。如果需要，您可以设置 mod_proxy 以根据传入的 URL 委派工作，例如，您可以让一台服务器提供视频，两个服务博客条目，其余的做任何其他事情。

您的前端服务器将非常轻巧：运行 Apache 和其他任何东西。您还可以使用 Squid 或 Apache 的 mod_cache 将静态内容缓存在此前端服务器上，这样对图像、js、css 和其他静态内容的请求一旦被缓存就永远不会到达您的后端 7 服务器。

编辑：我刚刚阅读了 Pascal 的评论，他提出了同样的建议。我会修改他+1

# flash - Flash 中的文本框大小

> ID：627781
> 
> 赞同：1
> 
> 时间：2009-03-09T20:00:13.417
> 
> 标签：flash, text, field

有没有办法在运行时获取动态文本框的大小？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T20:04:47.460

当然，要么用它的**textWidth** / **textHeight**属性来表示它的可见大小，要么用它的**宽度**/**高度**属性来表示边界框的大小。

# java - 有哪些 Java 内存管理最佳实践？

> ID：627784
> 
> 赞同：38
> 
> 时间：2009-03-09T20:00:52.150
> 
> 标签：java, memory-management

我正在从以前的开发人员那里接手一些应用程序。当我通过 Eclipse 运行应用程序时，我看到内存使用量和堆大小增加了很多。经过进一步调查，我发现他们在循环中一遍又一遍地创建一个对象以及其他东西。

我开始经历并做一些清理工作。但我经历的越多，我就越想问“这真的有什么用吗？”

例如，不是在上面提到的循环之外声明一个变量，而是在循环中设置它的值……他们在循环中创建了对象。我的意思是：

```
for(int i=0; i < arrayOfStuff.size(); i++) {
    String something = (String) arrayOfStuff.get(i);
    ...
} 
```

相对

```
String something = null;
for(int i=0; i < arrayOfStuff.size(); i++) {
    something = (String) arrayOfStuff.get(i);
} 
```

我说底部循环更好吗？也许我错了。

另外，在上面的第二个循环之后，我将“某物”设置为空怎么办？这会清除一些记忆吗？

在这两种情况下，我可以遵循哪些良好的内存管理最佳实践来帮助我在应用程序中保持较低的内存使用率？

**更新：**

到目前为止，我感谢大家的反馈。但是，我并没有真正询问上述循环（尽管根据您的建议，我确实回到了第一个循环）。我正在尝试获得一些我可以留意的最佳实践。类似于“使用完集合后，将其清除”之类的东西。我只需要确保这些应用程序不会占用太多内存。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-03-09T20:08:19.357

不要试图智取虚拟机。第一个循环是建议的最佳实践，无论是性能还是可维护性。在循环之后将引用设置回 null 并不能保证立即释放内存。当您使用尽可能小的范围时，GC 将尽其所能。

详细介绍这些内容的书籍（从用户的角度来看）是[Effective Java 2](http://java.sun.com/docs/books/effective/)和[Implementation Patterns](https://rads.stackoverflow.com/amzn/click/com/0321413091)。

如果您想了解有关性能和 VM 内部的更多信息，您需要查看[Brian Goetz](http://www.briangoetz.com/)的演讲或阅读书籍。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-09T20:08:46.157

除了 ; 的范围外，这两个循环是等价的`something`。有关详细信息，请参阅[此问题](https://stackoverflow.com/questions/110083/which-loop-has-better-performance-why)。

一般最佳实践？嗯，让我们看看：除非你有充分的理由，否则不要将大量数据存储在静态变量中。完成后从集合中删除大对象。哦，是的，“测量，不要猜测。” 使用分析器查看内存分配的位置。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-09T20:10:35.200

您的两个代码示例中都没有创建对象。您只需将对象引用设置为已在 arrayOfStuff 中的字符串。所以在记忆方面没有区别。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-09T20:09:39.883

这两个循环将使用基本相同的内存量，任何差异都可以忽略不计。“String something”仅创建对对象的引用，而不是新对象本身，因此使用的任何额外内存都很小。另外，编译器/与 JVM 结合可能会优化生成的代码。

对于内存管理实践，您应该真正尝试更好地分析您的内存以了解瓶颈实际在哪里。特别注意指向大块内存的静态引用，因为它永远不会被收集。

您还可以查看弱引用和其他专门的内存管理类。

最后，请记住，如果应用程序占用内存，则可能是有原因的......

**更新**内存管理的关键是数据结构，以及你需要多少性能/何时。权衡通常是在内存和 CPU 周期之间。

例如，缓存可能会占用大量内存，这专门用于提高性能，因为您试图避免昂贵的操作。

因此，请仔细考虑您的数据结构，并确保您不会将内容保存在内存中的时间超过您必须的时间。如果它是一个 Web 应用程序，请避免将大量数据存储到会话变量中，避免对巨大的内存池进行静态引用等。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-09T20:46:03.523

JVM 最擅长释放短期对象。尽量不要分配你不需要的对象。但是，在您了解工作负载、对象生命周期和对象大小之前，您无法优化内存使用。分析器可以告诉您这一点。

最后，你必须避免做的第一件事：永远不要使用终结器。终结器会干扰垃圾收集，因为对象不能只是被释放，而是必须排队等待终结，这可能会发生也可能不会发生。最好不要使用终结器。

至于您在 Eclipse 中看到的内存使用情况，它不一定是相关的。GC 将根据有多少可用内存来完成其工作。如果您有大量可用内存，则在应用程序关闭之前您可能看不到单个 GC。如果您发现您的应用程序内存不足，那么只有真正的分析器才能告诉您泄漏或效率低下的位置。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-09T20:10:34.140

第一个循环更好。因为

*   变量的东西会更快（理论上）
*   该程序更好地阅读。

但从记忆的角度来看，这无关紧要。

如果您有内存问题，那么您应该分析它的消耗位置。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-03-09T22:01:14.873

在我看来，你应该避免像这样的微优化。它们花费了大量的大脑周期，但大部分时间影响不大。

您的应用程序可能有一些中央数据结构。这些是你应该担心的。例如，如果你用一个很好的大小估计来填充它们，以避免重复调整底层结构的大小。这尤其适用于`StringBuffer`、`ArrayList`等`HashMap`。设计好你对这些结构的访问，所以你不必复制很多。

使用适当的算法来访问数据结构。在最低级别，就像您提到的循环一样，使用`Iterator`s，或者至少避免`.size()`一直调用。（是的，您每次都在询问列表的大小，大多数情况下都不会改变。）顺便说一句，我经常看到与`Map`s 类似的错误。人们迭代`keySet()`和`get`每个值，而不是一开始就迭代`entrySet()`。内存管理器会感谢您提供额外的 CPU 周期。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-07-05T15:16:11.037

正如上面的一张海报所建议的，使用分析器来测量程序某些部分的内存（和/或 cpu）使用情况，而不是试图猜测它。您可能会对您的发现感到惊讶！

这还有一个额外的好处。您将更多地了解您的编程语言和应用程序。

我使用 VisualVM 进行分析并强烈推荐它。它带有 jdk/jre 发行版。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-09T20:10:43.343

嗯，第一个循环实际上更好，因为某些东西的范围更小。关于内存管理 - 这没什么大不了的。

当您将对象存储在集合中但忘记删除它们时，大多数 Java 内存问题都会出现。否则 GC 会让他的工作做得很好。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-09T20:11:42.420

第一个例子很好。除了每次通过循环的堆栈变量分配和释放（非常便宜和快速）之外，那里没有任何内存分配。

原因是所有被“分配”的都是一个引用，它是一个 4 字节的堆栈变量（无论如何在大多数 32 位系统上）。堆栈变量是通过添加到表示堆栈顶部的内存地址来“分配”的，因此非常快速且便宜。

您需要注意的是 for 循环，例如：

```
for (int i = 0; i < some_large_num; i++)
{
   String something = new String();
   //do stuff with something
} 
```

因为那实际上是在做内存分配。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-03-09T21:52:46.983

如果您还没有安装，我建议您安装[Eclipse 测试和性能工具平台](http://www.eclipse.org/tptp/)(TPTP)。如果要转储和检查堆，请查看 SDK [jmap 和 jhat](http://java.sun.com/javase/6/docs/technotes/tools/index.html)工具。另请参阅[监控和管理 Java SE 6 平台应用程序](http://java.sun.com/developer/technicalArticles/J2SE/monitoring/)。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-01-24T15:54:58.017

“我说底部循环更好吗？”，答案是否定的，不仅更好，在同样的情况下是必要的......变量定义（不是内容），是在内存堆中进行的，并且是有限，在第一个例子中，每个循环在这个内存中创建一个实例，如果“arrayOfStuff”的大小很大，可能会出现“Out of memory error:java heap space”......

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-01-03T12:21:45.467

据我了解您正在查看，底部循环并没有更好。原因是即使您尝试重用单个引用（Ex-something），事实是对象（Ex-arrayOfStuff.get(i)）仍然从列表（arrayOfStuff）中引用。为了使对象符合收集条件，不应从任何地方引用它们。如果您确定在此之后列表的生命周期，您可以决定在单独的循环中从中删除/释放对象。

可以从静态角度进行的优化（即没有从任何其他线程对此 List 进行修改），最好避免重复调用 size() 。也就是说，如果您不期望大小发生变化，那么为什么要一次又一次地计算它；毕竟它不是array.length，它是list.size()。

# python - Python dlopen/dlfunc/dlsym 包装器

> ID：627786
> 
> 赞同：3
> 
> 时间：2009-03-09T20:01:36.343
> 
> 标签：python, linker, dlopen

任何人都知道是否真的存在一个包装器或移植库来访问 Python 上的 Unix 动态链接器？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-09T20:09:46.607

[ctypes](http://docs.python.org/library/ctypes.html)会做你想做的事吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T20:12:31.403

该模块称为[dl](http://docs.python.org/library/dl.html)：

```
>>> import dl
>>> dl.open("libfoo.so")
<dl.dl object at 0xb7f580c0>
>>> dl.open("libfoo.so").sym('bar')
1400432 
```

...虽然它很讨厌，您可能需要考虑使用 ctypes 或扩展模块。

**编辑**

显然， dl 在 2.6 中已被弃用，因此您将希望使用具有更好 API 的 ctypes。

# visual-studio-2005 - 由普通用户运行时适用于 MSI 的 .NET 应用程序快捷方式

> ID：627795
> 
> 赞同：2
> 
> 时间：2009-03-09T20:02:41.770
> 
> 标签：visual-studio-2005, windows-installer, shortcuts

我有一个 C# 应用程序，它使用 Visual Studio 2005 中的内置 MSI 构建器。

使用 MSI（通过 CD）将应用程序部署到目标计算机后，我启动桌面快捷方式（作为特权用户），程序按预期运行。但是，如果我注销然后以非特权用户身份重新登录并尝试运行应用程序，计算机会开始寻找 MSI，因为它想要修复/配置它。当然这会失败，因为它无法再次找到 MSI。

但是，我可以在 Program Files 中浏览到应用程序的文件夹并将快捷方式复制到桌面并运行得非常好。

我如何解决这个问题？我已经更改了许多设置，试图在没有运气的情况下解决这个问题。

编辑：我设置了 InstallAllUsers=True 。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-07-22T15:37:00.380

正如[这里](http://www.discussweb.com/c-programming/13643-advertised-shortcuts-installers-how-avoid.html)所解释的，Visual Studio 只能创建使用 MSI 文件来检查所有文件和注册表值是否存在的“广告快捷方式”。

在同一个链接中，您可以找到解决方案：编辑 MSI 数据库以在属性表中添加一个值。我测试了它，你只需要添加值“1”的“ **DISABLEADVTSHORTCUTS** ”。

要添加它，您可以使用 ORCA 工具，它是[Windows Installer SDK](http://www.microsoft.com/downloads/details.aspx?familyid=6A35AC14-2626-4846-BB51-DDCE49D6FFB6)的一部分。这是手动方式......我想你不会喜欢它。

因此，我进一步查看，发现您可以使用 Window Installer SDK 提供的命令行和 VBS 脚本来执行此操作：

```
Cscript WiRunSQL.vbs Test.msi "INSERT INTO `Property` (`Property`.`Property`,`Property`.`Value`) VALUES ('DISABLEADVTSHORTCUTS',1)" 
```

现在您只需为您的设置项目设置一个构建后事件（它与“常规”项目有点不同，请参见[此处](http://blogs.msdn.com/astebner/archive/2006/08/24/716145.aspx)）以执行此脚本。

它对我很有用！

其他资源：
[MSI 属性表参考](http://msdn.microsoft.com/en-us/library/aa370908%28VS.85%29.aspx)
[使用命令行编辑 MSI](http://msdn.microsoft.com/en-us/library/aa368562%28VS.85%29.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T20:05:48.380

当您安装时，通常有一个选项可以为“每个人”或“只是我”安装。一定要检查每个人。您甚至可以在构建 msi 时将其设置为默认值。

作为附加说明，旧版本的 MS Office 也有同样的问题（也许它仍然存在；我不需要检查最近的版本——也许这意味着没有解决方案）。早在我以前在一家小型电脑商店工作时，每当我们设置新版本时，我们总是会创建初始用户帐户，然后手动启动一次办公室，以便为我们的用户排除额外的步骤。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-10T02:42:35.117

基本上，桌面快捷方式是触发 Windows 安装程序弹性检查的特殊快捷方式 - 尝试恢复丢失的文件、文件夹和注册表项。

我很可能会说您缺少一些每个用户的注册表项（HKCU 或 HKCR），因此 Windows Installer 会尝试查找 MSI 来重新创建它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T20:21:43.610

**编辑 2010 年 6 月：**我创建的 MSI 在 Windows XP 上的 VS 2005 下。当我尝试在 Vista 下使用相同的 MSI 安装/卸载时，卸载不是很干净。我没有评估其程度或原因，但我不建议在没有进一步调查的情况下在 Vista 上使用此解决方案。

**原帖：**

我仍然没有找到真正解决我的问题的方法，尽管解决方法——有点破解——对于我的目的来说已经足够好了。我在其他网站上找到了这个建议（如果我能再次找到它，我会发布一个链接）。

我创建了一个具有两个功能的 VBS 文件：一个创建快捷方式，另一个根据需要创建目录结构。当文件执行时，它会根据开发人员认为合适的次数调用 MakeShortcut。

第二个 VBS 文件的工作方式相同，但删除了快捷方式。

我将第一个文件称为安装文件夹中自定义操作的一部分（右键单击安装项目、查看、自定义操作）。我在卸载文件夹中调用第二个。

问题是这两个 VBS 文件被安装到目标目录以及程序的其余部分。可能有办法摆脱它们，但我真的不在乎它们留在那里。同样，这有点像 hack，并不像我希望的那样优雅，但在我找到更好的解决方案之前它运行得很好。

这是两个文件，以防有人想使用它们：

**'创建快捷方式.VBS**

```
MakeShortcut "%AllUsersProfile%\Start Menu\Programs\My Prog Folder", _
             "My Prog", _
             "%ProgramFiles%\My prog\prog.exe"

Function MakeShortcut (location, text, target)

    Dim objShortcut
    Dim objShell
    Dim expLocation

    Set objShell = CreateObject("WScript.Shell")
    expLocation  = objShell.ExpandEnvironmentStrings(location)
    expTarget    = objShell.ExpandEnvironmentStrings(target)

    MakeDirectory(expLocation)

    set objShortcut = objShell.CreateShortcut(expLocation & "\" & text & ".lnk") 
    objShortcut.TargetPath = expTarget
    objShortcut.Save
End Function

Function MakeDirectory (newPath)

    Dim objFSO
    Dim arrPath
    Dim length
    Dim count
    Dim path

    Set objFSO = CreateObject("Scripting.FileSystemObject")

    If objFSO.FolderExists(newPath) Then    
        Exit Function
    End If

    path = ""
    count = 0
    arrPath = split(newPath, "\")
    length = ubound(arrPath)
    While count <= length 
        path = path + arrPath(count) + "\"
        count = count + 1
        If Not objFSO.FolderExists(path) Then 
            objFSO.CreateFolder(path)
        End If
    Wend
End Function 
```

**删除快捷方式.VBS**

```
DeleteShortcut "%AllUsersProfile%\Start Menu\Programs\My Prog Folder", _
               "My Prog.lnk", _
               True

Function DeleteShortcut (location, shortcut, delLoc)

    Dim objShortcut
    Dim objShell
    Dim expLocation

    Set objShell = CreateObject("WScript.Shell")
    Set objFSO   = CreateObject("Scripting.FileSystemObject")
    expLocation  = objShell.ExpandEnvironmentStrings(location)

    DeleteDirectory(expLocation)

    If objFSO.FileExists(expLocation) Then
       objFSO.DeleteFile expLocation & "\" & shortcut
    End If 

    If delLoc = True Then
        DeleteDirectory location
    End If

End Function

Function DeleteDirectory (path)

    Dim objFSO

    Set objFSO = CreateObject("Scripting.FileSystemObject")

    If objFSO.FolderExists(path) Then  
        objFSO.DeleteFolder path, True
    End If
End Function 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-22T20:32:59.370

如果 MSI 将任何注册表项写入 HKCU，那么当新用户第一次运行该应用程序时，Windows Installer 会看到该用户不存在这些条目并尝试创建它们。为什么 Windows Installer 认为它需要原始 MSI 文件，这超出了我的理解（C:\Windows\Installer 中的存根应该足够了，但似乎还不够）。

在任何情况下，替换快捷方式都不是完整的快捷方式，因为其他操作（例如调用 COM 组件）可以调用与广告快捷方式调用相同的自我修复过程。

# asp.net - 在嵌套列表视图中查找控件

> ID：627801
> 
> 赞同：0
> 
> 时间：2009-03-09T20:04:21.657
> 
> 标签：asp.net

我正在使用来自 [mattberseth.com/blog/2008/01/building_a_grouping_grid_with.html 的 Matt Berseth 的示例构建一个可折叠的分组网格](http://mattberseth.com/blog/2008/01/building_a_grouping_grid_with.html)

它有一个嵌套在外部列表视图“lvOuter”中的内部列表视图“lvInner”。我正在尝试使用 lv_Inner 访问文本框

```
Protected Sub lvInner_ItemDataBound(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.ListViewItemEventArgs) Handles lvInner.ItemDataBound

    If e.Item.ItemType = ListViewItemType.DataItem Then

     Dim tb As TextBox = TryCast(e.Item.FindControl("lvOuter").FindControl("lvInner").FindControl("TextBox1"), TextBox)
           ' Do something to TextBox1

     End If
EndSub 
```

我在 Dim tb 行上收到“对象引用未设置为对象的实例”错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-09T20:08:27.640

您只需要简单地执行 e.Item.FindControl("textbox")，e.Item 已被限定为正确的 listView。

```
Protected Sub lvInner_ItemDataBound(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.ListViewItemEventArgs) Handles lvInner.ItemDataBound

If e.Item.ItemType = ListViewItemType.DataItem Then

 Dim tb As TextBox = TryCast(e.Item.FindControl("TextBox1"), TextBox)
       ' Do something to TextBox1

 End If
EndSub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T11:16:54.897

FindControl 很方便，但不是递归的。

如果页面上有控件的深层嵌套，则可能需要递归搜索页面的控件层次结构以找到所需的控件。

编写自己的方法...

C# 示例：（使用任何免费的 VBtoC# 在线工具进行转换）

```
public static System.Web.UI.Control FindControlFromTop(System.Web.UI.Control start, string id, System.Web.UI.Control exclude)
        {
            System.Web.UI.Control foundControl;

            if (start != null && id != null)
            {
                foundControl = start.FindControl(id);

                if (foundControl != null)
                    if(foundControl.ID.Equals(id))
                        return foundControl;

                foreach (System.Web.UI.Control control in start.Controls)
                {
                    if (control != exclude)
                        foundControl = FindControlFromTop(control, id, null);

                    if (foundControl != null)
                        if (foundControl.ID.Equals(id))
                            return foundControl;
                }
            }

            return null;
        } 
```

# java - Spring的依赖注入不会破坏信息隐藏吗？

> ID：627807
> 
> 赞同：14
> 
> 时间：2009-03-09T20:06:37.550
> 
> 标签：java, spring, dependency-injection, encapsulation

来自 C++ 背景的我必须掌握 Java 世界及其框架的复杂性。查看 DI 的 spring 框架，我发现我很难相信我必须将每个 setter 函数都公开给 DI。这个要求不是破坏了信息隐藏的原则吗？

当然，我希望 spring 能够设置我的类的一些私有部分，但我当然不希望每个客户端类都能够这样做。

我在这里想念什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-09T20:13:01.997

我同意你的观点——这就是我更喜欢构造函数注入的原因。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-09T20:47:21.897

如果您*对接口进行编码*，则只需要在实现上公开设置器。当您将接口注入系统的其他部分时，它们无法访问对象的实现细节或状态。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-09T20:13:43.553

您（可能）必须制作一个 setter，它将通知外部您的一些内部细节，但没有必要制作一个 getter。所以你透露了*一些*信息，但不是太多；除了其预期目的之外，它对任何事情都没有真正的用处。

此外，我只建议使用注释和@Autowired，在这种情况下，您不需要创建公共设置器。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-09T20:14:46.780

如果您使用弹簧注释（@Autowired），您可以 DI 私有成员。

在我看来，如果您追求松散耦合和（单元）可测试性，那么 DI 会弹出不应隐藏的信息。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-09T20:33:11.230

我在这里基本上有同样的问题：

[框架时代的封装](https://stackoverflow.com/questions/559953/encapsulation-in-the-age-of-frameworks)

我认为答案可能是构造函数注入。用 setter 暴露你的属性使得封装任何东西并保持良好的对象状态变得非常困难。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-18T19:18:14.647

从未使用过@Autowired，我倾向于在构造函数中使用参数，但有时很难理解参数的含义，特别是如果您有很多参数 - 在这种情况下，我更喜欢使用 Effective 中描述的“Builder”方法爪哇。构造函数接收构建对象（具有设置器），并用它构造自己。类的注入属性是最终的（不变性），“Builder”类包含setter但不包含getter（它不需要，因为我们将其声明为正在构造的类的内部类），并且不需要setter仅为 Spring 创建：

```
<bean id="runnable" class="MyClass">
   <constructor-arg>
     <bean class="MyClass$Builder">
       <property name="p1" value="p1Value"/>
       <property name="p2" value="p2Value"/>
       <property name="p3" value="p3Value"/>
       <property name="p4" value="p4Value"/>
     </bean>
   </constructor-arg>
</bean> 
```

班级代码：

```
public class MyClass {
   private final String p1;
   private final String p2;
   private final String p3;
   private final String p4;
   public MyClass(Builder builder) {
      this.p1 = builder.p1;
      this.p2 = builder.p2;
      this.p3 = builder.p3;
      this.p4 = builder.p4;
   }

   ...

   public static class Builder {
      private String p1;
      private String p2;
      private String p3;
      private String p4;
      public void setP1(String p1) {
         this.p1 = p1;
      }
      ... and so on
   }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-09T20:32:03.027

我想这是一个权衡。你减少了硬连线的依赖，但你可能会暴露你的实现的胆量。使用正确的抽象，您也可以减少这种情况，但随后会增加代码库的复杂性（例如，具有可以是 LDAP 连接或 SQL 连接的通用“连接”）。

就个人而言，我认为使用构造函数注入也无济于事，因为它更具概念性。

我将不得不检查@Autowire，tho'。

tj

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-18T19:08:23.667

只是想提一下，我（无意中）发布了这个问题的更通用版本，并且对这个问题有一些进一步的见解：[依赖注入必须以封装为代价吗？](https://stackoverflow.com/questions/1005473/must-dependency-injection-come-at-the-expense-of-encapsulation)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-04-13T13:27:45.870

不同意 Spring 打破封装的观点。即使你有 pojo，你已经在类中公开了并且第三方使用了你的 jar，jar 的消费者仍然有可能做同样的事情，这在 Spring bean 配置中是可能的。（适用于任何其他 OOP 语言）

Spring 只是提供了可以通过代码完成的方法，并且该控件移出代码（IOC）。

消费者（考虑其他程序员使用您的库），通过 spring 配置创建 bean，您的代码仍然可以控制。没有人阻止您在 setter 中验证用户给出的输入（spring IOC 框架也通过其他类调用您的 setter 完成的相同代码）。

```
public void setAge(int age) {
 if ( age < 0 ) {
   throw new AppException("invalid age!");
 }
 this.age=age;
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-04-27T13:20:08.280

这也是我更喜欢 Guice 的另一个原因；) Guice 和 Spring 都实现了 JSR 330 DI 规范，但是使用 Guice，我可以在没有设置器的情况下注入我的私有实例字段，我真的不喜欢构造函数注入，因为它似乎更难重构。在我的拙见中，它也只是更多的打字而没有多大价值。

后来，迪恩

# delphi - 我怎么能在德尔福做到这一点？

> ID：627808
> 
> 赞同：1
> 
> 时间：2009-03-09T20:07:00.823
> 
> 标签：delphi, ado, bde

我正在将应用程序从 BDE 转换为 ADO。

在 BDE 下，如果查询是打开的并且您调用了“Sql.Clear”，它将自动关闭数据集。

但是，在 TADOQuery 下情况并非如此，它会引发异常“无法在关闭的数据集上执行操作”。

我们的很多遗留代码都依赖于旧的 BDE 行为，所以我从代码中得到很多运行时错误，如下例所示。

我想覆盖我的 TADOCustomQuery 类的 Sql.Clear 方法，以便它包含一个“.Close”命令。我怎样才能做到这一点？

**“.Clear”方法在 SQL 属性上，该属性是 TWideStrings 类型。我真正的问题是：如何在 TADOQuery 的后代上覆盖 TWideStrings.Clear 方法？**

我已经有一个自定义的 TADOQuery 组件，它用于 SQL 属性：

```
property SQL: TWideStrings read GetSQL write SetSQL; 
```

这是一些代码来演示我遇到的问题：

```
procedure TForm1.btnBDEDemoClick(Sender: TObject);
var
  qryBDE: TQuery;
begin
  //Both queries complete with no problem
  qryBDE := TQuery.Create(nil);
  try
    with qryBDE do begin
      DatabaseName := 'Test';  //BDE Alias
      Sql.Clear;
      Sql.Add('SELECT SYSDATE AS CURDAT FROM DUAL');
      Open;
      ShowMessage('the current date is: ' + FieldByName('CURDAT').AsString);

      Sql.Clear;  //<<<<<NO ERRORS, WORKS FINE
      Sql.Add('SELECT SYSDATE-1 AS YESDAT FROM DUAL');
      Open;
      ShowMessage('And yesterday was: ' + FieldByName('YESDAT').AsString);
    end;  //with qryBDE
  finally
    FreeAndNil(qryBDE);
  end;  //try-finally
end;

procedure TForm1.btnADODemoClick(Sender: TObject);
const
  c_ConnString = 'Provider=OraOLEDB.Oracle.1;Password=*;'+
    'Persist Security Info=True;User ID=*;Data Source=*';
var
  adoConn: TADOConnection;
  qryADO: TADOQuery;
begin
  //First query completes, but the second one FAILS
  adoConn := TADOConnection.Create(nil);
  qryADO := TADOQuery.Create(nil);
  try
    adoConn.ConnectionString := c_ConnString;
    adoConn.Connected := True;
    with qryADO do begin
      Connection := adoConn;
      Sql.Clear;
      Sql.Add('SELECT SYSDATE AS CURDAT FROM DUAL');
      Open;
      ShowMessage('the current date is: ' + FieldByName('CURDAT').AsString);

      Sql.Clear;//<<<<<<<<===========ERROR AT THIS LINE
      Sql.Add('SELECT SYSDATE-1 AS YESDAT FROM DUAL');
      Open;
      ShowMessage('And yesterday was: ' + FieldByName('YESDAT').AsString);
    end;  //with qryADO
  finally
    FreeAndNil(qryADO);
    FreeAndNil(adoConn);
  end;  //try-finally
end; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-09T23:02:03.353

这不是 BDE 本身的特性。如果您查看 Delphi 附带的源代码，您会发现您描述的行为是在 TQuery.SQL 的 SetQuery 方法上实现的：

```
procedure TQuery.SetQuery(Value: TStrings);
begin
  if SQL.Text <> Value.Text then
  begin
    Disconnect;
    SQL.BeginUpdate;
    try
      SQL.Assign(Value);
    finally
      SQL.EndUpdate;
    end;
  end;
end; 
```

虽然 TADOQuery 的 SetQuery 很简单：

```
procedure TADOQuery.SetSQL(const Value: TWideStrings);
begin
  FSQL.Assign(Value);
end; 
```

为什么 Borland/Codegear 决定不采用同样的方法，这超出了我的理解。在您的自定义 ADOQuery 中实现 TQuery 的 SetQuery 应该会给您想要的行为。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-09T22:10:55.550

问题是当您发出清除时，您的数据集是打开的。对于 ADODataset，该属性被连接以更新基础 ADO 数据集，并且当它随着数据集的打开而更改时，将引发异常。

您所要做的就是在您清除之前关闭一个数据集，它就会正常运行。

```
with qryADO do 
  begin      
    Connection := adoConn;      
    Sql.Clear;      
    Sql.Add('SELECT SYSDATE AS CURDAT FROM DUAL');      
    Open;      
    ShowMessage('the current date is: ' + FieldByName('CURDAT').AsString);
    qryADO.close; // <=== line added to close the database first.
    Sql.Clear;     
    Sql.Add('SELECT SYSDATE-1 AS YESDAT FROM DUAL');      
    Open;      
    ShowMessage('And yesterday was: ' + FieldByName('YESDAT').AsString);    
  end;  //with qryADO 
```

**编辑** 作为替代方案，您可以创建一个名为 SQLCLEAR 的新表单方法，如下所示：

```
function TYourFormOrDataModule.SqlClear;
begin
  qryAdo.Close;
  qryAdo.Sql.Clear;
  qryBde.Sql.Clear;
end; 
```

然后搜索并将“SQL.Clear”替换为“SqlClear”。但我更喜欢在我的原始答案中执行关闭的方法，因为它更一致并且更容易长期维护。使用像 gExperts 这样的工具来查找 Sql.Clear 的所有实例，并在它之前插入一个 qryAdo.Close ......即使有几百个实例。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-09T20:14:44.190

当然，您可以创建一个覆盖 Clear 方法的 TAdoQuery 子类。但我认为这是一种不好的做法。

最好更改所有查询。这可能是一些工作，但最终它会付出代价。

如果您查看帮助中的 TAdoQuery 示例：

```
ADOQuery := TADOQuery.Create(Self);
ADOQuery.Connection := ADOConn;
ADOQuery.SQL.Add(SQLStr);

{ Update the parameter that was parsed from the SQL query: AnId }
Param := ADOQuery.Parameters.ParamByName('AnId');
Param.DataType := ftInteger;
Param.Value := 1;

{ Set the query to Prepared - will improve performance }
ADOQuery.Prepared := true;

try
  ADOQuery.Active := True;
except
  on e: EADOError do
  begin
    MessageDlg('Error while doing query', mtError,
                [mbOK], 0);

    Exit;
  end;
end; 
```

您会发现它与 BDE 版本有点不同。

因此，最好创建一个 ExecuteSQL 函数（首先用于 BDE），然后重写它以供 ADO 使用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-09T20:18:33.700

你用的是什么版本的delphi？我试图复制它，但它在 delphi 2009 中工作得很好——没有报告错误，它返回了我期望的数据。

谢谢唐

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-10T16:00:57.007

**更新**

**我通过编写一个小实用程序来自动更新我们所有的源代码来实现 skamradt 的解决方案。它是这样工作的：**

1 - 递归获取项目文件夹中所有 .PAS 文件的列表

2 - 将此过程应用于所有这些文件：

```
procedure ApplyChange(filename: string);
const
  c_FindThis = 'SQL.CLEAR';
var
  inputFile, outputFile: TStringList;
  i, postn, offset: integer;
  newline: string;
begin
  inputFile := TStringList.Create;
  outputFile := TStringList.Create;
  offset := 0;
  try
    inputFile.LoadFromFile(filename);
    outputFile.Assign(inputFile);  //default: they are the same

    for i := 0 to inputFile.Count - 1 do begin
      {
      whenever you find a "Sql.Clear", place a new line before it,
      which consists of everything up to the "Sql.Clear" (which may
      just be whitespace), plus the "Close" command.
      //}
      postn := Pos(c_FindThis,Uppercase(inputFile[i]));
      if (0 < postn) then begin
        newline := Copy(inputFile[i],1,postn-1) + 'Close;';
        outputFile.Insert(i+offset,newline);
        Inc(offset);
      end;
    end;

    //overwrite the existing file with the revised one
    outputFile.SaveToFile(filename);
  finally
    FreeAndNil(inputFile);
    FreeAndNil(outputFile);
  end;  //try-finally
end; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-10T06:21:49.660

而不是你，我会这样做：与拥有 D2009 的人核实行为是否真的如 Don 所说的那样修复 - 例如。给他（或另一个有 D2009 的人）一个测试用例。如果 D2009 中的行为得到修复，那么问题就很简单了。

复制项目目录中的 ADODB.pas。修改文件以获得所需的行为（例如，更改 SetSQL 方法）。重新编译。它应该工作。当您可以从项目中删除旧的自定义 ADODB.pas 时，这将为您最终升级到 D2009 提供时间。

HTH。

# .net - ASP.NET MVC - 获取 QueryString 值

> ID：627838
> 
> 赞同：82
> 
> 时间：2009-03-09T20:13:58.577
> 
> 标签：.net, asp.net, asp.net-mvc

在 ASP.NET MVC 下，您是否应该像在 ASP.NET WebForms 中一样获取 QueryString 参数？或者`[AcceptVerbs(HttpVerbs.Get)]`声明是否以某种方式使用？

* * *

## 回答 #1

> 赞同：135
> 
> 时间：2009-03-09T20:17:20.130

只需在操作上使用参数即可接受查询字符串参数 - 即

```
public ActionResult Foo(string someValue, int someOtherValue) {...} 
```

这将接受类似的查询`.../someroute?someValue=abc&someOtherValue=123`

除此之外，您可以直接查看请求以获得更多控制权。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2016-10-27T12:34:53.063

我想你正在寻找的是

```
Request.QueryString["QueryStringName"] 
```

您可以通过添加在视图上访问它`@`

现在看看我的例子，我用 QueryString 生成了一个 Url

```
 var listURL = '@Url.RouteUrl(new { controller = "Sector", action = "List" , name = Request.QueryString["name"]})'; 
```

listURL 值为`/Sector/List?name=value'`

什么时候`queryString`是空的

listURL 值为`/Sector/List`

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2009-03-09T20:16:18.230

您始终可以`Request.QueryString`像 Web 表单一样使用集合，但您也可以让 MVC 处理它们并将它们作为参数传递。这是建议的方式，因为它更容易，并且会自动验证输入数据类型。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-03-09T20:24:52.997

我建议使用控制器的 ValueProvider 属性，这与 UpdateModel/TryUpdateModel 提取所需的路由、查询和表单参数的方式很相似。这将防止您的方法签名潜在地变得非常大并经常更改。它还使测试变得更容易一些，因为您可以在单元测试期间向控制器提供 ValueProvider。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2017-07-03T04:25:31.243

实际上，您可以通过两种方式在 MVC 中捕获查询字符串.....

```
public ActionResult CrazyMVC(string knownQuerystring)
{

  // This is the known query string captured by the Controller Action Method parameter above
  string myKnownQuerystring = knownQuerystring;

  // This is what I call the mysterious "unknown" query string
  // It is not known because the Controller isn't capturing it
  string myUnknownQuerystring = Request.QueryString["unknownQuerystring"];

  return Content(myKnownQuerystring + " - " + myUnknownQuerystring);

} 
```

这将捕获两个查询字符串...例如：

```
/CrazyMVC?knownQuerystring=123&unknownQuerystring=456

Output: 123 - 456 
```

不要问我为什么他们这样设计。如果他们为单个查询字符串扔掉整个控制器操作系统，并通过 url-form-encoding 返回一个捕获的所有字符串/编码文件对象的动态列表，这样您就可以轻松地在一次调用中访问它们，这将更有意义. 如果可能的话，也许这里有人可以证明这一点？

控制器如何捕获查询字符串对我来说毫无意义，但这确实意味着您可以更灵活地捕获查询字符串，而不是他们教您开箱即用。所以选择你的毒药......两者都很好。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-08-10T09:54:55.777

@Context.Request.Query["yourId"]

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2022-02-11T06:16:21.743

这是 .NET 6（和其他 netcore）中的正确方法

var 参数 = Request.Query["IndexString"];

如果需要是字符串

字符串参数 = Request.Query["IndexString"].ToString();

# spring - 春天与 Jboss

> ID：627839
> 
> 赞同：19
> 
> 时间：2009-03-09T20:14:02.307
> 
> 标签：spring, jakarta-ee, jboss, comparison, seam

对于企业 Web 应用程序，Spring 与 Jboss 的优缺点是什么。

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2010-10-28T16:57:05.813

这是一个很好的问题。有些人在这里错误地说这是一个苹果与橘子的比较，即 Jboss 是一个容器，而 Spring 只是一个框架，就像 Struts 一样。然而，这有点令人困惑的原因是 JBoss 和 Spring 都从它们最初的简单起源大大扩展，因此彼此越来越接近。一个简单的理解JBoss的方式是原来的名字是“EJBoss”，它的目的是作为一个开源的J2EE应用服务器，所以它作为一个EJB容器比tomcat有优势，因此可以与WebSphere竞争和其他专有应用程序服务器。

Spring 是一个 IoC 框架（现在称为“依赖注入”），本质上是一个对象工厂，因此您可以遵循更“松散耦合”的设计。

然而，随着它们的流行，这两种产品都扩大了。例如，JBoss 现在拥有自己的 IoC 容器： [JBoss IoC](http://www.javalobby.org/java/forums/t49723.html)

> JBoss 提供了自己的轻量级 IoC 容器，称为：JBoss Microcontainer。JBoss Microcontainer 是一个轻量级的控制反转/依赖注入容器，在概念上类似于 Spring、Pico Container 和 Plexus。

虽然 Spring 可以很好地运行，与 JBoss（大部分）愉快地共存，但它不需要成熟的 EJB 容器，它可以在 tomcat 中轻松运行。Spring 的整个设计目标是基于轻量级设计的思想，使用 POJO，并且不需要重量级的容器，这与 EJB 非常矛盾，因此看起来与 JBoss 格格不入。

[Rod Johnson](http://forum.springsource.org/archive/index.php/t-12906.html)指出没有理由不能在 JBoss 中运行 Spring：

> Spring 被设计为在任何应用程序服务器中（或在应用程序服务器之外）工作；使用 Spring 并不意味着忽略服务器可能提供的功能。它只是在很多情况下提供了更多的选择。

因此，您必须决定要使用这两个系统的哪些部分，以及要遵守哪些 Java 标准。根据这篇关于[JBoss 和 Spring](http://www.javaworld.com/article/2073226/core-java/jboss-and-springsource.html)的文章，它涵盖了它们对标准的遵守程度，看起来，根据您选择的技术，您正在选择一方，因为这似乎是一场相当有争议的战斗。

> 接下来的事情绝不会缓和，因为 JBoss 和 Spring Source 在从 XML 到集成到工具再到最终虚拟化的所有方面都在争斗……这是一场健康的竞争，
> 
> [剪辑]
> 
> 只有时间会证明一切，但我认为这场战斗只会让开发人员的事情变得更好，更多的选择而不是.Net，以及围绕 Java 的更多创新，这对 JBoss 来说将是一个艰难的考验，但如果执行完美无瑕，他们可以应对，否则，请寻找 Spring Source 来在 JEE 6 的感知优势和实际优势之间发挥作用……迟早，为了对抗专有模型，必须证明应用程序的可移植性，而这并没有发生，

有关遵守各种 Java 标准的最新信息，请查看[有关 Spring 5 的反馈请求](https://spring.io/blog/2015/06/10/feedback-welcome-spring-5-system-requirements)。您可以了解 Spring 设计人员面临的限制，同时还强调了这样一个事实，即对于 Spring 市场，确保 Spring 支持各种 EE 服务器很重要：

> 我们也打算软升级 EE 基线。现在，这有点棘手，因为我们在这里实际上有个人需求 -*我们需要考虑生产环境中的企业采用水平*：
> 
> 我们肯定会升级到 Servlet 3.0+（从我们目前的 Servlet 2.5 运行时兼容性），但不会更高，因为我们仍然希望 Spring 5 应用程序在 EE 6 基线服务器上运行。鉴于 Java EE 7 的市场情况和仍然基于 Servlet 3.0 API 的众多服务器，请参阅我之前的博客文章，了解为什么这是不可避免的。[snip] 很遗憾，我们必须继续支持 2002 年的 JMS 1.1 API……我们想升级到 JPA 2.1+ 和 Bean Validation 1.1+，但我们的手似乎被束缚了：TomEE 1.7 和 JBoss EAP 6.4其中有硬 JPA 2.0 和 Bean Validation 1.0 API，而 WebLogic 12.1.3 有 JPA 2.1 但没有 Bean Validation 1.1 API（尽管它们是相关的）。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-03-09T20:39:22.290

正如已经说过的，但让我重申一下这一点。JBoss 是一个应用服务器。一些 Java 应用服务器包括

*   网络球
*   玻璃鱼
*   老板

Spring是一个框架。一个相当大的框架，它提供了相当多的功能，但对我来说，其中一个主要功能是 MVC。MVC 是一种设计模式，您可以在其中将模型与视图与控制器分开。模型是数据的表示。这可以由数据库或 XML 文件等支持。视图是用来查看模型的。这可以是 Web 前端或 Windows 应用程序。用户将与视图交互。用户将表达他们希望更新模型的愿望。这就是控制器的用武之地。我们使用控制器来告诉模型进行更新。而且因为视图是基于模型的，所以视图也会被更新。这是过度简化，但简而言之。您可以查看的其他 MVC 框架是 Struts。

就像我之前说的，Spring 还提供了其他功能，例如

*   安全框架
*   控制反转
*   依赖注入

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-09T20:18:46.287

这是我的看法：

Spring 代表了 Java EE 中的所有优点，而 JBoss 代表了所有缺点。

嗯......这并没有那么好（不是我认为它会）。我只是说我永远不会选择 JBoss 来托管任何应用程序。它是如此笨重和重量级，并没有做任何特别好的事情。我喜欢 Spring，因为它感觉不那么单一和笨重。诚然，Spring 不是应用程序容器，但它可用于构建托管应用程序所需的大部分基础设施——您只需将其插入容器，其余的由 Spring 处理。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-09T20:15:20.867

JBoss 是一个容器，spring 是在容器内部运行的。您正在将苹果与橙子进行比较。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-02-12T17:47:33.903

应用程序在 JBoss 上作为单片机运行（一个 JVM 进程完成所有工作），其中您将需要一个垂直/水平集群来扩展，其中可以调整 Spring 的使用以实现微服务架构。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-03-19T09:31:35.370

由于 java6 和 CDI（看@inject）你认为它是错误的，所以 spring 不再是唯一的了。15 年前使用 EJB2（甚至 EJB3）确实如此，但今天 CDI 代码在 websphere、weblogic、jboss、glassfish 中进行管理......无论您想要什么应用程序服务器。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-02-26T00:23:19.263

JBoss 或任何应用服务器都是 JEE 规范的实现。因此，应用服务器不仅是服务器，它还提供多种功能来构建企业应用程序。

Spring 框架不是 JEE 规范的实现，但提供与 JBoss、WebLogic 等 JEE 规范的实现类似的功能。或者我们可以说它是[这里](https://www.amazon.ca/Expert-One-One-Development-without/dp/0764558315/ref=sr_1_1?dchild=1&keywords=j2ee%20without%20ejb&qid=1614296493&sr=8-1)提到的 JEE 规范的替代解决方案。

Spring 是最流行的或者我只能说是开发 Java 企业应用程序的一个框架。无论如何，很少有组织仍然使用应用程序服务器（JEE 规范）。

您可以使用 JBoss 或 Spring 开发类似的应用程序。因此，这完全取决于您或您所在组织的选择标准。

# visual-studio-2008 - 在 Windows 7 上注册 VS2008 Professional

> ID：627846
> 
> 赞同：1
> 
> 时间：2009-03-09T20:16:08.773
> 
> 标签：visual-studio-2008, windows-7, installation, license-key

我从 Microsoft 收到了一份免费的 VS2008 Professional 副本，很酷。但是当我在 Windows 7 Beta 上安装时，它安装得很好，但被标记为“未注册”。我有我的许可证密钥，但无法进入可以输入密钥的位置。

交易是我必须 DL 试用版，然后进行升级。我能够在 Vista 上执行此操作是因为我已经安装了 VS2008 Team，然后只是“切换”到了专业版。

但是在 Windows 7 上（可能只是由于全新安装），我无法获得允许我输入序列号的提示。安装试用版时，您只会获得预先输入的硬编码试用版序列号。

使用程序和功能来修改安装的建议不起作用，因为它没有给我描述的“升级/输入序列号”选项。

还有人解决这个问题吗？

我知道我还有 89 天，但我讨厌让这个问题悬而未决。:)

蒂亚！

**编辑：这不是软件盗版问题，而是有效的合法问题。这适用于 Windows Vista，但不适用于 Windows 7——所以我希望这里有人解决了这个问题。谢谢。**

***更新：写了为微软处理这个问题的公关公司，他们本周晚些时候将把 DVD 寄给我。尽管如此，这对其他人来说可能是有价值的。***

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T20:23:27.260

虽然不是“最好”的方式来做到这一点。我强烈建议只卸载并重新安装 VS。

从试用版到完整版，我遇到了很多问题，由于此类问题，我什至最近都没有尝试过。

一开始可能会有点痛苦，但实际上它会比有一天启动 VS 并且由于无效的许可证密钥而没有出现要好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T21:46:51.657

这里仍然没有解决方案——它会出现在 Windows 7 中。

感谢您的关注！

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-09T21:37:00.843

刚刚使用 VS2008 试用版针对 Vista Ultimate 进行了测试：

1.  转到控制面板 -> 程序和功能
2.  找到“Microsoft Visual Studio 2008 专业版 - ENU”
3.  点击“卸载/更改”
4.  完成检查资源并加载配置后，单击下一步
5.  您应该看到四个选项，第四个选项是“升级到 Microsoft Visual Studio 2008”

希望有帮助

# wpf - 避免 WPF 中的重复（遵循 DRY）

> ID：627860
> 
> 赞同：5
> 
> 时间：2009-03-09T20:20:24.723
> 
> 标签：wpf, dry

考虑以下 2 个 XAML 片段（在文件中并排显示）：

```
<Button
    x:Name="BuyButton"
    Margin="0,0,1,1"
    IsEnabled="{Binding CanBuy}"
    >
    <StackPanel
        DataContext="{Binding Product}">
        <TextBlock
            Foreground="Red"
            Text="BUY" />
        <TextBlock
            Foreground="Red"
            Text="{Binding BuyPrice}" />
    </StackPanel>
    </Button>

<Button
    x:Name="SellButton"
    Margin="0,0,1,1"
    IsEnabled="{Binding CanSell}"
    >
    <StackPanel
        DataContext="{Binding Product}">
        <TextBlock
            Foreground="Red"
            Text="SELL" />
        <TextBlock
            Foreground="Red"
            Text="{Binding SellPrice}" />
    </StackPanel>
</Button> 
```

如何删除 WPF 中的重复项？这种类型的按钮我有大约 4 次使用（此处显示 2 次），它们的 80% 相同，如果不是更多的话。我可以将其提取到用户控件中并在其上放置一些 DP，然后我将拥有一个控件，但我担心我会开始在我的代码库中乱扔大量用户控件（我有很多“一次性"这样的情况）。我不喜欢这里的 DataTemplate 解决方案，因为我仍然需要两个模板，这将有重复的代码。在不创建一堆模板/控件的情况下，有没有办法让这段代码遵循 DRY？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T21:11:15.117

一个 ControlTemplate 可能工作：

```
<ControlTemplate x:Key="ButtonControlTemplate1" TargetType="{x:Type Button}">
<StackPanel Height="Auto" Width="Auto">
    <TextBlock Text="{TemplateBinding Content}" Foreground="Red"/>
    <TextBlock Text="{TemplateBinding Tag}" Foreground="Red"/>
</StackPanel></ControlTemplate> 
```

我使用 TemplateBinding 来获取两个可更改的数据。现在，当您创建按钮时，应用模板并将绑定设置为您的元素：

```
<Button x:Name="BuyButton"
    Margin="0,0,1,1"
    IsEnabled="{Binding CanBuy}"
    Template="{DynamicResource ButtonControlTemplate1}"
    Content="Button" 
    Tag="{Binding BuyPrice}"/> 
```

唯一缺少的是 DataContext：只需将其设置在两个按钮上方的容器中。

我没有具体尝试过，但它似乎应该可以工作。我选择了上面的“标签”，因为我需要第二个元素进行绑定。我很想看到关于这个的不同建议。

您可能还想将 ForegroundColor="Red" 类型的内容分解为一种样式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T20:58:09.487

I don't have an alternative solution but I disagree on your argument of one-off controls. In my opinion it boils down to choosing between a lot of duplicate code or less duplication with a number of control that are quite specific. If this were plain code you would probably not think twice about performing an extract method when confronted with several chunks of identical code, why is the fact that this code is now XAML make your decision any different?

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-09T21:07:51.083

If your goal is just to reduce repetition, you can eliminate a lot of it by using Styles and setting common attached properties on a parent element:

```
<StackPanel>
    <StackPanel.Resources>
        <Style TargetType="{x:Type Button}">
            <Setter Property="Margin" Value="0,0,1,1"/>
        </Style>
        <Style TargetType="{x:Type TextBlock}">
            <Setter Property="Foreground" Value="Red"/>
            <Setter Property="DataContext" Value="{Binding Product}"/>
        </Style>
    </StackPanel.Resources>
    <Button x:Name="BuyButton" IsEnabled="{Binding CanBuy}">
        <StackPanel>
            <TextBlock Text="BUY"/>
            <TextBlock Text="{Binding BuyPrice}"/>
        </StackPanel>
    </Button>
    <Button x:Name="SellButton" IsEnabled="{Binding CanSell}">
        <StackPanel>
            <TextBlock Text="SELL"/>
            <TextBlock Text="{Binding SellPrice}"/>
        </StackPanel>
    </Button>
</StackPanel> 
```

Note that this ends up being more code... which is why "3 strikes, then refactor" is the rule of thumb.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T21:00:25.890

Separate it into a user control. DRY principles and refactoring should be treated the same across just about any platform.

# c# - ASP.NET 缓存如何工作？

> ID：627865
> 
> 赞同：19
> 
> 时间：2009-03-09T20:21:21.913
> 
> 标签：c#, asp.net, caching

我有兴趣使用 ASP.NET 缓存来减少加载时间。我该怎么做？我从哪里开始？缓存究竟是如何工作的？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-03-09T20:23:13.983

随着应用程序的增长，利用缓存来获得可扩展性并保持一致的服务器响应时间是很正常的。缓存通过将数据存储在内存中来显着减少访问时间。首先，我会看看 ASP.NET 缓存。

ASP.NET Web 应用程序中有 3 种通用缓存技术：

*   页面输出缓存（页面级别）
*   页面部分页面输出（页面的特定元素）
*   程序化或数据缓存

**输出缓存**

页面级输出缓存缓存页面的 html，以便每次 ASP.NET 页面请求它首先检查输出缓存。您可以通过输入参数（[VaryByParam](http://msdn.microsoft.com/en-us/library/system.web.ui.outputcacheparameters.varybyparam.aspx)）改变这些请求，因此如果请求进入其中 ID=2 的 asp.net 缓存足够聪明，知道它需要重新渲染，则页面只会为 ID=1 的用户缓存页。

**部分页面缓存**

很多时候，在这些情况下缓存整个页面是没有意义的，您可以使用部分页面缓存。这通常与用户控件一起使用，并且设置方式与页面级别相同，只是在用户控件中添加了 OutputCache 声明。

**数据缓存**

您可以存储整个应用程序中常用的对象或值。它可以很容易：

```
Cache["myobject"] = person; 
```

**企业级缓存**

值得一提的是，有许多企业级缓存架构已经开始利用有效性缓存。.net 的[Memcache和](http://sourceforge.net/projects/memcacheddotnet/)[Velocity（现在的 App Fabric）](http://msdn.microsoft.com/en-gb/windowsserver/ee695849.aspx) 是一对。

**一般来说**

因为每个应用程序都是不同的，所以您不能真正就应该缓存什么和不应该缓存什么做出笼统的陈述。但是，您可以做出一些适用于**大多数**时间的概括。图像和内容等静态元素可以缓存。即使是被敲击的动态页面也值得缓存 5-10 秒，它会给您的 Web 服务器带来天壤之别。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-09T20:27:06.440

您最好的选择可能是查看[www.asp.net/learn/videos](http://www.asp.net/learn/videos)上的一些缓存视频，特别是：[如何使用缓存？](http://www.asp.net/learn/videos/video-42.aspx)以及[如何更好地利用缓存？](http://www.asp.net/learn/videos/video-41.aspx)

我总是觉得他们很有帮助。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-09T20:34:12.973

看看[http://www.dnrtv.com/default.aspx?showNum=85](http://www.dnrtv.com/default.aspx?showNum=85)这是一个关于如何进行缓存的非常好的视频教程

我认为 stack over flow 播客也谈到了它

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-09T20:34:59.573

在这里开始 ASP.NET 缓存是一个很好的教程[ASP.NET Quickstart Tutorial for Caching](http://quickstarts.asp.net/quickstartv20/aspnet/doc/caching/default.aspx.)。输出缓存和片段缓存有助于理解概念。

这里有一个有用的库，来自 Microsoft 的模式和实践团队的[缓存应用程序块](http://msdn.microsoft.com/en-us/library/cc309502.aspx)，用于在 .NET 应用程序中以编程方式缓存。

# asp.net - 在运行时更改 web.config 连接字符串的最佳方法是什么？

> ID：627866
> 
> 赞同：3
> 
> 时间：2009-03-09T20:21:27.203
> 
> 标签：asp.net, database, authentication, web-applications

我对 ASP.NET 世界还很陌生，所以在想出在运行时配置连接字符串并让整个应用程序使用该连接字符串的最佳方法时遇到了一些麻烦。以下是有关我计划构建的应用程序的更多信息：

*   应用程序使用表单身份验证，而不是 Windows 身份验证
*   将有一个登录页面，用户在其中提供他们的 SQL Server 登录 ID 和密码
*   为简单起见，我希望所有 SQLDataSource 控件都指向 web.config 连接字符串。这将在设计时完成，而不是以编程方式设置它们。所以，他们会有这样的属性： ConnectionString="<%$ ConnectionStrings:MyDB %>"
*   我想找到一种在运行时更改“MyDB”连接字符串的方法，以便它使用用户提供的登录 ID 和密码。但我不希望将其保存到 web.config。它应该只对该用户的会话有效。

人们通常这样做的“标准”方式是什么？我假设一种方法是使用连接字符串创建一个 Session 变量，然后在页面加载期间以编程方式更改每个 SQLDataSource 控件的 ConnectionString 属性。但我希望尽可能避免这种情况。

* * *

由于许多人问我为什么要为每个用户使用唯一的连接并且担心缺乏池，我想我会在这里对此发表评论，而不是对每个单独的回复发表评论。

此应用程序的性质要求每个用户都以自己的帐户连接到数据库。后端安全性与他们的用户帐户相关联，因此我们不能使用“用户”和“管理员”等通用帐户。我们还需要知道每个用户的具体身份来进行审计控制。该应用程序通常只有 10 到 20 个用户，因此无需担心缺少池。我们可以下次再讨论这种方法的优点，但不幸的是我在这里没有选择 - 该项目要求每个用户使用自己的帐户连接到数据库。

我很想要求 Windows 身份验证，但不幸的是，此应用程序的某些实现将需要 SQL 身份验证。

如果我可以在像这样声明 SQLDataSource 控件时设置连接字符串，那就太简单了：

```
 <asp:SqlDataSource ID="SqlDataSource1" runat="server" 
    ConnectionString = "<%= Session("MyConnectionString") %>"
    SelectCommand="SELECT * FROM [Customers]">
  </asp:SqlDataSource> 
```

但我收到一个错误，因为它不喜欢那里的 <% %> 标记。如果在声明控件时我不能这样做，那么以编程方式为应用程序中的每个 SQLDataSource 控件执行此操作的最简单方法是什么？

非常感谢大家的帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-10T16:05:23.987

如果您不想深入研究背后的代码，还有另一种方法可以做到这一点。

首先阅读这篇关于[表达式构建器](http://weblogs.asp.net/infinitiesloop/archive/2006/08/09/The-CodeExpressionBuilder.aspx)的文章。我最喜欢带入我的网络应用程序的东西之一！

**现在看一些代码：**

首先在您的项目中创建一个包含以下内容的类：

```
using System;
using System.CodeDom;
using System.Web.UI;
using System.Web.Compilation;

namespace MyNamespace.Web.Compilation
{
    [ExpressionPrefix("code")]
    public class CodeExpressionBuilder : ExpressionBuilder
    {
        public override CodeExpression GetCodeExpression(BoundPropertyEntry entry,
           object parsedData, ExpressionBuilderContext context)
        {
            return new CodeSnippetExpression(entry.Expression);
        }
    }

} 
```

然后，在 web.config 中注册 Expression Builder，如下所示

```
...
<compilation debug="false">
  <expressionBuilders>
    <add expressionPrefix="Code" type="MyNamespace.Web.Compilation.CodeExpressionBuilder"/>
  </expressionBuilders>
</compilation>
... 
```

（以上所有代码均取自[此处](http://weblogs.asp.net/infinitiesloop/archive/2006/08/09/The-CodeExpressionBuilder.aspx)并稍作修改）

最后将您的 SqlDataSource 更改为以下（C#）：

```
<asp:SqlDataSource ID="SqlDataSource1" runat="server" 
    ConnectionString='<%$ code: (string)Session["MyConnectionString"] ?? ConfigurationManageer.ConnectionStrings["myDefaultConn"].ConnectionString %>'
    SelectCommand="SELECT * FROM [Customers]">
</asp:SqlDataSource> 
```

如果您想要（并且我会推荐）创建一个静态类来处理您的连接字符串，请说：

```
public static ConnectionManager
{
   public static string GetConnectionString()
   {
      return HttpContext.Current.Session["MyConnectionString"] as string ??
             ConfigurationManager.ConnectionStrings["DefaultConnectionStr"].ConnectionString;
   }
} 
```

那么你的 SqlDataSource 将是

```
<asp:SqlDataSource ID="SqlDataSource1" runat="server" 
    ConnectionString='<%$ code: ConnectionManager.GetConnectionString() %>'
    SelectCommand="SELECT * FROM [Customers]">
</asp:SqlDataSource> 
```

这样，如果您需要更改获取连接字符串的方式，您可以在一个地方完成！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T20:32:32.480

`Web.config`将连接字符串加载到`Session_Start`. 如果用户提供了他/她自己的凭据，请在会话变量中更新它们。否则，默认值（`web.config`值）将生效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T20:50:10.613

我会说您有几个选择，有些可以使用您所拥有的，有些则需要您进行更改。

1.  将默认连接存储在 web.config 中，将其加载到会话中，在用户登录之前使用它，然后稍后更新会话中的值。

2.  实施 Windows 身份验证和身份模拟，并设置有权访问 SQL Server 框的 Windows 帐户。

如果您使用第一个项目，请创建一个共享帮助函数来获取连接，首先检查会话，然后从 web.config 加载。这样，您的所有数据源仍然可以在设计时绑定。

注意：这不是典型情况，使用多个 SQL Server 帐户进行连接会影响性能，例如无法在其他项目中使用连接池。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-09T21:05:27.923

我不建议您这样做，因为您会遇到可伸缩性问题。Web 应用程序将无法使用连接池，并且将打开与访问它的用户一样多的连接。您还将有许多真正的连接打开/关闭。

如果您决定继续：

*   如果可以使用windows认证，sql连接使用impersonation+integrated方式。使用 windows 组在 sql server 上设置权限。
*   您可以递归访问页面上的所有项目，查找 sqldatasources，并将连接应用于每个项目。您可以从 global.asax 附加到页面的 oninit，因此您可以将其应用于所有页面。

你为什么要这样做？涉及的约束是什么？（通常在 Web 应用程序上使用受信任的子系统模型，即在 Web 应用程序级别/或在单独的业务层完成身份验证/授权）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-09T20:26:54.647

如果不保存它，`web.config`就没有办法做到这一点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-09T21:08:32.160

正如 Mitch 所说，如果您让用户使用不同的凭据登录（如果这会导致不同的连接字符串），则会丢失连接池。

如果您只是担心将管理员用户与普通用户分开，只需设置 2 个连接字符串，一个用于管理员，一个用于普通用户。使用[asp.net 角色提供程序](http://msdn.microsoft.com/en-us/library/ms998314.aspx)为用户提供适当的权限。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-10T15:47:10.597

我也有类似的情况。我将连接字符串设置为 web.config 中的默认连接字符串。然后在后面的代码中，您可以将连接字符串设置为不同的值。您必须在 Page_Load 中执行此操作，在数据源选择事件触发之前，像这样......

```
SqlDataSource1.ConnectionString = ConnectionString; 
```

如果要确保不使用默认值，可以将默认值设为非工作连接字符串并处理异常，或者仅检查它是否为默认值，如果是则抛出错误。您还可以在数据源的选择事件期间检查用户是否已登录，如果没有则取消该事件...

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-10T15:59:22.830

您可以使用 Postsharp 等方面编程库在运行时动态更改连接字符串。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-09-23T20:28:37.267

我正在使用的一种方法（我忘记了我在哪里学到的）是`SettingsLoaded`在应用程序启动时添加一个处理程序，然后在处理程序中设置新的连接字符串。我没有在 ASP.NET 中尝试过这个，只是一个本地应用程序，所以你的里程可能会有所不同：

```
Settings.Default.SettingsLoaded += new System.Configuration.SettingsLoadedEventHandler(Default_SettingsLoaded);

void Default_SettingsLoaded(object sender, System.Configuration.SettingsLoadedEventArgs e)
{
    Settings.Default["ConnectionString"] = "my new connection string";
} 
```

# c# - LINQ 查询以返回字典

> ID：627867
> 
> 赞同：234
> 
> 时间：2009-03-09T20:21:29.713
> 
> 标签：c#, .net, linq, dictionary

我有一个 MyClass 的集合，我想使用 LINQ 查询以获取不同的值，并返回 Dictionary<string, string> 作为结果，但我不知道如何比我更简单地做到这一点在下面做。我可以使用哪些更简洁的代码来获取 Dictionary<string, string> 作为我的结果？

```
var desiredResults = new Dictionary<string, string>(StringComparer.OrdinalIgnoreCase);

var queryResults = (from MyClass mc in myClassCollection
                    orderby bp.SomePropToSortOn
                    select new KeyValuePair<string, string>(mc.KeyProp, mc.ValueProp)).Distinct();

foreach (var item in queryResults)
{
    desiredResults.Add(item.Key.ToString(), item.Value.ToString());
} 
```

* * *

## 回答 #1

> 赞同：384
> 
> 时间：2009-03-09T20:23:54.327

直接使用该`ToDictionary`方法。

```
var result = 
  // as Jon Skeet pointed out, OrderBy is useless here, I just leave it 
  // show how to use OrderBy in a LINQ query
  myClassCollection.OrderBy(mc => mc.SomePropToSortOn)
                   .ToDictionary(mc => mc.KeyProp.ToString(), 
                                 mc => mc.ValueProp.ToString(), 
                                 StringComparer.OrdinalIgnoreCase); 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-03-09T20:24:16.557

查看`ToLookup`和/或`ToDictionary`扩展方法。

# java - 你用蚂蚁的吗 任务？

> ID：627868
> 
> 赞同：2
> 
> 时间：2009-03-09T20:21:42.147
> 
> 标签：java, ant, build

[ant 任务](http://ant.apache.org/manual/Tasks/depend.html)的文档指出：

> 依赖任务的性能取决于许多因素，例如类关系复杂性和有多少类文件过期。关于重新编译所有类或使用依赖任务是否更便宜的决定将取决于您的项目的大小以及您的类的相互关联程度。

我怀疑在调用之前使用该任务可能会加快我正在处理的项目的构建速度，并且可能会在某些情况下阻止对干净构建的需要。但是，对于这项任务，ant 文档非常神秘，我可以使用一些说明。我使用一个包含 src 中大约 16k 类和 testrc 中 4k 类的大型代码库。我们构建了一个包含大约四分之一类的核心 jar 文件，然后是大约 15 个其他依赖于 core.jar 而不是彼此的 jar。我只是尝试一下，但我们的 build.xml 需要进行大量清理才能进行此更改，而且无论如何我都想更好地理解这项任务。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T20:41:07.123

你需要非常小心。有一些事情，比如像这样声明常量：

```
public static final int FOO = 1; 
```

依赖于任务（和 javac 本身）并不总是能够接受（我不是 100% 确定上面的任务会与 Ant 混淆，但我知道有些事情会发生）。

我很久以前确实使用过依赖任务，并迅速将其删除，因为我一直需要进行完整的构建以确保一切正常。

# uml - 用例图的本质

> ID：627871
> 
> 赞同：3
> 
> 时间：2009-03-09T20:22:46.747
> 
> 标签：uml, use-case

对于学校作业，我们必须制作一个用例图。但是我们拥有的文档不是很扩展。它只是描述了一个用例由哪些组件组成，以及一个示例。
我们必须制作一个关于图书馆系统的用例。我们已经找到了 11 个用例，但我不会用所有这些用例来打扰您。

IIRC，用例描述了系统的典型用法，对吗？但是什么东西属于用例图，它们是如何连接在一起的？

我们现在有四个参与者（成员、员工、经理和会计师）。我们遇到最多的问题是会员和员工。
员工是使用该系统的人。成员仍然属于这里的演员吗？

我们拥有的一些用例：

*   会员加入图书馆。
*   成员更改他的记录。
*   会员借书。
*   成员部分图书馆（退订）。
*   会员预订文章。
*   会员还书。
*   会员支付（部分）费用和罚款。

这些成为图表上的用例。但是应该有更多的用例，比如员工输入会员编号，员工输入账簿编号等等（用途？）。

任何人都可以（？）对此有所了解吗？

**编辑：** 如何描述动作序列？有人告诉我，您可以看到使用关联，例如对某种重复例程的方法调用？这是正确的吗？以及如何扩展使用？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-09T22:03:19.937

> *IIRC，用例描述了系统的典型用法，对吗？但是用例图上的东西是什么，它们是如何连接在一起的？*

你的用例图（是的，一个典型的项目会有不止一个）应该是你的 UML 套件中最简单的图。它们应该将您定义的角色/角色直接映射到系统的用例。事实上，他们应该主要关注单个 Actor，并且仅在必须参与特定用例时才包含其他 Actor。

这是我从谷歌上下来的一个例子：

[示例用例图 http://java.sun.com/mailers/newsletters/fundamentals/img/usecase.png](http://java.sun.com/mailers/newsletters/fundamentals/img/usecase.png)

注意简单。一个参与者，一个系统，5 个用例。没有其他的。

此外，正如[@Eric P](https://stackoverflow.com/questions/627871/the-essense-of-usecase-diagrams/627930#627930)所建议的和我的示例图像所暗示的那样，您应该使用“[Verb] [Object]”结构命名您的用例；即“会员借书”变成“借书”。用例句子中缺失的主题（“成员”）在用例图中编码为与用例关联的参与者。

> *员工是使用该系统的人。成员仍然属于这里的演员吗？*

恐怕这个答案是主观的。有人会说不，因为该系统仅供员工使用，所以员工是唯一的参与者。我个人不同意。

为什么？一方面，用例是需求收集阶段的一部分。它们可以帮助您组织系统的最终功能。`Member`但是仅仅因为您当前的信念是该技术不会被该演员使用而否认该演员`Member`是在该阶段限制您自己。

如果您的最终系统**是**自动化的，这意味着您自己`Member`去终端检查一本书怎么办？如果您在收集需求时做出假设，您可能会错过重要的功能。

> ***编辑：****如何描述动作序列？有人告诉我，您可以看到使用关联，例如对某种重复例程的方法调用？这是正确的吗？以及如何扩展使用？*

**用例图是高级别的**。它们应该显示您的高级功能（以每个用例的形式）和使用它们的 Actors，仅此而已。不要在你的用例图中乱扔扩展和包含；那些应该是罕见的和特殊情况。您可能犯的最大新手错误（相信我，我已经做到了！）是尝试在用例图中模块化您的代码。是的，我知道，这是任何称职的程序员都会尝试做的第一件事，但用例图不是做它的地方。

关于动作序列：在一套典型的 UML 图中，每个用例都与一个或多个[Activity Diagrams](http://en.wikipedia.org/wiki/Activity_diagram)相关联。这些大致类似于流程图，并用作大多数软件工程教科书鼓励的典型用例叙述结构的图形表示。

无论如何，我希望这会有所帮助。如果您还有其他问题，请随时提问！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-09T20:33:35.363

我被告知每个人对用例图的处理方式都有些不同，所以我不知道这是否适用于您，但参与者通常是那些与系统直接接触的人。因此，除非他扫描自己的借书证或其他东西，否则成员不会成为演员，因为他必须通过员工。

用例应该涵盖所有内容，但不能非常详细。因此，员工将检查会员资格，如果不存在，则创建会员用例，否则检查未付费用。如果会员信誉良好，请扫描书籍等。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-09T20:37:57.770

听起来您对用例的理解很模糊。这里有一些资源可以帮助您朝着正确的方向前进：

*   [用例 - 简介](http://www.parlezuml.com/tutorials/usecases/usecases_intro.pdf)
*   [UML 用例图](http://www.objectmentor.com/resources/articles/usecases.pdf)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-09T20:38:26.443

演员是使用系统的人，所以如果员工是唯一使用系统的人，那么他们应该是演员。例如，如果员工和经理都可以使用某个功能，您还可以有多个可能的参与者。

因此，您可能希望将您的用例重新表述为“添加新成员”、“更改成员帐户”等内容。

至于详细程度，我会尽可能多地包含细节，而不会获得“技术性”。布兰登的建议非常好。

# optimization - 编码和数据传输优化

> ID：627878
> 
> 赞同：1
> 
> 时间：2009-03-09T20:23:31.440
> 
> 标签：optimization, encoding, data-transfer

我正在开发一个解决方案，其中包括手机和服务器之间的数据传输。但是，我想尽量减少传输数据的数量。

我打算尝试几种类型的 TCP/UDP 连接编码并测量流量和数据丢失。否则，我相信对于不同类型的数据（音频、视频、文本）和网络特性的协议开发（应用层）已经存在某种建议。

如果有人提供有关此主题的任何链接或提示，我将非常感激。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T01:47:21.117

关于压缩方面，Jeff Atwood 最近写了一篇关于压缩的[帖子](http://www.codinghorror.com/blog/archives/001231.html)，其中包含一个指向[此页面](http://users.elis.ugent.be/~wheirman/compression/index.php)的链接，该链接很好地展示了在考虑到压缩带来的开销时，哪些压缩算法/实现在哪些条件下是最佳的。

对于手机 <--> 服务器连接，我猜速度可能是 100-500kbps，然后 "7za -mx=9" 似乎是以最少开销提供最佳压缩的选择。

对于不同场景部分更一般的“如何选择/开发网络协议”，这是一个非常开放的问题，我不确定是否可以给出任何明确的答案。但是对于视频/音频，我建议看[这里](http://en.wikipedia.org/wiki/Streaming_media#Protocol_issues)，我猜可以使用[RTSP](http://en.wikipedia.org/wiki/Real_Time_Streaming_Protocol)和[RTP 。](http://en.wikipedia.org/wiki/Real-time_Transport_Protocol)

# linux - 是否有任何类 Unix 系统将含义赋予目录上的 SUID 位？

> ID：627880
> 
> 赞同：3
> 
> 时间：2009-03-09T20:23:47.493
> 
> 标签：linux, macos, unix, freebsd, setuid

正如标题所说，任何类 Unix 系统是否将含义赋予**目录**上的 SUID 位，如果是，它是什么意思？

SVTX（保存的文本或粘性）位有一个含义——除非您可以写入文件，否则您不得从此目录中删除文件。例如，它用于 /tmp。

SGID（设置 GID）位有一个含义——在该目录中创建的文件应属于拥有该目录的组（尽管稍后可以通过显式调用 chown(2) 来更改该分配）。

SUID 位呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-09T20:36:03.533

作为 Node 回答的后续，我将从 FreeBSD 手册页中为 mount(8) 发布以下内容：

```
 suiddir
                 A directory on the mounted file system will respond to
                 the SUID bit being set, by setting the owner of any new
                 files to be the same as the owner of the directory.  New
                 directories will inherit the bit from their parents.
                 Execute bits are removed from the file, and it will not
                 be given to root.

                 This feature is designed for use on fileservers serving
                 PC users via ftp, SAMBA, or netatalk.  It provides secu-
                 rity holes for shell users and as such should not be used
                 on shell machines, especially on home directories.  This
                 option requires the SUIDDIR option in the kernel to work.
                 Only UFS file systems support this option.  See chmod(2)
                 for more information. 
```

以及引用 suid 位的 chmod(2) 手册页部分：

```
 4000    (the setuid bit).  Executable files with this bit set will
               run with effective uid set to the uid of the file owner.
               Directories with this bit set will force all files and sub-
               directories created in them to be owned by the directory
               owner and not by the uid of the creating process, if the
               underlying file system supports this feature: see chmod(2)
               and the suiddir option to mount(8). 
```

请注意，这是一个安全风险，并且在 FreeBSD 中启用它时知道您在做什么，但我相信 Linux 也需要启用特殊的挂载标志，并且会改变该目录中文件的行为方式。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-09T20:28:20.413

[从这里](http://www.gnu.org/software/coreutils/manual/html_node/Directory-Setuid-and-Setgid.html)复制：

> 在大多数系统上，如果设置了目录的 set-group-ID 位，则新创建的子文件会继承与目录相同的组，而新创建的子目录会继承父目录的 set-group-ID 位。在少数系统上，目录的 set-user-ID 位对新子文件的所有权和新子目录的 set-user-ID 位有类似的影响。这些机制通过减少使用 chmod 或 chown 共享新文件的需要，让用户更轻松地共享文件。
> 
> 这些便利机制依赖于目录的 set-user-ID 和 set-group-ID 位。如果像 chmod 和 mkdir 这样的命令会定期清除目录上的这些位，那么这些机制会不太方便，并且共享文件会更加困难。因此，像 chmod 这样的命令不会影响目录的 set-user-ID 或 set-group-ID 位，除非用户以符号模式特别提及它们，或者将它们设置为数字模式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T20:26:32.853

当在一个目录上设置时，在这个目录中创建的所有文件和目录都将与 SUID 目录本身具有相同的所有者，无论文件是谁创建的。这是一个不经常使用的功能，但在某些情况下它可能很有用。（[来源](http://kurt.www.pinboard.com/techwritings/d83/)）

更新：我刚刚在 Linux 2.6.25.5-1.1-default #1 SMP x86_64 GNU/Linux openSUSE 11.0 (X86-64) 上试过这个。

```
mkdir tmp
chmod 4777 tmp
su othergroup
touch testfile 
```

它没有效果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T20:25:45.040

SUID 位表明，在执行文件时（当可执行时），进程将以所述文件所有者的身份运行，而不是执行它的用户。

在某些情况下，实用程序是“suid root”以允许权限提升。

编辑：误读原始问题（指的是目录而不是文件） - 出于教育目的保留答案不变;-)

# c# - 带有特殊消息终止符的套接字异步读取数据

> ID：627911
> 
> 赞同：0
> 
> 时间：2009-03-09T20:33:02.400
> 
> 标签：c#, sockets, asynchronous

我必须通过 tcp 连接到以 0x4 而不是标准 0x0 终止响应的服务器。我想保持简单，并使用来自套接字类的同步发送/接收。发送有效，但接收无限期阻塞，因为服务器不会终止带有 0x0 的消息。我无法同步读取到第一个 0x4 并关闭，因为我需要保持连接打开以发送更多消息。如果我可以使用 BeginReceive 在单独的线程上读取数据，那就太好了，但看起来它仍然需要 0x0 终止符。我尝试将大小为 1 的缓冲区传递给 BeginRecieve，希望它会为每个读取的字符调用我的委托，但它似乎不是那样工作的。它读取第一个字符并停止。

有任何想法吗？

这是应用程序

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Net;
using System.Net.Sockets;

namespace SocketTest
{
    public partial class SocketTestForm : Form
    {
        Socket socket;
        byte[] oneChar = new byte[1];

        public SocketTestForm()
        {
            InitializeComponent();
        }

        private void GetButton_Click(object sender, EventArgs e)
        {
            //connect to google
            IPHostEntry host = Dns.GetHostEntry("google.com");
            IPEndPoint ipe = new IPEndPoint(host.AddressList[0], 80);
            socket = new Socket(ipe.AddressFamily, SocketType.Stream, ProtocolType.Tcp);
            socket.Connect(ipe);
            if( socket.Connected )
                Console.WriteLine("Connected");

            //write an http get header

            String request = "GET / HTTP/1.1\r\nHost: google.com\r\nConnection: Close\r\n\r\n";

            socket.Send(Encoding.ASCII.GetBytes(request));

            //read the response syncronously, the easy way...
            //but this does not work if the server does not return the 0 byte...

            //byte[] response = new byte[5000];
            //socket.Receive(response, response.Length, SocketFlags.None);
            //string res = Encoding.ASCII.GetString(response);
            //Console.WriteLine(res);

            //read the response async
            AsyncCallback onreceive = ByteReceived;
            socket.BeginReceive(oneChar, 0, 1, SocketFlags.None, onreceive, null);
        }

        public void ByteReceived(IAsyncResult ar)
        {
            string res = Encoding.ASCII.GetString(oneChar);
            if (res[0] == 0x4) ; //fire some event 
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T21:07:05.750

The termination with 0x04 seems dubious, but the reason your code is stopping after one byte, is that you only asked for one byte. If you want a second byte you have to ask again.

Changing your ByteReceived as follows should get you all the bytes up until you hit a 0x04:

```
public void ByteReceived(IAsyncResult ar)
{
    string res = Encoding.ASCII.GetString(oneChar);
    if (res[0] == 0x4)
    {
       //fire some event 
    }
    else
    {
       AsyncCallback onreceive = ByteReceived;
       socket.BeginReceive(oneChar, 0, 1, SocketFlags.None, onreceive, null);
    }
} 
```

The typical way to read an http response is to read bytes until you hit the terminator for the header, then use the content length field in the http header to figure out how many bytes you have left to read.

Again the 0x04 termination seems dubious.

# eclipse - 如何在 Eclipse 中添加透视图

> ID：627914
> 
> 赞同：13
> 
> 时间：2009-03-09T20:34:09.573
> 
> 标签：eclipse

如果我安装了两个版本的 Eclipse，如何将我在一个 [eclipse 版本] 中安装的透视图添加到另一个？首先如何添加观点？即，它们是从哪里来的（不要告诉我“'Open Perspective' 对话框”）？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-09T20:54:48.730

由于选择的答案在“观点从何而来”的细节上有点“差”，这里有一些精确度：

Eclipse 中的**[透视图](http://www.eclipse.org/articles/using-perspectives/PerspectiveArticle.html)**实际上只是可以保存和切换到的视图、菜单和工具栏的命名组织——为特定任务或一组任务组织的应用程序的独特选项卡。

所以一个观点来自于：

*   您：您可以修改任何透视图、添加视图、删除菜单、添加工具栏……然后以新名称保存结果（当前修改的透视图）。

[替代文字 http://www.javalobby.org/images/postings/rj/eclipse_perspective/1.gif](http://www.javalobby.org/images/postings/rj/eclipse_perspective/1.gif)

*   插件：为此，插件**声明了透视贡献的扩展点：org.eclipse.ui.perspectives**。通过为此点定义一个扩展，一个新的透视图被添加到工作台中。在下面的示例中，为测试透视定义了透视扩展。该声明包含基本元素：id、name 和 class。

**[org.eclipse.ui](http://help.eclipse.org/stable/index.jsp?topic=/org.eclipse.platform.doc.isv/reference/extension-points/org_eclipse_ui_perspectives.html)**的开发人员文档中提供了扩展点和语法的完整描述。属性描述如下。

*   **id** - 将用于标识此透视图的唯一名称。
*   **name** - 将在工作台窗口菜单栏中用于表示此透视图的可翻译名称。
*   **class** – 实现 org.eclipse.ui.IPerspectiveFactory 接口的类的完全限定名称。
*   **icon** - 将与此透视图关联的图标的相对名称。

此扩展点用于将透视工厂添加到工作台。
透视工厂用于定义透视的初始布局和可见操作集。用户可以通过调用“Window”菜单的“Open Perspective”子菜单来选择一个透视图。

* * *

这就是为什么将插件从一个 Eclipse 安装复制到另一个 Eclipse 的**[dropin 文件夹](https://stackoverflow.com/questions/582391/installing-eclipse-3-4-plugins-in-a-directory-other-than-eclipsehome-plugins/582430#582430)**将使您的第二个 Eclipse 安装可以使用透视图。
（正如最后一个链接所暗示的，您可以定义一个插件包位置，以便您的两个 Eclipse 共享一个公共插件包）。

[有关在此 SO 问题“如何重新安装已安装的 Eclipse 插件？](https://stackoverflow.com/questions/627976/how-do-you-reinstall-installed-eclipse-plugins/628041#628041) ”中的不同 Eclipse（不同版本）之间传输插件的更多详细信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T20:36:05.763

Eclipse 透视图通常由特性/插件定义。如果您缺少某个视角，请检查安装功能/插件列表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T20:36:32.720

编辑器和其他插件可能会添加自己的视角。您也可以创建和保存自己的透视图，但我相信您是在询问插件添加的透视图。

解决方案是安装相同的插件。

# javascript - 检查 javascript 中是否支持 URL 方案

> ID：627916
> 
> 赞同：64
> 
> 时间：2009-03-09T20:34:17.250
> 
> 标签：javascript, iphone, safari, url-scheme

有什么方法可以检查当前是否在手机上注册了 URL 方案......使用 javascript？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-09-10T11:10:52.463

不是无缝的。但是有一种类似于检查弹出窗口是否被阻止的方法。

当您尝试不支持的 URL 方案时，Safari 会警告用户它不知道如何处理它并停留在同一页面上。

因此，如果您给您的应用程序调用一些时间来激活，比如 300 毫秒，然后做其他事情来响应该方案的不存在。

这不是最漂亮的，但它有效：

```
function startIThrown(){
  document.location = 'ithrown://restart';
  setTimeout(function(){
    if(confirm('You do not seem to have iThrown installed, do you want to go download it now?')){
      document.location = 'http://itunes.apple.com/WebObjects/MZStore.woa/wa/viewSoftware?id=293049283&mt=8&uo=6';
    }
  }, 300);
}

<a href="#" onclick="startIThrown()">Restart iThrown</a> 
```

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2011-07-06T16:23:56.627

这是一个解决方案，当您从应用程序返回时不显示弹出窗口，它假设您离开的时间超过 400 毫秒：

```
function startiThrown() {
    document.location = appurl;
    var time = (new Date()).getTime();
    setTimeout(function(){
        var now = (new Date()).getTime();

        if((now - time)<400) {
            if(confirm('You do not seem to have iThrown installed, do you want to go download it now?')){
            document.location = 'http://itunes.apple.com/WebObjects/MZStore.woa/wa/viewSoftware?id=293049283&mt=8&uo=6';
            }
         }
    }, 300);
} 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2013-02-05T11:25:52.563

我发现`pagehide`事件比依赖系统时间更强大。对于我们这些喜欢非 jQuery 的人来说，这里是片段。

```
 var appurl = 'custom://url';
  var appstore = 'https://itunes.apple.com/us/app/your-app';

  var timeout;
  function preventPopup() {
    clearTimeout(timeout);
    timeout = null;
    window.removeEventListener('pagehide', preventPopup);
  }
  function startApp() {
    window.location = appurl;
    timeout = setTimeout(function(){
      if(confirm('You do not seem to have the App installed, do you want to go download it now?')){
        document.location = appstore;
      }
    }, 1000);
    window.addEventListener('pagehide', preventPopup);
  } 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-09-20T18:51:29.950

另一个很棒的（至少在最新的浏览器版本中工作）解决方法是检查浏览器窗口在短暂超时后是否有焦点，这样只有当 URI 方案不起作用时，您才能向用户显示一个对话框

HTML：

```
<a class="uri-link" data-uri="qobuzapp://" href="#">URI</a>​ 
```

Javascript（在这里使用 jQuery）：

```
var windowHasFocus;

$(window).focus(function() {
  windowHasFocus = true;
}).blur(function() {
  windowHasFocus = false;
});

function goToUri(uri) {
  window.location = uri;
  setTimeout(function(){
    if (windowHasFocus) {
      if (confirm('You do not seem to have Qobuz installed, do you want to go download it now?')){
        window.location = 'http://www.qobuz.com';
      }
    }
  }, 100);
}

$('a').on('click', function(){ 
  goToUri($(this).data('uri')); 
});​ 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2013-08-29T13:05:06.797

从 iOS 6.0 开始，Apple 推出了智能应用横幅，它可以满足我们大多数人的需求：

*   如果未安装应用程序，请发送到 App Store。
*   使用 app-argument 参数打开具有特定深层链接的应用程序。

包括以下元标记：

```
<meta name="apple-itunes-app" content="app-id=myAppStoreID, affiliate-data=myAffiliateData, app-argument=myURL"> 
```

取自此处： [Safari Web 内容指南](https://developer.apple.com/library/ios/documentation/AppleApplications/Reference/SafariWebContent/PromotingAppswithAppBanners/PromotingAppswithAppBanners.html)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-09T20:39:48.233

不，不是来自网页。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-07-12T01:27:29.703

这是前两个解决方案的变体。它将创建一个可以在 Google Chrome 中打开的链接。如果失败，它将使用 http 打开链接

```
<script>
 function checkChrome(h){
  document.location=h;
  var time = (new Date()).getTime();
  setTimeout(function(){
   var now = (new Date()).getTime();
   if((now-time)<400) {
    if(confirm('Missing Chrome. Download it now?')){
     document.location = 'http://itunes.apple.com/us/app/chrome/id535886823?mt=8';
    } else {
     document.location=h.replace('googlechrome','http');
    }
   }
  }, 300);
 }
</script>

<a href="googlechrome://www.google.com" onclick="checkChrome(this.href);return false;">Open Google with Chrome</a> 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-04-30T09:30:45.977

这是基于mrahman的回答。如前所述，JoshNaro **new Date()**在超时内调用时会返回错误的日期。测试表明，在停用应用程序之前启动的线程中，日期没有更新。

激活后调用的更丑陋的 setTimeout 将使用当前日期创建一个新线程。

这是在 iOS 8 上测试的。

```
function startiThrown() {
    document.location = appurl;
    var time = (new Date()).getTime();
    setTimeout(function(){
        setTimeout(function(){ // <-- start new thread after activation
            var now = (new Date()).getTime();
            if((now - time)<400) {
                if(confirm('You do not seem to have iThrown installed, do you want to go download it now?')){
                    document.location = 'http://itunes.apple.com/WebObjects/MZStore.woa/wa/viewSoftware?id=293049283&mt=8&uo=6';
                }
            }
        }, 10); // <-- start new thread after activation
    }, 300);
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-09-10T09:47:51.400

我有这个评论[https://stackoverflow.com/a/18715513/49114](https://stackoverflow.com/a/18715513/49114)带有一个 jQuery 插件，可以将替代应用程序链接添加到常规链接。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-08-22T23:09:58.560

我尝试只使用“pagehide”事件，但它不适用于 Firefox。我在这里创建了这个版本[http://jsfiddle.net/thiagomata/6tvoc4f1/2/](http://jsfiddle.net/thiagomata/6tvoc4f1/2/)适用于 Firefox、Google Chrome 和 Safari。我还没有在 Internet Explorer 中测试过。

让它在 Firefox 中运行所必需的一件事是使用 Iframe 来设置 src。这使我可以在不离开页面的情况下调用应用程序。

```
<a class="uri-link" href="#" 
  data-uri-app="myapp://" 
  data-url-app-not-found="http://www.google.com?q=not-found-link"
  >
  Example 1
</a>​
<a class="uri-link" href="#" 
  data-uri-app="myapp://" 
  data-url-app-not-found="http://www.google.com?q=not-found-link"
  data-url-app-found="http://www.google.com?q=found-link"
  >
  Example 2
</a>​
<a class="uri-link"  href="#"
  data-uri-app="notexists://" 
  data-url-app-not-found="http://www.google.com?q=not-exists"
>
  Example 3
</a>​
<iframe id="callapp" style="display:none"></iframe> 
```

# sql - 我对 SQL 注入安全吗

> ID：627918
> 
> 赞同：4
> 
> 时间：2009-03-09T20:35:07.527
> 
> 标签：sql, security, postgresql, sql-injection

当我在 PostgresSQL 中使用类似的东西时，我想知道我是否可以安全地防止 SQL 注入：

```
CREATE or REPLACE FUNCTION sp_list_name( VARCHAR )
RETURNS SETOF v_player AS '
   DECLARE
      v_start_name ALIAS FOR $1;
      r_player  v_player%ROWTYPE;
      v_temp VARCHAR;
   BEGIN
      v_temp := v_start_name || ''%'';
      FOR r_player IN
         SELECT first_name, last_name FROM v_player WHERE last_name like v_temp
      LOOP
         RETURN NEXT r_player;
      END LOOP;
      RETURN;
   END;
' LANGUAGE 'plpgsql' VOLATILE; 
```

我想用这个函数列出以字母开头的玩家名字。

```
select * from sp_list_name( 'A' ); 
```

给我姓氏以 A 开头的玩家。

我试图注入sql

```
select * from sp_list_name( 'A; delete from t_player;--' );
select * from sp_list_name( '''; delete from t_player;--' ); 
```

我安全吗？

哪种情况可以注射？

问候

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-09T21:43:14.883

就您的过程而言，您似乎很安全，因为 SP 中的变量不会扩展为代码，但如果您在*应用程序代码**`SELECT * FROM sp_list_name(?);`*中不使用像 " "这样的参数化查询，您仍然可以暴露自己。像“ ”这样的东西可能会被用户传递“ ”的开始名称所破坏。因此，请使用参数化查询或健全性检查程序中的输入。**`SELECT * FROM sp_list_name('$start_name');`***`');delete from t_player where last_name NOT IN ('`***

 ***注意：** 对于其他人，请注意存储过程中的变量即使包含 ' 或 ;，也**不会扩展为代码（不包括将其传递给***EXECUTE*，您将使用它*`quote_literal`*，而不是手动*`replace`*函数）所以替换 ; or ' 是完全没有必要的（在存储过程中，使用它的应用程序当然是另一回事）并且会阻止您始终找到“ `tl;dr`”或“ `O'Grady`”团队。

**Leo Moore，Karl，LFSR 咨询**： `v_temp_name`在存储过程中*不会*扩展为 SP 中的代码（没有*EXECUTE*），需要在应用程序中完成检查，而不是 SP（或者 OP 可以只使用参数化查询而是在他们的应用程序代码中）。其他人的建议类似于担心

```
my $bar = "foo; unlink('/etc/password');"; 
my $baz = $bar; 
```

在没有评估的情况下实际运行取消链接。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-09T20:40:57.983

防止 sql 注入的规则 #1：清理来自您无法信任/无法控制的某人/某事的所有输入。

问题本身不在于数据库代码，而在于执行这些语句的应用程序。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-09T22:19:47.060

防止 SQL 注入的正确方法是通过[白名单](http://en.wikipedia.org/wiki/Whitelist)* - 设置您要接受的字符并将它们过滤掉。

错误的方法是[黑名单](http://en.wikipedia.org/wiki/Blacklist)- 黑名单不接受哪些字符会导致麻烦，因为**你无法**跟上攻击者的步伐。有一些方法可以通过 ASCII 表、转义字符等绕过黑名单。

此外，这里有一个不错的[备忘单](http://ha.ckers.org/sqlinjection/)，可以在您的网站上试用。运行一些测试并尝试让事情失败。

`*`在应用程序中，而不是 DB（感谢 James）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-09T20:39:46.800

您不是为自己生成 SQL，所以这看起来很安全（对我来说）。

我不知道您调用存储过程的数据来自哪里。所以你仍然必须防止缓冲区溢出等。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-11T13:05:16.967

参考。白名单。如果遵循某些其他条件，这是可以的。将所有输入分解为最简单的形式是绝对必要的，因此不要只检查 SQL 查询名称、单引号等。它们可以使用其他字符集表示或编码，而这正是白名单的一部分而不是专门的SQL 关键字本身。

我正在为一个允许用户名/密码访问受保护资源的特定客户工作（这最终可以让您获得进入机场安全部分的访问通行证！）。您可以通过输入 ' 绕过登录字段，然后从那里构建 SQL 查询以检索用户帐户和密码。

问题是客户已经花了 20 万英镑与一家似乎从未做过 Web 开发的供应商建立网站。修复是另外 6 万英镑，这是一个 validate func()，它只检查 union、select、have et al 关键字。当被问及他们为 canicolisation /encoding 做了什么（我必须随后解释）时，这是风滚草时间。

开发室和（昂贵的）项目被封杀了。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-03-09T21:57:56.283

您可以考虑验证的内容

```
v_start_name
```

. 检查字符串中的分号、注释字符、等号等。记住要检查字符和十六进制值。请记住允许使用连字符的名称，例如“Smith-Brown”可能是可以接受的“Smith--Brown”可能是注入。

如果不熟悉 SQL 注入中的十六进制，以下是快速介绍

[http://www.arejae.com/blog/sql-injection-attack-using-t-sql-and-hexadecimal.html](http://www.arejae.com/blog/sql-injection-attack-using-t-sql-and-hexadecimal.html)

[http://www.securityfocus.com/infocus/1768](http://www.securityfocus.com/infocus/1768)

```
宣布
      v_start_name 别名 1 美元；
      r_player v_player%ROWTYPE;
      v_temp VARCHAR；
   开始
      -- 新的伪代码在这里
      如果 v_start_name 有错误字符退出并显示错误消息
      -- 在此结束伪代码
      v_temp := v_start_name || ''%'';
      FOR r_player IN
         SELECT first_name, last_name FROM v_player WHERE last_name like v_temp
      环形
         返回下一个 r_player;
      结束循环；
      返回;
   结尾;

```

问候卡尔

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-03-09T22:01:50.080

只需对您的 v_start_name 进行替换即可摆脱“；” 等，即

```
v_clean_name VARCHAR;
Select v_clean_name = Replace(v_start_name,';',''); 
```

这将取代 ; 用空格挫败 SQL 注入攻击

有关详细信息，请参阅[PostgresSQL 中的字符串函数](http://www.postgresql.org/docs/8.1/static/functions-string.html)

正如 LFSR Consulting 所评论的那样。最好是白名单（即不要处理任何带有无效字符的输入，例如';'）而不是黑名单（即尝试清理数据，因为用户也可能对您的替换进行 SQL 注入攻击）。

有关更多信息，请查看[SQL 注入攻击](http://books.google.ie/books?id=zwAT_dcL84YC&pg=PA130&lpg=PA130&dq=sQL+injection+black-listing&source=bl&ots=20OZQ3Pn57&sig=yWKYbqfCesUyXjvBT6pYlkLevzM&hl=en&ei=XZO1SeP-MOKHjAfi6rnoBQ&sa=X&oi=book_result&resnum=3&ct=result#PPA132,M1)

# width - 从 SqlDataReader 获取列宽

> ID：627925
> 
> 赞同：1
> 
> 时间：2009-03-09T20:36:35.450
> 
> 标签：width, sqldatareader

我之前带着这个任务来到了 StackOverflow： [MS SQL2005 Query/Stored Proc Results To Text using SqlCommand or any other method](https://stackoverflow.com/questions/547040/ms-sql2005-query-stored-proc-results-to-text-using-sqlcommand-or-such)

有人告诉我自己构建字符串，以便获得与 SQL Managment Studio 的 Results To Text (Cntrl + T) 相同的结果

我现在遇到了一个问题，如何动态确定列的宽度？还有那些是 VARCHAR(MAX) 的列呢？我完全不知道事先会进入 SqlDataReader 的内容。

这是我到目前为止的代码，我基本上需要消除 PADDING_LENGTH 并动态替换它的值。

我从网上某处获取了基本代码。（谁先写的，谢谢你）

```
StringBuilder sb = new StringBuilder(); 
 private void GenerateResultsText(SqlDataReader reader)
    {
        const int PADDING_LENGTH = 40;

        do
        {
            // Create new data table
            DataTable schemaTable = reader.GetSchemaTable();

            if (schemaTable != null)
            {
                // A query returning records was executed
                for (int i = 0; i < schemaTable.Rows.Count; i++)
                {
                    DataRow dataRow = schemaTable.Rows[i];
                    // Create a column name that is unique in the data table
                    string columnName = (string)dataRow["ColumnName"];
                    //Add to Results String.
                    sb.Append(String.Format("{0, " + -1 * PADDING_LENGTH + "}", columnName));
                }
                sb.Append(Environment.NewLine);

                //Add markers to seperate Row entries from Column names. 
                const string columnRowSeperator = "-----"; //Keep it to a multiple of 5.
                for (int i = 0; i < schemaTable.Rows.Count; i++)
                {
                    for (int j = 0; j < PADDING_LENGTH / columnRowSeperator.Length; j++)
                        sb.Append(columnRowSeperator);
                }
                sb.Append(Environment.NewLine);

                // Fill the data table we just created
                while (reader.Read())
                {
                    Object temp;

                    for (int i = 0; i < reader.FieldCount; i++)
                    {
                        temp = reader.GetValue(i);
                        sb.Append(String.Format("{0, " + -1 * PADDING_LENGTH + "}", temp.ToString()));
                    }
                    sb.Append(Environment.NewLine);
                }

                //Add newlines to seperate tables.
                sb.Append(Environment.NewLine + Environment.NewLine);
            }
        }
        while (reader.NextResult());

        reader.Close();
        reader.Dispose();
    } 
```

干杯，凯。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T21:26:55.920

## 编辑

这是一个使用 DataReader 的示例。您可以更具体地查看架构表中的 NumericPrecision 列等，但我认为这会让您入门。

```
using (SqlConnection conn = new SqlConnection("Data Source=server;Initial Catalog=db;User Id=user;Password=pass;"))
{
    using (SqlCommand cmd = new SqlCommand("select * from table", conn))
    {
        conn.Open();
        StreamWriter sw = new StreamWriter(File.Open("test.txt", FileMode.Append));        
        DataTable schema = null;

        using (SqlDataReader rdr = cmd.ExecuteReader())
        {
            schema = rdr.GetSchemaTable();

            for (int i = 0; i < rdr.FieldCount; i++)
            {
                string name = schema.Rows[i]["ColumnName"].ToString();
                sw.Write(name.PadRight(name.Length + Convert.ToInt32(schema.Rows[i]["ColumnSize"])) + " ");
            }

            sw.WriteLine();

            for (int i = 0; i < rdr.FieldCount; i++)
            {
                string name = schema.Rows[i]["ColumnName"].ToString();
                sw.Write(new string('-', name.Length + Convert.ToInt32(schema.Rows[i]["ColumnSize"])) + " ");
            }

            rdr.Close();//can't have two open datareaders on the same connection
            rdr.Dispose();

            sw.WriteLine();

            while (dataReader.Read())
            {
                for (int i = 0; i < dataReader.FieldCount; i++)
                {
                    string name = schema.Rows[i]["ColumnName"].ToString();
                    sw.Write(dataReader[i].ToString().PadRight(name.Length + Convert.ToInt32(schema.Rows[i]["ColumnSize"])) + " ");
                }
                sw.WriteLine();
            }

        }

        sw.Close();
        sw.Dispose();
    }
} 
```

我无法花足够的时间来了解如何使用 DataReader 执行此操作，但如果您使用 DataAdapter，则可以这样做：

```
 using (SqlConnection conn = new SqlConnection("Data Source=someserver;Initial Catalog=somedb;User Id=user;Password=password;"))
    {
        using (SqlCommand cmd = new SqlCommand("select * from sometable", conn))
        {
            conn.Open();
            using (SqlDataAdapter adapter = new SqlDataAdapter(cmd))
            {
                DataSet set = new DataSet();
                set.Tables.Add("Schema");
                set.Tables.Add("Data");

                adapter.Fill(set, "Data");
                adapter.FillSchema(set, SchemaType.Source, "Schema");

                StreamWriter sw = new StreamWriter(File.Open("test.txt", FileMode.Append));        

                for(int i = 0; i < set.Tables["Schema"].Columns.Count; i++)
                {

                    sw.Write(set.Tables["Schema"].Columns[i].ColumnName.PadRight(set.Tables["Schema"].Columns[i].MaxLength + set.Tables["Schema"].Columns[i].ColumnName.Length, ' ') + " ");
                }
                sw.WriteLine();

                for(int i = 0; i < set.Tables["Schema"].Columns.Count; i++)
                {
                    sw.Write(new string('-', set.Tables["Schema"].Columns[i].MaxLength + set.Tables["Schema"].Columns[i].ColumnName.Length) + " ");
                }
                sw.WriteLine();

                foreach(DataRow row in set.Tables["Data"].Rows)
                {
                    foreach(DataColumn col in set.Tables["Data"].Columns)
                    {
                        sw.Write(row[col].ToString().PadRight(set.Tables["Schema"].Columns[col.ColumnName].MaxLength + col.ColumnName.Length) + " ");
                    }
                    sw.WriteLine();
                }

                sw.Close();
                sw.Dispose();

            }
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T20:41:37.090

您不能仅从 Sql 数据阅读器确定要在屏幕上显示的列的宽度 - 毕竟，列的宽度在很大程度上取决于您使用的屏幕字体、大小、粗体或不加粗等等。

您需要做的是将文本渲染到您想要显示它的 UI 中 - 在 UI 方面，您可以测量使用给定字体、大小和字体特征显示给定文本所需的空间。

马克

# deployment - Grails 部署错误

> ID：627929
> 
> 赞同：3
> 
> 时间：2009-03-09T20:38:00.860
> 
> 标签：deployment, tomcat, grails

Grails grails-1.0.4 , TomCat 6.0.14 , Tomcat 错误日志：

```
SEVERE: Error configuring application listener of class org.springframework.web.util.Log4jConfigListener
java.lang.ClassNotFoundException: org.springframework.web.util.Log4jConfigListener
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1358)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1204)
    at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:3773)
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:4337)
    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:791)
    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:771)
    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:525)
    at org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:825)
    at org.apache.catalina.startup.HostConfig.deployWARs(HostConfig.java:714)
    at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:490)
    at org.apache.catalina.startup.HostConfig.start(HostConfig.java:1138)
    at org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:311)
    at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:117)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1053)
    at org.apache.catalina.core.StandardHost.start(StandardHost.java:719)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1045)
    at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:443)
    at org.apache.catalina.core.StandardService.start(StandardService.java:516)
    at org.apache.catalina.core.StandardServer.start(StandardServer.java:710)
    at org.apache.catalina.startup.Catalina.start(Catalina.java:566)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:585)
    at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:288)
    at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:413)
Mar 9, 2009 3:53:17 PM org.apache.catalina.core.StandardContext listenerStart
SEVERE: Error configuring application listener of class org.codehaus.groovy.grails.web.context.GrailsContextLoaderListener
java.lang.NoClassDefFoundError: org/springframework/web/context/ContextLoaderListener
    at java.lang.ClassLoader.defineClass1(Native Method)
    at java.lang.ClassLoader.defineClass(ClassLoader.java:620)
    at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:124)
    at org.apache.catalina.loader.WebappClassLoader.findClassInternal(WebappClassLoader.java:1817)
... 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-10T05:31:15.790

检查您的 WEB-INF/lib 目录，好像缺少一些罐子。

检查您的 Config.groovy 并确保您没有明确指定依赖项：

```
grails.war.dependencies
grails.war.java5.dependencies 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T06:07:08.547

请谷歌“grails tomcat logging”。

Tomcat 和日志记录有一些奇怪的行为，我虚弱的头脑已经忘记了，除了 Tomcat 库中的 log4j jar 可能存在问题，这些问题在 Grails 战争文件中重复，或者类似的东西，或者完全不同的东西。

但是您应该可以在 5-10 分钟内通过 Google 找到答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-22T06:25:10.103

我通过覆盖模板来修复它

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-24T07:25:28.787

这可能是因为使用较旧的 grails 应用程序在安装的最新版本的 sts 或任何 IDE 上运行...

# regex - VI 正则表达式 - 使用当前行号替换

> ID：627932
> 
> 赞同：19
> 
> 时间：2009-03-09T20:38:42.853
> 
> 标签：regex, vim

我不确定这是否可能，但我发现我经常需要做的一件事是替换文件的内容，但我想使用当前行号作为替换选项。所以如果我有一个像这样的文件：

```
This is text to replace XX 
This is text to replace XX 
This is text to replace XX 
```

我希望能够运行一个正则表达式，将该文件转换为：

```
This is text to replace 1
This is text to replace 2
This is text to replace 3 
```

我环顾四周，但似乎找不到任何方法。这可能吗？有谁知道一种简单的方法来解决这个问题？

谢谢。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-03-09T20:50:06.230

```
:help sub-replace-expression 
```

您可以构造一个替换表达式，如：

```
:s@ xx$@\=" " . line(".")@ 
```

...这对我有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-10-01T08:03:30.677

这是更容易的方法

```
:%s/dummy/\=printf("dummy%d", line('.')) 
```

vi 中的上述正则表达式将行号附加到每个虚拟单词：

从

```
dummy
dummy
dummy 
```

到：

```
dummy1
dummy2
dummy3 
```

# c# - 如何在 FireFox 运行时访问 FireFox 3 书签？

> ID：627937
> 
> 赞同：1
> 
> 时间：2009-03-09T20:39:20.903
> 
> 标签：c#, .net, sqlite, firefox

Firefox 3 现在将书签存储在名为profiles.sqlite 的Sqlite 文件中。

此文件在 Firefox 3 运行时被锁定。

我知道有备份文件，但它们很旧（仅在 FF 退出时写入）。

我不希望用户必须安装插件。

有没有办法在 FF 3 运行时抓取书签？

我正在为 Windows 开发 C# 3.5。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T21:36:01.190

SQL Lite 是用于单用户应用程序的嵌入式数据库，不是为多用户访问而构建的。[请参阅他们的何时使用问题列表中](http://www.sqlite.org/whentouse.html)标题为“另一个 RDBMS 可能工作得更好的情况”部分。

此外，“高并发”下的文本指出“SQLite 在整个数据库文件上使用读/写锁”。

所以，不，没有其他选择。构建一个插件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-02T18:00:09.940

[我也遇到了同样的问题，但在这个网站和其他网站上搜索后，为我的项目http://www.codertakeout.com](http://www.codertakeout.com)想出了这段代码。

```
using System.Data.SQLite;  // need to install sqlite .net driver

String path_to_db = @"C:\Documents and Settings\Jeff\Application Data\Mozilla\Firefox\Profiles\yhwx4xco.default\places.sqlite";
String path_to_temp = System.IO.Path.GetTempFileName();

System.IO.File.Copy(path_to_db, path_to_temp, true);
SQLiteConnection sqlite_connection = new SQLiteConnection("Data Source=" + path_to_temp + ";Version=3;Compress=True;Read Only=True;");

SQLiteCommand sqlite_command = sqlite_connection.CreateCommand();

sqlite_connection.Open();

sqlite_command.CommandText = "SELECT moz_bookmarks.title,moz_places.url FROM moz_bookmarks LEFT JOIN moz_places WHERE moz_bookmarks.fk = moz_places.id AND moz_bookmarks.title != 'null' AND moz_places.url LIKE '%http%';";

SQLiteDataReader sqlite_datareader = sqlite_command.ExecuteReader();

while (sqlite_datareader.Read())
    {
        System.Console.WriteLine(sqlite_datareader[1]);
    }
sqlite_connection.Close();
System.IO.File.Delete(path_to_temp); 
```

# c# - DDD 用户安全策略

> ID：627945
> 
> 赞同：7
> 
> 时间：2009-03-09T20:40:37.220
> 
> 标签：c#, .net, domain-driven-design

我有一个 RentalProperty 类，它看起来像这样：

```
class RentalProperty
{
    Money MonthlyRent;
    List<MaintainenceCall> MaintainenceCalls;
} 
```

据我了解，使用 DDD 更改 MonthlyRent，我将获取 RentalProperty，更改 MonthlyRent 属性，然后调用 RentalPropertyRepository.Save()。将处理相同的过程以添加新的维护调用。

我遇到的问题是，例如，杂工应该能够添加维护呼叫，但不应允许更改月租。我应该如何实施这个（以及其他类似的）安全策略？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-20T03:40:04.660

简而言之，您应该直接在模型中应用此业务规则。在您的情况下，直接在 MonthlyRent getter 和 setter 属性中。我们都知道有很多检查和安全级别会变得多么复杂；所以，这就是规格的用途。

DDD playbook 引入了**Specifications**的概念，正是为了将重点放在模型本身上。您首先像上面描述的那样设置您的 getter 和 setter 以获得功能。然后，在重构期间，通过将较长的 getter/setter 代码抽象到 Specification 类中来寻找使模型更简洁的方法。

```
Employee employee = 
    employeeRepository.findEmployee(employeeID);

Specification employeeCanModifyRent = new
    Specification(
        new EmployeeHasAccessToManagement()
        , new EmployeeHasAccessToMoney());

if(employeeCanModifyRent.isSatisfiedBy(employee))
{
  rentService.changeRent();
}
else
{
  throw new exception("Access denied.");
} 
```

阅读代码可以清楚地了解代码的确切作用。这本身就是核心 DDD 概念。规范应该保持非常简单，直截了当。

这段代码来自[Domain-Driven Design Quickly](https://rads.stackoverflow.com/amzn/click/com/1411609255)，一个简短而快速的 DDD 快速阅读。这确实是一本关于 DDD 的短小精悍的书，值得花几个小时阅读。只有100页左右。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-09T20:58:06.413

AOP。[PostSharp](http://www.postsharp.org/)真的很适合这样的东西。

因为安全确实是一个跨领域的问题。

# qt - 如何将信号连接到不同线程中的插槽？

> ID：627948
> 
> 赞同：2
> 
> 时间：2009-03-09T20:41:08.793
> 
> 标签：qt, signals-slots

Qt 通常在单个线程中使用信号和槽，因此调用信号将在调用信号的同一线程中调用槽。有什么方法可以使用信号槽机制将消息传递给 qt 线程（因此稍后将在指定线程的上下文中调用槽）？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-09T20:48:29.617

[可以在Qt 官方文档](http://qt-project.org/doc/qt-4.8/)的起始页上找到[跨线程的信号和槽](http://qt-project.org/doc/qt-4.8/threads-qobject.html#signals-and-slots-across-threads)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T20:43:36.900

我认为通常的处理方法是让信号处理程序将一些其他函数排入队列（使用 boost::bind 或一些类似的仿函数），然后让目标线程队列稍后运行它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T21:01:50.623

至少对于 Qt4，这完全没有问题。你只需要在你有变量指向两个线程的地方建立连接。（即通常在 main() 中）

# .net - 如何在使用 MS Test 时加载 web.config

> ID：627953
> 
> 赞同：2
> 
> 时间：2009-03-09T20:42:09.617
> 
> 标签：.net, unit-testing, mstest

我正在测试一些业务对象的 Save() 方法。为了保存对象，我需要从配置管理器中读取连接字符串。但我得到的只是空值。我的设置在网站 web.config 中。如何在测试运行时获取。我需要额外的配置吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-09T21:10:15.400

单元测试项目必须有它自己的配置文件。在项目中添加一个，并将您需要的连接字符串设置放入其中。

# php - 在 Windows 上使用 PHP 进行串行通信

> ID：627965
> 
> 赞同：10
> 
> 时间：2009-03-09T20:45:05.740
> 
> 标签：php, serial-port, communication

我正在寻找一种与 Windows 上的 RS232 串行 COM 端口通信的方法。我在网上找到了两种解决方案，[一种](http://www.easyvitools.com/phpserial/index.html)不是完全免费的（在功能上引入了故意延迟），[另一种](http://www.phpclasses.org/browse/package/3679.html)在 Windows 上功能有限。后者只能写入 Windows 上的 COM 端口，不能读取。

我看不到第一个解决方案的代码，因为它被编译成一个 .dll （有道理，否则人们只能编辑延迟而不是购买它......）而第二个似乎只使用 fopen()打开端口，然后 fwrite() 对其进行写入，就像对流所做的那样。但显然它没有返回任何东西。

我知道这是可能的，因为第一个解决方案是这样做的，尽管它确实需要 Apache 使用 php-cgi 模块而不是 php5module。

有任何想法吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2011-08-28T17:28:56.813

上面的每个解决方案要么效率低下，要么工作量太大。

您可以只使用[PHP-DIO 库](http://php.net/manual/en/book.dio.php)（dio_fcntl、dio_open、dio_read、dio_write、dio_seek，...）。它也在[PHP 手册的 DIO 条目中](http://us2.php.net/manual/en/book.dio.php)：

默认情况下，此 PECL 包不可用。如果您的 PHP 5.2.x 大于 5.2.6，要在 Windows 上获取它，您可以将其作为 ZIP 的一部分下载：

*   [线程安全（对于 Apache）](http://museum.php.net/php5/pecl-5.2.6-Win32.zip)

*   [非线程安全（对于 IIS）](http://museum.php.net/php5/pecl-5.2.6-nts-Win32.zip)

这两个链接都可以在[http://www.deveblog.com/index.php/download-pecl-extensions-for-windows/中找到](http://www.deveblog.com/index.php/download-pecl-extensions-for-windows/)

[这是来自 Linux 的构建](http://pecl.php.net/package/dio)，只需获取它并执行 phpize/configure/make/make 安装即可。

我不知道它是否应该在 Apache 会话中使用，但是去吧。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-07-02T13:14:14.150

您需要使用类似 DOS 的命令设置 com 端口。

例如下面一行通过 php 执行命令：

```
$output = `mode COM1: BAUD=115200 PARITY=N data=8 stop=1 XON=off TO=on`; 
```

要显示结果，您可以使用：

```
echo "$output"; 
```

创建资源ID：

```
$fp = fopen('COM1', 'r+');

if (!$fp)
{
      echo "Port not accessible";
}
else
{
     echo "Port COM1 opened successfully";
} 
```

写入端口：

```
$writtenBytes = fputs($fp, "Hello");

echo"Bytes written to port: $writtenBytes"; 
```

从端口读取：

```
$buffer = fgets($fp);

echo "Read from buffer: $buffer"; 
```

也许有人可以帮助我解决这个`fgets`问题。如果 ，它会在那里堆叠一分钟`TO=on`，或者如果 ，则永远堆叠在那里`TO=off`。这似乎是一个“ `MODE COM`”选项，所以也许 DOS 专家可以提供帮助。

也许`fgets`应该使用`fgetc`, 而不是 , 因为`fgets`捕获到`newline`, 而`fgetc`捕获单个字符。如果没有遇到新行，它可能会阻塞，直到有一个或直到缓冲区被刷新。一分钟的延迟可能是窗口每隔一段时间刷新其缓冲区。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-09T20:50:55.493

解决这个问题的最简单方法是用另一种语言（例如 C++）编写程序，然后使用`system()`. 在 C++ 中执行 Comm I/O 是微不足道的。

这假设您对服务器有足够的访问权限来配置它以允许可执行文件由 php 等运行。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-09T21:02:54.670

另一种可能的方法是通过类似[`w32api_register_function()`](http://www.php.net/w32api_register_function)或[ffi](http://pecl.php.net/package/ffi)的方式使用 Win32 API ，然后使用[串行通信调用](http://msdn.microsoft.com/en-us/library/ms810467.aspx)使其在 Windows 下工作。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-11-08T18:50:05.913

当我遇到这个在 Arduino 开发人员中很流行的解决方案 - 'serproxy' 时，我遇到了同样的问题并且已经考虑编写自己的 php 扩展程序（在很多地方都找到了它，即[http://www.lspace.nildram.co。 uk/freeware.html](http://www.lspace.nildram.co.uk/freeware.html) ) 设置一个到/从串行端口的 tcp 堆栈，并允许我使用 php 套接字函数与其通信。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-07T16:53:55.160

另一种选择是通过 Windows 上的 ActiveX 使用对象。Windows 上有几个用于 COM 的商业串行对象，主要是商业串行对象。您还可以公开基于 .Net 的对象并将其注册以供 COM 使用。当然，这假设您在服务器上拥有注册 COM 控件的控制权，因为您需要一个串行接口。

如果要通过 Web 使用，另一个问题是资源争用。例如，如果这是用于串行打印机，那么打印队列管理器将是您直接通信的最佳选择。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-01-04T16:35:10.710

[如果您想使用 com 端口处理 sms，那么这里是Rémy Sanchez](http://www.phpclasses.org/package/3679-PHP-Communicate-with-a-serial-port.html)最著名的php 串行通信类和[google 示例代码](https://code.google.com/p/php-serial/)。[这是一个](https://stackoverflow.com/questions/15902831/execute-at-commands-to-send-sms-in-php)包含该主题的线程。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-12-15T00:58:15.147

我使用了 David Refoua 和 Giorgos Pap 的解决方案，并进行了一些修改以连接 Arduino UNO。在 PC 端，我有一个 AJAX 来接收来自 Arduino 的测量结果并以表格形式显示它们。现在我正在尝试以编程方式更新 COM 端口（在本例中为 COM3），

```
<?php
$output = exec("mode COM2: BAUD=115200 PARITY=N data=8 stop=1 XON=off TO=on dtr=off odsr=off octs=off rts=on idsr=off");
$fp = fopen("COM2", "r+");
if (!$fp)
{
  exit("Unable to establish a connection");
}
// RX form PC**************
$t = $_POST['text1'];
// TX to Arduino****************
$writtenBytes = fputs($fp, $t);
sleep(1); 
// RX from Arduino**************
$j=0;
$dataset1 = [];
while(!$buffer=stream_get_line($fp,400,"\n")) { 1; }
// TX to PC***************
$piecesa = explode(",", $buffer);
foreach ($piecesa as $value) {  
    $dataset1[$j] = $value;
    $j++;
}
$myJSON = json_encode($dataset1);
echo $myJSON;
fclose($fp);
?> 
```

该程序运行良好，延迟时间很短，大约 8 秒。最大。这是 Windows 操作系统。

# ruby-on-rails - 用于批评的 Rails 应用程序控制器（随意苛刻）

> ID：627969
> 
> 赞同：2
> 
> 时间：2009-03-09T20:45:55.583
> 
> 标签：ruby-on-rails, scaffolding, controllers

我编写了一个应用程序控制器，它可以处理我需要任何控制器来完成的 99% 的事情。我已经把它贴在[这里](http://pastebin.com/f61c0afbf)（pastebin）。就像我说的，随意苛刻。

-更新：添加评论:)

谢谢，

-C

PS 我想说的是，我在这里的意图是覆盖子类控制器中需要不同功能的方法，例如*_message 方法和after_*方法。应用程序控制器将充当一种抽象类。此外，一些 before_filters 是特定于插件的，例如 tiny_mce 和 restful_authentication（太棒了，恕我直言。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T18:07:07.157

这不是您问题的答案，但如果您想在这个方向上更进一步，您可能需要看看[Hobo](http://hobocentral.net/)。它的[Hobo::ModelController](http://github.com/tablatom/hobo/blob/master/hobo/lib/hobo/model_controller.rb)做了很多你的 ApplicationController 所做的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T18:10:19.147

小事，但我会将对象、模型和模型名称方法设为私有或受保护。除此之外，我没有发现任何错误。

# eclipse - 如何重新安装已安装的 Eclipse 插件？

> ID：627976
> 
> 赞同：13
> 
> 时间：2009-03-09T20:48:14.953
> 
> 标签：eclipse, plugins

你如何从一个 Eclipse 安装“删除”或“复制”一个 Eclipse 插件到另一个？例如，我安装了两个 eclipse，其中一个安装了一个插件，我没有安装程序，也没有在线可用。是否可以在我的其他版本的 eclipse 上安装此插件？如果是这样，怎么做？

另外，如果我的两个版本的 eclipse 真的是*不同的版本*，即一个是 3.4，另一个是 3.3 或 3.2，这有关系吗？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2010-10-23T00:16:13.417

**编辑**：只需添加我正在使用的 Eclipse 版本：3.5 galileo

我设法使用“安装新软件”选项进行了卸载（访问卸载实例的坏名）。

您可以查看以下图片：

![替代文字](https://i.stack.imgur.com/KAQzX.jpg) ![替代文字](https://i.stack.imgur.com/by68F.jpg) ![替代文字](https://i.stack.imgur.com/Yocba.jpg)

另一种方法是：

帮助->关于Eclipse->安装细节

然后选择要卸载的插件。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-09T21:06:26.097

正如我[对您上一个问题的回答](https://stackoverflow.com/questions/627914/how-to-add-perspectives-in-eclipse)中提到的那样，并且由于（再次）选择的答案在细节上非常差，因此插件存在于：

*   对于 3.4 之前的 Eclipse (3.2, 3.3)

    *   日食/插件和日食/功能
    *   **任何其他目录，只要您通过在 Eclipse 安装的链接**目录中创建一个`foo.link`文件来定义链接（您可能必须**创建该****目录**），其中包含：****`[eclipse]\links`****

         **路径=C:/eclipse/扩展/foobar** 

 **通过引用 foobar 插件，具有以下子目录：

```
C:/eclipse/extensions/foobar/eclipse/plugins
C:/eclipse/extensions/foobar/eclipse/features 
```

*   对于 eclipse3.4 和 3.5，使用 p2 机制：
    *   通过将您的插件放在**dropins 目录**中（如`dropins/foobar/eclipse/plugins`and`dropins/foobar/eclipse/features`或 foobar.zip，zip 包含`eclipse/plugins`and `eclipse/features`）

因此，您应该在这些目录中查找插件，并将它们复制到适当的插件目录中以完成安装。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-09T20:53:40.243

您可以将相关文件夹和 jar 从源安装`plugins/`和`features/`文件夹复制到目标安装，然后使用`-clean`参数重新启动目标 Eclipse。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-06-13T15:23:56.977

对于 Eclipse 的更新版本，有一个更简单的解决方案：**File -> Import -> Install -> From existing installation**。从第二次安装中选择您的功能，您就完成了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-09T20:51:18.660

是的，您可以通过将相应的目录（或 jar）从源 eclipse install plugins/ 或/和 features/ 目录复制到目标 eclipse install plugin/ 或/和 features/ 目录来轻松完成此操作。

根据插件的不同，当源版本和目标版本不同时，您可能会遇到兼容性问题。一些插件使用大量的 eclipse 版本，有些需要不同的版本。

另外，一般提示：不要含糊，要更具体。有时在设置、版本等方面存在已知问题。具体可以潜在地帮助识别一个复杂的问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-09T20:57:57.113

如果插件有更新站点，您可以将其 url 复制到新安装并运行更新。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-07-18T21:13:11.967

```
>>How Do You Reinstall Installed Eclipse Plugins? 
```

你没有。

Eclipse中没有**重新安装插件**选项。

但是，您可以卸载插件 (***) 并使用重新安装它 `MENU >> Help | Install new Software`

(***) 按照 Sebastian 的卸载说明进行操作，该说明在最新的 Mars 版本的 Eclipse 中仍然有效。

# silverlight - 如何在 Silverlight 中将 XML 绑定到 DataGrid

> ID：627979
> 
> 赞同：1
> 
> 时间：2009-03-09T20:48:55.950
> 
> 标签：silverlight, data-binding, datagrid

我有一个从服务器接收 XML 的应用程序。我想将数据绑定到数据网格，如果网格自动生成列，那就太棒了。到目前为止，我已经在我的代码中尝试了这么多。

XAML 页面：

```
<data:DataGrid x:Name="Status" ItemsSource="{Binding}" AutoGenerateColumns="True">
</data:DataGrid> 
```

页面背后的代码：

```
void Status_OpenReadCompleted(object sender, OpenReadCompletedEventArgs e)
{
    XElement recordSet = XElement.Load(e.Result);
    CamerasStatusTabDataGrid.ItemsSource = recordSet.Elements("Status");
} 
```

来自服务器的 XML：

```
<StatusReport>
    <Status Description="Spilled Coffe on Server" Date="2/5/2009" />
    <Status Description="Mice in Copier" Date="4/3/2008" />
    <Status Description="Helped User Find Any Key" Date="6/2/2008" />
</StatusReport> 
```

我要做的是让状态成为网格中的一行，其中“描述”和“日期”为列。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T22:24:09.590

一个很好的方法是使用 Linq to Xml，下面是一个完整的例子：

页面.xaml：

```
<UserControl x:Class="SilverlightApplication1.Page"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:data="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls.Data"
    Width="400" Height="300"
    Loaded="Page_Loaded">

    <Grid x:Name="LayoutRoot" Background="White">
        <data:DataGrid x:Name="DataGrid1" />
    </Grid>
</UserControl> 
```

页面.xaml.cs：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Windows;
using System.Windows.Controls;
using System.Xml.Linq;

namespace SilverlightApplication1
{
    public partial class Page : UserControl
    {
        public Page()
        {
            InitializeComponent();
        }

        private void Page_Loaded(object sender, RoutedEventArgs e)
        {
            DataGrid1.ItemsSource = GetStatusReport();
        }

        public List<Status> GetStatusReport()
        {
            List<Status> statusReport = new List<Status>();

            // Get your Xml using XElement.Load(e.Result);
            XElement doc = XElement.Load(@"Data/StatusReport.xml");

            statusReport = (from el in doc.Elements()
                            select GetStatus(el)).ToList();

            return statusReport;
        }

        private Status GetStatus(XElement el)
        {
            Status s = new Status();
            s.Description = el.Attribute("Description").Value;
            s.Date = DateTime.Parse(el.Attribute("Date").Value);
            return s;
        }
    }
} 
```

确保添加对 System.Xml.Linq 程序集的引用。这会生成您正在寻找的输出，其中网格中每一行的状态为“描述”和“日期”作为列。

[替代文字 http://www.freeimagehosting.net/uploads/aa3f9978fc.png](http://www.freeimagehosting.net/uploads/aa3f9978fc.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T21:01:51.597

请查看以下[链接](http://mironabramson.com/blog/post/2008/06/Create-you-own-new-Type-and-use-it-on-run-time-(C).aspx)。

它包含运行代码（在我的环境中），在运行时创建一个具有属性的类。该类用于填充可用作数据网格源的通用 IList<object>。

我在这里发布代码感觉不舒服，因为其中 99.99999% 不是我的。

这些链接将您带到原始帖子，您将在其中找到 Silverlight 工作代码作为我发布的评论。

不久前，我使用值转换器发布了另一种方法：[在 Silverlight 中将 XML 动态绑定到 DataGrid](https://stackoverflow.com/questions/3230742/dynamically-bind-xml-to-datagrid-in-silverlight/3232505#3232505)

# c# - Null in IEnumerable vs IList

> ID：627982
> 
> 赞同：-3
> 
> 时间：2009-03-09T20:49:34.653
> 
> 标签：c#, .net, generics, list-comparison

Why can an IEnumerable = null be passed without error but an IList=Null will not compile?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T20:54:50.070

That's not true. You can set a variable of type IEnumerable or IList to a null reference and it will compile.

There is something else in your code that is wrong.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T20:56:06.993

This works fine:

```
IList<int> Foo() {
    return null;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T20:57:45.133

It's hard to know exactly what you mean. You say a null reference for an IEnumerable can be 'passed without error'. 'Passing' is a runtime thing, but you say with an IList you get a compile error? That sounds confused. You'll need to give us some more info.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T21:03:30.737

Well, with your exact question, it could be because C# is case-sensitive - `null` is a literal, but `Null` isn't. It's hard to say given that you haven't posted any code which could actually compile though.

If that's not the problem in your *real* code, post your real code and we'll see what we can do.

# c# - 无法将 Dictionary ValueCollection 转换为 IEnumerable . 我错过了什么？

> ID：627991
> 
> 赞同：2
> 
> 时间：2009-03-09T20:50:55.417
> 
> 标签：c#, generics, dictionary

```
var _pool = new Dictionary<Type, Dictionary<EntityIdType, Object>>();

public IEnumerable<EntityType> GetItems<EntityType>()
{
    Type myType = typeof(EntityType);

    if (!_pool.ContainsKey(myType))
        return new EntityType[0];

    //does not work, always returns null
    // return _pool[myType].Values; as IEnumerable<EntityType>;

    //hack: cannot cast Values to IEnumarable directly
    List<EntityType> foundItems = new List<EntityType>();
    foreach (EntityType entity in _pool[myType].Values)
    {
        foundItems.Add(entity);
    }
    return foundItems as IEnumerable<EntityType>;

} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-09T20:52:26.393

试试这个：

```
return _pool[myType].Values.Cast<EntityType>(); 
```

这具有在枚举中强制转换每个元素的效果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T20:59:20.480

_pool 被定义为类型`Dictionary<Type, Dictionary<EntityIdType, Object>>`

因此，对类型返回的字典的调用会返回一个`ICollection<Object>`您不能直接转换为的`IEnumerble<EntityType>`.

相反，您必须使用 Cast 扩展方法，如该问题的其他答案所示：

[无法将 Dictionary ValueCollection 强制转换为 IEnumarable<T>。我错过了什么？](https://stackoverflow.com/questions/627991/cannot-cast-dictionary-valuecollection-to-ienumarablet-what-am-i-missing/627999#627999)

# asp.net - 如何将 gridview 列绑定到子类值？

> ID：627996
> 
> 赞同：6
> 
> 时间：2009-03-09T20:51:51.763
> 
> 标签：asp.net, gridview

我有一个正在尝试绑定的 ASP.net gridview。我的 DataSource 有一个集合，我绑定的 2 个列是子类的一部分。我的 DataSource 有一个名为 Staff 的子类，其中包含员工信息。绑定字段 SurveyID 和 NumberOfExceptions 绑定良好，但无法绑定 Staff.Name 和 Staff.Office。

```
asp:BoundField DataField="SurveyID" HeaderText="ID" ...
asp:BoundField DataField="Staff.Name" HeaderText="Name" ...
asp:BoundField DataField="Staff.Office" HeaderText="Office" ...
asp:BoundField DataField="NumberOfExceptions" HeaderText="Exceptions" ... 
```

后面的代码是：

```
uxSurveyGrid.DataSource = searchResults;
uxSurveyGrid.DataBind(); 
```

如果我输入`searchResults[0].Staff.Name`后面的代码，我可以看到值，为什么运行时无法在 gridview 中评估 Staff.Name？

如何将列绑定到子类值？我必须在代码隐藏中做吗？

任何帮助，将不胜感激，

标记。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-09T20:59:14.180

我相信您可以使用模板字段和标记脚本来实现它...

```
 <asp:TemplateField>
        <ItemTemplate>
            <asp:Label Id="lblSubclassVal" runat="server" Text="<%# DataBinder.Eval(Container.DataItem, "SubClass.PropertyName")%>"></asp:Label>
        </ItemTemplate>
    </asp:TemplateField> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-09T20:59:55.753

ASP.NET GridView 背后的数据绑定机制仅支持一级绑定。（与其在绑定到 DataSet / DataTable / DataView 的情况下支持多级的 WinForms 绑定对应物相反）。

您有三种可能的解决方案：

1.  处理每一行的 ItemDataBound 事件
2.  使用公开子对象属性的属性扩展根级别实体并将这些属性用于绑定表达式
3.  您可以使用模板字段并使用访问数据项的 <%= %> 表达式生成内容，而不是使用 BoundField。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T20:55:52.767

标记，

我有 99.9% 的把握，您必须在各个行的 ItemDataBound 事件的代码隐藏中处理这个问题。

请记住，您可以从 e.Item.DataItem 获取整个 databould 对象

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T21:09:58.427

BoundField 不支持 [Name].[Name] 语法。只有简单的属性名称。*****~~*****