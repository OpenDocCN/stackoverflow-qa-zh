# StackOverflow 问答 000928000-000928999

# django - 日期的django过滤器格式

> ID：928011
> 
> 赞同：0
> 
> 时间：2009-05-29T20:34:02.650
> 
> 标签：django, date, format

year_id（2004 等）是模板上的下拉框。用户选择一年，并在视图中检索为 year_id。我需要从名为 grantstartdt 的字段中选择基于年份的出版物，该字段的格式为 2008-01-01。错误是：

int() 参数必须是字符串或数字，而不是“年份”

```
year_id = request.GET['year_id']  
yr = get_object_or_404(Year, pk=year_id) 
projectyr=Researchproject.objects.exclude(activeyesno = 2).filter(grantstartdt__year=yr) 
```

感谢您的任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-29T20:51:17.063

尝试通过`year_id`而不是`yr`在该`filter()`调用中传递：

```
projectyr=Researchproject.objects.exclude(activeyesno = 2).filter(grantstartdt__year=year_id) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T05:09:24.663

那是因为您指的是年份对象而不是实际年份。假设您的 Year 模型有一个名为**xyz**的整数字段。你的代码应该看起来像..

```
year_id = request.GET['year_id']  
yr = get_object_or_404(Year, pk=year_id) 
projectyr=Researchproject.objects.exclude(activeyesno = 2).filter(grantstartdt__year=yr.xyz) 
```

# php - 跨多个页面保留上传的文件

> ID：928012
> 
> 赞同：1
> 
> 时间：2009-05-29T20:34:15.770
> 
> 标签：php

我有一个页面需要接受没有预定义布局的 .csv 文件。也就是说，用户将选择每一列中的数据类型。

现在，上传文件表单将我发送到可以访问上传文件的 .php 脚本。它读取它，并让用户为每一列分配类别。我的下一步是将 .csv 文件中的数据复制到数据库中，但我不确定如何防止文件从临时目录中删除，我仍然需要在下一页进行实际复制. 此外，我对将文件复制到服务器上的其他位置不感兴趣，这似乎是一种浪费，并且在允许并发的同时正确执行会很麻烦。

如何防止文件被删除，或者，有什么更好的解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-29T20:48:03.717

好吧，如果不移动上传的文件，我不确定这是否可以维护。

就个人而言，我会这样实现它：

在接收上传文件的页面上：

```
//assuming it hasn't already been started...
session_start();

//generate a unique filepath
$filepath = PATH_TO_THE_DIR . "/" . time() . 
"_" . md5_file($_FILES['formelement']['tmp_name']) . ".csv";

//move the uploaded file
move_uploaded_file($_FILES['formelement']['tmp_name'], $filepath);

//do whatever you need with the file, now at $filepath

//now store the filepath in the session:
$_SESSION['uploaded_filepath'] = $filepath;

session_write_close(); 
```

在第二页上，当您想要进行更多处理时：

```
//assuming it hasn't already been started...
session_start();

$filepath = $_SESSION['uploaded_filepath'];

// do whatever you need to with the file

unlink($filepath);

unset($_SESSION['uploaded_filepath']);

session_write_close(); 
```

那应该没问题 - 显然您需要检查 PATH_TO_THE_DIR 常量的权限，这只是某个地方的目录。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-29T20:38:36.183

你需要使用[`move_uploaded_file`](http://www.php.net/move_uploaded_file). 确实没有办法将其复制到其他位置。你也不应该担心它，因为这样的事情对于任何文件系统都不是问题。至于并发性，我看不出你会遇到什么问题。数以百万计的 PHP 应用程序运行良好 :-)

# cocoa - 单击时不会弹出自定义单元格内的 NSPopUpButtonCell

> ID：928014
> 
> 赞同：1
> 
> 时间：2009-05-29T20:34:42.463
> 
> 标签：cocoa, custom-controls, nspopupbuttoncell, custom-cell

我创建了一个自定义的 NSCell 子类，其中包含一个 NSImageCell、一些 NSTextFieldCells 和一个 NSPopUpButtonCell。

我正在使用以下方法初始化弹出单元格：

```
 myPopUpCell = [[NSPopUpButtonCell alloc] init];
    [myPopUpCell setBordered:NO];
    [myPopUpCell setAutoenablesItems:NO];
    [myPopUpCell addItemsWithTitles:[NSArray arrayWithObjects:@"Item1", @"Item2", @"Item3"]]; 
```

并把它画进去`drawInteriorWithFrame:inView:`

一切似乎都很好，除了在运行我的应用程序时单击弹出单元格时，单元格不会弹出。关于可能出错的任何建议？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-29T22:22:01.280

绘制弹出按钮单元格`drawInteriorWithFrame:inView:`就是这样做的；画它，但没有别的。处理点击事件与绘图无关，因此您必须在自定义单元格中做一些工作来解释鼠标事件，如果它们在您用于弹出按钮的框架内，请将它们传递给到纽扣电池。从跟踪鼠标下的 NSCell 文档中列出的方法开始子类化，例如`–trackMouse:inRect:ofView:untilMouseUp:`，您应该能够弄清楚使纽扣电池正确动作所需的方法。

根据您正在做的事情，您实际上可能会发现自己绘制标题字符串更容易，并且只需使用 NSMenu 的`+popUpContextMenu:withEvent:forView:`.

# java - 是否有与 java.util.concurrent.Executor 等效的 .Net？

> ID：928018
> 
> 赞同：12
> 
> 时间：2009-05-29T20:35:26.020
> 
> 标签：java, .net, multithreading, concurrency, ccr

有一组长时间运行的离散任务：从文本文件中解析成千上万行、水合为对象、操作和持久化。

如果我在 Java 中实现它，我想我可能会为文件中的每一行或每 X 行（即块）中的任务添加一个新任务到 Executor。

对于我正在使用的.Net，我不太确定。我怀疑 CCR 在这里可能是合适的，但我对它不够熟悉，这就是我提出这个问题的原因。

CCR 能否以与 Java Executors 等效的方式运行，或者还有其他可用的功能吗？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-29T20:49:23.680

您可能想查看[Task Parallel Library](https://msdn.microsoft.com/en-us/library/dd460717(v=vs.110).aspx)。

`async`从 C# 5 开始，这是使用and`await`关键字内置到语言中的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-29T20:49:33.277

也许这是相关的：[设计：探索的任务并行库](http://blogs.msdn.com/salvapatuel/archive/2007/11/11/task-parallel-library-explored.aspx)。请参阅[第 10-4 集第 6 集：并行扩展](http://channel9.msdn.com/shows/10-4/10-4-Episode-6-Parallel-Extensions/)作为快速介绍。

对于较旧的基于线程的方法，可以使用[ThreadPool](http://msdn.microsoft.com/en-us/library/system.threading.threadpool.aspx)进行池化。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-29T21:00:48.743

如果你要问一大群 .NET 人员，什么最接近等同于 Java Executors，描述 Java Executors 的显着特征可能没有什么坏处。知道你答案的人可能并不像你对 .NET 那样熟悉 Java。

也就是说，如果已经提到的任务并行库对您的需求来说太过分了，或者您不想等待 .NET 4.0，那么[ThreadPool.QueueUserWorkItem()](http://msdn.microsoft.com/en-us/library/system.threading.threadpool.queueuserworkitem.aspx)可能就是您要寻找的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-29T20:49:23.073

BackgroundWorker 类可能是您正在寻找的。顾名思义，它允许您运行后台任务、自动管理池和状态更新事件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-06-16T18:36:27.870

对于任何寻求更现代解决方案的人（就像我一样），请查看[EventLoopScheduler](http://www.introtorx.com/Content/v1.0.10621.0/15_SchedulingAndThreading.html#EventLoopScheduler)类。

# user-interface - 如何为 bash 脚本制作 GUI？

> ID：928019
> 
> 赞同：72
> 
> 时间：2009-05-29T20:35:37.157
> 
> 标签：user-interface, bash, gtk, tcl, tk

我想为我的脚本制作一些图形对话框，但不知道如何。我听说了一些关于 GTK-Server 或类似的东西。如果有人知道如何将 Bash 与 tcl/tk 联系起来，我也很满意。

请不要发布诸如“更改为 C++”之类的内容，因为我的项目必须是 Bash 中的脚本；没有其他选择。

有任何想法吗？

**编辑：** 感谢您的回答，但我不想要控制台中颜色的“图形”，而是我可以移动、最小化等的图形窗口。我会测试`xmessage`，但我认为这不会是我正在寻找的.

**编辑2：** 我不想做一个简单的对话框，比如是/否，而是一些界面，比如进度条和按钮，比如游戏。

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2009-05-29T20:54:05.700

在实际使用 GUI 对话之前，请考虑使用控制台提示。很多时候，你可以用简单的“y/n?”侥幸逃脱？提示，在 bash 中您可以通过[`read`命令](http://www.manpagez.com/man/2/read/)..

```
read -p "Do something? ";
if [ $REPLY == "y" ]; then
    echo yay;
fi 
```

如果控制台提示只是不会削减它，[Zenity](http://freshmeat.net/projects/zenity)真的很[容易使用](http://library.gnome.org/users/zenity/stable/)，例如：

```
 zenity --error --text="Testing..."
      zenity --question --text="Continue?" 
```

这仅适用于 Linux/Gnome（或者更确切地说，它只会默认安装在此类系统上）。该`read`方法几乎适用于任何平台（包括无头机器或通过 SSH）

如果您需要比 read 或 Zenity 提供的更复杂的东西，“更改为 C++”确实是最好的方法（尽管对于此类 shell-script-replacement 任务，我建议使用 Python/Ruby 而不是 C++）

> 我想为一些奇怪的游戏做简单的界面，健康的进度条之类的就是我想要的例子。变量“HEALTH”是 34，所以让进度条填写 34/100

作为命令行脚本，它将使用 Python：

```
$ export HEALTH=34
$ python -c "import os; print '*' * int(os.environ.get('HEALTH', 0))"
********************************** 
```

或者规范化 1 到 78 之间的值（这样你就不会在标准终端大小上换行）：

```
$ python -c "import os; print '*' * int((int(os.environ.get('HEALTH', 0)) / 100.0) * 78)" 
```

Zenity 还有一个[进度对话框](https://help.gnome.org/users/zenity/stable/progress.html.en)，

```
#!/bin/sh
(
echo "10" ; sleep 1
echo "# Updating mail logs" ; sleep 1
echo "20" ; sleep 1
echo "# Resetting cron jobs" ; sleep 1
echo "50" ; sleep 1
echo "This line will just be ignored" ; sleep 1
echo "75" ; sleep 1
echo "# Rebooting system" ; sleep 1
echo "100" ; sleep 1
) |
zenity --progress \
  --title="Update System Logs" \
  --text="Scanning mail logs..." \
  --percentage=0

if [ "$?" = -1 ] ; then
        zenity --error \
          --text="Update canceled."
fi 
```

正如我之前所说，如果 Zenity 无法满足您的需求，请考虑将您的游戏内容编写为 Python/Ruby/Perl/C++/etc 中的“适当”脚本，因为这听起来像是在突破外壳的界限-脚本可以做..

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-05-29T21:07:57.747

如果您想在 bash 中编写图形 UI，[那么 zenity](https://help.gnome.org/users/zenity/)是您的最佳选择。这是你可以用它做的：

```
Application Options:
  --calendar                                     Display calendar dialog
  --entry                                        Display text entry dialog
  --error                                        Display error dialog
  --info                                         Display info dialog
  --file-selection                               Display file selection dialog
  --list                                         Display list dialog
  --notification                                 Display notification
  --progress                                     Display progress indication dialog
  --question                                     Display question dialog
  --warning                                      Display warning dialog
  --scale                                        Display scale dialog
  --text-info                                    Display text information dialog 
```

结合这些小部件，您可以创建非常有用的 GUI。当然，它不如集成到编程语言中的工具包灵活，但在某些情况下它确实很有用。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-05-29T20:44:34.753

有一个`dialog`使用 ncurses 库的命令。“ *Dialog 是一个程序，可让您使用 shell 脚本中的对话框提出各种问题或显示消息。实现了这些类型的对话框（尽管并非所有都必须编译成对话框）* ”

见[http://pwet.fr/man/linux/commandes/dialog](http://pwet.fr/man/linux/commandes/dialog)

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-05-29T20:46:13.173

好吧，如果您可以在您的环境中使用 Tcl/Tk，您可能应该编写一个 TCL 脚本并使用它。你也可以看看[wish](http://wiki.tcl.tk/2364)。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2009-05-29T20:52:31.367

您可以使用基于[ncurses的](http://invisible-island.net/ncurses/ncurses.html)[对话](http://invisible-island.net/dialog/)或基于[俚语](http://www.jedsoft.org/slang)的[whiptail](http://nixdoc.net/man-pages/Linux/whiptail.1.html)。

我认为两者都有 GTK 或 Tcl/Tk 绑定。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-05-30T06:25:50.067

您可以为此使用[gtk-server](http://www.gtk-server.org/)。Gtk-server 是一个在后台运行的程序，它提供基于文本的界面以允许其他程序（包括 bash 脚本）对其进行控制。它有 Bash 的示例（[http://www.gtk-server.org/demo-ipc.bash.txt](http://www.gtk-server.org/demo-ipc.bash.txt)，[http://www.gtk-server.org/demo-fifo.bash.txt](http://www.gtk-server.org/demo-fifo.bash.txt)）

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2010-05-27T06:50:11.653

请看看我的图书馆： [http ://sites.google.com/site/easybashgui](http://sites.google.com/site/easybashgui)

它旨在使用相同的命令集来处理所有四个大工具“kdialog”、“Xdialog”、“cdialog”和“zenity”，这取决于 X 是否正在运行，DE 是 KDE 还是 Gnome 或其他。有 15 种不同的功能（其中有两个称为“进度”和“调整”）...

再见 ：-）

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-05-29T21:03:58.753

如果你安装了 Qt/KDE，你可以使用[kdialog](http://techbase.kde.org/Development/Tutorials/Shell_Scripting_with_KDE_Dialogs)，它会弹出一个 Qt 对话窗口。您可以轻松地指定显示是/否对话框、确定/取消、简单文本输入、密码输入等。然后您可以在 shell 中访问这些对话框的返回值。

# web-services - .NET Web 服务的 WSDL 中的 URL 不正确的问题

> ID：928021
> 
> 赞同：1
> 
> 时间：2009-05-29T20:37:29.243
> 
> 标签：web-services, iis, asmx

我们在客户端的服务器上安装了一个 ASP.NET 网站。该站点有一个 Web 服务，其中包含几个由 Flash 对象调用以显示新闻提要的 Web 方法。如果您浏览到他们的网站（例如：www.domain.com），一切正常，除了闪存。

问题是当我们浏览到 .asmx 时，标头显示主机是其网络内部的子域 (internal.domain.com)。显然，当从网络外部浏览时，这不会解析为任何公共 IP。这会导致 Flash 失败，因为 Flash 对象嵌入在页面上，因此正在客户端运行。

我检查了有问题的服务器上的计算机名称，它甚至与“internal.domain.com”不匹配——这是完全不同的东西。它从哪里得到这些信息。它不是来自 IIS，因为我们没有设置主机头，并且站点的 IP 设置为（全部未分配）。

我们需要强制 Web 服务针对特定主机运行，或者我们需要更改服务器上的某些内容，以便它解析为有效的面向公众的主机名。非常感谢任何和所有帮助！！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T21:30:43.407

解决方案是为 www.domain.com 添加主机头

[更多细节在这里](http://forums.asp.net/p/1096811/1659596.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-29T22:21:35.633

虽然您可能已经这样做了，但这始终是一个很好的第一步：

在 Flash 对象和 Web 服务的源代码中对有问题的字符串进行全局查找。

听起来有人可能已将 internal.domain.com 字符串配置/编码到 Flash 对象的请求中。（主机：是 HTTP 请求标头，而不是响应标头，IIRC。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-29T22:27:22.110

Flash 对象是否从 C# 代码中获取 Web 服务 URL？如果是这样，它可能会获取您在 VS 中向项目添加 Web 引用时选择的默认 Web 服务 URL。因此，它可能指向开发人员机器/服务器的本地 URL，而该 URL 在实时服务器上无法识别。

# ruby-on-rails - RoR表继承？

> ID：928036
> 
> 赞同：2
> 
> 时间：2009-05-29T20:40:22.500
> 
> 标签：ruby-on-rails, database, inheritance, activerecord

**场景**：我的应用程序中有一个用户表。我还有两个用户子类，比如说贡献者和观众。每个用户组必须具有一组完全不同的属性，但它们都共享某些用户属性（登录名、密码、名称）。

使用 Ruby on Rails 实现这一点的最佳方法是什么？

*   我认为单表继承会给我留下太多空字段。
*   我认为链接三个表（用户、查看者、贡献者）可以正常工作，但是当我想编辑任何我必须做的信息时：`@user.viewer`虽然我很想能够做到`@viewer`。

关于最佳解决方案的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-29T21:42:11.687

我可能会采用三表方法。数据完整性是代码清洁度的王者。

如果您想让它看起来更整洁，请将虚拟属性放在 Viewer 和 Contributor 模型上，使其看起来像 User 属性是本地的。您可以将其作为一个模块并将其包含在 Viewer 和 Contributor 模型中。

您还可以在默认查找器上设置 :include => :user ，以便在使用这些字段时不会收到额外的查询。

我现在非常喝咖啡，所以如果这没有意义，请回复:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-29T20:44:40.227

不要损害数据库架构，使其最适合。我喜欢三表法。如果数据库做得不好，应用程序以后将很难修复问题，运行缓慢等。

# parsing - 解析非常大的日志文件（>1Gb，<5Gb）

> ID：928040
> 
> 赞同：4
> 
> 时间：2009-05-29T20:41:39.093
> 
> 标签：parsing, text, logging

我需要解析非常大的日志文件（>1Gb，<5Gb）——实际上我需要将数据剥离到对象中，以便将它们存储在数据库中。日志文件是连续的（没有换行符），例如：

TIMESTAMP=20090101000000;PARAM1=Value11;PARAM2=Value21;PARAM3=Value31;TIMESTAMP=20090101000100;PARAM1=Value11;PARAM2=Value21;PARAM3=Value31;TIMESTAMP=20090101000152;PARAM1=Value11;PARAM2;=Value21;PARAM3Value=。 .

我需要将其剥离到表格中：

时间戳 | 参数1 | 参数2 | 参数 3

该过程需要尽可能快。我正在考虑使用 Perl，但任何使用 C/C++ 的建议都会受到欢迎。有任何想法吗？

此致，

亚瑟

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-29T20:47:53.873

用 Perl 编写一个原型，并将其性能与从存储介质中读取数据的速度进行比较。我的猜测是您将受到 I/O 限制，这意味着使用 C 不会提供性能提升。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-29T23:21:18.320

这个关于使用 Python 生成器的演示让我大吃一惊： [http ://www.dabeaz.com/generators-uk/](http://www.dabeaz.com/generators-uk/)

David M. Beazley 通过基本上为每个处理步骤定义一个生成器，展示了如何处理数 GB 的日志文件。然后生成器相互“插入”，直到您拥有一些简单的实用功能

```
lines = lines_from_dir("access-log*","www")
log   = apache_log(lines)
for r in log:
    print r 
```

然后可以用于各种查询：

```
stat404 = set(r['request'] for r in log
                if r['status'] == 404)

large = (r for r in log
           if r['bytes'] > 1000000)
for r in large:
    print r['request'], r['bytes'] 
```

他还表明，性能与 grep、find 等标准 unix 工具的性能相当。当然这是 Python，与 perl 或 awk 脚本相比，它更容易理解，最重要的是更容易定制或适应不同的问题集。

（上面的代码示例是从演示幻灯片中复制的。）

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-29T20:47:47.430

[Lex](http://en.wikipedia.org/wiki/Lex_programming_tool)处理这类事情的能力惊人地好。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-29T21:04:38.690

关键不是语言，因为问题是 I/O 绑定的，所以选择你觉得最舒服的语言。

关键是它是如何编码的。只要您不将整个文件加载到内存中就可以了-一次加载块，一次保存数据块，这样效率会更高。

Java 有一个 PushbackInputStream 可以使这更容易编码。这个想法是您猜测要读取多少，如果您读取的太少，则将数据推回，并读取更大的块。

然后当你读得太多时，处理数据，然后推回剩余的位，继续循环的下一次迭代。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-29T21:44:18.750

像这样的东西应该工作。

```
use strict;
use warnings;

my $filename = shift @ARGV;

open my $io, '<', $filename or die "Can't open $filename";

my ($match_buf, $read_buf, $count);

while (($count = sysread($io, $read_buf, 1024, 0)) != 0) {
    $match_buf .= $read_buf;
    while ($match_buf =~ s{TIMESTAMP=(\d{14});PARAM1=([^;]+);PARAM2=([^;]+);PARAM3=([^;]+);}{}) {
        my ($timestamp, @params) = ($1, $2, $3, $4);
        print $timestamp ."\n";
        last unless $timestamp;
    }
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-29T21:01:50.507

但实际上，使用 AWK。即使与 Perl 等相比，它的性能也不错。当然 Map/Reduce 可以很好地工作，但是将文件拆分为适当的块的开销呢？

试试 AWK

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-29T22:23:17.767

这在 Perl、Awk 或 C 中很容易处理。下面是一个 C 版本的开始：

```
#include <stdio.h>
#include <err.h>

int
main(int argc, char **argv)
{
        const char      *filename = "noeol.txt";
        FILE            *f;
        char            buffer[1024], *s, *p;
        char            line[1024];
        size_t          n;
        if ((f = fopen(filename, "r")) == NULL)
                err(1, "cannot open %s", filename);
        while (!feof(f)) {
                n = fread(buffer, 1, sizeof buffer, f);
                if (n == 0)
                       if (ferror(f))
                               err(1, "error reading %s", filename);
                       else
                               continue;
                for (s = p = buffer; p - buffer < n; p++) {
                        if (*p == ';') {
                                *p = '\0';
                                strncpy(line, s, p-s+1);
                                s = p + 1;
                                if (strncmp("TIMESTAMP", line, 9) != 0)
                                        printf("\t");
                                printf("%s\n", line);
                        }
                }
        }
        fclose(f);
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-30T10:19:29.427

听起来像是一份工作[`sed`](http://en.wikipedia.org/wiki/Sed)：

```
sed -e 's/;\?[A-Z0-9]*=/|/g' -e 's/\(^\|\)\|\(;$\)//g' < input > output 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-29T22:28:58.443

我知道这是一种异国语言，可能不是最好的解决方案，但是当我有临时数据时，我会考虑使用[PADS](http://www.padsproj.org/)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-29T20:54:49.473

您可能想看看 Hadoop (java) 或 Hadoop Streaming（使用任何可执行文件或脚本运行 Map/Reduce 作业）。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-29T21:03:33.997

如果您编写自己的解决方案，您可能会受益于从文件中读取更大的数据块并分批处理它们（而不是使用，比如说，`readline()`）并寻找标记每行末尾的换行符。使用这种方法，您需要注意您可能没有检索到最后一行的全部内容，因此需要一些逻辑来处理它。

我不知道你会意识到什么性能优势，因为我没有测试过它，但我已经成功地利用了类似的技术。

# .net - F#（夏普）将如何使用？

> ID：928042
> 
> 赞同：27
> 
> 时间：2009-05-29T20:42:51.167
> 
> 标签：.net, f#

我在放置 Microsoft 将要引入的 F# 语言的概念和可能性时遇到了麻烦。

**F# 将仅用于声明函数吗？还是将 F# 与普通的 C# 或 VB 代码混合在一起，“完全”用 F# 编写应用程序？**

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-05-29T21:06:57.173

我强烈建议您观看 Luca Bolognese 在 PDC 2008 上的演讲。这不仅非常有趣，而且他还展示了令人印象深刻的 F# 用例：

> [](http://channel9.msdn.com/pdc2008/TL11/)**Luca Bolognese[**的 Microsoft F# 简介**](http://channel9.msdn.com/pdc2008/TL11/)**

 *** * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-05-29T20:57:58.813

我的期望是 F# 将用于*一些*专门系统的部分——涉及复杂线程/数学/财务/建模等的位，而 F# 做得很好。对于大多数其他领域（UI、DAL 等），像 C# 这样的通用语言似乎 (IMO) 更可取。

F# 的优点之一是（理论上）您可以*证明*代码是有效的，而不仅仅是测试它。线程支持（由于不变性和异步！使用）也很好（尽管 PLINQ 可能会在线程上竞争）。

连接到 .NET 以允许在 F#、C#、VB、IronPython、IronRuby 等之间进行适当的集成 - 真正展示了它们各自的优势。*今天*，如果我在做很多 COM 互操作，我会考虑 VB（在 4.0 中会改变`dynamic`）；对于大多数代码 - C#。对于数学等，F#。整齐的。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-30T02:27:22.737

我已经用了半年了，我认为它会成为一种通用语言。学习起来相当复杂，因此怀疑它会在混合环境中使用太多。管理人员希望将成本控制在最低限度。

*   **重构速度对我来说是 F# 最大的卖点**。用它构建了一个简单的[视频游戏](http://gradbot.blogspot.com/)后，我爱上了语言结构。起初，处理状态引擎的想法在函数式语言中似乎不合适，但是对于记录、元组和类型推断，它可以实现非常快速的更改。

*   **F# 具有良好的可读性**。一旦你熟悉了 F#，如果你允许混合多范式编程风格，代码就会变得非常简洁和易于阅读，但是就像所有语言一样，不知道自己在做什么的人可能会把它变成一场噩梦。

我的日常工作涉及 Web 原型设计，因此我期待看到[FSharp.WebTools的发展方向，并期待看到](http://www.codeplex.com/fswebtools)[Microsoft MVC](http://msdn.microsoft.com/en-us/magazine/cc337884.aspx)对 F# 的更多支持。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-06-02T17:20:03.197

我在以下领域使用 F#：

**DLL 和库**。我在空闲时间编写的几乎所有新代码都是 F#，我只在需要快速 GUI 时才使用 C#。

**多线程**。在工作中，我一直在慢慢介绍 F#。我有机会通过使用异步工作流和邮箱处理器将一些丑陋的单线程 VB.NET 移动到多线程 F# 来演示它可以做什么。

**DSL 和解析**。在我上一家公司，我使用 FsLex/FsYacc 将[SQL 解析为 AST](https://stackoverflow.com/questions/381685/non-numerical-use-cases-for-functional-programming/381991#381991)。原型代码的一个变体进入了[本教程](http://en.wikibooks.org/wiki/F_Sharp_Programming/Lexing_and_Parsing)。

**脚本**。我完全 <3 使用 .fsx 文件编写脚本。它们是编写小脚本的便捷方式，无需编写完整的可执行文件。修改源代码并在不停机的情况下再次运行它也很不错。我已经修改了 .fsx 文件的默认行为以运行 fsi 而不是在双击它们时在 VS 中打开。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-02T06:37:59.707

您的问题意味着所有代码最终都会成为应用程序。

但这不一定是这种情况，F# 的优势之一（例如，与 C# 相比）是您可以“突破”您最喜欢的 IDE 并只运行一些代码，而无需所有解决方案/项目/类基础架构.

对于数字运算测试结果、转换数据、测试新算法（即使我最终在“应用程序”中使用 C# 对其进行编码）、对日志文件进行排序，甚至创建一个小实用程序来告诉我有多少 C# 参考实际上是在给定的程序集中使用的，如果我决定进一步使用它，F# 很漂亮、快速，但可以快速“缩放”到一个 dll。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-29T20:48:59.970

当然，用 F# 编写整个程序是可行的。但是，我认为大多数程序不会这样。F# 很可能用于复杂的算法和应用程序逻辑（程序的核心），而 C# 可能用于“外部”（GUI 等）。.NET 是命令式结构，因此在您大量使用库的地方，C# 可能比 F# 更“自然”。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-29T20:46:05.543

根据上下文，您可以同时考虑两者。

您可以使用 F# 构建完整的 .NET 应用程序或将其连接到其他 .NET 语言。它可以使用和公开来自/向其他 .NET 语言的库。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-08-03T22:08:57.137

> F# 将仅用于声明函数吗？还是将 F# 与普通的 C# 或 VB 代码混合在一起，“完全”用 F# 编写应用程序？

3 年多来，我们一直在用 F# 编写整个应用程序。许多公司都在使用 F# 扩充他们现有的代码库。

F# 最简单的切入点是交付 F# 示例，演示如何从 F# 使用您销售的库的 API。这对任何公司来说都是显而易见的，因为样品不是关键任务，因此技术专业知识和持续维护不是问题。F# 也是为任何 .NET 语言的现有代码编写测试工具的绝佳工具。同样，客户永远不会获得该代码，因此它在您公司之外的可靠性不是问题。在实践中，我们毫无问题地全力以赴，在任何地方使用 F#，并在客户不知情的情况下将其交付给客户。这对小公司特别有效，因为生产力的大幅提高给我们带来了巨大的竞争优势。

# svn - 将 NT Auth 与 CruiseControl 和 Subversion 一起使用

> ID：928044
> 
> 赞同：1
> 
> 时间：2009-05-29T20:43:45.953
> 
> 标签：svn, cruisecontrol.net

我试图让我的 ccnet.config 文件中的源代码控制块访问 SVN，而不传递凭据。相反，我希望使用在 ccnet 服务中配置的用户。

所以，我只是没有在源代码控制块中包含用户名和密码标签，认为它会起作用。

它没有，而是我得到了错误：

> 源代码控制操作失败：svn：' [http](http://xxx.xxx.com:8888/svn/SourceCode/Trunk) ://xxx.xxx.com:8888/svn/SourceCode/Trunk '的选项：授权失败（[http://xxx.xxx.com:8888](http://xxx.xxx.com:8888)）

如果我随后将用户名和密码标签放入源代码控制块中，并使用为服务配置的完全相同的凭据，那么它就可以正常工作。

难道我做错了什么？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-29T20:53:16.403

您需要以该用户身份登录该框（或使用 svn 客户端执行 RunAs）并执行 svn update 或其他 svn 操作以使 SVN 提示您输入该存储库的凭据。当系统提示您时，告诉 SVN 缓存凭据。

# linq-to-sql - LINQ 对象持久性

> ID：928046
> 
> 赞同：1
> 
> 时间：2009-05-29T20:44:35.813
> 
> 标签：linq-to-sql

在此处使用以下代码

```
Sub FooSub
Dim db As New FooDataContext
Dim u = From p In db.FooTable Where p.FooColumn = FooData Select p

Do Stuff
End Sub 
```

如果我希望它保留在应用程序中，是否必须手动创建一个类来映射 FooTable 中的数据？如果我将 u 声明为类范围的变量，那么一旦 SubFoo 结束，我将无法再访问 u 中的数据

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-29T20:50:19.670

实际上，`u`只会`IQueryable<typeof(p)>`。在您尝试迭代该集合之前，数据库甚至不会被命中。

如果您希望在 DataContext 连接关闭后使用某些对象，则需要`u.ToList`在关闭连接之前调用以获取结果列表。

从那里，您可以随意更改对象本身。如果您希望更改保留回数据库，请调用`db.SubmitChanges`

# c# - 是否有将“YYYYMMDDHHMMSS.UUUUUU-TZO”格式转换为 C# DateTime 的 API？

> ID：928051
> 
> 赞同：2
> 
> 时间：2009-05-29T20:45:20.273
> 
> 标签：c#, string, datetime, type-conversion

示例：“20080807144334.410187-180”（-180 表示格林威治标准时间减去三个小时。在这种情况下为里约热内卢。）

当我通过 WMI 查询文件创建/更改/访问时间时，将返回该字符串格式（这并不完全有效；请参见[此处](https://stackoverflow.com/questions/927767/wmi-query-on-cmidatafile-class-yields-invalid-query-if-it-has-where-c)）。我想我可以用白痴的方式解析它，从字符串位置提取年、月等。但我不想重新发明轮子。System.DateTime 的构造函数不处理该格式。我应该继续以白痴的方式去做还是有更好的方法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-29T20:49:09.453

您应该能够使用[`DateTime.ParseExact`](http://msdn.microsoft.com/en-us/library/system.datetime.parseexact.aspx)或[`.TryParseExact`](http://msdn.microsoft.com/en-us/library/system.datetime.tryparseexact.aspx)为其提供解析时使用的特定格式。

但是，我认为您不能让它以这种格式读取您的时区（尽管我实际上无法弄清楚如何让它以任何格式读取时区）。

其余部分如下所示：

```
DateTime.ParseExact("20080807144334.410187", "yyyyMMddHHmmss.ffffff", System.Globalization.CultureInfo.InvariantCulture) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-29T20:50:16.970

您应该看一下 DateTime.TryParseExact 方法。它会让你传递你要转换的格式。

[http://msdn.microsoft.com/en-us/library/system.datetime.tryparseexact.aspx](http://msdn.microsoft.com/en-us/library/system.datetime.tryparseexact.aspx)

# asp.net-mvc - ASP.NET MVC切换语言，如何实现？

> ID：928053
> 
> 赞同：21
> 
> 时间：2009-05-29T20:45:34.733
> 
> 标签：asp.net-mvc, asp.net-mvc-routing

我已经开始将我的简单网站转换为 ASP.NET MVC，只是为了弄乱它。我在那里有一个切换语言功能，基本上将 Session["language"] 设置为另一种语言并刷新页面。如果这可以做得更好，请纠正我，但我为此制作了两个控制器并在那里设置会话。问题是最后的路由。我可以以某种简洁的方式刷新页面，还是可以获取当前操作并将其重新路由到该操作？或者这更像是 Ajax 的一个场景？

感谢您的建议！

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-29T22:35:22.673

您使用会话变量有什么原因吗？更常见的解决方案是在路由中包含语言代码，即 blah.com/en/info 或 blah.com/jp/info（用于英语和日语）

如果您这样做，网站上的每个页面都可能包含指向每种语言的链接。如果您正在编写一个可公开访问的网站，这也将使谷歌更容易索引您的所有内容。

本文解释了如何在域中包含语言，即。[en.blah.com](http://blog.maartenballiauw.be/post/2009/05/20/ASPNET-MVC-Domain-Routing.aspx)或 jp.blah.com：http://blog.maartenballiauw.be/post/2009/05/20/ASPNET-MVC-Domain-Routing.aspx

更新：这是一个在 URL 路由中包含语言代码的*简单*示例。

更改默认路由以包含语言参数：

```
routes.MapRoute(
"Default", 
"{language}/{controller}/{action}/{id}", 
new { language = "en", controller = "Home", action = "Index", id = "" }
); 
```

将每种语言的链接添加到您的母版页：

```
<li><%= Html.ActionLink(
    "Spanish", 
    ViewContext.RouteData.Values["action"].ToString(), 
    new { language = "es" })%></li>
<li><%= Html.ActionLink(
    "French", 
    ViewContext.RouteData.Values["action"].ToString(), 
    new { language = "fr" })%></li>
<li><%= Html.ActionLink(
    "English", 
    ViewContext.RouteData.Values["action"].ToString(), 
    new { language = "en" })%></li> 
```

这些将呈现为返回您所在页面的链接 - 仅更改语言。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-30T18:59:24.303

以下方法对我有用：

我正在使用 cookie 和我自己的本地化引擎所有您需要在页面上放置一些链接，该链接将重定向到以下内容：

```
public class LanguageController : Controller
{
    //
    // GET: /Language/

    public void Change(string id)
    {
        var cuka = new HttpCookie("lang", id + "");
        cuka.Expires = DateTime.Now.AddYears(10);
        System.Web.HttpContext.Current.Response.Cookies.Add(cuka);

        if (Request.UrlReferrer.IsNotNull())
            Response.Redirect(Request.UrlReferrer.AbsoluteUri);
        else
            Response.Redirect("/");
    }

} 
```

}

如果你对这个引擎感兴趣，请告诉我。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-06-19T22:27:35.657

有一个语言管理控制器

```
 public class LocalesController : Controller
{

    public ActionResult Index(string lang = "en_US")
    {
        Response.Cookies["CacheLang"].Value = lang;

        if (Request.UrlReferrer != null)
            Response.Redirect(Request.UrlReferrer.ToString());

        var message = Localization.Get("changedlng");

        return Content(message);
    }

} 
```

你可以单独调用它

```
new LocalesController().Index("fa"); 
```

# c# - 静态类...可以这样做吗？

> ID：928055
> 
> 赞同：1
> 
> 时间：2009-05-29T20:46:03.937
> 
> 标签：c#, class, static

我阅读了何时在 C# 中使用静态类，但最佳答案不一定能回答我的问题。我有一个应用程序，它通过 HTTP 服务器与相当多的类似硬件接口。每个设备都必须登录，并且凭据通常相同。我正在使用 Properties.Settings.Default.etc 来处理应用程序范围的设置；但是，为方便起见，我会在单独登录设备时跟踪上次使用的用户名/密码。可以通过选项窗口设置的默认值首先使用并且保持不变，除非通过选项窗口进行更改，尽管临时设置发生了变化并在默认值中使用。

无论如何，这就是场景......关于这个问题，我正在这样做：

```
private static class TemporarySettings
{
    public static string Username = Properties.Settings.Default["Username"].ToString();
    public static string Password = Properties.Settings.Default["Password"].ToString();
} 
```

那是愚蠢的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-29T21:00:05.267

它并不愚蠢，它可能会完美地解决您的问题（如果确实如此，请不要更改它）。但是，这种方法可能会导致一些问题，这有助于了解这些问题是什么。

1.  如果您想在不重新启动应用程序的情况下更改用户名和密码，您将没有该选项。您可以编写逻辑来观察配置文件的变化，并在它们发生变化时重新加载值。
2.  如果您想为多组用户名和密码“重用”您的代码（尤其是如果您放置更多行为，例如监控更改），您需要将其转换为实例。
3.  如果您想要对依赖于此类的类进行单元测试，那么您将很难对这些值进行存根。

*不过，重申一下，您不应该因为这些潜在*问题而回避最简单的解决方案（如您所定义的），除非您认为将来很有可能会被它们烧毁。否则，稍后在需要时切换到实例类可能不会是一个非常困难的重构。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-29T20:57:13.697

更好的是，标记它们`readonly`或使用只有吸气剂的属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-29T20:50:49.403

您将用户名和密码设置为相同的值，但除此之外，否。

# visual-studio - VS插件可以将代码注入编译过程吗？

> ID：928063
> 
> 赞同：0
> 
> 时间：2009-05-29T20:47:20.520
> 
> 标签：visual-studio, debugging, plugins

我在概念上设计一个我想在这里拥有的插件。我想要的是能够在我的代码中标记行（类似于如何添加断点），然后获取执行通过它们运行的​​时间的跟踪日志。而不是设置断点（因为它们在调试器之外不起作用），我宁愿在编译器内部添加额外的日志记录以便 AST。

要点是比较程序的不同运行；如果我做 A，它会崩溃，但如果我做 B，它不会崩溃，并且大部分代码应该是相同的，那么它在哪里发散？

现在我正在使用文件 IO 和差异工具来执行此操作；它有效，但有点笨拙。

我想问题是：*这可以做到吗？有这样的事情吗？*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T07:26:42.503

我不知道有什么完全符合你的描述的。然而...

对于仅供调试使用，Visual Studio 2010 具有“跟踪点”。这些以与断点相同的方式添加，但不是停止程序，而是将一些文本输出到调试输出。因为它们是在调试器中设置的，所以它们根本不会影响您的源代码。

如果您想跟踪发布版本中的活动，只需将 System.Diagnostic.Trace.WriteLine() 调用添加到您的代码中。这些可以使用 TraceSwitches 进行控制，因此默认情况下可以禁用它们，只有在您需要额外信息来诊断问题时才打开它们。与 Debug.WriteLine() 调用不同，它们（默认情况下）包含在发布版本和调试版本中。请注意，即使禁用了跟踪开关，这些跟踪调用也会产生少量开销，因此请避免在代码的性能关键区域使用它们。

# tfs - 是否可以更改 TFS 团队项目使用的流程模板？

> ID：928068
> 
> 赞同：4
> 
> 时间：2009-05-29T20:48:30.563
> 
> 标签：tfs

我们一直在开发新的 TFS 流程模板，以更好地匹配我们遵循的流程。有没有办法将此新模板应用于现有项目。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-30T02:58:26.370

试试以下免费工具：

[http://witsynchronizer.codeplex.com/](http://witsynchronizer.codeplex.com/)

它允许您在两个项目之间同步模板

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-09-30T18:46:50.393

TFS 中没有“模板升级”功能。您可以尝试简单地更新您的 WIT。但是您还需要更新您的查询和报告以及共享文档等。丑陋。

最好的方法是使用新模板创建一个新项目（最好使用新的 TPC），然后将您的工作项迁移到新项目。

# regex - 匹配方括号的正则表达式是什么？

> ID：928072
> 
> 赞同：115
> 
> 时间：2009-05-29T20:49:13.947
> 
> 标签：regex

我想要一个匹配方括号的正则表达式`[`。我还没有找到一个。我想我尝试了所有的可能性，但没有找到合适的。什么是有效的正则表达式？

* * *

## 回答 #1

> 赞同：126
> 
> 时间：2009-05-29T20:51:01.043

`\`在方括号前面使用反斜杠怎么样。通常方括号匹配一个字符类。

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2009-05-29T20:51:05.457

尝试使用`\\[`，或者干脆`\[`。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2018-03-22T18:03:10.770

如果要匹配以 开头`[`和结尾的表达式`]`，请使用`\[[^\]]*\]`。

以下是每个部分的含义（如[www.regexr.com](http://www.regexr.com)中所述）： [![在此处输入图像描述](https://i.stack.imgur.com/aanO6.jpg)](https://i.stack.imgur.com/aanO6.jpg)

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-05-29T20:52:24.767

你在逃避它`\`吗？

```
/\[/ 
```

这是开始使用正则表达式的有用资源：

[正则表达式.info](http://www.regular-expressions.info/)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-05-29T20:52:30.557

通常，当您需要正则表达式中的“特殊”字符时，只需在其前面加上`\`. 所以文字`[`是`\[`.

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-11-10T10:32:40.850

如果您希望同时找到方括号的两种变体，您可以使用以下模式来定义*符号*或*符号*的范围：`[`*`]``/[\[\]]/`*

 ** * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-05-29T20:51:19.480

它在 之前是否与反斜杠一起使用`[`？

`\[`还是`\\[`？

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2015-10-06T21:36:29.703

如果要删除`[`或`]`，请使用表达式： `"\\[|\\]"`。

两个反斜杠转义方括号，管道是“或”。

# apache-flex - Flex 警告：无法绑定到类“Object”上的属性“foo”（类不是 IEventDispatcher）

> ID：928081
> 
> 赞同：24
> 
> 时间：2009-05-29T20:50:23.867
> 
> 标签：apache-flex, actionscript-3, binding, flex3, mxml

我有一个对象，其中包含十几个要绑定到表单元素的字段，以便我可以使用该对象将数据发送回服务器以进行保存。

我的容器对象的定义：

```
private static const emptyLink:Object = {
    id: -1, title:'',
    trigger1:'',trigger2:'',trigger3:'',trigger4:'',trigger5:'',
    linkTitle:'', linkBody:'',
    answer1:'',answer2:'',answer3:'',answer4:'',answer5:''
};

[Bindable] public var currentLink:Object = emptyLink; 
```

`currentLink`在运行时分配给 ArrayCollection 中的特定索引，我只是将该`emptyLink`对象用于初始化目的，主要是。

```
<mx:Panel id="triggerPanel" title="Trigger" width="33%">
    <mx:VBox id="tpBoxes" width="100%" paddingBottom="5" paddingLeft="5" paddingRight="5" paddingTop="5">
        <mx:TextInput id="trigger1" width="100%" textAlign="left" text="{currentLink.trigger1}" />
        <mx:TextInput id="trigger2" width="100%" textAlign="left" text="{currentLink.trigger2}" />
        <mx:TextInput id="trigger3" width="100%" textAlign="left" text="{currentLink.trigger3}" />
        <mx:TextInput id="trigger4" width="100%" textAlign="left" text="{currentLink.trigger4}" />
        <mx:TextInput id="trigger5" width="100%" textAlign="left" text="{currentLink.trigger5}" />
    </mx:VBox>
</mx:Panel> 
```

当然，这编译并显示得很好，但是每个实例都有运行时警告：

> 警告：无法绑定到类“Object”上的属性“trigger1”（类不是 IEventDispatcher）警告：无法绑定到类“Object”上的属性“trigger2”（类不是 IEventDispatcher）警告：无法绑定到类“Object”上的属性“trigger3”（类不是 IEventDispatcher）警告：无法绑定到类“Object”上的属性“trigger4”（类不是 IEventDispatcher）警告：无法绑定到类上的属性“trigger5” “对象”（类不是 IEventDispatcher）

并且当字段更改`currentLink`时，对象不会更新。`TextInput`

显而易见的答案是我的对象需要是实现`IEventDispatcher`. 该答案没有告诉我的是实现该接口的细节（需要什么？什么不是？），以及是否有更简单的方法来做到这一点——比如一个内置类，它很乐意接受我的自定义属性并允许对于绑定，我不必担心实现接口的细节。

这样的类存在吗？如果不是，那么完成这项任务的最低限度和/或公认标准是什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-29T22:01:03.770

您需要使用 ObjectProxy （正如 Chetan 提到的） - 但您还需要使用 valueCommit 将您在输入中输入的文本返回到您的对象中：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:WindowedApplication xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute">
    <mx:Script>
        <![CDATA[
            import mx.utils.ObjectProxy;
              private static const emptyLink:Object = {
    id: -1, title:'',
    trigger1:'',trigger2:'',trigger3:'',trigger4:'',trigger5:'',
    linkTitle:'', linkBody:'',
    answer1:'',answer2:'',answer3:'',answer4:'',answer5:''
};

[Bindable] public var currentLink:ObjectProxy = new ObjectProxy(emptyLink);

private function handleClick():void
{
    trace(currentLink.trigger1);
}
]]>
</mx:Script>

<mx:Panel id="triggerPanel" title="Trigger" width="33%">
        <mx:VBox id="tpBoxes" width="100%" paddingBottom="5" paddingLeft="5" paddingRight="5" paddingTop="5">
                <mx:TextInput  id="trigger1" width="100%" textAlign="left" text="{currentLink.trigger1}" valueCommit="{currentLink.trigger1 = trigger1.text;}"/>

                <mx:Button label="Click" click="handleClick()"/>
        </mx:VBox>
</mx:Panel>        

</mx:WindowedApplication> 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-29T21:58:07.833

`Object`不分派事件。尽管您已将变量设为 Bindable，但`currentLink`无法绑定该变量所引用的对象的属性。

改为使用`ObjectProxy`。

```
[Bindable] public var currentLink:ObjectProxy = new ObjectProxy(emptyLink); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-29T22:00:01.603

您首先要知道的是 Flex 3 中的绑定不是双向的。绑定表达式将确保如果绑定表达式的源 (currentLink.trigger1) 发生更改，则目标 (TextInput) 将收到更改通知并相应地更新。如果您希望绑定朝另一个方向发展，至少有两种方法可以做到这一点：

1.  使用 mx:Binding 标记将 TextInput.text 引导回对象
2.  改用 BindingUtils 以编程方式执行此操作。

在 Flex 4 中，他们为双向绑定 @{some.binding.expression} 引入了一种新语法，但在 Flex 3 中不可用。

第二部分：您收到的错误是因为您绑定到“通用”原型对象。当您将 [Bindable] 元数据标记应用于属性或类时，MXMLC 编译器会生成 AS 代码，其中包括使用绑定实用程序和属性更改观察程序来进行绑定。但是，您不能让原型对象执行此操作，因为它是内置的。您可以创建一个可绑定的自定义 ActionScript 类（或具有可绑定的某些属性）。MXMLC 编译器将生成一个实现 IEventDispatcher 并因此支持绑定的类。这具有比原型对象更快的优点，并且还为您提供编译时检查，即如果您引用无效属性，您将收到编译器错误。

另一种选择是按照其他 SO 成员的建议将您的原型包装在 ObjectProxy 中。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-11-19T01:39:54.213

只是关于如何在更大的项目中找出有问题的代码的提示 - 在两者上设置断点

```
trace("warning: unable to bind to property '" 
```

SDK 的 PropertyWatcher 类中的行（Navigate > Open Type > ...）。Stacktrace 然后将帮助您找到保存损坏绑定的 ui 组件。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-07-29T09:49:09.037

一般来说，你得到“无法绑定到类上的属性 foo 的原因是因为**你缺少 foo 的 getter 或 setter**。你*也*可以将 foo 限定为公共变量，（尽管这会破坏封装）

所以你需要这两个来让它消失：

```
public function set foo (o:FooObject) : void {
...
} 
```

或者

```
public function get foo() : FooObject {
...
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-29T21:59:10.623

[这是该界面的 livedocs 参考](http://livedocs.adobe.com/flex/3/langref/index.html)。这几乎是显而易见的。

去引用：

> 通常，用户定义的类获得事件分派功能的最简单方法是扩展 EventDispatcher。

因此，

> 私有静态常量 emptyLink:EventDispatcher = {

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-29T21:45:25.440

我很久没有使用 Flex，这可能不符合您的要求，但为什么不使用 XML？我相信您可以将 TextInput 文本值设置为 XML 中的属性。

我正在使用伪代码，但这样的事情对我来说很有意义：

```
[Bindable] private static const currentLink:XML = <root>
                                                    <trigger1 value=""/>
                                                    <trigger2 value="" />
                                                  </root>;
...
<mx:TextInput id="trigger1" width ... text="{currentLink.trigger1.@value}" /> 
```

大概是这样的吧？

# assembly - 为什么 mov 指令直接使用 ax 而不是两个段寄存器？

> ID：928082
> 
> 赞同：6
> 
> 时间：2009-05-29T20:50:26.720
> 
> 标签：assembly, x86, nasm, accumulator, addressing-mode

我看到如下代码：

```
mov ax, cs
mov ds, ax
mov es, ax 
```

为什么我不能将其压缩为：

```
mov ds, cs
mov es, cs 
```

自从使用累加器寄存器以来，第一种方法是否更快？但这似乎并不直观，因为 cs 和 ds 是段**寄存器**。还是有一些我不知道的限制？

顺便说一句，我正在使用nasm。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-29T20:52:52.223

你不能将段寄存器移动到段寄存器——没有指令。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-29T20:54:29.757

处理器中用于所有指令的微码只有这么多空间。因此，对于很少使用的操作湖更改段寄存器，通常首选一条通用指令而不是几条专用指令。此外，对于某些处理器，指令的数量绝对受到架构的限制——例如，最初的 8080 处理器被限制为 256 条指令，因为它们都必须将操作码编码在一个字节中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-10-31T20:19:18.110

查看[英特尔手册第 2 卷指令集参考 - 325383-056US 2015 年 9 月](https://web.archive.org/web/20151025081307/http://www.intel.com/content/dam/www/public/us/en/documents/manuals/64-ia-32-architectures-software-developer-instruction-set-reference-manual-325383.pdf)“MOV 移动”列“指令”。

寄存器的唯一 16 位 mov 编码为：

```
mov r/m16, Sreg 
```

而《3.1.1.3 操作码汇总表中的指令列》解释：

*   r/m16 — 用于操作数大小属性为 16 位的指令的字通用寄存器或内存操作数。通用寄存器一词有：AX、CX、DX、BX、SP、BP、SI、DI。
*   Sreg — 段寄存器。

因此`mov ds, cs`是不可编码的，因为没有`mov Sreg, Sreg`版本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-05-09T09:00:46.537

真正阻止这些操作的不是汇编语言，而是底层机器语言。

虽然汇编由易于阅读的单词或助记符组成，但它们实际上非常直接地表示机器代码的 1 和 0。在 x86 CPU 上，每条指令通常由一系列字节组成，其中各个字节甚至是字节中的位都有意义。某些位代表指令，其他位代表[寻址模式](http://en.wikipedia.org/wiki/Addressing_mode)。在诸如您的示例之类的寄存器寻址模式中，一些位表示将哪些特定寄存器用作`mov`指令的源和目标。

现在，x86 系列处理器可以追溯到 1970 年代，当时 CPU 架构更简单。在那些日子里，[累加器](http://en.wikipedia.org/wiki/Accumulator_%28computing%29)的概念非常重要 -`ax`是 16 位 x86 累加器。所有计算都在此寄存器中建立或“累积”，因此可用于所有指令。其他通用寄存器的使用范围更受限制。

因为指令是基于字节的，所以您希望尽可能少的字节来表示一条指令，以保持指令解码的快速。为了使尽可能多的指令尽可能短，累加器的使用成为中心。

在摩托罗拉 680x0 等更现代的 CPU 上，更多通用寄存器具有更多以前属于累加器领域的能力。在 RISC CPU 上，所有寄存器都像累加器一样灵活。我听说在 64 位模式下，当前的 x86/amd64 指令集现在受到的限制要少得多。

# internet-explorer - Reporting Services 在展开时自动滚动到锚点

> ID：928087
> 
> 赞同：0
> 
> 时间：2009-05-29T20:50:49.700
> 
> 标签：internet-explorer, reporting-services

每当用户通过单击加号展开行组时，Reporting Services 似乎认为它通过自动滚动网页是“有用的”。没有破解 Microsoft DLL，有人知道阻止这种行为的方法吗？

在网上搜索，我发现[这个有多年历史的帖子讨论了同样的问题](http://social.msdn.microsoft.com/forums/en-US/sqlreportingservices/thread/df697e42-12ac-4c09-95e2-7324773440e7/)，但没有答案。我希望我在 SO 的朋友可能会更有知识。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-09T08:11:03.083

我刚刚遇到了同样的问题并进行了肮脏的修复！我正在使用报表查看器控件在我自己的自定义 ASP.Net 页面中显示报表。这对我有帮助，因为我可以在我的外部主机页面中添加一些额外的脚本。这是我所做的：

我打开`MaintainScrollPositionOnPostback`了我的页面，因为我很懒，只是劫持了他们的功能来计算滚动条的 y 位置。

我设置了一个间隔，每 50 毫秒捕获一次滚动条 Y 位置。

我将一个事件处理程序附加到 SSRS IFrame 的加载事件，它将滚动条设置回原来的位置。

当 SSRS 回发 iframe 加载事件时。此时SSRS已经烦人地调整了滚动条。我的事件处理程序启动并将其放回原处！这很恶心，但确实有效。

代码：

```
<script language="javascript">

    $(document).ready(function() {

        $('iframe').load(function() {
            resetScrollbar();
        });

    });

    var lastGoodScrollY = 0;
    var interval = window.setInterval(getScrollY, 50);

    function getScrollY() {
        lastGoodScrollY = WebForm_GetScrollY();
    }

    function resetScrollbar() {
        window.scrollTo(0, lastGoodScrollY);
    }

</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-01-05T13:09:43.017

只需将 reportviewer js 原生 ScrollToTarget 函数覆盖到 ReportViewerWebForm.aspx 中即可：

```
$(document).ready(function () { 
  Microsoft.Reporting.WebFormsClient._ReportArea.prototype.ScrollToTarget = function(){};
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-12T12:57:00.533

与 ReportViewer 控件 10.0.30319.1 一起使用时为我工作。不是很漂亮，因为它触及了应该是私有的 _ReportArea 并且完全消除了在某些情况下可能需要的 ScrollToTarget 函数。另一种方法是通过访问控件来访问此函数和 \ 或 ReportPage 的 NavigationId 属性，但您需要知道确切的控件 ID - 在我的情况下，它是 reportViewerDivId_ctl09，它是从 rsweb 的客户端 ID 构建的： ReportViewer Asp.Net 控件。见第二个例子

示例 1：

```
$(window).load(function () {

    if (Microsoft && Microsoft.Reporting && Microsoft.Reporting.WebFormsClient) {
        var rpp = Microsoft.Reporting.WebFormsClient._ReportArea;
        if (rpp && rpp.prototype) {
            rpp.prototype.ScrollToTarget = function () { };
        } 
    }
}); 
```

示例 2：

```
/* DOESN'T WORK!*/
var rp = $get('reportViewerDivId_ctl09_ReportControl'); /*  rp.control is ReportPage */
rp[0].control.NavigationId = null; 
/*THE BELOW WORKED*/
var ra = $('#reportViewerDivId_ctl09'); /*ra[0].control is ReportArea*/
if (ra[0] && ra[0].control && ra[0].control.ScrollToTarget) {
    ra[0].control.ScrollToTarget = function () { }; /*overriding the function so that anoying scroll on Sort doesn't happen */
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-01-17T10:49:16.710

明确的解决方案很简单，如果你知道怎么做的话。;)

您所要做的就是添加以下代码：

```
<script type="text/javascript" language="javascript">

    $(document).ready(function() {
        $('.A0').get(0).ClientController.CustomOnReportLoaded = function() {
            this.m_reportObject.m_navigationId = null;
        };
    });

</script> 
```

其中“A0”`$('.A0')`是分配给 ReportViewer 控件的 css 类名称。

作为参考，我正在粘贴初始化 ReportViewer 控件的方法：

```
 protected void InitializeReportViewer(string ID)
    {
        string reportsPath = ConfigGetter.GetReportsPath();
        string reportingServerUrl = ConfigGetter.GetReportingServerUrl();

        Instance = new ReportViewer();
        Instance.ID = ID;
        Instance.CssClass += ID;
        Instance.ProcessingMode = ProcessingMode.Remote;
        Instance.ServerReport.ReportServerUrl = new Uri(reportingServerUrl);
        Instance.ServerReport.ReportPath = reportsPath + Config.Filename;
        Instance.Enabled = true;
        Instance.InternalBorderStyle = BorderStyle.None;
        Instance.EnableViewState = true;
        if (Config.AutomaticSize)
        {
            Instance.AsyncRendering = false;
            Instance.SizeToReportContent = true;
        }
        else
        {
            Instance.Width = Config.Width;
            Instance.Height = Config.Height;
        }

        Instance.ShowParameterPrompts = false;
        Instance.ShowToolBar = false;

        SetParameters();
    } 
```

上面的示例调用它，例如：

```
 InitializeReportViewer("A0"); 
```

下面的解释，为什么它的工作原理：

ReportViewer 控件生成大量 javascript 代码，其中包含以下内容：

```
function OnLoadReport(reloadDocMap)
{
    this.m_clientController.OnReportLoaded(this, reloadDocMap);

    if (null != this.m_navigationId && this.m_navigationId != "")
        window.location.replace("#" + this.m_navigationId);

    if (this.m_autoRefreshAction != null)
        setTimeout(this.m_autoRefreshAction, this.m_autoRefreshInterval);
}
RSReport.prototype.OnLoadReport = OnLoadReport;

function OnReportLoaded(reportObject, reloadDocMap)
{
    this.m_reportObject = reportObject;
    this.CurrentPage = reportObject.m_pageNumber;
    this.TotalPages = reportObject.m_totalPages;
    this.m_searchStartPage = reportObject.m_searchStartPage;

    // Update the client side page number so that it is available to the server object
    // if it was changed asynchronously.
    var clientCurrentPage = GetControl(this.m_clientCurrentPageID);
    if (clientCurrentPage != null)
        clientCurrentPage.value = this.CurrentPage;

    // If there is a document map, display it
    if (this.HasDocumentMap())
    {
        // This method is called each time the report loads.  This happens
        // for page navigations and report actions.  For many of these cases,
        // the doc map didn't change, so don't reload it.
        if (reloadDocMap)
        {
            if (this.CanDisplayBuiltInDocMap() && this.m_docMapUrl != "")
            {
                var docMapReportFrame = frames[this.m_docMapReportFrameID];
                docMapReportFrame.frames["docmap"].location.replace(this.m_docMapUrl);
            }

            this.CustomOnReloadDocMap();
        }

        if (this.m_docMapVisible && this.CanDisplayBuiltInDocMap())
            this.SetDocMapVisibility(true);
    }

    this.CustomOnReportLoaded();
} 
```

烦人的滚动是因为这部分代码：

```
 if (null != this.m_navigationId && this.m_navigationId != "")
        window.location.replace("#" + this.m_navigationId); 
```

所以我们需要设置`this.m_navigationId`为null。在哪里？

在这部分代码`this.m_clientController.OnReportLoaded`方法被调用之前，最后是方法的调用`CustomOnReportLoaded()`，所以我们只需要`m_navigationId`在这个方法中设置null即可。我们正在这样做。瞧！

# visual-c++ - R6016 - 线程数据空间不足

> ID：928088
> 
> 赞同：8
> 
> 时间：2009-05-29T20:50:55.503
> 
> 标签：visual-c++

如何在 C++ 应用程序中调试“R6016 - 线程数据空间不足”。我已阅读[http://support.microsoft.com/kb/126709](http://support.microsoft.com/kb/126709) 但想要一些其他输入。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-29T22:13:51.717

此错误消息由 C 运行时库 CRT 生成。您使用的是哪个版本的 CRT？我将首先确定生成此错误时我的调用堆栈是什么。您可以 grep CRT 源代码以查找将返回错误的每个位置。我还将查看我的代码中调用 TLSAlloc 的任何位置，以了解我将什么放入线程本地存储以及为什么。

# jquery - 为什么这个 jQuery 函数不能正常执行？

> ID：928090
> 
> 赞同：1
> 
> 时间：2009-05-29T20:51:03.913
> 
> 标签：jquery

说到 jQuery，我完全是个菜鸟，但我正在努力学习。我在这里做错了什么？

```
function MakeCall(url) { 
var result;
$.ajax({
    url: url,
    dataType: "text",
    success: function(txt) {
        result = txt;
        return;
    }
});
alert(result);
return result;
} 
```

编辑：

好吧，对不起那一点愚蠢......我已经修复了那部分。现在我的问题是它现在的警报正在返回“未定义”，即使结果在成功函数中正确设置...

非常感谢...

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-29T20:52:58.027

```
 result == txt; 
```

应该

```
 result = txt; 
```

* * *

您的第二个问题是 ajax 调用是异步的。即 alert(result) 语句可能会在成功回调函数之前执行。

你在问如何防止这种情况。你不能。这不是一个错误。这就是 AJAX 的含义。如果您希望在 ajax 调用之后执行某些操作，请将其添加到成功回调函数中。

**编辑**

如果您确实需要在其他函数中处理结果，那么您可以这样做：

```
$.ajax({
    url: url,
    dataType: "text",
    success: function(result) {
        someOtherFunction(result)
        return;
    }
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-29T21:22:01.430

道歉 - 我正在交叉发布这个问题的答案，只看到这个人最初发布的另一个问题。

Jquery 的 ajax 函数是异步的 - 因此成功函数将在第二个警报运行**后调用。**然后它将在 ajax 方法完成之前从函数返回。

如果您真的想以这种方式构建应用程序，您可以在调用中添加一个*异步*选项，将其设置为 false。（[http://docs.jquery.com/Ajax/jQuery.ajax#options](http://docs.jquery.com/Ajax/jQuery.ajax#options)，参见第一个条目。）这将导致在 $.ajax 方法返回之前调用成功函数。

但是，不建议阻塞 ajax 调用，因为它会挂起脚本和浏览器。

因此，我建议您这样重组应用程序：

```
function MakeCall(url, callback) { 

$.ajax({
    url: url,
    dataType: "text",
    success: callback
});

}

MakeCall('http://theurl.com', function(txt) {
        result = txt;
        alert(result);
        return;
}); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-29T21:03:24.933

我认为这是由于 javascript 服务器调用的异步特性：javascript 在进行 alert() 调用之前不会等待响应

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-29T20:53:09.023

javascript中的赋值运算符是=

```
result = txt; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-29T20:55:04.870

第二个返回 undefined 因为没有分配给**result**。正如其他人所说，

将其更改为

```
 result= txt; 
```

result==txt 是一种比较方式，而不是分配方式

**编辑-**

第二个问题是因为 javascript 在它发出警报之前不会等待 ajax 完成。ajax 中的 A 代表**异步**，这意味着其他事情将运行而不是等待 ajax 函数完成

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-29T21:02:42.237

发生这种情况是因为警报在 AJAX 发送后立即发生。AJAX 是异步的，因此仅仅分派请求不足以填充结果。

将消息框放在成功函数中，或从成功函数中调用函数。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-29T21:03:44.980

也许当您发出警报时，ajax 调用尚未返回？

尝试在成功函数中添加警报以测试它是否完全返回。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-29T21:24:34.453

$.ajax() 函数默认是异步的（它是 AJAX 中的 A），因此警报会在 AJAX 回调函数完成之前发生。如果您需要函数返回值，请使用 async 选项。

```
$.ajax({
    async: false, // disable asynchronous ajax
    url: url,
    dataType: "text",
    success: function(txt) {
        result = txt;
        return;
    }
}); 
```

这将冻结浏览器直到函数完成，所以如果可以的话，最好让它异步运行并使用其他人提到的成功回调函数中的结果。

# user-input - 是什么导致这段代码出现问题？

> ID：928093
> 
> 赞同：1
> 
> 时间：2009-05-29T20:51:14.800
> 
> 标签：user-input, pascal

我只是想知道为什么这个问题会发生在我身上。如果你能帮助我，我将不胜感激。

```
Program factorial;
uses crt;
var
  f, i: Integer;
begin
  f:=1;
  for i:=1 to 5 do
    f:= f * i;
  write(f);
  readkey;
end. 
```

好的，效果很好，结果是 120。这是真的。

现在，问题来了。如果我要求用户输入数字的值，它将不起作用。

```
Program factorial;
uses crt;
var
  i,r: Integer;
begin
  write('Enter the number');
  read(r);

  for i:=1 to r do
    r:= r * i;

  write(r);
  readkey;
end. 
```

如果我写 5，输出将是 600。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-29T20:56:18.830

您正在使用值 r 作为循环的停止条件并修改循环中的值。

```
Program factorial;
uses crt;
var
    i,r, f: Integer;
begin
  write('Enter the number');
  read(r);
  f := 1;
  for i:=1 to r do
     f:= f * i;
  write(f);
  readkey;
end. 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-29T20:56:05.697

您重用该`r`变量。如果您`5`为`r`您的程序输入将生效一到多次。你应该从`1`第一个开始`f`。

```
Program factorial;
uses crt;
var
    i,r, f: Integer;
begin
    write('Enter the number');
    read(r);
    f:=1
    for i:=1 to r do
        f:= f * i;
    write(r);
    readkey;
end. 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-29T20:54:41.097

尝试：

```
Program factorial;
uses crt;
var
i,r,x: Integer;
begin
write('Enter the number');
read(x);
r:=1
for i:=1 to x do
r:= r * i;
write(r);
readkey;
end. 
```

# c# - 在 WPF 中使用 F1 帮助（CHM 格式）

> ID：928122
> 
> 赞同：20
> 
> 时间：2009-05-29T20:56:32.857
> 
> 标签：c#, wpf, winforms, interop, chm

我已经在 WPF 应用程序上工作了一段时间，现在是时候将 CHM 格式的帮助文档附加到它了。

可惜！HelpProvider 是在 Winforms 中显示 CHM 文件的标准方式，它神奇地消失了，并且在 WPF 中没有对应物。我一直在尝试使用 WindowsFormsHost 来生成一个新控件，以便我可以实际显示帮助，但本质上它只是控制了整个 UI。

更多细节：我有一个菜单项，我想在单击时打开 CHM 文件。

首先，我设置了 WindowsFormsHost ...

```
host = new System.Windows.Forms.Integration.WindowsFormsHost();
helpForm = new System.Windows.Forms.Control();
host.Child = helpForm;
host.Visibility = System.Windows.Visibility.Hidden;
this.grid1.Children.Add(host);

hp = new System.Windows.Forms.HelpProvider();
hp.HelpNamespace = "Somehelpfile.chm";
hp.SetHelpNavigator(helpForm, System.Windows.Forms.HelpNavigator.TableOfContents); 
```

然后我说，瞧，展现你自己。

```
private void Help_Click(object sender, RoutedEventArgs e)
{
    host.Visibility = Visibility.Visible;
    helpForm.Show();
    hp.SetShowHelp(helpForm, true);
} 
```

我不确定从哪里开始。当我显示 helpForm 时，它会遮盖/覆盖现有的 UI，我得到的只是一个灰色的空 WPF 窗口，没有帮助文件。

有接盘侠吗？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-08-31T02:20:57.243

如果你包括 System.Windows.Forms.dll 你也可以这样做：

```
System.Windows.Forms.Help.ShowHelp(null, @"help.chm"); 
```

[此外，这里](http://blogs.msdn.com/mikehillberg/archive/2007/07/26/a-context-sensitive-help-provider-in-wpf.aspx)还有一篇关于向 WPF 添加上下文相关帮助系统的文章。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-05-29T21:06:25.363

叫我疯了，但你不能这样做：

```
System.Diagnostics.Process.Start(@"C:\path-to-chm-file.chm"); 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-11-01T17:21:32.340

我正在尝试[使用 WPF 的 Easy Help](http://peteohanlon.wordpress.com/2009/05/01/easy-help-with-wpf/)，它还解决了基于关键字的上下文相关帮助。目前看来还不错。我需要做的就是破解并写一些体面的帮助！

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-07-04T12:00:32.740

您可以使用[http://www.pinvoke.net/default.aspx/hhctrl.HtmlHelp](http://www.pinvoke.net/default.aspx/hhctrl.HtmlHelp)打开指定主题的 chm 帮助，并更好地控制 chm 窗口的显示方式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T20:24:36.870

如何使用[帮助](http://msdn.microsoft.com/en-us/library/system.windows.forms.help.aspx)类而不是从外部打开文件

# c# - 如何添加xml命名空间

> ID：928126
> 
> 赞同：6
> 
> 时间：2009-05-29T20:58:43.070
> 
> 标签：c#, xml, api, namespaces

这个提要（它的片段）需要看起来完全像这样：

```
<AmazonEnvelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
                xsi:noNamespaceSchemaLocation="amzn-envelope.xsd"> 
```

我要在这个 C# 代码中添加什么来添加额外的 xmlns、xsi 垃圾：

```
writer.WriteStartDocument();
writer.WriteStartElement("AmazonEnvelope"); 
```

没有它，这个提要就会被拒绝——

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-29T21:29:09.000

尝试这个：

```
writer.WriteStartElement("AmazonEnvelope");
writer.WriteAttributeString(
  "xmlns", "xsi", null, "http://www.w3.org/2001/XMLSchema-instance");
writer.WriteAttributeString(
  "xsi", "noNamespaceSchemaLocation", null, "amzn-envelope.xsd");
...
writer.WriteEndElement(); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-29T21:27:11.220

.NET 3.5 是一种选择吗？

```
XNamespace ns = "http://www.w3.org/2001/XMLSchema-instance";

string s = new XElement("AmazonEnvelope",
    new XAttribute(XNamespace.Xmlns + "xsi", ns),
    new XAttribute(ns + "noNamespaceSchemaLocation", "amzn-envelope.xsd")
).ToString(); 
```

* * *

或与`XmlWriter`：

```
const string ns = "http://www.w3.org/2001/XMLSchema-instance";
writer.WriteStartDocument();
writer.WriteStartElement("AmazonEnvelope");
writer.WriteAttributeString("xmlns", "xsi", "", ns);
writer.WriteAttributeString("xsi", "noNamespaceSchemaLocation",
      ns, "mzn-envelope.xsd");
writer.WriteEndDocument(); 
```

# xml - 在导入 Excel 之前在 XML 上应用 XSLT

> ID：928129
> 
> 赞同：5
> 
> 时间：2009-05-29T20:59:24.567
> 
> 标签：xml, excel, xslt

我有一个应用于 XML 数据文件的 XSLT 模板。该模板会生成一个 Excel 电子表格 XML 文件。

一切都很好，除了一个小问题....

当我在 Excel 中打开电子表格时，它会将其视为 XML 导入并询问我是否应应用样式表。我想要它，以便它自动应用与文件关联的任何 XSLT 模板。

下面是一些示例代码....在此先感谢....

**XML 文档...**

```
<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="spreadstyle.xsl"?>

<ResponseBody>
    <ActivityDetails>
        <ActivityDetail>
            <TranCodeDesc>LateChargeAssessment</TranCodeDesc>
        </ActivityDetail>
    </ActivityDetails>
</ResponseBody> 
```

**XSLT 模板...**

```
<?xml version="1.0"?>
<?mso-application progid="Excel.Sheet"?>

<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

<xsl:template match="/">

    <Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"
     xmlns:o="urn:schemas-microsoft-com:office:office"
     xmlns:x="urn:schemas-microsoft-com:office:excel"
     xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"
     xmlns:html="http://www.w3.org/TR/REC-html40">

     <DocumentProperties xmlns="urn:schemas-microsoft-com:office:office">
      <Author>tbarbedo</Author>
      <Created>2009-05-29T18:21:48Z</Created>
      <Version>12.00</Version>
     </DocumentProperties>
     <ExcelWorkbook xmlns="urn:schemas-microsoft-com:office:excel">
      <WindowHeight>8895</WindowHeight>
      <WindowWidth>18015</WindowWidth>
      <WindowTopX>0</WindowTopX>
      <WindowTopY>105</WindowTopY>
      <ProtectStructure>False</ProtectStructure>
      <ProtectWindows>False</ProtectWindows>
     </ExcelWorkbook>
     <Styles>
      <Style ss:ID="Default" ss:Name="Normal">
       <Alignment ss:Vertical="Bottom"/>
       <Borders/>
       <Font ss:FontName="Calibri" x:Family="Swiss" ss:Size="11" ss:Color="#000000"/>
       <Interior/>
       <NumberFormat/>
       <Protection/>
      </Style>
     </Styles>
     <Worksheet ss:Name="Sheet1">
      <Table ss:ExpandedColumnCount="1" ss:ExpandedRowCount="5000" x:FullColumns="1"
       x:FullRows="1" ss:DefaultRowHeight="15">
            <Row><Cell><Data ss:Type="String">Transaction Code Descriptions (MAGIC) </Data></Cell></Row>
            <xsl:for-each select="ResponseBody/ActivityDetails/ActivityDetail">     
                <Row> 
                    <Cell>
                        <Data ss:Type="String">
                            <xsl:value-of select="TranCodeDesc" />
                        </Data>
                    </Cell>

                </Row>
            </xsl:for-each>

      </Table>
      <WorksheetOptions xmlns="urn:schemas-microsoft-com:office:excel">
       <PageSetup>
        <Header x:Margin="0.3"/>
        <Footer x:Margin="0.3"/>
        <PageMargins x:Bottom="0.75" x:Left="0.7" x:Right="0.7" x:Top="0.75"/>
       </PageSetup>
       <Selected/>
       <Panes>
        <Pane>
         <Number>3</Number>
         <ActiveRow>1</ActiveRow>
        </Pane>
       </Panes>
       <ProtectObjects>False</ProtectObjects>
       <ProtectScenarios>False</ProtectScenarios>
      </WorksheetOptions>
     </Worksheet>
    </Workbook>

</xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-29T22:42:56.370

据我了解，没有办法绕过正在显示的*Import XML...*对话框。这个 MSDN 文章（[Transform XML Files with XSLT When Importing into Microsoft Excel 2002](http://msdn.microsoft.com/en-us/library/aa140055(office.10).aspx)）解释了原因：

> XML 是一种标记语言，用于描述结构化数据（例如工作表中的数据），以便各种应用程序可以读取它。设计人员可以创建定制的 XML 元素，支持在应用程序之间和组织之间定义、传输、验证和解释数据。这种多功能性为数据交换提供了许多机会，但它也至少有一个固有的挑战。通过操作 XML 文档的元素，设计人员可以在文档中创建任意数量的嵌套元素维度。这些父/子元素关系可能会导致 Excel 工作表的二维行列范式中的歧义。
> 
> 为了处理这种模糊性，Excel 强制对其接收的任何 XML 数据采用一种格式，除非该数据带有预定义另一种格式的样式表。这种强制格式是通过使用展平算法来填充构成工作表的行和列来创建的。然而，虽然这种格式可以有效地将多维数据强制转换为二维格式，但它并不总是以最适合人类阅读者的格式呈现数据。
> 
> 那么 Excel 如何知道何时使用展平算法或 XSLT 样式表呢？当 Excel 打开或导入 XML 数据文件时，它会在文件中查找指向 XSLT 样式表的元素。如果该元素存在，Excel 会显示一个对话框，提示您应用样式表或打开没有样式表的文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-11-12T14:30:22.643

如果您在 xsl 表中添加此指令：

```
<xsl:template match="/">
  <xsl:processing-instruction name="mso-application">
    <xsl:text>progid="Excel.Sheet"</xsl:text>
  </xsl:processing-instruction> 
```

.... excel 将运行良好

# hosting - 如何采访开发/托管商店？

> ID：928130
> 
> 赞同：1
> 
> 时间：2009-05-29T20:59:33.847
> 
> 标签：hosting, evaluation

我们正在考虑启动一个新的、专业的（面向客户的）网络应用程序；我们可以采取一些途径——我们可以在内部编码和托管，我们可以在内部编码和在外部托管，我们可以让其他人进行编码和托管，COTS 等。

假设我有合理的方法来估计 COTS 和内部开发工作的质量。

我遇到的困难是确定开发/托管商店有多“好”。我应该问他们什么样的问题？开发商店的 Joel 测试怎么样？我假设一些 Joel 测试问题适用（因为如果开发商店很适合工作，希望他们会产生好的代码），但它还需要涉及以下内容：

1) 服务器架构（假设正常运行时间为 99.99%）

2) 客户服务/质量保证

3) 对服务中断等的响应能力。

4) 合同项目

我能想到的一些问题：

你有错误数据库吗？

您如何处理新的变更请求/错误？

你们保证周转时间吗？

新请求的计费方式与错误的计费方式不同吗？

你如何定义错误？

你有测试人员吗？多少？

你有自己的数据中心吗？你租用机架空间/同地吗？专门的 NOC 工作人员？

您的开发人员规模如何？内部还是外包？

你有多少客户？我可以和他们中的一些人谈谈吗？

你的保修期是多久？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-29T21:05:56.283

你名单上的最后一个问题，*“你有多少客户？我可以和他们中的一些人谈谈吗？”* 还应该转化为查看现有产品组合。然后对那些特定的“产品”（网站、应用程序等）进行研究。

仅此一项（但不应该是唯一的）应该可以告诉您很多有关他们工作质量的信息。

# asp.net - 获取动态下拉列表选择的选定行索引

> ID：928131
> 
> 赞同：1
> 
> 时间：2009-05-29T20:59:40.027
> 
> 标签：asp.net, vb.net, visual-studio, gridview, drop-down-menu

我知道这个问题有点不稳定，可能会产生误导，但我有一个网格视图，行上有下拉列表。我为 SelectedIndexChanged 创建了一个 AddHandler 和一个 Delegate，它到达了 sub。这是代码：

```
AddHandler ddlmgr.SelectedIndexChanged, AddressOf ddlmgr_SelectedIndexChanged
Public Delegate Sub DropDownList_SelectedIndexChanged(ByVal sender As Object, ByVal e As DropDownList_SelectedIndexChanged)

Protected Sub ddlmgr_SelectedIndexChanged(ByVal sender As Object, ByVal e As EventArgs)

End Sub 
```

如果未调用 GridView_RowCommand，我如何获取行的 ID？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-29T21:48:22.533

你需要做一些跑腿的工作，因为我不能提供 100% 的细节而不写出代码并在这里自己测试，我目前无法这样做，但代码应该遵循这些行。

在 ddlmgr_SelectedIndexChaged 内，

1.  将您的发件人投射到 DropDownList
2.  访问下拉列表的 part 属性。
3.  检查它是一个 GridItem （或 repeateritem 或任何一个，你明白的）
4.  如果是，则获取项目 itemindex。如果不访问其父属性。
5.  继续，直到找到您的 Row 对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T16:52:55.757

希望这会有所帮助。如果没有，也许有更自由的访问权限的人可以加入

```
DropDownList ddl = (DropDownList)sender;
Control p = ddl.Parent;

//you are going to loop because the immediate 
//parent may not be the repeater item but instead a 
//container control of some kind (say a template)
while (p.GetType() != typeof(RepeaterItem))
{
     p = p.Parent;
     if (p == null) return; //we have reached the top of the control tree
}
RepeaterItem ri = (RepeaterItem)p;
int index = ri.ItemIndex
return index; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-15T10:24:17.660

DropDownList ddltxt = (DropDownList)sender; 字符串 temp2 = ddltxt.SelectedItem.Text；字符串 temp3 = ddltxt.SelectedItem.Value; 字符串 temp = ddltxt.ID.ToString(); int strlength = temp.Length; 字符串 strLastchar = temp.Substring(strlength - 1, 1); int intlastchar = int.Parse(strLastchar.ToString()); string commonpart = temp.Substring(0, strlength - 1);

```
 if (intlastchar == 1)
    {
        string targetdropdownid = commonpart + "2";
        DropDownList targetlist = (DropDownList)TableRow11.FindControl(targetdropdownid);
        using (conn = new SqlConnection(ConnectionString)) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-08T19:56:49.043

伟大的工作对我来说绝对没问题

```
DropDownList ddl = (DropDownList)sender;
Control p = ddl.Parent;
//you are going to loop because the immediate
//parent may not be the repeater item but instead a 
//container control of some kind (say a template)
while (p.GetType() != typeof(RepeaterItem))
{     
  p = p.Parent;     
  if (p == null) 
      return; //we have reached the top of the control tree
}
RepeaterItem ri = (RepeaterItem)p;
int index = ri.ItemIndexreturn index; 
```

# java - 是否有可用于 Java 的元语言允许您访问对象复杂层次结构？

> ID：928133
> 
> 赞同：3
> 
> 时间：2009-05-29T21:00:12.537
> 
> 标签：java, oop

我正在为我当前的项目评估复杂对象层次模型的一些潜在实现。我想知道是否有 xpath 风格的元语言或类似的东西可以让我查询这些对象链接。

此外，我确信我所问的问题使用了一些非常具体的术语——我只是不知道。

要求：

*   必须在 Java 中完成（或至少编译为 Java 字节码）。
*   对象将通过 n 个可能的链接分层地相互关联。obj1->obj2->obj3->...
*   我们需要能够根据对象属性或其与其他对象的关系来查找层次结构中的任何对象。
*   对象将属于同一类型。
*   分层查找应该能够在运行时发生。

我想我可以在这里推出自己的解决方案，但我很好奇是否有人比我更聪明已经想出了一些东西。

在看到一些答案后，我想我可能需要进一步澄清我的问题。具体来说，该工具将用于遍历作为父对象的不同版本的一组对象。

例如：

[对象 1 prop1="foo" prop2="bar" prop3="zoop"]

↓ 从上面的对象继承 ↓</p>

[对象 2 prop1="foo and something" prop2="bar" prop3="zoop"]

↓ 从上面的对象继承 ↓</p>

[对象 3 prop1="foo and something" prop2="bar" prop3="zoop 24"]

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-29T21:16:39.587

我相信[JXPath](http://commons.apache.org/jxpath/)应该做你想做的事。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-29T21:09:53.140

您是否追求[OGNL](http://www.opensymphony.com/ognl/)、[SPEL](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/ch07.html)或[Unified EL](http://java.sun.com/products/jsp/reference/techart/unifiedEL.html)之类的东西？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-29T21:11:06.650

好的，首先你必须接受一个附带条件，即我自己从未真正使用它来构建任何东西，但是，jaxen 应该能够尽我所能地做那种事情，并且他们主页上的描述支持这一点：

*" [Jaxen](http://jaxen.org/)是一个用 Java 编写的开源 XPath 库。它适用于许多不同的对象模型，包括 DOM、XOM、dom4j 和 JDOM。是否也可以编写处理非 XML 树的适配器，例如编译的 Java 字节码或 Java bean 作为 XML，因此您也可以使用 XPath 查询这些树。”*

# emacs - JDE 模式缩进 4 个空格

> ID：928134
> 
> 赞同：0
> 
> 时间：2009-05-29T21:00:38.730
> 
> 标签：emacs, jde

在我的 .emacs 文件中，我有一个 c-common-mode-hook 将 c-basic-offset 设置为 4，但是每当我创建 java 文件时，它都会重置为 2。如何在 JDE 模式下将缩进设置为四个空格?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-29T21:32:23.173

好吧，最坏的情况是，您通过钩子自定义 java-mode：

```
(defun my-java-mode-setup ()
  "force c-basic-offset to be 4"
  (setq c-basic-offset 4))
(add-hook 'java-mode-hook 'my-java-mode-setup) 
```

调试为什么你的基本钩子设置不坚持需要比你给我们更多的信息。我正在按照您的描述进行操作，并在 java 文件中看到偏移量为 4。可能是您使用了一种内置样式，在常用钩子之后将偏移量设置为 2。有关如何自定义样式的信息，请参阅[此文档。](http://cc-mode.sourceforge.net/html-manual/Adding-Styles.html)

# stack - 虚拟机是如何工作的？

> ID：928136
> 
> 赞同：19
> 
> 时间：2009-05-29T21:00:54.190
> 
> 标签：stack, dynamic-typing, vm-implementation

我一直在研究编程语言是如何工作的，其中一些具有所谓的虚拟机。我知道这是在另一种编程语言中对编程语言进行某种形式的仿真，并且它的工作方式类似于使用堆栈执行编译语言的方式。我做对了吗？

有了我所做的附带条件，让我感到困惑的是，许多非编译语言允许具有“自由”类型系统的变量。例如，在 Python 中，我可以这样写：

```
x = "Hello world!"
x = 2**1000 
```

字符串和大整数是完全不相关的，并且在内存中占用的空间量不同，那么这段代码怎么能在基于堆栈的环境中表示呢？这里到底发生了什么？x 是否指向堆栈上的新位置并且未引用旧的字符串数据？这些语言不使用堆栈吗？如果不是，它们如何在内部表示变量？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-29T21:05:35.193

也许，您的问题应该标题为“**动态语言**如何工作？”。

这很简单，它们将变量类型信息连同它一起存储在内存中。这不仅在解释或 JIT 编译语言中完成，而且在 Objective-C 等本机编译语言中也是如此。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-29T21:09:34.763

在大多数 VM 语言中，变量可以概念化为指向堆中内存的指针（或引用），即使变量本身位于堆栈上。对于具有原始类型（例如 Java 中的 int 和 bool）的语言，它们也可以存储在堆栈中，但不能动态地为它们分配新类型。

忽略原始类型，堆栈中存在的所有变量都将其实际值存储在堆中。因此，如果您动态地为它们重新分配值，则原始值将被放弃（并通过某种垃圾收集算法清理内存），并且新值将分配到新的内存位中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-29T22:09:24.660

VM 与语言无关。任何语言都可以在 VM 上运行（Java VM 已经有数百种语言）。

VM 可以运行一种不同类型的“汇编语言”，一种更适合编译器适应的“汇编语言”。在 VM 中完成的所有事情都可以在 CPU 中完成，因此将 VM 视为 CPU。（有些实际上是在硬件中实现的）。

它是极低级别的，并且在许多情况下严重基于堆栈——而不是寄存器，机器级数学都是相对于相对于当前堆栈指针的位置的。

对于普通的编译语言，一个步骤需要许多指令。a + 可能看起来像“将项目从相对于堆栈指针的点抓取到 reg a，将另一个抓取到 reg b。添加 reg a 和 b。将 reg a 放入相对于堆栈指针的位置。

VM 使用一条短指令完成所有这些操作，可能是一个或两个字节，而不是机器语言中的 4 或 8 个字节（取决于 32 或 64 位架构），这（猜测）应该意味着大约 16 或 32 个字节的 x86用于 1-2 字节的机器代码。（我可能是错的，我最后的 x86 编码是在 80286 时代。）

微软在其办公产品中使用（可能仍在使用）虚拟机来减少代码量。

创建 VM 代码的过程与创建机器语言的过程相同，只是处理器类型不同而已。

VM 还可以实现自己的与语言密切相关的安全、错误恢复和内存机制。

我在这里的一些描述是总结和记忆。如果您想自己探索字节码定义，这很有趣：

[http://java.sun.com/docs/books/jvms/second_edition/html/Instructions2.doc.html](http://java.sun.com/docs/books/jvms/second_edition/html/Instructions2.doc.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-29T21:10:55.527

许多“虚拟机如何处理这样或那样的变量”的关键实际上归结为元数据......存储然后更新的元信息使虚拟机可以更好地处理如何分配然后做正确的事情变量。

在许多情况下，这是真正会影响性能的开销类型。然而，现代的实现等在做正确的事情方面已经走了很长一段路。

至于您的具体问题-将变量视为普通对象/等...归结为重新分配/重新评估新分配的元信息-这就是为什么 x 可以先看一种方式，然后再看另一种方式。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-29T21:12:17.910

要回答您的部分问题，我建议您在[google tech talk about python](http://www.youtube.com/watch?v=E_kZDvwofHY)中回答您有关动态语言的一些问题；例如变量是什么（它不是指针，也不是引用，但在 python 的情况下是标签）。

# .net - 有没有办法以编程方式设置我的 WCF 设置？

> ID：928137
> 
> 赞同：1
> 
> 时间：2009-05-29T21:01:42.363
> 
> 标签：.net, wcf, configuration

我需要能够将我的 web.config serviceModel 元素的 XML 存储在数据库中，并让我的应用程序在启动时读取它。有没有办法通过将我的启动代码更改为“覆盖”.config 文件中的 serviceModel 元素来做到这一点？[我看到这里有关于为 appSettings 部分执行此](https://stackoverflow.com/questions/158783/is-there-a-way-to-override-configurationmanager-appsettings)操作的另一个问题的答案。

如何为 serviceModel 执行此操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-29T21:08:03.363

当然 - 您可以从任何您希望的配置文件中加载服务模型配置 :-) 完全没有问题。

如果您需要经常这样做，您可能需要考虑创建自己的自定义 ServiceHost 类。关于如何做到这一点，请参阅这篇优秀[的博客文章](http://www.paraesthesia.com/archive/2008/11/26/reading-wcf-configuration-from-a-custom-location.aspx)，或者特别是[在 IIS 中托管服务的](http://blogs.msdn.com/dotnetinterop/archive/2008/09/22/custom-service-config-file-for-a-wcf-service-hosted-in-iis.aspx)这篇文章。

马克

# jquery - 为什么这个 jQuery 函数不能正常执行？（修改）

> ID：928152
> 
> 赞同：0
> 
> 时间：2009-05-29T21:05:27.300
> 
> 标签：jquery

（不是要创建一个新问题，而是对[旧](https://stackoverflow.com/questions/928090/why-wont-this-jquery-function-perform-properly)问题进行了足够的修改，以至于答案没有意义，现在又出现了一个新问题）

说到 jQuery，我完全是个菜鸟，但我正在努力学习。我在这里做错了什么？

```
function MakeCall(url) { 
var result;
$.ajax({
    url: url,
    dataType: "text",
    success: function(txt) {
        result = txt;
        alert(result);
        return;
    }
});
alert(result);
return result;
} 
```

我的问题是第一个警报返回正确的值，但第二个警报返回“未定义”并且它在第一个警报之前弹出，即使结果在成功函数中正确设置...叹息...什么我做错了吗？:(

非常感谢...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-29T21:14:38.513

Jquery 的 ajax 函数是异步的 - 因此成功函数将在第二个警报运行**后调用。**然后它将在 ajax 方法完成之前从函数返回。

如果您真的想以这种方式构建应用程序，您可以在调用中添加一个*异步*选项，将其设置为 false。（[http://docs.jquery.com/Ajax/jQuery.ajax#options](http://docs.jquery.com/Ajax/jQuery.ajax#options)，参见第一个条目。）这将导致在 $.ajax 方法返回之前调用成功函数。

但是，不建议阻塞 ajax 调用，因为它会挂起脚本和浏览器。

因此，我建议您这样重组应用程序：

```
function MakeCall(url, callback) { 

$.ajax({
    url: url,
    dataType: "text",
    success: callback
});

}

MakeCall('http://theurl.com', function(txt) {
        result = txt;
        alert(result);
        return;
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-29T21:22:35.330

使用 XHR 时没有“等待”的好概念（好的，是的，你可以让它同步，但它会锁定浏览器的一些东西）。相反，您可以利用函数可以轻松地在 javascript 中作为参数传递的事实。

这里的关键是，您定义的“成功”函数在调用从服务器返回之前不会运行，但是您的其余 javascript 会继续运行，触发您看到的未定义警报（并运行任何代码调用此函数等）。

您必须在数据到达时提醒函数调用者，而不是从函数返回数据。您可以通过添加第二个参数来做到这一点，即在服务器请求完成时调用的函数：

```
function MakeCall(url, functionToRunWhenDataArrives) { 
  $.ajax({
    url: url,
    dataType: "text",
    success: functionToRunWhenDataArrives
  });
}

MakeCall('myurl.com', function(txt){
   // do stuff with txt here!
}); 
```

这是您在发出异步请求时必须遵循的模式类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-29T21:17:58.180

Ajax 是异步的，它不会阻塞流。所以它是这样工作的：

*   你调用 $.ajax，请求被发送到服务器
*   代码在 $.ajax 调用之后进入警报，由于它还没有完成请求，结果变量仍然是未定义的
*   一段时间后，请求完成，成功函数中的警报被调用并返回结果

jQuery 有一个标志可以用来使请求同步，但这样做通常被认为是不好的做法。

# programming-languages - 设计和实现一种编程语言，下一步是什么？

> ID：928158
> 
> 赞同：0
> 
> 时间：2009-05-29T21:06:48.530
> 
> 标签：programming-languages

所以我设计了一种编程语言，并且已经足够远，我编写了示例代码并开始编写 BNF。我想知道在编写 BNF 的其余部分之前我可能想做的事情清单吗？之后我该怎么办？恐怕实现将需要很长时间（它与 C++ 一样复杂，甚至可能更复杂）。我应该做什么或应该考虑什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-29T21:13:39.560

获得对您迄今为止所做工作的同行评审。语言设计*很难*——多一双（或几只）眼睛可能会帮助你找到一些可以改进的地方，*然后*再在实现方面走得太远。（特别是，如果它比 C++ 更复杂，你确定有必要吗？）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-29T21:14:14.707

如果它比 C++ 更复杂，它可能需要重新设计。C++ 的许多复杂性来自于提供 C 兼容性的需要，因此需要将功能移植到不太出色的 C 声明语法之上。如果您不需要支持现有语言，那么很难看出如何证明这种复杂性是合理的。

我自己设计并实现了几种语言，我推荐一种独立的方法：

*   设计小子集
*   实施它
*   用它

吸取教训，设计一个更大的子集并重复。

# html - 带像素和百分比的 CSS 布局

> ID：928160
> 
> 赞同：1
> 
> 时间：2009-05-29T21:07:19.213
> 
> 标签：html, css, asp.net, layout

我有一个包含两个嵌套 div 的 div，一个指定高度为 65 像素（标题），另一个指定高度为 100%（内容），它应该垂直占用其余空间。页面渲染时，由于页眉的高度指定为 65 像素，右侧有一个滚动条。

我在混合百分比和像素时做错了什么？我肯定错过了什么。如何解决此问题，以便内容部分使用页面空间的其余部分并且我没有滚动条？

这是我正在使用的 ASP .NET 标记和 CSS：

```
 <div>
        <asp:ScriptManager ID="ScriptManager1" runat="server"/>
        <div id="header">
            <div style="float: left; height: 100%"><img align="top" alt="" src="~/images/Logo.gif" runat="server"/></div>
            <div style="float: right; height: 100%">
                <div id="outer" >
                    <div id="middle">
                        <div id="inner">
                            <asp:Label runat="server" ID="ApplicationName" Text="Application" CssClass="appname"></asp:Label>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="content">
            <ig:WebSplitter ID="WebSplitter1" runat="server" Height="100%" Width="100%" 
                DynamicResize="True" CssClass="junk">
                <panes>
                    <ig:SplitterPane ToolTip="Navigation Pane" runat="server" Size="20%" CollapsedDirection="PreviousPane" Locked="true">
                        <Template>
                            <asp:ContentPlaceHolder ID="NavigationPlaceHolder" runat="server">
                                <ig:WebDataTree ID="NavTree" runat="server" EnableHotTracking="true" 
                                    Height="100%" OnNodeClick="NavTree_NodeClick" SelectionType="Single" 
                                    InitialExpandDepth="1"
                                    Width="100%" BorderWidth = "0px"
                                    EnableAjax ="true">
                                    <AutoPostBackFlags NodeClick="On" NodeCollapsed="Off" NodeExpanded="Off" NodeEditingTextChanged="Off" />
                                </ig:WebDataTree>
                            </asp:ContentPlaceHolder>
                        </Template>
                    </ig:SplitterPane>
                    <ig:SplitterPane Tooltip="Content Pane" runat="server" Size="80%">
                        <Template>
                            <asp:ContentPlaceHolder ID="SiteContentPlaceHolder" runat="server"/>
                        </Template>
                    </ig:SplitterPane>
                </panes>
            </ig:WebSplitter>
        </div>
    </div> 
```

```
html
{
    padding: 0px;
    margin: 0px;
    border: none;
    width: 100%;
    height: 100%;
    font-family: verdana;
    font-size: x-small;
    font-weight: normal;
    font-style: normal;
    font-variant: normal;
    text-transform: none;
    text-transform: none;    
    float: none;       
} 

body
{
    border: none;
    padding: 0px;
    height: 100%;
    width: 100%;
    border: none;
    margin: 0px;
}

form 
{
    border: none;
    margin: 0px; 
    padding: 0px; 
    border: none; 
    height: 100%; 
    width: 100%;
}

span.appname
{
    text-align: right;
    font-family: Arial, Helvetica, sans-serif;
    font-size: 18pt;
    font-weight: bold;
    font-style: normal;
    color: #FFFFFF;
    padding-right: 10px;
}

#header 
{
    background: #295984;
    width: 100%;
    height: 65px;
    overflow: hidden;
}

#content
{
    display: inline;
    width: 100%;
    height: 100%;
}

#outer {height: 100%; overflow: hidden; position: relative; width: 100%;}
#outer[id] {display: table; position: static;}

#middle {position: absolute; top: 50%; width: 100%; text-align: center;} /* for explorer only*/
#middle[id] {display: table-cell; vertical-align: middle; position: static;}

#inner {position: relative; top: -50%; text-align: right;} /* for explorer only */
#inner {width: 100%; margin-left: auto; margin-right: auto;} /* for all browsers*/
#inner[id] {position: static;} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-29T21:43:03.153

最简单的解决方案是将您的标题移动到您的内容中......然后它将占用内容块内的空间，而不是在其上方。

如果这不是一个选项，那么有多种解决方案可以解决问题。以下是一些列表：

1）绝对定位标题，z-index 为 10。给内容 div 一个 65px 的 padding-top，z-index 为 1。标题应覆盖内容 div 的上部填充区域。这对于没有任何动态宽度随浏览器窗口宽度增长/收缩的非常严格的设计非常有效。

2) 明确定位内容 div 的顶部、左侧、底部、右侧。不指定宽度或高度。在这种情况下，top、left、bottom 和 right 是根据内容 div 的包含块的内部填充边缘计算的。同样，这在严格的网站设计中效果很好。应该在 IE7/8 中工作，但在 IE6 和更早版本中会出现问题。

3) 在内容 div 上使用负上边距 og -65px。使用 65 像素的顶部填充进行补偿。这对于 IE7 及更早版本可能会出现问题，并且有时 FireFox 会因负边距而变得不稳定。有可以解决问题的hack，只需搜索网络即可。这应该适用于刚性或流体布局。

网上有很多关于 CSS 设计的资源。如果上述选项不起作用，则在网上进行一些搜索应该会带来一些资源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-29T21:31:50.383

请先尝试阅读[这篇文章](http://www.alistapart.com/articles/conflictingabsolutepositions)……它是关于CSS 模板中的**绝对位置冲突**的，它以某种方式解决了您正在谈论的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T12:09:43.717

目前你有 2 个 div，总高度为 100% + 65px，所以它应该有一个滚动条

如果不求助于 css hack，你就不能真正用 div 做你正在尝试的事情。最简单和最兼容浏览器的方法是将其包含在一个 2 行表中。将表格高度设置为 100%，第一个 td 高度为 65px，第二个 td 高度未指定。有些人反对使用表格进行布局，但如果您无论如何都要错误地使用 css，那为什么不呢？

虽然，最好使用一个 div 高于另一个 div 的设计。由于屏幕尺寸的广泛变化，动态调整浏览器的内容不再有效。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T12:28:47.717

(100% + N) > 100% - 不幸的是，CSS 中没有“剩余空间”之类的东西。

当您说 100% 时，它的意思正是如此，所以您最好的选择是 jrista 的选项 2 或 3（恕我直言，要避免 abs 定位）。我也认为你可能想谷歌位置：固定。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-10-31T06:45:31.473

您可以在 CSS 中使用 calc() 函数。标题高度：65px。对于内容高度：calc(100% - 65px)。使用 CSS 变量作为标题高度，所以将来如果你想改变，你只需要改变就地。

# rdf - OWL 程序集生成问题 (OWLGrinder)

> ID：928162
> 
> 赞同：2
> 
> 时间：2009-05-29T21:07:50.977
> 
> 标签：rdf, owl, ontology, rowlex

我正在从我的 OWL 本体构建一个程序集，但是在解析本体时，它会在声明类型并给出一些值的“数据类型属性”处引发错误消息。我已经使用 Protege v3.4 编写了我的本体。

例如，引发错误的数据类型属性之一是“语言”，其类型为“字符串”，值如“英语和波斯语”。参考文献如下，由 protege 提供：

```
<rdf:RDF xml:base="http://www.owl-ontologies.com/Ontology1243411901.owl"
xmlns="http://www.owl-ontologies.com/Ontology1243411901.owl#"
xmlns:owl="http://www.w3.org/2002/07/owl#"
xmlns:protege="http://protege.stanford.edu/plugins/owl/protege#"
xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#"
xmlns:swrl="http://www.w3.org/2003/11/swrl#" 
xmlns:swrlb="http://www.w3.org/2003/11/swrlb#" xmlns:xsd="http://www.w3.org/2001/XMLSchema#" 
xmlns:xsp="http://www.owl-ontologies.com/2005/08/07/xsp.owl#"> 
```

下面提到了“语言”属性：

```
<owl:DatatypeProperty rdf:ID="language">
        <rdfs:range>
            <owl:DataRange>
                <owl:oneOf rdf:parseType="Resource">
                    <rdf:rest rdf:parseType="Resource">
                        <rdf:rest rdf:resource="http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"/>
                        <rdf:first rdf:datatype="http://www.w3.org/2001/XMLSchema#string">Farsi</rdf:first>
                    </rdf:rest>
                    <rdf:first rdf:datatype="http://www.w3.org/2001/XMLSchema#string">English</rdf:first>
                </owl:oneOf>
            </owl:DataRange>
        </rdfs:range>
        <rdfs:domain>
            <owl:Class>
                <owl:unionOf rdf:parseType="Collection">
                    <owl:Class rdf:about="#Teacher"/>
                    <owl:Class rdf:about="#ClassOfCourse"/>
                    <owl:Class rdf:about="#LearningResource"/>
                    <owl:Class rdf:about="#Discussion"/>
                    <owl:Class rdf:about="#Student"/>
                </owl:unionOf>
            </owl:Class>
        </rdfs:domain>
    </owl:DatatypeProperty> 
```

我只是向 OWLGrinder 添加了一个本体。生成时出现此错误：

```
Assembly generation failed. 
OWL property 'http://www.owl-ontologies.com/Ontology1243411901.owl#language' has a range declaration that points to _:bnode10579059 but its definition is missing. 
Are you missing an ontology which declares this class? 
```

每次按下“生成”按钮时，“_:bnode”前面的数字都会发生变化。通过从“语言”属性中删除值，会发生与下一个 DataType 属性相关的另一个错误。这意味着定义的每个 DataType 属性（并为其指定了一些值）在 OWLGrinder 中出错。

我想知道是否有人可以指导我处理这个错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T05:52:16.817

我不熟悉 OWLGrinder，但您可以尝试声明一个命名类，例如`ExpectedLanguages`（给您的匿名节点一个 URI），然后将其用作`language`谓词的范围。一个简略的例子（[Turtle](http://www.w3.org/TeamSubmission/turtle/)格式）：

```
:ExpectedLanguages
    a owl:DataRange ;
    owl:oneOf (
        "Farsi"^^xsd:string
        "English"^^xsd:string
    );
.

:languages
    rdfs:range :ExpectedLanguages ;
. 
```

您使用[OWL 枚举数据类型](http://www.w3.org/TeamSubmission/turtle/)要求您的代码/解析器/推理器至少符合 OWL-DL。

`_:bnodeXXX`（空白节点/匿名节点）每次都有新ID的原因是因为它是空白的。但是，为了在内存中的 RDF 图（模型）中识别它，需要在加载每个匿名节点时为其生成一个 ID，以便在分析模型时可以唯一地识别每个节点（匿名或命名）因此可以识别其传入和传出引用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T07:06:12.987

目前[ROWLEX](http://rowlex.nc3a.nato.int) OwlGrinder 期望范围是文字或常规类。我建议创建一个“LanguageList”包装类，其中包含您的枚举，并将其分配为一个范围。我没有对此进行测试，但我确实希望它能够工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-22T10:25:45.253

[Intellidimension](http://www.intellidimension.com/)提供了一个可以将 OWL-Lite、OWL-Full 或 OWL-DL 转换为 .NET 类的 SDK。你可能想看看那个。

**旁注**
我认为您在本体中混淆了域的语义。看来您是在说“语言可能只存在于教师、课程、学习资源、讨论、学生上”，而实际上您是在说“如果语言用于描述一个实例，则该实例可以被推断为教师联盟、ClassOfCourse、LearningResource、讨论和学生。”。这是对 OWL 语义的常见误解，因为感觉域应该限制属性的使用，而实际上这不是 OWL 的功能（模式/验证）。OWL 仅用于描述应由用法推断的内容，它不规定用法。

[OWL 指南中描述的域语义。](http://www.w3.org/TR/2004/REC-owl-guide-20040210/#rdfs_domain)

通过在语言属性的域中使用 UnionOf，您是在说“使用语言属性描述的任何内容都是教师、课程类别、学习资源、讨论或学生”。我认为这通常没有意义。

[OWL 指南中描述的 UnionOf 语义。](http://www.w3.org/TR/2004/REC-owl-guide-20040210/#SetOperators)

Range 的相似之处在于，如果您将属性的范围定义为特定类型，则可以推断该属性引用的所有文字/资源都是使用范围声明定义的类型。

[OWL 指南中描述的范围。](http://www.w3.org/TR/2004/REC-owl-guide-20040210/#rdfs_range)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-29T21:15:00.027

我已经在[http://www.mygrid.org.uk/OWL/Validator](http://www.mygrid.org.uk/OWL/Validator)复制/粘贴了你的本体：它说这个本体（至少）不是 OWL-lite 本体。这可能是您的 Protege 配置的问题？

# lisp - SBCL 1.0.28 上的 AllegroServe 因“接受无效关键字参数：：AUTO-CLOSE”而失败

> ID：928163
> 
> 赞同：2
> 
> 时间：2009-05-29T21:07:56.297
> 
> 标签：lisp, sbcl

在 debian 上运行的新版本 SBCL 1.0.28 在传入连接上中断 AllegroServe 1.2.47，并出现以下错误：

```
aserve-accept-6：05/26/09 - 21:11:01 - 接受：接受无效时出现错误 0
                          关键字参数： :AUTO-CLOSE （有效键是
                          :INPUT, :OUTPUT, :ELEMENT-TYPE, :EXTERNAL-FORMAT,
                          ：缓冲，：超时）。
```

Portable AllegroServe 页面确实提到了这个问题。然而，谷歌搜索没有发现任何对这个问题有用的东西。

关于如何解决此问题的任何想法，或者指向已处理此问题的地方的链接？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-30T20:43:25.577

经过一番折腾，我想出了以下解决方案：

在**我的**源文件中，在我声明我的包之后，编译/加载适当的模块，但在我在我的包中声明任何内容之前，我添加了以下代码：

```
(defmethod sb-bsd-sockets:socket-make-stream ((socket sb-bsd-sockets:socket)
                               &key input output
                               (element-type 'character)
                               (buffering :full)
                               (external-format :default)
                               timeout
                       (auto-close t))
  "Default method for SOCKET objects.  An ELEMENT-TYPE of :DEFAULT
will construct a bivalent stream.  Acceptable values for BUFFERING
are :FULL, :LINE and :NONE.  Streams will have no TIMEOUT
by default.
  The stream for SOCKET will be cached, and a second invocation of this
method will return the same stream.  This may lead to oddities if this
function is invoked with inconsistent arguments \(e.g., one might request
an input stream and get an output stream in response\)."
  (let ((stream
         (and (slot-boundp socket 'stream) (slot-value socket 'stream))))
    (unless stream
      (setf stream (sb-sys:make-fd-stream
                    (sb-bsd-sockets:socket-file-descriptor socket)
                    :name "a socket"
                    :dual-channel-p t
                    :input input
                    :output output
                    :element-type element-type
                    :buffering buffering
                    :external-format external-format
                    :timeout timeout
            :auto-close auto-close)))
      (setf (slot-value socket 'stream) stream)
    (sb-ext:cancel-finalization socket)
    stream)) 
```

（这基本上是`sb-bsd-sockets/socket.lisp`与将`auto-close`键添加到参数列表中的内容相比的提升）

这样我就避免了修改或修补系统文件，并且基本上直接挂钩到 sb-bsd-sockets 包中。

到目前为止，它似乎正在正常工作。通过连续调用的基本测试`(room)`表明我没有明显的内存泄漏，并且性能符合预期。

如果您认为它可能会以意想不到的方式影响我的系统的稳定性，请随时对此进行评论。

# flash - 全局事件的 flash 事件监听器

> ID：928166
> 
> 赞同：1
> 
> 时间：2009-05-29T21:08:25.110
> 
> 标签：flash, actionscript-3, events, event-handling

我有一系列 MovieClips，包含在几个 MovieClips 中，它们调度一个自定义移动事件，我希望舞台可以监听并与之交互。有没有办法为任何一种类型的事件添加到舞台（或任何对象）的事件侦听器，而不管它是从哪里分派的？

例如，我可以在舞台上添加一个事件侦听器来侦听`EVENT.COMPLETE`从孩子、其任何孩子或任何孩子的孩子发送的任何内容吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-29T22:41:14.703

您正在寻找的是事件冒泡。将新事件的第三个属性设置为 true 以启用冒泡，它将从将事件调度到舞台的对象开始冒泡显示列表。有关更多信息，请参阅官方文档。

泰勒。

编辑：将“从舞台开始”更改为“对象调度事件”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-30T08:04:16.327

嗯，这是我永远无法理解的事情......为什么人们总是使用冒泡事件来捕捉舞台上的事件？

如果您查看文档，事件会从舞台传播到目标对象（捕获阶段），然后如果您启用冒泡，则会冒泡。

所以......只需使用捕获：

```
Main.as

package {
    import flash.display.Sprite;

    public class Main extends Sprite
    {
        public function Main()
        {
            var c:Circle = new Circle();
            var r:Rect = new Rect();
            c.addChild(r);
            addChild(c);
            addEventListener(CustomEvent.CUSTOM, customEventHandler, true);//don't forget third parameter to use capture
        }

        private function customEventHandler(e:CustomEvent):void
        {
            trace(e.eventPhase == EventPhase.CAPTURING_PHASE);//shows true
        }
    }
}

Circle.as

package
{
    import flash.display.Sprite;
    import flash.events.Event;
    import flash.events.MouseEvent;

    public class Circle extends Sprite
    {
        public function Circle()
        {
            super();
            init();
        }

        private function init():void
        {
            with(graphics)
            {
                beginFill(0xFF0000);
                drawCircle(25, 25, 50);
                endFill()
            }

        }
    }
}

Rect.as

package
{
    import flash.display.Sprite;
    import flash.events.MouseEvent;

    public class Rect extends Sprite
    {
        public function Rect()
        {
            super();
            init();
        }

        private function init():void
        {
            with(graphics)
            {
                beginFill(0x000000);
                drawRect(0, 0, 25, 25);
                endFill();
            }

            addEventListener(MouseEvent.CLICK, mouseClickHandler);
        }

        private function mouseClickHandler(e:MouseEvent):void
        {
            dispatchEvent(new CustomEvent(CustomEvent.CUSTOM));
        }

    }
} 
```

CustomEvent.as

```
package
{
    import flash.events.Event;

    public class CustomEvent extends Event
    {
        public static const CUSTOM:String = "custom";

        public function CustomEvent(type:String, bubbles:Boolean=false, cancelable:Boolean=false)
        {
            super(type, bubbles, cancelable);
        }

    }
} 
```

# php - PHP Soap 非 WSDL 调用：如何传递参数？

> ID：928169
> 
> 赞同：12
> 
> 时间：2009-05-29T21:09:18.167
> 
> 标签：php, web-services, soap

我正在尝试像这样在 PHP (5.2.5) 中进行非 WSDL 调用。我确定我错过了一些简单的东西。这个调用有一个参数，一个字符串，叫做“timezone”：

```
 $URL = 'http://www.nanonull.com/TimeService/TimeService.asmx';

    $client = new SoapClient(null, array(
        'location' => $URL,
        'uri'      => "http://www.Nanonull.com/TimeService/",
        'trace'    => 1,
        ));

// First attempt:
// FAILS: SoapFault: Object reference not set to an instance of an object
   $return = $client->__soapCall("getTimeZoneTime",
       array(new SoapParam('ZULU', 'timezone')),
       array('soapaction' => 'http://www.Nanonull.com/TimeService/getTimeZoneTime')
    );

// Second attempt:
// FAILS: Generated soap Request uses "param0" instead of "timezone"
   $return = $client->__soapCall("getTimeZoneTime",
       array('timezone'=>'ZULU' ),
       array('soapaction' => 'http://www.Nanonull.com/TimeService/getTimeZoneTime')
   ); 
```

感谢您的任何建议-
戴夫

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-06T21:28:45.387

谢谢。这是现在有效的完整示例：

```
$URL = 'http://www.nanonull.com/TimeService/TimeService.asmx';

$client = new SoapClient(null, array(
    'location' => $URL,
    'uri'      => "http://www.Nanonull.com/TimeService/",
    'trace'    => 1,
    ));

$return = $client->__soapCall("getTimeZoneTime",
   array(new SoapParam('ZULU', 'ns1:timezone')),
   array('soapaction' => 'http://www.Nanonull.com/TimeService/getTimeZoneTime')
); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2011-05-05T23:29:38.363

@Dave C 的解决方案对我不起作用。环顾四周，我想出了另一个解决方案：

```
$URL = 'http://www.nanonull.com/TimeService/TimeService.asmx';

$client = new SoapClient(null, array(
    'location' => $URL,
    'uri'      => "http://www.Nanonull.com/TimeService/",
    'trace'    => 1,
    ));

$return = $client->__soapCall("getTimeZoneTime",
   array(new SoapParam(new SoapVar('ZULU', XSD_DATETIME), 'timezone')),
   array('soapaction' => 'http://www.Nanonull.com/TimeService/getTimeZoneTime')
); 
```

希望这可以帮助某人。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-06T09:15:42.080

问题在于参数中缺少命名空间信息。我使用了您示例的第一个案例，因为它最接近我的想法。

如果换行：

```
array(new SoapParam('ZULU', 'timezone')), 
```

到：

```
array(new SoapParam('ZULU', 'ns1:timezone')), 
```

它应该会给您预期的结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-29T21:26:18.740

您可以尝试`array()`在您的参数周围添加另一个调用，如下所示：

```
$params = array('timezone'=>'ZULU' );
$return = $client->__soapCall("getTimeZoneTime",
    array($params),
    array('soapaction' => 'http://www.Nanonull.com/TimeService/getTimeZoneTime')
); 
```

我无法测试这个，但你可以。

# php - 使用 php 显示 .txt 文件的内容

> ID：928174
> 
> 赞同：5
> 
> 时间：2009-05-29T21:10:05.590
> 
> 标签：php, text-files, implode

使用此代码

```
<?php
foreach (glob("*.txt") as $filename) {   
    $file = $filename;
    $contents = file($file); 
    $string = implode($contents); 
    echo $string;
    echo "<br></br>";
}
?> 
```

我可以在文件夹中显示任何 txt 文件的内容问题是所有的格式，等等从 txt 文件被跳过

txt 文件看起来像

```
#nipponsei @ irc.rizon.net presents:

Title: Ah My Goddess Sorezore no Tsubasa Original Soundrack
Street Release Date: July 28, 2006

------------------------------------

Tracklist:

1\. Shiawase no Iro On Air Ver
2\. Peorth
3\. Anata ni Sachiare
4\. Trouble Chase
5\. Morisato Ka no Nichijou
6\. Flying Broom
7\. Megami no Pride
8\. Panic Station
9\. Akuryou Harai
10\. Hore Kusuri
11\. Majin Urd
12\. Hild
13\. Eiichi Soudatsusen
14\. Goddess Speed
15\. Kaze no Deau Basho
16\. Ichinan Satte, Mata...
17\. Eyecatch B
18\. Odayaka na Gogo
19\. Heibon na Shiawase
20\. Kedarui Habanera
21\. Troubadour
22\. Awate nai de
23\. Ninja Master
24\. Shinobi no Okite
25\. Skuld no Hatsukoi
26\. Kanashimi no Yokan
27\. Kousaku Suru Ishi
28\. Dai Makai Chou Kourin
29\. Subete no Omoi wo Mune ni
30\. Invisible Shield
31\. Sparkling Battle
32\. Sorezore no Tsubasa
33\. Yume no Ato ni
34\. Bokura no Kiseki On Air Ver

------------------------------------

Someone busted in, kicked me and asked why there was no release
of it. I forgot! I'm forgetting a lot...sorry ;_;

minglong 
```

我得到的结果看起来像

```
#nipponsei @ irc.rizon.net presents: Title: Ah My Goddess Sorezore no Tsubasa Original Soundrack Street Release Date: July 28, 2006 ------------------------------------ Tracklist: 1\. Shiawase no Iro On Air Ver 2\. Peorth 3\. Anata ni Sachiare 4\. Trouble Chase 5\. Morisato Ka no Nichijou 6\. Flying Broom 7\. Megami no Pride 8\. Panic Station 9\. Akuryou Harai 10\. Hore Kusuri 11\. Majin Urd 12\. Hild 13\. Eiichi Soudatsusen 14\. Goddess Speed 15\. Kaze no Deau Basho 16\. Ichinan Satte, Mata... 17\. Eyecatch B 18\. Odayaka na Gogo 19\. Heibon na Shiawase 20\. Kedarui Habanera 21\. Troubadour 22\. Awate nai de 23\. Ninja Master 24\. Shinobi no Okite 25\. Skuld no Hatsukoi 26\. Kanashimi no Yokan 27\. Kousaku Suru Ishi 28\. Dai Makai Chou Kourin 29\. Subete no Omoi wo Mune ni 30\. Invisible Shield 31\. Sparkling Battle 32\. Sorezore no Tsubasa 33\. Yume no Ato ni 34\. Bokura no Kiseki On Air Ver ------------------------------------ Someone busted in, kicked me and asked why there was no release of it. I forgot! I'm forgetting a lot...sorry ;_; minglong 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-29T21:13:17.753

`implode`默认为空字符串。你应该`implode`这样称呼：

```
 $string = implode("<br>", $contents); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-29T21:13:40.933

您必须将 HTML 换行符添加到物理换行符。您可以使用该[`nl2br`功能](http://docs.php.net/nl2br)来做到这一点：

```
foreach (glob("*.txt") as $filename) {
    echo nl2br(file_get_contents($filename));
    echo "<br></br>";
} 
```

另外我会使用[`file_get_contents`函数](http://docs.php.net/file_get_contents)而不是`file`and的组合`implode`。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-29T21:20:34.663

如果这不是 HTML 文档的一部分，则需要更改内容类型：

```
<?php
header("Content-Type: text/plain");
foreach (glob("*.txt") as $filename) { 
  readfile($filename);
}
?> 
```

如果它是 HTML 文档的一部分，只需执行以下操作：

```
<pre>
<?php
foreach (glob("*.txt") as $filename) { 
  readfile($filename);
}
?>
</pre> 
```

或者，您可以用换行符替换换行符：

```
<?php
foreach (glob("*.txt") as $filename) { 
  $str = file_get_contents($filename);
  echo preg_replace('!\r?\n!', '<br>', $str);
}
?> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-29T21:13:10.763

`<pre></pre>` 在标签之间嵌入文本文件内容

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-31T00:38:45.897

正如提到的其他几个响应，这在很大程度上取决于您显示输出的页面。

## 原始文本输出

如果您不向页面添加任何其他内容或 HTML。只需将 HTTP Content-Type 标头更改为“text/plain”；那是：

```
header('Content-Type: text/plain');
echo file_get_contents('path/to/file'); 
```

与往常一样，必须在将任何内容发送到浏览器*之前发送 HTTP 标头。*

## (X)HTML 输出

替换`\n`'s`<br/>`不会*解决*空格截断问题；也就是说，删除相邻的空格和/或制表符。解决这个问题的最简单方法（也如前所述）是使用`<pre>`标签来包含文件的内容。不幸的是，这还不足以满足 XHTML。除非正确转义，否则 XML 中有许多无效符号，特别是包括：`&`、`<`和`>`.

值得庆幸的是，这也是使用以下`str_replace`方法的简单修复：

```
$raw = file_get_contents('path/to/file');
echo '<pre>';
echo str_replace($raw, array('>','<','&','%'), array('&gt;','&lt;','&amp;','&#37;'));
echo '</pre>'; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-29T21:16:47.620

`file()`返回包含文件行的数组。

如果您将那些没有胶水的内爆，则根本不会有换行符。

因此，要么使用未修改的内容`file_get_contents()`（它给你一个字符串），要么用换行符粘合内爆或

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-29T21:20:08.080

Peter Stuifzand 的想法是正确的，将第二个参数传递给 implode 函数，所以我不会解决这个问题。我要指出的是，您自己的`echo "<br></br>";`代码不会生成有效的 HTML。如果您正在编写 HTML 并想要 2 个换行符，请执行`echo "<br><br>";`；如果您正在执行 XHTML 并想要 2 个换行符，请执行`echo "<br/><br/>";`. 否则，如果您只需要 1 个换行符，则 HTML br 标记没有结束标记，因此`</br>`在任何一种情况下都不需要。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-10-13T06:18:18.923

将您的文本写入 .txt 文件并重定向到与该文件对应的 url

php示例代码

allow.txt 的内容是

```
Authorized=True
Duration=1
OutputAnalog=NO_PLAYBACK
OutputDigital=NO_PLAYBACK 
```

deny.txt 的内容是

```
Authorized=False
Duration=0
OutputAnalog=NO_PLAYBACK
OutputDigital=NO_PLAYBACK 
```

php文件的内容

```
<?php
$user = $_REQUEST['username'];
$pass = $_REQUEST['password'];
$contentId = $_REQUEST['contentId'];
ob_start(); // ensures anything dumped out will be caught

 // do stuff here
allowUrl = 'http://localhost/allow.txt'; // this can be set based on whatever
$denyUrl = 'http://localhost/deny.txt';
// clear out the output buffer
while (ob_get_status())
{
    ob_end_clean();
}

// no redirect
if($user == "xyz" && $pass == "xyz")
header( "Location: $allowUrl" );
else
header("Location: $denyUrl");
?> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-04-21T16:49:37.557

或者你可以把它放到这样的文本区域中：

```
<?
$file = 'file.txt';
$contents = file($file); 
$string = implode("",$contents); 
echo '<textarea readonly style="width:100%; height:200px;">';
echo $string;
echo "</textarea><br></br>";
?> 
```

但前提是你可以并且结果是正确的。

# iphone - 为核心数据应用提供基础数据？

> ID：928177
> 
> 赞同：14
> 
> 时间：2009-05-29T21:11:12.453
> 
> 标签：iphone, cocoa, cocoa-touch, core-data

我正在开发一个 Core Data 应用程序（适用于 iPhone 3.0，尽管我认为这在这里并没有什么不同），它需要附带一个充满数据的“入门”数据库。使用 SQLite，我只需让应用程序在首次启动时将填充的数据库从捆绑包中复制到应用程序的文档目录中，然后加载该数据库——所有信息都会随之而来，我们就可以开始了。但是对于 Core Data，我不确定是否可以将 Persistent 存储保存到 App 包并在 Core Data 开始执行它之前复制它。这会导致任何问题吗？有相当多的初始数据，所以我不想将它打包成另一种格式而不得不解析它。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-29T22:16:28.793

是的，您可以复制预填充的持久存储。

我创建了一个填充商店的 Mac 应用程序。它被复制到我的包中，并在开始时复制到 Docs 目录。这工作正常。有人告诉我，Core Data Books 示例是以相同的方式开发的。

请注意，这并不意味着您可以复制任何旧的 SQLite 文件。它必须是一个核心数据持久存储，尽管我认为你根据你的问题理解了这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-14T15:31:16.743

实际上有一个技巧：您必须使用“.sqlite”以外的扩展名命名要复制的文件，“.bin”可以。否则 Xcode 在构建阶段将文件复制到应用程序时会更改文件的内容，并且不会加载。

# regex - 匹配正则表达式中的重复子字符串

> ID：928179
> 
> 赞同：29
> 
> 时间：2009-05-29T21:11:53.887
> 
> 标签：regex

正则表达式是否可以基于同一正则表达式的其他部分进行匹配？

例如，无论字符是什么，我如何匹配以相同的 3 个字符序列开始和结束的行？

火柴：

```
abcabc
xyz abc xyz 
```

不匹配：

```
abc123 
```

未定义：（可以匹配或不匹配，以最简单的为准）

```
ababa
a 
```

理想情况下，我想要一些 perl 正则表达式风格的东西。如果那不可能，我很想知道是否有任何口味*可以*做到这一点。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-05-29T21:16:27.293

使用捕获组和反向引用。

```
/^(.{3}).*\1$/ 
```

`\1`指回与第一个捕获组的内容（的内容）匹配的任何内容`()`。大多数语言中的正则表达式都允许这样的事情。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-05-29T21:15:24.613

你需要[反向引用](http://www.regular-expressions.info/brackets.html#usebackrefinregex)。这个想法是为第一位使用捕获组，然后在尝试匹配最后一位时参考它。这是匹配一对 HTML 开始和结束标记的示例（来自前面给出的链接）：

> ```
> <([A-Z][A-Z0-9]*)\b[^>]*>.*?</\1> 
> ```
> 
> 此正则表达式仅包含一对括号，它们将匹配的字符串捕获`[A-Z][A-Z0-9]*`到第一个反向引用中。此反向引用与`\1`（反斜杠之一）一起重用。`/`before 它只是我们试图匹配的结束 HTML 标记中的正斜杠。

将此应用于您的案例：

```
/^(.{3}).*\1$/ 
```

（是的，这就是 Brian Carper 发布的正则表达式。没有那么多方法可以做到这一点。）

为了后人的缘故，一个详细的解释（如果它在你下面，请不要被侮辱）：

*   `^`匹配行的开头。
*   `(.{3})`抓取任何类型的三个字符并将它们保存在一个组中以供以后参考。
*   `.*`尽可能长时间地匹配任何东西。（你不在乎线路中间是什么。）
*   `\1`匹配在步骤 2 中捕获的组。
*   `$`匹配行尾。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-29T21:17:08.663

对于开头和结尾的相同字符：

```
/^(.{3}).*\1$/ 
```

这是一个[反向引用](http://www.regular-expressions.info/brackets.html)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-29T21:17:10.927

这有效：

```
my $test = 'abcabc';
print $test =~ m/^([a-z]{3}).*(\1)$/; 
```

为了匹配开头和结尾，您应该添加`^`和`$`锚点。

# .net - Click-Once 一遍又一遍地安装 .NET Framework

> ID：928196
> 
> 赞同：2
> 
> 时间：2009-05-29T21:16:28.587
> 
> 标签：.net, visual-studio, clickonce

从 Internet URL 启动“Click-Once”发布的应用程序时，我的计算机上不断弹出以下对话框窗口：

[Microsoft .NET Framework 安装] - 您要下载并安装 Microsoft .NET Framework 吗？

您尝试访问的内容需要 Microsoft .NET Framework。您想立即从 Microsoft 下载中心下载并安装它吗？

……

“Click-Once”每次都开始尝试安装 .NET Framework，即使我运行此安装，它也会继续尝试在后续“Click-Once”激活时安装 .NET Framework...

我希望应该可以手动修补一些系统注册表项来解决这个问题，但我不知道是哪些。

请告知如何解决此问题。

我知道有人问过这个问题，但目前还没有答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-29T21:22:52.833

您是否检查过 .Net Framework 1.1 的安装是否成功？如果由于某种原因在目标计算机上安装失败，则下次运行 ClickOnce 应用程序可能会尝试重新安装。

也有可能 1.1 框架只是处于糟糕的状态。手动删除框架并让 ClickOnce 在更干净的状态下重试可能会有所帮助。

*   控制面板
*   添加删除程序
*   点击 .Net Framework 1.1
*   选择卸载

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-29T21:27:09.660

我见过几个“虚假安装”，其中用户从来没有足够的权限来安装应用程序，尽管它似乎确实安装了。我们必须让他们的系统管理员使用更高权限的帐户安装它。

# c# - 遍历 C# 中的所有查询值

> ID：928203
> 
> 赞同：2
> 
> 时间：2009-05-29T21:18:14.497
> 
> 标签：c#, .net, asp.net

我试图在 C# 中迭代​​未知数量的查询值......并且找不到与 LINQ 无关的任何内容，我无法使用。有人有想法么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-09-23T18:47:18.137

使用 Request.QueryString 为您提供了一个可以迭代的集合。使用 Request.QueryString.Allkeys 允许您遍历表示查询字符串中所有键的字符串集合。使用这个我们可以想出类似下面的代码来遍历所有键并获取它们的值。

```
foreach (string key in Request.QueryString.AllKeys)
{
    Response.Write("Key: " + key + " Value: " + Request.QueryString[key]);
} 
```

希望这有帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-29T21:35:07.927

如果这个问题是关于在 ASP.NET 中获取查询字符串，我认为您正在搜索的链接是：

[http://msdn.microsoft.com/en-us/library/system.web.httprequest.querystring.aspx](http://msdn.microsoft.com/en-us/library/system.web.httprequest.querystring.aspx)

本质上，`Request.QueryString`为您提供了一个集合，然后您可以对其进行迭代。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-29T21:39:43.737

如果集合实现了 IEnumerable，您可以使用 foreach，否则使用带有集合的 .Length 的 for 循环。

# silverlight - Silverlight 列表框中的自动滚动

> ID：928204
> 
> 赞同：14
> 
> 时间：2009-05-29T21:18:49.440
> 
> 标签：silverlight, listbox

如何以编程方式强制silverlight 列表框滚动到底部，以便添加的最后一项始终可见。

我试过简单地选择项目。它最终被选中但仍然不可见，除非您手动滚动到它。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-30T02:08:15.050

使用 ListBox 的 ScrollIntoView 方法传入最后一项。您可能需要在它工作之前立即调用 UpdateLayout。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-11-21T13:52:51.903

ScrollIntoView() 方法会将最后一项滚动到视图中，但是 listBox.UpdateLayout() 必须在 ScrollIntoView() 之前调用。这是一个带有代码的完整方法：

```
 // note that I am programming Silverlight on Windows Phone 7

    public void AddItemAndScrollToBottom(string message)
    {
        string timestamp = DateTime.Now.ToString("mm:ss");
        var item = new ListBoxItem();
        item.Content = string.Format("{0} {1}", timestamp, message);
        // note that when I added a string directly to the listbox, and tried to call ScrollIntoView() it did not work, but when I add the string to a ListBoxItem first, that worked great
        listBoxEvents.Items.Add(item);

        if (listBoxEvents.Items.Count > 0)
        {
            listBoxEvents.UpdateLayout();
            var itemLast = (ListBoxItem)listBoxEvents.Items[listBoxEvents.Items.Count - 1];
            listBoxEvents.UpdateLayout();
            listBoxEvents.ScrollIntoView(itemLast);
        }
    } 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-06-08T16:38:15.233

稍微重构以减少代码行数：

```
 listBoxEvents.Add(item)
 listBoxEvents.UpdateLayout()
 listBoxEvents.ScrollIntoView(listBoxEvents.Items(listBoxEvents.Items.Count - 1)) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-17T16:51:59.713

刚刚经历了这个，上面的解决方案都没有在 Silverlight 5 应用程序中工作。解决方案原来是这样的：

```
 public void ScrollSelectedItemIntoView(object item)
 {
      if (item != null)
      {                
          FrameworkElement frameworkElement = listbox.ItemContainerGenerator.ContainerFromItem(item) as FrameworkElement;
          if (frameworkElement != null)
          {
              var scrollHost = listbox.GetScrollHost();                    
              scrollHost.ScrollIntoView(frameworkElement);
          }
      }                
 } 
```

# c# - 在 EventHandler 中访问 RepeaterItem 控件

> ID：928208
> 
> 赞同：2
> 
> 时间：2009-05-29T21:19:48.863
> 
> 标签：c#, asp.net

我有一个带有中继器的页面。我正在编写一个事件处理程序，以便当用户单击我的 WebControl 按钮时，所述按钮的事件处理程序使用 FindControl 遍历转发器中的项目，然后使用一些控件的值。不过，似乎在加载页面后，会填充中继器项目，但是当单击按钮将其发布回来时，当我遍历中继器项目时，我看到它们都是空的。我不完全理解排序，但我假设这是因为我的迭代代码试图访问尚未设置的 RepeaterItems。

中继器代码在我的 OnLoad 方法中。除此之外，我的事件处理程序在被点击后试图遍历这些项目。这基本上就是我想要做的：

```
protected void MyButton_Click(object sender, EventArgs e)
{
    foreach(RepeaterItem item in MyRepeater.Items)
    {
        MyLabel = (Label)item.FindControl("MyLabel");
    }
} 
```

该按钮位于转发器的 FooterTemplate 中。

```
<asp:Button runat="server" OnClick="SubmitChecklist_Click" cssclass="BlueSubmit" id="SubmitChecklist" text="Submit" /> 
```

提前致谢。

编辑：为了澄清，我得到的确切错误是 NullReferenceException，当我尝试做某事时，例如，Response.Write(MyLabel.Text)

编辑：在今天对其进行了更多研究之后，这就是我所理解的正在发生的事情：转发器在回发时是数据绑定的。然后，当我从生成的下拉列表中进行选择并点击我的按钮时，它会再次发回。此时，中继器再次数据绑定到它的初始值。因此，如果我必须回发以获取用户的选择，我该如何在按钮的事件处理程序中执行此操作，以便在该转发器再次获得数据绑定之前获取选定的值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-29T21:34:36.447

听起来，问题在于您可能在加载时将数据绑定到转发器，但没有首先检查以确保它不是回发。

例子：

1.  您请求页面。在负载火灾。您将数据绑定到转发器。
2.  您在 reapter 中操作数据，然后单击您的按钮
3.  页面通过回发刷新，触发 onload 事件。数据被反弹到您的中继器，并且之前输入的所有数据都已无效。
4.  onclick 事件被触发，您的代码尝试检索不再存在的值。

确保 onLoad 事件中的数据绑定代码嵌套在回发检查中

```
if (!Page.IsPostBack)
{
   Repeater.DataSource = Datatable;
   Repeater.DataBind();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T16:50:36.820

我见过同样的事情。我不明白为什么，但是直到所有事件都被触发后，数据才真正被绑定。我最终在班级级别提供了我的数据源，然后建立了索引。

```
private DataTable myTable;
protected void Page_Load(object sender, EventArgs e)
{
    //populate dataTable
    if (!IsPostBack)
    {
        //databind to repeater
    }
}

protected void Submit_Click(object sender, EventArgs e)
{
    foreach (RepeaterItem item in repeater1.Items)
    {
        DataRow row = myTable.Rows[item.ItemIndex];
    }
} 
```

理想的？当然不是，但它有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T17:19:44.600

我没有依赖 OnLoad 中的 IsPostBack，而是通过在用户选择第一个选项后将转发器的数据绑定放在事件处理程序中来分离所有不同的状态，而不是依赖 OnLoad 的 IsPostBack。这有点令人费解，但我认为这次我做对了。

# java - 如何关闭 com.sun.net.httpserver.HttpServer？

> ID：928211
> 
> 赞同：5
> 
> 时间：2009-05-29T21:21:37.313
> 
> 标签：java, jdk1.6, com.sun.net.httpserver

嵌入在 JDK 6 中的 Http Server 对开发 Web 服务有很大帮助，但是我遇到了一种情况，即我发布了一个 Endpoint，然后代码崩溃并让服务器继续运行。

一旦失去对嵌入式服务器的引用（或已发布的端点），如何关闭嵌入式服务器？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2010-05-26T22:29:12.377

我使用下面的代码来启动它

```
 this.httpServer = HttpServer.create(addr, 0);
    HttpContext context = this.httpServer.createContext("/", new DocumentProcessHandler());
    this.httpThreadPool = Executors.newFixedThreadPool(this.noOfThreads);
    this.httpServer.setExecutor(this.httpThreadPool);
    this.httpServer.start(); 
```

和下面的代码来阻止它

```
 this.httpServer.stop(1);
        this.httpThreadPool.shutdownNow(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T01:26:11.190

我以前从未使用过此服务器，也找不到任何好的文档。也许您已经想到了这些不太优雅的解决方案，但我只是想我会提到它们。

似乎 com.sun.net.httpserver.HttpServer 有一个名为 HttpServerImpl 的实现类。它有一个名为 stop() 的方法。

或者你可以在服务器套接字上找到正在监听的线程并调用interrupt()。

肖恩

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T09:13:24.987

那么，不丢失参考怎么样？当你说你的代码崩溃时，我假设你在某个地方遇到了异常。具体在哪里？因此，能够拦截此异常的人显然还需要对 HttpServer 的引用，您可能必须自己传递它。

**编辑**：哦。在这种情况下，如果您不想杀死包含 HttpServer 的整个 JVM，那么您将需要为环境提供某种形式的 IPC，例如可以从 Java 程序调用的通过 RMI 的命令通道（以及因此蚂蚁）。

另一种解决方案是让服务器侦听一些“秘密”cookie 查询，例如在启动时打印/保存 cookie，以便 Ant 脚本可以检索 cookie，并且您可以触发对“秘密”URL 的查询服务器将在其上优雅地退出。

我会选择一个快速的 RMI 解决方案。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-30T04:54:11.563

```
netstat -a 
```

查找打开端口的进程的 pid（假设您知道端口），以及

```
kill -9 $pid 
```

杀死进程。

# c# - 对集合中的所有对象运行方法

> ID：928216
> 
> 赞同：0
> 
> 时间：2009-05-29T21:22:52.180
> 
> 标签：c#, vb.net, linq, .net-3.5, ienumerable

所以我有一个从 Bloops 集合创建的 Razzies 集合。我使用 Linq 查询检索此集合。参考：[Linq 将某些属性选择到另一个对象中？](https://stackoverflow.com/questions/923238/linq-select-certain-properties-into-another-object)用于查询。

我想知道是否可以在返回集合之前，甚至在返回集合之后，在所有新创建的 Razzies 上运行一个方法，而无需使用 for 循环。

我试过这个：

```
Dim results = From item In bloops _
              Select New Razzie() With _
              { _
                  .FirstName = item.FirstName, _
                  .LastName = item.LastName _
              }.UpdateAddress(item.Address) 
```

但它什么也不返回。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-29T21:45:55.860

拉斯，这可能会做你想要的。这是一个非常简单的方法。如果这不是您想要的，请扩大您的问题。

当您枚举它们时，这将在每个元素上运行该方法。在您枚举之前它**不会**运行该方法，但您可以放心地知道该方法**将**在您使用数据之前运行。

**编辑**由于您使用的是密封的第 3 方类，请使用扩展方法。这就是他们的目的。;) 修改代码以使用扩展方法。

```
class MyArgs { }
class Razzie //pretend this is a 3rd party class that we can't edit
{
    public string FirstName { get; set; }
    public string LastName { get; set; }
}
static class RazzieExtensions
{
    public static Razzie MyMethod(this Razzie razzie, MyArgs args)
    {
        razzie.FirstName = razzie.FirstName.ToUpper();
        return razzie;
    }
}
class Program
{
    static void Main(string[] args)
    {
        var bloops = new List<Razzie>
            {
                new Razzie{FirstName = "name"},
                new Razzie{FirstName = "nAmE"}
            };
        var myArgs = new MyArgs();
        var results = from item in bloops
                      select new Razzie
                      {
                          FirstName = item.FirstName,
                          LastName = item.LastName
                      }.MyMethod(myArgs);

        foreach (var r in results)
            Console.WriteLine(r.FirstName);
        Console.ReadKey();
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-29T21:31:27.403

在初始处理后使用 foreach 循环是执行此操作的正常方法。如果您不想使用 foreach 循环，则需要定义自己的扩展方法来处理这种情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-29T21:25:50.380

我不确定你所说的 RunVoid 是什么意思。Void 建议没有返回，但您将结果分配给一个值。

您是否 RunVoid 对每个项目执行一个方法，然后返回原始集合？如果是这样，则没有内置方法，但您可以像这样添加一个。

```
<Extension>
Public Function RunVoid(Of T)(source As IEnumerable(Of T), del As Action(Of T) As IEnumerable(Of T)
  For Each cur in source
    del(cur)
  Next
  return source
End Function 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-29T22:08:31.760

为什么不以正常的、未经评估的方式这样做呢？你可以用扩展方法做很多花哨的事情......但是你可能会通过使用扩展方法执行更新来打破纯度规则......这也让事情变得难以理解。试试这个：

```
var results = from ... select new { Address = item.Address, Razzie = new Razzie { ... }}

foreach (var result in results)
{
    result.Razzie.UpdateAddress(result.Address);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-29T22:12:03.407

如果您希望抽象出 foreach 循环，我只需为 IEnumerable<T> 编写一个扩展方法，该方法复制 List<T> 的 ConvertAll 和 ForEach 方法，如下所示：

```
public static IEnumerable<TOutput> ConvertAll<T, TOutput>(this IEnumerable<T> collection, Converter<T, TOutput> converter)
{
    if (converter == null)
        throw new ArgumentNullException("converter");

    List<TOutput> list = new List<TOutput>();

    foreach (T item in collection)
    {
        list.Add(converter(item));
    }

    return list;
}

public static void ForEach<T>(this IEnumerable<T> collection, Action<T> action)
{
    foreach (T item in collection)
    {
        action(item);
    }
} 
```

然后你可以调用类似的东西：

```
bloops
    .ConvertAll(bloop => new Razzie()
                            { 
                                FirstName = bloop.FirstName, 
                                Lastname = bloop.LastName 
                            })
    .ForEach(razzie => razzie.UpdateAddress()); 
```

# c# - 可序列化的部分类

> ID：928219
> 
> 赞同：7
> 
> 时间：2009-05-29T21:23:37.077
> 
> 标签：c#, .net, asp.net, vb.net, partial-classes

我有以下 VB.NET 类定义：

```
<Serializable()> Partial Public Class Customers
End Class 
```

在另一个文件中我有同样的东西（当然有不同的方法和变量）。当我编译时，我收到以下错误：

不能多次应用属性“SerializableAttribute”。

该错误是不言自明的。我的问题是，如果我只是将一个类标记为 Serializable()，我可以假设整个类都被标记为 Serializable() 吗？换句话说，我只需要在课堂上的 1 个位置使用 serializable() 标记吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-29T21:28:13.853

您只需要为每个班级标记一次，因此在具有多个“部分”定义的班级中，您应该将其从所有其他文件中删除。整个“部分”的东西只是一种可视化代码的方式，所以当你应用它一次时，它将适用于*整个*班级。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-29T21:29:50.450

是的，您只需要将它放在部分类之一中：http:
[//msdn.microsoft.com/en-us/library/wa80x488.aspx](http://msdn.microsoft.com/en-us/library/wa80x488.aspx)

> 在编译时，部分类型定义的属性被合并。

# c# - .NET Web 应用程序上的自定义命名空间

> ID：928220
> 
> 赞同：0
> 
> 时间：2009-05-29T21:24:19.367
> 
> 标签：c#, asp.net, visual-studio, buildaction

所以我写了一些自定义类并将它们全部放在一个命名空间中，称之为“Sphere”。

在我的 aspx.cs 代码隐藏文件中，我有“使用 Sphere；” 书面。我知道这行得通，因为在我将此项目复制到新文件夹之前，它一直有效。此外，即使我单击“在 Web 浏览器中查看”，一切正常。

简单地说，Visual Studio 08 无法识别命名空间，因此我无法在没有错误的情况下构建，因此无法调试。谢谢您的帮助！

编辑：我的命名空间在 .cs 文件的 App_Code 文件夹中

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-29T21:28:38.720

您的自定义类是否在单独的项目中？如果是这样，您可能需要添加对该项目的引用。如果您已将项目复制到新文件夹，则 VS2008 中 Sphere DLL/项目的路径可能会损坏。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-29T21:40:24.157

我实际上只是想通了：

我的 .cs 文件设置为“构建操作：内容”而不是“编译”。我右键单击 + 属性我的所有文件并更改了构建操作，现在一切正常！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-29T21:31:03.270

听起来当您移动文件时引用已损坏。如果球体类位于单独的 dll 中，请尝试删除并重新添加引用。如果它只是在 .de 文件中，请确保项目中的文件仍在相对路径中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-29T21:29:22.337

检查您的参考资料。移动应用程序的文件夹后，VS 可能不再找到它们。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-29T21:29:28.703

听起来像缺少参考。

在您的新项目中，您是否引用了定义实际 Sphere 命名空间的项目？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-03-04T14:16:24.850

可能你得到了这个错误：

> 找不到类型或命名空间名称“CustomClass”（您是否缺少 using 指令或程序集引用？）

该类型不在程序集中的原因是**App_Code**文件夹是**Web Site Projects**的特定文件夹。这些文件在部署到服务器时在运行时编译，而不是在您构建项目时编译。在**Web 应用程序项目**中，每个文件都有 Build Action 属性。默认情况下，类文件的值为 Compile。但是如果类是在 App_Code 文件中创建的，它会获得值 Content。并且在作为应用程序运行时不会被编译。
最后 App_Code 文件夹不打算在 Web 应用程序中使用。或者如您所见，您可以手动将 Build Action 更改为 Compile。

我通过搜索这些链接找到了答案：

1.  [Vishal Joshi 的 Tangent - App_Code 文件夹不适用于 Web 应用程序项目 (WAP)](http://vishaljoshi.blogspot.co.at/2009/07/appcode-folder-doesnt-work-with-web.html "乔希")

2.  [App_Code 文件夹内的类文件的 Build Action" 属性设置为 "Content"](http://forums.asp.net/t/1847714.aspx?+Build+Action+property+set+to+Content+for+class+files+inside+App_Code+folder "网")

# ajax - yui 数据表错误

> ID：928222
> 
> 赞同：0
> 
> 时间：2009-05-29T21:24:47.370
> 
> 标签：ajax, json, yui, yui-datatable

我在 DataTable 中插入 json 数据时遇到问题。这是服务器发送的 json 数据示例：

```
{"geneItemList":"{"col":"symbol","qv":"cd4","limit":"-1","start":"0","geneid":"920","name":"CD4"
,"symbol":"CD4","lastupdated":"2009-05-20 10:01:52.0","lastmodified":"2009-05-20 11:12:37.0"}
,... 
```

这里是我的 YUI 代码：

```
 <script type="text/javascript">
    YAHOO.namespace("local");
    var qct = YAHOO.local;

        YAHOO.util.Event.addListener(window, "load", function() {
            qct.RowSelection = function() {
                var myColumnDefs = [
                    {key:"geneid", label:"Gene", formatter: "number", sortable:true},
                    {key:"name", label:"Name", sortable:true},
                    {key:"symbol", label:"Symbol", sortable:true},
                    {key:"lastupdated", label:"Last Updated", formatter:"date", sortable:true},
                    {key:"lastmodified", label:"Last Modified", formatter:"date", sortable:true}
                ];

                var myDataSource = new YAHOO.util.DataSource("qct-list.html");
                myDataSource.responseType = YAHOO.util.DataSource.TYPE_JSON;
                myDataSource.connXhrMode = "queueRequests";
                myDataSource.responseSchema = {
                    resultsList: "geneItemList",
                    fields: [{key:"col", parser:"string"},
                             {key:"qv", parser:"string"},
                             {key:"limit", parser:"number"},
                             {key:"start", parser:"number"},
                             {key:"geneid", parser:"number"},
                             {key:"name", parser:"string"},
                             {key:"symbol", parser:"string"},
                             {key:"lastupdated", parser:"date"},
                             {key:"lastmodified", parser:"date"}]
                };

                // test this
                var myGeneListTable = new YAHOO.widget.DataTable("geneListTable", myColumnDefs, myDataSource,
                {initialRequest:"?col=<c:out value="${fieldName}"/>&qv=<c:out value="${queryValue}"/>&start=<c:out value="${start}"/>&limit=<c:out value="${limit}"/>", selectionMode:"single"});
etc... 
```

当我测试我的页面时，出现“数据错误”。在我的数据表中！

一个想法有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T20:24:27.693

我找到了解决我的问题的方法。这是json的错误！

**坏的 ：**

```
{"geneItemList":"{"col":"symbol","qv":"cd4","limit":"-1","start":"0","geneid":"920","name":"CD4"
,"symbol":"CD4","lastupdated":"2009-05-20 10:01:52.0","lastmodified":"2009-05-20 11:12:37.0"}
,... 
```

**好的 ：**

```
{"geneItemList":**[**{"col":"symbol","qv":"cd4","limit":"-1","start":"0","geneid":"920","name":"CD4"
,"symbol":"CD4","lastupdated":"2009-05-20 10:01:52.0","lastmodified":"2009-05-20 11:12:37.0"}
,...}**]**
} 
```

这只是一个语法问题！如果 YUI DataTable 出现“数据错误”，首先要做的是查看来自服务器的 JSON 响应。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-13T15:33:34.180

一些工具可以帮助调试您的 JSON！

您可以使用： http: [//www.jsonlint.com/](http://www.jsonlint.com/)（跟踪您的错误）

语法帮助：[http ://en.wikipedia.org/wiki/JSON](http://en.wikipedia.org/wiki/JSON)

另一个提示，是在测试新脚本时使用 yui 调试模式。

例如：.../json-debug.js

# ide - 用于扩展片段的标准 IDE/编辑器格式？

> ID：928223
> 
> 赞同：0
> 
> 时间：2009-05-29T21:25:18.617
> 
> 标签：ide, plugins, editor

是否有跨编辑器和 IDE 的任何标准来扩展片段？

具体来说，我想为 API 编写一个补丁，该补丁将提供一个代码片段数据库，该数据库可以导入不同的编辑器/IDE 并按需扩展。

我正在为 vim 写一些东西（我选择的编辑器）

```
:expand theme_some_function 
```

然后会插入

```
/**
 * Override of theme_some_function($&arg)
 **/
MYMODULE_some_function(&$arg1) { 
  // contents of the function go here
} 
```

这就是您在 Drupal 中覆盖函数的方式。

最初我写这个是为了让它通过 ctags 找到文件并复制函数和 s/foo/bar/ 需要更改的内容。有人建议我可以将此扩展到其他编辑器，所以我想知道是否有我可以使用的标准。

但总的来说，有没有一种编辑器标准可以让我想到有机会同时为许多编辑器写东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-29T21:55:27.323

实际上没有任何这样的编辑器标准，不。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T16:31:09.740

我没有找到任何这样的标准。但这里有几点可供探索。

• Microsoft 发布了基于 XML 格式的代码片段规范。

[代码片段架构参考](http://msdn.microsoft.com/en-us/library/ms171418.aspx)(Visual Studio 2012)

• Wikipedia 有[一篇关于代码片段的文章，](http://en.wikipedia.org/wiki/Snippet_%28programming%29)但没有提及标准。

• *Code Collector Pro*（Mac OS X 应用程序）的[此网页提到：](http://www.getcodecollector.com)

 *> 支持 .snippet 文件 – 适用于所有片段管理器的新通用文件格式

…但没有提供有关这种格式的信息或链接。

# opengl - OpenGL中的CLOD Planet宽纹理

> ID：928233
> 
> 赞同：11
> 
> 时间：2009-05-29T21:28:11.340
> 
> 标签：opengl

我正在使用 ROAM（连续细节级别）完成一个 3D 星球。

我现在的目标是使用纹理进行高质量的渲染。

我正在尝试找到一种可以使用平铺系统的方法（结合小的好的纹理），但在某种程度上我可以利用我的 CLOD 网格。

使用这种平铺系统的当前算法（根据我的发现）会产生巨大的纹理，然后直接应用它。那不是我想要的……这个星球很大，我想要的不仅仅是增加纹理大小。

这种东西是否有任何已知的算法/opengl 功能？

我对着色器了解不多，但是是否可以创建一个单独绘制对象的着色器...我的意思是，不给出 texcoords，而是为网格的每个像素（而不是顶点）设置正确的颜色？

PS：我的世界是使用柏林噪声构建的......所以我可以得到任何世界点的高度（无限分辨率的高度图）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-30T01:43:00.907

您已经为地形使用了 3D Perlin 噪声，为什么不同时生成纹理呢？通常，像 Terragen、Vistapro 等程序使用高度从调色板中随机选择一个颜色范围，根据坡度修改该颜色，并可能根据坡度和高度从较小的纹理中添加细节。在您的情况下，距离也可以修改细节。就此而言，2d perlin 噪声对于细节纹理效果很好。

你有没有修改过高度图？使用纯 3d Perlin 噪声很难实现类似海洋的效果，但是将低于特定高度的所有内容展平并应用良好的算法海洋纹理（适当调整 2d Perlin 噪声，透明度低于一定水平）看起来不错。

# icons - 图标采购：做一个、买一个或找一个

> ID：928236
> 
> 赞同：12
> 
> 时间：2009-05-29T21:28:28.220
> 
> 标签：icons

我为家庭和工作中的各种事情制作了许多简单的单一可执行应用程序。图标对我来说似乎总是一个问题，我不是设计师。像大多数人一样，我可以在这里和那里用 Photoshop、gimp 和paint.net 做一些事情。但是，如果事情需要看起来“好”，我不应该被信任。

问题是你如何处理那些只需要一些独特的小（通常是一天）项目的图标。没有什么华而不实的东西足以让用户将其与其用途相关联并在桌面上快速找到它。甚至像[**Gravatar**](http://en.gravatar.com/)分形图标这样的东西也是一个很好的起点。

我知道当被问及免费图标时，[**大量知识**](http://www.google.com/)会带来很多结果，但我想知道我的同行（和上级）开发人员在这种情况下做了什么。

如果它是你使用的图标制作软件，并且你是一个足够的设计师，它看起来并不糟糕，那很好，但对我来说可能不可行。

你买过图标吗？什么是有信誉的商业产品网站，你会避开哪里？

最后，在使用网上找到的免费图标时，您会注意哪些类型的许可证？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2010-09-23T03:46:04.553

首先，免责声明 - 我不是应用程序开发人员，而是（业余，从技术上讲，因为我没有为此获得报酬）网页设计师/开发人员。我在我的项目中使用了*很多*图标，但由于我的预算为 0.00 美元，所以我从互联网上获得了相当多的图标集合，所以我觉得我应该对这件事有发言权。

* * *

**自动生成你的图标**

自动生成的图标对我来说是一个很大的禁忌。除非您的应用程序是分形生成器，否则生成的图标通常不适合应用程序。你最好坚持平原![Windows 应用程序图标](https://i.stack.imgur.com/plLK6.png)或者![Windows 批处理文件图标](https://i.stack.imgur.com/QBodM.png)如果你正在使用它。

**免费图标**

如果您不需要太花哨的东西，免费图标非常好。您没有提及这些项目是否具有商业性质，因为合法性是决定您可以使用什么的重要因素。还要记住，在 Vista/Windows 7 中，图标可以大到 256x256 - 这种尺寸的图标通常不适用于免费图标。

在合法性方面，为商业软件使用免费图标的选项比免费软件/FOSS 项目要少得多。仔细查看许可证：[Creative Commons![知识共享图标](https://i.creativecommons.org/l/by-nc-sa/3.0/80x15.png)](http://creativecommons.org/)是当今相当流行的选择，但还有其他选择。通常需要注明出处，这通常意味着在“关于”部分或“README”文件中确认它们。

**免费图标的来源**

就像我说的，我知道*很多*，但我觉得你应该先看看这些。

*   开源桌面图标项目。
    *   [Tango 桌面项目基础图标](http://tango.freedesktop.org/Tango_Icon_Library)（公共领域，署名首选）
    *   [水晶图标项目](http://everaldo.com/crystal/)(LGPL)
    *   [氢图标项目](http://deviantdark.deviantart.com/art/hydroxygen-iconset-100826865)(CCGNU/GPL)
    *   [糖果桌面项目](http://jonian.deviantart.com/art/Candy-Icon-Theme-1-0-beta-166521186)(GPL)
*   突出的图标集^*
    *   [FamFamFam 丝绸](http://www.famfamfam.com/lab/icons/silk/)（CC-by 2.5）
    *   [Buuf 图标集](http://mattahan.deviantart.com/art/Buuf-37966044)（CC-by-sa-nc 3.0）
    *   [赋格图标](http://p.yusukekamiyamane.com/)（CC-by 3.0）
*   来源
    *   [图标存档](http://www.iconarchive.com/)
    *   [越轨艺术](http://browse.deviantart.com/customization/icons/os/)

**设计你自己的**

好吧，如果不实际查看您的图标，我不能说这些图标有多好，但有一些事情需要记住，特别是 Microsoft 发布的[Windows 图标设计指南](http://msdn.microsoft.com/en-us/library/aa511280.aspx)。

[如果你想要一个完整的列表，那就太多了，但这些是好的]

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-29T21:43:46.647

[丝绸图标](http://www.famfamfam.com/lab/icons/silk/)是免费的：

> “Silk”是一个流畅、免费的图标集，包含超过 700 个 16×16 像素的图标，采用柔和的 PNG 格式。包含种类繁多的图标，您一定会找到令您心动的东西。一切都以 0.00 美元的低价出售。你不能说比这更公平。

还有鲜为人知的[Silk Companion 1](http://damieng.com/creative/icons/silk-companion-1-icons)和[Silk Companion II](http://www.cagintranet.com/archive/download-famfamfam-silk-companion-2-icon-pack/)，来自其他设计师的图标集，与 Silk 风格相同（通常基于）。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-30T08:06:27.260

我发现[GlyFX 图标集](http://www.glyfx.com)制作精良，物有所值。它们提供了大量的图标，包括 Windows XP 和现在的 Vista 风格。

他们还有一款名为“Iconbox”的产品，它基本上是为其他不坚持独占的客户定制的图标——所以他们也将这些图标卖给了感兴趣的开发者。

GlyFX 也做定制工作，如果你真的需要做一些事情，例如商业或半商业产品，以相当合理的速度（我上次检查过，无论如何）。

强烈推荐。

马克

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-29T21:37:36.173

lgpl 图标用于商业用途，gpl 似乎适用于其他一切。

gravatar 图标是一个很酷的主意。我想您只需要将它们转换为ico。

通常我只使用开发库中已经存在的东西。否则，有大量的桌面图标可供选择。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-30T08:06:39.880

我举办了一次[图标设计比赛](http://99designs.com/contests/18782)，奖金为 400 美元，为[我的程序](http://graphicdesignertoolbox.com/)设计了一个新图标。每个条目都需要大量的草图和反馈，而且几乎没有时间做其他事情。没有第二名的奖项，我认为这确实影响了人们花多少精力。

确保你有足够的时间来做这件事。确保有第一、二、三等奖。

回想起来......必须有另一种方法来制作一个好的图标。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-09-23T17:03:00.337

我发现[Yusuke](http://p.yusukekamiyamane.com/) Kamyamane的[Fugue](http://fugue-icons-src.googlecode.com/svn/trunk/all-preview.png)和[Diagona](http://p.yusukekamiyamane.com/icons/preview/diagona.png)图标集很有用。Fugue 集有 3000 个图标，Diagona 有 400 个。Fugue 提供了多种概念，其中有一些变体。

您可能还会发现[这个先前的问题](https://stackoverflow.com/questions/139944/where-can-one-find-free-software-icons-images)很有用。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-09-23T21:08:07.223

我喜欢[完美的图标](http://www.perfecticon.com/)图标套件。这些是付费图标，但非常便宜且质量很高。他们还将为您设计自定义图标，价格约为 15 美元。 [http://www.perfecticon.com/](http://www.perfecticon.com/)

# javascript - 如何在单独的文件中创建 javascript 库并将其“包含”在另一个文件中？

> ID：928237
> 
> 赞同：17
> 
> 时间：2009-05-29T21:28:37.363
> 
> 标签：javascript, include, wsh, windows-scripting

首先，一个警告。主脚本**不在网页中运行**。我将使用 Windows Script Host 在 Windows 中运行 .js 文件。

**问题：** 我想创建一个包含许多对象的javascript“库”，每个对象都有许多函数。我希望这个库随着时间的推移会变得相当大，并希望将它保存在一个单独的 javascript 文件中（我们称之为**Library.js**）。我想从另一个脚本（我们称之为**User.js**）访问**Library.js中的对象。**

 **本质上，我正在寻找类似于 C/C++“包含”范式的东西。

**无论如何在javascript中实现这个？（请记住，这不是基于网络的）**

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-29T21:45:04.443

[这个页面](http://msdn.microsoft.com/en-us/library/15x4407c(VS.85).aspx)是我能找到的最接近的。它讨论了 .wsf 文件，它允许您将多个脚本（可能用不同的语言编写）组合在一个文件中。

对于您的问题，它应该类似于：

**用户.wsf**

```
<job id="IncludeExample">
   <script language="JScript" src="library.js"/>
   <script language="JScript">
      <![CDATA[
      // use your library functions here
      ]]>
   </script>
</job> 
```

可能有更好的方法，但我不是 WSH 专家。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2011-04-29T17:45:28.747

我知道这是一个老问题，它已被回答和接受。

我了解 .WSF 文件及其工作原理；他们服务于目的。

但是，我还发现在 WSH 中运行的纯 .js 文件中进行“包含”很方便。这是我的解决方案。

```
 function includeFile (filename) {
        var fso = new ActiveXObject ("Scripting.FileSystemObject");
        var fileStream = fso.openTextFile (filename);
        var fileData = fileStream.readAll();
        fileStream.Close();
        eval(fileData);
    } 
```

定义了该实用程序函数后，我可以在 javascript 模块中执行此操作：

```
includeFile("externalFile1.js");
includeFile("externalFile2.js");
includeFile("etc.js"); 
```

...然后我可以调用任何函数或处理这些模块中定义的任何变量。

类似的技术适用于 .vbs 文件：
[如何在 VBScript 中包含一个通用文件（类似于 C #include）？](https://stackoverflow.com/questions/316166/how-do-i-include-a-common-file-in-vbscript-similar-to-c-include/316169#316169)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-29T21:50:33.683

您可以通过使用 Windows 脚本宿主而不是特定的 .js 或 .vbs 文件来实现您的目标。更多信息可以在[MSDN 站点](http://msdn.microsoft.com/en-us/library/15x4407c(VS.85).aspx)上找到。

从链接：

> Windows 脚本 (*.wsf) 文件是包含可扩展标记语言 (XML) 代码的文本文档。它包含了一些特性，可以为您提供更高的脚本编写灵活性。因为 Windows 脚本文件不是特定于引擎的，所以它们可以包含来自任何与 Windows 脚本兼容的脚本引擎的脚本。它们充当容器。

您可以使用与 .js 和 .vbs 文件相同的语法来调用文件：

> wscript.exe myScriptFile.wsf

更新：更正指出...

# excel - 使用 VBA 解析一列字符串

> ID：928244
> 
> 赞同：1
> 
> 时间：2009-05-29T21:29:45.067
> 
> 标签：excel, vba

我想在 Excel VBA 中解析字符串的单元格列，每个单元格包含以下内容：

```
2 '␂' 
```

我想将此单元格的内容更改为仅包含 2（或“字符串”之前的任何数字字符。解析此类信息的最简单方法是什么？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-29T21:43:20.360

如果您确定格式，请在 '（撇号）之前找到字符串并更改单元格值。假设您位于具有此值的单元格上，请使用以下 VBA 代码。

`activecell.text = mid(activecell.text, 1, instr(1, activecell.Text, "'")-1)`

它查找撇号并在它之前提取字符并将其放入当前单元格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-06-30T02:01:55.230

假设数字数据始终位于单元格的开头，您可以使用正则表达式查找字符串开头的任何连续数字，一旦遇到第一个非数字字符就停止。这是一个可以为您完成的功能，希望对您有所帮助。^ 代表单元格的开头， (\d+) 表示一个或多个数字字符， .* 表示后跟零个或多个字符。我假设您只需要一串数字，所以我让正则表达式只返回子匹配 0（第一个匹配）。

```
Function ExtractNumericData(ByVal text As String) As String

Application.ScreenUpdating = False
Dim allMatches As Object
Dim RE As Object
Set RE = CreateObject("vbscript.regexp")

RE.Pattern = "^(\d+).*"
RE.Global = True
Set allMatches = RE.Execute(text)
ExtractNumericData = allMatches.Item(0).submatches.Item(0)
Application.ScreenUpdating = True

End Function 
```

# php - 根据大小对图像进行排序和显示

> ID：928247
> 
> 赞同：2
> 
> 时间：2009-05-29T21:31:02.333
> 
> 标签：php, directory, image

```
<?php
foreach (glob("*.jpg") as $filename) {
    echo "$filename size " . filesize($filename) . "<br>";
    echo '<img src="'.$filename.'" height=150px><br>';
}
?> 
```

使用该代码，我可以显示文件夹中的所有图像

或者，我只想显示该 foreach 循环的第一张图像，如果没有图像，则显示默认图像

编辑所以

```
<?php
foreach (glob("*.jpg") as $filename) {
    $info = getimagesize($filename);
    if ($info[0] == $info[1]) {
        echo "$filename size " . filesize($filename) . "<br>";
        echo '<img src="'.$filename.'" height=150px><br>';
        break;
    }
}
?> 
```

如果它是一个盒子，就会给你一个图像，（感谢 schnaader）是的，但也应该包括接近盒子的图像，如何排序，这意味着如果高度除以宽度大于 1

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-29T21:34:40.033

您可以使用 break 仅显示第一张图像：

```
foreach (glob("*.jpg") as $filename) {
    echo "$filename size " . filesize($filename) . "<br>";
    echo '<img src="'.$filename.'" height=150px><br>';
    break;
} 
```

只打印满足特定尺寸的，使用[getimagesize](http://www.electrictoolbox.com/php-get-image-size/)并将宽度/高度与您想要的进行比较，所以基本上使用上面的代码，但在 foreach 循环内的行周围包裹一个 if。以下可以工作，但我没有长时间使用PHP，所以不要依赖它：

```
foreach (glob("*.jpg") as $filename) {
    $info = getimagesize($filename);
    if ($info[0] == $width_i_want) {
      if ($info[1] == $height_i_want) {
        echo "$filename size " . filesize($filename) . "<br>";
        echo '<img src="'.$filename.'" height=150px><br>';
        break;
      }
    }
} 
```

如果你想获得正方形大小的图像，请使用

```
if ($info[0] == $info[1]) {
  [...] 
```

编辑：要获得最接近正方形的图像，请尝试以下操作：

```
$record_ratio = 0;
foreach (glob("*.jpg") as $filename) {
    $info = getimagesize($filename);
    $ratio = $info[0] / $info[1];
    if (abs(1 - $ratio) < abs(1 - $record_ratio)) {
      $record_ratio = $ratio;
      $record_filename = $filename;
    }
    if (record_ratio == 1) break;
}
if ($record_ratio > 0) {
  echo '<img src="'.$record_filename.'" height=150px><br>';
} 
```

这种变化也可以为您提供按比率排序的图像或具有两个值之间的比率的图像（例如 0.75 <= ratio <= 1.25）。

# .net - 显示 DNN 堆栈跟踪？

> ID：928250
> 
> 赞同：2
> 
> 时间：2009-05-29T21:31:38.543
> 
> 标签：.net, dotnetnuke, legacy

我有一个旧版 DNN 站点，页面顶部显示一个错误，告诉我其中一个模块无法加载。*太好*了，但这并没有告诉我为什么模块没有加载。有没有人不幸使用 DotNetNuke 知道如何在模块爆炸时查看堆栈跟踪？我一直在寻找“不，真的……”按钮，但我还没有找到。

干杯，

-查尔斯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-30T19:05:21.607

当您未登录时，这是您将看到的唯一消息。我认为您需要成为主机用户才能在线查看错误消息，而不是模块，但作为管理员用户，您可以转到事件查看器（或日志查看器，取决于您的 DNN 版本）页面管理员菜单。

但是，由于您无法登录，因此您需要查看数据库中的该表，因为您无法访问该页面。该表称为 EventLog（如果您的站点使用对象限定符，该名称将有一个前缀）。

首先，尝试这样的查询：

```
SELECT * FROM EventLog ORDER BY LogCreateDate DESC 
```

您将主要查看 LogProperties 列，其中包含有关事件的 XML。其中一个节点将是堆栈跟踪。

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-29T21:50:04.387

管理员或主机菜单中有一个事件查看器。

# apache-flex - 如何摆脱空的 StyleProtoChain 对象引用？

> ID：928253
> 
> 赞同：0
> 
> 时间：2009-05-29T21:32:03.360
> 
> 标签：apache-flex, actionscript-3

这是错误：

```
    TypeError：错误 #1009：无法访问空对象引用的属性或方法。
        在 mx.styles::StyleProtoChain$/initProtoChainForUIComponentStyleName()[C:\autobuild\3.2.0\frameworks\projects\framework\src\mx\styles\StyleProtoChain.as:72]
        在 mx.core::UIComponent/ http://www.adobe.com/2006/flex/mx/internal::initProtoChain()[C :\autobuild\3.2.0\frameworks\projects\framework\src\mx\核心\UIComponent.as:7469]
        在 mx.core::UIComponent/regenerateStyleCache()[C:\autobuild\3.2.0\frameworks\projects\framework\src\mx\core\UIComponent.as:7690]
        在 mx.core::UIComponent/ http://www.adobe.com/2006/flex/mx/internal::addingChild ()[ C:\autobuild\3.2.0\frameworks\projects\framework\src\mx\核心\UIComponent.as:5239]
        在 mx.core::UIComponent/addChild()[C:\autobuild\3.2.0\frameworks\projects\framework\src\mx\core\UIComponent.as:4955]
        在 mx.controls.listClasses::ListBase/createChildren()[C:\autobuild\3.2.0\frameworks\projects\framework\src\mx\controls\listClasses\ListBase.as:3103]
        在 mx.core::UIComponent/initialize()[C:\autobuild\3.2.0\frameworks\projects\framework\src\mx\core\UIComponent.as:5370]
        在 mx.core::UIComponent/ http://www.adobe.com/2006/flex/mx/internal::childAdded()[C :\autobuild\3.2.0\frameworks\projects\framework\src\mx\核心\UIComponent.as:5267]
        在 mx.core::Container/ http://www.adobe.com/2006/flex/mx/internal::childAdded ()[ C:\autobuild\3.2.0\frameworks\projects\framework\src\mx\核心\容器.as:3305]
        在 mx.core::Container/addChildAt()[C:\autobuild\3.2.0\frameworks\projects\framework\src\mx\core\Container.as:2217]
        在 mx.core::Container/addChild()[C:\autobuild\3.2.0\frameworks\projects\framework\src\mx\core\Container.as:2140]
        在模型::MessageBoard()[C:\Documents and Settings\dbabbitt\My Documents\Flex Builder 3\ListExample\src\model\MessageBoard.as:56]
        在模型::MessageBoard$cinit()
        在 global$init()[C:\Documents and Settings\dbabbitt\My Documents\Flex Builder 3\ListExample\src\model\MessageBoard.as:7]
        在 main()[C:\Documents and Settings\dbabbitt\My Documents\Flex Builder 3\ListExample\src\main.mxml:56]
        在 _main_mx_managers_SystemManager/create()
        在 mx.managers::SystemManager/initializeTopLevelWindow()[C:\autobuild\3.2.0\frameworks\projects\framework\src\mx\managers\SystemManager.as:3188]
        在 mx.managers::SystemManager/ http://www.adobe.com/2006/flex/mx/internal::docFrameHandler ()[ C:\autobuild\3.2.0\frameworks\projects\framework\src\mx\经理\SystemManager.as:3064]
        在 mx.managers::SystemManager/docFrameListener()[C:\autobuild\3.2.0\frameworks\projects\framework\src\mx\managers\SystemManager.as:2916]
```

这是 main.mxml：

```
    <?xml version="1.0"?>
    <mx:Application
        xmlns:mx="http://www.adobe.com/2006/mxml"
    >
        <mx:Script>
            <![CDATA[
                import model.MessageBoard;
                public var _messageBoard:MessageBoard = MessageBoard.instance;
            ]]>
        </mx:Script>
    </mx:Application>

```

这是 MessageBoard.as：

```
package model {
    import mx.containers.VBox;
    import mx.controls.Label;

    [Bindable]
    public class MessageBoard extends VBox {

        /** The message list title. */
        private var _messageTitle:Label;

        /** The maximum message count. */
        private var _maxMessageCount:int = 4;

        /** Storage for the singleton instance. */
        private static const _instance:MessageBoard = new MessageBoard( SingletonLock );

        /** Provides singleton access to the instance. */
        public static function get instance():MessageBoard {
            return _instance;
        }

        /**
         * Constructor
         * 
         * @param lock The Singleton lock class to pevent outside instantiation.
         */
        public function MessageBoard( lock:Class ) {
            super();

            // Verify that the lock is the correct class reference.
            if ( lock != SingletonLock ) {
                throw new Error( "Invalid Singleton access.  Use MessageBoard.instance." );
            }

            _messageTitle = new Label();
            _messageTitle.text = "Message Board";
            this.addChild(_messageTitle);
        }

    } // end class
} // end package

class SingletonLock {
} // end class 
```

也许你可以教我如何将空对象引用排除在复杂的类之外？

谢谢

戴夫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-29T21:48:57.587

看起来错误可能来自对 MessageBoard 类的构造函数中的 addChild() 方法的调用。您很可能在 UIComponent 生命周期中过早地调用此方法。我建议覆盖 createChildren() 方法并在那里添加您的子元素。

```
override protected function createChildren():void
{
    super.createChildren();
    _messageTitle = new Label();
    _messageTitle.text = "Message Board";
    this.addChildAt(_messageTitle, 0);
} 
```

# c# - C# 项目安装程序 - 用户设置保存在安装上下文中的什么位置？

> ID：928256
> 
> 赞同：1
> 
> 时间：2009-05-29T21:32:49.133
> 
> 标签：c#, installation, properties.settings

我正在尝试在安装程序中设置一些用户配置。例如，我正在使用：

```
Properties.Settings.Default.mapURL = txtBoxMapURL.Text.Trim();
Properties.Settings.Default.Save(); 
```

在安装程序类调用的 Windows 窗体中。但是，在启动应用程序时，该设置不会持续存在。下次我尝试在安装程序中配置设置时，它会将正确的值读入文本框中。所以它将设置保存在某个地方，我只是很难弄清楚在哪里。

它没有保存在 C:\program files\[manufacturer]\[product]\[product].exe.config 中，也没有保存在 C:\Documents and Settings\[User]\Local Settings\Application Data\[Manufacturer ][产品].exe\user.config。

知道安装程序在哪里临时存储设置，有没有办法在安装过程中存储用户设置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-29T23:01:08.953

他们保存到的地方是 user.config ...检查： http: [//msdn.microsoft.com/en-us/library/aa730869 (VS.80).aspx](http://msdn.microsoft.com/en-us/library/aa730869(VS.80).aspx)

您的设置范围是“用户”而不是“应用程序” - 因为无法保存应用程序人员。

请检查一下：[如何在安装时设置应用程序设置（通过安装程序类）](https://stackoverflow.com/questions/523619/how-can-i-set-application-settings-at-install-time-via-installer-class) ......似乎是一个类似的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T00:36:40.323

user.config 文件正在从安装程序中更新，但它正在从以下位置保存和读取配置（针对我的特定应用程序）：

C:\Documents and Settings\Long\Local Settings\Application Data\Microsoft_Corporation\DefaultDomain_Path_w551cn​​aciyzcylzfdpgyceaw05mmrhk0\3.1.4001.5512\user.config。

除非有另一种方法来更新正确的 user.config 文件，否则在应用程序首次启动时我将不得不运行 runonce 类型的东西。

# django - 在 Django 中，如何检索多对多相关类的字段？

> ID：928264
> 
> 赞同：14
> 
> 时间：2009-05-29T21:35:43.930
> 
> 标签：django

我有两个具有多对多关系的类。我想从第一个类中选择一个并访问相关类的字段。看起来这应该很容易。例如：

```
class Topping(models.Model):
  name = models.CharField(max_length=40)

class Pizza(models.Model):
  name = models.CharField(max_length=40)
  toppings = models.ManyToManyField(Topping) 
```

所以我想做类似的事情：

```
Pizza.objects.filter(name = 'Pizza 1')[0].toppings[0] 
```

但这对我不起作用。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-05-29T21:46:25.190

尝试：

```
Pizza.objects.filter(name = 'Pizza 1')[0].toppings.all()[0] 
```

它对我有用（不同的模型，但想法是一样的）：

```
>>> Affiliate.objects.filter(first_name = 'Paolo')[0]
<Affiliate: Paolo Bergantino>
>>> Affiliate.objects.filter(first_name = 'Paolo')[0].clients
<django.db.models.fields.related.ManyRelatedManager object at 0x015F9770>
>>> Affiliate.objects.filter(first_name = 'Paolo')[0].clients[0]
Traceback (most recent call last):
  File "<console>", line 1, in <module>
TypeError: 'ManyRelatedManager' object is unindexable
>>> Affiliate.objects.filter(first_name = 'Paolo')[0].clients.all()
[<Client: Bergantino, Amanda>]
>>> Affiliate.objects.filter(first_name = 'Paolo')[0].clients.all()[0]
<Client: Bergantino, Amanda> 
```

有关其工作原理的更多信息，[请查看文档](http://docs.djangoproject.com/en/dev/topics/db/queries/#related-objects)。

# applescript - Applescript 和 iCal 交互

> ID：928273
> 
> 赞同：3
> 
> 时间：2009-05-29T21:41:38.910
> 
> 标签：applescript, icalendar

我正在尝试编写一个 AppleScript 来查询 iCal 并在任何日历中查找给定日期的所有事件。

我首先编写了一个简单的脚本，它对给定日历中的每个事件执行一些简单的操作：

```
tell application "iCal"
  tell calendar "Reuniones"
    set the_events to every event
    repeat with an_event in the_events
        -- do something with every event
        set value to summary of an_event
    end repeat
   end tell
end tell 
```

然而，这个简单的脚本需要很长时间才能执行（几秒钟），即使我没有在循环内做任何复杂的事情。恐怕真正的脚本执行起来真的要花很多时间。

我对 Applescript 不是很熟悉，因此我想我正在做一些对性能有严重影响的愚蠢的事情。

谁能解释一下为什么这需要这么多才能执行？任何人都可以提出一些改进我的代码的建议吗？我现在要开始检查事件的日期，在循环中有一个条件。我怀疑必须有一种方法可以搜索带有日期的事件（就像 Automator 操作一样），但我一直无法找到一种“本地”的方式来做到这一点......

*编辑*：我正在使用 Mac OS X Tiger (10.4)。较新版本的 iCal 可能改进了可用的操作库。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-03-06T21:57:31.477

我今天一直在努力解决这个问题，发现您可以按日期过滤（至少在 Snow Leopard 上）。所以

```
tell application "iCal"
    set out to ""
    set todaysDate to current date
    set time of todaysDate to 0
    repeat with c in (every calendar)
        set theEvents to (every event of c whose start date ≥ todaysDate)
        repeat with current_event in theEvents
            set out to out & summary of current_event & "\n"
        end repeat
    end repeat
    return out
end tell 
```

与遍历所有事件相比，将返回所有未来事件的摘要，而且速度非常快。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-03-12T00:18:54.080

它不是 AppleScript，但最好的其他方法似乎是[iCalBuddy](http://hasseg.org/icalBuddy/ "icalBuddy")，它使用公共 Cocoa API，而不是直接解析日历文件并明智地处理重复事件。

`icalBuddy -nc -eed -iep title,datetime eventsToday+1`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-17T12:12:50.063

我最初的意图是仅选择给定日期的事件，但显然 iCal 中没有方法可以仅访问特定日期的事件。

因此，总是需要检查每个日历中注册的所有事件。即使对单个日历的事件感兴趣，比如“今天的会议”，也有必要查看整个事件集。

我在网上找到的最好的替代品不使用 Apple Script，而是处理实际存储信息的“ics”文件。

作为参考，这些文件位于“~/Library/ApplicationSupport/iCal”中。

# excel - 如何摆脱“无法清空剪贴板”错误？

> ID：928274
> 
> 赞同：8
> 
> 时间：2009-05-29T21:41:42.313
> 
> 标签：excel, excel-2007, clipboard

现在，我在 Excel 2007 中得到了它，但我在自 97 年以来使用的几乎每个版本的 Excel 中都遇到了相同的错误。唯一可辨别的相似之处是发生在我的办公室 PC 上。在我的家用电脑上从来没有打扰过我。

在 Excel 2003 中，我可以随意使用剪贴板选项，直到它消失。然而，在 2007 年，这些选择似乎受到了严重限制，而且通常毫无用处。谷歌也没有太大帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-12-10T19:46:08.473

检查这个提示。在这里工作 [http://mobeer.blogspot.com/2009/01/excel-2007-cannot-empty-clipboard.html](http://mobeer.blogspot.com/2009/01/excel-2007-cannot-empty-clipboard.html)：

> 如果谷歌接受它，这可能会节省一些时间和头痛。每次在 Excel 中移动单元格时，我都会收到“无法清空剪贴板”错误 - 最终我搞砸了设置并让它消失了。就是这样; 在 Excel 主菜单（带徽标的玻璃球）中，单击 Excel 选项，然后单击高级，然后关闭“显示粘贴选项按钮”
> 
> 作为我今年的第一篇文章，这有多令人兴奋？
> 
> 更新：我仍然没有找到永久的解决方案，但我发现了另一件事似乎有帮助。在 Excel 2007 中，在“主页”选项卡中，左侧的第一件事是剪贴板工具面板。展开面板以查看剪贴板，在剪贴板中您可能会发现“无法清空剪贴板”作为条目。清空剪贴板，保持面板打开一两秒钟，同时进行一些剪切和粘贴/拖动等操作，然后柏忌似乎消失了。
> 
> 我将其称为电缆舞，因为在过去，我有一台打印机，只有在拔下电缆、将其摇出并重新插入时才能工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-03-07T10:11:52.620

Paul Simon 和 Steve Homer 给出了很好的答案，我关闭了团队查看器，这就成功了。Skype 或其他程序可能会触发相同的故障，但在这种情况下，我回忆起当我尝试通过 Windows 右键单击​​从远程系统剪切和粘贴 2MB 文件时发生的问题，而不是使用“电视中的文件传输功能。错误消息出现了，然后是 Excel 的问题“'无法清空剪贴板'消息。

当您在远程系统上工作时会出现此问题。复制并粘贴大量数据后，它会显示错误。我已经找到了解决这个问题的方法。

转到远程系统任务管理器并执行以下任务

转到任务管理器>进程查找“rdpclip.exe”结束该进程

你的问题将得到解决。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-17T15:11:41.933

我复制了我在 excel 2007 文件中的图片（而不是文本），这为我解决了问题。图片复制到（然后是空的）剪贴板。即使在清除图片的剪贴板后，我也可以正常复制单元格。我认为图形对象也应该可以解决问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-07-05T05:00:32.073

如果找不到剪贴板，请关闭该 Excel 工作表并重新打开它。这将解决您的问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-29T21:49:47.040

我找到了这个建议：

> 有几个步骤可以解决您的问题：
> 
> 首先要做的是从 Office 剪贴板中清除项目。如果 Microsoft Office 剪贴板未显示在任务窗格中，单击编辑菜单上的 Office 剪贴板。在 Office 剪贴板任务窗格中，执行以下操作之一： 要清除所有项目，请单击全部清除 。
> 
> 接下来是关闭剪贴板显示选项。为此，您可以做的是再次显示剪贴板菜单（从编辑菜单中选择 Office 剪贴板）。然后在屏幕底部的选择按钮“选项”中，选择这个特定选项：“收集而不显示 Office 剪贴板”
> 
> 现在，您摆脱了这个错误。
> 
> 希望这可以帮助。

[在这里](http://www.excelforum.com/excel-miscellaneous/558931-cannot-empty-clipboard.html)。我有这个问题，但它是零星的。我只是尝试了这项技术，我没有发现问题，但由于它是零星的，我暂时不知道它是否会永远消失。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-02T17:44:48.583

追溯到 2005 年，我已经阅读了很多关于这个主题的博客！

我确信 Paul Simon 是对的（请参阅他对这个线程的提交），这是一个查找您机器上的哪个程序**锁定剪贴板的问题。**我不运行建议的各种解决方案中列出的程序（例如，在 Microsoft 网站上），我也不在网络或虚拟环境中，所以对我来说，这些不是锁定程序（但可能适合你）。同样，我的流程中没有 RDP 任务。对我来说，锁定程序是 Skype 插件。

我不是一个老练的用户，害怕改变我的注册表，所以不想去那里。

通过打开和关闭 Internet Explorer 中的 Skype 插件，我现在能够准确地重现“无法清除剪贴板”消息。这对业余爱好者来说很容易做到，并且可能是更常见的剪贴板锁定程序之一：

我首先确认我可以通过打开/关闭 Internet Explorer 来打开/关闭 Excel 中的问题。

然后我禁用了Skype插件：

Internet Explorer：工具菜单 --> Internet 选项；程序选项卡；管理加载项按钮；在左侧面板中选择的工具栏和扩展程序 - 向下滚动以查找 Skype 插件。按禁用按钮。

NB 在此工作之前必须重新启动 Internet Explorer。

.... 4 天后.... 它仍在工作

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-03-26T23:13:51.007

你在运行 Skype 吗？这是我发现摆脱 Excel 2007 和 2010 中的“无法清空剪贴板错误”的最佳解决方案。删除 IE 和/或 Firefox 中的 Skype 插件，再见烦人的错误！

回复 rjacobs7 2011 年 2 月 28 日的帖子

无法清除剪贴板错误 - Windows 7、Excel 2010 - 几乎每次尝试拖放单元格内容时都会发生此错误。在过去的 10 年里，我在旧电脑和旧版本的 Windows 和 Office 上遇到过同样的错误。现在，运行 Windows 7 64 位和 Office 2010 的新笔记本电脑再次出现此问题。只有在打开 Excel 的同时打开浏览器（IE 或 Firefox）时，才能复制此问题。除非同时打开浏览器，否则同时打开 Word 和/或 Outlook 不会导致问题发生。此错误非常烦人，Microsoft 或有关此问题的其他帖子没有解决它。

我有一个解决方案——至少对我来说！删除 IE 和 Firefox 中的 Skype 加载项，当 IE 和/或 Firefox 运行时，拖放后“无法清除剪贴板”错误消失。显然，Skype、Office 和浏览器存在某种内存管理问题。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-07-14T01:12:13.640

如果您在注册表中遵循 v12.0，请尝试[http://support.microsoft.com/kb/207438](http://support.microsoft.com/kb/207438) ，它将适用于 2007 年。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-07-04T11:01:13.697

我通过取消选中 Excel 选项中的“覆盖单元格之前发出警报”选项解决了这个问题。我正在使用 Excel 2007

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-04-29T23:17:46.240

我已经看到了各种答案，这些答案说当我卸载它或它起作用时。我认为卸载可能只是解决注册表中的问题，而不是正在卸载的特定应用程序的问题。

我也看到有人说要杀死 RDP 任务，但我没有，我仍然有错误。

我见过有人说在 Excel 中清除剪贴板，但这对我不起作用——更改剪贴板中的设置也不起作用。

我认为问题在于应用程序在剪贴板上有锁并且该应用程序没有释放它。剪贴板是一个共享资源，这意味着每个应用程序在更改它之前必须获得一个锁，然后在完成更改后释放锁，但是，有时锁似乎没有释放。

我发现以下治愈了它。关闭所有 MS 应用程序，包括 IE 和 Outlook。检查任务管理器进程以确保它们都消失了。

然后重新启动出现复制和粘贴问题的应用程序，它可能会工作。

问候

保罗·西蒙

# .net - 什么是类型安全？

> ID：928275
> 
> 赞同：9
> 
> 时间：2009-05-29T21:41:55.587
> 
> 标签：.net, testing, type-safety, brainbench

我最近参加了一次脑力测验，得到了高分，但有几个问题对我来说很难。也许是因为英语不是我的母语......问题之一是：

以下哪一项描述了类型安全？

1.  用于确保 CLR 中引用和值类型的安全性的编程构造
2.  防止因禁止非托管访问而导致的内存泄漏
3.  特定于 CLR 的功能保证类型不能访问它们自己的 AppDomain 之外的内存
4.  一种通过使用强名称键来保护程序集及其类型的机制
5.  处理保证分配的对象总是以兼容的方式访问的概念

我认为是 1 或 5，但它们对我来说听起来很奇怪:(

你怎么看？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-29T21:46:23.893

实际上我认为这是选择 5，因为类型安全与安全性无关。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-29T22:09:29.213

**Type Safety** is the feature of a language designed to make good on [Robin Milner][1]'s famous slogan about ML programming: *well-typed programs cannot go wrong*.

The slogan needs some unpacking before it can be properly understood, but it basically means that programs cannot fail because of a runtime type error, i.e. when the parameters applied to constructor or a function have values of incompatible type.

Consider a language that allows integers, integer functions as first class values, function abstraction and partial function application, and which defines the usual integer arithmetic operators as binary functions. The property of type safety is what the compiler enforces to ensure that both of the arguments to the addition operator are expressions that reduce to integers and not to functions. If a program is well-typed, then the compiler can emit an executable object for it. Otherwise, it flags the programming error and aborts.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-06T20:32:46.833

According to the msdn link provided below, [http://msdn.microsoft.com/en-us/library/hbzz1a9a.aspx](http://msdn.microsoft.com/en-us/library/hbzz1a9a.aspx)

Type-safe code accesses only the memory locations it is authorized to access. (For this discussion, type safety specifically refers to memory type safety and should not be confused with type safety in a broader respect.) For example, type-safe code cannot read values from another object's private fields. It accesses types only in well-defined, allowable ways.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-29T21:49:37.867

> 选项 5 处理保证分配的对象总是以兼容的方式访问的概念

类型安全涉及确保在创建 Foo 时不能将其视为 Bar。如果您不知道它是什么类型（或无法保证），那么您编写的代码可能无法按预期工作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-29T21:49:58.990

类型安全语言将确保（在编译时）您不会在类型上调用不兼容的方法，例如在 int 类型上调用 length()。非类型安全语言会在运行时解决。所以，选择5。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-29T22:45:57.597

As other have said, choice 5...

In general - for .NET, check out the Common Type System (CTS) which enables cross-language stuff and type safety.

Check out: [http://en.wikipedia.org/wiki/Type_safety](http://en.wikipedia.org/wiki/Type_safety) ...

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-29T21:51:05.007

It is option #5\. Type safety is an assurance, not a concrete thing. It is possible for .NET code to **not** be type safe...say in the case that an assembly uses unsafe code to perform unmanaged calls (PInvoke). During JIT, a process is performed that verifies the types being jitted are, indeed, type safe. I am not aware of any particulars about this process, but if a jitted type passes, then it is considerd verifiably type safe.

# php - 如何在 PHP 中使用 Session 和 Include 语句？

> ID：928283
> 
> 赞同：1
> 
> 时间：2009-05-29T21:43:21.263
> 
> 标签：php, session, logic

我有许多包含多个文件的文件，如下所示，

`File1`包含在`File2`，然后`File2`在`File3`

现在我想`site_user_conutry`从 File1 声明一个会话变量，然后我正在检查 File2，如果会话变量中没有任何值，那么只有我包含 File1.php

我已经添加`session_start();`了每个 [age 但仍然无法正常工作？？

请告诉我如何使会话在上述条件下工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-29T21:50:19.783

在 File2 内

```
if ($_SESSION["site_user_country"] != null) 
{
    include_once(File3);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-29T21:56:56.150

在第一行代码中只执行一次 session_start。

文档说：从版本 4.4.3 开始，在会话已经启动时调用 session_start() 将导致 E_NOTICE 级别的错误。此外，第二个会话开始将*被忽略*。

如果 file1 包含在 file2 中，则 file2 中的代码在 file1 之前完成。因此，如果您在 file1 中声明某些内容，则可能在 file2 中看不到（取决于代码...），无论如何这不是现代的 pf php 编程方式。（见 oo 和 __autoload）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-29T21:50:48.690

你如何设置会话变量？您应该尝试像这样设置它：

```
$_SESSION['site_user_conutry'] = 'United-Kingdom'; 
```

您是否将 session_start() 放在文档的最顶部，或者至少在输出任何信息之前？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-29T21:53:09.263

假设您包含具有代码执行而不是函数的文件。

在第一次迭代中，必须在 File2 上的代码之前执行包含 File1 并设置会话变量的代码。

在接下来的迭代中，会话将为您保存这些值。

要设置会话变量，请使用 $_SESSION 全局数组。

```
 $_SESSION["name"] = "value"; 
```

# ruby-on-rails - 通过实例变量将数据从控制器传递到视图，我做错了什么？

> ID：928285
> 
> 赞同：0
> 
> 时间：2009-05-29T21:43:51.933
> 
> 标签：ruby-on-rails

我正在尝试编写我的第一个自定义控制器操作并且遇到了 NoMethodError。

场景：PostsController，使用脚手架生成的标准 7 个动作。

我希望索引页面显示单个帖子，而不是显示它们的列表。每个帖子都有一个“可见”复选框。我在 Post 模型中创建了一个`named_scope`调用：`visible`

```
named_scope :visible, :conditions => ["visible =?", true] 
```

并将其与 .last 一起应用于我的控制器中的索引操作：

```
def index
  @post = Post.visible.last
  (format stuff)
end 
```

编辑我的索引视图以删除对数组部分的迭代，因此它只显示`@post.title`等。所以现在我的索引只显示 Posts 表中的最后一条记录，True 可见。

然后我想创建一个所有帖子存档页面，无论可见性如何都会显示所有帖子，所以我创建了一个新的控制器操作：

（*为清楚起见进行了编辑*）

```
def archives
  render :layout => 'posts'
  @posts = Post.find(:all)

  respond_to do |format|
    format.html
    format.xml { render :xml => @posts }
  end
end 
```

创建了一个新的命名路由：

```
map.archives 'posts/archives', :controller => 'posts', :action => 'archives' 
```

以及视图/帖子下方名为 archives.html.erb 的视图。

Archives.html.erb 看起来与脚手架创建的标准 index.html.erb 模板完全相同，带有

```
<% for post in @posts %>
  <tr>
    <td><%=h post.title %></td>
    ...
  </tr>
<% end %> 
```

当我在浏览器中查看此页面时，出现以下错误

**帖子中的 NoMethodError#archives**

当您没有预料到它时，您有一个 nil 对象，您可能期望一个 Array 的实例，在评估 nil.each 时发生错误，

指向视图中的行（app/views/posts/archives.html.erb），上面写着

```
<% for post in @posts %> 
```

所以我的理解是控制器动作中实例变量的数据`archives`没有传递到视图中，所以我得到的不是一组帖子，而是零。我正在寻找一个原因，以及我做错了什么。

（当然，如果我把

```
<% @posts = Post.find(:all) %> 
```

之前

```
<% for post in @posts %> 
```

在视图中，它工作得很好，但我知道这不是我应该做的。

非常感谢所有帮助，指向教程的链接以理顺我等。

（我怀疑这么简单的事情是否重要，但我使用的是 Rails 2.2.2 和 Ruby 1.8.6。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-30T06:26:20.970

这是对的：

```
 respond_to do |format|
    format.html { render :layout => 'posts' }
    format.xml { render :xml => @posts }
  end
end 
```

@posts 未被视图识别，因为它是在您呈现视图后实例化的。'render' 应该是动作中最后执行的行。

# perl - 使用 Perl Net::SSH::Perl 模块时如何修复“as_number 不是 Pari 函数名”

> ID：928286
> 
> 赞同：1
> 
> 时间：2009-05-29T21:44:02.553
> 
> 标签：perl

我在尝试通过 Net::SSH:Perl 在另一台 Linux 主机上运行命令时遇到了这个问题。这是确切的错误：

```
`as_number' is not a Pari function name  Line 1148.
 5.8.8/x86_64-linux-thread-multi/Math/Pari.pm 
```

我只找到了一篇相关的帖子，它表明它可能是某些 Perl 库之间的某种版本不匹配？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-29T23:35:16.547

请参阅这个问题：[如何修复 Math::BigInt 调用的 Math::Pari 中的“`as_number' 不是 Pari 函数名”？](https://stackoverflow.com/questions/418347).

# c# - 垃圾收集器是否清除订阅事件的对象？

> ID：928290
> 
> 赞同：5
> 
> 时间：2009-05-29T21:44:33.617
> 
> 标签：c#, memory-leaks, garbage-collection

如果我执行以下操作：

```
public class Test
{
    public static void Main()
    {
        List<Person> persons = new List<Person> { new Person() };

        persons[0].Sneezing += new EventHandler(Person_Sneezing);

        persons = null;
    }

    public static void Person_Sneezing(object sender, EventArgs e)
    {
        (sender as Person).CoverFace();
    }
} 
```

在 person[0] 中的人是否仍然存在于内存中，因为它的 Sneezing 委托引用了 Person_Sneezing 方法，还是被 GC 收集了？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-29T21:49:53.763

这将由 GC 收集。要保存在内存中，必须直接或间接引用对象...

1.  堆栈上的值
2.  植根于强大的 GC 句柄的值
3.  一两个极端案例我现在没有想到

对于persons[0] 处的对象，情况并非如此。所以会被收集。

这当然是假设 Person() 的构造函数没有做任何有趣的事情，比如将自身添加到 ThreadLocalStorage。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-29T22:00:50.993

你已经成功了一半；如果反过来，这将是内存泄漏*。* 也就是说，如果它看起来像这样：

```
public class Test
{
    public void HookupStuff()
    {
        List<Person> persons = new List<Person> { new Person() };

        this.EventHappened += new EventHandler(persons[0].SomeMethod);
        // persons[0].Sneezing += new EventHandler(Person_Sneezing);

        persons = null;
    }
} 
```

现在`persons[0]`会坚持下去，即使你 null out `persons`，因为父类有一个对它的方法的引用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-29T21:57:18.443

除了您已经得到的答案之外，您还需要在更实际的示例中小心。

如果您的应用程序有一个只要程序运行就一直存在的主窗口，并且您经常创建“短期”对象，这些对象将它们的方法用于主窗口上的事件，那么当您不再使用这些事件时，您必须从这些事件中删除对象需要它们，因为否则这些对象根本不会“短命”——它们将与主窗口一样长，即直到用户关闭应用程序。有效的结果将等同于内存泄漏。

如果您使短期对象的类实现它会有所帮助`IDisposable`，因此您可以从 中的事件中删除`Dispose`，然后确保在要丢弃对象时调用 dispose。

# ruby - 使用没有导轨的 ruby 进行 Web 开发？

> ID：928299
> 
> 赞同：10
> 
> 时间：2009-05-29T21:48:03.517
> 
> 标签：ruby

由于我无法控制的原因，我的任务是不使用 Rails 或任何其他重量级框架（如 Merb）的 Ruby Web 开发。我想知道是否有其他人遇到过这种情况并且可以推荐描述此类问题的最佳实践的最佳实践或资源。我想避免可怕的

```
 out.print('<td class="foo">'+some_data+'</td>') 
```

Web 开发风格。一位同事建议将 Rack 作为一个轻量级框架，但文档很粗略，而且在市场上似乎未经证实。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-29T21:50:23.153

看看[辛纳屈](http://www.sinatrarb.com/)。这是一个框架，但不是那么重。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-29T21:56:28.633

查看[Rack](http://rack.rubyforge.org/)和[Sinatra](http://www.sinatrarb.com/)或[Waves](http://rubywaves.com/)。机架在市场上并非未经证实。如今，Rails 构建在机架之上！它也不是一个框架，它允许框架专注于它们的差异化而不是低级别的繁忙工作。

您也可以直接使用 jruby 和 java servlet api。顺便说一句，所有基于机架的框架都可以轻松地在 jruby 上运行。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-29T22:04:20.020

Rack 与其说是一个应用程序框架，不如说是一个服务器接口。您可能希望在这个项目中使用它，但它不会解决您想要一个框架而不使用框架的问题。无论如何，如果你想“避免可怕`out.print('<td class="foo">'+some_data+'</td>')`的事情”，你至少必须使用模板系统。有很多可用的，例如 ERb（Rails 默认使用）和 Haml。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-29T23:52:49.647

和拉马兹一起去吧。我在生产中使用它，在 JRuby 和 Glassfish 上运行。

易于开发，坚如磐石的社区支持。没有杂物。像 Ruby 一样，它不会妨碍您。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-30T00:09:51.140

[我可以和所有推荐Sinatra](http://www.sinatrarb.com/)的人一起加入。它很紧凑，编写代码很有趣，它部署在[Rack](http://rack.rubyforge.org/)上，这意味着你真的可以让它在你最喜欢的任何堆栈中运行（Mongrel、FCGI、Thin、Passenger 等）

当我需要快速启动一个项目时，我试用了 Sinatra，它的扩展性和性能非常好，以至于我今天仍在使用它来处理每天超过 80,000 个繁重的请求。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-29T21:51:47.550

一如既往的好 ol' [cgi.rb](http://www.ruby-doc.org/stdlib/libdoc/cgi/rdoc/index.html)是可用的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-29T21:55:47.120

你看过[西纳特拉](http://www.sinatrarb.com/)吗？它是一个框架，但没有 Rails 重。我自己没有测试过，但它似乎很容易使用。

此外，[Ramaze](http://ramaze.net/)似乎很好且模块化，但不确定它是否是您想要的。

我不知道将 Ruby 直接用作 cgi 有多么容易，但也应该很可能将布局与代码分开。有很多 Gems 可以在不使用框架的情况下做到这一点。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-29T23:21:12.347

我个人的选择和推荐是[Ramaze——](http://ramaze.net)它尽可能简单，但并不简单。在不牺牲功率的情况下干净简洁。与您选择的 JS lib（jQuery、Prototype、Mootools）或 ORM（[Sequel](http://sequel.rubyforge.org/)、Datamapper、[M4DBI](http://purepistos.net/m4dbi)）或模板引擎配合得很好。另外，不要忘记像[nanoc](http://nanoc.stoneship.org/)这样的静态生成器。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-02-03T20:49:34.177

很有可能，我的整个网站都运行在纯红宝石上。

我没有遇到任何问题。我开始我的申请

```
require "mysql"                               # module | mysql
require "cgi"                                 # module | cgi
require "date" 
```

# asp.net - jQuery 和 ASP.NET 自定义验证器

> ID：928309
> 
> 赞同：0
> 
> 时间：2009-05-29T21:49:55.243
> 
> 标签：asp.net, jquery, validation

我正在尝试学习 jQuery，我突然想到，我的一些网站中的现有 JS 可以用几行 jQuery 代码替换。在下面的代码中，我试图通过进行 AJAX 调用来设置自定义验证器的值。第一个代码块不能正常工作，而第二个代码块工作正常。整个“如果它没有坏就不要修复它”的答案没有帮助，我真的很想学习 jQuery。作为记录，我在代码中放置了警报，它们都返回完全相同的结果，只有一个是设置参数，另一个不是出于某种原因。

为什么此代码不起作用：

```
 function CheckForUserName(sender, args)
{
    args.IsValid = true;

    var url = "/somepage.aspx";

    MakeCall(url, function(txt) {
    if (txt == "false") {
        args.IsValid = false;
    }
    });
}

function MakeCall(url,callback) { 
    $.ajax({
        url: url,
        dataType: "text",
        success: callback
    });
} 
```

此代码确实有效：

```
 function CheckForUserName(sender, args)
{
        args.IsValid = true;

        var call = MakeCall();
        if (call == "false")
        {
            args.IsValid = false;
        }

}

function MakeCall()
{ 
    var xmlHttp;
    var validation=true;

    xmlHttp=GetXmlHttpObject();
    if (xmlHttp==null)
    {
        alert ("Your browser does not support AJAX!");
        return;
    } 

    var url="/somepage.aspx";
    xmlHttp.onreadystatechange=function () 
    {
        if (xmlHttp.readyState==4)
        { 
            if (xmlHttp.status==200)
            {
                return xmlHttp.responseText;
            }
            else
            {
                alert(xmlHttp.status);
            }
        }
    };
    xmlHttp.open("GET",url,false);
    xmlHttp.send(null);
    return xmlHttp.responseText;
}

function GetXmlHttpObject()
{
var xmlHttp=null;
try
  {
  // Firefox, Opera 8.0+, Safari
  xmlHttp=new XMLHttpRequest();
  }
catch (e)
  {
  // Internet Explorer
  try
    {
    xmlHttp=new ActiveXObject("Msxml2.XMLHTTP");
    }
  catch (e)
    {
    xmlHttp=new ActiveXObject("Microsoft.XMLHTTP");
    }
  }
return xmlHttp;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-29T22:15:10.310

为了使其工作，您需要将 async 选项指定为 false：

```
function MakeCall(url,callback) { 
    $.ajax({
        async: false,
        url: url,
        dataType: "text",
        success: callback
    });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-12T15:40:33.880

这可行 fyi.. 忽略我的自定义 javascript 命名空间函数，但你应该明白这个概念。

```
<script type="text/javascript">
        function VerifyCustomerNumber(s, a) {
            var r = ProcessCustomerNumber(a.Value);
            a.IsValid = r;
        }
        function ProcessCustomerNumber(n) {
            var u = '/Services/WebServices/Customer.asmx/CountByCustomerNumber';
            var d = '{"Number": "' + n + '"}';
            $j.ajax({
                type: "POST",
                contentType: "application/json; charset=utf-8",
                url: u,
                cache: false,
                async: false,
                data: d,
                dataType: "json",
                success: function(r) {
                    var v = Data.JS.Ajax.ParseJSON(r);
                    return v;
                }
            });
        }
    </script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-16T04:18:02.870

只是为了记录。有一个允许 AJAX 调用的自定义验证器是可能的，但有点复杂。[这](http://jeydotc.github.io/blog/2014/05/15/ASP-CUSTOM-VALIDATOR-WITH-AJAX.html)是一篇关于这个问题的文章。

基本上，必须做这些事情：

1.  说“无效！” 立即地。
2.  显示“处理中...”消息而不是“无效”消息。
3.  开始您的长期流程，也就是您的 AJAX 请求。
4.  一旦您的请求结束，请将 ClientValidationFunction 替换为虚拟函数。
5.  重置原始消息。
6.  更新验证状态。
7.  重置原始验证功能，但仅在验证控件更改时。

这是完成任务的最终函数（摘自文章）：

```
//Create our respond functions...
var Respond_True = function (sender, args) { args.IsValid = true; };
var Respond_False = function (sender, args) { args.IsValid = false; };

function AjaxValidator(sender, args, ajaxSettings){
    args.IsValid = false;

    //This is a reference to our validator control
    var $sender = $(sender);

    //Save the original message, color and validation function to restore them later.
    var originalMessage = $sender.text();
    var originalColor = $sender.css("color");
    var originalFunction = sender.clientvalidationfunction;
    var validatedControl = $("#" + sender.controltovalidate);

    //Change the error message for a friendlier one.
    $sender.text("Checking...").css({ color: "black" });

    var setRespondFunction = function (respondFunction) {
        sender.clientvalidationfunction = respondFunction;

        //Reconstitute original styles.
        $sender.text(originalMessage).css({ color: originalColor });

        //Re-validate our control
        ValidatorValidate(sender, null, null);
        ValidatorUpdateIsValid();

        var onChange = function(){
            //Reset the original validation function
            sender.clientvalidationfunction = originalFunction;
            //Re-validate to ensure the original validation function gets called
            ValidatorValidate(sender, null, null);
            ValidatorUpdateIsValid();
            //Ensure the validation function is called just once.
            validatedControl.unbind("change", onChange);
        };
        validatedControl.on("change", onChange);
    }

    var originalSuccessFunction = ajaxSettings.success;
    //Start the AJAX call..
    $.ajax($.extend(ajaxSettings, {
        success: function(data){
            setRespondFunction(originalSuccessFunction(data) ? "Respond_True" : "Respond_False");
        }
    }));
} 
```

这是一个示例用法：

```
function MyJavascriptValidationFunctionName(sender, args){
    AjaxValidator(sender, args, {
        url: ...,
        type: ...,
        data: ...,
        success: function(data){
            return /*True or false*/;
        }
    });
} 
```

# sql - 从两列插入一列数据

> ID：928322
> 
> 赞同：1
> 
> 时间：2009-05-29T21:51:27.847
> 
> 标签：sql, sql-server, tsql, insert

```
Table A
Col1 Col2
101  102
101  103
102  104
104  105

Table B
Col1
101
102
103
104
105 
```

我想从表 A 中获取数据并将其作为一个查询中的不同值插入到表 B 中，所以`INSERT INTO TableB (Col1) (SELECT ...)`

有任何想法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-29T21:53:49.963

你应该能够做到：

```
 INSERT INTO TableB (Col1)
 (SELECT Col1 FROM TableA
  UNION
 SELECT Col2 FROM TableA) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-29T21:54:36.310

```
INSERT TABLEB (Col1)
SELECT Col1 FROM TABLEA
UNION SELECT COL2 FROM TABLEA 
```

对于不显着，`UNION ALL`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-29T21:56:07.820

您可以轻松地使用这样的两个查询：

```
INSERT INTO `TableB` (`Col1`)
SELECT `Col1` FROM `TableA`

INSERT IGNORE INTO `TableB` (`Col1`)
SELECT `Col2` FROM `TableA` 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-29T22:16:16.033

insert B (col1) SELECT distinct col1 from A union select distinct col2 from A;

# objective-c - 在理解目标 c 代码方面需要帮助

> ID：928325
> 
> 赞同：0
> 
> 时间：2009-05-29T21:53:10.697
> 
> 标签：objective-c

我需要一些帮助来理解以下代码：

1.  @“重新加载”中的'@'是什么意思

    button = MakeTestButton(&button_rect, @"Reload", content); [按钮设置目标：web_view]；[按钮 setAction:@selector(reload:)];

2.  我在哪里可以找到“@selector(reload:)”的定义？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-29T21:56:50.113

1.  字符串常量`@"some text"`在objective-c 中声明。这将创建一个`NSString`.
2.  我建议您阅读 Apple[关于选择器的文档](http://developer.apple.com/DOCUMENTATION/Cocoa/Conceptual/ObjectiveC/Articles/ocSelectors.html)。基本上，`@selector(reload:)`将获得一个指向将在对象接收到`reload:`消息时调用的方法的指针。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-29T22:02:28.323

1.  @ 符号向编译器表明该字符串是 NSString 而不是标准的“C”字符串。这是创建 NSString 对象的快捷方式。

2.  请参阅[Cocoa @selector 用法说明](https://stackoverflow.com/questions/543161/explanation-of-cocoa-selector-usage)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-29T21:57:53.763

`@selector`是语言中的内置原语。将`@selector(reload:)`其视为“方法的名称`reload:`”。它返回一个`SEL`，然后您可以将其传递给一个函数，然后使用它来调用该方法`reload:`。在您的代码上下文中，当您单击按钮时，该按钮将调用`[web_view reload:self]`.

在`@"Reload"`中，这`@`意味着它是一个`NSString`实例而不是一个`char const *`.

# python - 格式化字典中键的输出

> ID：928330
> 
> 赞同：1
> 
> 时间：2009-05-29T21:55:29.600
> 
> 标签：python, string, dictionary, python-3.x

我有一个字典，它存储一个字符串作为键，一个整数作为值。在我的输出中，我希望将键显示为不带括号或逗号的字符串。我该怎么做？

```
for f_name,f_loc in dict_func.items():
        print ('Function names:\n\n\t{0} -- {1} lines of code\n'.format(f_name, f_loc)) 
```

输出：

```
Enter the file name: test.txt
line = 'def count_loc(infile):'

There were 19 lines of code in "test.txt"

Function names:

    ('count_loc(infile)',) -- 15 lines of code 
```

以防万一不清楚，我希望输出的最后一行显示为：

```
count_loc(infile) -- 15 lines of code 
```

编辑

```
name = re.search(func_pattern, line).groups()
name = str(name) 
```

在我的输出之前使用 type() ，我验证它仍然是一个字符串，但输出与 name 是一个元组时一样

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-29T21:58:14.073

我没有 Python 3，所以我无法对此进行测试，但是 f_name 的输出使它看起来像是一个包含一个元素的元组。所以你会改变`.format(f_name, f_loc)`为`.format(f_name[0], f_loc)`

**编辑**：

作为对您的编辑的回应，请尝试使用[`.group()`](http://docs.python.org/library/re.html#re.MatchObject.group)而不是`.groups()`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-29T22:00:23.350

为了详细说明[彼得的答案](https://stackoverflow.com/questions/928330/formatting-the-output-of-a-key-from-a-dictionary/928340#928340)，在我看来，您正在分配一个单项[元组](http://docs.python.org/library/stdtypes.html#sequence-types-str-unicode-list-tuple-buffer-xrange)作为字典的键。如果您在某处计算括号中的表达式并将其用作键，请确保其中没有杂散的逗号。

查看您进一步编辑的答案，这确实是因为您正在使用正则表达式匹配的 groups() 方法。这将返回一个 元组`(the entire matched section + all the matched groups)`，并且由于您没有组，因此您想要整个事情。`group()`没有参数会给你。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-29T21:58:06.163

我希望您的解析代码有问题。所写的行应该按预期工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-29T22:17:34.877

由于键是某种类型的元组，您可能希望在打印之前加入不同的元素。我们无法从显示的代码段中真正分辨出密钥的重要性。

所以你可以做这样的事情：

```
.format(", ".join(f_name), f_loc) 
```

# colors - 无法根据终端在 .screenrc 中的支持设置颜色

> ID：928344
> 
> 赞同：3
> 
> 时间：2009-05-29T21:58:29.017
> 
> 标签：colors, terminal, gnu-screen

我想在**.screenrc**中为以下代码创建一个 if-else 循环，以便在我的终端支持 256 色时运行它。否则，它不会运行。

```
attrcolor b ".I"
# tell screen how to set colors. AB = background, AF=foreground
termcapinfo xterm "Co#256:AB=\E[48;5;%dm:AF=\E[38;5;%dm"
termcapinfo xterm-color "Co#256:AB=\E[48;5;%dm:AF=\E[38;5;%dm" 
```

**如何在 .screenrc 中创建 if-else 循环？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T03:11:06.890

这应该已经由 terminfo 数据库文件设置。就我而言，我的默认终端是 xterm。它使用 8 种颜色，通过使用

：设置术语上限

命令检查设置为 8 的 t_Co 项目。如果我将终端更改为另一个终端类型，如使用 256 色的 gnome-256color，那么 vi 将显示 t_Co 等于 256。我不确定你为什么需要尝试在你的 .vimrc 文件中设置它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-13T04:03:19.330

我相信如果你有 bash 可用，这样的事情应该可以工作：

```
#!/bin/bash
if [ "$TERM" = "xterm-256color" ]; then
    # do stuff for 256
else
    if [ "$TERM" = "xterm" ]; then
        # do stuff for 16
    else
        # do something else entirely
    fi
fi 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-31T01:16:43.167

**我对 .screenrc 的伪代码尝试**

```
[ -e t_Co(256) ] . ColorFile 
```

英文也一样

```
If 256 color support, then source ColorFile. 
```

# c# - 通过 C# 和 SMO 检查和删除现有表

> ID：928346
> 
> 赞同：6
> 
> 时间：2009-05-29T21:58:55.523
> 
> 标签：c#, smo

我正在尝试按名称查找 SQL 表，如果存在则删除它。这一切都需要在 C# 中使用 SMO 完成。

更复杂的是，该表还具有除“dbo”之外的模式。

最终，该表将通过 SMO 重新创建（我有这个工作），但我必须确保它不存在，然后才能重新创建它。

我看到的所有示例似乎都是在同一上下文中创建然后删除表。在我的情况下，该表将在前一个会话中创建和填充。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2011-08-15T18:43:18.227

```
var connection = new SqlConnection(connectionString);
var server = new Server(new ServerConnection(connection));

db = server.Databases["YourFavDB"];

db.Tables["YourHatedTable"].Drop(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-08-12T20:31:56.740

我认为最好的方法是：

```
Microsoft.SqlServer.Management.Smo.Database myDataBase = myServer.Databases["myDataBaseName"];
bool tableExists= myDataBase.Tables.Contains("myTable");
if (tableExists)
{
   myDataBase.Tables["myTable"].Drop();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-29T22:14:52.743

难道你不能把你的 DROP TABLE 语句包装在一个 try/catch 块中，并丢弃发生的任何错误吗？

不管怎样，判断一个表是否存在的sql是：

```
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[TableName]') AND type in (N'U')) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-29T22:11:48.663

第一个问题是，为什么不能使用 DDL 删除和重新创建？

并回答您的问题：

```
Table table = new Table(myDatabase, "MyTable", "MySchema"); 
```

# c# - 如何使 TreeView 和 ListBox 的 SelectedItem 保持同步？

> ID：928350
> 
> 赞同：2
> 
> 时间：2009-05-29T21:59:54.133
> 
> 标签：c#, wpf, xaml, mvvm

我敢肯定这已经出现过，但我一直无法找到答案。

我制作了一个基本的 ViewModel，其中包含一个 People 列表（一个 Person 数组）和一个名为 SelectedPerson 的属性，它自然地指向 People 列表中当前选定的 Person。我还有一个 ListBox 和一个 TreeView，它们数据绑定到 ViewModel 的人员列表。

我想做的是使 ListBox 的 SelectedValue 和 TreeView 的 SelectedItem 与 ViewModel 的 SelectedPerson 保持同步。这个想法是，无论如何修改 SelectedPerson（通过控件、通过代码等），所有控件都应该正确更新自己。我可以让它与两个 ListBox 一起工作，这很好，但我不能让它与一个 ListBox 和一个 TreeView 一起工作，因为 TreeView 的 SelectedItem 是只读的并且显然无法通过 XAML。

我应该从哪里获得有关制作这项工作的想法？

另请注意，我正在尝试在纯 XAML 中进行这项工作。不能动态加载和更改我的应用程序中的 XAML 文件的代码隐藏。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-29T22:23:17.877

您可以使用 Selector.IsSyncronizedWithCurrentItem。

您可以将您的列表框和树视图绑定到同一个数据源，并确保 IsSyncronized 参数设置为 true。然后对当前项目的任何更改都将反映在另一个中。

更多信息可以在这里找到：

[链接文本](http://msdn.microsoft.com/en-us/library/system.windows.controls.primitives.selector.issynchronizedwithcurrentitem.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T16:18:14.140

我四处询问，我能找到的最佳解决方案就在[这里](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/cc73893a-3383-4328-a002-ed8fb002a19d)

[http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/cc73893a-3383-4328-a002-ed8fb002a19d](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/cc73893a-3383-4328-a002-ed8fb002a19d)

它对我有用，但目前还不是最佳解决方案。

# windows - 有没有办法让 CVS（使用 Windows ）提交不同项目中的所有对向文件夹？

> ID：928360
> 
> 赞同：0
> 
> 时间：2009-05-29T22:04:03.907
> 
> 标签：windows, cvs

我有几个项目：

P:\Projects\Common P:\Projects\App1

我最初将每个文件夹（及其子文件夹）添加到 CVS（使用 Tortoise）。

现在，我希望每次在这些文件夹中保存任何内容时都能正确地为 Projects\ 和“提交”计时。

但是，似乎 \Project 与 \Common 分开，后者也与 \App1 分开

因此，如果文件显示它需要在 \Common 中签入并且我在 P:\Projects 上执行了提交，它会显示“没有更改”

有没有办法强制所有对向文件夹提交？或者有没有办法合并所有这些？（或者甚至从一个新的存储库重新开始，以便所有 P:\projects 都在同一个“项目”中，这样​​我就可以为所有这些进行一次签入？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-29T22:07:11.030

您可以创建一个新的 CVS 模块，它是所有其他目录的父目录，或者查看[别名模块](http://www.network-theory.co.uk/docs/cvsmanual/Aliasmodules.html)。

我使用别名模块将多个组件组合到一个检出（因此检入）中，但您确实需要对 CVSROOT 模块进行读/写访问才能设置它。

某人设置类似内容的演练可能对您有用[。](http://www.solarorange.com/docs/cvs/shared.html)

# apache-flex - 优化 Flex 应用程序 - 哪里可以找到我的瓶颈

> ID：928364
> 
> 赞同：3
> 
> 时间：2009-05-29T22:05:49.160
> 
> 标签：apache-flex, optimization, web-applications

我的**Flex Web 应用程序**几乎可以启动了。我目前正在尽我所能进行优化，以确保即使是低端客户端也能够流畅地运行它。问题是，我不知道在哪里优化比我已经优化的更多。

我的问题是，**关于瓶颈的通常怀疑是什么**？在优化 Flex 应用程序方面，您有哪些技巧和经验？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-29T22:12:16.057

有一些关于此的网络教程，[这个演示文稿](http://www.slideshare.net/dcoletta/optimizing-flex-applications)看起来很有帮助。当然，Flex 分析器可以帮助您识别瓶颈。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T03:45:28.890

这是一个很好的演示文稿，涵盖了很多陷阱。我能想到的另一件事是在大型应用程序中过度使用绑定。它们很容易创建和忘记，默默地生成大量在后台运行的额外代码，并且在整个类上不小心使用时特别有效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-30T04:34:34.567

这些是我见过的一些导致减速的事情。我只与一两个 Flex 开发人员合作过，所以我不知道这是否明显或有帮助。无论哪种方式：

*   透明度：每当视图有很多具有非透明透明度的组件（即 alpha 小于 1.0）时，这些视图往往会非常缓慢，尤其是在旧机器上。
*   对象创建：似乎每当发生大量对象创建时，应用程序都会慢下来，即使在较新的机器上也是如此。我在一个应用程序启动时创建了至少几百个对象。
*   数据获取：每当异步加载数据时，应用程序的性能都会受到影响，具体取决于加载量
*   很多对象：当视图中有很多对象时，它们往往会滞后并且通常会拖累。

那些是我记得最清楚的，一年多没有在主要的 Flex 应用程序上工作过。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-01T09:29:51.527

除了性能改进之外，您还可以优化 flex 应用程序的文件大小。这肯定会改善用户体验。我希望这篇文章对您有所帮助：
[http://askmeflash.com/article/9/optimize-flex-swf-filesize-performance-loading](http://askmeflash.com/article/9/optimize-flex-swf-filesize-performance-loading)

# java - 会话关闭后如何强制休眠释放内存？

> ID：928366
> 
> 赞同：5
> 
> 时间：2009-05-29T22:07:51.760
> 
> 标签：java, hibernate

我们最近才开始使用 Hibernate，并且还在习惯它的工作方式。

我们看到的一些事情是，即使在所有会话都关闭并且引用已经超出范围之后，hibernate 似乎仍然在它的缓存中维护以前使用的数据库值。

我们有从一组表中多次读取的代码。因为所有内存都被非常谨慎地释放，所以后面的传递会慢下来。

有什么办法可以强制 Hibernate 清除它的缓存？

对 System.gc() 的显式调用没有帮助。（是的，我知道这是一个建议）

*附加信息*：我们已明确禁用二级缓存。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-30T00:17:42.123

您可以尝试调用 Session.clear 来强制清除一级缓存。请务必先调用 Session.flush 以将任何挂起的更改写入数据库。如果这“解决”了问题，那么我怀疑某些东西仍然持有对会话的引用，从而防止缓存中的对象被垃圾收集。您可能需要获取程序的堆转储以跟踪泄漏。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-30T01:46:38.060

Hibernate 也有一个可选的二级缓存，它可以发挥作用。我同意 Rob 的观点，最简单的找出方法是查看会话结束后仍然在内存中的内容。

我目前最喜欢的工具是[YourKit](http://www.yourkit.com/)，它是商业的，而且并不便宜。他们曾经提供（并且可能仍然提供）非常便宜的个人许可选项（99 美元 IIRC）。在使用 Alfresco ECM 解决堆使用问题时，我已经使用 YourKit 来完成这项任务。还有其他可用的工具（例如 CodeGear JGears），据我了解，它们也可以很好地工作。

您可能会考虑在评估模式下使用产品 - 如果这发现您的问题，它可能会赢得它;）

# c - Vista 上的性能计数器问题

> ID：928378
> 
> 赞同：2
> 
> 时间：2009-05-29T22:12:36.197
> 
> 标签：c, windows-vista, perfmon

我在使用性能监控 API 的 Vista 上遇到了一个奇怪的问题。我目前正在使用基于 PdhGetFormattedCounterValue() 在 XP/2k 上运行良好的代码。我开始使用 PdhExpandWildCardPath 来扩展计数器（我对整体网络统计数据感兴趣），我正在查看的计数器是：

```
\\网络接口(*)\\接收的字节数/秒
\\网络接口(*)\\字节发送/秒
\\Processor(_Total)\\% 处理器时间

```

问题是他们在第一次调用时返回 PDH_INVALID_DATA，我认为这不是问题，因为如果我再次查询它，我将开始获取数据而不会出现错误。问题是这样的——虽然处理器时间完全按照预期工作，但网络接口计数器都没有返回任何东西——一直都是 0。我使用 Perfmon 验证他们正在正常报告数据，所以我不知道可能是什么问题。我在 MS 发现了这个：

[http://support.microsoft.com/?scid=kb%3Ben-us%3B287159&x=11&y=9](http://support.microsoft.com/?scid=kb%3Ben-us%3B287159&x=11&y=9)

但我对我的任务的多语言不感兴趣，所以我认为这无关紧要。我会看看我是否能想出一些基本代码来准确显示我在做什么，但是没有返回任何奇怪的东西，而且它在 XP/2k 上工作，所以我怀疑引擎盖下发生了一些变化。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-12T17:23:46.157

事实证明，问题在于网络接口都是通配符，而处理器一个实际上已经被性能监控卷起来了。我没有意识到 PdhExpandWildCardPath 没有返回 PdhAddCounter 可以直接使用的东西。我的意思是，如果 ExpandWildCard 返回 3 个扩展匹配项，它们会以空分隔字符串的形式返回 - 我理解这一点，但我假设 AddCounter 将有效地创建一个包含所有三个匹配项的计数器。不，现实是我需要分解每条路径并从 AddCounter 单独请求它，然后在获得结果时手动汇总结果。

希望这可以帮助其他人避免我犯的同样的错误，减少挫败感。;)

# emacs - xemacs：dotmacs 配置，这样可以粘贴而不会得到“有趣”的字符

> ID：928387
> 
> 赞同：2
> 
> 时间：2009-05-29T22:15:43.103
> 
> 标签：emacs, cygwin, dot-emacs

通过浏览器从网站复制文本，粘贴到 xemacs (21.4) 缓冲区，波浪线、引号等无法正确复制。

示例：他是个假人 -> 他\222s 是个假人。

您可以毫无问题地复制和粘贴它吗？如果是这样，请帮助 - 如何配置我的 .emacs 来解决这个问题。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-29T22:24:52.850

您正在尝试将智能引号复制+粘贴到 XEmacs 中。在这种情况下，`'\222'`是在代码页 Windows-1252 中编码的字符右单引号 (U+2019) 的八进制代码，该代码页具有字符编码`0x92`。

XEmacs 在内部使用 UTF-8，因此您必须配置复制+粘贴以从 Windows-1252 转换为 UTF-8。我不知道该怎么做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-30T05:58:21.560

在你的 .emacs 中触发它：

```
(set-clipboard-coding-system 'utf-16le-dos) 
```

那应该这样做。不要忘记在该声明中输入 Cx Ce，或重新启动 xemacs。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-13T02:40:39.590

这不是剪贴板或 cygwin 问题。如果您在记事本中保存带有花引号的 UTF-8 文本文件并在 XEmacs 21.4 中打开它，您将得到垃圾。根据[XEmacs 参考文档](http://www.xemacs.org/Documentation/21.5/html/lispref_64.html#SEC862)，21.5.6 版本之前不支持 Unicode。也许尝试[更高版本](http://mirrors.xmission.com/cygwin/release/xemacs/)？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-29T22:31:04.193

最简单的做法是编写一个快速函数，使用`replace-string`.

您也可以将 xemacs 设置为直接接受该代码页。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-29T23:07:41.703

[切换到 emacs，它就像冠军一样工作（此处来自Emacsw32](http://ourcomments.org/Emacs/EmacsW32.html)的 GNU Emacs 23.0.91.1 (i386-mingw-nt6.0.6002) ）。这可能是正在运行的 Emacsw32 补丁。

# iphone - iPhone 滑块灵敏度

> ID：928393
> 
> 赞同：1
> 
> 时间：2009-05-29T22:18:09.960
> 
> 标签：iphone

我有自定义滑块，我使用以下触摸事件来响应：

```
[bSlider addTarget:self action:@selector(sliderAction:) forControlEvents:UIControlEventValueChanged]; 
```

我发现它很难使用，大约 50% 的时间它不会对触摸做出响应。与音乐播放器的音量滑块相比，每次触摸它时效果都很好。在代码中创建滑块以使其更具响应性有什么秘诀吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-29T22:30:57.407

我的自定义 UISlider 遇到了同样的问题，并通过使用外部透明的更大“拇指”图像解决了这个问题。

我的回调函数运行缓慢并导致滑块使用起来非常缓慢和笨拙，我也遇到了问题，我通过在函数顶部添加一个简单的检查来解决这个问题：

```
int val = ceil(sliderView.value);
if (val == _lastSliderVal) return;
_lastSliderVal = val;

// .. code to update various display elements based on slider value 
```

在改变这两个之后，滑块工作得很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-29T22:26:09.383

问题是您正在跟踪的事件。`UIControlEventTouchUpInside`意味着您的`-start`方法只有在您在控件边界内抬起手指时才会被调用，这在滑块上并不容易做到。

您可能想要的是`UIControlEventTouchUpOutside`and/or ，当您将手指移出控件边界时，或者当您的手指分别从控件内拖动到其边界外时`UIControlEventTouchDragExit`，它将调用。`-start`

有关详细信息，请参阅[UIControl 参考](http://developer.apple.com/iphone/library/documentation/uikit/reference/UIControl_Class/index.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-18T13:46:42.340

好吧，我尝试了几件事，包括上面的建议，但从来没有让我的滑块和音乐应用程序中的 iPhone 音量滑块一样工作。唯一有帮助的是在按钮图像周围添加清晰的背景，以使触摸空间更大。这造成了让按钮一直滑动到滑块的底部和顶部的问题，我从未完全解决过。现在使用 OS 3.0 似乎工作得更好。

# sql - 而是插入触发器

> ID：928394
> 
> 赞同：1
> 
> 时间：2009-05-29T22:19:11.457
> 
> 标签：sql, sql-server, triggers

有人可以给我 MSSQL 的而不是插入触发器的骨架。我正在尝试测试采购订单列中的最大值（它是一个整数），并在插入时抓取最大值增量，并将其作为采购订单 ID 插入。该列没有设置自动增量选项，所以我用触发器解决了这个问题。

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-29T23:06:21.470

以下是如何更改表格以包含标识列。

1.  创建一个具有相同结构的新表，但在采购订单 ID 上有一个标识列。您可以使用“脚本表作为”，只需更改采购订单 ID 的行，例如：

    [Purchase Order Id] int 身份主键，

2.  在新表上打开标识插入：

    SET IDENTITY INSERT NewTable ON

3.  复制数据：

    插入新表（列） SELECT * FROM CurrentTable

4.  关闭身份插入：

    SET IDENTITY INSERT NewTable OFF

5.  重命名（或删除）旧表，使其不再使用：

    EXEC sp_rename 'CurrentTable', 'BackupTable';

6.  将新表移入：

    EXEC sp_rename 'NewTable', 'CurrentTable';

现在你有了一个不错的标识列，它比讨厌的触发器要好得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T13:10:49.487

正如 Andomar 所描述的，在我看来，创建一个新表来适当地支持您的特定要求将是理想的行动方案。

也就是说，如果您希望继续使用“替代插入触发器”路线，那么下面的 Microsoft 参考资料提供了一个详细的示例。

[http://msdn.microsoft.com/en-us/library/ms175089.aspx](http://msdn.microsoft.com/en-us/library/ms175089.aspx)

# c# - 返回可为空的字符串类型

> ID：928398
> 
> 赞同：18
> 
> 时间：2009-05-29T22:20:40.220
> 
> 标签：c#, string, nullable

所以我有这样的东西

```
public string? SessionValue(string key)
{
    if (HttpContext.Current.Session[key].ToString() == null || HttpContext.Current.Session[key].ToString() == "")
        return null;

    return HttpContext.Current.Session[key].ToString();
} 
```

哪个不编译。

如何返回可为空的字符串类型？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-05-29T22:23:46.877

String 已经是可以为空的类型。Nullable 只能用于 ValueTypes。字符串是引用类型。

只需摆脱“？” 你应该好好去！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-29T22:54:09.857

正如其他人所说，`string`不需要`?`（这是 的快捷方式`Nullable<string>`），因为所有引用类型（`class`es ）都已经可以为空。它仅适用于值类型 ( `struct`s)。

除此之外，您不应该`ToString()`在检查它是否是之前调用会话值`null`（或者您可以获得一个`NullReferenceException`）。此外，您不必检查 for 的结果，`ToString()`因为`null`它永远不会返回`null`（如果正确实施）。`null`如果会话值为空`string`( `""`) ，您确定要返回吗？

这相当于您要写的内容：

```
public string SessionValue(string key)
{
    if (HttpContext.Current.Session[key] == null)
        return null;

    string result = HttpContext.Current.Session[key].ToString();
    return (result == "") ? null : result;
} 
```

虽然我会这样写（`string`如果这是会话值包含的内容，则返回空）：

```
public string SessionValue(string key)
{
    object value = HttpContext.Current.Session[key];
    return (value == null) ? null : value.ToString();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-29T22:24:41.273

您可以将 null 分配给字符串，因为它是引用类型，您不需要能够使其可为空。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-29T22:26:54.640

String 已经是可以为空的类型。你不需要'?'。

> 错误 18 类型“字符串”必须是不可为空的值类型，才能将其用作泛型类型或方法“System.Nullable”中的参数“T”

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-29T22:28:20.877

`string`本身已经可以为空。

# c# - 如何在不四舍五入的情况下显示数字

> ID：928407
> 
> 赞同：0
> 
> 时间：2009-05-29T22:24:08.513
> 
> 标签：c#, rounding

我有这个号码：1234.5678（作为文本）

我需要这个数字加倍，点后只有 2 个数字

但没有四舍五入

在 1234.5678 - 我得到 1234.57

在 12.899999 - 我得到 12.90

我该怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-29T22:29:11.857

你应该能够像这样得到你想要的：

```
number.ToString("#0.00") 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-29T22:27:25.857

乘以 100，取数字的 floor()，再除以 100。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-29T23:54:30.767

你没有发布你*想要*的结果，但我假设你想要截断，所以你会看到 1234.56 和 12.89。尝试：

```
decimal d = 1234.89999M;
Console.WriteLine(Math.Truncate(d * 100) / 100); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-29T23:00:45.040

拿这个浮点运算！

```
var num = "1234.5678";
var ans = String.Empty;
if( !String.IsNullOrEmpty(num) && num.Contains('.') ) // per comment
{
  ans = num.Substring(0, num.IndexOf('.') + 3);
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-29T22:27:32.190

这是因为您不能将这些数字完全表示为双精度数，因此转换、四舍五入然后重新打印为文本会导致精度损失。

请改用“十进制”。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-30T00:00:29.803

这应该可以解决问题。

```
string rawVal = "1234.5678";
System.Math.Floor((double.parse(rawVal)) * 100) / 100; 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-05-29T22:30:53.803

这不行吗？

```
 double d = 1234.5678;
        double rounded =Math.Round(d, 2); 
```

# ruby-on-rails - 为什么 Rails 迁移在应用程序中定义外键而不在数据库中定义外键？

> ID：928425
> 
> 赞同：35
> 
> 时间：2009-05-29T22:30:54.023
> 
> 标签：ruby-on-rails, database, foreign-keys, referential-integrity

如果我定义一个模型，其中一个`Customer`“有很多”和“属于”的，在 Rails 中我们谈论有一个外键，但我们并不是说这在数据库中是强制的。`Order``Customer``Orders``Order``Customer``Order``Customer``customer_id`

因为 Rails 没有将此定义为数据库级别的约束，所以可能存在违反数据完整性的风险，可能在应用程序外部（或者如果您同时收到请求，则在内部？），除非您在数据库中手动强制执行该约束。

为什么 Rails 不在数据库级别定义外键，或者有没有办法让 Rails 做到这一点？

```
class Customer < ActiveRecord::Base
  has_many :orders
end

class Order < ActiveRecord::Base
    belongs_to :customer
end

ActiveRecord::Schema.define(:version => 1) do

  create_table "customers", :force => true do |t|
    t.string   "name"
  end

  create_table "orders", :force => true do |t|
    t.string   "item_name"
    t.integer  "customer_id"
  end

end 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-29T22:40:34.080

Rails 持有一些约定，即数据完整性的实施应该在应用程序中完成，而不是在数据库中。

例如，Rails 甚至支持一些[不能使用外键](https://stackoverflow.com/questions/922184/why-can-you-not-have-a-foreign-key-in-a-polymorphic-association/922341)的数据库设计，例如多态关联。

基本上，Rails 约定将数据库视为静态数据存储设备，而不是活动的 RDBMS。Rails 2.0*终于*支持 SQL 数据库的一些更现实的特性。毫无疑问，结果是使用 Rails 进行开发将变得比 1.0 版更复杂。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-30T01:15:05.843

在处理了这个问题一段时间之后，我不认为数据库不应该强制执行外键是 Rails 核心理念的一部分。

应用程序级别的验证和检查可提供简单、快速、人类可读（想想错误消息）的检查，这些检查在 99.99% 的时间内都有效。如果您的应用程序需要更多，您应该使用数据库级别的约束。

我认为这种“哲学”是由于使用了原始测试框架而演变而来的：外键在使用固定装置时被证明是一个巨大的麻烦。这就像一个“bug”变成了一个“特性”，因为没有人修复它。（如果我记错了历史，请有人纠正我。）

至少，Rails 社区内有越来越多的运动来加强数据库的完整性。 [查看上个月的这篇博文。](http://www.snowgiraffe.com/tech/462/rails-devs-for-foreign-keys/) 她甚至链接到一些有助于为处理错误提供支持的插件（以及另一个链接到更多插件的博客文章）。再做几次谷歌搜索；我也看到了其他插件支持迁移以创建外键。

现在，核心 Rails 哲学*的*一部分是：除非您确实需要，否则不要担心任何事情。对于许多 Web 应用程序，如果一小部分（可能很小）的记录包含无效数据，这可能是可以的。可能受到影响的页面可能很少被查看，或者错误已经可以很好地处理。或者，随着应用程序的增长，在接下来的 6 个月内手动处理问题可能比现在花费开发资源规划每个突发事件更便宜（例如，冷硬现金）。基本上，如果您的用例并没有使它看起来很重要，并且它实际上只能由可能发生 1/10000000 个请求的竞争条件引起……那么，值得吗？

所以我的预测是，默认情况下会出现工具来更好地处理整个情况，最终这些工具将被合并到 Rails 3 中。与此同时，如果您的应用程序确实需要它，请添加它们。它会引起轻微的测试头痛，但没有什么是你无法通过模拟和存根完成的。如果您的应用程序并不真正需要它……那么您已经很好了。:)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-03-23T17:32:19.763

经过几十年的行业工作，我坚信一个好的数据库设计将使应用程序免于许多问题，尤其是在它经历增强时。如果已知某个特定的约束即使在编程失误之后也能保持数据库的完整性（我相信我不是唯一这样做的人），那么如果可能的话，应该将它应用到数据库中。所以我会鼓励人们尽可能使用外键。我还会考虑使用测试来提供数据完整性。因为我们都知道墨菲定律。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-09-04T00:31:52.777

许多人犯的一个错误是将迁移与模型混淆。迁移只是修改数据库，与您定义的模型无关。由于这种混乱，许多外键插件尝试将模型与迁移结合起来，做太多神奇的事情。

对于迁移，我会使用[http://github.com/matthuhiggins/foreigner/tree/master](http://github.com/matthuhiggins/foreigner/tree/master)。您无需更改模型即可让外键与 Rails 一起使用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-29T22:37:23.057

它确实创建了一个`customer_id`列（显然）。不过，在大多数情况下，Rails 相信在*应用程序*级别而不是数据库级别强制执行约束和验证。这就是为什么默认情况下，Rails 中的列可能包含`NULL`值，即使你有`validates_presence_of`或类似的东西。Rails 开发人员的观点是，此类约束应该由应用程序处理，*而不是*由数据库处理。

# java - 获取 IStructuredSelection (eclipse-rcp) 的父级？

> ID：928429
> 
> 赞同：3
> 
> 时间：2009-05-29T22:32:43.707
> 
> 标签：java, eclipse, swt, eclipse-rcp

我在视图中有一个 TreeViewer，需要获取所选项目的父项（如果存在）。似乎没有任何效果，谷歌没有给出任何答案..

```
mBacktestTree.addDoubleClickListener(new IDoubleClickListener() {
                public void doubleClick(DoubleClickEvent event) {
                IWorkbenchPage page = getSite().getPage();
                TreeViewer tree = (TreeViewer) event.getSource();
                Object selectObject = ((IStructuredSelection) tree.getSelection()).getFirstElement();

// now how can I get the parent of selectObject? 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-30T08:24:15.757

您可以从 ITreeSelection 中获取父级。例如

```
public class DirectoryView extends ViewPart 
{
    public void createPartControl(Composite parent) 
    {
        TreeViewer treeViewer = new TreeViewer(parent);
        treeViewer.setContentProvider(new DirectoryProvider());
        treeViewer.setInput(new File(System.getProperty("user.home"))); 
        treeViewer.addDoubleClickListener(new IDoubleClickListener() 
        {                    
            public void doubleClick(DoubleClickEvent event) 
            {
                ITreeSelection selection = ((ITreeSelection)event.getSelection());
                System.out.println(selection.getPaths()[0].getParentPath().getLastSegment());
            }
        });
    }   

    class DirectoryProvider implements ITreeContentProvider
    {
        public Object[] getChildren(Object parentElement) 
        {
            File[] folders = ((File) parentElement).listFiles();
            return folders == null ? new File[0] : folders;
        }

        public Object getParent(Object element) 
        {
            return ((File) element).getParent();
        }

        public boolean hasChildren(Object element) 
        {
            return getChildren(element).length >0;
        }

        public Object[] getElements(Object inputElement) 
        {
            return getChildren(inputElement);
        }

        public void dispose() 
        {
            // ignore
        }

        public void inputChanged(Viewer viewer, Object oldInput, Object newInput) 
        {
            // ignore
        }
    }

    public void setFocus() 
    {
        // ignore
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-08-28T14:12:04.993

您还可以从树内容提供程序获取父级：

```
mBacktestTree.addDoubleClickListener(new IDoubleClickListener() {
                    public void doubleClick(DoubleClickEvent event) {
                            IWorkbenchPage page = getSite().getPage();
                            TreeViewer tree = (TreeViewer) event.getSource();
                            Object selectObject = ((IStructuredSelection)tree.getSelection()).getFirstElement();

ITreeContentProvider tcp =tree.getContentProvider();
Object parent = tcp.getParent(selectObject); 
```

# web-services - 聚合器是如何构建的？

> ID：928433
> 
> 赞同：14
> 
> 时间：2009-05-29T22:36:14.963
> 
> 标签：web-services, aggregation, web-crawler, nutch

假设我想从许多来源（可能是旅行、技术或其他）汇总与特定利基相关的信息。我该怎么做？

有一个蜘蛛/爬虫会爬网以找到我需要的信息（我如何告诉爬虫爬什么，因为我不想获取整个网络？）？然后有一个索引系统来索引和组织我爬取的信息，同时也是一个搜索引擎？

像 Nutch lucene.apache.org/nutch 这样的系统可以用于我想要的吗？你推荐别的东西吗？

或者你能推荐另一种方法吗？

例如，Techmeme.com 是如何建立的？（它是技术新闻的聚合器，并且是完全自动化的——直到最近他们才增加了一些人工干预）。建立这样的服务需要什么？

或者 Kayak.com 如何汇总他们的数据？（这是一个旅游聚合服务。）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-10-08T05:41:13.947

这一切都取决于您正在寻找的聚合器。

### 类型：

*   定义模糊 - 通常这要求您的数据源非常灵活地确定信息收集的类型（回答此站点/信息是否与旅行相关？幽默？与业务相关？）
*   特定 - 这放宽了数据存储中的要求，即所有数据都专门针对航班、酒店价格等与旅行相关的要求。

### 通常，聚合器是子程序的系统：

1.  Grabber，这个搜索并抓取所有需要汇总的内容
2.  总结 - 这通常通过查询数据库来完成，并且可以根据用户偏好进行调整 [通过编程逻辑]
3.  查看 - 这会格式化用户希望看到的信息，并且可以响应用户对建议项目的喜欢或不喜欢的反馈。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-29T23:17:51.777

对于基本外观 - 看看这个：[http ://en.wikipedia.org/wiki/Aggregator](http://en.wikipedia.org/wiki/Aggregator)

它将为您提供一般聚合器的概述。

关于如何建立自己的聚合器，如果您正在寻找开箱即用的东西，可以让您获得您想要的内容 - 我建议：[http ://dailyme.com/](http://dailyme.com/)

如果您正在寻找一个代码库/架构来构建您自己的聚合器服务 - 我建议直接看一些东西 - 例如：从[http://www.reddit.com/打开 Reddit](http://www.reddit.com/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-08-04T00:20:34.990

您需要定义您的应用程序将要做什么。构建自己的网络爬虫是一项艰巨的任务，因为您倾向于在发现需要它们时不断添加新功能......只会使您的设计复杂化，等等......

构建聚合器有很大不同。 **爬虫只是简单地检索要稍后处理的数据，而聚合器则获取已经定义的数据集并将它们放在一起。** 如果您使用聚合器，您可能希望查找已定义的旅行提要、财务提要、旅行数据等……聚合器更容易构建 IMO，但它受到更多限制。

相反，如果您想构建一个爬虫，您需要定义起始页面、定义结束条件（爬取深度、时间等）等等，然后仍然处理数据（即聚合、汇总和很快）。

# xml - 使用 Xslt 转换 Xml

> ID：928437
> 
> 赞同：0
> 
> 时间：2009-05-29T22:37:54.897
> 
> 标签：xml, xslt, xmldatasource

我有以下 XML：

```
<?xml version="1.0" encoding="utf-8" ?>
 <ApplicationSettingCategories>
 <Category>Cat1</Category>
 <Category>Cat2</Category>
 <Category>Cat3</Category>
 <Category>Cat4</Category>
 <Category>Cat5</Category>
 <Category>Cat6</Category>
</ApplicationSettingCategories> 
```

我正在尝试使用 XmlDataSource 和 Xslt 将此 Xml 绑定到 ASP.net 中的下拉列表。这是我第一次这样做。下拉列表显示了正确数量的空白项，让我相信迭代正在工作，但值和文本是空白的。

任何帮助识别我的错误将不胜感激。

谢谢

**我的 XLST**

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
xmlns:msxsl="urn:schemas-microsoft-com:xslt" exclude-result-prefixes="msxsl">
<xsl:output method="xml" indent="yes"/>

<xsl:template match="ApplicationSettingCategories">
    <Categories>
        <xsl:apply-templates select="Category"/>
    </Categories>
</xsl:template>

<xsl:template match="Category">
    <Category>
        <xsl:attribute name="Category">
            <xsl:value-of select="Category"/>
        </xsl:attribute>
    </Category>
</xsl:template> 
```

**我的 ASPX**

```
<asp:DropDownList ID="ddl1" runat="server" DataSourceID="XmlDataSource1" 
DataTextField="Category" DataValueField="Category" />
    <asp:XmlDataSource ID="XmlDataSource1" runat="server" 
    DataFile="~/App_Data/Xml/SettingCategory.xml" 
    TransformFile="~/Schema/AppCategoryXSLT.xslt"></asp:XmlDataSource> 
```

**我的源代码视图**

```
<select name="ddl1" id="ddl1">
<option value=""></option>
<option value=""></option>
<option value=""></option>
<option value=""></option>
<option value=""></option>
<option value=""></option>
</select> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-29T23:09:55.660

这条线是你的问题：

```
<xsl:value-of select="Category"/> 
```

此时（在`Category`模板内部），上下文节点是当前类别。您拥有的选择器`xsl:value-of`正在寻找*上下文节点的子元素，*也称为`Category`. 只需更改该行以获取上下文节点的文本值：

```
<xsl:value-of select="text()"/> 
```

# php - 如何在 PHP 中将这些单词与“”组合在一个数组中？

> ID：928439
> 
> 赞同：-1
> 
> 时间：2009-05-29T22:38:28.890
> 
> 标签：php, arrays

我想把每个数组的[word]部分和“”组合起来，数组结构如下：

```
Array ( [0] => Array ( [word] => Hello [off] => 0 [len] => 5 [idf] => 4.0235948562622 [attr] => en ) [1] => Array ( [word] => , [off] => 5 [len] => 1 [idf] => 0 [attr] => un ) [2] => Array ( [word] => long [off] => 6 [len] => 4 [idf] => 3.465735912323 [attr] => en ) )

Array ( [0] => Array ( [word] => time [off] => 11 [len] => 4 [idf] => 3.465735912323 [attr] => en ) )

Array ( [0] => Array ( [word] => no [off] => 16 [len] => 2 [idf] => 1.7328679561615 [attr] => en ) )

Array ( [0] => Array ( [word] => see [off] => 19 [len] => 3 [idf] => 2.7465307712555 [attr] => en ) [1] => Array ( [word] => ! [off] => 22 [len] => 1 [idf] => 0 [attr] => un ) [2] => Array ( [word] => How [off] => 23 [len] => 3 [idf] => 2.7465307712555 [attr] => en ) )

Array ( [0] => Array ( [word] => are [off] => 27 [len] => 3 [idf] => 2.7465307712555 [attr] => en ) )

Array ( [0] => Array ( [word] => you [off] => 31 [len] => 3 [idf] => 2.7465307712555 [attr] => en ) )

Array ( [0] => Array ( [word] => recently [off] => 35 [len] => 8 [idf] => 5.1986036300659 [attr] => en ) [1] => Array ( [word] => ? [off] => 43 [len] => 1 [idf] => 0 [attr] => un ) ) 
```

是否有 PHP 的内置函数可以做到这一点？因为我认为循环效率较低。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-29T22:57:38.930

[内爆](http://php.net/manual/en/function.implode.php)+ [array_map](http://php.net/manual/en/function.array-map.php)：

```
function func($a) {
    return $a['word'];
}
implode(' ', array_map('func', $x)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-29T22:53:42.947

好吧，无论发生什么，都会发生循环，即使它是内部的。

你可以使用array_walk：

```
$str = "";

function word_append($value, $key) { 

   global $str;

   $str .= $value['word'] . " ";

};

array_walk($func, $array_of_words); 
```

$str 现在应该包含附加的文本。

# sql - 为什么两个mysql文件（相同的表，相同的内容）大小不同？

> ID：928440
> 
> 赞同：1
> 
> 时间：2009-05-29T22:39:26.860
> 
> 标签：sql, mysql, filesystems

我使用了一个现有的 MySQL 数据库，并在新主机上设置了一个副本。

新主机上某些表的文件大小比旧主机上的对应文件小 1-3%。

我很好奇为什么会这样。

我的猜测是，旧主机的文件随着时间的推移而增长，并且在该文件的 b 树结构中，存在更多碎片。而新主机，因为它是从头开始创建文件（通过二进制日志），避免了这种碎片。

在 b-tree 结构本身中存在碎片是否有意义？（说的是数据库层，而不是操作系统文件系统层）我最初认为“不”，但话说回来，这种碎片不是 DBA 压缩数据库文件任务的基础吗？

我想知道这是否只是文件系统层的产物。即，新主机的磁盘驱动器大部分为空，因此较少的碎片将导致分配新文件。再说一次，我认为碎片不会出现在报告的文件大小（Linux OS）中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-29T23:02:36.457

MySQL 数据文件或索引文件中肯定存在碎片。这很常见，甚至是*故意*的。

也就是说，存储引擎可能会故意在这里和那里留下一些额外的空间，因此当您更改值时，它可以适应行，而无需重新排序整个数据文件。您甚至可以使用服务器属性来配置要分配多少这个 slop 空间。

我什至不会对 1-3% 的文件差异眨眼。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-29T22:43:37.397

根据我对 mysql 的了解，当它接近容量时它有一个增长算法，安装时它选择了不同的大小，prolly 修剪多余的存储

# ruby - Ruby 函数与方法

> ID：928443
> 
> 赞同：27
> 
> 时间：2009-05-29T22:40:11.587
> 
> 标签：ruby, function, lambda, methods

在[Ruby Programming Language](https://rads.stackoverflow.com/amzn/click/com/0596516177)的第 6 章（第二段）中，他们指出：

> 许多语言区分没有关联对象的函数和在接收者对象上调用的方法。因为 Ruby 是一种纯面向对象的语言，所以所有方法都是真正的方法，并且至少与一个对象相关联。

然后在第 6 段的中间：

> procs 和 lambdas 都是函数，而不是在对象上调用的方法。

我对这些陈述有点困惑。Ruby 是真正的纯 OO，因此没有与对象无关的函数（如果这是纯 OO 的有效定义），还是 procs/lambdas 与 Proc 对象相关联？Ruby中的函数和方法有什么区别？

在解析和理解这方面的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-29T23:06:09.100

`lambda`Ruby 中的 s 是 Proc 类的对象。 `Proc`对象不属于任何对象。它们在没有绑定到对象的情况下被调用。

方法是 class`Method`或的对象`UnboundMethod`，取决于它们是绑定的还是未绑定的。[请参阅此处](http://www.ruby-doc.org/core/classes/UnboundMethod.html)的说明。在绑定到对象之前，无法调用未绑定的方法。

```
lambda{|x| x}.class      # => Proc
lambda{|x| x}.call(123)  # => 123

class Foo
  def bar(baz)
    baz
  end
end

puts Foo.new.method(:bar).class     # => Method
puts Foo.new.method(:bar).call(123) # => 123

puts Foo.instance_method(:bar).class     # => UnboundMethod
puts Foo.instance_method(:bar).call(123) # => throws an exception 
```

你可以`bind`一个`UnboundMethod`对象然后调用它。但是你根本不能对`bind`一个`Proc`对象。 `Proc`然而，对象可以捕获周围范围内的局部变量，成为闭包。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-29T22:56:45.360

我认为区别在于方法和[一阶函数](http://en.wikipedia.org/wiki/First_order_functions)，即。可以作为值传递的函数。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-29T22:41:48.870

Procs 和 lambdas 本身都是对象，具有`call`实际调用与 proc（或 lambda）关联的块的方法。但是，Ruby 提供了一些语法糖来调用它们，而无需显式调用`call`.

# vba - 日志解析器早期绑定

> ID：928448
> 
> 赞同：0
> 
> 时间：2009-05-29T22:41:26.733
> 
> 标签：vba, com, vb6, logparser, early-binding

是否可以在 VB6/VBA 上使用与 LogParser.dll 的早期绑定？当我尝试设置对它的引用时，它就会消失而没有错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-30T05:55:58.943

奥朗，

我在 DLL 上运行了 Dependency Walker。它说 dwmapi.dll 丢失。谷歌搜索 dwmapi.dll 会找到各种匹配项，都与 COM 对象的早期绑定问题有关。dwmapi 是一个延迟加载的 dll，存在于 Vista 机器上。

我尝试将 dwmapi.dll 的副本放在我的机器上的 system32 目录中。它不会向 regsvr32 注册（这并不奇怪，真的），但它确实消除了 Dependency Walker 中缺少的引用。但是，Dependency Walker 仍然返回一条错误消息，内容为：

```
Warning: At least one module has an unresolved import due to a missing export function in a delay-load dependent module. 
```

真的没想到它会起作用，不是吗？

dwmapi 甚至没有在微软的 DLL 数据库中列出。

我在 IIS 论坛上见过你。还没有答案。

你有没有可能晚绑定这个东西？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T02:19:08.993

你用 COM 注册 DLL 了吗？

在计算机上使用 Log Parser 可编写脚本的 COM 组件之前，必须通过在包含“LogParser.dll”二进制文件的目录中执行以下命令，将“LogParser.dll”二进制文件注册到计算机的 COM 基础结构中

```
C:\LogParser>regsvr32 LogParser.dll 
```

# iphone - SEL 是否有包装对象？

> ID：928449
> 
> 赞同：4
> 
> 时间：2009-05-29T22:41:33.830
> 
> 标签：iphone, cocoa-touch, uikit, selector

我想将选择器添加到 NSMutableArray。但是由于它们是不透明的类型并且没有对象，所以这是行不通的，对吧？有我可以使用的包装器对象吗？还是我必须自己创建？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-29T22:46:00.107

您可以将其包装在一个`NSValue`实例中，如下所示：

```
SEL mySelector = @selector(performSomething:);
NSValue *value = [NSValue value:&mySelector withObjCType:@encode(SEL)]; 
```

然后为您的`NSMutableArray`实例增加价值。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-30T00:57:24.773

您可以将选择器的 NSString 名称存储在数组中并使用

```
SEL mySelector = NSSelectorFromString([selectorArray objectAtIndex:0]); 
```

从存储的字符串生成选择器。

此外，您可以使用类似的东西将选择器打包为 NSInvocation

```
NSInvocation *invocation = [NSInvocation invocationWithMethodSignature:[self methodSignatureForSelector:mySelector]];

[invocation setTarget:self];
[invocation setSelector:mySelector];
[invocation setArgument:&arg atIndex:2];
[invocation retainArguments]; 
```

然后可以将此 NSInvocation 对象存储在数组中并稍后调用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-12-26T21:57:25.967

NSValue valueWithPointer / pointerValue 同样有效。

如果你想这样做，你只需要知道你不能序列化数组（即将它写入文件），使用 NSStringFromSelector 方法。

这些都是将选择器放入 NSValue 对象的有效方法：

```
 id selWrapper1 = [NSValue valueWithPointer:_cmd];
    id selWrapper2 = [NSValue valueWithPointer:@selector(viewDidLoad)];
    id selWrapper3 = [NSValue valueWithPointer:@selector(setObject:forKey:)];
    NSString *myProperty = @"frame";
    NSString *propertySetter = [NSString stringWithFormat:@"set%@%@:",
                                [[myProperty substringToIndex:1]uppercaseString],
                                [myProperty substringFromIndex:1]];

    id selWrapper4 = [NSValue valueWithPointer:NSSelectorFromString(propertySetter)];

    NSArray *array = [NSArray arrayWithObjects:
                      selWrapper1,
                      selWrapper2,
                      selWrapper3,
                      selWrapper4, nil];

    SEL theCmd1 = [[array objectAtIndex:0] pointerValue];
    SEL theCmd2 = [[array objectAtIndex:1] pointerValue];
    SEL theCmd3 = [[array objectAtIndex:2] pointerValue];
    SEL theCmd4 = [[array objectAtIndex:3] pointerValue]; 
```

# java - JLabel 的 setBorder 方法导致绘制问题

> ID：928453
> 
> 赞同：0
> 
> 时间：2009-05-29T22:43:29.893
> 
> 标签：java, swing, awt

我有一个扩展 JLabel 的自定义类。对于该类的特定实例，我想在左侧的文本中添加一些间距。我需要间距，因为我正在设置这个 JLabel 的背景，我不希望文本在彩色背景的边缘附近出现。我摸索了很多并实现了这个（在paint函数中）：

```
if (condition) {
    bgColor = Color.red;
    setBackground(bgColor);
    setOpaque(true);
    // This line merely adds some padding on the left
    setBorder(BorderFactory.createEmptyBorder(0, 10, 0, 0));
}
else {
    setOpaque(false);
} 
```

这似乎有效，因为它增加了我想要的间距，但是它有一个不幸的副作用，因为它似乎破坏了整个应用程序其余部分的重绘......似乎只有那个特定的组件正在重绘，而不是应用程序的其余部分。我最终将其具体追踪到 setBorder 调用...设置任何类型的边框似乎都会导致相同的损坏行为。我们有两个不同版本的应用程序，一个在 Java 1.5 中运行，一个在 Java 1.6 中运行，Java 1.6 版本似乎可以正常工作，而 Java 1.5 版本则不能。无法将旧版本升级到 Java 1.6...我需要可以在 Java 1.5 中使用的东西。另外，我试过这个（只是想看看它是什么样子）：

```
setHorizontalTextPosition(JLabel.CENTER); 
```

这似乎也以完全相同的方式破坏了重新绘制。我查看了我们应用程序的源代码，发现了我们设置边框的其他地方（包括空边框），但在 JLabels 上找不到任何地方（只有面板、按钮等）。有人以前见过这样的东西吗？知道如何解决吗？或者也许是另一种获得我需要的间距的方法可以解决这个错误？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-30T00:02:09.127

问题是您在paint 方法中调用了该代码。您不应该这样做，因为它会冻结 EDT，并在挥杆绘画管道中出现不需要的循环。

您应该将该代码放在构造函数上，并在应用程序生命周期的其他地方更改组件设计状态。

如果您想了解更多关于 Swing 绘画的信息，请阅读 push-pixels.org 上的“Swing 绘画管道”帖子。

请注意，您可以使用 BorderFactory.createCompoundBorder 组合任意两个边框。然后，您可以使用 emptyBorder 和任何其他设置间距来绘制外边框。

编辑：添加示例。

```
package com.stackoverflow.swing.paintpipeline;

import java.awt.Color;
import java.awt.Graphics;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;
import java.util.ArrayList;
import java.util.List;
import java.util.Random;

import javax.swing.BorderFactory;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.SwingUtilities;
import javax.swing.Timer;
import javax.swing.border.Border;

public class JLabelSetBorderPaintProblem extends JLabel {

    public JLabelSetBorderPaintProblem(String text) {
        super(text);
    }

    /*
     * @see javax.swing.JComponent paint(java.awt.Graphics)
     */
    @Override
    public void paint(Graphics g) {
        super.paint(g);
        // You can not call setBorder here.

        // Please check javadoc.
    }

    /*
     * @see javax.swing.JComponent paintBorder(java.awt.Graphics)
     */
    @Override
    protected void paintBorder(Graphics g) {
        super.paintBorder(g);
        // Here is where the Swing painting pipeline draws the current border
        // for the JLabel instance.

        // Please check javadoc.
    }

    // Start me here!
    public static void main(String[] args) {
        // SetBorder will dispatch an event to Event Dispatcher Thread to draw the
        // new border around the component - you must call setBorder inside EDT.
        // Swing rule 1.
        SwingUtilities.invokeLater(new Runnable() {

            @Override public void run() {
                // Inside EDT
                JFrame frame = new JFrame("JLabel setBorder example");
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                // Add the JLabel
                final JLabelSetBorderPaintProblem label = new JLabelSetBorderPaintProblem("Just press or wait...");
                frame.add(label);

                // And change the border...
                label.addMouseListener(new MouseAdapter() {
                    @Override public void mousePressed(MouseEvent e) {
                        label.setBorder(BORDERS.get(new Random().nextInt(BORDERS.size())));
                    }
                });

                // ...whenever you want
                new Timer(5000, new ActionListener() {
                    @Override public void actionPerformed(ActionEvent e) {
                        label.setBorder(BORDERS.get(new Random().nextInt(BORDERS.size())));
                    }
                }).start();

                frame.pack();
                frame.setVisible(true);
            }
        });

    }

    public static final List<Border> BORDERS;
    static {
        BORDERS = new ArrayList<Border>();
        BORDERS.add(BorderFactory.createLineBorder(Color.BLACK));
        BORDERS.add(BorderFactory.createLineBorder(Color.RED));
        BORDERS.add(BorderFactory.createEtchedBorder());
        BORDERS.add(BorderFactory.createTitledBorder("A border"));
    }
} 
```

# wpf - 未将依赖项的依赖项复制到输出目录

> ID：928458
> 
> 赞同：2
> 
> 时间：2009-05-29T22:45:26.100
> 
> 标签：wpf, visual-studio, visual-studio-2008

我在 MSDN 论坛上发布了这个问题，但没有得到太多答案，所以决定在这里尝试一下。

当第一个库主要是 xaml 时，我遇到了一个项目的依赖库没有被复制到引用它的第二个项目的输出目录的问题。这是发生这种情况的典型场景

SolutionX
    - SomeControls.Dll { 包含 wpf 用户控件 }
         外部参考：WPFTheme.dll*
    - MainApp.Exe
        项目参考：SomeControls.dll

通常这里发生的情况是，在构建解决方案时，WPFTheme.dll 没有复制到 MainApp.Exe 项目的输出目录。（* 这也适用于引用第三个项目而不是外部项目）

我通常使用构建后事件来处理这种情况......但我发现问题是间歇性的。

如果我没有在我的 c# 代码中引用 WPFTheme.dll 中的任何类，但我在 xaml 中这样做，那么如前所述 WPFTheme.dll 库不会被复制。

但是，如果我从项目中的某些 c#（甚至后端 xaml.cs 类）引用任何类（甚至只是将它们分配为 null）-那么一切都会按预期工作。

那么有没有其他人遇到过这个问题？如果被 xaml 引用，有没有办法强制复制库？

只是为了添加更多信息......所有这些都发生在项目文件中显示为外部的库中，并且在 HintPath 中具有相对路径。

感谢大家，

ķ

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-29T22:54:29.187

我在通过反射进行依赖注入时遇到了同样的问题，我通过构建后事件和部署 nant 脚本来解决它，对不起，我无法提供更多帮助，期待看到一个解决方案，你总是可以将 refs 添加到启动直接进行项目，从长远来看可能会遇到一些有趣的问题，但它会起作用

# javascript - 使用 AJAX 在网页上动态预加载/显示网络摄像头快照

> ID：928467
> 
> 赞同：0
> 
> 时间：2009-05-29T22:52:30.313
> 
> 标签：javascript, jquery, ajax

我有一个 IP 摄像机，可以将实时视频流式传输到我的网站。问题是，它是由 ActiveX 控件驱动的。更糟糕的是，这个控件是无符号的。为了向使用 IE 以外的浏览器或（理所当然地）不愿更改其安全设置的人们提供更安全的替代方案，我正在利用内置快照脚本的相机，该脚本提供 640x480 实时 JPEG 图像。计划是使用 Javascript 每约 500 毫秒更新一次屏幕上的实时图像，而无需重新加载整个页面。

我尝试使用 Image() 对象预加载图像并在 onload 触发时更新图像元素的 SRC 属性：

```
function updateCam() {
  var url = "../snapshot.cgi?t=" + new Date().getTime();
  img = new Image();
  img.onload = function() {
    $("#livePhoto").attr("src", url);
    camTimer = setTimeout(updateCam, 500);
  }
  img.src = url;
} 
```

这工作得很好，但很难确定相机何时被禁用，我需要这样做才能优雅地降级。在这种情况下，内部快照脚本设置为返回 204（无内容）的 HTTP 状态代码，当然我无法使用 Image 对象检测到这一点。此外，onload 事件并非 100% 可靠。

因此，我使用 jQuery（版本 1.2.6）`ajax`函数对 URL 执行 GET 请求，并在`complete`回调中评估状态代码并相应地设置 URL：

```
function updateCam() {
  var url = "../snapshot.cgi?t=" + new Date().getTime();

  $.ajax({
    type: "GET",
    url: url,
    timeout: 2000,
    complete: function(xhr) {
      try {
        var src = (xhr.status == 200) ? url : '../i/cam-oos.jpg';
        $("#livePhoto").attr("src", src);            
      }
      catch(e) {
        JoshError.log(e);
      }

      camTimer = setTimeout(updateCam, 500);
    }
  });
} 
```

这很好用。 **但只在 IE 中！** 这是我想回答的问题：为什么这在 Firefox 或 Chrome 中不起作用？该`complete`事件甚至不会在 Firefox 中触发。它确实在 Chrome 中触发，但很少设置 SRC 实际加载请求的图像（通常它不显示任何内容）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-31T09:36:07.493

发布第二个答案，因为第一个真的不正确。我无法测试此解决方案（因为我无权访问您的网络摄像头脚本），但我建议您尝试清理来自摄像头的响应 - 因为您显然无法处理原始图像数据，请尝试添加 dataFilter像这样设置：

```
function updateCam() {
  var url = "../snapshopt.cgi?t=" + new Date().getTime();

  $.ajax({
    type: "GET",
    url: url,
    timeout: 2000,
    dataFilter : function(data, type) {
       return '<div></div>' //so it returns something...
    },
    complete: function(xhr) {
      try {
        var src = (xhr.status == 200) ? url : '../i/cam-oos.jpg';
        $("#live").attr("src", src);            
      }
      catch(e) {
        JoshError.log(e);
      }

      camTimer = setTimeout(updateCam, 500);
    }
  });
} 
```

就像我说的那样，我无法对此进行测试 - 但它可能允许 jquery 使用状态代码而不会像疯了一样打破。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T00:38:14.437

```
img.onerror = function(){
    alert('offline');
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T02:17:43.363

好吧，我最终为非 IE 浏览器使用了[数据 URI 方案](http://en.wikipedia.org/wiki/Data_URI_scheme)（向 Eric Pascarello 致敬）。我编写了一个 HTTP 处理程序（在 VB.NET 中）来代理 IP 摄像机，并对图像进行 base-64 编码：

```
Imports Common
Imports System.IO
Imports System.Net

Public Class LiveCam
    Implements IHttpHandler

    Private ReadOnly URL As String = "http://12.34.56.78/snapshot.cgi"
    Private ReadOnly FAIL As String = Common.MapPath("~/i/cam-oos.jpg")        

    Public Sub ProcessRequest(ByVal context As System.Web.HttpContext) Implements System.Web.IHttpHandler.ProcessRequest
        Dim Data As Byte()

        With context.Response
           .ContentEncoding = Encoding.UTF8
           .ContentType = "text/plain"
           .Write("data:image/png;base64,")

           Try
               Using Client As New WebClient()
                   Data = Client.DownloadData(URL)
               End Using
           Catch ex As WebException
               Data = File.ReadAllBytes(FAIL)
           End Try

           .Write(Convert.ToBase64String(Data))
        End With
    End Sub
End Class 
```

然后我只是进行了一些非 IE 检测（使用经典的 document.all 检查），以便调用正确的 URL/设置正确的 SRC：

```
function updateCam() {
  var url = (document.all) ? "../snapshot.cgi?t=" : "../cam.axd?t=";

  url += new Date().getTime();

  $.ajax({
    type: "GET",
    url: url,
    timeout: 2000,
    complete: function(xhr) {
      try {
        var src;

        if(document.all)
          src = (xhr.status == 200) ? url : '../i/cam-oos.jpg';
        else
          src = xhr.responseText;

        $("#livePhoto").attr("src", src);            
      }
      catch(e) {
        JoshError.log(e);
      }

      camTimer = setTimeout(updateCam, 500);
    }
  });
} 
```

很不幸，我不得不求助于这种解决方法。我讨厌浏览器检测代码，我讨厌我的服务器上的额外负载。代理不仅会迫使我浪费更多的带宽，而且由于代理固有的缺点以及对图像进行 base-64 编码所需的时间，它不会有效地运行。此外，它没有设置为像 IE*那样优雅地降级。*虽然我可以重新编写代理以使用 HttpWebRequest 并返回正确的状态代码等。我只是想要尽可能简单的方法，因为我厌倦了处理这个！

谢谢大家！

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-29T23:02:55.767

我相信 jquery 会尝试解释来自服务器的响应。我相信一些浏览器对响应解释更宽容，所以限制性更强的浏览器会失败，因为图像不能被视为 HTML！

对此的解决方案是使用 HEAD 请求类型而不是 GET（类型：“HEAD”）。这样，您仍将获得状态响应，而无需获取图像本身。因此响应将是空的（不应该把你搞砸）。此外，响应应该更快。

# c++ - 如果你只有一把锤子……或者

> ID：928472
> 
> 赞同：4
> 
> 时间：2009-05-29T22:54:57.407
> 
> 标签：c++, scripting-language

我需要通过 http 从 Internet 下载一些 csv 文件，对其进行解析并将其转换为更有用的格式。最终，C++ 程序将使用数据。几年前，我会拿出我的 Perl 书籍并开始编写 Perl 脚本来进行下载和解析。但现在有了 Boost 和 Qt，我可以毫不费力地用 C++ 完成下载、解析和添加 GUI 前端。上次我写 Perl/Python 大约是 6 个月前。在 Perl/Python 中完成它可能需要更长的时间，而且我的 Perl/Python 代码将是废话。如果我唯一的工具是锤子，一切看起来都像钉子吗？还是时代变了，C++ 可以在传统上由脚本语言（如 Perl 或 Python）主导的领域发挥作用？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-29T23:05:08.697

其他人通常期望解决方案是什么有什么关系？如果**你**可以用 C++ 更好更快地完成工作，那就用 C++ 来完成吧。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-29T23:02:54.957

对于您的示例，您似乎将更有效率，并且能够更轻松地使用 C++ 解决您的问题，因为这就是您所知道的。

但一般来说，我希望更多的人会使用 python/perl 来完成这类任务。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-29T23:00:17.910

为什么不？

如果您的代码由于缺少库/功能而变得很笨拙，那么 C++ 可能不是最好的。如果需要经常更改，那么 C++ 可能不是最好的。如果其他了解 Perl/Python 的人会维护它，那么 C++ 可能不是最好的。等等

你真的需要图形用户界面吗？你需要速度吗？使 C++ 成为一种脚本语言没有任何改变，但这并不意味着您不应该使用它。

如果它通过了这样的常识测试，那为什么不呢？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-29T22:59:30.237

好吧，如果你必须盖房子，锤子就可以了。但是使用气动框架钉枪建造房屋要容易得多。

C++ 是一门优秀的语言，您可以在脚本语言主导的领域提高工作效率，但在所有条件相同的情况下，使用 perl/python 进行文本解析会提高工作效率。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-29T23:15:24.557

C/C++ 与 python/perl 的生产力问题似乎与我无关。如果您想使用 Qt、Boost 和任何其他现成的工具集编写解析器，那就去做吧。您实际上并没有指定解析速度是否是一个问题，但即使是这样，它对您的情况是否也很*重要*。

即使您认为使用 X 语言可能更容易，如果您想尝试学习该语言的新知识，请用 Y 语言编写它。这听起来是一个非常简单的任务，所以只需按照您想要的方式编写即可。

您还需要考虑未来的使用。如果需要以某种方式增强和扩展该程序，则可能需要选择特定的语言。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-30T00:21:40.650

如果您在 C++ 中的工作效率更高，那么一定要使用 C++。学习其他语言仍然是一个好主意，但有时你需要使用你所知道的来完成工作。

顺便说一句，您可能已经知道这一点，但是[Boost.Tokenizer库通过](http://www.boost.org/doc/libs/1_39_0/libs/tokenizer/index.html)[转义列表分隔符](http://www.boost.org/doc/libs/1_39_0/libs/tokenizer/escaped_list_separator.htm)内置了 CSV 解析功能。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-30T00:28:07.110

根据您的描述，听起来您除了锤子还有其他工具。您拥有的工具越多，您完成工作的效率就越高。使用您可以使用的任何工具来完成工作，偶尔购买（学习）更多工具。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-30T01:40:53.843

我喜欢 C++。我讨厌编译、运行、测试、关闭循环——特别是当我需要测试数据时。

我的解决方案：我制作了一个小型编程环境 [由 Lua 提供支持]，我将其嵌入到我的 C++ 应用程序中，然后在运行时*打开它并以交互方式进行操作。*为什么要坚持一种或另一种编程环境？使用**两全其美**。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-05-29T23:00:14.150

C++ 并不是专门为处理长字符串而设计的。（只要看看旧的 C-Strings ......对于任何严肃的事情来说，它们都是一场噩梦。）相比之下，Perl 就是*为*这种用途而设计的。

您可能可以在 C++ 中拼凑一些东西，但是 Perl 解决方案可能会更加健壮和可维护。

# java - Swing：区分用户引起的组件和自动调整大小的问题（编写自定义 LayoutManager）

> ID：928488
> 
> 赞同：1
> 
> 时间：2009-05-29T23:02:46.407
> 
> 标签：java, multithreading, swing, events, synchronization

我正在尝试编写自己的**布局管理器**。

必须**相**对于彼此放置组件并确定其大小。
这意味着：当用户拖动或调整组件大小时，必须更改其他一些组件（但**不是**由用户手动更改的组件）。

Swing 告诉布局管理器在每次移动/调整组件大小时对组件进行布局。这是一个问题，因此布局管理器**本身**会移动/调整组件的大小：
它失败了，方法 *layoutContainer(Container parent)*被多次调用。

整个事情的一个**例子**（简化，实际上我的布局管理器做了更复杂的事情）：

*   `[-component1-][-component2-------][-component3-]`
*   用户将 component2 调整为更小，我的布局管理器将调整其他组件，以便所有组件都占用与以前相同的空间：
    `[-component1-][-component2-][-component3-------]`
*   在这里，动作**应该停止**，但它们会继续：现在布局管理器由于调整 component3 的大小而被调用

我怎样才能（以优雅的方式）实现我的意图？
谢谢你。

**编辑：**
在回答者提出建议后删除了与线程相关的信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-30T00:16:11.797

这种反馈循环在处理事件时并不少见。您可以使用几种方法来打破这个循环，我建议您尝试的一种方法是跟踪组件的计算大小。然后，当您处理调整大小事件时，将实际大小与计算出的大小进行比较，如果它们相等则直接返回而不做任何事情。这可能是最稳健的方法，因为它不依赖于事件的顺序或频率。如其他地方所述，您不需要从布局管理器中触摸与线程相关的任何内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-29T23:36:18.853

这不是线程同步问题。

您说过，当*用户*更改对象的大小或位置时，必须更改其他对象。我猜您正在列出某种更改事件，以便在用户更改对象时触发布局的重新计算。如果是这样，我进一步猜测您的布局管理器正在触发此事件，导致它再次被调用。

当然，这只是猜测，没有审查你的代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-29T23:15:00.440

我不能说布局管理器的正确实现，但就线程而言， Swing 中的*所有*事件都在 Swing UI 线程上调度，即同一个线程。因此，同步对象将不起作用，因为只涉及一个线程。`Thread.currentThread()`您可以通过在调试器中打印或检查它来查看哪个线程正在调用方法。

根据您要执行的操作，您可能需要查看[miglayout](http://www.miglayout.com/)。我发现它非常强大且易于使用。正确实现 Swing 布局管理器是一项不平凡的任务。

# asmx - 为什么默认情况下在 asmx webservices 中禁用 SOAP 和 GET？

> ID：928499
> 
> 赞同：0
> 
> 时间：2009-05-29T23:08:15.070
> 
> 标签：asmx

我即将为我的 asmx 网络服务打开缺少的协议。它们已经在两层身份验证之后，并且具有角色检查属性，因此它是安全的。

这篇[MS 知识库文章解释了默认情况下对 asmx 禁用 GET 和 SOAP](http://support.microsoft.com/default.aspx?scid=kb;en-us;819267)，而默认情况下启用 POST，但除了“安全原因”之外没有说明原因。这只是迷信吗？他们为什么这样做？似乎启用 POST 与启用 GET 一样不安全。

我想这减少了攻击面，但是在有人通过特定协议调用 Web 服务之前禁用所有内容将比启用 POST 更安全。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-21T23:51:17.837

实际链接是[INFO: HTTP GET 和 HTTP POST Are Disabled by Default](http://support.microsoft.com/kb/819267)。

GET 和 POST 协议不支持 SOAP 标头。出于安全目的，许多服务都需要这些。

此外，这些协议并不经常用于纯 SOAP 服务（因为协议指定使用 POST）。让它们打开会打开一扇门，没有人会看到。坏人可能会潜入。

# .net - 如何在 Windows .NET 中将我的程序添加到 PATH？

> ID：928504
> 
> 赞同：3
> 
> 时间：2009-05-29T23:11:41.397
> 
> 标签：.net, installation, path

安装 .NET 程序后，如何设置系统 PATH 以包含我的程序绝对目录，以便用户可以从控制台中的任何目录启动我的 .exe？

注意：我希望这可以自动完成，而最终用户不必自己手动添加 PATH。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-29T23:32:40.997

我假设您使用的是 VS2008 内置安装程序，而不是 InstallShield 或 Wise 或类似的东西（它们都有更好的方法）。

您可以创建一个安装程序类来添加它（见下文）。

然后，您将安装程序类添加[为安装和卸载的自定义操作，并](http://msdn.microsoft.com/en-us/library/d9k65z2d(VS.80).aspx)使用您想要的路径添加[自定义操作数据](http://msdn.microsoft.com/en-us/library/9cdb5eda(VS.71).aspx)，例如将 TARGETDIR 添加到 Path ...

> /VariableName="路径" /Value="[TARGETDIR]\"

```
using System;
using System.ComponentModel;

namespace Emv
{
    [RunInstaller(true)]
    public class Installer : System.Configuration.Install.Installer
    {
        public Installer()
        {

        }

        public override void Install(System.Collections.IDictionary stateSaver)
        {
            base.Install(stateSaver);

            try
            {
                var varName  = this.Context.Parameters["VariableName"];
                var valToAdd = this.Context.Parameters["Value"];
                var newVal   = String.Empty;

                var curVal = Environment.GetEnvironmentVariable(varName);

                if (curVal != null && curVal.Contains(valToAdd))
                {
                    return;
                }

                newVal = (curVal == String.Empty) ? valToAdd 
                                                      : curVal + ";" + valToAdd;

                Environment.SetEnvironmentVariable(varName, newVal,
                      EnvironmentVariableTarget.Machine);
            }
            catch (Exception ex)
            {
                // message box to show error
                this.Rollback(stateSaver);
            }
        }
    }
} 
```

此代码需要对 System.Configuration.Install 的引用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-29T23:19:57.607

您可以访问并附加到此注册表位置的当前路径：

```
HLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment\Path 
```

这是在您的安装程序中进行的更好的更改，而不是在您的实际应用程序中。

确保*附加*到注册表值，而不仅仅是*设置*它......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-29T23:18:17.623

大多数安装程序将允许您附加到系统路径环境变量。检查此功能的文档。

如果您手动安装，您可以使用 setx.exe（来自资源工具包 IIRC）来修改路径 - 但要小心，您不想只用应用程序的目录替换现有路径，他有经验说 :)

或者，我最喜欢在脚本中使用 WMI：

例如。

```
strComputer = "."
Set objWMIService = GetObject("winmgmts:\\" & strComputer & "\root\cimv2")

Set objVariable = objWMIService.Get("Win32_Environment").SpawnInstance_

objVariable.Name = "Path"
objVariable.UserName = "System"
objVariable.VariableValue = "c:\myapp"
objVariable.Put_ 
```

# asp.net - 如何将图像从 Flash 传递到 ASP.NET？

> ID：928508
> 
> 赞同：8
> 
> 时间：2009-05-29T23:13:05.280
> 
> 标签：asp.net, flash, actionscript-3, image-upload

快速版本：

如何将在用户浏览器上生成的图像返回到服务器？

目前的计划是这样的：

1.  Flash 开发人员会将位图转换为 JPEG
2.  然后，他会将 JPEG 文件发布到网站上的页面。
3.  我在想我可以创建一个`WebService`将使用 a`StreamReader`来阅读帖子并将其保存为文件的内容。

那行得通吗？这样做的任何现有代码/示例？

我想我们应该能够查看将任何文件上传到 ASP.NET 的代码。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-11-06T15:56:52.520

在此示例中，我在舞台上创建了一个带有按钮的 Flash 文件。当您单击该按钮时，Flash 会将按钮的图像发送到一个 ASPX 文件，该文件将其保存为 JPEG。正如您将看到的，这是通过将 绘制`DisplayObject`到`BitmapData`对象中来完成的，因此，您可以轻松地将按钮的引用替换为继承自的任何内容`DisplayObject`（包括包含用于绘画应用程序的画布的影片剪辑等）。

我将先向您介绍 Flash 元素，然后再介绍 .NET 后端。

**闪光**

要将这样的生成图像从 Flash 发送到 ASP.NET（或任何其他后端），您将需要几个 3rd 方库。我们需要一个 JPEG 编码器（Flash 没有，但最新版本的 Flex 有），我们可以从 AS3 Core Lib [http://code.google.com/p/as3corelib/ 获得](http://code.google.com/p/as3corelib/)它。我们还需要一个 base64 编码器来通过网络发送数据。我将使用来自[http://dynamicflash.com/goodies/base64/](http://dynamicflash.com/goodies/base64/)的 Dynamic Flash 中的那个。

下载这些并将它们解压缩到硬盘上的某个合适的位置（例如 C:\lib 文件夹）。

我创建了一个新的 AS3 Flash 文件并将其保存为*uploader.fla*。我在舞台上添加了一个按钮组件并将其命名为*btnUpload*。接下来，我编辑了 ActionScript 设置并将我的*c:\lib*文件夹添加到类路径中。然后我给文档取了一个类名*Uploader*并保存了文件。

接下来，我创建了一个 ActionScript 文件并向其中添加了以下代码：

```
package
{
    import flash.display.BitmapData;
    import flash.display.MovieClip;
    import flash.events.MouseEvent;
    import flash.net.URLLoader;
    import flash.net.URLRequest;
    import flash.net.URLRequestMethod;
    import flash.net.URLVariables;
    import flash.utils.ByteArray;
    import fl.controls.Button;
    import com.adobe.images.JPGEncoder;
    import com.dynamicflash.util.Base64;

    public class Uploader extends MovieClip
    {
        // Reference to the button on the stage
        public var btnUpload:Button;

        // Encoder quality
        private var _jpegQuality:int = 100;

        // Path to the upload script
        private var _uploadPath:String = "/upload.aspx";

        public function Uploader()
        {
             btnUpload.addEventListener(MouseEvent.CLICK, buttonClick);
        }

        private function buttonClick(e:MouseEvent):void
        {
            // Create a new BitmapData object the size of the upload button.
            // We're going to send the image of the button to the server.
            var image:BitmapData = new BitmapData(btnUpload.width, btnUpload.height);

            // Draw the button into the BitmapData
            image.draw(btnUpload);

            // Encode the BitmapData into a ByteArray
            var enc:JPGEncoder = new JPGEncoder(_jpegQuality);
            var bytes:ByteArray = enc.encode(image);

            // and convert the ByteArray to a Base64 encoded string
            var base64Bytes:String = Base64.encodeByteArray(bytes);

            // Add the string to a URLVariables object
            var vars:URLVariables = new URLVariables();
            vars.imageData = base64Bytes;

            // and send it over the wire via HTTP POST
            var url:URLRequest = new URLRequest(_uploadPath);
            url.data = vars;
            url.method = URLRequestMethod.POST;

            var loader:URLLoader = new URLLoader();
            loader.load(url);
        }
    }
} 
```

我将此文件保存在 FLA 旁边，名称为*Uploader.as*。

我将 SWF 发布到我的 Asp.NET 网站的根目录中。此代码假定您要上传质量为 100% 的 jpeg，并且将接收数据的脚本称为 upload.aspx，并且位于站点的根目录中。

**ASP.NET**

在我网站的根目录中，我创建了一个名为upload.aspx 的WebForm。在 .aspx 文件中，我删除了除 page 指令之外的所有内容。它的内容是这样的：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="upload.aspx.cs" Inherits="upload" %> 
```

然后在 CodeBehind 中，我添加了以下内容：

```
using System;
using System.IO;

public partial class upload : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        // Get the data from the POST array
        string data = Request.Form["imageData"];

        // Decode the bytes from the Base64 string
        byte[] bytes = Convert.FromBase64String(data);

        // Write the jpeg to disk
        string path = Server.MapPath("~/save.jpg");
        File.WriteAllBytes(path, bytes);

        // Clear the response and send a Flash variable back to the URL Loader
        Response.Clear();
        Response.ContentType = "text/plain";
        Response.Write("ok=ok");
    }
} 
```

显然有硬编码的值，例如保存路径，但您应该能够从这里创建您需要的任何系统。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T08:55:47.120

如果需要对图片进行操作，只要能拿到POST文件的byte[]或者Stream，就可以创建它的图片，例如

```
MemoryStream mstr = new MemoryStream(myByteArray);
Image myImage = Image.FromStream(mstr); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-30T00:07:08.040

让他像标准 HTML 表单一样发布文件。您可以使用以下集合在他发布到的页面的 Page_Load 事件中访问这些文件

请求文件

这将返回 HttpPostedFiles 的集合，就像 FileUpload 控件所做的一样。

# excel - 我可以使用什么文本格式来呈现 Excel 电子表格中的原始数据？

> ID：928513
> 
> 赞同：1
> 
> 时间：2009-05-29T23:14:27.180
> 
> 标签：excel, perl, text, yaml

我有一个 Excel 电子表格，其中包含许多人对另一个人的身高和体重的估计。此外，有些人在这两个估算单元格上都留下了评论，例如“此估算考虑了某某”。

我想从电子表格中获取数据（我已经想出了如何解析它），并将其表示为纯文本文件，以便我可以轻松地将其解析回结构化格式（理想情况下使用 Perl）。

最初我想使用 YAML：

```
Tom:
  Height:
    Estimate: 5
    Comment: Not that confident
  Weight:
    Estimate: 7
    Comment: Very confident
Natalia: ... 
```

但是现在我认为这有点难以阅读，我想知道是否有一些文本表格表示会更容易阅读并且仍然可以解析。

就像是：

```
PERSON      HEIGHT     Weight
-----------------------------
Tom         5          7
___START_HEIGHT_COMMENT___
    We hold these truths to be self-evident, that all men are created equal, that they are endowed by their Creator with certain unalienable Rights, that among these are Life, Liberty and the pursuit of Happiness.  That to secure these rights, Governments are instituted among Men, deriving their just powers from the consent of the governed [...]  
Wait, what's this project about again?
___END_HEIGHT_COMMENT___
___START_WEIGHT_COMMENT___
    We hold these truths to be self-evident, that all men are created equal, that they are endowed by their Creator with certain unalienable Rights, that among these are Life, Liberty and the pursuit of Happiness.  That to secure these rights, Governments are instituted among Men, deriving their just powers from the consent of the governed [...]  
Wait, what's this project about again?
___END_WEIGHT_COMMENT___

Natalia     2          4
John        3          3 
```

有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-29T23:18:18.607

CSV（[逗号分隔值](http://en.wikipedia.org/wiki/Comma-separated_values)）。

您甚至可以将其从 Excel 中直接保存为这种格式，并从这种格式中直接将其读入 Excel。然而，它也是人类可读的，并且易于机器解析。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T02:10:21.757

通常，如果我想以文本形式从电子表格中捕获数据，我会使用 CSV（Excel 可以读取和写入）。它易于生成和解析，并且与许多其他工具兼容，但它在“人类可读”图表上的排名并不高。它可以被读取，但除了具有相等字段宽度的简单文件之外，它对于其他任何东西都很尴尬。

XML 是一种选择，但 YAML 更易于阅读。可读性是 YAML 的设计目标之一。[YAML::Tiny](http://search.cpan.org/perldoc?YAML::Tiny)模块是一个很好的轻量级模块，适用于典型案例。

看起来您想到的是纯文本表格，或者可能是带有固定列的表格格式。CPAN 上有一些可能有用的模块：[Text::Table](http://search.cpan.org/perldoc?Text::Table)、[Text::SimpleTable](http://search.cpan.org/perldoc?Text::SimpleTable)、[其他](http://search.cpan.org/search?mode=module&query=text%20table)......这些模块可以生成易于阅读但解析它的表示形式。（它们旨在用于数据表示，而不是存储和检索。）您可能必须构建自己的解析器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T19:18:44.270

还有用于简单数据的[Config::General](http://search.cpan.org/~tlinden/Config-General-2.42/General.pm)及其相关类系列。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-29T23:41:38.670

添加到罗伯特的答案中，您可以简单地将评论放在其他列中（逗号将被 Excel 的 CSV 输出过滤器等转义）。有关 CSV 格式的更多信息：www.csvreader.com/csv_format.php

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-30T00:11:36.893

没有理由不能使用 XML，尽管我认为在这种特殊情况下它是矫枉过正的。

# python - Tkinter：更改函数中的变量

> ID：928520
> 
> 赞同：1
> 
> 时间：2009-05-29T23:17:34.757
> 
> 标签：python, tkinter

我知道这种问题一直被问到，但要么我无法找到我需要的答案，要么当我这样做时我无法理解。

我希望能够做类似的事情：

```
spam = StringVar()
spam.set(aValue)
class MyScale(Scale):
    def __init__(self,var,*args,**kwargs):
        Scale.__init__(self,*args,**kwargs)
        self.bind("<ButtonRelease-1>",self.getValue)
        self.set(var.get())
    def getValue(self,event):
        ## spam gets changed to the new value set 
        ## by the user manipulating the scale
        var.set(self.get)
eggs = MyScale(spam,*args,**kwargs)
eggs.pack() 
```

当然，我回来了“NameError：未定义全局名称'var'。”

如何解决无法将参数传递给 getValue 的问题？我被警告不要使用全局变量，但这是我唯一的选择吗？它是否为我要更改的每个变量设置了一个单独的比例类？我觉得我错过了一些就在我鼻子底下的东西......

编辑：这是你的意思吗？

```
Exception in Tkinter callback
Traceback (most recent call last):
  File "C:\Python26\lib\lib-tk\Tkinter.py", line 1410, in __call__
    return self.func(*args)
  File "C:\...\interface.py", line 70, in getValue
    var.set(self.get)
NameError: global name 'var' is not defined 
```

抱歉，我才编程一个月，有些行话还是没听懂。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-30T05:45:14.190

请试一试。

那里的许多示例代码都大量使用全局变量，例如您的“var”变量。

我已使用您的 var 参数作为指向原始垃圾邮件对象的指针；分配给 MyScale 类中的 self.var_pointer。

下面的代码将更改秤的 ButtonRelease 上的“垃圾邮件”（和“鸡蛋”）的值。

您可以通过键入 egg.get() 或 spam.get() 来查看值以查看更改的值。

```
from Tkinter import *
root = Tk()

aValue = "5"
spam = StringVar()
spam.set(aValue)

class MyScale(Scale):
    def __init__(self,var,*args,**kwargs):
        self.var_pointer = var
        Scale.__init__(self,*args,**kwargs)
        self.bind("<ButtonRelease-1>",self.getValue)
        self.set(var.get())
    def getValue(self,event):
        ## spam gets changed to the new value set 
        ## by the user manipulating the scale
        self.var_pointer.set(self.get())

eggs = MyScale(spam)
eggs.pack(anchor=CENTER) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-29T23:37:13.937

我们来看看这个方法函数

```
 def getValue(self,event):
        ## spam gets changed to the new value set 
        ## by the user manipulating the scale
        var.set(self.get) 
```

该`var.set(self.get)`行正好有两个可用的局部变量：

*   `self`
*   `event`

该变量`var`不是此方法函数的本地变量。也许它在课程或脚本的其他地方使用过，但它不是本地的。

它可能是全球性的，但这是一种不好的做法。

我不确定为什么您会认为`var`在这种情况下会知道该变量。

# unit-testing - 如何针对特定用户类型测试我的 CakePHP 应用程序？

> ID：928528
> 
> 赞同：1
> 
> 时间：2009-05-29T23:20:46.887
> 
> 标签：unit-testing, cakephp

我正在 CakePHP 中进行单元测试。我想测试我的两个控制器。我的应用有不同类型的用户。我想根据登录的用户类型测试应用程序返回的结果。但是，我不知道如何从控制器测试用例登录到应用程序。我尝试了几种方法都没有成功。1) 我尝试使用用户控制器登录，然后运行我的测试用例，2) 尝试将 Web 测试用例与控制器单元测试分组。

任何帮助将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-30T18:10:13.783

试试[Mark-story 的](http://mark-story.com/posts/view/testing-cakephp-controllers-the-hard-way)关于测试控制器的文章。你不是真的测试单元吗？根据定义，[单元是应用程序中最小的可测试部分](http://en.wikipedia.org/wiki/Unit_testing)。为您的应用程序创建如此广泛的大型测试似乎是个坏主意，因为如果没有失败的测试，应用程序就无法增长。我相信您应该尝试将问题拆分为较小的部分。换句话说，确保用户被识别为正确的类型，并且给定该类型，他们无法访问他们不应该访问的特定信息。

# java - Java 是否有“是一种类”的测试方法

> ID：928531
> 
> 赞同：30
> 
> 时间：2009-05-29T23:21:21.753
> 
> 标签：java, reflection, inheritance, evaluation

我有一个基类，`Statement`其他几个类继承自，命名`IfStatement`，`WhereStatement`等...在语句中执行测试`if`以确定`Statement`实例派生自哪种类的最佳方法是什么？

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2009-05-29T23:25:31.293

```
if(object instanceof WhereStatement) {
   WhereStatement where = (WhereStatement) object;
   doSomething(where);
} 
```

请注意，这样的代码通常意味着您的基类缺少多态方法。ie`doSomething()`应该是一个`Statement`可能是抽象的方法，它被子类覆盖。

* * *

## 回答 #2

> 赞同：64
> 
> 时间：2009-05-29T23:25:22.540

```
if (obj.getClass().isInstance(Statement.class)) {
   doStuffWithStatements((Statement) obj));
} 
```

这种技术的好处（与“instanceof”关键字相反）是您可以将测试类作为对象传递。但是，是的，除此之外，它与“instanceof”相同。

注意：我故意避免对类型实例检查是否是*正确*的做法进行社论。是的，在大多数情况下，最好使用多态性。但这不是OP所要求的，我只是在回答他的问题。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-29T23:30:28.193

你的问题的答案是instanceof。

但是，请记住，如果您的代码需要 instanceof，则表明您的设计有问题。在某些情况下 instanceof 是合理的，但它们是例外。通常，如果您的子类需要表现不同，则必须使用多态性而不是 if()s。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-10-20T06:31:21.800

[`isAssignableFrom(java.lang.Class)`](http://download.oracle.com/javase/6/docs/api/java/lang/Class.html#isAssignableFrom(java.lang.Class))从课堂上是你的答案。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-10-07T21:10:12.757

试试这个：

```
if (Statement.class.isInstance(obj)) {
    doStuffWithStatements((Statement) obj));
} 
```

因为[Class.isInstance()](http://docs.oracle.com/javase/8/docs/api/java/lang/Class.html#isInstance-java.lang.Object-)方法将对象实例作为参数。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-29T23:43:17.077

这*不是*以面向对象的方式做事的方式，它是对旧代码/数据二分法的回归。现在这不一定是坏事（如果你知道自己在做什么），但它应该留给像 C 这样的非面向对象的语言。

通过适当的设计，您不需要那种行为。而不是构造：

```
if (obj.getClass().isInstance(Statement.class)) {
    doStuffWithStatements((Statement) obj));
} 
```

（向benjismith'窃取'他的代码道歉），你真的应该让对象本身对自己的活动负责，因此：

```
obj.doStuff(); 
```

然后每个不同`obj`的类都有自己的定义`doStuff`。这是正确的做法。

# domain-driven-design - 电子邮件通知 - 在域对象或服务中？

> ID：928533
> 
> 赞同：3
> 
> 时间：2009-05-29T23:22:22.907
> 
> 标签：domain-driven-design, business-logic

我正在寻找有关如何解决以下设计问题的建议（使用基于 stackoverflow 的虚构示例）。我试图避免一个贫乏的领域模型，并为这种类型的案例寻求一般的“最佳实践”建议。

### 设想：

假设正在为 stackoverflow 开发一个新功能，只要他/她的问题收到 10 个赞成票，就会向问题的所有者发送电子邮件通知。

域对象模型是这样的：

```
public class Question
{
    string Question { get; set; }
    IList<Votes> Upvotes { get; set; }
    User Owner { get; set; }

    public void AddUpvote(Vote upvote)
    {
        Upvotes.Add(upvote);
    }
} 
```

### 潜在的实现：

1.  更改`AddUpvote()`以获取`IEmailerService`参数并执行`AddUpvote()`方法内的逻辑。

    ```
    public void AddUpvote(Vote upvote, IEmailerService emailer)
    {
        Upvotes.Add(upvote);
        if ( Upvotes.Count == 10 )
        {
            emailer.Send(Owner.EmailAddr);
        }
    } 
    ```

2.  在内部检测此状态`AddUpvote()`并`AddUpvote()`从 IoC 容器解析 IEmailService（而不是将 IEmailerService 作为参数传递）。

3.  在调用 的外部服务对象中检测此状态`question.AddUpvote()`。

    ```
    public void UpvoteClickHandler(Question question)
    {
        question.AddUpvote(new Upvote());
        if ( question.Upvotes.Count == 10 )
        {
            _emailer.Send(question.Owner.EmailAddr);
        }
    } 
    ```

4.  *你更好的解决方案在这里！*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-29T23:52:47.633

您真的不想将这两者混合在一起，因为它们有不同的关注点。让 Question 类关心问题，让消息服务关心当投票达到 10、20、100 或...时该怎么做

以下示例仅用于演示目的，但您会明白这一点。有明确的关注点分离，因此如果发送消息的要求发生变化，Question 类不必更改。请记住，根据 SOLID 原则，一个类应该只有一个改变的理由。

```
public class Question
{
    public string Description { get; set; }
    public Int32 Votes { get; set; }
    public User Owner { get; set; }

    public event EventHandler<QuestionEventArgs> OnUpvote;

    private void RaiseUpvoteEvent(QuestionEventArgs e)
    {
        var handler = OnUpvote;
        if (handler != null) handler(this, e);
    }

    public void Upvote()
    {
        Votes += 1;

        RaiseUpvoteEvent(new QuestionEventArgs(this));
    }
}

public class MessageService
{
    private Question _question;

    public MessageService(Question q)
    {
        _question = q;

        q.OnUpvote += (OnUpvote);
    }

    private void OnUpvote(object sender, QuestionEventArgs e)
    {
        if(e.Question.Votes > 10)
            SendMessage(e.Question.Owner);
    }
}

public class QuestionEventArgs: EventArgs
{
    public Question Question { get; set; }

    public QuestionEventArgs(Question q)
    {
        Question = q;
    }
} 
```

所以你有它。有很多其他方法可以实现这一点，但事件模型是一个很好的方法，它实现了您在实现中想要的关注点分离，以便更早地进行维护。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-29T23:39:37.753

选项 1) 和 2) 都作为发送电子邮件的错误位置而跳出来。Question 实例不应该知道这两件事：

1.  它不应该知道策略，即何时发送电子邮件。
2.  它不应该知道策略的通知机制，即电子邮件服务。

我知道这是一个品味问题，但是您将问题与政策以及发送电子邮件的机制紧密联系在一起。将这个 Question 类移动到另一个项目（例如 ServerFault，它是 StackOverflow 的姊妹站点）真的很难

我对这个问题很感兴趣，因为我正在为我正在构建的帮助台创建一个通知系统。这是我在我的系统中所做的：

创建一个 NotificationManager（基本上，将通知的关注点完全移到一个单独的类中）。

```
public Class NotificationManager
{
    public void NotificationManager(NotificationPolicy policy, IEmailService emailer)
    {
    }
} 
```

然后我按照这个思路做了一些事情（UpvoteClickHandler 依赖于 NotificationManager 实例）：

```
public void UpvoteClickHandler(Question question)
{
    question.AddUpvote(new Upvote());
    _notificationManager.Notify(Trigger.UpvoteAdded, question);
} 
```

UpvoteClickHandler 所做的就是告诉 NotificationManager 已向问题添加了赞成票，并让 NotificationManager 确定是否以及如何发送电子邮件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-28T11:03:20.917

大家好，

在我看来，“每当他/她的问题收到 10 个赞成票时，向他/她的问题的所有者发送电子邮件通知”是域逻辑，因此它应该进入域对象，以避免贫血域。

必须进入基础设施层的是发送电子邮件（即与 smtp 服务器通信）的操作。

所以我认为选项1并非完全错误。请记住，您始终可以通过传递 IEmailerService 的模拟实现来测试您的对象。

此致，

斯特凡诺

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-29T23:48:40.403

答案取决于您对应用程序和对象设计的基本方法。并且（在此处编辑）您认为系统最重要的特征。看起来你有数据、问题和业务规则，赞成票。根本不质疑对象。因此，您应该将数据视为数据并允许数据工具对其进行处理，而不是将行为混入其中。传统的对象设计将所有行为和数据都包含在对象中，因此发送电子邮件将属于对象。（选项 1 和 2）我想这是黑匣子或自包含对象方法。正如我所了解的那样，现代实践将对象作为简单的数据持有者。这意味着要四处移动，持久化，转换并对其进行处理。也许生活在 C 语言中只是结构。

# c# - 数据包捕获到数据库？

> ID：928535
> 
> 赞同：1
> 
> 时间：2009-05-29T23:22:50.407
> 
> 标签：c#, .net, database

我是数据库/PC 应用程序 sp 的完全新手，请原谅我的无知。

我想实时捕获数据包到数据库，以便多个应用程序能够监控通过来自 PLC 的 udp 数据包返回的物理 I/O 数据，我有几个问题。

从长远来看，它需要跨平台，但目前我在 Windows 中使用 C# 数据包捕获库。关于数据库类型 MySQL 与 SQlite 的任何建议？

在每秒约 1500 个 200 字节数据包的情况下，每秒插入一个数据包 1500 次是否可行？我已经读到 SQlite 在并发性方面存在一些问题，如果我有一个应用程序以 25-50 毫秒的延迟以每秒 10 次查询数据库中的数据包数据 - 这可行吗？

我希望任何时候“只”需要在数据库中存储 20MB 左右的数据。数据库可以强制只在内存中运行吗？写入数据包数据时，能否将数据包（字节数组）写入一个语句而不是迭代插入每个字节/字？我想我可以把它变成一个字符串，但我希望这几乎不可能以任何速度查询。在我简要查看的任何数据库中，我都没有看到任何提及“字节数组类型”之类的东西。FWIW 所有数据都将发送到静态 IP 上的专用 NIC。数据包是顺序的（我知道 UDP 不能保证它，但我还没有见过有问题的数据包）如果数据库支持数组类型，我可以轻松地遍历数据。- 很好，没有随机搜索？

感谢您抽时间阅读。

鲍勃

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-30T00:14:09.523

为此，您在关系数据库中寻找的感知优势是什么？既然您说您不太喜欢数据库，这里简要介绍一下为什么选择 SQL 的常见原因，也许它可以帮助您澄清您的要求和您的选择：

1.  可查询性。如果您想公开数据以进行*丰富的*搜索，其中包括过滤记录、排序结果、聚合计算的选项，那么 SQL 数据库确实提供了这样的功能。他们不是免费的。为了加快搜索速度，数据库引擎必须将部分数据复制到多个索引中，这会增加插入/更新时间，因为必须维护所有这些索引。
2.  可恢复性。数据库可以确保数据在发生崩溃时保持一致状态。使用预写日志或版本更新，他们以一种方式编写更改，而不是确保客户在他的语句返回给他时所做的更改是持久的（为简单起见，我省略了一堆细节）。
3.  一致性。通过隔离用户之间的更改，直到他们明确提交一组相关操作，数据库始终向查看者公开一致的状态。为了实现这一点，数据库必须部署锁定或版本控制。
4.  可扩展性。数据库可以负责维护非常大的数据集，比进程可行的地址空间大得多。他们将使用缓冲池来缓存热页并管理底层文件偏移量到内存地址的映射以及从磁盘读取和写回更改所需的所有 I/O。它们还将多个文件呈现为一个统一的存储区域，从而超过操作系统文件大小的限制（如果有的话）。
5.  互操作性。其他进程可以使用标准库（即 ODBC、ADO 等）和语言 (SQL) 对数据进行操作，因此无需开发自定义库/访问 API。

现在，您的方案是否需要这些中的任何一个？还有什么我遗漏的吗？我问这些问题是因为您想要实现的目标并非微不足道。您可以相对轻松地实现每秒 1500 次插入，但要做到这一点*并*提供良好的读取性能要困难得多。此外，关系数据库提供的大部分功能（一致性、可恢复性、可伸缩性）似乎都不是您的目标。有许多产品专门针对内存中的细分市场进行了调整，这些产品比您从典型的面向磁盘的关系数据库中获得的产品要快得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T00:13:39.277

编辑：我忘了你在 C# 中工作。

首先，您是否打算从多台计算机上查询数据库？如果是这样，你会想要使用 MySQL。否则，SQLite 可能是一个不错的选择。但请注意，多个 C# 应用程序和内存数据库可能需要 MySQL。如果您选择 MySQL，请使用[MySQL Connector/NET](http://dev.mysql.com/doc/refman/5.0/en/connector-net.html)。对于 SQLite，有[System.Data.SQLite](http://sqlite.phxsoftware.com/)（我已将其用于 WinForms 应用程序并且可以推荐）。

您说每个语句需要执行 1500 200 字节插入语句。 [SQLite 报告](http://www.sqlite.org/faq.html#q19)说它每秒可以执行 50,000 次。关键的警告是，这是指原始插入，而不是事务。提交事务会减慢您的速度，因为这通常意味着刷新到磁盘。

SQLite（参见他们的[In-Memory Databases](http://www.sqlite.org/inmemorydb.html)）和 MySQL（参见他们的[MEMORY (HEAP) Storage Engine](http://dev.mysql.com/doc/refman/5.0/en/memory-storage-engine.html)）都可以使用内存数据库。但是，对于 SQLite，这可能会破坏您让“多个应用程序”访问它的目标。使用 SQLite，您可以通过一种未记录的方式（并且“不保证在未来的 SQLite 版本中工作”）可以共享内存数据库（例如使用共享内存）。它在[之前的 SO question](https://stackoverflow.com/questions/837067/how-do-i-open-an-in-memory-database-file-into-sqlite3)中讨论过；另请参阅 SQLite 主要作者的[链接邮件消息](http://www.mail-archive.com/sqlite-users@sqlite.org/msg15905.html)。请注意，如果您坚持使用托管代码，则可能无法共享 SQLite 内存数据库。您绝对可以在多个客户端之间共享一个 MySQL 内存数据库。

使用任一 C# 客户端，您都应该能够使用[DbParameter](http://msdn.microsoft.com/en-us/library/system.data.common.dbparameter.aspx)（即 SQLiteParameter 或 MySqlParameter）在单行中插入整个数据包。请特别注意 Value 和 Size 属性。

我认为您不需要任何“数组类型”。您可以简单地拥有一个递增的主键 (INTEGER PRIMARY KEY) 列和一个数据包内容列（BLOB 或 TEXT）。我不确定哪一个 BLOB 或 TEXT 将为您提供 SQLite 的最佳性能。您的 SQLite 架构可能看起来像

```
CREATE TABLE packets ( id INTEGER PRIMARY KEY, packet BLOB); 
```

然后，您可以轻松地在一定范围的主键中选择例如数据包。当然，您可以添加一个日期时间列，但这需要索引。对于 MySQL，它将类似于：

```
CREATE TABLE packets ( id INTEGER PRIMARY KEY, packet VARCHAR(200)) ENGINE=MEMORY; 
```

我希望这有帮助。请记住，分析是确定什么对您的应用程序有效的最佳方式。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-05-30T00:21:34.503

libpcap、wireshark 循环文件

环顾四周，玩一下wireshark，看看它是如何达到与你相似的结果的。

# java - JSP 和商标符号

> ID：928541
> 
> 赞同：0
> 
> 时间：2009-05-29T23:27:38.963
> 
> 标签：java, jsp, symbols

在我们应用程序的网页上，商标符号 (TM) 显示为问号。不过，注册商标 (R) 有效。我们在 JSP 标准库中使用 c:out 标记显示该值。如果我把 ™ 或 ™ 在页面上测试这一点，那些显示为他们应该的。

```
<td><c:out value="${item.description}"/></td> <!-- does not work -->
<td>yada yada yada Spiros&trade; yada yada yada</td> <!-- works --> 
```

除此之外，我们还使用 YUI，在显示这些页面之前，它们会作为查询结果显示在 YUI 数据表中（用户单击一行以转到上述页面）。（TM）在该表中正确显示。这告诉我，我们正在正确地从数据库中获取值，并且生成 XML 以发送回 YUI 数据表的服务器代码也可以正常工作。

那么为什么相同的字符串在 YUI 数据表中正确显示，但在普通 JSP 中却没有，除非我们将符号硬编码到页面上？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-29T23:49:21.400

您可能有编码问题。如果您的 JSP 中没有显式编码：

```
<%@ page contentType="text/html; charset=UTF-8" pageEncoding="UTF-8" %> 
```

那么是时候添加一个了。尝试 UTF-8，如果不起作用，请尝试 ISO-8859-1 ...或者如果您知道正确的编码，请使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-29T23:46:09.300

当 char 显示为 ? 在浏览器（通常是 Firefox）中，这意味着页面编码（因为它被浏览器检测到将无法识别字符。一个很好的测试是在 Firefox 中查看->字符编码->UTF-8。如果字符显示正确，那么这意味着 (tm) char 使用 UTF-8 标准编码。您必须指示您的页面将响应编码标头设置为 UTF-8。这应该适合您。

如果这不起作用，您应该首先找出字符是如何编码的（例如，查看从数据库中读取的编码）并尝试将页面编码标头设置为该编码。

第二种格式有效，因为 (TM) 字符被编码为已知的 html 实体，浏览器会解释该实体，而不管页面编码如何。

# jquery - Tablesorter：如何继续斑马进入页脚

> ID：928544
> 
> 赞同：1
> 
> 时间：2009-05-29T23:30:45.477
> 
> 标签：jquery, html

我有一个带有我们的小电话列表的硬编码 HTML 表格，并且我在页脚中有空站，因此它们不会被表格排序器排序。但是，这也排除了它们被 tablesorter 斑马条纹。有没有办法让 tablesorter 看到页脚以用于斑马目的但不能用于排序？或者我应该只使用 jQuery 进行斑马条纹而不使用 tablesorter 的小部件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T17:00:39.817

所以解决方案最终是继续使用 tablesorter 进行排序和斑马，但也只是独立地使用 jQuery 通过`$("#tableid tr:odd").addClass("odd");`在相同的准备函数中添加类似的东西来独立斑马条纹页脚。由于这正是 zebra 小部件开始时所做的事情，因此结果完全相同，但它现在也扩展到了页脚。生成的表格将是适当的斑马条纹，但我们想要固定到底部的行保持不变。

# java - 对于会导致“EXCEPTION_ACCESS_VIOLATION (0xc0000005)”的原因，是否有任何一般的经验法则？

> ID：928545
> 
> 赞同：0
> 
> 时间：2009-05-29T23:30:53.090
> 
> 标签：java, exception

我已经在互联网上搜索了在 java 中可能导致“EXCEPTION_ACCESS_VIOLATION (0xc0000005)”的原因，但除了重新安装您的 jvm 之外我找不到任何东西。我知道这是我的代码的问题，我的代码中的什么可能导致这种情况？

此异常总是在我创建数据库连接后直接发生，并且总是与 ntdll.dll 有关。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-29T23:38:47.380

这意味着在由 Java 加载的本机代码（C 或 C++）中发生了崩溃，可能是空指针访问，在这种情况下，可能是数据库驱动程序。如果您有权访问本机库的源代码，则可以尝试通过在崩溃发生之前将本机调试器（如 Visual Studio）附加到 Java 进程来对其进行调试。否则，您需要向编写有问题的本机代码的人报告错误。请注意，从技术上讲，它可能不是本机代码中的“错误”。可能是您的代码传入了错误的参数，而它们只是没有很好地处理错误检查。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-29T23:38:44.353

看起来像是 JVM 或数据库驱动程序中的错误，或两者兼而有之。也许不同的版本会起作用？

# c# - URL 路由和 IIS6。我该如何测试它？

> ID：928546
> 
> 赞同：1
> 
> 时间：2009-05-29T23:31:21.437
> 
> 标签：c#, asp.net, url-routing, http-status-code-404, webforms-routing

当我在 IIS6 和 Webforms 上实现 URL 路由时，我似乎无法理解如何找出错误所在。

当我尝试访问路由时，我继续收到 404 错误。

我按此处所述添加 ISAPI 模块：http: [//blog.codeville.net/2008/07/04/options-for-deploying-aspnet-mvc-to-iis-6/](http://blog.codeville.net/2008/07/04/options-for-deploying-aspnet-mvc-to-iis-6/)

这样 ASP.Net 处理所有请求，但是我在访问该站点时收到 404 错误。

有没有办法判断 URL 路由引擎是否收到请求？

* * *

**更新：** 对于 64 位版本的 Windows（我没有提到），正确的 DLL 是：

> **C:\WINDOWS\Microsoft.NET\Framework64\v2.0.50727\aspnet_isapi.dll**

如果您不确定哪个版本（或者您想确保获得正确的路径），只需复制通配符映射框上方列表框中**“aspx”扩展的可执行路径中的值。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-30T01:53:17.593

以下是我们为解决此问题而采取的确切步骤，尽管您可能已经根据您的帖子完成了此操作。在我们的开发机器上，它运行良好，但在带有 IIS6 的 Windows 2003 服务器上却不行。

1.  在 IIS 中，右键单击**Virtual Directory**，选择**Properties**。
2.  在**目录**选项卡下，单击**配置...**按钮。
3.  在**Mappings**选项卡下，在**Wildcard application maps** (order of implementation) 下：单击**Insert...**按钮。
4.  浏览并选择**C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\aspnet_isapi.dll**为 32 位或**C:\WINDOWS\Microsoft.NET\Framework64\v2.0.50727**为 64 位，离开验证文件未经检查就存在。
5.  **将**aspnet_isapi.dll 上移到列表顶部。
6.  单击**确定，确定**，然后尝试。如果您没有看到它工作，请尝试回收应用程序池。

你能确认这是一个服务器，而不是你的开发盒吗？你能确认服务器有 .Net 3.5 SP1 吗？

# http-headers - 在 Javascript 中通过 XMLHttpRequest 使用 Google 的 ClientLogin 接口

> ID：928547
> 
> 赞同：1
> 
> 时间：2009-05-29T23:32:24.553
> 
> 标签：http-headers, xmlhttprequest

我正在尝试学习 Google 代码网站上帐户身份验证 API 中详细介绍的 ClientLogin 接口。

我正在使用 Firefox 3.5pre (Shiretoko) 和`XMLHttpRequest`Javascript 中的对象来跟踪该过程。这是我所拥有的精简版：

```
<html>
<head>
<title>Test</title>
<script type="text/javascript">
  //<![CDATA[
function update() {
  var auth_params = "accountType=HOSTED_OR_GOOGLE&Email=val"
                    +"&passwd=val&service=cl&source=MMA-Learning";
  var request = new XMLHttpRequest();

  request.open('POST', 'https://www.google.com/accounts/ClientLogin', true);

  request.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
  request.setRequestHeader("Content-Length", auth_params.length);
  request.setRequestHeader("Connection", "close");

  request.onreadystatechange = function () {
    if (this.readyState == 4 && this.status == 200) {
      alert ("Request done");
    }
  };

  try {
    request.send( auth_params );
  } catch (e) {
    alert ("Send Exception:\n"+e);
  }
}
  //]]>
</script>
</head>
<body>
  <a href="javascript:update()">Authenticate</a>
</body>
</html> 
```

当我单击*Authenticate*链接时，我得到的只是`Bad Request`响应。检查请求标头，我没有看到`Content-Type`设置为`application/x-www-form-urlencoded`.

我正在使用 Firebug 1.5X 来检查流量。

现在，我要做的就是生成*示例请求*部分中提到的请求并获得*示例响应*部分中提到的响应。如果我到达那里，我想获取一些特定于帐户的数据，例如未读的 Google Reader 提要等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-10-07T13:52:11.037

我怀疑您已经被 Javascript 的“同源”政策所困扰。它可以防止 Javascript（包括 XmlHttpRequest）从另一个域访问一个域。更多信息可从[Mozilla](https://developer.mozilla.org/En/Same_origin_policy_for_JavaScript "Mozilla")获得。

有一些技巧可以解决这个问题，但我不知道它们是否可以与 Google 的 API 一起使用。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-07-30T16:23:38.713

“passwd”中的“p”是小“p”而不是大写“P”

你可能想通了。当您发布并找到答案时，如果您也发布答案总是有礼貌的。这有助于将来查看您的帖子以获取信息的人

那个“p”花了我两个小时才找到，因为我认为谷歌给出的代码是正确复制的，没有大小写错误

互联网上充满没有答案的问题毫无意义

# database - 如何创建最近过期的域列表？

> ID：928549
> 
> 赞同：2
> 
> 时间：2009-05-29T23:32:48.563
> 
> 标签：database, dns, whois

我看到许多网站提供列出最近过期域名的服务。我还看到很多关于如何使用这些网站的博客。

但是，它们都没有解释以计算机化方式生成列表所必需的。是否可以在不保存所有域名并查询 whois 以查看注册是否消失的情况下执行此操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T00:03:59.950

好吧，您不会每天都对照 whois 检查每个域。相反，您将通过 whois 跟踪每个域的到期日期，并且仅检查已过期的域以查看它们是否已续订。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-03-25T07:17:25.930

[WhoisFreaks](https://whoisfreaks.com/)以 CSV 格式提供系统化、经过良好解析和规范化的过期域名 Whois 文件。您只需下载该文件，即可在同一列中获取所有即将到期的域。无需重新排列域。对于那些在当前日期后 1 个月和前 1 个月到期的域，您可以下载即将到期的域及其 Whois 信息。

有三种方法可以获取 WhoisFreaks 过期域文件。

*   您可以直接从计费仪表板手动下载。
*   最新生成的文件将通过电子邮件发送给您。
*   您还可以通过 API 端点获取它。

[您可以在此处](https://files.whoisfreaks.com/v1.0//sample?fileType=expired)查看 WhoisFreaks 过期域 whois 示例文件。

# asp.net - 如何指定不应将 ASP.NET 主题应用于特定文件夹？

> ID：928555
> 
> 赞同：2
> 
> 时间：2009-05-29T23:37:35.870
> 
> 标签：asp.net, themes

我碰巧有一个 ASP.NET 2.0 项目，我想在其中应用站点范围的主题。因此，我`web.config`通过设置 system.web.pages 元素的“主题”属性在文件中指定了主题。

现在，我添加了一个新文件夹，其中包含我不希望将主题应用到的第三方代码（事实上，我不能，因为许多第三方页面没有`runat="server"`标题所需的标签ASP.NET 主题系统）。有没有办法从文件中指定应从主题中**排除**`web.config`的文件夹，而无需更改任何第三方页面？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-29T23:45:14.857

您可以使用页面指令主题覆盖它 =false

或者，在文件夹中放置一个 web 配置文件，这将仅适用于该文件夹。

这应该为您演示

[http://www.aspdotnetfaq.com/Faq/how-to-apply-different-configuration-settings-in-web-config-to-specific-pages-and-folders-in-asp-net-website.aspx](http://www.aspdotnetfaq.com/Faq/how-to-apply-different-configuration-settings-in-web-config-to-specific-pages-and-folders-in-asp-net-website.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-29T23:56:27.267

只是一个想法（我从未尝试过）：

也许可以通过在 web.config 中使用 location 元素，例如：

```
<system.web>
    <pages theme="MyTheme">
    ..
</system.web>
<location path="~/3rdPartyPages">
    <system.web>
        <pages theme=""></pages>
    </system.web>
</location> 
```

# nhibernate - 使用 Spring.net 设置 NHibernate 验证器

> ID：928560
> 
> 赞同：1
> 
> 时间：2009-05-29T23:40:47.937
> 
> 标签：nhibernate, validation, spring.net

如何使用 Spring.net 作为 IoC 设置 NHibernate Validator？

我已经在使用 Spring.net 与 NHibernate 的集成，并且无法让 AutoRegisterListeners 工作。

我需要设置 NHV 以在更新/保存时自动验证实体，而不必每次都调用 Validate 方法并使用 Spring.net 和 ISharedEngineProvider 来确保最佳性能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T10:05:55.433

环顾四周后，我发现了这个：http: [//forum.springframework.net/showthread.php?t=5286](http://forum.springframework.net/showthread.php?t=5286)

我在这里重复它，让其他人发现我做的更容易！：

```
<object id="sessionFactory" type="Spring.Data.NHibernate.LocalSessionFactoryObject, Spring.Data.NHibernate20">

    <!-- the usual properties ... -->

    <!-- event listeners -->
<property name="EventListeners">
      <dictionary>
        <entry key="PreUpdate">
          <object type="NHibernate.Validator.Event.ValidatePreUpdateEventListener, NHibernate.Validator" />
        </entry>
        <entry key="PreInsert">
          <object type="NHibernate.Validator.Event.ValidatePreInsertEventListener, NHibernate.Validator" />
        </entry>
      </dictionary>
    </property>  </object> 
```

# math - 评估一串简单的数学表达式

> ID：928563
> 
> 赞同：76
> 
> 时间：2009-05-29T23:43:13.003
> 
> 标签：math, parsing, code-golf, text-parsing, infix-notation

## 挑战

这是挑战（我自己的发明，但如果它以前出现在网络上的其他地方，我不会感到惊讶）。

> 编写一个函数，该函数接受单个参数，该参数是简单数学表达式的字符串表示形式，并将其计算为浮点值。“简单表达式”可以包括以下任何一种：正数或负数十进制数、**+**、**-**、*****、**/**、**(**、、**)**。表达式使用（正常）中[缀表示法](http://en.wikipedia.org/wiki/Infix_notation)。运算符应该按照它们出现的顺序进行评估，即*不像*在 [BODMAS](http://en.wikipedia.org/wiki/BODMAS)中那样，当然应该正确地观察括号。该函数应该为*任何返回正确的结果*这种形式的可能表达。但是，该函数不必处理格式错误的表达式（即语法错误的表达式）。
> 
> 表达式示例：
> 
> ```
> 1 + 3 / -8                            = -0.5       (No BODMAS)
> 2*3*4*5+99                            = 219
> 4 * (9 - 4) / (2 * 6 - 2) + 8         = 10
> 1 + ((123 * 3 - 69) / 100)            = 4
> 2.45/8.5*9.27+(5*0.0023)              = 2.68... 
> ```

## 规则

我预计这里会有某种形式的“作弊”/狡猾，所以请让我提前警告！通过作弊，我指的是`eval`在动态语言（如 JavaScript 或 PHP）中使用或等效函数，或者同样在运行中编译和执行代码。（我认为我对“无 BODMAS”的规范几乎可以保证这一点。）除此之外，没有任何限制。我预计这里会有一些正则表达式解决方案，但很高兴看到更多。

现在，我主要对这里的 C#/.NET 解决方案感兴趣，但任何其他语言也完全可以接受（特别是用于功能/混合方法的 F# 和 Python）。我还没有决定是否接受最短或最巧妙的解决方案（至少对于语言）作为答案，但我欢迎**任何语言的任何形式的解决方案**，除了我刚刚在上面禁止的！

## 我的解决方案

我现在在[这里](https://stackoverflow.com/questions/928563/code-golf-evaluating-mathematical-expressions/929459#929459)发布了我的 C# 解决方案（403 个字符）。**更新：** 在一些可爱的正则表达式的帮助下，[我的新解决方案在](https://stackoverflow.com/questions/928563/code-golf-evaluating-mathematical-expressions/944716#944716)**294 chars**上明显击败了旧解决方案！我怀疑这很容易被一些语法较轻的语言（特别是功能/动态语言）击败，并且已被证明是正确的，但我很好奇是否有人仍然可以在 C# 中击败它。

## 更新

我已经看到了一些非常狡猾的解决方案。感谢所有发布过的人。尽管我还没有测试过它们中的任何一个，但我会相信人们并假设他们至少可以使用所有给定的示例。

只是为了说明，重入（即线程安全）*不是*该功能的要求，尽管它是一个奖励。

* * *

## 格式

为了便于比较，请按以下格式发布所有答案：

> ## 语言
> 
> **字符数：???**
> 
> 完全混淆的功能：
> 
> ```
> (code here) 
> ```
> 
> 清除/半混淆功能：
> 
> ```
> (code here) 
> ```
> 
> 关于它所采用的算法/聪明快捷方式的任何注释。

* * *

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-06-02T09:19:21.363

## 汇编器

**427 字节**

混淆，用优秀的[A86](http://eji.com/a86/)组装成 .com 可执行文件：

```
dd 0db9b1f89h, 081bee3h, 0e8af789h, 0d9080080h, 0bdac7674h, 013b40286h
dd 07400463ah, 0ccfe4508h, 08ce9f675h, 02fc8000h, 013b0057eh, 0feaac42ah
dd 0bedf75c9h, 0ba680081h, 04de801h, 04874f73bh, 04474103ch, 0e8e8b60fh
dd 08e8a003fh, 0e880290h, 0de0153h, 08b57e6ebh, 0d902a93eh, 046d891dh
dd 08906c783h, 05f02a93eh, 03cffcee8h, 057197510h, 02a93e8bh, 08b06ef83h
dd 05d9046dh, 02a93e89h, 03bc9d95fh, 0ac0174f7h, 074f73bc3h, 0f3cac24h
dd 0eed9c474h, 0197f0b3ch, 07cc4940fh, 074f73b09h, 0103cac09h, 0a3ce274h
dd 0e40a537eh, 0e0d90274h, 02a3bac3h, 021cd09b4h, 03e8b20cdh, 0ff8102a9h
dd 0ed7502abh, 0474103ch, 0e57d0b3ch, 0be02a3bfh, 014d903a3h, 0800344f6h
dd 02db00574h, 0d9e0d9aah, 0d9029f2eh, 0bb34dfc0h, 08a0009h, 01c75f0a8h
dd 020750fa8h, 0b0f3794bh, 021e9aa30h, 0de607400h, 08802990eh, 0de07df07h
dd 0c392ebc1h, 0e8c0008ah, 0aa300404h, 0f24008ah, 04baa3004h, 02eb0ee79h
dd 03005c6aah, 0c0d90ab1h, 0e9defcd9h, 02a116deh, 0e480e0dfh, 040fc8045h
dd 0ede1274h, 0c0d90299h, 015dffcd9h, 047300580h, 0de75c9feh, 0303d804fh
dd 03d80fa74h, 04f01752eh, 0240145c6h, 0dfff52e9h, 0d9029906h, 0f73b025fh
dd 03caca174h, 07fed740ah, 0df07889ah, 0277d807h, 047d9c1deh, 0990ede02h
dd 025fd902h, 03130e0ebh, 035343332h, 039383736h, 02f2b2d2eh, 02029282ah
dd 0e9000a09h, 07fc9f9c1h, 04500000fh, 0726f7272h
db 024h, 0abh, 02h 
```

**编辑：**未经混淆的来源：

```
 mov [bx],bx
        finit
        mov si,81h
        mov di,si
        mov cl,[80h]
        or cl,bl
        jz ret
    l1:
        lodsb
        mov bp,d1
        mov ah,19
    l2:
        cmp al,[bp]
        je l3
        inc bp
        dec ah
        jne l2
        jmp exit
    l3:
        cmp ah,2
        jle l4
        mov al,19
        sub al,ah
        stosb
    l4:
        dec cl
        jnz l1
        mov si,81h
        push done

    decode:
    l5:
        call l7
    l50:
        cmp si,di
        je ret
        cmp al,16
        je ret
        db 0fh, 0b6h, 0e8h ; movzx bp,al
        call l7
        mov cl,[bp+op-11]
        mov byte ptr [sm1],cl
        db 0deh
    sm1:db ?
        jmp l50

    open:
        push di
        mov di,word ptr [s]
        fstp dword ptr [di]
        mov [di+4],bp
        add di,6
        mov word ptr [s],di
        pop di
        call decode
        cmp al,16
        jne ret
        push di
        mov di,word ptr [s]
        sub di,6
        mov bp,[di+4]
        fld dword ptr [di]
        mov word ptr [s],di
        pop di
        fxch st(1)
        cmp si,di
        je ret
        lodsb
        ret

    l7: cmp si,di
        je exit
        lodsb
        cmp al,15
        je open
        fldz
        cmp al,11
        jg exit
        db 0fh, 94h, 0c4h ; sete ah 
        jl l10
    l9:
        cmp si,di
        je l12
        lodsb
        cmp al,16
        je ret
    l10:
        cmp al,10
        jle l12i

    l12:
        or ah,ah
        je l13
        fchs
    l13:
        ret

    exit:
        mov dx,offset res
        mov ah,9
        int 21h
        int 20h

    done:
        mov di,word ptr [s]
        cmp di,(offset s)+2
        jne exit
        cmp al,16
        je ok
        cmp al,11
        jge exit
    ok:
        mov di,res
        mov si,res+100h
        fst dword ptr [si]
        test byte ptr [si+3],80h
        jz pos
        mov al,'-'
        stosb
        fchs
    pos:
        fldcw word ptr [cw]
        fld st(0)
        fbstp [si]
        mov bx,9
    l1000:
        mov al,[si+bx]
        test al,0f0h
        jne startu
        test al,0fh
        jne startl
        dec bx
        jns l1000
        mov al,'0'
        stosb
        jmp frac

    l12i:
        je l11
        fimul word ptr [d3]
        mov [bx],al
        fild word ptr [bx]
        faddp
        jmp l9
        ret

    startu:
        mov al,[si+bx]
        shr al,4
        add al,'0'
        stosb
    startl:
        mov al,[si+bx]
        and al,0fh
        add al,'0'
        stosb
        dec bx
        jns startu

    frac:
        mov al,'.'
        stosb
        mov byte ptr [di],'0'
        mov cl,10
        fld st(0)
        frndint
    frac1:  
        fsubp st(1)
        ficom word ptr [zero]
        fstsw ax
        and ah,045h
        cmp ah,040h
        je finished
        fimul word ptr [d3]
        fld st(0)
        frndint
        fist word ptr [di]
        add byte ptr [di],'0'
        inc di
        dec cl
        jnz frac1

    finished:   
        dec di
        cmp byte ptr [di],'0'
        je finished
        cmp byte ptr [di],'.'
        jne f2
        dec di
    f2:
        mov byte ptr [di+1],'$'
    exit2:
        jmp exit

    l11:
        fild word ptr [d3]
        fstp dword ptr [bx+2]
    l111:
        cmp si,di
        je ret
        lodsb
        cmp al,10
        je exit2
        jg ret
        mov [bx],al
        fild word ptr [bx]
        fdiv dword ptr [bx+2]
        faddp
        fld dword ptr [bx+2]
        fimul word ptr [d3]
        fstp dword ptr [bx+2]
        jmp l111

    d1: db '0123456789.-+/*()', 32, 9
    d3: dw 10
    op: db 0e9h, 0c1h, 0f9h, 0c9h
    cw: dw 0f7fh
    zero: dw 0
    res:db 'Error$'
    s:  dw (offset s)+2 
```

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2009-05-31T10:35:04.693

## Perl（无评估）

**字符数：~~167~~ 106**（106 字符版本见下文）

完全混淆功能：（如果将这三行合二为一，则为 167 个字符）

```
sub e{my$_="($_[0])";s/\s//g;$n=q"(-?\d++(\.\d+)?+)";
@a=(sub{$1},1,sub{$3*$6},sub{$3+$6},4,sub{$3-$6},6,sub{$3/$6});
while(s:\($n\)|(?<=\()$n(.)$n:$a[7&ord$5]():e){}$_} 
```

清除/去混淆版本：

```
sub e {
  my $_ = "($_[0])";
  s/\s//g;
  $n=q"(-?\d++(\.\d+)?+)"; # a regex for "number", including capturing groups
                           # q"foo" in perl means the same as 'foo'
                           # Note the use of ++ and ?+ to tell perl
                           # "no backtracking"

  @a=(sub{$1},             # 0 - no operator found
      1,                   # placeholder
      sub{$3*$6},          # 2 - ord('*') = 052
      sub{$3+$6},          # 3 - ord('+') = 053
      4,                   # placeholder
      sub{$3-$6},          # 5 - ord('-') = 055
      6,                   # placeholder
      sub{$3/$6});         # 7 - ord('/') = 057

  # The (?<=... bit means "find a NUM WHATEVER NUM sequence that happens
  # immediately after a left paren", without including the left
  # paren.  The while loop repeatedly replaces "(" NUM WHATEVER NUM with
  # "(" RESULT and "(" NUM ")" with NUM.  The while loop keeps going
  # so long as those replacements can be made.

  while(s:\($n\)|(?<=\()$n(.)$n:$a[7&ord$5]():e){}

  # A perl function returns the value of the last statement
  $_
} 
```

我最初误读了规则，所以我提交了一个带有“eval”的版本。这是一个没有它的版本。

当我意识到 , , 和 的字符代码中的最后一个八进制数字是不同的，即 0 时，最新的见解出现了。`+`这`-`让`/`我`*`可以`ord(undef)`将调度表设置`@a`为一个数组，然后在位置`7 & ord($3)`。

有一个明显的地方可以再剃掉一个字符 -`q""`变成`''`- 但这会使剪切和粘贴到外壳中变得更加困难。

## 更短

**字符数：~~124~~ 106**

考虑到[ehemient](https://stackoverflow.com/users/20713)的编辑，现在减少到 124 个字符：（将两行合二为一）

```
sub e{$_=$_[0];s/\s//g;$n=q"(-?\d++(\.\d+)?+)";
1while s:\($n\)|$n(.)$n:($1,1,$3*$6,$3+$6,4,$3-$6,6,$6&&$3/$6)[7&ord$5]:e;$_} 
```

## 更短的

**字符数：~~110~~ 106**

下面的红宝石解决方案让我更进一步，虽然我无法达到它的 104 个字符：

```
sub e{($_)=@_;$n='( *-?[.\d]++ *)';
s:\($n\)|$n(.)$n:(($1,$2-$4,$4&&$2/$4,$2*$4,$2+$4)x9)[.8*ord$3]:e?e($_):$_} 
```

我不得不屈服并使用`''`. ruby`send`技巧对这个问题非常有用。

## 从石头上挤水

**字符数：106**

避免被零除检查的小扭曲。

```
sub e{($_)=@_;$n='( *-?[.\d]++ *)';
s:\($n\)|$n(.)$n:($1,0,$2*$4,$2+$4,0,$2-$4)[7&ord$3]//$2/$4:e?e($_):$_} 
```

这是此功能的测试工具：

```
perl -le 'sub e{($_)=@_;$n='\''( *-?[.\d]++ *)'\'';s:\($n\)|$n(.)$n:($1,0,$2*$4,$2+$4,0,$2-$4)[7&ord$3]//$2/$4:e?e($_):$_}' -e 'print e($_) for @ARGV' '1 + 3' '1 + ((123 * 3 - 69) / 100)' '4 * (9 - 4) / (2 * 6 - 2) + 8' '2*3*4*5+99' '2.45/8.5*9.27+(5*0.0023) ' '1 + 3 / -8' 
```

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2009-06-02T12:19:59.483

## 红宝石

**字符数：103**

```
N='( *-?[\d.]+ *)'
def e x
x.sub!(/\(#{N}\)|#{N}([^.\d])#{N}/){$1or(e$2).send$3,e($4)}?e(x):x.to_f
end 
```

这是 The Wicked Flea 解决方案的~~非递归~~版本。带括号的子表达式是自下而上而不是自上而下计算的。

**编辑**：将“while”转换为条件+尾递归节省了一些字符，因此它不再是非递归的（尽管递归在语义上不是必需的。）

**编辑**：借用 Daniel Martin 的合并正则表达式的想法可以节省另外 11 个字符！

**编辑**：递归比我最初想象的更有用！`x.to_f`可以重写为`e(x)`，如果`x`恰好包含一个数字。

**编辑**：使用 ' `or`' 而不是 ' `||`' 允许删除一对括号。

**长版：**

```
# Decimal number, as a capturing group, for substitution
# in the main regexp below.
N='( *-?[\d.]+ *)'

# The evaluation function
def e(x)
  matched = x.sub!(/\(#{N}\)|#{N}([^\d.])#{N}/) do
    # Group 1 is a numeric literal in parentheses.  If this is present then
    # just return it.
    if $1
      $1
    # Otherwise, $3 is an operator symbol and $2 and $4 are the operands
    else
      # Recursively call e to parse the operands (we already know from the
      # regexp that they are numeric literals, and this is slightly shorter
      # than using :to_f)
      e($2).send($3, e($4))
      # We could have converted $3 to a symbol ($3.to_s) or converted the
      # result back to string form, but both are done automatically anyway
    end
  end
  if matched then
    # We did one reduction. Now recurse back and look for more.
    e(x)
  else
    # If the string doesn't look like a non-trivial expression, assume it is a
    # string representation of a real number and attempt to parse it
    x.to_f
  end
end 
```

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2009-06-03T14:23:30.993

# C (VS2005)

**字符数：1360**

滥用预处理器和有趣代码布局的警告（向下滚动查看）：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#define b main
#define c(a) b(a,0)
#define d -1
#define e -2
#define g break
#define h case
#define hh h
#define hhh h
#define w(i) case i
#define i return
#define j switch
#define k float
#define l realloc
#define m sscanf
#define n int _
#define o char
#define t(u) #u
#define q(r) "%f" t(r)  "n"
#define s while
#define v default
#define ex exit
#define W printf
#define x fn()
#define y strcat
#define z strcpy
#define Z strlen

char*p    =0    ;k    *b    (n,o**    a){k*f
;j(_){    hh   e:     i*    p==40?    (++p,c
(d        ))  :(      f=        l(        0,
4)        ,m (p       ,q        (%        ),
f,&_),    p+=_        ,f       );        hh
d:f=c(    e);s        (1      ){        j(
    *p    ++ ){       hh     0:        hh
    41    :i  f;      hh    43        :*
f+=*c(    e)   ;g     ;h    45:*f=    *f-*c(
e);g;h    42    :*    f=    *f**c(    e);g;h

47:*f      /=*c      (e);     g;   v:    c(0);}
}w(1):    if(p&&    printf    (q  ((     "\\"))
,*  c(    d)  ))    g;  hh    0: ex      (W
(x  ))    ;v  :p    =(        p?y:       z)(l(p
,Z(1[     a]  )+    (p        ?Z(p           )+
1:1))     ,1  [a    ])  ;b    (_ -1          ,a
+1  );    g;  }i    0;};fn    ()  {n     =42,p=
43  ;i     "Er"      "ro"     t(   r)    "\n";} 
```

* * *

## 回答 #5

> 赞同：25
> 
> 时间：2009-05-30T05:07:29.160

## 哈斯克尔

**字符数：182**

没有尝试聪明，只是一些压缩：4行，312字节。

```
import Data.Char;import Text.ParserCombinators.Parsec
q=either(error.show)id.runParser t id"".filter(' '/=);t=do
s<-getState;a<-fmap read(many1$oneOf".-"<|>digit)<|>between(char '('>>setState id)(char ')'>>setState s)t
option(s a)$choice(zipWith(\c o->char c>>return(o$s a))"+-*/"[(+),(-),(*),(/)])>>=setState>>t 
```

现在，真正进入高尔夫精神，3 行 182 字节：

```
q=snd.(`e`id).filter(' '/=)
e s c|[(f,h)]<-readsPrec 0 s=g h(c f);e('(':s)c=g h(c f)where(')':h,f)=e s id
g('+':h)=e h.(+);g('-':h)=e h.(-);g('*':h)=e h.(*);g('/':h)=e h.(/);g h=(,)h 
```

爆炸：

```
-- Strip spaces from the input, evaluate with empty accumulator,
-- and output the second field of the result.
q :: String -> Double
q = snd . flip eval id . filter (not . isSpace)

-- eval takes a string and an accumulator, and returns
-- the final value and what’s left unused from the string.
eval :: (Fractional a, Read a) => String -> (a -> a) -> (String, a)

-- If the beginning of the string parses as a number, add it to the accumulator,
-- then try to read an operator and further.
eval str accum | [(num, rest)] <- readsPrec 0 str = oper rest (accum num)

-- If the string starts parentheses, evaluate the inside with a fresh
-- accumulator, and continue after the closing paren.
eval ('(':str) accum = oper rest (accum num) where (')':rest, num) = eval str id

-- oper takes a string and current value, and tries to read an operator
-- to apply to the value.  If there is none, it’s okay.
oper :: (Fractional a, Read a) => String -> a -> (String, a)

-- Handle operations by giving eval a pre-seeded accumulator.
oper ('+':str) num = eval str (num +)
oper ('-':str) num = eval str (num -)
oper ('*':str) num = eval str (num *)
oper ('/':str) num = eval str (num /)

-- If there’s no operation parsable, just return.
oper str num = (str, num) 
```

* * *

## 回答 #6

> 赞同：25
> 
> 时间：2009-06-01T09:32:46.967

## Visual Basic.NET

**字符数：9759**

我自己更像是一个投球手。

注意：不考虑嵌套括号。此外，未经测试，但我很确定它有效。

```
Imports Microsoft.VisualBasic
Imports System.Text
Imports System.Collections.Generic
Public Class Main
Public Shared Function DoArithmaticFunctionFromStringInput(ByVal MathematicalString As String) As Double
    Dim numberList As New List(Of Number)
    Dim operationsList As New List(Of IOperatable)
    Dim currentNumber As New Number
    Dim currentParentheticalStatement As New Parenthetical
    Dim isInParentheticalMode As Boolean = False
    Dim allCharactersInString() As Char = MathematicalString.ToCharArray
    For Each mathChar In allCharactersInString
        If mathChar = Number.ZERO_STRING_REPRESENTATION Then
            currentNumber.UpdateNumber(mathChar)
        ElseIf mathChar = Number.ONE_STRING_REPRESENTATION Then
            currentNumber.UpdateNumber(mathChar)
        ElseIf mathChar = Number.TWO_STRING_REPRESENTATION Then
            currentNumber.UpdateNumber(mathChar)
        ElseIf mathChar = Number.THREE_STRING_REPRESENTATION Then
            currentNumber.UpdateNumber(mathChar)
        ElseIf mathChar = Number.FOUR_STRING_REPRESENTATION Then
            currentNumber.UpdateNumber(mathChar)
        ElseIf mathChar = Number.FIVE_STRING_REPRESENTATION Then
            currentNumber.UpdateNumber(mathChar)
        ElseIf mathChar = Number.SIX_STRING_REPRESENTATION Then
            currentNumber.UpdateNumber(mathChar)
        ElseIf mathChar = Number.SEVEN_STRING_REPRESENTATION Then
            currentNumber.UpdateNumber(mathChar)
        ElseIf mathChar = Number.EIGHT_STRING_REPRESENTATION Then
            currentNumber.UpdateNumber(mathChar)
        ElseIf mathChar = Number.NINE_STRING_REPRESENTATION Then
            currentNumber.UpdateNumber(mathChar)
        ElseIf mathChar = Number.DECIMAL_POINT_STRING_REPRESENTATION Then
            currentNumber.UpdateNumber(mathChar)
        ElseIf mathChar = Addition.ADDITION_STRING_REPRESENTATION Then
            Dim addition As New Addition

            If Not isInParentheticalMode Then
                operationsList.Add(addition)
                numberList.Add(currentNumber)
            Else
                currentParentheticalStatement.AllNumbers.Add(currentNumber)
                currentParentheticalStatement.AllOperators.Add(addition)
            End If

            currentNumber = New Number
        ElseIf mathChar = Number.NEGATIVE_NUMBER_STRING_REPRESENTATION Then
            If currentNumber.StringOfNumbers.Length > 0 Then
                currentNumber.UpdateNumber(mathChar)

                Dim subtraction As New Addition
                If Not isInParentheticalMode Then
                    operationsList.Add(subtraction)
                    numberList.Add(currentNumber)
                Else
                    currentParentheticalStatement.AllNumbers.Add(currentNumber)
                    currentParentheticalStatement.AllOperators.Add(subtraction)
                End If

                currentNumber = New Number
            Else
                currentNumber.UpdateNumber(mathChar)
            End If
        ElseIf mathChar = Multiplication.MULTIPLICATION_STRING_REPRESENTATION Then
            Dim multiplication As New Multiplication

            If Not isInParentheticalMode Then
                operationsList.Add(multiplication)
                numberList.Add(currentNumber)
            Else
                currentParentheticalStatement.AllNumbers.Add(currentNumber)
                currentParentheticalStatement.AllOperators.Add(multiplication)
            End If
            currentNumber = New Number
        ElseIf mathChar = Division.DIVISION_STRING_REPRESENTATION Then
            Dim division As New Division

            If Not isInParentheticalMode Then
                operationsList.Add(division)
                numberList.Add(currentNumber)
            Else
                currentParentheticalStatement.AllNumbers.Add(currentNumber)
                currentParentheticalStatement.AllOperators.Add(division)
            End If
            currentNumber = New Number
        ElseIf mathChar = Parenthetical.LEFT_PARENTHESIS_STRING_REPRESENTATION Then
            isInParentheticalMode = True
        ElseIf mathChar = Parenthetical.RIGHT_PARENTHESIS_STRING_REPRESENTATION Then
            currentNumber = currentParentheticalStatement.EvaluateParentheticalStatement
            numberList.Add(currentNumber)
            isInParentheticalMode = False
        End If
    Next

    Dim result As Double = 0
    Dim operationIndex As Integer = 0
    For Each numberOnWhichToPerformOperations As Number In numberList
        result = operationsList(operationIndex).PerformOperation(result, numberOnWhichToPerformOperations)
        operationIndex = operationIndex + 1
    Next

    Return result

End Function
Public Class Number
    Public Const DECIMAL_POINT_STRING_REPRESENTATION As Char = "."
    Public Const NEGATIVE_NUMBER_STRING_REPRESENTATION As Char = "-"
    Public Const ZERO_STRING_REPRESENTATION As Char = "0"
    Public Const ONE_STRING_REPRESENTATION As Char = "1"
    Public Const TWO_STRING_REPRESENTATION As Char = "2"
    Public Const THREE_STRING_REPRESENTATION As Char = "3"
    Public Const FOUR_STRING_REPRESENTATION As Char = "4"
    Public Const FIVE_STRING_REPRESENTATION As Char = "5"
    Public Const SIX_STRING_REPRESENTATION As Char = "6"
    Public Const SEVEN_STRING_REPRESENTATION As Char = "7"
    Public Const EIGHT_STRING_REPRESENTATION As Char = "8"
    Public Const NINE_STRING_REPRESENTATION As Char = "9"

    Private _isNegative As Boolean
    Public ReadOnly Property IsNegative() As Boolean
        Get
            Return _isNegative
        End Get
    End Property
    Public ReadOnly Property ActualNumber() As Double
        Get
            Dim result As String = ""
            If HasDecimal Then
                If DecimalIndex = StringOfNumbers.Length - 1 Then
                    result = StringOfNumbers.ToString
                Else
                    result = StringOfNumbers.Insert(DecimalIndex, DECIMAL_POINT_STRING_REPRESENTATION).ToString
                End If
            Else
                result = StringOfNumbers.ToString
            End If
            If IsNegative Then
                result = NEGATIVE_NUMBER_STRING_REPRESENTATION & result
            End If
            Return CType(result, Double)
        End Get
    End Property
    Private _hasDecimal As Boolean
    Public ReadOnly Property HasDecimal() As Boolean
        Get
            Return _hasDecimal
        End Get
    End Property
    Private _decimalIndex As Integer
    Public ReadOnly Property DecimalIndex() As Integer
        Get
            Return _decimalIndex
        End Get
    End Property
    Private _stringOfNumbers As New StringBuilder
    Public ReadOnly Property StringOfNumbers() As StringBuilder
        Get
            Return _stringOfNumbers
        End Get
    End Property
    Public Sub UpdateNumber(ByVal theDigitToAppend As Char)
        If IsNumeric(theDigitToAppend) Then
            Me._stringOfNumbers.Append(theDigitToAppend)
        ElseIf theDigitToAppend = DECIMAL_POINT_STRING_REPRESENTATION Then
            Me._hasDecimal = True
            Me._decimalIndex = Me._stringOfNumbers.Length
        ElseIf theDigitToAppend = NEGATIVE_NUMBER_STRING_REPRESENTATION Then
            Me._isNegative = Not Me._isNegative
        End If
    End Sub
    Public Shared Function ConvertDoubleToNumber(ByVal numberThatIsADouble As Double) As Number
        Dim numberResult As New Number
        For Each character As Char In numberThatIsADouble.ToString.ToCharArray
            numberResult.UpdateNumber(character)
        Next
        Return numberResult
    End Function
End Class
Public MustInherit Class Operation
    Protected _firstnumber As New Number
    Protected _secondnumber As New Number
    Public Property FirstNumber() As Number
        Get
            Return _firstnumber
        End Get
        Set(ByVal value As Number)
            _firstnumber = value
        End Set
    End Property
    Public Property SecondNumber() As Number
        Get
            Return _secondnumber
        End Get
        Set(ByVal value As Number)
            _secondnumber = value
        End Set
    End Property
End Class
Public Interface IOperatable
    Function PerformOperation(ByVal number1 As Double, ByVal number2 As Number) As Double
End Interface
Public Class Addition
    Inherits Operation
    Implements IOperatable
    Public Const ADDITION_STRING_REPRESENTATION As String = "+"
    Public Sub New()

    End Sub
    Public Function PerformOperation(ByVal number1 As Double, ByVal number2 As Number) As Double Implements IOperatable.PerformOperation
        Dim result As Double = 0
        result = number1 + number2.ActualNumber
        Return result
    End Function
End Class
Public Class Multiplication
    Inherits Operation
    Implements IOperatable
    Public Const MULTIPLICATION_STRING_REPRESENTATION As String = "*"
    Public Sub New()

    End Sub
    Public Function PerformOperation(ByVal number1 As Double, ByVal number2 As Number) As Double Implements IOperatable.PerformOperation
        Dim result As Double = 0
        result = number1 * number2.ActualNumber
        Return result
    End Function
End Class
Public Class Division
    Inherits Operation
    Implements IOperatable
    Public Const DIVISION_STRING_REPRESENTATION As String = "/"
    Public Const DIVIDE_BY_ZERO_ERROR_MESSAGE As String = "I took a lot of time to write this program. Please don't be a child and try to defile it by dividing by zero. Nobody thinks you are funny."
    Public Sub New()

    End Sub
    Public Function PerformOperation(ByVal number1 As Double, ByVal number2 As Number) As Double Implements IOperatable.PerformOperation
        If Not number2.ActualNumber = 0 Then
            Dim result As Double = 0
            result = number1 / number2.ActualNumber
            Return result
        Else
            Dim divideByZeroException As New Exception(DIVIDE_BY_ZERO_ERROR_MESSAGE)
            Throw divideByZeroException
        End If
    End Function
End Class
Public Class Parenthetical
    Public Const LEFT_PARENTHESIS_STRING_REPRESENTATION As String = "("
    Public Const RIGHT_PARENTHESIS_STRING_REPRESENTATION As String = ")"
    Private _allNumbers As New List(Of Number)
    Public Property AllNumbers() As List(Of Number)
        Get
            Return _allNumbers
        End Get
        Set(ByVal value As List(Of Number))
            _allNumbers = value
        End Set
    End Property
    Private _allOperators As New List(Of IOperatable)
    Public Property AllOperators() As List(Of IOperatable)
        Get
            Return _allOperators
        End Get
        Set(ByVal value As List(Of IOperatable))
            _allOperators = value
        End Set
    End Property
    Public Sub New()

    End Sub
    Public Function EvaluateParentheticalStatement() As Number
        Dim result As Double = 0
        Dim operationIndex As Integer = 0
        For Each numberOnWhichToPerformOperations As Number In AllNumbers
            result = AllOperators(operationIndex).PerformOperation(result, numberOnWhichToPerformOperations)
            operationIndex = operationIndex + 1
        Next

        Dim numberToReturn As New Number
        numberToReturn = Number.ConvertDoubleToNumber(result)
        Return numberToReturn
    End Function
End Class
End Class 
```

* * *

## 回答 #7

> 赞同：23
> 
> 时间：2009-05-30T01:36:27.207

## Python

**字符数：237**

完全混淆的功能：

```
from operator import*
def e(s,l=[]):
 if s:l+=list(s.replace(' ','')+')')
 a=0;o=add;d=dict(zip(')*+-/',(0,mul,o,sub,div)));p=l.pop
 while o:
  c=p(0)
  if c=='(':c=e(0)
  while l[0]not in d:c+=p(0)
  a=o(a,float(c));o=d[p(0)]
 return a 
```

清除/半混淆功能：

```
import operator

def calc(source, stack=[]):
    if source:
        stack += list(source.replace(' ', '') + ')')

    answer = 0

    ops = {
        ')': 0,
        '*': operator.mul,
        '+': operator.add,
        '-': operator.sub,
        '/': operator.div,
    }

    op = operator.add
    while op:
        cur = stack.pop(0)

        if cur == '(':
            cur = calc(0)

        while stack[0] not in ops:
            cur += stack.pop(0)

        answer = op(answer, float(cur))
        op = ops[stack.pop(0)]

    return answer 
```

* * *

## 回答 #8

> 赞同：20
> 
> 时间：2009-05-31T04:21:14.840

## Fortran 77（gfortran 方言，现在支持 g77）

**字符数：** 2059

**混淆版本：**

```
 function e(c)
      character*99 c
      character b
      real f(24)                
      integer i(24)             
      nf=0                      
      ni=0                      
 20   nf=kf(0.0,nf,f)
      ni=ki(43,ni,i)         
 30   if (isp(c).eq.1) goto 20
      h=fr(c)
 31   g=fp(nf,f)
      j=ip(ni,i)
      select case(j)
      case (40) 
         goto 20
      case (42)                 
         d=g*h
      case (43)                 
         d=g+h
      case (45)                 
         d=g-h
      case (47)                 
         d=g/h
      end select
 50   nf=kf(d,nf,f)
 60   j=nop(c)
      goto (20, 70, 75, 75, 60, 75, 60, 75) (j-39)
 65   e=fp(nf,f)
      return
 70   h=fp(nf,f)              
      goto 31
 75   ni=ki(j,ni,i)
      goto 30
      end
      function kf(v,n,f)
      real f(24)
      kf=n+1
      f(n+1)=v
      return
      end
      function ki(j,n,i)
      integer i(24)
      ki=n+1
      i(n+1)=j
      return
      end
      function fp(n,f)
      real f(24)
      fp=f(n)
      n=n-1
      return
      end
      function ip(n,i)
      integer i(24)
      ip=i(n)
      n=n-1
      return
      end
      function nop(s)
      character*99 s
      l=1
      do while(s(l:l).eq." ".and.l.lt.99)
         l=l+1
      enddo
      nop=ichar(s(l:l))
      s(l:l)=" "
      return
      end
      function isp(s)
      character*99 s
      isp=0
      l=1
      do while(s(l:l).eq." ".and.l.lt.99)
         l=l+1
      enddo
      isp=41-ichar(s(l:l))
      if (isp.eq.1) s(l:l)=" "
      return
      end
      function fr(s)
      character*99 s
      m=1                      
      n=1                      
      i=1
      do while(i.le.99)
         j=ichar(s(i:i))
         if (j.eq.32) goto 90   
         if (j.ge.48.and.j.lt.58) goto 89
         if (j.eq.43.or.j.eq.45) goto (89,80) m
         if (j.eq.46) goto (83,80) n
 80      exit
 83      n=2
 89      m=2
 90      i=i+1
      enddo
      read(s(1:i-1),*) fr
      do 91 j=1,i-1
         s(j:j)=" "
 91   continue
      return 
      end 
```

**清晰版：**（3340个字符，带脚手架）

```
 program infixeval
      character*99 c
      do while (.true.)
         do 10 i=1,99
            c(i:i)=" "
 10      continue
         read(*,"(A99)") c
         f=e(c)
         write(*,*)f
      enddo
      end

      function e(c)
      character*99 c
      character b
      real f(24)                ! value stack
      integer i(24)             ! operator stack
      nf=0                      ! number of items on the value stack
      ni=0                      ! number of items on the operator stack
 20   nf=pushf(0.0,nf,f)
      ni=pushi(43,ni,i)         ! ichar(+) = 43
D     write (*,*) "'",c,"'"
 30   if (isp(c).eq.1) goto 20
      h=fr(c)
D     write (*,*) "'",c,"'"
 31   g=fpop(nf,f)
      j=ipop(ni,i)
D     write(*,*) "Opperate ",g," ",char(j)," ",h
      select case(j)
      case (40) 
         goto 20
      case (42)                 ! "*" 
         d=g*h
      case (43)                 ! "+"
         d=g+h
      case (45)                 ! "-"
         d=g-h
      case (47)                 ! "*"
         d=g/h
      end select
 50   nf=pushf(d,nf,f)
 60   j=nop(c)
D     write(*,*) "Got op: ", char(j)
      goto (20, 70, 75, 75, 60, 75, 60, 75) (j-39)
 65   e=fpop(nf,f)
      return
 70   h=fpop(nf,f)              ! Encountered a "("
      goto 31
 75   ni=pushi(j,ni,i)
      goto 30
      end

c     push onto a real stack
c     OB as kf
      function pushf(v,n,f)
      real f(24)
      pushf=n+1
      f(n+1)=v
D     write(*,*) "Push ", v
      return
      end

c     push onto a integer stack
c     OB as ki
      function pushi(j,n,i)
      integer i(24)
      pushi=n+1
      i(n+1)=j
D     write(*,*) "Push ", char(j)
      return
      end

c     pop from real stack
c     OB as fp
      function fpop(n,f)
      real f(24)
      fpop=f(n)
      n=n-1
D      write (*,*) "Pop ", fpop
      return
      end

c     pop from integer stack
c     OB as ip
      function ipop(n,i)
      integer i(24)
      ipop=i(n)
      n=n-1
D      write (*,*) "Pop ", char(ipop)
      return
      end

c     Next OPerator: returns the next nonws character, and removes it
c     from the string
      function nop(s)
      character*99 s
      l=1
      do while(s(l:l).eq." ".and.l.lt.99)
         l=l+1
      enddo
      nop=ichar(s(l:l))
      s(l:l)=" "
      return
      end

c     IS an open Paren: return 1 if the next non-ws character is "("
c     (also overwrite it with a space. Otherwise return not 1
      function isp(s)
      character*99 s
      isp=0
      l=1
      do while(s(l:l).eq." ".and.l.lt.99)
         l=l+1
      enddo
      isp=41-ichar(s(l:l))
      if (isp.eq.1) s(l:l)=" "
      return
      end

c     Float Read: return the next real number in the string and removes the
c     character
      function fr(s)
      character*99 s
      m=1                      ! No sign (Minus or plus) so far
      n=1                      ! No decimal so far
      i=1
      do while(i.le.99)
         j=ichar(s(i:i))
         if (j.eq.32) goto 90   ! skip spaces
         if (j.ge.48.and.j.lt.58) goto 89
         if (j.eq.43.or.j.eq.45) goto (89,80) m
         if (j.eq.46) goto (83,80) n
c     not part of a number
 80      exit
 83      n=2
 89      m=2
 90      i=i+1
      enddo
      read(s(1:i-1),*) fr
      do 91 j=1,i-1
         s(j:j)=" "
 91   continue
      return 
      end 
```

**备注**这个编辑版本比我的第一次尝试更邪恶。相同的算法，但现在内联了一个可怕的`goto`s 缠结。我已经放弃了协同程序，但现在使用了几种计算分支。所有错误检查和报告已被删除，但此版本将从输入中的某些类别的意外字符静默恢复。这个版本也可以用 g77 编译。

主要限制仍然是 fortran 的严格格式、冗长且无处不在的关键字以及简单的原语。

* * *

## 回答 #9

> 赞同：17
> 
> 时间：2009-05-30T02:20:06.260

## C99

**字符数：239**（但见下文**209**）

压缩功能：

```
#define S while(*e==32)++e
#define F float
F strtof();char*e;F v();F g(){S;return*e++-40?strtof(e-1,&e):v();}F v(){F b,a=g();for(;;){S;F o=*e++;if(!o|o==41)return a;b=g();a=o==43?a+b:o==45?a-b:o==42?a*b:a/b;}}F f(char*x){e=x;return v();} 
```

解压函数：

```
float strtof();

char* e;
float v();

float g() {
    while (*e == ' ') ++e;
    return *e++ != '(' ? strtof(e-1, &e) : v();
}

float v() {
    float b, a = g();
    for (;;) {
        while (*e == ' ') ++e;
        float op = *e++;
        if (op == 0 || op == ')') return a;
        b = g();
        a = op == '+' ? a + b : op == '-' ? a - b : op == '*' ? a * b : a / b;
    }
}

float eval(char* x) {
    e = x;
    return v();
} 
```

函数不可重入。

**来自 Chris Lutz 的编辑**：我讨厌践踏另一个人的代码，但这里有一个**209**个字符的版本：

```
#define S for(;*e==32;e++)
#define X (*e++-40?strtof(e-1,&e):v())
float strtof();char*e;float v(){float o,a=X;for(;;){S;o=*e++;if(!o|o==41)return a;S;a=o-43?o-45?o-42?a/X:a*X:a-X:a+X;}}
#define f(x) (e=x,v()) 
```

可读（嗯，不是很可读，但已解压缩）：

```
float strtof();
char *e;
float v() {
    float o, a = *e++ != '(' ? strtof(e - 1, &e) : v();
    for(;;) {
        for(; *e == ' '; e++);
        o = *e++;
        if(o == 0 || o==')') return a;
        for(; *e == ' '; e++);
        // I have no idea how to properly indent nested conditionals
        // and this is far too long to fit on one line.
        a = o != '+' ?
          o != '-' ?
            o != '*' ?
              a / (*e++ != '(' ? strtof(e - 1, &e) : v()) :
              a * (*e++ != '(' ? strtof(e - 1, &e) : v()) :
            a - (*e++ != '(' ? strtof(e - 1, &e) : v()) :
          a + (*e++ != '(' ? strtof(e - 1, &e) : v());
      }
}
#define f(x) (e = x, v()) 
```

是的，`f()`是一个宏，不是一个函数，但它可以工作。可读版本有一些重写但没有重新排序的逻辑（比如`o != '+'`代替`o - '+'`），但在其他方面只是另一个的缩进（和预处理）版本。我一直在尝试将`if(!o|o==41)return a;`部分简化为`for()`循环，但它永远不会使它更短。我仍然相信这是可以做到的，但我已经打完高尔夫球了。如果我再处理这个问题，它将使用[不得命名的语言](http://en.wikipedia.org/wiki/Brainfuck)。

* * *

## 回答 #10

> 赞同：13
> 
> 时间：2009-05-30T12:53:00.473

## 通用 Lisp

(SBCL)
**字符数：251**

```
(defun g(e)(if(numberp e)e(let((m (g (pop e)))(o(loop for x in e by #'cddr collect x))(n(loop for x in (cdr e)by #'cddr collect (g x))))(mapcar(lambda(x y)(setf m(apply x(list m y))))o n)m)))(defun w(e)(g(read-from-string(concatenate'string"("e")")))) 
```

正确版本（387 个字符）：

```
(defun wrapper (exp) (golf-eval (read-from-string (concatenate 'string "(" exp ")"))))

(defun golf-eval (exp)
 (if (numberp exp)
     exp
   (let ((mem (golf-eval (pop exp)))
     (op-list (loop for x in exp by #'cddr collect x))
     (num-list (loop for x in (cdr exp) by #'cddr collect (golf-eval x))))
    (mapcar (lambda (x y) (setf mem (apply x (list mem y)))) op-list num-list)
    mem))) 
```

输入是 form `w()`，它接受一个字符串参数。它使用了 nums/operands 和 operator 在模式 NONON ... 中的技巧，并递归地评估所有操作数，因此嵌套非常便宜。;)

* * *

## 回答 #11

> 赞同：11
> 
> 时间：2009-05-30T06:23:56.203

## JavaScript（不兼容 IE）

**字符数：268/260**

完全混淆的功能：

```
function e(x){x=x.replace(/ /g,'')+')'
function P(n){return x[0]=='('?(x=x.substr(1),E()):(n=/^[-+]?[\d.]+/(x)[0],x=x.substr(n.length),+n)}function E(a,o,b){a=P()
for(;;){o=x[0]
x=x.substr(1)
if(o==')')return a
b=P()
a=o=='+'?a+b:o=='-'?a-b:o=='*'?a*b:a/b}}return E()} 
```

或者，在 JavaScript 1.8 (Firefox 3+) 中，您可以使用表达式闭包来保存一些字符：

```
e=function(x,P,E)(x=x.replace(/ /g,'')+')',P=function(n)(x[0]=='('?(x=x.substr(1),E()):(n=/^[-+]?[\d.]+/(x)[0],x=x.substr(n.length),+n)),E=function(a,o,b){a=P()
for(;;){o=x[0]
x=x.substr(1)
if(o==')')return a
b=P()
a=o=='+'?a+b:o=='-'?a-b:o=='*'?a*b:a/b}},E()) 
```

清除/半混淆功能：

```
function evaluate(x) {
    x = x.replace(/ /g, "") + ")";
    function primary() {
        if (x[0] == '(') {
            x = x.substr(1);
            return expression();
        }

        var n = /^[-+]?\d*\.?\d*/.exec(x)[0];
        x = x.substr(n.length);
        return +n;
    }

    function expression() {
        var a = primary();
        for (;;) {
            var operator = x[0];
            x = x.substr(1);

            if (operator == ')') {
                return a;
            }

            var b = primary();
            a = (operator == '+') ? a + b :
                (operator == '-') ? a - b :
                (operator == '*') ? a * b :
                                    a / b;
        }
    }

    return expression();
} 
```

这两个版本都不能在 IE 中工作，因为它们在字符串上使用数组样式的下标。如果您将两次都替换为`x[0]`，`x.charAt(0)`则第一个应该在任何地方都可以使用。

从第一个版本开始，我通过将变量转换为函数参数并用条件运算符替换另一个 if 语句，删去了更多字符。

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2009-05-30T12:43:45.470

## PHP

**字符数：284**

混淆：

```
function f($m){return c($m[1]);}function g($n,$m){$o=$m[0];$m[0]=' ';return$o=='+'?$n+$m:($o=='-'?$n-$m:($o=='*'?$n*$m:$n/$m));}function c($s){while($s!=($t=preg_replace_callback('/\(([^()]*)\)/',f,$s)))$s=$t;preg_match_all('![-+/*].*?[\d.]+!',"+$s",$m);return array_reduce($m[0],g);} 
```

可读：

```
function callback1($m) {return c($m[1]);}
function callback2($n,$m) {
    $o=$m[0];
    $m[0]=' ';
    return $o=='+' ? $n+$m : ($o=='-' ? $n-$m : ($o=='*' ? $n*$m : $n/$m));
}
function c($s){ 
    while ($s != ($t = preg_replace_callback('/\(([^()]*)\)/','callback1',$s))) $s=$t;
    preg_match_all('![-+/*].*?[\d.]+!', "+$s", $m);
    return array_reduce($m[0], 'callback2');
}

$str = '  2.45/8.5  *  -9.27   +    (   5   *  0.0023  ) ';
var_dump(c($str));
# float(-2.66044117647) 
```

应该使用任何有效的输入（包括负数和任意空格）

* * *

## 回答 #13

> 赞同：8
> 
> 时间：2009-05-30T18:48:39.287

## C# 与[正则表达式的爱](http://www.moserware.com/2009/03/how-net-regular-expressions-really-work.html)

**字符数：** 384

**完全混淆：**

```
float E(string i){i=i.Replace(" ","");Regex b=new Regex(@"\((?>[^()]+|\((?<D>)|\)(?<-D>))*(?(D)(?!))\)");i=b.Replace(i,m=>Eval(m.Value.Substring(1,m.Length-2)).ToString());float r=0;foreach(Match m in Regex.Matches(i,@"(?<=^|\D)-?[\d.]+")){float f=float.Parse(m.Value);if(m.Index==0)r=f;else{char o=i[m.Index-1];if(o=='+')r+=f;if(o=='-')r-=f;if(o=='*')r*=f;if(o=='/')r/=f;}}return r;} 
```

**未混淆：**

```
private static float Eval(string input)
{
    input = input.Replace(" ", "");
    Regex balancedMatcher = new Regex(@"\(
                                            (?>
                                                [^()]+
                                            |
                                                \( (?<Depth>)
                                            |
                                                \) (?<-Depth>)
                                            )*
                                            (?(Depth)(?!))
                                        \)", RegexOptions.IgnorePatternWhitespace);
    input = balancedMatcher.Replace(input, m => Eval(m.Value.Substring(1, m.Length - 2)).ToString());

    float result = 0;

    foreach (Match m in Regex.Matches(input, @"(?<=^|\D)-?[\d.]+"))
    {
        float floatVal = float.Parse(m.Value);
        if (m.Index == 0)
        {
            result = floatVal;
        }
        else
        {
            char op = input[m.Index - 1];
            if (op == '+') result += floatVal;
            if (op == '-') result -= floatVal;
            if (op == '*') result *= floatVal;
            if (op == '/') result /= floatVal;
        }
    }

    return result;
} 
```

利用 .NET 的 Regex[平衡组功能](http://blogs.msdn.com/bclteam/archive/2005/03/15/396452.aspx)。

* * *

## 回答 #14

> 赞同：8
> 
> 时间：2009-06-11T16:20:58.090

## SQL (SQL Server 2008)

### 字符数：4202

完全混淆的功能：

```
WITH Input(id,str)AS(SELECT 1,'1 + 3 / -8'UNION ALL SELECT 2,'2*3*4*5+99'UNION ALL SELECT 3,'4 * (9 - 4)/ (2 * 6 - 2)+ 8'UNION ALL SELECT 4,'1 + ((123 * 3 - 69)/ 100)'UNION ALL SELECT 5,'2.45/8.5*9.27+(5*0.0023)'),Separators(i,ch,str_src,priority)AS(SELECT 1,'-',1,1UNION ALL SELECT 2,'+',1,1UNION ALL SELECT 3,'*',1,1UNION ALL SELECT 4,'/',1,1UNION ALL SELECT 5,'(',0,0UNION ALL SELECT 6,')',0,0),SeparatorsStrSrc(str,i)AS(SELECT CAST('['AS varchar(max)),0UNION ALL SELECT str+ch,SSS.i+1FROM SeparatorsStrSrc SSS INNER JOIN Separators S ON SSS.i=S.i-1WHERE str_src<>0),SeparatorsStr(str)AS(SELECT str+']'FROM SeparatorsStrSrc WHERE i=(SELECT COUNT(*)FROM Separators WHERE str_src<>0)),ExprElementsSrc(id,i,tmp,ele,pre_ch,input_str)AS(SELECT id,1,CAST(LEFT(str,1)AS varchar(max)),CAST(''AS varchar(max)),CAST(' 'AS char(1)),SUBSTRING(str,2,LEN(str))FROM Input UNION ALL SELECT id,CASE ele WHEN''THEN i ELSE i+1 END,CAST(CASE WHEN LEFT(input_str,1)=' 'THEN''WHEN tmp='-'THEN CASE WHEN pre_ch LIKE(SELECT str FROM SeparatorsStr)THEN tmp+LEFT(input_str,1)ELSE LEFT(input_str,1)END WHEN LEFT(input_str,1)IN(SELECT ch FROM Separators)OR tmp IN(SELECT ch FROM Separators)THEN LEFT(input_str,1)ELSE tmp+LEFT(input_str,1)END AS varchar(max)),CAST(CASE WHEN LEFT(input_str,1)=' 'THEN tmp WHEN LEFT(input_str,1)='-'THEN CASE WHEN tmp IN(SELECT ch FROM Separators)THEN tmp ELSE''END WHEN LEFT(input_str,1)IN(SELECT ch FROM Separators)OR tmp IN(SELECT ch FROM Separators)THEN CASE WHEN tmp='-'AND pre_ch LIKE(SELECT str FROM SeparatorsStr)THEN''ELSE tmp END ELSE''END AS varchar(max)),CAST(LEFT(ele,1)AS char(1)),SUBSTRING(input_str,2,LEN(input_str))FROM ExprElementsSrc WHERE input_str<>''OR tmp<>''),ExprElements(id,i,ele)AS(SELECT id,i,ele FROM ExprElementsSrc WHERE ele<>''),Scanner(id,i,val)AS(SELECT id,i,CAST(ele AS varchar(max))FROM ExprElements WHERE ele<>''UNION ALL SELECT id,MAX(i)+1,NULL FROM ExprElements GROUP BY id),Operator(op,priority)AS(SELECT ch,priority FROM Separators WHERE priority<>0),Calc(id,c,i,pop_count,s0,s1,s2,stack,status)AS(SELECT Scanner.id,1,1,0,CAST(scanner.val AS varchar(max)),CAST(NULL AS varchar(max)),CAST(NULL AS varchar(max)),CAST(''AS varchar(max)),CAST('init'AS varchar(max))FROM Scanner WHERE Scanner.i=1UNION ALL SELECT Calc.id,Calc.c+1,Calc.i,3,NULL,NULL,NULL,CASE Calc.s1 WHEN'+'THEN CAST(CAST(Calc.s2 AS real)+CAST(Calc.s0 AS real)AS varchar(max))WHEN'-'THEN CAST(CAST(Calc.s2 AS real)-CAST(Calc.s0 AS real)AS varchar(max))WHEN'*'THEN CAST(CAST(Calc.s2 AS real)*CAST(Calc.s0 AS real)AS varchar(max))WHEN'/'THEN CAST(CAST(Calc.s2 AS real)/CAST(Calc.s0 AS real)AS varchar(max))ELSE NULL END+' '+stack,CAST('calc '+Calc.s1 AS varchar(max))FROM Calc INNER JOIN Scanner NextVal ON Calc.id=NextVal.id AND Calc.i+1=NextVal.i WHERE Calc.pop_count=0AND ISNUMERIC(Calc.s2)=1AND Calc.s1 IN(SELECT op FROM Operator)AND ISNUMERIC(Calc.s0)=1AND(SELECT priority FROM Operator WHERE op=Calc.s1)>=COALESCE((SELECT priority FROM Operator WHERE op=NextVal.val),0)UNION ALL SELECT Calc.id,Calc.c+1,Calc.i,3,NULL,NULL,NULL,s1+' '+stack,CAST('paren'AS varchar(max))FROM Calc WHERE pop_count=0AND s2='('AND ISNUMERIC(s1)=1AND s0=')'UNION ALL SELECT Calc.id,Calc.c+1,Calc.i,Calc.pop_count-1,s1,s2,CASE WHEN LEN(stack)>0THEN SUBSTRING(stack,1,CHARINDEX(' ',stack)-1)ELSE NULL END,CASE WHEN LEN(stack)>0THEN SUBSTRING(stack,CHARINDEX(' ',stack)+1,LEN(stack))ELSE''END,CAST('pop'AS varchar(max))FROM Calc WHERE Calc.pop_count>0UNION ALL SELECT Calc.id,Calc.c+1,Calc.i+1,Calc.pop_count,CAST(NextVal.val AS varchar(max)),s0,s1,coalesce(s2,'')+' '+stack,cast('read'as varchar(max))FROM Calc INNER JOIN Scanner NextVal ON Calc.id=NextVal.id AND Calc.i+1=NextVal.i WHERE NextVal.val IS NOT NULL AND Calc.pop_count=0AND((Calc.s0 IS NULL OR calc.s1 IS NULL OR calc.s2 IS NULL)OR NOT(ISNUMERIC(Calc.s2)=1AND Calc.s1 IN(SELECT op FROM Operator)AND ISNUMERIC(calc.s0)=1AND (SELECT priority FROM Operator WHERE op=Calc.s1)>=COALESCE((SELECT priority FROM Operator WHERE op=NextVal.val),0))AND NOT(s2='('AND ISNUMERIC(s1)=1AND s0=')')))SELECT Calc.id,Input.str,Calc.s0 AS result FROM Calc INNER JOIN Input ON Calc.id=Input.id WHERE Calc.c=(SELECT MAX(c)FROM Calc calc2 WHERE Calc.id=Calc2.id)ORDER BY id 
```

清除/半混淆功能：

```
WITH
  Input(id, str) AS (    
    SELECT 1, '1 + 3 / -8'
    UNION ALL SELECT 2, '2*3*4*5+99'
    UNION ALL SELECT 3, '4 * (9 - 4) / (2 * 6 - 2) + 8'
    UNION ALL SELECT 4, '1 + ((123 * 3 - 69) / 100)'
    UNION ALL SELECT 5, '2.45/8.5*9.27+(5*0.0023)'
  )
, Separators(i, ch, str_src, priority) AS (
    SELECT 1, '-', 1, 1
    UNION ALL SELECT 2, '+', 1, 1
    UNION ALL SELECT 3, '*', 1, 1
    UNION ALL SELECT 4, '/', 1, 1
    UNION ALL SELECT 5, '(', 0, 0
    UNION ALL SELECT 6, ')', 0, 0
  )
, SeparatorsStrSrc(str, i) AS (
    SELECT CAST('[' AS varchar(max)), 0
    UNION ALL
    SELECT
        str + ch
      , SSS.i + 1
    FROM
        SeparatorsStrSrc SSS
          INNER JOIN Separators S ON SSS.i = S.i - 1
    WHERE
        str_src <> 0
  )
, SeparatorsStr(str) AS (
    SELECT str + ']' FROM SeparatorsStrSrc
    WHERE i = (SELECT COUNT(*) FROM Separators WHERE str_src <> 0)
  )
, ExprElementsSrc(id, i, tmp, ele, pre_ch, input_str) AS (
    SELECT
        id
      , 1
      , CAST(LEFT(str, 1) AS varchar(max))
      , CAST('' AS varchar(max))
      , CAST(' ' AS char(1))
      , SUBSTRING(str, 2, LEN(str))
    FROM
        Input
    UNION ALL
    SELECT
        id
      , CASE ele
        WHEN '' THEN i
                ELSE i + 1
        END
      , CAST(
          CASE
          WHEN LEFT(input_str, 1) = ' '
            THEN ''
          WHEN tmp = '-'
            THEN CASE
                 WHEN pre_ch LIKE (SELECT str FROM SeparatorsStr)
                   THEN tmp + LEFT(input_str, 1)
                   ELSE LEFT(input_str, 1)
                 END
          WHEN LEFT(input_str, 1) IN (SELECT ch FROM Separators)
               OR
               tmp IN (SELECT ch FROM Separators)
            THEN LEFT(input_str, 1)
            ELSE tmp + LEFT(input_str, 1)
          END
        AS varchar(max))
      , CAST(
          CASE
          WHEN LEFT(input_str, 1) = ' '
            THEN tmp
          WHEN LEFT(input_str, 1) = '-'
            THEN CASE
                 WHEN tmp IN (SELECT ch FROM Separators)
                   THEN tmp
                   ELSE ''
                 END
          WHEN LEFT(input_str, 1) IN (SELECT ch FROM Separators)
               OR
               tmp IN (SELECT ch FROM Separators)
            THEN CASE
                 WHEN tmp = '-' AND pre_ch LIKE (SELECT str FROM SeparatorsStr)
                   THEN ''
                   ELSE tmp
                 END
            ELSE ''
          END
        AS varchar(max))
      , CAST(LEFT(ele, 1) AS char(1))
      , SUBSTRING(input_str, 2, LEN(input_str))
    FROM
        ExprElementsSrc
    WHERE
        input_str <> ''
        OR
        tmp <> ''
  )
, ExprElements(id, i, ele) AS (
    SELECT
        id
      , i
      , ele
    FROM
        ExprElementsSrc
    WHERE
        ele <> ''
  )
, Scanner(id, i, val) AS (
    SELECT
        id
      , i
      , CAST(ele AS varchar(max))
    FROM
        ExprElements
    WHERE
        ele <> ''
    UNION ALL
    SELECT
        id
      , MAX(i) + 1
      , NULL
    FROM
        ExprElements
    GROUP BY
        id
  )
, Operator(op, priority) AS (
    SELECT
        ch
      , priority 
    FROM
        Separators
    WHERE
        priority <> 0
  )
, Calc(id, c, i, pop_count, s0, s1, s2, stack, status) AS (
    SELECT
        Scanner.id
      , 1
      , 1
      , 0
      , CAST(scanner.val AS varchar(max))
      , CAST(NULL AS varchar(max))
      , CAST(NULL AS varchar(max))
      , CAST('' AS varchar(max))
      , CAST('init' AS varchar(max))
    FROM
        Scanner
    WHERE
        Scanner.i = 1
    UNION ALL
    SELECT
        Calc.id
      , Calc.c + 1
      , Calc.i
      , 3
      , NULL
      , NULL
      , NULL
      , CASE Calc.s1
        WHEN '+' THEN CAST(CAST(Calc.s2 AS real) + CAST(Calc.s0 AS real) AS varchar(max))
        WHEN '-' THEN CAST(CAST(Calc.s2 AS real) - CAST(Calc.s0 AS real) AS varchar(max))
        WHEN '*' THEN CAST(CAST(Calc.s2 AS real) * CAST(Calc.s0 AS real) AS varchar(max))
        WHEN '/' THEN CAST(CAST(Calc.s2 AS real) / CAST(Calc.s0 AS real) AS varchar(max))
                 ELSE NULL
        END
          + ' '
          + stack
      , CAST('calc ' + Calc.s1 AS varchar(max))
    FROM
        Calc
          INNER JOIN Scanner NextVal ON Calc.id = NextVal.id
                                          AND Calc.i + 1 = NextVal.i
    WHERE
        Calc.pop_count = 0
          AND ISNUMERIC(Calc.s2) = 1
          AND Calc.s1 IN (SELECT op FROM Operator)
          AND ISNUMERIC(Calc.s0) = 1
          AND (SELECT priority FROM Operator WHERE op = Calc.s1)
            >= COALESCE((SELECT priority FROM Operator WHERE op = NextVal.val), 0)
    UNION ALL
    SELECT
        Calc.id
      , Calc.c + 1
      , Calc.i
      , 3
      , NULL
      , NULL
      , NULL
      , s1 + ' ' + stack
      , CAST('paren' AS varchar(max))
    FROM
        Calc
    WHERE
        pop_count = 0
          AND s2 = '('
          AND ISNUMERIC(s1) = 1
          AND s0 = ')'
    UNION ALL
    SELECT
        Calc.id
      , Calc.c + 1
      , Calc.i
      , Calc.pop_count - 1
      , s1
      , s2
      , CASE
        WHEN LEN(stack) > 0
          THEN SUBSTRING(stack, 1, CHARINDEX(' ', stack) - 1)
          ELSE NULL
        END
      , CASE
        WHEN LEN(stack) > 0
          THEN SUBSTRING(stack, CHARINDEX(' ', stack) + 1, LEN(stack))
          ELSE ''
        END
      , CAST('pop' AS varchar(max))
    FROM
        Calc
    WHERE
        Calc.pop_count > 0
    UNION ALL
    SELECT
        Calc.id
      , Calc.c + 1
      , Calc.i + 1
      , Calc.pop_count
      , CAST(NextVal.val AS varchar(max))
      , s0
      , s1
      , coalesce(s2, '') + ' ' + stack
      , cast('read' as varchar(max))
    FROM
        Calc
          INNER JOIN Scanner NextVal ON Calc.id = NextVal.id
                                          AND Calc.i + 1 = NextVal.i
    WHERE
        NextVal.val IS NOT NULL
          AND Calc.pop_count = 0
          AND (
            (Calc.s0 IS NULL or calc.s1 is null or calc.s2 is null)
            OR
            NOT(
              ISNUMERIC(Calc.s2) = 1
                AND Calc.s1 IN (SELECT op FROM Operator)
                AND ISNUMERIC(calc.s0) = 1
                AND (SELECT priority FROM Operator WHERE op = Calc.s1)
                  >= COALESCE((SELECT priority FROM Operator WHERE op = NextVal.val), 0)
            )
              AND NOT(s2 = '(' AND ISNUMERIC(s1) = 1 AND s0 = ')')
          )
  )
SELECT
    Calc.id
  , Input.str
  , Calc.s0 AS result
FROM
    Calc
      INNER JOIN Input ON Calc.id = Input.id
WHERE
    Calc.c = (SELECT MAX(c) FROM Calc calc2
              WHERE Calc.id = Calc2.id)
ORDER BY
    id 
```

它不是最短的。但我认为它对于 SQL 来说非常灵活。添加新的运算符很容易。更改运算符的优先级很容易。

* * *

## 回答 #15

> 赞同：6
> 
> 时间：2009-05-30T15:57:40.443

## F＃

**字符数：327**

OP 正在寻找 F# 版本，在这里。可以做得更好，因为我在这里滥用*ref*来保存字符。它处理大多数事情，例如**-(1.0)**，**3 - -3**甚至**0 - .5**等。

```
let g s=
 let c=ref[for x in System.Text.RegularExpressions.Regex.Matches(s,"[0-9.]+|[^\s]")->x.Value]
 let rec e v=if (!c).IsEmpty then v else 
  let h=(!c).Head
  c:=(!c).Tail
  match h with|"("->e(e 0.0)|")"->v|"+"->e(v+(e 0.0))|"-"->e(v-(e 0.0))|"/"->e(v/(e 0.0))|"*"->e(v*(e 0.0))|x->float x
 e(e 0.0) 
```

* * *

## 回答 #16

> 赞同：6
> 
> 时间：2009-06-01T00:34:47.570

## Python（不导入任何东西）

**字符数：222**

我从戴夫的回答中偷了很多技巧，但我设法剃掉了更多的角色。

```
def e(s,l=0,n=0,f='+'):
 if s:l=[c for c in s+')'if' '!=c]
 while f!=')':
  p=l.pop;m=p(0)
  if m=='(':m=e(0,l)
  while l[0]not in'+-*/)':m+=p(0)
  m=float(m);n={'+':n+m,'-':n-m,'*':n*m,'/':n/(m or 1)}[f];f=p(0)
 return n 
```

评论版本：

```
def evaluate(stringexpr, listexpr=0, n=0, f_operation='+'):
    # start out as taking 0 + the expression... (or could use 1 * ;)

    # We'll prefer to keep the expression as a list of characters,
    # so we can use .pop(0) to eat up the expression as we go.
    if stringexpr:
        listexpr = [c for c in stringexpr+')' if c!=' ']

    # use ')' as sentinel to return the answer
    while f_operation != ')':
        m_next = listexpr.pop(0)
        if m_next == '(':
            # lists are passed by reference, so this call will eat the (parexp)
            m_next = evaluate(None, listexpr)

        else:
            # rebuild any upcoming numeric chars into a string
            while listexpr[0] not in '+-*/)':
                m_next += listexpr.pop(0)

        # Update n as the current answer.  But never divide by 0.
        m = float(m_next)
        n = {'+':n+m, '-':n-m, '*':n*m, '/':n/(m or 1)}[f_operation]

        # prepare the next operation (known to be one of '+-*/)')
        f_operation = listexpr.pop(0)

    return n 
```

* * *

## 回答 #17

> 赞同：6
> 
> 时间：2009-06-01T06:11:34.537

## [Ĵ](http://www.jsoftware.com)

### 字符数：208

在[Jeff Moser](https://stackoverflow.com/users/1869)的评论之后，我意识到我已经完全忘记了这种语言......我不是专家，但我的第一次尝试相当顺利。

```
e=:>@{:@f@;:
f=:''&(4 :0)
'y x'=.x g y
while.($y)*-.')'={.>{.y do.'y x'=.(x,>(-.'/'={.>{.y){('%';y))g}.y end.y;x
)
g=:4 :0
z=.>{.y
if.z='('do.'y z'=.f}.y else.if.z='-'do.z=.'_',>{.}.y end.end.(}.y);":".x,z
) 
```

这有点烦人，必须映射`x/y`到`-z`J's`x%y`和`_z`. 没有它，可能 50% 的代码会消失。

* * *

## 回答 #18

> 赞同：5
> 
> 时间：2009-05-30T09:52:55.033

## C＃

**字符数：403**

所以这是我的解决方案......我仍在等待有人在 C# 中发布一个可以击败它的解决方案。（Marc Gravell 已经很接近了，经过一些修改后可能会比我做得更好。）

完全混淆的功能：

```
float e(string x){float v=0;if(float.TryParse(x,out v))return v;x+=';';int t=0;
char o,s='?',p='+';float n=0;int l=0;for(int i=0;i<x.Length;i++){o=s;if(
x[i]!=' '){s=x[i];if(char.IsDigit(x[i])|s=='.'|(s=='-'&o!='1'))s='1';if(s==')')
l--;if(s!=o&l==0){if(o=='1'|o==')'){n=e(x.Substring(t,i-t));if(p=='+')v+=n;
if(p=='-')v-=n;if(p=='*')v*=n;if(p=='/')v/=n;p=x[i];}t=i;if(s=='(')t++;}
if(s=='(')l++;}}return v;} 
```

半模糊函数：

```
public static float Eval(string expr)
{
    float val = 0;
    if (float.TryParse(expr, out val))
        return val;
    expr += ';';
    int tokenStart = 0;
    char oldState, state = '?', op = '+';
    float num = 0;
    int level = 0;
    for (int i = 0; i < expr.Length; i++)
    {
        oldState = state;
        if (expr[i] != ' ')
        {
            state = expr[i];
            if (char.IsDigit(expr[i]) || state == '.' ||
                (state == '-' && oldState != '1'))
                state = '1';
            if (state == ')')
                level--;
            if (state != oldState && level == 0)
            {
                if (oldState == '1' || oldState == ')')
                {
                    num = Eval(expr.Substring(tokenStart, i - tokenStart));
                    if (op == '+') val += num;
                    if (op == '-') val -= num;
                    if (op == '*') val *= num;
                    if (op == '/') val /= num;
                    op = expr[i];
                }
                tokenStart = i;
                if (state == '(')
                    tokenStart++;
            }
            if (state == '(')
                level++;
        }
    }
    return val;
} 
```

这里似乎没有什么太聪明的事情。然而，该函数确实具有可重入（即线程安全）的优点。

考虑到它是用 C# 编写的（我相信有效的 1.0、2.0 和 3.0），我对字符的数量也相当满意。

* * *

## 回答 #19

> 赞同：5
> 
> 时间：2009-05-31T18:53:23.623

# 红宝石

*字符数：170*

混淆：

```
def s(x)
while x.sub!(/\(([^\(\)]*?)\)/){s($1)}
x.gsub!('--','')
end
while x.sub!(/(-?[\d.]+)[ ]*([+\-*\/])[ ]*(-?[\d.]+)/){$1.to_f.send($2,$3.to_f)}
end
x.strip.to_f
end 
```

可读性：

```
def s(x)
while x.sub!(/\(([^\(\)]*?)\)/){s($1)}
x.gsub!('--','')
end
while x.sub!(/(-?[\d.]+)[ ]*([+\-*\/])[ ]*(-?[\d.]+)/){$1.to_f.send($2,$3.to_f)}
end
x.strip.to_f
end

[
  ['1 + 3 / -8', -0.5],
  ['2*3*4*5+99', 219],
  ['4 * (9 - 4) / (2 * 6 - 2) + 8', 10],
  ['1 + ((123 * 3 - 69) / 100)', 4],
  ['2.45/8.5*9.27+(5*0.0023)',2.68344117647059],
  ['(3+7) - (5+2)', 3]
].each do |pair|
  a,b = s(String.new(pair[0])),pair[1]
  print pair[0].ljust(25), ' = ', b, ' (', a==b, ')'
  puts
end 
```

这个没有真正的混淆，我决定发布新鲜的，因为它与我的第一个完全不同。我应该从一开始就看到这一点。该过程是一个非常简单的排除过程：找到最高的一对括号（嵌套最多）并将其解析为一个数字，直到找不到更多的数字，然后将所有现有数字和运算解析为结果。而且，在解析括号语句时，我让它去掉所有双破折号（Float.to_f 不知道如何处理它们）。

因此，它支持正数和负数（+3, 3, & -3）甚至括号内的否定子表达式，仅按处理顺序。唯一较短的实现是 Perl (w/o eval) 一个。

**编辑：**我仍在追逐 Perl，但这是目前第二小的答案。我通过更改第二个正则表达式并将字符串的处理更改为破坏性（替换旧字符串）来缩小它。这消除了复制字符串的需要，我发现它只是一个指向字符串的新指针。并将函数重命名为*s*从*解决*保存了一些字符。

* * *

## 回答 #20

> 赞同：5
> 
> 时间：2009-06-01T10:01:41.370

又来了一个：

## Shell 脚本（使用 sed+awk）

**字符数：295**

混淆：

```
e(){ a="$1";while echo "$a"|grep -q \(;do eval "`echo "$a"|sed 's/\(.*\)(\([^()]*\))\(.*\)/a="\1\`e \"\2\"\`\3"/'`";done; echo "$a"|sed 's/\([-+*/]\) *\(-\?\) */ \1 \2/g'|awk '{t=$1;for(i=2;i<NF;i+=2){j=$(i+1);if($i=="+") t+=j; else if($i=="-") t-=j; else if($i=="*") t*=j; else t/=j}print t}';} 
```

可读

```
e () {
    a="$1"
    # Recursively process bracket-expressions
    while echo "$a"|grep -q \(; do
        eval "`echo "$a"|
            sed 's/\(.*\)(\([^()]*\))\(.*\)/a="\1\`e \"\2\"\`\3"/'`"
    done
    # Compute expression without brackets
    echo "$a"|
        sed 's/\([-+*/]\) *\(-\?\) */ \1 \2/g'|
        awk '{
            t=$1;
            for(i=2;i<NF;i+=2){
                j=$(i+1);
                if($i=="+") t+=j;
                else if($i=="-") t-=j;
                else if($i=="*") t*=j;
                else t/=j
            }
            print t
        }'
} 
```

测试：

```
str='  2.45 / 8.5  *  9.27   +    (   5   *  0.0023  ) '
echo "$str"|bc -l
e "$str" 
```

结果：

```
2.68344117647058823526
2.68344 
```

* * *

## 回答 #21

> 赞同：5
> 
> 时间：2009-06-01T20:44:26.903

## MATLAB (v7.8.0)

**字符数：239**

混淆功能：

```
function [v,s]=m(s),r=1;while s,s=regexp(s,'( ?)(?(1)-?)[\.\d]+|\S','match');c=s{end};s=[s{1:end-1}];if any(c>47),v=str2num(c);elseif c>41,[l,s]=m(s);v=[l/v l*v l+v l-v];v=v(c=='/*+-');if r,break;end;r=1;elseif c<41,break;end;r=r&c~=41;end 
```

清除（er）功能：

```
function [value,str] = math(str)
  returnNow = 1;
  while str,
    str = regexp(str,'( ?)(?(1)-?)[\.\d]+|\S','match');
    current = str{end};
    str = [str{1:end-1}];
    if any(current > 47),
      value = str2num(current);
    elseif current > 41,
      [leftValue,str] = math(str);
      value = [leftValue/value leftValue*value ...
               leftValue+value leftValue-value];
      value = value(current == '/*+-');
      if returnNow,
        break;
      end;
      returnNow = 1;
    elseif current < 41,
      break;
    end;
    returnNow = returnNow & (c ~= 41);
  end 
```

测试：

```
>> [math('1 + 3 / -8'); ...
math('2*3*4*5+99'); ...
math('4 * (9 - 4) / (2 * 6 - 2) + 8'); ...
math('1 + ((123 * 3 - 69) / 100)'); ...
math('2.45/8.5*9.27+(5*0.0023)')]

ans =

   -0.5000
  219.0000
   10.0000
    4.0000
    2.6834 
```

概要：正则表达式和递归的混合体。到目前为止，我能做到的几乎是最好的，没有作弊和使用 EVAL。

* * *

## 回答 #22

> 赞同：4
> 
> 时间：2009-05-30T08:47:47.037

## C＃

**字符数：396**（更新）

（但是你用“/ -8”添加的测试失败了，我不倾向于修复它......

```
static float Eval(string s){int i,j;s=s.Trim();while((i=s.IndexOf(')'))>=0){j=s.LastIndexOf('(',i,i);s=s.Substring(0,j++)+Eval(s.Substring(j,i-j))+s.Substring(i+1);}if((i=s.LastIndexOfAny("+-*/".ToCharArray()))<0) return float.Parse(s);var r=float.Parse(s.Substring(i+1));var l=i>0?Eval(s.Substring(0,i)):(float?)null;return s[i]=='+'?(l??0)+r:(s[i]=='-'?(l??0)-r:(s[i]=='/'?(l??1)/r:(l??1)*r));} 
```

从：

```
static float Eval(string s)
{
    int i, j;
    s = s.Trim();
    while ((i = s.IndexOf(')')) >= 0)
    {
        j = s.LastIndexOf('(', i, i);
        s = s.Substring(0, j++) + Eval(s.Substring(j, i - j)) + s.Substring(i + 1);
    } 
    if ((i = s.LastIndexOfAny("+-*/".ToCharArray())) < 0) return float.Parse(s);
    var r = float.Parse(s.Substring(i + 1));
    var l = i > 0 ? Eval(s.Substring(0, i)) : (float?)null;
    return s[i] == '+'
        ? (l ?? 0) + r
        : (s[i] == '-'
            ? (l ?? 0) - r
            : (s[i] == '/'
                ? (l ?? 1) / r
                : (l ?? 1) * r));
} 
```

* * *

## 回答 #23

> 赞同：4
> 
> 时间：2009-05-30T17:22:37.150

## 带有正则表达式的 Python

**字符数：283**

完全混淆的功能：

```
import re
from operator import*
def c(e):
 O=dict(zip("+-/*()",(add,sub,truediv,mul)))
 a=[add,0];s=a
 for v,o in re.findall("(-?[.\d]+)|([+-/*()])",e):
  if v:s=[float(v)]+s
  elif o=="(":s=a+s
  elif o!=")":s=[O[o]]+s
  if v or o==")":s[:3]=[s[1](s[2],s[0])]
 return s[0] 
```

不混淆：

```
import re
from operator import *

def compute(s):
    operators = dict(zip("+-/*()", (add, sub, truediv, mul)))
    stack = [add, 0]
    for val, op in re.findall("(-?[.\d]+)|([+-/*()])", s):
        if val:
            stack = [float(val)] + stack
        elif op == "(":
            stack = [add, 0] + stack
        elif op != ")":
            stack = [operators[op]] + stack
        if val or op == ")":
            stack[:3] = [stack[1](stack[2], stack[0])]
    return stack[0] 
```

我想看看我是否使用正则表达式击败了其他 Python 解决方案。

不能。

我使用的正则表达式创建了一个对 (val, op) 的列表，其中每对中只有一个项目是有效的。其余代码是一个相当标准的基于堆栈的解析器，具有巧妙的技巧，即使用 Python 列表赋值语法将堆栈中的前 3 个单元替换为计算结果。使用负数进行这项工作只需要两个额外的字符（正则表达式中的-?）。

* * *

## 回答 #24

> 赞同：4
> 
> 时间：2009-05-30T21:39:46.943

## Python

**字符数：382**

另一个 Python 解决方案，大量使用正则表达式替换。每次循环运行都会计算最简单的表达式，并将结果放回字符串中。

这是未混淆的代码，除非您认为正则表达式被混淆。

```
import re
from operator import *    
operators = dict(zip("+-/*", (add, sub, truediv, mul)))    
def compute(s):
    def repl(m):
        v1, op, v2 = m.groups()
        return str(operators[op](float(v1), float(v2)))
    while not re.match("^\d+\.\d+$", s):
        s = re.sub("([.\d]+)\s*([+-/*])\s*([.\d]+)", repl, s)
        s = re.sub("\(([.\d]+)\)", r"\1", s)
    return s 
```

刚上交时就有这个想法，直到我把它写下来并让它发挥作用时才放手。

* * *

## 回答 #25

> 赞同：4
> 
> 时间：2009-05-31T14:08:04.653

## Python

**字符数：235**

完全混淆的功能：

```
def g(a):
 i=len(a)
 while i:
  try:m=g(a[i+1:]);n=g(a[:i]);a=str({'+':n+m,'-':n-m,'*':n*m,'/':n/(m or 1)}[a[i]])
  except:i-=1;j=a.rfind('(')+1
  if j:k=a.find(')',j);a=a[:j-1]+str(g(a[j:k]))+a[k+1:]
 return float(a.replace('--','')) 
```

半模糊：

```
def g(a):
    i=len(a);
    # do the math
    while i:
        try:
            # recursively evaluate left and right
            m=g(a[i+1:])
            n=g(a[:i])
            # try to do the math assuming that a[i] is an operator
            a=str({'+':n+m,'-':n-m,'*':n*m,'/':n/(m or 1)}[a[i]])
        except:
            # failure -> next try
            i-=1
            j=a.rfind('(')+1
        # replace brackets in parallel (this part is executed first)
        if j:
            k=a.find(')',j)
            a=a[:j-1]+str(g(a[j:k]))+a[k+1:]
    return float(a.replace('--','')) 
```

FWIW，第 n+1 个 Python 解决方案。在对 try-except 的公然滥用中，我使用了试错法。它应该正确处理所有情况，包括`-(8)`,`--8`和`g('-(1 - 3)')`. 它是可重入的。如果不支持`--`许多实现不支持的情况，则为 217 个字符（请参阅以前的修订版）。

感谢您在周日度过了一个有趣的时间，并在周一又度过了 30 分钟。感谢[krubo](https://stackoverflow.com/questions/928563/code-golf-evaluating-mathematical-expressions/933198#933198)的好听话。

* * *

## 回答 #26

> 赞同：4
> 
> 时间：2009-06-01T18:04:11.567

## 红宝石

**字符数：~~217~~179**

~~这是迄今为止最短的 ruby​​ 解决方案（当字符串包含几组括号时，一个严重基于 RegExp 的解决方案会产生不正确的答案）~~——不再是真的。基于正则表达式和替换的解决方案更短。这个基于累加器堆栈并从左到右解析整个表达式。它是可重入的，并且不会修改输入字符串。它可能被指责违反了不使用的规则`eval`，因为它调用`Float`'s 方法的名称与它们的数学助记符 (+,-,/,*) 相同。

混淆代码*（旧版本，调整如下）*：

```
def f(p);a,o=[0],['+']
p.sub(/-/,'+-').scan(/(?:(-?\d+(?:\.\d+)?)|(.))\s*/).each{|n|
q,w=n;case w;when'(';a<<0;o<<'+';when')';q=a.pop;else;o<<w
end if q.nil?;a[-1]=a[-1].method(o.pop).call(q.to_f) if !q.nil?};a[0];end 
```

更多混淆代码：

```
def f(p);a,o=[0],[:+]
p.scan(/(?:(-?\d+(?:\.\d+)?)|(.))\s*/).each{|n|q,w=n;case w
when'(';a<<0;o<<:+;when')';q=a.pop;else;o<<w;end if !q
a<<a.pop.send(o.pop,q.to_f)if q};a[0];end 
```

干净的代码：

```
def f(p)
  accumulators, operands = [0], ['+']
  p.gsub(/-/,'+-').scan(/(?:(-?\d+(?:\.\d+)?)|(.))\s*/).each do |n|
    number, operand = n
    case operand
      when '('
        accumulators << 0
        operands << '+'
      when ')'
        number = accumulators.pop
        operands.pop
      else 
        operands[-1] = operand
    end if number.nil?
    accumulators[-1] = accumulators.last.method(operands[-1]).call(number.to_f) unless number.nil?
  end
  accumulators.first
end 
```

* * *

## 回答 #27

> 赞同：3
> 
> 时间：2009-05-30T02:13:48.597

## 红宝石 1.9

（因为正则表达式）

**字符数：296**

```
def d(s)
  while m = s.match(/((?<pg>\((?:\\[()]|[^()]|\g<pg>)*\)))/)
    s.sub!(m[:pg], d(m[:pg][1,m[:pg].size-2]))
  end
  while m = s.match(/(-?\d+(\.\d+)?)\s*([*+\-\/])\s*(-?\d+(\.\d+)?)/)
    r=m[1].to_f.send(m[3],m[4].to_f) if %w{+ - * /}.include?m[3]
    s.sub!(m[0], r.to_s)
  end
  s
end 
```

编辑：包括马丁的优化。

* * *

## 回答 #28

> 赞同：3
> 
> 时间：2009-05-30T12:07:35.417

## 红宝石 1.8.7

**字符数：620**

尝试在我的实现上放轻松，这是我有生以来第一次编写表达式解析器！我保证这不是最好的。

**混淆：**

```
def solve_expression(e)
t,r,s,c,n=e.chars.to_a,[],'','',''
while(c=t.shift)
n=t[0]
if (s+c).match(/^(-?)[.\d]+$/) || (!n.nil? && n.match(/\d/) && c=='-')
s+=c
elsif (c=='-' && n=='(') || c=='('
m,o,x=c=='-',1,''
while(c=t.shift)
o+=1 if c=='('
o-=1 if c==')'
x+=c unless c==')' && o==0
break if o==0
end
r.push(m ? -solve_expression(x) : solve_expression(x))
s=''
elsif c.match(/[+\-\/*]/)
r.push(c) and s=''
else
r.push(s) if !s.empty?
s=''
end
end
r.push(s) unless s.empty?
i=1
a=r[0].to_f
while i<r.count
b,c=r[i..i+1]
c=c.to_f
case b
when '+': a=a+c
when '-': a=a-c
when '*': a=a*c
when '/': a=a/c
end
i+=2
end
a
end 
```

**可读性：**

```
def solve_expression(expr)
  chars = expr.chars.to_a # characters of the expression
  parts = [] # resulting parts
  s,c,n = '','','' # current string, character, next character

  while(c = chars.shift)
    n = chars[0]
    if (s + c).match(/^(-?)[.\d]+$/) || (!n.nil? && n.match(/\d/) && c == '-') # only concatenate when it is part of a valid number
      s += c
    elsif (c == '-' && n == '(') || c == '(' # begin a sub-expression
      negate = c == '-'
      open = 1
      subExpr = ''
      while(c = chars.shift)
        open += 1 if c == '('
        open -= 1 if c == ')'
        # if the number of open parenthesis equals 0, we've run to the end of the
        # expression.  Make a new expression with the new string, and add it to the
        # stack.
        subExpr += c unless c == ')' && open == 0
        break if open == 0
      end
      parts.push(negate ? -solve_expression(subExpr) : solve_expression(subExpr))
      s = ''
    elsif c.match(/[+\-\/*]/)
      parts.push(c) and s = ''
    else
      parts.push(s) if !s.empty?
      s = ''
    end
  end
  parts.push(s) unless s.empty? # expression exits 1 character too soon.

  # now for some solutions!
  i = 1
  a = parts[0].to_f # left-most value is will become the result
  while i < parts.count
    b,c = parts[i..i+1]
    c = c.to_f
    case b
      when '+': a = a + c
      when '-': a = a - c
      when '*': a = a * c
      when '/': a = a / c
    end
    i += 2
  end
  a
end 
```

* * *

## 回答 #29

> 赞同：3
> 
> 时间：2009-06-02T10:54:30.797

## SNOBOL4

**字符数：232**

```
 a = pos(0) | '('
        n = span('0123456789.')
        j = '!+;!-;!*;!/;       output = e'
d       j '!' len(1) . y = "    e a . q n . l '" y "' n . r = q (l " y " r)     :s(p)"  :s(d)
        k = code(j)
        e = input
s       e ' ' = :s(s)
p       e ('(' n . i ')') = i   :s(p)f<k>
end 
```

这是一个半骗子。它使用`code()`（eval 的变体）解压缩自身，但不评估输入表达式。

**去混淆版本，没有`code`：**

```
 prefix = pos(0) | '('
        num = span('0123456789.')
        expr = input
spaces  expr ' ' = ''   :s(spaces)
paren   expr ('(' num . x ')') = x      :s(paren)
add     expr (prefix . pfx) (num . l) '+' (num . r) = pfx (l + r)       :s(paren)
sub     expr (prefix . pfx) (num . l) '-' (num . r) = pfx (l - r)       :s(paren)
mul     expr (prefix . pfx) (num . l) '*' (num . r) = pfx (l * r)       :s(paren)
div     expr (prefix . pfx) (num . l) '/' (num . r) = pfx (l / r)       :s(paren)
        output = expr
end 
```

战略：

*   首先，删除所有空格（`spaces`）
*   尽可能删除数字 ( `paren`)周围的括号
*   否则，找到一个包含两个数字的简单表达式，前缀为`'('`或在字符串的开头
*   如果上述规则均不适用，则表达式将被完全计算。现在，如果输入格式正确，我们应该留下一个数字。

例子：

*   `1 + (2 * 3) + 4`
*   `1+(2*3)+4`[ `spaces`]
*   `1+(6)+4`[ `mul`]
*   `1+6+4`[ `paren`]
*   `7+4`[ `add`]
*   `11`[ `add`]

* * *

## 回答 #30

> 赞同：3
> 
> 时间：2009-06-02T15:07:56.603

**C＃**

**字符数：355**

我接受了[诺多林的回答](https://stackoverflow.com/questions/928563/code-golf-evaluating-mathematical-expressions/929459#929459)并对其进行了修改，因此请给予诺多林 99% 的功劳。我能做的最好的算法是使用 408 个字符。有关更清晰的代码版本，请参见[诺多林的回答](https://stackoverflow.com/questions/928563/code-golf-evaluating-mathematical-expressions/929459#929459)。

所做的更改：
更改字符比较以与数字进行比较。
删除了一些默认声明并合并了相同类型的声明。
重新设计了一些 if 语句。

```
float q(string x){float v,n;if(!float.TryParse(x,out v)){x+=';';int t=0,l=0,i=0;char o,s='?',p='+';for(;i<x.Length;i++){o=s;if(x[i]!=32){s=x[i];if(char.IsDigit(x[i])|s==46|(s==45&o!=49))s='1';if(s==41)l--;if(s!=o&l==0){if(o==49|o==41){n=q(x.Substring(t,i-t));v=p==43?v+n:p==45?v-n:p==42?v*n:p==47?v/n:v;p=x[i];}t=i;if(s==40)t++;}if(s==40)l++;}}}return v;} 
```

编辑：通过删除其中一个返回语句，将其从 361 降低到 355。

* * *

## 回答 #31

> 赞同：3
> 
> 时间：2009-06-03T13:22:26.547

## C# 与正则表达式

**字符数：** 294

这部分基于 Jeff Moser 的回答，但评估技术显着简化。甚至可能还有其他方法可以减少字符数，但我很高兴现在有一个低于 300 个字符的 C# 解决方案！

**完全混淆的代码：**

```
float e(string x){while(x.Contains("("))x=Regex.Replace(x,@"\(([^\(]*?)\)",m=>e(m.Groups[1].Value).ToString());float r=0;foreach(Match m in Regex.Matches("+"+x,@"\D ?-?[\d.]+")){var o=m.Value[0];var v=float.Parse(m.Value.Substring(1));r=o=='+'?r+v:o=='-'?r-v:o=='*'?r*v:r/v;}return r;} 
```

**更清晰的代码：**

```
float e(string x)
{
    while (x.Contains("("))
        x = Regex.Replace(x, @"\(([^\(]*?)\)", m => e(m.Groups[1].Value).ToString());
    float r = 0;
    foreach (Match m in Regex.Matches("+" + x, @"\D ?-?[\d.]+"))
    {
        var o = m.Value[0];
        var v = float.Parse(m.Value.Substring(1));
        r = o == '+' ? r + v : o == '-' ? r - v : o == '*' ? r * v : r / v;
    }
    return r;
} 
```

* * *

## 回答 #32

> 赞同：2
> 
> 时间：2009-05-30T03:43:30.903

# Python

**字符数：492**

轻度混淆函数（短变量名，运算符周围没有空格）：

```
def e(s):
    q=[]
    b=1
    v=[]
    for c in s.replace(' ','')+'$':
        if c in '.0123456789' or c in '+-' and b and not v:
            v+=[c]
        else:
            if v:
                q+=[float(''.join(v))]
                v=[]
            while len(q)>=3:
                x,y,z=q[-3:]
                if type(x)==type(z)==float:
                    if y=='+':q[-3:]=[x+z]
                    elif y=='-':q[-3:]=[x-z]
                    elif y=='*':q[-3:]=[x*z]
                    elif y=='/':q[-3:]=[x/z]
                elif (x,z)==('(',')'):q[-3:]=[y]
                else:break
            if c=='$':break
            q+=[c]
            b=c!=')'
    return q[0] 
```

我认为这比较容易理解。这是一种非常简单、幼稚的方法。它不导入任何东西，不使用正则表达式，完全独立（单个函数，没有全局变量，没有副作用），并且应该处理带符号的文字（正面或负面）。使用更合理的变量名并遵循推荐的 Python 格式将字符数增加到更像 850-900，其中很大一部分来自使用四个空格而不是单个制表符进行缩进。

* * *

## 回答 #33

> 赞同：2
> 
> 时间：2009-05-30T14:43:52.323

## 蟒蛇 3K

（它的 3K 因为 / 将结果转换为浮点数）

**字符数：808**

清晰（我无法在 Python XD 中编写混淆代码）：

```
def parse(line):
  ops = {"+": lambda x,y:x+y,
       "-": lambda x,y:x-y,
       "*": lambda x,y:x*y,
       "/": lambda x,y:x/y}
  def tpp(s, t):
    if len(s) > 0 and s[-1] in ops:
      f = ops[s.pop()]
      t = f(s.pop(), t)
    return t
  line = line + " "
  s = []
  t = 0
  m = None
  for c in line:
    if c in "0123456789":
      if not m:
        m = "i"
      if m == "i":
        t = t*10 + ord(c)-ord("0")
      elif m =="d":
        t = t + e*(ord(c)-ord("0"))
        e*=0.1
    elif c == ".":
      m = "d"
      e = 0.1
    elif m:
      t = tpp(s,t)
      s.append(t)
      m = None
      t = 0

    if c in ops or c == "(":
      s.append(c)
    elif c == ")":
      t = s.pop()
      s.pop()
      s.append(tpp(s,t))
      t = 0
  t = s.pop()
  if int(t) == t:
    t = int(t)
  return t 
```

我没有使用任何类型的正则表达式，即使数字解析是手工制作的；-)

很简单，扫描行，它可以是3种不同的模式（m），None表示没有被解析的数字，“i”表示正在解析整数部分，“d”表示正在解析小数部分。

它使用堆栈来存储临时计算，当它完成解析一个数字时，查看堆栈中是否有一个运算符，在这种情况下是 evals 和 pushs。开头的括号只是被推动，而关闭的括号则删除了开头的括号并重新推送当前的评估。

相当简单明了:-)

* * *

## 回答 #34

> 赞同：2
> 
> 时间：2009-05-30T17:08:33.890

## 红宝石

**字符数：** 302

**半模糊：**

```
def e(l)
  t=0.0;o=nil
  while l!=''
    l.sub!(/^\s+/,'')
    l.sub!(/^(-?\d+|-?\d+\.\d+)/,'')
    t=o ? t.send(o, $1.to_f) : $1.to_f if $~
    l.sub!(/^(\+|-|\*|\/)/,'')
    o=$1 if $~
    l.sub!(/^\(/,'')
    t=o ? t.send(o, e(l)) : e(l) if $~
    l.sub!(/^\)/,'')
    return t if $~
  end
  t
end 
```

销毁原始字符串，还假设表达式格式正确（只有有效字符和匹​​配的括号）。

**不混淆：**

```
def evaluate_expression(expression)
  result_so_far = 0.0
  last_operator = nil

  while (expression != '')
    # remove any leading whitespace
    expression.sub!(/^\s+/, '') 

    # extract and remove leading integer or decimal number
    expression.sub!(/^(-?\d+|-?\d+\.\d+)/, '')
    if $~
      # match was successful
      number = $1.to_f
      if last_operator.nil?
        # first number, just store it
        result_so_far = number
      else
        # we have an operator, use it!
        # last_operator is a string matching '+', '-', '*' or '/'
        # just invoke the method of that name on our result_so_far
        # since these operators are just method calls in Ruby
        result_so_far = result_so_far.send(last_operator, number)
       end
    end

    # extract and remove leading operator +-*/
    expression.sub!(/^(\+|-|\*|\/)/, '')
    if $~
      # match was successful
      last_operator = $1
    end

    # extract and remove leading open bracket
    l.sub!(/^\(/, '')
    if $~
      # match successful
      if last_operator.nil?
        # first element in the expression is an open bracket
        # so just evaluate its contents recursively
        result_so_far = evaluate_expression(expression)
      else
        # combine the content of the bracketing with the
        # result so far using the last_operator
        result_so_far.send(last_operator, evaluate_expression(expression))
      end
    end

    # extract and remove leading close bracket
    l.sub!(/^\)/, '')
    if $~
      # match successful
      # this must be the end of a recursive call so
      # return the result so far without consuming the rest
      # of the expression
      return result_so_far
    end
  end
  t
end 
```

递归调用是通过表达式字符串的修改来控制的，虽然有点讨厌，但是好像可以。

* * *

## 回答 #35

> 赞同：1
> 
> 时间：2009-05-30T18:53:23.300

## F＃

**字符数：461**

这是 Marc Gravell 的解决方案（基本上）从 C# 转换为 F#。字符数要好得多，但我想我还是会出于兴趣而发布它。

混淆代码：

```
let e x=
 let rec f(s:string)=
  let i=s.IndexOf(')')
  if i>0 then
   let j=s.LastIndexOf('(',i)
   f(s.Substring(0,j)+f(s.Substring(j+1,i-j-1))+s.Substring(i+1))
  else
   let o=[|'+';'-';'*';'/'|]
   let i=s.LastIndexOfAny(o)
   let j=s.IndexOfAny(o,max(i-2)0,2)
   let k=if j<0 then i else j
   if k<0 then s else
    let o=s.[k]
    string((if o='+'then(+)else if o='-'then(-)else if o='*'then(*)else(/))(float(f(s.Substring(0,k))))(float(s.Substring(k+1))))
 float(f x) 
```

* * *

## 回答 #36

> 赞同：1
> 
> 时间：2009-06-01T12:40:37.460

# 爪哇

**字符数：376**

*更新版本，现在有更多？运营商滥用！*

完全混淆的解决方案：

```
static double e(String t){t="("+t+")";for(String s:new String[]{"+","-","*","/","(",")"})t=t.replace(s," "+s+" ");return f(new Scanner(t));}static double f(Scanner s){s.next();double a,v=s.hasNextDouble()?s.nextDouble():f(s);while(s.hasNext("[^)]")){char o=s.next().charAt(0);a=s.hasNextDouble()?s.nextDouble():f(s);v=o=='+'?v+a:o=='-'?v-a:o=='*'?v*a:v/a;}s.next();return v;} 
```

清除/半混淆功能：

```
static double evaluate(String text) {
    text = "(" + text + ")";
    for (String s : new String[] {"+", "-", "*", "/", "(", ")" }) {
        text = text.replace(s, " " + s + " ");
    }
    return innerEval(new Scanner(text));
}

static double innerEval(Scanner s) {
    s.next();
    double arg, val = s.hasNextDouble() ? s.nextDouble() : innerEval(s);
    while (s.hasNext("[^)]")) {
        char op = s.next().charAt(0);
        arg = s.hasNextDouble() ? s.nextDouble() : innerEval(s);
        val =
            op == '+' ? val + arg :
            op == '-' ? val - arg :
            op == '*' ? val * arg :
            val / arg;
    }
    s.next();
    return val;
} 
```

* * *

## 回答 #37

> 赞同：1
> 
> 时间：2009-06-02T13:57:40.927

## C++

字符：1670

```
 // not trying to be terse here
#define DIGIT(c)((c)>='0' && (c) <= '9')
#define WHITE(pc) while(*pc == ' ') pc++
#define LP '('
#define RP ')'

bool SeeNum(const char* &pc, float& fNum){
    WHITE(pc);
    if (!(DIGIT(*pc) || (*pc=='.'&& DIGIT(pc[1])))) return false;
    const char* pc0 = pc;
    while(DIGIT(*pc)) pc++;
    if (*pc == '.'){
        pc++;
        while(DIGIT(*pc)) pc++;
    }
    char buf[200];
    int len = pc - pc0;
    strncpy(buf, pc0, len); buf[len] = 0;
    fNum = atof(buf);
    return true;
}

bool SeeChar(const char* &pc, char c){
    WHITE(pc);
    if (*pc != c) return false;
    pc++;
    return true;
}

void ParsExpr(const char* &pc, float &fNum);

void ParsPrim(const char* &pc, float &fNum){
    if (SeeNum(pc, fNum));
    else if (SeeChar(pc, LP)){
        ParsExpr(pc, fNum);
        if (!SeeChar(pc, RP)) exit(0);
    }
    else exit(0); // you can abort better than this
}

void ParsUnary(const char* &pc, float &fNum){
    if (SeeChar(pc, '-')){
        pc+;
        ParsUnary(pc, fNum);
        fNum = -fNum;
    }
    else {
        ParsPrim(pc, fNum);
    }
}

void ParsExpr(const char* &pc, float &fNum){
    ParsUnary(pc, fNum);
    float f1 = 0;
    while(true){
        if (SeeChar(pc, '+')){
            ParsUnary(pc, f1);
            fNum += f1;
        }
        else if (SeeChar(pc, '-')){
            ParsUnary(pc, f1);
            fNum -= f1;
        }
        else if (SeeChar(pc, '*')){
            ParsUnary(pc, f1);
            fNum *= f1;
        }
        else if (SeeChar(pc, '/')){
            ParsUnary(pc, f1);
            fNum /= f1;
        }
        else break;
    }
} 
```

这只是 LL1（递归下降）。我喜欢这样做（虽然我使用双打），因为它非常快，并且很容易插入例程来处理优先级。

* * *

## 回答 #38

> 赞同：1
> 
> 时间：2009-06-05T21:38:36.000

## **PowerBASIC**

**字符数：** ~400

有点难看，但它的工作原理。:) 我确信正则表达式会使它变得更小。

```
DEFDBL E,f,i,z,q,a,v,o  
DEFSTR s,c,k,p

FUNCTION E(s)  

    i=LEN(s)  
    DO  
        IF MID$(s,i,1)="("THEN  
            q=INSTR(i,s,")")  
            s=LEFT$(s,i-1)+STR$(E(MID$(s,i+1,q-i-1)))+MID$(s,q+1)  
        END IF  
        i-=1  
    LOOP UNTIL i=0  

    k="+-*/"  
    DIM p(PARSECOUNT(s,ANY k))  
    PARSE s,p(),ANY k  

    a=VAL(p(0))

    FOR i=1TO LEN(s)
        c=MID$(s,i,1)
        q=INSTR(k,c)
        IF q THEN
            z+=1
            IF o=0 THEN o=q ELSE p(z)=c+p(z)
            IF TRIM$(p(z))<>"" THEN
                v=VAL(p(z))
                a=CHOOSE(o,a+v,a-v,a*v,a/v)
                o=0
            END IF
        END IF
    NEXT

    E=a  
END FUNCTION 
```

* * *

## 回答 #39

> 赞同：1
> 
> 时间：2009-06-09T21:50:48.663

## C#，264 个字符

策略：前两行通过归纳去掉括号。然后我分开`\-?[\d.]+`以获得数字和运算符。然后使用聚合将字符串数组减少为双精度值。

**变量解释**

m 是带括号的表达式，没有嵌套括号。
d 是那个笨拙的 TryParse 语法的占位符。
v 是最终值的累加器
t 是当前令牌。

```
`float E(string s){var d=999f;while(d-->1)s=Regex.Replace(s,@"(([^(]*?))",m=>E(m.Groups[1].Value)+"");return Regex.Split(s,@"(-?[\d.]+)").Aggregate(d,(v,t)=>(t=t.Trim()).Length==0?v:!float.TryParse(t,out d)?(s=t)==""?0:v:s=="/"?v/d:s=="-"?v-d:s=="*"?v*d:v+d);}` 
```

```
 `float F(string s) {
        var d=999f;
        while(d-->1)
            s=Regex.Replace(s,@"\(([^\(]*?)\)",m=>F(m.Groups[1].Value)+"");
        return Regex.Split(s, @"(\-?[\d\.]+)")
            .Aggregate(d, (v, t) => 
                (t=t.Trim()).Length == 0 ? v :
                !float.TryParse(t, out d) ? (s=t) == "" ? 0 : v :
                s == "/" ? v / d :
                s == "-" ? v - d :
                s == "*" ? v * d :
                           v + d);
    }` 
```

 `编辑：无耻地从诺多林的答案中偷了部分，将 s 用作运算符变量。

编辑：999 个嵌套括号对任何人来说都足够了。

* * *

## 回答 #40

> 赞同：1
> 
> 时间：2010-04-18T17:35:43.907

OCaml[直接使用 Camlp4](http://ocamlnews.blogspot.com/2007/11/camlp4-310-writing-parsers-and-macros.html)：

```
open Camlp4.PreCast

let expr = Gram.Entry.mk "expr"

EXTEND Gram
  expr:
  [   [ e1 = expr; "+"; e2 = expr -> e1 + e2
      | e1 = expr; "-"; e2 = expr -> e1 - e2 ]
  |   [ e1 = expr; "*"; e2 = expr -> e1 * e2
      | e1 = expr; "/"; e2 = expr -> e1 / e2 ]
  |   [ n = INT -> int_of_string n
      | "("; e = expr; ")" -> e ]   ];
END

let () = Gram.parse expr Loc.ghost (Stream.of_string "1-2+3*4") 
```

OCaml[使用 Camlp4 流解析器扩展](http://www.ffconsultancy.com/ocaml/benefits/parsing.html)：

```
open Genlex

let lex = make_lexer ["+"; "-"; "*"; "/"; "("; ")"]

let rec parse_atom = parser
  | [< 'Int n >] -> n
  | [< 'Kwd "("; e=parse_expr; 'Kwd ")" >] -> e
and parse_factor = parser
  | [< e1=parse_atom; stream >] ->
      (parser
         | [< 'Kwd "*"; e2=parse_factor >] -> e1 * e2
         | [< 'Kwd "/"; e2=parse_factor >] -> e1 / e2
         | [< >] -> e1) stream
and parse_expr = parser
  | [< e1=parse_factor; stream >] ->
      (parser
         | [< 'Kwd "+"; e2=parse_expr >] -> e1 + e2
         | [< 'Kwd "-"; e2=parse_expr >] -> e1 - e2
         | [< >] -> e1) stream

let () =
  Printf.printf "%d\n" (parse_expr(lex(Stream.of_string "1 + 2 * (3 + 4)")));; 
```

* * *

## 回答 #41

> 赞同：0
> 
> 时间：2009-06-01T13:27:37.227

我很惊讶没有人在 Lex / Yacc 或同等产品中做到这一点。

这似乎会产生最短且可读/可维护的源代码。

* * *

## 回答 #42

> 赞同：0
> 
> 时间：2009-06-23T21:09:10.157

## PHP

**字符数：170**

完全混淆的功能：

```
function a($a,$c='#\(([^()]*)\)#e',$d='a("$1","#^ *-?[\d.]+ *\S *-?[\d.]+ *#e","\$0")'){$e='preg_replace';while($a!=$b=$e($c,$d,$a))$a = $b;return$e('#^(.*)$#e',$d,$a);} 
```

更清晰的功能：

```
function a($a, $c = '#\(([^()]*)\)#e', $d = 'a("$1", "#^ *-?[\d.]+ *\S *-?[\d.]+ *#e", "\$0")') {
    $e = 'preg_replace';
    while ($a != $b = $e($c, $d, $a)) {
        $a = $b;
    }
    return $e('#^(.*)$#e', $d, $a);
} 
```

测试：

```
assert(a('1 + 3 / -8') === '-0.5');
assert(a('2*3*4*5+99') === '219');
assert(a('4 * (9 - 4) / (2 * 6 - 2) + 8') === '10');
assert(a('1 + ((123 * 3 - 69) / 100)') === '4');
assert(a('2.45/8.5*9.27+(5*0.0023)') === '2.68344117647');
assert(a(' 2 * 3 * 4 * 5 + 99 ') === '219'); 
```

* * *

## 回答 #43

> 赞同：-2
> 
> 时间：2009-05-31T00:20:23.733

## Perl

**字符数：93**

完全混淆功能：（如果将这三行合二为一，则为 93 个字符）

```
$_="(@ARGV)";s/\s//g;$n=qr/(-?\d+(\.\d+)?)/;
while(s.\($n\)|(?<=\()$n[-+*/]$n.eval$&.e){}
print 
```

清除/半混淆功能：

```
$_="(@ARGV)";            # Set the default var to "(" argument ")"
s/\s//g;                 # Strip all spaces from $_
$n=qr/(-?\d+(\.\d+)?)/;  # Compile a regex for "number"

# repeatedly replace the sequence "(" NUM ")" with NUM, or if there aren't
# any of those, replace "(" NUM OP NUM with the result
# of doing an eval on just the NUM OP NUM bit.
while(s{\($n\)|(?<=\()$n[-+*/]$n}{eval$&}e){}

# print $_
print 
```

我认为这在“清晰”版本中得到了很好的解释。两个主要见解是，您可以通过在开始时用括号括起参数来使代码统一（特殊情况下成本字符），并且仅处理开放括号旁边的内容就足够了，尽管效率非常低，替换它及其结果。

运行此代码可能最简单：

```
perl -le '$_="(@ARGV)";s/\s//g;$n=qr/(-?\d+(\.\d+)?)/;while(s.\($n\)|(?<=\()$n[-+*/]$n.eval$&.e){}print' '4 * (9 - 4) / (2 * 6 - 2) + 8' 
```

# c++ - 在 C++ 中创建多个全局静态实例？

> ID：928568
> 
> 赞同：4
> 
> 时间：2009-05-29T23:44:35.327
> 
> 标签：c++, static, singleton, global

我们用于产品的库之一使用单例来访问它。我很确定它是作为静态实例实现的（它不是开源的）。这适用于单个文档应用程序，但我们的应用程序可能加载了多个文档。我假设对实例的访问是这样写的：

```
Instance* getInstance() {
    static Instance* inst = new Instance();
    return inst;
} 
```

在这种情况下，是否有某种方法可以稳健地创建多个实例？我唯一能想到的就是拥有更多的流程并使用某种类型的 IPC 将它们捆绑在一起。我想不出什么比hacky更少的了。

我已经要求供应商实现某种类型的会话令牌，这样我就可以拥有多个并发实例，但它们很大而我们很小。

科里

**编辑：**

*   该机器是 Windows 机器
*   全局静态基本上是一个大工厂。我想要某种类型的会话令牌，所以我可以轻松地说“释放此会话中的所有资源”（没有办法重新初始化我所知道的全局静态）

我不会尝试一些狡猾的恶作剧来获得我想要的东西，而是用我自己的类来包装整个事情，并为每个 getter 添加一个会话密钥。在内部，我将跟踪已分配的内容，添加我自己的发布方法以返回资源。由于很多原因，这是次优的，但我想不出更好的主意。

感谢大家的反馈。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-30T00:19:29.203

即使您能够在所有事情都在进程中发生的情况下解决这个特定问题，我也会担心这个单例问题只是冰山一角。该库显然不是为您的场景设计的。

将 DLL 的每个负载隔离到它自己的进程中听起来对我来说是正确的，而且不是 hacky，当然这对你来说可能很昂贵。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-30T00:19:03.557

不幸的是，我看不出你的推理有缺陷。供应商已做出决定，您受其约束。他已经决定每个进程一个实例，所以如果你想要多个实例，你必须有多个进程，所有这些都需要。

当然，如果您认为他的限制决定是任意的，并且没有充分的理由，您可以尝试绕过它。从该路径开始的方法是在调试器中执行一些反汇编/汇编步骤。如果您可以确认他的实例工厂的工作方式与您在上面得出的结论完全一致，那么您无疑可以拼凑出一个允许创建多个实例的替代方案。

但当然，这种方法的巨大风险在于，供应商代码库中依赖于他决定拥有单个实例的每一行代码都会成为一个定时炸弹，随时准备在你面前爆炸。该代码对您是不可见的。你准备好打赌这样的线为零吗？我知道克林特伊斯特伍德在这种情况下会说什么；“你觉得朋克很幸运，好吗？” :-)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-30T00:27:47.220

没有优雅的方法可以在一个程序空间中拥有单个对象的多个实例——但这是故意的。通常，您只在不希望有多个实例的情况下使用单例。如果供应商使用单例实现了他们的产品，那么选择可能有充分的理由。

也许，如果您更详细地描述您的问题，可能还有其他方法。很难说，根据提供的信息。单例对象有什么作用？为什么需要它的多个实例？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-30T00:28:00.293

除了你建议的进程间的东西，我能想出的最好的方法是将 dll 复制到一个新文件并手动加载新的 dll 并导入你为每个创建的实例使用的所有函数。

希望这意味着静态变量不会在不同实例之间发生冲突，因为它们在技术上不在同一个 dll 中。然而，这个解决方案有很多不好的地方，例如每个版本都克隆了 dll 中的所有代码，您将无法使用导入库，而必须手动加载 dll 并导入所有函数。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-30T01:37:30.900

我能想到的唯一一件事就是如果你有幸将单例类定义为：

```
class Document {
public:
    static Document* getInstance() {
        static Document inst;
        return &inst;
    }
    virtual ~Document();
protected:
    Document();
private:
    struct Impl;
    Impl *pImpl;
}; 
```

如果您可以对其进行子类化并且子类将可以访问构造函数，那么您可以创建一个可*实例*化的子类，例如：

```
class MyDocument: public Document {
public:
    MyDocument(): Document() {
    }
}; 
```

这可能并不完全安全，因为实施者可能做出了一些令人讨厌的假设。但它是一个想法或某种方法，可能有一定的工作机会。如果你提到它，供应商可能会接受这个选项......祝你好运。

# cocoa-touch - tableViewHeader 拒绝多个子视图

> ID：928570
> 
> 赞同：0
> 
> 时间：2009-05-29T23:44:44.250
> 
> 标签：cocoa-touch, uitableview, uiview

UITableView 的 tableViewHeader 属性是一个 UIView 所以我想我可以向它添加多个子视图。但是，当我为分段控件添加代码时，UILabel 在它不绘制前几行。矩形*不应*相互重叠。

我究竟做错了什么？

```
- (void)viewDidLoad {
[super viewDidLoad];

CGRect newFrame = CGRectMake(0.0, 0.0, self.tableView.bounds.size.width, 50.0);
UIView *trialHeaderView = [[UIView alloc] initWithFrame:newFrame];
trialHeaderView.backgroundColor = [UIColor clearColor];

UILabel *label = [[[UILabel alloc] initWithFrame:CGRectMake(15.0, 10.0, 75.0, 25.0)] autorelease];
label.font = [UIFont boldSystemFontOfSize:12.0];
label.text = @"TaDa!";
label.backgroundColor = [UIColor clearColor];
label.textColor = [UIColor blackColor];
[trialHeaderView addSubview:label];
[label release];

CGRect frame = CGRectMake(80, 10, 100, 35);
UISegmentedControl *seg = [[UISegmentedControl alloc] initWithFrame:frame];
[seg insertSegmentWithTitle:@"Start" atIndex:0 animated:NO];
[seg insertSegmentWithTitle:@"End" atIndex:1 animated:NO];
[trialHeaderView addSubview:seg];

[seg release];

self.tableView.tableHeaderView = trialHeaderView;
[trialHeaderView release]; 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T00:54:41.940

应该早点更新这个......我已经自动发布并发布了同一个对象。傻我...

# drop-down-menu - ASP.NET 动态数据 将文本字段更改为下拉列表并填充一些数据

> ID：928575
> 
> 赞同：3
> 
> 时间：2009-05-29T23:46:58.707
> 
> 标签：drop-down-menu, asp.net-3.5, dynamic-data

我有一个 ASP.NET 动态数据站点，对于编辑和插入模板中的一个文本字段，我想将其转换为下拉列表并以编程方式填充该下拉列表。你能帮助或指出正确的方向吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-30T18:35:24.680

在我的博客上查看这些示例： [FieldTemplate 的剖析。](http://csharpbits.notaclue.net/2008/07/dynamic-data-and-field-templates.html) [您的第一个 FieldTemplate。](http://csharpbits.notaclue.net/2008/07/dynamic-data-and-field-templates-your.html) [高级字段模板。](http://csharpbits.notaclue.net/2008/07/dynamic-data-and-field-templates_28.html) [第二个高级字段模板。](http://csharpbits.notaclue.net/2008/08/dynamic-data-and-field-templates-second.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T21:59:20.597

您需要做的是创建一个自定义 FieldTemplate 并使用列/属性上的 UIHint 属性来指示 ASP.NET 动态数据在插入和编辑模式下使用该自定义 FieldTemplate。

见这里：http: [//msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.uihintattribute.aspx](http://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.uihintattribute.aspx)

在这里：[http ://www.asp.net/learn/3.5-SP1/](http://www.asp.net/learn/3.5-SP1/)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2010-12-17T04:19:21.837

有一种更简单的方法可以做到这一点，只需在与 EF 生成的代码分开的部分类中创建一个具有以下属性的类：

```
[DisplayColumn("columnName")]
public partial class Product{} 
```

希望对以后的参考有所帮助。

# c# - Web 用户控件在 Default.aspx 中不可见

> ID：928579
> 
> 赞同：1
> 
> 时间：2009-05-29T23:49:13.927
> 
> 标签：c#, asp.net, user-controls

是什么赋予了？我之前创建的用户控件是可见的，但新创建的不是 - 智能不显示它，

我的印象是，如果 Web 用户控件在同一个项目中，则不需要在项目中放置任何 using 语句或引用。

更新：两个声明看起来像这样：

```
public partial class CtrlClassName : System.Web.UI.UserControl 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-29T23:54:44.930

确保在 Default.aspx 中有正确的 @register。请参阅 [此处](http://weblogs.asp.net/scottgu/archive/2006/11/26/tip-trick-how-to-register-user-controls-and-custom-controls-in-web-config.aspx)以供参考。

例子：

```
<%@ Register TagPrefix="pfx" TagName="CtrlClassName" Src="Controls/CtrlClassName.ascx" %> 
```

# hibernate - 休眠级联问题

> ID：928583
> 
> 赞同：0
> 
> 时间：2009-05-29T23:51:14.157
> 
> 标签：hibernate, cascade

我有一个名为 Property 的休眠 bean，它有一个类型和一个值。如果 type 是某个类 (EntityValue)，则 value 是指向 BaseEntity 的链接。BaseEntity 有一个 @OneToMany @CascadeType.ALL 列表属性。

为了安全地删除 BaseEntity，我需要确保它不是任何其他 BaseEntityS 中 EntityValue 的一部分。即使我可以想出 hql 来确定哪个 BaseEntityS 引用了给定的 BaseEntity，我可以从它的集合中删除一个属性，它的链接表条目会被删除吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T06:01:49.360

我认为您正在寻找的是注释：

```
@Cascade({org.hibernate.annotations.CascadeType.DELETE_ORPHAN}) 
```

当您删除父实体时，这将具有删除一对多的另一侧的效果。

# c# - 在现有应用程序（Windows 或 Web）.Net 中添加日志记录的最佳方式

> ID：928587
> 
> 赞同：3
> 
> 时间：2009-05-29T23:53:14.980
> 
> 标签：c#, .net, logging

我继承了几个没有添加任何跟踪或日志记录的 .Net (C#) 应用程序。该应用程序执行从创建、读取、更新和删除记录的所有操作。它发送电子邮件并调用网络服务。

当然，维护它是一场噩梦，因为没有日志记录，也没有 try catch 机制（我知道我也不敢相信）。

那么在这个系统中实现日志记录的最佳方式是什么。我不能去每个函数调用并添加日志记录行。有什么方法可以让我进行动态日志记录，该日志记录可以根据我提供的方法名称进行记录。

IE 调用 UpdateOrder() 时，我的记录器应该记录（调用了更新的 order 方法）

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-10-08T05:34:28.920

使用 log4net，它是 Apache log4j 的 .NET 版本。该库经过了很好的测试，被各地的程序员使用，并且非常可定制。由于您已经继承了此代码，因此通过它并开始添加日志记录支持并不是一件坏事。

自定义设置是通过项目中的全局文件处理的，可以指定日志信息的去向（电子邮件、文本文件、控制台）以及每个日志信息的输出源所需的详细级别。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T00:07:58.883

如果您在 .NET 中，请注意以下几点：

[http://www.codeproject.com/KB/dotnet/LoggerByHernandson.aspx](http://www.codeproject.com/KB/dotnet/LoggerByHernandson.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-30T01:00:30.210

你可以使用像[Postsharp](http://www.postsharp.org/)这样的 AOP 框架来创建一个特定的属性来记录方法调用：

```
public class TraceAttribute : OnMethodBoundaryAspect 
{ 
  public override void OnEntry( MethodExecutionEventArgs eventArgs) 
  { Trace.TraceInformation("Entering {0}.", eventArgs.Method);  } 

  public override void OnExit( MethodExecutionEventArgs eventArgs) 
  { Trace.TraceInformation("Leaving {0}.", eventArgs.Method);   } 
} 
```

（此代码是主页上的示例）

然后，您可以将此属性应用于要记录的方法：

```
[Trace]
public void UpdateOrder()
{
    ...
} 
```

# javascript - 最新的 jqModal 版本：“实时”链接触发器不起作用

> ID：928591
> 
> 赞同：0
> 
> 时间：2009-05-29T23:55:50.077
> 
> 标签：javascript, jquery, jqmodal

在最新的 jqModal 版本 (+r14) 中，我遇到了实时链接的新功能的问题。每当单击实时加载的触发器链接时，它都会重定向到 HREF，而不是通过 AJAX 加载它。我怎样才能让它正常运行？

我四处寻找，其他人似乎有这个问题，但它没有得到解决。

```
$('a.modal-product-trigger').live('click', function(){
    $('#modal-product').jqmShow(this);
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-29T23:59:18.323

我对 jqModal 不是特别熟悉，但是尝试取消该事件：

```
$('a.modal-product-trigger').live('click', function(){
        $('#modal-product').jqmShow(this);
        return false;   
}); 
```

如果您不这样做，该事件将按照其默认操作进行，即充当常规链接。

# php - 将用户添加到 MediaWiki 的脚本

> ID：928594
> 
> 赞同：3
> 
> 时间：2009-05-29T23:56:55.533
> 
> 标签：php, mediawiki

我正在尝试编写一个在 MediaWiki 中创建用户的脚本，以便我可以运行批处理作业来导入一系列用户。

我正在使用 mediawiki-1.12.0。

我从论坛获得了这段代码，但它看起来不适用于 1.12（它适用于 1.13）

```
$name = 'Username'; #Username (MUST start with a capital letter)
$pass = 'password'; #Password (plaintext, will be hashed later down)
$email = 'email';   #Email (automatically gets confirmed after the creation process)
$path = "/path/to/mediawiki";
putenv( "MW_INSTALL_PATH={$path}" );
require_once( "{$path}/includes/WebStart.php" );
$pass = User::crypt( $pass );
$user = User::createNew( $name, array( 'password' => $pass, 'email' => $email ) );
$user->confirmEmail();
$user->saveSettings();  
$ssUpdate = new SiteStatsUpdate( 0, 0, 0, 0, 1 );
$ssUpdate->doUpdate(); 
```

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-30T00:02:46.270

有一个`createAndPromote`脚本可以在`maintenance/`其中创建用户帐户并授予管理员权限。您可以对此进行调整以删除权限部分。

或者，您可以查看[`ImportUsers`](http://www.mediawiki.org/wiki/Extension:ImportUsers)扩展程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-06-12T08:13:06.150

我在 Mediawiki 1.7 上使用了它，它对我来说效果很好：

```
#!/usr/bin/php
## Add a user to Mediawiki

<?php

    $domain = 'example.com';
    $mwpath = '/docs/www-wiki';

    if ($argc < 3) {
        die("Missing arguments.\n"
           ."Usage: $0 USER PASSWORD\n");
    }
    $user = $argv[1];
    $pass = $argv[2];

    print "Add user $user with password $pass [y/N]?\n";
    $ans = fgets(STDIN,256);
    if (!  preg_match('/^[yY]/', $ans) ) {
        print "Canceled.\n";
        exit;
    }

    $user = ucfirst(strtolower($user)); // maybe unneeded, because handled in MW functions?

    # Adapted from http://www.mwusers.com/forums/showthread.php?9788-Create-new-user-in-database&p=42931&viewfull=1#post42931

    $path = $mwpath;
    putenv("MW_INSTALL_PATH={$path}");

    #require_once ("{$path}/includes/WebStart.php"); // for version >= 1.14 ?

    # My version 1.7 doesn't have WebStart.php.
    # It seems to work by including the following lines found in index.php
    # Some are probably not needed, but I don't want to do more testing
    define( 'MEDIAWIKI', true );
    require_once( './includes/Defines.php' );
    require_once( './LocalSettings.php' );
    require_once( 'includes/Setup.php' );
    require_once( "includes/Wiki.php" );
    $mediaWiki = new MediaWiki();

    $mwuser=User::newFromName($user);

    if (! is_object($mwuser)) {
        die("Invalid user!\n");
    }

    $mwuser->addToDatabase(); // don't we need a return value to check?
    $mwuser->setPassword( $pass );
    $mwuser->setEmail( strtolower($user) . '@' . $domain );
    $mwuser->confirmEmail();

    #$mwuser->setRealName( $_POST["nome"] );
    #$mwuser->addGroup($_POST["grupo"]);

    $mwuser->saveSettings(); // no return value?
    $ssUpdate = new SiteStatsUpdate( 0, 0, 0, 0, 1 );
    $ssUpdate->doUpdate();
?> 
```

我猜您的问题也是您的脚本中使用了 WebStart.php，而您的 Mediawiki 版本中不存在该脚本。

# c# - db4o 出现问题...在 IIS 重置/容器超出范围后不返回对象

> ID：928597
> 
> 赞同：2
> 
> 时间：2009-05-30T00:00:55.557
> 
> 标签：c#, db4o

所以我可能对 db4o 做了一些可悲的错误，导致这个问题发生......但每次我重置我的上下文时，我都会丢失所有的对象。我的意思是，一旦我的容器对象超出范围（由于 IIS 重置或其他原因），我就无法再检索我之前保留的任何对象。在“会话”的范围内，我可以检索所有内容，但是一旦该“会话”终止，则不会返回任何内容。奇怪的是，数据库文件的大小继续增长，所以我知道所有东西都在里面，只是事后永远不会返回。知道发生了什么吗？

这是我的 db4o 通用包装器：

```
public class DataStore : IDisposable {

    private static readonly object serverLock = new object();
    private static readonly object containerLock = new object();

    private static IObjectServer server;
    private static IObjectContainer container;

    private static IObjectServer Server {
        get {
            lock (serverLock) {
                if (server == null)
                    server = Db4oFactory.OpenServer(ConfigurationManager.AppSettings["DatabaseFilePath"], 0);
                return server;
            }
        }
    }

    private static IObjectContainer Container {
        get {
            lock (containerLock) {
                if (container == null)
                    container = Server.OpenClient();
                return container;
            }
        }
    }

    public IQueryable<T> Find<T>(Func<T, bool> predicate) {
        return (from T t in Container where predicate(t) select t).AsQueryable();
    }

    public IQueryable<T> Find<T>() {
        return (from T t in Container select t).AsQueryable();
    }

    public ValidationResult Save(IValidatable item) {
        var validationResult = item.Validate();
        if (!validationResult.IsValid) return validationResult;
        Container.Store(item);
        return validationResult;
    }

    public void Delete(object item) {
        Container.Delete(item);
    }

    public void Dispose() {
        Server.Close();
        Container.Close();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-10-13T10:59:33.880

我认为您在 Save 方法中缺少提交语句。

戈兰

# asp.net-mvc - 如何处理 Actionlink 和 Controller Action 之间的不同路由值类型

> ID：928601
> 
> 赞同：0
> 
> 时间：2009-05-30T00:02:14.807
> 
> 标签：asp.net-mvc

我的控制器动作接受 int id。从带有字符串 id 的 View ActionLink 调用时该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T07:55:15.550

MVC 绑定基础结构将在调用控制器操作方法之前将字符串转换为 int（如果转换失败则抛出异常）。

# c++ - 这是重载左流运算符的正确方法吗？(C++)

> ID：928613
> 
> 赞同：0
> 
> 时间：2009-05-30T00:09:14.073
> 
> 标签：c++, operator-overloading, stream, ostream

这个函数声明给了我错误：

```
ostream& operator<<(ostream& os, hand& obj); 
```

错误是：

```
error C2143: syntax error : missing ';' before '&'
error C4430: missing type specifier
error C2065: 'os' : undeclared identifier
error C2065: 'obj' : undeclared identifier
error C2275: 'hand' : illegal use of this type as an expression
    see declaration of 'hand'
error C4430: missing type specifier 
```

hand 是我做的一个类， display 是 type 的公共数据成员`char*`。

谁能告诉我我做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-30T00:12:02.757

声明看起来正确。但是错误消息表明它`ostream`不是一种类型。尝试包括`iostream`标题并`std::ostream`改为说。

您应该考虑的另一件事是使参数 'hand' 成为 const 引用。所以你也可以接受临时文件并将它们打印出来。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-30T00:12:52.257

这是在标题内吗？那么你可能需要说`std::ostream`。确保你`#include<iosfwd>`.

此外，您可能会说`const hand&`.

# c# - 确保 Windows Mobile 应用程序未运行 - 从桌面应用程序

> ID：928614
> 
> 赞同：0
> 
> 时间：2009-05-30T00:09:19.083
> 
> 标签：c#, windows-mobile, compact-framework

我有一个 Windows Mobile 5.0 应用程序（智能手机），其中包含一个平面数据文件 (CSV)，其中包含一个标题行（两个双精度）和一个条目列表（两个双精度、日期时间和一个字符串）。

有时，我需要将移动应用程序与桌面应用程序“同步”。桌面应用程序应从移动设备读取 CSV，并根据旧文件的内容将其替换为新的 CSV 文件。

通过 RAPI（我猜）这似乎很容易，但我需要确保移动应用程序没有运行。有没有办法做到这一点？

互斥体？远程进程查看器之类的东西？文件锁定？

感谢您提供的任何帮助

麦克风

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T08:38:28.473

只需对正在读取/更新的文件使用简单的文件锁定机制。

在使用前重命名文件或创建第二个“锁定”文件，您可以检查它是否存在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T00:53:45.483

无论出于何种原因，[内置 RAPI 函数](http://msdn.microsoft.com/en-us/library/aa457105.aspx)都没有任何东西可以检查正在运行的进程，例如[ToolHelp API 的](http://msdn.microsoft.com/en-us/library/aa915058.aspx). 使用 C，您可以在调用 ToolHelp API 的设备库中创建一组自定义函数，然后通过[CeRapiInvoke](http://msdn.microsoft.com/en-us/library/ms834931.aspx)（这是自定义 RAPI 函数的通用包罗万象的入口点）调用。不幸的是，在托管代码中没有简单的机制可以做到这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-30T00:16:19.693

刚想到一个简单的方法。

程序每运行 3 秒，使用当前日期时间更新一个注册表项。

当我要同步时，检查移动注册表，5秒后再次检查。如果值更改，程序仍在运行。

# .net - 您将如何在 F# 中解决这个问题？（高频传感器数据）

> ID：928619
> 
> 赞同：4
> 
> 时间：2009-05-30T00:12:01.293
> 
> 标签：.net, f#, functional-programming

我是一名机械工程研究生，我的导师刚刚要求我为我们的一个传感器项目编写一个数据可视化实用程序。因为现在是夏天，他想让我玩得开心，我认为这将是学习擅长科学计算的语言的好时机，所以我继续努力学习 F#。

由于我是函数式编程范式的新手，我在正确构建程序时遇到了一点困难，特别是考虑到在 F# 中轻松组合 OO/FP 的可能性。我的任务如下：

1.  我们有数十个传感器不断报告数据（每隔几秒一次）。
2.  我需要同时连接到所有传感器，创建每个传感器输出的内存时间序列，然后实时计算这些时间序列的各种统计数据。
3.  每隔几个小时，我需要将数据刷新到二进制文件中以进行日志记录。

我应该如何设计我的应用程序？我想过这样的事情： 1\. 我计划连接到每个传感器以开始接收数据，然后将这些数据转储到消息队列中。2\. 我有一个事件驱动的处理函数接收队列中的数据。接收到数据后，判断数据来自哪个传感器，然后将数据放入对应传感器的 timeseries 对象中。3\. 每次添加传感器数据时间序列对象时，我都可以触发一个事件并让我的统计功能为传感器处理新数据。

显然我需要在这个应用程序中保持某种状态。所以我会添加以下可变数据结构。我会使用一个通用的 .NET 可调整大小的 List 来存储我的时间序列数据，并实现一个新的衍生工具来触发数据添加事件。我可以将 sensorid 和实际时间序列容器之间的映射存储在字典中（当数据从队列中弹出时，我可以读取 sensorid 字段，获取该 sensorid 的时间序列容器，然后轻松添加新数据）。我还可以有第二个字典来存储 sensorid 和包含该 sensorid 时间序列统计信息的各种时间序列之间的映射）。当一个主要的传感器时间序列被添加到，

我还没有考虑过如何保存数据，但我想我可以用数据写出二进制文件。

任何建议、想法或参考都表示赞赏。

谢谢 ：）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-30T03:04:36.717

我建议不要在 F# 中实现您的新项目，直到您更好地掌握该语言，否则您最终会以 F# 语法编写 C# 代码。至少对于工作中的项目，使用你知道的工具比使用公司的钱来试验新技术要好。

但是，既然你问了，我会使用[邮箱处理器](http://en.wikibooks.org/wiki/F_Sharp_Programming/MailboxProcessor)作为所有传感器输入的线程安全消息处理队列。消息队列可以重新计算接收到的每条消息的统计信息。在我的脑海中，我正在考虑这样的设置：

```
type SensorMsg<'a, 'b> =
    | Fetch of 'a AsyncReplyChannel
    | Post of 'b
    | Die

type SensorMessageQueue<'a, 'b>(emptyStats : 'a, compute : 'a -> 'b -> 'a) =
    let queue = MailboxProcessor.Start(fun inbox ->
            let rec loop stats =
                async {
                    let! msg = inbox.Receive()
                    match msg with
                    | Die -> return ()
                    | Post(x) -> return! loop (compute stats x)
                    | Fetch(x) -> x.Reply(stats); return! loop stats
                }
            loop emptyStats
        )

    member this.Post(x) = queue.Post(Post(x))
    member this.Fetch() = queue.PostAndReply(fun replyChannel -> Fetch(replyChannel))
    member this.Die() = queue.Post(Die) 
```

像这样的东西可以保存传感器的实时运行统计数据。例如，假设我想发布一些可以保持运行平均值的内容：

```
let averager =
    SensorMessageQueue(
            (0, 0), (* initial state of sum, total *)
            (fun (sum, total) input -> sum + input, total + 1)
        )

averager.Post(75)
averager.Post(90)
averager.Post(80)
let x = averager.Fetch() (* returns (245, 3) *)
averager.Post(100)
let y = averager.Fetch() (* returns (345, 4) *) 
```

像这样的设置相对容易使用，线程安全，并且不使用可变状态（所有“状态”都存在于闭包的参数中）。如果你仔细想想，这基本上是一个美化的 seq.unfold，只使用邮箱处理器实现。这可能是矫枉过正，可能恰到好处，或者可能正是您的项目所需要的，这取决于您的要求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T06:54:04.853

我可能完全错了，这不是你问题的答案，所以随意投票给我，但我对 F# 一年多的兴趣的“感觉”是那里没有那么多人（或“在这里”）在科学/技术环境中使用 F# 有丰富的经验（我知道[一个](https://stackoverflow.com/users/13924/jon-harrop) [例外](http://www.ffconsultancy.com/products/fsharp_for_scientists/index.html)）。

可能是微软将他们的精力集中在 F# 与金融界的联系上——回想起来，这是一个相当不幸的时机！

这并不意味着您不会为您的特定问题得到好的答案，您只是不太可能得到“哦，是的，我上周做了类似的事情，注意这个问题”等等......

顺便说一句，您知道[F# 中的度量单位](http://blogs.msdn.com/andrewkennedy/archive/2008/08/29/units-of-measure-in-f-part-one-introducing-units.aspx)吗？任何与技术相关的东西都非常有趣。

# iphone - 捕捉 iPhone 导航栏标题的触摸？

> ID：928636
> 
> 赞同：1
> 
> 时间：2009-05-30T00:19:36.033
> 
> 标签：iphone, cocoa-touch, user-interface, uinavigationbar

当用户在基于标准导航的 iPhone 应用程序中触摸导航栏 TITLE 时，是否有一种机制来捕获？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T01:14:41.477

它是 UIResponder 的子类，可以覆盖您需要的任何方法

# vbscript - PowerDesigner - 通过 VBScript 将 TriggerTemplate 分配给触发器？

> ID：928637
> 
> 赞同：0
> 
> 时间：2009-05-30T00:19:42.760
> 
> 标签：vbscript, sybase, datamodel, powerdesigner

在 PowerDesigner v12 中，如何通过使用 VBScript 将 TriggerTemplate 分配给缺少定义的触发器？

我们现在有一个脚本，它可以遍历触发器并显示触发器模板（如果有的话），但是所有为这些触发器分配模板的尝试都失败了。

任何见解将不胜感激！

有权力的人可以编辑这个并添加“powerdesigner”作为标签吗？我做不到。

谢谢，卡尔文

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-30T05:45:58.353

我可能已经找到了答案，但我想获得其他意见。

虽然我无法获得对作为 DBMS 一部分的 TriggerTemplates 的引用，但模型本身可以拥有自己的 TriggerTemplates。可以根据需要引用这些基于模型的模板并将其分配给触发器。

我的想法是在模型中实际创建 DBMS 模板的副本，并使用它们来代替。

想法？

# git - 如何告诉 git 始终为特定文件的冲突合并选择我的本地版本？

> ID：928646
> 
> 赞同：107
> 
> 时间：2009-05-30T00:29:53.597
> 
> 标签：git, git-merge

假设我正在通过 git 存储库与某人合作，并且有一个特定的文件我不想接受任何外部更改。

有什么方法可以让我设置我的本地存储库，以免每次我 git pull 时都抱怨合并冲突？合并此文件时，我想始终选择我的本地版本。

* * *

## 回答 #1

> 赞同：145
> 
> 时间：2009-05-30T20:12:53.687

在配置文件的特定实例上，我同意[Ron 的回答](https://stackoverflow.com/questions/928646/how-do-i-tell-git-to-always-select-my-local-version-for-conflicted-merges-on-a-sp/928771#928771)：
配置应该是您工作区的“私有”（因此“忽略”，如“在`.gitignore`文件中声明”）。
您可能有一个带有**标记化值的配置文件***模板*，以及一个将该文件转换为私有（且被忽略）的配置文件的脚本。**`config.template`**

 *** * *

但是，该特定评论并未回答更广泛更一般的问题，即您的问题（！）：

> **如何告诉 git 始终为特定文件的冲突合并选择我的本地版本？**（对于任何文件或文件组）

这种合并是“复制合并”，只要有冲突，您总是会复制“我们的”或“他们的”版本的文件。

> （正如[Brian Vandenberg](https://stackoverflow.com/users/549246/brian-vandenberg)[在评论](https://stackoverflow.com/questions/928646/how-do-i-tell-git-to-always-select-my-local-version-for-conflicted-merges-on-a-s/930495?noredirect=1#comment37608553_930495)中指出的那样，**' `ours`' 和 ' `theirs`' 在这里用于合并**。
> 它们被*反转*用于**变基**：请参阅“ [`Why is the meaning of “ours” and “theirs” reversed with git-svn`](https://stackoverflow.com/a/2960751/6309)”，它使用变基，“ [`git rebase`，跟踪“本地”和“远程”](https://stackoverflow.com/a/3052118/6309) “ )

对于“一个文件”（通常是一个文件，而不是“配置”文件，因为它是一个不好的例子），您可以使用通过合并调用的自定义脚本来实现。
Git 将调用该脚本，因为您将定义一个[**gitattributes**值](http://git-scm.com/docs/gitattributes)，该值定义了一个**自定义合并驱动程序**。

在这种情况下，“自定义合并驱动程序”是一个非常简单的脚本，基本上将保持当前版本不变，因此允许您始终选择本地版本。

IE.，正如[Ciro Santilli所](https://stackoverflow.com/users/895245/ciro-santilli-%E6%96%B0%E7%96%86%E6%94%B9%E9%80%A0%E4%B8%AD%E5%BF%83%E6%B3%95%E8%BD%AE%E5%8A%9F%E5%85%AD%E5%9B%9B%E4%BA%8B%E4%BB%B6)[指出](https://stackoverflow.com/questions/928646/how-do-i-tell-git-to-always-select-my-local-version-for-conflicted-merges-on-a-s/59503455#comment35748788_928646)的：

```
echo 'path/to/file merge=ours' >> .gitattributes
git config --global merge.ours.driver true 
```

* * *

让我们在一个简单的场景中测试它，在 Windows 上使用 msysgit 1.6.3，在一个 DOS 会话中：

```
cd f:\prog\git\test
mkdir copyMerge\dirWithConflicts
mkdir copyMerge\dirWithCopyMerge
cd copyMerge
git init
Initialized empty Git repository in F:/prog/git/test/copyMerge/.git/ 
```

现在，让我们创建两个文件，它们都会有冲突，但会以不同的方式合并。

```
echo a > dirWithConflicts\a.txt
echo b > dirWithCopyMerge\b.txt
git add -A
git commit -m "first commit with 2 directories and 2 files"
[master (root-commit) 0adaf8e] first commit with 2 directories and 2 files 
```

我们将在两个不同的 git 分支中的这两个文件的内容中引入“冲突”：

```
git checkout -b myBranch
Switched to a new branch 'myBranch'
echo myLineForA >> dirWithConflicts\a.txt
echo myLineForB >> dirWithCopyMerge\b.txt
git add -A
git commit -m "add modification in myBranch"
[myBranch 97eac61] add modification in myBranch

git checkout master
Switched to branch 'master'
git checkout -b hisBranch
Switched to a new branch 'hisBranch'
echo hisLineForA >> dirWithConflicts\a.txt
echo hisLineForB >> dirWithCopyMerge\b.txt
git add -A
git commit -m "add modification in hisBranch"
[hisBranch 658c31c] add modification in hisBranch 
```

现在，让我们尝试将“hisBranch”与“myBranch”合并：

*   手动解决冲突合并
*   *除了*`dirWithCopyMerge\b.txt`我总是想保留*我*的`b.txt`.

由于合并发生在 ' `MyBranch`' 中，我们将切换回它，并添加`gitattributes`将自定义合并行为的 ' ' 指令。

```
git checkout myBranch
Switched to branch 'myBranch'
echo b.txt merge=keepMine > dirWithCopyMerge\.gitattributes
git config merge.keepMine.name "always keep mine during merge"
git config merge.keepMine.driver "keepMine.sh %O %A %B"
git add -A
git commit -m "prepare myBranch with .gitattributes merge strategy"
[myBranch ec202aa] prepare myBranch with .gitattributes merge strategy 
```

我们`.gitattributes`在目录中定义了一个文件`dirWithCopyMerge`（仅在将发生合并的分支中定义：）`myBranch`，并且我们有一个`.git\config`现在包含合并驱动程序的文件。

```
[merge "keepMine"]
        name = always keep mine during merge
        driver = keepMine.sh %O %A %B 
```

如果您还没有定义keepMine.sh，并且无论如何启动合并，这就是您得到的。

```
git merge hisBranch
sh: keepMine.sh: command not found
fatal: Failed to execute internal merge
git st
# On branch myBranch
# Changed but not updated:
#   (use "git add <file>..." to update what will be committed)
#   (use "git checkout -- <file>..." to discard changes in working directory)
#
#       modified:   dirWithConflicts/a.txt
#
no changes added to commit (use "git add" and/or "git commit -a")

type dirWithConflicts\a.txt
a
<<<<<<< HEAD:dirWithConflicts/a.txt
myLineForA
=======
hisLineForA
>>>>>>> hisBranch:dirWithConflicts/a.txt 
```

那也行：

*   `a.txt`准备好被合并并且有冲突
*   `b.txt`仍然保持不变，因为合并驱动程序应该处理它（由于`.gitattributes`其目录中文件中的指令）。

`keepMine.sh`在你的任何地方定义一个`%PATH%`（或`$PATH`为我们的 Unix 朋友。我当然都做了：我在 VirtualBox 会话中有一个 Ubuntu 会话）

正如[lrkwz所](https://stackoverflow.com/users/509565/lrkwz)[评论](https://stackoverflow.com/questions/928646/how-do-i-tell-git-to-always-select-my-local-version-for-conflicted-merges-on-a-s/930495#comment81730938_930495)的，并在[自定义 Git-Git 属性的“](https://git-scm.com/book/en/v2/Customizing-Git-Git-Attributes)[合并策略](https://git-scm.com/book/en/v2/Customizing-Git-Git-Attributes#_merge_strategies)”部分中描述，您可以用 shell 命令替换 shell 脚本。`true`

```
git config merge.keepMine.driver true 
```

但在一般情况下，您可以定义一个脚本文件：

保持矿井.sh

```
# I want to keep MY version when there is a conflict
# Nothing to do: %A (the second parameter) already contains my version
# Just indicate the merge has been successfully "resolved" with the exit status
exit 0 
```

（那是一个简单的合并驱动程序；）（在这种情况下甚至更简单，使用`true`）
（如果您想保留另一个版本，只需在该`exit 0`行之前添加：
`cp -f $3 $2`。
就是这样。您合并驱动程序将远离保持来自另一个版本的版本分支，覆盖任何本地更改）

现在，让我们从头开始重试合并：

```
git reset --hard
HEAD is now at ec202aa prepare myBranch with .gitattributes merge strategy

git merge hisBranch
Auto-merging dirWithConflicts/a.txt
CONFLICT (content): Merge conflict in dirWithConflicts/a.txt
Auto-merging dirWithCopyMerge/b.txt
Automatic merge failed; fix conflicts and then commit the result. 
```

合并失败......**仅适用于 a.txt**。
编辑 a.txt 并从 'hisBranch' 中保留该行，然后：

```
git add -A
git commit -m "resolve a.txt by accepting hisBranch version"
[myBranch 77bc81f] resolve a.txt by accepting hisBranch version 
```

让我们检查一下在此合并期间是否保留了 b.txt

```
type dirWithCopyMerge\b.txt
b
myLineForB 
```

最后一次提交确实代表了*完全*合并：

```
git show -v 77bc81f5e
commit 77bc81f5ed585f90fc1ca5e2e1ddef24a6913a1d
Merge: ec202aa 658c31c
git merge hisBranch
Already up-to-date. 
```

（以 Merge 开头的行确实证明了这一点）

* * *

考虑您可以定义、组合和/或覆盖合并驱动程序，Git 将：

*   检查`<dir>/.gitattributes`（与相关路径位于同一目录中）：将优先`.gitattributes`于目录中的另一个
*   然后它检查`.gitattributes`（在父目录中），如果尚未设置，将只设置指令
*   最后它检查`$GIT_DIR/info/attributes`。此文件用于覆盖树内设置。它将覆盖`<dir>/.gitattributes`指令。

通过“组合”，我的意思是“聚合”多个合并驱动程序。
[Nick Green](https://stackoverflow.com/users/639033/nickgreen)[在评论](https://stackoverflow.com/questions/928646/how-do-i-tell-git-to-always-select-my-local-version-for-conflicted-merges-on-a-s#comment54034973_930495)中尝试实际组合合并驱动程序：请参阅“ [Merge pom's via python git driver](https://gist.github.com/nickgr6/a6837b0c01a4f230bc26) ”。
但是，正如[他在另一个问题](https://stackoverflow.com/q/33412003/6309)中提到的那样，它仅在发生冲突的情况下才有效（两个分支中的同时修改）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2019-12-27T16:27:51.610

正如@ciro-santilli 评论的那样，使用`.gitattributes`设置的简单方法是：

```
path/to/file merge=ours 
```

并通过以下方式启用此策略：

```
git config --global merge.ours.driver true 
```

*（我将其添加为答案以使其更加可见，但使其成为社区 Wiki，以免自己试图超越用户的信用。请在此处的 Q 下投票给他的评论以表扬他！）*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-17T23:07:28.173

我们有多个我们永远不想覆盖的配置文件。但是 .gitignore 和 .gitattributes 在我们的情况下不起作用。我们的解决方案是将配置文件存储在 configs 分支中。然后，允许在 git 合并期间更改文件，但在合并之后立即使用“git checkout branch --”。每次合并后从 configs 分支复制我们的配置文件。 [详细的stackoverflow答案在这里](https://stackoverflow.com/questions/40026194/how-can-i-merge-in-git-without-changing-config-files-in-master/40096943#40096943)

# java - 如何测试一个 intellij 插件

> ID：928648
> 
> 赞同：11
> 
> 时间：2009-05-30T00:31:50.037
> 
> 标签：java, testing, intellij-idea, intellij-plugin

Intellij 插件开发的文档很少。如果您编写过任何 Intellij 插件，您是如何为插件编写测试的？感谢任何指向文档或源代码的指针。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-04-15T07:00:13.147

这是有关该主题的一些很好的文档：[https ://confluence.jetbrains.com/display/IDEADEV/Testing+IntelliJ+IDEA+Plugins](https://confluence.jetbrains.com/display/IDEADEV/Testing+IntelliJ+IDEA+Plugins)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-10-26T16:38:15.493

来自社区版的插件（[在 github 上](https://github.com/JetBrains/intellij-community/tree/master/plugins)提供源代码）包含大量测试作为示例。

# sql - 在 SQL 数据库中进行 10,000 次插入的最佳方法？

> ID：928649
> 
> 赞同：0
> 
> 时间：2009-05-30T00:35:39.310
> 
> 标签：sql, notifications

每当我将媒体上传到我的网站时会发生什么；每个人都会收到通知。每个人都可以单击一个框来删除它，它将永远从他们的消息队列中消失。

如果我的网站上有 10,000 人，我将如何将其添加到每个人的消息队列中？我可以想象这需要很多时间，所以我会选择像文件系统日志这样的东西吗？标记我需要通知人们，数据然后是我当前的位置。然后每插入 100 次左右更新我的位置？我需要在我的观察者列表上进行 PK，所以如果有人在其中注册，我的订单不会被破坏，因为我将通过 PK 进行排序？

这是群发通知系统的最佳解决方案吗？

-编辑-

该站点是用户创建的内容站点。管理员可以发送全球消息，受欢迎的人可能有成千上万的订阅者。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-30T01:25:15.823

如果将 10000 插入到将收件人链接到消息的狭窄多对多表中的`(recipientid, messageid, status)`速度很慢，我预计您的设计会遇到更大的问题。

这是我通常不会担心批处理或人们在后期操作中间订阅的操作 - 基本上：

假设`@publisherid`已知，`@msg`已知在 SQL Server 上：

```
BEGIN TRANSACTION

INSERT INTO msgs (publisherid, msg)
VALUES(@publisherid, @msg)
SET @messageid = SCOPE_IDENTITY()

INSERT INTO msqqueue (recipientid, messageid, status)
SELECT subscriberid, @messageid, 0 -- unread
FROM subscribers
WHERE subscribers.publisherid = @publisherid

COMMIT TRANSACTION 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T06:40:00.833

我想说让数据库来处理它有能力和设计做的事情。插入和管理数据。不要尝试在代码中执行，只需编写 SQL 以一次性插入数据。10000 行对于所有真实数据库来说都是骗人的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-30T00:43:33.397

也许只是为每个用户记录他们看到了哪些通知——所以要显示给用户的通知集是在他们的“earliest_notification”范围之前创建的（当他们注册时，或者一周前......）减去他们已经确认的通知. 这样一来，您将延迟插入任何内容，直到它立即成为单个用户 - 另外，如果您只向用户显示不到一周的消息，您可以清除一周或更长时间的 read-this-notification 标志。

（我以前工作的 DBA 的性能优化提示：“业务流程是最容易改变的东西，先看看它们”）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-30T00:45:15.517

恕我直言，插入记录可能不是解决此问题的最有效方法。您是否可以使用客户端 cookie 来存储用户是否删除了通知，或者即使他们清除了 cookie，您也必须跟踪这一点？如果您上传新视频，应用程序只需将 cookie 与新视频记录 ID 进行比较，并根据 cookie 中存储的内容决定显示或隐藏通知。这将为您节省大量的数据库插入，并将大部分繁重的工作交给客户端。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-30T01:23:47.887

如果您使用的是 Postgres，则可以使用 COPY 命令，这是所有方法中最快的方法：

```
COPY tablename (col1, col2, col3) FROM '/path/to/tabfile'; 
```

其中*tabfile*是一个 TAB 分隔的文件，有很多条目。但是，如果有一些 UNIQUE 约束并且文件中有重复项，这将失败。

# .net - 为什么这个代码访问安全示例被破坏了？

> ID：928651
> 
> 赞同：0
> 
> 时间：2009-05-30T00:37:02.147
> 
> 标签：.net, code-access-security

我知道 CAS[的价值有限](https://stackoverflow.com/questions/782020/is-it-necessary-to-learn-about-code-access-security-cas)，但我还是想了解一下。

我不明白我看到的行为：基本默认 CAS 在我相当正常的环境中似乎根本不起作用。

采取这个示例类：

```
using System;
using System.Security;
using System.Security.Permissions;

namespace CASNotWorkingExample
{
    class Program
    {
        static void Main(string[] args)
        {
            FileIOPermission perm = new FileIOPermission(PermissionState.Unrestricted);

            if (SecurityManager.IsGranted(perm))
                Console.WriteLine("granted");
            else
                Console.WriteLine("denied");

            Console.ReadKey();
        }
    }

} 
```

我构建了这个并将 exe`CASNotWorkingExample.exe`放在另一台机器（IP 为 192.168.1.101）上的文件共享“不受信任”上。然后我使用 非管理命令提示符运行它`\\192.168.1.101\untrusted\CASNotWorkingExample.exe`，期望它返回“拒绝”。它不是; 它返回“授予”。

Windows 知道它正在处理一个安全性有问题的远程 EXE。当我从开始菜单运行...对话框运行相同的命令时，我收到通常的安全警告“无法验证发布者。你确定等等等等”。因此，不会以某种方式错误地认为 exe 正在本地计算机上运行并错误分配了区域。

此外，当我使用 .NET 2.0 配置工具查看相同的 exe 时（右键单击“运行时安全策略”，选择“评估程序集...”），我看到 .NET 仅将 Internet_Zone 权限分配给程序集. 这些权限不包括 FileIOPermission（独立存储是它自己的权限）。

[替代文字 http://img5.imageshack.us/img5/2256/casperms.jpg](http://img5.imageshack.us/img5/2256/casperms.jpg)

可能对其他人有用但到目前为止还没有对我有用的数据：

*   我在阅读MCTS 70-536 考试的[MS Press 书籍](https://rads.stackoverflow.com/amzn/click/com/0735626197)时遇到了这个问题。第 11 章是关于 CAS 的；第 1 课 / 示例 1 对我来说失败了，就像上面描述的那样。你在这里看到的是一个精简的变体。
*   我已经验证了像这样的 EXE 实际上可以写入磁盘，即 IsGranted 检查可能是正确的。
*   两台机器运行 Vista SP1 和 WinXP。无论哪个是客户端，哪个是文件服务器，行为都是相同的，所以这不是 Vista 的事情。
*   当作为标准非特权用户和作为管理员运行时，行为是相同的。
*   不在 AD 域中运行。
*   客户端和文件服务器上的用户名和密码相同，因此我可以访问文件而无需使用`net use`提供凭据。

我敢肯定这将是那些“arrrgh”时刻之一......我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T00:56:55.490

我不是 CAS 专家，但我怀疑这可能是由于[.NET 3.5 SP1](http://blogs.msdn.com/vancem/archive/2008/08/13/net-framework-3-5-sp1-allows-managed-code-to-be-launched-from-a-network-share.aspx)中的更改允许来自网络共享的代码作为完全信任运行。

编辑：[Brad Abrams 声明](http://blogs.msdn.com/brada/archive/2008/08/13/net-framework-3-5-sp1-allows-managed-code-to-be-launched-from-a-network-share.aspx)不需要重新编译/目标来利用这一点。我假设它反过来也一样——如果你的机器上有 3.5 SP1，那么以 2.0 为目标不会给你带来旧的行为。

> 无需以任何方式重新编译或更改现有应用程序即可利用这一点。您当前的 2.0 应用程序将正常工作，您不必针对 3.5 中的任何新内容。

我想只有 2.0 FX 的全新 (VM) 安装可能能够根除此问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-18T20:42:40.550

更改的工作方式是在启动托管 exe 时有一个新的证据。当直接从 win32 CreateProcess API 启动 exe 时，托管 exe 将获得完全信任。

当然，.net 配置工具不会启动 exe，只是检查它。这意味着证据不同并影响分配给它的代码组。这反过来会影响权限。

相当混乱。

更多信息可以在这里找到：

[msdn 社交](http://social.msdn.microsoft.com/Forums/en/clr/thread/5f5f0925-64fc-4fc8-9be3-d077d27d2554)

[布拉德艾布拉姆斯博客](http://blogs.msdn.com/brada/archive/2007/10/26/adhoc-poll-allowing-net-exes-to-run-off-a-network-share.aspx)

# unit-testing - 如何减少花在测试上的时间？

> ID：928652
> 
> 赞同：5
> 
> 时间：2009-05-30T00:38:01.363
> 
> 标签：unit-testing, testing, tdd, functional-testing

我刚刚回顾了最近即将完成的项目，发现了一个非常严重的问题。我将大部分时间花在测试代码上，重现“可能”导致代码错误的不同情况。

您有什么想法或经验可以分享，如何减少测试时间，从而使开发更加顺利？

我尝试对我的所有代码都遵循测试驱动的概念，但我发现实现这一点真的很难，真的需要这里的资深人士的帮助。

谢谢

回复：全部

感谢上面的答案，最初我的问题是如何减少一般测试的时间，但现在，问题归结为如何编写有效的自动化测试代码。

我将尝试提高我如何编写测试服的技能以减少这部分时间。

但是，我仍然很纠结如何减少重现错误所花费的时间，例如，一个标准的博客项目很容易重现可能导致错误的情况，但复杂的定制内部系统可能“永远”无法测试轻松完成，值得吗？您对如何在此类项目上构建测试计划有任何想法吗？

感谢您的进一步回答。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-30T01:34:57.677

测试驱动设计与测试无关（质量保证）。从一开始它的名字就很糟糕。

它是关于程序行为的机器可运行假设和规范，由程序员在编程期间完成，以确保假设是明确的。

由于这些任务必须在产品生命周期的某个时间点完成，这只是工作的转变。它的效率更高或更低是另一个时间的争论。

你所说的我不会称之为测试。拥有强大的 TDD 确实意味着不必过度依赖测试阶段来解决在测试构建之前很久就会被捕获的错误（因为在非 TDD 中有经验丰富的程序员具有良好的规范和响应式利益相关者）环境）。

如果您认为前期测试（可运行规范）是一个严重的问题，我想这归结为开发的相关阶段预计会花费多少时间和金钱？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-09T13:17:41.393

我想我明白。在开发人员测试级别之上，您有客户测试级别，听起来，在那个级别，您会发现很多错误。

对于你发现的每一个错误，你必须停下来，摘下你的测试帽，戴上你的复制帽，并找出一个精确的复制策略。然后你必须记录错误，也许把它放在错误跟踪系统中。然后你必须戴上测试帽。与此同时，您已经丢失了您正在处理的任何设置，并且忘记了您在遵循的任何测试计划中所处的位置。

现在——如果这不是必须发生的——如果你有很少的错误——你可以直接通过测试，对吧？

令人怀疑的是，GUI 驾驶测试自动化是否有助于解决这个问题。您将花费大量时间记录和维护测试，而这些回归测试将花费大量时间来收回投资。最初，使用 GUI 驱动的面向客户的测试会慢得多。

所以（我认为）真正有帮助的是开发活动带来的更高的/initial/代码质量。微测试——在最初的意义上也称为开发人员测试或测试驱动开发——可能真的有帮助。另一件可以帮助的事情是结对编程。

假设您不能找其他人配对，我会花一个小时查看您的错误跟踪系统。我会查看过去的 100 个缺陷，并尝试将它们归类为根本原因。“培训问题”不是原因，但“因一个错误而关闭”可能是原因。

将它们分类和计数后，将它们放入电子表格并排序。最常发生的根本原因是您首先预防的根本原因。如果您真的想变得花哨，请将根本原因乘以某个数字，即它引起的疼痛量。（例如：如果在这 100 个错误中，您的菜单上有 30 个拼写错误，很容易修复，还有 10 个难以重现的 javascript 错误，您可能需要先修复 javascript 问题。）

这假设您可以对每个根本原因应用一些神奇的“修复”，但值得一试。例如： IE6 中的透明图标可能是因为 IE6 无法轻松处理 .png 文件。因此，有一个版本控制触发器在签入时拒绝 .gif 并且问题已得到解决。

我希望这会有所帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-09-18T15:04:15.963

你写了：

> “感谢上面的答案，最初我的问题是如何减少一般测试的时间，但现在，问题在于如何编写高效的自动化测试代码。”

一种已在多项实证研究中证明可以非常有效地最大限度地提高测试效率的方法是组合测试。在这种方法中，测试人员将确定应该测试哪些类型的事物（并将其输入到一个简单的工具中），并且该工具将确定如何测试应用程序。具体来说，该工具将生成测试用例，这些测试用例指定应该在哪个测试脚本中执行哪些测试条件组合以及每个测试脚本应该执行的顺序。

例如，在[我与 Rick Kuhn 博士、Raghu Kacker 博士和 Jeff Lei 博士共同撰写的 2009 年 8 月 IEEE 计算机文章](http://csrc.nist.gov/groups/SNS/acts/documents/kuhn-kacker-lei-hunter09.pdf)中，我们重点介绍了我领导的 10 个项目研究，其中一组测试人员使用了他们的标准测试设计方法和第二组测试人员，测试相同的应用程序，使用组合测试用例生成器为他们识别测试用例。使用组合测试用例生成器的团队平均每个测试人员每小时发现的缺陷数量是其两倍以上。这是效率的有力证据。此外，组合测试人员发现的缺陷总体上增加了 13%。这是质量/彻底性的有力证据。

这些结果并不罕见。有关此方法的更多信息，[请访问 http://www.combinatorialtesting.com/clear-introductions-1以及](http://www.combinatorialtesting.com/clear-introductions-1)[此处](http://hexawise.com/Hexawise_Introduction.pdf/)的工具概述。它包含屏幕截图和解释我们的工具如何通过识别最大化覆盖率的测试子集来提高测试效率。

我们的 Hexawise 测试用例生成器的免费版本也可以在[www.hexawise.com/users/new找到](http://www.hexawise.com/users/new)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-30T00:57:44.290

Subversion 团队通过自动化整个过程开发了一些[非常好的测试例程。](http://subversion.tigris.org/hacking.html#write-test-cases-first)

我自己已经开始使用这个过程，例如在实现新功能*之前编写测试。*它工作得很好，并在整个编程过程中生成一致的测试。

SQLite 也有一个不错的测试系统，其中包含一些关于它是如何完成的[非常好的文档。](http://www.sqlite.org/testing.html)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-30T01:32:53.187

根据我在测试驱动开发方面的经验，在您编写完测试之后，或者至少在您编写了基本测试用例之后，节省的时间就来了。这里的关键是您实际上必须编写我们的自动化测试。您提出问题的方式让我相信您实际上并没有编写自动化测试。编写完测试后，您可以轻松地稍后返回并更新测试以覆盖他们以前没有发现的错误（以获得更好的回归测试），并且您可以轻松且相对快速地重构您的代码，并且放心，代码将在您对其进行重大更改后仍可按预期工作。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-30T17:57:17.660

首先，很高兴你认识到你需要帮助——现在去找一些:)

这个想法是使用测试来帮助您思考代码应该做什么，它们是您设计时间的一部分。

您还应该考虑代码的总拥有成本。一个错误进入生产环境而不是首先修复的成本是多少？如果您在银行，弄错数字是否有严重影响？有时，正确的东西只是需要时间。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-30T00:52:30.307

如果您正在*高效*地进行测试，那么花费大量时间进行测试本身并没有错。请记住，测试驱动开发意味着首先编写（大部分是自动化的）测试（如果您编写完整的测试套件，这可能需要很长时间）。运行测试应该不会花费太多时间。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-30T01:24:36.543

听起来您的问题是您没有进行自动测试。使用自动化单元和集成测试可以大大减少您花费在测试上的时间。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-30T01:40:58.070

任何大型项目最困难的事情之一就是设计底层架构和 API。所有这些都暴露在单元测试级别。如果您首先编写测试，那么设计的这方面会在您编写测试时发生，而不是程序逻辑。使代码可测试的额外努力使这更加复杂。完成测试后，程序逻辑通常非常明显。

话虽如此，似乎有一些有趣的[自动](http://research.microsoft.com/en-us/projects/Pex/)测试构建器即将出现。

# php - 如何混合使用 php 和 C++ 进行用户身份验证？

> ID：928653
> 
> 赞同：-1
> 
> 时间：2009-05-30T00:38:23.190
> 
> 标签：php, c++

您好，我正在制作一个程序来获取我网站上用户的姓名，并将该日志用于我的程序，因此只有注册的人才能登录。我该怎么做呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-30T00:46:44.543

在您知道自己将要做什么之前，您似乎过于关注要使用的工具的选择。我的建议是：

1.  决定**你**想做什么。如果您要根据某种用户列表对登录进行身份验证，请准确说明您想要做什么。

2.  一旦你知道你想做什么，就决定**如何**去做。查看其他解决方案，例如 HTTP 基本身份验证、使用 cookie 或其他方法，然后确定哪种方法最适合您的需求。

3.  一旦您对如何实施解决方案有了透彻的了解，您就可以决定要使用哪些**工具**。同样，对其他现有解决方案的评估将有助于您做出此决定。

4.  **按照 (2) 中的计划实施**您的解决方案。

# asp.net-mvc - 基于角色的内容 asp.net mvc

> ID：928654
> 
> 赞同：5
> 
> 时间：2009-05-30T00:40:10.080
> 
> 标签：asp.net-mvc

我希望在 ASP.NET MVC 中根据活动用户的给定角色显示内容。

比较老式的方式，使用 WebForms：

```
protected void Page_Load(Object sender, EventArgs e)
{
   if(User.IsInRole("Administrator")) {
       adminLink.Visible = true;
   }
} 
```

现在在使用 ASP.NET MVC 时我将如何继续编写它？从我的角度来看，将它直接放在视图文件中是错误的，并且为每个视图分配一个变量也不会很漂亮。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-30T08:31:26.243

创建 Html 助手并检查其代码中的当前用户角色：

```
public static class Html
{
    public static string Admin(this HtmlHelper html)
    {
        var user = html.ViewContext.HttpContext.User;

        if (!user.IsInRole("Administrator")) {
            // display nothing
            return String.Empty;

            // or maybe another link ?
        }

        var a = new TagBuilder("a");
        a["href"] = "#";
        a.SetInnerText("Admin");

        var div = new TagBuilder("div") {
            InnerHtml = a.ToString(TagRenderMode.Normal);
        }

        return div.ToString(TagRenderMode.Normal);
    }
} 
```

**更新：**

或者为股票 Html 助手创建包装器。ActionLink 示例（此 HtmlHelper htmlHelper，字符串 linkText，字符串 actionName，字符串 controllerName）：

```
public static class Html
{
    public static string RoleActionLink(this HtmlHelper html, string role, string linkText, string actionName, string controllerName)
    {
        return html.ViewContext.HttpContext.User.IsInRole(role)
            ? html.ActionLink(linkText, actionName, controllerName)
            : String.Empty;
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-30T01:16:45.000

不，您将把它放在视图文件中，就像实际上一样：

```
<% If (User.IsInRole("Administrator")) { %>
<div>Admin text</div>
<% } %> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-11-27T20:13:18.943

这对我有用：

```
 <% MembershipUser mu = Membership.GetUser();
                    if (mu != null)
                        if (Roles.IsUserInRole(mu.UserName, "Administrator"))
                        {
                     %>
                <li class="paddingleftThree"><%= Html.ActionLink("User Administration", "GetUsers", "Account")%></li> <%} %> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-29T14:18:20.910

ASP.NET MVC 4中建议的关注点分离方法[如何根据角色提供不同的 HTML？](https://stackoverflow.com/questions/19194258/asp-net-mvc-4-how-do-you-serve-different-html-based-on-role)在我看来是一个更好的方法。

就我个人而言，我尽可能避免在代码中进行 IsInRole 检查，并将其留给声明性方式来尽可能地实现基于角色的限制。这确保了代码随着时间的推移保持可维护性。我不确定这是对还是错，但对我来说效果很好。

# iphone - Windows 上的 iPhone SDK（替代解决方案）

> ID：928656
> 
> 赞同：31
> 
> 时间：2009-05-30T00:42:44.663
> 
> 标签：iphone, windows, macos, incompatibility

我知道没有适用于 Windows 的官方 SDK，这很烦人。除了以某种方式在 VMware 中运行 Mac OS 之外，还有什么方法可以在 Windows 计算机上开发应用程序？我知道你可以用 Xcode 做到这一点，但这也只适用于 Mac OS X。谷歌搜索完全没有发现任何东西。

如果我不能使用 SDK 或 Xcode，有什么方法可以检查语法或其他东西，然后在记事本中编写代码并使用正确的扩展名保存它？我不知道我是否能够做到这一点，可能是因为我什至从未尝试过 SDK，而且如果不购买 Mac，我可能永远也不会。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-05-30T00:55:54.090

我在购买[Mac Mini](http://en.wikipedia.org/wiki/Mac_Mini)之前研究了这一点。基本上，答案是否定的。您几乎必须购买 Leopard Mac 才能为在非越狱 iPhone 上运行的应用程序进行 iPhone SDK 开发。

不是说100%不可能，而是99.99%不合理。就像用脚换灯泡一样。

您不仅必须在[Xcode](http://en.wikipedia.org/wiki/Xcode)中，而且您必须将证书放入 Keychain 管理器，才能让 Xcode 和 iPhone 进行通信。而且你必须在Xcode中设置各种设置恰到好处。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-06-22T08:16:40.000

[您可以使用PhoneGap](http://phonegap.com/)或[Appcelerators Titanium Mobile](http://www.appcelerator.com/products/titanium-mobile-application-development/)轻松构建应用程序。

这两者本质上都充当 WebKit 包装器，因此您可以使用 HTML/CSS/JavaScript 构建应用程序。这也是一个非常便携的解决方案，但是您可以制作的东西有些限制 - 即，没有密集渲染或任何东西。这真的完全取决于你想要做什么。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-30T00:51:06.737

你可以像 Cydia 的 saurik 一样，在 PC 上编写代码，然后在越狱后*在 iPhone 上*构建代码（从技术上讲，它是 Mac！）。但是，您没有获得 Interface Builder，因此您基本上是在代码中手动创建 UI。在没有 Mac 的情况下实际提交您的应用程序也非常困难。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-30T01:27:32.887

不，您必须拥有某种英特尔 Mac。我去了百思买，并使用他们的 18 个月无息促销以 1499 美元的价格购买了一台配备 4G RAM 的 24 英寸 iMac。我每月至少支付 16 美元。只要我在 18 个月内付清全部费用 - 不这是我进入 iPhone 开发的唯一途径。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-11-17T23:17:00.250

如果您想使用 C/C++ 进行开发，还有另一种解决方案。 [http://www.DragonFireSDK.com](http://www.DragonFireSDK.com)将允许您在 Windows 上的 Visual Studio 中构建 iPhone 应用程序。肯定值得一看。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-30T21:44:04.173

从技术上讲，您可以使用 .NET 语言编写代码并使用 Mono 框架 ( [http://www.mono-project.com/](http://www.mono-project.com/) ) 在 iPhone 上运行它。我从未见过有人从头开始这样做，但是编写 Unity 游戏开发平台 ( [http://unity3d.com/](http://unity3d.com/) ) 的人使用它来使他们的游戏与 iPhone 兼容。游戏本身是用 .NET 编写的，然后他们提供了一个带有 Mono 框架的 iPhone shell，允许一切在 iPhone 上运行。我不知道他们是否已将他们对 Mono 的所有修改贡献回开源存储库，但如果您认真考虑在 Mac 环境之外编写 iPhone 应用程序，那么这可能是可能的。

就是说，我认为您可以花费数周时间来使其正常工作，而最好还是投资Mac :-)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-21T11:28:19.583

这实际上取决于您对时间的重视程度。正如其他海报所提到的，有几种方法可以在没有 Mac 的情况下构建 iPhone 应用程序。但是，您正在经历严重的障碍，与使用适当的开发链相比，这将更加困难并且需要更长的时间。

您可以在 eBay 上以几百美元的价格购买二手[Mac Mini 。](http://en.wikipedia.org/wiki/Mac_Mini)如果您认真地进行 iPhone 开发，您将很快在节省的时间内完成这项工作。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-07-03T01:45:35.320

没有人提出[hackintosh](http://www.hackintosh.com/)。如果您有支持的硬件，它可能是最好的选择。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-08-07T05:43:42.810

有两种方法：

1.  如果您有耐心（需要 Ubuntu corral pc 和 Android SDK 以及一些繁重的终端工作来完成所有设置）。请参阅*[无需支付特权即可使用 3.0 SDK](http://www.iphone.org.hk/cgi-bin/ch/topic_show.cgi?id=9608)*。

2.  如果您不道德（需要 Mac OS X Leopard 和虚拟化，两者都只能通过高额费用或盗版获得）- 从以下链接中删除空间。htt p://iphonewo rld. codinghut.com /2009/07/using-the-3-0-sdk-without-paying-for-the-priviledge/

我自己使用 Ubuntu 方法。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-05-21T09:20:20.943

[http://maniacdev.com/2010/01/iphone-development-windows-options-available/](http://maniacdev.com/2010/01/iphone-development-windows-options-available/)

检查这个网站，他们已经展示了许多解决方案。

1.  电话间隙
2.  钛等

# c++ - “无法将 'this' 指针从 'const hand' 转换为 'hand &' 是什么意思？（C++）

> ID：928662
> 
> 赞同：4
> 
> 时间：2009-05-30T00:50:18.733
> 
> 标签：c++, reference, this

当我尝试执行此操作时发生错误

```
friend std::ostream& operator<<(std::ostream& os, const hand& obj)
{
    return obj.show(os, obj);
} 
```

其中 hand 是我创建的一个类，而 show 是

```
std::ostream& hand::show(std::ostream& os, const hand& obj)
{
    return os<<obj.display[0]<<obj.display[1]<<obj.display[2]<<obj.display[3]<<obj.display[4];
} 
```

其中 display 被声明为`char display[6]`.

有谁知道错误是什么意思？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-30T00:58:14.240

你需要制定`hand::show(...)`一个`const`方法；并且传递它 obj 引用是没有意义的——它已经将它作为 ' `this`' 指针接收。

这应该有效：

```
class hand {
public:
  std::ostream& show(std::ostream &os) const;
...
};

friend std::ostream& operator<<(std::ostream& os, const hand& obj)
{
    return obj.show(os);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-30T00:55:27.757

您需要函数本身也是 const （注意第一行末尾的“const”）：

```
std::ostream& hand::show(std::ostream& os, const hand& obj) const
{
    return os<<obj.display[0]<<obj.display[1]<<obj.display[2]<<obj.display[3]<<obj.display[4];
} 
```

# c# - C# 在运行时使用泛型创建对象

> ID：928665
> 
> 赞同：0
> 
> 时间：2009-05-30T00:51:05.987
> 
> 标签：c#, generics, runtime, activator

在以下示例中，我可以通过字符串动态创建对象；但是，我无法获得 BASE 类的公共方法。我不能将 obj 转换为 BASE，因为我不知道在设计时将使用什么泛型。在运行时这样做的任何建议都会很好。

项目 A 包含类 A{T,J> : BASE{T,J>
项目 B 包含类 B{T,J> : BASE{T,J>

项目 C 包含 Class BASE{T,J>
public virtual control{T,J> item

项目 Windows 窗体
cmdGo_Click 事件

string dll = textbox1.text //ex "ProjectA.dll"
string class = textbox2.text //ex "A`2[enuT,enuJ]"
object obj = activator.createinstancefrom(dll,class)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-30T01:09:02.440

这段代码创建了一个 BASE<int, string> 的实例：

```
Type type = typeof(BASE<,>).MakeGenericType(typeof(int), typeof(string));
object instance = Activator.CreateInstance(type); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T01:01:31.130

如果您不知道在运行时使用的类型参数，那么您也不能使用任何依赖于这些类型的操作，所以......为什么不创建一个`BASE`包含所有不依赖的操作的非泛型基类在泛型参数上，然后您可以`obj`使用该基本类型并使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-30T01:02:40.847

在*运行时*，等式的泛型部分无关紧要，因为编译器已经填补了泛型实现的空白。我相信您可以使用反射来获取基类方法，如下面的示例所示，我希望这会有所帮助。

```
MethodInfo[] baseMethods = obj.GetType().BaseType.GetMethods();
object retObj = baseMethods[0].Invoke(obj, new object[] {"paramVal1", 3, "paramVal3"}); 
```

# bash - ">/dev/null 2>&1" 是否有命令行快捷方式

> ID：928667
> 
> 赞同：24
> 
> 时间：2009-05-30T00:51:58.280
> 
> 标签：bash, shell, command, redirect, pipe

每当我不想看到程序的输出时，输入这个真的很烦人。我很想知道是否有更短的写法：

```
$ program >/dev/null 2>&1 
```

通用 shell 是最好的，但其他 shell 也会很有趣，尤其是 bash 或 dash。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-30T00:54:23.470

```
>& /dev/null 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-05-30T01:23:12.723

您可以为此编写一个函数：

```
function nullify() {
  "$@" >/dev/null 2>&1
} 
```

要使用此功能：

```
nullify program arg1 arg2 ... 
```

当然，您可以随意命名该函数。例如，它可以是单个字符。

顺便说一句，您可以使用`exec`重定向`stdout`和`stderr`临时`/dev/null`。我不知道这对你的情况是否有帮助，但我想分享它。

```
# Save stdout, stderr to file descriptors 6, 7 respectively.
exec 6>&1 7>&2
# Redirect stdout, stderr to /dev/null
exec 1>/dev/null 2>/dev/null
# Run program.
program arg1 arg2 ...
# Restore stdout, stderr.
exec 1>&6 2>&7 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-07-27T16:57:59.200

在**bash**、**zsh**和**dash 中**：

```
$ program >&- 2>&- 
```

它也可能*在*其他 shell 中工作，因为`&-`它是一个错误的文件描述符。

请注意，此解决方案会关闭文件描述符而不是将它们重定向到`/dev/null`，这可能会导致程序中止。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-30T01:22:01.790

大多数 shell 支持别名。例如，在我的 .zshrc 中，我有如下内容：

```
alias -g no='2> /dev/null > /dev/null' 
```

然后我只输入

```
program no 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-30T01:01:04.593

如果`/dev/null`输入太多，您可以（以 root 身份）执行以下操作：

```
ln -s /dev/null /n 
```

然后你可以这样做：

```
program >/n 2>&1 
```

但是，当然，如果不先设置该符号链接，您以这种方式编写的脚本将无法移植到其他系统。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-02-16T13:56:04.290

还值得注意的是，通常重定向输出并不是真正需要的。许多 Unix 和 Linux 程序接受一个“静默标志”，通常是`-n`or `-q`，它禁止任何输出并且只在成功或失败时返回一个值。

例如

```
grep foo bar.txt >/dev/null 2>&1
if [ $? -eq 0 ]; then
     do_something
fi 
```

可以改写为

```
grep -q foo bar.txt
if [ $? -eq 0 ]; then
     do_something
fi 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-08-05T20:31:56.087

编辑：基于`(:)`or`|:`的解决方案可能会导致错误，因为`:`不读取`stdin`. 尽管它可能不如关闭文件描述符那么糟糕，正如 Zaz 的回答中所建议的那样。

* * *

*   对于 bash 和 bash 兼容的 shell (zsh...)：

    ```
    $ program &>/dev/null
    OR
    $ program &> >(:) # Should actually cause error or abortion 
    ```

*   对于所有贝壳：

    ```
    $ program 2>&1 >/dev/null
    OR
    $ program 2>&1|: # Should actually cause error or abortion 
    ```

    `$ program 2>&1 > >(:)`不适用于dash，因为它拒绝操作文件替换的进程替换权。

说明：

*   `2>&1`将 stderr（文件描述符 2）重定向到 stdout（文件描述符 1）。
*   `|`是标准输出到另一个命令的标准输入的常规管道。
*   `:`是一个不做任何事情的内置 shell（它相当于`true`）。
*   `&>`将 stdout 和 stderr 输出重定向到文件。
*   `>(your-command)`是过程替代。它被替换为特殊文件的路径，例如：`/proc/self/fd/6`. 该文件用作命令的输入文件`your-command`。

* * *

注意：尝试写入已关闭文件描述符的进程将收到`EBADF`（错误文件描述符）错误，这比尝试写入`| true`. 后者会导致`EPIPE`（管道）错误，请参阅 Charles Duffy 的评论。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-08-23T11:25:34.253

[Ayman Hourieh 的解决方案](https://stackoverflow.com/a/928708/906070)适用于一次性调用过于健谈的程序。但是，如果您想要抑制输出的只有一小部分通常调用的程序，请考虑通过将以下内容添加到您的`.bashrc`文件（或等效项，如果您使用另一个 shell）来使它们静音：

```
CHATTY_PROGRAMS=(okular firefox libreoffice kwrite)
for PROGRAM in "${CHATTY_PROGRAMS[@]}"
do
    printf -v eval_str '%q() { command %q "$@" &>/dev/null; }' "$PROGRAM" "$PROGRAM"
    eval "$eval_str"
done 
```

这样，您可以继续使用它们通常的名称调用程序，但它们的 stdout 和 stderr 输出将消失在位桶中。

另请注意，某些程序允许您配置它们发出多少日志记录/调试输出。对于 KDE 应用程序，您可以运行`kdebugdialog`并有选择地或全局禁用调试输出。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-03-09T19:08:45.323

在我看来，最便携的解决方案和最佳答案将是您终端（PC）上的宏。

这样，无论您登录到哪个服务器，它都会一直存在。

如果您碰巧运行 Windows，您可以通过 AHK（谷歌搜索，它是开源的）在两行代码中获得所需的结果。这可以将任何一串键原位转换为任何其他键串。

您键入“ugly.sh >>NULL”，它会将其重写为“ugly.sh 2>&1 > /dev/null”或其他内容。

其他平台的解决方案要困难一些。AppleScript 可以粘贴到键盘按下，但不能那么容易触发。

# php - 我可以将 Code Igniter 与 Concrete5 一起使用吗？

> ID：928673
> 
> 赞同：1
> 
> 时间：2009-05-30T00:55:23.747
> 
> 标签：php, codeigniter, frameworks, content-management-system, concrete5

我正在构建一个站点，它将（显然）有一个我想用 Concrete5 驱动的前端公共部分，但它也将有一个我想用 Code Igniter 构建的成员部分。

有谁知道我该怎么做？

我想我可以将 Code Igniter 代码放入子目录中，但我会遇到任何问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-30T01:41:20.970

我不明白为什么不。

正如您所建议的那样，网站上的单独文件夹将是一种解决方案。（您可能需要调整 .htaccess 文件（如果您正在使用一个）以忽略其他 cms/framework

另一种解决方案是拥有单独的子域，例如 example.com 和 members.example.com

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-05-16T02:55:23.510

答案，因为 OP 没有发布它，是改变 .htaccess 规则：

```
RewriteBase / 
```

到：

```
RewriteBase /foo/ 
```

`foo`index.php 和 CI 所在的子目录在哪里。此 .htaccess 也应该与 CI index.php 位于同一文件夹中。奇迹般有效。也不要忘记将子目录添加到 base_url 配置设置中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T15:04:45.793

我最终使用了 Code Igniter 的子目录。我必须更改 .htaccess 文件和 apache 的 Mod_Rewrite 规则，以便 Code Igniter “漂亮” URL 正常工作。

如果我记得，我稍后会发布代码。

# .net - .NET 的最佳 AI 语言/框架是什么？

> ID：928680
> 
> 赞同：2
> 
> 时间：2009-05-30T00:59:31.400
> 
> 标签：.net, prolog, artificial-intelligence, xna-3.0

我正在构建一个包含回合制策略游戏的学术作品。我将 XNA 3 用于图形，但没有决定将什么用于 AI。

我正在考虑使用 P#，一个用于 .NET 的 Prolog 解释器，但我发现它有点差。对于游戏 AI，你有什么比 Prolog（也许是 Haskell？）或比 P# 更好的解释器更好的东西吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-30T01:23:29.510

你使用 Prolog 是因为它是声明性的吗？当我在 AI 领域工作时，我将工作分为 Prolog 和[Scheme](http://en.wikipedia.org/wiki/Scheme_programming_language)。

如果您对函数式语言（ala Scheme）而不是 OO 感兴趣，我怀疑您会收到很多关于[F#](http://research.microsoft.com/en-us/um/cambridge/projects/fsharp/)的建议。

为了回答评论中的问题，[Bigloo](http://www-sop.inria.fr/mimosa/fp/Bigloo/)似乎是 .NET 上流行的 Scheme 实现。

也就是说，我会建议 Eduardo 认真考虑他在选择框架和语言时的目标。具体来说，哪个最重要？如果您最喜欢该框架，您可能应该寻找满足您的需求并在该框架上得到良好支持的最佳语言。有时，这意味着学习一门新语言（万岁！）。

如果你比我更现实，你可能会意识到学习一门语言需要花费时间来完成你的项目。在这种情况下，您可能需要接受对 .NET 框架的更有限的支持才能获得您正在寻找的语言。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T01:30:50.057

使用一些 google-fu 找到了两个框架

[自适应智能开源 .NET 框架](http://aiframework.codeplex.com/)和 [NEO AI 框架](http://sourceforge.net/projects/softai/)

这是一堆 .net 支持的语言的列表，希望您可以使用它。 [点网驱动的语言](http://www.dotnetpowered.com/languages.aspx)

# javascript - JavaScript 背景透视库

> ID：928687
> 
> 赞同：0
> 
> 时间：2009-05-30T01:04:16.770
> 
> 标签：javascript, animation

我记得在 Ajaxian 和其他几个网站上看到过这个，但我从来没有为它添加书签，现在我再也找不到它了。这是一个 javascript 库，可让您将鼠标移动到已被分割成图层的图像上并更改视角。任何链接将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-30T01:10:16.807

你说的是视差滚动吗？

[http://webdev.stephband.info/parallax.html](http://webdev.stephband.info/parallax.html)

# css - 圆角（css 和 javascript）

> ID：928691
> 
> 赞同：0
> 
> 时间：2009-05-30T01:10:59.940
> 
> 标签：css, rounded-corners

请访问：http: [//jlecologia.com/page1c.html](http://jlecologia.com/page1c.html)查看问题

**顶框看起来不错，但在****IE6** 中有一个上下**边框**。

 ****有人能指出我做错了什么吗？

或者任何人都可以告诉我一个 javascript 圆角框，它接受不相等的边框来实现这种效果。我已经测试了一些，但它们都失败了，所以我完成了图片圆框，但我更喜欢 jQuery javascript 方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-30T02:07:27.690

看看 JQuery 的[圆角](http://www.methvin.com/jquery/jq-corner-demo.html)[插件](http://plugins.jquery.com/project/corners) 这是一个演示

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T03:11:44.643

背景图像的默认设置是让它们重复。

试试： background: transparent url(../images/roundbox-top.jpg) 0 0 no-repeat;

* * *

*评论后编辑以提供完整的解决方案：*

如果 css 中指定的高度小于字体大小，IE6 会将空 div 的高度设置为您的字体大小。

在#roundbox .top 和#roundbox .bottom 上，放置

```
font-size:0;
line-height:0; 
```

这会将 div 折叠到正确的高度。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-30T20:34:53.143

除了您对底部边框所做的更改之外，将具有“top”类的元素的字体大小设置为 7px 可以在我的 IE6 中修复它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-30T01:54:41.973

尝试使用 Firefox 中的 Web 开发人员工具栏来验证 CSS 和 HTML。我做了一个快速检查，每个都有多个错误。我怀疑，呈现差异是因为 IE 不能像 FF 那样处理格式错误的内容。特别是，即使是 CSS 文件中的小错误，也会在 IE 中滚雪球，破坏原本不错的布局。不知道IE7和IE8在这方面有没有改进。

# cocoa - 以编程方式录制声音发送到内置输出，Mac OS X

> ID：928692
> 
> 赞同：10
> 
> 时间：2009-05-30T01:12:32.090
> 
> 标签：cocoa, macos, audio, stream, core-audio

我有一个难题：

我需要找到一种方法来捕获正在通过管道传输到 Mac OS X 上的内置输出的原始音频数据。Core Audio、HAL 等。

我可以在内置输出和麦克风上“收听”，但它们似乎都没有提供正确的数据流 - 进入扬声器/内置输出的确切流（来自所有输入源的所有组合数据） .

欢迎任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T13:14:39.430

也许你应该看看杰克源代码......

[http://sourceforge.net/projects/jackosx](http://sourceforge.net/projects/jackosx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T01:24:14.267

您是否需要从您的程序中访问该流，或者您只想从中提取音频？在第二种情况下，快速的谷歌搜索出现了[http://www.ambrosiasw.com/utilities/wiretap/](http://www.ambrosiasw.com/utilities/wiretap/)和[http://www.rogueamoeba.com/audiohijackpro/](http://www.rogueamoeba.com/audiohijackpro/)。但是，这些都不是开源或免费的。

编辑——哎呀，你想以编程方式访问，这回答了我自己的问题，对不起。我想我会在这里保留我的答案，以防有些人偶然发现这个页面想要以非编程方式录制音频。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-30T01:40:45.763

您需要您的应用程序来安装系统扩展。 [Soundflower](http://www.cycling74.com/products/soundflower)是此类扩展的开源实现。

# c++ - “警告：并非所有控制路径都返回值”是什么意思？(C++)

> ID：928694
> 
> 赞同：3
> 
> 时间：2009-05-30T01:13:55.707
> 
> 标签：c++, controls, warnings

我得到的确切警告是

```
warning C4715: 'hand::show' : not all control paths return a value 
```

和 hand::show 是

```
std::ostream& hand::show(std::ostream& os) const
{
    if(side == left)
    {
        return os<<display[0]<<display[1]<<display[2]<<display[3]<<display[4];
    }
    if(side == right)
    {
        return os<<display[4]<<display[3]<<display[2]<<display[1]<<display[0];
    }
} 
```

其中 side 是类型方向的变量

```
orientation{
    left = -1,
    right = 1
}; 
```

警告是什么意思，摆脱它的最佳解决方案是什么？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-30T01:18:01.597

您的编译器不够聪明，无法考虑到 is 和 的唯一两个选项`side`，`left`因此`right`它认为这两个 return 语句都不可能被执行。当`side`is not `left`nor`right`时，您的函数不会说明要返回哪个值。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-30T01:16:52.130

该错误意味着如果 side 既不是左也不是右，您的函数将不会返回值 - 任何一方声明不正确或您的枚举是。枚举应该定义为

```
enum orientation {left, right}; 
```

所以试着改变你的方向结构。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-30T01:23:55.327

如果`side`不是`left`或`right`，则返回值未定义。

即使`orientation`是一个只有两个值的枚举（现在），它仍然可以由于以下任何原因而具有不同的值：

*   将来，您可能会更改标头以在枚举中包含其他值，因此假设这会发生（并且您的编译器现在很好并警告您）是防御性编程。
*   `side`可能未初始化，因此它既不是`left`也不是`right`
*   `side`可能已经通过类型转换分配了另一个值，例如`*((int*)&side) = 2`

可能的解决方案包括：

*   `if`用`else`sth 建议的替换第二个。
*   将其更改为：

    ```
    if(side == left) {
        return ...;
    } else if(side == right) {
        return ...;
    } else {
        ...handle error...
    } 
    ```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-30T01:17:31.050

警告意味着可以通过您的方法而不返回任何显式值。使用您的代码：

```
std::ostream& hand::show(std::ostream& os) const
{
    if(side == left)
    {
        return os<<display[0]<<display[1]<<display[2]<<display[3]<<display[4];
    }
    if(side == right)
    {
        return os<<display[4]<<display[3]<<display[2]<<display[1]<<display[0];
    }
} 
```

如果`side != left`和`side != right`，那么你不会返回任何东西。解决此问题的常用方法是假设，例如，如果不是“左”，则始终假设“右”：

```
std::ostream& hand::show(std::ostream& os) const
{
    if(side == left)
    {
        return os<<display[0]<<display[1]<<display[2]<<display[3]<<display[4];
    }
    return os<<display[4]<<display[3]<<display[2]<<display[1]<<display[0];
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-30T01:21:12.820

你可以做某事说什么，或者，因为在这种情况下，你真的以任何一种方式返回相同的东西......

```
std::ostream& hand::show(std::ostream& os) const
{
    if(side == left)
    {
        os<<display[0]<<display[1]<<display[2]<<display[3]<<display[4];
    }
    else
    {
        os<<display[4]<<display[3]<<display[2]<<display[1]<<display[0];
    }
    return os;
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-30T01:19:27.053

要摆脱警告，请将第二个替换`if`为`else`：

```
std::ostream& hand::show(std::ostream& os) const
{
    if(side == left)
    {
        return os<<display[0]<<display[1]<<display[2]<<display[3]<<display[4];
    }
    else
    {
        return os<<display[4]<<display[3]<<display[2]<<display[1]<<display[0];
    }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-30T01:23:47.683

正如其他人所建议的那样，问题在于您`side`可能既不是`left`也不是`right`。
您可以修改您的函数以执行以下任何操作：

1.  将第二个 if 语句更改为 else，或者将条件全部删除，因为如果一侧不左，它一定是右。
2.  按照 Nathaniel Flath 的建议，将方向类型修改为枚举。
3.  引发异常作为函数的最后一条语句。

# bash - 在解锁时运行脚本？

> ID：928703
> 
> 赞同：5
> 
> 时间：2009-05-30T01:19:52.293
> 
> 标签：bash, scripting, kde, kde4, unlock

嘿，我想在 KDE 4 上每次解锁我的计算机时运行一个 shell 脚本。我了解到我可以通过使用 shell 脚本覆盖 /usr/lib/kde4/libexec/krunner_lock 来运行它，然后是原始的 krunner_lock 二进制文件，我基本上想做相反的事情：启动一个脚本来“撤消”锁定脚本的作用。我使用的是 Kubuntu 9.04 64 位，但我很欣赏任何操作系统的答案，以防我想在该系统上做同样的事情。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-20T00:07:09.530

在此处的[KDE 论坛上找到了](http://forum.kde.org/run-shell-script-at-unlock-t-61217.html)它。Porges 的解决方案非常接近答案，但还没有完全实现。您必须将脚本接收到的参数传递给真正的 krunner_lock，如下所示：`krunner_lock_bin $@`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T23:28:57.590

[从此页面](http://trac.gajim.org/wiki/KDesktopLock)阅读，`krunner_lock`只要屏幕锁定，它似乎就会一直运行，因此您应该能够将命令放在运行它的行之后，一旦屏幕解锁，它们就会运行。

例如

```
#!/bin/bash
...
# do stuff
...
real_krunner_lock # exits once screen unlocks...
...
# undo stuff 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-04-22T12:07:22.867

2015 年版本，可在 Kubuntu 14.10 下使用 Desktop Widgets locker：

```
#!/bin/bash

lockpidname="/usr/bin/plasma-overlay --nofork"

$lockpidname

check_slock () {
if [[ $(pgrep -fla $lockpidname) ]]; then 
SLOCKED=1
else
SLOCKED=0
fi
}

while true; do
  sleep 5
  check_slock
  case $SLOCKED  in 
  0) 
  echo "System unlocked run something here"
  break
  ;; 
  esac

done 
```

这适用于您想要在全局键盘快捷键中的自定义部分下分配 CTRL+ATL+L 组合的情况。

# vb.net - VB.NET 自己执行任何多线程吗？

> ID：928726
> 
> 赞同：1
> 
> 时间：2009-05-30T01:35:21.000
> 
> 标签：vb.net

我非常了解 .Net 和 C#，但从未看过 VB。

我的问题是：我们的 Win32 COM 库被许多客户端使用，我们看到使用 VB（VB 和 VB.NET）库的用户的失败次数高于使用 C++、C# 的用户或德尔福。关于我们的库的一件事是它应该只在一个线程中使用——VB 的一些线程魔法会导致失败吗？

客户告诉我们不要自己创建任何额外的线程。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-30T02:00:52.400

VB.NET = C#，语法略有不同。说真的，您可以在 99% 的时间内将 VB.NET 逐行翻译成 C#。在你不知情的情况下，这两种语言都不会在你的眼皮底下制造线索。

最多，如果您的客户使用 VB.NET 并关闭 Option Strict，那么 VB.NET 的后期绑定可能会导致比它修复的问题更多 - 如果没有看到您的客户报告的实际异常，很难确定。在任何情况下，将您的客户的失败归咎于技能较低的程序员和他们自己库中的错误，而不是您的代码或 Microsoft 的 VB.NET 实现。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-30T02:15:28.953

魔术，没有。VB.Net 不会在后台做任何额外的线程。在这方面它与 C# 相同。

VB6 和更早版本会影响线程，因为它的所有对象都是 STA COM 对象。这不会向您的程序添加任何线程，而只会限制访问 VB6 对象的方式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-30T02:14:41.187

一种情况是 Finalize 方法。CLR 从与系统的垃圾收集器部分关联的后台线程调用它们。最有可能的是，您的用户不应该从 Finalize 中调用您的组件。

还要注意 BackgroundWorker 或委托 BeginInvoke。尽管用户没有“自己创建任何额外的线程”，但这些机制在与主 GUI 线程分开的线程池线程上执行代码。

# jquery - 更改后可编辑设置默认选择值

> ID：928730
> 
> 赞同：4
> 
> 时间：2009-05-30T01:37:02.587
> 
> 标签：jquery, jeditable

我的应用程序允许用户使用 jeditable 通过下拉框更新字段。加载程序时，我创建了此函数以获取所选值并将其设置为 jeditable 中的所选值。

但是在我更改值后，所选标签仍设置为旧值。我怎样才能使它更改为新值？

这是功能

```
function updateType(ID,type){
$(document).ready(function(){

    $('#tweekType-'+ID).editable("edit.php?type=tweekType", {  

    data   : " {'copywriting':'Copywriting','design':'Design','code':'Code', 'selected':'"+type+"'}",
    type   : 'select'

    });
}); 
```

这是标签的包装。

```
<span id="tweekType-<?php echo $getTweaksReturned->tweekID; ?>">
<?php type($getTweaksReturned->type); ?>
<script>updateType('<?php echo $getTweaksReturned->tweekID; ?>','<? echo $getTweaksReturned->type; ?>'); </script>
</span> 
```

在返回新变量的页面上复制相同的标签。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-03-22T13:15:48.297

我有同样的问题。这里给出的答案并不重要。

无论如何，我用一个非常简单整洁的解决方案解决了它：

只是不要添加“选定”键和值。

每次打开选择框时，它都会自动显示单元格的值...

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-02-23T07:50:43.597

就我而言，我不得不削减价值。这是因为神秘的空白。

```
$('.edit').editable('/xxx/TableRowUpdate', {
...
data: function (value, settings) {
return " {'a':'category a','b':'category b','selected': '" + $.trim(value) + "'}";
},
... 
```

希望这可以帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-03-22T00:03:11.107

有两种方法可以预选当前选定的值。

如果是纯客户端，您可以覆盖数据功能：

```
 $('.edit').editable('/xxx/TableRowUpdate', {
   ...
   data: function (value, settings) {
     return " {'a':'category a','b':'category b','selected': '" + value + "'}";
   },
   ... 
```

如果是服务器端，您可以使用

```
$('.edit').editable('/xxx/TableRowUpdate', { 
     ...    
     loadurl: '/xxx/FileCategoryList',
     loadtype: "POST",
     loaddata: function(value, settings) {
                  return {selectedValue: value};
               }, 
```

服务器端代码（c# MVC 示例）看起来像

```
public JsonResult FileCategoryList(string selectedValue)
{
  var categories = new Dictionary<string, string>{{"a", "a category"}, {"b", "b category"}, {"selected", selectedValue}};
    return Json(categories, JsonRequestBehavior.DenyGet);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-10T10:51:20.313

您的代码看起来非常不像 jQuery，但它可能有效。您是否有理由将 Jeditable 分别绑定到每个 id？还有你在函数中调用 document.ready 的原因吗？只需给跨度一个类并绑定到一个类。

```
<span class="tweek" id="tweekType-<?php echo $getTweaksReturned->tweekID; ?>">
<?php type($getTweaksReturned->type); ?>
</span> 
```

并将 Jeditable 绑定到 document.ready 内部（不是函数）。如果 select 的值与您单击的文本匹配，则默认情况下将选中它。注意设计！=设计。执行以下操作：

```
$(document).ready(function(){
    $('#tweekType-'+ID).editable("edit.php?type=tweekType", {  
       data   : " {'Copywriting':'Copywriting','Design':'Design','Code':'Code'}",
       type   : 'select'
    });
}); 
```

或者，您也可以从返回的外部 url 和 JSON 数组中加载 select 的内容。那么select的text和value就不需要匹配了：

```
$(document).ready(function(){
    $('#tweekType-'+ID).editable("edit.php?type=tweekType", {  
       loadurl : "http://www.example.com/select.php",
       type    : 'select'
    });
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-11-25T19:58:39.073

我没有向 php 脚本提交值，但是当您使用 jeditable 调用另一个 javascript 函数时，您必须返回要从函数更新的值，因此：

```
$(".selector").editable(someFunction, {
    indicator: "Saving...",
    tooltip: "Click to edit...",
    data: " {'3':'3','4':'4','5':'5'}",
    type: 'select',
}); 
```

然后：

```
function someFunction(value, settings) {
  // do some magic
  return(value);
} 
```

# version-control - 有没有像 Google Wave 这样的 Web 或桌面应用程序？

> ID：928733
> 
> 赞同：3
> 
> 时间：2009-05-30T01:38:31.493
> 
> 标签：version-control, google-wave

是否有任何现有或即将推出的网络或桌面应用程序，例如 Google Wave？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-12T12:50:25.687

[槽办公室](http://office.microsoft.com/en-us/groove/FX100487641033.aspx)。Ray Ozzie 可能会在看到 Google 如何应用[Operational Transform](http://en.wikipedia.org/wiki/Operational_transformation)之后自责。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-08-16T11:01:10.573

[共享流量](http://www.zenbe.com/shareflow)！这就是未来...与 Google Wave 非常相似，只是没有为未来撤回资金；]

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-05T13:47:08.863

当 Groove 出现时，我对它感到很兴奋，而且 Google Wave 在很多方面都让我想起了这一点，这是我所见过的。尽管 Groove 是 MS Office 的一部分，但我已经很多年没有看过它了。许多阻止 Groove 早期版本被采用的问题在 Wave 中并不存在，或者由于新技术而不再是问题，因此它具有潜力。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T13:39:44.207

37 Signals 的[持久聊天室](http://campfirenow.com/)在某些方面类似于 Google Wave。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-30T07:00:51.713

根据我看到的视频（大概和其他人看到的一样），我想我会说电子邮件、即时消息、wiki、版本控制系统和社交网络有时都“像 Google Wave”。很酷的是 Wave 模仿了其中的任何一个。如果您将其视为电子邮件，则它的行为就像电子邮件等。

但是，是否有一种东西具有 Wave 的全部或大部分功能？好吧，我猜是 GMail，因为它将对话分组在一起，而大多数电子邮件系统将每条消息视为一个单独的东西。此外，它同时具有电子邮件和 IM，两者之间有一些集成。

或者可能是公告板/论坛之类的东西，任何人都可以在其中编辑其他人的帖子？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-08-05T11:36:46.950

http://colayer.com"> **Colayer**是基于与Google Wave类似的概念。但与Google Wave不同的是，产品相当成熟。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-03T04:57:49.553

[LysKOM](http://en.wikipedia.org/wiki/LysKOM)显然也是类似的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-11-19T23:58:46.810

看看[Novell Pulse](http://www.novell.com/products/pulse/)。它基于 Wave 协议，但在界面和功能方面似乎与 Google Wave 相提并论。

我希望我们会在不久的将来看到越来越多的 Wave 客户端，包括 Web 和桌面客户端。如果 Wave Federation 协议确实有效，那么所有这些应用程序都可以与所有提供商一起使用，并且来自不同提供商的所有数据都可以集成到一个客户端中。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-01-14T14:16:57.533

如果您指的是 Google Wave 的实时协作，那么您可能需要查看 [Etherpad](http://code.google.com/p/etherpad/)、 [Gobby](http://gobby.0x539.de/)和 [Sub-Etha-Edit](http://www.codingmonkeys.de/subethaedit/)。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-07-08T13:22:25.890

PyGo Wave 服务器是 Google Wave 的开源实现：

[http://wavety.com/pygo-wave-server/](http://wavety.com/pygo-wave-server/)

不过没试过。

# javascript - 如何让 Firefox 插件从页面监听 xmlhttprequests？

> ID：928735
> 
> 赞同：2
> 
> 时间：2009-05-30T01:39:36.340
> 
> 标签：javascript, xmlhttprequest, firefox-addon

**背景**
我有一个现有的扩展，旨在伴随基于浏览器的游戏（扩展是我的，游戏不是）。该扩展程序一直在抓取页面以获取所需的数据并发出 ajax 请求以执行任何操作。

**问题**
游戏开发人员最近更改了网站上的一些操作以使用 ajax 请求，但我至今无法从这些请求中获取数据。

**到目前为止我所拥有的**

```
function TracingListener() {
}

TracingListener.prototype =
{
    originalListener: null,
    receivedData: [],   // array for incoming data.

    onDataAvailable: function(request, context, inputStream, offset, count)
    {
       var binaryInputStream = CCIN("@mozilla.org/binaryinputstream;1",
                "nsIBinaryInputStream");
        var storageStream = CCIN("@mozilla.org/storagestream;1", "nsIStorageStream");
        binaryInputStream.setInputStream(inputStream);
        storageStream.init(8192, count, null);

        var binaryOutputStream = CCIN("@mozilla.org/binaryoutputstream;1",
                "nsIBinaryOutputStream");

        binaryOutputStream.setOutputStream(storageStream.getOutputStream(0));

        // Copy received data as they come.
        var data = binaryInputStream.readBytes(count);

        this.receivedData.push(data);

        binaryOutputStream.writeBytes(data, count);
        this.originalListener.onDataAvailable(request, context,storageStream.newInputStream(0), offset, count);
    },

    onStartRequest: function(request, context) {
        this.originalListener.onStartRequest(request, context);
    },

    onStopRequest: function(request, context, statusCode)
    {
        try {
            if (request.originalURI && piratequesting.baseURL == request.originalURI.prePath && request.originalURI.path.indexOf("/index.php?ajax=") == 0) {

                dump("\nProcessing: " + request.originalURI.spec + "\n");
                var date = request.getResponseHeader("Date");

                var responseSource = this.receivedData.join();
                dump("\nResponse: " + responseSource + "\n");

                piratequesting.ProcessRawResponse(request.originalURI.spec, responseSource, date);
            }
        } catch(e) { dumpError(e);}

        this.originalListener.onStopRequest(request, context, statusCode);
    },

    QueryInterface: function (aIID) {
        if (aIID.equals(Ci.nsIStreamListener) ||
            aIID.equals(Ci.nsISupports)) {
            return this;
        }
        throw Components.results.NS_NOINTERFACE;
    }
}

hRO = {

    observe: function(aSubject, aTopic, aData){
        try {
            if (aTopic == "http-on-examine-response") {
                if (aSubject.originalURI && piratequesting.baseURL == aSubject.originalURI.prePath && aSubject.originalURI.path.indexOf("/index.php?ajax=") == 0) {
                    var newListener = new TracingListener();
                    aSubject.QueryInterface(Ci.nsITraceableChannel);
                    newListener.originalListener = aSubject.setNewListener(newListener);

                    dump("\n\nObserver Processing: " + aSubject.originalURI.spec + "\n");
                    for (var i in aSubject) {
                        dump("\n\trequest." + i);
                    }
                }
            }
        } catch (e) {
            dumpError(e);

        }
    },

    QueryInterface: function(aIID){
        if (aIID.equals(Ci.nsIObserver) ||
        aIID.equals(Ci.nsISupports)) {
            return this;
        }

        throw Components.results.NS_NOINTERFACE;

    }
};

var observerService = Cc["@mozilla.org/observer-service;1"] .getService(Ci.nsIObserverService);

observerService.addObserver(hRO, "http-on-examine-response", false); 
```

**发生了什么**
处理 http 请求时，会正确通知上述代码。uri 也是可用的并且是正确的（它通过了域/路径检查），但是`responseSource`据我所知，被转储的总是浏览器打开后发出的第一个 http 请求的内容，显然不是什么我期待着。

上面的代码大部分来自[http://www.softwareishard.com/blog/firebug/nsitraceablechannel-intercept-http-traffic/](http://www.softwareishard.com/blog/firebug/nsitraceablechannel-intercept-http-traffic/)。我真的希望这只是我忽略的一些小事，但我已经在这个问题上把头撞在桌子上好几天了，所以现在我求助于 SO 的智慧。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-30T06:44:30.030

> 但是，据我所知，被转储的 responseSource 始终是浏览器打开后发出的第一个 http 请求的内容，显然，这不是我所期望的。

上面的代码有问题。“receivedData”成员在原型对象上声明并分配了空数组。这导致 TracingListener 类的每个实例化都使用内存中的相同对象来接收数据。将您的代码更改为可能会解决他的问题：

```
function TracingListener() {
    this.receivedData = [];
}

TracingListener.prototype =
{
    originalListener: null,
    receivedData: null,   // array for incoming data.

/* skipped */

} 
```

不确定这是否会解决您最初的问题。

# ruby - 将 JRuby 用于 Ruby Web 应用程序？这值得么？

> ID：928739
> 
> 赞同：15
> 
> 时间：2009-05-30T01:41:10.520
> 
> 标签：ruby, performance, web-applications, jruby

**背景：**我正在用 Ruby（不是 Rails）编写一个“标准”（没什么特别的）Web 应用程序，我需要开始考虑部署。

所以我听到了很多关于使用 JRuby 来部署 Ruby Web 应用程序的建议，不管你是否真的需要 Java 库。这有多真实？仅仅为了速度而使用 Java 实现是否值得？这样做我还能得到什么吗？我会遇到任何问题吗？

PS：我不太了解Java，所以“你可以用Java写一部分”不是很有帮助。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-30T02:09:01.993

JRuby 是最完整的 ruby​​ 实现之一（还有很多其他的实现，例如 IronRuby、Maglev、Rubinius、XRuby、YARV、MacRuby）。它非常全面，因此，除非您使用使用本机 C 代码的 gem，否则您很可能会在兼容性方面做得很好。

JRuby 比实际的 C 实现要快一点，但它支持实际的线程，而官方实现在获得它方面有点困难（它仍然使用[Green Threads](http://en.wikipedia.org/wiki/Green_threads)）。使用 JRuby 中的 Java 线程非常简单，即使它需要您将代码与 Java 耦合（尽管有一点[DI](http://martinfowler.com/articles/injection.html)，这种耦合只会发生一次）。

另一个好处：运行时工具。Java 作为一种*平台*，而不是一种语言，有**很多**运行时工具可以帮助您诊断问题和检查应用程序的状态（分析器、JConsole 等）。

[Twitter](http://www.artima.com/scalazine/articles/twitter_on_scala.html)工程师还提到 Ruby VM*在成为长期进程的环境时有点困难*，而*JVM 在这方面非常擅长，因为在过去十年中它已经为此进行了优化*。

Ruby 最近也有一点安全问题，不影响 JRuby 的实现。

另一方面，您的项目需要更多的工件（JVM、JRuby jars 等）。如果您使用的应用程序将长期存在，并且您想要更好的运行时支持，那么 JRuby 可能是一个不错的选择。否则，您可以放心地等到需要这些东西才能真正采取行动（很可能会顺利进行）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-01T03:56:10.043

我每天都使用并喜欢 JRuby，但我建议你使用 MRI（又名 C-Ruby），除非你真的需要 JRuby。

使用 JRuby 的原因：

1.  Java 集成
2.  受限环境（您的机器安装了非 ruby​​ 的 Java 并且您没有 root）
3.  受限环境（您已安装 ruby​​ 但没有 root 权限，因此无法安装所需的 gem）
4.  您已达到 Ruby 1.8 性能的极限，无法使用 1.9

根据您的描述，您没有上述任何原因。

C-Ruby 1.9 与 C-Ruby 1.8 相比具有显着的性能改进。我还没有阅读（或自己了解）C-Ruby 1.9 与 JRuby 1.8 或 JRuby 1.9 的比较。无论如何，你还没有性能问题，所以不用担心。

好消息是，您可以从其中任何一个开始，然后在需要时进行转换。全部都是 Ruby，Webrick 和 Mongrel gems 两者都可以使用。

如上所述，具有 C 扩展名的 ruby​​ gem 不能安装在 JRuby 下。希望如果 ruby​​ C 扩展使用 FFI，这将在未来改变。

[http://kenai.com/projects/ruby-ffi/pages/Home](http://kenai.com/projects/ruby-ffi/pages/Home)

[http://isitjruby.com/](http://isitjruby.com/)

# .net - .NET Compact Framework 组件序列化程序

> ID：928741
> 
> 赞同：2
> 
> 时间：2009-05-30T01:41:49.427
> 
> 标签：.net, compact-framework, controls

我正在将 .NET Framework 组件移植到 .NET Compact Framework。组件中有 ImageList。该组件实现自定义 CodeDomSerializer。自定义 CodeDomSerializer 的构造函数包含以下用于 ImageList 代码序列化的代码。

```
TypeDescriptor.AddAttributes(typeof(ImageList), new DesignerSerializerAttribute(typeof(MyComponentCodeDomSerializer), typeof(CodeDomSerializer))); 
```

但由于某种原因，.NET Compact Framework 不使用自定义 ImageList CodeDomSerializer（它在 .NET Framework 中工作。）它使用默认的 CodeDomSerializer。任何想法如何附加 ImageList 自定义 CodeDomSerializer？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-10-29T19:36:51.217

我发现 CF 和 WF 设计师之间有很多差异，不可能在两个设计师上保存相同的表格。最有趣的是，如果没有使用*平台*设计器打开表单，无论如何都可以构建它。所以我有 2 个项目，一个用于 win，一个用于 CE，默认项目是*win*，表单是使用 CE 设计器设计的。奇怪，但它的工作...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T11:23:31.907

The Compact Framework does not support the CodeDomSerializer class, so therefore your code is not working. What are you trying to achieve with the custom CodeDomSerializer?

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-01-19T15:33:07.887

据我所知，Compact Framework 不支持 CodeDomSerializer，甚至没有合适的类型或库。如何对待 Visual Studio 设计器并使其使用我的自定义 CodeDomSerializer？

# php - 如何在命令行上编辑文件？

> ID：928743
> 
> 赞同：2
> 
> 时间：2009-05-30T01:43:29.220
> 
> 标签：php, linux, command-line

我正在尝试创建一个 php 文件，该文件添加一个用户并使用 exec() 函数（php）在 linux 中创建 public_html 目录。

我可以将以下代码添加到 php 文件中

exec("useradd -d /home/username -m 用户名"); exec("mkdir /home/username/public_html");

现在..我必须将 public_html 添加到 smb.conf 才能在 Windows 上工作 public_html。

是否可以在命令行上编辑 smb.conf？

当然，我将使用 SSH 作为 root 来执行 php 文件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-30T01:44:47.673

编辑：阅读 Roy Rico 的回答后，我相信我误解了这个问题。

您可以使用 nano 或 vi。如果您是初学者，那么 nano 会更直接。只需像这样使用它：

```
nano /etc/samba/smb.conf 
```

我相信 ctrl+o 会保存文件并且 ctrl+x 会退出。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-30T01:52:11.603

您是要使用在命令行上执行的 php 脚本来编辑文件，还是要自己使用命令行来编辑命令行（使用交互式 shell）？

如果你试图用你的 php 脚本编辑文件，你将不得不使用 fopen、fwrite 命令，加上对你的脚本文件的访问权限，那么你可能会遇到很多安全问题等等等。最重要的是，这不仅仅是一个可以在这里给你的快速答案。

如果您使用的是交互式 shell，那么 vi 和 emacs 是很棒的编辑器，但如果您以前从未使用过它们，那就太令人生畏了。pico 和 nano 对于不熟悉 CL 编辑器的人来说更友好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-30T01:46:30.307

大多数人使用 Vim 或 Emacs 作为他们的命令行编辑器。就个人而言，我更喜欢 emacs，但两者都试一下，看看你更喜欢哪一个。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-30T02:28:13.390

看看[parse_ini_file()](http://www.php.net/parse_ini_file)函数。

然后，如果您想在 ini 文件中写入，请尝试以下操作：

```
function writeini($file,$title,$item,$data) {
  $source = file($file);
  $t_match = "/^\[".$title."\]/i";
  $s_title = "";
  $c = "0";
  $o = "";
  foreach ($source as $temp) {
    $c++;
    if (preg_match("/^\[.+\]/i",$temp)) {
          if (preg_match($t_match,$l_title)) {
            $done = "yes";
            $f_write .= $item."=".$data."\n";
          }
          $l_title = $temp;
          $f_write .= $temp;
        } elseif (preg_match("/^".$item."=/i",$temp) && preg_match($t_match,$l_title)) {
          $done = "yes";
          $f_write .= $item."=".$data."\n";
          $l_title = "";
        } elseif ($c == count($source) && $done != "yes") {
          if (preg_match($t_match,$l_title)) {
            $f_write .= $temp.$item."=".$data."\n";
          } else {
                $f_write .= $temp."[".$title."]\n".$item."=".$data."\n";
          }
        } else {
          $f_write .= $temp;
        }
  }
  $ini_write = fopen($file,'w');
  fwrite($ini_write,$f_write);
  fclose($ini_write);
} 
```

# google-wave - Google Wave 使用什么技术？

> ID：928744
> 
> 赞同：9
> 
> 时间：2009-05-30T01:43:56.333
> 
> 标签：google-wave

构建 Google Wave 采用了哪些技术？

**编辑**：我已经将答案移动并合并到下面的答案中，而不是在他们所在的问题中。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-30T02:18:44.203

*   实时编辑——某种用于服务器端调用的 Ajax/Comet。
*   版本控制。
*   内置谷歌网络工具包（GWT）。
    *   GWT 涉及 Java、Javascript、CSS、HTML。
*   自定义构建的协议。波协议。
    *   使用 xmmp 标准
*   富文本编辑器。
*   语言翻译。
*   Google Gears，用于拖放（文件）功能。试图将其纳入 HTML5 规范。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-30T01:52:59.717

它使用 HTML5 作为接口，使用 XMPP（Jabber 协议）作为通信材料。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-12T12:45:30.363

革命性的部分是[运营转型](http://en.wikipedia.org/wiki/Operational_transformation)。基于[木星的协同系统](http://portal.acm.org/citation.cfm?id=215585.215706)。

您可能想观看此视频：[Google I/O 2009 - Google Wave Under the hood](http://www.youtube.com/watch?v=uOFzWZrsPV0)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-30T02:46:32.103

我了解他们使用 Jabber 协议的扩展用于联合 Wave 服务器。

实时编辑基于一种有时称为 jupiter 算法并在[本文](http://ftp//ftp.lambda.moo.mud.org/pub/papers/JupiterWin.ps)中描述的算法。更多信息可以在[http://www.waveprotocol.org/whitepapers上找到](http://www.waveprotocol.org/whitepapers)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-30T01:45:08.297

我相信 Google Wave 是基于 HTML5 构建的。

# javascript - 如何获取使用 innerHTML = "动态编写的选择选项的值 ";

> ID：928747
> 
> 赞同：0
> 
> 时间：2009-05-30T01:45:22.943
> 
> 标签：javascript, html

`<select>`我已经使用类似的东西写了选项

```
Id.innerHTML = "<option value='foo'>Foo</option>"; 
```

但是在提交时我没有从选项中获得任何价值？我该如何纠正这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T01:48:06.980

对于表单，如果您显示/隐藏动态字段，很多时候，您必须有隐藏值来存储值，然后让您的 PHP（或其他）查​​找隐藏字段值，而不是动态 HTML 值。这是一种痛苦

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T03:04:35.983

谢谢罗伊，我考虑了你所说的并想出了以下内容：

```
function insert(){
                        document.getElementById('text').value = document.getElementById('select').value;
    }

    function insertHTML(){
                        document.getElementById('div').innerHTML = "<select id='select' onload=\"insert()\" onclick=\"insert()\"><option value='1'> 1 </option><option value='2'> 2 </option></select>";
    }

    <form method='post' action='http://localhost/test.php'>
        <input type='button' value='insert' onclick="insertHTML(); insert();" >
        <div id='div' ></div>
        <input type='hidden' id='text' name='text'>
        <input type='submit' value='go'>
    </form> 
```

获取输入名称而不是选择的名称。

# c++ - 在 C++ 中声明一个 const int 数组

> ID：928751
> 
> 赞同：14
> 
> 时间：2009-05-30T01:47:45.140
> 
> 标签：c++, arrays, constants, declaration

我有一堂课，我想要一些值为 0、1、3、7、15 的位掩码，...

所以本质上我想声明一个常量 int 的数组，例如：

```
class A{

const int masks[] = {0,1,3,5,7,....}

} 
```

但编译器总是会抱怨。

我试过：

```
static const int masks[] = {0,1...}

static const int masks[9]; // then initializing inside the constructor 
```

关于如何做到这一点的任何想法？

谢谢！

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-05-30T01:53:57.170

```
class A {
    static const int masks[];
};

const int A::masks[] = { 1, 2, 3, 4, ... }; 
```

您可能已经想在类定义中固定数组，但您不必这样做。该数组将在定义点具有完整的类型（保留在 .cpp 文件中，而不是在标头中），它可以从初始化程序中推断出大小。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-30T01:56:33.030

```
// in the .h file
class A {
  static int const masks[];
};

// in the .cpp file
int const A::masks[] = {0,1,3,5,7}; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-30T01:49:48.457

```
enum Masks {A=0,B=1,c=3,d=5,e=7}; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-30T01:58:01.827

1.  您只能在构造函数或其他方法中初始化变量。
2.  “静态”变量必须从类定义中初始化。

你可以这样做：

```
class A {
    static const int masks[];
};

const int A::masks[] = { 1, 2, 3, 4, .... }; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-03-04T04:19:07.120

嗯，这是因为你不能在不调用方法的情况下初始化私有成员。我总是使用**成员初始化列表**来为 const 和静态数据成员这样做。

如果您不知道**成员初始化器列表**是什么，它们正是您想要的。

看看这段代码：

```
 class foo
{
int const b[2];
int a;

foo():    b{2,3}, a(5) //initializes Data Member
{
//Other Code
}

} 
```

GCC 也有这个很酷的扩展：

```
const int a[] = { [0] = 1, [5] = 5 }; //  initializes element 0 to 1, and element 5 to 5\. Every other elements to 0. 
```

# c++ - 如何修复 C++ 中的 int-to-bool 警告？

> ID：928758
> 
> 赞同：3
> 
> 时间：2009-05-30T01:53:09.170
> 
> 标签：c++, integer, boolean

当我尝试从文件中读取整数并使 bool 变量等于它时，我在 MSVC++ 中收到警告。

```
accessLV[i] = FileRead(file1, i + 1); 
```

（accessLV 是一个布尔数组，FileRead 是我为减少从文件读取所涉及的语法而创建的一个函数，因为该语句位于 for 循环中）

我试过使用 static_cast：

```
accessLV[i] = static_cast<bool>(FileRead(file1, i + 1)); 
```

但我仍然收到警告。我试过这样做（我不确定确切的术语）：

```
accessLV[i] = (bool)FileRead(file1, i + 1)); 
```

警告仍然存在。有没有办法在不使 accessLV 成为整数数组的情况下摆脱警告？

注意：这是 FileRead 的语法，如果有帮助的话：

```
int FileRead(std::fstream& file, int pos)
{
    int data;
    file.seekg(file.beg + pos * sizeof(int));
    file.read(reinterpret_cast<char*>(&data), sizeof(data));
    return data;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-30T01:56:48.477

怎么样

```
accessLV[i] = FileRead(file1, i + 1) != 0; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-30T01:56:55.497

你想做的基本上是

accessLV[i] = (FileRead(file1, i + 1) != 0)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-30T02:19:39.287

```
accessLV[i] = FileRead(file1, i + 1) != 0; 
```

上面，您从 int 转换为 bool：如果您使用它，比较的结果将放在 accessLV[i] 中，因此不会出现类型警告。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-30T02:45:23.493

正如其他海报所建议的那样，`!=0`这是您所需要的。我更喜欢这样的包装器，因为我发现它更具可读性：

```
// myutil.hpp
template< typename T >
inline bool bool_cast( const T & t ) { return t != 0; } 
```

在这种情况下您将使用如下：

```
// yourcode.cpp
accessLV[ i ] = bool_cast( FileRead( file1, i + 1 ) ); 
```

[这个相关问题](https://stackoverflow.com/questions/206106/is-a-safe-way-to-convert-to-bool-in-c)有额外的讨论，您可能会觉得有用。

# java - 如何模拟用于测试的数据库（Java）？

> ID：928760
> 
> 赞同：85
> 
> 时间：2009-05-30T01:53:42.523
> 
> 标签：java, database, unit-testing, testing, jdbc

我正在用 Java 编程，我的应用程序大量使用 DB。因此，能够轻松测试我的数据库使用情况对我来说很重要。
数据库测试的全部内容是什么？对我来说，他们应该提供两个简单的要求：

1.  验证 SQL 语法。
2.  更重要的是，根据给定的情况检查数据是否被正确选择/更新/插入。

那么，看来我所需要的只是一个数据库。
但实际上，我不喜欢，因为使用数据库进行测试几乎没有困难：

*   “给自己弄个测试数据库，有多难？” - 嗯，在我的工作场所，拥有一个个人测试数据库是几乎不可能的。您必须使用每个人都可以访问的“公共”数据库。
*   “这些测试肯定不快......” - 数据库测试往往比通常的测试慢。进行慢速测试确实不理想。
*   “这个程序应该处理任何情况！” - 尝试模拟数据库中的每个案例变得有些烦人甚至不可能。对于每种情况，都应该进行一定数量的插入/更新查询，这很烦人并且需要时间。
*   “等一下，你怎么知道那个表有542行？” - 测试的主要原则之一是能够以不同于测试代码的方式测试功能。使用数据库时，通常有一种方法可以做某事，因此测试与核心代码完全相同。

所以，你可以发现我在测试方面不喜欢数据库（当然我必须在某个时候做到这一点，但我宁愿稍后在我的测试中到达那里，因为我发现大多数错误使用其余的测试方法）。但我在寻找什么？

我正在寻找一种使用文件系统或只是虚拟内存来模拟数据库、模拟数据库的方法。我认为也许有一个 Java 工具/包允许简单地构造（使用代码接口）每个测试的 DB 模拟，模拟表和行，SQL 验证，以及用于监视其状态的代码接口（而不是使用 SQL ）。

你熟悉这种工具吗？

* * *

**编辑：**感谢您的回答！虽然我要的是一个工具，但你也给了我一些关于这个问题的提示:) 我需要一些时间来查看你的报价，所以我现在不能说你的答案是否令人满意。

无论如何，这是我正在寻找的更好的视图 - 想象一个名为 DBMonitor 的类，它的一个功能是查找表中的行数。这是我想如何使用 JUnit 测试该功能的虚构代码：

```
public class TestDBMonitor extends TestCase {

    @Override
    public void setUp() throws Exception {

       MockConnection connection = new MockConnection();

       this.tableName = "table1";
       MockTable table = new MockTable(tableName);

       String columnName = "column1";
       ColumnType columnType = ColumnType.NUMBER;
       int columnSize = 50;
       MockColumn column = new MockColumn(columnName, columnType, columnSize);
       table.addColumn(column);

       for (int i = 0; i < 20; i++) {
           HashMap<MockColumn, Object> fields = new HashMap<MockColumn, Object>();
           fields.put(column, i);
           table.addRow(fields);
       }

       this.connection = connection;
    }

    @Test
    public void testGatherStatistics() throws Exception {

       DBMonitor monitor = new DBMonitor(connection);
       monitor.gatherStatistics();
       assertEquals(((MockConnection) connection).getNumberOfRows(tableName),
                    monitor.getNumberOfRows(tableName));
    }

    String tableName;
    Connection connection;
} 
```

我希望这段代码足够清晰，可以理解我的想法（请原谅我的语法错误，我是在没有亲爱的 Eclipse 的情况下手动输入的：P）。

顺便说一句，我部分使用了 ORM，而且我的原始 SQL 查询非常简单，应该不会因平台而异。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-05-30T02:09:20.713

Java 附带[Java DB](http://www.oracle.com/technetwork/java/javadb/overview/index.html)。

也就是说，除非您通过 ORM 层，否则我建议您不要使用与您在生产中使用的不同类型的数据库。否则，您的 SQL 可能不像您想象的那样跨平台。

还可以查看[DbUnit](http://dbunit.sourceforge.net/)

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2017-09-13T21:17:08.093

旧问题的新答案（但事情已经向前发展了一点）：

> 如何模拟用于测试的数据库（Java）？

你不模拟它。您模拟您的存储库并且您不测试它们，或者您在测试中使用相同的数据库并测试您的 sqls。所有内存数据库都不完全兼容，因此它们不会为您提供完整的覆盖范围和可靠性。并且永远不要尝试模拟/模拟连接、结果集等深层数据库对象。它根本没有给你任何价值，而且是开发和维护的噩梦

> 拥有个人测试数据库几乎是不可能的。您必须使用每个人都可以访问的“公共”数据库

不幸的是，很多公司仍在使用该模型，但现在我们有了[docker](https://www.docker.com/)，并且几乎每个数据库都有图像。商业产品有一些对测试不重要的限制（比如最多几 GB 的数据）。您还需要在此本地数据库上创建您的架构和结构

> “这些测试肯定不快......” - 数据库测试往往比通常的测试慢。进行慢速测试确实不理想。

是的，数据库测试速度较慢，但​​并没有那么慢。我做了一些简单的[测量](http://blog.piotrturski.net/2017/09/database-integration-tests-are-slow.html)，典型的测试需要 5-50 毫秒。需要时间的是应用程序启动。有很多方法可以加快速度：

*   第一个 DI 框架（如 spring）提供了一种只运行应用程序的某些部分的方法。如果您编写应用程序时很好地分离了数据库和非数据库相关逻辑，那么在您的测试中您只能[启动数据库部分](https://docs.spring.io/spring-boot/docs/1.5.7.RELEASE/reference/html/boot-features-testing.html#boot-features-testing-spring-boot-applications-testing-autoconfigured-jpa-test)
*   每个数据库都有很多调整选项，使其不那么耐用且速度更快。这非常适合测试。[postgres 示例](https://www.postgresql.org/docs/9.6/static/non-durability.html)
*   您还可以将整个数据库放入 tmpfs

*   另一个有用的策略是进行测试组并默认关闭数据库测试（如果它们确实减慢了您的构建速度）。这样，如果有人实际上在使用 db，他需要在 cmd 行中传递额外的标志或使用 IDE（testng 组和自定义测试选择器非常适合这个）

> 对于每种情况，都应该进行一定数量的插入/更新查询，这很烦人并且需要时间

上面讨论了“需要时间”部分。烦人吗？我见过两种方法：

*   为所有测试用例准备一个数据集。那么你必须维护它并对其进行推理。通常它与代码分开。它有千字节或兆字节。在一个屏幕上看到、理解和推理都太大了。它引入了测试之间的耦合。因为当您需要更多行来进行测试 A 时，您的`count(*)`in 测试 B 会失败。它只会增长，因为即使您删除了一些测试，您也不知道哪些行仅由该测试使用
*   每个测试都会准备其数据。这样，每个测试都是完全独立的、可读的并且易于推理。烦人吗？海事组织，一点也不！它让您可以非常快速地编写新的测试，并为您节省大量的工作量

> 您怎么知道该表中有 542 行？” - 测试的主要原则之一是能够以与测试代码不同的方式测试功能

嗯...不是真的。主要原则是检查您的软件是否生成所需的输出以响应特定输入。因此，如果您调用`dao.insert`542 次，然后`dao.count`返回 542，则意味着您的软件按规定工作。如果需要，您可以在两者之间调用提交/删除缓存。当然，有时您想测试您的实现而不是合同，然后检查您的 dao 是否更改了数据库的状态。但您总是使用 sql B 测试 sql A（插入与选择、序列 next_val 与返回值等）。是的，你总是会遇到“谁来测试我的测试”的问题，答案是：没有人，所以保持简单！

其他可能对您有帮助的工具：

1.  [testcontainers](https://www.testcontainers.org/)将帮助您提供真实的数据库。

2.  [dbunit](http://dbunit.sourceforge.net/) - 将帮助您清理测试之间的数据

    缺点：

    *   创建和维护模式和数据需要做很多工作。特别是当您的项目处于密集开发阶段时。
    *   它是另一个抽象层，所以如果你突然想使用这个工具不支持的一些数据库功能，可能很难测试它
3.  [testegration](https://github.com/piotrturski/testegration) - 旨在为您提供完整、随时可用和可扩展的生命周期（披露：我是一个创造者）。

    缺点：

    *   仅对小型项目免费
    *   非常年轻的项目
4.  [flyway](https://flywaydb.org/)或[liquibase](http://www.liquibase.org/) - 数据库迁移工具。它们可以帮助您轻松地在本地数据库上创建模式和所有结构以进行测试。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-05-30T08:18:41.337

关于如何通过 SQL 测试数据库连接等集成点有很多观点。我个人的一套对我很有效的规则如下：

1）将数据库访问逻辑和功能从一般业务逻辑中分离出来，并将其隐藏在接口后面。原因：为了测试系统中的大部分逻辑，最好使用虚拟/存根代替实际数据库，因为它更简单。原因 2：速度快得多

2）将数据库测试视为与单元测试主体分离的集成测试，需要在设置数据库上运行原因：测试的速度和质量

3) 每个开发人员都需要自己独特的数据库。他们将需要一种自动化的方式来根据队友的变化更新其结构并引入数据。见第 4 点和第 5 点。

4) 使用[http://www.liquibase.org](http://www.liquibase.org)之类的工具来管理数据库结构的升级。原因：使您能够灵活地更改现有结构并在版本中前进

5) 使用[http://dbunit.sourceforge.net/](http://dbunit.sourceforge.net/)之类的工具来管理数据。为特定的测试用例和基础数据设置场景文件（xml 或 XLS），只清除任何一个测试用例所需的内容。原因：比手动插入和删除数据要好得多原因2：测试人员更容易理解如何调整场景原因3：执行起来更快

6）您需要功能测试，其中也有类似 DBUnit 的场景数据，但这是更大的数据集并执行整个系统。这完成了结合以下知识的步骤：a）单元测试运行，因此逻辑是合理的 b）对数据库运行的集成测试和 SQL 是正确的，从而导致“系统作为一个整体协同工作底部堆栈"

到目前为止，这种组合对我实现高质量的测试和产品以及保持单元测试开发的速度和更改的敏捷性非常有用。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-05-30T02:00:58.763

为此，我使用了[Hypersonic 。](http://hsqldb.org/)基本上，它是一个 JAR 文件（一个纯 Java 内存数据库），您可以在它自己的 JVM 或您自己的 JVM 中运行它，并且在它运行时，您拥有一个数据库。然后你停止它，你的数据库就消失了。到目前为止，我已经将它用作纯粹的内存数据库。运行单元测试时通过 Ant 启动和停止非常简单。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-05-30T08:54:07.117

> “给自己弄个测试数据库，有多难？” - 嗯，在我的工作场所，拥有一个个人测试数据库是几乎不可能的。您必须使用每个人都可以访问的“公共”数据库。

听起来您在工作中遇到了文化问题，这些问题阻碍了您充分发挥自己的能力和产品的优势。你可能想为此做点什么。

另一方面，如果您的数据库模式受版本控制，那么您总是可以有一个测试构建，它从模式创建一个数据库，用测试数据填充它，运行您的测试，收集结果，然后删除数据库。它只会在测试期间存在。如果硬件有问题，它可以是现有安装上的新数据库。这与我们在我工作的地方所做的类似。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-05-30T06:30:47.593

如果您在工作中使用 Oracle，您可以使用闪回数据库中的还原点功能使数据库返回到测试之前的时间。这将清除您个人对数据库所做的任何更改。

看：

[https://docs.oracle.com/cd/E11882_01/backup.112/e10642/flashdb.htm#BRADV71000](https://docs.oracle.com/cd/E11882_01/backup.112/e10642/flashdb.htm#BRADV71000)

如果您需要一个用于 Oracle 生产/工作的测试数据库，请查找 Oracle 的 XE 速成版数据库。这是免费供个人使用的，数据库大小限制小于 2gb。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-30T06:26:26.557

我们最近切换到 JavaDB 或[Derby](http://db.apache.org/derby/)来实现这一点。Derby 10.5.1.1 现在实现了内存表示，因此它运行得非常快，不需要去磁盘： [Derby In Memory Primer](http://wiki.apache.org/db-derby/InMemoryBackEndPrimer)

我们将应用程序设计为在 Oracle、PostgreSQL 和 Derby 上运行，因此在发现一个数据库支持其他数据库不支持的特性之前，我们不会在任何一个平台上走得太远。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-10-31T08:54:04.410

我认为我的 Acolyte 框架可用于此类 DB 模型：[https](https://github.com/cchantep/acolyte) ://github.com/cchantep/acolyte 。

它允许使用您手动查询/更新处理的连接运行现有 Java（用于测试）：根据执行情况返回适当的结果集、更新计数或警告。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-30T05:39:07.243

我们现在正在工作中创建一个数据库测试环境。我们觉得我们必须使用带有*模拟数据的**真实*数据库管理系统。模拟 DBMS 的一个问题是 SQL 从未真正完全成为标准，因此人工测试环境必须忠实地支持我们生产数据库的方言。另一个问题是我们广泛使用了列值约束、外键约束和唯一约束，并且由于人工工具可能无法实现这些，我们的单元测试可以通过，但我们的系统测试在第一次遇到实际情况时会失败约束。如果测试花费的时间太长，这表明实现错误，我们将调整我们的查询（通常测试数据集与生产相比是微不足道的）。

 *我们在每台开发人员机器和我们的持续集成和测试服务器（我们使用 Hudson）上安装了一个真正的 DBMS。我不知道您的工作政策限制是什么，但是安装和使用 PostgreSQL、MySQL 和 Oracle XE 非常容易。这些都是免费供开发使用（甚至是 Oracle XE），所以没有合理的理由禁止它们的使用。

关键问题是如何保证您的测试始终以数据库处于一致状态开始？如果测试都是只读的，没问题。如果您可以设计变异测试以始终在从不提交的事务中运行，那没问题。但通常您需要担心逆转更新。为此，您可以将初始状态导出到文件，然后在测试后将其导入回来（Oracle 的 exp 和 imp shell 命令执行此操作）。或者您可以使用检查点/回滚。但更优雅的方法是使用[dbunit 之](http://dbunit.sourceforge.net/)类的工具，它对我们很有效。

这样做的关键优势是我们可以提前捕获更多的错误，这些错误更容易修复，并且当开发人员狂热地尝试调试问题时，我们的真实系统测试不会被阻塞。这意味着我们可以更快、更省力地生成更好的代码。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-30T15:04:36.837

我同意班乔利。建立隔离的开发和测试环境应该是一个高优先级。我使用的每个数据库系统要么是开源的，要么具有可以安装在本地工作站上的免费开发人员版本。这使您可以针对与生产相同的数据库方言进行开发，为您提供对开发数据库的完全管理员访问权限，并且比使用远程服务器更快。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-03-11T12:41:20.153

尝试使用[derby](http://db.apache.org/derby/)。它简单便携。使用 Hibernate，您的应用程序变得灵活。测试德比，生产任何你喜欢和信任的东西。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2018-04-10T12:14:05.780

[jOOQ](https://www.jooq.org)是一个工具，除了提供 SQL 抽象之外，还内置了一些小工具，例如允许模拟整个 JDBC 的 SPI。[这可以通过本博客文章中记录的两种方式起作用](https://blog.jooq.org/2018/04/10/mocking-jdbc-using-a-set-of-sql-string-result-pairs/)：

### 通过实现`MockDataProvider`SPI：

```
// context contains the SQL string and bind variables, etc.
MockDataProvider provider = context -> {

    // This defines the update counts, result sets, etc.
    // depending on the context above.
    return new MockResult[] { ... }
}; 
```

在上述实现中，您可以通过编程方式拦截每条 SQL 语句并为其返回结果，甚至可以动态地通过“解析”SQL 字符串来提取一些谓词/表信息等。

### 通过使用更简单（但功能较弱）`MockFileDatabase`

...其格式如下（一组语句/结果对）：

```
select first_name, last_name from actor;
> first_name last_name
> ---------- ---------
> GINA       DEGENERES
> WALTER     TORN     
> MARY       KEITEL   
@ rows: 3 
```

然后可以按如下方式读取和使用上述文件：

```
import static java.lang.System.out;
import java.sql.*;
import org.jooq.tools.jdbc.*;

public class Mocking {
    public static void main(String[] args) throws Exception {
        MockDataProvider db = new MockFileDatabase(
            Mocking.class.getResourceAsStream("/mocking.txt");

        try (Connection c = new MockConnection(db));
            Statement s = c.createStatement()) {

            out.println("Actors:");
            out.println("-------");
            try (ResultSet rs = s.executeQuery(
                "select first_name, last_name from actor")) {
                while (rs.next())
                    out.println(rs.getString(1) 
                        + " " + rs.getString(2));
            }
        }
    }
} 
```

请注意我们如何直接使用 JDBC API，而不实际连接到任何数据库。

请注意，我为 jOOQ 的供应商工作，所以这个答案是有偏见的。

### 请注意，在某些时候，您正在实现整个数据库

以上适用于简单的情况。但请注意，最终您将实现整个数据库。你要：

> 1.  验证 SQL 语法。

好的，通过如上所示模拟数据库，您可以“验证”语法，因为您在上面列出的*确切*版本中没有预见到的每个语法都将被任何此类模拟方法拒绝。

您可以实现一个解析 SQL 的解析器（[或者再次使用 jOOQ 的](https://www.jooq.org/doc/latest/manual/sql-building/sql-parser/)），然后将 SQL 语句转换为您可以更容易识别并为其生成结果的东西。但归根结底，这只是意味着实现整个数据库。

> 2.  更重要的是，根据给定的情况检查数据是否被正确选择/更新/插入。

这使事情变得更加困难。如果您运行插入然后更新，结果显然不同于先更新，然后插入，因为更新可能会也可能不会影响插入的行。

您如何确保在“模拟”数据库时发生这种情况？您需要一个状态机来记住每个“模拟”表的状态。换句话说，您将实现一个数据库。

### 嘲讽只会带你到这一步

正如[piotrek 所](https://stackoverflow.com/a/46206974/521799)提到的，嘲弄只会带你到这一步。当您只需要拦截一些非常知名的查询时，它在简单的情况下很有用。如果您想模拟整个系统的数据库，这是不可能的。在这种情况下，请使用实际的数据库，最好是您在生产中使用的相同产品。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2018-04-02T10:32:59.620

您可以使用 HSQLDB 进行内存数据库测试。启动内存数据库并在其上运行测试非常简单。
[http://hsqldb.org/](http://hsqldb.org/)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-05-30T03:44:54.833

首先，您是否使用任何 ORM 层进行数据库访问？
如果不是：那么您的想法将毫无用处。当您不确定您正在触发的 SQL 是否可以在生产中与您的数据库一起使用时，测试有什么用，就像您在使用其他东西的测试用例中一样。
如果是：那么您可以查看指出的各种选项。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-06-23T04:26:05.787

H2 数据库

“许多 Java 开发人员最喜欢的集成测试数据库。”

（Hypersonic 变成了 HSQLDB，改写为 H2）

[https://blog.jooq.org/2015/08/18/jooq-tuesdays-thomas-muller-unveils-how-hsqldb-evolved-into-the-popular-h2-database/](https://blog.jooq.org/2015/08/18/jooq-tuesdays-thomas-muller-unveils-how-hsqldb-evolved-into-the-popular-h2-database/)

# php - 如何保存某个网站正在输出的 xml 的本地副本

> ID：928767
> 
> 赞同：0
> 
> 时间：2009-05-30T01:56:56.697
> 
> 标签：php

我想保存某个网站输出的 xml 的本地副本，每次我更改网站的 URL 以获取另一个 xml 副本时，它都会覆盖从以前的网站保存的文件，我该如何在 php 中执行此操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T03:23:29.300

```
$xml = file_get_contents('http://example.com/file.xml');
file_put_contents('file.xml', $xml); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T02:36:58.257

谢谢！如果生成的 URL 的 xml 非常大，大约 50MB，那么使用该脚本是否有问题？

这是我的代码，请看一下告诉我是否可以。

```
$url = "http://projects.com/read.php";
$fp = fopen($url, 'r'); 
if ($fp) {
    while (!feof($fp))
        $buffer .= fgets($fp, 1024);
    fclose($fp);
    file_put_contents('file.xml', $buffer);
} else {
    echo 'Could not connect to: ' . htmlentities($url) . '<br />';
    echo 'Error #' . $err_num.': ' . $err_msg;
    exit;
} 
```

# java - Hibernate 是否需要 Java EE

> ID：928769
> 
> 赞同：3
> 
> 时间：2009-05-30T01:59:06.083
> 
> 标签：java, hibernate, jakarta-ee

运行 Hibernate 独立 Java 应用程序是否需要额外的 Java EE 库，或者标准 SDK 是否足够？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-30T02:14:28.300

Hibernate 在 Java SE 上运行良好。它可以用作 Java EE 上的 JPA 实现，但 JPA 也可以在 Java SE 上很好地使用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-30T03:19:49.603

运行 Hibernate 不需要 Java EE。我认为从 Hibernate 文档开始是一个很好的起点。我认为它非常直观且易于理解。
[http://docs.jboss.org/hibernate/stable/core/reference/en/html/tutorial-firstapp.html](http://docs.jboss.org/hibernate/stable/core/reference/en/html/tutorial-firstapp.html)

您还可以在此处找到要下载的 jar 文件： [https ://www.hibernate.org/344.html](https://www.hibernate.org/344.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-30T03:03:19.510

任何 JPA 提供者，包括 Hibernate，都可以在 Java EE 容器之外使用。在 ORM 与 SQL 中有一些提供程序的说明[：The JPA Story](http://www.cforcoding.com/2009/05/orms-vs-sql-jpa-story.html)。

# c++ - C ++代码获取文件行并读取该行的第二个单词？

> ID：928777
> 
> 赞同：1
> 
> 时间：2009-05-30T02:04:22.000
> 
> 标签：c++

```
#include <iostream>
#include <string>
#include <fstream>

using namespace std ;

string strWord( int index , string line)
{
       int count = 0;
       string word;
       for ( int i = 0 ; i < line.length(); i++)
       {
           if ( line[i] == ' ' )
           {
                if ( line [i+1] != ' ')
                {

                    count ++;
                    if (  count == index)
                    {
                       return word;
                    }
                    word ="";
                }
           }
           else
           {
                word += line[i];
           }       
       }
}

int main ( )
{
    ifstream inFile ;
    inFile.open("new.txt");
    string line  , id;

    cout <<"Enter id : ";
    cin >>id;
    while(!inFile.eof() )
    {
                        getline ( inFile , line );
                        if ( strWord ( 1, line ) == id ) 
                        {
                             cout <<strWord ( 2 , line ) <<endl;
                             break;
                        }
    } 
    system("pause");
} 
```

问题是：有人可以向我解释一下吗？我不明白它在做什么，我的意思是我明白了这个概念，但每行在做什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-30T08:46:02.173

你想要每一行的评论

```
// function that returns a word from 'line' with position 'index'
// note that this is not a zero based index, first word is 1,
// second is 2 etc ..
string strWord(int index, string line)
{
    int count = 0; // number of read words
    string word; // the resulting word
    for (int i = 0 ; i < line.length(); i++) { // iterate over all characters in 'line'
        if (line[i] == ' ') { // if this character is a space we might be done reading a word from 'line'
            if (line[i+1] != ' ') { // next character is not a space, so we are done reading a word
                count++; // increase number of read words
                if (count == index) { // was this the word we were looking for?
                    return word; // yes it was, so return it
                }
                word =""; // nope it wasn't .. so reset word and start over with the next one in 'line'
            }
        }
        else { // not a space .. so append the character to 'word'
           word += line[i];
        }       
    }
}

int main( ) // main function of the program, execution starts here
{
    ifstream inFile; // construct input file stream object
    inFile.open("new.txt"); // associate the stream with file named "new.txt"
    string line, id; // 

    cout << "Enter id : "; // write "Enter id :" to console
    cin >> id; // read input from console and put the result in 'id'

    while (!inFile.eof()) { // do the following as long as there is something to read from the file
        getline(inFile, line); // read a line from the file and put the value into 'line'
    if (strWord(1, line) == id) { // if the first word in 'line' equals 'id' ..
        cout << strWord(2, line) << endl; // prints the second word in 'line'
        break; // exits the while loop
    }
    } 

    system("pause"); // pause the program (should be avoided)
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-30T02:09:58.527

我没有仔细阅读，但看起来它打印出了第一个单词是用户输入的行的第二个单词。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-30T08:31:02.653

也许这有帮助：

```
// return word[index] from line
string strWord( int index , string line) // word index and actual line
{
  int count = 0; // current word index
  string word; // word buffer (return value)

  for ( int i = 0 ; i < line.length(); i++) // loop through each character in line
  {
    if ( line[i] == ' ' ) // if current character is a space
    {
      if ( line [i+1] != ' ')  // but next char is not space, we got a word
      {
        count ++; // incr current word index counter in line
        if (  count == index) // if count == looked for index return word
        {
          return word;
        }
        word ="";  // otherwise reset word buffer
      }
    }
    else // character is not space
    {
       word += line[i]; // add letter/digit to word buffer
    }       
  }
} 
```

例如，当行以空格开头时，上面的算法会失败，因此这里有许多关于需要解决的 in-data 假设，例如如果索引无效或 in-line 为空，则不进行处理。如果函数失败，也会丢失最后一个返回值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-30T02:23:32.337

你有 C++ 的交互式调试器吗？例如，如果您将此代码加载到 Microsoft Visual C++ 中，您可以一次单步执行一个语句，在执行过程中检查每个变量的值。这是了解新代码在细节级别的作用的好方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-30T02:48:26.110

有一个名为 strWord 的函数可以从句子中获取具有任何索引的单词并将其返回。

主程序打开一个文件，其中每行包含一个 id 和另一个单词，并准备好从中读取。

然后它向用户询问一个 id，检查该 id 是否是文件中任何行中的第一个单词。如果是，则从该行中取出第二个单词并打印出来。

就这样。询问您是否对特定线路或一堆线路有问题。

或者正如 Greg 建议的那样，使用调试器。这将是理解任何逻辑的最简单方法。

# php - 当我上传/复制图像时它失败，当我点击刷新/重新发送时它可以工作

> ID：928778
> 
> 赞同：0
> 
> 时间：2009-05-30T02:04:51.673
> 
> 标签：php, image, upload, copy

所以，我正在处理一个项目的一小部分，我正在上传一张图片，然后复制它以调整大小。发生的事情是，当我单击提交上传时，它会失败，但如果我点击刷新/重新发送信息，它会成功......

```
 $uploadFile = $uploadDir . $imageName;
    $imageName2 = $front[0]."_large\.".$front[1];
    $uploadFile2 = $uploadDir . $imageName2;

        if(move_uploaded_file($imageTemp,$uploadFile))
       {
           if(!copy($uploadFile, $uploadFile2)) die("Can't copy $uploadFile2");
           } 
```

它失败时输出的是“无法复制”所以，由于某种原因，在我点击刷新之前它没有得到要复制的文件的名称？

列维

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T09:53:09.337

您的意思是转义 $front[0]."_large\.".$front[1]; 中的点吗？你在想一个正则表达式吗？如果不是，这可能会尝试保存到不存在的目录中。

您是否尝试过上传另一个文件，您可以 print_r() $_FILES 数组吗？在弄清楚为什么 $_FILES 数组为空并且我的表单标签中没有多部分表单数据或图像已损坏之前，我一直被卡住了由php剪切的上传流。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-06T11:50:04.087

下面对我来说很好；

HTML 文件：

```
<!DOCTYPE html>
<html>
<title>Stack HTML</title>
<link rel="stylesheet" href="../../repo/css/bootstrap.css" type="text/css" />
<script src="https://code.jquery.com/jquery-2.1.3.js"></script>
<head>
</head>
<body>
    <div class="container">
        <form method="post" action="resize.php" enctype="multipart/form-data">
            <input type="file" name="image" />
            <input type="submit" name="add" value="Add" />
        </form>
    </div>
</body>
</html> 
```

调整大小.php

```
<?php
    $uploadDir = 'uploads/';
    $uploadLargeDir = 'uploads/large/';

    $imageName = $_FILES['image']['name'];
    $imageTemp = $_FILES['image']['tmp_name'];
    $uploadFile = $uploadDir . $imageName;

    if(move_uploaded_file($imageTemp,$uploadFile)) {
        $front = explode('.', $imageName);
        $imageName2 = $front[0]."_large.".$front[1];
        $uploadFile2 = $uploadLargeDir . $imageName;
         if(!copy($uploadFile, $uploadFile2)) {
            die("Can't copy $uploadFile2");
         } else {
            die('Levi! Success');
         }
    }
?> 
```

# javascript - jQuery/Javascript - 当按钮的值改变时如何触发事件？

> ID：928781
> 
> 赞同：1
> 
> 时间：2009-05-30T02:08:14.380
> 
> 标签：javascript, jquery, elements, connect

我正在开发一个用于 jQuery 的插件，它本质上会为某些元素设置样式。像 jqTransform 一样，我可以只替换元素，但我选择将真实元素放置在屏幕外并制作一个新元素，即样式。这允许触发真实元素的实际事件。此外，如果存在文本框的 onclick 处理程序或 onchange 处理程序，jqTransform 将不包含该处理程序，而通过这种方式，它将包含它。

这是我的问题。假设用户有一个按钮。稍后在应用程序中，用户决定更改按钮的值。它将更改原始按钮的值，但不会更改样式按钮。有什么方法可以连接元素，以便如果原始按钮的值发生更改，样式按钮的值也会更改？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-30T02:29:31.013

您可以使用 onpropertychanged 事件捕获对象的任何属性更改。

```
$("#buttonid").bind('propertychange', function(e) {
    if (e.originalEvent.propertyName == "value") {
       // value is changed, handle it here      
    }
}); 
```

# php - 无法理解 Firephp

> ID：928795
> 
> 赞同：1
> 
> 时间：2009-05-30T02:15:42.120
> 
> 标签：php, debugging, firephp

我不明白[FirePhp](http://www.firephp.org/) FirePhp 是 Firefox 插件 Firebug 的扩展。

我不明白为什么要使用它。这个工具怎么能比你日常的 PHP 调试器给我更多的东西呢？严重地？我不明白如何实现这一点，有人可以解释一下......也许有旁白的视频？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-30T02:36:25.883

*在深度解说员语音* 中，FirePHP 只需一点点工作，就可以让您将信息发送到 firebug 控制台。可以*比较*详细。有关它的最佳信息，请参阅[http://www.christophdorn.com/Blog/2009/04/03/how-to-integrate-firephp-for-ajax-development/ 。](http://www.christophdorn.com/Blog/2009/04/03/how-to-integrate-firephp-for-ajax-development/)它比其他调试工具好吗？值得商榷。老实说，我并没有真正使用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-30T02:38:19.593

根据我所读到的内容：假设您想知道 PHP 脚本中某个随机变量的值。您的服务器会发送一个包含该信息的特殊标头，Firebug 会读取它。该过程的优点是实际响应（不包括标头）是相同的，因此您可以保持相同的响应处理代码。我想它使 Ajax 的 PHP 脚本更容易调试。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-22T21:26:44.527

firephp 的杀手级应用是调试 AJAX 调用。PHP 在响应头中发回调试信息，然后 firephp 插件将其显示，附加到控制台。

所以，你有你的客户端 javascript 输出它在做什么，你可以看到 PHP 端输出它在做什么，你可以看到一个混合的、有序的“跟踪”（因为缺乏更好的术语）你之间的交互javascript 和你的 php。

上个月我做了一个关于我上个月如何使用 firephp 的快速演示。这不是您想要的视频，但是... [http://links.creuzer.com/chfgq](http://links.creuzer.com/chfgq)

# seo - 域名转发和seo

> ID：928800
> 
> 赞同：0
> 
> 时间：2009-05-30T02:19:00.367
> 
> 标签：seo, dns, forwarding

我希望[http://mynewdomain.com](http://mynewdomain.com)带有掩码转发到[http://mysecretdomain.com/mynewsite](http://mysecretdomain.com/mynewsite)。当用户输入[http://mynewdomain.com/aboutus.html](http://mynewdomain.com/aboutus.html)时，他应该会看到[http://mysecretdomain.com/mynewsite/aboutus.html](http://mysecretdomain.com/mynewsite/aboutus.html)的内容。

我不希望公众知道[http://mysecretdomain.com](http://mysecretdomain.com)。

我使用转发和屏蔽的方式会对 SEO 产生负面影响吗？

通过使用域转发和屏蔽，人们是否会意识到 mysecretdomain.com 的危险？（即，用户会发现 mynewdomain.com 和 mysecretdomain.com 之间的关系吗？）

## 额外细节

非常重要的是，没有人发现[http://mysecretdomain.com/mynewsite](http://mysecretdomain.com/mynewsite)域和目录，尽管它托管了所有内容。我必须做任何事情来确保这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T03:06:28.617

为什么不将您的秘密域映射到主机上的 ~/www 目录，并将新域映射到 ~/www/newdomain？然后，当您访问 mysecretdomain.com/newdomain/ 时，它会在 ~/www/newdomain/... 中查找您所描述的内容，没有重定向。

也许我不明白你在这里的目标。

# python - 如何在 Python 中访问对象的类的名称？

> ID：928806
> 
> 赞同：1
> 
> 时间：2009-05-30T02:21:11.890
> 
> 标签：python

标题主要是这样说的。

如果我在 Python 中有一个对象并且想要访问它实例化的类的名称，是否有标准的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-30T02:23:00.200

```
obj.__class__.__name__ 
```

# connection-string - 连接到 .MDF 的连接字符串

> ID：928813
> 
> 赞同：18
> 
> 时间：2009-05-30T02:23:41.527
> 
> 标签：connection-string, sql-server-express, mdf, datadirectory

我在 VS2008 中创建了一个新项目，并在项目中添加了一个 .MDF 文件。这是我第一次尝试使用 MDF 文件和 .SQLEXPRESS 数据库（过去我一直使用外部 Oracle 服务器）。

我正在尝试记录所有内容，但我无法弄清楚正在使用哪些凭据连接到 .MDF 文件。有没有简单的方法可以找出来？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-05-30T02:33:20.943

如果您正在使用 ASP.NET 应用程序的 App_Data 文件夹中的 *.mdf 文件，则可以使用它。

> 服务器=.\SQLExpress;AttachDbFilename=|DataDirectory|mydbfile.mdf;数据库=dbname; Trusted_Connection=是；

如果它不是 ASP.NET 应用程序，请不要使用 DataDirectory 语法，而只需使用完整的 c:\... 路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-10-16T20:43:29.740

这个名字来自哪里 mydbfile ？

如果您正在使用 ASP.NET 应用程序的 App_Data 文件夹中的 *.mdf 文件，则可以使用它。

```
Server=.\SQLExpress;AttachDbFilename=|DataDirectory|**mydbfile**.mdf;Database=dbname; Trusted_Connection=Yes; 
```

如果它不是 ASP.NET 应用程序，请不要使用 DataDirectory 语法，而只需使用完整的 c:... 路径。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-05-31T15:11:08.420

对于本地数据库且没有 SQLEXPRESS 服务器：

```
"Data Source=(LocalDB)\MSSQLLocalDB;AttachDbFilename=""|DataDirectory|\MyDB.mdf"";Integrated Security=True;Connect Timeout=30" 
```

# c++ - 此多线程用例的最佳数据结构：侵入式列表好吗？

> ID：928827
> 
> 赞同：2
> 
> 时间：2009-05-30T02:30:12.590
> 
> 标签：c++, multithreading, boost, thread-safety

我需要设计一个支持以下操作的数据结构：

*   基于作为间隔的键在数据结构中搜索元素。例如，区间 1-5 内的值可能是 3，区间 6-11 内的值可能是 5，依此类推。间隔是连续的，它们之间没有重叠。
*   查找上一个和下一个间隔 - 这几乎与搜索间隔一样频繁。
*   分割区间，加入连续区间
*   并发性：我已将设计限制为一个编写器线程和其他读取器线程，如下所示。编写器线程可以拆分或连接区间，或修改区间中的值。任何读取器线程仅在一个时间间隔内读取值（读取器可能读取多个时间间隔，但我不必序列化所有读取 - 在两次读取之间进行写入是可以的）。每个读取器每次写入大约有 20-80 次读取。此外，我仍然需要确定读者人数，但应该是 2-8 人左右。

我考虑使用 list 在中间添加和删除元素。只有有限数量的间隔 - 所以使用 map 可能是不正确的。这种访问（一个写入器，多个读取器）不受 STL 列表的良好支持。boost::intrusive::list 似乎合适。在侵入性列表的顶部，我将不得不获取锁来读/写间隔。

此外，我了解侵入式列表可用于比 STL 列表更好的缓存位置（以及为包含的对象分配适当的内存）。

方法好吗？如果是，我也很想知道您使用 intrusive::list 的经验，特别是对于多线程应用程序。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-30T13:25:36.150

您在这里有两个不同的问题：

1.  如何表示你的数据结构
2.  如何以高效的方式使其线程安全

您的数据结构将为每次写入执行 (20-80) x (2-8) 次读取。

(1)。首先，假设您的范围是如下数据结构

```
 struct Interval
    {
        Interval(int start, int length)
          : m_start(start),
            m_length(length)
        {}
        int m_start;
        int m_length;
        int value; // Or whatever
    }; 
```

 `Since reads massively outnumber writes, lookup needs to be fast, while modifications don't.

Using a list for your data structure means O(N) lookups and O(1) modification - exactly the wrong way around.

The simplest possible representation of your structure is a vector. If the intervals are held in sorted order, lookups are O(logN) and modifications are O(N).

To implement this, just add a comparator to Interval:

```
bool operator<(const Interval& rhs) const
{
    return m_start < rhs.m_start;
} 
```

You can then use `std::lower_bound` to find the first interval equal or lower to your search interval in O(logN).

Next and previous interval are O(1) - decrement or increment the returned iterator.

Splitting an interval means inserting a new element after the current one and adjusting the length of the current - O(N).

Joining two intervals means adding the length of the next one to the current one and erasing the next one - O(N).

You should `reserve()` enough space in the vector for the maximum number of elements to minimise resizing overhead.

(2). Following Knuth, '*premature optimisation is the root of all evil*'.` 

`A single read/write lock on the structure holding your vector<Interval>`很可能就足够了。唯一可能的问题是（2a）由于读者独占锁而导致写入者饥饿，或（2b）由于写入者更新花费太长时间而导致读取者饥饿。

(2a) 如果（且仅当）您面临作家饥饿，您可以使锁定更加精细。不过，这种情况*极*有可能不会发生。去做这个：

使您的向量通过指针而不是值保持其间隔。这样调整大小就不会在内存中移动对象。让每个间隔都包含一个读/写锁。

对于读取：获取集合的读取锁，然后获取所需的时间间隔。如果您不需要读取任何其他区间，请在获得区间锁后立即放弃集合锁，以允许其他线程继续执行。

如果您需要读取其他存储桶，您可以按任何顺序对它们进行读锁定，直到您放弃集合读锁定，此时写入器可以添加或删除您尚未锁定的任何间隔。获取这些锁时顺序无关紧要，因为当您持有集合上的读锁时，作者无法更改向量，并且读锁不会竞争。

对于写入：

获取集合的写锁，然后获取所需的时间间隔。请注意，对于将添加或删除间隔的所有更新，您必须持有集合写锁。如果您只更新一个间隔，您可以放弃收集锁。否则，您需要持有写锁并在您将要修改的任何时间间隔上获取写锁。您可以按任何顺序获取间隔锁，因为没有集合锁，没有读者可以获取新的读锁。

上述工作对作者线程更加自私，这应该消除饥饿。

(2b) 如果您面临读者饥饿（这种情况更不可能），最好的解决方案是将集合写入和读取分开。通过共享指针持有集合，并对其有一个写锁。

对于读取：获取写入锁和 shared_ptr 的副本。放弃写锁。读者现在可以在没有任何锁的情况下读取集合（它是不可变的）。

对于写入：根据读者将 shared_ptr 带到集合中，放弃锁定。制作集合的私有副本并对其进行修改（因为它是私有副本，所以不需要锁定）。再次获取写锁并将现有的 shared_ptr 替换为您的新集合。完成旧集合的最后一个线程将销毁它。所有未来的线程都将使用新更新的集合。

请注意，根据您的问题描述，此算法仅适用于一位作家。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T02:38:04.803

并发二叉树可能是一个很好的选择，它允许对不同间隔的读取和写入并行进行。

# linux - 重新定义信号处理缺陷

> ID：928829
> 
> 赞同：1
> 
> 时间：2009-05-30T02:31:46.597
> 
> 标签：linux, ipc, posix, signals

这是关于设计决策并了解采用其他服务的利弊。所以我们有两个服务和两个不相关的服务器，一个监听端口 10000，另一个是 xinetd 服务器通过 3 个不同的端口响应 3 个不同的请求（它的客户端使用 nc 服务器端口 1|端口 2|端口 3 来检索数据）。

有一天，因为安全问题，xinetd 服务器不得不停止，因为第一台服务器保留了相同的数据，我们决定采用 xinetd 服务器，向第一台服务器发送 USR1 信号，让它暴露相同的公共数据。因此，需要添加逻辑来重新定义第一台服务器中的信号处理。我们计划使用 USR1 (10, 16, 30) 例如，在 xinetd 服务器中， kill -10 first_server 会让第一台服务器吐出与旧服务器过去发出的相同的数据，并且仍然转储到第一个端口. 争论是这是一个糟糕的设计，因为它滥用了 unix 信号使用，当然还重新定义了 POXIS 和 Linux 预定义的 10、16 和 30 符号行为。这在技术上真的很糟糕吗？会对系统造成什么危害？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T02:53:07.690

10 是 SIGBUS，一个总线错误——你可能不应该碰那个。30 和 31 是 SIGUSR1 和 SIGUSR2，它们是用户定义的，不为任何特定目的保留。16 是 SIGURG，socket 上的紧急数据，你可能不需要，但最好使用 31 以上的实时信号。

# sql-server - 如何解决死锁问题？

> ID：928830
> 
> 赞同：9
> 
> 时间：2009-05-30T02:32:05.080
> 
> 标签：sql-server, sql-server-2005

我读过这个死锁问题当数据库表开始累积数千行并且许多用户开始同时在同一个表上工作时，表上的 SELECT 查询开始产生锁争用和事务死锁。

这个死锁问题是否与 TransactNo updlock 有关？如果你知道这个问题，请告诉我。提前致谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-14T20:00:29.217

发生死锁的原因有很多，有时解决死锁问题更像是一门艺术，而不是一门科学。

在普通 SQL Profiler 之外，我用来查找和消除死锁的是一个轻量级工具，它可以在死锁发生时提供死锁的图形描述。当您看到死锁时，您可以向下钻取并获取有价值的信息。死锁检测器——http: [//www.sqlsolutions.com/products/sql-deadlock-detector](http://www.sqlsolutions.com/products/sql-deadlock-detector)

这是一个简单的工具，但对我来说，它完全可以做它应该做的事情。有一件事：我第一次使用它时，我不得不等待 15 分钟，以便该工具收集足够的指标以开始显示死锁。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-31T21:32:27.140

高隔离的一个常见问题是由于以下情况导致的~~锁升级死锁；~~即（其中 X 是任何资源，例如一行）

*   SPID a 读取 X - 获得读锁
*   SPID b 读取 X - 获得读锁
*   SPID a 尝试更新 X - 被 b 的读锁阻塞，因此必须等待
*   SPID b 尝试更新 X - 被 a 的读锁阻塞，因此必须等待

僵局！这种情况可以通过使用*更多*的锁来避免：

*   SPID a 读取`(UPDLOCK)`指定的 X - 获得排他锁
*   SPID b 尝试读取 X - 被 a 的排他锁阻塞，因此必须等待
*   SPID a 尝试更新 X - 很好
*   ...（SPID 提交/回滚，并在某个时候释放锁）
*   ...（SPID b 做它想做的任何事情）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-31T19:10:20.623

发生僵局的原因有很多，所以如果你想得到帮助并告诉我们导致僵局的原因，你必须先做一些功课，即。执行死锁时涉及哪些批次，涉及哪些资源等等。[Profiler 死锁事件图](http://code.msdn.microsoft.com/SQLExamples/Wiki/View.aspx?title=Troubleshoot%20Deadlocking%20in%20SQL%20Server%202005%20using%20Profiler&referringTitle=Home)始终是开始调查的好地方。

如果我在黑暗中冒险，会发生什么情况是您的查询和索引没有正确调整，因此您的大多数读取操作（可能还有一些写入）都是全表扫描，因此保证会与更新发生冲突。这可能会导致[按索引访问](http://rusanu.com/2009/05/16/readwrite-deadlock/)顺序的死锁、按操作顺序的死锁、按升级的死锁等等。

一旦确定了死锁的原因，就可以采取适当的措施来消除它。采取脏读的正确措施是极其罕见的。

顺便说一句，我不确定您所说的“TransactNo updlock”是什么意思。您是否特别询问[U 锁的 SU/US 不对称性](http://rusanu.com/2008/04/09/chained-updates/)？

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-30T02:56:52.847

您没有提供足够的信息来直接回答您的问题。

但是大多数锁定和阻塞可以通过使用“正确”索引来覆盖查询工作负载来减少（甚至消除）。

由于您安排了定期索引维护工作？

如果您的`SELECT`s 不需要 100% 准确（即允许脏读等），那么您可以运行一些`SELECTS`with `WITH(NOLOCK)`，这与 READ UNCOMMITED 的隔离级别相同。请注意：我并不是建议您`WITH(NOLOCK)`到处放置；只是在那些不需要 100% 完整数据的 SELECTS 上。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-01T19:44:12.237

我将把我自己的文章和帖子加入到关于死锁的组合中：

[https://www.sqlskills.com/blogs/jonathan/category/deadlock/](https://www.sqlskills.com/blogs/jonathan/category/deadlock/)

我还有一系列关于 JumpstartTv.com 上的死锁故障排除视频：

[http://jumpstarttv.com/profiles/1379/Jonathan-Kehayias.aspx](http://jumpstarttv.com/profiles/1379/Jonathan-Kehayias.aspx)

死锁可能很难解决，但除非您发布您的死锁图表信息，否则我们除了提供帖子链接和解决死锁的信息外，别无他法。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-31T21:28:20.907

“死锁故障排除，第 1 部分”

[http://blogs.msdn.com/bartd/archive/2006/09/09/Deadlock-Troubleshooting_2C00_-Part-1.aspx](http://blogs.msdn.com/bartd/archive/2006/09/09/Deadlock-Troubleshooting_2C00_-Part-1.aspx)

“当索引覆盖防止死锁时”

[http://sqlblog.com/blogs/alexander_kuznetsov/archive/2008/05/03/when-index-covering-prevents-deadlocks.aspx](http://sqlblog.com/blogs/alexander_kuznetsov/archive/2008/05/03/when-index-covering-prevents-deadlocks.aspx)

# objective-c - 如何学习 C 和 Objective-C

> ID：928833
> 
> 赞同：23
> 
> 时间：2009-05-30T02:33:26.640
> 
> 标签：objective-c, c

我正在学习编程。我计划今年夏天学习 C 和 Objective-C。我买了 C for Dummies 书，但这完全是浪费时间。页面太多了！有什么值得我读的好书吗？还是我应该从网站上学习 C？什么是最快的方法，因为我真的想快速学习它并开始学习 Objective-C。

谢谢

另外，学习C需要多长时间？直到我转向 Objective-C 2.0

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-30T03:19:31.240

**没必要着急。按照自己的节奏学习并找到最佳的学习方式。**

如果阅读是你的事，那么试着读一些书，慢慢来。

如果你找到了一个你掌握的概念，那就去练习。如果您发现一个您不太了解的概念，请进行实验。一旦你认为你理解了这个概念，试着重新阅读材料，看看你是否理解了第二遍。

我发现我并不是很擅长通过书本学习——我通常必须在课堂上通过结构化的课程开始学习。在一所社区大学的一门关于 Java 的学期课程能够推动我自己开始有效学习的方向。查看您的学校是否提供任何编程课程。

（虽然在你这个年纪可能有点难找——直到社区大学我才上过任何正式的课程——我的高中没有提供任何编程课程。）

**需要注意的一件事是以错误的方式学习它。**

匆匆浏览材料或阅读写得不好、不准确的学习材料可能会导致您需要“取消学习”这些概念并以正确的方式重新学习它。

在这方面，K&R 书（ Kernighan 和 Ritchie[的 The C Programming Language](http://en.wikipedia.org/wiki/The_C_Programming_Language_(book))）将是学习的“正确方式”，但它不是一本很容易理解的书。这并不是说它是关于 C 的权威书籍——但即使在用 C 编程了几年之后，我仍然尝试一次读一口。

但话又说回来，我真的想不出其他学习 C 的“好”资源。我的建议是看一下 K&R，一次学习几页。不要想像阅读普通书一样阅读它——阅读一个部分，尝试一下。一点一点地做。再说一次，不要着急。按照自己的速度工作。

**并且一定要写代码。**如果没有看到它工作，学习编程将变得很困难。并且一开始不要抱太大的期望，因为一开始学习 C 的大部分将涉及仅处理文本的程序。

一旦你掌握了一些事情，试着编写别人可读的干净代码——这应该是编写干净和清晰代码的动力，它会迫使你更加努力地思考你在做什么。

这将是一场漫长的冒险，所以一步一步来。祝你好运！

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-30T03:04:03.113

对于学习 C，我强烈推荐Dave Mark[*在 Mac 上学习 C。*](http://www.apress.com/book/view/1430218096)它不仅针对初学者，而且还教您很多关于编程和计算机科学的重要基础知识（例如数据结构、递归等）。它非常易于访问，编写良好且易于阅读。另外，我发现这些例子很有吸引力并且很有趣。在那之后，如果你真的想巩固你的 C 基础，我建议你尝试继续[*学习 C 编程语言*](https://rads.stackoverflow.com/amzn/click/com/0131103628)。这是一本具有挑战性的书，所以请慢慢阅读。如果您发现自己在这方面遇到了太多麻烦，我会说您可以直接跳到 Objective-C，然后在您对一般编程更加熟悉之后再回到*C 编程语言。*

很多人可能会推荐*The C Programming Language*（又名“K&R”）作为您阅读 C 的第一本书。毫无疑问，这是一本写得非常好的 C 书（而且它也很短——只有大约 200 页），但是我会说，作为一个 12 岁的孩子第一次接触 C 会有点吓人：它非常密集和硬核。您可以看出它绝对是针对具有计算机/工程背景的年长观众的。但是，如果您已经了解编程的基础知识，阅读 K&R 将为您提供对 C 的宝贵见解和理解。您绝对应该在您的编程工作中的某个时候阅读它。

无论如何，对于 Objective-C，如果我只能推荐一本书，那肯定是Aaron Hillegass 的[*Cocoa Programming for Mac OS X*](https://rads.stackoverflow.com/amzn/click/com/0321503619)。它真的没有那么长（大约 400 页左右，虽然我认为其中很多是由于书中插图的数量），而且您可以在一个下午启动并运行一些非常酷的项目。它非常清晰易读，示例实用且有趣，但最重要的是，它既不会太吓人，又能设法为您提供可靠的信息。另外，它会教给你的不仅仅是 Objective-C：我发现我学到了一些非常有用的设计模式，例如，通过学习 Cocoa 的一些组件是如何工作的。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-30T02:48:11.990

当我看到这个问题的标题时，我猜你是 12 岁。

我 13 岁时开始编程（我现在 14 岁）。

我发现学习取决于你是什么样的学习者！

我讨厌阅读，我有飞蛾般的注意力，而且我从视频中学习得最好。因此，我是一个“视觉学习者”。试着找出你是什么样的“学习者”，然后那样做。请记住，最简单的方法是最快的。

PS，这里有一个小技巧。这可能令人沮丧（在我们这个年龄无菌）。如果你感到沮丧，就把它放下大约 10 分钟。然后回来研究你的学习内容。编程有时会变得非常令人沮丧。

**编辑：** 顺便说一句，我喜欢通过视频学习：p

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-06-08T08:40:03.317

[斯坦福大学在线发布CS193P](http://www.stanford.edu/class/cs193p/cgi-bin/index.php)（iPhone 开发课程）的讲座、课堂笔记和作业。如果您根本不了解 C 或 Objective-C，可能会很难，但如果您打算进行 iPhone 开发，我强烈建议您这样做。

我想我已经阅读了所有 Cocoa 和 Objective-C 的书籍，并且最喜欢 Aaron Hillegass 的[Cocoa Programming for Mac OS X](https://rads.stackoverflow.com/amzn/click/com/0321503619)。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-30T02:52:11.173

我会看看[The C Programming Language (K&R C)](http://en.wikipedia.org/wiki/K%26R_C)。它不到 1000 页，我认为您会发现它*非常*值得您花时间阅读。正如 htw 所说，书籍确实有一个目的，因为它们提供了一种彻底和结构化的方法。特别是 K&R C 将直接从 C 的创建者那里为您提供真正的洞察力。

这并不是说您不应该使用 Google 搜索、阅读开源代码、编写小练习程序等。这一切都有帮助。只要记住要有耐心。那里有*很多*。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-30T03:04:13.660

查看[http://www.cprogramming.com/](http://www.cprogramming.com/)或[在线 K&R 类型书](http://www.iu.hio.no/~mark/CTutorial/CTutorial.html)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-30T02:53:34.303

不要急躁；慢慢来。遵循教程，剖析简短的代码片段，您将掌握该语言的窍门。最重要的是，自己编写代码并从错误/错误中学习。

并关注堆栈溢出；）

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-30T05:48:00.473

没有什么比你可以运行和调整的一段代码更有教育意义了。书中的代码示例可能非常乏味且不太适用。这条规则的例外是 Perl Cookbook，它挤满了对你的 perl 程序非常有用的小片段。

其中的主题（或“成语”）非常有用，并且适用于各种语言，以至于一些聪明的人已经将它们复制到不同的语言中。每个都有不同程度的完整性，但有趣的是看看不同的语言如何做同样的事情。

在这里查看[http://pleac.sourceforge.net/](http://pleac.sourceforge.net/)，了解您可以动摇的编程智慧。至少有趣的是，用一种语言编写的简单事物需要用另一种语言编写大量代码。

如果我再次开始学习编程，我可能会选择一些简单而宽容的东西，一种动态语言，如 Python、Ruby 等。一旦你掌握了其中一种（流控制、数据结构等）的基础知识，它就会使学习变得更好C/Objective-C 就容易多了。此外，您会发现您需要编写一次性工具和脚本来帮助您进行 Objective-C 开发，用 C 语言编写这将是乏味且耗时的，但在现代动态语言中只是几行代码。带上另一个工具永远不会有什么坏处。

祝你好运

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-30T05:13:59.807

我一直在你所在的地方。这不好玩。这就是拯救我的原因：

（显然新用户不允许发布超链接，所以谷歌搜索“史蒂夫峰会C”，使用第一个或第三个链接，然后点击“介绍性C编程课堂笔记”）

这是一个名叫史蒂夫萨米特的人的C班。超级容易理解，比 K&R 容易得多，imo。此外，它是免费的，没有任何广告。我爱它。这就是我学习 C 的方式。我希望它对你也一样。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-06-03T13:53:59.820

老实说，我学习 Java 作为我的第一门编程语言（我在高中时发现了它，并认为编程很有趣，这就是我想做的事）

我刚刚在几周内拿起了 Obj-C，从一些书中读了一点，但不是整本书，如果我无法弄清楚**语法**（程序的格式/语法），我会大量使用互联网应该结构化和编写）用于某事等。

**你能多快学会一门语言取决于你对编程基础的理解程度。随着时间和练习，你只会变得更好。**

如果您能够理解一般编程的基础知识，那么您应该能够将其应用于任何语言，困难的部分是学习和记住不同语言的语法。就像在 Java 中一样，您不必进行内存分配，但在 C、C++ 和 Obj-C 中则需要。我从未编写过 C 或 C++ 程序，但现在我已经学习并用 Obj-C 编写了一些程序（我一直在制作 iPhone 的东西，这很有趣）我确信我可以学习 C 和 C++好像什么都不是。

**你不必先学习 C 来学习 Obj-C 就是我想说的。但了解多种语言永远不会有坏处。**

这完全取决于您对程序如何工作以及如何构建程序的理解程度。我喜欢 Objective-C，因为它像 Java 一样面向对象，所以我更容易理解和快速学习，只需要习惯语法上的一些差异

（我现在也快从大学毕业了，所以我被编程的东西所包围，从像 ada 这样的过程语言到像 java 这样的面向对象，并且知道使程序工作的幕后细节，所以理解和学习一门新语言对我来说变得容易多了，你开始看到它们是如何关联和不关联的，这很酷）

很高兴你这么年轻就开始了。我相信你会很快掌握这些东西，如果它是你真正喜欢的东西，它会更容易。

祝你好运！玩得开心！编程是如此令人沮丧......就像，当你发现这是因为你的 if 语句使用了 grater than 而不是 grater than or equal 或类似的东西时，花了 3 个小时进行调试。但是，一旦你完成了这个程序，它是如此的有益，然后你只想让它变得越来越好哈哈。

我不知道这是否有帮助，我希望它有帮助，不知何故......

=)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-30T02:41:59.837

我学得最快的方法是观看简短的视频教程。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-05-30T02:56:27.967

如果您真的想从 C 开始，我会先阅读 C for Dummies 的前三章左右，以了解该语言的工作原理。之后，我建议阅读网络教程。好的网络教程会有简短的代码来解释特定的功能，等等。

不过，作为一个 13 岁的孩子，我建议从 PHP 开始。它是一种比 C 更容易学习的语言，但它基于 C，因此无论何时进行转换都不难。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-05-30T07:26:11.570

不同的人有不同的学习方式。您可以在上面的各种响应中看到这一点。

那么你喜欢怎样学习呢？你喜欢一个人坐着看书和电脑吗？你喜欢坐在教室里吸收学习吗？你喜欢固定练习还是迷你项目？

当我学习新的编程语言时，我发现如果我有一个小的应用程序或问题要处理，这对我很有帮助。我更喜欢有问题去解决。如果您有自己的一个小项目并且一直想做，那就使用它。如果没有，就像上面有人建议的那样，加入一个机器人小组。建立一个网页并编写一些程序来为此做一些事情。在网上寻找编程挑战。谷歌每年都有一个有趣的。

如果您想要一个想法，请编写一个 sukoku 检查程序。然后再写一个数独求解器！

我喜欢使用各种各样的书籍，而不是仅仅坚持上面建议的一两本书。找一本你喜欢风格的书。从库中尝试一些，直到找到一两个真正适合您的。

就个人而言，我喜欢 O'Reilly Publishing 的书籍，因为它们健谈且易读的风格。我是从 Deitel 学的 C，它更像是一本课堂风格的教科书，但它有很多例子和讨论点。

当您在计算机上处​​理示例时，您可能想知道如果调整代码会发生什么变化。通过首先运行文本中建议的示例代码，我学到了很多东西，然后更改它以查看会发生什么。如果我得到了我所期望的，这表明我的理解非常好。如果我得到了意想不到的东西，我会试着弄清楚我是如何误解了我所做的。

最后一个建议。为什么不从 Python 而不是 C 开始呢？我听说很多学校都在教他们的孩子 Python。我建议这样做的原因是：

Python 非常简单。您不必布置内存、声明变量等。没有繁琐的簿记。

Python 为您提供了一条不错的增长路径。您可以使用列表和字典等内置类型开始编写脚本风格的程序。然后，您可以根据需要使用新模块，并使用类进行面向对象的编码。里面也有一些函数式编程的东西，一旦你掌握了语言的基本机制，你就可以开始学习了。

我只是喜欢一直访问 python 的新部分。

你可以在 python 中完成很多工作。它带有大量内置模块，几乎可以做任何你喜欢的事情——电子邮件、网络、xml、图形、gui等。

:)

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-05-30T16:46:23.263

当我学习 C 编程时，我发现[Practical C Programming](http://oreilly.com/catalog/9781565923065/)是一个很好的资源。这是一本非常平易近人的书，有很多例子。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-05-30T02:36:45.960

在我看来，最快的方法是通过网站学习。

1.  设定你想做的目标并开始一个简单的项目
2.  与其在理论上阅读太多书籍，不如在您完成项目时立即搜索您想知道的内容。这样您可以获得实用知识。
3.  也可以观看在线视频。在此处查看我关于[VIDEOS的问题](https://stackoverflow.com/questions/856375/list-some-sites-for-free-c-video-podcasts)
4.  在stackoverflow上问任何你不明白的东西。我们是来帮忙的:)

按照这些步骤，我可以向您保证，您很快就会成为一名出色的程序员！

干杯!

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2013-03-05T09:11:39.283

I created an online interactive C tutorial, you can start using it without installing an IDE.

[http://www.learn-c.org](http://www.learn-c.org)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-05-30T17:19:39.260

除了您最终使用的任何书籍和网站之外，您还可以考虑在您所在的地区寻找当地的支持小组。许多领域都有一个 Linux 用户组或一个用于 Java 或 Ruby 编程的组。专业程序员使用这些小组来互相帮助解决他们的编程问题，但这些小组通常对年轻人和初学者很友好。不要因为年龄和经验不足而感到尴尬或尴尬。大多数人会钦佩您的主动性和好奇心，并在遇到问题时乐于帮助您。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-05-30T03:17:22.337

对于其他人，我强烈推荐 Kernighan 和 Ritchie——这可能是有史以来最好的语言书籍。我也建议你放慢脚步，享受自己：不要宽泛而浅薄；开始狭窄而深刻。如果你喜欢编程，你会想要掌握这门手艺，而不是匆忙。 [Peter Norvig 的这篇文章](http://norvig.com/21-days.html)解释了如何不那么着急。

PS 我从 12 岁开始使用 APL/360 进行编程。我玩得很开心，从那以后一直在做——35 年了，而且还在继续。祝你好运，**别忘了玩得开心！**

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-05-30T06:38:59.853

大约在 1981 年，我 10 岁时开始学习 Basic 编程。不久之后，它是 6502 组件，试图从 1 MHz Apple IIe 克隆中获得更高的速度。

Pascal 是 1988 年的一个启示——没有行号的编程。

Modula-2、C、Eiffel、Miranda、Haskel 和 Prolog 在大学以及任何数量的语言脚本。

从事 C++ 专业工作约 6 年。

C#，然后是 Java、Ruby，在过去的 18 个月里又回到了 C#。

Python 一路走来。

我的建议是，选择最适合您今天需要解决的问题的语言。

您遇到的第一个问题是学习基础知识，即如何分解问题并以清晰简洁的方式表达它。我建议你选择 C ​​以外的其他东西。我推荐 Python，因为在线文档非常好，库也很棒，你会花更多的时间编写有趣的代码，而不是花更少的时间来弄清楚为什么你的代码由于分段错误而停止。

当您掌握了基本概念后，尝试一些组装并了解引擎盖下发生了什么。如果不出意外，您将了解 CPU 的真正速度。C 是在那之后的一个很好的步骤。我还建议您在 Objective-C 之前尝试 Java 或 C#。

至于要多久才能转到Objective-C，这真的取决于你的才华。如果你真的很棒，那么一旦你学会了第 3 或第 4 种语言，在开始一门新语言的 6 周内，你将比大多数程序员更有效率（尽管会改变语言系列（即命令式、函数式、面向对象）需要更长的时间）。如果你不好，那么不要指望通过第一个。希望你能进入第一类。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-05-30T05:01:29.510

到目前为止，学习编程的最好方法（通常也是最快的方法）是找到一个好的导师。说起来容易做起来难。但我想你会惊讶于有多少人愿意帮助你。我的建议是不要害怕问。

如果我是你，我会找一个当地的 FIRST 机器人团队，看看你是否可以出去玩一些编码。很有可能你会处理类似的问题，并且会得到有丰富经验的人的一些支持。无论如何，这就是我会做的。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-05-30T21:20:44.313

假设你有一些基本的编程知识，Cocoa Dev Central 有一系列文章以少于 1000 页的方式解释基本 C 和 Objective-C。

[为 Cocoa 学习 C](http://www.cocoadevcentral.com/articles/000081.php)，然后[学习 Objective-C](http://www.cocoadevcentral.com/d/learn_objectivec/)

连一个小时都不应该走完。这些文章不涉及任何高级的东西，但是如果你正在学习 ObjC 来编写 OS X 应用程序，那么 ObjC 位基本上是微不足道的，难学的是 Cocoa！

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-05-31T07:46:05.500

如果你想学习 Objectif-C 来创建 iPhone 应用程序，不要在 C 上浪费时间，现在就学习 Objectif-C，然后是一本关于 iPhone 编程的书。它将超过 1000 页，但如果你想在生活中编程，你必须习惯阅读这些类型的书。

# javascript - 如何使用 Firefox 扩展注入 Javascript

> ID：928845
> 
> 赞同：0
> 
> 时间：2009-05-30T02:38:47.750
> 
> 标签：javascript, firefox, ads, inject

我正在构建一个 Firefox 扩展，并且已经走了很长一段路。我的扩展程序的一个部分是我在页面底部显示一个 DIV，我想在 div 中放置一个广告，但由于某种原因，每次这样做时，它都会重定向到另一个页面，并完全打开广告它。所以看起来它不允许我将下面的代码插入到位于底部的 div 中。任何人都可以提供帮助吗？

这段代码当然会调用“ad_display.js”文件，这就是它进行重定向的地方。有什么办法可以做到这一点还是我被困在水中？

谢谢！！！

```
 <!-- Beginning of Project Wonderful ad code: -->
<!-- Ad box ID: 38154 -->
<script type="text/javascript">
<!--
var pw_d=document;
pw_d.projectwonderful_adbox_id = "38154";
pw_d.projectwonderful_adbox_type = "2";
pw_d.projectwonderful_foreground_color = "";
pw_d.projectwonderful_background_color = "";
//-->
</script>
<script type="text/javascript" src="http://www.projectwonderful.com/ad_display.js"></script>
<!-- End of Project Wonderful ad code. --> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-30T02:42:44.123

两种解决方案：

*   要么复制该 ad_display 脚本的功能，要么将“document.write(pw_s)”更改为更明智的内容，例如“document.getElementById('mydivwithanad').innerHTML=pw_s”
*   您使用的 Ether 在页面中插入 iframe 而不是 div，然后将该代码注入 iframe。

# sql-server - 如何从 SQL Server 存储过程中获取返回值到 nHibernate？

> ID：928847
> 
> 赞同：2
> 
> 时间：2009-05-30T02:41:01.630
> 
> 标签：sql-server, nhibernate, stored-procedures

1.数据库平台：SqlServer

2.数据访问：nHibernate 1.2

现在我们需要通过 nHibernate 访问存储过程，如下所示：

```
ALTER PROCEDURE TestProc() 
 AS 
  BEGIN 
    Select * From User 
    Return 1234 
  END 
```

我知道我可以通过 IQuery 获取用户列表，并且我也想获取默认返回值“1234”。

问题：

1.  如何获得这个默认返回值？
2.  如果不能直接获取，我们可以通过输出参数获取值吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-18T19:57:21.977

NHibernate 不允许您以这种方式使用存储过程。但它确实允许使用普通的旧 ADO.NET API 进行调用。[NHibernate 文档](http://nhforge.org/doc/nh/en/index.html#sp_query)说，如果你想使用这些过程，你必须通过 session.Connection 来执行它们。这是一个例子 -

```
ISession session = sessionFactory.GetSession();

using(ITransaction transaction = session.BeginTransaction())
{
   IDbCommand command = new SqlCommand();
   command.Connection = session.Connection;

   // Enlist IDbCommand into the NHibernate transaction
   transaction.Enlist(command);

   command.CommandType = CommandType.StoredProcedure;
   command.CommandText = "dbo.SetUserInfo";

   // Set input parameters
   var parm = new SqlParameter("@UserID", SqlDbType.Int);
   parm.Value = 12345;
   command.Parameters.Add(parm); 

   // Set output parameter
   var outputParameter = new SqlParameter("@Quantity", SqlDbType.Int);
   outputParameter.Direction = ParameterDirection.Output;
   command.Parameters.Add(outputParameter); 

   // Set a return value
   var returnParameter = new SqlParameter("@RETURN_VALUE", SqlDbType.Int);
   returnParameter.Direction = ParameterDirection.ReturnValue;
   command.Parameters.Add(returnParameter);

   // Execute the stored procedure
   command.ExecuteNonQuery();
} 
```

你可以在这里找到更多细节 -

[http://refactoringaspnet.blogspot.com/2009/06/how-to-use-legacy-stored-procedures-in.html](http://refactoringaspnet.blogspot.com/2009/06/how-to-use-legacy-stored-procedures-in.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-09-18T03:10:03.793

我就是这样做的：

在我的 .hbm.xml

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" assembly="DocumentManagement.Data"  namespace="DocumentManagement.Data.Repositories" >

<sql-query name="GetDocument">    
<return class="DocumentManagement.Core.Models.PhysicalDocument, DocumentManagement.Core">      
    <return-property column="DocId" name="Id" />      
    <return-property column="Filepath" name="Filepath" />
    <return-property column="Filename" name="Filename" />
</return>
exec Investor_GetDocumentById :userId, :docId
</sql-query>

</hibernate-mapping> 
```

在我的 repository.cs

```
 public PhysicalDocument GetDocumentPath(int userId, int docId)
    {
        var query = Session.GetNamedQuery("GetDocument")
            .SetInt32("userId", userId)
            .SetInt32("docId", docId).List<PhysicalDocument>();

        return query[0];
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-30T12:05:04.080

首先，这在我所见过的任何地方都没有被称为“默认返回值”。这只是返回值。它通常用于返回成功/错误状态。

我不知道 nHibernate 是如何做事的，但在 ADO.NET 中，您会使用一个将 Direction 属性设置为“Return”的参数。也许在 nHibernate 中有一个等价物。

OTOH，更常见的是使用 OUTPUT 参数返回实际有用的值，并保留 RETURN 值以用于错误代码或被忽略。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-30T19:36:15.523

我以前做过（不是在 nHibernate 中）。

在检索输出参数之前，您必须[完全处理整个记录集](http://msdn.microsoft.com/en-us/library/aa905903(SQL.80).aspx)。

[另一个讨论](http://www.dominicpettifer.co.uk/Blog/8/output-parameters-and-recordsets-from-a-stored-procedure)

# html - 设置表格列宽

> ID：928849
> 
> 赞同：295
> 
> 时间：2009-05-30T02:41:40.257
> 
> 标签：html, css, html-table

我有一个用于收件箱的简单表格，如下所示：

```
<table border="1">
        <tr>
            <th>From</th>
            <th>Subject</th>
            <th>Date</th>
        </tr> 
```

如何设置宽度，使 From 和 Date 为页面宽度的 15%，Subject 为 70%。我还希望表格占据整个页面宽度。

* * *

## 回答 #1

> 赞同：475
> 
> 时间：2009-05-30T02:48:23.347

```
<table style="width: 100%">
    <colgroup>
       <col span="1" style="width: 15%;">
       <col span="1" style="width: 70%;">
       <col span="1" style="width: 15%;">
    </colgroup>

    <!-- Put <thead>, <tbody>, and <tr>'s here! -->
    <tbody>
        <tr>
            <td style="background-color: #777">15%</td>
            <td style="background-color: #aaa">70%</td>
            <td style="background-color: #777">15%</td>
        </tr>
    </tbody>
</table>
```

* * *

## 回答 #2

> 赞同：156
> 
> 时间：2009-05-30T02:47:19.950

```
table {
  width: 100%;
  border: 1px solid #000;
}
th.from, th.date {
  width: 15%
}
th.subject {
  width: 70%; /* Not necessary, since only 70% width remains */
}
```

```
<table>
  <thead>
    <tr>
      <th class="from">From</th>
      <th class="subject">Subject</th>
      <th class="date">Date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>[from]</td>
      <td>[subject]</td>
      <td>[date]</td>
    </tr>
  </tbody>
</table>
```

最好的做法是保持你的`HTML`和`CSS`分开，以减少代码重复，并分离关注点（`HTML`用于结构和语义，以及`CSS`用于表示）。

请注意，为了在旧版本的 Internet Explorer 中工作，您可能必须为表格指定特定宽度（例如，900 像素）。如果它的包装器没有精确的尺寸，该浏览器在渲染具有百分比尺寸的元素时会出现一些问题。

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2011-06-14T13:40:44.093

使用下面的 CSS，第一个声明将确保您的表格坚持您提供的宽度（您需要在 HTML 中添加类）：

```
table{
  table-layout:fixed;
}
th.from, th.date {
  width: 15%;
}
th.subject{
  width: 70%;
} 
```

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2013-10-11T10:49:47.363

仅使用一个类的替代方法，同时将样式保存在 CSS 文件中，甚至可以在 IE7 中使用：

```
<table class="mytable">
    <tr>
        <th>From</th>
        <th>Subject</th>
        <th>Date</th>
    </tr>
</table>
<style>
    .mytable td, .mytable th { width:15%; }
    .mytable td + td, .mytable th + th { width:70%; }
    .mytable td + td + td, .mytable th + th + th { width:15%; }
</style> 
```

最近，您还可以使用`nth-child()`CSS3 (IE9+) 中的选择器，您只需将 nr. 将相应列的名称放入括号中，而不是将它们与相邻的选择器串在一起。像这样，例如：

```
<style>
    .mytable tr > *:nth-child(1) { width:15%; }
    .mytable tr > *:nth-child(2) { width:70%; }
    .mytable tr > *:nth-child(3) { width:15%; }
</style> 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2016-04-26T02:14:11.453

这是我的两个建议。

1.  使用类。无需指定其他两列的宽度，因为它们将由浏览器自动设置为 15%。

    ```
     table { table-layout: fixed; }
        .subject { width: 70%; }
    ```

    ```
     <table>
          <tr>
            <th>From</th>
            <th class="subject">Subject</th>
            <th>Date</th>
          </tr>
        </table>
    ```

2.  不使用类。三种不同的方法，但结果是相同的。

    一个）

    ```
     table { table-layout: fixed; }
        th+th { width: 70%; }
        th+th+th { width: 15%; }
    ```

    ```
     <table>
          <tr>
            <th>From</th>
            <th>Subject</th>
            <th>Date</th>
          </tr>
        </table>
    ```

    b)

    ```
     table { table-layout: fixed; }
        th:nth-of-type(2) { width: 70%; }
    ```

    ```
     <table>
          <tr>
            <th>From</th>
            <th>Subject</th>
            <th>Date</th>
          </tr>
        </table>
    ```

    c) 这个是我最喜欢的。与 b) 相同，但具有更好的浏览器支持。

    ```
     table { table-layout: fixed; }
        th:first-child+th { width: 70%; }
    ```

    ```
     <table>
          <tr>
            <th>From</th>
            <th>Subject</th>
            <th>Date</th>
          </tr>
        </table>
    ```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2019-03-07T06:24:32.090

`colgroup`在您的`table`标签之后添加。在此处定义`width`列数和列数，并添加`tbody`标签。把你的`tr`里面`tbody`。

```
<table>
    <colgroup>
       <col span="1" style="width: 30%;">
       <col span="1" style="width: 70%;">
    </colgroup>

    <tbody>
        <tr>
            <td>First column</td>
            <td>Second column</td>
        </tr>
    </tbody>
</table> 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-05-30T02:49:08.340

根据您的身体（或包裹表格的 div）“设置”，您应该能够做到这一点：

```
body {
  width: 98%;
}

table {
  width: 100%;
}

th {
  border: 1px solid black;
}

th.From, th.Date {
  width: 15%;
}

th.Date {
  width: 70%;
}

<table>
  <thead>
    <tr>
      <th class="From">From</th>
      <th class="Subject">Subject</th>
      <th class="Date">Date</th>
    </tr>
   </thead>
   <tbody>
     <tr>
       <td>Me</td>
       <td>Your question</td>
       <td>5/30/2009 2:41:40 AM UTC</td>
     </tr>
   </tbody>
</table> 
```

[演示](http://jsbin.com/oxogu)

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2014-07-04T09:31:57.443

试试这个。

```
<table style="width: 100%">
    <tr>
        <th style="width: 20%">
           column 1
        </th>
        <th style="width: 40%">
           column 2
        </th>
        <th style="width: 40%">
           column 3
        </th>
    </tr>
    <tr>
        <td style="width: 20%">
           value 1
        </td>
        <td style="width: 40%">
           value 2
        </td>
        <td style="width: 40%">
           value 3
        </td>
    </tr>
</table> 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2016-08-24T02:46:51.567

```
 table { table-layout: fixed; }
    .subject { width: 70%; }
```

```
 <table>
      <tr>
        <th>From</th>
        <th class="subject">Subject</th>
        <th>Date</th>
      </tr>
    </table>
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2014-07-05T05:20:41.490

这是在 CSS 中执行此操作的另一种最小方法，即使在不支持`:nth-child`和类似选择器的旧浏览器中也可以使用：http: [//jsfiddle.net/3wZWt/](http://jsfiddle.net/3wZWt/)。

HTML：

```
<table>
    <tr>
        <th>From</th>
        <th>Subject</th>
        <th>Date</th>
    </tr>
    <tr>
        <td>Dmitriy</td>
        <td>Learning CSS</td>
        <td>7/5/2014</td>
    </tr>
</table> 
```

CSS：

```
table {
    border-collapse: collapse;
    width: 100%;
}

tr > * {
    border: 1px solid #000;
}

tr > th + th {
    width: 70%;
}

tr > th + th + th {
    width: 15%;
} 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2015-01-28T09:35:01.750

```
<table>
  <col width="130">
  <col width="80">
  <tr>
    <th>Month</th>
    <th>Savings</th>
  </tr>
  <tr>
    <td>January</td>
    <td>$100</td>
  </tr>
  <tr>
    <td>February</td>
    <td>$80</td>
  </tr>
</table> 
```

[演示](http://www.w3schools.com/tags/att_col_width.asp)

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-05-30T02:49:18.370

不要使用边框属性，使用 CSS 来满足您的所有样式需求。

```
<table style="border:1px; width:100%;">
    <tr>
            <th style="width:15%;">From</th>
            <th style="width:70%;">Subject</th>
            <th style="width:15%;">Date</th>
    </tr>
... rest of the table code...
</table> 
```

但是像这样嵌入 CSS 是一种不好的做法——应该使用 CSS 类，并将 CSS 规则放在外部 CSS 文件中。

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2018-09-20T18:26:16.627

```
style="column-width:300px;white-space: normal;" 
```

# sql - 在 mysql 中使用外键约束插入的建议

> ID：928855
> 
> 赞同：0
> 
> 时间：2009-05-30T02:46:49.170
> 
> 标签：sql, mysql

我有一个包含 2 个条目的表。

就像是

```
CREATE TABLE  `db`.`main` (
  `id` int(10) unsigned NOT NULL,
  PRIMARY KEY (`id`)
); 
```

这 2 个条目的 id 是自动生成的主键。

我有另一个带有规则链接的表

```
CREATE TABLE  `db`.`day` (
    `main_id` int(10) unsigned NOT NULL,
    `day` tinyint(4) NOT NULL,
    CONSTRAINT `fk_db_main` FOREIGN KEY (`main_id`) REFERENCES `main` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION
); 
```

现在我可以使用成功获得结果

```
SELECT * FROM main where id='9'; 
```

但是当我尝试跑步时

```
INSERT INTO day (main_id, day) VALUES (9, 0); 
```

我明白了

“无法添加或更新子行：外键约束失败 ( `db`. `day`, CONSTRAINT `fk_db_main`FOREIGN KEY ( `main_id`) REFERENCES `main`( `id`) ON DELETE NO ACTION ON UPDATE NO ACTION) (1452)”

关于我在插入时缺少什么的任何建议？

**我在提问时没有列出问题的实际原因。实际原因是主数据库表在 MyISAM 中，而 InnoDB 表无法创建连接到它的外键。简而言之，MyISAM 不支持外键，即使它们来自其他表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-30T02:59:03.933

如果我删除语句中的`db.`部分`CREATE TABLE`（并插入到9`main`的行`id`中），插入对我有用。也许问题是您`db.`不一致地使用该前缀，即在子句之后`TABLE`但不在`CONSTRAINT`子句中......？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T02:57:49.773

FOREIGN KEY 约束表示“'main' 表中应有一个条目，其 ID 值与 'day' 表中新插入的 'main_id' 值匹配”。

当您将值 9 插入“day”时，“main”中是否已经存在 ID = 9 的行？

DBMS 不这么认为——这就是它抱怨的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T13:41:03.460

我在提问时没有列出问题的实际原因。实际原因是主数据库表在 MyISAM 中，而 InnoDB 表无法创建连接到它的外键。简而言之，MyISAM 不支持外键，即使它们来自其他表。

# php - ASP.NET 服务器和 PHP？

> ID：928857
> 
> 赞同：0
> 
> 时间：2009-05-30T02:47:59.073
> 
> 标签：php, asp.net

我想知道，在同一个盒子上支持 ASP.NET 和 PHP 的服务器是否常见？wordpress/mediaWiki/phpBB3 似乎是一个不错的组合，但我正在开发一个 ASP.NET 项目。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T03:09:35.257

大多数 Windows 虚拟主机也支持 PHP。PHP 的一大缺点是缺乏 URL 重写支持。IIS 可以很好地处理多个处理程序，因此同时运行这两个处理程序甚至不是特别棘手。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-31T11:31:58.680

使用 IIS 肯定会对您有所帮助。

在此处下载 Microsoft 的 IIS PHP，[http://www.microsoft.com/web/platform/phponwindows.aspx](http://www.microsoft.com/web/platform/phponwindows.aspx)

这将帮助您开始。

不要忘记在 C:/Windows 或安装应用程序的任何位置编辑 php.ini，以确保为您设置最佳的一切。

> 我们知道 PHP 在 Windows 平台上并不总是能够顺利运行，因此我们现在优化了 Windows Server，以通过一个新组件支持您的 PHP 应用程序：FastCGI。FastCGI 作为 PHP 引擎和 IIS 之间的接口工作，它确保 PHP 比 CGI 运行得更快，并且比 PHP ISAPI 更可靠。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-31T11:49:42.107

使用 IIS，您可以托管 Asp.net 和[PHP](http://php.iis.net/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-31T11:53:54.813

另一种选择是集成 PHP 的 Phalanger 项目，因此您可以单独使用它，也可以在 IIS 上的 ASP.NET 中使用它。

它被编译下来，所以它应该比标准解释 php 运行得快得多。

[帕朗厄尔](http://www.php-compiler.ne)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-31T11:55:23.673

您可以使用 Ubuntu Server（各种托管服务提供商都提供），以及其他 GNU/Linux 发行版。查看[http://www.google.com/search?q=ubuntu+server+hosting](http://www.google.com/search?q=ubuntu+server+hosting)，然后获取 apt-get [Mono for ASP.NET](http://www.mono-project.com/ASP.NET)以及 PHP 5：

sudo apt-get install mono-xsp2 php5

以及您需要的其他任何东西。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-30T03:22:16.227

如果您想替换掉，请查看[Microsoft Web 平台](http://www.microsoft.com/Web/downloads/platform.aspx)，否则 PHP 将作为 SAPI 模块安装到 IIS 中，或者，如果您使用 IIS 7，您也可以将其作为 FastCGI 运行。

php|architect 还赠送了2009 年[5 月](http://www.phparch.com/c/magazine/issue/97)的问题，该问题是关于在 Windows 上运行 PHP 的。

# database - 在空表中查找 SQLite 列名

> ID：928865
> 
> 赞同：38
> 
> 时间：2009-05-30T02:51:33.717
> 
> 标签：database, sqlite, schema

我正在编写一个“模式文档”工具，用于生成数据库中表和关系的描述。我目前正在调整它以与 SQLite 一起使用。

我已经设法通过对`sqlite_master`表的查询来提取 SQLite 数据库中所有表的名称。对于每个表名，然后我启动一个简单的

```
select * from <table name> 
```

查询，然后使用`sqlite3_column_count()`和`sqlite3_column_name()`API 收集列名，我进一步提供这些列名`sqlite3_table_column_metadata()`以获取更多信息。很简单，对吧？

问题是它只适用于非空表。也就是说，`sqlite_column_*()`API 仅在`sqlite_step()`has returned时才有效`SQLITE_ROW`，而空表则不然。

所以问题是，我怎样才能发现空表的列名？或者，更一般地说，有没有更好的方法在 SQLite 中获取这种类型的模式信息？

我觉得一定有另一个隐藏`sqlite_xxx`的表格潜伏在某个地方，里面有这个信息，但到目前为止还没有找到。

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2009-05-30T02:56:24.830

```
sqlite> .header on
sqlite> .mode column
sqlite> create table ABC(A TEXT, B VARCHAR);
sqlite> pragma table_info(ABC);
cid         name        type        notnull     dflt_value  pk
----------  ----------  ----------  ----------  ----------  ----------
0           A           TEXT        0                       0
1           B           VARCHAR     0                       0 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-30T03:17:33.163

执行查询：

```
PRAGMA table_info( your_table_name ); 
```

[文档](http://www.sqlite.org/pragma.html)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-12-08T12:00:52.337

`PRAGMA table_info( your_table_name );`在 HTML5 SQLite 中不起作用。

这是一个小的 HTML5 SQLite JavaScript 片段，它从 your_table_name 获取列名，即使它是空的。希望它有帮助。

```
tx.executeSql('SELECT name, sql FROM sqlite_master WHERE type="table" AND name = "your_table_name";', [], function (tx, results) {
  var columnParts = results.rows.item(0).sql.replace(/^[^\(]+\(([^\)]+)\)/g, '$1').split(',');
  var columnNames = [];
  for(i in columnParts) {
    if(typeof columnParts[i] === 'string')
      columnNames.push(columnParts[i].split(" ")[0]);
  }
  console.log(columnNames);
  ///// Your code which uses the columnNames;
}); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-09-13T00:31:57.677

执行这个查询

```
select * from (select "") left join my_table_to_test b on -1 = b.rowid; 
```

[您可以在在线 sqlite 引擎](http://wdbengine.sourceforge.net)上尝试一下

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-30T03:09:54.787

`PRAGMA`@pragmanatu 建议的语句也可以通过任何编程接口正常工作。或者， 的`sql`列`sqlite_master`具有描述表的`SQL`语句`CREATE TABLE &c &c`（但是，您必须对其进行解析，所以我认为`PRAGMA table_info`更...实用；-)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-06-19T17:42:50.507

如果您使用 SQLite 3.8.3 或更高版本（支持 WITH 子句），则此递归查询应该适用于基本表。在 CTAS 上，YMMV。

```
WITH
    Recordify(tbl_name, Ordinal, Clause, Sql)
AS
    (
     SELECT
        tbl_name,
        0,

        '',
        Sql
     FROM
        (
         SELECT
            tbl_name,
            substr
            (
             Sql,
             instr(Sql, '(') + 1,
             length(Sql) - instr(Sql, '(') - 1
            ) || ',' Sql
         FROM
            sqlite_master
         WHERE
            type = 'table'
        )
     UNION ALL
     SELECT
        tbl_name,
        Ordinal + 1,
        trim(substr(Sql, 1, instr(Sql, ',') - 1)),
        substr(Sql, instr(Sql, ',') + 1)
     FROM
        Recordify
     WHERE
        Sql > ''
       AND  lower(trim(Sql)) NOT LIKE 'check%'
       AND  lower(trim(Sql)) NOT LIKE 'unique%'
       AND  lower(trim(Sql)) NOT LIKE 'primary%'
       AND  lower(trim(Sql)) NOT LIKE 'foreign%'
       AND  lower(trim(Sql)) NOT LIKE 'constraint%'
    ),
    -- Added to make querying a subset easier.
    Listing(tbl_name, Ordinal, Name, Constraints)
AS
    (
     SELECT
        tbl_name,
        Ordinal,
        substr(Clause, 1, instr(Clause, ' ') - 1),
        trim(substr(Clause, instr(Clause, ' ') + 1))
     FROM
        Recordify
     WHERE
        Ordinal > 0
    )
SELECT
    tbl_name,
    Ordinal,
    Name,
    Constraints
FROM
    Listing
ORDER BY
    tbl_name,
    lower(Name); 
```

# database - 将 MS Excel 链接到 MS Access 查询

> ID：928869
> 
> 赞同：1
> 
> 时间：2009-05-30T02:52:42.327
> 
> 标签：database, excel, ms-access, automation

我有一个 Access 数据库，用于运行一堆聚合的 TOP 5 查询。这个特定功能的最终游戏是带有图表的 ppt 演示文稿。所以为了自动化一点，我创建了一个 Excel 电子表格，里面有一堆预制的图表。我链接/数据将查询结果导入到 Excel 电子表格中，并设置单元格范围以匹配图表的源范围。最后，我将电子表格设置为在每次“打开文件”时启用自动刷新，然后，我按下按钮在 access 中运行查询，然后打开 excel 文件，数据刷新，它们就是我的图表。然后我使用一些VB将所有活动图表复制粘贴到ppt中，但这是另一回事。

好的，这就是我遇到的障碍。我需要对来自另一个 ag 查询的另一个电子表格执行完全相同的过程。在我使用的过程之前只是单击数据 > 导入外部数据 > 导入数据，然后选择数据库的文件，然后它会填充表和查询列表以供选择。只是现在，它不会在该填充列表中显示任何查询；只有桌子！？！

有任何想法吗？顺便说一句 MSO 2003

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-31T15:30:25.640

我无法复制那个贾斯汀。在显示表格的对话框中，向右滚动并检查 TYPE 列。查询将具有 VIEW 类型和 TABLE 表。验证他们都说 TABLE。

接下来，尝试使用数据 - 导入外部数据 - 新数据库查询而不是“导入数据”。选择 Access 驱动程序和 Access mdb。这将打开一个不同的对话框，但应该同时显示表和查询。看看是只显示表格还是同时显示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-31T11:11:52.573

我认为这是已引入的安全功能？

尝试选择任何表，然后选择数据>导入外部数据>编辑查询

然后选择 SQL 作为命令类型并输入查询 SQL 或仅从查询中选择，即：

```
select * from qryCat; 
```

**希望**这有助于感谢马克

# c# - 在 .NET C# 程序中，从 FTP 转换到 SFTP 是否容易？

> ID：928870
> 
> 赞同：1
> 
> 时间：2009-05-30T02:52:56.567
> 
> 标签：c#, .net, ftp, sftp, transition

在 .NET C# 程序中，从 FTP 转换到 SFTP 是否容易？我试图了解承包商完成过渡需要多长时间。我个人的经验主要是使用 PHP，所以我不知道。

基本上，我在说什么，必须采取哪些步骤？显然，不同的命令，但代码本身还有其他内容吗？就像命令需要不同的格式等一样吗？

此外，如果有人拥有所有 .NET/C# FTP 和 SFTP 命令的列表，那将非常有帮助。

根据要求进行澄清：该程序正在将极小的文件 (20 KB) 上传到服务器。通过格式，我的意思是视觉上，因为我想知道查找/替换工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-30T03:14:31.347

这是一个相当模糊的问题。您还没有告诉我们 C# 程序对 FTP 做了什么。它是服务器，是客户端，是在做目录列表，是在上传 100 GB 的文件吗？它使用的是什么库？

根据[这个论坛帖子](http://social.msdn.microsoft.com/forums/en-US/netfxnetcom/thread/136ad4ce-f625-471d-b202-668bf7866889)，.NET 中没有对 SFTP 的内置支持，因此您必须使用第三方库，例如[SharpSSH](http://www.tamirgal.com/home/dev.aspx?Item=sharpSsh)或[Granados SSH](http://www.routrek.co.jp/en/product/varaterm/granados.html)。

我真的不知道你的意思，“命令是否需要不同的格式”。显然，代码会使用不同的：

1.  图书馆
2.  类型
3.  有线协议。

由于库的抽象，它显然*看起来有些相似。*我建议您提供更多信息和更清晰的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T03:41:54.770

您需要考虑的一件事是您当前的代码编写得有多好。如果您现有的 FTP 实现是设计得很糟糕的意大利面条代码，那么将其转换为 SFTP 可能几乎是不可能的，并且花费的时间比您想要的要长。如果不知道代码的当前状态，任何人都很难做出良好的估计。即使你确实从这个网站上的人那里得到了估计，我也不建议你相信它（即使这个网站上的人很棒），因为如果没有他们面前的所有信息，任何人都几乎不可能得出一个可靠的估计。

也许您应该考虑聘请一位优秀的顾问或业务分析师为您做一个全面的估计。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-04T07:13:35.323

这实际上取决于您的开发人员用来实现 FTP 的 C# 库。

例如，如果他们使用[edtFTPnet](http://www.enterprisedt.com/products/edtftpnet/overview.html)，一个广泛可用的开源库，那么如果将其替换为[edtFTPnet/PRO](http://www.enterprisedt.com/products/edtftpnetpro/overview.html) ，升级路径就很简单了。PRO 版本具有相同的 API，只需要几行额外的代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-17T21:47:48.283

我一直在这条路上。

这取决于，但请记住，SFTP、FTP-SSL 和 FTP 是不同的。如果他自己编写 SFTP 库，一两个月，因为要使其完美和兼容需要大量工作。但他不应该那样做。

简而言之，让他使用外部库来添加 SFTP 功能。这将使它变得很短。也许一两个星期的全职工作，但这取决于它的参与程度。有开源选项。但只要花 50-150 美元，您就可以获得维护良好且易于使用的代码的许可证。将节省他的工作时间。上面有链接，但我会看：免费： [http ://www.enterprisedt.com/products/edtftpnet/overview.html](http://www.enterprisedt.com/products/edtftpnet/overview.html)

商业： [http ://www.weonlydo.com/](http://www.weonlydo.com/)

# sqlite - 如何使用 SQLite 批量插入？

> ID：928873
> 
> 赞同：7
> 
> 时间：2009-05-30T02:53:34.727
> 
> 标签：sqlite, ado.net, bulkinsert

如何使用 SQLite 批量插入？

我查了一下，好像我用 select 语句做了一个插入。我搜索了一下，查看了示例，它们看起来都像是在将数据从一个表复制到另一个表，或者与 SQLite 不兼容。我想做类似的事情

```
"INSERT INTO user_msg_media (recipientId, mediaId, catagory, current_media_date) " +
"VALUES(@mediaId, @catagory, @current_media_date)";
where the value of recipientId is the watcher from each of
"SELECT watcher FROM userwatch WHERE watched=@watched"; 
```

我尝试了下面的代码，但收到错误“SQLite error no such column: watcher”

```
 command.CommandText =
            "CREATE TABLE if not exists user_msg_media( " +
            "msgId        INTEGER PRIMARY KEY, " +
            "recipientId  INTEGER, " +
            "mediaId      INTEGER, " +
            "catagory     INTEGER, " +
            "current_date DATE);";
        command.ExecuteNonQuery();

        //user media
        command.CommandText =
            "CREATE TABLE if not exists user_watch( " +
            "indx INTEGER PRIMARY KEY, " +
            "watcher INTEGER, " +
            "watched INTEGER);";
        command.ExecuteNonQuery();
        //...

    command.CommandText = "SELECT watcher FROM user_watch WHERE watched=:watched;";
    command.Parameters.Add(":watched", DbType.Int64).Value = 1;
    command.ExecuteNonQuery(); //is ok

    command.CommandText =
        "INSERT INTO user_msg_media (recipientId, mediaId, catagory, current_media_date) " +
        "SELECT watcher, :mediaId, :category, :current_media_date" +
        "FROM user_watch WHERE watched=:watched;";
    command.Parameters.Add(":mediaId", DbType.Int64).Value = 0;
    command.Parameters.Add(":category", DbType.Int64).Value = 0;
    command.Parameters.Add(":current_media_date", DbType.Int64).Value = 0;
    command.Parameters.Add(":watched", DbType.Int64).Value = 1;
    command.ExecuteNonQuery(); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-09-08T19:50:44.347

我编写了一个类来帮助促进 SQLite 中的批量插入。希望它会有所帮助：

[http://procbits.com/2009/09/08/sqlite-bulk-insert/](http://procbits.com/2009/09/08/sqlite-bulk-insert/)

-J.P

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-30T03:01:34.243

SQlite 不支持@variable 表示法，但是（为了清楚起见，使用 sqlite 的 Python 绑定支持的命名占位符样式）这应该可以工作：

```
INSERT INTO user_msg_media (userId, mediaId, catagory, current_media_date)
SELECT watcher, :mediaId, :category, :current_media_date
FROM userwatch WHERE watched=:watched 
```

编辑：SQLite 似乎误诊了哪个列名是错误的。列名全部固定后，以下 Python 代码对我有用（不确定您使用的是哪种其他语言，Python 是我与 sqlite 交互最方便的语言）：

```
import sqlite3 as sq

con = sq.connect(':memory:')
cur = con.cursor()
cur.execute("CREATE TABLE if not exists user_msg_media( " +
            "msgId        INTEGER PRIMARY KEY, " +
            "recipientId  INTEGER, " +
            "mediaId      INTEGER, " +
            "catagory     INTEGER, " +
            "current_date DATE)")
cur.execute("CREATE TABLE if not exists user_watch( " +
            "indx INTEGER PRIMARY KEY, " +
            "watcher INTEGER, " +
            "watched INTEGER)")

cur.execute("INSERT INTO user_watch VALUES (1, 2, 3)")

cur.execute("SELECT watcher FROM user_watch WHERE watched=:watched",
            dict(watched=3))
print cur.fetchall()

print cur.execute("INSERT INTO user_msg_media (recipientId, mediaId, catagory, current_date) " +
        "SELECT watcher, :mediaId, :category, :current_media_date " +
        "FROM user_watch WHERE watched=:watched;",
        dict(mediaId=0, category=0, current_media_date=0, watched=3)
)

cur.execute("SELECT * FROM user_msg_media")
print cur.fetchall() 
```

但是，如果我在您的 SQL 中重现不匹配，例如 current_date 与 current_media_date，我可以让它误诊为丢失的列是`watcher`，即使该列实际上很好。想尝试将这个更正后的代码放回您最喜欢的语言中，看看它的表现如何？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-11-15T10:43:34.640

我建议使用来自 StackOverflow 的朋友的[Dapper ORM 。](http://code.google.com/p/dapper-dot-net/)如果您查看有关性能的部分，您不会比 Dapper 快多少。

**多次执行命令**
相同的签名还允许您方便有效地多次执行命令（例如批量加载数据）

示例用法：

```
connection.Execute(@"insert MyTable(colA, colB) values (@a, @b)",
    new[] { new { a=1, b=1 }, new { a=2, b=2 }, new { a=3, b=3 } }
  ); // 3 rows inserted: "1,1", "2,2" and "3,3" 
```

这适用于为某些 T 实现 IEnumerable 的任何参数。

# javascript - 如何使用 JQuery AJAX 防止 Firefox 提示使用 HTTP Basic Auth 输入用户名/密码？

> ID：928874
> 
> 赞同：13
> 
> 时间：2009-05-30T02:56:08.887
> 
> 标签：javascript, jquery, firefox, http-authentication

我正在编写一些浏览器端动态功能并使用 HTTP Basic Auth 来保护一些资源。用户体验非常重要，并且是高度定制的。

这是一个简单的测试 JQuery 方法，最终将测试用户是否在表单中提供了正确的凭据：

```
$(document).ready(function() {
    $("#submit").click(function() {
    var token = Base64.encode($('#username').val() + ':' + $('#password').val());        
    $.ajax({
      url: '/private',
      method: 'GET',
      async: false,
      beforeSend: function(req) {
        req.setRequestHeader('Authorization', 'test:password');
      },
      error: function(request, textStatus, error) {
        if (request.status == 401) {
          alert('401');
        }
      }
    });
    return false;
  });
}); 
```

如果他们不被允许访问`/private`，此时他们应该只看到警告框。但是，在 Firefox 上，会弹出浏览器提供的登录表单（使用新凭据重试）。Safari 不这样做。

我们希望完全控制自定义表单、淡入淡出、过渡等的体验。如何不显示 Firefox 的默认框？（如果这在我们测试 IE 时会成为一个问题，我也很想听听那里的解决方案。）

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2013-09-30T19:27:16.640

The solution is to set the `WWW-Authenticate` header to something other than `Basic`. For example set it to:

```
WWW-Authenticate: None 
```

or

```
WWW-Authenticate: FormBased 
```

if you use form based login. Then the browser will not show you a login window.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-30T03:18:10.463

如果您还没有阅读它：

[如何抑制浏览器的身份验证对话框？](https://stackoverflow.com/questions/86105/how-can-i-supress-the-browsers-authentication-dialog)

看起来不太有希望:)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-07-25T01:41:45.930

不幸的是，我在这里遇到了同样的问题。

在我看来，浏览器不应该提示 xmlhttprequest。我真的希望有人会推动这一点，因为人们真的很想迁移到 jQuery 来满足他们的身份验证需求。

好吧，这是我可以给你的帮助，我发现了这个 jQuery Digest 的东西，我不知道它到底做了什么或什么，但如果有人能以正确的方式使用这段代码，我们可以有一个 jQuery Digest 身份验证系统。

[https://www.openhub.net/p/digestj](https://www.openhub.net/p/digestj)

我认为使用这个方便的新 AuthDigestDomain 选项，我们可以重写上述脚本或其他任何东西，并将安全区域“链接”在一起，我们可以一劳永逸地解决这个问题。嗯...祝你好运=）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-07-16T20:41:09.203

我在某处找到了此身份验证弹出问题的解决方法。

```
WWW-Authenticate: None 
```

对我不起作用，但我添加了

```
'Authorization': 'Basic' 
```

到标题，它就像一个魅力。

# html - 一些 HTML/CSS 来解决 Struts2 中的一个缺点

> ID：928883
> 
> 赞同：0
> 
> 时间：2009-05-30T03:01:27.393
> 
> 标签：html, css, struts2, html-table

我正在尝试获取一个 HTML 页面，例如：http: [//jsbin.com/awoco](http://jsbin.com/awoco)。

这是一个 JSP 页面，因此它将包含 scriptlet。最终的 HTML 输出将是这样的（标签打开以节省空间）：

```
<%
Iterator it = MyList.iterator()
      While (it.hasNext())
      SomeClass all = it.next();
      SomeClass a = it.next();
      SomeClass b = it.next();
%>
      <tr> 
        <td rowspan=3 valign=top>Red<td><%=all.Name()%><td><%=all.price()%><td><%=all.originalPrice()%> 
      </tr> 
      <tr> 
        <td><%=a.Name()%><td><%=a.price()%><td><%=a.originalPrice()%> 
      </tr>  
      <tr >
        <td><%=b.Name()%><td><%=b.price()%><td><%=b.originalPrice()%>
      </tr> 
```

如您所见，我必须`next()`在 while 循环内调用 3 次。这是因为数据源是以这种方式填充的列表，我必须以与上面提供的链接完全相同的方式显示数据。

有没有办法以某种方式更改 HTML 输出，这样我就不必多次调用`next()`，但仍然获得相同的表结构？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-30T14:57:27.507

改变你的数据结构。`MyList`应该是（类似于）AgregateClass 的列表，它将包含 3 个类型的成员`SomeClass`(all,a,b)，然后简单地遍历`MyList`.

只是一些提示：如果您使用的是 Struts2，您可以使用`<s:iterator>`标签来遍历集合。[文件](http://cwiki.apache.org/confluence/display/WW/iterator)

由于 JSP 2.0 左右您可以编写`${b.price}`而不是`<%=b.price()%>`

您应该更改添加到问题中的标签，因为它与 html 或 css 无关。

# jquery - 如何在页面加载之前加载 jquery“模态窗口”？

> ID：928890
> 
> 赞同：1
> 
> 时间：2009-05-30T03:04:22.100
> 
> 标签：jquery

我正在用两种语言制作一个网站，我想在加载英文页面之前提供一个“jquery Modal Window”，以便选择另一种语言链接（在模式窗口上）。如果用户点击第二语言链接，他将去那个页面，如果他想保持英语，他只需要关闭窗口。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-30T04:03:29.050

如果您希望用户在使用网站之前选择一种语言，并且您当前的计划是向他们展示一个“模态”jquery 对话框......那么更有用、用户友好的方法是创建一个语言选择登陆用户在进入您的网站时将显示的页面。像这样的登陆页面，出于所有意图和目的......是模态的，但它更容易被您的用户访问。如果他们中的任何一个出于任何原因禁用了 javascript，或者正在使用浏览器，*咳嗽*IE*咳嗽*，这不能很好地呈现基于 dhtml 的“模态”内容，那么至少您的用户不会看到任何可能的古怪内容使他们难以或不可能实际选择他们选择的语言。

也就是说，如果您希望脚本在页面加载期间的特定时间点运行...只需将脚本直接放在 <script> 标记内，而不需要任何函数或其他包装器。加载该脚本块后，浏览器将立即执行内联脚本，即使文档尚未“准备好”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T03:10:17.063

不要将您的代码包装在准备好的文档中，如果您的模态插件需要特定的 DIV 在文档中，请将 div 直接放在 body 标记下，并将 javascript 代码直接放在该标记下。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-30T03:12:26.293

为什么不只是在页面加载时询问他们？

怎么了 ？我的意思是，只是为他们提供了在可用语言之间进行选择的选项。这不是那么烦人，最重要的是记住他们的选择。

尝试在 dom 准备好之前显示模态框很痛苦..

像 SO 这样的通知栏怎么样？

无论如何要回答您的问题，我想您应该像“加载”页面一样工作。

设置 CSS 并隐藏所有其他内容并为 JQuery使用[模式框插件](http://dev.iceburg.net/jquery/jqModal/)

然后只需[show()](http://docs.jquery.com/Effects/show)页面的内容

# java - 使用 ANT 根据包名动态生成 JAR 文件

> ID：928896
> 
> 赞同：0
> 
> 时间：2009-05-30T03:09:11.217
> 
> 标签：java, ant

我当前的构建文件具有以下重复性任务：

```
<jar jarfile="${build.lib}/${prefix}-foo.jar">
    <fileset dir="${build.classes}">
        <include name="com/a/c/foo/**"/>
    </fileset>  
</jar>
<jar jarfile="${build.lib}/${prefix}-bar.jar">
    <fileset dir="${build.classes}">
        <include name="com/a/c/bar/**"/>
    </fileset>
</jar> 
```

...等问题是必须为每个新包或每个新子项目修改 build.xml。这在我工作的地方经常发生。

我想用将基于“根”包动态生成 JAR 及其文件名的逻辑替换它。因此，例如，我可以将根包设置为 com/a/c，并且该包下的所有包都将获得自己的 JAR。请注意，“foo”或“bar”下的所有包都只是“foo.jar”或“bar.jar”的一部分。

我查找了 ANT 的循环逻辑任务。我在每个 ant-contrib 和 JWare/AntXtras 中都找到了一个，但我无法让它们按需要工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-30T06:20:38.907

我不知道循环和查找所有包名称，但您可以使用宏来避免代码重复。

我没试过这个，但它可以工作

```
<macrodef name="build_jar">
    <attribute name="name"/>
    <sequential>
        <jar jarfile="${build.lib}/${prefix}-@{name}.jar">
            <fileset dir="${build.classes}">
                <include name="com/a/c/@{name}/**"/>
            </fileset>
        </jar>
    </sequential
</macrodef>

<target name="build_foo">
    <build_jar name="foo"/>
</target>

<target name="build_bar">
    <build_jar name="bar"/>
</target> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-05T04:27:15.400

这个怎么样：

```
<project name="dynjar" default="jar" basedir=".">
    <property name="build.classes" value="${basedir}/classes"/>
    <property name="build.lib" value="${basedir}/lib"/>
    <property name="prefix" value="prefix"/>
    <property name="root" value="com/a/c"/>

    <target name="jar">
        <!-- ${ant.file} is the name of the current build file -->
        <subant genericantfile="${ant.file}" target="do-jar">

            <!-- Pass the needed properties to the subant call. You could also use
                 the inheritall attribute on the subant element above to pass all
                 properties. -->
            <propertyset>
                <propertyref name="build.classes"/>
                <propertyref name="build.lib"/>
                <propertyref name="prefix"/>
                <propertyref name="root"/>
            </propertyset>

            <!-- subant will call the "do-jar" target for every directory in the
                 ${build.classes}/${root} directory, making the subdirectory the
                 basedir. -->
            <dirset dir="${build.classes}/${root}" includes="*"/>
        </subant>
    </target>

    <target name="do-jar">
        <!-- Get the basename of the basedir (foo, bar, etc.) -->
        <basename file="${basedir}" property="suffix"/>

        <jar jarfile="${build.lib}/${prefix}-${suffix}.jar">
            <fileset dir="${build.classes}">
                <include name="${root}/${suffix}/**"/>
            </fileset>
        </jar>
    </target>
</project> 
```

# html - 如何使列表项中的超链接在溢出时隐藏？

> ID：928903
> 
> 赞同：1
> 
> 时间：2009-05-30T03:11:56.500
> 
> 标签：html, css

超链接总是换行。有没有办法隐藏溢出？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-30T03:13:19.490

以下应该做你想做的。

```
a.specialLink {
    display:inline-block;
    overflow:hidden;
    white-space:nowrap;
    width: 10em;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T03:28:54.187

HTML：

```
<ul id="hide">
    <li><a href="/path">Link</a></li>
</ul> 
```

CSS：

```
#hide li a {overflow: hidden;} 
```

# c# - 强类型母版页多态性 - 嵌套母版页忽略继承属性

> ID：928911
> 
> 赞同：1
> 
> 时间：2009-05-30T03:17:56.113
> 
> 标签：c#, asp.net-mvc, master-pages, viewdata

我目前正在创建一个CMS系统，发现以下不起作用。

我确实有一个不太理想的解决方法，而且感觉很脏。我现在对此很满意，并且对不同的方法并不真正感兴趣（但不要让它阻止你回答）。我所追求的是某种关于它为什么不起作用的解释——它是 ASP.NET MVC 中的一个错误吗？

很难解释，所以我会让我的代码（减去很多绒毛）来说话......希望它有意义！

**编辑：**编译器似乎完全忽略了第二个母版页的“继承”属性——见问题的底部。

**ContentViewData.cs** - 注意它继承自**BaseViewData**

```
public class ContentViewData : BaseViewData
{
    public MyCMS.Data.Models.Content ContentItem { get; set; }
} 
```

**Site.Master - 注意****BaseViewData**类型的强类型视图数据

 **```
<%@ Master
    Language="C#"
    Inherits="System.Web.Mvc.ViewMasterPage<MyCMS.WebSite.ViewData.BaseViewData>" %> 
```

**Content.Master - 注意****ContentViewData**类型的强类型视图数据以及它是**Site.Master**的子母版页的事实

 **```
<%@ Master
    Language="C#"
    MasterPageFile="~/Views/Shared/Site.Master"
    Inherits="System.Web.Mvc.ViewMasterPage<MyCMS.WebSite.ViewData.ContentViewData>" %>

...blah blah blah...

<% Html.RenderPartial("ContentItemImage", Model.ContentItem); %> 
```

**内容项目图像.ascx**

```
<%@ Control
    Language="C#"
    Inherits="System.Web.Mvc.ViewUserControl<MyCMS.Data.Models.Content>" %>

<% if (Model.HasPrimaryPhoto)
   { %>
    <img src="/content/photos/<%= Model.GetPrimaryPhoto.ThumbFileName %>"
         title="<%= Model.GetPrimaryPhoto.Caption %>" />
<% } %> 
```

现在在 Content.Master 中，如果我尝试渲染 ContentItemImage 部分并像我一样引用 ContentViewData 对象（特别是“ContentItem”属性）上的属性 - 在下面重复。

```
<% Html.RenderPartial("ContentItemImage", Model.ContentItem); %> 
```

如果跌倒在那条线上并出现以下错误

> 编译错误
> 
> CS1061：“object”不包含“ContentItem”的定义，并且找不到接受“object”类型的第一个参数的扩展方法“ContentItem”（您是否缺少 using 指令或程序集引用？）

但是，如果我像这样改变事情，一切都很好而且花花公子。

**Content.Master** - 请注意，我将整个模型（ContentViewData 对象）传递给 RenderPartial()，而不是尝试引用 ContentViewData 对象上的属性

```
<%@ Master
    Language="C#"
    MasterPageFile="~/Views/Shared/Site.Master"
    Inherits="System.Web.Mvc.ViewMasterPage<MyCMS.WebSite.ViewData.ContentViewData>" %>

...blah blah blah...

<% Html.RenderPartial("ContentItemImage", Model); %> 
```

**ContentItemImage.ascx** - 注意从 MyCMS.Data.Models.Content 更改为 ContentViewData 类的强类型视图数据。

```
<%@ Control
    Language="C#"
    Inherits="System.Web.Mvc.ViewUserControl<MyCMS.WebSite.ViewData.ContentViewData>" %>

<% if (Model.ContentItem.HasPrimaryPhoto)
   { %>
    <img src="/content/photos/<%= Model.ContentItem.GetPrimaryPhoto.ThumbFileName %>"
         title="<%= Model.ContentItem.GetPrimaryPhoto.Caption %>" />
<% } %> 
```

所以，是的，这行得通，但它不是不在场证明。

在此先感谢，查尔斯。

**编辑：**有趣的是，编译器似乎完全忽略了第二个母版页的“继承”属性。

例如。我可以做到这一点，它仍然可以毫无怨言地编译......

```
<%@ Master
    Language="C#"
    MasterPageFile="~/Views/Shared/Site.Master"
    Inherits="System.Web.Mvc.ViewMasterPage<ThisDoesntExist.AtAll>" %> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T05:23:34.943

有趣...一个合理的猜测是，由于与嵌套母版页的某些交互，您的 ContentViewData 对象正在向上转换到 BaseViewData（如果确实如此，其他人将需要权衡原因）。

你可以验证尝试这个：

```
<% Html.RenderPartial("ContentItemImage", ((MyCMS.WebSite.ViewData.ContentViewData)Model).ContentItem); %> 
```

您的解决方法“有效”的原因是因为您的部分视图是为 ContentViewData 键入的，因此当您传入 Model 时，它会向下转换为该类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T03:20:33.473

从我的编辑中可以看出，编译器似乎完全忽略了嵌套母版页的“继承”属性。

这使我相信 ASP.NET MVC 中的嵌套母版页将始终从其父母版页继承，并且正如我所见证的那样，完全忽略了继承属性。

**编辑：**这里一定有一些魔法......如果我删除'inherits'属性，它将无法编译，因为它不知道 HtmlHelper 类。但是，如果我在那里有“继承”属性，里面有垃圾，它确实可以编译。

不工作

```
<%@ Master
    Language="C#"
    MasterPageFile="~/Views/Shared/Site.Master" %> 
```

有用吗

```
<%@ Master
    Language="C#"
    MasterPageFile="~/Views/Shared/Site.Master"
    Inherits="Sysasfdaasdtem.Web.Mvsdfc.ViewMasterPage<ThisDoesntExist.AtAll>" %> 
```

确实很奇怪。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-16T00:02:57.753

试着做下一件事：

```
<%@ Master
Language="C#"
MasterPageFile="~/Views/Shared/Site.Master"
Inherits="System.Web.Mvc.ViewMasterPage<MyCMS.WebSite.ViewData.ContentViewData>" %>

...blah blah blah...

<%= string.Empty %>

...blah blah blah...

<% Html.RenderPartial("ContentItemImage", Model.ContentItem); %> 
```

不要问任何东西，只需尝试将**<%= string.Empty %>**放入您的母版页代码中，然后使用您的强类型**Model**属性。

# python - Python文件读取+写入

> ID：928918
> 
> 赞同：6
> 
> 时间：2009-05-30T03:21:24.653
> 
> 标签：python, file

我正在将数据库从自定义 MSSQL CMS 移植到 MYSQL - Wordpress。我正在使用 Python 读取一个 txt 文件，该文件具有`\t`划定的列和每行一行。

我正在尝试编写一个 Python 脚本来读取这个文件（fread）并[最终]创建一个带有插入语句的 MYSSQL 就绪 .sql 文件。

我正在阅读的文件中的一行看起来像：

```
1    John Smith    Developer  http://twiiter.com/johns   Chicago, IL 
```

到目前为止我的 Python 脚本：

```
import sys

fwrite = open('d:/icm_db/wp_sql/wp.users.sql','w')

fread = open('d:/icm_db/users.txt','r')

for line in fread:
    print line;

fread.close()
fwrite.close() 
```

我怎样才能“内爆”每一行，以便我可以访问每一列并在其上开展业务？

我需要为我阅读的每一行生成多个 MYSQL 插入语句。所以...对于读取的每一行，我会生成如下内容：

```
INSERT INTO `wp_users` (`ID`, `user_login`, `user_name`) 
VALUES (line[0], 'line[2]', 'line[3]'); 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-30T03:38:16.377

[尽管这很容易实现，但使用csv](http://docs.python.org/library/csv.html)模块确实变得更容易。

```
>>> import csv
>>> reader = csv.reader(open('C:/www/stackoverflow.txt'), delimiter='\t')
>>> for row in reader:
...     print row
...
['1', 'John Smith', 'Developer', 'http://twiiter.com/johns', 'Chicago, IL']
['2', 'John Doe', 'Developer', 'http://whatever.com', 'Tallahassee, FL'] 
```

此外，正如所指出的，Python 中不需要分号。试着改掉这个习惯:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T03:48:39.250

了解确切的列数有助于自行记录您的代码：

```
fwrite = open("d:/icm_db/wp_sql/wp.users.sql","w")

for line in open("d:/icm_db/users.txt"):
  name, title, login, location = line.strip().split("\t")

  # Double up on those single quotes to avoid nasty SQL!
  safe_name = name.replace("'","''")
  safe_login = name.replace("'","''")

  # ID field is primary key and will auto-increment
  fwrite.write( "INSERT INTO `wp_users` (`user_login`, `user_name`) " )
  fwrite.write( "VALUES ('%s','%s');\n" % (safe_name,safe_login) ) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-30T03:25:16.003

你可能想要的是这样的： `data=line.split("\t")`
它会给你一个很好的序列对象来使用。
（顺便说一句，Python 中不需要分号。这里有一个：）`print line;`正如

Dave 指出的那样，这可能会在其中留下一个换行符。在拆分之前在线调用 strip()，如下所示：`line.strip().split("\t")`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-30T03:32:11.653

Python 标准库有一个用于[CSV（逗号分隔值）文件读取和写入](http://docs.python.org/library/csv.html)的模块，可用于处理制表符分隔的文件，例如您的文件。对于这项任务来说，这可能是矫枉过正。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-30T04:08:45.963

```
fwrite = open('/home/lyrae/Desktop/E/wp.users.sql','a')
fread = open('/home/lyrae/Desktop/E/users.txt','r')

for line in fread:
    line = line.split("\t")
    fwrite.write("insert into wp_users ( ID, user_login, user_name ) values (%s, '%s', '%s')\n" % (line[0], line[1], line[2]))

fread.close()
fwrite.close() 
```

假设 users.txt 是：

```
1   John Smith  Developer   http://twiiter.com/johns    Chicago, IL
2   Billy bob   Developer   http://twiiter.com/johns    Chicago, IL
3   John Smith  Developer   http://twiiter.com/johns    Chicago, IL 
```

wp.​​users.sql 看起来像：

```
insert into wp_users ( ID, user_login, user_name ) values (1, 'John Smith', 'Developer')
insert into wp_users ( ID, user_login, user_name ) values (2, 'Billy bob', 'Developer')
insert into wp_users ( ID, user_login, user_name ) values (3, 'John Smith', 'Developer') 
```

假设只有 1 个选项卡分隔 id、名称、位置

# javascript - 带有可编辑复选框列的 jqGrid

> ID：928919
> 
> 赞同：36
> 
> 时间：2009-05-30T03:21:59.647
> 
> 标签：javascript, jquery, jqgrid

使用 jqGrid 时，如何在页面加载以及单击时强制单元格在其可编辑视图中加载？

如果您像下面这样设置“单元格编辑”，则该复选框仅在您单击单元格时出现。

```
{ name: 'MyCol', index: 'MyCol', editable:true, edittype:'checkbox', editoptions: { value:"True:False" },

cellEdit:true, 
```

同样在单击复选框时，是否有一种方法可以立即将 AJAX 帖子发送到服务器，而不必依赖用户按 Enter 键？

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2010-05-06T14:55:32.543

要允许复选框始终可点击，请使用复选框格式化程序的`disabled`属性：

```
{ name: 'MyCol', index: 'MyCol', 
  editable:true, edittype:'checkbox', editoptions: { value:"True:False"}, 
  formatter: "checkbox", formatoptions: {disabled : false} , ... 
```

要回答您的第二个问题，您必须为复选框设置一个事件处理程序，以便在单击一个函数时调用一个函数，例如，向服务器发送一个 AJAX POST。这是一些示例代码，可帮助您入门。您可以将其添加到`loadComplete`事件中：

```
 // Assuming check box is your only input field:
    jQuery(".jqgrow td input").each(function(){
        jQuery(this).click(function(){
            // POST your data here...
        });
    }); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-06-14T20:10:04.843

这是一个旧的，但有很多观点，所以我决定也在这里添加我的解决方案。

我正在使用 JQuery 的 .delegate 函数来创建一个后期绑定实现，这将使您摆脱使用 loadComplete 事件的义务。

只需添加以下内容：

```
$(document).delegate('#myGrid .jqgrow td input', 'click', function () { alert('aaa'); }); 
```

这将晚将该处理程序绑定到网格行上的每个复选框。如果您有多个复选框列，您可能会遇到问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-03-19T15:08:32.550

我遇到了同样的问题，我想我找到了一个很好的解决方案来立即处理复选框单击。主要思想是当用户点击不可编辑复选框时触发 editCell 方法。这是代码：

```
 jQuery(".jqgrow td").find("input:checkbox").live('click', function(){
            var iRow = $("#grid").getInd($(this).parent('td').parent('tr').attr('id'));
            var iCol = $(this).parent('td').parent('tr').find('td').index($(this).parent('td'));
            //I use edit-cell class to differ editable and non-editable checkbox
            if(!$(this).parent('td').hasClass('edit-cell')){
                                   //remove "checked" from non-editable checkbox
                $(this).attr('checked',!($(this).attr('checked')));
                        jQuery("#grid").editCell(iRow,iCol,true);
            }
    }); 
```

除此之外，您应该为您的网格定义事件：

```
 afterEditCell: function(rowid, cellname, value, iRow, iCol){
            //I use cellname, but possibly you need to apply it for each checkbox       
                if(cellname == 'locked'){
                //add "checked" to editable checkbox
                    $("#grid").find('tr:eq('+iRow+') td:eq('+iCol+') input:checkbox').attr('checked',!($("#regions").find('tr:eq('+iRow+') td:eq('+iCol+') input:checkbox').attr('checked')));
                            //trigger request
                    jQuery("#grid").saveCell(iRow,iCol);
                }   
            }, 

            afterSaveCell: function(rowid, cellname, value, iRow, iCol){
                if(cellname == 'locked'){
                    $("#grid").find('tr:eq('+iRow+') td:eq('+iCol+')').removeClass('edit-cell');
                }   
            }, 
```

然后，您的复选框将在每次用户单击它时发送编辑请求。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-26T20:34:44.710

我有一个提交功能，将所有网格行发送到网络服务器。

我使用以下代码解决了这个问题：

```
var checkboxFix = [];
$("#jqTable td[aria-describedby='columnId'] input").each(function () {
        checkboxFix.push($(this).attr('checked'));
}); 
```

然后我混合了从下面的代码中获得的值。

```
$("#jqTable").jqGrid('getGridParam', 'data'); 
```

我希望它可以帮助某人。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-07-15T15:25:47.403

我在下面的链接中分享了完整的代码，如果需要，可以查看。

[http://www.trirand.com/blog/?page_id=393/bugs/celledit-checkbox-needs-an-enter-pressed-for-saving-state/#p23968](http://www.trirand.com/blog/?page_id=393/bugs/celledit-checkbox-needs-an-enter-pressed-for-saving-state/#p23968)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-08-07T10:24:03.430

更好的解决方案：

```
<script type="text/javascript">
    var boxUnformat = function ( cellvalue, options, cell ) { return '-1'; },
        checkboxTemplate = {width:40, editable:true, 
            edittype: "checkbox", align: "center", unformat: boxUnformat, 
            formatter: "checkbox", editoptions: {"value": "Yes:No"},
            formatoptions: { disabled: false }};
    jQuery(document).ready(function($) {         
        $(document).on('change', 'input[type="checkbox"]', function(e){
            var td = $(this).parent(), tr = $(td).parent(),
                checked = $(this).attr('checked'),
                ids = td.attr('aria-describedby').split('_'),
                grid = $('#'+ids[0]),
                iRow = grid.getInd(tr.attr('id'));
                iCol = tr.find('td').index(td);
            grid.editCell(iRow,iCol,true);
            $('input[type="checkbox"]',td).attr('checked',!checked);
            grid.saveCell(iRow,iCol);
        });
    });
</script> 
```

在您的 colModel 中：

```
...
{name:'allowAccess', template: checkboxTemplate}, 
... 
```

# unit-testing - 共享主机计划中的 PHPUnit？

> ID：928924
> 
> 赞同：1
> 
> 时间：2009-05-30T03:23:58.050
> 
> 标签：unit-testing, phpunit, shared-hosting

PHPUnit 效果很好，我真的很喜欢它，我遇到的问题是我的托管计划对查询的持续时间设置了 30 秒的上限。如果 PHPUnit 测试花费的时间比这更长，连接就会被服务器关闭，我永远无法知道我的所有测试是否都通过了。

是否有一种现有的自动方法可以使用 AJAX 运行任意长的测试套件来批处理单元测试，这样它们就不会达到 30 秒的阈值？只要每个单独的测试时间少于 30 秒，我认为它应该可以工作。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-04T08:15:15.137

为什么要在生产服务器上运行测试？您的测试用于在您的开发服务器上运行，以确保您的代码在发送到生产环境之前是好的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T19:55:01.647

您可以使用`set_time_limit`([链接](http://php.net/set_time_limit)) 更改默认超时。这会重置运行时剩余的运行时间。

# objective-c - Objective CA 适合 3D 游戏的语言吗？

> ID：928925
> 
> 赞同：5
> 
> 时间：2009-05-30T03:24:46.817
> 
> 标签：objective-c, performance

我看到很多关于使用哪种语言来开发实时 3D 游戏的争论，普遍的共识是 C 或 C++ 是唯一可以为高端、系统密集型 3D 提供合适性能的语言游戏。我看到很多人说 C#、Java 或 Python 太慢了，尤其是因为垃圾回收。目标 C 怎么样？Objective C 有自动垃圾收集吗？除了自动垃圾收集，还有什么让语言“太慢”或不适合 3D 游戏？

这个问题可能更像是一个“思想实验”，因为我怀疑我是否会开发出一个资源如此繁重以至于需要解决这些问题的游戏，但作为一名程序员，我莫名其妙地痴迷于性能，所以我我还是想知道只是为了我自己的快乐。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-30T03:31:03.107

Objective-C 2.0 在 Mac OS X 10.5 上提供了垃圾收集，但它是可选的——如果你愿意，你仍然可以编译没有垃圾收集的 Objective-C 应用程序。在其他平台（iPhone、Mac OS X pre-10.5 和其他任何平台）上，没有垃圾收集，您必须手动管理内存。

Objective-C 是 C 的*严格*超集，因此您可以根据需要在 Objective-C 中编写纯 C 代码。因此，没有理由不将 Objective-C 用于不适用于使用 C 的游戏。您可以根据需要使用 Objective-C 提供的额外功能。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-30T03:35:41.243

*Objective-C本身*唯一真正的减速是消息传递机制——即便如此，它通常是 Cocoa 框架的组件会减速。Objective-C 的消息发送并没有对性能*造成*太大影响。

无论如何，对于大多数游戏来说，大部分性能瓶颈都来自图形代码：如果你将图形的东西委托给 OpenGL，它的速度快得离谱，那么在游戏中使用 Objective-C 应该没有问题。我可以看到 Objective-C 或 Cocoa 提供瓶颈的唯一其他地方是密集的物理代码——无论如何这可能应该用纯 C/C++ 编写。不过，其他一切都不应该那么重要。

老实说，我敢打赌，现在大多数 OS X 游戏都是使用 Cocoa 框架用 Objective-C 编写的，性能敏感的代码是用纯 C/C++ 编写的（以及使用 OpenGL 的图形代码）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-05-13T15:11:05.547

我也对这个话题感兴趣，我发现了这个 [http://wiki.gnustep.org/index.php/3DKit](http://wiki.gnustep.org/index.php/3DKit)

它看起来已经死了，但现在有了 clang/llvm 2.9，许多 Objective-C 2 的好东西都可以在 linux 上使用，并且拥有 3D API 可能会很有趣。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-30T03:35:00.103

Objective-C 没有自动垃圾收集。Java 有多种垃圾收集方法，其中一些旨在通过定期增量方式与游戏兼容。如果 C# 或其他也有垃圾收集的东西没有多种方法可供选择，其中一些与游戏兼容，我会感到惊讶。

我唯一想到的可能会使游戏不适合 3D 游戏的事情是，如果它被解释并且执行速度特别慢。这不是您上面列出的任何内容的特征。

PS 为了解决您最初的问题，我很确定任何拥有 iPod Touch 或 iPhone 的人都能够告诉您 Objective-C 绝对适合 3D 游戏 :)

# sql - 如何插入名称为 sql 关键字的列

> ID：928926
> 
> 赞同：23
> 
> 时间：2009-05-30T03:25:10.137
> 
> 标签：sql, insert

我需要一个存储键值对的表，因此我创建了一个表，其中包含一个名为“Key”的列和一个名为“Value”的列。

这失败了：

```
insert into mykeyvalues (Key,Value) values ('FooKey', 'FooValue') 
```

“关键字‘key’附近的语法不正确。”

也许我不应该称它为“Key”，但我只是想知道是否可以使用名称为 sql 关键字的列？

谢谢

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-05-30T03:27:40.913

您可以用 [ ] 括号括起来这样的列名。所以：

```
insert into mykeyvalues ([Key],[Value]) values ('FooKey', 'FooValue') 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-05-30T03:28:32.813

在查询中的标识符周围使用反引号 (`) 或双引号 (")。例如：

```
INSERT INTO mykeyvalues ("Key", "Value") values ('FooKey', 'FooValue') 
```

但从长远来看，这只会降低便携性。使用不同的名称更容易。

# php - 确定 PHP 类文件中定义了哪些类

> ID：928928
> 
> 赞同：38
> 
> 时间：2009-05-30T03:26:27.873
> 
> 标签：php, class

鉴于我们项目中的每个 PHP 文件都包含一个类定义，我如何确定文件中定义了哪些类？

我知道我可以正则表达式文件中的`class`语句，但我更愿意做一些更有效的事情。

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2010-01-12T17:37:46.523

对于我正在从事的项目，我需要这样的东西，这是我编写的函数：

```
function file_get_php_classes($filepath) {
  $php_code = file_get_contents($filepath);
  $classes = get_php_classes($php_code);
  return $classes;
}

function get_php_classes($php_code) {
  $classes = array();
  $tokens = token_get_all($php_code);
  $count = count($tokens);
  for ($i = 2; $i < $count; $i++) {
    if (   $tokens[$i - 2][0] == T_CLASS
        && $tokens[$i - 1][0] == T_WHITESPACE
        && $tokens[$i][0] == T_STRING) {

        $class_name = $tokens[$i][1];
        $classes[] = $class_name;
    }
  }
  return $classes;
} 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-05-30T03:39:42.257

如果您只想检查文件而不加载它，请使用[`token_get_all()`](http://php.net/token_get_all)：

```
<?php
header('Content-Type: text/plain');
$php_file = file_get_contents('c2.php');
$tokens = token_get_all($php_file);
$class_token = false;
foreach ($tokens as $token) {
  if (is_array($token)) {
    if ($token[0] == T_CLASS) {
       $class_token = true;
    } else if ($class_token && $token[0] == T_STRING) {
       echo "Found class: $token[1]\n";
       $class_token = false;
    }
  }       
}
?> 
```

基本上，这是一个简单的有限状态机。在 PHP 中，[标记](http://php.net/manual/en/tokens.php)的序列将是：

*   `T_CLASS`：“类”关键字；
*   `T_WHITESPACE`：“类”后的空格；
*   `T_STRING`: 类名。

因此，此代码将处理任何奇怪的间距或换行符，因为它使用 PHP 用于执行文件的相同解析器。如果`token_get_all()`不能解析它，PHP 也不能。

顺便说一句，您[`token_name()`](http://php.net/manual/en/function.token-name.php)可以将令牌编号转换为它的常量名称。

这是我的 c2.php：

```
<?php
class MyClass {
  public __construct() {
  }
}

class MyOtherClass {
  public __construct() {
  }
}
?> 
```

输出：

```
Found class: MyClass
Found class: MyOtherClass 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-05-11T10:10:23.153

或者您可以轻松地使用[Nette\Reflection](https://github.com/nette/reflection)中的 AnnotationsParser （可使用 composer 安装）：

```
use Nette\Reflection\AnnotationsParser;
$classes = AnnotationsParser::parsePhp(file_get_contents($fileName));
var_dump($classes); 
```

输出将是这样的：

```
array(1) {
  ["Your\Class\Name"] =>
  array(...) {
      // property => comment
  },
  ["Your\Class\Second"] =>
  array(...) {
      // property => comment
  },
} 
```

parsePhp [() 方法](https://github.com/nette/reflection/blob/master/src/Reflection/AnnotationsParser.php#L274)基本上与其他答案中的示例类似，但您不必自己声明或测试解析。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-06-17T10:16:20.670

我需要使用名称空间解析文件中的类，所以我修改了代码。如果有人也需要，这里是：

```
public function getPhpClasses($phpcode) {
    $classes = array();

    $namespace = 0;  
    $tokens = token_get_all($phpcode); 
    $count = count($tokens); 
    $dlm = false;
    for ($i = 2; $i < $count; $i++) { 
        if ((isset($tokens[$i - 2][1]) && ($tokens[$i - 2][1] == "phpnamespace" || $tokens[$i - 2][1] == "namespace")) || 
            ($dlm && $tokens[$i - 1][0] == T_NS_SEPARATOR && $tokens[$i][0] == T_STRING)) { 
            if (!$dlm) $namespace = 0; 
            if (isset($tokens[$i][1])) {
                $namespace = $namespace ? $namespace . "\\" . $tokens[$i][1] : $tokens[$i][1];
                $dlm = true; 
            }   
        }       
        elseif ($dlm && ($tokens[$i][0] != T_NS_SEPARATOR) && ($tokens[$i][0] != T_STRING)) {
            $dlm = false; 
        } 
        if (($tokens[$i - 2][0] == T_CLASS || (isset($tokens[$i - 2][1]) && $tokens[$i - 2][1] == "phpclass")) 
                && $tokens[$i - 1][0] == T_WHITESPACE && $tokens[$i][0] == T_STRING) {
            $class_name = $tokens[$i][1]; 
            if (!isset($classes[$namespace])) $classes[$namespace] = array();
            $classes[$namespace][] = $class_name;
        }
    } 
    return $classes;
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-06-20T07:24:42.640

我的片段也是。可以解析具有多个类、接口、数组和命名空间的文件。返回一个由命名空间划分的类+类型（类、接口、抽象）的数组。

```
<?php    
    /**
     * 
     * Looks what classes and namespaces are defined in that file and returns the first found
     * @param String $file Path to file
     * @return Returns NULL if none is found or an array with namespaces and classes found in file
     */
    function classes_in_file($file)
    {

        $classes = $nsPos = $final = array();
        $foundNS = FALSE;
        $ii = 0;

        if (!file_exists($file)) return NULL;

        $er = error_reporting();
        error_reporting(E_ALL ^ E_NOTICE);

        $php_code = file_get_contents($file);
        $tokens = token_get_all($php_code);
        $count = count($tokens);

        for ($i = 0; $i < $count; $i++) 
        {
            if(!$foundNS && $tokens[$i][0] == T_NAMESPACE)
            {
                $nsPos[$ii]['start'] = $i;
                $foundNS = TRUE;
            }
            elseif( $foundNS && ($tokens[$i] == ';' || $tokens[$i] == '{') )
            {
                $nsPos[$ii]['end']= $i;
                $ii++;
                $foundNS = FALSE;
            }
            elseif ($i-2 >= 0 && $tokens[$i - 2][0] == T_CLASS && $tokens[$i - 1][0] == T_WHITESPACE && $tokens[$i][0] == T_STRING) 
            {
                if($i-4 >=0 && $tokens[$i - 4][0] == T_ABSTRACT)
                {
                    $classes[$ii][] = array('name' => $tokens[$i][1], 'type' => 'ABSTRACT CLASS');
                }
                else
                {
                    $classes[$ii][] = array('name' => $tokens[$i][1], 'type' => 'CLASS');
                }
            }
            elseif ($i-2 >= 0 && $tokens[$i - 2][0] == T_INTERFACE && $tokens[$i - 1][0] == T_WHITESPACE && $tokens[$i][0] == T_STRING)
            {
                $classes[$ii][] = array('name' => $tokens[$i][1], 'type' => 'INTERFACE');
            }
        }
        error_reporting($er);
        if (empty($classes)) return NULL;

        if(!empty($nsPos))
        {
            foreach($nsPos as $k => $p)
            {
                $ns = '';
                for($i = $p['start'] + 1; $i < $p['end']; $i++)
                    $ns .= $tokens[$i][1];

                $ns = trim($ns);
                $final[$k] = array('namespace' => $ns, 'classes' => $classes[$k+1]);
            }
            $classes = $final;
        }
        return $classes;
    } 
```

输出这样的东西......

```
array
  'namespace' => string 'test\foo' (length=8)
  'classes' => 
    array
      0 => 
        array
          'name' => string 'bar' (length=3)
          'type' => string 'CLASS' (length=5)
      1 => 
        array
          'name' => string 'baz' (length=3)
          'type' => string 'INTERFACE' (length=9)
array
  'namespace' => string 'this\is\a\really\big\namespace\for\testing\dont\you\think' (length=57)
  'classes' => 
    array
      0 => 
        array
          'name' => string 'yes_it_is' (length=9)
          'type' => string 'CLASS' (length=5)
      1 => 
        array
          'name' => string 'damn_too_big' (length=12)
          'type' => string 'ABSTRACT CLASS' (length=14)
      2 => 
        array
          'name' => string 'fogo' (length=6)
          'type' => string 'INTERFACE' (length=9) 
```

可能会帮助某人！

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-11-01T11:34:23.617

我已经扩展了 Venkat D 的答案，包括返回方法和搜索目录。（这个特定的例子是为 CodeIgniter 构建的，它将返回 ./system/application/controller 文件中的所有方法 - 换句话说，您可以通过系统调用的每个公共 url。）

```
function file_get_php_classes($filepath,$onlypublic=true) {
    $php_code = file_get_contents($filepath);
    $classes = get_php_classes($php_code,$onlypublic);
    return $classes;
}

function get_php_classes($php_code,$onlypublic) {
    $classes = array();
    $methods=array();
    $tokens = token_get_all($php_code);
    $count = count($tokens);
    for ($i = 2; $i < $count; $i++) {
        if ($tokens[$i - 2][0] == T_CLASS
        && $tokens[$i - 1][0] == T_WHITESPACE
        && $tokens[$i][0] == T_STRING) {
            $class_name = $tokens[$i][1];
            $methods[$class_name] = array();
        }
        if ($tokens[$i - 2][0] == T_FUNCTION
        && $tokens[$i - 1][0] == T_WHITESPACE
        && $tokens[$i][0] == T_STRING) {
            if ($onlypublic) {
                if ( !in_array($tokens[$i-4][0],array(T_PROTECTED, T_PRIVATE))) {
                    $method_name = $tokens[$i][1];
                    $methods[$class_name][] = $method_name;
                }
            } else {
                $method_name = $tokens[$i][1];
                $methods[$class_name][] = $method_name;
            }
        }
    }
    return $methods;
}

function mapSystemClasses($controllerdir="./system/application/controllers/",$onlypublic=true) {
    $result=array();
    $dh=opendir($controllerdir);
    while (($file = readdir($dh)) !== false) {
        if (substr($file,0,1)!=".") {
            if (filetype($controllerdir.$file)=="file") {
                $classes=file_get_php_classes($controllerdir.$file,$onlypublic);
                foreach($classes as $class=>$method) {
                    $result[]=array("file"=>$controllerdir.$file,"class"=>$class,"method"=>$method);

                }
            } else {
                $result=array_merge($result,mapSystemClasses($controllerdir.$file."/",$onlypublic));
            }
        }
    }
    closedir($dh);
    return $result;
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-30T03:32:03.027

使用 PHP 的函数**get_declared_classes()**。这将返回当前脚本中定义的类数组。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-07-27T15:39:43.510

您可以忽略这样的抽象类（注意 T_ABSTRACT 标记）：

```
function get_php_classes($php_code)
{
    $classes = array();
    $tokens = token_get_all($php_code);
    $count = count($tokens);
    for ($i = 2; $i < $count; $i++)
    {
        if ($tokens[$i - 2][0] == T_CLASS && $tokens[$i - 1][0] == T_WHITESPACE && $tokens[$i][0] == T_STRING && !($tokens[$i - 3] && $i - 4 >= 0 && $tokens[$i - 4][0] == T_ABSTRACT))
        {
            $class_name = $tokens[$i][1];
            $classes[] = $class_name;
        }
    }
    return $classes;
} 
```

# xslt - 循环 XSL 中的索引

> ID：928935
> 
> 赞同：16
> 
> 时间：2009-05-30T03:31:19.690
> 
> 标签：xslt, loops

我在 XSL 中有两个这样的嵌套循环，此时我使用 position() 但这不是我需要的。

```
<xsl:for-each select="abc">
  <xsl:for-each select="def">
   I wanna my variable in here increasing fluently 1,2,3,4,5.....n
not like 1,2,3,1,2,3
  </xsl:for-each>
</xsl:for-each> 
```

你能给我一些关于这个存根的想法吗？非常感谢你！

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-30T06:01:33.800

使用 XSL，问题是您无法更改变量（它更像是您正在设置的常量）。所以增加一个计数器变量是行不通的。

获取顺序计数（1,2,3,4,...）的笨拙解决方法是调用 position() 来获取“abc”标签迭代，然后调用 position() 来获取嵌套的“def "标签迭代。然后，您需要将“abc”迭代乘以它包含的“def”标签的数量。这就是为什么这是一个“笨拙”的解决方法。

假设您有两个嵌套的“def”标签，XSL 将如下所示：

```
<xsl:for-each select="abc">
    <xsl:variable name="level1Count" select="position() - 1"/>
    <xsl:for-each select="def">
        <xsl:variable name="level2Count" select="$level1Count * 2 + position()"/>
        <xsl:value-of select="$level2Count" />
    </xsl:for-each>
</xsl:for-each> 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2011-04-05T22:41:37.470

只需更改选择要循环的项目的方式：

```
<xsl:for-each select="abc/def">
    <xsl:value-of select="position()"/>
</xsl:for-each> 
```

如果您特别需要保留嵌套循环，请考虑添加另一个循环，如下所示：

```
<xsl:variable name="items" select="//abc/def"/>
<xsl:for-each select="abc">
    <xsl:for-each select="def">
        <xsl:variable name="id" select="generate-id()"/>
        <xsl:for-each select="$items">
            <xsl:if test="generate-id()=$id">
                 <xsl:value-of select="position()"/>
            </xsl:if>
        </xsl:for-each>
    </xsl:for-each>
</xsl:for-each> 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-30T03:51:24.320

```
<xsl:for-each select="abc">
    <xsl:variable name="i" select="position()"/>
    <xsl:for-each select="def">
        <xsl:value-of select="$i" />
    </xsl:for-each>
</xsl:for-each> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-09-11T22:55:02.000

这是处理不同数量子元素的pythonquick答案的扩展：

```
<xsl:for-each select="abc">  
    <xsl:variable name="level1Position" select="position()"/>
    <xsl:variable name="priorCount" select="count(../abc[position() &lt; $level1Position]/def)"/>  
    <xsl:for-each select="def">
        <xsl:variable name="level2Count" select="$priorCount + position()"/>
        <xsl:value-of select="$level2Count" />
    </xsl:for-each>
</xsl:for-each> 
```

输入：

```
<root>
    <abc>
        <def>A</def>
        <def>B</def>
        <def>C</def>
    </abc>
    <abc>
        <def>D</def>
        <def>E</def>
    </abc>
    <abc>
        <def>F</def>
    </abc>
    <abc>
        <def>G</def>
        <def>H</def>
        <def>I</def>
    </abc>
</root> 
```

# iphone - 在 iPhone / Objective-C 上制作精美设计视图的提示和技巧

> ID：928940
> 
> 赞同：6
> 
> 时间：2009-05-30T03:35:04.457
> 
> 标签：iphone, objective-c

**在iPhone**上设置视图样式时，您学到了哪些**编程技巧/窍门**？

 **例如，您可以将**视图的背景颜色设置为图像**：

```
[myView setBackgroundColor:[UIColor colorWithPatternImage: [UIImage imageNamed:@"view-background.png"]]]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T18:22:02.517

我在 iPhone 上创建了一堆自定义视图，我通常在 Adob​​e Fireworks 中设计它们，然后再尝试在 IB 或 XCode 中创建它们。Firework 的原生格式是 PNG，因此很容易在图像和模拟器之间跳转，并调整它们以使视图看起来不错。

至于创建实际视图，我建议使用 UIImageView 作为任何需要自定义背景图像的视图的基类。此外，要使视图透明或半透明，您需要同时设置 opaque=NO 和 backgroundCoor = [UIColor clearColor]。

希望有帮助！

# linq - Linq's Take，什么时候拿结果？

> ID：928948
> 
> 赞同：0
> 
> 时间：2009-05-30T03:43:38.717
> 
> 标签：linq, linq-to-sql

在查询时或整个列表已经在集合中之后，它是否需要指定的数字并停止？

使用“take”时有什么性能优势？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-30T03:46:20.420

所有查询都发生在枚举时。

性能方面，Take 应该能够确定 Grab 多个项目的最有效方式。

这意味着在 Linq to SQL 中转换为“TOP n”语句。

.

我的结果来自`(q.Take(10)).ToString()`：

```
SELECT TOP (10) [t0].[UserID], [t0].[RoleID]
FROM [dbo].[UsersRoles] AS [t0] 
```

.

并且，结果来自`(q.Skip(10).Take(10)).ToString()`：

```
SELECT [t1].[UserID], [t1].[RoleID]
FROM (
    SELECT ROW_NUMBER() OVER (ORDER BY [t0].[UserID], [t0].[RoleID]) AS [ROW_NUMBER], [t0].[UserID], [t0].[RoleID]
    FROM [dbo].[UsersRoles] AS [t0]
    ) AS [t1]
WHERE [t1].[ROW_NUMBER] BETWEEN @p0 + 1 AND @p0 + @p1
ORDER BY [t1].[ROW_NUMBER] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T07:04:45.107

其他答案是关于 LINQ to SQL 的，它也在标签中，但值得一提的是 LINQ to Objects 会按照您的建议进行操作。有效地做这样的事情：

```
int i = 0;
foreach (var item in items) {
    if ( i++ < count ) {
        yield return item;
    }
} 
```

所以换句话说，它只需要它需要的量，并尽快停止。

显然，这意味着：

```
var c = items.Take(10);  // not yet enumerated
c.Count();  // enumerated the first 10
c.Count();  // enumerated the first 10 again 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-30T03:46:51.993

您将只获得从数据库返回的指定记录数，过滤是在 SQL 中完成的。

# iphone - 如何在没有访问权限的情况下在 iPhone 上进行测试？

> ID：928955
> 
> 赞同：1
> 
> 时间：2009-05-30T03:50:37.050
> 
> 标签：iphone, mobile-safari

想为 iphone 写一个网站，但我没有，也不知道有谁有。

有没有一种方法可以在没有访问权限的情况下为它开发，也许苹果为此提供了某种 sim 卡或其他东西。

有人知道吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-30T03:54:58.567

iPhone SDK 包含一个 iPhone 模拟器，可以从这里免费下载：http: [//developer.apple.com/iphone/program/start/register/](http://developer.apple.com/iphone/program/start/register/)

或者，如果您有 Safari 网络浏览器，您可以使用它来获得相当准确的结果： [http](http://www.testiphone.com/) ://www.testiphone.com/或[http://iphonetester.com/](http://iphonetester.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T03:54:54.227

有一个适用于 Aptana 的 iPhone 模拟器（应该适用于任何系统）和一个 Apple 提供的模拟器（如果你有 Mac）。我还没有测试过 Aptana。Apple 相当不错，但它运行大多数网络内容的速度比实际设备快得多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T03:48:18.250

为了快速测试，尝试常规的 Safari 缩放，直到视口的尺寸与 iPhone 的尺寸相似。Safari 也适用于 Windows :) 此外，您可以要求它显示为 iPhone（在“开发”菜单中）并尝试几个站点。

要进行认真的开发，您肯定需要 iPod Touch。您需要熟悉本机和移动 Web 界面的工作原理。SDK 将无法为您提供。

我想知道您正在开发什么样的应用程序。我不认为基于 Web 的应用程序现在有用或带来收入。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-30T16:21:57.070

尝试购买 iPod Touch。它具有您测试代码以确保它已准备好 iPhone 所需的大部分内容。

为了方便起见，可以使用模拟器，但您将无法检查正确的 HIG，例如按钮或文本太小。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-02T11:15:55.693

我建议运行VM ware启动Mac OS ...

虽然你需要一个英特尔 CPU，但仍然值得。

请参阅此处： [如何在 VM 中加载 Mac OS Lion](http://www.windows7hacker.com/index.php/2011/09/how-to-install-fully-functional-mac-os-x-lion-virtual-machine-inside-windows-7/)

# java - 在网页中发送 MIDI 信息

> ID：928957
> 
> 赞同：2
> 
> 时间：2009-05-30T03:51:34.133
> 
> 标签：java, javascript, html, activex, midi

如何在网页中播放单个 MIDI 音符？

我知道两种方法：

1.  编写一个 ActiveX 控件。然后它只适用于Windows。我很久以前就写过ActiveX控件，但现在没人喜欢安装它们。

2.  编写一个 Java 小程序。如果用户已经安装了 Java，但许多用户禁用了小程序，这没关系。我就是这样做的，您可以在 newfweiler.com 上看到结果——如果它恰好适用于您的特定设置。您至少需要 Java 5，尽管我想如果必须的话，我可以用 Java 1.2 重写它。“实时音序器”和“Java 声音合成器”对我不起作用；我认为您必须安装波表或其他东西才能使它们工作。

大多数用户都安装了 Flash，但我查看了 Flash 和 Flex 文档并没有看到任何与 javax.sound.midi 等效的内容。

有几种方法可以在网页中播放 MIDI 文件，您可以找到“Javascript Pianos”，它可以在您按下一个键时播放一个单音符的 MIDI 文件。您不能同时弹奏多个音符或按住键长音符。

我要做的是等效于 javax.sound.midi.Receiver.send(midiMsg, -1) 只使用大多数人通常在机器上安装的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2018-09-28T09:08:05.470

使用 Web Audio API 播放声音和 .mid-files。[请参阅https://surikov.github.io/webaudiofont/examples/midiplayer.html](https://surikov.github.io/webaudiofont/examples/midiplayer.html)中的 MIDI 播放器示例

使用 Web MIDI API（Chrome 支持）来听 MIDI 键盘。[请参阅https://surikov.github.io/webaudiofont/examples/midikey.html](https://surikov.github.io/webaudiofont/examples/midikey.html)中的示例

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T03:54:50.360

Java 仍然可能是您最好的选择，即使有少数用户禁用它。

我使用 NoScript，我可以将网站列入白名单。我想说，如果您提供引人注目的内容，大多数用户可能也会这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-30T04:22:19.493

找到以下内容（翻译自意大利语）。我会说Flash是要走的路。如果您想成为贫民区，您只需获取 88 个左右的钢琴样本，然后根据时间线播放它们。

[http://translate.google.com/translate?prev=hp&hl=en&js=n&u=http%3A%2F%2Fflash.html.it%2Fguide%2Flezione%2F2936%2Fmidi-player%2F&sl=it&tl=en&history_state0=](http://translate.google.com/translate?prev=hp&hl=en&js=n&u=http%3A%2F%2Fflash.html.it%2Fguide%2Flezione%2F2936%2Fmidi-player%2F&sl=it&tl=en&history_state0=)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-12-16T03:29:47.503

[在https://jazz-soft.net/demo/VirtualPiano.html](https://jazz-soft.net/demo/VirtualPiano.html)有一个在线 MIDI 钢琴的例子。 它使用 Web Audio API，不需要任何特殊的软件，但是，如果启用了 Web MIDI，它有更多功能。页面上包含的代码。

# struts2 - Struts2-File Upload Interceptor：上传后文件名不出现

> ID：928958
> 
> 赞同：0
> 
> 时间：2009-05-30T03:53:26.490
> 
> 标签：struts2

在我的 struts2 应用程序中，我使用“文件上传拦截器”。它运行良好，但是在出现相同的jsp页面时上传后它不会在`<s:file>`标签的文本框中显示浏览的文件名，即成功上传后文本框为空。这是我的代码片段-

**主.jsp**

```
<s:form action="smAction" enctype="multipart/form-data" theme="simple">
<s:file name="sample"/>
<s:submit action="uploadSample" value="All upload" />
</s:form> 
```

**struts.xml**

```
<action name=" uploadSample " class=" UploadMySample">
<interceptor-ref name="defaultStack"/>
<result name="input"> /login.jsp</result>
<result name="success">/main.jsp</result>
</action> 
```

**上传MySample.java**

```
public class UploadMySample extends ActionSupport {            
  private File sample;
  private String sampleContentType;
  private String sampleFileName;

  public File getSample () {
      return sample; 
  }
  public void setSample (File sample) {
      this. sample = sample;
  }
  //Here is the file uploading code
  return SUCCESS; 

} 
```

**请建议。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-02-09T16:54:34.747

这不是 Struts 的问题。出于安全原因，现代浏览器不允许为文件上传字段设置值。如果要在上传后显示文件名，则必须使用简单文本。

# sql-server - 商业智能：使用 MS SQL Server 进行数据挖掘？

> ID：928963
> 
> 赞同：2
> 
> 时间：2009-05-30T03:56:31.747
> 
> 标签：sql-server, business-intelligence, data-mining

我必须学习使用 SQL Server 进行数据挖掘。据我所知，SQL Server 中的商业智能支持数据挖掘，但我不太确定。

*   BI 真的支持数据挖掘吗？
*   如何开始使用 SQL Server 进行数据挖掘？我的意思是，诸如书籍、博客等资源

谢谢你们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T06:16:05.517

我建议通过联机丛书文档，特别是“分析服务信息工作者信息中心”开始您的研究，因为所提供的信息主要是为了引起数据分析师的注意。

[http://msdn.microsoft.com/en-us/library/ms174577(SQL.90).aspx](http://msdn.microsoft.com/en-us/library/ms174577(SQL.90).aspx)

使用该参考资料，您可以选择进一步准备特定主题，例如“数据挖掘概念”，随后将引导您了解各种可用的数据挖掘算法。

然后要掌握这项技术，请查看 Microsoft 数据挖掘教程：

[http://msdn.microsoft.com/en-us/library/ms167167.aspx](http://msdn.microsoft.com/en-us/library/ms167167.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T15:08:32.900

每个数据库都支持[数据挖掘](http://nl.wikipedia.org/wiki/Datamining)。处理大量结构化数据是数据库的工作！

首先学习在许多应用程序和数据库中有用的 SQL。

然后，如果您发现无法使用 SQL 解决的问题，您可以求助于：

*   报告服务：创建精美的报告
*   分析服务：分析真正巨大的数据量（如果您考虑数百万行，分析服务器就大材小用了）
*   集成服务：从非 Sql Server 源导入、自动执行任务、以图形方式组合查询

这些是特定于 Sql Server 的，并不是在每个 BI 场景中都有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-05T22:44:35.333

查看此链接 - 我从这些截屏视频中了解到：

[http://sqlblog.com/blogs/denis_gobo/archive/2007/12/13/3937.aspx](http://sqlblog.com/blogs/denis_gobo/archive/2007/12/13/3937.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-30T04:07:53.560

Microsoft BI 堆栈由以下部分组成：

*   SQL Server 报告服务
*   SQL Server 分析服务
*   SQL 服务集成服务

三者的结合将允许您挖掘数据、执行分析并以交互方式显示它们。

我在我的美味帐户中为一些好的链接添加了书签：

[http://delicious.com/syalam/ssrs](http://delicious.com/syalam/ssrs)

# apache - 我可以强制 Apache 不包括失败的 HTTP 基本身份验证的 WWW-Authenticate 标头吗？

> ID：928967
> 
> 赞同：2
> 
> 时间：2009-05-30T04:04:56.960
> 
> 标签：apache, http, http-headers, http-authentication

我正在使用带有 AJAX 请求的 HTTP 基本身份验证。Firefox 3 是个抱怨者，总是显示一个失败凭据的对话框——即使我不想要一个。

[这个问题](https://stackoverflow.com/questions/86105/how-can-i-supress-the-browsers-authentication-dialog)总结了一些浏览器和JS的问题；你会注意到它在客户端没有解决。幸运的是，我至少有一些更改服务器的自由——我可以修改我的`.htaccess`文件。

基本上，只要 Firefox 看到 WWW-Authenticate 标头，它就会再次尝试进行身份验证。 **我可以通过修改我的文件来*仅针对 AJAX 请求抑制该标头吗？*`.htaccess`** 如果是这样，怎么做？如有必要，我可以在 XHR 请求中传递自定义标头。

这是它目前的样子：

```
AuthType Basic
AuthUserFile /www/private/.htpasswd
AuthName "Private Collection"
require valid-user 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-03-31T11:02:22.533

我遇到了一个类似的问题，我通过用 nodejs 编写的代理解决了这个问题。也许这可以帮助你：[在球衣中为自己的服务编写代理/包装类](https://stackoverflow.com/questions/5448975/write-proxy-wrapper-class-for-own-service-in-jersey)

# database - 是否可以更改自增整数主键字段的值？

> ID：928968
> 
> 赞同：1
> 
> 时间：2009-05-30T04:05:33.000
> 
> 标签：database, primary-key

如果我将数据库列设置为自动编号主键字段，自动编号功能会阻止这些值被修改吗？

还是列的主键性质使其不可修改？

两个都？两者都不？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-30T04:14:16.887

与往常一样，这取决于您的数据库。然而，答案很可能两者都不是。

在 SQL Server 中，您无法手动将主键插入标识列，除非您使用以下内容：

```
SET IDENTITY_INSERT [dbo].[MyTable] ON
INSERT INTO [dbo].[MyTable] (id, name) VALUES (1000, 'Foo')
SET IDENTITY_INSERT [dbo].[MyTable] OFF 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-30T04:07:23.700

两者都不。你可以随心所欲地修改它。将列设置为自动增量只是指定新行的默认值，就是这样。之后，它就像一个普通的列。

**编辑：**显然这对于​​ SQL Server 来说不是真的，但你没有指定所以我只是选择了流行的答案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-30T04:15:22.347

你说的是自动增量吗？

在 MS-Sql 中没有，
在 mysql 中是（可能取决于引擎）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-30T04:32:36.440

它与数据库无关。但是，MySQL 和 SQLite（例如）允许您修改自动增量主键：

mysql:

```
create table foo (id INTEGER AUTO_INCREMENT, PRIMARY KEY(id));
insert into foo values (null);
select * from foo;
update foo set id = 2 where id = 1;
select * from foo; 
```

sqlite（有关 AUTOINCREMENT 的实际含义，请参见[http://www.sqlite.org/faq.html#q1 ）：](http://www.sqlite.org/faq.html#q1)

```
create table foo(id INTEGER PRIMARY KEY AUTOINCREMENT);
insert into foo VALUES(null);
select * from foo;
update foo set id = 2 where id = 1;
select * from foo; 
```

# javascript - 如何定位存在相同链接的 jquery click 函数（即在 php foreach 中）？

> ID：928972
> 
> 赞同：1
> 
> 时间：2009-05-30T04:08:31.797
> 
> 标签：javascript, jquery

与 Facebook 在其新闻提要上所做的类似，我希望允许对大量提要项目进行评论，我通过 php foreach 语句提取这些项目。这是创建相同的类。因此，当我单击 .show_comments 时，它会激活所有内容。

我经历了 SO 并发现了类似于您在下面看到的内容……但这对我不起作用。

如何定位单个 .show_comments 以动画和切换所选项目？

```
$j(function() {
    $j(this).find('.show_comments').click(function(){
        $j(this).find('.comments').slideDown("fast");
        $j(this).find(".answer_comments").toggle();
    });

    $j(this).find('.hide_comments').click(function(){
        $j(this).find('.comments').slideUp("fast");
        $j(this).find(".answer_comments").toggle();
    }); 
}); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-30T04:14:17.900

**ID 在 HTML 文档中应该是唯一的。**如果你有几个元素，`id="show_comments"`你做错了，你将无法通过 Javascript 访问超过 1 个元素。对元素进行分组的正确方法是按类。

正确的做法是这样的，假设 HTML 如下所示：

```
<div id="item-1">
....text of whatever people are commenting on....
  <a href='#' class='toggle_comments'>show comments</a>
  <div class='comments' style='display: none;'>
  ... comments ...
  </div>
</div>

<div id="item-2">
....text of whatever people are commenting on....
  <a href='#' class='toggle_comments'>show comments</a>
  <div class='comments' style='display: none;'>
  ... comments ...
  </div>
</div> 
```

然后 Javascript/jQuery 将是：

```
$('a.toggle_comments').toggle(function() {
    $(this).next('div.comments').slideDown('fast');
    $(this).text('hide comments');
}, function() {
    $(this).next('div.comments').slideUp('fast');
    $(this).text('show comments');
}); 
```

[这是它的实际演示](http://jsbin.com/icoki)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T04:12:11.707

#show_comments 是一个 id 并且 ids 需要是*唯一的*。当您生成名称/部分时，请使用类似

```
id='show_comments1' 
```

和

```
id='answer_comments1' 
```

唯一标识两个部分

或者，从引发事件的元素向上遍历树到已知父级，然后找到答案子级并切换（）它

# sql - 使用 MS SQL Identity 是一种好的做法吗？

> ID：928977
> 
> 赞同：5
> 
> 时间：2009-05-30T04:13:36.573
> 
> 标签：sql, sql-server, tsql, identity

在企业应用程序中使用 MS SQL Identity 是一种好的做法吗？创建业务逻辑和将数据库从一个迁移到另一个不是很困难吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-30T05:52:17.703

就个人而言，我不能没有身份列并在任何地方使用它们，但是有一些理由考虑不使用它们。

[最初不使用身份列AFAIK](http://en.wiktionary.org/wiki/AFAIK)的主要原因是由于分布式多数据库模式（断开连接）使用复制和/或各种中间件组件来移动数据。只是没有可用的分布式同步机制，因此没有可靠的方法来防止冲突。由于 SQL Server 确实支持分发 ID，因此这种情况发生了显着变化。但是，它们的使用可能仍然无法映射到更复杂的应用程序控制复制方案。

他们可以泄露信息。帐户 ID、发票号码等。如果我每个月都收到您的发票，我可以大致了解您发送的发票数量或您拥有的客户数量。

我一直在合并客户数据库时遇到问题，而且各方仍希望保留他们的旧帐号。这有时让我质疑我对身份字段的依赖:)

像大多数事情一样，最终的答案是“取决于”特定情况的细节在你的决定中必然会占据很大的比重。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-30T04:58:50.840

是的，它们工作得很好，很可靠，并且表现最好。与非身份字段相比，使用身份字段的一大好处是它们可以处理多个调用者尝试保留新 ID 的所有复杂并发问题。这对代码来说似乎是微不足道的，但事实并非如此。

下面的这些链接提供了一些关于身份字段的有趣信息，以及为什么您应该尽可能使用它们。

1.  [DB：是否使用身份列？](https://stackoverflow.com/questions/186369/db-to-use-identity-column-or-not)
2.  [http://www.codeproject.com/KB/database/AgileWareNewGuid.aspx?display=Print](http://www.codeproject.com/KB/database/AgileWareNewGuid.aspx?display=Print)
3.  [http://www.sqlmag.com/Article/ArticleID/48165/sql_server_48165.html](http://www.sqlmag.com/Article/ArticleID/48165/sql_server_48165.html)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-30T04:27:59.387

是的。

它们通常按预期工作，您可以使用`DBCC CHECKIDENT`命令来操作和使用它们。

最常见的身份概念是提供一个有序的数字列表，作为主键的基础。

**编辑：**我对填充因子错了，我没有考虑到所有插入都会发生在 B 树的一侧。

此外，在您修改后的问题中，您询问了从一个数据库迁移到另一个数据库的问题：

只要迁移是单向复制，身份就完全没问题。如果您有两个需要相互复制的数据库，UniqueIdentifier 列可能是您最好的选择。

请参阅：[您何时真正被迫使用 UUID 作为设计的一部分？](https://stackoverflow.com/questions/703035/when-are-you-truly-forced-to-use-uuid-as-part-of-the-design/703070#703070)讨论何时在数据库中使用 UUID。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-30T05:01:12.210

问题总是：

您*实际*从一个数据库迁移到另一个数据库的可能性有多大？如果您正在构建一个多数据库应用程序，那就是另一回事了，但大多数应用程序永远不会被移植到新的数据库中游——尤其是当它们开始使用像 SQL Server 这样强大的东西时。

身份构造非常好，您不应该使用它的理由非常少。如果你有兴趣，我写了一篇关于身份价值的一些常见神话的博客文章。

[IDENTITY 属性：SQL Server 中一个饱受诟病的构造](http://thehobt.blogspot.com/2009/01/identity-property-much-maligned.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-31T21:51:51.890

关于身份的好文章，[http://www.simple-talk.com/sql/t-sql-programming/identity-columns/](http://www.simple-talk.com/sql/t-sql-programming/identity-columns/)

IMO，现在很少需要迁移到另一个 RDBMS。即使需要，开发可移植应用程序的最佳方式是开发一层存储过程，将您的应用程序与专有功能隔离开来：

[http://sqlblog.com/blogs/alexander_kuznetsov/archive/2009/02/24/writing-ansi-standard-sql-is-not-practical.aspx](http://sqlblog.com/blogs/alexander_kuznetsov/archive/2009/02/24/writing-ansi-standard-sql-is-not-practical.aspx)

# perl - 您如何列出所有本地安装的 CPAN 模块？

> ID：928982
> 
> 赞同：1
> 
> 时间：2009-05-30T04:15:10.537
> 
> 标签：perl, cpan

> **可能重复：**
> [如何获取已安装 CPAN 模块的列表？](https://stackoverflow.com/questions/115425/how-do-i-get-a-list-of-installed-cpan-modules)

我是perl的初学者。

您现在如何列出本地安装的 CPAN 模块？像 PHP 中的梨列表。

# mod-rewrite - Mod重写跳过规则服务器错误

> ID：928988
> 
> 赞同：0
> 
> 时间：2009-05-30T04:24:40.070
> 
> 标签：mod-rewrite

以下代码给了我一个内部服务器错误，我无法确定原因。

```
RewriteEngine On
SetEnv APPLICATION production
RewriteCond %{ENV:APPLICATION} =production
RewriteRule ^.*$ - [S=1] 
RewriteRule ^(.*)$ html/$1.html 
```

它应该做的就是获取网址

```
/test 
```

然后让它参考

```
/html/test.html 
```

在幕后，但前提是环境是生产环境，由 SetEnv 设置

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T05:53:17.560

也许我的mod重写生锈了，但如果我理解它，那似乎与你所说的相反。如果应用程序是生产的，那么它不会重写 url（并且它会跳过规则）。我没有看到任何会导致内部服务器错误的东西。

要做你所说的，你需要这样的东西：

```
RewriteEngine On
SetEnv APPLICATION production
RewriteCond %{ENV:APPLICATION} !=production
RewriteRule ^.*$ - [S=1] 
RewriteRule ^(.*)$ html/$1.html 
```

如果您仍然遇到问题，请检查您的 apache 错误日志，其中包含有关内部服务器错误 500 的最佳信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T14:49:54.263

打开 mod rewrite 日志以获得有用的错误。

```
RewriteLog rewrite_log
ReWriteLogLevel 2 
```

调整详细程度的日志级别。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-30T19:30:52.023

您必须在字符串周围加上引号才能正确比较它

```
RewriteCond %{ENV:APPLICATION} !="production" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-30T11:55:18.123

要么像 Todd Gardner 所说的那样做，要么删除冗余规则并将条件绑定到第二条规则：

```
RewriteEngine On
RewriteCond %{ENV:APPLICATION} =production
RewriteRule ^(.*)$ html/$1.html 
```

此外，我会使用此规则来避免递归：

```
RewriteCond %{ENV:APPLICATION} =production
RewriteRule !^html/ html%{REQUEST_URI}.html 
```

# python - 循环 Python / IronPython 对象方法

> ID：928990
> 
> 赞同：4
> 
> 时间：2009-05-30T04:24:46.717
> 
> 标签：python, reflection, ironpython, introspection, python-datamodel

遍历 Python 对象的方法并调用它们的正确方法是什么？

给定对象：

```
class SomeTest():
  def something1(self):
    print "something 1"
  def something2(self):
    print "something 2" 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-09-19T02:17:33.440

您可以使用检查模块来获取类（或实例）成员：

```
>>> class C(object):
...     a = 'blah'
...     def b(self):
...             pass
... 
...
>>> c = C()
>>> inspect.getmembers(c, inspect.ismethod)
[('b', <bound method C.b of <__main__.C object at 0x100498250>>)] 
```

getmembers() 返回一个元组列表，其中每个元组是 (name, member)。getmembers() 的第二个参数是谓词，它过滤返回列表（在这种情况下，只返回方法对象）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-07-28T00:21:36.517

方法与函数和其他类型的可调用对象...

（解决未知帖子中评论中的问题。）

首先需要注意的是，除了用户自定义的方法，还有内置的方法，内置的方法就是，如[http://docs.python.org/reference/datamodel.html](http://docs.python.org/reference/datamodel.html)的文档说，“真的是内置函数的不同伪装”（它是 C 函数的包装器。）

至于用户定义的方法，正如 Unknown 引用的报价所说：

> 用户定义的方法对象结合了一个类、一个类实例（或 None）和任何可调用对象（通常是一个用户定义的函数）。

但这并不意味着“任何定义`__call__`和附加到对象的东西都是方法”。方法是可调用的，但可调用的不一定是方法。用户定义的方法是对引用内容的包装。

希望这个输出（来自我方便的 Python 2.5.2）将显示区别：

```
IDLE 1.2.2      
>>> class A(object):
    x = 7

>>> A  # show the class object
<class '__main__.A'>
>>> a = A()
>>> a  # show the instance
<__main__.A object at 0x021AFBF0>
>>> def test_func(self):
    print self.x

>>> type(test_func)  # what type is it?
<type 'function'>
>>> dir(test_func)  # what does it have?
['__call__', '__class__', '__delattr__', '__dict__', '__doc__', '__get__',
 '__getattribute__', '__hash__', '__init__', '__module__', '__name__',
 '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__',
 '__str__', 'func_closure', 'func_code', 'func_defaults', 'func_dict',
 'func_doc', 'func_globals', 'func_name']
>>> # But now let's put test_func on the class...
>>> A.test = test_func
>>> type(A.test)  # What type does this show?
<type 'instancemethod'>
>>> dir(A.test)  # And what does it have?
['__call__', '__class__', '__cmp__', '__delattr__', '__doc__', '__get__',
 '__getattribute__', '__hash__', '__init__', '__new__', '__reduce__',
 '__reduce_ex__', '__repr__', '__setattr__', '__str__', 'im_class',
 'im_func', 'im_self']
>>> # See, we just got a wrapper, and the function is in 'im_func'...
>>> getattr(A.test, 'im_func')
<function test_func at 0x0219F4B0>
>>> # Now to show bound vs. unbound methods...
>>> getattr(a.test, 'im_self') # Accessing it via the instance
<__main__.A object at 0x021AFBF0>
>>> # The instance is itself 'im_self'
>>> a.test()
7
>>> getattr(A.test, 'im_self') # Accessing it via the class returns None...
>>> print getattr(A.test, 'im_self')
None
>>> # It's unbound when accessed that way, so there's no instance in there
>>> # Which is why the following fails...
>>> A.test()

Traceback (most recent call last):
  File "<pyshell#25>", line 1, in <module>
    A.test()
TypeError: unbound method test_func() must be called with A instance as
first argument (got nothing instead)
>>> 
```

并且 - 编辑以添加以下附加输出，这也是相关的......

```
>>> class B(object):
    pass

>>> b = B()
>>> b.test = test_func  # Putting the function on the instance, not class
>>> type(b.test)
<type 'function'>
>>> 
```

我不会添加更多输出，但您也可以使一个类成为另一个类或实例的属性，并且即使类是可调用的，您也不会获得方法。方法是使用非数据描述符实现的，因此如果您想了解有关它们如何工作的更多信息，请查找描述符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-10-12T03:13:23.417

此代码片段将调用它会在其中找到的任何内容`obj`并将结果存储在映射中，其中 key 是属性名称 -`dict((k, v()) for (k, v) in obj.__dict__.iteritems() if k.startswith('something'))`

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-30T04:30:56.687

### 编辑

丹尼尔，你错了。

[http://docs.python.org/reference/datamodel.html](http://docs.python.org/reference/datamodel.html)

> 用户定义的方法
> 
> 用户定义的**方法**对象**结合了一个类、一个类实例**（或 None）和**任何可调用对象**（通常是一个用户定义的函数）。

因此，任何定义 __call__ 并附加到对象的东西都是方法。

### 回答

查看对象具有哪些元素的正确方法是使用 dir() 函数。

显然这个例子只适用于不带参数的函数。

```
a=SomeTest()
for varname in dir(a):
    var = getattr(a, varname)
    if hasattr(var, "__call__"):
        var() 
```

# c++ - 不允许嵌套函数，但为什么允许嵌套函数原型？[C++]

> ID：928992
> 
> 赞同：7
> 
> 时间：2009-05-30T04:25:53.113
> 
> 标签：c++, compiler-construction, function, nested

我正在[阅读](https://stackoverflow.com/questions/925513/c-empty-string-constructor)导致我提出这个问题的链接问题。

考虑以下代码

```
int main()
{
    string SomeString();
} 
```

总而言之，编译器将此作为函数原型而不是*字符串*对象。现在考虑以下代码。

```
int main()
{
    string Some()
    {
        return "";
    }
} 
```

编译器说这是无效的，因为我猜嵌套函数定义是不允许的。**如果不允许，为什么允许嵌套函数原型？**它没有带来任何优势，而是造成混乱（或者我在这里遗漏了一些有效的观点？）。

我发现以下是有效的。

```
int main()
{ 
  string SomeFun();
  SomeFun();
  return 0;
}

string SomeFun()
{
  std::cout << "WOW this is unexpected" << std::endl;
} 
```

这也令人困惑。我期待函数*SomeFun()将仅在**main*中具有范围。但是我错了。为什么编译器允许编译上述代码？有没有像上面这样的代码有意义的实时情况？

有什么想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-30T04:42:18.130

您的原型只是“[前向声明](http://en.wikipedia.org/wiki/Forward_declaration)”。请查看维基百科的文章。

基本上，它告诉编译器**“如果以这种方式使用标签‘SomeFun’，请不要惊慌”。** 但是您的链接器负责找到正确的函数体。

你实际上可以声明一个虚假的原型，例如'char SomeFun()'，并在你的主目录中使用它。只有当您的链接器试图找到您的虚假函数的主体时，您才会收到错误消息。但是你的编译器会很酷。

有很多好处。你必须记住函数体并不总是在同一个源代码文件中。它可以在链接库中。此外，该链接库可能具有特定的“链接签名”。使用条件定义，您甚至可以在构建时使用范围内的原型选择正确的链接签名。尽管大多数人会使用函数指针相反。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-30T09:38:19.507

顺便说一句，C++03 确实有一种迂回的方式来定义局部函数。它需要滥用本地类功能：

```
int main()
{
    struct Local
    {
        static string Some()
        {
            return "";
        }
    };
    std::cout << Local::Some() << std::endl;
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-30T04:35:50.417

这是 C++ 所采用的 C 约定——就像许多约定一样。

在 C 语言的另一个函数中声明一个函数的能力是大多数程序员可能认为令人遗憾和不必要的决定。特别是在现代 OOP 设计中，函数定义比 C 中的要小。

如果您想拥有仅存在于另一个函数范围内的函数，则[boost::lambda](http://www.boost.org/doc/libs/1_39_0/doc/html/lambda.html)和[C++1x lambda](http://en.wikipedia.org/wiki/C%2B%2B0x#Lambda_functions_and_expressions)有两个选项。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-30T15:12:44.730

至于为什么你的声明

```
void f() {
    void g(); g();
} 
```

比这个好

```
void g();
void f() {
    g();
} 
```

如果您将声明尽可能保持在本地，这通常会很好，以便尽可能少地发生名称冲突。我说在本地（以这种方式）声明一个函数是否*真的很*幸运是有争议的，因为我认为普通包含它的标题然后采用“通常”的方式仍然更好，这也不会让不知道的人感到困惑。有时，解决阴影函数也很有用

```
void f() {
    int g; 
    // oops, ::g is shadowed. But we can work around that
    {
        void g(); g();
    }
} 
```

当然，在 C++ 中，我们可以`g`使用`its_namespace::g()`- 来调用函数，但在 C 的旧时代，这是不可能的，而这使得程序员仍然可以访问函数。另请注意，虽然在语法上并不相同，但在语义上，以下内容也确实在本地范围内声明了一个函数，该函数实际上针对不同的范围。

```
int main() {
    using std::exit;
    exit();
} 
```

附带说明一下，在更多情况下，声明的目标范围*不是*该声明出现的范围。通常，您声明的实体成为该声明出现的范围的成员。但情况并非总是如此。考虑例如朋友声明，那件事发生的地方

```
struct X { friend void f() { std::cout << "WoW"; } };
int main() { void f(); f(); } // works! 
```

即使函数声明（和定义！）`f`发生在 的范围内`X`，实体（函数本身）也成为封闭命名空间的成员。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-30T04:42:26.057

函数原型是编译器的*提示*。它们表明这些功能在其他地方实现，如果尚未*发现*的话。而已。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-30T08:07:06.090

当你声明一个原型时，你基本上是在告诉编译器等待链接器解决它。根据您编写原型的位置，范围规则适用。在 main() 函数中编写原型在技术上没有任何问题（尽管恕我直言有点混乱），它只是意味着该函数仅在 main() 内部是本地已知的。如果您在源文件的顶部（或更常见的是在头文件中）声明原型，则原型/函数将在整个源文件中是已知的。

```
string foo()
{
  string ret = someString();  // Error
  return ret; 
}

int main(int argc,char**argv)
{
   string someString();
   string s = somestring(); // OK
   ...
} 
```

# arrays - 如果字符串在数组中，则检查 D？

> ID：928993
> 
> 赞同：4
> 
> 时间：2009-05-30T04:27:35.580
> 
> 标签：arrays, d, phobos

如何检查数组中是否出现字符串？我的意思是我可以循环，但是有标准功能吗？

起初我做了：

```
if(str in ["first", "second", "third"]) 
```

但它抱怨`in`只适用于关联数组。

我试图快速查找 phobos 文档，但没有找到任何与数组相关的模块。

那么有什么，还是我只需要手动循环遍历它？

### 编辑：

我在D1，火卫一。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-30T05:08:19.923

如果您的字符串是常量（如示例中所示），则可以使用关联数组文字，但语法并不漂亮：

```
if (str in ["first"[]:0, "second":0, "third":0]) 
```

我不认为你可以在 D1 的 Phobos 中使用库调用，但 D2 的 std.algorithm 有一些你可以使用的东西：

```
if (count(["first", "second", "third"][], str)) 
```

在 Tango 中，您可以使用以下通用`contains`函数`tango.text.Util`：

```
if (contains(["first", "second", "third"][], str)) 
```

请注意，`[]`数组末尾的字面量是必需的，因为我们需要传递静态数组的内存片，而不是按值传递实际的静态数组。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-30T08:50:52.757

使用 D1 Phobos，您必须自己动手。但这并不太难。

```
bool contains(T)(T[] a, T v)
{
    foreach( e ; a )
        if( e == v )
            return true;
    return false;
} 
```

另外，您应该能够像这样使用它：

```
auto words = ["first"[], "second", "third"];
if( words.contains(str) ) ... 
```

希望有帮助。

顺便说一句，您可以修改上述内容以用作“indexOf”函数：

```
size_t indexOf(T)(T[] a, T v)
{
    foreach( i, e ; a )
        if( e == v )
            return i;
    return a.length;
} 
```*************`******