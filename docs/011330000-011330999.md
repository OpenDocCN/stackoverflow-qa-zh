# StackOverflow 问答 11330000-11330999

# php - PHP glob() regex pattern

> ID：11330001
> 
> 赞同：3
> 
> 时间：2012-07-04T13:24:19.670
> 
> 标签：php, regex, glob

I have a folder that contains logos for sponsors. In my website, a user can belong to a sponsor and the sponsor_id is set in session when the user logs in.

Here is my code:

```
function sponsor_logos($sponsor_id) {
    $logos = glob("resources/content/sites/{$sponsor_id}*");

    foreach($logos as $logo) {
        if(file_exists("{$logo}"))
            echo "<img src='/{$logo}' />";
    }
} 
```

The above works, but a sponsor can have multiple logos. So the multiple logos are saved like so: sponsor_id.jpg, sponsor_id_2.jpg, sponsor_id_3.jpg

I am not the strongest at regex, so any help is greatly appreciated! thanks!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T14:12:54.247

您最好打开目录并检查其中的所有文件（如果文件不多）。你可以这样做：

```
function sponsor_logos($sponsor_id) {
    if ($dh = opendir('resources/content/sites/')) {
        while (($file = readdir($dh)) !== false) {
            if(strpos($file, $sponsor_id . '.') === 0) {
                $sponsor_files[] = $file;
            }
            else if(strpos($file, $sponsor_id . '_') === 0) {
                $sponsor_files[] = $file;
            }
        }
        closedir($dh);
    }
    foreach($sponsor_files as $logo) {
        echo "<img src='resources/content/sites/" . $logo . "' />";
    }
} 
```

但最好的解决方案是有正常的命名方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T13:29:57.957

使用这个正则表达式`sponsor_id(_\d+)?\.jpg`

# tomcat - Tomcat 网络健康监控

> ID：11330002
> 
> 赞同：2
> 
> 时间：2012-07-04T13:24:21.853
> 
> 标签：tomcat, servlets, redundancy

我期待第三部分工具/解决方案可以监控我的服务器的网络使用情况，以了解我的服务器资源（例如带宽）是否没有得到高度利用，如果是这样，我可以在我的服务器崩溃之前采取预防措施（例如调用我的辅助服务器来帮助负载共享等）。

目前我已经在我的 servlet 中编写了一个连续的 ping 逻辑，以便我的 2 台服务器（1 台作为主服务器，其他作为备份服务器）应该保持知道另一台服务器是否可用/不活动。

请为我当前的基于 ping 的服务器活力逻辑建议一些标准工具/解决方案。 *请注意，我避免了集中管理所有服务器的解决方案，因为我构建了一个冗余系统，其中每个实例（服务器）都必须自己监控和通知*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T20:33:07.380

Nagios 和 Ichinga 都是免费的开源监控软件系统，它们的工作方式大致相同。您可以集中或分布式地做事。

如果您使用相互 ping 来检查 web 应用程序的活跃度，您可能会感到失望。相反，您应该使用具有故障转移功能的负载平衡器正确地集群服务器。您可以使用 JMX 观察备份服务器上的活动：任何活动高峰都意味着主服务器已关闭（此外，您可以直接检测主服务器）。

至于要检查的值，启动`jconsole`您的 web 应用程序的开发实例并浏览您可以通过 JMX 观察到的各种数据。然后，或者使用类似的东西`check_jmx`（有一个或多个具有该名称的 Nagios 插件）或 Tomcat 的 JMXProxyServlet（Tomcat Manager webapp 的一部分）通过 HTTP 定期获取这些值。

我们使用 JMXProxyServlet + Nagios + 一些自定义脚本来读取来自 JXMProxyServlet 的响应，并将它们转换为 Nagios 能够理解的有意义的响应，它在多个服务器和环境中运行良好，采样了许多不同的值。

# makefile - Automake: different install to target and to toolchain

> ID：11330004
> 
> 赞同：0
> 
> 时间：2012-07-04T13:24:26.793
> 
> 标签：makefile, installation, embedded, autoconf, automake

Maybe I am asking a silly question, but is there any way I can tell automake to put my project include files when I do a "`make dist`" but not when I do a "`make install`"?

Maybe I am not acting the right way, so to make it clearer I will tell what I need.

1.  I need to deploy my applications in an embedded board and I use "`make install`" in a script to create a package that can be copied to the target board.

2.  On the other side, I'd like to be able to update my toolchain with my libraries and include files.

In the first situation, I can't have any fat wasting my limited flash memory but just the necessary things to make the application to run.

In the second one, I need to have headers, pkgconfig and all of the stuff needed for development.

How I am supposed to configure my "`Makefile.am`" and which rules to expect so that I can reach my goals?

Really thanks.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-02-25T13:51:52.600

> 我只是希望能够设置给定的脚本 SUID、其他数据文件 R/W 任意权限等等。

我认为添加 $(DESTDIR) 的 makefile 用户变量可以做到这一点。由于它不是由 automake 定义的，“make install”使用它为空，但 dpkg-buildpackage 用“make dist”目标定义它。

（见：[http](http://www.gnu.org/prep/standards/html_node/DESTDIR.html#DESTDIR) ://www.gnu.org/prep/standards/html_node/DESTDIR.html#DESTDIR ）

它帮助我管理 setuid 安装：

*配置.ac*：

```
# Add option to disable setuid during install, use in distcheck
AC_ARG_ENABLE(setuid-install, 
 AS_HELP_STRING(
 [--disable-setuid-install       do not set setuid flags during install]), 
 [enable_setuid_install=$enableval], [enable_setuid_install="yes"])
AM_CONDITIONAL(SETUID_INSTALL, test x"$enable_setuid_install" = "xyes") 
```

*生成文件.am*：

```
if SETUID_INSTALL
install-data-hook:
        /bin/chmod 4755 $(DESTDIR)$(bindir)myBinary
endif 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T01:09:42.570

我不认为`autoconf`它真的被设计成一个通用的安装程序/卸载程序，它会给你那种控制而至少没有一些痛苦。您正在寻找类似`dpkg-buildpackage`或`rpmbuild`可以将输出拆分`make install`为特定子包的地方，以便您可以拥有：

*   包*foo*用于嵌入式板和可能的工具链，具体取决于包中的内容（DSO、可执行文件和运行时所需的其他文件）
*   为工具链打包*foo-dev*或*foo-devel*（头文件、静态库、开发所需的其他文件）。

# c++ - C 代码在 Windows 中编译，在 Linux 上出现编译错误

> ID：11330012
> 
> 赞同：-1
> 
> 时间：2012-07-04T13:24:43.277
> 
> 标签：c++, linux

somefile.h 的内容：

```
#ifndef __SOMEFILE_H
#define __SOMEFILE_H

#ifdef __cplusplus
extern "C" {
#endif

typedef struct _table_t
{
     void (*somefunction1)();
     void (*somefunction2)(int a);
     void (*somefunction3)(int a, int *b);
}table_t;

void doSomething1();
void doSomething2();

#ifdef __cplusplus
} // error at this line: expected constructor, destructor, or type conversion before '(' token
#endif
#endif 
```

上面显示的是代码片段和我在 Linux 上编译代码时遇到的错误。相同的代码在 Windows 上编译得很好，没有任何抱怨。

关于源文件：

```
all.h is a header file which includes:
#include "header1.h"
#include "header2.h"
#include "header3.h"
#include "somefile.h" 
```

这是 somefile.c 的内容

```
#include "all.h" 
#include "header4.h"
jumptable_t jumptable_a = 
{
       a_function1();
       a_function2(int a);
       a_function3(int a, int *b);
}

//more code
void function1()
{
     a_function1();
}

void function2(int a)
{
    a_function2(a);
}

void function3(int a, int *b)
{
    a_function3(a, b);
}

void doSomething1()
{

}
void doSomething2()
{

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T13:42:42.190

带有前导双下划线的宏是非法的。您需要更改包含防护。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-25T13:06:12.433

你需要`;`在`}`of之后`jumptable_a`。并在 的初始化程序中使用逗号而不是分号`jumptable_a`。

大括号使它看起来像某种类似函数，但事实并非如此。

此外，在`somefile.h`struct 中被调用`table_t`，但在`somefile.c`你正在使用`jumptable_t`中，我认为这是在这里写帖子时引入的错误。

# python - SQLAlchemy 内省

> ID：11330013
> 
> 赞同：3
> 
> 时间：2012-07-04T13:24:48.040
> 
> 标签：python, sqlalchemy, introspection

我想要做的是从 SqlAlchemy 实体定义中获取所有它的 Column()，确定它们的类型和约束，以便能够预验证、转换数据并向用户显示自定义表单。

我该如何自省？

例子：

```
class Person(Base):
    '''
        Represents Person
    '''
    __tablename__ = 'person'

    # Columns
    id = Column(String(8), primary_key=True, default=uid_gen)
    title = Column(String(512), nullable=False)
    birth_date = Column(DateTime, nullable=False) 
```

我想获取这个 id、title、出生日期，确定它们的限制（例如 title 是字符串，最大长度是 512 或birth_date 是 datetime 等）

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-04T15:13:03.687

如果您正在使用`sqlalchemy 0.8`，那么您应该查看新功能[New Class Inspection System](http://www.sqlalchemy.org/trac/wiki/08Migration#NewClassInspectionSystem)。从文档中提取的示例代码：

```
class User(Base):
    __tablename__ = 'user'

    id = Column(Integer, primary_key=True)
    name = Column(String)
    name_syn = synonym(name)
    addresses = relationship(Address)

# universal entry point is inspect()
>>> b = inspect(User)

# column collection
>>> b.columns
[<id column>, <name column>] 
```

否则，请参阅文档的[访问表和列](http://docs.sqlalchemy.org/en/latest/core/schema.html#accessing-tables-and-columns)部分。同样，从文档中提取代码：

```
employees = Table(...)
# or if using declarative
#employees = Employee.__table__

# or just
employees.c.employee_id

# via string
employees.c['employee_id']

# iterate through all columns
for c in employees.c:
    print c

# access a column's name, type, nullable, primary key, foreign key
employees.c.employee_id.name
employees.c.employee_id.type
employees.c.employee_id.nullable
employees.c.employee_id.primary_key
employees.c.employee_dept.foreign_keys 
```

# ipad - 将 HTML 5 播放器分享到 facebook 并使用 IPAD 发布

> ID：11330015
> 
> 赞同：0
> 
> 时间：2012-07-04T13:24:54.597
> 
> 标签：ipad, html, facebook-graph-api, html5-video

我使用 Facebook 图形 API 共享了一个 mp4 视频。它在我的浏览器上运行良好，但当我从我的 IPAD 访问 facebook 时它会播放。

有人知道是什么问题吗？

这是我的元标签

```
<meta property="og:url" content="http://zoowork.com/binitha/flvshare/testhtml6.php?id=8988">

    <meta property="og:description" content="test.">
        <meta property="og:video:width" content="600">

    <meta property="og:video:height" content="338">
        <meta property="video:release_date" content="2012-06-26 14:00:00">

    <meta property="video:tag" content="ass">

    <meta property="video:tag" content="ddddd">

    <meta property="video:duration" content="144">
 <meta property="og:video:type" content="video/mp4" />

    <meta property="og:video" content="http://zoowork.com/binitha/flvshare/sample.mp4" />
<meta name="sailthru.image.thumb" content="http://zoowork.com/binitha/flvshare/fru.jpg">

    <meta name="sailthru.image.full" content="http://zoowork.com/binitha/flvshare/fru.jpg">

    <meta property="og:image" content="http://zoowork.com/binitha/flvshare/fru.jpg"> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T13:46:44.310

问题不是100％清楚问题是什么。iPad 上会发生什么？

查看我们所拥有的信息的一个疯狂猜测是向元标记添加一个安全的视频 URL。如果没有提供，并且您正在通过 SSL 浏览 Facebook，则不会显示视频。

将以下行添加到您的`head`：

```
 <meta property="og:video:secure_url" content="https://zoowork.com/binitha/flvshare/sample.mp4" /> 
```

当然，视频实际上必须在该 url 下可用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T16:17:19.257

1.  uri 是错误的
2.  mp4 必须使用基线配置文件进行编码，否则它将无法在 iOS 上运行：http: [//developer.apple.com/library/mac/#documentation/NetworkingInternet/Conceptual/StreamingMediaGuide/UsingHTTPLiveStreaming/UsingHTTPLiveStreaming.html](http://developer.apple.com/library/mac/#documentation/NetworkingInternet/Conceptual/StreamingMediaGuide/UsingHTTPLiveStreaming/UsingHTTPLiveStreaming.html)

# javascript - 在 Jquery 中使用 .clone() 仅克隆列表中的特定项目

> ID：11330018
> 
> 赞同：0
> 
> 时间：2012-07-04T13:24:57.197
> 
> 标签：javascript, jquery

我正在尝试仅将列表中的选定项目添加到新列表中。例如，我只想将香蕉添加到我的第二个列表中，我的函数中的以下代码将 coll-selected-list 中的所有项目添加到 coll-grouped-list。我怎样才能只克隆特定项目。任何提示都会很棒。

jQuery：

```
$("#coll-selected-list li").clone().appendTo("#coll-grouped-list"); 
```

标记：

```
<ul id="coll-selected-list" class="droptrue sort-drop ui-sortable">
      <li class="sorted">apple</li>
      <li class="sorted">pear</li>
      <li class="sorted">banana</li>
      <li class="sorted">grape</li>
      <li class="sorted">guava</li>
</ul>

<ul id="coll-grouped-list">
</ul> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T13:36:10.307

将自定义数据属性和值添加到要克隆的项目，然后仅定位具有该数据属性和值的项目。

**例如**

```
<ul id="coll-selected-list" class="droptrue sort-drop ui-sortable">
      <li class="sorted">apple</li>
      <li class="sorted">pear</li>
      <li class="sorted" data-action="clone">banana</li>
      <li class="sorted">grape</li>
      <li class="sorted">guava</li>
</ul>

<ul id="coll-grouped-list">
</ul>

$('#coll-selected-list li[data-action="clone"]').clone().appendTo("#coll-grouped-list"); 
```

**工作演示：**

[http://jsfiddle.net/QXEdn/](http://jsfiddle.net/QXEdn/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T16:54:28.303

您可以将类添加到要克隆的元素，例如：

```
<ul id="coll-selected-list" class="droptrue sort-drop ui-sortable">
      <li class="sorted">apple</li>
      <li class="sorted">pear</li>
      <li class="sorted clone">banana</li>
      <li class="sorted">grape</li>
      <li class="sorted">guava</li>
</ul>

<ul id="coll-grouped-list">
</ul>

// get elements with clone class
$('#coll-selected-list li.clone]').clone().appendTo("#coll-grouped-list"); 
```

如果要根据索引克隆元素，可以使用[:eq](http://api.jquery.com/eq-selector/)选择器：

```
// clone li containing bannana
$('#coll-selected-list li:eq(2)]').clone().appendTo("#coll-grouped-list"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T13:28:55.507

您可以使用[`:contains`](http://api.jquery.com/contains-selector/)选择器：

```
$("#coll-selected-list li:contains('banana')").clone().appendTo("#coll-grouped-list"); 
```

请注意，您传递给的字符串`:contains`区分大小写。

这是一个[工作示例](http://jsfiddle.net/jamesallardice/LQ3ax/)。

# php - 我可以通过我的 php 应用程序从任何foursquare 场地获取任何场地提示/照片吗？

> ID：11330020
> 
> 赞同：-1
> 
> 时间：2012-07-04T13:25:02.693
> 
> 标签：php, foursquare

我可以通过我的 php 应用程序从任何foursquare 场地获取场地提示/照片吗？所有的api调用都是免费的吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T12:32:51.870

API 调用是免费的，但有一个使用政策，以下是您需要阅读的资源，以便执行您的要求：

*   [平台规则](https://developer.foursquare.com/overview/venues)
*   [获取提示](https://developer.foursquare.com/docs/venues/tips)
*   [获取照片](https://developer.foursquare.com/docs/venues/photos)

请注意，在拨打两个电话的情况下，您可以拨打一个电话到“[场地详细信息](https://developer.foursquare.com/docs/venues/venues)”，这将为您提供提示和照片（但不是所有照片，我认为最多 6 张）

# c++ - C++ 静态成员变量作用域

> ID：11330021
> 
> 赞同：8
> 
> 时间：2012-07-04T13:25:02.787
> 
> 标签：c++, scope, static-members

标题基本上说明了一切，我想知道 C++ 类的静态成员何时初始化以及何时超出范围。

我需要这个来解决以下问题。我有许多类 Foo 的对象，每个对象都需要访问由另一个类 Bar 封装的资源。同步不是问题，所以我希望所有对象共享同一个 Bar 实例。

我正在使用一个简单的托管指针进行引用计数。

我可以执行以下操作：

```
class Foo {
private:
    static managed_pointer<Bar> staticBar;
public:
    Foo() {
        if(!staticBar)
            staticBar = new Bar;
    }
    /*
     * use staticBar in various non-static member functions
     */
};

managed_pointer<Bar> Foo::staticBar = NULL; 
```

managed_pointer staticBar 应该在 Bar 对象超出范围后立即删除它 - 但是什么时候会发生这种情况？当 Foo 的最后一个实例被破坏时？在应用程序退出？

谢谢你的建议！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-04T13:26:38.493

`static`s 和 globals 在程序启动之前初始化（在`main`被调用之前，程序实际上在此之前启动）并在退出后超出范围`main`。

例外 - 局部静态（在函数内部声明的静态变量）和未使用的模板类`static`成员。

它与实例的数量无关。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-04T13:29:44.130

该标准没有指定精确的初始化顺序，它是特定于实现的。它们将在程序开始时被实例化并在结束时被释放。

你必须非常小心你正在做的事情，因为如果你有一些其他依赖这个对象存在的静态对象，那就是 UB。不知道它们将以什么顺序被初始化。

您可能会查看 boost::call_once 之类的东西以确保它被初始化一次，但我不会依赖于静态初始化的顺序。

据我所知，你的代码可以工作，但我之前一直被静态初始化问题所困扰，所以我想警告你。

编辑：同样在您的代码中，当 managed_ptr 超出范围（程序结束）时，它将自动删除分配的内存。但是您不应该在 Bar 的析构函数中做任何不重要的事情，因为您可能会通过调用其他释放的实例甚至已删除的代码来触发 UB（就像我曾经在删除动态库时发生的那样）。基本上你是在一个雷区，所以要小心。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-04T14:55:05.370

The first thing that pops out of your question is the common misconception that *scope* and *lifetime* are equivalent concepts. They are not. In some cases as with local variables, the *lifetime* is bound to a particular *context*, but that is not always the case.

A class static member variable has *class scope* (it is accessible *anywhere* in the program) and *static lifetime*, which means that it will be initialized in order with respect to the other static variables in the same translation unit, and in an undefined order with respect to other static variables in other translation units, *before* main (caveat: initialization need not be performed before the first statement in main, but it is guaranteed to be before the first *odr-use* of the variable).

# java - 更改默认 java 安装

> ID：11330022
> 
> 赞同：0
> 
> 时间：2012-07-04T13:25:03.273
> 
> 标签：java

我在 Windows 7 机器上安装了许多 Java 版本。其中一些是 32 位，一些是 64 位。现在默认情况下，它会启动最后一个版本（1.7 64 位）。如何告诉我的 Windows 7 机器使用另一个版本的 Java？原因之一是我正在从 Microsoft Visual Studio C++ 开发一个 JNI 项目——它也使用 java 1.7 64 位。

最好的问候，安德烈

我已经设定：

用户变量：JAVA_HOME=C:\j2sdk1.4.2_04 PATH=%JAVA_HOME%\bin;%PATH%

和系统变量： JAVA_HOME=C:\j2sdk1.4.2_04 PATH=...a_lot_of_paths...;%JAVA_HOME%\bin;%PATH%

我不知道哪个更好设置 - 用于用户或系统设置。两样都做。

系统重启。

而且......它没有帮助:(当我从cmd运行“java -version”时，我有java 1.7，但没有像PATH中定义的java 1.4。

运行 C:>where java 后，我得到了两个结果：

C:\Windows\System32\java.exe C:\j2sdk1.4.2_04\bin\java.exe

谁让Java进入我的windows目录？？？！！！

如何处理？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T13:26:10.417

尝试设置 JAVA_HOME 环境变量。这可能会有所帮助，但我不确定 Microsoft Visual Studio 是否尊重它。

JAVA_HOME 应设置为您要使用的 JRE/JDK 所在的目录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T13:31:39.453

您可以在`PATH`变量中找到 java 工具（javac、java、javaw 等）的路径。因此，您可以编辑`PATH`变量以使用不同的 java 版本。如果您使用其他东西（如应用程序服务器），您应该检查文档并设置适当的系统变量（JAVA_HOME 等）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T13:34:06.940

也许尝试：

```
set JAVA_HOME=C:\jdk1.6.0u24
set PATH=%JAVA_HOME%\bin;%PATH% 
```

并查看这些主题：

[Windows中的JRE安装目录](https://stackoverflow.com/questions/3930383/jre-installation-directory-in-windows)

[windows上的unix“which java”等效命令？](https://stackoverflow.com/questions/3454424/unix-which-java-equivalent-command-on-windows)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-04T13:34:33.907

设置 JAVA_HOME：

```
JAVA_HOME="c:\path\to\jdk" 
```

设置路径：

```
PATH=%JAVA_HOME%\bin;%PATH% 
```

此外，您可能想查看有 Java 设置/Java 控制面板的控制面板，您也可以从那里设置默认值，但如果我没记错的话，这仅对您的浏览器有效。

您也很可能需要重新启动。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-04T18:43:57.317

转到您的控制面板，然后打开经典视图，单击 Java 以调出 Java 控制面板，单击 Java 选项卡并单击视图按钮。它将向您显示计算机上可见的每个 java 运行时环境，然后您可以启用和禁用其他环境，只留下您想要的环境。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-04T14:12:26.900

如果您想设置将影响 Windows 7 机器上运行的所有应用程序的默认 Java 配置，@carlspring 的答案是正确的，但我不相信这是您所要求的。

如果您要求 Visual Studio 使用与默认使用的 JDK 不同的 JDK，则必须为 Visual Studio 单独配置此项。

通过编辑`VCVARS32.BAT`（通常在 C:\Program Files\Microsoft Visual Studio\VC98\Bin 中找到）并添加这样的行来设置它...

```
set PATH=C:\\Java\\jdk1.6.0_03\\bin;%PATH% 
```

...然后你告诉 VS 使用这个比默认情况下更旧的 JDK。

进一步阅读：[MSDN 为命令行构建设置路径和环境变量](http://msdn.microsoft.com/en-us/library/f2ccy3wt%28v=vs.80%29.aspx)

# javascript - 跨浏览器启用/禁用鼠标滚轮

> ID：11330023
> 
> 赞同：3
> 
> 时间：2012-07-04T13:25:06.690
> 
> 标签：javascript, jquery, scroll

我有 2 个按钮：“disable_scroll”和“enable_scroll”用于启用/禁用鼠标滚动。禁用滚动效果很好：

```
 var cancelscroll = function(e) {
      e.preventDefault();
 };

  $("#disable_scroll").on("click", function () {
       if ("onmousewheel" in document) { // for browser except FF
            document.onmousewheel = cancelscroll;
       } else { // for  FF
            document.addEventListener('DOMMouseScroll', cancelscroll);
       }
  }); 
```

但是当我想启用鼠标滚动时，我在 Firefox 中遇到了问题。在 Firefox 中，鼠标滚动不会打开（在其他浏览器中，此代码运行良好）。请任何人都可以帮助找到错误？

```
 $("#enable_scroll").on("click", function () {
            if ("onmousewheel" in document) { // for brouzers except FF
                document.onmousewheel = function(e){};
            } else { // for  FF
                document.addEventListener('DOMMouseScroll', function(e){});
            }
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T13:44:05.137

这适用于任何地方：[https ://github.com/brandonaaron/jquery-mousewheel/blob/master/jquery.mousewheel.js](https://github.com/brandonaaron/jquery-mousewheel/blob/master/jquery.mousewheel.js)

你像这样使用它：

```
$('#test3')
                .hover(function() { log('#test3: mouseover'); }, function() { log('#test3: mouseout'); })
                .mousewheel(function(event, delta, deltaX, deltaY) {
                    log('#test3: I should not have been logged');
                })
                .unmousewheel(); 
```

# html - 用于印刷的 CSS 和 HTML 书籍

> ID：11330030
> 
> 赞同：4
> 
> 时间：2012-07-04T13:25:22.090
> 
> 标签：html, css, printing

好的，假设我想写一本书只使用 HTML 和 CSS。我将如何定义页眉和页脚（并在页脚中有页码）？以及如何使分页符和边距显示在浏览器中（如预览模式）？

我知道这听起来像是我在要求某人为我编写代码，但我真的只需要为这样的事情提供资源方向。我只是完全坚持我什至会开始做这样的事情。

解释我想在浏览器中显示的内容；我希望能够像在 PDF 查看器中一样查看每个页面的小版本，基本上文本溢出会创建分页符：

![缩略图](../Images/536e9701c5392b6916a02226f101514e.png)

我研究了@media print，但它没有任何用于创建页眉和页脚的钩子。

我无法让它工作（来自[w3.org](http://www.w3.org/TR/css3-gcpm/#running-elements)）：

```
title { position: running(header) }
@page { @top-center {
  content: element(header) }
} 
```

我看过[Boom 的代码！](http://www.alistapart.com/articles/boom/), 而且打印效果很好，但在浏览器中显示的效果不一样。

那么......现在有没有人可以/应该为此寻找一个好的起点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T13:47:32.127

这是我的解决方案：

```
<div id='document'>
    <div class='page'>
        <div class='header'></div>
        <div class='footer'></div>
        <div class='content'></div>
    </div>
</div> 
```

一切都进去了`<div id='document'>`。对于每个`.page`，`.header`、`.footer`和`.content`具有页面的正确高度和宽度。

之后，我使用 JavaScript 删除了所有溢出到`div.content`. 然后我克隆`div.page`，更新了新页面标题内的页码`<div>`，并填充了新页面的内容`<div>`。

重复此操作，直到我有 100 页，并且最后一页的内容没有突出`<div>`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T13:48:43.290

我假设您使用的是纯 HTML，并且后面没有代码。

因为如果背后有任何代码，那就是另一回事了。

定义一个主 div 具有`class="page"`. 在里面为页眉、内容和页脚定义了 3 个 div。

```
.page {
   display: block;
   height: 800px; 
   width: 100%;
   /*Give margin as per your requirement.*/
}

.header {
   display: block;
   height: 50px;
}

.content {
   display: block:
   height: 700px;
}

.footer {
   display: block;
   height: 50px;
} 
```

根据您的要求添加其他样式。

使用媒体类型=“打印”创建另一个样式表

为页面添加以下样式。

```
.page {
   display: block;
   height: 800px; 
   width: 100%;
   /*Give margin as per your requirement.*/
    /* this will print the page in new paper*/
   page-break-after: always;
} 
```

一页的 HTML 看起来像这样

```
<div class="page">
  <div class="header">HEADER CONTENT</div>
  <div class="content"> MAIN PAGE'S CONTENT</div>
  <div class="footer"></div>
</div> 
```

根据您需要的页数重复上述代码。

您也可以为此目的使用表格布局。

如果你使用后面的代码，那么内容可以动态生成。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T13:38:11.710

好吧，它可以通过纯 HTML 和 CSS 来完成，但绝对不是要走的路，因为每次你想开始一个新页面时，重复几乎相同的代码块会变得非常令人沮丧。对于像左面板这样的 PDF，您可以使用 iframe，更多信息[在这里](http://www.w3schools.com/html/html_iframe.asp)

基本上，你会为你的书的每一页制作一个 .htm 页面，通过链接严格链接在一起，当你完成后，你可以对你制作的每一页进行截图，保存缩略图，然后制作另一个 html 页面将是面板，最终将包含在本书的所有其他页面中（如我链接中的教程所示）。

**更新**

关于分页符，您可以使用相同的类制作 div-s，并将样式设置为页面，如下[所示](http://jsfiddle.net/wpWbN/1/)

# php - 从关系中提取数据

> ID：11330040
> 
> 赞同：1
> 
> 时间：2012-07-04T13:26:01.873
> 
> 标签：php, activerecord, yii

我正在做一个网上商店。我有两个模型：`Product`和`Category`. `Product`可以有一个类别，而类别可以有多个产品。

我已经在`models`. 我可以访问类别和产品。但我想获得特定类别的所有产品。我已经尝试了许多使用官方文档中的“懒惰”和“渴望”方法的关系查询示例，但没有成功。你能解释一下如何实施吗？

这是我的代码：

类别控制器：

```
public function relations()
{
    return array(
        'products' => array(self::HAS_MANY, 'Product', 'category_id'),
    );
} 
```

产品控制器：

```
public function relations()
{
    return array(
        'category' => array(self::BELONGS_TO, 'Category', 'category_id'),
    );
} 
```

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T15:21:31.483

你可以做

```
Category::model()->with('products')->findByPk(1); 
```

您可以访问诸如

```
$the_category->products->name 
```

这将返回数组，您可以查看`debugging purposes`by

```
CVarDumper::Dump($the_category->products->name,100,true); 
```

你们可以使用`foreach`循环访问每个`index`

```
$products = $the_category->products;
foreach ($products as $the_product) 
{
    echo "Name: " . $the_product['name'] . "<br />";
} 
```

# php - 指定 'php_value error_log' 的相对路径

> ID：11330041
> 
> 赞同：6
> 
> 时间：2012-07-04T13:26:02.347
> 
> 标签：php, apache, .htaccess, error-handling

我不想将error_log的绝对路径放在我的.htaccess中，而是想找到一种相对于.htaccess文件（或类似文件）指定它的方法：

```
php_value error_log %{DOCUMENT_ROOT}/libs/log/error/PHP_errors.log 
```

这将是我想做的事情，但这似乎不起作用。如果我指定绝对值，它确实有效。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-04T13:56:59.187

您可以将其设置为`./path/error.log`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-02-26T08:36:05.147

当您有权访问服务器配置时，您可以添加以下行：

```
# set this to your document-root path
Define DOCROOT   "d:\htdocs" 
```

在你的 htaccess 中你可以写：

```
php_value error_log ${DOCROOT}/libs/log/error/PHP_errors.log 
```

有了这个定义，您甚至可以替换使用文档根目录的所有其他地方，例如

```
DocumentRoot "${DOCROOT}" 
```

@see：[https ://httpd.apache.org/docs/2.4/de/mod/core.html#define](https://httpd.apache.org/docs/2.4/de/mod/core.html#define)

# c# - 如何在服务器端 C# 使用 Javascript 生成的图像？

> ID：11330042
> 
> 赞同：0
> 
> 时间：2012-07-04T13:26:07.843
> 
> 标签：c#, javascript, c#-2.0, google-visualization, jsapi

我正在关注本教程。 [http://www.battlehorse.net/page/topics/charts/save_google_charts_as_image.html](http://www.battlehorse.net/page/topics/charts/save_google_charts_as_image.html)

这是演示页面。 [http://www.battlehorse.net/attach/topics/charts/google_charts_to_image.html](http://www.battlehorse.net/attach/topics/charts/google_charts_to_image.html)

当我们单击转换为图像按钮时，javascript 将画布转换为图像。我想使用该饼图生成在服务器端发生的 PDF 报告。

您能否为此提供最佳解决方案？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T13:40:10.053

您已经从画布中获得了图像，因此其余部分是此处的副本： [C# 中的 JPG 到 PDF 转换器](https://stackoverflow.com/questions/1642280/jpg-to-pdf-convertor-in-c-sharp)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T02:43:13.677

我找到了另一种方法来做到这一点。

我创建了 SaveImage.aspx，它接受表单发布数据（Base64String(data:image/png;base64) 和文件名）并保存文件。

单击按钮时，我生成谷歌图表并将 ajax 发布数据（数据：图像/png；base64）发送到 SaveImage.aspx，该页面保存图像。然后使用该图像生成 PDF。

如果你们有更好的解决方案，请随时指出。

# c# - C# Crystal Reports 在 Windows XP 上登录失败

> ID：11330055
> 
> 赞同：1
> 
> 时间：2012-07-04T13:26:58.950
> 
> 标签：c#, crystal-reports

我在其他程序员的帮助下编写了这段代码。此代码在 Windows 7 上运行时运行良好，但当我在 Windows XP 上安装程序时登录失败。我已经在 Windows XP 机器上安装了 Crystal Reports 的 .Net Framework 4.0 和 CRforVS_13_0_3。

```
using CrystalDecisions.CrystalReports.Engine;
using CrystalDecisions.Shared; 

label2.Text = Convert.ToString(BAssistencia.nroo);
ReportDocument segredo = new ReportDocument();
        segredo.Load(@"C:/Relatorios/CrystalReport3.rpt");
        ParameterField pf1 = new ParameterField();
        ParameterFields pf1s = new ParameterFields();
        ParameterDiscreteValue pdv = new ParameterDiscreteValue();
        TableLogOnInfo tabla = new TableLogOnInfo();
        TableLogOnInfos tablas = new TableLogOnInfos();
        ConnectionInfo infocon = new ConnectionInfo();
        Tables crtables;

        infocon.ServerName = "server";
        infocon.DatabaseName = "database";
        infocon.UserID = "user";
        infocon.Password = "password";
        infocon.IntegratedSecurity = false;

        crtables = segredo.Database.Tables;
        foreach (CrystalDecisions.CrystalReports.Engine.Table crtable in crtables)
        {
            tabla = crtable.LogOnInfo;
            tabla.ConnectionInfo = infocon;
            crtable.ApplyLogOnInfo(tabla);
        }

        pf1.Name = "@pedido";
        pdv.Value = label2.Text;
        pf1.CurrentValues.Add(pdv);
        pf1s.Add(pf1);
        crystalReportViewer1.ParameterFieldInfo = pf1s;

        crystalReportViewer1.ReportSource = segredo; 
```

我究竟做错了什么？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T15:22:47.557

一些链接，第一个是我编写的与 Crystal 一起使用的扩展方法（在 XP、Vista 和 7 以及 Server 2003、2008 上，它们在那里工作）。

*   .Net 的 Crystal Reports 扩展方法：http: [//www.blakepell.com/Main/BlogEntry.aspx? EntryID=e2fcdcf9-312e-4911-8572-20178c94660b](http://www.blakepell.com/Main/BlogEntry.aspx?EntryID=e2fcdcf9-312e-4911-8572-20178c94660b)

这里的第二个有一个不同的问题，但最后（在我咆哮之前）我有一些关于在运行时交换连接的陷阱的信息。

*   [http://www.blakepell.com/Blog/?p=15](http://www.blakepell.com/Blog/?p=15)

上面提供的代码在我的所有环境中都适用于我。现在，在您的情况下，您还需要确保 XP 框也可以访问 Crystal 之外的数据库服务器（没有防火墙阻止，服务器没有拒绝它访问，没有 ACL 阻止网络路由等）。多年来，我发现与 Crystal 交换连接非常特别。

# silverlight - 我无法在 iPad 上下载 Silverlight 运行时。？

> ID：11330056
> 
> 赞同：0
> 
> 时间：2012-07-04T13:27:00.763
> 
> 标签：silverlight

我正在使用 Ipad，版本为 5.1，但我无法下载 Silverlight 运行时来运行我的应用程序。

那么有人知道为什么它不允许下载吗？

它说 safari 无法下载此文件。

谢谢..！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T13:28:05.040

可以找到答案：

[http://forums.silverlight.net/t/158649.aspx/1](http://forums.silverlight.net/t/158649.aspx/1)

# c# - LINQ 计数在 int 数组中继续重复项（int）？

> ID：11330064
> 
> 赞同：5
> 
> 时间：2012-07-04T13:27:39.500
> 
> 标签：c#, .net, linq, algorithm

这是我的问题的一个场景：我有一个数组，比如说：

```
{ 4, 1, 1, 3, 3, 2, 5, 3, 2, 2 } 
```

结果应该是这样的（数组元素=>它的计数）：

```
4 => 1
1 => 2
3 => 2
2 => 1
5 => 1
3 => 1
2 => 2 
```

我知道这可以通过`for loop`.

但是谷歌使用 LINQ 使用较少的代码行来使这成为可能，但没有成功。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-04T13:45:22.097

我相信做到这一点的最佳方法是使用迭代器块创建“类似 LINQ”的扩展方法。这允许您对数据进行单次传递来执行计算。请注意，如果您只想对一小部分数字执行计算，那么性能根本不重要。当然，这实际上是你变相的 for 循环。

```
static class Extensions {

  public static IEnumerable<Tuple<T, Int32>> ToRunLengths<T>(this IEnumerable<T> source) {
    using (var enumerator = source.GetEnumerator()) {
      // Empty input leads to empty output.
      if (!enumerator.MoveNext())
        yield break;

      // Retrieve first item of the sequence.
      var currentValue = enumerator.Current;
      var runLength = 1;

      // Iterate the remaining items in the sequence.
      while (enumerator.MoveNext()) {
        var value = enumerator.Current;
        if (!Equals(value, currentValue)) {
          // A new run is starting. Return the previous run.
          yield return Tuple.Create(currentValue, runLength);
          currentValue = value;
          runLength = 0;
        }
        runLength += 1;
      }

      // Return the last run.
      yield return Tuple.Create(currentValue, runLength);
    }
  }

} 
```

请注意，扩展方法是通用的，您可以在任何类型上使用它。使用 比较值是否相等`Object.Equals`。但是，如果您愿意，您可以传递一个`IEqualityComparer<T>`以允许自定义值的比较方式。

您可以使用这样的方法：

```
var numbers = new[] { 4, 1, 1, 3, 3, 2, 5, 3, 2, 2 };
var runLengths = numbers.ToRunLengths(); 
```

对于您输入的数据，结果将是这些元组：

```
4 1
1 2
3 2
2 1
5 1
3 1
2 2

```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-04T13:46:03.263

（添加另一个答案以避免对我删除的一个计入这个的两个赞成票......）

我对此进行了一些思考（现在我已经理解了这个问题），并且真的*不清楚*你如何在 LINQ 中很好地做到这一点。肯定有一些方法可以完成，可能使用`Zip`or `Aggregate`，但它们相对不清楚。使用`foreach`非常简单：

```
// Simplest way of building an empty list of an anonymous type...
var results = new[] { new { Value = 0, Count = 0 } }.Take(0).ToList();

// TODO: Handle empty arrays
int currentValue = array[0];
int currentCount = 1;

foreach (var value in array.Skip(1))
{
    if (currentValue != value)
    {
        results.Add(new { Value = currentValue, Count = currentCount });
        currentCount = 0;
        currentValue = value;
    }
    currentCount++;
}
// Handle tail, which we won't have emitted yet
results.Add(new { Value = currentValue, Count = currentCount }); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-04T14:01:09.447

这是一个有效的 LINQ 表达式（编辑：稍微收紧代码）：

```
var data = new int[] { 4, 1, 1, 3, 3, 2, 5, 3, 2, 2 };
var result = data.Select ((item, index) =>
                        new
                        {
                            Key = item,
                            Count = (index == 0 || data.ElementAt(index - 1) != item) 
                                ? data.Skip(index).TakeWhile (d => d == item).Count ()
                                : -1
                        }
                          )
                  .Where (d => d.Count != -1); 
```

这[是一个证明](http://ideone.com/2rWll)它有效的证据。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-04T13:49:22.917

这还不够短？

```
public static IEnumerable<KeyValuePair<T, int>> Repeats<T>(
        this IEnumerable<T> source)
{
    int count = 0;
    T lastItem = source.First();

    foreach (var item in source)
    {
        if (Equals(item, lastItem))
        {
            count++;
        }
        else
        {
           yield return new KeyValuePair<T, int>(lastItem, count);
           lastItem = item;
           count = 1;
        }
    }

    yield return new KeyValuePair<T, int>(lastItem, count);
} 
```

我有兴趣看到一种 linq 方式。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-05T19:18:54.383

[我已经在那边](https://stackoverflow.com/a/11311070/8155)写好了你需要的方法。这是如何调用它。

```
foreach(var g in numbers.GroupContiguous(i => i))
{
  Console.WriteLine("{0} => {1}", g.Key, g.Count);
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-06T00:59:22.720

看哪（你可以直接在 LINQPad 中运行它——这`rle`就是魔法发生的地方）：

```
var xs = new[] { 4, 1, 1, 3, 3, 2, 5, 3, 2, 2 };

var rle = Enumerable.Range(0, xs.Length)
                    .Where(i => i == 0 || xs[i - 1] != xs[i])
                    .Select(i => new { Key = xs[i], Count = xs.Skip(i).TakeWhile(x => x == xs[i]).Count() });

Console.WriteLine(rle); 
```

当然，这是 O(n^2)，但您没有在规范中要求线性效率。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-01-07T20:24:35.200

```
var array = new int[] {1,1,2,3,5,6,6 };
foreach (var g in array.GroupBy(i => i))
{
    Console.WriteLine("{0} => {1}", g.Key, g.Count());
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-07-04T13:44:28.477

```
var array = new int[]{};//whatever ur array is
array.select((s)=>{return array.where((s2)=>{s == s2}).count();}); 
```

唯一的问题是，如果你有 1-2 次，你会得到 1-2 次的结果

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-01-07T20:13:32.450

```
var array = new int[] {1,1,2,3,5,6,6 };
var arrayd = array.Distinct();
var arrayl= arrayd.Select(s => { return array.Where(s2 => s2 == s).Count(); }).ToArray(); 
```

**输出**

```
arrayl=[0]2 [1]1 [2]1 [3]1 [4]2 
```

* * *

## 回答 #10

> 赞同：-4
> 
> 时间：2012-07-04T13:35:03.490

试穿`GroupBy`_`List<int>`

```
 List<int> list = new List<int>() { 4, 1, 1, 3, 3, 2, 5, 3, 2, 2 };
        var res = list.GroupBy(val => val);
        foreach (var v in res)
        {
            MessageBox.Show(v.Key.ToString() + "=>" + v.Count().ToString());
        } 
```

# mysql - 如何使用 group by 关键字按 sql 获取组计数？

> ID：11330066
> 
> 赞同：0
> 
> 时间：2012-07-04T13:27:50.153
> 
> 标签：mysql, sql

每个人，

我有一个按 postid 检索所有日期组的 sql，如下所示：

```
Select * from table group by postid; 
```

但我需要计算总组。下面对我不起作用，它列出了每个组的计数！但我需要总组数！

```
Select count(*) from table group by postid; 
```

如何获取此 sql 的所有行号？（按postid从表组中选择*；）

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-04T13:34:18.297

```
SELECT COUNT(DISTINCT postid) FROM `table` 
```

# android - 如何删除traces.txt

> ID：11330069
> 
> 赞同：5
> 
> 时间：2012-07-04T13:28:00.187
> 
> 标签：android, stack-trace, logcat, trace, android-logcat

```
E/dalvikvm(5717): Unable to open stack trace file '/data/anr/traces.txt': Is a directory 
```

关于 LogCat 中的这个 ErrorMessage，我想删除 traces.txt 目录并创建一个文件。我在哪里可以找到它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T13:38:30.520

命令行：

> $亚行外壳
> 
> $ cd数据/anr/
> 
> $ rmdir traces.txt

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T16:32:20.337

由于 traces.txt 是一个目录，您可能想要执行 rmdir traces.txt

# java - grails XML 到对象绑定

> ID：11330073
> 
> 赞同：0
> 
> 时间：2012-07-04T13:28:06.017
> 
> 标签：java, xml, grails

是否有 grails 插件或库可以将 XML 数据映射到 Java 类对象？

我正在寻找一些将 xml 数据映射到 Java 类字段的 groovy 类。

- -更新 - - -

下面的 grails 服务类试图做这个映射，但它不起作用。

有人会提示如何更正下面的代码以使其正常工作吗？

谢谢

* * *

```
class DataBinderService {

boolean transactional = false
def grailsApplication
private BeanWrapper wrapper = new BeanWrapperImpl()

public List bindAllXmlData (Class targetClass, GPathResult source, List properties) {
    if (targetClass == null || source == null || properties == null) return null
    def resultList = []
    def  className = WordUtils.uncapitalize(targetClass.simpleName)
    source[className]?.each {
        def boundObj = bindXmlData(targetClass, it, properties)
        System.out.println(boundObj)
        resultList.add(boundObj)
    }
    return resultList
}

public Object bindXmlData (Class targetClass, GPathResult source, List properties) {
    if (targetClass == null || source == null || properties == null) return null
    def targetObject = grailsApplication.classLoader.loadClass(targetClass.name).newInstance()
    if (targetObject) {
        return bindXmlData(targetObject, source, properties)
    } else {
        return null
    }
}

public Object bindXmlData (Object target, GPathResult source, List properties) {
    if (target == null || source == null || properties == null) return null
    wrapper.registerCustomEditor (Date.class, new CustomDateBinder())
    wrapper.setWrappedInstance(target)
    properties.each {String property ->
        if (property.contains('.')) {//This indicates a domain class to bind e.g. experiment.id -> Experiment
            def propertyName = property.tokenize('.')
            def id = source[propertyName[0]]["@${propertyName[1]}"]?.toString()
            if (id != null) {
                def subdomainInstance = null
                try {subdomainInstance = grailsApplication.classLoader.loadClass("edu.kit.iism.experimentcenter.${WordUtils.capitalize(propertyName[0])}").get(id)} catch (Exception ex) {}
                if (subdomainInstance != null) wrapper.setPropertyValue(propertyName[0], subdomainInstance)
            }
        } else if (property.equals('id')) { //The id property is set as an attribute rather than text
            def id = source['@id']?.toString()
            if (id != null) wrapper.setPropertyValue(property, id)
        } else { //regular attributes
            def prop = source[property]?.toString()
            if (prop != null) wrapper.setPropertyValue(property, prop)
        }
    }
    return target
} 
```

}

# javascript - javascript中的合成日期

> ID：11330074
> 
> 赞同：0
> 
> 时间：2012-07-04T13:28:07.487
> 
> 标签：javascript

```
var mydate = new Date();
var theyear = mydate.getFullYear();
var themonth = mydate.getMonth() + 1;
var thetoday = mydate.getDate();

txtbox.value="04-Jul-2012" 
```

我必须将今天的日期和 txtbox 日期转换为“04/07/2012”格式，我该怎么做。

我必须将今天的日期与 txtbox 日期进行比较。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T13:34:13.517

使用 date.js javascript 库。 [http://www.datejs.com/2007/11/27/getting-started-with-datejs/](http://www.datejs.com/2007/11/27/getting-started-with-datejs/)

```
var d1 = Date.parse('04-Jul-2012');
alert(d1.toString('dd/MM/yyyy')); 
```

日期比较

```
var today = Date.today();
var past = Date.today().add(-6).days();
var future = Date.today().add(6).days();

Date.compare(today, future);                    // -1
Date.compare(today, new Date().clearTime());    // 0
Date.compare(today, past)                       // 1 
```

# mongodb - 在 MongoDB 中存储可搜索值的数组

> ID：11330075
> 
> 赞同：0
> 
> 时间：2012-07-04T13:28:08.233
> 
> 标签：mongodb, database-design

我需要在我的`Users`集合中的每个文档中存储角色 ID 和角色名称。我需要能够说“获取具有 xyz 角色的用户”或“获取具有名称包含 'XYZ' 的角色的用户”，诸如此类。

这在蒙戈甚至可能吗？

现在，我正在存储这样的数据：

```
{
    "_id": {
        "$id": "4fe30e3db92f5d2a5c000000"
    },
    "alias": "rogue_coder",
    "display_name": "Rogue Coder",
    "email": "rogue@example.com",
    "roles": {
        "4fe30e5fb92f5d6f53000000": "Super Administrator"
    }
} 
```

有了它，我可以查看用户是否具有给定角色，但我无法获取所有具有包含“超级”一词的角色的用户。关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T13:52:43.683

MongoDB 支持用于匹配键值的正则表达式。

看看这个[MongoDB 正则表达式](http://www.mongodb.org/display/DOCS/Advanced+Queries#AdvancedQueries-RegularExpressions)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T14:12:40.130

不确定，但你可以试试这样

```
db.collection.find( { roles: { /super.*/i } ); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-04T14:34:53.303

根据您的尝试，您可能必须将 role_id 和 role_name 存储在单独的数组中，如下所示：

```
{
    "_id": {
        "$id": "4fe30e3db92f5d2a5c000000"
    },
    "alias": "rogue_coder",
    "display_name": "Rogue Coder",
    "email": "rogue@example.com",
    "role_names": [
        "Super Administrator"
    ],
    "role_ids" : [
        "4fe30e5fb92f5d6f53000000"
    ]
} 
```

# c# - TransmitFile 在文件末尾缺少单个字节

> ID：11330076
> 
> 赞同：3
> 
> 时间：2012-07-04T13:28:10.173
> 
> 标签：c#, asp.net, transmitfile

传递的参数是：

```
`C:\Licenses\testfolder\PERSONAL-Wednesday 04 July-0405.txt`,`c2license.txt` 
```

功能是：

```
/// <summary>
/// Starts serving the download
/// </summary>
public static void InitStoreDownload(string filePath, string serveFileName)
{
    // Get size of file
    var f = new FileInfo(filePath);

    var fileSize = f.Length;
    var extension = f.Extension;

    var context = HttpContext.Current;

    context.Response.Clear();
    context.Response.Buffer = false;

    // Correct mime type
    if (extension.Equals(".zip", StringComparison.CurrentCultureIgnoreCase))
        context.Response.ContentType = "application/octet-stream";
    else if (extension.Equals(".txt", StringComparison.CurrentCultureIgnoreCase))
    {
        context.Response.ContentType = "text/plain";
    }

    context.Response.AddHeader("Content-Disposition", "attachment; filename=" + serveFileName);
    context.Response.AddHeader("Content-Length", fileSize.ToString());
    context.Response.TransmitFile(filePath);
    context.Response.Close();

    context.Response.End();
} 
```

服务器上的`C:\Licenses\testfolder\PERSONAL-Wednesday 04 July-0405.txt`文件长 475 字节。

使用此脚本获取时下载的文件为 474 字节，文件末尾缺少一个字节。（最后一个字节是句号，存在于服务器上的文件中，但通过此函数下载时不存在）。这会导致文件无效。

我们正在挠头试图找出为什么缺少一个字节，有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T13:33:25.300

尝试使用

```
Response.TransmitFile(filePath);
HttpContext.Current.ApplicationInstance.CompleteRequest(); 
```

代替

```
Response.Close();
Response.End(); 
```

或者正如其他提到的：

`Flush()`之前打电话`Close()`

```
Response.TransmitFile(filePath);
Response.Flush();
Response.Close();
Response.End(); 
```

或省略调用`Close()`并`End()`直接调用，因为它包括刷新响应。

```
Response.TransmitFile(filePath);
Response.End(); 
```

There´s a [thread](https://stackoverflow.com/questions/1087777/is-response-end-considered-harmful) about Response.End() 也许它包含对您有用的信息。

# java - 访问国家漏洞数据库

> ID：11330080
> 
> 赞同：-4
> 
> 时间：2012-07-04T13:28:32.477
> 
> 标签：java

我想知道如何通过 Java 代码访问国家漏洞数据库 (NVD)

(http://nvd.nist.gov/) 是否有任何预定义的功能。

提前谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T13:36:26.200

他们提供数据提要，您可以在[此处找到](http://nvd.nist.gov/download.cfm "这里")

因为它是常规的 RSS，所以应该很容易使用 Java 获取它

# r - R包依赖问题

> ID：11330089
> 
> 赞同：2
> 
> 时间：2012-07-04T13:29:24.257
> 
> 标签：r, package

我创建了一个 R 包，它对其他包有一定的依赖关系。所以我在描述文件中将包名指定为 Imports 和 Depends。在命名空间文件中，我指定应该导出包。我检查了编写 R 扩展手册，似乎没有其他任何我应该添加的内容。

当我尝试运行包时，它无法调用包所依赖的函数。是否需要指定其他参数才能调用这些函数。

我正在使用 R 版本 2.15.0

请帮我解决这个问题。

谢谢。

```
NAMESPACE:
import("RHive")
export("bigEDA")
export("procFreq")
export("procUnivariate") 
```

我希望 RHive 的所有功能都存在于与我的包相同的环境中。只是无法做到这一点。我已经尝试指定`export("RHive")`，`exportFrom("RHive","rhive.query")` 这也不起作用。:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T15:05:29.217

您是否`R CMD check NAMEofYOURpackage`在终端或 shell 中运行以测试您的 DESCRIPTION 和 NAMESPACE 文件是否正常？此检查例程会创建文件 00install.out，它可以提示您哪里出了问题。

如果您只想在包中使用来自外部包的函数，请使用DESCRIPTION 文件。您只需输入：`Depends: RHive`

使用`export`NAMESPACE 文件中的 将您的函数导出给用户。如果您有一个功能`sum()`，并且您希望安装您的软件包的用户能够使用此功能，请使用：（`exportMethods(sum)`您可以在此处添加更多功能，用逗号分隔它们）

# iphone - 核心数据：是否可以在 group by 中使用自定义功能

> ID：11330090
> 
> 赞同：8
> 
> 时间：2012-07-04T13:29:26.237
> 
> 标签：iphone, objective-c, sqlite, core-data

在objective-c中制作NSFetchRequest时，是否可以按组使用自定义函数（strftime）？sql 语句在 sqlite 中完全有效：

```
select date, count(*) from note group by strftime('%Y%m%d', date) 
```

然而，经过一天的挖掘和尝试各种方法和解决方案后，我得出结论，在单个 sql fetch 中使用核心数据是不可能的。我将 NSFetchRequest 与 setPropertiesToGroupBy 一起使用（仅限 iOS 5.0）。

更新。有一个使用苹果提供的核心数据获取此类行为的[示例。](http://developer.apple.com/library/ios/#samplecode/DateSectionTitles/Introduction/Intro.html#//apple_ref/doc/uid/DTS40009939)但是，我启用了“-com.apple.CoreData.SQLDebug 1”来显示核心数据执行的 SQL。看来，核心数据没有执行我想要的 SQL。它只是使用第一个 sql 查询将它们全部选中，然后遍历执行多个“SELEC .. WHERE ID IN ....” SQL 查询的组。控制台的摘录：

```
2012-07-05 10:34:57.244 DateSectionTitles[1139:fb03] CoreData: sql: SELECT 0, t0.Z_PK     FROM ZEVENT t0 ORDER BY t0.ZTIMESTAMP
2012-07-05 10:34:57.245 DateSectionTitles[1139:fb03] CoreData: annotation: sql   connection fetch time: 0.0010s
2012-07-05 10:34:57.246 DateSectionTitles[1139:fb03] CoreData: annotation: total fetch    execution time: 0.0015s for 52 rows.
2012-07-05 10:34:57.247 DateSectionTitles[1139:fb03] CoreData: sql: SELECT 0, t0.Z_PK, t0.Z_OPT, t0.ZTIMESTAMP, t0.ZTITLE FROM ZEVENT t0 WHERE  t0.Z_PK IN  (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  ORDER BY t0.ZTIMESTAMP LIMIT 20
2012-07-05 10:34:57.248 DateSectionTitles[1139:fb03] CoreData: annotation: sql connection fetch time: 0.0012s
2012-07-05 10:34:57.249 DateSectionTitles[1139:fb03] CoreData: annotation: total fetch execution time: 0.0022s for 20 rows.
2012-07-05 10:34:57.250 DateSectionTitles[1139:fb03] CoreData: sql: SELECT 0, t0.Z_PK, t0.Z_OPT, t0.ZTIMESTAMP, t0.ZTITLE FROM ZEVENT t0 WHERE  t0.Z_PK IN  (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  ORDER BY t0.ZTIMESTAMP LIMIT 20
2012-07-05 10:34:57.281 DateSectionTitles[1139:fb03] CoreData: annotation: sql connection fetch time: 0.0303s
2012-07-05 10:34:57.281 DateSectionTitles[1139:fb03] CoreData: annotation: total fetch execution time: 0.0310s for 20 rows. 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-04T15:01:41.333

是的你可以。组装你的`NSFetchedResultsController`类似：

```
 NSFetchedResultsController *aFetchedResultsController =
  [[NSFetchedResultsController alloc] initWithFetchRequest:fetchRequest 
  managedObjectContext:someManagedObjectContext
  sectionNameKeyPath:@"yearOnly" // <== 
  cacheName:@"cacheAsneeded"]; 
```

然后在你的 NSManagedObject 类中添加一个方法来使用`sectionNameKeyPath`

```
- (int)yearOnly { // 
   NSCalendar *cal = [NSCalendar currentCalendar];
   return [[cal components:NSYearCalendarUnit fromDate:self.date] year];
} 
```

该请求将返回按年份分组的结果，以便遇到的每个年份都将成为一个部分。

如果您也需要按月分组，您可能需要适当地更改日历组件。

为 count(*) 添加一个`NSExpression`到您的 fetchRequest：

```
 NSExpression * many = [NSExpression expressionForFunction:@"count:" arguments:[NSArray arrayWithObject:[NSExpression expressionForKeyPath:@"someAttribute"]]]; 
```

# c++ - 如何在不破坏非活动选择颜色的情况下更改 wxTextCtrl 的背景颜色？

> ID：11330092
> 
> 赞同：3
> 
> 时间：2012-07-04T13:29:31.877
> 
> 标签：c++, colors, wxwidgets, background-color

我想通过将文本字段的背景设置为错误时的红色和成功输入时的白色来指示 wxGTK 应用程序中的输入错误。但是，当通过 设置`SetBackgroundColor`背景颜色时，非活动选择的背景颜色将设置为*相同*颜色。这会导致将背景颜色设置为白色时出现非常不利的情况：由于所选文本的前景色为白色，而所选文本的背景颜色现在也是白色，因此文本不可读。

如何重置 wxTextCtrl 上的颜色，使非活动选定文本具有灰色背景（SetBackgroundColour 之前的默认设置）？`SetBackgroundStyle( wxBG_STYLE_SYSTEM)`是我的第一个猜测，但对 wxGTK 没有影响。

代码示例：

```
#include <wx/textctrl.h>
#include <wx/frame.h>
#include <wx/defs.h>
#include <wx/app.h>

class App : public wxApp {
    bool OnInit() {
        wxFrame* frame = new wxFrame(NULL, wxID_ANY, wxT("Frame"));
        wxTextCtrl* text = new wxTextCtrl( frame, wxID_ANY, wxT("foo bar") );
        text->SetBackgroundStyle( wxBG_STYLE_COLOUR );
        text->SetBackgroundColour( *wxWHITE );
        frame->Show();
        return true;
    }
};

IMPLEMENT_APP( App ); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T13:33:14.107

您可以尝试使用 SetDefaultStyle，我自己没有尝试过，但这里是 wxwidgets 文档的摘录：

```
text->SetDefaultStyle(wxTextAttr(*wxRED));
text->AppendText("Red text\n");
text->SetDefaultStyle(wxTextAttr(wxNullColour, *wxLIGHT_GREY));
text->AppendText("Red on grey text\n");
text->SetDefaultStyle(wxTextAttr(*wxBLUE);
text->AppendText("Blue on grey text\n"); 
```

这很可能允许您独立于文本更改颜色和/或更改文本本身的颜色。这是我找到此代码片段的 wxTextCtrl 文档的链接：http: [//docs.wxwidgets.org/2.8/wx_wxtextctrl.html](http://docs.wxwidgets.org/2.8/wx_wxtextctrl.html)

问候， 罗因

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-05-18T21:35:37.063

试过这个，它的工作原理：

```
 TextCtrl1->SetBackgroundColour(wxColour(0xFF,0xA0,0xA0));
  TextCtrl1->SetStyle(0, -1, TextCtrl1->GetDefaultStyle()); 
```

# php - 添加新类别和子类别 - Magento

> ID：11330096
> 
> 赞同：0
> 
> 时间：2012-07-04T13:29:48.213
> 
> 标签：php, magento, categories

我需要的是从 .csv 文件中添加新的类别和子类别。我可以创建新的根类别，但我不知道如何创建子类别：

```
$category = Mage::getModel('catalog/category');
$category->setStoreId(0);

  $rootCategory['name'] = 'Reserved';
  $rootCategory['path'] = "1"; // for root category
  $rootCategory['display_mode'] = "PRODUCTS_AND_PAGE";
  $rootCategory['is_active'] = 1;

  $category->addData($rootCategory);
$parentCategory= $category; // doesn't work, but i want here to get this (root) category id
  try {
    $category->save();
  }
  catch (Exception $e){
    echo $e->getMessage();
  } 
```

CSV 文件的格式如下：

```
root_cat_id;subcat_id;subcat_name;subsubcat_id;subsubcat_name;
ex.
1;2;Animal;3;Dog; 
```

如何获取刚刚添加的类别的 id，并添加与该类别相关的子类别？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T13:42:25.833

要使一个类别成为另一个类别的子类别，请在保存之前将路径设置为父类别路径。

```
$childCategory->setPath($parentCategory->getPath()) 
```

子类别保存后（因此有一个ID），该ID会在`save()`调用后自动附加到路径属性中。
Magento 还会自动为您设置 parent_id 和 level 属性。

# c++ - 标识符“do”未定义

> ID：11330098
> 
> 赞同：0
> 
> 时间：2012-07-04T13:29:54.593
> 
> 标签：c++

我不得不问这个问题，因为我找不到任何匹配的结果。“Do”有很多`identifier "x" is undefined`但没有。

所以，我收到错误消息：`identifier "Do" is undefined`，并且不知道如何解决它。

我以前遇到过错误：`identifier "string" is undefined`，我通过将其更改为`std::string`并添加来解决该错误`#include <string>`。我为“Do”尝试了相同的方法，但 Do 不是`namespace std`.

值得指出的是，我正在使用 Visual C++ 并正在编辑半条命 2 源代码。

谁能帮我理解为什么会出现这个错误以及如何解决它？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T13:53:10.330

您似乎将关键字与类型混淆了。在 C++ 中，`string`是一种引入的类型，`<string>`它驻留在`namespace std`.

`do`是一个关键字（完全不同），它是小写的（不是`Do`）。您不需要为关键字添加任何内容，编译器应该可以直接识别它们。

# c# - 如果 Outlook 打开，则只能通过 Outlook 发送电子邮件

> ID：11330101
> 
> 赞同：14
> 
> 时间：2012-07-04T13:30:03.037
> 
> 标签：c#, outlook-2010

我想使用[此处](http://www.codeproject.com/Tips/165548/C-Code-snippet-to-send-an-Email-with-attachment-fr)所述的通过 Outlook 发送电子邮件。只要我已经打开 Outlook，它就可以正常工作。因此，例如，如果 Outlook 被最小化并且我执行我的代码，那么我可以发送电子邮件就好了。但如果 Outlook 已关闭，则会出现异常：

```
{System.Runtime.InteropServices.COMException (0x80004004): Operation aborted (Exception from HRESULT: 0x80004004 (E_ABORT))
   at Microsoft.Office.Interop.Outlook._MailItem.get_Recipients()
   at OutlookExample.Form1.btnSendEmail_Click(Object sender, EventArgs e) in C:\Users\abc\Documents\Visual Studio 2008\Projects\OutlookExample\OutlookExample\Form1.cs:line 28} 
```

这是代码：

```
using Outlook = Microsoft.Office.Interop.Outlook;

...

private void btnSendEmail_Click(object sender, EventArgs e)
{
    try
    {
        Outlook.Application oApp = new Outlook.Application();
        Outlook.MailItem oMsg = Outlook.MailItem)oApp.CreateItem(Outlook.OlItemType.olMailItem);
            oMsg.HTMLBody = "Hello, here is your message!";
            oMsg.Subject = "This is a test message";
            Outlook.Recipients oRecips = (Outlook.Recipients)oMsg.Recipients;
            Outlook.Recipient oRecip = (Outlook.Recipient)oRecips.Add("rhr@sonlinc.dk");
            oRecip.Resolve();
            oMsg.Send();
            oRecip = null;
            oRecips = null;
            oMsg = null;
            oApp = null;
    }
    catch (Exception ex)
    {
        MessageBox.Show(ex.ToString());
    }
} 
```

为什么这不起作用？

**编辑：这是解决方案**

```
using Outlook = Microsoft.Office.Interop.Outlook;

...

private void btnSendEmail_Click(object sender, EventArgs e)
{
    try
    {
        Outlook.Application oApp = new Outlook.Application();

        // These 3 lines solved the problem
        Outlook.NameSpace ns = oApp.GetNamespace("MAPI");
        Outlook.MAPIFolder f = ns.GetDefaultFolder(Outlook.OlDefaultFolders.olFolderInbox);
        System.Threading.Thread.Sleep(5000); // test

        Outlook.MailItem oMsg = Outlook.MailItem)oApp.CreateItem(Outlook.OlItemType.olMailItem);
            oMsg.HTMLBody = "Hello, here is your message!";
            oMsg.Subject = "This is a test message";
            Outlook.Recipients oRecips = (Outlook.Recipients)oMsg.Recipients;
            Outlook.Recipient oRecip = (Outlook.Recipient)oRecips.Add("rhr@sonlinc.dk");
            oRecip.Resolve();
            oMsg.Send();
            oRecip = null;
            oRecips = null;
            oMsg = null;
            oApp = null;
    }
    catch (Exception ex)
    {
        MessageBox.Show(ex.ToString());
    }
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-04T13:35:10.433

以下代码对我来说已经可靠地工作了几个月：

```
 app = new Microsoft.Office.Interop.Outlook.Application();
            Microsoft.Office.Interop.Outlook.NameSpace ns = app.GetNamespace("MAPI");
            f = ns.GetDefaultFolder(OlDefaultFolders.olFolderInbox);
            Thread.Sleep(5000); // a bit of startup grace time. 
```

如果Outlook是打开的，它会使用它，如果不是它打开它。当然，如果您的 Outlook 要求您登录，您的代码将不允许这样做。某些系统使您难以自动登录。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2014-01-29T14:58:28.617

我不喜欢使用 Thread.Sleep 5 秒的想法，所以我找到了另一个对我有用的解决方案：

您只需要获取新创建的 MailItem 的 Inspector 对象

```
Outlook.Application oApp = new Outlook.Application();
Outlook.MailItem oMsg = (Outlook.MailItem)oApp.CreateItem(Outlook.OlItemType.olMailItem);
Outlook.Inspector oInspector = oMsg.GetInspector; 
```

答案最初是针对 Outlook 2007在[Google 群组中发布的（但它适用于 Outlook 2010）](https://groups.google.com/d/msg/microsoft.public.outlook.program_vba/lLJwbwwl-XU/gRuQYRpJtxEJ)

# java - @WebServlet 中的拦截器未激活

> ID：11330107
> 
> 赞同：3
> 
> 时间：2012-07-04T13:30:26.003
> 
> 标签：java, jakarta-ee, jboss, cdi, jboss-weld

我们有一个带有自定义拦截器注释的@WebServlet，如下所示：

```
@WebServlet("/path")
@CustomInterceptor
public class InitialHtmlServlet extends HttpServlet
{
  @Override
  protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException
  {
  }
} 
```

我们在 /WEB-INF 的 beans.xml 中有 CustomInterceptor，并且拦截器在其他 CDI 组件中工作。然而，在这个 servlet 中，我们不能让它工作。

我们正在运行最新的 JBoss EAP，它应该有点类似于 JBoss 7.1.1。我们应该做些什么不同的事情来让拦截器捕获 servlet 上的调用，或者这根本不可能？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-08T15:04:53.917

经过一番挖掘后，我也发现它有点令人困惑，尽管 servlet 可以称为“bean”，但它不受拦截器机制的影响。

看起来 JEE6 的各个部分可能会或可能不会随意支持拦截器:)。[在这里](http://java.net/projects/servlet-spec/lists/jsr340-experts/archive/2012-02/message/0)找到了一些讨论。

# android - 从抛出状态通知的后台运行应用程序

> ID：11330112
> 
> 赞同：0
> 
> 时间：2012-07-04T13:30:55.440
> 
> 标签：android, air

我正在使用带有本机扩展的 Adob​​e AIR 3.2 为 android 编写关于 action sctipt 的应用程序。我的任务是让通知引发原生扩展，以便可以点击该通知，并且它必须从后台打开应用程序。我已经做了运行通知，但是当我点击它时我无法运行应用程序。我怎么不能这样做？我做错了什么？请帮帮我，谢谢。

```
package com.company.extensions;

import java.util.HashMap;
import java.util.Map;

  import android.app.Notification;
import android.app.NotificationManager;
import android.app.PendingIntent;
import android.content.Context;
import android.content.Intent;
import android.os.Vibrator;
import android.util.Log;

import com.adobe.fre.FREContext;
import com.adobe.fre.FREFunction;

public class ToolsExtensionContext extends FREContext 
{
    public Vibrator vb = null;

    @Override
    public void dispose() 
    {

    }

    @Override
    public Map<String, FREFunction> getFunctions() 
    {
        Map<String, FREFunction> functionMap = new HashMap<String, FREFunction>();

        functionMap.put("notifyUser", new ToolsNotifyFunction());

        return functionMap;
    }

    void notifyUser()
    {
        Log.d("bla-bla-bla", "Just bla");

        // look up the notification manager service
        NotificationManager nm = (NotificationManager)this.getActivity().getSystemService(Context.NOTIFICATION_SERVICE);

        // The details of our fake message
        CharSequence from = "Hello";
        CharSequence message = "Some message!";

        // The PendingIntent to launch our activity if the user selects this
        // notification.  Note the use of FLAG_CANCEL_CURRENT so that, if there
        // is already an active matching pending intent, cancel it and replace
        // it with the new array of Intents.
        Intent k = new Intent(this.getActivity().getApplicationContext(), ToolsExtensionContext.class);

        PendingIntent contentIntent = PendingIntent.getService(this.getActivity().getApplicationContext(), 
                0, k , PendingIntent.FLAG_CANCEL_CURRENT);

        // The ticker text, this uses a formatted string so our message could be localized
        String tickerText = "Tiker text";

        // construct the Notification object.
        Notification notif = new Notification(R.drawable.close, tickerText, System.currentTimeMillis() + 100000);

        // Set the info for the views that show in the notification panel.
        notif.setLatestEventInfo(this.getActivity().getApplicationContext(), from, message, null);//contentIntent);

        // We'll have this notification do the default sound, vibration, and led.
        // Note that if you want any of these behaviors, you should always have
        // a preference for the user to turn them off.
        notif.defaults = Notification.DEFAULT_ALL;
        notif.flags = Notification.FLAG_AUTO_CANCEL;

        // Note that we use R.layout.incoming_message_panel as the ID for
        // the notification.  It could be any integer you want, but we use
        // the convention of using a resource id for a string related to
        // the notification.  It will always be a unique number within your
        // application.
        nm.notify(1, notif);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T16:31:20.457

这是在 Android 上发送本地通知的工作代码，在同一活动中按下通知恢复到应用程序后，在进入后台之前：

```
void sendLocalNotification()
    {

        // look up the notification manager service
        NotificationManager nm = (NotificationManager)this.getActivity().getSystemService(Context.NOTIFICATION_SERVICE);

        // The details of our fake message
        CharSequence from = "Hello";
        CharSequence message = "some message";

        // The PendingIntent to launch our activity if the user selects this
        // notification.  Note the use of FLAG_CANCEL_CURRENT so that, if there
        // is already an active matching pending intent, cancel it and replace
        // it with the new array of Intents.

        Intent k = new Intent(this.getActivity().getApplicationContext(), this.getActivity().getClass());
        Log.d("bla-bla-bla",  this.getActivity().getClass().toString());
        k.setAction(Intent.ACTION_MAIN);
        k.addCategory(Intent.CATEGORY_LAUNCHER);

        PendingIntent contentIntent = PendingIntent.getActivity(this.getActivity().getApplicationContext(), 
                0, k , PendingIntent.FLAG_CANCEL_CURRENT);

        //PendingIntent contentIntent = PendingIntent.getService(this.getActivity().getApplicationContext(), 
        //      0, k , PendingIntent.FLAG_CANCEL_CURRENT);

        // The ticker text, this uses a formatted string so our message could be localized
        String tickerText = "Tiker text";

        // construct the Notification object.
        Notification notif = new Notification(R.drawable.close, tickerText, System.currentTimeMillis() + 100000);

        // Set the info for the views that show in the notification panel.
        notif.setLatestEventInfo(this.getActivity().getApplicationContext(), from, message, contentIntent);

        // We'll have this notification do the default sound, vibration, and led.
        // Note that if you want any of these behaviors, you should always have
        // a preference for the user to turn them off.
        notif.defaults = Notification.DEFAULT_ALL;
        notif.flags = Notification.FLAG_AUTO_CANCEL;

        // Note that we use R.layout.incoming_message_panel as the ID for
        // the notification.  It could be any integer you want, but we use
        // the convention of using a resource id for a string related to
        // the notification.  It will always be a unique number within your
        // application.
        nm.notify(1, notif);
    } 
```

# blackberry - 网络不足错误黑莓模拟器

> ID：11330114
> 
> 赞同：0
> 
> 时间：2012-07-04T13:31:03.820
> 
> 标签：blackberry, java-me, blackberry-simulator, blackberry-maps

我正在尝试为黑莓制作一个应用程序，以便在黑莓地图上做一些思考。当我开始在 smilator 上进行调试时，它会给出一个错误，因为网络覆盖范围不足。

我在它的浏览器上尝试了 google.com，它成功了！但在我的应用程序上，它给出的网络错误不足。

如何解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-04T16:59:42.923

我看到这个问题的两个原因。

1.  也许您的模拟器设置了“低网络覆盖”设置。检查 BB 模拟器选项。
2.  很可能你也忘了启动 MDS Simulator。要提供对 BlackBerry 模拟器的 Internet 访问，请启动 MDS Simulator。

# windows - 运行多个安装并在它们之间使用 System-Reboot

> ID：11330118
> 
> 赞同：0
> 
> 时间：2012-07-04T13:31:39.103
> 
> 标签：windows, batch-file, operating-system, patch

目前，我有一组必须安装在 Windows 机器上的软件安装（及其路径）。我现在要做的是——每次点击运行并输入软件安装路径。

我想要的是设计一个批处理文件，它将在每次成功安装后安装所有应用程序并重新启动我的系统，然后继续列表中的 NEXT 项。是否可以使用 .bat 文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T14:02:45.943

这真的不是批处理设计的，所以这会有点hacky。它无论如何都不优雅，但试一试，它可能对你有用。

```
for /f %%a in (C:\files.txt) do (
start /wait %%a
exit /b
)
for /f "skip=1" %%b in ("C:\files.txt) do (
echo %%b >>C:\newfiles.txt    
)
xcopy C:\newfiles.txt C:\files.txt /y
del C:\newfiles.txt /f /q
shutdown /r /t 0 /f 
```

这个想法是你有一个文本文件，其中包含要安装的可执行文件的路径。它将遍历并执行列表中的第一个文件，等待它完成，然后在没有刚刚安装的文件的情况下重新写入列表。

This is dependend on the setup file having no user interaction and exiting by itself, or maybe it's just to make things easier - in which case just go through each install yourself, and when it finishes the batch file will do the rest.

On the note of rebooting and continuing you will either need to run the batch file again yourself or put it in the registry to start up itself, the latter command being

```
reg add HKCU\Software\Microsoft\Windows\CurrentVersion\Run /v "MyBatchInstaller" /d "C:\MyBatchFile.bat" /f 
```

Hope this helps

# c - 二维数组行/列长度 C

> ID：11330124
> 
> 赞同：6
> 
> 时间：2012-07-04T13:31:49.943
> 
> 标签：c, arrays

我需要声明一个二维数组来表示棋盘的大小。但是，我无法理解如何实际计算板的宽度和长度。我想知道如何计算二维数组的行和列的大小

说，`int boardSize[5][5]`？

```
int main()
{
   int boardSize[5][5];
   int boardWidth=?
   int boardHeight =?
   createBoard(boardWidth, boardHeight);
}

 int createBoard(int width, int height)
 {
   // code that actually creates board //
 } 
```

抱歉，在乞求时没有具体说明。那么，这里我需要计算boardwidth 和boardheight 变量吗？我如何从上面声明的数组中做到这一点。谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-04T13:49:23.747

`boardSize[0]`给你矩阵的第一行，`boardSize[0][0]`它的第一个元素。因此，您要查找的数量是`sizeof boardSize/ sizeof boardSize[0]`和`sizeof boardSize[0]/ sizeof boardSize[0][0]`。

顺便说一句：`size_t`用作大小的类型，而不是`int`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T13:33:43.203

如果你说

```
int boardSize[5][5]; 
```

这为您提供了一个 2D 整数数组，大小为 5 x 5。所以它将有 5 行，每行 5 列，总共 25 个整数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T13:39:36.793

```
printf("Size of the board in bytes %d\n", sizeof(boardSize));
printf("Size of column size in bytes %d\n", 5*sizeof(int));
printf("Size of row in bytes %d\n", 5*sizeof(int)); 
```

如果您想将板保留为静态分配，请将其声明为全局，

```
static int board[5][5]; 
```

然后在您的“createBoard”方法中遍历它（我讨厌匈牙利符号）以进行正确的初始化：

```
for(i = 0; i < hight; i++)
  for(j = 0;j< width; j++)
     board[i][j] = <initialization stuff> 
```

或者您可以在您的 createBoard() 方法中动态分配它。在这种情况下，不要声明为 main 的局部变量。

```
int * createBoard(int hight, int width){
   int * board;
   if(board = malloc(sizeof(int) * hight * width))
       return board;
   return NULL;
} 
```

在 main() 中，您可以执行以下操作：

```
 int * board = createBoard(5,5);
 if(!board)
     printf("Allocation failure \n");
     exit(EXIT_FAILURE); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-04T14:29:14.473

这很容易通过从代码中删除所有神秘的幻数来解决。

```
#define BOARD_WIDTH  8
#define BOARD_HEIGHT 8

square_t board [BOARD_WIDTH][BOARD_HEIGHT];

createBoard (board, BOARD_WIDTH, BOARD_HEIGHT);

void createBoard (square_t* board, int boardWidth, int boardHeight)
{

} 
```

# python - Levenberg-Marquardt-Algorithm 和 ODR 之间的区别

> ID：11330131
> 
> 赞同：2
> 
> 时间：2012-07-04T13:32:05.597
> 
> 标签：python, scipy, curve-fitting

我能够使用[peak-o-mat](http://qceha.net/)将曲线拟合到 ax/y 数据集，如下所示。那是一个线性背景和 10 条洛伦兹曲线。 ![Peak-o-mat 结果](../Images/f430affbc424c4827c0de3ccdf4effe7.png)

因为我需要拟合许多相似的曲线，所以我使用[mpfit.py](http://code.google.com/p/agpy/source/browse/trunk/mpfit/?r=399)编写了一个脚本拟合例程，它是一种 Levenberg-Marquardt-Algorithm。然而，拟合需要更长的时间，而且在我看来，它不如 peak-o-mat 结果准确：

**起始值** ![起始值](../Images/e9b5bcfa55339aafb4abb8f0886cb74a.png)

**使用固定线性背景拟合结果**（取自 peak-o-mat 结果的线性背景值） ![适合固定](../Images/9d0f637485652d10e05f54a27dc514b4.png)

**适合所有变量的结果** ![不合身](../Images/3a225d4d80aba1603238535e156da203.png)

我相信起始值已经非常接近，但即使使用固定的线性背景，左洛伦兹显然是拟合的退化。

对于完全自由贴合，结果更糟。

Peak-o-mat 似乎使用[scipy.odr.odrpack](http://www.scipy.org/doc/api_docs/SciPy.odr.odrpack.html)。现在更有可能的是：

1.  我做了一些实现错误？
2.  odrpack 更适合这个特殊问题？

拟合一个更简单的问题（中间有一个峰值的线性数据）显示 peak-o-mat 和我的脚本之间的相关性非常好。我也没有找到很多关于 ordpack 的信息。

***编辑：***看来我可以自己回答这个问题，但是答案有点令人不安。使用 scipy.odr （允许使用 odr 或 leastsq 方法拟合）都将结果作为 peak-o-mat ，即使没有约束。

下图再次显示了数据、起始值（几乎完美），然后是 odr 和 leastsq 拟合。分量曲线是针对 odr 的

![scipy.odr](../Images/bc024181d4878ed8b9481a6e8abe1053.png)

我将切换到 odr，但这仍然让我感到不安。方法（mpfit.py、scipy.optimize.leastsq、scipy.odr in leastsq 模式）“应该”产生相同的结果。

对于偶然发现这篇文章的人：要进行 odr 拟合，必须为 x 和 y 值指定错误。如果没有错误，请使用 sx << sy 的小值。

```
linear = odr.Model(f)
mydata = odr.RealData(x, y, sx = 1e-99, sy = 0.01)
myodr = odr.ODR(mydata, linear, beta0 = beta0, maxit = 2000)
myoutput1 = myodr.run() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T12:38:17.410

您也可以使用 peak-o-mat 进行脚本编写。最简单的方法是创建包含您希望通过 GUI 拟合的所有数据的项目，对其进行清理、转换并将其附加（即选择一个模型，提供初始猜测并拟合）基本模型到其中一组。然后，您可以（深度）复制该模型并将其附加到所有其他数据集。试试这个：

```
from peak_o_mat.project import Project
from peak_o_mat.fit import Fit
from copy import deepcopy

p = Project()
p.Read('in.lpj')

base = p[2][0]    # this is the set which has been fit already

for data in p[2][1:]: # all remaining sets of plot number 2

    mod = deepcopy(base.mod)
    data.mod = mod

    f = Fit(data, data.mod)
    res = f.run()

    pars = res[0]
    err = res[1]

    data.mod._newpars(pars, err)

    print data.mod.parameters_as_table()

p.Write('out') 
```

请告诉我，如果您需要更多详细信息。

# aspectj - 创建和高级roo插件时如何在java文件而不是aspectJ文件中生成代码？

> ID：11330132
> 
> 赞同：0
> 
> 时间：2012-07-04T13:32:07.277
> 
> 标签：aspectj, spring-roo, add-on

我正在创建一个高级 Roo 插件。除了几乎没有现有文档而且我遇到了多个问题之外，现在让我头疼的问题如下：

我需要从控制器修改方法。该方法已存在于相应生成的 Roo 控制器 .aj 文件中。但是，如果我在我的 .aj 文件中创建一个具有相同名称的新方法，则会出现错误。在 Roo 论坛上，他们说这种代码应该直接注入 .java 文件中。好的，我同意这一点，但有人知道怎么做吗？

亲切的问候，拉杜

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T13:40:45.427

好的，我找到了解决方案。需要先使用ProjectOperations获取要写入的java文件的路径，然后使用MutableFile才能对文件进行操作。

# android - 对字段槽 0,-1 的错误请求。numRows = 1，numColumns = 8

> ID：11330135
> 
> 赞同：0
> 
> 时间：2012-07-04T13:32:08.837
> 
> 标签：android, sqlite

我试图从android中的数据库中检索整个数据......

* * *

**Sqlite 查询：-**

```
Cursor c = db.rawQuery("SELECT * FROM stud",null); 
```

* * *

**但例外：-**

```
07-04 18:47:26.249: E/CursorWindow(8314): Bad request for field slot 0,-1\. numRows = 1, numColumns = 8
07-04 18:47:26.259: D/AndroidRuntime(8314): Shutting down VM
07-04 18:47:26.259: W/dalvikvm(8314): threadid=1: thread exiting with uncaught exception (group=0x40015560)
07-04 18:47:26.329: E/AndroidRuntime(8314): FATAL EXCEPTION: main
07-04 18:47:26.329: E/AndroidRuntime(8314): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.my.StudentInfoManagement/com.my.StudentInfoManagement.ListData}: java.lang.IllegalStateException: get field slot from row 0 col -1 failed
07-04 18:47:26.329: E/AndroidRuntime(8314):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1647)
07-04 18:47:26.329: E/AndroidRuntime(8314):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1663)
07-04 18:47:26.329: E/AndroidRuntime(8314):     at android.app.ActivityThread.access$1500(ActivityThread.java:117)
07-04 18:47:26.329: E/AndroidRuntime(8314):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:931)
07-04 18:47:26.329: E/AndroidRuntime(8314):     at android.os.Handler.dispatchMessage(Handler.java:99)
07-04 18:47:26.329: E/AndroidRuntime(8314):     at android.os.Looper.loop(Looper.java:123)
07-04 18:47:26.329: E/AndroidRuntime(8314):     at android.app.ActivityThread.main(ActivityThread.java:3683)
07-04 18:47:26.329: E/AndroidRuntime(8314):     at java.lang.reflect.Method.invokeNative(Native Method)
07-04 18:47:26.329: E/AndroidRuntime(8314):     at java.lang.reflect.Method.invoke(Method.java:507)
07-04 18:47:26.329: E/AndroidRuntime(8314):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
07-04 18:47:26.329: E/AndroidRuntime(8314):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
07-04 18:47:26.329: E/AndroidRuntime(8314):     at dalvik.system.NativeStart.main(Native Method)
07-04 18:47:26.329: E/AndroidRuntime(8314): Caused by: java.lang.IllegalStateException: get field slot from row 0 col -1 failed
07-04 18:47:26.329: E/AndroidRuntime(8314):     at android.database.CursorWindow.getString_native(Native Method)
07-04 18:47:26.329: E/AndroidRuntime(8314):     at android.database.CursorWindow.getString(CursorWindow.java:329)
07-04 18:47:26.329: E/AndroidRuntime(8314):     at android.database.AbstractWindowedCursor.getString(AbstractWindowedCursor.java:49)
07-04 18:47:26.329: E/AndroidRuntime(8314):     at com.my.StudentInfoManagement.DataHelper.selectAll(DataHelper.java:52)
07-04 18:47:26.329: E/AndroidRuntime(8314):     at com.my.StudentInfoManagement.ListData.onCreate(ListData.java:18)
07-04 18:47:26.329: E/AndroidRuntime(8314):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
07-04 18:47:26.329: E/AndroidRuntime(8314):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1611)
07-04 18:47:26.329: E/AndroidRuntime(8314):     ... 11 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-03T05:48:58.587

哈哈，工作两天后，在这种情况下，今天我的学长（Vijar Sir）建议我将`id`（primary_Key）名称转换为：`_id`&其运行成功，

现在如果你说为什么在实现 phone_contact: 之后[，](http://www.vogella.com/code/ApiDemos/src/com/example/android/apis/view/ExpandableList2.html)将鼠标悬停在**Contacts._ID**上方，你会发现`_id`与之相关的字符串。

```
private static final String[] CONTACTS_PROJECTION = new String[] 
{
     Contacts._ID,
     Contacts.DISPLAY_
}; 
```

# r - 查找所有缺失值的列

> ID：11330138
> 
> 赞同：32
> 
> 时间：2012-07-04T13:32:12.393
> 
> 标签：r, dataframe, na

我正在编写一个函数，它需要检查是否（以及哪个！）列（变量）具有所有缺失值（`NA`, `<NA>`）。以下是函数的片段：

```
test1 <- data.frame (matrix(c(1,2,3,NA,2,3,NA,NA,2), 3,3))
test2 <- data.frame (matrix(c(1,2,3,NA,NA,NA,NA,NA,2), 3,3))

na.test <-  function (data) {
  if (colSums(!is.na(data) == 0)){
      stop ("The some variable in the dataset has all missing value,
     remove the column to proceed")
      }
      }
na.test (test1)

Warning message:
In if (colSums(!is.na(data) == 0)) { :
  the condition has length > 1 and only the first element will be used 
```

**Q1：**为什么会出现上述错误和任何修复？

**Q2：**有什么方法可以找到哪些列有 all `NA`，例如输出列表（变量名或列号）？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-07-04T13:40:24.343

这很容易使用`sapply`一个小的匿名函数：

```
sapply(test1, function(x)all(is.na(x)))
   X1    X2    X3 
FALSE FALSE FALSE 

sapply(test2, function(x)all(is.na(x)))
   X1    X2    X3 
FALSE  TRUE FALSE 
```

* * *

在函数内部：

```
na.test <-  function (x) {
  w <- sapply(x, function(x)all(is.na(x)))
  if (any(w)) {
    stop(paste("All NA in columns", paste(which(w), collapse=", ")))
  }
}

na.test(test1)

na.test(test2)
Error in na.test(test2) : All NA in columns 2 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-03-26T00:37:49.497

在 dplyr

```
ColNums_NotAllMissing <- function(df){ # helper function
  as.vector(which(colSums(is.na(df)) != nrow(df)))
}

df %>%
select(ColNums_NotAllMissing(.))

example:
x <- data.frame(x = c(NA, NA, NA), y = c(1, 2, NA), z = c(5, 6, 7))

x %>%
select(ColNums_NotAllMissing(.)) 
```

或者，反过来

```
Cols_AllMissing <- function(df){ # helper function
  as.vector(which(colSums(is.na(df)) == nrow(df)))
}

x %>%
  select(-Cols_AllMissing(.)) 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-02-25T08:17:32.043

查找缺少所有值的列

```
 allmisscols <- apply(dataset,2, function(x)all(is.na(x)));  
 colswithallmiss <-names(allmisscols[allmisscols>0]);    
 print("the columns with all values missing");    
 print(colswithallmiss); 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2019-09-09T14:29:44.783

这将生成充满 NA 的列名：

```
library(purrr)
df %>% keep(~all(is.na(.x))) %>% names 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-06-07T01:52:27.783

要测试列是否具有所有缺失值：

```
apply(test1,2,function(x) {all(is.na(x))}) 
```

要获取哪些列具有所有缺失值：

```
 test1.nona <- test1[ , colSums(is.na(test1)) == 0] 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2019-06-13T07:59:53.023

dplyr 方法来查找每列的 NA 数量：

```
df %>% 
  summarise_all((funs(sum(is.na(.))))) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-12-17T12:43:06.590

以下命令为您提供了一个漂亮的表，其中包含具有 NA 值的列：

```
sapply(dataframe, function(x)all(any(is.na(x)))) 
```

这是对您得到的第一个答案的改进，在某些情况下它不能正常工作。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-06-28T07:01:29.617

```
sapply(b,function(X) sum(is.na(X)) 
```

这将为您提供数据集每一列中的 na 计数，如果列中不存在 na ，也会给出 0

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-02-20T15:10:07.723

变体 dplyr 方法：

```
dataframe %>% select_if(function(x) all(is.na(x))) %>% colnames() 
```

# sql - Active Record 优化：.includes() 生成非常慢的 DISTINCT 查询，我该如何避免呢？

> ID：11330141
> 
> 赞同：0
> 
> 时间：2012-07-04T13:32:18.260
> 
> 标签：sql, ruby-on-rails, activerecord, query-optimization

我有两个关系如下：

```
class CfThread < ActiveRecord::Base
  self.primary_key = 'thread_id'
  self.table_name  = 'cforum.threads'

  belongs_to :forum, class_name: 'CfForum', :foreign_key => :forum_id
  has_many :messages, class_name: 'CfMessage', :foreign_key => :thread_id

  attr_accessible :thread_id, :tid, :slug, :forum_id, :archived, :created_at, :updated_at
end

class CfMessage < ActiveRecord::Base
  has_one :owner, class_name: 'CfUser', :foreign_key => :user_id
  has_many :flags, class_name: 'CfFlag'

  belongs_to :thread, class_name: 'CfThread', :foreign_key => :thread_id

  attr_accessible :message_id, :mid, :thread_id, :subject, :content,
    :author, :email, :homepage, :deleted, :user_id, :parent_id,
    :updated_at, :created_at
end 
```

我想查询最后 10 个线程及其消息而不产生 n+1 查询情况：

```
@threads = CfThread.includes(:messages).order('cforum.threads.created_at DESC').limit(10) 
```

这会使用 DISTINCT 产生一个非常慢的查询：

```
SELECT DISTINCT "cforum"."threads".thread_id, cforum.threads.created_at AS alias_0 FROM "cforum"."threads" LEFT OUTER JOIN "cforum"."messages" ON "cforum"."messages"."thread_id" = "cforum"."threads"."thread_id" ORDER BY cforum.threads.created_at DESC LIMIT 10 
```

查询规划器想要对线程和消息进行全表扫描。

使用纯 SQL 很容易优化这种情况，但也有使用 AR 的方法吗？我可以避免 DISTINCT 而不产生 n+1 查询吗？

问候，CK

编辑：索引如下：

主题：

```
"threads_pkey" PRIMARY KEY, btree (thread_id)
"index_cforum.threads_on_slug" UNIQUE, btree (slug)
"index_cforum.threads_on_archived" btree (archived)
"index_cforum.threads_on_tid" btree (tid)
"threads_created_at_idx" btree (created_at, updated_at) 
```

留言：

```
"messages_pkey" PRIMARY KEY, btree (message_id)
"index_cforum.messages_on_mid" btree (mid)
"index_cforum.messages_on_thread_id" btree (thread_id) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T13:39:54.947

我认为您的订单稍微混淆了活动记录 - 我认为活动记录认为它需要连接列才能使订单正常工作。所以它使用基于连接的包含变体，当你想限制它时，它又需要一个不同的查询。

显然，顺序仅取决于 CfThread 模型，只是 AR 启发式算法被混淆了。一种方法是通过 do 强制使用急切加载模式

```
CfThread.preload(:messages).order('cforum.threads.created_at DESC').limit(10) 
```

# ios - 如何在 iOS 中实现后台 RSS 阅读器？

> ID：11330145
> 
> 赞同：0
> 
> 时间：2012-07-04T13:32:39.640
> 
> 标签：ios, xml, background, rss

我需要在 iOS 上实现一个 RSS 阅读器，它每 # 分钟更新一次它的提要，即使应用程序在后台。我不介意使用 NSXMLParser 来解析数据，我只需要一种在后台按预定时间间隔执行以下操作的好方法：

*   下载提要的 XML 文档
*   解析文档
*   让用户知道任何更新

我知道在应用程序运行时如何做所有这些事情，我只需要知道如何确保它们完成，即使应用程序在后台运行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-04T13:41:22.410

Apple 对允许在后台执行哪些应用程序有严格的规定。不幸的是，您的应用程序不属于这些类别中的任何一个。

*   **音频**——应用程序在后台向用户播放可听内容。（此内容包括使用 AirPlay 的流式音频或视频内容。）
*   **位置**- 该应用程序让用户随时了解他们的位置，即使它在后台运行时也是如此。
*   **voip** — 该应用程序使用户能够使用 Internet 连接拨打电话。
*   **newsstand-content** — 该应用程序是一个 Newsstand 应用程序，可在后台下载和处理杂志或报纸内容。
*   **external-accessory** — 该应用程序与需要通过外部附件框架定期提供更新的硬件附件一起使用。
*   **蓝牙中心**

来自 Apple 文档：[[来源]](http://developer.apple.com/library/ios/DOCUMENTATION/iPhone/Conceptual/iPhoneOSProgrammingGuide/ManagingYourApplicationsFlow/ManagingYourApplicationsFlow.html#//apple_ref/doc/uid/TP40007072-CH4-SW24)

# java - 选择列表值作为 null 传递

> ID：11330146
> 
> 赞同：0
> 
> 时间：2012-07-04T13:32:46.593
> 
> 标签：java, html, jsp, servlets

我创建了一个带有 html 表单的 jsp，当提交到一个 servlet 时。

在我的表单中，我有一个多选列表，其中填充了值。

在我的 servlet 中，我想对这些值进行一些修改。

当我尝试访问 servlet 中的参数值时，它们都显示为 null。

来自 servlet 的片段：

```
String[] withAccess = req.getParameterValues("withAccess");

        for(int i = 0; i < withAccess.length; i++ )
            System.out.println(withAccess[i]); 
```

此代码打印“null”N 次，其中 N 是数组大小。

那么问题是什么？

我想不通。

在我点击提交之前选择了所有元素。

我的 html 文件，表单所在的位置：

```
<html>
<script type="text/javascript" language="javascript" src="scripts.js"></script>

 <jsp:useBean id="bean2" class="models.JDBCModelAccess" scope="page"/>
 <head>
 <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
 <title>Insert title here</title>
 </head>
 <body>

 <form action="ModelConfiguration.do" method="post">

<label for="models">Models:</label>
<select name="models" id="models" onChange="makeRequest()">
<c:forEach var="model" items="${bean2.models}">
        <option>${model}</option>
    </c:forEach>
</select>

<label for="withoutAccess">Users without access to the model:</label>
<select name="withoutAccess" id="withoutAccess"size="5" multiple="multiple">      </select>

<label for="withAccess">Users with access to the model</label>
<select name="withAccess" id="withAccess" size="5" multiple="multiple"></select>

<input type="submit" value="Submit" onClick="selectAll(withoutAccess,withAccess,true)">

</form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T13:37:02.423

您的标签内没有`<option>`s 。`<select "withAccess" ...>`

你得到 5 个“项目”，因为你有`size="5"`，但它们都是空的。

尝试这个：

```
<select name="withAccess" id="withAccess" size="5" multiple="multiple">
    <option>User 1</option>
    <option>User 2</option>
    <option>User 3</option>
    <option>User 4</option>
    <option>User 5</option>
</select> 
```

# c# - 如何禁用在 DataGridView 中选择的能力？

> ID：11330147
> 
> 赞同：68
> 
> 时间：2012-07-04T13:32:50.560
> 
> 标签：c#, .net, winforms, datagridview

我想用我的`DataGridView`only 来展示东西，我希望用户不能从`DataGridView`.

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：138
> 
> 时间：2012-12-19T15:29:00.893

我会这样做：

```
private void myDataGridView_SelectionChanged(Object sender, EventArgs e)
{
    dgvSomeDataGridView.ClearSelection();  
} 
```

我不同意 no`DataGridView`应该是不可选择的广泛断言。一些 UI 是为工具或触摸屏构建的，允许选择会误导用户认为选择实际上会将它们带到某个地方。

控件上的设置`ReadOnly = true`对是否可以选择单元格或行没有影响。设置也有视觉和功能上的缺点`Enabled = false`。

另一种选择是将控件选择的颜色设置为与未选择的颜色完全相同，但如果您碰巧正在操作单元格的背景颜色，那么这种方法也会产生一些令人讨厌的结果。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2014-10-02T07:19:02.053

您可以为选定的单元格设置透明背景颜色，如下所示：

```
DataGridView.RowsDefaultCellStyle.SelectionBackColor = System.Drawing.Color.Transparent; 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2017-05-16T01:19:41.817

`Enabled`财产`false`

或者

```
this.dataGridView1.DefaultCellStyle.SelectionBackColor = this.dataGridView1.DefaultCellStyle.BackColor;
this.dataGridView1.DefaultCellStyle.SelectionForeColor = this.dataGridView1.DefaultCellStyle.ForeColor; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-12-19T08:48:02.647

我通过将`Enabled`属性设置为`false`.

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2021-01-15T23:39:19.250

如果您不需要使用所选单元格中的信息，则清除选择有效，但如果您仍需要使用所选单元格中的信息，您可以这样做以使其看起来没有选择，并且背景颜色仍然是可见的。

```
private void dataGridView_SelectionChanged(object sender, EventArgs e)
    {
        foreach (DataGridViewRow row in dataGridView.SelectedRows)
        {
            dataGridView.RowsDefaultCellStyle.SelectionBackColor = row.DefaultCellStyle.BackColor;
        }
    } 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-04-12T23:55:18.513

这对我来说就像一个魅力：

```
row.DataGridView.Enabled = false;

row.DefaultCellStyle.BackColor = Color.LightGray;

row.DefaultCellStyle.ForeColor = Color.DarkGray; 
```

（其中 row = DataGridView.NewRow（适当的重载）；）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-05-29T16:12:58.873

我发现将所有`AllowUser...`属性设置为`false`、`ReadOnly`to `true`、`RowHeadersVisible`to `false`、`ScollBars`to `None`，然后[伪造防止选择](https://stackoverflow.com/questions/1745272/disable-cell-highlighting-in-a-datagridview#1745295)对我来说效果最好。未设置`Enabled`为`false`仍允许用户从网格中复制数据。

当您想要一个简单的显示网格（假设行的高度相同）时，以下代码也会清理外观：

```
int width = 0;
for (int i = 0; i < dataGridView1.Columns.Count; i++)
{
    width += dataGridView1.Columns[i].Width;
}

dataGridView1.Width = width;
dataGridView1.Height = dataGridView1.Rows[0].Height*(dataGridView1.Rows.Count+1); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-09-23T13:24:19.693

它在 VB 中，但不应该难以转换为 C#：如果要锁定 datagridview，请使用`dg.ReadOnly == True;`

如果您想阻止用户选择另一行，只需记住旧选择并根据条件集或不设置应选择的行。假设关闭了多选：

```
 Private Sub dg_SelectionChanged(sender As Object, e As EventArgs) Handles dg.SelectionChanged
    Static OldSelection As Integer
      If dg.Rows.Count > 0 Then
          If dg.SelectedRows(0).Index <> OldSelection And YOURCONDITION Then
            dg.Rows(OldSelection).Selected = True
          End If

        OldSelection = dg.SelectedRows(0).Index
      End If
    End Sub 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-09-16T19:16:38.067

你必须创建一个自定义 DataGridView

`

```
namespace System.Windows.Forms
{
    class MyDataGridView : DataGridView
    {
        public bool PreventUserClick = false;

        public MyDataGridView()
        {

        }
        protected override void OnMouseDown(MouseEventArgs e)
        {
            if (PreventUserClick) return;

            base.OnMouseDown(e);
        }
    }
} 
```

` 请注意，您必须先用添加的类编译一次程序，然后才能使用新控件。

然后转到 .Designer.cs 并将旧的 DataGridView 更改为新的，而不必弄乱您以前的代码。

```
private System.Windows.Forms.DataGridView dgv; // found close to the bottom 
```

…</p>

```
private void InitializeComponent() {
    ...
    this.dgv = new System.Windows.Forms.DataGridView();
    ...
} 
```

到（各自）

```
private System.Windows.Forms.MyDataGridView dgv;

this.dgv = new System.Windows.Forms.MyDataGridView(); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-07-16T16:24:49.983

我在理论上最喜欢 user4101525 的答案，但实际上并没有用。选择不是覆盖，因此您可以看到控制范围内的任何内容

Ramgy Borja 的回答没有处理默认样式实际上根本不是颜色的事实，因此应用它无济于事。如果应用您自己的颜色（这可能是 edhubbell 所说的令人讨厌的结果），这将处理默认样式并工作

```
dgv.RowsDefaultCellStyle.SelectionBackColor = dgv.RowsDefaultCellStyle.BackColor.IsEmpty ? System.Drawing.Color.White : dgv.RowsDefaultCellStyle.BackColor;
dgv.RowsDefaultCellStyle.SelectionForeColor = dgv.RowsDefaultCellStyle.ForeColor.IsEmpty ? System.Drawing.Color.Black : dgv.RowsDefaultCellStyle.ForeColor; 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2022-01-24T17:30:31.727

在从 DataGridView 继承的类中禁用默认选择对我来说一直有效：

```
// REQUIRES: SelectionMode = DataGridViewSelectionMode.FullRowSelect
protected override void SetSelectedRowCore(int rowIndex, bool selected)
{       
    base.SetSelectedRowCore(rowIndex, selected && ALLOW_DEFAULT_SELECTION);
}
bool ALLOW_DEFAULT_SELECTION = false; 
```

通常目标是完全禁用它（以实现我们自己的自定义选择和绘制过程）。当目标是仅在特定时间允许默认选择时，可以像这样包装布尔值：

```
public void SelectRowExplicitly(int index, bool selected = true)
{
    try
    {
        ALLOW_DEFAULT_SELECTION = true;
        Rows[index].Selected = selected;
    }
    finally
    {
        ALLOW_DEFAULT_SELECTION = false;
    }
} 
```

* * *

## 回答 #12

> 赞同：-3
> 
> 时间：2012-07-04T15:36:18.470

使用[`DataGridView.ReadOnly`物业](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.readonly.aspx)

[MSDN 示例](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.readonly.aspx)中的代码说明了此属性在**主要用于显示**`DataGridView`的控件中的使用。在此示例中，控件的视觉外观以多种方式自定义，并且**控件被配置为有限的交互性**。

 ****观察示例代码中的这些设置：

```
// Set property values appropriate for read-only
// display and limited interactivity
dataGridView1.AllowUserToAddRows = false;
dataGridView1.AllowUserToDeleteRows = false;
dataGridView1.AllowUserToOrderColumns = true;
dataGridView1.ReadOnly = true;
dataGridView1.SelectionMode = DataGridViewSelectionMode.FullRowSelect;
dataGridView1.MultiSelect = false;
dataGridView1.AutoSizeRowsMode = DataGridViewAutoSizeRowsMode.None;
dataGridView1.AllowUserToResizeColumns = false;
dataGridView1.ColumnHeadersHeightSizeMode = 
DataGridViewColumnHeadersHeightSizeMode.DisableResizing;
dataGridView1.AllowUserToResizeRows = false;
dataGridView1.RowHeadersWidthSizeMode = 
DataGridViewRowHeadersWidthSizeMode.DisableResizing; 
```****

# google-maps - 斯洛伐克交通数据未通过 js api 显示在地图上

> ID：11330148
> 
> 赞同：-1
> 
> 时间：2012-07-04T13:32:54.297
> 
> 标签：google-maps, google-maps-api-3, traffic

有谁知道为什么 google 不使用 javascript api 在 web 地图上提供斯洛伐克的交通信息？它曾经工作得很好。现在周围的其他一些国家正在显示交通，但斯洛伐克没有。maps.google.sk 上的地图也显示斯洛伐克的交通数据。那么斯洛伐克的js api流量有什么问题呢？谷歌是否有任何法律问题，所以他们不得不把它拉下来？或者怎么了？

显然，捷克和波兰的情况类似。

由于非技术问题，主题已关闭，因此我不得不重新编辑。谢谢大家的评论，虽然它们都是指向和相关的，但我想再次指出，流量过去已经显示在 js api v 3 上，它仍然显示在 maps.google.sk 上。所以谷歌肯定有数据。现在是技术问题，如何使用 maps javascript api 为斯洛伐克显示？

谢谢。

- - - 编辑 - - -

截至几天前25.Feb.2014，交通信息再次开始在斯洛伐克显示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T14:55:48.597

我不知道有关状态的根本原因的详细信息，但这里是**斯洛伐克**的 Google Maps API 覆盖状态列表（不幸的是，不包括流量）：

*   地图瓷砖：是的
*   地理编码：是的
*   街景：没有
*   **交通：没有**
*   行车路线：是（主要城市）
*   企业名录：否
*   域：没有
*   骑行路线：没有

对于**捷克共和国**：

*   地图瓷砖：是的
*   地理编码：是的
*   街景：是的
*   **交通：没有**
*   行车路线：是的
*   企业名录：是的
*   域名：是（cz）
*   骑行路线：没有

对于**波兰**：

*   地图瓷砖：是的
*   地理编码：是的
*   街景：没有
*   **交通：没有**
*   行车路线：是的
*   企业名录：是的
*   域：是（pl）
*   骑行路线：没有

谷[歌地图覆盖列表](http://gmaps-samples.googlecode.com/svn/trunk/mapcoverage_filtered.html)显示了世界各国这些元素的状态。

# installation - 如果我以标准用户身份登录，则禁用单选按钮

> ID：11330149
> 
> 赞同：2
> 
> 时间：2012-07-04T13:32:56.060
> 
> 标签：installation, wix, windows-installer, wix3.5

我有一个单选按钮组，其中有 3 个单选按钮。我想禁用一个单选按钮，但是我希望这件事按如下方式完成：

> 当我以管理员身份登录时，不能禁用单选按钮，如果我以标准用户身份登录，则 UI 不应显示单选按钮。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-05T05:41:23.430

您可以在[Condition](http://wix.sourceforge.net/manual-wix2/wix_xsd_condition.htm)元素中使用[Privileged](http://msdn.microsoft.com/en-us/library/aa370852%28v=vs.85%29)属性。

# iphone - Temporarily Remove un-Editable Cells UITableView

> ID：11330153
> 
> 赞同：0
> 
> 时间：2012-07-04T13:33:06.653
> 
> 标签：iphone, objective-c, xcode, uitableview

I have this code implemented in my tableView:

```
- (BOOL)tableView:(UITableView *)tableView canEditRowAtIndexPath:(NSIndexPath *)indexPath {
    if (indexPath.section == 0) {
        return NO;
    }
    return YES;
} 
```

It does what I want, but I want to go one step better and make "section 0" disappear altogether when the edit button is pressed (this effect can be seen if you go into the "keyboard" menu on iOS and select edit in the top right corner, the top two sections disappear in an animation). I have attempted to temporarily remove the first section, but my app crashes when `[tableView reloadData];` is called:

```
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView {
    if (tvController.editing == YES) {
        return 1;
    }else if (tvController.editing == NO) {
        return 2;
    }
    return 0;
} 
```

Also, I do not think I will end up with an animation if I get that code working, I think my approach is wrong. Thanks for your help guys!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T15:26:20.030

**Your problem**

One of your sections is longer than the preceding one.

Since you hide section 0 by reporting 1 less section in `numberOfSectionsInTableView:`, in editing mode every delegate method must adjust the section number. One of them is not doing so.

```
// every delegate method with a section or indexPath must adjust it when editing

- (NSInteger) tableView:(UITableView*)tableView numberOfRowsInSection:(NSInteger)section
{
    if (tvController.editing) section++;
    return [[customers objectAtIndex:section] count];
}

- (UITableViewCell*) tableView:(UITableView*) tableView cellForRowAtIndexPath:(NSIndexPath*) indexPath
{
    int section = indexPath.section;
    if (tvController.editing) section++;

    id customer = [[customers objectAtIndex:section] indexPath.row];

    // etc
} 
```

**My approach**

UITableView [reloadSections:withRowAnimation:](http://developer.apple.com/library/ios/documentation/uikit/reference/UITableView_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40006943-CH3-SW36) reloads specified sections with an animation. Call it from your `setEding:animated:` delegate method.

```
- (void) setEditing:(BOOL)editing animated:(BOOL)animated
{
    [super setEditing:editing animated:animated];

    UITableViewRowAnimation animation = animated ? UITableViewRowAnimationFade : UITableViewRowAnimationNone;
    [self.tableView reloadSections:[NSIndexSet indexSetWithIndex:0] withRowAnimation:animation];

    [self.tableView reloadSectionIndexTitles];

    self.navigationItem.hidesBackButton = editing;
} 
```

Your delegate also needs indicate that the hidden section has no rows or title.

```
- (NSInteger) tableView:(UITableView*)tableView numberOfRowsInSection:(NSInteger)section
{
    if (self.editing && section == 0) {
        return 0;
    }

    return [[customers objectAtIndex:section] count];
}

- (NSString*) tableView:(UITableView*) tableView titleForHeaderInSection:(NSInteger) section
{
    if (self.editing && section == 0) {
        return nil;
    }

    [[customers objectAtIndex:section] title];
} 
```

# spring - Spring 3.1 和 Oracle Audit Trail：向触发器提供应用程序数据

> ID：11330154
> 
> 赞同：1
> 
> 时间：2012-07-04T13:33:13.720
> 
> 标签：spring, oracle11g, spring-jdbc

**问题参数**：

1.  春天 3.1
2.  甲骨文 11.2.0.3
3.  Glassfish 2.1 应用服务器，提供 JDBC 连接池。

**问题描述**：

我正在改进一组现有管理应用程序中的用户审计，以添加、编辑和删除客户用户。我需要将管理用户的 ID 存储在由与多个表关联的 Oracle 触发器创建的审计记录中。我想通过在数据库操作之前从连接池中检索到的每个连接上设置 Oracle CLIENT_IDENTIFIER 属性来使触发器可以访问管理用户 ID，然后在数据库操作之后清除该属性。我有一些有用的东西，但我真的不喜欢它的完成方式。

**问题：**

有没有办法访问连接，以便可以在数据库操作之前和之后设置 Oracle 上下文属性？也许某种听众响应事件？

我看过：

1.  一百万个网页（好吧，也许这有点夸张，但我已经用谷歌搜索了三四个小时）。
2.  使用 DataSourceUtils 获取连接。这可行，但我真的不想管理连接，我只想在进出池的途中拦截它们以设置 CLIENT_IDENTIFIER 属性值。
3.  覆盖数据源的 getConnection 方法。由于这在 JdbcTemplate 内的某处被调用，因此我无法将应用程序数据获取到该方法。

我希望 Spring 和/或 Oracle 大师会说“嗯，这很明显，答案是……”，而不必破解我的实现，但无论如何都是这样。如果没有别的，如果有人正在寻找一个想法，这确实有效。

**我的实现：**

所有数据库操作都是使用 JdbcOperations 对注入到 Dao 中的 JdbcTemplate 对象的引用来完成的。添加、编辑和删除操作使用 JdbcOperations 查询方法，传递 PreparedStatementCreator 或 BatchPreparedStatementSetter。我在这些对象的回调方法（createPreparedStatement 或 setValues）中访问应用程序服务器连接池提供的 java.sql.Connection 对象，以设置 CLIENT_IDENTIFIER 属性。

applicationContext.xml 数据源配置：

```
<!-- Setup the datasource -->
<bean id="dataSource" class="org.springframework.jndi.JndiObjectFactoryBean">
    <property name="jndiName" value="jdbc/IpOneDatabasePool"/>
</bean>

<!-- Setup the transaction manager -->
<bean id="txManager" class="org.springframework.transaction.jta.JtaTransactionManager" />
<tx:advice id="txAdvice" transaction-manager="txManager">
    <tx:attributes>
        <tx:method name="get*" read-only="true"/>
        <tx:method name="*"/>
    </tx:attributes>
</tx:advice>

<!-- Associate the transaction manager with objects that must be managed. -->
<aop:config>
    <aop:pointcut id="userDaoOperation" expression="execution(* com.myCompany.IpOne.dao.UserDaoImpl.*(..))"/>
    <aop:advisor advice-ref="txAdvice" pointcut-ref="userDaoOperation"/>
</aop:config>

<!-- Bean providing access to the various prepared statement objects -->
<bean id="daoHelperFactory" class="com.myCompany.IpOne.dao.DaoHelperFactoryImpl" />

<!--  Bean that allows setting of the client identifier for the audit trail -->  
<bean id="databaseContextEditor" class="com.myCompany.IpOne.dao.OracleDatabaseContextEditor" />

<!-- Dao that manages persistence of User objects -->
<bean id="userDao" class="com.myCompany.IpOne.dao.UserDaoImpl" >
    <property name="dataSource" ref="dataSource"/>
    <property name="licenseDao" ref="licenseDao"/>
    <property name="appPropertyManager" ref="appPropertyManager"/>
    <property name="maximumLicensesPerUserKey" value="max_licences_per_user"/>
    <property name="daoHelperFactory" ref="daoHelperFactory"/>
</bean> 
```

这是用户道界面

```
public interface UserDao {

    void addUser(User newUser,String adminUserId);

} 
```

这是用户道类

```
public class UserDaoImpl implements UserDao{

    private JdbcOperations jdbcOperations;

    public void setDataSource(DataSource dataSource) {
        this.jdbcOperations = new JdbcTemplate(dataSource);
    }

    public void addUser(User newUser,String adminUserId) {

        PreparedStatementCreator insertUserStatement = 
            this.daoHelperFactory.getInsertUserStatement(newUser,adminUserId);

        KeyHolder keyHolder = this.daoHelperFactory.getKeyHolder();
        this.jdbcOperations.update(insertUserStatement, keyHolder);
        newUser.setUserId(keyHolder.getKey().intValue());

    }

} 
```

此类提供对应用程序上下文的访问。

```
public class ApplicationContextProvider implements ApplicationContextAware{

    private static ApplicationContext ctx = null;

    public static ApplicationContext getApplicationContext() {
       return ctx;
    }

    public void setApplicationContext(ApplicationContext ctx) throws BeansException {

        this.ctx = ctx;

    }

} 
```

提供 Dao 使用的各种对象的类的接口。

```
public interface DaoHelperFactory {

    PreparedStatementCreator getInsertUserStatement(User user,String adminUserId);   
    KeyHolder getKeyHolder();

} 
```

此类只是 PreparedStatementCreator 和 BatchPreparedStatementSetter 对象以及 Dao 使用的其他对象的工厂。我已对其进行了更改，以提供将数据库上下文属性实际设置为返回的各种对象的对象。

```
public class DaoHelperFactoryImpl implements DaoHelperFactory{

    private DatabaseContextEditor getDatabaseContextEditor(){

        ApplicationContext appContext = ApplicationContextProvider.getApplicationContext();
        DatabaseContextEditor databaseContextEditor = (DatabaseContextEditor) appContext.getBean("databaseContextEditor");

        return databaseContextEditor;

     }

    public KeyHolder getKeyHolder(){

        return new GeneratedKeyHolder();

    }

    public PreparedStatementCreator getInsertUserStatement(User user,String adminUserId){

        InsertUser insertUser = new InsertUser(user,adminUserId);
        insertUser.setDatabaseContextEditor(getDatabaseContextEditor());

        return insertUser;

    }

} 
```

这是设置数据库上下文的类的接口

```
public interface DatabaseContextEditor {

    public DatabaseContextEditor getInstance();
    public  void setClientIdentifier(Connection connection,String clientIdentifier)        throws SQLException;

} 
```

这是为 Oracle 执行此操作的类

```
public class OracleDatabaseContextEditor implements DatabaseContextEditor{

    public void setClientIdentifier(Connection connection,String clientIdentifier) throws SQLException{

        OracleJdbc4NativeJdbcExtractor extractor = new OracleJdbc4NativeJdbcExtractor();

        oracle.jdbc.OracleConnection oracleConnection = null;

        if(!(connection instanceof oracle.jdbc.OracleConnection))
            oracleConnection = (oracle.jdbc.OracleConnection) extractor.getNativeConnection(connection);
        else
            oracleConnection = (oracle.jdbc.OracleConnection)connection;

        String[] metrics = new String[OracleConnection.END_TO_END_STATE_INDEX_MAX];
        metrics[OracleConnection.END_TO_END_CLIENTID_INDEX]=clientIdentifier;
        oracleConnection.setEndToEndMetrics(metrics,(short)0);

}

    public DatabaseContextEditor getInstance(){

        return new OracleDatabaseContextEditor();

    }
} 
```

该类是用于添加用户的 PreparedStatementCreator

```
public class InsertUser implements PreparedStatementCreator {

     User insertUser;

    /** This is the admin user Id I need to store */
    String adminUserId;

    private final String SQL = "INSERT INTO SC_USR (" +
    "USR_ID, USR_SSO_NAME, USR_PH_NO, USR_SIP_NAME," +
    "USR_SIP_PSWD, USR_SIP_DISP_NAME, USR_SIP_DOMAIN, USR_SIP_PROXY," +
    " USR_CREATED_BY, USR_CREATED_DATETIME) " +
    "VALUES (SEQ_SC_USR_ID.NEXTVAL, ?, ?, ?, ?, ?, ?, ?, ?, SYSTIMESTAMP)";

    private final String GENERATED_COLUMNS[] = {"USR_ID"};

    /** Object that provides functionality for setting values in the database context */
    private DatabaseContextEditor databaseContextEditor;

    public InsertUser(User user,String adminUserId){

        this.insertUser = user;
        this.adminUserId = adminUserId;

    }

    public PreparedStatement createPreparedStatement(Connection connection) throws SQLException {

        this.databaseContextEditor.setClientIdentifier(connection, adminUserId);

        PreparedStatement preparedStatement =      connection.prepareStatement(SQL,GENERATED_COLUMNS);
        int i=1;
        preparedStatement.setString(i++,this.insertUser.getSsoName());
        preparedStatement.setString(i++,this.insertUser.getPhoneNumber());
        preparedStatement.setString(i++,this.insertUser.getSipName());
        preparedStatement.setString(i++,this.insertUser.getSipPassword());
        preparedStatement.setString(i++,this.insertUser.getSipDisplayName());
        preparedStatement.setString(i++,this.insertUser.getSipDomain());
        preparedStatement.setString(i++,this.insertUser.getSipProxy());
        preparedStatement.setString(i++,this.insertUser.getCreatedBy().name());

        return preparedStatement;

    }

    public void setDatabaseContextEditor(DatabaseContextEditor databaseContextEditor) {
        this.databaseContextEditor = databaseContextEditor;
    }
} 
```

我要审核的每个表上都有“AFTER DELETE OR INSERT OR UPDATE”触发器。每个表都有一个对应的审计表。他们从上下文中提取 CLIENT_IDENTIFIER 并在适当的审计表中插入一行。这是一个样本。

```
CREATE OR REPLACE TRIGGER IPONE_DEV_USER.SC_USR$AUDTRG
AFTER DELETE OR INSERT OR UPDATE
ON IPONE_DEV_USER.SC_USR 
REFERENCING NEW AS NEW OLD AS OLD
FOR EACH ROW
DECLARE 
v_operation VARCHAR2(10) := NULL;
v_admin_user_id VARCHAR2(30);

BEGIN 

    v_admin_user_id := SYS_CONTEXT('USERENV', 'CLIENT_IDENTIFIER');
    IF INSERTING THEN 
       v_operation := 'INS'; 
    ELSIF UPDATING THEN 
       v_operation := 'UPD'; 
    ELSE 
       v_operation := 'DEL'; 
    END IF; 

IF INSERTING OR UPDATING THEN

   INSERT INTO SC_USR$AUD (
USR_ID,
USR_SSO_NAME,
USR_PH_NO,
USR_SOME_VALUE1,
USR_SOME_VALUE2,
USR_SOME_VALUE3,
USR_SOME_VALUE4,
USR_CREATED_BY,
USR_SOME_VALUE5,
USR_SOME_VALUE6,
aud_action,aud_timestamp,aud_user) VALUES (
:new.USR_ID,
:new.USR_SSO_NAME,
:new.USR_PH_NO,
:new.USR_SOME_VALUE1,
:new.USR_SOME_VALUE2,
:new.USR_SOME_VALUE3,
:new.USR_CREATED_DATETIME,
:new.USR_CREATED_BY,
:new.USR_SOME_VALUE4,
:new.USR_SOME_VALUE5,
v_operation,SYSDATE,v_admin_user_id);

ELSE 

   INSERT INTO SC_USR$AUD (
USR_ID,
USR_SSO_NAME,
USR_PH_NO,
USR_SIP_NAME,
USR_SIP_PSWD,
USR_SIP_DISP_NAME,
USR_CREATED_DATETIME,
USR_CREATED_BY,
USR_SIP_DOMAIN,
USR_SIP_PROXY,
aud_action,aud_timestamp,aud_user) VALUES (
:old.USR_ID,
:old.USR_SSO_NAME,
:old.USR_PH_NO,
:old.USR_SIP_NAME,
:old.USR_SIP_PSWD,
:old.USR_SIP_DISP_NAME,
:old.USR_CREATED_DATETIME,
:old.USR_CREATED_BY,
:old.USR_SIP_DOMAIN,
:old.USR_SIP_PROXY,
v_operation,SYSDATE,v_admin_user_id);

   END IF;
END; 
```

正如我所说，这很有效，但我不喜欢它，原因如下。

1.  我必须修改用于设置准备好的语句的方法中的连接。
2.  我必须将此代码添加到要审核的每个 PreparedStatementCreator 或 BatchPreparedStatementSetter 对象中。
3.  数据库操作后我无权访问连接，因此我可以清除该属性。

我真正想要的是一个点，我可以在连接之前和之后设置属性。

任何输入或想法将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-10T17:31:33.057

Spring 有一种优雅的方式来做到这一点。该示例几乎是您想要的： [Spring Data docs](http://static.springsource.org/spring-data/data-jdbc/docs/current/reference/html/orcl.connection.html#orcl.connection.2)

当从数据源获得连接时，使用 AOP 设置 CLIENT_IDENTIFIER。

可以在连接关闭时使用另一个切入点。但不是问题是您的应用程序单独使用了连接池。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T05:22:18.500

更好的方法是使用连接标签。看看**oracle.ucp.jdbc.LabelableConnection**接口。

# tfs - TFS：递归列出本地文件

> ID：11330157
> 
> 赞同：1
> 
> 时间：2012-07-04T13:33:15.903
> 
> 标签：tfs

如何递归列出映射的 TFS 文件夹中的所有本地文件？换句话说，文件不受源代码控制。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T13:49:56.410

[安装TFS 电动工具](http://visualstudiogallery.msdn.microsoft.com/c255a1e4-04ba-4f68-8f4e-cd473d6b971f/)后，这应该可以通过

`tfpt scorch /noprompt /preview`

# python - 如何使用 python 脚本将 sql.gz 文件导入 mysql 数据库？

> ID：11330159
> 
> 赞同：2
> 
> 时间：2012-07-04T13:33:29.460
> 
> 标签：python, file-io, python-2.7, mysqldump, mysql-python

我使用 python 脚本`mysqldump`以格式导出数据库。`sql.gz`如何`sql.gz`使用此 python 脚本导入该文件？

我编写了适用于`.sql`或`.txt`文件的代码。

```
import MySQLdb

filename = self.ui.txtFileLocationImport.text()

# Open database connection
db = MySQLdb.connect(dbHostName, dbUser, dbPassword, databaseName)

# prepare a cursor object using cursor() method
cursor = db.cursor()

#Prepare SQL query to INSERT a record into the database.
f = open(filename , 'r')
try:
    cursor.execute('SET foreign_key_checks = 0')
    for sql in f:
        if sql == '\n' or sql[0] == '/':
            pass
        else:
            # Execute the SQL command
            cursor.execute(str(sql))

    #Commit your changes in the database
    cursor.execute('SET foreign_key_checks = 1')
    db.commit()
except Exception as e:
   print e
   # Rollback in case there is any error
   db.rollback()

#close file
f.close()
# disconnect from server
db.close() 
```

这仅适用于`.txt`和`.sql`文件。我怎样才能让它读取一个`sql.gz`文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T14:20:56.587

与[`gzip`](http://docs.python.org/library/gzip.html)模块的内容。

# cordova - 手机间隙中不显示图像？

> ID：11330160
> 
> 赞同：0
> 
> 时间：2012-07-04T13:33:42.113
> 
> 标签：cordova, sencha-touch-2

我首先使用 Sencha Touch 2.0 设计 UI 我在面板中放置了一个图像。但是当我使用phonegap运行时，图像没有显示。这是图像的代码：

```
 xtype: 'image',
            docked: 'left',
            height: 130,
            width: 170,
            src: 'images/logo.png' 
```

此图像文件夹是应用程序文件夹。在 app 文件夹中，我也保留了视图和模型。

我在很多方面都受到了考验。但无法解决这个问题..提前谢谢..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T11:26:16.920

尝试更改`src`为`app/images/logo.png`. 它可能会解决您的问题。

# linux - autoreconf 无法从 configure.ac 创建配置

> ID：11330162
> 
> 赞同：0
> 
> 时间：2012-07-04T13:33:44.770
> 
> 标签：linux, autotools

我试图从 sf.net 构建 xtables-addons。

我已经从 SF 克隆了 xtables-addons git repo。它有一个“autogen.sh”来创建配置脚本。./autogen.sh 失败并显示以下消息：

```
/usr/bin/m4:configure.ac:33: Warning: excess arguments to builtin `m4_if' ignored
autom4te: /usr/bin/m4 failed with exit status: 1
aclocal: autom4te failed with exit status: 1
autoreconf: aclocal failed with exit status: 1 
```

我在自动工具方面没有经验，所以我对那里实际发生的事情一无所知。

autogen.sh 包含以下内容：

```
#!/bin/bash

autoreconf -fi;
rm -Rf autom4te*.cache; 
```

为什么它失败了？我有所有的自动工具。

编辑：

```
[root@s1 xtables-addons]# /usr/bin/m4 --version
m4 (GNU M4) 1.4.13
Copyright (C) 2009 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>.
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.

Written by Rene' Seindal. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T16:37:42.937

看起来像[这个错误报告](https://dev.openwrt.org/ticket/8593)。您可以从那里获取附加的补丁，或者只是转到第 32 行`configure.ac`并在`autodetect`. 即改变这个：

```
 [Path where to install Xtables extensions [[autodetect]]]]), 
```

对此：

```
 [Path where to install Xtables extensions [[autodetect]]]), 
```

# .net - 为什么在MSMQ中设置“限制消息存储”为1（KB）实际上小于1KB？

> ID：11330163
> 
> 赞同：0
> 
> 时间：2012-07-04T13:33:50.370
> 
> 标签：.net, msmq

在 MSMQ 中，我将所有队列的**消息存储限制设置为 1(KB)。**对于创建的队列`testQueue`，我没有检查**Limit message storage**，所以所有消息的总大小应该不超过 1K = 1024 字节。但实际上它**不是**。MSMQ 只接收 624 个字节！

这是我发送消息的方式：

```
var mq = new MessageQueue(@".\private$\testQueue");

var sb = new StringBuilder();
for (int i = 0; i < 584; i++)
{
    sb.Append("a");
}

mq.Send(sb.ToString()); 
```

在 MSMQ 中，消息体是：

```
<?xml version="1.0"?>
<string>aaaaaaa...aaaaaaa</string> 
```

1.  大小`xml header = 21`
2.  没有内容的根元素的大小：`string></string> = 17`
3.  标题和根之间的新行：`\r\n = 2`
4.  根元素的内容 = 584

-----总计 = 624 字节

当我尝试将 584 增加到 585 时，出现资源不足的错误。如果我将**限制消息存储**更改为 2(KB)，我也不能发送 2048 字节但更少。

我在这里想念什么？

# android - 在 Mac 上找不到 Android aapt

> ID：11330165
> 
> 赞同：16
> 
> 时间：2012-07-04T13:34:10.290
> 
> 标签：android, macos, intellij-idea

尝试在 MacOSX 上的 IntelliJ (v11.1) 中编译我的 android 项目时出现以下错误。

* * *

```
I/O error: Cannot run program "/%PATH_TO_SDK%/android-sdk-macosx/platforms
/android-16/tools/aapt": error=2, No such file or directory 
```

* * *

有些地方说当我需要 32 位时我可能会使用 64 位版本的库，但是遇到这个问题的每个人都在使用 Ubuntu，所以我找到的解决方案只适合那个。

奇怪的是，今天早上我只安装了 android-16 时它可以工作，但是在我下载其他版本后它就停止了。

任何帮助，将不胜感激。如果需要，可以提供更多信息。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2015-03-22T12:41:35.373

aapt 位置已更改，可在以下位置找到

```
/path/to/adt/sdk/buid-tools/android-[version]/aapt 
```

归功于[拉法尔曼卡](https://stackoverflow.com/users/2373380/rafalmanka)

更多信息：[在正确的路径下找不到 aapt](https://stackoverflow.com/questions/4386392/aapt-not-found-under-the-right-path)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2019-08-02T09:53:34.283

在默认安装 Android 的 MacOS 上，当前`aapt`位置位于特定的构建工具版本中。对于 build-tools `28.0.3`，您将在以下路径中找到它：

```
/Users/userName/Library/Android/sdk/build-tools/28.0.3 
```

`userName`请记住在 MacOS中更改为您的用户名。

# c# - 如何定位 TextBox 的装饰器？

> ID：11330166
> 
> 赞同：1
> 
> 时间：2012-07-04T13:34:12.460
> 
> 标签：c#, wpf

我创建了包含 TextBlock 的装饰器。此 TextBlock 与装饰的 TextBox 重叠。问题是这些控件的文本的起始位置不一样。如何对齐 TextBlock 以实现文本位置的匹配？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T18:32:18.750

除了在装饰层中调整 TextBlock 的边距很明显之外，还有另一种可能的方法浮现在脑海中。在不知道您的真正目标是什么的情况下（除了将文本放置在 TextBox 上）很难说这是否会有所帮助，但这里有。

您可以[使用](https://stackoverflow.com/a/7433840/718325)由您在装饰层中使用的 TextBlock 组成的 VisualBrush（此技术*不会*使用装饰层）。然后将该 VisualBrush 应用到 TextBox 的背景。这会将文本准确地定位在您的 TextBox 中。当然，这种技术在 TextBox 为空时最有用，因此只有 VisualBrush 的 TextBlock 中的文本可见（而不是 TextBox 中的任何其他文本也可见）。

我已经使用这种技术在 TextBox 为空时显示“提示文本”（此处显示的 ErrorTemplate 和提示文本的组合可能很可疑，但您明白了）。“0 到 159”文本是 VisualBrush 中的 TextBlock，当其 Text 属性为空时，它会应用于 TextBox 的背景：

![使用 VisualBrush 显示的提示文本](../Images/9005b7a2005030d2b607e7f006c21ff2.png)

也许有了更多关于您的目标的信息，我们也可以建议其他方法。

# wcf - 在 Mono 上运行的客户端中捕获 WCF FaultException

> ID：11330170
> 
> 赞同：0
> 
> 时间：2012-07-04T13:34:29.573
> 
> 标签：wcf, mono

我有一个使用 NetTcp 双工通道的服务器/客户端，我试图弄清楚在单声道（v2.10.8）下运行它需要多少工作。

有人能告诉我如何正确地向在单声道下运行的客户端抛出 FaultException 吗？或者如果这不完全支持？

合同定义为：

```
[OperationContract(IsInitiating = true)]
[FaultContract(typeof(IOException))] 
string ConnectWithFault(string clientVersion, string workstation) 
```

并且服务器端方法将始终生成故障以进行测试：

```
public string ConnectWithFault(string clientVersion, string workstation)
{
  IOException ioe = new IOException("Testing Fault Contract");
  throw new FaultException<IOException>(ioe, new FaultReason(ioe.Message), new FaultCode("Sender")); 

  return "Should Never Reach Here!";
} 
```

当我在 windows 中正常运行客户端时，一切正常，但是当我在 Windows 中以单命令提示符运行客户端时，FaultException 似乎确实传到了客户端，但我无法正确捕获它。或者当它试图在客户端捕获 FaultException 时是否存在内部单声道错误？我试图抓住几种不同的形式：

```
public void TestConnectWithFault()
{
  Console.WriteLine("Client->TestConnectWithFault() +");
  try
  {
    string response = RemoteSessionChannel.ConnectWithFault("client1.0", "MY-PC");
    Console.WriteLine("**** DuplexClient->Connect Response: {0}", response);
  }
  catch (FaultException<IOException> ioe)
  {
    Console.WriteLine("Connect failed. (IOException): {0}", ioe.ToString());
  }
  catch (FaultException fe)
  {
    Console.WriteLine("Connect failed. (FaultException): {0}", fe.ToString());
  }
  catch (Exception ex)
  {
    Console.WriteLine("Connect failed. (Exception): {0}", ex.ToString());
  }
  Console.WriteLine("Client->TestConnectWithFault() -");
} 
```

但是我总是在客户端控制台中得到以下输出并且客户端挂起：

```
Client->TestConnectWithFault() +

**System.ServiceModel.FaultException: Testing Fault Contract
  at System.ServiceModel.MonoInternal.DuplexClientRuntimeChannel.ProcessInputCor
e (IInputChannel input, System.ServiceModel.Channels.Message message) [0x00000]
in <filename unknown>:0
  at System.ServiceModel.MonoInternal.DuplexClientRuntimeChannel.ProcessInput (I
InputChannel input, System.ServiceModel.Channels.Message message) [0x00000] in <
filename unknown>:0** 
```

所以看起来异常正在传递给客户端，但没有被任何 catch 块拾取，或者我没有做对？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T15:33:09.160

上周我在 Mono 中修复了[错误 #7177 。](https://bugzilla.xamarin.com/show_bug.cgi?id=7177)

我很快[对此进行了测试](https://github.com/baulig/Provcon-Faust/tree/034df9622bcd772fcc8547a8931c60d7e319807d/TestWCF)，现在它工作正常。

# javascript - Javascript - 主干 - 代码抛出错误

> ID：11330173
> 
> 赞同：0
> 
> 时间：2012-07-04T13:34:33.707
> 
> 标签：javascript, jquery, backbone.js, mustache

下面的代码在这部分代码中抛出错误 - “Microsoft JScript 运行时错误：对象不支持此属性或方法”在 mustache.js 中。 - “

```
function quote(text) {
    var escaped = text.replace(jsCharsRe, function (c) {
      return "\\u" + ('0000' + c.charCodeAt(0).toString(16)).slice(-4);
    });" 
```

这是我的代码

```
<%@  Language="C#" AutoEventWireup="true" CodeBehind="Default.aspx.cs" Inherits="VSBackboneDemo._Default" %>
<html>
<head>
    <title>VS backbone demo</title>
    <script src="Scripts/jquery.min.js" type="text/javascript"></script>
    <script src="Scripts/underscore-min.js" type="text/javascript"></script>
    <script src="Scripts/backbone-min.js" type="text/javascript"></script>
    <script src="http://github.com/janl/mustache.js/raw/master/mustache.js"></script>
    <script type="text/javascript">

        EmployeeDataView = Backbone.View.extend({
            initialize: function () {

                this.render();
            },
            render: function () {

                var data = {
                    employees: [
                { firstName: "Mickey",
                    lastName: "Mouse",
                    employeeID: 10000,
                    jobTitle: "Software Developer"
                },
                { firstName: "Donald",
                    lastName: "Duck",
                    employeeID: 20000,
                    jobTitle: "Software Engineer"
                },
                { firstName: "Bugs",
                    lastName: "Bunny",
                    employeeID: 30000,
                    jobTitle: "UI tester"
                },
                ]
                };

                var tpl = "Employees:<ul>{{#employees}}<li>{{firstName}} {{lastName}}" +
                    "{{employeeID}}{{jobTitle}}</li>{{/employees}}</ul>";

                var html = Mustache.to_html(tpl, data);

                $('#EmployeeDataContainer').html(html);

            }

        });

        var EmployeeDataView = new EmployeeDataView({ el: $("#EmployeeDataContainer") });

    </script>
</head>
<body>
    <div id="EmployeeDataContainer">
    </div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T17:44:09.257

你的问题是你有一个杂散的尾随逗号`data.employees`：

```
var data = {
    employees: [
        // ...
        { firstName: "Bugs",
          lastName: "Bunny",
          employeeID: 30000,
          jobTitle: "UI tester"
        }, // <------------------------- Right here
    ]
}; 
```

所有其他 JavaScript 解析器（错误地）忽略尾随逗号，但 IE（至少是较旧的）将 a`null`滑入您的数组，因此它们`data`如下所示：

```
var data = {
    employees: [
        // ...
        { firstName: "Bugs",
          lastName: "Bunny",
          employeeID: 30000,
          jobTitle: "UI tester"
        },
        null
    ]
}; 
```

然后`{{#employees}}`在你的 Mustache 模板中最终尝试使用 a`null`并且一切都崩溃了。

删除那个尾随逗号，一切都应该正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T14:22:44.683

好吧，我已经修复了它，它存在三个问题。

1）逗号问题，“mu太短”的问题也被正确识别。

2）您必须将整个脚本包装起来， `$(function() { .......... });`否则它将无法正确显示。

3）最新版本的小胡子给了我错误，当我使用旧版本时它工作正常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T14:10:59.460

您忘记添加`type="text/javascript"`到此行

```
<script src="http://github.com/janl/mustache.js/raw/master/mustache.js"></script> 
```

所以把它改成这样：

```
<script type="text/javascript" src="http://github.com/janl/mustache.js/raw/master/mustache.js"></script> 
```

这里发生的是您的浏览器将您的 mustache.js 文件解释为 Microfosft JScript，它不是 Javascript。

希望这会有所帮助！

# mysql - 涉及连续值的棘手 SQL 查询

> ID：11330175
> 
> 赞同：8
> 
> 时间：2012-07-04T13:34:38.043
> 
> 标签：mysql, sql, database

我需要执行一个相对容易解释但（鉴于我的技能有限）很难编写 SQL 查询。

假设我们有一个类似于这个的表：

```
 exam_no | name | surname | result | date
---------+------+---------+--------+------------
 1       | John | Doe     | PASS   | 2012-01-01
 1       | Ryan | Smith   | FAIL   | 2012-01-02 <--
 1       | Ann  | Evans   | PASS   | 2012-01-03
 1       | Mary | Lee     | FAIL   | 2012-01-04
 ...     | ...  | ...     | ...    | ...
 2       | John | Doe     | FAIL   | 2012-02-01 <--
 2       | Ryan | Smith   | FAIL   | 2012-02-02
 2       | Ann  | Evans   | FAIL   | 2012-02-03
 2       | Mary | Lee     | PASS   | 2012-02-04
 ...     | ...  | ...     | ...    | ...
 3       | John | Doe     | FAIL   | 2012-03-01
 3       | Ryan | Smith   | FAIL   | 2012-03-02
 3       | Ann  | Evans   | PASS   | 2012-03-03
 3       | Mary | Lee     | FAIL   | 2012-03-04 <-- 
```

请注意，`exam_no`并且`date`不一定像我选择的示例中所期望的那样相关。

现在，我需要做的查询如下：

*   从最近的考试 ( `exam_no`= 3) 中找出所有不及格的学生 ( `John Doe`,`Ryan Smith`和`Mary Lee`)。
*   对于这些学生中的每一个，找出连续不及格的考试中第一批的日期。另一种说法是：对于这些学生中的每一个，找出他们最后一次通过考试之后的第一次失败考试的日期。（查看表中的箭头）。

结果表应该是这样的：

```
 name | surname | date_since_failing
------+---------+--------------------
 John | Doe     | 2012-02-01
 Ryan | Smith   | 2012-01-02
 Mary | Lee     | 2012-03-04 
```

我怎样才能执行这样的查询？

感谢您的时间。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-04T13:52:06.347

您可以利用这样一个事实，即如果某人通过了最近一次考试，那么他们自最近一次通过以来就没有通过任何考试：因此问题归结为发现自最近一次通过以来的第一次考试失败：

```
SELECT   name, surname, MIN(date) date_since_fail
FROM     results NATURAL LEFT JOIN (
  SELECT   name, surname, MAX(date) lastpass
  FROM     results
  WHERE    result = 'PASS'
  GROUP BY name, surname
) t
WHERE    result = 'FAIL' AND date > IFNULL(lastpass,0)
GROUP BY name, surname 
```

在[sqlfiddle](http://sqlfiddle.com/#!2/12b93/1/0)上查看。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T13:45:19.177

我应该使用一个子查询来获取上次通过的考试，例如：

```
SET @query_exam_no = 3;
SELECT
 name,
 surname,
 MIN(IF(date > last_passed_exam, date, NULL)) AS date_failing_since
FROM
 exam_results
 LEFT JOIN (
  SELECT
   name,
   surname, 
   MAX(date) AS last_passed_exam 
  FROM exam_results 
  WHERE result = 'PASS' 
  GROUP BY name, surname
 ) AS last_passed_exams USING (name, surname)
HAVING
 MAX(IF(exam_no = @query_exam_no, result, NULL)) = 'FAIL'
GROUP BY name, surname 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T13:48:17.437

这就够了：

```
select t.name,
       t.surname,
       t.date as 'date_since_failing'
from tablename t
inner join
(
    select name,
           surname,
           max(exam_no) as exam_no
    from tablename
    group by name, surname
    having min(result) = 'FAIL'
) aux on t.name = aux.name and t.surname = aux.surname and t.exam_no = aux.exam_no 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-04T13:51:18.897

你所要求的条件是没有用的，没有它你就做不到。这是工作示例。

```
select
  e.name,
  e.sur_name,
  min(e.date) as `LastFailed`
from exams as e
where e.result = 'Fail'
group by e.name
    order by e.name 
```

这产生了这个结果

```
name            sur_name    LastFailed
Ann         Evans       2012-02-03
John        Doe         2012-02-01
Mary        Lee         2012-01-04
Ryan        Smith       2012-01-02 
```

# android - 在具有 ssl 支持的 android 上移植 libcurl

> ID：11330180
> 
> 赞同：6
> 
> 时间：2012-07-04T13:34:57.390
> 
> 标签：android, libcurl, porting, android-ndk

我正在尝试将 libCurl 移植到具有 SSL 支持的 android，第一步是在没有 ssl 支持的情况下移植 curl 我猜所以我开始这样做。但我遇到了一个问题。

正如我在开发网站和 Android.mk 文件中所读到的，困难的部分是首先配置 make。所以我所做的是：

1.  下载 Android 源代码（并编译它！因为需要一些中间库）

2.  下载卷曲

3.  在 {android_src}/external/curl 下解压 curl

4.  通过在包含此内容的 external/curl 文件夹中创建一个 sh 文件来为 curl 创建配置脚本。

`

```
export A=/home/user/Development/AOSP/2.3.3    
export CC=$A/prebuilt/linux-x86/toolchain/arm-eabi-4.2.1/bin/arm-eabi-gcc 
export NDK=/home/user/Development/Tools/sdk/android/ndk
export NDKLIBS=$NDK/platforms/android-4/arch-arm/usr/include
export SYSROOT=$A/ndk/build/platforms/android-4/arch-arm 
export CPPFLAGS="-I $A/system/core/include"
export LDFLAGS="-L$A/out/target/product/generic/obj/lib/ -L$A/out/target/product/generic/system/lib/-L$SYSROOT/usr/lib -Wl,--gc-sections -nostdlib -lc -lm -ldl -llog -lgcc -Wl,--no-undefined,-z,nocopyreloc -Wl,-dynamic-linker,/system/bin/linker -L$NDK/out/target/product/generic/obj/lib/" 
export CFLAGS="-fno-exceptions -Wno-multichar -mthumb -mthumb-interwork -nostdlib -lc -ldl -lm -march=armv5te -mtune=xscale -msoft-float -mandroid -fPIC -mthumb-interwork -mthumb -mlong-calls -ffunction-sections -fstack-protector  -fno-short-enums -fomit-frame-pointer -fno-strict-aliasing -finline-limit=64 -D__ARM_ARCH_5__ -D__ARM_ARCH_5T__ -D__ARM_ARCH_5E__ -D__ARM_ARCH_5TE__ -DANDROID -DOS_ANDROID -D__NEW__ -D__SGI_STL_INTERNAL_PAIR_H -I$SYSROOT/usr/include -I $A/system/core/include -I $NDKLIBS" 

./configure --host=arm-eabi --with-ssl=$A/external/openssl 
```

` 输出摘要是这个：

配置：配置为构建 curl/libcurl：

```
 curl version:     7.26.0
  Host setup:       arm-unknown-eabi
  Install prefix:   /usr/local
  Compiler:         /home/tanco/Development/AOSP/2.3.3/prebuilt/linux-x86/toolchain/arm-eabi-4.2.1/bin/arm-eabi-gcc
  SSL support:      no      (--with-{ssl,gnutls,nss,polarssl,cyassl,axtls} )
  SSH support:      no      (--with-libssh2)
  zlib support:     enabled
  krb4 support:     no      (--with-krb4*)
  GSSAPI support:   no      (--with-gssapi)
  SPNEGO support:   no      (--with-spnego)
  TLS-SRP support:  no      (--enable-tls-srp)
  resolver:         default (--enable-ares / --enable-threaded-resolver)
  ipv6 support:     no      (--enable-ipv6)
  IDN support:      no      (--with-libidn)
  Build libcurl:    Shared=no, Static=yes
  Built-in manual:  enabled
  --libcurl option: enabled (--disable-libcurl-option)
  Verbose errors:   enabled (--disable-verbose)
  SSPI support:     no      (--enable-sspi)
  ca cert bundle:   /etc/ssl/certs/ca-certificates.crt
  ca cert path:     no
  LDAP support:     no      (--enable-ldap / --with-ldap-lib / --with-lber-lib)
  LDAPS support:    no      (--enable-ldaps)
  RTSP support:     enabled
  RTMP support:     no      (--with-librtmp)
  Protocols:        DICT FILE FTP GOPHER HTTP IMAP POP3 RTSP SMTP TELNET TFTP

  SONAME bump:     yes - WARNING: this library will be built with the SONAME
                   number bumped due to (a detected) ABI breakage.
                   See lib/README.curl_off_t for details on this. 
```

首先想到的奇怪的事情是为什么 SSL 不包含在配置中，因为链接器显示到中间库并调用了 ssl 支持标志，但是当我在我创建的 jni 项目中使用相同的 curl_config.h 文件之后构建（因为它有一个独立的 Android.mk 文件，它可以通过在 android 项目的 jni 文件夹中解压缩，复制在 AOSP 源中创建的配置文件并调用 ndk-build 来编译）

所以我编译并得到：

```
$ ndk-build
Compile thumb  : curl <= url.c
In file included from /Projects/temp/testNDK/jni/lib/url.c:32:0:
/Tools/sdk/android/ndk/platforms/android-14/arch-arm/usr/include/unistd.h: In function 'getpagesize':
/Tools/sdk/android/ndk/platforms/android-14/arch-arm/usr/include/unistd.h:171:3: warning: nested extern declaration of '__page_size' [-Wnested-externs]
/Tools/sdk/android/ndk/platforms/android-14/arch-arm/usr/include/unistd.h: In function '__getpageshift':
/Tools/sdk/android/ndk/platforms/android-14/arch-arm/usr/include/unistd.h:175:3: warning: nested extern declaration of '__page_shift' [-Wnested-externs]
/Projects/temp/testNDK/jni/lib/url.c: At top level:
/Projects/temp/testNDK/jni/lib/url.c:57:2: error: #error "We can't compile without socket() support!"
make: *** [/Projects/temp/testNDK/obj/local/armeabi/objs/curl/lib/url.o] Error 1 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-24T21:43:14.880

这是解决方案，更新到NDK8c

**零步**：下载并修复 Android NDK 我不知道如何，但 ndk 有一个非常有趣的缺陷，（在我看来）不允许你编译很多东西，所以能够编译你需要的 OpenSSL要进行小修复，请在保留工具的任何位置提取 ndk8c，然后编辑文件：android-ndk-r8c/build/gmsl/__gmsl 第 512 行：更改行

```
int_encode = $(__gmsl_tr1)$(wordlist 1,$1,$(__gmsl_input_int)) 
```

带线

```
int_encode = $(__gmsl_tr1)$(wordlist 1,$(words $1),$(__gmsl_input_int)) 
```

你很高兴去！

**第一步**：下载 OpenSSL 并为 Android 编译：要么编译[**此处**](https://github.com/guardianproject/openssl-android)找到的移植版本， 要么下载 OpenSSL 的官方 1.0.0c 版本，然后使用我为 Android 兼容版本链接的 github 中提供的手册为 android 编译它

所以下一步就是获取**libssl.so**和**libcrypto.so** 并将它们放在 NDK 文件夹中以便于访问，因此将它们从

```
openssl-folder/libs/armeabi/ 
```

到

```
android-ndk-r8c/platforms/android-8/arch-arm/usr/lib 
```

这样编译时，您可以使用简单的链接器开关包含库`-lssl -lcrypto`

**第二步：****[在这里](http://curl.haxx.se/download.html)**获取 Curl 的最新资源

在 Docs/INSTALL 中打开文件并按照制作独立工具链所需的步骤并将其放入所需的文件夹，然后是棘手的部分，即使我有独立编译的，我也需要有 android 的源代码才能继续配置openssl 你也可以从那里包含头文件，无论如何这是更复杂的版本，所以你选择你做什么，我没有选择逃避它们，所以你可以去[谷歌 AOSP 网站](http://source.android.com/source/initializing.html)并通过构建和初始化的步骤环境。

所以它会是这样的：

1.下载，

2.  转到源代码的根目录并运行：

    〜：构建/envsetup.sh；午餐 1；制作;

所以最后我们需要编译带有 SSL 支持的 curl，所以，

**第三步**

将 curl 提取到所需的文件夹（我特别希望禁用除 http/s 之外的所有内容，以使库尽可能小，这意味着大约 300k，如果您想要在您的库中使用更多协议，请删除 --disable-protocol 的所需的协议）运行以下命令：

```
make clean

export PATH=/opt/arm-linux-androideabi-4.4.3/bin:$PATH

export LDFLAGS="\
-lssl \
-lcrypto \
-L/home/user/Development/Tools/sdk/android/ndk/platforms/android-8/arch-arm/usr/lib"

export CFLAGS="\
-I/home/user/Development/AOSP/2.3.7/system/core/include \
-I/home/user/Development/Tools/sdk/android/ndk/platforms/android-8/arch-arm/usr/include"

./configure --host=arm-linux-androideabi \
--with-ssl=/home/user/Development/Projects/portingLibs/openssl-android-master \
--disable-ftp \
--disable-gopher \
--disable-file \
--disable-imap \
--disable-ldap \
--disable-ldaps \
--disable-pop3 \
--disable-proxy \
--disable-rtsp \
--disable-smtp \
--disable-telnet \
--disable-tftp \
--without-gnutls \
--without-libidn \
--without-librtmp \
--disable-dict

make

Note that in the block above, if you don't want to use the AOSP source, you could switch 

-I/home/user/Development/AOSP/2.3.7/system/core/include \

with the include folder for your ssl distribution. 
```

所以最后你有：静态：

```
curl-7.28.1/lib/.libs/libcurl.a 
```

并分享：

```
curl-7.28.1/lib/.libs/libcurl.so.5.3 
```

就是这样..取文件，然后编译:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-07-05T13:27:56.610

我喜欢使用 Docker 构建此类静态库的方式。这里有完整的脚本——你只需运行它并获取结果。示例：[https ://gist.github.com/VictorLaskin/1c45245d4cdeab033956](https://gist.github.com/VictorLaskin/1c45245d4cdeab033956)

这样的脚本将：

*   setup 编译工具 / utils 下载 sdk/ndk
*   为库（zlib、openssl、curl）创建自定义交叉编译工具链下载源代码
*   交叉编译的设置环境设置
*   配置和制作库
*   在一个文件夹中收集输出并创建获取已编译库的方法

此特定版本使用最新的 NDK 10e 和 clang 工具链。

这里有更多详细信息的帖子：http: [//vitiy.info/dockerfile-example-to-compile-libcurl-for-android-inside-docker-container/](http://vitiy.info/dockerfile-example-to-compile-libcurl-for-android-inside-docker-container/)

我希望这能帮助人们不要浪费宝贵的时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-02T09:27:53.650

可以在此处找到使用 ssl 支持对 android jni 编译 libcurl.so 的步骤：http: [//ieroot.com/2015/03/29/1728.html](http://ieroot.com/2015/03/29/1728.html)

我挣扎了一周才弄明白。

询问是否有任何问题。我会尽快回复。

# java - 数组中的 NullPointerException

> ID：11330182
> 
> 赞同：1
> 
> 时间：2012-07-04T13:35:00.163
> 
> 标签：java, arrays, nullpointerexception

我有一个带有 JTextFields 的 JFrame，它接受用户的输入以添加到数组中。

这是它的 ActionListener

```
class ButtonHandlerSub implements ActionListener{
        public void actionPerformed(ActionEvent ae){if(ae.getSource() == add2){
            //add new student here
            Student temp = new Student(Integer.parseInt(tId.getText()),tName.getText(),tCourse.getText(),
                                        Integer.parseInt(tYear.getText()),tGender.getText());
            sLogic.addStudentArray(temp); // this is line 168 
```

addStud.dispose(); }

这是声明 sLogic 的构造函数

```
 public StudentGUI() throws Exception{
    ButtonHandler bh = new ButtonHandler();
    //Instantiate Main frame buttons
    add = new JButton("Add Student");
    add.addActionListener(bh);
    del = new JButton("Delete Student");
    edit = new JButton("Edit Student");
    edit.addActionListener(bh);
    save = new JButton("Save Changes");
    //Main frame buttons added to JPanel actions
    actions = new JPanel(new GridBagLayout());
    GridBagConstraints b = new GridBagConstraints();
    b.insets = new Insets(5,0,5,0);
    b.fill = GridBagConstraints.HORIZONTAL;
    actions.add(add,b);
    b.gridy = 1;
    actions.add(del,b);
    b.gridy = 2;
    actions.add(edit,b);
    b.gridy = 3;
    actions.add(save,b);

    sLogic = new StudentLogic();
    model = new  DefaultTableModel(sLogic.getStudentArray(),sLogic.getColumnLabel());
    table = new JTable(model){
        public boolean isCellEditable(int row,int col){
            return false;
        }
    };
    //add Jtable to scroller
    JScrollPane scroller = new JScrollPane(table);

    main = new JFrame("Student Database");
    main.setLayout(new GridBagLayout());
    GridBagConstraints a = new GridBagConstraints();
    a.insets = new Insets(10,5,10,5);
    main.add(scroller,a);
    a.gridx=1;
    a.weighty = 1;
    main.add(actions,a);
    main.pack();
    main.setVisible(true);
    main.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    //set JButtons edit and del disabled as default
    edit.setEnabled(false);
    del.setEnabled(false);
} 
```

这是方法 addStudentArray()

```
public void addStudentArray(Student studArr){
        studs =  Arrays.<Student>copyOf(studs,studs.length+1);
        studs[studs.length-1]=studArr;
    } 
```

它在一个带有构造函数的类中：

```
public StudentLogic() throws Exception {
    output = new ObjectOutputStream(new FileOutputStream("students_updated.dat"));
    input = new ObjectInputStream(new FileInputStream("students.dat"));
    studs = (Student[]) input.readObject();
    studs2 = new Object[studs.length][5];
    for(int i = 0; i < studs.length; i++){
        studs2[i][0]=studs[i].getID()+"";
        studs2[i][1]= studs[i].getName();
        studs2[i][2]= studs[i].getCourse();
        studs2[i][3]= studs[i].getYr();
        studs2[i][4]= studs[i].getGender();
    }
    input.close();
} 
```

我被这个异常困住了，我不知道为什么它会返回 npe。我很确定我已经宣布了。如果需要，我可以发布更多代码。提前致谢 ：）

至于控制台

```
Exception in thread "AWT-EventQueue-0" java.lang.NullPointerException
    at StudentGUI$ButtonHandlerSub.actionPerformed(StudentGUI.java:168)
    at javax.swing.AbstractButton.fireActionPerformed(AbstractButton.java:2018)
    at javax.swing.AbstractButton$Handler.actionPerformed(AbstractButton.java:2341)
    at javax.swing.DefaultButtonModel.fireActionPerformed(DefaultButtonModel.java:402)
    at javax.swing.DefaultButtonModel.setPressed(DefaultButtonModel.java:259)
    at javax.swing.plaf.basic.BasicButtonListener.mouseReleased(BasicButtonListener.java:252)
    at java.awt.Component.processMouseEvent(Component.java:6505)
    at javax.swing.JComponent.processMouseEvent(JComponent.java:3321)
    at java.awt.Component.processEvent(Component.java:6270)
    at java.awt.Container.processEvent(Container.java:2229)
    at java.awt.Component.dispatchEventImpl(Component.java:4861)
    at java.awt.Container.dispatchEventImpl(Container.java:2287)
    at java.awt.Component.dispatchEvent(Component.java:4687)
    at java.awt.LightweightDispatcher.retargetMouseEvent(Container.java:4832)
    at java.awt.LightweightDispatcher.processMouseEvent(Container.java:4492)
    at java.awt.LightweightDispatcher.dispatchEvent(Container.java:4422)
    at java.awt.Container.dispatchEventImpl(Container.java:2273)
    at java.awt.Window.dispatchEventImpl(Window.java:2719)
    at java.awt.Component.dispatchEvent(Component.java:4687)
    at java.awt.EventQueue.dispatchEventImpl(EventQueue.java:703)
    at java.awt.EventQueue.access$000(EventQueue.java:102)
    at java.awt.EventQueue$3.run(EventQueue.java:662)
    at java.awt.EventQueue$3.run(EventQueue.java:660)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:76)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:87)
    at java.awt.EventQueue$4.run(EventQueue.java:676)
    at java.awt.EventQueue$4.run(EventQueue.java:674)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:76)
    at java.awt.EventQueue.dispatchEvent(EventQueue.java:673)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(EventDispatchThread.java:244)
    at java.awt.EventDispatchThread.pumpEventsForFilter(EventDispatchThread.java:163)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(EventDispatchThread.java:151)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:147)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:139)
    at java.awt.EventDispatchThread.run(EventDispatchThread.java:97) 
```

第 168 行是 sLogic.addStudentArray(temp);

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T14:05:31.857

以下内容将暂时防止出现空值`studs`。

```
public synchronized void addStudentArray(Student studArr){
    Student[] enlargedStuds = Arrays.copyOf(studs, studs.length + 1);
    enlargedStuds[enlargedStuds.length - 1] = studArr;
    studs = enlargedStuds;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T14:07:11.920

可能您的 ButtonHandlerSub 对象中的 sLogic 与已初始化的 StudentGUI 中的 sLogic 不同。

这是你写的：

```
public StudentGUI() throws Exception{
    ButtonHandler bh = new ButtonHandler();
    ...
    sLogic = new StudentLogic();  // <- this is not the bh.sLogic!
    ... 
```

# php - 病假权利基于在公司服务年限

> ID：11330184
> 
> 赞同：0
> 
> 时间：2012-07-04T13:35:02.333
> 
> 标签：php, cakephp

我的功能为您提供了更新。这现在也可以正常工作，但我需要它来计算出完全生病的情况，根据他们在生病第一天之前的服务年限。希望我已经说清楚了。我已经标记了解决我生病的代码行，但我一直只给我一个，即使我知道那个选定的用户还有更多年的时间。

请帮忙？

格伦·柯蒂斯

```
function sickDay($id = null) {
    if($this->CURRENT_USER['User']['role_id'] > 3) { //directors and admins
        /*if(empty($this->data) || !isset($this->data['Holiday']['id'])) {

        } else {*/
        //Get the user sick days
        $userSickDays = $this->Holiday->find(
            'all',
            array(
                'conditions' => array(
                    'Holiday.holidaystype_id' => 3,
                    'Holiday.user_id' => $id
                ),
                'order' => 'Holiday.startson ASC'
            ));

        //Get years of service
        $userContracts = $this->Holiday->User->Contract->find(
            'all',
                array(
                    'conditions' => array( 'Contract.user_id' => $id), //$data['user_id']),
                    'order' => array( 'Contract.startson' => 'ASC' )
            ));

        //Loop through the user's sick days
        foreach ($userSickDays as $k => $sickDay) {
            //Get number of days in the current sick day
            $totSickdays = $this->Holiday->getNumberDaysFromHoliday($sickDay['Holiday']['id']);

            //Get number of sick days for the past 12 months
            if($k > 0) {
                for($i=0; $i<$k; $i++) {
                    if((strtotime(gmdate("Y-m-d", $sickDay['Holiday']['startson'])." -1 year GMT")) <= $userSickDays[$i]['Holiday']['startson']) {
                        $totSickdays += $this->Holiday->getNumberDaysFromHoliday($userSickDays[$i]['Holiday']['id']);
                    }
                }
            }
            foreach ($userContracts as $y => $contract) {

        THIS LINE HERE->$yearsService = $contract['Contract']['startson'] <= $sickDay['Holiday']['startson'];

                if ($contract['Contract']['startson'] <= $sickDay['Holiday']['startson']) {

                    if ($yearsService <= 1) {
                        $entitlement = 10;
                        $remaingDays = $entitlement - $totSickdays;
                        //echo 'one year';
                    } elseif ($yearsService <= 2) {
                        $entitlement = 20;
                        $remaingDays = $entitlement - $totSickdays;
                        //echo 'two years';
                    } elseif ($yearsService <= 4) {
                        $entitlement = 40;
                        $remaingDays = $entitlement - $totSickdays;
                        //echo 'up to five years';
                    } elseif ($yearsService >= 5) {
                        $entitlement = 60;
                        $remaingDays = $entitlement - $totSickdays;
                        //echo 'five years or more';
                    } else {
                        $entitlement = 0;
                        $remaingDays = 0;
                        //echo 'no sick pay';
                    }

                } //End of if statement.
            } //End of $userContracts Foreach Loop

            debug($yearsService);                           
        } //End of Foreach Loop

        //$this->render('/artists/holidayslist');
        //} //End For if empty check
    } // End for if CURRENT_USER
    die();
} //End of Function 
```

* * *

## 下面的旧帖子

现在我以前曾就此寻求过帮助，但这超出了我职能的一个选定区域，以获得病假天数。现在可以了，我在我正在处理的网站中找到了一个为我构建的功能。所以我在数据库中输入了病假总数。现在我似乎无法弄清楚为什么我不能将其设置为我多年的服务。

为了让我自己更清楚，这个功能的结果是检查当前用户在选定的一年内生病。但到一年，约定的一年，例如可能到可能。

这就是为什么我有许多 if 语句来设置用户权利，因为它会根据服务年限而改变。然后，当设置好之后，取消用户在该合同年度内休的病假。

我希望我已经解释了我想做什么，如果不清楚，请告诉我，我会尝试更详细地解释。

请帮助，这是为 CakePHP 项目中使用的页面编写的。

非常感谢

格伦·柯蒂斯

```
function sickDay($id = null) {
    if($this->CURRENT_USER['User']['role_id'] > 3) { //directors and admins
        //Caculate if it's a full pay, half pay or nothing
        //$data = $this->data['Holiday'];

        //Get Holidaytypes
        $userSickDays = $this->Holiday->find(
            'all',
            array(
                'conditions' => array(
                    'Holiday.holidaystype_id' => 3,
                    'Holiday.user_id' => $id
                )
            )
        );

        //Get starting date
        $contracts = $this->Holiday->User->Contract->find(
            'all',
            array(
                'conditions' => array(
                    'Contract.user_id' => $id //$data['user_id']
                ),
                'order' => array(
                    'Contract.startson' => 'ASC'
                )
            )
        );

        $start = array_shift($contracts);
        $end = array_pop($contracts);
        $endDate = $end['Contract']['endson'];
        $startDate = $start['Contract']['startson'];

        if (empty($endDate)) { $endDate = time('now'); }

        $SortEnd = strftime("%Y", $endDate);
        $SortStart = strftime("%Y", $startDate);
        $YearsService = $SortEnd - $SortStart;

        //Get How Many sick days
        foreach ($userSickDays as $sickDay) {
            $typesDataEnds =  strtotime($sickDay['Holiday']['endson']);
            $typesDataStarts = $sickDay['Holiday']['startson'];

            $DateNow = date('U', strtotime('Now'));

            $GetSickDays = $this->Holiday->getNumberDaysFromHoliday($sickDay['Holiday']['id']);

            $TotalSick += $GetSickDays;

            if ($YearsService <= 1) {
                    $SetFullEntitlement = 5;
                    $SetHalfEntitlement = 5;
                    //echo 'one year';
            } elseif ($YearsService <= 2) {
                    $SetFullEntitlement = 10;
                    $SetHalfEntitlement = 10;
                    //echo 'two years';
            } elseif ($YearsService <= 5) {
                    $SetFullEntitlement = 20;
                    $SetHalfEntitlement = 20;
                    //echo 'up to five years';
            } elseif ($YearsService >= 6) {
                    $SetFullEntitlement = 30;
                    $SetHalfEntitlement = 30;
                    //echo 'five years or more';
            } else {
                    $SetFullEntitlement = 0;
                    $SetHalfEntitlement = 0;
                    //echo 'no sick pay';
            }

        } 
        //$this->render('/artists/holidayslist');

    } // End for if CURRENT_USER
    die();
} //End of Function 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T13:56:33.273

你的代码似乎太复杂了（看起来）只是

`return (($TotalAnnualEntitlement - $SickDaysTakenThisYear) > 0) ? true : false;`

您需要根据他们签订合同的时间来计算他们的权利 - 很容易，然后您需要从他们已经休假的天数中获得他们的法定假期。再次，似乎很容易。

如果他们还有剩余的天数，您希望返回 true。如果已经使用了他们的津贴，或者过去了，返回false。

还是我错过了什么？

# f# - F# 选项...它们真的能防止空引用异常吗

> ID：11330186
> 
> 赞同：7
> 
> 时间：2012-07-04T13:35:07.540
> 
> 标签：f#

我正在阅读《Professional F# 2.0》这本书作者展示了以下代码

```
let a string : option = None
if a.IsNone then
    System.Console.WriteLine("a is none")
else
    System.Console.WriteLine("a is some");; 
```

然后说

*“这使得 Option 的使用大大优于 null 的使用，并且在消除运行时抛出的重要异常来源方面大有帮助”*

行。所以我写

```
System.Console.WriteLine(a.GetType());; 
```

我得到

System.NullReferenceException：对象引用未设置为对象的实例。在 System.Object.GetType() at .$FSI_0008.main@() 由于错误而停止

我就像'un!!!'

真的是怎么做的

```
if a.isSome then
    do bla bla

any different from

if a != null then
   do bla bla 
```

所以我看不到程序员是如何从 NullPointers 中拯救出来的

PS：NullPointerException 过去让我很伤心。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-04T13:58:07.267

F# 编译器不会完全阻止您`NullReferenceException`。当您使用 .NET 中定义的类型时，您仍然可以获得`null`价值，因为 F# 无法阻止这种情况。

但是，当您使用在 F# 中声明的类型时，编译器不允许创建`null`该类型的值，因此`NullReferenceException`在这种情况下它会避免。例如，以下代码无法编译：

```
type Person(name:string) = 
  member x.Name = name

// 'Person' is a type declared in F#, so the argument cannot be 'null' in safe code
let printName (person:Person) = 
  printfn "%s" person.Name

// Compiler error here - 'null' is not a valid value of 'Pereson' type
printName null 
```

当您`option<Person>`用作参数时，您必须明确检查`None`和`Some`案例。最好使用 来完成此操作`match`，它会检查您是否没有遗漏任何案例。例如：

```
let printName (person:option<Person>) = 
  match person with
  // You get a warning here, saying that you're not handling the 'None' case!
  | Some person -> printfn "%s" person.Name 
```

警告告诉您应该添加案例处理`None`。您仍然可以编译代码，但`NullReferenceException`如果您不忽略警告，则在使用 F# 类型时将无法获得。

另请参阅[这篇很棒的相关 StackOverflow 帖子](https://stackoverflow.com/questions/3989264/best-explanation-for-languages-without-null)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-04T19:09:35.193

为了补充 Tomas 的答案，`Option`类型的一个主要好处在于它支持的高阶函数，这给了你更多的简洁性和安全性。您可能会发现我关于该主题[的博客文章很有用。](http://missingfaktor.blogspot.in/2012/02/f-option-cheat-sheet.html)

# c# - 如何在单元测试中通过交互触发器引发动作？

> ID：11330190
> 
> 赞同：2
> 
> 时间：2012-07-04T13:35:28.790
> 
> 标签：c#, wpf, vs-unit-testing-framework

我遇到了一些小问题。我想用 Visual Studio 2010 为 c#/wpf/interactivty 项目编写一些单元测试。别忘了我是初学者，很抱歉；）

单元测试应该模拟文本框上的（虚拟）按键事件，结果应该引发一个动作。（动作结果：控制台输出 - 只是作为第一步检查）

我仍然修复了 2 个问题 -> 调度程序问题和presentationSource 错误。

unittest 仍然模拟 keyevent 并且 keyevent 到达了文本框，但问题是，为什么没有通过文本框上的 keydown 事件引发操作？

是线程问题吗？我有什么误解？

这是代码

单元测试
*结束时的单元测试你可以检查文本框 - 键盘工作*

```
[TestMethod]
public void simpleTest()
{
    var mockWindow = new MockWindow();

    //simple test to check if the virtualKeyboard works
    string CheckText = "Checktext";

    mockWindow.SendToUIThread(mockWindow.textbox, CheckText);

    mockWindow.SendToUIThread(mockWindow.textbox, "k");

    //needed to start the dispatcher
    DispatcherUtil.DoEvents();
} 
```

调度程序修复

```
public static class DispatcherUtil
    {
        [SecurityPermissionAttribute(SecurityAction.Demand, Flags = SecurityPermissionFlag.UnmanagedCode)]
        public static void DoEvents()
        {
            DispatcherFrame frame = new DispatcherFrame();
            Dispatcher.CurrentDispatcher.BeginInvoke(DispatcherPriority.Background, new DispatcherOperationCallback(ExitFrame), frame);
            Dispatcher.PushFrame(frame);
        }

        private static object ExitFrame(object frame)
        {
            ((DispatcherFrame)frame).Continue = false;
            return null;
        }
    } 
```

我的测试

```
 class TestAction : TriggerAction<UIElement>
    {
        protected override void Invoke(object parameter)
        {
            Console.WriteLine("testAction invoke");
        }
    } 
```

模拟窗口

```
public class MockWindow : Window
{
    public TextBox textbox { get; private set; }

    public MockWindow()
    {    
        //add a grid&textbox
        Grid grid = new Grid();
        textbox = new TextBox();

        this.Content = grid;
        grid.Children.Add(textbox);

        //create the testaction/triggerEvent & add them
        TestAction testAction = new TestAction();
        System.Windows.Interactivity.EventTrigger TestTrigger = new System.Windows.Interactivity.EventTrigger();
        TestTrigger.EventName = "KeyDown";
        TestTrigger.Actions.Add(testAction);
        TestTrigger.Attach(this.textbox);
    }

    //enter a keyboard press on an UIElement
    public void SendToUIThread(UIElement element, string text)
    {
        element.Dispatcher.BeginInvoke(new Action(() =>
        {
            SendKeys.Send(element, text);
        }), DispatcherPriority.Input);
    }
} 
```

从[codeplex sendkeys](http://wpfsendkeys.codeplex.com/)添加的 MockKeyboard + 用于 unittest 的 PresentationCore 修复（在 SendKeys 类中添加）

```
public class FixPresentationSource : PresentationSource
{
    protected override CompositionTarget GetCompositionTargetCore()
    {
        return null;
    }

    public override Visual RootVisual { get; set; }

    public override bool IsDisposed { get { return false; } }
} 
```

# java - 如何修复：类文件 com/sun/org/apache/xerces/internal/impl/xs/XMLSchemaValidator 中的未知常量标记 32

> ID：11330192
> 
> 赞同：1
> 
> 时间：2012-07-04T13:35:32.243
> 
> 标签：java, jvm

我今天早些时候遇到了以下异常：

```
Unknown constant tag 32 in class file com/sun/org/apache/xerces/internal/impl/xs/XMLSchemaValidator 
```

我没有做任何事情导致它。它只是凭空出现。

我提出了我自己的答案（见下文），但如果有人想进一步了解它，请添加您自己的答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T13:35:32.990

**重新安装你的JVM**

在最初认为这与依赖关系有关之后，我很快将注意力集中在我的 JDK 安装中的一个损坏的文件上。重新安装立即修复它。

# c# - 将图表控件渲染为 html 字符串以附加 div

> ID：11330198
> 
> 赞同：0
> 
> 时间：2012-07-04T13:35:58.367
> 
> 标签：c#, asp.net, charts, rendering

我正在开发一个 ASP.net/C# 应用程序，我需要执行以下操作：

我的问题是如何呈现在 C# 中动态创建的 Chart 控件（.net4 附带的控件）和 HTML 字符串？

我的意思是：

我在 C# 中动态创建图表

```
 //CREATE THE CHART
    Chart Chart1 = new Chart();

  //BIND THE DATA TO THE CHART
    Chart1.Series.Add(new Series());
    Chart1.Series[0].Points.DataBindXY(xName, yVal);

  //SET THE CHART TYPE TO BE PIE
    Chart1.Series[0].ChartType = System.Web.UI.DataVisualization.Charting.SeriesChartType.Pie;
    Chart1.Series[0]["PieLabelStyle"] = "Outside";
    Chart1.Series[0]["PieStartAngle"] = "-90";

  //ADD A PLACE HOLDER CHART AREA TO THE CHART
  //SET THE CHART AREA TO BE 3D
    Chart1.ChartAreas.Add(new ChartArea());
    Chart1.ChartAreas[0].Area3DStyle.Enable3D = true;

  //ADD A PLACE HOLDER LEGEND TO THE CHART
  //DISABLE THE LEGEND
    Chart1.Legends.Add(new Legend());
    Chart1.Legends[0].Enabled = false; 
```

然后我想将它渲染为 HTML 字符串并返回它。

我想要这个的原因是因为我使用 AJAX Jquery 来调用将图表作为 HTMl 字符串并将其附加到 'ChartDiv' div 元素的函数，以便将其显示为图表

```
 $.ajax({
            type: "POST",
            url: "Service/RPCWebService.asmx/GetHTMLRenderForCountry",
            dataType: "json",
            async: true,
            data: "{'CountryCode':'" + countryCode + "'}",
            contentType: "application/json; charset=utf-8",
            success: function (data) {
                $("#ChartDiv").append(data.d);

            },
            error: function (XMLHttpRequest, textStatus, errorThrown) {
                alert(errorThrown);
            }
        }); 
```

非常感谢您的帮助

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-07-04T14:02:29.823

看一下图表控件的 RenderControl 方法。下面是使用 RenderControl 将控件呈现为字符串的示例。 [http://blogs.x2line.com/al/articles/859.aspx](http://blogs.x2line.com/al/articles/859.aspx)

# netbeans-7 - Netbeans 还是 Oracle Solaris Studio 12.3？

> ID：11330200
> 
> 赞同：0
> 
> 时间：2012-07-04T13:36:04.923
> 
> 标签：netbeans-7, sun

我们有一个在 Solaris 上运行的 C++ 应用程序。目前还没有将其移植到其他平台的计划。

假设您必须在 Netbeans 7（或更高版本）和 Oracle Solaris Studio 12.3 作为 IDE 之间进行选择，您会选择哪一个？

以下是应满足的基本要求：

*   与 Subversion 源代码控制更好的 IDE 集成（从 IDE 中签入、签出、Diff 和合并文件）

*   更好的调试性能。

*   代码导航性能（我们拥有的一些单独的源文件是 1MB 或更多）

*   支持远程开发（远程结账/签入等）

*   能够通过插件扩展 IDE。

两个 IDE 都基于相同的代码库这一事实使选择变得困难。
Sun Studio 以一种很好的方式与 Solaris 紧密集成。另一方面，Netbeans 有更多的动力和频繁的错误修复/发布。

对此的任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T13:39:44.580

对于 C++ 开发以及您提到的所有版本控制和其他内容，我将添加第三个选项...... Eclipse。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T02:59:06.223

鉴于您的要求，这是一个艰难的决定。就个人而言，我会选择 Solaris Studio。Studio 为您提供了“盒子”中的所有编译器和调试工具，以及一些非常强大的性能分析工具。而且，在最新版本中，它已集成到 Solaris IPS 机制中，因此易于安装和升级。

# javascript - 请帮助我使用正则表达式。JavaScript

> ID：11330202
> 
> 赞同：-2
> 
> 时间：2012-07-04T13:36:18.587
> 
> 标签：javascript, regex

```
var str = "&lt;% some-text-here %&gt";

alert( str.match(/&lt;% (.*) %&gt/ig) ); // result in ["&lt;% main-menu-music %&gt"] 
```

我需要通过“some-text-here”来保持警惕。请帮帮我。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-04T13:42:40.877

为了获得捕获的组，您需要`RegExp.exec`：

```
var match = /&lt;% (.*) %&gt/ig.exec("&lt;% some-text-here %&gt")
//match[1] == "some-text-here" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T13:39:51.827

缺少关闭`)`

```
alert( str.match(/&lt;%(.*)%&gt/ig)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T13:42:07.260

匹配返回一个数组，我建议使用替换

```
alert(str.replace(/[%\s]*&[glt;%\s]+/ig, '')); 
```

# html - 如何在具有较高 z-index 的另一个元素的子元素前面获取具有较低 z-index 元素的子元素？

> ID：11330207
> 
> 赞同：5
> 
> 时间：2012-07-04T13:36:31.503
> 
> 标签：html, css, z-index

我有以下设置：

```
<div style="z-index: 10">
      <div>Whatever</div>
</div>

<div style="z-index: 9">
      <div><div>Haaaleluia</div></div>
</div> 
```

当然......我过度简化了设置，但这是主要思想。“whatever” div 与“Haaaaleluia” div 重叠。当然，因为第一个父级的 z-index 更大，所以“whatever”是可见的，而“haaaleluia”不是。

在不更改设置的情况下（并且要明确包括保留父 z-indexes），我怎样才能使“Haaaaleluia”处于顶部？

对于那些在这里要求打印的人......也感谢您的帮助： ![在此处输入图像描述](../Images/017d9c1bbac3dfef9e9b4d9b66b99114.png)

大坏地图是第二个div。

本教程是第一个 div。

带有订单的面板是地图的子级。我需要它在上面。如果我将整个地图设置在顶部，则教程将不再可见。如果我将地图保留在订单面板后面，则不再可见。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-04T13:59:25.787

简而言之：你不能。由于继承的 z-index 是相对于父元素的，因此不可能有一个`z-index`低于兄弟元素的父元素的子元素，并为该子元素赋予比父元素的兄弟元素更高的 z-index 值（请参阅[this question](https://stackoverflow.com/questions/3198947/can-i-override-z-index-inheritance-from-parent-element) for someone遇到同样的事情）。

但是，根据您的设置，您可以完全删除 z 索引，并让浏览器将您的顶部`div`放在下面的上方。然后，您可以只给孩子一个`z-index`价值。

Josh Comeau 有[一篇很棒的文章](https://www.joshwcomeau.com/css/stacking-contexts/)深入探讨了这个问题和各种解决方案/变通方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-04T14:10:09.827

在不更改位置 、`z-index`或重新排列任何元素的情况下，我能想到的唯一让`div`下方出现的方法是更改`visibility`​​ 、`display`或您想要看到`opacity`的重叠部分。`div`

也就是说，在`div`“Whatever”的父级上使用以下 CSS 样式之一：

```
visibility: hidden;
display: none;
opacity: 0; 
```

您基本上是要求在另一个具有更高 的元素上方显示一个元素`z-index`，这违背了拥有`z-index`. 如果你想控制元素如何重叠，真的应该用`z-index`. 我建议你重新考虑你的元素是如何组织的（也许将“Haaaleluia”移到`div`其父级之外并分配它自己的`z-index`）。否则，我可能会建议您考虑创建“Haaaleluia”的副本以显示在“Whatever”上方，这可能适合您的情况，也可能不适合您的情况。

**编辑：**查看您提供的图像，将订单框的父级更改为教程 div 的父级可能对您有用。这是一个使用 jQuery 的[演示](http://jsfiddle.net/4rCZb/1/)，可能有助于说明这一点 - 只需将悬停事件更改为启动教程的任何内容。另一种选择可能是将订单框克隆到下面的一个之上，但更高`z-index`（这样用户只能看到一个，但克隆与其他所有内容重叠）。这是假设您的地图 div 是绝对或相对定位的。希望有帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-04T15:05:12.447

不错的设计。

好的，所以我首先要说的是，正如其他人已经建议的那样，我相信解决分层问题的方法是将该框移到其父级（地图）之外。

但是你设置了一些限制，所以我会尽量少打破。我不知道如何在不破坏任何约束的情况下做到这一点。Z-index 是继承的（同样，其他人已经指出了这一点），所以你不能只用那个工具突破你父母的层。

因此，这是使用 javascript 获得相同效果的一种方法。它很丑陋，以后可能会让你更头疼，但它至少应该有效：

1.  找出要放在顶部的 div 的绝对位置。
2.  复制一份。
3.  隐藏原件（如果不透明，则可选）。
4.  将副本插入到所有内容之上。

如果您使用的是 jQuery，则可以使用该[`.offset()`](http://api.jquery.com/offset/)函数获取元素相对于文档的位置。之后就很简单了：

```
$(document).ready( function() {

    $("a[href='#overlay']").click( function() {
        // 1: get the position
        pos = $('.wrap').offset();
        // 2: make a copy
        halecopy = $('.bottom .wrap').clone();
        // 3: hide the original
        $('.bottom .wrap').css({opacity: 0});
        // 4: Insert new label on top of everything
        $('body').prepend(halecopy);
        // position the new label correctly
        halecopy.css({position:'absolute',
                      top: pos.top,
                      left: pos.left,
                      'z-index': 2});
        // show the "top" layer
        $('.top').fadeIn();
    });

    $("a[href='#hide']").click( function() {
        $('.top').fadeOut( function() {
            // remove the label copy
            halecopy.remove();
            // show the original again
            $('.bottom .wrap').css({opacity: 1});
        });
    });

});​ 
```

该脚本适用于这个标记：

```
<div class="top">
    <div class="label">
        <p>Whatever</p>
    </div>
</div>

<div class="bottom">
    <div class="wrap">
        <div class="label">
            <p>Haaaleluuuuia!</p>
        </div>
    </div>
</div>

<a href="#overlay">show</a>
<a href="#hide">hide</a>​ 
```

使用这些样式：

```
.top,
.bottom {
    position: absolute;
    top: 10%;
    left: 3%;
}

.top {
    z-index: 1;
    padding: 2%;
    background: rgba(0, 127, 127, 0.8);
    display:none;
}

.bottom {
    z-index: -1;
    padding: 3%;
    background: rgba(127, 127, 0, 0.8);
}

.label {
    color: #fff;
}

.wrap {
    outline: 1px dashed rgba(127, 0, 0, 0.8);
    background: rgba(127, 127, 127, 0.8);
}

.bottom .label {
    z-index: 10;
}
​ 
```

这是一个方便的[jsfiddle 演示](http://jsfiddle.net/kkbfT/32/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-04T13:40:07.730

为 div 添加颜色以演示分层：

```
<div style="position:absolute;background:blue;z-index: 10">
      <div>Whatever</div>
</div>

<div style="position:absolute;background:red;z-index: 11">
      <div><div>Haaaleluia</div></div>
</div> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-04T14:43:30.203

这只是一个可行的想法。

1.  使用 jquery 获取 z-index = 9 的 div。
2.  然后选择 z-index 为 9 的 div 的第一个孩子的第一个孩子。
3.  然后应用如下样式：

`$(element which you got).attr("style", "position: absolute; z-index: 12;")`

该样式将应用于小元素，并将在红色框上可见。

# jquery - 将未知数量的选中复选框的值添加到数组中

> ID：11330211
> 
> 赞同：1
> 
> 时间：2012-07-04T13:36:43.973
> 
> 标签：jquery, checkbox

如何从未知数量的复选框创建数组，使用 jquery 将值添加到数组中？然后发布数组？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T13:38:58.123

你可以试试这个：

```
function updateTextArea() {         
     var allVals = [];
     $('#c_b :checked').each(function() {
       allVals.push($(this).val());
     });
     $('#t').val(allVals)
  }
 $(function() {
   $('#c_b input').click(updateTextArea);
   updateTextArea();
 }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T13:50:20.163

```
var arr = $.map($('input[type="checkbox"]:checked'),function(checkbox){
                    return checkbox.value;
                }) 
```

# sql - 将产品的所有属性更改为“使用默认网站”的 SQL 查询

> ID：11330212
> 
> 赞同：0
> 
> 时间：2012-07-04T13:36:49.647
> 
> 标签：sql, magento

我们有很多产品在商店视图中更改了某些属性，以不使用默认网站设置。像这样：

![在此处输入图像描述](../Images/c2d6e17ab2dddb656ea2c0ba2562be0b.png)

我们现在需要一个脚本来将所有产品普遍更改为此设置：

![在此处输入图像描述](../Images/ff01ef44f09690319a74ff71dcae658e.png)

重要的是，所有属性都会发生这种情况，尤其是图片：

![在此处输入图像描述](../Images/5d33585434c07d63afc00274d5222075.png)

非常感谢任何帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T13:46:28.310

第一次备份。然后运行这个 SQL：

```
DELETE FROM catalog_product_entity_datetime WHERE store_id > 0;
DELETE FROM catalog_product_entity_decimal WHERE store_id > 0;
DELETE FROM catalog_product_entity_gallery WHERE store_id > 0;
DELETE FROM catalog_product_entity_int WHERE store_id > 0;
DELETE FROM catalog_product_entity_media_gallery_value WHERE store_id > 0;
DELETE FROM catalog_product_entity_text WHERE store_id > 0;
DELETE FROM catalog_product_entity_varchar WHERE store_id > 0; 
```

之后，重建所有产品相关的索引，然后清除块 html 缓存。

# android - 确定地点在路上

> ID：11330217
> 
> 赞同：0
> 
> 时间：2012-07-04T13:37:05.857
> 
> 标签：android, gps, coordinates

第一个问题是我正在尝试确定是否有东西在路上。这里的问题是如何知道是否有东西在路上。

**例如：**

我有这个代表交通信号灯的静态坐标。我在路上开车，我想看看那个特定的红绿灯是否在我的路上。

我的第二个问题是第一个问题的延伸。现在想象一下，道路上大约在同一地点有 2 个红绿灯，但有 1 个红绿灯指向相反的方向。我如何确定哪个交通信号灯在我的路上？当我来自特定方向时。

示例数据：

我在 50.906686,4.236858 点开着我的车在路上行驶。在点 50.908452,4.23674 有一个红绿灯。

我怎么知道我会通过那个红绿灯？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T14:48:23.560

这可能比您预期的要棘手；主要是因为您应该完善“您的方式”：

*   要么你有一个地理编码的路径，例如从某个提供商获取的路线。在这种情况下，您可以简单地计算从红绿灯到路线各段的距离（[距离...](http://en.wikipedia.org/wiki/Distance_from_a_point_to_a_line)）。如果距离低于某个阈值，那么您就可以开始了。
*   或者你没有。您可以做的最好的事情是从当前位置开始沿着您的方位近似直线路线。

至于“反方向”，则需要红绿灯的方位；计算其方位角与最近段之间的角度；如果它> 90°，您可能会丢弃它。

# zend-framework - Zend Sessions 未为 step3 存储

> ID：11330220
> 
> 赞同：0
> 
> 时间：2012-07-04T13:37:18.977
> 
> 标签：zend-framework, zend-session-namespace

我已经使用了zend会话如下..

```
$test = new Zend_Session_Namespace('test');

$test->test = "test text"; 
```

但是当我从一个步骤移动到另一个步骤时，它的工作正常并且回显值 Not on step3。即使我尝试直接使用 $_SESSION （因为我很绝望）。但我有同样的问题，即会话未存储。当我使用 mozilla 和 IE 时，网站似乎几乎崩溃了。不仅在我的 PC 中，而且我已经在多个系统中进行了测试。尝试清除 cookie，仅使用启用 cookie 的浏览器。

所以请建议我在上面做的可能是什么问题。即使我已经插入`zend_session::start();`

在此先感谢 Sanjeevk

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T07:25:45.410

您没有为您要完成的工作提供任何有用的代码，所以我猜。
我也遇到过类似的问题。
我的问题只是试图从分页器中保留页码，以便我可以对记录执行操作，然后返回到上一个操作中的同一页面。

我遇到的问题是控制器会在我每次调用操作（页面刷新）时覆盖会话数据，所以当我调用原始操作时页码会持续到其他操作，会话将被覆盖并且页面将重置为 1。

我的解决方案是从视图脚本中获取页码，然后稍后将其反馈给控制器。

```
//the view script
<?php $session = new Zend_Session_Namespace('page'); $page = $this->paginator->getCurrentPageNumber(); ?> 
```

所以现在当`$session->page`在我的控制器/动作中的任何地方调用时，数据仍然存在并且在视图实际呈现之前不会覆盖，这正是我所需要的。

您可能会遇到类似的情况。由于 PHP 和 Zend Framework 的操作方式，您可能会无意中过度写入会话数据。

如果这没有帮助，请提供更多信息，也许可以找到答案。

希望这能提供一些帮助或至少是提示。

# scons - 在 Keil 编译器/链接器中使用 scons

> ID：11330224
> 
> 赞同：0
> 
> 时间：2012-07-04T13:37:35.003
> 
> 标签：scons, keil

我正在尝试使用带有 scons 的 Keil C51 编译器作为构建系统。

我遇到的最后一个问题是如何以`$SOURCES`逗号分隔的方式输出到链接器。默认使用空格作为分隔符。

SConstruct的相关部分是

```
path = ['C:\Keil\C51\BIN']
env = Environment(ENV = {'PATH' : path})

#Compiler settings
env['CC']        = 'c51.exe' 
env['CCCOM']     = '$CC $SOURCES $_CPPINCFLAGS $CFLAGS  $_CCCOMCOM ' #-o $TARGET 
env['INCPREFIX']  = 'INCDIR('
env['INCSUFFIX']  = ')'

# Linker settings
env.Replace(LINK='BL51.exe')
env['LINKCOM']     = '$LINK $SOURCES TO $TARGET $LINKFLAGS $__RPATH $_LIBDIRFLAGS $_LIBFLAGS' 
```

有了这个，我得到：

> BL51.exe driver.obj flash.obj 初始化.obj power.obj TO Outfile.omf

我想要的是：

> BL51.exe driver.obj,flash.obj,initialization.obj,power.obj TO Outfile.omf

[$SOURCES](http://www.scons.org/doc/1.2.0/HTML/scons-user/a4774.html#cv-SOURCES)是一个构造变量，我找不到如何更改它打印到命令行的方式。

任何人？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T12:33:42.553

我通过使用解决了这个问题：

```
 env['LINKCOM']     = '$LINK ",".join( $SOURCES ) TO $TARGET $LINKFLAGS $__RPATH $_LIBDIRFLAGS $_LIBFLAGS' 
```

# java - java - 如何在java中的xml文件中写入特殊字符（interpunct）？

> ID：11330226
> 
> 赞同：0
> 
> 时间：2012-07-04T13:37:45.713
> 
> 标签：java, xml, utf-8

我在 JAVA 中使用 UTF-8 编写 xml 文件时遇到问题。问题：我有一个文件名，其中包含一个 interpunct(middot)(·)。当我尝试在 xml 标记中写入文件名时，使用 java 代码我得到一些垃圾号码，如文件名中的  而不是·

OutputStreamWriter osw =new OutputStreamWriter(file_output_stream,"UTF8");

以上是我用来编写xmlfile的java代码。谁能告诉我为什么要理解和解决问题？提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T13:44:25.733

Java 源默认为 UTF-16。如果您的角色不在其中，请使用转义：

```
String a = "\u00b7"; 
```

或者告诉您的编译器使用 UTF-8 并简单地将其按原样写入代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T13:41:53.953

该字符是 ASCII 183（十进制），因此您需要将字符转义为`&#183;`. 这是一个演示：如果我输入**`"&#183;"`**这个答案，我得到**“·”**
浏览器正在打印你的字符，因为这个网页是 XML。

有一些实用方法可以为您执行此操作，例如[apache commons-lang](http://commons.apache.org/lang/)库的[`StringEscapeUtils.escapeXml()`](http://commons.apache.org/lang/api-2.4/org/apache/commons/lang/StringEscapeUtils.html#escapeXml%28java.lang.String%29)方法，该方法将正确且安全地转义整个输入。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T13:52:09.530

一般来说，在任何地方都使用 UTF-8 是个好主意。

**编辑器**必须知道源代码是 UTF-8。您可以使用可以处理多种编码的免费程序员编辑器 JEdit。

**javac**编译器必须知道 java 源代码是 UTF-8 格式。在 Java 中，您可以使用@OndraŽižka 的解决方案。

这会在您的 IDE 中进行两个设置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-04T14:05:12.583

不要尝试手动创建 XML。为此目的使用图书馆。您只是触及了一堆会破坏手工解决方案的特殊情况的表面。

使用核心 Java 类的一种方法是创建一个 DOM，然后使用写入到`StreamResult`. （如果您的文档很大，您可以通过驱动 SAX 事件处理程序来执行类似的操作。）

有许多第三方库可以帮助您非常轻松地做同样的事情。

# matlab - 组合、子集、MATLAB

> ID：11330227
> 
> 赞同：0
> 
> 时间：2012-07-04T13:37:47.170
> 
> 标签：matlab, combinations

我`combnk`用来生成组合列表。但是，结果形状不是我需要的数据。我想要例如`combnk(1:3,2)`：

```
1 1 0  
0 1 1
1 0 1 
```

不是

```
1 2
1 3
2 3 
```

我该怎么做？我怎样才能改变`combnk`以最佳方式给出结果？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T14:45:44.333

另一种解决方案：

```
c = combnk(1:3,2);
r = repmat(1:size(c,1), [1 size(c,2)]);
output = full(sparse(r,c(:),1)) 
```

结果：

```
output =
     1     1     0
     1     0     1
     0     1     1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T14:18:45.123

你不是说你想要

```
1 1 0 
1 0 1 
0 1 1 
```

代替

```
1 2
1 3
2 3 
```

所以每一行都是原始向量的逻辑选择向量`v`？

您可以通过以下方式获得此信息：

```
v = 1:3;
k = 2;

tmp = combnk(v,k);
M = size(tmp,1);

output = false(M,numel(v));
output(sub2ind(size(output),repmat((1:M)',1,k),tmp))=true; 
```

结果：

```
output =

     1     1     0
     1     0     1
     0     1     1 
```

# r - 日期转换在某些月份给出 NA

> ID：11330229
> 
> 赞同：0
> 
> 时间：2012-07-04T13:38:00.847
> 
> 标签：r

我想在 R 中解析一些 Apache-Logfile，但日期转换在某些月份不起作用。例子：

```
> as.Date(c("11/Jan/2012", "11/Mar/2012", "11/Apr/2012", "11/May/2012"), "%d/%b/%Y")
[1] "2012-01-11" NA          
[3] "2012-04-11" NA 
```

为什么 Jan 和 Apr 有效而 Mar 和 May 无效？

亲切的问候，阿恩

# javascript - Twitter API 和节点

> ID：11330239
> 
> 赞同：2
> 
> 时间：2012-07-04T13:38:46.757
> 
> 标签：javascript, node.js, asynchronous, twitter

[我正在尝试使用https://github.com/jdub/node-twitter](https://github.com/jdub/node-twitter)从 Twitter 检索我的最后一条推文

我想声明一个变量，在函数内更改该变量，然后在该函数外再次使用它。这可能吗？

我已经通过身份验证，如果我这样做，可以看到我的最后一条推文：

```
var tweet;

twit.get('http://api.twitter.com/1/statuses/user_timeline.json', function(data) {
    tweet = data[0].text;
    console.log(tweet);
}); 
```

但是我想将我的代码分开并执行以下操作：

```
var tweet;

twit.get('http://api.twitter.com/1/statuses/user_timeline.json', function(data) {
    tweet = data[0].text;
});

console.log(tweet); 
```

推文仍未定义。

请教育我:-)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-04T13:42:43.477

您希望能够立即 console.log，但 node.js 不是同步的，这就是它如此强大和快速的原因。您必须习惯使用 node.js 进行异步编码模式。获取请求是异步的。在回调发生之前不会分配推文。

Console.log 在异步请求发出后立即执行。

尝试：（编辑-我建议这样做，然后编辑问题以包含此代码）

```
twit.get('http://api.twitter.com/1/statuses/user_timeline.json', function(data) {
    tweet = data[0].text;
    console.log(tweet);    // executed after call returns
});

// executes immediately after request is sent
console.log("request sent"); 
```

请注意，twit.get 调用的第二个参数是一个匿名函数，它将在完成异步请求后执行。

它的输出应该是“请求发送”，然后是推文结果。

# php - CPanel 中 PHP Cron 作业的正确语法

> ID：11330245
> 
> 赞同：1
> 
> 时间：2012-07-04T13:39:13.887
> 
> 标签：php, email, cron

我想用 php 发送一封简单的电子邮件，它可以由 CPanel 中的 CRON 作业触发。

```
php /home/username/public_html/test/email.php 
```

我正在使用上面的脚本来运行脚本并向我发送电子邮件但没有运气......

```
<?php
$to = "email@email.com";
$subject = "I'm CRON from CPanel";
$message = "Just wanna say that your cron is working";
$from = "someonelse@example.com";
$headers = "From:" . $from;
mail($to,$subject,$message,$headers);
echo "Mail Sent.";
?> 
```

我也在使用上面的 PHP 脚本。

为什么它没有发送电子邮件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T14:18:16.760

试试这个：- php -f /home/username/public_html/test/email.php 还要在 cPanel 中检查您的主目录“/home/username”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T14:53:52.873

这对我有用：

```
php /home/username/folder/script.php >/dev/null 2>&1 
```

至于您的问题“为什么它不发送电子邮件？”

考虑到它被发送到 email@email.com，您将不知道它是否已发送或是否未发送。

# javascript - 使用正则表达式删除子字符串

> ID：11330246
> 
> 赞同：0
> 
> 时间：2012-07-04T13:39:16.217
> 
> 标签：javascript, regex

我需要从这个字符串中删除子字符串（当然，原来的更长）

> 案例“米”：xy=1；//米方断点；案例“分米平方”：xy=1E2；//分米方格; 案例“cm_square”：xy=1E4；//平方厘米; 案例“毫米平方”：xy=1E6；

文本在一行中，我需要这样的输出：

```
case 'meter': xy=1; break; case 'decimeter_square': xy=1E2; break;
case 'centimeter_square': xy=1E4; break; case 'milimeter_square':
xy=1E6; 
```

所以我需要删除**'//'**之后和**'break'之前的所有内容**

谢谢大家的建议

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T13:41:31.660

将正则表达式模式替换`//.*?break;`为`//break;`

# selenium - 通过测试用例运行时，Selenium IDE 无法从链接打开新窗口

> ID：11330248
> 
> 赞同：0
> 
> 时间：2012-07-04T13:39:22.553
> 
> 标签：selenium, hyperlink, window, selenium-ide

所以我正在为一个网页编写测试，其中一个测试包括点击一个链接，这会打开一个新窗口，在那个窗口中做一些断言，然后跳回去。

要打开链接，我使用的是[此处](http://nickbartlett.com/wordpress/selenium-ide-how-to-follow-links-in-opening-a-new-window/)描述的技术。

奇怪的是，当我手动完成这些步骤时（只需一个接一个地按所有步骤），它工作正常。但是当我尝试运行整个测试时，它要么什么都不做（没有打开窗口），要么点击另一个按钮（而不是链接）。

当我手动执行这些步骤而不是 Selenium IDE 为我运行它们时，它工作的原因是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T13:55:19.580

要打开链接，您可以使用

```
click  |  link=link name
selectWindow  |  windowname 
```

然后对该窗口执行操作

# javascript - 使用 jquery 获取 div 中的下一个元素

> ID：11330254
> 
> 赞同：0
> 
> 时间：2012-07-04T13:39:44.063
> 
> 标签：javascript, jquery

假设我们有这个 html 代码

```
<div id="test">
     <h2>Title</h2>
     <p>lorem ipsum</p>
</div> 
```

而这个 jQuery

```
$("#test h2").text("Changed Title"); 
```

`<p>`现在，在不上一级的情况下，继续向下并更改其文本的正确方法是什么。Like`next()`只会寻找下一个 h2，但是是否有一些东西可以让兄弟姐妹独立于元素类型。可能是什么`next("p");`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T13:41:42.173

您正在寻找的命令是`siblings("p")`

这是您的示例，已更新：

```
$("#test h2").text("Changed Title").siblings('p').text('test'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-04T13:42:15.653

`next`选择下一个元素：默认情况下它不仅选择相同类型的元素。

```
$('#test h2').next();      // selects the p
$('#test h2').next('p');   // selects the p
$('#test h2').next('h2');  // does not select the p 
```

除非您提供选择器，`next` *否则将*选择下一个兄弟元素。因此，您可以这样做：

```
$('#test h2').text('Changed title').next().text('Changed text'); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-04T13:43:11.533

`.next( 'p' )`会成功的：

```
$("#test h2").text("Changed Title")
             .next( 'p' )
             .text( 'Another change' ); 
```

来自[jQuery 文档](http://api.jquery.com/next/)：

> 获取匹配元素集中每个元素的紧随其后的兄弟。如果提供了选择器，则仅当它与该选择器匹配时，它才会检索下一个兄弟。

请参阅[此处的示例小提琴](http://jsfiddle.net/GmuxG/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-04T13:41:02.097

确切地说，您可以使用以下`.next('p')`方法来做到这一点：

```
$("#test h2").next('p').text("..."); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-04T13:41:12.987

`.next('p')`确实会起作用。把它链在最后。像这样：

`$('#test h2').text("Changed Title").next('p').text('I changed too');`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-04T13:42:04.703

```
$("#test h2").text("Changed Title").siblings().text(""); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-04T13:43:07.960

就像你建议的那样，

```
$("#test").next("p").text('yada'); 
```

甚至更好：

```
$("#test h2").text("Changed Title").next("p").text('yada'); 
```

# php - URL重写和htpasswd

> ID：11330255
> 
> 赞同：0
> 
> 时间：2012-07-04T13:39:44.057
> 
> 标签：php, .htaccess, url-rewriting, .htpasswd

我在我的网站上使用 URL 重写，我想通过 .htpasswd 文件将身份验证添加到我的目录之一。

我的网站是这样构建的

```
/home/website/
/home/website/protected/
/home/website/protected/.htaccess
/home/website/protected/.htpasswd
/home/website/protected/admin.php
/home/website/.htaccess
/home/website/index.php
/home/website/index_protected.php 
```

在 /home/website/ 目录我有一个 .htaccess 文件：

```
RewriteRule ^directory([0-9]+)/protected/([a-z0-9-_]+).php   /home/website/protected/admin.php?d=$1&p=$2 [QSA] 
```

使用 url 之类的

```
http//website/directory1/protected/test.php 
```

你会打电话给

```
/home/website/1/protected/admin.php?d=1&p=test 
```

在来自 /protected/ 目录的 .htaccess 上，我得到：

```
AuthName "Page d'administration protégée"
AuthType Basic
AuthUserFile "/home/website/protected/.htpasswd"
Require valid-user 
```

在 /protected/ 目录中的 .htpasswd 上，我得到：

```
admin:crypted_password 
```

但我的问题是，当我打电话时

```
http//website/directory1/protected/test.php 
```

我从来没有得到身份验证窗口，有什么办法解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T13:45:39.703

您可以尝试将带有基本身份验证指令的 .htaccess 文件放置到受保护的目录中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T13:52:28.533

这主要发生在服务器不使用 .htaccess 文件时。检查是否允许在 /home/website/protected/ 中使用该文件，而不仅仅是 /home/website/。

# iphone - 使用 CSS 确定 iPhone Safari 是否处于垂直视口模式

> ID：11330263
> 
> 赞同：0
> 
> 时间：2012-07-04T13:40:20.007
> 
> 标签：iphone, css, mobile-safari

我一直在使用

```
@media screen and (max-width: 480px) 
```

但是，要确定用于查看的设备是否是 iPhone，这条规则似乎适用于垂直和水平视口模式。

如何确定视口是否确实是垂直的（即较小宽度的视口）？我试过了

```
@media screen and (max-width: 320px) 
```

但它似乎根本没有注册。

此外，位于`(max-width: 480px)`限制下的所有样式也适用于垂直模式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T13:43:33.577

您可以使用 orintation 媒体查询：

```
/* Portrait */
@media screen and (orientation:portrait) {
    /* Portrait styles */
}
/* Landscape */
@media screen and (orientation:landscape) {
    /* Landscape styles */
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T13:44:31.190

我认为媒体查询有一个“方向”选项；）

[http://www.1stwebdesigner.com/css/how-to-use-css3-orientation-media-queries/](http://www.1stwebdesigner.com/css/how-to-use-css3-orientation-media-queries/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T13:46:42.397

我知道你想用 CSS 来做这件事，但 CSS 真的不是检测 iPhone 的方法……你应该使用 JavaScript。

这将帮助您检测 JavaScript 中的方向：

```
function detectOrientation () {  
if ( orientation == 0 ) {  
 document.className = 'portrait';
}  
else if ( orientation == 90 ) {  
 document.className = 'landscape';  
}  
else if ( orientation == -90 ) {  
 document.className = 'landscape'; 
}  
else if ( orientation == 180 ) {  
 document.className = 'portrait'; 
}
} 
```

# java - 绘制动态图

> ID：11330264
> 
> 赞同：1
> 
> 时间：2012-07-04T13:40:20.867
> 
> 标签：java, graph, jfreechart

是否可以使用 java 创建一个动态图，当它从外部接收值时自动更新？

我会创建一个应用程序来自动检查服务器的统计信息（数据输入、数据输出等），当这些值发生变化时动态地在图形上绘制这些值。

我找到了`JFreeChart`，但我不知道它是否能制造这些东西

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T13:47:08.787

转到[JFreeChart 演示页面](http://www.jfree.org/jfreechart/samples.html)，下载 jnlp 并通过 Java Web start 启动它。有很多带有源代码的 JFreeChart 示例。在示例目录树中，在“杂项 -> 动态图表”下，您会找到您需要的内容

# java - 如何在 Java 中平滑 JFrame 的滚动

> ID：11330268
> 
> 赞同：3
> 
> 时间：2012-07-04T13:40:33.590
> 
> 标签：java, swing, user-interface, jscrollpane, graphics2d

我的 Java 应用程序中有一个 JFrame，其中包含`JPanel`我在运行时创建的一些绘图对象。问题是在滚动`JFrame`大数字时，滚动速度变慢并且滚动条移动不顺畅。请注意我正在使用`Graphics 2D`对象并执行`repaint`滚动操作。

有什么方法可以平滑`JFrame`.

这是代码的一部分

```
public class DiagramPanel implements MouseListener{

    int click=0;
    Point p1;
    Point p2;
    private Dimension panelDimension;
    .... // variables

    public void go() {
        p1 = new Point();
        p2 = new Point();

        JFrame f = new JFrame();
        f.setVisible(true);
        f.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
        f.setSize(1200,500);
        panelx = new DiaPanel();
        panelx.setOpaque(true);
        panelx.setBackground(Color.white);
        panelx.setAutoscrolls(true);
        panelx.addMouseListener(this);

        JScrollPane scrollPane = new JScrollPane();

        // scrollPane.add(panelx);

        ClassRectangle tempRect = null;
        for (ClassRectangle rect : this.classRectangles) {
            tempRect = rect;
        }

        Rectangle rect = new Rectangle();
        rect.setBounds(tempRect.getW() - 100, 0, 1000,
                tempLife.getEndpointY() * 500);

        panelDimension = new Dimension(0,0);
        for (ClassRectangle rectx : classRectangles){
            panelDimension.width=rectx.getW()+300;
        }
        for (LifeLine life : lifeLines) {
            panelDimension.height=life.getEndpointY()+300;
        }

        scrollPane.setViewportView(panelx);
        panelx.computeVisibleRect(rect);
        JScrollPane scrollPane1 = new JScrollPane(panelx);

        panelx.setPreferredSize(panelDimension);
        panelx.repaint();
        panelx.revalidate();
        p1.x=0;
        p1.y=0;
        p2.y=panelDimension.height;
        p2.x=panelDimension.width;
        f.add( scrollPane1);
        scrollPane.revalidate();
        f.setBackground(Color.white);
    }

    public DiagramPanel(ArrayList<Rectangle> classRectangles,
            ArrayList<Pair> pairs, ArrayList<Line> lines,
            ArrayList<Life> meth) {

            // constructing obj of DrawingPanel Here
    }

    public class SeqDiaPanel extends JPanel {
        /**
         * 
         */

        private static final long serialVersionUID = 1L;

        public void paintComponent(Graphics g) {
            super.paintComponent(g);
            Graphics2D g2d2 = (Graphics2D) g;
            g2d2.setColor(Color.orange);

            //grid
            for (int i = 0; i < panelDimension.height; i++) {
                g2d2.drawLine(0, 0 + i * 5, panelDimension.width+1000, 0 + i * 5);

            }

            for (int i = 0; i < panelDimension.width; i++) {
                g2d2.drawLine(0 + i * 5, 0, 0 + i *5,panelDimension.height+300);
            }

            g2d2.setColor(Color.black);

            // objects 
            .......... some objects here

            }
            }
            // draw Lines

            Stroke drawingStroke = new BasicStroke(2, BasicStroke.CAP_BUTT,
                    BasicStroke.JOIN_BEVEL, 0, new float[] { 5 }, 0);
            // Stroke drawingStroke = new BasicStroke();
            Graphics2D g2d = (Graphics2D) g;
            g2d.setStroke(drawingStroke);
            for (Line life : lines) {
                g2d.drawLine(life.getStartpointX(), life.getStartpointY(),
                        life.getEndpointX(), life.getEndpointY());
                panelDimension.height=life.getEndpointY()+300;
            }

            // draw methodLfe
            for (Object2 ml1 : Obj2) {
                g2d2.fill3DRect(ml1.StartX(), ml1.getMethodStartY(),
                        ml1.getBreadth(), ml1.getEndX(),true);
            }

        }

    }

    // tobeused

    public int calculateWidth(String name){
        Font font = new Font("Serif", Font.BOLD, 12);
         FontMetrics metrics = new FontMetrics(font){

            /**
             * 
             */
            private static final long serialVersionUID = 1L;};
        int tempInt2=SwingUtilities.computeStringWidth( metrics, name);
        tempInt2=tempInt2+10;
        return tempInt2;
    }

    /*public class MouseClick implements MouseListener{
        Point p =  new Point(0,0);
        @Override
        public void mouseClicked(MouseEvent evnt) {

            p.x=evnt.getX();
            p.y=evnt.getY();
            System.out.println("MouseClicked @"+p.x+":"+p.y);

        }

        @Override
        public void mouseEntered(MouseEvent arg0) {
            // TODO Auto-generated method stub

        }

        @Override
        public void mouseExited(MouseEvent arg0) {
            // TODO Auto-generated method stub

        }

        @Override
        public void mousePressed(MouseEvent arg0) {
            // TODO Auto-generated method stub

        }

        @Override
        public void mouseReleased(MouseEvent arg0) {
            // TODO Auto-generated method stub

        }

    }*/

    @Override
    public void mouseClicked(MouseEvent evnt) {
        click++;
        if(click==1){
        //Point p= new Point();
        p1.x=evnt.getX();
        p1.y=evnt.getY();
    //  System.out.println("MouseClicked1 @"+p1.x+":"+p1.y);
        }

        if(click==2){
            p2.x=evnt.getX();
            p2.y=evnt.getY();
            //System.out.println("MouseClicked2 @"+p2.x+":"+p2.y);
            click=0;
            if(p1.x<p2.x&&p1.y<p2.y){
            panelx.repaint();
            }
            else{

            }

        }/*else{
            p1.x=0;
            p1.y=0;
            p2.x=panelDimension.width+500;
            p2.y=panelDimension.height+700;
        }*/
    }

    @Override
    public void mouseEntered(MouseEvent arg0) {
        // TODO Auto-generated method stub

    }

    @Override
    public void mouseExited(MouseEvent arg0) {
        // TODO Auto-generated method stub

    }

    @Override
    public void mousePressed(MouseEvent arg0) {
        // TODO Auto-generated method stub

    }

    @Override
    public void mouseReleased(MouseEvent arg0) {
        // TODO Auto-generated method stub

    }
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-04T13:51:42.323

这个想法也许可以帮助你

```
import java.awt.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.util.Random;
import javax.swing.*;

public class TilePainter extends JPanel implements Scrollable {

    private static final long serialVersionUID = 1L;

    public static void main(String[] args) {
        EventQueue.invokeLater(new Runnable() {

            @Override
            public void run() {
                JFrame frame = new JFrame("Tiles");
                frame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
                frame.getContentPane().add(new JScrollPane(new TilePainter()));
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }
    private final int TILE_SIZE = 50;
    private final int TILE_COUNT = 100;
    private final int visibleTiles = 10;
    private final boolean[][] loaded;
    private final boolean[][] loading;
    private final Random random;

    public TilePainter() {
        setPreferredSize(new Dimension(TILE_SIZE * TILE_COUNT, TILE_SIZE * TILE_COUNT));
        loaded = new boolean[TILE_COUNT][TILE_COUNT];
        loading = new boolean[TILE_COUNT][TILE_COUNT];
        random = new Random();
    }

    public boolean getTile(final int x, final int y) {
        boolean canPaint = loaded[x][y];
        if (!canPaint && !loading[x][y]) {
            loading[x][y] = true;
            Timer timer = new Timer(random.nextInt(500),
                    new ActionListener() {

                        @Override
                        public void actionPerformed(ActionEvent e) {
                            loaded[x][y] = true;
                            repaint(x * TILE_SIZE, y * TILE_SIZE, TILE_SIZE, TILE_SIZE);
                        }
                    });
            timer.setRepeats(false);
            timer.start();
        }
        return canPaint;
    }

    @Override
    protected void paintComponent(Graphics g) {
        super.paintComponent(g);
        Rectangle clip = g.getClipBounds();
        int startX = clip.x - (clip.x % TILE_SIZE);
        int startY = clip.y - (clip.y % TILE_SIZE);
        for (int x = startX; x < clip.x + clip.width; x += TILE_SIZE) {
            for (int y = startY; y < clip.y + clip.height; y += TILE_SIZE) {
                if (getTile(x / TILE_SIZE, y / TILE_SIZE)) {
                    g.setColor(Color.GREEN);
                } else {
                    g.setColor(Color.RED);
                }
                g.fillRect(x, y, TILE_SIZE - 1, TILE_SIZE - 1);
            }
        }
    }

    @Override
    public Dimension getPreferredScrollableViewportSize() {
        return new Dimension(visibleTiles * TILE_SIZE, visibleTiles * TILE_SIZE);
    }

    @Override
    public int getScrollableBlockIncrement(Rectangle visibleRect, int orientation, int direction) {
        return TILE_SIZE * Math.max(1, visibleTiles - 1);
    }

    @Override
    public boolean getScrollableTracksViewportHeight() {
        return false;
    }

    @Override
    public boolean getScrollableTracksViewportWidth() {
        return false;
    }

    @Override
    public int getScrollableUnitIncrement(Rectangle visibleRect, int orientation, int direction) {
        return TILE_SIZE;
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-04T14:08:45.180

为什么不将`Graphics2D`绘图放在（大）`BufferedImage`中并将其显示在滚动窗格的标签中？像这样的东西（动画，5000x5000px）：

```
import java.awt.*;
import java.awt.event.*;
import java.awt.image.BufferedImage;
import java.util.Random;
import javax.swing.*;

public class BigScrollImage {

    BigScrollImage() {
        final int x = 5000;
        final int y = 5000;
        final BufferedImage bi = new BufferedImage(x,y,BufferedImage.TYPE_INT_RGB);
        Graphics2D g1 = bi.createGraphics();

        g1.setColor(Color.BLACK);
        g1.fillRect(0, 0, x, y);

        g1.dispose();

        final JLabel label = new JLabel(new ImageIcon(bi));

        ActionListener listener = new ActionListener() {
            Random rand = new Random();
            @Override
            public void actionPerformed(ActionEvent ae) {
                Graphics2D g2 = bi.createGraphics();
                int x1 = rand.nextInt(x);
                int x2 = rand.nextInt(x);
                int y1 = rand.nextInt(y);
                int y2 = rand.nextInt(y);
                int r = rand.nextInt(255);
                int g = rand.nextInt(255);
                int b = rand.nextInt(255);
                g2.setColor(new Color(r,g,b));
                g2.drawLine(x1,y1,x2,y2);

                g2.dispose();
                label.repaint();
            }
        };

        Timer t = new Timer(5,listener);

        JScrollPane scroll = new JScrollPane(label);
        JFrame f = new JFrame("Big Scroll");
        f.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);

        f.add(scroll);
        f.pack();
        f.setSize(800, 600);

        f.setLocationByPlatform(true);
        f.setVisible(true);
        t.start();
    }
    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable(){
            @Override
            public void run() {
                new BigScrollImage();
            }
        });
    }
} 
```

它尝试每秒绘制 20000 条线，并且似乎在这里平滑滚动。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-20T00:01:35.127

### 第1部分

感谢他和 Gilbert Le Blanc，我对 mKorbel 的回答做了一些小改动：

```
import java.awt.Color;
import java.awt.Dimension;
import java.awt.Graphics;
import java.awt.LayoutManager;
import java.awt.Rectangle;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.image.BufferedImage;
import java.lang.ref.WeakReference;
import java.util.Random;
import javax.swing.Scrollable;
import javax.swing.SwingConstants;
import javax.swing.Timer;

/**
 *
 * @author leBenj
 */
public class GJPanelBufferedImageTileAdapter extends GJPanelBufferedImageAdapter implements Scrollable
{
    protected BufferedImage _image = null;

    protected GIPanelListener _parent = null;

    private int TILE_SIZE_W = -1;

    private int TILE_SIZE_H = -1;

    private int TILE_COUNT_W = 32;

    private int TILE_COUNT_H = 32;

    private int visibleTiles = 10;

    private boolean[][] loading;

    private WeakReference<BufferedImage>[][] subs;

    private final Random random;

    public GJPanelBufferedImageTileAdapter( final GIPanelListener parent , LayoutManager layout , boolean isDoubleBuffered )
    {
        super( parent , layout , isDoubleBuffered );
        this._parent = parent;
        resetTiling();
        random = new Random();
    }

    public void resetTiling()
    {
        loading = new boolean[TILE_COUNT_W][TILE_COUNT_H];
        subs = new WeakReference[TILE_COUNT_W][TILE_COUNT_H];
    }

    private BufferedImage getTile( int x , int y )
    {
        BufferedImage retour = null;
        if( x < TILE_COUNT_W )
        {
            if( y < TILE_COUNT_H )
            {
                if( subs[x][y] != null )
                {
                    retour = subs[x][y].get();
                }
            }
        }
        return retour;
    }

    private void setTile( BufferedImage sub , int x , int y )
    {
        subs[x][y] = new WeakReference<BufferedImage>( sub );
    }

    private boolean loadTile( final int x , final int y )
    {
        boolean canPaint = ( getTile( x , y ) != null );
        if( x < TILE_COUNT_W )
        {
            if( y < TILE_COUNT_H )
            {
                if( !canPaint && !loading[x][y] )
                {
                    Timer timer = new Timer( random.nextInt( 500 ) , new ActionListener()
                    {
                        @Override
                        public void actionPerformed( ActionEvent e )
                        {
                            BufferedImage sub = _image.getSubimage( x * TILE_SIZE_W , y * TILE_SIZE_H , TILE_SIZE_W , TILE_SIZE_H );
                            setTile( sub , x , y );
                            repaint( x * TILE_SIZE_W , y * TILE_SIZE_H , TILE_SIZE_W , TILE_SIZE_H );
                        }
                    } );
                    timer.setRepeats( false );
                    timer.start();
                }
            }
        }
        return canPaint;
        }

    // using paint(g) instead of paintComponent(g) to start drawing as soon as the panel is ready
    @Override
    protected void paint( Graphics g )
    {
        super.paint( g );
        Rectangle clip = g.getClipBounds();
        int startX = clip.x - ( clip.x % TILE_SIZE_W );
        int startY = clip.y - ( clip.y % TILE_SIZE_H );
        int endX = clip.x + clip.width /*- TILE_SIZE_W*/;
        int endY = clip.y + clip.height /*- TILE_SIZE_H*/;
        for( int x = startX ; x < endX ; x += TILE_SIZE_W )
        {
            for( int y = startY ; y < endY ; y += TILE_SIZE_H )
            {
                if( loadTile( x / TILE_SIZE_W , y / TILE_SIZE_H ) )
                {
                    BufferedImage tile = getTile( x / TILE_SIZE_W , y / TILE_SIZE_H );
                    if( tile != null )
                    {
                        g.drawImage( subs[x / TILE_SIZE_W][y / TILE_SIZE_H].get() , x , y , this );
                    }
                }
                else
                {
                    g.setColor( Color.RED );
                    g.fillRect( x , y , TILE_SIZE_W - 1 , TILE_SIZE_H - 1 );
                }
            }
        }
            g.dispose(); // Without this, the original view area will never be painted
    }

    /**
     * @param image the _image to set
     */
    public void setImage( BufferedImage image )
    {
        this._image = image;
        TILE_SIZE_W = _image.getWidth() / TILE_COUNT_W;
        TILE_SIZE_H = _image.getHeight() / TILE_COUNT_H;
        setPreferredSize( new Dimension( TILE_SIZE_W * TILE_COUNT_W , TILE_SIZE_H * TILE_COUNT_H ) );
    }

    @Override
    public Dimension getPreferredScrollableViewportSize()
    {
        return new Dimension( visibleTiles * TILE_SIZE_W , visibleTiles * TILE_SIZE_H );
    }

    @Override
    public int getScrollableBlockIncrement( Rectangle visibleRect , int orientation , int direction )
    {
        if( orientation == SwingConstants.HORIZONTAL )
        {
            return TILE_SIZE_W * Math.max( 1 , visibleTiles - 1 );
        }
        else
        {
            return TILE_SIZE_H * Math.max( 1 , visibleTiles - 1 );
        }
    }

    @Override
    public boolean getScrollableTracksViewportHeight()
    {
        return false;
    }

    @Override
    public boolean getScrollableTracksViewportWidth()
    {
        return false;
    }

    @Override
    public int getScrollableUnitIncrement( Rectangle visibleRect , int orientation , int direction )
    {
        if( orientation == SwingConstants.HORIZONTAL )
        {
            return TILE_SIZE_W;
        }
        else
        {
            return TILE_SIZE_H;
        }
    }

} 
```

说明：

右侧和底部滚动有一个小问题：为了避免 ArrayOutOfBoundsException，我在 x 和 y 上实现了测试。

我将其`TILE_SIZE`分成两部分以适应图像比例。

正如我在之前评论的链接中提到的，将磁贴与 WeakReference 数组耦合可调节内存使用：我替换了`boolean[][] loaded`by`WeakReference[][]`并实现了`tileGet(x,y)`获取磁贴的函数。

这些`setImage()`方法初始化类字段，例如图块的大小。

该`this._image`字段继承自超类，实现如下：

```
protected BufferedImage _image = null; 
```

我希望这可以帮助某人。

# c - 查找图像的方向

> ID：11330269
> 
> 赞同：4
> 
> 时间：2012-07-04T13:40:40.697
> 
> 标签：c, opencv, computer-vision

我正在使用 OpenCv 进行模式匹配。我有一个模型，我将目标与函数 cvMatchShapes 进行比较。它有效，但我想知道目标的方向。我该怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-04T17:40:17.900

例如，边界旋转矩形是否适合轮廓方向不同 180 度的情况？

解决问题的另一种方法是计算轮廓矩（我想你在 cvMatchShapes 中使用轮廓，你也可以用类似的方式计算图像矩）[OpenCV Contours Moments？](https://stackoverflow.com/questions/7477449/opencv-contours-moments)，然后从公式计算主轴角：

```
atan2((float)(-2)*Ixy,Ix - Iy)/2 
```

这个角度说的是旋转。关于这个问题的更多理论：http: [//farside.ph.utexas.edu/teaching/336k/newton/node67.html](http://farside.ph.utexas.edu/teaching/336k/newton/node67.html)

# python - MYSQL 语句中的动态表名 (Google Cloud SQL)

> ID：11330274
> 
> 赞同：2
> 
> 时间：2012-07-04T13:40:55.667
> 
> 标签：python, mysql, sql, google-cloud-sql

我正在尝试使用 Python（App Engine）从 Google Cloud SQL 中删除/删除一个表，但我希望表名基于一个变量，为简单起见，我在这里使用“你好”。出于某种原因，它向我抛出了一个错误：“您的 SQL 语法有错误；请查看与您的 MySQL 服务器版本相对应的手册，以获取正确的语法，以便在第 1 行的 '-IN' 附近使用”

我尝试了以下方法：

```
tabNameShort = 'hello'    
cursor = conn.cursor()
cursor.execute('DROP TABLE IF EXISTS %s', (tabNameShort))
conn.commit() 
```

我也试过：

```
tabNameShort = 'hello'    
cursor = conn.cursor()
cursor.execute('DROP TABLE IF EXISTS ' + tabNameShort)
conn.commit() 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-13T12:52:10.417

尝试这个：

```
tabNameShort = 'hello'    
cursor = conn.cursor()
cursor.execute('DROP TABLE IF EXISTS `%s`' % tabNameShort)
conn.commit() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-30T15:52:34.090

警告：如果表名直接或间接地从用户输入中派生，则直接使用“+”附加表名可能会导致 SQL 注入漏洞。

# asp.net - 首选模式是什么：按需启动与数据库的连接或为此目的维护单例？

> ID：11330284
> 
> 赞同：0
> 
> 时间：2012-07-04T13:41:40.790
> 
> 标签：asp.net, multithreading, webforms, singleton, design-patterns

此外，如果要在 ASP.NET 网站上使用后一种模式，则使用“始终打开”连接；线程安全吗？或者会有并发问题。如果没有任何问题，ASP.NET 将如何隐式创建 I/O 线程/或互斥以确保不会发生这种情况，或者会吗？

问题，问题...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T13:43:42.610

最好使用内置的[Connection Pooling](http://msdn.microsoft.com/en-us/magazine/cc163854.aspx#S4)，因此可以根据需要启动连接。他们只会来自游泳池。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T13:44:08.837

让 ADO.NET 为您管理连接池。

当您需要一个新连接时，实例化一个新连接：如果池中存在一个，它将被重置并返回给您。当您释放连接时，它会返回到池中。

# html - 谷歌浏览器使用 z-index 断开链接：-1

> ID：11330291
> 
> 赞同：0
> 
> 时间：2012-07-04T13:41:56.960
> 
> 标签：html, css

所以最近我遇到了 Chrome 的一个问题，如果我将 z-index 设置为 -1 到`position: relative;`无序列表，则链接变得不可点击。

有关示例，请参见Chrome 20.0.1132.47m 中的[http://jsfiddle.net/raLnx/ 。](http://jsfiddle.net/raLnx/)

如果两个部分都被赋予正 z-index 则没有问题，但我认为这要么是 chrome 中的错误，要么有比在我不需要时进行`ul`设置更好的方法。`position: relative;`

有问题的CSS：

```
ul.over {
    height: 40px;
    line-height: 40px;
    border-radius: 5px;
    background-color: #DDD;
    border-bottom: 2px solid #AAA;
}

ul.under {
    height: 35px;
    padding: 0 30px;
    background-color: #EEE;
    line-height: 35px;
    font-size: 90%;
    position: relative;
    bottom: 5px;
    z-index: -1;
} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T13:55:12.530

它发生的原因是因为您的 div #nav 现在位于您的列表/链接上方。您必须从列表中删除 z-index。

# asp.net - 带有 Jquery.ajax 的 FormView

> ID：11330292
> 
> 赞同：1
> 
> 时间：2012-07-04T13:42:01.347
> 
> 标签：asp.net, jquery, formview

我需要使用 jquery.ajax 填充 FormView、DataLIst
我有两种方法可以做到这一点

**1)**当我在 jquery.ajax 中没有收到任何数据但这会导致错误，因为当焦点到达该行时 -- GridView1.DataSource = ds; 这显示错误“对象引用未设置为对象的实例”我在调试模式数据集对象 ds 中检查过数据填充。仅当 this 分配给 DataSource 时才会发生错误

**2）**第二个选项是如果我收到数组列表或数组的数据集数据，那么我将如何填充我的Formview。因为我正在使用**<%#Eval('')%>**

```
**HtmlCode**  
    <asp:FormView ID="GridView1" runat="server">
    <ItemTemplate>
     <div >
          <%# Eval("title")  %>
    </div>
      <table>
               <tr>
                   <td> <%# Eval("S1")  %> </td>
                   <td> <%# Eval("S2")  %> </td>
                   <td> <%# Eval("S3") %> </td>
              </tr>
     </table>  

$("#btnShow").click(function () {
        var selTitle = $("#ddlEDTitle options:selected").text();
        $.ajax({
            type: "POST",
            url: "Default.aspx/GetData",
            data: "{tVal:'" + selTitle + "'}",
            contentType: "application/json",
            dataType: "json",
            success: function () {
                alert("Data Filled"); 
                },
            error: function () { alert("Error : 260"); }
        });
    });

string rawQuery = string.Empty;
        rawQuery = "SELECT Adress from temp WHERE title='" + title + "'";
        System.Data.DataSet ds = new System.Data.DataSet();

        ds = c.fetchData(rawQuery);
        if (ds.Tables[0].Rows.Count > 0)
        {
            DetailsView1.DataSource = ds;
            DetailsView1.DataBind();
            ds.Clear();
        }

        rawQuery = string.Empty;
        rawQuery = "SELECT * from specification WHERE title='" + title+ "'";
        ds = c.fetchData(rawQuery);
        if (ds.Tables[0].Rows.Count > 0)
        {
            GridView1.DataSource = ds;
            //GridView1.DataMember = "specification";
            GridView1.DataBind();
            ds.Clear();
        } 
```

请用您宝贵的知识指导我。
谢谢

# asp.net-mvc - AJAX Get 请求根据从控制器接收到的对象返回成功或错误

> ID：11330296
> 
> 赞同：2
> 
> 时间：2012-07-04T13:42:14.123
> 
> 标签：asp.net-mvc, entity-framework, jquery, mvvm

这是我的问题一步一步，

1-我从我的外部javascript文件中获取ajax请求，如下所示，

```
$.ajax({
    type: "GET",
    dataType: 'json',
    url: '/Company/GetCompanies',
    error: function (xhr, status, error) {
        alert('error');
    return false;
    },
    success: function (response) {
        alert('success');
    return false;
    }
}); 
```

2 - 这是接收请求的动作方法

```
public ActionResult GetCompanies()
{
    var model = new CompanyIndex();
    model.FillCompanies();
    return Json(model ,JsonRequestBehavior.AllowGet);   
} 
```

3 - CompanyIndex 是在我上面的操作方法中创建的 ViewModel。

```
public class CompanyIndex
{
    public IList<Company> Companies { get; set; }

    public void FillCompanies()
    {
        /* Part that is not working */
        UnitOfWork unitOfWork = new UnitOfWork();
        Companies = unitOfWork.CompanyRepository
             .Get(orderBy: q => q.OrderBy(u => u.CompanyName)).ToList();
        unitOfWork.Dispose();
        /****************************/

        /* This works fine */
         var companyList = unitOfWork.CompanyRepository
             .Get(orderBy: q => q.OrderBy(u => u.CompanyName)).ToList();
        Companies = companyList.Select(x => new { name = x.CompanyName }).ToList()
            .Select(x => new Company
            {
                CompanyName = x.name

            }).ToArray<Company>();
        /********************/
    }
} 
```

如您所见，我使用我的存储库和 Get 方法从数据库中获取公司实体，我也在下面分享。问题是当我从数据库中获取它们时，检索到的模型类型是`System.Data.Entity.DynamicProxies.Company_someRandomStringHere`. 在这种情况下，Ajax 获取请求不成功并警告错误消息。

但是，如果我首先从 db 中获取并在 ViewModel 中创建 Company 对象并将它们分配给我的 List，则 ajax 工作正常，并且 ajax get 请求返回成功。当我在 ViewModel 上创建对象时，公司实体的类型`CompanyManagement.Models.Company`应该是这样的。

以防万一您需要它，这是我用来从 db 获取数据的 Get 方法。

```
public virtual IEnumerable<TEntity> Get(
     Expression<Func<TEntity, bool>> filter = null,
     Func<IQueryable<TEntity>, IOrderedQueryable<TEntity>> orderBy = null,
     string includeProperties = "")
{
    IQueryable<TEntity> query = dbSet;

    if (filter != null)
        query = query.Where(filter);

    foreach (var includeProperty in includeProperties.Split
       (new char[] { ',' }, StringSplitOptions.RemoveEmptyEntries))
        query = query.Include(includeProperty);

        if (orderBy != null)
            return orderBy(query).ToList();
        else
            return query.ToList();
} 
```

我不想手动创建新的 Company 对象。任何想法都非常感谢。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T14:29:48.533

发现了问题。似乎 Ajax 请求的响应需要可序列化。为此，我取消了动态代理，

```
context.ContextOptions.ProxyCreationEnabled = false; 
```

因此，我的 Get 函数现在返回`CompanyManagement.Models.Company`实体而不是`System.Data.Entity.DynamicProxies.Company`.

**编辑：**

使用视图模型来填充您的视图，不要将实体返回到客户端，保持您的业务逻辑。这是不好的做法，在某些情况下是危险的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T14:26:39.223

我曾经遇到过类似的问题，我必须像这样手动完成

```
/* Part that is not working */
UnitOfWork unitOfWork = new UnitOfWork();
Companies = unitOfWork.CompanyRepository
         .Get(orderBy: q => q.OrderBy(u => u.CompanyName))
         .Select(x => new Company() 
          {
               fooAttribute = x.fooAtribute
          }).ToList(); 
```

# mfc - CStatic 派生类中的 CPaintDC(this) 绘制不受控制

> ID：11330303
> 
> 赞同：1
> 
> 时间：2012-07-04T13:42:28.650
> 
> 标签：mfc, gdi

正如标题所说。即使在派生类中使用 CPaintDC，GDI 绘图也不会被切断。提前致谢。

```
void CGraph::OnPaint ()
{
   CPaintDC dc(this);
   dc.SetViewportOrg (0, 400);
   dc.SetMapMode(MM_ISOTROPIC);
   dc.SetWindowExt(1000, 800);
   dc.SetViewportExt(1000, -800);

   // MessageBox(L"OnPaint");
   ProcessData ();
   DrawCoordinateSystem (&dc);
   DrawGrid (&dc);
   DrawGraph (&dc);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T15:05:07.723

那么，您的 CGraph 是从 CStatic 派生的，并且您显示的绘图代码在 CStatic 控件之外绘制到它所在的对话框上？这是不可能的，控件只能利用自身。你确定控制没有你想象的那么大，你认为失控的东西实际上不是吗？使用 spy++ 选择你的 cstatic，它会显示窗口的边框。

也许您看到的是不正确的失效。尝试将另一个窗口拖到您的控件上，看看会发生什么。

否则，限制绘图区域的方法是

*   您手动跟踪绘制位置。乏味。
*   使用 SetClipRgn() 设置限制绘图的区域。
*   不太一样，但症状有时看起来很相似：检查控件的 WS_CLIPSIBLINGS 和 WS_CLIPCHILDREN 标志以及它所在的对话框。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-30T06:54:25.847

这是我解决问题的方法

```
 CDC* pDC = GetDC();
    CRect rClient(0,0,1000,800);
    //GetClientRect(rClient);
    CRgn ClipRgn;

    if (ClipRgn.CreateRectRgnIndirect(&rClient))
    {
        pDC->SelectClipRgn(&ClipRgn);
    }

    pDC->SelectObject (PenBlack);
    pDC->MoveTo (-leftMargin*zoomWidth, setPointsCorrected);
    pDC->LineTo (1000*zoomWidth, setPointsCorrected);

    pDC->SelectClipRgn(NULL);
    ReleaseDC(pDC); 
```

# c++ - DiInstallDevice x86 的链接器错误

> ID：11330308
> 
> 赞同：0
> 
> 时间：2012-07-04T13:42:48.397
> 
> 标签：c++, installation, x86, linker-errors, setupapi

我正在使用 DiInstallDevice 功能 ( [MSDN](http://msdn.microsoft.com/en-us/library/windows/hardware/ff544710%28v=vs.85%29.aspx) ) 来安装驱动程序。但是，在 x86 下构建解决方案时出现链接器错误，而 x64 版本是可以的。错误是 LNK2019，链接无法在 x86 版本的 newdev.lib 中找到函数。这是 x86 和 x64 版本的链接器输出：

x86:

> 搜索 C:\Program Files\Microsoft SDKs\Windows\v7.1\Lib\newdev.lib：
> 找到 _UpdateDriverForPlugAndPlayDevicesW@20
> 在 KernelDriverInstaller.obj 中引用
> 加载 newdev.lib(newdev.dll)
> 找到 __IMPORT_DESCRIPTOR_newdev
> 在 newdev.lib(newdev. dll)
> 加载 newdev.lib(newdev.dll)
> 发现 newdev_NULL_THUNK_DATA
> 引用在 newdev.lib(newdev.dll)
> 加载 newdev.lib(newdev.dll)

x64:

> 搜索 C:\Program Files\Microsoft SDKs\Windows\v7.1\Lib\x64\newdev.lib：
> 找到在 KernelDriverInstaller.obj
> 中引用的 DiInstallDevice
> 已加载 newdev.lib(newdev.dll)
> 找到在 KernelDriverInstaller.obj
> 中引用的 UpdateDriverForPlugAndPlayDevicesW
> 已加载 newdev。 lib(newdev.dll)
> 发现 __IMPORT_DESCRIPTOR_newdev
> 在 newdev.lib(newdev.dll)
> 中引用 在 newdev.lib (newdev.dll) 中引用
> 已加载 newdev.lib(newdev.dll) 在newdev.lib(newdev.dll) 中引用已
> 找到 newdev_NULL_THUNK_DATA newdev.lib(newdev.dll)

如您所见，链接器无法找到 x86 库的函数引用。有人知道这个问题以及如何解决它吗？我正在使用 Win7 x64 + VS2008 SP1。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T14:17:30.583

问题解决了。DiInstallDevice 声明被移动到单独的标题和添加的 WINAPI 声明。所以正确的声明应该是：

```
BOOL WINAPI DiInstallDevice(
                     __in_opt   HWND hwndParent,
                     __in       HDEVINFO DeviceInfoSet,
                     __in       PSP_DEVINFO_DATA DeviceInfoData,
                     __in_opt   PSP_DRVINFO_DATA DriverInfoData,
                     __in       DWORD Flags,
                     __out_opt  PBOOL NeedReboot
                     ); 
```

编辑：实际适用于 6.0A SDK，而不是声明正确的 7.1。

# javascript - 通过变量更新属性方法

> ID：11330309
> 
> 赞同：1
> 
> 时间：2012-07-04T13:42:55.060
> 
> 标签：javascript, oop

我想通过称为此代码的方法更改对象的属性：

```
MAP = MAP || {
   level: 0
   updateProperty(property, value){
        if (this.hasOwnProperty(property){
          this.property = value
        }
   }
} 
```

但是当我触发这段代码时，我会在我的对象中创建名为“property”的新属性。但我想将“财产”视为变量，而不是新财产！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T13:44:10.737

你可能想要这个（方括号`this[property] = value;`）

```
var MAP = MAP || {};
MAP = {
    level: 0,
    updateProperty(property, value) {
        if (this.hasOwnProperty(property)) {
            this[property] = value;
        }
    }
}; 
```

# eventbrite - Paypal 沙箱与 eventBrite 的集成

> ID：11330312
> 
> 赞同：0
> 
> 时间：2012-07-04T13:43:10.490
> 
> 标签：eventbrite

我在我的网站上集成了 EventBirte Ticket 小部件，当有人购买该票并付款时，确认 URL 会通知我付款过程是否成功完成，但认为我需要使用 paypal 沙箱进行测试，测试我所有的工作过程。

还有一件事我正在使用 EventBrite PHP API 来生成事件和票证。

任何人有一个想法请让我知道。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T20:05:56.307

您可以通过设置免费门票的活动来测试您的代码[而不会产生任何费用。](http://eventbrite.com/fees/)

**只要您的门票免费，Eventbrite 始终可以免费使用。**

您应该能够使用 Eventbrite API [payment_update](http://developer.eventbrite.com/doc/payments/payment_update/)方法或[基于 Web 的事件管理界面](http://help.eventbrite.com/customer/portal/articles/426298-use-paypal-to-process-orders)来配置您的贝宝电子邮件地址（或贝宝沙盒电子邮件地址）。

我会参考这个问题以获取有关购买后通知挂钩的帮助： [eventbrite api 中是否有可用的回调？](https://stackoverflow.com/questions/11093159/are-there-any-callbacks-available-in-the-eventbrite-api)

# c# - 虚拟成员是否通过反射调用（在正常情况下）？

> ID：11330314
> 
> 赞同：6
> 
> 时间：2012-07-04T13:43:17.230
> 
> 标签：c#, .net, exception, virtual, access-modifiers

我正在测试在构造函数中调用虚拟成员的效果，并发现在调用该成员时产生的异常被包装在[`TargetInvocationException`](http://msdn.microsoft.com/en-us/library/system.reflection.targetinvocationexception.aspx).

根据[文档](http://msdn.microsoft.com/en-us/library/system.reflection.targetinvocationexception.aspx)，这是：

> 通过反射调用的方法抛出的异常

但是我不知道通过反射进行的任何调用。那么这是否**意味着虚拟成员总是通过反射调用？**如果不是，为什么在这种情况下会这样？

编码：

```
class ClassA
    {
        public ClassA()
        {
            SplitTheWords();
        }

        public virtual void SplitTheWords()
        {
            //I've been overidden
        }
    }

class ClassB : ClassA
    {
        private readonly String _output;

        public ClassB()
        {
            _output = "Constructor has occured";
        }

        public override void SplitTheWords()
        {
            String[] something = _output.Split(new[]{' '}); //TargetInvocationException!
        }
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-04T13:46:17.740

不，虚拟方法是通过[virtual dispatch](http://msdn.microsoft.com/en-us/magazine/cc163791.aspx)调用的。

这里没有使用反射。也不是任何虚拟方法调用。我相信异常的文档有点误导，因为这种类型*的*异常是由通过反射调用的方法抛出的，但并非完全如此。

如果有人对为什么问题中的代码给出异常感到好奇，那是因为构造函数的执行顺序。构造函数与以下`ClassB`内容相同：

```
public ClassB() : base()
{
    _output = "Constructor has occured";
} 
```

请注意对 的调用`base()`， this 在`ClassB`构造函数运行之前调用基本构造函数，因此**在分配 _output 之前**。虚方法在`SplitTheWords`基础构造函数中调用，解析为`ClassB.SplitTheWords`. 此方法尝试使用`_output`，因此出现错误。

要更详细地了解为什么不应该从构造函数调用虚拟方法，[这个 SO question](https://stackoverflow.com/questions/119506/virtual-member-call-in-a-constructor)有一些有用的信息。[Eric Lippert 也有一篇非常好的博客文章，说明](http://blogs.msdn.com/b/ericlippert/archive/2008/02/18/why-do-initializers-run-in-the-opposite-order-as-constructors-part-two.aspx)为什么会出现这种情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T13:46:02.173

> 虚拟成员是否通过反射调用（在正常情况下）？

不。

也不是来自构造函数，所以正在发生其他事情。查看调用您显示的代码的代码以及异常的堆栈跟踪将有所帮助。

# streaming - UDP 视频流的数据包顺序

> ID：11330318
> 
> 赞同：2
> 
> 时间：2012-07-04T13:43:41.783
> 
> 标签：streaming, udp, video-streaming, vlc

我正在开发一种用于视频流的代理，我现在正在处理与乱序接收的数据包相关的问题（没有丢失）。这个问题（也许）是视频播放中经常出现噪音的原因。

您是否偶然知道 VLC 是否能够重新排序数据包？如果是这样，这意味着播放中有一些噪音的原因是别的，如果不是，我应该只开发一个额外的层来确保以正确的顺序接收。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T18:28:23.970

假设您正在谈论基于 UDP 的 RTP，AFAIK VLC 使用 live555 库来实现客户端 RTSP/RTP 功能，并且 live555 有一个内置的抖动缓冲区，可以为您重新排序。我不记得手部抖动缓冲区的大小，但 100 毫秒似乎敲响了警钟。

如果您不知道：在开发媒体流应用程序（尤其是通过 UDP）时，增加接收缓冲区的大小很重要。如果它已满并且数据包被丢弃，这可以解释您的工件。

此外，UDP 不可靠意味着如果数据包丢失/损坏并且您没有合适的机制来处理它，您将遇到伪影。

# java - Java 的 CSS 验证器库

> ID：11330320
> 
> 赞同：3
> 
> 时间：2012-07-04T13:43:51.730
> 
> 标签：java, css, validation

我正在寻找可以在我的 java 应用程序中使用的 css 验证器库。我已经检查过了。 [http://jigsaw.w3.org/css-validator/manual.html](http://jigsaw.w3.org/css-validator/manual.html)。但据我了解，需要在本地服务器上运行或用作命令行工具。如果我在这里错了，请纠正我。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T14:29:49.863

在您发布的链接后面有一个网络服务，您可以使用它来验证您的 CSS 文件。但是您必须在线才能执行此操作。还有一个离线版本可用：http: [//jigsaw.w3.org/css-validator/DOWNLOAD.html](http://jigsaw.w3.org/css-validator/DOWNLOAD.html)，您可以将其嵌入到您的应用程序中。

# node.js - nodejs应用程序中的Google feed api？

> ID：11330322
> 
> 赞同：0
> 
> 时间：2012-07-04T13:43:59.763
> 
> 标签：node.js, google-feed-api

我有一个 php 应用程序，它使用 google feed api 来获取我想要的 feed 并显示它们。我想知道如何从 nodejs 应用程序调用 google feed api？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T14:17:33.890

使用节点的`http.request()`（或快捷版`http.get()`）功能；这在概念上与您当前在 PHP 中必须做的事情相同。

您可能会发现安装和使用 Mikeal 的[请求](https://github.com/mikeal/request/)模块会使事情变得更加简单。

# javascript - ExtJS 未定义函数

> ID：11330323
> 
> 赞同：0
> 
> 时间：2012-07-04T13:44:00.030
> 
> 标签：javascript, extjs, extjs4.1

我尝试加载商店，但由于某种原因，我在 Google Chrome（最新版本）中收到此错误：

```
Uncaught TypeError: Cannot call method 'apply' of undefined ext-all-debug.js:8586
fire ext-all-debug.js:8586
Ext.define.continueFireEvent ext-all-debug.js:24623
Ext.define.fireEvent ext-all-debug.js:24601
Ext.define.onProxyLoad ext-all-debug.js:50186
Ext.define.processResponse ext-all-debug.js:39168
(anonymous function) ext-all-debug.js:39381
Ext.apply.callback ext-all-debug.js:6422
Ext.define.handleResponse ext-all-debug.js:18769
(anonymous function) ext-all-debug.js:1815
(anonymous function) 
```

这个在 Internet Explorer 8 中：

```
Message: 'fireFn' is null or not an object 
```

而 FireFox（最新版本）似乎忽略了它。

我在 中插入了一些新行`ext-all-debug.js`，因此行号可能会偏离 5-10 行。

这是商店：

```
Ext.define("FI.store.units.InstallBaseStore", {
extend:'Ext.data.Store',
requires: "FI.model.units.InstallBaseModel",

            model: "FI.model.units.InstallBaseModel",
            storeId: 'installBaseStore',
            pageSize:10,
            proxy: {
                type: 'jsonp',
                url: urls.QSUrl+"/search",
                limitParam: 'undefined',
                startParam: 'offSet',
                pageParam: 'undefined',
                extraParams: {
                    searchString: '*:*',
                    index: "fleet",
                    role: "Admin"
                },

                 reader: {
                        root: 'results.results',
                        totalProperty: 'numFound',
                        model: 'FI.model.units.InstallBaseModel'
                    }
            },

            listeners:{
                beforeload: {
                    fn:function(){
                        console.log("BEFORE LOAD");
                        this.getProxy().setReader({
                        root: 'results.results',
                        totalProperty: 'numFound',
                        model: 'FI.model.units.InstallBaseModel'
                    });
                        console.log(this.getProxy().getReader());
                    }
                }
            }
        }); 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T16:07:39.810

将代理放入模型中，然后像这样对阅读器进行操作：

```
...
proxy:{
  type:'ajax',
  url:'...',
  reader:{
    type:'json',
    root:'...'
  }
} 
```

# oracle - Grails - Tomcat 7 中的连接关闭消息

> ID：11330324
> 
> 赞同：-2
> 
> 时间：2012-07-04T13:44:02.810
> 
> 标签：oracle, grails, firewall

我有一个通过防火墙连接到 Oracle 数据库的 grails 应用程序。我遇到“连接已关闭”消息。

我不确定为什么会这样。我的生产数据源配置如下：

```
production {
  datasource {
    dbCreate = "update"
    url = ${datasource.url}
  }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T14:52:29.513

这不是有效的语法：`url = ${datasource.url}`. 应该是`url = "${datasource.url}"`。`datasource.url`来自哪里？如果它是一个字符串，你可以使用`url = datasource.url`

# wcf - 我可以将连接字符串与 WCF 中的端点相关联吗？

> ID：11330336
> 
> 赞同：3
> 
> 时间：2012-07-04T13:44:39.743
> 
> 标签：wcf, web-services, rest, .net-4.0, web-config

我们有一个连接到数据库的 WCF REST 服务。事实上，我们有几个数据库实例，都具有相同的模式。

我们想为每个数据库实例设置一个端点，并将连接字符串与端点相关联。该服务将读取连接字符串并连接到适当的 SQL Server 实例。

我确信这是可能的；这是个好主意吗？我该如何设置？MSDN上有文档吗？

**编辑：**我找到[了这个问题](https://stackoverflow.com/questions/4718537/dynamically-adding-wcf-data-services-endpoints)，答案建议在标题中添加客户端的连接信息。我不想这样做——出于安全原因，并且因为我*确实*希望每个数据库都有一个不同的 uri。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T15:45:15.097

这比我想象的要难一些。WCF 有*很多*可扩展点，很难选择合适的。如果您认为有更好的方法或有任何问题，请回答或评论。

我已经决定使用实现[IEndpointBehavior](http://msdn.microsoft.com/en-us/library/system.servicemodel.description.iendpointbehavior.aspx)和[IDispatchMessageInspector](http://msdn.microsoft.com/en-us/library/system.servicemodel.dispatcher.idispatchmessageinspector.aspx)的自定义类。我有一个派生自[BehaviorExtensionElement](http://msdn.microsoft.com/en-us/library/system.servicemodel.configuration.behaviorextensionelement.aspx)的类，它允许我将行为与配置中的端点相关联。 [这篇博文](http://blogs.msdn.com/b/carlosfigueira/archive/2011/06/28/wcf-extensibility-behavior-configuration-extensions.aspx)描述了热门的做法。

我的`DatabaseConnectionContext`课看起来像这样：

```
/// <summary>
/// An endpoint behavior that associates a database connection string name with the endpoint and adds it to the
/// properties of incoming messages.
/// </summary>
public class DatabaseConnectionContext : IEndpointBehavior, IDispatchMessageInspector
{
    /// <summary>
    /// Initializes a new instance of the <see cref="DatabaseConnectionContext"/> class with the provided connection string name.
    /// </summary>
    /// <param name="connectionStringName">The name of the connection string to associate with the endpoint.</param>
    public DatabaseConnectionContext(string connectionStringName)
    {
        this.ConnectionStringName = connectionStringName;
    }

    /// <summary>
    /// Gets the name of the connection string to associate with the endpoint.
    /// </summary>
    public string ConnectionStringName { get; private set; }

    /// <inheritdoc />
    public void AddBindingParameters(ServiceEndpoint endpoint, BindingParameterCollection bindingParameters)
    {
    }

    /// <inheritdoc />
    public void ApplyClientBehavior(ServiceEndpoint endpoint, ClientRuntime clientRuntime)
    {
        throw new NotImplementedException();
    }

    /// <inheritdoc />
    public void ApplyDispatchBehavior(ServiceEndpoint endpoint, EndpointDispatcher endpointDispatcher)
    {
        endpointDispatcher.DispatchRuntime.MessageInspectors.Add(this);
    }

    /// <inheritdoc />
    public void Validate(ServiceEndpoint endpoint)
    {
    }

    /// <inheritdoc />
    public object AfterReceiveRequest(ref Message request, IClientChannel channel, InstanceContext instanceContext)
    {
        request.Properties["connectionStringName"] = this.ConnectionStringName;
        return null;
    }

    /// <inheritdoc />
    public void BeforeSendReply(ref Message reply, object correlationState)
    {
    }
} 
```

在我的服务类中，我有这个方法：

```
 /// <summary>
    /// Returns the connection string to use for this service call.
    /// </summary>
    /// <returns>A SQL Server database connection string.</returns>
    private string GetConnectionString()
    {
        string connectionStringName = (string)OperationContext.Current.IncomingMessageProperties["connectionStringName"];
        return ConfigurationManager.ConnectionStrings[connectionStringName].ConnectionString;
    } 
```

我的`BehaviorExtensionElement`课看起来像这样：

```
/// <summary>
/// Associates a <see cref="DatabaseConnectionContext"/> with an endpoint in configuration.
/// </summary>
public class DatabaseConnectionContextBehaviorExtension : BehaviorExtensionElement
{
    /// <summary>
    /// The name of the <see cref="ConnectionStringName"/> property when it appears in a configuration file.
    /// </summary>
    private const string ConnectionStringNamePropertyName = "connectionStringName";

    /// <summary>
    /// Gets or sets the name of the configuration string to associate with the endpoint.
    /// </summary>
    [ConfigurationProperty(ConnectionStringNamePropertyName)]
    public string ConnectionStringName
    {
        get
        {
            return (string)this[ConnectionStringNamePropertyName];
        }

        set
        {
            this[ConnectionStringNamePropertyName] = value;
        }
    }

    /// <inheritdoc />
    public override Type BehaviorType
    {
        get { return typeof(DatabaseConnectionContext); }
    }

    /// <inheritdoc />
    protected override object CreateBehavior()
    {
        return new DatabaseConnectionContext(this.ConnectionStringName);
    }
} 
```

我的 web.config 包含如下内容：

```
<behaviors>

  <endpointBehaviors>
    <behavior name="DevRestEndpointConfiguration">
      <webHttp helpEnabled="false" />
      <connectionStringInterceptor connectionStringName="myDevConnectionStringName" />
    </behavior>
    <behavior name="ProductionRestEndpointConfiguration">
      <webHttp helpEnabled="false" />
      <connectionStringInterceptor connectionStringName="myProductionConnectionStringName" />
    </behavior>
  </endpointBehaviors>

</behaviors>

<extensions>
  <behaviorExtensions>
    <add name="connectionStringInterceptor" type="DatabaseConnectionContextBehaviorExtension, MyAssembly, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null" />
  </behaviorExtensions>
</extensions> 
```

节中的每个`<endpoint />`元素都将`<services />`其`behaviorConfiguration`设置为节中适当元素的名称`<endpointBehaviors />`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T14:22:20.003

为什么不添加一个新参数来指定调用将连接的数据库是什么？

例如：

*   您可以添加一个`db`参数，该参数将获得一个数字，然后您将连接
*   您可以在身份验证方法上添加此类参数

作为第一项的示例：

```
public ProductItem GetProduct(int productId, int db = 1)
{
    ProductItem product = new ProductItem();
    string connectionString = getConnectionStringForDb(db);

    using (SqlConnection connection =
        new SqlConnection(connectionString))
    {
        SqlCommand command = new SqlCommand("SELECT name, price FROM Products WHERE productId = @product;", connection);
        command.Parameters.AddWithValue("@product", productId);

        try
        {
            connection.Open();
            SqlDataReader reader = command.ExecuteReader();
            reader.Read();

            product = new product({
                Name = reader[0],
                Price = reader[1]
            });

            reader.Close();
        }
        catch (Exception ex)
        {
            // Log exception
        }
    }

    return product;
} 
```

取自[MSDN](http://msdn.microsoft.com/en-us/library/ms178411.aspx)

```
private string getConnectionStringForDb(int type)
{

    System.Configuration.ConnectionStringSettings connString;
    System.Configuration.Configuration rootWebConfig = System.Web.Configuration.WebConfigurationManager.OpenWebConfiguration("/MyWebSiteRoot");

    if (rootWebConfig.ConnectionStrings.ConnectionStrings.Count > 0) {

        connString = rootWebConfig.ConnectionStrings.ConnectionStrings["DBConnectionString_" + type];

        if (connString == null) {
            // LOG ERROR
        }
    }
    return connString.ConnectionString;
} 
```

只需在您的和名称中添加您的连接字符串，`web.config`然后像：

```
DBConnectionString_1, DBConnectionString_2, DBConnectionString_3 
```

或任何对你有意义的事情。

```
<connectionStrings>
  <add 
    name="DBConnectionString_1" 
    connectionString="Data Source=serverName;Initial 
    Catalog=Northwind;Persist Security Info=True;User 
    ID=userName;Password=password"
    providerName="System.Data.SqlClient"
  />
  <add 
    name="DBConnectionString_2" 
    connectionString="Data Source=serverName;Initial 
    Catalog=Northwind;Persist Security Info=True;User 
    ID=userName;Password=password"
    providerName="System.Data.SqlClient"
  />
  <add 
    name="DBConnectionString_3" 
    connectionString="Data Source=serverName;Initial 
    Catalog=Northwind;Persist Security Info=True;User 
    ID=userName;Password=password"
    providerName="System.Data.SqlClient"
  />
</connectionStrings> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T14:42:48.417

在你的 web.config 中使用这个：

```
<configuration>

  <appSettings>
    <add key="Foo.svc" value="tagvalue1"/>
  </appSettings>
  ... 
```

您可以通过这种方式在运行时检索值：

```
 private static string GetConfigValue()
    {
        ServiceEndpointCollection ec = OperationContext.Current
            .Host.Description.Endpoints;
        if (ec!=null)
        {
            var segments = ec[0].Address.ToString().Split('/');
            var s = segments[segments.Length-1]; // "Foo.svc"
            return ConfigurationManager.AppSettings[s]; // "tagvalue1"
        } 
        return null;
    } 
```

# extjs4 - 带有文本验证的 Ext JS 4.1 MessageBox

> ID：11330339
> 
> 赞同：4
> 
> 时间：2012-07-04T13:44:51.287
> 
> 标签：extjs4, extjs4.1

我创建了一个 MessageBox 允许用户输入一些文本：

```
Ext.MessageBox.show({
    title : 'Reason',
    msg : 'Your reson:',
    width : 300,
    buttons : Ext.MessageBox.OKCANCEL,
    multiline : true,
    scope : this,
    fn : function(btn, reason){ if (btn == 'ok' && reason != '') this.rejectPlan(rec, reason);}
}); 
```

用户看到它并允许输入他的原因，但现在我所能做的就是验证他输入的文本是否不为空。

我想阻止 OK 按钮，直到用户输入一些文本（假设至少 20 个字符）

我可以向 MessageBox 添加验证器还是必须创建自定义组件扩展窗口？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-03-24T19:58:06.853

实际上这是可能的，认为可能需要一些努力才能使其发挥作用。这是一个相当“hacky”的方法，所以请在你自己的题外话中使用它。

```
 var messageBox = Ext.MessageBox.show({
            title: 'Type Something in!',
            msg: 'Please type something into the text box!',
            width: 300,
            buttons: Ext.MessageBox.OKCANCEL,
            multiline: true,
            fn: function(btn, text, config) {
                //Do your thing
            },
    });

    messageBox.msgButtons.ok.setDisabled(true);
    messageBox.textArea.allowBlank = false;
    messageBox.textArea.on('change', function (e, text, o) {
        if (text.length > 0) {
            messageBox.msgButtons.ok.setDisabled(false);
        } else {
            messageBox.msgButtons.ok.setDisabled(true);
        }
    }); 
```

显示后，您可以获得对消息框的引用。创建并显示文本框后，确定按钮被禁用，文本区域设置为不允许空白值。我还附加了一个事件处理程序，它检查文本区域中是否有文本，以决定是否启用或禁用 ok 按钮。

这种“变通办法”很容易受到 API 更改的影响，所以要小心。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-04T14:34:19.117

您可以将 opts 参数添加到您的 fn，它表示消息框的配置，如果文本为空，则重新打开一个消息框，具有相同的配置。

```
Ext.MessageBox.show({
    title : 'Reason',
    msg : 'Your reason:',
    width : 300,
    buttons : Ext.MessageBox.OKCANCEL,
    multiline : true,
    scope : this,
    fn : function(btn, reason, cfg){ 
         if (btn == 'ok' && Ext.isEmpty(reason)) { 
            //if you want to mark the text as mandatory

            Ext.MessageBox.show(Ext.apply({}, {msg:cfg.msg}, cfg));  
         } else if (btn =='ok') {
            alert('ok with text');                 
         }
    }
});
​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-06-27T07:08:34.383

您还可以像这样启用字段验证：

```
 var promptWindow = Ext.Msg.prompt( 'Reason', 'Please enter a reason of reverse:', function( btn, text, cfg ) {
        if( btn === 'ok' && text.length > 128){
            //display warning

            cfg.value = text;
            Ext.MessageBox.prompt( Ext.apply( {}, { msg: cfg.msg }, cfg ) );
        }
        else if ( btn === 'ok' ) {
            //do something on success
        }
    }, this, true );
    promptWindow.textArea.maxLength = 128; //if multiline is enabled
//promptWindow.textField.maxLength = 128; //if multiline is disabled 
```

# python - Python XML 比较

> ID：11330347
> 
> 赞同：1
> 
> 时间：2012-07-04T13:45:49.337
> 
> 标签：python, xml

我有 2 个文件，每个文件都有一个项目列表，这些项目都有 3 个属性。比较这些文件并列出差异的最快方法是什么，即不在两个文件中的项目。

为了使项目相同，所有 3 个属性必须一致。这些文件也是 XML 格式的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T15:02:27.440

基本算法：

*   `(name, price, expiryDate)`为源生成一组元组
*   `(name, price, expiryDate)`为目的地生成一组元组
*   使用[set 方法](http://docs.python.org/library/stdtypes.html#set)来查找交集/差异/联合等。

你已经准备好了大部分的东西......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T14:59:56.633

我会使用[列表推导](http://docs.python.org/tutorial/datastructures.html)来做到这一点。

# android - Android：阻止触摸片段

> ID：11330349
> 
> 赞同：1
> 
> 时间：2012-07-04T13:45:57.540
> 
> 标签：android

我有一个活动。在活动中，我有 2 个片段，我想阻止对其中一个片段的所有触摸，并在用户单击第一个片段时取消阻止触摸。怎么做 ？片段没有 onTouchEvent 方法

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-04T14:06:49.260

在您的片段中，在 onCreateView 中，获取您返回的视图并将其设置为 onTouchListener：

```
mContentView = inflater.inflate(R.layout.your_layout, null);
    mContentView.setOnTouchListener(new OnTouchListener() {

        @Override
        public boolean onTouch(View v, MotionEvent event) {
            if(fragment is blocked)
              return true;
            else
             return false;
        }
    }); 
    return mContentView;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T13:55:14.200

您可以创建自己的布局（或更好：覆盖您正在使用的布局）并覆盖`public boolean onInterceptTouchEvent(MotionEvent event)`

# javascript - 如何在 Java Script 构造函数中定义 Java Script 方法

> ID：11330354
> 
> 赞同：0
> 
> 时间：2012-07-04T13:46:10.500
> 
> 标签：javascript, html

所以我想在我的构造函数中有一个方法。我这样称呼我的构造函数

```
new EnhancedTooltip($("taskPreview1")) 
```

并将其定义为

```
///<var> Represents the controls</var>
var EnhancedTooltip = function (toolTipObject) {

    ///<field name="alignment" type="Number">.</field>
    this.alignment = 2;
    ///<field name="associatedControl" type="Number">.</field>
    this.associatedControl = toolTipObject;
    ///<field name="caption" type="Number">.</field>
    this.caption = "Let's see how this works";
    ///<field name="description" type="Number">.</field>
    this.description;
    ///<field name="enableEffects" type="Number">.</field>
    this.enableEffects = false;
    ///<field name="fadeAnimationSpeed" type="Number">.</field>
    this.fadeAnimationSpeed = 500;
    ///<field name="image" type="Number">.</field>
    this.image;
    ///<field name="minimumHeight" type="Number">.</field>
    this.minimumHeight = 100;
    ///<field name="minimumWidth" type="Number">.</field>
    this.minimumWidth = 200;
    ///<field name="objectName" type="String">.</field>
    this.objectName = $("taskToolTip");
    ///<field name="padding" type="Number">.<field>
    this.padding = 5;
    ///<field name="tailAngle" type="Number">.</field>
    this.tailAngle;
    ///<field name="tailDiamensions" type="Object">.</field>
    this.tailDimensions = new Size(15, 0);

    EnhancedTooltip.init();

    this.init = new function () {
      ///<summary>Initializes the class EnhancedTooltip.<summary>

      console.log(EnhancedToolTip.objectName);
    };

  }; 
```

并得到EnhancedTooltip没有方法init的错误。那么我应该如何定义init。

另外，如果我想从 init 调用其他函数，我该怎么做。例如

```
this.addToolTipElements = function() {

    $("#workspaceContainer").append("<div id = taskToolTip class = taskToolTip</div>");

    this.objectName.append("<canvas id = toolTipCanvas class = toolTipCanvas </canvas>");

    this.objectName.append("<div id = toolTipCaption class = toolTipCaption>" + this.caption + "</div>");

 }; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T13:51:45.900

那是因为“EnhancedTooltip”是您的构造函数，它没有“init”属性。但是，正在构造的对象 ( `this`) 会：

```
this.init(); 
```

在函数内部：

```
 console.log(this.objectName); 
```

此外，它不是`new function`，它只是`function`：

```
this.init = function() {
  console.log(this.objectName);
}; 
```

*编辑*啊，正如 Sirko 指出的那样，在定义函数*后*调用该函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T13:52:07.750

当您使用函数表达式时，您不能在这里依赖变量提升。

只需定义方法，然后像这样调用它：

```
// rest of the code    

///<field name="tailDiamensions" type="Object">.</field>
this.tailDimensions = new Size(15, 0);

this.init = new function () {
  ///<summary>Initializes the class EnhancedTooltip.<summary>

  console.log(this.objectName);
};

this.init(); 
```

在旁注中，您应该只通过`this`在构造函数中使用来引用您的对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T13:52:40.237

首先，在声明`init()`方法**之前**调用它。

第二件事是——尝试使用更好的风格来声明 Classes。

例如，我更喜欢[这个](http://javascript.crockford.com/code.html).

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-04T13:55:59.317

你调用 init 是错误的。您在作用域而不是原型中定义了它`this`，因此 EnhancedToolTip 在创建之前没有此功能。试试这个：

```
var EnhancedTooltip = function (toolTipObject) {
  [..]

  this.init = new function () {
    ///<summary>Initializes the class EnhancedTooltip.<summary>
    console.log(this);
  };

  this.init();
}; 
```

# javascript - 如何从 aspx 页面调用外部 javascript 函数？

> ID：11330356
> 
> 赞同：0
> 
> 时间：2012-07-04T13:46:22.907
> 
> 标签：javascript, asp.net

我有一个*javascript*文件，并且在该*js*页面中`file.js`有一个函数，首先从*onclick*我调用该函数，然后从我需要调用的位于. 我试过这样`FunctionfromJSpage()`**`aspxPageFunction();``FunctionfromJSpage();``file.js`
`default.aspx`**

 **```
<head>
  <script type="text/javascript" src="../page/file.js"></script>
  <script  type="text/javascript">
      function aspxPageFunction() { 
         //my code..
         FunctionfromJSpage(); 
      } 
  </script>
</head> 
```

但我无法调用该函数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T14:06:35.477

哈里什，

我认为您正在寻找的是将您现在定义的函数（正如 Quentin 指出的那样）添加到现有 asp 控件的属性中。例如：

```
<td>
    <asp:Button ID="Button2" runat="server" OnClientClick="YourFunction(); " Text="ClickMe"/>
</td> 
```

你可以用这种方法做各种各样的事情。这一切都取决于你想做什么。如果您试图在用户将文本放入文本框中时发生某些事情，则需要研究 OnTextChanged 事件，下拉菜单具有 onchange 事件..也许 asp 事件中的速成课程可能有助于您理解更多关于*在哪里*附加这些东西。

对于客户端[（javascript 事件）](http://www.w3schools.com/js/js_events.asp)。

对于服务器端——我们在这里谈论的—— [（asp 事件）](http://www.w3schools.com/aspnet/aspnet_events.asp)。

看起来您才刚刚开始弄清楚客户端服务器关系以及您需要做什么才能使事情发生（尽管我可能错了）*。*如果是这样的话，我祝你好运！我同意其他发帖者的观点——你应该多探索一下谷歌和这个网站，因为这些是在你的编码工作中寻找突破的重要资源。

-sf

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-04T13:51:54.413

您在脚本元素中的代码**定义**了一个函数。

你说你在file.js中定义了它。就叫它你而已`callFunction()`。

```
<script type="text/javascript" src="../page/file.js"></script>
<script  type="text/javascript">
    callFunction();
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T13:47:25.487

将 onload 属性添加到您的正文中，这将在页面加载时调用您的函数`<body onload="callFunction()">`

或在代码隐藏中

```
Page.ClientScript.RegisterClientScriptBlock(Page.GetType(), "scriptKey", "callFunction();",true); 
```

看看这篇很棒的文章[http://www.codeproject.com/Articles/11098/Use-Call-RegisterStartUpScript-RegisterClientScrip](http://www.codeproject.com/Articles/11098/Use-Call-RegisterStartUpScript-RegisterClientScrip)**

# java - 如何在不使用 cmd 的情况下设置 -ORBInitialRef？

> ID：11330357
> 
> 赞同：0
> 
> 时间：2012-07-04T13:46:26.290
> 
> 标签：java, corba

我用网豆清理并构建了我的程序。我想使用 jar 文件，但我不知道如何设置 -ORBInitialRef ？

```
java RunServer -ORBInitRef NameService=corbaloc::localhost:777/NameService 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T14:36:32.653

它是某种指定的java VM参数（或系统属性）吗

```
java RunServer -DORBInitRef <value> 
```

因为简单地将值传递给 java 命令就是将参数传递给 RunServer 程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T11:46:56.953

它是命令行参数还是设置的 JVM 系统属性并不重要，只要它被传递到`ORB.init()`函数中即可。CORBA Orb init() 函数非常聪明，可以解析参数并传递`-ORB`在 ORB 创建期间开始的参数。

看看这里的一些 java ORB 初始化示例： [http ://www.novell.com/documentation/extend52/Docs/help/MP/orb/tutorial/orbInit.html](http://www.novell.com/documentation/extend52/Docs/help/MP/orb/tutorial/orbInit.html)

# android - 如何检测设备是 Android 手机还是 Android 平板电脑？

> ID：11330363
> 
> 赞同：59
> 
> 时间：2012-07-04T13:46:36.240
> 
> 标签：android, device-detection

我有两个适用于 Android 平板电脑和 Android 手机的应用程序。对于我设置的平板电脑应用程序`android:minSdkVersion="11"`。但现在像 Galaxy S3 这样的 Android 手机有 Android 版本 4.0.4，所以 S3 用户可以从 Google Play 商店下载我的平板电脑应用程序。我想警告手机用户在安装平板电脑应用程序时下载手机应用程序。反之亦然，平板电脑用户在运行手机应用程序时下载平板电脑应用程序。

有没有简单的方法来检测设备类型？

### 编辑：

我在这个[链接](http://developer.android.com/guide/practices/screens-distribution.html)上找到了解决方案。

在您的清单文件中，您可以声明手机和平板电脑的屏幕功能，然后 Google Play 决定手机和平板电脑的下载权限。

* * *

## 回答 #1

> 赞同：133
> 
> 时间：2012-07-04T14:22:57.847

用这个：

```
public static boolean isTablet(Context context) {
    return (context.getResources().getConfiguration().screenLayout
            & Configuration.SCREENLAYOUT_SIZE_MASK)
            >= Configuration.SCREENLAYOUT_SIZE_LARGE;
} 
```

如果设备在大屏幕上运行，它将返回 true。

[**其他一些有用的方法可以在这里找到**](http://www.androiddesignpatterns.com/2012/06/compatability-manager-utility-class.html)。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2015-12-14T07:27:39.177

**您也可以尝试**
在资源文件中 添加**布尔**参数。
在 res/values/dimen.xml 文件中添加这一行

```
<bool name="isTab">false</bool> 
```

在 res/values-sw600dp/dimen.xml 文件中添加以下行：

```
<bool name="isTab">true</bool> 
```

然后在你的java文件中得到这个值：

```
if(getResources().getBoolean(R.bool.isTab)) {
    System.out.println("tablet");
} else {
    System.out.println("mobile");
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-09-11T12:16:37.420

此代码片段将判断设备类型是否为 7" 英寸或更大以及 Mdpi 或更高分辨率。您可以根据需要更改实现。

```
 private static boolean isTabletDevice(Context activityContext) {
        boolean device_large = ((activityContext.getResources().getConfiguration().screenLayout &
                Configuration.SCREENLAYOUT_SIZE_MASK) ==
                Configuration.SCREENLAYOUT_SIZE_LARGE);

        if (device_large) {
            DisplayMetrics metrics = new DisplayMetrics();
            Activity activity = (Activity) activityContext;
            activity.getWindowManager().getDefaultDisplay().getMetrics(metrics);

            if (metrics.densityDpi == DisplayMetrics.DENSITY_DEFAULT
                    || metrics.densityDpi == DisplayMetrics.DENSITY_HIGH
                    || metrics.densityDpi == DisplayMetrics.DENSITY_MEDIUM
                    || metrics.densityDpi == DisplayMetrics.DENSITY_TV
                    || metrics.densityDpi == DisplayMetrics.DENSITY_XHIGH) {
                AppInstance.getLogger().logD("DeviceHelper","IsTabletDevice-True");
                return true;
            }
        }
        AppInstance.getLogger().logD("DeviceHelper","IsTabletDevice-False");
        return false;
    } 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-07-16T06:02:14.323

如果您想根据屏幕英寸确定设备是平板电脑还是手机，您可以使用以下

6.5 英寸或更高的设备被视为平板电脑，但最近的一些手持电话具有更高的对角线值。使用以下解决方案的好处是您可以设置边距。

```
public boolean isDeviceTablet(){
    DisplayMetrics metrics = new DisplayMetrics();
    this.getWindowManager().getDefaultDisplay().getMetrics(metrics);
    float yInches= metrics.heightPixels/metrics.ydpi;
    float xInches= metrics.widthPixels/metrics.xdpi;
    double diagonalInches = Math.sqrt(xInches*xInches + yInches*yInches);
    if (diagonalInches>=6.5) {
        return true;
    }
    return false;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-09-14T15:05:06.753

我认为这应该检测是否有东西能够拨打电话，其他一切都将是没有电话功能的平板电脑/电视。

据我所知，这是唯一不依赖屏幕尺寸的东西。

```
public static boolean isTelephone(){
    //pseudocode, don't have the copy and paste here right know and can't remember every line
    return new Intent(ACTION_DIAL).resolveActivity() != null;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-04T14:22:48.773

使用 Google Play 商店功能，并且只允许在平板电脑上下载您的平板电脑应用程序和在手机上下载手机应用程序。

如果用户随后安装了错误的应用程序，那么他们一定是使用另一种方法安装的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-06-03T13:30:07.277

我们的应用程序遇到了类似的问题，应该根据设备类型进行切换 - 选项卡/电话。IOS 完美地为我们提供了设备类型，但同样的想法不适用于 Android。分辨率/ DPI 方法因小分辨率标签、高分辨率手机而失败。经过大量的头发撕裂并将我们的头撞到墙上后，我们尝试了一个奇怪的想法，它工作得非常好，不取决于分辨率。这也应该对您有所帮助。

在 Main 类中，编写此代码，您应该将设备类型设置为 TAB 的 null 和 Phone 的 mobile。

```
String ua=new WebView(this).getSettings().getUserAgentString();

if(ua.contains("Mobile")){
   //Your code for Mobile
}else{
   //Your code for TAB            
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-08-19T04:31:59.873

使用以下代码来识别设备类型。

```
private boolean isTabletDevice() {
     if (android.os.Build.VERSION.SDK_INT >= 11) { // honeycomb
         // test screen size, use reflection because isLayoutSizeAtLeast is only available since 11
         Configuration con = getResources().getConfiguration();
         try {
              Method mIsLayoutSizeAtLeast = con.getClass().getMethod("isLayoutSizeAtLeast");
              Boolean r = (Boolean) mIsLayoutSizeAtLeast.invoke(con, 0x00000004); // Configuration.SCREENLAYOUT_SIZE_XLARGE
              return r;
         } catch (Exception x) {
              return false;
         }
      }
    return false;
} 
```

# backbone.js - 通过 Backbone 中的链接传递参数

> ID：11330365
> 
> 赞同：1
> 
> 时间：2012-07-04T13:46:41.157
> 
> 标签：backbone.js

我有一个我在 Rails 中编写的日程/日历应用程序，我正在使用 Backbone（和 Rails，仍然）重写。

在旧应用程序中，当您单击时间段进行新约会时，它会在查询字符串中传递日期和时间。

对于 Backbone，也许我想做同样的事情。不过，我很担心，因为 1）我不知道如何使用 Backbone 读取查询字符串（这没什么大不了的 - 我可以弄清楚），更重要的是，2）也许 Backbone 提供了一种方法传递比我以前做的更好的数据。

所以我的问题是：**我应该在查询字符串中传递日期/时间数据，还是 Backbone 有我没有想到的更好的方法**？查询字符串解决方案总感觉有点笨拙，所以我想我会检查一下。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T13:54:24.927

Backbone 实现了开箱即用的 REST API，您应该尽可能地遵循它。

```
url              HTTP Method    Operation
/api/books       GET            Get an array of all books
/api/books/:id   GET            Get the book with id of :id
/api/books       POST           Add a new book and return the book with an id attribute added
/api/books/:id   PUT            Update the book with id of :id
/api/books/:id   DELETE         Delete the book with id of :id 
```

出于创建新约会的目的。您基本上会创建一个新的 AppointmentModel 实例，它扩展 Backbone.Model。将 URL 定义为“/api/appointments”或类似名称。

调用 AppointmentModel1.save() 将向 /api/appointments 发出一个 POST，其中包含模型中的所有数据。

不要使用 QueryStrings - 否则您最终会在所有地方覆盖主干 URL，并且会失去主干可以为您处理的许多功能。

# jfreechart - JFreeChart：如何在 OHLC 图表上绘制移动平均线

> ID：11330370
> 
> 赞同：3
> 
> 时间：2012-07-04T13:46:58.330
> 
> 标签：jfreechart

我试图在 OHLC 图表上叠加移动平均线，但它似乎不起作用。

我提供了代码的两个关键功能：

```
private static OHLCDataset createPriceDataset(String filename)
{   
    OHLCSeries s1 = new OHLCSeries(filename);

    try {
        BufferedReader in = new BufferedReader(new FileReader(filename));
        DateFormat df = new SimpleDateFormat("yyyyMMdd");
        String inputLine;
        in.readLine();
        while ((inputLine = in.readLine()) != null) {
            StringTokenizer st = new StringTokenizer(inputLine, ",");
            Date date       = df.parse( st.nextToken() );
            double open     = Double.parseDouble( st.nextToken() );
            double high     = Double.parseDouble( st.nextToken() );
            double low      = Double.parseDouble( st.nextToken() );
            double close    = Double.parseDouble( st.nextToken() );
            double volume   = Double.parseDouble( st.nextToken() );
            //double adjClose = Double.parseDouble( st.nextToken() );
            s1.add(new Day(date), open, high, low, close);
        }
        in.close();
    }
    catch (Exception e) {
        e.printStackTrace();
    }

    OHLCSeriesCollection dataset = new OHLCSeriesCollection();
    dataset.addSeries(s1);

    return dataset;
}

private static JFreeChart createCombinedChart()
{
    OHLCDataset data1 = createPriceDataset(filename);

    XYItemRenderer renderer1 = new HighLowRenderer();
    renderer1.setBaseToolTipGenerator(new StandardXYToolTipGenerator(StandardXYToolTipGenerator.DEFAULT_TOOL_TIP_FORMAT, new SimpleDateFormat("d-MMM-yyyy"), new DecimalFormat("0.00")));
    renderer1.setSeriesPaint(0, Color.blue);
    DateAxis domainAxis = new DateAxis("Date");
    NumberAxis rangeAxis = new NumberAxis("Price");
    rangeAxis.setNumberFormatOverride(new DecimalFormat("$0.00"));
    rangeAxis.setAutoRange(true);
    rangeAxis.setAutoRangeIncludesZero(false);
    XYPlot plot1 = new XYPlot(data1, domainAxis, rangeAxis, renderer1);
    plot1.setBackgroundPaint(Color.lightGray);
    plot1.setDomainGridlinePaint(Color.white);
    plot1.setRangeGridlinePaint(Color.white);
    plot1.setRangePannable(true);

    //Overlay the Long-Term Trend Indicator
    XYDataset dataset3 = MovingAverage.createMovingAverage(data1, "LT", 49.0, 49.0);
    plot1.setDataset(1, dataset3);
    plot1.setRenderer(1, new StandardXYItemRenderer());

    //add a second dataset (volume) and renderer
    IntervalXYDataset data2 = createVolumeDataset(filename);
    XYBarRenderer renderer2 = new XYBarRenderer();
    renderer2.setDrawBarOutline(false);
    renderer2.setBaseToolTipGenerator(new StandardXYToolTipGenerator(StandardXYToolTipGenerator.DEFAULT_TOOL_TIP_FORMAT, new SimpleDateFormat("d-MMM-yyyy"), new DecimalFormat("0,000.00")));
    renderer2.setSeriesPaint(0, Color.red);

    XYPlot plot2 = new XYPlot(data2, null, new NumberAxis("Volume"), renderer2);
    plot2.setBackgroundPaint(Color.lightGray);
    plot2.setDomainGridlinePaint(Color.white);
    plot2.setRangeGridlinePaint(Color.white);

    CombinedDomainXYPlot cplot = new CombinedDomainXYPlot(domainAxis);
    cplot.add(plot1, 3);
    cplot.add(plot2, 2);
    cplot.setGap(8.0);
    cplot.setDomainGridlinePaint(Color.white);
    cplot.setDomainGridlinesVisible(true);
    cplot.setDomainPannable(true);

    //return the new combined chart
    JFreeChart chart = new JFreeChart("Sun Microsystems (SUNW)", JFreeChart.DEFAULT_TITLE_FONT, cplot, false);

    ChartUtilities.applyCurrentTheme(chart);
    renderer2.setShadowVisible(false);
    renderer2.setBarPainter(new StandardXYBarPainter());

    return chart;
} 
```

有任何想法吗？

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-04T17:51:08.840

我添加了以下代码，它似乎工作。如果有人不同意这个解决方案，请告诉我。就这样：

```
public class PriceVolumeChart2 extends ApplicationFrame{

final static String filename = "A.txt";
*static TimeSeries t1 = new TimeSeries("49-day moving average");*

/**
 * Default constructor
 */
public PriceVolumeChart2(String title)
{
    super(title);
    JPanel panel = createDemoPanel();
    panel.setPreferredSize(new Dimension(500, 270));
    setContentPane(panel);
}

//create price dataset
//hard-coded here
private static OHLCDataset createPriceDataset(String filename)
{
    //the following data is taken from http://finance.yahoo.com/
    //for demo purposes...

    OHLCSeries s1 = new OHLCSeries(filename);

    try {
        BufferedReader in = new BufferedReader(new FileReader(filename));
        DateFormat df = new SimpleDateFormat("yyyyMMdd");
        String inputLine;
        in.readLine();
        while ((inputLine = in.readLine()) != null) {
            StringTokenizer st = new StringTokenizer(inputLine, ",");
            Date date       = df.parse( st.nextToken() );
            double open     = Double.parseDouble( st.nextToken() );
            double high     = Double.parseDouble( st.nextToken() );
            double low      = Double.parseDouble( st.nextToken() );
            double close    = Double.parseDouble( st.nextToken() );
            double volume   = Double.parseDouble( st.nextToken() );
            //double adjClose = Double.parseDouble( st.nextToken() );
            s1.add(new Day(date), open, high, low, close);
            *t1.add(new Day(date), close);*
        }
        in.close();
    }
    catch (Exception e) {
        e.printStackTrace();
    }

    OHLCSeriesCollection dataset = new OHLCSeriesCollection();
    dataset.addSeries(s1);

    return dataset;
}

//create volume dataset
private static IntervalXYDataset createVolumeDataset(String filename)
{
    //create dataset 2...
    TimeSeries s1 = new TimeSeries("Volume");

    try {
        BufferedReader in = new BufferedReader(new FileReader(filename));
        DateFormat df = new SimpleDateFormat("yyyyMMdd");
        String inputLine;
        in.readLine();
        while ((inputLine = in.readLine()) != null) {
            StringTokenizer st = new StringTokenizer(inputLine, ",");
            Date date = df.parse( st.nextToken() );
            st.nextToken();
            st.nextToken();
            st.nextToken();
            st.nextToken();
            double volume   = Double.parseDouble( st.nextToken() );
            //double adjClose = Double.parseDouble( st.nextToken() );
            s1.add(new Day(date), volume);
        }
        in.close();
    }
    catch (Exception e) {
        e.printStackTrace();
    }

    return new TimeSeriesCollection(s1);
}

private static JFreeChart createCombinedChart()
{
    OHLCDataset data1 = createPriceDataset(filename);

    XYItemRenderer renderer1 = new HighLowRenderer();
    renderer1.setBaseToolTipGenerator(new StandardXYToolTipGenerator(
        StandardXYToolTipGenerator.DEFAULT_TOOL_TIP_FORMAT,
        new SimpleDateFormat("d-MMM-yyyy"), new DecimalFormat("0.00")));
    renderer1.setSeriesPaint(0, Color.blue);
    DateAxis domainAxis = new DateAxis("Date");
    NumberAxis rangeAxis = new NumberAxis("Price");
    rangeAxis.setNumberFormatOverride(new DecimalFormat("$0.00"));
    rangeAxis.setAutoRange(true);
    rangeAxis.setAutoRangeIncludesZero(false);
    XYPlot plot1 = new XYPlot(data1, domainAxis, rangeAxis, renderer1);
    plot1.setBackgroundPaint(Color.lightGray);
    plot1.setDomainGridlinePaint(Color.white);
    plot1.setRangeGridlinePaint(Color.white);
    plot1.setRangePannable(true);

    //Overlay the Long-Term Trend Indicator
    *TimeSeries dataset3 = MovingAverage.createMovingAverage(t1, "LT", 49, 49);
    TimeSeriesCollection collection = new TimeSeriesCollection();
    collection.addSeries(dataset3);
    plot1.setDataset(1, collection);*
    plot1.setRenderer(1, new StandardXYItemRenderer());

    //add a second dataset (volume) and renderer
    IntervalXYDataset data2 = createVolumeDataset(filename);
    XYBarRenderer renderer2 = new XYBarRenderer();
    renderer2.setDrawBarOutline(false);
    renderer2.setBaseToolTipGenerator(new StandardXYToolTipGenerator(
        StandardXYToolTipGenerator.DEFAULT_TOOL_TIP_FORMAT,
        new SimpleDateFormat("d-MMM-yyyy"), new DecimalFormat("0,000.00")));
    renderer2.setSeriesPaint(0, Color.red);

    XYPlot plot2 = new XYPlot(data2, null, new NumberAxis("Volume"), renderer2);
    plot2.setBackgroundPaint(Color.lightGray);
    plot2.setDomainGridlinePaint(Color.white);
    plot2.setRangeGridlinePaint(Color.white);

    CombinedDomainXYPlot cplot = new CombinedDomainXYPlot(domainAxis);
    cplot.add(plot1, 3);
    cplot.add(plot2, 2);
    cplot.setGap(8.0);
    cplot.setDomainGridlinePaint(Color.white);
    cplot.setDomainGridlinesVisible(true);
    cplot.setDomainPannable(true);

    //return the new combined chart
    JFreeChart chart = new JFreeChart("Sun Microsystems (SUNW)",
        JFreeChart.DEFAULT_TITLE_FONT, cplot, false);

    ChartUtilities.applyCurrentTheme(chart);
    renderer2.setShadowVisible(false);
    renderer2.setBarPainter(new StandardXYBarPainter());

    return chart;
}

//create a panel
public static JPanel createDemoPanel()
{
    JFreeChart chart = createCombinedChart();
    return new ChartPanel(chart);
}

public static void main(String[] args) {
    // TODO code application logic here
    PriceVolumeChart2 demo = new PriceVolumeChart2(
        "JFreeChart: CombinedXYPlotDemo1.java (base)");
    demo.pack();
    RefineryUtilities.centerFrameOnScreen(demo);
    demo.setVisible(true);
}

//Download data from web
} 
```

样本数据：

```
20110103,41.56,42.14,41.41,41.88,3572300
20110104,41.99,42.1,41.18,41.49,3588800
20110105,41.28,41.73,41,41.4,3232700
20110106,41.37,41.84,41.21,41.48,3361400
20110107,41.52,41.8,41.04,41.62,2725900
20110110,41.41,42.72,41.3,42.22,3145800
20110111,42.52,43.31,42.38,42.94,3315400
20110112,43.2,43.41,42.96,43.13,2463100
20110113,42.88,43.23,42.87,42.97,1676400
20110114,42.79,43.37,42.76,43.26,2215600
20110117,43.26,43.26,43.26,43.26,0
20110118,43.33,44.45,43.32,44.35,2982300
20110119,44.16,44.29,42.27,42.43,4537200
20110120,41.95,42.58,41.46,42.29,4874700
20110121,42.5,43.26,42.03,42.11,3004500
20110124,42.18,42.79,42.07,42.77,2067400
20110125,42.77,43.52,42.28,42.69,3132700
20110126,42.82,42.97,42.04,42.57,3927300
20110127,42.77,43.09,42.37,42.45,3189600
20110128,42.5,42.52,40.88,40.98,3629800
20110131,41.21,41.83,40.89,41.83,3690900
20110201,42.07,42.7,41.93,42.05,3388200
20110202,41.75,41.91,40.82,41.23,3970700
20110203,40.93,41.18,40.23,40.99,3522700
20110204,41.19,43.13,40.94,42.99,5197700
20110207,43.45,44.66,43.37,44.44,4569800
20110208,44.65,44.71,43.83,44.17,3734500
20110209,44.01,44.17,43.16,43.43,3779300
20110210,43.22,44.01,42.57,44,3275700
20110211,43.77,45.15,43.65,45.02,4436000
20110214,45,45.42,44.72,44.79,3484400
20110215,44.79,45,42.64,42.65,7328000
20110216,42.91,43.6,42.7,43.57,4159800
20110217,43.38,44,43.02,43.92,2621800
20110218,43.78,44.29,43.65,43.92,4390200
20110221,43.92,43.92,43.92,43.92,0
20110222,43.21,43.75,42.39,42.49,4143600
20110223,42.59,42.75,39.94,40.45,7074200
20110224,40.34,41.55,40.18,41.15,4455700
20110225,41.16,42.41,41.13,42.36,4297500
20110228,42.43,42.65,41.36,42.08,3070200
20110301,41.98,42.49,40.65,40.68,4091300

```

新代码在星号内。

如果您认为有更优雅的解决方案，请告诉我。

# qt - 如何使用 QtCopyDialog？

> ID：11330371
> 
> 赞同：0
> 
> 时间：2012-07-04T13:47:01.440
> 
> 标签：qt, include, copy

我包括这个库： `#include <QtCopyDialog>`

当我编译时，我看到这个错误“QtCopyDialog：没有这样的文件或目录”

如何解决这个问题呢？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T14:18:51.700

`QtCopyDialog`不是核心 Qt 库的一部分，而是作为[Qt Solutions](http://qt.nokia.com/products/qt-addons/solutions-archive/)的一部分发布的，这是一个现已停产的附加组件。官方 Qt 站点链接到一个新的 Git 存储库，其中包含一些原始 Qt 解决方案类。这似乎是 Qt Solutions 源代码维护最多（唯一？）的位置，但`QtCopyDialog`似乎没有取得成绩。我唯一能找到来源的地方`QtCopyDialog`就是[这里](ftp://ftp.qt.nokia.com/qt/solutions/lgpl/)。从[docs](http://doc.qt.nokia.com/solutions/4/qtcopydialog/)来看，最后一次维护它是 Qt 4.5 之前的版本。您*可能*需要进行一些更改才能使其与您正在使用的任何版本的 Qt 库一起工作。

# objective-c - 在没有 cocos2d 的 Xcode 中使用纹理图集

> ID：11330372
> 
> 赞同：0
> 
> 时间：2012-07-04T13:47:01.850
> 
> 标签：objective-c, ios, ipad, animation, sprite

从这个问题开始：

[我应该如何在 iOS 中为 200 多张图像制作动画？](https://stackoverflow.com/questions/11320670/how-should-i-go-about-animating-over-200-images-in-ios/11326896#11326896)

我想知道如何在 Xcode 中使用纹理图集，而不是 cocos2d。太多的项目已经完成，我现在无法将其移植到 cocos2d。这也将是唯一具有此数量图像的动画。

那里唯一的教程似乎涉及 cocos2d 或 corona。我已经下载了 Zwoptex 并打包了我所有的精灵，但即便如此，我也不确定我是否应该修剪它们，允许旋转，给它们填充，甚至我如何处理我的视网膜图像。

我一直在查看此链接： http: [//mysterycoconut.com/blog/2011/01/cag1/](http://mysterycoconut.com/blog/2011/01/cag1/)正如我上一个问题向我推荐的那样，但它似乎掩盖了我正在努力解决的许多部分。

我真的很感激这方面的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T20:01:21.643

纹理图集设计为与 Cocos2D 一起运行，与其他组件有很多依赖关系。所以我认为这对你来说不是一个好的选择。

否则，您发布的教程很好。它可能是最容易使用的，但它提供了一个非常好的切入点。这段代码的主要部分是`- display`和`- (void)displayLayer:`方法：

当图层需要其内容时调用 display 方法。动画将（间接）调用 display 方法，在这里我们调用 displayLayer 它将更改要显示的图像（我希望我已经清楚了：！）。

如果要使用非固定大小的 zwooptex 文件（或其他文件），如何重构显示方法：

```
// Implement displayLayer: on the delegate to override how sample rectangles are calculated; remember to use currentSampleIndex, ignore sampleIndex == 0, and set the layer's bounds
- (void)display;
{
   static const CGRect sampleRects[11] = {
      { 0, 0, 38, 47 },       // run
      { 0, 47, 46, 47 },
      { 82, 0, 40, 47 },
      { 122, 0, 30, 47 },
      { 152, 0, 36, 47 },
      { 38, 0, 44, 47 },
      { 188, 0, 42, 47 },
      { 230, 0, 26, 47 },
      { 46, 47, 28, 47 },
      { 74, 47, 28, 47 },
      { 102, 47, 28, 47 },
   };

   unsigned int idx = [self currentSampleIndex];
   if (idx == 0)
      return;

   self.bounds = CGRectMake(0, 0, sampleRects[idx-1].size.width, sampleRects[idx-1].size.height);
   self.contentsRect = CGRectMake(sampleRects[idx-1].origin.x/256.0f, sampleRects[idx-1].origin.y/128.0f, sampleRects[idx-1].size.width/256.0f, sampleRects[idx-1].size.height/128.0f);
}

@end 
```

如果您有任何问题，请不要犹豫。;)

# html - 如何用精灵替换按钮中的 img 并使其对齐？

> ID：11330373
> 
> 赞同：1
> 
> 时间：2012-07-04T13:47:05.120
> 
> 标签：html, css

我正在尝试更改为在我的按钮中使用精灵而不是图标。

旧 HTML：

```
<button id="refreshLink" type="button">
<img width="16" height="16" src="/Content/images/icons/fugue/arrow-circle.png">
Refresh</button> 
```

这是我的新 HTML：

```
<button id="createLink" type="button">
<div class="icon sprite-document-text"></div>Create</button> 
```

但是我有一个问题：新 HTML 中的精灵与按钮中“创建”文本的底部对齐。当我使用 img 时，图像上方和下方的空间相等，这就是我想要的。有什么方法可以让我的第一个代码中的 div 不与文本的底部对齐？

```
Using img 
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx     
x                                x 
x                                x    
x xxxxxx                         x     
x xxxxxx   xxxxxxxxxxxxxxxxxx    x     
x xxxxxx   xxxxxxxxxxxxxxxxxx    x
x xxxxxx   xxxxxxxxxxxxxxxxxx    x
x xxxxxx   xxxxxxxxxxxxxxxxxx    x
x xxxxxx                         x
x                                x
x                                x
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

Using DIV
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx     
x                                x 
x xxxxxx                         x   
x xxxxxx                         x     
x xxxxxx   xxxxxxxxxxxxxxxxxx    x     
x xxxxxx   xxxxxxxxxxxxxxxxxx    x
x xxxxxx   xxxxxxxxxxxxxxxxxx    x
x xxxxxx   xxxxxxxxxxxxxxxxxx    x
x                                x
x                                x
x                                x
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
```

我的CSS：

```
.sprite-document-text { background-position: 0 -990px; }
.icon {
    background-color: transparent;
    background-image: url("/Images/fugue/sprite.png");
    background-repeat: no-repeat;
    display: inline-block;
    height: 16px;
    line-height: 16px;
    width: 16px;
}
.button{
    display: inline-block;
    font-size: 1.167em;
    line-height: 1.429em;
    padding: 0.286em 1em 0.357em;
}
button img {
    margin-bottom: -3px;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T13:51:33.617

尝试`vertical-align`在`div.icon`.

在这里，我稍微简化了小提琴，并使用了在线图片-> [http://jsfiddle.net/joplomacedo/7pyPw/](http://jsfiddle.net/joplomacedo/7pyPw/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T13:51:22.220

为什么不在你的 .icon 类中试试这个呢？

```
background-position:center center; 
```

或者

```
background-position:center 5px; 
```

ETC...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T14:10:00.060

我认为您可以将图像放在适当的位置。

问题在于将“创建”文本放在 div 的中间。

在图标类中添加如下样式

```
.icon    
{         
     vertical-align: middle;    
} 
```

这将使文本出现在 div 的中间。

# php - 在 drupal 7.0 中的页面加载时将数据库值保存在文本字段中

> ID：11330376
> 
> 赞同：0
> 
> 时间：2012-07-04T13:47:10.043
> 
> 标签：php, mysql, drupal

此查询返回一个名称：

```
$result=db_query("SELECT name FROM users WHERE users.uid=:uid",array(':uid'=>$artcheckin))->fetchField(); 
```

现在我想在表单加载时保存在文本字段中检索的名称。

这不起作用：

```
$form['name']['#default_value'] =$result; 
```

我应该使用什么页面加载挂钩，以便在页面加载时将值存储在数据库的文本字段中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T13:51:02.140

你会想要进入[hook_form_alter](http://api.drupal.org/api/drupal/modules!system!system.api.php/function/hook_form_alter/7)。您可以使用它在页面上打印出 form_id，然后创建一个特定于表单的钩子，如下所示：

```
function hook_form__form_id_alter(&$form, &$form_state, $form_id) {
  $result=db_query("SELECT name FROM users WHERE users.uid=:uid",array(':uid'=>$artcheckin))->fetchField();
  $form['name']['#default_value'] = $result;
} 
```

# load - 负载如何大于 1 且 CPU 使用率小于 100%

> ID：11330381
> 
> 赞同：1
> 
> 时间：2012-07-04T13:47:26.930
> 
> 标签：load, cpu-usage, stress-testing

我正在对我的生产服务器进行压力测试，它是 1-Core linux 服务器。虽然压力测试负载平均值在 2 和 5 之间波动，但 CPU 利用率在 70%-100% 之间。我查看了负载平均定义，我了解到如果长时间平均负载 > 1，那么该时间的 CPU 利用率必须为 100%

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T13:55:49.560

Load 是等待的进程数（通常用于磁盘 IO）。它不是 CPU 使用率、磁盘、网络或其他任何东西的百分比。

您可以使用如下命令查看磁盘等待进程：

```
watch 'ps -eo pid,user,state,command | awk '\''$3~/D/ { print $0 }'\' 
```

我从这里得到的：[https](https://serverfault.com/questions/316922/how-to-detect-the-process-and-mysql-query-that-makes-high-load-on-server) ://serverfault.com/questions/316922/how-to-detect-the-process-and-mysql-query-that-makes-high-load-on-server这不起作用但我改变了它以使其工作。

这也适用于我，但显示很多与状态“D”无关的行

```
ps aux | grep " D " 
```

更新：这是使用 BSD 样式选项的替代脚本：

```
ps auxw | awk 'index($8,"STAT") || $8~/D/ { print $0 }' 
```

# intellij-idea - 有没有一种简单的方法可以使用 intellij 进行 liferay 主题开发？

> ID：11330383
> 
> 赞同：1
> 
> 时间：2012-07-04T13:47:42.763
> 
> 标签：intellij-idea, themes, liferay

我最近从 eclipse 和 netbeans 切换到了 intellij，但我还有 liferay 的工作要做，而 intelliJ 似乎缺乏像样的 liferay 集成。

有人知道如何使用 intelliJ，尽可能多地使用 intelliJs：-/

由于主题不是简单的 java 项目，因此导入的东西似乎无法正确识别它......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T16:54:44.153

您可以查看 Liferay 的 maven 集成（取决于您使用的 Liferay 版本 - 版本越新，maven 集成越好），然后只导入一个纯 maven 项目。它的布局与通常的基于 ant 的 SDK 有点不同。

当然，您也可以使用您在插件 sdk 中找到的纯 Ant 构建文件。由于主题中通常没有 java，因此并没有太大的区别。

不想在这里开始 IDE 大战，但您也可以考虑 Liferay IDE（或 Developer Studio，它是 EE 版本）用于主题相关的开发。由于没有在主题中完成Java开发，因此更换工具的冲突应该是可以处理的。我不想再次在两个 IDE 中工作以进行 Java 开发（去过那里，做过），但对于主题，我可以想象走简单的路线——主要是你编辑的 CSS。

# c# - 扩展方法与助手类

> ID：11330384
> 
> 赞同：22
> 
> 时间：2012-07-04T13:47:46.197
> 
> 标签：c#, .net, extension-methods, helper

> **可能重复：**
> [扩展方法与静态实用程序类](https://stackoverflow.com/questions/4646328/extension-methods-vs-static-utility-class)

我正在构建一个通用函数的 API，它基于 .NET 中的对象执行操作。例如; 我创建了一个检查字符串以查看它是否是电子邮件地址的函数。

我可以有：

```
static bool IsEmailAddress(string text)
{
    return IsMail(text);
} 
```

或者我可以创建一个可以像这样使用的扩展方法：

```
string text = "HelloWorld@Email.com";
if (text.IsEmailAddress())
{
} 
```

哪个更合适，或者您认为因为这是一个通用库，我可以在技术上以两种方式实现它并允许开发人员决定哪个最适合他们？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-07-04T13:57:07.303

创建扩展方法意味着当用户使用该类型时，它将在智能感知期间自动显示。您必须小心，不要在开发人员浏览的方法列表中添加很多噪音（尤其是在创建可重用框架时）。例如，当这些方法仅在特定上下文中可用时，您可能最好使用“普通”静态方法。尤其是在实现通用类型的扩展方法时，例如`string`.

`ToXml(this string)`以扩展方法或扩展方法为例`ToInt(this string)`。尽管拥有这些扩展方法看起来很方便，但将文本转换为 XML 并不是您在整个应用程序中都会做的事情，而且很容易做到`XmlHelper.ToXml(someString)`。

只有一件事更糟糕，那就是在`object`.

如果你正在编写一个可重用的框架，[那么 Krzysztof Cwalina 的书 Framework-Design-Guidelines](https://rads.stackoverflow.com/amzn/click/com/0321545613)绝对是必读的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-04T13:49:30.997

我更喜欢扩展方法，因为你的代码很优雅，你可以在框架的密封类上定义扩展方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-04T13:59:16.613

问题是您将针对哪个 .NET Framework？如果 < 3.5 则扩展方法不可用。否则，你为什么要创建一个新班级？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-04T13:52:14.100

扩展方法自动成为静态类的一部分。这意味着消费者可以使用扩展方法，也可以根据需要从类中调用静态方法。我尽可能多地使用扩展方法，如果将它们放在正确的命名空间中，它们更容易发现。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-04T13:52:52.307

扩展方法允许开发人员不知道助手类被调用的确切位置以及它的位置，更不用说它存在的事实了。请注意，您仍然需要将它们的命名空间放在`using`子句中——也许将它们放置在您的应用程序的一些通用的顶级命名空间中。

# javascript - Razor 中 window.open() 函数的绝对路径

> ID：11330385
> 
> 赞同：1
> 
> 时间：2012-07-04T13:48:06.073
> 
> 标签：javascript, asp.net-mvc, url, razor

我想从 javascript 调用

```
window.open("< full URL to my '/controller/action/id' >", "My test page") 
```

在 Razor 中，但我不知道该怎么做。

谁能帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T13:53:19.420

您可以使用上的`Action`方法`UrlHelper`。

您可以使用`UrlHelper`该属性在您的视图中访问`Url`：

```
<script type="text/javascript">
    window.open("@(Url.Action("Index", "Home", new { id= 1}))", "My test page")
</script> 
```

# lambda - PyQt QObject.connect(instancemethod) 和 QtCore.connect(Qobj, SIGNAL(), instancemethod) 与 lambda 函数的行为不同

> ID：11330386
> 
> 赞同：1
> 
> 时间：2012-07-04T13:48:06.630
> 
> 标签：lambda, pyqt, signals, connect, slot

[在从字符串列表中创建 PyQt 菜单的](https://stackoverflow.com/questions/1100775/create-pyqt-menu-from-a-list-of-strings)后续操作中，我还在动态创建菜单并想知道单击了哪个菜单项。因此，我使用了一段代码，例如：

```
for item in ADDABLE_OBJECTS:
     action = self.menuAdd.addAction(item)
     l = lambda item=item: self.doStuff(item)
     action.triggered.connect(l)

def doStuff(self, item):
  print "Item: ", item 
```

输出：

> 项目：假（默认的“布尔”参数，如 Qt 文档中针对触发（）信号所述）

正如我认为与 connect(object, SIGNAL(...), slot) 相比，object.connect() 是“新”形式。我也可以更好地工作，因为可以在编译时检查信号名称。但是，它没有用。我得到的只是'bool = false'（如触发（）的Qt文档中所述）。所以在搜索后遇到了上面提到的网址。不，我有这个：

```
for item in ['One', 'Two', 'Three']:
    action = self.menuAdd.addAction(item)
    l = lambda item=item: self.doStuff(item)
    action.triggered.connect(l)
    self.connect(action, SIGNAL('triggered()'), l) 
```

这给出了（单击菜单一次）：

> 项目：假（action.triggered.connect(l) 行，错误） 项目：一（self.connect 行，对）

为什么这两个行为不同？我以前从未注意到这两种连接之间有什么区别，直到我使用了这个 lambda 构造。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T20:56:52.813

这不是关于`lambda`，而是关于如何在 Qt 中实现具有默认参数的信号。

```
void triggered(bool = 0) 
```

实际上是两个信号：

```
void triggered(bool)
void triggered() 
```

[PyQt 文档](http://www.riverbankcomputing.co.uk/static/Docs/PyQt4/html/qaction.html#triggered)提到了这个信号的默认重载，`triggered(bool)`因为你的函数接受一个参数，它可以成功地将这个信号连接到你的函数。因此`bool`参数被传递给`item`.

[您可以通过索引语法选择特定的重载](http://www.riverbankcomputing.co.uk/static/Docs/PyQt4/html/new_style_signals_slots.html#connecting-disconnecting-and-emitting-signals)。在这种情况下，您需要没有参数的信号，因此您可以：

```
action.triggered[()].connect(l) 
```

# c++ - createTriangleMesh 未处理异常

> ID：11330392
> 
> 赞同：2
> 
> 时间：2012-07-04T13:48:33.467
> 
> 标签：c++, opengl, physx

我正在使用 PhysX、OpenGL 和 assimp。我在最后一行收到“未处理的异常.....访问冲突读取位置 0x00000”

```
void CreateActor(const aiScene *scene)
{
NxTriangleMeshDesc t;
aiMesh *mesh = scene->mMeshes[0];
t.numVertices = mesh->mNumVertices;
t.points = mesh->mVertices;
t.pointStrideBytes = sizeof(aiVector3D);
t.numTriangles = mesh->mNumFaces;
NxU32 *tr = new NxU32[mesh->mNumFaces*3];
NxU32 k=0;
for(NxU32 i=0;i<mesh->mNumFaces;i++)
    for(int j=0;j<3;j++)
        tr[k++]=mesh->mFaces[i].mIndices[j];
t.triangles = tr;
t.triangleStrideBytes = sizeof(NxU32)*3;
t.flags=0;
NxTriangleMeshShapeDesc terrainShapeDesc; 

 // Cooking from memory
 InitCooking();
 MemoryWriteBuffer buf;
 bool status = CookTriangleMesh(t, buf);
 MemoryReadBuffer readBuffer(buf.data);
 gPhysicsSDK->createTriangleMesh(readBuffer);
} 
```

使用 Assimp::Importer 我在 .x 中阅读了一个简单的立方体，它有 24 个顶点，12 个面。使用 2 for 循环与 'mesh->mFaces[i].mIndices[j]' 的要点是有一个 mNumIndices 与 mIndices

我知道函数 CreateActor 不完整，但错误出现在“createTriangleMesh”（最后一行）上，所以我省略了休息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T07:43:20.013

gPhysicsSDK 为 NULL，所以这就是整个问题。对于任何使用 PhysX 并希望加载各种 3D 模型（.3DS、.X、.obj 等）的人，您可以方便地找到上面的代码（除非您必须遍历所有 aimesh），google assimp。
谢谢泰勒

# google-sheets - 以 FIND 为标准的 SUMIF

> ID：11330396
> 
> 赞同：11
> 
> 时间：2012-07-04T13:48:59.000
> 
> 标签：google-sheets, google-sheets-formula, sumifs

我正在尝试将多个 Google 电子表格中的数据汇总到一张表中，但我在使用 SUMIF 和 FIND 时遇到了一些问题。要汇总另一张表中的数据，我必须使用它（至少这是我找到的唯一解决方案）

```
=SUM(INDIRECT(""&A6&""&"!E2:E")) 
```

我在 A6 上的工作表名称的位置。这使一切变得容易，因为我有一个包含所有工作表名称的列 (A)。我在 Google Docs 中没有找到像 Sheets[1] 这样的东西。

我的下一步是从特定列中求和时间，但删除特定值，在本例中为 1，它在 24:00:00 内部转换，因为它是时间列：

```
=SUM(INDIRECT(""&A6&""&"!D2:D")) - SUMIF(INDIRECT(""&A6&""&"!D2:D");"24:00:00") 
```

在这里，我尝试使用单个 SUMIF 完成所有操作，但我不知道如何操作。NOT("24:00:00") 没有用，所以我解决了这个问题。最后一部分是最困难的，我无法解决。我有一个包含月份名称的列（例如），并且我只想在月份名称包含“er”时汇总一些数据。这是我的想法：

```
=SUMIF(A6:A16,ISNUMBER(Find("er")),G6:G16) 
```

这给了我总是 0（请注意，最后一个包含 A6:A16 而不是整个 INDIRECT 部分，因为我仍在一张纸上测试它。）知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-04T15:38:50.497

我不知道为什么上面的 SUMIF 不起作用，我测试并起作用的是：

```
=SUMIF(A6:A16,"*er*",G6:G16) 
```

SUMIF 不是我想的 SUM + IF。我希望它会帮助别人。

# c++ - 需要多平台归档库

> ID：11330397
> 
> 赞同：2
> 
> 时间：2012-07-04T13:49:08.303
> 
> 标签：c++, archive

我搜索免费的（“LGPL”或类似的东西），多平台存档库（c/c++）

想要的功能：

1）多平台（gcc/msvc）

2）读写

3）Unicode（不是 100% 必要的）

4）加密（不是 100% 必要的）

5）压缩（不是 100% 必要的）

6) 良好的文档

我找到了一些图书馆，但它们是只读的，或者不是真正免费的或其他的

zlib（我认为只压缩）

zziplib（我认为只读）

PhysicalFS（只读）

LZO (GPL 2+)

LZMA SDK（不能在 linux 上构建）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T13:54:08.077

你看过 [http://libarchive.github.com/](http://libarchive.github.com/)

查看[https://github.com/libarchive/libarchive/wiki/LibarchiveFormats](https://github.com/libarchive/libarchive/wiki/LibarchiveFormats)了解支持的格式。适用于posix和windows。

但我通常会选择zlib。世界上最便携的库。

# asp.net - 为什么我的用户角色为空（成员资格）？

> ID：11330402
> 
> 赞同：0
> 
> 时间：2012-07-04T13:49:23.733
> 
> 标签：asp.net, c#-4.0, asp.net-membership

我在 asp.net 4.0 中实现了成员资格，我有 3 个角色（经理、操作员、用户）和 2 个用户（经理、操作员）。经理可以定义用户，我通过以下代码做到这一点：

```
Membership.CreateUser(txtUserName.Text, txtPassword.Text, txtEmail.Text); 
```

我通过以下代码设置其角色：

```
Roles.AddUserToRole(txtUserName.Text, "user"); 
```

现在当用户想要登录时，我通过以下方式检查用户：

```
if(Membership.ValidateUser(txtUserName.Text, txtPassword.Text)){
string[] role = Roles.GetRolesForUser(txtUserName.Text);
.
.
.
} 
```

我检查了角色数组，但它是空的，我无法获取用户的角色，当然当我通过经理或操作员登录时没有问题，现在我的问题是为什么我的用户角色为空？太感谢了！！！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T13:54:46.470

```
if user is logged , you can use directly 

rolesArray = Roles.GetRolesForUser(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T14:07:57.907

您是否已将角色提供程序添加到 web.config？

# variables - Makefile 字符串变量

> ID：11330410
> 
> 赞同：1
> 
> 时间：2012-07-04T13:50:02.910
> 
> 标签：variables, makefile

我需要在我的 Makefile 中创建一个带有空格的变量：

```
CC=$(LFS_TGT)-gcc -B$(TOOLS)/release/lib/ 
```

这样做的正确方法是什么？

**更新：** 我的代码不起作用，我有一个错误，比如 bash 找不到命令 -B$(TOOLS)/release/lib/。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-04T15:58:00.060

如果我猜对了你的意思，包括在变量定义中的额外引用应该可以工作，即：

```
TOOLS = 'dir with spaces'
CC    = $(LFS_TGT)-gcc -B$(TOOLS)/release/lib/ 
```

# symfony - Sonata 管理包，如何使用实体存储库类

> ID：11330413
> 
> 赞同：2
> 
> 时间：2012-07-04T13:50:12.270
> 
> 标签：symfony, symfony-sonata

1.  在 PropertyAdmin 中使用此代码扩展了 Admin ：

    ```
    public function createQuery($context = 'list')
    {   
    $user = $this->getConfigurationPool()->getContainer()->get('security.context')->getToken()->getUser();
    $query = $this->getModelManager()->createQuery($this->getClass(), 'o');
    $query->where('o.Creator=:creator')->setParameter("creator", $user);
    return $query;
    } 
    ```

我能够将“列表”结果限制为“属于”登录管理员的人，即。仅由登录管理员创建的属性（即实体）。

问题：通过手动更改 URL（id 值如 1、2...），我可以编辑属于其他用户的属性。对于编辑操作，根本不调用上述查询。如何改变这种行为？

2.我可以从PropertyRepository 类中获取它而不是将查询放入控制器中吗？这将使我可以为其编写单元测试的模型中保留逻辑。

3.我正在尝试： ProductAdmin 扩展 AdminHelper {....} AdminHelper 扩展 Admin { .... }

但它没有说“无法从“D:_development\rent2\app/config\routing.yml”导入资源“D:_development\rent2\app/config.”。

AdminHelper 是抽象类，但 Sonata 仍然会读取它。有什么解决办法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-13T21:41:47.387

1.a) 为您的对象使用 ACL，[CRUD 控制器](https://github.com/sonata-project/SonataAdminBundle/blob/2.0/Controller/CRUDController.php#L251)具有权限检查。

1.b）重新定义编辑操作，确保用户尝试编辑属于他的属性，类似于[Page Admin Controller](https://github.com/sonata-project/SonataPageBundle/blob/2.0/Controller/PageAdminController.php#L55)，重新定义创建操作

2) 在控制器 $this->getConfigurationPool()->getContainer()->get('doctrine')->getRepository($this->getClass()); 使您可以访问为此模型注册的存储库。可能几乎没有其他方法可以从中获取服务容器和实体管理器。

3）要创建您的管理类，您应该扩展 Sonata Admin: [docs for this](http://sonata-project.org/bundles/admin/2-0/doc/reference/getting_started.html#step-3-create-admin-class)，这个问题似乎与我的奏鸣曲无关。您能否提供 D:_development\rent2\app/config\routing.yml 的内容？

# jquery - 使用jQuery获取数组中的索引以[1]而不是[0]开始

> ID：11330414
> 
> 赞同：2
> 
> 时间：2012-07-04T13:50:14.047
> 
> 标签：jquery

我有以下代码： -

```
var $div = $("#preloader");
$.each($.imgNames, function (i, val) {
    $("<img />").attr("src", $.largePath + val).addClass('PRELOADED').appendTo($div);
}); 
```

是否可以让 jQuery 从 [1] 而不是 [0] 开始索引？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T13:52:14.460

```
$.each($.imgNames, function (i, val) {
    if(i === 0) return true; //in jQuery equivalent to "continue" statement in javascript for-loops 
    // ... rest of your code 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-04T13:52:02.327

只需检查当前索引是否为零，如果为零则不执行任何操作：

```
if (i == 0) {
    return;
}

$("<img ...")... 
```

# php - 如何在运行时合并两个图像并保存在 php 中？

> ID：11330415
> 
> 赞同：-2
> 
> 时间：2012-07-04T13:50:15.083
> 
> 标签：php, gd

我想在框架中上传图片并将图像和框架保存为单个图像，主要是框架中图像的大小，它应该在合并后的最终结果图像中看起来完全相同。这是我的代码的一部分：

```
$imgframe = $_GET['imgframe'];
$imgphoto = $_GET['imgphoto'];

$imgwidth = $_GET['imgwidth'];
$imgheight = $_GET['imgheight'];

$imgleft = substr($_GET['imgleft'],0,-2);
$imgtop = substr($_GET['imgtop'],0, -2);

$src = imagecreatefromjpeg($imgphoto);//'image.jpg'
$dest = imagecreatefrompng($imgframe);//clip_image002.png

imagealphablending($dest, false);
imagesavealpha($dest, true);

imagecopyresampled( 
     $dest, $src, $imgleft, $imgtop, $imgleft, $imgtop,
     $imgwidth, $imgheight, $imgwidth, $imgheight
); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T16:55:28.467

根据您在问题下方的评论，您使用了错误的功能。

[imagecopymerge](http://php.net/manual/en/function.imagecopymerge.php)的 PHP 手册页声明它将图像的一部分复制到另一个图像上。它声明您可以指定要从源复制的区域的原点坐标、宽度和高度，以及放置该区域的目标坐标。

换句话说，它从源图像中取出一个给定大小的矩形区域，并将其放在目标顶部的给定位置。它不询问您要复制它的区域的大小，只询问位置。因此，它不会调整复制区域的大小，而是逐个像素地复制它。

您实际需要的功能是[imagecopyresampled](http://www.php.net/manual/en/function.imagecopyresampled.php)，它允许您指定目标区域的大小，并将平滑地缩放源区域以适应。

**编辑**

您仍然遇到问题，因为您在源和目标参数中使用相同的坐标和相同的尺寸。相同的尺寸 == 没有调整大小。

```
$imgframe = $_GET['imgframe'];
$imgphoto = $_GET['imgphoto'];

// I am assuming these specify the area of the imgphoto which
// should be placed in the frame?
$imgwidth = $_GET['imgwidth'];
$imgheight = $_GET['imgheight'];
$imgleft = substr($_GET['imgleft'],0,-2);
$imgtop = substr($_GET['imgtop'],0, -2);

// now you also need to get the size of the frame so that
// you can resize the photo correctly:
$frameSize = getimagesize($imgframe);

$src = imagecreatefromjpeg($imgphoto);//'image.jpg'
$dest = imagecreatefrompng($imgframe);//clip_image002.png

imagealphablending($dest, false);
imagesavealpha($dest, true);

imagecopyresampled( 
     $dest, $src, 
     0, 0, // these two specify where in the DESTINATION you want to place the source.  You might want these to be offset by the width of the frame
     $imgleft, $imgtop, // the origin of area of the source you want to copy
     $frameSize[0], $frameSize[1], // These specify the size of the area that you want to copy IN TO (i.e., the size in the destination), again you might want to reduce these to take into account the width of the frame
     $imgwidth, $imgheight // the size of the area to copy FROM
); 
```

# iphone - 在 uiscrollview 中以编程方式缩放时内容偏移量意外更改

> ID：11330416
> 
> 赞同：0
> 
> 时间：2012-07-04T13:50:15.910
> 
> 标签：iphone, ios, ipad

当我在缩放 3.7 之后缩放时，我的缩放比例为 1.0 - 4.0，内容偏移意外更改为最后一个可见的矩形（右下）。

如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T05:13:20.530

缩放后根据视图大小移动滚动视图的原点。

```
 - (void)scrollViewDidEndZooming:(UIScrollView *)scrollView withView:(UIView *)view atScale:(float)scale {

     CGFloat vPadding;
     CGFloat hPadding;
     if ((480-view.frame.size.height)/2 > 0) {
          vPadding=(480-view.frame.size.height)/2;
     }
     else{
          vPadding=0;
     }
     if ((320-view.frame.size.width)/2 > 0) {
          hPadding=(320-view.frame.size.width)/2;
     }
     else{
          hPadding=0;
     }
     yourView.frame = CGRectMake(hPadding, vPadding, view.frame.size.width, view.frame.size.height);

} 
```

或相应地更改滚动视图中心。

# c# - 如何循环遍历类的子属性？

> ID：11330419
> 
> 赞同：0
> 
> 时间：2012-07-04T13:50:35.957
> 
> 标签：c#, list, loops, reflection, properties

我有一个客户端类，其中一个属性是电子邮件，它是一个字符串列表。我可以遍历类的属性以输出值，但是当它到达 Emails 属性时，它不会遍历电子邮件，因为它需要对列表进行另一个循环。

```
foreach (PropertyInfo prop in oClient.GetType().GetProperties())
{
    if (prop.Name.ToUpper().ToString() == "EMAILS")
    {
        //need code to loop through emails
    }
    else
    {
        Response.Write("<b>" + prop.Name.ToString() + "</b>: " + prop.GetValue(oClient, null) + "<br />");
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T13:54:33.280

您可以使用读取电子邮件的值

```
Object emails = prop.GetValue(oClient, null); 
```

然后遍历它，例如

```
IEnumerable<String> emailsEnumerable = emails as IEnumerable<String>;
if (emailsEnumerable != null) {
    foreach(string emailValue in emailsEnumerable) {
        // ...
    }
} 
```

# jquery - jquery单击选择并启用/禁用输入按钮

> ID：11330420
> 
> 赞同：1
> 
> 时间：2012-07-04T13:50:40.347
> 
> 标签：jquery, html, forms

我有一页上有几个带有选择/输入按钮的表单。我想单击一个选择表单，获取它的 id，然后在具有相同名称的按钮上切换禁用，除了它的类不是 id。

到目前为止我的代码：

```
$("#main").on("click",".list", function () {
        var j = $(this).attr("id");
        if(j) {alert(j);}
        $("."+j).attr('disabled','disabled');
    }); 
```

我似乎无法参考`"."+j`任何想法？

```
<h2>Towns / Suburbs</h2>
        <form method="POST" action="">

        <select class="list" name="data_change" id="towns" size=10>
            <option>foo</option><option>bar</option>
        </select>

        <div class="buttonGroup">
<input type="submit" class="button" name="Delete" value="Delete">
<input type="submit" class="button" name="Add" value="Add">
<input type="submit" class="button" name="Edit" value="Edit" class="towns">
</div>
        </form> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T14:08:12.380

你不能有两个类属性，如果你有多个类，用空格分隔它们。

```
<input type="submit" class="button towns" name="Edit" value="Edit" /> 
```

# json - 在 sencha touch 2 应用程序启动时下载 json

> ID：11330422
> 
> 赞同：1
> 
> 时间：2012-07-04T13:50:57.463
> 
> 标签：json, extjs, sencha-touch-2

我是 Sencha touch 的新手，我想知道是否在启动 Sencha touch 2 应用程序时向服务器发送请求，接收 application/json 文件并将其存储在本地，然后在每次服务器时都使用它而不请求? 如果有教程就好了。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T15:33:53.410

[单击此处](http://docs.sencha.com/touch/2-0/#!/api/Ext.data.Store)查看如何配置您的商店的第一个视图。

如果您希望您的商店在启动时自动加载数据，请不要忘记设置`autoLoad: true`配置。

# javascript - 如何仅使用 Datepicker Jquery 启用月份的最后几天？

> ID：11330423
> 
> 赞同：5
> 
> 时间：2012-07-04T13:50:59.707
> 
> 标签：javascript, jquery, jquery-ui, datepicker

所以我的问题很简单。我想在日期选择器上启用特定日期，例如[http://tokenposts.blogspot.fr/2011/05/jquery-datepicker-disable-specific.html](http://tokenposts.blogspot.fr/2011/05/jquery-datepicker-disable-specific.html)但我只想要任何一个月的最后一天，例如 2012 年 6 月 30 日、2012 年 7 月 31 日、...

有什么线索吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-04T13:53:44.010

这就是你可以做到的......

获取给定年份和月份的最后一天：

```
function getLastDayOfYearAndMonth(year, month)
{
    return(new Date((new Date(year, month + 1, 1)) - 1)).getDate();
} 
```

[`beforeShowDay`](http://jqueryui.com/demos/datepicker/#event-beforeShowDay)如果日期是上个月的一天，请检查事件：

```
$('.selector').datepicker(
{
    beforeShowDay: function(date)
    {
        // getDate() returns the day [ 0 to 31 ]
        if (date.getDate() ==
            getLastDayOfYearAndMonth(date.getFullYear(), date.getMonth()))
        {
            return [true, ''];
        }

        return [false, ''];
    }
}); 
```

# php - 创建发票 (php)

> ID：11330431
> 
> 赞同：0
> 
> 时间：2012-07-04T13:51:24.397
> 
> 标签：php, javascript

我正在创建与我的药房合作的 ERP 系统。在该系统的计费表单中，我想添加项目并打印账单。我有一个小问题，我在哪里可以保存我的第一个项目信息，而我正在向它添加第二个项目.. 我的账单表格是这样的（只有一个虚拟）

```
<table width="490" height="282" border="0">
    <tr>
      <td width="206">Date</td>
      <td width="160">&nbsp;</td>
      <td width="47">&nbsp;</td>
      <td width="69">&nbsp;</td>
    </tr>
    <tr>
      <td>Bill Number</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td>Item Code</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td>Item Name</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td>Expier Date</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td>Item Price</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td>&nbsp;</td>
      <td>Each</td>
      <td>Total</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td>&nbsp;</td>
      <td><input type="submit" name="adnother" id="adnother" value="add another item" tabindex="5" /></td>
      <td><input type="submit" name="submit" id="submit" value="Submit" /></td>
      <td>&nbsp;</td>
    </tr>
  </table> 
```

在将项目一一添加到此表单时，我希望这些项目以我能做到的任何方式显示在同一页面上的单独窗口中（账单的可打印版本）。我遇到的最大问题是我之前所说的。{对不起我的英语不好：P}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T13:54:13.747

您可以将数据存储在会话、数据库或 PHP 提供的任何其他机制中，以在请求之间持久化数据。有关会话，请参阅 PHP 手册。

关于窗口 - 您可以简单地拥有一个页面，显示表格，并使用 JavaScript 的 `window.open(...)`方法在其他浏览器窗口中打开表单。

提交添加窗口时，您可能希望刷新账单窗口 - 请参阅`window.onclose()`和`window.refresh()`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T13:58:52.993

`DataBase`在构建时如何管理发票？

这样您就可以查看所有过去的发票。如果需要，它还允许您保存不完整的发票以供以后使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-04T14:02:42.290

您的问题类似于购物车问题，大多数 php 系统通过将其存储在会话中来管理它，并可选择将其保存在数据库中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-04T16:44:01.700

我认为最好的方法是使用多维数组来创建会话。现在我正在努力。会看到..谢谢大家的宝贵意见向你们致敬

# windows-phone-7 - 如何将 textBlock 控件传递给类

> ID：11330435
> 
> 赞同：0
> 
> 时间：2012-07-04T13:51:40.910
> 
> 标签：windows-phone-7

假设我有一个 textBlock 控件，我想将它传递给一个控制 textBlock 以显示某些消息的类。

1）当我在类中调用方法时，我希望 textBlock 显示消息。示例“检查连接....”

2) 当方法完成所需任务时，textBlock 可见性变为折叠。

在 XAML 中：我有

a) textBlock name=textBlockMsg b) 调用类的按钮

感谢你的帮助。

- 更新 ：

项目内的这个类文件

```
公共类地理计算
{

     公共地理计算（）{}

  公共无效计算距离（）
  {
        //- 开始 -- 想要 textBlockMsg 显示：进行中......

       - 代码

     //--- 当结束时-----，textBlockMsg 可见性变为折叠

   }

}

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T14:05:33.503

如果您`TextBox`在`XAML`with中命名您`textBlockMsg`，这将起作用

**编辑** // 我不会实现整个 INotifyPropertyChanged 检查如何处理它：[实现](http://msdn.microsoft.com/en-us/library/ms229614.aspx)

```
public class CalculationClass : INotifyPropertyChanged    
{
      public void  CalculateDistance()
      {
       TextToBeBound = "in progress..."

       --code 

       VisibilityToBeBound = Collapsed;

      }
      public string TextToBeBound
      {  //... insert the implement of this property + NotifyPropertyChanged
        get {...} 
        set {...}
      }

      public Visibility VisibilityToBeBound
      {  //... insert the implement of this property + NotifyPropertyChanged
        get {...} 
        set {...}
      }

} 
```

然后在 XAML 中添加：

```
<TextBlock x:Name="txtBlocMsg"  Visibility={"Binding VisibilityToBeBound"}  Text={Binding TextToBeBound"}/> 
```

不要忘记将`DataContext`UI 设置为您的班级（在我的情况下`CalculationClass`

你应该很高兴。如果这一切都是新的。我建议您阅读有关数据绑定 + MVVM 模式的信息。

**编辑** 将 UI 元素传递给模型/业务类是不好的做法。您应该使用 MVVM 模式。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T14:18:07.083

1.  您可以有一个参数来传递 TextBock：

    公共无效CalculateDistance（TextBlock tb）{tb.Text =“正在进行中......”

    - 代码

    tb.Visibility = Visibility.Collapsed; }

2.  你可以使用你的类的构造函数来注入它应该处理的文本块

    公共类 GeoCalculation { 私有 TextBlock _tb;

    ```
    public GeoCalculation(TextBlock tb)
    {
        _tb = tb;
    }

    public void  CalculateDistance()
    {
        _tb.Text = "in progress..."

       //code 

       _tb.Visibility = Visibility.Collapsed;
    } 
    ```

    }

顺便说一句，ViewModel 和使用 DataBinding 会更好！在那里，您可以使用我们的类（方法）为 ui（文本框）提供文本

但请注意：有一种 .net 方法可以做到这一点。GeoCoordinate 类包含一个方法“GetDistanceTo”来计算两个地理点之间的距离。请参阅[http://msdn.microsoft.com/en-us/library/system.device.location.geocoordinate.getdistanceto.aspx](http://msdn.microsoft.com/en-us/library/system.device.location.geocoordinate.getdistanceto.aspx)。

# php - 对齐li元素内的文字和图片PHP

> ID：11330443
> 
> 赞同：0
> 
> 时间：2012-07-04T13:51:58.120
> 
> 标签：php, mysql, list, drop-down-menu, alignment

**你好，**

我在 li 元素内对齐文本和图片时遇到问题。**li**由一个单词和一张图片组成（例如英语 [picture]）。我需要那张图片会转到右侧，而文字会保持原样（现在它会转到左侧）。代码如下所示：

```
 for($i=0; $i < $rowCount; $i++){        
?>
<li><a href="?lang=<?php echo $l[$i]?>"><?php echo $i?><img src="/flags/flag_of_lithuania.gif" width="20" height="10"> </a></li>
<?php
} 
```

现在它打印语言和图片，但所有内容都与左侧对齐。**寻求任何帮助:)**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T13:53:44.700

试试这个

```
 for($i=0; $i < $rowCount; $i++){        
?>
<li><a href="?lang=<?php echo $l[$i]?>"><?php echo $i?><img style="float:right" src="/flags/flag_of_lithuania.gif" width="20" height="10"> </a></li>
<?php
} 
```

# jquery - 获取最近添加到列表 Jquery 中的 li 项的值

> ID：11330454
> 
> 赞同：4
> 
> 时间：2012-07-04T13:52:26.610
> 
> 标签：jquery, jquery-ui

我正在使用带有 JqueryUI 的可排序。我正在尝试获取我刚刚放入接收列表的当前项目。然而，$(this).text() 的回声揭示了列表中所有项目的值。有任何想法吗？

```
$(function() {
    var lists = [{"listid":"#all-colls-list", "connectid":"#coll-selected-list", "drop":true},
     {"listid":"#coll-selected-list", "connectid":"#all-colls-list", "drop":true}];
$.each(lists, function(i, list) {
        $(list.listid).sortable({
            connectWith: list.connectid,
            dropOnEmpty: list.drop,

    $( "#coll-selected-list" ).sortable({
           remove: function(event, ui) { 

           },
           receive: function(event, ui) { 
                alert($(this).text());
           }
        });

}
        });
    });
});
<ul id="all-colls-list" class="droptrue sort-drop ui-sortable">
      <li class="sorted">apple</li>
      <li class="sorted">pear</li>
      <li class="sorted">banana</li>
      <li class="sorted">grape</li>
      <li class="sorted">guava</li>
</ul>

<ul id="coll-selected-list" class="droptrue sort-drop ui-sortable">
</ul>

<ul id="coll-grouped-list">
</ul>​ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T14:02:38.973

从`sortable`文档中：

> ui.item - 当前拖动的元素

[http://jqueryui.com/demos/sortable/](http://jqueryui.com/demos/sortable/)

使用示例（史蒂夫在他的小提琴中友情发布）：

```
$(ui.item).text() 
```

# php - php 致命错误的 error_reporting 编号是多少？

> ID：11330456
> 
> 赞同：3
> 
> 时间：2012-07-04T13:52:32.343
> 
> 标签：php, apache, .htaccess, error-handling

我目前在我的 htaccess 中有这个设置：

php_value error_reporting -1

我希望日志只记录致命错误。我用什么替换 -1 来做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-04T14:08:42.443

您始终可以将多个标志与位运算符结合使用。

```
echo E_ERROR | E_CORE_ERROR | E_COMPILE_ERROR; 
```

`OR`很容易：它只是`1 + 16 + 64 = 81`.

[您可以在位运算符手册页上找到位](http://php.net/language.operators.bitwise)[`error_reporting()`](http://php.net/function.error-reporting)运算符的手册页以及关于位运算符的示例。

作为旁注：无论如何，您都无法记录`E_CORE_ERROR`或`E_COMPILE_ERROR`使用 PHP，因为它们发生在PHP 启动过程*之前*或*期间。*

# php - 卡住了正则表达式

> ID：11330462
> 
> 赞同：0
> 
> 时间：2012-07-04T13:52:45.997
> 
> 标签：php, regex

我要匹配的模式是`[{Any text between here}]`

我的正则表达式：

```
/\[\{[\W\w]*?\}\]/ 
```

我在用`preg_match_all()`

到目前为止它正在工作，但我想知道是否有更好的解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T13:56:43.587

如果要查找包含的匹配项，`[{`然后`}]`使用

```
/\[\{[^}]+\}\]/ 
```

如果您只想在文本内匹配，请使用

```
/(?<=\[\{)[^}]+(?=\}\])/ 
```

如果里面的文本可能包含`}`字符（例如*[{hello}yellow}]* ），则在上述两种正则表达式模式中替换`[^}]+`为。`.+?`原始模式具有更好的性能，因为它们没有使用惰性运算符`?`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-04T13:57:56.813

您可以将其简化为

```
\[\{.*?\}\] 
```

甚至

```
\[{.*?}] 
```

但除此之外，它看起来还不错。

* * *

**编辑**

请注意，虽然正则表达式执行所需的操作，但由于使用了惰性运算符，因此性能不是最佳的。

当通过 RegexBuddy 之类的工具查看时，这个正则表达式需要**21 个步骤**才能得出一个解决方案，而 @Ωmega 的解决方案只需要**5 个步骤**。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-04T13:55:58.590

使用这个正则表达式`(?<=\[\{)(.+?)(?=\}\])`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-04T13:59:01.757

*键“U”使正则表达式引擎不贪心：*

```
preg_match_all('_\[{.*}\]_U', '[{safda}adsfsf}}][{safda}adsfsf}}]', &$matches); 
```

*给出* `$matches`*：*

```
Array
(
    [0] => Array
        (
            [0] => [{safda}adsfsf}}]
            [1] => [{safda}adsfsf}}]
        )

) 
```

# android - 使用自定义 ArrayAdapter 自定义 Android ListView 项

> ID：11330463
> 
> 赞同：1
> 
> 时间：2012-07-04T13:52:50.923
> 
> 标签：android

我一直在浏览以下示例：

[http://www.ezzylearning.com/tutorial.aspx?tid=1763429](http://www.ezzylearning.com/tutorial.aspx?tid=1763429)

这是一个`ListView`使用`Custom ArrayAdapter`.

* * *

一切都是静态的，但我没有动态地得到它：

```
Weather weather_data[] = new Weather[]
    {
        new Weather(R.drawable.weather_cloudy, "Cloudy"),
        new Weather(R.drawable.weather_showers, "Showers"),
        new Weather(R.drawable.weather_snow, "Snow"),
        new Weather(R.drawable.weather_storm, "Storm"),
        new Weather(R.drawable.weather_sunny, "Sunny")
    }; 
```

* * *

对于动态数据，它说：

```
Weather weather_data[] = youservice.GetWeatherData(); 
```

* * *

你可以举一个例子如何实施`youservice.GetWeatherData();`

我已经尝试了很多事情，但没有管理它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T04:39:43.207

我刚刚找到了一种方法：

```
 Weather weather_data[] = new Weather[6] ;

    for (int  i= 0; i < 6; i++){
       weather_data[i] = new Weather("A","B");
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T14:07:54.377

例子很好。当你得到你的数组时，只需将它传递给你的自定义列表视图适配器。

```
private ListView mCustomListView;

CustomListViewAdapter adapter = new CustomListViewAdapter(context, weather_data);
mCustomListView.setAdapter(adapter);
mCustomListView.requestFocus(); 
```

适配器将不得不做其余的事情。如果你想要一个 youservice.GetWeatherData() 的实现，你需要将你的问题分成更小的块。例如： - 如何创建 REST Web 服务， - 如何建立 http 连接并发送“get”请求， - 如何解析响应流？

**编辑 1**

您不需要替换数组中的数据，读取 Json 创建新数组并将其传递给适配器。

```
List<WeatherItem> weatherList = getWeatherFromJson();
weather_data = new Weather[weatherList.size()];
weather_data = weatherList.toArray(weather_data ); 
```

// 从上面

CustomListViewAdapter 适配器 = new CustomListViewAdapter(context, weather_data); ……

# javascript - 电话差距 - 是否可以运行外部 *.jar 文件？

> ID：11330466
> 
> 赞同：1
> 
> 时间：2012-07-04T13:53:16.073
> 
> 标签：javascript, android, cordova

我必须将我的应用程序与放入 jar 文件的代码集成 - 是否可以在 phonegap 和 *.jar 文件之间建立通信，以便我可以从该文件运行一些方法？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T14:11:22.583

这个问题实际上有两个部分。

首先，您可以创建一个 phonegap 插件来与自定义 java 代码进行交互。在您的情况下，这将是使用罐子的“胶水”。

其次，如果 jar 在编译时可用，则需要将其添加到项目中以便它包含在构建中，或者如果它仅在运行时可用（并且包含已编译的 dex 类，而不是可移植的 java 类）您使用 dex 类加载器加载它并通过反射调用它。但是，如果它是用于桌面使用的随机 jar，您将无法使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T14:07:27.650

是的。

您可以在 Android PhoneGap Activity 代码中注册回调，以便您的 JS 中的 javascript 调用可以从您自己的 jar 中调用您的自定义 Java 代码，或者只是在 Android 应用程序中编译成 java 代码。

您可以在 Android Activity 代码中一次性完成此操作，或者您可以只编写一个[PhoneGap 插件](http://wiki.phonegap.com/w/page/36753494/How%20to%20Create%20a%20PhoneGap%20Plugin%20for%20Android)

# ruby-on-rails - 如何在没有 eval 的情况下运行这行 ruby 代码？

> ID：11330470
> 
> 赞同：1
> 
> 时间：2012-07-04T13:53:30.100
> 
> 标签：ruby-on-rails, ruby

我有以下一段代码，其中 params[:sort] 是一个变量，其值为 m 的列之一。

```
eval "@movie = @movie.sort_by { |m| m.#{params[:sort]}}" 
```

基本上我想根据指定的列对数组@movie 进行排序。有没有办法在没有评估的情况下做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-04T13:54:51.980

```
@movie = @movie.sort_by { |m| m.send(params[:sort])} 
```

例如，您需要进行消毒`params[:sort]`以防止呼叫`destroy`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T14:12:37.453

如前所述，您应该使用`send`并且在使用时`params`（我假设是 Rails），您可能应该检查该方法是否存在以避免`NoMethodError`异常，甚至更好的是，针对白名单进行测试以防止某些用户使用它来获取他们不应该拥有的数据。

```
# Just for the example :
valid_sort_methods = Movie.new.attributes.keys - Movie.protected_attributes.to_a

if valid_sort_methods.include? params[:sort]
  @movie = @movie.sort_by { |m| m.send params[:sort] }
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T14:02:44.460

您可以使用`send`来调用访问器方法。根据来自哪里`params[:sort]`以及应用了何种消毒，这仍然可能是危险的。你不会想`params[:sort]`成为`destroy`例子。

如果您只打算读取属性，那么最简单的方法可能是调用`read_attribute`，它也有别名`[]`，例如

```
@movie = @movie.sort_by { |m| m[params[:sort]]} 
```

# c++ - 寻找 Platform SDK SSPI(Schannel) 示例 c++

> ID：11330471
> 
> 赞同：3
> 
> 时间：2012-07-04T13:53:33.203
> 
> 标签：c++, sample, sspi, schannel

我想看一个演示如何将 SSPI 与 Schannel 一起使用的 Microsoft 示例。
正如我[在这里](http://msdn.microsoft.com/en-us/library/windows/desktop/aa378828%28v=vs.85%29.aspx)看到的那样，有一个这样的样本，但我找不到它:(
有人可以帮我找到它吗？

提前致谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-16T20:27:48.737

[Windows® Server 2003 SP1 Platform SDK ISO 安装](http://www.microsoft.com/en-us/download/details.aspx?id=15656)中有 WebServer 和 WebClient 示例`Microsoft Platform SDK\Samples\Security\SSPI\SSL`。

# wcf - WCF 工作流托管在 IIS 问题上

> ID：11330472
> 
> 赞同：0
> 
> 时间：2012-07-04T13:53:34.707
> 
> 标签：wcf, iis

我在 IIS 上托管了 WCF WF。从客户端我试图访问 IIS 上的服务，但收到这样的错误：

`The formatter threw an exception while trying to deserialize the message: Error in deserializing body of request message for operation 'GetData'. The maximum string content length quota (8192) has been exceeded while reading XML data. This quota may be increased by changing the MaxStringContentLength property on the XmlDictionaryReaderQuotas object used when creating the XML reader. Line 197, position 41.`

这是我的 web.config：

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <configSections>
    <sectionGroup name="applicationSettings" type="System.Configuration.ApplicationSettingsGroup, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" >
      <section name="DataAccess.SharePoint.Properties.Settings" type="System.Configuration.ClientSettingsSection, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" requirePermission="false" />
    </sectionGroup>
  </configSections>
  <system.web>
    <compilation debug="true" targetFramework="4.0" />
  </system.web>
  <system.serviceModel>
    <behaviors>
      <serviceBehaviors>
        <behavior>
          <!-- To avoid disclosing metadata information, set the value below to false and remove the metadata endpoint above before deployment -->
          <serviceMetadata httpGetEnabled="true"/>
          <!-- To receive exception details in faults for debugging purposes, set the value below to true.  Set to false before deployment to avoid disclosing exception information -->
          <serviceDebug includeExceptionDetailInFaults="false"/>
        </behavior>
      </serviceBehaviors>
    </behaviors>
    <serviceHostingEnvironment multipleSiteBindingsEnabled="true" />
  </system.serviceModel>
  <system.webServer>
    <modules runAllManagedModulesForAllRequests="true"/>
  </system.webServer>
  <applicationSettings>
    <DataAccess.SharePoint.Properties.Settings>
      <setting name="DataAccess_SharePoint_Officecms_Lists" serializeAs="String">
        <value>http://site/_vti_bin/lists.asmx</value>
      </setting>
    </DataAccess.SharePoint.Properties.Settings>
  </applicationSettings>
</configuration> 
```

这是我的客户端 app.config：

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
    <system.serviceModel>
        <bindings>
            <basicHttpBinding>
                <binding name="BasicHttpBinding_IService" closeTimeout="00:01:00"
                    openTimeout="00:10:00" receiveTimeout="00:10:00" sendTimeout="00:10:00"
                    allowCookies="false" bypassProxyOnLocal="false" hostNameComparisonMode="StrongWildcard"
                    maxBufferSize="2147483647" maxBufferPoolSize="2147483647"
                    maxReceivedMessageSize="2147483647" messageEncoding="Text"
                    textEncoding="utf-8" transferMode="Buffered" useDefaultWebProxy="true">
                    <readerQuotas maxDepth="32" maxStringContentLength="2147483647"
                        maxArrayLength="2147483647" maxBytesPerRead="2147483647" maxNameTableCharCount="2147483647" 
                                  />
                    <security mode="None">
                        <transport clientCredentialType="None" proxyCredentialType="None"
                            realm="" />
                        <message clientCredentialType="UserName" algorithmSuite="Default" />
                    </security>
                </binding>
            </basicHttpBinding>
        </bindings>
        <client>
            <endpoint address="http://server2008/Services/Search.xamlx"
                binding="basicHttpBinding" bindingConfiguration="BasicHttpBinding_IService"
                contract="SearchService.IService" name="BasicHttpBinding_IService" />
        </client>
    </system.serviceModel>
</configuration> 
```

您能否验证我的配置，并修改并解释我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T19:28:39.523

您是在服务器上还是在客户端上收到此消息？如果从客户端到服务器的消息大于默认限制，则需要在 web.config 中增加该限制。

您可以通过将其添加到 system.ServiceModel 部分来控制 web.config 中的绑定：

```
 <bindings>
      <basicHttpBinding>
        <binding>
          <readerQuotas maxStringContentLength ="<your max here>"/>
        </binding>
      </basicHttpBinding>
    </bindings> 
```

# kendo-ui - 如何在 Kendo UI Grid 中动态更改页面大小

> ID：11330474
> 
> 赞同：18
> 
> 时间：2012-07-04T13:53:40.993
> 
> 标签：kendo-ui, kendo-grid

我有一个显示超过 1000 个数据的 Kendo UI 网格。我还有一个用于不同页面大小的下拉列表 - 15、25、50、100。在选择页面大小时，我们如何更改 Kendo UI 网格的页面大小？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-07-10T22:52:13.960

这是最新的使用 ASP.NET MVC Helper

```
.Pageable(pager => pager.PageSizes(new int[] {20, 50, 100})) // Enable paging 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-07-05T13:40:49.320

您可以在组合框更改事件中设置页面大小。（另见[JSBin 示例](http://jsbin.com/umejit/edit#source)。）

```
$("#comboBox").kendoComboBox({
    dataTextField: "text",
    dataValueField: "value",
    dataSource: [
        { text: 1 },
        { text: 2 },
        { text: 3 },
        { text: 4 },
        { text: 5 }
    ],
    change: function(e) {
      var grid = $("#grid").data("kendoGrid");
      grid.dataSource.pageSize(parseInt(this.value()));  // this.value() being the value selected in Combo
    }
}); 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2012-08-01T13:51:07.360

通过在 js 中执行以下操作，它还内置到最新版本的网格中

```
pageable: {
    pageSizes: [10, 25, 50, 100]
} 
```

[http://docs.kendoui.c​​om/api/web/pager](http://docs.kendoui.com/api/web/pager)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-10-09T18:25:24.630

Rick 以一种很好的方式告诉了它，如果有人错过了在哪里完成，这是一个代码片段，可以通过屏幕短[快照知道在哪里完成](http://prntscr.com/4ukkcs)

```
@(Html.Kendo().Grid(Model)
      .Name("SiteUserGrid")
      .Columns(columns =>
          {
              columns.Bound(u => u.LastName).Title("Last Name");
              columns.Bound(u => u.FirstName).Title("First Name");
              columns.Bound(u => u.UserName).Title("User Name");
              columns.Bound(u => u.EmailAddress).Title("Email Address");
              columns.Bound(u => u.AccessLevel).Title("Access Level");
              columns.Bound(u => u.Status).Title("Status");
              columns.Bound(u => u.UserId).Filterable(f => f.Enabled(false)).ClientTemplate(actionColumnTemplate).Title("Action").Sortable(false).Width(190);
          })
      .Pageable(pageable => pageable.ButtonCount(10)) 
```

## .Pageable(pager => pager.PageSizes(new int[] {5,10,15,20,30,50,100}))

```
 .Selectable(selectable => selectable.Mode(GridSelectionMode.Single))
      .Sortable()
      .Filterable(filterable => filterable
                                    .Extra(false)
                                    .Operators(operators => operators
                                                                .ForString(str => str.Clear()
                                                                                     .StartsWith("Starts with")
                                                                                     .Contains("Contains")
                                                                                     .IsEqualTo("Is equal to")
                                                                )) 
```

希望这可以帮助

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-03-18T17:35:43.907

要扩展[Rick Glos 的答案](https://stackoverflow.com/a/17582299/1677912)：

您可以将 Pageable PageSizes 设置为一组通用对象，因此您可以拥有“全部”选项，而无需在 JavaScript 中设置 pageSizes。

```
.Pageable(pager => pager.PageSizes(new object[] {20, 50, 100, "All"})) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-12-13T01:26:16.110

[http://docs.kendoui.c​​om/api/wrappers/php/Kendo/UI/GridPageable](http://docs.kendoui.com/api/wrappers/php/Kendo/UI/GridPageable)

```
$pageable = new \Kendo\UI\GridPageable();
$pageable->pageSizes(array(20,50,100)); 
```

# php - 剥离 php 变量，用破折号替换空格

> ID：11330480
> 
> 赞同：76
> 
> 时间：2012-07-04T13:54:00.650
> 
> 标签：php

如何将 PHP 变量从“My company & My Name”转换为“my-company-my-name”？

我需要全部小写，删除所有特殊字符并用破折号替换空格。

* * *

## 回答 #1

> 赞同：258
> 
> 时间：2012-07-04T13:56:26.803

此函数将创建一个 SEO 友好的字符串

```
function seoUrl($string) {
    //Lower case everything
    $string = strtolower($string);
    //Make alphanumeric (removes all other characters)
    $string = preg_replace("/[^a-z0-9_\s-]/", "", $string);
    //Clean up multiple dashes or whitespaces
    $string = preg_replace("/[\s-]+/", " ", $string);
    //Convert whitespaces and underscore to dash
    $string = preg_replace("/[\s_]/", "-", $string);
    return $string;
} 
```

应该没事 ：）

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-07-04T14:33:50.310

是的，如果你想处理任何特殊字符，你需要在模式中声明它们，否则它们可能会被清除。你可以这样做：

```
strtolower(preg_replace('/-+/', '-', preg_replace('/[^\wáéíóú]/', '-', $string))); 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-07-04T14:06:34.793

替换特定字符： [http ://se.php.net/manual/en/function.str-replace.php](http://se.php.net/manual/en/function.str-replace.php)

例子：

```
function replaceAll($text) { 
    $text = strtolower(htmlentities($text)); 
    $text = str_replace(get_html_translation_table(), "-", $text);
    $text = str_replace(" ", "-", $text);
    $text = preg_replace("/[-]+/i", "-", $text);
    return $text;
} 
```

# android - 如何在 Android 视图中实现类似拼字游戏的效果

> ID：11330484
> 
> 赞同：1
> 
> 时间：2012-07-04T13:54:09.847
> 
> 标签：android, layout, nested-views

我们有一个在 Android 下运行的游戏的想法，我一直在玩一些视图，但无法想出足够的东西。

游戏的理念是一个固定大小的矩阵，该矩阵中的每个单元格都可以容纳一个类似于 Scrabble 拼字游戏的拼图。

我的意思是瓷砖上有一个字母和一个分数。这封信占据了大部分的瓷砖，分数是角落里的一点点文字（没有批评我的图形技能，这不是最终产品）：

```
+---------+     +---------+
|   #     |     | ####    |
|  # #    |     | #   #   |
| #   #   |     | ####    |
| #####   |     | #   #   |
| #   #   |     | ####    |
|       17|     |       22|
+---------+     +---------+ 
```

与 Scrabble 不同，图块的分数与其字母值无关，因此我们需要能够用*任意*字母和分数填充图块。

我一直在使用 textviews 并试图将它们变成一个网格，每个单元格周围都有边框（带有背景图像），但我似乎无法让视图中的视图正常工作，我相信我需要确保边框围绕两个 textviews .

我尝试使用一个表格，每个单元格也是一个表格，包含字母和分数。但我无法得到满意的结果。

字母/分数组合的数量会非常高，所以我不愿意为每个可能的图块创建图像。

有没有其他人遇到过类似的问题，解决它的最佳方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-04T14:00:46.740

您将最快地只创建字母（不是组合）

创建一个名为 TileView 的视图，它实现了 imageview 并使用开发人员指南中描述的 2d 方法在 tile 角上绘制分数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T14:14:47.537

我想我误会了什么...

但它是一个简单的 customView，带有一个可以设置样式的 Textview，在相对布局中，在父级的右下角，另一个 TextView 带有另一个样式的 textView。

然后，您可以将此组件添加到游戏的每个图块中。

对于磁贴，您可以将资产用作背景或在 xml 中定义它。

# javascript - 设置 CORS 不起作用

> ID：11330485
> 
> 赞同：0
> 
> 时间：2012-07-04T13:54:11.160
> 
> 标签：javascript, cors

我在服务器上设置了以下标头

```
response.addHeader("Access-Control-Allow-Origin", "*");
response.addHeader("Access-Control-Allow-Methods", "GET, POST, PUT");
response.addHeader("Access-Control-Allow-Headers","X-Custom-Header"); 
```

我想使用 POST 方法访问 Web 服务并向其发送数据，但问题是我与服务器的设置导致问题

我使用了以下方法

```
function createCORSRequest(method, url) {
    var xhr = new XMLHttpRequest();
    if ("withCredentials" in xhr) {
        // XHR for Chrome/Safari/Firefox.
        xhr.open(method, url, true);
    }
    else if (typeof XDomainRequest != "undefined") {
        // XDomainRequest for IE.
        xhr = new XDomainRequest();
        xhr.open(method, url);
    } else {
        // CORS not supported.
        xhr = null;
    }
    return xhr;
} 
```

并基于此对象

```
url = "http://myurl.do";
var xhr = createCORSRequest('POST', url);
if (!xhr) {
    alert('CORS not supported');
    return;
}
var params = "name=pari123&action=initaction&gameId=slotreel3";
xhr.setRequestHeader('Content-Type', 'application/text/plain'); 
if(xhr.readyState == 4 && xhr.status == 200) 
{
    alert('Tested OK')
    xhr.send(params);
}
else
{
    alert('status not 200 or xhr is not ready');
}

// Response handlers.
xhr.onload = function() {
    var text = xhr.responseText;
    alert('Response from CORS request to ' + url + ': ' + text);
};

xhr.onerror = function() {
    alert('Woops, there was an error making the request.');
}; 
```

但它总是会提醒一条消息，说“状态不是 200 或 xhr 未准备好”，如果您知道，我无法继续任何人，请帮忙！

当我打印`xhr.readyState`它的打印值为 1

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T19:18:25.980

这里可能有几个问题。

我观察到不同的浏览器以不同的方式实现 CORS。我的经验基于 Firefox 和 Google Chrome。例如，我必须在服务器端添加一个特殊的标头，以便 Firefox 像 Google Chrome 那样使用一个连接发出预检（OPTIONS）请求和实际请求（GET、PUT 等）。您必须在服务器端添加：

```
response.addHeader("Keep-Alive", "timeout=2, max=100");
response.addHeader("Connection", "Keep-Alive"); 
```

我还注意到某些浏览器不喜欢 CORS 标头中的通配符（“*”）。该行的解决方法

```
response.addHeader("Access-Control-Allow-Origin", "*"); 
```

将返回请求的来源而不是通配符。

但是，也可能存在其他问题，我们需要更多详细信息。例如，当服务器托管在同一域上时，请求是否有效（即问题可能与 CORS 无关）。你用的是什么服务器？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-04T14:01:30.290

```
if(xhr.readyState == 4 && xhr.status == 200) 
```

此检查必须放在`onreadystatechange`事件处理程序中。在实际发送之前，您显然不能有 200 状态代码或“已完成”请求。

你想要的可能是这样的：

```
xhr.onreadystatechange = function() {
    if(xhr.readyState == 4 && xhr.status == 200) {
        alert('Tested OK');
        var text = xhr.responseText;
        alert('Response from CORS request to ' + url + ': ' + text);
    }
};
xhr.send(params); 
```

如果您想要一个`else`案例来检查错误，请记住您仍然需要检查`xhr.readyState == 4`. 您不希望您的错误处理代码为其他 readyStates 运行。

不需要该`onload`事件 - 当`readyState == 4`您知道请求已完成时。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T14:01:16.737

`xhr.send();`需要就在调用之后`xhr.open();`不是吗？状态 1 表示请求尚未发送，除非您实际发送请求，否则它永远不会到达状态 4。

# ajax - ajax 调用易受 xss 攻击

> ID：11330491
> 
> 赞同：1
> 
> 时间：2012-07-04T13:54:34.333
> 
> 标签：ajax, security, web, xss

我有一个简单的 Web 应用程序，我在其中使用来自 jsp 页面的 ajax（通过帖子）调用 java servlet。在 servlet 中，我从数据库中获取数据并制定 JSON 格式并在 jsp 页面中检索。然后，我使用 eval 函数解析 json 并使用 innerHTML 属性显示分区中的数据。不知何故，这种方法似乎容易受到 xss 攻击。有人可以提供一些关于如何在这个用例中防止 XSS attck 的指示吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T19:12:01.957

这听起来像是[基于 DOM 的 XSS](https://www.owasp.org/index.php/DOM_Based_XSS)。有几种方法可以[防止基于 DOM 的 XSS](https://www.owasp.org/index.php/DOM_based_XSS_Prevention_Cheat_Sheet)。您必须对服务器或客户端上的数据进行 html 编码。**应始终避免**在数据库中使用 HTML 编码数据，因为它会更改数据的值并影响数据的排序方式等。 [XSS 是一个输出问题](https://sitewat.ch/en/Blog/5)，因此它应该通过构建 HTML 的代码来解决，在您的情况下是 JavaScript。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T05:52:49.047

较新的浏览器支持 JSON.parse()。对于较旧的浏览器，请使用 json2.js。

您还应该正确编码 JSON，以便值不会超出引号等。找到一个体面的 json 编码器并在服务器端使用它。

# javascript - Chrome highcharts SVG 渲染问题

> ID：11330494
> 
> 赞同：-1
> 
> 时间：2012-07-04T13:54:43.577
> 
> 标签：javascript, google-chrome, svg, highcharts

我刚刚在 chrome 中观察到一个异常行为：我使用[highcharts](https://www.highcharts.com/)饼图并可视化一些数据。尽管每个馅饼切片都有不同的颜色，但它以黑色显示一些切片。我怀疑它与生成的**svg 图**有关。请检查从 chrome 和 firefox ***** 拍摄的图片。任何帮助、建议、解决方法将不胜感激。

[![铬合金](../Images/b9a9728d100ba96be0f342162dbe1732.png)](https://i.stack.imgur.com/vkztI.jpg)
[（来源：[i.imm.io](http://i.imm.io/v3mk.jpeg)）]

[![Mozilla](../Images/56d5ae239a5d0c499bdca55c2c0dd30b.png)](https://i.stack.imgur.com/V2zy3.png)
[（来源：[i.imm.io](http://i.imm.io/v3mS.png)）]

*使用 Win 7 64 位 Chrome 版本 20.0.1132.47 m Mozilla 版本 13.0.1

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T12:12:21.123

Alright guys I found the problem which is in my code. But I learnt something: If you assign `color` attribute to an element, Firefox doesn't check if it has **#** symbol in the beginning but Chrome checks. Therefore, `color:343434` fails in Chrome but not in Firefox.

# excel - 获取包含数据的最小/最大行号的行号？

> ID：11330500
> 
> 赞同：0
> 
> 时间：2012-07-04T13:54:52.570
> 
> 标签：excel, vba

> **可能重复：**
> [如何使用宏在 Excel 工作表中找到包含数据的最后一行？](https://stackoverflow.com/questions/71180/how-can-i-find-last-row-that-contains-data-in-the-excel-sheet-with-a-macro)
> [在 VBA 中查找最后使用的单元格时出错](https://stackoverflow.com/questions/11169445/error-finding-last-used-cell-in-vba)

如果我有一个电子表格并且包含数据的最大行号是 10,434，是否有一个函数可以为我提供行号 10,434？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T14:04:51.777

```
子最大行（）
Dim largerowNum As Long
Dim col As Integer
对于 col = 1 到 Columns.Count
lastrow = Application.WorksheetFunction.Max(Cells(65536, col).End(xlUp).Row, maximumrowNum)
下一栏
MsgBox "最大行数=" & maximumrowNum
结束子
```

（只要您的行数少于 65536 就可以使用）

# android - 当 MapView 放大/缩小时，片段会继续回到默认位置

> ID：11330501
> 
> 赞同：0
> 
> 时间：2012-07-04T13:55:00.180
> 
> 标签：android

我有一个显示 3 个片段的活动， a `MapActivity`， a`ListActivity`和 a (normal) `DetailsActivity`。和放置在 MapActivity 上`ListActivity`。`DetailsActivity`

有一个用动画隐藏 ListActivity 和 DetailsActivity 的功能，`onAnimationEnd()`我为隐藏的 Activity 设置了一个新布局。

我面临的问题是，每次 ListActivity 或 DetailsActivity 隐藏**（图片状态 2）**之一，然后我在 MapActivity 上捏屏幕以缩放地图，它总是回到默认视图**（图片状态 1）**。关闭的活动会自动再次打开。

当我捏 MapActivity 时，有人知道如何防止隐藏的片段再次进入第一个状态吗？

这是我如何隐藏 DetailsActivity() 的函数示例：

```
public void hideDetailview() {
        final Animation close = AnimationUtils.loadAnimation(this, R.anim.close);
        close.setFillEnabled(true);
        close.setAnimationListener(closeDetailAnimationListener);
        fragment_detail.startAnimation(close);

        Toast.makeText(MainFragmentActivity.this,WWHApplication.getDrawer(), Toast.LENGTH_SHORT).show();
    }

    private AnimationListener closeDetailAnimationListener = new AnimationListener() {

        @Override
        public void onAnimationStart(Animation animation) {

        }

        @Override
        public void onAnimationRepeat(Animation animation) {
        }

        @Override
        public void onAnimationEnd(Animation animation) {

            int newLeft = -330;
            fragment_detail.layout(newLeft, 
                    fragment_detail.getTop(), 
                                newLeft + fragment_detail.getMeasuredWidth(), 
                                fragment_detail.getTop() + fragment_detail.getMeasuredHeight());

        }
    }; 
```

这是xml布局：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res/com.wwh"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <fragment
        android:id="@+id/my_map_fragment1"
        android:name="com.wwh.fragments.MyMapFragment"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent" >

        <!-- Preview: layout=@layout/my_map_fragment -->
    </fragment>

    <RelativeLayout
        android:id="@+id/fragment_layout"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginTop="55dp"
        android:orientation="horizontal" >

        <LinearLayout
            android:id="@+id/detail_layout"
            android:layout_width="wrap_content"
            android:layout_height="fill_parent"
            android:orientation="horizontal" >

            <fragment
                android:id="@+id/my_detail_fragment"
                android:name="com.wwh.fragments.DetailFragment"
                android:layout_width="380dp"
                android:layout_height="fill_parent" />

            <LinearLayout
                android:id="@+id/border_detail"
                android:layout_width="1dp"
                android:layout_height="fill_parent"
                android:background="@drawable/border"
                android:orientation="vertical" />
        </LinearLayout>

        <LinearLayout
            android:id="@+id/list_layout"
            android:layout_width="wrap_content"
            android:layout_height="fill_parent"
            android:layout_toRightOf="@+id/detail_layout"
            android:orientation="horizontal" >

            <fragment
                android:id="@+id/my_list_fragment"
                android:name="com.wwh.fragments.MyListFragment"
                android:layout_width="380dp"
                android:layout_height="fill_parent"
                android:background="@drawable/border"
                android:shadowColor="#000000"
                android:shadowDx="1.2"
                android:shadowDy="12"
                android:shadowRadius="12" />

            <LinearLayout
                android:id="@+id/border_list"
                android:layout_width="1dp"
                android:layout_height="fill_parent"
                android:background="@drawable/border"
                android:orientation="vertical" />

            <ImageView
                android:id="@+id/shadow_vertical"
                android:layout_width="2dp"
                android:layout_height="fill_parent"
                android:layout_marginTop="53dp"
                android:background="@drawable/shadow_vertical" />
        </LinearLayout>
    </RelativeLayout>

</RelativeLayout> 
```

![正常默认状态，所有fragment都打开](../Images/7c6554ec80a769be15e5145aadd5b5a0.png)

![第二种状态，片段关闭](../Images/1aaf93f33eb3bc3b8edf921e4d430bce.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T09:12:36.007

您可能忘记更新其他片段的布局？或者您对新布局的计算有误？

我这么说是因为旧 android 版本上的动画很棘手，因为它们并没有真正改变视图的布局。所以也许当动画结束时，你实际上触摸了一些你认为你没有触摸到的东西。

请提供更多代码。也许它可以帮助我们理解它为什么会发生。

顺便说一句，请重命名片段类。它们不是活动，那么为什么在它们的名称中包含“活动”？

# c++ - 开发 C++ 应用程序以在嵌入式 Linux 设置上运行

> ID：11330505
> 
> 赞同：3
> 
> 时间：2012-07-04T13:55:15.853
> 
> 标签：c++, linux, embedded-linux, glibc

我需要编写一个 C++ 应用程序才能在嵌入式 Linux 设置（DMP Vortex86DX 处理器）上运行。供应商提供了一个[最小的 linux 安装映像](http://www.dmp.com.tw/tech/os-xlinux/)，可以安装到板上并包含适当的硬件驱动程序。我的问题是由我之前关于在[特定内核上编写 Linux 软件以在不同内核上运行的](https://stackoverflow.com/questions/11014215/will-a-c-linux-app-built-on-version-x-xx-of-the-kernel-run-on-an-earlier-versi)问题的答案引起的。在编写软件以确保兼容性时，我真的不知道从哪里开始。

我本能的做法是在嵌入式设备和我的桌面开发机器上安装相同版本的 g++，在开发机器上编写应用程序，复制到板上并在那里编译。但这似乎很疯狂，我很难相信这就是嵌入式软件的开发方式。关于我上一个问题的答案，有没有一种方法可以简单地在我的桌面上构建，但使用嵌入式设备上存在的 glibc 版本 - 如果是这样，如何强制链接到特定版本？或者是否可以静态构建所有内容，以便应用程序不会动态链接到任何内容（我怀疑这是可能的）。

我完全是嵌入式开发的新手，除非我能获得一些好的建议或资源，否则我可以预见数月的挫败感。无论它们看起来多么简单或微不足道，任何关于从哪里开始的指示或建议都会非常感激 - 我真的是从最底层开始嵌入的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T14:39:51.507

好的，鉴于[Vortex86SX/DX/MX](http://en.wikipedia.org/wiki/Vortex86)声称与 x86 兼容，一小部分编译器开关应该使您能够为您的目标机器编译代码：`-m32`确保 32 位代码，并且没有`-march`针对特定 CPU 的开关。

然后你需要链接你的代码。只要您不使用任何花哨但简单的已建立 glibc 函数，我希望 ABI 在您的开发机器和嵌入式系统上是相同的。换句话说，您针对您的主机库进行编译，将二进制文件复制到嵌入式系统，它应该只需使用那里可用的库即可运行。

如果 X-Linux 要使用其他一些 libc，例如[uclibc](http://www.uclibc.org/)或类似的，那么您的主机上需要一个交叉编译器。在这方面我对 Ubuntu 几乎没有经验，但我知道`sys-devel/crossdev`Gentoo linux 的软件包使交叉编译器的生成非常容易。这既可以用于不同的架构（在您的情况下不需要），也可以用于不同的库（例如 uclibc）。

我会说只是尝试复制二进制文件，如果在那里遇到任何问题，请报告。

# xml - 根据属性比较 2 个节点集

> ID：11330506
> 
> 赞同：3
> 
> 时间：2012-07-04T13:55:16.380
> 
> 标签：xml, xslt, xpath

我是 xslt 的新手，请提供基于属性值比较两个节点的 xslt。

输入.xml：

```
<comp>
<alink>
<link id="0003"/>
<link id="0001"/>
<link id="0002"/>
 </alink>
<bibsection>
<bib id="0001">2007</bib>
 <bib id="0002">2008</bib>
<bib id="0003">2009</bib>
 </bibsection>
 </comp> 
```

我的输出应该是，

输出.xml：

```
<comp>
<alink>
 <link id="0003"/><year>2009</year>
 <link id="0001"/><year>2007</year>
 <link id="0002"/><year>2008</year>
  </alink>
 <bibsection>
<bib id="0001">2007</bib>
 <bib id="0002">2008</bib>
 <bib id="0003">2009</bib>
  </bibsection>
  </comp> 
```

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T14:46:25.273

**一个完整、高效且简短的转换，使用键**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:key name="kBibById" match="bib" use="@id"/>

 <xsl:template match="node()|@*" name="identity">
  <xsl:copy>
   <xsl:apply-templates select="node()|@*"/>
  </xsl:copy>
 </xsl:template>

 <xsl:template match="link">
  <xsl:call-template name="identity"/>
  <year><xsl:value-of select="key('kBibById', @id)"/></year>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时：**

```
<comp>
    <alink>
        <link id="0003"/>
        <link id="0001"/>
        <link id="0002"/>
    </alink>
    <bibsection>
        <bib id="0001">2007</bib>
        <bib id="0002">2008</bib>
        <bib id="0003">2009</bib>
    </bibsection>
</comp> 
```

**产生了想要的正确结果：**

```
<comp>
   <alink>
      <link id="0003"/>
      <year>2009</year>
      <link id="0001"/>
      <year>2007</year>
      <link id="0002"/>
      <year>2008</year>
   </alink>
   <bibsection>
      <bib id="0001">2007</bib>
      <bib id="0002">2008</bib>
      <bib id="0003">2009</bib>
   </bibsection>
</comp> 
```

**说明**：

1.  **[身份规则](http://www.dpawson.co.uk/xsl/sect2/identity.html)**“按原样”复制每个匹配的节点。

2.  有一个覆盖标识模板的模板——它匹配任何`link`元素。该模板正文中的代码通过名称调用标识模板来处理匹配的`link`元素，然后构造一个`year`元素，其文本节点子节点的值是第一个元素的字符串值，该`bib`元素的属性与属性`id`值相同`id`匹配的`link`元素。使用引用名为“kBibById”的指令的函数来选择此`bib`元素。**[`key()`](http://www.w3.org/TR/1999/REC-xslt-19991116#function-key)****[`xsl:key`](http://www.w3.org/TR/1999/REC-xslt-19991116#key)**

**注意事项**：

上述身份规则的链接暂时无法使用——请暂时使用 Internet 档案中的这一表格：

[http://web.archive.org/web/20081229160200/http://www.dpawson.co.uk/xsl/sect2/identity.html](http://web.archive.org/web/20081229160200/http://www.dpawson.co.uk/xsl/sect2/identity.html)

# opa - Opa：如何在客户端存储短期数据？

> ID：11330508
> 
> 赞同：1
> 
> 时间：2012-07-04T13:55:19.743
> 
> 标签：opa

新手问题在这里，

我正在尝试在我的 Opa 程序中的客户端上存储持久数据。如果这是非关键的（它本质上是一个昵称）暴露给用户，那很好。在 PHP 或类似的语言中，我会使用 cookie。我不确定如何在 Opa 中执行此操作，因为我需要数据在多个页面之间保留。

我不想使用数据库，因为这只是很小的信息，而且我没有半独特的方式来识别客户端以匹配数据库记录。

这里有什么指导吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T16:56:48.980

你可以看看[UserContext](http://doc.opalang.org/module/stdlib.core.web.context/UserContext)。

模块说明见源代码：[https ://github.com/MLstate/opalang/blob/v1903/stdlib/core/web/context/user_context.opa#L33](https://github.com/MLstate/opalang/blob/v1903/stdlib/core/web/context/user_context.opa#L33)

# java - JavaFX 将组件连接到模型

> ID：11330512
> 
> 赞同：3
> 
> 时间：2012-07-04T13:55:36.583
> 
> 标签：java, binding, javafx-2

我有一个带有多个控件的 JavaFX 用户界面；这些值应该存储在 Model 类的字段中；UI 类有对 Model 的引用。

说 Model 类是基本的：

```
public static class Model{String myText; /*javabeans getters and setters provided too*/} 
```

JavaFX 应用程序如下。

```
public class T08 extends Application {

Model model;

@Override
public void start(Stage primaryStage) throws Exception {

    model = new Model();

    BorderPane bp = new BorderPane();
    primaryStage.setScene(new Scene(bp));

    //this is the component that should be connected to model.myText
    TextField textField = new TextField();

    bp.setCenter(textField);        
    primaryStage.show();

} 
```

### 问题

1.  用户可以在 textField 控件中写入文本，文本应保存到 model.myText 中。

2.  在应用程序启动期间，我需要将数据加载到模型中并将其呈现给控件。
    我尝试过使用 JavaFX 2.x 绑定，但它们似乎专注于单向连接。我有哪些选择可以巧妙地完成此任务？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-04T15:06:04.493

一种方法是使用AFAIK`myTextProperty.bindBidirectional()`代替。`myTextProperty.bind()`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-04T14:51:24.360

好的，我写了一些 SSCCE 示例代码，因为代码更准确地解释了事情:)

第一个例子是这个问题：

```
import javafx.application.Application;
import javafx.event.ActionEvent;
import javafx.event.EventHandler;
import javafx.scene.Scene;
import javafx.scene.control.Button;
import javafx.scene.control.TextField;
import javafx.scene.layout.BorderPane;
import javafx.stage.Stage;

public class JavaFXApplication10 extends Application {

    private Model model = new Model();

    @Override
    public void start(Stage primaryStage) {

        final TextField textField = new TextField();
        textField.setText(model.getMyText());

        Button btn = new Button();
        btn.setText("Done");
        btn.setOnAction(new EventHandler<ActionEvent>() {

            @Override
            public void handle(ActionEvent event) {
                model.setMyText(textField.getText());
                System.out.println("Done.");
                System.out.println("New value: " + model.getMyText());
            }
        });

        BorderPane root = new BorderPane();
        root.setTop(textField);
        root.setBottom(btn);
        primaryStage.setScene(new Scene(root, 300, 250));
        primaryStage.show();
    }

    public static void main(String[] args) {
        launch(args);
    }

    // Data Model
    public static class Model {
        private String myText = "model myText default";

        public String getMyText() {
            return myText;
        }

        public void setMyText(String myText) {
            this.myText = myText;
        }
    }
} 
```

此示例的第二个修改版本（使用双向绑定）在[此处](https://stackoverflow.com/a/11340766/682495)。
在这两个示例中，都尝试单击该按钮。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-02T20:54:51.930

也许你看看[https://github.com/laubfall/modelfx](https://github.com/laubfall/modelfx)。我正是出于这个原因编写了这个库。它支持 JavaFX 组件（由层次结构组成）和驻留在 Bean 中的属性的双向绑定。有关更多文档，请参阅 Github-Project modelfx 的 Wiki-Pages。希望对您有所帮助！

ps：核心功能使用JavaFX的Bindings.bindBidrectional。

# git - 无法在 Amazon EC2 服务器上使用 Netbeans 和 GIT 推送

> ID：11330515
> 
> 赞同：1
> 
> 时间：2012-07-04T13:55:52.077
> 
> 标签：git, netbeans, amazon-ec2

我对 UNIX/GIT 世界很陌生。

我正在尝试在 Amazon EC2 机器上设置 GIT 存储库，这样我就可以轻松地从不同的地方处理我的项目。

经过几个小时的工作后，有些事情没问题，我设法用我的 IDE（Netbeans）连接到存储库并克隆远程内容。

当我尝试将某些东西推送到远程仓库时，问题就开始了，Netbeans 给了我一个错误，这个输出，带有一个通用错误：

```
==[IDE]== 4-lug-2012 15.34.59 Pushing
git push ec2-xxx-xxx-xxx-xxx.eu-west-1.compute.amazonaws.com:/var/www/myDir/        +refs/heads/master:refs/heads/master
Remote Repository Updates
Branch : master
Old Id : 84c3fb34b54b501b52c914eca123d4d850688e26
New Id : 7e7fd752d2cde7b0bf8824eef83c535ee2418508
Result : REJECTED_OTHER_REASON

Local Repository Updates
Branch : origin/master
Old Id : 84c3fb34b54b501b52c914eca123d4d850688e26
New Id : 7e7fd752d2cde7b0bf8824eef83c535ee2418508
Result : NOT_ATTEMPTED

==[IDE]== 4-lug-2012 15.35.02 Pushing finished. 
```

我已经阅读了有关使远程存储库“裸露”的信息，在这种情况下 git push 成功，但无论如何文件都没有更新......我错过了什么？

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T14:01:57.593

您的 EC2 实例是否也在您的代码用于生产的地方？如果是这样，那么您将需要 EC2 实例上的裸存储库来处理提交，并需要另一个 git 克隆（裸存储库的）来提供您的生产代码。

工作流程：

1.  在您的 EC2 实例上设置一个裸存储库。
2.  将其克隆为您的生产代码*
3.  将此新存储库克隆到您的本地计算机*
4.  代码，提交，推送。重复。
5.  配置[接收后](http://git-scm.com/book/en/Customizing-Git-Git-Hooks)挂钩以自动更新您的产品（例如，拉取）

*显然，您不希望使用 HEAD/master 更新您的生产 - 因此请确保您有一个用于生产或开发的分支/标签。

# php - 如何区分 domText 和 domElement 对象？

> ID：11330516
> 
> 赞同：5
> 
> 时间：2012-07-04T13:55:52.497
> 
> 标签：php, dom, domdocument

我正在按 DOM 对象遍历页面并卡在一个点上。

这是我必须遍历的示例 HTML 代码。

```
...
<div class="some_class">
some Text Some Text
<div class="childDiv">
</div>
<div class="childDiv">
</div>
<div class="childDiv">
</div>
<div class="childDiv">
</div>
</div>
... 
```

现在，这是部分代码..

```
$dom->loadHTML("content above");

// I want only first level child of this element.
$divs = $dom->childNodes;
foreach ($divs as $div)
{
    // here the problem starts - the first node encountered is DomTEXT
    // so how am i supposed to skip that and move to the other node.

    $childDiv = $div->getElementsByTagName('div');
} 
```

如您所见..`$childNodes`返回`DOMNodeList`，然后我遍历它`foreach`，如果在任何时候`DOMText`遇到 a 我都无法跳过它。

请让我知道任何可能的方式，我可以提出条件区分资源类型`DOMText`和`DOMElement`。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-04T14:03:40.757

```
foreach($divs as $div){

    if( $div->nodeType !== 1 ) { //Element nodes are of nodeType 1\. Text 3\. Comments 8\. etc rtm
        continue;
    }

    $childDiv = $div->getElementsByTagName('div');
} 
```

# powershell - 如何将数据集行值存储为字符串？

> ID：11330517
> 
> 赞同：-1
> 
> 时间：2012-07-04T13:55:52.913
> 
> 标签：powershell, powershell-2.0

我已经使用 powershell 执行了 SQLquery，我想将结果存储在日志文件中。

```
 $SelectQuery = "SELECT [$columnName] FROM [$DatabaseName].[dbo].[$TableName];"
    $Qresult= invoke-sqlcmd -query $SelectQuery -ServerInstance $srvInstance
    Log-Write "$Qresult" 
```

（日志写入是一个将内容添加到日志文件的函数）但是日志文件显示为“System.Data.DataRow”，这意味着 $Qresult 没有正确转换为字符串。

如何将其转换为字符串并存储在日志文件中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T14:12:09.380

您可以像这样转换为`string`每个`DataRow`：

`$Qresult = $Qresult| % { $_.$columnName`}

# javascript - jQuery获取不包括水平/垂直滚动条的文档宽度和高度

> ID：11330521
> 
> 赞同：0
> 
> 时间：2012-07-04T13:56:03.403
> 
> 标签：javascript, jquery, html, css, browser

我的网站上有一段 jQuery，它显示了窗口的整个宽度和高度的覆盖。我有一个问题，如果覆盖已关闭（因为有关闭它的选项），我会丢失窗口中的垂直滚动条。有没有办法指定**不包括**任何水平或垂直滚动​​条的宽度和高度？

这是我下面的代码，jQuery 将在页面加载后立即运行。

```
 <div id="screen"></div>

        $('#screen').css({ "display": "block", 
                            opacity  : 0.7,
                            "width"  : $(document).width(),
                            "height" : $(document).height()
                            });
        $('body').css({ "overflow" : "hidden" }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T10:09:37.640

这有效：

```
$('#screen').css({ "display": "block", 
                    opacity  : 0.7,
                    "width"  : $(document).width(),
                    "height" : $(document).height()
                    });
$('body').css({ "overflow" : "auto" }); 
```

# iphone - Xcode：ATM 查找器应用程序

> ID：11330524
> 
> 赞同：-4
> 
> 时间：2012-07-04T13:56:17.180
> 
> 标签：iphone, xcode, dictionary

我想开发一个可以找到最近的 ATM 的应用程序，我该如何设置这一切？找到您当前的位置并输入 ATM 位置。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-04T14:24:07.257

首先，您需要通过 CLLocationManager 类来帮助您获取当前位置

```
CLLocationManager *locationManager   =       [[CLLocationManager alloc]init];
 locationManager.delegate         =       self;
 [locationManager startUpdatingLocation]; 
```

以下代表将帮助您获取更新的位置

```
-(void) locationManager:(CLLocationManager *)manager didUpdateToLocation:(CLLocation *)newLocation fromLocation:(CLLocation *)oldLocation{

} 
```

现在您可以使用 google place api 搜索当前坐标附近的任何事物

```
NSString *url = [NSString stringWithFormat:@"https://maps.googleapis.com/maps/api/place/search/xml?location=%f,%f&radius=%.0f&types=%@&sensor=true&key=AIzaSyDIWlL",currentlatitude,currentlongitude,distanceinmeters,itemYouWantToSearch];

// here you have to use your own key and change the ivars according to your need. 
```

现在你必须使用 NSXMLParser 来解析数据

```
NSXMLParser *itemParser = [[NSXMLParser alloc]initWithContentsOfURL:[NSURL URLWithString:url]];
[itemParser setDelegate:self];
[itemParser parse]; 
```

以下解析器委托将帮助您获取数据

```
-(void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName attributes:(NSDictionary *)attributeDict

{
 //opening tag
}

-(void)parser:(NSXMLParser *)parser foundCharacters:(NSString *)string{
  //data of opening tag
}

-(void)parser:(NSXMLParser *)parser didEndElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName{

//closing tag
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T14:00:46.430

首先，您必须阅读有关 XMLParsing、JSON Parsing 的所有内容。当您将了解有关解析的所有内容时，请转到下一步，这就是 API。在互联网上找到一个提供 ATM 详细信息的 URL...我建议您在 ATM 之前请使用 Google 的天气 API...这对初学者来说很容易。

# c# - 更新记录在 LINQ to SQL 中不起作用

> ID：11330525
> 
> 赞同：3
> 
> 时间：2012-07-04T13:56:20.467
> 
> 标签：c#, .net, linq-to-sql

我有这个序列生成查询，它获取当前序列并将其增加到下一个值。但是增量没有更新。nextval 始终返回 1，即数据库中的默认值

```
Entity  | StartVal | Increment | CurVal | NextVal
----------------------------------------------------
INVOICE |   0      |     1     |   0    |   1 
```

nextval 应该是 3, 5, 7 等等

```
int nextVal = 0;
using (var db = new MedicStoreDataContext())
{
    DAL.LINQ.Sequence seq = (from sq in db.Sequences
                where sq.Entity == entity
                select sq).SingleOrDefault();

    if (seq != null)
    {
        nextVal = seq.NextVal.HasValue ? seq.NextVal.Value : 0;

        seq.NextVal = nextVal + 2;

        db.SubmitChanges();
    }

} 
```

我留下了一些未完成的事情吗？

**更新：** 回答：我需要设置主键并更新序列类字段以包含主键

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-04T13:59:42.073

通常这是因为它没有找到表的唯一标识符（或主键）。

在您的数据描述中，您确定该表正确选择了唯一项目吗？- 当我第一次尝试这个时，虽然我有一个唯一的键等，但 c# 中的表描述并没有将它标记为唯一，所以 linq 没有像我预期的那样悄悄地更新它，没有错误也没有警告。一旦我在 c# 中更正了数据表，一切顺利。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T14:10:01.043

这不是正确的行为吗？如果 CurVal 为 0，您不会期望 nextVal 为 1 吗？我可能在这里遗漏了一些东西，但看起来你有点过于复杂了。基本上不是你想做的吗

```
using (var db = new MedicStoreDataContext())
{
    DAL.LINQ.Sequence seq = (from sq in db.Sequences
                where sq.Entity == entity
                select sq).SingleOrDefault();

    if (seq != null)
    {
        seq.CurVal += seq.Increment;

        db.SubmitChanges();
    }
} 
```

我不明白你为什么需要整个 nextVal 位。如果我错了，请随时纠正我。

# objective-c - C 中的静态 const void *method()

> ID：11330532
> 
> 赞同：1
> 
> 时间：2012-07-04T13:56:53.497
> 
> 标签：objective-c, c, function-pointers, void-pointers

我在一个我正在修改的程序上看到了这个：

```
static const void *method()
{
 // other code
 return anotherMethod(param1,param2);
} 
```

据我了解，这将返回一个指向函数的指针。现在基于[此](http://boredzo.org/pointers/#function_pointers)，我试图弄清楚它`static const void`适用于什么：

```
int f(void);
int *fip(); //Function returning int pointer
int (*pfi)(); //Pointer to function returning int 
```

那么添加的**真正**优势是什么`static const`（假设这应用于指定函数的返回值）。另外，是否会调用指向函数的返回指针？或者它只是一个指向它的指针？因为从代码中我有以下内容：

```
void start()
{
  method();
} 
```

我假设它将被调用，否则它将被分配给一个指针。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-04T14:01:17.063

不，该函数将返回 a`const void*`并且将`static`函数的可见性限制在文件范围内。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-04T14:05:14.923

`static`意味着该函数对编译单元（源文件）是私有的，并且在它之外不可见。

`const void *`意味着返回值是一个指向常量内存的指针，即不应该写入的内存。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-04T14:03:08.013

函数前的 static 关键字并不意味着它会返回一个静态变量。它只是意味着该功能是“静态的”。这意味着无法从“外部”对象（例如从另一个源文件编译的目标文件）访问此函数。

您给出的示例将返回

```
const void* 
```

并且将拒绝链接到此函数的任何外部引用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-04T14:03:49.493

```
static const void *method() 
```

它返回一个“const void *”。这可能是一个转换为 void* 的函数指针，但通常情况并非如此。

```
void start()
{
  method();
} 
```

在这里，调用者根本对结果不感兴趣。根本没有什么神奇的事情发生。

# android - 如何在地图上显示两个地理点之间的距离？

> ID：11330533
> 
> 赞同：1
> 
> 时间：2012-07-04T13:56:54.060
> 
> 标签：android

我正在开发一个应用程序，用户必须记录位置然后定位汽车。当他选择定位汽车选项时，应该显示停放的汽车。我计算距离但距离总是显示 0 米..我不知道为什么？可以有人告诉如何在地图上显示人与停放的汽车之间的距离...我想在地图上显示停放的汽车

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T14:27:43.430

如果你有 USER 的位置和停放的汽车......

那么这应该工作

```
Location locationA = new Location("USER");  

locationA.setLatitude(latA);  
locationA.setLongitude(lngA);  

Location locationB = new Location("Parked Car");  

locationB.setLatitude(latB);  
LocationB.setLongitude(lngB);  

distance = locationA.distanceTo(locationB); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T16:46:40.260

使用此函数计算实际距离：

```
public static double distFrom (double lat1, double lng1, double lat2, double lng2 ) 
{
    double earthRadius = 3958.75;
    double dLat = Math.toRadians(lat2-lat1);
    double dLng = Math.toRadians(lng2-lng1);
    double a = Math.sin(dLat/2) * Math.sin(dLat/2) +
    Math.cos(Math.toRadians(lat1)) * Math.cos(Math.toRadians(lat2)) *
    Math.sin(dLng/2) * Math.sin(dLng/2);
    double c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
    double dist = earthRadius * c;

    int meterConversion = 1609;

    return new Double(dist * meterConversion).doubleValue();
} 
```

并像这样使用它：

```
double distance = 0;
distance=distFrom(latA,lngA,latB,lngB); 
```

如果要将双精度转换为整数，请使用以下命令：

```
int distance=0;
distance=(int) distFrom(latA,lngA,latB,lngB); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T14:22:31.827

你保存了停放的汽车的位置？你有这个人的实际位置吗？所以，那么你应该能够计算出差异并至少得到距离（至少是视线）......

# c# - 在流畅的休眠映射中为枚举设置默认值

> ID：11330538
> 
> 赞同：0
> 
> 时间：2012-07-04T13:57:08.053
> 
> 标签：c#, nhibernate, mapping, fluent

我有这样的映射。

```
public class MyObjectMap : ClassMap<MyObject> {
public MyObjectMap()
{
  Component(_ => _.MyItem, key =>
  {
    key.Map(x => x.MyItemValue).Column("COL");
    /** I want to set this value to a particular enum in this mapper **/
    key.Map(x => x.MyItemType).AssignSomeValue(MyEnum.MyValueType)
  });
}
} 
```

如何将值设置为某些特定的项目类型。它是特定类型的组件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T19:00:40.700

IUserType 可以做到这一点

```
class ConstantValueUserType : IUserType
{
    NullSafeGet(IDataReader rd, string[] names, object owner)
    {
        return 5; // Constant Value
    }

    public object NullSafeSet(ICommand cmd, object value, int index)
    {
        // empty, we dont want to write
    }

    public SqlType[] SqlTypes { get { return new SqlType[0]; } }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T12:27:01.480

```
key.Map(x => x.MyItemType).ReadOnly().Formula(((int)MyEnum.MyValueType).ToString()).CustomType<int>(); 
```

# c++ - C（++）中双打的排序/比较不稳定？

> ID：11330540
> 
> 赞同：1
> 
> 时间：2012-07-04T13:57:12.677
> 
> 标签：c++, floating-point

我遇到了一个非常奇怪的双打问题。我有一个按降序排序的浮点数（双精度）列表。后来在我的程序中，我发现它们不再完全排序。例如：

```
0.65801139819
0.6545651031    <-- a
0.65456513001   <-- b
0.64422968678 
```

中间的两个数字颠倒过来。有人可能会认为这个问题在于数字的表示，它们只是打印错误。但是我使用我用来对它们进行排序的相同运算符将每个数字与前一个数字进行比较 - 没有转换为基数 10 或类似的情况：

```
double last_pt = 0;
for (int i = 0; i < npoints; i++) {
  if (last_pt && last_pt < track[i]->Pt()) {
    cout << "ERROR: new value " << track[i]->Pt()
         << " is higher than previous value " << last_pt << endl;
  }
  last_pt = track[i]->Pt();
} 
```

在排序期间比较这些值

```
bool moreThan(const Track& a, const Track& b) {
  return a.Pt() > b.Pt();
} 
```

我确保它们总是双倍的，而不是转换为浮点数。`Pt()`返回一个双倍。列表中没有NaN，排序后我没有触摸列表。

*为什么会这样，这些数字有什么问题，以及（如何）我可以对数字进行排序以使它们保持排序状态？*

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-04T14:13:40.243

你确定你没有转换`double`到`float`某个时间？让我们看一下这两个数字的二进制表示：

```
0 01111111110 0100111100100011001010000011110111010101101100010101
0 01111111110 0100111100100011001010010010010011111101011010001001 
```

其中`double`我们有 1 位符号、11 位指数和 53 位尾数，而`float`其中有 1 位符号、8 位指数和 23 位尾数。请注意，两个数字的尾数在前 23 位是相同的。

根据舍入方法，会有不同的行为。如果仅修剪 >23 位，则这两个数字`float`相同：

```
0 011111110 01001111001000110010100 (trim: 00011110111010101101100010101)
0 011111110 01001111001000110010100 (trim: 10010010011111101011010001001) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T14:49:46.867

您正在比较函数的返回值。浮点返回值在浮点寄存器中返回，其精度高于双精度。当比较两个这样的值（例如`a.Pt() > b.Pt()`）时，编译器将调用其中一个函数，将返回值存储在一个未命名的临时类型中`double`（从而将结果四舍五入`double`为浮点寄存器，而不是四舍五入到 `double`) 与存储的值。这意味着您最终可能会遇到`a.Pt() > b.Pt()`和`b.Pt() > a.Pt()`或的情况`a.Pt() > a.Pt()`。这将导致`sort`更多的困惑。（正式地，如果我们在`std::sort`这里讨论，这会导致未定义的行为，而且我听说过它确实导致核心转储的情况。）

另一方面，您说`Pt()`“只返回一个双字段”。如果`Pt()`从来没有计算过；如果只是：

```
double Pt() const { return someDouble; } 
```

，那么这应该不是问题（只要`someDouble`有 type `double`）。扩展精度*可以*精确地表示所有可能的双精度值。

# ios - 此 Mac 上未安装“myName”的私钥问题

> ID：11330541
> 
> 赞同：1
> 
> 时间：2012-07-04T13:57:19.423
> 
> 标签：ios, xcode

我试图验证我的 xcode 项目，但它导致错误“此 Mac 上未安装“我的名字”的私钥”

因为这个项目是由另一台 Mac 电脑创建的。这已经坏了。所以，我无法将这个私钥导出到我正在使用的它。

你有什么主意吗？

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T14:01:58.423

您应该撤销您帐户中的分发证书。以便它再次询问`.cer`您帐户中的密钥文件。您可以`.cer`在钥匙串中创建文件，`Request a Certificate from a Certificate Authority`并提供您的邮件 ID 等详细信息，以便它创建`.cer`文件，并在您撤销分发证书后`developer.apple.com`上传`cer`文件，以便生成可以安装的证书你的系统。![在此处输入图像描述](../Images/69ed4618c09fcc972dc12ae2833963c9.png)![在此处输入图像描述](../Images/28c7059f9642cc06d7c3b5025d4fde51.png)

# php - PHP shuffle 在我的嵌套数组上无法正常工作

> ID：11330542
> 
> 赞同：1
> 
> 时间：2012-07-04T13:57:24.947
> 
> 标签：php

我有一个嵌套的数组数组，我想打乱内部数组。我的代码看起来像这样（简化）：

```
$a = array(array('banana', 'peach'), array('ding', 'dong'), array('oh snow'));
foreach ($a as &$arr) {
    shuffle($arr);
}
var_dump($a); 
```

var_dump 输出以下内容：

```
array(3) { [0]=> array(2) { [0]=> string(5) "peach" [1]=> string(6) "banana" } [1]=> array(2) { [0]=> string(4) "ding" [1]=> string(4) "dong" } [2]=> &array(1) { [0]=> string(7) "oh snow" } } 
```

正如您在输出中看到的，前两个子数组有效，但第三个子数组在输出中通过引用链接...

在我的完整应用程序中，最后一个数组链接会导致问题，但我不想解决这个问题，而是想修复这个 shuffle 事情......

干杯!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T14:14:30.537

这与 PHP 如何存储对数组元素的引用有关。它不能引用数组的元素，只能引用值。因此，它必须将值存储在`array('oh snow')`符号表的“槽”中，然后`$arr`对该`$a[2]`值进行引用。

为了解决这个问题，`unset($arr)`在循环之后。这样，只有一个变量引用了该值，然后将再次将其设为常规数组索引。无论如何，在 a 之后取消设置引用`foreach`是一种很好的做法，因为有很多这样的陷阱。

# iphone - UIImageView 作为按钮

> ID：11330544
> 
> 赞同：26
> 
> 时间：2012-07-04T13:57:34.490
> 
> 标签：iphone, objective-c, cocoa

我正在尝试让 UIImageView 接受操作并在每次单击 UIImageVie 时触发它们，但我很难让它工作，请帮帮我

但这是我正在做的事情：

```
[View setUserInteractionEnabled:YES];

[View addTarget:self action:@selector(myAction:) forControlEvents:UIControlEventTouchUpInside];

- (void) myAction:(id)sender
{
    NSLog(@"It works!");
} 
```

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2012-07-04T14:07:25.040

**Objective-C**

在您的`viewDidLoad:`方法中写下：

```
-(void)viewDidLoad {

    UIImageView *imageview = [[UIImageView alloc]initWithFrame:CGRectMake(100.0, 100.0, 100.0, 100.0)];
    [imageview setImage:[UIImage imageNamed:@"image.png"]];
    [imageview setUserInteractionEnabled:YES];

    UITapGestureRecognizer *singleTap =  [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(singleTapping:)];
    [singleTap setNumberOfTapsRequired:1];
    [imageview addGestureRecognizer:singleTap];

    [self.view addSubview:imageview];
} 
```

然后像这样调用你的手势方法：

```
-(void)singleTapping:(UIGestureRecognizer *)recognizer {
    NSLog(@"image clicked");
} 
```

**迅速**

```
override func viewDidLoad() {
    super.viewDidLoad()

    let imageView: UIImageView = UIImageView(frame: CGRect(x: 100.0, y: 100.0, width: 100.0, height: 100.0))
    imageView.image = UIImage(named: "image.png")
    imageView.isUserInteractionEnabled = true

    let singleTap: UITapGestureRecognizer = UITapGestureRecognizer(target: self, action: #selector(self.singleTapping(recognizer:)))
    singleTap.numberOfTapsRequired = 1
    imageView.addGestureRecognizer(singleTap)

    self.view.addSubview(imageView)
}

@objc func singleTapping(recognizer: UIGestureRecognizer) {
    print("image clicked")
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-07-04T14:01:11.183

`UIImageView`不是控件，您不能向其添加**控件**事件的目标。你有几个选择：

在 上放置一个不可见`UIButton`的`UIImageView`并将您的目标添加到其中。您可以将按钮的样式设置为自定义，并将其文本（和图像）设置为空，使其不可见。

只使用一个`UIButton`. 您可以为其添加背景图像。

将 a 添加`UITapGestureRecognizer`到您的图像视图并实现它的触摸处理程序方法。

子类`UIImageView`化并覆盖触摸处理方法以执行您需要执行的操作。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-01-03T17:40:18.207

您所要做的就是将 Tap Gesture Recognizer 拖到 imageView（在 Storyboard 中）并在 Attributes Inspector 上启用 User Interaction。如果您想将图像用作到另一个视图控制器的链接，只需按住控件并将视图控制器底部的 Tap Gesture Recognizer 图标拖动到目标视图控制器即可。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-04T14:00:11.933

`UIImageView`不是 a`UIControl`所以它没有将该`addTarget:action:forControlEvents`方法作为其接口的一部分。您可以改用手势识别器。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-04T14:04:28.427

我不是专业人士，但您可以为此使用按钮

```
UIButton *imageButton = [UIButton buttonWithType:UIButtonTypeCustom];
imageButton.frame = CGRectMake(0, 0, 200, 200);
[imageButton setImage:[UIImage imageNamed:@"Your_Image.png"] forState:UIControlStateNormal];
imageButton.adjustsImageWhenHighlighted = NO;
[imageButton addTarget:self action:@selector(myAction) forControlEvents:UIControlEventTouchUpInside];
[self.view addSubview:imageButton]; 
```

# codeigniter - Codeigniter：从助手那里调用模型是个坏主意吗？

> ID：11330546
> 
> 赞同：0
> 
> 时间：2012-07-04T13:57:43.167
> 
> 标签：codeigniter, dynamic, view, model, helper

我的页面上有一个菜单，每个页面都加载了该菜单。菜单数据通过模型从数据库中获取。我的第一个想法是从控制器调用模型，然后将其传递给每个页面上的视图。但这会导致“混乱”的代码，如果我忘记将菜单数据传递给视图，则会导致一个丑陋的错误（或者只是没有菜单项）。

所以我想出了通过助手获取菜单项的解决方案，然后从视图中调用助手函数。这更有意义，因为我只有一个地方的代码（菜单视图）。

我的视图是这样设置的：控制器调用“页面”视图，然后加载标题视图、菜单视图、适当的内容视图，最后是页脚视图。助手只能从一个地方调用，即菜单视图。

通常你甚至不能从助手加载模型，但我做了一个解决方法 $i = get_instance(); 然后通过该实例加载模型；$i->加载->模型（）。

我有一种感觉，这不是要走的路，但有没有更好的方法？

**编辑：以更好的方式说：**

我想要：查看 -> 获取数据 -> 显示

不是：控制器 -> 获取数据 -> 传递给视图 -> 显示

我只是不确定这是否“可以”，因为它完全无视 MVC 模型。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T15:52:33.423

所以我找到了一个剪切-粘贴的快速示例（在这种情况下，我有一个称为`login`自动加载的模型，但您当然可以手动执行）

在文件中`core\MY_Controller.php`

```
class Admin_Controller extends CI_Controller 
{
    protected $login_ok;

    public function __construct() 
    {
        parent::__construct();

        /* --- Check if user is logged in --- */
        $this->config->load('adldap', TRUE);
        $data->login_ok = $this->login->check_login(TRUE);

        $this->load->vars($data);
    }
} 
```

如果你然后用这个扩展你的控制器。您将`$login_ok`在您的视图中可用。

这样您就可以确保始终准备好所需的变量，并且您只需在一个地方编写代码

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T15:07:32.900

请记住，关于 MVC 模式的任何内容都不会禁止 View 直接联系 Model。这只是 CodeIgniter 中常见的约定。

我建议在这种情况下，您的菜单视图应该直接从菜单模型加载菜单数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-04T14:30:28.793

我认为解决方案比您想象的要容易。

如果现在你在你的助手中做这样的事情：

```
create_menu()
{
    $menu_items = $this->db->query('')->result();
    // creating the menu here
} 
```

您可以更改函数以接受这样的输入，并且仍然遵循 MVC 模式。

**帮手**

```
create_menu($input)
{
    $menu_items = $input;
    // creating the menu here
} 
```

**模型：**

```
get_menu_data()
{
   $menu_items = $this->db->query('')->result();
} 
```

这有意义吗？

**编辑：**

这是我在其中一个项目上的做法：

我扩展了我的标准控制器。在该控制器的构造函数中，我调用了模型并获取了数据：

```
$this->menu_items = $this->some_model->get_menu_items(); 
```

在一个视图中`nav.php`：

```
if(!empty($this->subnav_item))
{
   // Generate menu
} 
```

这样 MVC 是完整的，但我不必担心传递变量。

**编辑 2**

**如何扩展标准控制器：**

`MY_Controller.php`在中创建文件`application/core`

```
class MY_Controller extends CI_Controller {

    public $menu_items = '';

    function __construct()
    {
        parent::__construct();
        $this->load->model('some_model_that_you_always_use');
        $this->load->library('some_library_that_you_always_use');
        $this->menu_items = $this->some_model->get_menu_items();
    }

} 
```

当你创建一个新的控制器时，你扩展`MY_Controller`而不是`CI_Controller`这样：

```
 class Something extends MY_Controller {

 } 
```

# algorithm - 寻找一种通用的、快速的、低内存的算法来输出数组的 N-out-of-M 组合而不重复

> ID：11330550
> 
> 赞同：1
> 
> 时间：2012-07-04T13:58:03.150
> 
> 标签：algorithm, combinations

我有一个球员阵列

```
$players = array('A','B','C','D','E','F'); 
```

我想获得所有可能的 3 方式完成。

```
1st 2nd 3rd
A   B   C
A   B   D
...
C   A   B
C   B   A
...
F   D   E
F   E   D 
```

我有一些排列算法，但它必须是别的东西，因为排列中有 6 * 5 * 4 * 3 * 2 * 1 组合，这里只有 6 * 5 * 4

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T14:08:45.767

这是一些伪代码，可以打印 6 个组合中的 3 个而不重复：

```
for i = 1 to 6
  for j = 1 to 6
    if (j != i)
      for k = 1 to 6
        if (k != i && k != j)
          print(A[i], A[j], A[k])
        end if
      next k
    end if
  next j
next i 
```

对于一般的 k-of-n 情况，请参阅：[从 n 返回 k 个元素的所有组合的算法](https://stackoverflow.com/questions/127704/algorithm-to-return-all-combinations-of-k-elements-from-n)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T14:05:40.867

给定您的排列算法，您可以分两步使用它来获得所需的排列。

首先，让我们考虑以下映射。给定输入为`A1 A2 A3 A4 A5 ... An`，一个值`b1 b2 b3 b4 b5 ... bn`表示如果为 1 则选择`Ai`，如果`bi`为 0 则不选择。

使用您的输入，例如：

```
0 0 1 1 0 1 -> C D F
0 1 0 0 1 1 -> B E F 
```

现在您的算法可以如下所示：

*   取`n`元素的数量（在您的情况下为 6）和`m`您要选择的数量。
*   构造以下序列：

    ```
    0 0 0 ... 0 1 1 1 ... 1
    \____ ____/ \____ ____/
         V           V
       n - m         m 
    ```

*   获取上述序列的所有排列，并为每个排列：

    *   查找`m`序列中标记的元素
    *   `m`获取这些元素 的所有排列，并为每个排列：
        *   做你想做的！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T14:03:22.500

您的问题是没有找到 6 个元素的所有排列。

您的问题是选择 3 个元素，然后检查其排列。

组合数 = C(6,3)*3！= 6！/3！= 6 * 5 * 4。

C(6,3) - 用于从 6 个元素中选择 3 个元素。（无论顺序如何）

3！- 用于订购 3 个选定的元素。

这是您应该获得的确切组合数量。（你也是）

但是，您可以使用排列算法来获取 6 个元素的所有排列。比，只需忽略最后 3 个元素，并从结果中删除重复项。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-04T14:04:27.203

我可能是错的，但我认为你在这里有正确数量的可能排列。您在 6 名玩家数组中仅选择 3 名玩家。所以对于第一个玩家，你有 6 个可能性，对于第二个玩家，你有 5 个可能性，对于第三个玩家，你有 4 个可能性。

如果您决定最后有 4 个玩家而不是 3 个玩家，则可能的排列数量将是 6*5*4*3，依此类推。

我希望我的数学不会太老！

# apache - 重写规则以从 Rails 服务器的 URL 隐藏端口？

> ID：11330552
> 
> 赞同：3
> 
> 时间：2012-07-04T13:58:11.400
> 
> 标签：apache, mod-rewrite

我有一个在 URL“http://example.com:1234”上运行的 Rails 服务器我想将此应用程序的 URL 作为“http://example.com/myapp”提供给用户，以便 Apache（或 Rack 或无论您提出什么建议）都可以将对“/myapp”的请求重定向到该域的端口 3333。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-04T18:33:10.783

看看在apache 下设置[反向代理。](http://httpd.apache.org/docs/2.2/mod/mod_proxy.html)

Apache 监听 example.com 上的 80 端口，将反向代理到端口 1234。然后对[http://example.com/myapp](http://example.com/myapp)的请求将在内部代理到[http://example.com:1234/myapp](http://example.com:1234/myapp)（或者无论如何你设置您的 ProxyPass 目标）。

如果您无权访问服务器配置，则可以使用 mod_rewrite 的代理标志并在 .htaccess 文件中设置一些规则。类似于以下内容：

```
RewriteEngine On
RewriteCond %{SERVER_PORT} 80
RewriteRule ^myapp(.*) http://example.com:1234/$1 [P,L] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-12T23:04:58.360

有时它会松散它的 css 样式。您只能使用：

```
RewriteRule ^myapp(.*) http://example.com:1234 [L,R] 
```

# mfc - 如何将滑块连接到 MFC 中的变量

> ID：11330554
> 
> 赞同：0
> 
> 时间：2012-07-04T13:58:23.557
> 
> 标签：mfc

将滑块连接到 MFC 中的成员变量的正确方法是什么？到目前为止我所做的：

1.  在资源视图中将滑块拖入我的对话框并为其指定 ID
2.  右键单击滑块并选择**添加变量**
3.  将变量设置为**控制变量**，将**类别**设置为**值**，并将**最小值**和**最大值**设置为所需值。

这会在我的对话框类中创建一个类型的成员变量，`int`并为该方法添加一些内容`DoDataExchange`。

但是，该`DoDataExchange`方法仅在创建对话框时调用一次，当我拖动滑块时，我必须做什么才能使我的成员变量更新？我是否应该将**类别**设置为**Ctrl**并手动管理范围并拦截`WM_HSCROLL`消息？

（顺便说一下，这是一个非模态对话框）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T14:29:52.330

调用 UpdateData 执行 DataExchange 传递 TRUE 以将数据保存并验证到您的变量和 FALSE 以根据您的变量设置控制值，即。将数据传递到控件中。有关更新数据的更多信息：

[http://msdn.microsoft.com/en-us/library/t9fb9hww(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/t9fb9hww(v=vs.80).aspx)

对于通用数据交换机制：

[http://msdn.microsoft.com/en-us/library/xwz5tb1x(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/xwz5tb1x(v=vs.80).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T14:57:15.417

Yes, you call UpdateData() from within the handler for the control's WM_HSCROLL (or WM_VSCROLL) if it's a vertical slider). See [http://msdn.microsoft.com/en-us/library/ekx9yz55%28v=vs.80%29.aspx](http://msdn.microsoft.com/en-us/library/ekx9yz55%28v=vs.80%29.aspx) .

# mysql - 按顺序使用最大列值

> ID：11330556
> 
> 赞同：5
> 
> 时间：2012-07-04T13:58:34.377
> 
> 标签：mysql, sql, sql-order-by, weighting

我正在尝试按两列排序表格，每列都有不同的权重。第一个是`uptime`，它是一个介于 0 和 1 之间的值，权重为 0.3。第二个是`votes`，它是一个非负整数，权重为 0.7。

权重需要乘以 0-1 之间的值，因此我将通过将每行的投票数除以任何行的最大投票数来获得投票。

到目前为止，这是我的查询，它几乎可以工作：

```
SELECT addr
  FROM servers
  ORDER BY (0.3 * uptime) +
           (0.7 * (votes / 100)) DESC 
```

100 是硬编码的，应该是 的最大值`votes`。Using`MAX(votes)`使查询仅返回投票数最高的记录。这可以在单个查询中完成吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T14:04:08.937

定义一个变量并使用它：

```
DECLARE @maxVotes int
SELECT @maxVotes = MAX(votes) from servers

SELECT addr
  FROM servers
  ORDER BY (0.3 * uptime) +
           (0.7 * (votes / @maxVotes)) DESC 
```

或使用子查询`order by`：

```
SELECT addr
  FROM servers
  ORDER BY (0.3 * uptime) +
           (0.7 * ( votes / (SELECT MAX(votes) FROM servers))) DESC 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-04T14:02:10.783

您可以使用子查询来选择最大值`votes`

```
SELECT addr
  FROM servers
  ORDER BY (0.3 * uptime) +
           (0.7 * (votes / (SELECT MAX(votes) FROM servers))) DESC 
```

示例小提琴[在这里](http://sqlfiddle.com/#!2/0c1b3/4/0)。

# php - 使用 php 将数据从 CSV 导入 mysql 表

> ID：11330562
> 
> 赞同：2
> 
> 时间：2012-07-04T13:59:03.697
> 
> 标签：php, mysql, csv

我正在尝试在我的 mysql 表中导入一个 csv 文件。这是我的代码：

```
<?

error_reporting(0);
mysql_connect("localhost","root","");
mysql_select_db("gerov");

$filename='test.csv';

$handle = fopen("$filename", "r");
while (($data = fgetcsv($handle, ",")) !== FALSE)
//foreach(fgetcsv($handle,",") as $data)
{
$import="INSERT into castigatori (id,cod,nume,oras,medalie) values('','$data[0]','$data[1]','$data[2]','$data[3]')";
mysql_query($import) or die("mysql_error()");
print $import."<br>";
}
fclose($handle);
print "Import done";

?> 
```

导入就可以了，但前提是我在 csv 文件中的每个单词之间加了一个逗号。因此，如果我想插入 a,b,c,d 它只会在我将这些逗号放在它们之间时导入。我想在一个单独的单元格上写下这样的单词：abcd 而不必放置逗号并在单词之间制作一个制表符。如果我用制表符分隔单词，在我的 mysql 表中将显示如下：a ;b ;c ;d。谁能告诉我该怎么做才能正确插入它们？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T14:09:24.083

MySQL 提供 LOAD DATA INFILE。
检查[http://dev.mysql.com/doc/refman/5.1/en/load-data.html](http://dev.mysql.com/doc/refman/5.1/en/load-data.html)。
尤其：

```
 [{FIELDS | COLUMNS}
    [TERMINATED BY 'string']
    [[OPTIONALLY] ENCLOSED BY 'char']
    [ESCAPED BY 'char'] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T14:07:44.843

**编辑**：

如果您希望分隔符为空格，则：

```
fgetcsv($handle, 0, " ") 
```

# c# - 如何在没有回调的情况下使用 DevExpress GridView

> ID：11330563
> 
> 赞同：1
> 
> 时间：2012-07-04T13:59:08.330
> 
> 标签：c#, asp.net-mvc, devexpress

我的控制器控制器中有这段代码：

```
List<TResult> list = db.GetBigData();
return PartialView("GridViewPartialView", list); 
```

看法：

```
@Html.DevExpress().GridView(
    settings =>
    {
        settings.Name = "gvGrouping";
        settings.CallbackRouteValues = new { Controller = "Display", Action = "GridViewPartialView" };
        settings.SettingsBehavior.AllowSort = false;
        settings.Width = System.Web.UI.WebControls.Unit.Percentage(100);
        settings.SettingsPager.Visible = false;

//create many column
        settings.Settings.ShowGroupPanel = true;

        };
    }).Bind(Model).GetHtml() 
```

在第一次运行时，控制器执行该`GetBigData`方法。视图显示，但所有节点都已折叠。如果我单击一个节点，它将回调到控制器，该控制器将再次创建对数据库的新查询。排序也会发生同样的事情。我不希望每次都有对数据库的请求，那么如何避免回调呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T13:30:29.033

GridView 是一个服务器端控件，它在服务器上执行所有数据计算，并且只向客户端发送一小部分。由于客户端没有所有可用的数据，因此无法在必要时对其进行重新排序或重新分组。它改为向服务器发送回调。

您所能做的就是加快回调速度。您应该做的第一件事是启用服务器模式，这将大大减少从数据库传输的数据量。以下是启用它的方法：[http ://documentation.devexpress.com/#AspNet/CustomDocument3726](http://documentation.devexpress.com/#AspNet/CustomDocument3726)

# c# - Quartz.Net cron 触发器每 45 分钟安排一次作业

> ID：11330578
> 
> 赞同：6
> 
> 时间：2012-07-04T14:00:43.057
> 
> 标签：c#, quartz-scheduler, quartz.net

我正在尝试使用quartz.net 创建一个作业，该作业将在开始时间和结束时间之间每45分钟运行一次

我尝试使用 cron 跳跳机创建它

cronExpression = "0 0/45 8-5 * * ?";

但是，这并没有按照我想要的方式工作。

在查看了quartz.net 教程后，建议实现这样的工作需要使用两个触发器。

我对如何实现这一点有点困惑，任何人都可以就解决方案提出建议

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-04T15:00:49.187

Quartz.Net 教程主要基于 Quartz.Net v1。

如果您使用的是 v2+，则可以使用以下触发器定义：

```
ITrigger trigger = TriggerBuilder.Create()
    .WithIdentity("trigger1", "group1")
    .WithDailyTimeIntervalSchedule(
        x => x.StartingDailyAt(TimeOfDay.HourAndMinuteOfDay(8, 0))
                 .EndingDailyAt(TimeOfDay.HourAndMinuteOfDay(11, 0))
                 .WithIntervalInMinutes(45))
    .Build(); 
```

这将创建一个触发器，在上午 8 点到 11 点之间每 45 分钟运行一次。

# c# - 如何首先使用实体 框架代码获取不在关联表中的其他值

> ID：11330579
> 
> 赞同：0
> 
> 时间：2012-07-04T14:00:43.343
> 
> 标签：c#, .net, entity-framework, entity-framework-4, entity-framework-4.1

我有一个`UserClasses`,`Screens`和`Workflow`表。Workflow 表是 UserClasses 和 Screens 表之间的关联表。这是它们的结构...

```
UserClasses
- UserClassID (int PK)
- UserClass (string)

Screens
- ScreenID (int PK)
- ScreenName (string)

Workflow
- UserClassificationID
- ScreenID 
```

我在 UserClasses 表中有以下数据（ID 和名称）：

```
- 1 UserClassification1
- 2 UserClassification2
- 3 UserClassification3
- 4 UserClassification4
- 5 UserClassification5 
```

我在 Screens 表中有以下数据（ID 和名称）：

```
- 1 Screen1
- 2 Screen2
- 3 Screen3 
```

我在 Workflow 表中有以下数据（UserClassificationID 和 ScreenID）：

```
1 1
1 2 
```

通过查看`Screen3`与用户分类无关的数据。这就是我需要的，一个与给定用户分类无关的所有屏幕的列表。我该怎么做？

有关我的设置的其他信息。我为 UserClasses 和 Screens 表定义的 2 个类：

```
public class UserClassification : IEntity
{
     public int Id { get; set; }
     public string Name { get; set; }
     public virtual ICollection<Screen> Screens { get; set; }
}

public class Screen : IEntity
{
     public int Id { get; set; }
     public string Name { get; set; }
     public virtual ICollection<UserClassification> UserClassifications { get; set; }
} 
```

以下是我的数据库上下文类中使用的配置类：

```
class ScreenConfiguration : EntityTypeConfiguration<Screen>]
{
     internal ScreenConfiguration()
     {
          this.Property(x => x.Id).HasColumnName("ScreenID");
          this.Property(x => x.Name).HasColumnName("ScreenName");
     }
}

class UserClassificationConfiguration : EntityTypeConfiguration<UserClassification>
{
     internal UserClassificationConfiguration()
     {
          this.ToTable("UserClasses");
          this.Property(x => x.Id).HasColumnName("UserClassID");
          this.Property(x => x.Name).HasColumnName("UserClass");
          this.HasMany(i => i.Screens)
               .WithMany(c => c.UserClassifications)
               .Map(mc =>
               {
                    mc.MapLeftKey("UserClassificationID");
                    mc.MapRightKey("ScreenID");
                    mc.ToTable("Workflow");
               });
     }
} 
```

因此，鉴于上述信息，我需要返回一个用户分类对象，其中包含与此用户分类无关的屏幕列表，在这种情况下，这将是 1 个屏幕项目的列表。我该怎么做这样的事情？

这就是我返回用户分类对象的方式，其中包含关联表中的屏幕列表：

```
return DbContext.UserClasses
     .Include("Screens")
     .SingleOrDefault(x => x.Id == userClassificationId); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T14:05:29.483

关于什么 ？

```
from s in DbContext.Screens
where s.UserClassifications.Count() == 0
select s 
```

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T15:10:29.150

这是不可能的。急切加载 ( `Include`) 仅适用于关联对象。您必须使用投影：

```
var result = DbContext.UserClasses
                      .Where(x => x.Id == userClassificationId)
                      .Select(x => new 
                          {
                              UserClassification = x,
                              Screens = DbContext.Screens
                                                 .Where(s => !s.UserClasses.Any(u => u.Id)
                          })
                      .SingleOrDefault(); 
```

现在您有一个匿名类型，其中包含您的用户分类和所有不相关的屏幕（如果不存在此类用户分类，则为 null）。您可以根据这些信息构建新的用户分类对象（不能直接在 Linq-to-entities 查询中进行，因为 EF 不允许投影到映射类型）。

# php - 相当于 indexOf 的 PHP

> ID：11330582
> 
> 赞同：0
> 
> 时间：2012-07-04T14:00:46.873
> 
> 标签：php, javascript

我有以下JS：

```
if(window.location.href.indexOf("search.php") != -1 
    || window.location.href.indexOf("list.php") != -1
    || window.location.href.indexOf("view.php") != -1
    || window.location.href.indexOf("contact.php") != -1) { 
```

但想将其转换为 PHP。什么是 PHP 中的 indexOf 等价物或在 PHP 中执行此操作的最佳方法。

**我不明白人们在下面链接的 strpos 示例。也许一个更符合我在 JS 中所做的例子？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-06-23T05:42:30.633

这个问题要求一个等价物。PHP 的 strpos() 不适用于数组，而 javascript 的 indexOf 可以（通过自动将字符串视为数组）。所以这是一个PHP等价物

```
function indexOf($array, $word) {
    foreach($array as $key => $value) if($value === $word) return $key;
    return -1;
}

// Example: indexOf(['hi','bye'], 'bye') returns 1 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-04T14:02:25.363

[`strpos()`](http://php.net/strpos)`false`应该可以解决问题，它也会在失败时返回布尔值。

JS 版本：

> indexOf() 方法返回指定值在字符串中第一次出现的位置。如果要搜索的值从未出现，则此方法返回 -1。注意： indexOf() 方法区分大小写。

PHP版本：

```
int strpos ( string $haystack , mixed $needle [, int $offset = 0 ] ) 
```

> 在 haystack 字符串中查找第一次出现 needle 的数字位置。返回针相对于 haystack 字符串开头的位置（与偏移量无关）。另请注意，字符串位置从 0 开始，而不是 1。如果未找到针头，则返回 FALSE。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-04T14:03:31.150

尽管您的 JavaScript 代码正在使用`indexOf()`，但 PHP 实际上有更好的方法来处理您想要实现的目标。

您只需检查 URL 中的脚本名称，然后根据它执行操作。

在我看来，PHP[`switch`](http://php.net/manual/en/control-structures.switch.php)语句比*if*语句结合 PHP[`strpos()`](http://php.net/manual/en/function.strpos.php)函数要好。

下面是如何使用 PHP switch 语句实现这一点的说明：

```
switch(basename($_SERVER['SCRIPT_NAME'])) {
  case 'search.php':
    // Script to run for search.php
    break;
  case 'list.php':
    // Script to run for list.php
    break;
  case 'view.php':
    // Script to run for view.php
    break;
  case 'contact.php':
    break;
  default:
      // Perform code on anything except the above cases.
    break;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-05T13:11:49.787

在回答您的第二个问题时， strpos 可以按如下方式使用：

```
if (strpos($_SERVER['SCRIPT_NAME'], "search.php") !== false
    || strpos($_SERVER['SCRIPT_NAME'], "list.php") !== false
    || strpos($_SERVER['SCRIPT_NAME'], "view.php") !== false
    || strpos($_SERVER['SCRIPT_NAME'], "contact.php") !== false) { 
```

...尽管 Rawkode 的回答确实更优雅。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-04T14:02:37.523

[**strpos();**](http://php.net/manual/en/function.strpos.php)

如果您不使用 ISO-8859-1 编码（UTF-8 或其他），则应使用 mb_strpos()。

# matlab - 结果差异背后的原因是什么？

> ID：11330583
> 
> 赞同：5
> 
> 时间：2012-07-04T14:00:53.100
> 
> 标签：matlab, math

那么`x = [1 2 3;4 5 6]`为什么`norm(x,2)`不一样`norm(x(:),2)`

`norm(x,2) = 9.5080`和`norm(x(:),2)=9.5394`。

我已经在 Matlab R2012a 中运行了这个程序。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-04T15:16:04.187

`sum(abs(A).^2)^(1/2)`正如 Matlab help for norm 中定义的那样，对于矩阵和向量，返回值是“最大奇异值” 。

补充阅读： [维基百科 - 矩阵范数](http://en.wikipedia.org/wiki/Matrix_norm)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-04T14:18:28.943

`x(:)`是一个向量，如果您只是在命令行中键入它，请查看 Matlab 返回的内容。`x`是一个矩阵。矩阵的 2-范数和向量的 2-范数的计算方式不同，通常数组元素的向量的 2-范数与数组的 2-范数不同。有关详细信息，请参阅[好老 Golub 和 Van Loan](http://www.amazon.co.uk/Computations-Hopkins-Studies-Mathematical-Sciences/dp/0801854148/ref=sr_1_1?s=books&ie=UTF8&qid=1341411459&sr=1-1)。

为什么矩阵和数组的 2 范数不同？那是数学，因此在SO上是题外话，所以我不敢回答。

# php - GMAIL 发送 SMTP 邮件时显示密件抄送列表

> ID：11330591
> 
> 赞同：3
> 
> 时间：2012-07-04T14:01:10.093
> 
> 标签：php, email, smtp, gmail

我遇到了 gmail 问题，它显示发送到密件抄送列表的收件人。对此的解决方案是不在标题中包含密件抄送列表，而是将其附加到 PEAR moodule 中的收件人列表中

请参阅此链接 - [http://rawphp.com/php_generator/page.php?show=PHP_Sending_Email_to_Bcc_with_SMTP_Authentication_pear_mail_factory.php](http://rawphp.com/php_generator/page.php?show=PHP_Sending_Email_to_Bcc_with_SMTP_Authentication_pear_mail_factory.php)

因此，我已将其发布给需要了解此内容的任何其他人。

```
<?php function sendSmtpEmail($listType = 'To', $recipientList,$from,$subject = NULL,$message = NULL){

    require_once "Mail.php";

    /*$recipients = "Recipient <email@email.co.uk>";
    $from = "An Email <email@email.co.uk>";
    $subject = 'testing relay';
    $message = "<hteml><head></head><body><h1>This is a test</h1>";
    $message .= "<p>Paragraph</p>";
    $message .= "<ul><li>list item 1</li><li>List item 2</li></body>";*/

    $host = ini_get("SMTP");
    $username = NULL;
    $password = NULL;

    $headers['From'] = $from;

    ///// Set to send as won't send without a to address
    /*if($listType != 'To'){                
        $headers[$listType] = $recipientList;
        $headers['To'] = $from;
    } else { //// Is a to address*/
        $headers['To'] = '';
    /*}*/

    $recipients = $recipientList;

    $headers['Subject'] = $subject;
    $headers['host'] = $host;
    $headers['MIME-Version'] = '1.0';
    $headers['Content-type'] = 'text/html; charset=iso-8859-1';
    $params['sendmail_path'] = '/usr/lib/sendmail';

    // Create the mail object using the Mail::factory method
    $mail_object =& Mail::factory('sendmail', $params);

    $mail_object->send($recipients, $headers, $message);    

    if (PEAR::isError($mail_object)) {
        echo("<p>" . $mail_object->getMessage() . "</p>");
    } else {
        echo "<p>Mail sent succefully</p>"; echo $from; echo $recipientList; die();
    }

}
?> 
```

谢谢

和我

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T14:01:11.747

请参阅如上。我已经整理了功能

```
<?php

function sendSmtpEmail($recipientList,$from,$subject = NULL,$message = NULL){

    require_once "Mail.php";

    $host = ini_get("SMTP");
    $username = NULL;
    $password = NULL;

    $headers['From'] = $from;       
    $headers['To'] = '';

    $headers['Subject'] = $subject;
    $headers['host'] = $host;
    $headers['MIME-Version'] = '1.0';
    $headers['Content-type'] = 'text/html; charset=iso-8859-1';
    $params['sendmail_path'] = '/usr/lib/sendmail';

    // Create the mail object using the Mail::factory method
    $mail_object =& Mail::factory('sendmail', $params);

    $mail_object->send($recipientList, $headers, $message); 

    if (PEAR::isError($mail_object)) {
        echo("<p>" . $mail_object->getMessage() . "</p>");
    } else {
        echo "<p>Mail sent succefully</p>";
    }           
}
?> 
```

希望这对任何人都有帮助。

谢谢

和我

# java - 策划游戏

> ID：11330594
> 
> 赞同：1
> 
> 时间：2012-07-04T14:01:16.380
> 
> 标签：java

我是java编程的初学者。现在我在做一个叫mastermind的游戏。

它有很多条件，我使用数字而不是颜色。

我不知道如何解决这个问题：我正在使用 if else 语句来做我的游戏，但如果解决方案是 4444 并且用户输入是 4444，则输出答案是错误的。

在这个游戏中，第一个输入是计算机生成的，但我必须测试程序，所以我自己设置了数字，第二个输入是玩家输入。

这是我完成的代码：

```
import javax.swing.JOptionPane;

public class asd {

    public static void main (String args[]){
        int i,j;
        int b=0 ,w=0;

    String input[] = new String[4];
    input[0] = JOptionPane.showInputDialog("input a digit");
    input[1] = JOptionPane.showInputDialog("input a digit");
    input[2] = JOptionPane.showInputDialog("input a digit");
    input[3] = JOptionPane.showInputDialog("input a digit");

     String Uinput[] = new String[4];
     Uinput[0] = JOptionPane.showInputDialog("input a digit");
     Uinput[1] = JOptionPane.showInputDialog("input a digit");
     Uinput[2] = JOptionPane.showInputDialog("input a digit");
     Uinput[3] = JOptionPane.showInputDialog("input a digit");

     for(i=0;i<4;i++){
        for(j=0;j<4;j++){
            if(i<4){
            if(input[i].equals(Uinput[j])){
                if(i==j){
                    b++;
                    i++;
                    j=0;
                }else{
                    w++;

                }
            }
            }
        }
     }
     System.out.println("black = "+b+"\nwhite = "+w);

}
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-04T14:11:32.953

好的，我会给你一些建议。

首先，我会说要么对每个输入使用单个字符串（如 Dave 建议的那样），要么使用 char 数组。您不需要 4 个字符的字符串数组。

Your "correct" check is way too complicated. You are modifying loop variables in the loop and it makes it hard to decipher what is actually going on.

EDIT

I would modify the algorithm to a two phase one. The first phase, I would walk through the array and ONLY check for the right number in the right spot - this would be your black peg count.

Then, the next phase, I would walk through the arrays again, checking for right number, wrong spot (white count). The tricky thing is handling duplicates. For example, if the actual number is "1234" and I guess "4445", I should only get one white peg. You cannot naively check if the number exists in the actual value.

To address this, the easiest thing I can think of is making a boolean array that keeps track of when you have already accounted for a number. So here's what my "black" phase would look like:

```
char[] actual = // Read in the real value
char[] guess = // Read in the users guess

int blackCount = 0;
int whiteCount = 0;

boolean[] isFound = new boolean[4];

// Black phase
for (int i = 0; i < 4; ++i)
{
  if (actual[i] == guess[i])
  {
    isFound[i] = true;
    blackCount++;
  }
} 
```

So now you add the white phase - and you only get a white peg if the number exists and it's isFound[i] value = false.

Hope that helps

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T14:20:08.960

I am not sure about mastermind rules and you did not specify, but maybe this is what you mean:

```
 int b = 0, w = 0;
    for (int i = 0; i < 4; i++)
    {
        if(input[i].equals(Uinput[i])) ++b;
        else ++w;
    } 
```

# python - Python stdout 到队列代理或 websocket

> ID：11330602
> 
> 赞同：0
> 
> 时间：2012-07-04T14:01:49.007
> 
> 标签：python, websocket, stdout, message-queue

有没有办法推`stdout`入队列代理或 websocket？

到目前为止，我一直无法找到有关如何执行此操作的明确解释。

我有几个并行运行的进程，我的想法是创建一个 UI，您可以在其中从一个进程切换到另一个进程并查看它们在做什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T14:30:34.393

一种可行的方法（并且是非阻塞的，可以为多个客户端提供服务）是使用 Python、Twisted 和 Autobahn：

连接一个或多个 ProcessProtocol 实例

*   [http://twistedmatrix.com/documents/current/core/howto/process.html](http://twistedmatrix.com/documents/current/core/howto/process.html)

到 Twisted WebSocket 服务器

*   [https://github.com/tavendo/AutobahnPython](https://github.com/tavendo/AutobahnPython)
*   [https://github.com/tavendo/AutobahnPython/tree/master/examples/websocket/broadcast](https://github.com/tavendo/AutobahnPython/tree/master/examples/websocket/broadcast)
*   [https://github.com/tavendo/AutobahnPython/tree/master/examples/wamp/pubsub/simple](https://github.com/tavendo/AutobahnPython/tree/master/examples/wamp/pubsub/simple)

披露：我是高速公路的作者。

# sql - 确定一年中每周的未结案件

> ID：11330603
> 
> 赞同：0
> 
> 时间：2012-07-04T14:01:55.253
> 
> 标签：sql, oracle

我正在尝试制作一份报告，以识别一年中每周开放的客户案例。目前，我有以下 SQL，它返回所有客户，并指示他们的案件是否在我们日历的第 1 周开放。客户有两个方面来确定他们的案件是否开放 - 他们的 MOV_START_DATE 和他们的 ESU_START DATE 应该大于该期间的结束日期，并且他们的 MOV_END_DATE/ESU_START DATE 应该为空或大于该期间的开始日期。

下面的代码有效，但我想我可以复制左连接 WK1 并将其重命名为 WK2 以返回第 2 周的信息，但我收到与命名不明确的列有关的错误。此外，我猜在报告中保留 52 个（每周一个）连接并不是特别可取的，所以我再次想知道是否有更好的方法来实现这一点？

```
 SELECT
A.ESU_PER_GRO_ID,
A.ESU_ID,
A.STATUS,
B.MOV_ID,
B.MOV_START_DATE,
B.MOV_END_DATE,
A.ESU_START_DATE,
A.ESU_END_DATE,
LS.CLS_DESC,
nvl2(wk1.PRD_PERIOD_NUM,'Y','N') as "Week1"

FROM
A

LEFT JOIN B ON B.MOV_PER_GRO_ID = A.ESU_PER_GRO_ID

LEFT JOIN LS ON LS.CLS_CODE = A.STATUS

LEFT JOIN O_PERIODS WK1 ON B.MOV_START_DATE < WK1.PRD_END_DATE
AND (B.MOV_END_DATE IS NULL OR B.MOV_END_DATE > WK1.PRD_START_DATE)
AND A.ESU_START_DATE  < WK1.PRD_END_DATE
AND (A.ESU_END_DATE IS NULL OR A.ESU_END_DATE > WK1.PRD_START_DATE)
AND PRD_CAL_ID = 'E1190' AND WK1.PRD_PERIOD_NUM = 1 AND WK1.PRD_YEAR = 2012

WHERE
B.MOV_START_DATE  Is Not Null  
AND A.STATUS <> ('X') 
```

希望我提供了足够的信息，但如果没有，我很乐意回答问题。谢谢！

样本数据（由上述查询产生）

```
 P ID    ESU_ID STATUS  MOV_ID  M_START     M_END   DESC    Week1
 1      ESU1       New      1M  01/01/2012           Boo    Y
 2      ESU2       New     2M   01/03/2012           Boo    N 
```

预期产出（第 1 周 - 第 52 周）

```
 P ID    ESU_ID STATUS  MOV_ID  M_START     M_END   DESC    Week1 Week2
 1      ESU1       New     1M   01/01/2012           Boo    Y     Y
 2      ESU2       New     2M   01/03/2012           Boo    N     N 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T14:52:39.940

我怀疑创建像 WK1 这样的 WK2 连接不起作用的原因是 PRD_CAL_ID 列上没有表别名。但是，正如您所猜测的那样，52 个连接可能不会表现得很好。尝试以下操作：

```
SELECT A.ESU_PER_GRO_ID,    
       A.ESU_ID,    
       A.STATUS,    
       B.MOV_ID,    
       B.MOV_START_DATE,    
       B.MOV_END_DATE,    
       A.ESU_START_DATE,    
       A.ESU_END_DATE,    
       LS.CLS_DESC,    
       'Week' || TRIM(TO_CHAR(pd.PRD_PERIOD_NUM)) WEEK_DESC
  FROM A
  LEFT JOIN B
    ON B.MOV_PER_GRO_ID = A.ESU_PER_GRO_ID    
  LEFT JOIN LS
    ON LS.CLS_CODE = A.STATUS    
  LEFT JOIN O_PERIODS pd
    ON B.MOV_START_DATE < pd.PRD_END_DATE AND
       (B.MOV_END_DATE IS NULL OR
        B.MOV_END_DATE > pd.PRD_START_DATE) AND
       A.ESU_START_DATE  < pd.PRD_END_DATE AND
       (A.ESU_END_DATE IS NULL OR
        A.ESU_END_DATE > pd.PRD_START_DATE)
WHERE B.MOV_START_DATE Is Not Null AND
      A.STATUS <> ('X') AND
      pd.PRD_CAL_ID = 'E1190' AND
      pd.PRD_YEAR = 2012
ORDER BY WEEK_DESC 
```

这会产生与原始查询略有不同的结果，使用 WEEK_DESC 而不是尝试创建 52 个不同的列，每周一个，但我认为它会执行得更好。

分享和享受。

# php - 向浏览器显示图像 (html/php)

> ID：11330607
> 
> 赞同：1
> 
> 时间：2012-07-04T14:02:01.593
> 
> 标签：php

我已经阅读了很多关于这个问题的主题，但我仍然有同样的问题。我无法理解逻辑但我认为。

所以我在我的系统中的一个文件夹中存储了一张图像，并且我的数据库中也注册了图像的路径。我只是想让用户将图像的标题插入到搜索表单中，并且在他们按下 OK 后，我想要特定的要显示的图像。

到目前为止，我发现了类似的代码： echo '';

他们对其他人很好，但不适合我

我的代码如下：

```
<?php
$con = mysql_connect("localhost","root","");

if (!$con)
{
die('Could not connect: ' . mysql_error());
} 

mysql_select_db("photoshare", $con);

$Title = $_POST['Title'];
$Creator = $_POST['Creator']; 

$result = mysql_query("SELECT path FROM images WHERE Title = '$Title' OR Creator = '$Creator'");

echo '<img src="' . $result . '" />'; 

//some code
mysql_close($con);
?> 
```

所以问题是没有显示任何图像。另一方面，正在显示损坏图像的图标。如果我做对了，就会发生错误，因为我没有输入我的 HTTP 必须看到的内容或类似的内容。我真的还没有理解它。

任何帮助，将不胜感激 ：）

谢谢你们，但同样的事情发生了：/我的上传文件如下，我希望它有帮助：

```
<?php
$con = mysql_connect("localhost","root","");

if (!$con)
{
die('Could not connect: ' . mysql_error());
}

mysql_select_db("photoshare", $con);

$Image_Title = $_POST['Image_Title'];
$Image_Creator = $_POST['Image_Creator'];
$Image_Date = $_POST['Image_Date'];
$Image_Genre = $_POST['Image_Genre'];

if ((($_FILES["file"]["type"] == "image/gif")
|| ($_FILES["file"]["type"] == "image/jpeg")
|| ($_FILES["file"]["type"] == "image/pjpeg"))
&& ($_FILES["file"]["size"] < 50000000))
  {
  if ($_FILES["file"]["error"] > 0)
    {
    echo "Return Code: " . $_FILES["file"]["error"] . "<br />";
    }
  else
    {
    echo "Upload: " . $_FILES["file"]["name"] . "<br />";
    echo "Type: " . $_FILES["file"]["type"] . "<br />";
    echo "Size: " . ($_FILES["file"]["size"] / 1024) . " Kb<br />";
    echo "Temp file: " . $_FILES["file"]["tmp_name"] . "<br />";

    if (file_exists("../photo_album/" . $_FILES["file"]["name"]))
      {
      echo $_FILES["file"]["name"] . " already exists. ";
      }
    else
      { 
      move_uploaded_file($_FILES["file"]["tmp_name"],
      "../photo_album/" . $_FILES["file"]["name"]);
      echo "Stored in: " . "../photo_album/" . $_FILES["file"]["name"];
      $path = "photo_album/" . $_FILES["file"]["name"];
      $query = "INSERT INTO images (title, creator, date, genre, path)
      VALUES ('$Image_Title', '$Image_Creator', '$Image_Date', '$Image_Genre', '$path')";     
      }
    }
  }
else
  {
  echo "Invalid file";
  }

 if (!mysql_query($query, $con)) {
    die("Error " . mysql_error());
}

?> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-04T14:04:02.897

您正在执行查询，但您还必须以数组或对象的形式检索结果。

```
<?php
mysql_select_db("photoshare", $con);

// Use mysql_real_escape_string to protect yourself from SQL injection
$Title = mysql_real_escape_string( $_POST['Title'] );
$Creator = mysql_real_escape_string( $_POST['Creator'] );  

$result = mysql_query("SELECT path FROM images WHERE Title = '$Title' OR Creator = '$Creator'");

$row = mysql_fetch_assoc( $result );

echo '<img src="' . $row['path'] . '" />'; 
```

此外，您不会逃避输入，这会使您面临严重的安全漏洞。使用[`mysql_real_escape_string()`](http://ca3.php.net/mysql_real_escape_string)任何用户提供的输入来避免这种情况。

最后，不推荐使用 mysql 扩展，您应该避免使用它（PHP.net 文档将其列为不推荐使用）。请考虑改用 PDO。这是您使用 PDO 重写的代码：

```
<?php
$con = new PDO( 'mysql:host=localhost;dbname=photoshare', 'root', '' );

if ( ! $con ) {
    die( 'Could not connect to the database' );
}

$stmt = $con->prepare( "SELECT path FROM images WHERE Title = :title OR Creator = :creator" );
$stmt->bindParam( ':title', $_POST['Title'] );
$stmt->bindParam( ':creator', $_POST['Creator'] );
$stmt->execute();

// Do this to output all found images
while ( $row = $stmt->fetch( PDO::FETCH_ASSOC ) ) {
    echo '<img src="' . htmlentities( $row['path'] ) . '" />'; 
}

// OR do this to output only one image
$row = $stmt->fetch( PDO::FETCH_ASSOC );
echo '<img src="' . htmlentities( $row['path'] ) . '" />'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T14:05:21.853

```
 <?php
    $con = mysql_connect("localhost","root","");

    if (!$con)
    {
    die('Could not connect: ' . mysql_error());
    } 

    mysql_select_db("photoshare", $con);

   $Title = mysql_real_escape_string( $_POST['Title'] );
$Creator = mysql_real_escape_string( $_POST['Creator'] );  

    $result = mysql_query("SELECT path FROM images WHERE Title = '$Title' OR Creator = '$Creator'");
    $row=mysql_fetch_assoc($result);

    echo '<img src="' . $row['path'] . '" />'; 

    //some code
    mysql_close($con);
    ?> 
```

# perl - 可以在 https 上的 WWW::Mechanize 中使用超时吗？

> ID：11330610
> 
> 赞同：1
> 
> 时间：2012-07-04T14:02:23.207
> 
> 标签：perl, https, timeout, mechanize, www-mechanize

我们有一个 Perl 脚本，它使用[WWW::Mechanize](http://search.cpan.org/~jesse/WWW-Mechanize-1.72/lib/WWW/Mechanize.pm)通过我们的公司代理使用 WWW::Mechanize 中的 POST 操作从安全 (https) 网站下载内容。

有时，由于未知原因，此发布操作会运行数小时。

我想控制这个。我检查了超时，但我还在 Stackoverflow 中的一篇文章中读到它不适用于 https 网站。

知道如何使用超时机制吗？

我想在一分钟左右后停止处理该链接以继续进行而不是一起等待几个小时。任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T16:20:14.390

使用[LWPx::ParanoidAgent](http://p3rl.org/LWPx::ParanoidAgent)并将其混合到 Mech 中。

> ```
> $ua->timeout(10); 
> ```
> 
> 从开始到结束，总共需要 10 秒。不仅仅是在套接字读取之间。它包括所有重定向。所以攻击者告诉你从恶意 tarpit 网络服务器下载只能让你停滞 $n 秒

# r - R：无法选择数据框中的特定列

> ID：11330620
> 
> 赞同：-2
> 
> 时间：2012-07-04T14:02:46.150
> 
> 标签：r, select, subset

我对选择给定列的功能有疑问。我有一个名为 Volume 的数据框，我想从中创建一个子集 DateSearch：

```
DateSearch = subset(Volume,select=c("TRI",name)) 
```

由于某种原因，它不起作用。我用过浏览器（）。我可以选择 TRI 或名称，但不能同时选择两者（无论是名称还是索引）。我试过有和没有“”。

有谁知道这是为什么？

非常感谢，文森特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T14:13:08.573

我只是做了你描述的（我认为）：

```
str(dfrm)
#'data.frame':  20 obs. of  8 variables:
# $ ID     : int  1 2 3 4 5 6 7 8 9 10 ...
# $ factor1: Factor w/ 4 levels "Not at all","To a small extent",..: 3 2 3 NA 3 NA 3 NA 4 1 ...
##   <snip>

 name = "factor1"
 subset(dfrm, select=c("ID", name)) 
```

没有错误，....结果符合预期。

仔细检查拼写。我的猜测是你在结果的开头或结尾有一个空格`as.character`。甚至可能是非印刷字符？你可以`nchar(name)`用来检查。

# c# - 如何将性能计数器更新到远程电脑？

> ID：11330621
> 
> 赞同：1
> 
> 时间：2012-07-04T14:02:57.430
> 
> 标签：c#, visual-studio-2010, unit-testing, load-testing, performancecounter

我创建了一些`Load Tests`. 我所有的负载测试都由一个单元测试组成。我还创建了一个`LoadTest Plug-in`并将其分配给我所有的负载测试。每个单元测试都会使用以下代码更新我在 LoadTest 插件中创建的一些自定义性能计数器（更多详细信息请[点击此处）。](https://stackoverflow.com/questions/8990448/vs-2010-load-tests-results-with-custom-counters)

**插件代码：**

```
private void m_loadTest_LoadTestStarting(object sender, System.EventArgs e)
{
    CounterCreationDataCollection counters = new CounterCreationDataCollection();
    counters.Add(new CounterCreationData("CustomCoumter", "Custom Coumter description", PerformanceCounterType.AverageCount64));

    PerformanceCounterCategory.Create("CustomCounterCategory", "Custom Performance Counters", PerformanceCounterCategoryType.MultiInstance, counters);
} 
```

**单元测试代码：**

```
[TestClass]
public class UnitTest1
{
    PerformanceCounter customCounter;

    [ClassInitialize]
    public static void ClassInitialize(TestContext TestContext)
    {
        // Create the instances of the counters for the current test
        customCounter= new PerformanceCounter("CustomCounterCategory", "CustomCoumter", "UnitTest1", false));
    }

    [TestMethod]
    public void TestMethod1()
    {
         // ... Testing
         customCounter.Incerement(time);
    }
} 
```

由于插件在`Test Controller`自定义计数器类别中运行，因此在控制器运行的 pc 中创建。现在我正在`Test Rig`使用许多`Test Agents`. 当单元测试在除测试控制器运行的计算机之外的其他计算机中执行时，计数器不会更新。我认为这是因为我的代码正在更新运行测试的 pc 中的计数器，而不是在控制器的 pc 中。

如何更新控制器 PC 中的自定义计数器？我是否必须以不同的方式在单元测试中创建计数器的实例？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T14:14:16.370

性能计数器通常用于监视在机器上本地运行的组件的性能。然后可以使用 perfmon 来监视该机器的性能计数器。根据您的描述，这正是正在发生的事情。

因此，您必须监视代理机器上的性能计数器（当然，在将其安装在那里之后）才能获取有关计数器的数据。

我假设这个计数器以某种方式测量测试需要多长时间。因为，如果您正在测量被测系统，那么性能计数器增量将被集成到被测生产代码中。

我不知道有什么方法可以在远程机器上增加性能计数器，但这似乎违反了通常的模式。但是，有一些方法可以[读取远程性能计数器](http://social.msdn.microsoft.com/Forums/en/vstswebtest/thread/b864bb24-e23a-41ca-9be2-6a913f2bf856)（例如，从代理机器）。我认为这在你的情况下是最好的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-16T09:22:54.110

我自己遇到了这个问题，发现您可以在代码中做的就是设置调用已预先安装在机器上的远程可执行文件。由于它将在本地运行，因此可以修改性能计数器。

您可以启动进程 psExec 或 WMI 代码。

[如何在远程机器上执行进程，在 C#](https://stackoverflow.com/questions/2343677/how-to-execute-process-on-remote-machine-in-c-sharp)

# javascript - CoffeeScript 原型错误

> ID：11330625
> 
> 赞同：5
> 
> 时间：2012-07-04T14:03:20.953
> 
> 标签：javascript, coffeescript

这是我正在尝试做的一个例子。

```
User = (name,dob,rank,score) -> 
    {
        name: name
        dob: dob
        details: {
            rank: rank
            score:score 
        }

        basicInfo: -> return "Name: #{@name} - Dob: #{@dob} - #{@details.rank} "
        detailedInfo: -> return "Name: #{@name} - Rank: #{@details.rank} - Score: #{@details.score}"
    }

User::displayName = ->
    console.log @name 

bob = new User("Bob","10/12/69",1,100000)

bob.displayName() 
```

我收到一条错误消息，上面写着“未捕获的类型错误：对象 # 没有方法 'displayName'”

不太确定为什么我会收到此错误。任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-04T14:15:57.397

您正在尝试在 coffeescript 中复制 javascript。很糟糕。（通过混合静态方法和原型方法。）

在 CoffeeScript 中，你可以使用关键字`class`来做你想做的事。

```
class User
    constructor: (@name, @dob) ->

    displayName: ->
        console.log @name

bob = new User "Bob", "10/12/69"

bob.displayName() // "Bob" 
```

更多信息：[http ://coffeescript.org/#classes](http://coffeescript.org/#classes)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-05T00:05:30.197

当您从构造函数返回一个新对象时，它不共享原型。适当的构造函数将属性/方法添加到`this`：

```
User = (name,dob,rank,score) -> 
  @name = name
  @dob = dob
  @details =
    rank: rank
    score: score 
  @basicInfo = -> return "Name: #{@name} - Dob: #{@dob} - #{@details.rank} "
  @detailedInfo = -> return "Name: #{@name} - Rank: #{@details.rank} - Score: #{@details.score}" 
```

您可能想利用 CoffeeScript 的`class`抽象，它只生成标准构造函数：

```
class User
  constructor: (name, dob, rank, score) ->
    @name = name
    @dob = dob
    @details:
      rank: rank
      score: score 
  basicInfo: ->
    return "Name: #{@name} - Dob: #{@dob} - #{@details.rank} "
  detailedInfo: ->
    return "Name: #{@name} - Rank: #{@details.rank} - Score: #{@details.score}" 
```

这在功能上与上面相同，除了`basicInfo`and `detailedInfo`here 已经在`prototype`它们应该在的位置。有了这个，`User::displayName = -> console.log @name`应该可以正常工作。

见[http://coffeescript.org/#classes](http://coffeescript.org/#classes)

# macos - OS X Mail - 在撰写模式下打开 *.eml 文件

> ID：11330628
> 
> 赞同：11
> 
> 时间：2012-07-04T14:03:37.297
> 
> 标签：macos, email

如何在 Mac OS X Mail 的撰写模式下打开 *.eml 文件？对于 Outlook，“X-Unsent: 1”似乎可以解决问题，但不适用于 Mac OS X 邮件仍以只读方式打开。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-10-19T22:19:35.147

这是一个超级古老的问题，但显然已经收到了相当多的意见。我的好奇心被激起了，我想我会去看看。经过一番摆弄，我发现您可以添加以下标题以使消息可编辑：

```
X-Uniform-Type-Identifier: com.apple.mail-draft 
```

将其添加到您原本符合 RFC-2822 的邮件中，为其添加`.eml`或`.emlx`扩展名，当您双击它时，它将在 Mail.app 中作为可编辑邮件打开。

玩得开心。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-02-13T02:27:57.747

在 macOS Catalina 10.15.7 中，从 Python 脚本运行以下命令可以打开一条新消息，然后切换到撰写模式，但是如果`osascript`命令运行太快，则在打开消息和将其置于撰写模式之间存在竞争条件. 该`sleep`命令用于防止竞争，但您可能需要调整睡眠时间长度以弥补这一点。（我也在`time.sleep(1)`Python 中使用，而不是 shell 命令。）

```
/usr/bin/open -a Mail path/to/tmp/message.eml
/bin/sleep 1
/usr/bin/osascript -e 'tell application "System Events" to tell application process "Mail"' -e 'keystroke "d" using {command down, shift down}' -e 'end tell' 
```

请注意，您必须授予对终端的访问权限才能控制其他应用程序，否则该`osascript`命令将失败并出现错误。为此，请打开系统偏好设置，单击安全和隐私项，单击左侧菜单中的辅助功能，单击锁定图标以解锁菜单，然后选中“允许应用程序”中的终端项（如果未列出则添加）来控制你的电脑。” 列表。

另请注意，Cmd-Shift-D 键盘快捷键发送的消息已经处于撰写模式，因此如果有人在脚本运行时正在使用 Mail，并且他们在前台有一个单独的撰写窗口，那么脚本可以发送该消息而不是将新消息置于撰写模式。

# iphone - 生成或转发触摸事件到视图？

> ID：11330634
> 
> 赞同：1
> 
> 时间：2012-07-04T14:03:54.173
> 
> 标签：iphone, ios, uiscrollview, uigesturerecognizer

我对 tap_gestureRecognizer 有一个看法。
这可能听起来很傻，但是当识别到点击时，我想将该触摸转发到与识别器关联的视图，并最终转发到视图的子视图。

我应该首先解释为什么我有识别器。
它可以抓取由于滚动视图而无法捕获的触摸。
[WWDC 2012 滚动视图会话](https://developer.apple.com/videos/wwdc/2012/)简要提到了它。

（滚动视图阻止触摸到它后面的视图，但如果后面的视图有手势识别器，它可以识别触摸）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T14:09:03.520

是的，UIGestureRecognizers 有一个属性，cancelsTouchesInView 正是这样做的。默认值为 YES，这会阻止将触摸传递到视图。通过将其设置为 NO，手势识别器和视图都将接收所有触摸。

```
gestureRecognizer.cancelsTouchesInView = NO; 
```

来自 Apple 的文档：

> 如果手势识别器无法识别其手势或者此属性的值为 NO，则视图将接收多点触控序列中的所有触摸。

# java - 子类/接口和超类之间的转换

> ID：11330636
> 
> 赞同：2
> 
> 时间：2012-07-04T14:04:00.137
> 
> 标签：java, class, interface, casting

考虑以下代码：

```
interface IFace {}

abstract class Supertype {}

class Subtype1 extends Supertype implements IFace {}
class Subtype2 extends Supertype implements IFace {}
class Subtype3 extends Supertype {}

class Foo {
    //Contains elements of Subtype1 and Subtype2
    List<IFace>     ifaceList = new ArrayList<IFace>();

    //Contains elements of Subtype1, Subtype2, and Subtype3
    List<Supertype> superList = new ArrayList<Supertype>();   

    void CopyItem() {
        superList.add( (Supertype) ifaceList.someElement() );
    }
} 
```

如果我知道只有子类型会实现，那么将`IFace`元素转换为安全吗？甚至有可能确保只有子类型会实现吗？`Supertype``IFace``IFace`

我正在尝试`IFace`用作标记界面，以仅在第一个列表中保留某些子类型，并在第二个列表中允许任何子类型。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T14:06:29.380

> 如果我知道只有子类型会实现 IFace，那么将 IFace 元素转换为 Supertype 是否安全？

是的。

> 甚至有可能确保这一点吗？

如果您的意思是“是否可以确保仅`Supertype`实现子类`IFace`”-否。接口可以由任何东西实现。

如果您的意思是“是否有可能确保演员成功” - 是的，您可以`instanceof`在演员之前使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T14:13:22.717

最安全的方法是让 Supertype 实现 IFace。如果这不可能，那么只要实现 IFace 的**每个类也是 Supertype 子类，就可以安全地将 IFace 元素强制转换为 Supertype。**您必须确保暂时适用，这很容易出错。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T14:21:05.963

> 如果我知道只有子类型会实现 IFace，那么将 IFace 元素转换为 Supertype 是否安全？

如果您确定所有 IFace 元素也扩展了 Supertype，那么这不会是一个问题。但在未来，这可能不再是真的。

> 甚至有可能确保这一点吗？

是的。您可以尝试在 ClassCastException 上捕获，甚至在使用运算符强制转换之前更好地对其进行测试`instanceof`

```
void CopyItem() {
    IFace obj = ifaceList.someElement();
    if (obj instanceof Supertype) superList.add( (Supertype)obj );
    else System.err.println("WARNING: IFace object is not a Supertype.");
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-08-01T04:33:15.213

> 如果我知道只有子类型会实现 IFace，那么将 IFace 元素转换为 Supertype 是否安全？

如果你知道你的代码，并且每个实现`IFace`的类也是 的子类`Supertype`，那没有问题，但你总是可以检查是否`Supertype`使用了`instanceof`运算符，以确保。

> 甚至有可能确保这一点吗？

考虑对您的代码进行以下修改：

```
interface IFace {}

abstract class Supertype {}

abstract class SupertypeAndFace extends Supertype implements IFace {}

class Subtype1 extends SupertypeAndFace {}
class Subtype2 extends SupertypeAndFace {}
class Subtype3 extends Supertype {}

class Foo {
    //Contains elements of Subtype1 and Subtype2
    List<SupertypeAndFace> ifaceList = new ArrayList<SupertypeAndFace>();

    //Contains elements of Subtype1, Subtype2, and Subtype3
    List<Supertype>        superList = new ArrayList<Supertype>();   

    void CopyItem() {
        superList.add(ifaceList.someElement());
    }
} 
```

在那里，不需要强制转换，因为您确保`SupertypeAndFace`extends`Supertype`和 implements的每个实例`IFace`。

毕竟，如果`Supertype`和`IFace`如此相关以至于您知道所有（或至少大多数）实现`IFace`的类也是 的子类`Supertype`，那么您可能需要那个新的抽象。

但是，如果您还想`ifaceList`包含实现 的其他元素`IFace`，但不是 的子类型`Supertype`，则此解决方案无效。如果是这种情况，您可以使用`instanceof`操作员检查演员表的安全性，如其他答案所述。

```
void CopyItem() {
    if (ifaceList.someElement() instanceof Supertype) {
        superList.add( (Supertype) ifaceList.someElement() );
    } else {
        // Throw exception if necessary
    }
} 
```

# testing - 测试阶段，冒烟测试在哪里？

> ID：11330639
> 
> 赞同：0
> 
> 时间：2012-07-04T14:04:14.787
> 
> 标签：testing, theory

所以我一直在看一本书，但我并不真正了解它们的分类：

```
Unit tests
Integration tests
Smoke and Sanity tests
System tests
Acceptance tests 
```

我认为烟雾测试会在集成后立即进行吗？此外，我认为健全意味着在部署新部件时快速检查应用程序。

还有一个问题：这是正确的还是烟雾和理智测试的顺序不同。如果是这样，为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T06:52:00.213

烟雾测试应该在健全性测试之前进行 - 这是正确的。冒烟测试的目的只是为了快速检查 SUT 是否可运行，它的接口和主要组件是否响应用户的操作。在这些测试期间，没有深入了解该应用程序。健全性测试可以是回归测试的子集。他们的主要目标是根据所提供的要求快速测试应用程序的逻辑。应该在每次重大改变系统某些部分的工作方式之后进行。如果结果是否定的，那么进行更详细的测试是没有意义的。他们应该向我们提供系统测试部分是否符合要求和规范的信息。

现在的问题是，健全性测试可以放入单元测试级别以及系统测试级别。您可以简单地运行一些专门设计用于仅检查基本功能的单元测试，这些可以称为健全性测试。这同样适用于系统测试级别。因此，对于健全性测试的地点没有严格的定义。我相信你不应该认为这是理所当然的，因为每个案例都是不同的，应该主要考虑测试和应用的上下文。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-04-18T05:26:07.883

冒烟测试是**对最重要功能的快速和肮脏测试，**通常由开发人员以外的其他人在单元和集成测试之后完成，以查看是否有必要进行更具体/严格的测试。

**关键功能的基本测试。**

*   只测试快乐的路径。
*   主要特点。

**例如，如果您正在冒烟测试 API**

*   检查响应是否正确。
*   使用有效的详细信息测试登录。
*   测试主要端点。
*   检查是否返回了正确的响应。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-12-08T07:26:54.070

冒烟测试是任何 QA 人员进行的首要测试。这是在开发人员完成单元测试后完成的。

执行冒烟测试的主要议程是相信您的应用程序至少可以处理正流。完成此操作后，QA 将逐步进行以下 1.功能测试 2.链接和下载选项 3.UI 4.系统测试 5.回归以获得先前构建的更好结果。

快乐测试:)

# c# - 将属性序列化为元素中的 Xml 属性

> ID：11330643
> 
> 赞同：78
> 
> 时间：2012-07-04T14:04:28.167
> 
> 标签：c#, .net, xml, xml-serialization

我有以下课程：

```
[Serializable]
public class SomeModel
{
    [XmlElement("SomeStringElementName")]
    public string SomeString { get; set; }

    [XmlElement("SomeInfoElementName")]
    public int SomeInfo { get; set; }
} 
```

哪个（当填充一些测试数据时）并使用 XmlSerializer.Serialize() 进行序列化会产生以下 XML：

```
<SomeModel>
  <SomeStringElementName>testData</SomeStringElementName>
  <SomeInfoElementName>5</SomeInfoElementName>
</SomeModel> 
```

我需要的是：

```
<SomeModel>
  <SomeStringElementName Value="testData" />
  <SomeInfoElementName Value="5" />
</SomeModel> 
```

有没有办法在不编写我自己的自定义序列化代码的情况下将其指定为属性？

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2012-07-04T14:12:48.020

您将需要包装类：

```
public class SomeIntInfo
{
    [XmlAttribute]
    public int Value { get; set; }
}

public class SomeStringInfo
{
    [XmlAttribute]
    public string Value { get; set; }
}

public class SomeModel
{
    [XmlElement("SomeStringElementName")]
    public SomeStringInfo SomeString { get; set; }

    [XmlElement("SomeInfoElementName")]
    public SomeIntInfo SomeInfo { get; set; }
} 
```

或者如果您愿意，可以使用更通用的方法：

```
public class SomeInfo<T>
{
    [XmlAttribute]
    public T Value { get; set; }
}

public class SomeModel
{
    [XmlElement("SomeStringElementName")]
    public SomeInfo<string> SomeString { get; set; }

    [XmlElement("SomeInfoElementName")]
    public SomeInfo<int> SomeInfo { get; set; }
} 
```

进而：

```
class Program
{
    static void Main()
    {
        var model = new SomeModel
        {
            SomeString = new SomeInfo<string> { Value = "testData" },
            SomeInfo = new SomeInfo<int> { Value = 5 }
        };
        var serializer = new XmlSerializer(model.GetType());
        serializer.Serialize(Console.Out, model);
    }
} 
```

将产生：

```
<?xml version="1.0" encoding="ibm850"?>
<SomeModel xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <SomeStringElementName Value="testData" />
  <SomeInfoElementName Value="5" />
</SomeModel> 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-04T14:07:38.410

有点，使用`XmlAttribute`而不是`XmlElement`，但它看起来不像你想要的。它将如下所示：

```
<SomeModel SomeStringElementName="testData"> 
</SomeModel> 
```

我能想到的（本机）实现您想要的唯一方法是让属性指向名为 SomeStringElementName 和 SomeInfoElementName 的对象，其中类包含一个名为“value”的getter。您可以更进一步并使用 DataContractSerializer 以便包装类可以是私有的。XmlSerializer 不会读取私有属性。

```
// TODO: make the class generic so that an int or string can be used.
[Serializable]  
public class SerializationClass
{
    public SerializationClass(string value)
    {
        this.Value = value;
    }

    [XmlAttribute("value")]
    public string Value { get; }
}

[Serializable]                     
public class SomeModel                     
{                     
    [XmlIgnore]                     
    public string SomeString { get; set; }                     

    [XmlIgnore]                      
    public int SomeInfo { get; set; }  

    [XmlElement]
    public SerializationClass SomeStringElementName
    {
        get { return new SerializationClass(this.SomeString); }
    }               
} 
```

# javascript - dojo 两个 xhr 请求和回调函数仅在两者都完成时触发

> ID：11330645
> 
> 赞同：3
> 
> 时间：2012-07-04T14:04:28.730
> 
> 标签：javascript, dojo, xmlhttprequest

有没有办法像这样处理多个 xhr 请求？一方面`xhr`，有一个内置的功能，但用于多个请求？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-04T16:33:45.520

一个dojo.xhr 返回一个dojo.Deferred，一个Deferred 是回调等的包装器。因此，在您的情况下，关键功能是 dojo.xhr({parameters})。**然后（回调函数）**。

虽然我们经常希望通过民意调查和计数器的简单快捷方式来实现并行 XHR，但 Dojo 也有这一点，正如 Craig 告诉 DeferredList 的那样；

您将触发两次 XHR，每次调用都返回一个处理程序，参考那些。创建一个列表，将这些引用作为参数，收集在一个数组中。然后作为最后的接触，在列表上附加一个“then”调用，

```
var dXhr1 = dojo.xhrGet({ url: ... });
var dXhr2 = dojo.xhrGet({ url: ... });
var dList = new dojo.DeferredList([dXhr1, dXhr2]);
dList.then(function(arrayOfValues) { 
    var res = "Result: succes?+"arrayOfValues[0][0].toString()+":"+arrayOfValues[0][1]+", "+
    succes?+"arrayOfValues[1][0].toString()+":"+arrayOfValues[1][1]+";
console.log(res);
}); 
```

或链式

```
new dojo.DeferredList([
     dojo.xhrGet({ url: ... }),
     dojo.xhrGet({ url: ... })
]).then(function(res) { console.log(res); }); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-04T14:08:52.930

A`DeferredList`会做你需要的。

[http://dojotoolkit.org/reference-guide/1.7/dojo/DeferredList.html](http://dojotoolkit.org/reference-guide/1.7/dojo/DeferredList.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-04T14:06:47.577

你不能用内部计数器触发一个回调函数吗？当该计数器达到 2 时，两个回调都已完成？

# javascript - Firefox 图像性能

> ID：11330646
> 
> 赞同：2
> 
> 时间：2012-07-04T14:04:41.110
> 
> 标签：javascript, performance, image, firefox, html5-canvas

如果这种情况继续下去，我会越来越生气：

Firefox 版本 6 - 13 在 Mac 和 Windows XP 上似乎存在严重的图像渲染性能问题。

`position: absolute; left: Xpx`无论我是通过 DIV还是使用 CSS3`transform: translateX(Xpx);`或*什至在画布元素*中移动多个图像，图像在移动时都会严重结巴。

你可以在这里查看我最新的 Canvas 测试：http: [//jsfiddle.net/5YCmH/6/](http://jsfiddle.net/5YCmH/6/)

我的问题是；**为什么会这样？** 正如我在网上看到和阅读的那样，CSS3 和 Canvas 现在应该是硬件加速的。所以我检查了 about:config 中的各种设置，甚至将它们重置为默认值。没有任何效果。虽然 Safari 和 Chrome 可以流畅地渲染一切，但 Firefox 看起来像 IE7。

我在 3 台不同的机器上进行了测试，到处都是同样的问题。人怎么了？任何指示或见解都会有所帮助！

PS：自从我像一年前切换到 Chrome 以来，我并没有使用太多 FF。在此之前，我制作了一个图像滑动小部件并在 FF 3.6.xx 中对其进行了测试，并且运行顺利（使用该`position: absolute; left: xx;`方法）。现在我正在测试我主要在 WebKit 浏览器中开发的代码，也在 FF 中，它根本不起作用。

这是真实生活吗？我觉得好笑。

**编辑：**

这是另一个显示与老式动画相同的口吃的小提琴：http: [//jsfiddle.net/XZAE6/3/](http://jsfiddle.net/XZAE6/3/)

并使用 CSS3 `translateX()`：http: [//jsfiddle.net/h3UNk/3/](http://jsfiddle.net/h3UNk/3/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T14:15:28.870

回答你的问题：是的，这就是现实生活......`;)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T14:21:59.093

这个问题可以通过使用较小的图像来解决。您的 Aquatics.jpg 为 193 KB，而 velodrome.jpg 为 140 KB。我确信尺寸可以减少至少 50 %，而不会显着降低图像质量。

# wpf - 双击通知图标后显示窗口（最小化到托盘后）

> ID：11330654
> 
> 赞同：2
> 
> 时间：2012-07-04T14:05:13.210
> 
> 标签：wpf, notifyicon

我想在我的 wpf 应用程序通知图标中使用（在项目[http://www.codeproject.com/Articles/36468/WPF-NotifyIcon](http://www.codeproject.com/Articles/36468/WPF-NotifyIcon)中使用 .dll 库）。

但我不知道，如何通过双击托盘图标来显示我的窗口（最小化到托盘后）。

我宣布了新的命令

```
namespace MyBasicFlyffKeystroke
{
    class ShowWindowCommand : ICommand
    {
        public void Execute(object parameter)
        {
            Window1 window = new Window1();
            window.Show();
        }

        public bool CanExecute(object parameter)
        {
            return true;
        }

        public event EventHandler CanExecuteChanged;
    }
} 
```

我在 window1.xaml 文件中使用了它：

```
<tb:TaskbarIcon x:Name="notifyIcon" IconSource="icon.ico" ToolTipText="MyBasicFlyffKeystroke" 
    DoubleClickCommand="{StaticResource ShowWindow}">                    
</tb:TaskbarIcon> 
```

和

```
<Grid.Resources>
    <my:ShowWindowCommand x:Key="ShowWindow" />
</Grid.Resources> 
```

但是在用 Window1 双击打开新实例后...这里有什么方法吗？

最好的问候， 达格纳

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T14:25:34.690

尝试为窗口消息添加事件处理程序

**命令**

```
namespace MyBasicFlyffKeystroke
{
    class ShowWindowCommand : ICommand
    {
        public void Execute(object parameter)
        {
            // Broadcast isn't a good idea but work...
            NativeMethods.PostMessage((IntPtr)NativeMethods.HWND_BROADCAST, NativeMethods.WM_SHOWME, IntPtr.Zero, IntPtr.Zero);
        }

        public bool CanExecute(object parameter)
        {
            return true;
        }

        public event EventHandler CanExecuteChanged;
    }
} 
```

**在窗口 1**

```
protected override void OnSourceInitialized(EventArgs e) {
    base.OnSourceInitialized(e);
    HwndSource source = PresentationSource.FromVisual(this) as HwndSource;
    source.AddHook(WndProc);
}

private IntPtr WndProc(IntPtr hwnd, int msg, IntPtr wParam, IntPtr lParam, ref bool handled) {
    if (msg == NativeMethods.WM_SHOWME) {
        WindowState = WindowState.Normal;
    }
    return IntPtr.Zero;
} 
```

**在 NativeMethods 中（更新）**

```
public static readonly int HWND_BROADCAST = 0xffff;
public static readonly int WM_SHOWME = RegisterWindowMessage("WM_SHOWME");

[DllImport("user32.dll")]
public static extern int RegisterWindowMessage(string message);

[DllImport("user32.dll")]
public static extern bool PostMessage(IntPtr hwnd, int msg, IntPtr wparam, IntPtr lparam); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-01-04T17:26:11.673

```
Application.Current.Window1.Show(); 
```

这对我有用

# r - 使用 R 链接方法

> ID：11330659
> 
> 赞同：10
> 
> 时间：2012-07-04T14:05:26.707
> 
> 标签：r, method-chaining

是否可以在 R 中链接函数？

样本数据：

```
m <- matrix(c(1:10, 11:20), nrow = 10, ncol = 2) 
```

例如，我想替换以下语句：

```
step1 <- mean(m)
step2 <- sum(step1)
res <- step2 
```

或者，

```
res <- sum(mean(m)) 
```

像这样：

```
res <- m@mean()@sum() 
```

在某些情况下，这将大大澄清我的代码。

EDIT1 这是一个虚拟示例。我随机选择了“sum”和“mean”。

Ben 使用 %@% 给出了第一个答案，但是它阻止了在函数中使用额外的参数：

```
m %@% function1(arg1, arg2) %@% function2(arg1, arg2) 
```

我该如何解决这个问题？

EDIT2 添加一个例子

```
require(xts)
require(PerformanceAnalytics)
xts.ts <- xts(rnorm(231),as.Date(13514:13744,origin="1970-01-01"))
plot(na.omit(lag( rollapply(xts.ts, width=rolling.per-1, FUN= function(x){sqrt(var(x))*sqrt(252)}), k=1)), main = "Dummy Example") 
```

这个例子似乎适用于查尔斯解决方案：

```
`%@%` <- function(x, f) eval.parent(as.call(append(as.list(substitute(f)), list(x), 1)))
xts.ts %@% rollapply( width = rolling.per-1, FUN= function(x) x%@%var%@%sqrt * sqrt(252) ) %@% lag( k=1) %@% na.omit %@% plot(main = "Dummy Example") 
```

对我来说不太重要，但值得一提的是，以下陈述因查尔斯的解决方案而失败：

```
 xts.ts %@% names <- 'ts name' 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-04T15:07:00.520

试试功能包：

```
library(functional)
squared <- function(x)x*x
Compose(sum, squared)(m)
## [1] 44100
squared(sum(m))
## [1] 44100 
```

编辑：

关于另一个关于论点的回答的评论中的问题，这里是一个用论点组成的例子。 `Curry`也是来自功能包：

```
addn <- function(n, x) x + n
Compose(Curry(addn, 1), squared)(10)
## [1] 121
squared(addn(1, 10))
## [1] 121 
```

编辑2：

关于调试`debug`的问题，如果函数被咖喱，则有效。如果它还没有被咖喱，那么把它包起来`Curry`：

```
# this works since addn is curried
debug(addn)
Compose(Curry(addn, 1), squared)(10)

# to debug squared put it in a Curry -- so this works:
debug(squared)
Compose(Curry(addn, 1), Curry(squared))(10) 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-07-04T14:27:10.693

有点，但我认为这是不习惯的，可能很脆弱/不是一个好主意。（我认为，@RichieCotton 上面的评论暗示了这一点。）

从[http://cran.r-project.org/doc/manuals/R-lang.html](http://cran.r-project.org/doc/manuals/R-lang.html)：

> 10.3.4 特殊运算符
> 
> R 允许用户定义中缀运算符。它们具有由“%”字符分隔的字符串形式。该字符串可以包含除“%”之外的任何可打印字符。字符串的转义序列不适用于此处。
> 
> 请注意，以下运算符是预定义的
> 
> ```
>  %% %*% %/% %in% %o% %x% 
> ```

```
"%@%" <- function(x,f) {
    f(x)
}

sqr <- function(x) x^2
x <- 1:4

x %@% mean  ## 2.5
x %@% mean %@% sqr  ## 6.25
x %@% (mean %@% sqr)  ## fails 
```

如上所述`m`- 也许你的想法是什么？

```
 m %@% colMeans %@% sum  ## 21 
```

笔记：

*   你的例子有点好笑，因为`mean(x)`总是返回一个标量（即长度为 1 的向量），所以`sum(mean(x))`总是与`mean(x)`
*   中缀运算符必须由 包围`%`，因此您不能拥有像单个符号那样紧凑的东西（并且`%%`已经被采用）。
*   这种链接是非关联的，这让我很担心——上面的例子似乎有效，所以 R （显然）是从左到右评估的，但我不知道这是有保证的......

**编辑**：现在的问题询问如何合并其他参数。我认为建议的语法 ( `x %@% fun1(arg1) %@% fun2(arg2)`) 不会在没有一些严肃的魔法的情况下起作用。这是我目前能得到的最接近的——创建一个包装函数，该函数创建原始函数的修改版本。

```
F <- function(f,...) {
    function(x) {
        f(x,...)
    }
} 
```

测试：

```
pow <- function(x,b=2) { x^b }
sqr <- function(x) x^2
x <- 1:4

x %@% F(mean,na.rm=TRUE)  ## 2.5
x %@% F(mean,na.rm=TRUE) %@% F(pow,3)  ## 16.25 
```

（请注意，我在`F`这里使用了一个函数，在某些情况下可能会很冒险，因为它会覆盖`F==FALSE`快捷方式）

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-09-01T10:13:20.173

我会使用这个`magrittr`包。它有一个“管道”运算符，它获取一个函数的结果并将其作为参数传递给下一个函数：

```
m <- matrix(c(1:10, 11:20), nrow = 10, ncol = 2)

m %>% mean %>% sum 
```

Ceci n'est pas un pipe！

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-07-05T05:18:02.457

与本的回答类似，但允许争论：

```
`%@%` <- function(x, f) eval.parent(as.call(append(as.list(substitute(f)), list(x), 1)))

x %@% mean %@% sqr # => 6.25
c(1, 2, NA, 3, 4) %@% mean(na.rm=T) %@% sqr # => 6.25
m %@% colMeans() %@% sum() # => 21 
```

# php - mySQL 显示为数组

> ID：11330664
> 
> 赞同：0
> 
> 时间：2012-07-04T14:05:41.093
> 
> 标签：php, mysql, arrays, levenshtein-distance

我试图让这段代码正常工作，但我一生都无法让它继续下去......我想要一个显示“你的意思是什么”的搜索。有了代码，我得到了它“你的意思是：数组 l:6”我在这里有什么问题？

```
$my_word = $_REQUEST['value'];
$bestMatch = array('word' => $my_word, 'match' => 2);
$result = mysql_query("SELECT keyword FROM athena");
while ($keyword = mysql_fetch_array($result)) {
    $lev = levenshtein ($keyword, $my_word, 1, 2, 1);
    if (!isset($lowest) || $lev < $lowest) {
       $bestMatch = array('word' => $keyword, 'match' => $lev);
       $lowest = $lev;
     }
 }
 if ($bestMatch['match'] > 0)
   echo 'Did you mean: <strong>'.$bestMatch['word'].'</strong> l:'.$bestMatch['match']; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-04T14:07:32.203

您将整个搜索结果集传递给`levenshtein()`函数而不是关键字：

```
while ($row= mysql_fetch_array($result)) {
    $lev = levenshtein ($row['keyword'], $my_word, 1, 2, 1);
    if (!isset($lowest) || $lev < $lowest) {
       $bestMatch = array('word' => $row['keyword'], 'match' => $lev);
       $lowest = $lev;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T14:12:59.833

$keyword 是一个数组（一维），而不是单列。你应该 mysql_fetch_field 你想要的列

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T14:08:55.660

```
<?php
while ($keyword = mysql_fetch_array($result))
?> 
```

$keyword 是一个数组！您的单词在 $keyword[0] 或 $keyword['keyword'] 中。将您的第 7 行替换为

```
$bestMatch = array('word' => $keyword['keyword'], 'match' => $lev); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-04T14:11:28.260

正如[PeeHaa](https://stackoverflow.com/users/508666/peehaa)和[jeroen](https://stackoverflow.com/users/42139/jeroen)已经说过的，MySQL 结果返回一个数组。

把它倒出来看看里面有什么

```
if ($bestMatch['match'] > 0) {
  var_dump($bestMatch['word']);
  echo 'Did you mean: <strong>'.$bestMatch['word'].'</strong> l:'.$bestMatch['match'];
} 
```

很可能那里还有另一个 [ ] ，所以这可能有效：

```
echo 'Did you mean: <strong>'.$bestMatch['word'][0].'</strong> l:'.$bestMatch['match']; 
```

# python - crontab 和脚本

> ID：11330665
> 
> 赞同：2
> 
> 时间：2012-07-04T14:05:46.823
> 
> 标签：python, linux, cron, sh

我有debian linux。我从用户创建了`crontab -e`这个文本：

```
0   * * * * python /home/user/CronLogic.py
15  * * * * python /home/user/CronLogic.py
30  * * * * python /home/user/CronLogic.py
45  * * * * python /home/user/CronLogic.py

*/1 * * * * date > /tmp/TEST 
```

最后一个字符串运行良好，但运行 python 脚本失败：

```
/bin/sh: 1: /usr/bin/rcssserver: not found 
```

代码是：

```
#!/usr/bin/python
cmd ='/usr/bin/rcssserver'
err = open('CronLogicERRORS', 'a')
server = subprocess.Popen(cmdRes, shell=True, stderr=err) 
```

并且错误出现在`CronLogicERRORS`文件中。这里有什么问题？没有 cron 脚本运行良好。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-04T14:25:18.520

```
cmd ='/usr/bin/rcssserver'
#                ^^^ Too many s's 
```

现在，关于您的`cron`用法：

与其有 4 次相同的行，不如让它成为 1 行`0,15,30,45`，甚至更好`*/15`。而你的`*/1`是多余的，简单`*`的更好。

# ruby-on-rails - 自注册之日起 34 周内发送电子邮件

> ID：11330667
> 
> 赞同：0
> 
> 时间：2012-07-04T14:05:58.087
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.1

ruby 上的新手，使用 windows xp 和 rails 3，我想每 7 天向用户发送电子邮件，持续 34 周，我有 usermailer，每 7 天发送电子邮件，我也想要**34 周**？

我有用户邮件程序向用户发送电子邮件，我已经定义了一种方法，每 7 天发送一次电子邮件，并使用 Windows 任务计划程序从批处理文件中调用它，
我还想知道用户现在在哪一周？

例如，用户在 4 月怀孕并在 6 月发情，然后会有一条欢迎消息，然后她怀孕的前 8 周不在我们的记录中，这意味着电子邮件将从第 9 周开始，因为 34 - 8 = 26周，因此用户将收到 26 封电子邮件（每 1 周 1 封电子邮件）。

我的模型：

```
class Dop < ActiveRecord::Base
  attr_accessible :date, :mail, :name
  validates_presence_of :name
  validates_presence_of :mail
  validates_uniqueness_of :mail
  validates_format_of :mail, :with =>
  %r{^(?:[_a-z0-9-]+)(\.[_a-z0-9-]+)*@([a-z0-9-]+)(\.[a-zA-Z0-9\-\.] 
  +)*(\.[a-z]{2,4})$}i

  def self.send_mail
    Dop.all.each do |dop|
      UserMailer.welcome_email(dop).deliver if dop.date.to_time <= Time.now - 7.day
    end
  end
end 
```

我的批处理文件：

```
 echo rails run
 cd c:\dop
 rails r "Dop.send_mail"

 echo done
 pause 
```

Dop 是指怀孕日期。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T17:24:10.620

根据您的环境，纯 ruby​​ 解决方案如下所示：

```
class Dop < ActiveRecord::Base
  def self.send_mail
    Dop.all.each do |dop|
      UserMailer.welcome_email(dop).deliver if within_thirty_four_weeks?(date) && seventh_day(dop.date) 
    end
  end

  def self.seventh_day?(date)
    days_diff % 7 == 0
  end

  def self.within_thirty_four_weeks?(date)
    days_diff(date) <= 34.weeks
  end

  def self.days_diff(date)
    (Time.zone.now - date).to_i / 1.day
  end
end 
```

但是，我更喜欢更多的数据库解决方案。其中这变得更复杂，sqlite 没有与 MySql 或 Postgres 相同的日期函数。（可以修补 Sqlite 以保持您的测试/开发环境像生产一样，但我将其保存为另一个问题。）

```
class Dop < ActiveRecord::Base
  def self.send_mail
    Dop.where("(julianday('now') - julianday(date(date))) % 7 = 0").
        where("date('now', '-238 days') < date").
        each do |dop|
          UserMailer.welcome_email(dop).deliver
    end
  end
end 
```

就个人而言，数据库解决方案（选项 2）是最优雅的解决方案。虽然它更脆弱，因为它特定于 sqlite 的日期函数。

将此安排为每晚运行，它将每 7 天通过电子邮件发送一次，持续 34 周。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T10:31:09.710

我已经通过在我的类方法中添加 1 行代码来解决它

```
 def self.send_mail
  Dop.all.each do |dop| 
  where(dop.date.to_time <= Time.now - 34.week)
  UserMailer.welcome_email(dop).deliver if dop.date.to_time <= Time.now - 7.day
   end
 end 
```

# django - Django，当我们有不同的角色时使用/设计一个行级权限系统

> ID：11330670
> 
> 赞同：0
> 
> 时间：2012-07-04T14:06:18.773
> 
> 标签：django, permissions, django-permissions, role-base-authorization, row-level-security

我正在开发一个学习管理系统。

该系统有几个演员，如学生、导师、管理员、院长等。现在，我需要一个可以处理不同角色的权限系统（学生可以将课程添加到他们的购物篮，导师可以 CRUD 课程，管理员也可以访问财务部分以及等等）

根据我的研究，我需要一些可以处理不同角色的行级权限系统。我见过一些类似的应用程序`django-guardian` `djang-permissions` `django-rulez`，等等。但仍然对如何基于它们设计角色感到困惑（它们没有很好的文档记录）。

任何人都可以给我一个提示来完成这项痛苦的工作吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T14:39:45.267

Django 内置了一个非常好的身份验证/授权 api

我建议您阅读以下文档：[https](https://docs.djangoproject.com/en/dev/topics/auth/) ://docs.djangoproject.com/en/dev/topics/auth/这为您提供了基础知识。

对于您的应用程序，最好的方法是设置某些内容的权限，例如编辑课程的权限。然后，您可以为您的视图使用所需的权限装饰器，以允许您执行这些操作。例如，如果您有一个视图：

```
def edit_course(request):
    ...#handle form rendering/submission for course model 
```

你可以在上面添加这个视图：

```
@permission_required('course_editor')
def edit_course(request):
    ...#handle form rendering/submission for course model 
```

然后只有拥有此权限的用户才能访问该功能。

您可以通过创建可以分配权限的组来更进一步，例如教师组，然后您可以将所有员工分配到该组，他们将继承此“course_editor”权限。

但正如我所说，这个问题对于特定答案来说有点宽泛，所以你最好的选择是在上面的 url 中了解文档。

# asp.net-mvc-3 - ASP.NET MVC 3 - 使控制器中的视图选择通用

> ID：11330671
> 
> 赞同：1
> 
> 时间：2012-07-04T14:06:19.350
> 
> 标签：asp.net-mvc-3

我的控制器中有两个动作，它们共享负责选择视图的部分逻辑。我怎样才能使这部分在动作中通用。例子：

控制器文件

*   行动开放

    1.  如果找到一个文档并且类型为 X，则使用 OpenX 视图显示它
    2.  如果找到一个文档并且类型为 Y，则使用 OpenY 视图显示它
    3.  如果找到多个文档，则使用列表视图显示列表
    4.  如果没有找到文档，使用错误视图显示错误
*   动作 OpenMetaData

    1.  如果找到一个文档，则使用 OpenMetaData 视图显示它
    2.  如果找到多个文档，则使用列表视图显示列表
    3.  如果没有找到文档，使用错误视图显示错误

如您所见，点 3,4 与 2,3 相同

我想创建类似的东西

```
public DocumentController
{

    public ActionResult Open( ... )
    {
       var dataFromWebService = service.GetData( ... );
       return ViewSelector.GetLaunchView(dataFromWebService);
    }

    public ActionResult Open( ... )
    {
       var dataFromWebService = service.GetData( ... );
       return ViewSelector.GetOpenMetaData(dataFromWebService);
    }
}

public class ViewSelector
{
     public static ActionResult GetLaunchView(DataFromWebService dataFromWebService)
     {
          if( dataFromWebService contains document type X)
              return new ViewResult("OpenX",data);
          if( dataFromWebService contains document type Y)
              return new ViewResult("OpenY",data);
          return CommonLogic(dataFromWebService);
     }

     public static ActionResult GetOpenMetaData(DataFromWebService dataFromWebService)
     {
          ......
     }

     private static ActionResult CommonLogic(DataFromWebService dataFromWebService)
     {
          .... Common logic
     }
} 
```

我想这样做是为了让我的控制器尽可能干净。

我可以在控制器外部创建 ViewResults，将数据附加到它们并在操作中返回它们吗？

这是好还是坏的设计？

也许有人有更好的想法如何处理这个

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T18:36:11.857

如果您不需要访问控制器的任何上下文，您可以在控制器之外创建结果。在您的情况下，我会考虑将 GetOpenMetaData() 和 GetLaunchView 方法设为控制器的私有方法。

如果您需要跨多个控制器共享它，您还可以考虑将其放入抽象 BaseController 并让您的控制器继承它。

# parameters - 传递给打包安装程序的运行时变量？

> ID：11330676
> 
> 赞同：1
> 
> 时间：2012-07-04T14:06:32.983
> 
> 标签：parameters, nsis

我有一个 NSIS 脚本，可以检查它运行的平台并启动适当的 MSI。这很好用，但这意味着我不能`/SILENT`在捆绑的安装程序上使用参数。

有没有办法获取整个参数字符串并将其传递给 msi 安装程序？

这是我目前的代码：

```
Section
Initpluginsdir
${If} ${RunningX64}
  File "/oname=$pluginsdir\inst.msi" "${DIR}\64bit.msi"
${Else}
  File "/oname=$pluginsdir\inst.msi" "${DIR}\32bit.msi"
${EndIf}
ExecWait '"msiexec" /i "$pluginsdir\inst.msi"'
SectionEnd 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T16:03:32.790

```
!include "FileFunc.nsh"
...
${GetParameters} $0
ExecWait '"msiexec" /i "$pluginsdir\inst.msi" $0' 
```

# c# - 创建大量字典或单个组合字典来保存计数器变量更好吗？

> ID：11330677
> 
> 赞同：0
> 
> 时间：2012-07-04T14:06:33.317
> 
> 标签：c#

例如，我可以创建一个字典来分别保存每个计数器变量类别：

```
private Dictionary<Int32, Int32> CountersA = new Dictionary<Int32, Int32>();
private Dictionary<Int32, Int32> CountersB = new Dictionary<Int32, Int32>();
private Dictionary<Int32, Int32> CountersC = new Dictionary<Int32, Int32>(); 
```

字典键将在所有字典中通用，并且条目的数量将在运行时更改，因为这是针对多点触控应用程序，生成的键数将是手指触摸的数量。

每个字典条目的计数器将在运行时快速添加并实时重置（即当手指在表面上移动时）。任何给定的键将始终出现在每个字典中，每个字典中该键的值将用于不同的目的。

例如，创建一个包含任何给定 Key 的所有值的 Struct 会更好吗? 或者是否有更好的方法来做到这一点，记住速度性能是这里的问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T15:14:56.503

如果您只有手指触摸的数量（比如 10 ;-) 作为键，您需要跳过字典并确实创建一个包含您的数据的结构数组。

```
var FingerData = new myStruct[maxFingers]; 
```

这样，您将直接指向数据（字典为 O(1)，但需要根据您的密钥计算存储桶）。它也将是一个更小的数据结构，因此它更适合缓存和 cpu 寄存器，因此可能会更快一点。

# android - 隐藏卡上的文件 SDclient

> ID：11330678
> 
> 赞同：0
> 
> 时间：2012-07-04T14:06:33.973
> 
> 标签：android, pdf, pdf-viewer

我将 .pdf 文件下载到客户端的存储卡中，以便可以使用 pdfViewer 查看它，问题是我不希望用户可以使用它或将其复制到应用程序之外。我想在他的记忆中用另一个扩展名保存它，但看不到完全有效。有任何想法吗？

![在此处输入图像描述](../Images/0693940a55d9f08762acec88deaf029f.png)

谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T14:07:55.233

除了加密文件、将文件保存在内存中或在完成后立即将其删除之外，您无能为力。

如果将其保存到应用程序受保护的空间，则可以为大多数设备提供一些保护。尽管如此，已获得根目录的设备仍然可以访问。这并非完全万无一失。

# dynamics-crm - Dynamics CRM 托管解决方案添加客户集参数

> ID：11330687
> 
> 赞同：0
> 
> 时间：2012-07-04T14:06:56.373
> 
> 标签：dynamics-crm, microsoft-dynamics

我正在创建一个解决方案，它将作为 Dynamics CRM Online 的托管解决方案发布。但是，客户在安装托管解决方案时需要输入信息以允许与外部服务交互。例如，当您安装 LinkedIn 解决方案时，您需要添加您的登录信息以允许 CRM 访问您的 LinkedIn 帐户。

如何将这些参数添加到解决方案中，然后允许客户在它们发生变化时对其进行更新？

干杯

编辑：添加到我的查询并遵循以下答案。为了确保这个过程在我的脑海中是正确的。

选项 1。我将创建一个自定义实体来存储键/值或用户名/密码组合。然后，我将使用 html Web 资源为解决方案创建一个自定义页面，提交时，javascript 将创建一个记录来保存这些值。

然后，我需要链接需要存储在自定义记录中的值的每条记录 - 我不确定在创建存储记录后不编辑工作流的情况下如何完成此操作，以将每个正常记录链接到存储记录。

选项 2\. 创建一个存储值的 xml Web 资源。使用配置页面创建 html/javascript 资源以更新它。然后，我可以在创建自定义实体时使用 javascript 函数来获取该数据，也许可以填充隐藏字段以进行存储和在幕后使用。我找不到任何关于以这种方式开始使用 xml 的教程 - 你能指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T13:35:26.740

我通常创建一个具有名称/值属性的“配置”实体。当您拥有需要不同配置（例如 URL、凭据等）的开发/测试/生产环境时，这也很有用。

另一种方法是[使用插件配置或 Web 资源](http://gonzaloruizcrm.blogspot.com/2011/09/adding-configuration-to-plugins-in-crm.html)来存储该类型的信息。*如果*您可以让客户使用插件注册工具来修改值，那么插件配置非常简单。

# c# - 在客户端项目中实现库方法

> ID：11330688
> 
> 赞同：2
> 
> 时间：2012-07-04T14:07:02.260
> 
> 标签：c#, inheritance, interface

我们有一个库，其中包含几个具有不同功能的程序集。我们在为客户开发的任何前端项目中都使用这个库。假设我想在库中执行特定的任务/方法，但该方法的实现必须在前端。

简而言之：库中的X类调用库中Y类的方法A，但是方法A需要在库外实现。如何？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T15:07:34.377

将 ClassY 定义为 Abstract 类，要求使用者为定义为 Abstract 的方法提供实现。在 ClassY 基础上定义的逻辑对所有派生类都是通用的，在 ClassY 基础上定义为“抽象”的方法将需要由每个派生类实现。请注意，我只是将它一起破解，所以我没有声称实际代码代表最佳实践！

抽象基类：

```
public abstract class AbstractLibraryClassY
{
    private static int _multiplier = 0;

    public abstract int MethodA(int SomeParam);

    // A simple example Property defined and implemented on the Abstract base class:
    public int Multiplier
    {
        get { return _multiplier; }
        set { _multiplier = value; }
    }

    private void someclassYImplementationStuff()
    {
        // Other implementation code . . .
    }
} 
```

ClassY 的两种可能实现：

```
public class ConcreteClassYImplementationOne : AbstractLibraryClassY
{
    public override int MethodA(int SomeParam)
    {
        return SomeParam * this.Multiplier;
    }
}

public class ConcreteClassYImplementationTwo : AbstractLibraryClassY
{
    public override int MethodA(int SomeParam)
    {
        return SomeParam * this.Multiplier + 5;
    }
} 
```

X 类，使用 ClassY 的实例：

```
public class LibraryClassX
{
    public int methodCallsClassYMethodA(AbstractLibraryClassY ImplementedClassY)
    {
        ImplementedClassY.Multiplier = 2;
        return ImplementedClassY.MethodA(100);
    }
} 
```

一个简单的演示，它使用 X 类按顺序使用 ClassY 的每个实现：

```
public class Consumer1
{
    public void ConsumeClassX()
    {
        // Some hokey, arbitrary inputs:
        int MyInput = 200;
        int MyMultiplier = 2;

        // Consume Library Class Y using ConcreteClassYImplementationOne:
        AbstractLibraryClassY InstanceOf = new ConcreteClassYImplementationOne();
        InstanceOf.Multiplier = MyMultiplier;

        // Will output 400, per implementation defined in ConcreteClassYImplementationOne:
        Console.WriteLine("Output = " + InstanceOf.MethodA(MyInput).ToString());

        // Consume Library Class Y using ConcreteClassYImplementationTwo:
        InstanceOf = new ConcreteClassYImplementationTwo();
        InstanceOf.Multiplier = MyMultiplier;

        // Will output 405, per implementation defined in ConcreteClassYImplementationTwo:
        Console.WriteLine("Output = " + InstanceOf.MethodA(MyInput).ToString());

    }
} 
```

希望有帮助。还要查看评论者的建议：依赖注入。我现在才开始研究（这可能就是我刚才描述的 - 不确定，必须研究！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T14:16:53.733

您可以从您的库中公开一个委托，并让消费者将其设置为指向他们自己的实现。

例子：

```
public delegate void DoWorkDelegate(CustomWorkParameters p);

public DoWorkDelegate DoWorkCallback
{
  get
  {
    return _workCallback;
  }
  set 
  {
    _workCallback = value;
  }
} 
```

稍后在您的库中，当您需要实际完成工作时：

```
private void DoWorkInternal() 
{
  //Some work here

  //Check if caller set the callback
  if(_workCallback != null) 
  {
     _workCallback(localWorkParameters);
  }  
  else 
  {
     //throw exception
  }
  //Some more work here
} 
```

消费者应该有一个尊重委托签名的方法，并在初始化阶段将其传递给您的库。

# c# - c# mvc 以编程方式将文本加载到文本框中

> ID：11330689
> 
> 赞同：0
> 
> 时间：2012-07-04T14:07:08.343
> 
> 标签：c#, asp.net-mvc

我是 mvc 的新手，在普通的 asp.net 中我可以在心跳中做到这一点，但我仍然在努力让我的头脑了解 mvc！

基本上我没有为此应用程序使用数据库，它是一个简单的工具，可以修改大量文本并将其输出给用户。

因为文本量太大，我希望用户能够通过下载文本文件来保存和加载他们输入的文本。我想出了如何保存它，但我似乎无法找到一种可以加载文本的方法。

然而，对于这个例子，让我们只使用标准字符串，因为我知道如何解析我的保存文件并将文本放入适当的字符串中。我不知道如何将这些字符串放入文本框中。没有附加模型，因为它没有被验证或存储在服务器上。

View1（我的文本区域的布局方式）

```
 <label for="p1s1">Sentance 1:</label>
  <%= Html.TextArea("p1s1", new { @class = "textbox" })%> <p> 
```

最好创建一个新视图，然后将参数传递给 view1？我真的被困在这里了！

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T14:11:31.487

创建强类型视图（由您的模型键入） ![在此处输入图像描述](../Images/510f1c8172b190a559914054a96f32d2.png)

并使用助手，例如： Html.TextAreaFor(model=>model.myProperty)

例如：

```
class User 
{
(...)
public string Description {get;set;}
} 
```

如果您的视图是通过使用键入的`User`：

```
Html.TextAreaFor(model=>model.Description) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T14:16:31.693

mvc 中的模型不仅适用于您想要将数据保存到数据库甚至将它们存储在服务器上的情况。实际上，建议您创建模型只是为了反映视图的数据需求（称为视图模型），然后在需要时将它们链接到您的域模型。所以我建议你创建一个模型并将字符串从视图传递到控制器，反之亦然。然后您可以使用@Kamil 对 TextArea 助手的建议来显示模型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T17:33:42.963

看一下这个：

**控制器：**

```
public class HomeController : Controller
{
    public ActionResult Index()
    {
        //do your text magix
        return View("Index", model: "your text here");
    }
} 
```

**看法：**

```
<%@ Page Language="C#" Inherits="System.Web.Mvc.ViewPage<String>" %>

<!DOCTYPE html>

<html>
<head runat="server">
    <title>Index</title>
</head>
<body>
    <div>
        <label for="p1s1">Sentence 1:</label>
        <%= Html.TextArea("p1s1", Model, new { @class = "textbox" })%>
    </div>
</body>
</html> 
```

希望这可以帮助。否则，让我现在。问候。

# iphone - 我们可以限制免费应用程序在 iOS 设备上第二次下载或安装吗

> ID：11330691
> 
> 赞同：1
> 
> 时间：2012-07-04T14:07:14.927
> 
> 标签：iphone, ios5, ios4, ios-simulator

我必须限制免费应用程序在 iOS 设备上第二次下载或安装，因为我希望用户购买相同的付费版本。免费应用程序的第一次用户可以下载免费应用程序并将其安装在他们的 iOS 设备上，但在使用免费应用程序一定次数后，免费应用程序将使用有限的功能，因为我想推广我的付费版本，所以我提示用户购买我的付费版本的应用程序。此时，用户可以删除我的免费应用程序并从 iTunes 商店或计算机上的 iTunes 或 iCloud 备份中重新安装相同的应用程序。问题是如何限制用户第二次在他们的 iOS 设备上重新安装相同的免费应用程序？有什么方法可以告诉用户的iOS' s 设备停止第二次安装相同的免费应用程序？或者有没有其他方法可以达到同样的效果？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T14:14:19.550

由于这些限制，您不太可能可靠地通过 Apple 的审核流程。

免费/精简版应用程序本身应该是完全可用的应用程序。因此，以待办事项应用为例：

*   您*可以*将其限制为十个 TODO 项
*   但是如果它在十天后停止工作，你就会遇到麻烦

显然，您还可以限制您提供的功能。例如，我的应用程序只允许在付费版本中进行编辑；免费的是只读的。

我不确定你能否可靠地做你想做的事。（如果我必须擦除手机并从备份中恢复呢？这算作重新安装吗？）但即使可以，也不一定是个好主意。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-04T14:12:55.277

我认为推荐的方法是使用应用内购买。您可以在用户购买时为其启用完整版本。所以不需要重新安装。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-04T14:13:39.837

我不确定你为什么有你做的要求，但这不适合 App Store 的模型。即使您想办法做到这一点，您的申请也可能会被拒绝。

如果您（或您的利益相关者）坚持采用这种方法，那么 App Store 可能不适合您。

# javascript - javascript电子邮件验证而不提交

> ID：11330702
> 
> 赞同：-2
> 
> 时间：2012-07-04T14:07:44.890
> 
> 标签：javascript, email, validation

我想验证这封电子邮件：

```
<div>
    <div>

        <div  >
            <big><p>please enter an email address IF you wish to
            recieve a link to your results.<p>
            E-mail Address:</big> <input name="recipient"class="upload" type="text"
            />
        <div id="correct">
            &#10004;
        </div>
        <div id="incorrect">
            &#10008;
        </div>
    </div>
</div> 
```

我想检查电子邮件输入是否有效，如果有效则显示“正确”的 div，如果不显示“不正确”的 div，我想在不提交表单的情况下执行此操作。

没人能帮忙吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T14:10:35.980

基于多个 JS 框架的客户端验证的几种替代方案/插件/解决方案可用。我只引用了一个使用 jQuery 的示例： http: [//speckyboy.com/2009/12/17/10-useful-jquery-form-validation-techniques-and-tutorials-2/](http://speckyboy.com/2009/12/17/10-useful-jquery-form-validation-techniques-and-tutorials-2/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T14:10:59.600

这是一个使用正则表达式匹配值的函数。

```
<script language="javascript">
    function checkEmail() {
    var email = document.getElementById('recipient');
    var filter = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
    if (!filter.test(email.value)) {
    alert('Please provide a valid email address');
    email.focus;
    return false;
    document.getElementById('incorrect').style.visibility="visible";
    document.getElementById('correct').style.visibility="hidden";
    }
    else
    {
    document.getElementById('correct').style.visibility="visible";
    document.getElementById('incorrect').style.visibility="hidden";
    }
    }
    </script> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-04T14:12:30.237

[从这个答案](https://stackoverflow.com/a/46181/459338)

```
function validateEmail(email) { 
    var re = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\ ".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
    return re.test(email); 
} 
```

# php - 如何启动并运行 PDO？

> ID：11330704
> 
> 赞同：0
> 
> 时间：2012-07-04T14:07:52.203
> 
> 标签：php, mysql, pdo

我是一个新手 PHP 程序员，直到几天前才听说过 PDO。到目前为止，我刚刚在我的网站上使用了 PHP 中的默认 MySQL 函数，但从我一直在阅读的内容来看，我似乎真的应该切换到 PDO。

我重新编译了 Apache，启用了 PDO，但是当我尝试连接以下代码时：

```
try 
{
    $dbh = new PDO('mysql:host=localhost;dbname=' . $dbname, $user, $pass);
}
catch (PDOException $e) 
{
    print "Error!: " . $e->getMessage() . "<br/>";
    die();
} 
```

我得到错误：

```
Error!: could not find driver 
```

我运行 phpinfo() 并发现以下与 PDO 相关：

> './configure' '--disable-fileinfo' '--disable-phar' '--enable-bcmath' '--enable-calendar' '--enable-ftp' '--enable-gd-native-ttf ' '--enable-libxml' '--enable-magic-quotes' '--enable-mbstring' '--enable-pdo=shared' '--enable-sockets' '--prefix=/usr/local' '--with-apxs2=/usr/local/apache/bin/apxs' '--with-curl=/opt/curlssl/' '--with-freetype-dir=/usr' '--with-gd' '--with-gettext' '--with-imap=/opt/php_with_imap_client/' '--with-imap-ssl=/usr' '--with-jpeg-dir=/usr' '--with-kerberos ' '--with-libxml-dir=/opt/xml2/' '--with-mcrypt=/opt/libmcrypt/' '--with-mysql=/usr' '--with-mysql-sock=/var /lib/mysql/mysql.sock' '--with-mysqli=/usr/bin/mysql_config' '--with-openssl=/usr' '--with-openssl-dir=/usr' '--with-pcre-regex=/opt/pcre' ' --with-pdo-sqlite=shared' '--with-png-dir=/usr' '--with-sqlite=shared' '--with-xpm-dir=/usr' '--with-zlib' '--with-zlib-dir=/usr'

```
PDO
PDO support enabled
PDO drivers     sqlite, sqlite2

pdo_sqlite
PDO Driver for SQLite 3.x   enabled
SQLite Library  3.7.7.1 
```

如何让 PDO 工作？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T14:12:55.327

您还应该添加 pdo-mysql 扩展：

```
--with-pdo-mysql=shared 
```

一些额外的信息：

还总是添加数据库的编码：

```
$dbh= new PDO('mysql:dbname=dbtest;host=127.0.0.1;charset=utf8', 'user', 'pass'); 
```

始终禁用模拟的准备好的语句（对于 mysql）

```
$dbh->setAttribute(PDO::ATTR_EMULATE_PREPARES, false); 
```

由于您刚刚开始使用 PDO，我还建议您使用本教程：[http ://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers](http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers)

# qlikview - 如何制作将多个文件加载到一个表中的加载脚本

> ID：11330705
> 
> 赞同：1
> 
> 时间：2012-07-04T14:07:52.377
> 
> 标签：qlikview

我有多个按约定命名的文件：“data_YYYY.MM.xslx”我需要将所有这些文件加载​​到一个 qlikview 表中，但是当我这样做时：

```
Tab:
load Name, Number from [data_*.csv]; 
```

我得到每个文件的 Tab、Tab-1、Tab-2 文件。

我也尝试过：

```
Tab:
add load Name, Number from [data_*.csv]; 
```

具有相同的效果。

如果有人知道如何做到这一点，请帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-09-19T21:49:08.753

这个问题没有任何意义，除非你省略了一些细节。

QlikView**将**通过如下语句将所有数据隐式附加到原始表“Tab”：

选项卡：从 [data_*.csv] (txt) 加载名称、编号；

*请注意括号中指定的文件格式。*

每当使用与已创建的表完全相同的字段名称加载表时，就会隐式地附加数据。因此，在您的示例中，遇到的第一个文件构成了该文件中的数据负载。假设确实根据您的问题引用了字段名称，则结果表中应包含两个字段：“名称”和“编号”。当通过通配符匹配遇到第二个文件时，将进行第二次加载，并将该数据附加到表“Tab”中。

如果您不希望依赖隐式连接（用于将数据附加到现有表的 QlikView 术语），那么您可以编写一个 FOR 循环来加载您的文件，而不是使用显式 CONCATENATE 加载前缀指向您希望将数据附加到的表.

例如

// QV 技巧来“声明”一个表

标签： LOAD null() AS Name AUTOGENERATE(1) WHERE RecNo() < 0;

对于文件列表中的每个文件（'data_*.csv'）

CONCATENATE('Tab') 加载 * FROM [$(file)] (txt);

下一个文件

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-04T15:39:01.850

这个技巧对我有用：

```
tmp:
LOAD @1 inline [@1];
Tab:
Concatenate load Name, Number from [data_*.csv]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-04T17:25:28.660

你可以这样做：

```
Load * from data_*.csv; 
```

只需在文件名中使用掩码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-10-07T10:54:22.967

为了完整性，一种循环方式（这里使用 qvd 文件）：

```
FOR Each db_schema in '2013-07','2013-08','2013-09'
LOAD ...., db_schema
FROM `x-$(db_schema)`.`qvd` (qvd);
next; 
```

（知道名字。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-16T20:15:43.180

如果文件名不同，这是另一种方法

选项卡：从 [data_1.csv] 加载名称、编号；join (Tab) 从 [data_2.csv] 加载名称、编号；

# c# - 在 C# 中创建和打印表格报告

> ID：11330712
> 
> 赞同：2
> 
> 时间：2012-07-04T14:08:24.840
> 
> 标签：c#, .net

我需要创建一个简单的应用程序，该应用程序将根据数据库数据和一些用户输入生成报告。我有丰富的 C/C++ 经验，但对于这个项目，我们必须选择 C#。

我想尽可能避免使用需要在客户端机器上安装的第 3 方组件。因此，我什至想避免使用 MS Office 提供的功能（我本可以使用 XLS 模板，就像我的前任一样，但它看起来不像是一条路；无论如何，我前任的资源早已丢失，这可能很好，因为它是一个大约有 10 年历史的 VB 怪物，时不时崩溃）。水晶报告等也是如此。

我目前的想法是动态构建 HTML 表格（使用`HtmlDocument`），将它们呈现给用户（使用`WebBrowser`）并打印出来。这是正确的方法吗？有没有更简单/更健壮/更好的方法？可能的陷阱是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T14:15:17.307

即时构建表格会起作用。我经常使用这种技术，但对我来说这似乎是一种黑客行为。我只使用它是因为很多时候，业务需求需要“足够好”和快速周转，而不是“漂亮”。

* * *

我将倾向于我将要建议的内容，即我自己对 3rd 方组件有强烈的偏见。

在大多数情况下，我完全拒绝使用它们，并且会不遗余力地提出另一种解决方案，因为我经常被升级/许可所困扰。

那就是说...

幸运的是，对于 .NET，并非所有第 3 方组件都需要安装到您的客户端 PC 上。使用 XCOPY 部署，您通常可以只引用解决方案中的 .DLL 或项目，并指定“始终复制”或“如果较新则复制”选项以仅包含 dll（或如果您引用类库项目，则为生成的 dll ) 并且只要 .dll 与可执行文件位于同一目录中，第 3 方组件就可以工作。

考虑到所有这些，我使用了一个项目来从[CodeProject](http://www.codeproject.com/Articles/25638/Printing-a-DataGridView-on-DotNet-Framework)的 Windows 窗体打印 DataGridView 。这是一个您可以获取源代码、引用它并使用它的工具，而无需在客户端实际安装任何东西。我在不止一个应用程序中使用过它，它是我最喜欢的工具之一。

它只会打印 DataGridView，但它会完全按照屏幕上显示的方式打印它，所以如果这是你想要的，我建议至少检查一下。

* * *

作为第三种选择，您可以考虑使用 ASP.NET。如果您要生成 HTML，使用 ASP.NET 与在 WinForms 应用程序中一样容易（实际上更容易）。使用 ASP.NET，您可以获得Repeaters、ListViews 等，所有这些都使报表易于创建。

我有不止一个实际应用程序，主要是 WinForms 应用程序，但有一个相关的报告站点。

例如，我有一个 WinForms 应用程序，用于扫描我们零售店接受的优惠券。这是一个 WInForms 应用程序，因为我需要直接与 COM 端口上的扫描仪交互。但是，对于报告部分，我建立了一个 ASP.NET 网站。在 WinForms 应用程序中，创建报告菜单选项并指向页面非常简单。我们的用户通常甚至不会想到这是两个不同的应用程序。他们将其视为一个 - 他们的优惠券扫描应用程序。

所有这一切的重点是，通常可以使用任何给定的工具来做事，但使用适合这项工作的工具要容易得多。如果您要生成 HTML 报告，ASP.NET 是比手动构建报告更好的工具，如果您需要为大部分 UI 使用 WinForms 应用程序，您仍然可以这样做并使用该网站进行报告 - 为每项任务使用最佳工具。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T14:14:15.557

也许您想检查[RazorEngine](http://razorengine.codeplex.com/)来创建您的 HTML 模板。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T14:14:24.403

我推荐你使用[Razor 引擎](http://razorengine.codeplex.com/)来渲染 html，它比使用 HtmlDocument 对象更灵活。

您可以使用您的报告模板创建一个文件，然后解析它并发送您的报告行对象的集合。

# google-app-engine - Google Drive API V2 , Python — 创建新文件而不上传新文件且不使用 Google Drive UI

> ID：11330715
> 
> 赞同：5
> 
> 时间：2012-07-04T14:08:39.653
> 
> 标签：google-app-engine, google-drive-api

我发现的所有与创建新文件并将新文件放入用户的 Google Drive 文件夹相关的文档都是通过用户上传文件并让 python 脚本使用 MediaFileUpload 收集文件并将其放入 Drive 中来实现的。

我想在我的 GAE 代码中创建一个新文件，然后将其放入。例如，我的代码在访问数据库后会呈现一个新的 XML 字符串，我想获取该字符串，使其成为一个文件并放入 Google Drive。

有人在做这样的事情吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-04T20:53:05.677

您应该使用专门为此目的而设计的 MediaInMemoryUpload。您可以传递一个字符串和一个 MIME 类型。

```
media = MediaInMemoryUpload('some data', 'text/plain') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T23:51:28.690

使用以下代码，内容是您要输入的字符串。您不必使用 MediaFileUpload 和 python 客户端库。

```
def update(content, file_id):
    url = 'https://www.googleapis.com/upload/drive/v2/files/%s?uploadType=media' % file_id
    headers = {
        'Content-Type': 'text/plain',
        'Content-Length': str(len(content)),
        'Authorization': 'Bearer <oauth2 token>'
        }
    response = urlfetch.fetch(url, payload=content, method='PUT', headers=headers)
    assert response.status_code == 200
    return response.content 
```

# django - 在 Django 1.3.1 中预取一对多记录

> ID：11330718
> 
> 赞同：0
> 
> 时间：2012-07-04T14:08:42.647
> 
> 标签：django, django-1.3

我正在遍历一个查询集并获取一个一对多的字段。现在，对于每个调用，都会触发一个查询。Django 1.4 有 prefetch_related。如何使用 Django 1.3.1 做类似的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T14:22:30.093

试试[https://github.com/ionelmc/django-prefetch](https://github.com/ionelmc/django-prefetch)

听起来不错：

用于 Django 的简单且通用的模型相关数据预取框架，解决了当您需要对象相关数据时发生的“1+N 查询”问题。在大多数情况下，您将拥有前向关系（某事物的外键），并且可以使用 select_related 在同一查询中获取该数据。但是，在某些情况下，您无法以这种方式设计模型，并且需要来自反向关系的数据（具有对象外键的模型）。Django 1.4 对此有 prefetch_related，然而，这个框架提供了比 Django 1.4 的 prefetch_related 查询集方法更大的灵活性，代价是为数据编写映射和查询函数。这样做的好处是您可以做 prefetch_related 不能做的事情（参见下面的 latest_book 示例）。

# javascript - 将多个添加到一个表单时，Asp.Net 用户控件无法正常工作

> ID：11330722
> 
> 赞同：2
> 
> 时间：2012-07-04T14:08:53.483
> 
> 标签：javascript, jquery, asp.net, user-controls

我制作了一个用户控件，允许上传图像然后裁剪，但是当我在一个表单上有几个这样的控件时，只有最后一个添加的控件才能正常工作。问题是函数 storeCoords，对 X、Y、W 和 H 隐藏字段没有影响，因此当作物“橡皮筋”移动时，这些值不会改变。添加最终控件后，随着“橡皮筋”的移动，隐藏字段也会更新，然后一切都会按预期工作。为什么当我在一个页面上有几个这样的控件时，只有最后一个的 javascript 按预期工作。

```
<script src="/Controls/ImageUploadAndCrop/Javascript/jquery.Jcrop.min.js" type="text/javascript"> </script>
<link href="/Controls/ImageUploadAndCrop/CSS/jquery.Jcrop.min.css" rel="stylesheet" type="text/css" />

<script type="text/javascript">
    $(window).on('load', function ()
    {

        var elem = $('#<%= CropImage.ClientID %>'),
            boxWidth = elem.width(),
            boxHeight = elem.height();

        elem.Jcrop({
            onSelect: storeCoords,
            boxWidth: boxWidth,
            boxHeight: boxHeight
        });

        $('#<%=CropButton.ClientID%>').click
        (
            function ()
            {
                var cropImg = $('.jcrop-holder img');

                $('#<%= ImgWidth.ClientID %>').val(cropImg.width());
                $('#<%= ImgHeight.ClientID %>').val(cropImg.height());
            }
        );
    });

        function storeCoords(c)
        {
            $('#<%= X.ClientID %>').val(c.x);
            $('#<%= Y.ClientID %>').val(c.y);
            $('#<%= W.ClientID %>').val(c.w);
            $('#<%= H.ClientID %>').val(c.h);
        }
 </script>
<div>
    <asp:Panel ID="UploadPanel" runat="server">
        <asp:FileUpload ID="Upload" runat="server" />
        <br />
        <asp:Button ID="UploadButton" runat="server" OnClick="UploadButton_Click" Text="Upload" />
        <asp:Label ID="ErrorLabel" runat="server" Visible="false" />
    </asp:Panel>
    <asp:Panel ID="CropPanel" runat="server" Visible="false">
        <asp:Image ID="CropImage" runat="server"/>
        <br />
        <asp:HiddenField ID="X" runat="server" />
        <asp:HiddenField ID="Y" runat="server" />
        <asp:HiddenField ID="W" runat="server" />
        <asp:HiddenField ID="H" runat="server" />
        <asp:HiddenField ID="ImgWidth" runat="server"/>
        <asp:HiddenField ID="ImgHeight" runat="server"/>
        <asp:Button ID="CropButton" runat="server" Text="Crop" OnClick="CropButton_Click" />
    </asp:Panel>
    <asp:Panel ID="CroppedPanel" runat="server" Visible="false">
        <asp:Image ID="CroppedImage" runat="server" />
    </asp:Panel>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T15:33:55.057

我发现这个控件有几个问题：

1.

```
 var elem = $('#<%= CropImage.ClientID %>'),
            boxWidth = elem.width(),
            boxHeight = elem.height(); 
```

这些行不应该跟一个分号“;” 而不是逗号？但也许是一个错字。

2.

因为您在页面的多个位置使用此控件，所以您需要注意任何 JavaScript 代码的“重复”外观：

例如，`<script>`每次将控件添加到页面时，都会出现以下标记。

```
<script src="/Controls/ImageUploadAndCrop/Javascript/jquery.Jcrop.min.js" type="text/javascript"> </script> 
```

然而，这不会对功能造成任何不利影响（我认为？！），但下面的函数肯定会这样做，因为 JavaScript 将拥有更多具有相同参数的相同函数的副本。考虑哪一个？

```
function storeCoords(c)
        {
            $('#<%= X.ClientID %>').val(c.x);
            $('#<%= Y.ClientID %>').val(c.y);
            $('#<%= W.ClientID %>').val(c.w);
            $('#<%= H.ClientID %>').val(c.h);
        } 
```

一个快速的解决方法是：

```
 elem.Jcrop({
            onSelect: storeCoords<%= CropImage.ClientID %>,
            boxWidth: boxWidth,
            boxHeight: boxHeight
        }); 
```

和

```
function storeCoords<%= CropImage.ClientID %>(c) { ... } 
```

这样，您将拥有唯一的函数名称。

然而，ASP .Net 具有处理使用 JavaScript 的用户控件的机制。请参阅[客户端脚本管理器](http://msdn.microsoft.com/en-us/library/stax6fw9)

# hibernate - 使用 2 个实体和带有 group by 的聚合函数时如何处理 JPA 中的 TypedQueries？

> ID：11330726
> 
> 赞同：3
> 
> 时间：2012-07-04T14:09:12.470
> 
> 标签：hibernate, jpa, hql, jpa-2.0, jpql

到目前为止，我选择了这样的实体：

```
 public List<Customer> findAll()
 {
     TypedQuery<Customer> query = getEntityManager().createNamedQuery(Customer.FindAll, Customer.class);

     return query.getResultList();
 } 
```

这行得通。通过从结果集中调用这些实体的方法，我什至可以从“连接”表中获取数据，因此我不需要在 JPQL 中进行“真正的”连接。（这就是 JPA 的意义所在）。

现在我想获得一个客户列表，其中包含在给定时间段内的营业额，比如说 2011 年 1 月到 2012 年 6 月。本机查询将如下所示：

```
select cus_customer_code, cus_last_name, sum(trn_total_turnover_euro) 
from customer, transaction 
where t2c_cus_id = cus_id 
and date_part('month', trn_date) between 1 and 6 
and date_part('year', trn_date) between 2011 and 2012
group by cus_customer_code, cus_last_name; 
```

此查询在数据库中工作。但是我怎么能在 JPQL 中做到这一点，这个语句的结果是什么，一对 2 个实体的列表或类似的东西？或者这在 JPQL 中是不可能的，所以我必须改用本机查询吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-04T14:12:30.057

用你想要的成员创建一个额外的类。在这个例子中，`org.test.MyClass`。

```
public MyClass {
    private String message;
    private Int time;

    public MyClass ( String msg, Int time ) { ... }

    // get / set
} 
```

然后使用

```
List<MyClass> list = em.createQuery("SELECT NEW org.test.MyClass( 'Foo', 123 ) FROM IrcEvent ev", MyClass.class).getResultList(); 
```

或者，对于标量值：

```
List<Object[]> list = em.createQuery("SELECT 'Foo', 123 FROM IrcEvent ev", Object[].class).getResultList(); 
```

Hibernate 直到最近才正确实现标量： [https ://hibernate.onjira.com/browse/HHH-6591](https://hibernate.onjira.com/browse/HHH-6591)
[https://hibernate.onjira.com/browse/HHH-6695](https://hibernate.onjira.com/browse/HHH-6695)

`SELECT`这是一篇关于s 的好文章： [http ://www.objectdb.com/java/jpa/query/jpql/select](http://www.objectdb.com/java/jpa/query/jpql/select)

Hibernate 手册对其进行了简要介绍： http: [//docs.jboss.org/hibernate/orm/4.1/manual/en-US/html_single/#queryhql-select](http://docs.jboss.org/hibernate/orm/4.1/manual/en-US/html_single/#queryhql-select)

# c# - 在 FlowLayoutPanel 中调整用户控件之间的间距

> ID：11330734
> 
> 赞同：25
> 
> 时间：2012-07-04T14:09:43.897
> 
> 标签：c#, winforms, user-controls, flowlayoutpanel

我正在构建一个 WinForms 应用程序窗口（表单），其中我使用的是 FlowLayoutPanel，其中添加了用户控件。现在我一直在查看 FlowLayoutPanel 和 UserControl 的属性，但似乎找不到与用户控件之间的间距有关的任何内容。我希望用户控件彼此更接近，即使只有几个像素。用户控件本身在 numericUpDown 的任何一侧都没有空格。任何的意见都将会有帮助。

我的流布局面板：

![示例流布局面板](../Images/6306849dea3be21426cbc1ed8d711ca2.png)

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-07-04T14:18:40.923

`Panel`和其他类似的控件都具有`Margin`和`Padding`属性。填充确定控件内部的间距......例如面板。如果在 Panel 控件中将 Padding 设置为 3（全部），则控件将对齐控件内部边缘的 3 个像素的填充。

保证金的工作方式相同，但在其他控件之间。如果 Margin 设置为 3（All），控件将自动捕捉到边距间距。

我没有使用 FlowLayoutPanel，但是有一次，IIRC，您可以为单元格设置填充。检查用户控件的边距，并检查布局单元格的填充。将一个设置为 0，将另一个设置为 3。

# groovy - soapUi：可以将参数列表发送到测试用例

> ID：11330737
> 
> 赞同：0
> 
> 时间：2012-07-04T14:09:47.573
> 
> 标签：groovy, soapui

是否可以将参数列表发送到soapUI中的测试用例/步骤？我想执行一些数据库验证，并且希望能够将预期值列表传递给测试用例和/或执行验证的步骤。

我知道可以将单个参数（“属性”）发送到测试用例，但我认为这对于这个用例来说还不够好。我的想法是编写一个“测试用例”来执行可以从其他测试用例调用的验证，并且它们传递他们希望在数据库中找到的值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-04-07T11:13:56.963

如果您可以通过 Groovy 脚本生成随机参数列表，那么最好的解决方案是：通过 groovy 脚本设置属性字段的值，并使用属性传递将该值传递给请求。每次运行 groovy 脚本时，属性字段值都会发生变化。

现在在 groovy 脚本中循环运行请求。因此我们可以使用不同的参数值多次运行一个测试请求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-24T10:15:01.793

我们有一个类似的问题。我们需要运行多个 XML 文件作为请求序列的源文件。我们在测试中进行了大约 15 个步骤，唯一改变的是初始 XML。

我们通过使用 groovy 将属性设置为逗号分隔列表来解决此问题，然后选择第一个元素，将其从列表中删除，然后运行测试。最后，如果属性不为空，我们将返回“从列表中选择第一个元素”步骤。

这是一个基本循环的 goto 实现，我们希望以不同的方式执行此操作，但我们还没有弄清楚如何（我们通过 maven2 运行soapUI）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-31T13:45:18.123

如果您使用的是 soapUI Pro，您可以创建一个数据源步骤 > 请求步骤 > 数据源循环步骤。

dataSource步骤可以以excel、XML、grid为源。您需要创建一个属性并选择源的类型。

下一步是运行请求。

然后你应该创建一个 dataSource 循环步骤。此步骤返回数据源，直到运行所有请求。

请查看[soapui文档](http://www.soapui.org/Data-Driven-Testing/functional-tests.html)

如果您不使用soap Pro 版本，则创建一个groovy 脚本是如上一个答案所述的解决方案。

# ios - 将 GestureRecogniser 附加到多个图像视图

> ID：11330738
> 
> 赞同：2
> 
> 时间：2012-07-04T14:09:58.530
> 
> 标签：ios, uiimageview, uigesturerecognizer

我今天在将相同的手势识别器附加到多个图像视图时遇到了一些奇怪的事情。它只附加到最后一个，换句话说，它只能附加到一个视图！

我必须创建多个手势识别器来满足我的要求。

以下是我所做的。我做得对吗？这是将识别器附加到多个图像视图的唯一方法吗？

请注意，我不想使用 UITableView 或 UIVIew 并将所有图像视图放入其中并将手势识别器仅附加到 UITableView 或 UIVIew。我把所有图像都分散了，我必须检测哪个图像被拖动。谢谢。

```
[imgView1 setUserInteractionEnabled:YES];
[imgView1 setMultipleTouchEnabled:YES];

[imgView2 setUserInteractionEnabled:YES];
[imgView2 setMultipleTouchEnabled:YES];

[imgView3 setUserInteractionEnabled:YES];
[imgView3 setMultipleTouchEnabled:YES];

[imgView4 setUserInteractionEnabled:YES];
[imgView4 setMultipleTouchEnabled:YES];

[imgView5 setUserInteractionEnabled:YES];
[imgView5 setMultipleTouchEnabled:YES];

[imgView6 setUserInteractionEnabled:YES];
[imgView6 setMultipleTouchEnabled:YES];

//Attach gesture recognizer to each imagviews
gestureRecognizer1 = [[UILongPressGestureRecognizer alloc] initWithTarget:self action:@selector(gestureHandler:)];
gestureRecognizer1.delegate = self;

gestureRecognizer2 = [[UILongPressGestureRecognizer alloc] initWithTarget:self action:@selector(gestureHandler:)];
gestureRecognizer2.delegate = self;

gestureRecognizer3 = [[UILongPressGestureRecognizer alloc] initWithTarget:self action:@selector(gestureHandler:)];
gestureRecognizer3.delegate = self;

gestureRecognizer4 = [[UILongPressGestureRecognizer alloc] initWithTarget:self action:@selector(gestureHandler:)];
gestureRecognizer4.delegate = self;

gestureRecognizer5 = [[UILongPressGestureRecognizer alloc] initWithTarget:self action:@selector(gestureHandler:)];
gestureRecognizer5.delegate = self;

gestureRecognizer6 = [[UILongPressGestureRecognizer alloc] initWithTarget:self action:@selector(gestureHandler:)];
gestureRecognizer6.delegate = self;

[imgView1 addGestureRecognizer:gestureRecognizer1];
[imgView2 addGestureRecognizer:gestureRecognizer2];
[imgView3 addGestureRecognizer:gestureRecognizer3];
[imgView4 addGestureRecognizer:gestureRecognizer4];
[imgView5 addGestureRecognizer:gestureRecognizer5];
[imgView6 addGestureRecognizer:gestureRecognizer6]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T15:13:09.023

是的，每个手势识别器一个视图。因此，如果您只想要一个识别器，请将其放在 superview 上，例如：

```
UILongPressGestureRecognizer *gestureRecognizer = [[UILongPressGestureRecognizer alloc] initWithTarget:self action:@selector(gestureHandler:)];
[self.view addGestureRecognizer:gestureRecognizer]; 
```

然后，在您的处理程序中，您可以：

```
- (void)handleLongPress:(UILongPressGestureRecognizer *)sender
{
    CGPoint location = [sender locationInView:self.view];

    if (sender.state == UIGestureRecognizerStateBegan)
    {
        for (UIView *view in self.view.subviews)
        {
            if ([view isKindOfClass:[UIImageView class]] && CGRectContainsPoint(view.frame, location))
            {
                UIImageView *image = (UIImageView *) view;

                // ok, now you know which image you received your long press for
                // do whatever you wanted on it at this point

                return;
            }
        }
    }
} 
```

顺便说一句，如果您这样做，您也不必担心在图像上启用用户交互。

最后，您无需担心指定手势识别器的委托，除非您要遵守`UIGestureRecognizerDelegate`，但事实并非如此。另请注意，我使用本地 var 作为识别器，因为没有理由坚持使用它。

**更新：**

虽然上面的代码可以正常工作，但如果长按没有发生在图像上，自定义长按手势识别器可能会更好（这样，如果您有其他手势识别器占用，它更有可能发挥良好的作用）放在您的视野中）。所以：

```
#import <UIKit/UIGestureRecognizerSubclass.h>

@interface ImageLongPressGestureRecognizer : UILongPressGestureRecognizer
@property (nonatomic, weak) UIImageView *imageview;
@end

@implementation ImageLongPressGestureRecognizer

@synthesize imageview = _imageview;

- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
{
    self.imageview = nil;

    [super touchesBegan:touches withEvent:event];

    CGPoint location = [self locationInView:self.view];

    for (UIView *view in self.view.subviews)
    {
        if ([view isKindOfClass:[UIImageView class]] && CGRectContainsPoint(view.frame, location))
        {
            self.imageview = (UIImageView *)view;
            return;
        }
    }

    self.state = UIGestureRecognizerStateFailed;
}

@end 
```

然后使用这个新的子类相应地创建您的手势识别器：

```
ImageLongPressGestureRecognizer *gestureRecognizer = [[ImageLongPressGestureRecognizer alloc] initWithTarget:self action:@selector(handleLongPress:)];
[self.view addGestureRecognizer:gestureRecognizer]; 
```

然后，作为这个子类的一个很好的小好处，你的主要手势识别器被简化了，即：

```
- (void)handleLongPress:(ImageLongPressGestureRecognizer *)sender
{
    if (sender.state == UIGestureRecognizerStateBegan)
    {
        // you can now do whatever you want with sender.imageview, e.g. this makes it blink for you:

        [UIView animateWithDuration:0.5 
                         animations:^{
                             sender.imageview.alpha = 0.0;
                         } completion:^(BOOL finished){
                             [UIView animateWithDuration:0.5 
                                              animations:^{
                                                  sender.imageview.alpha = 1.0;
                                              } 
                                              completion:nil];
                         }];
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-04T14:22:31.263

您不能将手势识别器附加到多个对象（如您所见）。您正在做的事情的一种解决方案可能是将 UIImageView 子类化并在该类中设置代码，以便每个视图创建其识别器等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T14:22:52.280

我想，首先，你应该创建一个视图数组和识别器数组（如果需要，可变数组）然后填充它。它将帮助您使用循环来避免代码重复。

至于一个识别器的多视图 - 不，这是不可能的，[在这里回答](https://stackoverflow.com/questions/11330738/attach-gesturerecogniser-to-multiple-imageviews/11330946#11330946)。

# css - 如何使 DIV 的水平滚动条始终固定在页面底部？

> ID：11330745
> 
> 赞同：9
> 
> 时间：2012-07-04T14:10:20.097
> 
> 标签：css

我有一个网站，其中包含一个大（宽）表。该表放置在 jquery UI 选项卡中。

它看起来像这样：http: [//jsfiddle.net/Tq3Rg/](http://jsfiddle.net/Tq3Rg/)

对于用户来说，这可能有点烦人，因为他必须一直走到表格和页面的底部才能向右滚动。

是否可以使滚动条始终**固定**在页面底部？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-04T14:22:06.027

设置固定高度（并且不要使用内联样式）：

**[您修改后的演示](http://jsfiddle.net/poikl/Tq3Rg/2/)**

**编码：**

```
.top{
   height:10%;
}
.center{
   overflow:scroll;
   height:80%;
}
.bottom{
   height:10%;
} 
```

如果您真的想在页面的最底部有滚动条，您可以查看[这个答案](https://stackoverflow.com/a/10193242/1047823)，了解如何在不需要自定义滚动条之类的东西的情况下实现这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T14:16:23.783

只需为您的中间 div 设置一些固定高度，例如

```
<div style="background:white;overflow-y:scroll;height:400px;"> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T14:26:42.830

您需要一个自定义滚动条来执行此操作，请查看[http://baijs.nl/tinyscrollbar/](http://baijs.nl/tinyscrollbar/)或[http://www.jquery4u.com/plugins/10-jquery-custom-scrollbar-plugins/#.T_RSYxEe4hU](http://www.jquery4u.com/plugins/10-jquery-custom-scrollbar-plugins/#.T_RSYxEe4hU)。

# validation - XSD - 验证

> ID：11330749
> 
> 赞同：0
> 
> 时间：2012-07-04T14:10:27.343
> 
> 标签：validation, attributes, xsd, element

我的要求是，考虑以下示例 xml

```
<user key="username" value="Test"/>
<user key="age" value="27"/>
<user key="email" value="my@my.com"/> 
```

在这种情况下，所有元素都具有相同的名称、相同数量的属性和相同的属性名称。

但我需要根据**key验证****value**属性。例如这里第一个键是用户名，它的值是一个字符串类型，第二个键是年龄，它的值必须是一个正整数，第三个键是电子邮件，所以值应该是一个电子邮件地址。

 **有什么办法可以做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T14:53:32.053

You can translate your XML data with a XSL transformation into a form which can be validated with a XSD schema. This does not require any special custom tools.

Your input data:

```
<?xml version="1.0" encoding="UTF-8"?>
<users>
    <user key="username" value="Test"/>
    <user key="age" value="27"/>
    <user key="email" value="my@my.com"/>
</users> 
```

Can be translated with the following transformation:

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output method="xml" version="1.0" encoding="UTF-8" indent="yes"/>
    <xsl:template match="/users">
        <users>
            <xsl:apply-templates/>
        </users>
    </xsl:template>
    <xsl:template match="//user">
        <xsl:variable name="key" select="@key"/>
        <xsl:variable name="value" select="@value"/>
        <xsl:element name="{$key}">
            <xsl:value-of select="$value"/>
        </xsl:element>
    </xsl:template>
</xsl:stylesheet> 
```

into the following form:

```
<?xml version="1.0" encoding="UTF-8"?>
<users>
    <username>Test</username>
    <age>27</age>
    <email>my@my.com</email>
</users> 
```

And that can easily be validated with a standard XSD schema:

```
<?xml version="1.0" encoding="UTF-8"?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" elementFormDefault="qualified" attributeFormDefault="unqualified">
    <xs:element name="users">
        <xs:complexType>
            <xs:sequence>
                <xs:element name="username" type="xs:string"/>
                <xs:element name="age" type="xs:positiveInteger"/>
                <xs:element name="email">
                    <xs:simpleType>
                        <xs:restriction base="xs:string">
                            <xs:pattern value=".+@.+\.[^.]+"/>
                        </xs:restriction>
                    </xs:simpleType>
                </xs:element>
            </xs:sequence>
        </xs:complexType>
    </xs:element>
</xs:schema> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T13:06:54.257

我多次遇到类似的问题，

这是我对以下帖子的接受的答案：

[通过 XSD 限制基于另一个元素的 XML 元素](https://stackoverflow.com/questions/4126988/restricting-xml-elements-based-on-another-element-via-xsd/4141569#4141569)

[XSD：如何根据某个标签的值验证 XML 文件？](https://stackoverflow.com/questions/1879652/xsd-how-to-validate-the-xml-file-according-to-value-of-some-tag/1880030#1880030)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T14:16:06.043

XSD 不支持这种条件验证。您需要使用[Schematron](http://www.schematron.com/)。**

# ruby - LoadError：需要 {app_path}/models/model file.rb 来定义模型名称

> ID：11330750
> 
> 赞同：3
> 
> 时间：2012-07-04T14:10:35.067
> 
> 标签：ruby, ruby-on-rails-3, multithreading

我在运行时收到此错误

```
LoadError: Expected /home/user/Desktop/Tripurari/myapp/app/models/host.rb to define Host## 
```

但它的每一件事的地方。有人可以告诉我方法下面的确切问题是什么。

```
def self.check_all(keyword)
  memo_mutex = Mutex.new
  memo       = {}
  threads    = []
  name       = keyword.keyword
  SITES.each do |site_and_options|
    threads << Thread.new do
      @host = Host.find_or_create_by_name(site)
      if keyword.unavailable_usernames.find_by_host_id(@host.id)
        memo[@host.name] = true
      else
        memo[@host.name] = false
      end
    end
  end
  threads.each { |t| t.join }
  memo
end 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-04T17:27:43.063

该问题可能是由自动加载器引起的。如果`Host`在第一次进入创建几个新线程的循环时该类尚未加载，它会自动加载，即 Rails 在加载路径中搜索与命名约定匹配的文件并需要它。

这个过程不是线程保存的。在您的情况下，当您连续快速创建 servral 线程时，每个线程都试图自动加载 *全局*类，您会遇到竞争条件并发生奇怪的事情。基本上，您有两种选择来解决这个问题：

1.  您可以`require 'host'`在启动循环之前使用 before 显式加载模型。
2.  或者您可以`config.threadsave!`在初始化程序中进行设置。这将（除其他外）在启动服务器时预加载所有类。这是首选，因为这样可以避免大量其他难以调试的并发问题。有关 的更多信息`config.threadsafe!`，请参阅[Aaron Patterson 的优秀文章，](http://tenderlovemaking.com/2012/06/18/removing-config-threadsafe.html)认为它应该在 Rails 4 中完全删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T15:07:11.150

假设您上面引用的代码位于模型的 .rb 文件中，请添加`require_relative "host"`到该文件的顶部。

# c# - 我如何知道要包含哪些文件才能将我的 WPF 可执行文件手动复制到另一台机器？

> ID：11330752
> 
> 赞同：0
> 
> 时间：2012-07-04T14:10:36.047
> 
> 标签：c#, wpf, deployment

我正在 WPF4 和 C# 中重新做一个旧的 .NET 2.0 应用程序。我无法在此应用程序中使用安装程序。使用旧版本，我所要做的就是复制一个 .exe 文件。但是对于 WPF 应用程序，我发现我需要的不仅仅是这些。但还有多少？我可以一次复制一个以上的 DLL 直到它运行，但我觉得这样做不安全。那么我怎样才能知道我真正需要哪些文件夹（我看到了几个语言文件夹）和文件？

我的最终目标是只需要仍然使用一个可执行文件。我要么将所需的 DLL 文件添加为嵌入式资源，要么使用 ILMerge。我需要的文件数量越少越好。

PS。我不能使用安装工作为我雇主的条件。我的应用程序旨在作为一种工具来协助我们的技术人员拨打支持电话。它使用 .NET 的事实遭到了抵制，因此我将遵守规则。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T14:12:37.473

除了对机器本身的依赖（例如.net framework 4）之外，您只需要项目输出文件夹中的内容，默认情况下是 bin/Debug。

# bash - Bash，调用来自脚本的函数？

> ID：11330753
> 
> 赞同：4
> 
> 时间：2012-07-04T14:10:40.130
> 
> 标签：bash, function

假设我有 2 个脚本

测试1.sh

```
#!/bin/sh
. ./test2.sh
foo 
```

测试2.sh

```
#!/bin/sh
foo(){
  echo "bar"
} 
```

如果我调用第一个脚本就可以了

```
$ ./test1.sh
bar 
```

但是，如果我尝试`foo`在那之后打电话，它将无法正常工作。

```
$ foo
bash: foo: command not found 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-04T14:28:56.727

当您执行时`./test1.sh`，会产生一个子进程。当`test1.sh`sources时`test2.sh`，仅在`foo()`定义时修改该子流程的上下文。一旦`test1.sh`完成，子进程就会终止，并且您的交互式 shell 不知道`foo()`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-04T14:14:42.530

如果你打电话`source test2.sh`，你会得到你想要的结果。如果您希望能够在启动新终端时调用 foo，请将其定义放在 .bashrc 或 .profile 文件中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T14:23:27.407

如果我 source test1.sh 它会给出所需的结果。

```
$ . test1.sh
bar

$ foo
bar 
```

# objective-c - animateWithDuration 不起作用

> ID：11330758
> 
> 赞同：3
> 
> 时间：2012-07-04T14:11:19.527
> 
> 标签：objective-c, cocoa-touch

我正在尝试使用一些按钮和控制器为我的主视图从屏幕右侧进入屏幕设置动画。问题是它没有动画，它只是直接进入完成状态。

这是我的代码：

```
UIStoryboard* storyBoard = [UIStoryboard storyboardWithName:@"MainStoryboard" bundle:nil];
options = [storyBoard instantiateViewControllerWithIdentifier:@"OptionsView"];
options.delegate = self;        
[self.view addSubview:options.view];
options.view.center = CGPointMake(floor(total_width+options.view.frame.size.width/2)+10, floor(total_height/2));

[UIView animateWithDuration:0.5
                      delay:0.0
                    options: UIViewAnimationOptionCurveEaseOut
                 animations:^{
                     options.view.center = CGPointMake(floor(total_width-options.view.frame.size.width/2)+10, floor(total_height/2));
                 } 
                 completion:^(BOOL finished){
                     NSLog(@"Done!");
                 }]; 
```

编辑

更奇怪的是，如果我把这个动画放在另一个动画的完成块中，那么这个可以工作，但不是新的。

```
 UIButton* boton = (UIButton*) sender;
    [UIView animateWithDuration:5.0
                          delay:0.0
                        options: UIViewAnimationOptionCurveLinear
                     animations:^{
                         boton.alpha = 0.0;

                         //Jumps directly to 0, animation doesn't work

                     } 
                     completion:^(BOOL finished){
                         [UIView animateWithDuration:0.5
                                               delay:0.0
                                             options: UIViewAnimationOptionCurveEaseInOut
                                          animations:^{
                                              options.view.center = CGPointMake(floor(total_width-options.view.frame.size.width/2)+10, floor(total_height/2));

                                              //It works now, but it doesn't take 5 seconds to start, it starts right away

                                          } 
                                          completion:^(BOOL finished){
                                              NSLog(@"Done!");
                                          }]; 

                     }]; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T16:34:42.557

调用之前的行`animateWithDuration:...`直接将 分配给`center`您正在制作动画的相同值。要么删除它，要么在`center`那里分配初始值。具有相同开始值和结束值的动画显然没有效果。

# stream - FFmpeg 无法解码 H264 流/帧数据

> ID：11330764
> 
> 赞同：18
> 
> 时间：2012-07-04T14:11:35.947
> 
> 标签：stream, ffmpeg, h.264, rtsp

最近我有机会使用两台通过 RTSP 传输 H264 的设备。我在尝试使用 FFmpeg 库解压缩此流时遇到了一些问题。

每次调用“ **avcodec_decode_video2** ” - FFmpeg 只是说：

> [h264@00339220] 没有框架！

我的原始 H264 流**I**帧数据开始如下：“ **65** 88 84 21 3F F8 F8 0D ...”（据我了解，这 0x65 表示它是 IDR 帧？）

一个设备的其他帧开头如下：“ **41** 9A 22 07 F3 4E 48 CC....”

对于其他设备 - 像这样：“ **61** 9A 25 C1 1C 45 62 39 ....”

*   我在这里缺少一些帧数据吗？
*   FFmpeg 是否需要设置一些额外的参数？

我期望帧数据开始时至少有“ **00 00 00 01** ”字节......但这就是我所拥有的......

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-07-05T09:20:51.847

好的，设法使事情正常进行。

*   在将帧发送到 FFmpeg 之前，我需要为我的帧数据包含序列 (SPS) 和图片参数集 (PPS)。
*   我需要在 SPS 和 PPS 数据之后添加 4 个额外的字节“00 00 00 01”。

这是一张小图片，显示了我的意思： ![在此处输入图像描述](../Images/c8e735d5add7fd5c7fc5271d954a0456.png)

*字节“65 88 ...”是我的原始帧数据开始的地方。*

此 SPS 和 PPS 信息未包含在 RTP 数据包中。我正在使用 Live555 库进行 RTSP 流传输，所以我使用了子会话“ **fmtp_spropparametersets** ”函数来获得我需要的东西。此信息是 Base64 编码的。（示例：*类似 "Z0KAKNoC0EkQ,aM48gA=="* ) 请注意，有两个“参数”SPS 和 PPS 由“，”分隔，并且这些参数不包含“00 00 00 01”，因此您需要添加它们。

一些代码示例（我在这里使用 Qt 库）：

```
QByteArray        ba          = pSubSession->fmtp_spropparametersets();
QList<QByteArray> recordsList = ba.split(',');

for (int i = 0; i < recordsList.size(); i++)
{
   mExtraData.append(char(0x00));
   mExtraData.append(char(0x00));
   mExtraData.append(char(0x00));
   mExtraData.append(char(0x01));

   mExtraData += QByteArray::fromBase64(recordsList.at(i));
} 
```

现在对于每一帧我都做这样的事情：

```
QByteArray ba = QByteArray(4, 0); // Prepare the "00 00 00 01"
           ba[3] = 0x01;

mpTrackVideo->buffer.insert(0, mExtraData);
mpTrackVideo->buffer.insert(mExtraData.size(), ba); 
```

一年前，我认为我的项目中集成了 H264 流支持，直到我有机会使用其他一些设备对其进行测试......所以你需要记住，有些设备可能会为每个 I 帧发送 SPS 和 PPS 数据。 ..有些可能不会！

# php - SQL - 过滤搜索结果

> ID：11330765
> 
> 赞同：1
> 
> 时间：2012-07-04T14:11:37.873
> 
> 标签：php, mysql, cakephp, search, filter

好的——在这里需要一些帮助——可能比我在这里能咀嚼的更多——但我正在寻找一个总是返回至少 10 个结果的 SQL 查询。如果应用第一个条件并且结果集超过 10 个结果，则继续下一个条件等。

示例 找出所有价格低于 5.00 英镑的小型红色塑料玩具车。

我总是想在屏幕上显示至少 10 个项目。要搜索“小”，然后搜索“红色”，然后搜索“< 5.00 英镑”。如果查询返回的商品超过 10 个，则继续过滤尽可能多的标签（即塑料、玩具和汽车）——匹配的越多，它的排名就越高（即，如果一个产品的所有 3 个标签都与它——它会在列表的顶部，如果一个产品只匹配 1 个标签——那么它会在列表的下方。

```
Price Table
ID      Price
1       £1.50
2       £2.50
3       £6.00
.
Colour Table
ID      Colour
1       Red
2       Blue
3       Yellow
.
Size  Table
ID      Shape
1       Small
2       Medium
3       Large
.
Products Table
ID  Description    price_id     colour_id   size_id
1   Item 1         1            2           2
2   Item 2         2            2           1
3   Item 3         1            1           1
4   Item 4         3            2           3
5   Item 5         3            1           2
6   Item 6         1            1           2
7   Item 7         1            1           3

 .
Tags Table
ID      Description
1   Shiny
2   Plastic
3   Wood
4   Toy
5   Disney
6   Animal
7   Car
.
Items_Tags Table
ID      tag_id      product_id
1       1           1
2       4           1
3       7           1
4       2           2
5       3           3
6       4           3
7       7           6
8       7           7
9       7           2 
```

一个很长的例子——但我希望你明白这一点。我想知道将所有过滤器放在标签表中是否有任何好处——即价格、颜色和尺寸，然后只需要搜索标签表。

有什么想法吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T14:18:42.433

这取决于您的使用情况：过滤整数比字符串快（顺便说一下，它们是否被索引？）但 JOIN 也很耗时。因此，如果 sql 之外的代码与整数一起使用，请保留它们（如果不需要显示文本，请不要加入）

# sh - WinSCP 调用远程脚本

> ID：11330766
> 
> 赞同：1
> 
> 时间：2012-07-04T14:11:40.040
> 
> 标签：sh, winscp

我有 Windows 机器，我希望`.sh`在远程 Unix 服务器上调用脚本。

如果可以使用 WinSCP，有人可以帮助我执行命令吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T14:27:23.563

请参考[https://winscp.net/eng/docs/scripting#different_account](https://winscp.net/eng/docs/scripting#different_account)

但我建议使用 SSH 客户端，如 PuTTY 或 Bitvise Tunnelier 在远程服务器上执行一些命令。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-03T14:20:36.323

要使用 WinSCP 调用远程命令，请使用[`call`command](https://winscp.net/eng/docs/scriptcommand_call)。

# sql-server - 将数据库字段中的图像保存到服务器上的文件

> ID：11330767
> 
> 赞同：1
> 
> 时间：2012-07-04T14:11:43.377
> 
> 标签：sql-server, tsql, sql-server-2012

我正在尝试使用此 t-sql 将表中的数据直接保存到服务器文件系统：

```
DECLARE @ID int
DECLARE @command varchar(1000)
DECLARE @Name varchar(100)
DECLARE @FileName varchar(100)
DECLARE MyCursor CURSOR FOR 
SELECT Id, [FileName] FROM FilesTable
OPEN MyCursor 

FETCH NEXT FROM MyCursor 
INTO @ID, @Name

WHILE @@FETCH_STATUS = 0
BEGIN

SELECT @FileName = 'd:\Temp\' + convert(varchar(200), @Name)

SET @command = 'bcp "SELECT FileBytes FROM FilesTable WHERE ID = ' + convert(varchar(18),     @Id) + '" queryout "' + @FileName + '" -T -n'

EXEC master..xp_cmdshell @command, no_output

FETCH NEXT FROM MyCursor 
INTO @Id, @Name

END

CLOSE MyCursor 
DEALLOCATE MyCursor 
```

该表充满了可靠的数据。使用 C# 程序访问这些数据是可行的。我确实配置了高级选项，允许使用 xp_cmdshell 当我运行此查询时，我没有收到任何错误，但没有写入文件。我也没有在日志中看到任何内容，（也许我在寻找错误的位置？）

我究竟做错了什么？或者我能做些什么来检查'引擎盖下'？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T08:16:11.650

根据 Patrick 的评论和以[最快的方式将 blob 从表导出到单个文件](https://stackoverflow.com/questions/10325338/fastest-way-to-export-blobs-from-table-into-individual-files)的答案，我能够将图像存储在我的文件服务器上。

我们最终编写了一个类似于给定的 CLR 函数。

# qlikview - qlikview 计数具有空特定属性的项目

> ID：11330769
> 
> 赞同：1
> 
> 时间：2012-07-04T14:12:08.617
> 
> 标签：qlikview

我正在玩 QV 的个人版，但无法弄清楚一件事 - 我已经从 Jira 导出到 excel 并构建了图表和东西，现在我想构建一个图表来显示 jira 项目的数量（即“计数（键）”的定义和工作得很好）有空的“花费的时间”（我不知道如何实现）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T14:32:32.857

计数（如果（不是 IsNull（[花费时间]），键））

# php - 通过前端表单将用户重定向到新创建的页面？

> ID：11330772
> 
> 赞同：-1
> 
> 时间：2012-07-04T14:12:15.363
> 
> 标签：php, wordpress

我正在使用下面的代码通过前端表单在 Wordpress 中创建一个页面。提交时，如何将用户重定向到新创建的页面？

更新：是否可以将 post_title 转换为 url 而不是页面 ID？那么像company.com/my-company这样的东西？

```
<?php $postTitle = $_POST['post_title'];
$post = $_POST['post'];
$submit = $_POST['submit'];

if(isset($submit)){

    global $user_ID;

    $new_post = array(
        'post_title' => $postTitle,
        'post_content' => $post,
        'post_status' => 'publish',
        'post_date' => date('Y-m-d H:i:s'),
        'post_author' => $user_ID,
        'post_type' => 'members',
        'post_category' => array(0)
    );

    wp_insert_post($new_post);

}

?>

<form action="" method="post">
<table border="1" width="200">
  <tr>
    <td><label for="post_title">Post Title</label></td>
    <td><input name="post_title" type="text" /></td>
  </tr>
  <tr>
    <td><label for="post">Post</label></td>
    <td><input name="post" type="text" /></td>
  </tr>
</table>

<input name="submit" type="submit" value="submit" />
</form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T14:18:25.573

[wp_redirect()](http://codex.wordpress.org/Function_Reference/wp_redirect) - 将用户重定向到指定的绝对 URI

# php - 通过 fsockopen 和 fwrite 的 PHP HTTP 请求在 linux 上无法正常工作

> ID：11330773
> 
> 赞同：0
> 
> 时间：2012-07-04T14:12:17.313
> 
> 标签：php, http, fwrite, fsockopen

我们目前正在使用套接字打开和写入 http 连接，我们不一定关心响应的请求！像跟踪ping等

这适用于我们的旧服务器和我们的 Windows 开发环境，但不适用于我们的新 ubuntu 服务器。

我们使用的代码如下

```
 $aUrlParts = parse_url($sUrl);

        $fp = fsockopen(
            $aUrlParts['host'],
            isset($aUrlParts['port']) ? $aUrlParts['port'] : 80,
            $errno, $errstr, 30
        );

        $sHeader = "GET {$aUrlParts['path']}?{$aUrlParts["query"]} HTTP/1.1\r\n";
        $sHeader.= "Host: {$aUrlParts['host']}\r\n";
        $sHeader.= "Connection: Close\r\n\r\n";

        fwrite($fp, $sHeader);
        fclose($fp); 
```

如果我在 fwrite 之后进行读取，我可以从服务器上获取所有内容，但这与仅卷曲 URL 相比，以这种方式执行请求的意义不大

我已经尝试刷新套接字并将其设置为非阻塞但不起作用！只是做一个阅读后是唯一有效的！

任何帮助表示赞赏

编辑：我会提到这些新服务器是基于 AWS 的，我感觉它们上的套接字实现可能会有所不同

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T22:21:42.000

我不确定这是否值得作为答案，但我遇到了完全相同的问题，这就是我来到这里的原因。我唯一的区别是我试图对服务器本身执行请求。

我的解决方案是服务器的访问管理。我有一个 htaccess 文件，它阻止除了我自己的网络之外的任何人查看，问题是它也阻止了我的服务器请求自身。

所以也许它与服务器访问管理有关。让我知道这是否有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-07-15T16:19:31.897

我们正在使用`fsockopen`和`fwrite`组合，然后有一天它停止工作。或者它是一种间歇性的。经过一些研究和测试，如果你启用了 fopen 包装器，我最终使用`file_get_contents`和`stream_context_create`函数，超时设置为 100 秒。timeout 参数可以接收浮动值（[https://www.php.net/manual/en/context.http.php](https://www.php.net/manual/en/context.http.php)）。我将它包装在一个 try...catch 块中，这样它就会默默地失败。它非常适合我们的目的。如果需要，您可以在 catch 中记录内容。

```
$context = stream_context_create([
    "http" => [
        "method"=>"GET",
        "timeout" => .01
        ]
    ]
);

try {
    file_get_contents($url, 0, $context);
}catch( Exception $e ){
    // Fail silently
} 
```

# mysql - 数据库设计动态表

> ID：11330774
> 
> 赞同：0
> 
> 时间：2012-07-04T14:12:21.750
> 
> 标签：mysql, sql, database, database-design

我有字段名 f1、f2、f3、f4、f5、f6。这些字段名称将根据其他字段名称的值显示。

例如，必须显示 f3，如果 f2 值为“COND1”，则必须显示 f4，如果 f3 值为“COND”

字段名称不固定，可以添加、编辑和删除。COND1、COND 等值也不是固定的，可以更改。

有人能指出如何设计数据库吗 谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T14:32:26.710

RDBMS 的动态表是一种反模式。不要那样做。

也许 NoSQL 数据库可能更适合您的用例——这就是它们的用途。

或者，如果你坚持关系，那么你需要让你的数据库适应动态结构——比如键值表，并自己管理结构。即表结构将保留结构元数据和数据。

如果您的结构足够简单，您只需要一个带有复合键的附加表 - 原始 ID 和参数名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T15:02:26.740

如果您的唯一条件是 field == value 那么我会考虑这个：

```
| Field Table |
|-------------|
| id          |
| fieldName   |
|-------------|

| Conditional Table |
|-------------------|
| id                |
| comparisonField   |
| comparisonValue   |
| displayField      |
|-------------------| 
```

因此条件 1 将具有值 1, 2, "COND1", 4 以显示字段 4 如果字段 2 == "COND1"

如果您想要其他比较，小于、大于等。还有一个比较器表可以链接到条件表。

# winforms - 带有 ToolStripDropDownButton 的 ToolStrip 看起来很奇怪

> ID：11330780
> 
> 赞同：0
> 
> 时间：2012-07-04T14:12:34.660
> 
> 标签：winforms, toolstrip, toolstripdropdown

我有两个版本的 Windows 窗体应用程序，我一生都无法弄清楚如何在不复制整个代码的情况下使特定的 GUI 行为相同（这显然是一个禁忌）。

这是一个视觉比较：

![在此处输入图像描述](../Images/46a3a39855b43a2e3677abea66c3d362.png)

左边的是我要修复的，使它看起来像右边的。请注意 ToolStrip 看起来好像包含一个额外的 ToolStripDropDownButton，或者设置了一些我不知道的属性或样式以使其看起来像那样。

我一直在疯狂地区分，找不到有什么不同。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T14:38:15.333

知道了。在左侧情况下，按钮“溢出”。它的尺寸太大，无法容纳工具条，因此就这样折叠了。调整左侧按钮的大小后，一切都很好。

[在“使用CanOverflow](http://visualcsharptutorials.com/windows-forms/creating-toolbars)和溢出属性”部分中阅读了有关工具条控件的基本内容后，我发现了发生了什么。

# android - android活动中的最后一条推文

> ID：11330784
> 
> 赞同：0
> 
> 时间：2012-07-04T14:12:41.210
> 
> 标签：android

我对 android 开发相当陌生，需要创建一个 android 应用程序，在屏幕的下半部分，它将在列表视图中显示用户的最后 2 条推文。

由于我是 android 和 API 的新手，所以我到处寻找一个易于遵循的教程，但没有一个真正能满足我的需要。有任何想法吗？

亲切的问候

本

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T15:10:30.103

Twitter4j 将是进行此类查询的方式。

lookupUsers(long[]) 方法将一次返回多达 100 人的信息

```
Twitter twitter = new TwitterFactory().getInstance();
ResponseList<User> userInfo = twitter.lookupUsers(new long[]{userId1, userId2, userId3});
for(User u: userInfo){
  System.out.println(u.getScreenName() + ": " + u.getStatus().getText());
} 
```

这是相同的深入教程：[http ://www.java-tutorial.ch/framework/twitter-with-java-tutorial](http://www.java-tutorial.ch/framework/twitter-with-java-tutorial)

祝你好运

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T14:16:49.907

您可以使用 Twitter4j 库。这是链接：http: [//twitter4j.org/en/index.html](http://twitter4j.org/en/index.html)

这是 O'Reilly 制作的一个很好的教程 [http://www.creativelive.com/courses/developing-android-applications-java-part-1-partnership-oreilly](http://www.creativelive.com/courses/developing-android-applications-java-part-1-partnership-oreilly)

# c# - 在 SQL Server 2008 r2 中使用来自 Google 地图的空间数据进行操作

> ID：11330792
> 
> 赞同：1
> 
> 时间：2012-07-04T14:13:00.197
> 
> 标签：c#, sql-server, nhibernate, geolocation, geospatial

我如何存储一个矩形 - 由 2 个点 NorthEast 和 SouthWest 组成，每个点都是纬度和经度的坐标

并添加一个由中心（ lat-lng ）和半径（int/float 值）组成的圆

如果 lat-lng 在任何圆形或矩形的范围内，存储和稍后查询的最佳方法是什么？另外，我可以存储一个数组吗？在一条记录中说 10 个矩形和 5 个圆形？我可以使用 Nhibernate 来缓解疼痛吗？

对不起，如果这看起来很无聊，我从来没有对空间数据做过任何事情，我什至不知道从哪里开始。任何示例和指针都有帮助！提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T13:31:33.140

下面是我如何使用 TSQL 来解决这个问题。

对于矩形，最简单的方法是使用原始点的相关坐标外推额外的 2 个点。例如

东北 (lat1, lon1) 西北* (lat1, lon2)

东南* (lat2, lon1) 西南 (lat2, lon2)

*新点

这并没有给你一个真正的矩形（在数学意义上），但它是 GIS 中的一种常用方法（它是 geohashes 的形成方式）你得到的是一个粗略的矩形，其大小根据与赤道的距离而变化。如果您需要某个高度/宽度的精确矩形，您应该考虑使用 Haversine 公式来计算剩余的 2 个点，这将考虑到方位角和大圆距离。

[http://www.movable-type.co.uk/scripts/latlong.html](http://www.movable-type.co.uk/scripts/latlong.html)

为了存储矩形，我将创建一个带有 GEOGRAPHY 类型列的 SQL 表，这将允许您分配其他属性（例如名称）以及空间索引，这将使未来的查询更快。

```
CREATE TABLE dbo.geographies
(
    NAME VARCHAR(50)
    ,GEOG GEOGRAPHY
)

INSERT INTO dbo.geographies (NAME, GEOG)
VALUES ('Rectangle', geography::STPolyFromText('POLYGON((lon1 lat1, lon2 lat1, lon2 lat2, lon1 lat2, lon1 lat1))', 4326)) 
```

请注意，第一个点和最后一个点是相同的，这是“关闭”多边形所必需的，最后一个数字表示 SRID 或坐标系，在本例中为 WGS84。你可以参考这个页面：http: [//msdn.microsoft.com/en-us/library/bb933971](http://msdn.microsoft.com/en-us/library/bb933971)

至于圆，存储一个点然后使用半径在该点周围应用缓冲区很简单：

```
INSERT INTO dbo.geographies (NAME, GEOG)
VALUES ('Circle with Radius', geography::STPointFromText('POINT(lon lat)', 4326).STBuffer([radius])) 
```

请注意，缓冲区以米为单位输入，因此您可能需要应用转换，此页面上的更多注释：http: [//msdn.microsoft.com/en-us/library/bb933979](http://msdn.microsoft.com/en-us/library/bb933979)

现在有趣的部分是，使用 STIntersects 方法很容易检查一个点上的交叉点。

[http://msdn.microsoft.com/en-us/library/bb933962.aspx](http://msdn.microsoft.com/en-us/library/bb933962.aspx)

```
DECLARE @point GEOGRAPHY = geography::STPointFromText('POINT(lon lat)', 4326)

SELECT * FROM dbo.geographies
WHERE @point.STIntersects(GEOG) = 1 
```

代码示例获取一个点并返回该点所在的所有地理位置的列表。重要的是新点的 SRID 和表中的地理匹配，否则您将获得零匹配（并且可能会在您意识到自己的错误之前将您的头撞到墙上一段时间，至少，这就是我所做的） .

至于将它与 C# 集成，我不确定我能提供多少帮助，但返回 SQLGeography 类型应该不是太大的挑战

[http://msdn.microsoft.com/en-us/library/microsoft.sqlserver.types.sqlgeography.aspx](http://msdn.microsoft.com/en-us/library/microsoft.sqlserver.types.sqlgeography.aspx)

希望这至少可以为您指明正确的方向。

# python - django-tables2 不排序

> ID：11330794
> 
> 赞同：7
> 
> 时间：2012-07-04T14:13:12.063
> 
> 标签：python, python-2.7, django-tables2

无法对 django-tables2 表进行排序。

```
class MyModel(models.Model):
    pid = models.AutoField('id',primary_key = True)
    name = models.CharField(max_length = 255,
                            help_text='The name')
def show_mymodels(request):
    """ the view """
    table = MyModelTable(MyModel.objects.all())
    return render(request,'mymodel.html',{'table':table})

class MyModelTable(tables.Table):
    class Meta:
        model = MyModel
        orderable = True 
```

mymodel.html 如下所示：

```
{% load render_table from django_tables2 %}
{% render_table table %} 
```

这会使表格正确，但在浏览器中单击列时没有任何反应。其他然后 urld 更改`http://127.0.0.1:8000/show_mymodel`-->`http://127.0.0.1:8000/show_mymodel?sort=name`

我做错了什么？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-07-04T17:22:33.587

您需要一个`RequestConfig`对象，如[教程](https://django-tables2.readthedocs.io/en/latest/pages/tutorial.html)中所述：

> 使用`RequestConfig`自动从表中提取值`request.GET`并相应地更新表。这使数据排序和分页成为可能。

* * *

```
from django_tables2 import RequestConfig

def show_mymodels(request):
    table = MyModelTable(MyModel.objects.all())
    RequestConfig(request).configure(table)
    return render(request, 'mymodel.html', {'table': table}) 
```

# lua - config.lua 中为新手机编写的应用程序的分辨率值。

> ID：11330800
> 
> 赞同：0
> 
> 时间：2012-07-04T14:14:10.087
> 
> 标签：lua, coronasdk

我们使用 Corona SDK 为 iPhone4 和 SamsungGalaxy2 等新手机编写应用程序。在“config.lua”文件中写入的高级“宽度”和“高度”值是什么？

320x480 的分辨率已经很老了，因为所有新手机都有更高的分辨率。下一个尺寸是多少？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T17:33:28.913

将`width`and设置`height`为对您的应用最有意义的值，然后[将缩放参数设置](http://www.coronalabs.com/blog/2010/11/20/content-scaling-made-easy/)为自动缩放到任何设备的屏幕。

# vpn - 用于家庭工作的优质安全 VPN 工具

> ID：11330811
> 
> 赞同：-1
> 
> 时间：2012-07-04T14:14:34.097
> 
> 标签：vpn, remote-access

我们公司允许我们在家工作，但我们不能从我们的工作 PC 上删除代码，并且由于我们必须满足各种规定，我们的家庭和工作 PC 之间的任何连接都必须是安全的。我还想在家里有多个屏幕。

我们目前使用 Cisco 产品来提供对我们工作 PC 的远程访问，但速度很慢并且不断退出。你们中有人知道我们可以使用的任何优质安全远程访问软件吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T16:09:17.637

您可以尝试以下方法之一：

[远程实用程序](http://www.remoteutilities.com)

[管理员](http://www.radmin.com)

# java - 在java中删除未使用变量的内存

> ID：11330812
> 
> 赞同：45
> 
> 时间：2012-07-04T14:14:40.787
> 
> 标签：java, memory-management

我知道 Java 有自己的垃圾收集器，但有时我想手动删除垃圾。有没有办法做这样的工作？考虑到我有一个很长或很长`function`的声明了许多变量，在函数结束时使用而不是自动收集后立即删除未使用的内存是个好主意吗？如果我手动删除垃圾，是否会影响我的应用程序的速度？感谢您的帮助！

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-07-04T14:18:30.037

在 java 中没有直接和直接的方法来释放内存。您可能会尝试使用众所周知的方法*说服*垃圾收集器带走一些对象：

```
Object obj = new Object();
// use obj
obj = null;
System.gc(); 
```

但不能保证这实际上会立即释放内存。

虽然这适用于堆内存，但堆栈分配的项目只能在函数返回时释放。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-07-04T14:21:19.207

为什么要“手动”删除垃圾？如果是因为内存不足，请记住 Java 将在实际抛出`OutOfMemoryError`. 如果你真的内存不足，那么即使你手动删除也没有垃圾。

声明变量不会在堆上分配内存。用 do 制作一个对象`new`。JVM 甚至可以对没有超出范围但在方法结束之前不再使用的 GC 对象引用进行逃逸分析。

如果您的意思是您希望在系统资源不重要的某个时刻主动释放内存，那么请使用更好的 JVM 调优，例如使用并行 GC 算法。

“手动”垃圾收集通过将事物设置为`null`可能会减慢速度，这仅仅是因为您付出了无意义地清空引用的成本，或者调用 GC 的次数超过了所需的次数。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-04T14:16:23.200

您可以调用[`System.gc();`](http://docs.oracle.com/javase/7/docs/api/java/lang/System.html#gc%28%29)which*可能会*导致垃圾收集器进行清理。但可以肯定的是，这会影响您的应用程序的性能。一般来说，在这里尝试“优化”任何东西都是没有意义的。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-07-04T14:19:45.917

手动执行此操作不值得，因为垃圾收集器通常会做得更好，而您自己执行此操作不太可能对您的应用程序产生明显影响。

如果必须，可以将变量引用设置为 null，然后调用`System.gc()`，这将手动调用垃圾收集器。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-07-04T14:18:45.420

您可以将 null 分配给变量，验证没有对这些对象的任何引用并调用 System.gc()，但这只是 JVM 调用 GC 的建议，但不能保证。垃圾收集 cal 会减慢您的应用程序直至冻结（stop-the-world GC）。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-07-04T14:22:45.947

一个非常常见的建议是使用`System.gc()` **JVM**可能选择忽略的。您还可以使用范围，例如：

```
import java.io.*;
public class AutoVariableTest
{
    public static void main(String[] args) throws Exception
    {
        String fileName = "test.txt";
        {// This is local block just to keep auto variable in check
            File file = new File(fileName); // file is not visible outside the scope and is available for garbage collection
            BufferedReader br = null;

            try{
                br = new BufferedReader(new FileReader(file));
                // ...
            }finally{
                if(br != null)
                    br.close();
            }
        }// local block end
    }
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-03-21T21:06:52.367

如果您打算在某个时间点之后减少使用的内存量，最好将数组用于变量，以便在不再需要时将数组设置为 null。这样，垃圾收集器清理所有数据所需的时间要少得多。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-07-04T14:29:41.327

如果您尝试管理内存，Java 不适合！或者如果你有很多时间，你可以在 JVM 中编写自己的垃圾收集机制

# wcf - IIS 上的 wcf 问题

> ID：11330813
> 
> 赞同：0
> 
> 时间：2012-07-04T14:14:40.833
> 
> 标签：wcf, iis

在我的服务器上部署 WCF 服务器 (svc) 后，我在访问时收到此消息：[https ://test.com/myService.svc](https://test.com/myService.svc)

> 404 - 找不到文件或目录。

在这篇文章之后：http: [//geekswithblogs.net/amaniar/archive/2010/08/31/wcf--iis7-404-file-or-directory-not-found.aspx](http://geekswithblogs.net/amaniar/archive/2010/08/31/wcf--iis7-404-file-or-directory-not-found.aspx)

我激活了 WCF 服务器。

然后，我运行：[https](https://test.com/myService.svc) ://test.com/myService.svc ，它只在第一次工作。之后，我无法再访问 IIS：内部错误

这是我的绑定和服务：

```
 <binding name="BindTest">
      <binaryMessageEncoding maxReadPoolSize="64" maxWritePoolSize="16" maxSessionSize="2048">
        <readerQuotas maxDepth="32" maxStringContentLength="10242880" maxArrayLength="10242880" maxBytesPerRead="4096" maxNameTableCharCount="16384" />
      </binaryMessageEncoding>
      <httpsTransport />
    </binding> 

<service behaviorConfiguration="ServiceBehavior123" name="xyz">
        <endpoint address="" binding="customBinding" bindingConfiguration="BindTest" name="ServiceEndpoint" contract="ISerice" />
        <endpoint address="mex" binding="mexHttpBinding" name="ServiceMexEndpoint" contract="IMetadataExchange" />
      </service> 
```

我无法再访问我的 IIS。如果我删除 WCF 激活，我的 Web 将再次运行，但未找到服务 wcf svc。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T14:47:00.863

您的服务可能反复崩溃，这会导致 IIS 关闭应用程序池。

如果您停止并重新启动 IIS，您将能够再次运行它。

但是，解决方案是更正您的实现 - 您的代码 - 以防止崩溃。

崩溃可能是由于无效转换、空指针异常等等。使用 try...catch 来预防和诊断此类崩溃。

# .net - 将未签名的短路编组到 SafeHandle

> ID：11330815
> 
> 赞同：1
> 
> 时间：2012-07-04T14:14:42.597
> 
> 标签：.net, .net-4.0, interop, marshalling

我正在与需要获取和释放非托管资源的第三方库进行通信。经过一番阅读，我得出结论，管理资源引用的最佳和“正确”方法是在 a`SafeHandle`或`CriticalHandle`object 中。

我的问题出现了，因为第三方库返回的句柄是无符号短数值，而不是指针。如果我`MarshalAsAttribute`在返回的句柄上指定 ，我会得到一个`MarshalDirectiveException`（CriticalHandles 不能有 MarshalAs 属性集并且不能在数组中使用）。

以下是我考虑过的事情：

*   以数字格式编组句柄并`CriticalHandle`通过`Criticalhandle.SetHandle`方法将它们包装在 a 中。如果在获取引用和封装它之间引发异常，这可能会泄漏句柄。
*   以数字格式编组和存储句柄。具有包含类型的实现`CriticalFinalizerObject`。如果在获取引用和封装它之间引发异常，这可能会泄漏句柄。
*   将句柄编组为 a `SafeHandle`（`IntPtr`让最重要的 2 个字节填充准垃圾）。每次`DangerousGetHandle`我需要调用带有`SafeHandle`. 这将防止手柄的任何潜在泄漏，但非常麻烦并且看起来使用蛮力使错误的解决方案起作用。

我应该如何处理这些“把手”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T16:09:03.323

我认为正确的做法是实现您自己的包装器，类似于`SafeHandle`( 并派生自. 然后包装对 P/Invoke 方法的调用，该方法在受[约束的执行区域](http://msdn.microsoft.com/en-us/library/ms228973.aspx)`CriticalFinalizerObject`中创建句柄，以确保托管句柄包装器被正确初始化。

**注意：我以前没有使用过 CER，所以在没有验证的情况下，我只能希望这段代码为您提供一个起点。**

```
[DllImport("blah.dll")]
private static extern ushort CreateMySpecialHandle();

public static SafeSpecial Handle Foo()
{
    SafeSpecialHandle safeHandle = new SafeSpecialHandle();
    System.Runtime.CompilerServices.RuntimeHelpers.PrepareConstrainedRegions();
    try
    {
    }
    finally
    {
        ushort rawHandle = CreateMySpecialHandle();
        safeHandle.SetHandle(rawHandle);
    }

    if (safeHandle.IsInvalid)
    {
        // throw exception here, or other error handling
    }

    return safeHandle;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T14:49:53.547

正如@HansPassant 在对我的问题的评论中提到的那样：

> 如果您的本机代码是 32 位，您可以使 SafeHandle 工作。在 C 或 C++ 函数调用中，短参数总是被提升为 int。IntPtr 不会混淆它。– 汉斯帕桑特 7 月 4 日 15:10

因此，可以将 C/C++ unsigned short 直接编组为`SafeHandle`.

# java - 如何规范化混合的 WAV 文件

> ID：11330816
> 
> 赞同：0
> 
> 时间：2012-07-04T14:14:43.153
> 
> 标签：java, android, c++, c, audio

我正在尝试混合两个 WAV 文件。

WAV 文件可用作字节数组，我使用下面的代码将两者混合。

```
byte[] byte1 , byte[] byte2

// 44 is header of wav file
for( int i = 44 ; i < byte1.length ; i++){
   byte1[i] = byte1[i] + byte2[i];
} 
```

上面的代码大部分都有效。但是当结果超过最大波（16 位音频文件）时，它就会有噪音。如何标准化混合声音？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-04T16:27:52.733

首先，如果你的音频确实是 16 位，那么逐字节添加它是行不通的。其他人对此发表了评论。您可以在此处查看我的回答，了解如何处理此问题。

[使用 Android 的 AudioTrack 来组合声音样本的字节会产生噪音](https://stackoverflow.com/questions/11000933/using-androids-audiotrack-to-combine-bytes-of-sound-samples-produces-noise/11018368)

其次，要“标准化”它，您必须先找到峰值，然后将所有结果缩放到该值。这意味着两个循环：一个是找到“峰值”，一个是添加值，缩放到新的峰值。像这样的东西：

```
//this is the raw audio data -- no header
short[] audioData1 , short[] audioData2

//find the max:
float max = 0;
for( int i = 0 ; i < audioData1.length ; i++) {
   if( Math.abs( audioData1[i] + audioData2[i] ) > max )
      max = Math.abs( audioData1[i] + audioData2[i] );
}

//now find the result, with scaling:
for( int i = 0 ; i < audioData1.length ; i++) {
   audioData1[i] = Math.Round(Short.MAX_VALUE * ( audioData1[i] + audioData2[i] ) / max) ;
}
//normalized result in audioData1 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-09T08:01:01.150

```
 short[] audioData1 = null;
    short[] audioData2 = null;

    int n = 0;

    try {
        DataInputStream in1;
        in1 = new DataInputStream(new FileInputStream("v1.wav"));
        ByteArrayOutputStream bos = new ByteArrayOutputStream();

        try {

            while ((n = in1.read()) != -1) {
                bos.write(n);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }

        ByteBuffer bb = ByteBuffer.wrap(bos.toByteArray());
        bb.order(ByteOrder.LITTLE_ENDIAN);
        ShortBuffer sb = bb.asShortBuffer();
        audioData1 = new short[sb.capacity()];

        for (int i = 0; i < sb.capacity(); i++) {
            audioData1[i] = sb.get(i);
        }

    } catch (IOException e) {
        e.printStackTrace();
    }

    try {
        DataInputStream in1;
        in1 = new DataInputStream(new FileInputStream("v2.wav"));
        ByteArrayOutputStream bos = new ByteArrayOutputStream();

        try {

            while ((n = in1.read()) != -1) {
                bos.write(n);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }

        ByteBuffer bb = ByteBuffer.wrap(bos.toByteArray());
        bb.order(ByteOrder.LITTLE_ENDIAN);
        ShortBuffer sb = bb.asShortBuffer();
        audioData2=  new short[sb.capacity()];

        sb.get(audioData2);

        System.out.println();
    } catch (IOException e) {
        e.printStackTrace();
    }

    // find the max:
    float max = 0;
    for (int i = 22; i < audioData1.length; i++) {
        if (Math.abs(audioData1[i] + audioData2[i]) > max)
            max = Math.abs(audioData1[i] + audioData2[i]);
    }

    System.out.println("" + (Short.MAX_VALUE - max));

    int a, b, c;

    // now find the result, with scaling:
    for (int i = 22; i < audioData1.length; i++) {
        a = audioData1[i];
        b = audioData2[i];

        c = Math.round(Short.MAX_VALUE * (audioData1[i] + audioData2[i])
                / max);

        if (c > Short.MAX_VALUE)
            c = Short.MAX_VALUE;
        if (c < Short.MIN_VALUE)
            c = Short.MIN_VALUE;

        audioData1[i] = (short) c; 

    }

    // to turn shorts back to bytes.
    byte[] end = new byte[audioData1.length * 2];
    ByteBuffer.wrap(end).order(ByteOrder.LITTLE_ENDIAN).asShortBuffer().put(audioData1);

    try {
        OutputStream out  = new FileOutputStream("mixer.wav");

        for (int i = 0; i < end.length; i++) {
            out.write(end[i]);
            out.flush();
        }

        out.close();

    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
} 
```

这行得通，谢谢大家的回答

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T08:13:26.093

```
 short[] audioData1 = null;
    short[] audioData2 = null;

    int n = 0;

    DataInputStream in1;
    try {
        in1 = new DataInputStream(new FileInputStream("audio1.wav"));

        audioData1 = new short[in1.available() / 2];
        ShortBuffer b1 = ShortBuffer.wrap(audioData1);
        try {

            while (true) {
                n = in1.readShort();
                b1.put((short) n);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    } catch (IOException e) {
        e.printStackTrace();
    }

    DataInputStream in2;
    try {
        in2 = new DataInputStream(new FileInputStream("audio2.wav"));

        audioData2 = new short[in2.available() / 2];
        ShortBuffer b2 = ShortBuffer.wrap(audioData2);
        try {

            while (true) {
                n = in2.readShort();
                b2.put((short) n);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }

    } catch (IOException e) {
        e.printStackTrace();
    }

        // find the max:
    float max = 0;
    for (int i = 44; i < audioData1.length; i++) {
        if (Math.abs(audioData1[i] + audioData2[i]) > max)
            max = Math.abs(audioData1[i] + audioData2[i]);
    }

    // now find the result, with scaling:
    for (int i = 44; i < audioData1.length; i++) {
        audioData1[i] = (short) Math.round(Short.MAX_VALUE
                * (audioData1[i] + audioData2[i]) / max);
    }

    DataOutputStream out;

    try {
        out = new DataOutputStream(new FileOutputStream("mix.wav"));

        for (int i = 0; i < audioData1.length; i++) {
            out.writeShort(audioData1[i]);
            out.flush();
        }

        out.close();

    } catch (IOException e) {
        e.printStackTrace();
    } 
```

现在简而言之，它不会工作，因为最大值是 32768（最大短）并且没有任何改变

# workflow - TFS 帮助 - TFS 中的积压、燃烧图、速度和提出问题

> ID：11330818
> 
> 赞同：0
> 
> 时间：2012-07-04T14:14:48.473
> 
> 标签：workflow, bug-tracking

我能否获得以下领域的 TFS 2010 指南：

什么是正确使用 tfs 以及为每个积压项目和任务公开的属性以记录工作量，以便我们使用燃尽图报告进度并评估速度。

对我们来说，针对任务/用户故事提出有关功能性问题的适当工作流程对我们来说并不明显，以便需要回答这些问题的人可以轻松找到那些有未解决问题的任务/故事。当问题被回答时，如何提醒需要知道答案的人答案就在那里。也许 tfs 不是执行此操作的正确位置，我们应该手动执行此操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T03:31:26.013

除非您自定义了某些内容，否则如果您使用任务工作项中名为“剩余工作”的字段 - 定期更新 - 如果可能，每天更新，您所询问的报告功能将在报告中亮起。

大多数默认报告使用的数据库 (Tfs_Analysis) 默认每 2 小时更新一次。一些报告仅显示每日汇总，因此根据您要查找的内容，您可能要到第二天才能看到变化。

至于关于如何就用户故事中缺失的信息等进行沟通的第二个问题，您应该阅读用于创建团队项目的模板的流程指南。我猜您正在使用 MSF Agile 5.0 模板，因此请搜索该模板和“流程指南”。Process Guidance 基本上是关于如何使用 TFS 工作项和报告等的说明...可以在线找到（在 MSDN 上）或通过在 Team Explorer 中右键单击您的团队项目并从上下文中选择 Process Guidance菜单。我正在通过手机回答这个问题，但如果您觉得这对您有帮助，可以稍后包含指向它的链接。

# c# - 解决方案中的多个项目：接口命名约定

> ID：11330820
> 
> 赞同：2
> 
> 时间：2012-07-04T14:14:54.937
> 
> 标签：c#, .net

我想知道解决方案中接口子项目的命名约定是什么。我知道接口文件以“I”开头，这也适用于项目吗？

我已经将接口分离到一个单独的项目中以保持解决方案的组织性，而不是在项目中创建一个接口文件来实现接口。

所有文件和项目都包含在一个解决方案中。

如果这读得不好，我深表歉意。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T14:18:57.897

这是组织多个项目的解决方案的常见模式。然而，有一些争论是否（在某些情况下）值得。

我已经看到使用了一些不同的命名约定：

1.  公司项目合同
2.  Inc.Project.Contracts
3.  Inc.Project.Interface
4.  Inc.Project （就像一个通用依赖项的基础项目）
5.  Inc.Project.Common

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T14:20:42.407

这是MS使用它的方式`<Company>.(<Product>|<Technology>)[.<Feature>][.<Subnamespace>]`

例如，`Microsoft.WindowsMobile.DirectX.`请参阅链接[http://msdn.microsoft.com/en-us/library/ms229026.aspx](http://msdn.microsoft.com/en-us/library/ms229026.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-04T14:41:44.020

我同意 dtryon 在其回答中所写的命名约定。

但不要过度设计解决方案的设计。如果您不需要从多个项目中引用您的界面，我认为将您的界面分离到自己的项目中是没有用的。它增加了复杂性，但好处很少。

接口文件本身也是如此：如果您不打算使用接口类型（而不是实际实现接口的对象的类型）来引用对象实例，那么接口并不是真正有用的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-12-01T15:37:30.780

我通常遵循...的模式

1.  MyAppSolution - 空解决方案
2.  MyApp.App - 面向客户端的应用程序
3.  MyApp.Adapters - 包含接口的项目
4.  MyApp.DAL - 数据访问层

这通常就像我做的那样简单......如果事情更复杂，我可能有一个服务项目或一个业务规则项目或类似性质的东西......我使用接口项目的原因是我想要客户端应用程序完全不了解后端实现；这样，如果我需要更改实现，只要我不更改接口，客户端就不会受到影响（不必更改）......而且，这确实发生了......我之前已经更改过 DBMS，我已经从 DBMS 变成了 API 等等......当最初构建一个应用程序时，额外的抽象层在你需要它之​​前可能看起来有点矫枉过正，那么它就是上帝派来的......

# python - 正则表达式单词边界+引号

> ID：11330822
> 
> 赞同：0
> 
> 时间：2012-07-04T14:14:56.873
> 
> 标签：python, regex

我有以下表达式，它应该以不区分大小写的方式匹配整个给定的单词。引号是单词的一部分，所以我检查单词之前或之后是否有任何引号。例如，单词“foo”不应匹配文本“foo's”。

```
word = "foo"
pattern = re.compile(r'(?<![a-z\'])%s(?![a-z\'])' % word,flags=re.IGNORECASE) 
```

例外是三引号，如果单词在它应该匹配的三引号内（旁边）：

```
pattern.search("'''foo bar baz'''") 
```

这次应该找到“foo”，但没有找到，因为这个词前面有一个引号。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T08:49:56.950

Without using lookahead:

```
>>> pat = r'([\'\"]{3}|\b)foo\1'
>>> m = re.search(pat, 'My """foo""" is rich')
>>> re.search(pat, 'My """foo""" is rich').groups()
('"""',)
>>> re.search(pat, "My '''foo''' is rich").groups()
("'''",)
>>> re.search(pat, 'My """foo"" is rich').groups()
('',)
>>> re.search(pat, 'My """foo\'\'\' is rich').groups()
('',) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T14:34:44.150

```
((?<![a-z\'\"])|(?<=\'{3}))foo((?![a-z\'\"])|(?=\'{3})) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T14:35:34.100

使用正则表达式`(?:(?<=''')|(?<!'))\bfoo\b(?:(?=''')|(?!'))`

```
pattern = re.compile(r'(?:(?<=\'\'\')|(?<!\'))\b%s\b(?:(?=\'\'\')|(?!\'))' % word,flags=re.IGNORECASE) 
```

# java - 如何将字节的字符串表示形式转换为字节

> ID：11330825
> 
> 赞同：0
> 
> 时间：2012-07-04T14:15:03.347
> 
> 标签：java

我有一个字符串，它包含一个字节值的字符串表示形式。

```
String string = "0xOA"; 
```

如何将其转换为值为 0A 的字节？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T14:21:39.240

您可以使用

```
byte b = (byte) Integer.decode("0x0A"); 
```

这适用于八进制和十进制的字符串。使用 Integer 的原因是`0xFF`Byte 会失败（如 255 > 127）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-04T14:24:36.303

您可以使用

```
Byte.parseByte(string.substring(2), 16) 
```

是`.substring(2)`去掉`0x`, 和 16 是十六进制的基数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-04T14:18:13.900

你试过了`Byte.valueOf(String s)`吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-04T14:18:09.787

尝试

```
Byte.valueOf(string, 16); 
```

# forms - Drupal 7 - 覆盖基本表单 HTML 标记

> ID：11330828
> 
> 赞同：5
> 
> 时间：2012-07-04T14:15:26.250
> 
> 标签：forms, api, drupal

我真的很难理解 Drupal Form API ......实际上是整个 Drupal。

这是我的问题，我创建了一个渲染良好的表单，但是我现在想做的是围绕某些表单元素包装 div，所以我以适合我的网站而不是某些方式的方式设置我的表单盒子标准废话。

有人可以帮忙，或者至少指出一个“好”教程的正确方向，而不是一些在网络上贴满的简短而非常模糊的废话吗？

谢谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-04T14:21:15.440

hook_form_alter 是你的朋友。

在主题的 template.php 文件中，您可以为表单、表单元素等添加前缀和后缀。

下面是我最近做的一个网站的例子。

```
function bhha_form_alter(&$form, &$form_state, $form_id) {
  if ($form_id == 'user_login') {      
    $form['#prefix'] = '<div class="loginForm">';
    $form['#suffix'] = '</div>';
    $form['name']['#title'] = Null; // Change text on form
    $form['name']['#description'] = Null; // Change text on form
    $form['name']['#attributes'] = array('placeholder' => t('username'));
    $form['name']['#size'] = '30';
    $form['pass']['#title'] = Null;
    $form['pass']['#description'] = Null; // Change text on form
    $form['pass']['#attributes'] = array('placeholder' => t('password'));
    $form['pass']['#size'] = '30';
    //$form['actions']['submit']['#value'] = t('password');
    $form['actions']['submit'] = array('#type' => 'image_button', '#src' => base_path() . path_to_theme() . '/images/Login.png');
    $form['links']['#markup'] = '<a class="user-password" href="'.url('user/password').'">' . t('Forgot your password?') . '</a>'; // Remove Request New Password from Block form
    $form['links']['#weight'] = 540;
  }
} 
```

检查您的代码以获取您想要主题 id 的表单。用连字符替换下划线，你应该能够使用上面的例子来做你想做的事。

在最基本的情况下，我想一个例子是：

```
function THEME_NAME_form_alter(&$form, &$form_state, $form_id) {
  if ($form_id == 'FORM_ID') {      
        // Adds a wrapper div to the whole form
    $form['#prefix'] = '<div class="loginForm">';
    $form['#suffix'] = '</div>';

        // Adds a wrapper div to the element NAME
    $form['name']['#prefix'] = '<div class="formRow">';
    $form['name']['#suffix'] = '</div>';
  }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-04T14:24:38.357

有几种方法可以做到这一点。例如

1.  如果您希望在字段级别覆盖标记，您可以使用`field.tpl.php`or `template_preprocess_field()`。
2.  如果您想更改表单的封闭标记（尽管我想知道为什么 Drupal 的标准标记非常适合样式），您需要注册主题函数并因此处理标记。这是一篇[很好的文章](http://www.jaypan.com/tutorial/themeing-drupal-7-forms-including-css-and-js)，详细说明了这一点。

# android - Android 设备 (GPS) 方向

> ID：11330834
> 
> 赞同：6
> 
> 时间：2012-07-04T14:15:46.837
> 
> 标签：android

使用`Location.getBearing();`我似乎会随机改变轴承。

Aka，我可以慢慢转动设备，它不会注意到，它只是选择自己的随机方位。

我知道设备正在工作，因为平板电脑上的地图应用程序中的“你在这里”图标会随着我旋转设备而缓慢旋转。

是否有不同的正确方法来获得轴承？我正在使用 GPS。也许有更好的方法来确定您所面临的方向。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T14:18:35.663

返回 GPS 卫星为您计算的`Location.getBearing()`方位。它不是您设备标题的实时表示。Google Maps 应用程序使用设备内置的 G 传感器来获取您所面对的方向。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-04T14:19:47.553

尝试从加速度传感器和磁场 (G-) 传感器获得方位。

这是一个教程：[http ://android-coding.blogspot.co.at/2012/03/create-our-android-compass.html](http://android-coding.blogspot.co.at/2012/03/create-our-android-compass.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-18T15:54:24.983

按照herom的回答使用链接：[http ://android-coding.blogspot.co.at/2012/03/create-our-android-compass.html](http://android-coding.blogspot.co.at/2012/03/create-our-android-compass.html)

我扩展了我的类来实现传感器：`extends Activity implements SensorEventListener`

并按照建议实施，但对其进行了修改以考虑到屏幕的方向。

这是我使用的代码：

```
@Override
public void onSensorChanged(SensorEvent event) {
    switch(event.sensor.getType()){
    case Sensor.TYPE_ACCELEROMETER:
        for(int i =0; i < 3; i++){
            valuesAccelerometer[i] = event.values[i];
        }
        break;
    case Sensor.TYPE_MAGNETIC_FIELD:
        for(int i =0; i < 3; i++){
            valuesMagneticField[i] = event.values[i];
        }
        break;
    }

    boolean success = SensorManager.getRotationMatrix(
            matrixR,
            matrixI,
            valuesAccelerometer,
            valuesMagneticField);

    if(success){
        SensorManager.getOrientation(matrixR, matrixValues);

        double azimuth = Math.toDegrees(matrixValues[0]);
        //double pitch = Math.toDegrees(matrixValues[1]);
        //double roll = Math.toDegrees(matrixValues[2]);

        WindowManager mWindowManager =  (WindowManager) getSystemService(WINDOW_SERVICE);
        Display mDisplay = mWindowManager.getDefaultDisplay();

        Float degToAdd = 0f;

        if(mDisplay.getRotation() == Surface.ROTATION_0)
            degToAdd = 0.0f;
        if(mDisplay.getRotation() == Surface.ROTATION_90)
            degToAdd = 90.0f;
        if(mDisplay.getRotation() == Surface.ROTATION_180)
            degToAdd = 180.0f;
        if(mDisplay.getRotation() == Surface.ROTATION_270)
            degToAdd = 270.0f;

        mapView.setFacingDirection((float) (azimuth + degToAdd)); //DEGREES NOT RADIANS
    }
} 
```

# asp.net - 将应用程序池 idletimeout 设置为 0 副作用

> ID：11330837
> 
> 赞同：3
> 
> 时间：2012-07-04T14:15:52.707
> 
> 标签：asp.net, application-pool, static-variables

我有一个在 IIS7 下运行的 Web 应用程序。我将全局变量存储在具有静态变量的类中。该类称为 SessionVariables ，例如，在其中我有以下内容：

```
public class SessionVariables
{
    public static string PreferedColor= "Black"; 
} 
```

我在另一个页面 AccountSettings.aspx 中设置此变量，其中有一个带有颜色名称的下拉列表。当用户选择一种颜色并单击保存时，这就是正在运行的代码。

```
 protected void btnSave_click(object sender, EventArgs e)
    {
    SessionVariables.PreferedColor= ddlColorNames.Text;
    } 
```

如果应用程序空闲 5 分钟，则 PreferedColor 的静态值始终重置为默认值，因为应用程序池设置正在清除静态值，因为空闲超时（分钟）设置为 5。我从 IIS 应用程序将其更改为 0池和问题消失了，应用程序池不再回收。我想知道此设置是否有任何副作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T14:47:34.097

这意味着即使在长时间没有连接之后，应用程序池进程也不会自行关闭。如果您不担心在低使用率期间清除资源，则将其关闭是完全可以的。

如果发生其他回收，您仍然会擦除变量，如果您想避免需要正确存储变量而不仅仅是在内存中（可能在数据库中）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-18T11:06:06.303

解决了，这是**web.config**中缺少的配置，在 5 分钟后清除了静态变量我添加了以下内容，一切顺利

```
<sessionState mode="InProc" cookieless="false" timeout="480"/> 
```

和

```
 <forms loginUrl="~/Login.aspx"  slidingExpiration="true" timeout="480" /> 
```

# jsf - 如何将参数传递给显示对话框的 Primefaces menuitem？

> ID：11330848
> 
> 赞同：3
> 
> 时间：2012-07-04T14:16:34.293
> 
> 标签：jsf, primefaces

我有 ap:menuButton，其中包含几个 p:menuitems。这些项目中的每一个都必须在会话范围的支持 bean 上调用具有特定参数的方法，并打开一个依赖于该支持 bean 的模式对话框。我的 p:menuitem 看起来像这样：

```
<p:menuitem value="..." oncomplete="dialog.show()" update=":dialog" actionListener="#{myController.createNewItem}">
</p:menuitem> 
```

传递给 myController.createNewItem 的参数是唯一取决于单击哪个菜单项的参数，我尝试以 3 种方式传递它：

1)`<f:setPropertyActionListener target="#{myController.newItem.property}" value="..." />`

这不起作用，因为模态对话框似乎阻止了 f:setPropertyActionListener。myController.newItem.property 的设置器仅在我关闭对话框后才被调用，这还不够好。如果对话框不是模态的，它可以工作，但我真的需要它是模态的。

2) `<f:attribute name="param" value="..." />` event.getComponent().getAttributes() 返回一个带有单个元素的地图，它看起来像 some_namespace.MARK_ID => 某个数字，这显然不是我想要传递的参数。

3）`<f:param name="param" value="..." />` 我读到这个只适用于动作，而不是动作监听器，但无论如何都试过了。FacesContext.getCurrentInstance().getExternalContext().getRequestParameterMap() 包含我表单上的所有字段以及一些额外的参数，但不是我想要传递的参数，所以我猜它不起作用。

有什么方法可以做我在这里尝试做的事情，还是我坚持使用 f:setPropertyActionListener 和非模态对话框？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T15:39:00.307

如果你想传递参数，只需使用`action`

```
<p:menuitem value="..." oncomplete="dialog.show()" update=":dialog" action="#{myController.createNewItem(your parameter)}">
</p:menuitem> 
```

在哪里`createNewItem`

```
public void createNewItem(.....){
} 
```

或者

```
public String createNewItem(.....){

     return null;
} 
```

使用或不会做任何导航`action`...`return null``void`

关于*ajax请求*，无论如何`<p:menuitem`都是在幕后做的`ajax`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-27T03:17:53.070

```
<p:menuitem value="menu item 1" update=":someForm:someJSFComponent" actionListener="#{myBean.myMethodItemListener}">
    <f:attribute name="theItem" value="#{itemValue}" />
</p:menuitem>

bean side:

public void myMethodItemListener(ActionEvent event) {
    itemSel = (SomeClassCasting) event.getComponent().getAttributes().get("itemValue");
} 
```

这对我的项目有用：

```
<p:menuButton value="#{msg.curso}">
    <c:forEach items="#{cursoBean.cursos}" var="cursoItem">
        <p:menuitem value="#{cursoItem.nome}" update=":disciplinasForm:cursoSelLabel" actionListener="#{cursoBean.selecionaItemListener}">
            <f:attribute name="cursoItem" value="#{cursoItem}" />
        </p:menuitem>
    </c:forEach>
</p:menuButton>

public void selecionaItemListener(ActionEvent event) {
    itemSelecionado = (Curso) event.getComponent().getAttributes().get("cursoItem");
} 
```

# xcode - 使用子视图按钮淡化 UIView

> ID：11330849
> 
> 赞同：0
> 
> 时间：2012-07-04T14:16:43.230
> 
> 标签：xcode, ios5, uiview, fading, icarousel

我正在尝试创建一个淡出然后在打开页面时淡出的按钮。

这是我正在使用的当前代码，淡入/淡出按钮不起作用：

```
- (UIView *)carousel:(iCarousel *)carousel viewForItemAtIndex:(NSUInteger)index reusingView:(UIView *)view
{
    if (index == 0) {
        view = [[[NSBundle mainBundle] loadNibNamed:@"nib1" owner:self options:nil] lastObject];
    }else {
        view = [[[NSBundle mainBundle] loadNibNamed:@"nib2" owner:self options:nil] lastObject];
        UIView *containView = [[UIView alloc] initWithFrame:CGRectMake(50, 50, 60, 100)];
        _btn = [UIButton buttonWithType:UIButtonTypeCustom];
        _btn.frame = CGRectMake(30, 90, 40, 30 );
        [_btn setBackgroundImage:[UIImage imageNamed:@"playButton.png"] forState:UIControlStateNormal];
        [_btn addTarget:self action:@selector(fadeButton:) forControlEvents:UIControlEventTouchUpInside];
        //[self fadeOut:_btn withDuration:1.0 andWait:1.0];
        [containView addSubview:_btn];
        [containView setAlpha:0.0];
        [view addSubview:containView];
        [UIView beginAnimations:nil context:nil];
        [containView setAlpha:1.0];
        [UIView commitAnimations];
    }
return view;
} 
```

我也尝试过使用：

```
[UIView animateWithDuration:0.5 animations:^{_btn.alpha = 1.0;}]; 
```

这些都不起作用。有人对如何淡出子视图有任何提示吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T14:23:39.953

当您调用 [UIView commitAnimations] 时，动画同时进行动画处理。当您想在其他动画之后为某些内容设置动画时，请尝试使用完成嵌套动画块：

```
[UIView animateWithDuration:0.5 animations:^
{
   //animate out
}
completion:^ (BOOL finished)
{
    [UIView animateWithDuration:0.5 animations:^
    {
       //animate in
    }
    completion:^ (BOOL finished)
    {
      //Optional
    }];
}]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T14:18:17.410

要淡出，您必须将 alpha 设置为 0，而不是 1。

```
[UIView animateWithDuration:0.5 animations:^{_btn.alpha = 0.0;}]; 
```

这应该有效。

# add - 将文件添加到 Installshield 机柜

> ID：11330858
> 
> 赞同：0
> 
> 时间：2012-07-04T14:17:22.870
> 
> 标签：add, installshield, cab

我正在尝试将文件（许可证信息）添加到几个 Installshield 安装程序，以保存单独存储文件。

我已下载 InstallShield 2012 试用版，但没有项目文件。

这可能吗（无论所需的步骤有多难）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T19:49:38.160

您可以非常轻松地对 .cab 和 .msi 文件进行反向工程。

作为第一步；看看你能用 7-zip 做什么。

我不是 100% 确定是否检查了哈希值，如果没有，您应该能够直接在 CAB 中插入/修改许可证，也许通过一些 XML 挖掘来存储文件名；尽管我对此表示怀疑。

# c# - 多参数Linq查询

> ID：11330868
> 
> 赞同：1
> 
> 时间：2012-07-04T14:17:53.607
> 
> 标签：c#, linq

以下代码给出了名称短于其值的数字。我不明白 LINQ 如何理解索引应该是元素的数组索引。谁能解释我...

```
 string[] digits = { "zero", "one", "two", "three", "four", 
                     "five", "six", "seven", "eight", "nine" };

 var shortDigits = digits.Where((digit, index) => digit.Length < index); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T14:19:41.063

> 我不明白 linq 如何理解索引应该是元素的数组索引。

它总是调用[带有谓词的重载，该谓词总是*给定*value 和 index](http://msdn.microsoft.com/en-us/library/bb549418.aspx)。这就是过载的全部目的。

从`predicate`参数的文档中：

> 测试每个源元素的条件的函数；函数的第二个参数表示源元素的索引。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T14:20:41.170

背后没有魔法。这个特定的重载在`Where`内部做这样的事情：

```
var index = 0;
foreach (var item in collection)
{
    if (predicate(item, index++)) {
        yield return item;
    }
} 
```

`predicate`你传入的 lambda 是数字`collection`数组。

# sql - 使用模数计算周期？

> ID：11330871
> 
> 赞同：1
> 
> 时间：2012-07-04T14:17:58.307
> 
> 标签：sql, tsql

我有一张表格，我可以在其中找到完成一门课程平均需要多长时间（每门课程）

**学生姓名 | 课程 | 完成课程的时间**

强尼 | 法语 | 2
肖恩 | 英语 | 3
芭芭拉 | 法语 | 8

现在我想对它进行分类：

**课程 | 平均完成时间 | 类别**

法语 | 4 | 2-4 个月
英语 | 3 | 1-3个月

如您所见，我想将它们分类为三个月。我知道使用案例陈述，但我觉得这可以更聪明地处理，fe通过使用mod 3或其他东西......

有什么想法/建议吗？

这就是我现在所拥有的

```
 Category = CASE
            WHEN avg(TimeToCompleteCourse) <=3 THEN '1-3 months'
            WHEN avg(TimeToCompleteCourse) >=4 AND avg(TimeToCompleteCourse) <=6  THEN '4-6 months'
            WHEN avg(TimeToCompleteCourse) >=7 AND avg(TimeToCompleteCourse) <=9  THEN '7-9 months'
            WHEN avg(TimeToCompleteCourse) >=10 AND avg(TimeToCompleteCourse) <=12  THEN '10-12 months'
            WHEN avg(TimeToCompleteCourse) >=13 AND avg(TimeToCompleteCourse) <=15  THEN '13-15 months'
            WHEN avg(TimeToCompleteCourse) >=16 AND avg(TimeToCompleteCourse) <=18  THEN '16-18 months'
            WHEN avg(TimeToCompleteCourse) >=19 AND avg(TimeToCompleteCourse) <=21  THEN '18-21 months'
            WHEN avg(TimeToCompleteCourse) >=22 AND avg(TimeToCompleteCourse) <=24  THEN '22-24 months'
            WHEN avg(TimeToCompleteCourse) >=25 AND avg(TimeToCompleteCourse) <=27  THEN '25-27 months'
            WHEN avg(TimeToCompleteCourse) >=28   THEN 'Way too long!'
        END 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T16:55:04.720

在我看来，您不希望使用模数运算符。mod 运算符将返回整数除法的余数 (11 mod 3 = 2)。相反，我认为您想四舍五入到最近的 3 个月间隔。更具体地说，取平均持续时间并将其四舍五入到最接近的 3。

试试这个：

```
Select  Course,
        Avg(TimeToCompleteCourse) As AvgTimeToComplete,
        Convert(VarChar(4), Ceiling(Avg(TimeToCompleteCourse) / 3.0) * 3 - 2)
        + ' - ' +
        Convert(VarChar(4), Ceiling(Avg(TimeToCompleteCourse) / 3.0) * 3)
        + ' Months' As Category
From    YourTableName
Group By Course 
```

请注意，我重复计算，其中一个是 -2。这只是为了显示值的范围。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-04T15:44:56.243

这（虽然丑陋）应该对所有模值都有效：

```
select 
course
,CASE WHEN AVG(timetocompletecourse) > 27 THEN 'Way too long'
        WHEN AVG(timetocompletecourse) < 4 THEN '1-3 Months'
        WHEN AVG(timetocompletecourse)%3 = 0 THEN CAST(AVG(timetocompletecourse)-2 AS VARCHAR(2)) + '-' + CAST(AVG(timetocompletecourse) AS VARCHAR(2)) + ' Months'
        WHEN AVG(timetocompletecourse)%3 = 1 THEN CAST(AVG(timetocompletecourse) AS VARCHAR(2)) + '-' + CAST(AVG(timetocompletecourse)+2 AS VARCHAR(2)) + ' Months'
        WHEN AVG(timetocompletecourse)%3 = 2 THEN CAST(AVG(timetocompletecourse)-1 AS VARCHAR(2)) + '-' + CAST(AVG(timetocompletecourse)+1 AS VARCHAR(2)) + ' Months'
        END as rangename
FROM yourtable
GROUP BY 
course 
```

# nhibernate - 如何使用休眠条件运行函数？

> ID：11330872
> 
> 赞同：0
> 
> 时间：2012-07-04T14:18:02.510
> 
> 标签：nhibernate, user-defined-functions, nhibernate-criteria

我们有一个搜索例程，它使用标准来构建 SQL 查询（因为它的限制是动态添加的）。在特定情况下（非常复杂的情况），我们需要搜索表值函数。（我们的模型对象映射到函数）。

结果将是这样的：

```
SELECT count(*) FROM dbo.GetSubStaffsLetterInstances(@staffId) WHERE LetterNumber="1234"; 
```

问题是我不知道如何将@staffId 传递给我的条件（我尝试添加 Eq 限制但没有成功，因为限制正在对属性起作用）我知道我可以向 IQuery 添加参数，但我不知道如何可以使用 ICriteria 对象来完成。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T21:10:08.267

如果我完全理解您的问题，您可以求助于标准 SQL：-

```
var sql = "SELECT count(*) FROM dbo.GetSubStaffsLetterInstances(:staffId) 
   WHERE LetterNumber=:letterNum";

var count = session.CreateSqlQuery(sql)
  .setInt32("staffId", 12345)
  .setString("letternum", "A1")
  .UniqueResult<int>(); 
```

或尝试`.UniqueResult<long>();`，因为我不记得返回哪一个 HQL

# powershell - Get-WmiObject : RPC 服务器不可用。（来自 HRESULT 的异常：0x800706BA）

> ID：11330874
> 
> 赞同：49
> 
> 时间：2012-07-04T14:18:07.713
> 
> 标签：powershell

当我跑

```
Get-WmiObject win32_SystemEnclosure -Computer hostname | select serialnumber 
```

它适用于本地和远程主机。

当我为使用的主机列表执行此操作时

```
ForEach ($_ in gc u:\pub\list.txt) {
    Get-WmiObject win32_SystemEnclosure -Computer $_ | select serialnumber | format-table -auto @{Label="Hostname"; Expression={$_}}, @{Label="Service Tag"; Expression={$_.serialnumber}}
} 
```

它返回

> Get-WmiObject : RPC 服务器不可用。（来自 HRESULT 的异常：0x800706BA）

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-07-05T05:45:13.257

检查是否在防火墙中为每台远程计算机启用了“Windows Management Instrumentation (WMI-In)”规则。

或者在管理命令/Powershell 提示符下运行：

```
netsh advfirewall firewall set rule group="Windows Management Instrumentation (WMI)" new enable=yes 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-07-05T06:26:58.697

这可能是由于各种问题。我不能说你的情况是哪一个。

以下给出的原因可能存在：

*   DCOM 未在主机 PC 或目标 PC 或两者上启用。
*   您的防火墙甚至您的防病毒软件都在阻止访问。
*   任何与 WMI 相关的服务都被禁用。

一些 WMI 相关服务如下所示：

*   远程访问自动连接管理器
*   远程访问连接管理器
*   远程过程调用 (RPC)
*   远程过程调用 (RPC) 定位器
*   远程注册表

有关 DCOM 设置，请参阅：

*   键：`HKLM\Software\Microsoft\OLE`，值：`EnableDCOM`

该值应设置为 'Y' 。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2015-06-09T22:15:01.057

您的代码可能没有使用正确的机器名称，您应该仔细检查。

你的错误是：

> Get-WmiObject : RPC 服务器不可用。（来自 HRESULT 的异常：0x800706BA）

这是您在无法访问机器时得到的结果。所以防火墙建议是合理的，但在这种情况下可能不正确，因为你说这有效：

```
Get-WmiObject win32_SystemEnclosure -Computer hostname 
```

因此，在您的情况下，执行此行时似乎：

```
Get-WmiObject win32_SystemEnclosure -Computer $_ 
```

$_ 不包含正确的计算机名称。您可以检查 $_ 的类型和内容。可能是文件内容有问题。如果文件看起来正确，那么可能这些行没有正确终止。也许使用 Write-Host 仔细看看：

```
ForEach ($_ in gc u:\pub\list.txt) {
    Write-Host "Get-WmiObject win32_SystemEnclosure -Computer '$_'"
    Get-WmiObject win32_SystemEnclosure -Computer $_ | select serialnumber | format-table -auto @{Label="Hostname"; Expression={$_}}, @{Label="Service Tag"; Expression={$_.serialnumber}}
} 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2017-09-04T04:12:22.110

我遇到了同样的问题，但只有几台机器。我发现使用 Invoke-Command 在远程服务器上运行相同的命令是有效的。

所以而不是：

```
Get-WmiObject win32_SystemEnclosure -ComputerName $hostname -Authentication Negotiate 
```

用这个：

```
Invoke-Command -ComputerName $hostname -Authentication Negotiate -ScriptBlock {Get-WmiObject win32_SystemEnclosure} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-11-04T00:18:41.127

如果您尝试过其他答案中的一些建议，最值得注意的是：

*   David Brabant 的回答：确认`Windows Management Instrumentation (WMI)`入站防火墙规则已启用
*   Abhi_Mishra 的回答：确认注册表中启用了 DCOM

然后考虑出现此错误的**其他常见原因：**

*   远程机器关闭
*   您指定了无效的计算机名称
*   您和目标计算机之间存在网络连接问题

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-09-16T22:29:10.537

解决了。

**尝试对配置为在 WORKGROUP 中**的远程 VM 执行以下脚本（部分）时，我遇到了完全相同的错误消息。

```
Restart-Computer -ComputerName MyComputer -Authentication Default -Credential $cred -force 
```

我注意到当我禁用防火墙时，我可以从同一个 WORKGROUP 中的另一个 VM 运行脚本，但仍然无法从域上的机器上执行此操作。这两件事以及 Stackflow 的建议使我得到了以下解决方案：

注意：更改这些设置需要您自担风险。在应用这些更改之前，您应该了解这些更改的安全含义。

在远程机器上：

*   如果您在测试期间禁用了防火墙，请确保重新启用它。
*   从 PowerShell 成功运行 Enable-PSRemoting
*   进入 wf.msc（具有高级安全性的 Windows 防火墙）
*   确认启用了私有/公共入站“ **Windows Management Instrumentation (DCOM-In)** ”规则**并**确保“远程地址”属性为“任意”或更安全。
*   确认启用了私有/公共入站“ **Windows Management Instrumentation (WMI-In)** ”规则**并**确保“远程地址”属性为“任何”或更安全。

**可选：**如果要运行“ **Enter-PSSession** ”等命令，您可能还需要执行以下操作。

*   确认启用了私有/公共入站“ **Windows Management Instrumentation (ASync-In)** ”规则**，**并确保“远程地址”属性为“任何”或更安全。
*   打开一个到 5985 的入站 TCP 端口

**重要的！**- 我的远程虚拟机在重新启动后需要大约 2 分钟左右才能响应“Enter-PSSession”命令，即使其他网络服务正在启动而没有问题。给它几分钟，然后尝试。

**旁注：**在我将“远程地址”属性更改为“任何”之前，两个规则都设置为“本地子网”。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-04-12T00:03:37.947

我发现这篇博客文章建议为“远程管理”添加防火墙例外，这对我们的 Windows Server 2008 Enterprise 系统有效。

[http://mikefrobbins.com/2012/03/08/get-wmiobject-the-rpc-server-is-unavailable-exception-from-hresult-0x800706ba/](http://mikefrobbins.com/2012/03/08/get-wmiobject-the-rpc-server-is-unavailable-exception-from-hresult-0x800706ba/)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-11-25T09:50:34.433

在目标系统上启用以下 FW 规则解决了 Win2k16 上的问题：

*   Windows 管理规范 (WMI-In)
*   分布式事务协调器 (RPC)
*   分布式事务协调器 (RPC-EPMAP)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-09-21T14:46:13.970

我在使用 foreach 时遇到了同样的问题。我将列表保存到 $servers 并使用了这个有效的：

```
ForEach ($_ in $Servers) { Write-Host "Host $($_)" | Get-WmiObject win32_SystemEnclosure -Computer $_ | format-table -auto @{Label="Service Tag"; Expression={$_.serialnumber}}
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-01-08T15:45:37.727

我想我会补充一点，我们域中的多台机器也遇到了这个问题。我创建了一个违规机器列表，并将它们全部添加到一个文本文件中，从中运行脚本。我使用提升的权限从 CMD 提示符运行它。

```
 psexec @firewallFix.txt -d netsh advfirewall firewall 
        set rule name="Windows Management Instrumentation (WMI-In)" 
        profile=domain new enable=yes profile=domain 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-03-25T12:04:18.800

下面是投票率最高的解决方案的原生 PowerShell 命令。而不是：netsh advfirewall firewall set rule group="Windows Management Instrumentation (WMI)" new enable=yes

使用可以使用稍微简单的语法：

`Enable-NetFirewallRule -DisplayGroup "Windows Management Instrumentation (WMI-In)"`

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-12-12T19:47:29.823

很奇怪，但我使用了 IP 地址（与主机名相比），它对我有用。

```
Get-WmiObject -Computername MyHostName ...  
 [Fails: Get-WmiObject : The RPC server is unavailable. (Exception from HRESULT: 0x800706BA)]

Get-WmiObject -Computername 50.50.50.50
 [Successful] 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-05-29T19:19:33.303

我有同样的问题，对我来说，我试图使用 IP 地址而不是计算机名称。只需将此添加为人们在路上发现此问题的另一种潜在解决方案。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-09-22T08:30:44.120

我想我会添加另一件事来尝试。如果某人有多个域，您可以尝试使用完全限定的域名：computer1.subdomain.domain.com

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2019-03-15T05:56:49.310

我在通过 vCenter api 通过自动化脚本构建的新服务器上遇到了类似的问题。看起来“远程过程调用 (RPC)”服务可能未在远程计算机上运行。您需要等待服务启动才能使用 Get-WmiObject 命令。因此，我只是让脚本进入睡眠状态一段时间，它就起作用了。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-02-21T10:24:33.227

我遇到了相同的“HRESULT 异常：0x800706BA”错误`get-wmiobject -computerName remoteserverName -class win32_logicaldisk`。在我的例子中，远程服务器是一个 AWS EC2 实例。Windows 服务器防火墙打开了 WMI 端口。附加到 EC2 实例的 SecurityGroup 具有允许入站的通用 RPC 端口（tcp/udp 135-139、49152 - 65535）。

然后我`netstat -a -b |findstr remoteServerName`在启动`get-wmiobject`powershell 命令后运行。原来该命令正在尝试访问远程服务器上的 tcp 端口 6402！将 tcp 6402 添加到其安全组入站规则后，get-wmiobject 完美运行！看来远程服务器已将 WMI 设置为固定端口！

因此，如果您检查了所有常用的防火墙规则，但仍然遇到 WMI 问题，请尝试使用 netstat 来确定该命令实际尝试访问的端口。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-11-10T10:43:57.427

RPC 客户端-服务器通信将使用端口 135。

因此，请确保端口 135 未被本地防火墙阻止。这可能是不工作的原因之一。

这是一个可以帮助您的链接：[https ://www.dell.com/support/kbdoc/en-in/000179474/troubleshooting-rpc-server-unavailable-errors](https://www.dell.com/support/kbdoc/en-in/000179474/troubleshooting-rpc-server-unavailable-errors)

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2014-01-23T21:13:13.330

关闭防火墙为我解决了这个问题。

* * *

## 回答 #19

> 赞同：-1
> 
> 时间：2016-11-30T13:43:36.500

我犯了这个错误

```
ForEach ($server in $servers) {
$OS = Get-WmiObject win32_operatingsystem -ComputerName $server
} 
```

当然，不能通过，因为 csv 文件中服务器的输出是 @{Name=hv1g.contoso.com}

我不得不像这样 $server.Name 从 csv 文件中调用该属性

```
ForEach ($server in $servers) {
$OS = Get-WmiObject win32_operatingsystem -ComputerName $server.Name
} 
```

它解决了我的问题。

* * *

## 回答 #20

> 赞同：-2
> 
> 时间：2012-09-19T08:50:36.750

我刚刚遇到了完全相同的问题，并在这里找到了答案：http: [//powershellcommunity.org/Forums/tabid/54/aft/7537/Default.aspx](http://powershellcommunity.org/Forums/tabid/54/aft/7537/Default.aspx)

我在输入文件的每一行末尾都有空格字符。如果您的文件也是如此，只需删除它们，您的脚本就可以工作了。

# javascript - 为用户定义的热点选择平台/语言

> ID：11330876
> 
> 赞同：0
> 
> 时间：2012-07-04T14:18:13.107
> 
> 标签：javascript, jquery, asp.net, image

当我的网站/网络应用程序显示图片时，我需要允许用户在他们单击的任何位置定义图片上的“热点”。因此，例如，当用户点击图片上的一个点时——点击的坐标周围 1cm² 将成为一个链接。更具体地说 - 当用户单击此处定义热点时 - 将打开一个对话框，要求输入一个字符串。

我对如何实现这一点的所有建议持开放态度，但想避开 Flash，我知道它很容易在 Flash 中实现，但如果我能保留这一切 javascript/jquery，那将是一个巨大的帮助。

非常感谢您的任何想法。

更多上下文：它将使用 asp .net C# 4 开发。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T14:29:24.600

您可以在 Javascript 中轻松完成此操作。添加一个点击处理程序，它将拦截图像上的所有点击。找出用户在图片中点击的位置；最好的方法是使其与图像大小相关，图像的上边缘和左边缘分别为 , 下边缘和右边缘`0`，`1`因此值`0.5,0.5`表示用户在中间单击了右侧。然后，您可以使用这些坐标将`<div>`元素定位在图像上，这些元素是可点击的、彩色的或您需要的任何元素。

您所需要的只是足够的 Javascript 来获取点击事件的坐标、图像尺寸和偏移量以及一些数学知识。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T14:32:49.010

我选择了一种与 Deceze 所说的不同的方法。

[这是概述该过程的工作jsFiddle](http://jsfiddle.net/nGb9t/1/)

我真的超越了，主要是因为 deceze 真的让我思考。

**这是表的结构。出于我们的目的，我们将表命名为“coords”**

```
-------------------------
|  id  |  xpos  |  ypos |
-------------------------
|  0   |   53   |  74   |
|  1   |  217   |  168  |
------------------------- 
```

**这是位于图像顶部的“覆盖”的点击功能。**->

```
$("#imgOver").click(function(event) {
  var parentOffset = $(this).parent().offset(); 
  var defTop = event.pageY - parentOffset.top - 25;
  var defLeft = event.pageX - parentOffset.left - 25;

  $(this).append('<div class="addLink" style="top:'+defTop+'px;left:'+defLeft+'px;"> Link </div>')
  $.ajax({
    type: 'POST',
    url: 'hotspots.php',
    data: {'top' : defTop, 'left': defLeft  }
  });
}); 
```

在上面，我们将顶部和左侧的值发布到我们的文件中，以便解析并插入到数据库中。我们也可以在这里建立更多的关系，这只是冰山一角。

我们定义`hotspots.php`为服务/处理我们的坐标请求的文件。

这是在页面加载时获取坐标并将它们放入图像中的功能。

```
$.ajax({
  type: 'GET',
  url: 'hotspots.php',
  data: 'hotspots=true',
  success: function(data){
    $(data).appendTo('#imgOver');
    $.each($('#imgOver').find('.addLink'), function(i,obj){
      var coordData = $(this).attr('rel');
      coordData = coordData.replace(' ', '');
      coordData = coordData.split('/');
      $(obj).css({'top' : coordData[1]+'px', 'left' : coordData[0]+'px' });
    });
  }
}); 
```

这是我们用来插入和解析从数据库中检索到的数据的 PHP 代码。

```
if(!empty($_POST['top']) && !empty($_POST['left'])){
  $qstr = "INSERT INTO coords(xpos, ypos) VALUES('".$_POST['left']."', '".$_POST['top']."')";
  $q = mysql_query($qstr);
}
if(!empty($_GET['hotspots']) && $_GET['hotspots'] == 'true'){
  $qstr1 = "SELECT * from coords";
  $q1 = mysql_query($qstr1);
  while($row = mysql_fetch_array($q1)){
  ?>
    <div class="addLink" rel="<?php echo $row['xpos'] ?> /<?php echo $row['ypos'] ?>"> Link </div>
  <?php   
  }
} 
```

请注意，这只是一个示例，并非用于生产用途。显然，您将拥有超过 1 张图像，并且需要建立关系。此外，我使用的 SQL 语句很容易受到攻击，应该保护以供实时使用。

祝你好运！

# .net - DI Control-Freak 反模式：难以理解

> ID：11330877
> 
> 赞同：7
> 
> 时间：2012-07-04T14:18:13.290
> 
> 标签：.net, design-patterns, dependency-injection, anti-patterns

我正在阅读 Mark Seemann 的 .NET 中的 Dependency Injection，但我一生都无法理解这一点：

> 尽管**new**关键字在涉及 VOLATILE DEPENDENCIES 时是一种代码异味，但您不必担心将其用于 STABLE DEPENDENCIES。**new**关键字通常不会突然“非法”，但您应该避免使用它来获取 VOLATILE DEPENDENCIES 的实例。

也许是因为我仍然无法理解环境上下文是一个注入而不仅仅是一个全局变量，但我只是不明白作者在说什么。

我真的很想从头到尾理解 DI，但现在我被卡住了，这只是本书的 1/3 ...... Control-Freak 反模式似乎是每个曾经生活过的程序员...

有人有任何见解吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-05T01:42:09.860

波动率（对我来说）是衡量一个班级需要改变的可能性。

理想情况下，您将类设计为对扩展开放但对修改关闭（开放封闭原则）。这并不总是可能的。那些你接近改变的类比其他类更不稳定。

NDepend（一个 .Net 静态分析度量工具）有一个称为[Instability](http://www.ndepend.com/Metrics.aspx#Instability)的度量，在我看来它是同义词。他们将其定义为：

> 不稳定性 (I)：传出耦合 (Ce) 与总耦合的比率。I = Ce / (Ce + Ca)。该指标是装配体对变化的弹性的指标。该度量的范围是 0 到 1，I=0 表示完全稳定的装配，I=1 表示完全不稳定的装配。

您不希望稳定类依赖于不太稳定的类。

至于决定注入与否，这听起来更像是一个阶级角色问题。从领域驱动设计来看，（DDD）类通常是实体（它们具有身份）、服务（它们编排事物）或值（它们是不可变的和可比较的，例如 RED 或 100ml）。

你会注入服务，你会调用新的值。实体通常来自存储库（您注入的），但在内部存储库会在它们上调用 new。这有帮助吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T15:07:38.250

通常 DI 容器将所有依赖项解析为具体实现并为您处理生命周期。但是*DI Control-Freak*则相反：使用`new`关键字创建具体对象，注入它们并仅自己处理生命周期。因此，没有其他人有可能在您的代码之外配置和处理依赖项。因此，通过提供其他实现或伪造来重用或测试它。

这是@mark-seemann 书中的引文，它回答了您的问题：

> 我将它命名为 CONTROL FREAK 来描述一个不会放弃对其依赖项的控制的类。

*每次我们使用 new 关键字创建一个类型的新实例时都会发生这种情况。当我们这样做时，我们明确声明我们将控制实例的生命周期，并且没有其他人有机会拦截该特定对象。*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-04T16:54:32.537

我以前没有听过这些术语，但是转换我对依赖注入的了解，我将它们定义如下。

一个稳定的依赖是一个具体的实现在类或配置中不会随着时间或在不同情况下发生变化的依赖。

易失性依赖项的具体实现可能会随着时间或不同情况在类或配置中发生变化。

如果您可以原谅 Java 中的示例，那么稳定的依赖关系将是`StringBuilder`. 如果您正在编写构建字符串的方法，则不需要`StringBuilder`注入，只需创建它即可。`ArrayList`,等同上`HashMap`。除了标准库类之外，如果您正在编写银行应用程序，您可能不会注入 a `RunningTotaliser`，因为它只是为您添加数字的对象。

标准库中易失性依赖的例子更难想出。一个典型的例子是`DataSource`- 这是一个封装数据库连接细节的对象，几乎可以肯定这些不应该由实际建立连接的代码提供。

# jquery - 对 jquery 中具有特定属性的所有对象添加验证函数并使用 value:true\false

> ID：11330891
> 
> 赞同：-2
> 
> 时间：2012-07-04T14:18:45.873
> 
> 标签：jquery

```
<html>
    <head>
        <script src="http://code.jquery.com/jquery-latest.js"></script>
        <script type="text/javascript" src="http://jzaefferer.github.com/jquery-validation/jquery.validate.js"></script>
        <script>
        $(document).ready(function () {
            $("[mandatory]").rules("add", {required: true});
            $("form").validate();
        })
        </script>
    </head>
    <blink>
        <body>
            <form action="#">
                <fieldset>
                    <legend>A simple comment form with submit validation and default messages</legend>
                    <p>
                        <label for="cname">Name</label><em>*</em>
                        <input id="cname" name="name" size="25" mandatory="true"/>
                    </p>
                    <p>
                        <label for="cemail">E-Mail</label> <em>*</em>
                        <input id="cemail" name="email"  size="25" mandatory="true" />
                    </p>
                    <p>
                        <label for="ccomment">Your comment</label> <em>*</em>
                        <textarea id="ccomment" name="comment" cols="22" ></textarea>
                    </p>
                    <p>
                        <input class="submit" type="submit" value="Submit" />
                    </p>
                </fieldset>
            </form>
        </body>
    </blink>
</html> 
```

它不起作用，它在这条线上说：

```
var settings = $.data(element.form, 'validator').settings; 
```

**** *Microsoft JScript 运行时错误：无法获取属性“设置”的值：对象为空或未定义*****

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T14:40:52.647

你为什么不像[文档中提到](http://docs.jquery.com/Plugins/Validation)的那样添加a`required`作为所有强制方法的类？

您可以手动添加它们，或者

```
$("[mandatory='true']").addClass("required"); 
```

* * *

**数据属性：**

`mandatory` **不是 HTML 世界中的有效属性**，所以我强烈建议您使用该**[`data`属性](http://ejohn.org/blog/html-5-data-attributes/)**并将您的更改`mandatory`为`data-mandatory`，使其符合 HTML 规范。

为此，您的电话将更改为：

```
$("[data-mandatory='true']").addClass("required"); 
```

...但我仍然不明白为什么不使用`required`类名，如果需要，只需添加它，如果不需要，不要添加它。

* * *

关于您的`settings` **错误**，请停止使用演示 URL 并使用[插件页面](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)中的 CDN 链接：

```
http://ajax.aspnetcdn.com/ajax/jquery.validate/1.9/jquery.validate.min.js 
```

这是一个

> [活生生的例子](http://jsbin.com/ikepah/3/edit#javascript,html,live)

* * *

**PS** `<blink>` [不是标准的 HTML 元素](http://en.wikipedia.org/wiki/Blink_element)。

# entity-framework - 实体框架 - 缓存问题

> ID：11330894
> 
> 赞同：1
> 
> 时间：2012-07-04T14:19:07.707
> 
> 标签：entity-framework, caching, entity

我遇到的问题如下，由于缓存问题，我们将以下内容放在每个 ET 查询开始之前：

```
DataBase.Refresh(System.Data.Objects.RefreshMode.ClientWins, DataBase.PublicUsers); 
```

但是，这会导致页面需要很长时间才能加载，因为上述命令对数据库进行了两次调用。

有没有人知道阻止 EF 缓存而不必在每次查询之前放置该命令？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T16:06:07.993

回答你最初的问题。如果您不希望上下文缓存数据，则必须执行查询而不进行更改跟踪。

```
Database.Hubs.MergeOption = MergeOption.NoTracking;
return DataBase.Hubs
            .Where(h =>
                h.BusinessId == null
                && h.TypeId != (int)HubType.BusinessPlace
                && h.ParentHubId != null
            ); 
```

但这不会解决与 Web 应用程序中的静态/共享上下文相关的架构问题。如果你真的想创建工作应用程序，你必须改变你的架构。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-02T17:28:55.313

您可以在创建上下文后将 MergeOption 设置为所有 EntitieSet。有些像这样：

```
var objSetProps = ctx.GetType().GetProperties().Where(prop => prop.PropertyType.IsGenericType && prop.PropertyType.GetGenericTypeDefinition() == typeof(ObjectSet<>));
foreach (PropertyInfo objSetProp in objSetProps)
{
    ObjectQuery objSet = (ObjectQuery)objSetProp.GetValue(ctx, BindingFlags.GetProperty, null, null, null);
    objSet.MergeOption = MergeOption.PreserveChanges;
} 
```

在此处阅读有关 MergeOption 的信息：http: [//msdn.microsoft.com/en-us/library/system.data.objects.mergeoption.aspx](http://msdn.microsoft.com/en-us/library/system.data.objects.mergeoption.aspx) 我认为您将使用 NoTracking。

但是，你想清除“缓存”实体，将其分离。

```
var entidades = Ctx.ObjectStateManager.GetObjectStateEntries(EntityState.Added | EntityState.Deleted | EntityState.Modified | EntityState.Unchanged);
foreach (var objectStateEntry in entidades)
    Ctx.Detach(objectStateEntry.Entity); 
```

Ctx 是我的上下文。

# c# - c#中的多个附件

> ID：11330895
> 
> 赞同：5
> 
> 时间：2012-07-04T14:19:09.267
> 
> 标签：c#, asp.net-mvc-3, email-attachments

我在程序中发送多个附件时遇到问题。

在尝试添加多个附件之前，我没有任何问题。所以我改变了一点代码，它停止了工作。

**创建附件：** 未添加所有代码以使其更易于查看。

```
Attachment attachment = getAttachment(bodyFile, "Formulier" + counter + ".doc");
attachments.Add(attachment);
//attachment.Dispose();

if (attachments != null)
{
  foreach (Attachment attachment in attachments)
  {
    email.Attachments.Add(attachment);
  }
} 
```

**获取附件**

```
private Attachment getAttachment(string bodyFile, string title)
{
  return createDocument(bodyFile, title);
} 
```

**创建文件**

```
private Attachment createDocument(string bodyFile, string title) 
{
  string activeDir = HttpContext.Current.Server.MapPath("/Tools");
  string newPath = Path.Combine(activeDir, "Documents");

  Directory.CreateDirectory(newPath);
  newPath = Path.Combine(newPath, title);

  FileStream fs = File.Create(newPath);
  fs.Close();
  File.WriteAllText(newPath, bodyFile);

  var fstemp = new FileStream(newPath, FileMode.Open, FileAccess.Read);
  return new Attachment(fstemp, title, MediaTypeNames.Application.Octet);

} 
```

**我在记录器中遇到的错误**

```
2012-07-04 15:45:26,149 [19] ERROR Mvc - System.Net.Mail.SmtpException: Failure sending mail. ---> System.ObjectDisposedException: Cannot access a closed file.
   at System.IO.__Error.FileNotOpen()
   at System.IO.FileStream.Read(Byte[] array, Int32 offset, Int32 count)
   at System.Net.Mime.MimePart.Send(BaseWriter writer)
   at System.Net.Mime.MimeMultiPart.Send(BaseWriter writer)
   at System.Net.Mail.Message.Send(BaseWriter writer, Boolean sendEnvelope)
   at System.Net.Mail.SmtpClient.Send(MailMessage message)
   --- End of inner exception stack trace ---
   at System.Net.Mail.SmtpClient.Send(MailMessage message)
   at ARTex.Tools.Mailer.Send(SmtpClient smtpClient, List`1 receivers, String subject, String body, List`1 attachments, String cc) in C:\Projects\KTN.Web.ARTex\ARTex\ARTex\Tools\Mailer.cs:line 262 
```

**编辑**

我摆脱了 .Dispose 方法并更改了`var fstemp = new FileStream(newPath ...` 现在我可以发送多个附件。但是现在他们随机给出错误与否。5 次中有 4 次有效。第 4 次再次出现无法打开文件的错误。第五次它又神奇地起作用了。

**编辑：解决方案**

我将 using 块与两个答案结合使用。这奏效了。Tnx 到 @HatSoft 和 @Aghilas Yakoub

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T14:29:56.407

试试这些行（在你的`CreateDocument`方法中）：

```
var fstemp = new FileStream(newPath, FileMode.Open, FileAccess.Read);
return new Attachment(fstemp, title, MediaTypeNames.Application.Octet); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-04T14:34:51.100

代码中的第 3 行在做什么？

```
attachment.Dispose(); 
```

看起来在将其添加到 Mail 之前，您正在处理该文件。因此，文件可能会在附件完成之前关闭。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T14:26:23.950

它看起来像 FileStream fs = File.Create(newPath); 中的 newPath 不正确，没有文件被创建，看着你的代码，newPath 将以“文档”结尾，File.Create 文件名带有扩展名，因此它们不会附加任何内容。

# mysql - MacPort 和 py26-mysql os x lion

> ID：11330897
> 
> 赞同：1
> 
> 时间：2012-07-04T14:19:19.227
> 
> 标签：mysql, macports

我无法使用 macport 安装 py26-mysql。

*sudo 端口安装 py26-mysql*

我得到

*错误：返回的端口 py26-mysql 的 org.macports.configure：您必须选择 mysql4、mysql5、mysql51 或 mysql55*

. 我已经安装了带有 mac 端口的 mysql5 和 mysql5-server。在我的 Mac 上，我只有 mysql5。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T19:50:10.503

我在为 python 安装 MySQL 适配器时遇到了类似的问题。我假设你想安装这个包 [http://mysql-python.sourceforge.net/]。

我的解决方案是通过**pip**（一个 Python 包安装程序）安装包，您可以从 mac 端口获得它。在 mac 端口上，根据您正在运行的 python 版本，有多个版本的 pip，例如，如果您正在运行 python 2.6，则 macports 上的 pip 包名称为：

```
py26-pip 
```

对于 python 2.7 它：

```
py27-pip 
```

完成后，您可以安装`py26-mysql`在命令行中运行以下命令的相同包：

```
sudo pip-2.6 install mysql-python 
```

（假设python 2.6）

希望有帮助

# javascript - 使用 transportCredentialOnly 安全性对 RESTful WCF 服务的跨域 Ajax JSON POST 支持

> ID：11330898
> 
> 赞同：8
> 
> 时间：2012-07-04T14:19:29.220
> 
> 标签：javascript, wcf, authentication, rest, cross-domain

我以前就这个主题发过帖子，但是在处理其他事情一年之后，我又设法再次陷入困境。我将尝试简要概述该场景以及当前使工作正常进行的尝试：

*   在主机上托管 HTML、JS 等的 IIS Web 服务器：*iis.mycompany.com*（简称*foo*）
*   通过主机上的 Windows 服务托管的 WCF RESTful Web 服务：*wcf.mycompany.com*（称为*bar*）

从*foo提供的 Javascript 通过对**bar*上的 WCF 服务进行 RESTful ajax 调用（`GET`或`POST`取决于操作）来工作，显然这些是跨域调用，因为它们不在同一主机上。

 **Javascript 使用 jQuery (1.7.2) 框架来操作 DOM 并执行对bar*的ajax 调用，预期的内容类型`POSTS`是 is ，并且预期`JSON`的响应也是 (application/json)。`GETS``JSON`

*Bar*将其 WCF 服务配置`TransportCredentialOnly`为安全模式，传输客户端凭据类型为`NTLM`，因此只有经过身份验证的用户才能联系服务。

使用 WCF 的扩展将CORS 支持添加到*bar 的*WCF 服务：

[http://blogs.msdn.com/b/carlosfigueira/archive/2012/05/15/implementing-cors-support-in-wcf.aspx](http://blogs.msdn.com/b/carlosfigueira/archive/2012/05/15/implementing-cors-support-in-wcf.aspx)

我们添加了额外的标题，并根据大量互联网文章修改了帖子中已经包含的一些标题：

```
property.Headers.Add("Access-Control-Allow-Headers", "Accept, Content-Type");
property.Headers.Add("Access-Control-Allow-Methods", "POST, GET, OPTIONS");
property.Headers.Add("Access-Control-Max-Age", "172800");
property.Headers.Add("Access-Control-Allow-Origin", "http://iis.mycompany.com");
property.Headers.Add("Access-Control-Allow-Credentials", "true");
property.Headers.Add("Content-type", "application/json"); 
```

提供有关启用 CORS 的信息的站点建议`Access-Control-Allow-Origin`应将响应标头设置为，`"*"`但是在我们的情况下这是不可能的，因为我们使用以下设置进行 jQuery ajax 调用：

```
$.ajaxSetup({
  cache: "false",
  crossDomain: true,
  xhrFields: {
    withCredentials: true
  }
}); 
```

事实证明，当您在 ajax 调用`"*"`中使用时，您不能使用已接受的来源：`"withCredentials"`

[https://developer.mozilla.org/en/http_access_control](https://developer.mozilla.org/en/http_access_control)

> “重要提示：在响应凭据请求时，服务器必须指定域，并且不能使用通配符。”

目前在我们的开发实验室中，这并不重要，因为我们可以将请求硬编码到 IIS (foo) 服务器 URL。

现在的主要问题似乎是尝试`POST`请求（`GET`正在使用上述配置工作）。当浏览器尝试该`POST`过程时，它首先向`OPTIONS`服务器发送一个标头，请求允许`OPTIONS`后续发布。这是我们希望看到我们在 CORS 支持 WCF 扩展中配置的标头被传回的地方，但是我们还没有走得那么远；在响应返回为*"401 Unauthorized"*之前，我相信这与请求 NTLM 的传输安全绑定配置有关，但我不确定。

此外，我对此不是很有经验，但我没有看到太多关于`POST`使用`application/json`内容类型的信息，而不是`text/plain`执行跨域请求时。

我知道人们可能会建议`JSONP`作为一个真正的解决方案，我并不反对不同的方法，实际上我鼓励任何人提出最佳实践，因为这将有助于其他人稍后阅读这个问题。但是，请在提出替代方案之前尝试回答问题。

非常感谢任何做出贡献的人。

彼得斯基 :)

**更新：**

Chrome (20.xx) 似乎不会遇到不协商 NTLM 以`OPTIONS`从服务器检索标头响应的问题，但 Firefox (13.0.1) 会。

我们还注意到有人已经在 Firefox 论坛上发布了一个错误，我们已将信息添加到：

[http://bugzilla.mozilla.org/show_bug.cgi?id=751552](http://bugzilla.mozilla.org/show_bug.cgi?id=751552)

**请投票支持在 bugzilla 网站上修复此错误！**

使用以下代码，我们可以观察网络跟踪以查看 Firefox 失败和 Chrome 工作正常：

```
var url = "http://myWebServiceServer/InstantMessagingService/chat/message/send";
var data = '{ "remoteUserUri" : "sip:foo.bar@mydomain.com", "message" : "This is my message" }';            
var request = new XMLHttpRequest();                     
request.open("POST", url, true);
request.withCredentials = true;
request.setRequestHeader("Content-Type", "application/json");                   
request.send(data);                     
console.log(request); 
```

另外，IE8 不支持`XMLHttpRequest`跨域调用，而是支持它自己的神奇`XDomainRequest`对象，因此我们需要做一些工作来更改客户端代码以处理 IE8 与世界案例。（感谢 IE8）。

*/me 表示 Mozilla 修复了 Firefox 错误。*

**更新 2：**

经过一番挖掘，似乎 IE8`XDomainRequest`不能用于发出必须协商 NTLM 的跨域请求，这基本上意味着由于 Web 浏览器的限制，我们的 WCF 绑定的安全性无法使用。

[http://blogs.msdn.com/b/ieinternals/archive/2010/05/13/xdomainrequest-restrictions-limitations-and-workarounds.aspx](http://blogs.msdn.com/b/ieinternals/archive/2010/05/13/xdomainrequest-restrictions-limitations-and-workarounds.aspx)

> “不会随请求发送身份验证或 cookie”

所以，我想我们现在已经做到了这一点。看起来我们将不得不创建自己的自定义令牌身份验证并将其传递给 cookie 中的 WCF 服务，或者在 IE8 的情况下，`POST`它使用 JSON。然后，WCF 服务将不得不处理解密数据并使用它来代替`ServiceSecurityContext.Current.WindowsIdentity`我们之前通过 NTLM auth 访问的数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-18T18:41:06.540

我知道您说过您希望自己解决问题，但您可以考虑使用“反向代理”。

我不知道您使用的是什么技术，但我们使用 Apache Web 服务器并在需要身份验证的不同服务器上运行 Java RESTful API。有一段时间，我们搞砸了 JSONP 和 CORS，但并不满意。

最后，我们设置了一个 Apache 反向代理，它创造了奇迹。Web 浏览器认为它正在与自己的域进行通信并采取适当的行动。RESTful API 不知道它是通过代理使用的。因此，一切正常。Apache 做了所有的魔法。

希望所有的 Web 服务器都具有像 Apache 的反向代理这样的功能。以下是有关该功能的一些文档：[http ://httpd.apache.org/docs/2.2/mod/mod_proxy.html](http://httpd.apache.org/docs/2.2/mod/mod_proxy.html)

我们所要做的就是确保安装了 mod_proxy 模块，然后将以下行添加到我们的 Apache 配置文件中：

```
ProxyPass /restapi http://restfulserver.com/restapi
ProxyPassReverse /restapi http://restfulserver.com/restapi 
```

然后重新启动网络服务器，瞧！*

# algorithm - 检查两个数字列表是否相等

> ID：11330901
> 
> 赞同：1
> 
> 时间：2012-07-04T14:19:39.517
> 
> 标签：algorithm

给定两个数字列表 A，B。有没有更好的方法来检查它们是否等于 O(N^2) 解决方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-04T14:24:44.463

对 2 个列表进行排序**O(nlogn)**
然后同时检查它们并查看它们包含相同的数字**O(n)**

总计：**O(nlogn)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T14:23:50.657

如果您的意思是，两个列表都包含相同的数字而与排序无关，您可以使用以下`O( n *log n )`算法：

1.  以相同的方式对两个列表进行排序（例如升序）
2.  从顶部开始逐项比较结果列表

步骤（1）需要`2 * O( n *log n ) = O( n *log n )`时间。第二步以线性`O(n)`时间运行。

所以运行上面的算法可以及时解决你的问题`O( n *log n )`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-04T14:24:36.157

首先检查它们的长度是否相等。如果是，您可以将 A 的数字放入 HashSet 中。遍历 B 并检查它是否存在于 HashSet 中。如果它在那里，您可以从 HashSet 中删除。如果最后 HashSet 为空，它们是相等的。这是 O(n)

实际上，HashSet 中不允许重复，因此您可以拥有一个 HashMap，其中键作为数字，值作为计数。算法保持不变。每次在 HashMap 递减计数中找到多个 B。如果最后 HashMap 为空，那么它们是相等的。这也是 O(n)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-04T14:24:04.880

假设数字在列表中排序，并且两个列表具有相同的长度：

```
bool eq = true;

for (int i = 0; i < list1.length; i++) {
    if (list1[i] != list2[i]) {
        eq = false;
        last;
    }
} 
```

# sharepoint - 找不到已发布的 Nintex 工作流程

> ID：11330903
> 
> 赞同：1
> 
> 时间：2012-07-04T14:19:43.870
> 
> 标签：sharepoint, nintex-workflow

我使用 NWAdmin 在我的网站上发布了 Nintex 工作流程：

```
NWAdmin.exe -o DeployWorkflow -workflowName "Approve Changes" -nwfFile ApproveChangesWF.nwf -siteUrl http://server/site -username username -password 1234 -domain xyz -overwrite 
```

该工具返回的结果是：

```
Workflow Published. 
```

但是，我找不到工作流程。
当我转到`Site Actions`> `Nintex Workflow 2010`>`Manage site workflows`时，我看不到我刚刚尝试添加的工作流程。
我也在尝试以编程方式获取工作流程，站点中没有工作流程。

```
SPWorkflowCollection workflowCollection = spWeb.Workflows;
workflowCollection.Count  //returns 0 
```

我怎样才能找到这个工作流程？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T01:56:34.223

SharePoint 管理器（适用于 SharePoint 2007 和 2010）是一个工具，可以显示有关您的 SharePoint 场的所有信息。如果您的工作流程确实已经部署，您应该能够使用此工具来查找您的工作流程。注意事项：这是一个非常强大的工具，您的 SharePoint 场中每个对象的每个属性都可以读取、写入、删除等...所以，请谨慎行事。

[http://spm.codeplex.com/](http://spm.codeplex.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-05-22T22:47:33.640

看看这个。可能是您尚未激活工作流程。只有激活的工作流可以与列表、库、内容类型或站点相关联。

[https://technet.microsoft.com/en-us/library/cc262348(v=office.14).aspx](https://technet.microsoft.com/en-us/library/cc262348(v=office.14).aspx)

# java - 在 Apache Tomcat 6 上的所有请求上使用相同的 Hibernate sessionFactory

> ID：11330905
> 
> 赞同：0
> 
> 时间：2012-07-04T14:19:46.473
> 
> 标签：java, apache, hibernate, rest, tomcat

我试图了解[Apache Tomcat](http://en.wikipedia.org/wiki/Apache_Tomcat)的工作原理，到目前为止，我相信它正在为每个请求创建我的应用程序的另一个实例。这就是我从这条线上得到的：

```
result = m.invoke(cls.newInstance(), parameters); 
```

在`RestfulTools.java`.

我在我的应用程序中使用[Hibernate](http://en.wikipedia.org/wiki/Hibernate_%28Java%29)，并使用与会话管理相关的方法从另一个[DAO](http://en.wikipedia.org/wiki/Data_access_object)类获取 Hibernate 会话。

是否有可能每个请求创建的所有这些实例都使用相同`sessionFactory`的来获取会话？

# jquery - 通过 javascript 更改 html 后 Internet Explorer 8 不刷新

> ID：11330907
> 
> 赞同：2
> 
> 时间：2012-07-04T14:19:49.313
> 
> 标签：jquery, ajax, layout, internet-explorer-8

我正在使用 AJAX 更新页面部分的内容。我遇到的问题是 IE 8：如果要替换的部分比以前更大或更小，浏览器不会更新页脚位置。我用过 Chrome、Firefox 和 IE 9，它运行良好，但在 IE8 中它不起作用。

有什么奇怪的？如果我在页面上选择一些文本，页脚会转到正确的位置......或者如果我使用 IE8 开发人员工具（即禁用和启用样式）修改页脚的样式，它也可以工作。

我正在使用 jQuery 函数`$(element).replaceWith(...)`，但我也尝试过使用`$(element).empty(); $(element).html(...)`相同的结果。

您可以在此处（使用 IE）检查错误，单击页面底部的“Ver más”按钮：http: [//bit.ly/RbAxyf](http://bit.ly/RbAxyf)

提前致谢

更新：有些人遇到了同样的问题，他们通过我提到的 hack 来解决它：添加和删除样式。[在单击鼠标之前，动态元素不会出现在 IE8 中](https://stackoverflow.com/questions/3350441/dynamic-elements-are-not-appearing-in-ie8-until-there-is-a-mouse-click)（它不适用于我以编程方式进行）

# c++ - 初学者使用对象和类得到以下错误

> ID：11330908
> 
> 赞同：0
> 
> 时间：2012-07-04T14:19:59.677
> 
> 标签：c++, codeblocks

这是我一直在关注的教程，我已经完成了它所说的一切，但它不起作用。我有三个文件：main.cpp、burrito.h（类）和 burrito.cpp。

这里分别是三个文件。

**主文件**

```
#include <iostream>
#include "Burrito.h"
using namespace std;

int main() {

    Burrito bo;

    return 0;
} 
```

**墨西哥卷饼.h**

```
#ifndef BURRITO_H
#define BURRITO_H

class Burrito {
    public:
        Burrito();
};

#endif // BURRITO_H 
```

**墨西哥卷饼.cpp**

```
#include <iostream>
#include "Burrito.h"

using namespace std;

Burrito::Burrito() {
    cout << "Hello World" << endl;
} 
```

当我构建并运行时，我收到以下错误：

```
...undefined reference to `Burrito::Burrito()'
collect2: ld returned 1 exit status
Process terminated with status 1 (0 minutes, 6 seconds)
1 errors, 0 warnings 
```

我正在使用 CodeBlocks 进行编译。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-04T14:26:06.663

> 我正在使用代码块

这就是问题所在。

如果您开始学习 C++，那么（不幸的是）学习[翻译单元](http://en.wikipedia.org/wiki/Translation_unit)*是必不可少*的。像 Code::Blocks 这样的 IDE 对你隐藏了这个细节——并且在这种情况下做错了（虽然这并不是 Code::Blocks 的错，但它无法在没有配置的情况下自动猜测在这种情况下要做什么）。

一开始，放下IDE，进入命令行进行编译。分别编译两个翻译单元并将它们显式链接在一起。

```
g++ -o burrito.o burrito.cpp
g++ -o main.o main.cpp
g++ -o main main.o burrito.o 
```

每本优秀的 C++ 初学者书籍都会解释它是如何工作的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T14:22:58.257

当您将对象链接在一起以获得最终的可执行文件时，您忘记正确链接来自 burrito.cpp 文件的编译对象

如果您使用 Makefile 进行构建，您的最终输出规则应该类似于“-o main main.o burrito.o”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-15T17:08:51.557

使用代码块 13.12 我右键单击 Burritto.cpp 文件选择属性，然后选择构建选项卡并检查编译文件和链接文件复选框，然后单击确定保存所有内容然后运行，效果很好。

# javascript - 如何使用 Javascript 播放 mp3？

> ID：11330917
> 
> 赞同：36
> 
> 时间：2012-07-04T14:20:57.283
> 
> 标签：javascript, html, mp3

我的网站上有一个目录，里面有几个 mp3。我使用 php 在网站中动态创建了它们的列表。

我还有一个与它们相关的拖放功能，我可以选择要播放的那些 mp3 列表。

现在，给出该列表，我如何单击按钮（播放）并使网站播放列表的第一个 mp3？（我也知道网站上的音乐在哪里）

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2012-07-04T14:37:06.237

`new Audio('<url>').play()`

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2012-07-04T14:39:28.177

如果你想要一个适用于旧浏览器的版本，我制作了这个库：

```
// source: https://stackoverflow.com/a/11331200/4298200
function Sound(source, volume, loop)
{
    this.source = source;
    this.volume = volume;
    this.loop = loop;
    var son;
    this.son = son;
    this.finish = false;
    this.stop = function()
    {
        document.body.removeChild(this.son);
    }
    this.start = function()
    {
        if (this.finish) return false;
        this.son = document.createElement("embed");
        this.son.setAttribute("src", this.source);
        this.son.setAttribute("hidden", "true");
        this.son.setAttribute("volume", this.volume);
        this.son.setAttribute("autostart", "true");
        this.son.setAttribute("loop", this.loop);
        document.body.appendChild(this.son);
    }
    this.remove = function()
    {
        document.body.removeChild(this.son);
        this.finish = true;
    }
    this.init = function(volume, loop)
    {
        this.finish = false;
        this.volume = volume;
        this.loop = loop;
    }
} 
```

文档：

`Sound`接受三个参数。声音的`source`url，`volume`(from `0`to `100`) 和`loop`( `true`to loop，`false`not to loop)。
`stop`允许`start`之后（相反`remove`）。
`init`重新设置参数音量和循环。

例子：

```
var foo = new Sound("url", 100, true);
foo.start();
foo.stop();
foo.start();
foo.init(100, false);
foo.remove();
//Here you you cannot start foo any more 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-07-04T14:28:12.913

您可能希望使用新的 HTML5`audio`元素来创建`Audio`对象、加载 mp3 并播放它。

由于浏览器的不一致，这个示例代码有点长，但它应该可以满足您的需要并进行一些调整。

```
//Create the audio tag
var soundFile = document.createElement("audio");
soundFile.preload = "auto";

//Load the sound file (using a source element for expandability)
var src = document.createElement("source");
src.src = fileName + ".mp3";
soundFile.appendChild(src);

//Load the audio tag
//It auto plays as a fallback
soundFile.load();
soundFile.volume = 0.000000;
soundFile.play();

//Plays the sound
function play() {
   //Set the current time for the audio file to the beginning
   soundFile.currentTime = 0.01;
   soundFile.volume = volume;

   //Due to a bug in Firefox, the audio needs to be played after a delay
   setTimeout(function(){soundFile.play();},1);
} 
```

编辑：

要添加 Flash 支持，您需要在标签内附加一个`object`元素。`audio`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-04T14:23:08.987

您可以使用[`<audio>`](https://developer.mozilla.org/en/HTML/Element/audio)HTML5 标签使用 JavaScript 播放音频。

但这不是跨浏览器的解决方案。它仅在现代浏览器中支持。对于跨浏览器的兼容性，您可能需要为此使用 Flash（例如[jPlayer](http://www.jplayer.org/)）。

浏览器兼容性表在我上面提到的链接中提供。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-04T14:28:13.667

你可以试试[SoundManager 2](http://www.schillmania.com/projects/soundmanager2/)：它会透明地处理`<audio>`任何支持的标签，并在不支持的地方使用 Flash。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-04T14:28:28.020

假设浏览器支持 MP3 播放并且相当新以支持更新的 JavaScript 功能，我建议看一下[jPlayer](http://www.jplayer.org/)。您可以查看有关如何实现它的简短演示[教程。](http://www.jplayer.org/latest/demo-01-supplied-mp3/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-05T10:59:11.210

用于音频 mp3 播放器的 Jquery 插件[http://www.jplayer.org/0.2.1/demos/](http://www.jplayer.org/0.2.1/demos/)

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2012-07-04T15:50:52.593

好好享受 ;）

```
<html>
<head>
    <title>Play my music....</title>
</head>
<body>
    <ul>
        <li>
        <a id="PlayLink" href="http://www.moderntalking.ru/real/music/Modern_Talking-You_Can_Win(DEMO).mp3" onclick="pplayMusic(this, 'music_select');">U Can Win</a>
        </li>
        <li>
        <a id="A1" href="http://www.moderntalking.ru/real/music/Modern_Talking-Brother_Louie(DEMO).mp3" onclick="pplayMusic(this, 'music_select');">Brother Louie</a>
        </li>
    </ul>
<script type="text/javascript" src="http://mediaplayer.yahoo.com/js"></script>
</body>
</html> 
```

# google-maps-api-3 - Google API 和 OAuth 2.0 的正确重定向 URI

> ID：11330919
> 
> 赞同：32
> 
> 时间：2012-07-04T14:21:10.753
> 
> 标签：google-maps-api-3, oauth-2.0, google-fusion-tables

我正在使用 Google Maps API 制作应用程序。我希望能够让一个人在电脑上，观看另一个人在地图上编辑的内容。我正在考虑将地图信息传递给 Google Fusion Table。其他人将能够将所有内容视为一个图层。我希望程序只从用户的浏览器运行，而不是为它建立一个网站。

要编辑融合表，我需要获得访问权/令牌。我目前正在尝试使用这些 JavaScript 来完成此操作。[ScriptSample.html](http://code.google.com/p/gwt-oauth2/source/browse/trunk/samples/script/ScriptSample.html)、[oauthWindow.html](http://code.google.com/p/gwt-oauth2/source/browse/trunk/samples/script/oauthWindow.html)和[gwt-oauth2.js](http://code.google.com/p/gwt-oauth2/source/browse/trunk/samples/script/gwt-oauth2.js)。这是[工作示例](http://gwt-oauth2.googlecode.com/svn/trunk/samples/script/ScriptSample.html)。

当我运行它们时，我收到一条错误消息，指出*重定向 URI*不正确。它说我用来重定向的文件没有权限。我的第一个明显问题是：

> 如何授予该文件重定向权限？

在我的 API 控制台中，我将其设置为客户端 Web 应用程序。我应该将其更改为已安装的应用程序吗？

目前我有以下设置：

*   我的 JavaScript 起源是：`https://localhost`
*   重定向 URI：`https://localhost/oauthWindow.html`

谢谢

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-12-11T15:45:04.340

使用本地主机 url 进行开发工作没有问题 - 显然它需要在生产时进行更改。

您需要访问此处： [https](https://developers.google.com/accounts/docs/OAuth2) ://developers.google.com/accounts/docs/OAuth2 ，然后点击 API 控制台的链接 - 基本步骤部分中的链接。填写新申请表后，系统会要求您提供重定向网址。授予访问权限后，放入您要访问的页面。

形成 Google oAuth 网址时 - 您需要包含重定向网址 - 它必须完全匹配，否则您会遇到问题。它还需要进行 UrlEncoded。

# ruby-on-rails - will_paginate 3.0 与 Rails 2.3 或更早版本不兼容 (RuntimeError)

> ID：11330921
> 
> 赞同：0
> 
> 时间：2012-07-04T14:21:15.560
> 
> 标签：ruby-on-rails, ruby, rubygems, gem, will-paginate

当我运行`rails -v`输出是`Rails 3.0.15`. 我也完成`gem install rails 2.3.5`了 environment.rb 文件所说的需要。

当我的 rails 不*早*于 2.3 时，为什么会出现此错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T14:34:11.053

即使安装了两个 gem，也不能混合使用 Rails 2 和 Rails 3。有两种选择：

*   [安装 2.3.x 版本](https://github.com/mislav/will_paginate/wiki/Installation)的`will_paginate`
*   [将您的应用升级](http://guides.rubyonrails.org/3_0_release_notes.html#upgrading-to-rails-3)到 Rails 3

# version-control - 如何将代码从 Perforce 存储库移植到 TFS

> ID：11330922
> 
> 赞同：2
> 
> 时间：2012-07-04T14:21:18.223
> 
> 标签：version-control, perforce

我继承了 C# 解决方案的维护责任，该解决方案目前在 Perforce 的源代码控制下。我想将代码移植到 Team Foundation Server。有没有一种轻松的方法可以做到这一点，或者是手动从 Perforce 获取头部并将其添加到 TFS 的情况？

（说我对 Perforce 和 TFS 知之甚少可能会很有用 :-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T14:39:50.947

我建议您使用迁移工具。历史很重要，因此迁移工具必须能够保留历史。我建议您迁移到**Import**文件夹。从此您可以分支到新的 TFS 结构。更改为 TFS 时，您可能会更改分支结构/模式。

![在此处输入图像描述](../Images/222ba75db51fd2dd1d2f3ff4bf360ae7.png)

Perforce 和 TFS 在源代码控制方面非常相似。但是，我建议您阅读有关 SCM 模式的内容。为了获得具有支持您的分支要求的结构和可以组织您的项目的项目文件夹结构的存储库，有必要记录您的 SCM 策略。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T21:02:48.437

通过[MSDN](http://social.msdn.microsoft.com/forums/en-US/tfsgeneral/thread/866c5ee6-0d95-4e38-aab6-aae306a88596/)上的这个线程，没有现成的工具可用，但你可以试试[这些顾问](http://www.aitgmbh.de/index.php?id=perforce_migration_p4&L=1)；它们是通过 MSDN 链接的，所以我认为它们已获得 Microsoft 的批准。

# php - 检测页面然后做某事

> ID：11330924
> 
> 赞同：0
> 
> 时间：2012-07-04T14:21:21.253
> 
> 标签：php

我需要“页面”链接才能检测用户是否在“页面”下拉菜单中包含的任何页面上。检测它们是否仅在 1 页上很容易，我需要将多个实例添加到“页面”项。希望这更有意义。

这是我所拥有的：

```
<li class='dropdown' id="menu1">
  <a class="dropdown-toggle" data-toggle="dropdown" href="#menu1">Pages</a>
    <ul class="dropdown-menu">
      <li>
        <a href="index.php">Home</a>
      </li>
      <li>
        <a href="about.php">About</a>
      </li>
    </ul>
</li> 
```

JUST index.php 的代码示例如下：

```
<li <?php if (stripos($_SERVER['REQUEST_URI'],'index.php') !== false) {echo 'class="active"';} ?>>
    <a href="index.php">Home</a>
</li> 
```

就像我之前说的，我需要在基本上一个 PHP 块中添加多个实例来检测 MORE THAN，如果用户只是在*[filename]* .php

希望这是有道理的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T15:43:50.713

您必须将列表项放在一个数组中。然后循环它们以创建菜单。

```
$pages = array(
    'Home' => 'home.php',
    'About' => 'about.php'
);

<?php foreach ($pages as $name => $url): ?>
    <li <?php if (stripos($_SERVER['REQUEST_URI'], $url) !== false):
        echo 'class="active"';
    endif ?>>
        <a href="<?php echo $url?>"><?php echo $name?></a>
    </li>
<?php endforeach ?> 
```

这将检查数组中的每个结果以查看它是否与 uri 匹配。如果是这样，它会将活动类添加到 li。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T15:34:27.983

首先，您只需要提取页面名称，然后需要将其与可能的页面数组进行比较：

```
<?php if (in_array(preg_replace('|.*/(.+\.php).*|i','\\1',$_SERVER['REQUEST_URI']), array('index.php','about.php'))) {echo 'class="active"';} 
```

# dynamics-crm - 不存储 MS CRM 2011 中银光控制的价值

> ID：11330925
> 
> 赞同：1
> 
> 时间：2012-07-04T14:21:29.253
> 
> 标签：dynamics-crm, dynamics-crm-2011, crm, dynamics-crm-online

我在 CRM 2011 中使用了 silverlight 控件。它也在表单上发布，但问题是我无法在 CRM 中存储它的值。一般来说，如果我们创建任何字段并在表单中发布该字段，那么它的值将在之后存储单击“保存”按钮。之后，当我们打开该记录时，我们可以看到先前存储的控件值。但在我的情况下，我在表单上发布了该银色灯控件，但是当我单击“记录”保存记录后，我看不到它再次值。意味着silverlight控制值不会存储在CRM中。我只是简单地使用了silverlight的文本框......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T20:00:40.867

您需要从 Silverlight 调用表单上的 JavaScript 函数。查看用于在页面和 Silverlight 之间进行通信[的 HTML 桥。](http://msdn.microsoft.com/en-us/library/cc645076%28v=vs.95%29.aspx)MSDN 中有一个从 Silverlight 注册和调用 JavaScript 函数[的示例。](http://msdn.microsoft.com/en-us/library/cc221359%28v=vs.95%29.aspx)

在 Silverlight 中，它看起来像：

```
HtmlPage.Window.Invoke("myJSMethod", myParam); 
```

# c# - 更改公钥令牌，如何重定向程序集？

> ID：11330928
> 
> 赞同：2
> 
> 时间：2012-07-04T14:21:57.523
> 
> 标签：c#

我的一位客户想要更改程序集签名政策。

基本上，所有代码和程序集都将使用相同且唯一的 snk 文件进行签名。

不幸的是，一个非常大的代码库正在使用旧的公钥令牌。

有没有办法将旧名称“重定向”到新名称程序集？

我读过[Assembly Binding Redirection](http://msdn.microsoft.com/en-us/library/2fc472t2.aspx)，但看起来它只能重定向到相同程序集名称/公钥令牌的新版本。

虽然我可以重新编译代码，但我有很多 aspx 和 ascx 引用旧名称。我还有 3rd 方数据库，它以二进制格式序列化一些对象。我不能轻易改变。

# asp.net-mvc-3 - 带有 ASP.net MVC 3 的 ReportViewer

> ID：11330930
> 
> 赞同：3
> 
> 时间：2012-07-04T14:22:03.433
> 
> 标签：asp.net-mvc-3, reporting-services, reportviewer

我已经开发了 SSRS 报告并部署在服务器上。报告有下拉列表，根据下拉选择报告数据会有所不同，因为此下拉值作为参数传递给报告。该报告在直接访问时工作得很好。

现在我已使用 ReportViewer 将此报告集成到我的 ASP.net MVC 3 应用程序中。当通过 Web 应用程序页面访问报告时，似乎正在正确加载，但是当我单击查看报告时，它会显示消息“正在加载”一段时间，然后什么也不显示。我对此一无所知，根本不理解这种行为。

* * *

**更新**

我在[https://stackoverflow.com/a/2547454/287100找到了解决方案](https://stackoverflow.com/a/2547454/287100)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-04T15:34:40.137

这是一个特殊的问题，您需要**将 ASP.NET web-forms 与 MVC 结合起来**，这非常好。因为，如果**将 ReportViewer 控件放在****MVC 视图**中，它将无法工作，因为它**需要 ViewState**。

如何**使 SSRS 工作**？很好地遵循这篇文章 - [Incorporating ASP.NET MVC and SQL Server Reporting Services](http://www.code-magazine.com/articleprint.aspx?quickid=1009061&printmode=true)

另一篇文章展示**了将 Web 表单与 mvc 结合的好处**-[在 ASP.net MVC 站点中查看 SSRS 报告](https://stackoverflow.com/q/4137835/1437962)

# javascript - 从父窗口获取 iframe 中文本框的值

> ID：11330933
> 
> 赞同：10
> 
> 时间：2012-07-04T14:22:09.190
> 
> 标签：javascript, jquery, html, iframe

我的页面中有一个 iframe，如何通过单击按钮从父页面获取框架中 t 文本框的值？

这是我的代码

```
<div>
<iframe src="test.html" >
<input type=text id="parent_text">
<input type="button">
</div> 
```

这是 d test.html

```
<input type="text" id="frame_text"> 
```

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-04T14:29:37.393

像这样的东西：

```
var iframe = document.getElementById('iframeId');
var innerDoc = iframe.contentDocument || iframe.contentWindow.document;
var input = innerDoc.getElementById('frame_text'); 
```

首先你得到 iframe。然后你从 iframe 中得到第一个有效的 dom 文档。

最后得到输入框。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T14:47:32.190

```
<!DOCTYPE html>
<html>
<head>
    <title></title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <script type="text/javascript">
        function getIframeText() {
            var iframe0 = document.getElementById("iframe0");
            var iframe0document=iframe0.contentDocument||iframe0.contentWindow.document;
            var inputIframe = iframe0document.getElementById("frame_text");
            alert(inputIframe.value);
        }
    </script>
</head>
<body>
    <div>
        <button onclick="getIframeText()">get iframe text</button>
        <iframe id="iframe0"  src="test.html" >
        <input type=text id="parent_text">
    </div>
</body>
</html> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-26T06:29:57.533

如果您在一个***iframe***中有如下的***Div/ 输入***

 *```
 <iframe id="ifrmReportViewer" name="ifrmReportViewer" frameborder="0" width="980"

     <div id="EndLetterSequenceNoToShow" runat="server"> 11441551 </div> Or

     <input id="txtSequence" type="text" value="10500101" />

     <form id="form1" runat="server">        
       <div style="clear: both; width: 998px; margin: 0 auto;" id="divInnerForm">          

            Some Text

        </div>
     </form>
 </iframe> 
```

然后您可以使用以下代码找到那些***Div的文本***

```
var iContentBody = $("#ifrmReportViewer").contents().find("body");
var endLetterSequenceNo = iContentBody.find("#EndLetterSequenceNoToShow").text();

var txtSequence = iContentBody.find("#txtSequence").val();
var divInnerFormText = iContentBody.find("#divInnerForm").text(); 
```

我希望这会对某人有所帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-02-12T16:31:59.843

```
$('iframe').contents().find('#mytextbox').val("myvalue"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-12-18T05:21:52.493

这是父页面代码（我的意思是主页调用`iframe`）：

```
<script>
 function frameClick(string){
   var name=string;
   document.getElementById("parent_text")=name;
   }
</script>

<div>
<iframe src="test.html" id="frame1">
<input type=text id="parent_text">
</div>

Here is iframe code(test.html):

<form method="post" action="" id='frm1' >
<input type="text" id="frame_text">
<input type="button" id="btm1" name="hangup" onclick="parent.frameClick(this.form.frame_text.value);" value="submit">
</form> 
```*

# c# - NHibernate 在同一个应用程序中使用 2 个模式？

> ID：11330937
> 
> 赞同：1
> 
> 时间：2012-07-04T14:22:25.340
> 
> 标签：c#, nhibernate

想象一下，您正在使用 NHibernate 编写一个大型应用程序，并且您想要有 2 个单独的模式（顺便使用 Sql Server）

1.  Application_System（与系统相关的所有表、配置表、用户表等）
2.  Application_Data（用户与系统交互时存储/检索的所有实际数据）

现在我一直试图在 NHibernate 中找到一种简单干净的方法来执行此操作，并认为我已经通过使用 Catalog 和 Schema 属性找到了解决方案，例如：

```
Catalog("Application_System");
Schema("dbo");
Table("SystemSettings") 
```

会为`Application_System.dbo.SystemSettings`. 这有点工作，但如果我定义了 2 个目录，那么 hbm2ddl.auto 的创建/删除表功能将停止工作。现在我得出的结论是，我可能正在滥用 Catalog 和 Schema 属性来做一些不适合的事情。但是，我似乎找不到一种简单的方法来实现不涉及一些复杂的脚手架的相同事情。

任何帮助，将不胜感激。我不敢相信 NHibernate 不会开箱即用地支持这一点，我的意思是这是一个相当基本的要求。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T18:56:02.657

SchemaExport 不支持创建模式/目录 ootb，但您可以使用 xml、FluentNHibernate 或 MappingByCode 中的辅助对象自行添加创建模式/目录 ddl。请注意，必须先添加辅助对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T09:26:33.160

好吧，我找到了一个我相当满意的中途房子。ISession 有一个 Connection 属性，它公开了一个`ChangeDatabase(string databaseName)`方法，允许您更改会话指向的数据库。

我的模式导出仍然很糟糕，因为最终它不知道哪个对象适用于哪个数据库，因此会尝试将其全部保存到配置中定义的数据库中。

你赢了一些，你输了一些。

# sql - 根据在字段中找到的文本删除记录 (

> ID：11330950
> 
> 赞同：3
> 
> 时间：2012-07-04T14:23:25.033
> 
> 标签：sql, ms-access, ms-access-2007, vba

我通常在 Excel 2007 中完成大部分工作，但我认为 Excel 不是管理我需要处理的数据的正确工具。所以我正在尝试将一个 excel 电子表格转换为一个 Access 2007 db，我可以毫无问题地做到这一点，但在对电子表格做任何事情之前，我会通过清理其中的数据以使用结果信息的过程。在excel中，我使用如下宏

```
Sub deletedExceptions_row()
    Dim i As Long
    Dim ws As Worksheet

    On Error GoTo whoa

    Set ws = Sheets("data") 

    With ws
        For i = .Cells.SpecialCells(xlCellTypeLastCell).Row To 1 Step -1
            If .Cells(i, 3) = "" Or _
              VBA.Left(.Cells(i, 3), 4) = "511-" Or _
              VBA.Left(.Cells(i, 3), 5) = "CARL-" Then
                .Rows(i).Delete
            End If
        Next i
    End With
    Exit Sub
whoa:
    MsgBox "Value of i is " & i
End Sub 
```

删除电子表格中不必要的记录我将如何在 Access 2007 中完成同样的事情。

该宏正在查找特定部分，或者更确切地说是记录第三个字段的前几个字符，以确定是否需要删除整个记录（例如 511-QWTY-SVP 或 CARL-52589-00）。总共有大约 180 个这样的字符类型会影响需要从电子表格中删除的 1000 行，但我想在 Access 2007 中复制相同的过程，但不知道如何。

感谢大家**对**这个问题的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T14:45:24.937

在 Access 中，您可以执行`DELETE`语句以丢弃字段中的值为空字符串 ("") 或与您的模式之一匹配的行。

```
DELETE FROM YourTable
WHERE
       YourField = ""
    OR YourField ALike "511-%"
    OR YourField ALike "CARL-%"; 
```

使用索引，WHERE 子句中的模式匹配比使用电子表格宏等函数`YourField`的查询提供了潜在的巨大性能改进。`Left()`IOW，以下查询将要求 db 引擎在`YourTable`. 但是通过上面的查询和`YourField`索引，数据库引擎可以简单地选择匹配的行......这很容易快一个数量级。

```
DELETE FROM YourTable
WHERE
       YourField = ""
    OR Left(YourField, 4) = "511-"
    OR Left(YourField, 5) = "CARL-"; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-04T15:30:19.897

```
Sub DeleteRows(strVal as string)
     strVal = Trim(strVal)
     if strVal = "" then exit sub
     dim dbs as Database
     set dbs = CurrentDB
     dbs.execute "Delete * FROM YOURTABLE where YOURFIELD Like '" & strVal & "*'"
     set dbs = Nothing
End Sub 
```

然后为每个项目调用它

```
DeleteRows("Carl-")
DeleteRows("511-") 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-04T15:38:00.617

鉴于您有 180 个可能的问题行，创建一个问题列表表可能是有意义的。例如：

**Excel导入**

```
ID  ARow
1   Carl-abdre
2   511-ferw2
3   wywr-carl
4   123-456 
```

**问题清单**

```
Problem
511-
Carl- 
```

**询问**

```
DELETE 
FROM ExcelImport
WHERE ExcelImport.ID In (
    SELECT ID 
    FROM ExcelImport, ProblemList 
    WHERE ARow Like [Problem] & "*" Or ARow & ""="") 
```

**查询后导入Excel**

```
ID  ARow
3   wywr-carl
4   123-456 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-04T14:46:43.113

您使用 SQL 语言管理数据库数据。对于访问，请检查：

[http://msdn.microsoft.com/en-us/library/bb177896%28v=office.12%29.aspx](http://msdn.microsoft.com/en-us/library/bb177896%28v=office.12%29.aspx)

```
Sub DeleteX()

    Dim dbs As Database, rst As Recordset
    Set dbs = OpenDatabase("Northwind.mdb")

    dbs.Execute "DELETE * FROM " _
        & "Employees WHERE Title ALike 'FOOBAR-%';"
    dbs.Close
End Sub 
```

# sql-server - @DBCommand 和 SQL Server

> ID：11330951
> 
> 赞同：0
> 
> 时间：2012-07-04T14:23:25.527
> 
> 标签：sql-server, lotus-notes, lotus-domino

我一直在 MySQL 数据库上使用@DBCommand。巨大的成功。现在我必须切换到 SQL Server。

1.  我设法很好地更新了 SQL Server 数据库（通过 Domino）。

2.  当我尝试为 Web 用户 (Domino) 生成报告时，会出现问题。查询就像 SQL Server Management Studio 中的魅力一样。运行网页产生：

> *数据访问应用层>无法执行@db函数*

原始查询对 MYSQL 工作得很好。

**我需要一些描述提示和技巧的资源/文档/网页才能使其正常工作。有任何想法吗？**

失败的示例查询（使用 Domino 时）：

```
 SELECT COUNT( bruk_NR ) as [antall], [brukere_Navn], [bruk_NR]
  FROM [stat].[dbo].[bruk]
  INNER JOIN
  [stat].[dbo].[brukere] 
  ON bruk.bruk_NR = brukere.brukere_NR AND bruk.bruk_NR = brukere.brukere_NR
  GROUP BY bruk.bruk_NR, brukere.brukere_Navn, brukere.brukere_brukerID
  ORDER BY [brukere_brukerID] ASC 
```

提前感谢哈尔。

# c# - 在不丢失当前页面/过滤器的情况下刷新 MVC3/MVC4 WebGrid

> ID：11330967
> 
> 赞同：3
> 
> 时间：2012-07-04T14:24:39.283
> 
> 标签：c#, jquery, ajax, asp.net-mvc-3, webgrid

我有一个绑定到普通类对象的 WebGrid。没有什么花哨。Grid 具有一些分页功能，用于显示用户列表。网格的最后一列是一个 Ajax 动作链接，它触发带有一些编辑控件的弹出 DIV。完成此编辑后，OnSuccess 事件将触发并关闭 DIV。这是我现在想刷新网格而不丢失当前页面/搜索/过滤器应用的地方。想到的一种方法是以某种方式获取 WebGrids Url，然后用 JQuery 刷新它，但是.. 我找不到检索当前 url 和参数的方法？以前有人试过吗？

## 更新：感谢答案，这就是我现在所采用的方法：）

ajax编辑调用的ActionResult

```
[HttpPost]
public ActionResult EditUserDetails(User model)
{
    if (ModelState.IsValid)
    {
        // for the sake of brevity.

        // do your edit logic here and then on success you return:

        return Json(new { state = "success", id = "1", name = "John", surname = "Doe", etc = "blah" });
    }
    else
    {
        return Json(new { state = "failed", message="some error text here maybe?" });
    }
} 
```

然后在编辑上单击我将行的类设置为 .editRowSelected。（我会将其更改为 id）

然后是 Ajax 更新调用的 onSuccess：

```
function onSuccess(ajaxContext) {
    var result = eval(ajaxContext);
    if (result.state == "Success") {

        var row = $('.busyEditRow');
        row.html(content);

        $('.busyEditRow').removeClass('busyEditRow');
    }
    else {
        // Display some error stuffs here with the message - result.message
    }
} 
```

这将使用新数据更新网格行:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T15:31:46.393

刚刚编辑了一条记录，而不是刷新整个网格，然后必须回发应用的过滤器、当前页面等，我将在我的控制器中有一个函数，它返回一个包含单个用户数据的局部视图。

您可以在 DIV 关闭后通过 AJAX 调用它，并使用 jQuery 将网格中的行替换为函数返回的 HTML。

只要网格中的每一行都可以通过 id 识别，就应该足够简单地找到相关行并替换它。

# liferay - 了解 Action Phase 和 Render Phase 的执行

> ID：11330969
> 
> 赞同：0
> 
> 时间：2012-07-04T14:24:43.123
> 
> 标签：liferay, portlet

我正在使用 Liferay 6 进行门户开发。

通过阅读[Liferay 开发人员指南](http://www.liferay.com/documentation/liferay-portal/6.0/development)，作者解释说 Portlet 执行分为两个阶段

1.  行动阶段
2.  渲染阶段

```
public class DateTimePortlet extends GenericPortlet 
{
    public void doView(RenderRequest req, RenderResponse res) throws IOException, PortletException 
    {        
        Object actionAttribute = req.getAttribute("datetime");
        res.getWriter().println("Date Time:" + (actionAttribute != null ? actionAttribute :"Unavailable"));
        res.getWriter().println("<BR/>");
        PortletURL u = res.createActionURL();
        res.getWriter().println("<A href=" + u + ">Trigger an action.");
        res.getWriter().close();
    }

    public void processAction(ActionRequest req, ActionResponse res) throws PortletException 
    {
        req.setAttribute("datetime",new Date());
    }        
} 
```

我的理解是该`doView`方法称为“**渲染阶段**”，该`processAction`方法称为“**操作阶段**”。

如果一个页面上显示了 5 个 portlet，则`doView`每次页面刷新都会执行“渲染阶段”（即方法内的代码）。

请让我知道我是否正确。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-04T16:49:55.110

是的，正确：有最大值。1 个 portlet 处理每个请求的操作，但页面上的所有 portlet 都将运行呈现请求（除非输出被缓存，但让我们搁置这些相当高级的东西）

也可以对请求进行 0 次操作处理，仅完成渲染（这是通常在 portlet 上执行的最常见操作。您必须（并且不能）在此阶段不更改任何状态。）。

在一个动作之后，可以触发可以在任意数量的 portlet 上执行的事件阶段（参见 Inter-Portlet-Communication，IPC）。

如果您不希望重新加载整个页面，则必须查看资源阶段，您可以在该阶段处理 AJAX 调用并提供各种不同的资源，而不是 portlet 旨在提供的通常页面片段。

# mysql - 在 mysql 语句中使用 ORDER BY 并对结果进行分组

> ID：11330971
> 
> 赞同：1
> 
> 时间：2012-07-04T14:24:49.000
> 
> 标签：mysql, sql

我正在对一组用户进行查询，这些用户返回特定半径内的用户。用户属于 3 个不同类型的用户组中的 1 个。我需要通过显示来自第 1 组的用户（按距离排序）然后组合来自第 2 组和第 3 组的用户（按距离排序）来对返回列表进行排序。我可以轻松地使用 ORDER BY 子句，但我不知道如何确保第 2 组和第 3 组在结果中组合在一起。

以下语句首先按组 1、2、3 返回用户，并按这些组内的距离排序。我需要返回第 1 组，然后是 2&3，按距离排序。

另外我不确定我是否正确使用了 INNER JOIN，这应该是 LEFT JOIN 吗？

```
SELECT
  SQL_CALC_FOUND_ROWS 
  a.*, 
  b.group_id,
  ROUND(( 3959 * acos( cos( radians( $lat ) ) * cos( radians( a.latitude ) ) * cos( radians( a.longitude ) - radians( $lon ) ) + sin( radians( $lat ) ) * sin( radians( a.latitude ) ) ) ), 1) AS distance
FROM `users` AS a
INNER JOIN `user_group_map` AS b
  ON a.`id` = b.`user_id`
HAVING distance <= $radius
ORDER BY
  b.`group_id` DESC,
  distance ASC 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T14:37:44.823

您可以使用 an`ORDER BY CASE`首先有条件地应用命令强制组 1。我认为这应该做的工作：

```
ORDER BY
  CASE WHEN b.group_id = 1 THEN 0 ELSE 1 END,
  distance ASC 
```

该语句为 的任何其他值`CASE`返回 0和 1 。0 在 1 之前排序，然后这两个子组（0 和 1）按2 和 3 排序在一起。`group_id = 1``group_id``distance ASC``group_id`

# c# - 捕获异常并保持 GUI 逻辑独立

> ID：11330972
> 
> 赞同：1
> 
> 时间：2012-07-04T14:24:55.210
> 
> 标签：c#, .net, exception, exception-handling

在这种情况下，您将如何纠正处理异常的方法？最初，我希望以以下方式使用 trycatch 会在上传失败时捕获助手类抛出的异常。

我的目标是返回“false”并打开一个带有错误消息的消息框，我将从我的上传尝试中提取 HTML 响应。我试图在不采取不良做法并将 GUI 代码放入我的帮助程序类的情况下做到这一点。

```
 try
        {
            // returns bool
            successful = UploadHelper.Upload(uploadToPath, File.ReadAllBytes(uploadFromPath), properties);
        }
        catch (Exception ex)
        {
            string error = ex.Message;
        } 
```

助手类：

```
 public static bool Upload(string webUrl, string documentName, byte[] bytes, Dictionary<string, object> metaInfo, out string result)
    {
        try
        {
            using (WebClient webClient = new WebClient())
            {
                //result is HTML string containing data
                result = Encoding.UTF8.GetString(webClient.UploadData(webUrl + "/_vti_bin/_vti_aut/author.dll", "POST", data.ToArray()));

                // if fails throw exception
                if (result.IndexOf("\n<p>message=successfully") < 0)
                    throw new Exception(result);
            }
        }
        catch (Exception ex)
        {
            result = ex.Message;

            // Upload failed
            return false;
        }
        // Upload succeeded
        return true;
    } 
```

[这个稍微相似的问题](https://stackoverflow.com/questions/7719241/ever-ok-to-return-an-exception)让我想到我可以通过自定义异常来解决这个问题。然而，阅读[创建它们的解释让](http://blog.gurock.com/articles/creating-custom-exceptions-in-dotnet)我对如何使用它们来解决这种情况感到困惑——因为这似乎只会将 Messagebox 代码移动到 Exception 类，这也不是一个好地方。

我相当确定这是我有理由使用自定义异常的情况，因为用户可能能够根据返回的错误消息解决问题。因此，无论如何我都是从上述指南中编写的（为简单起见，代码示例中省略了）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-04T14:27:17.880

如果您只是要在 UI 中显示异常的消息，而您`catch`在这里的块只是为了获取消息，那么为什么要在这里捕获它呢？如果处理在 UI 中，则将其捕捉到那里（或更靠近那里），然后在该级别抓取并显示消息。

在这种情况下，您通常会使用异常处理来获取特定异常并从中提取信息以以特定方式报告（将错误消息抽象为下面的 Charleh 评论），或者驱动某种自动重试逻辑。但是，`Upload`如果上传失败，则称为抛出异常的方法绝对没有错。

# html - 超链接和有效的 W3C 标记

> ID：11330973
> 
> 赞同：1
> 
> 时间：2012-07-04T14:25:02.013
> 
> 标签：html, css, w3c

我的文档在使用 W3C 验证器时出现了一些错误，因为我的一些`<a>`标签具有“名称”属性。它说“名称”属性已过时。何时以及为什么会发生这种情况？？？

其次，我在`rel="something"`使用某些 jQuery 函数时使用了一些链接。这也会导致验证错误，因为“rel”标签不是“有效的”。

因此，以下链接将引发两个验证错误：

```
<a href="index.php" name="somename" rel="reltag">Link</a> 
```

我的问题是，这是我应该关心的事情，还是验证者在这种情况下过于挑剔？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-04T14:30:34.050

> 它说“名称”属性已过时。何时以及为何发生这种情况？

HTML 4（大约在 1998 年）引入了一个通用属性，它完成了元素上的属性`id`所做的一切（除了在 Netscape 4 中的工作），但不限于元素。XHTML 1.1在.`name``<a>``<a>``name``<a>`

> “rel”标签不是“有效的”

坦率地说， HTML 5 规范草案`rel`是一团糟（它将值限制为规范中的值……以及 wiki 中的值）。但是，我看到的大多数使用 JS 的实例`rel`都错误地使用它（作为存储数据的通用位置，而不是描述当前文档和链接末尾文档之间关系的位置）。改为使用`class`。

# php - Google Chrome iframe 内容以大文本打印

> ID：11330979
> 
> 赞同：1
> 
> 时间：2012-07-04T14:25:26.407
> 
> 标签：php, google-chrome, printing

我正在使用隐藏的 iframe 打印由 php 生成的页面内容，这在 Firefox 中运行良好，直到本周末它在 Chrome 中也一直运行良好，现在在 Chrome 中它打印的文本比 html 设置的要大得多？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T15:58:07.370

[http://code.google.com/p/chromium/issues/detail?id=135563](http://code.google.com/p/chromium/issues/detail?id=135563)

这是一个刚刚在与 Google Chrome 版本 20 一起发布的最新版本的 Webkit 中出现的错误，它必须处理在打印 iframe 时特别​​搞砸的 css。不幸的是，您目前唯一能做的就是直接从查看页面进行打印（iframe 打印不起作用，因此您无法加载要打印的页面），或者让您的用户切换到 Firefox。

希望这可以为您节省我昨天花费大量时间研究这个问题的时间！

# visual-studio-lightswitch - 如何访问灯开关页面上的所有控件

> ID：11330980
> 
> 赞同：0
> 
> 时间：2012-07-04T14:25:29.223
> 
> 标签：visual-studio-lightswitch

我必须对灯开关页面上的每个控件执行常见的验证任务，这样当用户与控件交互时，页面上的另一个控件就会被清除。我不知道如何在不调用的情况下迭代页面上的控件

```
 this.FindControl("MyId") 
```

对于每个单独的控件，然后在 ControlAvailable 上设置一个处理程序，然后获取控件并绑定到正确的事件，以便我可以在页面上的其他位置执行某些操作。

有没有办法循环所有控件并测试 TextBox 类型的存在，而不是寻找必须明确地按名称查找每个控件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T05:10:12.317

试试这个... [http://social.msdn.microsoft.com/Forums/en-US/lightswitch/thread/65b146d3-2bee-44ed-a4e6-e54383627756/](http://social.msdn.microsoft.com/Forums/en-US/lightswitch/thread/65b146d3-2bee-44ed-a4e6-e54383627756/)

干杯，

保罗

# c++ - Kdtree 查找：PBRT 源代码

> ID：11330982
> 
> 赞同：4
> 
> 时间：2012-07-04T14:25:35.070
> 
> 标签：c++, lookup, kdtree, pbrt

我正在尝试使用 pbrt 源代码来实现 kdtree 以查找`n`最近的点。我有一个分布在 3d 空间上的点数组，我需要计算距参考点给定距离内的点数。那么有人可以指导我如何进行吗？基本上，我使用的是与 integrators/photonmap.cpp 中提到的相同的查找过程 (PhotonProcess)。但不知何故，我最终得到了奇怪的结果。这是我正在使用的代码的一小部分。

```
const uint32_t nAbsorptionPhotons = 10;         //photons to be found
PhotonProcess proc(nAbsorptionPhotons,arena.Alloc<ClosePhoton>(nAbsorptionPhotons));
float searchDist = 0.f;
Photon p;
p.p.x = 50;    //just a reference point set arbitrarily to 50
p.p.y = 50;
p.p.z = 50;
searchDist = 0;

while (proc.nFound < nAbsorptionPhotons) {
            float md2 = searchDist;
            AbsorptionMap->Lookup(p.p, proc, md2);
            searchDist += 1.f;

      }    
printf("SearchDistance is %f \n", searchDist); 
```

我没有得到 searchdist 的预期值。欢迎任何提示想法或建议。

# vim - 在 MacVim 中设置 2 种不同大小的字体

> ID：11330984
> 
> 赞同：2
> 
> 时间：2012-07-04T14:25:50.387
> 
> 标签：vim, macvim

我在 Mac OS X 上的 MacVim 中使用 Vim。我在 .gvimrc 中有以下配置：

```
set guifont=Inconsolata:h15 
```

但我想为非 ASCII 符号设置不同的字体和字体大小（因为 Inconsolata 没有俄语符号）。

问题是 Inconsolata id 在视觉上比我想用于俄语字符的 Monaco 小得多。

在 iTerm 2 中，我有以下偏好：

1.  常规字体：15px Inconsolata
2.  非 ASCII 字体：12pt Monaco

我试图使用：

```
set guifont=Inconsolata:h15,Monaco:h12 
```

但是 :h12 部分不起作用（而摩纳哥部分起作用）。有没有办法解决它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-04-01T12:04:20.753

你可以看看`:set guifontset=-*-*-medium-r-normal--16-*-*-*-c-*-*-*`

来自`:h guifontset`：

> 当不为空时，指定要使用的两种（或更多）字体。第一个用于普通英语，第二个用于您的特殊语言。见 |xfontset|

# android - 使用长小数的问题

> ID：11330986
> 
> 赞同：0
> 
> 时间：2012-07-04T14:25:58.777
> 
> 标签：android, android-edittext, textview

当我在 Android 模拟器上运行此代码时，它会显示`2.236328125E-4`而不是`0,00022363224`.

我究竟做错了什么？

```
numri=Double.parseDouble(number2.getText().toString());

kalkulimi=(numri* 0.229);

tv.setText(Double.toString(kalkulimi* 0.0009765625)); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T15:42:46.790

这是由于 Android（以及一般的 java）内部存储数字的方式。如果您追求特定格式，我强烈建议您使用`NumberFormat`：

```
NumberFormat formatter = new DecimalFormat("0,0##########");
tv.setText(formatter.format(kalkulimi* 0.0009765625)); 
```

# c# - 多维数组表示法（object[][] 和 object[,]）之间的区别

> ID：11330990
> 
> 赞同：5
> 
> 时间：2012-07-04T14:26:15.117
> 
> 标签：c#, multidimensional-array

我想知道在 C# 中定义多维数组的两种方法有什么区别。

您可以使用`object[][]`and`object[,]`来处理多维数组。

有功能上的区别吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-04T14:27:33.370

`object[][]`是数组数组的表示法。第二个`object[,]`是二维数组。

主要区别在于第一个可以包含不同长度的“内部”数组，而第二个必须是矩形（例如 4x7）。

例子：

```
int[][] a = new int[] { new int[]{ 1, 2 }, new int[]{ 3, 4, 5, 6, 7 }};
int[,] b = new int[,] { { 1, 2 }, { 3, 4 }, { 5, 6 }, { 7, 8 } }; 
```

[这是官方教程。](http://msdn.microsoft.com/en-us/library/aa288453%28v=vs.71%29.aspx)

# magento - Magento - 显示主要类别

> ID：11330991
> 
> 赞同：2
> 
> 时间：2012-07-04T14:26:20.140
> 
> 标签：magento

我想创建一个自定义导航栏以放入我的 header.phtml 文件中。

为此，我需要所有类别的列表，我希望有一个简单的函数可以调用来获取数组？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T14:33:02.593

以下获取指定类别的子类别，我认为您应该可以从这里开始工作：

```
$layer = Mage::getSingleton('catalog/layer');
$_category = Mage::getModel('catalog/category')->load(3); //this is cat 3, or can use: 
$_category = $layer->getCurrentCategory();
$_categories = $_category->getCollection()
 ->addAttributeToSelect(array('url_key','name','image','all_children','is_anchor','description')) //or whatever fields you want
 ->addAttributeToFilter('is_active', 1)
 ->addIdFilter($_category->getChildren())
 ->setOrder('position', 'ASC')
 ->joinUrlRewrite(); 
```

然后是这样的：

```
<?php foreach ($_categories as $_category): ?> 
```

ETC...

您也可能对。。。有兴趣：

```
$this->htmlEscape($_category->getImageUrl())
$this->htmlEscape($_category->getName())
$_category->getURL() 
```

希望这有助于为您指明正确的方向。显然，`load(3)`可以只是您的根类别。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T15:01:39.673

如果您使用单个商店或将**$_rootCatId**更改为动态，请使用以下代码。

```
 $_rootCatId     = 2;
    $_rootCategory  = Mage::getModel('catalog/category')->load($_rootCatId);
    $_catName       = $_rootCategory->getName();
    if($_rootCategory->hasChildren()) 
    {
        $_collection = Mage::getResourceModel('catalog/category_collection')
                        ->addAttributeToFilter('is_active', 1)
                        ->addAttributeToSort('position', 'asc')
                        ->joinUrlRewrite()
                        ->addIdFilter($_rootCategory->getChildren())
                        ->load();

        foreach($_collection AS $_sub)
        {
            $_subCat    = Mage::getModel('catalog/category')->load($_sub->getId());

            if($_subCat->hasChildren()) 
            {   
                echo '<li class="leve10 nav-'. $_subCat->getId() .'">';
                    echo '<a id="subCatLink">';
                        echo '<span>'. $this->htmlEscape($_subCat->getName()) .'</span>
                        </a>
                 </li>';
                echo '<ul id="subCatUl" class="no-display" style="padding:0px 13px;">';Categories();
                $__collection = Mage::getResourceModel('catalog/category_collection')
                        ->addAttributeToFilter('is_active', 1)
                        ->addAttributeToSort('position', 'asc')
                        ->joinUrlRewrite()
                        ->addIdFilter($_subCat->getChildren())
                        ->load();

                foreach($__collection AS $__sub)
                {
                    $__subCat   = Mage::getModel('catalog/category')->load($__sub->getId());
                    echo '<li class="leve20 nav-'. $__subCat->getId() .'">
                            <a href="'. $this->getCategoryUrl($__subCat) .'">
                             <span>'. $this->htmlEscape($__subCat->getName()) .'</span>
                            </a>
                         </li>';
                }
                echo '</ul>';
            }
            else
            {
                echo '<li class="leve10 nav-'. $_subCat->getId() .'">
                    <a href="'. $this->getCategoryUrl($_subCat) .'">
                     <span>'. $this->htmlEscape($_subCat->getName()) .'</span>
                    </a>
                 </li>';
            }
        }
    }
    else
        echo 'No Categories Found...'; 
```

# coldfusion - 如何用 CR+LF 替换 ？

> ID：11330993
> 
> 赞同：11
> 
> 时间：2012-07-04T14:26:27.270
> 
> 标签：coldfusion, textarea, newline

例如：

用户提交带有 a 的表单并在其中`<textarea name="mytext" cols="35" rows="2"></textarea>`按下`ENTER`。如何用 CR-LF 替换 CR-LF `<br />`？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-07-04T14:33:52.193

CF 有一个名为 ParagraphFormat() 的函数：

```
<cfset form.userText = paragraphFormat(form.usertext)/> 
```

从帮助文档 -

替换字符串中的字符：

*   带空格的单个换行符（CR/LF 序列）
*   带有 HTML 段落标签的双换行符 ( `<p>`)

它可能比您想要的*更多*，因为它还查找双换行符并添加`<p>`和`</p>`标记。

Ben 还有一个增强版本（UDF），称为paragraph2，它很容易修改以获得您想要的确切效果。这是链接：

[http://www.cflib.org/udf/ParagraphFormat2](http://www.cflib.org/udf/ParagraphFormat2)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-07-04T14:47:11.613

`<cfset localVars.ReturnString = REReplace(localVars.ReturnString, "\r\n|\n\r|\n|\r", "<br />", "all")>`

您不应该`\n\r`自然击中，但如果它是由忘记正确顺序的开发人员插入的，则可能会发生。

这是一个更通用的函数的子集，用于根据您正在做的事情用其他内容替换行尾 (EOL) 字符（例如，必须以 Windows/Linux 格式、.ics 文件、html、cfheaders 等写出）

```
<cffunction name="ReplaceEOL" access="public" output="false" returntype="string" hint="Replaces EOL codes with other characters">
    <cfargument name="String" required="true" type="string">
    <cfargument name="ReplaceWith" required="true" type="string">

    <cfreturn REReplace(Arguments.String, "\r\n|\n\r|\n|\r", Arguments.ReplaceWith, "all")>
</cffunction> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-04T14:34:01.407

在显示值时，我不会使用 br 替换它，而是使用[ParagraphFormat](http://livedocs.adobe.com/coldfusion/8/htmldocs/help.html?content=functions_m-r_09.html)函数。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-05T23:23:55.017

您可以使用 paragraphFormat() 函数，但有时替换函数可以帮助您可视化实际发生的情况。

一个例子：`<cfset TheText=replace("#form.myText#",chr(13)&chr(10),"<br />","all")>`

这将所有回车换行符替换为 html 换行符

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-04-02T20:01:16.090

我实际上更喜欢这样的东西：

```
<p>#REReplace(theParagraphText, "[#chr(10)#]+", "</p><p>", "ALL")#</p> 
```

因为它将多个换行符组合成一个分段符。

# struts - Struts 2 和 Websockets

> ID：11330995
> 
> 赞同：0
> 
> 时间：2012-07-04T14:26:32.400
> 
> 标签：struts, websocket

是否可以让 Struts 与 Websockets 一起工作？在 .NET 方面，有 SignalR。我一直在阅读有关 Comet、jWebSocket 的信息，但它们可以与 Struts 集成吗？或者是否需要从头开始构建应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T04:07:58.280

[JSR 356](http://jcp.org/en/jsr/detail?id=356)，用于 WebSocket 的 Java API，即将推出...

直到它到来 - 有几个供应商在 Java 中提供 WebSocket API。[Kaazing](http://kaazing.com)（我工作的公司）也支持 JMS 进行消息传递。[这](http://demo.kaazing.com/demo/jms/java/)是您可以试用的实时托管演示。

# javascript - jquery 函数不适用于通过 innerHTML 编写的元素

> ID：11330996
> 
> 赞同：2
> 
> 时间：2012-07-04T14:26:36.647
> 
> 标签：javascript, jquery, innerhtml

我有一些这样的 jQuery 代码：

```
$(function($) {
$('input.autonumeric').autoNumeric({aSep: ',', aDec: '.',vMax:'1000000000000'}); }); 
```

使用该代码，每个具有`autonumeric`-class 的输入文本只能输入数字。

但是当我从 写输入文本标签时`innerHTML`，它根本不起作用。这就是我编写代码的方式：

```
function edit(){
  var current = window.event.srcElement;
  while ( (current = current.parentElement) && current.tagName !="TR");
  var row = current.childNodes;
  td = row.item(0); var temp = td.innerHTML;
  td.innerHTML = "<input type=\"text\" value=\""+temp+"\" class=\"autonumeric\" \>";
} 
```

我该如何解决这个代码？注意：如果我的英语不够好，我很抱歉。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T14:33:11.967

您还必须为新添加的元素运行 autoNumeric。您可以在创建新输入时这样做：

```
$(td).html($("<input type=\"text\" value=\""+temp+"\" class=\"autonumeric\" \>").autoNumeric({'....'})); 
```

或离开您的版本并运行

```
$('input.autonumeric').autoNumeric({aSep: ',', aDec: '.',vMax:'1000000000000'}); }); 
```

之后再次。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T14:30:44.923

既然您已经在使用 jQuery，为什么不使用 jQuery 创建元素呢？

```
var e = $('<input type="text" />');
e.autoNumeric({aSep: ',', aDec: '.',vMax:'1000000000000'}); });
td.html(e); 
```

当然，您需要调整代码的其他部分以确保 td 是一个 jQuery 对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T14:31:03.007

运行jQuery 插件方法时，它会影响DOM 中*当前存在*`.autoNumeric(...)`的所有输入字段。当被调用并创建一个新的时，您必须再次调用。*`edit()``input.autonumeric``.autonumeric(...)`*

 ** * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-04T14:32:21.227

添加 innerHTML 后，您应该再次调用您的 autoNumeric 函数。这是因为页面加载时执行的代码只能“看到”页面加载时 DOM 中存在的元素。添加元素后，您必须将事件附加到它。*

# datamapper - 未存储在数据库中的 DataMapper 假属性

> ID：11330998
> 
> 赞同：0
> 
> 时间：2012-07-04T14:26:39.463
> 
> 标签：datamapper

是否可以在 DataMapper 模型中设置可以称为“假属性”的东西？我的意思是，一个没有持久化的属性，但仍然可以使用 create() 或 update() 进行修改。不是将数据持久化在数据存储中，而是使用该值调用一个函数。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T20:30:23.620

事实证明 create() 和 update() 只不过是`self.property = value`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T13:44:05.997

在您的模型中使用`attr_accessor`如下：

```
class Account
  include DataMapper::Resource
  attr_accessor :password
end 
```

该方法在这里解释了[什么是datamapper中的attr_accessor - ruby](https://stackoverflow.com/questions/9315648/what-is-attr-accessor-in-datamapper-ruby)