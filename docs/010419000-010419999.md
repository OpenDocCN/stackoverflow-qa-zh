# StackOverflow 问答 10419000-10419999

# c - 使用 omp 减少嵌套循环

> ID：10419000
> 
> 赞同：1
> 
> 时间：2012-05-02T17:47:06.810
> 
> 标签：c, nested, parallel-processing, openmp

我无法并行化嵌套的 for 循环。代码看起来像这样

```
 for( k = 0; k < m; k++ ) {
    for( i = 0; i < k; i++ ) {
      s = 0.0;
#pragma omp parallel for default(none) shared(i, k, q, m, n) private(j) reduction(+:s)
      for( j = 0; j < n; j++ ) {
        s += q[ i ][ j ] * q[ k ][ j ];
      }
    }
  } 
```

由于在“k”和“i”循环下多次创建和销毁线程时的开销，这段代码可以工作，但运行速度非常慢。

理想情况下我想要这样的东西

```
#pragma omp parallel default(none) shared(i, k, q, m, n, s) private(j)
  for( k = 0; k < m; k++ ) {
    for( i = 0; i < k; i++ ) {
      s = 0.0;
#pragma omp for reduction(+:s)
      for( j = 0; j < n; j++ ) {
        s += q[ i ][ j ] * q[ k ][ j ];
      }
    }
  } 
```

并行区域仅创建一次。但是，我得到的结果不正确。我认为这是因为变量 's' 是共享的。

有没有办法让's'共享并仍然执行减少？

谢谢！

PS 我不能并行化“k”或“i”循环，因为它们依赖于以前的迭代。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T10:38:17.247

只是我还是循环中`i`是否有一部分代码被您省略了？由于该代码只计算了许多点积，但最后只有 和 的点积`q[m-1][]`存储`q[m-2][]`在`s`. 同样如给定的那样，您的代码在循环迭代之间没有数据依赖关系，但如果您使用静态调度并行化另一个循环，则宁愿表现出负载不平衡。您可以使用动态调度在某种程度上反驳这一点：

```
#pragma omp parallel default(none) shared(q, m, n) \
            private(i, k, j) lastprivate(s) schedule(dynamic,1)
for( k = 0; k < m; k++ ) {
  for( i = 0; i < k; i++ ) {
    s = 0.0;
    for( j = 0; j < n; j++ ) {
      s += q[ i ][ j ] * q[ k ][ j ];
    }
  }
} 
```

如果您的编译器支持 3.0 或更高版本的标准，您也可以尝试使用 OpenMP 任务。

@Zhenya，如果 j 循环是最外层的，那么缓存的好处将丢失，因为在 C/C++ 中的内存`q[i][j]`中`q[i+1][j]`不相邻。

# javascript - HTML/Javascript 从 img src 属性中删除数据

> ID：10419005
> 
> 赞同：11
> 
> 时间：2012-05-02T17:47:29.130
> 
> 标签：javascript, html, image

我的页面中有一个空的 img`<img ... src=""/>`

当事件发生时，我将 img 属性设置为内联 png 数据：

`<img ... src="data:image/png;base64,..."/>`

**当另一个事件发生时，我**将 src 设置为空（删除 img）：`myImg.src = ""`

问题是：当我将 src 设置为空时，img 不会重新加载。如果我隐藏了 img，请等待一段时间并再次显示它，但它是一个丑陋的黑客......

PS：我不想设置默认的“空白”图像，我需要它真的是空白的（src =“”）。

编辑：我的 javascript：

```
biometria.setImage = function(png) {
    if(png)
        bioCanvas.src = 'data:image/png;base64,' + png;
    else
        bioCanvas.src = '';
}; 
```

Edit2：浏览器：谷歌浏览器 18.0.1025.162 Ubuntu 12.04

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2015-09-13T07:01:49.323

我通过打击代码来处理这个问题并为我工作：

```
document.getElementById('tst').removeAttribute('src'); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-05-02T18:19:51.693

从技术上讲，图像标签必须具有 src 属性并且它不应该为空。但是，[W3C 规范](http://www.w3.org/TR/html4/struct/objects.html#h-13.2)并不清楚如何处理 src 属性为空的情况。因此，每个浏览器处理这种情况的方式都略有不同。

实际上，由于缺乏规范可能会引起很多问题，您的问题只是其中之一。可以在[此处](http://www.nczonline.net/blog/2009/11/30/empty-image-src-can-destroy-your-site/)找到有关此问题的更详细信息。

正如其他人指出的那样，通过 CSS 隐藏/显示图像更为可取（如果您想保持空间占用，则可以使用可见性：无，如果您希望图像完全消失，则可以使用显示：无）。或者，您可以简单地使用 JS 删除完整的图像标签，并在您想要插入时创建一个新图像。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-10T19:00:59.883

我建议您将图像替换为新图像。在 jQuery 中，您可以执行以下操作：

```
$('#yourImage').replaceWith('&lt;img src="" id="yourImage" /&gt;'); 
```

# android - 读取 NFC 标签的内容

> ID：10419009
> 
> 赞同：1
> 
> 时间：2012-05-02T17:47:41.763
> 
> 标签：android, tags, nfc

我正在尝试读取三星 Galaxy Nexus S 上的 NFC 标签。

```
 @Override
protected void onResume() {
    super.onResume();
    String nachricht = "";
    if (NfcAdapter.ACTION_NDEF_DISCOVERED.equals(getIntent().getAction())) {
        Parcelable[] rawMsgs = getIntent()
                .getParcelableArrayExtra(NfcAdapter.EXTRA_NDEF_MESSAGES);
        if (rawMsgs != null) {
            NdefMessage[] msgs = new NdefMessage[rawMsgs.length];
            for (int i = 0; i < rawMsgs.length; i++) {
                msgs[i] = (NdefMessage) rawMsgs[i];
                nachricht = nachricht + " " + msgs;
            }

            Log.e("WriteTagApp", nachricht );
        }
    }

} 
```

使用 Log.e("WriteTagApp", nachricht ); 我的应用程序将标签的消息写入调试器。它看起来像这样：[Landroid.nfc.NdefMessage;@4184ce18

我似乎无法理解这里发生了什么以及如何获取消息的实际内容。我怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T18:15:58.357

NDefMessage 不是一个字符串，它是一个对象。通过连接它，您只需添加其“toString”方法的输出。相反，您需要查看[NdefMessage](http://developer.android.com/reference/android/nfc/NdefRecord.html)中的 NdefRecords 并从其中的有效负载字段中提取数据。

# tomcat - 尝试从我办公室网络中的另一台计算机访问 tomcat 时出现问题

> ID：10419015
> 
> 赞同：2
> 
> 时间：2012-05-02T17:47:52.420
> 
> 标签：tomcat

我在尝试从办公室网络中的另一台计算机访问我的 tomcat 安装时遇到问题。

我已经通过互联网（甚至在 Stack 上）阅读过有关此问题的信息，但我仍然没有找到解决方案。从另一台计算机（我们称之为计算机 B）我正在尝试使用[http://ComputerA:8080](http://ComputerA:8080)访问。我已经检查过防火墙没有阻止该端口，实际上，只是为了进行测试，我已经将 WAMP 服务器的安装指向该端口，并且我可以从计算机 B 访问，所以看起来不是端口问题（或被防火墙阻止）。

奇怪的是，我从 B 到 A 进行了 ping，但没有响应，即使我实际上连接到指向端口 8080 的 WAMP。似乎这是 Tomcat 的问题。

所以，我已经尝试了几个小时，但我不知道如何解决我的问题。

你的任何帮助都会很棒。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T19:35:24.557

我要尝试的第一件事是尝试使用 URL 从机器本身访问该站点：

```
http://ComputerA:8080 
```

您可能只有 Tomcat 在环回上侦听（这在 server.xml 中控制，[请参阅](https://cgsrv1.arrc.csiro.au/blog/2009/07/10/tomcat-listen-only-on-localhost/)）

由于 Windows 防火墙经常提供或阻止基于应用程序的访问，而不仅仅是端口，因此您使用 WAMP 进行的测试可能并不完美，但它是一个不错的测试。更好的测试是暂时完全禁用防火墙：

例如，作为管理员命令外壳运行以下命令：

```
netsh firewall set opmode mode = disable 
```

假设以上都没有让你看到发生了什么，那么我会尝试主机的 IP 地址而不是名称。如果 WINS 名称解析不正确，我希望您的 WAMP 测试失败，但使用 IP 至少可以解决一些其他可能的问题。

# mysql - 如何通过将表与其他 5 个表连接来更新表中的列？

> ID：10419016
> 
> 赞同：1
> 
> 时间：2012-05-02T17:47:57.970
> 
> 标签：mysql, sql

我想更新一个只有两个字段 test_set_id 和 plan_id 的表，我可以从这个查询中轻松获得

```
SELECT      tp.plan_id
        ,   r.release_id
FROM        test_plan tp
        ,   releases r
        ,   test_run tr
        ,   iteration i
WHERE       tr.iteration_id = i.iteration_id
AND         i.release_id    = r.release_id
AND         tr.plan_id      = tp.plan_id
AND         i.release_id    = 1
GROUP BY    plan_id 
```

但是当我运行以下查询时，它给了我一个 sql 错误。

```
UPDATE  test_set_relation
SET     test_set_id
    ,   plan_id=
        (   SELECT      tp.plan_id
                    ,   r.release_id
            FROM        test_plan tp
                    ,   releases r
                    ,   test_run tr
                    ,   iteration i
            WHERE       tr.iteration_id = i.iteration_id
            AND         i.release_id    = r.release_id
            AND         tr.plan_id      = tp.plan_id
            AND         i.release_id    = 1
            GROUP BY    plan_id
        ) 
```

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T17:50:44.727

您不能像在 SET 中那样分配多个字段值。

```
SET test_set_id,plan_id=(SELECT tp.plan_id,r.release_id 
```

这将引发错误`Incorrect syntax near ','.` *（此错误消息来自 SQL Server）* ，因为查询应该在列名旁边有一个赋值运算符**= 。**

您的查询应该沿着这条线制定。如果不知道表的结构，就不可能制定有效的*UPDATE*语句。

*用法*：*`SQL Server`语法*

```
UPDATE      t1
SET         t1.col2 = t2.col2
        ,   t1.col3 = t2.col3
FROM        table1 t1
INNER JOIN  table2 t2
ON          t1.col1 = t2.col1 
```

*用法*：*`MySQL`语法*

```
UPDATE      table t1
JOIN
SET         t1.col2 = t2.col2
        ,   t1.col3 = t2.col3
INNER JOIN  table2 t2
ON          t1.col1 = t2.col1 
```

# java - 如何给一个人增加更多的爱好

> ID：10419024
> 
> 赞同：-3
> 
> 时间：2012-05-02T17:48:31.310
> 
> 标签：java, file

我需要从文件中显示一个人的更多爱好，但我不知道该怎么做。我需要的是这样的：`Stan Ilie : baschet, programare`

我的代码在这里：

```
import java.io.*;
import java.util.*;

public class ListaHobby
{
    String line = "";
    Hobby h, h1;
    Persoana p;
    BufferedWriter bw = null;
    ArrayList<Persoana> listOfPersons;
    ArrayList<Hobby> listOfHobbies;

    public void writeListaHobbies()
    {
        try
        {
            listOfPersons = new ArrayList<Persoana>();
            FileReader file1 = new FileReader("Persoane.txt");

            listOfHobbies = new ArrayList<Hobby>();
            FileReader file2 = new FileReader("Hobby.txt");

            BufferedReader br1 = new BufferedReader(file1);
            BufferedReader br2 = new BufferedReader(file2);
            String line1 = "";
            String line2 = "";

            while ((line1 = br1.readLine()) != null)
            {
                if (!line1.trim().contains("ID"))
                {
                    String[] attributes = line1.split(";"); // split it at every ";"

                    p = new Persoana(); // make a new person
                    p.setId(Integer.parseInt(attributes[0]));
                    p.setNume(attributes[1]);
                    p.setPrenume(attributes[2]);
                    p.setDataNasterii(attributes[3]);
                    p.setProfesie(attributes[4]);

                    listOfPersons.add(p);
                }
            }

            while ((line2 = br2.readLine()) != null)
            {
                if (!line2.trim().contains("ID"))
                {
                    String[] attributes = line2.split(";"); // split it at every ";"

                    h = new Hobby(); // make a new hobby
                    h.setId(Integer.parseInt(attributes[0]));
                    h.setNume(attributes[1]);
                    h.setDescriere(attributes[2]);
                    h.setNrPers(Integer.parseInt(attributes[3]));
                    h.setElemNecesar(attributes[4]);

                    listOfHobbies.add(h);
                }
            }

            FileWriter fw = new FileWriter("PersHobby.txt");
            bw = new BufferedWriter(fw);

            for (Persoana p : listOfPersons)
            {
                for (Hobby h : listOfHobbies)
                {
                    String s = p.getNume() + " " + p.getPrenume() + ": ";

                    String s1 = h.getNume();

                    System.out.print(s);
                    System.out.println(s1);

                    bw.write(s);
                    bw.append(s1);
                    bw.newLine();
                }
            }

            bw.close();
        }
        catch (IOException ex)
        {
            System.out.println("Error opening file.");
            System.exit(1);
        }
    }
} 
```

我的输出是这样的：

```
 Stan Ilie: baschet
  Stan Ilie: fotbal
  Stan Ilie: chitara
  Stan Ilie: pianul
  Stan Ilie: programarea
  Becali GG: baschet
  Becali GG: fotbal
  Becali GG: chitara
  Becali GG: pianul
  Becali GG: programarea ..... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T18:19:43.913

因为这被标记为作业，我不想给你解决方案，但我给你一个提示：

问题是每次阅读爱好时都会在输出文件中写入一行。您必须创建一个包含与一个人相关的所有爱好的字符串，然后您可以将此字符串写入文件。

伪代码：

```
foreach Person p {
   String currentPerson = p.getNume() + " " + p.getPrenume() + ": ";

   foreach Hobby h {
      currentPerson += h.getNume() + ",";
   }

   Write currentPerson to file and print currentPerson to console
} 
```

# java - 给定一百万个单词的列表，找到单词的编辑距离的最快方法

> ID：10419027
> 
> 赞同：1
> 
> 时间：2012-05-02T17:48:46.630
> 
> 标签：java, algorithm, dictionary

我有一个超过一百万字的文件，每行一个字。我正在尝试编写代码，如果给我一个单词，我需要找出该单词是否存在于文件中。这里的问题是，每个单词都必须检查`26^(word.length()-1)`多次。因此，遍历文件中的每个单词并不是一个好的解决方案。我尝试在网上查找算法，但还没有找到任何明显的答案。

**编辑** 我已经考虑过 a`HashMap`和`Trie`. 这里的实际问题是说我有这个词`abc`。现在，我的任务是在 word 中添加、删除或替换一个字母`abc`以创建单词 X，然后检查 X 是否在文件中。因此，对于哪种解决方案可能是更好的方法感到困惑。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-02T17:49:37.197

您可以从文件中的单词构建一个[trie](http://en.wikipedia.org/wiki/Trie)。这将比 Hashset 使用更少的内存，并允许您检查 O（单词中的字符数）中单词的存在。如果不关心内存，当然可以使用 Hashset（因为它内置了它也少得多的努力）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-02T17:50:39.173

将单词存储在内存中的 HashSet 中，您将进行 O(1) 次查找。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-02T18:11:26.047

假设您的单词是“cad”，并且您正在寻找编辑距离为 1 内的所有单词。

在这种情况下，您可以执行以下操作。

1）将字典单词存储在HashMap中。2）生成编辑距离为1到“cad”的所有单词组合。3) 对于这些单词中的每一个，测试该单词是否存在于 HashMap 中。

您的搜索应该匹配“爸爸”、“猫”、“汽车”、“小伙子”等词。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-02T17:50:28.850

当您在文件中读取包含单词的文件时，我将构建一个哈希表。您应该能够检查一个单词是否在恒定时间内出现。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-02T17:53:34.153

HashMap 是要走的路。只需将所有单词存储在 HashMap 中，然后查找地图以查看您的单词是否存在。当然，这仅在您想要多次查找时才有用。

更实用的解决方案是将 HashMap 写入磁盘并在下次运行应用程序时将其加载到内存中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-02T18:01:08.557

tabla hast 是更快的方法

```
FileInputStream inputStream = new FileInputStream("input.txt");
InputStreamReader streamReader = new InputStreamReader(inputStream, "UTF-8");
BufferedReader in = new BufferedReader(streamReader);
Map<String, Integer> map = new HashMap<String, Integer>();
for (String s; (s = in.readLine()) != null;) {
   ...
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-02T18:20:29.727

另一种解决方案是使用[Bloom Filter](http://en.wikipedia.org/wiki/Bloom_filter)。一种非常快速且节省空间的数据结构，用于检查元素是否是集合的成员。缺点是它是一种概率数据结构，这意味着可能出现误报。

它通过具有 m 位的数组来工作。当向过滤器添加一个词时，该词被馈送到 k 个不同的散列函数中，在这些散列计算的位置处将位设置为 1。查询过滤器时，将单词提供给相同的散列并检查这些位是否设置在这些位置。如果这些位中的任何一个为 0，则可以确定该单词在集合中不存在，如果全部为 1，则需要进行查找，因为在将其他单词散列到相同位置时，这些位可能已设置。

# google-maps - 位置名称到地址与谷歌地图？

> ID：10419028
> 
> 赞同：0
> 
> 时间：2012-05-02T17:48:57.987
> 
> 标签：google-maps

我有一个地点列表（主要是酒吧），我正在尝试获取
这些地点的地址，我尝试使用

```
http://maps.google.com/maps/geo?q=PLACE_NAME&output=xml&oe=utf8&key=abcdefg 
```

失败得很惨，要么不够具体，
要么我只是得到了城市的大致坐标。

有任何想法吗？
如果有必要，我愿意使用替代服务（如果免费）。

# android-ndk - 在 jni main.cpp ( cocos2d-x) 中访问运行场景

> ID：10419030
> 
> 赞同：2
> 
> 时间：2012-05-02T17:49:03.850
> 
> 标签：android-ndk, cocos2d-x

我想在 jni main.cpp 中访问我的场景，但是当我打电话时`cocos2d::CCDirector::sharedDirector()->getRunningScene()`我无法得到它！我的代码：

```
void Java_tehrannama_test_tehrannama2_zoomIn(JNIEnv* env, jobject thiz,jfloat s) {

__android_log_print(ANDROID_LOG_DEBUG, "zoom1", "zooom");
    HelloWorld* helloworld = dynamic_cast&lt;HelloWorld*&gt;(cocos2d::CCDirector::sharedDirector()->getRunningScene());
    helloworld->zoomin(s);
    helloworld->center.x = helloworld->center.x -10000;
} 
```

除了helloworld，我没有其他场景。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T07:26:17.980

我发现问题实际上是我的错误！我的 helloworld 层添加为当前场景的子级，解决方案是在添加时标记 helloworld，然后得到它：

```
HelloWorld* helloworld = dynamic_cast<HelloWorld*>(cocos2d::CCDirector::sharedDirector()->getRunningScene()->getChildByTag(1)); 
```

# sencha-touch - 在 ST2 应用程序中添加子文件夹

> ID：10419037
> 
> 赞同：0
> 
> 时间：2012-05-02T17:49:35.730
> 
> 标签：sencha-touch, extjs, sencha-touch-2, cordova

在将 Sencha Touch 2 文件复制到 Cordova 时，我使用以下命令创建生产版本；

```
sencha app build production ../App/MyAppProj/www/ 
```

当我执行这个命令时，ST2 项目中的所有文件都被添加到 WWW 目录中，而不是文件夹和包含在这些文件夹中的文件。

我应该如何添加这些位于 ST2 应用程序子文件夹中的文件

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T18:11:00.907

使用 SDK 构建应用程序后，您将不再需要您的 app 文件夹。SDK 将生成一个缩小（或非缩小）的 js 文件，其中包含您在 app 文件夹中创建的所有视图、控制器、存储和模型。

我建议您阅读有关[Builds](http://docs.sencha.com/touch/2-0/#!/guide/building)的文档。准备好部署应用后，您需要修改 HTML 文件以指向 sencha-touch.js。在开发过程中，您通常会指向 sencha-touch-debug.js。

使用 SDK 构建应用程序后。您将在 HTML 中拥有 sencha touch 库和 app.js（或任何您命名的名称）的生产版本。在生产环境中将不需要 app 文件夹、src 文件夹等。

# xcode - SQLite3 在 xcode 4.3.2 中出现错误

> ID：10419042
> 
> 赞同：7
> 
> 时间：2012-05-02T17:49:48.173
> 
> 标签：xcode, sqlite

我的应用程序在带有 Xcode 4.2 的 Snow Leopard 上完美运行。构建时没有错误，并且可以毫无问题地使用 SQL 数据库运行。我升级到 Lion 和 Xcode 4.3.2，当我构建时，我的 #import "/usr/include/sqlite3.h" 代码行中出现“/usr/include/sqlite3.h file not found”错误。其他人有这个问题或有什么建议吗？我尝试从项目导航器中删除 libsqlite3.dylib，然后通过 Link Binary With Libraries 中的 Build Phases 选项卡中的 + 号将其添加回来，但错误仍然存​​在。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-06T17:16:30.303

从`Snow Leopard`to`Lion`和`Xcode 4.2`to更新时`Xcode 4.5`，您将收到错误：“'/usr/include/sqlite3.h' 文件未找到”。

解决方案：

*   添加库：`"libsqlite3.0.dylib"`在`Target > Build Phases`

*   在您的代码中更改`#import "/usr/include/sqlite3.h"`为`#import "sqlite.h"`

* * *

**更新作者的帖子：**不是`#import "sqlite.h"`. 这是：`#import <sqlite3.h>`

* * *

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T18:40:01.093

我认为您的问题是您需要将 SQLite 3.0 框架包含到您的项目中。

如果您不知道如何添加框架，请参考这个问题： [如何在 Xcode 4 中“添加现有框架”？](https://stackoverflow.com/questions/3352664/how-to-add-existing-frameworks-in-xcode-4)

你想要的框架是 libsqlite3.0.dylib

希望这可以帮助！

# xml - 在jsp中显示xml

> ID：10419044
> 
> 赞同：2
> 
> 时间：2012-05-02T17:49:51.857
> 
> 标签：xml, jsp

我试图在 jsp 页面上显示一个包含 xml 格式的 xml 数据的字符串。我不想解析 xml，只想在浏览器上显示 xml 数据。

有人能帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-02T19:53:20.113

```
 <pre>
   <c:out value="${xmlString}" />
 </pre> 
```

这将漂亮地打印xml

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-02T17:54:34.940

```
<c:out value="${theXmlString}"/> 
```

如果要保留换行符，请使用 pre 标记：

```
<pre><c:out value="${theXmlString}"/></pre> 
```

# c# - 绑定到 RelativeSource TemplatedParent 在 ControlTemplate 中不起作用

> ID：10419048
> 
> 赞同：1
> 
> 时间：2012-05-02T17:50:06.020
> 
> 标签：c#, xaml, windows-8, windows-runtime, winrt-xaml

我正在尝试将 Silverlight 应用程序移植到 Metro，并发现在我的 ControlTemplate 设置中我的绑定`{Binding PropertyName, RelativeSource={RelativeSource TemplatedParent}}`似乎不起作用，但`{TemplateBinding PropertyName}`确实如此。

这两个都在我的 Silverlight 应用程序中工作，但是我需要使用 RelativeSource 语法来允许使用`Mode=TwoWay`.

我需要做什么才能在 ControlTemplate 中使用 TwoWay 绑定？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T20:12:31.437

如果您正在构建自己的控件 - 您可以定义模板部分并通过在 OnApplyTemplate() 覆盖中调用 GetTemplateChild() 来检索它们 - 然后只需手动更新属性而不是依赖绑定。如果您只是重新模板化现有控件 - 也许您可以先将它们子类化或创建附加的依赖属性/[行为](http://winrtbehaviors.codeplex.com/)来处理绑定。

# dojo - dijit.layout.bordercontainer 隐藏所有内部内容

> ID：10419050
> 
> 赞同：1
> 
> 时间：2012-05-02T17:50:12.760
> 
> 标签：dojo, dijit.layout

我很难理解新版本的 1.7.1 dojo 工具包并返回到 1.5 版本。我正在尝试包含边界容器来布局我的控件以匹配其中一个演示，但边界容器总是把事情搞砸。

[http://download.dojotoolkit.org/release-1.6.1/dojo-release-1.6.1/dijit/themes/themeTester.html](http://download.dojotoolkit.org/release-1.6.1/dojo-release-1.6.1/dijit/themes/themeTester.html)

我正在尝试重新创建以下内容，并且创建了菜单部分并执行了accordianContainer，但是如果我包含了bordercontainer，那么出现的只是一条看起来像容器消耗所有东西的线，并且我看不到包括菜单在内的内部组件。任何想法表示赞赏。

```
<body class="claro">
  <form id="form1" runat="server">
  <asp:ScriptManager ID="ToolkitScriptManager1" runat="server">
  </asp:ScriptManager>   
           <div dojoType="dijit.Menu" id="submenu1" data-dojo-props='contextMenuForWindow:true, style:"display:none"' style="display: none;">
                    <div dojoType="dijit.MenuItem">Enabled Item</div>
                    <div dojoType="dijit.MenuItem" data-dojo-props="disabled:true">Disabled Item</div>
                    <div dojoType="dijit.MenuSeparator"></div>
                    <div dojoType="dijit.MenuItem" data-dojo-props="iconClass:'dijitIconCut'">Cut</div>
                    <div dojoType="dijit.MenuItem" data-dojo-props="iconClass:'dijitIconCopy'">Copy</div>
                    <div dojoType="dijit.MenuItem" data-dojo-props="iconClass:'dijitIconPaste'">Paste</div>
                    <div dojoType="dijit.MenuSeparator"></div>
                    <div dojoType="dijit.PopupMenuItem">
                                <span>Enabled Submenu</span>
                    <div dojoType="dijit.Menu" id="submenu2">
                    <div dojoType="dijit.MenuItem">Submenu Item One</div>
                    <div dojoType="dijit.MenuItem">Submenu Item Two</div>
                    <div dojoType="dijit.PopupMenuItem">
                                <span>Deeper Submenu</span>
                    <div dojoType="dijit.Menu" id="submenu4">
                    <div dojoType="dijit.MenuItem">Sub-sub-menu Item One</div>
                    <div dojoType="dijit.MenuItem">Sub-sub-menu Item Two</div>
                    </div>
                </div>
                </div>
                </div>
                <div dojoType="dijit.PopupMenuItem" data-dojo-props="disabled:true">
                        <span>Disabled Submenu</span>
                <div dojoType="dijit.Menu" id="submenu3" style="display: none;">
                <div dojoType="dijit.MenuItem">Submenu Item One</div>
                <div dojoType="dijit.MenuItem">Submenu Item Two</div>
                </div>
                </div>
                <div dojoType="dijit.PopupMenuItem">
                        <span>Different popup</span>
                <div dojoType="dijit.ColorPalette"></div>
                </div>
                <div dojoType="dijit.PopupMenuItem">
                        <span>Different popup</span>
                <div dojoType="dijit.Calendar"></div>
                </div>
                </div>

        <div id="main" dojoType="dijit.layout.BorderContainer" design="sidebar">
           <div id="header" dojoType="dijit.MenuBar" region="top">
                                        <div dojoType="dijit.PopupMenuBarItem" id="edit">
                                                        <span>Edit</span>
                                            <div dojoType="dijit.Menu" id="editMenu">
                                               <div dojoType="dijit.Menu" id="Div1">
                                                        <div dojoType="dijit.MenuItem" id="cut" iconClass="dijitIconCut"
                                                                    onClick="console.log('not actually cutting anything, just a test!')">Cut</div>
                                                        <div dojoType="dijit.MenuItem" id="copy" iconClass="dijitIconCopy"
                                                                    onClick="console.log('not actually copying anything, just a test!')">Copy</div>
                                                        <div dojoType="dijit.MenuItem" id="paste" iconClass="dijitIconPaste"
                                                                    onClick="console.log('not actually pasting anything, just a test!')">Paste</div>
                                                        <div dojoType="dijit.MenuSeparator" id="separator"></div>
                                                        <div dojoType="dijit.MenuItem" id="undo" iconClass="dijitIconUndo">Undo</div>
                                                </div>
                                            </div>
                                        </div>
                                        <div dojoType="dijit.PopupMenuBarItem" id="view">
                                                <span>View</span>
                                            <div dojoType="dijit.Menu" id="viewMenu">
                                            <div dojoType="dijit.MenuItem">Normal</div>
                                            <div dojoType="dijit.MenuItem">Outline</div>
                                            </div>
                                            <div dojoType="dijit.PopupMenuItem">
                                                <span>Zoom</span>
                                            <div dojoType="dijit.Menu" id="zoomMenu">
                                            <div dojoType="dijit.MenuItem">50%</div>
                                            <div dojoType="dijit.MenuItem">75%</div>
                                            <div dojoType="dijit.MenuItem">100%</div>
                                            <div dojoType="dijit.MenuItem">150%</div>
                                            <div dojoType="dijit.MenuItem">200%</div>
                                            </div>
                                            </div>
                                        </div>
                                        <div dojoType="dijit.PopupMenuBarItem" id="themes">
                                                <span>Themes</span>
                                            <div dojoType="dijit.Menu" id="themeMenu"></div>
                                        </div>
                                        <div dojoType="dijit.PopupMenuBarItem" id="dialogs">
                                                <span>Dialogs</span>
                                            <div dojoType="dijit.Menu" id="dialogMenu">
                                            <div dojoType="dijit.MenuItem" data-dojo-props="onClick: showDialog">slow loading</div>
                                            <div dojoType="dijit.MenuItem" data-dojo-props="onClick: showDialogAb">action bar</div>
                                            </div>
                                        </div>
                                        <div dojoType="dijit.PopupMenuBarItem" id="inputPadding">
                                                <span>TextBox Padding</span>
                                            <div dojoType="dijit.Menu" id="inputPaddingMenu">
                                            <div dojoType="dijit.CheckedMenuItem" data-dojo-props="onClick:setTextBoxPadding, checked:true">theme default</div>
                                            <div dojoType="dijit.CheckedMenuItem" data-dojo-props="onClick:setTextBoxPadding">0px</div>
                                            <div dojoType="dijit.CheckedMenuItem" data-dojo-props="onClick:setTextBoxPadding">1px</div>
                                            <div dojoType="dijit.CheckedMenuItem" data-dojo-props="onClick:setTextBoxPadding">2px</div>
                                            <div dojoType="dijit.CheckedMenuItem" data-dojo-props="onClick:setTextBoxPadding">3px</div>
                                            <div dojoType="dijit.CheckedMenuItem" data-dojo-props="onClick:setTextBoxPadding">4px</div>
                                            <div dojoType="dijit.CheckedMenuItem" data-dojo-props="onClick:setTextBoxPadding">5px</div>
                                            </div>
                                        </div>
                                        <div dojoType="dijit.PopupMenuBarItem" id="help">
                                                <span>Help</span>
                                            <div dojoType="dijit.Menu" id="helpMenu">
                                            <div dojoType="dijit.MenuItem">Help Topics</div>
                                            <div dojoType="dijit.MenuItem">About Dijit</div>
                                            </div>
                                        </div>
                                        <div dojoType="dijit.PopupMenuBarItem" data-dojo-props="disabled:true">
                                                <span>Disabled</span>
                                            <div dojoType="dijit.Menu">
                                            <div dojoType="dijit.MenuItem">You should not see this</div>
                                            </div>
                                        </div>
                </div>
                <div dojoType="dijit.layout.AccordionContainer"minSize="20" style="width: 300px;" id="leftAccordion" region="left" splitter="true">

                        <div dojoType="dijit.layout.ContentPane" title="Popups and Alerts"><div style="padding:8px">
                        </div>
                </div><!-- end AccordionContainer -->                                         
          </div>
       </div>
  </form> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T19:57:34.490

让 BorderContainer 进行渲染可能会很棘手。通常我发现这是一个尺寸问题，而且它完全是错误的尺寸。

我通常尝试：

1.  使用您的浏览器开发工具检查与 BorderContainer 对应的内容，并找出它的实际大小。它通常类似于一个名为“Metrics”的选项卡，它指示容器的确切位置和大小，以及它的填充和边距发生了什么。有可能是 0px 高。
2.  在您的 HTML 中，将 BorderContainer div 的宽度和高度明确设置为静态和硬编码（例如 style="width: 300px; height: 300px"），然后看看会发生什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-14T19:43:07.317

我想，除了 Royston 解决方案之外，对我有用的只是这样做：
dijit.byId("main").resize();
（其中“main”是 BorderContainer 的 id）。

# lua - lua中是否有等效的Boost.Program_options？

> ID：10419055
> 
> 赞同：0
> 
> 时间：2012-05-02T17:50:28.220
> 
> 标签：lua, config, boost-program-options

我希望能够从命令行和文件中获取程序选项。

如果没有接近的等价物，制作配置文件的常用方法是什么？

我喜欢 boost.po，但我不喜欢我不能在配置文件中编写脚本。例如，我可以只写 sqrt(2)，而不是写 1.41421356。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T18:19:20.350

你问了几个似乎彼此没有太大关系的问题。

Boost.ProgramOptions 是一个解析命令行选项的工具。作为此工具的扩展，它还可以从文件格式中获取这些选项。这些不是“配置文件”；这些是*选项*文件。它们包含看起来像一系列命令行选项的选项。

你可以在概念上把它想象成一个 .ini 文件（或者你可能从 Boost.PropertyTree 得到的东西）。但格式最终仍然是命令行选项的格式：`--option-name "parameter" -o "next Param"`.

因此，Boost.ProgramOptions 的“Lua 等价物”将成为*解析命令行选项的工具*。您[可以](http://lua-users.org/wiki/CommandLineParsing)为此任务选择多个选项。

如果您想拥有基于 Lua 脚本构建的配置文件，那么您应该这样做。Lua 的表构造函数提供了一种非常合理且人类可读的文件格式，很像 JavaScript 的 JSON。但是，这些与命令行选项没有直接联系；它只是一个 Lua 脚本，您可以将其读取为 Lua 表并按照您认为合适的方式进行处理。您无法将此表的片段复制并粘贴到命令行上，并期望像 Boost.ProgramOption 的选项文件那样获得合理的结果。

# sql - 无效，因为它不包含在聚合函数或 group by 子句中

> ID：10419057
> 
> 赞同：8
> 
> 时间：2012-05-02T17:50:30.687
> 
> 标签：sql

我想创建一个从产品表中获取产品的查询，它是类型表中的类型和类别以及产品中歌曲的数量。但不知何故，这个查询会引发错误。它从我添加时开始`count(n.name)`

```
SELECT p.name, p.publisher, p.description, p.price, p.picture
     , p.releasedate, t.type, t.category, count(n.name) AS songs
  FROM Products p
 INNER JOIN ProductType t ON (p.type_id = t.id)
 INNER JOIN Songs n ON (p.id = n.product_id) 
```

我得到的错误是

> 列“Products.name”在选择列表中无效，因为它既不包含在聚合函数中，也不包含在 GROUP BY 子句中。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-02T23:03:51.837

仅对行进行分组`Songs`，然后加入聚合数据而不是`Songs`正确的表：

```
SELECT p.name, p.publisher, p.description, p.price, p.picture
     , p.releasedate, t.type, t.category, **n.songs**
  FROM Products p
 INNER JOIN ProductType t ON (p.type_id = t.id)
 INNER JOIN **(
   SELECT
     product_id,
     COUNT(n.name) AS songs
   FROM Songs
   GROUP BY product_id
 )** n ON (p.id = n.product_id) 
```

这样，您将避免将几乎所有输出列添加到`GROUP BY`子句中，而您必须在问题中发布的查询中执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T17:52:39.323

```
SELECT p.name, p.publisher, p.description, p.price, p.picture, p.releasedate, t.type, t.category, count(1) AS songs
                    FROM Products p
                    INNER JOIN ProductType t ON (p.type_id = t.id)
                    INNER JOIN Songs n ON (p.id = n.product_id)
GROUP BY p.name, p.publisher, p.description, p.price, p.picture, p.releasedate, t.type, t.category 
```

# mongodb - 选择时的mongodb增量计数器

> ID：10419058
> 
> 赞同：1
> 
> 时间：2012-05-02T17:50:31.550
> 
> 标签：mongodb, mongoose, mongodb-query

当 find 命令返回文档时，有没有办法通过将（$incr）其计数器字段（假设有一个计数器字段）增加 1 来更新文档？

或者，

没有办法，只能手动更新？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T23:10:28.237

你看过使用 findAndModify 吗？您可以找到文档，自动更新它，然后在一个操作中返回它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T17:52:57.680

不幸的是，MongoDB 中不支持内部触发或任何类似的东西。您必须手动执行此操作。

[这](https://jira.mongodb.org/browse/SERVER-124)是关于触发器功能的讨论。

# performance - 我们如何减少 NHibernate 的属性代理开销？

> ID：10419062
> 
> 赞同：2
> 
> 时间：2012-05-02T17:50:40.697
> 
> 标签：performance, nhibernate, fluent-nhibernate, proxy, castle-dynamicproxy

我们使用 Fluent NHibernate 1.3.0.727 和 NHibernate 3.3.0.4000 将我们的属性映射到数据库中的列。这是我们的一个 ClassMap 的缩写示例：

```
 public class TankMap : ClassMap<Tank>
    {
        public TankMap()
        {
            Id(o => o.Id);
            Map(o => o.TankSystem);
        }
    } 
```

在这种情况下， TankSystem 属性是一个**字符串**。

在我们的应用程序的某些部分中，有很多计算涉及多次访问映射的属性（例如 TankSystem）。当我们分析应用程序时，简单地访问这些属性会占用大量时间，因为每次访问它们时，都必须通过 NHibernate.Proxy.DefaultLazyInitializer.Intercept 方法。

我们需要尽可能快地进行计算，并希望避免这种代理开销。一种方法是将我们想要的属性（例如 TankSystem）复制到数组中，并在我们想要访问此信息的任何时候使用数组，但这不是一种非常面向对象的方法。

**更新：**

我们尝试使用 Not.LazyLoad 映射我们的属性，例如：

```
Map(o => o.TankSystem).Not.LazyLoad(); 
```

但是，这似乎对该属性是否实际被代理没有任何影响。

有没有什么办法可以避免/减少这种代理开销？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T17:53:03.537

是的！`.Not.LazyLoad()`为了救援！

```
 public TankMap()
    {
        Id(o => o.Id);
        Map(o => o.TankSystem).Not.LazyLoad();
    } 
```

我找到了一个很好的简短解释：

> 您可能想知道 Not.LazyLoad() 是什么意思。默认情况下，Fluent NHibernate 定义了使用延迟加载的映射。但这也意味着我们实体的所有属性都必须是虚拟的（代理）。

[**资源**](http://dotnetslackers.com/articles/ado_net/Your-very-first-NHibernate-application-Part-1.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T07:10:31.297

我真的会小心在您的映射中使用 .Not.LazyLoad() 并根据需要在您的查询中急切加载。如果延迟加载获取策略配置不正确，问题可能会出现。始终最好使用 NProf 之类的工具检查每个查询。

林克：

```
var tanks = _session.Linq<Tank>()
               .Fetch(x=>x.TankSystem)
               .ToList(); 
```

QueryOver（我的首选）： var tank = _session.QueryOver() .Fetch(x=>x.TankSystem).Eager .List();

```
TankSystem tankSystemAlias = null;
var tanks = _session.QueryOver<Tank>()
                .JoinAlias(x=>x.TankSystem, () => tankSystemAlias, JoinType.InnerJoin) // or JoinType.LeftOuterJoin
                .List() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T17:54:33.233

避免在对象上具有虚拟属性的一种方法是：

```
public TankMap()
{
        Id(o => o.Id);
        this.Not.LazyLoad(); 
        Map(o => o.TankSystem);
} 
```

这样就没有属性代理魔法。

# c# - 使用 NAudio 增加 WAV 文件的采样率导致“静态”

> ID：10419067
> 
> 赞同：1
> 
> 时间：2012-05-02T17:51:07.533
> 
> 标签：c#, audio, wav, naudio

我正在使用 WaveFormatConversionStream 将包含录制语音的单通道 16 位 PCM WAV 文件的采样率从 11025 提高到 16000 Hz。生成的 WAV 文件仍然可以理解，但似乎有很多“静态”（听起来好像是通过部分爆裂的扬声器播放的）。这是正常的，预期的行为，还是我做错了什么？代码如下：

```
using (WaveFileReader wfr = new WaveFileReader("inFile.wav"))
{
  var newFormat = new WaveFormat(16000, wfr.WaveFormat.BitsPerSample, wfr.WaveFormat.Channels);
  using (WaveFileWriter wfw = new WaveFileWriter("outFile.wav", newFormat))
  {
    using (WaveFormatConversionStream conversionStream = new WaveFormatConversionStream(newFormat, wfr))
    {
      conversionStream.Position = 0;
      byte[] buffer = new byte[1024];
      while (conversionStream.Position < conversionStream.Length)
      {
        int bytesRead = conversionStream.Read(buffer, 0, 1024);
        if (bytesRead > 0)
        {
          wfw.Write(buffer, 0, bytesRead);
        }
        else
        {
          break;
        }
      }
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T12:54:55.903

我看不出你的代码有什么问题（尽管不需要设置 Position = 0）。它在后台使用 Windows 提供的 ACM 采样率转换，这很合理，但并不出色。特别是，我认为它不应用任何低通滤波器，通常建议在重采样时减少混叠和伪影。但你所描述的听起来比那更严重。您可以尝试的另一件事是使缓冲区大小整整一秒 - 即 16000 * 通道 * 2。

另一件事，我假设音频是 16 位的？

# c# - 使用 C# 读取/写入 Excel 文件 (.xls/.xlsx)

> ID：10419071
> 
> 赞同：20
> 
> 时间：2012-05-02T17:51:54.430
> 
> 标签：c#, .net, excel

如何在 C# 中读写 Excel 文件？我已经将 Excel 对象库添加到我的项目中，但是对于访问这些文件需要做什么，我没有得到足够清晰的描述。

请帮助我理解，并在解释时请记住，我对此有点陌生，但我不是一个完整的新手。我学习很多，所以我并不完全无知。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-02T19:44:59.000

我非常喜欢使用[EPPlus](http://epplus.codeplex.com/)来执行这些类型的操作。EPPlus 是一个您可以在项目中引用并在服务器上轻松创建/修改电子表格的库。我将它用于任何需要导出功能的项目。

[这是一个很好的博客条目，展示了如何使用该库](http://zeeshanumardotnet.blogspot.com/2011/06/creating-reports-in-excel-2007-using.html)，尽管该库本身应该带有一些解释如何使用它的示例。

在我看来，第三方库比 Microsoft COM 对象更容易使用。我建议试一试。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-02T19:29:35.480

我使用 NPOI 来满足我所有的 Excel 需求。

[http://npoi.codeplex.com/](http://npoi.codeplex.com/)

附带许多常见 Excel 任务的示例解决方案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-02T19:36:50.703

您可以使用 Excel 自动化（它基本上是一个 COM Base 的东西），例如：

```
Excel.Application xlApp ;
Excel.Workbook xlWorkBook ;
Excel.Worksheet xlWorkSheet ;

xlApp = new Excel.ApplicationClass();
xlWorkBook = xlApp.Workbooks.Open("1.xls", 0, true, 5, "", "", true, Microsoft.Office.Interop.Excel.XlPlatform.xlWindows, "\t", false, false, 0, true, 1, 0);
xlWorkSheet = (Excel.Worksheet)xlWorkBook.Worksheets.get_Item(1); 
```

[链接到完整教程](http://csharp.net-informations.com/excel/csharp-read-excel.htm)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-02-27T10:09:03.347

```
**Reading the Excel File:**

string filePath = @"d:\MyExcel.xlsx";
Excel.Application xlApp = new Excel.Application();  
Excel.Workbook xlWorkBook = xlApp.Workbooks.Open(filePath);  
Excel.Worksheet xlWorkSheet = (Excel.Worksheet)xlWorkBook.Worksheets.get_Item(1);  

Excel.Range xlRange = xlWorkSheet.UsedRange;  
int totalRows = xlRange.Rows.Count;  
int totalColumns = xlRange.Columns.Count;  

string firstValue, secondValue;   
for (int rowCount = 1; rowCount <= totalRows; rowCount++)  
{  
    firstValue = Convert.ToString((xlRange.Cells[rowCount, 1] as Excel.Range).Text);  
    secondValue = Convert.ToString((xlRange.Cells[rowCount, 2] as Excel.Range).Text);  
    Console.WriteLine(firstValue + "\t" + secondValue);  
}  
xlWorkBook.Close();  
xlApp.Quit(); 

**Writting the Excel File:**

Excel.Application xlApp = new Excel.Application();
object misValue = System.Reflection.Missing.Value;  

Excel.Workbook xlWorkBook = xlApp.Workbooks.Add(misValue);  
Excel.Worksheet xlWorkSheet = (Excel.Worksheet)xlWorkBook.Worksheets.get_Item(1);  

xlWorkSheet.Cells[1, 1] = "ID";  
xlWorkSheet.Cells[1, 2] = "Name";  
xlWorkSheet.Cells[2, 1] = "100";  
xlWorkSheet.Cells[2, 2] = "John";  
xlWorkSheet.Cells[3, 1] = "101";  
xlWorkSheet.Cells[3, 2] = "Herry";  

xlWorkBook.SaveAs(filePath, Excel.XlFileFormat.xlOpenXMLWorkbook, misValue, misValue, misValue, misValue,  
Excel.XlSaveAsAccessMode.xlExclusive, misValue, misValue, misValue, misValue, misValue);  

xlWorkBook.Close();  
xlApp.Quit(); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-01-20T07:39:36.300

如果您想要易于使用的库，可以使用**NUGET 包**：

*   **ExcelDataReader** - 读取 Excel 文件（大多数文件格式）
*   **SwiftExcel** - 编写 Excel 文件 (.xlsx)

请注意，这些是 3rd-Party 软件包 - 您可以免费将它们用于基本功能，但如果您想要更多功能，可能会有“专业”版本。

他们使用二维对象数组（即`object[][] cells`）来读取/写入数据。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-02T19:25:37.427

如果您正在进行简单的操作并且可以将自己绑定到 xlsx，那么您可以考虑自己操作 XML。我已经做到了，发现它比 grokking excel 库更快。

还有更易于使用的 3rd 方库......并且可以在 MS 无法使用的服务器上使用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-10-21T20:42:57.993

简单而强大的解决方案是**[ClosedXML](https://github.com/ClosedXML/ClosedXML)**库。从“封闭”Excel文件的单元格读取和写入非常简单，主要逻辑如下：

```
using Excel = ClosedXML.Excel;

namespace Excel_Tests
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

     private void button1_Click(object sender, EventArgs e)
     {
        //create 'workbook' object
        var wb = new Excel.XLWorkbook("E:\\test1.xlsx");

        //create 'worksheet' object
        var ws = wb.Worksheets.Worksheet("Sheet1");

        //read cells
        var a = ws.Cell("A1").Value;
        var b = ws.Cell("B1").Value;

        Console.WriteLine(a.ToString());
        Console.WriteLine(b.ToString());

        //write cells
        ws.Cell("F2").Value = 9999999;
        ws.Cell("F2").Value = 2.333;
        ws.Cell("G2").Value = "This is cell G2";

        wb.Save();

    }
  }
} 
```

# iphone - 来自外部设备的意外输入 - iOS

> ID：10419072
> 
> 赞同：3
> 
> 时间：2012-05-02T17:52:00.233
> 
> 标签：iphone, ios, serial-port, ipod, external-accessory

我将 iPod Touch（4G，越狱，iOS 5.0）连接到扩展坞（为 iPod 制造），通过扩展坞连接器（很可能使用 Apple 附件协议）向 iPod 发送命令，例如开始和停止播放。由于 iPod 已越狱，当我通过 ssh 连接到 iPod 时，我可以看到输入的命令，如下所示（这里反复按下扩展坞上的播放/暂停按钮，每行相当于按下一个按钮）：

```
iPod Touch:~ mobile$ od /dev/tty.iap
0000000 102000 177020 004017 000360 004017 000360 144204 004317
0000020 000340 002020 000376 004017 177430 002010 000376 000440
0000040 147730 160010 004377 147740 160010 020000 154001 102000
0000060 177020 020400 177000 102000 177710 160010 007400 014010
0000100 000377 004417 177430 007400 014011 000377 002020 020400
0000120 177000 004000 000300 140010 004377 000340 000440 000344 
```

我不明白为什么这里的输入总是不同的。当我按下同一个按钮时，我希望每一行输入都是相同的（显然忽略了开头的偏移标记）。否则，播放/暂停按钮将按预期工作（当此`od`命令未运行时）。

所以我的问题是：有没有更好的调用方式`od`或我可以使用的其他实用程序，以便我能够正确查看请求？还是我需要更改波特率或类似的东西？

**编辑：**每隔一段时间就会显示两行输入，而不是只显示一个按钮。这可能是对齐/缓冲问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T22:35:02.010

显然问题出在波特率上，波特率（默认情况下）为 9600 `/dev/tty.iap`。使用将波特率更改为 19200 的小型 C 程序（不知道如何设置`od`或`hexdump`直接更改串行端口的波特率），`cfsetspeed`来自外部附件的命令输入始终相同。

# vb.net - 同时突出显示两个文本框中的文本

> ID：10419077
> 
> 赞同：0
> 
> 时间：2012-05-02T17:52:31.127
> 
> 标签：vb.net, visual-studio

为了在文本框中选择文本，您需要专注于它。问题是，在聚焦并选择第二个文本框后，它会取消选择第一个文本框中的文本。

有没有人有解决方法？

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T18:07:01.853

将 的`HideSelection`属性设置`TextBox`为`false`。

```
myTextBox.HideSelection = false; 
```

当然，您也可以在属性窗口中执行此操作（在该`Behavior`部分中）。

# silverlight - StringFormat、TextBox 验证和插入符号位置

> ID：10419078
> 
> 赞同：2
> 
> 时间：2012-05-02T17:52:36.817
> 
> 标签：silverlight

我有一个需要解决的问题。当某些事件发生时，我的 TextBox 的插入符号位置会重置为第一个字符。这是我的 TextBox 的 XAML，我的应用程序正在使用 MVVM：

```
<TextBox x:Name="txtAmount" Text="{Binding CurrentClientObject.Amount, Mode=TwoWay, StringFormat='###,###,##0.00'}"></TextBox> 
```

绑定到模型属性：

```
private System.Nullable<decimal> _Amount; 
    [Display(ResourceType = typeof(MatchModelResx), Name = "LabelAmount", Description = "ToolTipAmount")] 
    public System.Nullable<decimal> Amount 
    { 
        get 
        { 
            return _Amount; 
        } 
        set 
        { 
            _Amount = value; 
            NotifyChanged("Amount"); 
        } 
    } 
```

StringFormat 在这里引起了问题，因为每当我在 TextBox 中输入的字符串触发模型中属性的刷新时，都会应用 StringFormat 并且 TextBox 内的插入符号会移动

现在这不成问题了，因为模型在 lostfocus 上刷新（UpdateSourceTrigger = 默认），但有时 TextBox 处于错误模式。如果用户输入的值违反了自定义验证规则，或者格式无效（即：在绑定到小数的字段中输入 64.5x5），则每次 keychange 都会触发模型中属性的刷新。由于模型刷新可能会导致应用 StringFormat，这意味着当用户尝试更正 TextBox 中的无效值时，插入符号将向左移动。这对我们的客户来说是一种恼人的行为，我们真的需要找到解决方法。

我尝试在绑定上使用自定义转换器而不是字符串格式，但这并不能解决问题。而且由于有时会在代码到达属性 Set 之前引发异常，因此在插入符号移动之前我无法处理此问题。

Silverlight 5 是否提供解决此问题的方法？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-05T09:41:31.337

不确定您是否设置了 UpdateSourceTrigger=PropertyChanged，对于文本框，这会导致每次按下键并应用 StringFormat 时刷新，要解决此问题，应将其设置为“默认”，即 LostFocus

[http://msdn.microsoft.com/en-us/library/system.windows.data.binding.updatesourcetrigger(v=vs.110).aspx](http://msdn.microsoft.com/en-us/library/system.windows.data.binding.updatesourcetrigger%28v=vs.110%29.aspx)

# php - 页面刷新而不是 Ajax 加载

> ID：10419079
> 
> 赞同：3
> 
> 时间：2012-05-02T17:52:36.957
> 
> 标签：php, javascript, jquery, mysql, ajax

在表单提交时，我想加载一个带有 mysql 表更新列表的 div。我将表单变量发送到 php 并将它们发布到 mysql 表中。同一页面显示完整的表格数据。我想将数据加载到与表单相同的 div 标签中。因此，信息似乎正在表单上方加载。

我的 Javascript

```
$("#formSubmit").submit(function(){

    var name = $("input#name").val();
    var comment = $("input#comment").val();
    var filmnumber = $("input#hidden").val();

    var dataString = 'name='+ name + '&comment=' + comment + '&filmnumber=' + filmnumber;

    $.ajax({
        type: "POST",
        url: "comment.php",
        data: dataString,
        success: function() {
            $('#2').load('comment.php');
        }
    }); 
```

我的表格——

```
<div id="2">                                    
    <p>Add a Comment</p>
    <form id="formSubmit" method="POST">
        <div>
            <input type="hidden" name="hidden" id="hidden" value="2">
            <label for="name">Your Name</label>
            <input type="text" name="name" id="name" />

            <label for="body">Comment Body</label>
            <textarea name="comment" id="comment" cols="20" rows="5"></textarea>

            <input type="submit" id="comment" class="button" value="Submit" />
    </form>
    </div> 
```

它所做的只是刷新页面而不是将信息加载到 div 2：S

感谢您的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T17:54:07.417

`preventDefault`您需要使用事件对象上的方法来防止表单重定向页面：

```
$("#formSubmit").submit(function(e){ // add the event object as an argument to your function
    e.preventDefault(); // right here

    var name = $("input#name").val();
    var comment = $("input#comment").val();
    var filmnumber = $("input#hidden").val();

    var dataString = 'name='+ name + '&comment=' + comment + '&filmnumber=' + filmnumber;

    $.ajax({
      type: "POST",
      url: "comment.php",
      data: dataString,
      success: function() {
       $('#2').load('comment.php');
      }
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T17:54:22.593

在末尾添加 return false 以阻止表单提交。或者，如果您想更优雅，请使用 preventDefault(); 方法。就个人而言，尽管我只是坚持使用 return false ，但像这样简单的事情；

```
$("#formSubmit").submit(function(e){ // add the event object as an argument to your function

var name = $("input#name").val();
var comment = $("input#comment").val();
var filmnumber = $("input#hidden").val();

var dataString = 'name='+ name + '&comment=' + comment + '&filmnumber=' + filmnumber;

$.ajax({
  type: "POST",
  url: "comment.php",
  data: dataString,
  success: function() {
   $('#2').load('comment.php');
  }
});
return false;//right here 
```

});

# regex - 找到在 url 中间的字符 ~ 的第一次出现

> ID：10419087
> 
> 赞同：1
> 
> 时间：2012-05-02T17:53:04.393
> 
> 标签：regex

我需要使用正则表达式检索 url 的某些部分。网址如下所示：

```
/xxxx/bbbb/good/city/games_in_the_city.~cccccc~dddddd~eeeee.html 
```

我需要检索 games_in_the_city。我得到了第一部分，直到 / 被删除。现在需要找到字符串中第一次出现的~，以便将其余部分也删除。我现在拥有的正则表达式`(.*\/good\/city\/)(.*)(\.html)`得到 `games_in_the_city.~cccccc~dddddd~eeeee`

如何修改我的正则表达式，以便`~cccccc~dddddd~eeeee`也可以删除。最终输出应该是我不知道url 中可以出现`games_in_the_city` 多少个（波浪号）。`~`有时它可能是一到n。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T18:10:51.343

您可以使用正则表达式：

```
(?:.*\/good\/city\/)(.*?)\.?(?:~[^~]+)*(?:\.html) 
```

[看见](http://www.rubular.com/r/jIhm9QAylg)

# javascript - 如何增加 Webstorm 调试器中显示的帧数？

> ID：10419089
> 
> 赞同：1
> 
> 时间：2012-05-02T17:53:13.960
> 
> 标签：javascript, debugging, node.js, intellij-idea, webstorm

我正在使用 Webstorm 来调试节点应用程序。我注意到调试区域的“框架”窗格中显示的帧不超过 10 个。

如何显示整个框架列表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T11:18:15.207

看起来这个限制来自 NodeJS 调试引擎。使用节点检查器调试应用程序时显示相同数量的帧。

# sql-server - SQL Server 语法返回 2 个给定日期之间的查询

> ID：10419090
> 
> 赞同：0
> 
> 时间：2012-05-02T17:53:23.037
> 
> 标签：sql-server

我有一个 SQL Server 表，其中有一列称为`statusdate`ODBC 日期/时间。
我需要创建一个`SELECT query WHERE statusdate`可以返回 2 个日期（开始日期和结束日期）之间的范围。我被告知`DATEDIFF`在我的`WHERE`声明中使用。这是正确的，语法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T18:27:14.847

如果您使用的是 SQL Server 2008/2012 和`date`您可以使用的数据类型。

```
select *
from YourTable
where statusdate between @StartDate and @EndDate 
```

如果您使用`datetime`，我建议您使用`>=`and`<`来确保您获得所有值，而不管时间部分如何。

```
select *
from YourTable
where statusdate >= @StartDate and 
      statusdate < dateadd(day, 1, @EndDate) 
```

**更新**

> 有人告诉我在 WHERE 语句中使用 DATEDIFF。它是否正确

不，您不应该`datediff`为此使用。

> 语法是什么？

在这里...但不要使用它。

```
select *
from YourTable
where datediff(day, statusdate, @StartDate) = 0 and
      datediff(day, statusdate, @EndDate) = 0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T17:58:35.590

你为什么不做一个`BETWEEN`？：

```
SELECT *
FROM YourTable
WHERE statusdate BETWEEN StartDate AND EndDate 
```

# xml - 如何使用 XSLT 简化兄弟节点之间的 XML 节点以确保不存在重复节点？

> ID：10419095
> 
> 赞同：0
> 
> 时间：2012-05-02T17:53:35.223
> 
> 标签：xml, xslt

如果我在 xml 中有这个输入文件：

```
<root> 
    <node id="N1">
        <fruit id="1">
            <orange id="x" action="create">
                <attribute>
                    <color>Orange</color>
                    <year>2000</year>
                </attribute>
            </orange>                        
        </fruit>        

        <fruit id="1">
            <orange id="x" action="create">
                <attribute>
                    <color>Orange</color>
                    <condition>good</condition>
                </attribute>
            </orange>                        
        </fruit>        
    </node>
</root> 
```

这是预期的输出：

```
<root> 
    <node id="N1">
        <fruit id="1">
            <orange id="x" action="create">
                <attribute>
                    <color>Orange</color>
                    <year>2000</year>
                    <condition>good</condition>
                </attribute>
            </orange>                        
        </fruit>        

        <fruit id="1">                                 
        </fruit>
    </node>
</root> 
```

如何简化两个兄弟之间：

1.  检查父母是否相同（水果id = 1）
2.  检查节点id和action是否相同（橙色id=x action=create）
3.  如果之前已经定义了子元素并且值相同 (color-orange) ，我们将其删除。
4.  如果之前没有定义第二个兄弟的子元素，我们将第二个节点添加到第一个节点。（条件良好）
5.  如果之前已经定义了节点但值不同（比如红色），我们将节点保持原样。

另一种情况：输入2：

```
<root> 
    <node id="N1">
        <fruit id="1">
            <orange id="x" action="create">
                <attribute>
                    <color>Orange</color>                   
                </attribute>
            </orange>                        
        </fruit>        

        <fruit id="1">
            <orange id="x" action="create">
                <attribute>
                    <color>Red</color>
                    <condition>good</condition>
                </attribute>
            </orange>                        
        </fruit>        
    </node>
</root> 
```

预期输出：

```
<root> 
    <node id="N1">
        <fruit id="1">
            <orange id="x" action="create">
                <attribute>
                    <color>Orange</color>
                    <condition>good</condition>
                </attribute>
            </orange>                        
        </fruit>        

        <fruit id="1">
            <orange id="x" action="create">
                <attribute>
                    <color>Red</color>
                </attribute>
            </orange>                        
        </fruit>        
    </node>
</root> 
```

另一种情况：

```
<root> 
    <nodeA id="A">
        <fruit id="1">
            <orange id="x" action="delete" />    <!-- no attributes here -->                                         
        </fruit>        

        <fruit id="1">
            <orange id="x" action="delete"/>   
            <orange id="y" action="delete" />                                            
        </fruit>        
    </nodeA>
</root> 
```

预期输出：

```
<root> 
    <nodeA id="A">
        <fruit id="1">
            <orange id="x" action="delete" />   
        </fruit>        

        <fruit id="1"> 
            <orange id="y" action="delete" />                                         
        </fruit>        
    </nodeA>
</root> 
```

我希望该示例给出清晰的想法，并请帮助我处理转换文件。谢谢。

约翰

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T20:13:20.687

约翰，这是一个有效的版本。这有点残酷和程序化，所以我想知道您是否真的想在 XSLT 中执行这种逻辑。干得好：

**以下样式表：**

```
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output omit-xml-declaration="yes" indent="yes"/>
    <xsl:strip-space elements="*"/>

    <xsl:key name="entity" match="node/*/*" use="concat(parent::*/@id, '_', @id, '_', @action)"/>

    <xsl:template match="@* | node()">
        <xsl:copy>
            <xsl:apply-templates select="@* | node()"/>
        </xsl:copy>
    </xsl:template>

    <xsl:template match="node/*/*[not(attribute)][generate-id() != generate-id(key('entity', concat(parent::*/@id, '_', @id, '_', @action))[1])]"/>

    <xsl:template match="node/*/*[attribute]">
        <xsl:variable name="attributes">
            <xsl:copy>
                <xsl:apply-templates select="@* | node()">
                    <xsl:with-param 
                            name="mode" 
                            select="generate-id() = generate-id(key('entity', concat(../@id, '_', @id, '_', @action))[1])"/>
                </xsl:apply-templates>
            </xsl:copy>
        </xsl:variable>
        <xsl:if test="$attributes/*/attribute/*">
            <xsl:copy-of select="$attributes"/>
        </xsl:if>
    </xsl:template>

    <xsl:template match="node/*/*/attribute">
        <xsl:param name="mode"/>
        <xsl:variable name="all-attributes" select="key('entity', concat(../../@id, '_', ../@id, '_', ../@action))/attribute/*"/>
        <xsl:copy>
            <xsl:if test="$mode = true()">
                <xsl:for-each-group select="$all-attributes" group-by="local-name()">
                    <xsl:copy>
                        <xsl:apply-templates select="@* | node()"/>
                    </xsl:copy>
                </xsl:for-each-group>
            </xsl:if>
            <xsl:if test="$mode = false()">
                <xsl:for-each select="*">
                    <xsl:variable 
                        name="same-name-attr" 
                        select="$all-attributes[local-name() = current()/local-name()][count(. | current()/preceding::*) = count(current()/preceding::*)]"/>
                    <xsl:if test="$same-name-attr and not(. = $same-name-attr)">
                        <xsl:copy-of select="."/>
                    </xsl:if>
                </xsl:for-each>
            </xsl:if>
        </xsl:copy>
    </xsl:template>
</xsl:stylesheet> 
```

**产生以下结果**：

```
<root>
   <node id="N1">
      <fruit id="1">
         <orange id="x" action="create">
            <attribute>
               <color>Orange</color>
               <year>2000</year>
               <condition>good</condition>
               <new>!!</new>
            </attribute>
         </orange>
      </fruit>
      <fruit id="1">
         <orange id="x" action="create">
            <attribute>
               <color>Red</color>
            </attribute>
         </orange>
      </fruit>
      <fruit id="1">
         <orange id="x" action="create">
            <attribute>
               <color>Blue</color>
            </attribute>
         </orange>
      </fruit>
      <fruit id="1">
         <orange id="x" action="create">
            <attribute>
               <condition>ugly</condition>
            </attribute>
         </orange>
      </fruit>
      <fruit id="1"/>
   </node>
</root> 
```

所有独特的属性都被拉到第一次出现的`create`动作中，只有那些具有不同值的属性留在`following::`节点中。如果节点没有新内容要添加，它就会被抛在后面。以下是我如何确定该属性是否值得为后续事件保留。如果该属性之前没有出现过，那么它已经被拉到第一次出现，所以我们跳过它。如果它以前见过（= 它在轴上的同名属性的集合中`preceding`）并且具有不同的文本值，那么我们才保留它。

你想做的事情的选择器变得越来越复杂，所以我不得不使用临时变量基本上让模板对其进行测试，然后检查是否有任何结果，然后决定是否值得将其复制到结果树中。可能有一种方法可以将此逻辑转换为匹配谓词，但我不确定它是否更具可读性。我希望这是有道理的。

**更新**我更新了解决方案，也适用于您的无属性极端情况。我基本上不得不使`attribute`重复的 no- 节点保持沉默，并使主模板更加具体，以便仅在带有`attribute`s 的节点上工作。将使用主要属性合并逻辑“重复”具有属性节点的无属性节点将保持沉默。需要保留的 no- `attribute`s 节点将使用默认的身份转换进行复制。

# jquery - 如何捕获所有已更改的表单输入，使用 jQuery 1.4 的特定类中的输入除外

> ID：10419099
> 
> 赞同：0
> 
> 时间：2012-05-02T17:53:41.587
> 
> 标签：jquery, jsp

我有这段代码来捕获所有表单输入并且它正在工作，但是，我试图排除某个 div 中的那些，该 div 是 jsp 常见的下拉列表。我为此将 div 分配给一个类作为可能的解决方案。

这是代码的原始工作行：

```
$(':input', document.formName).change(function() { ... 
```

然后我使用 if 语句：

```
if($('.className:not(.selected)')){ 
do something ... 
```

但是 if 语句在某种程度上是不正确的。做这个的最好方式是什么？有没有办法将所有内容组合在一个语句中，或者 if 块是正确的方式，如果是这样，排除类的正确语法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T17:57:24.287

您可以[`.not`](http://api.jquery.com/not/)在选择器中使用该类排除元素`.selected`

```
$(':input', document.formName).not('.selected').change(function() { ... 
```

甚至

```
$(':input:not(".selected")', document.formName).change(function() { ... 
```

这是一个[小提琴](http://jsfiddle.net/azizpunjani/GS5e4/1/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-02T18:13:17.110

如果选择器正在执行过滤，则不需要使用`if`语句本身。如果您可以`excluded`在输入本身而不是在周围添加 css 类（例如）`div`，则以下内容将起作用

任何一个：

[`.not`方法](http://api.jquery.com/not/)：（[小提琴](http://jsfiddle.net/FloydPink/Ts6RA/)）_

```
$('form').find(':input').not('.excluded').change(function() {
    //your code
}); 
```

或[`:not`选择器](http://api.jquery.com/not-selector/)：（[小提琴](http://jsfiddle.net/FloydPink/Ts6RA/2/)）

```
$('form').find(':input:not(".excluded")').change(function() {
    //your code
}); 
```

# .net - 为什么即使我不调用我的服务的 Dispose() 方法，它也会被调用？（使用 BasicHttpBinding）

> ID：10419100
> 
> 赞同：3
> 
> 时间：2012-05-02T17:53:46.050
> 
> 标签：.net, wcf, c#-4.0, dispose, idisposable

我正在学习 .NET Web 服务简介课程，我们目前正在学习的其中一件事是 IDisposable 接口。作为一个相对简单的例子，我创建了一个带有`MyMethod()`操作的服务（服务器/客户端）。该方法在调用时仅打印一条跟踪语句。我还在我的服务器上实现了 IDisposable `Dispose()`，再次在服务器实现的版本中使用简单的 WriteLine 跟踪来实现该方法。

在我的客户端中，我使用 ChannelFactory 创建了两个代理。在 proxy1 上，我调用了`MyMethod()`3 次操作，然后有几行代码用于处理 proxy1：

```
var castedProxy = (IDisposable)proxy1;
castedProxy.Dispose(); 
```

在 proxy2 上，我再次调用该`MyMethod()`操作 3 次，但这次我不强制转换和调用`Dispose()`. 当我运行服务器/客户端时，我得到了 6 次相同的跟踪：

> 服务器的 Trace + CurrentThread ID
> MyMethod() 的 Trace + CurrentThread ID
> Dispose() 的 Trace + CurrentThread ID

我的问题是：为什么`Dispose()`跟踪的部分每次都会发生，即使我只使用前 3 个跟踪？我的猜测是，这与使用 BasicHttpBinding 时本身没有会话管理这一事实有关，因此旧资源仍然存在，打印旧的 Dispose() 调用。

提前感谢您提供的任何见解！:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T18:09:53.477

客户端上的代理和服务器上的服务是两个不同的对象。

对于服务器，每个服务对象的生命周期`InstanceContextMode`由`ServiceBehaviour`. 如果设置为`PerCall`，则将为每次调用创建和销毁服务类的新实例。WCF 为您执行此操作 - 您只需设置`ServiceBehaviour`.

通常，客户端和服务器将处于不同的进程中。如果你这样想，客户端代理的生命周期并不能控制服务的生命周期是有道理的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T18:09:39.257

您在客户端而不是服务器上调用 dispose 。因为您的 WCF 服务是按请求配置的，所以即使客户端仍然存在，也会为每次调用创建和释放该类。

WCF 默认调用服务中的 Dispose。这是正常行为。如果 service 实现`IDisposable`，则`Dispose`在 service 被销毁时调用。

# scala - 如何从编译器插件中找到 Scala 程序中的语句？

> ID：10419101
> 
> 赞同：4
> 
> 时间：2012-05-02T17:53:52.283
> 
> 标签：scala, plugins, compiler-construction

我正在编写一个 Scala 编译器插件，并且已经到了编写“apply（unit：CompilationUnit”方法）的地步。但是，该方法中的语法超出了我的范围。以下代码来自[http://www.scala-lang .org/node/140](http://www.scala-lang.org/node/140)

```
 for ( tree @ Apply(Select(rcvr, nme.DIV), List(Literal(Constant(0)))) <- unit.body;
         if rcvr.tpe <:< definitions.IntClass.tpe) {
        unit.error(tree.pos, "definitely division by zero")
      } 
```

此表达式查找所有除以零。我不知道如何做类似的事情来查找所有可执行语句（TermTrees??）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-02T19:28:09.610

好的，假设文件`TwoStatements.scala`如下：

```
class TwoStatements {
  def f {
    println("first statement")
    println("second statement")
  }
} 
```

试试这些命令：

```
scalac -Yshow-trees -Xprint:typer TwoStatements.scala 
scalac -Yshow-trees-compact -Xprint:typer TwoStatements.scala 
scalac -Yshow-trees-stringified -Xprint:typer TwoStatements.scala 
scalac -Ybrowse:typer TwoStatements.scala 
```

请注意，这*是*它将产生输出`typer`的阶段。因此，请选择适合您自己的插件运行的阶段的阶段。

 *这`-Yshow-trees-compact`是产生与您将在自己的代码中使用的输出完全（或非常接近）的输出，但很难阅读。

其他的更容易阅读，但翻译成您自己的代码可能会令人困惑。可能会`-Yshow-trees-stringified`比 更有用`-Yshow-trees`，因为它显示的信息最多。另一方面，`-Ybrowse:typer`它是交互式的，并显示所选树节点的代码，这可能会有所帮助，尤其是在您查看较大的程序时。

如果您尝试`-Yshow-trees-compact`使用链接博客中的示例，您将看到以下代码段：

```
 Apply(
   Select(
     Select(This(newTypeName("Test")), newTermName("five")), // assigned to rcvr
     newTermName("$div")                                     // compared to nme.DIV
   ), 
   List(Literal(Constant(0))))                               // as is
 ) 
```

所以我的建议是，你在插件工作的阶段查看你想要处理的代码是如何被翻译成的，然后抓住片段，并用变量替换任何不感兴趣的部分。

你会注意到每个`DefDef`人都有身体作为它的第六个元素。它可能是一个`Block`带有`List`多个语句的一个，它可能是一个方法调用（`Apply`）、一个getter（`Select`）、一个赋值（`Assign`）、一个if语句（`If`）等等。其他类型的声明，例如`ValDef`，也有与之关联的代码。

如果您正在寻找类似的东西`tree @ Statement(...)`，它不存在。您可以使用[`TermTree`](http://www.scala-lang.org/archives/downloads/distrib/files/nightly/docs/library/index.html#scala.reflect.api.Trees%24TermTree)（或者更好的是 method `isTerm`）来识别代表代码的事物，但这不会让您将语句与表达式的部分或完整块区分开来。

查看实际代码的 AST，并了解它是如何工作的。

**编辑**

观看[演示文稿](http://scalamacros.org/news/2012/04/28/metaprogramming-talk)让我想到了文件末尾的这条评论`scala/reflecti/api/Trees.scala`：

```
// A standard pattern match
  case EmptyTree =>
  case PackageDef(pid, stats) =>
     // package pid { stats }
  case ClassDef(mods, name, tparams, impl) =>
     // mods class name [tparams] impl   where impl = extends parents { defs }
  case ModuleDef(mods, name, impl) =>                             (eliminated by refcheck)
     // mods object name impl  where impl = extends parents { defs }
  case ValDef(mods, name, tpt, rhs) =>
     // mods val name: tpt = rhs
     // note missing type information is expressed by tpt = TypeTree()
  case DefDef(mods, name, tparams, vparamss, tpt, rhs) =>
     // mods def name[tparams](vparams_1)...(vparams_n): tpt = rhs
     // note missing type information is expressed by tpt = TypeTree()
  case TypeDef(mods, name, tparams, rhs) =>                       (eliminated by erasure)
     // mods type name[tparams] = rhs
     // mods type name[tparams] >: lo <: hi,  where lo, hi are in a TypeBoundsTree,
                                              and DEFERRED is set in mods
  case LabelDef(name, params, rhs) =>
     // used for tailcalls and like
     // while/do are desugared to label defs as follows:
     // while (cond) body ==> LabelDef($L, List(), if (cond) { body; L$() } else ())
     // do body while (cond) ==> LabelDef($L, List(), body; if (cond) L$() else ())
  case Import(expr, selectors) =>                                 (eliminated by typecheck)
     // import expr.{selectors}
     // Selectors are a list of pairs of names (from, to).
     // The last (and maybe only name) may be a nme.WILDCARD
     // for instance
     //   import qual.{x, y => z, _}  would be represented as
     //   Import(qual, List(("x", "x"), ("y", "z"), (WILDCARD, null)))
  case Template(parents, self, body) =>
     // extends parents { self => body }
     // if self is missing it is represented as emptyValDef
  case Block(stats, expr) =>
     // { stats; expr }
  case CaseDef(pat, guard, body) =>                               (eliminated by transmatch/explicitouter)
    // case pat if guard => body
  case Alternative(trees) =>                                      (eliminated by transmatch/explicitouter)
    // pat1 | ... | patn
  case Star(elem) =>                                              (eliminated by transmatch/explicitouter)
    // pat*
  case Bind(name, body) =>                                        (eliminated by transmatch/explicitouter)
    // name @ pat
  case UnApply(fun: Tree, args)                                   (introduced by typer, eliminated by transmatch/explicitouter)
    // used for unapply's
  case ArrayValue(elemtpt, trees) =>                              (introduced by uncurry)
    // used to pass arguments to vararg arguments
    // for instance, printf("%s%d", foo, 42) is translated to after uncurry to:
    // Apply(
    //   Ident("printf"),
    //   Literal("%s%d"),
    //   ArrayValue(<Any>, List(Ident("foo"), Literal(42))))
  case Function(vparams, body) =>                                 (eliminated by lambdaLift)
    // vparams => body  where vparams:List[ValDef]
  case Assign(lhs, rhs) =>
    // lhs = rhs
  case AssignOrNamedArg(lhs, rhs) =>                              (eliminated by typer, resurrected by reifier)
    // @annotation(lhs = rhs)
  case If(cond, thenp, elsep) =>
    // if (cond) thenp else elsep
  case Match(selector, cases) =>
    // selector match { cases }
  case Return(expr) =>
    // return expr
  case Try(block, catches, finalizer) =>
    // try block catch { catches } finally finalizer where catches: List[CaseDef]
  case Throw(expr) =>
    // throw expr
  case New(tpt) =>
    // new tpt   always in the context: (new tpt).<init>[targs](args)
  case Typed(expr, tpt) =>                                        (eliminated by erasure)
    // expr: tpt
  case TypeApply(fun, args) =>
    // fun[args]
  case Apply(fun, args) =>
    // fun(args)
    // for instance fun[targs](args)  is expressed as  Apply(TypeApply(fun, targs), args)
  case ApplyDynamic(qual, args)                                   (introduced by erasure, eliminated by cleanup)
    // fun(args)
  case Super(qual, mix) =>
    // qual.super[mix]     qual is always This(something), if mix is empty, it is tpnme.EMPTY
  case This(qual) =>
    // qual.this
  case Select(qualifier, selector) =>
    // qualifier.selector
  case Ident(name) =>
    // name
    // note: type checker converts idents that refer to enclosing fields or methods
    // to selects; name ==> this.name
  case ReferenceToBoxed(ident) =>                                 (created by typer, eliminated by lambdalift)
    // synthetic node emitted by macros to reference capture vars directly without going through ``elem''
    // var x = ...; fun { x } will emit Ident(x), which gets transformed to Select(Ident(x), "elem")
    // if ReferenceToBoxed were used instead of Ident, no transformation would be performed
  case Literal(value) =>
    // value
  case TypeTree() =>                                              (introduced by refcheck)
    // a type that's not written out, but given in the tpe attribute
  case Annotated(annot, arg) =>                                   (eliminated by typer)
    // arg @annot  for types,  arg: @annot for exprs
  case SingletonTypeTree(ref) =>                                  (eliminated by uncurry)
    // ref.type
  case SelectFromTypeTree(qualifier, selector) =>                 (eliminated by uncurry)
    // qualifier # selector, a path-dependent type p.T is expressed as p.type # T
  case CompoundTypeTree(templ: Template) =>                       (eliminated by uncurry)
    // parent1 with ... with parentN { refinement }
  case AppliedTypeTree(tpt, args) =>                              (eliminated by uncurry)
    // tpt[args]
  case TypeBoundsTree(lo, hi) =>                                  (eliminated by uncurry)
    // >: lo <: hi
  case ExistentialTypeTree(tpt, whereClauses) =>                  (eliminated by uncurry)
    // tpt forSome { whereClauses } 
```*

# java - 我怎样才能阅读网页的内容，而不是该网页的源代码？

> ID：10419103
> 
> 赞同：-5
> 
> 时间：2012-05-02T17:53:54.147
> 
> 标签：java, html, url

> **可能重复：**
> [如何使用 translate.google.com/ 翻译 Java 程序中的字符串？](https://stackoverflow.com/questions/10412453/how-can-i-use-http-translate-google-com-to-translate-the-string-in-java-progr)

我想阅读网页的内容，而不是该网页的源代码。内容意味着一些评论或一些行等。例如： http://translate.google.com/#en|bn| [I%20love%20life](http://translate.google.com/#en|bn|I%20love%20life)。

从这个页面，我想收集翻译行“আমি জীবন ভালবাসি”我如何在 JAVA 中获得这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T17:58:04.270

但是您确实想阅读源代码的内容，因为它包含您要查找的内容..

```
<span id="result_box" class="short_text" lang="bn"><span class="hps">আমি&lt;/span></span> 
```

这是包含翻译内容的节点...如果您可以构建包含未翻译字符串的 url，捕获对该 url 的响应，然后找到#result_box，您将拥有您的内容

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T17:58:06.823

我相信您可以通过[`HtmlUnit`](http://htmlunit.sourceforge.net/). 看方法[`DomNode#asText()`](http://htmlunit.sourceforge.net/apidocs/com/gargoylesoftware/htmlunit/html/DomNode.html#asText%28%29)。

# c# - 编辑嵌套对象时，Dataform OK/SAVE 按钮保持禁用状态

> ID：10419105
> 
> 赞同：1
> 
> 时间：2012-05-02T17:53:58.793
> 
> 标签：c#, wpf, silverlight, xaml, dataform

我一直在使用工具包中的 DataForm，现在我意识到 IEditableObject 接口显然存在问题。绑定到具有 2 个子对象的对象的数据表单。父对象和 2 个子对象的所有字段都在同一个表单上。当我从父对象修改数据字段时，“确定”按钮变为启用状态，但是当我使用子对象中的 3 个字段中的 2 个时，“确定”按钮保持禁用状态。我试图调查这些领域之间的差异，它们似乎都是一样的，有人面临同样的问题吗？

在下面的示例中，字段 NumberWrapper 和 LabelWrapper 属于父对象，然后 Stc1Wrapper 是一个对象，它是父对象的一部分，字段标签会触发确定按钮，但电话号码和转移代码字段不会。Stc1Wrapper 的 3 个字段的底层实现看起来都相同。我被困在这里我找不到有关此数据表单控件的正确 MSDN 文档，因为它来自不幸的工具包。

```
<toolkit:DataForm Grid.Column="1" 
                          Margin="0,94,0,0" 
                          Width="350"
                          Name="EsnDataForm" 
                          Header="Esn Item"
                          AutoGenerateFields="False" 
                          CurrentItem="{Binding ElementName=MyGrid, Path=SelectedItem,Mode=TwoWay}" 
                          AutoEdit="False" 
                          AutoCommit="False"
                          CommandButtonsVisibility="Cancel,Edit,Commit"
                          CommitButtonContent="Save"
                          CancelButtonContent="Cancel">
            <toolkit:DataForm.NewItemTemplate>
                <DataTemplate>
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="32" />
                            <RowDefinition Height="32" />
                            <RowDefinition Height="32" />
                            <RowDefinition Height="32" />
                        </Grid.RowDefinitions>
                        <toolkit:DataField Label="Number" IsReadOnly="True" >
                            <TextBox Text="{Binding NumberWrapper,Mode=TwoWay}" MaxLength="9" Width="120" IsReadOnly="True" />
                        </toolkit:DataField>
                        <toolkit:DataField Label="Label" Grid.Row="1" >
                            <TextBox Name="NameBox" Text="{Binding LabelWrapper,Mode=TwoWay}" MaxLength="32" Width="120" />
                        </toolkit:DataField>
                        <toolkit:DataField Label="Sub Label" Grid.Row="2" >
                            <TextBox Name="SubLabelBox" Text="{Binding PrimaryPsapLabelWrapper,Mode=TwoWay}" MaxLength="32" Width="120" />
                        </toolkit:DataField><toolkit:DataField Label="Label" Margin="-50,1,1,1" >
                            <TextBox Name="Stc1LabelBox" Text="{Binding Stc1Wrapper.LabelWrapper, Mode=TwoWay}" MaxLength="32" Width="120" />
                        </toolkit:DataField>
                        <toolkit:DataField Label="Telephone Number" Margin="-50,1,1,1" >
                            <TextBox Name="Stc1TelephoneBox" Text="{Binding Stc1Wrapper.TnWrapper, Mode=TwoWay}" MaxLength="10" Width="120" />
                        </toolkit:DataField>
                        <toolkit:DataField Label="Transfer Code" Margin="-50,1,1,1" >
                            <TextBox Name="Stc1TransferCodeBox" Text="{Binding Stc1Wrapper.TransferCodeWrapper, Mode=TwoWay}" Width="120" />
                        </toolkit:DataField>
                    [...]

    /// <remarks/>
    [System.Xml.Serialization.XmlIgnore]
    public string TransferCodeWrapper
    {
        get
        {
            return this.TransferCode;
        }
        set
        {
            ValidateRequired("TransferCodeWrapper", value, "Transfer Code is mandatory");
            ValidateRegularExpression("TransferCodeWrapper", value, @"^[\*]\d{1,3}$", "The format should be * followed by 1 to 3 digits");
            this.TransferCode = value;
            this.RaisePropertyChanged("TransferCodeWrapper");
        }
    }

    /// <remarks/>
    [System.Xml.Serialization.XmlIgnore]
    public string TnWrapper
    {
        get
        {
            return this.Tn;
        }
        set
        {
            ValidateRequired("TnWrapper", value, "Telephone number is mandatory when Type is Telephone Number");
            ValidateRegularExpression("TnWrapper", value, @"^\d{10}$", "The telephone number should be 10 digits");
            this.Tn = value;
            this.RaisePropertyChanged("TnWrapper");
        }
    }

    /// <remarks/>
    [System.Xml.Serialization.XmlIgnore]
    public string LabelWrapper
    {
        get
        {
            return this.Label;
        }
        set
        {
            ValidateRequired("LabelWrapper", value, "Label is required");
            ValidateRegularExpression("LabelWrapper", value, @"^[\w-_ ]$+", "Characters allowed (a-z,A-Z,0-9,-,_, )");
            this.Label = value;
            this.RaisePropertyChanged("LabelWrapper");
        }
    } 
```

# c# - 检查一个字符串上的多个包含

> ID：10419106
> 
> 赞同：13
> 
> 时间：2012-05-02T17:53:59.247
> 
> 标签：c#, string, contains

所以我有一个目前看起来像这样的条件......

```
if (input.Contains(",") || input.Contains("/") || input.Contains(@"\") || input.Contains(".")) 
```

我需要添加更多要检查的字符，并且想知道是否有更简洁的语法来完成同样的事情？类似于 SQL 的 IN 运算符？

```
if ( input IN (",", "/", @"\", ....etc )  ) 
```

有人知道在不添加大量代码的情况下完成此任务的任何酷技巧吗？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-05-02T17:55:59.403

考虑使用正则表达式（在括号中指定要检查的字符 - 请记住其中一些必须转义）：

```
Regex.IsMatch(input, @"[,/]"); 
```

或者

```
new[] {",", "/"}.Any(input.Contains) 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-05-02T17:57:35.297

这个怎么样？

```
 if(input.IndexOfAny(new char[] { ',', '/', '\\', '.' })>=0)
    {

    } 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-05-02T18:04:54.347

这是否以最短时间获胜？

```
@".,/\".Any(input.Contains) 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-04-11T18:55:03.243

```
"asdfasdf".ContainsAny(".","/","4");

public static bool ContainsAny(this string stringToCheck, params string[] parameters)
{
    return parameters.Any(parameter => stringToCheck.Contains(parameter));
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-05-02T17:58:29.253

尝试

```
If (input.IndexOfAny(new char[] { ',', '/', '\\', '.' }) >= 0) {
    ...
} 
```

或者

```
If (input.IndexOfAny(@",/\.".ToCharArray()) >= 0) {
    ...
} 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-05-02T17:58:53.887

你可以使用一些Linq：

```
if ( ",/\\.".ToCharArray().Any( c => input.Contains( c ) ) ) 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-05-02T17:59:05.640

您可以使用 String.IndexOfAny - 它会扫描字符串以查找数组中的一组字符中的任何一个：

```
if (e.Label.IndexOfAny(new char[]{',', '/', @'\', '.' /* other chars here */}) > -1) 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-08-29T11:50:40.323

扩展方法可以使事情看起来很干净。看看以下内容。

```
 public static bool ContainsChar(this string input, params char[] characters)
        {
            foreach (var character in characters)
            {
                if (input.Contains(character))
                {
                    return true;
                }
            }
            return false;
        } 
```

该方法的参数是可变参数，因此您可以添加任意数量的字符，用逗号分隔。如果您不习惯使用扩展方法，请修改为以下内容：

```
public static bool ContainsChar(string input, params char[] characters)
            {
                foreach (var character in characters)
                {
                    if (input.Contains(character))
                    {
                        return true;
                    }
                }
                return false;
            } 
```

示例用法如下：

```
string myString = "this is my string";
//extension
if (myString.ContainsChar('.', '*', '%')) //do something

//static method
if (ContainsChar(myString, '.', '*', '%')) //do something 
```

# c - c解释前序二叉树遍历

> ID：10419107
> 
> 赞同：0
> 
> 时间：2012-05-02T17:54:00.050
> 
> 标签：c, syntax

好的，我想知道我在这段代码中所做的以下评论。谢谢，

```
void visit(tree_t *t){
    printf("%c ", t->e + 'A'); // why t->e + 'A', and not just t->e?
}

void tree_preorder(tree_t *t, void (*visit)(tree_t *)){ // i just don't know the parameter void (*visit)(tree_t *). what exactly is (*visit)(tree_t *)?
    if (!t) return; // what's the condition (!t)?
    visit(t);
    tree_preorder(t->l, visit);
    tree_preorder(t->r, visit);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T18:03:51.080

这是三个问题的总结。

```
printf("%c ", t->e + 'A'); // why t->e + 'A', and not just t->e? 
```

这是一个ascii表假设。

这会将字符移动 0x41 (65)。因此，如果您有一棵 int 范围为 0 - 25 的树，则可以打印出 A - Z 的有效字符

```
(*visit)(tree_t *) 
```

这是一个函数指针。它将在每个节点上调用

```
// what's the condition (!t)? 
```

这是一个空检查，以确保您不在树结构中的叶节点处。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T17:58:21.213

t->e 可能在 0-26 范围内。通过算术添加'A'字符，你得到'A'代表0，'B'代表1，等等。

`void (*visit)(tree_t *)` 参数是一个函数指针，指向一个将`tree_t`指针作为参数并返回 void 的函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T17:58:24.183

```
void (*visit)(tree_t *) 
```

是一个指向函数的指针，它不返回任何内容，并将指针`tree_t`作为单独的参数。

```
!t 
```

是检查指向 的指针的最优选方法之一`NULL`。这意味着您已到达树中的叶节点，您需要停止递归（[基本情况](http://www.wisegeek.com/what-is-a-recursive-call.htm)）。

的添加`'A'`可能类似于我们在

```
if (isdigit(ch))
    ch = ch-'0'; 
```

# php - 发现 MySQL 中自动增量列的最后插入 ID

> ID：10419109
> 
> 赞同：2
> 
> 时间：2012-05-02T17:54:02.557
> 
> 标签：php, mysql

我目前正在使用：

```
SELECT MAX(id) FROM table 
```

发现某个表的当前id，但我听说这会带来不好的结果。这样做的正确方法是什么？请注意，在该查询之前我没有插入或删除任何内容。我只想知道当前的 ID，而不需要事先 INSERT 或 DELETE。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T18:00:32.037

执行以下 SQL：

> 显示表状态，如“表名”

然后检查字段 AUTO_INCREMENT

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T14:33:58.607

您可以使用以下查询：

```
SELECT id FROM table ORDER BY id DESC LIMIT 1; 
```

# asp.net - 在 appSettings 中存储字符串数组？

> ID：10419116
> 
> 赞同：31
> 
> 时间：2012-05-02T17:54:31.107
> 
> 标签：asp.net, .net, web-config, app-config, asp.net-4.0

我想将一维字符串数组作为条目存储在我的`appSettings`. 我不能简单地用`,`or分隔元素，`|`因为元素本身可能包含这些字符。

我正在考虑存储数组，`JSON`然后使用`JavaScriptSerializer`.

有没有“正确”/更好的方法来做到这一点？

（我的`JSON`想法感觉有点hacky）

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-05-02T18:10:09.140

您可以将 AppSettings 与[`System.Collections.Specialized.StringCollection`](http://msdn.microsoft.com/en-us/library/system.collections.specialized.stringcollection.aspx).

```
var myStringCollection = Properties.Settings.Default.MyCollection;
foreach (String value in myStringCollection)
{ 
    // do something
} 
```

每个值由一个新行分隔。

这是一个屏幕截图（德国IDE，但无论如何它可能会有所帮助）

![在此处输入图像描述](../Images/c43d026e2550a45a1918d4e7146df826.png)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2016-12-06T14:05:18.247

对于字符串很容易，只需将以下内容添加到您的`web.config`文件中：

```
<add key="myStringArray" value="fred,Jim,Alan" /> 
```

然后您可以将值检索到数组中，如下所示：

```
var myArray = ConfigurationManager.AppSettings["myStringArray"].Split(','); 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2015-01-15T10:54:28.933

对于整数，我发现以下方法更快。

首先，在 app.config 中创建一个 appSettings 键，其整数值用逗号分隔。

```
<add key="myIntArray" value="1,2,3,4" /> 
```

然后使用 LINQ 将值拆分并转换为 int 数组

```
int[] myIntArray =  ConfigurationManager.AppSettings["myIntArray"].Split(',').Select(n => Convert.ToInt32(n)).ToArray(); 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2020-07-30T14:16:09.130

ASP.Net Core 支持它绑定字符串或对象列表。

对于前面提到的字符串，可以通过`AsEnumerable()`.

或通过`Get<List<MyObject>>()`. 示例如下。

`appsettings.json`：

```
{
 ...
   "my_section": {
     "objs": [
       {
         "id": "2",
         "name": "Object 1"
       },
       {
         "id": "2",
         "name": "Object 2"
       }
     ]
   }
 ...
} 
```

表示对象的类

```
public class MyObject
{
    public string Id { get; set; }
    public string Name { get; set; }
} 
```

要从中检索的代码`appsettings.json`

```
Configuration.GetSection("my_section:objs").Get<List<MyObject>>(); 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-05-02T18:39:52.130

您也可以考虑为此目的使用自定义配置部分/集合。这是一个示例：

```
<configSections>
    <section name="configSection" type="YourApp.ConfigSection, YourApp"/>
</configSections>

<configSection xmlns="urn:YourApp">
  <stringItems>
    <item value="String Value"/>
  </stringItems>
</configSection> 
```

您还可以查看这个出色[的 Visual Studio 插件，](https://github.com/hybridview/ConfigurationSectionDesigner)它允许您以图形方式设计 .NET 配置部分并自动为它们生成所有必需的代码和架构定义 (XSD)。

# c# - 如何从 asp.net 中的 ChangePassword 控件中删除“当前/旧密码”部分？

> ID：10419123
> 
> 赞同：3
> 
> 时间：2012-05-02T17:55:39.090
> 
> 标签：c#, asp.net, asp.net-membership, membership-provider

如何从 asp.net 中的 ChangePassword 控件中删除“当前/旧密码”部分。当我删除此部分时，出现以下错误。

*ChangeUserPassword：ChangePasswordTemplate 不包含 ID CurrentPassword 用于当前密码的 IEditableTextControl。*

我只需要“新密码”和“确认新密码”部分

**编辑*_* _ __ *_* __ *_* __ *_* __ *_* __ *_* __ *_* __ *_***

```
<asp:ChangePassword ID="ChangeUserPassword" runat="server" EnableViewState="false"
        RenderOuterTable="false">

        <ChangePasswordTemplate>        
            <span class="failureNotification">
                <asp:Literal ID="FailureText" runat="server"></asp:Literal>
            </span>
            <asp:ValidationSummary ID="ChangeUserPasswordValidationSummary" runat="server" CssClass="failureNotification"
                ValidationGroup="ChangeUserPasswordValidationGroup" />
            <div class="accountInfo">
                <fieldset class="changePassword">
                    <legend>Account Information</legend>
                    <%--<p>
                        <asp:Label ID="CurrentPasswordLabel" runat="server" AssociatedControlID="CurrentPassword">Old Password:</asp:Label>
                        <asp:TextBox ID="CurrentPassword" runat="server" CssClass="passwordEntry" TextMode="Password"></asp:TextBox>
                        <asp:RequiredFieldValidator ID="CurrentPasswordRequired" runat="server" ControlToValidate="CurrentPassword"
                            CssClass="failureNotification" ErrorMessage="Password is required." ToolTip="Old Password is required."
                            ValidationGroup="ChangeUserPasswordValidationGroup">*</asp:RequiredFieldValidator>
                    </p>--%>
                    <p>
                        <asp:Label ID="NewPasswordLabel" runat="server" AssociatedControlID="NewPassword">New Password:</asp:Label>
                        <asp:TextBox ID="NewPassword" runat="server" CssClass="passwordEntry" TextMode="Password"></asp:TextBox>
                        <asp:RequiredFieldValidator ID="NewPasswordRequired" runat="server" ControlToValidate="NewPassword"
                            CssClass="failureNotification" ErrorMessage="New Password is required." ToolTip="New Password is required."
                            ValidationGroup="ChangeUserPasswordValidationGroup">*</asp:RequiredFieldValidator>
                    </p>
                    <p>
                        <asp:Label ID="ConfirmNewPasswordLabel" runat="server" AssociatedControlID="ConfirmNewPassword">Confirm New Password:</asp:Label>
                        <asp:TextBox ID="ConfirmNewPassword" runat="server" CssClass="passwordEntry" TextMode="Password"></asp:TextBox>
                        <asp:RequiredFieldValidator ID="ConfirmNewPasswordRequired" runat="server" ControlToValidate="ConfirmNewPassword"
                            CssClass="failureNotification" Display="Dynamic" ErrorMessage="Confirm New Password is required."
                            ToolTip="Confirm New Password is required." ValidationGroup="ChangeUserPasswordValidationGroup">*</asp:RequiredFieldValidator>
                        <asp:CompareValidator ID="NewPasswordCompare" runat="server" ControlToCompare="NewPassword"
                            ControlToValidate="ConfirmNewPassword" CssClass="failureNotification" Display="Dynamic"
                            ErrorMessage="The Confirm New Password must match the New Password entry." ValidationGroup="ChangeUserPasswordValidationGroup">*</asp:CompareValidator>
                    </p>
                </fieldset>
                <p class="submitButton">
                    <%--<asp:Button ID="CancelPushButton" runat="server" CausesValidation="False" CommandName="Cancel" Text="Cancel"/>--%>
                    <a href="Default.aspx" title="Back">&lt;&lt;Back</a>
                    <asp:Button ID="ChangePasswordPushButton" runat="server" Text="Change Password" 
                        ValidationGroup="ChangeUserPasswordValidationGroup" 
                        onclick="ChangePasswordPushButton_Click" />
                </p>
            </div>
        </ChangePasswordTemplate>
    </asp:ChangePassword> 
```

# c# - 使用 asp.net 3.5 将数据与 3d 柱面图绑定

> ID：10419125
> 
> 赞同：0
> 
> 时间：2012-05-02T17:55:57.887
> 
> 标签：c#, asp.net, charts, asp.net-3.5, mschart

我的数据：

> **Product_C** ====== **Product_B** ====== **product_A** ======第 124 个**月**
> =========== 101============== 60 ============= 2 月
> 123=============99================ 59===== =========3月
> 130============ 100============= 70============= =四月

*是否清楚* ;-) *?**
aspx 代码：

```
<asp:CHART id="Chart1" runat="server">
<series>
    <asp:Series ChartArea="ChartArea1" Name="product_A" >
</asp:Series>
<asp:Series ChartArea="ChartArea1" Name="product_B">
    </asp:Series>
    <asp:Series ChartArea="ChartArea1" Name="product_C">
    </asp:Series>
    </series>
<chartareas>
  <asp:ChartArea Name="ChartArea1" > </asp:ChartArea> </chartareas>
</asp:CHART> 
```

绑定代码：

```
 private void BindMyChart(int firstMonth,int lastMonth )
        {
      dsDataset myDataset = new dsDataset();
      bsHelper myObj =   new   bsHelper();
      myDataset = myObj.GetCompareSalesByMonths(firstMonth,lastMonth);
      if(myDataset.myTable.Rows.Count>0)
        {
            Chart1.DataSource = myDataset.myTable;// 
            DataView dv = myDataset.myTable.DefaultView;
            Chart1.Series["product_A"].Points.DataBindXY(dv,"Product_A",dv, "month");
            Chart1.Series["product_B"].Points.DataBindXY(dv, "Product_B",dv, "month");
            Chart1.Series["product_C"].Points.DataBindXY(dv, "Product_C",dv, "month" );
            Chart1.DataBind();
         }
      }

protected void Page_Load(object sender, EventArgs e)
{

            if (!IsPostBack)
            {
         BindMyChart(Convert.ToInt32(ddlfirstMonth.SelectedValue),
               Convert.ToInt32(ddllastMonth.SelectedValue));//drop down lists
            }
} 
```

web.config：

```
 <assemblies><add assembly="System.Web.DataVisualization, 
     Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/></assemblies>
   <httpHandlers>
    <add path="ChartImg.axd" verb="GET,HEAD"      type="System.Web.UI.DataVisualization.Charting.ChartHttpHandler,      System.Web.DataVisualization, Version=3.5.0.0, Culture=neutral,     PublicKeyToken=31bf3856ad364e35"   validate="false"/>
  </httpHandlers>
  <handlers>
  <add name="ChartImageHandler" preCondition="integratedMode" verb="GET,HEAD" path="ChartImg.axd"   type="System.Web.UI.DataVisualization.Charting.ChartHttpHandler, System.Web.DataVisualization,   Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"/>  </handlers> 
```

它应该如下图所示： ![chart_required](../Images/d0ebc71cac0ba7b65219b0d57a91f474.png)
但是，我得到一个空的空白图表！
该方法`myDataset = myObj.GetCompareSalesByMonths(firstMonth,lastMonth);`返回所需的数据。

# android - 如何为 1.6 和 3.0+ 提供不同的 android 小部件？

> ID：10419127
> 
> 赞同：6
> 
> 时间：2012-05-02T17:56:01.937
> 
> 标签：android, android-widget, android-3.0-honeycomb

我的目标是 1.6，但如果用户在 3.0 以上的设备上，我希望有一个可以使用 stackview 和 Android SDK 为小部件提供的其他改进的漂亮小部件。和 1.6-2.3/ 上的普通小部件

我应该怎么做这两个版本的小部件？

非常感谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-02T18:07:21.553

我的建议：

创建两个版本的应用小部件并使用资源值方法启用/禁用。

在 res/values/bools.xml 中：

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <bool name="atLeastHoneycomb">false</bool>
    <bool name="notHoneycomb">true</bool>
</resources> 
```

在 res/values-v11/bools.xml 中：

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <bool name="atLeastHoneycomb">true</bool>
    <bool name="notHoneycomb">false</bool>
</resources> 
```

在 AndroidManifest.xml 中：

```
<receiver android:name="MyOldAppWidgetProvider"
          android:enabled="@bool/notHoneycomb">

    <intent-filter>
        <action android:name="android.appwidget.action.APPWIDGET_UPDATE" />
    </intent-filter>
    <meta-data android:name="android.appwidget.provider"
               android:resource="@xml/example_oldappwidget_info" />
</receiver>

<receiver android:name="MyNewAppWidgetProvider"
          android:enabled="@bool/atLeastHoneycomb">

    <intent-filter>
        <action android:name="android.appwidget.action.APPWIDGET_UPDATE" />
    </intent-filter>
    <meta-data android:name="android.appwidget.provider"
               android:resource="@xml/example_newappwidget_info" />
</receiver> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-02T18:03:03.653

您可以`res`通过添加后缀（如`-v11`.

例如，假设您的布局名为`main.xml`. 您可以将 1.6 - 2.3`main.xml`文件放在`layout`文件夹中，然后将`main.xml`包含新小部件的新花哨文件放入文件`layout-v11`夹中。使用 Honeycomb 及更高版本时，`-v11`当您引用文件时，将选择文件夹中的布局，例如`R.layout.main`.

从那里，您可以在活动中使用一些逻辑来检查新的小部件对象是否存在（或仅检查[Build.VERSION](http://developer.android.com/reference/android/os/Build.VERSION.html)类）并相应地进行分支。

有关这方面的更多详细信息，请查看 Android 文档中的[限定符名称规则](http://developer.android.com/guide/topics/resources/providing-resources.html#QualifierRules)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-02T18:02:25.700

您可以检查设备 api 版本，例如：

`int apiLevel = android.os.Build.VERSION.SDK_INT;`

从 apiLevel ，您可以使用 if-else 为不同的 api/ 加载不同的布局/视图

# php - Drupal - 通过URL获取节点的正文？

> ID：10419131
> 
> 赞同：0
> 
> 时间：2012-05-02T17:56:10.807
> 
> 标签：php, drupal, caching

我正在尝试创建一个函数来根据给定的 URL 仅检索和显示 Drupal 节点的 Body 字段。

目前，我已经扩展了标准 Drupal RSS 的功能来做一个检测方法。如果您输入以下 url，就会发生这种情况： [http :](http://mysite.com/rss.xml/) **//mysite.com/rss.xml/page=54**

最后一部分很关键——它告诉从哪个节点 ID 加载。就代码而言，我已经修改了 /modules/node/node.module 中的 node_feed() 函数来执行以下操作：

```
if (stristr($nids, 'page=') !== FALSE) {
 $nid = substr($nids, stripos($nids, 'page=') + 5);
 $result = NULL;

 if ((string)(int)$nid === $nid) {
  $result = db_result(db_query("SELECT `nid` FROM {node} WHERE `nid` = %s AND `type` =  'flashnode'", $nid));
 }

 if ($result) {
   $item = node_load($result);
   print($item->body);
 }
 exit;
} 
```

虽然这**可行**，但我们担心它有两个原因：

1）结果缓存吗？这是一个非常繁重的页面，会被调用很多。

2）有没有**“官方”**的方式来做到这一点？一个使用带有缓存的模块，而不是半hacky的解决方法？

提前感谢您的任何指导。-汤姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T20:41:45.207

您绝对不应该破解 RSS 提要以创建返回节点正文的 URL。您应该创建一个非常简单的自定义模块：[http ://drupal.org/developing/modules](http://drupal.org/developing/modules)

Drupal 模块系统允许您设置一个 url，以便`/fetch_body/1234`使用 $nid=1234 作为参数调用 fetch_body() 函数。至于缓存，您的自定义模块中有很多选项。最明显的是使用 cache_get() 和 cache_set() 根据节点 ID 自行进行简单的缓存。

您使用的是什么版本的 Drupal？我强烈推荐这本书 Pro Drupal Development，只要确保获得与您的 drupal 版本相匹配的版本。

# php - 去掉最后一个逗号

> ID：10419136
> 
> 赞同：-4
> 
> 时间：2012-05-02T17:56:38.507
> 
> 标签：php, string

> **可能重复：**
> [删除 PHP 中的最后一个逗号？](https://stackoverflow.com/questions/7376171/removing-last-comma-in-php)
> [从字符串中删除最后一个逗号（PHP / Wordpress）](https://stackoverflow.com/questions/7608078/remove-the-last-comma-from-a-string-php-wordpress)

我的代码由于某种原因不起作用。我想要做的是从结果中去掉最后一个逗号，但它不起作用。这是代码

```
 <?php do { 
  $activity_user_first_name = $row_product_activity['user_first_name'];
  $activity_user_last_name = $row_product_activity['user_last_name'];
  $name = '<a href="">'.$activity_user_first_name.' '.$activity_user_last_name.'</a>, ';
  echo rtrim($name, ",");
 } while($row_product_activity = mysql_fetch_assoc($product_activity)) ?> like this 
```

所以我想要得到的结果是这样的

```
Steve Jobs, Bill Gates, Sergey Brin, Larry Page like this 
```

相反，我得到了这个

```
Steve Jobs, Bill Gates, Sergey Brin, Larry Page, like this 
```

所以我希望删除拉里佩奇之后的逗号或末尾的任何其他名称。我尝试了许多其他选项，但没有如我所愿。任何建议，将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-02T18:03:04.003

我认为更好的解决方案是首先构造没有尾随逗号的字符串。将每个名称的链接放入一个数组槽中，然后只回显一些内爆结果。

```
<?php 
    $names=array();
    do { 
        $activity_user_first_name = $row_product_activity['user_first_name'];
        $activity_user_last_name = $row_product_activity['user_last_name'];
        $names[] = '<a href="#">'.$activity_user_first_name.' '.$activity_user_last_name.'</a>';
    } while($row_product_activity = mysql_fetch_assoc($product_activity));

    echo implode(', ', $names);    

?> Like This 
```

# php - 在php中使用用户名或电子邮件地址登录

> ID：10419137
> 
> 赞同：7
> 
> 时间：2012-05-02T17:56:51.427
> 
> 标签：php, mysql

我正在尝试使用用户名或电子邮件创建登录

我的代码是：

```
$username=$_REQUEST['login'];
$email=$_REQUEST['login'];
$password=$_REQUEST['password'];

if($username && $password) {
  $query="select * from  user_db where username='$username'  and password='$password'";
} else if ($email && $password) {
  $query="select * from  user_db where email='$email' and password='$password'";
} 
```

使用用户名登录成功，但使用电子邮件登录无效。请帮我！

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-05-02T18:03:48.993

电子邮件和用户名的登录参数相同。如果您有一个接受任一登录框的登录框，则并非完全不正确。

如果您不确定它是电子邮件还是用户名，您可以将条件放在查询本身中。

```
$login=$_REQUEST['login'];
$query = "select * from  user_db where ( username='$login' OR email = '$login') and password='$password'" 
```

**编辑：** 如今，类似 PDO 的解决方案更受青睐，因为上述解决方案受到 SQL 注入的影响。逻辑保持不变，但你会让它看起来像这样：

```
$query = "
    SET @username = :username
    SELECT * FROM user_db
       WHERE ( username = @username OR email = @username) 
       AND password = :password
";

$statement = $pdoObject->prepare($query);
$statement->bindValue(":username", $login, PDO::PARAM_STR);
$statement->bindValue(":password", $password, PDO::PARAM_STR);
$statement->execute(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-02T18:01:03.593

您正在为两个变量设置相同的值，然后使用 if/else。两个 if 语句是等价的。

您需要确定是否`$_REQUEST[login]`包含有效的电子邮件地址，如果是，请使用数据库的电子邮件字段。否则，使用用户名字段。

此外，您不应该将变量直接放入查询中。使用准备好的语句。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-03-28T07:58:28.000

```
<?php
 require "connectdb.php";

$email =$_POST["email"];
$mobile =  $_POST["mobile"];
$password =$_POST["password"];

//Test variables
//$email = "admin@xyz.com";
//$mobile = "9876543210";
//$password ="@!b7885a$";

 $sql_query = "SELECT email FROM RegisterUser WHERE `email` LIKE '$email' OR `mobile` LIKE '$mobile' AND `password` LIKE '$password';";

 $result = mysqli_query($con,$sql_query);
 if(mysqli_num_rows($result) > 0 )
 {
 $row = mysqli_fetch_assoc($result);
 $email = $row["email"];
 echo "Login Successful...Welcome ".$email;
 }
 else
 {
 echo "Login Failed...Incorrect Email or Password...!";
 }
 ?> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-10-26T13:31:05.387

> 嗨，对我来说是这样的：
> 
> ```
> if ( !isset($_POST['emailuser'], $_POST['userPass']) ) {
>     // Could not get the data that should have been sent.
>     die ('Please fill both the username and password field!');
> }
> $emailuser = ($_POST['emailuser']);
> $emailuser = trim($emailuser);
> 
>     if ($stmt = $con->prepare('SELECT userEmail or userName, userPass FROM users WHERE userEmail = ? or userName = ?')) {
>    // Bind parameters (s = string, i = int, b = blob, etc), in our case the username is a string so we use "s"
>    $stmt->bind_param('ss', $emailuser, $emailuser);
>    $stmt->execute();
>    // Store the result so we can check if the account exists in the database.
>    $stmt->store_result();
> 
>    if ($stmt->num_rows > 0) {
>        $stmt->bind_result($userName, $userPass);
>        $stmt->fetch();
>        // Account exists, now we verify the password.
>        // Note: remember to use password_hash in your registration file to store the hashed passwords.
>        if (password_verify($_POST['userPass'], $userPass)) {
>            // Verification success! User has loggedin!
>            // Create sessions so we know the user is logged in, they basically act like cookies but remember the data on the server.
>            session_regenerate_id();
>            $_SESSION['loggedin'] = true;
>            $_SESSION['name'] = $emailuser;
>            $_SESSION['emailuser'] = $userName;
>            header('location: /menu.php');
>        } else {
>            echo 'Incorrect password!';
>        }
>    } else {
>        echo 'Incorrect username!';
>    }
>    $stmt->close();    } ?> 
> ```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-02T17:59:39.163

```
$username=$_REQUEST['login'];
$email=$_REQUEST['login']; 
```

这是错误的，您同时使用`$_REQUEST['login']`电子邮件和用户名。为什么不直接使用电子邮件？

如果`$_REQUEST['login']`没有电子邮件地址，当然这不会返回任何东西。

此外，除非字段为空，否则您的两个 if 语句都将始终执行。对？

退出登录，强制用户使用电子邮件地址登录。另外，取密码的md5。这些天谁存储原始密码？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-11-11T11:28:17.777

```
if (validate_username($username)) {
  $query="select * from  user_db where username='".$username".' and password='".validate_password($password)."'";
} else if (validate_email($email)) {
  $query="select * from  user_db where email='".$email."' and password='".validate_password($password)."'";
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-12-02T00:39:37.357

好吧，我知道这是一篇旧帖子，但我发现有些人仍然会查看它，所以我想提供一种简单的方法来允许电子邮件和用户名在同一个输入中

我的代码如下

```
 if
   (!preg_match("/^[_a-z0-9-]+(\.[_a-z0-9-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,3})$/", $name_of_same_input) )
  {
     $un_check = mysql_query("SELECT uname FROM eusers WHERE uname = '' ") or die(mysql_error());

     echo "loging in with username"; //code
  }
  elseif
   (preg_match("/^[_a-z0-9-]+(\.[_a-z0-9-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,3})$/", $name_of_same_input) )
  {
     $un_check = mysql_query("SELECT umail FROM eusers WHERE umail = '' ") or die(mysql_error());

     echo "loging in with email"; //code

  } 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2012-05-02T18:09:21.793

```
$username=$_REQUEST['username'];//I'm assuming your code here was wrong
$email=$_REQUEST['email'];//and that you have three different fields in your form 
$password=$_REQUEST['password'];

if (validate_username($username)) {
  $query="select * from  user_db where username='".$username".' and password='".validate_password($password)."'";
} else if (validate_email($email)) {
  $query="select * from  user_db where email='".$email."' and password='".validate_password($password)."'";
}

//... elsewhere...

function validate_username(&$username) {
  if (strlen($username) <= 1) { return false; }
  //return false for other situations
    //Does the username have invalid characters?
    //Is the username a sql injection attack?
  //otherwise...
  return true;
}

function validate_email(&$email) {
  //same deal as with username
}

function validate_password(&$password) {
  //same deal as with username
} 
```

请注意，如果您只有两个字段（登录名和密码），那么电子邮件和用户名之间的区别是没有意义的。进一步注意，您确实应该使用[PHP PDO](http://php.net/manual/en/book.pdo.php)来构建和执行查询，以防止安全漏洞并使您的生活更轻松。

# regex - 将字符串中的数字与字母和数字匹配

> ID：10419147
> 
> 赞同：0
> 
> 时间：2012-05-02T17:57:38.120
> 
> 标签：regex, perl

我需要编写一个 Perl 正则表达式来匹配包含字母和数字的单词中的数字。示例： `test123`。我想写一个只匹配数字部分的正则表达式并捕获它

我正在尝试这个`\S*(\d+)\S*` ，它只捕获 3 而不是 123。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-02T18:09:45.433

正则表达式原子将尽可能匹配。

最初，第一个`\S*`匹配“ `test123`”，但正则表达式引擎必须回溯以允许`\d+`匹配。结果是：

```
 +------------------- Matches "test12"
 |    +-------------- Matches "3"
 |    |    +--------- Matches ""
 |    |    |
---  ---  ---
\S* (\d+) \S* 
```

所有你需要的是：

```
my ($num) = "test123" =~ /(\d+)/; 
```

它将尝试在位置 0 匹配，然后在位置 1，......直到找到一个数字，然后它将匹配尽可能多的数字。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T18:04:05.337

您的`*`正则表达式中的 是贪婪的，这就是他们“吃”数字的原因。正如@Marc 所说，您不需要它们。

```
perl -e '$_ = "qwe123qwe"; s/(\d+)/$numbers=$1/e; print $numbers . "\n";' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-02T18:06:41.807

`"something122320" =~ /(\d+)/`将返回 122320；这可能是你想要做的;）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-02T18:07:57.977

`\S`匹配任何非空白字符，包括数字。你想要`\d+`：

```
my ($number) = 'test123' =~ /(\d+)/; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-02T19:55:08.200

如果是需要非数字的情况（例如*before*，根据您的示例），您可以使用以下*非贪婪*表达式：

```
/\w+?(\d+)/ or /\S+?(\d+)/ 
```

（第二个更符合您的`\S*`规范。）

你的表达式满足任何一个或多个数字的条件，这可能就是你想要的。它可以是由空格 ( `" 123 "`) 包围的一串数字，因为最后一个空格和第一个数字之间的边界满足零个或多个非空格，`'3'`对于后面的空格和下一个空格之间的边界也是如此。

您可能不需要任何规范，并且捕获字符串中的第一个数字就足够了。但如果不是，最好知道如何指定预期的模式。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-05-02T18:03:12.147

我认为括号表示捕获组，这正是您不想要的。删除它们。您正在寻找`/\d+/`或`/[0-9]+/`

# sql - 对 PostgreSQL 结果集的顺序进行条带化

> ID：10419152
> 
> 赞同：8
> 
> 时间：2012-05-02T17:58:09.497
> 
> 标签：sql, postgresql, sorting, sql-order-by

假设我有下表：

```
create temp table test (id serial, number integer);
insert into test (number) 
values (5), (4), (3), (2), (1), (0); 
```

如果我按数字降序排序，我得到：

```
select * from test order by number desc;
id | number
---+--------
 1 | 5
 2 | 4
 3 | 3
 4 | 2
 5 | 1
 6 | 0 
```

如果我按数字升序排序，我得到：

```
select * from test order by number asc;

6 | 0
5 | 1
4 | 2
3 | 3
2 | 4
1 | 5 
```

如何对订单进行条带化，使其在每行升序和降序之间交替？例如：

```
6 | 0   or   1 | 5
1 | 5        6 | 0
5 | 1        2 | 4
2 | 4        5 | 1
4 | 2        3 | 3
3 | 3        4 | 2 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-02T18:22:37.267

### 更新

```
WITH x AS (
    SELECT *
         , row_number() OVER (ORDER BY number) rn_up
         , row_number() OVER (ORDER BY number DESC) rn_down
    FROM   test
    )
SELECT id, number
FROM   x
ORDER  BY LEAST(rn_up, rn_down), number; 
```

或者：

```
...
ORDER  BY LEAST(rn_up, rn_down), number  DESC; 
```

从更大的数字开始。

一开始我有两个 CTE，但一个就足够了——更简单、更快。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-02T18:56:16.493

或者像这样（类似于已经给出的答案，但略短:)

```
WITH x AS (
    SELECT *, row_number() OVER (ORDER BY number) rn, count(*) over () as c
    FROM test
    )
SELECT id, number
FROM x 
ORDER BY ABS((c + 1.5) / 2 - rn) DESC; 
```

如果需要相反的顺序，那么它应该是

```
ORDER BY ABS((c + 0.5) / 2 - rn) DESC; 
```

# c# - 子报表参数未显示为水晶报表 2008 中链接的可选参数

> ID：10419155
> 
> 赞同：1
> 
> 时间：2012-05-02T17:58:15.760
> 
> 标签：c#, crystal-reports, asp.net-2.0

我有一个在 vs 2008 水晶报告中设计的水晶报告。有主报告和3个子报告。这些子报告中的每一个和主报告都具有由报告编号生成的信息，这些字段的名称不同，但是在三个子报告中的两个中，我能够将参数链接到我传入的主报告参数后面的代码。但是，当我链接第三个子报表时，使用的参数未显示在用于选择要链接的参数的下拉列表中。任何人都知道为什么会发生这种情况。

我有一种可怕的速记倾向，所以如果您需要更多信息，请告诉我，我会尽力回答。感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-04T11:51:00.647

确保您要链接的字段是相同的数据类型。

顺便说一句，这就是 Crystal Reports “支持”异构连接的方式。您可以将字符串链接到数值，只要您转换其中一个字段以匹配另一个字段的数据类型（通过公式字段）。

我还通过使用 SQL 表达式字段转换其中一个字段来解决异构连接问题。然后在记录选择公式中执行“链接”。

# url - 切换网站主机，需要旧域名才能工作，但它不会

> ID：10419158
> 
> 赞同：0
> 
> 时间：2012-05-02T17:58:18.967
> 
> 标签：url, dns

我将我的网站托管切换到新主机，并且必须创建一个新域名才能做到这一点，但我真的需要使用旧域名，因为它有很多反向链接等。

我需要做什么才能让网站拥有我的旧网址

我尝试使用 123reg.co.uk 更改 dns，因此他们指向新网站，但它只返回 404。我尝试与主机和域名注册商进行通信，但主机声称我必须支付很多费用才能升级伯爵和登记官说这与他们无关。

请帮助，因为我的网站已关闭，我正在失去业务。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T18:09:35.200

好的，我知道您在 123reg.co.uk 购买了您的域名，所以您应该有一个帐户。登录并将看起来像 NS1.domain.com... NS2.domain.com 的名称服务器更改为您的新托管名称服务器。确保您在新的托管帐户中注册了新的和旧的域。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T18:15:42.513

您需要将域移至新主机。联系您的旧主机并让他们解锁域，然后在您的新主机帐户中设置域。然后更改 dns 设置。

# java - javax swing html解析器没有拾取img标签

> ID：10419161
> 
> 赞同：1
> 
> 时间：2012-05-02T17:58:23.893
> 
> 标签：java, html, swing, html-parsing

这个 HTML：

```
<td height="79" valign="top" width="70">
            <a href="http://e.livinghuntington.com/HS?a=stuff" target="_blank" title="Follow us on Twitter: http://twitter.com/#!/HuntingtonLive"> link link link <img alt="Follow us on Twitter: http://twitter.com/#!/HuntingtonLive" border="0" height="79" src="http://webe.emv3.com/livinghuntington/images/tt.png" style="display:block;" width="70"/></a>
        </td>
</table>
<table> 
```

这个代码：

```
public void handleStartTag(Tag tag, MutableAttributeSet attr, int pos) {

     System.err.println("tag = " + tag); 
```

给出这个输出：

```
tag = td
tag = a
tag = table 
```

我尝试了各种测试策略：如果我嵌套一个链接（我什至不知道它是否是有效的 html），它会正确选择内部链接。如果我将图像从链接中拉出，它仍然不会拾取 img。据我所知，它根本不会提取图像标签。代码中是否存在错误或杂乱无章，或者这是 HTML 解析器的无法修复的问题（所以我需要放弃它并使用新的）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T19:37:59.773

问题是 img 是简单的标签，因此不会在 startTag() 下被拾取。handleSimpleTag() 是要使用的处理程序。

# php - 在多值复选框上使用 SimpleTest

> ID：10419165
> 
> 赞同：0
> 
> 时间：2012-05-02T17:58:30.323
> 
> 标签：php, forms, checkbox, multi-select, simpletest

我有一个带有几组多值复选框和一个文本字段的表单。这些输入用于构建查询。

```
<input class="entry" name="search_text" />

<input type="checkbox" name="arrSource[pn_oem]" value="pn_oem" />
<input type="checkbox" name="arrSource[descr]" value="descr" />
<input type="checkbox" name="arrSource[supplier_pn]" value="supplier_pn" />
        <!---  etc  -->

<input type="checkbox" name="arrSupplier[]" value="307" /> Adam
<input type="checkbox" name="arrSupplier[]" value="113" /> Alan
<input type="checkbox" name="arrSupplier[]" value="2" /> Alex
<input type="checkbox" name="arrSupplier[]" value="3" /> Archie
        <!---  etc  -->

<input class="submit" value="Search" type="submit" name="Search" />
<input class="submit" value="Reset" type="submit" name="Reset" /> 
```

我一直在通过运行搜索并将结果与​​我自己在数据库上的 SQL 进行比较来测试表单。它似乎工作得很好。但我无法让 SimpleTest 同意（遵循这些有点[稀疏的指令](http://www.simpletest.org/en/form_testing_documentation.html)）。表单提交如下所示：

```
$this->setField('arrSource[]', array("supplier_pn", "pn_oem")); 
$this->setField('arrSupplier[]', array(15,92));
$this->setField('search_text', "pax");
$this->click('Search'); 
```

SimpleTest 产生的结果为 2，但其他方法则为 9。以下是一些变化：

**2 但应该是 9：** `setField('arrSource[]', array("supplier_pn", "pn_oem"));`

**2 但应该是 0：** `setField('arrSource[]', array("pn_oem"));`

**23 但应该是 2：** `setField('arrSource[]', array("supplier_pn"));`

通过将没有供应商标准和源标准设置为仅“pn_oem”，我能够使 UI 显示 2 个结果。这等效于取消选中所有复选框，因为`pn_oem`如果未选中 Source，则该查询假定是需要的。这是在 SimpleTest 中的样子——SimpleTest 同意 2 的结果：

```
$this->setField('arrSource[]', array("pn_oem")); 
$this->setField('search_text', "pax");
$this->click('Search'); 
```

看来我是在向 SimpleTest 发出我不想要任何复选框的信号。但是，我在同一表单上使用其他多值复选框集构建了其他测试。他们没有这个问题。

你的意见？

# c - C 正则表达式是否支持前瞻？

> ID：10419167
> 
> 赞同：0
> 
> 时间：2012-05-02T17:58:44.677
> 
> 标签：c, regex

我正在尝试使用 regex.h 在 c/c++ 中使用正则表达式。我正在尝试使用前瞻选项，例如：

```
(?=>#).* 
```

为了在“#”之后提取字符串

由于某种原因，它无法找到任何匹配项。regex.h 是否支持前瞻/后视？我可以使用另一个库吗？

我在 linux 上使用 regex.h。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T19:53:52.373

我很确定 NSRegularExpression 只是 libicu 的包装器[，](http://userguide.icu-project.org/strings/regexp)它确实支持前瞻。您的示例中有错字，正确的语法是`(?=#).*`根据链接。

但在这种情况下似乎并不需要它，为什么不只是`#.*`？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T23:40:48.073

我怀疑它真的是向后看，而不是向前看。那将是`(?<=#).*`，但为什么让它如此复杂？为什么不像`#(.*)`其他响应者所建议的那样使用 ，并将所需的文本从捕获组中提取出来？

另外，你真的在​​使用 NSRegularExpression 吗？考虑到它是 Apple iOS/MacOS 开发人员框架中的一个 Objective-C 类，这似乎不太可能。

# api - 我可以为我的 fb 业务页面添加“使用 facebook 登录”功能吗？

> ID：10419172
> 
> 赞同：0
> 
> 时间：2012-05-02T17:58:59.867
> 
> 标签：api, facebook-login

我正在尝试将开发人员 api 用于我的 FB 业务帐户。Facebook 是否允许“页面”这样做？试图在我的网站上使用“使用 facebook 登录”应用程序，但它不允许...

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T18:14:36.267

页面不能使用应用程序，只有用户可以使用应用程序

# java - 添加新数据后，组合框数据库值不刷新

> ID：10419175
> 
> 赞同：0
> 
> 时间：2012-05-02T17:59:10.630
> 
> 标签：java, database, swing, refresh, jcombobox

将数据添加到数据库后，除非我再次执行该程序，否则 JComboBox 不会发生任何变化。我是否需要调用任何特定方法来刷新值？谢谢！

新代码：

```
 class ComboModel extends AbstractListModel implements ComboBoxModel 
 {
    // array? treeset? 

    public Object getElementAt(int index) {

    }

    public int getSize() {

    }

    public Object getSelectedItem() {

    }

    public void setSelectedItem(Object anItem) {

    }
}

final JComboBox stockListComboBox = new JComboBox();
ComboModel model = new ComboModel();
stockListComboBox.setModel(model);          

try
{
    // Database Stuffs
}

catch(Exception e)
{
    e.printStackTrace();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T18:13:09.330

不确定我是否得到了问题的第二部分，但是，关于添加到 DefaultComboBoxModel 的值，您必须调用一个方法让组合框知道模型元素已更改。您可以使用[fireContentsChanged](http://docs.oracle.com/javase/1.4.2/docs/api/javax/swing/AbstractListModel.html#fireContentsChanged%28java.lang.Object,%20int,%20int%29)方法或 fireIntervalAdded 方法之一。

# java - 访问 JTextAreas 数组时出现 NullPointerException

> ID：10419181
> 
> 赞同：1
> 
> 时间：2012-05-02T17:59:56.107
> 
> 标签：java, arrays, swing, jtextarea

我正在制作一个作业计划器，其中一个人在 JTextArea 中输入当天的作业。我将 JTextAreas 设为静态，因此我可以在课堂外访问它们。为了清理我的代码，我决定使用 for 循环并将 JTextAreas 放入静态实例变量数组中。但是，当我尝试通过数组访问 JTextArea 时，我得到了 NullPointerException。下面是一个 JTextArea 声明的例子：

```
static JTextArea MondayEng; 
```

数组（每个主题一个）声明如下：

```
static JTextArea[] Eng =  new JTextArea[]{
    MondayEng,
    TuesdayEng,
    WednesdayEng,
    ThursdayEng,
    FridayEng
}; 
```

然后有一个`JTextArea[][]`包含数组：

```
static JTextArea[][] subjs = new JTextArea[][] {Eng, Hist, Math, Sci, Lang}; 
```

JTextAreas 在 JFrame（称为 PWin）内实例化，如下所示：

```
MondayEng = new JTextArea();
MondayEng.setBounds(664, 68, 153, 100);
contentPane.add(MondayEng); 
```

我将尝试像这样获取 JTextAreas 的内容：

```
for (int i = 0; i < PWin.subjs.length; i++) { // Iterate through subjects
        String sub = subjects[i]; // Store the current subject in a variable
        for (int y = 0; y < days.length; y++) { // Iterate through days in week             
            String day = days[y]; // Store the current day in a variable                
            String str = PWin.subjs[i][y].getText(); // Get the text of the JTextArea currently selected, plop it in a string 
```

这是保存文件时的例外：

```
Exception in thread "AWT-EventQueue-0" java.lang.NullPointerException
    at PSave.<init>(PSave.java:19)
    at PWin$1.actionPerformed(PWin.java:262)
    at javax.swing.AbstractButton.fireActionPerformed(AbstractButton.java:2028)
    at javax.swing.AbstractButton$Handler.actionPerformed(AbstractButton.java:2351)
    at javax.swing.DefaultButtonModel.fireActionPerformed(DefaultButtonModel.java:387)
    at javax.swing.DefaultButtonModel.setPressed(DefaultButtonModel.java:242)
    at javax.swing.plaf.basic.BasicButtonListener.mouseReleased(BasicButtonListener.java:236)
    at java.awt.Component.processMouseEvent(Component.java:6373)
    at javax.swing.JComponent.processMouseEvent(JComponent.java:3267)
    at java.awt.Component.processEvent(Component.java:6138)
    at java.awt.Container.processEvent(Container.java:2085)
    at java.awt.Component.dispatchEventImpl(Component.java:4735)
    at java.awt.Container.dispatchEventImpl(Container.java:2143)
    at java.awt.Component.dispatchEvent(Component.java:4565)
    at java.awt.LightweightDispatcher.retargetMouseEvent(Container.java:4621)
    at java.awt.LightweightDispatcher.processMouseEvent(Container.java:4282)
    at java.awt.LightweightDispatcher.dispatchEvent(Container.java:4212)
    at java.awt.Container.dispatchEventImpl(Container.java:2129)
    at java.awt.Window.dispatchEventImpl(Window.java:2478)
    at java.awt.Component.dispatchEvent(Component.java:4565)
    at java.awt.EventQueue.dispatchEventImpl(EventQueue.java:679)
    at java.awt.EventQueue.access$000(EventQueue.java:85)
    at java.awt.EventQueue$1.run(EventQueue.java:638)
    at java.awt.EventQueue$1.run(EventQueue.java:636)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.AccessControlContext$1.doIntersectionPrivilege(AccessControlContext.java:87)
    at java.security.AccessControlContext$1.doIntersectionPrivilege(AccessControlContext.java:98)
    at java.awt.EventQueue$2.run(EventQueue.java:652)
    at java.awt.EventQueue$2.run(EventQueue.java:650)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.AccessControlContext$1.doIntersectionPrivilege(AccessControlContext.java:87)
    at java.awt.EventQueue.dispatchEvent(EventQueue.java:649)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(EventDispatchThread.java:296)
    at java.awt.EventDispatchThread.pumpEventsForFilter(EventDispatchThread.java:211)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(EventDispatchThread.java:201)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:196)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:188)
    at java.awt.EventDispatchThread.run(EventDispatchThread.java:122) 
```

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T18:03:39.070

您的问题似乎是在您创建数组时，JTextAreas 尚未构建。Java 是按值传递的，因此当您传入稍后要构造的 JTextAreas 的名称时，它与传递 null 相同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T18:17:52.120

你需要替换这个：

```
MondayEng = new JTextArea();
MondayEng.setBounds(664, 68, 153, 100);
contentPane.add(MondayEng); 
```

和：

```
Eng[0] = new JTextArea();
Eng[0].setBounds(664, 68, 153, 100);
contentPane.add(Eng[0]); 
```

否则，数组`Eng`仍然包含`null`s，而您只是在创建一个新`JTextArea`对象并`MondayEng`引用该对象而不是指向所`Eng[0]`指向的对象。

但是，更正确的答案是在将`JTextArea`s 传递给数组之前构建它们。就像是：

```
MondayEng = new JTextArea();
MondayEng.setBounds(664, 68, 153, 100);
contentPane.add(MondayEng);

// ...

static JTextArea[] Eng =  new JTextArea[]{
    MondayEng,
    TuesdayEng,
    WednesdayEng,
    ThursdayEng,
    FridayEng
}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-02T18:49:17.967

由于 JTextArea[][] subjs 是一个二维数组，因此您需要注意正确生成数组。您创建的方式是一维数组。理想情况下，您可能需要创建类似

```
JTextArea[][] subs = new JTextArea[][]{ {Eng, Hist, Math, Sci, Lang} }; 
```

# multithreading - WCF服务契约实现中的多线程操作

> ID：10419194
> 
> 赞同：4
> 
> 时间：2012-05-02T18:01:09.880
> 
> 标签：multithreading, wcf, c#-4.0

我最近看到一个项目使用后台工作者进行一些操作（*从其他 Web 服务获取数据*）并使用事件将数据扔给客户端。该项目是一个 WCF 服务，由另一个类库作为 WCF 客户端角色由 ASP.NET 网站使用，并依次向应用程序抛出事件。这个全多线程系列让我好奇地研究。我已经看到这是一个`basicHttpBinding`绑定，服务的唯一行为是`UseSynchronizationContext=false`我发现他们在无法解释的异常之后添加了它，这是正常的:)

现在我问的`ConcurrencyMode`是`basicHttpBinding`. 他们不应该这样做`Reentrant`还是这是默认行为？

如果 WCF 服务从客户端关闭，这种情况是否会继续失败，因为他们已经有一个未设置为对象实例的无法解释的引用？我相信在依赖 IIS 处理的 ASP.NET 项目消耗的 WCF 服务中使用多线程操作是不好的，因为在 WCF 服务将数据返回到客户端类库并将这些数据附加到页面之前，页面可能被发送到客户端。你能讨论以上问题并解释你的想法吗？

当您需要这种异步编程风格来通知 WCF 消费者在长时间操作后使用`CallbackContracts`嵌入式 WCF 技术而不是多线程操作时通知时，不应该更好吗？

需要澄清以纠正设计并证明这是一个糟糕的服务架构，如果它是真的，我怀疑！

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T20:38:39.773

它本质上并不是糟糕的架构，但听起来它确实造成了许多可能的陷阱。

WCF 客户端库将所有协调留给 ASP.NET 应用程序。如果 ASP.NET 应用程序未检查对 WCF 服务的调用是否已完成，则它可能会在使用服务中的值设置变量之前使用变量，以及其他此类竞争条件，除非明确设置某种协调方式针对完成事件的初始调用。

我的建议是重写 WCF 客户端异步方法以从命名空间（[MSDN 参考](http://msdn.microsoft.com/en-us/library/dd235678.aspx)）返回`Task`对象。通过这种方式，您可以剥离调用 WCF 服务的后台处理，并使用 的属性来确保服务已完成。`System.Threading.Tasks``Result``Task`

一个例子：

```
protected void Page_Load(object sender, EventArgs e)
{
    Task<string> t = Task<string>.Factory.StartNew(() =>
    {
        return MyWcfClientClass.StaticAsyncMethod(MyArguments);
    }

    /* other control initialization stuff here, while the task 
       and WCF call continue processing in background */

    /* Calling Result causes the thread to wait for the task to 
       complete as necessary, to ensure we have our correct value */
    MyLabel1.Text = t.Result;
} 
```

# svn - 如何将两个 Subversion 提交合并为一个

> ID：10419196
> 
> 赞同：3
> 
> 时间：2012-05-02T18:01:24.477
> 
> 标签：svn

我使用一个 GUI 程序与我们的 SVN 存储库进行交互。很多时候我去提交十个不同的文件，但不小心只选择了一个并提交。然后，我必须对所有其他更改进行另一次提交。

有没有办法在跟踪程序中将这两个“重复”提交合并为一个带有单个消息的单个提交？

这很简单，但我很好奇这是否可能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T18:15:45.820

听起来它们不是“重复”提交。

听起来您有 10 个文件分别在两次提交中提交（如果我理解正确的话）。

我不知道您是否可以“取消提交”第一个文件，但您可以再次提交以将存储库“恢复”到您进行意外提交之前的位置。这将允许您在同一修订版中提交所有十个文件。

我不知道如何使用 GUI/IDE 来做到这一点。

从命令行你可以这样做：

*   在修订版 5000 中意外提交文件 A

*   创建一个补丁来恢复提交：

    svn diff -r 5000:4999 > revert.patch

*   应用补丁：

    补丁 -p0 < revert.patch

*   现在你的仓库是意外提交之前的位置

*   现在您可以一起提交所有十个文件

可能有很多方法（有些更简单）可以做到这一点。我相信这个答案会被否决！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T18:15:46.750

一般来说，修订控制系统的想法是您不能返回并更改以前的提交——这将删除很多价值，因为您不能再保证修订控制系统中的内容就是您在时间。

在颠覆的情况下，您*可以*使用`svnadmin`转储存储库，编辑转储然后将其恢复回来......但这对于具有边际价值的东西来说是很多工作。在我看来，一个更好的主意是获得一个更适合您的工作流程的前端，或者添加一些提交钩子来阻止您首先做出错误的提交。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T18:16:28.397

据我所知，在 Subversion 中没有直接的支持（例如与 git 相反）。但是，您可以撤消更改而不是进行新的提交。你可以参考这里： [http ://svnbook.red-bean.com/en/1.2/svn.branchmerge.commonuses.html#svn.branchmerge.commonuses.undo](http://svnbook.red-bean.com/en/1.2/svn.branchmerge.commonuses.html#svn.branchmerge.commonuses.undo)

或者，如果您使用一些 GUI，例如乌龟，您可能会发现以下短文章很有趣：

[http://markphip.blogspot.com/2007/01/how-to-undo-commit-in-subversion.html](http://markphip.blogspot.com/2007/01/how-to-undo-commit-in-subversion.html)

# iphone - iPhone iOS如何在删除实体时删除从Core Data实体嵌套关系引用的本地文件？

> ID：10419201
> 
> 赞同：2
> 
> 时间：2012-05-02T18:02:17.417
> 
> 标签：iphone, objective-c, ios, core-data, nsfetchedresultscontroller

我有一个核心数据模型定义如下：

一个用户有很多事件。每个事件可以有许多图片。关系具有“级联”删除规则。

**我试图了解如何在实体消失时删除本地文件。核心数据实体在消失之前是否有某种释放或“最终确定”方法？**

每个图片实体都有一个对存储在应用程序文档目录中的本地文件的引用。

当通过表视图的 commitEditingStyle 删除用户时，我可以通过逐步处理关系来删除图像并手动删除文件：

```
- (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath
{

    {
        // Delete the managed object for the given index path
        NSManagedObjectContext *context = [[[RKObjectManager sharedManager] objectStore] managedObjectContext];

        AppUser* managedObject = [self.fetchedResultsController objectAtIndexPath:indexPath];

        //clean up local files before deleting the object
        [self deleteLocalContentForAppUser:managedObject];        

//now delete the object
        [context deleteObject:managedObject];

        // Save the context to remember deletion
        NSError* error = nil;
        if (![context save:&error]) {
            /*
             Replace this implementation with code to handle the error appropriately.

             abort() causes the application to generate a crash log and terminate. You should not use this function in a shipping application, although it may be useful during development. 
             */
            NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
            abort();
        }

    }

} 
```

**但是，当通过其他方法删除实体并且我的获取结果控制器收到通知时，嵌套关系不包含任何对象。**用户的事件集将没有任何实体可以单步执行和删除本地内容。这是为关系设置“级联”删除规则的结果吗？

```
- (void)controller:(NSFetchedResultsController *)controller didChangeObject:(id)anObject
       atIndexPath:(NSIndexPath *)indexPath forChangeType:(NSFetchedResultsChangeType)type
      newIndexPath:(NSIndexPath *)newIndexPath
{
//    UITableView *tableView = self.tableView;
//     
    AppUser* managedObject = anObject;
    switch(type) {
        case NSFetchedResultsChangeInsert:
            [self.tableView insertRowsAtIndexPaths:[NSArray arrayWithObject:newIndexPath] withRowAnimation:UITableViewRowAnimationNone];
//             [self.tableView insertRowsAtIndexPaths:[NSArray arrayWithObject:newIndexPath] withRowAnimation:UITableViewRowAnimationFade];
            //             [self configureCell:[tableView cellForRowAtIndexPath:newIndexPath] atIndexPath:newIndexPath];
            break;

        case NSFetchedResultsChangeDelete:
            [self.tableView deleteRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationNone];

            //these methods cannot find any content to delete
            [managedObject deleteLocalImages];
            [managedObject deleteLocalContent];
            break;

        case NSFetchedResultsChangeUpdate:
            [self configureCell:[self.tableView cellForRowAtIndexPath:newIndexPath] atIndexPath:newIndexPath];

            [managedObject updateLocalImages];
            break;

        case NSFetchedResultsChangeMove:
            [self.tableView deleteRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationFade];
            [self.tableView insertRowsAtIndexPaths:[NSArray arrayWithObject:newIndexPath]withRowAnimation:UITableViewRowAnimationFade];
            break;
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T18:05:21.013

您可以`prepareForDeletion`在子类中实现该方法`NSManagedObject`。它在删除对象之前自动调用，因此您也可以从那里删除引用的文件。

# html - 标题浮动问题中的 w 图像

> ID：10419202
> 
> 赞同：0
> 
> 时间：2012-05-02T18:02:22.897
> 
> 标签：html, css, header, css-float

我有一个比大多数屏幕宽度都大的标题。我将其居中并隐藏了溢出，因此当您在更大的屏幕上展开浏览器时，可以看到更多内容。我还有两张图片，一张向右浮动，一张向左浮动。我的问题是左图像在左侧浮动，但右图像不会一直向右。如果我将两个图像都放在同一个 z-index 上，它们只是堆叠而不是左右浮动。有什么建议么？这是我的css和html：

```
 #triangleleft{
 width:100%;
 height:531px;
 z-index:58;
 position:absolute;
 top:+53px;
}

 #triangleright{
 width:100%;
 height:531px;
 z-index:59;
 position:absolute;
 top:+53px;
}

.triangleleft{
 background:url(Layer-58.png)no-repeat;
 float:left;
 margin-left:0px;
 height:531px;
 width:100%;
}

.triangleright{
 background:url(Layer-59.png)no-repeat;
 float:right;
 margin-right:0px;
 height:531px;
 width:100%;
}

 <div id="triangleleft">
 <div class="triangleleft"></div>
 </div>

 <div id="triangleright">
 <div class="triangleright"></div>
 </div> 
```

这也是我认为搞砸的标题图片的代码

```
#wrapper {
 height:100%;
 position: relative;
}
#Layer-57 {
 position: relative;
 height:529px;
 background:#3b96a9 url(layer-57.jpg) top center no-repeat;
 top:-529px;
 overflow-x: hidden;
 z-index: 57;
}

<div id="wrapper"> <div id="Layer-57"></div> </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T18:07:44.893

用这个替换你的风格

```
<style>
#triangleleft {
    width:90%;
    height: 531px;
    z-index: 58;
    position: absolute;
    top: +53px;
}
#triangleright {
    width:90%;
    height: 531px;
    z-index: 59;
    position: absolute;
    top: +53px;
}
.triangleleft {
    background: url(Layer-58.png)no-repeat;
    float: left;
    margin-left: 0px;
    height: 531px;
    width: 100%;
}
.triangleright {
    background: url(Layer-59.png)no-repeat;
    float: right;
    margin-right: 0px;
    height: 531px;
    width: 100%;
}
</style> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T18:23:06.340

修订后的答案（为清楚起见，删除了以前的答案）：

仔细查看您在下面的评论中引用的 leaderbe.com 页面，我注意到 div 的 HTML 结构与您所拥有的完全不同。您需要将 triangleright div 放入 triangleleft div 并使用如下样式：

看到这个jsfiddle：http: [//jsfiddle.net/uKrNT/2/](http://jsfiddle.net/uKrNT/2/)

```
<div id="wrapper"> <div id="Layer-57">layer 57</div> </div>

<div id="triangleleft">
     <div id="triangleright">
   </div>
 </div>

#triangleleft{
 width:100%;
 height:531px;
 z-index:58;
 position:absolute;
 top:+53px;
 float:left;
 background:red url(http://www.leaderbe.com/images/diamond-left.png)no-repeat;
 margin-left:0px;
    overflow:visible;
    opacity:.5;

}

 #triangleright{
 width:100%;
 height:531px;
 z-index:59;
 float:right;
 background:blue url(http://www.leaderbe.com/images/diamond-right.png)no-repeat;
 margin-right:0px;
    opacity: .5;
    overflow:visible;
}

#wrapper { height:100%; position: relative; }
#Layer-57 { position: relative; height:529px; background:#3b96a9 url(layer-57.jpg) top center no-repeat; top:-529px; overflow-x: hidden; z-index: 57; } 
```

# ios - 加载 webview 时，SplitViewController 应用程序崩溃

> ID：10419205
> 
> 赞同：1
> 
> 时间：2012-05-02T18:02:30.663
> 
> 标签：ios, ipad, sqlite, uiwebview, uisplitviewcontroller

我正在开发一个使用 splitViewController 从 sqlite 数据库加载 html 文件的应用程序。我有一个做同样事情的 iPhone 应用程序。它加载一个带有数据库内容的表格视图，然后当用户触摸一个单元格时将一个 web 视图推送到堆栈上。一切都适用于 iPhone 应用程序，但不适用于带有 splitViewController 的 iPad。一切正常，除了加载 webview 时。

这是头文件中的相关代码：

```
 #import <UIKit/UIKit.h>

  @class LIDetailViewController;

  @interface LIMasterViewController : UITableViewController <UISearchBarDelegate>{

  @property (strong, nonatomic) LIDetailViewController *detailViewController; 
```

在实现文件中：

```
@synthesize detailViewController = _detailViewController; 
```

这是它崩溃的代码：

```
if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPhone) {
    if (!_detailViewController) {
        _detailViewController = [[LIDetailViewController alloc] initWithNibName:@"LIDetailViewController" bundle:nil];
    }
    [self.navigationController pushViewController:self.detailViewController  animated:YES];
}

NSString *sqlData = [animal  description];
NSString *htmlHead = @"<head><link type='text/css' rel='stylesheet' href='default.css'><head/><body><div class='content'>";
NSString *htmlBody = [sqlData stringByAppendingString:@"</div>"];   
NSString *html = [htmlHead stringByAppendingString:htmlBody];
[_detailViewController.animalDescripton loadHTMLString:html baseURL:nil]; 
```

它在上面写着：

```
[_detailViewController.animalDescripton loadHTMLString:html baseURL:nil]; 
```

这是调试器中的错误：“[UINavigationController animalDescripton]: unrecognized selector sent to instance 0x685fa70”

如果有人可以帮助我，那就太好了！提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T21:53:16.890

您显然从未`self.detailViewController`在 iPad 上设置 when，因此它似乎默认为`UINavigationController`.

# regex - 更健壮的正则表达式环视

> ID：10419207
> 
> 赞同：1
> 
> 时间：2012-05-02T18:02:39.090
> 
> 标签：regex, lookaround

这是输入字符串：`$table_prefix = 'wp5t3s1tc_';`它是较大配置文件的一部分。

我想匹配之间的任何东西`''`

我工作的表达式`(?<=\$table_prefix(\s{2}=\s\'))(.*)?(?=\')`不是很好，因为环视与`=`. 如果配置文件更改为两边的多个空格，`=`则表达式将不起作用。

我认为它应该看起来更像，`(?<=\$table_prefix(\s*\=\s*\'))(.*)?(?=\')`但这当然行不通。

有人可以简要解释一下进行这场比赛的更优雅的方式吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T06:02:34.017

这是一个可能的解决方案，使用`grep`. 它不是很优雅，但如果您关心`=`.

由于 AFAIK 中不允许可变长度断言`grep`，我唯一能想到的就是分两个阶段执行提取：

`grep -oP '(?<=\$table_prefix).*(?='"'"')' file_name | grep -oP '(?<='"'"').*'`

我基本上是捕获第一个周围的所有空格`=`，以及 . `'wp5t3s1tc_`，然后提取 . 之后的所有内容`'`。奇怪`'"'"'`的是转义单引号字符。

或者您可以使用`sed`而不是第二个`grep`：

`grep -oP '(?<=\$table_prefix).*(?='"'"')' file_name | sed 's/ *= *'"'"'//'`

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-02T18:19:57.417

只要保证 ' 字符不会出现在您尝试匹配的序列中，您根本不需要使用环视。您可以将贪婪搜索与互补正则集一起使用，这将导致有限自动机贪婪地匹配任何不包含 ' 字符的字符串。

要仅解析单引号中的子序列，请使用命名组（如果您的引擎不支持，则使用未命名组。在这种情况下，您必须通过组的索引而不是给定名称来访问组）。这个正则表达式可以满足您的需求：

```
\$table_prefix\s*=\s*'(?<match>[^'.]*)'; 
```

检查[http://rubular.com/](http://rubular.com/)

# jquery - Fancybox 2 上的多个问题：一个链接中的多图像，同一画廊中的视频和图像，如何防止循环

> ID：10419215
> 
> 赞同：0
> 
> 时间：2012-05-02T18:03:03.907
> 
> 标签：jquery, fancybox

如果可以的话，我将在这一条消息中提出多个问题。我已经独立搜索了每个答案，但在这一点上，我认为这一切都让我有点过头了，所以对基本问题表示歉意。我是一名设计师，也是一名糟糕的程序员，但我找不到一个包含我想要的一切的主题。

我正在尝试创建一个投资组合页面，该页面将包含来自一个链接的多个项目（样式文本、图像、视频）。不同的画廊也会有多个链接。我查看了 Fancybox 网站上的示例页面，我得到了*一些*可以处理图像的东西，但我觉得它可能非常笨拙和错误。

我想要的结构如下：

公司 1 徽标作为画廊链接 -> （用于描述作品的文本，图片 1，图片 2，图片 3，mp4 文件）

公司 2 徽标作为画廊链接 ->（用于描述作品的文本、图像 1、图像 2、图像 3、mp4 文件）等。

到目前为止，我根据花式框示例所做的是为每个画廊创建一个 id，然后为每个客户放置一段代码。这是我现在拥有的：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" >
    <meta name="author" content="Jeffrey Nee" >
    <meta name="description" content="Jeffrey Nee Portfolio Site" >
    <meta name="keywords" content="Jeffrey Nee, Jeff Nee, Art Director, Creative Director, Los Angeles, San Francisco, Advertising, Microsoft, Carl's Jr." >
    <title>Jeffrey Nee | Art Director / Creative Director</title>
    <link href="styles.css" rel="stylesheet" media="screen" type="text/css" >

    <script type="text/javascript" src="Libraries/jquery-1.7.2.min.js"></script>
    <script type="text/javascript" src="Libraries/jquery.mousewheel-3.0.6.pack.js"></script>
    <script type="text/javascript" src="Libraries/fancybox/jquery.fancybox.js?v=2.0.6"></script>
    <link rel="stylesheet" type="text/css" href="Libraries/fancybox/jquery.fancybox.css?v=2.0.6" media="screen">
    <script type="text/javascript" src="Libraries/fancybox/helpers/jquery.fancybox-media.js?v=1.0.0"></script>

</head>

<body id="body" >
<div id="content" >
<div id="header" ><a href="index.html" target="" name="" ><img src="images/neebook_straight.png" alt="" ></a><div id="nav" ><a href="index.html" target="" name="" >home </a>&nbsp; &nbsp; &nbsp; &nbsp;portfolio &nbsp; &nbsp; &nbsp; &nbsp;<a href="about.html" target="" name="" >about </a>&nbsp; &nbsp; &nbsp; &nbsp;<a href="contact.html" target="" name="" >contact</a> &nbsp; &nbsp; &nbsp; &nbsp;<a href="miscellania.html" target="" name="" >miscellania</a></div></div>

<div id="portfolio_grid" ><div>

<a id="fancybox_BooksForDummies" href="javascript:;">Books For Dummies</a>
<a id="fancybox_BootCamp" href="javascript:;">Boot Camp</a>
<a id="fancybox_CHM" href="javascript:;">Computer History Museum</a>
<a id="fancybox_Encarta" href="javascript:;">Microsoft Encarta</a>
<a id="fancybox_Marketplace" href="javascript:;">Marketplace</a>
<a id="fancybox_OfficeMac" href="javascript:;">Office for Mac</a>
<a id="fancybox_OfficeXP" href="javascript:;">Office XP</a>
<a id="fancybox_Piaggio" href="javascript:;">Piaggio MP3</a>
<a id="fancybox_Rosemount" href="javascript:;">Rosemount</a>

<script type="text/javascript">
        $(document).ready(function() {
            /*
            *  Media helper. Group items, disable animations, hide arrows, enable media and button helpers.
            */

            $('.fancybox-media')
                .attr('rel', 'media-gallery')
                .fancybox({
                    openEffect : 'none',
                    closeEffect : 'none',
                    prevEffect : 'none',
                    nextEffect : 'none',

                    arrows : true,
                    helpers : {
                        media : {},
                        buttons : {}
                    }
                });

            /*
             *  Galleries
             */

            $("#fancybox_BootCamp").click(function() {
                $.fancybox.open([
                    {
                        href : 'images/Print/Boot_Camp_01.jpg',
                    }, {
                        href : 'images/Print/Boot_Camp_02.jpg',
                    }, {
                        href : 'images/Print/Boot_Camp_03.jpg'
                    }
                ], {

                });
            });

            $("#fancybox_BooksForDummies").click(function() {
                $.fancybox.open([
                    {
                        href : 'images/Print/Books_for_Dummies.jpg'
                    }
                ], {

                });
            });

            $("#fancybox_CHM").click(function() {
                $.fancybox.open([
                    {
                        href : 'images/Print/Computer_History_Museum.jpg'
                    }
                ], {

                });
            });

            $("#fancybox_Encarta").click(function() {
                $.fancybox.open([
                                {
                        href : 'images/Print/Encarta_Office_01.jpg',
                    }, {
                        href : 'images/Print/Encarta_Office_02.jpg',
                    }, {
                        href : 'images/Print/Encarta_Office_03.jpg'
                    }
                ], {

                });
            });

            $("#fancybox_Marketplace").click(function() {
                $.fancybox.open([
                                {
                        href : 'images/Print/Marketplace_01.jpg',
                    }, {
                        href : 'images/Print/Marketplace_02.jpg',
                    }, {
                        href : 'images/Print/Marketplace_03.jpg'
                    }
                ], {

                });
            });

            $("#fancybox_OfficeMac").click(function() {
                $.fancybox.open([
                                {
                        href : 'images/Print/Office_Mac_01.jpg',
                    }, {
                        href : 'images/Print/Office_Mac_02.jpg',
                    }, {
                        href : 'images/Print/Office_Mac_03.jpg'
                    }
                ], {

                });
            });

            $("#fancybox_OfficeXP").click(function() {
                $.fancybox.open([
                                {
                        href : 'images/Print/Office_XP_01.jpg',
                    }, {
                        href : 'images/Print/Office_XP_02.jpg',
                    }, {
                        href : 'images/Print/Office_XP_03.jpg'
                    }
                ], {

                });
            });

            $("#fancybox_Piaggio").click(function() {
                $.fancybox.open([
                                {
                        href : 'images/Print/Piaggio_01.jpg',
                    }, {
                        href : 'images/Print/Piaggio_02.jpg',
                    }, {
                        href : 'images/Print/Piaggio_03.jpg'
                    }
                ], {

                });
            });

            $("#fancybox_Rosemount").click(function() {
                $.fancybox.open([
                                {
                        href : 'images/Print/Rosemount_01.jpg',
                    }, {
                        href : 'images/Print/Rosemount_02.jpg',
                    }, {
                        href : 'images/Print/Rosemount_03.jpg',
                    }, {
                        href : 'images/Print/Rosemount_04.jpg'
                    }
                    ], {
                });
            });

});
</script>

</div>

</div>

</div>

</body></html> 
```

现在，我确定这是废话，但我不知道如何修复它，它现在可以用于图像。

这是我无法弄清楚的：

• 如何正确构建画廊，因为我很确定这是不对的。我觉得画廊应该是一个只调用不同数据集而不是单独实例的类。

• 如何包含未托管在视频服务上但仅存储在我的网络服务器上的视频文件。

• 如何创建一个仅包含样式文本的页面，我可以编写每个画廊的小摘要。

• 如何让过渡淡出，而不是从顶部翻转，这样大文件的动画效果不佳。

• 如何阻止下一个和上一个按钮再次循环。我是第一张没有后退按钮的幻灯片，也是最后一张没有前进按钮的幻灯片。现在它只是不断循环，我认为这对我的目的来说会令人困惑。

这是我现在拥有的链接，它似乎确实适用于过渡和循环问题以外的图像。我也让它与图像作为链接一起使用，但我真的不需要帮助。

[投资组合页面](http://www.jeffnee.com/testing/portfolio.html)

感谢任何能提供帮助的人。我一直在努力学习这些东西，并刚刚得出结论，也许我的大脑并没有连接到理解它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T18:04:19.867

好吧，您似乎需要多个答案（尽管您只能接受一个）。我会从头顶尝试其中的一些，所以，

**问**：如何包含未托管在视频服务上但仅存储在我的 Web 服务器上的视频文件？

**A** : 无论如何你都需要一名球员。例如，您可以使用*jwplayer*。直接链接您的 (flv, mp4, mpg) 视频

```
<a class="myVideo" href="pathToVideo/video.flv">open my video in fancybox</a> 
```

然后为此类视频使用脚本，例如

```
 $("a.myVideo").click(function() {
   $.fancybox({
    'content': '<embed src="pathToPlayer/jwplayer.swf?file='+this.href+'&amp;autostart=true&amp;fs=1" type="application/x-shockwave-flash" width="352" height="240" wmode="opaque" allowfullscreen="true" allowscriptaccess="always"></embed>'               
   }); // fancybox
   return false;
  }); // click 
```

**问**：如何停止下一个和上一个按钮再次循环。我希望第一张幻灯片没有后退按钮，最后一张没有前进按钮。

**A** : 将选项设置`loop`为`false`喜欢

```
$(".fancybox").fancybox({
 loop: false
}); 
```

**问**：如何让过渡淡出而不是从顶部翻转，这样大文件的动画效果不佳？

**答**：使用这些选项

```
 openEffect: 'fade',
  prevEffect: 'fade',
  nextEffect: 'fade' 
```

# xcode - ipad 应用程序 - 大多数视图旋转正常。一种观点不

> ID：10419221
> 
> 赞同：0
> 
> 时间：2012-05-02T18:03:30.950
> 
> 标签：xcode, ios5, rotation

我正在构建一个所有视图都应该自动旋转的 iPad 应用程序。一种观点让我很头疼。

我知道这个问题的变体已经被问过几次了，但我找不到一个可行的解决方案..

我通过调用应用程序中的例程来切换到此视图。代表。这个例程的代码是：

```
- (void)flipToBack {
    //NSLog(@"%s", __FUNCTION__);

    DrawingViewController *drawView = [[DrawingViewController alloc] initWithNibName:@"Draw" bundle:nil];
    [self setDrawingViewController:drawView];
    [UIView beginAnimations:nil context:NULL];
    [UIView setAnimationDuration:1.0];
    [UIView setAnimationTransition:UIViewAnimationTransitionFlipFromRight forView:window cache:YES];

    [self.window addSubview:[drawView view]];
    [UIView commitAnimations];

    //  NSLog (@" FINISHED ");
} 
```

这是一个带有 UIView 子视图的视图控制器 (mvc)，后者在其中进行绘图。mvc 和子视图都没有正确旋转。

我用来在 mvc 中调用旋转的代码是：

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return YES;
} 
```

mvc 有两个工具栏，顶部和底部，需要调整大小。无论旋转如何，这些也应保持在顶部和底部。

项目摘要显示支持所有方向，但我认为这仅适用于应用程序。初始化。

我已经为 mvc 启用了所有的支柱。

我正在构建这样的工具栏：

```
UIInterfaceOrientation fieldOrient = [[UIApplication sharedApplication] statusBarOrientation];
    if ((fieldOrient == UIDeviceOrientationLandscapeLeft) || (fieldOrient == UIDeviceOrientationLandscapeRight)) {
        CGRect frame = CGRectMake(0, 50, 1024, 35 );
        topToolbar.frame = frame;
    } else {
        CGRect frame = CGRectMake(0, 50, 768, 35 );
        topToolbar.frame = frame;

UIInterfaceOrientation fieldOrient = [[UIApplication sharedApplication] statusBarOrientation];
    if ((fieldOrient == UIDeviceOrientationLandscapeLeft) || (fieldOrient == UIDeviceOrientationLandscapeRight)) {
        CGRect frame = CGRectMake(0, 650, 1024, 35 );
        bottomToolbar.frame = frame;
    } else {
        CGRect frame = CGRectMake(0, 950, 768, 35 );
        bottomToolbar.frame = frame; 
```

我想我错过了一些明显的东西。任何帮助/指针将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T19:16:38.453

尝试在 will rotate to interface 方法中设置框架：

```
- (void)willRotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration {

    if ((toInterfaceOrientation == UIDeviceOrientationLandscapeLeft) || (toInterfaceOrientation == UIDeviceOrientationLandscapeRight)) {
        CGRect frame = CGRectMake(0, 650, 1024, 35 );
        bottomToolbar.frame = frame;
    } else {
        CGRect frame = CGRectMake(0, 950, 768, 35 );
        bottomToolbar.frame = frame;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-06T09:20:28.883

我的答案是将视图呈现为模态视图。这并不理想，但它有效。

# android - 回到以前的活动时，来自 webview 的 JSInterface 未定义

> ID：10419226
> 
> 赞同：1
> 
> 时间：2012-05-02T18:03:58.907
> 
> 标签：android, android-webview, android-activity

我有一个 webview，它有一个 JSInterface ：

```
mWebView.addJavascriptInterface(new JSInterfacelistArticle(mWebView, this, website), "interfaceWebsite"); 
```

当我使用 javascript 函数从我的界面调用函数时：

```
window.interfaceWebsite.doToast(info); 
```

第一次工作正常，但是当我的活动完成（），然后我回到这个，我得到了这个错误：

```
E/Web Console(28654): Uncaught TypeError: Cannot call method 'doToast' of undefined at :1 
```

为什么当我第二次开始我的活动时我的界面不工作？

编辑：如果我删除窗口。当我调用一个函数时，我得到：

```
Uncaught ReferenceError: interfaceWebsite is not defined at :1 
```

所以我确定我的界面在第二次加载时有问题......

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T15:35:09.400

我为我的 webview 覆盖了我的 loadurl 函数：

```
mWebView.setWebViewClient(new WebViewClient() {
               @Override
               public boolean shouldOverrideUrlLoading(WebView view, String urlNewString) {
                   loadingFinished = false;
                   mWebView.loadUrl(urlNewString);
                   return true;
               }

               @Override
               public void onPageFinished(WebView view, String url) {
                   super.onPageFinished(view, url);
                   loadingFinished = true;
                }
            }); 
```

有时我需要将 loadingFinished 设置为静态变量，但我忘记了当我创建我的活动的新实例时我的 var 不会更新：只需将 loadingFinish 设置为 false；

**现在，我的线程等到我的 webview 完全加载网站**

是的，相当愚蠢。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-11-24T22:12:30.673

在脚本的开头，添加：

```
while(typeof JSInterface === "undefined"){  } 
```

这将“等待” JSInterface 加载，并不完美，但效果非常好

# scala - 链接到来自 scaladoc 的来源？

> ID：10419227
> 
> 赞同：8
> 
> 时间：2012-05-02T18:03:59.463
> 
> 标签：scala, sbt

我需要从我的 scaladoc 链接到 github 上的资源。`doc`我用 sbt 的任务来构建这些文档。

有两个问题 - 首先，我不喜欢为我的`.scala`文件创建多个嵌套的空目录，所以我通常将它们打包成一个 - 比如`src/main/scala/org.rogach.scallop`而不是`src/main/scala/org/rogach/scallop`. 有没有办法在不拆分该目录的情况下使指向文档的链接起作用？

其次，当我将此行放入 build.sbt 时：

```
scalacOptions in (Compile, doc) ++=
  Opts.doc.sourceUrl("https://raw.github.com/Rogach/scallop/master/src/main/scala/") 
```

docs 包含指向源的链接，但所有这些链接仅指向源根 url，而不是文件本身。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-02T23:27:45.127

从输出`scaladoc help`：

```
-doc-source-url <url>        A URL pattern used to build links to template
                             sources; use variables, for example:
                               €{TPL_NAME} ('Seq'),
                               €{TPL_OWNER} ('scala.collection'),
                               €{FILE_PATH} ('scala/collection/Seq') 
```

（是的，那是欧元符号。）

如果您的所有源都在包中定义，则类似以下内容应作为 sourceUrl 的参数：

```
https://raw.github.com/Rogach/scallop/master/src/main/scala/€{TPL_OWNER}.€{TPL_NAME}.scala 
```

# jquery - 如何从表格单元格的内容中提取值？

> ID：10419228
> 
> 赞同：0
> 
> 时间：2012-05-02T18:03:59.907
> 
> 标签：jquery, asp.net-mvc-3, html-table

我有一张有 4 列的桌子：

```
<table id="myTable">
  <th>
    <td> A </td>
    <td> B </td>
    <td> C </td>
    <td> D </td>
  </th>
  <tr>
    <td> 
      <span>A-1</span>  <span>A-3</span>  <span>A-5</span>
    </td>
    <td> 
      <span>B-2</span> <span>B-3</span>
    </td>
    <td> 
      <span>C-3</span>   <span>C-4</span>   <span>C-7</span>
    </td>
    <td> 
      <span>D-1</span>
    </td>
  </tr>
</table> 
```

我有一个带有更改处理程序（A=1、B=2 等）的 A、B、C 和 D 下拉列表：

```
 @Html.DropDownListFor(model => model.TypeID, new SelectList(Model.Types, "Key", "Value", Model.TypeID))

  $('#myTable').change(function () {
    var type = $(this).val();
     if (type == 1) {
        var tr = $('#current tr')[0];
        var td = tr.cells[0].innerHTML;
        var last = $(td).find(':last-child');
        /// how do I get the contents of the last span???
     } else if ( type == 2 ) {
        ...
     }

  }); 
```

最后，一个文本框：

```
 @Html.TextBoxFor(model => model.next) 
```

当用户从下拉列表中选择选择时，我想根据适当表格单元格中最后一个跨度中的内容放置适当的“下一个”值。我似乎无法弄清楚如何获得最后一个并提取价值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T18:08:30.867

```
$('#myTable').change(function () {
    var type = +$(this).val();
     if (type === 1) {
        var tr = $('#current tr');
        var td = tr.find('td:eq(0)');
        var last = td.find('span:last');
        var contents = last.html();
     } else if ( type == 2 ) {
        ...
     }

  }); 
```

# reporting-services - 从表达式生成时，SSRS 中的 DB2 查询失败

> ID：10419231
> 
> 赞同：0
> 
> 时间：2012-05-02T18:04:06.343
> 
> 标签：reporting-services, db2

我正在尝试基于 DB2 查询在 SSRS 中创建共享数据集。数据源使用 DB2OLEDB 提供程序。

当我直接以文本形式输入查询时，它会正确执行：

```
SELECT BTCH_DT FROM FMSCHEMA.TTRANS_HIST_DETL WHERE REC_NO = 13288604 
```

但是，当我单击查询窗口旁边的表达式按钮时，输入以下内容：

```
="SELECT BTCH_DT FROM FMSCHEMA.TTRANS_HIST_DETL WHERE REC_NO = 13288604" 
```

查询失败

```
ILLEGAL SYMBOL "=?<ERR_STMT> <WNG_STMT> GET SQL SAVEPOINT HOLD FREE ASSOCIATE". SOME SYMBOLS THAT MIGHT BE LEGAL ARE: SQLSTATE: 42601, SQLCODE: -104 
```

似乎 SSRS 试图将表达式本身传递给 DB2OLEDB 提供程序，而不是评估表达式并传递该评估的结果。

我已经查看了 IBM 的网站： http: [//publib.boulder.ibm.com/infocenter/db2luw/v8/index.jsp](http://publib.boulder.ibm.com/infocenter/db2luw/v8/index.jsp?topic=/com.ibm.db2.udb.doc/core/rsql0100.htm) ?topic=/com.ibm.db2.udb.doc/core/rsql0100.htm但是为 SQSLSTATE 42601 提供的信息不是很有帮助：“字符、标记或子句无效或丢失。”

任何人都可以对此有所了解吗？或者指出我正确的方向？谢谢！

# iphone - UIButton 的标签在 UITableView 中间歇性出现

> ID：10419234
> 
> 赞同：0
> 
> 时间：2012-05-02T18:04:20.570
> 
> 标签：iphone, objective-c, uitableview, uibutton

我有一个带有一些数据的 UITableView。控件之一是 UIButton，分配了标签。因此，在极少数情况下，当我按下 UITableView 屏幕时，按钮会出现没有标签。滚动 UITableView 或旋转设备后，会出现标签。

我在 drawRect 方法中放置了一个 NSLog 条目。在某些情况下不会调用它。

一些建议？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T18:34:09.133

我发现了一些方法很少不调用的相同问题。确保代理设置正确，然后检查结果

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T12:35:00.620

在分析了我的代码后，我看到了一些导致问题的特征。我的屏幕的构建过程发生在事件线程的不同线程中。所以，我解决了这个问题，现在一切都很好。

谢谢。

# android - android中Activity重新创建和进程重新创建之间的区别

> ID：10419235
> 
> 赞同：0
> 
> 时间：2012-05-02T18:04:32.147
> 
> 标签：android, process, activity-lifecycle

我一直试图弄清楚这一点，但我现在似乎陷入了困境。基本上，我试图了解 Activity 何时被销毁和重新创建与它运行的进程何时被销毁和重新创建之间的区别。

根据此处的图表：http: [//developer.android.com/reference/android/app/Activity.html](http://developer.android.com/reference/android/app/Activity.html)，似乎只有在重新创建底层应用程序进程时才重新创建活动。

但是，假设我用一个按钮创建了一个简单的程序：

```
public class HelloAndroidActivity extends Activity {
private int test = 15;

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    Button button = (Button)findViewById(R.id.button1);
    button.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {
            Toast.makeText(getApplicationContext(), test + " ", Toast.LENGTH_SHORT)
                       .show();
            test++;
        }
    });
}
} 
```

现在，当我单击按钮时，它将显示数字 15、16、17...。但是，如果我离开程序并转到主菜单并重新进入它，或者我更改屏幕方向，那么它会重新设置为 15。所以必须重新创建 Activity。

但是，程序一直在运行（正如您在任务管理器中看到的那样），因此该进程没有被破坏。

同样，如果我将变量 test 更改为静态变量，那么尽管 Activity 被销毁并重新创建，它仍会保留其值。所以流程必须与Activity不同。

根据 Android Activity 网站上的图表，只有当底层进程的内存太少时才会重新创建 Activity，但这里似乎在许多其他场景中重新创建它 - 例如屏幕方向，转到主菜单等

所以我的问题是：Activity 生命周期和底层 Process 生命周期有什么区别？是否存在 Android 图表中未描述的 Activity 重新创建路径，它保留了底层进程？

非常感谢您对这个问题的任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T18:17:08.623

> 根据此处的图表：http: [//developer.android.com/reference/android/app/Activity.html](http://developer.android.com/reference/android/app/Activity.html)，似乎只有在重新创建底层应用程序进程时才重新创建活动。

有很多事情会破坏活动，包括调用`finish()`、用户按下 BACK 按钮（默认情况下会触发`finish()`对）。

> 但是，如果我离开程序并转到主菜单并重新进入它，或者我更改屏幕方向，那么它会重新设置为 15。所以必须重新创建 Activity。

如果“离开程序”的意思是“按 BACK 按钮”，那么这是有道理的。同样，从纵向切换到横向是一种配置更改，因此也很有意义。

> 但是，程序一直在运行（正如您在任务管理器中看到的那样），因此该进程没有被破坏。

正确的。

> 所以流程必须与Activity不同。

正确的。一个应用程序可能有数十个或数百个活动，以及许多其他组件（服务等）。默认情况下，它们都是单个进程的一部分。

> 根据 Android Activity 网站上的图表，只有在底层进程内存太少时才会重新创建 Activity，

不。

> Activity 生命周期和底层 Process 生命周期有什么区别？

该进程将保留在内存中，直到 Android 需要内存用于其他用途。Android 根据正在发生的事情选择要终止的进程，包括年龄、活动组件等。您可以[在文档中阅读有关进程生命周期的](http://developer.android.com/guide/topics/fundamentals/processes-and-threads.html)更多信息。

> 是否存在 Android 图表中未描述的 Activity 重新创建路径，它保留了底层进程？

有很多事情会破坏活动，在图中由指向 的箭头指示`onDestroy()`。我在回答的第一段中列举了其中的几个。一旦活动被销毁，如果再次需要该活动的实例（例如，用户重新启动应用程序），则会创建一个新实例。

# php - IIS 使用 PHP 形成身份验证

> ID：10419245
> 
> 赞同：1
> 
> 时间：2012-05-02T18:05:26.997
> 
> 标签：php, asp.net, iis, forms-authentication

我有一个网站，其中包含 PHP 和 3 个不同的 .Net 应用程序，位于 3 个不同的子文件夹中。一切运作良好。

PHP 应用程序具有内置的身份验证，顶部带有旧的“include security_check.php”。PHP 应用程序还具有用户编辑器（登录）并且是该节目的明星。

我想扩展 PHP 安全方案以包括 .Net 应用程序。为此，我正在考虑将 web.config 放在根目录中并配置 .Net 表单身份验证的方向。这应该包括所有子文件夹。

1.  这将如何影响子文件夹中的 web.config 继承？
2.  我可以使用 PHP 直接处理登录吗？
    或者我是否必须使用 ASPX 来检查包含用户名的 cookie（在 PHP 中设置为成功的身份验证），然后如果它丢失则重定向到 PHP 登录？

# java - 以下算法的复杂度是多少？

> ID：10419246
> 
> 赞同：0
> 
> 时间：2012-05-02T18:05:37.107
> 
> 标签：java, complexity-theory, hamiltonian-cycle

该算法解决了哈密顿路径问题。`G`是一个无向图，`v`起始顶点， `G.size()`图的大小，`G.get(v).gV`当前顶点的所有邻居顶点。

```
static private void dfs(HashMap<Integer, Virsune> G, int v) {
    path.push(v);
    // add v to the current path
    onPath[v] = true;

    if (path.size() == G.size()) {
        System.out.println(path);

        Integer[] tmp = new Integer[G.size()];
        System.arraycopy(path.toArray(), 0, tmp, 0, path.size());
        hamPaths.add(tmp);
    }

    for (int w : G.get(v).gV) {
        if (!onPath[w]) {
            dfs(G, w);
        }
    }

    path.pop();
    onPath[v] = false;

} 
   // main method
   dfs(G,0); 
```

我可以说这个算法的复杂度是 O(n!) 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T18:15:34.500

这是算法枚举图的所有路径。

如果您要枚举图中的所有路径，这应该会在运行时给您一个提示。在一个完整的图中，确实有 n! 路径，所以这是一个下限。我会让你说它是否也是一个上限。

FWIW - 问题可以在 O(2^n) 中解决

# django - 具有多个 S3 存储桶的 django-storages

> ID：10419248
> 
> 赞同：29
> 
> 时间：2012-05-02T18:05:52.613
> 
> 标签：django, amazon-web-services, python-django-storages

我正在使用 AWS，我的应用程序中会有不同的存储桶。我也在使用 Django-Storages。有没有办法指定我要将文件上传到哪个存储桶（例如，作为 Save() 函数中的参数或其他什么？）

我看到了这个[Django - Error importing storages.backends](https://stackoverflow.com/questions/9430770/django-error-importing-storages-backends)，但我不明白应该如何使用它？！

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-05-02T18:30:39.777

`S3BotoStorage`将存储桶名称作为参数。如果没有给出，它将使用该`AWS_STORAGE_BUCKET_NAME`设置。这意味着如果您想`S3BotoStorage`使用默认存储后端，`DEFAULT_FILE_STORAGE`那么它必须使用默认存储桶。

但是，您也可以在字段级别分配存储：

```
from django.db import models
from storages.backends.s3boto import S3BotoStorage

class MyModel(models.Model):
    file_1 = models.FileField() # Uses default storage
    file_2 = models.FileField(storage=S3BotoStorage(bucket='other-bucket')) 
```

**编辑**：

评论已经失控，所以我会更新我的答案。基于实例更改存储后端的参数并不是 Django 存储 API 的设计目的。存储后端不知道模型实例，因为存储可以在模型上下文之外使用，例如静态文件。并非完全不合理，但这不是 Django 或 django-storages 旨在解决的用法。我不希望您找到可以为您处理此问题的存储后端。

文档描述了如何手动管理文件：[https](https://docs.djangoproject.com/en/1.9/topics/files/#storage-objects) ://docs.djangoproject.com/en/1.9/topics/files/#storage-objects至少您需要将存储桶存储在某处保存文件的位置，以便您稍后查询模型时可以找到它。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2014-12-18T08:14:50.553

如果您想在运行时指定存储桶，另一种解决方案是在调用模型上的 save() 方法之前执行此操作。

按照上面的例子：

```
from django.db import models
from storages.backends.s3boto import S3BotoStorage

class MyModel(models.Model):
    file_1 = models.FileField() # Uses default storage
    file_2 = models.FileField() 
```

在保存模型时的视图中，您可以在该字段上指定存储。

```
my_file_model = MyModel()
my_file_model.file_2.storage = S3BotoStorage(bucket="your-bucket-name")
my_file_model.save() 
```

这样，file_2 将保存在您指定的存储桶中，file_1 将使用您的默认存储桶。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2016-08-31T11:22:39.687

只需在 settings.py 中使用**PRIVATE_BUCKET_NAME** ='bucket name' 提及另一个存储桶名称。

创建一个覆盖 S3BotoStorage 并且可以序列化为迁移文件的自定义类。

为类创建一个对象`s3_storage = S3MediaStorage()`并将其存储在 MyModel 的 file1 字段中

```
from storages.backends.s3boto import S3BotoStorage
from django.conf import settings

@deconstructible
class S3MediaStorage(S3BotoStorage):
    def __init__(self, *args, **kwargs):
        kwargs['bucket'] = getattr(settings, 'PRIVATE_BUCKET_NAME')
        super(S3MediaStorage, self).__init__(*args, **kwargs)

s3_storage = S3MediaStorage()

class MyModel(models.Model):
    file = models.FileField()
    file1 = models.FileField(storage=s3_storage) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-12-05T08:53:04.967

对于 S3Boto3Storage 使用这个：

```
media_file = models.FileField('media file', storage=S3Boto3Storage(bucket_name='media_bucket'), upload_to='media', blank=True) 
```

# php - 为什么我无法访问我的数据库？

> ID：10419249
> 
> 赞同：0
> 
> 时间：2012-05-02T18:05:53.823
> 
> 标签：php, mysql, oop

这是我的 dbconnect.class.php

```
<?php 

class Connect
{
    //public $error;
    public $db;
    public function __construct()
    {
        $link = mysql_connect("localhost","root","1");
        $db = mysql_select_db("tarih",$link);
        $this->db = $db;
    }
}

$connect = new Connect();
$connect = $connect->db;
?> 
```

这是主要的php文件（header.class.php）

```
<?php
require_once ('dbconnect.class.php');
class Header extends Connect
{ 
    public $headers = array();
    public function __construct() 
    { 
        /* 
        * Bu sınıf sayfaların header bilgilerini işler. 
        */  
    } 

    public function sayfaHeader($sayfa = true) 
    { 
        $sql = "SELECT * FROM header WHERE id='" . $sayfa . "'"; 
        $query = mysql_query($sql,$connect) or mysql_error(); 
        echo $sql;
    } 

} 

$header = new Header();
echo $header->sayfaHeader();
?> 
```

但是当我运行这段代码时，我看到了这个错误：

> 警告：mysql_query()：提供的参数不是第 16 行 C:\AppServ\www\ilk\class\header.class.php 中的有效 MySQL-Link 资源

问题是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T18:10:12.100

该变量`$connect`不在类的范围内。要么你把它排除在外，然后`mysql_query`选择最后一个可用的资源。或者您可以将`$connect`变量传递到类中：

```
require_once ('dbconnect.class.php');
class Header extends Connect
{ 
    public $headers = array();
    protected $database;

    public function __construct($database) 
    { 
        /* 
        * Bu sınıf sayfaların header bilgilerini işler. 
        */  
        $this->database = $database;
    } 

    public function sayfaHeader($sayfa = true) 
    { 
        $sql = "SELECT * FROM header WHERE id='" . $sayfa . "'"; 
        $query = mysql_query($sql,$this->database) or mysql_error(); 
        echo $sql;
    } 
} 

$header = new Header($connect); // here you pass-through your resource
echo $header->sayfaHeader(); 
```

* * *

我还想提一下，您应该研究一下[Design Patterns](http://www.ibm.com/developerworks/library/os-php-designptrns/)，因为它只是您正在创建的一些伪 OOP。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T18:09:55.177

您的`$connect`变量是父类。您需要指向`$link`它包含的变量。

改变：

```
$query = mysql_query($sql, $connect) or mysql_error(); 
```

至

```
$query = mysql_query($sql,$link) or mysql_error(); 
```

# arrays - 为什么要双倍堆叠容量而不是仅仅增加固定数量？

> ID：10419250
> 
> 赞同：4
> 
> 时间：2012-05-02T18:05:56.983
> 
> 标签：arrays, stack

我正在使用堆栈的数组实现，如果堆栈已满而不是抛出错误，我将数组大小加倍，复制元素，更改堆栈引用并将新元素添加到堆栈中。（我正在按照一本书自学这些东西）。

我不完全明白的是为什么要加倍，为什么不按固定数量增加，为什么不增加3倍。

我认为这与时间复杂度有关吗？

一个解释将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T18:10:53.193

加倍刚刚成为诸如数组列表（“动态”大小的数组，实际上只是在后台执行您正在执行的操作）和由数组支持的最动态大小的数据类型之类的通用实现的标准。如果您知道您的场景并且有时间和意志力来编写自定义堆栈/数组列表实现，那么您当然可以编写一个更优化的解决方案。

如果您在软件中知道在构建初始数组后很少会添加项目，则可以使用特定大小对其进行初始化，然后仅将其增加为保留内存的添加内容的大小。

另一方面，如果您知道列表会非常频繁地扩展，您可能会选择在空间不足时将列表大小增加 3 倍或更多。

对于作为公共库一部分的通用实现，您的实现细节和要求是未知的，因此加倍只是一个快乐的媒介。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-02T18:14:51.907

从理论上讲，您确实达到了不同的时间复杂度。如果你增加一个常数大小，你将重新分配的数量（因此 O(n) 个副本）除以一个常数，但你仍然会得到 O(n) 的附加时间复杂度。如果将它们加倍，则追加的时间复杂度会更高（平均化 O(1) IIRC），并且由于最多消耗两倍于所需的内存，因此空间复杂度仍然相同。

在实践中，它不那么严重，但仍然可行。副本很昂贵，而一些内存通常不会受到伤害。这是一个折衷方案，但您必须非常低的内存才能选择另一种策略。通常，您事先不知道（或由于 API 限制而无法让堆栈知道）您实际需要多少空间。例如，如果你从一个元素开始构建一个 1024 个元素的堆栈，你会从 1024/K 开始（我可能会偏离一个）10 次重新分配——假设 K=3，这大约是 34 倍许多重新分配，只是为了节省一点内存。

任何其他因素也是如此。2 很好，因为你永远不会得到非整数大小，而且它仍然很小，将浪费的空间限制在 50%。其他因素可能会更好地服务于特定用例，但通常投资回报率太小，无法证明重新实现和优化某些库中已有的内容是合理的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-02T18:10:12.973

固定数量的问题在于选择该固定数量 - 如果您（例如）选择 100 个项目作为您的固定数量，那么如果您的堆栈当前大小约为 100 个项目，这是有道理的。但是，如果您的堆栈已经有 10,000 个项目，它*可能*会增长到 11,000 个项目。您不想进行 10 次重新分配/移动以将堆栈大小增加 10%。

至于 2x 与 3x，那是相当随意的——选择 3x 没有错；哪个“更好”取决于您的确切用例以及您如何定义“更好”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-08T20:19:35.950

按 2 倍缩放很容易，并且将确保平均复制项目不超过两次 [扩展将第一次复制一半的项目，第二次复制四分之一，第三次复制八分之一，等等。] 如果事情相反增长了一个固定的数量，然后当例如执行第二十次扩展时，将有一半的项目将被复制第十次。

增长超过 2 倍将增加平均“永久”闲置空间；以较小的因子增长将增加分配和放弃的存储量。根据永久分配和放弃分配的相对感知“成本”，最佳增长因子可能更大或更小，但*任何接近最佳的增长因子通常不会比最佳增长因子表现得差太多*。无论最佳增长因子是多少，2 倍的增长因子都将足够接近以产生良好的性能。

# c# - 是否在 C# 项目中包含外部 DLL

> ID：10419252
> 
> 赞同：3
> 
> 时间：2012-05-02T18:06:04.370
> 
> 标签：c#, dll, project, external

我们的项目有很多外部 DLL，大部分但不是全部都是 3rd 方 DLL。

目前我们的项目中没有这些 DLL。它们包含在 SVN 中，并为我们的构建输出目录提供了路径。因此，在构建我们的项目之后，由于 SVN，必要的文件就在那里，但项目本身并不知道它们。

我的感觉是，我们应该在项目的根目录下有一个文件夹，命名为 Dependancies 或 ThirdParty，其中包含所有 DLL，并将它们的构建事件设置为复制到输出目录。它们也将存在于 SVN 中，但与项目具有相同的结构，而不是在构建输出目录中。

项目本身仅引用这些称为 CommunicationProc.DLL 的 DLL 之一。CommunicationProc.DLL 然后引用所有其他 DLL。我们有许多 DLL 来支持不同类型的无线电。因此，并非所有的 DLL 都会被使用，但根据无线电类型，可以使用其中的任何一个。

至于DLL是否应该包含在项目中，我们内部有不同的意见，一些团队认为它们应该只在SVN中，而不是项目本身的一部分。

值得注意的是，这不是 .NET DLL，大多数是旧的 C DLL。

公认的做法是什么？有人可以以一种或另一种方式为我提供一个令人信服的论点，关于是将它们包含在项目中还是仅包含在 SVN 中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T18:18:27.443

最好将它们放在源代码管理的文件夹中，然后在构建事件时将它们复制到调试文件夹中。这样您就可以管理他们的版本。如果某个 dll 的较新版本出现，那么您可以替换旧版本并在签入时添加一些注释。此外，如果您在一个团队中工作，那么您可以让每个团队都不要将文件从调试文件夹复制到每个团队成员成员使用源代码管理中的同一组 dll。如果您正在开发一些控件并希望您的客户使用该控件，那么您可以更轻松地在某些地方拥有一组依赖 dll，以便您可以将这些与您的 .Net dll 一起提供给您的客户。
我对一些非托管的 dll 有同样的问题，最终将它们放在一个文件夹中，以便所有团队成员都拥有相同版本的 dll。希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T18:36:47.060

我包含一个没有代码但包含一个文件夹，其中保存了所有外部程序集及其依赖项的项目。对于每个文件，将 Build Action 设置为 None 并将 Copy to Output 设置为 Do Not Copyp。然后，该项目从该位置引用二进制文件。在您的其他项目中，请参考此特殊项目。构建时，因为引用了特殊项目并且它引用了所有需要的依赖项，所以会根据需要复制二进制文件。

如果你不想要一个特殊的项目，仍然在你的主项目中创建文件夹，添加程序集，设置它们的属性，然后根据需要引用程序集。

这使您可以完全控制版本和输出，更重要的是，它很简单。

# c# - 在 xsl 转换后添加到 xml 文件的顶部

> ID：10419254
> 
> 赞同：7
> 
> 时间：2012-05-02T18:06:15.180
> 
> 标签：c#, xml, excel, xslt

我已经成功地能够使用 xsl 模板将带有数据的简单 xml 文件转换为另一个 xml 文件（excel 模板），这就是我的 xsl 文件的样子：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
  <xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output method="xml" standalone="yes"/>

    <xsl:template match="/">
      <xsl:processing-instruction name="mso-application">
        <xsl:text>progid="Excel.Sheet"</xsl:text>
      </xsl:processing-instruction>
    ...(stuff here)...
    </xsl:template>
  </xsl:stylesheet> 
```

生成的 xml 文件被正确写出，但除了包括

```
<?xml version="1.0"?> 
```

在文件的顶部。我怎样才能让它出现在顶部？

目前我生成的 xml 文件以：

```
<?mso-application progid="Excel.Sheet"?>
...(rest of file)... 
```

但我需要它做的是：

```
<?xml version="1.0"?>
<?mso-application progid="Excel.Sheet"?>
.(rest of file)... 
```

我正在使用以下代码通过 Windows 窗体进行此转换：

```
XPathDocument myXPathDoc = new XPathDocument(xmlfile);
XslCompiledTransform myXslTrans = new XslCompiledTransform();
myXslTrans.Load(xslfile);
XmlTextWriter myWriter = new XmlTextWriter(xmlexcelfile, null);
myWriter.Formatting = Formatting.Indented;
myWriter.Namespaces = true;
myXslTrans.Transform(myXPathDoc, null, myWriter);
myWriter.Close(); 
```

我试过玩弄`xsl:output standalone="yes/no"`, 和`omit-xml-declaration="no"`. 我也尝试过（在 C# 中）`myWriter.WriteStartDocument();`在转换之前添加代码，但这是不允许的。我也尝试在网上搜索此内容并不断返回，`standalone="yes"`但这不起作用。我在这里缺少什么吗？哦，如果你想知道为什么我需要

```
<?xml version="1.0"?> 
```

在结果文件的顶部，这是因为使用 excel 打开 xml 文件时，excel 无法正确识别它，但如果包含它，则 excel 会正确打开它...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-02T18:10:08.773

你可以这样做

```
<xsl:output method="xml" indent="yes" omit-xml-declaration="no" /> 
```

或类似的东西使用`XmlWriterSettings`

**编辑**：添加了更多代码。以前缺少一些部分

```
 XmlWriterSettings writerSettings = null;
        XsltArgumentList transformationArguments = null;
        XslCompiledTransform transformer = null;
        MemoryStream memoryStream = null;
        XPathDocument xPathDocument = null;
        StringBuilder sb = null;
        XmlWriter writer = null;
        XmlDocument resultXml = null;
        try
        {
            writerSettings = new XmlWriterSettings();
            writerSettings.OmitXmlDeclaration = false; // This does it
            writerSettings.Indent = true;

            transformationArguments = new XsltArgumentList();
            transformer = new XslCompiledTransform();
            memoryStream = new MemoryStream(System.Text.Encoding.Default.GetBytes(xml.OuterXml));
            xPathDocument = new XPathDocument(new StreamReader(memoryStream));
            sb = new StringBuilder();
            // give the settings to the writer here
            writer = XmlWriter.Create(sb, writerSettings);
            // this is not mandatory, obviously, just passing parameters to my xslt file
            foreach (KeyValuePair<string, object> parameter in parameters)
            {
                transformationArguments.AddParam(parameter.Key, string.Empty, parameter.Value);
            }

            using (Stream strm = Assembly.GetExecutingAssembly().GetManifestResourceStream("Lib.XSLTFile1.xslt"))
            using (XmlReader reader = XmlReader.Create(strm))
            {
                transformer.Load(reader);
                transformer.Transform(xPathDocument, transformationArguments, writer);
            }
            resultXml = new XmlDocument();
            resultXml.LoadXml(sb.ToString());
            // for testing only
            File.AppendAllText(@"Your path goes here\result.xml", resultXml.OuterXml);
        }
        catch (Exception)
        {
            throw;
        } 
```

我就是这样做的，但是这段代码是专门为创建一个`XmlDocument`. 我相信你可以适应你的需要。

# html - cakephp在不编码的情况下添加标签

> ID：10419255
> 
> 赞同：0
> 
> 时间：2012-05-02T18:06:32.733
> 
> 标签：html, cakephp, doctype, cakephp-2.1

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T18:21:55.247

您错误地关闭了锚标记：您正在使用`<a/>`而不是`</a>`

它应该是：

```
 echo '<p>' . __('Datasheet: ') . '<a href="http://localhost/xxx/cakephp2/files/'.$product['datasheeturl'].'"><img src="http://localhost/xxxx/cakephp2/img/pdf.gif" alt="pdf image"></a></p>'; 
```

# linux - 如何分别编译 getopt 和 getopts？

> ID：10419256
> 
> 赞同：0
> 
> 时间：2012-05-02T05:44:05.640
> 
> 标签：linux, bash, compilation

我正在查看 bash 的源代码，并且能够`getopts.c`使用`mkbuiltins`可执行文件创建一个。现在我正在尝试创建单独`getopt`的`getopts`二进制文件。我该怎么做呢？

我在 x86 上使用 Ubuntu。

# git - 在 post-receive 钩子中跳过之前已经处理过的 Git 修订的处理

> ID：10419259
> 
> 赞同：4
> 
> 时间：2012-05-02T18:06:55.427
> 
> 标签：git, git-post-receive

我有一个 git post-receive 钩子，它提取在“git push”期间添加的所有修订，并对每个修订进行一些处理（例如发送通知电子邮件）。这很好用，除非在合并时；例如：

1.  我在 branch1 上进行了一些提交，然后推送了 branch1。post-receive 挂钩正确处理提交。
2.  我将分支 1 合并到分支 2 中，然后推送分支 2。post-receive 钩子第二次处理所有合并的提交。

我怎样才能避免这种情况？下面是我的 post-receive 钩子的开始，我从中提取应该处理的提交（最后 $COMMITS 保存要处理的提交列表）。

```
#!/bin/sh

REPO_PATH=`pwd`
COMMITS=''

SHELL=/bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin

# for each ref that was updated during the push
while read OLD_REV NEW_REV REF_NAME; do
  OLD_REV="`git rev-parse $OLD_REV`"
  NEW_REV="`git rev-parse $NEW_REV`"
  if expr "$OLD_REV" : '0*$' >/dev/null; then
    # if the branch was created, add all revisions in the new branch; skip tags
    if ! expr "$REF_NAME" : 'refs/tags/' >/dev/null; then
      REF_REV="`git rev-parse $REF_NAME`"
      REF_NAME="`git name-rev --name-only $REF_REV`"
      COMMITS="$COMMITS `git rev-list $REF_NAME | git name-rev --stdin | grep -G \($REF_NAME.*\) | awk '{ print $1 }' | tr '\n' ' '`"
    fi

  elif expr "$NEW_REV" : '0*$' >/dev/null; then
    # don't think branch deletes ever hit a post-receive hook, so we should never get here
    printf ''
  else
    # add any commits in this push
    COMMITS="$COMMITS `git rev-parse --not --all | grep -v $(git rev-parse $REF_NAME) | git rev-list --reverse --stdin $(git merge-base $OLD_REV $NEW_REV)..$NEW_REV | tr '\n' ' '`"
  fi
done 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-03T05:30:19.963

看看`$(prefix)/share/git-core/contrib/hooks/post-receive-email`，这正是你想要的（我认为）。基本上，它用于`git for-each-ref`查找所有分支的名称，然后排除从某个分支可访问的每个提交，而不是正在更新的分支：

```
if [ "$change_type" = create ]
then
    # Show all revisions exclusive to this (new) branch.
    revspec=$newrev
else
    # Branch update; show revisions not part of $oldrev.
    revspec=$oldrev..$newrev
fi

other_branches=$(git for-each-ref --format='%(refname)' refs/heads/ |
     grep -F -v $refname)
git rev-parse --not $other_branches | git rev-list --pretty --stdin $revspec 
```

（我在这里对其进行了简化，希望不会在我的剪切和粘贴工作中损坏任何东西。这里的输入是：`$change_type`如果`create`是`$oldrev`全零，否则它是`update`;`$oldrev`是来自最近从标准输入读取的行中的旧 rev SHA1 ;`$newrev`是新的 rev SHA1；并且`$refname`是全名，例如`refs/heads/topic`.)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T19:47:15.643

我们所做的是将之前处理过的提交的哈希值保存在一个文本文件中。每次钩子运行时，它都会查看该文件以检查给定的提交是否已被处理。如果它尚未处理该提交，请处理它，然后将该提交记录到文件中。

这不是很可扩展，因为文本文件只会随着更多提交添加到存储库而增长，并且检查给定提交的时间也会增长。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-27T00:06:57.920

我完全在接收后挂钩中实现了这一点。它只通知 trac 自上次 fetch 以来的新提交***而不复制***，无论新提交是同时推送到单个分支还是多个分支。此方法在您的 git 目录中保留一个名为的文件`TRAC_HEAD`，用于跟踪哪些提交已被处理。

建议您在启用钩子之前`cat refs/heads/* > TRAC HEAD`在您的目录中运行。`.git`

```
#!/bin/sh
#
# Reads and notifies trac of only new commits that have not yet been dealt with.
#
# The "post-receive" script is run after receive-pack has accepted a pack
# and the repository has been updated.  It is passed arguments in through
# stdin in the form
#  <oldrev> <newrev> <refname>
# For example:
#  aa453216d1b3e49e7f6f98441fa56946ddcd6a20 68f7abf4e6f922807889f52bc043ecd31b79f814 refs/heads/master
#

TRAC_PATH="/path/to/trac/env"

# Read the standard input
while read oldrev newrev refname ; do

        echo "Processing branch: $refname"

        # Read the last revisions for each branch from TRAC_HEAD
        exclusions=$(cat TRAC_HEAD | uniq |  sed -e 's/^/^/' -e 's/ / ^/g' | xargs echo)

        echo "Exclusion list: $exclusions"

        git rev-list --reverse $newrev $exclusions | while read rev ; do
                trac-admin $TRAC_PATH changeset added '(default)' $rev
                echo "Processed: $rev"
        done

        # Add to the exclusions file the latest revision from this branch
        echo $newrev >> TRAC_HEAD

done

# Update the TRAC_HEAD file
cat refs/heads/* > TRAC_HEAD 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-02T20:53:45.223

我们通过让 post-receive 钩子在遇到合并提交（具有两个或多个父项的提交）时停止处理来做到这一点。这在推动合并时需要一些纪律，以确保其他“真实”提交不会被丢弃。规则是始终在合并之前推送，然后分别推送合并。

# objective-c - 精灵的设置纹理不起作用

> ID：10419265
> 
> 赞同：1
> 
> 时间：2012-05-02T18:07:19.157
> 
> 标签：objective-c, cocos2d-iphone

我正在尝试用这个设置纹理：

```
[[self setSpriteByTag] setTexture:[[CCTextureCache sharedTextureCache] addImage:[NSString stringWithFormat:@"%@0001.png",face]]]; 
```

当`[self setSpriteByTag]`返回一个精灵`face`是一个图像字符串时，它们都可以，因为我已经记录了它们。

这个精灵是一个页面的子页面`ccscrolayer`：图层页面的一个页面：

```
 CCLayer *page1 = [[CCLayer alloc] init];
        BACK.position=ccp(screenSize.width/2,screenSize.height/2);
         [page1 addChild:BACK]; 
```

当我试图改变`BACK`图像时，使用我在这里写的命令。发生的事情是我看到一个白屏。我检查了图像是否在我的资产中。

可能是什么问题呢 ？我更改作为页面子级的精灵的原因？

**编辑 ：**

这是给我精灵 BACK 的函数：

```
-(CCSprite*)setSpriteByTag 
{

     int currentPage=[scroller currentScreen];
     [globals sharedGlobals].currentPageG=currentPage; //move to touch ended?
     currentPage=currentPage+1;
     //NSLog(@"PAGE:%d",currentPage);

    if(currentPage==1)
    {[globals sharedGlobals].WhatFace =@"BeastFace";  return  BACK;} 
    else if(currentPage==2)
    {[globals sharedGlobals].WhatFace =@"BlueFace"; return BACK1;}
    else if(currentPage==3) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T19:06:29.663

仅当资源中不存在图像时才会变为白色..我检查了运行相同的代码..它工作正常..如果我输入了不存在的图像的错误名称..它变为白色...请检查图像

```
[NSString stringWithFormat:@"%@0001.png",face] 
```

我确定问题出在图像名称中.. :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T20:01:35.480

```
[NSString stringWithFormat:@"%@0001.png",face] 
```

您的文件名必须采用“xxxxx0001.png”格式。假设 face 变量是字符串“BeastFace”，那么要加载的文件名将是“BeastFace0001.png”。

到目前为止，显而易见但请记住，文件“Beastface0001.png”不会加载到设备上，“beastface0001.png”也不会加载，因为 iOS 设备使用区分大小写的文件系统。它可以在 iOS 模拟器上运行。

# c++ - C 和 Python，未找到 Py_InitModule 方法

> ID：10419270
> 
> 赞同：7
> 
> 时间：2012-05-02T18:07:40.980
> 
> 标签：c++, python, c

我一直在关注一些关于如何为 Python 构建 C 模块的代码示例，但似乎 Py_InitModule 没有在任何地方定义。

大多数消息来源说它在 modsupport.h 文件中，但宏没有在那里定义。

我正在使用 Win32 二进制文件下载提供的包含，一切似乎都在检查中。

有什么建议么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-14T15:53:35.720

在 2.7.2、Python 2 或 3 上对我有用吗？例如，对于名为 Example:
Python 2 的模块：

```
/* Module entry point Python 2 */

PyMODINIT_FUNC initExample(void)
{
    (void) Py_InitModule("Example", ExampleMethods);
} 
```

蟒蛇 3：

```
/* Module entry point Python 3 */

PyMODINIT_FUNC PyInit_Example(void)
{
    return PyModule_Create(&Example_module);
} 
```

# windows-phone-7 - 如何从 Windows Phone 7 执行 HttpWebRequests？

> ID：10419273
> 
> 赞同：0
> 
> 时间：2012-05-02T18:07:45.053
> 
> 标签：windows-phone-7, httpwebrequest, httpwebresponse

几天来，我一直在寻找问题的答案，但遗憾的是没有运气。我希望你们在这里可以帮助我。

所以，我想做的只是一个简单的对delicious.com API 的调用，它返回我最近的书签（美味术语中的“帖子”）。因此，您只需使用以下 [URI](https://api.del.icio.us/v1/posts/recent?)并输入您的凭据即可登录到 nice.com。

当我从具有 HttpWebRequest 魔力的标准 .NET4 控制台应用程序执行此操作并设置凭据时，它按预期工作。尝试在 WP7 模拟器上执行相同的基本 HttpWebRequest 会导致 WebException 指出“远程服务器返回错误：NotFound。”。当深入研究这个异常时，我可以看到我的响应有一个“未授权”的状态描述。似乎根本没有发生任何身份验证。

接下来我尝试——当我读到设置凭据有时会导致问题时——直接设置“授权”请求头。你猜怎么着，结果是一样的。

我最终得到了以下代码并且没有想法。我希望这里有人能够帮助我并指出方法，我如何从我的 WP7 访问我的书签。

```
public void RetrieveRecentBookmarks(string userName, string password)
{
    HttpWebRequest request = HttpWebRequest.CreateHttp(requestString);

    byte[] bytes = System.Text.UTF8Encoding.UTF8.GetBytes(userName + ":" + password)
    string authInfo = Convert.ToBase64String(bytes);
    request.Headers[System.Net.HttpRequestHeader.Authorization] = "Basic " + authInfo;

    RequestState state = new RequestState(request);
    IAsyncResult result = request.BeginGetResponse(GetResponseCallback, state);
}

private static void GetResponseCallback(IAsyncResult asynchronousResult)
{
    RequestState state = asynchronousResult.AsyncState as RequestState;
    HttpWebRequest request = state.Request as HttpWebRequest;

    // Here is where it breaks...
    HttpWebResponse response = request.EndGetResponse(asynchronousResult) as HttpWebResponse;
} 
```

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T06:29:07.630

据我所知，我的代码绝对正确且有效。正如 Shawn Kendrot 已经提到的，没有工作的是 Emulator 通信。我设置了一个全新的 Win7，安装了 WP7.1 SDK（和 7.1.1 更新），它按预期工作。所以似乎有什么东西阻止了我从模拟器的调用。我不知道它是什么，但我必须承认，我不太在乎它现在正在工作。

感谢 Shawn 指出模拟器和网络有时会出现问题，这将我推向了正确的方向。

# c++ - 在管道中调用时，从 std::cin 加载 pugi::xml_document 失败

> ID：10419274
> 
> 赞同：2
> 
> 时间：2012-05-02T18:07:56.017
> 
> 标签：c++, linux, bash, pugixml

使用 pugixml 1.0

当我使用 shell STDIN 重定向时，从 std::cin 加载 XML 文档有效：

```
$ ./pugitest < sample.xml # OK 
```

但是当在管道中调用时，它会失败：

```
$ cat sample.xml | ./pugitest # FAILS
./pugitest: Error reading from file/stream 
```

这是 pugtest 程序的代码：

```
#include "pugixml.hpp"

#include <iostream>
#include <stdexcept>

int main(int argc, char *const argv[])
{
    try {
        pugi::xml_document doc;
        pugi::xml_parse_result result = doc.load(std::cin);
        if (!result) {
            throw std::runtime_error(result.description());
        }
    } catch (std::exception& e) {
        std::cerr << argv[0] << ": " << e.what() << '\n';
        return 1;
    }

    return 0;
} 
```

我不明白原因。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T05:26:48.610

pugixml 1.0 期望输入流是可搜索的。如果流绑定到文件，则 Seek 有效，但如果流绑定到管道，则搜索失败。

从 pugixml 1.2（昨天发布......昨天:)）开始，不可搜索的流被接受为 load() 源。您的示例在使用 1.2 编译时有效。

# compilation - 如何在 64 位机器上将 .NET 代码编译为 32 位

> ID：10419277
> 
> 赞同：0
> 
> 时间：2012-05-02T18:08:02.177
> 
> 标签：compilation, x86, assemblies, 64-bit, jit

我正在 64 位计算机上开发和部署。不幸的是，由于 64 位 JIT 编译器中的一个错误，自从引入 .NET 64 位版本以来，微软一直存在并且仍未修复，我的代码二次缩放并中断。以下是有关该错误的文档的链接：[http://connect.microsoft.com/VisualStudio/feedback/details/508748](http://connect.microsoft.com/VisualStudio/feedback/details/508748) 旧的 32 位编译器工作正常。我需要将一个 dll 编译为 32 位，并确保它以 32 位运行。

在有人写的解决方法中：

> 由于 Microsoft 在 3 年内还没有弄清楚如何从 20K XSLT 编译的转换脚本创建小于 400MB 的图像，因此我们一直通过将实现任何 XSLT 转换的程序集设置为 32 位来生存。

这是怎么做的？谢谢！

注意：我需要使用 Regex.CompileToAssembly 方法将正则表达式编译成程序集。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T18:24:40.887

在 Visual Studio 中，选择生成菜单并打开配置管理器。查看 Project Contexts 的“Platform”列，并确保为项目选择的平台是 x86，这应确保编译为 32 位目标。

# c# - 十六进制字符串转中文字符串

> ID：10419279
> 
> 赞同：1
> 
> 时间：2012-05-02T18:08:07.743
> 
> 标签：c#, string, hex, cjk

我有以下代码可以从 HEX 转换为 ASCII。

```
//Hexadecimal to ASCII Convertion
private static string hex2ascii(string hexString)
{
    MessageBox.Show(hexString);
    StringBuilder sb = new StringBuilder();
    for (int i = 0; i <= hexString.Length - 2; i += 2)
    {
        sb.Append(Convert.ToString(Convert.ToChar(Int32.Parse(hexString.Substring(i, 2), System.Globalization.NumberStyles.HexNumber))));
    }
    return sb.ToString();
} 
```

输入十六进制字符串 = D3FCC4A7B6FABBB7

输出返回 = ÓüÄ§¶ú»·

我需要的输出是魔狱耳环，但我得到的是 ÓüÄ§¶ú»·。我如何让它显示正确的字符串？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T18:13:30.220

首先，将十六进制字符串转换为 a `byte[]`，例如使用[如何将字节数组转换为十六进制字符串中的代码，反之亦然？](https://stackoverflow.com/questions/311165/how-do-you-convert-byte-array-to-hexadecimal-string-and-vice-versa-in-c). 然后使用`System.Text.Encoding.Unicode.GetString(myArray)`（使用正确的编码，可能不是 Unicode，但从您的示例来看，它是 16 位编码，顺便说一下，它不是 7 位的“ASCII”）将其转换为字符串。

# c - 两个变量的比较

> ID：10419280
> 
> 赞同：0
> 
> 时间：2012-05-02T18:08:22.937
> 
> 标签：c

我只是一个很棒的编程难题。为什么要一样？

```
#include <stdio.h>
#include <limits.h>

int main(int argc, char *argv[])
{
  unsigned int x = ULONG_MAX;
  char y = -1;   
  if (x == y) printf("That is same.");  

  return 0;
} 
```

我认为 unsigned int 被转换为signed char，因此它将是-1。它可能是比较有符号和无符号类型的标准。我不知道...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T18:12:15.127

`signed char`在和之间的争吵中`unsigned int`，`unsigned int`获胜！

就像这样

![大小很重要](../Images/3a26623106465d766b713a06307fbd1d.png)

这里`-1`将转换为`unsigned int`which is `ULONG_MAX`，因此`if()`条件为真。

在 C 中，大小确实很重要。变量总是转换为其中最大的大小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T18:16:59.123

许多年前，我学到了一些东西。其中之一是比较相似的类型。

如果' 的值大于 ，我要么将其`char`转换为。或者，如果's 的值被限制为 a ，则以另一种方式转换。这样，您就可以告诉编译器您是如何比较这些值的，这也将有助于维护人员。`unsigned int``unsigned int``sizeof char``unsigned int``sizeof char`

# linux - 在 libgen 库中找不到 pathfind() 函数

> ID：10419284
> 
> 赞同：1
> 
> 时间：2012-05-02T18:08:26.433
> 
> 标签：linux, unix, porting

在 Linux 中，我在链接 Makefile 中的对象时收到错误“未定义对‘pathfind’的引用。libgen、libposix4 库被链接以创建可执行文件。这些库在 Linux 中不存在。这个 pathfind() 函数声明存在于 libgen.h在Unix中但在Linux中无处.而且我也没有得到它在Unix中定义的位置.我假设它是libgen或libposix4的库函数.Linux中是否有任何等效函数或者我需要编写自己的函数来实现功能pathfind()?? 也是 libgen 和 libposix4 的等效库？

# c# - 在 C# (Metro App) 中构建具有翻页效果的自定义控件

> ID：10419290
> 
> 赞同：0
> 
> 时间：2012-05-02T18:08:39.873
> 
> 标签：c#, xaml, windows-8

我想为用 C# 编写的 Metro Applications 创建一个自定义控件（根据我最近的研究，我猜我想实现的是一个 ItemsControl），它可以容纳多个页面，每个页面可以包含 XAML 控件的任意组合，非常相似到 FlipView 控件。

在我的自定义控件中，我想以书籍格式一次显示两个页面，并带有动态绑定到用户拖动位置的翻页动画，就像这个例子：[http ://turnjs.com/](http://turnjs.com/)

我不知道在哪里寻找参考资料，因为有关创建自定义控件的唯一页面仍在开发中：http: [//msdn.microsoft.com/en-us/library/windows/apps/hh465455.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/hh465455.aspx)

有人可以指出我正确的方向吗？我想知道如何创建一个自定义控件来管理具有任意内容的页面。

# ssis - SSIS DataReader 从大型机失败

> ID：10419292
> 
> 赞同：1
> 
> 时间：2012-05-02T18:08:52.170
> 
> 标签：ssis, odbc, mainframe, datareader

我有一个 ADO.Net 连接，它使用 ODBC 数据源连接到我们的大型机。当它连接到 DataReader 源时，Datareader 立即失败。我假设至少连接工作正常，因为 SqlCommand 中的 Select * From（不是我正在使用的）将正确显示列映射下的所有可用列。当试图转储到一个简单的平面文件时，我明白了。

```
SSIS package "MainframeTest.dtsx" starting.
Information: 0x4004300A at Data Flow Task, DTS.Pipeline: Validation phase is beginning.
Information: 0x4004300A at Data Flow Task, DTS.Pipeline: Validation phase is beginning.
Information: 0x40043006 at Data Flow Task, DTS.Pipeline: Prepare for Execute phase is beginning.
Information: 0x40043007 at Data Flow Task, DTS.Pipeline: Pre-Execute phase is beginning.
Information: 0x402090DC at Data Flow Task, Flat File Destination [191]: The processing of file "C:\Documents and Settings\BBSA322\Desktop\LogFile.txt" has started.
Information: 0x4004300C at Data Flow Task, DTS.Pipeline: Execute phase is beginning.
Error: 0xC02090F5 at Data Flow Task, DataReader Source [1]: The component "DataReader Source" (1) was unable to process the data.
Error: 0xC0047038 at Data Flow Task: SSIS Error Code DTS_E_PRIMEOUTPUTFAILED.  The PrimeOutput method on component "DataReader Source" (1) returned error code 0xC02090F5\.  The component returned a failure code when the pipeline engine called PrimeOutput(). The meaning of the failure code is defined by the component, but the error is fatal and the pipeline stopped executing.  There may be error messages posted before this with more information about the failure.
Error: 0xC0047021 at Data Flow Task: SSIS Error Code DTS_E_THREADFAILED.  Thread "SourceThread0" has exited with error code 0xC0047038\.  There may be error messages posted before this with more information on why the thread has exited.
Error: 0xC0047039 at Data Flow Task: SSIS Error Code DTS_E_THREADCANCELLED.  Thread "WorkThread0" received a shutdown signal and is terminating. The user requested a shutdown, or an error in another thread is causing the pipeline to shutdown.  There may be error messages posted before this with more information on why the thread was cancelled.
Error: 0xC0047021 at Data Flow Task: SSIS Error Code DTS_E_THREADFAILED.  Thread "WorkThread0" has exited with error code 0xC0047039\.  There may be error messages posted before this with more information on why the thread has exited.
Information: 0x40043008 at Data Flow Task, DTS.Pipeline: Post Execute phase is beginning.
Error: 0xC0047018 at Data Flow Task, DTS.Pipeline: component "DataReader Source" (1) failed the post-execute phase and returned error code 0x8007000E.
Error: 0xC0047018 at Data Flow Task, DTS.Pipeline: component "DataReader Source" (1) failed the post-execute phase and returned error code 0x8007000E.
Information: 0x402090DD at Data Flow Task, Flat File Destination [191]: The processing of file "C:\Documents and Settings\BBSA322\Desktop\LogFile.txt" has ended.
Information: 0x40043009 at Data Flow Task, DTS.Pipeline: Cleanup phase is beginning.
Error: 0xC004701B at Data Flow Task, DTS.Pipeline: component "DataReader Source" (1) failed the cleanup phase and returned error code 0x8007000E.
Information: 0x4004300B at Data Flow Task, DTS.Pipeline: "component "Flat File Destination" (191)" wrote 0 rows.
Error: 0xC0047037 at Data Flow Task, DTS.Pipeline: component "DataReader Source" (1) failed during shut down and returned error code 0x8007000E. A component failed to release its interfaces.
Task failed: Data Flow Task
Warning: 0x80019002 at MainframeTest: SSIS Warning Code DTS_W_MAXIMUMERRORCOUNTREACHED.  The Execution method succeeded, but the number of errors raised (9) reached the maximum allowed (1); resulting in failure. This occurs when the number of errors reaches the number specified in MaximumErrorCount. Change the MaximumErrorCount or fix the errors.
SSIS package "MainframeTest.dtsx" finished: Failure. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T18:18:19.957

发现这是 .Net 框架更新的问题。将文本文件添加到错误输出可解决问题。

答案在这里找到。

[http://blogs.msdn.com/b/sqlblog/archive/2009/04/09/after-installation-of-net-framework-3-5-sp1-or-net-framework-2-0-sp2- ssis-packages-using-odbc-3rd-party-drivers-may-fail.aspx](http://blogs.msdn.com/b/sqlblog/archive/2009/04/09/after-installation-of-net-framework-3-5-sp1-or-net-framework-2-0-sp2-ssis-packages-using-odbc-3rd-party-drivers-may-fail.aspx)

# android - 如何获得自定义标签

> ID：10419294
> 
> 赞同：0
> 
> 时间：2012-05-02T18:08:54.530
> 
> 标签：android, tabs

我想自定义我的标签，它看起来类似于下图..任何想法怎么做..

默认情况下，android 选项卡不支持在 XML 中设置宽度和高度。知道如何做这样的选项卡

![在此处输入图像描述](../Images/7c8a0432f0b074d7111ddb177f5b6937.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T19:00:46.273

这是 tabhost 的基本布局。

这是一个示例：将其放入将保存 tabhost 并在创建后扩展 TabActivity 的活动中。重复所需的选项卡数。API Demos 帮助了解此基本信息。

可绘制图标将是位于可绘制文件夹中的 xml 文件：

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
<!-- When selected, use white -->
<item android:drawable="@drawable/white"
      android:state_selected="true" />
<!-- When not selected, use grey-->
<item android:drawable="@drawable/grey" /> 
```

```
TabHost tabHost = getTabHost();

// Tab 1
TabSpec tab1spec = tabHost.newTabSpec("TAB1 TITLE");
tab1spec.setIndicator("TAB1 TEXT", getResources().getDrawable(R.drawable.tab1iconhere));
Intent tab1Intent = new Intent(this, ActivityforTab1.class);
tab1spec.setContent(tab1Intent);

// Tab 2
TabSpec tab2spec = tabHost.newTabSpec("TAB2 TITLE");
tab2spec.setIndicator("TAB2 TEXT", getResources().getDrawable(R.drawable.tab2iconhere));
Intent tab2Intent = new Intent(this, ActivityforTab2.class);
tab2spec.setContent(tab2Intent);

// Adding all TabSpec to TabHost
tabHost.addTab(tab1spec); // Adding tab1
tabHost.addTab(tab2spec); // Adding tab1 
```

# android - Sqlite 浏览器教程

> ID：10419297
> 
> 赞同：2
> 
> 时间：2012-05-02T18:09:02.603
> 
> 标签：android, database

任何人都可以指导我到一个很好的 sqlite 浏览器教程。我似乎找不到要找的东西希望你们能帮助谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T20:35:34.520

[MOTODEV Studio](http://developer.motorola.com/tools/motodevstudio/download/)有一个 SQLite GUI 浏览器，可与模拟器和 root 手机一起使用。您可以作为完整包或插件安装到现有的 Eclipse 环境中。

![MOTODEV Studio GUI SQLite 浏览器](../Images/b70cad01c34f8b3a9fbbd0142054767c.png)

免责声明：我是产品经理。免费使用，需要注册才能下载。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T18:26:17.597

如果你正在为你的 SQLite Db 寻找浏览器程序，你可以试试[Android SQLite Manager](http://sourceforge.net/projects/asqlitemanager/)

# java - 分割空格不能正常工作

> ID：10419298
> 
> 赞同：-2
> 
> 时间：2012-05-02T18:09:08.360
> 
> 标签：java, regex, split, whitespace

我搜索了很多关于正则表达式的信息，最后我发现最好使用“\\s+”来拆分字符串
但令人惊讶的是它对原始字符串没有任何影响：

```
private static void process(String command) {
    command = command.substring(0, command.length() - 1);
    String[] splitted = command.split("\\s+");
    for (String str : splitted) {
        System.out.println(str);
    }
} 
```

样本输入：

```
Boolean b = new Boolean(true); 
```

首选输出：

```
[Boolean,b,=,new,Boolean(true)] 
```

但我的方法输出是：

```
Boolean b = new Boolean(true) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T18:22:56.257

如果您想要“首选输出”，请使用`Arrays.toString(splitted)`. 但是，您的代码可以正常工作。它在新行上打印数组的每个元素。所以这段代码：

```
 private static void process(String command) {
    command = command.substring(0, command.length() - 1);

    String[] splitted = command.split("\\s+");

    for (String str : splitted) {
      System.out.println(str);
    }

    System.out.println(Arrays.toString(splitted).replace(" ", ""));
  }

  public static void main(String[] args) {
    process("Boolean b = new Boolean(true); ");
  } 
```

产生这个输出：

```
Boolean
b
=
new
Boolean(true);
[Boolean, b, =, new, Boolean(true);] 
```

请注意，`substring`由于输入字符串中的尾随空格，该操作不会像您想要的那样工作。您可以`command.trim()`事先使用以消除任何前导/尾随空格。

***编辑***

我编辑了我的代码，因为正如@Tim Bender 所说，输出中的数组元素之间存在空格，`Arrays.toString`而这并不是 OP 想要的。

# php - php将没有扩展名的文件发送到电子邮件

> ID：10419299
> 
> 赞同：0
> 
> 时间：2012-05-02T18:09:16.067
> 
> 标签：php, mysql

我有页面，用户将文件上传到我的网络服务器，无需扩展即可保存。

例如 example.doc 将保存为当前时间（1234567890），但没有扩展名。

这工作正常我没有这个问题。

我遇到的问题是我喜欢稍后通过电子邮件将文档发送到电子邮件地址。我喜欢分配原始名称，包括文件的扩展名。

所有数据都保存在我的数据库中。的名称和扩展名。

例如，我喜欢将此文件“1234567890”作为 example.doc 发送到电子邮件地址。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T18:22:46.257

使用 phpmailer AddStringAttachment

[http://phpmailer.worxware.com/index.php?pg=tutorial#3.2](http://phpmailer.worxware.com/index.php?pg=tutorial#3.2)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-08T01:38:37.733

**代码**

```
 <html>
   <head>
    <title>My First File Sender</title>
   <meta charset="utf8 ">
  </head>
    <body>

    <?php
      if (!isset($_POST["file"]))
       {
         echo '<form method="POST" action="upload.php" enctype="multipart/form-data"><input type="file" name="fileToUpload" id="fileToUpload"><br><input type="submit" value="Send File"></form>';
      }else {
       /*
        Settings start here
       */
       $target_dir = "files/";
       $name = "John Doe";
       $email = "johndoe@freemail.net";
       $subject = "New File";
       /*
       Settings end here
      */
       $target_file = $target_dir . basename($_FILES["fileToUpload"]["name"]);
       $uploadOk = 1;
       $imageFileType = pathinfo($target_file,PATHINFO_EXTENSION);
       $msg = '
       Dear  ' . $name . ',<br>
      A new file has been sent, it will be saved in the uploads file.<br><br>

   Thank you,<br>
   Automated System
    ';
      mail($email,$subject,$msg);
      echo "Thank You.";
      }

     ?>

  </body>
  </html> 
```

**这个怎么运作**

浏览器将检查您是否已经添加了文件。

如果不：

它会提示您选择一个文件。

如果真实：

它将文件上传到任何`$target_dir`相等的位置。

`$email`然后向任何平等的人发送电子邮件。

消息可能看起来像这样。

```
亲爱的约翰·多伊，
新文件已发送，它将保存在上传文件中。

谢谢，
自动化系统

```

# html - 这种布局在 CSS 中可行吗？

> ID：10419302
> 
> 赞同：0
> 
> 时间：2012-05-02T18:09:22.597
> 
> 标签：html, css, width, fluid-layout

我有一个看起来像这样的布局：http: [//jsfiddle.net/pWmBj/2/](http://jsfiddle.net/pWmBj/2/)。但是，当`.active`打开时，我希望`#par.active>div`具有以下属性：

1.  最小宽度：容器的 100% (#par)
2.  最大宽度：300 像素（除非 #par 宽度 > 300 像素——我假设这是最小宽度的默认行为）
3.  宽度：自动

问题是它`#par.active>div`似乎从不关心`width:auto`CSS。我希望它扩展到它的自然宽度，但它仍然被限制在它的父宽度（#par）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T18:14:36.020

只是在黑暗中拍摄：

`<div>`是块级元素 - 默认情况下，它们将采用其父级的宽度。

你可以试试：

```
#par.active>div {
 ...
 display: inline-block;
} 
```

我在你的 JSFiddle 上试过，但我不完全确定这是否是你想要的效果。

# php - 在不同的选项卡（HTML、PHP、JavaScript 等）中分隔表格

> ID：10419309
> 
> 赞同：0
> 
> 时间：2012-05-02T18:09:45.123
> 
> 标签：php, javascript, html, tabs

首先让我说这是我第一次使用 PHP、HTML、JavaScript 和 JQuery，所以我的经验相当缺乏。

我正在帮助构建一个 Web 订单处理器，它将显示订单、日期、客户和状态。我正在从我们的数据库中提取订单，并将它们显示在表格中。订单处理器是用 PHP 构建的。

现在，我被要求将表格分成不同的选项卡，这些选项卡将在我们可能的订单状态之后进行标记。有点像浏览器顶部的选项卡。

我的问题相当大：我不知道从哪里开始。我已经搜索了几个小时，但我认为我使用的术语不正确。

谢谢大家。任何帮助都将不胜感激，即使它只是通过给我一些搜索的东西来推动我朝着正确的方向前进。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T18:18:47.427

我建议从这个开始：http: [//jqueryui.com/demos/tabs/](http://jqueryui.com/demos/tabs/)

首先确保您的选项卡使用简单的静态内容。其次升级它，以便每次切换选项卡时，它都会从数据库加载内容。

根据选项卡，您可以使用 status=(NEW,PROCESSES,REFUND ...) 自定义对服务器的请求，然后执行查询并为选项卡返回适当的数据。

希望能帮助到你

# android - “count(*)”上的 rawQuery 不返回任何行

> ID：10419311
> 
> 赞同：1
> 
> 时间：2012-05-02T18:09:50.240
> 
> 标签：android, sqlite

我正在尝试解决我在 Ankidroid 中遇到的数据库问题。执行了以下语句：

```
SELECT count(*) FROM cards c WHERE type = 1 AND combinedDue <
1335153600.000000 
```

它是在[那里](https://github.com/nicolas-raoul/Anki-Android/blob/maintenance_1.1/src/com/ichi2/anki/Deck.java#L1626)生成的。执行的代码如下（[github链接](https://github.com/nicolas-raoul/Anki-Android/blob/maintenance_1.1/src/com/ichi2/anki/AnkiDb.java#L127)）：

```
cursor = mDatabase.rawQuery(query, null);
if (!cursor.moveToNext()) {
  throw new SQLException("No result for query: " + query);
} 
```

我不明白我怎么没有记录，我应该得到 1 或 0。日志中的调用堆栈如下：

```
at com.ichi2.anki.Deck.rebuildRevCount(Deck.java:1351)
    Caused by: android.database.SQLException: No result for query: ……
at com.ichi2.anki.AnkiDb.queryScalar(AnkiDb.java:129)
at com.ichi2.anki.Deck._rebuildRevCount(Deck.java:1621) 
```

任何想法？

事实上，我更多的是在看一个类似的案例。我们有一个表«Stats»，其中有一列“全局”，其中可以有一个全局记录和许多每日记录。如果我们没有找到（一个简单的*select*）全局记录，我们创建它。在我的手机上，似乎有时找不到全局记录，所以我们创建了一个额外的记录，这会破坏事情。它真的看起来像我上面展示的情况。

**编辑**：

我找到了原因。在另一个线程中，AsyncTask 在进行查询的同时关闭数据库（因为由 GUI 触发的许多处理都是异步完成的）。它返回一个没有记录的游标。

我通过将跟踪添加到文件中看到了这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T19:25:22.747

尝试`if (cursor.moveToFirst == false)`而不是使用 ! 操作员。我认为您当前的操作方式总是会将您传递到 if 的主体中。并且光标没有正确初始化。没有 a.moveToFirst。

# performance - 如何确定 CPE：每个元素的周期数

> ID：10419316
> 
> 赞同：3
> 
> 时间：2012-05-02T18:09:56.517
> 
> 标签：performance, architecture, assembly, x86, sse

如何确定课程的 CPE？例如，我有一个循环的汇编代码：

```
# inner4: data_t = float
# udata in %rbx, vdata in %rax, limit in %rcx,
# i in %rdx, sum in %xmm1
1 .L87:                                   # loop:
2   movss  (%rbx,%rdx,4), %xmm0           #  Get udata[i]
3   mulss  (%rax,%rdx,4), %xmm0           #  Multiply by vdata[i]
4   addss  %xmm0, %xmm1                   #  Add to sum
5   addq  $1, %rdx                        #  Increment i
6   cmpq  %rcx, %rdx                      #  Compare i:limit
7   jl .L87                               #  If <, goto loop 
```

我必须使用数据类型浮点数找到由关键路径确定的 CPE 的下限。我相信关键路径是指可能的最慢路径，因此是程序必须执行 mulss 指令的路径，因为它占用了最长的时钟周期数。

但是，似乎没有任何明确的方法来确定 CPE。如果一条指令需要两个时钟周期，而另一条需要一个时钟周期，那么后者可以在前者的第一个时钟周期之后开始吗？任何帮助，将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T23:36:29.437

如果你想知道它需要多长时间，你应该测量它。执行循环大约 10 ^ 10 次，花费它需要的时间并乘以时钟频率。你得到周期的总数，除以 10^10 得到每个循环迭代的时钟周期数。

执行时间的理论预测几乎*永远不会*是正确的（而且大部分时间都是低的），因为决定速度的因素有很多：

*   流水线（流水线中很容易有大约 20 个阶段）
*   超标量执行（最多并行 5 条指令，`cmp`并且`jl`可以融合）
*   解码为 µOps 并重新排序
*   缓存或内存的延迟
*   指令的吞吐量（是否有足够的空闲执行端口）
*   指令的延迟
*   银行冲突、别名问题和更深奥的东西

根据 CPU 和内存访问都命中 L1 缓存，我相信循环每次迭代至少需要 3 个时钟周期，因为最长的依赖链是 3 个元素长。在较慢`mulss`或`addss`指令较慢的旧 CPU 上，所需时间会增加。

如果您真的对加速代码感兴趣，而不仅仅是一些理论观察，您应该对其进行矢量化。您可以使用类似的方法将性能提高 4-8 倍

```
.L87:                               # loop:
vmovdqa (%rbx,%rdx,4), %ymm0        #  Get udata[i]..udata[i+7]
vmulps  (%rax,%rdx,4), %ymm0, %ymm0 #  Multiply by vdata[i]..vdata[i+7]
vaddps  %ymm0, %ymm1, %ymm1         #  Add to sum
addq    $8, %rdx                    #  Increment i
cmpq    %rcx, %rdx                  #  Compare i:limit
jl .L87                             #  If <, goto loop 
```

之后您需要水平添加所有 8 个元素，当然要确保对齐为 32 并且循环计数器可被 8 整除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T22:44:28.387

如果您运行的是 Intel CPU，您可以找到一些关于各种 CPU 的指令延迟和吞吐量的优秀文档。这是链接：

[英特尔® 64 和 IA-32 架构优化参考手册](http://www.intel.com/content/dam/doc/manual/64-ia-32-architectures-optimization-manual.pdf)

# c# - 如何在gridview编辑模式中选中或取消选中复选框

> ID：10419317
> 
> 赞同：0
> 
> 时间：2012-05-02T18:09:56.937
> 
> 标签：c#, asp.net, visual-studio-2010, gridview

我做了一个gridview，它有很多列和editmode，有些是文本，下拉列表工作得很好。

如何为 Checkbox 赋值以使其选中或取消选中？

我想做的值是是/否。

所以我很难做到这一点。

我的 Gridview：只是粘贴它的一部分，因为它太大了。

```
<asp:TemplateField HeaderText="CUpdate">
    <ItemTemplate >
         <asp:Label ID="Label6" runat="server" Text='<%# Eval("CUpdate") %>' ></asp:Label>
    </ItemTemplate>
    <EditItemTemplate>
         <asp:TextBox runat="server" ID="txtCupdate" Text='<%# Eval("CUpdate") %>' ></asp:TextBox>
    </EditItemTemplate>
</asp:TemplateField>

<asp:TemplateField HeaderText="Email">
    <ItemTemplate >
        <asp:Label ID="Label6" runat="server" Text='<%# Eval("Email") %>' ></asp:Label>
    </ItemTemplate>
    <EditItemTemplate>
        <asp:CheckBoxList ID="checkEmail"  runat="server">
            <%--HOW TO MAKE THIS CHECKED OR UNCHECKED ? when i have values Yes / NO--%>

        </asp:CheckBoxList>
     </EditItemTemplate>
</asp:TemplateField> 
```

> 更新

如果我将上述内容设为：

```
 <EditItemTemplate>
        <asp:CheckBoxList ID="checkEmail" selectedvalue='<%# Eval("Email") %>'  runat="server">
            <asp:ListItem Value="Yes">Yes</asp:ListItem>

        </asp:CheckBoxList>
     </EditItemTemplate> 
```

在这种情况下，当我们出现 Yes 时，我会检查复选框，但如果在 NO 上，它不会运行可能的错误，因为在 checboxlist 中没有值“NO”可供选择。任何解决方案。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T18:20:12.180

您的 CheckBoxList 需要具有所有可能的值，像这样..

```
<asp:CheckBoxList ID="checkEmail" selectedvalue='<%# Eval("Email") %>'  runat="server">
    <asp:ListItem Value="Yes">Yes</asp:ListItem>
    <asp:ListItem Value="No">No</asp:ListItem>
</asp:CheckBoxList> 
```

虽然我不明白你为什么要使用 CheckBoxList 而不是像这样仅使用 1 个复选框..

```
<asp:CheckBox runat="server" ID="checkEmail" Checked = '<%# Eval("Email").ToString().Equals("yes", StringComparison.OrdinalIgnoreCase) %>' /> 
```

# java - Java JDBC with PostgreSQL：PreparedStatement Execute with Add Column Query 返回 false

> ID：10419319
> 
> 赞同：0
> 
> 时间：2012-05-02T18:09:59.013
> 
> 标签：java, sql, postgresql, jdbc, ddl

我正在尝试将一列添加到数据库表中

```
PreparedStatement  ps = con.prepareStatement(query);  
ps.execute();
ps.close(); 
```

查询类似于（有效的 SQL）

```
ALTER TABLE mytable ADD COLUMN mycolumn datatypeinfo 
```

无论如何，它执行得很好并创建了列。但是执行语句返回 false。我尝试使用 executeUpdate 并返回 0 行。

请注意，整个事情都在 con.setAutoCommit 设置为 false 的事务中。所以我不确定这是否是问题所在。问题是我必须先创建列，然后才能继续进行其他更新查询。所以它必须在事务中运行。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-02T18:12:27.633

的返回值`execute()`并不表示是否成功，而是表示运行的查询是否返回了结果。

由于`ALTER TABLE`不返回结果，因此`execute()`正确返回`false`

引用[Javadocs](http://docs.oracle.com/javase/6/docs/api/java/sql/PreparedStatement.html#execute%28%29)：

> *返回：**如果第一个结果是 ResultSet 对象，则*返回true ；*如果第一个结果是更新计数或没有结果，则返回*false

# objective-c - NSObject 子类初始化

> ID：10419324
> 
> 赞同：0
> 
> 时间：2012-05-02T18:10:13.360
> 
> 标签：objective-c, xcode, properties, initialization

这是我的困境：我有一个 tableview 控制器，它在选择时加载一个详细视图。我在详细视图中声明了一个自定义类。

```
Match *myMatch;

@property (nonatomic, retain) Match *myMatch; 
```

当我从 tableview 加载视图时，我将匹配的值设置为预初始化匹配，如下所示：（可能存在语法错误，因为我没有复制和粘贴）

```
Match *match = [[Match alloc] initWithMatchData:[profile.matches objectAtIndex:indexPath.row]];

[detailView setmyMatch: match]; 
```

但是当我从详细视图中访问变量 myMatch 时，它为空。我想我做错了什么。类似于初始化 myMatch 对象的内容。我不初始化它。我需要吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T18:13:46.407

1.  `setmyMatch`应该是`setMyMatch`（大写`M`）
2.  你需要合成`myMatch`

# hibernate - Hibernate：使用复杂的类作为属性

> ID：10419328
> 
> 赞同：1
> 
> 时间：2012-05-02T18:10:34.607
> 
> 标签：hibernate, properties, hbm

我正在尝试执行以下操作：

```
public class Distance {

private Course courseA, courseB;
private int minDistance;
double cost;

private Long id;

public Distance() {
    super();
}

public Distance(Course courseA, Course courseB, int minDistance, double cost) {
    super();
    this.courseA = courseA;
    this.courseB = courseB;
    this.minDistance = minDistance;
    this.cost = cost;
}

@Override
public String toString() {
    return "Distance [courseA=" + courseA + ", courseB=" + courseB
            + ", MinDistance=" + minDistance + ", Cost=" + cost + "]";
}

public Course getCourseA() {
    return courseA;
}

public void setCourseA(Course courseA) {
    this.courseA = courseA;
}

public Course getCourseB() {
    return courseB;
}

public void setCourseB(Course courseB) {
    this.courseB = courseB;
}

public int getMinDistance() {
    return minDistance;
}

public void setMinDistance(int minDistance) {
    this.minDistance = minDistance;
}

public double getCost() {
    return cost;
}

public void setCost(double cost) {
    this.cost = cost;
}

@Id
public Long getId() {
    return id;
}

public void setId(Long id) {
    this.id = id;
}

} 
```

Course 是我创建的另一个类：

```
public class Course {

private Long id;

private String name;

private Calendar date;

public Course() {
    super();
}
public Course(Long id,String name, Calendar date) {
    super();
    this.id = id;
    this.name = name;
    this.date = date;
}

@Override
public String toString() {
    return "Course [id=" + id + ", name=" + name + ", examDate=" + date
            + "]";
}

@Id
public Long getId() {
    return id;
}
public void setId(Long id) {
    this.id = id;
}
public String getName() {
    return name;
}
public void setName(String name) {
    this.name = name;
}
public Calendar getDate() {
    return date;
}
public void setDate(Calendar date) {
    this.date = date;
}
/* (non-Javadoc)
 * @see java.lang.Object#hashCode()
 */
@Override
public int hashCode() {
    final int prime = 31;
    int result = 1;
    result = prime * result + ((id == null) ? 0 : id.hashCode());
    return result;
}
/* (non-Javadoc)
 * @see java.lang.Object#equals(java.lang.Object)
 */
@Override
public boolean equals(Object obj) {
    if (this == obj) {
        return true;
    }
    if (obj == null) {
        return false;
    }
    if (!(obj instanceof Course)) {
        return false;
    }
    Course other = (Course) obj;
    if (id == null) {
        if (other.id != null) {
            return false;
        }
    } else if (!id.equals(other.id)) {
        return false;
    }
    return true;
} 
```

}

我尝试将 courseA 和 B 定义为“distance.hbm.xml”中的距离属性，但这只是对我大喊大叫，但有一个例外： `org.hibernate.MappingException: Could not determine type for: database.datatypes.Course at table:distances...`
我尝试将 courseA 和 B 声明为组件，它“成功”但是当我调用`session.load(Distance.class,1L)`它时返回了正确的对象，但两个课程是空指针。

我该如何定义？！

另外，我怎么能做同样的事情，但是对于库中的复杂类（比如 java.util 中的东西）

谢谢！

更新：我找到了我可以吃蛋糕的方法，并在远程课程上解决它，但有一些对我来说很重要的事情：课程中必须有一个日期对象。我宁愿使用 java.util.Calendar，但如果这是有问题的，还有其他方法可以让我使用一个日期吗？

再次感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T19:08:45.677

您可以通过以下方式实现它：

```
@Entity
@Table(name="distance")
public class Distance {

private Course courseA, courseB;

@Embedded
public getCourseA(){
return this.courseA;
}

@Embedded
public getCourseB(){
return this.courseB;
}

} 
```

现在是 Embeddable 类：

```
@Embeddable
public class Address implements Serializable{

@Transient
public Long getId() {
    return id;
}

@Column
public String getName() {
    return name;
}

} 
```

`@Embaddable`类不是实体，所以它不应该有任何主键。这就是为什么你应该`@Transient`使用 id 属性

# iphone - 更改 uisegmentedcontrol 中选定段的字体

> ID：10419330
> 
> 赞同：3
> 
> 时间：2012-05-02T18:10:44.177
> 
> 标签：iphone, uiview, uilabel, uisegmentedcontrol

我注意到在我的一个分段控件上，很难看到选择了哪个段。我在想我可以加粗字体，或者稍微增加字体大小。我正在尝试这个，但它不起作用：

```
UIFont *boldFont = [UIFont boldSystemFontOfSize:16.0];
    NSDictionary *fontDict = [[NSDictionary alloc] initWithObjectsAndKeys:boldFont, UITextAttributeFont, nil];
    [_tableSegmentedControl setTitleTextAttributes:fontDict forState:UIControlStateSelected]; 
```

我的文本在段控件的两个段中看起来相同。我需要做这样的事情吗？ [更改 UISegmentedcontrol 中的 textColor](https://stackoverflow.com/questions/4032091/change-textcolor-in-uisegmentedcontrol)

如果可能的话，我希望在 iOS 5 中使用更简单的方法来添加外观。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T18:42:45.633

我不确定，但我认为 [UIFont boldSystemFontOfSize:16.0f]; f 不见了。试试这个然后告诉我

还 NSlog 字典的值以检查该值是否设置正确

否则使用

NSDictionary *attributes = [NSDictionary dictionaryWithObject:font forKey:UITextAttributeFont]; 这我见过一些问题是由于这个。我不知道这是为什么。

# nlp - 时间和日期的 OpenNLP 名称实体识别模型

> ID：10419337
> 
> 赞同：1
> 
> 时间：2012-05-02T18:11:12.120
> 
> 标签：nlp, opennlp

我正在使用 OpenNLP 模型进行名称实体识别。

我正在传递句子，我想在其中识别单词。Open NLP 需要一个 String [] 变量，因此我将我的 String 拆分为以空格分隔的单词。

我面临识别日期的问题。例如，如果字符串包含日期：2012 年 1 月 7 日，我将字符串拆分为单词，“7”、“Jan”和“2012”将被分隔为 3 个不同的单词。虽然它们被识别为日期，但 3 个不同的标记对我来说没有意义进行进一步处理。我怎么可能拆分我的字符串，以便可以将“2 Jan 2012”视为一个字符串...... 2012 年 1 月 7 日是一种格式......有时它也是 2012 年 1 月 7 日。日期也能识别我输入的时间格式：比如 12:18pm

NER 时间模型无法识别 12:18pm 或 09:52:52 的时间。它接受什么样的时间格式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T01:39:53.037

Apache OpenNLP 日期和时间模型是统计的，从语料库训练而来。它将从上下文中识别日期和时间，而不仅仅是从格式中。

如果您有特定需求，您可以创建自己的语料库并[训练](http://opennlp.apache.org/documentation/1.5.2-incubating/manual/opennlp.html#tools.namefind.training)您自己的 OpenNLP Name Finder 模型。

OpenNLP Name Finder 还支持在训练时进行一些自定义。也许如果您创建一个语料库，并添加一些[基于正则表达式的功能](http://opennlp.apache.org/documentation/1.5.2-incubating/manual/opennlp.html#tools.namefind.training.featuregen)，您可以改善您的结果。

# svn - Tortoise SVN 忽略 .so 文件

> ID：10419338
> 
> 赞同：7
> 
> 时间：2012-05-02T18:11:15.347
> 
> 标签：svn, tortoisesvn, shared-libraries

Windows 上的 Tortoise SVN 忽略 .so 文件。如何将其设置为不忽略它们，以便我能够提交此类文件。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-02T18:13:38.467

转到`settings`并从 .so 中删除 *.so `Global ignore pattern`。

# xml - 从参考元素中，获取祖先中先前元素出现的计数

> ID：10419345
> 
> 赞同：2
> 
> 时间：2012-05-02T18:11:53.153
> 
> 标签：xml, xslt, xpath, xslt-1.0

我正在尝试根据对图形的引用来确定当前章节中包含的图形编号。

要求：

*   每个章节的图号都应该重新设置。
*   图参考，`<figure_reference>`，可能出现在任何深度。
*   XSLT 1.0

XML:

```
<top>
    <chapter>
        <dmodule>
            <paragraph>
                <figure>figure</figure>
            </paragraph>
            <figure>figure</figure>
        </dmodule>
    </chapter>
    <chapter>
        <dmodule>
            <figure>figure</figure>
            <paragraph>
                <figure>figure</figure>
            </paragraph>
        </dmodule>
        <dmodule>
            <figure>figure</figure>
            <paragraph>
                <figure>figure</figure>
                <paragraph>
                    <figure>figure</figure>
                </paragraph>
            </paragraph>
            <figure_reference id="c"/>
            <figure id="c">figure</figure>
        </dmodule>
    </chapter>
</top> 
```

XSL：

```
<xsl:template match="figure_reference">
    <xsl:value-of select="count(ancestor::dmodule//figure[@id = current()/@id]/preceding::figure)+1"/>

</xsl:template> 
```

当前计数结果：8

期望的计数结果：6

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T18:25:34.040

试试这个模板：

```
 <xsl:template match="figure_reference">
    <xsl:value-of select="count(ancestor::chapter//figure[@id=current()/@id]/preceding::figure[ancestor::chapter = current()/ancestor::chapter])+1"/>      
  </xsl:template> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-03T01:41:16.110

**另一种方法不需要计算出复杂的 XPath 表达式——通过使用`<xsl:number>`：**

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:key name="kFigById" match="figure" use="@id"/>

 <xsl:template match="figure_reference">

  <xsl:for-each select="key('kFigById', @id)">
      <xsl:number level="any" count="chapter//figure"
                from="chapter"/>
  </xsl:for-each>
 </xsl:template>

 <xsl:template match="text()"/>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时：**

```
<top>
    <chapter>
        <dmodule>
            <paragraph>
                <figure>figure</figure>
            </paragraph>
            <figure>figure</figure>
        </dmodule>
    </chapter>
    <chapter>
        <dmodule>
            <figure>figure</figure>
            <paragraph>
                <figure>figure</figure>
            </paragraph>
        </dmodule>
        <dmodule>
            <figure>figure</figure>
            <paragraph>
                <figure>figure</figure>
                <paragraph>
                    <figure>figure</figure>
                </paragraph>
            </paragraph>
            <figure_reference id="c"/>
            <figure id="c">figure</figure>
        </dmodule>
    </chapter>
</top> 
```

**产生了想要的正确结果**：

```
6 
```

# c - 替换/删除图中的循环

> ID：10419346
> 
> 赞同：0
> 
> 时间：2012-05-02T18:12:03.210
> 
> 标签：c, algorithm, graph

我正在尝试将图中的循环替换为一组顶点（删除此循环并放置一次具有最大数量的顶点）

```
struct group {
    int master; // representative of cycle
};

struct vertex {
    int *to; // neighbor list

    int nb; // how many neighbor
    int p; // parent
    short v; // was visited? 0 = false, 1 = true

    struct group *cycle; // is part of cycle? NULL = no, else pointer to group
}; 
```

我在每个顶点上运行 dfs

```
void searchCycles() {
    int i;
    for (i = 0; i < MAX_VER; i += 1)
        if (ver[i].v == 0 && ver[i].nb > 0)
            dfs(i);
} 
```

dfs:

```
void dfs(int v) {
    ver[v].v = 1;

    int i;
    for (i = 0; i < ver[v].nb; i += 1) {
        ver[ver[v].to[i]].p = v;

        if (ver[ver[v].to[i]].v == 0)
            dfs(ver[v].to[i]);
        else
                    // cycle found
            replaceCycle(ver[v].to[i]);
    }
} 
```

并替换函数喊打印循环中的顶点

```
void replaceCycle(int v) {
    struct group *g = &gr[usedGroup++];
    g->master = -1;

    printf("\nCYKL: %d ", v);

    int p = ver[v].p;

    while (p != v) {
        printf("%d(%d) ", p, v);

        p = ver[p].p;
    }

    printf("\n");
} 
```

通常它是有效的，但有时它会出现无限循环。我尝试调试它，如果有两个或更多循环，父母（顶点结构中的 p）丢失，这意味着它工作正常但数字错误。我正在学习C和算法，所以我不太了解。

这不是家庭作业，这是一个 spoj 问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T18:16:06.617

更换循环后，重新启动 dfs。

基本上，visited 标志可能会为您的第一个周期设置，但您希望将其清除以测试您的第二个周期。（以及第三，第四等）

# windows - 打开默认桌面注册表项时发生 BGInfo 错误

> ID：10419347
> 
> 赞同：2
> 
> 时间：2012-05-02T18:12:09.287
> 
> 标签：windows, sysinternals

运行非常好的 BGInfo 工具来唯一识别各种计算机。但是，在尝试在 Windows 2008 Server R2 上运行时，我收到以下错误：

“打开默认桌面注册表项时发生错误。请确保当前用户有权更改登录桌面设置：访问被拒绝。”

该程序是通过放置在“C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup”中的快捷方式启动的，该快捷方式是指定一个 .BGI 配置文件（而不是从注册表中读取设置）。关于为什么管理员以外的用户会发生错误的想法？

在更深入的层面上，我很好奇是否有人知道为什么 BGInfo 必须打开“默认桌面注册表项”以及它在“登录桌面设置”中更新的内容（引号中的短语取自原始错误消息）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-12-23T16:43:11.090

BGInfo 需要更新注册表，为所有 RDP 用户设置默认登录桌面。

您最初需要以提升的权限运行 BGInfo。这可以按照 creed929 的描述或通过右键单击 bginfo.exe 并以管理员身份运行来完成。保存设置后，后续用户登录无需提升权限即可查看 BGInfo 背景。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-31T15:19:26.293

从管理员帐户。我能够右键单击 bginfo.exe。转到兼容性选项卡并选中以管理员身份运行此程序。这似乎允许我在没有默认桌面注册表项错误的情况下应用设置。

# android - 在 monodroid 中以编程方式设置选项卡标题

> ID：10419352
> 
> 赞同：1
> 
> 时间：2012-05-02T18:12:27.960
> 
> 标签：android, xamarin.android

我想在按钮上设置单个选项卡的标题单击如何在 monodroid 中以编程方式设置选项卡上的标题？

# android - 带有图像和 2 个 TextView 的 TableRow

> ID：10419355
> 
> 赞同：2
> 
> 时间：2012-05-02T18:12:42.610
> 
> 标签：android, android-tablelayout, tablerow

我在做这样的事情时遇到问题：http: [//imageshack.us/photo/my-images/824/examplehm.png/](http://imageshack.us/photo/my-images/824/examplehm.png/)

我的 xml 代码在行中显示 3 列，但我想要 2 列，第二列必须分成两个水平部分。

我的.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<TableLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

    <ListView android:id="@android:id/list"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" >
    </ListView>

    <TableRow>        
        <ImageView android:id="@+id/imagen"        
            android:layout_width="wrap_content"
            android:layout_height="wrap_content" 
            android:paddingLeft="2dip" 
            android:paddingRight="5dip" />

        <TextView android:id="@+id/cabecera"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:textStyle="bold"
        android:textSize="12px" />

    <TextView android:id="@+id/descripcion"
            android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:textStyle="normal"
        android:textSize="10px" />           
    </TableRow>                         

</TableLayout> 
```

有人可以帮助我吗？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T18:16:27.973

按图像放置`LinearLayout`，然后放入其中两个`TextViews`，或`RelativeLayout`用于整行。

这是第一个解决方案的示例：

```
<?xml version="1.0" encoding="utf-8"?>
<TableLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent" >

<TableRow>        
    <ImageView android:id="@+id/imagen"        
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" 
        android:paddingLeft="2dip" 
        android:paddingRight="5dip" android:src="@drawable/ic_launcher"/>

    <LinearLayout
        android:layout_width="wrap_content"
        android:layout_height="fill_parent"
        android:orientation="vertical" android:gravity="center_vertical">

        <TextView android:id="@+id/cabecera"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:textStyle="bold"
            android:textSize="12px" 
            android:text="TextView"/>

         <TextView android:id="@+id/descripcion"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:textStyle="normal"
            android:textSize="10px"
            android:text="TextView" />    
    </LinearLayout>

</TableRow> 
```

# ruby - Ruby - 类方法

> ID：10419356
> 
> 赞同：3
> 
> 时间：2012-05-02T18:12:46.603
> 
> 标签：ruby, methods

我是刚开始学习 Ruby 的新手。我已经创建了这段代码，但是它返回它不断返回`NoMethodError, undefined method new`。我在这里做错了什么？

```
class Pessoa
  attr_accessor :nome, :idade, :altura

  @@lista = []

  def self.lista
    @@lista
  end

  def initialize(nome, idade, altura)
    pessoa = self.new
    pessoa.nome = nome
    pessoa.idade = idade
    pessoa.altura = altura
    @@lista << self
  end
end

pessoa1 = Pessoa.new("Joao",13,2)
pessoa2 = Pessoa.new("Alfredo",15,1)
puts Pessoa.lista.inspect 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-02T18:20:05.717

在执行期间`Pessoa#initialize` `self`持有一个类的实例`Pessoa`。因此，您正在尝试调用`new`class 的实例`Pessoa`。这是不可能的，因为`new`是class的*实例方法*`Class`：您在`Pessoa`最后几行的类上正确调用它，但不能在实例上调用它（例如`pessoa1`or `pessoa2`，或方法`self`中的 the `Pessoa#initialize`），因为没有其中**一个是 Class**，因此不要定义该`new`方法。

正确的代码是：

```
class Pessoa
  attr_accessor :nome, :idade, :altura

  @@lista = []

  def self.lista
    @@lista
  end

  def initialize(nome, idade, altura)
    @nome = nome
    @idade = idade
    @altura = altura
    @@lista << self
  end
end

pessoa1 = Pessoa.new("Joao",13,2)
pessoa2 = Pessoa.new("Alfredo",15,1)
puts Pessoa.lista.inspect 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-02T18:18:28.857

那`pessoa = self.new`是你的问题。`initialize`在已创建的对象上调用以设置其初始状态，因此

1.  `self`那里没有`new`方法（因为它不是一个类）

2.  在那里创建一个对象并将其分配给局部变量是没有意义的`pessoa`，因为它会在方法完成后消失

我想你想要的是：

```
def initialize(nome, idade, altura)
  @nome = nome
  @idade = idade
  @altura = altura
  @@lista << self
end 
```

# r - 数据的 VennDiagram 给出错误？

> ID：10419357
> 
> 赞同：0
> 
> 时间：2012-05-02T18:12:53.063
> 
> 标签：r, venn-diagram

我有以下数据：

```
Set1    : 82
Set2    : 44
Set3    : 56
Set4    : 53
1,2     : 27
1,3     : 37
1,4     : 30
2,3     : 22
2,4     : 14
3,4     : 19
1,2,3   : 18
1,2,4   : 13
1,3,4   : 20
2,3,4   : 11
1,2,3,4 : 11 
```

`1,2`意思`Set1 . intersection . Set2`，等等……

当我尝试使用 为该数据集制作 VennDiagram 时`draw.quad.venn`，出现以下错误，

```
Error in draw.quad.venn(82, 44, 56, 53, 27, 37, 30, 22, 14, 19, 18, 13,  : 
Impossible: partial areas negative 
```

我不明白我做错了什么？

更新：

以下是我使用的命令行：

```
v.all <- draw.quad.venn( 82, 44, 56, 53, 27, 37, 30, 22, 14, 19, 18, 13, 20, 11, 10, category = c( "Set1", "Set2", "Set3", "Set4" ), fill=c( "red", "blue", "orange", "green" ), cex = 0.75, cat.cex=0.85 ) 
```

有趣的是，当我使用

```
v <- venneuler( c( A=82, B=44, C=56, D=53, "A&B"=27, "A&C"=37, "A&D"=30, "B&C"=22, "B&D"=14, "C&D"=19, "A&B&C"=18, "A&B&D"=13, "A&C&D"=20, "B&C&D"=11, "A&B&C&D"=11 ))
plot(v) 
```

有用！！

![在此处输入图像描述](../Images/345e1af5b07f6214231749823ee319d0.png)

所以现在我真的很困惑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T19:09:43.667

没有您的代码，很难提供帮助。由于数据应该重叠的方式，可能无法绘制数据。也许你的数据有错误？

但是，如果是代码问题，使用您的一些数据和不同的包，我可以提供替代路线：

```
require(venneuler)
m <- as.matrix(c(
0, 27, 37, 30,
27, 0, 22, 14,
37 ,22, 0, 19,
30,14,19,0)byrow=T,nrow=3)
v = venneuler(m)
plot(v) 
```

这使[![给出：](../Images/8eb246d0078b59f7cd38af0e8b17fa7d.png)](https://i.stack.imgur.com/yxjoH.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T22:20:40.700

代码中的约束是直截了当的。正是这里；

```
 if (any(a1 < 0, a2 < 0, a3 < 0, a4 < 0, a5 < 0, a6 < 0, a7 < 
            0, a8 < 0, a9 < 0, a10 < 0, a11 < 0, a12 < 0, a13 < 0, 
            a14 < 0, a15 < 0)) {
            stop("Impossible: partial areas negative")
        } 
```

# eclipse - Eclipse：使用 -X 开关重新运行 Maven 以启用完整的调试日志记录

> ID：10419359
> 
> 赞同：19
> 
> 时间：2012-05-02T18:12:57.843
> 
> 标签：eclipse, maven, maven-2, m2eclipse, m2e

我有一个 Maven 项目，我正在尝试在 Eclipse 中构建/运行，但出现以下错误。我该如何执行错误提示并添加 -e 或 X 开关以尝试解决此问题？

```
[ERROR] Failed to execute goal org.bsc.maven:maven-processor-plugin:2.0.5:process (process) on project glw-crm: Error executing: NullPointerException -> [Help 1]
[ERROR] 
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR] 
[ERROR] For more information about the errors and possible solutions, please read the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoExecutionException 
```

我正在使用 Eclipse Indigo（64 位）和 m2e 1.0.1

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-05-02T20:09:26.177

您应该检查`Debug Output`m2e 配置：

窗口 -> 首选项 -> Maven -> 调试输出

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-09-17T16:27:31.743

从 IntelliJ 2019.2.2 开始

文件 -> 设置 (Ctrl + Alt+ S) -> 构建、执行、部署 -> 构建工具 -> Maven -> 输出级别：调试

# asp.net - MS 图表无法在 win 2008 服务器上正确显示

> ID：10419360
> 
> 赞同：0
> 
> 时间：2012-05-02T18:13:04.777
> 
> 标签：asp.net

我在我的网页上显示两个折线图和两个饼图。我不确定为什么会发生这种情况，但有时我在运行应用程序时会看到图表，有时却看不到。下面是我的 web.confg 文件设置。

```
 <?xml version="1.0"?>
    <configuration>
      <system.web>
        <authorization>
          <allow roles="ANALYST"/>
          <deny users="*" />

        </authorization>
        <httpHandlers>
          <add path="ChartImg.axd" verb="*" type="System.Web.UI.DataVisualization.Charting.ChartHttpHandler, System.Web.DataVisualization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" validate="false"/>
        </httpHandlers>
      </system.web>
      <system.webServer>
        <handlers>
          <remove name="ChartImageHandler"/>
          <add name="ChartImageHandler" preCondition="integratedMode" verb="*" path="ChartImg.axd" type="System.Web.UI.DataVisualization.Charting.ChartHttpHandler, System.Web.DataVisualization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"  />

        </handlers>

      </system.webServer>
      <appSettings>
        <add key="ChartImageHandler" value="WebDevServerUseConfigSettings=true;privateImages=false;storage=file;timeout=20;dir=c:\test\;"/>
      </appSettings> 
```

除此之外，我的 bin 文件夹中有 System.web.datavisualization.dll，我正在 Windows Server 2008 R2 上运行该应用程序。整个应用程序是在 .net 4.0 中开发的。我没有收到任何错误消息。我在放置图像的 C:\Test 文件夹中看到了图形图像，但在网页上却没有。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T16:57:04.247

这是浏览器缓存问题。如果我清理浏览器缓存，它工作正常。

# facebook - 如何以编程方式将喜欢的网页发布到 Facebook 提要？

> ID：10419371
> 
> 赞同：0
> 
> 时间：2012-05-02T18:14:03.450
> 
> 标签：facebook, facebook-graph-api

我试图让它工作：[https ://developers.facebook.com/blog/post/465/](https://developers.facebook.com/blog/post/465/)

**第 1 步：**我正在获取访问令牌：

[https://graph.facebook.com/oauth/access_token?type=client_cred&client_id=myAppIdclient_secret=myAppSecret](https://graph.facebook.com/oauth/access_token?type=client_cred&client_id=myAppIdclient_secret=myAppSecret)

**第 2 步：**我通过 curl 发布

```
curl -F 'access_token=myAccessToken'  -F 'message=Hello World!'  -F 'id=http://example.com'  https://graph.facebook.com/feed 
```

myUrl 在哪里说[http://example.com](http://example.com)

我收到此错误，无法解析为有效的用户 ID：

```
{"error":{"message":"(#100) http:\/\/example does not resolve to a valid user ID","type":"OAuthException","code":100}} 
```

**第 3 步：**如果我首先将我的 url 发布到 linter，并获取它的 ID：

[https://developers.facebook.com/tools/debug/og/object?q=http%3A%2F%2Fexample.com](https://developers.facebook.com/tools/debug/og/object?q=http%3A%2F%2Fexample.com)

[https://graph.facebook.com/10150096126766188](https://graph.facebook.com/10150096126766188)

```
curl -F 'access_token=myAccessToken'  -F 'message=Hello World!'  -F 'id=10150096126766188'  https://graph.facebook.com/feed 
```

然后我收到“用户尚未授权应用程序执行此操作”错误：

```
{"error":{"message":"(#200) The user hasn't authorized the application to perform this action","type":"OAuthException","code":200}} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T20:05:18.853

按照博客文章，这是通过应用程序完成的，为此，应用程序需要扩展权限“publish_actions”和“publish_stream”才能发布帖子/评论/喜欢/链接

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T18:20:39.203

来自[Facebook Graph API 文档](https://developers.facebook.com/docs/reference/api/)：

```
Most write operations require extended permissions[1] for the active user.
See the authentication guide[2] for details on how you can request extended
permissions from the user during the authentication step. 
```

1 [https://developers.facebook.com/docs/authentication/permissions](https://developers.facebook.com/docs/authentication/permissions)

2 [https://developers.facebook.com/docs/authentication/](https://developers.facebook.com/docs/authentication/)

# sql - Rails 和 SQL，如何对表关联的所有成员进行 .last

> ID：10419372
> 
> 赞同：1
> 
> 时间：2012-05-02T18:14:16.410
> 
> 标签：sql, ruby-on-rails, ruby-on-rails-3

到目前为止，我正试图以有限的成功形成正确的查询。

假设我有用户和帖子

用户 has_many 帖子和帖子属于用户

帖子有一个可见的布尔字段

我正在尝试在用户模型中编写一个范围，该范围会遍历所有用户，找到他们的最后一篇文章，并且仅在其最后一篇文章中可见布尔值为 true 的情况下才返回用户。

类似于 Users.posts.last.where(:visible => true) 的东西，但在一个范围内。

编辑

我试图将返回值保留为 AR 关系对象，常规数组不适用于我试图使用范围的内容。到目前为止，感谢您的输入。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T18:35:08.883

```
class User < ActiveRecord::Base 
  has_many :posts
  scope :last_visable_post, posts.where("visible = ?",true).last
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T18:31:44.323

也许这样的东西应该可以工作..（未经测试）

```
class User

  def User.users_with_visible_posts
    User.includes(:posts).map {|user| user.posts.last && !!user.posts.last.visible}
  end
end

User.users_with_visible_posts #=> [Users with last post visible] 
```

# java - 如果不存在，如何向soap 1.2请求添加唯一的消息ID？

> ID：10419374
> 
> 赞同：4
> 
> 时间：2012-05-02T18:14:18.543
> 
> 标签：java, web-services, soap, cxf

我们的网络服务被未正确发送消息 ID 的系统使用。（根本不在soap请求中！）如果实际调用中不存在消息ID，我正在寻找如何添加消息ID的方法。如果它不存在，则整个调用将因所需属性不存在而失败。

有没有简单的方法来实现这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T20:10:22.640

[在这里](http://mail-archives.apache.org/mod_mbox/cxf-users/201202.mbox/%3C4F44C735.3040109@gmail.com%3E)找到了解决方案，但这似乎不起作用。

想出了这个对我有用的解决方案：创建一个拦截器来检查 MessageID 标头，如果它不存在则将其添加到消息中：

```
package my.package;

import org.apache.cxf.binding.soap.SoapHeader;
import org.apache.cxf.headers.Header;
import org.apache.cxf.message.Message;
import org.apache.cxf.phase.AbstractPhaseInterceptor;
import org.apache.cxf.phase.Phase;
import org.w3c.dom.Element;

import javax.xml.namespace.QName;
import java.util.ArrayList;
import java.util.List;
import java.util.UUID;

public class HeaderInterceptor extends AbstractPhaseInterceptor<Message> {

    private static final String SOAP_HEADER_KEY = "org.apache.cxf.headers.Header.list";
    private static final String NAMESPACE_URI   = "http://www.w3.org/2005/08/addressing";
    private static final String QUALIFIED_NAME  = "wsa:MessageID";
    private static final String LOCAL_NAME      = "MessageID";

    public HeaderInterceptor() {
        // phases: http://cxf.apache.org/docs/interceptors.html
        // 'pre protocol' seems to be the best moment to check the header, if we do it earlier the headers don't exist in the message object so we can't re-use the 'owner document'
        // if we do it later the unmarshalMAPs method (in MAPCodec.java) will already have processed the headers and will not process our added header
        super(Phase.PRE_PROTOCOL);
    }

    @Override
    public void handleMessage(Message message) throws Fault {
        ArrayList<SoapHeader> headers = (ArrayList<SoapHeader>) message.get(SOAP_HEADER_KEY);

        // if the header doesn't exist and we have at least one header to access 'owner document' we can create and add our own MessageID header
        if(!messageIdHeaderExists(headers) && headers.size() > 0) {
            Element existingHeaderElement = (Element) headers.get(0).getObject();

            // use the existing header element to create our own MessageID header with random UUID
            Element element = existingHeaderElement.getOwnerDocument().createElementNS(NAMESPACE_URI, QUALIFIED_NAME);
            element.appendChild(existingHeaderElement.getOwnerDocument().createTextNode("uuid:" + UUID.randomUUID().toString()));

            QName qname = new QName(NAMESPACE_URI, LOCAL_NAME);
            SoapHeader header = new SoapHeader(qname, element);

            // by default a SoapHeader is created with 'direction out'
            header.setDirection(Header.Direction.DIRECTION_IN);

            headers.add(header);
        }
    }

    /**
     * Checks if the MessageID header exists in the list of headers.
     *
     * @param headers list of headers
     * @return true if the MessageID header exists, false if not
     */
    private Boolean messageIdHeaderExists(ArrayList<SoapHeader> headers) {
        for(SoapHeader header:headers) {
            if(header.getName().getLocalPart().equalsIgnoreCase(LOCAL_NAME)) {
                return true;
            }
        }
        return false;
    }        

} 
```

在 Spring 上下文中定义拦截器：

```
<bean id="headerInterceptor" class="my.package.HeaderInterceptor" />

<jaxws:endpoint implementor="#service" address="/ws">
    <jaxws:inInterceptors>
        <ref bean="headerInterceptor" />
    </jaxws:inInterceptors>
</jaxws:endpoint> 
```

使用 CXF 版本 2.6.1 进行测试。有关拦截器的更多信息：http: [//cxf.apache.org/docs/interceptors.html](http://cxf.apache.org/docs/interceptors.html)

# java - Salesforce REST API 查询超过 2000

> ID：10419376
> 
> 赞同：9
> 
> 时间：2012-05-02T18:14:28.840
> 
> 标签：java, rest, pagination, salesforce

我正在尝试使用[Salesforce REST API执行](http://www.salesforce.com/us/developer/docs/api_rest/index.htm)[SOQL](http://www.salesforce.com/us/developer/docs/api/index_Left.htm#CSHID=sforce_api_calls_soql.htm|StartTopic=Content%2Fsforce_api_calls_soql.htm|SkinName=webhelp)查询，该查询将返回 2,749 个结果。但是，对于给定的请求，似乎可以返回 2,000 个结果的限制。

有没有办法不使用OFFSET关键字查询剩下的749条结果？（我的生产环境目前不支持它）。

我对此进行了调查，发现了一个[queryMore](http://www.salesforce.com/us/developer/docs/api/index_Left.htm#StartTopic=Content/sforce_api_calls_querymore.htm)函数，但我找不到通过 REST API 调用它的方法。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-02T18:25:24.727

结果的一部分是 nextRecordsUrl 属性，当您对其执行 GET 时，将返回结果的下一部分。请参阅其余 api 文档中的[查询部分。](https://developer.salesforce.com/docs/atlas.en-us.api_rest.meta/api_rest/dome_query.htm)

# c++ - 比较 double 和 int，无需转换或转换

> ID：10419377
> 
> 赞同：1
> 
> 时间：2012-05-02T18:14:29.047
> 
> 标签：c++, expression, precision

在我们拥有的一个 C++ 模块中，我们有一种表达式评估语言。

```
 \
EVDataElement NAME::eval(   const EvalContext &ec,                          \
                        const bool recursiveFlag,                       \
                        EVEvaluatorTraceFormatter * trace )             \
{                                                                           \
/*  EVTimer timer("(DECLARE_REL_EVAL)","eval","*", "", 1,1, 3);      */     \
    EVDataElement val (                                                     \
        (left->eval(ec, recursiveFlag, trace))                              \
        OP (right->eval(ec, recursiveFlag, trace)) );                       \
    return val;                                                             \
}

DECLARE_REL_EVAL(oLT,<)
DECLARE_REL_EVAL(oLE,<=)
DECLARE_REL_EVAL(oGT,>)
DECLARE_REL_EVAL(oGE,>=)
DECLARE_REL_EVAL(oEQ,==)
DECLARE_REL_EVAL(oNE,!=) 
```

该模块允许设置某些配置规则。

所以，如果数据库中有一条规则说 field1 - field2 > param1，它会通过传递给上面的表达式语言来验证这个条件并返回一个结果。

我们现在面临的问题是 param1 = 3, and field1 = 6.15, and field2 = 3.15

它说结果是真的。我认为这是因为 6.15 和 3.15 的差异导致 3.00

并且当 3.00 与 3 比较时，它认为 3.00 更大。有没有办法解决这个问题？

我说我们不能使用强制转换的原因是因为我们永远不知道左右可能会出现什么数据类型。我希望这个问题是有道理的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-02T18:26:31.137

在处理不同原始类型的值时，您将获得“通常的转换”。我不认为有任何办法解决这个问题。

如果您将`int`s 与`double`s 进行比较，则在确定两个值是否“足够接近”时，您将需要提出您想要使用的任何规则。您可以考虑使用[`std::modf`函数 (in `<cmath>`)](http://www.cplusplus.com/reference/clibrary/cmath/modf/)进行比较。

考虑：

```
#include <iostream>
#include <cmath>

int main()
{
    double d = 6.15 - 3.15;
    std::cout << std::boolalpha;
    std::cout << "d == 3.0: " << (d == 3.0) << '\n';
    double i;
    d = std::modf(d, &i);
    std::cout << "i = " << i << ", d = " << d << '\n';
    std::cout << "i == 3.0: " << (i == 3.0) << '\n';
} 
```

在默认设置下使用 Visual Studio 2010（即**不**使用`fastmath`）我得到：

```
d == 3.0: false
i = 3, d = 4.44089e-016
i == 3.0: true 
```

`3.0`可以用二进制浮点数学精确表示，但`6.15 - 3.15`不能`3.0`用二进制浮点数学表示。

* * *

已经有两篇文章引用了“ [What Every Computer Scientist Should Know About Floating-Point Arithmetic](http://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html) ”一文，它描述了二进制浮点数学的工作原理，以及它如何并不总是符合人类的期望。要记住的要点是，您几乎不想比较两个浮点数是否相等，特别是如果这些数字中的一个（或两个）是数学运算的结果。

但是，在您的情况下，您正在尝试将 a`double`与 an进行比较`int`，并且我必须假设您想要**一些**舍入。您可能要考虑`3.1`等效于`3`. 你可能不会。我真的不知道。

如果您要使用小学教授的四舍五入约定（四舍五入为 0.5 或更高），您可能会执行以下操作：

```
#include <iostream>
#include <cmath>

int main()
{
    double d = 6.15 - 3.15;
    std::cout << std::boolalpha;
    std::cout << "d == 3.0: " << (d == 3.0) << '\n';
    // note:  this rounds negative numbers the wrong direction
    std::cout << "d is 'close enough' to 3.0: " << (std::floor(d + 0.5) == 3.0) << '\n';
} 
```

还有更复杂的可能性，包括论文中描述的一种。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T18:55:44.603

如果你想要`field1 - field2 > param1`for `param1 = 3`，`field1 = 6.15`那么`field2 = 3.15`你将需要使用`infinite precision`算术。

请阅读上面提到的[浮点算术](http://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html)论文。

# java - 生成集合的笛卡尔幂

> ID：10419382
> 
> 赞同：1
> 
> 时间：2012-05-02T18:14:51.787
> 
> 标签：java, math

有没有一种快速的方法来生成集合的笛卡尔幂？

例如，如果集合是 {1, 2}，则 {1, 2} x {1, 2} = {(1, 1), (1, 2), (2, 1), (2, 2) }。对于任何给定的功率，我将如何生成它？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T18:20:12.580

我想用*power*，你的意思是该集合与自身组合的频率是多少？所以幂 3 将是：

```
{1, 2} x {1, 2} x {1, 2} = (({1, 2} x {1, 2}) x {1, 2}) 
```

所以你可以递归地解决它，将集合组合一次，然后将集合与结果...

如果您愿意，可以将我的 Iterator for Lists of Lists 改编为 List of Sets ，并构建一个交互器： import java.util.*;

```
class CartesianIterator <T> implements Iterator <List <T>> {

    private final List <List <T>> lilio;    
    private int current = 0;
    private final long last;

    public CartesianIterator (final List <Set <T>> llo) {
    // transform Set<T> to List <T>, because we need an index later
        List <List <T>> llt = new ArrayList <List <T>> ();    
        for (Set <T> st : llo)
        {
        List <T> lt = new ArrayList <T> ();
        for (T t: st)
            lt.add (t);
        llt.add (lt);
    }
        lilio = llt;
        long product = 1L;
        for (List <T> lio: lilio)
            product *= lio.size ();
        last = product;
    } 

    public boolean hasNext () {
        return current != last;
    }

    public List <T> next () {
        ++current;
        return get (current - 1, lilio);
    }

    public void remove () {
        ++current;
    }

    private List<T> get (final int n, final List <List <T>> lili) {
        switch (lili.size ())
        {
            case 0: return new ArrayList <T> (); // no break past return;
            default: {
                List <T> inner = lili.get (0);
                List <T> lo = new ArrayList <T> ();
                lo.add (inner.get (n % inner.size ()));
                lo.addAll (get (n / inner.size (), lili.subList (1, lili.size ())));
                return lo;
            }
        }
    }
}

class CartesianIterable <T> implements Iterable <List <T>> {

    private List <Set <T>> lilio;  

    public CartesianIterable (List <Set <T>> llo) {
        lilio = llo;
    }

    public Iterator <List <T>> iterator () {
        return new CartesianIterator <T> (lilio);
    }
}

public class SetItTest 
{
    public static void main ( String [] args )
    {
        Set <Integer> si = new HashSet<Integer> ();
        si.add (1);
        si.add (2);
        List <Set<Integer>> ls = new ArrayList <Set<Integer>> ();
        ls.add (si);
        ls.add (si);
        ls.add (si);
        CartesianIterable <Integer> ci = new CartesianIterable <Integer> (ls); 
        for (List <Integer> li : ci) 
        {
            for (int i : li)
                System.out.print (i + " ");
            System.out.println ();
        }
    }
} 
```

输出：java SetItTest

```
1 1 1 
2 1 1 
1 2 1 
2 2 1 
1 1 2 
2 1 2 
1 2 2 
2 2 2 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T18:51:17.870

如果你可以使用外部库，[Guava](http://guava-libraries.googlecode.com)有[`Sets.cartesianProduct(Set<E>...)`](http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Sets.html#cartesianProduct%28java.util.Set...%29)，所以你可以这样做：

```
Set<Integer> set = ImmutableSet.of(1, 2);
Set<List<Integer>> = Sets.cartesianProduct(set, set);
// returns {[1, 1], [1, 2], [2, 1], [2, 2]} as desired 
```

（披露：我为 Guava 做出了贡献。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T19:07:20.800

您可以尝试使用两个向量 v1 = {x1...xn}, v2 = {y1...yn}

```
public List producto(List a, List b) {
    List producto = new ArrayList();
    for (String s1 : a);
        for (String s2 : b) {
            List duo = new ArrayList();
            duo.add(s1);
            duo.add(s2);
            producto.add(duo);
        }
    }
    return producto;
} 
```

# javascript - phonegap 相机未将图像加载到标签中

> ID：10419383
> 
> 赞同：4
> 
> 时间：2012-05-02T18:14:54.323
> 
> 标签：javascript, jquery, html, jquery-mobile, cordova

我正在尝试使用 navigator.camera 对象来捕获图像并将其推送到 img 标签中。我正在做演示在 phonegap 文档中所说的内容，如下所示：

```
if(navigator.camera) {
    navigator.camera.getPicture(function(imageData){
        var $image = document.getElementById('imageForTask');
        image.src = "data:image/jpeg;base64," + imageData;
        console.log(imageData);
       }, null, {sourceType:1, quality: 50});               
} else {
    alert("Camera not supported on this device.");
} 
```

但是，当我这样做时，我在 imageForTask 中得到了一个断开的链接。这是消息来源所说的：`data:image/jpeg;base64,content://media/external/images/media/325`。有谁知道为什么这不起作用？我一直在努力解决这个问题。谢谢！

-杰夫

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T18:21:00.887

默认destinationType 已从DATA_URL 更改为FILE_URI。如果添加选项：

```
destinationType : Camera.DestinationType.DATA_URL 
```

对于您传递以获取图片的选项，您将能够将其设置为 base64 编码数据。

[http://docs.phonegap.com/en/1.6.1/cordova_camera_camera.md.html#cameraOptions_options](http://docs.phonegap.com/en/1.6.1/cordova_camera_camera.md.html#cameraOptions_options)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T18:18:27.017

`content://media/external/images/media/325`是图像的路径，而不是其实际的二进制数据。您需要使用文件系统 API 来获取文件的内容，对其进行 base64 编码，然后使用它。

# visual-studio - 安装早期版本的 Ankhsvn

> ID：10419385
> 
> 赞同：2
> 
> 时间：2012-05-02T18:15:07.017
> 
> 标签：visual-studio, tortoisesvn, ankhsvn

我安装了 Ankhsvn 2.3，但假设我使用的是 Subversion 1.7，但我不是。现在我正在尝试安装 Ankhsvn 2.1，但它说我无法安装，因为已经安装了更新版本的产品。

那么，如何卸载 Ankhsvn 2.3？我找不到卸载程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T14:57:59.790

Windows 设计指南告诉应用程序开发人员，他们应该只将卸载程序添加到开始->控制面板->软件列表。因此，您可以在这里找到 AnkhSVN 卸载程序（就像任何其他 MSI 一样）

在程序菜单中添加不必要的卸载图标甚至会成为“专为 Windows 设计”应用程序的设计错误。

# database - 如何使用delphi将Excel文件导入Access数据库

> ID：10419386
> 
> 赞同：4
> 
> 时间：2012-05-02T18:15:11.763
> 
> 标签：database, delphi, ms-access, delphi-xe2, import-from-excel

我正在编写一个数据库应用程序，使用 Delphi，需要在 Excel 工作表上导入数据并将其保存在 Access 数据库中。我不知道如何做到这一点，使用什么组件，或者如果可能的话，请你帮帮我。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-02T22:27:31.353

您有多种选择，请尝试其中一种

1）使用[`DoCmd.TransferSpreadsheet`](http://msdn.microsoft.com/en-us/library/bb214134%28office.12%29.aspx)函数，这种方法比较简单，但不是很灵活。

```
{$APPTYPE CONSOLE}

{$R *.res}

uses    
  SysUtils,
  ActiveX,
  ComObj;

procedure ImportDataAccess(const AccessDb, TableName, ExcelFileName:String);
Const
  acQuitSaveAll             = $00000001;
  acImport                  = $00000000;
  acSpreadsheetTypeExcel9   = $00000008;
  acSpreadsheetTypeExcel12  = $00000009;
var
 LAccess : OleVariant;
begin
 //create the COM Object
 LAccess := CreateOleObject('Access.Application');
 //open the access database
 LAccess.OpenCurrentDatabase(AccessDb);//if the access database doesn't exist use the NewCurrentDatabase method instead.
 //import the data
 LAccess.DoCmd.TransferSpreadsheet( acImport, acSpreadsheetTypeExcel9, TableName, ExcelFileName, True);
 LAccess.CloseCurrentDatabase;
 LAccess.Quit(1);
end;

begin
 try
    CoInitialize(nil);
    try
      ImportDataAccess('C:\Data\Database1.accdb','Sales','C:\Data\Sales.xlsx');
      Writeln('Done');
    finally
      CoUninitialize;
    end;
 except
    on E:EOleException do
        Writeln(Format('EOleException %s %x', [E.Message,E.ErrorCode]));
    on E:Exception do
        Writeln(E.Classname, ':', E.Message);
 end;
 Writeln('Press Enter to exit');
 Readln;
end. 
```

2）使用ado组件，更灵活的方式。

```
{$APPTYPE CONSOLE}

{$R *.res}

uses
  Data.DB,
  Data.Win.ADODB,
  SysUtils,
  ActiveX,
  ComObj;

procedure ImportDataADO(const AccessDb, TableName, ExcelFileName:String);
var
  LAdoQueryExcel  : TADOQuery;
  LADOAccesCmd    : TADOCommand;
begin
   LAdoQueryExcel:=TADOQuery.Create(nil);
   LADOAccesCmd:=TADOCommand.Create(nil);
   try
    //set the connection string for access
    LADOAccesCmd.ConnectionString:=Format('Provider=Microsoft.ACE.OLEDB.12.0;Data Source=%s;',[AccessDb]);
    LADOAccesCmd.Parameters.Clear;
    LADOAccesCmd.CommandText:='INSERT INTO Sales (id,name) VALUES (:id,:name)';
    LADOAccesCmd.ParamCheck:=False;

    //set the connection string for excel
    LAdoQueryExcel.ConnectionString:=Format('Provider=Microsoft.ACE.OLEDB.12.0;Data Source=%s;Extended Properties="Excel 12.0 Xml;HDR=YES;IMEX=1"',[ExcelFileName]);
    LAdoQueryExcel.SQL.Add('SELECT * FROM [Sheet1$]');
    LAdoQueryExcel.Open;
    while not  LAdoQueryExcel.eof do
    begin
      LADOAccesCmd.Parameters.ParamByName('id').Value      := LAdoQueryExcel.FieldByname('id').AsInteger;
      LADOAccesCmd.Parameters.ParamByName('name').Value    := LAdoQueryExcel.FieldByname('name').AsString;
      LADOAccesCmd.Execute;
      LAdoQueryExcel.Next;
    end;
   finally
     LAdoQueryExcel.Free;
     LADOAccesCmd.Free;
   end;
end;

begin
 try
    CoInitialize(nil);
    try
      ImportDataADO('C:\Datos\Database1.accdb','Sales','C:\Datos\Sales.xlsx');
      Writeln('Done');
    finally
      CoUninitialize;
    end;
 except
    on E:EOleException do
        Writeln(Format('EOleException %s %x', [E.Message,E.ErrorCode]));
    on E:Exception do
        Writeln(E.Classname, ':', E.Message);
 end;
 Writeln('Press Enter to exit');
 Readln;
end. 
```

# jquery - 单击两个不同的按钮时jQuery调用相同的函数

> ID：10419388
> 
> 赞同：2
> 
> 时间：2012-05-02T18:15:27.700
> 
> 标签：jquery, function

我有一个带有类的按钮，`try`当它被点击时，有一个正在被调用的函数，现在我想创建一个名为的按钮`start`，它会做同样的事情，我不想在那个按钮点击处理程序中复制粘贴整个代码，有没有办法说让我们说如果`try`或`start`在jquery中执行以下操作？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-02T18:16:49.003

我假设既然你说`a button called start`那`start`是id。这就是为什么我使用 a`#`而不是 a`.`来引用它。

```
$('.try, #start').click(function(e){
    YourFunction();
}); 
```

如果`start`是类，则使用它。`#`表示一个id，而`.`表示一个类。

```
$('.try, .start').click(function(e){
    YourFunction();
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-02T18:17:24.713

将处理程序代码移动到命名函数并绑定命名函数。

```
function someFunction() {
}

$('.try').on('click', someFunction);
$('.start').on('click', someFunction); 
```

或者在一行中，

```
$('.try, .start').on('click', someFunction); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-02T18:21:09.403

```
$('.start, .try').click(function(){
//do your thing here
}); 
```

假设两个具有不同类的按钮：

```
<button class='try'>try</button>
<button class='start'>start</button> 
```

如果您使用一类会容易得多：

```
<button class='trystart'>try</button>
<button class='trystart'>start</button>

$('.trystart').click(function(){
//do your thing here
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-02T18:17:02.443

做就是了：

```
$('#start, .try').on('click', function(){ // both of them
   myFunction();
}); 
```

或者：

```
$('#start').on('click', function(){
   $('.try').click();         // trigger .try action
}); 
```

* * *

或者只是在点击中调用你的函数：

```
function myClickFunction(){
   // your code ...
}

$('#start').on('click',function(){
   myClickFunction();
}); 
```

# spring - 使用 Open MQ 时的 Spring JMS 会话问题

> ID：10419389
> 
> 赞同：1
> 
> 时间：2012-05-02T18:15:29.183
> 
> 标签：spring, jms, spring-jms, openmq

我正在使用 spring-jms-3.0.6.RELEASE 并打开 MQ。关于为什么会引发以下异常的任何想法？

```
2012-05-02 17:56:18,420 [stuJmsContainer-803059] WARN
org.springframework.jms.listener.DefaultMessageListenerContainer - Setup of JMS message listener invoker failed for destination 

'TestQ' - trying to recover. Cause: 
MQRA:CA:createSession failed-Only one JMS Session allowed when managed connection is involved in a transaction 
```

**网页.xml：**

```
 <context-param>
            <param-name>contextConfigLocation</param-name>
             <param-value>
                    classpath:/spring/testlistener-context-api.xml
                    classpath:/spring/testmsg-context-api.xml
             </param-value>
        </context-param>
 <listener>
      <listener-class>org.jboss.resteasy.plugins.spring.SpringContextLoaderListener</listener-class>
 </listener>
 <listener>
        <listener-class>org.springframework.web.util.Log4jConfigListener</listener-class>
 </listener> 
 <listener>
        <listener-class>org.springframework.web.context.request.RequestContextListener</listener-class>
 </listener> 
```

**testlistener-context-api.xml：**

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:util="http://www.springframework.org/schema/util"
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:aop="http://www.springframework.org/schema/aop"
    xmlns:tx="http://www.springframework.org/schema/tx"
    xsi:schemaLocation="
    http://www.springframework.org/schema/beans 
    http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
    http://www.springframework.org/schema/util 
    http://www.springframework.org/schema/util/spring-util-3.0.xsd
    http://www.springframework.org/schema/context
    http://www.springframework.org/schema/context/spring-context-3.0.xsd
    http://www.springframework.org/schema/tx
    http://www.springframework.org/schema/tx/spring-tx-3.0.xsd
    http://www.springframework.org/schema/aop
    http://www.springframework.org/schema/aop/spring-aop-3.0.xsd">

    <tx:annotation-driven />

    <bean id="testListener" class="com.test.TestListener" />

    <bean id="executionInterceptor" class="com.test.ExecutionInterceptor" />

     <bean id="testJmsContainer" class="org.springframework.jms.listener.DefaultMessageListenerContainer">
        <property name="connectionFactory" ref="jmsQueueConnectionFactory"/>
        <property name="destinationName" value="TestQ"/>
        <property name="sessionTransacted" value="false"/>
        <property name="messageListener" ref="stuMessageListener" />
        <property name="concurrentConsumers" value="5" />
        <property name="maxConcurrentConsumers" value="100" />
        <property name="receiveTimeout" value="30000" />
    </bean>
</beans> 
```

**testmsg-context-api.xml：**

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:util="http://www.springframework.org/schema/util"
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:aop="http://www.springframework.org/schema/aop"
    xmlns:tx="http://www.springframework.org/schema/tx"
    xsi:schemaLocation="
    http://www.springframework.org/schema/beans 
    http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
    http://www.springframework.org/schema/util
    http://www.springframework.org/schema/util/spring-util-3.0.xsd
    http://www.springframework.org/schema/context
    http://www.springframework.org/schema/context/spring-context-3.0.xsd
    http://www.springframework.org/schema/tx
    http://www.springframework.org/schema/tx/spring-tx-3.0.xsd
    http://www.springframework.org/schema/aop
    http://www.springframework.org/schema/aop/spring-aop-3.0.xsd">

    <bean id="jndiTemplate" class="org.springframework.jndi.JndiTemplate"/>

    <bean id="jmsQueueConnectionFactory" class="org.springframework.jndi.JndiObjectFactoryBean">
        <property name="jndiTemplate">
            <ref bean="jndiTemplate"/>
        </property>
        <property name="jndiName" value="${jms.jndi.qconnectionfactory}">

        </property>
    </bean>
    <bean id="jmsTopicConnectionFactory"  class="org.springframework.jndi.JndiObjectFactoryBean">
        <property name="jndiTemplate">
            <ref bean="jndiTemplate"/>
        </property>
        <property name="jndiName" value="${jms.jndi.tconnectionfactory}">

        </property>
    </bean>
    <bean id="myJMSConnectionFactory" class="com.test.OpenMqConnectionFactoryBean">
        <property name="imqAddressList" value="${jms.imq.url}" />
        <property name="imqDefaultUsername" value="${jms.imq.user}" />
        <property name="imqDefaultPassword" value="${jms.imq.password}" />
        <property name="imqHost" value="${jms.imq.host}" />
        <property name="imqPort" value="${jms.imq.port}" />
    </bean>
    <bean id="jmsTopicTemplate"  class="com.test.CustomJMSTemplate">
        <property name="connectionFactory" ref="jmsTopicConnectionFactory" />
        <property name="connectionFactoryName" value="${jms.jndi.tconnectionfactory}"/>
        <property name="pubSubDomain" value="true" />
    </bean>
    <bean id="jmsTemplate"  class="com.test.CustomJMSTemplate">
        <property name="connectionFactory" ref="jmsQueueConnectionFactory" />
        <property name="connectionFactoryName" value="${jms.jndi.qconnectionfactory}"/>
    </bean>

    <tx:annotation-driven />
</beans> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T20:51:07.033

根据[OpenMQ 邮件列表上的](http://java.net/nonav/projects/mq/lists/users/archive/2008-10/message/39)[ConnectionAdapter 源代码](http://mq.java.net/downloads.html)和此存档线程，Spring 或您的代码本身在单个 JMS 连接上创建了多个会话。

可以通过将系统属性设置为来禁用此 OpenMQ 行为（引发错误）`imq.jmsra.inACC`，`false`但它并不令人满意。

如果没有事务管理器，Spring 使用[org.springframework.jms.connection.SingleConnectionFactory](http://static.springsource.org/spring/docs/3.0.x/api/org/springframework/jms/connection/SingleConnectionFactory.html)为多个消费者共享单个连接。

您应该将[DefaultMessageListenerContainer cacheLevelName](http://static.springsource.org/spring/docs/3.0.x/api/org/springframework/jms/listener/DefaultMessageListenerContainer.html#setCacheLevelName%28java.lang.String%29)属性设置为，`CACHE_NONE`以便每个使用者线程在单个连接上获得自己的会话。

# ajax - CakePHP，找不到帮助程序类 AjaxHelper

> ID：10419392
> 
> 赞同：3
> 
> 时间：2012-05-02T18:15:38.717
> 
> 标签：ajax, cakephp, cakephp-1.3, cakephp-2.1, cakephp-ajaxhelper

我正在尝试在此站点上找到这个 cakePHP ajax 教程：http://poli.bonzahost.net/2010/07/17/simple-ajax-call-in-cakephp/[但](http://poli.bonzahost.net/2010/07/17/simple-ajax-call-in-cakephp/) 它不起作用。我为它制作了数据库，并制作了`brokers`带有所需字段 、`id`和的表`name`，`last_name`并将`created`和`modified`作为 2 个额外字段添加到表中。我在 database.php 文件中设置了设置，以使用正确的密码将其指向我的主机、用户和数据库模式等等。我改变了一些东西，例如form->create，form->input和ajax->submit到this->Form->create，this->form->Input和this->Ajax->submit，因为我正在工作使用 CakePHP 2.1.2，而不是 CakePHP 1.3。

但是我进入了我的应用程序：找不到帮助程序类 AjaxHelper。

错误：发生内部错误。，

我认为我下载的 cakePHP 中缺少 AjaxHelper.php 文件。我认为它应该在：www\cakeAjax\app\View\Helper，但它从那里丢失了。这是这个问题的原因吗？

如果是这样，我在哪里可以找到 AjaxHelper.php 文件的副本，并且 www\cakeAjax\app\View\Helper 我会把它放在哪里？如果没有，我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T18:39:59.643

自 CakePHP 1.3 起，Ajax 助手就被弃用了。您现在可以将[CakePHP 的 JsHelper](http://book.cakephp.org/2.0/en/core-libraries/helpers/js.html)用于 Ajax 内容。

# python - python csv阅读器科学计数法

> ID：10419393
> 
> 赞同：2
> 
> 时间：2012-05-02T18:15:41.517
> 
> 标签：python

```
import csv
excel_cell = 6.48084E+11
cell = csv.reader(excel_cell)
print cell
>> cell = 6.48084E+11
# My desired output would be cell = 648084201003 
```

我正在尝试在 python 中使用 csv 阅读器来读取 excel csv 并返回一些值。该单元格以科学计数法显示，但如果我单击该单元格，它会显示其值为`648084201003`. 有没有办法可以将其读取为数字而不是科学记数法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T18:35:55.807

csv.reader 与问题完全无关。它返回项目的行：

```
>>> a = 6.48084E+11
>>> a
648084000000.0
>>> s = '{0:.0f}'.format(a)
>>> s
'648084000000'
>>> print s
648084000000 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T18:21:16.563

例子：

```
>>> l = 6.48084E+11
>>> print l
6.48084e+11
>>> print repr(l)
648084000000.0 
```

# php - 在 MySQL 中选择时是否需要使用我的 'sql_real_escape_string'？

> ID：10419398
> 
> 赞同：0
> 
> 时间：2012-05-02T18:16:02.357
> 
> 标签：php, mysql, sql, login

我正在关注有关如何创建登录系统的教程，*[以正确的方式创建安全登录系统。](http://tinsology.net/2009/06/creating-a-secure-login-system-the-right-way/)*在他们在用户名字段上使用的代码`mysql_real_escape_string`中，然后将其作为查询传递给数据库，也就是说，

```
$username = mysql_real_escape_string($username); 
```

这是必要的，因为我没有向数据库添加任何东西，我只是检查这个用户是否已经存在？

我不只是留下它的原因是当我使用上面的代码时，它会使我的文本变为空白，因此向数据库发送一个空字符串。我不知道这是为什么，所以我想，如果我能把它排除在外，我会的。

以下是关于从评论者打开数据库连接的建议（密码等已更改）：

```
function dbConnect(){
    $connection = mysql_connect('localhost', 'username', 'password');
    $database=mysql_select_db('database', $connection);

    return $connection;
}

$username = $_POST['username'];
$password = $_POST['password'];
$password = md5($password);

$username = mysql_real_escape_string($username);

$query = mysql_query("SELECT *
      FROM members
      WHERE username = '$username'
      AND password = '$password'",dbConnect()); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T18:26:44.210

您可能希望将[PDO 与准备好的语句](http://php.net/manual/en/pdo.prepared-statements.php)一起使用。准备好的语句就像 SQL 查询中的占位符，稍后您将发送将插入这些位置的数据。这使得转义字符串过时了。

正如我在上面的评论中已经提到的：每个带有用户输入的 SQL 查询都容易受到[SQL 注入](http://en.wikipedia.org/wiki/SQL_injection)攻击。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T19:22:01.027

正确的代码是：

```
dbConnect();
$username = mysql_real_escape_string($_POST['username']);
$password = md5($_POST['password']);

$sql = "SELECT * FROM members WHERE username = '$username' AND password = '$password'";
$res = mysql_query($sql) or trigger_error(mysql_error().$sql); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T18:19:53.820

是的，这是必要的，因为`username`可能包含 SQL 中不允许的特殊字符，需要转义`'`，`/` 例如

例子：

`'`在用户名中不转义`McDonald's`会导致非法 SQL 语句：

```
select * from your_table where username = 'McDonald's' 
```

# wcf - 是否可以在运行时重写 Silverlight 应用程序资源？

> ID：10419404
> 
> 赞同：3
> 
> 时间：2012-05-02T18:16:30.827
> 
> 标签：wcf, silverlight

有一个 ServiceReferences.ClientConfig 文件，其中包含 Silverlight 应用程序正在使用的 WCF 服务的不同设置。很好也很容易，除非一旦你设置了它们，你以后不修改 xap 就不能改变它们。

我想让这些设置更容易配置。有几种选择：

*   在 web.config 中添加一个专门的部分，管理员可以在其中更改它们。将这些设置传输到 silverlight，然后在页面上渲染对象。在 silverlight 中解析它，然后手动构建通道。我宁愿避免的事情。
*   如果我们可以说 silverlight 应用程序不是从 xap 资源，而是从指定的 uri 加载 ServiceReferences.ClientConfig，那就太好了。这样我就可以将此配置放在 web.config 中。好的。虽然不可能。
*   如果我可以替换资源流解析器，那也可以。可悲的是，这似乎也不可能。有 IApplicationResourceStreamResolver，但它是内部的。
*   在silverlight应用程序启动后，也许有一种方法可以重写应用程序资源流？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T05:17:55.613

我猜你想在运行时制作 servicesclient 配置文件。

如果是这种情况，那么只需创建 System.ServiceModel.BasicHttpBinding 对象并分配属性并将服务 URL 分配给 System.ServiceModel.EndpointAddress。然后可以将此绑定对象和端点地址对象分配给客户端对象构造函数，瞧！

# javascript - 在 HTML 和 jQuery 中传递变量

> ID：10419411
> 
> 赞同：0
> 
> 时间：2012-05-02T18:17:11.743
> 
> 标签：javascript, jquery, html, var

我正在使用 jQuery 移动框架；并使用该框架，我有一个结构如下的网格：

```
<div style="text-align: center;" class="ui-grid-b">

                    <div class="ui-block-a">
                        <a href="lengthDat.html"><img src="images/Longtail.jpg" width="200" height="200"></a>
                        <p style="display: inline;">Longtail</p>
                        <a href="longtail_info.html" rel="external" data-inline="true" data-role="button" 
                                data-mini="true"     data-iconpos="notext" data-icon="info">Longtail Info</a>
                    </div>

                    <div class="ui-block-b">
                        <a href="lengthDat.html"><img src="images/Northern_Dusky.jpg" width="200" height="200"></a>
                        <p style="display: inline;">Northern Dusky</p>
                        <a href="dusky_info.html" rel="external" data-inline="true" data-role="button" 
                                data-mini="true"     data-iconpos="notext" data-icon="info">Dusky Info</a>
                    </div>

                    <div class="ui-block-c">
                        <a href="lengthDat.html"><img src="images/Northern_Spring.jpg" width="200" height="200"></a>
                        <p style="display: inline;">Northern Spring</p>
                        <a href="spring_info.html" rel="external" data-inline="true" data-role="button" 
                                data-mini="true"     data-iconpos="notext" data-icon="info">Spring Info</a>
                    </div>

      .... SNIP 2 ROWS ....
</div> 
```

现在，这是我的问题。我有所有图片链接到同一页面，但它们是不同类型的蝾螈。我正在尝试获取他们单击的类型，因此我可以在下一页（测量页面）上使用它。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T18:19:31.510

您可以为每个链接提供一个查询字符串，并使用服务器端语言（最佳）或 javascript 来获取它。

例如`lengthDat.html?type=longtail`，`lengthDat.html?type=northern+dusky`

如果您想知道如何使用 JavaScript 读取查询字符串参数，请转到这个 SO 问题：[如何在 JavaScript 中获取查询字符串值？](https://stackoverflow.com/questions/901115/get-query-string-values-in-javascript)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T18:19:53.557

这很容易，只需从 img 源中提取扩展名（如果这就是您所说的类型和不同的蝾螈）

```
$('a').on('click', function(ev) {

    ev.preventDefault();

    var ext = $(this).children('img:eq(0)').attr('src').split('.').pop();

    window.location = '?type=' + ext;
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T18:55:20.500

我会将数据类型属性附加到图像标签并使用 jquery 获取它并附加到上面建议的 url。

var type = $('a').find('img').attr('data-type'), url = $('a').attr('href'); $('a').attr('href', href += '?type=' + type);

注意：您必须调整此代码以针对单击的特定元素，并且验证 url、处理已经有参数和没有参数的 url 是一种很好的做法。

# sharepoint - 确定 Windows Sharepoint Services 网站集中的最大文件

> ID：10419412
> 
> 赞同：1
> 
> 时间：2012-05-02T18:17:18.027
> 
> 标签：sharepoint, sharepoint-2007, wss

有什么方法可以确定存储在我的网站集中的哪些文件最大？我想以某种方式识别它们，然后删除它们以释放一些空间。

感谢您的任何想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T11:26:48.770

您必须使用 SharePoint API 并遍历网站集中所有网站的所有列表中的所有项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T14:30:04.740

您可以使用[站点数据查询](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spsitedataquery.aspx)来查找大于特定大小的所有文档：

```
SPWeb web = SPContext.Current.Web;
SPSiteDataQuery query = new SPSiteDataQuery();
// restrict to document libraries
query.Lists = "<Lists ServerTemplate=\"101\" />";
query.ViewFields = "<FieldRef Name=\"File_x0020_Size\" />";    
query.RowLimit = 20;
query.Query = "<Where><Geq><FieldRef Name=\"File_x0020_Size\" /><Value Type=\"Number\">{size in bytes}</Value></Geq></Where><OrderBy><FieldRef Name=\"File_x0020_Size\" Ascending=\"FALSE\" /></OrderBy>";

DataTable bigFiles = web.GetSiteData(query); 
```

**可读查询：**

```
<Where>
  <Geq>
    <FieldRef Name="File_x0020_Size" />
    <Value Type="Number">{size in bytes}</Value>
  </Geq>
</Where>
<OrderBy>
  <FieldRef Name="File_x0020_Size" Ascending="FALSE" />
</OrderBy> 
```

# javascript - 如何检查 css/js 资源是否包含在 head 中

> ID：10419414
> 
> 赞同：4
> 
> 时间：2012-05-02T18:17:20.697
> 
> 标签：javascript, html, css

```
<head>
  <link rel="stylesheet" type="text/css" href="mystyle.css">
  <script src="myscript.js"></script>
</head> 
```

我想要一个检查资源是否包含在头部的函数

```
checkIfHeaderHas('myscript.js'); // would return true
checkIfHeaderHas('mystyle.css'); // would return true
checkIfHeaderHas('mybla.css'); // would return false 
```

但我想知道如何在头部搜索文件名？（如果是 javascript，则在“src”中，如果是 css，则在“href”中）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-02T18:29:48.560

我做了一个小功能，可以满足您的需求。它遍历所有`<link>`和`<script>`元素，直到找到具有该名称的脚本。如果不是，则返回 false。

```
function checkIfIncluded(file) {
    var links = document.getElementsByTagName("link");
    for(var i = 0; i < links.length; i++) {
        if (links[i].href.substr(-file.length) == file)
            return true;
    }

    var scripts = document.getElementsByTagName("script");
    for(var i = 0; i < scripts.length; i++) {
        if (scripts[i].src.substr(-file.length) == file)
            return true;
    }

    return false;
}

console.log(checkIfIncluded("mystyle.css"));
console.log(checkIfIncluded("myscript.js"));
console.log(checkIfIncluded("mybla.css"));
​ 
```

**[活生生的例子](http://jsfiddle.net/6qBhp/)**

**请注意，这不仅会在 中找到资源，`<head>`还会在整个文档中找到。**如果你真的需要看看大脑内部，告诉我，我们会想出别的办法。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-02T18:38:39.780

如果您使用的是 jQuery，您可能会执行以下操作：

```
var checkIfHeaderHas = function(fileName) {

    // Start with CSS.
    $.each($("header link"), function() {
        if ($(this).attr("href").toLowerCase() === fileName.toLowerCase())
            return true;
    });

    // Then JavaScript.
    $.each($("header script"), function() {
        if ($(this).attr("src").toLowerCase() === fileName.toLowerCase())
            return true;
    });

    // Default response.
    return false;
} 
```

对任何不完全正确的地方表示歉意。我正在从我的手机中敲出这个，并且没有时间测试。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-02T18:26:15.537

在 jquery 中使用 .length 可以解决这个问题。（未经测试！）

只需检查是否存在将 href 属性设置为 CSS 文件 URL 的元素：

```
if (!$("link[href='/path/to.css']").length){
alert('not loaded');
}else{
alert('loaded!');
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-07-13T17:22:57.633

这是一个有效的（经过测试的）解决方案：

```
function checkIfHeaderHas(name) {
  const checks = [
    {attr: 'href', items: $("head link")},
    {attr: 'src', items: $("head script")}
    // add any other if needed...
  ];
  let res = false;
  if (typeof name === 'string') {
    const lc = name.toLowerCase();
    for (let i = checks.length - 1; i >= 0; i--) {
      $.each(checks[i].items, function () {
        if (($(this).attr(checks[i].attr) || '').toLowerCase() === lc) {
          res = true;
          return false; // exit the loop as soon as found
        }
      })
    }
  }
  return res;
} 
```

# python - 将列表保存到文件

> ID：10419417
> 
> 赞同：1
> 
> 时间：2012-05-02T18:17:28.953
> 
> 标签：python, file, list, save

我有一个图书馆，我想在其中创建一本新书，然后将其添加到我的书单中。我遇到的问题是在调用之间保存文件。

这就是我读取文件的方式：

```
def read_bookfile():

    try:
        booklibrary_file = open("a.txt")

        booklibrary_list = []
        booklist = booklibrary_file.readlines()
        for rad in booklist:
            linelist = rad.split("/")
            title = linelist[0]
            firstname = linelist[1]
            lastname = linelist[2]
            isbn = int(linelist[3])
            availability = linelist[4]
            borrowed = linelist[5]
            late = linelist[6]
            returnday = linelist[7]
            b = Book(title, firstname, lastname, isbn, availability, borrowed, late, returnday) 
            booklibrary_list.append(b)
        booklibrary_file.close()
        return booklibrary_list 
```

现在我想知道如何保存到我的文件中。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-02T18:21:34.693

为了保存到文件，您必须以写入附加模式打开它。

```
library_file = open("a.txt", "a")
...
library_file.write("Some string\n")
...
library_file.close() 
```

有关更多信息，请参阅 Python 关于[内置函数的文档。](http://docs.python.org/library/functions.html#open)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T18:25:17.837

首先，假设这八个字段是唯一的，这是一种更容易阅读的方法：

```
def read_bookfile(filename="a.txt"):
    with open(filename) as f:
        return [Book(*line.split('/')) for line in f] 
```

现在，要保存：

```
 def save_bookfile(booklist, filename='a.txt'):
     with open(filename, 'w') as f:
         for book in booklist:
             f.write('/'.join([book.title, book.firstname, book.lastname, str(book.isbn),
                               book.availability, book.borrowed, book.late, book.returnday])
                     + '\n') 
```

假设`Book`模型只是将这些属性保存在它们被传递时（作为字符串）。

说明：

*   该`with`语句打开您的文件，并确保当控制超出该语句时它被关闭，即使存在异常或类似情况。
*   最好将文件名作为参数传递，因为它允许您在不更改函数的情况下使用不同的文件名；这使用默认参数，因此您仍然可以以相同的方式调用它。
*   这`[... for line in f]`是一个列表推导，这就像做`lst = []; for line in f: lst.append(...)`但更快地编写和运行。
*   以模式打开文件`'w'`允许您对其进行写入。请注意，这将删除文件中已经存在的内容；您可以使用`'a'`或`'w+'`避免这样做，但这需要更多的工作来协调现有内容与您的书单。
*   `*`in将`read_bookfile`列表拆分，就好像您将它们作为单独的参数传递给函数一样。
*   `'/'.join()`获取字符串列表并使用斜杠将它们连接在一起：`'/'.join(["a", "b", "c"])`is `"a/b/c"`。不过，它需要字符串，这就是我这样做的原因`str(isbn)`（因为`book.isbn`它是一个 int）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-02T20:20:10.790

Python 是“包括电池”的，记得吗？

考虑使用“csv”模块：

```
use csv

csv.reader(...)
csv.writer(...) 
```

我认为这些有很多选项（例如，您可以将分隔符设置为逗号以外；您可以读入字典列表等）

请参阅[用于 CSV 读取器/写入器的 Python 文档](http://docs.python.org/library/csv.html)：

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-02T18:27:24.847

我必须对您的 Book 课程做出一些假设，但我认为这可能有助于您走上正轨：

```
bookList = read_bookfile()

outfile = open("booklist.txt", "w")

for book in bookList:
        bookStr = book.title + " " + book.firstname + " " + book.lastname + " " + book.isbn + " " + book.availability + " " + book.borrowed + " " + book.late + " " + book.returnday + "\n"
        outfile.write(bookStr)

outfile.close() 
```

# c# - 可观察集合 CollectionChanged 事件

> ID：10419419
> 
> 赞同：4
> 
> 时间：2012-05-02T18:17:53.267
> 
> 标签：c#, wpf, c#-4.0

我有一个可观察的集合，并且在其上连接了一个 collectionChanged 事件。我将其项目绑定到 UI 中的列表框。当用户从列表框中删除 UI 中的某些项目时，CollectioChanged 会正确触发，但是，我需要知道已删除项目的索引。问题是我无法在更改集合后对其进行 indexOf 操作，因为它不再具有已删除的项目..

我们可以从 collectionchanged 事件中访问从 ObservableCollection 中删除的索引列表吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-02T18:20:45.430

该[`CollectionChanged`](http://msdn.microsoft.com/en-us/library/ms653375.aspx)事件使用为您提供[`NotifyCollectionChangedEventArgs`](http://msdn.microsoft.com/en-us/library/system.collections.specialized.notifycollectionchangedeventargs.aspx). 这有一个`OldStartingIndex`属性，它将告诉您它被删除的索引。例如：

```
void Foo()
{
    ObservableCollection<string> r = new ObservableCollection<string>();
    r.CollectionChanged += r_CollectionChanged;
}

static void r_CollectionChanged(object sender, System.Collections.Specialized.NotifyCollectionChangedEventArgs e)
{
    var itemRemovedAtIndex = e.OldStartingIndex;
} 
```

> 假设我要从不同索引的集合中删除多个项目。所以使用 oldStartingIndex 只会给我第一个被删除的项目索引

该事件很可能会触发多次，每个项目一次。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T18:21:35.300

是的。`OldStartingIndex`in`NotifyCollectionChangedEventArgs`是从中删除项目的索引。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-02T18:25:15.417

event 参数`e`具有属性`OldItems`和`OldStartingIndex`。这可能有帮助吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-02T18:37:03.393

您似乎认为可以`ObservableCollection`通过单个方法调用从一个中删除多个项目。这是不可能的。您必须调用`Remove`、`RemoveAt`或`RemoveItem`所有这些仅从集合中删除单个元素。这意味着每次从集合中删除一项时，将触发 remove 事件，并且`OldStartingIndex`和`OldItems`将分别包含对已删除一项的索引和一项的单个元素数组的引用。

您无法使用`OldStartingIndex`您所指出的在集合中进行查找，因为它已被删除。如果您需要访问最初引用的项目，您可以使用`OldItems`并获取第一个元素。

我没有使用过`ObservableCollection`，但我看到一次删除多个元素的唯一方法是调用`Clear`or `ClearItems`。如果这些触发了一个 changed 事件，那么我会想象这`OldStartingIndex`将是 0 并且`OldItems`将包含对以前在集合中的所有元素的引用。

# ruby-on-rails - 通过 page.replace_html 渲染部分并使用布局？

> ID：10419421
> 
> 赞同：0
> 
> 时间：2012-05-02T18:18:12.630
> 
> 标签：ruby-on-rails, layout, modal-dialog, render

这是我正在尝试做的事情：

```
 page.replace_html('manage_categories_list', :partial => "/categories/categories", :layout => :modal) 
```

但是，我在上面的代码中得到了这个错误：

```
NoMethodError (undefined method `include?' for :modal:Symbol): 
```

我想要做的是为模态对话框窗口提供模板 HTML。并使用任何部分设置该模式的标题（h2）和正文（div）。=\

modal.html.erb：

```
<div class="fixed_modal">
    <div class="modal_header">
        <%= yield :header %>
    </div>
    <div class="modal_body">
        <%= yield %>
    </div>
</div> 
```

我试图渲染的部分：

```
<% content_for :header do %>
    Manage Categories
<% end %> 
```

....休息无关紧要，因为它只是进入产量

我正在使用铁路 2.3.14

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T18:26:48.923

:layout 的参数不能是符号

```
:layout=>'modal' 
```

这假设您在 app/views/layouts/modal.html.erb 中有一个布局

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T18:30:52.810

很可能，您需要将其更改为`..., :layout => 'modal'`：

```
page.replace_html('manage_categories_list', :partial => "/categories/categories", :layout => :modal) 
```

#replace_html 方法接受像#render 这样的选项。对于 :layout 选项，您需要传递`true`或字符串布局文件名（请参阅[#render 的文档](http://apidock.com/rails/ActionController/Base/render)）。

布局参数将是 app/views/layouts/xyz.html.erb 中文件名的“xyz”部分。

# grails - STS 2.9.1 不断重复 Grails 生成的类

> ID：10419427
> 
> 赞同：0
> 
> 时间：2012-05-02T18:18:32.217
> 
> 标签：grails, groovy, sts-springsourcetoolsuite

源文件有时会以某种方式获取两个类文件，如下所示： ![错误截图](../Images/442a642394f0416fa0fc1eafcc605a35.png)

尝试删除任一类文件都会出错。Grails clean 和 Eclipse Clean Project 没有帮助。通常我必须删除源文件并重新创建以摆脱额外的类文件，但上次没有用。想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T07:29:21.533

请参阅 Burt Beckwith 的评论以获取解决方案（希望他已将其作为答案！）。

# drupal-7 - 如何使用 Zen 子主题将自定义字段添加到 template.php

> ID：10419428
> 
> 赞同：1
> 
> 时间：2012-05-02T18:18:32.610
> 
> 标签：drupal-7, drupal-theming

第一次在这里发帖，我是一个完全不熟悉 php 的设计师，我有一个小问题，我似乎无法解决。我正在使用 zen 上的子主题在 drupal 7 中创建一个站点。顺便说一句，这是一个很棒的 CMS，尽管人们说它实际上更像是一个开发者 CMS。使用视图、规则、显示套件等，我可以毫不费力地做我需要的事情。因此，非常感谢所有开发人员，使这成为一个如此好的 CMS。但是对于这个看似简单的问题......没有模块可以帮助我（我认为）而且我有点卡住了。

所以这里是：我想在我所有页面的标题旁边添加一个副标题。

所以我所做的就是在内容类型基本页面（机器名称：field_sub_title）中添加一个自定义字段，这是一个简单的文本字段。

我在我的 template.php 中取消了以下行的注释

`function mytheme_preprocess_page(&$variables, $hook) { $variables['sub_title'] = t('field_sub_title'); }`

现在我的问题是如何将自定义字段的内容加载到该变量中？我知道我需要更改第二部分，但我不知道我需要更改什么。

将变量显示到 page.tpl.php 是我所知道的，所以我只需要第一部分的帮助。

{EDIT}好的，我找到了如何做到这一点:)

我在错误的地方寻找解决方案。我不需要更改 template.php 文件中的任何内容。

只需将这段代码添加到我的 page.tpl.php 中：

```
<?php
print $node->field_sub_title['und'][0]['value'];
?> 
```

所以我在这里为其他苦苦挣扎的 Drupal 新手发布这个....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-14T14:31:40.273

考虑使用 field_get_items 或 field_view_value，或者至少使用 LANGUAGE_NONE 常量而不是 'und' 参见[https://api.drupal.org/api/drupal/modules%21field%21field.module/function/field_get_items/7](https://api.drupal.org/api/drupal/modules%21field%21field.module/function/field_get_items/7)和[https:/ /api.drupal.org/api/drupal/modules!field!field.module/function/field_view_value/7](https://api.drupal.org/api/drupal/modules!field!field.module/function/field_view_value/7)

这具有减少您创建的潜在安全漏洞数量的额外好处。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T22:59:55.380

您的解决方案现在可能有效，但可能有更多 Drupal-y 方式来处理此类问题。如果您还没有发现任何问题，您可能会发现以下一个或多个问题：

*   不了解 php 或 Drupal 主题的人可能需要更改其工作方式。
*   如果你像我一样，你可能会忘记它在代码中的具体实现位置。
*   您可能会在没有此子标题字段的节点（内容）上看到多余的标记和/或错误（即，事件内容没有子标题字段，而基本页面和新闻文章有）。

将字段添加到内容类型时，只要显示该内容类型的内容，它就会自动出现。您应该能够为您的页面、事件或您需要的任何其他内容添加子标题字段，并使其自动出现在标记中。

![管理内容类型的显示](../Images/7edea00288c0410395141e50e80702e0.png)

您可以“管理显示”内容类型以拖放字段出现的顺序。您可以更进一步，使用[Display Suite](http://drupal.org/project/ds)之类的模块为每个内容类型添加格式或布局。

* * *

如果您觉得这还不够好，并且副标题的标记必须与页面标题处于同一级别（这种情况很少见），至少添加一个 if 语句让您的代码检查变量是否存在在尝试打印之前。我还将添加一个新变量和注释以提高代码的可读性。

```
<?php
  $subtitle = $node->field_sub_title['und'][0]['value'];
  if($subtitle){
     print $subtitle;
  }
?> 
```

# jquery - Jquery，从关键字“this”到表中的所有 td

> ID：10419431
> 
> 赞同：0
> 
> 时间：2012-05-02T18:18:54.320
> 
> 标签：jquery, this

我有这个：

```
$(document).on("click","#imgCancel",function(){
   $("#tbl_zones td").click(function(){
      editTables("#tbl_zones td",this)
   })
}) 
```

我正在尝试使该函数更通用，以便它可以在多个表上工作。imgCancel 在表格内，我正在制作的所有表格中都会有一个 imgCancel 。

我考虑过像这样替换第二行：

```
$(document).on("click","#imgCancel",function(){
   $(this).closest('table').find('td').click(function(){
      editTables("#tbl_zones td",this)
   })
}) 
```

但是，它没有用，而且我也不知道应该把什么作为 editTables 的第一个参数（它应该引用当前表中的所有 td）。

编辑：修改 jknaack 的 jsfiddle，我最终得到了这个：

```
$(document).on("click","#imgCancel",function(){
    var tblID = $(this).closest('table').attr('id')
    $("#"+tblID+" td").click(function(){
        editTables("#"+tblID+" td",this)
    })
}) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T18:25:42.130

问题是 id 在您的文档中必须是唯一的，请改用 class 属性。

> w3c id 属性为 HTML 元素指定一个唯一的 id（id 属性值在 HTML 文档中必须是唯一的）。

*   [w3c - ID 属性](http://www.w3schools.com/tags/att_standard_id.asp)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T18:33:05.920

只需使用内部 id （假设它包含一个 td 元素）

```
$(document).on("click","#tbl_zones td", function(){
     editTables(this);
}); 
```

函数调用中的“this”将是单击的 td 元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T18:51:44.773

如果我理解正确，我认为您可以使用一些方法，将可点击元素内的新选择器作为数据属性传递。

很难知道你的 HTML 会是什么样子，所以我只是做了一个例子。当然，您可以自定义选择器以仅在单击的元素内部或壁橱中进行选择。

JS代码：

```
$(document).on("click",".actionbuttons",function(){
   var selectedElements = $($(this).data("selector"));
    selectedElements.css("background","#FF0000");
   $(selectedElements ).click(function(){
        $(this).css("background","#00FF00");
   })
})​ 
```

HTML 示例：

```
<img class="actionbuttons" src="/" data-selector=".test1"/>
<div class="test1"></div>
<div class="test1"></div>
<div class="test1"></div>
<img class="actionbuttons" src="/" data-selector=".test2"/>

<div class="test2"></div>
<div class="test2"></div>
​ 
```

[http://jsfiddle.net/Ft7SB/](http://jsfiddle.net/Ft7SB/)

# java - 用于基于 Java 的 Web 应用程序的 NLP 库（主题提取+情感分析）

> ID：10419437
> 
> 赞同：4
> 
> 时间：2012-05-02T18:19:21.003
> 
> 标签：java, nlp, sentiment-analysis

我是一名大学生，正在寻找一个 NLP 库来在基于 Java 的 Web 应用程序中执行主题提取和情感分析，以用于暑期爱好项目。

为了让您了解我正在尝试做的事情......我想构建一个基于 Java 的 Web 应用程序，该应用程序将从 Reddit 提交的标题中提取主题，并确定 OP 对标题的情绪（当可能的）。

示例输入：

*   Reddit，我们将反 SOPA 请愿书从 943,702 个签名增加到 3,460,313 个。反 CISPA 的请愿书为 691,768，比 SOPA 更糟糕。请顶一下，让我们讨论进一步的措施，否则我们过去的努力是徒劳的。我们以前做过，恐怕我们被要求再做一次。
*   我的朋友称他为“可笑的上镜先生”
*   精神错乱：CISPA 变得更糟，然后通过匆忙投票

我目前正在尝试 AlchemyAPI，但听起来那里存在更好的 NLP 库。最好，我不会被限制在给定时间段内有限数量的 API 请求（AlchemyAPI 有配额）。我听说过 GATE、LingPipe 和 OpenNLP 的名称——但是，我不确定它们是否符合我的需要。

我正在寻找来自有经验的用户的框架/库/api 建议，甚至更好的比较。我在 NLP 方面的经验非常有限，这就是我在这里寻求帮助的原因（ps：如果有人有任何资源可以在 www.nlp-class.org 之外了解更多信息，请告诉我！）:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T20:58:50.657

首先，我强烈推荐使用 python，因为 NLP 库比 java 更易于使用，而且维护一个人的项目的代码要少得多。

我想不出任何可以做任何分类的事情，所以我的建议是训练两个分类器，一个用于主题，一个用于情感。您必须标记数据并定义特征，但我认为这不会太难，尤其是在建立“情感”词词典的情感方面。标记数据是一件令人头疼的事情，但良好的特征是您获得良好分类的方式。

**主题分类器：**

将 NLTK 与朴素贝叶斯分类器一起使用，并将特征定义为单词（小写）、单词二元组和三元组。

**情绪分类器：**

与主题分类器相同的特征，但也有一个特征，即单词 w 在情感词典中，连接为 c。所以，“坏”这个词的意思是“坏情绪”。

一旦你积累了足够的训练/测试数据，你就可以训练你的分类器并在必要时优化特征，然后你可以根据你想要的任何其他数据运行分类器。

通用库（Java）：

*   开放式自然语言处理
*   灵管
*   维卡
*   斯坦福的东西

库（Python）：

*   NLTK
*   西皮

# java - 正在寻找适用于 Windows DirectSound/WASAPI/ 的 Java 包装器？声音的

> ID：10419452
> 
> 赞同：3
> 
> 时间：2012-05-02T18:20:13.053
> 
> 标签：java, audio, java-native-interface, javasound

在花了相当多的时间尝试围绕现有的 javax.sound.sampled 库设计我的方式以进行简单（但相对时间准确）的音频捕获/渲染之后，我得出的结论是我真的需要获得原生音频API。我发现的问题是我需要能够以 20 或 50 毫秒的增量获取声音的帧位置（我通过写入 SourceDataLine 来渲染），精确到 1 或 2 毫秒。换句话说，我想将一些图形事件同步到正在播放的音频，视频帧速率为 20 到 50 fps，抖动不超过 1 或 2 毫秒。JavaSound 的实现似乎离硬件太远了（为平台独立性付出的代价？）。经过对 SDL/TDL 缓冲区大小、音频格式、SDL 大小的大量“修补”。

[进一步澄清：我可以让图形渲染基于系统时钟以固定速率运行，这对于我的需要来说足够准确。但是，如果要与音轨同步，则在典型的音轨（例如 5 分钟长）接近尾声时，即使很小的时间差异也会累积到音频和图形之间的明显时间差异。我想每秒钟（或 2 或 5 次）检查一次同步，但是报告的音频帧位置的“抖动”会导致更正，然后会很明显。]

我一直在研究哪些库可能已经可用。似乎许多现有的软件包都是为了支持游戏开发社区。但是，我不需要 3D 音频、效果的硬件加速、合成、处理——只是一种以一致的延迟读取正在听到的内容的帧位置的方法。如果延迟高达 100 毫秒，但保持一致，我可以围绕它进行设计。

对于提供这种功能的 Java 库，我将不胜感激。我认为它将是本机音频 API 的 JNI 包装器。我现在只需要支持Windows7。我见过 OpenAL（似乎是 Creative 支持音频硬件加速的“开放”方式，因为现在在 Vista 中不再支持 - 面向游戏并且超出了我的需要），JSyn（专注于合成，MIDI，而不是简单的采样接口）和 JAsioHost（迄今为止最有希望）。

如果有办法绕过我在 JavaSound API 中注意到的限制，那也很好，但经过一周的努力，我几乎放弃了。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-04-01T02:44:33.247

我还没有尝试过其中任何一个，但可能值得研究：

*   [http://xt-audio.com](http://xt-audio.com)

*   Jitsi 已经做了一些工作来[包装 WASAPI](https://github.com/jitsi/libjitsi/blob/master/src/org/jitsi/impl/neomedia/jmfext/media/protocol/wasapi/WASAPI.java)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T00:41:45.860

我想没有这样的库......但你想要完成的任务实际上并不难：

您需要将您的应用程序与音频帧同步......这意味着音频是时间的主要权威。您可以创建一个新的计时器，该计时器将定期发布声音块进行播放，并发出正在播放块 xy 的事件。

您需要以与实时相同的速率提供块......这意味着在一秒钟内发布一秒钟的样本。

播放本身可以通过 Windows 中的 WaveOut 函数来完成（[链接在这里](http://msdn.microsoft.com/en-us/library/windows/desktop/dd743866%28v=vs.85%29.aspx)，您可以搜索教程）。您可以使用 JNI 从 Java 访问这些函数。WaveOut 以 Wav 格式播放声音，这意味着您可以使用简单的 LPC 调制打开设备并发布原始样本。

整个事情不会完全同步，但延迟不会很大。注意waveOutWrite 的缓冲区下溢，您需要在最后一个块完成播放之前提供新块，否则声音会失真。

# javascript - 如何防止 jQuery $.ajax 在请求中的查询字符串中添加前导 & 符号？

> ID：10419456
> 
> 赞同：0
> 
> 时间：2012-05-02T18:20:38.113
> 
> 标签：javascript, jquery, url

我试图避免在服务器上处理这个编码不正确的请求。我有一个像这样的单个参数的请求：

```
$.ajax({
    url: "http://someplace.ontheinternets/count?",
    data: {
        days_since_epoch: 15460
    },
    dataType: "json",
    success: function(data) {
        // Do something with data
    }
}); 
```

这给了我：[http://someplace.ontheinternets/count?&days_since_epoch=15460](http://someplace.ontheinternets/count?&days_since_epoch=15460)

领先的＆符号在另一端给我带来了问题（解释为两个参数，第一个为空）。似乎很容易解决，但我在相关问题中没有看到这个特定问题。任何的意见都将会有帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-02T18:21:52.033

不要把`?`它放在你的`url`参数中。既然你有它，jQuery 认为 URL 已经有其他参数，所以添加你要求它添加的参数，使用`&`. 如果您`?`从参数末尾删除`url`，jQuery 不会被愚弄，并且会（对于单个参数）只使用`?`.

# android - 在 Android 上停止线程

> ID：10419460
> 
> 赞同：0
> 
> 时间：2012-05-02T18:20:58.150
> 
> 标签：android

我有这个用于更改屏幕颜色的代码。

但我不知道如何停止这个线程：

```
lin = (LinearLayout)findViewById(R.id.mainlayout);
        new Thread(new Runnable() {
            public void run() {
                while (finalStatus < 1) {
                    try {
                        Thread.sleep(500);
                    } catch (InterruptedException e) {
                        e.printStackTrace();
                    }
                    colorHandler.post(new Runnable() {
                        public void run() {
                            if(flag)
                            {
                             lin.setBackgroundColor(Color.BLUE);
                             flag = false;
                            }
                            else
                            {
                                lin.setBackgroundColor(Color.RED);
                                 flag = true;
                            }
                        }
                    });
                }
            }
        }).start(); 
```

我试着说：

```
Button btn = (Button) findViewById(R.id.button1);
        btn.setOnClickListener(new View.OnClickListener()
        {
            public void onClick(View v)
            {
                Toast.makeText(getBaseContext(),"STOP",Toast.LENGTH_SHORT).show();
                finalStatus=1;
                lin.setBackgroundColor(Color.BLACK);
            }
        }); 
```

线程停止了，但屏幕是红色或蓝色，我需要黑色。

此外，我停止后如何启动这个线程？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T18:38:01.207

我不确定获得蓝色或红色背景的情况是什么，但我们假设它是在您将 finalStatus 设置为 1 时。为了避免更改背景并仍然退出线程，您可以在按钮中将其设置为不同的值单击侦听器，比如说111。在colorHandler.post之前添加以下条件将解决问题：

```
if (finalStatus == 111) {
    return;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T18:56:25.760

只需将该`lin.setBackgroundColor(Color.BLACK);`代码放在外线程 run() 方法中的 While 循环之后。并且不要忘记使用相同的处理程序，因为除了 UI 线程不会更新 UI。

# java - 从列表中过滤元素

> ID：10419461
> 
> 赞同：1
> 
> 时间：2012-05-02T18:20:58.690
> 
> 标签：java, list

假设您要从列表中过滤元素。运行此代码会触发类似并发异常的情况，因为在循环期间正在修改列表：

```
List<String> aList = new ArrayList<String>();

// Add instances to list here ...

for( String s : aList ){
    if( "apple".equals( s ) ){ // Criteria
        aList.remove(s);
    }
} 
```

执行此操作的常规方法是什么，您还知道哪些其他方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T18:22:13.850

最好的方法是使用 iterator.remove()

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T18:27:29.107

对于您的情况，您可以简单地使用解决方案而无需手动完成任何迭代（removeAll 会处理此问题）：

```
aList.removeAll("apple"); 
```

它从列表中删除所有“苹果”元素。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-02T18:29:42.913

如果您正在迭代或拥有一组简单元素，请同意上述两个。如果您的条件或对象涉及更多，请考虑 Apache Commons CollectionUtils 的过滤器方法，它允许您定义一个封装您的条件的谓词，然后将其应用于集合的每个元素。给定您的集合 aList 和谓词 applePredicate，调用方法将是：

org.apache.commons.collections.CollectionUtils.filter(aList, applePredicate);

[http://commons.apache.org/collections/apidocs/org/apache/commons/collections/CollectionUtils.html#filter(java.util.Collection](http://commons.apache.org/collections/apidocs/org/apache/commons/collections/CollectionUtils.html#filter(java.util.Collection) , org.apache.commons.collections.Predicate)

# ruby-on-rails-3 - 努力理解这个块是如何工作的

> ID：10419468
> 
> 赞同：0
> 
> 时间：2012-05-02T18:21:18.690
> 
> 标签：ruby-on-rails-3, testing, factory-bot

我正在查看 rails 中的工厂，并且在我对这段代码的理解中遇到了问题：

```
Factory.define :user do |f|
  f.username "foo"
  f.password "foobar"
  f.password_confirmation { |u| u.password }
end 
```

我了解一切的机制，除了

```
f.password_confirmation { |u| u.password } 
```

在我使用“foobar”作为自定义密码的情况下，这怎么知道将“foobar”分配给 f.password_confirmation。或者换句话说，“你”指的是什么。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T20:13:28.710

这种情况下的“u”实际上代表了一个“Evaluator”类，它是 factory_girl 使用的内部代理。它是一个动态定义的类，它响应您在工厂中定义的属性的方法。

Evaluator 允许您访问先前定义的属性值，如果属性乱序，它将生成、缓存并返回正确的值。例如，由于 Evaluator 的工作方式，交换“password”和“password_confirmation”的顺序仍然有效。

您可以在此处查看 Evaluator 的工作原理：[https ://github.com/thoughtbot/factory_girl/blob/master/lib/factory_girl/evaluator.rb](https://github.com/thoughtbot/factory_girl/blob/master/lib/factory_girl/evaluator.rb)

在定义工厂时，您大多不需要担心 Evaluator。您通常可以在那里“u”，就像它是用户的实例一样，因为它会将缺少的方法委托给它正在构建的实例。

# java - 移除容器中的项目

> ID：10419472
> 
> 赞同：3
> 
> 时间：2012-05-02T18:21:40.130
> 
> 标签：java, eclipse, components, containers

当我尝试从容器中删除组件时，我使用此代码。

```
private static void clear(){
    for (int i = con.getComponentCount() - 1; i >= 1; i--){
        con.remove(i);
    }
} 
```

当我调用这个函数时，这个函数就好像它什么也没做，但它就像它的重载一样崩溃。它没有错误。但是当我`con.getComponent(i).setVisible(false);`输入代码时它可以工作，但我想删除组件。哈普？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T18:24:50.373

尝试使用这个：

```
while (con.getComponentCount()>0) {
    con.remove(0);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-02T18:24:56.453

完成删除要删除的组件后，调用 Container.validate(); Container.repaint(); 实际上，您可能想要重新验证更多内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-02T18:26:04.570

删除组件后您是否尝试过 containerObject.repaint() ？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-02T18:31:03.080

假设 con 是一个 awt 容器，你可以调用

```
con.removeAll(); 
```

一次删除所有包含的组件。

# php - 在 PHP 中获取顶部框架（浏览器中的地址栏）URL？

> ID：10419473
> 
> 赞同：1
> 
> 时间：2012-05-02T18:21:45.053
> 
> 标签：php, javascript, url, frame

对不起，我的英语不太好……我需要一个简单的 PHP 程序的帮助：如果页面的 URL 包含特定的单词，则显示内容。如果没有，则整个页面重定向。我会用它来防止我使用其他网站管理员制作的框架来“窃取”我的网站内容。这没关系。但是我的一个朋友需要制作一个特定单词的黑名单，而不是白名单。因此，如果 URL 包含一个单词，则整个页面都会重定向。我尝试使用 *$_SERVER['HTTP_REFERER']* 但如果“小偷”将框架放在不在黑名单中的外部网站上，并且在他制作框架的框架后，会显示内容并且页面不会'不重定向..所以我认为是这样的： *$_SERVER['HTTP_REFERER']* 只能读取第一级框架而不是主页（顶部框架）。

如果不可能，是否有一种方法可以将 JS 变量值传递给我的情况下的 PHP 变量？

先感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T18:31:19.153

只有当且仅当顶级域与您的域相同时，javascript 才有可能做到这一点。如果是这种情况，您可以对服务器进行 ajax 调用，传递 url，然后服务器可以确定是否重定向。

我更倾向于说服您反对这种方法，而不是展示代码的样子。如果您有不想让别人窃取的内容，您应该将您的网站设为非公开（即用户必须登录）。如果这不可能，那么您担心的内容听起来不应该出现在互联网上。

# jquery - 通过 AJAX 按住按钮打开 PDF 文件

> ID：10419477
> 
> 赞同：1
> 
> 时间：2012-05-02T18:22:09.110
> 
> 标签：jquery, ajax, pdf, dojo

你能帮我解决以下问题吗？

我有一个表单，您可以在其中选择参数以生成 PDF 报告，该报告将由浏览器打开的 Struts 1.x 操作返回。这在系统中完美地同步工作。

但是我需要保护系统免受用户的影响是请求报告而没有一直做，只在生成报告后才启用按钮。

我的选择是在生成此报告的 AJAX（异步调用）中创建一个函数，虽然此过程没有回复我，但我隐藏了按钮并显示“正在加载”，返回按钮也显示并隐藏了“加载”。

但是我在两个不同的试验中遇到了问题：

在第一次尝试（代码 1）中，按钮的 jQuery 行为和加载是预期的，但我返回以下函数（数据）的 PDF 文件未在浏览器下载窗口中打开：

```
...
success: function (data) {
    WinID var = window.open ('', 'newwin', 'width = 400, height = 500');
    WinId.document.open ();
    WinId.document.write (data);
    WinId.document.close ();
... 
```

在使用 Dojo 的第二次尝试（代码 2）中，预期会返回 PDF 文件，但是当浏览器的下载窗口打开时会失去控制，以便再次启用按钮并禁用图像加载。

有什么方法可以使用 jQuery 或 Dojo 打开这个 PDF 文件来控制我的 DIV？

谢谢，

HTML 片段：

```
...
<tr>
    <td colspan="3" align="center" valign="middle">
        <div id="button">
            <a href="javascript:execute();"> 
                <img src="images/btnExecute.png" alt="Execute" border="0" class="inputImage" /> 
            </a>
        </div>
        <div id="loadingImage">
            <img src='images/loading.gif' style="{align:right;}" />
        </div>
    </td>
</tr>
... 
```

代码 1 (jQuery):

```
function execute()
{
    $.ajax({
        type:"GET",
        url: "generateReport.do",
        data: "action=print&param1=param1",
        dataType: "html",
        beforeSend : function() {
            //It works
            $('#button').hide();
            $('#loadingImage').show();
        },
        complete : function() {
            $('#button').show();
            $('#loadingImage').hide();
        },
        success : function(data) {
            var WinId = window.open('', 'newwin', 'width=400,height=500');
            WinId.document.open();
            WinId.document.write(data);
            WinId.document.close(); 
        }
    }); 
} 
```

代码 2（道场）：

```
function execute()
{   
    //It works
    $('#button').hide();
    $('#loadingImage').show();

    var url = "generateReport.do?action=print&param1=param1";             

    require(["dojo/io/iframe"], function(ioIframe){
        ioIframe.send({
            url: url,
            handleAs: "html"
        }).then(function(data){
            //It only works when my page returns the html message "Empty report"
            $('#button').show();
            $('#loadingImage').hide();
        }, function(err){
        });
    }); 
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T00:27:42.237

您**不能使用****二进制 PDF**设置 HTML 文档内容。您的 generateReport.do 返回的是什么，我怀疑它的 .pdf 附件？

您需要做的是让 generateReport.do 使用 pdf 的内容制作一个临时文件 - 然后返回其 URL。获得 URL 后，将其放在 window.open 的位置。

1.  调用 generateReport.do
2.  函数（数据）在“数据”中保存“http://mydomain.tld/cached_contents/234kj82341.pdf”
3.  函数（数据）调用window.open（数据，window_open_parameters）；

这将使任一浏览器都提供 PDF 插件并适当地查看。我们不能通过 javascript / dom 执行此操作。

或者，找到一个 flash 插件或类似的插件，然后在你的 window.document.write 中，放一个`<object src="my_pdf_plugin" ...></object>`

```
function execute()
{   
    // this is Not dojo, it looks like jQuery, see below onload function
    $('#button').hide();
    $('#loadingImage').show();

    var url = "generateReport.do?action=print&param1=param1";             

    require(["dojo/io/iframe"], function(ioIframe){
        ioIframe.send({
            url: url, 
```

请参阅您的测试用例中的 handleAs: [http://dojotoolkit.org/reference-guide/1.7/dojo/io/iframe.html](http://dojotoolkit.org/reference-guide/1.7/dojo/io/iframe.html) （使用 handleAs:html），如果返回的数据不是内容类型的 text/html，它将被丢弃- 在尝试将 text/plain 转换为实际的 html 文档之后

```
 handleAs: "text"
        }).then(function(data){
            //It only works when my page returns the html message "Empty report"
            $('#button').show();
            $('#loadingImage').hide();
        }, function(err){
        });
    }); 
}

dojo.addOnLoad(function() {

// this will create a disabled dojo button
require(["dijit/form/Button"], function(dijitButton) {
  var domNode = dojo.byId('button');
  var btn = new dijitButton({
     diabled: true,
     id: 'PDFBUTTON',
     label: domNode.innerHTML // default behavior even so, for show here
  }, domNode);

  // showcase:
  var enabled = true;
  dijit.byId('PDFBUTTON').set("disabled", !enabled);

});

} 
```

# model-view-controller - 需要模型视图建议

> ID：10419480
> 
> 赞同：0
> 
> 时间：2012-05-02T18:22:25.430
> 
> 标签：model-view-controller, ios5, xcode4.2

我在这个问题上停留了很长时间，只是无法理解这个概念。我无法在我的应用程序的第一页之外保留任何数据，每次我推送到另一个视图时，我都会丢失在文本字段中输入的所有数据或导入的任何图片。这意味着我已经在第一页上做了所有事情，因为这是唯一在我离开它后立即破坏数据的页面。当然必须有一种更简单的方法来做到这一点......有人可以指出一个真正的模型视图初学者指南，我阅读了苹果的文档，发现它根本没有帮助，我在这里阅读，并用谷歌搜索，现在真的没有想法了

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T21:08:35.293

您将数据存储在“控制器”级别。就像“视图”级别一样，这些来来去去并不是长期存储数据的好地方。对于长期存储，您希望将数据保存在“模型”中。你可以这样想三层。

*   模型是数据（可变的和永久的）和业务规则。
*   控制器是业务规则、视图到模型的数据解释以及用户交互管理。
*   视图用于将数据输出转换为有意义的信息和用户响应解释。

控制器（视图控制器）应该只保存足够的数据来完成他们的工作，并且永远不应该认为保存数据的时间超过了必要的时间。这就是为什么原始视图控制器是唯一保留数据的控制器。它是“根”视图控制器，不会被移除，因为它是底部视图控制器。当您“推送”另一个视图控制器时，它是暂时的，因为它将被“弹出”并释放。考虑将您的数据（即使对于您的根视图控制器）保存在您可以访问它的其他地方。可能在 App Delegate、Core Data 或简单管理所需数据的自定义类中。确保您的模型和控制器对象可以获取数据，并且您将拥有一致的数据。

# ios - 在另一个 UIImageView 完成后使 UIImageView 动画

> ID：10419482
> 
> 赞同：0
> 
> 时间：2012-05-02T18:22:39.750
> 
> 标签：ios, core-animation, cabasicanimation

我正在尝试动画处理纸牌。目前我有两张牌，庄家牌（dCard1）和玩家牌（pCard1）。

应该发玩家牌，一旦发牌，就应该发发庄家牌。

当前发生的情况是，当我按下发牌按钮时，玩家卡会正确动画，但不是等到玩家卡完成动画，而是庄家卡只出现在dealerTo 位置。它没有动画。我是做动画的新手，任何帮助将不胜感激。

```
-(void) animateHandsDealt: (Hand*) pHand:(Hand*) dHand{
pCard1= [[UIImageView alloc] initWithFrame:CGRectMake(125, 0, 75, 110)];
dCard1= [[UIImageView alloc] initWithFrame:CGRectMake(125, 0, 75, 110)];

CGFloat start = 0;
CGFloat duration = 1;

CGPoint playerTo = CGPointMake(120, 300);
CGPoint dealerTo = CGPointMake(120, 70);

pCard1.image = [UIImage imageNamed:[[pHand.cardArr objectAtIndex:0 ] imagePath]];
[self.view addSubview: pCard1];
[playerImages addObject:pCard1];

CABasicAnimation *move = [CABasicAnimation animationWithKeyPath:@"position" ];
move.fillMode = kCAFillModeBoth;
move.beginTime = start;
[move setToValue:[NSValue valueWithCGPoint:playerTo]];
[move setDuration:duration];
move.removedOnCompletion = FALSE;
[[pCard1 layer] addAnimation:move forKey:@"position"];

dCard1.image = [UIImage imageNamed:@"back-red-75-1.png"];
[self.view addSubview: dCard1];
CABasicAnimation *move2 = [CABasicAnimation animationWithKeyPath:@"position" ];
[move2 setToValue:[NSValue valueWithCGPoint:dealerTo]];
move2.beginTime = start + duration;
[move2 setDuration:duration];
move2.fillMode = kCAFillModeBoth;
move2.removedOnCompletion = FALSE;
[[dCard1 layer] addAnimation:move2 forKey:@"position"]; 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T18:27:53.103

如果您只是为视图的框架设置动画，则可以使用更简单的 UIView animateWithDuration... 方法。

您可以使用 animateWithDuration:animations:completion: 版本链接它们。您可以在第一个动画的completion: 块中指定第二个动画。

[http://developer.apple.com/library/ios/#documentation/uikit/reference/uiview_class/UIView/UIView.html#//apple_ref/doc/uid/TP40006816-CH3-SW109](http://developer.apple.com/library/ios/#documentation/uikit/reference/uiview_class/UIView/UIView.html#//apple_ref/doc/uid/TP40006816-CH3-SW109)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T19:23:26.680

我无权访问您的课程（当然），但我认为这非常接近“即插即用”代码。你怎么看？

```
- (void)deal {
    // Of course, you'd replace these NSString objects with actual card objects...
    NSArray *array = [NSArray arrayWithObjects:@"pCard1", @"dCard1", @"pCard2", @"dCard2", @"pCard3", @"dCard3", nil];
    [self performSelectorOnMainThread:@selector(animateDealWithArray:) withObject:array waitUntilDone:YES];
}
- (void)animateDealWithArray:(NSArray *)array {
    // constants that won't change call to call
    static CGFloat duration = 1;
    static CGSize  cardSize = {75,  110};
    static CGPoint playerTo = {120, 300};
    static CGPoint dealerTo = {120, 70};

    // Seems like you want the card to start at the top of the "deck" whether it's a player card or not
    UIImageView *card = [[UIImageView alloc] initWithFrame:CGRectMake(125, 0, 75, 110)];
    // Figure out if the first object (the one we're currently using) is a player or dealer card
    if ([[array objectAtIndex:0] isKindOfClass:[PlayerCard Class]]) {
        // Player card, so show the "face"
        [card setImage:[UIImage imageNamed:[(PlayerCard *)[array objectAtIndex:0] imagePath]]];
        [UIView animateWithDuration:duration
                         animations:^{
                             [card setFrame:CGRectMake(playerTo.x, playerTo.y, cardSize.width, cardSize.height)];
                         }
                         completion:^(BOOL finished) {
                             [self dealNext:array];
                         }
         ];
    } else {
        // Dealer card, so show the back
        [card setImage:[UIImage imageNamed:@"back-red-75-1.png"]];
        [UIView animateWithDuration:duration
                         animations:^{
                             [card setFrame:CGRectMake(dealerTo.x, dealerTo.y, cardSize.width, cardSize.height)];
                         }
                         completion:^(BOOL finished) {
                             [self dealNext:array];
                         }
         ];
    }
}
- (void)dealNext:(NSArray *)array {
    int count = [array count];
    if (count > 1) {
        NSArray *newArray = [array subarrayWithRange:NSMakeRange(1, count - 1)];
        [self animateDealWithArray:newArray];
    }
} 
```

# css - 在 div 中平均分配 ul 列表

> ID：10419487
> 
> 赞同：0
> 
> 时间：2012-05-02T18:22:51.727
> 
> 标签：css

我似乎无法弄清楚为什么会这样：

```
#inside-footer {
    display: inline-block;
    margin-left: auto;
    margin-right: auto;
    font-size: 85%;
}
#inside-footer ul.footer_nav {
    text-align: left;
    float: left;
    margin: 20px 10px;
    position: relative;
    width: 164px;
}

<div id="inside-footer">
      <ul class="footer_nav">
        <h4>Zeigeist</h4>
        <li>
          <a href="/;about">About</a>
        </li>
        <li>
          <a href="/blog">Blog</a>
        </li>
        <li>
          <a href="/;contact">Contact &amp; Support</a>
        </li>
        <li>
          <a href="/training">Training</a>
        </li>
        <li>
          <a href="#">Site Status</a>
        </li>
      </ul>
      <ul class="footer_nav">
        <h4>Tools</h4>
        <li>
          <a href="/;create">Chapter Generator</a>
        </li>
        <li>
          <a href="#">Activies Board</a>
        </li>
      </ul>
      <ul class="footer_nav">
        <h4>Documentation</h4>
        <li>
          <a href="#">Chapter Sites</a>
        </li>
        <li>
          <a href="#">Developers</a>
        </li>
      </ul>
      <ul class="footer_nav">
        <h4>External Links</h4>
        <li>
          <a href="#">News</a>
        </li>
        <li>
          <a href="#">Media</a>
        </li>
      </ul>    <!-- /upper-footer-->
  </div><!-- /inside-footer -->​ 
```

但在我的网站[http://zmgc.net/](http://zmgc.net/)上，列表项是交叉的，而不是在标题标签下。

我想像[http://jsfiddle.net/ypr8g/13/](http://jsfiddle.net/ypr8g/13/)一样显示它，但在 yui3-u-19-24 div 中平均分布，我也许可以将它与另一个 yui3-g 分开并将每个放在 yui3 中-u-1-4 div 但似乎不对！

我错过了什么？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T18:27:46.223

在你拥有`#inside-footer li { float: left; margin-top: 5px; padding: 0; }`它的地方需要取出浮动，因为这会并排显示 li，将其更改为`#inside-footer li { margin-top: 5px; padding: 0; }`它会根据你的需要显示，即在标题标签下方。

# c - 复制 glibc 库

> ID：10419489
> 
> 赞同：4
> 
> 时间：2012-05-02T18:22:56.317
> 
> 标签：c, linux, gcc, x86-64, glibc

我下载了 glibc 源代码，修改了标准库的某些部分，然后`LD_PRELOAD`将修改后的标准库（以 .so 文件的形式）用于我的程序。但是，当我将该文件复制`.so`到另一台计算机并尝试在那里运行相同的程序`LD_PRELOAD`时，我遇到了分段错误。

请注意，两台计算机都有 x86-64 处理器。此外，两台计算机都安装了 gcc 4.4。虽然没有运行它的计算机除了 gcc 4.4 之外还安装了 gcc 4.1.2。但是，一个运行的是 Ubuntu 10.04（我在其中编译），而另一个运行的是 CentOS 5。这是分段错误的原因吗？我怎么解决这个问题？请注意，我在装有 CentOS 5 的计算机上没有管理权限。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T18:05:50.423

当您 LD_PRELOAD C 库时，我相信您除了加载默认 C 库之外还加载了它。当它们是完全相同的版本时，所有符号都匹配，并且您的符号优先。所以它有效。当它们是不同的版本时，您可能会在每个符号的基础上混合使用。

此外，NSS（名称服务开关，例如 /etc/nsswitch.conf 中的所有内容）API*也不稳定*。这些模块与主 libc.so 是分开的，但在程序（例如，执行用户 ID 到用户名映射）时会动态加载。加载错误的版本（因为你复制了 libc.so ）会做各种各样的坏事。

此外，Ubuntu 可能正在使用 eglibc 和 CentOS glibc。因此，您可能正在查看 glibc 的不同分支。

如果您的 LD_PRELOAD 库*仅*包含您实际需要覆盖的符号，并将它们覆盖到可能的最小数量（例如，如果可能，调用被覆盖的函数），那么您的库具有*更高*的可移植性。

有关如何执行此操作的示例，请参阅（例如）[fakeroot](http://fakeroot.alioth.debian.org/)。

如果你对 libc 进行了如此多的更改，以至于你唯一的选择就是覆盖所有它，那么（a）你正在做一些非常奇怪的事情；(b) 你可能想使用`LD_LIBRARY_PATH`，而不是`LD_PRELOAD`；有关详细信息，请参见[ld.so(8) 联机帮助页](http://manpages.ubuntu.com/manpages/precise/man8/ld.so.8.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T18:47:59.707

您的 libc 可能无法在内核版本之间移植。

# javascript - Javascript 日志记录

> ID：10419493
> 
> 赞同：9
> 
> 时间：2012-05-02T18:23:11.560
> 
> 标签：javascript, logging, client-side

这是一个菜鸟问题。

如果我想将日志记录添加到在浏览器（IE、FF 等）中运行的 java 脚本应用程序中怎么办？据我了解，我无法在客户端主机中保存日志文件。所以，我只有两个选择：在新的浏览器窗口（如“blackbird”）中显示我的日志记录信息或将日志记录发送到服务器。

这是正确的吗？他们通常使用什么样的日志记录？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-02T18:27:27.893

您不能在客户端主机上“存储”日志文件。您可以打开一个窗口并将其可视化，但**您**（假设您正在运行 Web 应用程序）将永远看不到它。

如果您绝对**必须**获取客户端日志，则需要使用 AJAX 将它们发送回服务器。这是我非常喜欢[的一篇博客文章。](http://openmymind.net/2012/4/4/You-Really-Should-Log-Client-Side-Error/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-01T09:26:37.503

另一种可能性是 jsnlog 库[http://js.jsnlog.com/](http://js.jsnlog.com/) 它可以让您将客户端日志发送到服务器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-02T06:09:20.817

看看[https://log4sure.com](https://log4sure.com)（披露：我创建了它） - 但它真的很有用，检查一下并自己决定。它允许您记录错误/事件，还允许您创建自定义日志表。它将所有内容存储在自己的服务器上，因此您不必这样做。它还允许您实时监控日志。最好的部分，它是免费的。

也可以使用 bower 安装，使用 bower install log4sure

设置代码也很简单：

```
// setup
var _logServer;

(function() {
  var ls = document.createElement('script');
  ls.type = 'text/javascript';
  ls.async = true;
  ls.src = 'https://log4sure.com/ScriptsExt/log4sure.min.js';
  var s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(ls, s);
  ls.onload = function() {
    // use your token here.
    _logServer = new LogServer("use-your-token-here");
  };
})();

//  example for logging text
_logServer.logText("your log message goes here.")

//example for logging error 
divide = function(numerator, divisor) {
    try {
      if (parseFloat(value) && parseFloat(divisor)) {
        throw new TypeError("Invalid input", "myfile.js", 12, {
          value: value,
          divisor: divisor
        });
      } else {
        if (divisor == 0) {
          throw new RangeError("Divide by 0", "myfile.js", 15, {
            value: value,
            divisor: divisor
          });
        }
      }
    } catch (e) {
      _logServer.logError(e.name, e.message, e.stack);

    }
  }
  // another use of logError in window.onerror
  // must be careful with window.onerror as you might be overwriting some one else's window.onerror functionality
  // also someone else can overwrite window.onerror.
window.onerror = function(msg, url, line, column, err) {
  // may want to check if url belongs to your javascript file
  var data = {
    url: url,
    line: line,
    column: column,

  }
  _logServer.logError(err.name, err.message, err.stack, data);

};

// example for custom logs
var foo = "some variable value";
var bar = "another variable value";
var flag = "false";
var temp = "yet another variable value";

_logServer.log(foo, bar, flag, temp);
```

# facebook - 来自 Facebook 事件的 Json 解析

> ID：10419494
> 
> 赞同：1
> 
> 时间：2012-05-02T18:23:21.503
> 
> 标签：facebook, json, facebook-graph-api, appcelerator, appcelerator-mobile

我在从 facebook 上的组事件中获取 json 并将它们放入 tableview 以在 Appcelerator 移动应用程序中使用时遇到了一些麻烦。

我们的想法是将其作为日历以简单的方式显示俱乐部的活动。

我想显示事件的名称。该事件的图片和事件的日期。

都在一个桌子上。

我已经到了可以使用以下代码获取事件名称和日期的部分：

```
Ti.UI.backgroundColor = '#dddddd';

var    access_token='AAACEdEose0cBAAICGa4tFTcZAqCOGm2w9qPYGZBwNtJ1oZAcwaMAP2DDHZCN58cvVBZCHZADZAZBTPC8tTnpfQ7uGKI5j3SbMYcRmWquZCdPzhwZDZD';

var url = "https://graph.facebook.com/64306617564/events?&access_token=" + access_token ;
var win = Ti.UI.createWindow();
var table = Ti.UI.createTableView();
var tableData = [];
var json, data, row, name, start_time, id;

var xhr = Ti.Network.createHTTPClient({
onload: function() {
// Ti.API.debug(this.responseText);

json = JSON.parse(this.responseText);
for (i = 0; i < json.data.length; i++) {
    data = json.data[i];
    row = Ti.UI.createTableViewRow({
        height:'60dp'
    });
  var  name = Ti.UI.createLabel({
        text:data.name,
        font:{
            fontSize:'18dp',
        fontWeight:'bold'
    },
    height:'auto',
    left:'50dp',
    top:'5dp',
    color:'#000',
    touchEnabled:true
    });

   var start_time = Ti.UI.createLabel({
    text:'"' + data.start_time + '"',
    font:{
        fontSize:'13dp'
    },
    height:'auto',
    left:'15dp',
    bottom:'5dp',
    color:'#000',
    touchEnabled:true
    });

    row.add(name);
    row.add(start_time);
    tableData.push(row);
    }

table.setData(tableData);
},
onerror: function(e) {
Ti.API.debug("STATUS: " + this.status);
Ti.API.debug("TEXT:   " + this.responseText);
Ti.API.debug("ERROR:  " + e.error);
alert('There was an error retrieving the remote data. Try again.');
},
timeout:5000
});

xhr.open("GET", url);
xhr.send(); 
```

但是，当我希望特定事件在单击时在新窗口中打开时，当我将其放入浏览器时，我只会得到位于屏幕最后的事件：

[https://graph.facebook.com/64306617564/events?&access_token=AAACEdEose0cBAOLAFWMKPmvgqEwap1ldnl7DeZBDKJC6YTZC4Goh6K5NHsvpOFmFQaGp1IekVsCxZCZCz3lwGpRcQG9ZBkcMrZAnLk4As8kgZDZD](https://graph.facebook.com/64306617564/events?&access_token=AAACEdEose0cBAOLAFWMKPmvgqEwap1ldnl7DeZBDKJC6YTZC4Goh6K5NHsvpOFmFQaGp1IekVsCxZCZCz3lwGpRcQG9ZBkcMrZAnLk4As8kgZDZD)

并且访问令牌过期非常快。任何想法如何制作持续时间更长的访问令牌？

好吧，我用来打开窗口的代码是：

```
table.addEventListener('click',function(e) {
        // Create the new window with the link from the post
        var blogWindow = Ti.UI.createWindow({
            title   : data.name,
            modal   : true,
            barColor: '#050505',
            backgroundColor: '#050505'              
        });
        var webView = Ti.UI.createWebView({url:'http://www.facebook.com/events/' + data.id});
        blogWindow.add(webView);

        // Create the close button to go in the left area of the navbar popup
        var close = Titanium.UI.createButton({
            title: 'Close',
            style: Titanium.UI.iPhone.SystemButtonStyle.PLAIN
        });
        blogWindow.setLeftNavButton(close);

        // Handle the close event
        close.addEventListener('click',function() {
            blogWindow.close();
        });

        blogWindow.open();
    });
win.add(table);
win.open(); 
```

在我看来，应该通过解析行中的 ID 并将其放在链接后面来打开单击的事件。

我是迟钝还是有什么问题？

我点击哪个事件并不重要，只要一直打开最后一个。

我怎样才能获得活动的缩略图？

请帮助......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-04T07:44:33.883

当您单击表格以从不可用的**数据**中获取值时。您可以使用自定义变量来实现它尝试将这行代码放在您的行创建中，在其中将行添加到数组中，即`row.data = data;`在表格单击事件中获取该对象使用它`alert(e.source.data);`并检查它。好运

# php - 将变量解析为 CI 中的构造

> ID：10419495
> 
> 赞同：0
> 
> 时间：2012-05-02T18:23:28.033
> 
> 标签：php, codeigniter, constructor

当我在codeigniter中加载模型时，有人可以告诉我是否有办法将变量解析为类构造？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T19:02:36.890

我检查了手册和[源代码](https://github.com/EllisLab/CodeIgniter/blob/develop/system/core/Loader.php)，我可以告诉你：不，你不能。模型加载器的代码如下：

```
/**
 * Model Loader
 *
 * This function lets users load and instantiate models.
 *
 * @param   string  the name of the class
 * @param   string  name for the model
 * @param   bool    database connection
 * @return  void
 */
public function model($model, $name = '', $db_conn = FALSE)
{...} 
```

您可以向模型添加带有参数的 init 方法，并在加载模型后调用它。

# javascript - 框架集和左侧导航窗格，例如

> ID：10419496
> 
> 赞同：0
> 
> 时间：2012-05-02T18:23:29.827
> 
> 标签：javascript, html, frame

如何以这样一种方式使用框架集，即有一个用于导航的左窗格，即通过单击左窗格中的链接，可以导航到中间框架中的相应页面？

我可以得到目标属性可以用来实现这一点。任何人都可以帮助我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T18:40:34.167

将页面分为两个框架：一个用于导航链接，另一个用于内容。对链接使用目标，如下所示：

```
<a href='' target='conetent_frame'></a> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T16:17:54.017

感谢 user1370510，得到了一个很好的 Html 框架教程，与其他有相同问题的人分享相同的内容：- [http://www.htmlcodetutorial.com/frames/frames_famsupp_5.html](http://www.htmlcodetutorial.com/frames/frames_famsupp_5.html)

# javascript - 全局 JSON 变量覆盖

> ID：10419497
> 
> 赞同：4
> 
> 时间：2012-05-02T18:23:42.147
> 
> 标签：javascript, json, scope

我不得不在我的项目中使用[json2.js](https://github.com/douglascrockford/JSON-js/blob/master/json2.js)，因为浏览器（IE8）JSON 对象不可用于将字符串解析为 JSON。

我浏览了 json2.js 并且对变量声明有疑问。

[JSON 全局变量在 json2.js 中声明，例如](https://github.com/douglascrockford/JSON-js/blob/master/json2.js#L162)

```
var JSON;
if(!JSON){
    JSON={};
} 
```

声明`var JSON;`对全局 JSON 对象有什么影响。我希望声明应该覆盖任何浏览器（IE8/IE7）中的全局 JSON 对象。但令我惊讶的是，当全局对象可用时，它并没有覆盖。只有变量定义/启动会覆盖全局变量？请澄清。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T18:28:12.893

var 关键字确保封闭函数中有一个变量，或者（像这里一样）在 window 中有一个变量，但它不会初始化一个。

事实上，订单并没有真正影响。

以这段代码为例：

```
a = 3;
var a;
alert(a); 
```

它警告“3”。

因此，您显示的代码中的 var 声明只是确保测试中不会出现错误，并且不会删除现有值。

记住这一点很好，因为 javascript 中的一个常见错误是在一个函数中有多个 var 声明，并且对在 var 声明之前设置的值感到惊讶。例如运行这个：

```
if (true) {
    ​a = 3;
}
// lot of code, at a different level
if (true) {
    var a;
    if (433/43==3) a=true;
    if (a) alert('should not happen');
};
​ 
```

是的，var 附加到函数，而不是块...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-02T18:36:07.463

对于每个变量**声明**（不是*初始化*！）。发生以下情况（[部分`#10.5`](http://es5.github.com/#x10.5)）：

> 8.对于代码中的每个*VariableDeclaration*和*VariableDeclarationNoIn d*，按源文本顺序执行
> 
> 1.  令*dn*为*d*中的*标识符*。
> **   让*varAlreadyDeclared*成为调用*env 的*HasBinding 具体方法并传递*dn*作为参数的结果。*   如果*varAlreadyDeclared*为**false**，则
>     1.  调用*env 的*CreateMutableBinding 具体方法，传递*dn*和*configureBindings*作为参数。
>     2.  调用*env 的*SetMutableBinding 具体方法，传递*dn*、**undefined**和*strict*作为参数。*

 *所以你看，无论何时遇到，都会测试环境中是否已经存在`var x`同名的变量。`x`如果是，则忽略它，但如果不是，则声明变量并使用`undefined`.

由于代码在全局范围内运行，因此它会测试是否`JSON`存在于全局范围内。因此，如果`JSON`已经存在，则将`var JSON;`被忽略。

* * *

关于测试/解释这种行为的一些想法：

我不知道在 JavaScript 执行的哪个时间点创建了全局对象，但我假设在评估所有其他脚本之前。这意味着，`JSON`存在并且在任何变量声明*之前*都有一个值，如果你包含两个脚本，你只能模拟它（我猜也可以是内联的，它们是在另一个之后评估的）。

尝试：

```
// script1.js
var foo = 'bar';

// script2.js
var foo;
if(!foo) {
    foo = 'baz';
}
alert(foo);

// include script2.js after script1.js 
```

结果是什么？（[骗子看这里](http://jsfiddle.net/Z8Dhs/)）。

* * *

每当您在单个脚本文件中时，所有变量声明都会被提升到顶部。所以如果你有

```
var foo = 'bar';
var foo;
if(!foo) {
    foo = 'baz';
} 
```

该脚本实际上执行为：

```
var foo;
var foo;
foo = 'bar';
if(!foo) {
    foo = 'baz';
} 
```

您实际上无法测试第二个是否会`var foo;`覆盖第一个，因为此时它还没有任何价值。所以这不是一个很好的例子来展示上面引用的行为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T18:27:55.400

它可能不适合您，但也可以将 IE8 设置为兼容模式以获取本机 JSON 对象：

```
// in your preinit page event
Response.AddHeader("X-UA-Compatible", "IE=8"); 
```

另一种选择是仅在 JSON 变量不存在时才创建它：

```
var JSON = JSON || {}; 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-02T18:26:46.020

如果您在执行该代码块时处于全局范围内，则 var JSON 会将全局 JSON 对象覆盖为未定义。

如果您在任何其他范围内（例如在函数内部），则不会有任何效果。*

# android - Facebook android：在活动之间传递 facebook 对象

> ID：10419499
> 
> 赞同：2
> 
> 时间：2012-05-02T18:23:55.490
> 
> 标签：android, facebook, facebook-android-sdk

我想制作一个应用程序，用户将使用从 facebook_android_sdk 调用 facebook login 的按钮登录一个活动，并且我想在用户登录后的第二个活动中发送一个墙帖。我想在活动之间传递 facebook 对象。我尝试了可序列化和可打包，但没有奏效！有人可以指导我吗？不管怎么说，还是要谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T18:52:11.287

保存您的令牌并通过 SharedPerferences 过期，然后在第二个活动中创建新的 Facebook 对象，设置令牌并从 SharedPreferences 过期并检查有效性。就这样！[教程](http://developers.facebook.com/docs/mobile/android/build/)和这里的示例：

```
//facebook token and expires
SharedPreferences prefs = getApplicationContext().getSharedPreferences("facebook",
            MODE_PRIVATE);
String access_token = prefs.getString("access_token", null);
long expires = prefs.getLong("access_expires", 0);
if(access_token != null) {
   facebook.setAccessToken(access_token);
}
if(expires != 0) {
   facebook.setAccessExpires(expires);
}
if (facebook.isSessionValid()) {
// Do your work here
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T18:28:56.347

我推荐你使用[easyfacebookandroidsdk](http://www.easyfacebookandroidsdk.com/)

我在我的[项目](https://play.google.com/store/apps/details?id=com.post.ticker&feature=search_result#?t=W251bGwsMSwxLDEsImNvbS5wb3N0LnRpY2tlciJd)中使用了这个 api，它更好用，也更容易使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-09T09:52:13.510

使用共享首选项在活动之间传递会话。

```
bundle.putSerializable(); 
```

Session 类实现 Serializable

# php - 使用 PHP 生成两个小数之间的随机小数

> ID：10419501
> 
> 赞同：30
> 
> 时间：2012-05-02T18:24:13.917
> 
> 标签：php, random

我需要生成一个随机数，到 PHP 中 2 位小数之间的第 10 位。

前任。介于 1.2 和 5.7 之间的兰特数。它将返回 3.4

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2012-05-02T18:27:30.553

您可以使用：

```
rand ($min*10, $max*10) / 10 
```

甚至更好：

```
mt_rand ($min*10, $max*10) / 10 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-02T18:25:44.057

您可以执行以下操作：

```
rand(12, 57) / 10 
```

PHP 的随机函数允许您只使用整数限制，但您可以将生成的随机数除以 10。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-02T18:36:53.853

更通用的解决方案是：

```
function count_decimals($x){
   return  strlen(substr(strrchr($x+"", "."), 1));
}

public function random($min, $max){
   $decimals = max(count_decimals($min), count_decimals($max));
   $factor = pow(10, $decimals);
   return rand($min*$factor, $max*$factor) / $factor;
}

$answer = random(1.2, 5.7); 
```

# objective-c - 选择器“sharedStore”没有已知的类方法

> ID：10419502
> 
> 赞同：1
> 
> 时间：2012-05-02T18:24:31.110
> 
> 标签：objective-c

有一个 BNRItemStore 的单例类，但是当我尝试调用它时，我得到了导致 ARC 问题的上述错误。已将错误注释掉。

细节视图控制器.m

```
#import "DetailViewController.h"
#import "BNRItem.h"
#import "BNRImageStore.h"
#import "BNRItemStore.h"

@implementation DetailViewController
@synthesize item;

-(id)initForNewItem:(BOOL)isNew
{
  self = [super initWithNibName:@"DetailViewController" bundle:nil];

          if(self){
            if (isNew) {
              UIBarButtonItem *doneItem = [[UIBarButtonItem alloc]
                                           initWithBarButtonSystemItem:UIBarButtonSystemItemDone 
                                           target:self 
                                           action:@selector(save:)];
              [[self navigationItem] setRightBarButtonItem:doneItem];

              UIBarButtonItem *cancelItem = [[UIBarButtonItem alloc]
                                             initWithBarButtonSystemItem:UIBarButtonSystemItemCancel 
                                             target:self 
                                             action:@selector(cancel:)];
              [[self navigationItem] setLeftBarButtonItem:cancelItem];
            }
          }
  return self;
}

-(id)initWithNibName:(NSString *)nibName bundle:(NSBundle *)bundle
{
  @throw [NSException exceptionWithName:@"Wrong initializer" 
                                 reason:@"Use initForNewItem:" 
                               userInfo:nil];
  return nil;
}

-(void)viewDidLoad
{
  [super viewDidLoad];

  UIColor *clr = nil;
  if ([[UIDevice currentDevice]userInterfaceIdiom]== UIUserInterfaceIdiomPad) {
    clr = [UIColor colorWithRed:0.875 green:0.88 blue:0.91 alpha:1];
  } else {
    clr = [UIColor groupTableViewBackgroundColor];
  }
  [[self view]setBackgroundColor:clr];
}

- (void)viewDidUnload {
  nameField = nil;
  serialNumberField = nil;
  valueField = nil;
  dateLabel = nil;
  imageView = nil;
  [super viewDidUnload];
}

-(void)viewWillAppear:(BOOL)animated
{
  [super viewWillAppear:animated];

  [nameField setText:[item itemName]];
   [serialNumberField setText:[item serialNumber]];
    [valueField setText:[NSString stringWithFormat:@"%d", [item valueInDollars]]];

  // Create a NSDateFormatter that will turn a date into a simple date string
  NSDateFormatter *dateFormatter = [[NSDateFormatter alloc]init];
  [dateFormatter setDateStyle:NSDateFormatterMediumStyle];
  [dateFormatter setTimeStyle:NSDateFormatterNoStyle];

  // Use filtered NSDate  object to set dateLabel contents
  [dateLabel setText:[dateFormatter stringFromDate:[item dateCreated]]];

  NSString *imageKey = [item imageKey]; 

  if (imageKey) {
    // Get image for image key from image store
    UIImage *imageToDisplay = [[BNRImageStore sharedStore]imageForKey:imageKey];

    // Use that image to put on the screen in imageview
    [imageView setImage:imageToDisplay];
  } else {
    // Clear the imageview
    [imageView setImage:nil];
  }
}

-(void)viewWillDisappear:(BOOL)animated
{
  [super viewWillDisappear:animated];

  // Clear first responder
 [[self view]endEditing:YES];

  // "Save" changes to item
  [item setItemName:[nameField text]];
  [item setSerialNumber:[serialNumberField text]];
   [item setValueInDollars:[[valueField text] intValue]];
}

-(BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)io
{
  if ([[UIDevice currentDevice]userInterfaceIdiom]==UIUserInterfaceIdiomPad) {
    return YES;
  } else {
    return (io==UIInterfaceOrientationPortrait);
  }
}

-(void)setItem:(BNRItem *)i
{
  item = i;
  [[self navigationItem] setTitle:[item itemName]];
}

- (IBAction)takePicture:(id)sender {

  if ([imagePickerPopover isPopoverVisible]) {
    // If the popover is already up, get rid of it
    [imagePickerPopover dismissPopoverAnimated:YES];
    imagePickerPopover = nil;
    return;
  }

  UIImagePickerController *imagePicker =
  [[UIImagePickerController alloc]init];

  // If our device has a camera, we want to take a picture, otherwise, we
  // just pick from the photo library
  if ([UIImagePickerController isSourceTypeAvailable:UIImagePickerControllerSourceTypeCamera]) {
    [imagePicker setSourceType:UIImagePickerControllerSourceTypeCamera];
  } else {
    [imagePicker setSourceType:UIImagePickerControllerSourceTypePhotoLibrary];

    // This line of code will generate a warning right now, ignore it
    [imagePicker setDelegate:self];

    //Place image picker on the screen
    // Check for iPad device before instantiating the popover controller
    if ([[UIDevice currentDevice]userInterfaceIdiom]==UIUserInterfaceIdiomPad) {
      // Create a new popover controller that will display the imagepicker
      imagePickerPopover = [[UIPopoverController alloc]initWithContentViewController:imagePicker];

      [imagePickerPopover setDelegate:self];

      // Display the popover controller; sender
      // is the camera bar button item
      [imagePickerPopover presentPopoverFromBarButtonItem:sender permittedArrowDirections:UIPopoverArrowDirectionAny animated:YES];
    } else {
      [self presentViewController:imagePicker animated:YES completion:nil];
    }

  }
}

-(void)popoverControllerDidDismissPopover:(UIPopoverController *)popoverController
{
  NSLog(@"User dismissed popover");
  imagePickerPopover = nil;
}

- (IBAction)backgroundTapped:(id)sender {
  [[self view]endEditing:YES];
}

-(void)imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *)info
{
  NSString *oldKey = [item imageKey];

  // Did the item already have an image?
  if (oldKey) {
    // Delete the old image
    [[BNRImageStore sharedStore]deleteImageForKey:oldKey];
  }

  UIImage *image = [info objectForKey:UIImagePickerControllerOriginalImage];

  // Create a CFUUID object - it knows how to create unique identifier strings
  CFUUIDRef newUniqueID = CFUUIDCreate(kCFAllocatorDefault);  

  // Create a string from unique identifier
  CFStringRef newUniqueIDString = CFUUIDCreateString(kCFAllocatorDefault, newUniqueID); // Incompatible integer to pointer conversion initializing 

  // Use that unique ID to set our item's imageKey
  NSString *key = (__bridge NSString *)newUniqueIDString;
  [item setImageKey:key];

  // Store image in the BNRImageStore with this key
  [[BNRImageStore sharedStore] setImage:image forKey:[item imageKey]];

  CFRelease(newUniqueIDString);
  CFRelease(newUniqueID);

  [imageView setImage:image];

  if ([[UIDevice currentDevice]userInterfaceIdiom]==UIUserInterfaceIdiomPad) {
    // If on the phone, the image picker is presented modally. Dismiss it.
    [self dismissViewControllerAnimated:YES completion:nil];
  } else {
    // If on the pad, the image picker is in the popover. Dismiss the popover.
    [imagePickerPopover dismissPopoverAnimated:YES];
    imagePickerPopover = nil;
  }

}

-(BOOL)textFieldShouldReturn:(UITextField *)textField
{
  [textField resignFirstResponder];
  return YES;
}

-(void)save:(id)sender
{
  [[self presentingViewController]dismissViewControllerAnimated:YES 
                                                     completion:nil];
}

-(void)cancel:(id)sender
{
  // If the user cancelled, then remove the BNRItem from the store
  [[BNRItemStore sharedStore]removeItem:item]; // No known class method for selector 'sharedStore'

  [[self presentingViewController]dismissViewControllerAnimated:YES completion:nil];
} 
```

DetailViewController.h

```
#import <UIKit/UIKit.h>

@class BNRItem;

@interface DetailViewController : UIViewController <UINavigationControllerDelegate, UIImagePickerControllerDelegate,UITextFieldDelegate, UIPopoverControllerDelegate>
{
  __weak IBOutlet UITextField *nameField;
  __weak IBOutlet UITextField *serialNumberField;
  __weak IBOutlet UITextField *valueField;
  __weak IBOutlet UILabel *dateLabel;
  __weak IBOutlet UIImageView *imageView;

  UIPopoverController *imagePickerPopover;
}
@property(nonatomic,strong)BNRItem *item;

-(id)initForNewItem:(BOOL)isNew;

- (IBAction)takePicture:(id)sender;

- (IBAction)backgroundTapped:(id)sender;
@end 
```

BNRItemStore.m

```
#import "BNRItemStore.h"
#import "BNRItem.h"

@implementation BNRItemStore

+ (BNRItemStore *)defaultStore
{
  static BNRItemStore *defaultStore = nil;
  if(!defaultStore)
    defaultStore = [[super allocWithZone:nil] init];

  return defaultStore;
}

+ (id)allocWithZone:(NSZone *)zone
{
  return [self defaultStore];
}

- (id)init 
{
  self = [super init];
  if(self) {
    allItems = [[NSMutableArray alloc] init];
  }
  return self;
}

- (void)removeItem:(BNRItem *)p
{
  [allItems removeObjectIdenticalTo:p];
}

- (NSArray *)allItems
{
  return allItems;
}

- (void)moveItemAtIndex:(int)from
                toIndex:(int)to
{
  if (from == to) {
    return;
  }
  // Get pointer to object being moved so we can re-insert it
  BNRItem *p = [allItems objectAtIndex:from];

  // Remove p from array
  [allItems removeObjectAtIndex:from];

  // Insert p in array at new location
  [allItems insertObject:p atIndex:to];
}

- (BNRItem *)createItem
{
  BNRItem *p = [BNRItem randomItem];

  [allItems addObject:p];

  return p;
}
@end 
```

BNRItemStore.h

```
#import <Foundation/Foundation.h>
@class BNRItem;

@interface BNRItemStore : NSObject
{
  NSMutableArray *allItems;
}

+ (BNRItemStore *)defaultStore;

- (void)removeItem:(BNRItem *)p;

- (NSArray *)allItems;

- (BNRItem *)createItem;

- (void)moveItemAtIndex:(int)from
                toIndex:(int)to;

@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T18:30:35.997

您正在调用错误发生`+sharedStore`的位置。`BNRItemStore`这是因为根据您发布的代码，它确实不存在。

所有其他呼叫都在使用您未提供`+sharedStore`的大概可用的电话。`BNRImageStore`我认为它存在于那个类中？:)

简而言之，改变：

```
[[BNRItemStore sharedStore]removeItem:item]; 
```

到

```
[[BNRImageStore sharedStore]removeItem:item]; 
```

# html - phonegap android中的UTF-8不可读

> ID：10419507
> 
> 赞同：5
> 
> 时间：2012-05-02T18:24:45.043
> 
> 标签：html, encoding, cordova

我正在开发我的第一个 phonegap 应用程序，一个基于 android 的简单表单应用程序。

我的问题是我所有的非拉丁字符都无法阅读。我使用 utf-8 添加了内容元标记，确保将文件保存为 utf-8，确保使用带有所需字母的字体，并将 xml:lang 添加到 decleration 中。

找不到任何其他想法，因为我是一名网络开发人员，这通常可以解决这些问题......

也许有人有任何想法？感觉就像我刚开始 Web 开发时的问题一样 :) 谢谢！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-09T22:34:28.617

只需添加元：

```
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-18T19:21:09.963

如果您使用的是 Eclipse，它是 PhoneGap Android 的默认设置，请确保您应用了 utf-8 文本文件编码。（项目 - 属性 - 资源：文本文件编码 - 其他 [UTF-8]）。

元标记也应该在您的 index.html 中

```
<head>
   <meta charset=utf-8>
   ...
</head> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-08-17T19:42:17.623

有时它发生在 Visual Studio 页面 Unicode 设置中：为此转到文件 > 高级保存选项 > 选择带有签名的 Unicode utf 8，然后单击确定。

# java - 从 PHP 中的 Java DataOutputStream 读取二进制数据时的整数格式是什么？

> ID：10419512
> 
> 赞同：4
> 
> 时间：2012-05-02T18:24:53.587
> 
> 标签：java, php, file-io

我知道这可能不是最好的主意，但我一直在尝试读取使用 Java 的 DataOutputStream 编码的 PHP 文件。

具体来说，在 Java 中我使用：

```
dataOutputStream.writeInt(number); 
```

然后在 PHP 中，我使用以下命令读取文件：

```
$data = fread($handle, 4);
$number = unpack('N', $data); 
```

奇怪的是，PHP 中唯一给出正确值的格式字符是“N”，它应该表示“无符号长整数（总是 32 位，大端字节序）”。我以为`int`在java中总是签名的？

是否有可能以这种方式可靠地读取用 Java 编码的数据？在这种情况下，整数只需要为正数。它可能还需要非常大，因此`writeShort()`是不可能的。否则我当然可以使用 XML 或 JSON 之类的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T18:36:21.923

这很好，只要你不需要额外的一点。`l`（而不是`N`） 将在大端机器上工作。

但是请注意，您可以存储的最大数字是 2,147,483,647，除非您想在 Java 端进行一些数学运算以获得正确的负整数来表示所需的无符号整数。

注意一个有符号的Java整数使用二进制补码的方法来表示一个负数，所以并不像翻转一下那么简单。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-02T18:48:07.727

[DataOutputStream.writeInt](http://docs.oracle.com/javase/1.5.0/docs/api/java/io/DataOutputStream.html#writeInt%28int%29)：

> 将一个 int 作为四个字节写入底层输出流，先是高字节。

可用于有符号整数的解包函数的格式都使用机器相关的字节顺序。我的猜测是您的机器使用与 Java 不同的字节顺序。如果这是真的，DataOutputStream + unpack 组合将不适用于任何已签名的原语。

# github - 我可以将文档上传到 github 中的问题吗？

> ID：10419518
> 
> 赞同：4
> 
> 时间：2012-05-02T18:25:22.897
> 
> 标签：github, issue-tracking

我有一个文档，我想从 github 问题中引用，但没有办法上传它。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T18:45:30.503

您目前无法将文件附加到 github 问题。

**更新**：

自 2012 年 12 月 7 日起，[可以](https://github.com/blog/1347-issue-attachments)通过拖放将图像附加到问题上。

只需将图像拖到问题的文本字段中即可。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-07-24T21:09:36.030

[ZenHub.io](http://ZenHub.io) Chrome 插件将使您能够将任何类型的文件添加到 github 问题。它存储在他们的服务器上，而不是 github.com。从他们的网站...

> GitHub 只允许你上传图片文件。ZenHub 增加了将任何类型的文件上传到问题和评论的功能，安全地传输到 Amazon S3。有了这个，您可以真正将您的工作流程提升到一个新的水平；尝试使用 GitHub 处理一切！集中式协作和透明度非常棒。

更新：

自 2015 年 3 月 11 日起，您现在可以将这些类型的文件上传到 github，无需任何扩展名或插件：PNG、GIF、JPG、DOCX、PPTX、XLSX、TXT 或 PDF

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-14T07:43:14.297

如果你有 github 的账号，那么你可以在 Github 自己的 Gist 服务中上传你的文档：[gist.github.com](http://gist.github.com)

在问题评论中添加链接后。

我想这会对你有所帮助

有关更多详细信息，请参阅此错误：[如何将文件附加到 github 问题？](https://stackoverflow.com/questions/10963205/how-to-attach-file-to-a-github-issue)

# perl - smbclient 的替代品。smbget 与 samba 服务器对话

> ID：10419521
> 
> 赞同：2
> 
> 时间：2012-05-02T18:25:25.407
> 
> 标签：perl, libcurl, wget, samba, smb

我正在寻找与 samba 服务器通信的替代客户端。具体避免使用smbclient、smbget。

perl 是否有任何模块可以做到这一点？我查看了 libcurl 包文档，但似乎它不支持 samba 实现。

欢迎任何建议。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T09:45:23.517

Linux内核可以挂载CIFS共享；SMB 的实现完全独立于 Samba。

# android - 在 Android 中是否可以在播放器时间记住它停止的位置？

> ID：10419527
> 
> 赞同：0
> 
> 时间：2012-05-02T18:25:48.757
> 
> 标签：android

在 Android 中是否可以在播放器时间记住它停止的位置？我需要在播放器中播放 mp3，当用户停止或应用程序暂停时，我需要记住当前状态，以便用户可以在再次启动该文件的同一时间再次播放。如何做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T18:40:10.847

当您希望保存头寸时调用 （例如`getCurrentPosition()`，）。将其写入持久存储（数据库、. 或其他类型的文件）。用于稍后根据需要返回该位置。`MediaPlayer``onPause()``SharedPreferences``seekTo()`

# php - 目录访问

> ID：10419528
> 
> 赞同：1
> 
> 时间：2012-05-02T18:25:54.617
> 
> 标签：php, apache, .htaccess, codeigniter

我正在使用 codeigniter 框架编写 Web 应用程序。这是文档根目录的结构

```
application
system
website 
```

我想要的是只有网站目录可以访问。这是 .htaccess 的内容

```
RewriteEngine on
RewriteBase /

RewriteCond %{REQUEST_URI} !^/website/
RewriteRule .* /website/%1 [QSA] 
```

当我在浏览器中输入网站 url 时，我被重定向到网站目录。到目前为止，一切都很好。有用。当我尝试访问网站目录中的目录时，问题就来了。我明白了

```
404 page not found 
```

怎么做才能访问网站目录下的目录？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T18:30:35.560

尝试

```
RewriteEngine on
RewriteBase /

RewriteCond $1 !^website
RewriteRule ^(.*)$ website/$1 [L] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T18:31:48.067

这是您需要的规则：

```
RewriteRule (?!^website(/.*|)$)^.*$ website%{REQUEST_URI} [L,NC] 
```

# java - 取消选择 JToggleButton 时未调用 ItemStateChanged 事件

> ID：10419529
> 
> 赞同：1
> 
> 时间：2012-05-02T18:25:56.533
> 
> 标签：java, swing, jtogglebutton, itemlistener

我在 ButtonGroup 中有几个 JToggleButton 使用 ItemListener 的 itemStateChanged 事件来检测何时选择/取消选择按钮。在我单击按钮本身以选择/取消选择它的情况下，它不起作用。我该如何解决这个问题？如果我使用 ActionListener，当调用 ActionEvent 时，Button 的选择状态（isSelected()）总是显示为 true。

```
ButtonGroup buttonGroup = new ButtonGroup();
for(int i=0;i&lt;toggleButtons.length;i++){
    buttonGroup.add(toggleButtons[i]);
}
for(int i=0;i&lt;toggleButtons.length;i++){
    final int  j=i;
    toggleButtons[i].addItemListener(new ItemListener(){
    public void itemStateChanged(ItemEvent e) {
         JToggleButton item=(JToggleButton)e.getSource();
      if(e.getStateChange()==ItemEvent.SELECTED){
          System.err.println(j+" selected!!!! "+item.getText());
      } else if(e.getStateChange()==ItemEvent.DESELECTED){
          System.err.println(j+" unselected!!!! "+item.getText());
      }
    }
    });
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T18:44:13.957

You cannot actively deselect a button in a `ButtonGroup`, you have to select another button, but when a new button is selected, the previous is deselected, and two events are triggered, one for the selected and one for the deselected item.

例如：

```
public class FrameTest extends JFrame {

    public FrameTest init() {
        ItemListener listener = new ItemListener() {
            @Override
            public void itemStateChanged(ItemEvent e) {
                ((JToggleButton)e.getSource()).setText("" + e.getStateChange());
            }
        };
        setLayout(new GridLayout(2,1));
        ButtonGroup bg = new ButtonGroup();
        // button 1
        JToggleButton jtb = new JToggleButton("Button");
        jtb.addItemListener(listener);
        bg.add(jtb);
        add(jtb);
        // button 2
        jtb = new JToggleButton("Button");
        jtb.addItemListener(listener);
        bg.add(jtb);
        add(jtb);
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        setVisible(true);
        pack();
        return this;
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                new FrameTest().init();
            }
        });
    }
} 
```

产生：

![尚未选择任何](../Images/350542dbc64c3fa4401b71a46e326292.png) ![选定的上按钮](../Images/a7e7371274e5c09609e8a0ca83d6d083.png) ![选中底部按钮](../Images/cc86b4474d251a253076534dfce67643.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-02T20:14:27.607

如果您真的想使用[ButtonGroup](http://docs.oracle.com/javase/7/docs/api/javax/swing/ButtonGroup.html)，那么您可以寻找[Darryl Burke 的 Custom(ized) ButtonGroup](http://tips4java.wordpress.com/2008/11/09/select-button-group/)

# c++ - 多行预处理器宏

> ID：10419530
> 
> 赞同：96
> 
> 时间：2012-05-02T18:25:57.503
> 
> 标签：c++, c, c-preprocessor

如何制作多行预处理器宏？我知道如何制作一行：

```
#define sqr(X) (X*X) 
```

但我需要这样的东西：

```
#define someMacro(X)
    class X : public otherClass
    {
         int foo;
         void doFoo();
    }; 
```

我怎样才能让它工作？

这只是一个例子，真正的宏可能很长。

* * *

## 回答 #1

> 赞同：143
> 
> 时间：2012-05-02T18:27:51.823

您`\`用作行继续转义字符。

```
#define swap(a, b) {               \
                       (a) ^= (b); \
                       (b) ^= (a); \
                       (a) ^= (b); \
                   } 
```

编辑：正如@a​​belenky 在评论中指出的那样，该`\`字符**必须是该行的最后一个字符**。如果不是（即使之后只是空白），您将在其后的每一行上收到令人困惑的错误消息。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-05-02T18:29:31.433

`\`您可以通过在每行末尾放置一个反斜杠 ( ) 来使宏跨越多行：

```
#define F(x) (x)   \
              *    \
             (x) 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2012-05-02T19:20:32.433

**请注意**，正如 Kerrek SB 和 coaddict 所指出的，这应该在接受的答案中指出， **总是**在你的论点周围放置大括号。sqr 示例是 CompSci 课程中教授的简单示例。

问题来了：如果你按照你说“sqr(1+5)”的方式定义它会发生什么？你会得到 "1+5*1+5" 或 11
如果你正确地在它周围放置大括号，`**#define** sqr(x) ((x)*(x))`
你会得到 ((1+5) * (1+5)) 或者我们想要的 36 ...漂亮。

Ed S. 会遇到与“交换”相同的问题

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-05-02T18:30:03.907

您需要通过以下方式转义行尾的换行符`\`：

```
#define sqr(X) \
        ((X)*(X)) 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2021-04-03T23:39:10.770

尽管这不是原始问题的一部分，但其他答案都没有提到嵌入在多行宏中的注释需要仔细注意。

*   C++ 风格的注释可能不会出现在任何具有换行符的行上。
*   C 风格的注释不能跨越由换行符分隔的多行。

例子：

```
// WRONG:
#define someMacro(X)          \
// This comment is a problem. \
class X : public otherClass   \
{                             \
     int foo;                 \
     void doFoo();            \
}; 
```

* * *

```
// WRONG:
#define someMacro(X)        \
/* This comment is also     \
 * a problem. */            \
class X : public otherClass \
{                           \
     int foo;               \
     void doFoo();          \
}; 
```

* * *

```
// OK:
#define someMacro(X)                \
/* This comment is fine. */         \
class X : public otherClass         \
{                                   \
     int foo; /* This is OK too! */ \
     void doFoo();                  \
}; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-04-04T02:56:05.643

这是 2021 年，我们真的应该朝着 2021 年迈进`inline`。不正确、不必要和过度使用宏会使代码膨胀，而且它们很难调试（阅读起来很难调试）

```
inline void foo(x)
{
   // do whatever with x
} 
```

但是，如果宏确实是当务之急，请`do { } while(0);`在这篇文章中解释[为什么要在宏中使用看似毫无意义的 do-while 和 if-else 语句？](https://stackoverflow.com/questions/154136/why-use-apparently-meaningless-do-while-and-if-else-statements-in-macros)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-04-04T02:41:30.170

# python - (HEX) 字符串比较的最佳方法

> ID：10419537
> 
> 赞同：0
> 
> 时间：2012-05-02T18:26:17.670
> 
> 标签：python

为此建议一种最佳和有效的方法

```
a = "data read from serial port in HEX"
TX1 = "\x10\x04"
RX1 = "\x10\x04"
TX2 = "\xF2\x00\x04\x43\x30\x40\x32\xED\x45"
RX2 = "\x06\xF2\x00\x13\x50\x30\x40\x30\x30\x31\x31\x31\x30\x31\x31\x30\x30\x30\x30\x30\x30\x30\x30\xAE\xFD"
if tx1 in a:
    send.ser(rx1)
    read_buufer()
if tx2 in a:
    send.ser(rx2)
    read_buf() 
```

那么进行此比较的最佳方法是什么....只是想验证从串行缓冲区（a）接收到的十六进制数据，并使用可用请求字符串 tx1、tx2、tx3 .....txn 的列表进行验证并将响应发送到从 rx1,rx2,rx2......rxn...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T18:35:56.197

一种选择是使用字典：

```
tx_rx = {TX1: RX1, TX2: RX2}
for tx in tx_rx:
    if tx in a:
        send.ser(tx_rx[tx])
        read_buf() 
```

# javascript - JavaScript 动态函数名

> ID：10419538
> 
> 赞同：0
> 
> 时间：2012-05-02T18:26:29.993
> 
> 标签：javascript

我需要将函数的名称动态分配给关联数组的元素。这是我的尝试，它不起作用。我寻求帮助的问题是在这里我尝试调用函数：`cr['cmd1'](x)`;

```
<!DOCTYPE html>

<html>
<head>
    <script type="text/javascript">
        var cr =[];
        var x = 5;
        cr['cmd1'] ='foo';
        var msg = cr['cmd1'](x);  
        alert(msg);

        function foo(y){
            return y;
        }
    </script>
</head>
<body>
</body>
</html> 
```

**编辑：**我在这里传递了一个`cr['cmd1'] ='foo';`我无法控制的字符串。这就是为什么我必须使用字符串作为外部应用程序的起点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-02T18:28:52.927

如果要将其存储为函数，则直接传递该函数。否则，如果您只想将其存储为字符串，则可以使用引号。

改变：

```
cr['cmd1'] ='foo'; 
```

至：

```
cr['cmd1'] = foo; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-02T18:29:18.370

使用此语法访问函数`window[function_name]('para1');`

您的使用将是这样的

```
var msg = window[cr['cmd1']](x); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-02T18:41:24.903

我会使用 window[] 并在尝试执行它之前确保它是一个函数，因为您无法控制传递的内容。

```
var f = window[cr['cmd1']];
if(typeof f==='function') {
  f(x);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-02T18:39:02.610

你在那里做的是将一个函数分配给一个数组。您可能尝试做的更常见的模式是使用数组表示法在对象上调用函数。

```
 <script type="text/javascript">
        var cr = {};
        cr.cmd1 = function foo(y){
            return y;
        };
        var x = 5;
        var msg = cr['cmd1'](x);  
        alert(msg);
    </script> 
```

此代码会生成一个包含数字 5 的警报框。

# php - APC 在 php 控制台中不起作用

> ID：10419546
> 
> 赞同：0
> 
> 时间：2012-05-02T18:27:00.367
> 
> 标签：php, console, websocket, wamp, apc

我正在开发一个 phpwebsocket 应用程序。我必须在我的应用程序的每个位置存储 phpwebsocket 的实例。我找到了一个解决方案，那就是使用 APC。它不起作用。问题是，如果我从我在 php 控制台上运行的脚本 php 访问带有 apc_store('foo', 'bar') 的文件，它将不起作用。如果我做一个 http 请求（使用浏览器..）它实际上可以工作，但我真的必须从 php 控制台运行 phpwebsocket。

在 php.ini 中：

```
[APC]
extension=php_apc.dll
apc.enabled = 1
apc.enable_cli = 1 
apc.shm_segments = 1
apc.shm_size = 64M
apc.max_file_size = 10M
apc.stat = 1 
```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T01:35:31.933

APC 在其进程空间内收集和存储缓存。由于控制台应用程序每次都会启动一个新进程，因此 APC 缓存会启动干净，因此没有性能提升。在 apache mod 的情况下，进程空间是保持活动状态的 apache web 服务器本身。

1）如何做一个`wget URL`控制台而不是一个独立的控制台php脚本？如果需要输出，请使用`wget -O - URL`. APC 可以正常工作。这里的限制是脚本没有获得任何物理文件访问权限。

2）您可以从您的控制台 php 控制台脚本中执行 file_get_contents(URL) 并转储内容。这样，您可以从控制台调用它，甚至可以使用共享 APC 缓存的优势。您还可以在此处获得物理文件访问权限，但存在一个问题。出于严重的安全原因，默认情况下以文件形式获取 URL 是关闭的。您可能需要在 php.ini 中将其打开。在生产网络上使用它之前，请仔细验证您的案例。

[http://www.php.net/manual/en/filesystem.configuration.php#ini.allow-url-fopen](http://www.php.net/manual/en/filesystem.configuration.php#ini.allow-url-fopen)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T18:32:28.277

`php-cli`不与`php-cgi`或共享 APC 缓存`php-fpm`。事实上，我不确定它是否与自己共享 APC 缓存！

此外，您不能在 APC 中存储资源/实例（如流或套接字）——只能存储序列化对象。

从那时起，我将使用[http://memcached.org/](http://memcached.org/)来缓存数据，当您添加更多服务器时，它们也将能够访问相同的缓存。APC/XCache 仅适用于单个服务器。

# c# - 如何从实体外部引发属性更改事件？

> ID：10419553
> 
> 赞同：0
> 
> 时间：2012-05-02T18:27:43.883
> 
> 标签：c#, entity-framework-4, wcf-ria-services

实体已经实现了 PropertyChanged。如果属性被更改，PropertyChanged 将被触发。
我现在想要的是：我想在代码中触发 PropertyChanged 事件，即使值实际上没有改变（出于绑定目的）。我想从实体外部做一些事情：

```
MyEntity.RaisedPropertyChanged("myProperty"); 
```

也知道实体有 OnPropertyChanged 方法，但它是受保护的，只在类或其子类内部可用。

如何实现这个要求？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T18:35:58.917

其他人可能会指出为什么您不应该这样做，但一件简单的事情是添加一个公共方法，该方法中继到受保护的方法。

```
public partial class MyEntity
{    
    public void RaisePropertyChanged(string propertyName)
    {
       this.RaisedPropertyChanged(propertyName);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T18:34:11.453

您可以在部分类中创建一个公共方法，`MyEntity`以便触发调用受保护的方法。

# forms - 为什么我的表单会跳过所有其他项目

> ID：10419560
> 
> 赞同：0
> 
> 时间：2012-05-02T18:28:09.577
> 
> 标签：forms

我正在为一个班级做一个项目，基本上是尝试进行一项调查，以根据人们想要的生活方式将他们与宿舍相匹配。我复制了表格的语法，其中一些正确弹出 - 问题出现在下拉菜单中，但随后出现的问题是“你打算多久去一次红狮”和“你打算怎么吃大部分你的饭菜”不显示，应该在下拉菜单中的选项显示为页面上的文本，而不是下拉菜单。有任何想法吗？继承人的代码：

```
<!DOCTYPE html>
<html> 
<head>
    <title> Find the right dorm for you </title>

    <h1>Find out what dorm fits your lifestyle!</h1>

</head>
<body>
    <p> Please fill out a few quesitons so we can help you figure out which dorm    is best for you. </p>

<form method="get" action="slutsky1-results.php">

    I enjoy (check all that apply):<br>
    <input type="checkbox" name="act1" value="8">Working Out<br>
    <input type="checkbox" name="act2" value="3">Bowling<br>
    <input type="checkbox" name="act3" value="3">Live Music<br>     
    <input type="checkbox" name="act4" value="5">Shopping<br>   
    <input type="checkbox" name="act5" value="7">Food<br>
    <input type="checkbox" name="act6" value="9">Bars <br>
    <input type="checkbox" name="act7" value="9">Frat Parties <br>
    <input type="checkbox" name="act8" value="8">Sports <br>
    <input type="checkbox" name="act9" value="3">Library <br>

    Is being close to the quad important to you?:
    <select name= "Quad">
    <option value="1">Not important</option>
    <option value="3">Kind of important</option>
    <option value="6">Very Important</option>
    <option value="3">Only thing that matters</option> <br>

    How often do you plan on going to Red Lion?:
    <select name= "Lion">
    <option value="1">Never</option>
    <option value="5">Sometimes</option>
    <option value="10">Over 3 times a week</option> <br>

    Would you rather go to the ARC or CRCE?:
    <select name= "Gym">
    <option value="10">Arc</option>
    <option value="1">CRCE</option>
    <br>

    How do you plan on eating most of your meals?:
    <select name= "Gym">
    <option value="5">Ordering delivery</option>
    <option value="8">Walking To Green St.</option>
    <option value="5">Making my own food</option>
    <br>

    Private or Public dorm?:
    <select name= "Gym">
    <option value="10">Private</option>
    <option value="5">Public</option>
    <br>

    <input type="submit" value="get my results!">

    </form>

    </body>

</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T18:30:56.797

您没有关闭您的选择标签。所以浏览器试图猜测你想要完成什么。请记住，所有标签都应该关闭。

```
<select name= "Quad">
    <option value="1">Not important</option>
    <option value="3">Kind of important</option>
    <option value="6">Very Important</option>
    <option value="3">Only thing that matters</option>
</select> 
```

如需帮助查找此类问题，请针对[html 验证器](http://validator.w3.org/)运行您的页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T18:31:21.820

您需要在选项列表之后关闭`select`标签（使用）：`</select>`

```
<select name= "Gym">
    <option value="10">Arc</option>
    <option value="1">CRCE</option>
</select> 
```

对每个列表都这样做。

# jquery - jQuery 验证插件多个规则/字段

> ID：10419563
> 
> 赞同：0
> 
> 时间：2012-05-02T18:28:16.700
> 
> 标签：jquery, validation, jquery-validate

我正在尝试使用验证插件使用 jQuery 验证表单，但似乎无法弄清楚如何设置多个规则来验证多个字段。

这是我的测试脚本：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled Document</title>
<link rel="stylesheet" type="text/css" href="styles.css">
<script type="text/javascript" src="jquery-1.7.2.min.js"></script>
<script type="text/javascript" src="jquery.validate.min.js"></script>
<script type="text/javascript">
    $(document).ready(function(){       
        $("#test").click(function () {              
            $('#test_form').validate({
                rules: {
                    firstName: {
                        required: true
                    },
                    surname: {
                        required: true
                    }
                },
                success: function() {
                    alert('it works?');
                }
            });
        });
    });
</script>
</head>
<body>
<form id="test_form" action="" method="post">
    <fieldset>
        <legend>Create an Account</legend>
        <label for="firstName">First Name</label><br/>
        <input id="firstName" name="firstName" type="text" /><br/><br/>
        <label for="surname">Surname</label><br/>
        <input id="surname" name="surname" type="text" /><br/><br/>
        <a href="#" id="test">try me</a>
    </fieldset>
</form>
</body>
</html> 
```

任何关于我如何设法搞砸的想法，将不胜感激！

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T18:34:11.317

您需要`$("#test_form").validate(...)`在点击链接之前致电。现在发生的是当点击链接时，验证被添加到表单中，但没有经过测试。

尝试这个：

```
var $form = $('#test_form');

$form.validate({
    rules: {
        firstName: {
            required: true
        },
        surname: {
            required: true
        }
    },
    success: function() {
        alert('it works?');
    }
});

$("#test").click(function(e) {
    e.preventDefault();
    $form.submit();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-24T02:20:10.670

```
$(document).ready(function () {
    $('#Invoice').validate( {
        rules: {
            code: {
                required: true,
                int: true
            },

            price: {
                required: true,
                int: true
            }
        }
    });
}); 
```

# c# - WPF DataGrid - 绑定到“单元格”的集合

> ID：10419565
> 
> 赞同：1
> 
> 时间：2012-05-02T18:28:32.930
> 
> 标签：c#, wpf, datagrid

我试图弄清楚如何将 DataGrid 的数据源绑定到“单元格”的 ObservableCollection。特别是，我有一个 ObservableCollection 包含以下类的实例：

```
public class Option : INotifyPropertyChanged
{
    public Option()
    {
    }

    // +-+- Static Information +-+-
    public double spread = 0;        
    public double strike = 0;        
    public int daysToExpiry = 0;
    public int put_call; // 0 = Call, 1 = Put

    // Ticker References
    public string fullTicker = "";
    public string underlyingTicker = "";

    //+-+-Properties used in Event Handlers+-+-//
    private double price = 0;
    public double Price
    {
        get { return price; }
        set
        {
            price = value; 
            NotifyPropertyChanged("Price");
        }
    }

    //+-+-+-+- Propoerty Changed Event & Hander +-+-+-+-+-//
    public event PropertyChangedEventHandler PropertyChanged;

    private void NotifyPropertyChanged(string info)
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(info));
        }
    }
} 
```

在我的 DataGrid 上，我想显示这些类（我在每个单元格中使用 TemplateColumns 价格和 'strike' 变量），以便它们按“underlyingTicker”[这是一个 4 个字符串]和“spread”分组[它采用背景编码中定义的 6 个可能值中的 1 个]。

目前，当我将 DataGrid 的 DataContext 绑定到 ObservableCollection 时，它会将每个“选项”显示为一行 - 我无法弄清楚如何指定将这些对分组的内容......

这就是我的数据网格现在的样子： ![在此处输入图像描述](../Images/72f83a674659bf395b753639e6dbfa7b.png)

非常感谢 - kcross！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T19:49:35.923

像 Dtex 一样，我并不完全了解您想要做什么。但我试图做一个简化，希望能让你开始。您必须传递对象的`DataGrid`an `IEnumerable`（最好是 an `ObserrvableCollection`）。单个对象将转换为行，这些对象的属性将转换为列标题。

因此，如果您希望列标题表示标准偏差的倍数（对吗？），您将必须创建一个将这些倍数作为属性的对象。生成的单元格将包含`Option`类。要表示这些，您必须定义一个 DataTemplate 或覆盖 ToString() 函数。从你的例子来看，我认为你做了前者。

后面的代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Windows;
using System.Windows.Controls;
using System.ComponentModel;
using System.Collections.ObjectModel;
namespace DataGridSpike
{
    /// <summary>
    /// Interaction logic for MainWindow.xaml
    /// </summary>
    public partial class MainWindow : Window
    {
        private List<Option> _unsortedOptions;
        private ObservableCollection<OptionRow> _groupedOptions;

        public ObservableCollection<OptionRow> GroupedOptions
        {
            get { return _groupedOptions; }
            set { _groupedOptions = value; }
        }

        public MainWindow()
        {
            var rnd=new Random();
            InitializeComponent();

            //Generate some random data
            _unsortedOptions=new List<Option>();
            for(int element=0;element<50;element++)
            {
                double column=rnd.Next(-2,3);
                int row=rnd.Next(0,9);

                _unsortedOptions.Add(new Option { ColumnDefiningValue = column, RowDefiningValue = row });
            }

            //Prepare the data for the DataGrid
            //group and sort
            var rows = from option in _unsortedOptions
                       orderby option.ColumnDefiningValue
                       group option by option.RowDefiningValue into optionRow
                       orderby optionRow.Key ascending
                       select optionRow;

            //convert to ObservableCollection
            _groupedOptions = new ObservableCollection<OptionRow>();
            foreach (var groupedOptionRow in rows)
            {
                var groupedRow = new OptionRow(groupedOptionRow);
                _groupedOptions.Add(groupedRow);
            }

            //bind the ObservableCollection to the DataGrid
            DataContext = GroupedOptions;
        }
    }

    public class OptionRow
    {
        private List<Option> _options;

        public OptionRow(IEnumerable<Option> options)
        {
            _options = options.ToList();
        }

        public Option Minus2
        {
            get
            {
                return (from option in _options
                       where option.ColumnDefiningValue == -2
                       select option).FirstOrDefault();
            }
        }
        public Option Minus1
        {
            get
            {
                return (from option in _options
                        where option.ColumnDefiningValue == -1
                        select option).FirstOrDefault();
            }
        }
        public Option Zero
        {
            get
            {
                return (from option in _options
                        where option.ColumnDefiningValue == 0
                        select option).FirstOrDefault();
            }
        }
        public Option Plus1
        {
            get
            {
                return (from option in _options
                        where option.ColumnDefiningValue == 1
                        select option).FirstOrDefault();
            }
        }
        public Option Plus2
        {
            get
            {
                return (from option in _options
                        where option.ColumnDefiningValue == 2
                        select option).FirstOrDefault();
            }
        }
    }

    public class Option:INotifyPropertyChanged
    {

        public override string ToString()
        {
            return string.Format("{0}-{1}", RowDefiningValue.ToString(),ColumnDefiningValue.ToString());
        }

        private double _columnDefiningValue;
        public double ColumnDefiningValue
        {
            get{return _columnDefiningValue;}
            set{_columnDefiningValue = value;
                OnPropertyChanged("ColumndDefiningValue");
            }
        }

        private int _rowDefiningValue;
        public int RowDefiningValue
        {
            get{return _rowDefiningValue;}
            set{_rowDefiningValue = value;
                OnPropertyChanged("RowDefiningValue");
            }
        }

        private void OnPropertyChanged(string propertyName)
        {
            if (PropertyChanged!=null)
            {
                PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
            }
        }

        public event PropertyChangedEventHandler PropertyChanged;
    }
} 
```

XAML：

```
<Window x:Class="DataGridSpike.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="350" Width="525">
    <Grid>
        <DataGrid ItemsSource="{Binding}"/>
    </Grid>
</Window> 
```

# php - 如何将视图中的按钮连接到代码点火器中的数据库？

> ID：10419568
> 
> 赞同：0
> 
> 时间：2012-05-02T18:28:45.193
> 
> 标签：php, javascript, codeigniter

我正在尝试将视图中的按钮连接到数据库。我知道我必须使用 java 脚本/Ajax 或 jQuery 以及 onclick()。但是接下来我该怎么办？如何将按钮单击的结果连接到我可以保存到数据库的 php 变量？

更新：（ANS）我缺少的是可以从视图中访问控制器的事实。只需这样做：

```
<?php echo form_open('form/submit'); ?>
<br><br>
Title<br>
<input type="text" name="title"><br>
Body<br>
<input type="text" name="body">
<input type="submit" value="New"> 
```

这会将表单提交回控制器的提交功能，您可以使用它做所有您想做的事情。感谢您的回复！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T18:36:38.227

创建一个正确处理 ajax 请求的视图（可能只有 JSON 输出）

然后使用按钮从视图中通过 AJAX 向它发出请求。

在您的 ajax.php 中，您可以设置适当的代码来访问数据库。

您的 jquery / javascript ajax 请求只是在视图中，它在 codeigniter 的 MVC 结构中没有自己的位置，从 CI 的角度来看，它只是两个视图。

# html - ftp 服务器上的文件未显示在 html 站点上

> ID：10419576
> 
> 赞同：1
> 
> 时间：2012-05-02T18:29:26.080
> 
> 标签：html, ftp

到目前为止，我一直在成功地将文件上传到我的网站。不幸的是，我一直遇到这个莫名其妙的错误。

出现在我的 ftp 服务器文件中的文件和编辑没有出现在我的网站上。

发生了什么！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T21:51:27.963

> 有没有更好的方法来清除我的缓存？

是的，最简单的方法是使用 CTRL + F5 组合。这在大多数情况下都有效，并命令浏览器重新加载当前页面，而不是来自缓存，而是来自互联网

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T18:56:46.403

首先，仔细检查您对新/更新文件的命名是否与您网站代码中的命名完全一致。您可能正在向服务器添加文件，但您当前的代码链接到具有以前名称/拼写的页面或文档，而不是您的新文件。二、你是用FileZilla之类的客户端把这些文件上传到ftp服务器吗？如果是这样，请确保在添加队列中的本地文件后将它们传输到服务器。此外，您可以尝试清除浏览器历史记录。也许您的浏览器正在使用您网站的过时缓存版本。

# java - 将图像转换为文本 - Java

> ID：10419577
> 
> 赞同：12
> 
> 时间：2012-05-02T18:29:26.557
> 
> 标签：java, image, text, analyzer

这是一个有趣的话题。基本上，我有一个包含一些文本的图像。如何从图像中提取文本？

我已经尝试了很多东西，但是我所做的一切都很乏味，而且通常不起作用。我只是想知道是否有一种相当简单的方法可以做到这一点。

我遇到了这个：http: [//sourceforge.net/projects/javaocr/](http://sourceforge.net/projects/javaocr/)。我已经尝试了几个小时，但我无法将其从图像中提取`Image`并转换`String`为文本。

谢谢大家！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-02T18:31:06.097

您需要研究 Java OCR 实现。看看这个问题： [Java OCR](https://stackoverflow.com/questions/1813881/java-ocr-implementation)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-04T02:13:24.760

[Tess4J](http://tess4j.sf.net)是围绕 Tesseract 引擎的 JNA 包装器，支持将 BufferedImage、File 或图像数据作为输入并返回 String 作为输出的 API。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-02T18:31:04.743

您需要一个 OCR（光学字符识别器）库或编写自己的库。看看[这个](https://stackoverflow.com/questions/1813881/java-ocr-implementation)SO 问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-02T18:35:44.780

试试这个字符识别库：http: [//sourceforge.net/projects/javaocr/](http://sourceforge.net/projects/javaocr/)

# ruby - Ruby 中 Sqlite3 的编码问题

> ID：10419578
> 
> 赞同：0
> 
> 时间：2012-05-02T18:29:27.340
> 
> 标签：ruby, encoding, sqlite

我有一个用 utf-8 编码精美的 sql 查询列表。我从文件中读取它们，执行插入，然后进行选择。

```
# encoding: utf-8 
def exec_sql_lines(file_name)
  puts "----> #{file_name} <----"
  File.open(file_name, 'r') do |f|
    # sometimes a query doesn't fit one line
    previous_line=""
    i = 0
    while line = f.gets do
      puts i+=1

      if(line[-2] != ')')
        previous_line += line[0..-2]
        next
      end

      puts (previous_line + line)  #  <----  (1)

      $db.execute((previous_line + line))
      previous_line =""
    end
    a = $db.execute("select * from Table where _id=6")
    puts a <---- (2)
  end
end

$db=SQLite3::Database.new($DBNAME)
exec_sql_lines("creates.txt")
exec_sql_lines("inserts.txt")
$db.close 
```

(1) 中的文本与 (2) 中的文本不同。波兰字母坏了。如果我使用 IRB 并调用**$db.open ；$db.encoding**是 UTF-8。

为什么波兰字母出来时会损坏？如何解决？

我需要为我的 Android 应用程序正确编码为 UTF-8 的这个数据库，所以我对操作数据库输出不感兴趣。我需要修复它的内容。

**编辑**

输出中的重要行：

```
6
INSERT INTO 'Leki' VALUES (NULL, '6', 'Acenocoumarolum', 'Acenocumarol WZF', 'tabl. ', '4 mg', '60 tabl.', '5909990055715', '2012-01-01', '2 lata', '21.0, Leki przeciwzakrzepowe z grupy antagonistów witaminy K', '8.32', '12.07', '12.07', 'We wszystkich zarejestrowanych wskazaniach na dzień wydania decyzji', '', 'ryczałt', '5.12') 
```

出去：

```
6
6
Acenocoumarolum
Acenocumarol WZF
tabl. 
4 mg
60 tabl.
5909990055715
2012-01-01
2 lata
21.0, Leki przeciwzakrzepowe z grupy antagonistĂł[<--HERE]w witaminy K
8.32
12.07
12.07
We wszystkich zarejestrowanych wskazaniach na dzieĹ[<--HERE] wydania decyzji

ryczaĹ[<--HERE]t
5.12 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T19:13:49.930

有[三种默认编码](http://blog.grayproductions.net/articles/ruby_19s_three_default_encodings)。

在您的代码中，您设置源编码。也许外部和内部编码有问题？

Windows 中的快速测试：

```
#encoding: utf-8
File.open(__FILE__,'r'){|f|
  p f.external_encoding
  p f.internal_encoding
  p f.read.encoding
} 
```

结果：

```
#<Encoding:CP850>
nil
#<Encoding:CP850> 
```

即使使用 UTF-8，数据也会被读取为 cp850。

在你的情况下：有`File.open(filename,'r:utf-8')`帮助吗？

# android - 确定锁定屏幕已解锁

> ID：10419585
> 
> 赞同：0
> 
> 时间：2012-05-02T18:30:09.593
> 
> 标签：android, android-activity, android-notifications

仅当某个活动不可见时，我才想在特定情况下在我的应用程序中启动通知。

当我创建和销毁 Activity（使用 onCreate/onDestroy）时，我设法做到了服务的绑定/取消绑定，如果此 Activity 通过 onPause/onResume 方法可见，则保存在布尔值中，如下面的代码所示：

```
public void onCreate(Bundle savedInstanceState) {
    // ...
    bindService(...);
}

public void onDestroy() {
    // ...
    unbindService(mConnection);
}

public void onResume() {
    // ...
    // this method sets to true the Service's boolean which retain Activity's visibility.
    mService.registerActivity(true);
}

public void onPause() {
    mService.registerActivity(false);
} 
```

在服务上，我检查此布尔值以启动通知。

它适用于除特定情况外的所有情况：当应用程序在此活动中打开但启用了锁定屏幕时。

通过我所做的一些测试，当锁屏出现时，会调用 Activity.onPause 方法。我希望在锁定屏幕解锁时调用 Activity.onResume 方法，但事实并非如此。当我按下电源按钮召唤锁定屏幕时，已经调用了 Activity.onResume 方法。从这个意义上说，我的做法是不对的。

如何使 Activity.onResume 方法仅在用户解锁锁定屏幕时调用？或者......我如何确定锁定屏幕已解锁并且用户真的在看活动？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-03T10:35:49.420

`Activity.onWindowFocusChanged(boolean hasFocus)`每次`Activity`屏幕解锁后重新获得焦点时都应该返回 true。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T19:37:41.863

2个想法，未经测试，我仍然是一个android noob：

```
ActivityManager am = (ActivityManager) getSystemService(Context.ACTIVITY_SERVICE);
List<RunningAppProcessInfo> list2 = am.getRunningAppProcesses(); 
```

然后，从此列表中过滤您的活动并检查它的重要性属性。前端运行的应用是100，不知道前面有锁屏是不是还是100。

或者，您可以创建一个正在运行的进程，该进程每隔 x 秒检查一次屏幕是否被锁定，并在再次解锁时执行某些操作。

# .htaccess - .htaccess / .htpasswd 绕过某个 IP 地址

> ID：10419592
> 
> 赞同：57
> 
> 时间：2012-05-02T18:30:31.400
> 
> 标签：.htaccess, apache2, basic-authentication

是否可以为给定目录设置 .htaccess/.htpasswd 访问控制设置，但如果它们来自特定 IP 地址，则绕过登录/密码身份验证？

我知道你可以在 .htaccess 文件中做这样的事情：

```
order deny,allow
deny from all
allow from 000.000.000.000 
```

但是，如果您按照以下方式添加一些内容：

```
AuthType Basic
AuthName "restricted area"
AuthUserFile /path/to/.htpasswd
require valid-user 
```

然后它会提示输入密码。有没有办法进行 if/else 类型设置或其他一些解决方案，以使作为给定 IP（或 IP 集）的用户不会被提示输入密码，但其他人会？

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2012-05-14T13:29:41.777

对于 2.2.X 版本，您可以使用以下...

```
AuthUserFile /var/www/mysite/.htpasswd
AuthName "Please Log In"
AuthType Basic
require valid-user
Order allow,deny
Allow from xxx.xxx.xxx.xxx
satisfy any 
```

显然替换您的用户文件的路径和您想要绕过身份验证的 IP 地址。

具体细节的进一步解释，可以在以下位置找到：[http ://httpd.apache.org/docs/2.2/howto/auth.html](http://httpd.apache.org/docs/2.2/howto/auth.html)

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-05-02T18:41:29.690

如果你使用 apache >=2.4，它会是这样的：

```
<If "%{REMOTE_ADDR} != '127.0.0.1'">
  AuthType Basic
  AuthName "restricted area"
  AuthUserFile /path/to/.htpasswd
  require valid-user
</If> 
```

有关更多信息，请查看[文档](http://httpd.apache.org/docs/trunk/expr.html)。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2013-10-01T03:16:52.237

我正在运行 Apache/2.2.16 (Debian)，并且遇到了类似的问题，我这样解决了：

（这可以在 .htaccess 文件中运行，也可以直接在虚拟主机下运行`<Location/>`）

```
Order deny,allow
Deny from all
AuthType Basic
AuthUserFile /home/somesite/.htpasswd
AuthName "No entry, unless"
Require Valid-user
Allow from x.x.x.x
Allow from x.x.x.x
Satisfy Any 
```

我允许从两个不同的ip无密码进入，其余的必须输入密码才能进入。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2018-08-14T08:18:03.523

Apache 2.4 兼容：

```
AuthType Basic
AuthUserFile /www/.htpasswd
AuthName "Protected Area"

<RequireAny>
    Require ip 1.2.3.4
    Require valid-user
</RequireAny> 
```

有关更多示例，请参阅迁移指南[从 2.2 升级到 2.4 。](https://httpd.apache.org/docs/2.4/en/upgrading.html#access)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2018-01-25T15:28:32.817

如果您使用 apache >=2.4，并且您希望允许一组 IP，如最初的问题中所问，您可以这样做：

```
 <If "-R '192.168.0.0/24'">
            Require all granted
    </If>
    <ElseIf "-R '192.168.1.0/24'">
            Require all granted
    </ElseIf>
    <Else>
            AuthType Basic
            AuthName "restricted area"
            AuthUserFile /etc/apache2/.htpasswd
            require valid-user
    </Else> 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-03-12T13:38:44.810

除了j5Dev的答案：

```
# Interne IP-Adressen
SetEnvIf Remote_Addr "^127\.0\.0\.1$" IsIntern
SetEnvIf Remote_Addr "^192\.168" IsIntern
# .. add more IP addresses or ranges here

# Authentication, wenn nicht intern
AuthUserFile /path/to/.htpasswd
AuthName "restricted area"
AuthType Basic
require valid-user
Order allow,deny
Allow from env=IsIntern
satisfy any 
```

# ruby-on-rails - 捕获 current_user.id 保存深度嵌套的记录

> ID：10419594
> 
> 赞同：0
> 
> 时间：2012-05-02T18:30:35.753
> 
> 标签：ruby-on-rails

假设我有一个如下所示的工作表单

```
=form_for @survey do |f|
  =f.text_field :name
  =f.fields_for :questions do |question_fields|
    =question_fields.text_field :question_text
      =question_fields.fields_for :answers do |answer_fields|
        =answer_fields.text_field :answer_text 
```

因为表单的不同部分可以由不同的用户添加和更新，所以我需要一种在保存之前将 user_id 放入每个模型的方法。我意识到能够访问模型内​​的 current_user 是不符合 mvc 的，也就是说我没有解决方案。

如果我只保存一个对象，将 current_user.id 分配给控制器中的对象就足够简单了，但考虑到这种形式的深层嵌套性质，它开始看起来像一个丑陋的解决方案。

有没有专家/有条理的方法来处理这个问题？

Rails 3.2，设计

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T19:04:20.900

`user_id`每个对象不能简单地从它们的“父”关系中窃取吗？这是一个常见的模式：

```
class Answer < ActiveRecord::Base
  before_validation :assign_user_id

protected
  def assign_user_id
    # Don't attempt if the question is not defined,
    # or the user_id field is already populated.
    return unless (self.question or self.user)

    self.user_id = self.question.user_id
  end
end 
```

这涉及到一些额外的数据库活动来解决每个问题的答案，因为在范围内创建它是不够的，但它使它非常简单。

您可能想要做的是`user_id`创建每条记录时参数中的内容。这意味着您的`create`呼叫需要在需要的地方合并到一个`:user_id`键中。但是，嵌套助手默认情况下不会执行此操作，因此如果您使用它，您可以将其留给 assign 方法。

# c# - 使用 sum 和 order by 的 Linq 查询

> ID：10419596
> 
> 赞同：1
> 
> 时间：2012-05-02T18:30:37.323
> 
> 标签：c#, .net, linq, entity-framework, entity-framework-4

我有像下面这样的课，

```
public class SiteActionMap
{
        public int Id { get; set; }
        public string ImageName { get; set; }
        public int ParentId { get; set; }
        public string Name { get; set; }

        public  virtual ICollection<SiteActionMap> Childrens { get; set; }
        public  virtual SiteActionMap Parent { get; set; }
        public bool Active { get; set; }

} 
```

我想得到一个按儿童计数排序的列表。

我正在尝试这样的事情，但我没有工作。

```
List<SiteActionMap> list = dbContext.SiteActionMap
                .Include(m => m.Childrens)
                .Include(m => m.Parent)
                .OrderBy(i => i.Childrens.Count)
                ToList(); 
```

我怎样才能用儿童计数对我的列表进行排序？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T19:11:47.813

补充一下 lbruder 所说的，在这种情况下 Count 不是一个方法 () 吗？

```
List<SiteActionMap> list = dbContext.SiteActionMap
                .Include(m => m.Childrens)
                .Include(m => m.Parent)
                .OrderByDescending(i => i.Childrens.Count())
                .ToList(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-02T19:09:00.530

你试过这个吗？只需删除 Order... 行后的分号并继续执行命令：

```
List<SiteActionMap> list = dbContext.SiteActionMap
                .Include(m => m.Childrens)
                .Include(m => m.Parent)
                .OrderByDescending(i => i.Childrens.Count)
                .ToList(); 
```

# ruby-on-rails - 让用户使用 CanCan 和 Devise 更新自己的帖子

> ID：10419598
> 
> 赞同：2
> 
> 时间：2012-05-02T18:30:47.093
> 
> 标签：ruby-on-rails, devise, cancan

我正在使用**Devise 和 CanCan**来管理用户和用户权限。我想要的是：普通用户应该能够**更新自己的帖子**。最重要的模型称为活动。

在我为普通会员提供的能力模型中：

```
elsif user.role? :Member
   can :read, :all
   can :create, :all
   can :manage, Activity, :user_id=>user.id 
```

（感谢 Yuriy Goldshtrakh 提供第三行的语法）

在活动的索引视图中，我有：

```
<% if can? :update, activity  %>
<br />
<%= link_to 'Update', edit_activity_path(activity) %>
<% end %>

<% if can? :delete, activity  %>
<%= link_to 'Delete', activity, :confirm => 'Really?', :method => :delete %>

<% end %> 
```

这有效：它只显示**更新和删除链接**，如果活动是由当前成员创建的。

但是，如果成员更新活动，则不会保存更改，并且不会将成员发送回活动 - 因为他/她应该在成功更新之后。

这是活动控制器中的更新操作：

```
 # PUT /activities/1.xml 
```

定义更新

```
authorize! :update, @activity

@activity = Activity.find(params[:id])

respond_to do |format|
  if @activity.update_attributes(params[:activity])
    format.html { redirect_to(@activity, :notice => 'Activity was successfully updated.') }
    format.xml  { head :ok }
  else
    format.html { render :action => "edit" }
    format.xml  { render :xml => @activity.errors, :status => :unprocessable_entity }
  end
end 
```

结尾

问题是：为什么活动没有正确更新？我很感激所有的想法！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-04T13:51:58.050

交换第 1 行和第 3 行`ActivitiesController#update`

```
def update
  @activity = Activity.find(params[:id])

  authorize! :update, @activity
  ...
end 
```

您还可以使用[Cancan 的首选方式](https://github.com/ryanb/cancan/wiki/Authorizing-Controller-Actions)：`load_and_authorize_resource`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T18:42:33.780

如果您的帖子和评论属于该用户，您可以这样做

```
can :manage, [Post,Comment], :user_id=>user.id 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-04T14:16:56.090

例如能力：

```
if user.role?(:author)
        can :create, Article
        can :update, Article do |article|
          article.try(:user) == user
        end
      end 
```

尝试使用本教程：[Railscasts CanCan](http://railscasts.com/episodes/192-authorization-with-cancan) 也许有帮助

# wcf - Silverlight：WCF 在服务器上出现错误，但 localhost 工作正常

> ID：10419603
> 
> 赞同：5
> 
> 时间：2012-05-02T18:31:04.470
> 
> 标签：wcf, silverlight, silverlight-4.0, iis-7

我有 silverlight 应用程序，但出现此错误：

```
[Async_ExceptionOccurred]
Arguments: 
Debugging resource strings are unavailable. Often the key and arguments provide sufficient information to diagnose the problem. See http://go.microsoft.com/fwlink/?linkid=106663&Version=5.0.61118.00&File=System.dll&Key=Async_ExceptionOccurred INNER >System.ServiceModel.CommunicationException: [CrossDomainError]
Arguments: http://localhost/pthaba/SimpleWCF.svc
Debugging resource strings are unavailable. Often the key and arguments provide sufficient information to diagnose the problem. See http://go.microsoft.com/fwlink/?linkid=106663&Version=5.0.61118.00&File=System.ServiceModel.dll&Key=CrossDomainError ---> System.Security.SecurityException ---> System.Security.SecurityException: [Arg_SecurityException]
Arguments: 
Debugging resource strings are unavailable. Often the key and arguments provide sufficient information to diagnose the problem. See http://go.microsoft.com/fwlink/?linkid=106663&Version=5.0.61118.00&File=mscorlib.dll&Key=Arg_SecurityException 
```

我有 WCF 服务并且在浏览器上运行良好。我在根站点上有如下 clientacesspolicy.xml （WCF 服务所在的位置）

```
<?xml version="1.0" encoding="utf-8" ?>
<access-policy>
  <cross-domain-access>
    <policy>
      <allow-from >
        <domain uri="*"/>
      </allow-from>
      <grant-to>
        <resource path="/" include-subpaths="true"/>
      </grant-to>
    </policy>

  </cross-domain-access>
</access-policy> 
```

我做错了什么？有谁能够帮我？

**编辑 ：**

在我的本地主机上工作正常，但在服务器上却不行。提琴手似乎还可以，没有错误。

我是否缺少一些 IIS 配置？

上面的更多错误详细信息：

```
 at System.Net.Browser.BrowserHttpWebRequest.InternalEndGetResponse(IAsyncResult asyncResult)
   at System.Net.Browser.BrowserHttpWebRequest.<>c__DisplayClassa.<EndGetResponse>b__9(Object sendState)
   at System.Net.Browser.AsyncHelper.<>c__DisplayClass4.<BeginOnUI>b__1(Object sendState)
   --- End of inner exception stack trace ---
   at System.Net.Browser.AsyncHelper.BeginOnUI(SendOrPostCallback beginMethod, Object state)
   at System.Net.Browser.BrowserHttpWebRequest.EndGetResponse(IAsyncResult asyncResult)
   at System.ServiceModel.Channels.HttpChannelFactory.HttpRequestChannel.HttpChannelAsyncRequest.CompleteGetResponse(IAsyncResult result)
   --- End of inner exception stack trace ---
   at System.ServiceModel.AsyncResult.End[TAsyncResult](IAsyncResult result)
   at System.ServiceModel.Channels.ServiceChannel.SendAsyncResult.End(SendAsyncResult result)
   at System.ServiceModel.Channels.ServiceChannel.EndCall(String action, Object[] outs, IAsyncResult result)
   at System.ServiceModel.ClientBase`1.ChannelBase`1.EndInvoke(String methodName, Object[] args, IAsyncResult result)
   at Pthaba.SimpleSVC.SimpleWCFClient.SimpleWCFClientChannel.EndGetGameLevelPlataforms(IAsyncResult result)
   at Pthaba.SimpleSVC.SimpleWCFClient.Pthaba.SimpleSVC.ISimpleWCF.EndGetGameLevelPlataforms(IAsyncResult result)
   at Pthaba.SimpleSVC.SimpleWCFClient.OnEndGetGameLevelPlataforms(IAsyncResult result)
   at System.ServiceModel.ClientBase`1.OnAsyncCallCompleted(IAsyncResult result)
ult) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T00:10:07.110

我遇到了同样的问题，并在这篇文章之后让我的工作：[使服务跨域边界可用](http://msdn.microsoft.com/en-us/library/cc197955%28v=vs.95%29.aspx)。

我必须进行如下更改，有人在该文章的底部发表了评论：

```
<allow-from http-request-headers="*"> 
```

# ios - iOS - 如何找到与给定 CGRect 高度相同的正确字体大小（以磅为单位）？

> ID：10419607
> 
> 赞同：7
> 
> 时间：2012-05-02T18:31:07.920
> 
> 标签：ios, user-interface, fonts, size

标题几乎解释了它。我有一张正在画文字的图像。我希望根据图像的大小调整文本的大小，并想找到一种方法来获得比图像本身短一点的字体高度。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-03T04:02:08.453

好的，所以对于那些认为迭代是不可避免的人来说：

```
NSString *string = @"The string to render";
CGRect rect = imageView.frame;

UIFont *font = [UIFont fontWithSize:12.0]; // find the height of a 12.0pt font
CGSize size = [string sizeWithFont:font];
float pointsPerPixel = 12.0 / size.height; // compute the ratio
// Alternatively:
// float pixelsPerPoint = size.height / 12.0;
float desiredFontSize = rect.size.height * pointsPerPixel;
// Alternatively:
// float desiredFontSize = rect.size.height / pixelsPerPoint; 
```

`desiredFontSize`将包含以点为单位的字体大小，其高度与指定矩形的高度完全相同。您可能希望将其乘以 0.8，以使字体比矩形的实际大小小一点，使其看起来不错。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T18:34:29.290

从这里

[http://developer.apple.com/library/ios/#documentation/StringsTextFonts/Conceptual/CoreText_Programming/Operations/Operations.html](http://developer.apple.com/library/ios/#documentation/StringsTextFonts/Conceptual/CoreText_Programming/Operations/Operations.html)

```
CGFloat GetLineHeightForFont(CTFontRef iFont)
{
    CGFloat lineHeight = 0.0;

    check(iFont != NULL);

    // Get the ascent from the font, already scaled for the font's size
    lineHeight += CTFontGetAscent(iFont);

    // Get the descent from the font, already scaled for the font's size
    lineHeight += CTFontGetDescent(iFont);

    // Get the leading from the font, already scaled for the font's size
    lineHeight += CTFontGetLeading(iFont);

    return lineHeight;
} 
```

要使用它，请猜测点的大小，找到它的行高（您可能关心也可能不关心领先）。然后使用答案与您必须缩放点大小的高度之间的比率。我认为您不能保证高度完全正确——如果您关心它是否准确，您必须迭代直到它足够接近（使用新尺寸作为新猜测）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T19:01:08.560

**注意：**这假设您的字体大小将始终小于 CGRect 的磅值。根据需要调整方法以纠正该假设。

试试这个。适用于创建字体的 3 种主要方法中的任何一种。应该是不言自明的，但增量是您希望在检查之间减少的数量。如果您不关心确切的大小，请将该数字设置得更大以获得更快的速度。如果您确实关心，请使其更小以获得更高的准确性。

```
- (UIFont *)systemFontForRectHeight:(CGFloat)height 
                          increment:(CGFloat)increment {

    UIFont *retVal = nil;
    for (float i = height; i > 0; i = i - increment) {
        retVal = [UIFont systemFontOfSize:i];
        if ([retVal lineHeight] < height) break;
    }
    return retVal;
}
- (UIFont *)boldSystemFontForRectHeight:(CGFloat)height 
                              increment:(CGFloat)increment {

    UIFont *retVal = nil;
    for (float i = height; i > 0; i = i - increment) {
        retVal = [UIFont boldSystemFontOfSize:i];
        if ([retVal lineHeight] < height) break;
    }
    return retVal;
}

- (UIFont *)fontNamed:(NSString *)name 
        forRectHeight:(CGFloat)height 
            increment:(CGFloat)increment {

    UIFont *retVal = nil;
    for (float i = height; i > 0; i = i - increment) {
        retVal = [UIFont fontWithName:name size:i];
        if ([retVal lineHeight] < height) break;
    }
    return retVal;
} 
```

# ruby-on-rails - Rails 3 内联打开 Word 文档

> ID：10419608
> 
> 赞同：0
> 
> 时间：2012-05-02T18:31:12.990
> 
> 标签：ruby-on-rails, ms-word, doc

> **可能重复：**
> [是否可以使用 PHP 在网页内显示 RTF 文件？](https://stackoverflow.com/questions/678192/is-it-possible-to-display-an-rtf-file-inside-a-web-page-using-php)

我想在页面上显示 .doc 文件。
我尝试在我的控制器操作中使用 send_file 方法：

```
 mime_types = {
        :doc => 'application/msword',
        :docx => 'application/vnd.openxmlformats-officedocument.wordprocessingml.document',
        :pdf => 'application/pdf',
        :rtf => 'application/rtf',
        :jpg => 'image/jpeg',
        :tiff => 'image/tiff'
    }

    send_file 'c:/sites/efiling2/test.rtf', 
        :filename => '2', 
        :type => mime_types[:doc], 
        :disposition => 'inline' 
```

对于 pdf 文件，它可以工作，但对于 doc 文件，浏览器要求我在 Word 中打开文件或将其保存在 dics 上。

**是否可以在页面上内联打开 doc 文件？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T18:47:51.753

问题是您的浏览器无法查看 word doc 文件，这就是它为您提供保存它的原因。我建议您查看一些 HTML 文档查看器。看看[http://www.documentcloud.org/opensource](http://www.documentcloud.org/opensource)

# android - EditText，不允许从一个复制/粘贴到另一个

> ID：10419611
> 
> 赞同：3
> 
> 时间：2012-05-02T18:31:24.207
> 
> 标签：android, android-edittext

我在布局中定义了两个编辑文本。它们都用于电子邮件地址一旦用户在第一个框中输入，我想强制用户再次重新输入相同的电子邮件地址而不进行任何复制粘贴操作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T18:37:26.837

尚未对此进行测试，但我认为您可以覆盖 OnLongClick 侦听器（对于您的每个 EditTexts），这样它就不会显示上下文菜单。因此，他们将无法复制和粘贴。

```
 OnLongClickListener mOnLongClickListener = new OnLongClickListener() {

    @Override
    public boolean onLongClick(View v) {
        //since nothing is in here, nothing will happen.  

        return true;
    }
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-31T11:13:43.173

您可以在 textView 的属性（xml 文件）中设置下一个属性：

安卓：longClickable="假"。

这将避免 textView 中的 longclick 事件。

# css - 启用对 CSS3 ::outside 伪元素的支持

> ID：10419614
> 
> 赞同：12
> 
> 时间：2012-05-02T18:31:41.117
> 
> 标签：css, css-selectors, pseudo-element, polyfills

我希望能够使用`::outside`伪元素，但显然没有一个主流浏览器支持它（基于我今天的测试）。

是否有某种 JS polyfill 可以启用此选择器？或者有没有一种很好的技术来模拟这个？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-03T03:55:36.783

您是对的：现有的浏览器没有实现古老的[CSS3 Generated and Replaced Content 模块](http://www.w3.org/TR/css3-content)中的任何新功能，因此您将无法尝试建议的伪元素。事实上，他们正计划重写模块本身，因此当前的工作草案应该被视为放弃，不幸的是，这些提议的功能的命运尚无定论。

无论如何，我也不知道这些伪元素有任何可用的 JS polyfill，所以你`::outside`在 CSS 中编写选择器时运气不佳。

您可以得到的最接近的方法是将实际元素包装在您想要使用容器为其设置样式的元素周围......这可以通过例如 jQuery[`.wrap()`](http://api.jquery.com/wrap)或[`.wrapAll()`](http://api.jquery.com/wrapAll).

所以，而不是这样做：

```
p::outside {
    display: block;
    border: 3px solid #00f;
} 
```

你会这样做：

```
$('p').wrap('<div class="outside-p" />'); 
```

```
/* 
 * Notice that you can't select only .outside-p that contains p:only-child,
 * so you'll have to come up with esoteric class names.
 */
.outside-p {
    border: 3px solid #00f;
} 
```

[jsFiddle 预览](http://jsfiddle.net/BoltClock/qzvTh/1)

但是，有一些警告：

*   这在很大程度上取决于 DOM；根据具体情况，您将无法将某些元素包裹在其他元素周围。即使可以，这些包装元素最终也可能会干扰实际父元素的行为甚至样式。

    例如，它会阻止您在以下情况下使用子选择器：

    ```
    article > p 
    ```

    您打算将`jQuery.wrap()`这些元素放在哪里，那么这些包装元素将破坏和`p`之间的父子关系。`article``p`

*   规范指出，`::outside`伪元素，如`::before`和`::after`，应该从生成它们的元素继承样式。如果您使用 JavaScript/jQuery 添加包装器，这些包装器将继承其父元素的样式，而不是它们正在包装的元素。`::before`这在填充和时从来都不是问题`::after`，因为它们无论如何都打算作为子元素插入，通常遵循继承规则。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-16T16:33:06.527

看起来您正在使用 jQuery，在这种情况下，我建议对您的代码进行一些小的修改

```
$('ol > li').wrapInner("<p class='liwrap' />"); 
```

没有这么多变量或函数调用，它更干净更简单。

编辑：正如敬畏正确地指出的那样，这是对 Marcins 解决方案的优化......

> 在li里面添加ap，避免了破坏子选择器的问题

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-03T10:55:37.493

我终于将此片段添加到我的页面：

```
 $('ol > li').each(function(){
        var $this = $(this);
        var $content = $($this.contents());
        $content.wrapAll('<p class="liwrap"/>');
  }); 
```

这在`p`内部添加了一个`li`，这避免了破坏子选择器的问题，并且需要类的深奥名称（因为没有父选择器）。它也避免了不继承样式的问题，因为`::outside`可以用`::before`.

然而，为了达到正确的视觉效果，需要负边距来将内部提升`p`到生成内容的水平。

# regex - 如何使用 htaccess 重命名页面和删除扩展而不影响 css 或 js 外部文件

> ID：10419624
> 
> 赞同：0
> 
> 时间：2012-05-02T18:32:28.770
> 
> 标签：regex, .htaccess, redirect, file-rename

我想在 htaccess 中创建一个规则来重命名我的页面，例如：

我希望 domain.com/page1 实际上打开页面 domain.com/content?p=page1 或 domain.com/page2 实际上打开页面 domain.com/content?p=page2

为此，我有一个非常简单的正则表达式：

```
RewriteRule (.*)$ /content.php?p=$ [L] 
```

现在的问题是这会影响一切，甚至是styles.css 或functions.js 等文件，甚至是images/logo.jpg。

所以我正在寻找一个正则表达式，如果它们没有点 (.) 或斜杠 (/)，它将转发我的所有页面

例如：

```
domain.com/blog  true
domain.com/home?lang=en true
domain.com/styles.css false
domain.com/image.png false
domain.com/folder/file false 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T18:43:55.067

这是您需要放入 .htaccess 文件中的代码：

```
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-l
RewriteRule ^([^/.]+)/?$ content.php?p=$1 [L,QSA] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T18:35:59.057

请看下面的代码：

```
<IfModule mod_rewrite.c>
    RewriteEngine on

    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_FILENAME} !-f

    RewriteRule ^(.*)$ content.php?p=$1 [L,QSA]
</IfModule> 
```

如果请求的 URL 不是目录也不是文件，将在下一行执行。

干杯!

# c# - 数组中的更改项目是否进入垃圾收集？

> ID：10419625
> 
> 赞同：1
> 
> 时间：2012-05-02T18:32:31.117
> 
> 标签：c#, .net, garbage-collection, clr

我有两个类，第二个继承第一个。

然后我有这个：

```
First[] tab = new First[5];
tab[0] = new First();
tab[1] = new First();
tab[2] = new First(); 
```

我的问题是：如果我这样做：

```
tab[1] = new Second(); 
```

我第一次用来调用 tab[1] 的内存发生了什么？它去垃圾收集和内存是免费的？

如果不是，我该怎么做才能释放它？

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T18:36:06.217

从数组中替换对象会导致该对象不再被数组引用。

像任何其他对象一样，如果没有其他根对象引用它，它最终将被垃圾回收。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-02T18:38:17.600

当你执行

```
tab[1] = new Second(); 
```

`First`曾经存在的那个实例`tab[1]`不再被引用，并被标记为垃圾回收。

在垃圾收集器运行之前，内存本身实际上不会再次可用，这不是立即的。

当然，这假设没有其他任何东西引用该实例。

如果你用谷歌搜索的话，有*很多*关于 .NET 垃圾收集器及其工作原理的精彩文章。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-02T18:36:37.397

tab[1] 的“First”应该去垃圾收集（最终），因为没有其他变量指向该内存。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-02T18:44:11.497

此外，您可以通过以下方式强制立即进行垃圾收集`System.GC.Collect()`

# .net - NHibernate 奇怪的错误

> ID：10419626
> 
> 赞同：7
> 
> 时间：2012-05-02T18:32:45.633
> 
> 标签：.net, nhibernate

我正在学习 NHibernate，但失败了。我感觉错误消息不准确。

请帮忙 。

错误信息是

```
The following types may not be used as proxies:
SecondSolution.Domain.Product: method get_Id should be 'public/protected virtual' or 'protected internal virtual'
SecondSolution.Domain.Product: method set_Id should be 'public/protected virtual' or 'protected internal virtual'
SecondSolution.Domain.Product: method get_Name should be 'public/protected virtual' or 'protected internal virtual'
SecondSolution.Domain.Product: method set_Name should be 'public/protected virtual' or 'protected internal virtual'
SecondSolution.Domain.Product: method get_Category should be 'public/protected virtual' or 'protected internal virtual'
SecondSolution.Domain.Product: method set_Category should be 'public/protected virtual' or 'protected internal virtual'
SecondSolution.Domain.Product: method get_Discontinued should be 'public/protected virtual' or 'protected internal virtual'
SecondSolution.Domain.Product: method set_Discontinued should be 'public/protected virtual' or 'protected internal virtual'
   at NHibernate.Cfg.Configuration.ValidateEntities() in c:\Users\oskar.berggren\Documents\Projects\nhibernate-core-3\src\NHibernate\Cfg\Configuration.cs:line
1052
   at NHibernate.Cfg.Configuration.Validate() in c:\Users\oskar.berggren\Documents\Projects\nhibernate-core-3\src\NHibernate\Cfg\Configuration.cs:line 959
   at NHibernate.Cfg.Configuration.BuildSessionFactory() in c:\Users\oskar.berggren\Documents\Projects\nhibernate-core-3\src\NHibernate\Cfg\Configuration.cs:li
ne 1251
   at SecondSolution.Program.Main(String[] args) in C:\vs_workspace\SecondSolution\SecondSolution\Program.cs:line 22
Press any key to continue . . . 
```

类文件

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace SecondSolution.Domain
{
    class Product
    {
        public Product()
        {
            this.Name = "John";
        }
        public Guid Id { get; set; }        
        public string Name { get; set; }        
        public string Category { get; set; }        
        public bool Discontinued { get; set; }
    }
} 
```

映射

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2"                    
                   assembly="SecondSolution"                    
                   namespace="SecondSolution.Domain">
  <class name="Product">
    <id name="Id">
      <generator class="guid" />
    </id>
    <property name="Name" />
    <property name="Category" />
    <property name="Discontinued" />
  </class>
</hibernate-mapping> 
```

配置：

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-configuration xmlns="urn:nhibernate-configuration-2.2">
  <session-factory>
    <property name="connection.provider">NHibernate.Connection.DriverConnectionProvider</property>
    <property name="dialect">NHibernate.Dialect.MsSqlCeDialect</property>
    <property name="connection.driver_class">NHibernate.Driver.SqlServerCeDriver</property>
    <property name="connection.connection_string">Data Source=FirstSample.sdf</property>
    <property name="show_sql">true</property>  
  </session-factory>
</hibernate-configuration> 
```

主班

```
static void Main(string[] args)
        {
            try
            {
                Configuration cfg = new Configuration();
                cfg.Configure("Mappings/hibernate.cfg.xml");
                //cfg.Configure();

                cfg.AddAssembly(typeof(Product).Assembly);

                NHibernate.ISessionFactory m_SessionFactory = cfg.BuildSessionFactory();
                NHibernate.ISession session = m_SessionFactory.OpenSession();
                Product product = new Product();
                session.SaveOrUpdate(product);
            } catch (Exception e)
            {
                Console.WriteLine(e.Message);
                Console.WriteLine(e.StackTrace);
            }

        } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-02T19:00:46.350

正如其他人所说 - 您必须使您的财产虚拟化。但这仅在您希望实体能够延迟加载时才需要，请在此处阅读[http://nhforge.org/wikis/howtonh/lazy-loading-eager-loading.aspx](http://nhforge.org/wikis/howtonh/lazy-loading-eager-loading.aspx)

如果您不想延迟加载，可以禁用它

```
<class name="Product" Lazy="false"> 
```

然后你就不需要虚拟属性了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-02T18:36:44.107

如错误消息所述，NHibernate 要求将实体类属性标记为`virtual`：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace SecondSolution.Domain
{
    class Product
    {
        public Product()
        {
            this.Name = "John";
        }
        public virtual Guid Id { get; set; }        
        public virtual string Name { get; set; }        
        public virtual string Category { get; set; }        
        public virtual bool Discontinued { get; set; }
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-02T18:35:31.013

您需要将所有产品属性声明为`virtual`.

```
public virtual Guid Id { get; set; }        
public virtual string Name { get; set; }        
public virtual string Category { get; set; }        
public virtual bool Discontinued { get; set; } 
```

# maven-3 - 如何从maven pom中的dependencyManagement引用工件版本

> ID：10419628
> 
> 赞同：0
> 
> 时间：2012-05-02T18:32:51.353
> 
> 标签：maven-3

我有以下 maven pom.xml

```
<?xml version="1.0"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org  /2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
<modelVersion>4.0.0</modelVersion>
<groupId>com.abc.def.ghi</groupId>
<artifactId>core-with-releases</artifactId>
<version>1</version>
<properties>
<yum-repo>/var/www/html/core-repo</yum-repo>
</properties>
<organization>
<name>ABC DEF GHI</name>
</organization>
<dependencyManagement>
<dependencies>
  <dependency>
    <groupId>com.aaa.bbb.ccc.ddd</groupId>
    <artifactId>core</artifactId>
    <version>1.1.3</version>
    <type>rpm</type>
  </dependency>
</dependencies>
</dependencyManagement>
<build>
<plugins>
   <plugin>
    <groupId>org.codehaus.mojo</groupId>
    <artifactId>exec-maven-plugin</artifactId>
    <version>1.2.1</version>
    <executions>
      <execution>
        <id>create-directory</id>
        <phase>process-resources</phase>
        <goals>
          <goal>exec</goal>
        </goals>
        <configuration>
          <executable>mkdir</executable>
          <arguments>
            <argument>${yum-repo}${dependencies["com.aaa.bbb.ccc.ddd:core"].version}</argument>
          </arguments>
        </configuration>
      </execution>
    </executions>
  </plugin>
 </plugins>
 </build>
 </project> 
```

我从命令行执行

mvn clean process-resources

因此，我希望创建目录，其名称以依赖项管理元素中的工件版本结尾，即 1.1.3

有人可以帮忙吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T08:08:09.057

我建议将属性用于此类目的：

```
<properties>
  <yum-repo>/var/www/html/core-repo</yum-repo>
  <dep.groupId>com.aaa.bbb.ccc.ddd</dep.groupId>
  <dep.artifactId>core</dep.artifactId>
  <dep.version>1.1.3</dep.version>
</properties>
<organization>
<name>ABC DEF GHI</name>
</organization>
<dependencyManagement>
<dependencies>
  <dependency>
    <groupId>${dep.groupId}</groupId>
    <artifactId>${dep.artifactId}</artifactId>
    <version>${dep.version}</version>
    <type>rpm</type>
  </dependency>
</dependencies>
  ...
        <configuration>
          <executable>mkdir</executable>
          <arguments>
            <argument>${yum-repo}${dep.version}</argument>
          </arguments>
        </configuration>
      </execution>
    </executions>
  ... 
```

您应该知道，通过在*dependencyManagement*中定义一个依赖项，该依赖项将*不会*被绑定为您当前项目的依赖项。

# ruby - ruby 字符串格式格式化

> ID：10419630
> 
> 赞同：4
> 
> 时间：2012-05-02T18:32:57.587
> 
> 标签：ruby

我有一组文件名，如下所示

```
“文件001” “文件0001” ...
“文件002” “文件0002” ...
...
“文件 100” “文件 0100” ...
...

```

模式非常明显：

```
名称，填充号码
```

因此，如果我想对第一列中的文件使用字符串格式，我会写

```
"%s%3d" %[姓名，号码]"

```

但这对填充 (3) 进行了硬编码。我怎样才能做到这一点，以便我也可以将填充指定为变量，并以某种方式格式化提供的整数以使用指定的填充？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-02T18:35:26.873

使用字符串插值：

```
padding = 9
"%s%#{padding}d" %[name, number] 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-02T18:53:46.247

```
prefix = "file"
number = "1"
padding = 4
filename = prefix + number.rjust(padding, '0') #=> "file0001" 
```

# jquery - jQuery - 将 css 样式应用于输入元素

> ID：10419632
> 
> 赞同：2
> 
> 时间：2012-05-02T18:33:06.053
> 
> 标签：jquery, css, input, element

我正在尝试检查所有链接并更改断开链接字段的背景颜色。这是我的功能

```
function CheckLinks(){
$('#new_post_links_table tbody>tr').find("input").each(function() {
    UrlExists($(this).val(), function(status){
    if(status === 404){
       $(this).css('background-color','#FC0');
    }
}); });} 
```

输入字段如下所示：

```
<table id="new_post_links_table">
...
<td><input type="text" name="mp3_link[]"/></td>
<td><input type="text" name="mp4_link[]"/></td>
</tr>
</tbody>
</table> 
```

由于某种原因，css 不适用。

注意：我的 CheckLinks 功能确实有效，但`$(this).css...`部分除外。（火虫）

注意：行是动态添加的

编辑：这是功能：

```
function UrlExists(url, cb){
    jQuery.ajax({
        url:      url,
        dataType: 'text',
        type:     'GET',
        complete:  function(xhr){
            if(typeof cb === 'function')
               cb.apply(this, [xhr.status]);
        }
    });
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T18:40:04.703

夫妇的事情错了。您没有在`()`对 的调用中包含`$(this).val`，并且您`this`在回调中的引用并未引用预期的元素。

```
function CheckLinks(){
  $('#new_post_links_table tbody > tr')
    .find("input")
    .each(function(index, element) {
      UrlExists($(this).val(), function(status){
        if(status === 404) $(element).css('background-color','#FC0');
      }); 
    });
} 
```

请记住，在执行此操作时，您可能会遇到一些`Access-Control-Allow-Origin`.

您可能希望修改`UrlExists`函数以通过服务器上的代理脚本运行。您可以执行以下操作：

```
$.getJSON('checklink.php', { location: url }, function ( data ) {
  callback.apply( null, data.status );
}); 
```

在您的后端，测试 URL 并通过 JSON 发送响应：

```
$response = array( 
  'location' => $location, 
  'status' => $status 
);
echo json_encode( $response ); 
```

通过这种方式，您的 JavaScript 与您的后端进行通信，并且在源控制方面没有问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-02T18:40:25.760

我的感觉是，这不再是指输入。您应该添加一个变量来存储输入，以便您可以在闭包内访问它

```
var input = $(this);
UrlExists($(this).val(), function(status){
  if(status === 404){
     input.css('background-color','#FC0');
  }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T18:41:27.397

该函数是否知道动态添加了行？前段时间我有类似的问题。问题是 jQuery 不知道添加了一些内容的新行。尝试在函数中控制 $(this) 下的内容，并告诉我们您得到了什么结果。

# .net - 为活动报告分组

> ID：10419634
> 
> 赞同：2
> 
> 时间：2012-05-02T18:33:12.723
> 
> 标签：.net, vb.net, activereports

我有一个活跃的报告，我需要根据我的国家属性对其进行分组。我一直在查看活动报告 API 并遇到了分组。这是做到这一点的最好方法吗？我该怎么做？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-04T07:25:03.597

@ewein，

在 ActiveReports 中，分组非常简单直接。让我们考虑一下您希望对国家/地区的报告进行分组的示例。假设我们将报告绑定到 NorthWind 数据库，并且您希望每个国家/地区都希望查看相关城市。

为此，您首先需要将 Groupheader 部分添加到您的报告中。接下来，您需要为报告设置数据源。完成此操作后，您可以转到 groupheader proerties 并将其 datafield 属性设置为“Country”。还要在 groupheader 中放置一个文本框，并将其数据字段设置为“Country”。最后，您需要在详细信息部分放置一个文本框并将其数据字段设置为城市。现在，当您预览报告时，您将获得每个国家/地区的所有关联城市。

我建议您查看ActiveReports 文档中的此[链接，该链接将进一步阐明这一点。](http://helpcentral.componentone.com/NetHelp/ActiveReports6/topic148.html)[这篇博客文章](http://our.componentone.com/2012/10/26/activereports-7-display-a-continued-message-when-a-group-spans-across-pages/)也值得一看，它显示了具有一些附加功能的分组。除此之外，您可能需要查看所有的博客文章以获取有关不同 ActiveReports 功能的更多信息。

谢谢，桑卡尔普

# c# - 进行服务器聊天

> ID：10419635
> 
> 赞同：0
> 
> 时间：2012-05-02T18:33:13.120
> 
> 标签：c#, tcp

我对服务器的东西不是很熟悉，我只知道 C#，所以我对下面的代码不是很熟悉。我正在尝试使服务器聊天成为允许服务器上的人们相互聊天的那种。我说的是您在学校或工作场所拥有的那种服务器。我不确定如何执行此操作或如果它完成此操作如何使用以下代码。

总的来说，我想要完成的是在同一台服务器上的一群人之间聊天，但我遇到了很大的困难，因为我不知道很多服务器的事情。

```
using System;
using System.Drawing;
using System.Net;
using System.Net.Sockets;
using System.Text;
using System.Threading;
using System.Windows.Forms;

public class MulticastChat : Form
{
   TextBox newText;
   ListBox results;
   Socket sock;
   Thread receiver;
   IPEndPoint multiep = new IPEndPoint(IPAddress.Parse("224.100.0.1"), 9050);

   public MulticastChat()
   {
      Text = "Multicast Chat Program";
      Size = new Size(400, 380);

      Label label1 = new Label();
      label1.Parent = this;
      label1.Text = "Enter text string:";
      label1.AutoSize = true;
      label1.Location = new Point(10, 30);

      newText = new TextBox();
      newText.Parent = this;
      newText.Size = new Size(200, 2 * Font.Height);
      newText.Location = new Point(10, 55);

      results = new ListBox();
      results.Parent = this;
      results.Location = new Point(10, 85);
      results.Size = new Size(360, 18 * Font.Height);

      Button sendit = new Button();
      sendit.Parent = this;
      sendit.Text = "Send";
      sendit.Location = new Point(220,52);
      sendit.Size = new Size(5 * Font.Height, 2 * Font.Height);
      sendit.Click += new EventHandler(ButtonSendOnClick);

      Button closeit = new Button();
      closeit.Parent = this;
      closeit.Text = "Close";
      closeit.Location = new Point(290, 52);
      closeit.Size = new Size(5 * Font.Height, 2 * Font.Height);
      closeit.Click += new EventHandler(ButtonCloseOnClick);

      sock = new Socket(AddressFamily.InterNetwork, SocketType.Dgram, ProtocolType.Udp);
      IPEndPoint iep = new IPEndPoint(IPAddress.Any, 9050);
      sock.Bind(iep);
      sock.SetSocketOption(SocketOptionLevel.IP, SocketOptionName.AddMembership, new MulticastOption(IPAddress.Parse("224.100.0.1")));
      receiver = new Thread(new ThreadStart(packetReceive));
      receiver.IsBackground = true;
      receiver.Start();
   }

   void ButtonSendOnClick(object obj, EventArgs ea)
   {
      byte[] message = Encoding.ASCII.GetBytes(newText.Text);
      newText.Clear();
      sock.SendTo(message, SocketFlags.None, multiep);
   }

   void ButtonCloseOnClick(object obj, EventArgs ea)
   {
      receiver.Abort();
      sock.Close();
      Close();
   }

   void packetReceive()
   {
      EndPoint ep = (EndPoint)multiep;
      byte[] data = new byte[1024];
      string stringData;
      int recv;
      while (true)
      {
         recv = sock.ReceiveFrom(data, ref ep);
         stringData = Encoding.ASCII.GetString(data, 0, recv);
         results.Items.Add("from " + ep.ToString() + ":  " + stringData);
      }
   }

   public static void Main()
   {
      Application.Run(new MulticastChat());
   }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T18:45:20.427

虽然看起来上面的代码至少实现了与您所要求的类似的东西，但我相信您最好尝试明确您需要什么。

例如，为什么不使用一个简单的表单将聊天文本提交到服务器，然后显示给所有用户？您会将每个“聊天”存储到数据库中，并将它们全部显示在按时间排序的页面上。这可以设置为以短时间间隔（甚至[长时间轮询](http://en.wikipedia.org/wiki/Push_technology#Long_polling)）自动轮询服务器，并且在用户看来他们正在互相聊天。

虽然不是最复杂的解决方案，但我会说它似乎对你来说肯定是触手可及的。

# android - Android - 数据库文件丢失时恢复数据库清除数据库

> ID：10419637
> 
> 赞同：1
> 
> 时间：2012-05-02T18:33:19.970
> 
> 标签：android, sqlite

我找到了一个将数据库复制到文件夹作为备份并将其复制回应用程序的数据库文件夹作为恢复的[教程。](http://androidgenuine.com/?tag=export-database-android)几乎一切正常，除了一件事：当我从我的文件夹中删除备份的 .db 文件并在我的应用程序中单击“恢复”时，它会查找该文件，找不到它，然后它会覆盖整个数据库，什么都没有。这就像我清空了整个数据库。

备份：

```
try {

                    InputStream myInput;
                    OutputStream myOutput;

                    myInput = new FileInputStream("/data/data/com.me.myapp/databases/HotOrNotdbLists2");//this is
        // the path for all apps
        //insert your package instead packagename,ex:com.mybusiness.myapp

                    // Set the output folder on the SDcard
                     File directory = new File("/sdcard/MyApp/");
                    // Create the folder if it doesn't exist:
                    if (!directory.exists()) 
                    {
                        directory.mkdirs();
                    } 
                    // Set the output file stream up:

                    myOutput = new FileOutputStream(directory.getPath()+
         "/myapp.db");

                    // Transfer bytes from the input file to the output file
                    byte[] buffer = new byte[1024];
                    int length;
                    while ((length = myInput.read(buffer))>0)
                    {
                        myOutput.write(buffer, 0, length);
                    }
                    // Close and clear the streams

                    myOutput.flush();

                    myOutput.close();

                    myInput.close();
                    Toast.makeText(Settings.this, "Backup done successfully!", Toast.LENGTH_LONG).show();

                } catch (FileNotFoundException e) {
            Toast.makeText(Settings.this, "Backup unsuccessful! File cannot be created! Directory does not exist?", Toast.LENGTH_LONG).show();

                    // TODO Auto-generated catch block
                    e.printStackTrace();
                } catch (IOException e) {
            Toast.makeText(Settings.this, "Backup unsuccessful!", Toast.LENGTH_LONG).show();

                    // TODO Auto-generated catch block
                    e.printStackTrace();
                } 
```

恢复：

```
OutputStream myOutput;

                try {

                    myOutput = new FileOutputStream("/data/data/com.me.myapp/databases/HotOrNotdbLists2");

                    // Set the folder on the SDcard
                     File directory = new File("/sdcard/MyApp/");
                    // Set the input file stream up:

                    InputStream myInputs = new FileInputStream(directory.getPath()+ "/myapp.db");

                    // Transfer bytes from the input file to the output file
                    byte[] buffer = new byte[1024];
                    int length;
                    while ((length = myInputs.read(buffer))>0)
                    {
                        myOutput.write(buffer, 0, length);
                    }

                    // Close and clear the streams
                    myOutput.flush();

                    myOutput.close();

                    myInputs.close();   
                  Toast.makeText(Settings.this, "Restore done successfully!", Toast.LENGTH_SHORT).show();

                } catch (FileNotFoundException e) {
        Toast.makeText(Settings.this, "Restore unsuccessful! File not found! Directory does not exist?", Toast.LENGTH_LONG).show();

                    // TODO Auto-generated catch block
                    e.printStackTrace();
                } catch (IOException e) {   Toast.makeText(Settings.this, "Restore unsuccessful!", 
        Toast.LENGTH_SHORT).show();

                    // TODO Auto-generated catch block
                    e.printStackTrace();
                } 
```

**编辑**：我添加了杰森的答案，它仍然清除了数据库，即使我对 directoryB*错误并且**恢复不成功！文件未找到！目录/文件不存在？*信息 ？？？！？！

```
try {
                        OutputStream myOutput;   
                        myOutput = new FileOutputStream("/data/data/com.me.myapp/databases/HotOrNotdbLists2");

                        // Set the folder on the SDcard
                        File directory = new File("/sdcard/MyApp/");
                        boolean directoryB = new File("/sdcard/MyApp/", "/myapp.db").exists();
   Toast.makeText(Settings.this, "directoryB: " + directoryB, Toast.LENGTH_SHORT).show();

                        if (directoryB == true)
                        {
                           Toast.makeText(Settings.this, "File exists!", Toast.LENGTH_SHORT).show();

                        // Set the input file stream up:

                        InputStream myInputs = new FileInputStream(directory.getPath()+ "/myapp.db");

                        // Transfer bytes from the input file to the output file
                        byte[] buffer = new byte[1024];
                        int length;
                        while ((length = myInputs.read(buffer))>0)
                        {
                            myOutput.write(buffer, 0, length);
                        }

                        // Close and clear the streams
                        myOutput.flush();

                        myOutput.close();

                        myInputs.close();   
                        Toast.makeText(Settings.this, "Restore done successfully!", Toast.LENGTH_SHORT).show();
                        }
                        else
                        {
                            Toast.makeText(Settings.this, "Restore unsuccessful! File not found! Directory/file does not exist?", Toast.LENGTH_SHORT).show();
                        }

                    } catch (FileNotFoundException e) {
            //Toast.makeText(Settings.this, "Restore unsuccessful! File not found! Directory does not exist?", Toast.LENGTH_LONG).show();

                        // TODO Auto-generated catch block
                        e.printStackTrace();
                    } catch (IOException e) {   Toast.makeText(Settings.this, "Restore unsuccessful!", 
            Toast.LENGTH_SHORT).show();

                        // TODO Auto-generated catch block
                        e.printStackTrace();
                    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T18:47:49.153

在继续还原操作之前先检查文件是否存在，如下所示：

```
new File(directory, "/myapp.db").exists() 
```

`FileInputStream`如果文件不存在，将自动创建文件。

# facebook - Open Graph 用户生成照片操作审批流程

> ID：10419640
> 
> 赞同：2
> 
> 时间：2012-05-02T18:33:30.127
> 
> 标签：facebook, facebook-opengraph, photos

要提交使用用户生成的照片的操作，我必须逐步说明如何使用测试用户帐户触发该操作。

但是，由于用户生成的照片是一种特殊属性，因此在操作获得批准之前，它们不适用于测试用户。

所以，我在批准过程中给出的指示在行动被批准之前不会起作用。看来我处于catch-22的情况。

有没有办法解决这个问题？

**更新：**我们通过让他们访问我们的一个管理员帐户（然后更改密码）解决了这个问题。有点粗略，但它确实有效。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T14:58:28.290

授予管理员权限似乎也有效，但可能更简单的方法是：

1.  只需逐步截取您的发布流程如何在您的应用程序/网站上进行。然后再截取一张关于共享照片/帖子在您的 FB 时间线上的外观的屏幕截图（因为您拥有 FB 应用程序的管理员权限）。
2.  将这些作为逐步“指南/说明”html 并将链接添加到您的操作提交。
3.  等待批准；）

# php - 如何从 PHP 中的存储过程中循环遍历多个结果集？

> ID：10419642
> 
> 赞同：0
> 
> 时间：2012-05-02T18:33:35.353
> 
> 标签：php, sql-server, stored-procedures

试图从 SQL Server 2008 中的存储过程 (SP) 中获取 3 个结果集时，我有点发疯了。

*[存储过程](http://pastebin.com/dnds3KGn)*：

```
CREATE PROCEDURE db_abbTest
AS
BEGIN
        SET NOCOUNT ON;

        SELECT 1
        SELECT 2
        SELECT 3
        RETURN 0
END
GO 
```

[*PHP代码*](http://pastebin.com/PCHyQCJA)：

```
<?php

$serverName = "server";
$connectionInfo = array("UID"=> "user", "PWD" =>"pass", "Database"=>"sample_db");
$conn = sqlsrv_connect( $serverName, $connectionInfo);

if( $conn )
{
    $sql = "db_AbbTest";
    $r = sqlsrv_query($conn, $sql, null, array(
            'Scrollable' => SQLSRV_CURSOR_STATIC,
            'SendStreamParamsAtExec'    => true
        ));
    var_dump($r);
        while( $obj = sqlsrv_fetch( $r))
        {
              var_dump($obj);
              var_dump(sqlsrv_fetch_array($r));
        }
     echo "Connection established.\n";
}
else
{
     echo "Connection could not be established.\n";
     die( print_r( sqlsrv_errors(), true));
}

/* Close the connection. */
sqlsrv_close( $conn); 
```

SP 返回三个结果（3x 选择语句）但是我似乎无法从查询中获取所有结果。有任何想法吗？我试过`while(sqlsrv_fetch_object($r){//do something})` 但没有运气..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T08:09:14.470

我设法找到了解决这个问题的方法，我不得不使用一个 while 循环，然后转到下一个结果：

```
$sql = "{call db_AbbTest}";
$r = sqlsrv_query($conn, $sql, null);
$i =0;
    while( $obj = sqlsrv_fetch_object($r))
    {
            echo $i;
         print_r($obj);
         sqlsrv_next_result($r);
         $i++;
    } 
```

# semantic-web - RDFStore/查询性能

> ID：10419643
> 
> 赞同：2
> 
> 时间：2012-05-02T18:33:36.397
> 
> 标签：semantic-web

我尝试在我的应用程序中使用语义数据模型，因为它具有可扩展性。我已经阅读了 RDFStore（Sesame、Jena 等）之间的性能/规模比较以及各自的优缺点

但是，我想知道语义数据存储与传统 mysql 查询和数据库的查询性能有何影响。

RDBMS 优化了索引和查询计划，以实现更快的响应。我们是否正在失去那些拥有语义数据存储的人？有研究吗？

你能提供指针/资源吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T19:14:49.273

我认为通常关系数据库在它们重叠的任务中会比三重存储更快。但这并不完全令人惊讶，关系数据库在研发方面领先了数十年。

因此，如果您的任务很容易在关系模型和 RDF 模型中表示，那么使用关系数据库可能会更快。

但这并不是说三联商店不快速或不可扩展，这是一个谬论。它们针对存储 RDF 和回答 SPARQL 查询的要求进行了优化。我不是学者，但感觉这些领域的研究在过去十年中确实增加了很多。

我想说所有的索引都有优化，这些优化的工作方式和应用方式可能会因存储而异，因为每个查询引擎的访问模式不同，但它们已经非常优化。你不能像处理关系存储那样真正修补它们，但根据我的经验，这是最好的。数据库供应商知道他们应该如何比用户表现得更好。

大多数都有查询计划器或至少某种形式的查询优化内置到查询引擎中。

最后，三重存储比 Jena 和 Sesame 多得多，Jena 和 Sesame 主要是三重存储的*API*，尽管它们提供了 TDB 和 Sesame Native 作为他们自己开发的三重存储实现。Stardog、OWLIM、Virtuoso、4Store、Mulgara、Parliament、BigData 是我想到的其他一些产品。

简而言之，如果 RDF 适合您的应用程序，则使用它，并使用三重存储。如果关系模型更有意义，则使用标准关系数据库。如果您尝试将一个鞋拔到另一个上，您将度过一段糟糕的时光。

# jquery - 页面中的Jquery幻灯片不起作用

> ID：10419649
> 
> 赞同：0
> 
> 时间：2012-05-02T18:34:10.617
> 
> 标签：jquery, plugins, cycle

我正在尝试集成一个 jquery 幻灯片，但它不起作用。我正在使用 3 个文件 jquery、jquery 循环插件和幻灯片样式表，它们都包含在页面中，但 slidesow 没有移动。这是链接，幻灯片在 #slider ul 中。

[http://tinyurl.com/88aotym](http://tinyurl.com/88aotym)

具有js和样式表的相关文件夹是'cat-slider'。

这是head部分中的jquery函数

```
 <script type="text/javascript">

   $(function() 
   {
    $(".slider ul")
    .cycle({
        prev:   '.slider .controls .prev', 
        next:   '.slider .controls .next',
        timeout: 3000,
        pager:   '.slider .controls .pages',
        pagerAnchorBuilder: pagerFactory,
        before: function(Ec, En, o, f) 
        {           
            var classTarget = $(Ec);
            var nextClassTarget = $(En);

            classTarget = classTarget.context.attributes.rel.value;
            nextClassTarget = nextClassTarget.context.attributes.rel.value;

            $('.slider .controls .' + classTarget).removeClass('selected');
            $('.slider .controls .' + nextClassTarget).addClass('selected');
        }
    });

    // Pager Function
    function pagerFactory(idx, slide) 
    {
        var selected = (idx == 0 ? 'selected' : null);
        return '<img src="http://mysite.com/wp-content/plugins/cat- slider/images/blank.gif" width="13" height="14" class="number '+ selected + ' ' + parseInt(idx+1)+'" />';
    };
});

</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T20:02:48.157

我用一些断点检查了你的代码，结果浏览器甚至没有跳到你的脚本代码中。尝试改变这个：

```
$(function() 
   { 
```

对此：

```
$(function() { 
```

这不是开玩笑 ;) 我最近听说在 JS 中有时会使用 ';' 即使我们不想在那个地方插入，也会自动插入到行尾。也许它发生在您的代码中。

# php - 从 php 脚本启动 PHP 守护进程

> ID：10419652
> 
> 赞同：0
> 
> 时间：2012-05-02T18:34:13.097
> 
> 标签：php, curl, exec, daemon

假设我有简单的 php 守护程序脚本：

```
#!/usr/local/bin/php -q
<?php

set_time_limit(0);

while(1){
  //do something here
  if ($something == "somethingelse"){exit;}
}

?> 
```

我想**从另一个 php 脚本运行它**。最好的方法是什么？我一直在使用 curl ：

```
$url = "url to php daemon file";
$ch = curl_init($url);
curl_setopt($ch,CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch,CURLOPT_CONNECTTIMEOUT, 1);
curl_setopt($ch,CURLOPT_TIMEOUT, 1);
$not_important = curl_exec($ch);
curl_close($ch); 
```

但我正在寻找一个更好的主意，如果有的话:)。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T18:36:52.397

```
shell_exec('/foo/bar/myscript.php'); 
```

# java - 日期的自然语言生成器 (Java)

> ID：10419656
> 
> 赞同：13
> 
> 时间：2012-05-02T18:34:29.690
> 
> 标签：java, date, nlp

我正在构建一个需要用自然英语对事物进行评论的系统。有用的一件事是能够以随意的格式表达日期。我正在寻找的本质上是[Chronic](https://github.com/samtingleff/jchronic)、[Natty](http://natty.joestelmach.com/)或此问题中描述的任务的逆：[Natural Language date and time parser for java](https://stackoverflow.com/questions/1410408/natural-language-date-and-time-parser-for-java)。

这是否太过分了？我是否应该尝试在对我有意义的日期范围内滚动我自己的简单硬连线部件？或者是否有一些巧妙的方法来反转现有的解析器以吐出（甚至是乱码）描述日期的句子？

编辑 - 澄清一下，尽管*任何*类型的输出都很有趣和有用，但我对各种/创造性的输出生成特别感兴趣。即“下周”、“从现在起 7 天”、“下周四”和“下周晚些时候”都是同一日期。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-03T18:07:34.773

外面没有多少。就我个人而言，我希望看到 SimpleDateFormatter 的一种变体，称为 RelativeDateFormatter，它可以让人们创建自己的相对日期格式的变体。这是我发现的：

*   一个简单的[相对日期](http://kurtischiappone.com/programming/java/relative-date)类。
*   一个[相对日期格式化程序](http://www.java2s.com/Tutorial/Java/0040__Data-Type/Aformatterthatformatsdatestoshowtheelapsedtimerelativetosomebasedate.htm)（所以有人*已经*做了一个！）。
*   [漂亮的时间](http://ocpsoft.org/prettytime/)看起来也很合算——*而且*它在某个地方的 maven repo 中，如果你觉得那是可取的......

顺便说一句，我注意到这篇关于[为什么相对日期格式很烂](http://code.skyrocket.be/post/20337852596/why-relative-date-notations-suck-most-of-the-time)的帖子。*仅*提供相对日期可能是错误的：如果要在以后保存信息，则相对日期可能无用。在我制作的网站中，我提供了一个带有绝对日期的鼠标悬停，以及用于打印绝对日期的 CSS 规则。我想要记住的事情：考虑如何/何时查看日期。如果它们不是“现在”，那么您可能还需要考虑包括绝对日期。

# php - 使用变量调用函数时简单的Curl脚本不返回数据

> ID：10419659
> 
> 赞同：2
> 
> 时间：2012-05-02T18:34:43.200
> 
> 标签：php, curl

这是我的代码：

```
function get_data($url)
{
$ch = curl_init();
$timeout = 15;
curl_setopt($ch, CURLOPT_URL, $url);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, $timeout);
curl_setopt($ch, CURLOPT_USERAGENT, random_user_agent());
$data = curl_exec($ch);
curl_close($ch);
return $data;
}

//Grab HTML
$urllist = fopen("links.txt", "r+");
for ($j = 0; $j <= 50; $j++)
{
$post = rtrim(fgets($urllist));
echo $post;
$html = get_data($post);
echo $html; 
```

问题：当我使用时，我`get_data("http://url.com")`在 html 中获得了正确的数据。但是当我使用变量传递 url 时，`$html`什么也不返回。

$post 在我检查时拥有正确的网址。这不是正确的使用方法吗`get_data($post);`

卷曲信息给出：

我明白了：

```
array(20) { 
["url"]=> string(68) "http://secret-url.com" 
["content_type"]=> string(9) "text/html" 
["http_code"]=> int(301) 
["header_size"]=> int(255) 
["request_size"]=> int(340) 
["filetime"]=> int(-1) 
["ssl_verify_result"]=> int(0) 
["redirect_count"]=> int(0) 
["total_time"]=> float(0.095589) 
["namelookup_time"]=> float(0.012224) 
["connect_time"]=> float(0.049399) 
["pretransfer_time"]=> float(6.5E-5) 
["size_upload"]=> float(0) 
["size_download"]=> float(0) 
["speed_download"]=> float(0) 
["speed_upload"]=> float(0) 
["download_content_length"]=> float(0) 
["upload_content_length"]=> float(0) 
["starttransfer_time"]=> float(0.095534) 
["redirect_time"]=> float(0) 
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T19:11:05.983

试试这个代码。

```
function get_data($url)
{
    $ch = curl_init();
    $timeout = 15;
    curl_setopt($ch, CURLOPT_URL, $url);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, $timeout);
    curl_setopt($ch, CURLOPT_USERAGENT, random_user_agent());

    // Edit: Follow redirects
    curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true); 

    $data = curl_exec($ch);
    var_dump(curl_getinfo($ch));
    curl_close($ch);
    return $data;
}

//Grab HTML
$urllist = fopen("links.txt", "r+");
for ($j = 0; $j <= 50; $j++)
{
    if($post = rtrim(fgets($urllist)))
    {
        echo $post;
        echo get_data($post);
    }
    else
    {
        echo "No URL provided!";
    }

    echo "\n<hr>\n";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T18:44:36.400

够`$html = file_get_contents($url);`了吗？正如记录显示的那样，它没有=）

编辑以合理的答案总结对话；

将您的 curl 更改为以下，包含 FOLLOWLOCATION 指令，可选择使用 MAXREDIRS 约束 curl

```
function get_data($url) {
    $ch = curl_init();
    $timeout = 15;
    curl_setopt($ch, CURLOPT_URL, $url);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
    // follow Location: newurl.tld - i.e. HTTP 30X status codes
    curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);
    // give up follow location if circular after 5 tries
    curl_setopt($ch, CURLOPT_MAXREDIRS, 5);
    curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, $timeout);
    curl_setopt($ch, CURLOPT_USERAGENT, random_user_agent());
    $data = curl_exec($ch);
    // if in doubt, whats going on, look through info of curl_getinfo($ch);
    // var_dump(curl_getinfo($ch));
    curl_close($ch);
    return $data;
}
//Grab HTML
$urllist = fopen("links.txt", "r+");
for ($j = 0; $j <= 50; $j++) {
    $post = rtrim(fgets($urllist));
    echo $post;
    $html = get_data($post);
    echo $html;
} 
```

可选地，由于您似乎不止一次这样做，返回到您的 links.txt 页面 - 设置一个 cookie 容器，允许访问知道您以前去过那里 - 并在连续运行中重复使用该信息

```
// filehandle, writeable by httpd user:
$cookie_file = "/tmp/cookie/cookie1.txt";
// set request to parse cookies and send them with corresponding host requests
curl_setopt($ch, CURLOPT_COOKIEJAR, $cookie_file);
// set response cookies to be saved
curl_setopt($ch, CURLOPT_COOKIEFILE, $cookie_file); 
```

# jquery - XML 解析的测试返回

> ID：10419663
> 
> 赞同：0
> 
> 时间：2012-05-02T18:34:51.040
> 
> 标签：jquery, jquery-mobile

我正在尝试将输入文本的值与 Ajax 请求的返回值进行比较，但我不知道为什么测试不起作用。我正在研究Phonegap。这是我的代码：

```
var contenu = $("#champ").val() ;
$("#envoi_search").click(function() {
    $.ajax({
        type: "POST",
        url: "http://www.edumobile.org/blog/uploads/XML-parsing-data/Data.xml",
        data: "{}",
        cache: false,
        dataType: "xml",
        success: function(data) {
                            $(data).find("Book").each(function () {
                                if($(this).find("name").text() == contenu) {
                                    $("#result").append("<br> Titre : " + $(this).find("name").text());
                                    $("#result").append("<br> Auteur : " + $(this).find("address").text());
                                    $("#result").append("<br> Pays : " + $(this).find("country").text());
                                }
                            });
                            if($("#result").is(':empty')) {
                                $("#error").append("Désolé Aucun livre n\'a été trouvé") ;
                            }
                        }
    });
}); 
```

你对这个问题有什么想法吗？十分感谢 ：-）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T20:31:44.667

您无法使用 JavaScript 访问跨域资产。

这是一个例子：http: [//jsfiddle.net/MVzgL/](http://jsfiddle.net/MVzgL/)

这是错误输出：

> XMLHttpRequest 无法加载 [http://www.edumobile.org/blog/uploads/XML-parsing-data/Data.xml](http://www.edumobile.org/blog/uploads/XML-parsing-data/Data.xml)。Access-Control-Allow-Origin 不允许来源[http://fiddle.jshell.net 。](http://fiddle.jshell.net)

因此，如果您在除此之外的任何域上运行此代码，`www.edumobile.org`它将无法运行。但是，您可以设置一个服务器端代理来获取远程内容，然后从您的 JS 调用代理，因为它将位于同一个域中。设置这个代理非常简单，您只需请求信息，然后将其输出到 JS（许多服务器端语言都有本机 JSON 编码）。

# python - pgBouncer 如何帮助加速 Django

> ID：10419665
> 
> 赞同：30
> 
> 时间：2012-05-02T18:34:56.903
> 
> 标签：python, django, postgresql, connection-pooling, pgbouncer

我有一些基于 gevent 的管理命令。由于我的管理命令发出数千个请求，因此我可以使用 Gevent 将所有套接字调用转换为非阻塞调用。这确实加快了我的应用程序，因为我可以同时发出请求。

目前，我的应用程序的瓶颈似乎是 Postgres。这似乎是因为用于连接 Django 的 Psycopg 库是用 C 编写的，不支持异步连接。

我还读到使用 pgBouncer 可以将 Postgres 加速 2 倍。这听起来不错，但如果有人能解释 pgBouncer 如何工作和提供帮助，那就太好了？

谢谢

* * *

## 回答 #1

> 赞同：103
> 
> 时间：2012-05-02T19:37:03.453

除了节省连接和断开连接的开销之外，连接池可以将大量的客户端连接汇集到少量的实际数据库连接。在 PostgreSQL 中，活动数据库连接的最佳数量通常在**((2 * core_count) + Effective_spindle_count)**左右。超过这个数字，吞吐量和延迟都会变得更糟。 **注意：**最近的版本提高了并发性，所以在 2022 年我会推荐类似**((4 * core_count) + effective_spindle_count)**的东西。

有时人们会说“我要支持 2000 个用户，响应时间快”。几乎可以保证，如果您尝试使用 2000 个实际数据库连接来执行此操作，性能将非常糟糕。如果您有一台具有四个四核处理器的机器并且活动数据集被完全缓存，那么通过将请求汇集到大约 35 个数据库连接，您将看到这 2000 个用户的性能要好得多。

要理解为什么这是真的，这个思想实验应该会有所帮助。考虑一个假设的数据库服务器机器，它只有一个资源可以共享——一个内核。该核心将在所有并发请求之间平等地进行时间切片，而不会产生开销。假设有 100 个请求同时进入，每个请求都需要一秒钟的 CPU 时间。核心对所有这些都起作用，在它们之间进行时间切片，直到它们都在 100 秒后完成。现在考虑如果您在前面放置一个连接池会发生什么情况，该连接池将接受 100 个客户端连接，但一次只向数据库服务器发出一个请求，将在连接繁忙时到达的所有请求放入队列中。现在当 100 个请求同时到达时，一个客户端在 1 秒内得到响应；另一个在 2 秒内得到响应，最后一个客户端在 100 秒内得到响应。没有人需要等待更长的时间才能得到响应，吞吐量是一样的，但平均延迟是 50.5 秒而不是 100 秒。

一个真正的数据库服务器有更多的资源可以并行使用，但同样的原则是，一旦它们饱和，你只会通过添加更多的并发数据库请求来伤害事情。它实际上比示例更糟糕，因为任务越多，任务切换越多，锁和缓存争用增加，L2 和 L3 缓存行争用，以及许多其他会影响吞吐量和延迟的问题。最重要的是，虽然高`work_mem`设置可以通过多种方式帮助查询，但该设置是*每个连接的每个计划节点*的限制，因此对于大量连接，您需要将其保持在非常小以避免刷新缓存或甚至导致交换，这会导致计划变慢或哈希表溢出到磁盘之类的事情。

一些数据库产品有效地在服务器中构建了一个连接池，但是 PostgreSQL 社区的立场是，由于最好的连接池是在更接近客户端软件的地方完成的，他们将把它留给用户来管理。大多数池化程序将有一些方法将数据库连接限制为一个硬数字，同时允许更多的并发客户端请求，并根据需要对它们进行排队。这就是你想要的，它应该在*事务*的基础上完成，而不是每个语句或连接。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-05-02T18:39:19.070

PgBouncer 通过充当维护连接池的代理来减少建立连接的延迟。如果您要打开许多与 Postgres 的短期连接，这可能有助于加快您的应用程序。如果您只有少量的连接，您将看不到太多的胜利。

# java - JTextArea 没有列出结果

> ID：10419667
> 
> 赞同：0
> 
> 时间：2012-05-02T18:35:01.223
> 
> 标签：java, swing, rss, textarea

我正在尝试来自该网站的 RSS Feed 代码 (http://javamix.wordpress.com/category/programs/rss-feed/) 它运行良好。我想改为在 GUI 中显示结果。我创建了一个 JTextArea 来附加元素，但结果是“加载”而不是被列出。谢谢。

原来的：

```
System.out.println("Title: " + getElementValue(element,"title"));
System.out.println("Link: " + getElementValue(element,"link"));
System.out.println("Publish Date: " + getElementValue(element,"pubDate")); 
```

我创建了一个 JTextArea 来显示结果：

```
for (int i-0; i<nodes.getLength();i++)
{
     Element element = (Element)nodes.item(i);

     JTextArea textArea = new JTextArea();
     textArea.setBounds(10, 11, 864, 540);
     textArea.setWrapStyleWord(true);
     getContentPane().add(textArea);

     textArea.append("Title: " + getElementValue(element,"title") + "\n");
     textArea.append("Link: " + getElementValue(element,"link") + "\n");
     textArea.append("Publish Date: " + getElementValue(element,"pubDate") + "\n"); 
} 
```

我是新用户，不允许上传图片，但有链接 :) 我需要显示在 GUI 中的完整结果列表。

我的结果（标题、链接、发布日期在结果加载时保持不变）>>> 参考截图[我的结果](http://i.stack.imgur.com/b6ix8.png)

控制台（结果的完整列表）>>> 参考截图[控制台](http://i.stack.imgur.com/2f3Tj.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T19:04:25.603

您`TextArea`每次都在循环中制作新内容。将 to 的声明和实例化移动`TextArea`到循环之前。

像这样：

```
JTextArea textArea = new JTextArea();
textArea.setBounds(10, 11, 864, 540);
textArea.setWrapStyleWord(true);
getContentPane().add(textArea);
for (int i = 0; i < nodes.getLength();i++)
{
     Element element = (Element)nodes.item(i);

     textArea.append("Title: " + getElementValue(element,"title") + "\n");
     textArea.append("Link: " + getElementValue(element,"link") + "\n");
     textArea.append("Publish Date: " + getElementValue(element,"pubDate") + "\n"); 
} 
```

# php - 将表单值存储在数据库中

> ID：10419668
> 
> 赞同：0
> 
> 时间：2012-05-02T18:35:04.157
> 
> 标签：php

我有一个表单，其中我使用二维数组作为字段名称。字段名称如下

我的表格[消息][]

我的表格[名称][]

我的表格[添加][]

这意味着有三个数组。每个数组里面都有数组。当我在输入值并提交它之后 var_dump 我的表单时。我得到了下面的二维数组结构。

```
array
  ''message'' => 
    array
      0 => string 'adnan' (length=5)
      1 => string 'khan' (length=4)
      2 => string 'salman' (length=6)
  ''name'' => 
    array
      0 => string 'khan' (length=4)
      1 => string 'kamran' (length=6)
      2 => string 'khan' (length=4)
  ''add'' => 
    array
      0 => string 'asad' (length=4)
      1 => string 'khan' (length=4)
      2 => string 'abrar' (length=5) 
```

正如您所看到的关联数组。我想将消息、名称和添加的值存储在一个具有三个字段的数据库表中，以通过使用类似 foreach 的循环在单个查询中存储消息、名称和添加字段的值。当我使用此代码时

```
foreach($_REQUEST['myform'] as $val)
 foreach($val as $v)

  {
    echo $v;
  } 
```

我得到了数组的所有值。但我想我无法将它保存到数据库表中

因为所有的值都在变量 $v 中。如何将消息存储在消息字段中，名称字段中的名称以及添加到数据库表中的添加字段中。

请指教。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T18:38:41.597

```
foreach($_REQUEST['myform'] as $field=>$val)
 // $field is the key
 foreach($val as $v)

  {
    echo $field . ' ' . $v;
  } 
```

这将为您提供要使用的字段名称。我假设您已经知道如何将条目插入数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T18:46:53.560

首先确保消息、名称和添加数组的长度相等，然后您可以使用此代码访问所有值：

```
foreach($_REQUEST['myform'] as $val)
{
    for($i=0;$i<count($val['message']);$i++){
        echo $val['message'][$i].'<br/>';
        echo $val['name'][$i].'<br/>';
        echo $val['add'][$i].'<br/>';
    }
} 
```

# types - Open GL ES - GLenum vs Glint 和 GLint vs GLsizei 之间的区别

> ID：10419670
> 
> 赞同：2
> 
> 时间：2012-05-02T18:35:11.960
> 
> 标签：types, opengl-es

Open GL 中有一个名为 GLenum 的数据类型，它可以容纳从 0 到 4,294,967,295 的数据。我在任何地方使用过它，我从未发现它和 GLInt 之间有任何区别。我无法理解的另一种数据类型是 GLsizei，因为它与 Glint 完全相同（至少看起来如此。） GLenum 和 GLsizei 的用途是什么，它们与 Glint 有何不同？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T18:50:32.663

这些名字有点暴露了目的。`GLenum`用于枚举。`GLsizei`适用于尺寸。这些不是这里复杂的概念。OpenGL 只是在值和类型之间提供一些语义关联。

如果一个函数需要 a `GLenum`，那么您应该将其中一个`GL_...`枚举器传递给它。如果它需要一个`GLsizei`，你应该传递一个大小。它们的不同之处`GLint`在于它们的*含义不同*，而不是它们更大或更小。

大小无关紧要；重要的是你用它做什么。

# c# - 如何：在不进行拒绝服务攻击的情况下从站点获取数据/知道站点上何时有已知数据

> ID：10419695
> 
> 赞同：-1
> 
> 时间：2012-05-02T18:36:42.050
> 
> 标签：c#, httpwebrequest, webclient, ddos

我正在尝试使用 httpwebrequest\webclient 从站点获取数据，所以我正在做的是每 30 秒发送一个请求以获取站点的 html。

发生的事情是该站点阻止我进行拒绝服务攻击，因为我从计算机发送了太多请求。

如果不每 30 秒获取一次数据，我如何知道网站上何时有新数据？

或者

如何每 30 秒从站点获取数据而不会因拒绝服务攻击而被阻止？

好的，所以我添加了一些代码：

```
public void DownloadFile(String remoteFilename, String localFilename)
{
            Stream remoteStream = null;
            Stream localStream = null;
            HttpWebRequest gRequest = (HttpWebRequest)WebRequest.Create(remoteFilename);
            gRequest.UserAgent = "Mozilla/5.0 (Windows; U; Windows NT 6.1; en-GB; rv:1.9.1.8) Gecko/20100202 Firefox/3.5.8 GTBDFff GTB7.0";

            gRequest.CookieContainer = new CookieContainer();
            gRequest.Accept = " text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8, */*";
            gRequest.KeepAlive = true;
            gRequest.ContentType = @"application/x-www-form-urlencoded";

            #region CookieManagement
            if (gCookies != null && gCookies.Count > 0)
            {
                gRequest.CookieContainer.Add(gCookies);
            }

            HttpWebResponse gResponse;

            try{
                gResponse = (HttpWebResponse)gRequest.GetResponse();

                //check if the status code is http 200 or http ok

                if (gResponse.StatusCode == HttpStatusCode.OK)
                {
                    remoteStream = gResponse.GetResponseStream();
                    localStream = File.Create(localFilename);
                    byte[] buffer = new byte[1024];
                    int bytesRead;

                    do
                    {
                        // Read data (up to 1k) from the stream
                        bytesRead = remoteStream.Read(buffer, 0, buffer.Length);

                        // Write the data to the local file
                        localStream.Write(buffer, 0, bytesRead);
                    } while (bytesRead > 0);
                }
                else
                {
                    MessageBox.Show("Error!");
                    Application.Exit();
                }

                if (gResponse != null) gResponse.Close();
                if (remoteStream != null) remoteStream.Close();
                if (localStream != null) localStream.Close();
            }
            catch (Exception e)
            {
                MessageBox.Show(e.ToString());
                Application.Exit();
            }
            #endregion
        } 
```

在计时器中：

```
DownloadFile("http://www.fxp.co.il/forumdisplay.php?f=2709", @"C:\tmph.html"); 
```

所以这个论坛是一个买卖论坛，所以我想做的是每 30 秒获取一次论坛 html，使用 htmlagilitypack 检查 html 中未读“购买”帖子的数量。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T21:15:53.807

您可以使用更长的轮询间隔并执行 HEAD 请求以避免获取整个文档。您可以解析返回的标头，并且仅在它与前一个标头不同时才执行 GET。

# sql-server-2008 - SQL Server 2000 到 SQL Server 2008：可以将 2000 数据库恢复到 2008 架构吗？

> ID：10419698
> 
> 赞同：2
> 
> 时间：2012-05-02T18:36:47.247
> 
> 标签：sql-server-2008, schema, sql-server-2000, database-restore

假设我们有两个 SQL Server 2000 数据库：

```
 PARTS
           CUSTOMERS 
```

是否可以将它们还原到 SQL Server 2008 到一个组合数据库中，但使用模式分开，所以会有一个 PARTS 模式和一个 CUSTOMERS 模式？可以将 2000 数据库还原为“2008 模式”吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T18:39:24.107

> 问：是否可以将 2000 数据库恢复到 2008 模式？

答：是的。如果你有一个 .bak 备份文件，你应该可以简单地“恢复”。

以下是在进行类似恢复时遇到问题的人的链接，以及解决方法：

*   [http://social.msdn.microsoft.com/Forums/en/sqlsetupandupgrade/thread/ce5e84f9-95a2-4c8a-80ab-abaf3e261afc](http://social.msdn.microsoft.com/Forums/en/sqlsetupandupgrade/thread/ce5e84f9-95a2-4c8a-80ab-abaf3e261afc)

你绝对可以做一个“用替换恢复”。

一旦您恢复了旧的 MSSQL 2000 备份（例如到临时数据库），您可以执行“选择到”或任何您想要复制和/或合并数据到不同数据库（可能使用不同模式）的操作。

就“备份”文件而言，在 MSSQL 2008 环境中使用 MSSQL 2000 备份的问题相对较少——兼容性非常好。

恕我直言.. PSM

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-02T18:39:42.530

您不能将两个数据库还原到一个数据库中。您需要单独恢复每个数据库，然后手动组合它们。或者，您可以为每个数据库创建一个 T-SQL 脚本，将两个脚本适当组合，然后执行该脚本。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-02T18:41:17.833

如果不利用架构在 2008 实例上操作恢复的数据库，我认为您无法实现您的目标。

当您备份源数据库（在您的情况二）时，它包含在目标上，它将按原样恢复，这是重点，避免副本之间的任何差异。因此，根据定义，它不应允许您获得与备份数据库在结构上不同的还原结果。

实现此目的的一种方法是首先处理备份/恢复过程，然后编写一个脚本，获取恢复的数据库并将它们组合到您希望拥有的实际结构中。

我希望这可以帮到你。

# ios - 应用内购买第一次运行良好，但如果我再试一次，它会多次执行代码

> ID：10419701
> 
> 赞同：1
> 
> 时间：2012-05-02T18:36:58.910
> 
> 标签：ios, xcode, in-app-purchase

我第一次购买 3 个提示时效果很好，如果我尝试第二次或第三次使用它，它会一直说“您已购买 3 个提示！” 几次，我找不到它有什么问题

```
#import "HSStore.h"
@implementation HSStore

-(IBAction)purchaseHints:(id)sender {

    askToPurchase = [[UIAlertView alloc] 
                     initWithTitle:@"Purchase Hints" 
                     message:@"Purchase 3 Hints?"
                     delegate:self 
                     cancelButtonTitle:nil
                     otherButtonTitles:@"Yes", @"No", nil]; 
    askToPurchase.delegate = self;
    [askToPurchase show];
}

#pragma mark StoreKit Delegate
-(void)paymentQueue:(SKPaymentQueue *)queue updatedTransactions:(NSArray *)transactions       {
    for (SKPaymentTransaction *transaction in transactions) {
        switch (transaction.transactionState) {

            case SKPaymentTransactionStatePurchasing:{
            }
                break;
            case SKPaymentTransactionStatePurchased:{
                UIAlertView *tmp = [[UIAlertView alloc] 
                                    initWithTitle:@"Complete" 
                                    message:@"You have purchased 3 Hints!"
                                    delegate:self 
                                    cancelButtonTitle:nil 
                                    otherButtonTitles:@"Ok", nil]; 
                [tmp show];

                //Add Hints
                [self addHints];
                [self completeTransaction:transaction];

                }   

                break;
            case SKPaymentTransactionStateRestored:{
                [[SKPaymentQueue defaultQueue] finishTransaction:transaction];
            }

                break;

            case SKPaymentTransactionStateFailed:{

                if (transaction.error.code != SKErrorPaymentCancelled) {

                   NSLog(@"Error payment cancelled %d",transaction.error.code);

                }

                [[SKPaymentQueue defaultQueue] finishTransaction:transaction];

            }

                break;

            default:

                break;

        }

    }

}

- (void) completeTransaction: (SKPaymentTransaction *)transaction

{

    // Remove the transaction from the payment queue.

    [[SKPaymentQueue defaultQueue] finishTransaction: transaction];

}

- (void)finishTransaction:(SKPaymentTransaction *)transaction wasSuccessful:(BOOL)wasSuccessful

{
    // remove the transaction from the payment queue.

    [[SKPaymentQueue defaultQueue] finishTransaction:transaction];
}
-(void)productsRequest:(SKProductsRequest *)request didReceiveResponse:(SKProductsResponse *)response  
{  

    SKProduct *validProduct = nil;

    int count = [response.products count];

   if (count>0) {

        validProduct = [response.products objectAtIndex:0];
        SKPayment *payment = [SKPayment paymentWithProduct:validProduct];
        [[SKPaymentQueue defaultQueue] addTransactionObserver:self];
        [[SKPaymentQueue defaultQueue] addPayment:payment];
    } 
else {
        UIAlertView *tmp = [[UIAlertView alloc] 
                            initWithTitle:@"Not Available" 
                            message:@"No products to purchase"

                            delegate:self 

                            cancelButtonTitle:nil 

                            otherButtonTitles:@"Ok", nil]; 

        [tmp show];
    }
}  

-(void)requestDidFinish:(SKRequest *)request  
{  

}  

-(void)request:(SKRequest *)request didFailWithError:(NSError *)error  
{  
    NSLog(@"Failed to connect with error: %@", [error localizedDescription]);  
}  

#pragma mark AlertView Delegate

-(void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex {
    if (alertView==askToPurchase) {
        if (buttonIndex==0) {
            // user tapped YES, but we need to check if IAP is enabled or not.

            if ([SKPaymentQueue canMakePayments]) { 
                SKProductsRequest *request = [[SKProductsRequest alloc] initWithProductIdentifiers:[NSSet setWithObject:@"Buy3Hints"]];  
                request.delegate = self;  

                [request start];  
            } else {
                UIAlertView *tmp = [[UIAlertView alloc] 

                                    initWithTitle:@"Prohibited" 

                                    message:@"Parental Control is enabled, cannot make a purchase!"

                                    delegate:self 

                                    cancelButtonTitle:nil 

                                    otherButtonTitles:@"Ok", nil]; 

                [tmp show];
            }

        }
    }
}

-(void) addHints {
    //Load Hints

    NSUserDefaults *totalHints = [NSUserDefaults standardUserDefaults];

    NSNumber *loadHints = [totalHints objectForKey:@"hintsTotal"];

    hintsLeft = [loadHints intValue];

    //Add 3 Hints
    hintsLeft = hintsLeft + 3;
    //Store Hints Left
    NSNumber *storeHints = [NSNumber numberWithInt:hintsLeft];

    NSUserDefaults *storeTotalHints = [NSUserDefaults standardUserDefaults];

    [storeTotalHints setObject:storeHints forKey:@"hintsTotal"];

    [storeTotalHints synchronize];
}

- (void)viewDidLoad
{
    [super viewDidLoad];

     // Do any additional setup after loading the view, typically from a nib.
}

- (void)viewDidUnload
{
    [super viewDidUnload];

    // Release any retained subviews of the main view.
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation

{
    return (interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown);
}
@end 
```

# javascript - Node.js TypeError：未定义不是函数

> ID：10419705
> 
> 赞同：0
> 
> 时间：2012-05-02T18:37:10.490
> 
> 标签：javascript, node.js, mongoose

我试图在我的模型用户上调用这个函数（我正在使用猫鼬）。像这样：

```
UserSchema.statics.exists = function exists(req,email, callback) {
    this.findOne({
        email : email
    }, function(err, user,callback) {
        if(err) {
            console.error(err);
            return callback(err);
        }
        if(!user) {
            // console.log("Not user");
            return callback(null, false);// produce error
        }
        if(!user.valid) {
            console.log("User invalid");
            var hostname = req.headers.host;
            // hostname = 'localhost:8080'
            //var pathname = url.parse(req.url).pathname; // pathname = '/MyApp'

            var base_url = 'http://' + hostname + '/activation?key=' + user.account_no;
            user.verifyEmail(base_url, user, function(err, result) {
                if(err) {
                    console.error(err);
                return  callback(err);
                } else {
                    //if(email sent)
                    if(result) {
                    return  callback("Please check your email to activate your account");
                    } else {
                    return  callback("Activation error please contact WOWITO support");
                    }
                }
            });
        }
        return callback(null, user);
    });
} 
```

但后来我收到以下错误：

node.js:201 抛出 e；// process.nextTick 错误，或第一次滴答时的 'error' 事件 ^ TypeError: undefined is not a function

我做错什么了？

谢谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T18:57:38.813

您`callback`目前有 2 个不同的变量：

```
UserSchema.statics.exists = function exists(req, email, callback) { // 1st
    this.findOne({
        email : email
    }, function(err, user, callback) { // 2nd
    // ... 
```

由于它们共享相同的标识符，第二个将“遮蔽”第一个，使匿名函数中的第一个不可访问。

要使用第一个，您必须重命名其中一个 - 也许，`existsCallback`和/或`findOneCallback`.

您也可以完全删除第二个，因为`undefined`无论如何它似乎是：

```
UserSchema.statics.exists = function exists(req, email, callback) {
    this.findOne({
        email : email
    }, function(err, user) {
    // ... 
```

您还假设正在为 传递一个值`callback`，而 JavaScript 实际上并不要求或强制执行该值。

您可以通过在调用之前测试一个值来解决此问题：

```
if (callback) callback(...); 
```

或者在未定义时将其设置为“无操作”功能：

```
callback = callback || function() { return true; };
//...
callback(...); 
```

# asp.net-mvc - 如何在 C# 中为 MVC 创建我自己的值为“00”和“”的 SelectList？

> ID：10419709
> 
> 赞同：5
> 
> 时间：2012-05-02T18:37:45.607
> 
> 标签：asp.net-mvc, asp.net-mvc-3

我的操作中有以下代码：

```
 ViewBag.AccountId = new SelectList(_reference.Get("01")
            .AsEnumerable()
            .OrderBy(o => o.Order), "RowKey", "Value", "00"); 
```

在我看来：

```
@Html.DropDownList("AccountID", null, new { id = "AccountID" }) 
```

现在我想动态地创建列表，所以在我的操作中，我只想用以下值硬编码一个简单的 SelectList：00 和“”，这样当我转到我的视图时，我只会看到一个空白的选择框。

有人可以解释我如何在 C# 中做到这一点。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-02T18:48:05.650

在您的控制器中：

```
var references = _reference.Get("01").AsEnumerable().OrderBy(o => o.Order);

List<SelectListItem> items = references.Select(r => 
    new SelectListItem()
    {
        Value = r.RowKey,
        Text = r.Value
    }).ToList();

var emptyItem = new SelectListItem(){
    Value = "",
    Text  = "00"
};

// Adds the empty item at the top of the list
items.Insert(0, emptyItem);

ViewBag.AccountIdList = new SelectList(items); 
```

在您看来：

```
@Html.DropDownList("AccountID", ViewBag.AccountIdList) 
```

请注意，无需添加，`new { id = "AccountId" }`因为 MVC 无论如何都会为控件提供该 ID。

**编辑：**

如果您只需要一个空的下拉列表，为什么要在控制器中创建一个非空的选择列表？

无论如何，这是你可以做的（视图代码保持不变）：

```
List<SelectListItem> items = new List<SelectListItem>();

var emptyItem = new SelectListItem(){
    Value = "",
    Text  = "00"
};

items.Add(emptyItem);

ViewBag.AccountIdList = new SelectList(items); 
```

# objective-c - 打开 MainMenu.xib 时出错

> ID：10419711
> 
> 赞同：4
> 
> 时间：2012-05-02T18:37:56.430
> 
> 标签：objective-c, xcode

当我尝试打开文件 MainMenu.xib 时，我写完应用程序以重新打开项目后第二次：

无法打开文档“MainMenu.xib”。操作无法完成。*** -[__NSArrayM insertObject:atIndex:]: 对象不能为 nil。
这是控制台中出现的内容：

02/05/12 20:35:11,640 Xcode：解码文档对象时引发异常 - *** -[__NSArrayM insertObject:atIndex:]: object cannot be nil

但是如果我构建并运行应用程序工作美好的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-03T11:17:29.697

我找到了我的问题的解决方案，我分享以防其他人处于同样的情况。XIB 文件未打开，似乎已损坏。想了想最近做了哪些改变。最后的改变是在界面的按钮上增加了声音。特别是，我添加了一个声音来在表格中放置一个复选框。为了解决这个问题，我将XIB文件作为源代码打开，然后我找到了包含插入声音的行并取消了。现在一切都像以前一样工作。我希望我对某人有所帮助。

# php - 在 php url 中，我可以使用类似 ?name=Item+Name 的东西吗？

> ID：10419718
> 
> 赞同：0
> 
> 时间：2012-05-02T18:38:21.537
> 
> 标签：php, url, dynamic

我管理的网站使用 php url 为每个产品动态显示 detail.php（对 php 还是新手，请多多包涵）。

目前看起来像这样：

```
domain.com/detail.php?id=123 
```

我可以使用不同的属性（不确定它是否是这样的），这样我就可以拥有更多用户友好的网址？

像：

```
domain.com/detail.php?name=Product+Name 
```

如果是这样……怎么办？对于我的一生，我无法弄清楚或搜索正确的术语（可能只是还不知道它们的正确名称）。我认为它会很简单，因为 %20 而不是空格，但正如你们可能都知道的那样，这并没有做到。

我将名称设置为 varchar，但我不知道这是否会有所不同。

任何帮助表示赞赏，这不是一件紧急的事情。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-02T18:43:56.627

有几种不同的方法可以实现你想要的。无需直接深入 PHP 代码来更改底层逻辑，您可以查看在 Apache 实现中启用和配置 mod_rewrite。这是一个快速简单的 mod_rewrite 教程：

[http://www.htmlist.com/how-to/a-simplemod_rewrite-tutorial/](http://www.htmlist.com/how-to/a-simplemod_rewrite-tutorial/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T18:40:27.463

查看在 PHP 中处理 URL 的函数：[http](http://www.php.net/manual/en/ref.url.php) ://www.php.net/manual/en/ref.url.php 。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-02T18:58:31.347

我真的不确定你在哪里遇到麻烦。这个非常基本的例子对我来说很好用：

```
<?php
    if (isset($_GET["name"]))
        die("name = {$_GET["name"]}");    /* outputs "name = Product Name" */

    $row = "Product Name";
?><a href="test.php?name=<?php echo $row; ?>">Click here</a> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-02T18:42:21.577

您可能正在寻找对[`urlencode()`](http://www.php.net/manual/en/function.urlencode.php)字符串进行编码的 PHP 方法，以便可以将其作为查询字符串变量传递。然后，您可以用户[`urldecode()`](http://www.php.net/manual/en/function.urldecode.php)解码查询字符串变量。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-02T18:42:53.703

您可能没有正确构建查询，这意味着您很容易受到 SQL 注入攻击。从查询中检索字符串值与检索整数没有什么不同，但是稍后如何使用该字符串确实会产生巨大的差异：

```
$name = $_GET['name'];
$safe_name = mysql_real_escape_string($name);
$sql = "SELECT ... FROM yourtable WHERE name='$safe_name'";
$result = mysql_query($sql) or die($sql); 
```

在查询中使用字符串时，它们必须用引号括起来。如果不是，它们将被视为字段名、表名等......

# cloud - 在云计算的背景下，弹性和可扩展性这两个术语是什么意思？

> ID：10419720
> 
> 赞同：0
> 
> 时间：2012-05-02T18:38:26.527
> 
> 标签：cloud, scalability, distributed-computing, elasticity

我最近阅读了很多关于云计算的内容，并且经常使用弹性和可扩展性这两个术语。我一直在尝试为它们找到一些硬定义，但许多不同的网站似乎对它们的确切含义有不同的想法。我认识到它们在不同的上下文中可能意味着不同的东西，但我想我会向堆栈溢出社区询问他们的想法。

谢谢！

-大卫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T18:43:29.410

简单地说：可扩展性意味着处理大量事务的能力。

弹性意味着系统可以根据流量需求引入其他资源（即添加数据库、cpu、缓存）或停用它们

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-12-05T13:57:22.347

我认为，可扩展性 - 系统增加其现有硬件资源工作量的能力。弹性——系统增加其现有和额外硬件资源的工作负载的能力。我对云的了解越来越多，而起初我对它们一无所知，因为我接触了我的组织工作和存储方法。他们与 Stratoscale 合作。我通过他们的网站了解了很多关于云计算的知识，这让我很着迷。

# php - PHP中的URL编码正则表达式解析问题

> ID：10419723
> 
> 赞同：1
> 
> 时间：2012-05-02T18:38:41.750
> 
> 标签：php, regex

所以，我已经对一个试图解析某些字段的单词文档进行 URL 编码……这很痛苦。尽管有一些“意外”的结果，但除了这个之外，我的一切都运行良好。

以下是 Word 中 99.8% 的结果的输出示例：

> %13+FORMTEXT+%01%14wes%15

通常，我设置的正则表达式完全按照我的需要抓取所有字段，例如上面的示例。但是下面的例子是一个奇怪的例子。试图从底部示例中解析出“wes”。

> %13+FORMTEXT+%01%15%86%15%9A%9C%9E%A0%F2%F4%0A%1A%1C%1E+468%3A%3C%3E%40TVXZ%5C%15%60bvxz%FC %F0%E0%14%D4%C1%06%14wes%15

请注意，这是一个大字符串，所以它会以这种方式继续：

```
%13+FORMTEXT+%01%15%86%15%9A%9C%9E%A0%F2%F4%0A%1A%1C%1E+468%3A%3C%3E%40TVXZ%5C%15%60bvxz%FC%F0%E0%14%D4%C1%06%14wes%15%13+FORMTEXT+%01%14wess%15 
```

请注意 %01 和 %14 之间的巨大差距，然后是 %14 和 %15 之间的文本。通常 %01%14 是并排的，在这种情况下它们之间有废话......很多，这在示例中被缩短了。

干杯，韦斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T13:57:18.187

走了一条不同的路线，将文档转换为 docx/ooxml 并在 XML 上使用正则表达式。

# gwt - 延迟绑定失败

> ID：10419724
> 
> 赞同：2
> 
> 时间：2012-05-02T18:38:48.100
> 
> 标签：gwt, dependency-injection, guice, gwt-gin

我的应用程序正在抛出：

```
java.lang.RuntimeException: Deferred binding failed for 'com.mygwtapp.client.gin.ClientAppGinjector' (did you forget to inherit a required module?) 
```

在入口点内的这段代码上：

```
private final ClientAppGinjector injector = GWT.create(ClientAppGinjector.class); 
```

可能是什么问题呢？

**这是完整的错误日志：**

```
java.lang.RuntimeException: Deferred binding failed for 'com.mygwtapp.client.gin.ClientAppGinjector' (did you forget to inherit a required module?)
    at com.google.gwt.dev.shell.GWTBridgeImpl.create(GWTBridgeImpl.java:53)
    at com.google.gwt.core.client.GWT.create(GWT.java:97)
    at com.mygwtapp.client.MainEntryPoint.<init>(MainEntryPoint.java:79)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
    at java.lang.reflect.Constructor.newInstance(Constructor.java:525)
    at com.google.gwt.dev.shell.ModuleSpace.rebindAndCreate(ModuleSpace.java:465)
    at com.google.gwt.dev.shell.ModuleSpace.onLoad(ModuleSpace.java:375)
    at com.google.gwt.dev.shell.OophmSessionHandler.loadModule(OophmSessionHandler.java:200)
    at com.google.gwt.dev.shell.BrowserChannelServer.processConnection(BrowserChannelServer.java:525)
    at com.google.gwt.dev.shell.BrowserChannelServer.run(BrowserChannelServer.java:363)
    at java.lang.Thread.run(Thread.java:722) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-07-27T20:23:58.573

我在运行时收到了相同的错误消息。当我尝试“Google > GWT Compile”时，堆栈跟踪对我的帮助更好。我的问题是服务接口使用了一个不可**序列化**的类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-02T05:54:43.547

我有同样的问题，我解决了 lom 添加以下库：

*   javax.inject.jar
*   guice-assistedinject-3.0.jar
*   aopalliance.jar

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-02T20:24:19.463

在您的“.gwt.xml”文件中，添加以下行：

```
<inherits name="com.google.gwt.inject.Inject"/> 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2017-06-07T15:41:28.267

我有同样的问题。我的 Boolean 对象的 getter 方法调用`getBooleanObject()`而不是`isBooleanObject()`. 类`JsonEncoderDecoder`寻找方法调用`isBooleanObject()`，没有找到他，编译失败。(重量 2.8.0)

# facebook - 如何将应用程序添加到 Facebook 社区页面？

> ID：10419725
> 
> 赞同：1
> 
> 时间：2012-05-02T18:38:51.890
> 
> 标签：facebook, facebook-apps

我是具有 facebook 应用程序的媒体网站的开发人员

人们可以添加应用程序（用于 facebook 登录）该应用程序还附加到我们的一个社区页面并且已经存在了很长一段时间（用于通过 facebook api 发布到该社区页面）

此后我们创建了其他几个社区页面，但由于时间线更改，我无法弄清楚如何将我们的应用程序添加到这些社区页面（做更多的自动化帖子）

我在访问 facebook 作为社区页面（通过右上角的下拉菜单）时尝试了[https://www.facebook.com/dialog/pagetab?app_id=YOUR_APP_ID但只得到错误：](https://www.facebook.com/dialog/pagetab?app_id=YOUR_APP_ID)

您正在使用 Facebook 作为 COMMUNITY_PAGE_NAME 要访问此页面，您需要从使用 Facebook 作为您的页面切换到使用 Facebook 作为您自己。

我四处搜索，似乎 Facebook 经常出现功能故障。有针对这个的解决方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T19:19:15.770

您需要以页面管理员身份登录时执行此操作；不是作为页面本身登录时 - 对话框将显示您管理的页面列表

# objective-c - Xcode：是否可以将uiwebview保存在核心数据中

> ID：10419727
> 
> 赞同：0
> 
> 时间：2012-05-02T18:39:00.523
> 
> 标签：objective-c, xcode, core-data, uiwebview, save

我有一个应用程序，它从新闻网站（通过 rss）接收数据并将文章放在表格视图中。用户可以从列表中选择一篇文章以在 web 视图中查看详细信息。在详细视图中，用户可以单击按钮将数据保存在数据库中。

我可以保存文章并在“收藏夹”表格视图中显示它们，但问题是现在我正在保存并使用文章的链接并在用户选择保存的文章时加载它。虽然我想保存文章并允许用户在离线模式下阅读它。我正在使用核心数据。有没有办法保存整个 webview？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-06T20:34:00.527

从新闻网站，您通常可以获得包含**所有**数据的 RSS 提要，以重建完整的新闻故事，即主题、类别、完整的文章文本等，甚至包括图像链接。

只需检索这些提要，解析到您的`NSManagedObject`属性，然后像往常一样将它们存储在 Core Data 中。

话虽如此，许多网站不允许在没有指向其网站的链接的情况下显示新闻，有些网站甚至坚持让您阅读网站上的文章。您需要阅读细则。

# c++ - 重载运算符的内存问题

> ID：10419733
> 
> 赞同：1
> 
> 时间：2012-05-02T18:39:33.680
> 
> 标签：c++

假设有这样的代码：

```
class MyClass {
public:
    MyClass(int foo) : foo(foo){}

private:
    int foo;

//overloaded operator +
public:
    MyClass operator+(MyClass &mc){
        MyClass c(mc.foo + foo);
        return c;
    }
};

int main(int argc, char* argv[]){
    MyClass c1(10);
    MyClass c2(12);

    c2 = c1 + c2;

    return EXIT_SUCCESS;
} 
```

运算符 + 是重载的，因此它不会修改对象，而是创建一个新对象并返回它。

当`c2 = c1 + c2`被调用时，`c2`与新对象绑定，但之前绑定的对象`c2`没有（或至少在我看来）被释放。我说的对吗？

由于 C++ 没有垃圾收集器，这是一个问题吗？

我错过了什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T18:43:17.977

对象是本地的。只有当内存是动态分配的（使用 new 或 malloc）时，我们才需要担心显式释放它。局部变量一旦超出范围就会被销毁。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T19:24:26.033

> 当调用 c2 = c1 + c2 时，c2 与新对象绑定，但与 c2 绑定的前一个对象没有（或至少在我看来）被释放。

不，这不是发生的事情。

没有“与`c2`”绑定的前一个对象；`c2`不是对对象的引用，而是*对象*。`c2`的生命周期从它被声明时开始，并在它超出范围时结束。

赋值运算符不会重新绑定`c2`（这将毫无意义——`c2`不是 java 样式的引用！），它会分配给它。具体来说，它调用`c2.operator=(MyClass)`or `c2.operator=(const MyClass&)`。`c2`赋值之前存在，赋值之后*同一个对象*继续存在。

# asp.net-mvc-3 - 在 MVC3 中的视图上使用 Lambda 表达式

> ID：10419738
> 
> 赞同：0
> 
> 时间：2012-05-02T18:39:42.407
> 
> 标签：asp.net-mvc-3, c#-4.0, entity-framework-4.1

我试图克服的情况看起来很简单，但我没有得到我想要的结果。我有一个 EDMX 文件作为我的特定应用程序的模型，并且正在使用 Razor 引擎。

在 EDMX 文件中，我有一个视图，它是来自多个表的数据的汇总，如下所示：

1 1 1

1 2 2

1 3 3

2 1 1

2 2 2

3 1 1

所以前三个记录属于详细信息 1，接下来的两个记录属于详细信息 2，最后一条记录属于详细信息 3。但是我想“转换”这些数据，以便它像这样在网络上显示：

1

---1

---2

---3

2

---1

---2

3

---1

在我看来，我正在做一些非常基本的事情：

```
 @{
     foreach(var item in Model){
         var items = Model.Where(i => i.ID == item.ID);
         foreach(var itm in items){
           //construct UI loop
         }
     }
  } 
```

我遇到的问题是，当 Lambda 表达式返回正确的行数时，“项目”总是包含重复 n 次的“项目”的值，其中 n 是与给定 ID 关联的行数。

有人可以解释我做错了什么以及为什么这不能像我认为的那样工作吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T19:30:36.493

提供的代码是正确的。这里的问题是，如果记录在 EDMX 文件中具有相同的 EntityKey，那么它们被认为是相同的记录并显示为相同的记录。这就是我遇到的问题。我在视图中添加了一个 GUID 列，并从视图中的其他列中删除了 EntityKeys，上面的代码运行良好。

# asynchronous - TaskCompletionSource - 试图理解无线程异步工作

> ID：10419747
> 
> 赞同：36
> 
> 时间：2012-05-02T18:40:04.227
> 
> 标签：asynchronous, task-parallel-library

我试图了解`TaskCompletionSource`异步/无线程工作的目的及其关系。我想我有一个大致的想法，但我想确保我的理解是正确的。

我首先开始研究任务并行库 (TPL)，以确定是否有一种创建自己的无线程/异步工作的好方法（假设您正在尝试提高 ASP.NET 站点的可伸缩性）以及对 TPL 的理解看起来它在未来将非常重要（`async`/ `await`）。这导致了我`TaskCompletionSource`。

根据我的理解，添加`TaskCompletionSource`到你的一个类中并没有真正使你的编码异步。如果您仍在执行同步代码，那么对您的代码的调用将被阻止。我认为微软 API 也是如此。例如，在`DownloadStringTaskAsync`课外`WebClient`，他们最初执行的任何设置/同步代码都会阻塞。您正在执行的代码必须在某个线程上运行，要么是当前线程，要么您将不得不分拆一个新线程。

因此`TaskCompletionSource`，当您从 Microsoft 调用其他调用时，您可以在自己的代码中使用，`async`这样您的类的客户端就不必为您的类创建新线程而不会阻塞。

不确定 Microsoft 如何在内部执行其异步 API。例如，.Net 4.5 有一种新`async`方法`SqlDataReader`。我知道有 IO 完成端口。我认为这是大多数 C# 开发人员可能不会使用的较低级别的抽象（C++？）。不确定 IO 完成端口是否适用于数据库或网络调用 (HTTP)，或者它是否仅用于文件 IO。

所以问题是，我的理解正确吗？是否有某些事情我代表不正确？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2012-05-02T19:06:55.710

`TaskCompletionSource`用于创建`Task`不执行代码的对象。

微软的新异步 API 大量使用了它们——只要有基于 I/O 的异步操作（或其他非基于 CPU 的异步操作，如超时）。此外，`async Task`您编写的任何方法都将使用 TCS 来完成其返回的`Task`.

我有一篇博客文章[创建任务](http://blog.stephencleary.com/2012/02/creating-tasks.html)，其中讨论了创建`Task`实例的不同方法。它是从`async`/`await`角度（不是 TPL 角度）编写的，但在这里仍然适用。

另请参阅 Stephen Toub 的优秀帖子：

*   [TaskCompletionSource 的性质](https://devblogs.microsoft.com/pfxteam/the-nature-of-taskcompletionsourcetresult/)
*   [创建任务的机制](https://devblogs.microsoft.com/pfxteam/mechanisms-for-creating-tasks/)
*   [等待任何事情；](https://devblogs.microsoft.com/pfxteam/await-anything/)（`TaskCompletionSource`用于`await`任何东西）。
*   [使用任务来实现 APM 模式](https://devblogs.microsoft.com/pfxteam/using-tasks-to-implement-the-apm-pattern/)（创建`Begin`/`End`使用`TaskCompletionSource`）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-04-09T14:25:22.397

我喜欢[http://tutorials.csharp-online.net/TaskCompletionSource中提供的解释](http://tutorials.csharp-online.net/TaskCompletionSource)

（对不起，链接可能暂时失效）

前两段如下

> 我们已经看到了 Task.Run 如何创建一个在池（或非池）线程上运行委托的任务。创建任务的另一种方法是使用 TaskCompletionSource。
> 
> TaskCompletionSource 允许您从任何稍后开始和结束的操作中创建任务。它通过为您提供手动驱动的“从属”任务来工作 - 通过指示操作何时完成或出现故障。这是 I/O 密集型工作的理想选择：您可以获得任务的所有好处（以及它们传播返回值、异常和延续的能力），而不会在操作期间阻塞线程。
> 
> 要使用 TaskCompletionSource，您只需实例化该类。它公开了一个 Task 属性，该属性返回一个您可以等待并附加延续的任务——就像任何其他任务一样。但是，该任务完全由 TaskCompletionSource 对象通过以下方法控制：

```
public class TaskCompletionSource<TResult> 
{ 
 public void SetResult(TResult result); 
 public void SetException (Exception exception); 

 public void SetCanceled();   
 public bool TrySetResult (TResult result); 
 public bool TrySetException (Exception exception); 
 public bool TrySetCanceled();
 ... 
} 
```

> 调用这些方法中的任何一个都会向任务发出信号，将其置于完成、故障或取消状态（我们将在“取消”部分介绍后者）。您应该只调用一次这些方法之一：如果再次调用，SetResult、SetException 或 SetCanceled 将抛出异常，而 Try* 方法返回 false。
> 
> 以下示例在等待 5 秒后打印 42：

```
var tcs = new TaskCompletionSource<int>();
new Thread (() =>     {
                       Thread.Sleep (5000); 
                       tcs.SetResult (42); 
                      })    
           .Start();   
Task<int> task = tcs.Task;    // Our "slave" task. 
Console.WriteLine(task.Result);  // 42 
```

其他有趣的报价

> TaskCompletionSource 的真正威力在于创建不占用线程的任务。

..后来

> 我们在没有线程的情况下使用 TaskCompletionSource 意味着只有在 continuation 开始时才使用线程，即 5 秒后。我们可以通过一次启动 10,000 个这样的操作来证明这一点，而不会出现错误或过多的资源消耗：

# php - jquery 表单在 jquery 对话框 ui 之前提交

> ID：10419764
> 
> 赞同：0
> 
> 时间：2012-05-02T18:41:25.603
> 
> 标签：php, jquery, jquery-ui

我有这个 openid 插件，但是当我点击 aol 时，对话框会打开，很快它就会自动关闭并提交表单。我希望它在对话框打开时停止，并且只有在我关闭对话框时才提交表单

请帮帮我

```
(function($){
  $.fn.openid = function() {
    $('input').click(function(e){
      var provider = $(this).attr('class');
     if (provider == 'aol') {
        $("#dialog").dialog();  
         }
     else{
      var provider_url = $(this).attr('id');  //get id
      var myinput = $('<input type="hidden" name="provider_url"/>').val(provider_url);
        }  
        $('form').append(myinput);
      $('form').submit();
    })
  }
})(jQuery); 
```

甚至 e.stopPropogation(); 即使我将 form.submit (return false ) 放入 if 循环中，click 事件处理程序也不起作用，它也完全禁用了 else 循环

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T18:49:57.940

您是否尝试过添加

```
e.preventDefault(); 
```

在你的点击功能的开始？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T18:50:12.770

我认为由于代码的和平，问题正在发生：

```
$('form').submit(); 
```

代码的和平是独立存在的，因此只要单击 $('input') 就会执行。您应该尝试将这种平静的代码放入另一个 jQuery click 函数中，或者将其放入 if of else 语句中。

```
$('.buttonX').click(function()
{
   $('form').submit();
}); 
```

# php - 如何使用图像服务脚本优化 MySQL 查询？

> ID：10419768
> 
> 赞同：0
> 
> 时间：2012-05-02T18:41:57.137
> 
> 标签：php, mysql, sql, apache

我有一个我一直在优化的 PHP 图像服务脚本。我在优化的服务器端做了很多工作，但我也想确保我优化了 mysql 方面的事情。我目前在每次加载此图像服务脚本时使用 MYSQL 执行以下操作。

1.  连接到数据库
2.  检查提供的 id 是否有效，如果有效则返回该行
3.  通过将点击数列增加 1 来更新图像的统计信息
4.  将带有特定控制器和操作的统计表也增加 1
5.  我没有关闭连接，我被告知让它静置，因为它需要更少的时间并且它会自行死亡

我在我的服务器上运行了“mysqladmin status”，发现目前正在运行 63.8997 avg。我目前有大约 17 个 req/s 通过 apache 加载此脚本。我还在服务器上配置了 eaccelerator，以保持该脚本的编译版本可供使用。我的问题是有什么方法可以进一步优化我可以处理的查询数量？我正在努力确保将所有#s 保持在尽可能低的水平并尽可能快地移动？

我的目标是让我的服务器每天处理 432 万张图片而没有问题（在 apache 中是每秒 50/req）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T19:09:02.900

每次增加计数器并将其提交到数据库时，您可能会写入磁盘。相反，您可以尝试在内存中缓存命中数几分钟，然后每隔几分钟将缓存转储回数据库。这将减少您对数据库的写入和读取次数。

您还可以更进一步将整行缓存在内存中。这只有在数据不经常更改并且数据被频繁请求的情况下才实用。此外，如果您开始缓存大量数据，内存限制可能会成为一个问题。

我知道在一些非常高性能的数据库环境中，整个数据库实例会存储在内存中，并且只会周期性地写入磁盘。这也将大大减少查询时间，并减少对缓存的需求，因为所有内容都已经在内存中。不过，这将需要一些严肃的硬件。

此外，您可能希望最终远离 MySQL。MySQL 并不是最好的高性能，即因为 MySQL 和存储过程不能很好地齐头并进。存储过程是在数据库上编译的，不需要解析 SQL 即可执行。如果您要切换到某些东西，例如 Oracle，则整个事务可以使用已编译的存储过程来完成。MySQL 不容易提供这种灵活性，如果有的话。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T18:54:18.997

您应该有多个副本读取服务器并将其用于提供数据，以及一个仅执行以下操作的统计服务器：

```
INSERT DELAYED INTO stats (image) VALUES (:image); 
```

这将为您提供水平可扩展的读取服务和快速统计计数器。

或以图像形式（某种效果）：

![在此处输入图像描述](../Images/e7b8edb285ac34e53cd98524d2c24a78.png)

# c# - 比较与自适应近似相等的双打

> ID：10419771
> 
> 赞同：4
> 
> 时间：2012-05-02T18:42:13.187
> 
> 标签：c#, equals, approximate

我正在尝试制作一个自适应的“大约相等”方法（用 C# 编写，但问题很笼统）接受两个双精度数并返回一个布尔值，如果它们“大约相等”或不“大约相等”。通过自适应，我的意思是：

1.234 和 1.235 ==> 真

但

1.234567 和 1.234599 ==> 错误

也就是说，“大约相等”的精度适应数字的精度。

我在[如何找到两个变量是否近似相等？](https://stackoverflow.com/questions/3420812/how-do-i-find-if-two-variables-are-approximately-equals)但是对于 epsilon 使用什么仍然存在开放式问题。

有人知道此类问题的最佳实践吗？提前致谢！

编辑：我最初的问题没有包含足够的信息来说明我想要得到什么。很抱歉，我很抱歉。我想要一个程序，它可以将更高的精度数字处理为更高的标准，同时对更低的精度数字更宽容。对的更多示例是（其中 '(0)' 是隐含的零）：

1.077 和 1.07(0) 返回 false（因为 77 与 70 非常不同）

1.000077 和 1.00007(0) 返回 false（因为 77 与 70 非常不同）

1.071 和 1.07(0) 返回 true（因为 71 接近 70

1.000071 和 1.00007(0) 返回 true（因为 71 接近 70）

无论实现代码如何，我都假设会有某种“公差”变量来确定什么是“非常不同”和什么是“接近”。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-02T19:00:43.867

比较浮点数的一种方法是比较有多少浮点表示将它们分开。该解决方案与数字的大小无关，因此您不必担心“epsilon”。

该算法的描述可以在[这里](http://www.cygnus-software.com/papers/comparingfloats/comparingfloats.htm)找到（最后是AlmostEqual2sComplement函数），这是我的C#版本。

```
public static class DoubleComparerExtensions
{
    public static bool AlmostEquals(this double left, double right, long representationTolerance)
    {
        long leftAsBits = left.ToBits2Complement();
        long rightAsBits = right.ToBits2Complement();
        long floatingPointRepresentationsDiff = Math.Abs(leftAsBits - rightAsBits);
        return (floatingPointRepresentationsDiff <= representationTolerance);
    }

    private static unsafe long ToBits2Complement(this double value)
    {
        double* valueAsDoublePtr = &value;
        long* valueAsLongPtr = (long*)valueAsDoublePtr;
        long valueAsLong = *valueAsLongPtr;
        return valueAsLong < 0
            ? (long)(0x8000000000000000 - (ulong)valueAsLong)
            : valueAsLong;
    }
} 
```

如果您想比较浮点数，请将 all 更改`double`为、`float`all和`long`to 。`int``0x8000000000000000``0x80000000`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-03T07:22:50.143

`float`并且`double`您的思维方式不精确。程序通过截断尾随零来伪造精度……但是您不能将这个技巧用于您的目的，因为舍入错误会阻止这种技巧的可靠性。

`decimal` *确实会*跟踪小数点右侧要放置多少位数，但这对于实现您提出的算法仍然毫无价值，因为任何引入表示错误（例如，除以 3）的操作都会倾向于最大化小数点右边的位数。

如果您想根据数据的已知精度实际获得模糊相等，一种方法是创建自己的数字类。像这样的东西：

```
public class DoublePrecise
{
    public readonly double Error;
    public readonly double Value;
    public DoublePrecise(double error, double value) {
        Error = error;
        Value = value;
    }
    public static DoublePrecise operator -(DoublePrecise d1, DoublePrecise d2) {
        return new DoublePrecise(d1.Value - d2.Value, d1.Error + d2.Error);
    }
    //More stuff.
} 
```

基本上，这是让您代表 10.0±0.1 之类的数字。在这种情况下，如果两个数字的范围重叠，您会将它们视为大致相等（尽管实际上，这会使您的相等运算意味着“可能相等”而您的不等式运算意味着“绝对不相等”。

另见，[区间算术](http://en.wikipedia.org/wiki/Interval_arithmetic)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T18:48:27.130

您可以将一个除以另一个，看看结果是否接近一，例如

```
var ratio = a / b;
var diff = Math.Abs(ratio - 1);
return diff <= epsilon; 
```

然后你只需要选择你的 epsilon 来决定这些值必须有多接近。

但是，在您的示例中，您的第一个示例相差 0.08%，但第二个示例相差 0.003%，但您希望第一个为真，第二个为假。我不确定您真正在寻找什么，您需要先了解这一点，然后才能决定问题的解决方案。（需要正确的问题才能得到正确的答案）您可能会想象“最后一个有效数字可以不同，但​​不会更多”，但用数学术语定义它并不那么简单。例如，0.49999999997 是否应该等于 0.5？那么0.500000000003呢？比较这些数字有什么意义？

# algorithm - 绘制图形算法的软件

> ID：10419772
> 
> 赞同：1
> 
> 时间：2012-05-02T18:42:13.450
> 
> 标签：algorithm, graph, drawing

我想要一些关于软件（Windows 或 Linux）的技巧来绘制用于教学算法的图表。理想情况下，它应该支持几帧相似的图纸，它们之间几乎没有变化，最重要的是，变化可以传播到所有帧。

我目前使用 yEd 来绘制图形，但是不同图像之间的复制/粘贴有几个问题，例如，如果我在创建多个副本后更改节点的颜色，我必须在每个图像中分别更改它。

我曾经（在很短的时间内）使用过 Macromedia Flash，我相信尝试使用它会非常好，但它的成本太高而且太过分了。

DOT 非常好，但我找不到一个带有快速反馈的图形界面来简化任务。如果该工具需要一些编程，我不会打扰，但文本到图像的转换应该几乎是实时的。

上次我尝试 Dia 和 Visio 似乎都没有我想要的，但也许我错过了......

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T13:55:01.807

[OmniGraffle](http://www.omnigroup.com/products/omnigraffle/features/ "OmniGraffle") for Mac/iPad 具有“共享层”的概念，这可能是您正在寻找的。来自官方网站：

```
Share the love between your canvases with shared layers. 
When you have common elements that you'd like to display 
on different canvases, shared layers make it easy to keep 
them updated. Change any object on a shared layer (a logo, 
a background, a wireframe) and the change instantly shows 
up on every canvas that shares the layer. 
```

但是它不是多平台的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T21:42:33.017

[Gephi](http://gephi.org/features/ "格菲")和[Ubigraph](http://ubietylab.net/ubigraph/index.html "写字楼")支持动态图形可视化，并且都运行在 Windows 和 Linux 上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T23:05:18.930

你可以考虑这个：[http](http://code.enthought.com/) ://code.enthought.com/它是 python 并且有据可查。

# mysql - 计算 16:00 之后发布的消息的（第二天）日期

> ID：10419777
> 
> 赞同：0
> 
> 时间：2012-05-02T18:42:52.743
> 
> 标签：mysql, sql

考虑下表：

```
+---------+---------+------------+----------+------------+
| msg_id  | user_id | _date      | _time    | count_for  |
+-------------------+------------+----------+------------+
|   1     | 1       | 2011-01-22 | 06:23:11 | 2011-01-22 |
|   2     | 1       | 2011-01-23 | 16:17:03 | 2011-01-24 |
|   3     | 1       | 2011-01-23 | 17:05:45 | 2011-01-24 |
|   4     | 2       | 2011-01-24 | 06:58:13 | 2011-01-24 |
|   5     | 2       | 2011-01-24 | 15:59:32 | 2011-01-24 |
|   6     | 3       | 2011-01-25 | 13:45:00 | ...        |
|   7     | 3       | 2011-01-26 | 13:22:34 | ...        |
+---------+---------+------------+----------+------------+ 
```

我想统计每天的消息数量，但是今天 16:00 之后的消息必须计入第二天： - msg 1 是在 16:00 之前写的`2011-01-22`，所以 count_for 是（同一天）`2011-01-22` - msg 2 是写的在 16:00 之后`2011-01-23`，所以 count_for 是（第二天）`2011-01-24`

显然，我手动完成了前 5 个。我的问题是：我可以通过什么查询自动执行此操作（在 MySQL 中）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T18:45:13.687

就像是

```
SELECT count(msg_id), if(_time >= '16:00:00', _date + INTERVAL 1 DAY, _date) AS effective_date
FROM yourtable
GROUP BY effective_date 
```

应该做的伎俩。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T18:45:51.017

```
SELECT IF(_time < '16:00:00', _date, ADDDATE(_date, 1)) AS d, COUNT(*)
FROM `table`
GROUP BY d 
```

# asp.net-mvc-3 - 目录中每个视图的不同控制器？

> ID：10419779
> 
> 赞同：0
> 
> 时间：2012-05-02T18:42:57.073
> 
> 标签：asp.net-mvc-3

我想为目录中的每个视图分离我的控制器逻辑，而不是将其全部放在一个控制器中，因为我不希望一个控制器中有那么多动作。有什么办法可以做到这一点？

```
Views--
    FooFolder
            Fooview.cshtml
            Barview.cshtml

Controllers--
    FooController.cs
    BarController.cs 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T18:54:00.157

*不需要*在某个文件夹中拥有视图或在某个控制器中拥有操作。这只是一个约定，您可以通过例如替换视图引擎或更改路由定义或通过显式指定视图路径来更改它。但是，如果您想分离控制器逻辑，则开始的地方不是控制器本身，而是通过将逻辑卸载到其他地方的业务方法并从控制器调用它。

# c# - Office（word、excel、powerpoint）文档属性的服务器端编辑

> ID：10419781
> 
> 赞同：0
> 
> 时间：2012-05-02T18:43:07.803
> 
> 标签：c#, .net, office-interop

我有一个用 C# .NET 4 编写的 office 集成插件项目。该插件允许在 Word、Excel 和 Powerpoint 中下载和编辑（或创建新文档），最后将它们保存在我们的 Intranet 中。

为了识别数据库中记录的文档，我将记录 guid 保存为 office 文档文件中的属性“guid”。只要我使用带有该插件的 office 创建和编辑所有文件，它就可以正常工作。

但是，如果我通过 Web 表单上传任何办公文档并将其存储，则该文档可能没有 guid 属性。但是数据库中的记录有一个。所以解决方案是在服务器端添加 guid 属性。

我为 RoR 编写了一个命令行工具，并为脚本编写了一个 COM+ 对象，我可以在其中添加/修改这些属性。唯一的问题是，我需要在服务器上安装办公室（Word、Excel、Powerpoint）。，因为我们需要支持2003、2007、2010版本。

我已经检查了[http://msdn.microsoft.com/en-us/library/bb739835%28v=office.12%29.aspx](http://msdn.microsoft.com/en-us/library/bb739835%28v=office.12%29.aspx)，但这不适用于 2003 版。

* * *

所以这是一个问题:)：有谁知道我不需要在服务器上安装办公室或者我必须忍受它的解决方案？第三方（即使是商业的，如果是好的）也受到欢迎，如果他们工作的话。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T19:10:04.227

我们过去曾使用[aspose.com/](http://www.aspose.com/)组件在服务器上编辑办公文档。

注：本人与公司无关。

# javascript - 使用 JavaScript 添加图像

> ID：10419782
> 
> 赞同：-1
> 
> 时间：2012-05-02T18:43:14.437
> 
> 标签：javascript, game-maker

长话短说，我需要使用 JavaScript 将图像添加到给定 URL 的 html5 游戏。问题在于它位于一个名为 gamemaker html5 的程序中，该程序基本上是一个用于创建 HTML 游戏的拖放 IDE。

我不知道任何 JavaScript，只需要代码来添加给定 URL 的图像。有人可以帮我将以下 html 翻译成 JavaScript 吗？

```
<img src="http://www.mydomain.com/myimagefile.gif"></img> 
```

这全部包含在 html5 画布上，因此我需要能够将图像弹出到 x,y 坐标上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T18:44:37.447

**编辑：**既然您已经指定要在画布上绘制此图像，这是一个完全不同的问题。有关示例代码，请参阅有关图像和画布的[MDN 教程。](https://developer.mozilla.org/en/Canvas_tutorial/Using_images)另外，请参阅其他[相关的 SO question](https://stackoverflow.com/questions/6011378/basic-canvas-question-how-to-add-image-to-canvas)。

* * *

问题成为关于画布之前的先前答案。

这会将带有该 URL 的新图像附加到正文。由于您可能希望将其放在比此更具体的位置，因此您还需要告诉我们您希望将图像插入页面的位置，以便`document.body`可以将部分替换为页面中您希望新图像成为的所需元素位于附近。

```
var img = new Image();
img.src = "http://www.mydomain.com/myimagefile.gif";
document.body.appendChild(img); 
```

这会将图像作为给定节点的最后一个子节点插入。您还可以在页面中的给定对象之前或之后插入节点，但代码略有不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T18:47:24.943

要将图像添加到 GameMaker:HTML5 游戏，请使用以下命令：

```
newimg = sprite_add("http://www.mydomain.com/myimagefile.gif",1,false,false,0,0); 
```

根据需要替换参数，但请注意，这不支持动画 GIF 文件 - 如果要导入动画精灵，它们必须是条形。

`newimg`然后可以在您通常命名精灵的任何地方使用，例如：

```
draw_sprite(newimg,-1,32,32); 
```

# xml - 使用 Google Geocoding API 从 XML 结果中提取所有字段

> ID：10419787
> 
> 赞同：0
> 
> 时间：2012-05-02T18:43:49.363
> 
> 标签：xml, geolocation, geocoding

我正在使用 Google Geocoding API，特别是依赖于 XML 输出格式。下面的代码循环遍历数组`$arrGeocodeSales`，并为每一行检索`$lat`and `$long`，然后将其显示在表中。

这段代码运行良好，但我想扩展它，以便从`$xml`返回的结果中提取更多字段。例如，我想从 $xml 结果中提取的一些附加字段是`formatted_address`and `postal_code`。如何修改下面的代码以提取附加字段？

您可以在此处查看 $xml 结果的示例：

[http://maps.googleapis.com/maps/api/geocode/xml?address=1600+Amphitheatre+Parkway,+Mountain+View,+CA&sensor=true](http://maps.googleapis.com/maps/api/geocode/xml?address=1600%20Amphitheatre%20Parkway,%20Mountain%20View,%20CA&sensor=true)

这是需要修改的代码。我想我不明白如何处理`SimpleXMLElement`返回的。谢谢您的帮助。

```
<table border="1" style="margin-bottom:0px;">
<tr>
  <th>ID</th>
  <th>Roll</th>
  <th>Address</th>
  <th>Lat</th>
  <th>Long</th>
  <th>MapSaleNumber</th>
  </tr>

<?php foreach ($arrGeocodeSales as $key => $value): 
    $address = $value['Address']."+".$value['Municipality']."+Ontario+Canada"; 
    $googleAddress = "https://maps.google.com/maps/geo?q=".urlencode($address)."&output=xml";
    // Retrieve the URL contents
    $googlePage = file_get_contents($googleAddress);
    // Parse the returned XML file
    $xml = new SimpleXMLElement($googlePage);
    // Parse the coordinate string  
    list($lng, $lat, $alt) = explode(",", $xml->Response->Placemark->Point->coordinates);
 ?>
<tr>
  <td ><?php echo str_pad($row++, 2, '0', STR_PAD_LEFT); ?></td>
  <td ><?php echo $value['SingleRoll']; ?></td>
  <td ><?php echo $address; ?> </td>
  <td ><?php echo $lat ?></td>
  <td ><?php echo $lng ?></td>
  <td ><?php echo $value['MapSaleNumber']; ?></td>
  </tr>
<?php endforeach; ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T18:58:35.007

您可以使用[此处记录](http://php.net/manual/en/book.simplexml.php)`SimpleXMLElement`的方法来操作结果。

您将需要遍历`address_component`元素以找到具有`type`您感兴趣的元素值的元素。查找使用该 API 的其他代码示例，您应该能够快速找出它。

# c++ - 对 _Unwind_Resume 和 __gxx_personality_v0 的未定义引用

> ID：10419801
> 
> 赞同：14
> 
> 时间：2012-05-02T18:44:43.983
> 
> 标签：c++, exception, mingw

我正在尝试使用 JsonCpp 库。我在 Windows 上，使用 MinGW 和 CodeBlocks。

当我包含 json 标头中的任何内容时，我的链接器会内爆并给出这两个错误。我开始环顾四周，发现另外两个问题基本上描述了我的问题：

[g++ 的问题和“对 `__gxx_personality_v0' 的未定义引用”](https://stackoverflow.com/q/6045809/1356926)

[__gxx_personality_v0 有什么用？](https://stackoverflow.com/q/329059/1356926)

如果我将两个缺失的变量声明为 void 指针，如下所示，问题就消失了：

```
void * __gxx_personality_v0=0;
void * _Unwind_Resume =0; 
```

但是，我不明白为什么会发生此错误。CodeBlocks 设置为使用 migw32-g++ 处理 cpp 文件，并且添加 -lstdc++ 选项也不能解决问题。选项 -fno-exception 也没有（我想要例外，请注意，我只是在尝试）。

我还在同一个文件中包含了一个 boost 库，这不会导致任何问题。

编辑：

错误输出正是我在标题中所说的：在链接过程中，我总共获得了 22 个对 _Unwind_Resume 和 __gxx_personality_v0 的未定义引用。我的代码是：

```
#include <boost/algorithm/string.hpp>
#include <include/json/value.h>
//void * __gxx_personality_v0=0;
//void * _Unwind_Resume =0;
int main () {
    std::string str1("Hello world!");
    boost::to_upper(str1);
    Json::Value k;
    return 0;
} 
```

仅当我包含/使用 JsonCPP 库时才会出现错误。取消注释注释行可以解决问题。

命令行输出是这样的：

```
mingw32-g++.exe -Wall -fexceptions  -g  -DSFML_DYNAMIC   -IC:\Users\Svalorzen\Documents\Projects\boost_1_49 -IC:\Users\Svalorzen\Documents\Projects\jsoncpp-src-0.5.0 -IC:\Users\Svalorzen\Documents\Projects\SFML-1.6\include -IC:\Users\Svalorzen\Documents\Projects\hge181\include  -c C:\Users\Svalorzen\Documents\Projects\test\main.cpp -o obj\Debug\main.o
mingw32-g++.exe -LC:\Users\Svalorzen\Documents\Projects\jsoncpp-src-0.5.0 -LC:\Users\Svalorzen\Documents\Projects\SFML-1.6\lib -LC:\Users\Svalorzen\Documents\Projects\hge181\lib  -o bin\Debug\test.exe obj\Debug\main.o   -fno-exceptions -lsfml-graphics -lsfml-window -lsfml-system  C:\Users\Svalorzen\Documents\Projects\jsoncpp-src-0.5.0\libs\mingw\libjson_mingw_libmt.a C:\Users\Svalorzen\Documents\Projects\hge181\lib\gcc\libhge.a C:\Users\Svalorzen\Documents\Projects\hge181\lib\gcc\libhelp.a 
Output size is 1.22 MB
Process terminated with status 0 (0 minutes, 3 seconds)
0 errors, 0 warnings 
```

第二次编辑：我正在添加用于编译库的命令行：

```
g++ -o buildscons\mingw\src\lib_json\json_reader.o -c -DWIN32 -DNDEBUG -D_MT -Iinclude src\lib_json\json_reader.cpp
g++ -o buildscons\mingw\src\lib_json\json_value.o -c -DWIN32 -DNDEBUG -D_MT -Iinclude src\lib_json\json_value.cpp
g++ -o buildscons\mingw\src\lib_json\json_writer.o -c -DWIN32 -DNDEBUG -D_MT -Iinclude src\lib_json\json_writer.cpp
ar rc buildscons\mingw\src\lib_json\libjson_mingw_libmt.a buildscons\mingw\src\lib_json\json_reader.o buildscons\mingw\src\lib_json\json_value.o buildscons\mingw\src\lib_json\json_writer.o
ranlib buildscons\mingw\src\lib_json\libjson_mingw_libmt.a 
```

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2014-04-01T00:28:01.057

对于那些来自谷歌的人（就像我所做的那样），未定义引用的真正原因`_Unwind_Resume`是`__gxx_personality_v0`“使用与 dwarf2 不同的堆栈展开方法的 gcc”[ [1](https://www.allegro.cc/forums/thread/603070/850244#target) ]

在我的例子中，它试图将使用 GCC 4.9 向上编译的代码与使用 GCC 4.8 或更低版本编译的库链接起来。解决方案是使用您正在构建的相同编译器重新编译库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-07-05T17:30:17.467

我在尝试使用 g++ -g -std=c++17 ... 时遇到了同样的问题。我删除了该选项，一旦我删除了对 C++17 功能的使用，它就会编译、链接并运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T21:18:54.167

我最终通过将 JsonCpp 的源代码导入 Code::Blocks 并自己创建库来解决此问题。我仍然对为什么用 Scons 创建的库不起作用感到困惑，因为它使用的编译器与 Code::Blocks 使用的编译器相同，但同时它不是（或者错误不会存在）。

# amazon-web-services - 将文件推送到 Amazon Cloudfront：可能吗？

> ID：10419805
> 
> 赞同：12
> 
> 时间：2012-05-02T18:44:58.787
> 
> 标签：amazon-web-services, cdn, amazon-cloudfront

我一直在阅读有关拉取和推送 CDN 的信息。我一直在使用 Cloudfront 作为调整大小图像的拉式 CDN：

*   从客户端接收图像
*   将图像放入 S3

稍后，当客户端向云端请求 URL 时，云端没有图像，因此它必须将其转发到我的服务器，其中：

*   接收请求
*   从 S3 拉取图像
*   调整图像大小
*   将图像推送回 Cloudfront

但是，这需要几秒钟，当您第一次上传美丽的图像并想看到它时，这真的很烦人。延迟似乎主要是下载/重新上传时间，而不是调整大小，这非常快。

是否可以主动将调整大小的图像推送到 Cloudfront 并将其附加到 URL，以便将来的请求可以立即获取准备好的图像？理想情况下，我想

*   从客户端接收图像
*   将图像放入 S3
*   为常见尺寸调整图像大小
*   先发制人地将这些大小推送到云端

这避免了整个下载/重新上传周期，使常见尺寸非常快，但仍然可以访问不太常见的尺寸（尽管第一次有延迟）。但是，要做到这一点，我需要将图像推送到 Cloudfront。这：

[http://www.whoishostingthis.com/blog/2010/06/30/cdns-push-vs-pull/](http://www.whoishostingthis.com/blog/2010/06/30/cdns-push-vs-pull/)

似乎暗示它可以完成，但我所看到的其他一切都没有提到它。我的问题是：有可能吗？还是我缺少此问题的其他解决方案？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-08T01:50:35.520

我们已经尝试与不同的 CDN 提供商进行类似的事情，对于 CloudFront，如果 CloudFront 分发使用您的自定义来源。

正如@Xint0 所提到的，我能想到的一种方法是设置另一个 S3 存储桶来专门托管您想要推送的那些文件（在您的情况下是那些调整大小的图像）。基本上，您将拥有两个 cloudFront 发行版，一个用于拉取那些很少访问的文件，另一个用于推送那些经常访问的文件以及您希望调整大小的那些图像。这听起来有点复杂，但我相信这是你必须做出的权衡。

我可以建议您查看的另一点是 EdgeCast，它是另一个 CDN 提供商，他们确实提供了名为 load_to_edge 的功能（上个月我花了很多时间将其与我们的服务集成，这就是为什么我记得很清楚）正是你所期望的。他们还支持自定义原点拉取，所以也许你可以在那里试用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-10-24T23:45:55.433

OP 要求推送 CDN 解决方案，但听起来他真的只是想让事情变得更快。我敢说您可能并不真正需要实现 CDN 推送，您只需要优化您的源服务器模式。

所以，OP，我假设您最多支持少数几种图像尺寸——比如说 128x128、256x256 和 512x512。听起来您在 S3 中也有这些图像的原始版本。

## 这是当前缓存未命中时发生的情况：

1.  CDN 收到对 128x128 版本图像的请求
2.  CDN 没有该图像，因此它从您的源服务器请求它
3.  您的源服务器收到请求
4.  您的原始服务器从 S3 下载原始图像（可能是更大的图像）
5.  您的来源调整该图像的大小并将其返回到 CDN
6.  CDN 将该图像返回给用户并缓存它

## 你应该做什么：

根据您的具体情况，这里有几个选项。

### 以下是您可以使用当前设置快速修复的一些问题：

1.  如果您必须从 S3 获取原始图像，那么您基本上是在这样做，以便缓存未命中导致每个图像的下载时间与原始大小的图像一样长。如果可能的话，您应该尝试将这些原始图像存储在您的源服务器可以快速访问的地方。根据您的设置，这里有一百万种不同的选项，但从 S3 获取它们是所有选项中最慢的。至少你没有使用 Glacier ;)。
2.  您没有缓存调整大小的图像。这意味着 Cloudfront 使用的每个边缘节点都会请求此图像，这会触发整个调整大小的过程。Cloudfront 可能有数百个单独的边缘节点服务器，这意味着每个图像有数百个丢失和调整大小。取决于 Cloudfront 为分层分发所做的工作，以及您设置文件头的方式，它实际上可能没有*那么*糟糕，但也不会很好。
3.  我在这里很危险，但我打赌你没有设置自定义过期标头，这意味着 Cloudfront 只会将这些图像中的每一个缓存 24 小时。如果您的图像在上传后是不可变的，那么您将真正受益于返回过期标头告诉 CDN 不要长时间检查新版本。

### 以下是一些可能更好的模式的想法：

1.  当有人上传新图像时，立即将其转码为您支持的所有尺寸并将其上传到 S3。然后只需将您的 CDN 指向该 S3 存储桶。这假设您拥有可管理数量的受支持图像大小。但是，我要指出，如果您支持太多图像大小，CDN 可能完全是错误的解决方案。您的缓存命中率可能非常低，以至于 CDN 确实妨碍了您。如果是这种情况，请参阅下一点。
2.  如果您支持诸如连续调整大小之类的东西（即，我可以请求 image_57x157.jpg 或 image_315x715.jpg 等，服务器会返回它），那么您的 CDN 实际上可能会通过引入额外的跃点而对您造成伤害，而不会从您的起源。在这种情况下，我可能会在所有可用区域中启动 EC2 实例，在它们上安装您的源服务器，然后根据客户端 IP 将图像 URL 交换到适合区域的源（有效地滚动您自己的 CDN）。

### 如果你真的想推送到 Cloudfront：

您可能不需要，但如果您只是必须，这里有几个选项：

1.  编写一个脚本来[使用webpagetest.org API](https://sites.google.com/a/webpagetest.org/docs/advanced-features/webpagetest-restful-apis)从世界各地的不同地方获取您的图像。从某种意义上说，您会将拉动命令推送到所有不同的边缘位置。这不能保证填充每个边缘位置，但您可能会接近。请注意，我不确定webpagetest.org 以这种方式使用它会有多激动，但我没有看到任何关于它的使用条款（IANAL）。
2.  如果您不想使用第三方或冒着惹恼webpagetest.org 的风险，只需在每个区域启动一个微型EC2 实例，并使用它们来获取内容，与#1 相同。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-02T18:54:50.790

AFAIK CloudFront 使用 S3 存储桶作为数据存储。因此，在调整图像大小后，您应该能够将调整大小的图像直接保存到 CloudFront 使用的 S3 存储桶中。

# php - 使用 DateInterval 将月份添加到 DateTime 会更改原始日期以匹配新日期

> ID：10419807
> 
> 赞同：9
> 
> 时间：2012-05-02T18:45:03.557
> 
> 标签：php, datetime

我有这个非常简单的代码：

```
$start_date = new DateTime($post['start_date']);
$end_date = $start_date->add(new DateInterval('P6M'));
echo $start_date->getTimestamp(); // 1351836000
echo $end_date->getTimestamp(); // 1351836000 
```

当然，两者都以相同的时间戳结束，因为添加日期间隔会影响原始 $start_date。那么我该怎么做才能保留原来的 $start_date 并在另一个变量中添加 6 个月呢？

我试过这个没有运气：

```
$start_date = new DateTime($post['start_date']);
$start_date_actual = $start_date;
$end_date = $start_date_actual->add(new DateInterval('P6M'))->getTimestamp(); 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-02T18:48:13.100

变量保存对对象的引用，而不是对象本身。所以赋值只会让你有更多的变量指向同一个对象，而不是对象的多个副本。

如果您*想要*副本，请使用[`clone`](http://php.net/manual/en/language.oop5.cloning.php)关键字：

```
$end_date = clone $start_date;
$end_date->add(new DateInterval('P6M')); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-02T18:48:00.593

您可以选择：

```
$start_date = new DateTime($post['start_date']);
$end_date = new DateTime($post['start_date']);
$end_date->add(new DateInterval('P6M')); 
```

或者

```
$start_date = new DateTime($post['start_date']);
$end_date = clone $start_date;
$end_date->add(new DateInterval('P6M')); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T18:48:08.830

在修改之前克隆开始日期：

```
$start_date = new DateTime();
$end_date = clone $start_date;
$end_date->add(new DateInterval('P6M'));
echo $start_date->getTimestamp();
echo $end_date->getTimestamp(); 
```

有关更多信息，请参阅手册

*   [http://php.net/manual/en/language.oop5.cloning.php](http://php.net/manual/en/language.oop5.cloning.php)
*   [http://php.net/manual/en/language.oop5.references.php](http://php.net/manual/en/language.oop5.references.php)

# cocoa-touch - NSOperationQueue 什么时候开始它的第一个操作？

> ID：10419809
> 
> 赞同：11
> 
> 时间：2012-05-02T18:45:05.667
> 
> 标签：cocoa-touch, cocoa, nsoperationqueue

我创建了一个测试项目，我在其中测试我的假设`NSOperation`，`NSOperationQueue`然后在我的主项目中使用它们。

我的代码非常简单，所以我将在此处包含所有代码。这是使用打开 ARC 的命令行 Foundation 项目。

## 操作.h

```
#import <Foundation/Foundation.h>

@interface Operation : NSOperation

@property (readwrite, strong) NSString *label;

- (id)initWithLabel: (NSString *)label;

@end 
```

## 操作.m

```
#import "Operation.h"

@implementation Operation

- (void)main
{
    NSLog( @"Operation %@", _label);
}

- (id)initWithLabel: (NSString *)label
{
    if (( self = [super init] )) {
        _label = label;
    }
    return self;
}

@end 
```

## 主程序

```
#import <Foundation/Foundation.h>
#import "Operation.h"

int main(int argc, const char * argv[])
{

    @autoreleasepool {

        NSOperationQueue *queue = [[NSOperationQueue alloc] init];
        queue.maxConcurrentOperationCount = 1;

        id create = [[Operation alloc] initWithLabel: @"create"];
        id update1 = [[Operation alloc] initWithLabel: @"update1"];
        id update2 = [[Operation alloc] initWithLabel: @"update2"];

        [update1 addDependency: create];
        [update2 addDependency: create];

        [queue addOperation: update1];
        [queue addOperation: create];
        [queue addOperation: update2];

        [queue waitUntilAllOperationsAreFinished];

    }
    return 0;
} 
```

我的输出如下所示：

```
2012-05-02 11:37:08.573 QueueTest[1574:1b03] Operation create
2012-05-02 11:37:08.584 QueueTest[1574:1903] Operation update2
2012-05-02 11:37:08.586 QueueTest[1574:1b03] Operation update1 
```

写完这个并尝试了一些组合后，我发现当我像这样重新排序队列设置时：

```
 [queue addOperation: update1];
    [queue addOperation: create];
    [queue addOperation: update2];

    [update1 addDependency: create];
    [update2 addDependency: create];

    [queue waitUntilAllOperationsAreFinished]; 
```

我得到了相同的输出：

```
2012-05-02 11:38:23.965 QueueTest[1591:1b03] Operation create
2012-05-02 11:38:23.975 QueueTest[1591:1b03] Operation update1
2012-05-02 11:38:23.978 QueueTest[1591:1903] Operation update2 
```

我应该注意到，我在一些运行中发现 update2 在 update1 之前执行，但*这种*行为并不奇怪。`NSOperationQueue`当我没有要求它是确定性时，为什么应该是确定性的？

我*确实*感到惊讶的是，即使在添加依赖项之前将所有内容都添加到队列中，create 总是在 update1 和 update2 之前执行。

显然，这是一件愚蠢的事情，但它让我想知道：我将操作添加到队列和执行它之间的延迟是否记录在案，或者以任何方式可预测？究竟什么时候`NSOperationQueue`开始处理添加的操作？

真的，最重要的是，究竟是什么在`NSOperationQueue`等待，什么时候等待以某种我**无法**防御的方式咬我？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-02T21:04:39.953

> 显然，这是一件愚蠢的事情，但它让我想知道：我将操作添加到队列和执行它之间的延迟是否记录在案，或者以任何方式可预测？NSOperationQueue 究竟什么时候开始处理添加的操作？

后：

*   您将操作添加到队列中，*并且*
*   所有操作的依赖项都已完成，*并且*
*   队列（就优先级而言）没有更好的事情可做。

对于没有不满足依赖关系的操作，这可能意味着立即。

> 进一步的实验似乎表明，一旦当前线程通过 [queue waitUntilAllOperationsAreFinished]、[NSThread sleepForTimeInterval: 0.000001] 或中断的线程，NSOperationQueue 就会开始运行操作。

这个假设是虚假的，原因有两个：

1.  抢占式多任务处理，在每个版本的 OS X（以及每个版本的 iOS）上都完成，这意味着调度程序可以随时中断您的线程。你不需要放弃控制来失去控制。
2.  每个当前的 OS X 和 iOS 设备都具有多个内核，这意味着操作可以在*返回**之前`addOperation:`*开始（尽管这种极端不太可能仅仅因为开销）。更重要的是，其他操作可能能够在第一个操作时运行。

这两点，尤其是后者，也意味着“秩序”的问题几乎沦为无稽之谈。您在依赖树中安排的操作将按该树的顺序开始，否则根本没有顺序；您应该假设它们之间没有依赖关系的操作将同时运行，而不是一个接一个地运行。

启动操作后，向其添加依赖项无效。由于这可以在将其添加到队列后立即发生，因此如果您希望依赖项可靠地生效，则*必须在将操作添加到队列**之前*将依赖项添加到操作中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T20:03:23.507

进一步的实验似乎表明 NSOperationQueue 只要当前线程通过 、 或中断的线程将控制权交给它就开始运行`[queue waitUntilAllOperationsAreFinished]`操作`[NSThread sleepForTimeInterval: 0.000001]`。

（如果有人有更好的答案，我很乐意听到并接受它。）

# php - PHP + XPath + fputcsv - 将数据存储在数组中

> ID：10419815
> 
> 赞同：0
> 
> 时间：2012-05-02T18:45:33.867
> 
> 标签：php, arrays, xpath, fputcsv

我正在使用 DOM/Xpath 解析一些 HTML，最终目标是生成一个 .CSV 文件，其中包含我通过查询获取的数据。

下面的当前代码有效，但仅返回最后一个产品名称。我知道我在这里*走*在正确的轨道上，但我已经筋疲力尽，无法弄清楚这一点。任何帮助将不胜感激。谢谢。

```
$names = array();
$result = $xpath->query("//div[@class='product-name']");
foreach ($result as $nam) {
$names[] = $nam->nodeValue;
$i = 0;
$values=$names[$i] = $nam->nodeValue;
}

$list = array (
    array('Product Name','Stock Level','Price'),
    array($values, '456', '789'),
);

$fp = fopen('product-sheet.csv', 'w');

foreach ($list as $fields) {
    fputcsv($fp, $fields);
}

fclose($fp); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T19:05:14.563

问题是您在循环中设置了 $i 。

```
foreach ($result as $nam) {
$names[] = $nam->nodeValue;
$i = 0;
$values=$names[$i] = $nam->nodeValue;
} 
```

在每次迭代中，$i 都被重置为 0。试试这样的方法：

```
for($i=0; $i< count($result); $i++) {
    $names[] = $result->nodeValue;
    $values=$names[$i] = $result->nodeValue;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T20:30:37.547

我不完全确定您要达到的目标，但希望这将使您更接近目标。

```
<?php

        //mocked up input, substitute for your HTML source
        $input = "<html>
                    <div class='product-name'>test1</div>
                    <div class='product-name'>test2</div>
                    <div class='product-name'>test3</div>
                    <div class='product-name'>test4</div>
                    <div class='product-name'>test5</div>
                </html>";

        $doc = new DOMDocument();
        @$doc->loadHTML($input);
        libxml_use_internal_errors(FALSE);
        $xpath = new DomXPath($doc);

        $list = array (
            array('Product Name','Stock Level','Price')
        );

        $result = $xpath->query("//div[@class='product-name']");

        foreach ($result as $nam) {
            $value = $nam->nodeValue;
            $list[] = array($value, '456', '789');  //Appends an array to the lists array
        }

        $fp = fopen('product-sheet.csv', 'w');

        foreach ($list as $fields) {
            fputcsv($fp, $fields);
        }

        fclose($fp);

    ?> 
```

# java - Hazelcast的分布式锁不起作用

> ID：10419819
> 
> 赞同：3
> 
> 时间：2012-05-02T18:45:51.013
> 
> 标签：java, locking, hazelcast

我正在尝试测试我的分布式锁实现，但我仍然没有找到让它工作的方法。我使用两种简单的方法部署了一个 REST 服务，如下所示：

```
@GET
@Path("/lock")
@Produces("text/*")
public String lock() throws InterruptedException {
    Lock lock = distributedService.getDistributedLock("test");
    boolean result = lock.tryLock(5, TimeUnit.SECONDS);
    return result ? "locked" : "timeout";
}

@GET
@Path("/unlock")
@Produces("text/*")
public String unlock() {
    Lock lock = distributedService.getDistributedLock("test");
    lock.unlock();
    return "unlocked";
} 
```

**DistributedService**对象实现了 getDistributedLock() 方法：

```
@Override
public Lock getDistributedLock(String lockName) {
    return Hazelcast.getDefaultInstance().getLock(lockName);
} 
```

在 hazelcast.xml 文件中，我启用了 TCP-IP 连接并禁用了其他所有内容：

```
<network>
<port auto-increment="true">5701</port>
<join>
  <multicast enabled="false" />
  <tcp-ip enabled="true">
    <interface>192.168.0.01</interface>
    <interface>192.168.0.02</interface>
  </tcp-ip>
</join>
<interfaces enabled="false" />
<symmetric-encryption enabled="false" />
<asymmetric-encryption enabled="false" /> 
```

我在两台机器上部署了应用程序，IP地址对应于.xml文件（192.168.0.01和192.168.0.02），当我从浏览器调用服务时它第一次工作（它锁定并返回“锁定” ) 并且每次我调用 unlock() 方法时它都会正确返回（我得到字符串“unlocked”）但是在第一次之后，每次我调用 lock() 方法时我都会超时。看起来 unlock() 方法并没有解锁它。

有人可以指出我使用分布式锁和榛树的正确方法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-02T20:04:37.720

只有被锁定的线程才能解锁它。你是说你已经为锁定和解锁实现了 REST。而且我猜锁定和解锁的线程是不同的。这就是为什么它不起作用。尝试打印线程名称并查看自己。

# jsf-2 - JSF ExceptionHandler 从队列中删除事件导致 NullPointer

> ID：10419823
> 
> 赞同：0
> 
> 时间：2012-05-02T18:45:58.390
> 
> 标签：jsf-2

我们有一个自定义的 JSF2 异常处理程序......

```
 Iterator<ExceptionQueuedEvent> i = getUnhandledExceptionQueuedEvents().iterator();
        boolean isUnHandledException = false;
        SystemException se = null;
        while(i.hasNext()) {
            ExceptionQueuedEvent event = (ExceptionQueuedEvent)i.next();
            ExceptionQueuedEventContext context = (ExceptionQueuedEventContext)event.getSource();
            Throwable t = context.getException();
                    try {
                             if (apperror)
                                  take to app error page
                             if (filenotfound)
                                  take to page not found error page
                  }catch(){
                  } finally {
                    i.remove ().....causes problem....in filenot found...
..... 
                  } 
```

应用程序异常处理工作正常，没有任何问题。

但是我们自定义处理程序中的 FileNotFound 会导致问题。异常处理程序捕获 FileNotFound ，但是在尝试删除 queuedevent i.remove 时会导致 NullPointerException ，如果我评论 i.remove 它工作正常...

```
java.lang.NullPointerException
    at com.sun.faces.lifecycle.RenderResponsePhase.execute(RenderResponsePhase.java:96)
    at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101)
    at com.sun.faces.lifecycle.LifecycleImpl.render(LifecycleImpl.java:139)
    at javax.faces.webapp.FacesServlet.service(FacesServlet.java:594)
    at weblogic.servlet.internal.StubSecurityHelper$ServletServiceAction.run(StubSecurityHelper.java:227)
    at weblogic.servlet.internal.StubSecurityHelper.invokeServlet(StubSecurityHelper.java:125) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T20:07:49.390

这不是处理`FileNotFoundException`来自 Mojarra 的完全正确的地方。那就没有办法了`UIViewRoot`。第 96 行`RenderResponsePhase`尝试执行 a `facesContext.getViewRoot().getViewId()`，但该 NPE 失败。

最好使用 servlet 过滤器来处理它，或者`<error-page>`如果您有自定义 404 错误页面，则只需使用它。

因此，*无论是*在映射到的过滤器中`FacesServlet`：

```
try {
    chain.doFilter(request, response);
}
catch (FileNotFoundException e) {
    response.sendError(HttpServletResponse.SC_NOT_FOUND, request.getRequestURI());
} 
```

然后，这将出现在服务器的默认 HTTP 404 错误页面中，或者任何`<error-page>`带有`<error-code>`404的自定义页面中[。OmniFaces](http://omnifaces.org)也有[这样的过滤器](http://showcase.omnifaces.org/filters/FacesExceptionFilter)。

*或*在匹配中。`<error-page>`_`web.xml``<exception-type>``FileNotFoundException`

```
<error-page>
    <exception-type>java.io.FileNotFoundException</exception-type>
    <location>/WEB-INF/errorpages/404.xhtml</location>
</error-page> 
```

# ssrs-2008 - 查询参数的默认表达式包含错误

> ID：10419824
> 
> 赞同：1
> 
> 时间：2012-05-02T18:46:00.760
> 
> 标签：ssrs-2008, reporting-services

我有一个引用 proc 的数据集。该过程接受@UserName 在我的数据集的参数中，我指定了一个名为@UserName 的新参数，其默认值是表达式 =User!UserID 但是当报告累到渲染时我仍然会收到此错误：

查询参数 @UserName 的默认值表达式包含错误 [BC30654] 函数、Get 或运算符中的“返回”语句必须返回值

我唯一能想到的是，我没有修改我在报告中定义的现有数据源，而是删除并添加了一个新数据源。我希望这无关紧要，只要报告有一个有效的数据源可以继续包含这些字段...我只是切换此报告以引用我们当前数据库的副本以用于测试目的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T21:05:46.490

听起来报告参数没有传递给存储过程。在 Dataset Properties 中，单击 Parameters 选项卡并检查存储的 proc 参数 @Username 是否正确映射到 Report 参数 @Username。

# javascript - 我将如何扩展一个 superdiv，然后使用 scrollTo 滚动到一个 subdiv？

> ID：10419825
> 
> 赞同：0
> 
> 时间：2012-05-02T18:46:07.547
> 
> 标签：javascript, jquery, html, animation, user-interface

正如您可能已经从我的帖子标题中猜到的那样，我通常不知道如何使用 jQuery 或 javascript。我知道这不是一个很难组合的功能，但我似乎无法自己完成。

几乎我想要做的（理论上）是有四个大盒子覆盖了可用的内容区域，这些内容区域链接到（文字）菜单项，如隐藏在 div 中的早餐、午餐、配菜和饮料，当其中一个点击他们，完整的菜单会向下展开并优雅地向下滚动到他们点击的那个，之后他们可以随意浏览所有部分。

我不知道该怎么做，每次我尝试它都会打破页面。希望有超过五分钟经验的人可以提供帮助。我对 CSS 和 HTML 完全没有问题，但脚本编写很可怜。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T19:00:45.720

所以对于滚动你可以做这样的[事情](http://djpate.com/2009/10/07/animated-scroll-to-anchorid-function-with-jquery/)。

我不太明白整个菜单部分应该如何工作，但您可以最初隐藏它，然后在单击菜单项链接时显示它。

# ruby-on-rails - 为什么此 SWFUpload -> Presigned Post to S3 设置不起作用？（导轨）

> ID：10419827
> 
> 赞同：1
> 
> 时间：2012-05-02T18:46:20.290
> 
> 标签：ruby-on-rails, amazon-s3, swfupload

我正在尝试使用 SWFUpload 和 AWS-SDK 对 S3 进行预签名。长话短说，它不起作用。

我因此设置了 SWFUpload（请原谅咖啡脚本）：

```
@swfu = new SWFUpload
         flash_url: "<%= asset_path 'swfupload.swf' %>"
         file_size_limit: "1000 MB"
         file_types: "*.mp3"
         file_queue_limit:1
         debug: true
         upload_url: "http://<%= configatron.aws.cms.bucket %>.s3.amazonaws.com"
         button_placeholder_id : "SWFUploadButton"
         button_action: SWFUpload.BUTTON_ACTION.SELECT_FILE
         button_width: '112'
         button_height: '33'
         button_text: '<button class="orange-button">Upload MP3s</button>',
         button_cursor : SWFUpload.CURSOR.HAND
         http_success : [201, 303, 200]
         file_post_name: "file"
         file_queued_handler: (data) =>
           @queued(data) 
```

当文件排队时，运行：

```
$.ajax
  url: '/uploads/new'
  data: { key: file.name, bucket: '<%= configatron.aws.cms.bucket %>' }
  success: (data) =>
    @upload(data) 
```

`/uploads/new`最后，使用 aws-sdk gem 指向一个返回 JSON 的控制器（我已经剪掉了一些关于实例化存储桶的部分）：

```
 policy = bucket.presigned_post key: key, success_action_status: 201, acl: 'public-read'
  render json: policy 
```

示例 JSON 响应如下所示：

```
{"AWSAccessKeyId":"MY_KEY_ID",
 "key":"blutrotermond.mp3",
 "policy":"base64-encoded-policy",
 "signature":"the-signature",
 "acl":"public-read",
 "success_action_status":"201"} 
```

回到 javascript 领域，带着签名，我接受这个响应并将参数添加到 SWFUpload：

```
upload: (data) ->
  @swfu.setPostParams data
  console.log "uploading...."
  @swfu.startUpload() 
```

然后 SWFUpload 的控制台告诉我，亚马逊对我的签名过程不满意（或者我假设，因为无论 SWFUpload 做什么神奇的事情都意味着 POST 本身不会出现在 Chrome 的检查器中，从而使我无法更直接地查看发布的内容）：

```
SWF DEBUG: Event: fileQueued : File ID: SWFUpload_0_0
SWF DEBUG: Event: fileDialogComplete : Finished processing selected files. Files selected: 1\. Files Queued: 1
SWF DEBUG: StartUpload: First file in queue
SWF DEBUG: Event: uploadStart : File ID: SWFUpload_0_0
SWF DEBUG: Global Post Item: signature=signature
SWF DEBUG: Global Post Item: acl=public-read
SWF DEBUG: Global Post Item: AWSAccessKeyId=MY_KEY_ID
SWF DEBUG: Global Post Item: key=blutrotermond.mp3
SWF DEBUG: Global Post Item: success_action_status=201
SWF DEBUG: Global Post Item: policy=MY_ENCODED_POLICY
SWF DEBUG: ReturnUploadStart(): File accepted by startUpload event and readied for upload.  Starting upload to http://my-bucket.s3.amazonaws.com for File ID: SWFUpload_0_0
SWF DEBUG: Event: uploadProgress (OPEN): File ID: SWFUpload_0_0
SWF DEBUG: Event: uploadProgress: File ID: SWFUpload_0_0\. Bytes: 490792\. Total: 2167327
SWF DEBUG: Event: uploadProgress: File ID: SWFUpload_0_0\. Bytes: 2167327\. Total: 2167327
SWF DEBUG: Event: uploadError: HTTP ERROR : File ID: SWFUpload_0_0\. HTTP Status: 403.
SWF DEBUG: Event: uploadComplete : Upload cycle complete. 
```

我已经深入了解 AWS-SDK，这就是政策的内容，以及正在签署的内容。对我来说似乎是对的。

```
{"expiration":"2012-05-02T19:33:31Z",
 "conditions":[{"bucket":"my-bucket"},
               {"key":"blutrotermond.mp3"},
               {"acl":"public-read"},
               {"success_action_status":"201"}]} 
```

所以我不确定如何进一步调试它；SWFUpload 对我隐藏了一些东西，我不确定我的帖子参数/签名有什么问题。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T08:57:38.927

[您可以使用WireShark](http://www.wireshark.org/)调试 Amazon 响应。

我看到的第一件事是您没有将“x-amz-meta-uuid”参数发布到亚马逊。您可以检查这个[PHP 示例](http://shout.setfive.com/2011/04/21/upload-directly-to-s3-with-swfupload/)并将其移植到 Ruby。实际上我在 .NET 上做过并且效果很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T16:10:45.470

答案原来是 Flash 为所有帖子上传添加了一个字段，需要对帖子中签名的参数进行调整。我在 aws-sdk gem 中添加了对该字段的支持，瞧。

对于调试，可以通过更详细地检查 aws-sdk 抛出的异常来从 AWS 获得错误响应。实际的`Net::HTTP`响应在某处，并且有一条描述性错误消息，异常消息本身正在吞噬。

请参阅[https://github.com/amazonwebservices/aws-sdk-for-ruby/pull/43](https://github.com/amazonwebservices/aws-sdk-for-ruby/pull/43)了解添加对此的支持的代码`aws-sdk`，以及添加到 post 参数的字段的快速示例。

# objective-c - Obj-C方法命名：setup方法

> ID：10419829
> 
> 赞同：0
> 
> 时间：2012-05-02T18:46:29.747
> 
> 标签：objective-c, methods, naming-conventions

想象一个普通的`UIViewController`子类。我们想在之前执行“设置内容” `-viewDidWhatever`，但问题是可以调用三种方法`-initWithNibName`，`-initWithCoder`或者只是`-init`取决于它是如何创建的。

解决方案是创建`-setup`从所有这三个中调用，但我对名称有点不确定。我的问题是：这种方法有标准命名吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T18:57:39.167

这样做时，我通常`-setup`自己命名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T18:54:51.783

根据你想要做什么，你可以把它放在 中`+ (void)initialize`，它继承自`NSObject`并会在类接收到它的第一条消息之前自动被调用。

看看这里：[Apple 开发者库：NSObject 类参考](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/nsobject_Class/Reference/Reference.html#//apple_ref/occ/clm/NSObject/initialize)

# javascript - Javascript匿名函数 - 定义

> ID：10419830
> 
> 赞同：2
> 
> 时间：2012-05-02T18:46:37.457
> 
> 标签：javascript, anonymous-function

> **可能重复：**
> [自动执行匿名 JavaScript 函数的括号位置？](https://stackoverflow.com/questions/3384504/location-of-parenthesis-for-auto-executing-anonymous-javascript-functions)
> [(function() {…}()); 之间有区别吗？和 (function() {…})();?](https://stackoverflow.com/questions/3783007/is-there-a-difference-between-function-and-function)
> [立即调用匿名函数的两种方式（function(d){ }() ）；和（函数（x）{}）（）；](https://stackoverflow.com/questions/10417071/two-ways-of-immediate-call-to-anonymous-function-functiond-and-funct)

给定的两种声明和调用匿名函数的方式之间有区别吗？

选项1：

```
(function(){
    console.log('Declare and call anonymous function');
})(); 
```

选项 2：

```
(function(){
    console.log('Declare and call anonymous function');
}()); 
```

这两个函数在评估后都会被调用。但我无法理解其中的区别。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T18:50:43.363

不，没有区别：这两个选项在语法上不同，但在语义上是等价的。考虑一个命名函数：

```
(foo()) 
```

对比

```
(foo)() 
```

也许更清楚它们是如何相同的。

# c# - Quartz.net 触发先前计划的作业

> ID：10419832
> 
> 赞同：1
> 
> 时间：2012-05-02T18:46:40.970
> 
> 标签：c#, .net, quartz.net

我刚开始使用 Quartz.net。我写了一个小程序来安排多个工作。我真的不确定我是否正确编码。希望有一些 Quartz.NET 专家可以提供帮助。我有三个问题：

1.  我的触发器设置看起来正确吗？我想每天上午 9 点和下午 3 点运行一份工作（我知道您看不到该`market.LocalOpenTime`物业，但它始终是今天上午 9 点的日期，而另一个对象是下午 3 点。

2.  我注意到当我运行程序时，它总是会运行上午 9 点的作业（过去安排的）。反正我可以关闭这个功能吗？我在下午 1 点运行程序。我假设如果我在下午 4 点运行它，它将运行这两个过去预定的作业。

3.  我怎样才能只在工作日运行这些工作？

    ```
    foreach (IJob job in GetJobsToSchedule())
    {
        i++;
        var market = (IMarket)job;

        IJobDetail jobDetail = new JobDetailImpl(market.JobName, null, market.GetType());           
        ITrigger trigger = new SimpleTriggerImpl(market.JobName, i.ToString(), market.LocalOpenTime, null, 1000, new TimeSpan(1, 0, 0, 0));

        sched.ScheduleJob(jobDetail, trigger);
    } 
    ```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T20:04:02.500

1) 您可能需要考虑使用`CronTriggerImpl`带有`0 0 9,15 * * ?`. 这将允许您使用 1 个触发器设置整个日程安排。这是关于 cron 触发器的一个很好的教程（即使它是针对以前的 Quartz 版本的）：http: [//quartznet.sourceforge.net/tutorial/lesson_6.html](http://quartznet.sourceforge.net/tutorial/lesson_6.html)

2) 将`myCronTrigger.MisfireInstruction`属性设置为 DoNothing。文档说这个值应该在`CronTriggerImpl`类中定义，但我没有看到它。在 Visual Studio 中使用 IntelliSense 可能会更好。

3) 查看上面 (1) 中的 Cron 教程链接。你可以使用这样的东西：`0 0 9,15 * * MON-FRI`

# asp.net - ASP.NET MVC 三态复选框服务器控件

> ID：10419833
> 
> 赞同：0
> 
> 时间：2012-05-02T18:46:53.223
> 
> 标签：asp.net, asp.net-mvc, checkbox

我有一个要求，我需要在哪里使用三态复选框。我正在根据复选框的选中状态构建一个 T-SQL 查询。我的要求如下

如果复选框选中 - 我需要在查询中使用子句 - IN（检查值）如果未选中复选框，我需要忽略查询中的复选框值。如果复选框处于不确定状态 - 我需要使用 NOT IN（检查值）

我浏览了多个站点，但除了三州复选框树之外，没有获得三州复选框的详细信息

谁能帮助我实现这一目标？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T18:49:58.283

如果我对问题的理解正确，您有以下三种状态： - 从未选中 - 选中 - 未选中

为了实现您所需要的，我将添加一个附加隐藏字段来保存实际状态值并在控制器级别使用它。您还需要添加一点 javascript 来处理这三种状态并将复选框值与隐藏字段同步。

# objective-c - 不能与之前的“类型名称”声明说明符结合

> ID：10419835
> 
> 赞同：12
> 
> 时间：2012-05-02T18:47:03.170
> 
> 标签：objective-c, ios

我的 iOS 应用程序正在运行，突然间我看到了这个错误：“不能与以前的 'type-name' 声明说明符结合”。关于可能导致此错误的任何想法？

```
#import "SalesAPIManager.h"

@interface SalesDelegate : NSObject { // error points to this line
    __unsafe_unretained id<SalesAPIManagerDelegate> delegate_;
}

@property (unsafe_unretained, nonatomic) id<SalesAPIManagerDelegate> delegate;

- (id)initWithDelegate:(id<SalesAPIManagerDelegate>)delegate;

@end 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-10-28T10:08:16.943

同样，我在项目中的随机文件中有错字。这只是一些不小心放在评论前的纯文本。我的修复/查找建议是放一个 ; 就在被标记的语句之前。然后，当我编译时，这会向错误的文本发出警告。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-04-01T18:22:02.443

这是 Xcode 的缺点之一。Xcode 是有史以来最糟糕的 IDE 之一，Apple 正在努力使其每次更新都变得更好。但是，当您在 Xcode 的编译器未查看的某些地方添加“某些单词”时，就会出现此问题。

我的情况如图所示：

![在此处输入图像描述](../Images/e39faa689768fe7a788155547c80eacf.png)

我忘了删除 AppDelegate.h 中的 RESideMenu 这个词，奇怪的是 Xcode 在构建之前接受代码，当它触发错误时，它会在另一个不相关的类中发出它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-01T19:03:15.713

我有同样的问题。原来我的`main.m`文件中有错字。一旦我清除了它，这个错误就消失了。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-07-25T20:35:51.667

当我的文件中有一些我忘记取出的不完整代码时，我看到了这个错误。编译器在返回类型的方法开头指出了错误，所以我花了很多时间查看方法声明和调用。结果发现错误的错字在方法之上。因为没有“;” 编译器只能告诉 void 关键字放错了位置。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-24T06:48:12.497

我遇到同样的问题。在清理了 .h 文件底部的一些垃圾文本后，我终于修复了它。你可以试试。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-03-17T01:26:31.093

我知道这已经很晚了，但是，我刚刚在我的 cpp Xcode 项目（第 31 行）中出现了这个错误，并且在我直接完成了它上面的字符串初始化之后它消失了（第 28 行）。我的代码如下： [不能与以前的“类型名称”声明说明符结合](https://i.stack.imgur.com/ztb95.png)

```
string //STRING NEEDING INITIALIZATION

void AMPM() {

    if ((firstHourChar == 1) && (secondHourChar > 2)) {
        afterAM = true;
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-06-17T06:50:40.380

我在头文件中得到它，而实际上错误在.cpp 中。原来我有一个方法试图以粗略的方式返回一个布尔值：

```
return (x == 1 && y == 2); 
```

事实证明这不起作用，但 Xcode 以这种非常模糊的方式告诉我。

不确定这是否有帮助，但这是他们看似荒凉的另一个例子。

# sharepoint-2010 - 将用户和权限从 MOSS 2007 迁移到 SharePoint 2010

> ID：10419836
> 
> 赞同：0
> 
> 时间：2012-05-02T18:47:05.533
> 
> 标签：sharepoint-2010

我已将 MOSS 2007 迁移到 SharePoint 2010。我面临的问题是登录 SharePoint 网站时。

唯一可以登录的用户是网站集管理员。

需要帮忙。

笔记：

请注意，当我将内容从 MOSS 2007 迁移到 SharePoint 2010 时。我观察到用户显示为：aspnetsqlmembershipprovider:username@domain.com

另一方面，用户必须显示为：

我：0#。f | aspnetsql 会员资格提供程序| 用户名@domain.com 。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-02T17:13:59.270

尝试使用 SP WebApplication 的 MigrateUsers() 方法。

```
$w = Get-SPWebApplication "http://yoursitecollection:port"
$w.MigrateUsers($True) 
```

请参阅以下内容：

[http://blogs.msdn.com/b/dhirajm/archive/2010/08/09/migrate-moss-2007-fba-to-sharepoint-2010.aspx](http://blogs.msdn.com/b/dhirajm/archive/2010/08/09/migrate-moss-2007-fba-to-sharepoint-2010.aspx)

[http://msdn.microsoft.com/en-us/library/ee554321.aspx](http://msdn.microsoft.com/en-us/library/ee554321.aspx)

请注意，如果您有角色，则需要单独迁移这些角色。看 ：

[http://codenice.com/migrate-users-permissions-from-sharepoint-2007-fba-site-to-sharepoint-2010-fba-site/](http://codenice.com/migrate-users-permissions-from-sharepoint-2007-fba-site-to-sharepoint-2010-fba-site/)

# java - 如何找出 BufferedImage 在 Java 中的 Alpha 位置？

> ID：10419838
> 
> 赞同：7
> 
> 时间：2012-05-02T18:47:24.123
> 
> 标签：java, graphics, alpha, bufferedimage

我有一个 BufferredImage 和一个 boolean[][] 数组。我想在图像完全透明的情况下将数组设置为 true。

就像是：

```
for(int x = 0; x < width; x++) {
    for(int y = 0; y < height; y++) {
        alphaArray[x][y] = bufferedImage.getAlpha(x, y) == 0;
    }
} 
```

但是 getAlpha(x, y) 方法不存在，我没有找到其他可以使用的方法。有一个 getRGB(x, y) 方法，但我不确定它是否包含 alpha 值或如何提取它。

谁能帮我？谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-02T19:05:57.433

```
public static boolean isAlpha(BufferedImage image, int x, int y)
{
    return image.getRBG(x, y) & 0xFF000000 == 0xFF000000;
} 
```

```
for(int x = 0; x < width; x++)
{
    for(int y = 0; y < height; y++)
    {
        alphaArray[x][y] = isAlpha(bufferedImage, x, y);
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-02T19:14:36.587

试试这个：

```
 Raster raster = bufferedImage.getAlphaRaster();
    if (raster != null) {
        int[] alphaPixel = new int[raster.getNumBands()];
        for (int x = 0; x < raster.getWidth(); x++) {
            for (int y = 0; y < raster.getHeight(); y++) {
                raster.getPixel(x, y, alphaPixel);
                alphaArray[x][y] = alphaPixel[0] == 0x00;
            }
        }
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-07T14:23:53.083

```
public boolean isAlpha(BufferedImage image, int x, int y) {
    Color pixel = new Color(image.getRGB(x, y), true);
    return pixel.getAlpha() > 0; //or "== 255" if you prefer
} 
```

# c# - 在服务器路径上模拟写入文件的用户权限是什么？

> ID：10419841
> 
> 赞同：0
> 
> 时间：2012-05-02T18:47:31.787
> 
> 标签：c#, filestream

我使用了下面的示例，但我仍然有异常：

**System.Security.Permissions.SecurityPermission** **下面是技术支持人员的诊断信息：请求类型“System.Security.Permissions.SecurityPermission, mscorlib”的权限**

管理员说用户凭证具有完全的读写权限

```
IntPtr userToken = IntPtr.Zero; 
bool success = External.LogonUser( 
    "userID",  
    "domain.com",  
    "MyPassword",  
    (int) AdvApi32Utility.LogonType.LOGON32_LOGON_INTERACTIVE, //2 
    (int) AdvApi32Utility.LogonProvider.LOGON32_PROVIDER_DEFAULT, //0 
    out userToken); 

if (!success) 
{ 
    throw new SecurityException("Logon user failed"); 
} 

using (WindowsIdentity.Impersonate(userToken)) 
{ 
    //Create a new GUID, extract the extension and create a new unique filename 
    string strFileGUID = System.Guid.NewGuid().ToString(); 
    string extension = Path.GetExtension(attachment.AttachmentFileName); 
    string tempfilename = strFileGUID  + extension;   

    string path = "ServerPath"; 

    //Open a filestream and write the contents of the file at server path 
    FileStream fs = new FileStream(path, FileMode.Create, FileAccess.Write ); 
    fs.Write(fileContent.Content, 0, fileContent.Content.Length); 
    fs.Flush(); 
    fs.Close(); 

} 
```

当我被困在这个问题上时，你能帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T19:56:19.400

您的代码没有以完全信任的方式运行，或者没有获得正确的 .Net 权限来执行 PInvoke 或访问本地文件。它与 Windows 用户权限无关。链接的问题将使您开始了解 .Net CAS - 代码访问安全性 -[为什么我的 .NET 应用程序中出现 System.Security.Permissions.SecurityPermission 错误？](https://stackoverflow.com/questions/552436/why-am-i-getting-a-system-security-permissions-securitypermission-error-in-my-n).

一种简单的检查方法是在有问题的机器上本地运行您的应用程序以获得本地驱动器 - 应该获得完全信任并且不再获得 CAS 异常。

# sql - 棘手的 SQLite 查询，可以使用一些帮助

> ID：10419844
> 
> 赞同：0
> 
> 时间：2012-05-02T18:47:44.397
> 
> 标签：sql, sqlite, join, inner-join

我有一个相当混乱的**SQLite**查询，我似乎无法完全理解。

我有以下四个表：

## 表“S”

```
sID (string/guid)  | sNum (integer)
-----------------------------------
aaa-aaa                   1
bbb-bbb                   2
ccc-ccc                   3
ddd-ddd                   4
eee-eee                   5
fff-fff                   6
ggg-ggg                   7 
```

## 药片”

```
tID (string/guid) | ... other stuff
-----------------------------------
000
www
xxx
yyy
zzz 
```

## 表“S2TMap”

```
sID    |    tID
-------------------
aaa-aaa    000
bbb-bbb    000
ccc-ccc    xxx
ddd-ddd    yyy
eee-eee    www
fff-fff    000
ggg-ggg    000 
```

## 表“温度”

```
oldID (string/guid) | newID (string/guid)
------------------------------------------
   dont care          fff-fff
   dont care          ggg-ggg
   dont care          zzz 
```

如果 temp.NewID 表中不存在 sID，我需要能够获取指定“t”中存在的 MAX() sNum。

**例如**，给定 T '000'，'000' 有 S 'aaa-aaa'、'bbb-bbb'、'fff-fff' 和 'ggg-ggg' 映射到它。但是，TEMP 表中同时存在“fff-fff”和“ggg-ggg”，这意味着我只需要查看“aaa-aaa”和“bbb-bbb”。因此，该语句将返回**"2"**。

* * *

我该怎么做呢？

我正在考虑按照以下方式选择“临时”表中不存在的 s，但我不确定如何获得座位的最大值，并且只能根据特定的“t”来做

```
SELECT s.sID, s.sNum FROM s WHERE NOT EXISTS ( SELECT newID from temp where tmp.newID = s.sID) 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T19:00:29.930

试试这个：

```
select max(s.sNum) result from s2tmap st
join s on st.sId = s.sId
where st.tId = '000' and not exists (
  select * from temp
  where temp.newId = st.sId) 
```

这是玩的[小提琴。](http://sqlfiddle.com/#!5/26124/9)

另一种可能效率较低的选择是：

```
select max(s.sNum) result from s2tmap st
join s on st.sId = s.sId
where st.tId = '000' and st.sId not in (
  select newId from temp) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T19:00:09.670

以下查询应为您提供 T 列表及其最大 sNums（只要所有都存在于 S 和 S2TMap 中）：

```
SELECT t.tID, MAX(sNum)
FROM S s
JOIN S2TMap map on s.sID=map.sID
JOIN T t on map.tId=t.tID
LEFT JOIN temp tmp on s.sID=tmp.newID
WHERE tmp.newID IS NULL 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-02T18:55:07.877

你很接近，你只需要加入 S2TMap，然后加入 T，以便将结果集限制为给定的 T。

```
SELECT MAX(s.sNum)
FROM s
    INNER JOIN S2TMap m on m.sID = s.sID
    INNER JOIN t on t.tID = m.tID
WHERE t.tID = '000'
    AND NOT EXISTS (
        SELECT newID FROM temp WHERE temp.newID = s.sID
    ) 
```

# c# - 用另一个具有不同参数的抽象方法覆盖

> ID：10419845
> 
> 赞同：0
> 
> 时间：2012-05-02T18:47:45.247
> 
> 标签：c#, oop

我有一个抽象类 ClassA，其抽象方法采用 ClassB 类型的参数。几个类派生自它。现在我添加另一个项目，它具有类似的功能，但需要稍微不同的基类 A 来派生它的几个类。主要区别：新的基类 ClassC 不应将 ClassB 作为参数，而是另一个从 B 派生的 ClassD。然后 ClassC 应该再次被几个类用作基础。

这可能吗？这更多是出于好奇。我知道通过这样做可以使用泛型：

```
public abstract void Method1<T>(T parameter) where T : ClassB;
...
public override void Method1<ClassB>(ClassB parameter) { 
```

没有泛型可以吗？除了必须键入两次之外，它们还有什么缺点吗？

```
abstract class ClassA
{
    public abstract void Method1(ClassB parameter);
}

class DerivingClasses1 : ClassA
{
    public override void Method1(ClassB parameter)
    {
        // do something
    }
}

// -------

abstract class ClassC : ClassA
{
    // This would have to override Method1 of ClassA somehow,
    // instead of overloading it.
    public abstract void Method1(ClassD parameter);
}

class DerivingClasses2 : ClassA
{
    public override void Method1(ClassD parameter)
    {
        // do something
    }
}

// -------

class ClassB
{
}

class ClassD : ClassB
{
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T18:59:43.067

在我看来，最好的方法是使用密封的实现来覆盖基类方法，该实现使用新的参数类型调用重载，从而将用户与类型转换隔离开来。

```
abstract class ClassC : ClassA
{
    public override sealed void Method1(ClassB parameter)
    {
        this.Method1(parameter as ClassD);
    }

    public abstract void Method1(ClassD parameter);
} 
```

**编辑**：如果在生产中使用，您应该执行正确的类型检查以避免出现意外的空值：

```
abstract class ClassC : ClassA
{
    public override sealed void Method1(ClassB parameter)
    {
        if (!(parameter is ClassD))
            throw new ArgumentException(
                "Parameter must be of type ClassD.", "parameter");

        this.Method1((ClassD)parameter);
    }

    public abstract void Method1(ClassD parameter);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T18:57:26.427

> 用另一个具有不同参数的抽象方法覆盖

这实际上是不可能的，但是您可以使用通用接口：

```
interface IMyType {}

class MyTypeBase 
{
  public abstract void Method1(IMyType parameter); 
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T18:58:06.343

只需在 ClassC 中实现这两种方法。

# python - 用于嵌套类型的递归字符串到 int 转换器

> ID：10419846
> 
> 赞同：0
> 
> 时间：2012-05-02T18:47:48.903
> 
> 标签：python, string, integer, nested, type-conversion

解串行模块有时无法识别值的类型。我想在任何嵌套结构中找到或创建通用转换 str->int 的函数。我写了一些东西，但它看起来很丑。

一个项目的转换器

```
from decimal import Decimal
def convert_from(s):
    if not isinstance(s, basestring):
        return s
    possible_types = [float, Decimal, int]
    if '.' in s:
        possible_types.remove(int) # it cannot be!
        parts = s.split('.')
        if len(parts) > 2:
            return s
        if len(parts[1]) <= 2:
            possible_types.remove(float) 
    else:
        possible_types.remove(Decimal)
        possible_types.remove(float)

    for convertor in possible_types:
        try:
            return convertor(s)
        except:
            pass
    return s 
```

捷径：

```
def is_iterable(iterable): 
    try:
        it = iter(iterable)
    except:
        return False
    return True

def process_plain(iterable): # convert a signle list
    res = []
    for k in iterable:
        pk = k
        if isinstance(k, basestring):
            pk = convert_from(k)
        elif is_iterable(k):
            pk = convert_all(k)
        res.append(pk)
    return res 
```

决赛：

```
def convert_all(iterable):
    if isinstance(iterable, basestring) or not is_iterable(iterable):
        return iterable

    keys = list(iterable)
    vals = []
    if isinstance(iterable, dict):
        vals = iterable.values()

    processed_keys = process_plain(keys)  #[]
    processed_vals = process_plain(vals)  #[]        

    if isinstance(iterable, dict):
        return type(iterable)(zip(processed_keys, processed_vals))

    return type(iterable)(processed_keys) 
```

结果：

```
d = {
'a': 5,
'2': ['1', 2, '3'],
666: {
    '15': 25,
    3: '255',
    ('55',66,'12', '2.00'): 'string',
    'nested again': {
        5: '12',
        '12.12': 5
    }

}
}

print convert_all( d )

{'a': 5, 666: {3: 255, 'nested again': {Decimal('12.12'): 5, 5: 12}, (55, 66, 12, Decimal('2.00')): 'string', 15: 25}, 2: [1, 2, 3]} 
```

# c# - 将 System.Action 转换为字符串

> ID：10419849
> 
> 赞同：-3
> 
> 时间：2012-05-02T18:47:55.293
> 
> 标签：c#

我有一个功能...

```
var neighbours =
    from x in Enumerable.Range(0, array2.GetLength(0))
        .Where(x => Math.Abs(x - refx) <= 1)
    from y in Enumerable.Range(0, array2.GetLength(1))
        .Where(y => Math.Abs(y - refy) <= 1)
    select new { x, y };
neighbours.ToList().ForEach(Console.WriteLine); 
```

这个函数运行良好。但我想要：

```
var neighbours =
    from x in Enumerable.Range(0, array2.GetLength(0))
        .Where(x => Math.Abs(x - refx) <= 1)
    from y in Enumerable.Range(0, array2.GetLength(1))
        .Where(y => Math.Abs(y - refy) <= 1)
    select new { x, y };
neighbours.ToList().ForEach(label3.Text); 
```

它不起作用。所以，我想将 System.Action 转换为字符串......对此有什么想法吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-02T18:50:23.083

您*真的*不想将操作转换为字符串。您想创建一个*具有*价值的操作。我*怀疑*你可能想要类似的东西：

```
neighbours.ToList().ForEach(x => label3.Text += x.ToString()); 
```

（很难说，但这是我根据您的示例代码的最佳猜测。）

不过，就字符串连接而言，这非常令人讨厌。也许你想要：

```
string text = string.Join("\r\n", neighbours);
label3.Text = text; 
```

?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T02:28:01.427

我认为相当于

```
neighbours.ToList().ForEach(Console.WriteLine); 
```

会是这样的：

```
neighbours.ToList().ForEach(AppendLabelLine); 
```

其中*AppendLabelLine*可以定义为：

```
private void AppendLabelLine(object o) {
   var sb = new StringBuilder(label3.Content as string);
   if (sb.Length > 0) sb.AppendLine();
   sb.Append(o);
   label3.Content = sb.ToString();
} 
```

或者，同样使用内联 lambda 表达式：

```
neighbours.ToList().ForEach(o => {
   var sb = new StringBuilder(label3.Content as string);
   if (sb.Length > 0) sb.AppendLine();
   sb.Append(o);
   label3.Content = sb.ToString();
}); 
```

# ios - 裁剪像素缓冲区

> ID：10419853
> 
> 赞同：3
> 
> 时间：2012-05-02T18:48:05.883
> 
> 标签：ios, uiimage, core-graphics

我正在使用以下方法将来自相机的图像数据转换为 UIImage。为了节省一些时间和内存，我想在将其转换为 UIImage 之前裁剪图像数据。

理想情况下，我传入一个cropRect，然后取回一个裁剪后的UIImage。但是，由于相机输出的大小可能会根据我使用的是照片还是视频预设而有所不同，因此我可能不知道cropRect 使用什么尺寸。我可以使用cropRect，类似于焦点或曝光点，它使用（0,0）和（1,1）之间的CGPoint，并对cropRect的CGSize进行类似的操作。或者我可以在调用以下命令之前获取 sampleBuffer 的尺寸，并传入适当的cropRect。我想要一些关于我应该使用的建议。

我也想知道如何最好地裁剪，以便不必创建整个 UIImage 然后将其裁剪回来。通常，我只对保留大约 10-20% 的像素感兴趣。我假设我必须遍历像素，并开始将cropRect 复制到不同的像素缓冲区中，直到获得所需的所有像素。

请记住，根据 可能会发生旋转`orientation`。

```
+ (UIImage *) imageFromSampleBuffer:(CMSampleBufferRef) sampleBuffer orientation:(UIImageOrientation) orientation
{
    // Create a UIImage from sample buffer data
    // Get a CMSampleBuffer's Core Video image buffer for the media data
    CVImageBufferRef imageBuffer = CMSampleBufferGetImageBuffer(sampleBuffer); 
    // Lock the base address of the pixel buffer
    CVPixelBufferLockBaseAddress(imageBuffer, 0); 

    // Get the number of bytes per row for the pixel buffer
    void *baseAddress = CVPixelBufferGetBaseAddress(imageBuffer); 

    // Get the number of bytes per row for the pixel buffer
    size_t bytesPerRow = CVPixelBufferGetBytesPerRow(imageBuffer); 
    // Get the pixel buffer width and height
    size_t width = CVPixelBufferGetWidth(imageBuffer); 
    size_t height = CVPixelBufferGetHeight(imageBuffer); 

    // Create a device-dependent RGB color space
    CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB(); 

    // Create a bitmap graphics context with the sample buffer data
    CGContextRef context = CGBitmapContextCreate(baseAddress, width, height, 8, 
                                                 bytesPerRow, colorSpace, kCGBitmapByteOrder32Little | kCGImageAlphaPremultipliedFirst); 
    // Create a Quartz image from the pixel data in the bitmap graphics context
    CGImageRef quartzImage = CGBitmapContextCreateImage(context); 
    // Unlock the pixel buffer
    CVPixelBufferUnlockBaseAddress(imageBuffer,0);

    // Free up the context and color space
    CGContextRelease(context); 
    CGColorSpaceRelease(colorSpace);

    // Create an image object from the Quartz image
    UIImage *image = [UIImage imageWithCGImage:quartzImage scale:(CGFloat)1.0 orientation:orientation];
    // Release the Quartz image
    CGImageRelease(quartzImage);

    return (image);
} 
```

总之：

1.  我应该传入一个指定（0,0,0,0）和（1,1,1,1）之间的矩形的cropRect，还是传入一个指定精确像素位置（50,50,100,100）的cropRect？
2.  如何最好地裁剪像素缓冲区？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T21:06:33.450

我认为您应该将像素用作cropRect，因为您必须至少在某个时候将浮点值转换为像素值。下面的代码未经测试，但应该给你的想法。

```
CGRect cropRect = CGRectMake(50, 50, 100, 100); // cropRect
CVPixelBufferRef pixelBuffer = CMSampleBufferGetImageBuffer(sampleBuffer);
CVReturn lock = CVPixelBufferLockBaseAddress(pixelBuffer, 0);
if (lock == kCVReturnSuccess) {
    int w = 0;
    int h = 0;
    int r = 0;
    int bytesPerPixel = 0;
    unsigned char *buffer;
    w = CVPixelBufferGetWidth(pixelBuffer);
    h = CVPixelBufferGetHeight(pixelBuffer);
    r = CVPixelBufferGetBytesPerRow(pixelBuffer);
    bytesPerPixel = r/w;
    buffer = CVPixelBufferGetBaseAddress(pixelBuffer);
    UIGraphicsBeginImageContext(cropRect.size); // create context for image storage, use cropRect as size
    CGContextRef c = UIGraphicsGetCurrentContext();
    unsigned char* data = CGBitmapContextGetData(c);
    if (data != NULL) {
        // iterate over the pixels in cropRect
        for(int y = cropRect.origin.y, yDest = 0; y<CGRectGetMaxY(cropRect); y++, yDest++) { 
            for(int x = cropRect.origin.x, xDest = 0; x<CGRectGetMaxX(cropRect); x++, xDest++) {
                int offset = bytesPerPixel*((w*y)+x); // offset calculation in cropRect
                int offsetDest = bytesPerPixel*((cropRect.size.width*yDest)+xDest); // offset calculation for destination image
                for (int i = 0; i<bytesPerPixel; i++) {
                    data[offsetDest+i]   = buffer[offset+i];
                }
            }
        }
    } 
    UIImage *img = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();
} 
```

# c++ - 使用字符串 C++ 映射的向量时可能存在内存泄漏

> ID：10419860
> 
> 赞同：4
> 
> 时间：2012-05-02T18:48:46.527
> 
> 标签：c++, string, memory-leaks, map, vector

我有一个非常复杂的数据对象，它使用了一个字符串映射

```
typedef std::map<std::string, unsigned int> Event;
typedef std::pair<double, Event> EventGroup;
std::vector<EventGroup> eventVector; 
```

这是一个始终在后台运行以侦听传入消息的程序。每次有一个新的 EventGroup 进入时，它可以在地图中包含任意数量的字符串，我将它添加到向量中。

```
// New data came in
eventVector.push_back(newEventGroup); 
```

时不时地我会在这个向量上做一个擦除

```
//Flush some of the data because it's old
// it's been determined that the index to erase at is flushIndex
eventVector.erase(eventVector.begin(), eventVector.begin()+flushIndex); 
```

通常这往往是数据的前 5%。

我一直注意到的是似乎存在内存泄漏。内存使用量开始时约为 50 MB……但在速度太慢和崩溃之前最终接近 1 GB。我听说进行擦除是一项昂贵的操作，但这可能是内存泄漏的原因吗？我是否错过了一些释放地图使用的内存的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T18:56:52.563

在不知道您的自定义类型的作用或外观的情况下（它们是否泄漏内存？）很难说。但是您应该注意，从向量中擦除元素实际上不会释放任何内存，它使向量已经分配的区域可用于添加到该向量的不同元素。换句话说，向量的保留空间保持不变。

所以，如果你将一个向量增加到几百万个元素，删除其中的 90%，并期望得到一堆内存，你会感到失望。释放向量保留的内存的方法（在它被销毁之前永远不会回馈任何东西）是做交换习语的事情：

```
std::vector<EventGroup>(eventVector).swap(eventVector); 
```

我不记得复制构造函数在这里如何工作的确切细节。它的行为应该与您执行此操作完全相同：

```
std::vector<EventGroup>(eventVector.begin(), eventVector.end()).swap(eventVector); 
```

你仍然无法控制它用了多少空间，但是如果你释放了很多空间并且它会在很长一段时间内保持释放......这应该会给系统一些未知数量的内存。

请记住，这是一项昂贵的操作（这就是 std::vector 不只是为您执行此操作的原因），因此仅在您需要时执行此操作。

# ios - 在同一视图上捕获所有主要手势

> ID：10419862
> 
> 赞同：0
> 
> 时间：2012-05-02T18:49:03.483
> 
> 标签：ios, objective-c, touches

我需要捕捉所有主要手势。例如，我希望能够跟踪用户何时点击一次，点击两次，用一根手指点击一次，用两根手指点击两次，当他捏合时，当他旋转手指时，当他拖动两根手指时拖动一根手指.

我知道如何执行所有这些功能问题是我不想触发两个事件。例如，当用户捏我不触发什么拖动事件。此外，当用户拖动一根手指时，我不希望触发点击功能。

这就是我到目前为止所拥有的：

```
-(void)singleTap:(NSIndexPath *)event
{

}

-(void)doubleTapMethod:(id)event
{
    if(enableTap==NO){
        enableMove=YES;
        return;
    }

     NSLog(@"double tap with number of fingers = %i",TouchesCount); 
}

-(void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
{

    enableTap=YES;
    enableMove=NO;

    UITouch *touch = [[event allTouches] anyObject];
    CGPoint location = [touch locationInView:touch.view];

    TapCount = touch.tapCount;

    X=location.x;
    Y=location.y;

    NSData *data = [ @"SSSSS" dataUsingEncoding:NSUTF8StringEncoding];

    [udpSocket sendData:data toHost:IP port:Port withTimeout:-1 tag:1];

    switch (TapCount) {
        case 1:
            [self performSelector:@selector(singleTap:) withObject:nil afterDelay: delay];
            break;
        case 2:
            [NSObject cancelPreviousPerformRequestsWithTarget:self selector:@selector(singleTap:) object:nil];
            [self performSelector:@selector(doubleTapMethod:) withObject:nil afterDelay:delay];
            break;
        case 3:
            [NSObject cancelPreviousPerformRequestsWithTarget:self selector:@selector(doubleTapMethod:) object:nil];
            //[self performSelector:@selector(tripleTapMethod) withObject:nil afterDelay:delay];
            break;
        case 4:
            //[NSObject cancelPreviousPerformRequestsWithTarget:self selector:@selector(tripleTapMethod) object:nil];
            //[self quadrupleTap];
            break;
        default:
            break;
    }

}

-(void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event
{

    enableTap=NO;

    if(enableMove==NO)
        return;

    NSLog(@"touches moved %i",TapCount);
    UITouch *touch = [[event allTouches] anyObject];
    CGPoint location = [touch locationInView:touch.view];    

    NSData *data = [ [NSString stringWithFormat:@"%i,%i", ((int)location.x)-X,((int)location.y)-Y] dataUsingEncoding:NSUTF8StringEncoding];

    [udpSocket sendData:data toHost:IP port:Port withTimeout:-1 tag:1];

}

-(void) touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event{

    TouchesCount = touches.count;
    return;//here

    NSData *data = [ @"EEEEEE" dataUsingEncoding:NSUTF8StringEncoding];
    [udpSocket sendData:data toHost:IP port:Port withTimeout:-1 tag:1];

} 
```

**我知道我错过了很多实现，但我不想继续努力，直到我确定我在写路径上。例如，也许我应该改用 UITapGestureRecognizer 类并执行以下操作：**

```
UITapGestureRecognizer * r = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(viewWasDoubleTapped:)];
[r setNumberOfTapsRequired:2];
[r setNumberOfTouchesRequired:2];
[[self view] addGestureRecognizer:r]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T18:57:06.893

是的！为此，您绝对应该使用手势识别器。您在原始帖子中提到的所有内容都有手势识别器。

# html - 导出 Excel 文件以创建 html 网页

> ID：10419865
> 
> 赞同：1
> 
> 时间：2012-05-02T18:49:24.303
> 
> 标签：html, xml, excel, export

我想知道您将如何尝试解决以下问题：

我有一个 excel 电子表格，其中包含需要转换为 HTML 网站的业务流程的“链接信息”（如矩阵类型）。仅应导出电子表格的某些部分。所需数据由包含不同组件的某些类别的分层表示组成。例如，类别 1 由组件 A 组成，组件 A 具有子组件 A1、A2 等。

目标是用 html 网站表示单个 excel 电子表格，其中主要类别导致具有子类别的页面（总是列出它们拥有的子类别）等等。有点像流程或业务流程图。每当在电子表格中更改、添加、删除某些内容时，我想相应地在网页中反映这些新信息。

重要的部分是不必编辑多个网页，而是一次重建所有内容 - 具有正确的结构。

我的第一个想法是定义一个 XSD 文件来使用 XSL 提取和转换数据，然后创建最终的 Web 结构。我不太确定这将是多么耗时，以及我是否真的能得到令人满意的结果。

也许您对我有更好的解决方案，或者您可以向我指出一些完成类似事情的链接。

我希望我能解决我的问题。

谢谢你的时间。

**更新**

我制作了一个简单版本的电子表格。

```
|*Sub*|*Description*|*Key*|
|SubName|some text| 11|
|SubName|some text| 11|
|SubName|some text| 21|
|SubName|some text| 22| 
```

这里需要“key”列来构造最终的 html 布局，其中 11 和 12 属于更高的类别 10，稍后需要将其添加到结果集中。还需要添加的是最高级别为 1、2 等的“标题类别”。

我想创建一个 html 网页，其中列出了标题类别（就像标题一样）和（在同一页面上）在某种矩形框架中，可以看到下一级类别（这里是 10 和 20 ) 作为链接，现在将一个显示类别 10 和 20 的网页作为标题，并列出子类别并可单击以到达最终的详细表格列表。所以基本上它是一个从上到下的信息钻取。

我有三个具有这些标题类别的 excel 文件（例如：客户、订单、服务）

目标是在一个 html 网页中返回这三个电子表格。从那里可以点击进入详细页面。现在，我很乐意整理一份电子表格。

有没有人知道我该怎么做：

*   a) 编写模式文件以接收正确的 xml 文件，
*   b) 当然，将 xml 文件转换为 html 文件。

如果你能指出一些有类似问题的例子，我也会很高兴。

谢谢你的支持。

# android - 将用 Java 制作的简单 android 游戏转换为 Facebook

> ID：10419867
> 
> 赞同：1
> 
> 时间：2012-05-02T18:49:35.163
> 
> 标签：android, facebook

我在网上的任何地方都找不到这个问题的答案，所以还有什么更好的地方可以在这​​里发布。我在 Java 中使用 Eclipse 制作了简单的 android 游戏。谁能给我指点我如何转换该游戏并将其作为 facebook 游戏在 facebook 上提供？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T18:51:50.723

您需要将游戏转换为 FLASH 或 HTML 以将其作为 Facebook 应用程序运行。我认为不会有一个简单的转换工具来解决这个问题。

# python - Windows 上的 check_call 和命令行参数

> ID：10419868
> 
> 赞同：1
> 
> 时间：2012-05-02T18:49:37.513
> 
> 标签：python, windows, batch-file, command-line-arguments, scons

我的 python 程序在 Windows 上调用一个脚本，使用`check_call`：

```
import subprocess

subprocess.check_call(['my_script.bat', 'foo=bar']) 
```

我希望`my_script.bat`收到一个命令行参数 ( `foo=bar`)，但收到两个 (`foo`和`bar`)。换句话说，似乎等号被转换为空格。在 Linux 上一切正常。

在 Windows 上格式化这个字符串的正确方法是什么，以便`my_script`看到一个包含等号的参数？

`my_script.bat`：

```
echo %1 
```

在我的实际应用中，`my_script.bat`是`scons.bat`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T19:28:15.927

这个案例在 Windows 7 下测试对我来说很好，使用 python2.7

**我的脚本.py**

```
import sys
print sys.argv 
```

**蟒蛇壳**

```
>>> import subprocess
>>> subprocess.check_call('python', 'my_script.py', 'arg1', 'foo=bar')
['myscript.py', 'arg1', 'foo=bar']
0 
```

您可能想要验证您的“my_script”如何处理传入的参数。

**更新**

由于您已经更新了问题以反映您正在专门使用 Windows 批处理文件，因此这里是解决方案：http: [//geoffair.net/ms/batch.htm](http://geoffair.net/ms/batch.htm)

> 注意：如果是分号，';' 或等号 (=) 用作批处理文件的命令行参数，则将其视为空格。例如，在以下 test.bat 批处理文件中 -

等号是一个特殊字符，将被空格替换。需要引用：

```
subprocess.check_call(['my_script.bat', '"foo=bar"']) 
```

# ruby-on-rails - facebook 会帮助开发者追踪“试用费”吗？

> ID：10419872
> 
> 赞同：0
> 
> 时间：2012-05-02T18:50:16.623
> 
> 标签：ruby-on-rails, facebook-credits

在见解 > 其他功能 > 积分下，我可以看到游戏内购买。facebook 是否也有助于跟踪试用付款？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T21:30:03.823

TrialPay 有一个可用的开发者仪表板，它为集成在 Facebook 上的发布者提供测试代码和报告。您可以在[http://help.trialpay.com/credits/?p=394](http://help.trialpay.com/credits/?p=394)阅读更多相关信息。

# ios - 将图像动态添加到原型自定义单元格

> ID：10419876
> 
> 赞同：1
> 
> 时间：2012-05-02T18:50:25.140
> 
> 标签：ios, tableview, custom-cell

我有一个带有嵌入式表格视图的 UIViewController。原型单元已被定制（和子类化）以添加由平移手势识别器启动的“滑块”效果。我已按照本教程进行操作：[https](https://github.com/spilliams/sparrowlike) ://github.com/spiliams/sparrowlike 在单元格内，我有两个视图，一个滑开的前视图，一个保留在那里的后视图，显示其他控件。

现在我需要为每个单元格添加一个图像，该图像将根据 BOOL 变量在两个图像之间进行选择。

问题是：如果我以编程方式添加图像视图，图像将被添加到单元格中，然后当用户滑开前视图时，图像会保留在那里。所以应该将图像添加到前视图中，但我不能在 StoryBoard 中执行此操作并为其添加插座。

所以问题是：我应该把检索图像的代码放在自定义单元子类中吗？如果是这样，我应该把它放在哪里？我的“CustomCell”类实现文件现在看起来像这样：

```
#import "CustomCell.h"

@implementation CustomCell
@synthesize frontView;
@synthesize backView;

- (id)initWithStyle:(UITableViewCellStyle)style reuseIdentifier:(NSString *)reuseIdentifier
{
self = [super initWithStyle:style reuseIdentifier:reuseIdentifier];
if (self) {

}
return self;
}

- (void)setSelected:(BOOL)selected animated:(BOOL)animated
{
[super setSelected:selected animated:animated];

// Configure the view for the selected state
}

@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T19:36:15.363

这样的事情呢？

```
- (void)setupCell {
    if (yourBoolValueHere) {
        [[self frontView] setImage:[UIImage imageNamed:someImageName1]];
    } else {
        [[self frontView] setImage:[UIImage imageNamed:someImageName2]];
    }
    [[self view] bringSubviewToFront:[self frontView]];
} 
```

然后，您只需调用`[cell setupCell]`.`tableView:cellForRowAtIndexPath:`

# php - 在 wkhtmltopdf 中出现错误“调用未定义的函数 wkhtmltox_convert()”

> ID：10419877
> 
> 赞同：0
> 
> 时间：2012-05-02T18:50:29.130
> 
> 标签：php, pdf-generation

我收到此错误，无法找到解决方案。

我可以从命令行生成 PDF。

我在共享服务器上，所以可能没有太多选择。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-22T10:07:07.667

您需要在 web-serverwr 中将 wkhtmltox 模块安装为 php

# css-float - 水平浮动div

> ID：10419879
> 
> 赞同：0
> 
> 时间：2012-05-02T18:50:41.207
> 
> 标签：css-float

我正在尝试水平浮动 div，但它落入新行。

[http://jsfiddle.net/nyCrY/4/](http://jsfiddle.net/nyCrY/4/)

仅当我将#holder 的宽度设置为高于其内容时，它才有效。

有没有办法在#holder上不设置固定宽度来做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T19:00:41.960

不是真正的纯 CSS。

您可以使用静态宽度（您不想这样做），您可以使用浮点数 + 空格（这是不可靠的），或者您可以使用 javascript 动态计算必要的宽度并将样式的宽度设置为该数字。

根据本教程：[http ://css-tricks.com/how-to-create-a-horizo​​ntally-scrolling-site/](http://css-tricks.com/how-to-create-a-horizontally-scrolling-site/)

> 我花了一些时间使用 float 属性和 white-space 属性，看看是否能找到一种方法来对抗浏览器自动换行，但我运气不佳。浮动但没有宽度的页面元素表现出一种属性，即它们扩展为它们内部内容的宽度。我想如果我在里面放一堆浮动元素，它可能会继续扩大到浏览器窗口的宽度之外。没有骰子。还有一个空格：nowrap; CSS 中的属性，我认为可以利用它来对抗自动换行，但它仅适用于文本元素，而不适用于块或您设置为内联的任何旧东西。那好吧。

因此，他基本上是在说，不，仅使用 css 是不可能的。

但他接着说，你可以做一些 javascript 魔术来实现它：

> JavaScript 显然具有操作页面元素和动态计算的能力。

# asp.net-mvc - 如何在请求的早期使错误的身份验证 cookie 失效？

> ID：10419880
> 
> 赞同：2
> 
> 时间：2012-05-02T18:50:42.460
> 
> 标签：asp.net-mvc, cookies, forms-authentication, .aspxauth

# 设想

我开发了一个将托管在 Windows Azure 中的 MVC 应用程序。在开发过程中，我针对本地数据库和本地用户会员服务进行测试。在生产中，该应用程序使用 SQL Azure 数据库和云托管的用户会员服务。

有时我会使用*仅存*在于我的本地计算机上的用户帐户登录到站点的*本地版本。*如果我忘记注销但将机器退出测试模式，事情就会开始中断。

 *# 问题

我将`hosts`文件设置为指向我的应用程序 URL，`127.255.0.0`以便 Azure 模拟器在本地处理浏览器请求。这也意味着我的测试应用程序和生产应用程序使用相同的主机名 - 一个的 cookie 被视为另一个的有效 cookie。

如果我登录到本地系统，则会`ASPXAUTH`为域创建一个 cookie，其中包含来自本地系统的用户凭据。如果我忘记注销并将我的`hosts`文件切换回正常状态（浏览器请求转到实时应用程序），它会将相同的`ASPXAUTH`cookie 发送到服务器。

由于该用户在服务器上不存在，仅在本地存在，因此任何请求都`Membership.GetUser().Email`返回对象空异常。

# 我想做的事

理想情况下，我可以在请求的早期注入一些代码来检查用户是否存在。就像是：

```
MembershipUser user = Membership.GetUser();
if(user == null) {
    FormsAuthentication.SignOut();
} 
```

这将自动删除`ASPXAUTH`无效用户的 cookie。但是我把它放在哪里？我开始研究我的控制器——它们都继承自一个`BaseController`类，但即使将这段代码放在基本控制器的构造函数中也不够早。我也查看了`Global.asax`，但我不确定哪个事件最适合将此操作绑定到。

另外，我什至不确定这是做事的正确方法。如果不是，那么在仅取决于我目前的会员类别之前，确保身份验证 cookie 适用于有效用户的最佳方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T19:19:26.617

您可以在 global.aspx 中处理以下事件：

```
public void FormsAuthentication_OnAuthenticate(object sender, FormsAuthenticationEventArgs args)
{ 
} 
```

**编辑：**

在[上述方法](http://msdn.microsoft.com/en-us/library/system.web.security.formsauthenticationeventhandler.aspx)中，`Membership.GetUser()`将返回`null`，因为它从`HttpContext.Current.User.Identity.Name`属性中获取用户名，在这种情况下，用户尚未通过身份验证。[FormsAuthenticationModule](http://msdn.microsoft.com/en-us/library/system.web.security.formsauthenticationmodule.aspx)甚至在引发[Authenticate](http://msdn.microsoft.com/en-us/library/system.web.security.formsauthenticationmodule.authenticate.aspx)时都会调用上述方法。您可以像这样处理此事件：

```
public void FormsAuthentication_OnAuthenticate(object sender, FormsAuthenticationEventArgs args)
{
    if (FormsAuthentication.CookiesSupported &&
            Request.Cookies[FormsAuthentication.FormsCookieName] != null)
    {
        try
        {
            var formsAuthTicket = FormsAuthentication.Decrypt(Request.Cookies[FormsAuthentication.FormsCookieName].Value);

            MembershipUser user = Membership.GetUser(formsAuthTicket.Name);
            if (user == null)
            {
                FormsAuthentication.SignOut();
                Request.Cookies[FormsAuthentication.FormsCookieName].Value = null;
            }
        }
        catch (Exception ex)
        {
            //TODO:log ex
        }
    }
} 
```

您还可以考虑通过在 global.aspx 中声明以下方法来处理[AuthenticateRequest事件。](http://msdn.microsoft.com/en-us/library/system.web.httpapplication.authenticaterequest.aspx)

注意：**Application_AuthenticateRequest事件在****FormsAuthentication_OnAuthenticate**事件之后触发。

```
void Application_AuthenticateRequest(object sender, EventArgs e)
{
    if (HttpContext.Current.User != null && HttpContext.Current.User.Identity.IsAuthenticated)
    {                
        MembershipUser user = Membership.GetUser();
        if (user == null)
        {
            FormsAuthentication.SignOut();
            HttpContext.Current.User = null;
        }
    }            
} 
```

希望这可以帮助..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T22:32:51.460

您创建一个覆盖 的基本控制器`OnActionExecuting`并将您的代码放在那里。让您的所有控制器控制器都从他那里继承。这是 `OnActionExecuting`我的一个旧项目

```
protected override void OnActionExecuting(ActionExecutingContext filterContext)
{
    if (Request.IsAuthenticated)
    {
        if (Session[SomeKey] == null)
        {
            filterContext.Result = new RedirectToRouteResult(new RouteValueDictionary { { "controller", "Account" }, { "action", "LogOff" } });
        }
    }
    base.OnActionExecuting(filterContext);
} 
```

我基本上是在检查请求是否经过身份验证，否则我会将其重定向到注销操作。 [http://msdn.microsoft.com/en-us/library/system.web.mvc.controller.onactionexecuting.aspx](http://msdn.microsoft.com/en-us/library/system.web.mvc.controller.onactionexecuting.aspx)*

# c# - XNA - 高度数据到高度图 img

> ID：10419885
> 
> 赞同：0
> 
> 时间：2012-05-02T18:51:01.590
> 
> 标签：c#, colors, xna, texture2d

您好，我在内存中有 heightData，有时（当我编辑它时）我想将它保存为 jpg。这是我的代码：

```
float multi = 0.2f;
float[,] heightData = quadTree.HeightData;
Color[] heightMapColors = new Color[heightData.Length];

for (int x = 0; x < heightData.GetLength(0); x++)
{
    for (int y = 0; y < heightData.GetLength(1); y++)
    {
         byte colorData = (byte)(heightData[x, y] / multi);

         heightMapColors[x + y * heightData.GetLength(0)].R = colorData;
         heightMapColors[x + y * heightData.GetLength(0)].G = colorData;
         heightMapColors[x + y * heightData.GetLength(0)].B = colorData;
    }
}

Texture2D heightMap = new Texture2D(device, heightData.GetLength(0), heightData.GetLength(1), false, SurfaceFormat.Color);
heightMap.SetData<Color>(heightMapColors);

using (System.IO.Stream stream = System.IO.File.OpenWrite(@"D:\test.jpg"))
{
     heightMap.SaveAsJpeg(stream, heightData.GetLength(0), heightData.GetLength(1));
} 
```

我 100% 确定我在 heightMapColors 中有数据，但保存的 jpg 只有黑色。：/这是一个好方法，还是有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T20:09:46.293

Alpha 不应该为零

```
 heightMapColors[x + y * heightData.GetLength(0)].R = colorData;
     heightMapColors[x + y * heightData.GetLength(0)].G = colorData;
     heightMapColors[x + y * heightData.GetLength(0)].B = colorData;
     heightMapColors[x + y * heightData.GetLength(0)].A = 255; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T20:09:25.100

JPG 可能不是存储高度图的好格式，因为它是一种有损格式。您应该将其放入 BMP pr PNG 中。也就是说，你的“身高”范围是多少？看起来您的身高是一个浮点数，这意味着它可能不在正确的范围内，无法显示甚至转换为离散值。

如果您允许的高度范围是 Xf 到 Yf，请[使用将其转换为 0 - 255 范围](https://stackoverflow.com/questions/929103/convert-a-number-range-to-another-range-maintaining-ratio)

byteValue = (byte)(((OldValue - OldMin) * (255 - 0)) / (OldMax - OldMin)) + 0

然后试一试。

# c# - 在Visual Studio中如何做Ctrl+K、Ctrl+F？

> ID：10419887
> 
> 赞同：3
> 
> 时间：2012-05-02T18:51:03.257
> 
> 标签：c#, visual-studio

在 Visual Studio 中，自动格式为`Ctrl`+ `K`、`Ctrl`+ `F`，这是什么意思？我应该同时按住两个键....？

我可以将另一个键绑定到这个奇怪的吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T18:52:30.100

先按`Ctrl`- `K`，然后按`Ctrl`- `F`。

要更改它，请转到工具 > 自定义 > 键盘并更改 Edit.FormatSelection 的条目。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-02T18:53:06.823

您不需要同时按住两个键。您只需要**按住** `Ctrl` **，**按`K`（松开）然后`F`（`Ctrl`立即松开）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-02T18:54:09.737

按`Ctrl`+`K`然后`Ctrl`+ `F`，输入第一个时会提示“等待新的键和弦”

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-02T18:52:53.237

`Ctrl`在您第一次点击的`K`同时按住`F`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-02T18:52:41.270

按住`Ctrl`，按`K`。松开`K`，按住的`F`同时按下`Ctrl`。全部释放。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-02T18:53:55.047

你会按下`Ctrl`then `K`，松开`K`然后按下`F`。

# php - 如何将包含任何字符的 NSStrings 获取到我的数据库中？

> ID：10419890
> 
> 赞同：0
> 
> 时间：2012-05-02T18:51:19.183
> 
> 标签：php, mysql, nsstring, character

我让用户编写，然后使用 PHP 将他们编写的内容发布到我的 MYSQL 数据库中。我一直将字符串作为 URL 发送，然后在 php 中发送 $_GET['string'] ，然后将它们放入数据库中。我总是必须通过用 %20 替换它们来处理字符串中的空格。然后我必须在此之上替换各种不同的字符才能使 URL 正常工作。这是一场失败的战斗，用户希望他们的字符串被保存，但如果它们包含我没有想到的字符，情况就不会如此。我什至尝试在 POST 中将字符串作为 NSData 发送，但这似乎也没有保存字符串。

我如何确保用户的字符串会保存，无论他们输入什么疯狂的字符？

谢谢，R

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T23:40:44.517

`NSUTF8StringEncoding`在将数据发送到服务器之前使用对其进行编码，并且始终使用 POST 而不是 GET 将数据发送到服务器。此外，完全停止使用 ASCII 并在使用字符串的任何地方将其替换为[Unicode也是一个好主意。](http://unicode.org)UTF-8 是一种非常方便且紧凑的 Unicode 编码。

# c++ - 动态编程：杆切割实施错误

> ID：10419891
> 
> 赞同：1
> 
> 时间：2012-05-02T18:51:20.680
> 
> 标签：c++, algorithm, dynamic-programming

给定一根长度为 n 英寸的棒和一个价格表 pi，i = 1, 2,... n，确定通过切割棒并出售碎片可获得的最大收益 rn。

```
Bottom_Up_Cut_Rod(p, n)
1 let r[0...n] be a new array
2 r[0] = 0
3 for j = 1 to n
4 q = -infinity
5 for i = 1 to j
6 q = max(q; p[i] + r[j - i])
7 r[j] = q
8 return r[n] 
```

**执行**

```
#include <iostream>
#include <algorithm>

using namespace std;

int RodCut(long long P[],long long n)
{
    long long r[n];
    r[0]=0;
    for(long long j=0;j<n;j++)
    {
         long long q = -100000;
         for(long long i=0;i<j;i++)
         {
             q = max(q , P[i] + r[j-i]);
         }
         r[j] = q;
    }

    return r[n];
}

int main()
{
    long long num;
    long long N;
    long long K;

    cin>>N;

    long long a[N];
    for (long long i = 0; i < N; i++)
    {
        cin>>num;
        a[i] = num;
    }

    int res = 0;
    res = RodCut(a,N);

    cout<<"Answer : "<<res;

    return 0;
} 
```

我的输入是`1 5 8 9 10 17 17 20 24 30`，但输出是`2686348`。我的代码有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T19:11:25.300

有几个问题。您希望主循环从 j = 1 变为 n，因为它代表了使用 j 元素可以做的最好的事情。

您应该坚持使用整数或长整数。

```
int r[n+1];
r[0]=0;

// Calculate best we can do with j elements
for(int j=1;j<=n;j++) {
    int q = -100000;
    for(int i=0;i<j;i++) {
        q = max(q , P[i] + r[j-i-1]);
    }
    r[j] = q;
}

return r[n]; 
```

这似乎为我提供了适用于各种输入的正确解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T19:03:53.427

有两件事。一是回归`r[n]`，应该是`r[n-1]`。其次， start `j from 1 to n`，因为在第一轮中`r[0]`被替换为。`-100000`

此外，`r[0]`应该是`P[0]`；`P[0]`即，给定长度为 1 的杆，您至少会赚钱。

另外，请注意`q`应该是`P[j]`，那是您将要做的最低限度。

```
So assuming the array is P[0..n] // not including n
and r[0..n] is your memo for applying DP

foreach index from (0..n] // not including n
    r[index] = P[index]
    foreach splitIndex from (0..index] // not including index
        r[index] = max(r[index], P[splitIndex] + r[index-splitIndex-1]
return r[n-1] 
```

# javascript - History.pushstate 有回调吗？

> ID：10419898
> 
> 赞同：16
> 
> 时间：2012-05-02T18:52:01.873
> 
> 标签：javascript, html, html5-history

我的 Google-fu 什么也没有。

当你这样做时：

```
var stateObj = { state: "some state" };
history.pushState(stateObj, "page 2", "other.htm"); 
```

是否有关联的窗口回调？

我知道有这个：

```
window.onpopstate = function() {

} 
```

当用户点击后退按钮时，这非常适合聆听。但是，我想在 URL 发生变化时随时收听，但我不知道该怎么做。

URL 更改时是否有全局回调？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-05-02T18:58:07.517

不，没有一个`onpushstate`或什么的。然而，一个小猴子补丁可以解决这个问题：

```
var pushState = history.pushState;
history.pushState = function () {
    pushState.apply(history, arguments);
    fireEvents('pushState', arguments);  // Some event-handling function
}; 
```

这只会在使用 pushState 时通知您。您可能想要为 replaceState 做类似的事情。

如果您需要在 URL 发生变化时收到通知，则上述和 hashchange 处理程序的某种组合将使您大部分时间到达那里。

# c# - XMPP 聊天 - 接收消息

> ID：10419903
> 
> 赞同：1
> 
> 时间：2012-05-02T18:52:41.350
> 
> 标签：c#, facebook, xmpp

我正在尝试使用 c#asp.net 学习 XMPP 聊天

我成功地连接到 Facebook 聊天并发送消息。

现在我想知道我收到了其他人发送给我的消息作为回复。

我们是否需要将侦听器添加到我们用于发送消息的 TCP 套接字。

我不想使用任何 XMPP 库。

请让我知道，如果有任何关于如何接收消息的教程或很好的解释？

我发送消息的代码：

```
 xml = "<message type='chat' from='-1034430826@chat.facebook.com' to='-100000960474935@chat.facebook.com' xml:lang='en' ><body>hi This offline message1</body></message>";
        message = Encoding.UTF8.GetBytes(xml);
        sslstream.Write(message);
        sslstream.Flush();   //sending the response to the server with my parameters
        myResponseAsSB.Clear(); 
```

# kinect - 有什么方法可以从 kinect 获得稳定/一致的 FPS？

> ID：10419907
> 
> 赞同：2
> 
> 时间：2012-05-02T18:53:00.713
> 
> 标签：kinect, openni

我正在尝试以 .oni 格式记录 kinect 文件，稍后我将尝试与其他传感器同步。因此，即使某些帧是重复的，获得一致的 fps 也是非常重要的。

从我现在看到的情况来看，WaitAndUpdateAll 并不能保证帧率是一致的。我将录制几分钟（20+），所以我需要确保没有漂移！

有谁知道是否可以锁定录制的 fps，如果没有，kinect 的录制 fps 有多稳定？谢谢！

* * *

在对这个问题进行了一些调查之后，我整理了以下关于该主题的文章：

[http://denislantsman.com/?p=50](http://denislantsman.com/?p=50)

把它放在这里，这样感兴趣的人就可以找到它，而不必为这个问题而苦苦挣扎。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-20T11:01:10.593

我的猜测是使用 PCL 库，因为开发人员还与 ROS 团队合作，他们还必须大量同步传感器。但请注意，我无法在 Windows 7 上以 30 FPS 的速度捕获 XYZRGB 云。如果您只需要捕获 XYZ，您应该没问题。在最坏的情况下，您必须自己标记并同步所有数据。

# c - 在C中使用malloc将文本文件读入数组

> ID：10419913
> 
> 赞同：2
> 
> 时间：2012-05-02T18:53:46.660
> 
> 标签：c, dynamic

我可以在这段代码上使用一组（或更多）眼睛。我正在尝试从文件流（f1）读取一定数量的字节到数组/缓冲区（文件是文本文件，数组是 char 类型）。如果我读取大小“缓冲区 - 1”，我想“重新分配”数组并继续读取，从我离开的地方开始。基本上我正在尝试为未知大小的文件动态扩展缓冲区。我想知道的是：

1.  我执行这个错误吗？
2.  我将如何使用代码检查诸如“realloc”之类的故障条件？
3.  当我编译关于“内置函数 realloc 的隐式声明......”时，我收到了很多警告（我也看到了关于我使用 read、malloc、strlen 等的警告。
4.  当第二次（以及第三次、第四次等）调用“read()”时，它是否每次都从流的开头读取？那可能是我的问题是我似乎只返回第一个“buff_size”字符。

这是片段：

```
//read_buffer is of size buff_size
n_read = read(f1, read_buffer, buff_size - 1);
read_count = n_read;
int new_size = buff_size;
while (read_count == (buff_size - 1))
{

        new_size *= 2;
        read_buffer = realloc(read_buffer, new_size);
        n_read = read(f1, read_buffer[read_count], buff_size - 1);
        read_count += n_read;
} 
```

当我正在学习如何进行这种类型的动态阅读时，我想知道是否有人可以陈述一些关于这种事情的最佳实践的简短事实。我假设这在专业领域出现了 TON（读取未知大小的文件）？谢谢你的时间。ALSO：当你们找到了做事的好方法（即解决此类问题的技术）时，您是否发现自己记住了您是如何做到的，或者可能将其保存以供将来参考（即解决方案相当静态）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-02T19:00:48.993

如果您要扩展整个文件的缓冲区，最简单的方法可能是搜索到最后，获取当前偏移量，然后再搜索到开头并一举读取：

```
size = lseek(f1, 0, SEEK_END); // get offset at end of file

lseek(f1, 0, SEEK_SET); // seek back to beginning

buffer = malloc(size+1); // allocate enough memory.

read(f1, buffer, size);  // read in the file 
```

或者，在任何相当现代的类似 POSIX 的系统上，考虑使用[`mmap`](http://linux.die.net/man/2/mmap).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-02T19:00:18.730

这是一个很酷的技巧：使用`mmap`(man mmap)。

简而言之，假设你有你的文件描述符`f1`，在一个`nb`字节文件上。你只需调用

```
char *map = mmap(NULL, nb, PROT_READ, MAP_PRIVATE, f1, 0);
if (map == MAP_FAILED) {
    return -1; // handle failure
} 
```

完毕。

您可以从文件中读取，就好像它已经在内存中一样，操作系统会根据需要将页面读入内存。完成后，您可以简单地调用

```
munmap(map, nb); 
```

并且映射消失了。

**编辑：**我刚刚重新阅读了您的帖子，发现您不知道文件大小。为什么？

您可以使用`lseek`查找文件末尾并了解其当前长度。

相反，如果是因为其他人在您阅读时正在写入文件，您可以从当前映射中读取直到它用完，然后`lseek`再次调用以获取新长度，并使用`mremap`来增加大小。或者，您可以简单地使用`munmap`您拥有的东西，并`mmap`使用新的“偏移量”（我设置为 0 的数字，即要跳过文件的多少字节）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-02T19:12:02.657

```
#include <stdlib.h> /* for realloc() */
#include <string.h> /* for memcpy() */
#include <unistd.h> /* for read() */

char buff[512] ; /* anything goes */
size_t done, size;
char *result = NULL;
int fd;

done = size = 0;
while (1) {
        int n_read;
        n_read = read(fd, buff, sizeof buff);
        if (n_read <=0) {
            ... for network connections, (n_read == -1 && errno == EAGAIN)
            ... should be handled special (by a continue) here.
            break;
            }
        if (done+n_read > size) {
            result = realloc(result, size ? 2*size : n_read );
            ... maybe handle NULL return from realloc here ...
            size = size ? 2*size : n_read;
            }
        memcpy(result+done, buff, n_read);
        done += n_read;
        }
 ... and maybe shave down result a bit here ... 
```

注意：这或多或少是香草的方式。另一种方法是首先 malloc 一个**真正的大**数组，然后再重新分配到正确的大小。这将减少重新分配的数量，并且对于 malloc 领域，wrt 碎片*可能*更温和。YMMV。

# objective-c - 如何为故事板中的每个视图分配名称

> ID：10419915
> 
> 赞同：1
> 
> 时间：2012-05-02T18:53:49.627
> 
> 标签：objective-c, ios, xcode, storyboard

所以我有一个应用程序，我在 UI 中使用具有不同视图的故事板。在第一个视图中，当我按下按钮时有一个 if 语句。它决定屏幕是否必须显示下一个 ViewController 或其他。我已经知道如何使用 .xibs 做到这一点，但不知道如何使用情节提要。

这是不起作用的代码：

```
.h
{
IBOutlet UIView *one;
IBOutlet UIView *two;
}

.m

-(IBAction)decideNextView:(id)sender{
NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
    NSString *NextView =[defaults objectForKey:@"TestDone"];
    if ([NextView isEqualToString:@""]) {
        self.view = one;
    }else if ([NextView isEqualToString:@"Done"]) {
        self.view = two;
    }else {
        self.view = one;
    }
} 
```

当我在我的 iPod Touch 中运行应用程序并按下执行 的按钮时`IBAction`，我得到一个黑屏，但有任何错误。请帮我！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T18:58:15.630

您应该在代码中访问视图元素的方式是使用属性检查器中的“标签”项。最好的方法是将其设置为一个数字，然后`#define kView1 0`在代码中这样做，您不需要记住您分配给 view1 的数字，您只需使用常量。

![标记属性](../Images/f9076503080f809668f2aa88ee0f86f9.png)

这里所说`Tag`的，您可以将它设置为故事板或 xib 中每个项目的任何数字。然后在代码中你可以这样说：

```
#define NAME_TAG 0
UIView *nameView = [self.view viewWithTag:NAME_TAG]; 
```

# asp.net-mvc-3 - @Url.Content 未指向新 MVC 项目中的正确路径

> ID：10419917
> 
> 赞同：0
> 
> 时间：2012-05-02T18:53:55.740
> 
> 标签：asp.net-mvc-3

我无法弄清楚为什么当我创建一个新的 MVC 3 应用程序时，jQuery 智能在我更改 _Layout 页面中的脚本标记之前不起作用。根据我看过的教程，只要我将 vsdoc 文件放在我的脚本文件夹中，我就应该有 jQuery 智能感知，但事实并非如此，至少这对我来说没有发生。创建新项目后，我的 _Layout.cshtml 页面中的脚本标记如下所示：

```
<script src="@Url.Content("~/Scripts/jquery-1.7.2.min.js")" type="text/javascript"></script> 
```

我已将 vsdoc 文件包含在我的 Scripts 文件夹中，但我没有 jQuery 智能感知。如果我在页面上查看资源，我会看到：

```
<script src="/Scripts/jquery-1.7.2.min.js" type="text/javascript"></script> 
```

它看起来好像没有正确解析路径。所以我然后删除这个标签并通过将文件拖放到页面来替换它，最终得到：

```
<script src="../../Scripts/jquery-1.7.2.min.js" type="text/javascript"></script> 
```

现在我得到了 jQuery 智能感知。那么为什么我必须在获得智能感知之前进行这些更改？这是其他人经历过的事情还是我可能做错了什么？似乎@Url.Content 功能已损坏，这让我想知道在其他用途​​（例如在表单上放置图像）是否会遇到问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T19:06:37.510

据我所知，您的 vsdoc.js 脚本不能只存在于脚本文件夹中。必须在将使用它的每个视图中引用它。

你应该像这样引用它：

```
@if (false) {
    <script src="../../Scripts/jquery-1.5.1-vsdoc.js" type="text/javascript"></script>
} 
```

*注意：检查您引用的文件版本是否正确。*

if 语句将阻止浏览器实际下载文件。

# python - 将数字 1 添加到集合中没有效果

> ID：10419918
> 
> 赞同：9
> 
> 时间：2012-05-02T18:53:58.087
> 
> 标签：python, python-3.x, set

我无法将整数添加`1`到现有集合中。在交互式外壳中，这就是我正在做的事情：

```
>>> st = {'a', True, 'Vanilla'}
>>> st
{'a', True, 'Vanilla'}
>>> st.add(1)
>>> st
{'a', True, 'Vanilla'}   # Here's the problem; there's no 1, but anything else works
>>> st.add(2)
>>> st
{'a', True, 'Vanilla', 2} 
```

这个问题是两个月前发布的，但我相信它被误解了。我正在使用 Python 3.2.3。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-02T18:56:32.887

```
>>> 1 == True
True 
```

我相信你的问题是`1`并且`True`是相同的值，所以 1 是“已经在集合中”。

```
>>> st
{'a', True, 'Vanilla'}
>>> 1 in st
True 
```

在数学运算`True`中本身被视为`1`：

```
>>> 5 + True
6
>>> True * 2
2
>>> 3\. / (True + True)
1.5 
```

虽然 True 是 bool 而 1 是 int：

```
>>> type(True)
<class 'bool'>
>>> type(1)
<class 'int'> 
```

因为`1 in st`返回 True，我认为你不应该有任何问题。这是一个非常奇怪的结果。如果您有兴趣进一步阅读，@Lattyware 指向[PEP 285](http://www.python.org/dev/peps/pep-0285/)，它深入解释了这个问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-02T18:56:50.800

我相信，尽管我不确定，因为`hash(1) == hash(True)`而且`1 == True`它们被`set`. 我不认为应该是这样`1 is True`，`False`但我相信它解释了为什么你不能添加它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-02T18:58:00.743

`1`相当于`True`as`1 == True`返回 true。结果，插入`1`被拒绝，因为集合不能有重复项。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-02T20:38:16.120

如果有人有兴趣进一步研究，这里有一些链接。

[将布尔值用作整数是 Pythonic 吗？](https://stackoverflow.com/questions/3174392/is-it-pythonic-to-use-bools-as-ints/3175293#3175293)

[https://stackoverflow.com/a/2764099/1355722](https://stackoverflow.com/a/2764099/1355722)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-02-22T06:10:57.033

如果您想拥有具有相同哈希的项目，我们必须使用列表。如果您绝对确定您的集合需要能够同时包含 True 和 1.0，我很确定您必须定义自己的自定义类，可能是 dict 的一个薄包装。与许多语言一样，Python 的 set 类型只是 dict 的一个薄包装器，我们只对键感兴趣。

前任：

```
st = {'a', True, 'Vanilla'}

list_st = []

for i in st:
    list_st.append(i)

list_st.append(1)

for i in list_st:
    print(f'The hash of {i} is {hash(i)}') 
```

生产

```
The hash of True is 1
The hash of Vanilla is -6149594130004184476
The hash of a is 8287428602346617974
The hash of 1 is 1

[Program finished] 
```

# sql - 如何从日期范围中选择作为数据源

> ID：10419920
> 
> 赞同：0
> 
> 时间：2012-05-02T18:54:02.710
> 
> 标签：sql, postgresql

如果没有创建包含日期范围的所有值的表，我将如何从数据范围中选择作为数据源。

我想要完成的是从单独的表中创建在同一周内创建的所有项目的运行总计，同时显示 0 个新的周

示例表：

```
items
-----------------------------
created_on | name     | type 
-----------------------------
2012-01-01 | Cards    | 1
2012-01-09 | Red Pen  | 2
2012-01-31 | Pencil   | 2
2012-02-01 | Blue Pen | 2

types
--------------
name     | id 
--------------
Fun      | 1
Writing  | 2 
```

样本输出：

```
----------------------------
year | week | fun | writing 
----------------------------
2012 | 1    | 1   | 0
2012 | 2    | 0   | 1
2012 | 3    | 0   | 0
2012 | 4    | 0   | 0
2012 | 5    | 0   | 2 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T19:14:16.980

您可以为周数生成一个数字系列

```
SELECT
  w.week
FROM
  (SELECT generate_series(1,52) as week) as w 
```

例子

```
SELECT
  w.year,
  w.week,
  COUNT(i1) as fun,
  COUNT(i2) as writing
FROM (SELECT 2012 as year, generate_series(1,6) as week) as w
LEFT JOIN items i1 ON i1.type = 1 AND w.week = EXTRACT(WEEK FROM i1.created_on)
LEFT JOIN items i2 ON i2.type = 2 AND w.week = EXTRACT(WEEK FROM i2.created_on)
GROUP BY 
  w.year,
  w.week
ORDER BY
  w.year,
  w.week 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T20:24:18.317

非常接近 erikxiv，但你让我朝着正确的方向前进。我有多个表需要从中获取信息，这是选择字段中的附加选择。

```
select 
    date_year.num,
    date_week.num,
    (   select count(*) from items x
        and EXTRACT(YEAR FROM x.created_on) = date_year.num
        and EXTRACT(WEEK FROM x.created_on) = date_week.num
    ) as item_count
from
    (SELECT generate_series(2011, date_part('year', CURRENT_DATE)::INTEGER) as num) as date_year,
    (SELECT generate_series(1,52) as num) as date_week
where
    (
        date_year.num < EXTRACT (YEAR FROM CURRENT_DATE) 
        OR 
        (
            date_year.num = EXTRACT (YEAR FROM CURRENT_DATE) AND
            date_week.num <= EXTRACT (WEEK FROM CURRENT_DATE)
        )
    ) 
```

# android - Android：向活动添加片段

> ID：10419924
> 
> 赞同：7
> 
> 时间：2012-05-02T18:54:17.643
> 
> 标签：android, user-interface, android-activity, fragment

我对 Android 很陌生，所以这可能有一个明显的答案，但我似乎找不到。

我正在编写一个计算器应用程序的版本。我想这样做，以便当用户单击其中一个按钮时，这会启动一个片段（上面有更多按钮，然后他们可以使用它们进行更多输入）。

片段代码如下：

```
import android.app.Fragment;
import android.os.Bundle;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;

public class VariableMenu extends Fragment {
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);}

    public void onActivityCreated(Bundle savedInstanceState) {
        super.onActivityCreated(savedInstanceState);

    }
     public View onCreateView(LayoutInflater inflater, ViewGroup container,
             Bundle savedInstanceState) {

         return inflater.inflate(R.layout.fragment, container, false);
}

} 
```

XML 布局如下：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

<Button
        android:id="@+id/Bx"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="X" 
        android:onClick="onButtonClicked"/>
    <Button
        android:id="@+id/By"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_toRightOf="@id/Bx"
        android:layout_alignTop="@id/Bx"
        android:text="Y" 
        android:onClick="onButtonClicked"/>
    <Button
        android:id="@+id/Bz"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_toRightOf="@id/By"
        android:layout_alignTop="@id/By"
        android:text="Z" 
        android:onClick="onButtonClicked"/>

</RelativeLayout> 
```

（我知道我不应该使用硬编码的字符串，但是一旦我运行起来我会解决这个问题）

我尝试使用带有激活按钮的 onTouch 方法的片段事务添加它，如下所示：

```
public void onFragmentActivated(View v) {
        FragmentManager fragmentManager = getFragmentManager();
        FragmentTransaction fragmentTransaction = fragmentManager.beginTransaction();
        VariableMenu fragment = new VariableMenu();
        fragmentTransaction.add(R.layout.main, fragment);
        fragmentTransaction.commit();
    } 
```

但这给出了一个错误，说“没有为片段变量菜单找到 id:...(main) 的视图。”

然后我在主 XML 文件中为它创建了一个视图：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent">

(Irrelevant things)

    <fragment
        android:id="@+id/Fragment"
        android:name="calculator.app.VariableMenu"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_below="@id/B1"/>

(Irrelevant things)

</RelativeLayout> 
```

但这导致一旦创建活动（并且 setContentView(R.layout.main); 运行），片段就在那里。

是否有一种简单的方法可以以编程方式向活动添加和删除带有 UI 的片段？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-02T19:11:42.773

这里的问题是片段需要一个带有视图 id 的容器来驻留。给它一个布局 id 会导致你看到的错误。

您可以将片段添加到您的相对布局中，但要正确执行此操作，您需要为其分配适当的布局参数以便可以放置它。在包含其内容的相对布局中创建一个 FrameLayout 会更容易，然后在其中添加片段。

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent">

    <FrameLayout
        android:id="@+id/FragmentContainer"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_below="@id/B1"/>

</RelativeLayout> 
```

然后

```
fragmentTransaction.add(R.id.FragmentContainer, fragment); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-02-13T12:16:09.477

在您的活动中使用简单的代码

```
getSupportFragmentManager().beginTransaction().add(R.id.yourcontainer,new yourfragment).commit(); 
```

# c# - 实体框架中的延迟加载项

> ID：10419930
> 
> 赞同：3
> 
> 时间：2012-05-02T18:54:47.203
> 
> 标签：c#, .net, entity-framework, lazy-loading

我有两个彼此有多对多关系的对象。

我在数据库优先方法中使用实体框架。

我的数据库探查器显示，每次我获取一组对象 A 时，它都会为 A 中的每个元素加载另一组对象 B。我假设使用延迟加载，这不会发生，或者访问时会获取 B通过导航属性。

访问对象的代码使用通用方法，其中实体是我的 DbContext

```
public virtual IQueryable<T> GetAll()
{
    IQueryable<T> query = entities.Set<T>();
    return query;
} 
```

这两个导航属性都实现为`virtual ICollection<T>`并且我在构造函数中`Configuration.LazyLoadingEnabled = true`明确设置。`DbContext`

我错过了什么，或者以错误的方式接近这个？我是否应该删除导航属性并通过其他查询显式加载我需要的内容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T18:51:42.683

在专家面前，我不愿意问这个:) 但是在这种情况下，在 DbContext 上设置 ProxyCreationEnabled=false 没有帮助吗？对不起，如果这太“新”了一点

# spring-security - 从 Spring Security 2.0.4 迁移到 3.1 的问题

> ID：10419933
> 
> 赞同：1
> 
> 时间：2012-05-02T18:55:06.380
> 
> 标签：spring-security

我对 Spring Security 有点陌生，我正在尝试将现有应用程序从 security 2.0.4 迁移到 3.1，我收到以下错误消息：

```
org.springframework.beans.factory.BeanCreationException: 
  Error creating bean with name 'org.springframework.security.authentication.dao.DaoAuthenticationProvider#0': Initialization of bean failed; 
  nested exception is org.springframework.beans.ConversionNotSupportedException: 
  Failed to convert property value of type org.springframework.security.authentication.dao.DaoAuthenticationProvider' 
  to required type 'org.springframework.security.core.userdetails.UserDetailsService' for property 'userDetailsService';
  nested exception is java.lang.IllegalStateException: Cannot convert value of type [org.springframework.security.authentication.dao.DaoAuthenticationProvider] 
  to required type [org.springframework.security.core.userdetails.UserDetailsService]
  for property 'userDetailsService': no matching editors or conversion strategy found 
```

我觉得我错过了一些明显的东西，但我一辈子都看不到它。

这是我的 applicationContextSecurity.xml 文件

```
<?xml version="1.0" encoding="UTF-8"?>

<beans:beans xmlns="http://www.springframework.org/schema/security" 
    xmlns:beans="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
    xmlns:util="http://www.springframework.org/schema/util" 
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
    http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-3.1.xsd   
    http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-3.1.xsd">

    <beans:bean id="daoAuthenticationProvider" class="org.springframework.security.authentication.dao.DaoAuthenticationProvider">
        <beans:property name="userDetailsService" ref="employeeServiceFacade"/>
        <beans:property name="passwordEncoder" ref="passwordEncoderDecoder"/>
        <beans:property name="hideUserNotFoundExceptions" value="false" />
    </beans:bean>

    <authentication-manager alias="authenticationManager">
        <authentication-provider user-service-ref="daoAuthenticationProvider"/>         
    </authentication-manager>

    <global-method-security secured-annotations="disabled"/>

    <beans:bean id="customAuthenticationEntryPoint" class="org.springframework.security.web.authentication.LoginUrlAuthenticationEntryPoint">
        <beans:property name="loginFormUrl" value="/login.action"/>
    </beans:bean>

    <beans:bean id="customAuthenticationProcessingFilter" class="org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter">     
        <beans:property name="authenticationFailureHandler" ref="failureHandler" />
        <beans:property name="authenticationSuccessHandler" ref="successHandler" /> 
        <beans:property name="authenticationManager" ref="authenticationManager"/> 
        <beans:property name="allowSessionCreation" value="true" />
        <beans:property name="sessionAuthenticationStrategy" ref="sas"/>        
    </beans:bean>

    <beans:bean id="successHandler" class="com.es.tms.web.security.RoleBasedTargetUrlResolver" >
        <beans:property name="defaultTargetUrl" value="/timesheet/searchTimeEntries.action" /> <!-- which is the default value -->      
        <beans:property name="roleNameToUrlMap">
            <util:map>
                <beans:entry key="ROLE_ASSISTANT" value="/billing/viewBillings.action"/>
                <beans:entry key="ROLE_BILLING" value="/expenses/viewToAPApproveExpenses.action"/>
                <beans:entry key="ROLE_PAYROLL" value="/payroll/viewPayroll.action"/>
                <beans:entry key="ROLE_OFFICEASSISTANTEXPENSES" value="/expenses/searchExpenseEntries.action"/>
                <beans:entry key="ROLE_ADMIN_LEVEL1" value="/administration/searchEmployees.action"/>
                <beans:entry key="ROLE_ADMIN" value="/administration/searchEmployees.action"/>
                <beans:entry key="ROLE_ADMIN_ASSISTANT" value="/administration/searchEmployees.action"/>
                <beans:entry key="ROLE_ACCOUNT_MANAGER" value="/administration/searchEmployees.action"/>
                <beans:entry key="ROLE_HR" value="/administration/searchEmployees.action"/>
                <beans:entry key="ROLE_RECRUITER_MANAGER" value="/administration/searchEmployees.action"/>                  
            </util:map>
        </beans:property>   
        <beans:constructor-arg ref="defaultTargetUrlResolver" />            
    </beans:bean>

    <beans:bean id="defaultTargetUrlResolver" class="org.springframework.security.web.authentication.SimpleUrlAuthenticationSuccessHandler" />  

    <beans:bean id="failureHandler" class="org.springframework.security.web.authentication.SimpleUrlAuthenticationFailureHandler" >
        <beans:property name="defaultFailureUrl" value="/login.action?login_error=true" />
    </beans:bean>

    <beans:bean id="sas" class="org.springframework.security.web.authentication.session.SessionFixationProtectionStrategy">
        <beans:property name="migrateSessionAttributes" value="true" />
    </beans:bean>

    <!--  Non Secured patterns -->
    <http security="none"  pattern="/images/**" />
    <http security="none"  pattern="/styles/**" />
    <http security="none"  pattern="/scripts/**" />
    <http security="none"  pattern="/common/**" />

    <http auto-config="false" entry-point-ref="customAuthenticationEntryPoint" access-denied-page="/forbidden.jsp">
        <custom-filter position="FORM_LOGIN_FILTER" ref="customAuthenticationProcessingFilter" />

        <!-- SECURITY URLs -->
        <intercept-url pattern="/login.action*" access="IS_AUTHENTICATED_ANONYMOUSLY" />
        <intercept-url pattern="/index.jsp*" access="IS_AUTHENTICATED_ANONYMOUSLY" />
        <intercept-url pattern="/error*" access="IS_AUTHENTICATED_ANONYMOUSLY" />   

        <logout logout-success-url="/login.action"/>
        <anonymous username="Guest" granted-authority="ROLE_ANONYMOUS"/>

        <remember-me/>
    </http>

    <authentication-manager>    
        <authentication-provider user-service-ref="employeeServiceFacade">
            <password-encoder ref="passwordEncoderDecoder"/>
        </authentication-provider>
    </authentication-manager>       

    <beans:bean id="passwordEncoderDecoder" class="com.es.tms.util.CustomPasswordEncoder"/>

    <beans:bean id="employeeServiceFacade" class="com.es.tms.service.security.EmployeeServiceFacade">
        <beans:property name="coreService" ref="coreService"/>
        <beans:property name="hireStatusCodes" value="O:SOP's have not been completed#P:Survey has not been completed" />
    </beans:bean>

</beans:beans> 
```

这也是我的 web.xml 文件：

```
<?xml version="1.0" encoding="UTF-8"?>

<web-app id="stanplus" version="2.4" xmlns="http://java.sun.com/xml/ns/j2ee" 
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
         xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd">

    <display-name>TMS</display-name>

    <!-- Define the basename for a resource bundle for I18N -->
    <context-param>
        <param-name>javax.servlet.jsp.jstl.fmt.localizationContext</param-name>
        <param-value>app_resources</param-value>
    </context-param>
    <!-- Fallback locale if no bundles found for browser's preferred locale -->
    <!-- Force a single locale using param-name 'javax.servlet.jsp.jstl.fmt.locale' -->
    <context-param>
        <param-name>javax.servlet.jsp.jstl.fmt.fallbackLocale</param-name>
        <param-value>en</param-value>
    </context-param>
    <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>
            /WEB-INF/applicationContextMail.xml
            /WEB-INF/applicationContextDao.xml
            /WEB-INF/applicationContextService.xml
            /WEB-INF/applicationContextWeb.xml
            /WEB-INF/applicationContextReports.xml
            /WEB-INF/applicationContextQuartz.xml           
            /WEB-INF/applicationContextSecurity.xml
        </param-value>
    </context-param>

    <!-- Filters -->
    <filter>
        <filter-name>encodingFilter</filter-name>
        <filter-class>org.springframework.web.filter.CharacterEncodingFilter</filter-class>
        <init-param>
            <param-name>encoding</param-name>
            <param-value>UTF-8</param-value>
        </init-param>
        <init-param>
            <param-name>forceEncoding</param-name>
            <param-value>true</param-value>
        </init-param>
    </filter>
     <filter>
        <filter-name>springSecurityFilterChain</filter-name>
        <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
    </filter>
    <filter>
        <filter-name>sitemesh</filter-name>
        <filter-class>com.opensymphony.module.sitemesh.filter.PageFilter</filter-class>
    </filter>
    <filter>
        <filter-name>struts-cleanup</filter-name>
        <filter-class>org.apache.struts2.dispatcher.ActionContextCleanUp</filter-class>
    </filter>
    <filter>
        <filter-name>struts</filter-name>
        <filter-class>org.apache.struts2.dispatcher.FilterDispatcher</filter-class>
    </filter>
    <filter>
        <filter-name>lazyLoadingFilter</filter-name>
        <filter-class>org.springframework.orm.jpa.support.OpenEntityManagerInViewFilter</filter-class>
    </filter>

    <filter-mapping>
        <filter-name>encodingFilter</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>
    <filter-mapping>
        <filter-name>lazyLoadingFilter</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>
    <filter-mapping>
        <filter-name>springSecurityFilterChain</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping> 
    <filter-mapping>
        <filter-name>struts-cleanup</filter-name>
        <url-pattern>/*</url-pattern>
        <dispatcher>REQUEST</dispatcher>
        <dispatcher>FORWARD</dispatcher>
    </filter-mapping>
    <filter-mapping>
        <filter-name>sitemesh</filter-name>
        <url-pattern>/*</url-pattern>
        <dispatcher>REQUEST</dispatcher>
        <dispatcher>FORWARD</dispatcher>
        <dispatcher>INCLUDE</dispatcher>
    </filter-mapping>
    <filter-mapping>
        <filter-name>struts</filter-name>
        <url-pattern>/*</url-pattern>
        <dispatcher>REQUEST</dispatcher>
        <dispatcher>FORWARD</dispatcher>
    </filter-mapping>

    <!-- Listeners -->
    <listener>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener>

    <listener>
        <listener-class>net.sf.navigator.menu.MenuContextListener</listener-class>
    </listener>

    <!-- Servlets -->
    <servlet>
        <servlet-name>jspSupportServlet</servlet-name>
        <servlet-class>org.apache.struts2.views.JspSupportServlet</servlet-class>
        <load-on-startup>5</load-on-startup>
    </servlet>      

    <!-- Welcome file lists -->
    <welcome-file-list>
        <welcome-file>index.jsp</welcome-file>
    </welcome-file-list>

    <error-page>
        <exception-type>java.lang.Throwable</exception-type>
        <location>/error.jsp</location>
    </error-page>

</web-app> 
```

任何帮助将非常感激。

谢谢，史蒂夫

更新：

好的，我查看了这个示例，确实发现我的身份验证管理器不正确。所以我解决了这个问题，但现在我似乎无法解决这个错误：

```
org.springframework.beans.factory.BeanCreationException: 
  Error creating bean with name 'daoAuthenticationProvider' 
  defined in ServletContext resource [/WEB-INF/applicationContextSecurity.xml]: 
  Cannot resolve reference to bean 'employeeServiceFacade' while setting bean property 'userDetailsService';
  nested exception is org.springframework.beans.factory.BeanCreationException: 
  Error creating bean with name 'employeeServiceFacade' 
  defined in ServletContext resource [/WEB-INF/applicationContextSecurity.xml]: 
  Initialization of bean failed; nested exception is
  org.springframework.beans.factory.BeanInitializationException: 
  Property 'coreService' is required for bean 'employeeServiceFacade' 
```

在这次升级中我没有更改我的 coreServie，但它看起来几乎没有被初始化？有什么想法吗？

我的 coreService 是在 applicationContextService.xml 文件中设置的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T13:52:57.690

我有一个包含此 bean 的 applicationContextService.xml 文件。当我在调试启动时遍历它时，我看到服务已初始化，但由于某种原因仍然认为它没有设置。我从 EmployeeServiceFacade 类的 coreService 中去掉了 @Required 注释，现在它似乎可以工作了。不明白为什么，但我至少现在可以运行我的应用程序。感谢您的回复，它至少让我找到了正确的方向。

# mvvm - MVVM 中的样式按钮

> ID：10419935
> 
> 赞同：1
> 
> 时间：2012-05-02T18:55:08.080
> 
> 标签：mvvm, styles, basedon

我正在使用 MVVM 模式编写一个小型 WPF 应用程序。

我在主窗口中为按钮设置了一些样式资源，我希望它们应用于视图中的按钮。问题是某些按钮具有带触发器的样式。所以我想从通用风格继承这种风格

这是我的主窗口代码：

```
 <Window.Resources>
    <DataTemplate DataType="{x:Type vm:HomeViewModel}">
        <views:HomeView/>
    </DataTemplate>
    <DataTemplate DataType="{x:Type vm:DetailReportViewModel}">
        <views:DetailReportView/>
    </DataTemplate>
    <DataTemplate DataType="{x:Type vm:TransferViewModel}">
        <views:TransferView/>
    </DataTemplate>
    <Style TargetType="{x:Type Button}">
        <Setter Property="Margin" Value="5"/>
        <Setter Property="MinWidth" Value="30"/>
        <Setter Property="Foreground" Value="Red"/>

    </Style>
    <Style TargetType="{x:Type ComboBox}">
        <Setter Property="Margin" Value="5"/>
    </Style>
   </Window.Resources> 
```

这是我的视图/用户控件中的按钮 XAML

```
<Button Content="Delete" Command="{Binding DeleteReportCommand}">
            <Button.Style>
                <Style TargetType="{x:Type Button}">
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding Mode}">
                            <DataTrigger.Value>
                                <vm:Mode>Add</vm:Mode>
                            </DataTrigger.Value>
                            <Setter Property="Visibility" Value="Collapsed"/>
                        </DataTrigger>
                        <DataTrigger Binding="{Binding Mode}">
                            <DataTrigger.Value>
                                <vm:Mode>Edit</vm:Mode>
                            </DataTrigger.Value>
                            <Setter Property="Visibility" Value="Visible"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </Button.Style>
        </Button> 
```

我尝试使用 BasedOn="{StaticResource {x:Type Button} 继承，但它似乎不起作用（见 img）

![在此处输入图像描述](../Images/a46fb7161b0adca2f0faa33b8dc2d748.png)

我尝试使用键名，但静态资源找不到键名，因为它不在同一个视图上。并且 BasedOn 不接受动态资源。有什么我想念的吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T04:58:07.637

您可以将所有自定义样式放在单独的资源字典文件中，也可以将其添加到 usercontrol.resources 中。

请参阅： http: [//www.codeproject.com/Articles/35346/Using-a-Resource-Dictionary-in-WPF](http://www.codeproject.com/Articles/35346/Using-a-Resource-Dictionary-in-WPF)

或者您可以将所有这些都放在 app.xaml (Application.Resources) 中。

请参考：http: [//msdn.microsoft.com/en-us/library/system.windows.resourcedictionary.aspx](http://msdn.microsoft.com/en-us/library/system.windows.resourcedictionary.aspx)

# php - Javascript跨域认证

> ID：10419936
> 
> 赞同：0
> 
> 时间：2012-05-02T18:55:10.660
> 
> 标签：php, javascript

我有一个可以使用外部调用的 JavaScript`<script type="text/javascript" src="http://mydomain.com/myscript.js"></script>`脚本是使用 php 动态创建的，但我需要知道从哪里调用脚本（哪个域）我能想到的唯一方法是使用`$ SERVER["HTTP REFERER"]`但并非所有浏览器都支持这个和它是不安全的，因为它可以改变。

有谁知道我可以做的更好的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T19:00:18.853

首先，浏览器提供的任何东西都不能被信任，这包括[HTTP Referer 标头](http://en.wikipedia.org/wiki/HTTP_referer)。

但是我不同意这种不安全的做法，您到底在用这些信息做什么？服务器所能做的就是信任浏览器提供的内容，因此如果您尝试限制此 javascript，您将必须首先对用户进行身份验证（以便您可以植入 cookie）。

那么你的意图到底是什么？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T19:00:35.733

这是我的想法。

使用 PHP 文件呈现 JS 文件内容，它只会在会话 id 匹配时提供 javascript。也隐藏你真正的js文件

# javascript - JSHint 认为 for-in 变量是“坏的”。这是什么意思？

> ID：10419938
> 
> 赞同：16
> 
> 时间：2012-05-02T18:55:29.137
> 
> 标签：javascript, syntax, for-loop, jshint

以下代码：

```
var things = {'foo':'bar'}
for ( thing in things ) {
  console.log(thing)
} 
```

在 jshint 中始终产生以下错误：

```
Bad for in variable 'thing'. 
```

我不明白是什么让“事物”变量“不好”——如您所见，它没有在其他任何地方使用。我应该怎么做才能让 jshint 不认为这是一个错误？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-05-02T18:57:35.553

他们总是 - 如果他们没有被宣布。`var`如果`thing`之前没有声明，请尝试添加。

```
for ( var thing in things ) {
  console.log(thing)
} 
```

或者

```
var thing;

//more code

for ( thing in things ) {
  console.log(thing)
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-02T18:59:46.877

这是您的代码稍作修改，请确保在使用前声明所有内容。

```
var things = {'foo':'bar'}, thing;
for ( thing in things ) {
  console.log(thing)
} 
```

# django - 在 Django 中加密 cookie

> ID：10419942
> 
> 赞同：3
> 
> 时间：2012-05-02T18:55:46.967
> 
> 标签：django, cookies, django-sessions

从 Django 1.4 开始，如果我们使用基于 cookie 的后端进行会话存储，我们现在可以获得免费的加密签名，这很棒。但是，如果我想在会话中存储潜在的敏感信息怎么办？理想情况下，我也会对其进行加密。

这是一个真实的用例：我想在会话中存储一个临时令牌，允许我向另一个服务发出请求（这个令牌在一个小时不活动后过期）。如果没有加密，任何人都可以获得这个令牌并自己发出请求，我想避免这种情况。

我意识到当我将它放入会话时我可以自己加密/解密，但我想知道是否有一种方法可以为基于 cookie 的会话存储自动执行此操作。有没有人有任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T05:16:21.293

您应该继承[签名的会话存储](https://github.com/django/django/blob/master/django/contrib/sessions/backends/signed_cookies.py#L24)并使其使用您的版本`singing.dumps`，`signing.loads`例如，使用任何必要的算法加密腌制字符串（并在反腌制之前对其进行解密）。

# tridion - 如何更改 SDL Tridion Publisher 的日志记录位置？

> ID：10419944
> 
> 赞同：6
> 
> 时间：2012-05-02T18:56:11.963
> 
> 标签：tridion

我想在 SDL Tridion 2011 SP1 实施上启用发布日志。如何启用发布日志记录、提高/降低详细级别并将位置更改为远离 %TRIDION_HOME% 的自定义位置？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-02T18:58:46.727

您必须在 Tridion MMC 管理单元中启用 Publisher 日志记录（Publisher 设置）。

完成此操作后，您可以通过编辑以下文件来控制日志记录的位置、级别和详细信息：\Tridion\bin\TCMPublisher.exe.config

# android - 将覆盖的图像保存到 SD 卡

> ID：10419946
> 
> 赞同：0
> 
> 时间：2012-05-02T18:56:21.293
> 
> 标签：android, image, save, overlay, sd-card

我想保存已设置背景的框架布局，并将另一个图像放在其顶部。
当我使用 onclick 按钮时，它会给我“强制关闭错误”。

我正在使用以下代码：

```
 FrameLayout mainLayout = (FrameLayout) findViewById(R.id.imageView);
 File root = Environment.getExternalStorageDirectory();
 File file = new File(root,"androidlife.jpg");
 Bitmap b = Bitmap.createBitmap(mainLayout.getWidth(), mainLayout.getHeight(), Bitmap.Config.ARGB_8888);
 Canvas c = new Canvas(b);
 mainLayout.draw(c);
 FileOutputStream fos = null;
 try {
    fos = new FileOutputStream(file);

    if (fos != null) {
       b.compress(Bitmap.CompressFormat.JPEG, 90, fos);
       fos.close();
    }
 } catch (Exception e) {
    e.printStackTrace();
 } 
```

这是错误日志：

```
05-03 00:39:37.281: W/dalvikvm(445): threadid=1: thread exiting with uncaught exception (group=0x4001d800)
05-03 00:39:37.301: E/AndroidRuntime(445): FATAL EXCEPTION: main
05-03 00:39:37.301: E/AndroidRuntime(445): java.lang.ClassCastException: android.widget.ImageView
05-03 00:39:37.301: E/AndroidRuntime(445):  at org.example.touch.Touch$1.onClick(Touch.java:60)
05-03 00:39:37.301: E/AndroidRuntime(445):  at android.view.View.performClick(View.java:2408)
05-03 00:39:37.301: E/AndroidRuntime(445):  at android.view.View$PerformClick.run(View.java:8816)
05-03 00:39:37.301: E/AndroidRuntime(445):  at android.os.Handler.handleCallback(Handler.java:587)
05-03 00:39:37.301: E/AndroidRuntime(445):  at android.os.Handler.dispatchMessage(Handler.java:92)
05-03 00:39:37.301: E/AndroidRuntime(445):  at android.os.Looper.loop(Looper.java:123)
05-03 00:39:37.301: E/AndroidRuntime(445):  at android.app.ActivityThread.main(ActivityThread.java:4627)
05-03 00:39:37.301: E/AndroidRuntime(445):  at java.lang.reflect.Method.invokeNative(Native Method)
05-03 00:39:37.301: E/AndroidRuntime(445):  at java.lang.reflect.Method.invoke(Method.java:521)
05-03 00:39:37.301: E/AndroidRuntime(445):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
05-03 00:39:37.301: E/AndroidRuntime(445):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
05-03 00:39:37.301: E/AndroidRuntime(445):  at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T20:29:25.763

问题是你正在这样做：

```
FrameLayout mainLayout = (FrameLayout) findViewById(R.id.imageView); 
```

并且 R.id.imageView 很可能是对`ImageView`. 你最好做这样的事情：

```
ImageView mainLayout = (ImageView) findViewById(R.id.imageView); 
```

# ssrs-2008 - 无法在 AX 2009 的 SSRS 中显示维度扩展数据类型

> ID：10419954
> 
> 赞同：2
> 
> 时间：2012-05-02T18:56:50.123
> 
> 标签：ssrs-2008, reporting-services, dynamics-ax-2009, x++, microsoft-dynamics

如果您使用 AX2009 的内置查询 (EmplTableListPage) 并尝试使用它构建 SSRS 报告，并且使用字段 Dimension[1]（或任何维度字段），则 Visual Studio 2008 中的报告预览将正确呈现. 将报告部署到 SSRS 服务器后，它将无法加载并出现类似以下的错误：

```
 An error has occurred during report processing. (rsProcessingAborted)
Query execution failed for dataset 'Dataset1'. (rsErrorExecutingCommand)
The AX query string 'SELECT EmplTable.1.Dimension[1],EmplTable.1.EmplId,DirPartyTable.1.Name FROM EmplTableListPage' is invalid. The valid format is 'SELECT [fields] FROM [AX query name]', where [fields] can be either '*' or a comma separated field list. 
```

如果您从报告中删除 Dimension[1] 字段并重新部署，则错误消失并且报告正确呈现。

我尝试在 AOT 中的查询中添加一个字段并专门添加 Dimension[1]，但这也不起作用（同样的错误消息）。

如何在 SSRS 报告中显示维度字段中的数据？为什么它在 Visual Studio 中有效，但在 AX 或 Report Manager 网站中无效？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T20:32:12.523

根据 Microsoft 在他们的[What's New in Microsoft Dynamics AX 2012 for Developers](http://msdn.microsoft.com/EN-US/library/gg724100)白皮书中，2012 得到了增强，以支持 AX 2009 中不支持的维度，这意味着您无法在 SSRS 报告上显示维度字段中的数据： ![在此处输入图像描述](../Images/eabe3b61f046eebfd6f8de187a116887.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T08:34:58.127

我使用了这种方法（加入所有可能的维度表组合）请注意，示例仅适用于前两个维度： ![LedgerTransSRS 查询](../Images/670e3937fd6499feb58ade3c2ea43d47.png)

比来自 ssrs：

```
SELECT LedgerTable.1.AccountName,Dimensions.1.DimensionCode:NAME(SysDimension),Dimensions.2.DimensionCode:NAME(SysDimension) FROM LedgerTransSRS 
```

顺便说一句，我原来的查询名称不是 LedgerTransSRS，我原来的查询名称是 LedgerTransSRS_companySufix 我删除了这个例子的 _companySufix。所以不要修改原始的 LedgerTransSRS 查询（因为它存在于 SYS 层并正在使用）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T09:26:27.693

有同样的问题，但能够解决它。当您在 SSRS 中添加数据集时，您必须在维度中添加所有字段（您的查询在字段中列出了维度） - 而不仅仅是您要访问的维度的字段。

所以在 ssrs 中对数据集的查询应该是：

```
SELECT * FROM EmplTable 
```

导致错误的查询部分是：`EmplTable.1.Dimension[1]`

在 SSRS 的数据集中获取查询中的所有字段，它应该可以解决问题。

# css - 减小windows屏幕尺寸时如何使用css将div从左下角浮动到右上角

> ID：10419967
> 
> 赞同：0
> 
> 时间：2012-05-02T18:57:46.203
> 
> 标签：css, html

我想知道我是否可以使用 CSS 像这样浮动 div。我想做的是在减小窗口大小时将 CSS DIV 1 下的 CSS DIV 2 的 DIV 向右移动。请看下面的截图：

这就是三个 DIV 在更大的窗口大小上显示的方式。第一个 DIV 在左上角，第二个 DIV 在第一个 DIV 下方。然后第三个 DIV 在右上角。

![正常查找三个 DIV](../Images/c5754520d1df402c15c116cfa0398be2.png)

当我调整浏览器窗口的大小时，宽度较宽的第三个 DIV 将下降到第一个 DIV 下方的底部，第二个 DIV 将自动移动到右上角以填充空间。 ![调整浏览器窗口大小后](../Images/6d6f9f52637cba423cf9e54bc73f9af3.png)

有人认为这可以通过使用 CSS 来实现，并且可能不需要使用 JS 或其他？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T19:05:36.953

我想说改变是通过从列布局更改为行布局，或者通过交换两个元素的顺序来实现的。无论哪种方式，它都需要 JavaScript。

# windows-7 - Windows7 中的 Log4Net localhost 寻址问题

> ID：10419971
> 
> 赞同：3
> 
> 时间：2012-05-02T18:57:58.963
> 
> 标签：windows-7, configuration, log4net, localhost, ip-address

我最近将我的解决方案从 XP 机器转移到了 Windows7 机器。

我在我的解决方案中使用 Log4Net 并使用 Log2Console 通过 UDP 读取它

当我使用以下配置时，Log2Console 没有得到任何结果：

```
 <appender name="UdpAppender" type="log4net.Appender.UdpAppender">
        <remoteAddress value="localhost" />
        <remotePort value="7071" />
        <layout type="log4net.Layout.XmlLayoutSchemaLog4j" />
    </appender> 
```

但是，如果我 NSLookup 发现我当前的 IP 地址，它确实

```
<appender name="UdpAppender" type="log4net.Appender.UdpAppender">
    <remoteAddress value="192.168.1.64" />
    <remotePort value="7071" />
    <layout type="log4net.Layout.XmlLayoutSchemaLog4j" />
</appender> 
```

127.0.0.1 也不起作用。

有人可以解释发生了什么以及我该如何解决吗？我显然不想在源代码控制项目中使用动态分配的 IP！

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T19:36:08.183

为了回答我自己的问题，有很多关于 Log4Net 和 IPV6 的讨论，在我的情况下，[这里](http://old.nabble.com/Log4net-UDP-Appender-and-Chainsaw-on-Windows-7-td27439707.html)提供了几种解决方法，但问题是主机文件。

显然，我的盒子带有 ::1 和 127.0.0.1 地址，为 localhost 注释掉了。我取消了 IPV4 的注释并且它正在工作（我怀疑如果需要这将解决 IPV6，请注意您需要在 Log2Console 接收器中启用 IPV6）

编辑：显然这在[v1.2.11](https://issues.apache.org/jira/browse/LOG4NET-112)之后得到解决。

# javascript - 如何在不禁用其他脚本的情况下将 Javascript 添加到组件中？

> ID：10419978
> 
> 赞同：0
> 
> 时间：2012-05-02T18:58:24.193
> 
> 标签：javascript, components

我使用 woothemes 的 Swatch 模板。我已经修改了徽标组件，我想将以下脚本添加到我的徽标中。我在 header.php 中复制了这个脚本。

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
    <script type="text/javascript">
            $(function coba() {
                    // set opacity to nill on page load
                    $("#logo a span").css("opacity","0");
                    // on mouse over
                    $("#logo a span").hover(function () {
                        // animate opacity to full
                        $(this).stop().animate({
                            opacity: 1
                        }, 'slow');
                    },
                    // on mouse out
                    function coba() {
                        // animate opacity to nill
                        $(this).stop().animate({
                            opacity: 0
                        }, 'slow');
                    });
                });
    </script> 
```

但是，当我运行它时，另一个脚本被禁用了。所有这些，用于滑块、漂亮照片、评论等的 js。我怎样才能一次将它们全部激活？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T19:06:23.460

看起来您可能会遇到递归调用在繁忙循环中占用浏览器线程的问题。以下代码有效，但不需要递归调用。

```
<script type="text/javascript">
    $(document).ready(function() {

            // set opacity to nill on page load
            $("#logo a span").css("opacity","0");

            $("#logo a span").hover(
                function () {
                    // on mouse over
                    $(this).stop().animate({
                        opacity: 1
                    }, 'slow');
                },
                function () {
                    // on mouse out
                    $(this).stop().animate({
                        opacity: 0
                    }, 'slow');
                });
        });
</script> 
```

# android - 使用 SearchView 后重置操作栏

> ID：10419980
> 
> 赞同：11
> 
> 时间：2012-05-02T18:58:32.240
> 
> 标签：android, android-actionbar, searchview

我正在使用`SearchView`小部件在我的应用程序中启用搜索。在最初单击搜索图标后，`SearchView`小部件会展开到搜索字段中，并且“返回”箭头显示在应用程序图标旁边。如果我单击应用程序图标，操作栏会恢复到初始状态（没有“后退”箭头）并且`SearchView`恢复到图标。

现在的问题是：执行搜索后，操作栏没有改变，唯一恢复的方法是单击应用程序图标或手机的“返回”箭头。不好，因为我希望操作栏在搜索完成后进入初始状态。我试过`SearchView.setIconofied(true)`了，但有两个问题：

1.  搜索图标与编辑字段出现在同一位置（最初位于最右侧）。
2.  操作栏仍显示“返回”箭头。

我认为我面临的问题是偏离常规导航模式造成的。在我的情况下，一切都发生在同一个活动中（搜索结果显示在承载操作栏的同一个活动中），因此例如执行`Activity.finish()`只会让应用退出。

如何触发操作栏的“后退一步”？还是模拟点击应用程序图标？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-05-05T19:09:59.560

听起来您已将其设置为 MenuItem 上的可折叠操作视图。您可以在该 MenuItem 实例上调用[collapseActionView()](http://developer.android.com/reference/android/view/MenuItem.html#collapseActionView%28%29)以将其发送回其关闭状态。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-28T14:25:26.550

方法**collapseActionView()**仅适用于 API 级别 14。如果您希望支持早期版本的 android，那么您应该使用**MenuItemCompat**库。

这是我折叠搜索视图并重置操作栏的解决方案...

```
private MenuItem searchMenuItem;

@Override
public boolean onCreateOptionsMenu(Menu menu)
{
    getMenuInflater().inflate(R.menu.main_menu, menu);
    SearchManager searchManager = (SearchManager) getSystemService(Context.SEARCH_SERVICE);
    searchMenuItem = menu.findItem(R.id.action_search);
    final SearchView searchView = (SearchView) MenuItemCompat.getActionView(searchMenuItem);
    searchView.setSearchableInfo(searchManager.getSearchableInfo(getComponentName()));
    searchView.setIconifiedByDefault(false);

    customizeSearchView(searchView);

    return super.onCreateOptionsMenu(menu);
}

    @Override
protected void onNewIntent(Intent intent)
{
    setIntent(intent);

    if (searchMenuItem != null)
    {
        if (MenuItemCompat.expandActionView(searchMenuItem))
        {
            MenuItemCompat.collapseActionView(searchMenuItem);
        }
        else if (MenuItemCompat.collapseActionView(searchMenuItem))
        {
            MenuItemCompat.expandActionView(searchMenuItem);
        }
    }

    handleIntent(intent);
} 
```

# iphone - 更改 UITableViewCell 宽度以适应单元格外部的 UIImageView

> ID：10419982
> 
> 赞同：1
> 
> 时间：2012-05-02T18:58:40.950
> 
> 标签：iphone, objective-c, ios, uitableview

我想知道从以下布局中实现的最佳方法/正确方法？我想将 UIImageView 放在 UITableViewCell 之外的带有静态单元格的 UITableView 中。

![我要实现的目标的屏幕截图](../Images/939eaaf096b80b56958603d37a35b1a6.png)

我通过使用以下代码为第 1 节中的单元格子类化 UITableViewCell 完成了以下操作

```
- (void)setFrame:(CGRect)frame {
    frame.size.width -= 125.0;
    [super setFrame:frame];
} 
```

在 UITableViewController 的 viewDidLoad 中，我添加 UIImageView 并根据自定义 UITableViewCell 的宽度定位它。

这种工作，但我不知道如何处理轮换以及我到目前为止所做的是否是正确的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T19:02:14.610

有不同的方法可以做到这一点。一种是设置表格视图的宽度，如图 2 所示，使用自定义表格视图单元格并在所需的单元格上添加图像，以便显示单元格数据和图像。我认为自定义单元格将是更好的解决方案。告诉我您是否在问我回答的问题，如果不是，那么我会查看我的答案，谢谢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T08:50:35.503

我设法使用以下方法产生了我想要的东西，这不是最好的方法或最干净的方法，但是由于 StackOverFlow 没有人给出更好的建议，我认为我最好回答这个问题。

我对前 3 个 UITableViewCells 进行了子类化，并设置了一个框架大小以考虑我的图像大小。

```
- (void)setFrame:(CGRect)frame {
float cellWidth = (frame.size.width - 345);
frame.size.width = cellWidth;

[super setFrame:frame]; 
```

}

然后在我的 UITableViewController 的 viewDidLoad 中，我使用 tableview 中的第一个静态单元格作为 IBOutlet（“firstCell”）创建和定位 UIImageView。然后我设置了 autoResizingMask 来排序旋转，最后将 UIImageView 添加到视图中。

```
//Create and position the image view
UIImageView *imageView = [[UIImageView alloc] initWithFrame:CGRectMake((firstCell.frame.size.width), (firstCell.frame.origin.y + 70), 300, 137)];

// Add border and round corners of image view to make style look a little like tableviewcells
[imageView.layer setBorderColor:[UIColor colorWithWhite:0 alpha:0.5].CGColor];
[imageView.layer setBorderWidth:2.0];
[imageView.layer setCornerRadius:5.0];
[imageView setClipsToBounds:YES];

//Set the image in the image view
UIImage *image = [UIImage imageNamed:@"defaultPicture.png"];
imageView.image = image;

//Set resizing of image view for when view is rotated
imageView.contentMode = UIViewContentModeRedraw;
imageView.autoresizingMask = UIViewContentModeScaleAspectFit;

//Add tap gesture for imageview to initiate taking picture.
imageView.userInteractionEnabled = YES;
UITapGestureRecognizer *imageViewTap = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(takePicture:)];
[imageView addGestureRecognizer:imageViewTap];

//Add image view to view
[self.view addSubview:imageView]; 
```

![景观](../Images/71f36dd2fdd0103cd8da3216a26ba086.png) ![肖像](../Images/67691134ec19f18d29d103090f1f5566.png)

这还没有经过全面测试，我敢肯定这不是一个很好的实现，但它是我所追求的效果的起点。如果您知道更好的方法，请回复。

注意：上面的代码是为我在 iPad 上的应用程序编写的，但截图来自我在 iPhone 上所做的测试

# visual-studio-2010 - 每次在 VS 2010 上发布之前，如何进行 SVN 提交

> ID：10419985
> 
> 赞同：3
> 
> 时间：2012-05-02T18:59:11.457
> 
> 标签：visual-studio-2010, svn, visualsvn

我正在运行 Visual Studio 2010、VisualSVN 和 TortoiseSVN。

每次我使用 webdeploy 部署网站时，我都希望它能够将我的所有文件提交到 SVN。实现这一目标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T19:23:27.647

当您点击发布按钮时，Visual Studio 会进行构建。您可以在 VS2010 中创建构建配置，在构建成功后执行命令。您应该安装命令行 SVN 客户端并使用它来执行提交。从 Build Configuration 调用 SVN 命令行客户端。

一种更常见的方法是将您的更改提交到版本控制系统，而不是使用 WebDeploy。然后让构建服务器从版本控制中获取源并将更改合并到服务器中。CruiseControl.NET 是一个很好的工具。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T09:51:35.633

您应该调查[https://github.com/loresoft/msbuildtasks](https://github.com/loresoft/msbuildtasks)，它一旦安装并集成到您的项目文件中，就会为创建自定义 msbuild 操作提供支持。

安装它后，您可以创建“SvnCommit”操作并将其与项目文件中的*beforebuild*或*afterbuild*目标相关联。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T14:14:14.180

可能这不是您正在寻找的答案 - 但我认为您无法立即获得此答案。我建议您创建一个 Visual Studio 插件并将其与[SharpSVN](http://sharpsvn.open.collab.net/)（颠覆客户端 API）集成以实现您想要的。

**更新：**

正如@maddoxej 提到的，构建后的操作也可能有效。但是，我发现很容易错过选择的配置 - 然后按 F5。而且一不小心就投身SVN一般不是好事。

我想到的另一个选择可能是 VS 宏。只需记录一个单击部署然后提交到 SVN 的宏。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T15:09:44.510

建议将签入作为构建操作的答案略有缺陷，因为发布过程可能会增加发布的内部版本号作为发布过程的一部分。这将修改需要签入的源代码。

# asp.net - 托管环境中的 asp.net 和 Castle.Windsor -> 无法获得所需的权限

> ID：10419989
> 
> 赞同：0
> 
> 时间：2012-05-02T18:59:26.267
> 
> 标签：asp.net, iis, castle-windsor, hosted

我正在开发一个 asp.net 3.5 Web 应用程序，它在我的本地 IIS 服务器上完美运行，但是在将它发布到托管（1and1）环境时给我带来了很多麻烦。

加载 web.config 时，“System.Security.Policy.PolicyException：无法获取所需的权限”。抛出异常。堆栈跟踪表明这是由我使用 Castle.Windsor 框架引起的：

> [PolicyException: 无法获取所需权限。]
> System.Security.SecurityManager.ResolvePolicy(Evidence evidence, PermissionSet reqdPset, PermissionSet optPset, PermissionSet denyPset, PermissionSet& denied, Boolean checkExecutionPermission) +7606231
> System.Security.SecurityManager.ResolvePolicy(Evidence evidence, PermissionSet reqdPset, PermissionSet optPset, PermissionSet denyPset, PermissionSet& denied, Int32& securitySpecialFlags, Boolean checkExecutionPermission) +57
> 
> [FileLoadException：无法加载文件或程序集“Castle.Windsor，版本=3.0.0.0，文化=中性，PublicKeyToken=407dd0808d44fbdc”或其依赖项之一。未能授予最低权限请求。（HRESULT 异常：0x80131417）]
> System.Reflection.Assembly._nLoad（AssemblyName 文件名，字符串 codeBase，证据 assemblySecurity，程序集 locationHint，StackCrawlMark 和 stackMark，布尔 throwOnFileNotFound，布尔 forIntrospection）+0 System.Reflection.Assembly.nLoad（AssemblyName 文件名，字符串 codeBase、证据 assemblySecurity、Assembly locationHint、StackCrawlMark& stackMark、布尔 throwOnFileNotFound、Boolean forIntrospection) +43
> System.Reflection.Assembly.InternalLoad(AssemblyName assemblyRef, Evidence assemblySecurity, StackCrawlMark& stackMark, Boolean for Introspection) +127
> System.Reflection.Assembly.InternalLoad(String assemblyString, Evidence assemblySecurity, StackCrawlMark& stackMark, Boolean for Introspection) +142 System.Reflection.Assembly。加载（字符串程序集字符串）+28
> System.Web.Configuration.CompilationSection.LoadAssemblyHelper（字符串程序集名称，布尔星指令）+46
> 
> [ConfigurationErrorsException：无法加载文件或程序集“Castle.Windsor，版本=3.0.0.0，文化=中性，PublicKeyToken=407dd0808d44fbdc”或其依赖项之一。未能授予最低权限请求。（来自 HRESULT 的异常：0x80131417）]
> System.Web.Configuration.CompilationSection.LoadAssemblyHelper（字符串 assemblyName，布尔 starDirective）+613
> System.Web.Configuration.CompilationSection.LoadAllAssembliesFromAppDomainBinDirectory() +203 System.Web.Configuration.CompilationSection.LoadAssembly（AssemblyInfo ai) +105
> System.Web.Compilation.BuildManager.GetReferencedAssemblies(CompilationSection compConfig) +178
> System.Web.Compilation.BuildProvidersCompiler..ctor(VirtualPath configPath, Boolean supportLocalization, String outputAssemblyName) +54 System.Web.Compilation.ApplicationBuildProvider.GetGlobalAsaxBuildResult(Boolean isPrecompiledApp) +232
> System.Web.Compilation.BuildManager.CompileGlobalAsax() +51
> System.Web.Compilation.BuildManager.EnsureTopLevelFilesCompiled() +337
> 
> [HttpException（0x80004005）：无法加载文件或程序集“Castle.Windsor，版本=3.0.0.0，文化=中性，PublicKeyToken=407dd0808d44fbdc”或其依赖项之一。未能授予最低权限请求。（HRESULT 异常：0x80131417）]
> System.Web.Compilation.BuildManager.ReportTopLevelCompilationException() +58 System.Web.Compilation.BuildManager.EnsureTopLevelFilesCompiled() +512 System.Web.Hosting.HostingEnvironment.Initialize(ApplicationManager appManager, IApplicationHost appHost, IConfigMapPathFactory configMapPathFactory, HostingEnvironmentParameters hostingParameters) +729
> 
> [HttpException（0x80004005）：无法加载文件或程序集“Castle.Windsor，版本=3.0.0.0，文化=中性，PublicKeyToken=407dd0808d44fbdc”或其依赖项之一。未能授予最低权限请求。（HRESULT 异常：0x80131417）] System.Web.HttpRuntime.FirstRequestInit（HttpContext context）+8921851
> System.Web.HttpRuntime.EnsureFirstRequestInit（HttpContext context）+85 System.Web.HttpRuntime.ProcessRequestNotificationPrivate（IIS7WorkerRequest wr，HttpContext context）+333

由于托管环境的限制，我在调查此问题方面非常有限 - 特别是我无法查看 machine.config 和 IIS 配置。我肯定知道的一个事实是它运行在 2.0.50727.5456 框架上......托管服务商的客户服务既不称职也不愿意提供帮助，所以我必须自己做。

任何有关如何深入研究原因或如何简单解决此问题的建议都非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-05T14:22:08.523

我发现 1&1 对所有托管的 asp.net 应用程序使用一般的中等信任级别。很明显，Castle Windsor 无法在这样一个权限受限的环境下运行（例如反射在那里不可用）。

幸运的是，在这种情况下可以使用很多替代方案（参见[which-ioc-runs-in-medium-trust ）。](https://stackoverflow.com/questions/2200810/which-ioc-runs-in-medium-trust)我只是使用了[简单的注入器](http://simpleinjector.codeplex.com/)，它是一个很小的（但对于我的目的来说足够强大）IoC 容器，它做得很好，解决了我所有的权限问题。

# c - 为包含指针的结构创建 MPI_Datatype

> ID：10419990
> 
> 赞同：12
> 
> 时间：2012-05-02T18:59:37.910
> 
> 标签：c, mpi

我有以下结构。

```
typedef struct
{
 int *Ai;
 double *Ax;
 int nz;
}column; 
```

我想使用`MPI_Send`and转移这个结构`MPI_Receive`。我如何`MPI_Datatype`为这个结构创建一个？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-04T15:47:28.667

MPI 旨在处理结构数组而不是数组结构。

`MPI_Hindexed`@suszterpatt 提出的那个是一个可怕的黑客攻击。它只允许您发送结构类型的一个元素，并且只允许发送用于定义 MPI 数据类型的元素。对于相同结构类型的其他变量，大多数情况下可以保证计算出的偏移量是错误的。此外， **Hindexed**类型对所有元素使用一种且相同的 MPI 数据类型，因此不允许您同时发送整数和双精度数。

明智的做法是将程序转换为使用结构数组：

```
 typedef struct
 {
    int i;
    double z;
 } point;

 typedef struct
 {
    point *A;
    int nz;
 } column; 
```

现在您可以创建一个 MPI 结构化类型`point_type`并使用它来发送`nz`该类型的元素`column.A`作为缓冲区地址：

```
 int lens[3];
 MPI_Aint base, disps[2];
 MPI_Datatype oldtypes[2], point_struct, point_type;

 MPI_Get_address(&point, disps);
 MPI_Get_address(&point.z, disps+1);
 base = disps[0];

 lens[0] = 1; disps[0] = MPI_Aint_diff(disps[0], base); oldtypes[0] = MPI_INT;
 lens[1] = 1; disps[1] = MPI_Aint_diff(disps[1], base); oldtypes[1] = MPI_DOUBLE;
 MPI_Type_create_struct(2, lens, disps, oldtypes, &point_struct);
 MPI_Type_create_resized(point_struct, 0, sizeof(point), &point_type);
 MPI_Type_commit(&point_type);

 MPI_Send(column.A, column.nz, point_type, ...); 
```

这首先创建了一个 MPI 数据类型`point_struct`，用于描述结构成员的布局，但不考虑末尾的任何填充，因此不能用于可靠地发送此类结构的数组。`point_type`因此，使用 . 创建具有正确范围的第二种数据类型`MPI_Type_create_resized`。

在接收方，您可以使用 来查看消息`MPI_Probe`，提取`MPI_Get_count`类型为`point_type`（直接进入`nz`字段）的元素数量，分配`A`字段并使用它`MPI_Recv`来接收`nz`元素：

```
 MPI_Status status;
 MPI_Probe(source, tag, comm, &status);
 MPI_Get_count(&status, point_type, &column.nz);
 if (nz == MPI_UNDEFINED)
   ... non-integral message was received, do something
 column.A = (point *)malloc(column.nz*sizeof(point));
 MPI_Recv(column.A, column.nz, point_type, source, tag, comm, MPI_STATUS_IGNORE); 
```

如果无法更改代码，您仍然可以在发送之前完成转换结构的中间步骤，该过程通常称为*(un-)marshaling*。在您的情况下，请执行以下操作（我假设您将数组元素的数量存储在两个字段`Ai`中）：`Ax``nz`

```
 point *temp = (point *)malloc(nz*sizeof(point));
 for (int i = 0; i < column.nz; i++)
 {
   temp[i].i = column.Ai[i];
   temp[i].z = column.Az[i];
 }
 MPI_Send(temp, nz, point_type, ...);
 free(temp); 
```

在接收方，你必须做相反的事情：分配一个足够大的缓冲区来保存结构，在其中接收消息，然后进行相反的转换。

再一次，您不需要传输 的实际值，`nz`因为可以使用 轻松从消息长度中提取它`MPI_Get_count`。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-02T21:19:23.077

向另一台机器发送指针是没有意义的（没有双关语的意思）。由于虚拟寻址，指针可能会指向接收机器上的无效内存位置，即使不是，您实际上也没有发送它所指向的数据。

但是，通过正确使用`MPI_Address()`数据`MPI_Hindexed`类型，可以描述数据的内存布局（我假设您的指针指向动态数组）。例如，如果`Ai`指向 3 `int`s 和`Ax`5 `double`s，您将需要一个`Hindexed`具有 3 个块的类型：3 `MPI_INT`s、5 `MPI_DOUBLE`s 和 1 `MPI_INT`，偏移量使用`MPI_Address()`.

如果您更改要发送的项目数或完全重新分配数组，请不要忘记重新定义并重新提交数据类型。如果您要发送多个结构，则必须为每个结构定义并提交此数据类型，因为您的 MPI 数据类型特定于这些结构的一个特定实例。

另请记住，如果您想重新创建原始结构，则必须在接收端进行一些类似的棘手解包。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-11-05T20:39:56.823

“明智的做法是将程序转换为使用结构数组”

通常这在概念上也更好。

我想指出另一种机制：使用 MPI_Pack 和 MPI_Unpack。例如，使用原始结构，您可以打包第一个整数，然后打包两个数组。接收者将解包整数，然后知道要解包多少其他东西。

如果您的对象不能直接访问但只能通过迭代器左右访问，这也是一个很好的解决方案。

# jquery - 删除动态创建的行 - 我需要将委托 () 放在哪里？

> ID：10419991
> 
> 赞同：0
> 
> 时间：2012-05-02T18:59:39.493
> 
> 标签：jquery, dynamic, delegates

我继承了一些不太工作的代码......

我有一个布局对话框的jsp：

```
<div class="ShippingPoints">
    <div id="dialog-form" title="Shipping Points">
        <p class="validateTips">
            Please include all vendor ship points by product group. If vendor
            ships all products from one location input City, State, Zip Code
            then select "All" for product group.
        </p>

        <fieldset>
            <label font-family="Courier New" align="left" for="city">City</label>
            <input maxlength=50 align="right" type="text" name="city" id="city"
                class="text ui-corner-all" />
            <br />
            <label font-family="Courier New" align="left" for="state">State</label>
            <select maxlength=6 align="right" name="state" id="state"
                class="text ui-corner-all">
                <c:forEach items="${states}" var="state">
                    <option value="${state.fieldValue}">
                        ${state.fieldDescription}
                    </option>
                </c:forEach>
            </select>
            <br />
            <label font-family="Courier New" align="left" for="stateOther">State (Other):</label>
            <input maxlength=6 align="right" type="text" name="stateOther" id="stateOther" value=""
                class="text ui-corner-all" />
            <br />
            <label font-family="Courier New" align="left" for="zip">Zip</label>
            <input align="right" maxlength=10 align="right" type="text" name="zip" id="zip" value=""
                class="text ui-corner-all" />
            <br />
            <label font-family="Courier New" align="left" align="left" for="product">Product</label>
            <input align="right" maxlength=50 type="text" name="product" id="product" value=""
                class="text ui-corner-all" />
            <br />
        </fieldset>
    </div> 
```

在页面上，我有一个打开对话框的链接......和一个调用删除的链接......

```
<table id="shipPoints" class="ui-widget" width="697">
    <tr width="695">
    <td width="395"><a href="#" id="add-shipping-point"> Add Shipping Point </a></td>
    <td width="300">Click <img src="<%= request.getContextPath() %>/images/delete.gif"       onclick="deleteShippingPoints('shipPoints')" /> to remove checked shipping points</td>
</tr>           
</table> 
```

调用这个 jquery 函数

```
$j("#add-shipping-point").click(function() {
    $j("#dialog-form").dialog("open");
    return false;
}); 
```

这是对话框的完整代码

```
$j(function() {
$j("#dialog:ui-dialog").dialog("destroy");

var city = $j("#city"), state = $j("#state"), zip = $j("#zip"), product = $j("#product"), allFields = $j(
        []).add(city).add(state).add(zip).add(product), tips = $j(".validateTips");

function updateTips(t) {
    tips.text(t).addClass("ui-state-highlight");
    setTimeout( function() {
        tips.removeClass("ui-state-highlight", 1500);
    }, 500);
}

function checkLength(o, n, min, max) {
    if (o.val().length > max || o.val().length < min) {
        o.addClass("ui-state-error");
        updateTips("Length of " + n + " must be between " + min + " and "
                + max + ".");
        return false;
    } else {
        return true;
    }
}

function checkRequired(o, n) {
    if (o.val().length == 0) {
        o.addClass("ui-state-error");
        updateTips(n + " is a required field.");
        return false;
    } else {
        return true;
    }
}

function checkRegexp(o, regexp, n) {
    if (!(regexp.test(o.val()))) {
        o.addClass("ui-state-error");
        updateTips("Zip Code is not in proper format.");
        return false;
    } else {
        return true;
    }
}

$j("#dialog-form")
    .dialog(
    {
    autoOpen : false,
    height : 500,
    width : 500,
    modal : true,
    buttons : {
            "Add Shipping Point" : function() {
            var bValid     = true;
            var cityValid  = true;
            var stateValid = true;
            var zipPresent = true;
            var zipValid   = true;

            updateTips("");
            allFields.removeClass("ui-state-error");

            cityValid  = checkRequired(city, "City");
            stateValid = checkRequired(state, "State");
            zipPresent = checkRequired(zip, "Zip");
            if(zipPresent) { zipValid   = checkRegexp(zip, /(^\d{5}$)|(^\d{5}-\d{4}$)/, "Zip Code"); }

            bValid     = cityValid && stateValid && zipPresent && zipValid;

    if (bValid) {
        // make Ajax call save the Shipping Point and add to the list
        var shipPointId = saveShippingPoint();

        // alert(shipPointId);

        if (shipPointId == "na") {
            alert("There was a problem adding the Shipping Point.  Please try again.  
            If the problem persists please contact support.");
        } else {
            $j("#shipPoints tr:last").after(                                                                                        
                "<tr>"
                + "<td>"
                + city.val()
                + ", "
                + state.val()
                + "</td>"
                + "<td>"
                + "<INPUT type='checkbox' NAME='chk' VALUE='"
                + shipPointId
                + "' />"
                + "</td>"
                + "</tr>");
        }
        $j(this).dialog("close");
    }
},
Cancel : function() {
$j(this).dialog("close");
    }
},
close : function() {
    allFields.val("").removeClass("ui-state-error");
}
});

$j("#add-shipping-point").click(function() {
    $j("#dialog-form").dialog("open");
    return false;
});
}); 
```

问题是您可以动态地将行添加到表中，然后如果您选中复选框并删除新创建的行，它不会删除。本质上是因为对删除运输点的调用传递了一个空白 id。

我已经阅读了它，我意识到我必须使用委托将事件绑定到新创建的角色。但是，我所拥有的语法似乎与网络上的语法不太匹配，所以我不确定我会在哪里指定委托？

有人有什么想法吗？

保存和删除代码如下

```
<script>
// Ajax call to add the Shipping Point to the Session
function saveShippingPoint() {

    var savedId = "";

    var xhr = new XMLHttpRequest();
    xhr.onreadystatechange = function() {
        if(xhr.readyState == 4) {
            savedId = xhr.responseText;
            // alert(savedId);
        }
    };      
    var url = '<portlet:resourceURL id="saveShippingPoint"/>';
    xhr.open("GET", url + 
       "?city=" + $j( "#city" ).val() +
       "&state=" + $j( "#state" ).val() +
       "&stateOther=" + $j( "#stateOther" ).val() +
       "&zip=" + $j( "#zip" ).val() +
       "&product=" + $j( "#product" ).val()
       , true);
    xhr.send();

    // alert(savedId);
    return savedId;
}

// A function to delete rows from the Shipping Points table

function deleteShippingPoints(tableID) {
var xhr = new XMLHttpRequest();

var table = document.getElementById(tableID);
var rowCount = table.rows.length;
var shippingPointsId = "";

for ( var i = 0; i < rowCount; i++) {
    var row = table.rows[i];
    var chkbox = row.cells[1].childNodes[0];

    if (null != chkbox && true == chkbox.checked) {
        shippingPointsId = shippingPointsId + chkbox.value + ",";
        table.deleteRow(i);
        rowCount--;
        i--;
    }
}

var url = '<portlet:resourceURL id="deleteShippingPoint"/>';
xhr.open("GET", url + "?shippingPointsId=" + shippingPointsId, true);
xhr.send();
}
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T19:28:44.203

诀窍`.delegate()`是您必须将其绑定到页面上已经存在的容器。保证这一点的一种方法是`$(document).delegate('.myelement', 'click', myhandler);`让它像`.live()`. 但是，如果您想获得更高的性能，请选择一个更接近您要绑定到的元素的容器：

```
$('#mypermanentcontainer').delegate('.mydynamicthing', 'myevent', myhandler); 
```

* * *

**更新**

所以看看你的代码，你有这一行：`$j(function() { ... });`。我假设您将`$j`其用作`$`or的别名`jQuery`。如果是这样，`$j(function() {});`并且`$j(document).ready(function(){});`是完全相同的东西，即在 DOM 准备好时将运行的代码（在 jQuery 中也称为“文档准备就绪”:)。这通常是发生事件绑定的地方。你已经有了一些，你的整个`$j("#dialog-form").dialog(...)`部分是`document.ready`函数内发生的事件连接。

因此，只需将所有其余的事件接线都放在那里，就可以开始了！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T15:27:20.103

将jquery更改为此

```
$j(function() {
$j("#dialog:ui-dialog").dialog("destroy");

$j("#shipPoints2").delegate(".delete-shipping-points", "click", function () {
var xhr = new XMLHttpRequest();

var table = document.getElementById('shipPoints');
var rowCount = table.rows.length;
var shippingPointsId = "";

for ( var i = 0; i < rowCount; i++) {
    var row = table.rows[i];
    var chkbox = row.cells[1].childNodes[0];

    if (null != chkbox && true == chkbox.checked) {
        shippingPointsId = shippingPointsId + chkbox.value + ",";
        table.deleteRow(i);
        rowCount--;
        i--;
    }
}

var url = '<portlet:resourceURL id="deleteShippingPoint"/>';
xhr.open("GET", url + "?shippingPointsId=" + shippingPointsId, true);
xhr.send();
} ); 
```

（其余和之前一样）

和 JSP 到这个

```
<div id="shipping-points-contain">
<table id="shipPoints" class="ui-widget-content" width="697">
<thead>
<tr class="ui-widget-content"  width="696">
        <th class="ui-widget-header" width="395">
    Shipping Points
    </th>
        <th class="ui-widget-header" width="300">
    Remove
    </th>
</tr>
</thead>
<tbody>
<c:forEach items="${shippingPoints}" var="shippingPoint">
<tr width="695">
    <td with="395">
        ${shippingPoint.shippingPointsCity},
        ${shippingPoint.shippingPointsState}
    </td>
    <td width="300">
    <INPUT type="checkbox" NAME="chk" value="${shippingPoint.shippingPointsId}" />
    <INPUT type="hidden" NAME="shipPointId" VALUE="${shippingPoint.shippingPointsId}" />
    </td>                           
</tr>
</c:forEach>
</tbody>
</table>
<table id="shipPoints2" class="ui-widget" width="697">
<tr width="695">
<td width="395"><a href="#" id="add-shipping-point"> Add Shipping Point </a></td>
<td width="300">Click <a href="#" id="delete-shipping-points"> <img src="<%= request.getContextPath() %>/images/delete.gif"  /></a>  remove checked shipping points</td>
</tr>           
</table>
</div> 
```

而且至少我没有收到任何语法错误，页面显示正确并且添加仍然有效，但是当我单击图像时不会触发删除，所以事件绑定还没有......

# emmet - 在 Sublime Text 2 中创建 Zen-Coding Snippets 的简单方法

> ID：10419994
> 
> 赞同：0
> 
> 时间：2012-05-02T19:00:04.090
> 
> 标签：emmet, sublimetext2

就像在 Eclipse 或 Aptana 中一样，**您有一个为它们创建片段和快捷方式的界面**。但是，在 Sublime Text 2 中，只有一个 .py 文件。

有谁知道我该怎么做？

*对不起我的英语，我是巴西人。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-06T10:48:56.123

也许这可以帮助： http: [//net.tutsplus.com/tutorials/tools-and-tips/sexy-code-snippet-management-with-gists/](http://net.tutsplus.com/tutorials/tools-and-tips/sexy-code-snippet-management-with-gists/)

这是关于在 GitHub 上设置 Gists 并通过 Sublime Text 将其用作片段库。

net.tutsplus.com 上也有很多关于 Sublime Text 的其他技巧。

# php - eBay API - PHP 中的 FindItemsAdvanced 调用不返回任何响应

> ID：10419995
> 
> 赞同：2
> 
> 时间：2012-05-02T19:00:08.297
> 
> 标签：php, xml, ebay-api

我试图使用 ebays 搜索 API 执行一个简单的调用，当我打电话时我没有得到任何响应，问题在于实际调用本身。

```
$endpoint = 'http://open.api.ebay.com/shopping?';  
$responseEncoding = 'XML';   
$version = '631';   // API version number
$appID   = 'asdf3e6e3'; 
$itemType  = "AllItemTypes";
$itemSort  = "EndTime";

//find items advanced
$apicalla  = "$endpoint"
    ."callname=FindItemsAdvanced"
    ."&version=$version"
    ."&siteid=0"
    ."&appid=$appID"
    ."&MaxEntries=10"
    ."&ItemSort=EndTime"
    ."&ItemType=AllItemTypes"
    ."&IncludeSelector=SearchDetails"
    ."&responseencoding=$responseEncoding";

    $resp = simplexml_load_file($apicalla); 
```

这个调用相当于

```
http://open.api.ebay.com/shopping?callname=FindItemsAdvanced&version=631&siteid=0&appid=asdf3e6e3&MaxEntries=10&ItemSort=EndTime&ItemType=AllItemTypes&IncludeSelector=SearchDetails&responseencoding=XML 
```

我的问题是我缺少什么来进行这个简单的搜索调用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T19:32:11.283

看起来您正在尝试使用 eBay 的[Shopping API](http://developer.ebay.com/DevZone/Shopping/docs/CallRef/index.html)，特别是`FindItemsAdvanced`我认为很久以前已弃用并且可能不再起作用的调用（我不再在调用参考中看到它）。您想要做的是使用[`findItemsAdvanced`](http://developer.ebay.com/DevZone/finding/CallRef/findItemsAdvanced.html)eBay 的[Finding API](http://developer.ebay.com/devzone/finding/CallRef/index.html)中的 use 。

首先，您需要稍微更改您的 API 端点和查询字符串参数（`findItemsAdvanced`有关详细信息，请参阅上述调用参考，但我相信它看起来更像这样（我`findItemsAdvanced`至少 6 个月没有碰过我的调用，所以我没有对此进行测试）：

```
$endpoint = 'http://svcs.ebay.com/services/search/FindingService/v1?';  
$responseEncoding = 'XML';   
$version = '1.8.0';   // API version number (they're actually up to 1.11.0 at this point
$appID   = 'asdf3e6e3'; 
$itemSort  = "EndTimeSoonest";

//find items advanced
$apicalla  = "$endpoint"
    ."OPERATION-NAME=findItemsAdvanced"
    ."&SERVICE-VERSION=$version"
    ."&GLOBAL-ID=EBAY-US"
    ."&SECURITY-APPNAME=$appID"
    //."&MaxEntries=10"    // look for an equivalent for this (maybe paginationInput.entriesPerPage?)
    ."&sortOrder=EndTimeSoonest"
    //."&ItemType=AllItemTypes"   // not needed AFAICT, otherwise look at itemFilterType
."&descriptionSearch=true";
    ."& RESPONSE-DATA-FORMAT=$responseEncoding";

$resp = simplexml_load_file($apicalla); 
```

除此之外，要使用，您必须按类别 ( ) 或关键字 ( )`findItemsAdvanced`指定要搜索的内容，因此“请指定查询！” 错误信息。`categoryId``keywords`

因此，您还需要添加以下内容（假设关键字）：

```
$keywords = "something";
$apicalla .= "&keywords=" . urlencode($keywords); 
```

为您提供以下内容：

```
$endpoint = 'http://svcs.ebay.com/services/search/FindingService/v1?';  
$responseEncoding = 'XML';   
$version = '1.8.0';   // API version number (they're actually up to 1.11.0 at this point
$appID   = 'asdf3e6e3'; 
$itemSort  = "EndTimeSoonest";
$keywords = "something";    // make sure this is a valid keyword or keywords

//find items advanced
$apicalla  = "$endpoint"
    ."OPERATION-NAME=findItemsAdvanced"
    ."&SERVICE-VERSION=$version"
    ."&GLOBAL-ID=EBAY-US"
    ."&SECURITY-APPNAME=$appID"
    //."&MaxEntries=10"    // look for an equivalent for this (maybe paginationInput.entriesPerPage?)
    ."&sortOrder=$itemSort"
    //."&ItemType=AllItemTypes"   // not needed AFAICT, otherwise look at itemFilterType
    ."&descriptionSearch=true";
    ."& RESPONSE-DATA-FORMAT=$responseEncoding"
    ."&keywords=" . urlencode($keywords);

$resp = simplexml_load_file($apicalla); 
```

最后一点：如果您想加载在结果中找到的特定商品的更多详细信息，您仍然需要使用 Shopping API（特别是[GetSingleItem](http://developer.ebay.com/DevZone/Shopping/docs/CallRef/GetSingleItem.html)和[GetMultipleItems](http://developer.ebay.com/DevZone/Shopping/docs/CallRef/GetMultipleItems.html)调用）。因此，您最终可能会混合使用 Shopping & Finding API。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T05:08:21.270

它应该是这样的：

```
<?php
$url = 'http://svcs.ebay.com/services/search/FindingService/v1?OPERATION-NAME=findItemsAdvanced&SERVICE-VERSION=1.11.0&SECURITY-APPNAME=YOUR_APP_ID&RESPONSE-DATA-FORMAT=XML&REST-PAYLOAD&paginationInput.entriesPerPage=2&keywords=ipod&siteid=203&GLOBAL-ID=EBAY-IN';
$xml = file_get_contents( $url );
$xml = simplexml_load_string( $url );
?> 
```

登录到您的 ebay 开发者帐户并单击此链接：[使用 API 测试工具测试您的调用](http://developer.ebay.com/DevZone/build-test/test-tool/Default.aspx)

希望这可以帮助。

# iphone - 如何更改表格视图的背景，快速对话框

> ID：10419999
> 
> 赞同：0
> 
> 时间：2012-05-02T19:00:17.780
> 
> 标签：iphone

我正在按照有关快速对话框的教程来创建如下表单 ![在此处输入图像描述](../Images/5e5e8d9d579de73096f94a102867cd79.png)

现在，我想更改此表单的背景。有谁知道如何实现这一点，请就此提出建议。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T19:05:49.510

试试这个，如果你想将图像显示为背景：

```
tableView.backgroundColor = [UIColor colorWithPattern:@"your_image_here"]; 
```

或者

```
tableView.backgroundColor = [UIColor colorWithRed:128 green:128 blue:128 alpha:1.0]; 
```

如果这不起作用，您可以设置`backgroundView`表格视图的属性：

```
tableView.backgroundView = [[[UIImageView alloc] initWithImage:[UIImage imageNamed:@"your_image_here"]]] autorelease]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T19:06:07.057

使用. `backgroundView`_`UITableView`

如果要使用图像，只需创建一个`UIImageView`并设置`backgroundView`为它。

```
UIImage *myImage = [UIImage imageNamed:@"foo.png"];
self.tableView.backgroundView = [[UIImageView alloc] initWithImage:myImage]; 
```

您也可以使用`contentMode`来调整图像在视图中的大小。

```
self.tableView.backgroundView.contentMode = UIViewContentModeScaleAspectFill; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T19:06:34.190

您可以尝试一些`UITableView`继承或声明的属性：

`@property(nonatomic, readwrite, retain) UIView *backgroundView` `@property(nonatomic, copy) UIColor *backgroundColor`

第一个可能是您想要的。它由 声明`UITableView`。第二个是继承自`UIView`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-02T19:06:35.933

尝试设置表格视图的背景颜色；它可能需要您将表格视图样式从分组更改为普通样式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-02T19:18:48.387

如果您要设置背景颜色，请尝试此...

```
tableView.backgroundView = nil;
tableView.backgroundColor = [UIColor redColor]; //replace with your colour 
```

但是，如果您想要图案图像，请不要使用该方法...这样做..

```
tableView.backgroundColor = [UIColor clearColor];

UIView *v = [[UIView alloc] init]; //needs memory Managment (arc example)
v.backgroundColor = [UIColor colorWithPatternImage:[UIImage imageNamed:@"pattern.png"]];
tableView.backgroundView = v; 
```

这是因为如果 UITableView 是组样式的，并且您有一个带图案的背景图像作为 tableviews backgroundColor，那么它也将应用于单元格的边缘，但由于它们是单独的视图，因此模式变得不正确。

希望能帮助到你。