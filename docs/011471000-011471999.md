# StackOverflow 问答 11471000-11471999

# android - 如何在不使用已弃用的 AbsolutoyLayout 的情况下在 android 中定位视图

> ID：11471000
> 
> 赞同：0
> 
> 时间：2012-07-13T12:58:40.937
> 
> 标签：android, layout, css-position, absolutelayout

我想在屏幕上放置几个视图，`AbsoluteLayout`让它。但它已被弃用。我尝试以`framelayout`编程方式使用 setMargin() 函数。但它不起作用！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T13:02:04.767

您可以使用具有完整高度/宽度的相对布局，并在视图上设置边距/对齐规则。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T13:02:09.500

如果您不想使用 AbsoluteLayout，您应该使用 RelativeLayout，并使用 setMargin 方法在其中设置视图的位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T13:03:45.047

您必须使用和玩其他布局。绝对布局已被弃用，因为有很多设备具有不同的屏幕，如果您使用绝对坐标，应用程序将非常难看。如果它是适合您的应用程序，那么继续使用 AbsoluteLayout，它仍然可以工作。如果没有，我建议你找一个教程并按照它，你可以对其他布局做任何你想做的事情，就像乐高一样。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-13T13:07:31.377

您必须使用不同布局的组合。根据需要指定填充、边距。

您可以将 TableLayout 与 TableRows 一起使用，后者又具有相对/线性布局。可以使用任何组合，但避免嵌套过多的布局，它们可能会降低应用程序的性能。

# c++ - 使用 GetSaveFileName 写入 txt 文件

> ID：11471001
> 
> 赞同：0
> 
> 时间：2012-07-13T12:58:42.143
> 
> 标签：c++, windows, file

我正在尝试使用 GetSaveFileName 将多个字符串存储在 txt 文件中。该函数使用结构 OpenFileName。我已经彻底查看了[http://msdn.microsoft.com/en-us/library/windows/desktop/ms646839%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms646839%28v=vs.85%29.aspx)下的结构成员，但我仍然无法弄清楚哪个成员负责文件的内容。换句话说，我怎样才能将文本传递给 txt。文件打开了吗？或者这不能立即完成，因此我应该随后使用另一个功能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T13:01:20.127

该功能只是创建“另存为...”对话框并检索用户选择的文件名，而不是实际保存文件；返回后，您可以从中检索所选文件名`lpstrFile`并根据需要使用它（您可能会使用`ofstream`它来写入它）。

# php - 如何在 PHP 中创建树形视图？

> ID：11471006
> 
> 赞同：0
> 
> 时间：2012-07-13T12:59:15.800
> 
> 标签：php, treeview

我有一系列用户，每个用户都可以有父母：

```
array(6) {
    guest => NULL
    moderator => NULL
    member => array(1) [ //username
       0 => "guest" (5) //parent
    ]
    user => array(1) [
       0 => "member" (6)
    ]
    admin => array(1) [
       0 => "moderator" (9)
    ]
} 
```

我想从这些数据中创建树视图。结果应如下所示：[http ://www.phorum.org/phorum5/file.php/62/3237/treeview_lightweight_admin_screenshot.jpg](http://www.phorum.org/phorum5/file.php/62/3237/treeview_lightweight_admin_screenshot.jpg)

结果将是：

```
- guest
    - member
        - user

- moderator
    - admin 
```

编辑：

我尝试编写树生成器，但我不知道如何使用递归。

```
private function generateTree($node)
{
    $return = array();
    if(is_array($node))
    {
        foreach($node as $user => $parents)
        {
            if(is_null($parents))
            {
                $return[$user] = null;
            }
            if(is_array($parents))
            {
                foreach($parents as $parent)
                {
                    if(array_key_exists($parent, $return))
                    {
                        $return[$parent] = $user;
                    }
                    else
                    {
                        dump($user, $parent);
                    }
                }
            }
        }
    }
    return $return;
} 
```

返回：

```
array(2) {
    guest => "member" (6)
    moderator => "admin" (5)
} 
```

剩下：

```
 user => array(1) [
        0 => "member" (6)
    ] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T13:10:04.200

您可以通过使 HTML builder 方法[recursive](http://en.wikipedia.org/wiki/Recursion)来激活它。本质上，该方法使用递增的级别变量（级别 1、2、3、4..）调用自身，直到达到最终级别。每个级别都对 HTML 代码有贡献，具体取决于级别。一个典型的例子是：

```
function render($treeData, &$html, $level = 0) {
    foreach ($treeData->branches as $branch) {
        render($branch, $level + 1);
    }

    $html .= '<div class="section-level-'.$level.'">'.$treeData->currentLevelData.'</div>';
}

$html = '';
render($treeData, $html); 
```

这当然是伪代码。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T13:03:08.957

如果你想调试，你有一些带有`var_dump($array)`（用于 HTML 渲染）或`print_r($array)`（纯文本渲染）的自动视图。对于自定义视图，您必须在数组上循环并编写自己的 HTML

# javascript - location.hash 和返回历史

> ID：11471008
> 
> 赞同：15
> 
> 时间：2012-07-13T12:59:18.297
> 
> 标签：javascript, browser-cache, hashcode

**是否可以调用一个函数来防止浏览器在更改哈希值时记录回溯历史条目？**

我正在编写一个简单的 javascript 库，它可以在用户浏览每个图像时更改浏览器 url 而无需重新加载页面。

这是通过将 location.hash 设置为图像的唯一 ID 来完成的。

```
window.location.hash = imageID; 
```

问题是当用户点击浏览器后退按钮时，他们必须像加载页面一样向后移动每张图片。

如果他们使用图库旋转了 20 张图片，他们必须点击返回 21 次才能返回上一页。

**如何防止使用 javascript 记录回溯历史？**

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-07-13T13:23:27.383

`window.location.replace`将允许您设置 url 而无需将其添加到浏览器历史记录中。

```
var baseUrl = window.location.href.split('#')[0];
window.location.replace( baseUrl + '#' + imageID ); 
```

[文件](https://developer.mozilla.org/en/DOM/window.location)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-13T13:06:42.583

您可以使用[replaceState()](https://developer.mozilla.org/en/DOM/Manipulating_the_browser_history/#The_replaceState%28%29.C2.A0method)。

在更改哈希之前保存历史记录，然后更改哈希，最后将历史记录替换为您保存的历史记录。

或者，您可以使用[popState Event](https://developer.mozilla.org/en/DOM/Manipulating_the_browser_history/#The_popstate_event)。

# c++ - 如何显示一个字符的数字

> ID：11471011
> 
> 赞同：2
> 
> 时间：2012-07-13T12:59:34.790
> 
> 标签：c++, char, ascii

我有一个要显示的多维字符数组。其中一个维度中有数字（0、1、2 等）。当我去显示数组时，我得到了 ascii 结果。我意识到 char 输出按定义工作（char + number = ascii），但我希望专门显示数字。

前任。

```
char a = 3;

cout << a; // gives me # 
```

我想显示 3。我尝试转换为 int： `cout << (int)a;`

我试过在数组内部进行投射`myArray[(int)a];`

这些似乎都不起作用，而且您无法转换`const char`为 a`string`所以我有点迷路了。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-13T13:03:50.893

假设你有

```
char a = 3; 
```

现在你可以：

```
std::cout << static_cast<int>(a); 
```

或者

```
int b = a;
std::cout << b; 
```

或者

```
printf("%d",a); 
```

以上任何一项的输出将是

```
3 
```

# odata - 在 odata 中展开

> ID：11471018
> 
> 赞同：0
> 
> 时间：2012-07-13T13:00:05.893
> 
> 标签：odata

我有两张桌子：

```
T1 with attributes: commonG, g1, g3,g7,g8
T2 with attributes: commonG, g2,g5,g6 
```

WHERE T1.commonG 与 T2.commonG 相同，对于此查询：

```
select t1.commonG, T1.g1, T2.g2
from T1 and T2
where T1.g3=777 and T1.commonG=T2.commonG 
```

所以我想使用**odataquery**访问这个选择数据以 获得一些 g3 值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T18:31:54.867

OData 查询依赖于理解 T1.commonG 和 T2.commonG 之间存在外键关系的 EDM 模型。假设你有这样一个模型，你需要三样东西：

*   $select 系统查询选项允许您进行预测，例如，$select=Name,Category/Name
*   $expand 系统查询选项允许您指定来自两个不同表的投影（将其视为满足上述查询中的逻辑连接）
*   $filter 系统查询选项允许您指定上面 where 子句的等效项

现实世界中的一个实际示例是以下查询： [`http://services.odata.org/Experimental/OData/OData.svc/Products?$expand=Category&$filter=Category/Name%20eq%20'Food'&select=Name,Category/Name`](http://services.odata.org/Experimental/OData/OData.svc/Products?%24expand=Category&%24filter=Category/Name%20eq%20%27Food%27&select=Name,Category/Name)

如果您将 T1 映射到示例服务中的 Product 并将 T2 映射到示例服务中的 Category，您会发现此示例非常接近您实际想要实现的目标。

# excel - 上传后如何在struts2中获取excel文件的内容？

> ID：11471028
> 
> 赞同：0
> 
> 时间：2012-07-13T13:00:38.693
> 
> 标签：excel, file-upload, struts2, apache-poi

我正在研究 Struts2 框架。我需要将一个 excel 文件上传到缓冲区，以便我可以提取其信息并将它们打印到 jsp 页面中的表格中。我遵循了这个教程：[http](http://www.roseindia.net/struts/struts2/struts-2-file-upload.shtml) ://www.roseindia.net/struts/struts2/struts-2-file-upload.shtml ，所以我可以上传任何类型的文件。我的问题是：如何将类型限制为 .xls 和 .xlsx ？以及如何获取 excel 文件中存在的行的内容？我在某处读到我可以使用 Apache POI API ......但我不知道该怎么做。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T14:07:07.160

您看过[Struts 2 文件上传教程](http://www.dzone.com/tutorials/java/struts-2/struts-2-example/struts-2-file-upload-example-1.html)吗？

它显示了如何限制某些 mime 类型。

[您需要此处](https://stackoverflow.com/questions/974079/setting-mime-type-for-excel-document)描述的用于 excel的 mime 类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T21:49:46.787

有一个名为 jxl 的开源库。将文件上传到服务器后，您可以读取它并遍历 ght 行。它很容易做到。

# asp.net - ASP.NET 跨 .NET 3.5 和 .NET 4 应用程序共享 machineKey

> ID：11471033
> 
> 赞同：3
> 
> 时间：2012-07-13T13:00:54.237
> 
> 标签：asp.net, authentication, forms-authentication, machinekey

> **可能重复：**
> [基于表单的身份验证在 .Net 2.0 和 .Net 4.0 应用程序之间不起作用](https://stackoverflow.com/questions/9295798/forms-based-authentication-not-working-between-net-2-0-and-net-4-0-application)

我有两个 ASP.NET 应用程序。第一个是 .NET 3.5 应用程序，第二个是 .NET 4 应用程序。

.NET 3.5 应用程序负责对用户进行身份验证。

它们都共享相同的机器密钥，将 SHA1 指定为验证算法（按照[http://www.asp.net/whitepapers/aspnet4/break-changes#0.1__Toc256770148](http://www.asp.net/whitepapers/aspnet4/breaking-changes#0.1__Toc256770148)的说明）

```
<machineKey decryption="Auto" decryptionKey="FD6F049F1F1E91CC29576A2B5E2197C792EB28557D016E8C" validation="SHA1" validationKey="7A057944F91ABB19DDDE99425ECE9BF79F364492A2D1F555D9A46A703F5CB0B0ADAD955D05EBAF1B65C596B572BC6EE17FA8765885E74B8C22C0396B5E042201" /> 
```

但是我无法登录到第二个应用程序。

如果我将第一个应用程序转换为 .NET 4 或将第二个应用程序转换为 .NET 3.5，我可以登录。不幸的是，这在我的生产应用程序中是不可能的。

我在这里错过了什么吗？

谢谢，本

**更新**

当由 .NET 3.5 应用程序创建时，cookie 的长度似乎更短。这可能是一个红鲱鱼，但我想我会发布它的完整性。

**更新 2**

这个问题已经被问到并回答了[基于表单的身份验证在 .Net 2.0 和 .Net 4.0 应用程序之间不起作用](https://stackoverflow.com/questions/9295798/forms-based-authentication-not-working-between-net-2-0-and-net-4-0-application)。

# jquery - 页面上有多个 flex 滑块的奇怪闪烁背景

> ID：11471034
> 
> 赞同：4
> 
> 时间：2012-07-13T13:00:57.577
> 
> 标签：jquery, animation, background, flexslider

我有一个 1 页的网站，有多个部分，每个部分包含一个内容 DIV 和一个 flexslider。在较大的屏幕上，似乎有一个奇怪的错误导致背景随着幻灯片动画而闪烁，在此处进行操作：http: [//yyy.comuf.com/PORT/](http://yyy.comuf.com/PORT/)

我认为这是因为页面上有多个 flexslider，但不确定修复它的最佳方法。

JS

```
 $(window).load(function() {
$('#main-slider').flexslider({
  animation: 'slide',
  controlsContainer: '.flex-container'
});

$('#secondary-slider').flexslider(); 
```

});

HTML SLIDER-1

```
<div id="main-slider" class="flexslider">
  <ul class="slides">
    <li>
      <img src="img/FP1.png" />
    </li>
    <li>
      <img src="img/abcd.png" />
    </li>
    <li>
      <img src="img/i-eg.png" />
    </li>
  </ul>
</div> 
```

HTML SLIDER-2

```
<div id="secondary-slider" class="flexslider">
  <ul class="slides">
    <li>
      <img src="img/OU.png" />
    </li>
    <li>
      <img src="img/OU1.png" />
    </li>
    <li>
      <img src="img/OU2.png" />
    </li>
  </ul>
</div> 
```

两个滑块目前是相同的，只是图像不同。

主要的 JS 文件在这里：http: [//yyy.comuf.com/PORT/js/jquery.flexslider.js](http://yyy.comuf.com/PORT/js/jquery.flexslider.js)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-09-15T19:43:17.200

另一种选择是使用

```
-webkit-transform: translateZ(0); 
```

将其应用于容器元素。

我在这里找到了答案： [https ://stackoverflow.com/a/16718476/1031184](https://stackoverflow.com/a/16718476/1031184)

它对我来说非常有效。这也意味着您可以使用 cssTransitions，据我了解，这在移动设备上资源较少。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-03T11:20:35.607

由于 css3 3d 转换中的许多错误，这是一个问题，您可以使用新参数

**使用CSS：假**

包含在新的插件版本中。此选项强制新浏览器（实现 css 转换的 webkit 之一）使用 jquery 4 动画。我是这样解决的。我只在 Chrome 版本 21 中遇到这个问题，但在 Safari 6 中没有。

# c# - 将日期插入数据库时 遇到问题

> ID：11471035
> 
> 赞同：0
> 
> 时间：2012-07-13T13:01:02.980
> 
> 标签：c#, mysql, odbc

我在使用& 5.1插入`MySQL`数据表时遇到问题。尝试写入字段时插入失败。表示该值的格式不正确。它说我插入的值是：`C#``ODBC``DateTime``MySQL``DateTime`

```
13-07-2012 13:46:21.000031000\. 
```

如您所见，秒有一堆十进制数字。我无法弄清楚为什么要添加这些。如果我手动插入一行（例如使用 MySQL Workbench），并提供如下值：

```
13-07-2012 13:46:21 
```

`MySQL`似乎没有添加小数，插入成功完成。据我所见，`DateTime`从参数`C#`到`ODBC`参数不包含这些小数，所以似乎`MySQL`在某些时候添加了它们！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T13:09:53.623

我会使用 MySQL 的 STR_TO_DATE 函数将 C# 格式的日期字符串转换为 MySQL 可以使用的字符串：

```
STR_TO_DATE("13-07-2012 13:46", "%d-%m-%Y %h:%i") 
```

[https://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_str-to-date](https://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_str-to-date)

# c# - 当控件调整大小时，Winforms 自动滚动会丢失

> ID：11471041
> 
> 赞同：3
> 
> 时间：2012-07-13T13:01:21.457
> 
> 标签：c#, .net, winforms, datagridview, scroll

我有一个显示乘用车座椅布局的用户控件。

它简单地以矩阵形式绘制几个“SeatControl”，具体取决于乘用车的尺寸。

为了更好地观看，主控件调整“SeatControl”的大小以适应所有可用空间，这意味着 SeatControls 将根据可用空间变大或变小。

这很完美。

但是，当客户区变得太小时，我们会避免将控件缩小太多，否则它们会变形而无法阅读。

在这种情况下，我们打开自动滚动，以便用户可以滚动查看整个布局。

但是，如果我们从一个小屏幕（带有滚动条）开始，将其最大化（滚动条将隐藏并且座椅控件会增加大小）并恢复窗口大小（滚动将恢复并且座椅控件将缩小到最小尺寸） ，卷轴丢失。

为了清楚起见，图像中的相同操作： ![带有垂直滚动条的小布局](../Images/c69e113fa49e2d02275d233b3b8ffc41.png)

最大化窗口（只显示部分屏幕以避免大图像）：

![部分全屏，请注意滚动已按预期进行](../Images/d4f97106788d083991bd399a079def72.png)

并将其恢复（注意滚动条和客户区的布局位置）： ![但在滚动条上](../Images/4de6bbc0776ee20546f3907e4c2ca551.png)

此调整大小由以下代码控制：

```
private void FixSizes()
    {            
        if (mModel == null)
            return;

        this.SuspendLayout();            

        Size clientSize = this.ClientSize;
        Size minimumSize = new Size(SeatUserControl.MinimumDescentSize.Width, SeatUserControl.MinimumDescentSize.Height);

        //Here we try to find the best size for the seat user control to fit all the client area                      
        Size controlSize = new Size(
            Math.Max(clientSize.Width / mModel.Length, minimumSize.Width),
            Math.Max(clientSize.Height / mModel.Width, minimumSize.Height)
        );

        AutoScrollMinSize = new Size(controlSize.Width * mModel.Length, controlSize.Height * mModel.Width);
        this.SetDisplayRectLocation(0, 0);

        for (int row = 0; row < mModel.Width; ++row)
        {
            for (int col = 0; col < mModel.Length; ++col)
            {
                Control control = this.Controls[(row * mModel.Length) + col];

                control.Location = new Point(col * controlSize.Width, row * controlSize.Height);
                control.Size = controlSize;
            }
        }            

        this.ResumeLayout();
    } 
```

这个方法很简单，由 OnClientSizeChanged 方法调用：

```
protected override void OnClientSizeChanged(EventArgs e)
    {
        base.OnClientSizeChanged(e);

        this.FixSizes();
    } 
```

我能够确定，如果我将 SeatControl 保持在固定大小，问题就会消失，但输出不是那么好，因为我们更喜欢 SeatControl 使用最大可用空间。

所以看起来我错过了或忘记使用自动滚动设置做一些事情，所以它不会丢失。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T14:59:13.870

评论中的解决方案：

假设您正在使用某种父容器，例如面板，或者会限制 SeatControl 最大化大小的东西，请使用停靠“填充”（中间的）。这将自动为您调整控件的滚动条。

对于未来的读者，使用 Dock: Fill 属性时的结果如下所示：

![在此处输入图像描述](../Images/00f43a1302c306ed34d9b6697b9382a9.png)

请注意由于 gridview 控件大于其父容器而自动生成的滚动条。

# php - 关闭浏览器后保持会话

> ID：11471043
> 
> 赞同：1
> 
> 时间：2012-07-13T13:01:26.580
> 
> 标签：php

我的网站上有一个 ASP.NET 登录应用程序，登录后，我可以导航到 WordPress(PHP) 端（仍然在同一个域中），同时保持会话。请参阅下面的我的馅饼链接，了解它是如何工作的。

但是，如果我关闭浏览器，就会出现问题，尽管保留了 ASP.NET 会话，但我会丢失 PHP 的“会话”。所以我在 PHP 端“注销”，但在 .NET 端仍然“登录”。

-- 有没有办法使用我现有的代码为会话/cookie 设置生命周期，以避免在我关闭浏览器时会话/cookie 消失？--

我已经从我的模板中粘贴了我当前的 PHP 代码：http://pastie.org/private/ndcqgbog34uqld1etozda [，](http://pastie.org/private/ndcqgbog34uqld1etozda)它检查并保持会话。

我确实在 PHP.net 上查看了这个示例，但对如何在我的解决方案中使用它感到困惑。

非常感谢您对此的任何指示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T13:04:29.010

认为您应该使用具有到期时间的 setcookie() （请参见此处）。您只是在会话中设置东西（从 cookie 复制，看起来像，但我不确定它们的生命周期是多少）。

而不是这一行：

```
$_SESSION[DOT_NET_SESSION][ $tuple['SessionName'] ] =
$tuple['SessionValue']; 
```

试试这个：

```
$cookie = array($tuple['SessionName'] => $tuple['SessionValue']);
setcookie(DOT_NET_SESSION, $cookie, time() + 60 * 60 * 24); 
```

我想那应该设置一天的cookie。

# validation - PowerBuilder 如果不可用，则向 SQL 表插入一条记录消息框，如果不可用

> ID：11471047
> 
> 赞同：0
> 
> 时间：2012-07-13T13:01:37.557
> 
> 标签：validation, powerbuilder, datastore, sql-insert

我对 PowerBuilder Classic 12 还很陌生。我需要一个示例代码来检查记录是否可用，如果不可用，则从文本框中插入。我可能需要一个 DataStore，因为有人建议使用 SQL 语句。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T00:04:51.737

## 我不确定这是否在回答您的问题，但您可以这样：

字符串 ls_CheckRecord 字符串 ls_InsertRecord

SELECT record2Check INTO :ls_Check FROM myTable WHERE conditionsMet;

If ( SQLCA.SQLCode <> 0 ) Then Messagebox("SQL Error",SQLCA.SQLErrText) Return End if

If (NOT IsNull(ls_Check) ) Then ls_InsertRecord = sle_ToInsert.Text

插入 myTable (myColumn) 值 (:ls_InsertRecord) ;

If ( SQLCA.SQLCode <> 0 ) Then Messagebox("SQL Error",SQLCA.SQLErrText) Return End if End if

# android - 如何将默认背景分配给按钮？

> ID：11471049
> 
> 赞同：-3
> 
> 时间：2012-07-13T13:01:43.363
> 
> 标签：android, android-widget, background-image

> **可能重复：**
> [如何删除 ImageButton 的标准背景图像？](https://stackoverflow.com/questions/5457138/how-to-remove-imagebuttons-standard-background-image)

我已将自定义背景设置为`Button`. 现在我想恢复此更改并`Button`再次显示默认背景。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T13:02:39.433

您可以`android:background="@null"`为您的`Button`.
或`button.setBackgroundResource(0);`
或`button.setBackgroundDrawable(null);`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-13T13:03:27.013

通过以编程方式，您可以执行以下操作，

```
button.setBackgroundDrawable(null);
button.setBackgroundResource(0); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-13T13:33:20.090

最后我得到了我的问题的解决方案 `btn.setBackgroundDrawable(getResources().getDrawable(android.R.drawable.btn_default));` 这使我的按钮的背景默认情况下。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-13T13:36:52.947

一种解决方案是在将其设置为自定义背景之前记住您将哪个 Drawable 作为背景，例如将其保存为`onCreate()`.

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.your_layout);

    button = (Button) findViewById(R.id.yourbutton);
    defaultButtonBackgroundDrawable = button.getBackground();

    // set a custom background here, or somewhere else. 
    // Just make sure that the default one is saved before you modify it.
} 
```

where`defaultButtonBackgroundDrawable`是您的活动的成员变量，并`button`保留对您的按钮的引用。这样，您可以通过以下方式轻松恢复默认背景

```
button.setBackgroundDrawable(defaultButtonBackgroundDrawable); 
```

# iphone - 在 iOS 中使用警报视图

> ID：11471053
> 
> 赞同：0
> 
> 时间：2012-07-13T13:01:54.933
> 
> 标签：iphone, ios, uialertview

我正在使用 AlertView 和 xcode，xcode 显示消息：未声明的标识符 alertLabel ...

这是代码：

```
-(void)alertView:(UIAlertView *) alerta didDismissWithButtonIndex:(NSInteger)buttonIndex

switch (buttonIndex) {
    case 0:
        alertLabel.text = @"Ok!";
        break;

    default:
        break;
} 
```

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T13:06:29.323

该错误意味着没有警报标签之类的东西，因此请确保正确声明它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-09-05T11:57:33.823

**在 iOS 中使用警报视图**

```
UIAlertView *alert=[[UIAlertView alloc]initWithTitle:nil message:@" Running apps in the background " delegate:self cancelButtonTitle:@"Okay" otherButtonTitles:nil, nil];
    [alert show]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-08-19T19:21:00.503

您可能没有正确定义 AlertLabel，请检查它是否已正确初始化

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-13T13:06:23.503

如果警报是另一个视图控制器中的标签，它是警报视图的代表，请尝试此更改

```
self.delegate.alertLabel.text 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-13T13:22:56.053

你有你的 alertLabel 的 @property 和 @synthesize 吗？

# ios - 应用程序因 xCode 4 无故崩溃

> ID：11471055
> 
> 赞同：1
> 
> 时间：2012-07-13T13:01:58.527
> 
> 标签：ios, xcode4

这里发生了一些奇怪的事情。我的应用程序在这行代码上崩溃：

```
int end = NSMaxRange(endRange); 
```

但我没有收到任何错误消息，一切都很好：endRange。该应用程序只是在 iPhone 中冻结，仅此而已。

1\. 奇怪的是相同的代码之前工作，我已经从存储库反转，看看有什么问题，但它仍然不工作。

2\. 每次应用程序崩溃时，xCode 都会删除断点。我再次添加它，我运行应用程序，我跳过，应用程序崩溃并且 Xcode 删除断点。

3\. 我已经清理了构建，重新启动了 xCode，重新启动了 iPhone，从 iPhone 中删除了应用程序。同样的问题。

4.如果我不使用断点，应用程序不会崩溃，但该行之后的代码被“跳过”，但它之前可以工作。至少应用程序不会在没有断点的情况下冻结。

我勒个去 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T20:45:00.867

我过去也遇到过类似的调试器问题。尝试从 LLDB 切换回 GDB（从 Product / Edit Scheme 菜单）。我发现 LLDB 可以完全按照您对断点的描述进行操作。

# artificial-intelligence - 如何让机器人从经验中学习

> ID：11471056
> 
> 赞同：1
> 
> 时间：2012-07-13T13:02:03.673
> 
> 标签：artificial-intelligence, neural-network, genetic-algorithm, bots

我正在为一款 rts 游戏编写机器人。

我正在使用模糊逻辑来评估当前位置（我的和敌人的）并发出命令。

我有几个模糊变量：`military_buildings`、`civilian_building`、`army_power`和。我也有几个模糊的语言值，如, , , , 。`enemy_power``distance``VERY_GOOD``GOOD``NORMAL``BAD``VERY_BAD`

我的下一个任务是让机器人学习，避免所有人都以同样的方式行事。任何建议或想法如何解决这个问题？

使用 GA 来调整参数（但我不知道玩家的评分，所以我不知道 bot 是赢了弱玩家还是输给了强玩家）。

有没有人有类似问题的经验（如果有更简单的方法可以从经验中学习机器人，我可以更改实现并替换模糊逻辑）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T14:04:10.603

看看强化学习。这里有[一个快速预览](http://www.scholarpedia.org/article/Reinforcement_learning)和[一本书](http://webdocs.cs.ualberta.ca/~sutton/book/ebook/the-book.html)可以帮助你。

根据您的描述，这就是我要使用的:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-13T21:19:39.590

使用 GA 将参数调整为模糊语言变量的想法是一个很好的想法（我希望我能想到它！）；模糊逻辑为您提供了一个很好的连续响应曲线，而 GA 将搜索一个大的解决方案空间。我认为这绝对是一个值得追求的策略；你应该写下你的结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-29T16:46:15.057

如果我是你，我会看看 AIIDE 年度星际争霸大赛，它部分由 AAAI 赞助，因此有一些非常高质量的方法可以解决这个问题。特别是如果您关心资源管理等高级推理等。[星际争霸竞赛网站](http://www.aiide.org/starcraft-competition)此外，竞争对手的源代码都是可用的开源代码，因此如果您想查看其他一些技术，我推荐它。仅供参考，此类问题的大多数顶级竞争对手在历史上都使用过概率状态机[论文的一些变体关于概率 FSM](http://www.inf.ed.ac.uk/teaching/courses/inf1/cl/notes/Comp7.pdf)，因此这可能为参数调整提供了一个很好的测试平台。仅供参考，这也是一些顶级 Game AI 中间件软件用于 Game AI 的方法，例如 XAIT。

# mysql - 如何查询时间是否存储为varchar？

> ID：11471066
> 
> 赞同：1
> 
> 时间：2012-07-13T13:02:15.310
> 
> 标签：mysql, time

时间在数据库中存储为“09:21 am”

现在我怎样才能得到范围结果

例如

```
select * from tablename where stored_time between '09:21 am' and '10:05 pm'; 
```

我尝试了上述查询，但没有正确给出结果。这是因为时间存储为 varchar。

是否有任何函数可以将此字符串转换为时间并在 mysql 中查询？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-13T13:05:21.173

使用[`STR_TO_DATE()`](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_str-to-date)以下格式：

```
SELECT STR_TO_DATE(UPPER('09:21 am'), '%h:%i %p');
/* 09:21:00 */ 
```

`%h`= 小时 00-12

`%i`= 分钟

`%p`= AM/PM（`UPPER()`转换为大写，以便与您的小写版本匹配）

所以完整的查询：

```
SELECT * 
FROM tablename 
WHERE 
  /* Use 24h time for the comparison values and wrap stored_time in the STR_TO_DATE() */
  STR_TO_DATE(UPPER(stored_time)) between '09:21:00' and '22:05:00'; 
```

建议您将此列切换为实数`TIME`或`DATETIME`类型，而不是将值存储为字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T13:09:29.473

你可以利用`DATE_FORMAT(date,format)`. [文档](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_date-format)

```
select * from tablename where DATE_FORMAT(stored_time,'%h:%i %p') between 
       DATE_FORMAT('09:21 am','%h:%i %p') and DATE_FORMAT('10:05 pm','%h:%i %p'); 
```

# javascript - JavaScript：获取上传文件的完整路径

> ID：11471068
> 
> 赞同：1
> 
> 时间：2012-07-13T13:02:22.360
> 
> 标签：javascript, asp.net

> **可能重复：**
> [如何解决 C:\fakepath？](https://stackoverflow.com/questions/4851595/how-to-resolve-the-c-fakepath)

我可以使用 JavaScript 获取上传文件的完整路径吗？我试过 asyncfileuploder 但我只得到文件名。如何使用 JavaScript 获取完整路径？另外，如何使用不同的方法获得完整路径？

```
<ContentTemplate>
 <cc1:AsyncFileUpload runat="server" ID="uploadExcelFle" UploaderStyle="Modern"
     ThrobberID="imgLoader" OnClientUploadStarted="uploadClientStarted"/>
 </ContentTemplate>

function uploadClientStarted(sender, args) {
 var fileName = args.get_fileName();
 var fileExt = fileName.substring(fileName.lastIndexOf(".") + 1);
 var filePath = args.get_path();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T14:48:19.033

您将无法获得它，这将是一个很大的安全风险。这是 msdn 所说的：

来源：
[MSDN SRC1](http://msdn.microsoft.com/en-us/library/ms535128%28v=VS.85%29.aspx)
[MSDN SRC2](http://msdn.microsoft.com/en-us/library/ms535263%28v=VS.85%29.aspx)

另一件事是路径仅相对于客户端计算机，一旦文件上传到服务器，它就不再相关。你不能依赖于知道客户端机器的文件结构，因为它可能会在你不知道的情况下发生变化，这会破坏你的代码。

# php - mysql错误'TYPE = MyISAM'

> ID：11471075
> 
> 赞同：51
> 
> 时间：2012-07-13T13:02:45.553
> 
> 标签：php, mysql, syntax-error, myisam

下面的查询我在 Ubuntu 12、MySQL 5.1 版本中执行并收到上述错误：

```
CREATE TABLE mantis_config_table (
    config_id VARCHAR(64) NOT NULL,
    project_id INTEGER NOT NULL DEFAULT 0,
    user_id INTEGER NOT NULL DEFAULT 0,
    access_reqd INTEGER DEFAULT 0,
    type INTEGER DEFAULT 90,
    value LONGTEXT NOT NULL,
    PRIMARY KEY (config_id, project_id, user_id)
) TYPE=MyISAM; 
```

> 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 9 行的 'TYPE=MyISAM' 附近使用正确的语法

任何人都可以提出什么问题吗？

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2012-07-13T13:06:20.013

代替

`TYPE=MyISAM`

和

`ENGINE=MyISAM`

问题是“TYPE=MyISAM”，根据 MySQL 版本更新应该是“ENGINE=MyISAM”——一个简单的搜索/替换就可以解决它。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2012-07-13T13:04:59.790

不要再使用关键字`TYPE`了。改为使用`ENGINE`。

> TYPE 关键字已被贬低（从 5.0 开始）并且在 MySQL5.5 中不支持

```
CREATE TABLE mantis_config_table 
( 
   ...   
) 
ENGINE = MyISAM;
^^^^^^--------------------- HERE 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2012-07-13T13:04:34.750

在较新的 MySQL 版本中：

```
ENGINE=MyISAM 
```

这里是教程[（MySQL）](http://dev.mysql.com/doc/refman/5.0/en/myisam-storage-engine.html)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-07-13T13:06:52.083

使用 ENGINE 而不是 TYPE

```
ENGINE = MYISAM ; 
```

# mysql - 如何更改 MySQL 错误日志文件格式

> ID：11471079
> 
> 赞同：5
> 
> 时间：2012-07-13T13:03:06.597
> 
> 标签：mysql, linux, logging, format

我正在运行共享托管 LAMP 服务器。我有几个客户使用相同的 CMS 软件，它使用 MySQL 作为后端数据库。`/var/log/mysqld.log`关于文件，我收到 145 错误`mod_statistics.MYI`：

> 120713 8:53:22 [错误] /usr/libexec/mysqld：无法打开文件：'mod_statistics.MYI'（错误号：145）

我知道如何修复 145 错误：这不是问题。但是，找到正确`mod_statistics.MYI`的方法对我来说是个问题，因为这台服务器上有很多客户拥有自己的这张表的副本。

我的问题：如何修改 MySQL 日志格式以将此文件的完整路径添加到日志输出中？我真的很讨厌必须通过*每个*加载此表的客户来查看它是否已损坏。

我已经用 Google 搜索并阅读了 MySQL 日志文件文档，其中没有讨论更改文件格式。

谢谢你！

瑞安

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T15:55:00.773

似乎无法格式化 MySQL 错误日志。

一种可能的解决方案是在启动服务器时使用 MyISAM 自动恢复模式：http: [//dev.mysql.com/doc/refman/5.1/en/server-options.html#option_mysqld_myisam-recover](http://dev.mysql.com/doc/refman/5.1/en/server-options.html#option_mysqld_myisam-recover)。该描述听起来像是提供了有关它正在处理的表的更多信息。

它可能有助于找到桌子，它可能会为您修复它。

# javascript - JQuery Cycle Plugin - 可变/调整高度

> ID：11471080
> 
> 赞同：0
> 
> 时间：2012-07-13T13:03:07.597
> 
> 标签：javascript, jquery, jquery-plugins, cycle, jquery-cycle

我一直在尝试重新创建类似于[http://www.brianrea.com/Progress-drawings](http://www.brianrea.com/Progress-drawings)上使用的循环插件的东西。

我基本上需要分页并要求容器根据图像的高度调整大小/调整其高度，并带有平滑的动画。宽度是静态的。

尝试查看插件的文档，但它不是很具体，并且没有关于此功能的演示（我可以找到）。

谁能指出我正确的方向？

我现在有一些东西，比如：

```
$('#feature').cycle({ 
    fx:     'scrollHorz', 
    prev:   '#previous', 
    next:   '#next',
    width:   660,
    after:   onAfter, 
    timeout: 0 
});

function onAfter(curr, next, opts) {
    var index = opts.currSlide;
    $('#previous')[index == 0 ? 'hide' : 'show']();
    $('#next')[index == opts.slideCount - 1 ? 'hide' : 'show']();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T14:11:14.083

我认为您可以使用`before`回调函数和一点 css-transition 魔术来做到这一点：

[http://jsfiddle.net/vPJCv/2/](http://jsfiddle.net/vPJCv/2/)

**HTML**

```
<a href="#" id="prev">&larr;</a>
<a href="#" id="next">&rarr;</a>

<div id="slideshow">
 <img src="http://flickholdr.com/500/200/sea,sun/1">
 <img src="http://flickholdr.com/500/400/sea,sun/2">
 <img src="http://flickholdr.com/500/500/sea,sun/3">
 <img src="http://flickholdr.com/500/300/sea,sun/4">
 <img src="http://flickholdr.com/500/400/sea,sun/5">
</div>​ 
```

**JS**

```
$(document).ready(function(){

    $('#slideshow').cycle({
        before : function(currSlideElement, nextSlideElement){
          $('#slideshow').css('height', $(nextSlideElement).height()+'px');
        },
        timeout : 0,
        prev : $('a#prev'),
        next : $('a#next')
    });

}); 
```

**CSS**

```
#slideshow{
  border-bottom: 2px solid #000;
  padding: 10px;
  -webkit-transition: all .2s ease;
     -moz-transition: all .2s ease;
          transition: all .2s ease;
}​ 
```

# ruby - 将 send 与接受块的方法一起使用

> ID：11471085
> 
> 赞同：2
> 
> 时间：2012-07-13T13:03:26.967
> 
> 标签：ruby

我正在尝试在 ruby​​ 中完成这一元编程

```
my_array = 1..10
method = :each

my_array.send(method) {|num| puts num } 
```

这是行不通的。有人知道如何动态传递块吗？我已经尝试过：

```
my_array.send(:each, lambda{|num| puts num })
my_array.send(:each, Proc.new{|num| puts num }) 
```

但没有任何效果。谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-13T13:07:09.617

您的第一个片段非常好，这应该可以工作：

```
(1..10).send(:each) { |num| puts(num) } 
```

# image-processing - 我需要运动模糊算法

> ID：11471087
> 
> 赞同：1
> 
> 时间：2012-07-13T13:03:30.803
> 
> 标签：image-processing, gimp

我需要一个小型图像编辑应用程序的运动模糊算法。你能给我一些资源、书籍或论文或者代码示例吗？

GIMP 使用哪些资源来进行此数学运算？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T13:09:57.857

好吧，Gimp Blur-Motion 的源代码就[在这里](http://git.gnome.org/browse/gimp/tree/plug-ins/common/blur-motion.c?id=GIMP_2_8_0)。

# android - Openfire：我如何知道存储在服务器中的哪些用户是我的设备联系人？

> ID：11471088
> 
> 赞同：1
> 
> 时间：2012-07-13T13:03:35.170
> 
> 标签：android, openfire, asmack

我正在为 Android 开发一个简单的聊天。我正在阅读有关 Openfire ante asmack API 的信息。显然，用户应该只看到存储在他的设备中的联系人，所以：我如何知道存储在服务器中的哪些联系人是我的设备联系人？或者，我如何将他在设备中的联系人分配给联系人？我已经看到它可以在管理控制台中完成，但是通过代码？这是我开始开发它所需要知道的最后一件事。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T13:13:50.340

尝试这个：

```
// Create the configuration for this new connection
ConnectionConfiguration config = new ConnectionConfiguration("jabber.org", 5222);
config.setCompressionEnabled(true);
config.setSASLAuthenticationEnabled(true);

Connection connection = new XMPPConnection(config);
// Connect to the server
connection.connect();
// Log into the server
connection.login("danilodeveloper", "password", "SomeResource");
// getting the Openfire contacts that danilodeveloper has
Roster roster = connection.getRoster();
// the contacts
Collection<RosterEntry> entries = roster.getEntries(); 
```

使用条目（例如 entrie.getUser()），您可以将 Openfire 联系人与设备联系人进行比较。

干杯

# php - php无法访问数据库

> ID：11471090
> 
> 赞同：0
> 
> 时间：2012-07-13T13:03:41.357
> 
> 标签：php

我正在使用以下脚本来附加序列化数组

```
mysql_select_db("formdemo", $con);

    $result=mysql_query("select * from rohit where fid='$y'");
    if(mysql_num_rows($result)!=0)
    {
        if($result)
        {
            while($row=mysql_fetch_array($result))
            {
                $n=$row['tags'];

                $a=explode(',', $n);
                print_r($a);
                $cnt=count($a);
                $x=unserialize($row['data']);
                for($i=0;$i<$cnt;$i++)
                {
                    $d=$_GET[$a[$i]];
                    array_push($x,$d);
                }
                array_push($x,"<br/>");
            }
        }
    }
    $str=serialize($x);
    $sql="update rohit set data='$str' where fid='$y'";
    if(!mysql_query($sql,$con))
        die(mysql_error());
    else
        echo "Your data has been updated successfully\n"; 
```

当我第一次在数据库为空时运行它时，它会给出一个错误：array_push() 期望参数 1 是数组，并在数据库中存储一个值 b;0。在这种情况下我该怎么办。请帮忙...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T13:13:41.343

`$x`最简单的解决方案是在开始处理之前使用数组初始化变量。**[但请在这里](https://stackoverflow.com/questions/11471090/unable-to-access-database-in-php#comment15144997_11471090)**查看我的评论

# iphone - aurioTouch2 录音问题。我需要将数据从一个 AudioBufferList 添加到另一个

> ID：11471094
> 
> 赞同：-1
> 
> 时间：2012-07-13T13:03:53.550
> 
> 标签：iphone, ios, audio, avaudioplayer, audio-streaming

我调查[了 aurioTouch2](http://developer.apple.com/library/ios/#samplecode/aurioTouch2/Introduction/Intro.html)示例代码。但我想将所有内容记录在文件中。aurioTouch 不提供这种可能性。我尝试在`FFTBufferManager.cpp`in 中使用此代码记录数据`void FFTBufferManager::GrabAudioData(AudioBufferList *inBL)`

```
ExtAudioFileRef cafFile;
AudioStreamBasicDescription cafDesc;

cafDesc.mBitsPerChannel = 16;
cafDesc.mBytesPerFrame = 4;
cafDesc.mBytesPerPacket = 4;
cafDesc.mChannelsPerFrame = 2;
cafDesc.mFormatFlags = 0;
cafDesc.mFormatID = 'ima4';
cafDesc.mFramesPerPacket = 1;
cafDesc.mReserved = 0;
cafDesc.mSampleRate = 44100;

CFStringRef refH;
refH = CFStringCreateWithCString(kCFAllocatorDefault, "/var/mobile/Applications/BD596ECF-A6F2-41EB-B4CE-3A9644B1C26A/Documents/voice2.caff", kCFStringEncodingUTF8);
CFURLRef destinationURL = CFURLCreateWithFileSystemPath(kCFAllocatorDefault, 
                                                        refH, 
                                                        kCFURLPOSIXPathStyle, 
                                                        false);
OSType status = ExtAudioFileCreateWithURL(
                                          destinationURL,                    // inURL
                                          'caff',                     // inFileType
                                          &cafDesc,                   // inStreamDesc
                                          NULL,                       // inChannelLayout
                                          kAudioFileFlags_EraseFile,  // inFlags
                                          &cafFile                    // outExtAudioFile
                                          );    // returns 0xFFFFFFCE
ExtAudioFileWrite(cafFile, mNumberFrames, inBL); 
```

这很好用，但我使用`AudioBufferList *inBL`，这只是所有音频数据的一小部分（大约 1 秒）。此函数每 1 秒调用一次，以分析来自麦克风的新音频数据。因此，如果我可以将数据从一个 AudioBufferList 添加到另一个 AudioBufferList，那就太好了。

或者可能有人知道其他方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T09:06:02.093

您应该设置新的 AudioUnit 来录制音频（使用它自己的回调函数）。

```
 OSStatus status;

    // Describe audio component
    AudioComponentDescription desc;
    desc.componentType = kAudioUnitType_Output;
    desc.componentSubType = kAudioUnitSubType_RemoteIO;
    desc.componentFlags = 0;
    desc.componentFlagsMask = 0;
    desc.componentManufacturer = kAudioUnitManufacturer_Apple;

    // Get component
    AudioComponent inputComponent = AudioComponentFindNext(NULL, &desc);

    // Get audio units
    status = AudioComponentInstanceNew(inputComponent, &mAudioUnit);

    // Enable IO for recording
    UInt32 flag = 1;
    status = AudioUnitSetProperty(mAudioUnit,
                                  kAudioOutputUnitProperty_EnableIO,
                                  kAudioUnitScope_Input,
                                  kInputBus,
                                  &flag,
                                  sizeof(flag));

    // Enable IO for playback
    status = AudioUnitSetProperty(mAudioUnit,
                                  kAudioOutputUnitProperty_EnableIO,
                                  kAudioUnitScope_Output,
                                  kOutputBus,
                                  &flag,
                                  sizeof(flag));

    // Describe format
    AudioStreamBasicDescription audioFormat={0};
    audioFormat.mSampleRate         = kSampleRate;
    audioFormat.mFormatID           = kAudioFormatLinearPCM;
    audioFormat.mFormatFlags        = kAudioFormatFlagIsSignedInteger | kAudioFormatFlagIsPacked;
    audioFormat.mFramesPerPacket    = 1;
    audioFormat.mChannelsPerFrame   = 1;
    audioFormat.mBitsPerChannel     = 16;
    audioFormat.mBytesPerPacket     = 2;
    audioFormat.mBytesPerFrame      = 2;

    // Apply format
    status = AudioUnitSetProperty(mAudioUnit,
                                  kAudioUnitProperty_StreamFormat,
                                  kAudioUnitScope_Output,
                                  kInputBus,
                                  &audioFormat,
                                  sizeof(audioFormat));
    status = AudioUnitSetProperty(mAudioUnit,
                                  kAudioUnitProperty_StreamFormat,
                                  kAudioUnitScope_Input,
                                  kOutputBus,
                                  &audioFormat,
                                  sizeof(audioFormat));

    // Set input callback
    AURenderCallbackStruct callbackStruct;
    callbackStruct.inputProc = recordingCallback;
    callbackStruct.inputProcRefCon = (__bridge void *)self;

    status = AudioUnitSetProperty(mAudioUnit,
                                  kAudioOutputUnitProperty_SetInputCallback,
                                  kAudioUnitScope_Global,
                                  kInputBus,
                                  &callbackStruct,
                                  sizeof(callbackStruct));

    // Disable buffer allocation for the recorder (optional - do this if we want to pass in our own)
    flag = 0;
    status = AudioUnitSetProperty(mAudioUnit,
                                  kAudioUnitProperty_ShouldAllocateBuffer,
                                  kAudioUnitScope_Output,
                                  kInputBus,
                                  &flag,
                                  sizeof(flag));

    // On initialise le fichier audio
    NSArray  *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *documentsDirectory = [paths objectAtIndex:0];
    NSString *destinationFilePath = [[NSString alloc] initWithFormat: @"%@/output.caf", documentsDirectory];
    NSLog(@">>> %@\n", destinationFilePath);

    CFURLRef destinationURL = CFURLCreateWithFileSystemPath(kCFAllocatorDefault, (__bridge CFStringRef)destinationFilePath, kCFURLPOSIXPathStyle, false);

    OSStatus setupErr = ExtAudioFileCreateWithURL(destinationURL, kAudioFileCAFType, &audioFormat, NULL, kAudioFileFlags_EraseFile, &mAudioFileRef);  
    CFRelease(destinationURL);
    NSAssert(setupErr == noErr, @"Couldn't create file for writing");

    setupErr = ExtAudioFileSetProperty(mAudioFileRef, kExtAudioFileProperty_ClientDataFormat, sizeof(AudioStreamBasicDescription), &audioFormat);
    NSAssert(setupErr == noErr, @"Couldn't create file for format");

    setupErr =  ExtAudioFileWriteAsync(mAudioFileRef, 0, NULL);
    NSAssert(setupErr == noErr, @"Couldn't initialize write buffers for audio file");

    CheckError(AudioUnitInitialize(mAudioUnit), "AudioUnitInitialize");
    CheckError(AudioOutputUnitStart(mAudioUnit), "AudioOutputUnitStart"); 
```

# mysql - IOS开发：创建用户账号的游戏应用

> ID：11471096
> 
> 赞同：0
> 
> 时间：2012-07-13T13:04:10.927
> 
> 标签：mysql, sqlite, facebook-ios-sdk, ios

我正在寻找创建一个游戏应用程序，并且已经完成了很多视频教程并阅读了很多关于 IOS 的书籍。

我想了解更多有关游戏应用程序的技术和常见做法的信息。我不想使用 GK/Game Center 设置游戏。理想情况下，我希望用户可以选择输入一些基本字段，如用户名/密码或使用 Facebook 登录以创建用户帐户。

游戏将是点对点的，由一个用户完成传送给另一个用户的动作来玩，反之亦然。

我查看了 Facebook SDK 和 Hackbook 示例应用程序，这部分都很好。

我想知道是否有人可以为创建用户帐户的应用程序提供更多信息、视频教程、电子书和/或示例代码。他们使用什么方法来为多人游戏创建这些，然后如何根据创建和玩游戏的多个用户来管理这些，这些是如何可扩展的等等。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T13:11:06.290

您需要有一个服务器来存储用户帐户和游戏数据。如果您不想自己创建服务器，我建议您使用后端即服务平台。我在 Parse [https://www.parse.com/上运气不错](https://www.parse.com/)

他们有一些用于用户帐户和 Facebook 集成的示例和 SDK 功能。那应该让你开始。您的游戏数据将保存在一个与 NSDictionary 非常相似的对象中，您可以将其保存在他们的服务器上。

如果您想要不同的提供商，只需搜索“后端即服务”

# php - 使用关键标识符 PHP 从 foreach 循环输出正确的结果

> ID：11471099
> 
> 赞同：0
> 
> 时间：2012-07-13T13:04:18.360
> 
> 标签：php, loops, foreach, key

我有这个数组

```
 array(1) { [0]=> array(5)
           { ["ppc_acc_name"]=> string(9)  "Test test"      
             ["ppc_acc_username"]=> string(4) "ttes" 
             ["ppc_acc_password"]=> string(3) "tes" 
             ["ppc_acc_answer"]=> string(3) "trt"
             ["ppc_acc_link_client"]=> string(1) "3" } } 
```

我试图通过 foreach 循环访问数组中的值。我想使用密钥字符串标识符，这样我就可以控制循环输出的格式。问题是它不允许我在我的 foreach 循环中使用键字符串标识符。

此循环输出正确的 Test test ttes tes trt 3

```
 <?php foreach ($ppcAccDetails as $details): ?>

    <?php foreach ($details as $detail): ?>

        <?php echo $detail." "; ?>

    <? endforeach; ?>

<? endforeach; ?> 
```

但我想使用键 $detail['ppc_acc_name'] 结果只输出第一个字符。

结果不正确：T ttt 3

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T13:08:27.417

你有一个嵌套数组。只需执行此操作即可访问单个项目：

```
echo $ppcAccDetails[0]['ppc_acc_name']; 
```

在`foreach`循环上下文中，您将这样做，并摆脱内部`foreach`循环。

```
<?php foreach ($ppcAccDetails as $details): ?>
     <?php echo $details['ppc_acc_name']; ?>
<? endforeach; ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T13:09:02.907

看看 php 中的[substr()](http://www.php.net/manual/en/function.substr.php)函数，它应该做你想做的。

# php - 如何在没有js的magento中结帐？

> ID：11471102
> 
> 赞同：1
> 
> 时间：2012-07-13T13:04:33.307
> 
> 标签：php, javascript, magento, checkout

在magento的单页结帐页面上可以在没有js的情况下结帐，因为所有流程都是通过ajax调用完成的，所以是否有任何可行性从结帐中删除js？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T13:09:55.540

另一种方法是禁用单**页结帐**。

然后你有正常的方式。

**System->Configuration**，点击**SALES**下的**Checkout**你会发现**Checkout Options**

 ****但我认为大多数人都有 JS 并激活。****

# javascript - BackboneJS 从初始加载中捕获事件 OnAdd

> ID：11471106
> 
> 赞同：0
> 
> 时间：2012-07-13T13:04:52.473
> 
> 标签：javascript, backbone.js, backbone-events, backbone-relational

我在不使用 fectch() 的情况下创建一个集合，但 JSON 数据已经可用。

```
this.displays = new Displays(jQuery.parseJSON($('#temp_json').html())); 
```

我需要为该集合的每个模型设置一个“位置”值设置，这应该是该模型在此集合中的位置。

我想要做的是捕捉一个事件，在初始加载中，每个模型都是从 JSON 构造并添加到集合中的。

然后我会做类似的事情：

```
theModel.set('position', this.length); 
```

不幸的是，我找不到应该将我的收藏绑定到的事件。此集合的模型还包含其他集合（...），应该做同样的事情。

这可能看起来很奇怪，但我必须这样做，因为我认为稍后我将执行以下操作：

```
var prototypeNames = [this.model.get('display').get('position'), this.model.get('position')]; 
```

希望这足够清楚。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T14:33:46.007

-function`Collection.add`触发`add`-event，您可以使用 -function 收听该事件`on`。该事件将添加的模型和一个选项对象作为参数传递，该对象包含一些有用的属性（例如添加模型的索引）。（[这里的文档](http://backbonejs.org/#Collection-add)）

所以你会做这样的事情：

```
collection.on('add', function(model, options) {
  model.set('position', options.index); 
}); 
```

如果您想了解有关`add`-event 传递的参数的更多信息，只需记录它们，因为现有文档充其量是很少的。

```
collection.on('add', function(model, options) {
  console.log(options); 
}); 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T11:45:40.460

对我有用的解决方案：

我使用了**主干**关系，这在处理实际模型关系时非常棒。我正在听“relational:add”，它在构建集合时为集合的每个项目触发。

然后我在我的项目上设置一些值并触发一个新事件'postAdd'，可以从我的视图中收听。

```
window.Displays  = Backbone.Collection.extend({
    model: Display,
    initialize: function(data, options){
        this.on("relational:add", function(relModel){
            relModel.set('pos',this.indexOf(relModel));
            this.trigger('postAdd', relModel);
        }, this);
    },

}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T14:30:57.797

您可以覆盖集合的默认“添加”实现以触发不会被 Backbone 静音的自定义事件。

```
var MyCollection = Backbone.Collection.extend({

  // Override the default 'add' implementation...
  add: function( models, options ) {

    // Call the default implementation first...
    Backbone.Collection.prototype.add.apply( this, arguments );

    // Fire our custom events on the models...
    while (model = models.shift()) {
      model.trigger('customAdd', model, this, options);
    }

    return this;
  }

}); 
```

您现在可以收听模型上触发的“customAdd”事件。当silent = true时，这个事件总是会被触发。

因此，当添加一个带有 {silent: false} 的项目时，将触发两个事件：'add' 和 'customAdd'。

我已经使用这种技术在初始加载新集合并创建所有模型时触发事件。由于将在创建模型之前调用初始化方法，因此我需要覆盖“重置”函数以在创建模型时触发我的代码执行。

# android - Sqlite 打印

> ID：11471108
> 
> 赞同：1
> 
> 时间：2012-07-13T13:04:58.587
> 
> 标签：android, database, sqlite

嗨，我有一个 SQLite 数据库，并将其放在我的资产文件夹中。我想知道如何从屏幕上的表格中“打印”信息。我环顾四周，我能找到的只是人们添加到数据库中，我想做的就是在屏幕上显示它并稍后添加一些过滤器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T13:18:35.097

我认为这可能会有所帮助。

1.  从 SQLIte 数据库中检索数据并将它们存储在 String / Strings 中。
2.  在你的 xml 中引入一些 TextViews 到你的布局中。
3.  在您的 java 代码中获取对那些 textview / textviews 的引用。
4.  textview.settext(-----检索到的字符串------);

这将打印您从 SQLite 数据库中检索到的任何字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T13:20:33.853

```
SQLiteDatabase database;

public int getId() {
    String sqlQuery = "SELECT * FROM <table_name>;

    int id = 0;

    Cursor cursor = database.rawQuery(sqlQuery, null);

    if (cursor.moveToFirst()) {
        id = cursor.getInt(0);  // In my case, id (int) is in first column 
    }

    return id;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T13:16:27.300

大致应该是这样的：

```
private static String DB_PATH = "/data/data/com.your.app/your_path/yourdb.sqlite";

private static SQLiteDatabase myDataBase;

public static void openDatabase() {

    String queryString="YOUR SQL QUERY HERE";

    myDataBase = SQLiteDatabase.openDatabase(DB_PATH, null,SQLiteDatabase.OPEN_READONLY);

    Cursor cursor = myDataBase.rawQuery(queryString, null);

    if(cursor!=null) {

        cursor.moveToFirst();

        while(!cursor.isLast()) {
             /*CHECK CURSOR USAGE AND DO SOMETHING WITH YOUR RESULTS HERE */
             cursor.moveToNext();
        } 
     }
     myDataBase.close();
} 
```

# sql - 不确定 SQL 查询试图做什么

> ID：11471118
> 
> 赞同：0
> 
> 时间：2012-07-13T13:05:34.590
> 
> 标签：sql, sql-server

我正在处理一些继承的代码，并且其中的 SQL 查询存在问题。查询如下。

```
Select distinct 
    g.scriptid,
    g.procedurename,
    h.parameters,
    g.scriptname,
    h.usercode,
    h.facility,
    h.recid,
    cast((cast(recid as varchar) + '.' +  Right('0000' + cast(scriptgennum as varchar), 4)) as decimal(10,4)) as 'scriptrecid',
    scriptgennum+1 as 'scriptgennum',
    h.generated,
    h.runinterval,
    case 
        when runinterval = 'M' then dateadd(month,1,convert(varchar(10),h.nextrundate,120)) 
        when runinterval = 'Q' then dateadd(month,3,convert(varchar(10),h.nextrundate,120)) 
        when runinterval = 'W' then dateadd(week,1,convert(varchar(10),h.nextrundate,120))  
        when runinterval = '0' then NULL end as 'nextrundate',
    convert(varchar(10),getdate(),120) as currentrundate,
    scripttype

    from PATIENTLETTERS_SCRIPTHIST h join PATIENTLETTERS_SCRIPTS g on
        g.scriptid = h.scriptid where 
        h.status = 'Y' 
        and (([runinterval] = 'M'
            and (convert(varchar(10),nextrundate,120) = convert(varchar(10),getdate(),120)
            and datepart(day,getdate()) = 5
            and (datediff(month,convert(varchar(10),h.lastrundate,120),convert(varchar(10),getdate(),120)) = 1)
            or lastrundate is null))
        or ([runinterval] = 'Q'
            and (convert(varchar(10),nextrundate,120) = convert(varchar(10),getdate(),120)
            and datepart(weekday,getdate()) = 0
            and (datediff(month,convert(varchar(10),h.lastrundate,120),convert(varchar(10),getdate(),120)) = 3)
            or lastrundate is null))
        or ([runinterval] = 'W'
            and (convert(varchar(10),nextrundate,120) = convert(varchar(10),getdate(),120)
            and datepart(day,getdate()) = 5
            and (datediff(week,convert(varchar(10),h.lastrundate,120),convert(varchar(10),getdate(),120)) = 1)
            or lastrundate is null)) 
        or ([runinterval] = 'O'
            and (convert(varchar(10),nextrundate,120) = convert(varchar(10),getdate(),120)
            and (datepart(weekday,getdate()) = 0))
            or lastrundate is null)) 
```

我知道它正在尝试选择从`PATIENTLETTERS_SCRIPTHIST`和中列出的特定列`PATIENTLETTERS_SCRIPTS`。让我感到困惑的查询部分是这样的行：

```
 and (([runinterval] = 'M'
            and (convert(varchar(10),nextrundate,120) = convert(varchar(10),getdate(),120)
            and datepart(day,getdate()) = 5
            and (datediff(month,convert(varchar(10),h.lastrundate,120),convert(varchar(10),getdate(),120)) = 1) 
```

如果有人可以解释这些行实际上在做什么，我将不胜感激任何帮助。我可以看到它想要确保运行间隔为“M”，并且看起来它试图将当前日期与存储在第 4 行的数据库中的日期相匹配，但第 2 行和第 3 行是仍然是一个完整的谜。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T13:15:54.697

查找设置为**每月**运行的项目，其中下一个运行日期是**今天**，今天是每月**5号，并且距离项目****上次运行**正好一个月。

*   [有关转换](http://msdn.microsoft.com/en-us/library/ms187928.aspx)的更多信息
*   和[日期部分](http://msdn.microsoft.com/en-us/library/ms174420.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T13:14:10.560

此代码正在寻找具有`runinterval = 'M'`

```
line 1 - [runinterval] = 'M' 
```

并且`nextrundate`等于当前日期 ( `getdate()`)，日期将被[转换](http://anubhavg.wordpress.com/2009/06/11/how-to-format-datetime-date-in-sql-server-2005/)为具有相同格式的 varchar。

```
line 2 - and (convert(varchar(10),nextrundate,120) = convert(varchar(10),getdate(),120) 
```

并且当前日期的一天等于 5。这意味着日期必须是 6 月 5 日、7 月 5 日等

```
line 3 - and datepart(day,getdate()) = 5 
```

`lastrundate`和当前日期 ( )的月份之差`getdate()`等于 1

```
line 4 - (datediff(month,convert(varchar(10),h.lastrundate,120),convert(varchar(10),getdate(),120)) = 1) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-13T13:16:38.997

第二行使用样式 120（[此处有更多详细信息](http://msdn.microsoft.com/en-us/library/ms187928.aspx)`nextrundate`）将当前日期转换为“YYYY-MM-DD”格式，然后检查它们是否相同，因此只有今天所在的行。`nextrundate`

第三行只是检查今天是一个月的第 5 天。例如： `SELECT DATEPART(DAY, '2012-07-05')`返回 5。

# playframework-1.x - 在 weblogic 中部署时，在 play framework 1.2.5 中使用 getter 和 setter 时出现 NoSuchMethodException

> ID：11471119
> 
> 赞同：0
> 
> 时间：2012-07-13T13:05:39.697
> 
> 标签：playframework-1.x, nosuchmethoderror

我正在为我的应用程序使用播放框架。它在开发模式下正常工作，但在生产模式下给我一个错误

```
Execution exception (In /app/helper/FinansHelper.java around line 189)
NoSuchMethodException occured : finansServis.helper.KayitliIslemDto.getIpcMemo() 
```

我怎么解决这个问题？

编辑：我的 KayitliIslemDto 类

```
public class KayitliIslemDto {
    public IPCMemo ipcMemo;
    public TahsilatMemoOut tahsilatMemoOut;
    public HesabaHavaleMemoOut hesabaHavaleMemoOut;
    public IsmeHavaleMemoOut ismeHavaleMemoOut;

    public KayitliIslemDto(IPCMemo ipcMemo, IsmeHavaleMemoOut ismeHavaleMemoOut) {
        this.ipcMemo = ipcMemo;
        this.ismeHavaleMemoOut = ismeHavaleMemoOut;
    }

    public KayitliIslemDto(IPCMemo ipcMemo, HesabaHavaleMemoOut hesabaHavaleMemoOut) {
        this.ipcMemo = ipcMemo;
        this.hesabaHavaleMemoOut = hesabaHavaleMemoOut;
    }

    public KayitliIslemDto(IPCMemo ipcMemo, TahsilatMemoOut tahsilatMemoOut) {
        this.ipcMemo = ipcMemo;
        this.tahsilatMemoOut = tahsilatMemoOut;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T12:19:51.917

我对 Play Framework 也有类似的问题。您的 JVM 语言环境很可能是土耳其语。方法名称中的“I”有时会被您使用的 JVM 转换为“İ”。

我通过设置JVM系统参数解决了这个问题：

```
play run ExampleProject -Duser.language=en -Duser.country=TR -Duser.variant=TR 
```

我希望它也对你有用。

# android - Android - 如果 WiFi 已经在 AP 模式下运行，则获取 IP

> ID：11471121
> 
> 赞同：2
> 
> 时间：2012-07-13T13:05:47.050
> 
> 标签：android, wifi

我想解决下一个问题。我的设备处于 AP 模式（便携式 WiFi 热点）。`It has to show IP of it`. 另一台设备使用已知 IP 连接到该设备。它必须在没有任何 WiFi 路由器的情况下工作，只是设备到设备。如果无线电已经在 AP 模式下运行，如何获取 IP 地址？我有一些关于 AP 的代码：

```
public boolean setWifiApEnabled(WifiConfiguration config, boolean enabled) {         
       try {
        if (enabled) { // disable WiFi in any case
         mWifiManager.setWifiEnabled(false);
        }

        Method method = mWifiManager.getClass().getMethod(
          "setWifiApEnabled", WifiConfiguration.class,
          boolean.class);
        return (Boolean) method.invoke(mWifiManager, config, enabled);
       } catch (Exception e) {
        //Log.e(TAG, "", e);
        return false;
       }
      }

public int getWifiApState() {
       try {
        Method method = mWifiManager.getClass().getMethod(
          "getWifiApState");
        return (Integer) method.invoke(mWifiManager);
       } catch (Exception e) {
        //Log.e(TAG, "", e);
        return WIFI_AP_STATE_FAILED;
       }
      }

 public static boolean IsWifiApEnabled(Context context){ 
          boolean isWifiAPEnabled = false;        
          WifiManager wifi = (WifiManager) context.getSystemService(Context.WIFI_SERVICE);
          Method[] wmMethods = wifi.getClass().getDeclaredMethods();
          for(Method method: wmMethods){
              if(method.getName().equals("isWifiApEnabled")) {  
                  try {
                    isWifiAPEnabled = (Boolean) method.invoke(wifi);
                  } catch (IllegalArgumentException e) {
                    e.printStackTrace();
                  } catch (IllegalAccessException e) {
                    e.printStackTrace();
                  } catch (InvocationTargetException e) {
                    e.printStackTrace();
                  }
              }
          }
          return isWifiAPEnabled;
      }
 } 
```

也许有一些技巧可以获取它的IP？请帮我。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-12-03T15:45:29.920

我用它来确定IP地址：

```
 private String determineHostAddress() {
        try {
            for (Enumeration<NetworkInterface> nis = NetworkInterface.getNetworkInterfaces(); nis.hasMoreElements(); ) {
                NetworkInterface ni = nis.nextElement();
                if (!ni.isLoopback() && !ni.isVirtual() && ni.isUp() && !ni.isPointToPoint() && ni.getHardwareAddress() != null) {
                    for (Enumeration<InetAddress> ips = ni.getInetAddresses(); ips.hasMoreElements(); ) {
                        InetAddress ip = ips.nextElement();
                        if (ip.getAddress().length == 4) {
                            return ip.getHostAddress();
                        }
                    }
                }
            }
        } catch (Exception ignored) {}
        return null;
    } 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-12-05T18:15:39.133

这可能不适用于您的情况，但在我的应用程序中，我计划显示热点的 IP 地址，以便我可以在连接到热点的另一台 Android 设备上输入它，以连接到在热点上运行的网络服务器。在这种情况下，客户端（连接到热点的设备）可以在连接到热点后简单地查询它所连接的网关的 IP 地址。这将始终是热点的 IP 地址。这是我的代码：

```
@SuppressWarnings("deprecation") // Deprecated because it doesn't handle IPv6 but wifimanager only supports IPV4 anyway
private String getGateway()
{
    final WifiManager wifiManager = (WifiManager) getContext().getSystemService(Context.WIFI_SERVICE);
    DhcpInfo dhcpInfo = wifiManager.getDhcpInfo();
    return Formatter.formatIpAddress(dhcpInfo.gateway);
} 
```

顺便说一句，到目前为止，在我测试过的每个 Android 上，热点的 IP 地址始终是 192.168.43.1。根据[这个问题](https://stackoverflow.com/questions/17302220/android-get-ip-address-of-a-hotspot-providing-device)，它在 Android 源代码中是硬编码的。

# c - RGB888 到 RGB565 / 位移

> ID：11471122
> 
> 赞同：11
> 
> 时间：2012-07-13T13:05:49.440
> 
> 标签：c, bit-manipulation, rgb

我想使用位移将三个字符组合成一个简短的字符。这是为了实现 RGB565 调色板（红色有 5 位，绿色有 6 位，蓝色有 5 位）。

这是我的示例程序，我只是在中间错过了一步，我认为我需要做一些安定。

```
#include <stdio.h>

int main( ){
        unsigned char r, g, b;
        unsigned short rgb;

        r = 255;        // 0xFF 1111 1111
        g = 100;        // 0x64 0110 0100
        b = 50;         // 0x32 0011 0010

        r = r >> 3;     // 0x31 0001 1111
        g = g >> 2;     // 0x19 0001 1001
        b = b >> 3;     // 0x06 0000 0110

        //r = r & something; //
        //g = g & something; //
        //b = b & something; //

        // Desired result:
        //          R      G     B
        // 0xFB26 11111 011001 00110
        rgb = r | g | b;

        printf( "r 0x%x g 0x%x b 0x%x, rgb 0x%08x\n", r, g, b, rgb );
} 
```

你可以在最后看到我想要的结果。谢谢您的帮助！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-13T13:23:17.450

```
rgb = ((r & 0b11111000) << 8) | ((g & 0b11111100) << 3) | (b >> 3); 
```

我们左移`r`11 位，`g`左移 5 位，然后按位或将它们`b`右移 3 位。（注意：这假设值已经被正确屏蔽，如果需要，以删除任何不需要的位。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-08-23T19:15:42.837

感谢A2A。我也遇到过同样的问题。下面的代码会帮助你。

```
unsigned int r,g,b; // Pixel data in the RGB
unsigned char x1,x2; // The container for resulting 2 bytes

x1 = (r & 0xF8) | (g >> 5); // Take 5 bits of Red component and 3 bits of G component

x2 = ((g & 0x1C) << 3) | (b  >> 3); // Take remaining 3 Bits of G component and 5 bits of Blue component 
```

您可以在 GIThub 中找到 python 程序。 [https://github.com/ajay126z/RGB888ToRGB565-转换器](https://github.com/ajay126z/RGB888ToRGB565-Converter)

# c# - 不能序列化对象类型 System.Double[,]？

> ID：11471123
> 
> 赞同：1
> 
> 时间：2012-07-13T13:05:51.470
> 
> 标签：c#, asp.net

你好，我终于完成了我的网络服务和客户端，它在客户端工作正常但是当我尝试从我的网络浏览器访问服务器时，我收到错误无法序列化对象类型 System.Double[,] 不支持多维数组。我认为这是由于我的 webmethod 返回了一个多维数组，我怎么需要返回这个数组，有人帮助尝试解决这个错误或如何解决它注意：我使用 C#，asp.net。IIS，写在记事本里，不使用visual studio

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-13T13:09:32.250

将您的数据重新编码为`double[][]`

这是一种方法：

```
public static T[][] ConvertToJaggedArray<T>(T [,] multiArray)
{
  int numOfColumns=multiArray.GetLength(0);
  int numOfRows=multiArray.GetLength(1);
  T[][] jaggedArray = new T[numOfColumns][];

  for (int c = 0; c < numOfColumns; c++)
  {
      jaggedArray[c] = new T[numOfRows];
      for (int r = 0; r < numOfRows; r++)
      {
          jaggedArray[c][r] = multiArray[c, r];
      }
  }

  return jaggedArray;
} 
```

# java - 数组列表 > 没有值

> ID：11471125
> 
> 赞同：-1
> 
> 时间：2012-07-13T13:05:59.520
> 
> 标签：java, json, string, arraylist, hashmap

我`ArrayList<HashMap<String, String>> songslist`的没有价值。在我的`doInBackground`方法中，我有应该填充这个 ArrayList 的 for 循环。字符串“id”、“interpret”……也有值。问题出在哪里？这里的代码：

```
JSONArray charts = json.getJSONArray(TAG_CHARTS);

                // looping through All Products
                for(int i=0;i<charts.length();i++) {
                    JSONObject json_data = charts.getJSONObject(i);

                    String id = json_data.getString(TAG_ID);
                    String interpret = json_data.getString(TAG_INTERPRET);
                    String titel = json_data.getString(TAG_TITEL);
                    String album = json_data.getString(TAG_ALBUM);
                    String albumcover = json_data.getString(TAG_ALBUMCOVER);
                    String likes = json_data.getString(TAG_LIKES);

                    HashMap<String, String> map = new HashMap<String, String>();

                    map.put(TAG_ID, id);
                    map.put(TAG_INTERPRET, interpret);
                    map.put(TAG_TITEL, titel);
                    map.put(TAG_ALBUM, album);
                    map.put(TAG_ALBUMCOVER, albumcover);
                    map.put(TAG_LIKES, likes);       

                    songslist.add(map);

                } 
```

但列表是空的。JSONArray 包含这些值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T13:10:24.823

创建地图并将元素放入列表的代码是可以的。所以它要么

1）`songslist`搞砸了。您没有显示它在哪里/如何创建
2）您认为其中`charts`有项目，但事实并非如此。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-13T13:45:27.553

你没有进入循环。您发布的代码可以。图表长度（） == 0

# c++ - 不确定何时在 C++ 中使用异常

> ID：11471126
> 
> 赞同：7
> 
> 时间：2012-07-13T13:06:01.283
> 
> 标签：c++, exception

在用 C++ 编写科学软件多年后，我似乎仍然无法习惯异常，也不知道什么时候应该使用它们。我知道使用它们来控制程序流是一个很大的禁忌，但除此之外......考虑以下示例（摘自表示图像蒙版并让用户将区域添加为多边形的类）：

```
class ImageMask
{
public:
    ImageMask() {}
    ImageMask(const Size2DI &imgSize);

    void addPolygon(const PolygonI &polygon);

protected:
    Size2DI imgSize_;
    std::vector<PolygonI> polygons_;
}; 
```

此类的默认构造函数创建一个无用的实例，具有未定义的图像大小。我不希望用户能够将多边形添加到这样的对象。但我不确定如何处理这种情况。当大小未定义并调用 addPolygon() 时，我应该：

1.  默默归来，
2.  assert(imgSize_.valid) 使用此类检测代码中的违规行为并在发布前修复它们，
3.  抛出异常？

大多数情况下，我选择 1) 或 2)（取决于我的心情），因为在我看来，对于这样一个简单的场景来说，例外是昂贵的、混乱的并且简直是矫枉过正。请问有什么见解吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-13T13:15:46.477

一般规则是当您无法执行所需的操作时抛出异常。因此，在您的情况下，是的，当调用 addPolygon 并且大小未定义或不一致时抛出异常确实有意义。

默默地回来几乎总是错误的事情。`assert`不是一种好的错误处理技术（它更像是一种设计/文档技术）。

但是，在您的情况下，重新设计界面以使错误条件不可能或不可能发生可能会更好。例如，像这样：

```
class ImageMask
{
public:
    // Constructor requires collection of polygons and size.
    // Neither can be changed after construction.
    ImageMask(std::vector<PolygonI>& polygons, size_t size);
} 
```

或者像这样

```
class ImageMask
{
public:
    class Builder
    {
    public:
        Builder();
        void addPolygon();
    };

    ImageMask(const Builder& builder);
}

// used like this
ImageMask::Builder builder;
builder.addPolygon(polyA);
builder.addPolygon(polyB);
ImageMask mask(builder); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-13T13:28:31.313

我会尽量避免任何可能创建处于某种无用状态的数据的情况。如果您需要一个不为空的多边形，那么不要创建空多边形，这样可以省去很多麻烦，因为编译器会强制要求没有空多边形。

我从不使用静默返回，因为它们隐藏了错误，这使得查找错误比必须的要复杂得多。

当我检测到程序处于它只能处于的状态时，我会使用断言，如果软件中存在错误的话。在您的示例中，如果您签入采用 Size2DI 的 c'tor，则该大小不为空，而不是断言存储的大小不为空，这对于检测错误很有用。断言不应该有副作用，并且必须可以在不改变软件行为的情况下删除它们。我发现它们非常有用，可以找到我自己的错误并记录对象/函数的当前状态等。

如果很有可能运行时错误将由函数的调用者直接处理，我会使用常规的返回值。如果很有可能，这种错误情况必须通过调用堆栈上的多个函数调用来传达，我更喜欢异常。有疑问我提供两个功能。

亲切的问候托尔斯滕

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-13T13:22:10.223

对我来说，1 是没有选择的。是 2 还是 3 取决于您的程序/库的设计，您是否考虑（和记录）默认构造图像掩码，然后添加多边形是组件的有效或无效使用。这是一个重要的设计决策。我推荐阅读Matthew Wilson 的[这篇文章](http://www.synesis.com.au/publishing/quality-matters/exceptions-the-worst-form-of-error-handling-apart-from-all-the-others.html)。

请注意，您有更多选择：

*   发明自己的断言，始终调用 std::terminate 并进行额外的日志记录
*   禁用默认构造函数（正如其他人已经指出的那样）——这是我最喜欢的

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-13T13:30:36.227

1.  “悄悄回来”——这是真正的“大禁忌”。程序应该知道出了什么问题。
2.  "assert" - 第二条规则是仅当正常程序的流程无法恢复时才使用断言。
3.  “抛出异常” - 是的，这是正确且良好的技术。只需注意异常安全。[GotW](http://www.gotw.ca/gotw/index.htm)上有很多关于异常安全编码的文章。

不要害怕例外。他们不咬人。:) 如果您能充分掌握这项技术，您将成为一名出色的编码员。;)

# c# - 在 Outlook 加载项中抓取当前选定的文件夹

> ID：11471129
> 
> 赞同：2
> 
> 时间：2012-07-13T13:06:09.993
> 
> 标签：c#, outlook, outlook-addin

我正在开发一个 Outlook 加载项，它可以以两种方式之一工作，具体取决于用户的选择 - 它可以处理选定的电子邮件，或者处理选定文件夹中的所有电子邮件。我已经完成了第一部分的工作，但是第二部分给我带来了麻烦，可能是因为我只是错误地调整了第一部分的代码。我相信问题归结为在 C# Outlook 加载项中正确获取当前选定的文件夹。顺便说一句，我正在使用 .NET 3.5 和 Outlook 2007。

首先，电子邮件代码 - 如果用户在收件箱中选择一封或多封电子邮件，并使用“选定的电子邮件”选项运行我的加载项，则运行以下代码（并且工作正常！）：

```
public static void processSelectedEmails(Outlook.Explorer explorer)
{
    //Run through every selected email
    for (int i = 1; i <= explorer.Selection.Count; i++)
    //alternatively, foreach (Object selectedObject in explorer.Selection)
    {
        Object selectedObject = explorer.Selection[i];
    if (!(selectedObject is Outlook.Folder))
        {
                string errorMessage = "At least one of the items you have selected is not an email.";
                //Code for displaying the error
                return;
        }
        else
        Outlook.MailItem email = (selectedObject as Outlook.MailItem);
        //Do something with current email
    }
} 
```

如果用户转到 Outlook 中的导航窗格（默认情况下在左侧），选择文件夹或子文件夹（可能是收件箱、已发送邮件或他们创建的其他文件夹），我已尝试调整此代码以执行其他操作. 然后，用户可以在我的加载项中选择“处理选定文件夹”选项，这与上面的代码基本相同，但处理选定文件夹内的所有电子邮件。我已将其设置为仅在用户选择了单个文件夹时才起作用。

```
public static void processFolder(Outlook.Explorer explorer)
{
    //Assuming they have selected only one item
    if (explorer.Selection.Count == 1)
    {
        //Make sure that that selected item is a folder
        Object selectedObject = explorer.Selection[1];
        if (!(selectedObject is Outlook.Folder))
        {
            string errorMessage = "The item you have selected is not a folder.";
            //Code for displaying the error
            return;
        }

        //Code for running through every email in that folder
    }
} 
```

我还没有编写代码来实际运行所选文件夹中的所有电子邮件，因为我的代码永远不会超过`if (!(selectedObject is Outlook.Folder))`. 即使最近选择的项目是您的收件箱，我也会收到我当时编程的错误。也许我在滥用 explorer.Selection 的东西？任何帮助将非常感激。

这对于回答我的问题可能很重要 - 加载项有一个名为“explorer”的字段，它是在启动时生成的：`explorer = this.Application.ActiveExplorer`. 这是传递给我的函数的“资源管理器”，以便他们知道选择了什么。正如我所说，这适用于选定的电子邮件，但不适用于选定的文件夹。任何见解将不胜感激！

**编辑 1：**看来这个问题基本上是[Get all mails in Outlook from a specific folder](https://stackoverflow.com/questions/5660332/get-all-mails-in-outlook-from-a-specific-folder)的副本，但它没有答案。

**编辑2：**我一直在做进一步的研究，看来我可以通过创建一个弹出窗口来使用该`Application.Session.PickFolder()`方法选择一个文件夹来获得几乎相同的功能（但不幸的是还有一个额外的步骤）。有没有办法根据当前选择的文件夹来做，而不是强迫用户选择一个新文件夹？

**编辑 3：**我修改了此处的代码：http: [//msdn.microsoft.com/en-us/library/ms268994](http://msdn.microsoft.com/en-us/library/ms268994(v=vs.80).aspx) (v=vs.80).aspx以进一步显示对我来说不能正常工作的内容：

```
 public static void processFolder(Outlook.Explorer explorer)
    {
        string message;
        if (explorer.Selection.Count > 0)
        {
            Object selObject = explorer.Selection[1];
            if (selObject is Outlook.MailItem)
            {
                message = "The item is an e-mail";
            }
            else if (selObject is Outlook.Folder)
            {
                message = "The item is a folder";
            }
            else
            {
                message = "No idea what the item is!";
            }

            Console.WriteLine(Message);
            return;
        }
    } 
```

无论我选择一条消息，还是转到导航窗格并选择一个文件夹，我都会收到消息“此项目是一封电子邮件”。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-13T13:50:26.693

[`Explorer.Selection`](http://msdn.microsoft.com/en-us/library/ff861267.aspx)仅适用于[`Items`](http://msdn.microsoft.com/en-us/library/ff868001)（*MailItem、AppointmentItem 等*）- 不适用[`Folders`](http://msdn.microsoft.com/en-us/library/ff863890)。要访问当前选定的`Folder`，您需要[`Explorer.CurrentFolder`](http://msdn.microsoft.com/en-us/library/ff866719).

[`Folder.Items`](http://msdn.microsoft.com/en-us/library/ff864247)将为您提供对`Items`给定`Folder`.

# tags - 删除 alfresco 中的最后一个标签

> ID：11471135
> 
> 赞同：1
> 
> 时间：2012-07-13T13:06:24.510
> 
> 标签：tags, alfresco

我有一个奇怪的问题：

我无法从 Alfresco 的文档库中删除最后一个标签。

例子：

文档库有 3 个项目，A、B、C。

A 有标签 T1 和 T2。B 有标签 T2 和 T3。C只有T3。

侧边栏标签列表：T1、T2、T3

我删除T3，新状态是：

A 有 T1 和 T2 B 有 T2 C 没有标签

侧边栏标签列表：T1、T2

我删除T2，然后：

A 有 T1 B 没有标签 C 没有标签

侧边栏标签列表：T1

现在是奇怪的部分 - 我现在删除 T1：

A 没有标签 B 没有标签 C 没有标签

侧边栏标签列表：T1

所以，侧边栏仍然有 T1。（？！）我尝试再次删除它，我收到回复说该标签不再存在。

我试图：

1.  重新开始露天
2.  删除 webapps/alfresco、webapps/share、work/Catalina/alfresco 和 work/Catalina/share 文件夹
3.  使用 index.recovery.mode=FULL 重建 solr 索引
4.  通过删除所有文件夹手动重建 solr 索引
5.  从所有内容模型中删除 cm:taggable 方面并再次执行 1、2、3 和 4

标签只是留在边栏中，盯着我，恶毒地笑着，嘲笑我无法删除它。

无论多么微不足道，这对我来说都是一个严重的问题。关于下一步做什么的任何建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T13:41:20.247

您应该升级 - 它看起来像是自您使用的版本以来已修复的错误。

我刚刚在 v4.1（最新的 svn checkout 版本）上尝试了您描述的确切步骤。当我删除 T1 并刷新文档库时，T1 从侧边栏标签列表中消失，文档 A 不再列出它。正如您所期望的那样，它也不再出现在标签管理器中。

我建议您尝试使用 4.0.2，希望它会在其中得到修复。如果没有，请与支持人员聊天（您已订阅企业版，因此​​他们会为您提供帮助！），希望他们能够准确追踪修复的时间并帮助您获得包含修复的版本它。

# python - 从一对一迁移到一对多时如何执行数据迁移

> ID：11471137
> 
> 赞同：4
> 
> 时间：2012-07-13T13:06:31.350
> 
> 标签：python, django, django-models, django-south

我`south`用来管理迁移，我遇到了一个角落。基本上我有以下设置：

**应用程序1**：

```
class A(models.Model):
  # bunch of attributes 
```

**应用程序2**：

```
class B(models.Models):
  instance_a = models.OneToOneField(A, null=True, blank=True, 
                                    editable=False) 
```

现在，我想从这个到这个：

**应用程序1**：

```
class A(models.Model):
  instance_b = models.ForeignKey(B, null=True, blank=True) 
```

**应用程序2**：

```
class B(models.Models):
  # other attributes 
```

我的主要问题是我不能丢失数据。因此，基本上在迁移结束时，之前映射到对象 B 的所有对象 A 都应该保留该映射。例如，如果将 id 为 7 的对象 A 映射到 id 为 8 的对象 B，则在此过程结束时应保留此映射。

我尝试了从模式迁移与临时占位符和数据迁移混合的几件事。但是，我最终总是在同一个地方，即在执行数据迁移时，我不再具有以前的关系以访问正确的属性。例如，B.instance_a 不再可用。

我想听听你对两件事的看法：

*   首先，仅使用南迁移是否可行。
*   其次，我该如何进行。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-20T20:38:10.210

终于过了一段时间，我得到了一个`django-south`可能对其他人有帮助的程序。关键在于南的`depends_on`功能（http://south.aeracode.org/wiki/Dependencies）。我分 4 步完成：

**首先**：

*   为 model 中的外键值创建一个占位符`A`。

所以模型`A`变为：

```
class A(models.Model):
    instance_b_placeholder = models.ForeignKey(A, null=True, blank=True) 
```

现在只要运行`manage.py schemamigration app1 --auto`。

**第二**

*   创建一个数据迁移，以便我们可以复制这些值。目标是在数据库中复制数据，然后重命名属性并删除旧属性。问题`manage.py datamigration app1 update_fields`。我选择将数据迁移保留在`app1`. 如果您不这样做，请确保它在上次迁移之后运行。

这是编码的数据迁移：

```
# Forwards:

for b in orm['app2.B'].objects.filter(instance_b__isnull=False):
        b.instance_a.instance_b_placeholder = b
        b.instance_a.save()

# Backwards:

for r in orm['app1.A'].objects.filter(instance_b_placeholder__isnull=False):
        r.instance_b_placeholder.instance_a = r
        r.instance_b_placeholder.save() 
```

**第三**：

*   `instance_b`从模型中删除字段，`B`并确保在上一步中创建的迁移之后运行迁移。

模型`B`变为：

```
class B(models.Model):
     # etc... 
```

发出`manage.py schemamigration app2 --auto`并编辑迁移，将先前的迁移添加到`depends_on`：

```
depends_on = (
    ("app1", "<migration_number>_update_fields"),
) 
```

**第四步**：

*   重命名占位符。这是通过更改代码中的名称并编辑迁移来实现的。编辑是必要的，因为`south`往往会删除和添加新列，但我们只希望它重命名该列。

*   这个迁移应该在最后一个地方运行，所以我让它依赖于前一个。

这是代码：

```
depends_on = (
    ("app2", "<previous_migration_here>"),
)

# Forwards:

    db.rename_column('app1_a', 'instance_b_placeholder_id', 'instance_b_id')

# Backwards:

    db.rename_column('app1_a', 'instance_b_id', 'instance_b_placeholder_id') 
```

就是这样了。我不知道是否还有很多其他方法可以做到这一点，但至少这对我有所帮助。

# php - 通过查询字符串的动态 PHP 内容

> ID：11471142
> 
> 赞同：0
> 
> 时间：2012-07-13T13:06:53.600
> 
> 标签：php, arrays, string, dynamic

我想使用一对查询字符串来生成特定的页面内容

查询字符串示例：example.co.uk/index.php?brand=apple&video=red

我已经设法使用一些简单的 PHP 将 div id 替换为查询品牌，并提供了一些帮助，如下所示：

```
<?php 
$recognised_brands = array( 
  "apple", 
  "orange", 
  // etc 
); 

$default_brand = $recognised_brands[0]; // use first from list arbitrarily. 

$brand_to_use = isset($_GET['brand']) && in_array($_GET['brand'], $recognised_brands) 
  ? $_GET['brand'] 
  : $default_brand; 

echo '<div id="' . $brand_to_use . '"></div>';  
?> 
```

但是，我不确定如何对名为 video 的第二个查询执行类似操作。

例如，如果他们查询的是 ?brand=apple&video=red

然后我想将页面代码中的视频变量替换为红色的正确数字，但我不知道如何根据视频查询添加这些变量的列表，例如：red => 1，然后将 1 回显到正确的区域？

同样基于所选的视频，我希望更改部分标题文本及其下方的一段代码，但也不确定在哪里最好指定此内容：

尝试澄清：

我对品牌查询进行了排序，我需要让我的视频查询填充多个区域标题、视频 ID 和内容 div，但不知道如何！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T13:13:30.903

如果我正确理解了您的问题，这将满足您的要求：

```
$videoToNum = array("red" => 1, 
                    "blue" => 2, 
                    "yellow" => 3);

$videoValue = ((isset($_GET['video']) && isset($videoToNum[$_GET['video']])) ? $videoToNum[$_GET['video']] : null);

if($videoValue) {
    echo '<div id="' . $videoValue . '"></div>';  
} 
```

不过，这个问题相当模糊，因此如果这没有帮助，您可能需要进一步详细说明。

**编辑：**这是评论中讨论的开关示例：

```
$video = (isset($_GET['video']) ? $_GET['video'] : null);

if($video) {
    switch($video) {
        case "red":
            //do red stuff
            break;
        case "blue":
            //do blue stuff
            break;
        case "yellow":
            //do yellow stuff
            break;
    }
} 
```

# java - 在 android webview 中阻止视频 - 替代 shouldInterceptRequest()

> ID：11471143
> 
> 赞同：2
> 
> 时间：2012-07-13T13:06:56.870
> 
> 标签：java, android, webview

我在 android 中使用 webview 创建了一个 web 浏览器。我的目标是在加载之前控制 webview 的内容。每当 webview 的内容向任何域服务器发出请求时，它都必须通过[shouInterceptRequest()](http://developer.android.com/reference/android/webkit/WebViewClient.html#shouldInterceptRequest%28android.webkit.WebView,%20java.lang.String%29)。如果该 url 指向任何视频上传站点（youtube.com、vimeo.com），我可以将其更改为某个 Access Denied url，以便不会加载视频。

```
 @Override
    public WebResourceResponse shouldInterceptRequest(final WebView view, String url) {
        try { 
            if (access.permission(url)) {
                return super.shouldInterceptRequest(view, url);
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
        return getResponseData();
    }

    private WebResourceResponse getResponseData() {
        try {
            String str = "Access Denied";
            InputStream data = new ByteArrayInputStream(str.getBytes("UTF-8"));
            return new WebResourceResponse("text/css", "UTF-8", data);
        } catch (IOException e) {
            return null;
        }
    } 
```

但[shouInterceptRequest()](http://developer.android.com/reference/android/webkit/WebViewClient.html#shouldInterceptRequest%28android.webkit.WebView,%20java.lang.String%29)可从 API 11 中获得。我需​​要它从 API 8 中工作。

有没有其他方法可以实现它？如果在加载任何数据之前指向任何视频上传网站，我需要阻止该 url。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T15:22:11.043

如何使用[http://developer.android.com/reference/android/webkit/WebViewClient.html#shouldOverrideUrlLoading(android.webkit.WebView](http://developer.android.com/reference/android/webkit/WebViewClient.html#shouldOverrideUrlLoading(android.webkit.WebView) , java.lang.String) 事件？

您可以阻止 url，然后调用[http://developer.android.com/reference/android/webkit/WebView.html#loadUrl(java.lang.String](http://developer.android.com/reference/android/webkit/WebView.html#loadUrl(java.lang.String) ) 来显示您想要的任何内容（甚至使用“ javascript:do_something()" 符号）

# php - PHP Ajax：PHP 算法实况报道

> ID：11471144
> 
> 赞同：0
> 
> 时间：2012-07-13T13:07:03.690
> 
> 标签：php, ajax

如果我在文件**test.php**中有下一个算法：

```
for ($i = 0; $i < 1000; ++$i)
{
     //Operations...
     ALERT_TO_MAIN_PAGE($i);
} 
```

我用 AJAX 从页面**main.html**调用**test.php**

 **如何`$i`使用实时值跟踪 , 的进度？

所以**main.html**会像这样显示，在 PHP 文件完成一次迭代的时候：

```
Done 0.
Done 1.
Done 2.
... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T13:11:59.927

您可以尝试使用[HTML5 Server Sent Events](http://www.html5rocks.com/en/tutorials/eventsource/basics/)将类似的消息发送到浏览器。

马上离开[网站](http://www.html5rocks.com/en/tutorials/eventsource/basics/#toc-server-code)：

```
<?php
header('Content-Type: text/event-stream');
header('Cache-Control: no-cache'); // recommended to prevent caching of event data.

/**
 * Constructs the SSE data format and flushes that data to the client.
 *
 * @param string $id Timestamp/id of this connection.
 * @param string $msg Line of text that should be transmitted.
 */
function sendMsg($id, $msg) {
  echo "id: $id" . PHP_EOL;
  echo "data: $msg" . PHP_EOL;
  echo PHP_EOL;
  ob_flush();
  flush();
}

$serverTime = time();

sendMsg($serverTime, 'server time: ' . date("h:i:s", time())); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T13:10:00.517

你不能这样做，因为ajax在php端等待操作完成。

您应该离线运行您的php（在后台）并使用ajax 来简单地询问状态（即从会话中读取有关进度的信息）。**

# javascript - css 未应用于使用 jQuery .append() 创建的 html 元素

> ID：11471151
> 
> 赞同：0
> 
> 时间：2012-07-13T13:07:46.840
> 
> 标签：javascript, jquery, html, css, append

所以我知道这可能是可怕的编程实践，但我有点时间紧迫，基本上我的代码中有一个标签，点击屏幕上的一个按钮后，我试图附加一堆该div内的代码。但是，我注意到了两件事。一，我的其他 javascript 崩溃，除非附加的代码都在一行上，二，即使我已经分配了类，我的 css 样式表也没有应用于代码。以下是相关代码：

```
 $("#results").append("<ul class='sdt_menu'>");
            for(i=0; i < progression[max].length;i++)
            {
                $("#results").append(
            "<li><a href='#'><img src='images/youAreHere.jpg' alt=''/><span class='sdt_active'></span><span class='sdt_wrap'><span class='sdt_link'>"+progression[max][i]+"</span><span class='sdt_descr'>hover to view description</span></span></a><div class='sdt_box'>"+jobs[progression[max][i]]['description']+"</div></li>");
            }

            $("#results").append("</ul>"); 
```

任何帮助揭开这个神秘面纱将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T13:13:23.590

当你追加时，你应该追加一个完整的、完整的、封闭的标签集。它不像字符串生成器那样工作。试试类似的东西：

```
var tag = '<ul class="sdt_menu">';
for(var i = 0; i < progression[max].length; i++) {
    tag += '...all of your other list items';
tag += "</ul>";

$(tag).appendTo("#results"); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-13T13:16:44.917

在您当前的代码中，一旦您添加`<ul>`它，它就会被浏览器自动关闭（因为在 DOM 中不可能有未关闭的标签），然后您`<li>`也被添加到其中`#results`。或者至少，如果拥有`<li>`a 的孩子是合法的，他们会是`<div>`。

相反，您需要将`<li>`元素附加到`<ul>`，而不是`#results`：

```
var $ul = $("<ul class='sdt_menu'>");
for (i = 0; i < progression[max].length; i++) {
    $ul.append(...);
}
$ul.appendTo('#results'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-13T13:16:59.730

尝试这个：

```
 var tag = [];
 var ic=0;
 tag[++ic] = '<ul class="sdt_menu">';
 for(var i = 0; i < progression[max].length; i++) {
     tag += '...all of your other list items';
 }
 tag[++ic] = "</ul>";

 $("#results").append(tag.join('')); 
```

# android - 如何添加 标记安卓清单

> ID：11471153
> 
> 赞同：2
> 
> 时间：2012-07-13T13:07:47.873
> 
> 标签：android, coronasdk

如何`<supports-screens>`从文件 build.settings 在 android 清单中添加标签？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T22:01:18.913

你需要使用apktool打开Corona APK，然后编辑manifest，然后重新打包...

[关于如何摆弄 apktool 和 Corona 有一个很好的教程](http://www.ludicroussoftware.com/blog/2012/05/08/remove-unused-libraries-from-corona-apps/)

不幸的是，本教程似乎只适用于最高 840 的构建，最新的构建不适用于它...

# java - 无法执行多个撤消操作

> ID：11471155
> 
> 赞同：0
> 
> 时间：2012-07-13T13:07:55.883
> 
> 标签：java, undo

我正在尝试让我的第一个 UndoManager 工作，但我遇到了原型问题。我不明白为什么下面的代码只提供一个撤消。

当我更改文本时，单击撤消并再次更改文本，另一个撤消不会做任何事情。问题在哪里？

```
import java.awt.*;
import javax.swing.*;

public class IComeUndone
{
    public static void main(String[] args)
    {
        JFrame f = new JFrame();
        f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        final JTextArea textArea = new JTextArea(20, 40);
        textArea.setText("Back here");
        f.add(textArea);
        final UndoManager undoManager = new UndoManager();
        textArea.getDocument().addUndoableEditListener(undoManager);
        undoManager.setLimit(1000);
        JButton undoB = new JButton("Undo");
        undoB.addActionListener(new ActionListener()
        {
            @Override
            public void actionPerformed(ActionEvent e)
            {
                undoManager.end();
                if(undoManager.canUndo())
                {
                    undoManager.undo();
                }
                textArea.requestFocus();
            }
        });
        f.add(undoB, BorderLayout.PAGE_END);
        f.pack();
        f.setVisible(true);
    }
} 
```

*更新：当我注释掉该`undoManager.end();`行时，它工作正常，但每次单击**撤消**只会撤消一次编辑，就像一个键入的字母。我想撤消一组单一的编辑，以便`undoManager.end();`在这一点上有意义。但是在第一次单击撤消后，我无法重新开始跟踪单个编辑。（希望你能理解）*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T21:06:42.323

有趣的是，似乎一旦您调用 end()，它就会将 UndoManager 转换为 CompoundEdit，然后您需要做更多的工作。以下链接为例：[http ://tips4java.wordpress.com/2008/10/27/compound-undo-manager/](http://tips4java.wordpress.com/2008/10/27/compound-undo-manager/)

# python - string[i:length] 给出内存错误

> ID：11471158
> 
> 赞同：0
> 
> 时间：2012-07-13T13:08:10.590
> 
> 标签：python, python-2.7

```
def suffix(stng):
    list = []
    length = len(stng)
    for i in range(length):
         x = stng[i:length]   ## This gives a Memory Error..See below
         list.append(x)
    return list 
```

这段代码是我在 interviewstreet.com 上解决问题的一部分，但是当我提交它时，我得到一个内存错误...我想知道如何纠正它？

这是回溯：

```
Original exception was:
Traceback (most recent call last):
File "/run-1342184337-542152202/solution.py", line 35, in
listofsuffix=suffix(var)
File "/run-1342184337-542152202/solution.py", line 13, in suffix
x=stng[i:length]
MemoryError 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-13T13:12:32.093

A`MemoryError`表示您已经消耗了所有 RAM。您正在创建一个包含原始字符串的所有尾随部分的列表。如果你的原始字符串太长，你会消耗很多内存。

一种可能性是使用生成器一次生成一个后缀，而不是创建所有后缀的列表：

```
def suffixes(stng):
    for i in xrange(len(stng)):
         yield stng[i:] 
```

如果调用者`suffixes`只是简单地迭代结果，您甚至不必更改调用者。如果您确实需要一个明确的列表，那么您将需要一个不同的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T13:37:13.057

“我需要返回一份清单”——这不太可能。您只需要返回一个看起来足够像列表的对象即可使其工作。

```
class FakeList(object):
    def __init__(self,strng):
        self.string=strng
        self._idx=0
    def __getitem__(self,i):
        return self.strng[:i]
    def __len__(self):
        return len(self.string)
    def __iter__(self):
        return self
    def __contains__(self,other):
        return other in self.string
    def next(self):
        if(self._idx<len(self)):
           self._idx+=1
           return self[self._idx-1]
        else:
           raise StopIteration

a=FakeList("My String")
print a[3]
print a[4]
for i in a:
    print i 
```

这将创建一个对象，您可以随机访问并像列表一样进行迭代。它也将允许您调用`len(my_fake_list)`。它不支持切片，还有无数其他的方法，，，……`pop`你需要添加哪些取决于你使用的那些。`append``extend`

# spring - Spring 3.1 表单和列表绑定

> ID：11471159
> 
> 赞同：1
> 
> 时间：2012-07-13T13:08:14.397
> 
> 标签：spring, jsp, spring-mvc

经过搜索和搜索，我还没有找到解决方案。

使用 Spring 3.1

我有一个表单，我希望用户能够添加多个联系人 (poc)。在我的 JSP 中，我有一个用于添加 poc 的提交按钮。它进入 Spring 控制器，从域对象（最初为空）中获取当前的 poc 列表，将 poc 添加到列表中，然后将域对象放回模型中，然后返回相同的视图。然后用户最终将提交整个页面，该页面将转到控制器并将整个对象保存到持久性中。

我尝试了各种尝试并得出了不同的结果，从只能添加一个新的 poc 并覆盖现有的，到无法将输入的 poc 显示在表单上。我将把我目前拥有的代码。

JSP：

```
<form:form method="post" commandName="request">

   ...

   <h2>POC:</h2>
   <input type="text" name="newPoc"/>
   <input type="submit" name="addPoc" value="Add POC"/>

   <table>
        ...
        <c:forEach items="${request.pointOfContacts}" var="poc" varStatus="vs">
             <tr>
                 <td><form:label path="pointOfContacts[${vs.index}].name/></td>
                  .....
        </c:forEach>

        ......

    </table>

</form:form> 
```

弹簧控制器：

```
@RequestMapping(value="/request", method=RequestMethod.POST, param="addPoc")
public Sring addPoc(@RequestParam String newPoc, MyRequest req, Model model) {
   PointOfContact poc = new PointOfContact();
   poc.setName(newPoc);
   List<PointOfContact> pocs = req.getPointOfContacts();
   pocs.add(poc);
   req.setPointOfContacts(pocs);
   model.addAttribute("request", req);
   return "requestForm";
} 
```

领域对象

```
@Entity
public class MyRequest {
   ...

   @OneToMany(Cascade=CascadeType.ALL)
   private List<PointOfContact> pointOfContacts = new ArrayList<PointOfContact>();

   .....
}

@Entity
public class PointOfContact {
   ...

   private String name;

  ....
} 
```

有没有人有任何解决方案？我看过关于 AutoPopulatingList 的各种帖子，这是一个解决方案吗？如果是这样，我将如何在此示例中使用它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-13T14:51:19.363

是的，您应该使用 AutoPopulatingList，[例如](http://blog.richardadamdean.com/?p=12)。这将需要更改 MyRequest 实体。

# c# - 如果由于程序退出/主表单关闭而终止，表单无法正确关闭

> ID：11471168
> 
> 赞同：7
> 
> 时间：2012-07-13T13:09:25.237
> 
> 标签：c#

在名为“Dev”的表单上，我有以下 OnFormClosing 函数，以确保在用户关闭表单时正确关闭线程。

```
protected override void OnFormClosing(FormClosingEventArgs e)
{
    base.OnFormClosing(e);
    dev.stopMultipleColorsWatcher();
} 
```

如果我直接关闭“开发”表单，效果很好。但是如果“Dev”窗体因为主窗体（“Form1”）被关闭（这导致程序退出）而关闭，则`OnFormClosing()`“Dev”中的函数永远不会被调用，所以线程继续运行并且程序的进程需要被任务管理器杀死。

我该如何解决？我意识到我可以`OnFormClosing()`向“Form1”添加一个函数，然后`OnFormClosing()`在“Dev”中调用该函数，但我希望有一些更干净的东西。

**更新：**

从主窗体打开开发窗体：

```
private void btn_opendev_Click(object sender, EventArgs e)
{
    Dev frm = new Dev();
    frm.Show();
} 
```

主窗体实际上称为“programname.UI.Main”（我知道是对的..），它在“Program.cs”中打开（所以程序的入口点）：

```
static void Main()
{
    Application.EnableVisualStyles();
    Application.SetCompatibleTextRenderingDefault(false);
    Application.Run(new programname.UI.Main());
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T13:56:53.117

代替

```
 Dev frm = new Dev();
    frm.Show(); 
```

试试这个

```
 Dev frm = new Dev();
    frm.Show(this); 
```

此方法向子窗体显示所有者，并且所有转到主窗体的事件都应该转到子窗体。

# objective-c - 如何正确使用 NSPopUpButton

> ID：11471172
> 
> 赞同：3
> 
> 时间：2012-07-13T13:09:33.873
> 
> 标签：objective-c, cocoa, nsdictionary, nspopupbutton, nsstringencoding

我有一个 NSPopUpButton，我想用它来选择打开文件的文本编码。

我已经有了一些如何实现它的想法，但是当我开始学习 Objective-C 和 Cocoa 时，我几乎可以肯定有更好的方法来完成我想要的。

我需要一个带有编码名称的 NSString 和一个关联的 NSStringEncoding 值。

我曾想过创建一个表示编码（名称和值）的类，并有一个带有这种类型对象的 NSArray，然后用数组的内容填充 NSPopUpButton，但我认为应该有更好的方法。

我对 NSDictionary 类不是很熟悉，但我怀疑这会让事情变得更容易。

有人可以给我一个提示吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-13T13:21:00.857

创建字典，将编码作为值，将 NSPopUpButton 的名称作为键

```
NSDictionary *dict = [NSDictionary dictionaryWithObjectsAndKeys:
NSNumber numberWithLong:NSASCIIStringEncoding], @"ASCII", 
[NSNumber numberWithLong:NSUnicodeStringEncoding], @"Unicode", nil]; 
```

然后将它们添加到 NSPopUpButton

```
[myPopUpButton addItemsWithTitles:[dict allKeys]] 
```

然后获取用户选择的编码

```
[dict objectForKey:[myPopUpButton titleOfSelectedItem]] 
```

注意：您需要将字符串编码枚举包装在一个对象中，例如 NSValue 或 NSNumber。

# javascript - 如何动态地将函数附加到对象

> ID：11471175
> 
> 赞同：0
> 
> 时间：2012-07-13T13:09:42.163
> 
> 标签：javascript, function, object, dynamic

*`SO`我知道( [1](https://stackoverflow.com/questions/676721/calling-dynamic-function-with-dynamic-parameters-in-javascript) , [2](https://stackoverflow.com/questions/10419538/javascript-dynamic-function-name) , [3](https://stackoverflow.com/questions/9644246/javascript-dynamically-attaching-functions-to-objects) )上已经有一些类似的问题，但不幸的是，我有限的知识`JS`不允许我将这些场景外推到我的个人用例中，因此这个问题。*

我有以下一段代码，它允许我动态附加到对象并从对象调用一些函数，这些函数工作正常（[可在 上找到`JsFiddle`](http://jsfiddle.net/DHPHB/3/)）：

**JavaScript**：

```
$.extend(true, window, {
    "MyPlugin": {
        "dynamicFunction": dummy_function
     }                
});

function dummy_function() {

}

function real_function(string) {
    alert(string);
}

function dynamic_call(function_name, text) {
    MyPlugin["dynamicFunction"] = eval(function_name);
    MyPlugin["dynamicFunction"](text);
}​ 
```

**HTML：**

```
<button onClick="dynamic_call('real_function','some text');">click me</button>​ 
```

**更新：**

有趣的是，我试图复制我遇到的一个问题，即我的函数在本地范围内，但我最后写了一个不是它的例子:)（我告诉过你`JS`不是我的事）。因此，所有`window[function_name]`答案都是正确的，尽管我接受了`James Allardice`'s 因为他推断出我试图解决但没有提出的问题。

**如何在不使用的情况下实现相同的功能`eval`？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T13:13:33.510

全局范围内的函数声明成为 的属性`window`，因此您可以使用方括号语法：

```
function dynamic_call(function_name, text) {
    MyPlugin["dynamicFunction"] = window[function_name];
    MyPlugin["dynamicFunction"](text);
}​ 
```

如果您的函数不在全局范围内，您可以将其设为某个对象的属性值：

```
var myFuncs = {
    real_function: function () {
        alert(string);
    }
}; 
```

然后你可以简单地使用：

```
MyPlugin["dynamicFunction"] = myFuncs[function_name]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-13T13:13:22.520

`eval`如果函数在本地范围内，则无法执行此操作。`eval`如果函数是某个对象的属性，则只能这样做。这包括全局对象，因此可以在没有`eval`.

使用作为某个对象属性的全局函数或函数：

```
MyPlugin["dynamicFunction"] = window[function_name];//window references global object 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-13T13:13:31.873

如果`real_function`是一个全局函数，你只需调用

```
window[function_name](text); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-13T13:13:43.927

我知道这不是确切的问题，但是如果您可以将函数作为参数传入，如下所示：

```
<button onClick="dynamic_call(real_function,'some text');">click me</button>​

function dynamic_call(f, text) {
   MyPlugin["dynamicFunction"] = f;
   MyPlugin["dynamicFunction"](text);
}​ 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-13T13:13:48.153

而不是使用`eval`，`function_name`从`window`对象引用：

```
MyPlugin["dynamicFunction"] = window[function_name]; 
```

# java - 将文件从 HDFS 复制到本地计算机

> ID：11471176
> 
> 赞同：12
> 
> 时间：2012-07-13T13:09:43.880
> 
> 标签：java, hadoop, hdfs

我在尝试将文件从 HDFS 文件系统“下载”到本地系统时遇到问题。（即使相反的操作没有问题）。*注意：文件存在于HDFS文件系统中指定路径

这是一个代码片段：

```
 Configuration conf = new Configuration();
    conf.set("fs.defaultFS", "${NAMENODE_URI}");
    FileSystem hdfsFileSystem = FileSystem.get(conf);

    String result = "";

    Path local = new Path("${SOME_LOCAL_PATH}");
    Path hdfs = new Path("${SOME_HDFS_PATH}");

    String fileName = hdfs.getName();

    if (hdfsFileSystem.exists(hdfs))
    {
        hdfsFileSystem.copyToLocalFile(hdfs, local);
        result = "File " + fileName + " copied to local machine on location: " + localPath;
    }
    else
    {
        result = "File " + fileName + " does not exist on HDFS on location: " + localPath;
    }

    return result; 
```

我得到的例外如下：

```
12/07/13 14:57:46 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Exception in thread "main" java.io.IOException: Cannot run program "cygpath": CreateProcess error=2, The system cannot find the file specified
    at java.lang.ProcessBuilder.start(Unknown Source)
    at org.apache.hadoop.util.Shell.runCommand(Shell.java:206)
    at org.apache.hadoop.util.Shell.run(Shell.java:188)
    at org.apache.hadoop.fs.FileUtil$CygPathCommand.<init>(FileUtil.java:412)
    at org.apache.hadoop.fs.FileUtil.makeShellPath(FileUtil.java:438)
    at org.apache.hadoop.fs.FileUtil.makeShellPath(FileUtil.java:465)
    at org.apache.hadoop.fs.RawLocalFileSystem.execCommand(RawLocalFileSystem.java:573)
    at org.apache.hadoop.fs.RawLocalFileSystem.setPermission(RawLocalFileSystem.java:565)
    at org.apache.hadoop.fs.FilterFileSystem.setPermission(FilterFileSystem.java:403)
    at org.apache.hadoop.fs.ChecksumFileSystem.create(ChecksumFileSystem.java:452)
    at org.apache.hadoop.fs.ChecksumFileSystem.create(ChecksumFileSystem.java:420)
    at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:774)
    at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:755)
    at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:654)
    at org.apache.hadoop.fs.FileUtil.copy(FileUtil.java:259)
    at org.apache.hadoop.fs.FileUtil.copy(FileUtil.java:232)
    at org.apache.hadoop.fs.FileUtil.copy(FileUtil.java:183)
    at org.apache.hadoop.fs.FileSystem.copyToLocalFile(FileSystem.java:1837)
    at org.apache.hadoop.fs.FileSystem.copyToLocalFile(FileSystem.java:1806)
    at org.apache.hadoop.fs.FileSystem.copyToLocalFile(FileSystem.java:1782)
    at com.hmeter.hadoop.hdfs.hdfsoperations.HdfsOperations.fileCopyFromHdfsToLocal(HdfsOperations.java:75)
    at com.hmeter.hadoop.hdfs.hdfsoperations.HdfsOperations.main(HdfsOperations.java:148)
Caused by: java.io.IOException: CreateProcess error=2, The system cannot find the file specified
    at java.lang.ProcessImpl.create(Native Method)
    at java.lang.ProcessImpl.<init>(Unknown Source)
    at java.lang.ProcessImpl.start(Unknown Source)
    ... 22 more 
```

知道可能是什么问题吗？为什么它需要 Cygwin 的 cyqpath？我在 Windows 7 上运行此代码。

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-13T14:52:51.720

尝试从 API 使用此方法：

```
//where delSrc is do you want to delete the source, src and dst you already have and useRawLocalFileSystem should be set to true in your case
hdfsFileSystem.copyToLocalFile(delSrc, src, dst, useRawLocalFileSystem); 
```

在你的情况下更换：

```
hdfsFileSystem.copyToLocalFile(hdfs, local); 
```

和：

```
hdfsFileSystem.copyToLocalFile(false, hdfs, local, true); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-20T03:08:45.193

您可以按照如下所示的代码进行操作：

```
public static void main(String args[]){
    try {
        Configuration conf = new Configuration();
        conf.set("fs.defaultFS", "hdfs://localhost:54310/user/hadoop/");
        FileSystem fs = FileSystem.get(conf);
        FileStatus[] status = fs.listStatus(new Path("hdfsdirectory"));
        for(int i=0;i<status.length;i++){
            System.out.println(status[i].getPath());
            fs.copyToLocalFile(false, status[i].getPath(), new Path("localdir"));
        }
    } catch (IOException e) {
        e.printStackTrace();
    }

} 
```

# java - java.lang.IndexOutOfBoundsException：索引：6，大小：6 JAVA，ARRAY

> ID：11471187
> 
> 赞同：-4
> 
> 时间：2012-07-13T13:10:21.787
> 
> 标签：java, arrays

我意识到这是一个令人难以置信的普遍问题，并且看起来非常非常彻底，但没有运气！看来我遇到了 outOfBounds Exception 问题。我的代码如下 wuth 错误之后！再次感谢 ：）

更新：感谢您的所有快速响应。虽然它说分析面板有问题，但我不知道这是否是原因，因为我有其他类使用它没有问题！但下面是其他代码。再次感谢！

```
public class AnalysisPanel extends JPanel {

private JTextArea overview_text = GuiComponentGenerator.getJTextArea("");

private JTextArea csv_text = GuiComponentGenerator.getJTextArea("");

private JComboBox analyser_choices;

private String[] analyser_class_names;

private LinkedHashMap<String, ImageAnalysis> analyser_outputs = new LinkedHashMap();

private JTextField[] weka_directory_texts;

private JTextField[] weka_tag_texts;

private JTextField weka_output_file_path_text = GuiComponentGenerator
        .getJTextField("");

private JTextField weka_relation_text = GuiComponentGenerator
        .getJTextField("");

public AnalysisPanel() {
    GuiComponentGenerator.setLook(this);
    analyser_class_names = ResourceAndClassDirectories
            .getClassNamesInDirectory(ResourceAndClassDirectories.IMAGE_ANALYSERS_CLASS_STEM);
    ArrayList<String> choices = new ArrayList(
            Arrays.asList(analyser_class_names));
    choices.add(0, "All");
    analyser_choices = GuiComponentGenerator.getJComboBox(choices);
    analyser_choices.addItemListener(new ItemListener() {
        public void itemStateChanged(ItemEvent e) {
            updateTextBoxes();
        }
    });
    setLayout(new BorderLayout());
    add(BorderLayout.NORTH,
            GuiComponentGenerator.getJPanel(analyser_choices));
    add(BorderLayout.CENTER, getTextsPanel());
    add(BorderLayout.SOUTH, getWekaPanel());
}

private JPanel getWekaPanel() {
    JPanel weka_panel = GuiComponentGenerator.getJPanel(new BorderLayout());
    JPanel details_panel = GuiComponentGenerator.getJPanel(new GridLayout(
            6, 1));

    JPanel top_panel = GuiComponentGenerator
            .getJPanel(new GridLayout(1, 2));
    JPanel left_top_panel = GuiComponentGenerator.getJPanel(new BorderLayout());
    JPanel right_top_panel = GuiComponentGenerator.getJPanel(new BorderLayout());
    left_top_panel.add(BorderLayout.WEST, GuiComponentGenerator.getJLabel("Relation:"));
    left_top_panel.add(BorderLayout.CENTER, weka_relation_text);
    right_top_panel.add(BorderLayout.WEST, GuiComponentGenerator.getJLabel("Output to:"));
    right_top_panel.add(BorderLayout.CENTER, weka_output_file_path_text);
    top_panel.add(left_top_panel);
    top_panel.add(right_top_panel);
    weka_panel.add(BorderLayout.NORTH, top_panel);

    weka_directory_texts = new JTextField[5];
    weka_tag_texts = new JTextField[5];

    JPanel labels_panel = GuiComponentGenerator.getJPanel(new GridLayout(1,
            2));
    labels_panel.add(GuiComponentGenerator.getCentreAlignedJLabel("Tag"));
    labels_panel.add(GuiComponentGenerator
            .getCentreAlignedJLabel("Image directory"));
    details_panel.add(labels_panel);
    for (int pos = 0; pos < 5; pos++)
        details_panel.add(getDetailsPanel(pos));

    weka_panel.add(BorderLayout.NORTH, top_panel);
    weka_panel.add(BorderLayout.CENTER, details_panel);
    JPanel weka_bordered_panel = GuiComponentGenerator
            .getLeftBorderedJPanel(weka_panel, "Weka");
    return weka_bordered_panel;
}

private JPanel getDetailsPanel(int pos) {
    JPanel details_panel = GuiComponentGenerator.getJPanel(new GridLayout(
            1, 2));

    final JTextField weka_directory_text = GuiComponentGenerator
            .getJTextField("");
    JTextField weka_tag_text = GuiComponentGenerator.getJTextField("");

    weka_directory_texts[pos] = weka_directory_text;
    weka_tag_texts[pos] = weka_tag_text;

    JPanel right_panel = GuiComponentGenerator
            .getJPanel(new BorderLayout());
    right_panel.add(BorderLayout.CENTER, weka_directory_text);

    JButton choose_directory_button = GuiComponentGenerator
            .getJButton(GuiComponentGenerator.FILE_DIALOG_ICON);
    right_panel.add(BorderLayout.EAST, choose_directory_button);

    choose_directory_button.addActionListener(new ActionListener() {

        public void actionPerformed(ActionEvent arg0) {
            File directory = FileChooserDialog.getFile(
                    ResourceAndClassDirectories.SOURCE_DIRECTORY, "", true);
            if (directory != null)
                weka_directory_text.setText(directory.getPath());
        }
    });

    details_panel.add(weka_tag_text);
    details_panel.add(right_panel);

    return details_panel;
}

public String[] getWekaRunDetails() {
    String[] wrd = { weka_relation_text.getText(),
            weka_output_file_path_text.getText() };
    return wrd;
}

public ArrayList<String[]> getWekaImageDetails() {
    ArrayList<String[]> image_details = new ArrayList();
    for (int pos = 0; pos < 5; pos++) {
        String[] details = { weka_directory_texts[pos].getText(),
                weka_tag_texts[pos].getText() };
        image_details.add(details);
    }
    return image_details;
}

private JPanel getTextsPanel() {
    JPanel texts_panel = GuiComponentGenerator
            .getJPanel(new BorderLayout());
    csv_text.setRows(3);
    csv_text.setFont(new Font("Courier", Font.PLAIN, 14));
    texts_panel.add(BorderLayout.NORTH, GuiComponentGenerator
            .getLeftBorderedJPanel(
                    GuiComponentGenerator.getJScrollPane(csv_text), "CSV"));
    texts_panel.add(BorderLayout.CENTER, GuiComponentGenerator
            .getLeftBorderedJPanel(
                    GuiComponentGenerator.getJScrollPane(overview_text),
                    "Overview"));
    return texts_panel;
}

public String getChosenImageAnalyser() {
    return (String) analyser_choices.getSelectedItem();
}

public void performAnalyses(final TaggedBufferedImage tbi) {
    Thread thread = new Thread() {
        public void run() {
            analyser_outputs.clear();
            String choice = (String) analyser_choices.getSelectedItem();
            csv_text.setText("");
            if (choice.equals("All")) {
                for (String analyser_class_name : analyser_class_names)
                    performAnalysis(analyser_class_name, tbi);
            } else
                performAnalysis(choice, tbi);
            updateTextBoxes();
        }
    };
    thread.start();
}

private void updateTextBoxes() {
    String overview = "";
    String csv_headings = "|";
    String csv_values = "|";
    String choice = (String) analyser_choices.getSelectedItem();
    for (String analyser_class_name : analyser_class_names) {
        if (choice.equals("All") || choice.equals(analyser_class_name)) {
            ImageAnalysis image_analysis = analyser_outputs
                    .get(analyser_class_name);
            if (image_analysis != null) {
                overview += analyser_class_name + "\n\n"
                        + image_analysis.overview + "\n-----------------\n";
                System.out.println("In Analysis Panel: image analsis csv headings " + image_analysis.csv_headings.size());
                for (int pos = 0; pos < image_analysis.csv_headings.size(); pos++) {
                    String heading = image_analysis.csv_headings.get(pos);
                    String value = image_analysis.csv_values.get(pos);
                    while (heading.length() < value.length())
                        heading += " ";
                    while (value.length() < heading.length())
                        value += " ";
                    csv_values += value + "|";
                    csv_headings += heading + "|";
                }
            }
        }
    }
    overview_text.setText(overview);
    csv_text.setText(csv_headings + "\n" + csv_values);
}

private void performAnalysis(String analyser_class_name,
        TaggedBufferedImage tbi) {
    try {
        overview_text.setText("Analysing " + analyser_class_name);
        Class c = Class
                .forName(ResourceAndClassDirectories.IMAGE_ANALYSERS_CLASS_STEM
                        + "." + analyser_class_name);
        ImageAnalyserInterface analyser = (ImageAnalyserInterface) c
                .newInstance();
        ImageAnalysis image_analysis = analyser.analyseImage(tbi);
        analyser_outputs.put(analyser_class_name, image_analysis);
    } catch (Exception ex) {
        ex.printStackTrace();
    }
} 
```

}

更新：现在工作，虽然问题出在下面，但需要在颜色文件本身中进行更改！

谢谢大家:)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-13T13:11:35.487

好吧，根据您尝试访问大小为 6 的数组中的索引 6 的标题。这是不可能的，因为 Java 中的数组从索引 0 运行到大小为 1。

因此，在大小为 6 的数组中，您的最大可能索引为 5。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-13T13:12:29.800

如果数组中有 6 个元素，则索引**5**将是最终索引，因为它是零索引 - 即 0,1,2,3,4,5 是 6 个元素

# jquery - 第一个数组项的大写字母，但仍有小写字母

> ID：11471191
> 
> 赞同：0
> 
> 时间：2012-07-13T13:10:39.987
> 
> 标签：jquery, arrays, uppercase

对不起，我是一名设计师，当我应该坚持使用字体和颜色时，我试图用 jQuery 做一些事情。

所以我正在大写一组单词的第一个字母。我有大写字母，但小写字母仍然跟随它。删除这个小写字母的最佳方法是什么？

我的代码：

```
$("#generatebutt").click(function() {

 var dumpStr = "";
 var numberOfWords = $('#length').val();
 var numberpara = $('#numberpara').val();

for (var i = 0; i < numberpara; i++) {
ShuffleWords(melbArray);

for (var j = 0; j < numberOfWords; j++) {
    var theWords = melbArray[j];                 
    if(j == 0){
        dumpStr += theWords.charAt(0).toUpperCase();
    }
    else {
    }
    if(j % 5 == 1){
        dumpStr += theWords + ", ";
    }
    else {
        dumpStr += theWords + " ";
    }
}
dumpStr = dumpStr.trim();
dumpStr += ".<br/><br/>";
}
$("#dump").html(dumpStr);
}); 
```

​</p>

提前谢谢你！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T13:18:34.423

而不是循环和转换，你可以做类似的事情

```
camelWord = theWords.substring(0,1).toUpperCase()
                     + theWords.substring(1,theWords.length); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T13:16:38.167

您可以为此使用 substring 方法，在您的第一个 if 语句中，当您将单个大写字母添加到 dumpStr 时，您需要从现有字符串中删除这个第一个字符。

```
if(j == 0){
    dumpStr += theWords.charAt(0).toUpperCase();
    theWords = theWords.substring(1)
} 
```

这将简单地删除第一个字符，以便稍后将字符串的其余部分添加到 dumpStr 时，第一个小写字母将不再包含在字符串中。

# android - 通过 Android 3g 连接到服务器并从 phpmyadmin 检索数据

> ID：11471195
> 
> 赞同：1
> 
> 时间：2012-07-13T13:10:52.070
> 
> 标签：android, phpmyadmin, 3g

我想通过 3G 从我的 Android 创建到服务器的连接，但我没有成功。如果Android手机通过wifi连接并且它与我的服务器是同一个wifi，我会成功。你能帮我并给我一段代码吗？

这是我的代码，首先是请求我的数据库的 php：

```
<?php
// on se connecte à notre base  pour recuperer les data
$base = mysql_connect ('localhost', 'root', ''); 
mysql_select_db ('routelibre', $base) ;  
$variable = $_GET['variable'];
$first_token  = strtok($variable, ";;");
$second_token = strtok(";;");
$req =mysql_query("SELECT message from messages where departement='$first_token' AND            voie='$second_token'");
$output=array();
while ($row=mysql_fetch_array($req)) {    
$output[]=$row;    
} 
//on encode en JSON 
print(json_encode($output));
mysql_free_result ($req);  
?> 
```

这是安卓的代码：

```
import java.io.BufferedReader;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.util.ArrayList;
import org.apache.http.HttpEntity;
import org.apache.http.HttpResponse;
import org.apache.http.NameValuePair;
import org.apache.http.client.HttpClient;
import org.apache.http.client.entity.UrlEncodedFormEntity;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.impl.client.DefaultHttpClient;
import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;
import android.app.ListActivity;  
import android.content.Context;
import android.net.ParseException;
import android.os.Bundle;
import android.os.StrictMode;
import android.util.Log;
import android.widget.ArrayAdapter;
import android.widget.Toast;
import android.content.Context;

 public class ConnexionSQL  {
public void ConnexionSQLActivity(){};

public ArrayList<String> ConnexionBD(String dataFromHMI, Context context) {
    String result = null;
    InputStream is = null;
    JSONObject json_data=null;
    ArrayList<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>();
    ArrayList<String> lesMessages = new ArrayList<String>();

    StrictMode.ThreadPolicy policy = new 

            StrictMode.ThreadPolicy.Builder().permitAll().build();

    StrictMode.setThreadPolicy(policy); 

    try{
        //commandes httpClient
        HttpClient httpclient = new DefaultHttpClient();
        HttpPost httppost = new 

                    HttpPost("http://192.168.1.1:80/connexion_mysql.php?variable=" + dataFromHMI);
        httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
        HttpResponse response = httpclient.execute(httppost);
        HttpEntity entity = response.getEntity();
        is = entity.getContent();
    }
    catch(Exception e){
        Log.i("taghttppost",""+e.toString());
        Toast.makeText(context,e.toString() ,Toast.LENGTH_LONG).show();
    }

    //conversion de la réponse en chaine de caractère
    try
    {
        BufferedReader reader = new BufferedReader(new 

        InputStreamReader(is,"UTF-8"));

        StringBuilder sb  = new StringBuilder();

        String line = null;

        while ((line = reader.readLine()) != null) 
        {
            sb.append(line + "\n");
        }

        is.close();

        result = sb.toString();
    }
    catch(Exception e)
    {
        Log.i("tagconvertstr",""+e.toString());
    }
    //recuperation des donnees json
    try{
        JSONArray jArray = new JSONArray(result);

        for(int i=0;i<jArray.length();i++)
        {

            json_data = jArray.getJSONObject(i);
            lesMessages.add(json_data.getString("message"));
            //r.add(json_data.getString("categorie"));

        }
    }
    catch(JSONException e){
        Log.i("tagjsonexp",""+e.toString());
    } catch (ParseException e) {
        Log.i("tagjsonpars",""+e.toString());
    }
    return lesMessages;
} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T18:04:07.580

这是尝试在本地连接。

```
HttpPost("http://192.168.1.1:80/connexion_mysql.php?variable=" + dataFromHMI); 
```

您的代码是否在您可以在未连接到本地计算机时访问的服务器上？那是您需要发布到的网址！

192.168.1.1 是 Linksys 路由器（可能还有其他路由器）使用的默认 IP 地址，请参见：[http ://www.tech-faq.com/192-168-1-1.html](http://www.tech-faq.com/192-168-1-1.html)

因此，当您通过 wifi 连接到此路由器时，您无法访问存储在 @192.168.1.1:80 的资源，但超过 3g 您将不再连接到此路由器。您将需要以另一种方式托管您的文件...通过设置服务器、通过网络托管服务托管您的文件等...以便远程访问文件！

# reporting-services - SSRS 2008 R2 开发者版，不支持订阅功能

> ID：11471196
> 
> 赞同：0
> 
> 时间：2012-07-13T13:10:52.240
> 
> 标签：reporting-services, ssrs-2008

我安装了 SSRS 2008 R2 Developer Edition，但是在报告管理器中，当我尝试订阅报告时，它说

> 此版本的 Reporting Services 不支持以下功能：“订阅报表”。

任何人都可以阐明一些光？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T14:09:44.583

如 Microsoft 在文档中所述，某些版本不支持它：

[http://technet.microsoft.com/en-us/library/cc645993(sql.105).aspx#Reporting](http://technet.microsoft.com/en-us/library/cc645993(sql.105).aspx#Reporting)

对于数据驱动订阅，您至少需要标准版和企业版。

开发者版应该具有与 DataCenter 相同的权限（所以最大），所以你可能没有使用开发者版。

您可以通过运行以下查询来查看正在安装的版本：`select @@version`

# c# - 使用 Webinator+Selenium、SpecFlow 和 NUnit 进行多浏览器测试

> ID：11471198
> 
> 赞同：4
> 
> 时间：2012-07-13T13:10:55.697
> 
> 标签：c#, selenium, nunit, specflow, selenium-chromedriver

我正在使用 Selenium 驱动程序开发一个带有 WebinatorSpecFlow+NUnit 的 ASP.NET MVC 3 应用程序。我在使用 Chrome（使用 chromedriver）和 Internet Explorer 运行并行测试时遇到问题。

每当我在同一个会话中运行两个测试并由 Selenium 通过 Webinator 并行运行时，当我向页面发送任何点击操作时，IE 似乎都会挂起。

我无法使用[此处](https://stackoverflow.com/a/7854838/1464825)建议的解决方案，因为 SpecFlow 会自动生成底层 C# 代码。我的解决方案是这样设计[的](https://gist.github.com/3100313)（完整代码可作为要点提供）：

```
_multipleBrowsers.RunTest(web => web.GoToUrl("http://localhost/PROJECT/Authentication/Registration")); 
```

发生的情况是，我为每个需要测试的浏览器实例化了一个新的 IWebManager。然后，我使用浏览器实例调用委托操作。它是这样的：

```
 foreach (var web in _webManagers)
        {
            Debug.WriteLine("Running test with " + web.Config.Browser);

            action(web);
        } 
```

这样测试几乎并行运行。它弹出一个浏览器，执行操作，然后是另一个浏览器，依此类推。

关于如何克服这个 ChromeDriver 问题的任何想法？我应该使用 SpecFlow 更改针对多个浏览器的测试方法吗？

* * *

参考：

*   [网络研讨会](http://webinator.codeplex.com/)
*   [规范流](http://specflow.org/)
*   [单元](http://nunit.org/)
*   [铬驱动程序](http://code.google.com/p/selenium/wiki/ChromeDriver)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-03-11T08:23:34.163

你可以更简单[地使用](https://github.com/baseclass/Contrib.SpecFlow.Selenium.NUnit)

然后你用标签 @Browser:IE 编写功能

```
@Browser:IE
@Browser:Firefox
Scenario: Add comments
       Given I navigated to /guinea-pig
       And I have entered 'This is not a comment' into the commentbox
       When I press 'submit' 
       Then my comment 'This is not a comment' is displayed on the screen 
```

现在是我发现的最好的解决方案，因为它也可以不是在所有浏览器中进行测试，而是在您需要的特定浏览器中进行测试

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-04-16T15:29:25.843

我创建了一个新的 SpecFlow 插件来获得好评。它支持 SpecFlow 3（也意味着核心）。

它也适用于 MsTest、NUnit 和 xUnit。

[https://github.com/TotalTest/SpecFlow.Contrib.Variants](https://github.com/TotalTest/SpecFlow.Contrib.Variants)

可以在此处查看该场景及其在测试资源管理器中的外观： [img](https://i.stack.imgur.com/qF6At.png)

但基本上你可以这样做：

```
@Browser:Chrome
@Browser:Firefox
Feature: AnExampleFeature 
```

或者

```
@Browser:Chrome
@Browser:Firefox
Scenario: AnExampleScenario 
```

并且场景将针对每个浏览器运行

# java - 在 Logback 中使用 getAppender()

> ID：11471202
> 
> 赞同：1
> 
> 时间：2012-07-13T13:11:18.630
> 
> 标签：java, logging, logback, appender

我编写了一个自定义附加程序`JTableAppender`，它实现了`ILoggingEvent`. 这个 appender 有一个公共的 setter`setModel(..)`来为 appender 分配一个表模型，所以我可以在`doAppend()`.

JTableAppender 在一个 xml 文件中配置，我将其命名为 TABLE：

```
<appender name="TABLE" class="blabla.jgwf.test.logger.JTableAppender">
    <!-- encoders are by default assigned the type ch.qos.logback.classic.encoder.PatternLayoutEncoder -->
    <encoder> 
        <pattern>%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n
        </pattern>
    </encoder>
</appender> 
```

为了能够从外部使用 setter，我尝试使用 appender

```
Logger logger = (Logger) LoggerFactory.getLogger("blabal");
JTableAppender<ILoggingEvent> appender = (JTableAppender<ILoggingEvent>)logger.getAppender("TABLE"); 
```

当我尝试使用设置模型时

```
appender.setModel(...); 
```

正是这一行，我得到了 NullPointerException。getAppender() 没有像我希望的那样工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-04-08T16:43:07.653

**已解决**：使用 Logger.getRootLogger() 代替您的局部变量“记录器”。

（*示例*）

```
SMTPAppender emailAppender = 
(SMTPAppender)Logger.getRootLogger().getAppender("SMTPAppender"); 
```

这样做，你不会得到 NullException，并且要**在**你的 appender 上应用更改，那么你必须这样写：`emailAppender.activateOptions();`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-12-22T16:39:48.517

使用 logback 1.1.3 我必须：

```
import ch.qos.logback.classic.Logger
import org.slf4j.LoggerFactory    
...
val root: Logger = val root: Logger = LoggerFactory.getLogger(org.slf4j.Logger.ROOT_LOGGER_NAME).asInstanceOf[Logger]
val myAppender = root.getAppender("MyAppenderName") 
```

# perl - 用第二个 csv 文件中的字符串替换子字符串

> ID：11471207
> 
> 赞同：0
> 
> 时间：2012-07-13T13:11:48.217
> 
> 标签：perl

早些时候我正在处理循环中的循环，如果匹配，它将替换第二个循环文件​​中的整个字符串。现在我的情况略有不同。我正在尝试用第二个循环中的字符串替换第一个循环中的子字符串。它们都是 csv 文件和分号分隔。我要替换的是特殊字符：从数字代码到字符本身 第一个文件如下所示：

```
1;2;bla&#322blabla &#261bla;7;8
3;4;bl&#261blabla;9;10
2;3;blablabla&#261a&#322;8;9 
```

第二个文件有数字代码和相应的字符：

```
&#260;;Ą
&#261;;ą
&#478;;Ǟ
&#193;;Á
&#225;;á
&#194;;Â
&#322;;ł 
```

第二个文件中的第一个分号属于对应字符的数字代码，不应该用于分割文件。结果应该是：

```
1;2;blałblabla ąbla;7;8
3;4;bląblabla;9;10
2;3;blablablaąał;8;9 
```

这是我的代码。我怎样才能解决这个问题？

```
use strict;
use warnings;

my $inputfile1 = shift || die "input/output!\n";
my $inputfile2 = shift || die "input/output!\n";
my $outputfile = shift || die "output!\n";

open my $INFILE1,  '<', $inputfile1 or die "Used/Not found :$!\n";
open my $INFILE2,  '<', $inputfile2 or die "Used/Not found :$!\n";
open my $OUTFILE, '>', $outputfile or die "Used/Not found :$!\n";

my $infile2_pos = tell $INFILE2;

while (<$INFILE1>) {
s/"//g;
my @elements = split /;/, $_;
seek $INFILE2, $infile2_pos, 0;

    while (<$INFILE2>) {
    s/"//g;
    my @loopelements = split /;/, $_;

    #### The problem part ####
    if (($elements[2] =~ /\&\#\d{3}\;/g) and (($elements[2]) eq ($loopelements[0]))){
        $elements[2] =~ s/(\&\#\d{3}\;)/$loopelements[1]/g;
        print "$2\. elements[2]\n";
                }
    #### End problem part #####
    }

my $output_line = join(";", @elements);
print $OUTFILE $output_line;
#print "\n"
}

close $INFILE1;
close $INFILE2;
close $OUTFILE;

exit 0; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T15:34:35.100

假设你的字符代码是标准的 Unicode 实体，你最好用[`HTML::Entities`](https://metacpan.org/module/HTML%3a%3aEntities)它来解码它们。

该程序处理您在*第一个文件*中显示的数据并完全忽略*第二个文件*。输出似乎是你想要的。

```
use strict;
use warnings;

use HTML::Entities 'decode_entities';

binmode STDOUT, ":utf8";

while (<DATA>) {
  print decode_entities($_);
}

__DATA__
1;2;bla&#322blabla &#261bla;7;8
3;4;bl&#261blabla;9;10
2;3;blablabla&#261a&#322;8;9 
```

**输出**

```
1;2;blałblabla ąbla;7;8
3;4;bląblabla;9;10
2;3;blablablaąał8;9 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T13:34:36.723

您`@elements`在每次出现时拆分您的`;`，然后将其删除。您不会在您的数据中找到它，您的正则表达式中的分号永远不会匹配，因此不会进行任何替换。

无论如何，使用`seek`对我来说有点令人不安。由于您有合理数量的替换代码（<5000），您可以考虑将它们放入哈希中：

```
my %subst;
while(<$INFILE2>){
    /^&#(\d{3});;(.*)\n/;
    $subst{$1} = $2;
} 
```

然后我们可以这样做：

```
while(<$INFILE1>){
   s| &# (\d{3}) | $subst{$1} // "&#$1" |egx;
       # (don't try to concat undef
       # when no substitution for our code is defined)
   print $OUTFILE $_;
} 
```

如果在 INFILE1 中的任何地方都应该发生替换，我们不必拆分文件或将它们作为 CSV 数据查看。我的解决方案应该加快速度（只解析一次 INFILE2）。在这里，我假设您的输入数据是正确的，并且数字代码不是以分号结尾，而是以长度结尾。您可能想从您的正则表达式中删除它。（即`m/&#\d{3}/`）

如果您在字符编码方面遇到问题，您可能希望使用 :uft8 和/`use Encode`或类似文件打开文件。

# android - 在 SurfaceView 上绘制文本

> ID：11471210
> 
> 赞同：0
> 
> 时间：2012-07-13T13:11:52.733
> 
> 标签：android

我正在尝试在 a 上绘制文本，`SurfaceView`但什么都看不到。

当我尝试获取`View`0 的宽度和高度时，虽然它应该填充父元素，但它会返回。

**相机预览.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
             android:layout_width="fill_parent"
             android:layout_height="fill_parent">
    <SurfaceView
            android:id="@+id/svCamera"
            android:layout_height="fill_parent"
            android:layout_width="fill_parent"/>

    <FrameLayout
            android:layout_height="fill_parent"
            android:layout_width="fill_parent">
        <View
                android:id="@+id/vOverlays"
                android:layout_height="fill_parent"
                android:layout_width="fill_parent"/>
    </FrameLayout>
</FrameLayout> 
```

**CameraActivity.java**

```
public class CameraActivity extends Activity {
    private Camera camera;
    private CameraPreview cameraPreview;
    private View vOverlays;
    private SurfaceHolder svHolder;
    private SurfaceView svCamera;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        setContentView(R.layout.camerapreview);

        svCamera = (SurfaceView) findViewById(R.id.svCamera);
        vOverlays = findViewById(R.id.vOverlays);
    }

    @Override
    protected void onResume() {
        super.onResume();

        camera = Camera.open();

        svHolder = svCamera.getHolder();
        cameraPreview = new CameraPreview(svHolder, camera);
        svHolder.addCallback(cameraPreview);
        svHolder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);

        Canvas canvas = new Canvas();
        Paint paint = new Paint();
        paint.setColor(Color.BLACK);
        paint.setTextSize(10);

        canvas.drawText("Testext", vOverlays.getWidth() / 2, vOverlays.getHeight() / 2, paint);
        vOverlays.draw(canvas);
    }
} 
```

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-07-13T13:20:55.853

您可以在它自己的父视图上添加文本视图，以创建动态文本视图并将其添加到您的父布局中。在这里你需要获得框架布局的参考，你可以添加你的文本视图......

```
frame_layout.addView(text_view);
text_view.bringToFront(); 
```

# python - 关于一个简单的 python wsgi 服务器的困惑 (wsgiref.simple_server)

> ID：11471211
> 
> 赞同：5
> 
> 时间：2012-07-13T13:11:53.747
> 
> 标签：python, network-programming, shared-libraries, wsgi

这是一个简单的 python wsgi 服务器，可以`Hello guys!!!`在`0.0.0.0:8080`.

```
from wsgiref.simple_server import make_server

content = 'Hello guys!!!'

def application(environ, start_response):
    start_response('200 OK', [('Content-Type', 'text/plain')])
    return [content]

server = make_server('0.0.0.0', 8080, application)
server.serve_forever() 
```

查看此代码时会出现几个问题：

1.  `make_server`该函数如何仅使用函数名称`application`？我看不出它是如何做任何其他事情的，然后返回`"<function application at 0x7f71686286e0>"`字符串（`application.__repr__() method`函数对象的）。

2.  为什么应用程序函数定义定义`environ`为参数，而不是在这个函数中使用，甚至没有在`application`以后的函数调用中设置？

3.  据我了解，`start_response`函数定义中的参数在这里用作一种标识符，这将是函数的名称，它设置稍后在`make_server`函数调用中需要的其他属性。标准库中定义的功能在哪里？（我已经检查了相关模块的来源，但我不明白它是在哪里完成的）

观察：更改`environ`函数定义中的参数不会改变代码行为的任何内容，但是参数必须与函数体中的`start_response`名称相同。`start_response``application`

我知道`os.environ`是一本字典，但我在 python 标准库中找不到它的调用位置。如果`environ`参数是必要的并且是唯一可行的第一个参数，我不明白为什么他们会要求您`environ`每次都明确命名第一个参数（），它会给您一种错觉，即使用不同的参数会影响其行为。我知道“显式优于隐式”-python 策略，但在这里我认为它是无用且令人困惑的。

## 编辑

由于 Ned 的回答，我现在通过查看`make_server('0.0.0.0', 8080, application)`创建`WSGIServer`诸如`wsgiref.simple_server.WSGIServer((host, port), handler_class))`. 更深入地看，我发现初始化方法是继承自`BaseServer`. BaseServer 实例具有`server_address`和 `RequestHandlerClass`作为实例变量等。函数对象`application`存储在 的`application`类变量中`WSGIServer`。

但我仍然找不到这个`application`类变量在 python 源代码中的其他地方使用。（我已经搜索了所有包含父类的类定义的模块`WSGIServer`）有人知道它在哪里使用吗？发现这可能会回答我所有的问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T13:20:48.067

这里重要的 Python 概念是函数和其他任何东西一样都是对象，并且可以分配给变量：

```
>>> def double(x):
...     return 2*x
...

>>> my_fn = double
>>> my_fn(4)
8 
```

当您使用不带括号的函数名称时，您只是在谈论该函数，而不是调用它。

在这一行：

```
server = make_server('0.0.0.0', 8080, application) 
```

`application`是一个函数，您将它作为一个值传递给`make_server`，稍后将能够调用它。这就是您的应用程序的调用方式。传递给您的`application`函数的值之一是另一个函数，称为`start_response`. 这是 WSGI 作者编写的一个函数，他们将其提供给您调用，您可以使用该行

```
start_response('200 OK', [('Content-Type', 'text/plain')]) 
```

您的`application`函数必须接受两个参数，通常称为 environ 和 start_response。您不使用 environ 值，但更复杂的 WSGI 应用程序会。WSGI 框架要求所有的应用程序函数接受两个参数，所以它总是用两个参数调用函数，所以你必须用两个参数定义你的函数，否则它将无法正常工作。

# jquery - jQuery Ajax 请求执行过于频繁

> ID：11471213
> 
> 赞同：0
> 
> 时间：2012-07-13T13:11:58.240
> 
> 标签：jquery, ajax, live

我通过 live 操作符将 click 函数绑定到 li 元素：

```
$(".UListView li input.iconbutton.click").live("click", function(e){

e.preventDefault();
[...]
$.get("ajax/categorylist.php?appendcategories=true&parentcat="+currentid+"&side="+side, function(data){
[...]
});

}); 
```

在近 90% 的情况下，它会执行一次并且一切正常。但有时 ajax 请求会执行 2 次甚至更多次：

这是萤火虫的输出：（执行两次）

```
jquery.min.js (Zeile 4)
GET htt-p://localhost/request.php?....    200 OK     11ms   
jquery.min.js (Zeile 4)
GET htt-p://localhost/request.php?....    200 OK      19ms 
```

这完全破坏了我的布局，因为所有元素在最坏的情况下 6 倍添加到 DOM。

有谁知道这种行为的原因是什么？或者修复“添加到 DOM”代码的好主意被多次执行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T13:15:02.570

添加`e.stopPropagation();`到您的代码以及`return false;`点击事件结束之前

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T13:18:35.853

我希望你不会两次绑定实时事件..在这种情况下使用这个..

```
 $(".UListView li input.iconbutton.click").die("click");
   $(".UListView li input.iconbutton.click").live("click", function(e){
..
..
..
}); 
```

或者有时即使我们单击一次按钮，事件也会被触发两次..

在这种情况下，单击按钮后首先隐藏按钮以防止多次提交..

```
$(".UListView li input.iconbutton.click").live("click", function(e){

$(".UListView li input.iconbutton.click").hide();
..
..
..
}); 
```

# selenium - Apple 开发人员的多个证书

> ID：11471219
> 
> 赞同：2
> 
> 时间：2012-07-13T13:12:27.787
> 
> 标签：selenium, safari

我想在许多还包含 Safari 浏览器的 VM 上运行 selenium 测试。我刚刚注册了 Apple 的 Safari 开发人员计划，就像这里所说的那样： [http ://code.google.com/p/selenium/wiki/SafariDriver](http://code.google.com/p/selenium/wiki/SafariDriver)

我还生成了一个证书并构建了我的 SafariDriver 扩展。一切都在一台机器上运行良好，但现在我也想为其他机器生成 SafariDriver 扩展。

我必须注册为其他 Apple 开发人员吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T03:47:08.707

我的经验是，您可以使用一个 Safari 开发帐户创建两个 Safari 扩展证书。不确定是否为开发帐户付费让我们拥有更多。

# extjs4 - Extjs 4/煎茶

> ID：11471222
> 
> 赞同：1
> 
> 时间：2012-07-13T13:12:44.417
> 
> 标签：extjs4, extjs

我是初级 Sencha/Extjs 用户，我正在尝试做一些我确信它很简单但仍然不知道如何做的事情。

正如你在这里看到的：

![图1](../Images/5bd235dd5916a349a560d7c473c4ce6c.png)

我有 2 个面板，一个称为“面板 1”，另一个被隐藏并称为“面板 2”，我还有 2 个工具栏，一个带有名为“转到面板 2”的按钮，当我按下它时，我应该得到这个：

![图2](../Images/d88df36d4b932ad44b84630fc71ff8f8.png)

应该隐藏“面板 1”，并且“面板 2”与第二个工具栏一起出现，该工具栏有另一个名为“转到面板 1”的按钮

我希望我说得足够清楚。我可以做上面的事情，但我认为我使用了一种愚蠢的方式，我在按钮 1 上使用带有函数 onButtonClick 的事件绑定：

```
Ext.getCmp('p2').show();
Ext.getCmp('tb2').show();
Ext.getCmp('p1').hide();
Ext.getCmp('tb1').hide(); 
```

在按钮 2 上反之亦然：

```
Ext.getCmp('p1').show();
Ext.getCmp('tb1').show();
Ext.getCmp('p2').hide();
Ext.getCmp('tb2').hide(); 
```

现在，我确信有更好的方法可以使用控制器来实现这一点，但我需要有人详细解释我如何做到这一点，因为正如我所说，我没有经验。

谢谢你。

**编辑**

我也需要做到这一点：

![图3](../Images/ae9250809af73392986284c1352d632c.png)

```
Button 1 --> panel 1

Item 1 --> panel 2

Item 2 --> panel 3 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T13:23:46.933

您可以使用卡片布局来制作这种 UI。[在此处查看文档和实时示例](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.layout.container.Card)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T07:49:31.393

如果视图看起来像

```
Ext.define('MyApp.view.parentpanel', {
    extend: 'Ext.panel.Panel',

    height: 250,
    width: 400,
    activeItem: 0,
    layout: {
        type: 'card'
    },

    initComponent: function() {
        var me = this;

        Ext.applyIf(me, {
            items: [
                {
                    xtype: 'panel',
                    html: 'i\'m panel 1',
                    bodyPadding: 10,
                    title: 'panel 1'
                },
                {
                    xtype: 'panel',
                    html: 'i\'m panel 2',
                    bodyPadding: 10,
                    title: 'panel 2'
                }
            ],
            dockedItems: [
                {
                    xtype: 'toolbar',
                    dock: 'bottom',
                    items: [
                        {
                            xtype: 'button',
                            text: 'go to panel 2'
                        }
                    ]
                }
            ]
        });

        me.callParent(arguments);
    }
}); 
```

控制器将类似于

```
Ext.define('MyApp.controller.MyController', {
    extend: 'Ext.app.Controller',

    views: [
        'parentpanel'
    ],

    onButtonClick: function(button, e, options) {
        var me = this,
            parentPanel = button.up('panel'),
            layout = parentPanel.getLayout(),
            activeItem = layout.getActiveItem(),
            title = activeItem.title,
            index = (title === 'panel 1' ? 1 : 0);

        layout.setActiveItem(index);
        button.setText('go to ' + title);
    },

    init: function() {
        this.control({
            "button": {
                click: this.onButtonClick
            }
        });

    }

}); 
```

# shell - 在 Unix 中使用 AWK 或 SED 获取 xml 标签之间的文本

> ID：11471226
> 
> 赞同：-1
> 
> 时间：2012-07-13T13:12:50.690
> 
> 标签：shell, unix, sed, awk

> **可能重复：**
> [使用 AWK 或 SED 以逗号分隔，并带有以下标签](https://stackoverflow.com/questions/11460542/delimited-by-comma-using-awk-or-sed-with-the-tags-below)

我有以下格式的文本。

```
[AccountID]
 [CallerID]
  [BilledAccountAttributes]
  1111111
  1111111
  1111111
[\BilledAccountAttributes]
[OBIOTax]
10
20
30
[\OBIOTax]
[RINOTax]
777
888
999
[\RINOTax]
[\CallerID]
[\AccountID]

[AccountID]
[CallerID]
[BilledAccountAttributes]
2222222
2222222
2222222
[\BilledAccountAttributes]
[OBIOTax]
40
50
60
[\OBIOTax]
[\CallerID]
[\AccountID] 
```

而且我希望以以下格式输出（用逗号分隔，当不显示 RINOTAX 时输入零。）

```
1111111,1111111,1111111,  10,20,30,  777,888,999  
2222222,2222222,2222222,  40,50,60,    0,  0,  0 
```

谁能建议如何得到这个。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T13:24:25.903

我会为此使用awk。

我的方法是检查一行是否只包含一个数字。这可以通过正则表达式来完成。awk 的文档告诉您如何在 awk 中使用它。

如果一行包含`[\AccountID]`，则打印一个换行符。

我会使用一个标记变量来记住当前打印行是否有先前的值。如果打印了值，则将此标记设置为 true。然后根据这个标记打印出一个逗号。如果您编写换行符（见上文），请将标记设置为 false。因此，在下一个数字之前，不会打印逗号。

一些伪代码（类似于 shell 的语法）：

```
begin { marker = 0; }
{
  if 'line contains number' then
    if 'marker == 1' then print ','
    print current line
    set marker to 1
  elsif 'line is end account id' then
    set marker to 0
    print '\n'
  fi
} 
```

我希望这可以帮助您找到解决方案。

# iphone - xcode 4.3.2：将iphone部署到真实设备的指南文档

> ID：11471227
> 
> 赞同：0
> 
> 时间：2012-07-13T13:12:51.330
> 
> 标签：iphone

我正在尝试使用 Ad Hoc Distribution 或 Apple Store 部署 iphone 应用程序。我试图在互联网上搜索以查找指南文档，但我只获得 iOS 3.1 的 iphone_developer_program_user_guide__standart_program_v2.6__final_3410.pdf。对我来说太老了，因为我的 Xcode 版本是 4.3.2。有谁知道这方面的指南文件？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T13:17:50.107

这是你想要的？

[将 iPhone/iPad 应用程序部署到真实设备的指南](http://www.techotopia.com/index.php/Testing_iOS_5_Apps_on_the_iPhone_%E2%80%93_Developer_Certificates_and_Provisioning_Profiles)

# algorithm - Haskell：FIFO队列算法复杂度

> ID：11471230
> 
> 赞同：2
> 
> 时间：2012-07-13T13:13:04.400
> 
> 标签：algorithm, haskell

这是我对 FIFO 队列的尝试：

```
type Queue a = [a] -> [a]

empty :: Queue a
empty = id

remove :: Int -> Queue a -> ([a], Queue a)
remove n queue = (take n (queue []), (\x -> drop n (queue x)));

add :: [a] -> Queue a -> Queue a
add elems queue = (\x -> queue (elems ++ x)) 
```

`empty`创建一个空队列，`remove`获取队列的第一个`n`元素并将队列的其余部分作为元组的第二个元素返回，`add`并将列表添加`elems`到队列中。

这会及时添加/删除 1 个元素`O(1)`和 n 个元素`O(n)`吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-13T13:49:03.167

您有效实施的内容相当于[差异列表](http://www.haskell.org/haskellwiki/Difference_list)。（见：[dlist](http://hackage.haskell.org/package/dlist/)。）

差异列表允许廉价的附加，但不幸的是，您的删除将需要线性时间。如果我们稍微重写您的代码，它会变得更加清楚：

```
type Queue a = [a] -> [a]

empty :: Queue a
empty = id

toList :: Queue a -> [a]
toList q = q []

fromList :: [a] -> Queue a
fromList = (++)

remove :: Int -> Queue a -> ([a], Queue a)
remove n q = (xs, fromList ys)
  where
    (xs, ys) = splitAt n (toList q)

add :: [a] -> Queue a -> Queue a
add xs q = (++ xs) . q 
```

请注意，我对列表的转换比在您的代码中更明确一些。您清楚地看到删除代码的核心被括在`toList`和之间`fromList`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-14T07:50:40.693

好吧，稍微回避您的问题，FIFO 队列的经典纯功能实现是一对列表，一个用于“前”，一个用于“后”。您通过将元素添加为后列表的头部来使元素入队，并通过获取前列表的头部来出列；如果前列表为空，则通过反转后列表并将其与空的前列表交换来“旋转”队列。在代码中：

```
import Control.Monad
import Data.List
import Data.Maybe

data FIFO a = FIFO [a] [a]
              deriving Show

empty :: FIFO a
empty = FIFO [] []

isEmpty :: FIFO a -> Bool
isEmpty (FIFO [] []) = True
isEmpty _ = False

enqueue :: a -> FIFO a -> FIFO a
enqueue x (FIFO front back) = FIFO front (x:back)

-- | Remove the head off the queue.  My type's different from yours
-- because I use Maybe to handle the case where somebody tries to
-- dequeue off an empty FIFO.
dequeue :: FIFO a -> Maybe (a, FIFO a)
dequeue queue = case queue of
                  FIFO [] [] -> Nothing
                  FIFO (x:f) b -> Just (x, FIFO f b)
                  otherwise -> dequeue (rotate queue)
    where rotate (FIFO [] back) = FIFO (reverse back) []

-- | Elements exit the queue in the order they appear in the list.
fromList :: [a] -> FIFO a
fromList xs = FIFO xs []

-- | Elements appear in the result list in the order they exit the queue.
toList :: FIFO a -> [a]
toList = unfoldr dequeue 
```

这是经典的实现。现在你的操作可以这样写：

```
-- | Enqueue multiple elements.  Elements exit the queue in the order
-- they appear in xs.
add :: [a] -> FIFO a -> FIFO a
add xs q = foldl' (flip enqueue) q xs 
```

`remove`要根据 .编写`dequeue`，您需要`(a, FIFO a)`从`dequeue`. 一种方法是使用`State`monad：

```
import Control.Monad.State

-- | Remove n elements from the queue.  My result type is different
-- from yours, again, because I handle the empty FIFO case.  If you
-- try to remove too many elements, you get a bunch of Nothings at
-- the end of your list.
remove :: Int -> FIFO a -> ([Maybe a], FIFO a)
remove n q = runState (removeM n) q

-- | State monad action to dequeue n elements from the state queue.
removeM :: Int -> State (FIFO a) [Maybe a]
removeM n = replicateM n dequeueM

-- | State monad action to dequeue an element from the state queue.
dequeueM :: State (FIFO a) (Maybe a)
dequeueM = do q <- get
              case dequeue q of
                Just (x, q') -> put q' >> return (Just x)
                Nothing -> return Nothing 
```

# android - 如何将返回 Web 服务的值相乘并在 Android 的 listView 中查看？

> ID：11471233
> 
> 赞同：0
> 
> 时间：2012-07-13T13:13:18.927
> 
> 标签：android, listview

这是我的代码！我想将用户成本乘以 12。并且我想将此计数（成本 * 12）添加到列表视图中。但是由于列表适配器，我只将字符串列添加到列表视图中。如何还可以通过乘法添加整数值？

```
static final String KEY_ITEM= "USER_ID";   
static final String KEY_NAME = "USER_NAME";
static final String KEY_SURNAME = "USER_SURNAME";
static final String KEY_DATE = "USER_DATE";
static final String KEY_COST="USER_COST";

HashMap<String, String> map = new HashMap<String, String>();
Element e = (Element) nl.item(i);
map.put(KEY_ITEM, conParser.getValue(e, KEY_ITEM));
map.put(KEY_NAME, conParser.getValue(e, KEY_NAME));
map.put(KEY_SURNAME, conParser.getValue(e, KEY_SURNAME));
map.put(KEY_DATE, conParser.getValue(e, KEY_DATE));
map.put(KEY_COST, conParser.getValue(e, KEY_COST));

items.add(map); 

final ListAdapter adapter = new SimpleAdapter(this, items,
            R.layout.list_item,
            new String[] {KEY_ITEM,KEY_NAME,KEY_SURNAME,temp,KEY_DATE,KEY_COST}, new int[] {
                    R.id.kod, R.id.isim,R.id.kisi_sayisi,R.id.adisyon_sayisi,R.id.toplam_satis});

    setListAdapter(adapter); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T14:08:28.580

在将其添加到地图之前，请获取字符串并操作数据。

> 整数成本=Ingeter.valueOf(String)*12；成本.toString();

# java - 无法从 JSONObject 检索值

> ID：11471239
> 
> 赞同：1
> 
> 时间：2012-07-13T13:13:26.117
> 
> 标签：java, php, android, json

我正在通过 PHP 为这个 android java 类（登录屏幕）传递值，但它给了我一个 JSONException 错误，我无法从下面的代码中识别出来。有人可以告诉我如何解决吗？先感谢您！

**登录活动.java**

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.login);

    // Importing all assets like buttons, text fields
    inputUid = (EditText) findViewById(R.id.loginUid);
    inputPassword = (EditText) findViewById(R.id.loginPassword);
    btnLogin = (Button) findViewById(R.id.btnLogin);

    btnLinkToRegister = (Button) findViewById(R.id.btnLinkToRegisterScreen);

    loginErrorMsg = (TextView) findViewById(R.id.login_error);

    // Login button Click Event
    btnLogin.setOnClickListener(new View.OnClickListener() {

        public void onClick(View view) {
            String id = inputUid.getText().toString();
            String pswd = inputPassword.getText().toString();
            UserFunctions userFunction = new UserFunctions();
            Log.d("Button", "Login");
            JSONObject json = userFunction.loginUser(id, pswd);

            // check for login response
            try {
                if (json.getString(KEY_SUCCESS) != null) {
                    loginErrorMsg.setText("");
                    String res = json.getString(KEY_SUCCESS); 
                    if(Integer.parseInt(res) == 1){
                        // user successfully logged in

                        // Store user details in SQLite Database
                        DatabaseHandler db = new DatabaseHandler(getApplicationContext());
                        JSONObject json_user = json.getJSONObject("user");

                        // Clear all previous data in database
                        userFunction.logoutUser(getApplicationContext());
                        db.addUser(json.getString(KEY_ID), json_user.getString(KEY_NAME), json_user.getString(KEY_EMAIL), json_user.getString(KEY_CREATED_AT));                     

                        // Launch Dashboard Screen
                        Intent dashboard = new Intent(getApplicationContext(), DashboardActivity.class);

                        // Close all views before launching Dashboard
                        dashboard.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
                        startActivity(dashboard);

                        // Close Login Screen
                        finish();
                    }else{
                        // Error in login
                        loginErrorMsg.setText("Incorrect username/password");
                    }
                }
            } catch (JSONException e) {
                e.printStackTrace();
            }
        }
    }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T13:18:40.713

```
db.addUser(json.getString(KEY_ID), json_user.getString(KEY_NAME), json_user.getString(KEY_EMAIL), json_user.getString(KEY_CREATED_AT)); 
```

改成

```
db.addUser(json_user.getString(KEY_ID), json_user.getString(KEY_NAME), json_user.getString(KEY_EMAIL), json_user.getString(KEY_CREATED_AT)); 
```

# search-engine - 搜索引擎的典型爬取深度

> ID：11471242
> 
> 赞同：0
> 
> 时间：2012-07-13T13:13:33.273
> 
> 标签：search-engine, web-crawler

当网站被搜索引擎（谷歌、必应等）抓取时，搜索引擎将爬入网站的典型最大深度是多少。通过深度，我的意思是从主页跳数。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T22:19:18.290

这取决于您网站的整体排名，以及传入链接的排名，尤其是当它们没有指向您的主页时。

像 blekko 这样的小型搜索引擎的爬虫不会离外部链接的着陆点那么远，除非您的整体网站很棒或者您有很多来自很棒网站的链接。我们为排名较高的内容节省了爬取和索引的能量，所以如果我们估计一个页面的排名很差，我们不会打扰。

即使您的链接配置文件很差，Google 的爬虫也可能会爬很远 - 但即使他们知道的 URL 比实际爬取的 URL 多 10 倍。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T10:19:37.870

如果你想爬遍整个世界，那么 19 深度就足够了。因为整个世界覆盖在 19 个深度。但是，如果您想抓取特定域或国家/地区，那么 10 深度就足够了。

我从一篇论文中找到了这个信息。用于开发墨卡托。

感谢 Mohiul Alam 王子

# fortran90 - 要从类型定义中调用的数组值函数

> ID：11471244
> 
> 赞同：0
> 
> 时间：2012-07-13T13:13:35.610
> 
> 标签：fortran90, gfortran, fortran95

在编写一个库来读取图像值时，我遇到了以下问题：我定义了一个名为`realimage`. 在这种类型中，引用了一个函数，该函数返回一个数组作为结果。

```
module typedefinition
implicit none

type realimage
  integer        :: byteorder     = 0
  contains
    procedure :: initialize => initializereal
    procedure :: pxvalues => pxvaluesreal ! Array valued function
end type realimage

contains
  function pxvaluesreal(this, x, y) result(val)
  implicit none
  type(realimage) this
  real val(5)
  integer :: x, y
  ...
  end function
end module 
```

使用 gfortran 编译模块并使用 调用函数`image1%pxvalues(x,y)`，我总是收到以下错误消息：

```
main.f95: In function ‘testtype’:
main.f95:15: internal compiler error 
```

如果我直接在主程序中调用该函数`(pxvaluesreal(image1,x,y))`，一切正常。

是否可以在类型定义中定义数组维度以告诉编译器，函数返回值的维度是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T22:13:38.247

内部编译器错误总是由编译器错误引起的。如果您使用的是最新版本的 gfortran，您应该考虑查看他们的开放错误列表，并可能提交错误报告。

除此之外 - 您的代码不符合标准 - 传递的对象“this”必须是多态的（用 CLASS 而不是 TYPE 声明它）。否则，您对数组函数结果大小的规范是正确的 - 当您引用 pxvalues 绑定时，编译器知道函数结果的大小为 5，因为它“知道”绑定所关联的特定过程 pxvaluesreal 的接口.

# css - 为什么#wrapper 的背景颜色没有显示在左侧和内容列的后面？

> ID：11471247
> 
> 赞同：3
> 
> 时间：2012-07-13T13:13:46.890
> 
> 标签：css, html

看下面的html和css。我已将#wrapper 的宽度设置为 990 像素，中心列的完整宽度为 960 像素。两边都有15px的边距。因此，包装 div 的背景颜色应该显示在 #left 和 #content div 后面。但是，如果我设置#wrapper 的高度，它会显示背景。但我希望它显示为完整。

我只是 CSS 布局的初学者。

* * *

* * *

```
<html>
<head>
<style type="text/css">
body{
margin:0;
padding:0;
}
#header{
margin:0 auto;
width:100%;
background:#efffff;
height:100px;
}
#footer{
margin:0 auto;
clear:both;
width:100%;
background:#ccc;
height:100px;
}
#wrapper{
width:990px;
margin:0 auto;
background:#000;
display:block;
}
#left{
margin:0 0 0 15px;
background:#eeffee;
width:200px;
float:left;
}
#content{
margin:0 15px 0 0;
background:#eeeeee;
width:760px;
float:left;
}
</style>
</head>
    <body>
        <div id="header">
            header
        </div>
        <div id="wrapper">
            <div id="left">
                left
            </div>
            <div id="content">
                content<br/>
                content<br/>
                content<br/>
                content<br/>
                content<br/>
                content<br/>
                content<br/>
                content<br/>
                content<br/>
                content<br/>
                content<br/>
                content<br/>
                content<br/>
                content<br/>
                content<br/>
            </div>
        </div>

        <div id="footer">
            Footer
        </div>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T13:22:07.393

因为 Wrapper 包含浮动元素，所以您需要“清除”这些元素，否则 wrapper 不会环绕它们。有多种方法可以做到这一点，但是最被接受的方法是在包装器上使用 clearfix 类。

将以下代码添加到您的 css 中：

```
/* For modern browsers */
.clearfix:before,
.clearfix:after {
    content:"";
    display:table;
}
.clearfix:after {
    clear:both;
}
/* For IE 6/7 (trigger hasLayout) */
.clearfix {
    zoom:1;
} 
```

然后`class="clearfix"`在`<div id="wrapper">`元素上设置。所以它会变成：

```
<div id="wrapper" class="clearfix"> 
```

这个特殊的解决方案被称为 micro clearfix hack，更多信息可以在这里找到：http: [//nicolasgallagher.com/micro-clearfix-hack/](http://nicolasgallagher.com/micro-clearfix-hack/)

这是一个显示结果的 jsfiddle：http: [//jsfiddle.net/PWQru/1/](http://jsfiddle.net/PWQru/1/)

另外，请查看之前回答相同问题的一些问题。EG[我可以使用哪些“clearfix”方法？](https://stackoverflow.com/questions/211383/which-method-of-clearfix-is-best)

在这个问题上有一些关于各种方法的很好的讨论。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T13:20:43.927

添加高度：100%；向左 。

结果样式将是

```
#left 
{
    background: none repeat scroll 0 0 #EEFFEE;
    float: left;
    height: 100%;
    margin: 0 0 0 15px;
    width: 200px;
} 
```

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T13:22:55.183

那是因为您的内容和左 div 是浮动的。您必须在两个浮动 div 的末尾引入一个 div，以使包装器覆盖这两个 div。

```
<div id="wrapper">
            <div id="left">
                left
            </div>
            <div id="content"></div>   
    <div style="clear:both;"></div>
</div 
```

# java - 初学者将 jsf Web 应用程序部署到 Elastic Beanstalk

> ID：11471248
> 
> 赞同：0
> 
> 时间：2012-07-13T13:13:47.647
> 
> 标签：java, jsf-2, amazon-web-services, cdi, amazon-elastic-beanstalk

我正在创建一个使用 Java Server Faces (JSF) 2.1 版和 CDI 的 Java Web 应用程序。

可以将这样的 Web 应用程序部署到 Elastic Beastalk 吗？我看不到 JBOSS AS 7（JBOSS 的最新版本）的任何选项，所以我有点困惑......我应该从 Elastic Beanstalk 中显示的选项中选择哪个服务器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T14:00:58.683

Amazon Elastic Beanstalk 目前仅支持用于 Java 应用程序的 Apache Tomcat。您可以使用 AWS Toolkit for eclipse 将应用程序部署到 Tomcat 6 或 7。

如果您正在寻找 JBOSS，您可以尝试 RedHat 的 OpenShift。您可以部署在 JBOSS AS 7 或 JBOSS EAP 6 应用服务器上

另请参阅：

*   [http://aws.amazon.com/elasticbeanstalk/faqs/](http://aws.amazon.com/elasticbeanstalk/faqs/)
*   [http://docs.amazonwebservices.com/elasticbeanstalk/latest/dg/create_deploy_Java.sdlc.html](http://docs.amazonwebservices.com/elasticbeanstalk/latest/dg/create_deploy_Java.sdlc.html)
*   [http://www.jboss.org/openshift.html](http://www.jboss.org/openshift.html)

# database - 数据库模式推荐

> ID：11471251
> 
> 赞同：3
> 
> 时间：2012-07-13T13:13:57.530
> 
> 标签：database, database-design, schema

我在需要建模的数据问题上陷入了困境。我会尽力勾勒表格和关系

```
users (basic user information name/etc)
users.id

hospitals (basic information about hospital name/etc)
hospitals.id

pages
pages.id
user_id (page can be affiliated with a user)
hospital_id (page can be affiliated with a hospital) 
```

这是新数据开始的地方，我遇到了问题

```
groups (name of a group of pages)
groups.id

groups_pages (linking table)
group_id
page_id 
```

现在这是棘手的部分..一个组可以由用户或医院“拥有”，但这些页面不一定与该用户/医院相关..此外，还有另一种类型的实体（公司）可以“拥有'组

显示组时，我需要知道组的类型（用户/医院/公司），并能够获得正确的附属数据（名称、地址等）

我知道如何将组链接到其各自的所有者，我知道其各自的所有者可能不同。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T13:23:11.750

你必须使用某种形式的鉴别器。就像添加带有“owner_type”的列一样，您可以使用枚举、vchar 或仅使用 int 来表示该列所代表的所有者类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T13:56:44.860

```
HospitalGroups(HospitalID, GroupID)
UserGroups(UserID, GroupID)
CompanyGroups(CompanyID, GroupID)

Groups(GroupID,....)

GroupPages(GroupID, PageID)

Pages(PageID, ...) 
```

将是经典的方式。

@Robert 提到的鉴别器想法也可以，但是您会失去参照完整性，因此您需要更多代码而不是更多表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T13:45:45.937

[这](http://www.sqlteam.com/article/implementing-table-inheritance-in-sql-server)是一个很好的教程，介绍如何在数据库中建模继承，同时保持合理的范式和引用完整性。

精简版：创建另一个表，`owners`，并让它保留一组最小的属性（用户和医院的共同点，可能是全名、地址，当然还有`id`）。用户和医院将拥有各自的`id`列，这些列同时是他们的主键和外键引用`users.id`。给用户医院没有的属性，反之亦然。现在，每家医院都由两个容易连接的行表示，一个来自`owners`，一个来自`hospitals`。

这允许您`users.id`从`groups.owner_id`.

（还有一种更简单的替代方法，您只需为用户和医院创建一个表，并将 NULL 放入不适用于特定行的所有列，但这很快就会变得笨拙。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-13T16:26:46.493

*   `Party`是个人或组织的总称。
*   将所有常用字段（电话号码、地址..）保留在`Party`表中。
*   `Person`并且`Hospital`应该只有子类型的特定字段。
*   如果**公司**有不同的列集，`Hospital`只需将其添加为另一个子类型。
*   如果`Hospital`和**公司**有相同的列，重命名`Hospital`为更通用`Organization`
*   `PartyType`是判别器`{P,H}`

![在此处输入图像描述](../Images/1cc4cb2dce5453679b1d10612128b553.png)

# c# - 这个方法的输出类型是什么？

> ID：11471253
> 
> 赞同：1
> 
> 时间：2012-07-13T13:14:11.757
> 
> 标签：c#, entity-framework-4

> **可能重复：**
> [从 LINQ 查询返回匿名类型？](https://stackoverflow.com/questions/11358200/return-anonymous-type-from-linq-query)

我使用这种方法：

```
public static ... GetList()
    {
        Entity conn = new Entity();
        var lst = (from PS in conn.PurchaserSpecials
                select new
                {
                    PS.PurchaserID,
                    PS.PurchaserSerial,
                    PS.Purchaser.Address,
                    PS.Purchaser.Fax,
                    PS.Purchaser.NumberEconomic
                }).ToList();
return lst;
    } 
```

不能使用 var 作为输出类型。请帮我...

输出方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T13:16:49.250

它是您创建的匿名类型的列表。

如果您想返回您知道的类型，请创建一个包含您正在选择的字段的新类（我猜下面的类型）：

```
public class Specials
    {
        public int PurchaserID { get; set; }
        public int PurchaserSerial { get; set; }
        public string Address { get; set; }
        public int Fax { get; set; }
        public int NumberEconomic { get; set; }
    }

public static List<Specials> GetList()
    {
        Entity conn = new Entity();
        var lst = (from PS in conn.PurchaserSpecials
                select new Specials
                {
                    PurchaserID =  PS.PurchaserID,
                    PurchaserSerial = PS.PurchaserSerial,
                    Address = PS.Purchaser.Address,
                    Fax = PS.Purchaser.Fax,
                    NumberEconomic = PS.Purchaser.NumberEconomic
                }).ToList();
return lst;
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T13:18:27.737

您的 LINQ 查询生成一个匿名类型，因此不能用作方法的返回类型，调用方法将不知道返回类型的任何信息。

解决此问题的一种方法是使用动态关键字和动态类型。

你方法的返回类型可以是这样的

```
public dynamic GetList() {
        return ...; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T13:21:01.830

查询的输出是匿名类型，您不能将其作为参数返回。为了简单起见，最好创建一个类，例如：具有所有这些属性**的“PurchaseDetail” ，并返回如下代码：**

```
public static List<PurchaseDetail> GetList() 
    { 
        Entity conn = new Entity(); 
        var lst = (from PS in conn.PurchaserSpecials 
                select new PurchaseDetail
                { 
                    PurchaserID= PS.PurchaserID, 
                    PurchaserSerial=PS.PurchaserSerial, 
                    Address=PS.Purchaser.Address, 
                    Fax=PS.Purchaser.Fax, 
                    NumberEconomic =PS.Purchaser.NumberEconomic 
                }).ToList(); 
return lst; 
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-13T13:34:56.237

返回类型将是`List of type Products`

```
public static List<Products> GetList()
{
    Entity conn = new Entity();
    var lst = (from PS in conn.PurchaserSpecials
            select new
            {
                PS.PurchaserID,
                PS.PurchaserSerial,
                PS.Purchaser.Address,
                PS.Purchaser.Fax,
                PS.Purchaser.NumberEconomic
            }).ToList();
    return lst;
}

public class Products
{
    //Properties you are using in the query.
} 
```

# ios - 如何获取 UIImagePicker 选择的图像名称？

> ID：11471254
> 
> 赞同：3
> 
> 时间：2012-07-13T13:14:24.153
> 
> 标签：ios, image, uiimagepickercontroller

有谁知道在呈现 UIImagePickerController 后如何获取选定的图像名称（来自照片库的名称）？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-13T13:49:20.927

[在ALAsset](http://developer.apple.com/library/ios/#DOCUMENTATION/AssetsLibrary/Reference/ALAsset_Class/Reference/Reference.html#//apple_ref/occ/cl/ALAsset)的帮助下，您可以实现这一目标。

第 1 步：`Asset`从`UIImagePicker`

第 2 步：获取[ALAssetRepresentation](http://developer.apple.com/library/ios/#DOCUMENTATION/AssetsLibrary/Reference/ALAssetRepresentation_Class/Reference/Reference.html)。`Asset`

第 3 步：`ALAssetRepresentation`类有一个名为`fileName`

```
- (NSString *)filename 
```

返回一个字符串，表示磁盘上表示的文件名。

此示例代码将帮助您...

```
- (void)imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *)info {

    NSURL *imageURL = [info valueForKey:UIImagePickerControllerReferenceURL];
    ALAssetsLibraryAssetForURLResultBlock resultblock = ^(ALAsset *myasset)
    {
        ALAssetRepresentation *representation = [myasset defaultRepresentation];
        NSString *fileName = [representation filename];
        NSLog(@"fileName : %@",fileName);
    };

    ALAssetsLibrary* assetslibrary = [[[ALAssetsLibrary alloc] init] autorelease];
    [assetslibrary assetForURL:imageURL 
                   resultBlock:resultblock
                  failureBlock:nil];

} 
```

注意：它仅适用于**iOS 5**及更高版本。

# ruby - Ruby：如何计算相对于另一个路径的路径？

> ID：11471261
> 
> 赞同：42
> 
> 时间：2012-07-13T13:15:00.743
> 
> 标签：ruby, relative-path

假设我知道我开始的绝对路径和我试图到达的绝对路径：

```
first = '/first/path'
second = '/second/path' 
```

现在我想弄清楚如何构建一个相对于第一个路径。例如：

```
# answer should be /first/path/../../second/path
path = second.get_path_relative_to(first) 
```

我怎样才能在 Ruby 中做这种事情？

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2012-07-13T13:29:53.090

使用[`Pathname#relative_path_from`](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/pathname/rdoc/Pathname.html#method-i-relative_path_from)：

```
require 'pathname'

first = Pathname.new '/first/path'
second = Pathname.new '/second/path'

relative = second.relative_path_from first
# ../../second/path

first + relative
# /second/path 
```

# actionscript-3 - 如何在我的泡泡射击游戏中制作新的泡泡堆叠？

> ID：11471264
> 
> 赞同：1
> 
> 时间：2012-07-13T13:15:29.667
> 
> 标签：actionscript-3

我正在制作一款泡泡射击游戏，我正在尝试让我正在发射的泡泡堆叠起来，然后在列中的正确位置。我放在板上的气泡如下所示：

```
000000000000000
 000000000000000
000000000000000
 000000000000000 
```

有 4 行，有 15 个气泡。这是我到目前为止写的代码：

**主要的**

```
package  {
import flash.display.Sprite;
import flash.events.KeyboardEvent;
import flash.events.Event;
import flash.display.SpreadMethod;

public class Main extends Sprite {
    private const ROT_SPEED:uint=2;
    private const R:uint=18;
    private const DEG_TO_RAD:Number=0.0174532925;
    private const BUBBLE_SPEED:uint=10;
    private var bubbleArr:Array=new Array();
    private var loadArr:Array=new Array();
    private var cannon:cannon_mc;
    private var bubble:bubble_mc;
    private var row:uint=0;
    private var col:uint=0;
    private var left:Boolean=false;
    private var right:Boolean=false;
    public var bubCont:Sprite;
    private var loadCont:Sprite;
    private var fire:Boolean=false;
    private var vx,vy:Number;
    public function Main() {
        placeContainer();
        placeCannon();
        loadBubble();
        stage.addEventListener(KeyboardEvent.KEY_DOWN,onKDown);
        stage.addEventListener(KeyboardEvent.KEY_UP,onKUp);
        addEventListener(Event.ENTER_FRAME,onEFrame);
        trace("row= "+row+" , col= "+col);
    }
    private function placeCannon():void {
        cannon=new cannon_mc();
        addChild(cannon);
        cannon.y=385.5;
        cannon.x=320;
    }
    private function onKDown(e:KeyboardEvent):void {
        switch(e.keyCode) {
            case 37 :
                left=true;
                break;
            case 39 :
                right=true;
                break;
            case 38 :
                if (! fire) {
                    fire=true;
                    var radians=(cannon.rotation-90)*DEG_TO_RAD;
                    vx=BUBBLE_SPEED*Math.cos(radians);
                    vy=BUBBLE_SPEED*Math.sin(radians);
                }
                break;
        }
    }
    private function onKUp(e:KeyboardEvent):void {
        switch(e.keyCode) {
            case 37 :
                left=false;
                break;
            case 39 :
                right=false;
                break;
        }
    }
    private function onEFrame(e:Event):void {
        if (left) {
            cannon.rotation-=ROT_SPEED;
        }
        if (right) {
            cannon.rotation+=ROT_SPEED;
        }
        if (fire) {
            bubble.x+=vx;
            bubble.y+=vy;
            if (bubble.x<59) {
                bubble.x=59;
                vx*=-1;
            }
            if (bubble.x>(59+R*R)) {
                bubble.x=59+R*R;
                vx*=-1;
            }
            if (bubble.y<(40)) {
                bubble.y=40;
            } 
        }
    }

    public function placeContainer():void {
        var iRow:Boolean=false;
        bubCont=new Sprite();
        addChild(bubCont);
        for (var i:uint=0; i<4; i++) {
            if (! iRow) {
                for (var j:uint=0; j<15; j++) {
                    bubbleArr[i]=new Array();
                    bubbleArr[i][j]=Math.floor(Math.random()*6);
                    bubble = new bubble_mc(bubbleArr[i][j],i,j);
                    bubCont.addChild(bubble);
                    iRow=true;
                    row++;
                    col++;
                }
            } else {
                for (j=0; j<15; j++) {
                    bubbleArr[i]=new Array();
                    bubbleArr[i][j]=Math.floor(Math.random()*6);
                    bubble = new bubble_mc(bubbleArr[i][j],i,j);
                    bubble.x=77+j*2*R;
                    bubCont.addChild(bubble);
                    iRow=false;
                    row++;
                    col++;
                }
            }
        }
    }
    private function loadBubble():void {
        addChild(bubble);
        bubble.gotoAndStop(Math.floor(Math.random()*6))+1;
        bubble.x=320;
        bubble.y=410;
    }
} 
```

**bubble_mc 类：**

```
package  {
import flash.display.MovieClip;
public class bubble_mc extends MovieClip {
    public function bubble_mc(val:uint,row:uint,col:uint) {
        gotoAndStop(val+1);
        name=row+"_"+col;
        x=59+col*36;
        y=40+row*32;
    }
} 
```

我绝对不知道如何将气泡堆叠在一起。我尝试使用 hitTestObject-function 并且尝试编写自己的函数来检查碰撞，然后调用应该将气泡放置在正确位置的函数，但它不起作用，我不知道为什么。我收到一个名为 TypeError: Error #1010 的错误。这是碰撞函数和 parkBubble 函数——它应该将气泡放置在正确的位置：

```
private function parkBubble(bubble:bubble_mc,row:int,col:int):void {
        var iRow:Boolean=false;
        for (var j:uint=0; j<col; j++) {
            trace("first for loop ");
            for (var i:uint=row; i>0; i--) {
                trace("second for loop ");
                if (bubbleArr[i][j]!=null) {
                    trace("first if loop ");
                    if (! iRow) {
                        trace("second if loop ");
                        bubbleArr[i+1]=new Array();
                        bubbleArr[i+1][j]=Math.floor(Math.random()*6);
                        bubble = new bubble_mc(bubbleArr[i+1][j],(i+1),j);
                        bubCont.addChild(bubble);
                        iRow=true;
                        row++;
                        col++;
                    } else {
                        trace("first for loop after else ");
                        bubbleArr[i+1]=new Array();
                        bubbleArr[i+1][j]=Math.floor(Math.random()*6);
                        bubble = new bubble_mc(bubbleArr[i+1][j],(i+1),j);
                        bubble.x=77+j*2*R;
                        bubCont.addChild(bubble);
                        iRow=false;
                        row++;
                        col++;
                    }
                }
            }
        }
        removeChild(bubble);
        fire=false;
        loadBubble();
        trace("slutet av parkBubble ");
    }

private function collide(bub:bubble_mc):Boolean {
        var dist_x:Number=bub.x-bubble.x;
        var dist_y:Number=bub.y-bubble.y;
        return Math.sqrt(dist_x*dist_x+dist_y*dist_y)<=2*R-4;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-15T22:57:50.457

这条线上有 TypeError 吗？

```
 var placed_bubble:bubble_mc=new bubble_mc([row][col],row,col); 
```

[row] 是一个数组，[col] 是一个数组。但是构造函数需要一个无符号整数：

```
 public function bubble_mc(val:uint,row:uint,col:uint) { 
```

为了将气泡复制到气泡容器，请传递帧号：

```
 var placed_bubble:bubble_mc=new bubble_mc(bubble.currentFrame-1, row, col); 
```

这可能不是唯一的问题。TypeError 通常是由未定义的变量引起的，这可能来自修改变量“bubble”的其他代码。例如，placeContainer 将容器中的气泡分配给变量“bubble”。

函数 parkBubble 总是将“iRow”设置为 false，但如果气泡与它上方的一行发生碰撞，那么你希望 iRow 为 true。

```
 var row:uint=Math.floor(bubble.y/(40+R*Math.sqrt(3)));
    var iRow:Boolean= row % 2 == 1 ? true : false; 
```

至少在编译之后，如果您返回并使用一些常量名称简化和优化数学，您将遇到更少的问题。然后你会更容易看到上面计算行的代码不太对。它应该减去上边距 (40)。这对于命名常量很明显：

```
 private const Y_PER_ROW:int = int(R * Math.sqrt(3));
    private const TOP:int = 40;
    ...
    var row:uint = int((bubble.y - TOP) / Y_PER_ROW); 
```

我也会仔细检查你的其他计算。Puzzle Bobble 游戏通常将奇数行设置为半径水平偏移，而不是半径 2 (2 * R)。所以它们像六边形一样组合在一起。

placeContainer 函数可以简化。偶数行或奇数行中的大部分代码都是相同的，因此可以从 if 块中取出。在您发布的这段代码中，我不明白为什么您需要在 placeContainer 中使用“row++”和“col++”。这是等效的并且更易于阅读：

```
 for (var i:uint=0; i<4; i++) {
            var xOffset:int = (i % 2) * 2 * R;
            for (var j:uint=0; j<15; j++) {
                bubbleArr[i] = new Array();
                bubbleArr[i][j] = int(Math.random()*6);
                bubble = new bubble_mc(bubbleArr[i][j], i, j);
                bubble.x += xOffset;
                bubCont.addChild(bubble);
                row++;
                col++;
            }
    } 
```

然后，可以简化和优化碰撞检测代码，避免气泡远离时的计算，避免昂贵的平方根计算：

[圆形碰撞检测 HTML5 Canvas](https://stackoverflow.com/questions/11278783/circle-collision-detection-html5-canvas)

[http://cgp.wikidot.com/circle-to-circle-collision-detection](http://cgp.wikidot.com/circle-to-circle-collision-detection)

# .net - 如何防止在 FormClosing 事件中关闭和处置 Winform？

> ID：11471266
> 
> 赞同：3
> 
> 时间：2012-07-13T13:15:41.490
> 
> 标签：.net, winforms, delphi-prism, oxygene, formclosing

这个问题似乎是重复的，但我在测试程序时遇到了这个问题，我对你如何解决它感到有点困惑。

我有一个 winform，它有一个表单关闭事件。在这种情况下，我会弹出一个消息框，询问用户“你确定要关闭窗口吗？”。如果他们按下是按钮，应用程序将关闭窗口并阻止它按预期进行处理。所以，我可以再次打开它。但是，如果他们没有按任何按钮，它仍然会关闭窗口，但现在窗口已被释放。因此，当我尝试再次打开它时，它引发了一个异常，“无法访问已处置的对象”。当按下 No 按钮时，我希望 winform 保持打开状态而不被处理。

这是我的代码：

```
method PPMain.PPMain_FormClosing(sender: System.Object; e: System.Windows.Forms.FormClosingEventArgs);
begin
       if MessageBox.Show('Are you sure you want to close the window?','PPMain',MessageBoxButtons.YesNo) = DialogResult.Yes then
       begin
             e.Cancel := true; 
             Hide; 
       end
       else
             e.Cancel := false;
end; 
```

我想既然你必须设置 e.Cancel = true 来关闭窗口并告诉它隐藏，做相反的事情（e.Cancel = false 并且不隐藏）将阻止 winform 关闭和被处理。

你如何解决这个问题？

预先感谢，

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-13T13:19:44.580

`e.Cancel = true`防止窗口关闭 - 它停止关闭事件。

`e.Cancel = false`允许“关闭事件”继续（导致窗口关闭并被处置；假设没有其他事情阻止它）。

**看来你想这样做：**

```
method PPMain.PPMain_FormClosing(sender: System.Object; e: System.Windows.Forms.FormClosingEventArgs);
begin
      e.Cancel := true; 
      if MessageBox.Show('Are you sure you want to close the window?','PPMain',MessageBoxButtons.YesNo) = DialogResult.Yes then
      begin
            Hide; 
      end
end 
```

`e.Cancel := true;`防止窗口关闭。然后提示用户，如果他们说是`Hide;`隐藏窗口（不处理）。如果用户单击否，则不会发生任何事情。

检测正在执行哪种关闭操作可能是一个好主意。使用`e.CloseReason`以免阻止在操作系统关闭期间关闭或类似的东西。

像这样：

```
method PPMain.PPMain_FormClosing(sender: System.Object; e: System.Windows.Forms.FormClosingEventArgs);
begin
      if e.CloseReason = System.Windows.Forms.CloseReason.UserClosing then
      begin
           e.Cancel := true; 
           if MessageBox.Show('Are you sure you want to close the window?','PPMain',MessageBoxButtons.YesNo) = DialogResult.Yes then
           begin
                 Hide;
           end
      end
end 
```

# c# - 带空格的变量名

> ID：11471267
> 
> 赞同：-4
> 
> 时间：2012-07-13T13:15:42.043
> 
> 标签：c#, asp.net, linq, gridview

我想要一个带有空格的变量名。我将这个集合传递给 gridview，我需要标题有一个空格而不是下划线

```
var registrationReport = (from r in BankMedEntity.Customers
                      select new {r.Id,Customer Type =  r.CustomerType_Id }); 
```

关于我如何做到这一点的任何想法？

我需要将标题设为“客户类型”而不是“客户类型_Id”

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-13T13:16:51.010

你不能，c# 不允许在变量名中使用空格。它们会被认为是不同的词，编译器会“啊……你是什么意思？”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T13:20:08.993

变量名中不允许有空格。
如果您想要不带下划线的 gridview 标题，您应该在 .aspx 文件中编辑 girdview 定义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T13:18:12.497

不幸的是，这是不可能的；编译器无法确定这两个单独的词实际上是同一个变量名的一部分。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-13T13:46:14.207

将此设置为假

```
AutoGenerateColumns="True" 
```

并将您自己的绑定列添加到 Gridview。您将能够为列指定您想要的任何名称

# xcode - 如何在特定语句验证为真时触发动作？

> ID：11471269
> 
> 赞同：0
> 
> 时间：2012-07-13T13:15:44.730
> 
> 标签：xcode, if-statement, timer, triggers

在 Xcode 中，您可以检查何时按下按钮，整数是 9（转到该页面）还是 7（转到其他页面）。例如，当数字变为 60 时，有没有办法自动触发动作？我知道您可以使用计时器来执行此操作，该计时器每秒检查一次`if`语句是否为`true`. 但是还有其他方法可以达到同样的效果吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T22:38:07.673

大多数调试器可以监视内存位置并在该位置的内容更改时中断应用程序。因此，如果您想找出发生变化的*原因*和*位置*，这就是您的方式。如果您希望用户界面在正常（即非调试）操作期间响应该更改，那么您最好在更改的位置添加一些代码，以传递该事件。

# c# - UpdateCommand 因 DateTime 列而失败

> ID：11471273
> 
> 赞同：0
> 
> 时间：2012-07-13T13:16:01.650
> 
> 标签：c#, oracle, dataset

我正在尝试为 制作通用更新功能`OracleDataAdapter`，但是当我尝试更新 DataTable 时它失败了。
错误消息是`Failed to convert value from a Int32 to a DateTime`。
在 DataTable 中，这些值是完全形成的 DataTime 值，所以我不明白更新命令在哪里失败......有什么提示吗？

```
private void CreateUpdate()
{
    //UPDATE "TABLE" SET "AD_USERID" = :AD_USERID,  WHERE (("AD_USERID" = :Original_AD_USERID) AND ("MODULE" = :Original_MODULE))
    DataTable tbl = _DsViews.Tables[_DbName];
    string value = string.Empty;
    string where = string.Empty;
    foreach (DataColumn col in tbl.Columns)
    {
        value += string.Format("\"{0}\" = :{0},", col.ColumnName.ToUpper());
        where += string.Format("(\"{0}\" = :Original_{0}) AND ", col.ColumnName.ToUpper());
    }
    value = value.Substring(0, value.Length - 1);
    where = where.Substring(0, where.Length - 5);
    string sql = string.Format("UPDATE \"{0}\"  SET {1} WHERE ({2})", _DbName, value, where);
    ta.UpdateCommand = new OracleCommand(sql, MyDBConnection);

    foreach (DataColumn col in tbl.Columns)
    {
        var para1 = ta.UpdateCommand.Parameters.Add(col.ColumnName.ToUpper(), GetOraType(col.DataType));
        para1.SourceColumn = col.ColumnName;
        para1.SourceColumnNullMapping = col.AllowDBNull;

        var para2 = ta.UpdateCommand.Parameters.Add("Original_" + col.ColumnName.ToUpper(), GetOraType(col.DataType));
        para2.SourceColumn = col.ColumnName;
        para2.SourceVersion = DataRowVersion.Original;
        para2.SourceColumnNullMapping = col.AllowDBNull;
    }
}

OracleType GetOraType(System.Type type)
{

    switch (Type.GetTypeCode(type))
    {
        case TypeCode.Boolean:
        case TypeCode.Byte:
            return OracleType.Byte;
        case TypeCode.Char:
            return OracleType.Char;
        //case TypeCode.DBNull:
        //    return OracleType
        case TypeCode.DateTime:
            return OracleType.DateTime;
        case TypeCode.Decimal:
        case TypeCode.Double:
            return OracleType.Number;
        //case TypeCode.Empty:
        case TypeCode.Int16:
            return OracleType.Int16;
        case TypeCode.Int32:
            return OracleType.Int32;
        case TypeCode.Int64:
            return OracleType.Number;
        case TypeCode.Object:
            return OracleType.Blob;
        case TypeCode.SByte:
            return OracleType.SByte;
        case TypeCode.Single:
            return OracleType.Float;
        case TypeCode.String:
            return OracleType.NVarChar;
        case TypeCode.UInt16:
            return OracleType.UInt16;
        case TypeCode.UInt32:
            return OracleType.UInt32;
        case TypeCode.UInt64:
            return OracleType.Number;
        default:
            return OracleType.VarChar;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T13:34:11.263

通常 SQL 认为不在引号 '' 内的任何内容都是数字，通常您将日期字符串传递给 SQL 以比较/设置日期/时间。尝试围绕您的日期/时间值进行报价

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T11:15:14.673

Ms 有一种处理空值的特殊方式，所以我们也需要为它们添加参数。此代码将为 DataTables 生成更新命令

```
 private void CreateUpdate()
    {
        //UPDATE "TABLE" SET "AD_USERID" = :AD_USERID,  WHERE (("AD_USERID" = :Original_AD_USERID) AND ("MODULE" = :Original_MODULE)) AND ((:IsNull_MODIFIED_BY = 1 AND ""MODIFIED_BY"" IS NULL) OR (""MODIFIED_BY"" = :Original_MODIFIED_BY))
        DataTable tbl = _DsViews.Tables[_DbName];
        string value = string.Empty;
        string where = string.Empty;
        foreach (DataColumn col in tbl.Columns)
        {
            value += string.Format("\"{0}\" = :{0},", col.ColumnName.ToUpper());
            if (GetOraType(col.DataType) == OracleType.Blob)
                continue;
            if (col.AllowDBNull || col.DataType == typeof(DateTime))
                where += string.Format("((:IsNull_{0} = 1 AND \"{0}\" IS NULL) OR (\"{0}\" = :Original_{0})) AND ", col.ColumnName.ToUpper());
            else 
                where += string.Format("(\"{0}\" = :Original_{0}) AND ", col.ColumnName.ToUpper());
        }

        value = value.Substring(0, value.Length - 1);
        where = where.Substring(0, where.Length - 5);
        string sql = string.Format("UPDATE \"{0}\"  SET {1} WHERE ({2})", _DbName, value, where);
        ta.UpdateCommand = new OracleCommand(sql, MyDBConnection);

        foreach (DataColumn col in tbl.Columns)
        {
            ta.UpdateCommand.Parameters.Add(new OracleParameter(col.ColumnName.ToUpper(), GetOraType(col.DataType), 0, ParameterDirection.Input, col.ColumnName.ToUpper(), DataRowVersion.Current, false, null));
            if (GetOraType(col.DataType) == OracleType.Blob)
                continue;
            if (col.AllowDBNull || col.DataType == typeof(DateTime))
                ta.UpdateCommand.Parameters.Add(new OracleParameter("IsNull_" + col.ColumnName.ToUpper(), OracleType.Int32, 0, ParameterDirection.Input, col.ColumnName.ToUpper(), DataRowVersion.Original, true, null));
            ta.UpdateCommand.Parameters.Add(new OracleParameter("Original_" + col.ColumnName.ToUpper(), GetOraType(col.DataType), 0, ParameterDirection.Input, col.ColumnName.ToUpper(), DataRowVersion.Original, false, null));
        }
    } 
```

# javascript - 使用 jquery 对话框时单击按钮时始终返回 true

> ID：11471276
> 
> 赞同：0
> 
> 时间：2012-07-13T13:16:26.990
> 
> 标签：javascript, jquery

我正在使用 jquery 对话框。当我单击按钮弹出窗口打开但它返回 true 并执行按钮的服务器端事件。

我想当用户点击是然后返回true，否则返回false。

```
 function btnCancelClick()
            {
                $("#dialog:ui-dialog").dialog("destroy");

                $("#dialog-confirm").dialog({
                    resizable: false,
                    height: 140,
                    width: 400,
                    modal: true,
                    buttons: {
                        "Yes": function ()
                        {                       
                            $(this).dialog("close");
                                  return true;
                        },
                        No: function ()
                        {                       
                            $(this).dialog("close");
                                return false;
                        }
                    }

                });             
            }

    <asp:Button ID="btnCancel" runat="server" Text="Cancel Appointment" CssClass="cssbutton"
                                    OnClientClick="return btnCancelClick();" OnClick="btnCancel_Click" /> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T13:17:41.530

您**不能** `return`从对话框中。

您必须使用回调函数。

```
$("#dialog-confirm").dialog({
    resizable: false,
    height: 140,
    width: 400,
    modal: true,
    buttons: {
        Yes: function() {
            $(this).dialog("close");
            clickedYes(); //YES CALLBACK
        },
        No: function() {
            $(this).dialog("close");
            clickedNo(); //NO CALLBACK
        }
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T13:49:14.297

更新您的`btnCancelClick`方法以始终返回 false。然后在对话框按钮处理程序中，而不是 return true 或 false 在那里做你的回发。

```
function btnCancelClick() {
    $("#dialog:ui-dialog").dialog("destroy");

    $("#dialog-confirm").dialog({
        resizable: false,
        height: 140,
        width: 400,
        modal: true,
        buttons: {
            "Yes": function () {
                $(this).dialog("close");
                <%=ClientScript.GetPostBackEventReference(btnCancel, "")%>;
            },
            No: function () {
                $(this).dialog("close");
            }
        }
    });
    return false;
} 
```

这一行：

`<%=ClientScript.GetPostBackEventReference(btnCancel, "")%>`

将 javascript 回发调用注册到您的`btnCancelClick`方法中。

# java - 我开始时的某些事情导致应用程序崩溃。如果有人可以提供帮助，我会很新鲜

> ID：11471283
> 
> 赞同：0
> 
> 时间：2012-07-13T13:16:42.270
> 
> 标签：java, android

catlog 说第一个 for 循环完成，而崩溃发生在第二个循环。这是`init`一个非常简单的游戏的方法。

```
private void init()

{

            Resources res = this.getResources();

            int x=R.drawable.crystal0000;
            for(int i=0;i<=100;i++)// This for completes
            {
                Bitmap b=BitmapFactory.decodeResource(res, x+i);
                Log.d("crystalframes loaded", Integer.toString(i));
                crystalframes[i]=Bitmap.createScaledBitmap(b, 20, 20, false);
            }// Nothing after this points goes trough 
             x = R.drawable.frame0;
            for (int i = 0; i < 10; i++) {
                Bitmap t = BitmapFactory.decodeResource(res, x + i);
                Log.d("frame", Integer.toString(i));
                frames[i] = Bitmap.createScaledBitmap(t, 40, 40, false);
            }
            x = R.drawable.rframe0;
            for (int i = 0; i < 10; i++) {
                Bitmap t = BitmapFactory.decodeResource(res, x + i);
                Log.d("frame", Integer.toString(i));
                frames[i + 10] = Bitmap.createScaledBitmap(t, 40, 40, false);
            }
            // Code continues from the here but the crash is caused somewhere 
```

在这些行中

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T13:22:21.973

可能你是`crystalframes`这样创建的：

```
crystalframes = new Bitmap[100]; 
```

但是您需要 101 的大小，因为您这样做了：

```
for(int i=0;i<=100;i++)// This for completes 
```

你也可能内存不足。

# java - Eclipse 重构：更改所有子类的构造函数方法签名

> ID：11471286
> 
> 赞同：5
> 
> 时间：2012-07-13T13:16:49.107
> 
> 标签：java, eclipse, refactoring

在eclipse中，有没有办法重构超类构造函数方法签名，以便所有具有相同签名的子类构造函数也以相同的方式重构？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T13:27:05.073

double left click on signature, then right click --> Refactor --> Change method signature.

# xquery - 使用 xquery 物理移动文档

> ID：11471290
> 
> 赞同：0
> 
> 时间：2012-07-13T13:16:51.947
> 
> 标签：xquery, marklogic

我可以使用 xquery/Marklogic 将文档从一个文件夹物理移动到另一个文件夹吗？如果是，请详细说明。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T22:10:56.267

我不确定我是否理解这个问题。为什么“身体”运动很重要？数据库将文档的物理存储从开发人员那里抽象出来。如果您正在管理 MarkLogic 数据库，您可以将森林、数据和索引所在的物理分区放在不同的位置。不过，我怀疑这不是你要问的。您能否提供有关您要解决的问题的更多详细信息？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T22:51:08.053

不。

据我所知，MarkLogic 中唯一直接访问文件系统的 XQuery 函数是：

xdmp：文件系统目录，xdmp：文件系统文件，xdmp：文件系统文件存在，xdmp：文件系统文件长度，xdmp：文档加载，xdmp：文档保存

MarkLogic 特别不允许您执行命令或直接修改主机操作系统的文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T16:47:47.683

我也想知道您所说的“移动文档”是什么意思……这些 MarkLogic 文档还是文件系统文档？在这种情况下，什么是“文件夹”？如果这是一个 marklogic 文档，您的意思是将 URI 放在不同的“目录”中吗？

最接近标记逻辑文档“物理移动”的方法是更改​​其 URI。没有内置函数可以做到这一点，但 xmlsh 很久以前通过在邮件列表中复制一些代码来支持这一点。您可以在此处查看策略

[http://xmlsh.svn.sourceforge.net/viewvc/xmlsh/extensions/marklogic/src/org/xmlsh/marklogic/resources/rename.xquery?revision=730&view=markup](http://xmlsh.svn.sourceforge.net/viewvc/xmlsh/extensions/marklogic/src/org/xmlsh/marklogic/resources/rename.xquery?revision=730&view=markup)

# operating-system - 内存地址 cpu 8 位总线和 16 位地址总线

> ID：11471293
> 
> 赞同：1
> 
> 时间：2012-07-13T13:16:58.200
> 
> 标签：operating-system

嗨，我如何找到以十六进制表示的最高和最低内存位置以及以 K 表示的可寻址内存位置的数量。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T13:31:22.713

16 位地址总线可以访问 64 kb 的内存。

最低和最高可寻址内存位置只是最低和最高 16 位数字，即 0x0000 和 0xffff。但是，根据硬件和操作系统的不同，可用 RAM 可能会更小。最低的内存区域通常由操作系统使用，最高的内存区域可以覆盖 ROM 或保留用于硬件接口。

# java - Beginner-jJava-Amazon Elastic Beanstalk-无法正确指定运行状况检查 url-还有什么是基本 url

> ID：11471296
> 
> 赞同：0
> 
> 时间：2012-07-13T13:17:24.043
> 
> 标签：java, amazon-web-services, amazon-elastic-beanstalk

我已经用 Java 创建了一个示例 Web 应用程序。它没有错误，并且我能够成功创建 WAR 存档。我还在本地 Tomcat 7 服务器上成功测试了这个。

现在，这个示例 Web 应用程序有 2 个 servlet——“home”和“runsinglecrawljob”。战争档案的名称是“sparkcrawler0.12.war”。

因此，在本地 Tomcat 中，我访问了 Web 应用程序

```
 http://localhost:8080/SparkCrawler0.12/runsinglecrawljob 
```

另一个 servlet 是

```
 http://localhost:8080/SparkCrawler0.12/home 
```

现在，当我创建 Elastic Beanstalk 环境时，我指定了运行状况检查 url="/home"

但是我收到错误消息，即运行状况检查 url 没有响应，因此该应用程序没有在 Elastic Beanstalk 中运行-它显示 503 错误-根据 Google Chrome，这是确切的消息-

“HTTP 错误 503（服务不可用）：服务器当前无法处理请求。此代码表示这是暂时的情况，服务器将在延迟后再次启动。”

现在，健康检查 URL 的正确值是多少？

另外，如果我的网址是

```
 http://spark.elasticbeanstalk.com 
```

如 Elastic Beanstalk 中所定义，那么我是否可以在以下位置访问 Web 应用程序

```
 http://spark.elasticbeanstalk.com/SparkCrawler0.12/runsinglecrawljob 
```

或者我是否可以在以下位置访问网络应用程序

```
 http://spark.elasticbeanstalk.com/runsinglecrawljob ? 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T23:23:03.303

我不知道这是否相关，但我有一个非常相似的问题，但使用的是 PHP codeigniter 应用程序。

我上传了应用程序，'index.php' 是应用程序的正常起点。我还有一个与 index.php 平行的简单“phpinfo.php”。

所以，URL 是 myApp.elasticbeanstalk.com ，它点击 index.php 并且没问题。

但是，对于我的健康检查，我将其设置为 /phpinfo.php，因为我希望将 myApp.elasticbeanstalk.com/phpinfo.php 用作健康检查。

如果我这样做，健康检查总是会失败，所以我的应用程序不会运行，我会看到刺眼的厄运红色框。

这一直让我发疯。

（我为什么要这样做？--这是因为我想向应用程序根目录添加一个 .htaccess 文件，该文件需要为除 phpinfo.php 文件之外的所有内容提供密码，并且我在本地对其进行了测试并且它有效。我没有添加 .htaccess 文件——我只是想看看我是否可以将运行状况检查指向“/”之外的其他内容并让它工作。

更新——我解决了我的问题。事实证明，当我启动这些弹性 beanstalk 环境之一时，我必须立即设置 healthcheck url 并且有 /phpinfo.php 然后上传我的应用程序。当我早些时候对此大惊小怪时，我稍后会尝试编辑配置以更改运行状况检查 url，但这永远不会起作用，并且实例将永远不会再次活跃。

# language-agnostic - 什么语言功能可以允许从访问者到序列的转换？

> ID：11471306
> 
> 赞同：0
> 
> 时间：2012-07-13T13:18:10.993
> 
> 标签：language-agnostic, ienumerable, sequence, visitor-pattern

我将使用 C# 语法，因为我熟悉它，但它并不是真正特定于语言的。

* * *

假设我们想提供一个 API 来检查 a`Tree`并对每个`Node`.

解决方案 1：`void Visit(Tree tree, Action<Node> action)`
它需要一个`tree`, 并调用`action`树中的每个节点。

解决方案 2：`IEnumerable<Node> ToEnumerable(Tree tree)`
它转换`tree`为一个扁平的惰性序列，这样我们就可以遍历并调用`action`每个节点。

* * *

现在，让我们看看如何将一种 API 转换为另一种。

`Visit`在以下基础上提供非常简单`ToEnumerable`：

```
void Visit(Tree tree, Action<Node> action) {
    ToEnumerable(tree).ForEach(action);
} 
```

但是，是否有任何语言的概念/功能可以提供`ToEnumerable`（`Visit`作为惰性序列，因此不会提前创建列表）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T14:58:44.190

如果您正在编写将访问每个节点的代码（如使用树），则可以让迭代器为每个分支调用迭代器，并`yield return`在叶节点上执行 a。这种方法可行，而且非常简单，但有一个严重的缺点，即很容易得到可读性很强但执行速度很慢的代码。该站点上的其他一些问题和答案将提供有关如何在迭代器中有效地遍历树的见解。

如果“树”只是一个示例，而您真正拥有的是一个类，该类公开了一个例程以在每个节点上调用某个委托（类似于`List.ForEach()`），但不公开`IEnumerable`，您可以使用前者来生成a `List`，然后您可以对其进行迭代。使用类似的东西`var myList = new List<someThing>(); myCollection.ForEach( (x) => myList.Add(x) );`，然后你就可以枚举`myList`.

如果这还不够，因为添加到列表中的对象在枚举完成时可能无效，在极少数情况下可能会使用多线程来完成所需的操作。例如，如果您有两个已排序的集合，其`ForEach`方法准备每个项目以供使用，执行指定的操作，然后在继续下一个项目之前清理每个项目，并且如果您需要交错对来自两个*独立*集合的项目的操作，一个可能能够在单独的线程上迭代集合，并使用同步原语，因此每个线程将根据需要等待另一个线程。

请注意，仅通过`ForEach`方法公开自身的集​​合很容易在执行此类 a 期间限制访问`ForEach`（如果不需要这种限制，他们可能会实现`IEnumerable`）。一个人调用的“项目操作”可能会在同一线程上的同一集合上`ForEach`执行另一个操作，因为后者必须在前者恢复之前完成。但是，当一个线程正在运行时，尝试在第二个线程上调用 a 可能会发生故障或等待第一个操作完成。如果第一个在第二个之前等待某个动作，就会导致死锁。正因为如此，多线程的场景比简单地构建一个`ForEach``ForEach``ForEach``ForEach``ForEach``List`很少见。尽管如此，在少数情况下它可能会有所帮助（例如，上面提到的独立集合上的“拉链”操作）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T13:27:06.143

Not sure if I understand you correctly, but in Python, you can create iterable interface on any object. So you would just add special method `__iter__` (which will yield nodes while traversing the tree). The `visit` procedure is then just about iterating through `Tree` object and calling `action` on each node.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-14T13:25:33.670

我想现在我明白了这个想法。我在这里需要的概念称为[一流的延续](http://en.wikipedia.org/wiki/Continuation)，或者特别是[call/cc](http://en.wikipedia.org/wiki/Call-with-current-continuation)。对我来说令人困惑的是，C# 已经在 中提供了这个概念的有限实现`yield return`，但它不适用于我的场景。

因此，如果 C# 提供完整的实现，解决方案将如下所示：

```
IEnumerable<Node> ToEnumerable(Tree tree) {
    tree.Visit(node => magic yield return node);
} 
```

where`magic yield return`不是从`node => ...`lambda 返回序列，而是从 . 返回下一个元素`ToEnumerable`。

但是，这个答案仍然不完整，因为我没有看到 和 之间的确切相关`yield return`性`call/cc`。当我理解这一点时，我会更新答案。

# c# - 单击mvc3中webgrid中的链接后弹出窗口

> ID：11471308
> 
> 赞同：1
> 
> 时间：2012-07-13T13:18:13.097
> 
> 标签：c#, asp.net-mvc-3, razor

我有一个 webgrid，它在 mvc3 中有**href**链接。

现在，当单击链接时，将返回响应，其中包含一些我想在弹出窗口上显示的服务器记录（在单击该链接后在控制器中运行新查询后，数据将来自服务器，而不是在弹出窗口中显示窗户）。

但我不想打开一个新窗口。我想在同一浏览器页面上的弹出窗口中打开它。

我不知道他们使用 jQuery 或 AJAX 的天气。但我想实现相同的功能。

请帮助我实现这一目标

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T13:32:03.487

您可以使用任何`jQuery`提供弹出窗口的插件来执行此操作。有几个选项可用，如 fancybox、SimpleModel、Colorbox、jQuery UI 对话框、thickbox 等。

这就是您将如何使用[jQuery UI](http://jqueryui.com/demos/dialog/)对话框。

**第 1 步）** 在您的页面（或布局页面）中包含 jQuery 和 jQuery UI 库。您可以参考来自 CDN 的副本的本地副本。

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js" type="text/javascript"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.min.js" type="text/javascript"></script>
<link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/themes/base/jquery-ui.css" rel="stylesheet" type="text/css" /> 
```

**步骤 2)** 在您的网格中，`css`为链接指定一个类名，以便我们可以将其用于 jQuery 选择。这里我给了一个 CSS 类`popupLink`

```
@Html.ActionLink("Scott", "Details", "Customers",
                new { @Id = "someId" }, new { @class = "popupLink" }) 
```

**步骤 3)** 现在启用 jQuery UI 对话框功能到具有此特定 CSS 类的链接

```
<script type="text/javascript">
$(function(){
    $(".popupLink").click(function (e) {
        var url = this.href;
        var dialog = $("#dialog");
        if ($("#dialog").length == 0) {
            dialog = $('<div id="dialog" style="display:hidden"></div>').appendTo('body');
        }
        dialog.load(
            url,
            {}, // omit this param object to issue a GET request instead a POST request, otherwise you may provide post parameters within the object
            function (responseText, textStatus, XMLHttpRequest) {
                dialog.dialog({                       
                    close: function (event, ui) {                            
                        dialog.remove();
                    },
                    modal: true,                        
                    width: 460, resizable: false
                });
            }
        );           
        return false;           
    });
});
</script> 
```

因此，每当用户单击这些链接时，它都会调用该链接的 HREF 属性值（该操作方法）并获取结果并将显示在弹出窗口中。

确保您有处理此请求的操作方法

```
public ActionResult Details(string Id)
{
  //do some dB query or whatever and return the result

  return View();  // can return the Model here to the view.

} 
```

# ruby-on-rails - 使用 Rails 迁移更改列数据类型不起作用（使用 PG DB）

> ID：11471310
> 
> 赞同：1
> 
> 时间：2012-07-13T13:18:31.420
> 
> 标签：ruby-on-rails, attributes, migration, type-conversion

我在更改特定模型属性（即金钱）的数据类型时遇到问题。金钱是一个整数——我正在尝试使用迁移将其更改为小数，精度为 5，小数位数为 2。迁移后，控制台中的一切看起来都正常（即迁移似乎有效） ，但是当我在网络应用程序中将值更改为小数时，我收到“无效值”消息。由于某种原因，错误似乎发生在客户端（它是一个 js 弹出窗口）？我没有包括任何客户端验证。以下是我采取的步骤：

首先，我生成迁移：

```
>rails generate migration change_data_type_for_user_money 
```

然后，我编辑迁移。这是它的样子：

```
class ChangeDataTypeForUserMoney < ActiveRecord::Migration
  def self.up
    change_table :users do |t|
      t.change :money, :decimal, :precision => 5, :scale => 2
    end
  end

  def self.down
    change_table :users do |t|
      t.change :money, :decimal, :precision => 5, :scale => 2
    end
  end
end 
```

然后我做一个'rake db：migrate'

奇怪的是小数点后面的零出现并且很好（例如 100.00 是可以的，但是 100.50 是我得到错误的时候）

另外，这是模型：

```
class User < ActiveRecord::Base
  attr_accessible :money, :name

  validates :money, :name, :presence => true
  validates :money, :numericality => true
end 
```

而 _from 视图：

```
<%= form_for(@user) do |f| %>
  <% if @user.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@user.errors.count, "error") %> prohibited this user from being saved:</h2>

      <ul>
      <% @user.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <div class="field">
    <%= f.label :name %><br />
    <%= f.text_field :name %>
  </div>
  <div class="field">
    <%= f.label :money %><br />
    $<%= f.number_field :money %>
  </div>
  <div class="actions">
    <%= f.submit %>
  </div>
<% end %> 
```

有什么想法吗？在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T14:04:25.703

不确定，但尝试：

```
class ChangeDataTypeForUserMoney < ActiveRecord::Migration
  def change
    change_table :users do |t|
      t.decimal :money, :precision => 5, :scale => 2
    end
  end
end 
```

编辑：原来问题根本不在于迁移，而在于验证器。解决方案是根据我下面的评论将 <%= f.number_field :money %> 更改为 <%= f.text_field :money %> 。

# python - Python 设计 - 交叉导入

> ID：11471317
> 
> 赞同：1
> 
> 时间：2012-07-13T13:18:41.693
> 
> 标签：python, design-patterns, import

我被进口困住了，不知道如何解决这个问题。

我有 3 个模块：

1.  `test_project.py`
2.  `modules/__init__.py`
3.  `r.py`
4.  `module.py`
5.  `module_configuration.py`

依赖项列表：

```
test_project.py IMPORTS modules/__init__.py
modules/__init__.py IMPORTS r.py 
r.py IMPORTS > module_configuration.py 
module_configuration.py IMPORTS > modules/__init__.py 
```

如您所见，我们在这里有一个循环导入。

*   `modules/__init__.py`保留类定义的字典（类如 R）。
*   `R`类在其构造函数中创建 ModuleConfiguration 的实例
*   `ModuleConfiguration`需要来自`modules/__init__.py`.

我得到的错误信息：

```
ERROR: controller.test_project (unittest.loader.ModuleImportFailure)
----------------------------------------------------------------------
ImportError: Failed to import test module: controller.test_project
Traceback (most recent call last):
File "/usr/lib/python2.7/unittest/loader.py", line 252, in _find_tests
module = self._get_module_from_name(name)
File "/usr/lib/python2.7/unittest/loader.py", line 230, in  
_get_module_from_name__import__(name)
File "/media/103AEB9B3AEB7C5A/Projekty/c/svn/tests/controller/test_project.py",    
line 9, in <module>
from c.core.modules import MODULES
File "/media/103AEB9B3AEB7C5A/Projekty/c/svn/tests/../c/core/modules/__init__.py", line 5, in <module>
from R import R
File "/media/103AEB9B3AEB7C5A/Projekty/c/svn/tests/../c/core/modules/R.py", line  6, in <module>
from c.core.module import Module
File "/media/103AEB9B3AEB7C5A/Projekty/c/svn/tests/../c/core/module.py", line 13, in <module>
from c.core.module_configuration import ModuleConfiguration
File "/media/103AEB9B3AEB7C5A/Projekty/c/svn/tests/../c/core/module_configuration.py", line 7, in <module>
from c.core.modules import MODULES

ImportError: cannot import name MODULES 
```

关于如何解决它的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T13:32:35.210

不要在模块加载时创建实例，而是实现返回相关结果的函数并将这些函数保存在它们各自的模块中。然后，一旦加载了模块，所有人都可以使用一切。从moduleB导入moduleA和从moduleA导入moduleB没有任何问题。您是否需要必须在模块加载时创建的模块全局对象？这通常是不需要的。相反，一旦所有模块就位，就尝试构建第一次使用所需的任何模块全局变量。

# php - CakePHP 显示空白页

> ID：11471318
> 
> 赞同：7
> 
> 时间：2012-07-13T13:18:54.010
> 
> 标签：php, cakephp, cakephp-2.1

我有一个已完成并上传的网站，起初它工作正常，但过了一段时间它停止工作。

停止工作是指我去的任何页面都只显示一个空白页面，空源。

不过在 Chrome 中，我得到了`HTTP Error 500 (Internal Server Error)`

要解决这个问题，我需要做的就是将调试更改为 2，刷新然后将其更改回 0。

我不知道是什么触发了这种情况，我尝试清除缓存文件夹。

/app/tmp/logs/error 中没有上周的日志条目。

任何想法都会很棒。谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-13T17:18:13.000

最后是同一服务器上多个 Cakes 之间的 APC 缓存冲突。

我所要做的就是更改`$prefix`config.php 并且它起作用了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-08T17:57:27.073

Cakephp 也可以显示空白页面，如果您的控制器中包含某些组件并且它包含错误，并且如果由于某种原因在您的组件中调试不起作用（尽管 core.php 中的调试级别是 2 或 3 ），它只是显示空白页。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-01-31T15:44:53.030

当我定义一个常量时发生在我身上，没有注意到这一点并定义了另一个同名的常量。

```
const VISIBLE = 1;
const DELETED = 0;
const VISIBLE = 1; 
```

几年后，我将在这里添加评论：

这意味着存在语法错误，请确保您显示这些。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-04-05T01:16:35.597

这篇文章已经过时了，但是今天我将一个新网站上传到服务器并获得了空白页面，因此我分享了我的经验。我无法访问服务器日志，所以我被卡住了。我很困惑，因为该服务器使用 cakephp 运行另一个站点，所以我认为问题是 mod_rewrite。经过我们的几次测试，问题是服务器的 php 版本太旧，无法运行 cake 2.8.3。所以我使用旧版本的蛋糕，一切正常。希望这对某人有所帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-28T07:02:40.980

这可能是由于文件末尾的空白请检查您的所有文件，如果在“？>”标签之后有空白，它会将其重定向到空白页面，或者您可以删除“？>”（关闭 php 标记）以消除此问题.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-07-25T06:55:46.653

就我而言，我有

```
public function appError($error) {} 
```

在应该重定向到**404 页面的****AppController**上，我评论了重定向。这导致我有空白页。

 *** * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-04-11T15:38:57.580

我有完全相同的问题，它是文件夹 app/tmp/cache/models 不存在。创建后就没有问题了。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-06-12T09:58:25.650

就我而言，问题不在于缓存。启用 CakePHP 调试应该很有用。将值更改为

```
Configure::write('debug', 0); 
```

到

```
Configure::write('debug', 1); 
```

在 app/cake/core.php 中显示真正的错误。**

# android - 在 Android 中安排事件

> ID：11471321
> 
> 赞同：1
> 
> 时间：2012-07-13T13:19:10.463
> 
> 标签：android, scheduling, android-calendar

安排活动的最佳方式是什么？

我在考虑新的日历 API，但它至少需要互联网连接才能创建新日历。

是否有任何 API 用于创建不需要互联网连接的时间表？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T13:20:05.270

[查看常见问题解答](https://stackoverflow.com/faq#reputation)如果您返回之前的问题并接受对您有帮助的答案，您更有可能继续获得帮助。另请参阅[如何接受答案？](https://meta.stackexchange.com/questions/5234/how-does-accepting-an-answer-work)了解更多信息。

[AlarmManager](http://developer.android.com/reference/android/app/AlarmManager.html)会让你这样做。

如果您想相对较快地安排您的活动，尽管[Handler](http://developer.android.com/reference/android/os/Handler.html)是一个更好的选择。您可以使用它来发布这样的可运行文件：

```
Runnable r = new Runnable() {
    public void run() {
        doSomething();
    }
}
Handler h = new Handler();
h.postDelayed(r, 1000); 
```

这将在一秒钟内执行你的 runnable 的 run 方法。您可以更改 postDelayed 方法的第二个参数以更改经过的时间间隔。它以毫秒为单位。

**编辑：**另请注意，做某事的“最佳”方式是主观的，通常取决于您要做什么。如果您可以更具体地说明您要安排什么以及您希望提前多长时间安排它，那么也许我们可以帮助将其缩小到“最佳”选择。但如果没有更多信息，我们无法告诉您哪个是“最好的”

# java - 什么意味着新页面是通过事件加载或通过发送本机事件完成的？

> ID：11471329
> 
> 赞同：-1
> 
> 时间：2012-07-13T13:19:45.657
> 
> 标签：java, selenium, click

我阅读了有关接口 WebElement 的方法单击的信息，但不清楚“如果 click() 导致通过事件加载新页面或通过发送本机事件完成”这样的语句是什么意思？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T13:53:49.643

这是完整的javadoc：

> 单击此元素。如果这导致加载新页面，则此方法将尝试阻止，直到页面加载。此时，您应该放弃对该元素的所有引用，并且对该元素执行的任何进一步操作都将引发 StaleElementReferenceException，除非您知道该元素并且页面仍然存在。如果 click() 导致通过事件加载新页面或通过发送本机事件完成，则该方法将 *不*等待加载，调用者应验证是否已加载新页面。

这意味着如果在浏览器中发出新请求，则 click() 是一个阻塞调用。并在页面加载时返回。

当 click() 执行一些加载新页面（或其部分）（ajax）的 javascript 时，click() 不是阻塞调用。在这种情况下，您必须使用 WebDriverWait 并等待一些 css-classes / ids / text 出现。

# linux - ALSA 异步回调？

> ID：11471336
> 
> 赞同：3
> 
> 时间：2012-07-13T13:20:15.120
> 
> 标签：linux, audio, asynchronous, callback, alsa

ALSA 文档似乎非常缺乏......基本上，我需要异步播放声音，能够停止（所有）声音，并在播放成功时获得回调。

我主要可以做前两个，只是后者我遇到了麻烦。

有谁知道任何可以启发我的片段？

更多详细信息：

基本上，用户将浏览一组声音，当他们将鼠标悬停在一个声音上时，它应该播放它，当他们转到下一个声音时，那个声音应该很快停止，下一个声音应该播放等等......这将发生得很快。应该选择他们完整听到的最后一个（因此，如果整个声音成功播放，为什么我需要回调，因为所选的 atm 不一定是他们最少听到的，由于线程）

我真的不想使用 libasound 以外的任何库。

# symfony - Symfony2 + FOSUserBundle：http_basic 身份验证有效，http_digest 失败

> ID：11471338
> 
> 赞同：4
> 
> 时间：2012-07-13T13:20:23.563
> 
> 标签：symfony, basic-authentication, http-digest

我正在使用 FOSUserBundle 配置 Symfony2 应用程序以使用`http_digest`身份验证。这是 Symfony 2.1.0-BETA2。

在 security.yml 中，我只是简单地切换并添加所需的`http_basic`属性。其他一切都保持不变。`http_digest``key`

有效的相关配置：

```
firewalls:
    main:         
        pattern: ^/
        anonymous: ~
        form_login: false            
        provider: fos_user_bundle
        http_basic:
            realm: "Example Realm" 
```

不起作用的相关配置：

```
firewalls:
    main:         
        pattern: ^/
        anonymous: ~
        form_login: false            
        provider: fos_user_bundle
        http_digest:
            realm: "Example Realm"
            key: "%secret%" 
```

如您所见，唯一的区别是切换`http_basic`到`http_digest`. 更改`key`属性的值似乎没有任何区别。

使用 in_memory 提供程序时，`http_digest`工作得很好。此问题仅在使用`fos_user_bundle`提供程序时出现。

通过工作，我的意思是在使用时`http_basic`，有效的用户凭据被接受。当使用`http_digest`相同的有效用户详细信息时，不接受并重新显示浏览器默认的 http 身份验证提示。

在安全配置更改之间，我清除了 dev 和 prod 缓存，清空浏览器缓存并关闭浏览器。

配置中是否缺少一些关键的东西？

**更新**

我记录了一次成功的 http_basic 尝试和一次不成功的 http_digest 尝试，并对日志进行了比较。

两个日志都是相同的，包括 Doctrine 记录用于身份验证的 SQL 查询的位置。

在 http_digest 日志中的身份验证查询之后是以下行：

```
security.DEBUG: Expected response: '3460e5c31b09d4e8872650838a0c0f1a' but received: '5debe5d0028f65ae292ffdea2616ac19'; is AuthenticationDao returning clear text passwords? [] []
security.INFO: exception 'Symfony\Component\Security\Core\Exception\BadCredentialsException' with message 'Incorrect response' in /home/jon/www/local.app.simplytestable.com/vendor/symfony/symfony/src/Symfony/Component/Security/Http/Firewall/DigestAuthenticationListener.php:105 
```

使用 FOSUserBundle 的密码被加盐和散列。

我想确定这件事是由于我的配置错误还是 FOSUserBundle 中的错误引起的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-13T14:21:56.140

简而言之，HTTP 摘要身份验证的工作原理是比较从包括用户名、领域、密码和各种废话和重放避免值在内的值计算的哈希值。

客户端和服务器端都需要明文密码才能生成相同的哈希值。

`FOSUserBundle`盐和哈希密码。

在类中生成的服务器端哈希`Symfony\Component\Security\Http\Firewall\DigestAuthenticationListener`将传递一个哈希而非明文密码，因此永远无法生成正确的哈希进行比较。

# apache - 带有 ssl 的 Apache 代理不显示来自后端的基本身份验证对话框

> ID：11471345
> 
> 赞同：0
> 
> 时间：2012-07-13T13:20:45.423
> 
> 标签：apache, tomcat

我有一个为客户端提供 ssl 的 Apache 代理。然后 Apache 代理到一个普通的 http tomcat 服务器。

```
Listen 7777
<VirtualHost *:7777>
    ServerName my.server.com

    SSLEngine on
    SSLCertificateFile /some.crt
    SSLCertificateKeyFile /some.pem
    SSLProxyEngine on

    # Replace HTTP response headers (http to https)
    Header edit Location ^http:(.*)$ https:$1

    ProxyRequests off
    ProxyPreserveHost On
    <Proxy *>
            Order deny,allow
            Allow from all
    </Proxy>

    ProxyPass / http://my.server.com:8888/
    ProxyPassReverse / http://my.server.com:8888/

    <Location />
            Order allow,deny
            Allow from all
    </Location>
</VirtualHost> 
```

一切正常，但是当我访问

```
https://my.server.com:7777/jmx-console 
```

我得到一个

```
http status 403 Access to the specified resource () has been forbidden. 
```

如果我直接访问后端

```
http://my.server.com:8888/jmx-console 
```

我得到了基本的身份验证对话框

我希望 Apache 显示来自 tomcat 的后端基本身份验证对话框。我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T01:07:55.867

也许你需要使用'proxy-chain-auth'：

```
SetEnv proxy-chain-auth On
AuthType basic
AuthBasicAuthoritative Off 
```

# c# - 实体框架 5 - 无法加载文件或程序集实体框架，版本 = 5.0.0.0

> ID：11471347
> 
> 赞同：13
> 
> 时间：2012-07-13T13:20:49.200
> 
> 标签：c#, entity-framework, entity-framework-ctp5

我正在尝试将 Entity Framework 5 用于我的项目，但我似乎在安装程序集以符合要求时遇到了一些问题。而且由于我最初使用 nuget 安装了它，所以我不确定我需要做什么才能使其按预期工作。请问我需要做什么来解决这个问题？

* *System.IO.FileNotFoundException：无法加载文件或程序集EntityFramework，版本= 5.0.0.0，Culture=Neutral，PublicKeyToken=b77a5c561934e089'或其依赖项之一系统找不到指定的文件。警告：程序集绑定日志记录已关闭. 要启用程序集绑定失败日志记录，请设置 registy 值。. . **

**通过使用融合日志，我得到了这个**

```
*** Assembly Binder Log Entry  (7/17/2012 @ 9:29:09 PM) ***

The operation failed.
Bind result: hr = 0x80070002\. The system cannot find the file specified.

Assembly manager loaded from:  C:\Windows\Microsoft.NET\Framework\v4.0.30319\clr.dll
Running under executable  C:\PROGRAM FILES (X86)\MICROSOFT VISUAL STUDIO 11.0\COMMON7\IDE\COMMONEXTENSIONS\MICROSOFT\TESTWINDOW\vstest.executionengine.x86.exe
--- A detailed error log follows. 

=== Pre-bind state information ===
LOG: User = WORKALOT\Tokorie
LOG: DisplayName = Budget.Data, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
 (Fully-specified)
LOG: Appbase = file:///C:/Development/Summer2012BudgetApp/Budget.Service.Test/bin/Release
LOG: Initial PrivatePath = NULL
LOG: Dynamic Base = NULL
LOG: Cache Base = NULL
LOG: AppName = vstest.executionengine.x86.exe
Calling assembly : Budget.Lib, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null.
===
LOG: This bind starts in default load context.
LOG: Using application configuration file: C:\PROGRAM FILES (X86)\MICROSOFT VISUAL STUDIO 11.0\COMMON7\IDE\COMMONEXTENSIONS\MICROSOFT\TESTWINDOW\vstest.executionengine.x86.exe.Config
LOG: Using host configuration file: 
LOG: Using machine configuration file from C:\Windows\Microsoft.NET\Framework\v4.0.30319\config\machine.config.
LOG: Policy not being applied to reference at this time (private, custom, partial, or location-based assembly bind).
LOG: Attempting download of new URL file:///C:/Development/Summer2012BudgetApp/Budget.Service.Test/bin/Release/Budget.Data.DLL.
LOG: Attempting download of new URL file:///C:/Development/Summer2012BudgetApp/Budget.Service.Test/bin/Release/Budget.Data/Budget.Data.DLL.
LOG: Attempting download of new URL file:///C:/Development/Summer2012BudgetApp/Budget.Service.Test/bin/Release/Budget.Data.EXE.
LOG: Attempting download of new URL file:///C:/Development/Summer2012BudgetApp/Budget.Service.Test/bin/Release/Budget.Data/Budget.Data.EXE.
LOG: All probing URLs attempted and failed. 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T07:29:47.350

按照错误消息的建议运行**融合日志工具**，以获取有关运行时在何处查找 dll 的更多信息，以便更好地了解它失败的原因。

Scott Hanselman有一篇关于[Fusion-loggning](http://www.hanselman.com/blog/BackToBasicsUsingFusionLogViewerToDebugObscureLoaderErrors.aspx)的好文章，介绍了如何启用它等，然后只需从命令提示符以管理员身份运行 fuslogw。

**更新**

融合日志向我们展示了运行时在哪里寻找您的 DLL，在本例中是 Budget.Data，它在以下位置寻找：

```
bin/Release/Budget.Data.DLL 
bin/Release/Budget.Data/Budget.Data.DLL
bin/Release/Budget.Data.EXE
bin/Release/Budget.Data/Budget.Data.EXE 
```

您能否验证 DLL 实际上位于这些目录之一中？如果是检查 DLL 上的目标框架（检查项目属性）？目标框架是否与 EF 5.0 兼容？您的其他程序集的目标框架是什么（如果有）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-18T18:30:52.680

你确定路径正确吗？尝试删除“实体框架”引用并手动重新添加。

右键单击添加引用，然后浏览此处并添加 dll：

> C:\PATH\TO\SOLUTION\packages\EntityFramework.5.0.0-rc\lib\net45\EntityFramework.dll

还要确保在项目的 csproj 文件中设置了路径（右键单击项目，卸载，再次右键单击然后“编辑 projectname.csproj”），您应该有这样的内容：

```
<Reference Include="EntityFramework, Version=5.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089, processorArchitecture=MSIL">
  <SpecificVersion>False</SpecificVersion>
  <HintPath>..\packages\EntityFramework.5.0.0-rc\lib\net45\EntityFramework.dll</HintPath>
</Reference> 
```

其他要检查的事情是 packages.config 文件以确保它在那里被引用，并确保实体框架引用的“复制本地”属性设置为 true。如果您在 ASP.NET 项目或类似项目中使用它，您可能还必须在 web.config 文件中引用该程序集。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-17T09:29:10.670

1.  检查标志“复制本地”
2.  检查输出文件夹中是否存在程序集 dll
3.  检查解决方案中的参考。尝试阅读参考。
4.  检查程序集和解决方案文件中的版本和公钥（您可以打开 Visual Studio 解决方案文件并在文本编辑器中对其进行编辑。尝试从解决方案文件中删除公钥并设置正确的版本（如果其不同））
5.  此外，当您将某些程序集添加到对您没有的程序集的解决方案引用时，也会出现此问题。如果尝试获得正确的程序集或尝试使用您拥有的库重建程序集。

祝你好运！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-19T10:56:20.767

前几天，当我使用版本控制 (git) 和 ef5-rc 的 Nuget 包时，实际上我自己也遇到了这个问题。为我解决的问题是从解决方案的“包”文件夹中删除（在 Windows 资源管理器中删除）程序集。当我重新启动 Visual Studio Nuget 时，我有机会恢复包。希望这可以帮助！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-19T00:16:18.900

您使用 EntLib5 中的哪些块？由于您是从 DAL 调用它，我假设您调用的是 Microsoft.Practice.EnterpriseLibrary.Data。

如果是这样，我只想指出，我总是需要以下所有 DLL 来让 EntLib5 DAAB 为我工作。

```
Microsoft.Practices.EnterpriseLibrary.Common
Microsoft.Practices.EnterpriseLibrary.Data
Microsoft.Practices.Unity
Microsoft.Practices.Unity.Interception 
```

缺少这些引用中的任何一个都会导致我的项目在运行时出错，即使编译得很好。

我还会尝试从[http://www.microsoft.com/en-us/download/details.aspx?id=15104](http://www.microsoft.com/en-us/download/details.aspx?id=15104)运行 EntLib5 安装程序，因为它将 DLL 粘贴到 GAC 中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-15T05:13:32.767

我最终为我正在从事的项目解决了这个问题。我最终删除了引发错误的项目的 .bin 文件夹中的所有内容。我假设这些文件仅在特定时间或 .dll 更改等时被重写，并且没有被迁移处理。删除这些文件，清理解决方案并重建似乎为我解决了问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-12-06T03:30:59.140

我也遇到了这个问题。所以我环顾四周，发现了以下内容。

在[http://msdn.microsoft.com/en-us/data/jj618307.aspx](http://msdn.microsoft.com/en-us/data/jj618307.aspx)的“常见问题”部分中，它说...

“这通常意味着您正在运行没有 Redirect.config 文件的 .NET 4 应用程序。您需要将 Redirect.config 复制到与 migrate.exe 相同的位置并将其重命名为 migrate.exe.config。”

不幸的是，我不知道在哪里`Redirect.config`。在 NuGet 包的目录内容中的任何位置都找不到它。

# javascript - 禁用jquery数据表中的行重新排序

> ID：11471348
> 
> 赞同：0
> 
> 时间：2012-07-13T13:20:50.370
> 
> 标签：javascript, jquery, jquery-ui, datatables, jquery-datatables

我正在使用 DataTables Row Reordering Add-on (http://jquery-datatables-row-reordering.googlecode.com/svn/trunk/index.html)，我希望能够禁用 JS 中的重新排序。我使用了类似于以下代码的代码：

```
if ($(this).attr("checked")) {
  $("#" + parameters.TableId).dataTable(
                {
                    "bDestroy": true,
                    "bPaginate": false,
                    "bLengthChange": false,
                    "bFilter": false,
                    "bSort": true,
                    "bInfo": false,
                    "bAutoWidth": true
                }).rowReordering({ sURL: parameters.sURL, iIndexColumn: parameters.iIndexColumn });
} else {
            $("#" + parameters.TableId).dataTable(
                {
                    "bDestroy": true,
                    "bPaginate": false,
                    "bLengthChange": false,
                    "bFilter": false,
                    "bSort": false,
                    "bInfo": false,
                    "bAutoWidth": true
                });//.rowReordering({ sURL: parameters.sURL, iIndexColumn: parameters.iIndexColumn }); 
```

但它不起作用（我仍然可以拖放行，但由于我将 bSort 设置为 false，它不会保存排序顺序。我想禁用拖放）。我能做些什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-06-30T23:09:18.847

在挖掘了一点之后，我发现使用了 sortable 但禁用与启用它略有不同。

```
$("tbody", oTable).sortable({"disabled" : true});

$("tbody", oTable).sortable( "enable" ); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-01-23T11:42:11.210

利用：

`$("#your_table_id .ui-sortable" ).sortable("disable");`- 禁用

`$("#your_table_id .ui-sortable" ).sortable("enable");`- 启用

# svn - 从 Subversion 的提交/更新中排除特定文件

> ID：11471349
> 
> 赞同：2
> 
> 时间：2012-07-13T13:20:53.157
> 
> 标签：svn, tortoisesvn

我之前创建了一个 SVN 存储库。现在我想做的是防止某些特定文件更新，因为我不需要更新它们。我在创建 repo 的过程中看到了解决方案，但我很久以前就这样做了，我现在想排除一些文件。

情况如下：

```
repo/
updateme.txt
donotupdateme.txt 
```

在这里，我希望 donotupdateme.txt 保持不变，而 updateme.txt 会随着更新操作而变化。

ps 我更喜欢用 Tortoise 来做这个。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T13:35:16.833

使用 SVN 属性，特别是您会对 svn:ignore 感兴趣。

使用 TortoiseSVN 这很容易。在您的工作副本中，只需右键单击要忽略的文件 (donotupdateme.txt) 选择 TortoiseSVN -> Unversion 并添加到忽略列表 -> donotupdatme.txt。

这将防止文件被提交/更新。

查看[http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-dug-ignore.html](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-dug-ignore.html)了解更多详情。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T13:26:43.060

您可以创建一个 /etc/svn/config 文件，其中包含要忽略的文件列表（或 windows 等效项），或者您可以使用 svn ignore 编辑文件所在目录的属性。

请参阅他关于如何忽略的帖子：[如何使用 SVN 忽略目录？](https://stackoverflow.com/questions/116074/how-to-ignore-a-directory-with-svn)

我确信乌龟有办法右键单击文件的编辑忽略属性...检查这个——我通过谷歌搜索“svn ignore files tortiose”找到了它

[http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-dug-ignore.html](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-dug-ignore.html)

# java - 当作为可运行 jar 启动时，应用程序不会在 64 位窗口上关闭

> ID：11471350
> 
> 赞同：4
> 
> 时间：2012-07-13T13:20:55.273
> 
> 标签：java, eclipse, 64-bit, executable-jar

我有一个我在*32 位 Win*（*XP*和*Win7*）和 Eclipse（靛蓝）下开发/测试的应用程序。我使用 File->Export->Runnable Jar 部署应用程序（使用“将所需的库打包到生成的 JAR”中）。从那里我将它包装成一个可执行文件。

我最近注意到我的应用程序无法在*64 位 Win7*（*32 位 Win*工作正常）中关闭（无论是“右上角 X”还是`alt`+ ）。我开始在*64位Win7*下玩arround ，发现从eclipse启动时，我可以关闭应用程序。将其导出到可运行的 jar 后，我无法关闭它。我的应用程序的所有其他部分都可以正常工作（也在*64 位 Win7*下）。`F4`

 ***我有一个像这样运行的关闭挂钩：

```
// initialize JFrame frame;
frame.addWindowListener(new WindowAdapter() {
    public void windowClosing(WindowEvent e) {
        closeApplication();
    }
});
frame.setVisible(true);

public void closeApplication() {
    while (ConnectionManager.isConnected())
        try {
            ThreadManager.addMeasRequestPriority(eMeasRequest.DISCONNECT);
            Thread.sleep(100);
        } catch (InterruptedException e) {}
    ConfigurationManager.saveToXML(new File("ressources/settings/startup.xml"));
    System.exit(0);
} 
```

我注意到 GUI 正在断开连接，但仅此而已（但这意味着`closeApplication()`已输入）。问题是`System.out`当我不在eclipse中运行它时我没有，所以我看不到是否有任何异常或发生了什么。您知道我如何找到问题（或已经知道问题）吗？

可能的候选人：

*   *System.exit(0) 在64 位* 下有不同的行为**（为什么会这样，是否有替代方案？）**
*   我无法创建/写入给定文件`startup.xml` **（如何检查？）**
*   *我的64 位 Win7*笔记本电脑中的一个小矮人用他的铁锤短路了主板上的一些东西，从而阻止了应用程序关闭**（我怎样才能删除他？）**
*   其他

**如果您能告诉我这里发生了什么或您将如何继续了解更多信息，我将不胜感激。**

编辑：感谢您的快速回复。我发现，我得到以下异常：

```
java.io.FileNotFoundException: ressources\settings\startupPlot0.apph (Access denied)
  at java.io.FileOutputStream.open(Native Method)
  ... 
```

但这怎么可能呢？该文件肯定存在并以*非 64 位 Win*写入。此外，在该文件发生异常之前，同一目录中还有其他文件被写入。他们工作（我刚刚检查过他们）。唯一的区别：对于其他文件，我对其他文件使用 a `new OutputStreamWriter(new FileOutputStream(File file))`，对这个文件使用 a `new DataOutputStream(new FileOutputStream(File file))`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T13:27:14.573

我可以验证 system.exit(0) 是否适用于 64 位系统。如果我不得不猜测，我的答案是您没有断开连接并且您正在抛出您的中断异常。

我的建议：在你的 catch 语句中放置一个 system.out.print 语句，看看你是否正在捕捉。如果是，你知道你有问题，如果不是，你没有断开连接并坐在 while 循环中。

编辑：试试

```
FileOutputStream fos = new FileOutputStream("t.tmp"); // t.tmp is the directory&file name
ObjectOutputStream oos = new ObjectOutputStream(fos); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-13T13:33:16.723

您可以使用以下内容确保始终调用 System.exit(0) ，而不管任何异常：

```
public void closeApplication(){
        try{
            while (ConnectionManager.isConnected()){
                try{
                    ThreadManager.addMeasRequestPriority(eMeasRequest.DISCONNECT);
                    Thread.sleep(100);
                }
                catch (InterruptedException e){
                }
            }
            ConfigurationManager.saveToXML(new File("ressources/settings/startup.xml"));
        }
        finally{
            System.exit(0);
        }
    } 
```

不过，您也可能在 while 循环中无限循环。***

# java - 上传到 Amazon S3 时命名文件

> ID：11471359
> 
> 赞同：1
> 
> 时间：2012-07-13T13:21:10.663
> 
> 标签：java, amazon-s3

我正在尝试将文件上传到 Amazon S3，没什么特别的。我已经设法进行实际上传，并且文件上传成功。剩下的唯一问题是我无法更改 S3 中的文件名。似乎默认情况下，文件名被设置为与密钥相同。可能是我将密钥作为参数发送，我应该在其中发送文件名。但是，我尝试更改参数并出现错误。

请在下面找到我正在使用的代码：

```
Bucket bucket = client.createBucket("testBucket", Region.EU_Ireland);

    List<PartETag> partTags = new ArrayList<>();

    InitiateMultipartUploadRequest request = new InitiateMultipartUploadRequest(
            bucket.getName(), secretAmazonKey);

    InitiateMultipartUploadResult result = client
            .initiateMultipartUpload(request);
    File file = new File(filePath);
    long contentLength = file.length();
    long partSize = 8 * 1024 * 1024;

    try {
        // Uploading the file, part by part.
        long filePosition = 0;

        for (int i = 1; filePosition < contentLength; i++) {
            // Last part can be less than 8 MB therefore the partSize needs
            // to be adjusted accordingly
            partSize = Math.min(partSize, (contentLength - filePosition));

            // Creating the request for a part upload
            UploadPartRequest uploadRequest = new UploadPartRequest()
                    .withBucketName(bucket.getName()).withKey(secretAmazonKey)
                    .withUploadId(result.getUploadId()).withPartNumber(i)
                    .withFileOffset(filePosition).withFile(file)
                    .withPartSize(partSize);

            // Upload part and add response to the result list.
            partTags.add(client.uploadPart(uploadRequest).getPartETag());

            filePosition += partSize;
        }
    }

    catch (Exception e) {
        client.abortMultipartUpload(new AbortMultipartUploadRequest(bucket
                .getName(), secretAmazonKey, result.getUploadId()));
    }

    CompleteMultipartUploadRequest compRequest = new CompleteMultipartUploadRequest(
            bucket.getName(), secretAmazonKey, result.getUploadId(), partTags);

    client.completeMultipartUpload(compRequest); 
```

任何帮助深表感谢。

非常感谢 ：）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T15:19:23.697

您的`key`上传请求中的实际上是您的对象（文件）密钥（名称），而不是您的 AWS 密钥。每当您实例化您的`client`实例时，这就是您指定 AWS 凭证的时间。

您能否更具体地说明您在执行此操作时看到的错误？

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-13T15:26:45.943

好吧，我最近第一次使用 Amazon S3 并且能够上传如下文件：

```
public void saveMinutes(Minutes minutes, byte [] data)
{

  AmazonS3 s3 = new AmazonS3Client(new BasicAWSCredentials(amazonS3AccessKey, amazonS3SecretAccessKey));
  ObjectMetadata metaData = new ObjectMetadata();
  metaData.setContentLength(data.length);
  metaData.setContentType("application/pdf");
  s3.putObject(new PutObjectRequest(amazonS3MinutesBucketName, minutes.getFileName(), new ByteArrayInputStream(data), metaData));
} 
```

# c# - 确实包含和不包含相同的 if

> ID：11471360
> 
> 赞同：0
> 
> 时间：2012-07-13T13:21:12.350
> 
> 标签：c#

出于某种原因，我无法让这个 if 语句起作用

```
if (htmlCode.Contains("Sign out") && !htmlCode.Contains("bye bye")) 
{
    // do stuff...
} 
```

有什么方法可以让包含和不包含在相同的 if 语句中工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T13:38:43.093

首先检查htmlCode，文本可能与一些html标签或类似的东西混合在一起，问题也可能与案例有关，当您尝试在文本中查找某些字符串时，您应该始终记住案例。

可以使用`.Contains`method 或`.IndexOf`，实际上Framework中的 contains 方法是这样实现的：

```
public bool Contains(string value)
{
  return this.IndexOf(value, StringComparison.Ordinal) >= 0;
} 
```

为了比较大字符串而不知道我会使用的情况：

```
htmlCode.IndexOf("Sign out", StringComparison.InvariantCultureIgnoreCase);
htmlCode.IndexOf("Bye bye", StringComparison.InvariantCultureIgnoreCase); 
```

如果您知道响应会很小，您可以使用`.ToLower()`或`.ToUpper()`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T13:25:47.837

尝试通过转换大写或小写来进行比较。

```
if (htmlCode.ToUpper().Contains("SIGN OUT") && !htmlCode.ToUpper().Contains("BYE BYE")) 
{
    // do stuff...
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-13T13:27:22.837

You if 子句正常工作

由于字符串大小写，它可能无法正常工作

所以我建议你这样做

```
if (htmlCode.ToUpper().Contains("Sign out".ToUpper()) && !htmlCode.ToUpper().Contains("bye bye".ToUpper())) 
```

# ios - UIAppearance 代理规则何时应用于新的视图控制器？

> ID：11471362
> 
> 赞同：13
> 
> 时间：2012-07-13T13:21:24.900
> 
> 标签：ios, uiappearance

我在徘徊 UIAppearance 规则何时应用于一些新的视图控制器？

我制定了一些全局规则，并在我的应用程序委托中调用它们。这样所有的 UIButton 看起来都一样。但现在我只想修改一个 UIButton 的外观。我已经尝试将代码删除它的背景，`- (void)viewDidLoad`但它不起作用 - UIAppearance 规则尚未应用。在一个 ViewController 中，我将修改代码放入`- (void)viewWillLayoutSubviews`其中，它运行良好，但现在在另一个 ViewController 中它不起作用（代码相同）。

覆盖 UIAppearance 规则在哪里安全？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-10T14:25:53.903

根据 2011 年 WWDC 视频介绍 UIAppearance，在`-layoutSubviews`视图调用之前应用自定义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T09:46:29.673

如果您希望自定义一个特定按钮，您应该：

1.  直接更改按钮实例的属性，不要触摸类的外观设置，或者

2.  使用如下`appearanceWhenContainedIn:`方法：

    ```
    [[UIButton appearanceWhenContainedIn:[CustomView class], nil]
     setBackgroundImage:myButtonImage
                forState:UIControlStateNormal]; 
    ```

这样，您仍然可以为您的特定按钮使用外观代理（当您知道它包含在特定视图中时），而不会更改一般外观设置。

# reporting-services - SSRS 组标题显示在除最后一页之外的所有页面上

> ID：11471364
> 
> 赞同：2
> 
> 时间：2012-07-13T13:21:36.200
> 
> 标签：reporting-services, ssrs-2008, ssrs-grouping

我在每个页面上显示组标题时遇到了一些麻烦，但是实现这一点的步骤在此处和其他在线地方都有很好的记录，但是我遇到了一个新问题。

除了最后一个页面外，我有一个组标题出现在每个页面上。

我的报告是这样设置的-

```
<group on IDs>
  <group on description>
    <group on desc_num>
      <static>
      <static>
      <static>
  <group on other>
    <static> -- this is my header causing trouble
    <group on other_num>
      <static> 
```

在我的数据集查询中，我有这样的事情：

```
Select 'Description', ROWNUM desc_num, x,y,z, null null etc...
UNION
Select null null null null etc... 'Other',  ROWNUM other_num, a, b, c 
```

在我的报告中，我使用 group by description 将查询的第一部分中的所有内容分组在一起，然后按 desc_num 分组，以便我可以保持在一起，以便我的静态行保持在一起。我对其他人也这样做。

每个 ID 可以有许多描述，每个描述包含多组详细信息。他们还可以有许多包含多组详细信息的“其他”。描述和其他组可以包含几页的数据。

对于另一个组的标题，我将 KeepTogether、KeepWithGroup 和 RepeatOnNewPage 的高级属性设置为 True、After、True，这允许它显示在其他组的每个页面上。

这完美地工作，除了另一个标题不会出现在最后一页上。对于一个特定的 id，有 3.5 页的“描述”组，紧随其后（没有分页符）是 6 页的“其他”组。“Other”一词适当地显示在第 4 页中间的另一组的开头和每个后续页面的顶部，除了第 10 页，它只包含半页。

当页面较少时，此标题具有相似的结果，它始终不会显示在“其他”组成员的最后一个完整页面上。

如果有人对此有任何想法或建议，我将不胜感激。

# django - 更新时出现 Tastypie 错误 - 为字段提供的数据不是 URI，不是字典，也没有“pk”属性

> ID：11471366
> 
> 赞同：1
> 
> 时间：2012-07-13T13:21:39.220
> 
> 标签：django, api, rest, tastypie

当我尝试更新我的资源时，我不断收到此错误。

我要更新的资源称为 Message。它有一个外键记账：

```
class AccountResource(ModelResource):
    class Meta:
        queryset = Account.objects.filter()
        resource_name = 'account'
        '''
        set to put because for some weird reason I can't edit 
        the other resources with patch if put is not allowed.
        '''
        allowed_methods = ['put']
        fields = ['id']

    def dehydrate(self, bundle):
        bundle.data['firstname'] = bundle.obj.account.first_name   
        bundle.data['lastname'] = bundle.obj.account.last_name
        return bundle 
```

```
class MessageResource(ModelResource):
    account = fields.ForeignKey(AccountResource, 'account', full=True)

    class Meta:
        queryset = AccountMessage.objects.filter(isActive=True)
        resource_name = 'message'
        allowed = ['get', 'put', 'patch', 'post']
        authentication = MessageAuthentication()
        authorization = MessageAuthorization()   
        filtering = {
                     'account' : ALL_WITH_RELATIONS
                     } 
```

现在，当我尝试使用 PATCH 更新我的消息时，我收到此错误：

**传入的数据**：`{"text":"blah!"}`

`The 'account' field has was given data that was not a URI, not a dictionary-alike and does not have a 'pk' attribute: <Bundle for obj: '<2> [nikunj]' and with data: '{'lastname': u'', 'id': u'2', 'firstname': u'', 'resource_uri': '/api/v1/account/2/'}'>.`

**不好的解决方案**：：

传入数据：`{"text":"blah!", "account":{"pk":2}}` 我不想传入帐户。我只想编辑文本而不是别的。为什么还需要转帐呢？

我尝试使用：

```
def obj_update(self, bundle, request=None, **kwargs):
        return super(ChartResource, self).obj_update(bundle, request, account=Account.objects.get(account=request.user)) 
```

*但它不起作用！* **帮助！**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-27T16:55:41.347

由于您使用的是 PUT 方法，因此当您调用 obj_update 方法时，Tastypie 需要 bundle.data 对象中的“帐户”字段。

obj_update 中的关键字参数也不像 obj_create**那样**用于设置值，它们用于搜索有问题的对象。因此，当您传递 account=Account... 关键字参数时，您只是告诉 obj_create 方法在 AccountMessage 表中搜索并按帐户过滤。

解决此问题的一种方法是将只读值设置为 True

```
Class MessageResource(ModelResource):
    account = fields.ForeignKey(AccountResource, 'account', full=True,
                                readonly=True) 
```

如果您在创建消息时需要设置帐户，我建议在您的 obj_create 方法中设置它

```
def obj_create(self, bundle, request=None, **kwargs):
    account = Account.objects.get(account=request.user)
    return super(MessageResource,
                 self).obj_create(bundle, request, account=account, **kwargs) 
```

这似乎是一个更好的解决方案，因为根据我从您的代码中可以理解的内容，帐户值指向消息的创建者，因此它应该由系统而不是用户设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T15:04:41.977

尝试使用其中没有 full=True 的资源。Tastypie 对具有 full=True 的资源有一些不同的期望——主要是包括整个记录。我相信这也包括儿童资源。

# jquery - 如何防止在chrome中的focus（）上选择文本

> ID：11471372
> 
> 赞同：2
> 
> 时间：2012-07-13T13:22:06.363
> 
> 标签：jquery, google-chrome, textselection

在焦点上，输入框中的文本在 Chrome 中被选中，在 FF 中工作正常。我该如何摆脱它

我的选择器如下

```
$('.edit').click(function(){

$('input').focus();

}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-13T13:27:03.803

我使用的解决方法：

```
$('.edit').click(function(){
    $('input').focus().val($('input').val());
});​ 
```

[JSFIDDLE](http://jsfiddle.net/prv4n/)

# python - 通过 Gensim 查找未见过文档的主题

> ID：11471376
> 
> 赞同：6
> 
> 时间：2012-07-13T13:22:10.770
> 
> 标签：python, nlp, latent-semantic-indexing, gensim

我正在使用 Gensim 进行一些大规模的主题建模。我很难理解如何确定未见（非索引）文档的预测主题。例如：我有 2500 万个文档，我已将其转换为 LSA（和 LDA）空间中的向量。我现在想弄清楚一个新文档的主题，我们称之为 x。

根据 Gensim 文档，我可以使用：

```
topics = lsi[doc(x)] 
```

其中 doc(x) 是将 x 转换为向量的函数。

然而，问题是上面的变量，topics，返回一个向量。如果我将 x 与其他文档进行比较，该向量很有用，因为它允许我找到它们之间的余弦相似度，但我实际上无法返回与 x 本身相关的特定单词。

我错过了什么，还是 Gensim 没有这种能力？

谢谢，

**编辑**

拉斯曼斯给出了答案。

我能够使用以下方法展示主题：

```
for t in topics:
    print lsi.show_topics(t[0]) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-13T15:36:32.647

LSI 模型返回的向量`[]`实际上是`(topic, weight)`对的列表。您可以通过该方法检查主题[`LsiModel.show_topic`](http://radimrehurek.com/gensim/models/lsimodel.html#gensim.models.lsimodel.LsiModel.show_topic)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-17T16:43:02.970

> 我能够使用以下方法展示主题：
> 
> 对于主题中的 t：打印 lsi.show_topics(t[0])

只是想指出解决方案代码中的一个微小但重要的错误：您需要使用 show_topic() 函数而不是 show_topic**s**() 函数。

PS我知道这应该作为评论而不是答案发布，但我目前的声誉评分还不允许评论！

# ajax - 我在主要面孔选项卡中包含基于 ajax 的页面，但它无法正常工作

> ID：11471378
> 
> 赞同：-1
> 
> 时间：2012-07-13T13:22:20.087
> 
> 标签：ajax, jsf-2, primefaces

我已在主要面孔选项卡中包含页面。我在每个页面中都使用了基于 id 的表单。当我为每个页面启用 ajax 时，它在选项卡中不起作用。

我的素面 index.xhtml 页面如下。

**索引.xhtml**

```
<?xml version='1.0' encoding='UTF-8' ?>
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN""http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:p="http://primefaces.org/ui"
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:c="http://java.sun.com/jsp/jstl/core"
  xmlns:ui="http://java.sun.com/jsf/facelets">
<ui:composition template="templet.xhtml">
    <ui:define name="top">
        <h1>Qubit Student Management System</h1>
    </ui:define>
    <ui:define name="content">       
        <h:form id="menu">                
            <p:menubar autoDisplay="true">
                <p:submenu id="admin" label="Admin">
                    <p:submenu id="institute" label="Institute Setup">
                        <p:menuitem id="addInstitute" value="Add Info" action="#{ajaxBean.editAction}" ajax="true"  update=":outputForm">
                            <f:setPropertyActionListener target="#{ajaxBean.action}" value="InstituteInformation"/>
                        </p:menuitem>

                        <p:menuitem id="viewInstitute" value="View Info" action="#{ajaxBean.editAction}" ajax="true"  update=":outputForm">
                        <f:setPropertyActionListener target="#{ajaxBean.action}" value="InstituteView"/>
                        </p:menuitem>
                        <p:menuitem id="editInstitute" value="Edit Info" action="#{ajaxBean.editAction}" ajax="true"  update=":outputForm">
                            <f:setPropertyActionListener target="#{ajaxBean.action}" value="InstituteEdit"/>
                        </p:menuitem>
                    </p:submenu>

                    <p:submenu id="campus" label="Campus Setup">
                        <p:menuitem id="addCampus" value="Add Campus" ajax="true" update=":outputForm">
                            <f:setPropertyActionListener target="#{ajaxBean.action}" value="CampusInformation"/>                                
                        </p:menuitem>
                        <p:menuitem id="viewCampus" value="View Campus" ajax="true" update=":outputForm">
                            <f:setPropertyActionListener target="#{ajaxBean.action}" value="CampusList"/>
                        </p:menuitem>
                        <p:menuitem id="editCampus" value="Edit Campus" ajax="true" update=":outputForm">
                            <f:setPropertyActionListener target="#{ajaxBean.action}" value="CampusEdit"/>
                        </p:menuitem>
                    </p:submenu>

                    <p:submenu id="department" label="Department Setup">
                        <p:menuitem id="addDepartment" value="Add Department" ajax="true" update=":outputForm">
                            <f:setPropertyActionListener target="#{ajaxBean.action}" value="DepartmentInformation"/>
                        </p:menuitem>
                        <p:menuitem id="viewDepartment" value="View Department" ajax="true" update=":outputForm">
                            <f:setPropertyActionListener target="#{ajaxBean.action}" value="DepartmentList"/>
                        </p:menuitem>
                        <p:menuitem id="editDepartment" value="Edit Department" ajax="true" update=":outputForm">
                            <f:setPropertyActionListener target="#{ajaxBean.action}" value="DepartmentEdit"/>
                        </p:menuitem>
                    </p:submenu>
                </p:submenu>

                <p:submenu id="student" label="Student">
                    <p:menuitem id="studentAdd" value="Student Add" action="#{ajaxBean.editAction}" ajax="true"  update=":outputForm">
                        <f:setPropertyActionListener target="#{ajaxBean.action}" value="StudentAdd"/>                                 
                    </p:menuitem>
                    <p:menuitem id="studentList" value="Student List" action="#{ajaxBean.editAction}" ajax="true" update=":outputForm">
                        <f:setPropertyActionListener target="#{ajaxBean.action}" value="StudentList" />
                    </p:menuitem>
                    <p:menuitem id="studentAdmission" value="Student Admission" action="#{ajaxBean.editAction}" ajax="true" update=":outputForm">
                        <f:setPropertyActionListener target="#{ajaxBean.action}" value="StudentAdmission" />
                    </p:menuitem>
                </p:submenu>
            </p:menubar>
        </h:form>       
        <h:form id="outputForm">
            <p:tabView id="outputTab">
                <p:ajax event="tabClose" listener="#{ajaxBean.closeTab}"/>
                <c:forEach items="#{ajaxBean.chcekItem}" var="item" varStatus="loop">
                    <p:tab id="#{item}" title="#{item}" closable="true">                            
                        <ui:include src="#{bundle[item]}"/>   

                    </p:tab>
                </c:forEach>
            </p:tabView>
        </h:form> 
        <a href="menuIteams.xhtml">Template</a>
    </ui:define>
    <ui:define name="bottom">
        <h2 class="center">QubitLab Limited</h2>
    </ui:define>
</ui:composition> 
```

下面的其他一些页面。

**研究所/Create.xhtml**

```
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN""http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:f="http://java.sun.com/jsf/core">

<ui:composition template="/template.xhtml">
    <ui:define name="title">
        <h:outputText value="#{bundle.InstituteInfo}"></h:outputText>
    </ui:define>
    <ui:define name="body">

        <h:form id="institutesetupform">
            <h:panelGroup id="messagePanel" layout="block">
                <h:messages errorStyle="color: red" infoStyle="color: green" layout="table"/>
            </h:panelGroup>
            <h:panelGrid columns="2">
                <h:outputLabel value="#{bundle.CreateInstituteLabel_instituteCode}" for="instituteCode" />
                <h:inputText id="instituteCode" value="#{instituteController.selected.instituteCode}" title="#{bundle.CreateInstituteTitle_instituteCode}" required="true" requiredMessage="#{bundle.CreateInstituteRequiredMessage_instituteCode}"/>
                <h:outputLabel value="#{bundle.CreateInstituteLabel_instituteName}" for="instituteName" />
                <h:inputText id="instituteName" value="#{instituteController.selected.instituteName}" title="#{bundle.CreateInstituteTitle_instituteName}" />
                <h:outputLabel value="#{bundle.CreateInstituteLabel_location}" for="location" />
                <h:inputText id="location" value="#{instituteController.selected.location}" title="#{bundle.CreateInstituteTitle_location}" />
                <h:outputLabel value="#{bundle.CreateInstituteLabel_phone}" for="phone" />
                <h:inputText id="phone" value="#{instituteController.selected.phone}" title="#{bundle.CreateInstituteTitle_phone}" />
                <h:outputLabel value="#{bundle.CreateInstituteLabel_email}" for="email" />
                <h:inputText id="email" value="#{instituteController.selected.email}" title="#{bundle.CreateInstituteTitle_email}" />
                <h:outputLabel value="#{bundle.CreateInstituteLabel_fax}" for="fax" />
                <h:inputText id="fax" value="#{instituteController.selected.fax}" title="#{bundle.CreateInstituteTitle_fax}" />
                <h:outputLabel value="#{bundle.CreateInstituteLabel_web}" for="web" />
                <h:inputText id="web" value="#{instituteController.selected.web}" title="#{bundle.CreateInstituteTitle_web}" />
                <h:outputLabel value="#{bundle.CreateInstituteLabel_about}" for="about" />
                <h:inputTextarea rows="4" cols="30" id="about" value="#{instituteController.selected.about}" title="#{bundle.CreateInstituteTitle_about}" />
                <h:outputLabel value="#{bundle.CreateInstituteLabel_mission}" for="mission" />
                <h:inputTextarea rows="4" cols="30" id="mission" value="#{instituteController.selected.mission}" title="#{bundle.CreateInstituteTitle_mission}" />
                <h:outputLabel value="#{bundle.CreateInstituteLabel_vision}" for="vision" />
                <h:inputTextarea rows="4" cols="30" id="vision" value="#{instituteController.selected.vision}" title="#{bundle.CreateInstituteTitle_vision}" />
                <h:outputLabel value="#{bundle.CreateInstituteLabel_scop}" for="scop" />
                <h:inputTextarea rows="4" cols="30" id="scop" value="#{instituteController.selected.scop}" title="#{bundle.CreateInstituteTitle_scop}" />
            </h:panelGrid>
            <br />
            <h:commandButton action="#{instituteController.create}" value="#{bundle.CreateInstituteSaveLink}">
                <f:ajax execute="institutesetupform" render="institutesetupform:messagePanel"/>
            </h:commandButton>

            <br />

        </h:form>
    </ui:define>
</ui:composition> 
```

**部门/Create.xhtml**

```
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN""http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:f="http://java.sun.com/jsf/core">

<ui:composition template="/template.xhtml">
    <ui:define name="title">
        <h:outputText value="#{bundle.CreateDepartmentTitle}"></h:outputText>
    </ui:define>
    <ui:define name="body">

        <h:form id="departmentsetupform">
            <h:panelGroup id="messagePanel" layout="block">
                <h:messages errorStyle="color: red" infoStyle="color: green" layout="table"/>
            </h:panelGroup>
            <h:panelGrid columns="2">
                <h:outputLabel value="#{bundle.CreateDepartmentLabel_departmentId}" for="departmentId" />
                <h:inputText id="departmentId" value="#{departmentController.selected.departmentId}" title="#{bundle.CreateDepartmentTitle_departmentId}" required="true" requiredMessage="#{bundle.CreateDepartmentRequiredMessage_departmentId}"/>
                <h:outputLabel value="#{bundle.CreateDepartmentLabel_departmentName}" for="departmentName" />
                <h:inputText id="departmentName" value="#{departmentController.selected.departmentName}" title="#{bundle.CreateDepartmentTitle_departmentName}" />
                <h:outputLabel value="#{bundle.CreateDepartmentLabel_history}" for="history" />
                <h:inputText id="history" value="#{departmentController.selected.history}" title="#{bundle.CreateDepartmentTitle_history}" />
                <h:outputLabel value="#{bundle.CreateDepartmentLabel_program}" for="program" />
                <h:inputText id="program" value="#{departmentController.selected.program}" title="#{bundle.CreateDepartmentTitle_program}" />
            </h:panelGrid>
            <br />
            <h:commandButton action="#{departmentController.create}" value="#{bundle.CreateDepartmentSaveLink}" >
                <f:ajax execute="departmentsetupform" render="departmentsetupform:messagePanel"/>
        </h:commandButton>
        <br />
        <br />
        <h:commandButton action="#{departmentController.prepareList}" value="#{bundle.CreateDepartmentShowAllLink}" immediate="true"/>
        <br />

    </h:form>
</ui:define> 
```

当单独运行每个页面时，ajax 可以找到表单 ID，但是当我通过单击**菜单项将这些页面包含在****index.xhtml**页面选项卡中时，它会显示

 **```
<f:ajax> contains an unknown id 'departmentsetupform' - cannot locate it in the context of the component j_idt266 
```

这里的任何人都在这方面帮助我..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-15T08:57:44.420

而不是引用`departmentsetupform`本身内部的表单引用`@form`而不是`formname:messagePanel`直接引用`messagePanel`这样

```
<f:ajax execute="@form" render="messagePanel"/> 
```**

# java - * 需要转义字符？

> ID：11471379
> 
> 赞同：0
> 
> 时间：2012-07-13T13:22:20.363
> 
> 标签：java, escaping

我正在尝试在 *CELL_OPEN 和 *CELL_CLOSE 的 ASCII 文件中搜索 * 本身（即不是运算符）

我有这个代码：

```
do {
  importstring++; 
  numberline = ImportFiles.importarray.get(importstring);
} while (!numberline.startsWith("*CELL_CLOSE")) 
```

这与 *CELL_OPEN 的额外方法不同。当我运行它时，它没有找到 *CELL_OPEN 或 *CELL_CLOSE。因此，我得到一个索引越界错误。我是否需要对 * 进行转义才能按字面意思理解？我怀疑是这样。如果我这样做，它的正确语法是什么？* 不起作用。\* 与没有转义的结果相同。谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-13T13:24:13.497

> 我是否需要对 * 进行转义才能按字面意思理解？

不。除非字符串被用于创建正则表达式（它不是，with `startsWith`），否则该`"*"`字符不是特殊的。

你的问题在别处。据推测，它`numberline`实际上从未以`*CELL_CLOSE`. （也许有一些空格？）找出实际问题的最佳选择是使用调试器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T13:30:09.440

您不需要转义字符，因为您匹配的是字符串而不是 reg exp。问题似乎出在：

```
importstring++; 
numberline = ImportFiles.importarray.get(importstring); 
```

基本上你的 importstring 变得比你从 ImportFiles.importarray 得到的数组的大小更大

我认为你需要另一个停止条件

```
}while (importstring < ImportFiles.importarray.size && !numberline.startsWith("*CELL_CLOSE")) 
```

# asp.net - 使用 MultiSelectList 在 mvc3 中搜索

> ID：11471382
> 
> 赞同：1
> 
> 时间：2012-07-13T13:22:31.390
> 
> 标签：asp.net, asp.net-mvc-3, multi-select

我是 Mvc3 的新手，我的问题是当我简单地从数据库创建 MultiSelectList 时它工作正常，但我想根据 MultiSelectList 选择的值进行搜索，我无法处理如何做到这一点

[http://www.asp.net/mvc /tutorials/javascript/working-with-the-dropdownlist-box-and-jquery/using-the-dropdownlist-helper-with-aspnet-mvc](http://www.asp.net/mvc/tutorials/javascript/working-with-the-dropdownlist-box-and-jquery/using-the-dropdownlist-helper-with-aspnet-mvc)

使用上面的链接我能够创建 MultiSelectList
请帮助我如何搜索记录从 MultiSelectList 中选择值的基础我的问题是我应该创建另一个视图以从数据库中获取记录，但问题是选择记录的数据库查询是什么

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T14:11:35.097

如果您查看示例源代码，您可以看到它们将国家/地区列表加载到多选列表中：

```
public ActionResult MultiCountryVM() { 
    return View(new CountryViewModel()); 
} 

public ActionResult MultiSelectCountry() { 
    ViewBag.Countrieslist = GetCountries(null); 
    return View(); 
} 

private MultiSelectList GetCountries(string[] selectedValues) { 
    List<Country> Countries = new List<Country>() 
    { 
        new Country() { ID = 1, Name= "United States" }, 
        new Country() { ID = 2, Name= "Canada" }, 
        new Country() { ID = 3, Name= "UK" }, 
        new Country() { ID = 4, Name= "China" }, 
        new Country() { ID = 5, Name= "Japan" } 
    }; 

    return new MultiSelectList(Countries, "ID", "Name", selectedValues); 
} 
```

然后在表单帖子上，他们将选定的值存储到 ViewBag 中：

```
[HttpPost] 
public ActionResult MultiSelectCountry(FormCollection form) { 
    ViewBag.YouSelected = form["Countries"]; 
    string selectedValues = form["Countries"]; 
    ViewBag.Countrieslist = GetCountries(selectedValues.Split(',')); 
    return View(); 
} 
```

看起来他们将其放入 ViewBag 中，因此他们可以将其传递给 MultiCountryVM 视图，而实际上并未对数据进行任何查询。如果您想进行查询，您只需使用适当的上下文创建一个 LINQ 查询，您还必须编写该查询，因为它们只有音乐实体的上下文。

# tsql - 从存储过程中获取 Top N

> ID：11471384
> 
> 赞同：2
> 
> 时间：2012-07-13T13:22:42.997
> 
> 标签：tsql, stored-procedures, sql-server-2008-r2, subquery, sql-function

我有一个*无法修改*的存储过程，在有人建议我重写存储过程或将存储过程内部的查询添加到函数中之前，我要强调这一点。

该程序位于另一个我们访问权限非常有限的数据库上；所以我想做的是以某种方式将存储过程包装在一个**查询**、**函数**或**存储过程**中，这将允许我从**返回的数据中****选择前 N 行**。

 **理想情况下，我可以调用类似...

```
DECLARE @ForeName varchar(50)
DECLARE @Surname varchar(50)
DECLARE @DOB datetime
DECLARE @Sex varchar(1)

SET @Surname = 'Smith'

SELECT TOP 10 (
   EXECUTE @RC = [Some_Other_Database].[dbo].[sp_search_demographics] 
     ,@ForeName
     ,@Surname
     ,@DOB
     ,@Sex
)
GO 
```

*编辑：（我还应该注意，存储过程返回一个包含行数和行数的参数）*

*编辑2：我还应该注意我正在使用 MS SQL Server 2008 R2*

我知道这绝不是正确的，有没有办法做这样的事情？目前，对于模糊查询，我们返回了数千行；这大大降低了服务器的速度。

我已经为解决方案做了一些谷歌搜索和堆栈溢出，但不幸的是，我能找到的所有建议都涉及修改存储过程。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T13:31:54.773

查找 EXEC SP_EXECUTESQL(@SQL) 但是问题是被调用的 sp 仍将返回所有行，因此您可能无法获得所需的性能改进。您还可以设置查询返回的行数 - 但取决于您的访问级别 [http://blog.sqlauthority.com/2007/04/30/sql-server-set-rowcount-retrieving-or-limiting-the -first-n-records-from-a-sql-query/](http://blog.sqlauthority.com/2007/04/30/sql-server-set-rowcount-retrieving-or-limiting-the-first-n-records-from-a-sql-query/) 希望这会有所帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-27T05:28:55.457

```
Declare @i  Numeric(18,2)
Declare @strSQL nvarchar(1000)
select @i = Round(COUNT(1)/10,2) from tb_Item
print(@i)
Declare @j int = 0

Declare @rem numeric(18,2)
select @rem = COUNT(1) - ((COUNT(1)/10) * 10) from tb_Item 

while @i > 0
Begin
    set @j = (@j + 1);

    if @j = 1
    Begin
        WITH OrderedOrders AS
        (
            select 
                ROW_NUMBER() over(order by ItemID) AS RowNumber
                ,ItemName
            from tb_Item 
        ) 
        SELECT ItemName, RowNumber  
        FROM OrderedOrders 
        WHERE RowNumber BETWEEN (@j*10)-10 AND @j*10;
    End
    Else
    Begin
        WITH OrderedOrders AS
        (
            select 
                ROW_NUMBER() over(order by ItemID) AS RowNumber
                ,ItemName
            from tb_Item 
        ) 
        SELECT ItemName, RowNumber  
        FROM OrderedOrders 
        WHERE RowNumber BETWEEN ((@j*10)-10) + 1 AND @j*10;
    End 
    set @i = @i - 1;
end;

WITH OrderedOrders AS
(
    select 
        ROW_NUMBER() over(order by ItemID) AS RowNumber
        ,ItemName  
    from tb_Item 
) 
SELECT ItemName, RowNumber  
FROM OrderedOrders 
WHERE RowNumber BETWEEN (@j*10)+1 and (@j*10) + @rem ; 
```**

# c# - C# 中的 Eval() javascript 代码

> ID：11471385
> 
> 赞同：-3
> 
> 时间：2012-07-13T13:22:44.413
> 
> 标签：c#, javascript

我想 eval() 并从我的 C# 程序运行这个 javascript 代码，但它甚至不会调试。我怎样才能做到这一点？

```
string jsFunc = "eval(function(p,a,c,k,e,d){while(c--){if(k[c]){p=p.replace(new RegExp('\\b'+c+'\\b','g'),k[c])}}return p}('8 4=\'6/13!)!6/12))6/19))))2!,!18*!16!15*!,!:14*-!17:9*!,!26***<\';8 5=\"\";20(3=0;3<4.24;3++){10(4.7(3)==25){5+=\'\\&\'}11 10(4.7(3)==23){5+=\'\\!\'}11{5+=21.22(4.7(3)-1)}};5;',10,27,'|||i|s|m|Nbui|charCodeAt|var||if|else|bct|spvoe|521|8477|_|73|2689|njo|for|String|fromCharCode||l{�ength|28|4451'.split('|')))";

        JSEval.JSEval eval = new JSEval.JSEval();
        string expression, result;

        Console.Write("Выражение: ");
        expression = jsFunc;

        try
        {
            result = eval.Eval(expression).ToString();
        }
        catch
        {
            result = "!!!";
        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T13:26:30.543

# python - Apache 下的 webapp2（= 没有 Google App Engine）

> ID：11471392
> 
> 赞同：4
> 
> 时间：2012-07-13T13:22:59.837
> 
> 标签：python, apache, mod-wsgi, webapp2

我正在尝试使用 Apache 和 mod_wsgi 在 Python 下运行 webapp2 - 特别是：Wampserver for Windows 7 with Apache 2.2.22。到目前为止，我失败得很惨。:-(

[我使用了来自https://developers.google.com/appengine/docs/python/gettingstartedpython27/usingwebapp](https://developers.google.com/appengine/docs/python/gettingstartedpython27/usingwebapp)的以下示例：

```
import webapp2

class MainPage(webapp2.RequestHandler):
    def get(self):
        self.response.headers['Content-Type'] = 'text/plain'
        self.response.out.write('Hello, webapp World!')

app = webapp2.WSGIApplication([('/', MainPage)],
                              debug=True) 
```

当我将此文件另存为`c:wamp\www\Python\hello.py`，并浏览到`localhost/Python/hello.py`我得到：

```
Not Found
The requested URL /python/hello.py was not found on this server. 
```

但是，让我声明 Apache 中用于 Python 的 mod_wsgi 似乎运行良好；以下代码

```
def application(environ, start_response):
    status = '200 OK'
    output = 'Hello from Python!'

    response_headers = [('Content-type', 'text/plain'), 
        ('Content-Length', str(len(output)))]

    start_response(status, response_headers)
    return [output] 
```

位于`c:\wamp\www\Python\test.py`。当我转到 时`localhost/Python/test.py`，浏览器`Hello from Python!`会按照我的预期显示。

到目前为止，我只发现了如何通过放置该行将 def (="application") 的默认名称更改为“something_else”

```
WSGICallableObject something_else 
```

进入`.htaccess`.

但是我怎样才能让 Apache 接受变量`app`作为可调用对象呢？（到目前为止，我主要使用 Python 进行 Web 之外的编程，所以我希望这不是一个愚蠢的问题。）

任何帮助表示赞赏。

**更新：**

Graham 询问了我在 Apache 配置文件中使用的 mod_wsgi 配置以及我在哪里添加它。我添加了

```
LoadModule wsgi_module modules/mod_wsgi.so

<Directory "c:/wamp/www/python">
Options +ExecCGI
AddHandler wsgi-script .py
Order allow,deny
Allow from all
</Directory> 
```

在`httpd.conf`所有“LoadModule”行的末尾。

关于我的配置的一些附加信息：我正在使用 mod_wsgi-win32-ap22py27-3.3.so。（当然，我将它重命名为`mod_wsgi.so`并将其放入`c:\wamp\bin\apache\apache2.2.22\modules`.）我的 Python 命令行说明了版本：`Python 2.7.3 (default, Apr 10 2012, 23:31:26) [MSC v.1500 32 bit (Intel)] on win 32`. 我使用的 wamp 服务器是 32 位的。我的操作系统是 Windows 7 Ultimate 64bit SP1。

希望对诊断有帮助...

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-24T10:55:05.447

[从http://code.google.com/p/modwsgi/wiki/InstallationOnWindows](http://code.google.com/p/modwsgi/wiki/InstallationOnWindows)安装 mod_wsgi并正确配置您的 httpd.conf。

我假设您已经添加了这两行：

```
LoadModule wsgi_module modules/mod_wsgi.so
WSGICallableObject app 
```

[从http://pypi.python.org/pypi/setuptools](http://pypi.python.org/pypi/setuptools)安装 py-setuptools然后为你的 python 安装模块

```
easy_install WebOb
easy_install Paste
easy_install webapp2 
```

创建虚拟主机

```
<VirtualHost *>
  ServerAdmin admin@mydomain.com
  DocumentRoot "/vhost/domains/mydomain/htdocs"
  ServerName a.mydomain.net
  WSGIScriptAlias / "/vhost/domains/mydomain/wsgi/main.py"
  Alias /static/ "/vhost/domains/mydomain/htdocs/static/"
</VirtualHost> 
```

**文件：main.py**

```
import webapp2

class Hello(webapp2.RequestHandler):
  def get(self):
    self.response.headers['Content-Type'] = 'text/html; charset=utf-8'
    self.response.out.write('hello world!')

application = webapp2.WSGIApplication([
    ('/', Hello)
], debug=True) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-06T11:58:20.153

1) 您需要使用 pip 或 easy_install 在托管环境中安装 webapp2、WebOb、粘贴必备模块

2）在网站的根文件夹（/var/www/website/wsgi.py）下创建wsgi.py文件。

```
#/var/www/website/wsgi.py
import webapp2
class Index(webapp2.RequestHandler):
    def get(self):
        output = 'webapp2 running on apache2'
        self.response.headers = [('Content-type','text/plain'),('Content-length',str(len(output)))]
        self.response.out.write(output)

application = webapp2.WSGIApplication([('/',Index)], debug=True) 
```

3）在sites-available文件夹下创建apache2配置文件（/etc/apache2/sites-available/website.conf）

```
<VirtualHost *:80>
    ServerName website
    WSGIScriptAlias / "/var/www/ website /wsgi.py"
</VirtualHost> 
```

4) 将“website”别名添加到“/etc/hosts”文件中。

5) 运行以下命令启用“/etc/apache2/sites-available/website.conf”</p>

```
a2ensite website.conf 
```

6) 重新加载并重启 apache2 web 服务器

```
service apache2 reload 
/etc/init.d/apache2 restart 
```

7) Apache web-server 将在重启 webapp2 时自动加载“website”配置。WSGIApplication 实例将指向 mod_wsgi“application”。

# 请注意，上面的示例是在 Ubuntu 13.10 操作系统上测试的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T14:11:14.893

你有没有试过：

```
 WSGICallableObject app 
```

您还可以将代码更改为：

```
application = webapp2.WSGIApplication([('/', MainPage)], debug=True) 
```

并避免需要告诉 mod_wsgi 寻找不同的名称。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-18T11:41:41.537

知道了！线

`app = webapp2.WSGIApplication([('/', MainPage)], debug=True)`

应该：

`app = webapp2.WSGIApplication([('/Python/hello.py', MainPage)], debug=True)`

然后一切正常！啊！

非常感谢 Graham 耐心地将我推向正确的方向：问题确实在 webapp2 的范围内，只要 WSGICallableObject 设置为“app”！

为了让任何人都陷入与 webapp2 类似的路由问题，请查看[http://webapp-improved.appspot.com/guide/routing.html](http://webapp-improved.appspot.com/guide/routing.html)。“简单路线”的第一个例子让我`webapp.WSGIApplication`在几分钟内重写了我的调用！

**更新**

不幸的是，上面的解决方案似乎并不可靠：今天，我有时会从 webapp2 得到正确的响应，有时我会从 webapp2 得到 404。

从昨天开始没有改变任何一行代码。

在什么条件下我无法重现我得到 404 或正确的响应。我暂时放弃这个。这很可悲，因为我认为 Python 是一门很酷的语言。

@Graham：再次感谢您的帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-13T16:06:23.817

我自己还没有尝试过，但是您是否使用以下代码创建了另一个 Python 模块，比如 runme.py：

```
def main():
  run_wsgi_app(yourmodule.app)
if __name__ == '__main__':
  main() 
```

（注意：我从[https://developers.google.com/appengine/docs/python/python27/migrate27#wsgi得到这个](https://developers.google.com/appengine/docs/python/python27/migrate27#wsgi)

# javascript - 具有优化航点的 Google Maps API。Waypoint_下单

> ID：11471393
> 
> 赞同：1
> 
> 时间：2012-07-13T13:23:10.427
> 
> 标签：javascript, google-maps, google-maps-api-3

我在某些请求中遇到了 waypoint_order 的问题，它与腿末端位置匹配，而其他时候则不匹配。这是我发送请求以及航路点和航段的方式。

```
 var request = {
            origin: start,
            destination: end,
            waypoints: waypts,
            optimizeWaypoints: true,
            travelMode: google.maps.DirectionsTravelMode.DRIVING,
            unitSystem: google.maps.UnitSystem.IMPERIAL
        }; 
```

正在通过的航点。

waypt[0] 1450 West Jackson Street Ozark Missouri ----order[0] 3

waypt[1] 2825 S Glenstone Ave Springfield Missouri ----order[1] 1

waypt[2] 404 West South Street Nixa Missouri ----order[2] 0

waypt[3] 500 West Chestnut Expressway Springfield Missouri ----order[3] 4

waypt[4] 715 W. Mt. Vernon Nixa Missouri ----order[4] 2

航点顺序：3,1,0,4,2

腿。

腿[0] 来自 1923 E Kearney St, Springfield, MO 65803, USA

腿 [0] 至 500 W Chestnut Expy, Springfield, MO 65806, USA

腿 [1] 来自 500 W Chestnut Expy, Springfield, MO 65806, USA

腿 [1] 至 2825 S Glenstone Ave, Springfield, MO 65804, USA

腿 [2] 来自 2825 S Glenstone Ave, Springfield, MO 65804, USA

腿[2] 至 1450 W Jackson St, Ozark, MO 65721, USA

腿[3] 从 1450 W Jackson St, Ozark, MO 65721, USA

腿 [3] 至 715 W Mt Vernon St, Nixa, MO 65714, USA

腿 [4] 来自 715 W Mt Vernon St, Nixa, MO 65714, USA

腿 [4] 至 404 W South St, Nixa, MO 65714, USA

腿 [5] 来自 404 W South St, Nixa, MO 65714, USA

腿 [5] 至 3315 S Campbell Ave, Springfield, MO 65807, USA

根据航段的航点顺序：[2,1,4,0​​,3]

有人知道为什么 result.routes[0].waypoint_order 中的 waypoint_order 会关闭吗？

# google-app-engine - GAE全文搜索开发控制台UnicodeEncodeError

> ID：11471398
> 
> 赞同：1
> 
> 时间：2012-07-13T13:23:18.470
> 
> 标签：google-app-engine

我有一个索引，其中包含许多带有口音的单词（例如：São Paulo、José 等）。搜索 api 工作正常，但是当尝试在开发控制台上进行一些测试查询时，我无法访问索引数据。此错误仅发生在开发环境中。在生产 GAE 上一切正常。

波纹管回溯：

```
Traceback (most recent call last):
  File "/Applications/GoogleAppEngineLauncher.app/Contents/Resources/GoogleAppEngine-default.bundle/Contents/Resources/google_appengine/google/appengine/ext/webapp/_webapp25.py", line 701, in __call__
    handler.get(*groups)
  File "/Applications/GoogleAppEngineLauncher.app/Contents/Resources/GoogleAppEngine-default.bundle/Contents/Resources/google_appengine/google/appengine/ext/admin/__init__.py", line 1704, in get
    'values': self._ProcessSearchResponse(resp),
  File "/Applications/GoogleAppEngineLauncher.app/Contents/Resources/GoogleAppEngine-default.bundle/Contents/Resources/google_appengine/google/appengine/ext/admin/__init__.py", line 1664, in _ProcessSearchResponse
    value = TruncateValue(doc.fields[field_name].value)
  File "/Applications/GoogleAppEngineLauncher.app/Contents/Resources/GoogleAppEngine-default.bundle/Contents/Resources/google_appengine/google/appengine/ext/admin/__init__.py", line 158, in TruncateValue
    value = str(value)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xc1' in position 5: ordinal not in range(128) 
```

# java - 如何动态创建多个 VerticalFieldManager 黑莓

> ID：11471403
> 
> 赞同：1
> 
> 时间：2012-07-13T13:23:31.677
> 
> 标签：java, blackberry, blackberry-jde

我一直在努力在 Blackberry 上动态创建多个 VerticalFieldManager。每个 subManager 都会向用户显示不同的数据。并且每个 subManager 在屏幕上会有不同的位置。所以我创建了一个具有“mainManager”的类和另一个创建“submanagers”的类，然后我调用`mainManager.add(new TheClassExtendingVerticalFieldManager);`将 subManagers 添加到 mainManager。问题是我只得到一个 subManager 而不是三个。我正在使用填充来分隔经理。这是我使用的代码。请指导我正确的方向，将不胜感激。

**创建子管理器的类**

```
public class ProgramListView extends VerticalFieldManager{

    private VerticalFieldManager subManager;
    private int _height;

    public ProgramListView(int height){
        this._height = height;

//      subManager = new VerticalFieldManager(
//              Manager.NO_HORIZONTAL_SCROLL | Manager.NO_VERTICAL_SCROLL | Manager.NO_VERTICAL_SCROLLBAR | 
//              Manager.NO_HORIZONTAL_SCROLLBAR | Manager.USE_ALL_WIDTH)
//
//      {
//
//
//      };
    }

    public int get_height() {
        return _height;
    }

    public void set_height(int _height) {
        this._height = _height;
    }

    public void setCoordinates(int x, int y){
        setPosition(100,140);
    }
    protected void sublayout(int maxWidth, int maxHeight)
    {
        int displayWidth = Display.getWidth();
        int displayHeight = maxHeight;
        this.setPosition(300, 300);
        super.sublayout( 40, 40);
        setPadding(this.get_height(), 0, 0, 0);
        setExtent(displayWidth, this.get_height());

    }

    public void paint(Graphics graphics)
    {
        graphics.setBackgroundColor(Color.BLUE);//blue
        graphics.clear();
        super.paint(graphics);      
    }
    public int getPreferredWidth() {
        // TODO Auto-generated method stub
        return Display.getWidth();
    }

} 
```

**mainManager 类**

```
public class ProgramLayout extends MainScreen {

    private HorizontalFieldManager mainManager;
    private int deviceWidth = Display.getWidth();
    private int deviceHeight = Display.getHeight();
    private Vector subManagers;
    private int theheight;

    public ProgramLayout(){

        setToolbar();
        subManagers = new Vector();
        theheight = 100;
        mainManager = new HorizontalFieldManager(Manager.VERTICAL_SCROLL | Manager.USE_ALL_WIDTH | Manager.USE_ALL_HEIGHT)

        {

            protected void sublayout(int maxWidth, int maxHeight)
            {
                int displayWidth = deviceWidth;
                int displayHeight = deviceHeight;
                super.sublayout( displayWidth, displayHeight);
                setExtent(displayWidth, displayHeight);
            }

            public void paint(Graphics graphics)
            {
                graphics.setBackgroundColor(Color.BLACK);
                graphics.clear();
                super.paint(graphics);
            }

            public int getPreferredWidth() {
                // TODO Auto-generated method stub
                return Display.getWidth();
            }

        };
        for (int i = 0; i < 3; i++) {
            theheight = theheight+100;
            subManagers.addElement(new ProgramListView(theheight));
        }

        for (int i = 0; i < subManagers.size(); i++) {

            mainManager.add((VerticalFieldManager)subManagers.elementAt(i));
        }

        this.add(mainManager);

    } 
```

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T13:13:27.290

尝试这个：

```
 for (int i = 0; i < 3; i++) {
        theheight = theheight+100;
         mainManager.add(new ProgramListView(theheight));
    }
    this.add(mainManager); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T20:58:41.723

只是为了详细说明 Eugen Martynov 指出的内容， your `mainManager`is a `HorizontalFieldManager`，这意味着它将按照您 add() 它们的顺序水平布置子字段。它会根据您调用的顺序自动为您处理布局`add()`。

但是，每个孩子都是一个实例，`ProgramListView`并在 getPreferredWidth() 中返回 Display.getWidth()：

```
public int getPreferredWidth() {         
    // TODO Auto-generated method stub         
    return Display.getWidth();     
} 
```

所以，第一个占据了整个屏幕宽度，接下来的两个必须在右边（但你已经占据了整个屏幕宽度）。

你想让这三个`ProgramListViews`垂直堆叠吗？然后，`mainManager`应该只是更改为`VerticalFieldManager`. 使用`VerticalFieldManager`, 调用`add()`三个不同的`ProgramListView`子字段将自动将它们垂直排列。

# python - 没有名为 menu_pool 的模块

> ID：11471407
> 
> 赞同：1
> 
> 时间：2012-07-13T13:23:53.127
> 
> 标签：python, menu, django-cms

我正确安装了 django cms 但它说`no module named menu_pool`

我必须安装其他菜单插件吗？

这条路径`from menus.menu_pool import menu_pool`我找不到，有什么问题？有人可以帮我找到线索吗

我按照此处所写的 django-cms 文档进行操作：http: [//docs.django-cms.org/en/2.3/getting_started/tutorial.html#configuration-and-setup](http://docs.django-cms.org/en/2.3/getting_started/tutorial.html#configuration-and-setup)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T11:26:33.887

看起来 Python 可以做得`import menus`很好，否则错误消息会有所不同。通过[文档快速搜索菜单](http://django-cms.readthedocs.org/en/latest/concepts/menu_system.html?highlight=menu_pool)显示您可能想要`MenuPool`而不是您的第二个`menu_pool`.

如果我没记错的话，`from menus.menu_pool import MenuPool`应该给你你预期的行为。然后`MenuPool`将在您的命名空间中，因此您可以做`nodes = MenuPool.get_nodes()`任何您想做的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T20:28:44.867

django 没有太多经验，但您应该检查系统本身上安装的模块文件，看看是否有错误。您可以从 python 本身的 sys.path 变量中获取目录地址。大多数情况下，源代码都与 python 模块一起安装，因此您可以打开这些文件并亲自查看该模块是否真的存在。
或者您可以使用`dir(menus)`来查看菜单下有哪些模块。

# c# - 通过 Active Directory 登录使用自定义角色的最佳方式

> ID：11471409
> 
> 赞同：0
> 
> 时间：2012-07-13T13:24:09.897
> 
> 标签：c#, active-directory, roles

我正在寻找解决问题的最佳方法，我们想要做的是使用活动目录进行基本登录，这样我们就不必管理密码等。但我们想要创建自定义角色，而不是使用 AD 组。所以我可能有一个角色，相当于 5 个不同的 AD 组。

我想做的是通过 c# 将特定组中的所有用户转储到自定义用户表，该表链接到角色 ID 到用户 ID 表。有人对此有任何想法吗？但是我还需要以某种方式管理自定义用户表，如果有人从其中一个组中删除，那么他们需要释放访问权限，不知道如何处理那个。

目前我的方法看起来像这样：

```
 using (PrincipalContext ctx = new PrincipalContext(ContextType.Domain, "SETON"))
        {
            //Gets all Users in a AD Group
            using (GroupPrincipal grp = GroupPrincipal.FindByIdentity(ctx, IdentityType.SamAccountName, groupName))
            {
                //Mkae sure group is not null
                if (grp != null)
                {
                    foreach (Principal p in grp.GetMembers())
                    {
                        //Sets up Variables to enter into Finance User Table
                        string UserName = p.SamAccountName;
                        string DisplayName = p.Name;
                        string emailAddress = p.UserPrincipalName;

                        //Get users detials by user
                        using (UserPrincipal userPrincipal = UserPrincipal.FindByIdentity(ctx, IdentityType.SamAccountName, UserName))
                        {
                            if (userPrincipal != null)
                            {                                    
                                //Test to see if user is in AD Group
                                bool inRole = userPrincipal.IsMemberOf(grp);
                                if (inRole)
                                {
                                    //Test to See if UserName already exists in Finance User Table
                                    var ds = User.GetUserList(UserName);

                                    //If don't exist add them and to the new Role
                                    if (ds.Tables[0].Rows.Count == 0)
                                    {
                                        //Add User to FinanceUSer Table
                                        Seton.Roster.User user = new User();
                                        user.UserName = UserName;
                                        user.Name = DisplayName;                                            
                                        int id = user.Save();

                                        //Get RoleID by RoleName with Method
                                        var roleDS = SecurityRole.GetRoleList(roleName);
                                        if (roleDS.Tables[0].Rows.Count > 0)
                                        {
                                            var roleDR = roleDS.Tables[0].Rows[0];
                                            int roleid = Convert.ToInt32(roleDR["roleid"].ToString());
                                            SecurityRoleUserLink.AddNewLink(roleid, id);
                                        }
                                    }
                                    //if they exist just Get thier userid and add them to new Role
                                    else
                                    {
                                        //Get UserID of existing FinanceUser
                                        var userDR = ds.Tables[0].Rows[0];
                                        int id = Convert.ToInt32(userDR["userid"].ToString());

                                        //Get RoleID by RoleName with Method
                                        var roleDS = SecurityRole.GetRoleList(roleName);
                                        if (roleDS.Tables[0].Rows.Count > 0)
                                        {
                                            var roleDR = roleDS.Tables[0].Rows[0];
                                            int roleid = Convert.ToInt32(roleDR["roleid"].ToString());

                                            //Test to see if user already in this role
                                            if(!SecurityRoleUserLink.UserInRole(id,roleid))
                                                SecurityRoleUserLink.AddNewLink(roleid, id); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T13:36:15.320

我已经通过几种方式做到了这一点，但答案实际上是关于您希望实现安全性的复杂程度。你是在做现场级别还是记录级别？

1.  在您的应用程序中缓存 AD 用户帐户和组以便快速检索。
    *   优点 - 帐户在您的数据库中，如果 AD 有问题，您不是 SOL。
    *   缺点 - 需要重新填充并按计划进行，并且可能不同步
2.  将 AD 用于用户和组，并将应用程序组映射到域组。
    *   优点 - 让 AD 完成您的工作，因此您不必在应用程序中管理它

当然还有更多的优点和缺点，但是，对我来说，这些很突出。

我们目前使用 AzMan，但它不受支持 - 据我所知。它在大多数情况下运行良好，但是您必须考虑很多来回同步以及性能，您最终仍将其缓存在应用程序中。

您还可以在 code plex 上找到一个开源：[NetSqlAzMan](http://netsqlazman.codeplex.com/)，它看起来很有前途。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T13:26:09.643

我认为你正在重新发明轮子。查看[MS Windows 授权管理器](http://msdn.microsoft.com/en-us/library/bb897401.aspx)(AzMan) 之类的产品，或者它的[开源等效产品](http://www.google.co.uk/url?sa=t&rct=j&q=azman%20open%20source&source=web&cd=1&ved=0CFcQFjAA&url=http://netsqlazman.codeplex.com/&ei=BiIAUJDQJOiy0QXfkYmXBw&usg=AFQjCNELE8xs1lKYccO3IqsB5giHzHxLtg)。

这些允许您定义“操作”（即用户可以执行的任务），并将这些操作映射到 AD 组。除此之外，它们还可以让您做更多的事情，但至少它们肯定会满足您的需求。

AzMan 配置可以存储在 XML、数据库或 AD 中，因此在这方面也非常灵活。

# javascript - javascript验证空或null（是否正确？）

> ID：11471412
> 
> 赞同：5
> 
> 时间：2012-07-13T13:24:17.037
> 
> 标签：javascript, validation

如果输入字段为空，我正在使用 javascript 进行验证：

```
if($("#nu_username").val() == null || $("#nu_username").val() == ""){ 
    do action...
} 
```

它运作良好，但我想知道同时使用这两种条件是否是多余的。你知道吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-13T13:25:42.057

两者都是“假的” `null`。`""`

你可以写

```
if (!$('#nu_username').val()) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T14:23:53.400

当涉及真/假时，切勿与 == 或 != 进行比较。始终使用 === 和 !==。

除此之外，根据[jQuery api](http://api.jquery.com/val/)，只有当该选择器没有匹配项时，val() 才保证返回 null；如果单个字段匹配但为空，则返回“”（空字符串）。

# android - Android - 启动另一个相对于包的 PreferenceScreen

> ID：11471419
> 
> 赞同：1
> 
> 时间：2012-07-13T13:25:01.597
> 
> 标签：android, preferencescreen

我正在尝试从 SreferenceScreen 中启动另一个 PreferenceScreen

```
<PreferenceCategory android:title="Advanced" >
    <Preference
        android:key="mykey"
        android:persistent="false"
        android:title="Advanced settings">
        <intent  android:targetPackage="com.mypackage"  android:targetClass="com.mypackage.SettingsAdvancedActivity"/>
</Preference> 
```

它工作正常，但我想改变它，以便它与包相关，比如

```
<<PreferenceCategory android:title="Advanced" >
    <Preference
        android:key="mykey"
        android:persistent="false"
        android:title="Advanced settings">
        <intent  android:targetPackage="."  android:targetClass=".SettingsAdvancedActivity"/>
</Preference> 
```

可能吗？你可能会问为什么？如果我必须更改包名，生活会更容易

# python - django/mod_wsgi 无法导入模块（位于 python 路径上的目录中）

> ID：11471424
> 
> 赞同：0
> 
> 时间：2012-07-13T13:25:22.953
> 
> 标签：python, django, mod-wsgi

我正在使用 mod_wsgi/apache 运行 django 并收到此 ImportError：

```
Request Method: GET
Django Version: 1.2.5
Exception Type: ImportError
Exception Value:    
No module named adspygoogle.dfp.DfpClient 
```

该模块位于我的 django`app/libs`目录中，该目录包含在 python 路径中。

奇怪的是，当使用`./manage.py shell`or `./manage.py runserver`with时`pdb.set_trace()`，在导入之前放入调试器，我能够毫无问题地导入模块。

有谁知道是什么原因造成的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T13:42:07.853

设置 wsgi 进程的 python 路径。

[http://code.google.com/p/modwsgi/wiki/ConfigurationDirectives#WSGIPythonPath](http://code.google.com/p/modwsgi/wiki/ConfigurationDirectives#WSGIPythonPath)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T15:03:37.593

事实证明，该`libs/adspygoogle`目录以某种 git 没有跟踪的方式变得脏了。我用新的结帐代替了它，现在它可以工作了...

我仍然无法解释为什么我可以在 shell 或 runserver 中导入它。

# javascript - 用于记住初始状态的 javascript 闭包

> ID：11471425
> 
> 赞同：0
> 
> 时间：2012-07-13T13:25:23.700
> 
> 标签：javascript

我在 CSS 中有一个像这样工作的 div：SomeDiv 有另一个类，有时是 SomeRedDiv，有时是 SomeBlueDiv。当我在 SomeDiv 上使用鼠标时，我希望它添加 SomeYellowDiv 类。但是当我鼠标离开时，我希望每个 div 都返回到其初始状态，SomeRedDiv 或 SomeBlueDiv。这就是我所拥有的：

```
 <div class="SomeDiv SomeRedDiv"></div>
     <div class="SomeDiv SomeBlueDiv"></div>

    $('.SomeDiv').mouseenter(function () {

       // this makes all SomeDivs turn yellow
       $(this).removeClass().addClass('SomeDiv SomeYellowDiv');
    });

    $('.SomeDiv').mouseleave(function () {

       // here I want to use closure so that the function remembers
       // which class it initially was; SomeBlueDiv or SomeRedDiv
       $('this).removeClass().addClass('SomeDiv'); // add the initial color class
    }); 
```

我可以用全局来做到这一点，但我想看看闭包是否会让我的代码更好；我知道闭包的概念，它允许函数记住它们的状态，但我不知道如何让它在这里工作。

感谢您的建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T13:26:42.790

Clsoures don't apply here, since you have two unrelated functions.

Instead, you should use `$(this).data(...)`, which stores arbitrary data associated with an element.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T13:37:31.047

这里没有真正需要闭包 - 您只需在鼠标进入时将红色/蓝色类推入其他数据容器，然后在鼠标离开时恢复它。

```
$('.SomeDiv').mouseenter(function () {
    //remember the current colour class...
    $(this).data('orig-colour', $(this).is('.SomeDivBlue') ? 'Blue' : 'Red'));
    //...and now remove it and add yellow
    $(this).removeClass('SomeDivRed SomeDivBlue').addClass('SomeYellowDiv');
});

$('.SomeDiv').mouseleave(function () {
    //remove yellow and reinstate the original colour class
    $(this).removeClass('SomeDivYellow').addClass('SomeDiv'+$(this).data('orig-colour'));
}); 
```

另请注意，我只删除需要删除的类，而不是删除所有类然后根据需要重新添加的代码。

如果您有很多 div，您可能还想考虑委派事件，因为这更优化性能。这不是一个大的变化。

```
$('.SomeDiv').mouseenter(... 
```

变成类似的东西

```
$('body').on('mouseenter', '.SomeDiv', ... 
```

最后，我假设有一些编程原因说明你为什么需要删除一个类。如果目的纯粹是视觉上的，冒着指出显而易见的风险，你应该制作你的 CSS，让黄色类仅仅覆盖蓝色/红色类的效果，减少显式删除后者的需要。

# c# - 自动电子邮件数据库结果

> ID：11471426
> 
> 赞同：0
> 
> 时间：2012-07-13T13:25:27.877
> 
> 标签：c#, sql, sql-server, sql-server-2000

我需要一些帮助来概念化一个项目......我必须运行 4 个不同的查询并将结果作为电子邮件正文发送给定义的收件人。
问题是我需要自动化这个过程，因为我需要每天早上 9 点发送结果......，我最初的想法是在 SQL Server2000 中设置一个工作并让那个工作通过电子邮件发送结果，但是这个特定的数据库在 SQL Server 2000 中...，然后我想我可以创建一个 C# 或 Visual Basic 程序并使用 Windows 调度程序来运行和通过电子邮件发送报告，但是我再次回到它是 SQL Server 2000 并且没有发送邮件的存储过程。
我能够在线找到一个发送邮件存储过程，但后来不知道如何将结果附加到参数。任何有关其他人如何处理此问题的见解将不胜感激。

谢谢，

阿杰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T13:39:35.907

SQL 2000 确实有工作。

[http://msdn.microsoft.com/en-us/library/aa215382(v=sql.80).aspx](http://msdn.microsoft.com/en-us/library/aa215382(v=sql.80).aspx)

如何创建作业 (Transact-SQL) 创建作业

1.执行 sp_add_job 创建作业。

2.执行 sp_add_jobstep 创建一个或多个作业步骤。

3\. 执行 sp_add_jobschedule 创建作业计划。

SQL 2000 中的电子邮件可以通过 Outlook 完成，但这有点痛苦…… Blat 是免费的，不需要 Outlook 或 POP3。

为了避免附件并呈现漂亮的电子邮件，只需将行数据连接到 HTML 表中并将结果分配给正文。如果您需要超过 8000 个字符，则必须使用文本数据类型，但可能会有些困难

```
declare @result varchar(8000)
set @result = '<table>'

select @result = @result + '<tr><td>' + col1 + '</td><td>' + col2 + '</td></tr>'
from whereever
where something = something_else
order by 1

set @result = @result + '</table>' 
```

[http://www.blat.net/](http://www.blat.net/)

示例代码： http: [//www.devx.com/dbzone/Article/42178](http://www.devx.com/dbzone/Article/42178)

```
Exec stp_BlatMail 'ServerName', 'fhtapia@gmail.com',
'System Maintenance: Low Memory', 'D:\Data\TempFiles\MemoryRpt.txt'

CREATE PROCEDURE stp_BlatMail (@FromName AS VARCHAR (1000), @To AS VARCHAR(1000),
@Subject AS VARCHAR(1000), @BODY AS VARCHAR(8000),
@ATTACHMENTS AS VARCHAR(1024) = NULL) AS
-- By: Francisco H Tapia <fhtapia@gmail.com>
-- Date: 8/19/2003
-- Purpose: Provide Outlook free SMTP Mailing
SET NOCOUNT ON
DECLARE @CMD as VARCHAR(8000), @result as INT
IF @TO = ''
BEGIN
SELECT 'ERROR: NO TO Name'
END
ELSE
BEGIN
SELECT @CMD = ' D:\Data\Common\blat.exe - -subject "'+ @Subject
+ '" -t "' + @To
+ '" -sender "SystemUID@Domain.com" -from "'
+ @FromName
+'" -f "SQLMail" -ReplyTo "SystemUID@Domain.com" -org "My Company Name" -x "X-INFO: " -noh
-noh2 -server "ExchangeServerName" -port 25 -u EmailUID -pw Password -body "'
+ LTRIM(RTRIM(@Body)) + '" '
+ ' -q '
If @ATTACHMENTS <> ''
BEGIN
SELECT @CMD = @CMD + ' -attach "' + @ATTACHMENTS + '" '
END
ELSE IF @Attachments IS NOT NULL
BEGIN
SELECT 'NO ATTACHMENT FOUND'
END
EXEC @result = master..xp_cmdShell @CMD, NO_OUTPUT
END
SET NOCOUNT OFF 
```

# regex - 在 Xcode 4 中使用通配符查找和替换

> ID：11471428
> 
> 赞同：8
> 
> 时间：2012-07-13T13:25:28.180
> 
> 标签：regex, xcode4, replace

我正在尝试查找“”标记内的所有文本实例，并在它们之后直接带有分号，并替换“”标记内的文本。因此，例如：

```
"FirstKey" = "First value";
"SecondKey" = "Second value";
"ThirdKey" = "Third value"; 
```

只会在等号之后找到那些值，并且可以一次将它们全部替换（使用单个字符串），如下所示：

```
"FirstKey" = "BLAH";
"SecondKey" = "BLAH";
"ThirdKey" = "BLAH"; 
```

我怎样才能做到这一点？我在 Xcode 3 中发现了一些涉及正则表达式的东西，但这些功能似乎在 Xcode 4 中消失或隐藏了。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-13T13:30:29.970

正则表达式替换在 Xcode 4 中仍然可用。使用“替换”并将样式设置为“正则表达式”，`"([^"]*)";`用作模式并替换为`"BLAH";`。

# python - 表单中缺少cleaned_data（django）

> ID：11471431
> 
> 赞同：4
> 
> 时间：2012-07-13T13:25:32.843
> 
> 标签：python, django, forms

我想创建一个表单和validation_forms，如果另一个框被正确选中，它会检查一些文本是否出现在一个框中，

```
class Contact_form(forms.Form):

def __init__(self):

    TYPE_CHOICE = (
    ('C', ('Client')),
    ('F', ('Facture')),
    ('V', ('Visite'))
    )

    self.file_type = forms.ChoiceField(choices = TYPE_CHOICE, widget=forms.RadioSelect)
    self.file_name = forms.CharField(max_length=200)
    self.file_cols = forms.CharField(max_length=200, widget=forms.Textarea)
    self.file_date = forms.DateField()
    self.file_sep = forms.CharField(max_length=5, initial=';')
    self.file_header = forms.CharField(max_length=200, initial='0')

    def __unicode__(self):
    return self.name

    # Check if file_cols is correctly filled
    def clean_cols(self):
        #cleaned_data = super(Contact_form, self).clean() # Error apears here
    cleaned_file_type = self.cleaned_data.get(file_type)
    cleaned_file_cols = self.cleaned_data.get(file_cols)

    if cleaned_file_type == 'C':
        if 'client' not in cleaned_file_cols:
            raise forms.ValidationError("Mandatory fields aren't in collumn descriptor.")
    if cleaned_file_type == 'F':
        mandatory_field = ('fact', 'caht', 'fact_dat')
        for mf in mandatory_field:
            if mf not in cleaned_file_cols:
                raise forms.ValidationError("Mandatory fields aren't in collumn descriptor.")

def contact(request):

contact_form = Contact_form()
contact_form.clean_cols()
return render_to_response('contact.html', {'contact_form' : contact_form}) 
```

不幸的是，django 一直告诉我他没有重新整理cleaned_data。我知道我错过了有关文档或其他内容的信息，但我无法理解是什么。请帮忙 ！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T13:51:14.717

验证单个字段时，您的 clean 方法应该具有表单的名称

```
clean_<name of field> 
```

例如`clean_file_col`。`form.is_valid()`然后，当您在视图中执行此操作时，它将自动调用。

命名您的方法`clean_cols`表明您有一个名为 的字段`cols`，这可能会导致混淆。

在这种情况下，您的[验证依赖于其他字段](https://docs.djangoproject.com/en/dev/ref/forms/validation/#cleaning-and-validating-fields-that-depend-on-each-other)，因此您应该将您的`clean_col`方法重命名为 simple `clean`。这样，当您`form.is_valid()`在视图中执行此操作时，它将自动调用。

```
def clean(self):
    cleaned_data = super(Contact_form, self).clean()
    cleaned_file_type = self.cleaned_data.get(file_type)
    # ... 
```

最后，在您看来，您还没有将表单绑定到任何数据，

```
contact_form = Contact_form() 
```

所以*总是*`contact_form.is_valid()`会返回 False。您需要使用 将表单绑定到发布数据。有关在视图中使用表单的完整示例和说明，请参阅[Django 文档。](https://docs.djangoproject.com/en/dev/topics/forms/?from=olddocs#using-a-form-in-a-view)*`form = ContactForm(request.POST)`*

# php - 处理有空格的文件名

> ID：11471433
> 
> 赞同：0
> 
> 时间：2012-07-13T13:25:38.173
> 
> 标签：php, codeigniter

我的脚本在这里工作正常：

[codeigniter 中的图像保护](https://stackoverflow.com/questions/11455351/image-protection-in-codeigniter/11464734#11464734)

但是，如果我的文件名有空格，它会显示一个损坏的图像，所以说它是“obama 1.jpg”。

为了尝试解决这个问题，我使用了[http://php.net/manual/en/function.escapeshellarg.php](http://php.net/manual/en/function.escapeshellarg.php)

并将 img_id 中的所有空格替换为 "%"s。

但我没有运气。我不能去掉空格，所以必须使用字符串的结构。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T14:29:22.580

当您调用图像时，只需使用

```
echo urlencode($image_name); 
```

那应该解决它！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T14:00:34.903

如果您在 URL 中使用文件名，请尝试将空格替换为 %20 所以 "obama%201.jpg"

# php - 那是嵌套方法吗？为什么我得到空查询？

> ID：11471438
> 
> 赞同：2
> 
> 时间：2012-07-13T13:25:50.543
> 
> 标签：php, mysql, methods, nested

我想知道为什么我会收到该代码错误？有人可以帮忙吗？我的课是使用嵌套方法从数据库中获取一些信息，假设我得到一个空查询

```
<?php
class db {
 public function __construct(){
 if(mysql_connect("localhost","root","0000")){
     mysql_select_db("myblog");

 }else{
     echo mysql_error();
 }

 }

   public function select($row){
      $sql="SELECT".$row;
      return $this;
   }

   public function from($table){
      $sql.="FROM".$table;
      return $this;
   }

   public function where($condition){
     $sql.="WHERE".$condition;
      return $this;
   }

}
$ddb=new db;
$qq=$ddb->select("*")->from("news")->where("id='1'");
$query=  mysql_query($qq);
while($row=mysql_fetch_object($query)){
    echo $row->title;
}
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T13:33:14.083

您必须定义 __toString() 特殊方法才能将对象用作字符串：

```
class db {

    private $sql = '';

    public function __construct() {
        if (mysql_connect("localhost", "root", "0000")) {
            mysql_select_db("myblog");
        } else {
            echo mysql_error();
        }
    }

    public function select($row) {
        $this->sql = "SELECT ".$row;
        return $this;
    }

    public function from($table) {
        $this->sql .= " FROM ".$table;
        return $this;
    }

    public function where($condition) {
        $this->sql .= " WHERE ".$condition;
        return $this;
    }

    public function __toString() {
        return $this->sql;
    }

}

$ddb = new db();
$qq = $ddb->select("*")->from("news")->where("id='1'");
$query = mysql_query($qq);
while ($row = mysql_fetch_object($query)) {
    echo $row->title;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T13:28:31.110

您需要`$this`在每种方法中使用才能附加到`$sql`

```
 // Declare the class property
   public $sql = "";

   // And use $this->sql in the methods
   // Also note whitespace added around SELECT, FROM, WHERE
   public function select($row){
      $this->sql="SELECT ".$row;
      return $this;
   }

   public function from($table){
      $this->sql.=" FROM ".$table;
      return $this;
   }

   public function where($condition){
     $this->sql.=" WHERE ".$condition;
      return $this;
   } 
```

然后，当您查询它时，请使用`$ddb->sql`，因为您没有返回 SQL 字符串。

```
$ddb->select("*")->from("news")->where("id='1'");
$query = mysql_query($ddb->sql); 
```

不用说，希望您打算调用`mysql_real_escape_string()`您在方法中构造的任何变量`where()`。事实上，你没有特别逃避它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T13:32:28.067

*   在方法中使用而`$this->sql`不是，`$sql``select``from``where`
*   像这样输出查询：`$ddb->select("*")->from("news")->where("id='1'")->sql`或者创建一个`getSQL()`只返回该`$sql`字段的方法并像这样查询它`$ddb->select("*")->from("news")->where("id='1'")->getSQL()`

您还应该考虑创建一个方法来创建一个`mysql_query`（不仅仅是字符串）或一些用于检索方法的方法，因此它更易于使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-13T13:30:21.687

在 $qq 上运行 var_dump

这将立即向您显示问题。

在我看来，您的查询中好像缺少几个空格，并且您没有返回查询字符串 $sql 而是在您的数据库类中返回 $this

# sharepoint - 如何在sharepoint Intranet 上进行更改？

> ID：11471444
> 
> 赞同：-1
> 
> 时间：2012-07-13T13:26:00.377
> 
> 标签：sharepoint, intranet, documents, paragraphs

我将开始在一个共享点站点上工作，我必须改变这个站点管理文档的方式（Word 格式）。目的是管理段落中的文档，以便您可以将与您的搜索匹配的段落组成正确的文档。

问题是我对sharepoint一无所知。你知道我该怎么做吗？使用哪种编程语言？我听说 jQuery 有助于管理共享点网站，你认为这是个好主意吗？感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T13:31:16.333

jQuery 是一个客户端编程库，无法帮助您管理服务器上的文档。要管理服务器上的文档，您必须使用 C# 或 VB.NET 使用 .NET 框架。

# android - 使用画布在android中扭曲的圆圈

> ID：11471445
> 
> 赞同：3
> 
> 时间：2012-07-13T13:26:07.673
> 
> 标签：android, canvas, bitmap, geometry

```
Paint p = new Paint();
    p.setAntiAlias(true);
    p.setColor(Color.DKGRAY);
    int y=getWindowManager().getDefaultDisplay().getWidth();
    Config conf = Bitmap.Config.RGB_565;
    Bitmap bmp =Bitmap.createBitmap(y,y,conf);
    Canvas c = new Canvas(bmp);
    c.drawCircle(y/2 ,y/2, y/3, p);
    iv.setBackgroundDrawable(new BitmapDrawable(bmp)); 
```

通过这段代码，我确实得到了圆圈，它看起来像：- ![](../Images/2f621a63d6d952a3a23999da6947e7aa.png)

现在的问题是它看起来不像一个真正的圆形，它看起来像一个椭圆形..

所以我该怎么做 ？？

提前致谢，....

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T13:40:22.673

```
iv.setBackgroundDrawable(new BitmapDrawable(bmp)); 
```

使用[setImageBitmap()](http://developer.android.com/reference/android/widget/ImageView.html#setImageBitmap%28android.graphics.Bitmap%29)代替,`setBackgroundDrawable()`和`setScaleType()``FIT_CENTER`

# jquery - Moving thumbnails with zoom

> ID：11471449
> 
> 赞同：0
> 
> 时间：2012-07-13T13:26:39.797
> 
> 标签：jquery, zooming, move, thumbnails

Is there a jquery script like on this page: [http://hellomonday.com/](http://hellomonday.com/) ?

I need a 4 rows with thumbnails (that i can move right/left) and when i click them it will zoom and show me big images with some description.

# android - 在 VpnService.Builder 中传递用户名和密码的方法

> ID：11471465
> 
> 赞同：23
> 
> 时间：2012-07-13T13:28:18.177
> 
> 标签：android, vpn

我正在开发要在其中使用 VPN 网络的应用程序。要在设备中创建 VPN 网络，我们需要从设备的（设置-无线和网络-VPN 设置）菜单中对其进行配置。

我想通过带有硬编码信息的代码进行这么多设置。

从 API 级别 4.0 开始，android 提供 API 来处理[VPN 服务](http://developer.android.com/reference/android/net/VpnService.Builder.html)。

为了了解这些方法的实现，我使用了 Android ToyVPN 的示例项目。但是在这么多方法中，我没有找到任何传递用户名和密码的方法。我必须连接 VPN 网络的信息是。

1.  VPN 服务器名称
2.  用户名
3.  密码

如果我从设备手动配置，则使用这三个信息可以成功连接到 VPN 网络。但我想以编程方式执行此操作。这是用于连接到 VPN 网络的类文件。 [ToyVpnClient.java](http://pastie.org/4249892)和[ToyVpnService.java](http://pastie.org/4249896)。除了这个示例应用程序是设备崩溃。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-12T09:37:10.217

你说的[VpnService](http://developer.android.com/reference/android/net/VpnService.html)不是你想的那样。它只是一个供您创建自己的 VPN 解决方案的框架。建立后，您将获得网络 (IP) 层上的所有通信，您可以使用它做任何您想做的事情，例如，加密并将其发送到您的服务器 - 示例是 /samples/ 中的 ToyVpn 项目android-14/ 目录。您还需要自己的服务器端代码来进行解密和必要的流量路由。

不幸的是，您不能以编程方式设置内置的 android VPN。您可以做的最好的事情是向用户显示一个对话框，解释如何设置它，然后弹出系统设置并显示正确的屏幕。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-20T06:16:13.193

可以使用内部 android.jar(com.android.internal) 和 hidden(@hide) API。请参考以下链接：

[如何使用 Android 4.0 以编程方式创建新的 VPN 接口？](https://stackoverflow.com/questions/8921457/how-to-programmatically-create-a-new-vpn-interface-with-android-4-0?rq=1)

# symfony - Twig - 在实体项内显示一个属性

> ID：11471466
> 
> 赞同：1
> 
> 时间：2012-07-13T13:28:19.903
> 
> 标签：symfony, doctrine, entity, twig, arraycollection

我有一个实体，它的 items 属性是一个项目实体数组。item 实体具有 id 和 name 属性。

我想要做的是获取 entity.items 并显示所有名称属性，用逗号分隔。

我现在的方式：

```
<tr>
        <th>Items</th>
        <td>
            {% for item in entity.items %}
                {{ item.name }}
            {% endfor %}
        </td>
</tr> 
```

但它不是用逗号分隔的。我尝试了[加入](http://twig.sensiolabs.org/doc/filters/join.html)过滤器，但我找不到在这种情况下使用它的方法，因为我有一个对象数组。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-13T13:38:56.127

您可以将 twig 语法与常规 HTML 结合使用。{%%} 标记表示标签，告诉 twig 有一些渲染逻辑，但您不需要在标签内严格编写 twig 语法。所以：

```
{% for item in entity.items %}
    {{ item.name }}{% if not loop.last %}, {% endif %}
{% endfor %} 
```

会很好用

# templates - 覆盖社区池中的 adminhtml 块模板

> ID：11471467
> 
> 赞同：0
> 
> 时间：2012-07-13T13:28:20.307
> 
> 标签：templates, magento, overriding, block, adminhtml

**是否可以通过在社区池中**创建新模块来覆盖位于此处的模板`/app/design/adminhtml/default/default/template/`（例如） ？`/app/design/adminhtml/default/default/template/customer/edit/js.phtml`

 **所以问题是我**不想**通过将文件（或任何东西）放在本地池中来覆盖它。

是否可以通过扩展适当的块类或类似的东西来做到这一点？

我在其中创建了相同的文件`/app/design/adminhtml/default/my_directory/template/`并在其中扩展`Mage_Adminhtml_Block_Customer_Edit`了类，`/app/code/community/MyCompany/MyModule/Block/Adminhtml/Customer/Edit.php`但不知道如何解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T18:40:27.323

在您的模块的配置 ( `app/code/community/MyCompany/MyModule/etc/config.xml`) 中添加以下部分：

```
<adminhtml>
    <layout>
        <updates>
            <mycompany_mymodule>
                <file>mycompany_mymodule.xml</file>
            </mycompany_mymodule>
        </updates>
    </layout>
</adminhtml> 
```

这将使 mage 寻找一个新文件，`app/design/adminhtml/default/layout/mycompany_mymodule.xml`其中应如下所示：

```
<?xml version="1.0"?>
<layout>
    <adminhtml_customer_edit>
        <reference name="customer.edit.js">
            <action method="setTemplate">
                <template>mydirectory/edit/js.phtml</template>
            </action>
        </reference>
    </adminhtml_customer_edit>
</layout> 
```

然后处理您的文件`app/design/adminhtml/default/template/mydirectory/edit/js.phtml`。可能不需要替换/扩展当前块，因为它已经做得很好了。**

# jquery - 验证引擎未使用 onValidationComplete 提交表单

> ID：11471470
> 
> 赞同：3
> 
> 时间：2012-07-13T13:28:26.213
> 
> 标签：jquery, jquery-validation-engine

```
$(document).ready(function(){
    jQuery("#bbSignup").validationEngine('attach', {
  onValidationComplete: function(form, status){
      if ( status == "true" ) {
$("#bbSignup").submit();
    $("#bbSignup").hide();
    $("#bbRegister").insertAfter("Form Submitted");
      } else {

      }
  }  
});
   }); 
```

如果我填写所有表格并点击提交，什么都不会发生。即使按多次也无济于事。有任何想法吗？

**- -编辑 - -**

我把它改成这样：

```
jQuery("#bbSignup").validationEngine('attach', {
onValidationComplete: function(form, status){
if ( status == "true" ) {
alert(" The status is " + status + " and will submit ");
} else {
alert(" The status is " + status + " and will not submit ");
}
}  
}); 
```

如果未填写任何内容，则 else 警报会正确触发。如果所有内容都已填写，则警报会显示“状态为真，不会提交”。所以这就像 if status == true 永远不会被调用..奇怪

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-26T18:50:34.847

如果一个函数被分配给 onValidationComplete ，那么它会被执行*而不是*提交的表单，所以你的描述正是 jQuery-Validation-Engine 的设计目的。

在 jQuery-Validation-Engine 版本 2.6.4 之前，这是唯一的行为，从这个版本开始，您可以在 onValidationComplete 中返回 true 来告诉验证引擎继续提交表单。如果函数没有返回值，默认行为仍然是停止提交。

有关处理返回值的更改，请参阅[https://github.com/posabsolute/jQuery-Validation-Engine/pull/442 。](https://github.com/posabsolute/jQuery-Validation-Engine/pull/442)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T13:51:32.987

这只是一个猜测，但你在询问`status`，就好像它拿着一根绳子。由于您正在测试字符串`"true"`，`"false"`但是，它似乎更有可能包含一个布尔值。

尝试简单

```
if (status) { //test it against the boolean true, not string "true" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-21T02:55:19.560

**试试这个...**

```
<script>
  jQuery(document).ready( function() {
    jQuery("#formID").validationEngine('attach',{
     onValidationComplete: function(form, status){
      if (status == true){
       YourFunctionReload();
       // here :)
       return true;
      }}});
    });
</script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-12T09:04:53.167

请试试这个，希望它对你有用..

```
$('#formID').validationEngine('attach',{
    onValidationComplete: function(form, status){

        if (status == true){
            $("#formID").submit();
            return true;
        }

    }
}); 
```

# java - 从java进程附加到外部c++进程导致问题

> ID：11471473
> 
> 赞同：0
> 
> 时间：2012-07-13T13:28:32.670
> 
> 标签：java, c++

我正在尝试使用 java.lang.process 附加 C++ 可执行文件。构建 exec 的代码如下：

```
int main(int, char**){

std::cout << "Starting Up. . . . . " << std::endl;
std::string command;

while (command != "exit")
{
    std::cin >> command;
}

return 0;
} 
```

在调试时，我发现在进程的创建期间，进程在 std::cin 上停止并期望输入该值，但在下一次迭代中，它会自动获取先前的“命令”std::cin 值并继续迭代“ while' 循环而不将控制权返回给 java 进程。为什么 c++ 可执行文件在每次迭代时都不会在 std::cin 处停止？我正在使用 Process.getOutputStream() 从 java 传递值。如果描述有任何问题，请告诉我。谢谢，托尔。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T14:21:51.670

最有可能的是，没有有效的输入或模拟了某种 EOF。您应该检查输入是否有错误：

```
while ( std::cin && command != "exit" )
{
    std::cin >> command;
} 
```

# facebook - Facebook 应用程序被入侵/被黑

> ID：11471486
> 
> 赞同：0
> 
> 时间：2012-07-13T13:28:59.130
> 
> 标签：facebook

我有一段时间没有使用我的 facebook 应用程序了，当我今天尝试访问它时，它不想加载。当我禁用安全浏览时，当我从画布 url 加载应用程序时，Chrome 给了我以下警告：

“apps.facebook.com 包含来自 methuenedge.com 的内容，该网站已知会分发恶意软件。如果您访问该网站，您的计算机可能会感染病毒。”

我该如何解决这个问题？我的应用程序机密是否已被泄露？如果是这样，并且如果我需要重置我的应用程序密码，我的应用程序的当前用户仍然可以访问它还是需要重新安装？

谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T13:39:37.313

如果您仍然可以访问开发者应用程序并看到您是该应用程序的唯一开发者，那么您的 Facebook 应用程序配置不太可能被黑客入侵。可能发生的情况是托管您的应用程序的网站可能已被黑客入侵，并且在您的 HTML 代码中放入了不好的东西。当您转到应用程序的直接 URL 时，您是否收到相同的警告？例如 www.myhostingprovider/myaccount/appname/index.php 等而不是apps.facebook.com/appname）

# iphone - 拉伸绘制的形状以适合框架？

> ID：11471490
> 
> 赞同：1
> 
> 时间：2012-07-13T13:29:21.600
> 
> 标签：iphone, ios, cocoa-touch, core-graphics

我有一个应用程序，我正在绘制一个特殊的椭圆，我通过一系列贝塞尔路径制作了如下：

```
CGContextRef context = UIGraphicsGetCurrentContext();
CGContextSaveGState(context);

CGMutablePathRef pPath_0 = CGPathCreateMutable();
CGPathMoveToPoint(pPath_0, NULL, 515.98,258.24);
CGPathAddCurveToPoint(pPath_0, NULL, 515.98,435.61,415.54,515.98,258.24,515.98);
CGPathAddCurveToPoint(pPath_0, NULL, 100.94,515.98,0.50,435.61,0.50,258.24);
CGPathAddCurveToPoint(pPath_0, NULL, 0.50,80.86,100.94,0.50,258.24,0.50);
CGPathAddCurveToPoint(pPath_0, NULL, 415.54,0.50,515.98,80.86,515.98,258.24);
CGPathCloseSubpath(pPath_0);
CGContextSetRGBFillColor(context, 1.0000, 1.0000, 1.0000, 1.0000);

CGContextSetRGBStrokeColor(context,0.0000,0.0000,0.0000,1.0000);
CGContextSetLineWidth(context, 1);
CGContextSetMiterLimit(context, 10.0000);

CGContextAddPath(context, pPath_0);
CGContextDrawPath(context, kCGPathFillStroke);
CGPathRelease(pPath_0);
CGContextRestoreGState(context); 
```

我想知道，在核心图形中有什么方法可以让我采用我刚刚创建的形状并水平和垂直拉伸它，使其完美地适合其视图框架？IE，所以我不必手动进入我的所有点和值并根据视图边界编写它们？我知道这种形状不会那么困难，但我有一些更复杂的形状更耗时，我宁愿避免这样做..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T22:15:54.837

发现可以使用：

```
CGAffineTransform transform = CGAffineTransformMakeScale(frame.size.width/shapeWidth, frame.size.height/shapeHeight);
CGMutablePathRef mutablePathTransform = CGPathCreateMutableCopyByTransformingPath(mutablePath, &transform); 
```

# sql - 如何在选择查询中使用别名并将它们加在一起

> ID：11471491
> 
> 赞同：3
> 
> 时间：2012-07-13T13:29:23.183
> 
> 标签：sql, database, select

我有以下疑问。我想使用别名并将它们添加在一起，但 SQL 不允许这样做。关于如何在不重复查询的情况下解决此问题的任何建议？使用 Microsoft SQL Server 2008

```
SELECT    
SUM(CASE WHEN rg.category = 'Space' THEN ((rg.score*20)) END) As space,
SUM(CASE WHEN rg.category = 'QPR' THEN ((rg.score*20)) END) As qpr,

(space + qpr) As result
FROM rg_fin As rg JOIN...../*query goes on*/ 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T13:32:37.800

您可以将查询包装为子查询

```
SELECT *,
  (space + qpr) As result 
FROM
(
  SELECT     
  SUM(CASE WHEN rg.category = 'Space' THEN ((rg.score*20)) END) As space, 
  SUM(CASE WHEN rg.category = 'QPR' THEN ((rg.score*20)) END) As qpr
  ....
 ) subquery 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T13:42:39.833

如果要使用别名，则需要将查询包装在另一个查询中：

```
SELECT space
    , qpr
    , space + qpr as result
FROM
(
    SELECT    
    SUM(CASE WHEN rg.category = 'Space' THEN ((rg.score*20)) END) As space,
    SUM(CASE WHEN rg.category = 'QPR' THEN ((rg.score*20)) END) As qpr,

    (space + qpr) As result
    FROM rg_fin As rg JOIN...../*query goes on*/
) x 
```

或者，如果您不需要使用别名，那么您可以重复这些字段：

```
SELECT    
    SUM(CASE WHEN rg.category = 'Space' THEN ((rg.score*20)) END) As space,
    SUM(CASE WHEN rg.category = 'QPR' THEN ((rg.score*20)) END) As qpr,

    (SUM(CASE WHEN rg.category = 'Space' THEN ((rg.score*20)) END) 
    + SUM(CASE WHEN rg.category = 'QPR' THEN ((rg.score*20)) END)) As result
FROM rg_fin As rg JOIN...../*query goes on*/ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-13T13:31:52.060

您可以使用子查询来执行此操作：

```
select 
  space, 
  qpr, 
  (space + qpr) As result
from (
  select
  SUM(CASE WHEN rg.category = 'Space' THEN ((rg.score*20)) END) As space,
  SUM(CASE WHEN rg.category = 'QPR' THEN ((rg.score*20)) END) As qpr,
  FROM rg_fin As rg JOIN...../*query goes on*/
) as a 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-13T13:32:32.230

使用派生表

```
SELECT 
    space,qpr,(space + qpr) As result 
FROM
(
SELECT     
SUM(CASE WHEN rg.category = 'Space' THEN ((rg.score*20)) END) As space, 
SUM(CASE WHEN rg.category = 'QPR' THEN ((rg.score*20)) END) As qpr, 

(space + qpr) As result 
FROM rg_fin As rg JOIN...../*query goes on*/ 
) as t 
```

# android - Android下线程的替代方法

> ID：11471496
> 
> 赞同：10
> 
> 时间：2012-07-13T13:29:56.360
> 
> 标签：android, multithreading, parallel-processing, actor, coroutine

Android 的 Java 和 Oracle 的 Java 略有不同。是否可以使用以下演员或协程

*   [http://code.google.com/p/jetlang/](http://code.google.com/p/jetlang/)
*   [http://incubator.apache.org/s4/](http://incubator.apache.org/s4/)
*   [http://www.malhar.net/sriram/kilim/](http://www.malhar.net/sriram/kilim/)
*   [http://code.google.com/p/coroutines/](http://code.google.com/p/coroutines/)

Android 也是为了避免使用线程并在 Android 的 Java 和 Oracle 的 Java 之间共享更多代码？是否还有其他适用于这两个 Java 版本的框架。

先感谢您。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-15T07:06:06.577

您应该尝试来自 Java 版本的 Akka 的演员：http: [//doc.akka.io/docs/akka/snapshot/java/untyped-actors.html](http://doc.akka.io/docs/akka/snapshot/java/untyped-actors.html)

它允许使用最佳实践轻松扩展 Actor 拓扑（不通过 Java 引用直接访问 Actor，将故障限制在区域，使用调度程序区域限制过载等） - 所有这些都在“Scala in Depth”一书的免费副本中进行了描述： [http://typesafe.com/resources/scala-in-depth](http://typesafe.com/resources/scala-in-depth)

[这是在 Android 上使用Akka](https://github.com/akka/akka/blob/master/akka-samples/akka-sample-fsm/src/main/scala/DiningHakkersOnBecome.scala) FSM 的演员动态行为的 示例（带有演示[http://vimeo.com/20303656）：https://github.com/akka/akka/blob/master/akka-samples/akka-sample](http://vimeo.com/20303656) [-fsm/src/main/scala/DiningHakkersOnBecome.scala](https://github.com/akka/akka/blob/master/akka-samples/akka-sample-fsm/src/main/scala/DiningHakkersOnBecome.scala)

您也可以尝试使用 Functional Java 的轻量级演员： [https ://github.com/functionaljava/functionaljava/blob/master/core/src/main/java/fj/control/parallel/Actor.java](https://github.com/functionaljava/functionaljava/blob/master/core/src/main/java/fj/control/parallel/Actor.java)

JVM 演员的最简约版本在这里： [https](https://github.com/plokhotnyuk/actors/blob/master/src/test/scala/com/github/gist/viktorklang/Actor.scala) ://github.com/plokhotnyuk/actors/blob/master/src/test/scala/com/github/gist/viktorklang/Actor.scala （这里描述的功能：[如何在没有 Akka 的情况下实现 Actor 模型？](https://stackoverflow.com/questions/27657970/how-to-implement-actor-model-without-akka/27661385#27661385)）

# javascript - 在 Google Map API 中设置邮政编码边界

> ID：11471497
> 
> 赞同：14
> 
> 时间：2012-07-13T13:30:03.870
> 
> 标签：javascript, google-maps, google-maps-api-3, zipcode

我已经看到了对类似问题的所有回复，但是，它们要么都是旧的，要么没有人回答过。

我的任务是获取邮政编码并在谷歌地图上向用户显示其对应的边界，就像在[这个例子](http://maps.huge.info/zip.htm)中一样。

我正在用 Javascript 编写此代码并使用 Google Maps API。我希望用户输入一个邮政编码，然后一个标记下拉到他们的目的地，并带有一个代表该邮政编码区域的边框。我看到谷歌地图目前在他们的地图代码中有一些东西，如果有人在 maps.google.com 上输入邮政编码，就可以看到边界。我使用过多边形，但这无助于在某个邮政编码周围制作边框。

关于如何获得这个的任何建议？

提前致谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-13T13:56:39.197

据我所知，对此没有一个简单的答案。但这里是如何做到这一点的高级设计。

邮政编码的所有形状文件都可以在人口普查网站上找到，并且可以从[这个 ftp 服务器](ftp://ftp2.census.gov/geo/tiger/TIGER2010/ZCTA5/2010/)下载。但是，这是大量数据，因此您需要一个地方来存储它。我建议使用带有 PostGIS 插件的 PostgreSQL 数据库。它是免费和开源的，而且通常很棒。它具有将 .shp 文件（人口普查形状文件中的类型）转换为 PostGIS 几何形式的实用程序。PostGIS 让您以 KML 形式检索形状。

您可以 a) 在需要时以 KML 形式从数据库中检索形状并将其显示在地图上，或者 b) 提前为每个邮政编码预先生成一个 kml 文件并在需要时检索一个文件（这将占用相当多的空间）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-24T11:33:25.190

您需要熟悉 GeoJSON 格式的 FeatureCollections。您可以使用 OpenLayers（或者也可能是 Google API）在任何一组地图图块上渲染它们

这可能看起来很难，但完全可以接受。

如果您四处搜索，您可以购买邮政编码组的 GeoJSON 文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-07-26T09:33:02.647

从这里下载 shapefile [https://catalog.data.gov/dataset/tiger-line-shapefile-2019-2010-nation-us-2010-census-5-digit-zip-code-tabulation-area-zcta5-na](https://catalog.data.gov/dataset/tiger-line-shapefile-2019-2010-nation-u-s-2010-census-5-digit-zip-code-tabulation-area-zcta5-na)

# 使用 GDAL 进行简化

我们可以使用 GDAL 库中的 ogr2ogr 命令将 shapefile 转换为 geojson，但即使只有一个字段和简单的坐标，输出文件也超过 1GB。

`ogr2ogr -f GeoJSON -select ZCTA5CE10 -lco COORDINATE_PRECISION=6 zcta.geojson /vsizip/tl_2017_us_zcta510.zip`

我试图将其简化为 topojson，但即使在功能非常强大的 2017 MacBook Pro 上，topojson 库也会对此感到窒息。

`npx topojson -q 1e4 -o zcta_topo.json zcta.geojson` >> JavaScript 内存不足

我尝试的另一种方法是在 ogr2ogr 中使用 -simplify 选项。简化参数是基于 shapefile 的空间参考系统的测量单位。由于 ZCTA 的 srs 是 WGS84，因此单位是纬度/经度度量。

`ogr2ogr -f "GeoJSON" -lco COORDINATE_PRECISION=6 -select ZCTA5CE10 -simplify 0.006 zcta.geojson /vsizip/tl_2017_us_zcta510.zip`

这将创建一个更小的 GeoJSON 文件 (30MB)，TopoJSON 可以轻松处理它，我们最终得到一个更易于管理（但仍然太大）的 13MB topojson 文件。此外，数据集的拓扑结构在中到大尺度上非常差。

`npx topojson -q 1e5 -o zcta_topo.json zcta.geojson`

# 使用 Postgis 进行简化

创建一个 docker 卷以用于持久性 docker volume create postgresql

运行 postgis 泊坞窗

`docker run --name postgis -p 25432:5432 -it --mount source=postgresql,target=/var/lib/postgresql kartoza/postgis`

将 zcta shapefile 加载到 postgis

`ogr2ogr -f "PostgreSQL" -progress -select "ZCTA5CE10" -overwrite -lco OVERWRITE=yes -nln zcta -nlt PROMOTE_TO_MULTI -t_srs "EPSG:4326" PG:"dbname='gis' host='localhost' port='25432' user='docker' password='docker'" ~/Downloads/tl_2017_us_zcta510/tl_2017_us_zcta510.shp`

使用 st_simplifypreservetopology（新英格兰）的示例查询。这需要很长时间才能运行到整个国家，而且我们仍然会丢失很多拓扑。

`select st_simplifypreservetopology(wkb_geometry, 0.025) as thegeom, zcta5ce10 from zcta where zcta5ce10 like '0%' OR zcta5ce10 like '1%'`

# 使用 Mapshaper 进行简化（最佳解决方案）

Mapshaper 库可以直接从 shapefile 输出 TopoJSON，而不会出现 JavaScript 内存堆错误。这个命令创建了一个我们可以使用的 ~6MB topojson 文件。通过假设非常接近的顶点和边应该重合，它还设法很好地保持拓扑。

`npx -p mapshaper mapshaper-xl tl_2017_us_zcta510.shp snap -simplify 0.1% -filter-fields ZCTA5CE10 -rename-fields zip=ZCTA5CE10 -o format=topojson zcta_mapshaper.json`

来源：[https ://github.com/elastic/ems-file-service/issues/6](https://github.com/elastic/ems-file-service/issues/6)

# mysql - 表字段的总和，无论用户是否存在

> ID：11471501
> 
> 赞同：0
> 
> 时间：2012-07-13T13:30:11.187
> 
> 标签：mysql, sum

我有一个脚本可以在一个简单的成就类型脚本中计算用户点数，然后按顺序将它们显示在网页上。我有以下 mySQL 函数，但如果用户还没有任何积分（即没有找到“pa.userid”，则根本不会获取用户）

```
SELECT u.userid,
SUM(IF(pa.plus = '1', pa.points_amount, 0)) - SUM(IF(pa.plus = '0', pa.points_amount, 0)) AS points
FROM awarded_points pa,
users u WHERE u.userid = pa.userid 
GROUP BY u.userid 
ORDER BY points DESC 
LIMIT 10 
```

我将如何使上述代码包含尚未获得任何积分的用户？这是一个复杂的变化吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T13:32:47.537

用一个`left outer join`

```
SELECT u.userid,
       SUM(IF(pa.plus = '1', pa.points_amount, 0)) - SUM(IF(pa.plus = '0', pa.points_amount, 0)) AS points
FROM users u
LEFT OUTER JOIN awarded_points pa ON u.userid = pa.userid 
GROUP BY u.userid 
ORDER BY points DESC 
LIMIT 10 
```

看到[关于连接的精彩解释](http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T13:35:30.013

使用左连接

```
SELECT u.userid, 
SUM(IF(pa.plus = '1', pa.points_amount, 0)) - SUM(IF(pa.plus = '0', pa.points_amount, 0)) AS points 
FROM users as u left join awarded_points pa 
ON u.userid = pa.userid  
GROUP BY u.userid  
ORDER BY points DESC  
LIMIT 10 
```

# web-services - 我可以在同一台服务器上部署 CakePHP Web 应用程序和 BottlePy 基础 WebServices API 吗？

> ID：11471502
> 
> 赞同：0
> 
> 时间：2012-07-13T13:30:11.727
> 
> 标签：web-services, apache, cakephp, web-applications, bottle

我在 Apache（LAMP 堆栈）上部署了一个基于 CakePHP 的 Web 应用程序。现在我正在使用bottlePy 做一个Web 服务API，它将公开服务以供Android 应用程序使用。问题是这两个应用程序都将使用相同的 MySql DB 表并读/写相同的表。这样做的原因是因为基于 CakaPHP 的应用程序已经可用并且在不久前就完成了。现在我们需要做一个 Android 应用程序，因此需要公开一个 Web 服务 API，因为我更喜欢 Python，所以我宁愿使用。但在我深入这个方向之前，我想得到以下答案：

1.  我可以在同一个 Apache 服务器上同时提供 CakePHP Web 应用程序和基于 BottlePy 的 Web 服务 API 吗？如果不是，那将是什么替代品？

2.  两个不同的应用程序访问同一个 MySQL 数据库是否会导致锁定、数据完整性等方面的任何问题？

3.  还有什么我需要注意的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T02:59:26.880

所以，无论如何我已经实现了它并且它一直工作得很好。我想这回答了这个问题，是的，它可以做到。

1.  我从同一个 apache 服务器同时提供了 cakephp 和 bottlepy 应用程序。

2.  我还没有看到任何问题，并且数据是从连接到 Android 应用程序的 cakephp Web 应用程序和 Bottlepy Web api 写入的。

3.  从同一个 apache 服务器获取 cakephp 和 bottlepy 有点棘手，但我得到了它的工作。我不是网络服务器专家，所以不知道我遇到的问题是微不足道的还是我解决了一些困难的问题。无论哪种情况，它都在工作。如果您遇到类似的问题，请告诉我，我将发布有关我如何进行设置的详细回复。

# c - 在C中强制无序结构字段

> ID：11471504
> 
> 赞同：4
> 
> 时间：2012-07-13T13:30:13.793
> 
> 标签：c, optimization, data-structures, struct

我正在研究将面向对象语言转换为 C 以优化 puproses，但我遇到了设计问题。

考虑为转换器提供以下伪语言类：

```
class C {
    int a;
    double b;
    int c;

    constructor C(int value) {
        this.a = value;
        this.b = this.a / 10.0;
        this.c = 0;
    }

    void say() {
        print(this.b);
    }
} 
```

直截了当地说，我们可以在 C 中将这个类表示为这样的结构（跳过错误检查）：

```
typedef struct {
    int a;
    double b;
    int c;
} _class_C;

_class_C* _ctor_C(int value) {
    this = malloc(sizeof(_class_C));

    this->a = value;
    this->b = this->a / 10.0;
    this->c = 0;

    return this;
}

void _method_C_say(_class_C *this) {
    printf("%.2f", this->b);
}

void _dtor_C(_class_C *this) {
    free(this);
} 
```

这个解决方案受到 C 编译器所绑定的承诺的影响——不要在结构中添加、删除或更改字段的顺序。因此，尽管没有使用事实字段`a`，`c`但它们会使代码膨胀。

**如何实现“无序字段”行为？**如果我只有一个 static `C`，它可以写成如下：

```
int _staticfield_C_a;
double _staticfield_C_b;
int _staticfield_C_c;

void _ctor_C(int value) {
    _staticfield_C_a = value;
    _staticfield_C_b = _staticfield_C_a / 10.0;
    _staticfield_C_c = 0;
}

void _staticmethod_C_say() {
    printf("%.2f", _staticfield_C_b);
} 
```

因此编译器可以将冗余或未使用的字段优化到 sole ，但是当可以动态实例化`_staticfield_C_b`时我应该使用什么解决方案，而且我根本不介意字段的顺序、内存布局和代码的可读性？`C`

**更新：**应该注意的是，我并没有试图强制编译器使用*structs*来做魔术，我想要一些*替换*它们的行为就像 struct 具有无序字段 - 就像我在静态示例中提供的那样，无论可读性级别如何.

**更新：**评论中有一种流行的观点认为我的问题与转换器本身的设计有关，比如我为它选择了错误的范式或语言。Converter 本身是用 Python 编写的，它获取通用的面向对象程序的源代码，对其进行处理并输出等效的 C 代码进行编译，因此您可以将其视为跨语言编译器。我很高兴向我解释我应该在哪里以及如何使用结构，但在这种情况下，我需要一些魔法帮助来简化优化:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T15:51:44.987

听起来您正在尝试让编译器（或链接器 - 您提到的“删除未使用的对象”优化实际上在那里完成）来自动为您检测未使用的结构字段。不能，因为不可能。这是一个全局优化——你需要知道在宇宙中任何地方都没有引用给定字段的代码。但是，如果代码将来会动态绑定到引用该字段的某些内容（代码不是当前链接的一部分）怎么办？用相同的头文件编译一个库怎么样。鉴于编译器不知道如何使用它，编译器应该制作多大的结构？

如果你想做这个优化，恐怕你得自己做。C 语言没有可用的工具。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T14:03:10.057

您是否考虑`Unions`过作为替代方案`Structs`？

如果您一次只使用一个字段并且担心内存问题，那么这是完美的数据结构。

# javascript - 使用 Javascript 读取文件

> ID：11471506
> 
> 赞同：1
> 
> 时间：2012-07-13T13:30:20.217
> 
> 标签：javascript, html

我正在构建一个 html 表单，显示从目的地 1 到目的地 2 的旅行价格

问题是，“价格”存储在一个 excel 文件中（可以更改为几乎任何格式）所以有没有办法使用 javascript 来查找从destination1 到destination2 的价格？

恐怕我不能预先发布任何代码（可能是因为我不知道从哪里开始）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T13:33:36.513

使用新的[HTML5 File API](https://developer.mozilla.org/en/Using_files_from_web_applications/)，您可以读取本地文件或使用 XMLHttpRequest 下载文件。

我建议使用 CSV 格式进行阅读，因为它比 Excel 文件更容易解析。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T13:33:20.873

我不知道它是否是你需要的，但你不能使用 ActiveXObject 来读取 Excel 文件。

[http://www.codeproject.com/Questions/85672/Read-Excel-values-using-Javascript](http://www.codeproject.com/Questions/85672/Read-Excel-values-using-Javascript)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T13:33:33.417

如果您只支持现代浏览器（html5），您可以使用文件系统api ...

[http://www.html5rocks.com/en/tutorials/file/dndfiles/](http://www.html5rocks.com/en/tutorials/file/dndfiles/)

但是，较旧的浏览器（据我所知）不支持读取文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-13T13:34:12.393

使用 Html5 File API，也许至少有 CSV 会很棒

[http://www.w3.org/TR/FileAPI/](http://www.w3.org/TR/FileAPI/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-16T10:31:19.033

正如 quentin 建议的那样，使用 JSON 解决了​​我的问题

[将 csv 转换为 JSON](http://www.cparker15.com/code/utilities/csv-to-json/)是一个巨大的帮助 aswel

# delphi - 如何使用 Synapse 发送文件和其他 POST 数据

> ID：11471513
> 
> 赞同：2
> 
> 时间：2012-07-13T13:31:08.363
> 
> 标签：delphi, file, http, post, synapse

**德尔福使用：** 2007。

你好，

我有一个带有两个文本输入和一个文件输入的简单网页。现在，要发送表单，必须填写文本输入和文件输入。通过 Synapse，我知道如何上传文件 ( *HttpPostFile* ) 以及如何发布数据 ( *HttpMethod* )。但是，我不知道如何做到这两点。

在查看了 Synapse 的源代码之后，我想我必须用边界或类似的东西来“格式化”我的数据。我想我的输入文件应该有一个边界，而我的文本输入应该有另一个边界。我找到了一篇关于这个主题的文章，但它是关于发送电子邮件附件的。我试图用 Synapse 重现他们所说的话，但没有结果。

*HttpPostFile*的代码：

```
function HttpPostFile(const URL, FieldName, FileName: string;
  const Data: TStream; const ResultData: TStrings): Boolean;
var
  HTTP: THTTPSend;
  Bound, s: string;
begin
  Bound := IntToHex(Random(MaxInt), 8) + '_Synapse_boundary';
  HTTP := THTTPSend.Create;
  try
    s := '--' + Bound + CRLF;
    s := s + 'content-disposition: form-data; name="' + FieldName + '";';
    s := s + ' filename="' + FileName +'"' + CRLF;
    s := s + 'Content-Type: Application/octet-string' + CRLF + CRLF;
    WriteStrToStream(HTTP.Document, s);
    HTTP.Document.CopyFrom(Data, 0);
    s := CRLF + '--' + Bound + '--' + CRLF;
    WriteStrToStream(HTTP.Document, s);
    HTTP.MimeType := 'multipart/form-data; boundary=' + Bound;
    Result := HTTP.HTTPMethod('POST', URL);
    if Result then
      ResultData.LoadFromStream(HTTP.Document);
  finally
    HTTP.Free;
  end;
end; 
```

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T21:33:55.237

你的代码很接近。您只发送文件字段，而不发送文本字段。要做到这三个，试试这个：

```
function HttpPostFile(const URL, InputText1FieldName, InputText1, InputText2FieldName, InputText2, InputFileFieldName, InputFileName: string; InputFileData: TStream; ResultData: TStrings): Boolean; 
var 
  HTTP: THTTPSend; 
  Bound: string; 
begin 
  Bound := IntToHex(Random(MaxInt), 8) + '_Synapse_boundary'; 
  HTTP := THTTPSend.Create; 
  try 
    WriteStrToStream(HTTP.Document,
      '--' + Bound + CRLF +
      'Content-Disposition: form-data; name=' + AnsiQuotedStr(InputText1FieldName, '"') + CRLF +
      'Content-Type: text/plain' + CRLF +
      CRLF); 
    WriteStrToStream(HTTP.Document, InputText1); 
    WriteStrToStream(HTTP.Document,
      CRLF +
      '--' + Bound + CRLF +
      'Content-Disposition: form-data; name=' + AnsiQuotedStr(InputText2FieldName, '"') + CRLF +
      'Content-Type: text/plain' + CRLF +
      CRLF); 
    WriteStrToStream(HTTP.Document, InputText2); 
    WriteStrToStream(HTTP.Document,
      CRLF +
      '--' + Bound + CRLF +
      'Content-Disposition: form-data; name=' + AnsiQuotedStr(InputFileFieldName, '"') + ';' + CRLF + 
      #9'filename=' + AnsiQuotedStr(InputFileName, '"') + CRLF +
      'Content-Type: application/octet-string' + CRLF +
      CRLF); 
    HTTP.Document.CopyFrom(InputFileData, 0); 
    WriteStrToStream(HTTP.Document,
      CRLF +
      '--' + Bound + '--' + CRLF); 
    HTTP.MimeType := 'multipart/form-data; boundary=' + Bound; 
    Result := HTTP.HTTPMethod('POST', URL); 
    if Result then 
      ResultData.LoadFromStream(HTTP.Document); 
  finally 
    HTTP.Free; 
  end; 
end; 
```

如果你切换到 Indy，你可以使用它的`TIdMultipartFormDataStream`类：

```
function HttpPostFile(const URL, InputText1FieldName, InputText1, InputText2FieldName, InputText2, InputFileFieldName, InputFileName: string; InputFileData: TStream; ResultData: TStrings): Boolean; 
var 
  HTTP: TIdHTTP; 
  Input: TIdMultipartFormDataStream;
  Output: TMemoryStream;
begin 
  Result := False;
  try
    Output := TMemoryStream.Create;
    try
      HTTP := TIdHTTP.Create; 
      try 
        Input := TIdMultipartFormDataStream.Create;
        try
          Input.AddFormField(InputText1FieldName, InputText1);
          Input.AddFormField(InputText2FieldName, InputText2);
          Input.AddFormField(InputFileFieldName, 'application/octet-stream', '', InputFileData, InputFileName);
          HTTP.Post(URL, Input, Output);
        finally
          Input.Free;
        end;
      finally
        HTTP.Free;
      end;
      Output.Position := 0;
      ResultData.LoadFromStream(Output);
      Result := True; 
    finally
      Output.Free;
    end;
  except
  end; 
end; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-31T20:07:47.797

我也在我的项目中使用突触。为了使用 Synapse 让我的工作变得简单和快速，我编写了 THTTPSendEx 类，它提供了快速的使用速度和最少的代码和更多的功能。目前它是一个测试版。

这是像印地的观点。

创建 THTTPSendEx 类。从它的原型创建方法 OnBeginWork、OnWork、OnWorkEnd（参见 pas 文件），并将其分配给创建的类。这就是你所需要的，只需调用类的 GET、POST 函数。

我还实现了 multipart-fomdata 作为 TMultipartFormDataStream 类以这种格式快速发布文件。有了它，您可以轻松编写文件和字段。

使用示例：

```
var
 HTTP:THTTPSendEx;
 Data:TMultipartFormDataStream;
 sHTML:string; //Recived HTML code from web
begin
 HTTP:=THTTPSEndEx.Create;
 Data:=TMultipartFormDataStream.Create;
 try
  Data.AddFile('myFile','Path to the local file(No UNC paths)');
  Data.DataEnd;
  if HTTP.Post('URL HERE',Data,sHTML) then
  begin
  //Connection established
  //Check HTTP response
  if HTTP.IsSuccessfull then  //HTTP returns "200 OK" code.
  begin
    ShowMessage('File successfully posted to the server.');
  end;
  end else
  begin
   ShowMessage('Can not establish a connection to the server...'+#13+'Network is not avaliable or server socket does not exist.');
  end;
 finally
   FreeAndNil(HTTP);
   FreeAndNil(Data);
 end;
end; 
```

[你可以在我的网站上看到它](http://arhangelsoft.ru/delphi/advanced-synapse-library-thttpsendex/)。

如果您对此有任何想法，请将其写为项目页面的评论。

抱歉英文有误。

# c# - 服务器端自定义数据注释验证 MVC 3

> ID：11471514
> 
> 赞同：0
> 
> 时间：2012-07-13T13:31:15.537
> 
> 标签：c#, asp.net-mvc-3, email-validation

我一直在尝试使 EmailAddress 自定义数据注释属性正确验证电子邮件，但在我的测试中它似乎对我不起作用。

这是测试：

```
 [Test]
    public void ModelStateValidation()
    {
        var invalidEmails = new[] { "testtestcom", "test@testcom", "testtest.com" };
        var validEmail = "test@test.com";

        //Invalid Email addresses 
        foreach (var invalidEmail in invalidEmails)
        {
            var subscription = new SubscriberModel() { FirstName = "f", LastName = "l", Email = invalidEmail, ConfirmEmail = invalidEmail, DateSubscribed = DateTime.Now };
            ValidateModelAsFalse(subscription);
        }

        var subscription2 = new SubscriberModel() { FirstName = "f", LastName = "l", Email = "t", ConfirmEmail = "t", DateSubscribed = DateTime.Now };
        ValidateModelAsFalse(subscription2);

        //Valid Email address
        var subscription3 = new SubscriberModel() { FirstName = "f", LastName = "l", Email = validEmail, ConfirmEmail = validEmail, DateSubscribed = DateTime.Now };
        ValidateModelAsTrue(subscription3);

        //Last Name doesn't exists
        var subscription4 = new SubscriberModel() { FirstName = "f", LastName = "", Email = validEmail, ConfirmEmail = validEmail, DateSubscribed = DateTime.Now };
        ValidateModelAsFalse(subscription4);

        //First Name doesn't exists
        var subscription5 = new SubscriberModel() { FirstName = "", LastName = "l", Email = validEmail, ConfirmEmail = validEmail, DateSubscribed = DateTime.Now };
        ValidateModelAsFalse(subscription5);

        //Email addresses are equal
        var subscription6 = new SubscriberModel() { FirstName = "f", LastName = "l", Email = "test@test.com", ConfirmEmail = "test2@test.com", DateSubscribed = DateTime.Now };
        ValidateModelAsFalse(subscription6);
    }

    private static void ValidateModelAsFalse(SubscriberModel subscription3)
    {
        SubscriptionController controller = new SubscriptionController();
        controller.ValidateModel(subscription3);
        AssertIsFalse(controller);
    }

    private static void ValidateModelAsTrue(SubscriberModel subscription3)
    {
        SubscriptionController controller = new SubscriptionController();
        controller.ValidateModel(subscription3);
        AssertIsTrue(controller);
    }

    private static void AssertIsTrue(SubscriptionController controller)
    {
        Assert.That(controller.ModelState.IsValid, Is.True);
    }

    private static void AssertIsFalse(SubscriptionController controller)
    {
        Assert.That(controller.ModelState.IsValid, Is.False);
    } 
```

这是 ValidateModel 方法：

```
<!-- language: c# -->
public static void ValidateModel<T>(this Controller controller, T model)
    {
        var validationContext = new ValidationContext(model, null, null);
        var validationResults = new List<ValidationResult>();
        Validator.TryValidateObject(model, validationContext, validationResults);
        foreach (var validationResult in validationResults)
        {
            controller.ModelState.AddModelError(validationResult.MemberNames.First(), validationResult.ErrorMessage);
        }
    } 
```

模型：

```
<!-- language: c# -->
public partial class SubscriberModel
{
    public int SubscriberID { get; set; }

    [Required]
    [DisplayName("First Name")]
    public string FirstName { get; set; }

    [Required]
    [DisplayName("Last Name")]
    public string LastName { get; set; }

    [Required]
    [EmailAddress]
    [Compare("ConfirmEmail", ErrorMessage = "The emails must match")]
    [DisplayName("E-mail")]
    public string Email { get; set; }

    [Required]
    [DisplayName("Confirm E-mail")]
    public string ConfirmEmail { get; set; }

    [Required]
    [DisplayName("Date Subscribed")]
    public DateTime DateSubscribed { get; set; }
} 
```

控制器：

```
 public partial class SubscriptionController : Controller
{
    public ActionResult Index()
    {
        return View();
    }

    [CaptchaValidator]
    [HttpPost]
    public ActionResult Index(SubscriberModel subscription, bool captchaValid)
    {
        subscription.DateSubscribed = DateTime.Now;
        ModelStateValid = ModelState.IsValid;

        if(captchaValid)
        {
            if (ModelState.IsValid)
            {
                var test = "";
            }
        }

        return View(subscription);
    }
} 
```

电子邮件属性类：

```
[AttributeUsage(AttributeTargets.Field | AttributeTargets.Property, AllowMultiple = false)]
public sealed class EmailAddressAttribute : ValidationAttribute, IClientValidatable
{ 
    private static Regex _regex = new Regex(@"^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$", RegexOptions.Compiled | RegexOptions.IgnoreCase);

    public EmailAddressAttribute()
        : base()
    {
        ErrorMessage = "Invalid Email";
    }

    public IEnumerable<ModelClientValidationRule> GetClientValidationRules(ModelMetadata metadata, ControllerContext context) {
        yield return new ModelClientValidationRule {
            ValidationType = "email",
            ErrorMessage = FormatErrorMessage(metadata.GetDisplayName())
        };
    }

    public override bool IsValid(object value) 
    {
        if (value == null) {
            return false;
        }

        string valueAsString = value as string;
        return _regex.Match(valueAsString).Success;
    }
} 
```

IsValid 方法似乎可以按照我的意图验证电子邮件地址，但由于某种原因，当我在 Controller.ValidateModel 上运行单元测试时，它不会返回 false 并且与我的断言匹配。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T13:51:23.757

我曾经使用过类似的东西，实现 IClientValidatable 接口只是第一步。然后我不得不在客户端添加 jQuery 验证。我认为自定义验证只能在使用 jQuery 的客户端上执行

这是一个例子：

```
<script type="text/javascript">
    (function ($) {
        $.validator.addMethod("yourValidationTypeName", function (value, element) {
            //do validation here
        });
        $.validator.unobtrusive.adapters.addBool("yourValidationTypeName");
    } (jQuery));
</script> 
```

使用内置属性 [Regularexpression] 并启用不显眼的 javascript 和客户端验证可能会解决您的问题。

如果我错了，请纠正我，但我不是 MVC3 专家

# c# - 使用可编辑的配置文件创建 asp.net 网站

> ID：11471517
> 
> 赞同：-1
> 
> 时间：2012-07-13T13:31:25.350
> 
> 标签：c#, asp.net, installation

我想使用可编辑的 web.config 文件内容创建我的 Web 应用程序的设置。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T13:45:13.700

您可以使用 MS Web deploy 之类的工具。在此处阅读更多相关信息。[http://learn.iis.net/page.aspx/578/package-an-application-for-the-windows-web-application-gallery/](http://learn.iis.net/page.aspx/578/package-an-application-for-the-windows-web-application-gallery/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T13:48:21.517

如果您尝试使用代码更改配置，以下内容应该会有所帮助。每当您执行以下代码时，您的网站都会重新启动。所以记住这一点。

```
var config = (Configuration)WebConfigurationManager.OpenWebConfiguration("~");
var configSection = (MySectionTypeHere)myConfiguration.GetSection("system.web/section");

//make your edits here

myConfiguration.Save(); 
```

如果这不是您想要的，也许您可​​以提供更多信息。

# ruby - Ruby中Array#map的隐式返回值

> ID：11471518
> 
> 赞同：1
> 
> 时间：2012-07-13T13:31:31.233
> 
> 标签：ruby

给定以下代码：

```
class MagicList
  def items=(array)
    @items = array.map{|x| x*2}
  end

  def items
    @items
  end
end

list = MagicList.new
returns = list.items=([1, 2, 3])

puts returns.inspect    # => [1, 2, 3]
puts list.items.inspect # => [2, 4, 6] 
```

我预计 的值为`returns`，`[2, 4, 6]`因为两者`@items`都`array.map{|x| x*2}`返回此值。为什么呢`[1, 2, 3]`？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-13T13:35:29.453

因为 Ruby 赋值总是返回它们被传递的项，而不管`setter=`方法返回什么。

另请参阅[是否有可能让 class.property = x 返回 x 以外的东西？](https://stackoverflow.com/questions/708618/is-it-possible-to-have-class-property-x-return-something-other-than-x)

# powershell - 如何单独获取registryKey名称而不是完整的注册表keypath？

> ID：11471519
> 
> 赞同：5
> 
> 时间：2012-07-13T13:31:35.773
> 
> 标签：powershell, registry, powershell-2.0

我试图从注册表项中获取所有子注册表项

```
$Key="hklm:\SOFTWARE\Wow6432Node\MyCompany\MyProj"
$ComponentKeys=Get-ChildItem -path $Key 
$ComponentName=$Components | Select-object Name
$ComponentName 
```

它显示如下结果

```
Name
----
HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\MyCompany\MyProj\Service
HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\MyCompany\MyProj\UserInterface
HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\MyCompany\MyProj\DataSetView
HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\MyCompany\MyProj\Notification
HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\MyCompany\MyProj\Model
HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\MyCompany\MyProj\Management 
```

但我只想检索子项名称而不是全名。

我需要如下结果

```
Name
----
Service
UserInterface
DataSetView
Notification
Model
Management 
```

如何单独获取密钥名称？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-13T16:22:53.083

您只能使用名称开关获取名称：

```
$Key="hklm:\SOFTWARE\Wow6432Node\MyCompany\MyProj"
Get-ChildItem $key -Name 
```

如果变量中已有路径，请使用`Split-Path`cmdlet：

```
$componentName | Split-Path -Leaf 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-13T13:40:09.107

像这样？

```
 $ComponentName=$Components | select pschildname 
```

# php - Yii - 关于 jquery ajax

> ID：11471526
> 
> 赞同：1
> 
> 时间：2012-07-13T13:31:58.393
> 
> 标签：php, ajax, jquery, frameworks, yii

我正在写一个商店应用程序，我有一个问题。

你知道 Yii 中的 ajax 看起来像

```
<?php
    echo CHtml::ajaxLink(
        '',
        array("cart/add/id/$item->id"),
        array(
            'update'=>'#cart',
        ),
        array('class' => "button_basket")
    );
?> 
```

此代码将 div 更新为`id = cart`. 如何更新页面上的其他元素？例如，在购物车页面上，我正在通过 ajax 删除一件商品，我需要更新总价，最好的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T14:00:32.413

为此，您需要编写一些 javascript，最好是一个从服务器读取响应的函数，并相应地在 ui 中进行更改。

如果您浏览 的[文档](http://www.yiiframework.com/doc/api/1.1/CHtml#ajaxLink-detail "http://www.yiiframework.com/doc/api/1.1/CHtml#ajaxLink-detail")，`ajaxLink();`您会看到第三个参数是[ajaxOptions](http://www.yiiframework.com/doc/api/1.1/CHtml#ajax-detail "http://www.yiiframework.com/doc/api/1.1/CHtml#ajax-detail")，它采用[jQuery 的 ajax 方法](http://api.jquery.com/jQuery.ajax/ "http://api.jquery.com/jQuery.ajax/")的选项。[因此，您可以为成功事件](http://docs.jquery.com/Ajax_Events "http://docs.jquery.com/Ajax_Events")编写回调函数。在此功能中，您可以更改您的 ui。

示例代码：

```
<?php
 echo CHtml::ajaxLink(
    '',
    array("cart/add/id/$item->id"),
    array(
        // 'update'=>'#cart', this will be ignored when you have success callback
        'success'=>'js:successFunctionName',
    ),
    array('class' => "button_basket")
 );
?> 
```

在当前视图中的某处，您可以使用[`registerScript`](http://www.yiiframework.com/doc/api/1.1/CClientScript#registerScript-detail "http://www.yiiframework.com/doc/api/1.1/CClientScript#registerScript-detail")该函数将函数输出到视图：

```
Yii::app->clientScript->registerScript('scriptname','
    function successFunctionName(data, textStatus, jqXHR){
        // write awesome javascript to change ui
    }
'); 
```

# vbscript - 使用 vbscript 处理传入的电子邮件

> ID：11471528
> 
> 赞同：5
> 
> 时间：2012-07-13T13:32:03.550
> 
> 标签：vbscript, outlook

**问题**：使用 vbscript 处理传入的电子邮件。

**展望版本**：展望 2000

**描述**：我不能为此使用 VBA，因为我相信 Outlook 2000 不允许您从规则向导运行 VBA 脚本，因此我必须使用该`Run a Program | VBScript`方法。

**我所知道**的：我知道如何像这样处理来自 VBA 的电子邮件

```
Sub Sample(MyMail As MailItem)
    Dim strID As String, olNS As Outlook.NameSpace
    Dim olMail As Outlook.MailItem

    strID = MyMail.EntryID
    Set olNS = Application.GetNamespace("MAPI")
    Set olMail = olNS.GetItemFromID(strID)

    '~~> Rest of the code

    Set olMail = Nothing
    Set olNS = Nothing
End Sub 
```

我也知道如何**在**收件箱中的电子邮件上运行 vbscript。要在 OL2000 中运行 vbscript，您必须使用`Run A Program`并将其指向 vbs 文件。在`Run A Script`OL2000 中不可用。

**我不知道**的是：这就是我需要帮助的地方。如何在VBS中获取未命中邮件收件箱的邮件对象。一旦我得到对象，我就可以进行其余的必要操作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T16:50:32.953

你是正确的，OL2000 不能从规则运行 VBA 宏，如果[这篇文章](http://support.microsoft.com/kb/324568)是可信的。

这是我处理传入电子邮件的方式。它确实使用 VBA，但据我所知，在 VBScript 中没有办法这样做。

```
Private WithEvents Items As Outlook.Items 
Private Sub Application_Startup() 
  Dim olApp As Outlook.Application 
  Dim objNS As Outlook.NameSpace 
  Set olApp = Outlook.Application 
  Set objNS = olApp.GetNamespace("MAPI") 
  Set Items = objNS.GetDefaultFolder(olFolderInbox).Items 
End Sub
Private Sub Items_ItemAdd(ByVal item As Object) 

  On Error Goto ErrorHandler 
  Dim Msg As Outlook.MailItem 
  If TypeName(item) = "MailItem" Then
    Set Msg = item 
    '~~> do something with the new message here
  End If
ProgramExit: 
  Exit Sub
ErrorHandler: 
  MsgBox Err.Number & " - " & Err.Description 
  Resume ProgramExit 
End Sub 
```

应将此代码粘贴到 ThisOutlookSession 模块中，然后重新启动 Outlook。

# javascript - 动态html页面导航

> ID：11471529
> 
> 赞同：1
> 
> 时间：2012-07-13T13:32:21.560
> 
> 标签：javascript, jquery, html, dynamic, web

好的，我看到了这个教程[http://css-tricks.com/dynamic-page-replacing-content/](http://css-tricks.com/dynamic-page-replacing-content/)，实际上很酷！我的问题是流程，我有一个页面，不仅有内容，还有特定的 javascript 内容和 css。有没有办法动态加载这些文件，对吗？如果我在页面上有硬编码，我将如何加载该 css/js 脚本？

提前致谢。

[编辑]

一些代码：

```
<html>
<head>
<script type="text/javascript" src="..."></script>
<script type="text/javascript">
$(document).ready(
    alert('the document has finished loading!!');
    // do form validation and send
)
</script>
</head>
<body>
Please Full the necesary (*) Fields
<form method="post" action="testing.php" id="test" name="test">
    (*)<input type="text" name="fullname" />
    <input type="submit" value="Send" />    
</form>
</body>
</html> 
```

假设我想动态加载该页面并加载放置在标题上的验证和相关 javascript。应该加载读取标题的文件吗？我怎么知道哪个已经加载了？

感谢您的回答！

“我猜他的意思是硬编码的、静态的。——Utkanos”——已编辑

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T14:16:24.870

您可以通过更改 href 属性来动态更改 CSS 样式表。也可以通过将脚本 self 加载到 div 或将脚本 src 写入其中来动态加载 Javascript。

这里有一个简单的例子：

CSS 1：

```
body {
    background: black;
    color: #333;
} 
```

CSS 2：

```
body {
    background: red;
    color: white;
} 
```

HTML：

```
<html>
    <head>
        <title>Test page</title>
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>

        <link href="/includes/css/test1.css" rel="stylesheet" type="text/css" />  
    </head>

    <body>
        <h1>TEST!!!!!</h1>
        <div id="code"></div>
        <input type="button" id="but" value="click!" />

        <script>
            var css = 1;

            $('#but').click(function() {
                if(css == 1) {
                    css = 2;
                } else {
                    css = 1;
                }

                $('link').attr('href', '/includes/css/test' + css + '.css');               

                //test();
                test2();
            });

            function test2() {
                $('#code').html("<script>alert(\"It works!!!\");<\/script>");

                //Or parse the src 
                //$('#code').html("<script src=\"js/your_js_file.js"><\/script>")
            }
        </script>
    </body>
</html> 
```

因此可以在页面加载后将 CSS 和 Js 加载到您的页面中。

希望这可以帮助！

# web-applications - 在war的WEB-INF/lib中使用jar作为依赖

> ID：11471533
> 
> 赞同：0
> 
> 时间：2012-07-13T13:32:34.600
> 
> 标签：web-applications, maven, dependencies

问题是我想使用位于我的项目依赖项之一的**WEB-INF/lib内的*****.jar**文件，这些依赖项被打包为 war。我想在编译时使用这些文件。是否可以？

 **基本上它看起来或多/少是这样的：

**我的项目pom.xml**：

```
<dependencies>
        ................
        <dependency>
            <groupId>a.b.c</groupId>
            <artifactId>service</artifactId>
            <version>1.0.0</version>
            <type>war</type>
            <scope>provided</scope>
        </dependency>
        ...............
</dependencies> 
```

**service.war**结构：

```
|
--WEB-INF
     |
     ---lib
         |
         ---lib1.jar   <-  I need this file on compile time for **MyProject** 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T13:37:51.093

是的，这些 JAR 文件是正确编码的 Java JAR/库文件。您可以在其他几个项目中复制和使用这些 JAR 文件。您可以使用一些提取器工具来浏览或将 WAR 内容提取到本地目录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T13:42:12.843

如果您使用的是 Eclipse，则需要将这些 jar 文件添加到应用程序的 BuildPath 中。在您的项目上单击右键，选择 BuildPath，然后选择“Configure Build Path”。在此之后，选择“库”，然后单击“添加外部罐子”。选择你的 jar 文件，就是这样。如果您使用的是 Netbeans 或其他 IDE，则必须执行类似的操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T14:14:31.087

您可以使用[maven-dependency-plugin](http://maven.apache.org/plugins/maven-dependency-plugin/examples/unpacking-artifacts.html)将依赖项 war 文件复制到具有 unpack 选项的文件夹中，并在生命周期的早期阶段从该文件夹中复制一个文件。如果您想在编译期间使用提取的 jar，我不确定您是否可以通过 maven 处理它，因为依赖关系会更早解决？但我不确定。您可以使用位于目标文件夹中的系统范围依赖项。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-13T14:40:50.470

您可以定义一个`<dependency/>`具有“已提供”范围的 lib1。如果您将 lib1 用作 Maven 工件，我实际上会强烈推荐这个。

使用 maven 依赖插件解压战争也是可能的，但我不会真的推荐这作为你的情况的补救措施，因为你需要将 lib1 依赖定义为系统类型，我不相信这对你有用, 因为依赖关系解析发生在 POM 文件的插值之后，这为时过早，依赖插件对你几乎没有任何作用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-10T02:50:53.120

我能想到的唯一解决方案如下：

*   创建一个在主模块之前构建的模块，并声明 WAR 依赖项。
*   正如其他人所说，使用`maven-dependency-plugin`'s（[`unpack-dependencies`目标](http://maven.apache.org/plugins/maven-dependency-plugin/examples/unpacking-project-dependencies.html)）将 WAR 扩展到临时位置。
*   使用`maven-install-plugin`([`install-file`目标](http://maven.apache.org/plugins/maven-install-plugin/install-file-mojo.html)) 将 JAR 安装到本地存储库。此时，您将为它们分配任意`groupId`值`artifactId`。

这将负责设置依赖项。由于您现在已经分配了`groupId`值`artifactId`，您可以将它们用作任何其他依赖项。

这应该可行，这是我能想到的唯一方法来做你所描述的事情。**

# java - Win7/IE 中的 Java 小程序（仅）忽略动态高度属性？

> ID：11471534
> 
> 赞同：2
> 
> 时间：2012-07-13T13:32:34.440
> 
> 标签：java, internet-explorer, windows-7, applet

我有一个 10 年前的小程序，它在 Win7/IE 之前的所有浏览器/平台上运行良好。在 Win7/IE、32 位和 64 位上，小程序加载但大小不正确，无法在垂直维度上填充浏览器窗口。水平尺寸很好。Firefox、Chrome、Safari 在 Win7 上都很好，故障只在 Win7/IE 上。Java 控制台中没有错误。

我正在使用 object/comment/embed html 语法，如：

```
<object classid="blah" width="100%" height="100%" codebase="http://java.sun.com/products/plugin/autodl/jinstall-1_6_0-win.cab#Version=1,6,0,00">
    <param name="code" value="lots.of.packages.then.class">
    <param name="codebase" value="/goes/here">
    <param name="archive" value="foo.jar">
    <param name="type" value="application/x-java-applet;version=1.6">
    <param name="scriptable" value="false">
    <param name="MAYSCRIPT" value="true">
    <comment>
        <embed
            type="application/x-java-applet;version=1.6"
            width="100%"
            height="100%"
            code="lots.of.packages.then.class"
            codebase="/goes/here"
            archive="foo.jar"
            MAYSCRIPT=true
            pluginspage="http://java.sun.com/products/plugin/autodl/jinstall-1_6_0-win.cab">
        <noembed>
           No support for APPLET!!
        </noembed>
        </embed>
    </comment>
</object> 
```

请注意宽度和高度属性的百分比语法：`width="100%" height="100%"`.

请注意，如果我明确设置高度属性，例如，height="1000"，一切都很好。使用 JavaScript 设置它会导致与百分比语法相同的行为。

以前有人在Win7上看到过垂直尺寸的这个问题吗？建议非常感谢。

- 标记

# c# - .NET 相当于 Java FileChannel？

> ID：11471536
> 
> 赞同：8
> 
> 时间：2012-07-13T13:32:36.507
> 
> 标签：c#, tcp, nio, .net

我想将字节直接从 TCP 套接字流式传输到磁盘上的文件。在 Java 中，可以使用 NIO 通道，特别`SocketChannel`是`FileChannel`. 报价`FileChannel#transferFrom(...)`：

> 这种方法可能比从源通道读取并写入该通道的简单循环更有效。许多操作系统可以直接从源通道将字节传输到文件系统缓存中，而无需实际复制它们。

显然，我可以编写标准的“复制循环”来读取和写入字节，甚至可以利用异步 I/O 来最大程度地减少等待。这是否可以与 Java 正在利用的平台本机功能相媲美，还是有其他方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T13:37:11.760

您可以使用 读取数据[`NetworkStream`](http://msdn.microsoft.com/en-us/library/system.net.sockets.networkstream.aspx)，然后使用[`CopyTo`](http://msdn.microsoft.com/en-us/library/dd782932.aspx)扩展方法将数据写入 FileStream。

.NET4 之前的手动方法：[如何将流保存到 C# 中的文件？](https://stackoverflow.com/questions/411592/how-do-i-save-a-stream-to-a-file)

对于发送，有一种[`Socket.SendFile`](http://msdn.microsoft.com/en-us/library/sx0a40c2.aspx)直接发送文件的方法，利用 Win32[`TransmitFile`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms740565(v=vs.85).aspx)方法。不幸的是，没有相应的`Socket.ReceiveFile`方法或`ReceiveFile`Win32 API。

# iphone - iPhone：Fontconfig 错误：无法加载默认配置文件

> ID：11471538
> 
> 赞同：5
> 
> 时间：2012-07-13T13:32:41.933
> 
> 标签：iphone, ios, xcode, static-libraries, fontconfig

我有以下问题：

**我在我的iPhone 项目**中包含了一个 FontConfig libfontconfig.a 的静态库。

应用程序正在构建，我可以在设备上运行它，但是当我调用需要此库的某些功能的方法时，应用程序崩溃并出现以下错误

> **Fontconfig 错误：无法加载默认配置文件**
> 
> **终止称为抛出异常**

我读到当 FontConfig 找不到通常位于 /etc/fonts 中的 fonts.conf 文件时，通常会发生此错误。

但我无法将该文件移动到 iPhone 的这个目录中。有没有人有解决方案？仅将文件复制到应用程序包也无济于事。

我将不胜感激任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T16:13:20.853

我终于找到了解决这个问题的方法。我设置了一个**环境变量FONTCONFIG_FILE 和 FONTCONFIG_PATH 来定义 fonts.conf 文件的位置和***/etc/fonts*之前的路径。所以我可以将*字体*目录添加到项目中并定义路径@runtime。

在调用需要 FontConfig 功能的方法之前，必须在代码中设置环境变量。我在 AppDelegate 中启动我的应用程序后设置它。

这是我添加的代码：

```
//Get the directory of your Application
NSString *bundlePath = [[NSBundle mainBundle] resourcePath];

//Create a String with the location of your fonts.conf file
NSString *fontconfigFile= [bundlePath stringByAppendingString:
                             [NSString stringWithFormat:@"/fonts/fonts.conf"]];

//Create a String with the path of the FontConfig configuration path
NSString *fontconfigPath= [bundlePath stringByAppendingString:
                             [NSString stringWithFormat:@"/fonts"]];

//Set the Environment Variables
setenv("FONTCONFIG_FILE", [fontconfigFile UTF8String], 0); 
setenv("FONTCONFIG_PATH", [fontconfigPath UTF8String], 0); 
```

在第二步中，我必须修改我的 fonts.conf 文件。我将字体目录添加到*FC/fonts*，将缓存目录添加到我项目的*FC/cache*，并在两部分上调整了fonts.conf文件。

我改变了第一部分：

```
<!-- Font directory list -->

<dir>/usr/share/fonts</dir>
<dir>/usr/X11R6/lib/X11/fonts</dir>
<dir>~/.fonts</dir> 
```

到：

```
<!-- Font directory list -->

<dir>FC/fonts</dir> 
```

第二部分：

```
<!-- Font cache directory list -->

<cachedir>/opt/local/fc1407cd/var/cache/fontconfig</cachedir>
<cachedir>~/.fontconfig</cachedir> 
```

到：

```
<!-- Font cache directory list -->

<cachedir>FC/cache</cachedir> 
```

然后它不再崩溃了。

# java - 带有 ClientAuth 的 WebService 调用：在 Tomcat 上的 recv 失败，在独立应用程序上工作

> ID：11471542
> 
> 赞同：1
> 
> 时间：2012-07-13T13:32:47.380
> 
> 标签：java, tomcat, ssl, authentication

我已经为部署在 ServiceMix 服务器上的 Web 服务打开了 SSL 客户端身份验证。我已经导入了客户端和服务器证书。我已经使用独立应用程序对其进行了测试，一切正常。但是，当我尝试从部署在 Tomcat 上的应用程序调用此 Web 服务时，出现异常：

```
Caused by: java.net.SocketException: Software caused connection abort: recv failed
    at java.net.SocketInputStream.socketRead0(Native Method)
    at java.net.SocketInputStream.read(SocketInputStream.java:150)
    at java.net.SocketInputStream.read(SocketInputStream.java:121)
    at sun.security.ssl.InputRecord.readFully(InputRecord.java:312)
    at sun.security.ssl.InputRecord.read(InputRecord.java:350)
    at sun.security.ssl.SSLSocketImpl.readRecord(SSLSocketImpl.java:893)
    at sun.security.ssl.SSLSocketImpl.waitForClose(SSLSocketImpl.java:1689)
    at sun.security.ssl.HandshakeOutStream.flush(HandshakeOutStream.java:122)
    at sun.security.ssl.Handshaker.sendChangeCipherSpec(Handshaker.java:972)
    at sun.security.ssl.ClientHandshaker.sendChangeCipherAndFinish(ClientHandshaker.java:1083)
    at sun.security.ssl.ClientHandshaker.serverHelloDone(ClientHandshaker.java:1002)
    at sun.security.ssl.ClientHandshaker.processMessage(ClientHandshaker.java:282)
    at sun.security.ssl.Handshaker.processLoop(Handshaker.java:868)
    at sun.security.ssl.Handshaker.process_record(Handshaker.java:804)
    at sun.security.ssl.SSLSocketImpl.readRecord(SSLSocketImpl.java:998)
    at sun.security.ssl.SSLSocketImpl.performInitialHandshake(SSLSocketImpl.java:1294)
    at sun.security.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:1321)
    at sun.security.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:1305)
    at sun.net.www.protocol.https.HttpsClient.afterConnect(HttpsClient.java:523)
    at sun.net.www.protocol.https.AbstractDelegateHttpsURLConnection.connect(AbstractDelegateHttpsURLConnection.java:185)
    at sun.net.www.protocol.http.HttpURLConnection.getOutputStream(HttpURLConnection.java:1087)
    at sun.net.www.protocol.https.HttpsURLConnectionImpl.getOutputStream(HttpsURLConnectionImpl.java:250)
    at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.handleHeadersTrustCaching(HTTPConduit.java:1916)
    at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.onFirstWrite(HTTPConduit.java:1871)
    at org.apache.cxf.io.AbstractWrappedOutputStream.write(AbstractWrappedOutputStream.java:42)
    at org.apache.cxf.io.AbstractThresholdOutputStream.write(AbstractThresholdOutputStream.java:69)
    at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.close(HTTPConduit.java:1934)
    at org.apache.cxf.io.CacheAndWriteOutputStream.postClose(CacheAndWriteOutputStream.java:47)
    at org.apache.cxf.io.CachedOutputStream.close(CachedOutputStream.java:188)
    at org.apache.cxf.transport.AbstractConduit.close(AbstractConduit.java:66)
    at org.apache.cxf.transport.http.HTTPConduit.close(HTTPConduit.java:632)
    at org.apache.cxf.interceptor.MessageSenderInterceptor$MessageSenderEndingInterceptor.handleMessage(MessageSenderInterceptor.java:62)
    ... 107 more 
```

`recv failed`当我未能使用客户端私钥指定 keyStore 时，我收到了来自独立 java 应用程序的消息。然而，堆栈跟踪是其他的：

```
Exception in thread "main" com.sun.xml.ws.wsdl.parser.InaccessibleWSDLException: 2 counts of InaccessibleWSDLException.

java.net.SocketException: Software caused connection abort: recv failed
java.net.SocketException: Software caused connection abort: recv failed

    at com.sun.xml.ws.wsdl.parser.RuntimeWSDLParser.tryWithMex(RuntimeWSDLParser.java:172)
    at com.sun.xml.ws.wsdl.parser.RuntimeWSDLParser.parse(RuntimeWSDLParser.java:144)
    at com.sun.xml.ws.client.WSServiceDelegate.parseWSDL(WSServiceDelegate.java:263)
    at com.sun.xml.ws.client.WSServiceDelegate.<init>(WSServiceDelegate.java:226)
    at com.sun.xml.ws.client.WSServiceDelegate.<init>(WSServiceDelegate.java:174)
    at com.sun.xml.ws.spi.ProviderImpl.createServiceDelegate(ProviderImpl.java:104)
    at javax.xml.ws.Service.<init>(Service.java:56) 
```

在那种情况下，我没有阅读 WSDL。但是在 Tomcat 上，读取 WSDL，但是当 CXF 尝试发送消息时会抛出错误。

什么可能导致Tomcat上出现该错误？是证书问题吗？在这两种情况下，指向 trustStore 和 keyStore 的 Java 变量是相同的：

```
javax.net.ssl.keyStoreType=jks
javax.net.ssl.trustStoreType=jks
javax.net.ssl.keyStore=c:/cert/gen.keystore
javax.net.ssl.trustStore=c:/cert/client.keystore
javax.net.ssl.keyStorePassword=changeit
javax.net.ssl.trustStorePassword=changeit 
```

Java：Java 版本“1.6.0_30”Java(TM) SE 运行时环境（构建 1.6.0_30-b12）Java HotSpot(TM) 客户端 VM（构建 20.5-b03，混合模式，共享）

雄猫：6.0.26

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T13:45:07.837

即使我曾经得到同样的错误。但是当我执行以下操作之一时，它不会发生

1.  重新启动服务器。
2.  重新生成证书。
3.  尝试从服务器端设置所有这些变量，这意味着在 Tomcat 的`server.xml`文件中：

    ```
    javax.net.ssl.keyStoreType=jks
    javax.net.ssl.trustStoreType=jks
    javax.net.ssl.keyStore=c:/cert/gen.keystore
    javax.net.ssl.trustStore=c:/cert/client.keystore
    javax.net.ssl.keyStorePassword=changeit
    javax.net.ssl.trustStorePassword=changeit 
    ```

# ruby - Rails 3.2.x：如何在开发过程中重新加载 app/classes 目录？

> ID：11471543
> 
> 赞同：7
> 
> 时间：2012-07-13T13:32:56.660
> 
> 标签：ruby, ruby-on-rails-3

我有一些 Rails 代码不适合模型或控制器盒。所以根据[这个答案](https://stackoverflow.com/a/1071510/93995)，我创建了一个`app/classes`目录。Rails 3 似乎会自动将其添加到 Rails 中的“加载路径”中，并且我的应用程序可以正确找到我在其中定义的类，而无需使用`require`语句。

但是，`app/classes`在开发模式下不会重新加载代码；如果我进行更改，我需要重新启动服务器才能看到该更改。

在 Rails 3.2.x 中使给定目录“可重新加载”的正确方法是什么？这里的一些答案建议这样做：

```
config.autoload_paths += %W(#{config.root}/app/classes) 
```

但我相信这只是添加`app/classes`到初始目录集以在其中查找代码的效果；似乎并没有让它们为每个请求重新加载（而且在 3.x 中似乎`app/*`是自动添加的）。

**更新**：

数字，我在发布问题后仅 30 秒就偶然发现了解决方案：

我将我的课程包裹在一个模块中。一旦我删除了周围的“MyModule”，它突然变得可重新加载。来自 Java 背景，并且被污染全局命名空间的 Ruby 代码烧毁，我养成了将所有内容都放在模块中的习惯。我猜Rails“app”代码必须存在于任何模块之外？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T15:09:14.183

您是在单独的文件中声明模块，还是在类中隐式声明它？这可能会对自动加载行为产生影响。`module Foo; class Bar`与`class Foo::Bar`.. 如果 Rails 自动加载器找不到`foo.rb`与 Foo 模块一起使用的模块，它可能会跳过重新加载它。

# java - 完全消除对 Android 时钟的依赖，并使用来自服务器的自定义时间

> ID：11471544
> 
> 赞同：2
> 
> 时间：2012-07-13T13:33:07.683
> 
> 标签：java, android, web-services, time

我有一个应用程序，它使用平板电脑记录信息，该平板电脑同步到服务器，然后在结果上运行报告。用户整天都在使用平板电脑，并且一整天都在旅行。

用户完成这些任务的时间对报告至关重要，我们已经发生过几次不能依赖设备时间的情况。

1.  用户有时会在设备上手动将时间设置为不同的时间，以便看起来他们已经完成了更多的工作——这比我们预期的要多
2.  当依赖设置为“自动”的时间时，时间有时会随着用户在网络之间旅行而跳跃
3.  最初打开平板电脑时，有时设备时间设置为 1970

我有一个网络服务来获取当前未使用的服务器时间，因为我们不能依赖具有互联网连接的用户，因为由于工作的性质，他们通常根本没有任何连接。但是，他们通常每天同步数据，或者至少每隔几天同步一次。

我想创建一些东西来获取服务器时间并从那时起计算时间，并且应用程序将使用这个时间。任何时候他们连接，这个时间都会更新，只是为了确保时间同步。有没有人对最好的方法有任何建议？请记住，我们发送的时间至关重要 - 如果多次误报，可能会有人失业。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T13:47:09.080

Android确实有3种不同的计时器... [SystemClock](http://developer.android.com/reference/android/os/SystemClock.html)

其中之一将对您有用，[uptimeMillis()](http://developer.android.com/reference/android/os/SystemClock.html#uptimeMillis%28%29)

应用程序启动后，保存当前的 uptimeMillis ......当应用程序结束时......您可以从“uptimeMillis（） - oldUpTimeMillisThatWasStored”中获得差异......

当时间或时区更改时，Android 确实会发送广播...如果您有一个广播接收器，它可以从清单文件中捕获这些更改...您将知道时间何时更改（即使您的应用程序没有运行） ..

[ACTION_TIME_CHANGED](http://developer.android.com/reference/android/content/Intent.html#ACTION_TIME_CHANGED)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T16:02:35.303

我没有完成这个，但现在已经实施了一个解决方案。

我创建了一个在后台运行的服务，并每隔一段时间从 web 服务下载日期，并使用 Timer 来增加调用 web 服务之间的时间。

除此之外，我使用 GPS 来获取当前时间和日期，如果可能，它会使用它，如果没有，它会使用这个内部时钟。

理论上，大多数时候时间应该是正确的！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T13:48:53.530

您需要持久的互联网连接。否则，您必须依赖可以修改的客户端时间，如您已经提到的。您可能能够跟踪更改，但前提是应用程序正在运行，这很容易通过`Settings -> Apps`在更改时间之前禁用应用程序 ( ) 来伪造。

设想：

*   用户完成任务，客户时间被存储
*   用户修改时间
*   设备获取互联网并与服务器同步，告诉他当前时间和任务，以便服务器可以计算任务“真实”完成时间。<-- 错误

# nunit - 过滤dotcover中的类别

> ID：11471551
> 
> 赞同：1
> 
> 时间：2012-07-13T13:33:25.197
> 
> 标签：nunit, filtering, categories, dotcover

我知道您可以过滤项目、类和方法，但可以过滤 dotcover 中的类别。我正在使用 nuit 作为我的单元测试器。请帮忙！谢谢皮特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T13:45:29.177

可以从命令行进行。只需将**/include:MyCategoryName**设置为 TargetArguments 中的第一个参数，然后是目标 dll。

```
dotcover.exe analyse coverage.config.xml 
```

coverage.config.xml 看起来像这样......

```
<?xml version="1.0" encoding="utf-8"?>
<AnalyseParams>
    <TargetExecutable>Thirdparty\NUnit-2.5.10.11092\bin\net-2.0\nunit-console.exe</TargetExecutable>
    <TargetArguments>/include:MyCategoryName bin/release/MyAssemblyUnderTest.dll
    </TargetArguments>
    <TargetWorkingDir>.</TargetWorkingDir>
    ... 
```

提示：如果您在环境变量 --> 路径变量中有 dotcover.exe 的位置，它会有所帮助。

有关[从命令行运行 dotcover 的更多信息](http://blogs.jetbrains.com/dotnet/2010/07/running-code-coverage-from-the-console-with-dotcover/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T12:43:57.833

彼得，你是对的，你不能通过 dotCover 中的覆盖过滤器来做到这一点，但你仍然可以在 nunit 控制台运行器中指定要包含或排除的类别（[文档](http://www.nunit.org/index.php?p=consoleCommandLine&r=2.6)）

# android - 在 Android 上创建照片库的最佳方式是什么（全屏）

> ID：11471558
> 
> 赞同：0
> 
> 时间：2012-07-13T13:33:47.270
> 
> 标签：android, imageview, photo-gallery

我想知道为我的应用程序创建照片库的最佳方式是什么。我从 RSS 提要中获取图片，我想全屏显示它们。我应该使用什么？我尝试使用 ImageView 但图像的大小调整不当（它们不保持原始尺寸）

我用这个答案来实现我的画廊：[Android Gallery fullscreen](https://stackoverflow.com/questions/5312909/android-gallery-fullscreen)

谢谢

编辑 ：

这是 XML 布局：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <android.support.v4.view.ViewPager
        android:id="@+id/galleryPager"
        android:layout_width="match_parent"
        android:layout_height="match_parent" >

    </android.support.v4.view.ViewPager>

</LinearLayout> 
```

这是我在适配器中用来加载图像的代码：

```
@Override
public Object instantiateItem(View collection, int position) {
    ImageView imageView = new ImageView(context);
    imageView.setLayoutParams(new LayoutParams(LayoutParams.MATCH_PARENT, LayoutParams.MATCH_PARENT));
    imageView.setScaleType(ImageView.ScaleType.FIT_XY);
    ImageDownloader.getInstance().download(gallery.get(position), ImageFormat.CONTENT_316, imageView);

        ((ViewPager) collection).addView(imageView, 0);

        return imageView;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T13:40:10.797

我会在其中使用带有 ImageViews 的[ViewPager](http://developer.android.com/reference/android/support/v4/view/ViewPager.html)。

您可以向 ImageView 指定您希望（或不）如何使用`android:scaleType`xml 中的属性拉伸图像。如果您共享一些您在 ImageViews 中使用的代码，并且可能提供更多关于您希望它们如何显示的信息，我可以尝试帮助您正确设置它。

另外，我建议您查看[有效地显示位图](http://developer.android.com/training/displaying-bitmaps/index.html)，了解处理图像时使用的最佳实践，以使您的应用程序的性能保持一流。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T13:44:51.017

使用`Adapter`&`ListView`显示图像幻灯片。

现在在适配器项目的布局中使用`ImageView`宽度`fill_parent`和高度，如下面的代码：

```
<ImageView
        android:id="@+id/imageView1"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:scaleType="fitXY" /> 
```

您可能会建议用户在横向模式下使用手机以获得更好的性能。*所以在layout-land*文件夹中保留额外的布局

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T13:49:50.267

一种方法是

*   从 rss 提要中获取图像 url
*   在自定义画廊中将它们显示为缩略图（可以通过水平线性布局设置，其中包含图像视图，在滚动视图内）
*   使用延迟加载图像来显示这些缩略图
*   覆盖 onClickListener 以获取点击事件
*   并在此 onClick 中加载 web 视图中的当前图像 URL。
*   webview 具有良好的缩放、沿图片移动等功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-17T13:35:56.243

我上面使用的代码几乎是正确的，我只是将 ImageView.ScaleType.FIT_XY 更改为 ImageView.ScaleType.CENTER_CROP

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <android.support.v4.view.ViewPager
        android:id="@+id/galleryPager"
        android:layout_width="match_parent"
        android:layout_height="match_parent" >

    </android.support.v4.view.ViewPager>

</LinearLayout> 
```

这是我在适配器中用来加载图像的代码：

```
@Override
public Object instantiateItem(View collection, int position) {
    ImageView imageView = new ImageView(context);
    imageView.setLayoutParams(new LayoutParams(LayoutParams.MATCH_PARENT, LayoutParams.MATCH_PARENT));
    imageView.setScaleType(**ImageView.ScaleType.CENTER_CROP**);
    ImageDownloader.getInstance().download(gallery.get(position), ImageFormat.CONTENT_316, imageView);

        ((ViewPager) collection).addView(imageView, 0);

        return imageView;
} 
```

# c# - 如何捕获从第三方库抛出的这个 XmlException？

> ID：11471562
> 
> 赞同：0
> 
> 时间：2012-07-13T13:34:11.257
> 
> 标签：c#, exception, exchangewebservices

我正在使用 Exchange Web Services 托管 API，大约每天一次它会抛出一个`XmlException`我不知道如何捕捉的问题。以下是异常详细信息。

```
System.Xml.XmlException was unhandled
  Message="'', hexadecimal value 0x1F, is an invalid character. Line 1, position 1."
  Source="System.Xml"
  LineNumber=1
  LinePosition=1
  SourceUri=""
  StackTrace:
       at System.Xml.XmlTextReaderImpl.Throw(Exception e)
       at System.Xml.XmlTextReaderImpl.Throw(String res, String[] args)
       at System.Xml.XmlTextReaderImpl.Throw(Int32 pos, String res, String[] args)
       at System.Xml.XmlTextReaderImpl.ThrowInvalidChar(Int32 pos, Char invChar)
       at System.Xml.XmlTextReaderImpl.ParseText(Int32& startPos, Int32& endPos, Int32& outOrChars)
       at System.Xml.XmlTextReaderImpl.ParseText()
       at System.Xml.XmlTextReaderImpl.ParseDocumentContent()
       at System.Xml.XmlTextReaderImpl.Read()
       at Microsoft.Exchange.WebServices.Data.EwsXmlReader.Read()
       at Microsoft.Exchange.WebServices.Data.EwsXmlReader.Read(XmlNodeType nodeType)
       at Microsoft.Exchange.WebServices.Data.EwsXmlReader.InternalReadElement(XmlNamespace xmlNamespace, String localName, XmlNodeType nodeType)
       at Microsoft.Exchange.WebServices.Data.EwsXmlReader.ReadStartElement(XmlNamespace xmlNamespace, String localName)
       at Microsoft.Exchange.WebServices.Data.ServiceRequestBase.ReadResponse(EwsServiceXmlReader ewsXmlReader)
       at Microsoft.Exchange.WebServices.Data.HangingServiceRequestBase.ParseResponses(Object state)
       at System.Threading._ThreadPoolWaitCallback.WaitCallback_Context(Object state)
       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
       at System.Threading._ThreadPoolWaitCallback.PerformWaitCallbackInternal(_ThreadPoolWaitCallback tpWaitCallBack)
       at System.Threading._ThreadPoolWaitCallback.PerformWaitCallback(Object state)
  InnerException: 
```

从堆栈跟踪中，我看不到任何可以让我发现并解决问题的东西。

我怎么能抓住这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T13:42:03.967

您的 XML 库不支持`0x1F`char，它是*单位分隔符*char。

您可以做的是在您的流/XML 文件/whatever/ 由您的 XML 库处理**之前转义所有出现的此特定字符。**请参阅[如何在 xml 中转义 unicode 字符 0x1F？](https://stackoverflow.com/questions/1170270/how-do-i-escape-unicode-character-0x1f-in-xml)

请参阅[XML 1.1 允许的字符范围](http://www.w3.org/TR/xml11/#charsets)。

# css - Phonegap/JQuery HTML 未正确呈现

> ID：11471565
> 
> 赞同：0
> 
> 时间：2012-07-13T13:34:33.117
> 
> 标签：css, jquery-mobile, cordova

我正在使用 Ajax 从网络服务器收集 HTML，然后用于在应用程序中填充 div。填充 HTML，但忽略 CSS，显示的是屏幕上的纯 HTML 输出，而不是 JQuery CSS。事情是，当我手动将 HTML 输入到 div 中然后加载整个东西时效果很好。任何帮助是极大的赞赏

阿贾克斯调用：

```
<script type="text/javascript" charset="utf-8">
    $(document).bind('pageinit', function(){
            $.ajax({
                url: "http://www.mydomain.com/getDetails.php",
                dataType: 'html',
                success: function(text_results){
                    console.log(text_results);          
                    $('.class-items').append(text_results);                 
                }
            });
        });
    </script> 
```

和正在填充的 div：

```
<div data-role="content">
    <div class="class-items">

        </div>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T13:35:22.310

我认为 jQuery on() 在这里可能会有所帮助：

[http://api.jquery.com/on/](http://api.jquery.com/on/)

# python - 如何在不激活所述 virtualenv 的情况下在 virtualenv 中找到模块？

> ID：11471566
> 
> 赞同：3
> 
> 时间：2012-07-13T13:34:33.503
> 
> 标签：python

假设我有以下设置：

```
mkdir test && cd test
virtualenv .venv
source .venv/bin/activate
pip install django
mkdir mod1
touch mod1/__init__.py
echo "a = 1" > mod1/mod2.py 
```

这给了我：

```
test/.venv
test/mod1/__init__.py
test/mod1/mod2.py 
```

我将如何编写此函数：

```
def get_module(module_name, root_path, virtualenv_path=None) 
```

为了使它起作用：

```
project_root_path = "./test"
project_virtualenv_path = "./test/.venv"

get_module("mod1.mod2", project_root_path, project_virtualenv_path)
get_module("django.contrib.auth", project_root_path, project_virtualenv_path) 
```

假设我没有`./test/.venv`激活。

我想这样做的原因是因为我正在开发一个 vim 插件，该插件将`gf`在导入语句的 python 文件中实现功能。我也在尝试支持 virtualenvs。

编辑：

此外，脚本不应通过添加或附加到 sys.path 来更改当前运行时。这应该通过 vim python 绑定在 vim 内部运行，我认为更改 vim python 运行时不是一个好主意。

`get_module`可以返回一个模块对象，也可以返回模块的路径，这就是我基本上要寻找的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T13:39:01.090

您可以在 python 路径上添加您的 virtualenv，例如：

```
import site 
site.addsitedir('/home/user/.virtualenvs/myapp1/lib/python2.7/site-packages') 
```

然后导入应该工作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T09:50:50.627

我在这里能找到的唯一实用的解决方案是运行 virtualenv 的`activate_this.py`脚本，寻找我需要的东西，然后从`sys.path`.

```
import sys
import os

old_sys_path = list(sys.path)

virtualenv_path = "/path/to/venv"
activate_this_path = os.path.join(virtualenv_path, "bin", "activate_this.py")

execfile(activate_this_path, dict(__file__=activate_this_path))

# get my module here

# restore sys.path
sys.path = old_sys_path 
```

如果您有更好的答案，请添加它，我会很乐意更改已接受的答案。

# objective-c - 使用 plist 文件中的数据时定义模型是一种好习惯吗？

> ID：11471574
> 
> 赞同：0
> 
> 时间：2012-07-13T13:35:00.453
> 
> 标签：objective-c, ios, uiviewcontroller, plist

我应该直接从视图控制器中的 plist 文件读取/写入数据，还是为模型定义一个类然后使用它的方法读取/写入数据更好？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T13:43:16.693

这取决于你在做什么。如果您正在对该`.plist`文件进行大量工作，那么最好编写一个类来处理您对它执行的所有不同操作。如果您只是一次取出一个值或类似的东西，那么您可以编写一个类，但这并不是一个真正重要的问题。

您不希望您的视图控制器最终在与视图不直接相关的区域中进行大量提升，因此只需考虑您将添加多少代码。如果您认为您可能想要对`.plist`文件做更多的事情，那么请继续为它编写一个类。

# c# - 水晶报表设置数据源

> ID：11471576
> 
> 赞同：3
> 
> 时间：2012-07-13T13:35:04.883
> 
> 标签：c#, crystal-reports, datasource

我在我的 C# 代码中设置报告数据源，如下所示：

```
report.SetDataSource(dataSource); 
```

一切正常，但之后水晶报表仍会尝试连接到数据库。我虽然如果我从代码中设置数据源，那么报告就不会想要从数据库中获取更多数据。

真的是这样吗，即使在从代码报告中设置数据源之后，也会从数据库中询问更多数据？

编辑：我面临的真正问题是我有 2 份报告，一份在从代码设置数据源后从数据库中获取数据，另一份则没有。我整天都在努力解决这个问题，但还没有运气。这两个报告几乎完全相同，都使用数据库视图从数据库中获取字段，并且都使用相同的代码从代码中设置数据源。逻辑是我在代码中加载报告，从中获取所需的数据库字段并`DataTable`使用这些字段创建。然后我用数据填充它并将其设置为数据源：`report.SetDataSource(dataSource);`。对于这两个报告，代码和逻辑是相同的！只是领域不一样。。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T17:56:36.257

如果您有子报告。

遍历子报表并在每个子报表对象上调用 SetDataSource(dataSource)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T14:59:10.930

```
 Report.RicevutaCup r = new Report.RicevutaCup();
        System.Data.DataSet ds = CupDatasetFactory.CreaRicevutaCupDataSet(df);
        r.OpenSubreport("RicevutaCup_Prestazioni").SetDataSource(ds);

        r.SetDataSource(ds); 
```

解决了我的问题（重新启动 IIS 后）。

# c# - 如何在 C# 异常中获取 ORA 错误代码？

> ID：11471584
> 
> 赞同：1
> 
> 时间：2012-07-13T13:35:53.103
> 
> 标签：c#, winforms, oracle

我的代码如下所示：

```
 public bool myQuery(string cmd)
    {
        try
        {
            OracleCommand command = null;
            command = new OracleCommand(cmd, sqlConnection);
            command.ExecuteReader();
        }
        catch (Exception ex)
        {
            MessageBox.Show(ex.Message, "error!");
            return false;
        }
        return true;            
    } 
```

我的问题是当`ORA-02291`Oracle 发生错误时，它的异常没有被捕获。没有显示错误，我该如何捕捉这个错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T13:38:26.947

检查这个：

```
if (ex.InnerException != null)
{
    MessageBox.Show(ex.InnerException.Message, "error!");
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-13T13:47:20.797

```
catch (System.Data.OracleClient.OracleException ex)
{
    int code = ex.Code;

   // or

   string eCode = ex.ErrroCode;

    return false;
}
return true; 
```

# python - 比较两个 XML 文件并更新其中一个文件中的元素

> ID：11471586
> 
> 赞同：3
> 
> 时间：2012-07-13T13:36:13.017
> 
> 标签：python, xml

如果我的标题听起来令人困惑，我很抱歉。我正在编写一个比较 2 个 XML 文件的 Python 脚本。在这两个文件中，我们都有 id 与另一个文件中相同的数据。

例如

源文件：

```
 <id>123456</id> 
    <data>blabla</data>
        ......some other data......
  <id>abcde</id>
    <data>gfkgjk</data>
        ......some more data.......... 
```

目标文件：

```
 <id>123456</id> 
    <data> </data>
        ......some other data......
  <id>ghijk</id>
    <data>gfkgjk</data>
        ......some more data.......... 
```

正如您在上面的示例中所看到的，并非源文件中的所有 ID 也都在目标文件中。此外，虽然 2 个数据组具有相同的 ID，但其中一个填写了“数据”标签，另一个没有填写。

我的程序应该查看源文件，提取 id 和数据标签之间的文本。然后它会查看目标文件，如果存在具有相同 ID 和空数据标签的数据（如上例所示），它会使用源文件中的信息填充这些空标签。（顺便说一句：除了ID和数据信息，这两个XML是完全不同的，所以我不能只保留源文件）。

是的，我能够提取数据标签之间的 ID 和信息。现在我正在尝试编写一个函数来比较 id 并替换空数据信息（如果有）。但是，我对 Python 和函数不是很熟悉，需要一些帮助。这是我的函数的样子：

```
def replace_empty_data():
    for x in xmlData_id_source:
       if xmlData_id_source==xmlData_id_target:
          target = re.sub(xmlData_2,xmlData,target)
       return target
    file_target.close() 
```

函数中可能缺少负载，但我不知道是什么。它没有给我任何错误，而且根本不起作用。除 x 之外的变量已在代码的早期部分中定义，因此这不是问题。

xmlData_id_source 是源文件的 ID xmlData_id_target 是目标文件的 ID xmlData_2 是目标文件的数据信息 xmlData 是源文件的数据信息

感谢您到目前为止的输入，但我仍在为对编程一无所知的人寻找一种易于理解的方法....我使用 minidom 来解析文件并希望在不导入和安装的情况下使用它更多的图书馆。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T13:41:09.973

为此，您需要使用 XML 解析器。看看[ElementTree](http://docs.python.org/release/3.1.5/library/xml.etree.elementtree.html)。

**不要在这里使用正则表达式或字符串替换**。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T14:08:15.803

我使用[lxml](http://lxml.de/)，它具有良好的性能和内置 ElementTree 不支持的 XPATH 等附加功能。这是我要做的：

```
>>> source = """<root>
    <tag>
        <id>123456</id> 
        <data>blabla</data>
    </tag>
    <tag>
        <id>abcde</id>
        <data>gfkgjk</data>
    </tag>
</root>"""
>>> target = """<root>
    <tag>
        <id>123456</id> 
        <data> </data>
    </tag>
    <tag>
        <id>ghijk</id>
        <data>gfkgjk</data>
    </tag>
</root>""" 
```

由于`data`节点没有封装在`id`一个中，我假设它们都在`tag`一个中，它位于 a 下的某个地方`root`。好的，第一部分旨在获取`id`s 的字典及其对应的`data`：

```
>>> root = etree.fromstring(source)
>>> for tag in root.findall('tag'):
    id_ = tag.find('id')
    data = tag.find('data')
    id_dict[id_.text] = data.text

>>> id_dict
{'123456': 'blabla', 'abcde': 'gfkgjk'} 
```

现在，通过这个字典更新目标：

```
>>> root = etree.fromstring(target)
>>> for tag in root.findall('tag'):
    id_ = tag.find('id')
    data = tag.find('data')
    if data.text.strip() == '':
        data.text = id_dict[id_.text]

>>> print etree.tostring(root)
<root>
    <tag>
        <id>123456</id> 
        <data>blabla</data>
    </tag>
    <tag>
        <id>ghijk</id>
        <data>gfkgjk</data>
    </tag>
</root> 
```

您只需要使该解决方案适应您真正的 XML 结构，这应该很好！

# android - OutOfMemoryError 因为没有删除以前的位图

> ID：11471589
> 
> 赞同：0
> 
> 时间：2012-07-13T13:36:30.703
> 
> 标签：android, out-of-memory

在我的 Android 应用程序中，当我第二次运行我的一个活动时，我得到一个`OutOfMemoryError`. 我想我需要在活动运行时第一次删除位图。但我不知道我该怎么做。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T13:39:43.763

尝试从您的代码中读取您的位图。将位图放在 res/drawable-hdpi 文件夹中。（不同的图像质量有不同的文件夹）。在代码中设置位图字段：

```
Bitmap alpha;
Bitmap foo; 
```

现在在 onResume() 中初始化位图：

```
Options options = new Options();
alpha = BitmapFactory.decodeResource(game.getResources(), R.drawable.youBitmapName, options);
foo = BitmapFactory.decodeResource(game.getResources(), R.drawable.youBitmapName2, options); 
```

选项将使您能够下采样。（我不确定您的图像有多大，但您可能还想使用缩放方法）。

在 onPause 中，通过调用清理资源：

```
alpha.recycle();
alpha = null;
foo.recycle();
foo = null; 
```

一旦调用 onResume() 方法，位图就会重新初始化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T13:40:25.690

清空您的位图并调用垃圾收集器：`System.gc();`和/或`Runtime.getRuntime().gc();`

还提供有关您的代码的更多详细信息以获得更好的答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T13:40:54.323

通常[`Bitmap.recycle()`](http://developer.android.com/reference/android/graphics/Bitmap.html#recycle%28%29)，一旦没有更多引用指向该实例，垃圾收集器就会调用。

如果您想“强制”清理位图，请`recycle()`自行调用。

但我建议先寻找内存泄漏。

# vba - 根据突出显示的行或列选择将数据复制到新工作表中

> ID：11471592
> 
> 赞同：-1
> 
> 时间：2012-07-13T13:36:40.763
> 
> 标签：vba, excel, copying

这个问题也可能发布在其他论坛上，但我无法找到我的答案。

我想要一个可以

*   复制我选择的行、列或单元格。
*   制作新文件.xlsx
*   将该数据粘贴到该工作表中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T14:13:16.757

您是要将其粘贴到某个位置还是只是表格的开头？什么将决定您是复制行还是列？

这将复制当前选定单元格的行，然后将其粘贴到新工作簿的第一行

```
Sub CopyRow()
  Selection.EntireRow.Copy
  Workbooks.Add
  ActiveSheet.Paste
End Sub 
```

## 编辑

添加此代码以询问您是否要保存，然后您可能有一个复制行或列的问题，或者有一个单独的宏来复制列。

```
Dim docname As String
If MsgBox("Would you like to save the doc?", vbYesNo, "Save?") = vbYes Then
 docname = InputBox("What would you like to call the doc?", "Title")
 ActiveWorkbook.SaveAs Filename:=docname, FileFormat:=xlOpenXMLWorkbook
End If 
```

# date - PalmOS 上的最大日期

> ID：11471603
> 
> 赞同：1
> 
> 时间：2012-07-13T13:37:14.657
> 
> 标签：date, max, palm-os

我有一个客户仍然在 PalmOS 上运行应用程序。

PalmOS 的最大日期值是多少？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T04:17:04.743

`PalmOS` *最大日期*为**2040**年。所以，别担心：）

# java - 获取“405 - 调用时不支持请求方法'GET'”方法=删除

> ID：11471604
> 
> 赞同：2
> 
> 时间：2012-07-13T13:37:22.730
> 
> 标签：java, http, servlets, spring-mvc

我有一个 Spring MVC 网络应用程序。在其中一个带有按钮的表单应该从另一个资源中删除一个资源：

```
<td>
    <form action="/product-bases/${productBase.id}/positions/${position.id}" method="DELETE">
        <input type="submit" value="delete" />
    </form>
</td> 
```

我的控制器：

```
@Controller
@RequestMapping(value = "/product-bases/{id}/positions")
public class ProductBasePositionController {

    @RequestMapping(value = "/{positionId}", method = RequestMethod.DELETE)
    public ModelAndView delete(@PathVariable Integer productBaseId, @PathVariable Integer positionId) { 
```

所以理论上服务器应该路由到控制器。但可惜它没有，因此帖子;）

我越来越

```
HTTP Status 405 - Request method 'GET' not supported

type Status report

message Request method 'GET' not supported

description The specified HTTP method is not allowed for the requested resource (Request method 'GET' not supported).
Apache Tomcat/7.0.19 
```

显然我还没有定义 /positions/id 的 get ，但我为什么要这样做，我现在想做一个删除..

（我也试图从我的 spring-test-mvc 框架在一个模拟 servlet 上运行它，中间没有任何 tomcat 实现，它给了我一个 400 - bad request..）

那么我在这里错过了什么？

哦，只是为了偷工减料：post 和 get 将适用于其他资源，所以我的其余设置都很好。

启动服务器甚至告诉我：

```
RequestMappingHandlerMapping [INFO] Mapped "{[/product-bases/{id}/positions/{positionId}],methods=[DELETE],params=[],headers=[],consumes=[],produces=[],custom=[]}" onto public org.springframework.web.servlet.ModelAndView our.view.controller.ProductBasePositionController.delete(java.lang.Integer,java.lang.Integer) 
```

有和我一样困惑的人吗？如果不是这样，请赐教！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-13T13:45:41.873

表单可以通过`GET`或`POST`仅提交（也许也可以`PUT`，但我怀疑这是否被广泛实施），因为表单提交需要一种将数据传输到服务器的方法。

该`DELETE`方法没有请求正文，因此不支持在表单操作中指定它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-13T18:10:47.487

您的 web.xml 中有 HiddenHttpMethodFilter 过滤器吗？

```
<filter>
    <filter-name>hiddenHttpMethodFilter</filter-name>
    <filter-class>org.springframework.web.filter.HiddenHttpMethodFilter</filter-class>
</filter>
<filter-mapping>
    <filter-name>hiddenHttpMethodFilter</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping> 
```

[http://static.springsource.org/spring/docs/current/spring-framework-reference/html/view.html#rest-method-conversion](http://static.springsource.org/spring/docs/current/spring-framework-reference/html/view.html#rest-method-conversion)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-13T13:46:11.453

错误消息表明浏览器*实际上*是在发送 GET 请求而不是 DELETE 请求。

你需要做的是：

*   检查浏览器当时所在网页的来源，以及

*   使用浏览器的 Web 调试器，查看请求 URL 和方法实际上是什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-02-23T06:28:16.383

在 Microsoft Azure 门户中，当我打开身份验证/授权时，Java 应用程序出现此错误。如果您遇到同样的问题，请恢复您的操作。

# c# - 如何在第一个位置将新数据表添加到数据集

> ID：11471606
> 
> 赞同：0
> 
> 时间：2012-07-13T13:37:27.137
> 
> 标签：c#, asp.net

我有一个包含 3 个数据表的数据集我必须在第一个位置（例如：mydataset.tables[0]th 位置）在同一数据集中添加一个数据表。任何人都可以帮助我解决这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T13:42:24.523

您可能需要将所有数据表从数据集中拉到一个列表中，以正确的顺序获取它们，然后将它们全部重新添加到数据集中，因为您无法插入或修改现有顺序：

```
var tables = new DataTable[4];
tables[0] = mynewtable;
tables[1] = mydataset.Tables[0];
tables[2] = mydataset.Tables[1];
tables[3] = mydataset.Tables[2];
mydataset.Tables.Clear();
mydataset.Tables.Add(Tables[0]);
mydataset.Tables.Add(Tables[1]);
mydataset.Tables.Add(Tables[2]);
mydataset.Tables.Add(Tables[3]); 
```

# mercurial - 如何仅在变基后运行 mercurial changegroup hook？

> ID：11471608
> 
> 赞同：2
> 
> 时间：2012-07-13T13:37:39.207
> 
> 标签：mercurial, mercurial-hook

我们有一个简单的 mercurial 钩子，每次我们拉取远程更改时都会运行。我们使用更改组挂钩。我们的钩子重建了一些 dll 并将它们复制到一个文件夹中。当我们进行拉动时，我们会自动变基。这会导致我们的钩子运行两次，第一次是在我们进行拉取时，然后是在自动变基之后。

有没有简单的方法来检测是否会有变基，并且只在变基结束时运行一次钩子？

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T14:25:29.463

你能展示你原来的钩子吗？

无论如何，如果您检查源参数，您可以选择是否应该运行挂钩：

```
def changegroup_hook(ui, repo, source, **kwargs):
    if source != 'strip':  # rebase operation uses 'strip' as source
       return 0  # SUCCESS
    # continue rebase processing 
```

# nltk - 为标签云提取术语的 NLTK 技术

> ID：11471610
> 
> 赞同：0
> 
> 时间：2012-07-13T13:37:42.293
> 
> 标签：nltk

我想从文本中提取相关术语，并且我想选择最相关的术语。

```
How to config nltk data -> how, to, config ignored
config mysql to scan -> config NOT ingored
Python NLTK usage -> usage ingored
new song by the band usage -> usage NOT ingored
NLTK Thinks that -> thinks ignored
critical thinking -> thinking NOT ignored 
```

* * *

我只能想到这种粗略的方法：

```
>>> text = nltk.word_tokenize(input)
>>> nltk.pos_tag(text) 
```

并且只保存名词和动词。但即使“think”和“thinking”是动词，我只想保留“thinking”。也是“结合”而不是“结合”。如果可以的话，我也想提取短语。还有“free2play”、“@pro_blogger”等术语。

* * *

请提出一个更好的方案或如何让我的方案真正发挥作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T12:00:50.843

您所需要的只是一个更好的 pos 标记。这是 NLTK 的一个众所周知的问题，核心 pos 标记器对于生产使用效率不高。可能你想尝试别的东西。在此处比较 pos 标记的结果 - [http://nlp.stanford.edu:8080/parser/](http://nlp.stanford.edu:8080/parser/)。这是我发现的最准确的词性标注器（我知道我很快就会被证明是错误的）。一旦你在这个标记器中解析了你的数据，你就会自动意识到你到底想要什么。

我建议您专注于正确标记。

检查 POS 标记示例：标记关键/JJ 思维/NN

资料来源：这些天我也在为 NLTK pos tagger 苦苦挣扎。:)

# mysql - MySQL JOIN，只获取最大值

> ID：11471614
> 
> 赞同：0
> 
> 时间：2012-07-13T13:38:00.187
> 
> 标签：mysql, join, timestamp

我正在努力应对以下情况：

我有一个用户表，其中包含插件的作者。我有一个插件表，其中包含插件（名称和 ID）。我也有一个版本表。此版本表包含已发布插件的所有版本，例如 1.0、1.1 等。现在版本记录还包含 mcversions，这是插件所针对的引擎的版本。

这是我提出的查询：

```
SELECT
`plugins`.`name`,
users.username,
versions.version,
mcversions.version
FROM
users
INNER JOIN `plugins` ON `plugins`.author = users.id
INNER JOIN versions ON versions.id = `plugins`.id AND versions.time
INNER JOIN mcversions ON versions.mcversion = mcversions.id 
```

现在有一个问题：我只想获取版本和属于versions.time最高的版本的mcversion（它是一个时间戳）。所以我想要一个插件列表，其中包含名称、作者、最新版本和最新版本的 mcversion。

任何人都可以帮助我，我会很高兴！

~巴斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T13:49:30.873

```
SELECT
`plugins`.`name`,
users.username,
maxvers.version,
mcversions.version
FROM
users
INNER JOIN `plugins` ON `plugins`.author = users.id

INNER JOIN (SELECT version, MAX(time), id FROM versions) AS maxvers  ON maxvers.id = `plugins`.id 

INNER JOIN mcversions ON versions.mcversion = mcversions.id 
```

我还没有对此进行测试，但是如果您使用该子查询来查找最大行（就像您通常那样），请仅从该子查询而不是整个版本表中进行绘制以执行您想要的操作。

# templates - （动态 Jasper 报告）从自定义 .jrxml 文件导入参数

> ID：11471617
> 
> 赞同：3
> 
> 时间：2012-07-13T13:38:26.177
> 
> 标签：templates, parameters, jasper-reports, dynamic-jasper

我正在使用 JasperReports(v.4.0.6) 和 DynamicJasperReports(v.4.0.1) 开发一个 Java 项目。我已经使用 Eclipse 的最新 iReport 插件生成了一个自定义 .jrxml。

在我的 .jrxml 报告中，我定义了两个参数，这些参数将由 Java 程序根据用户给出的一些输入来填充。

```
<parameter name="ReportTitle" class="java.lang.String"/>
<parameter name="DataFile" class="java.lang.String"/> 
```

然后，正如本[教程](http://dynamicjasper.com/2010/10/06/how-to-use-custom-jrxml-templates/)所述，由于我想维护几个预定义的参数，我从我的代码中调用*setTemplate()方法。*

```
String table_template = "report_templates/TableTemplate.jrxml";
Map<String, String> params; 
... 
DynamicReportBuilder drb = new DynamicReportBuilder();
drb.setTemplateFile(table_template, true, true, true, true);
DynamicReport dr = drb.build(); 
```

我将参数传递给模板，执行以下操作：

```
params.put("ReportTitle", "CustomTitle");
params.put("DataFile", "CustomSubtitle"); 
```

但是，当我生成 de 报告时，这两个字段显示为空白，好像 DJ 库没有预先保存插入值的位置。我没有收到任何其他错误或异常。

我尝试将 Jasper 库降级为旧版本，但也无济于事。

如果有人能给我一些关于我做错了什么的见解，我将不胜感激。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T21:10:16.710

在 jrxml 中已经定义了一个参数仅意味着在您的自定义表达式中，您可以获得它的值

```
params.get("paramName") 
```

未经事先注册（*drb.addParameter(...)*）

您始终可以创建自定义表达式列并在自定义表达式代码中放置一个断点，并在运行时检查参数映射的内容！

如果您在 DJ 之外使用参数，例如页眉或页脚文本，应该没有问题

# java - 图像缓存和性能

> ID：11471621
> 
> 赞同：3
> 
> 时间：2012-07-13T13:38:32.760
> 
> 标签：java, performance, caching, awt

我目前正在尝试提高地图渲染库的性能。在准时符号的情况下，图书馆真的经常只是在每个位置一次又一次地绘制相同的图像。但是，绘制过程可能非常复杂，因为符号的参数化确实非常丰富。对于每个点，我都有一个树结构来计算要绘制的图像。当参数不依赖于我正在处理的数据时，正如我之前所说，我只是画了几次复杂的符号。

我试图实现一个缓存机制。我把已经绘制好的图片存储起来，如果遇到已经满足的配置，就获取图片再绘制。我所做的第一个测试是针对一个非常简单的符号。这是一个形状和内部都被填充的圆圈。

我知道这个符号在所有位置都是不变的，我缓存它然后从缓存的图像中再次绘制它。这有效......但我面临两个重要问题：

*   绘制符号的质量几乎没有损坏。
*   更多问题：使用缓存渲染地图所需的时间确实比没有缓存的时间要长。这对于缓存来说非常令人失望^_^

开启缓存机制时的核心代码如下：

```
if(pc.isCached(map)){
    BufferedImage bi = pc.getCachedValue(map);
    drawCachedImageOnGeometry(g2, sds, fid, selected, mt, the_geom, bi);
} else {
    BufferedImage bi = g2.getDeviceConfiguration().createCompatibleImage(200, 200);
    Graphics2D tg2 = bi.createGraphics();
    graphic.draw(tg2, map, selected, mt, AffineTransform.getTranslateInstance(100, 100));
    drawCachedImageOnGeometry(g2, sds, fid, selected, mt, the_geom, bi);
    pc.cacheSymbol(map, bi);
} 
```

drawCachedImageOnGeometry 中唯一有趣的调用是

```
g2.drawRenderedImage(bi, AffineTransform.getTranslateInstance(x-100,y-100)); 
```

我已经尝试使用 VolatileImage 实例而不是 BufferedImage ......但这会导致更深层次的问题（我无法确定每次需要时都能正确渲染图像）。

我也做了一些分析，似乎在使用我的缓存时，花费时间最长的操作是在 awt 中进行的渲染操作。

也就是说，我想我的策略是错误的......因此，我的问题是：

*   有没有什么有效的方法可以实现我解释的目标？
*   更准确地说，存储用于绘制我的符号并根据需要翻译它们的 AWT 指令会更快吗？我假设有可能检索用于构建符号的“命令”......我没有在万维网上找到很多关于它的信息......如果可能的话，那将节省符号的计算时间（如前所述，这可能非常复杂）和符号的质量。

提前感谢您提供给我的所有信息和资源:-)

年龄。

编辑：这里有一些关于可以渲染的图形的细节。根据我正在实现的符号系统模型，图形可以非常简单（即带有形状的实心正方形）也可以非常复杂（例如，形状和填充都用影线绘制的标签，即使是光环如果我愿意，可以围绕它）。我想使用缓存，因为我确信在大多数配置中我将能够：

*   区分用于绘制具有相同样式的相同源的两个不同符号的参数。
*   确保具有相同参数的两个源（位置除外）将为相同的样式生成相同的符号，但在两个不同的位置（只需要翻译）。

由于这两点，缓存似乎是一个不错的策略。此外，可能有数千个重复的符号要绘制在同一图像中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T15:11:04.677

你对你的绘图真正需要什么样的操作非常模糊，所以我只能给你一些非常笼统的指示。

1.) 绘制预渲染图像不一定比使用 Graphics2D 操作绘制相同图像更快。这在很大程度上取决于绘制图像所需的复杂性。作为极端情况，请考虑 fillRect() 与包含预渲染矩形的 Image 的 drawImage() （fillRect 仅写入目标像素，其中 drawImage 还需要从源复制）。

2.) 在大多数情况下，您*永远*不想直接弄乱 VolatileImage。BufferedImage 会自动利用 VolatileImage，除非你弄乱了 Image DataBuffer。如果您有许多预渲染的图像，您也可能会耗尽加速的视频内存，从而降低图像绘制性能。

3.) 预渲染图像的即时缩放/旋转等可能非常昂贵（取决于平台和当前的图形转换）。

4.) 您创建的“兼容图像”可能与绘图目标并不真正兼容。您获得的图像与默认屏幕设备兼容，这可能与多显示器设置中的实际目标不兼容。使用实际的目标组件 createImage() 可能会得到更好的结果。

编辑：

5.) 平移渲染操作的坐标*可能会*改变生成的目标像素。一个明显的情况是当坐标是非整数时（在坐标本身中或通过图形上设置的 AffineTransform 间接地）。此外，文本和可能的其他图元的抗锯齿可能会受到坐标的轻微影响（想到亚像素渲染）。

* * *

您可以尝试一种方法来区分符号的渲染速度是快还是慢。快的直接渲染，慢的被缓存。这里的主要问题是决定哪些是快/慢的，我希望这不是微不足道的决定。

另外，我想知道您何时说要渲染数千个符号，因为我想它们中的大多数应该被剪掉，因为只有一小部分图形适合窗口/框架？如果是这样的话，不要太在意缓存。完全在当前剪辑范围之外的绘图操作将相对便宜 - 图形目标真正为它们做的所有事情都是检测它们是否完全不可见以及它们什么时候不做任何事情。如果目标是生成要保存到磁盘/打印的图像（无论如何），我不会费心加快渲染速度，因为这是一个相对罕见的操作，实际打印可能远远超过渲染所需的时间无论如何，图表。

如果以上都不适用于您的情况，请注意您的缓存不会使用更多的时间/内存来确定缓存版本是否存在，而不是实际节省的渲染时间。您还需要考虑到，如果从不重用该图像，则构建缓存图像而不是直接渲染到目标确实会*花费*您一些时间。*如果图像至少重复使用一次*，最好是多次重复，缓存只能为您带来一些速度。

如果您通过组合原始渲染操作对象（例如有 Rectangle、Halo 和 Text 渲染对象子类）从原始操作构建符号，您可能希望为它们中的每一个分配一个成本指标，并且只缓存那些超过一些的符号（到确定）成本阈值。此外，为每个原始操作实现 hashCode() 并为 fast(er) equals 检测实现符号本身可能是一个好主意。

# jquery - 从屏幕顶部向下滑动全屏 div 并将滑块加载到其中

> ID：11471623
> 
> 赞同：0
> 
> 时间：2012-07-13T13:38:38.267
> 
> 标签：jquery, slider, webkit-transform

嗨，我有一个正在使用的全屏滑块 RoyalSlider。我有一个带有一些图像的页面，我想要实现的是，当您单击全屏按钮时，全屏 div 从顶部向下滑动，覆盖整个页面，滑块通过 Jquery 加载到该 div 中。

这就是我试图实现这一目标的方式。我有一个 div，我为它做了两个类：

```
.fullscreen_hide{
-webkit-transition-property: all; 
-webkit-transition-duration: 1s; 
-webkit-transition-delay: 0s;
width:100%;
height:0%;
background:#141414;
position:aboslute;
z-index:50000000;
}
.fullscreen_show{
-webkit-transition-property: all; 
-webkit-transition-duration: 1s; 
-webkit-transition-delay: 0s;
width:100%;
height:100%;
background:#141414;
position:aboslute;
z-index:50000000;
} 
```

我正在交换类并希望 webkit 转换来做动画，尽管这根本不起作用。出于某种原因，它不会从顶部向下滑动并覆盖整个页面，它只是将页面向上滚动到 div 向下移动大约一个屏幕高度的顶部，但不会覆盖整个页面。

[http://www.klossal.com/portfolio/index_current_alt.html](http://www.klossal.com/portfolio/index_current_alt.html) 如果你去那里并滚动到大拇指，就在标题为“更多信息”的框上方，你可以点击大拇指旁边的全屏按钮并观看它失败居住。所以这是我需要帮助的第一件事。

第二部分加载滑块我还没有尝试过，因为第一部分失败了，但我只是要从这个 html 文档[http://www.klossal.com/portfolio/space_fullscreen.html](http://www.klossal.com/portfolio/space_fullscreen.html)加载滑块 到那个 div 中使用此 jquery 向下滑动：

```
<script type="text/javascript">
$(function() {
$("#color_launch").click(function() {
    $('#fullscreen')
       .html('<img src="http://www.klossal.com/loader.gif" style="padding-   
bottom:1000px;"/>')
       .load('http://www.klossal.com/portfolio/space_fullscreen.html');
});
});
</script> 
```

我认为这会起作用，因为我在我网站的另一部分设置了这个，它可以工作，但我没有尝试过，唯一我认为会出错的是它会在动画完成之前加载，这很好只要它留在那个动画容器中并且不会自动全屏显示。我实际上使用这种加载方法遇到的另一个问题是控制 loading.gif 的显示位置，有什么方法可以控制它，理想情况下让它位于加载区域的中心？

那里有很多东西，但我认为它已经接近工作了吗？对此的任何帮助都会很棒，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-27T20:58:58.563

使用`jq.animate`动画代替全屏类，您可以提供所有这些 css 选项并获得更酷的效果。

# php - 如何从 jquery 确认框提交 php 页面？

> ID：11471624
> 
> 赞同：0
> 
> 时间：2012-07-13T13:38:41.810
> 
> 标签：php, javascript, jquery, jquery-plugins

我从 jquery 创建了一个构造框。单击确认框中的确认按钮时，我想提交页面并查看 PHP 回显消息。你能帮我提供确认按钮的代码吗？

我的 jQuery/javascript 函数在这里：

```
$(document).ready(function(){
   $('#click').click(function(){
//$(function() {
    // a workaround for a flaw in the demo system (http://dev.jqueryui.com/ticket/4375), ignore!
    $( "#dialog:ui-dialog" ).dialog( "destroy" );

    $( "#dialog-confirm" ).dialog({
        resizable: false,
        height:140,
        modal: true,
        buttons: {
            "Ok": function() {

        // I WANT THE CODE FOR HERE TO SUBMIT THE PAGE TO WIEW PHP ECHO MESSAGE 
            },
            Cancel: function() {
                $( this ).dialog( "close" );
            }
        }
    });
});
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T13:41:05.620

使用 jQuery [Post](http://api.jquery.com/jQuery.post/)功能...

```
$.post("test.php", { 'choices[]': ["Jon", "Susan"] }); 
```

这是帖子完成时带有回调的版本...

```
$.post("test.php", { name: "John", time: "2pm" },
   function(data) {
     alert("Data Loaded: " + data);
   }
); 
```

或者，如果您有要发布的现有表单，请使用 jQuery[提交](http://api.jquery.com/submit/)功能...

```
$("form").submit(); 
```

但在执行此操作之前，您需要确保已填充表单中的输入字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T13:58:56.950

试试这个代码，

```
var parameter_1 = 'test';
var parameter_2 = 'test';
$.ajax(
        {
            type: "POST",
            url: "/submit_url.php",
            data: "parameter_1="+ parameter_1 +"& parameter_2 ="+ parameter_2,
            success: function(html)
            {
                   alert('Submitted');              
            }
        }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T17:18:17.820

您可以使用 jQuery 表单提交库。这会给你很多选择。并根据您的要求，您可以致电

```
beforeSubmit: 'YOUR FUNCTION To OPEN DIALOG', 
```

如果返回 true，您的表单将被发布，您肯定会得到回复。看这里的例子：http: [//malsup.com/jquery/form/#ajaxForm](http://malsup.com/jquery/form/#ajaxForm)

# javascript - mongodb中链接文档的语法

> ID：11471633
> 
> 赞同：1
> 
> 时间：2012-07-13T13:39:18.700
> 
> 标签：javascript, mongodb, bson

如果我在用户集合中有两个对象：

```
{_id: 1, name: 'foo', workItems: []}
{_id: 2, name: 'bar', workItems: []} 
```

如何将指向 workItem 集合中对象的链接添加到每个用户的 workItems 数组中？

我了解直接嵌入，但某些工作项将分配给多个用户，因此我不想重复数据。我查看了[mongodb.org](http://www.mongodb.org/)，但找不到任何链接示例。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T19:45:16.560

有时最好复制数据。MongoDB 是一个非关系型数据库。一些做事的方法是关系数据库的坏做法，但适用于非关系数据库。尽管有明显的共同点，但这确实不是同一种思维方式。

在我的工作中，我们在生产中使用它，发现读取操作复制数据既容易又快捷。这正是 MongoDB 的强大之处。当然，当一个工作项被修改时，这需要你的应用程序更新它出现的所有地方……这对于写密集型的系统可能不是一个好的解决方案。

另一点是引擎不处理关节，因此您必须至少发出第二个请求。然后，您必须在应用程序端手动进行连接。无论哪种方式，您都必须将逻辑从数据库移动到客户端应用程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-13T15:16:59.277

您可以像这样执行 DBRef：

```
{ $ref : <name of collection where reference is>, $id : <_id of document>, $db : <optional argument for specifying the databse the document is at> } 
```

因此，您的文档将如下所示：

```
{_id: 1, name: 'foo', workItems: {$ref: "blarg", $id: "1"}} 
```

# iphone - UIWebView 不在 UITabBarController 中滚动

> ID：11471639
> 
> 赞同：2
> 
> 时间：2012-07-13T13:39:56.613
> 
> 标签：iphone, ios, ipad

我设置了 4 个视图控制器，每个控制器都包含 a`UIWebView`并将它们设置为 a 的选项卡`UITabBarController`。

内容加载良好，按钮可点击，但内容`UIWebViews`拒绝滚动。`UIWebView`有一个内置`UIScrollView`的来处理它自己的滚动，所以它应该滚动正确吗？

我在主文件中的初始化代码是：

```
tabBarController = [[MainTabBarController alloc] init];
[tabBarController.view setBounds:CGRectMake(0, 0, dev_portrait.size.width, 44)];
[tabBarController setDelegate:self];

UIImage* anImage = [UIImage imageNamed:@"53-house.png"];
UITabBarItem* theItem = [[UITabBarItem alloc] initWithTitle:@"Home" image:anImage tag:0];
WebViewController *vc1 = [[WebViewController alloc] initWithNibName:@"WebController" bundle:nil];
[vc1 setup];
[vc1 setTabBarItem:theItem];

/// ... same for the other 3 WebViewControllers

NSArray* controllers = [NSArray arrayWithObjects:vc1, vc2, vc3, vc4, aNavigationController, nil];
tabBarController.viewControllers = controllers;
//self.window.rootViewController = tabBarController;
self.window.rootViewController = tabBarController; 
```

当一个选项卡被触摸时，它会在视图控制器中触发一个加载 URL 的函数：

```
- (void)handleURL:(NSString *)url {
    NSURLRequest *request = [NSURLRequest requestWithURL:[NSURL URLWithString:url]];
    NSLog(@"Handling URL: %@", request);
    [webpage loadRequest:request];
    lastURL = url;
    [self startLoaderIndicator];
} 
```

# android - 通过xml设置自定义字体

> ID：11471640
> 
> 赞同：1
> 
> 时间：2012-07-13T13:39:58.737
> 
> 标签：android, xml, fonts

如何设置字体，其 ttf`assets`通过 xml 驻留在我的文件夹中？我知道[如何以编程方式做到这一点，](https://stackoverflow.com/questions/5694163/custom-font-on-android)但你怎么能通过 xml 做到这一点？提前致谢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-13T13:47:20.060

您不能直接使用 XML 来执行此操作，但是您可以扩展`TextView`和设置默认字体。

```
package com.nannu;

import android.content.Context;
import android.graphics.Typeface;
import android.util.AttributeSet;
import android.widget.TextView;

public class NanTV extends TextView{

    private Context c;
    public NanTV(Context c) {
        super(c);
        this.c = c;
        Typeface tfs = Typeface.createFromAsset(c.getAssets(),
                "font/yourfont.ttf");
        setTypeface(tfs);

    }
    public NanTV(Context context, AttributeSet attrs, int defStyle) {
        super(context, attrs, defStyle);
        this.c = context;
        Typeface tfs = Typeface.createFromAsset(c.getAssets(),
                "font/yourfont.ttf");
        setTypeface(tfs);
        // TODO Auto-generated constructor stub
    }

    public NanTV(Context context, AttributeSet attrs) {
        super(context, attrs);
        this.c = context;
        Typeface tfs = Typeface.createFromAsset(c.getAssets(),
                "font/yourfont.ttf");
        setTypeface(tfs);

    }

} 
```

在你的布局中使用 new`TextView`

```
<com.nannu.NanTV
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Large Text"
        android:textAppearance="?android:attr/textAppearanceLarge" 

        /> 
```

我从我的上一个答案中发布这个[https://stackoverflow.com/a/11239305/1166537](https://stackoverflow.com/a/11239305/1166537)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-13T13:43:17.043

如果您创建自己的`TextView`派生，则可以添加该类以编程方式处理的 XML 属性。这样，您指定了某种字体，它将在运行时设置，但您通过 XML 来完成。:)

否则，没有已知的方法可以实现所请求的行为。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-13T13:50:32.557

您可以通过编写自定义 TextView 来做到这一点，否则您必须以编程方式设置它。有关更多详细信息，请参阅此[链接](http://helpmeco.de/2012/2/custom-fonts-in-android-widgets)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-12-11T17:52:25.773

我在这里创建了一个库来解决这个问题：[http ://responsiveandroid.com/2012/03/15/custom-fonts-in-android-widgets.html](http://responsiveandroid.com/2012/03/15/custom-fonts-in-android-widgets.html)

您扩展一个 TextView 并在 xml 中设置字体的名称。有一个可下载的示例。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-10-04T06:50:47.350

[您可以在 assets/fonts 下包含自定义字体，然后使用 https://github.com/browep/AndroidCustomFontWidgets/ 中的代码](https://github.com/browep/AndroidCustomFontWidgets/)

您可以在 XML 中指定字体，例如

```
<com.github.browep.customfonts.view.FontableTextView
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:text="This is in a custom font"
        app:font="MyFont-Bold.otf" /> 
```

该代码支持 FontableTextView 和 FontableButton，但如果您需要，它很容易扩展以支持其他小部件类型。

# mysql - MySQL / PHP连接表而不总是有公共列

> ID：11471641
> 
> 赞同：1
> 
> 时间：2012-07-13T13:40:00.513
> 
> 标签：mysql, join

**更新** 感谢我最初的问题的所有答案。我现在有另一个与这些查询相关的问题。加入表格后，我想搜索 NULL 结果，按照下面的示例，我想搜索 surname=NULL/surname=''，但它返回一个空结果，即使有 2 个未链接的结果。

示例查询：

```
SELECT table1.*,table2.* FROM table1 LEFT JOIN table2 ON table1.id=table2.id WHERE table2.surname=NULL 
```

这将返回 0。

有任何想法吗？我可以理解为什么它会返回 0 背后的逻辑，但必须有办法让它工作（？）

**原始问题：** 我在我的问题上找不到任何答案，可能是因为我不知道我应该寻找什么。

我遇到的问题是我想加入 2 个**具有**共同指标的表，但包含共同指标也不存在的记录。

也许我没有意义，但我会尝试在下面的代码中解释

表格1

```
id | name
1 | John
2 | Michael
3 | Anna
4 | Sue 
```

表2

```
id | surname
1 | Doe
2 | Anderson 
```

所以我想要一个像这样输出/绑定表的查询：

```
table1.id | table1.name | table2.id | table2.surname
1 | John | 1 | Doe
2 | Michael | 2 | Anderson
3 | Anna | NULL | NULL
4 | Sue | NULL | NULL 
```

因此，在有数据的地方合并，在没有数据的地方不要合并（或添加 NULL 值）。table2 的数据总是比 table1 少，所以 table1 可以用作骨骼。vlookup 在 Excel 中完美地做到了这一点，在找不到值的地方返回 N/A 我知道如何使用 PHP 来实现这一点，但我正在尝试加速我的代码，当处理远高于 50k 的记录时，我不想单个查询每一行以获取另一个表列。

我试过 WHERE table1.id=table2.id，但它只在 table2.id 存在的情况下加入它们，我也尝试过 JOIN ON 函数，但它也是一样的。

请帮忙

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T13:42:20.787

也许使用左连接。

```
SELECT *
FROM table1
LEFT JOIN table2 ON table1.id = table2.id 
```

请参阅[这篇出色的 Jeff Atwood 的帖子](http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T13:42:29.690

```
SELECT * FROM table1 LEFT JOIN ON table2 WHERE table1.id = table2.id; 
```

你试过这个吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T13:47:51.147

哈哈。有时我发现，如果我以其他人能够帮助我的方式来写我的问题，我就会想出来......我一直在寻找解决方案超过 4 小时，但是在写它的时候我开始思考我早期的课程中关于左/右连接的内容......

嗯......对不起，如果我占用了任何人的时间:)

如果其他人想知道，正确的查询是：

```
SELECT table1.*,table2.* FROM table1 LEFT JOIN table2 ON table1.id=table2.id 
```

# asp.net-mvc-3 - 所有页面上都没有必填字段导致问题

> ID：11471643
> 
> 赞同：0
> 
> 时间：2012-07-13T13:40:03.433
> 
> 标签：asp.net-mvc-3, razor

我的 MVC3 应用程序中有一个“创建”页面，其中包含 4 个必需的输入字段。我还有一个“编辑”页面，可以在其中编辑这 4 个字段中的 3 个。我不想显示第 4 个字段并希望将其保持为初始值（该字段是条目创建的日期）。

我在模型中将第 4 个字段标记为 [Required]，然后这会导致模型在 Edit 字段的 post action 方法中被声明为无效。如果我省略了 [Required] 注释，那么有人可以为此第 4 个字段创建一个具有空值的用户。

我怎样才能解决这个问题？

![创造](../Images/5f34468df826708a40d1bfdf127c41fc.png) ![编辑](../Images/388e0512f81ff6cc3fecc7558d37d95b.png)

型号代码：

```
 [Required]
    [DisplayName("User Name")]
    public string UserName { get; set; }

    [Required]
    public string Role { get; set; }

    [Required]
    [DataType(DataType.Date)]
    [DisplayName("Insert Date")]
    public DateTime? InsertDate { get; set; }

    [Required]
    [DisplayName("Active")]
    public bool ActiveInd { get; set; } 
```

控制器代码：

```
public ActionResult Edit(int id, ZUserRoleModel mod)
    {

        if (ModelState.IsValid)
        {

            // code removed

            return RedirectToAction("Index");
        }
        return View(mod);

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T14:03:33.233

您可以将该字段设置为在编辑模式下隐藏。

```
@Html.HiddenFor(x => x.EntryDate) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T19:55:51.147

不确定您是否仍然需要这个答案，但您需要做什么才能获得

```
@Html.HiddenFor(x => x.EntryDate ) 
```

工作，是将现有模型传递到视图中。因此，让我们假设您获取用户数据的操作如下所示。（你没有提供，所以我不确定这是否正确）

```
Public ActionResult GetUser(int UserID)
{
    ZUserRoleModel model = new ZUserRoleModel(UserID); 
    // Maybe this could go to your database and gather user
    // It would populate the correct data into a model object

    return View("Edit", model);
} 
```

通过隐藏字段的组合，您的视图将填充现有的用户信息，隐藏字段将填充数据，并将其传递给您的编辑操作。

注意：我在没有任何测试的情况下写了这个，但它仍然可以工作，或者至少，如果你仍然需要帮助，我希望它能为你指明正确的方向。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T14:08:45.443

您可以使用 fluentvalidation： [http ://fluentvalidation.codeplex.com/](http://fluentvalidation.codeplex.com/)

有一个类似的规则

```
RuleFor(user => user.field4).NotEmpty().When(ViewContext.Controller.ValueProvider.GetValue("action").RawValue <> "edit") 
```

# javascript - Gmaps4rails：如何在 javascript 中创建丰富的标记？

> ID：11471647
> 
> 赞同：0
> 
> 时间：2012-07-13T13:40:22.357
> 
> 标签：javascript, gmaps4rails

我向用户位置添加一个标记，如下所示：

```
Gmaps.map.callback = function() {
  Gmaps.map.createMarker({Lat: lat,
                          Lng: lng, 
                          rich_marker: null, 
                          marker_picture: ""
  });
} 
```

，但我想更改标记的图像。丰富的标记似乎是解决方案，但我无法正确构建rich_marker。

谁能举一个丰富的标记构造的例子。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-21T22:21:43.227

你应该做：

```
Gmaps.map.callback = function() {
  Gmaps.map.rich_marker = true;
  Gmaps.map.createMarker({Lat: lat,
                      Lng: lng, 
                      rich_marker: your_custom_html, 
                      marker_picture: ""
  });
} 
```

# objective-c - if 语句比较在目标 c 中不起作用的整数

> ID：11471655
> 
> 赞同：2
> 
> 时间：2012-07-13T13:40:52.670
> 
> 标签：objective-c, xcode, xcode4.3

我正在尝试根据两个整数的值执行逻辑。在这里，我定义了我的整数，并且我也有 NSLog，所以我可以在运行代码时查看这些值是否正确：

```
int theHikeFlag = (int)[theNewHikeFlag objectAtIndex:(theID-1)];
NSLog(@"theHikeFlag: %@",theHikeFlag);
int fromTheDB = [self.detailItem hikeFlag];
NSLog(@"fromTheDB: %d",fromTheDB); 
```

这是逻辑：

```
if (theHikeFlag==1) {
    hikeString=@"You have";
}
else if (theHikeFlag==0) {
    hikeString=@"You have not";
}
else {
    if (fromTheDB==1) {
        hikeString=@"You have";
    }
    else {
        hikeString=@"You have not";
    }
} 
```

作为此代码如何工作的示例。当`theHikeFlag=1`and`fromTheDB=0`时，代码绕过 if 和 else if 并直接进入 else 和集合`hikeString="You have not"`。这意味着我的结果与 HikeFlag 无关，并且基于 fromTheDB 整数。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-13T13:44:07.133

由于您不能将`int`s 存储在数组中，因此该行

```
(int)[theNewHikeFlag objectAtIndex:(theID-1)]; 
```

没有做你认为应该做的事。您需要从中提取数据`NSNumber`，而不是投射到`int`.

```
int theHikeFlag = [[theNewHikeFlag objectAtIndex:(theID-1)] intValue]; 
```

日志输出正确的原因有点搞笑：你连续犯了两个错误！首先，您将指针重新解释为`int`，然后通过添加与 不兼容`NSLog`的格式说明符再次将其重新解释为对象，但与指针一起工作正常！由于该值包含指向 的指针，因此会产生“正确”的输出。`%@``int``int``NSNumber``NSLog`

# c++ - 将字符串转换为双精度的最佳方法？

> ID：11471661
> 
> 赞同：3
> 
> 时间：2012-07-13T13:41:12.493
> 
> 标签：c++, string, double

> **可能重复：**
> [将字符串转换为双精度](https://stackoverflow.com/questions/4308536/converting-a-string-into-a-double)

将 string 转换为 double 的最佳方法是什么？我正在使用 sstream 但我觉得它不是那么快.. 是否有更快的 wawy 而不使用任何外部库或某事。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T13:44:00.687

`strtod()`将比使用更少的开销`sstream`。

```
#include <stdlib.h>

char * s = ...;
double d = strtod(s, 0); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T13:55:09.540

你可以使用 boost library lexical cast 他们还在他们的文档页面上包含性能测试结果 [boost lexical cast](http://www.boost.org/doc/libs/1_50_0/doc/html/boost_lexical_cast.html)

干杯

# ejb - IBM WAS createEJBStubs

> ID：11471667
> 
> 赞同：1
> 
> 时间：2012-07-13T13:41:31.097
> 
> 标签：ejb, websphere

我想使用[这里](http://pic.dhe.ibm.com/infocenter/wasinfo/v7r0/index.jsp?topic=%2Fcom.ibm.websphere.express.doc%2Finfo%2Fexp%2Fae%2Frejb_3stubscmd.html)`createEJBStubs`描述的命令。

但是当我将它应用到部署在服务器上的 .ear 文件时，我得到以下异常：

> CNTR9258E: 错误：发生意外异常“打开 zip 文件时出错”。

有没有人遇到过这个问题？可以做些什么来成功创建存根？

这是我使用该`-verbose`选项得到的结果：

```
CNTR9258E: Error: Unexpected exception "error in opening zip file" occurred.
java.util.zip.ZipException: error in opening zip file
    at java.util.zip.ZipFile.open(Native Method)
    at java.util.zip.ZipFile.<init>(ZipFile.java:203)
    at java.util.jar.JarFile.<init>(JarFile.java:132)
    at java.util.jar.JarFile.<init>(JarFile.java:97)
    at com.ibm.ws.deploy.tools.CreateEJBStubsCommand.main(CreateEJBStubsCommand.java:279)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:592)
    at com.ibm.wsspi.bootstrap.WSLauncher.launchMain(WSLauncher.java:183)
    at com.ibm.wsspi.bootstrap.WSLauncher.main(WSLauncher.java:90)
    at com.ibm.wsspi.bootstrap.WSLauncher.run(WSLauncher.java:72)
    at org.eclipse.core.internal.runtime.PlatformActivator$1.run(PlatformActivator.java:78)
    at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:92)
    at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:68)
    at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:400)
    at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:177)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:592)
    at org.eclipse.core.launcher.Main.invokeFramework(Main.java:340)
    at org.eclipse.core.launcher.Main.basicRun(Main.java:282)
    at org.eclipse.core.launcher.Main.run(Main.java:981)
    at com.ibm.wsspi.bootstrap.WSPreLauncher.launchEclipse(WSPreLauncher.java:339)
    at com.ibm.wsspi.bootstrap.WSPreLauncher.main(WSPreLauncher.java:94)
Command Failed 
```

# php - PHP cookie 有一个刷新延迟

> ID：11471674
> 
> 赞同：2
> 
> 时间：2012-07-13T13:42:00.400
> 
> 标签：php, cookies

> **可能重复：**
> [Cookie 仅在刷新时显示？](https://stackoverflow.com/questions/983795/cookie-only-displayed-on-refresh)

我正在尝试设置一个基本的 PHP cookie，它会记住使用哪种颜色主题。但是，当我对其进行测试时，在设置和颜色主题的显示之间存在一次刷新滞后。

澄清一下：我有一个选择表单，允许用户选择颜色。然后，有一个应用按钮。一旦选择了应用按钮，页面应该会自动设置 cookie 并显示颜色。但是，当应用按钮被按下时，只有 cookie 被设置，并且在用户点击刷新按钮之前不会显示主题。关于如何解决这个问题的任何想法？

```
$help = $_POST["theme"];
    $color = "#" . $help;
    setcookie("TestCookie", $color, time()+60*60*24);
    $recolor = $_COOKIE["TestCookie"];
    echo '<style type="text/css"> body { background: '.$recolor.' } </style>'; 
```

其中 $_POST["theme"] 是选择表单名称。非常感谢！this: [Cookie 只在刷新时显示？](https://stackoverflow.com/questions/983795/cookie-only-displayed-on-refresh)是我在说什么，但使用 PHP，而不是 C#

编辑：感谢所有回复！我设法通过将背景颜色设置为用户在设置 cookie 时选择的任何内容来解决此问题。因此，当用户最初选择颜色时，并不是 cookie 设置了背景。这是另一个功能。感觉有点便宜，但是好用！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-13T13:44:33.630

$_COOKIE 超全局变量在您请求该页面时具有可用的 cookie，这就是为什么您永远不会看到刚刚保存的值的原因

[在http://php.net/set_cookie](http://php.net/set_cookie)的手册页上，您可以看到：

> 一旦设置了 cookie，就可以在下一页加载时使用 $_COOKIE 或 $HTTP_COOKIE_VARS 数组访问它们。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-13T13:45:02.780

那是因为 setcookie 没有修改 $_COOKIE 变量。您必须使用`setcookie`并同时在 $_COOKIE 中设置相关值

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-13T13:45:06.267

我希望这是因为您正在设置 cookie，然后检查下一行代码中的值 - 您还看不到它，因为此时客户端将发送该页面的请求，其中还不包括 cookie。

您可以尝试使用 a`$_SESSION`代替 - 只需将您对`$_COOKIE`$_SESSION 的引用全部交换即可。

如果做不到这一点，请尝试明确检查表单是否刚刚提交，并根据他们刚刚提交的值设置样式。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-13T13:49:49.127

添加到**ShogunArts.de**的 solotion 时，当 you 时`setcookie()`，这个“命令”必须首先通过 HTTP 标头发送到浏览器。当您尝试访问超级全局时同样适用，`$_COOKIE`它不会包含 cookie 值，除非浏览器也通过 HTTP 标头返回。

这是发生的事情：

1.  请求的页面（浏览器还没有 cookie）
2.  `setcookie()`叫。
3.  脚本完成执行，现在它将响应浏览器告诉它设置 cookie。
4.  当浏览器拥有 cookie 后再次访问该页面时，它将与请求一起发送。
5.  现在 PHP 已经收到一个带有 cookie 的请求，它设置了`$_COOKIE`超级全局，现在您可以使用您的脚本访问它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-13T13:47:56.147

询问是否设置了 cookie：

```
if(isset($_COOKIE["TestCookie"])) $recolor = $_COOKIE["TestCookie"]; 
else $recolor = $color; 
```

# c# - 将类序列化为 XML 并包含 CDATA 部分的问题

> ID：11471676
> 
> 赞同：2
> 
> 时间：2012-07-13T13:42:04.300
> 
> 标签：c#, xml, xml-serialization

我有一个类被序列化为 XML 以供 Web 服务使用。在此类实例中，XML 必须包含一个 CDATA 部分，以便 Web 服务读取它，但我不知道如何实现它。

XML 需要如下所示：

```
<UpdateOrderStatus> 
    <Action>2</Action> 
        <Value> 
            <![CDATA[ 
                <Shipment> 
                    <Header> 
                        <SellerID>
                            ...
             ]]>
         </Value>
 </UpdateOrderStatus> 
```

我能够生成适当的 XML，除了 CDATA 部分。

我的班级结构如下：

```
public class UpdateOrderStatus
{
    public int Action { get; set; }

    public ValueInfo Value { get; set; }

    public UpdateOrderStatus()
    {
        Value = new ValueInfo();
    }

    public class ValueInfo
    {
        public ShipmentInfo Shipment { get; set; }

        public ValueInfo()
        {
            Shipment = new ShipmentInfo();
        }

        public class ShipmentInfo
        {
            public PackageListInfo PackageList { get; set; }
            public HeaderInfo Header { get; set; }
            public ShipmentInfo()
            {
                PackageList = new PackageListInfo();
                Header = new HeaderInfo();
            }

         .... 
```

我已经看到了一些关于使用的建议：

```
[XmlElement("node", typeof(XmlCDataSection))] 
```

但这会导致异常

我也试过

```
 [XmlElement("Value" + "<![CDATA[")] 
```

但生成的 XML 显示不正确

```
 <Value_x003C__x0021__x005B_CDATA_x005B_>
 ....
 </Value_x003C__x0021__x005B_CDATA_x005B_> 
```

谁能告诉我我做错了什么，或者我需要去哪里？

- 编辑 -

使每个 carlosfigueira 的 shippingInfo 可序列化在大多数情况下都有效，但是我得到了额外的？生成的 XML 中的字符（有关详细信息，请参阅使用 XmlWriterSettings 和 XmlSerializer 编写 XML 片段的帖子[给出了额外的字符](https://stackoverflow.com/questions/11456632/writing-an-xml-fragment-using-xmlwritersettings-and-xmlserializer-is-giving-an-e)）

因此，我将 Write XML 方法更改为：

```
public void WriteXml(XmlWriter writer)
        {
            using (MemoryStream ms = new MemoryStream())
            {
                XmlSerializerNamespaces ns = new XmlSerializerNamespaces();
                ns.Add("", "");

                XmlWriterSettings settings = new XmlWriterSettings();

                settings.OmitXmlDeclaration = true;
                settings.Encoding = new UnicodeEncoding(bigEndian: false, byteOrderMark: false);
                settings.Indent = true;

                using (XmlWriter innerWriter = XmlWriter.Create(ms, settings))
                {
                    shipmentInfoSerializer.Serialize(innerWriter, this.Shipment,ns);
                    innerWriter.Flush();
                    writer.WriteCData(Encoding.UTF8.GetString(ms.ToArray()));
                }
            }
        } 
```

但是我没有例外：

```
System.InvalidOperationException: There was an error generating the XML document. ---> System.ArgumentException: '.', hexadecimal
value 0x00, is an invalid character. 
```

- 编辑 -

该异常是由于包含了我之前的 serializeToString 方法引起的。由于删除 CDATA 输出是正确的，除了间距问题，但我还得到了应由指定的 XML 设置删除的命名空间和 xml 声明。输出是：

```
<?xml version="1.0"?>
<UpdateOrderStatus xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <Action>1</Action>
  <Value><![CDATA[< S h i p m e n t I n f o >
     < P a c k a g e L i s t >
         < P a c k a g e >
             < S h i p D a t e > 2 0 1 2 - 0 7 - 1 3 T 1 1 : 5 8 : 5 1 . 0 9 2 5 6 1 5 - 0 4 : 0 0 < / S h i p D a t e >
             < I t e m L i s t >
                 < I t e m >
                     < S h i p p e d Q t y > 0 < / S h i p p e d Q t y >
                 < / I t e m >
             < / I t e m L i s t >
         < / P a c k a g e >
     < / P a c k a g e L i s t >
     < H e a d e r >
         < S e l l e r I d > S h i p m e n t   h e a d e r < / S e l l e r I d >
         < S O N u m b e r > 0 < / S O N u m b e r >
     < / H e a d e r >
 < / S h i p m e n t I n f o > ]]></Value>
</UpdateOrderStatus> 
```

使用新类避免 BOM 的任何想法？

--编辑 3 --**成功！**

我已经实现了下面建议的更改，现在具有以下编写器类和测试方法：

```
 UpdateOrderStatus obj = new UpdateOrderStatus();

        obj.Action = 1;
        obj.Value = new UpdateOrderStatus.ValueInfo();
        obj.Value.Shipment = new UpdateOrderStatus.ValueInfo.ShipmentInfo();
        obj.Value.Shipment.Header.SellerId = "Shipment header";
        obj.Value.Shipment.PackageList = new UpdateOrderStatus.ValueInfo.ShipmentInfo.PackageListInfo();
        obj.Value.Shipment.PackageList.Package = new UpdateOrderStatus.ValueInfo.ShipmentInfo.PackageListInfo.PackageInfo();
        obj.Value.Shipment.PackageList.Package.ShipDate = DateTime.Now;

        XmlSerializerNamespaces ns = new XmlSerializerNamespaces();
        ns.Add("", "");
        XmlWriterSettings settings = new XmlWriterSettings();
        settings.OmitXmlDeclaration = true;
        settings.Encoding = new UTF8Encoding(false);
        settings.Indent = true;
        XmlSerializer xs = new XmlSerializer(typeof(UpdateOrderStatus));
        MemoryStream ms = new MemoryStream();

        XmlWriter writer = XmlWriter.Create(ms, settings);
        xs.Serialize(writer, obj, ns);
        Console.WriteLine(Encoding.UTF8.GetString(ms.ToArray()));
    }

public void WriteXml(XmlWriter writer)
        {

            XmlSerializerNamespaces ns = new XmlSerializerNamespaces();
            ns.Add("", "");

            XmlWriterSettings settings = new XmlWriterSettings();

            settings.OmitXmlDeclaration = true;
            settings.Indent = true;

            StringBuilder sb = new StringBuilder();
            using (XmlWriter innerWriter = XmlWriter.Create(sb, settings))
            {
                shipmentInfoSerializer.Serialize(innerWriter, this.Shipment, ns);
                innerWriter.Flush();
                writer.WriteCData(sb.ToString());
            }   
        } 
```

这将生成以下 XML：

```
<UpdateOrderStatus>
  <Action>1</Action>
  <Value><![CDATA[<ShipmentInfo>
  <PackageList>
    <Package>
      <ShipDate>2012-07-13T14:05:36.6170802-04:00</ShipDate>
      <ItemList>
        <Item>
          <ShippedQty>0</ShippedQty>
        </Item>
      </ItemList>
    </Package>
  </PackageList>
  <Header>
    <SellerId>Shipment header</SellerId>
    <SONumber>0</SONumber>
  </Header>
</ShipmentInfo>]]></Value>
</UpdateOrderStatus> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T16:37:10.210

为了响应您在编辑后看到的“空格”，这是因为您使用的编码（Unicode，每个字符 2 个字节）。

尝试：

```
settings.Encoding = new Utf8Encoding(false); 
```

**编辑：**

另外，请注意，格式*不一定*`MemoryStream`是有效的 UTF-8 编码字符串！您可以使用 a而不是来创建您的内心作家。*`StringBuilder``MemoryStream`*

 *```
 public void WriteXml(XmlWriter writer)   
    {   
        XmlSerializerNamespaces ns = new XmlSerializerNamespaces();   
        ns.Add("", "");   

        XmlWriterSettings settings = new XmlWriterSettings();   

        settings.OmitXmlDeclaration = true;   
        settings.Indent = true;   

        StringBuilder sb = new StringBuilder();
        using (XmlWriter innerWriter = XmlWriter.Create(sb, settings))   
        {   
            shipmentInfoSerializer.Serialize(innerWriter, this.Shipment,ns);   
            innerWriter.Flush();   
            writer.WriteCData(sb.ToString());   
        }   
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-13T14:10:46.143

这有什么帮助吗：http: [//msdn.microsoft.com/en-us/library/system.xml.xmldocument.createcdatasection.aspx](http://msdn.microsoft.com/en-us/library/system.xml.xmldocument.createcdatasection.aspx)

```
//Create a CData section.
XmlCDataSection CData;
CData = doc.CreateCDataSection("All Jane Austen novels 25% off starting 3/23!");    

//Add the new node to the document.
XmlElement root = doc.DocumentElement;
root.AppendChild(CData);  

Console.WriteLine("Display the modified XML...");        
doc.Save(Console.Out); 
```

另外，您在使用该属性时遇到了什么异常？

- 编辑 -

您可以尝试添加一个自定义类，并执行以下操作：

```
some xml serializable class,
 {
    .......

    [XmlElement("PayLoad", Type=typeof(CDATA))]
    public CDATA PayLoad
    {
       get { return _payLoad; }
       set { _payLoad = value; }
    }
 }

 public class CDATA : IXmlSerializable
 {
    private string text;
    public CDATA()
    {}

    public CDATA(string text)
    {
       this.text = text;
    }

    public string Text
    {
       get { return text; }
    }

    /// <summary>
    /// Interface implementation not used here.
    /// </summary>
    XmlSchema IXmlSerializable.GetSchema()
    {
       return null;
    }

    /// <summary>
    /// Interface implementation, which reads the content of the CDATA tag
    /// </summary>
    void IXmlSerializable.ReadXml(XmlReader reader)
    {
       this.text = reader.ReadElementString();
    }

    /// <summary>
    /// Interface implementation, which writes the CDATA tag to the xml
    /// </summary>
    void IXmlSerializable.WriteXml(XmlWriter writer)
    {
       writer.WriteCData(this.text);
    }
 } 
```

如此处[http://bytes.com/topic/net/answers/530724-cdata-xmltextattribute](http://bytes.com/topic/net/answers/530724-cdata-xmltextattribute)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-13T15:07:46.317

将ShipmentInfo 实现为一种`IXmlSerializable`类型将接近您的需要 - 请参见下面的示例。

```
public class StackOverflow_11471676
{
    public class UpdateOrderStatus
    {
        public int Action { get; set; }
        public ValueInfo Value { get; set; }
    }
    [XmlType(TypeName = "Shipment")]
    public class ShipmentInfo
    {
        public string Header { get; set; }
        public string Body { get; set; }
    }
    public class ValueInfo : IXmlSerializable
    {
        public ShipmentInfo Shipment { get; set; }
        private XmlSerializer shipmentInfoSerializer = new XmlSerializer(typeof(ShipmentInfo));

        public System.Xml.Schema.XmlSchema GetSchema()
        {
            return null;
        }

        public void ReadXml(XmlReader reader)
        {
            using (MemoryStream ms = new MemoryStream(
                Encoding.UTF8.GetBytes(
                    reader.ReadContentAsString())))
            {
                Shipment = (ShipmentInfo)this.shipmentInfoSerializer.Deserialize(ms);
            }
        }

        public void WriteXml(XmlWriter writer)
        {
            using (MemoryStream ms = new MemoryStream())
            {
                using (XmlWriter innerWriter = XmlWriter.Create(ms, new XmlWriterSettings { OmitXmlDeclaration = true }))
                {
                    shipmentInfoSerializer.Serialize(innerWriter, this.Shipment);
                    innerWriter.Flush();
                    writer.WriteCData(Encoding.UTF8.GetString(ms.ToArray()));
                }
            }
        }
    }
    public static void Test()
    {
        UpdateOrderStatus obj = new UpdateOrderStatus
        {
            Action = 1,
            Value = new ValueInfo
            {
                Shipment = new ShipmentInfo
                {
                    Header = "Shipment header",
                    Body = "Shipment body"
                }
            }
        };

        XmlSerializer xs = new XmlSerializer(typeof(UpdateOrderStatus));
        MemoryStream ms = new MemoryStream();
        xs.Serialize(ms, obj);
        Console.WriteLine(Encoding.UTF8.GetString(ms.ToArray()));
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-01-30T22:01:58.963

以下示例仅适用于定义架构的结构并且您无法选择更改架构的情况。

当您反序列化/序列化**[xmltext]**值时，很难将文本保存在附件中`CDATA[]` 。您可以使用 compiletransform 来获取原样的`CDATA`值，但是一旦您在 C# 中反序列化并加载到内存中，它就会丢失。`xml``CDATA`

这是最简单的方法之一

1.  反序列化/序列化
2.  一旦导出最终的 xml 输出。最终的 xml 可以转换为字符串并如下所示进行解析，并将其作为字符串返回，并将嵌入`CDATA`到 test1 值中。

```
string xml ="<test><test1>@#@!#!#!@#!@#%$%@#$%#$%</test1></test>";
XNamespace ns = @"";
XDocument doc = XDocument.Parse(xml);
string xmlString = string.Empty; 
var coll = from query in doc.Descendants(ns + "test1")
                select query;

foreach (var value in coll){
    value.ReplaceNodes(new XCData(value .Value));
}

doc.save("test.xml");// convert doc.tostring() 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-13T18:28:05.880

我认为**carlosfigueira**只是给出了一个优雅的答案，但乍一看可能有点难以理解。这是您考虑的替代方案，您可以单独进行序列化/反序列`UpdateOrderStatus`化`ShipmentInfo`。

将您的业务对象类定义为：

```
 [XmlRoot("UpdateOrderStatus")]
    public class UpdateOrderStatus
    {
        [XmlElement("Action")]
        public int Action { get; set; }

        private String valueField;
        [XmlElement("Value")]
        public XmlCDataSection Value
        {
            get
            {
                XmlDocument xmlDoc = new XmlDocument();
                return xmlDoc.CreateCDataSection(valueField);
            }
            set
            {
                this.valueField = value.Value;
            }
        }

        [XmlIgnore]
        public ShipmentInfo Shipment
        {
            get;
            set;
        }
    }

    [XmlRoot("ShipmentInfo")]
    public class ShipmentInfo
    {
        [XmlElement("Package")]
        public String Package { get; set; }
        [XmlElement("Header")]
        public String Header { get; set; }
    } 
```

请注意，您应该使用`XmlCDataSection`该`Value`字段。这是测试/辅助功能：

```
 // Test function
    const string t = @"<UpdateOrderStatus> 
        <Action>2</Action> 
            <Value> 
                <![CDATA[<ShipmentInfo>
      <Package>packageInfo</Package>
      <Header>headerInfo</Header>
    </ShipmentInfo>]]>
             </Value>
    </UpdateOrderStatus>";

    static void Test1()
    {
        UpdateOrderStatus os = Deserialize(t);

        String t2 = XmlUtil.Serialize(os);
    }

    // Helper functions
    static UpdateOrderStatus Deserialize(String str)
    {
        UpdateOrderStatus os = XmlUtil.DeserializeString<UpdateOrderStatus>(str);
        os.Shipment = XmlUtil.DeserializeString<ShipmentInfo>(os.Value.InnerText);
        return os;
    }

    public static class XmlUtil
    {
        public static String Serialize<T>(T o)
        {
            XmlSerializer s = new XmlSerializer(typeof(T)); //, overrides);
            //StringBuilder builder = new StringBuilder();

            MemoryStream ms = new MemoryStream();
            XmlWriterSettings settings = new XmlWriterSettings();
            settings.Encoding = Encoding.UTF8;
            settings.Indent = true;
            using (XmlWriter xmlWriter = XmlWriter.Create(ms, settings))
            {
                XmlSerializerNamespaces ns = new XmlSerializerNamespaces();
                ns.Add(String.Empty, String.Empty);
                s.Serialize(xmlWriter, o, ns);
            }
            Byte[] bytes = ms.ToArray();
            // discard the BOM part
            Int32 idx = settings.Encoding.GetPreamble().Length;
            return Encoding.UTF8.GetString(bytes, idx, bytes.Length - idx);
        }

        public static T DeserializeString<T>(String content)
        {
            using (TextReader reader = new StringReader(content))
            {
                XmlSerializer s = new XmlSerializer(typeof(T));
                return (T)s.Deserialize(reader);
            }
        }

        ...
    } 
```*

# java - Spring，通过具有远程 JBoss 服务器的 JNDI 配置数据源

> ID：11471679
> 
> 赞同：1
> 
> 时间：2012-07-13T13:42:08.763
> 
> 标签：java, spring, jakarta-ee, datasource, jndi

我想通过 JNDI 进入`DataSource`。`Spring`所有的配置都给出了。

谁能告诉我配置有什么问题。

我想在这里提到的一件事是 JNDI DS 托管在不托管`Spring`应用程序的 JBoss 服务器上。

## 配置

**数据源-ds.xml**

```
<?xml version="1.0" encoding="UTF-8"?>
<datasources>
  <local-tx-datasource>
    <jndi-name>jdbc/wc-mysql</jndi-name>
    <connection-url>jdbc:mysql://xx.xx.xx.xx:3306/club</connection-url>
    <driver-class>com.mysql.jdbc.Driver</driver-class>
    <user-name>club</user-name>
    <password>club</password>
    <exception-sorter-class-name>
      org.jboss.resource.adapter.jdbc.vendor.MySQLExceptionSorter
    </exception-sorter-class-name>
    <min-pool-size>5</min-pool-size>
    <max-pool-size>20</max-pool-size>
    <use-java-context>false</use-java-context>
    <metadata><type-mapping>mySQL</type-mapping></metadata>
  </local-tx-datasource>
</datasources> 
```

**配置上下文.xml**

```
<bean id="wcDataSource" class="org.springframework.jndi.JndiObjectFactoryBean">
  <property name="jndiName" value="jdbc/wc-mysql" />
  <property name="jndiEnvironment">
    <props>
      <prop key="java.naming.provider.url">jnp://yy.yy.yy.yy:1099</prop>
      <!-- 
      <prop key="java.naming.factory.initial">
        org.springframework.mock.jndi.SimpleNamingContextBuilder
      </prop>
      <prop key="java.naming.factory.url.pkgs">yourPackagePrefixesGoHere</prop> -->
      <!-- other key=values here -->
    </props>
  </property>
  <!-- other properties here-->
</bean> 
```

**例外**

```
Caused by: javax.naming.NameNotFoundException: Name jdbc is not bound in this Context
        at org.apache.naming.NamingContext.lookup(NamingContext.java:770)
        at org.apache.naming.NamingContext.lookup(NamingContext.java:153)
        at org.apache.naming.SelectorContext.lookup(SelectorContext.java:152)
        at javax.naming.InitialContext.lookup(InitialContext.java:392)
        at org.springframework.jndi.JndiTemplate$1.doInContext(JndiTemplate.java:154) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T07:42:07.333

我做了一些改变，现在工作正常。

必须使用 JNP 属性初始化 JNDI 模板。并且 JBoss 服务器的 URL 必须在该属性中。

**配置上下文.xml**

```
<bean id="wcJndiTemplate" class="org.springframework.jndi.JndiTemplate">
    <property name="environment">
        <props>
            <prop key="java.naming.factory.initial">org.jnp.interfaces.NamingContextFactory</prop>
            <prop key="java.naming.provider.url">jnp://jndi.myURL.me:1099</prop>
            <prop key="java.naming.factory.url.pkgs">org.jboss.naming:org.jnp.interfaces</prop>
            <prop key="jnp.disableDiscovery">true</prop>
        </props>
    </property>
</bean>

<bean id="wcDataSource" class="org.springframework.jndi.JndiObjectFactoryBean">
    <property name="jndiName" value="jdbc/wc-mysql"/>
    <property name="resourceRef" value="false"/>
    <property name="jndiTemplate" ref="wcJndiTemplate" />
</bean> 
```

但是在做了这些改变之后，我面临着一个例外

```
java.lang.ClassNotFoundException: org.jnp.interfaces.NamingContextFactory 
```

所以我找到了一个链接，提到`jbossall-client.jar`在 POM 中包含一个依赖项来解决这个问题。所以 pom 的变化是

```
<dependency>
    <groupId>jboss</groupId>
    <artifactId>jbossall-client</artifactId>
    <version>4.2.2.GA</version>
</dependency> 
```

每件事似乎都运行良好。

谢谢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T19:06:44.340

你的遥控器没有问题，`JNDI`因为这条线

```
 <use-java-context>false</use-java-context> 
```

会照顾它。

您的 JNDI 名称值有问题：

```
javax.naming.NameNotFoundException: Name jdbc is not bound in this Context 
```

在你的`applicationConfig.xml`

```
<property name="jndiName" value="jdbc/wc-mysql" /> 
```

到

```
<property name="jndiName" value="java:/jdbc/wc-mysql"></property> 
```

它应该工作

# c# - 结构图命名配置

> ID：11471681
> 
> 赞同：0
> 
> 时间：2012-07-13T13:42:19.147
> 
> 标签：c#, .net, structuremap

我像这样配置结构图：

```
 ObjectFactory.Configure(x => {
            x.For<IA>().Use<A>().Named(CommonModule.ModuleName);
            x.For<IB>().Use<B>().Named(CommonModule.ModuleName);
            x.For<IC>().Use<C>().Named(CommonModule.ModuleName);
            x.For<ID>().Use<D>().Named(CommonModule.ModuleName);
            ...
            ...
            ...
        }); 
```

我可以通过某种方式告诉这个配置调用中的所有设置都以 CommonModule.ModuleName 命名（而不是一个一个）来缩短这个时间吗？就像是：

```
 ObjectFactory.Configure(x => {
        x.For<IA>().Use<A>();
        x.For<IB>().Use<B>();
        x.For<IC>().Use<C>()
        x.For<ID>().Use<D>();
        ...
        ...
        ...
    }).Named(CommonModule.ModuleName); 
```

# python - 查询维基百科资料页

> ID：11471684
> 
> 赞同：3
> 
> 时间：2012-07-13T13:42:26.570
> 
> 标签：python, web-crawler, wikipedia

我无法理解维基百科 API。

我已经**隔离了一个链接，通过处理我在向****[http://en.wikipedia.org/w/api.php](http://en.wikipedia.org/w/api.php)**发送请求后得到的响应作为响应

假设我获得了以下[链接](http://en.wikipedia.org/wiki/Jennifer_Aniston)，我如何获得出生日期等信息。

我正在使用python。我试着做一个

```
import urllib2,simplejson
search_req = urllib2.Request(direct_url_to_required_wikipedia_page)
response = urllib2.urlopen(search_req) 
```

我试过阅读api。但是，我不知道如何从特定页面中提取数据。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-13T13:57:51.613

尝试：

```
import urllib
import urllib2
import simplejson

url = 'http://en.wikipedia.org/w/api.php'
values = {'action' : 'query',
          'prop' : 'revisions',
          'titles' : 'Jennifer_Aniston',
          'rvprop' : 'content',
          'format' : 'json'}

data = urllib.urlencode(values)
req = urllib2.Request(url, data)
response = urllib2.urlopen(req)
json = response.read() 
```

变量 json 是维基百科页面的 json。你现在可以用 simplejson 或其他任何东西来解析它......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-13T13:52:27.003

转到[MediaWiki API](https://www.mediawiki.org/wiki/API)。它更有条理，对人类更友好:-)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-13T14:11:48.137

您不会从 API 中获得诸如出生日期之类的信息，至少不会直接获得。您可以做的最好的事情是获取页面的代码（或呈现的 HTML）并对其进行解析以获取所需的信息。

作为替代方案，您可能想查看[DBpedia](http://dbpedia.org/About)。

# c++ - curl.h 没有这样的文件或目录

> ID：11471690
> 
> 赞同：97
> 
> 时间：2012-07-13T13:42:45.777
> 
> 标签：c++, curl

我安装了 curl 这个命令（我使用 Ubuntu）：

```
sudo apt-get install curl 
```

当我使用测试简单程序时`g++ test.cpp`

```
#include <stdio.h>
#include <curl/curl.h>

int main(void)
{
  CURL *curl;
  CURLcode res;

  curl = curl_easy_init();
  if(curl) {
    curl_easy_setopt(curl, CURLOPT_URL, "http://example.com");

    /* Perform the request, res will get the return code */ 
    res = curl_easy_perform(curl);
    /* Check for errors */ 
    if(res != CURLE_OK)
      fprintf(stderr, "curl_easy_perform() failed: %s\n",
              curl_easy_strerror(res));

    /* always cleanup */ 
    curl_easy_cleanup(curl);
  }
  return 0;
} 
```

`g++`向我展示：

```
fatal error: curl/curl.h: No such file or directory
compilation terminated. 
```

谁能帮我？

* * *

## 回答 #1

> 赞同：174
> 
> 时间：2012-07-13T13:45:31.153

~~sudo apt-get install curl-devel~~

```
sudo apt-get install libcurl-dev 
```

（将安装默认替代）

或者

```
sudo apt-get install libcurl4-openssl-dev 
```

（OpenSSL 变体）

或者

```
sudo apt-get install libcurl4-gnutls-dev 
```

（gnutls 变体）

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2016-04-25T05:56:59.623

对于那些使用 centos 并偶然发现这篇文章的人：

```
 $ yum install curl-devel 
```

并在编译程序时`example.cpp`，链接到 curl 库：

```
 $ g++ example.cpp -lcurl -o example 
```

" `-o example`" 创建可执行文件`example`而不是默认的`a.out`。

下一行运行`example`：

```
 $ ./example 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-13T13:45:25.090

而不是下载 curl，而是下载 libcurl。

curl 只是应用程序，libcurl 是您的 C++ 程序所需要的

[http://packages.ubuntu.com/quantal/curl](http://packages.ubuntu.com/quantal/curl)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-07-13T13:50:39.867

是的，请按照上面的说明下载 curl-devel。也不要忘记链接到 lib curl：

```
-L/path/of/curl/lib/libcurl.a (g++) 
```

干杯

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2019-03-18T13:06:01.577

如果安装 curl-dev luarocks 后没有看到标题：

```
find /usr -name 'curl.h'
Example: /usr/include/x86_64-linux-gnu/curl/curl.h

luarocks install lua-cURL CURL_INCDIR=/usr/include/x86_64-linux-gnu/ 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-02-09T10:45:22.067

对于那些在谷歌搜索“ `R` `curl` `curl.h no such file or directory`”（第一个链接）后偶然发现这篇文章的人来说，他们正在`Windows`，并且想要安装`curl`在 中`R`，解决方案非常简单和快速。

*   `Rtools Bash`从菜单`Rtools`中的文件夹启动。`Windows` `all app`
*   输入`pacman -Syuv`命令行以确保您是最新的。
*   `pacman -S mingw-w64-x86_64-curl`解决问题。您现在可以毫无问题地返回`R`并安装。`curl`不再有`curl.h`遗漏的错误。

# http - REST API、HTTP 动词和访问日志

> ID：11471691
> 
> 赞同：1
> 
> 时间：2012-07-13T13:42:48.567
> 
> 标签：http, rest, restful-url, httpverbs

在设计它们时，我一直在尝试遵循良好的 RESTful API 实践。其中一个恰好是非常简单和常见的，但越来越难以理解：

*   使用`GET`http 动词检索资源

为什么？假设您有一个 URI 来获取这样的帐户信息：

*   [http://www.example.com/account/AXY_883772](http://www.example.com/account/AXY_883772)

`AXY_883772`银行系统中的帐户 ID 在哪里。安全审核将发出警告，指出：

1.  帐户 ID 将出现在 HTTP 访问日志中
2.  帐户 ID 可能会缓存在浏览器的历史记录中（即使不太可能定期使用*浏览器*来访问 RESTful API）

他们最终通过“推荐”`POST`应该使用动词来结束。

所以，我的问题是：

我们对于它可以做些什么呢？只需遵循安全建议并避免`GET`大部分时间使用？使用某种特殊的 APACHE/IIS/NGINX 访问日志配置来避免记录对某些 URL 的访问？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T13:46:47.600

如果您的 url 中有敏感信息，并且您正在记录 url，那么您正在记录敏感信息。

所以有两个明显的解决方案：

*   不要记录网址
*   使用不包含敏感信息的其他网址

最后一个可以通过使用您的服务器映射回正常 id 的一些（不同的）id 来实现。

如果这些解决方案都不适合您，那么您不能使用 GET，因此它不是好的 RESTful 设计。

我意识到所有这些事情对你来说可能已经很明显了；但这是我能给出的最准确的答案。

值得一提的是，这不仅适用于 GET，实际上也适用于 PUT、DELETE 和通常的 POST。

# perl - 返回类型的函数重载

> ID：11471694
> 
> 赞同：2
> 
> 时间：2012-07-13T13:43:04.387
> 
> 标签：perl

Perl 是一种支持按返回类型进行函数重载的语言。

一个简单的例子是[wantarray()](http://perldoc.perl.org/functions/wantarray.html)。

CPAN 中很少有很好的模块可以扩展这个 wantarray() 并为许多其他返回类型提供重载。这些模块是[Contextual::Return](http://search.cpan.org/~dconway/Contextual-Return-0.004003/lib/Contextual/Return.pm)和[Want](http://search.cpan.org/~robin/Want-0.21/Want.pm)。不幸的是，我不能使用这些模块，因为这两个模块都无法通过 perl 版本 5.8.9 的 perl 评论家（我无法升级这个 perl 版本）。

所以，我正在考虑编写我自己的模块，例如 Contextual::Return 和 Want，但只需要很少的量。我试图理解 Contextual::Return 和 Want 模块代码，但我不是专家。

我只需要对返回类型 BOOL、OBJREF、LIST、SCALAR 进行函数重载。

请通过提供一些指导来帮助我，我该如何开始。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-13T14:49:00.237

以这种方式使用 Perl 语法的模块`Contextual::Return`几乎`Want`必然会违反`Perl::Critic`. 在这种情况下，主要的违规行为偶尔会禁用`strict`和使用子程序原型，这是最小的。

我个人认为这是一个愚蠢的规则，它坚持所有代码都必须毫无例外地通过任意一组测试，但我也认为任何行为因调用它的上下文而有很大不同的代码都可能设计得很糟糕并且难以理解和维护。很少看到甚至`wantarray`被使用，因为 Perl 通常会做*正确的事情*而无需您解释。

我认为您可能遇到了一个看起来很有趣的模块，并希望以某种方式将其合并到您的代码中。您能否通过展示一个需要您描述的全面上下文检查的子例程示例来改变我的想法？

# android - 谷歌地图只显示灰色网格和标记

> ID：11471695
> 
> 赞同：0
> 
> 时间：2012-07-13T13:43:15.447
> 
> 标签：android, google-maps, google-maps-api-3, android-manifest, android-mapview

在 Eclipse 和上传到 Play 商店时，应用程序只显示灰色网格和我添加的自定义标记，但未显示实际地图。我正在使用我之前的前一个开发人员的密钥，以前的版本似乎可以在 Google Play 上运行，但是当我构建它时，它无法显示地图。谁能帮我这个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T13:47:15.757

发生这种情况的原因只有两个：

1.  您的设备没有互联网连接，或者由于网络上的防火墙等原因无法下载地图图块。
2.  您正在使用与您签署 apk 的证书不匹配的地图库的 API 密钥。请记住，Eclipse 使用调试密钥对 apk 进行签名，并且您使用不同的密钥进行发布。有关这方面的详细信息，请参阅[此](https://developers.google.com/maps/documentation/android/mapkey)文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T13:52:43.943

Google Maps API 密钥已连接到他们的密钥库，您应该向以前的开发人员询问密钥库并使用它导出您的 APK。否则，您按照本文中的步骤[操作](https://stackoverflow.com/questions/7315635/help-needed-to-publish-android-app-in-market)，当您获得 MD5 指纹时，您可以在[此处](https://developers.google.com/android/maps-api-signup)注册以获取新的 Google Maps API 密钥。

# html5-video - 在 HTML5 视频标签上生成随机预览图像

> ID：11471698
> 
> 赞同：7
> 
> 时间：2012-07-13T13:43:17.197
> 
> 标签：html5-video, poster

是否可以捕获使用 HTML5 视频元素加载的视频的快照并将其用作预览图像，直到视频加载或触发播放事件？我知道海报属性，但我希望自己生成缩略图，就像视频中的随机帧一样。类似于 YouTube/Vimeo 所做的事情。

谢谢，

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-13T13:52:22.703

**我认为这**在纯 HTML5 中是不可能的。主要是因为当您在网页中看到“对象”时未加载流，因此客户端无法获得所需的帧。

但是，对您来说最好的选择是**在加载页面之前保存/缓存“随机帧”**，然后将其用作视频的海报。这将允许您减少客户端工作并节省带宽。

检查[THIS](http://www.londatiga.net/it/programming/how-to-get-video-thumbnail-and-duration-using-mplayer-and-php/)，这是我发现的第一件事（如果您使用的是 PHP，并且您想要一种“**快速而肮脏**”的方式来获取框架）

# 更新

显然[这里](https://stackoverflow.com/questions/7323053/dynamically-using-the-first-frame-as-poster-in-html5-video)有一个 popcorn.js 的解决方案，但似乎你不能以你需要的方式来做（我想）。

这是因为由于浏览器安全问题，只能在同一域内执行此操作。

# ios - 如何在 iOS 中更改 Google TTS API 中的语言？

> ID：11471701
> 
> 赞同：2
> 
> 时间：2012-07-13T13:43:42.780
> 
> 标签：ios, text-to-speech

我在 iOS 中使用 Google 文本转语音服务。

我可以使用以下代码使用英语 TTS。

```
NSString *queryTTS = [text stringByReplacingOccurrencesOfString:@" " withString:@"+"];

NSString *linkTTS = [NSString stringWithFormat:@"http://translate.google.com/translate_tts?tl=en&q=%@",queryTTS];

NSData *dataTTS = [NSData dataWithContentsOfURL:[NSURL URLWithString:linkTTS]];

_googlePlayer = [[AVAudioPlayer alloc] initWithData:dataTTS error:nil]; 
[_googlePlayer play]; 
```

所以我将 url 地址更改为语音泰国 TTS，如以下链接。

```
NSString *queryTTS = [text stringByReplacingOccurrencesOfString:@" " withString:@"+"];

NSString *linkTTS = [NSString stringWithFormat:@"http://translate.google.com/translate_tts?tl=th&q=%@",queryTTS];

NSData *dataTTS = [NSData dataWithContentsOfURL:[NSURL URLWithString:linkTTS]];

_googlePlayer = [[AVAudioPlayer alloc] initWithData:dataTTS error:nil]; 
[_googlePlayer play]; 
```

在我将该链接更改为 之后`"th"`，该 google TTS 服务不会说出我的泰语文本。

我的代码错了吗？

或者如果没有，我该如何更改 Google Text To Speech API 中的语言？

谢谢你的阅读。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T14:45:46.817

只是想说一声谢谢。我一直在寻找如何在 iPhone 上使用 API，这很有帮助。另外，我尝试将语言更改为泰语并没有问题。

*** ** 更新 ** ***

抱歉，我无法让它工作。我没有任何泰语文本，所以我只使用了英语，它把这个词拼了出来。我认为这意味着它正在工作。但是，当我用正确的词改成韩文和中文时，我什么也听不见了。然而，英语、法语、德语和意大利语都有效。

我可以通过添加以下内容来解决此问题：

```
NSURL *url = [NSURL URLWithString:[linkTTS stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding]];
NSData *dataTTS = [NSData dataWithContentsOfURL:url]; 
```

我的问题（也可能是你的问题）是 URL 中有国际字符。这导致 [NSURL URLWithString] 返回 nil。

这将在模拟器中工作，并且要完成剩下的工作，请查看此线程：

[iPhone SDK - 谷歌 TTS 和编码](https://stackoverflow.com/questions/5923974/iphone-sdk-google-tts-and-encoding)

基本上，您必须将您的用户代理更改为其他内容，例如“Mozilla/5.0”。

# dojo - 如何使用查询网格\增强网格？

> ID：11471707
> 
> 赞同：0
> 
> 时间：2012-07-13T13:44:01.357
> 
> 标签：dojo, grid, store

我想在道场增强网格（通过 JsonRestStore 连接到数据库）中对信息进行排序。我知道道场网格提供了基于单列进行排序的功能。但是，在我的网格中，一列包含来自数据库表的多个字段（例如，姓、名、电子邮件、年龄）的组合信息。有没有一种简单的方法可以根据数据库表中的单个字段（例如姓氏）对网格或存储中的数据进行排序？

似乎我可以使用“查询”来更改商店的视图（如果我理解正确，网格是商店的视图），但我不明白如何编写查询来做到这一点。谁能给我更多关于使用查询的语法或如何解决这个问题的信息？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T17:14:01.267

It looks like you have to use what is called a comparatorMap for customized grid sorting.

here's one example : [http://www.ibm.com/developerworks/web/library/wa-aj-dojogrid/index.html](http://www.ibm.com/developerworks/web/library/wa-aj-dojogrid/index.html) (look for the section 'Listing 15\. Customize the sort function of Dojo Grid')

inside the comparator map function is where you would convert the strings to numbers and make the numeric comparison.

# html - 鼠标悬停，只把文字加粗，下划线正常

> ID：11471709
> 
> 赞同：5
> 
> 时间：2012-07-13T13:44:12.860
> 
> 标签：html, css

简单的html和css。

代码：

```
 <div class="link_my"> <a href="a.php">my link</a></div> 
```

CSS：

```
.link_my a:hover{

font-weight:bold;
text-decoration:underline;

} 
```

在鼠标悬停时，文本字体与下划线一起变为粗体。但我希望下划线正常（不是粗体）。

怎么做 ？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-13T14:29:42.213

这对你 Istiaque 有用。JS 小提琴链接：http: [//jsfiddle.net/39TtM/](http://jsfiddle.net/39TtM/)

HTML：

```
<a href="#" class="link">
    <span>
        my link
    </span>
</a> 
```

CSS：

```
.link span{
    color:blue;
    font-size:30px;
}

.link:hover span{
    font-weight:bold;
}

.link:hover{
    text-decoration:underline;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-13T13:47:47.683

您可以改用border-bottom

```
.link_my a:hover{

font-weight:bold;
text-decoration:none;
border-bottom:1px solid #ccc;

} 
```

谢谢约翰

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T13:48:20.000

下划线是文本的一部分，它们*不是*不同的元素/部分。

解决此问题的一种方法是使用`border`而不是下划线：

```
.link_my a {
    text-decoration: none;
    border-bottom: 1px solid #000;
}
.link_my a:hover{
    font-weight:bold;
}​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/Ay3EV/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-21T15:15:00.317

如果使用**line-height**（也可能是 display:block ），Aditya 的解决方案可能更可取> else （使用border-bottom 时）下划线将出现在块元素下，而不是根据需要出现在文本下。

# c# - COM 可见 C# 类库中的 ADO.NET 实体框架

> ID：11471711
> 
> 赞同：3
> 
> 时间：2012-07-13T13:44:16.140
> 
> 标签：c#, com, ado.net

我有一个 C# 类库，我已经让 COM 可见，所以我也可以从用 Visual Studio 6 编写的遗留应用程序调用它。这个库中有一个实体框架，用于将记录添加到数据库。通过 COM 调用库可以工作，但记录不会添加到数据库中。我决定调试它的最简单方法是将 C# WinForms 测试应用程序添加到库解决方案中。这就是我注意到实体框架在这里也失败的地方。事实证明，这是因为库中的 app.config 连接字符串也需要成为测试应用程序的一部分。这很好，这样做意味着 WinForms 应用程序可以正常工作，并且记录已添加到数据库中。

但是，对于从旧版应用程序通过 COM 进行的调用，我该如何解决这个问题？显然他们没有 app.config。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T14:36:47.943

您是否尝试将 app.config 放在您的 COM exe 文件附近？如果这不起作用，那么您的库无法使用 app.config 中的默认连接字符串。相反，它应该：

1.  手动从注册表或配置文件中读取它（也许 ConfigurationManager.OpenExeConfiguration 可以做到？或在这里查看[http://geekswithblogs.net/akraus1/archive/2006/01/04/64871.aspx](http://geekswithblogs.net/akraus1/archive/2006/01/04/64871.aspx)一个标题为“如何读/写”的示例关于使用 ExeConfigurationFileMap 的另一个 App.Config 文件）。或者
2.  接受它作为将从您的 COM 应用程序传递的参数。然后，您的 COM 应用程序应该从注册表或某种 ini 文件中获取该连接字符串。

无论哪种方式，您都必须手动将获取的连接字符串提供给实体框架。快速搜索显示有一个 EntityConnection 构造函数接受连接字符串作为参数，也许它会适合你。

# - 文件阅读器

> ID：11471713
> 
> 赞同：0
> 
> 时间：2012-07-13T13:44:19.557
> 
> 标签：

`FileReader` 可以引用 `java.io.FileReader` 类，用于在 Java 文件系统中将文件作为文本读取，也可以引用 JavaScript 中的类似类来访问本地机器上的文件。有关详细信息，请参阅说明。

# javascript - ASP.Net 仅针对 OnSelectedIndexChanged 抑制组合框的回发

> ID：11471714
> 
> 赞同：0
> 
> 时间：2012-07-13T13:44:24.717
> 
> 标签：javascript, asp.net, ajax, combobox, autopostback

我在我的 ASP.Net Web 应用程序中使用 AJAX ComboBox，并且我有一个`OnItemInserted`需要回发才能命中服务器端逻辑的事件，但这需要我有`AutoPostBack = True`. 这会导致触发回发的事件的不良影响，`OnSelectedIndexChanged`从而导致控件失去焦点。

**更多背景：**此组合框位于一个相当复杂的网格视图中，该网格视图包含其他组合框、下拉列表和文本框。我的目标是让用户在输入数据的同时平滑地在行中切换，而无需使用鼠标来促进快速数据输入。

我相信我需要使用 javascript 来抑制这个回发，但我愿意接受建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T14:09:46.980

您可以通过简单地在相关客户端事件上返回 false 来抑制回发：

[http://edgewaters.blogspot.com/2008/01/button-that-doesnt-post-back.html](http://edgewaters.blogspot.com/2008/01/button-that-doesnt-post-back.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T14:16:19.310

OnSelectedIndexChanged="return false"

# cordova - 窗口关闭数据库（）？

> ID：11471716
> 
> 赞同：0
> 
> 时间：2012-07-13T13:44:33.030
> 
> 标签：cordova

在打开数据库时在 phonegap 中编写 window.openDatabase()。是否可以关闭连接，如果可以，是否有必要？

我问这个的原因是因为我每次插入一个值时都会打开数据库。也许我完全误解了它是如何通过phonegap连接到数据库的，但是在.net中我总是在插入一些东西后关闭连接。

感谢您的回答！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T17:34:53.563

只需保存对 window.openDatabase() 返回的数据库的引用。您应该能够在页面上多次使用它。

# c++ - libstdc++.so.6：无法打开共享对象文件：没有这样的文件或目录

> ID：11471722
> 
> 赞同：95
> 
> 时间：2012-07-13T13:44:42.233
> 
> 标签：c++, cilk, cilk-plus

我想用 cilk++ 程序运行 Cilkscreen 命令，但出现此错误

> /usr/local/cilk/bin/../lib32/pinbin：加载共享库时出错：libstdc++.so.6：无法打开共享对象文件：没有这样的文件或目录

你能帮我吗

* * *

## 回答 #1

> 赞同：236
> 
> 时间：2013-07-01T17:40:35.970

尝试这个：

```
apt-get install lib32stdc++6 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-07-13T13:53:31.850

我假设您在 amd64 机器上运行 Linux。您的可执行文件所在的文件夹 ( `lib32`) 表示需要 32 位库的 32 位可执行文件。

这些似乎不存在于您的系统上，因此您需要手动安装它们。软件包名称取决于您的发行版，对于 Debian 是`ia32-libs`，对于 Fedora `libstdc++.<version>.i686`。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-04-19T11:46:39.933

对于 Fedora 使用：

`yum install libstdc++44.i686`

您可以通过运行找出支持哪些版本：

`yum list all | grep libstdc | grep i686`

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2016-03-18T08:52:40.830

对于红帽：

```
sudo yum install libstdc++.i686
sudo yum install libstdc++-devel.i686 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-13T13:48:03.010

/usr/local/cilk/bin/../lib32/pinbin 动态链接到不再存在的库 libstdc++.so.6。你需要重新编译 Cilk

# c# - 根据 Visual Studio 2010 的 jQuery 函数“未定义”

> ID：11471723
> 
> 赞同：0
> 
> 时间：2012-07-13T13:44:47.117
> 
> 标签：c#, javascript, jquery, asp.net, jquery-ui-progressbar

这可能是一个关于 jQuery UI 和 Javascript 的非常简单的问题，但我仍然在摸索这些语法。每当我的 C# (ASP.NET) 程序在不同功能中达到某个点时，我都会尝试更新 jQuery 进度条。我这样做正确吗？我可以在我的页面上看到空的进度条，但我无法让它更新它的进度。

这是我的脚本：

```
 <script type="text/javascript">
  $(document).ready(function() {
    $("#progressbar").progressbar({ value: 0 });
  });

function updateProgress(number) {
        if (number < 100) {
            $("#progressbar").progressbar("value", number);
        }
    }
</script> 
```

以下是我的更多脚本参考：

```
 <link href="Styles/tomcat.css" rel="stylesheet" type="text/css" />
<link rel="stylesheet" href="colorbox.css" />
<script src="Scripts/jquery-1.7.2.js" type="text/javascript"></script>
<script src="Scripts/jquery-ui-1.8.21.custom.js" type="text/javascript"></script>
<script type="text/javascript" src="Scripts/jquery.colorbox.js"></script>
<link href="Content/themes/base/jquery.ui.progressbar.css" rel="stylesheet" type="text/css" />
<link href="Content/themes/base/jquery-ui.css" rel="stylesheet" type="text/css" />
<script src="Scripts/jquery.ui.core.js" type="text/javascript"></script>
<link href="Scripts/jquery-ui-1.8.21.custom.css" rel="stylesheet" type="text/css" />
<script src="Scripts/jquery.ui.progressbar.js" type="text/javascript"></script>
<link href="Scripts/ui.all.css" rel="stylesheet" type="text/css" /> 
```

这里是我尝试通过 C# 函数使用 updateProgress() 函数的地方。我正在尝试将“10%”发送到进度条，但我的调试器出错并说 updateProgress() 未定义。

```
 ScriptManager.RegisterStartupScript(this, this.GetType(), "temp", "<script language='javascript'>UpdateProgress(10);</script>", false); 
```

编辑：我添加了以下布尔值来绕过页面刷新和刷新我的进度条。

```
 var runOnce = new Boolean;
runOnce = false;
$(document).ready(function() {
    if(!runOnce)
    {
        $("#progressbar").progressbar({ value: 0 });
        runOnce = true;
    }
}); 
```

我不认为它在工作。它仍然会在每次页面加载时清除并将其设置回零。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-13T13:48:02.180

javascript 区分大小写。将您的函数声明更改为`UpdateProgress`或将您的注入更改为`updateProgress`.

我也相信你应该`type="text/javascript"`在你的脚本标签中加入 - 语言是一个不推荐使用的属性。相关：[脚本标签中的“lang”和“type”属性有什么区别？](https://stackoverflow.com/questions/112482/what-is-the-difference-between-lang-and-type-attributes-in-a-script-tag)

编辑：处理被覆盖的进度：

```
var progressAlreadySet;

$(document).ready(function() {
    $("#progressbar").progressbar(); // initialize

    if (!progressAlreadySet) {
        $("#progressbar").progressbar("value", 0);
    }
});

var updateProgress = function (number) {
    if (number < 100) {
        progressAlreadySet = true;
        $("#progressbar").progressbar("value", number);
    }
}; 
```

# asp.net-mvc - Encode String To Html Asp.Net MVC

> ID：11471736
> 
> 赞同：3
> 
> 时间：2012-07-13T13:45:15.720
> 
> 标签：asp.net-mvc

> **Possible Duplicate:**
> [ASP.NET MVC Razor render without encoding](https://stackoverflow.com/questions/4071602/asp-net-mvc-razor-render-without-encoding)

One of the proerties of my Product object is returning a string that has html in it. When I set the model to the view, the view reads it as text and not html. How do I let the view know to read the property as html?

```
<td colspan="2">
 <div>
   <label >                             
       @Model.LongDescription  
   </label>                                 
 </div>
</td> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-13T13:49:05.483

Razor encodes everything by default, you just have to use `@Html.Raw` see this [question](https://stackoverflow.com/questions/4071602/asp-net-mvc-razor-render-without-encoding) which is pretty much the same problem you have

```
<td colspan="2">
 <div>
   <label >                             
       Html.Raw(@Model.LongDescription)
   </label>                                 
 </div>
</td> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T13:50:53.930

Use `Html.Raw` helper method to ignore encoding

```
<label >                             
   @Html.Raw(Model.LongDescription)  
</label> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T13:51:00.203

You need to use the HtmlString object. I prefer to handle this in my model by adding a property to the model:

```
public HtmlString LongDescription
{
    get
    {
        return new HtmlString(LongDescription);
    }
} 
```

The object HtmlString will leave the html formatting in place for display.

# login - 使用基于密钥的 SSH 登录授予访客对服务器的访问权限

> ID：11471737
> 
> 赞同：0
> 
> 时间：2012-07-13T13:45:16.010
> 
> 标签：login, ssh

很简单：如何将访客 SSH 访问权限授予将共享相同“访客”登录名的多个用户？

服务器只有 RSA 密钥访问（无密码登录），这适用于将单个用户的公钥复制到远程服务器上的 authorized_keys 的正常情况。我正在寻找的是作为用户“来宾”的来宾访问，问题是密钥 - 我不想安装所有客户的密钥，而是给他们一个使用密钥 - 这会是私人的吗？客人的钥匙？这是如何运作的？

客户端将使用 Putty 从 Linux 和 Windows 进行连接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T14:39:40.017

我在这里没有看到问题。在您的设置中，您将所有连接的人视为一个人。因此他们都可以使用相同的密钥，在这种情况下，您必须将私钥分发给他们所有人。然而，这是一个很大的安全风险。一旦发出该密钥（发生在许多没有经验的用户身上），您必须为所有人更换密钥。这听起来不太好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-10T12:33:20.900

您所要做的就是颠倒程序。

在服务器端创建 RSA 密钥。然后将公钥复制到`authorized_keys`文件中并在客户端获取私钥。

所以现在多个客户端可以使用这个私钥对服务器进行 ssh。

# php - shell_exec() - 执行 php 脚本时出错

> ID：11471739
> 
> 赞同：4
> 
> 时间：2012-07-13T13:45:22.663
> 
> 标签：php, shell-exec

当我尝试使用 执行 PHP 脚本`shell_exec()`时，它不起作用。

在 error_log 文件中，它显示：

> PHP 警告：shell_exec() [function.shell-exec]: 无法执行 'php /home/snabbsam/public_html/.....

**系统**
Centos

**shell_exec 与 clamscan 一起**
`shell_exec()`作用于`clamscan()`clamav 的功能。
但它没有执行 PHP 脚本

**我检查过的事情：**

*   PHP`safe_mode`已关闭
*   `shell_exec()``disable_functions`在 php.ini中不存在
*   [尝试按照https://stackoverflow.com/a/8668666/402089](https://stackoverflow.com/a/8668666/402089)中的建议授予文件和父文件夹的可执行权限

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-13T14:22:52.940

尝试`php`在`shell_exec`调用中添加可执行文件的完整路径，以防万一它位于默认情况下网络服务器用户无法访问的目录中。

# php - MySQL 错误的错误页面

> ID：11471740
> 
> 赞同：2
> 
> 时间：2012-07-13T13:45:23.120
> 
> 标签：php, mysql, html

我想知道是否有任何方法可以使 MySQL 错误更清晰。这不是一个很大的问题，但如果它们确实发生了，我希望它们变得漂亮而整洁。

我确实读过一个教程，遗憾的是没有用，但它们似乎给了我希望。

我希望我的 MySQL 错误（例如“无连接”）显示一个错误页面，如 404 错误页面。

有人知道吗？工作教程？

这是我阅读的教程：http: [//www.jooria.com/Making-Error-Page-When-The-Mysql-Offline-a66.html](http://www.jooria.com/Making-Error-Page-When-The-Mysql-Offline-a66.html)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T13:48:48.633

添加**@**以隐藏输出：

```
<?php
    $host = "localhost";
    $dbuser = "*****";
    $dbpwd = "*****";
    $db = "*****";

    $connect = @mysql_pconnect( $host, $dbuser, $dbpwd );
    if( !$connect ) {
        header( 'Location: /custom-404-page.php' ); die;
    } else {
        $select = @mysql_select_db($db);
    }
?> 
```

像这样的东西应该工作。

```
$result = @mysql_query ($query, $connection );
if ( mysql_error( $connection ) != "" ) {
    header( 'Location: /custom-404-page.php' ); die;
} 
```

或者，如果您已经设置了标题，请替换`header( 'Location: /custom-404-page.php' );`为：

```
echo '<script>window.location.href="custom-404-page.php";</script>'; 
```

!注意：在函数调用前放置一个@ 会抑制所有错误消息。小心使用；您可以认为一切正常，但实际上并非如此！

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-13T13:54:04.630

你可以这样做：

```
$connect = mysql_pconnect($host, $dbuser, $dbpwd);
if(!$connect) {
header('Location: /noconnection.html');
exit();
} 
```

如果您只想简单地做异常

```
$mysqli = new mysqli($address,$username,$password,$database);
if ($mysqli AND $mysqli->connect_error)
throw new Exception("DB Error ($mysqli->connect_errno): $mysqli->connect_error); 
```

# performance - 为什么我的 Trie 查找比标准 F# Map 的查找慢？

> ID：11471746
> 
> 赞同：4
> 
> 时间：2012-07-13T13:45:43.583
> 
> 标签：performance, dictionary, f#, inline, trie

所以，我刚刚从 OCaml 移植了 Trie。不幸的是，它在 tryFind 方面的运行速度比标准 Map 慢。我不明白这一点 - 特里似乎应该更快。F# 的代码库是否以某种特殊方式构建以使它们比用户通常部署的代码更快？

这是代码 -

```
[<RequireQualifiedAccess>]
module Trie

type Node<'k, 'v when 'k : comparison> =
    { TrieMap : Map<'k, Node<'k, 'v>>
      TrieKvp : ('k list * 'v) option }
    member inline x.IsEmpty = x.TrieKvp.IsNone && x.TrieMap.IsEmpty

let inline make map kvp =
    { TrieMap = map
      TrieKvp = kvp }

let inline makeEmpty () : Node<'k, 'v> = make Map.empty None

let inline isEmpty (node : Node<'k, 'v>) = node.IsEmpty

let rec tryFind (key : 'k list) node =
    if key.IsEmpty then
        match node.TrieKvp with
        | Some (_, value) -> Some value
        | None -> None
    else
        let keyHead = key.Head
        let keyTail = key.Tail
        let optSubNode = Map.tryFind keyHead node.TrieMap
        match optSubNode with
        | Some subNode -> tryFind keyTail subNode
        | None -> None

let inline containsKey key node =
    (tryFind key node).IsSome

let rec addInternal (key : 'k list) value node =
    if key.IsEmpty then make node.TrieMap (Some (key, value))
    else
        let keyHead = key.Head
        let keyTail = key.Tail
        let newTrie =
            match Map.tryFind keyHead node.TrieMap with
            | Some subTrie -> subTrie
            | None -> makeEmpty ()
        let newTrie2 = addInternal keyTail value newTrie
        make (Map.add keyHead newTrie2 node.TrieMap) node.TrieKvp

let inline add key value node =
    addInternal key value node

let rec addMany kvps node =
    if Seq.isEmpty kvps then node
    else
        let kvpHead = Seq.head kvps
        let kvpTail = Seq.skip 1 kvps
        let newTrie = add (fst kvpHead) (snd kvpHead) node
        addMany kvpTail newTrie

let inline ofList kvps =
    addMany kvps (makeEmpty ())

let inline ofListBy by kvps =
    let pairs = List.map by kvps
    ofList pairs

let rec foldInternal folder rev node state =
    match node.TrieKvp with
    | Some (_, value) -> folder (Map.fold (fun state key value -> foldInternal folder (key :: rev) value state) state node.TrieMap) (List.rev rev) value
    | None -> Map.fold (fun state key value -> foldInternal folder (key :: rev) value state) state node.TrieMap

let inline fold folder state node =
    foldInternal folder [] node state

let rec map (mapper : 'k list -> 'v -> 'a) (node : Node<'k, 'v>) : Node<'k, 'a> =
    match node.TrieKvp with
    | Some (key, value) -> make (Map.map (fun _ value -> map mapper value) node.TrieMap) (Some (key, mapper key value))
    | None -> make (Map.map (fun _ value -> map mapper value) node.TrieMap) None

let inline toValueList node =
    fold (fun state _ value -> value :: state) [] node

let inline singleton (key, value) =
    add key value (makeEmpty ()) 
```

**这是 Jon Harrop 提供的性能测试，我发现它足以衡量改进 -**

```
let xs = Array.init 1000000 (fun i -> [i])
let timer = System.Diagnostics.Stopwatch.StartNew()
let mutable t = Trie.makeEmpty()
for i=0 to xs.Length-1 do
    t <- Trie.add xs.[i] xs.[i] t
printfn "Trie took %fs to build" timer.Elapsed.TotalSeconds
timer.Restart()
for _ in 1..100 do
    for i=0 to xs.Length-1 do
        ignore(Trie.tryFind xs.[i])
printfn "Trie took %fs to search" timer.Elapsed.TotalSeconds

let timer = System.Diagnostics.Stopwatch.StartNew()
let mutable t = Map.empty
for i=0 to xs.Length-1 do
    t <- Map.add xs.[i] xs.[i] t
printfn "Map took %fs to build" timer.Elapsed.TotalSeconds
timer.Restart()
for _ in 1..100 do
    for i=0 to xs.Length-1 do
        ignore(Map.tryFind xs.[i])
printfn "Map took %fs to search" timer.Elapsed.TotalSeconds 
```

**注意：如果您有更快的查找数据结构，请注意我需要一个持久数据结构。**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-14T10:36:58.883

> 不幸的是，它在 tryFind 方面的运行速度比标准 Map 慢。我不明白这一点 - 特里似乎应该更快。

这里的快速基准表明您的尝试已经比`Map`至少简单的情况更快：

```
do
    let n = 0
    let xs = Array.init 1000000 (fun i -> [i])
    let timer = System.Diagnostics.Stopwatch.StartNew()
    let mutable t = Trie.makeEmpty()
    for i=0 to xs.Length-1 do
        t <- Trie.add xs.[i] xs.[i] t
    printfn "Trie took %fs to build" timer.Elapsed.TotalSeconds
    timer.Restart()
    for _ in 1..100 do
        for i=0 to xs.Length-1 do
            ignore(Trie.tryFind xs.[i])
    printfn "Trie took %fs to search" timer.Elapsed.TotalSeconds

    let timer = System.Diagnostics.Stopwatch.StartNew()
    let mutable t = Map.empty
    for i=0 to xs.Length-1 do
        t <- Map.add xs.[i] xs.[i] t
    printfn "Map took %fs to build" timer.Elapsed.TotalSeconds
    timer.Restart()
    for _ in 1..100 do
        for i=0 to xs.Length-1 do
            ignore(Map.tryFind xs.[i])
    printfn "Map took %fs to search" timer.Elapsed.TotalSeconds 
```

我得到 4s 来构建你的 Trie，8.7s 来构建 a`Map`并且`0.7`在这两种情况下都将进行搜索。

但是，您的实施还有很大的改进空间。我最近写了一篇关于 F# 中优化的通用持久哈希树实现的文章，发表[在此处](http://fsharpnews.blogspot.co.uk/2012/06/hash-tries.html)。

您后来的评论暗示您只想使用它来映射字符串。如果是这样，将您的 trie 专门用于字符串键会更加有效。

**编辑**

KVB 建议我详细说明“改进空间”，所以这里有一些反馈：

*   谨慎使用`inline`作为优化，并且仅在引人注目的性能测量的基础上使用。
*   创建`empty`一个值而不是一个函数。
*   `List.head`尽可能避免`List.tail`。请改用模式匹配。
*   尽可能避免通用性（例如，在这种情况下，字符串键的硬编码）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-15T01:00:04.107

好吧，经过更多思考，我假设性能的真正差异在于使用列表作为键而不是字符串。字符串（和数组）具有更好的缓存一致性。所以，我将键从'k 列表更改为字符串，瞧！性能现在实际上比我的应用程序中的 Map 更好！

这是代码 -

```
[<RequireQualifiedAccess>]
module StringTrie

type Node<'v> =
    { TrieMap : Map<char, Node<'v>>
      TrieKvp : (string * 'v) option }
    member inline x.IsEmpty = x.TrieKvp.IsNone && x.TrieMap.IsEmpty

let inline make map kvp =
    { TrieMap = map
      TrieKvp = kvp }

let inline makeEmpty () : Node<'v> = make Map.empty None

let inline isEmpty (node : Node<'v>) = node.IsEmpty

let rec tryFindInternal (key : string) index node =
    if key.Length = index then
        match node.TrieKvp with
        | Some (_, value) -> Some value
        | None -> None
    else
        let optSubNode = Map.tryFind key.[index] node.TrieMap
        match optSubNode with
        | Some subNode -> tryFindInternal key (index + 1) subNode
        | None -> None

let inline tryFind (key : string) node =
    tryFindInternal key 0 node

let inline containsKey key node =
    (tryFind key node).IsSome

let rec addInternal (key : string) index value node =
    if key.Length = index then make node.TrieMap (Some (key, value))
    else
        let char = key.[index]
        let newTrie =
            match Map.tryFind char node.TrieMap with
            | Some subTrie -> subTrie
            | None -> makeEmpty ()
        let newTrie2 = addInternal key (index + 1) value newTrie
        make (Map.add char newTrie2 node.TrieMap) node.TrieKvp

let inline add key value node =
    addInternal key 0 value node

let rec addMany kvps node =
    if Seq.isEmpty kvps then node
    else
        let kvpHead = Seq.head kvps
        let kvpTail = Seq.skip 1 kvps
        let newTrie = add (fst kvpHead) (snd kvpHead) node
        addMany kvpTail newTrie

let inline ofList kvps =
    addMany kvps (makeEmpty ())

let inline ofListBy by kvps =
    let pairs = List.map by kvps
    ofList pairs

let rec foldInternal folder rev node state =
    match node.TrieKvp with
    | Some (_, value) -> folder (Map.fold (fun state key value -> foldInternal folder (key :: rev) value state) state node.TrieMap) (List.rev rev) value
    | None -> Map.fold (fun state key value -> foldInternal folder (key :: rev) value state) state node.TrieMap

let inline fold folder state node =
    foldInternal folder [] node state

let rec map (mapper : string -> 'v -> 'a) (node : Node<'v>) : Node<'a> =
    match node.TrieKvp with
    | Some (key, value) -> make (Map.map (fun _ value -> map mapper value) node.TrieMap) (Some (key, mapper key value))
    | None -> make (Map.map (fun _ value -> map mapper value) node.TrieMap) None

let inline toValueList node =
    fold (fun state _ value -> value :: state) [] node

let inline singleton (key, value) =
    add key value (makeEmpty ()) 
```

我还构建了一个适用于一般数组并且速度也很快的版本 -

```
[<RequireQualifiedAccess>]
module ArrayTrie

type Node<'k, 'v when 'k : comparison> =
    { TrieMap : Map<'k, Node<'k, 'v>>
      TrieKvp : ('k array * 'v) option }
    member inline x.IsEmpty = x.TrieKvp.IsNone && x.TrieMap.IsEmpty

let inline make map kvp =
    { TrieMap = map
      TrieKvp = kvp }

let inline makeEmpty () : Node<'k, 'v> = make Map.empty None

let inline isEmpty (node : Node<'k, 'v>) = node.IsEmpty

let rec tryFindInternal (key : 'k array) index node =
    if key.Length = index then
        match node.TrieKvp with
        | Some (_, value) -> Some value
        | None -> None
    else
        let optSubNode = Map.tryFind key.[index] node.TrieMap
        match optSubNode with
        | Some subNode -> tryFindInternal key (index + 1) subNode
        | None -> None

let inline tryFind (key : 'k array) node =
    tryFindInternal key 0 node

let inline containsKey key node =
    (tryFind key node).IsSome

let rec addInternal (key : 'k array) index value node =
    if key.Length = index then make node.TrieMap (Some (key, value))
    else
        let char = key.[index]
        let newTrie =
            match Map.tryFind char node.TrieMap with
            | Some subTrie -> subTrie
            | None -> makeEmpty ()
        let newTrie2 = addInternal key (index + 1) value newTrie
        make (Map.add char newTrie2 node.TrieMap) node.TrieKvp

let inline add key value node =
    addInternal key 0 value node

let rec addMany kvps node =
    if Seq.isEmpty kvps then node
    else
        let kvpHead = Seq.head kvps
        let kvpTail = Seq.skip 1 kvps
        let newTrie = add (fst kvpHead) (snd kvpHead) node
        addMany kvpTail newTrie

let inline ofList kvps =
    addMany kvps (makeEmpty ())

let inline ofListBy by kvps =
    let pairs = List.map by kvps
    ofList pairs

let rec foldInternal folder rev node state =
    match node.TrieKvp with
    | Some (_, value) -> folder (Map.fold (fun state key value -> foldInternal folder (key :: rev) value state) state node.TrieMap) (List.rev rev) value
    | None -> Map.fold (fun state key value -> foldInternal folder (key :: rev) value state) state node.TrieMap

let inline fold folder state node =
    foldInternal folder [] node state

let rec map (mapper : 'k array -> 'v -> 'a) (node : Node<'k, 'v>) : Node<'k, 'a> =
    match node.TrieKvp with
    | Some (key, value) -> make (Map.map (fun _ value -> map mapper value) node.TrieMap) (Some (key, mapper key value))
    | None -> make (Map.map (fun _ value -> map mapper value) node.TrieMap) None

let inline toValueList node =
    fold (fun state _ value -> value :: state) [] node

let inline singleton (key, value) =
    add key value (makeEmpty ()) 
```

剩下的唯一看起来会提高性能的事情是获取指向字符串和 inc 的内部指针，而不是一遍又一遍地进行索引。这在 F# 中似乎并不容易，但至少对于 C# 中的数组来说似乎是可能的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-13T14:17:32.220

为什么不呢？OCaml 怎么样，那里更快吗？由于您`Trie`的实施方式是`Map`我希望它`Map`至少比某些输入慢。在某些情况下，它可能仍然可以胜过`Map`，例如当尺寸非常大时。

此外，如果您的主要兴趣是查找性能，为什么不冻结您的 Trie 以使用`Dictionary`-based 节点？

# delphi - 将 unsignedByte 与 base64 编码一起使用

> ID：11471747
> 
> 赞同：0
> 
> 时间：2012-07-13T13:45:43.893
> 
> 标签：delphi, soap

我使用 WSDL 制作了一个 SOAP API，我需要将文件的字节从客户端传输到 API 的服务器。我`unsignedBinary[]`在 WSDL 中使用数组类型来描述要传递的数据。WSDL 描述如下：

```
<complexType name="TByteArray">

<complexContent>

<restriction base="soapenc:Array">

<sequence/>

<attribute ref="soapenc:arrayType" n1:arrayType="xs:unsignedByte[]" xmlns:n1="http://schemas.xmlsoap.org/wsdl/"/>

</restriction>

</complexContent>

</complexType> 
```

我正在尝试以原始字节发送数据，这会出错。现在我正在使用soap API调用发送二进制数据时进行base64编码。如果我使用 PHP 客户端发送数据，它工作正常，但当我使用 Delphi 应用程序发送数据时它不起作用。

您是否认为将二进制数据转换为 base64 会使 Delphi 应用程序不允许发送数据？ `unsignedByes`不允许转移到Base 64？有谁知道这件事的细节？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T06:12:41.363

感谢您的宝贵意见，但我已经解决了这个问题。我删除了以下代码并将二进制文件传输到“type:xs:hexbinary”

`<part name="abData" type="xs:hexBinary"/>`

它就像魔术一样工作。它会自动将二进制文件转换为十六进制，并在服务器上接收时再次自行转换为二进制文件......

谢谢。

# regex - sparql 正则表达式比较两个字符串变量（一个由另一个组成）

> ID：11471748
> 
> 赞同：3
> 
> 时间：2012-07-13T13:45:45.257
> 
> 标签：regex, contains, sparql

我正在尝试比较两个字符串变量以发现一个是否包含在另一个中，特别是一个是否由另一个组成（因此，我想避免检索“信息”包含“格式”。我只对结果感兴趣类似于“information_management”包括“信息”。

我已经尝试过 FILTER CONTAINS() 和 FILTER regex() 的结果相同。如何修改查询，使其包含在术语之前或之后需要有空格的事实？

```
SELECT DISTINCT ?l1 ?l2
WHERE
{
?term1 skos:prefLabel ?l1.
?term2 skos:prefLabel ?l2.
FILTER(contains(?l1,?l2))
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T16:20:21.203

因此，如果我对您的理解正确，您想找到一个术语包含在另一个术语中*但*不等于另一个术语的成对术语？

如果是这样，您可以像这样在子句中添加`!SAMETERM()`调用：`FILTER`

```
SELECT DISTINCT ?l1 ?l2
WHERE
{
  ?term1 skos:prefLabel ?l1.
  ?term2 skos:prefLabel ?l2.
  FILTER(!SAMETERM(?l1, ?l2) && contains(?l1,?l2))
} 
```

**编辑**

重新阅读问题我认为我没有解决整个问题，对于您拥有术语“格式”和“信息”并且不希望它们匹配的问题，您可以执行以下操作：

```
SELECT DISTINCT ?l1 ?l2
WHERE
{
  ?term1 skos:prefLabel ?l1.
  ?term2 skos:prefLabel ?l2.
  FILTER(!SAMETERM(?l1, ?l2)
         && contains(?l1,?l2) 
         && ( STRENDS(STRBEFORE(?l1, ?l2)," ") 
              || STRSTARTS(STRAFTER(?l1, ?l2), " ")
            ))
} 
```

这要求包含术语之前/之后的字符串必须以空格结尾/开头。你可能不得不玩弄这个来获得更接近你的约束的模型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T09:17:55.153

另一种解决方案是动态构建正则表达式模式，例如：

```
FILTER(regex(concat("\\b", ?l1, "\\b"), ?l2)) 
```

我不完全确定 SPARQL/XML Schema 需要 \b，但我认为大多数实现都会有它。

# javascript - JavaScript - 为什么当我向表中添加新列时，它在额外的单元格中显示“未定义”

> ID：11471750
> 
> 赞同：1
> 
> 时间：2012-07-13T13:45:47.757
> 
> 标签：javascript

当我向表中添加额外的 3 列时，我的列表项不会填充它们。相反，它在单元格中显示未定义。如果有人可以的话，我理想情况下需要一个 6x6 表来存放我的列表项。干杯。

```
var listOfWords = ["mat", "cat", "dog", "pit", "pot", "fog", "log", "pan", "can", "man", "pin", "gag", "sat", "pat", "tap", "sap", "tag", "gig", "gap", "nag", "sag", "gas", "pig", "dig", "got", "not", "top", "pop", "god", "mog", "cot", "cop", "cap", "cod", "kid", "kit", "get", "pet", "ten", "net", "pen", "peg", "met", "men", "mum", "run", "mug", "cup", "sun", "mud", "rim", "ram", "rat", "rip", "rag", "rug", "rot", "dad", "sad", "dim", "dip", "did", "mam", "map", "nip", "tin", "tan", "nap", "sit", "tip", "pip", "sip", "had", "him", "his", "hot", "hut", "hop", "hum", "hit", "hat", "has", "hug", "but", "big", "bet", "bad", "bad", "bed", "bud", "beg", "bug", "bun", "bus", "bat", "bit", "fit", "fin", "fun", "fig", "fan", "fat", "lap", "lot", "let", "leg", "lit" ];

var shuffledWords = listOfWords.slice(0, 6);
 shuffledWords.sort(function () {
   return 0.5 - Math.random();
});

var tbl = document.createElement('table');
tbl.className='tablestyle';

 for (var i = 0; i < shuffledWords.length; i++) {
   var word = shuffledWords[i];
   var row = document.createElement('tr');
 //Here is where I add the extra 3 columns
 for (var j = 0; j < word.length + 3; j++){
   var cell = document.createElement('td');

    cell.textContent = word[j];
    // IF FIREFOX USE cell.textContent = word[j]; INSTEAD
    row.appendChild(cell);
  }

  tbl.appendChild(row);    
}

document.body.appendChild(tbl); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T13:49:05.537

如果您尝试每行显示两个单词，您可以这样做：

```
var listOfWords = ["mat", "cat", "dog", "pit", "pot", "fog", "log", "pan", "can", "man", "pin", "gag", "sat", "pat", "tap", "sap", "tag", "gig", "gap", "nag", "sag", "gas", "pig", "dig", "got", "not", "top", "pop", "god", "mog", "cot", "cop", "cap", "cod", "kid", "kit", "get", "pet", "ten", "net", "pen", "peg", "met", "men", "mum", "run", "mug", "cup", "sun", "mud", "rim", "ram", "rat", "rip", "rag", "rug", "rot", "dad", "sad", "dim", "dip", "did", "mam", "map", "nip", "tin", "tan", "nap", "sit", "tip", "pip", "sip", "had", "him", "his", "hot", "hut", "hop", "hum", "hit", "hat", "has", "hug", "but", "big", "bet", "bad", "bad", "bed", "bud", "beg", "bug", "bun", "bus", "bat", "bit", "fit", "fin", "fun", "fig", "fan", "fat", "lap", "lot", "let", "leg", "lit" ];

var shuffledWords = listOfWords.slice(0).sort(function () {
    return 0.5 - Math.random();
}).slice(0, 12);

var tbl = document.createElement('table');
tbl.className='tablestyle';
var wordsPerRow = 2;

for (var i = 0; i < shuffledWords.length; i += wordsPerRow) {
    var row = document.createElement('tr');

    for (var j=i; j < i + wordsPerRow; ++ j) {
        var word = shuffledWords[j];

        for (var k = 0; k < word.length; k++){
            var cell = document.createElement('td');

            cell.textContent = word[k];
            // IF FIREFOX USE cell.textContent = word[j]; INSTEAD
            row.appendChild(cell);
        }
    }
    tbl.appendChild(row);    
}

document.body.appendChild(tbl); 
```

添加了一个演示：http: [//jsfiddle.net/Ks2Nk/](http://jsfiddle.net/Ks2Nk/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T13:59:01.023

不确定您是否尝试随机化 6x6 行中的字母

如果不试试

```
cell.textContent = word[j%3]; 
```

但这只会重复这个词

所以例如垫子

你会有

垫子

# html - html 中的图像映射。当我悬停时，想要显示链接名称？

> ID：11471752
> 
> 赞同：-2
> 
> 时间：2012-07-13T13:45:49.130
> 
> 标签：html

我正在研究图像映射。我在图像中使用了上面的代码，我在图像的不同部分获得了链接，但是当我悬停时，我想获得 alt 名称。我怎样才能做到这一点 ？先感谢您 。

```
<map id="rade_img_map_1342182469821" name="rade_img_map_1342182469821">
    <area shape="CIRCLE" coords="121,198,15" href="http://Portfolio.com" target="_blank" alt="Portfolio" />
</map> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T13:49:20.577

尝试使用标签的`title`属性。`<area>`

例如

```
<area shape="CIRCLE" coords="121,198,15" href="http://Portfolio.com" 
  target="_blank" alt="Portfolio" title="Portfolio" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T13:48:35.680

你有没有尝试添加

```
title="Porfolio" 
```

# javascript - 在 ajax 响应中传递 JavaScript 函数

> ID：11471753
> 
> 赞同：2
> 
> 时间：2012-07-13T13:45:55.090
> 
> 标签：javascript, ajax, json, callback

我正在尝试从 AJAX 提交的表单返回回调。用户提交表单，服务器处理并返回有效响应，即错误消息以及可以执行操作的 JavaScript 函数。我正在使用 Zepto.js 回退到 jQuery，具体取决于浏览器。

我的ajax请求是：

```
$.ajax({
    success: function(data, status, xhr) {
        data.callback();
    },
    url: form.attr('action'),
    data: form.serialize(),
    dataType: 'json'
}); 
```

在服务器上，我想返回类似：

```
// PHP code
?>
{
    return: false,
    error: 'Sorry, we couldn’t find an account with that username or password.',
    callback: function() {
        console.log('this is the callback');
    }
}
<?php
// more PHP code 
```

当返回浏览器回调函数时应该触发。我希望服务器返回回调，以便我可以使用相同的 JavaScript 代码并让它相应地响应服务器响应。

我需要将数据类型更改为脚本吗？但是我认为这只是用于加载 .js 文件，而不是代码块。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T14:57:12.473

这里的一般感觉是我以错误的方式处理这个问题。于是修改了代码：

```
$.ajax({
    success: function(data, status, xhr) {
        var callback = data['callback'];
        callback();
    },
    url: form.attr('action'), // in this example it's badLogin
    data: form.serialize(),
    dataType: 'json'
});
// callback specified in PHP
badLogin: function() {
    console.log('bad login');
} 
```

还有我的 PHP

```
if (!$valid) {
?>
{
    "return": false,
    "error": "Sorry, we couldn’t find an account with that username or password.",
    "callback": "badLogin"
}
<?php
} 
```

感谢您为我指明正确的方向。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T13:50:00.110

`eval()`如果您绝对确定该字符串将始终正确并且无法注入任何代码，则您始终可以将代码作为字符串返回并使用。

# google-plus - Google 分享按钮，是否可以分享来自一个 URL 的内容并链接回另一个？

> ID：11471756
> 
> 赞同：0
> 
> 时间：2012-07-13T13:46:08.133
> 
> 标签：google-plus

示例一个在线学习应用程序，您希望在您的网站的已登录部分后面分享您的结果。因此，您向您的网站添加了一个公共 URL，以便 google 获取内容（img、描述、标题）：data-href="http://www.example.com?result_id=24"。

但是，当有人查看帖子并看到共享内容并单击指向该站点的链接时：

[http://www.example.com?result_id=24](http://www.example.com?result_id=24)

我能想到的唯一方法是在用户登陆共享 URL 后将其重定向到[http://www.example.com 。](http://www.example.com)

有没有官方的方法或更好的方法来做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T02:35:02.880

不，但有一个解决方法。

您共享的 URL 用于片段和用户点击时发送的位置。

但是，您可以将 schema.org 或 OpenGraph 标记放在描述登录墙后面的内容的这些页面上。这将允许您指定标题、描述和缩略图。[您可以在Google Developers](http://developers.google.com/+/plugins/snippet)上阅读有关配置代码段的更多信息。

# magento - getUrl 不起作用，因为它将编号的数组键放在 url 中

> ID：11471758
> 
> 赞同：1
> 
> 时间：2012-07-13T13:46:12.203
> 
> 标签：magento

`<?php $daurl = Mage::getUrl('showdown/index/vote',array('c', 'd')) ?>`

产生这个结果

> [http://desbest.uk.to/clients/magentofull/index.php/showdown/index/vote/0/c/1/d](http://desbest.uk.to/clients/magentofull/index.php/showdown/index/) **_**

但我不希望它成为`vote/0/c/1/d`

相反，我想要`vote/c/d`

请帮忙！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T13:58:41.163

你可以试试这个：

```
<?php $daurl = Mage::getUrl('showdown/index/vote', array('c' => 'd')) ?> 
```

# algorithm - 从小二值图像中去除异常像素

> ID：11471760
> 
> 赞同：3
> 
> 时间：2012-07-13T13:46:20.500
> 
> 标签：algorithm, computer-vision, noise, outliers

我目前正在实施一种算法，用于识别有色质量的最小惯性轴（由二阶矩提供）。为了做到这一点，我需要获得第一时刻给出的质心。

加权平均功能效果很好，但由于异常像素，我收到了不想要的结果。

这里是平均函数：

（例如 x 的加权平均值）

```
for (i = 0, i < rows, i++) {
    for (j = 0, j < cols, j++) {
        if (colorAt(i,j).isForeground()) {
            tempSumX++;
            totalForeground++;
        }
    }
    x_ += i*tempSumX;
    tempSumX = 0;
}
x_ /= totalForeground; //where x_ represents the x coordinate of the weighted center of mass. 
```

![质心不正确](../Images/29a03d1dc2a1ce476e9047d14dbe1318.png)

给定这样的图像，它仅由两种颜色（背景和前景）表示，我如何去除边缘像素？注意：外围像素是指不属于大色块的任何东西。白点是计算的质心，这是不正确的。

非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T14:14:20.070

有很多洪水填充算法可以识别给定起点的所有连接像素。

或者，去除像这些来自噪声的小异常值的常用方法是腐蚀图像，然后将其膨胀以恢复到相同的大小 - 尽管如果你纯粹是在做 CoG，你不一定需要扩张步骤

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T21:31:53.363

我相信你的算法是不正确的。二进制图像中的 m10 （对不起，我不知道如何做下标）是前景像素的 x 坐标的总和，所以你的代码应该是这样的：

```
for (i = 0, i < rows, i++) {
    for (j = 0, j < cols, j++) {
        if (colorAt(i,j).isForeground()) {
            tempSumX += i;
            totalForeground++;
        }
    }
}
x_ = tempSumX/totalForeground; //where x_ represents the x coordinate of the weighted center of mass. 
```

假设这与您之前的文章[Algorithm for Finding Longest Stretch of a Value at any Angle in a 2D Matrix](https://stackoverflow.com/questions/11454254/algorithm-for-finding-longest-stretch-of-a-value-at-any-angle-in-a-2d-matrix)相关，您应该在同一循环中计算其他一阶和二阶矩：

```
m01 += j;
m20 += i*i;
m02 += j*j;
m11 += i*j; 
```

（您的算法中的 tempSumX 只是 m10，totalForeground 是 m00）

试一试，如果您仍然遇到异常值问题，您可以使用 Connected Component Labeling [http://en.wikipedia.org/wiki/Connected_component_labeling](http://en.wikipedia.org/wiki/Connected_component_labeling)来找到最大的质量。`bwlabel`（在 matlab 中使用或可用`bwconncomp`。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T14:39:37.223

怎么样，在伪代码中：

```
for( y = 0; y < rows; y++ )
{    
   for ( x = 0; x < cols; x++ )
   {
       if ( pixel( x, y ).isColor() )
       {
          int sum = 0;
          // forgetting about edge cases for clarity...
          if ( !pixel( x-1, y-1 ).isColor() ) sum++;
          if ( !pixel( x,   y-1 ).isColor() ) sum++;
          if ( !pixel( x+1, y-1 ).isColor() ) sum++;
          if ( !pixel( x-1, y   ).isColor() ) sum++;
          if ( !pixel( x+1, y   ).isColor() ) sum++;
          if ( !pixel( x-1, y+1 ).isColor() ) sum++;
          if ( !pixel( x,   y+1 ).isColor() ) sum++;
          if ( !pixel( x+1, y+1 ).isColor() ) sum++;
          if ( sum >= 7 )
          {
             pixel( x, y ).setBackground();
             x -= 1;
             y -= 1;
          }
       }
   }
} 
```

即移除由 7 个背景像素包围的任何像素。如果您将像素的颜色更改回可能受影响的最早像素。

您对“异常值”的度量可能会发生变化 - 例如，您可以将对角线像素视为价值 1/2 的值。例如，直接在上方、下方、左侧和右侧的像素计为 2。然后使用不同的数字作为总和。

您可以通过增加过滤器的大小来提高准确性——比如增加到 5x5 而不是 3x3。在这种情况下，像素 2 应该算得更少。

# java - 是否可以使用 java 或 python 中的应用程序与 WCF TCP 服务进行通信？

> ID：11471767
> 
> 赞同：2
> 
> 时间：2012-07-13T13:46:43.387
> 
> 标签：java, .net, python, wcf, tcp

我收到一个 WCF 服务进行通信，因此，我需要在 java 或 python 中创建一个客户端来获取该服务提供的信息，该服务是一个 WCF TCP 服务。可能吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-13T14:23:53.000

我假设当您说该服务“是 WCF TCP 服务”时，您的意思是它使用了 netTcpBinding （方案`net.tcp`）。

除了 SOAP 等公共标准之外，此绑定还依赖于一些专有的 Microsoft 协议。它们提供消息帧，支持各种编码方案，以及在消息流上分层安全协议。这类似于 netNamedPipe 绑定，这些协议的更多细节[在我的博客上](http://blogs.charteris.com/blogs/chrisdi/archive/2010/11/04/talking-to-wcf-over-named-pipes-1-the-framing-protocol.aspx)进行了解释。

您的问题的答案是“是的，这是可能的”，但坏消息是，为了这样做，您必须在您选择的客户端平台中实现所有专有的 Microsoft 协议。您几乎肯定会希望避免这样做，因为它需要做很多工作（尽管可能有人已经为 Java 或 Python 编写了一个开源库）。

如果您找不到库，并且能够在您的客户端平台上运行任何风格的 .NET（或者如果在您的客户端和服务之间插入单独的 Windows 机器作为代理是可行的）我会考虑在 .NET 中创建一个适配器，以代理您对服务的访问。这样的东西可以为服务提供一个纯粹的基于标准的接口（例如 WS-*），在内部将调用转发给真正的服务，以使其能够从其他平台使用。

编辑：我以前不知道另一个答案提到并链接到的 Windows HPC 的 Java 互操作库。这似乎很有希望：开源和微软支持，为此目的可能更好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-13T14:05:33.893

net.tcp 绑定是专有的。这是一个在其他上下文中提到它 的[网站。](http://blogs.technet.com/b/windowshpc/archive/2011/12/31/interoping-windows-hpc-soa-from-java-or-other-non-net-environment.aspx)

文章指向一个发布在 Github[互操作库下载链接上的 Java 互操作库](https://github.com/MicrosoftHPC/Java-Interop-Library/tarball/master)

希望这会有所帮助...我也很想知道答案，因为我恰好参与了业务的 Web 服务方面。

# asp.net - updatepanel 中的下拉自动发布永远不会在 SelectedIndexChanged 事件后面输入代码

> ID：11471768
> 
> 赞同：0
> 
> 时间：2012-07-13T13:46:44.457
> 
> 标签：asp.net, drop-down-menu, webforms, updatepanel, partial-postback

这是一个很难解释的场景，所以我编写了一个简单的例子。

```
<asp:UpdatePanel runat="server" ID="upTest" ChildrenAsTriggers="true"
UpdateMode="Conditional">
  <ContentTemplate>
     <asp:DropDownList ID="ddlTest" runat="server" AutoPostBack="true"></asp:DropDownList>
     <br /><br /> 
     In page: <asp:TextBox runat="server" ID="txtTest" Columns="50" Text="OnLoad</asp:TextBox>
     <br />
     <br />
     <asp:Button runat="server" ID="btnTest" Text="Click it" />
  </ContentTemplate>
  <Triggers>
     <asp:AsyncPostBackTrigger ControlID="ddlTest" />
  </Triggers>
 </UpdatePanel> 
```

代码隐藏

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
    If Page.IsPostBack Then
        BindDropDown(Request.Form(ddlTest.UniqueID))
    Else
        BindDropDown(0)
    End If
End Sub

Public Sub BindDropDown(val As Integer)

    ddlTest.Items.Add(New ListItem("", 0))
    ddlTest.Items.Add(New ListItem("One", 1))
    ddlTest.Items.Add(New ListItem("Two", 2))
    ddlTest.Items.Add(New ListItem("Three", 3))
    ddlTest.Items.Add(New ListItem("Four", 4))
    ddlTest.SelectedValue = val

End Sub

Private Sub ddlTest_SelectedIndexChanged(sender As Object, e As System.EventArgs) Handles ddlTest.SelectedIndexChanged
    txtTest.Text = "Dropdown changed"
End Sub

Private Sub btnTest_Click(sender As Object, e As System.EventArgs) Handles btnTest.Click
    txtTest.Text = "Button clicked"
End Sub 
```

另请注意，我为页面设置了 EnableViewState="false" 和 ClientIdMode="Static"。

当我单击按钮时，会发生部分回发，并且文本框的预期值为 'Button Clicked'

当我更改下拉菜单时，会发生部分回发，但是文本框没有“已更改下拉菜单”的预期值，因为 ddlTest_SelectedIndexChanged 中的代码永远不会被命中（该代码行上的断点位置也永远不会命中）

在我项目的更大范围内，这是问题的症结所在，我无法确定为什么这个事件永远不会被命中（核心问题是当我加载动态用户控件时，控件中的数据被正确绑定，但随后在加载用户控件后被 pre-post 数据覆盖 - 覆盖发生在 post back 事件的某处）。在我看来，这与下拉列表的绑定以及它在页面周期中发生的位置有关，但我无法确定任何内容，也无法提出谷歌解决方案。

在查看 Firebug 中的帖子时，我确实注意到了一件奇怪的事情——下拉列表的 EVENTTARGET 值是下拉列表的 UniqueId，但按钮单击的 EVENTTARGET 值为空。我的大脑在想这里有一些联系。

仅供参考 - 我想出了一个似乎可以解决问题的解决方法。我将下拉菜单上的自动回发设置为 false，并使用 jQuery 在下拉菜单上分配更改事件以触发按钮单击 - 这会导致回发并在代码中触发 btn_click 事件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T14:01:08.617

我通过将下拉填充移动到 init 事件然后让 .NET 从视图状态加载所选值来解决了这里的初始问题

但是在这样做时，现在 selectedindex 事件会在每次回发时触发。

# objective-c - 如果它是自定义类，则获取 NSViewController 的视图？

> ID：11471769
> 
> 赞同：5
> 
> 时间：2012-07-13T13:46:44.760
> 
> 标签：objective-c, xcode, cocoa, nsview, nsviewcontroller

我使用以下代码将我的视图从我的控制器中取出：

```
CollectionItemView *myView = [self view]; 
```

这工作得很好，但我得到了警告`Incompatible pointer types initializing CollectionItemView __strong with an expression of type NSView`。我明白为什么我得到这个但是可以忽略它还是应该覆盖视图属性？

夹头

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T13:50:49.377

如果你确定那`[self view]`只是`CollectionItemView`做：

```
CollectionItemView *myView = (CollectionItemView*)[self view]; 
```

或者（更好）你可以使用：

```
id myView = [self view]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T14:07:02.887

没有必要覆盖它。troolee 已经提出了两种可行的解决方案。但是，为了省钱，我宁愿用不同的方式编码。

```
CollectionItemView *myView = nil;
if ([[self view] isKindOfClass:[CollectionItemView class])
  self.view = (CollectionItemView*)[self view]; 
```

当您从上下文中确定对象必须是 CollectionItemView 类型或其任何子类时，没有 isKindOfClass 测试的较短版本是可以的。

# django - Django userena 不可预测地提高了 SiteProfileNotAvailable

> ID：11471774
> 
> 赞同：0
> 
> 时间：2012-07-13T13:47:11.453
> 
> 标签：django, apache

我的项目使用 userena，它在某个地方称为 django.db.models.get_model。它用于获取配置文件模型，该模型放置在profiles.Profile中。它在 INSTALLED_APPS 中，所以它应该返回正常，但有时（似乎不可预测，主要是在 apache 重启后）get_model 对此模型（profiles.Profile）返回 None。并且 userena 引发 SiteProfileNotAvailable 错误。

```
AUTH_PROFILE_MODULE = 'profiles.Profile' 
```

起初我认为 userena 向 get_model 传递了错误的参数，但我仔细检查了这一点，它确实传递了 app_label='profile' 和 model_name='Profile'。

然后我尝试打开 python manage.py shell，导入 get_model 并调用它： `get_model('profile', 'Profile')` 它返回有效的 Profile 模型。我从 shell 中退出，在这样做之后，网站神奇地工作了。但是在 apache 重新启动后，它再次引发了同样的错误。也许这个动作更新了缓存，我不知道。

在我的本地机器上它从未发生过，所以我认为它与 apache 有某种联系。

* * *

更新：问题是 django1.4-alpha 版本。更新到最新版本后，错误消失了。

# jquery - 基本航点使用

> ID：11471781
> 
> 赞同：7
> 
> 时间：2012-07-13T13:47:26.163
> 
> 标签：jquery, jquery-plugins, lazy-loading

我正在尝试使用 jQuery 的[Waypoints](http://imakewebthings.com/jquery-waypoints/)插件来延迟加载网页上的元素。但是我无法让它工作。:(

我做了一个非常基本的例子：http: [//jsfiddle.net/P3XnN/2/](http://jsfiddle.net/P3XnN/2/)

根据 Waypoints 文档，我需要做的就是以下内容。

**JS：**

```
$('#waypoint').waypoint(function() {
   alert('You have scrolled to my waypoint.');
}); 
```

**HTML：**

```
<div style="height: 500px">Scroll down</div>
<div id="waypoint">Waypoint</div> 
```

但这显然不是那么简单。请帮忙。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-13T14:02:08.383

插件文档显示了一个执行以下操作的[`offset`选项](http://imakewebthings.com/jquery-waypoints/#waypoint-options)：

> 确定元素顶部必须离浏览器窗口顶部多远才能触发航点。它可以是一个数字，以像素数为单位，可以是一个表示视口高度百分比的字符串，也可以是一个返回像素数的函数。

您可以将选项`waypoint`作为第二个参数传递给方法：

```
$('#waypoint').waypoint(function() {
    alert('You have scrolled to my waypoint.');
}, {
    offset: '100%'
}); 
```

这是一个[更新小提琴](http://jsfiddle.net/jamesallardice/P3XnN/5/)。

# excel - 处理 Select Case 内的动态命名范围

> ID：11471782
> 
> 赞同：0
> 
> 时间：2012-07-13T13:47:33.247
> 
> 标签：excel, excel-2010, vba

我正在构建一个页面，其中 Col H 应该是一个依赖于 Col A 的下拉框。

Col A 已经设置为使用在名为 Data 的隐藏工作表上指定的动态命名范围的验证列表。

此外，在数据表上，我指定了 3 个依赖于 Col A 的列表，并且已经将它们设为动态命名范围。

到目前为止，在 VB 代码中，我有

1.  从 Col A 中的选择中取出逗号之前的第一个单词，并将其用作我的“组”标识符。

2.  将输入到 Col B 的所有文本大写（不相关）。

现在，我需要在 Col H 中指定尽可能选择的内容。您可以在“桌面”的情况下看到我尝试这样做，但是它不起作用并给我一个“需要对象”错误。

旧代码：

```
Private Sub Worksheet_Change(ByVal Target As Range)
    On Error GoTo Whoa

    Application.EnableEvents = False

    If Not Intersect(Target, Columns(1)) Is Nothing Then
        If Target.Value <> "" And InStr(1, Target.Value, ",") Then
            Select Case Split(Target.Value, ",")(0)
               Case "Desktop": Range("H" & Target.row).Value = 
                    Data.Range("List_Desktops").Address
               Case "Laptop":  Range("H" & Target.row).Value = "Laptop"
               Case "Server":  Range("H" & Target.row).Value = "Server"
               Case Else:      Range("H" & Target.row).Value = "N/A"
            End Select
        End If
    ElseIf Not Intersect(Target, Columns(2)) Is Nothing Then
        If Not Target.HasFormula Then Target.Value = UCase(Target.Value)
    End If

LetsContinue:
    Application.EnableEvents = True
    Exit Sub
Whoa:
    MsgBox Err.Description
    Resume LetsContinue
End Sub 
```

新代码：

```
Private Sub Worksheet_Change(ByVal Target As Range)
    Dim i As Long, LastRow As Long, n As Long
    Dim MyCol As Collection
    Dim SearchString As String, TempList As String

    On Error GoTo Whoa

    Application.EnableEvents = False

     '~~> Find LastRow in List_Descriptions
    LastRow = Sheet2.Range("A" & Rows.Count).End(xlUp).row

    If Not Intersect(Target, Columns(1)) Is Nothing Then
        Set MyCol = New Collection

         '~~> Get the data from List_Descriptions into a collection
        For i = 1 To LastRow
            If Len(Trim(Sheet2.Range("A" & i).Value)) <> 0 Then
                On Error Resume Next
                MyCol.Add CStr(Sheet2.Range("A" & i).Value), CStr(Sheet2.Range("A" & i).Value)
                On Error GoTo 0
            End If
        Next i

        '~~> Create a list for the DV List
        For n = 1 To MyCol.Count
            TempList = TempList & "," & MyCol(n)
        Next

        TempList = Mid(TempList, 2)

        Range("A" & Target.row).ClearContents: Range("A" & Target.row).Validation.Delete

        '~~> Create the DV List
        If Len(Trim(TempList)) <> 0 Then
            With Range("A" & Target.row).Validation
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:=TempList
                .IgnoreBlank = True
                .InCellDropdown = True
                .InputTitle = ""
                .ErrorTitle = ""
                .InputMessage = ""
                .ErrorMessage = ""
                .ShowInput = True
                .ShowError = True
            End With
        End If
    '~~> Capturing change in cell D1
    ElseIf Not Intersect(Target, Range("A" & Target.row)) Is Nothing Then
        SearchString = Range("A" & Target.row).Value

        TempList = FindRange(Sheet2.Range("A1:A" & LastRow), SearchString)

        Range("H" & Target.row).ClearContents: Range("H" & Target.row).Validation.Delete

        If Len(Trim(TempList)) <> 0 Then
            '~~> Create the DV List
            With Range("H" & Target.row).Validation
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:=TempList
                .IgnoreBlank = True
                .InCellDropdown = True
                .InputTitle = ""
                .ErrorTitle = ""
                .InputMessage = ""
                .ErrorMessage = ""
                .ShowInput = True
                .ShowError = True
            End With
        End If
    End If

    If Target.Value <> "" And InStr(1, Target.Value, ",") Then
        Select Case Split(Target.Value, ",")(0)
            Case "Desktop": Range("H" & Target.row).Value = "Desktop"
            Case "Laptop":  Range("H" & Target.row).Value = "Laptop"
            Case "Server":  Range("H" & Target.row).Value = "Server"
            Case Else:      Range("H" & Target.row).Value = "N/A"
        End Select
    End If
    ElseIf Not Intersect(Target, Columns(2)) Is Nothing Then
        If Not Target.HasFormula Then Target.Value = UCase(Target.Value)
    End If

LetsContinue:
    Application.EnableEvents = True
    Exit Sub
Whoa:
    MsgBox Err.Description
    Resume LetsContinue
End Sub

'~~> Function required to find the list from Col B
Function FindRange(FirstRange As Range, StrSearch As String) As String
    Dim aCell As Range, bCell As Range, oRange As Range
    Dim ExitLoop As Boolean
    Dim strTemp As String

    Set aCell = FirstRange.Find(what:=StrSearch, LookIn:=xlValues, _
    lookat:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _
    MatchCase:=False, SearchFormat:=False)

    ExitLoop = False

    If Not aCell Is Nothing Then
        Set bCell = aCell
        strTemp = strTemp & "," & aCell.Offset(, 1).Value
        Do While ExitLoop = False
            Set aCell = FirstRange.FindNext(After:=aCell)

            If Not aCell Is Nothing Then
                If aCell.Address = bCell.Address Then Exit Do
                strTemp = strTemp & "," & aCell.Offset(, 1).Value
            Else
                ExitLoop = True
            End If
        Loop
        FindRange = Mid(strTemp, 2)
    End If
End Function 
```

样本工作簿：[https ://docs.google.com/open?id=0B9ss2136xoWIVGxQYUJJX2xXc00](https://docs.google.com/open?id=0B9ss2136xoWIVGxQYUJJX2xXc00)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T18:02:03.737

好吧，我想通了。非常感谢 Siddharth Rout 在这方面的帮助！对于那些将来可能想查看代码的人，这里是：

```
Private Sub Worksheet_Change(ByVal Target As Range)
    Dim i As Long, LastRow As Long, n As Long
    Dim MyCol As Collection
    Dim SearchString As String, TempList As String

    On Error GoTo Whoa

    Application.EnableEvents = False

If Not Intersect(Target, Columns(1)) Is Nothing Then
 If Not Intersect(Target, Range("A" & Target.row)) Is Nothing Then
    Range("H" & Target.row).ClearContents: Range("H" & Target.row).Validation.Delete

    If Target.Value <> "" And InStr(1, Target.Value, ",") Then
        Select Case Split(Target.Value, ",")(0)
            Case "Desktop"
                With Range("H" & Target.row).Validation
                    .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:=xlBetween, Formula1:="=List_DesktopConfigs"
                    .IgnoreBlank = True
                    .InCellDropdown = True
                    .InputTitle = ""
                    .ErrorTitle = ""
                    .InputMessage = ""
                    .ErrorMessage = ""
                    .ShowInput = True
                    .ShowError = True
                End With
           Case "Laptop"
                With Range("H" & Target.row).Validation
                    .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:=xlBetween, Formula1:="=List_LaptopConfigs"
                    .IgnoreBlank = True
                    .InCellDropdown = True
                    .InputTitle = ""
                    .ErrorTitle = ""
                    .InputMessage = ""
                    .ErrorMessage = ""
                    .ShowInput = True
                    .ShowError = True
                End With
            Case "Server"
                With Range("H" & Target.row).Validation
                    .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:=xlBetween, Formula1:="=List_ServerConfigs"
                    .IgnoreBlank = True
                    .InCellDropdown = True
                    .InputTitle = ""
                    .ErrorTitle = ""
                    .InputMessage = ""
                    .ErrorMessage = ""
                    .ShowInput = True
                    .ShowError = True
                End With
            Case Else
                Range("H" & Target.row).Value = "N/A"
        End Select
    ElseIf Not Intersect(Target, Columns(2)) Is Nothing Then
        If Not Target.HasFormula Then Target.Value = UCase(Target.Value)
    End If
End If
End If

LetsContinue:
    Application.EnableEvents = True
    Exit Sub
Whoa:
    MsgBox Err.Description
    Resume LetsContinue
End Sub

Function FindRange(FirstRange As Range, StrSearch As String) As String
    Dim aCell As Range, bCell As Range, oRange As Range
    Dim ExitLoop As Boolean
    Dim strTemp As String

    Set aCell = FirstRange.Find(what:=StrSearch, LookIn:=xlValues, _
    lookat:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _
    MatchCase:=False, SearchFormat:=False)

    ExitLoop = False

    If Not aCell Is Nothing Then
        Set bCell = aCell
        strTemp = strTemp & "," & aCell.Offset(, 1).Value
        Do While ExitLoop = False
            Set aCell = FirstRange.FindNext(After:=aCell)

            If Not aCell Is Nothing Then
                If aCell.Address = bCell.Address Then Exit Do
                strTemp = strTemp & "," & aCell.Offset(, 1).Value
            Else
                ExitLoop = True
            End If
        Loop
        FindRange = Mid(strTemp, 2)
    End If
End Function 
```

# c - C 编程。使用 execl 和 pthread

> ID：11471797
> 
> 赞同：0
> 
> 时间：2012-07-13T13:48:05.100
> 
> 标签：c, pthreads

我在结合使用 execl() 和 pthread 时遇到问题。

我的想法很简单：编写一个守护进程，它在某些情况下启动一个外部进程（相对于守护进程本身而言是一个单独的可执行文件）并等待该进程的返回值。此外，我希望有可能同时启动同一进程的多个实例。

我处理多个线程的代码部分：

```
...
for (c_thread=0,i=0;i<N;i++)
        {
        /* Start actions before start threads */
        for (j=c_thread;j<c_thread+config.max_threads;j++)
                         Before_Process(act[act_index[j]].measID);

       /* Now create threads */
        for (c=0,j=c_thread;j<c_thread+config.max_threads;j++)
                {
                        Print_Log(LOG_DEBUG,"Create tread n. %d, measurementID=%s",c,act[act_index[j]].measID);
                        if ((ret=pthread_create(&pth[c],NULL,Start_Process_Thread,(void *) &act[act_index[j]].measID)))
                                {
                                        Print_Log(LOG_ERR,"Error in creating thread (errorcode: %d)",ret);
                                        exit(EXIT_FAILURE);
                                }
                c++;
                }
        /* Joint threads */
        for (j=0;j<config.max_threads;j++)
                {
                        if ((ret=pthread_join(pth[j], (void**) &r_value[j])))
                        {
                                Print_Log(LOG_ERR,"Error in joint thread (errorcode: %d)",ret);
                                exit(EXIT_FAILURE);
                        }
                }
       /* Perform actions after the thread */
        for (j=0;j<config.max_threads;j++)
                {
                        status=*(int*) r_value[j];
                        Print_Log(LOG_DEBUG,"Joint tread n. %d. Return value=%d",j,status);
                       After_Process(act[act_index[c_thread+j]].measID,status);

                }

        c_thread += config.max_threads;
        }
... 
```

以及函数 Start_Process_Thread：

```
void *Start_Process_Thread(void *arg)
{

int *ret;
char *measID;
measID=(char*)arg;

if (!(ret=malloc(sizeof(int))))
        {
        Print_Log(LOG_ERR, "allocation memory failed, code=%d (%s)",
                              errno, strerror(errno) );
                      exit(EXIT_FAILURE);
        }

*ret=Start_Process(measID);
pthread_exit(ret);
}

int Start_Process(char *measID)
{
...
  pipe(pfd);
  pid=fork();
  if (!pid)
    {
      signal(SIGALRM,Timeout);
      alarm(config.timeout_process);
      flag=0;
      /*
         Start the Process.
      */
          ret=execl(config.pre_processor,buff_list[TokCount-1],config.db_name,measID,(char *) 0);
      if (ret==-1)
        {
          alarm(0);
          flag=1;
          Print_Log(LOG_ERR,"Cannot run script %s, code=%d (%s)",config.process, errno, strerror(errno));
        }
      alarm(0);
      close(1);
      close(pfd[0]);
      dup2(pfd[1],1);
      write(1,&flag,sizeof(int));
    }
  else
    {
      wait(&status);
      close(pfd[1]);
      read(pfd[0],&flag,sizeof(int));
      close(pfd[0]);
      if (!flag)
        {
          if (WIFEXITED(status))
            {
              if (!(return_value=WEXITSTATUS(status)))
                {
                  /*
                     Process gives no errors.
                  */
                  Print_Log(LOG_INFO, "Processing of measurementID=%s ended succesfully!",measID);
                }
              else
                {
                  /*
                     Process gives errors.
                  */
                  Print_Log(LOG_WARNING,"Processor failed for measurementID=%s, code=%d",measID, return_value);
                }
            }
          else
            {
              /*
                 Timeout for Process
              */
              Print_Log( LOG_WARNING,"Timeout occurred in  processing measurementID=%s",measID);
              return_value=255;
            }

        }
    }
} 
```

从技术角度来看，上面的代码工作正常，但我在处理被调用外部进程的不同实例的返回值时遇到了问题。特别是，与某个实例相关联的返回值随机归属于另一个实例。例如，假设分别使用参数 meas1、meas2、meas3 和 meas4 调用了 4 个不同的外部进程实例，并假设 meas1、meas2 和 meas3 被成功处理，而对于 meas4，进程失败。在这种情况下，我的代码混合了返回值，即 meas1、meas3 和 meas4 成功，meas2 失败或 meas1、meas2、meas4 成功和 meas3 失败。

关于为什么会发生这种情况的任何想法？

任何帮助都非常受欢迎。

预先感谢您的关注。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T14:18:57.307

当进程中的任何线程执行`wait()`时，它会获取有关该进程的任何死子的信息——不一定是关于由正在等待的线程启动的最后一个子进程的信息。

您将需要考虑：

1.  捕获已死进程的 PID（它由 返回`wait()`，但您忽略它）。
2.  `wait()`有一个指定为“尸体处置者”的线程（一个除了记录和报告子进程家族中的死亡之外什么都不做的线程）。
3.  一种数据结构，允许启动进程的线程记录他们对子进程死亡时的状态感兴趣。据推测，一旦孩子启动，孩子应该在合适的条件下等待，这样它就不会消耗 CPU 时间而无用。
4.  “尸体处置者”线程在收集尸体时处理适当的其他线程的通知。
5.  担心进程超时，并杀死狂奔时间过长的孩子。

有时这是一个病态的业务...

# java - Java：摆动工作线程同步

> ID：11471801
> 
> 赞同：0
> 
> 时间：2012-07-13T13:48:25.880
> 
> 标签：java, multithreading, synchronization, swingworker

在我的应用程序中，我有一个文本字段和一个按钮。在文本字段失去焦点后，第一个摇摆工人（假设它是 sw1）被调用。这会打开一个弹出窗口来填充要放入文本字​​段的值。在用户单击按钮后调用第二个摇摆工人（假设它为 sw2）。现在的问题是，如果我在文本字段中写入内容然后单击按钮，则首先启动 sw1 以计算要放入文本字​​段的值，同时也启动 sw2。sw2 首先完成，然后 sw1 填充结果。我想要的是 sw2 应该等待 sw1 完成。一旦 sw1 完成其任务，它将通知 sw2。我通过互联网和 stackoverflow 引用了很多参考资料。[这](https://stackoverflow.com/questions/915873/scheduling-swingworker-threads)是几乎符合我要求的一个。我试图在启动 sw1 的类中创建一个静态最终对象：

```
public final static Object lockObject = new Object(); 
```

然后在 sw1 的 done() 方法中，我编写了如下代码：

```
synchronized(lockObject) {
        sw1.notifyAll();
} 
```

在第二类的 doInBackground() 方法的第一行，我编写了如下代码：

```
synchronized(FirstClass.lockObject) {
    try {
        sw2.wait();
    } catch (InterruptedException e) {
        e.printStackTrace();
    }
} 
```

但是我在 java.lang.Object.notifyAll(Native Method) 处得到了 java.lang.IllegalMonitorStateException。谁能告诉我问题是什么以及如何使它按我想要的方式工作。

更新：根据欧内斯特的解决方案，我修改了我的代码，现在看起来像：

```
 FirstClass.java

    public final static Object lockObject = new Object();

    public static boolean flag = false;

    someMethod() {
        synchronized(lockObject){
            sw1.doInbackground() {
            ......
            }

            sw1.done() {
            .....
            flag = true;
            lockObject.notifyAll();
            }

        }
    }

    SecondClass.java

    anotherMethod() {
        sw2.doInbackground() {
            try {
                while (!FirstClass.flag) {
                    FirstClass.lockObject.wait();
                }
                FirstClass.flag = false;
            } catch (InterruptedException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            ......
        }

    } 
```

但是我仍然在 lockObject.notifyAll() 行上收到 java.lang.IllegalMonitorStateException 。你能告诉我这样做是否正确吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T15:40:04.413

您的代码应该看起来像这样。

```
FirstClass.java

public final static Object lockObject = new Object();

public static boolean flag = false;

someMethod() {
    sw1.doInbackground() {
    ......
    }

    sw1.done() {
    .....
    }

    synchronized(lockObject){
        flag = true;
        lockObject.notifyAll();
    }
}

SecondClass.java

anotherMethod() {
    sw2.doInbackground() {
        try {
            synchronized(lockObject){
                while (!FirstClass.flag) {
                    FirstClass.lockObject.wait();
                }
                FirstClass.flag = false;
            }
        } catch (InterruptedException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        ......
    }

} 
```

但。如果您有多个 FirstClass.java 和 SecondClass.java 实例，则在全局静态对象上进行同步会给您带来麻烦。你真的应该找到一种方法来传递对象实例。

如果我正确理解了您的用例，您不能在用户开始编辑字段时简单地禁用 sw2 的按钮，并在第一个工作人员完成时重新启用它吗？这对用户来说也会更清楚。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-13T15:40:28.243

您无需重新发明这样一个简单的同步工具。例如，您可以使用[CountDownLatch](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/CountDownLatch.html)。Sw1 倒计时和 sw2 - 等待。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-13T13:52:11.727

您只能在您持有其监视器的对象上调用`wait()`和`notify()`。在您的每个代码片段中，您锁定了一个对象，但在另一个对象上调用这些方法。它只是不那样工作。恐怕我不能完全弄清楚你想要做什么，所以很难给你具体的更正，但基本上，这些块需要看起来像

```
synchronized(sw2) {
    try {
        sw2.wait();
    } catch (InterruptedException e) {
        e.printStackTrace();
    }
} 
```

假设有两个线程，T1 和 T2，并且有一些对象 O1。然后，如果线程 T1 上运行的代码想要等到线程 T2 中的代码说可以继续，它必须在 object 上同步`O1`，然后调用`O1.wait()`. 当在 T2 上运行的代码想要将该消息发送到 T1 时，它必须同步`O1`并调用`O1.notify()`（或`O1.notifyAll()`）。您使用什么对象无关紧要`O1`，但两个线程中的代码必须同意使用同一个对象。

# iphone - TableView 的屏幕截图不仅适用于可见单元格，而且适用于所有可用单元格

> ID：11471804
> 
> 赞同：1
> 
> 时间：2012-07-13T13:48:35.760
> 
> 标签：iphone

我想为所有单元格的数量截取我的表格视图，而不仅仅是可见单元格。行数是动态的。

如果有 30 行，那么我想要一个屏幕截图中的所有 30 行。我尝试使用 tableview 的总高度作为

```
self.tblView.contentSize.height 
```

使用此代码，我可以获取所有单元格的屏幕，但除了可见单元格之外，屏幕的所有其他部分都是空白的。

我正在使用下面的代码来截屏

```
- (UIImage *)captureView:(UIView *)view 
{
CGRect screenRect = [[UIScreen mainScreen] bounds];
screenRect.size.height=self.tblView.contentSize.height;

UIGraphicsBeginImageContext(screenRect.size);

CGContextRef ctx = UIGraphicsGetCurrentContext();
[[UIColor blackColor] set];
CGContextFillRect(ctx, screenRect);

[view.layer renderInContext:ctx];

UIImage *newImage = UIGraphicsGetImageFromCurrentImageContext();

UIGraphicsEndImageContext();

return newImage;
} 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T13:53:06.480

“屏幕截图”是屏幕截图。除了显示的内容之外，您无法捕获任何内容。除了进行多次捕获之外，我没有看到任何解决方案，每次以编程方式将 tableview 滚动一个表格高度，然后合并图像。

# zend-framework - Doctrine 2 存储库中的 Zend Framework 自动加载器

> ID：11471816
> 
> 赞同：2
> 
> 时间：2012-07-13T13:49:08.503
> 
> 标签：zend-framework, doctrine-orm

我在我的项目中使用 Zend Framework 和 Doctrine 2。一切正常，除了自动加载器不从 Doctrine 存储库加载 Zend 类。

这是 Zend 自动加载器的引导部分：

```
/**
 * Register namespace Default_
 * @return Zend_Application_Module_Autoloader
 */
protected function _initAutoload() {
    $autoloader = new Zend_Application_Module_Autoloader(array(
        'namespace' => 'Default_',
        'basePath'  => dirname(__FILE__),
    ));
    return $autoloader;
} 
```

这是我的 Doctrine 初始化引导部分：

```
/**
 * Initialize Doctrine
 * @return Doctrine_Manager
 */
public function _initDoctrine() {
    // include and register Doctrine's class loader
    require_once('Doctrine/Common/ClassLoader.php');
    $classLoader = new \Doctrine\Common\ClassLoader(
        'Doctrine', 
        APPLICATION_PATH . '/../library/'
    );
    $classLoader->register();

    $classLoader = new \Doctrine\Common\ClassLoader(
        'Repositories',
        APPLICATION_PATH . '/../library/Model'
    );
    $classLoader->register();

    // create the Doctrine configuration
    $config = new \Doctrine\ORM\Configuration();

    // setting the cache ( to ArrayCache. Take a look at
    // the Doctrine manual for different options ! )
    $cache = new \Doctrine\Common\Cache\ApcCache;
    $config->setMetadataCacheImpl($cache);
    $config->setQueryCacheImpl($cache);

    // choosing the driver for our database schema
    // we'll use annotations
    $driver = $config->newDefaultAnnotationDriver(
        APPLICATION_PATH . '/../library/Model'
    );
    $config->setMetadataDriverImpl($driver);

    // set the proxy dir and set some options
    $config->setProxyDir(APPLICATION_PATH . '/../library/Model/Proxies');
    $config->setAutoGenerateProxyClasses(true);
    $config->setProxyNamespace('Model\Proxies');

    // now create the entity manager and use the connection
    // settings we defined in our application.ini
    $connectionSettings = $this->getOption('doctrine');
    $conn = array(
        'driver'    => $connectionSettings['conn']['driv'],
        'user'      => $connectionSettings['conn']['user'],
        'password'  => $connectionSettings['conn']['pass'],
        'dbname'    => $connectionSettings['conn']['dbname'],
        'host'      => $connectionSettings['conn']['host']
    );
    $entityManager = \Doctrine\ORM\EntityManager::create($conn, $config);

    // push the entity manager into our registry for later use
    $registry = Zend_Registry::getInstance();
    $registry->entitymanager = $entityManager;

    return $entityManager;
} 
```

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T16:51:04.080

您的 _initAutoload 完全没有必要。只需添加

```
autoloadernamespaces[]  = Default
autoloadernamespaces[]  = Doctrine 
```

到您的 application.ini

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T18:48:08.093

我同意 _initAutoload() 不应该是必要的，但我怀疑你会在 application.ini 中需要它：

```
autoloaderNamespaces[] = "Doctrine"
autoloaderNamespaces[] = "Model" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T16:07:11.747

如果你刚刚开始你的项目，我会建议使用 zf2（beta5 最后一个 beta 跟随：http://framework.zend.com/zf2/blog/entry/Zend-Framework-2-0-0beta5-Released [）](http://framework.zend.com/zf2/blog/entry/Zend-Framework-2-0-0beta5-Released)这
是教程我用于我的项目 zf2 + 学说 2
[http://www.jasongrimes.org/2012/01/using-doctrine-2-in-zend-framework-2/](http://www.jasongrimes.org/2012/01/using-doctrine-2-in-zend-framework-2/)

# ios - 过滤数组问题

> ID：11471819
> 
> 赞同：0
> 
> 时间：2012-07-13T13:49:15.370
> 
> 标签：ios, sorting, nsarray, nspredicate

我正在尝试通过名为“名称”的属性的第一个字母过滤一组海关对象。为了实现这一点，我制作了一个首字母数组：

```
_lettersArray = [NSArray arrayWithObjects:@"A", @"B", @"C", @"D", @"E", @"F", @"G", @"H", @"I", @"J", @"K", @"L", @"M", @"N", @"O", @"P", @"Q", @"R", @"S", @"T", @"U", @"V", @"W", @"X", @"Y", @"Z", nil]; 
```

我想将结果保存在一个 NSDictionary 中，其中键是第一个字母，对象是一个对象数组，属性名称的第一个字母是键：

```
 for (NSString* letter in _lettersArray) {
    NSPredicate* letterPredicate = [NSPredicate predicateWithFormat:@"name beginswith[c] '%@'", letter];
    NSArray* itemsLetter = [_items filteredArrayUsingPredicate:letterPredicate];

    [_letters setObject:itemsLetter forKey:letter];
} 
```

但是当这个算法结束时 _letters 字典有所有的键，但对象是空数组。我试图改变

```
NSPredicate* letterPredicate = [NSPredicate predicateWithFormat:@"name beginswith[c] '%@'", letter]; 
```

为了

```
NSPredicate* letterPredicate = [NSPredicate predicateWithFormat:@"name beginswith[c] 'B'"]; 
```

一切正常（当然它只给了我以 B 开头的对象）。我做错了什么？对我来说，很明显问题出在谓词指令中。我已经看到 _lettersArray 很好，而且我尝试使用`[letter characterAtIndex:0]`而不是字母，但给了我相同的结果......

谓词句子的 NSLog 为我提供了我手动执行的准确句子结构！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T14:05:01.530

从[谓词编程指南](https://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/Predicates/Articles/pSyntax.html#//apple_ref/doc/uid/TP40001795-SW1)：

> 单引号或双引号变量（或替换变量字符串）会导致 %@、%K 或 $variable 被解释为格式字符串中的文字，从而防止任何替换。

所以试着去掉'%@'的引号：

```
NSPredicate* letterPredicate = [NSPredicate predicateWithFormat:@"name beginswith[c] %@", letter]; 
```

# file - 如何从 HttpInputStream 中删除请求标头

> ID：11471822
> 
> 赞同：2
> 
> 时间：2012-07-13T13:49:25.583
> 
> 标签：file, servlets, httprequest, fileinputstream

我需要有关 servlet 的帮助。

我需要在一个请求中读取一个 inputStream 并编写一个 tiff 文件。inputStream 带有请求标头，我不知道如何删除这些字节并只写入文件。

查看 writen 文件中的初始字节。

```
-qF3PFkB8oQ-OnPe9HVzkqFtLeOnz7S5Be
Content-Disposition: form-data; name=""; filename=""
Content-Type: application/octet-stream; charset=ISO-8859-1
Content-Transfer-Encoding: binary 
```

我想删除它并只从 tiff 文件中写入字节。PS：文件的发件人不是我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T14:26:10.333

我不确定您为什么不使用 HttpServletRequest 的 getInputStream() 方法来获取没有标头的内容，无论哪种方式，您都可以选择开始读取输入流并忽略内容，直到找到两个连续的 CRLF，它定义了标题的结尾。

一种方法是这样的：

```
String headers = new java.util.Scanner(inputStream).next("\\r\\n\\r\\n");
// Read rset of input stream 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-14T11:30:44.330

Apache commons 解决了你 90% 的问题......只需要知道在搜索中使用什么关键字 :)
“解析多部分请求”和谷歌说： [http://www.oreillynet.com/onjava/blog/2006/06/parsing_formdata_multiparts。 html](http://www.oreillynet.com/onjava/blog/2006/06/parsing_formdata_multiparts.html)

```
int boundaryIndex = contentType.indexOf("boundary=");
byte[] boundary = (contentType.substring(boundaryIndex + 9)).getBytes();

ByteArrayInputStream input = new ByteArrayInputStream(buffer.getBytes());
MultipartStream multipartStream =  new MultipartStream(input, boundary);

boolean nextPart = multipartStream.skipPreamble();
while(nextPart) {
  String headers = multipartStream.readHeaders();
  System.out.println("Headers: " + headers);
  ByteArrayOutputStream data = new ByteArrayOutputStream();
  multipartStream.readBodyData(data);
  System.out.println(new String(data.toByteArray());

  nextPart = multipartStream.readBoundary();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-04-16T04:25:43.530

对我来说，我使用这样的注释和参数：

```
@Consumes(MediaType.APPLICATION_OCTET_STREAM) 
```

> 公共响应 testUpload(文件上传输入流)

然后我可以读取文件内容：

```
 byte[] totalBytes = Files.readAllBytes(Paths.get(uploadedInputStream.toURI())); 
```

然后我必须忽略前 4 行，以及内容结尾部分，如下所示：

```
int headerLen = 0;
int index = 0;
while(totalBytes[index] != '\n' && index < totalBytes.length) {
    headerLen++;
    index++;
}

//ignore next three line
for (int i = 0; i < 3; i++) {
    index++;
    while (totalBytes[index] != '\n' && index < totalBytes.length) {
        index++;
    }
}
index++;
out.write(totalBytes, index, totalBytes.length - index - (headerLen+3));
out.flush();
out.close(); 
```

# java - Java - 正则表达式不起作用

> ID：11471825
> 
> 赞同：0
> 
> 时间：2012-07-13T13:49:37.893
> 
> 标签：java, regex

我有一个字符串，`"abc123("`想检查是否**包含一个或多个不是数字或字符的字符**。

`"abc123(".matches("[^a-zA-Z0-9]+");`在这种情况下应该返回 true 吗？但它没有！怎么了？

我的测试脚本：

```
public class NewClass {
    public static void main(String[] args) {
        if ("abc123(".matches("[^a-zA-Z0-9]+")) {
            System.out.println("true");
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-13T14:00:15.277

在 Java 中，表达式必须匹配整个字符串，而不仅仅是它的一部分。

> myString.matches("regex") 返回 true 或 false，具体取决于字符串是否可以完全由正则表达式匹配。重要的是要记住 String.matches() 仅在可以匹配整个字符串时才返回 true。换句话说：“正则表达式”的应用就好像您已经用字符串锚点的开始和结束编写了“^regex$”。[来源](http://www.regular-expressions.info/java.html)

您的表达式正在寻找字符串的一部分，而不是整个内容。您可以将表达式更改为`.*YOUR_EXPRESSION.*`，它将扩展以匹配整个字符串。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-13T13:57:18.600

与其检查它是否只包含字母和数字，为什么不检查它是否包含除此之外的任何内容？您可以使用非词组 (\W)，如果返回 true，则您知道该字符串包含您要查找的字符以外的其他内容，

```
"abc123(".matches("[\W]"); 
```

如果这返回 true，那么除了单词字符和数字之外还有其他内容。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-13T13:57:46.577

表达`[^A-Za-z0-9]+`的意思是“不是字母或数字”。您可能希望将其替换`^[A-Za-z0-9]+$`为“仅字母或数字”。

# javascript - 检查文件夹 javascript .ajax 中是否存在文件

> ID：11471826
> 
> 赞同：0
> 
> 时间：2012-07-13T13:49:42.970
> 
> 标签：javascript, jquery

我尝试使用下面的代码，但它仅在我检查根文件夹中的文件时才有效（例如 url：“filename.html”）...如果我想检查文件夹中的文件（例如 url：“文件夹/filename.html") 就像下面的代码一样，即使文件夹为空或文件夹没有该文件，它也会始终成功并提醒我“找到文件”。

```
$.ajax({

    type: "GET",
    async: false,
    url: "folder/filename.html",
    cache: false,
    success: function () {
            alert("File found");
    },
    error: function (xhr, status, error) {
            if (xhr.status == 404) {
                    alert("xhr: File Not Found");
    }
    alert("Error: File Not Found");
    }
}); 
```

# macos - 寻找库/框架将实时视频从 OS X 流式传输到 Wowza 服务器 (RTMP)

> ID：11471827
> 
> 赞同：2
> 
> 时间：2012-07-13T13:49:46.863
> 
> 标签：macos, rtmp, wowza

我已经知道我可以通过 FFMPEG 将视频文件流式传输到我的 wowza 服务器，但我需要能够将实时视频（例如来自内置网络摄像头或其他连接的摄像头）流式传输到服务器。

我考虑的一种方法是将视频保存为约 10 秒的短文件，然后使用 FFMPEG 将它们流式传输到 wowza 服务器，但我面临两个问题。首先，当我切换到下一个要流式传输的视频剪辑时，如何确保提要不会中断。二，我如何将其设置为以 10 秒的时间块记录而不会丢失任何内容。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T09:49:52.073

如果您正在寻找商业解决方案，您可以尝试： http: [//www.adobe.com/de/products/flash-media-encoder.html](http://www.adobe.com/de/products/flash-media-encoder.html)

如果您想自己编写代码，您应该搜索“RTMP Client library”，您可以找到（半）商业的： [http](http://www.smaxe.com/juvclient.jsf) : //www.smaxe.com/juvclient.jsf 或完全免费的，如 RTMPClient .java。也有可以在网络中找到的音频编解码器的实现。但是我不知道任何为 OSX 开放的视频验证码。您需要自己在这里编写一些代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T12:15:59.590

在 OS X 上用于从桌面流式传输的最佳工具是[CamTwistStudio](http://camtwiststudio.com/)（以前称为 CamTwist）。CamTwistStudio 用于[NASA 的 SpaceVidcast](http://www.spacevidcast.com/)服务。

查看这个广泛的教程[Free Live Video Streaming with HTTP Live Streaming、uStream、justin.tv、ffmpeg、vlc、x264、Wowza、CamTwist 和 Flash Media Encoder 在 GNU Linux 环境和 Mac OS-X](http://blog.kyri0s.org/post/1406637341/free-live-video-streaming-with-http-live-streaming)中的完整描述从 OS X 流式传输到 Internet。

更强大的商业产品是[Wirecast](http://www.telestream.net/wirecast/overview.htm)。查看本文以获取有关产品的信息： [http ://www.tuaw.com/2012/02/26/wirecast-pro-for-mac-4-1-3-a-close-look-at-a-powerful -网络广播/](http://www.tuaw.com/2012/02/26/wirecast-pro-for-mac-4-1-3-a-close-look-at-a-powerful-webcastin/)

# java - Java - PDF 输出流

> ID：11471831
> 
> 赞同：0
> 
> 时间：2012-07-13T13:49:50.453
> 
> 标签：java, file-io, pdf-generation, liferay

大家好，感谢您花时间回答我的问题。

我正在尝试向客户端发送一个字节数组，以便他的浏览器可以在 e PDF 文件中重建。下面是我的代码：

```
 OutputStream out = response.getPortletOutputStream();

        response.setProperty("Content-Disposition", "attachment; filename=" + fileName + ".pdf");
        response.setContentType("application/pdf");

        out.write(pdfInvoice);
        out.flush();
        out.close(); 
```

我们正在使用 Liferay Portlets，但这不会产生影响。pdfInvoice 是字节数组。执行此代码时没有任何反应。你能看出哪里不对吗？提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T14:19:49.863

您不能像这样在 Portlet 响应中提供 pdf，标准方法是创建一个将 PDF 提供给客户端的 servlet。

如果您想在 Portlet 中提供 PDF，本指南应该会有所帮助[http://www.liferay.com/community/wiki/-/wiki/Main/Generate+PDF+File+in+Portlet](http://www.liferay.com/community/wiki/-/wiki/Main/Generate+PDF+File+in+Portlet)

# javascript - Javascript 数组未按预期工作

> ID：11471834
> 
> 赞同：2
> 
> 时间：2012-07-13T13:49:59.077
> 
> 标签：javascript, jquery, arrays, variables

我对 js/jquery 很陌生。对于 ID 为 check$（其中 $ 是序列号）的每个复选框，我想切换使用相同 check$（但作为一个类）的周围跨度的类“同意”。我不想硬编码匹配复选框的列表，因为这可能会有所不同。

这是我的代码。此功能按预期工作：

```
agree = function (checkbox, span) {
    $(checkbox).change(function(){
       $(span).toggleClass('agree');
   });      
}; 
```

这是我试图传递给上面的函数，它不起作用：

```
$(function() {
    var elemid = 'check',
    checks     = Array($('[id^='+elemid+']').length);
    console.log(checks);
  for (i=0; i < checks; i++) {
    agree('#'+elemid+checks[i], "."+elemid+checks[i]);
    }
}); 
```

console.log(checks) 返回**[undefined × 4]**。元素的数量是正确的，但我不知道为什么它是未定义的，或者这是否重要。

以下代码按预期工作，但正如我所说，我宁愿不必指定每个匹配的元素：

```
$(function() {
    var checks = ["check1", "check2", "check3", "check4"];
    for (i=0; i < checks.length; i++) {
        agree('#'+checks[i], "."+checks[i]);
        }
}); 
```

谢谢。

编辑：感谢[Jack](https://stackoverflow.com/users/680420/jack)，我忽略了最简单的方法。我为所有复选框和跨度添加了相同的类，并解决了这个问题：

```
$('input.check').change(function(){
    $(this).closest('span.check').toggleClass('agree');
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T13:59:01.790

我可能完全遗漏了一些东西，但我很确定你只是想为每个复选框附加一个更改处理程序。在这种情况下，您可以为他们提供所有相同的课程。我也在猜测跨度的 html 结构。

以供参考：

[http://api.jquery.com/closest/](http://api.jquery.com/closest/)

[http://docs.jquery.com/Tutorials:How_jQuery_Works](http://docs.jquery.com/Tutorials:How_jQuery_Works)

```
$('.yourcheckboxclass').change(function(){ //grab all elements with this class and attach this change handler
   $(this).closest('span').toggleClass('agree'); 
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T14:10:19.000

数组中充满未定义值的原因是您只是获取 jQuery 对象中的项目数，并创建一个具有该大小的数组。jQuery 对象被丢弃。

将 jQuery 对象放入变量中：

```
var elemid = 'check', checks = $('[id^='+elemid+']');

checks.each(function(){
  agree(this, "."+elemid+checks[i]);
}); 
```

# git - 如何“git log --follow " 在 JGit 中？（检索包括重命名在内的完整历史记录）

> ID：11471836
> 
> 赞同：5
> 
> 时间：2012-07-13T13:50:09.483
> 
> 标签：git, git-log, jgit

我如何扩展以下 logCommand 才能使命令`--follow`选项`git log`正常工作？

```
Git git = new Git(myRepository);
Iterable<RevCommit> log = git.log().addPath("com/mycompany/myclass.java").call(); 
```

这个选项是在jGit中实现的，但是我不知道怎么用。logCommand 的方法似乎没有用。谢谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-16T12:19:15.137

在一些午夜工作中，我得到了以下信息：

**LogCommand 的最后一次提交将针对所有较旧的提交检查重命名，直到找到重命名操作。这个循环将一直持续到找不到重命名为止。**

但是，该搜索可能需要一些时间，特别是如果它遍历所有提交直到结束并且不再找到任何重命名操作。所以，我愿意接受任何改进。我猜 git 通常使用索引在更短的时间内执行后续选项。

```
import org.eclipse.jgit.api.Git;
import org.eclipse.jgit.api.errors.GitAPIException;
import org.eclipse.jgit.diff.DiffEntry;
import org.eclipse.jgit.diff.RenameDetector;
import org.eclipse.jgit.errors.MissingObjectException;
import org.eclipse.jgit.lib.Repository;
import org.eclipse.jgit.revwalk.RevCommit;
import org.eclipse.jgit.treewalk.TreeWalk;

import java.io.IOException;
import java.util.ArrayList;
import java.util.List;

/**
 * Create a Log command that enables the follow option: git log --follow -- < path >
 * User: OneWorld
 * Example for usage: ArrayList<RevCommit> commits =  new  LogFollowCommand(repo,"src/com/mycompany/myfile.java").call();
 */
public class LogFollowCommand {

    private final Repository repository;
    private String path;
    private Git git;

    /**
     * Create a Log command that enables the follow option: git log --follow -- < path >
     * @param repository
     * @param path
     */
    public LogFollowCommand(Repository repository, String path){
        this.repository = repository;
        this.path = path;
    }

    /**
     * Returns the result of a git log --follow -- < path >
     * @return
     * @throws IOException
     * @throws MissingObjectException
     * @throws GitAPIException
     */
    public ArrayList<RevCommit> call() throws IOException, MissingObjectException, GitAPIException {
        ArrayList<RevCommit> commits = new ArrayList<RevCommit>();
        git = new Git(repository);
        RevCommit start = null;
        do {
            Iterable<RevCommit> log = git.log().addPath(path).call();
            for (RevCommit commit : log) {
                if (commits.contains(commit)) {
                    start = null;
                } else {
                    start = commit;
                    commits.add(commit);
                }
            }
            if (start == null) return commits;
        }
        while ((path = getRenamedPath( start)) != null);

        return commits;
    }

    /**
     * Checks for renames in history of a certain file. Returns null, if no rename was found.
     * Can take some seconds, especially if nothing is found... Here might be some tweaking necessary or the LogFollowCommand must be run in a thread.
     * @param start
     * @return String or null
     * @throws IOException
     * @throws MissingObjectException
     * @throws GitAPIException
     */
    private String getRenamedPath( RevCommit start) throws IOException, MissingObjectException, GitAPIException {
        Iterable<RevCommit> allCommitsLater = git.log().add(start).call();
        for (RevCommit commit : allCommitsLater) {

            TreeWalk tw = new TreeWalk(repository);
            tw.addTree(commit.getTree());
            tw.addTree(start.getTree());
            tw.setRecursive(true);
            RenameDetector rd = new RenameDetector(repository);
            rd.addAll(DiffEntry.scan(tw));
            List<DiffEntry> files = rd.compute();
            for (DiffEntry diffEntry : files) {
                if ((diffEntry.getChangeType() == DiffEntry.ChangeType.RENAME || diffEntry.getChangeType() == DiffEntry.ChangeType.COPY) && diffEntry.getNewPath().contains(path)) {
                    System.out.println("Found: " + diffEntry.toString() + " return " + diffEntry.getOldPath());
                    return diffEntry.getOldPath();
                }
            }
        }
        return null;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-04-21T22:46:01.720

我记得以前尝试过 OneWorld 的解决方案，虽然它有效，但速度很慢。我想我会到处谷歌看看是否还有其他可能性。

是的，在这个[Eclipse 线程](https://www.eclipse.org/lists/jgit-dev/msg03286.html)中，有人建议使用**org.eclipse.jgit.revwalk.FollowFilter并在**[RevWalkFollowFilterTest.java](https://github.com/spearce/jgit/blob/master/org.eclipse.jgit.test/tst/org/eclipse/jgit/revwalk/RevWalkFollowFilterTest.java)中寻找一个使用示例。

所以我想我会试一试，结果是这样的代码：

```
private static class DiffCollector extends RenameCallback {
    List<DiffEntry> diffs = new ArrayList<DiffEntry>();

    @Override
    public void renamed(DiffEntry diff) {
        diffs.add(diff);
    }
}

private DiffCollector diffCollector;

private void showFileHistory(String filepath)
{
    try
    {
        Config config = repo.getConfig();
        config.setBoolean("diff", null, "renames", true);

        RevWalk rw = new RevWalk(repo);
        diffCollector = new DiffCollector();

        org.eclipse.jgit.diff.DiffConfig dc = config.get(org.eclipse.jgit.diff.DiffConfig.KEY);
        FollowFilter followFilter =
                 FollowFilter.create(filepath, dc);
        followFilter.setRenameCallback(diffCollector);
        rw.setTreeFilter(followFilter);
        rw.markStart(rw.parseCommit(repo.resolve(Constants.HEAD)));

        for (RevCommit c : rw)
        {
            System.out.println(c.toString());
        }
    }
    catch(... 
```

结果是，嗯，好吧，我猜... RevWalk 确实设法完成了 git-repo 历史中文件的简单重命名（由“git mv {filename}”操作执行）。

但是，它无法处理更混乱的情况，例如当一位同事在 repo 的历史记录中执行了这组操作时：

*   第一次提交：用“git mv”重命名文件
*   第二次提交：在新的子文件夹位置添加了该文件的副本
*   第三次提交：删除了旧位置的副本

在这种情况下，JGit 的跟随功能只会让我从头部到第二次提交，然后停在那里。

然而，真正的“ **git log --follow** ”命令似乎有足够的智慧来弄清楚：

*   第二次提交中添加的文件与第一次提交中添加的文件相同（即使它们位于不同的位置）
*   它会给你整个历史：
    *   从 HEAD-to-2nd-commit（在新位置添加新命名文件的副本）
    *   跳过任何提及第 3 次提交（删除旧路径中的旧文件）
    *   其次是第一次提交及其历史（旧位置和文件名）

所以 JGit 的跟随能力似乎比真正的 Git 弱一些。呃，好吧。

但无论如何，我可以确认使用 JGit 的**FollowFilter**技术确实比之前建议的技术快得多。

# android - 随机生成/挑选单词

> ID：11471837
> 
> 赞同：1
> 
> 时间：2012-07-13T13:50:13.543
> 
> 标签：android

首先让我说我是编程的初学者。到目前为止，我只做了一个 Android 应用程序，它只是上网，获取一些数据并对其进行一些简单的计算。我非常喜欢这一点，并希望继续尝试通过编码来学习。

我有另一个想法想变成一个应用程序：

我有 2 个单词列表。一个有大约 50,000 个单词，另一个有近 100,000 个单词。我想要做的是从每个列表中随机选择一个单词并继续选择，直到两个单词的第一个字符相同。但马上我发现自己卡住了，因为我不知道为我的目的存储这些列表的正确方法（纯 txt？csv？xml？其他东西？）。

有人可以指出我正确的方向吗？似乎我一个人用谷歌搜索无处可去。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T14:12:00.387

由于两个数据集中有这么多单词，在第一个字母匹配之前随机选择可能会很长。

这是一个让这更快的想法。将这两个数据存储在[SQLite 表中](https://developer.android.com/guide/topics/data/data-storage.html#db)。然后，您可以选择一个随机的第一个字母，并从每个表中查询以您的字母开头的随机行。例如，以下查询返回一个随机行，其列的值以 A 开头

```
SELECT word FROM table WHERE wordlike 'A%' ORDER BY RANDOM() LIMIT 1; 
```

# php - Ajax、JavaScript、PHP/HTML 和变量

> ID：11471838
> 
> 赞同：0
> 
> 时间：2012-07-13T13:50:24.140
> 
> 标签：php, javascript, ajax, scope

好的...所以我正在开发一款游戏，但我认为我遇到了范围问题...

它从我的 js 文件开始，通过点击玩家想要玩的卡触发：

`It starts in my js file:`

 ````
function playCard(playerId, card){
    $.post("support_files/Blades_functions.php", {
        method:'playCardFromHand',
        playerID:playerId,
    cardName:card
    },function(data){       
        var attr = new Array();
        attr = data.split("/");
        alert(data);
        $("#playerAttackPower").html(attr[0]);
        $("#playerDefensePower").html(attr[1]);
        $("#playerHealth").html(attr[2]);
        $("#playerAttackMod").html(attr[3]);
        $("#playerChargeCounters").html(attr[4]);
        $("#playerSpecialAttackCounters").html(attr[5]);
    });
} 
```

Then into my php file

```
function playCardFromHand(){
    $weapons = new WeaponCards(); // this is basically a class with variables(card objects) (my answer to php not having enums really)
    $player = $theGame->gamePlayers[$_POST['playerID']]; // this is the variable ($theGame) that I declare in my main php file with all the markup on it. I'm including my functions file in my main file so the variable should be visible... I've tried using "global" keyword as well and that didn't do anything different...       
    $cardName = $_POST['cardName'];
    $card = $weapons->$cardName;
    $card->applyCard($player);      
    echo $player->getAttack()."/".$player->getDefense()."/".$player->getLife()."/".$player->getAttackMultiplier()."/".$player->getChargeCounters()."/".$player->getSpecAttackCounters();
} 
````  `所以我的问题是 $player 变量为空，所以什么都没有显示。基本上，正如您在 js 函数的回调中看到的那样，我只是解析字符串并更新主 php 页面上的播放器统计信息。那么这是一个范围的事情吗？有没有办法让 PHP 持久化 $theGame 变量，它本身就是一个对象，以便我可以在我的函数文件中访问/修改它？

任何想法都会很有帮助...正如我所说，我尝试使用 global 关键字...尝试将 $theGame 对象中的变量公开，尝试将它们设为私有并使用 getter 和 setter...我已经实际上有一个单独的问题，似乎无法让我的函数在我的对象上工作，只是将我的变量公开并直接访问它们，而不是使用 getter 和 setter。反正。请帮忙！我好沮丧！！！哈哈

谢谢，乔恩

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T14:24:12.137

确保将 PHP 变量声明为全局变量，否则必须在函数内部获取 POST 变量。`

# html - 用于 Outlook 的 HTML 电子邮件中的大字体

> ID：11471843
> 
> 赞同：0
> 
> 时间：2012-07-13T13:50:34.947
> 
> 标签：html, email, fonts, outlook, size

我正在为多个电子邮件客户端设计[HTML 格式的电子邮件通讯。](http://en.wikipedia.org/wiki/HTML)到目前为止，它适用于除[Outlook](http://en.wikipedia.org/wiki/Microsoft_Outlook)之外的所有客户端...

字体变得如此之大，以至于表格等都破裂了。我已经在各处提供了[CSS](http://en.wikipedia.org/wiki/Cascading_Style_Sheets)内联，并为 Outlook 添加了一些 CSS 技巧。我没有这个解决方案。这是代码；

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="format-detection" content="telephone=yes">
        <meta name="viewport" content="width=600,initial-scale = 2.3,user-scalable=no">
        <title>Untitled Document</title>
        <style type="text/css">
            /* Client-specific Styles */
            #outlook a{padding:0;}

            body{width:100% !important;} .ReadMsgBody{width:100%;} .ExternalClass{width:100%;}

            body{-webkit-text-size-adjust:none; -ms-text-size-adjust:none;}

            p {
                margin: 1em 0;
            }

            h1, h2, h3, h4, h5, h6 {
                color: black !important;
                line-height: 100% !important;
            }

            h1 a, h2 a, h3 a, h4 a, h5 a, h6 a {
                color: blue !important;
            }

            h1 a:active, h2 a:active,  h3 a:active, h4 a:active, h5 a:active, h6 a:active {
                color: red !important;
            }

            h1 a:visited, h2 a:visited,  h3 a:visited, h4 a:visited, h5 a:visited, h6 a:visited {
                color: purple !important;
            }

            table td {
                border-collapse:collapse;
            }
            .yshortcuts, .yshortcuts a, .yshortcuts a:link,.yshortcuts a:visited, .yshortcuts a:hover, .yshortcuts a span { color: black; text-decoration: none !important; border-bottom: none !important; background: none !important;}

            .ExternalClass {
                width:                        100%;
            }
            .ExternalClass, .ExternalClass p, .ExternalClass span, .ExternalClass font, .ExternalClass td, .ExternalClass div {
                line-height:                 100%;
            }
            .ExternalClass{display:inline-block; line-height: 131%};
            .ExternalClass {width: 100%;}
            .ReadMsgBody{width: 100%;}
            table td {
                border-collapse:            collapse;
            }
            body {
                margin:                         0;
                padding:                        0;
                width:                       100%;
                overflow-y:                hidden;
                background-color:         #000000;
                -webkit-text-size-adjust:    100%;
                -ms-text-size-adjust:        100%;
                font-family:            Helvetica;
                vertical-align:               top;
                border-spacing:               0px;
                color:                    #ffffff;
            }
            p {
                margin-bottom:               10px;
                margin-left:                 35px;
                margin-right:                35px;
            }
            .container {
                width:                      600px;
                background-color:            #000;
                margin:                    0 auto;
            }
            a:link {
                color:                    #ffffff;
                text-decoration:        underline;
            }
            a:visited {
                color:                    #6E6C64;
                text-decoration:        underline;
            }
            a:hover, a:active, a:focus {
                text-decoration:             none;
            }
        </style>
    </head>

    <body margin="0" padding="0" width="100%" style="overflow-y:hidden; background-color:#000000; -webkit-text-size-adjust:100%; -ms-text-size-adjust:100%;  font-family:Helvetica; vertical-align:top; border-spacing:0px; font-size:1em;">
        <table class="container" width="600px" background-color="#000000" margin="0 auto" cellpadding="0" cellspacing="0">
            <tr width="600px">
                <td style="line-height:10px;" width="600px"><img src="http://mediabunker.com/email/header.png" align="absbottom"></td>
            </tr>
            <tr bgcolor="#f8f8f8" width="600px">
                <td style="font-family:Helvetica; font-size:1em;" width="600px">
                    <h1 align="center" style="color:#000000;">Need apps? We build ‘em.</h1>

                    <p style="margin-bottom:10px; color:#575757; margin-left:35px; margin-right:35px; font-size:1em;">Het gebruik van applicaties, oftewel apps, is namelijk booming! Steeds meer merken en bedrijven zien het gemak van een app in. Het is de ideale optie voor het versterken van uw merk, zowel extern als intern, of het opzetten van een geheel nieuw product. Ook de enorme groei in gebruik van mobiele apparaten zorgt er voor dat een sterk merk niet meer kan achter blijven.</p>

                    <p style="margin-bottom:10px; color:#575757; margin-left:35px; margin-right:35px; font-size:1em;">Mocht u geïnteresseerd zijn in onze service, van op maat gemaakte applicaties en backend oplossingen, neem dan gerust contact met ons op. U bent van harte welkom voor een kop koffie bij ons in de Suikersilo's, tijdens een verkennend gesprek of een demonstratie van de mogelijkheden van apps voor mobiel, tablets, tv en het web.</p>

                    <p style="margin-bottom:10px; color:#575757; margin-left:35px; margin-right:35px; margin-bottom:60px; font-size:1em;">Alvast bedankt en hopelijk tot ziens.</p>
                </td>
            </tr>
            <tr width="600px">
                <td><img src="http://mediabunker.com/email/title.png" align="absbottom"></td>
            </tr>
            <tr bgcolor="#232323" width="600px">
                <td style="font-family:Helvetica; font-size:1em;">
                    <table height="auto" border="0" cellpadding="5px" margin-top="0" align="center" style="color:#fff;">
                        <tr align="center">
                        <td align="center"><img src="http://mediabunker.com/email/apple.png"/></td>
                        <td align="center"><img src="http://mediabunker.com/email/android.png"  /></td>
                        </tr>
                      <tr>
                        <td align="center" style="font-family:Helvetica; font-size:1em;">Apple iOS de kracht achter<br />
                          de iPhone, iPod en iPad.</td>
                        <td align="center" style="font-family:Helvetica; font-size:1em;">Android is met Google, HTC en<br />
                                            Samsung, het meest gebruikte<br />
                                            mobiele besturingssysteem.</td>
                        </tr>
                      <tr>
                        <td align="center"><img src="http://mediabunker.com/email/windows.png" /></td>
                        <td align="center"><img src="http://mediabunker.com/email/html.png" /></td>
                        </tr>
                      <tr>
                        <td align="center" style="font-family:Helvetica; font-size:1em;">Microsoft en Nokia bieden<br />
                          samen de Windows Phone, <br />
                          voor de conventionele liefhebbers.</td>
                        <td align="center" style="font-family:Helvetica; font-size:1em;">Ook een mobiele web app<br />
                          in HTML5 en CSS3<br />
                          is geen probleem!</td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr width="600px">
                <td><img src="http://mediabunker.com/email/actie.png" align="absbottom"></td>
            </tr>
            <tr width="600px">
                <td>
                    <table border="0" HALIGN="center" style="margin-bottom:30px; margin-top:20px;">
                      <tr align="center">
                        <td align="center" width="189px" style="font-family:Helvetica; font-size:1em;"><font color="white">Suikersilo-West 23 <br />1165 MP Halfweg</font></td>
                        <td align="center" width="189px" style="font-family:Helvetica; font-size:1em;"><a href="tel:0031238200140">Tel +31 23 820 0140</a><br> <a href="mailto:info@mediabunker.com">info@mediabunker.com</a></td>
                        <td align="center" width="189px" style="font-family:Helvetica; font-size:1em;"><a href="http://mediabunker.com">www.mediabunker.com</a><br> <a href="http://twitter.com/mediabunker">twitter.com/mediabunker</a></td>
                      </tr>
                    </table>
                </td>
            </tr>
        </table>
    </body>
</html> 
```

还有网络版[FWIW](http://en.wiktionary.org/wiki/FWIW)；[http://mediabunker.com/email/email.html](http://mediabunker.com/email/email.html)。快速上传某人发给我的屏幕截图，这是我认为的最新 Outlook 版本。

![在此处输入图像描述](../Images/f3cddca87830bd670aa3c3027ee6ab32.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T16:02:16.323

首先：发送[HTML](http://en.wikipedia.org/wiki/HTML)电子邮件时使用[CSS](http://en.wikipedia.org/wiki/Cascading_Style_Sheets)类不是一个好主意。在包括 Outlook 在内的许多客户端中，它们将被剥离或忽略。

关于您的问题：在我看来，`td`'s 的宽度设置不正确。当我查看您的源代码时，您定义了表格的宽度，`tr`'s 和`td`' 如下。

```
width="600px" 
```

这应该是

```
width="600" 
```

反而。然而，更重要的是（因为 Outlook 有时喜欢忽略表格上的 HTML 属性）将内联 CSS 添加到您的元素中，如下所示：

```
style="width: 600px" 
```

不要忘记表格单元格 ( `td`) 和父表格。

我认为应该这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-07T08:15:12.733

简短的回答：
不要在 HTML 电子邮件中使用标题标签。无论您如何声明它，一些客户都会使用标题标签破坏您的样式。

1.  删除 h1 标签
2.  从您遇到问题的文本周围的 TR 标签中删除所有样式，并将该样式放在 td 标签中。
3.  完全删除该元素周围的宽度并将其替换为 text-align。

长答案：

1.  尽可能使用折旧的 HTML 标签，而不是 CSS。

    1.  body bgcolor="" 而不是 style="background-color..
    2.  td margin="0" 而不是 margin="0 auto" （更好.. 使用 cellpadding 代替）
2.  使固定
    1.  width="5px" .. 不要在折旧的 html 尺寸中写入 px（cellpadding 也是如此）
    2.  margin="0 auto" .. 不要使用速记代码
    3.  line-height .. 不要使用 line-height ，除非您纯粹将其用于样式设置，如果您将其用于正确格式化.. 不要指望它工作。
    4.  h1、h2、h3、h4、h5、h6 .. 不要使用它们。
    5.  p .. 不要使用段落，将您的样式放在 td 中，并将每个段落包装在 td 而不是 p 中。

用这段代码替换你所有的头部 CSS 直到你的 body 标签，如果你认为你需要在头部添加更多的 CSS，不要。直到你熟练得多。这应该可以帮助你..

```
 <style type="text/css">
        /* Client-specific Styles */
        html>body {width:100% !important;-webkit-text-size-adjust:100%;margin:0;padding:0;}
        body, div, p, a, li, td{-webkit-text-size-adjust:none;}
        .ReadMsgBody, .ExternalClass {width: 100% !important;background-color:#ffffff;}
        .ExternalClass * {line-height: 100%} 
        #outlook a {padding:0;}
        table { border-collapse:collapse;mso-table-lspace:0pt;mso-table-rspace:0pt;}
        table td {border-collapse: collapse;}
        img {outline:none;text-decoration:none;-ms-interpolation-mode: bicubic;display:block;}
        a img{border:none;}
        p{margin: 1em 0;}
        a {color:#ffffff;}
        a:link{color:#ffffff;}
        a:visited{color:#ffffff;}
        a:hover{color:#ffffff;}
        .yshortcuts a { border-bottom: none !important;}

    </style>
</head>
<body bgcolor="#000000" style="margin-top:0px;margin-bottom:0px;margin-left:0px;margin-right:0px;padding-top:0px;padding-bottom:0px;padding-left:0px;padding-right:0px;color:#252525;font-family:Arial,sans-serif;" border="0"> 
```

# git - Git：审查对分支的更改

> ID：11471844
> 
> 赞同：0
> 
> 时间：2012-07-13T13:50:36.273
> 
> 标签：git

在执行代码审查时，我的方法是使用 meld 查看对分支的更改：

**步骤 1**。使用 git log 查找分支上第一次和最后一次提交的 sha1

```
git log --graph --oneline --all

```

这将给出如下内容：

```
    * fffffff 对 HEAD 的另一个提交
    * eeeeeee 对 HEAD 的承诺
    | * dddddd 分支上的最后一次提交 MY_AWESOME_CHANGE
    | * ccccccc 一些工作
    | * bbbbbbb 分支上的第一次提交 MY_AWESOME_CHANGE
    |/  
    * aaaaaaa 更新评论以解释外部数据的聚合

```

**步骤 2**。使用 git difftool 启动 meld 以查看更改

```
git difftool aaaaaaa ddddddd

```

我的问题是：有没有更好的方法来进行第 1 步？以下问题提供了一种查找分支起点的方法：[finding-a-branch-point-with-git](https://stackoverflow.com/questions/1527234/finding-a-branch-point-with-git)。然后我可以使用“git log”来查找分支上最后一次提交的 sha1：

```
git log -1 MY_AWESOME_BRANCH

```

但这似乎有点矫枉过正，我想知道我是否遗漏了一些更简单的东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T13:54:02.650

您可以对or使用`...`（三点）语法，如：`git diff``git difftool`

```
git difftool master...experiment 
```

这样做是为了向您展示以下之间的区别：

*   和的*合并*`master`基础`experiment`
*   ... 和`experiment`

`..`和的含义`...`不同`git log`-我`git diff`的[另一个答案](https://stackoverflow.com/a/5257065/223092)有一些图表显示了差异。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T13:54:26.343

如果你在`HEAD`，那么

```
git merge --no-commit --no-ff MY_AWESOME_CHANGE 
```

将向您显示**将**合并到您的所有更改，`HEAD`并将适当地更新您的工作副本，但实际上不会提交合并。

# ios - NSURLConnection 在同一子网上的地址超时

> ID：11471853
> 
> 赞同：1
> 
> 时间：2012-07-13T13:51:09.047
> 
> 标签：ios, nsurlconnection, subnet

我在 iPhone 4s、iOS5.1.1 上使用 NSURLConnection，并且在调用同一子网上的机器上的 php 脚本时遇到问题，例如：[http://myMac.local/PHPscript.php](http://myMac.local/PHPscript.php)
相同的 URL 有效在使用 Safari 的 iPhone 上很好，我的代码也很好用——只要机器在互联网上的某个地方——。在本地机器上，它会以某种超时运行，并且什么也不返回。
使用模拟器进行测试时，所有 3 个（名称、IP、外部名称）都可以工作，或者它们不工作。还不知道是什么导致事情开始工作......
报告的错误是：NSLocalizedDescription =请求超时。，NSUnderlyingError = 0x24e6c0。找不到那个号码:-(

关于我可以继续寻找的任何指针（谷歌搜索 NSURLConnection 和超时现在让我发疯：-<）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T15:17:21.110

这也发生在我身上。然后我向我的 IT 人员报告，他说我们不会将请求转发给指向他们 IP 的 Internet 服务提供商。因此，我为它制定了一个解决方案

```
#if DEBUG
#define BASE_URL 192.168.x.x
#else
#define IP_ADDRESS www.mysite.com
#endif 
```

模拟器的调试版本和 iPhone 的发布版本。

# php - mongoDB 插板模式

> ID：11471854
> 
> 赞同：0
> 
> 时间：2012-07-13T13:51:13.487
> 
> 标签：php, mongodb, gridfs

我正在创建插板（类似于[http://www.pinterest.com](http://www.pinterest.com)）。我使用 MongoDB 作为数据库（存储所有引脚）。

```
Pins {
    userid,
    img,
    title,
    description,
    comments {
        [userid, username, comment]
    }
} 
```

我想将图像存储在 gridFs 中。我应该如何将 gridFs 文件链接到 Pins.img。应该只有一个图像，但可以在多个引脚中链接。

我想不通。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T14:03:40.427

首先，只有当存储的数据（单个图像）超过 mongodb 的最大文档大小（自 1.8 版以来为 16MB）时，您才需要 GridFS。

但无论如何，如果它们位于不同的集合中，则使用[mongoref链接两个文档。](http://us.php.net/manual/en/class.mongodbref.php)或者只是将保存图像数据的文档的 ID 存储在 Pins 文档中。

要检索图像数据，您需要在结果中循环查询要显示的 Pins 文档，并从图像文档中查询每个图像。

这适用于将图像存储在 gridfs 或普通文档内的简单[二进制](http://us.php.net/manual/en/class.mongobindata.php)字段中（php[文档](http://us.php.net/manual/en/class.mongobindata.php)已过时，仍然指的是 4MB 最大文档大小，现在是 16MB）。

如果您将上传的图像调整为合理的分辨率并将它们存储为 jpeg 数据，那么无论如何您几乎不需要 16MB。

# php - .htaccess 基于 URL 的多个 php 处理程序 - fatfree 框架多个路由文件

> ID：11471859
> 
> 赞同：1
> 
> 时间：2012-07-13T13:51:30.670
> 
> 标签：php, apache, .htaccess, fat-free-framework

当谈到 htaccess 文件时，我有点菜鸟，所以我需要一些帮助。我正在使用 PHP 的 fatfree 框架 (f3)，并且已经修改了它的 htaccess 文件以满足我的需要，直到现在。

我要做的是拆分/组织 fatfree 的路由系统......所以并非所有路由都存在于一个 PHP 文件中。

这是我希望实现的目标。

1.  包含 /api/* 的 URL 将由 /api/index.php 处理。
2.  包含 /auth/* 的 URL 将由 /auth/index.php 处理
3.  以上 2 之外的任何其他 URL 都由 /index.php 处理。

使用以下 .htaccess 文件，我已经能够实现上面的#1 & #2。#3，不太确定。

```
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-l
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^api/.* api/index.php [L,QSA]
RewriteRule ^auth/.* auth/index.php [L,QSA] 
```

任何提示表示赞赏！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T13:56:45.497

这应该照顾＃3：

```
RewriteCond $1 !^(api|auth)
RewriteRule ^(.*)$ /index.php/$1 [L] 
```

# asp.net-mvc-3 - MVC 3 不显眼的列表验证

> ID：11471862
> 
> 赞同：5
> 
> 时间：2012-07-13T13:51:36.340
> 
> 标签：asp.net-mvc-3, validation, unobtrusive-validation, asp.net-mvc-validation

**问题**

我创建了一个服务器端属性级别验证属性。但我没有将其应用于单个字段，而是将其应用于列表。这使我可以将模型作为一个整体进行验证。

我现在需要知道如何使用 MVC 3 中内置的不显眼的客户端验证将其转换为工作。

下面是我当前的代码来说明我的问题...

**设想**

基本场景是能够合计由 GroupNo 字段分组的 List 中每一行的所有 Quantity 值。如果任何组的总和超过 10，则应显示错误。

我在上一篇文章中得到了一个答案，使用针对列表的验证属性使这项工作在服务器端工作......

该模型：

```
public class ItemDetails
{
    public int SerialNo { get; set; }
    public string Description { get; set; }
    public int GroupNo { get; set; }
    public decimal Price { get; set; }
    public int Quantity { get; set; }
}

public class MyViewModel
{
    [EnsureMaxGroupItems(10, ErrorMessage = "You cannot have more than 10 items in each group")]
    public IList<ItemDetails> Items { get; set; }
} 
```

和验证属性本身：

```
[AttributeUsage(AttributeTargets.Property)]
public class EnsureMaxGroupItemsAttribute : ValidationAttribute
{
    public int MaxItems { get; private set; }

    public EnsureMaxGroupItemsAttribute(int maxItems)
    {
        MaxItems = maxItems;
    }

    public override bool IsValid(object value)
    {
        var items = value as IEnumerable<ItemDetails>;
        if (items == null)
        {
            return true;
        }

        return items
            .GroupBy(x => x.GroupNo)
            .Select(g => g.Sum(x => x.Quantity))
            .All(quantity => quantity <= MaxItems);
    }
} 
```

最后，您的控制器操作将与视图模型一起使用：

```
public ActionResult ListItems()
{
    var model = new MyViewModel
    {
        Items = ItemsRepository.GetItems()
    };
    return View(model);
}

[HttpPost]
public ActionResult ListItems(MyViewModel model)
{
    if (!ModelState.IsValid)
    {
        return View(model);
    }

    ...
} 
```

接下来是相应的强类型视图：

```
@model MyViewModel
@Html.ValidationSummary()
@using (Html.BeginForm())
{
    @Html.EditorFor(x => x.Items)
    <button type="submit">Go go go</button>
} 
```

最后一点是相应的编辑器模板，它将为 Items 集合的每个元素自动呈现，因此您甚至不需要编写 for 循环（`~/Views/Shared/EditorTemplates/ItemDetails.cshtml`）：

```
@model ItemDetails
@Html.HiddenFor(x => x.SerialNo)
@Html.LabelFor(x => x.Description)
@Html.HiddenFor(x => x.GroupNo)
@Html.LabelFor(x => x.Price)
@Html.TextBoxFor(x => x.Quantity) 
```

**客户端不显眼的验证可能吗？**

我希望使用不显眼的 MVC 验证来验证这一切。但我无法弄清楚如何针对整个列表不显眼地验证 EnsureMaxGroupItemsAttribute 属性。

我以这种方式实现了 IClientValidatable：

```
 Public Function GetClientValidationRules(metadata As System.Web.Mvc.ModelMetadata, context As System.Web.Mvc.ControllerContext) As System.Collections.Generic.IEnumerable(Of System.Web.Mvc.ModelClientValidationRule) Implements System.Web.Mvc.IClientValidatable.GetClientValidationRules

        Dim result = New List(Of ModelClientValidationRule)

        Dim rule = New ModelClientValidationRule() With { _
            .ErrorMessage = "You cannot have more than 10 items in each group", _
            .ValidationType = "itemscheck"}

        result.Add(rule)

        Return result

    End Function 
```

注意：VB 和 C# 的混合只是因为我之前提出的问题是用 C# 回答的。该项目在 VB 中，但我不介意 C# 中的答案。

我在我的 JS 文件中创建了适配器：

```
jQuery.validator.unobtrusive.adapters.addBool("itemscheck"); 
```

... 和 ...

```
jQuery.validator.addMethod("itemscheck", function (value, element, params) {
    // The check has been omitted for the sake of saving space.  
    // However this method never gets called
    return false;
}); 
```

有没有办法把它连接起来不显眼地工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T11:51:12.490

This is not possible because your custom attribute is placed in the collection property and there are no HTML5 `data-*` attributes emitted at all. It is not a supported scenario by the unobtrusive client validation framework. You could write directly a custom jquery validate rule to handle this scenario if you need client validation for it.

# excel - 将表示 NEGATIVE TIME 值的 TEXT 转换为用于添加的数字或时间值 (Excel)

> ID：11471868
> 
> 赞同：2
> 
> 时间：2012-07-13T13:51:57.340
> 
> 标签：excel, time, excel-formula, negative-number

我有一个电子表格（Excel 的 Office 2007 版本），其中充满了负时间值的文本条目，例如“-0:07”，因为员工完成工作的时间比预期的少 7 分钟。我需要对这些条目进行数学计算，并且正在寻找比我迄今为止想出的更优雅的公式/方法。

我知道 1904 日期系统和 * 或 / by 24 来回转换，问题是得到一个公式，将文本条目识别为负时间值。

我试过 value(), *1，如果数字是正数，它们都适用于文本字段，但“-”似乎把它们弄乱了。即使 paste-special/add 也无法将这些识别为数字。

这是我想出的可以完成工作的方法，但这对我来说太难看了：

```
=IF(LEFT(E5,1)="-",((VALUE(RIGHT(E5,LEN(E5)-1)))*-1.0),VALUE(E5)) 
```

显然，在本例中，我的文本条目位于单元格 E5 中。

这行得通，所以我并不急于寻求解决方案，但出于教育目的（和更小的代码），我想知道是否有更好的方法。有没有人建议更短，更容易的东西？

谢谢。

PS - 这里有一个有趣的花絮，我在工作中使用 Excel，但不在家里，所以我将一个示例电子表格上传到 Google Docs，它实际上正确处理了这些条目上的 Value() 命令。很奇怪吧？

再次感谢您的任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T14:49:59.330

Excel 不处理单元格中的时间跨度。它只处理时间。当您执行“00:07”时，它将转换为 0.0048611，这与 1900 年 1 月 1 日上午 12.07 相同。因此，如果您将 2 分钟减去 7 分钟，则最多只能在晚上 11.55 分。

你这样做的方式是唯一的方式。

# android - 使用 android 中的 http 请求在 android 上下载图像

> ID：11471870
> 
> 赞同：0
> 
> 时间：2012-07-13T13:52:06.077
> 
> 标签：android

我使用了一个教程并得出了这个在模拟器中工作的结果，但它在真正的 Android 设备上停止工作。

此处给出了代码，并设置了所需的所有其他 Android 权限；互联网和写入外部设备已设置。

```
import java.io.BufferedInputStream;
import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.net.HttpURLConnection;
import java.net.URL;
import java.net.URLConnection;
import org.apache.http.util.ByteArrayBuffer;
import android.app.Activity;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.os.Bundle;
import android.widget.ImageView;
import android.widget.TextView;

public class main extends Activity {

    private final String PATH = "/mnt/sdcard/Pictures/";
    TextView tv;
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        tv = (TextView)findViewById(R.id.textView1);
        DownloadFromUrl(PATH + "dwnldimg.png");
        ImageView iv = (ImageView) findViewById(R.id.imageView1);
        Bitmap bmp = BitmapFactory.decodeFile(PATH  + "dwnldimg.png");
        iv.setImageBitmap(bmp);
    }
    public void DownloadFromUrl(String fileName) {
            try {
                    URL url = new URL("http://192.168.1.4/evilempire.jpg"); //you can write here any link
                    File file = new File(fileName);
                     long startTime = System.currentTimeMillis();
                    tv.setText("Starting download......from " + url);
                    HttpURLConnection conn = (HttpURLConnection)url.openConnection();;
                    conn.setDoInput(true);
                    conn.connect();
                    InputStream is = conn.getInputStream();
                    BufferedInputStream bis = new BufferedInputStream(is);
                    /*
                     * Read bytes to the Buffer until there is nothing more to read(-1).
                     */
                    ByteArrayBuffer baf = new ByteArrayBuffer(50);
                    int current = 0;
                    while ((current = bis.read()) != -1) {
                            baf.append((byte) current);
                    }

                    FileOutputStream fos = new FileOutputStream(file);
                    fos.write(baf.toByteArray());
                    fos.close();
                    tv.setText("Download Completed in" + ((System.currentTimeMillis() - startTime) / 1000) + " sec");
            } catch (IOException e) {
                 tv.setText("Error: " + e);
            }
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T14:15:57.667

Prime lib 会帮助您，但要学习 Android，您需要了解 AsyncTask。Android 有运行 Activity 的 UI 线程，因此如果您执行阻止 Android 操作系统的复杂操作将引发强制关闭。所以你必须知道的是，如果你需要执行下载任务或任何最终会阻塞 UI 线程的操作，你可能不得不使用 Threads。简单的 Android 方法是 AsyncTask。我认为这个简单的示例将引导您了解 AsyncTask。 [http://developer.android.com/reference/android/os/AsyncTask.html](http://developer.android.com/reference/android/os/AsyncTask.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T13:57:14.330

首先，您在主 ui 线程上进行网络操作，这将导致 pre-3.0 上的 anr 和 3.0+ 上的 NetworkOnMainThreadException。其次，我构建了[Prime](https://github.com/DHuckaby/Prime)，它在加载远程图像时要容易得多。

# c# - 自动属性和通常声明的属性之间的性能差异。对或错？

> ID：11471871
> 
> 赞同：-1
> 
> 时间：2012-07-13T13:52:08.873
> 
> 标签：c#, .net, visual-studio-2010, clr, clr4.0

从性能的角度来看，自动实现的属性和手动实现的属性之间有什么区别吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-13T13:53:16.893

> 因为我们知道它们是在运行时创建的

自动属性不是在运行时创建的，它们是在编译时生成的。非常像`using`，它们是有用的语法糖，可以减少你需要做的打字量。它们只是简单地翻译成您无论如何都要手动编写的代码。

没有性能差异。除了支持字段名称之外，生成的代码与您手动执行的代码相同。

正如@dasblinkenlight 强调的那样，作为“安全名称”的后备名称（例如，永远无法在 C# 中创建它）可能会导致无法正确处理名称的序列化问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-13T13:56:24.720

没有区别。自动属性在编译时转换为普通属性。所以这：

```
public int Prop { get; set; } 
```

被制成与此等效的东西：

```
private int _PropField;

public int Prop {
    get { return _PropField; }
    set { _PropField = value; }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-13T13:56:05.363

自动属性是语法糖意味着它们是编写属性的简写

> **取自 MSDN：**
> 
> 在 C# 3.0 及更高版本中，当属性访问器中不需要额外的逻辑时，自动实现的属性使属性声明更加简洁。它们还使客户端代码能够创建对象 当您如下例所示声明属性时，编译器会创建一个私有的匿名支持字段，只能通过该属性的 get 和 set 访问器访问。

[http://msdn.microsoft.com/en-us/library/bb384054(v=vs.90).aspx](http://msdn.microsoft.com/en-us/library/bb384054(v=vs.90).aspx)

# optimization - extjs中的代码优化技术？

> ID：11471873
> 
> 赞同：5
> 
> 时间：2012-07-13T13:52:14.020
> 
> 标签：optimization, extjs4, extjs4.1

我在页面中动态创建一些控件。当我们有大约五十个控件时，它会变慢。

extjs 中使用了哪些代码优化技术/指南？是否有任何特定方法会减慢整个加载速度？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-13T14:07:16.343

Sencha 有很棒的帖子：

[Ext JS 4.1 性能](http://www.sencha.com/blog/ext-js-4-1-performance/)：

*   网络延迟会严重影响初始启动时间，还会影响数据存储加载时间。
*   CSS 处理。
*   JavaScript 执行。
*   DOM 操作。

[优化基于 Ext JS 4.1 的应用程序](http://www.sencha.com/blog/optimizing-ext-js-4-1-based-applications/)关于优化技巧和页面分析器工具。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-14T10:42:38.240

我的建议是

*   使用 Ext.container.Container 而不是 Ext.panel.Panel。
*   无需添加 ext 组件，而是使用带有数据视图的 XTemplate 来加载类似的控件。
*   如果您使用许多图像，则使用图像精灵 - 图像精灵是放入单个图像的图像集合。包含许多图像的网页可能需要很长时间才能加载并生成多个服务器请求。使用图像精灵将减少服务器请求的数量并节省带宽。 [http://css-tricks.com/css-sprites/](http://css-tricks.com/css-sprites/)

# javascript - 包含函数调用的 json 字符串

> ID：11471880
> 
> 赞同：0
> 
> 时间：2012-07-13T13:52:32.597
> 
> 标签：javascript, json, parsing

例如我的 json 字符串是这样的：

```
{
"v1" : [], 
"v2": 2, 
"v3": f()
} 
```

现在我需要解码的上下文有一个定义`f`并`f()`在该上下文中给出正确的答案（通过调试器检查）。但是`JSON.parse(jsonstring)`给我`Unexpected token`。`eval`也给出错误。我该怎么办？

[在此处](http://jsfiddle.net/s2mve/)查看示例

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T13:54:20.450

**为什么它不起作用**

看一下 JSON 的[定义](http://www.json.org/)，它不能包含函数调用。

**可能的解决方法**

一种方法是执行类似的操作，返回要调用的函数的字符串。

```
{
    "v1" : [], 
    "v2": 2, 
    "v3": "f"
} 
```

现在当您需要访问它时，您可以调用该函数。

```
var myJSON = JSON.parse(jsonstring);
var myFunctionResult = window[myJSON.v3]();  //works if global variable 
```

其他选择是更改代码的工作方式并进行异步脚本调用 [jQuery 将是`getScript`常规 JavaScript `createElement("script")`，`appendChild()`并使用 JSONP 之类的回调。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T13:55:09.243

JSON 字符串不能包含函数。

JSON 与 JavaScript 对象不同，尽管前者是从后者派生的。最终，它是一个字符串。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T13:55:24.343

您不应该在 JSON 中使用任何回调或函数调用（它不是有效的 JSON，它不安全而且很荒谬 - 如果您以某种方式使其工作，还有最后两件事），总有办法在脚本中做到这一点。

编辑：您真的不需要从 JSON 调用函数 - 请返回“绘图板”并设计应用程序以不使用此模式

# c - 如何从C中的lua访问多维表？

> ID：11471883
> 
> 赞同：1
> 
> 时间：2012-07-13T13:52:47.207
> 
> 标签：c, lua, luac

你好，我真的被这个看似简单的任务难住了。我可以访问传递给 C 函数的表的属性，但不能访问我在其中创建的任何子表的成员。

基本上我希望能够简单地从属性表中提取字符串，这样我就可以根据用户的期望创建一个“轮子”。

这是我到目前为止所拥有的（尝试了这么多我的大脑被炸了）

路亚端：

```
--Function
createSomething( "wheel", { canInflate = true, properties = { "large", "full" } } ) 
```

C面：

```
//I can retrieve any value easily within that table, but cannot seem to extract the table
//Within it named "properties", i can access the table, but cannot extract the strings     inside

if( lua_istable(L, 2) ) {
    lua_getfield(L, 2, "canInflate");  // Let's extract the value for the key 'someKey'. Pushes the value on the top of the stack
    static int canInflate = lua_toboolean(L, -1); // get the value of bool now at the top of stack (index: -1)

    //printf("can inflate is %d\n", canInflate);
    //lua_pop(L, 1); // pop the value now that we are done with it
}

//try to get the properties table
if ( lua_istable(L, 2) ) {
    lua_getfield(L, 2, "properties");

    const char *str = lua_tostring(L, -1);

    printf( "properties 1 = %s\n", str); // NULL

    lua_pop(L, 2);
} 
```

* * *

对此的任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T14:23:39.530

您遇到的问题是如何在 Lua 中指定表：以下 3 条语句的结果完全相同：

```
t = { 'full','large'}
t = { [1] = 'full', [2] = 'large'}
t={};t[1]='full';t[2]='large' 
```

您想要的是使用字符串作为键而不是值（如您的代码和上述示例中所做的那样）：

```
t={full=true,large=true}
-- or 
t={}; t.full=true; t.large=true 
```

如果您使用字符串作为键，您的 C 代码应该可以工作。

# android - 需要帮助 android Json 货币转换器

> ID：11471884
> 
> 赞同：-2
> 
> 时间：2012-07-13T13:52:47.937
> 
> 标签：android, json

我有一个项目要求我构建一个货币转换器，我已经搜索了谷歌并获得了一些可以给我参考的资源，但是当我点击计算时我卡住了它不会将 textview 更改为货币汇率..

我使用 json，这是网站

```
http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20yahoo.finance.xchange%20where%20pair%20in%20%28%22USDSGD%22%29&format=json&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys&callback= 
```

这是一些代码

```
 calculate.setOnClickListener(new OnClickListener(){
    public void onClick(View v) {
         TextView texts = (TextView) findViewById(R.id.textView3);

        try {
        s = getJson("http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20yahoo.finance.xchange%20where%20pair%20in%20(%22"+val[from]+val[to]+"%22)&format=json&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys&callback=");
        JSONObject jObj;
        jObj = new JSONObject(s);
        String theResult = jObj.getJSONObject("query").getJSONObject("results").getJSONObject("rate").getString("Rate");

         texts.setText(theResult);
        } 

        catch (JSONException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
        }
        catch (ClientProtocolException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
        } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
        }
        }
        } 
```

val[from]+val[to] 来自我的微调器，我有 2 个微调器

getJson 代码

```
 public String getJson(String url)throws ClientProtocolException, IOException {
            StringBuilder build = new StringBuilder();
            HttpClient client = new DefaultHttpClient();
            HttpGet httpGet = new HttpGet(url);
            HttpResponse response = client.execute(httpGet);
            HttpEntity entity = response.getEntity();
            InputStream content = entity.getContent();
            BufferedReader reader = new BufferedReader(new InputStreamReader(content));
            String con;
            while ((con = reader.readLine()) != null) {
            build.append(con);
            }
            return build.toString();
            } 
```

请帮助我..这段代码的错误在哪里我已经尝试编辑并且什么也没得到..仍然当我点击按钮时它没有给我textview的价值

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T14:37:33.113

我尝试了一个转换数据并将其显示在文本视图中的活动

```
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;

import org.apache.http.HttpEntity;
import org.apache.http.HttpResponse;
import org.apache.http.client.ClientProtocolException;
import org.apache.http.client.HttpClient;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.impl.client.DefaultHttpClient;
import org.json.JSONException;
import org.json.JSONObject;

import android.app.Activity;
import android.app.ProgressDialog;
import android.os.AsyncTask;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;
import android.widget.TextView;

public class CurrencyActivity extends Activity {

    private TextView texts;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        setContentView(R.layout.test);

        Button button = (Button) findViewById(R.id.calculateCmd);
        button.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) {
                new DownloadData().execute();
            }
        });

        texts = (TextView) findViewById(R.id.txtCurrency);

    }

    public String getJson(String url) throws ClientProtocolException,
            IOException {
        StringBuilder build = new StringBuilder();
        HttpClient client = new DefaultHttpClient();
        HttpGet httpGet = new HttpGet(url);
        HttpResponse response = client.execute(httpGet);
        HttpEntity entity = response.getEntity();
        InputStream content = entity.getContent();
        BufferedReader reader = new BufferedReader(new InputStreamReader(
                content));
        String con;
        while ((con = reader.readLine()) != null) {
            build.append(con);
        }
        return build.toString();
    }

    class DownloadData extends AsyncTask<Void, Integer, String> {

        ProgressDialog pd = null;

        @Override
        protected void onPreExecute() {
            super.onPreExecute();
            pd = new ProgressDialog(CurrencyActivity.this);
            pd.setTitle("Converting...");
            pd.setMessage("Please wait...");
            pd.setCancelable(false);
            pd.show();

        }

        @Override
        protected String doInBackground(Void... params) {

            String s;
            String theResult = "";
            try {
                s = getJson("http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20yahoo.finance.xchange%20where%20pair%20in%20(%22USDSGD%22)&format=json&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys&callback=");
                JSONObject jObj;
                jObj = new JSONObject(s);
                theResult = jObj.getJSONObject("query")
                        .getJSONObject("results").getJSONObject("rate")
                        .getString("Rate");

                System.out.println(theResult);
            }

            catch (JSONException e) {
                e.printStackTrace();
            } catch (ClientProtocolException e) {
                e.printStackTrace();
            } catch (IOException e) {
                e.printStackTrace();
            }

            return theResult;
        }

        @Override
        protected void onPostExecute(String theResult) {
            super.onPostExecute(theResult);
            pd.dismiss();

            System.out.println("theResult:" + theResult);
            texts.setText(theResult);
        }
    }

} 
```

我使用的布局 xml 文件

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

    <LinearLayout
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerInParent="true"
        android:orientation="vertical" 
        android:gravity="center"
        >

        <Button
            android:id="@+id/calculateCmd"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Calculate" />

        <TextView
            android:id="@+id/txtCurrency"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Income" >
        </TextView>
    </LinearLayout>

</RelativeLayout> 
```

用您的微调器中的值替换 URL，并在您的情况下使用 DownloadData AsyncTask

# android - 自定义 android NuPlayer 以包含在 Android 应用程序中

> ID：11471885
> 
> 赞同：2
> 
> 时间：2012-07-13T13:52:48.480
> 
> 标签：android, android-ndk, android-build

## 问题：

自定义 Android 原生组件以包含在 Android 应用程序中的建议方法是什么？“原生组件”是指在 AOSP 中提供原生源代码但使用 NDK 文档中未公开的 API 的组件。

* * *

### 细节：

我想使用简化版的 Android 媒体框架（实际上，我只需要 NuPlayer 来为我的应用播放 RTSP 流）。我知道这种定制涉及使用来自 AOSP 的本机代码（框架/基础/媒体），修改我需要的内容；并根据我的需要构建它以生成 .so 文件。然后我做了一个`System.loadLibrary()`加JNI。

我的问题是 - 建议的方法是什么？

我不能使用 NDK（相反，我不应该使用 NDK），因为媒体框架中使用的许多 API 都没有暴露给 NDK。但是，如何构建我修改后的媒体框架代码？我确实`Android.mk`在那里看到了文件。我用什么来构建这些？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T21:33:45.293

您的问题是自相矛盾的：您想*自定义 Android 的原生组件*，而不*使用 NDK*。NDK 代表 Native Development Kit：我听说没有人在不使用 Native Development 工具的情况下开发原生组件。而NDK是最容易使用的......

恕我直言，你真正的问题在于这句话：*我不能使用 NDK（相反，我不应该使用 NDK）*。在这里我问：为什么？

# c# - 导航到 DNN 模块

> ID：11471886
> 
> 赞同：0
> 
> 时间：2012-07-13T13:52:51.700
> 
> 标签：c#, url, dotnetnuke, dotnetnuke-module, navigateurl

我正在编写一份时事通讯，其中包含指向我的 DNN 网站中各种 html 模块的链接。我可以访问他们的每个 ModuleID，我想用它来获取 url。当前的方法（由第三方开发人员制作）有效，但只是在一定程度上。当模块位于网站更深处时，url 的格式不正确。

例如，位于 www.website.com/website/articles.aspx 的模块可以正常工作，但位于 www.website.com/website/articles/subarticles.aspx 的模块不能。我知道这是因为 url 格式不正确。

这是当前代码：

```
DotNetNuke.Entities.Modules.ModuleController objModCtrlg = new DotNetNuke.Entities.Modules.ModuleController();
DotNetNuke.Entities.Modules.ModuleInfo dgfdgdg = objModCtrlg.GetModule(ContentMID);
TabController objtabctrll = new TabController();
TabInfo objtabinfoo = objtabctrll.GetTab(tabidfrcontent);
string tabnamefremail= objtabinfoo.TabName;
moduletitlefrEmail = dgfdgdg.ModuleTitle;
string readmorelinkpath = basePath + "/" + tabnamefremail + ".aspx"; 
```

ContentMID 是我正在查看的当前模块 ID。我曾尝试使用 Globals.NavigateURL，但总是因`Object reference not set to an instance of an object.`错误而崩溃。我使用时`objtabinfoo.FullUrl`也是如此，所以我目前不知道如何获取特定模块的 URL。

编辑：这里有更多关于如何检索 tabId 的代码。

```
IDictionary<int, TabInfo> dicTabInfo12 = new Dictionary<int, TabInfo>();
ContentMID = Convert.ToInt32(dsNewsList.Tables[0].Rows[i]["ModuleID"]);
dicTabInfo12 = objTabctrl.GetTabsByModuleID(ContentMID);
if (dicTabInfo12.Count > 0)
{
    string tester = ""; //Debug
    foreach (KeyValuePair<int, TabInfo> item1 in dicTabInfo12)
    {
        tabidfrcontent = item1.Key;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T19:19:47.097

如果你有 tabid，你真的应该使用 NavigateUrl 来建立链接，你是金子。

```
string readMoreLinkPath = NavigateUrl(tabidfrcontent); 
```

漂亮又简单

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T12:58:45.823

好的，同事建议这样做，它在调度程序中工作得很好。

```
string linkPath = basePath + "/Default.aspx?TabID=" + tabID; 
```

将导航到正确的选项卡 ID。因此，如果您被迫在`NavigateUrl`没有一些主要变通办法的情况下无法使用的调度程序中工作，这将是最好的解决方案。

# python - wx.ListCtrl 的问题

> ID：11471892
> 
> 赞同：0
> 
> 时间：2012-07-13T13:53:11.947
> 
> 标签：python, wxpython, wxwidgets

这是一个片段

```
 self.list_ctrl = wx.ListCtrl(self, size=(-1,100),
                     style=wx.LC_ICON|wx.LC_ALIGN_LEFT
                     )
    il = wx.ImageList(16,16,True)
    png = wx.ArtProvider.GetBitmap(wx.ART_FILE_OPEN,wx.ART_OTHER, (16,16))
    il.Add(png)
    self.list_ctrl.AssignImageList(il,wx.IMAGE_LIST_NORMAL)

    sizer = wx.BoxSizer(wx.VERTICAL)
    sizer.Add(self.list_ctrl, 0, wx.ALL|wx.EXPAND, 5)
    self.SetSizer(sizer)

    self.list_ctrl.InsertImageStringItem(0,"1",0)
    self.list_ctrl.InsertImageStringItem(1,"2",0) 
```

我的问题是图标出现在文本的顶部，这不应该发生，因为我`wx.LC_ALIGN_LEFT`输入了样式。我希望图标出现在文本的左侧。

另一个问题是，我想要每行一个元素。在我的代码中，它几乎就像每列一个元素。

谁能帮我解决这些问题？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T17:46:43.817

查看 ListCtrl 的 wxPython 演示，看起来他们使用 SetImageList() 而不是 AssignImageList()。不知道有什么区别。我没有看到你在哪里插入任何文本。您需要使用 SetStringItem 将文本放在我所看到的其他列中。

编辑：来自 wxPython 演示包的代码，ListCtrl 演示：

```
self.il = wx.ImageList(16, 16)

self.idx1 = self.il.Add(images.Smiles.GetBitmap())
self.sm_up = self.il.Add(images.SmallUpArrow.GetBitmap())
self.sm_dn = self.il.Add(images.SmallDnArrow.GetBitmap()) 
```

然后我们将数据/图像添加到小部件

```
def PopulateList(self):
    if 0:
        # for normal, simple columns, you can add them like this:
        self.list.InsertColumn(0, "Artist")
        self.list.InsertColumn(1, "Title", wx.LIST_FORMAT_RIGHT)
        self.list.InsertColumn(2, "Genre")
    else:
        # but since we want images on the column header we have to do it the hard way:
        info = wx.ListItem()
        info.m_mask = wx.LIST_MASK_TEXT | wx.LIST_MASK_IMAGE | wx.LIST_MASK_FORMAT
        info.m_image = -1
        info.m_format = 0
        info.m_text = "Artist"
        self.list.InsertColumnInfo(0, info)

        info.m_format = wx.LIST_FORMAT_RIGHT
        info.m_text = "Title"
        self.list.InsertColumnInfo(1, info)

        info.m_format = 0
        info.m_text = "Genre"
        self.list.InsertColumnInfo(2, info)

    items = musicdata.items()
    for key, data in items:
        index = self.list.InsertImageStringItem(sys.maxint, data[0], self.idx1)
        self.list.SetStringItem(index, 1, data[1])
        self.list.SetStringItem(index, 2, data[2])
        self.list.SetItemData(index, key) 
```

# javascript - NodeJS - “这种类型的响应必须没有正文......”

> ID：11471895
> 
> 赞同：0
> 
> 时间：2012-07-13T13:53:26.283
> 
> 标签：javascript, http, node.js

我最近在使用 node.js 编写 Web 应用程序时遇到了一个非常有趣的问题。本质上，我所做的只是将**index.html**页面提供给客户端。

这是代码：

```
var http = require('http');
var url = require('url');
var fs = require('fs');
var util = require('util');

var server = http.createServer(function(req, res){
        var path = url.parse(req.url).pathname;
        if(path == '/'){
            console.log("LOADING INDEX...");
            openIndex(req, res);
            console.log("LOADING COMPLETE.")
        } else {
            res.write("Something went wrong...");
            res.end();
        }
    }
);

var openIndex = function(req, res){
    fs.readFile('./index.html', function(error, content){
        if(error){
            res.writeHead(500);
            res.end();
        }
        else{
            res.writeHead(200, {'Content-Type': 'text/html'});
            res.end(content, 'utf-8');
        }
    });
} 
```

我在**index.html**页面加载前后添加了一些调试语句：*"LOADING INDEX..."*和*"LOADING COMPLETE"*。

现在，我已经与我的 Facebook 朋友分享了我的服务器的链接，这样他们就可以看到我的应用程序。大多数时候，一切正常，但偶尔我会收到此错误：

> 加载索引...
> 
> 这种类型的响应不能有正文。忽略传递给 end() 的数据。

刚才我还得到了：

> 加载索引...
> 
> 这种类型的响应不能有正文。忽略 write() 调用。

**该过程永远不会到达*“加载完成”*语句。**

我试图无数次地重现这一点（在不同的机器、浏览器、设备、操作系统版本上访问我的应用程序），但每次它都能正常工作。我四处寻找有这个问题的其他人，似乎不知何故，身体正在进入 GET 响应？我不完全确定这意味着什么或如何修复我的代码以防止这种情况发生。另外，我不确定产生此错误的客户看到了什么？他们能看到我的应用吗？（即这些只是警告，就他们而言一切都很好？）

对此的任何帮助将不胜感激。

夏安

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T14:00:31.370

如果你只是使用一个 static `index.html`，为什么不使用`express.static`它来自动服务呢？

```
app.use("/index.html", express.static(__dirname + '/index.html')); 
```

这将导致 expressjs 自动处理`HEAD`请求，这应该可以解决您的问题。

# ios - 在 iOS 上，您能否发出同步网络请求（但不在主线程上）并仍然获得进度回调（在单独的非主线程上）？

> ID：11471896
> 
> 赞同：0
> 
> 时间：2012-07-13T13:53:26.037
> 
> 标签：ios, nsurlconnection, grand-central-dispatch

在 iOS 上，您可以发出同步网络请求（在主线程之外）并获得进度回调（在单独的非主线程上）吗？

我有一个串行（一次一个操作）后台队列，它运行所有不需要立即完成的耗时*作业*。不过，我确实想显示下载作业的进度。看起来您不能实例化`NSURLConnection`和配置委托，启动同步连接，然后获取进度回调。

有没有办法在该后台队列上发出同步请求（同步，因为它后面的工作在完成之前不会开始），并且仍然可以获得`setProgress:`可以发送以更新进度条的回调？（回调必须在不同的队列线程上，因为我的串行队列的线程在请求​​完成之前被阻塞。）

[Apple 的 NSURLConnection 文档](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/nsurlconnection_Class/Reference/Reference.html)说，同步请求实际上是建立在幕后的异步之上。我必须重新实现吗？我需要一种方法来阻止线程，直到请求完成/失败。到目前为止，我最好的线索是`NSOperationQueue`'s `waitUntilFinished`方法，但我不想启动异步并不断轮询同步方法。

> **NSURLConnection 讨论**
> 
> 同步加载建立在类提供的异步加载代码之上。当异步加载系统在专门为此加载请求生成的线程上执行 URL 加载时，调用线程被阻塞。为了执行同步加载，调用线程中不需要特殊的线程或运行循环配置。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-13T14:03:49.870

在异步请求之上重新实现同步请求并不难。您只需要手动旋转线程的运行循环，直到您看到请求已完成（或失败）。这是一个粗略的例子：

```
NSURLRequest *downloadRequest = [NSURLRequest requestWithURL:queryURL];
// Start the download and wait until it finishes
self.downloadFinished = NO;
self.downloader = [NSURLConnection connectionWithRequest:downloadRequest delegate:self];

while (!self.isDownloadFinished)
 {
    [[NSRunLoop currentRunLoop] runMode:NSDefaultRunLoopMode beforeDate:[NSDate distantFuture]];
 } 
```

以下是相关的 NSURLConnectionDelegate 方法：

```
 - (void)connectionDidFinishLoading:(NSURLConnection *)connection;
 {
    self.downloadFinished = YES;
 }

 - (void)connection:(NSURLConnection *)connection didFailWithError:(NSError *)error;
 {
    NSLog(@"An error occurred: %@", error);
    self.receivedData = nil;
    self.downloadFinished = YES;
 } 
```

# css - 为什么我的页脚没有粘住？

> ID：11471901
> 
> 赞同：0
> 
> 时间：2012-07-13T13:54:03.687
> 
> 标签：css, footer, sticky-footer

我正在重新做我的网站 - 当我有时间时，它正在构建 - 我对页脚的四个页面中的两个有一点问题 - 我不太确定为什么它不起作用，因为它似乎在两个页面上都可以正常工作。我正在使用这里的技术：（ryanfait.com/resources/footer-stick-to-bottom-of-page/）

我在我的 CSS 中使用这些值：

```
 /* BOTTOM BAR */

.wrapper {
    min-height: 100%;
    height: auto !important;
    height: 100%;
    margin: 0 auto -122px;
}

.push, .footer {
    clear: both;
    width: 100%;
    height: 122px;
}

.footer {
    text-align: right;
    padding-right: 0px;
    padding-left: 0px;
    clear:both;
    background-color: #2e2e2e;
    -moz-box-shadow: 0px -1px 0px rgba(0,0,0,0.1), inset 0px 1px 0px rgba(255,255,255,0.6);
    -webkit-box-shadow: 0px -1px 0px rgba(0,0,0,0.1), inset 0px 1px 0px rgba(255,255,255,0.6);
    box-shadow: 0px -1px 0px rgba(0,0,0,0.1), inset 0px 1px 0px rgba(255,255,255,0.6);
    border-top:1px solid #36383D;
}

.bottom_content {
    width: 900px;
    margin-left:auto;
    margin-right:auto;
    padding-top: 25px;
    border: 0px;
}

.copywrite {
    float: left;
    text-align: left;
    padding:0px;
    margin-top: 0px;
    clear: both;
    font-family: Helvetica, Arial;
    font-size:24px;
    font-weight:300;
    color: #3c3e43; 
} 
```

*   它在这里工作正常：http: [//bit.ly/MlV6JP](http://bit.ly/MlV6JP)

但不在此处：[http](http://bit.ly/NfVoRR) : //bit.ly/NfVoRR 或关于页面 (/test/test_about.php)

我尝试了许多不同的方法，但都没有成功！开始用它把我的头发扯掉一点，所以任何建议都将不胜感激

编辑 - 这是我所看到的：[jameshenry.info/test/BottomExamples.png](http://jameshenry.info/test/BottomExamples.png)我在 chrome、safari 和 safari iOS 中看到了这个。我希望它始终位于页面底部，位于页面内容下方。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T15:33:12.697

问题在于您的 HTML。

以下是源代码中嵌套不良标签的示例：

```
<a class="fancybox-thumb" rel="gallery" href="../images/photography/fullsize/MVI_4003-2.jpg" width="249" height="148"><img src="../images/photography/thumbnail/MVI_4003-2-thumb.jpg"></div></a> 
```

如您所见，您的锚点中有一个不应该存在的结束 div 标签。修复这些类型的错误，您的页脚应该可以按预期工作。

# css - 在 Firefox 中单击输入时如何防止占位符隐藏？

> ID：11471903
> 
> 赞同：0
> 
> 时间：2012-07-13T13:54:06.550
> 
> 标签：css, html, firefox, placeholder

我需要一些有关 Firefox 浏览器问题的帮助吗？

我有一个占位符的输入：

```
<input id="contact_lastname" type="text" value="" name="contact_lastname" size="45" placeholder="Type your last name" style="-moz-user-select: none; -moz-user-input: disabled; -moz-user-modify: read-only;" autocomplete="off"> 
```

只有在 Firefox 中，当我单击该输入框时，占位符才会消失，然后才会出现不可选择的部分。是否有某种方法可以禁用该 html5 事件，实际上每次单击不可选择的输入时都会隐藏占位符？

我已经尝试过这些 CSS 值：

```
-moz-user-input: disabled
-moz-user-modify: read-only
-moz-user-select: none
user-select: none 
```

我缺一个吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T13:58:45.453

在输入字段上：

```
disabled="disabled" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T06:32:35.293

问题不是占位符消失的事实，而是点击离开时没有回来的事实。我已将其更改为实际上是这样工作的：

```
<script type="text/javascript">
$.fn.disableSelection = function () {
        return this.each(function () {
            if ( $.browser.mozilla ) // Firefox
            {
                $(this).attr('autocomplete', 'off');
                $(this).keydown(function() { return false; });
                $(this).css('MozUserModify', 'read-only');
            }
            else if ( $.browser.webkit ) // Chrome
            {
                $(this).attr('autocomplete', 'off');
                $(this).css('webkitUserModify', 'read');
                $(this).keydown(function() { return false; });
            }
            else if ( $.browser.msie ) // IE
            {
                $(this).keydown(function() { return false; });
            }
            else // Opera, etc.
            {
                $(this).mousedown(function() { return false; });
            }
        });
    };
</script> 
```

这实际上会阻止用户输入数据（这是最初的问题集），然后在触发 keydown 事件时返回 false。

# javascript - 如何捕捉视频的 ExitFullScreen 事件？

> ID：11471919
> 
> 赞同：3
> 
> 时间：2012-07-13T13:54:35.010
> 
> 标签：javascript, html, webkit, android-browser

如何捕捉视频的 ExitFullScreen 事件？当我退出标签视频的全屏时，我需要重新绘制页面。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-13T15:29:50.823

收听`fullscreenchange`事件：

```
document.addEventListener("fullscreenchange", function () {
    console.log(document.fullscreen);
}, false);
document.addEventListener("mozfullscreenchange", function () {
    console.log(document.mozFullScreen);
}, false);
document.addEventListener("webkitfullscreenchange", function () {
    console.log(document.webkitIsFullScreen);
}, false); 
```

# wpf - 如何最小化/最大化功能区

> ID：11471920
> 
> 赞同：3
> 
> 时间：2012-07-13T13:54:42.410
> 
> 标签：wpf, ribbon, minimize, maximize

我将功能区用于 WPF (2010 - `Microsoft.Windows.Controls.Ribbon`)。我想创建一个按钮，最小化或最大化功能区选项卡，就像在 msoffice 中这个按钮：

![在此处输入图像描述](../Images/74b754c60a64e59c940d453f65aae4e5.png)

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T21:25:25.863

只需访问功能区的**IsMinimized**属性即可最小化/最大化。

# php - 提交更改我的路线的操作

> ID：11471921
> 
> 赞同：0
> 
> 时间：2012-07-13T13:54:47.400
> 
> 标签：php, zend-framework, submit, routes

我的页面中有一个表格，当我发送此表格时，我的路线会自动更改。

一个例子：

我的正常路线：登录/尝试

路线更改：登录/尝试/email_ak/brian.rno%40gmail.com/submit_ak/Enviar

但不是我当前的路线，页面上的各个链接是否已更改。

有人知道我可以如何删除它吗？

# php - Php Xpath - 如何在子节点中获取两个信息

> ID：11471922
> 
> 赞同：2
> 
> 时间：2012-07-13T13:54:47.437
> 
> 标签：php, xpath

如何在 xpath 中获取以下信息？

文本 01 - link_1.com

文本 02 - link_2.com

```
$page = '
<div class="news">
<div class="content">
    <div>
    <span class="title">Text 01</span>
    <span class="link">link_1.com</span>
    </div>
</div>
<div class="content">
    <div>
    <span class="title">Text 02</span>
    <span class="link">link_2.com</span>
    </div>
</div>
</div>';
@$this->dom->loadHTML($page);
$xpath = new DOMXPath($this->dom);

// perform step #1
$childElements = $xpath->query("//*[@class='content']");
$lista = '';
foreach ($childElements as $child) {
    // perform step #2
    $textChildren = $xpath->query("//*[@class='title']", $child);
    foreach ($textChildren as $n) {
        echo $n->nodeValue.'<br>';
    }

    $linkChildren = $xpath->query("//*[@class='link']", $child);
    foreach ($linkChildren as $n) {
        echo $n->nodeValue.'<br>';
    }
} 
```

我的结果正在返回

文字 01

文字 02

链接_1.com

链接_2.com

文字 01

文字 02

链接_1.com

链接_2.com

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-13T13:58:02.690

在第二个和第三个 xpath 中替换`//`为`descendant::`，因为`//`告诉 xpath 在 xml 中的任何位置而不是在特定节点中搜索此元素（根据您的需要），并且 $child 不是单独的 XML。`descendat::`表示任何子节点

```
@$this->dom->loadHTML($page);
$xpath = new DOMXPath($this->dom);

// perform step #1
$childElements = $xpath->query("//*[@class='content']");
$lista = '';
foreach ($childElements as $child) {
    // perform step #2
    $textChildren = $xpath->query("descendant::*[@class='title']", $child);
    foreach ($textChildren as $n) {
        echo $n->nodeValue.'<br>';
    }

    $linkChildren = $xpath->query("descendant::*[@class='link']", $child);
    foreach ($linkChildren as $n) {
        echo $n->nodeValue.'<br>';
    }
} 
```

# iphone - 将更多设备添加到 iOS 开发者帐户

> ID：11471925
> 
> 赞同：6
> 
> 时间：2012-07-13T13:55:06.393
> 
> 标签：iphone, ios

在我们的办公室，我们使用开发者帐户注册设备，众所周知，使用开发者帐户我们每年只能添加 100 台设备，我们已经使用了 90 台。我们只有 10 台设备，还有 6 个月的续订日期。谁能指导我，我应该购买一个新的开发者帐户还是有可能在我的当前帐户中添加更多设备？非常感谢任何帮助。谢谢！问候， P. Arun Ganesh

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T14:03:42.793

根据我的经验，Apple 有时会延长 100 台设备/年的限制。给他们打电话。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-13T14:08:54.057

开发设备仅用于开发和测试您的应用程序。这不是分发您的应用程序的一种方式，尤其是不分发给客户。而且一旦你在苹果注册了一个开发设备，即使你从你的配置门户中删除它，它仍然会计入你的 100，所以请小心。

你要做的就是联系 Apple，告诉他们你确实需要 100 多台开发设备，看看他们能不能给你更多。

# c - 如何等待启动线程执行初始化代码

> ID：11471930
> 
> 赞同：4
> 
> 时间：2012-07-13T13:55:16.987
> 
> 标签：c, multithreading, synchronization, pthreads

我无法将主线程同步到最近启动的子线程。

我想做的是：

*   主线程创建一个新的子线程并阻塞
*   子线程启动并初始化（可能需要一些时间）
*   一旦子线程被初始化，主线程继续（并且两个线程并行运行）

我的第一次尝试是这样的：

```
 typedef struct threaddata_ {
    int running;
  } threaddata_t;

  void*child_thread(void*arg) {
    threaddata_t*x=(threaddata_t)arg;
    /* ... INITIALIZE ... */
    x->running=1; /* signal that we are running */

    /* CHILD THREAD BODY */

    return 0;
  }

  void start_thread(void) {
    threaddata_t*x=(threaddata_t*)malloc(sizeof(threaddata_t));
    x->running=0;
    int result=pthread_create(&threadid, 0, child_thread, &running);
    while(!x->running) usleep(100); /* wait till child is initialized */

    /* MAIN THREAD BODY */
  } 
```

现在我根本不喜欢这个，因为它迫使主线程睡眠的时间可能比必要的更长。所以我做了第二次尝试，使用互斥锁和条件

```
 typedef struct threaddata_ {
    pthread_mutex_t x_mutex;
    pthread_cond_t  x_cond;
  } threaddata_t;

  void*child_thread(void*arg) {
    threaddata_t*x=(threaddata_t)arg;
    /* ... INITIALIZE ... */

    pthread_cond_signal(&x->x_cond); /* signal that we are running */

    /* CHILD THREAD BODY */

    return 0;
  }

  void start_thread(void) {
    threaddata_t*x=(threaddata_t*)malloc(sizeof(threaddata_t));
    pthread_mutex_init(&x->x_mutex, 0);
    pthread_cond_init (&x->x_cond , 0);

    pthread_mutex_lock(&x->x_mutex);
    int result=pthread_create(&threadid, 0, child_thread, &running);
    if(!result)pthread_cond_wait(&x->x_cond, &x->x_mutex);
    pthread_mutex_unlock(&x->x_mutex);

    /* MAIN THREAD BODY */
  } 
```

This seemed more sane than the first attempt (using proper signals rather than rolling my own wait loop), until I discovered, that this includes a race condition: If the child thread has finished the initialization fast enough (before the main thread waits for the condition), it will deadlock the main thread.

I guess that my case is not so uncommon, so there must be a really easy solution, but I cannot see it right now.

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-13T14:07:43.493

Proper way of condvar/mutex pair usage:

```
bool initialised = false;
mutex mt;
convar cv;

void *thread_proc(void *)
{
   ...
   mt.lock();
   initialised = true;
   cv.signal();
   mt.unlock();
}

int main()
{
   ...
   mt.lock();
   while(!initialised) cv.wait(mt);
   mt.unlock();
} 
```

This algorithm avoids any possible races. You can use any complex condition modified when mutex locked (instead of the simple !initialised).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-13T14:01:49.853

The correct tool for that are `sem_t`. The `main` thread would initialize them with `0` and wait until it receives a token from the newly launched thread.

BTW your mutex/cond solution has a race condition because the child thread is not locking the mutex.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-13T17:34:24.347

A barrier should do the trick nicely. Since you mention the need for support on Win32 in comments, barriers are supported on the latest Win32 pthreads, so you shouldn't have to write your own wrapper to get some portability between Win32 and *nix.

Something like:

```
typedef struct threaddata_ {
    pthread_barrier_t* pbarrier;
} threaddata_t;

void* child_thread(void*arg) {
    threaddata_t*x=(threaddata_t*)arg;
    /* ... INITIALIZE ... */

    int result = pthread_barrier_wait(x->pbarrier);

    /* CHILD THREAD BODY */

    return 0;
}

void start_thread(void) {
    pthread_barrier_t barrier;
    int result = pthread_barrier_init(&barrier, NULL, 2);

    threaddata_t*x=(threaddata_t*)malloc(sizeof(threaddata_t));
    x->pbarrier = &barrier;

    int result=pthread_create(&threadid, 0, child_thread, &x);

    result = pthread_barrier_wait(&barrier);
    /* child has reached the barrier */

    pthread_barrier_destroy(&barrier);  /* note: the child thread should not use    */
                                        /* the barrier pointer after it returns from*/
                                        /* pthread_barrier_wait()                   */

    /* MAIN THREAD BODY */
} 
```

The drawback to this solution is that it may needlessly blocks the child thread momentarily. If that's a problem, the [condition variable solution mentioned by Dmitry Poroh](https://stackoverflow.com/a/11472124/12711) is the way to go.

# c++ - transform_primary() 和 collat e_byname()

> ID：11471932
> 
> 赞同：24
> 
> 时间：2012-07-13T13:55:28.400
> 
> 标签：c++, c++11, locale

为了给出我正在谈论的内容，以下程序`true`在使用 clang++/libc++ 编译时正确打印

```
#include <iostream>
#include <regex>
int main()
{
    std::locale::global(std::locale("en_US.UTF-8"));
    std::wstring str = L"AÀÁÂÃÄÅaàáâãäå";
    std::wregex re(L"[[=a=]]*", std::regex::basic);
    std::cout << std::boolalpha << std::regex_match(str, re) << '\n';
} 
```

但是，我不太明白`std::regex_traits::transform_primary()`标准中的描述（通过它`[=a=]`来处理）。引用 28.7[re.traits]/7：

> 如果`typeid(use_facet<collate<charT> >) == typeid(collate_byname<charT>)`返回的排序键的形式`collate_byname<charT>::transform(first, last)`已知并且可以转换为主排序键，则返回该键，否则返回空字符串。

最初的[提案](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2003/n1429.htm)解释说，该标准`regex_traits::transform_primary()`只有`collate`在用户没有替换灌输语言环境中的方面时才有效（这是它知道如何将结果转换为`collate::transform()`等价键的唯一方法）。

我的问题是，`typeid`标准中的比较应该如何确保这一点？这是否意味着系统提供的所有方面都从`use_facet`具有`_byname`真正动态类型的语言环境中提取出来？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-21T18:39:01.593

“我的问题是，标准中的 typeid 比较应该如何确保这一点？这是否意味着所有系统提供的方面都从具有 use_facet 的语言环境中拉出，都将 _byname 作为其真正的动态类型？”

要回答您问题的前半部分，typeid 比较可以确保这一点，因为如果用户使用不同的值实例化模板`use_facet`，则 typeid 比较将失败。如果 typeid 匹配，将保证要分派的函数不会被用户覆盖。因此，您将获得系统 collat​​e_byname 类，并且将调用正确的转换。

要回答您问题的第二部分，它确实意味着与正则表达式预期使用的语言环境相关的所有系统提供的方面都符合此实现要求。在同一个文档的前面找到您从其中提取引用的参考 28.7

> 另请注意，没有可移植的方式来根据 std::locale 实现 transform_primary，因为即使 std::collat​​e_byname<>::transform 返回的排序键格式是已知的并且可以转换为主排序键，用户仍然可以将他们自己的自定义 std::collat​​e 实现安装到使用的语言环境对象中，并且可以使用他们认为合适的任何排序键格式。因此，transform_primary 成员函数更多地用于自定义特征类，并且如果它无法针对特定语言环境实现，则应该抛出异常。

简而言之，这告诉我们，如果该类型/typeid 的值不是预期的（即系统提供的）值，则结果可能是不可预测的，因为用户可以提供不同的排序键格式。通过坚持系统提供的值，该方面的 typeid 将是已知的，因此排序键将是已知的和可预测的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-15T22:42:41.887

这现在是[LWG 问题 #2338](http://cplusplus.github.io/LWG/lwg-active.html#2338)，我将使用分辨率更新答案。

# input - 输入浮动的自动边距

> ID：11471935
> 
> 赞同：1
> 
> 时间：2012-07-13T13:55:38.327
> 
> 标签：input, width, margin, fill

```
<div style="width:500px">
<input type="text"><input type="text"><input type="text">
</div> 
```

输入的宽度为 31%，我会的，它们以 100% 填充父 div。前两个输入的自动边距。像这样：

![在此处输入图像描述](../Images/73d29ae16530c1d2f9ce4a00ba109db3.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T14:03:11.283

请看下面的代码。

```
<div class="container">
<input type="text"><input type="text"><input type="text">
</div>

<style type="text/css">
.container {width:500px;}
.container input {width:30%;}
.container input:first-child {margin-right:5%;}
.container input:last-child {margin-left:5%;}
</style> 
```

# c# - 便携式图书馆服务参考

> ID：11471937
> 
> 赞同：0
> 
> 时间：2012-07-13T13:55:44.223
> 
> 标签：c#, wcf, portable-class-library

我创建了一个 WCF 服务和一个可移植类库。我添加了对图书馆服务的服务引用。我注意到它只生成异步方法。经过进一步检查，创建服务引用对话框高级选项中的某些选项被禁用。访问级别（默认为 public ）和“允许生成异步操作”等选项

这是可移植类库中的限制吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T20:30:18.543

我相信只有异步的限制是因为可移植库可以针对不支持非异步代码的 Silverlight。访问级别可能相似。

# sql - SQL - 仅在数据集更改时提交

> ID：11471939
> 
> 赞同：0
> 
> 时间：2012-07-13T13:55:51.607
> 
> 标签：sql, commit

我正在从网站上提取一些数据，并希望将其写入 sql-db。

```
14:30 Data_1
14:31 Data_1
14:32 Data_1
14:33 Data_2 
```

大多数时候数据是静态的，所以我只在数据更改时提交。

```
14:30 Data_1
14:33 Data_2 
```

问题是我确实错过了数据集更改之前的最后一个时间戳：

```
14:30 Data_1
14:32 Data_1
14:33 Data_2 
```

有没有一种优雅的方法可以在 sql 中执行此操作？

现在我使用以下代码：

```
sql = """
INSERT INTO c2g (time, data1, data2, lat, lon, city, geom)
SELECT %(time)s, %(data1)s, %(data2)s, %(lat)s, %(lon)s, %(city)s, st_setsrid(st_makepoint( %(lon)s, %(lat)s), 4326)
WHERE NOT EXISTS
(SELECT 1 FROM c2g WHERE data1= %(data1)s AND lat = %(lat)s AND lon = %(lon)s AND data2= %(data2)s);
""" 
```

它工作正常，但结果并不完全是我需要的:(

# java - java : Using Static Method for obtaining Database Connection

> ID：11471946
> 
> 赞同：6
> 
> 时间：2012-07-13T13:56:26.270
> 
> 标签：java, static, static-methods

I am working on an existing Java EE based application. This features the following method for connecting to a database :

```
public static java.sql.Connection connectionToDataBase(String jndiName,boolean flag)throws Exception 
{
DataSource ds =(javax.sql.DataSource) initCtx.lookup(jndiName);
return ds.getConnection();
    } catch (NamingException ne) {
            throw ne;
        } finally {
            try {
                if (initCtx != null)
                    initCtx.close();
            } catch (NamingException ne) {

                throw ne;
            }
        }
} 
```

My question is whether using a static method for connecting to a database is correct?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T14:06:13.777

Why have you defined the function as static?

It is not incorrect nor is there any convention that would prohibit you in calling a static method from a non-static one. By definition, a non-static method belongs to an instance of the class, whereas a static method belongs to the class itself.

Having a static method simply means you don't need an instance of the class to connect to the DB.

To answer your question, you probably want to consider what the class encapsulates. Do you *only* want an *instance* of the class to be able to connect to the DB? Or would you like to be able to connect to the DB *without a reference to an instance* of the class?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T14:15:45.280

If you **can** use a Connection-Pool or an Entity-Manager you better use them!

# android - 当 listview 开始加载新数据时，滚动挂起它既不向上也不向下，直到数据被加载。？

> ID：11471949
> 
> 赞同：-1
> 
> 时间：2012-07-13T13:56:32.830
> 
> 标签：android, listview, scrollbar

当我的列表视图开始加载新数据时，滚动挂起它既不会向上也不会向下，直到数据被加载。有没有办法解决这个问题？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T15:08:21.980

您可以在单独的线程上执行数据获取任务并在处理程序中更新 ListView。

参考这个——

[http://negativeprobability.blogspot.in/2011/08/lazy-loading-of-images-in-listview.html](http://negativeprobability.blogspot.in/2011/08/lazy-loading-of-images-in-listview.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T14:00:45.497

在 AsyncTask `onPostExecute`和`onPreExecute`.

*从onPreExecute*开始并在*onPostExecute*中停止

 **下载完成后，在adapter* & use中设置新数据`notifyDataSetChanged`，将此代码放入*onPostExecute**

# nfc - NFC用作mifare，可以吗？

> ID：11471952
> 
> 赞同：6
> 
> 时间：2012-07-13T13:56:44.080
> 
> 标签：nfc, mifare

我们有一个 mifare 卡系统，并且正在研究在手机中使用 NFC 芯片作为 mifare 卡的可能性。

我对 NFC 进行了一些研究，但我无法回答的问题是手机中的 NFC 芯片是否有一个我可以像 mifare 卡一样读取的唯一标识符？

此外，如果 NFC 芯片有唯一代码，我可以使用 NFC 阅读器读取它，还是需要手机上的应用程序将其置于卡模拟模式？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2014-08-08T03:55:17.500

我为一家大型机构工作，并提出了同样的问题。总而言之，我能够成功模拟 mifare 经典芯片（我们的身份证）并获得对所有设施的访问权限，就好像我在使用我的身份证（lenel 访问控制）一样。然而，最终解决方案是一个黑客半。只有配备 NXP NFC 控制器的设备才能实现这一点。此外，我必须修改 nfc_access.xml（将文件系统重新挂载到 rw）系统文件并包含应用程序的签名。然后使用反射，启用 mifare 仿真。然后使用 mifare 读/写器（hid 6055b），我将数据（扇区和块，在我的例子中为扇区 1）编码到手机上。从本质上讲，我将手机视为一张 mifare 身份证。也就是说，我把我的身份证复制到了手机上。您不能以编程方式设置它。

恩智浦拥有mifare。Mifare 高于 iso14443 第 3 部分规范，并实现了专有通信协议。该协议仅在同样归 NXP 拥有的安全元件中实施。这就是为什么配备了 Broadcomm 芯片组的设备无法读取 mifare（例如 nexus 5）。

虽然我证明了它是可行的，但它在生产上是不可行的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-13T14:41:11.437

手机可以在安全元件中模拟某些芯片卡，但这是一个有点困难的过程，并且无法通过普通的 SDK 获得（参见例如[此处](https://stackoverflow.com/questions/9361764/how-to-store-android-application-data-on-sim-card-using-nfc/9364030#9364030) 或[此处](https://stackoverflow.com/questions/9340101/is-card-emulation-supported-in-android-with-nfc)）。

请注意，主要问题不是缺少 Android 支持，而是访问安全元素背后的安全程序。

由于手机无法模拟芯片卡，因此您可以选择手机和读卡器之间的点对点通信。唯一标识符可以保存在手机内存中 - 为确保它是您的标识符，必须进行数字签名。

如果您需要保护它免于克隆（即有人无法将其复制到其他手机），那么它会变得更加困难，并且永远不会像 Mifare 那样安全。

BR 斯坦

# php - apache PHP 内存使用如何真正起作用？

> ID：11471959
> 
> 赞同：16
> 
> 时间：2012-07-13T13:57:09.873
> 
> 标签：php, memory, process, apache2

给出一些背景：

我最近和一位同事讨论了在 PHP 中使用 Autoloaders。我支持他们，他反对。

我的观点是，自动加载器可以帮助您最大限度地减少手动源依赖，这反过来可以帮助您减少在包含大量您可能不需要的大文件时消耗的内存量。

他的回答是，包含您不需要的文件不是一个大问题，因为在包含文件后，一旦它被 Apache 子进程保存在内存中，这部分内存将可用于后续请求。他认为您不应该担心包含文件的数量，因为它们很快就会全部加载到内存中并按需从内存中使用。因此，内存不是问题，尝试在文件系统上查找所需文件的开销更令人担忧。

他是个聪明人，而且往往知道他在说什么。但是，我一直认为 Apache 和 PHP 使用的内存是特定于正在处理的特定请求的。每个请求都分配了一个等于 memory_limit PHP 选项的内存量，并且任何源代码编译和处理仅在请求的生命周期内有效。

即使使用诸如 APC 之类的操作码缓存，我认为单个请求仍然需要将每个文件加载到它自己的内存部分中，并且 APC 只是为响应进程预编译它的捷径。

我一直在搜索这方面的一些文档，但到目前为止还没有找到任何东西。如果有人可以向我指出有关此主题的任何有用文档，我将不胜感激。

**更新：**

只是为了澄清一下，自动加载器讨论部分更多的是上下文:)。

可能还不清楚，但我的主要问题是关于 Apache 是否会将其资源集中在一起以响应多个请求（尤其是包含文件使用的内存），或者每个请求是否需要检索满足执行路径所需的代码与从同一进程处理的其他请求隔离。

例如：文件 1、2、3 和 4 大小相同，均为 100KB。请求 A 包括文件 1、2 和 3。请求 B 包括文件 1、2、3 和 4。

在他的脑海中，他认为请求 A 将在整个执行过程中消耗 300KB，而请求 B 只会再消耗 100KB，因为文件 1,2 和 3 已经在内存中。

在我看来，它是 300KB 和 400KB，因为它们都是独立处理的（如果通过相同的进程）。

这让他回到了他的论点，即“只包括很多，因为无论如何你都会使用它”，而不是我的“只包括你需要减少请求大小的东西”。

这对于我如何构建 PHP 网站是相当基础的，所以我很想知道我是否在这里偏离了目标。

我也一直相信，对于大型网站来说，内存是最宝贵的资源，而且比文件系统检查可能被内核缓存的自动加载器更值得关注。

不过，您是对的，是时候进行基准测试了！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T14:21:21.160

以下是你赢得争论的方法：运行现实的基准测试，并站在数字的右边。

我也有同样的讨论，所以我尝试了一个实验。使用 APC，我尝试了一个带有单个整体包含（包含所有 Kohana）以及标准自动加载器的 Kohana 应用程序。最终结果是，单个包含以统计上不相关的速率（小于 1%）更快，但使用的内存略多（根据 PHP 的内存函数）。在没有 APC（或 XCache 等）的情况下运行测试是没有意义的，所以我没有打扰。

所以我的结论是继续使用自动加载，因为它使用起来更简单。在您的应用中尝试相同的操作并向您的朋友展示结果。

现在你不需要猜测了。

免责声明：我没有使用 Apache。我不能强调在自己的应用程序上在自己的硬件上运行自己的基准测试。不要相信我的经验会是你的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-13T14:11:06.377

你是更聪明的忍者，蚱蜢。

在请求类之前，自动加载器不会加载类文件。这意味着它们最多将使用与手动包含的相同数量的内存，但通常要少得多。

即使 apache 线程可以处理多个请求，每个请求也会从文件中重新读取类，因此您的朋友“最终全部被读取”并不成立。

您可以通过添加 echo 'foo' 来证明这一点；在类文件中的类定义之上。无论您是在启动时自动加载还是手动包含整个类文件，您都会在每个新请求中看到该行将被执行。

我找不到任何好的简明文档——我可能会写一些带有一些内存使用示例的文档——因为我还必须向其他人解释这一点并出示证据以使其深入了解。我认为 zend 的人没想到任何人都不会看到自动加载的好处。

是的，apc 之类的（就像所有缓存解决方案一样）可以克服资源的负面影响，甚至可以在性能上获得小幅提升，但是如果您在大量库上执行此操作并提供大量服务，则会消耗大量不需要的内存的客户。尝试一些事情，比如在一个庞大的包含文件中加载一个健康的梨库块，同时处理 500 个连接到您的页面。

即使使用 Apc 之类的东西，您也可以从使用任何非命名空间类（目前大多数现有的 php 代码）的自动加载器中受益，因为它可以帮助避免在处理大量类库时造成全局命名空间污染。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T14:33:45.077

这是我的意见。

我认为自动装载机是一个非常糟糕的主意，原因如下

1.  我想知道我的脚本从什么地方获取数据/代码。使调试更容易。
2.  这也存在配置问题，如果您的开发人员之一更改文件（升级等）或配置并且事情停止工作，则更难找出它被破坏的地方。
3.  我也认为这是懒惰的编程。

至于内存/性能问题，如果计算机正在为此苦苦挣扎，那么为计算机购买更多内存同样便宜。

# java - Java Scanner：NoSuchElement 读取纯文本文件，地图由数字字符组成

> ID：11471964
> 
> 赞同：1
> 
> 时间：2012-07-13T13:57:22.113
> 
> 标签：java, terminal, ascii, java.util.scanner

我不断收到与扫描 .txt 文件相关的异常 NoSuchElement。导致异常的此类错误是：

```
"java.util.Scanner.throwFor(Unknown Source)
 java.util.Scanner.next(Unknown Source)
 java.util.Scanner.nextInt(Unknown Source)" 
```

我所做的只是读取 1 和 0 作为 ASCII 终端游戏中基本地图的测试。

我的代码：

```
import java.util.Scanner;
import java.io.File;
import java.io.FileNotFoundException;
public class Adventure {
    private Scanner in_file;
    private char[][] level;
    public Adventure() {
        level = new char[5][5];
    }
    public static void main(String []args) {
        Adventure adv = new Adventure();
        adv.load_game();
        adv.main_game();
    }
    public void load_game() {
        try {
            in_file = new Scanner(new File("level.txt"));
        } catch (FileNotFoundException e) {
            System.err.println("ERROR: Level could not be loaded!");
            System.exit(1);
        }
        for (int i = 0; i < level.length; i++ ) {
            for (int j = 0; j < level[i].length; j++) {
                if (in_file.hasNextInt()) {
                    if (in_file.nextInt() == 0) 
                        level[i][j] = '-';
                    else if (in_file.nextInt() == 1)
                        level[i][j] = '#';
                }
            }
        }
        in_file.close();
    }
    public void new_game() { 

    }
    public void main_game() {
        for (int i = 0; i < 20; i++) {
            for (int j = 0; j < 50; j++) {
                System.out.print(level[i][j]);
            }
        }
    }
    public void save_game() {

    }
} 
```

我的文本文件“level.txt”：

```
 11111
    10001
    10001
    10001
    11111 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T14:01:05.337

在下面的代码中，您读取的是 2 个整数而不是 1 个：

```
if (in_file.hasNextInt()) {
    if (in_file.nextInt() == 0) 
        level[i][j] = '-';
    else if (in_file.nextInt() == 1)
        level[i][j] = '#';
} 
```

这应该可以解决`NoSuchElementException`问题：

```
if (in_file.hasNextInt()) {
    int nextInt = in_file.nextInt();
    if (nextInt == 0) 
        level[i][j] = '-';
    else if (nextInt == 1)
        level[i][j] = '#';
} 
```

但是您还需要将 int 拆分为组成它的数字（例如，您可以通过除以 10、100、1000 等并四舍五入或将 int 放入 String 来做到这一点）。

# jquery - 带有json的IE（互联网爆炸器）ajax问题

> ID：11471965
> 
> 赞同：0
> 
> 时间：2012-07-13T13:57:27.363
> 
> 标签：jquery, ajax, json, internet-explorer, google-custom-search

好的，我已经为此苦恼了，所以我求助于蜂巢：p

我正在使用带有 jquery 的 google custom search rest api 来获取结果并为浏览器构建结果

我遇到的问题是，这个函数什么都不做ajax call 谁能帮我解决这个问题？

规格：IE版本：8（我知道我公司被反驳了别问...）

代码：

```
//init varables for getResults
var currentIndex;
var nextIndex;
var prevIndex;
var totalResults;

var urlParams = parseParamsFromUrl();
var queryParamName = "q";

function getResults(startIndex) {

    //clear results for new dataset
    $('.results').html('');

    //      debugger;
    $.ajax({
        url: 'https://www.googleapis.com/customsearch/v1',
        data: {
            key: 'AIzaSyBsiF3yLVphOd6c74PYOA-02iJx6dlmQuI',
            cx: '003411025563286140424:apyyekjazdi',
            q: urlParams[queryParamName],
            start: startIndex
        },
        success: function (data) {

            //set some variables for later use.
            currentIndex = data.queries.request[0]['startIndex'];
            nextIndex = data.queries.nextPage[0]['startIndex'];
            totalResults = data.searchInformation.totalResults;

            //              debugger;

            //if there are 0 results return nothing found
            if (totalResults === '0') {
                $('.results').html('<h3 class="three column centered">No results found!</h3>');
            }

            //check if theres more than 10 results to show the next button
            if (totalResults > 10) {
                $('.next').removeClass('hide');
            }

            if (currentIndex !== 1) {
                prevIndex = data.queries.previousPage[0]['startIndex'];
            }

            //if current index is 1 hide previous button
            if (currentIndex > 1) {
                $('.prev').removeClass('hide');
            } else {
                $('.prev').addClass('hide');
            }

            //hide query status
            $('.resultspinner').hide();

            //loop through all promotion results and add before regulars
            var promoresult;
            if (typeof data.promotions != 'undefined') {

                //show promotions div
                $('.promotions').show();

                $.each(data.promotions, function (index, value) {
                    //check if promotion has a description if so set it in the result
                    var promotionbody;

                    if (typeof value.bodyLines !== 'undefined') {
                        promotionbody = value.bodyLines['0']['htmlTitle'];
                    } else {
                        promotionbody = '';
                    }

                    //check if result has an image if so show in results if not display default
                    if (typeof value.image == 'undefined') {
                        var thumbnail = '\n\
                           <div class="thumb-box three column"> \n\
                                <a href="' + value.link + '">\n\
                                    <img src="http://www.insp.com/wp-content/themes/insp_foundation/images/thumbnail.jpg" />\n\
                                </a>\n\
                            </div>';
                    } else {
                        var thumbnail = '\n\
                           <div class="thumb-box three column"> \n\
                                <a href="' + value.link + '">\n\
                                    <img width="120" src="' + value.image.source + '" />\n\
                                </a>\n\
                            </div>';
                    }

                    //build layout for result
                    var promoresult = '\n\
                        <div class="search-result row promotion" id="post-' + index + '">\n\
                                   ' + thumbnail + '\n\
                    \n\
                        <div class="post-entry nine columns" >\n\
                            <h3 class="posttitle">\n\
                                <a href="' + value.link + '"> ' + value.title + '</a>\n\
                            </h3>\n\
                            \n\
                            <div class="entry">\n\
                                ' + promotionbody + '\n\
                            </div>\n\
                        </div>';
                    $('.promotions').append(promoresult);
                });
                //                    $('.promotions').prepend('<h4>Promotions: </h4>');
            }

            //loop through all regular results
            $.each(data.items, function (index, value) {
                //check if result has an image if so show in results if not display default
                if (typeof value.pagemap.metatags['0']['og:image'] == 'undefined') {
                    var thumbnail = '\n\
                           <div class="thumb-box three column"> \n\
                                <a href="' + value.link + '">\n\
                                    <img src="http://www.insp.com/wp-content/themes/insp_foundation/images/thumbnail.jpg" />\n\
                                </a>\n\
                            </div>';
                } else {
                    var thumbnail = '\n\
                           <div class="thumb-box three column"> \n\
                                <a href="' + value.link + '">\n\
                                    <img width="120" src="' + value.pagemap.metatags['0']['og:image'] + '" />\n\
                                </a>\n\
                            </div>';
                }

                //build layout for result
                var result = '\n\
                        <div class="search-result row result" id="post-' + index + '">\n\
                                   ' + thumbnail + '\n\
                    \n\
                        <div class="post-entry nine columns" >\n\
                            <h3 class="posttitle">\n\
                                <a href="' + value.link + '"> ' + value.pagemap.metatags[0]['og:title'] + '</a>\n\
                            </h3>\n\
                            \n\
                            <div class="entry">\n\
                                ' + value.htmlSnippet + '\n\
                            </div>\n\
                        </div>';

                //set data to result
                $('.results').append(result);

            });
            //                $('.results').prepend('<h4>Results: </h4>');

        },
        error: function (jqXHR, exception) {
            if (jqXHR.status === 0) {
                alert('Not connect.\n Verify Network.');
            } else if (jqXHR.status == 404) {
                alert('Requested page not found. [404]');
            } else if (jqXHR.status == 500) {
                alert('Internal Server Error [500].');
            } else if (exception === 'parsererror') {
                alert('Requested JSON parse failed.');
            } else if (exception === 'timeout') {
                alert('Time out error.');
            } else if (exception === 'abort') {
                alert('Ajax request aborted.');
            } else {
                alert('Uncaught Error.\n' + jqXHR.responseText);
            }
        },
        dataType: 'json'
    });
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T14:00:56.970

我相当确定您不能使用 AJAX 来获取不同域上的文件。您必须在服务器上调用服务器端脚本，该脚本本身会调用 API 并重新调整数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T15:22:14.163

事实证明，IE 的所有失败都完全忽略了任何跨域 ajax 请求，无论是否允许，您都必须使用服务器端替代方案来实现这一点。

# xcode - 警告：“UITabBarController”可能不会响应“选择选项卡：”

> ID：11471966
> 
> 赞同：0
> 
> 时间：2012-07-13T13:57:34.517
> 
> 标签：xcode

警告：“UITabBarController”可能不会响应“选择选项卡：”

我总是在 xcode 4.2 中收到这样的警告消息是否有可能删除此警告

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T14:04:05.973

那是因为没有“ `selectTab`” API。

" " 中最接近`UITabBarController`你想要做的事情的可能是[`selectedIndex`](http://developer.apple.com/library/ios/documentation/UIKit/Reference/UITabBarController_Class/Reference/Reference.html#//apple_ref/occ/instp/UITabBarController/selectedIndex)属性。

# android - 在 Android 浏览器中显示圆角

> ID：11471971
> 
> 赞同：0
> 
> 时间：2012-07-13T13:57:45.827
> 
> 标签：android, jquery-mobile, rounded-corners, android-browser

我在 Android 浏览器（在三星 Galaxy Tab 中）中显示圆形边缘时遇到问题。但是，它在 IOS 浏览器中运行良好（在 iPad 和 iPhone 中，即 Safari）。如下图所示

链接到图片[Android 浏览器中的圆角显示问题](http://www.flickr.com/photos/82568586@N06/7561811678/in/photostream/lightbox/)

下面是代码

```
<!DOCTYPE html>
<html>
<head>
<title>Sample App</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0,maximum-scale=1.0,user-scalable=false">
<meta http-equiv="Content-type" content="text/html; charset=utf-8" />

<link rel="shortcut icon" href="/favicon.ico" />
<link rel="stylesheet" type="text/css" href="jquery.mobile-1.1.0/jquery.mobile-1.1.0.min.css" />
<link rel="stylesheet" type="text/css" href="css/style.css" />

<script type="text/javascript" src="jquery.min.js"></script>
<script type="text/javascript" src="javascript/cordova-1.8.0.js"></script>
<script type="text/javascript" src="javascript/precache.js"></script>
<script type="text/javascript" src="javascript/common.js"></script>
<script type="text/javascript" src="jquery.mobile-1.1.0/jquery.mobile-1.1.0.min.js"></script>  
</head>
<body>
<div data-role="page" data-theme="c" id="front">
    <div data-theme="b" id="search-container">
        <form id="search-field" action="" method="get" data-ajax="false">
            <input type="search" name="search" value="" />
        </form>
    </div>
</div><!-- /page -->

</body>
</html> 
```

我不确定是否必须覆盖默认的 jQuery Mobile 样式。如果是这样，任何人都可以让我知道我必须覆盖的配置，或者是否有任何其他解决方案来克服这个问题。

但是，当输入字段处于焦点时，这可以正常工作，如此处所示，当字段处于焦点时，[圆角会正确显示](http://www.flickr.com/photos/82568586@N06/7561957006/in/photostream/lightbox/)

当我在浏览器中查看页面源代码时，这是代码（用于 div 块）

```
<div id="search-top">
  <form id="search-field" action="" method="get" data-ajax="false">
    <div class="ui-input-search ui-shadow-inset ui-btn-corner-all ui-btn-shadow ui-icon-searchfield ui-body-b" style="border-radius: 1em;">
      <input type="text" data-type="search" name="search" value="" class="ui-input-text ui-body-b">
      <a href="#" class="ui-input-clear ui-btn ui-btn-up-b ui-shadow ui-btn-corner-all ui-fullsize ui-btn-icon-notext ui-input-clear-hidden" title="clear text" data-corners="true" data-shadow="true" data-iconshadow="true" data-wrapperels="span" data-icon="delete" data-iconpos="notext" data-theme="b" data-mini="false">
      <span class="ui-btn-inner ui-btn-corner-all">
        <span class="ui-btn-text">clear text</span>
        <span class="ui-icon ui-icon-delete ui-icon-shadow">&nbsp;</span>
      </span>
      </a>
    </div>
  </form>
</div> 
```

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T03:44:35.210

经过多次测试，我找到了这个问题的原因！

`.ui-shadow-inset`只需从`jquery.mobile.css`文件中删除此类。

# php - 致命错误：在 /my/path 中找不到类“Memcached”

> ID：11471977
> 
> 赞同：4
> 
> 时间：2012-07-13T13:58:06.543
> 
> 标签：php, memcached, fatal-error

当我尝试：

```
$mc= new Memcached(); 
```

我明白了

```
Fatal error: Class 'Memcached' not found in /my/path 
```

phpinfo 说 /etc/php5/apache2/conf.d/20-memcached.ini 作为附加的 .ini 文件加载。

这个文件的内容是这个：

```
; uncomment the next line to enable the module
extension=memcached.so 
```

dpkg --get-selections | grep 内存缓存

```
libmemcached6                                   install
memcached                                       install
php5-memcached                                  install 
```

库本图 Apache 2.0 php 5.4.4-1

为什么我有这个致命错误？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-13T14:55:31.370

根据您的评论，我认为您没有正确安装它。确保您在 phpinfo() 中看到了一个部分，例如：

```
memcached
memcached support   enabled
Version     x.x.x
libmemcached version    x.xx 
```

1) 获取`libmemcached`

2）配置包

3）进行安装`sudo make install libmemcached`

4) 尝试安装`sudo pecl install memcached`

5）确保你有`extension = memcached.so`你的 php.ini

重启阿帕奇

# php - 在php中显示一个网页的页面源

> ID：11471987
> 
> 赞同：0
> 
> 时间：2012-07-13T13:58:38.607
> 
> 标签：php, xpath, web-scraping

如何在字符串变量中检索特定网页的整个页面源信息并在 php.ini 中回显它。我是 php 新手，不知道这样做有没有人可以给我它的完整源代码。以下是我的源代码：

```
<?php
$dom = new DOMDocument;
$dom->loadHtmlFile('http://www.google.com');

$xpath = new DOMXPath($dom);

$elements = $xpath->query('//input[@name="session_id"]');
if ($elements->length) {
    echo "found: ", $elements->item(0)->getAttribute('value');
} else {
    echo "not found";
}
}
?> 
```

我已将上面的代码替换为

只是将网址更改为：'http://www.flipkart.com/professional-android-2-application-development-8126525894/p/itmdytmwpjzyhade?pid=9788126525898&ref=8a47bf68-7558-43ce-a9b2-17c1ac119e84'

但它给出了以下错误： **警告：file_get_contents(http://www.flipkart.com/professional-android-2-application-development-8126525894/p/itmdytmwpjzyhade?pid=9788126525898&ref=8a47bf68-7558-43ce-a9b2-17c1ac119e84 ) [function.file-get-contents]：打开流失败：HTTP 请求失败！在第 2 行的 C:\wamp\www\displaycontentswebpage.php**

预期结果：（页面来源）

```
<title>Professional Android 2 Application Development 8126525894: Book: Reto Meier (9788126525898) | Flipkart.com</title>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8" />
<!--<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" /> -->
<meta property="fb:page_id" content="102988293558" />
<meta property="fb:admins" content="658873552,1412400758,624500995,100000233612389"/>
<meta name="Keywords" content="professional android 2 application development, buy professional android 2 application development, professional android 2 application development india, professional android 2 application development review, reto meier, 8126525894, 9788126525898" />
<meta name="Description" content="Professional Android 2 Application Development by Reto Meier. Rs.449, Save 25%. Buy Professional Android 2 Application Development, All India Free Home Delivery. 8126525894, 9788126525898 |" />

    <link rel="canonical" href="http://www.flipkart.com/professional-android-2-application-development-8126525894/p/itmdytmwpjzyhade" />
<link rel='shortcut icon' href='http://img5.flixcart.com/www/prod/images/favicon-18354.ico' />................something something..........................

src="http://googleads.g.doubleclick.net/pagead/viewthroughconversion/1017598645/?value=0&amp;label=9tgBCLOv-QIQtaWd5QM&amp;guid=ON&amp;script=0"/>
                </div>
            </noscript></div> 
```

请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T14:02:52.730

当您将文档加载到`$dom`变量中时，您可以执行以下操作：

```
echo htmlspecialchars($dom->saveHTML()); 
```

请参阅手册[`saveHTML`](http://www.php.net/manual/en/domdocument.savehtml.php)

我正在使用`htmlspecialchars`以便显示 html 而不是渲染。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T14:03:38.917

这是通过 PHP `file_get_contents()`( [http://php.net/file-get-contents](http://php.net/file-get-contents) ) 中的单个函数实现的，它将文件的内容作为字符串返回。

```
// print source to current output
echo file_get_contents( 'http://www.google.com' );

// print content as readble format
echo htmlspecialchars( file_get_contents( 'http://www.google.com' ), ENT_SUBSTITUTE ); 
```

如果输入在给定编码中包含无效的代码单元序列，则-`ENT_SUBSTITUTE`或 -`ENT_IGNORE`标志是必需的。`htmlspecialchars()`见[http://php.net/htmlspecialchars#refsect1-function.htmlspecialchars-returnvalues](http://php.net/htmlspecialchars#refsect1-function.htmlspecialchars-returnvalues)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-21T16:44:45.710

```
$dom = new DOMDocument ('1.0');

@$dom->loadHTMLfile ('https://mp3skull.cr');

$thisi=$dom->saveHTML();

echo htmlentities($thisi); 
```

this will print the html source of the page

# .net - vb.net webservice - 获取完整的soap xml请求

> ID：11471990
> 
> 赞同：1
> 
> 时间：2012-07-13T13:58:45.917
> 
> 标签：.net, xml, vb.net, web-services, soap

> **可能重复：**
> [有没有办法从 ASP.NET WebMethod 中获取原始 SOAP 请求？](https://stackoverflow.com/questions/2587952/is-there-a-way-to-get-the-raw-soap-request-from-within-a-asp-net-webmethod)

我有一个 ASP/VB.NET 网络服务。

一些外部应用程序正在尝试调用我的网络服务。

一旦我的 web 服务功能启动，我想获得调用我的服务/功能的 XML 请求。

我无法安装其他应用程序（例如 Fiddler）来监控 Web 服务......所以我需要能够通过代码捕获请求。

任何帮助表示赞赏。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T14:29:26.750

我在 MSDN [http://msdn.microsoft.com/en-us/library/system.web.services.protocols.soapextension(VS.80).aspx上找到了答案](http://msdn.microsoft.com/en-us/library/system.web.services.protocols.soapextension(VS.80).aspx)

从上面的链接添加类，然后添加下面代码所示的 TraceExtension() _，现在记录 XML soap 请求和响应：

```
<WebMethod()> _
<TraceExtension()> _
Public Function GetResults() as string
 return "True"
End Function 
```

# c# - 将 Json 从 PHP 读取到 C# 时出错

> ID：11471996
> 
> 赞同：0
> 
> 时间：2012-07-13T13:59:13.783
> 
> 标签：c#, php, json

我在尝试从中读取时收到此错误`JObject`，`C#`这`PHP`是基本查询的结果`"SELECT * FROM items"...`

`Unexpected character encountered while parsing value: S. Path '', line 0, position 0.`

PHP

```
$query = ($_POST["test"]);

if ($result = $mysqli->query($query)
{
    $jsonResult = json_encode($result);
}   

echo $jsonResult; 
```

C＃

```
public JObject GetThat()
{
    HttpWebResponse WebResp = (HttpWebResponse)WebReq.GetResponse();

    Stream Answer = WebResp.GetResponseStream();

    string phpResponse = Answer.ToString();
    JObject myResult = JObject.Parse(phpResponse);

    return myResult;
} 
```

我究竟做错了什么？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T14:07:29.267

问题是它`Answer.ToString()`不会将流内容作为字符串返回。尝试这样的事情。

```
public JObject GetThat()
{
    HttpWebResponse WebResp = (HttpWebResponse)WebReq.GetResponse();

    string phpResponse = string.Empty;
    using(StreamReader rdr = new StreamReader(WebResp.GetResponseStream()))
        phpResponse = rdr.ReadToEnd();
    }

    JObject myResult = JObject.Parse(phpResponse);

    return myResult;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-15T18:00:50.113

原来问题出在数组类型上。

```
$row = $result->fetch_array(MYSQLI_NUM); 
```

不起作用，但是

```
$row = $result->fetch_array(MYSQLI_BOTH); 
```

和

```
$row = $result->fetch_array(MYSQLI_ASSOC); 
```

做。有谁知道为什么？谢谢。

# ravendb - 当 WPF 应用程序中有嵌入式实例时，如何访问 RavenDB Management Studio？

> ID：11471997
> 
> 赞同：2
> 
> 时间：2012-07-13T13:59:14.497
> 
> 标签：ravendb

我正在编写一个简单的 WPF 应用程序，它将使用嵌入式 RavenDB 作为它的数据存储。我得到了通过 NuGet 使 RavenDB 工作所需的一切（包括 Management Studio 的 Xap 文件），但是，尚不清楚在这种情况下如何使用 Xap 文件。

有没有人设法在 WPF 应用程序中嵌入实例的超级简单情况下使用 Management Studio，而无需跳过箍，在您的盒子上创建一个托管站点来放置 Xap？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T07:55:56.123

请参阅此处的讨论： [http ://ravendb.net/docs/server/deployment/embedded](http://ravendb.net/docs/server/deployment/embedded)

# facebook - Facebook页面喜欢

> ID：11471999
> 
> 赞同：0
> 
> 时间：2012-07-13T13:59:42.237
> 
> 标签：facebook, facebook-like

我知道 Like 按钮社交插件显示的计数由以下部分组成：

*   此网址的点赞数
*   此 URL 的共享数量（这包括将链接复制/粘贴回 Facebook）
*   Facebook 上有关此 URL 的故事的点赞数和评论数
*   包含此 URL 作为附件的收件箱邮件数。

有没有人确定是否可以通过[这种调用](https://graph.facebook.com/cocacola)访问的**Page like count**是否也由上述规则组成，还是纯粹的 Like 计数（即只计算点击 Page 的 Like 按钮的人）？

干杯!

李

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T14:01:17.647

对于页面，它只是显示的喜欢计数 - 其他列表用于您的网站/应用程序中的 URL