# StackOverflow 问答 000379000-000379999

# sql - 已知问题？：SQL Server 2005 存储过程无法通过参数完成

> ID：379007
> 
> 赞同：4
> 
> 时间：2008-12-18T19:51:20.780
> 
> 标签：sql, sql-server, sql-server-2005, stored-procedures

带有默认参数的基本 SP：

```
ALTER PROCEDURE [usp_debug_fails]
    @DATA_DT_ID AS int = 20081130
WITH RECOMPILE
AS
BEGIN
    /*
        Usage:
        EXEC [usp_debug_fails] WITH RECOMPILE
    */
    -- Stuff here that depends on DATA_DT_ID
END 
```

具有硬编码本地的相同 SP。

```
ALTER PROCEDURE usp_debug_works]
WITH RECOMPILE
AS
BEGIN
    /*
        Usage:
        EXEC [usp_debug_works] WITH RECOMPILE
    */

    DECLARE @DATA_DT_ID AS int
    SET @DATA_DT_ID = 20081130
    -- Stuff here that depends on DATA_DT_ID
END 
```

您可以看到我在（冗余，偶数）`WITH RECOMPILE`选项中放置的位置以避免参数嗅探（这在开发中从来没有必要，因为这个东西工作得很好）

一个可以在一两分钟内完成的工作，另一个永远不会完成 - 只是在那里坐了几个小时。

这个问题在开发服务器（build 9.00.3282.00）上从未发生过，生产服务器是 build 9.00.3068.00

我已经从 procs 中删除了各种代码，以尝试降低到仍然存在问题的最小版本，并且非常小心地保持两个版本的 SP 相同，除了一个参数。

我有很多其他带有参数的 SP，它们运行良好。我还对 SP 进行了`DROP`ped 和reed。`CREATE`

有任何想法吗？

是的，我有一个 DBA 正在查看它，但我没有 SHOWPLAN 或任何有用的生产权限来查看是否存在阻塞（如果一个人的计划导致锁升级，我猜 - 同样，唯一的区别是参数）

我已经查看了所有 SQL Server 构建信息，但没有看到关于此的已知问题，所以在我弄清楚或 DBA 弄清楚之前，我有点卡住了。

**更新**

这也无法完成（这实际上是这些 SP 的正常形式 - 我只是放了一个默认值，以便在测试期间更容易来回切换）

```
ALTER PROCEDURE [usp_debug_fails]
    @DATA_DT_ID AS int
WITH RECOMPILE
AS
BEGIN
    /*
        Usage:
        EXEC [usp_debug_fails] 20081130 WITH RECOMPILE
    */
    -- Stuff here that depends on DATA_DT_ID
END 
```

但是这个完成（这可能是一种解决方法，尽管我有大约 25 个这些 SP 需要修改，它们都具有相同的形式）：

```
ALTER PROCEDURE [usp_debug_fails]
    @DATA_DT_ID_in AS int
WITH RECOMPILE
AS
BEGIN
    /*
        Usage:
        EXEC [usp_debug_fails] 20081130 WITH RECOMPILE
    */

    DECLARE @DATA_DT_ID AS int
    SET @DATA_DT_ID = @DATA_DT_ID_in
    -- Stuff here that depends on DATA_DT_ID
END 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-18T20:06:30.640

尝试屏蔽输入参数。

我猜重新编译不起作用，因为在编译时嗅探了指定的默认值（**编辑：或第一次调用时发送的参数）。**所以，重新编译没有效果。

我已经看到估计计划之间的巨大差异，只需将默认值从零更改为 NULL，或者没有。

```
ALTER PROCEDURE [usp_debug_mightwork]
    @DATA_DT_ID AS int = 20081130
AS
BEGIN
    DECLARE @IDATA_DT_ID AS int
    SET @IDATA_DT_ID = @DATA_DT_ID
    -- Stuff here that depends on IDATA_DT_ID
END 
```

我认为[这篇文章](http://www.microsoft.com/technet/prodtechnol/sql/2005/recomp.mspx#E6TAE)解释了...

> ...参数值在编译或重新编译期间被嗅探...

编辑：

[查询计划和参数的新链接](http://blogs.msdn.com/ianjo/archive/2005/11/10/491538.aspx)。无论是否指定默认值，它仍然是参数嗅探。

> 上面 GetRecentSales 存储过程中指定的 WITH RECOMPILE 选项并不能消除基数估计错误

[关于常量和计划的相关文章类型](http://www.sqlskills.com/BLOGS/CONOR/post/Contradictions-within-Contradictions.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-20T15:12:40.150

防止参数嗅探，否则当统计数据发生变化时您会吃不消。我有 500 多个 sps，所有这些都以：

`DECLARE @_Param1 ..., @_ParamN`

`--- prevent pameter sniffing`
`SELECT @_Param1 = @Param1, @_ParamN = @ParamN`

# networking - 跨子网的 UDP 广播数据包

> ID：379015
> 
> 赞同：22
> 
> 时间：2008-12-18T19:53:36.843
> 
> 标签：networking, udp

是否可以通过路由器将 UDP 广播数据包发送到不同的子网？我正在编写一个应用程序来发现网络上的某些设备，并且 PC 可能与它正在寻找的设备位于不同的子网中。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-12-18T20:00:11.917

是的，没有。

只要中间路由器没有`no ip directed-broadcasts`配置或类似配置，它实际上是可行的。但是现在这是默认设置，因为允许正常广播通过路由器是 DoS 问题。

如果您真的想跨子网广播，那么您应该改用[IP 多播](http://en.wikipedia.org/wiki/IP_Multicast)。这仍然需要适当配置干预路由器，但这是“正确”的做法。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-18T20:00:25.690

**简短的回答：** 没有。

**长答案：** 也许。DHCP 以这种方式工作，但路由器配置为让 DHCP 端口上的 UDP 广播通过。如果您完全控制了网络硬件，则可以打开任何/所有 UDP 端口以允许跨子网广播。如果无法控制路由器的配置，请参阅简短答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-18T20:16:21.917

问候乔恩，

Cisco 路由器通常包含可用于跨子网的 UDP IP Helper 地址模式。

# java - 货币格式的 JSF convertNumber 是否舍入或截断额外的小数位？

> ID：379027
> 
> 赞同：4
> 
> 时间：2008-12-18T19:57:18.303
> 
> 标签：java, jsf

这是一个例子：

```
 <h:outputText value="#{myBean.myMoney}">
       <f:convertNumber type="currency" currencySymbol="$" />
    </h:outputText> 
```

假设我有 1.006 美元，这将输出 1.00 美元还是 1.01 美元？

这里不说：http: [//java.sun.com/javaee/javaserverfaces/1.1_01/docs/tlddocs/f/convertNumber.html](http://java.sun.com/javaee/javaserverfaces/1.1_01/docs/tlddocs/f/convertNumber.html)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-18T22:12:22.510

答案=圆形

嗯……听起来对吗？我不认为四舍五入是个好主意。希望没有银行应用程序会依赖这个。

让人想起《飞越杜鹃巢》中的这一幕……

> [囚犯们在打牌，用香烟打赌]
> 马提尼：[把一根香烟撕成两半] 我赌一分钱。
> 麦克墨菲：一角钱是极限，马提尼。
> 马提尼：我赌一毛钱。
> （把两半放在桌子上）
> McMurphy：这不是一毛钱，马提尼。这是一毛钱。
> [展示整支香烟]
> McMurphy：如果你把它掰成两半，你就得不到两个五分钱，你会得到狗屎。试着抽烟。你明白？
> 马提尼：是的。
> 麦克墨菲：你不明白。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-19T08:36:00.020

货币只能设置小数点后两位，设置多于两位小数是错误的。如果输入的小数位数超过 2 位，则输出将被截断为小数点后 2 位。

从逻辑上讲，1.001 美元没有任何意义，因为 1 美元和 1 美分将是 1.01 美元而不是 1.001 美元。

# c# - 使用公共领域的最佳做法是什么？

> ID：379041
> 
> 赞同：24
> 
> 时间：2008-12-18T19:59:51.060
> 
> 标签：c#, .net, properties, field

当我编写一个类时，我总是通过这样的公共属性公开私有字段：

```
private int _MyField;
public int MyField
{ get{return _MyField; } 
```

什么时候可以像这样公开一个公共字段：

```
public int MyField; 
```

我正在创建一个名为 Result 的结构，我的意图是这样做：

```
public Result(bool result, string message)
{
   Result = result;
   Message = message;
}

public readonly int Result;
public readonly int Message; 
```

最佳做法是什么？这样做可以吗？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-12-18T20:04:17.493

我只在公共字段是（静态）常量时才公开它们——即使那样我通常也会使用一个属性。

“常量”是指任何只读的、不可变的值，而不仅仅是可以在 C# 中表示为“常量”的值。

在我看来，即使是只读*实例*变量（如 Result 和 Message）也应该封装在一个属性中。

有关更多详细信息，请参阅[本文](http://csharpindepth.com/Articles/Chapter8/PropertiesMatter.aspx)。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-12-18T20:04:04.357

> 使用公共领域的最佳做法是什么？

“不。” 另请参阅： [是否应始终禁止受保护的属性？](https://stackoverflow.com/questions/76194/should-protected-attributes-always-be-banned#76286)这涉及受保护的领域，但所说的对于公共领域来说更是如此。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-12-18T20:04:59.753

使用属性。现在 C# 有[自动属性](http://weblogs.asp.net/scottgu/archive/2007/03/08/new-c-orcas-language-features-automatic-properties-object-initializers-and-collection-initializers.aspx)很容易！

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-18T20:03:00.193

最佳实践是出于多种原因使用属性。首先，它将 API 与底层数据结构分离。其次，任何内置到框架中的绑定到对象的东西都会绑定到属性，而不是字段。

我敢肯定还有更多的原因，但这两个对我来说似乎总是足够的。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-18T20:04:35.653

我认为最好的做法是不这样做。除非您有一些极端的性能需求，您*必须*直接访问该字段，否则不要这样做。

这是一篇关于它的好文章：

[http://cshapindepth.com/Articles/Chapter8/PropertiesMatter.aspx](http://csharpindepth.com/Articles/Chapter8/PropertiesMatter.aspx)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-19T05:58:19.340

我建议使用类似的东西：

```
public class Result{  
    public bool Result {  get; protected set; }
    public string Message {  get; protected set; }

    public Result(bool result, string message) {
        Result = result;
        Message = message;
    }
} 
```

这样，您无需声明成员变量，让编译器为您完成工作！代码非常干净和简短，重构轻而易举。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-19T13:26:49.740

在 C 样式语言（如 C#）中，您应该通过属性公开字段。这也适用于 VB.NET 和其他 .NET 语言，并且它们共享相同的底层引擎。这样做的主要原因是

作为整数的公共 MyField 不等于作为整数的公共属性 MyField，它们在 .NET 下的所有情况下都没有相同的行为。

但是，您可能会看到很多人继续公开 Fields。其中一些是由于 VB6 处理 COM 的方式。在 VB6 Public MyField as Integer 等价于 Public Property MyField as Integer。因为当两者都被翻译成 COM 类型库时，它们都以相同的方式实现。

这导致了 VB6 对可能是公共字段的许多奇怪的限制。.NET 和许多其他面向对象语言中没有的限制。这些限制在编译时就被捕获了，因此可以说防止程序员自爆。如果您的课程在 VB6 中是私有的，那么这些限制中的一些（但不是全部）会被放宽。一般规则是您只能将类和数据类型公开为公共字段。

VB6 的遗留问题意味着很多程序员不知道 .NET 中存在差异。

因为 .NET 在这方面没有帮助我们，所以您需要采取传统步骤，确保所有字段都通过属性公开。再次因为在 .NET 中，字段与属性不同。

这篇[文章](http://csharpindepth.com/Articles/Chapter8/PropertiesMatter.aspx)（由其他人指出）解释了它的 .NET 方面。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-18T20:03:17.730

[C# 中的字段和属性有什么区别？](https://stackoverflow.com/questions/295104/what-is-the-difference-between-a-field-and-a-property-in-c)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-18T22:54:58.257

我想回答你的只读方法。

Readonly 不是在公共字段上只有一个 get 访问器的方法。我主要在私有字段上使用只读，我的私有字段只能从构造函数中设置。所以要理解只读字段只能在构造函数中设置，然后你只能访问它。

最佳实践是始终使用属性在构造函数之后访问您的字段。因此，如果您必须从班级内部访问您的属性，我会输入：

```
private readonly int result;
private readonly int message;

public Result(bool result, string message)
{
   this.result = result;
   this.message = message;
}

public int Result
{
   get{ return result; }
   private set { result = value; }
}

public int Message
{
   get{ return message; }
   private set { message = value; }
} 
```

这样，您只能读取 Result 和 Message 并且仍然可以从类内部写入。

如果您使用继承，如果需要，您可以将集合设置为受保护的。

**编辑**：在阅读了我根据问题中给出的内容编写的代码后，存在一些错误，其中类名 Result 可能会抛出属性 Result 的错误，而且我们收到一个 bool 作为结果和一个字符串作为构造函数中的消息，但尝试将它们发送到 int 这肯定行不通。但是这里的价值在于逻辑：

```
private readonly bool result;
private readonly string message;

public Answer(bool result, string message)
{
   this.result = result;
   this.message = message;
}

public bool Result
{
   get{ return result; }
   private set { result = value; }
}

public string Message
{
   get{ return message; }
   private set { message = value; }
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-18T23:31:46.560

我给出的答案是属性对重构更友好。

如果您有一个带有只读字段的程序集，则将它们更改为属性。如果您有另一个程序集我访问这些字段（现在是属性），那么它们将无法在没有编译的情况下工作。就编译器而言，字段和属性并不相同。

回到重构，假设你从一个属性开始。现在您需要更改数据的来源（您将从另一个类访问它）。如果您正在处理字段，那么您需要做出一些艰难的决定来决定如何做到这一点。属性更加宽容——因为您可以在其中隐藏逻辑。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-07-16T20:09:21.343

一般来说，如果一个类型将被用作数据持有者，它应该是：

1.  具有暴露字段的可变结构，如果每个字段从类型的角度来看都将表现为一个值，并且字段值的任意组合将“有意义”。请注意，如果字段的目的是保存相关对象的*身份*，而不是内容，则保存对可变类类型的引用的字段可能符合条件。由于愚蠢的 C# 编译器会将 `SomeThing.SomeStruct.SomeField = whatever` 解释为 `tempStruct = SomeThing.SomeStruct; tempStruct.SomeField =what` 没有发出诊断，但今天的程序员没有理由担心古代编译器会做什么。
2.  具有非公共字段的不可变类或结构，适用于上述情况不适用的情况，并且必须重新生成整个数据项以更改其中一个方面不会太麻烦。
3.  一个可变类，如果对它的引用不会被保存在创建它的实体之外（这种引用通常不应该暴露给外部代码）。请注意，其他两个选项在可行时应该是首选，因为使用可变类类型作为数据持有者的集合（与仅存储对象身份但不关心这些对象代表什么的集合相反）通常必须为存储在集合中的任何对象制作一个防御性副本，然后在每次读取该对象时制作一个额外的防御性副本。结构，无论是可变的还是“不可变的”，在存储或从集合中读回时都必须复制，但是*对于任何大小的结构，这样的副本更便宜*，而不是使用可变类时所需的防御性副本。

如果没有使用可变类的实际替代方法，是否公开公共字段的问题取决于是否有任何可预见的需要任何版本的类在属性设置器中包含验证逻辑，以及成员的类型是否将是值类型或类类型。如果`Bounds`是类型的公共字段`Rectangle`，则表达式 like`SomeClass.Bounds.Width`可以访问`Width`矩形的 ，而无需访问任何其他成员。相比之下，如果`Bounds`是一个属性——即使是一个可变的——该表达式必须将 的所有四个成员复制`Bounds`到一个临时结构中，然后访问它的`Width`字段。

# c# - 哪些书籍帮助您掌握了 n-Tier 开发

> ID：379042
> 
> 赞同：5
> 
> 时间：2008-12-18T19:59:59.763
> 
> 标签：c#, design-patterns, n-tier-architecture

哪些书籍帮助您掌握了 n 层开发（表示层、UI 业务对象、数据业务对象和数据集）？

我更喜欢书籍，但博客和其他网站也是受欢迎的建议。我在一份新工作中继承了一个 n 层设计的应用程序，虽然我花了一些时间来适应它，但我看到了这些概念的用处。展望未来，我想确保我的开发符合相同的标准。专注于 C# 也会很棒。

此外，您是否会建议其他设计模式以实现可伸缩性？您可以为这些设计模式提供任何建议的阅读材料吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-18T20:06:01.390

阅读[企业应用架构模式](http://martinfowler.com/books.html#eaa)(PoEAA) 让我大开眼界。它面向网络，并详细解释了所有这些层应该如何交互。

IIRC，示例在 C# 和 Java 中。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-18T23:42:40.267

这是我在办公室里吸引人们阅读的标准书籍清单，以及我阅读它们的顺序：

*C# 中的敏捷原则、模式和实践*- Robert C. Martin、Micah Martin
*重构：改进现有代码的设计*- Martin Fowler
*有效地使用遗留代码*- Michael Feathers
*领域驱动设计：解决软件核心的复杂性*- Eric Evans
*应用领域驱动设计和模式：用 C# 中的示例*- Jimmy Nilsson

如果您只想读一本书，请阅读 Robert C. Martin 的书。它会让你想阅读其他人。重构书主要是技术目录，更多的是参考书而不是说明手册，但仍然非常值得拥有。如果您现在正在进行所有未开发的开发，请将 Legacy Code 书保存到最后。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-10-24T20:24:27.500

在 Visual Basic 2005 中做对象[Amazon](https://rads.stackoverflow.com/amzn/click/com/0321320492)最适合初学者

OOP：使用 Microsoft Visual Basic .NET 构建可重用组件 [亚马逊](https://rads.stackoverflow.com/amzn/click/com/0735613796) 也是一本好书

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-18T20:45:07.973

[Expert C# 2005 业务对象，第二版](http://www.apress.com/book/view/1590596323)

它的目的不是教授 n-Tier，而是构建本书中提出的框架有助于理解 n-Tier 世界中事物的工作方式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-18T20:41:12.863

书籍非常适合某些解决方案/方法的细节和细节，但[关注点分离](http://en.wikipedia.org/wiki/Separation_of_concerns)原则足以从逻辑上推导出 n 层架构

# c++ - 钻石继承 (C++)

> ID：379053
> 
> 赞同：20
> 
> 时间：2008-12-18T20:02:48.590
> 
> 标签：c++, oop, inheritance, multiple-inheritance, diamond-problem

我知道拥有钻石继承权被认为是不好的做法。但是，我有两个案例，我觉得钻石继承非常适合。我想问一下，你会建议我在这些情况下使用钻石继承，还是有其他设计可以更好。

**案例 1：**我想在我的系统中创建代表不同类型“动作”的类。这些动作按几个参数分类：

*   动作可以是“读”或“写”。
*   动作可以有延迟或无延迟（它不仅仅是 1 个参数。它显着改变了行为）。
*   动作的“流类型”可以是 FlowA 或 FlowB。

我打算有以下设计：

```
// abstract classes
class Action  
{
    // methods relevant for all actions
};
class ActionRead      : public virtual Action  
{
    // methods related to reading
};
class ActionWrite     : public virtual Action  
{
    // methods related to writing
};
class ActionWithDelay : public virtual Action  
{
    // methods related to delay definition and handling
};
class ActionNoDelay   : public virtual Action  {/*...*/};
class ActionFlowA     : public virtual Action  {/*...*/};
class ActionFlowB     : public virtual Action  {/*...*/};

// concrete classes
class ActionFlowAReadWithDelay  : public ActionFlowA, public ActionRead, public ActionWithDelay  
{
    // implementation of the full flow of a read command with delay that does Flow A.
};
class ActionFlowBReadWithDelay  : public ActionFlowB, public ActionRead, public ActionWithDelay  {/*...*/};
//... 
```

当然，我会遵守没有 2 个动作（从 Action 类继承）将实现相同的方法。

**案例 2：**我在我的系统中为“命令”实现复合设计模式。一个命令可以读、写、删除等。我也想有一个命令序列，也可以读、写、删除等。一个命令序列可以包含其他命令序列。

所以我有以下设计：

```
class CommandAbstraction
{
    CommandAbstraction(){};
    ~CommandAbstraction()=0;
    void Read()=0;
    void Write()=0;
    void Restore()=0;
    bool IsWritten() {/*implemented*/};
    // and other implemented functions
};

class OneCommand : public virtual CommandAbstraction
{
    // implement Read, Write, Restore
};

class CompositeCommand : public virtual CommandAbstraction
{
    // implement Read, Write, Restore
}; 
```

此外，我还有一种特殊的命令，“现代”命令。一个命令和复合命令都可以是现代的。成为“现代”会为一个命令和复合命令添加特定的属性列表（它们的属性大多相同）。我希望能够持有指向 CommandAbstraction 的指针，并根据所需的命令类型（通过 new）对其进行初始化。所以我想做下面的设计（除了上面的）：

```
class ModernCommand : public virtual CommandAbstraction
{
    ~ModernCommand()=0;
    void SetModernPropertyA(){/*...*/}
    void ExecModernSomething(){/*...*/}
    void ModernSomethingElse()=0;

};
class OneModernCommand : public OneCommand, public ModernCommand
{
    void ModernSomethingElse() {/*...*/};
    // ... few methods specific for OneModernCommand
};
class CompositeModernCommand : public CompositeCommand, public ModernCommand
{
    void ModernSomethingElse() {/*...*/};
    // ... few methods specific for CompositeModernCommand
}; 
```

同样，我将确保没有 2 个从 CommandAbstraction 类继承的类将实现相同的方法。

谢谢你。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-12-18T23:36:11.310

继承是 C++ 中第二强（更耦合）的关系，仅次于友谊。如果您可以重新设计为仅使用组合，您的代码将更加松散耦合。如果你不能，那么你应该考虑你的所有类是否真的应该从基类继承。是由于实现还是只是一个接口？您想使用层次结构中的任何元素作为基本元素吗？或者只是你的层次结构中的叶子是真正的行动？如果只有叶子是动作并且您正在添加行为，则可以考虑针对此类行为组合进行基于策略的设计。

这个想法是可以在小类集中定义不同的（正交）行为，然后将它们捆绑在一起以提供真正完整的行为。在示例中，我将只考虑一个策略，该策略定义是现在还是将来执行操作，以及要执行的命令。

我提供了一个抽象类，以便可以（通过指针）将模板的不同实例存储在容器中，或者作为参数传递给函数并以多态方式调用。

```
class ActionDelayPolicy_NoWait;

class ActionBase // Only needed if you want to use polymorphically different actions
{
public:
    virtual ~Action() {}
    virtual void run() = 0;
};

template < typename Command, typename DelayPolicy = ActionDelayPolicy_NoWait >
class Action : public DelayPolicy, public Command
{
public:
   virtual run() {
      DelayPolicy::wait(); // inherit wait from DelayPolicy
      Command::execute();  // inherit command to execute
   }
};

// Real executed code can be written once (for each action to execute)
class CommandSalute
{
public:
   void execute() { std::cout << "Hi!" << std::endl; }
};

class CommandSmile
{
public:
   void execute() { std::cout << ":)" << std::endl; }
};

// And waiting behaviors can be defined separatedly:
class ActionDelayPolicy_NoWait
{
public:
   void wait() const {}
};

// Note that as Action inherits from the policy, the public methods (if required)
// will be publicly available at the place of instantiation
class ActionDelayPolicy_WaitSeconds
{
public:
   ActionDelayPolicy_WaitSeconds() : seconds_( 0 ) {}
   void wait() const { sleep( seconds_ ); }
   void wait_period( int seconds ) { seconds_ = seconds; }
   int wait_period() const { return seconds_; }
private:
   int seconds_;
};

// Polimorphically execute the action
void execute_action( Action& action )
{
   action.run();
}

// Now the usage:
int main()
{
   Action< CommandSalute > salute_now;
   execute_action( salute_now );

   Action< CommandSmile, ActionDelayPolicy_WaitSeconds > smile_later;
   smile_later.wait_period( 100 ); // Accessible from the wait policy through inheritance
   execute_action( smile_later );
} 
```

继承的使用允许通过模板实例化访问策略实现中的公共方法。这不允许使用聚合来组合策略，因为不能将新的函数成员推送到类接口中。在示例中，模板依赖于具有 wait() 方法的策略，该方法对所有等待策略都是通用的。现在等待一个时间段需要一个固定的时间段时间，这个时间段是通过 period() 公共方法设置的。

在示例中，NoWait 策略只是时间段设置为 0 的 WaitSeconds 策略的一个特定示例。这是有意标记策略接口不需要相同。通过提供一个注册为给定事件回调的类，另一个等待策略实现可能是等待若干毫秒、时钟滴答或直到某个外部事件。

如果您不需要多态性，您可以从示例中完全取出基类和虚拟方法。虽然对于当前示例来说这可能看起来过于复杂，但您可以决定将其他策略添加到组合中。

如果使用普通继承（使用多态性），添加新的正交行为意味着类的数量会呈指数增长，但使用这种方法，您可以单独实现每个不同的部分并将其粘合到 Action 模板中。

例如，您可以使您的操作周期性并添加一个退出策略来确定何时退出周期性循环。首先想到的选项是 LoopPolicy_NRuns 和 LoopPolicy_TimeSpan、LoopPolicy_Until。这个策略方法（在我的例子中是 exit()）为每个循环调用一次。第一个实现在一个固定的数字（由用户固定，如上例中固定的周期）之后计算它被称为退出的次数。第二种实现将在给定的时间段内定期运行该过程，而最后一个实现将运行该过程直到给定时间（时钟）。

如果你还跟着我到这里，我确实会做出一些改变。第一个是，不是使用实现方法 execute() 的模板参数命令，而是使用函子，可能还有一个模板化的构造函数，它将命令作为参数执行。基本原理是，这将使其与其他库（如 boost::bind 或 boost::lambda）结合起来更具可扩展性，因为在这种情况下，命令可以在实例化时绑定到任何自由函数、仿函数或成员方法一类的。

现在我得走了，但如果您有兴趣，我可以尝试发布修改后的版本。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-18T20:17:25.283

继承实现的面向实现的菱形继承（有风险）与继承接口或标记接口的面向子类型的继承（通常有用）之间存在设计质量差异。

一般来说，如果你能避免前者，你会更好，因为在某个地方，确切调用的方法可能会导致问题，并且虚拟基础、状态等的重要性开始变得重要。事实上，Java 不允许你拉这样的东西，它只支持接口层次结构。

我认为您可以为此提出的“最干净”的设计是有效地将菱形中的所有类转换为模拟接口（通过没有状态信息，并且具有纯虚拟方法）。这减少了歧义的影响。当然，您可以为此使用多重甚至菱形继承，就像在 Java 中使用实现一样。

然后，拥有这些接口的一组具体实现，这些接口可以以不同的方式实现（例如，聚合，甚至继承）。

封装这个框架，以便外部客户端只获取接口，而不会直接与具体类型交互，并确保彻底测试您的实现。

当然，这是很多工作，但如果您正在编写一个可重用的中央 API，这可能是您最好的选择。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-18T20:18:39.603

本周我遇到了这个问题，发现一篇关于 DDJ 的文章解释了这些问题以及何时应该或不应该关注这些问题。这里是：

[“多重继承被认为是有用的”](http://www.ddj.com/cpp/184402074)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-18T23:49:46.930

接口继承层次结构中的“钻石”是相当安全的——它是代码的继承让你陷入困境。

为了获得代码重用，我建议您考虑 mixins（如果您不熟悉 tequnique，请使用谷歌搜索 C++ Mixins）。使用 mixin 时，您感觉可以“去购物”来获取实现类所需的代码片段，而无需使用有状态类的多重继承。

因此，模式是 - 接口的多重继承和单个 mixins 链（给您代码重用）来帮助实现具体类。

希望有帮助！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-18T20:29:50.127

以第一个例子......

它是否 ActionRead ActionWrite 需要是 action 的子类。

因为你最终会得到一个无论如何都会是一个动作的具体类，你可以只继承 actionread 和 actionwrite 而它们本身不是动作。

但是，您可以发明需要它们成为动作的代码。但总的来说，我会尝试将 Action、Read、Write 和 Delay 分开，而具体的类将所有这些混合在一起

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-18T22:35:41.383

如果不知道你在做什么，我可能会重新组织一下。我将创建多态读写类，而不是所有这些版本的动作的多重继承，并将其实例化为委托。

类似于以下内容（没有钻石继承）：

在这里，我介绍了实现可选延迟的多种方法之一，并假设延迟方法对所有读者都是相同的。每个子类可能都有自己的延迟实现，在这种情况下，您将传递给 Read 和相应派生延迟类的实例。

```
class Action // abstract
{
   // Reader and writer would be abstract classes (if not interfaces)
   // from which you would derive to implement the specific
   // read and write protocols.

   class Reader // abstract
   {
      Class Delay {...};
      Delay *optional_delay; // NULL when no delay
      Reader (bool with_delay)
      : optional_delay(with_delay ? new Delay() : NULL)
      {};
      ....
   };

   class Writer {... }; // abstract

   Reader  *reader; // may be NULL if not a reader
   Writer  *writer; // may be NULL if not a writer

   Action (Reader *_reader, Writer *_writer)
   : reader(_reader)
   , writer(_writer)
   {};

   void read()
   { if (reader) reader->read(); }
   void write()
   { if (writer)  writer->write(); }
};

Class Flow : public Action
{
   // Here you would likely have enhanced version
   // of read and write specific that implements Flow behaviour
   // That would be comment to FlowA and FlowB
   class Reader : public Action::Reader {...}
   class Writer : public Action::Writer {...}
   // for Reader and W
   Flow (Reader *_reader, Writer *_writer)
   : Action(_reader,_writer)
   , writer(_writer)
   {};
};

class FlowA :public Flow  // concrete
{
    class Reader : public Flow::Reader {...} // concrete
    // The full implementation for reading A flows
    // Apparently flow A has no write ability
    FlowA(bool with_delay)
    : Flow (new FlowA::Reader(with_delay),NULL) // NULL indicates is not a writer
    {};
};

class FlowB : public Flow // concrete
{
    class Reader : public Flow::Reader {...} // concrete
    // The full implementation for reading B flows
    // Apparently flow B has no write ability
    FlowB(bool with_delay)
    : Flow (new FlowB::Reader(with_delay),NULL) // NULL indicates is not a writer
    {};
}; 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-12-18T20:49:43.750

对于案例 2，不`OneCommand`只是 的一个特例`CompositeCommand`吗？如果您消除`OneCommand`并允许`CompositeCommand`s 只有一个元素，我认为您的设计会变得更简单：

```
 CommandAbstraction
                 /          \
                /            \
               /              \
        ModernCommand      CompositeCommand
               \               /
                \             /
                 \           /
             ModernCompositeCommand 
```

你仍然有可怕的钻石，但我认为这可能是一个可以接受的情况。

# sql - 理解复杂 SQL 语句的最佳方法？

> ID：379062
> 
> 赞同：55
> 
> 时间：2008-12-18T20:05:31.873
> 
> 标签：sql, database

有没有人有办法理解复杂的 SQL 语句？在阅读结构化 / OO 代码时，通常会有抽象层帮助您将其分解为可管理的块。但是，通常在 SQL 中，您似乎必须同时跟踪查询的多个部分中发生的情况。

这个问题的推动力是这个问题中讨论的[关于复杂连接](https://stackoverflow.com/questions/378548/need-help-with-a-complex-join-statement-in-sql)的 SQL 查询。在盯着答案查询几分钟后，我最终决定使用特定记录逐步完成查询，看看发生了什么。这是我能想到的逐条理解查询的唯一方法。

有没有更好的方法将 SQL 查询分解为可管理的部分？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2008-12-18T20:47:31.010

当我查看一段复杂的 SQL 代码时，我就是这样做的。

首先，如果它是更新或删除，我添加代码（如果它不存在并被注释掉）以使其成为一个选择。永远不要在第一次尝试更新或删除之前在选择中看到结果。如果是更新，我确保选择显示当前值以及我将设置它的内容，以确保我得到所需的结果。

理解连接对于理解复杂的 SQL 至关重要。每次加入我都会问自己为什么会在这里？有四个基本原因。您需要一个列用于 select，您需要一个字段用于 where 子句，您需要连接作为到第三个表的桥梁，或者您需要连接到该表以过滤记录（例如检索有订单的客户的详细信息）但不需要订单详细信息，通常可以使用 IF EXISTS where 子句做得更好）。如果是左连接或右连接（我倾向于重写，所以一切都是左连接，这让生活更简单。），我会考虑内连接是否可行。为什么我需要左连接？如果我不知道答案，我会以两种方式运行它，看看数据中有什么区别。如果有派生表，我将首先查看那些（仅运行选择的那部分以查看结果）以了解它存在的原因。如果有子查询，我会尝试理解它们，如果它们很慢，我会尝试转换为派生表，因为它们通常要快得多。

接下来，我看看`where`条款。在这里，您的特定数据库的坚实基础将派上用场。例如，在我的数据库中，我知道在什么情况下我可能只需要查看邮寄地址，以及在什么情况下我可能需要查看其他地址。这有助于我知道 where 子句中是否缺少某些内容。否则，我会考虑`where`子句中的每个项目并弄清楚为什么它需要存在，然后我会考虑是否缺少任何应该存在的东西。看完之后，我考虑是否可以进行调整以使查询变得可搜索。

接下来我还会考虑选择列表的任何复杂位。该案例陈述的作用是什么？为什么会有子查询？这些函数有什么作用？（我总是查找我不熟悉的任何功能的功能代码。）为什么会有不同的？可以通过使用派生表或聚合函数和分组语句来摆脱它吗？

**最后也是最重要的**，我运行选择并根据我对业务的了解确定结果是否正确。*如果你不了解你的业务，你就不会知道查询是否正确*。语法正确并不意味着正确的结果。通常，您现有的用户界面的一部分可以用作您的结果是否正确的指南。如果我有一个显示客户订单的屏幕，并且我正在做一份包含客户订单的报告，我可能会抽查一些个别客户以确保它显示正确的结果。

如果当前查询过滤不正确，我将删除它的一些部分以找出是什么摆脱了我不想要的记录或添加了我不想要的记录。通常您会发现连接是一对多的，并且您需要一对一（在这种情况下使用派生表！）或者您会发现您认为`where`子句中需要的某些信息并不适用于所有人您需要的数据或`where`缺少某些条款的数据。它有助于将所有字段都包含在`where`执行此操作时选择中的子句（如果它们不在选择中）。它甚至可能有助于显示所有连接表中的所有字段并真正查看数据。当我这样做时，我经常在 where 子句中添加一点点来抓取我拥有的一些不应该存在的记录，而不是所有记录。

一个会破坏大量查询的偷偷摸摸的事情是`where`引用左连接右侧表中字段的子句。这把它变成了一个内部连接。如果您确实需要左连接，则应将这些条件添加到连接本身。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-12-18T20:19:47.010

这些可能是一些有用的提示..

*   **评论**- 弄清楚一小部分的作用并对其进行评论，以便您稍后回顾它时理解它。
*   **语法突出显示**- 确保您正在查看代码，其中包含对查询进行颜色编码的内容。
*   **缩进**- 重新组织查询以对您有意义.. 选项卡结束，添加回车。

例如：

```
select ID, Description, Status from ABC where Status = 1 OR Status = 3 
```

可以更好地写为：

```
select 
  ID,
  Description,
  Status
from ABC
where
  Status = 1 OR
  Status = 3 
```

使用更复杂的查询，您会看到更大的好处。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2008-12-18T20:15:44.477

这是解开查询的过程。

1.  首先我格式化SQL。
2.  然后我注释掉除最基本或最重要的表的基本部分之外的所有部分 SQL 来回答问题。
3.  然后我将开始取消注释连接、选择列、分组、排序字段和过滤器以隔离查询的不同部分以查看发生了什么。或在某些工具中突出显示执行。
4.  子查询通常可以独立执行。

执行这些通常可以让我更好地掌握查询中发生的事情。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2008-12-18T20:33:37.963

缩进和注释有很大帮助。我遇到的最有价值的事情是 WITH 语句。它在 Oracle 中，处理子查询重构。它允许您将大型查询分解为一组看似较小的查询。每个都更易于管理。

这是一个例子

```
WITH 
ssnInfo AS
(
    SELECT                   SSN, 
           UPPER(LAST_NAME)  LAST_NAME, 
           UPPER(FIRST_NAME) FIRST_NAME, 
                             TAXABLE_INCOME,          
                             CHARITABLE_DONATIONS
    FROM IRS_MASTER_FILE
    WHERE STATE = 'MN'                 AND -- limit to in-state
          TAXABLE_INCOME > 250000      AND -- is rich 
          CHARITABLE_DONATIONS > 5000      -- might donate too

),
doltishApplicants AS
(
    SELECT SSN, 
           SAT_SCORE,
           SUBMISSION_DATE
    FROM COLLEGE_ADMISSIONS
    WHERE SAT_SCORE < 100          -- About as smart as a Moose.
),
todaysAdmissions AS
(
    SELECT doltishApplicants.SSN, 
           TRUNC(SUBMISSION_DATE)  SUBMIT_DATE, 
                                   FIRST_NAME
    FROM ssnInfo,
         doltishApplicants
    WHERE ssnInfo.SSN = doltishApplicants.SSN

)
SELECT 'Dear ' || FIRST_NAME || 
       ' your admission to WhatsaMattaU has been accepted.'
FROM todaysAdmissions
WHERE SUBMIT_DATE = TRUNC(SYSDATE)    -- For stuff received today only
; 
```

内联视图也可以做同样的事情，但是 with 还可以在需要时创建临时表。在某些情况下，您可以复制出子查询并在大查询的上下文之外执行它。

此表单还允许您将过滤子句与单个子查询一起放置，并保存连接子句以供最终选择。

在工作中，我们的开发团队通常发现它们更易于维护，而且通常更快。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2008-12-18T20:14:01.670

大多数情况下，这只是经验和适当的缩进。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-12-18T20:22:51.823

格式化会有所帮助，但理解集合论以及扩展的关系理论会更有帮助。

对查询如何执行的模糊理解也不会受到伤害（表扫描、索引扫描、索引跳转、哈希表合并等）；查询规划器可以向您展示这些操作

一些操作（有、存在、有）一开始可能很麻烦

首先了解每个表会发生什么，以及表是如何连接的

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-12-18T20:14:03.060

我想这一切都取决于经验。我没有发现这些问题中的查询非常复杂，也许是因为我运行的大多数查询都比那些更复杂。

正确的编码标准肯定有助于理解查询，因为它允许将查询分成视觉上更小和格式更好的块。当涉及子查询时，最好先了解子查询做什么，然后在查看完整查询时使用这种理解。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-12-18T20:36:15.603

另一个重要的是使用标准连接语法：

```
SELECT A 
  FROM B
  JOIN C ON B.ID = C.ID
 WHERE C.X = 1 
```

代替

```
SELECT A 
  FROM B
     , C 
 WHERE B.ID = C.ID 
   AND C.X = 1 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-12-18T20:44:04.497

与任何事情一样，最好的方法是自己编写大量复杂的 SQL 语句。最终，事物结构的一般方式变得显而易见。当然，如果您正在寻找快速的东西，那可能不是这样。

留白非常重要。当存在适当的空白时，看起来非常复杂的查询看起来几乎是简单的。

至于连接......好吧，我很抱歉，但我在这里帮不上忙，因为我的回答是理解特定连接的最佳方法是了解连接的一般工作方式。每种类型的连接都有一个非常特定的目的，如果您知道它们是如何工作的，那么将 x 连接到 y、x 连接到 y 到 z 或 x 和 y 连接到 a 和 b 应该没有太大区别。

然而，更直接的帮助是知道您需要先查看最里面的部分。与您可能习惯于大规模查看事物然后深入研究粒度的代码相反，如果您从粒度开始并向外工作，查询会更有帮助且更容易理解。

从任何子查询开始，弄清楚它们在单独的部分中正在做什么，将其视为单个查询（如果可能），然后逐步逐步移出，直到您处于顶部。再一次，关于连接......真的，只要找到一个解释连接的网页并做一些测试，直到你完全理解它们。没有真正的方法可以让这变得更容易，因为一旦你理解了它们，你几乎可以通过你想要的连接找出任何东西。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2017-07-05T10:22:49.277

我发现回到逻辑查询处理阶段并使用示例数据一点一点地取消查询通常很有帮助。

（以下内容是从 Inside Microsoft SQL Server 2005 中借用的：T-SQL 查询，作者 Itzik Ben-Gan。）

```
(8) SELECT (9) DISTINCT (11) <TOP_specification> <select_list>
(1) FROM <left_table>
(3) <join_type> JOIN <right_table>
(2) ON <join_condition>
(4) WHERE <where_condition>
(5) GROUP BY <group_by_list>
(6) WITH {CUBE | ROLLUP}
(7) HAVING <having_condition>
(10) ORDER BY <order_by_list> 
```

1.  **FROM**：在 FROM 子句中的前两个表之间进行笛卡尔积（交叉连接），结果生成虚拟表 VT1。
2.  **ON** : ON 滤波器应用于 VT1。仅将 TRUE 的行插入到 VT2。
3.  **OUTER (join)**：如果指定了 OUTER JOIN（与 CROSS JOIN 或 INNER JOIN 相对），则将保留表中的行或未找到匹配的表添加到 VT2 的行中作为外部行，生成VT3。如果 FROM 子句中出现两个以上的表，则在最后一个连接的结果和 FROM 子句中的下一个表之间重复应用步骤 1 到 3，直到处理完所有表。
4.  **WHERE** : WHERE 过滤器应用于 VT3。仅将 TRUE 的行插入到 VT4。
5.  **GROUP BY**：VT4 中的行根据 GROUP BY 子句中指定的列列表分组排列。产生VT5。
6.  **立方体 | ROLLUP**：将超组（组的组）添加到 VT5 的行中，生成 VT6。
7.  **HAVING** : HAVING 过滤器应用于 VT6。仅将 TRUE 的组插入到 VT7。
8.  **SELECT**：处理 SELECT 列表，生成 VT8。
9.  **DISTINCT**：从 VT8 中删除重复的行。产生VT9。
10.  **ORDER BY**：VT9 中的行根据 ORDER BY 子句中指定的列列表进行排序。生成游标 (VC10)。
11.  **TOP**：从 VC10 的开头选择指定的行数或百分比。表 VT11 生成并返回给调用者。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-12-18T20:16:02.510

你在做我做的事。我的第一个使查询易于理解的工具是良好的视觉组织，你提到的问题中的人主要是这样做的，并使用 LIMIT 子句在可管理的块中进行测试。如果涉及到不相关的子查询，当然可以单独运行。不过，如果有灵丹妙药，我不知道。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-12-18T20:17:42.863

如果这些让你停下来，我建议把表格写在纸上，以便更好地了解将事物连接在一起的意义。

例如，假设您有一个图书表和一个价格表。价格表可能对每本书有多个条目（因为价格可能会改变）。

如果要获取当前书籍和价格的列表，则必须将两个表连接在一起。

我会通过在每本书及其相应的“当前”价格之间绘制箭头来在纸上解决这个问题。然后我会将其写入逻辑，该逻辑将成为连接条件或子查询的一部分。

一旦掌握了窍门，复杂的查询就会更容易解析。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-12-18T20:15:50.607

使用 CTE 或派生表（至少在 MS SQL 中）对于格式化 SQL 语句很有用，而无需使用临时表将其拆分为单独的查询来“连接”它们。

我同意其他人的观点，即上述查询非常简单。

我看着 c#，想知道为什么你有这么多行来简单地处理几千行......

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-12-18T20:30:17.190

如果您使用的是 PostgreSQL，那么视图封装对此非常有用。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-12-18T21:14:53.530

我将其分解为更小的查询（这就是为什么我更喜欢子查询而不是 JOIN）

有时我什至将子查询的结果保存为表并在主查询中使用。这有点像通过将位保存到局部变量中然后在表达式的下一部分对局部变量进行操作来简化代码表达式。

我热衷于始终使用表别名（例如 CLIENT_HISTORY_ITEM T1）和标准表达式周围的括号。我经常为查询的每个部分将表别名数更改十左右，以​​便我可以看到来自哪里的内容：

从表 1 T1 中选择 T1.ID，其中 T1.DATE =（从表 1 T11 中选择 MAX（T11.DATE），其中（T1.AREA = T11.AREA））

干杯

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2014-03-02T02:20:28.127

查询优化器可以处理很多事情，包括将子查询实现为连接。如今，他们甚至可以处理不相关的子查询。

在大多数情况下，清晰度比性能更重要，子查询更容易调试。

顺便说一句：你为​​什么使用令人困惑的表别名？

# perl - 如何使用 SOAP::Lite 获得详细（或调试）输出？

> ID：379068
> 
> 赞同：3
> 
> 时间：2008-12-18T20:07:03.417
> 
> 标签：perl

我有一个可用的 SOAP::Lite 客户端。它适用于已建立的服务器，但到目前为止，我的开发服务器除了 404 之外什么都没有发回。（这很奇怪，因为我什至没有看到服务器端的连接。）

我习惯的最接近的平行线是`Net::FTP`.

```
my $ftp = Net::FTP->new( "some.host.name", Debug => 1 ); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-18T20:11:10.943

我是否建议使用像[wireshark](http://www.wireshark.org/)这样的工具来捕获 SOAP 应用程序的网络流量，以准确了解网络中发生了什么。您应该能够右键单击一系列数据包并选择“Follow TCP Stream”以查看完整的 HTTP 交换。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-18T20:25:28.980

您看到[SOAP::Trace](http://search.cpan.org/~mkutter/SOAP-Lite/lib/OldDocs/SOAP/Lite.pm#SOAP::Trace)的文档了吗？我自己没有尝试过，但这一切听起来很有希望。

# git - 跟踪所有远程 git 分支作为本地分支

> ID：379081
> 
> 赞同：198
> 
> 时间：2008-12-18T20:11:55.870
> 
> 标签：git, branch

将单个远程分支作为本地分支进行跟踪非常简单。

```
$ git checkout --track -b ${branch_name} origin/${branch_name} 
```

将所有本地分支推送到远程，根据需要创建新的远程分支也很容易。

```
$ git push --all origin 
```

我想做相反的事情。如果我在一个来源有 X 个远程分支：

```
$ git branch -r 
branch1
branch2
branch3
.
.
. 
```

我可以为所有这些远程分支创建本地跟踪分支，而无需手动创建每个分支吗？像这样说：

```
$ git checkout --track -b --all origin 
```

我已经用谷歌搜索和 RTM，但到目前为止已经出现了铺位。

* * *

## 回答 #1

> 赞同：194
> 
> 时间：2010-06-23T07:15:08.623

Otto给出的答案很好，但是所有创建的分支都会以“origin/”作为名称的开头。如果您只想将最后一部分（最后一个 / 之后）作为结果分支名称，请使用以下命令：

```
for remote in `git branch -r | grep -v /HEAD`; do git checkout --track $remote ; done 
```

它还有一个好处是不会给你任何关于模棱两可的参考的警告。

* * *

## 回答 #2

> 赞同：136
> 
> 时间：2008-12-19T01:03:15.847

使用 bash：

**在 git 1.9.1 之后**

```
for i in `git branch -a | grep remote | grep -v HEAD | grep -v master`; do git branch --track ${i#remotes/origin/} $i; done 
```

> **学分：** Val Blant、埃利亚斯和雨果

**在 git 1.9.1 之前**

> **注意：**以下代码如果用在更高版本的 git (>v1.9.1) 中会导致
> 
> 1.  （bug）所有创建的分支来跟踪master
> 2.  （烦恼）所有创建的本地分支名称都以`origin/`

```
for remote in `git branch -r `; do git branch --track $remote; done 
```

更新分支，假设您的本地跟踪分支没有更改：

```
for remote in `git branch -r `; do git checkout $remote ; git pull; done 
```

忽略模棱两可的 refname 警告，git 似乎更喜欢本地分支。

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2014-12-01T18:29:21.830

这里的大多数答案都过于复杂化输出的解析`git branch -r`。您可以使用以下`for`循环针对远程上的所有分支创建跟踪分支，如下所示。

### 例子

假设我有这些远程分支。

```
$ git branch -r
  origin/HEAD -> origin/master
  origin/development
  origin/integration
  origin/master
  origin/production
  origin/staging 
```

确认我们没有在本地跟踪除 master 以外的任何内容：

```
$ git branch -l    # or using just git branch
* master 
```

您可以使用这一行来创建跟踪分支：

```
$ for i in $(git branch -r | grep -vE "HEAD|master"); do 
    git branch --track ${i#*/} $i; done
Branch development set up to track remote branch development from origin.
Branch integration set up to track remote branch integration from origin.
Branch production set up to track remote branch production from origin.
Branch staging set up to track remote branch staging from origin. 
```

现在确认：

```
$ git branch
  development
  integration
* master
  production
  staging 
```

要删除它们：

```
$ git br -D production development integration staging 
Deleted branch production (was xxxxx).
Deleted branch development (was xxxxx).
Deleted branch integration (was xxxxx).
Deleted branch staging (was xxxxx). 
```

如果您使用`-vv`开关，`git branch`您可以确认：

```
$ git br -vv
  development xxxxx [origin/development] commit log msg ....
  integration xxxxx [origin/integration] commit log msg ....
* master      xxxxx [origin/master] commit log msg ....
  production  xxxxx [origin/production] commit log msg ....
  staging     xxxxx [origin/staging] commit log msg .... 
```

### for循环的分解

循环基本上调用命令`git branch -r`，过滤掉输出中的任何 HEAD 或 master 分支`grep -vE "HEAD|master"`。为了只得到分支的名称减去`origin/`子字符串，我们使用 Bash 的字符串操作`${var#stringtoremove}`。这将从变量中删除字符串“stringtoremove” `$var`。在我们的例子中，我们`origin/`从变量中删除字符串`$i`。

**注意：**或者，您也可以使用它`git checkout --track ...`来执行此操作：

```
$ for i in $(git branch -r | grep -vE "HEAD|master" | sed 's/^[ ]\+//'); do 
    git checkout --track $i; done 
```

但我并不特别关心这种方法，因为它会在执行结帐时在分支之间切换。完成后，它会将您留在它创建的最后一个分支上。

### 参考

*   [10.1。操作字符串 - 高级 Bash 脚本指南](http://tldp.org/LDP/abs/html/string-manipulation.html)
*   [3.5 Git 分支 - 远程分支](http://git-scm.com/book/en/v2/Git-Branching-Remote-Branches)

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2011-06-09T23:18:23.250

2020 年第一季度更新：[Mohsen Abasi](https://stackoverflow.com/users/659077/mohsen-abasi)[在评论](https://stackoverflow.com/questions/379081/track-all-remote-git-branches-as-local-branches/6300386?noredirect=1#comment107241471_6300386)中根据 2014 年[slm](https://stackoverflow.com/users/33204/slm)的[回答](https://stackoverflow.com/a/27234826/6309)提出了更简单的替代方案：

```
for i in $(git branch -r | grep -vE "HEAD|master" | sed 's/^[ ]\+//'); 
```

它使用[`$()`而不是过时的反引号](https://stackoverflow.com/a/24592916/6309)。

[正如我在另一个旧答案](https://stackoverflow.com/a/2514279/6309)[`git for-each-ref`](https://git-scm.com/docs/git-for-each-ref)中提到的，使用[可能更快](https://stackoverflow.com/a/41307509/6309)。
我会使用新的（Git 2.23+）[`git switch`命令](https://git-scm.com/docs/git-switch#Documentation/git-switch.txt--t)，它取代了[令人困惑`git checkout`](https://stackoverflow.com/a/57066202/6309)的.

```
for i in $(git for-each-ref --format=%(refname:short) \
  --no-merged=origin/HEAD refs/remotes/origin); do \
    git switch --track $i; \
done 
```

这样，就`grep`不需要了。

* * *

旧（2011）原始答案：

这是我使用的单行代码（在 bash shell 中，使用 msysgit1.7.4 测试）：

对于复制粘贴：

```
remote=origin ; for brname in `git branch -r | grep $remote | grep -v master | grep -v HEAD | awk '{gsub(/^[^\/]+\//,"",$1); print $1}'`; do git branch --set-upstream-to $remote/$brname $brname; done 
```

为了提高可读性：

```
remote=origin ; // put here the name of the remote you want
for brname in `
    git branch -r | grep $remote | grep -v master | grep -v HEAD 
    | awk '{gsub(/^[^\/]+\//,"",$1); print $1}'
`; do 
    git branch --set-upstream-to $remote/$brname $brname; 
done 
```

*   它只会从您在`remote`变量中指定的远程选择上游分支（它可以是 ' `origin`' 或您为当前 Git 存储库的远程之一设置的任何名称）。
*   它将提取分支的名称：`origin/a/Branch/Name => a/Branch/Name`通过`awk`表达式。
*   它将[通过`--set-upstream-to`(or `-u`)](https://stackoverflow.com/a/10002469/6309)设置上游分支，而不是`--track`：
    优点是，如果分支已经存在，它不会失败并且不会更改该分支来源，它只会配置`branch.xxx.(remote|merge)`设置。

    ```
    branch.aBranchName.remote=origin
    branch.aBranchName.merge=refs/heads/a/Branch/Name 
    ```

该命令将为所有远程上游分支创建本地分支，并将其远程和合并设置设置为该远程分支。

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2008-12-18T20:48:39.057

你可以很容易地编写脚本，但我不知道它什么时候有价值。这些分支很快就会落后，你必须一直更新它们。

远程分支会自动保持最新，因此最简单的方法是在您实际想要处理的地方创建本地分支。

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2016-05-20T12:03:27.133

没有任何脚本（在一个空目录中）：

```
$ git clone --bare repo_url .git
$ git config core.bare false
$ git checkout 
```

之后，所有远程分支都将被视为本地分支。

* * *

[原文（俄文）](https://ru.stackoverflow.com/a/525643/178576)。

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2014-05-07T21:14:17.910

```
for i in `git branch -a | grep remote`; do git branch --track ${i#remotes/origin/} $i; done 
```

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2016-03-24T15:20:26.397

如果您想使用 powershell 并且您的遥控器称为 origin。然后这行得通。

```
git fetch    
git branch -r  | %{$_ -replace "  origin/"} | %{git branch --track $_ "origin/$_"} 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2013-01-21T05:17:02.243

```
for branch in `git branch -a | grep remotes | grep -v HEAD | grep -v master`; do  git branch --track ${branch##*/} $branch; done 
```

使用这个，你不会有这样的警告： refname 'origin/dev' is ambiguous

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2017-05-05T08:17:49.367

这是我对@tjmcewan 引用的 BASH 命令的解决方案：

```
for remote in `git branch -r | grep -v /HEAD `; do git branch --track ${remote/"origin/"/""}; done 
```

* * *

我的目标是解决所有创建的分支都以“origin/”作为名称开头的问题，因为我测试了 $remote 变量仍然包含“origin/”：

```
for remote in `git branch -r | grep -v /HEAD`; do echo $remote ; done 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2020-02-07T13:51:17.913

从 git 2.23 开始：

```
for branch in `git branch -r | grep origin/`; do git switch -t -C ${branch#origin/} $branch; git pull; done 
```

如果`-C`标志`git switch`已经存在，则创建或重置。

[git 切换文档](https://git-scm.com/docs/git-switch)

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2014-09-04T19:38:10.417

[要与tjmcewan 的答案](https://stackoverflow.com/a/3099621/724176)相同，但在 Windows 上，请从**批处理文件**中调用它：

```
for /f "delims=" %%r in ('git branch -r ^| grep -v master') do git checkout --track %%r 
```

或者**从命令行**：

```
for /f "delims=" %r in ('git branch -r ^| grep -v master') do git checkout --track %r 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2020-12-18T20:12:40.507

通过更改 sed 可以进一步简化 VonC 的解决方案（我缺乏代表点来直接评论他的帖子）：

```
for branch in $(git branch -r | sed 's,[^/]*/,,g'); do git switch $branch; done 
```

通过将不是斜线的所有内容替换到最后的斜线，剩余的分支名称适合本地使用；重复切换到同一个分支不是错误（它可能效率低下，但它可能比管道中的 grep 更有效：->）。

switch 命令足够智能，可以根据需要跟踪每个远程分支。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2012-06-26T10:19:55.487

如果您已经签出一些分支机构并想要

*   从远程检查所有剩余的分支
*   确保所有本地分支都跟踪远程分支

您可以使用以下 bash 和 zsh 兼容的脚本：

```
git branch -r | while read b; do if git branch | grep -q " ${b##*/}$"; then git branch --set-upstream ${b##*/} $b; else git branch --track ${b##*/} $b; fi; done 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2013-10-15T11:57:55.420

```
for rembranch in `git remote update 2>&1 > /dev/null ; git branch -r|egrep -wv "HEAD|master"`
do 
    git checkout --track -b `echo $rembranch|awk -F\/ '{print $2}'` $rembranch; 
done 
```

解释：

第 1 行：“git branch -r”（后跟“git remote update”以更新远程更改信息）列出所有远程分支；'egrep -vw' 用于敲除结果中包含 HEAD 和 master 的条目。

第 3 行：在本地签出时跟踪命名的远程分支。一个简单的 awk 用于避免 'origin/' 成为本地分支的后缀。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2018-09-04T01:05:36.820

使用 bash，如果要检查所有分支：

```
for remote in `git branch -r`; do git checkout $(echo $remote | cut -d'/' -f 2); done 
```

重要的是要注意，当您执行 fetch 会关闭新的远程跟踪分支时，您不会自动拥有它们的本地、可编辑副本。

# .net - 自动化测试 .NET（Gallio？）

> ID：379091
> 
> 赞同：5
> 
> 时间：2008-12-18T20:14:54.837
> 
> 标签：.net, unit-testing, automated-tests

我正在开发一个软件开发项目，该项目使用主要用 C 和 C# 编写的代码。目前，测试的责任主要落在开发人员更改代码时。

我有兴趣实现一个自动化测试框架来帮助我们提高代码质量。特别是，每次将代码提交给版本控制时运行自动化测试会很棒。

我在自动化测试（或单元测试）方面没有太多经验。有没有人使用 C/C# 的测试框架进行过开发，如果是这样，我们在公司范围内以及在相当大的现有代码库上实施它可能会面临哪些障碍？

特别是，我一直在研究如何使用[Gallio](http://www.gallio.org/)。对此特定产品的任何评论将不胜感激。

**附加信息**：

[将单元测试添加到现有项目](https://stackoverflow.com/questions/223421/adding-unit-tests-to-an-existing-project)
[单元测试 旧版 ASP.NET Webforms 应用程序](https://stackoverflow.com/questions/342693/unit-testing-legacy-web-apps)
[将现有代码移动到测试驱动开发](https://stackoverflow.com/questions/167079/moving-existing-code-to-test-driven-development)
[最喜欢的 .NET 单元测试框架](https://stackoverflow.com/questions/127687/favorite-net-unit-testing-framework)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-18T20:20:00.880

坦率地说，这听起来像是你在寻找不这样做的理由。只需获取 NUnit 并开始使用。从最小的一块开始，让你的脚湿透。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-13T06:39:32.290

Gallio 实际上是整个测试工具链的框架。从编写测试到运行它们再到发布构建过程。它为每个步骤提供通用设施和标准化接口，以便在将构建过程放在一起时提供更大的选择和灵活性。

它带有一个默认使用的 MbUnit 框架版本。它还带有一个名为 Icarus 的 GUI 运行程序和一个名为 Echo 的控制台运行程序。它们都是测试社区中备受推崇的工具。

对于大型公司来说，它是一个绝佳的选择，因为它可以让您利用许多流行的测试和持续集成工具，而无需担心集成问题。

选择框架和编写测试只是成功的一半，Gallio 确实帮助了另一半；粘合构建过程中的所有其他步骤。

目前唯一真正的缺点是缺乏示例和信息的中央存储库。对于一些人来说，它是一个相对较新的举措，这一事实可能会让他们现在就不再使用它。

[Check out the docs here.](http://www.gallio.org/book/GallioBook.pdf) They are a work in progress and very incomplete but will get you started on the basics of writing tests. Keep your eyes on [Jeff Browns Blog](http://blog.bits-in-motion.com/) for other information.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-18T20:21:10.097

当我使用它时（几年前），TestComplete 很不错且易于使用。至少，你需要学习一些 VBScript。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-18T20:24:45.080

我们使用来自 AutomatedQA 的 TestComplete，它是一个不错的 gui 测试平台。我们在 Jscript 中完成所有的 TestComplete 代码，这不是很好，但它完成了工作。我不确定我是否会推荐自动化 GUI 测试，但我认为你会在单元测试中获得更好的回报。

Nunit 和 rhino mock 是很好的单元测试工具。

[CruiseControl](http://confluence.public.thoughtworks.org/display/CCNET/Welcome+to+CruiseControl.NET)看起来像是在每个构建上设置自动化测试的最佳方式。

# c# - C#：使用泛型时指定“默认”关键字的行为

> ID：379105
> 
> 赞同：0
> 
> 时间：2008-12-18T20:17:52.537
> 
> 标签：c#, generics

是否可以指定我自己的默认对象而不是 null？我想在某些对象上定义我自己的默认属性。

例如，如果我有一个具有属性 bar 和 baz 的对象 foo，而不是默认返回 null，我希望它是 foo 的实例，bar 设置为“abc”，baz 设置为“def”——这是可能的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-18T20:24:42.740

您必须使用构造函数来获得该功能。因此，您不能使用默认值。

但是，如果您的目标是确保泛型类中传递类型的某种状态，那么可能仍有希望。如果要确保传递的类型是可实例化的，请使用泛型约束。new() 约束。这确保了类型 T 有一个公共的无参数构造函数。

```
public class GenericClass<T> where T : new() {
    //class definition

    private void SomeMethod() {
        T myT = new T();
        //work with myT
    }
} 
```

不幸的是，您不能使用它来获取有参数的构造函数，只能使用无参数构造函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-18T20:19:58.040

不，你不能。对不起。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-18T20:41:57.403

您不能使用“默认”，但也许这不是正确的工具。

详细地说，“默认”会将所有引用类型初始化为 null。

```
public class foo
{
    public string bar = "abc";
}

public class Container<T>
{
    T MaybeFoo = default;
}

a = new Container<foo>();

// a.MaybeFoo is null; 
```

换句话说，“默认”不会创建实例。

但是，如果您愿意保证类型 T 具有公共构造函数，您也许可以实现您想要的。

```
public class foo
{
    public string bar = "abc";
}

public class Container<T> where T : new()
{
    T MaybeFoo = new T();
}

a = new Container<foo>();

Console.WriteLine( ((Foo)a.MaybeFoo).bar )  // prints "abc" 
```

# datagrid - 使用 dojo 工具包的网格时，如何使列无法排序？

> ID：379115
> 
> 赞同：2
> 
> 时间：2008-12-18T20:20:42.687
> 
> 标签：datagrid, dojo

我有一个不想排序的网格（dojox.grid v1.2）。我怎样才能禁用它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-18T20:50:43.843

找到了：

[http://dojotoolkit.org/forum/dojox-dojox/dojox-grid-support/disable-sorting-specific-column-0](http://dojotoolkit.org/forum/dojox-dojox/dojox-grid-support/disable-sorting-specific-column-0)

要保存链接：

在您的 onload 或 postrender 中添加如下代码：

`dojo.byId('myGridId').canSort = function(col){ if(Math.abs(col) == 3) { return false; } else { return true; } };`

（请注意，在此设置中，列似乎从 1 开始索引。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-12T14:29:18.757

如果您以编程方式创建网格，则可以执行以下操作：

```
var grid = new dojox.grid.DataGrid({ 
               ..., 
               canSort: function(col) { return col != 3; }
           }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-15T13:05:09.813

使用属性`canSort : false`隐藏或禁用代码中的排序按钮`Dojo DataGrid`：

```
var newGrid = new DataGrid({

        id : 'newGrid',

        canSort:false,

        store : this.resultStore,

        structure : this.resultGridLayout,

        autoHeight:true
}); 
```

问候，

Satish M Hiremath

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-01-09T14:47:10.193

我认为正确的解决方案是

```
dijit.byId('yourgridid').attr('canSort', function(col){

    if(Math.abs(col) == 3) {
      return false;
    } else {
       return true;
    }

}); 
```

# dynamic-languages - 您如何在动态语言中进行不同的编程？

> ID：379128
> 
> 赞同：30
> 
> 时间：2008-12-18T20:24:22.210
> 
> 标签：dynamic-languages

真正知道如何利用动态编程语言的人与使用静态语言的人如何以不同的方式进行编程？

我熟悉关于静态与动态类型的整个辩论，但这不是我想要的。我想讨论在动态语言中实用但在静态语言中不实用的问题解决技术。

我见过的大多数用动态编程语言编写的代码与用静态编程语言编写的代码并没有太大区别。俗话说，你可以用任何语言写FORTRAN，很多人都这样做。但是有些人使用动态编程语言来解决问题，这种方式不容易转化为例如 C++。他们的一些技巧是什么？

有哪些很好的资源可以讨论如何使用动态编程语言？不是关于语言语法或 API 参考的书籍，而是关于利用动态语言功能解决问题的方法的资源。

编辑（2009 年 1 月 5 日）：我很欣赏下面的答案，但它们似乎并没有解释动态语言倡导者所说的生产力的巨大提高。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-09T04:15:45.683

我喜欢苗条的回答。我确实在 Java 和 C++ 上花费了大量时间来制作 Python/Ruby 中免费的自定义数据结构。并制作专门的函数来处理这些自定义数据结构。是的，在 C++ 中，STL 非常好。是的，Java 中的泛型很好。它们有助于更快地创建自定义数据结构，但是它们仍然需要大量的思考和考虑。

然而，动态语言更容易使用还有一个更根本的原因。这是一个深刻的想法，称为鸭式打字。上面的一些评论提到了鸭子类型，但请花时间思考一下鸭子类型是什么。这是一种根本不同的看待世界的方式。与 Java 和 C++ 等语言不兼容的视图。

鸭子打字意味着您不会浪费时间来定义鸭子是什么。通过不必正式定义您的对象，您可以节省大量时间和精力。获得正确的定义很难。看看我的这篇博客文章，我在其中举了一些例子：[正式定义没有你想象的那么有用](http://www.daniel-lemire.com/blog/archives/2007/12/05/formal-definitions-are-less-useful-than-you-think/)

鸭子打字已被证明非常有用。XML 中的[“必须忽略”原则](http://www.tbray.org/ongoing/When/200x/2006/01/09/On-XML-Language-Design)使 XML 在 Web 上如此重要和有用。但这只是鸭子打字的一个例子。

表达鸭子打字的另一种方式是通过网络口头禅“严格发送，慷慨接受”。这也是一个非常基本的想法。

最后，你可能想回到我的一篇长博文，我解释了鸭子类型以及它与人工智能和建模等事物的关系：[鸭子类型、人工智能和哲学](http://www.daniel-lemire.com/blog/archives/2007/01/27/duck-typing-artificial-intelligence-and-philosophy/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-18T20:38:20.343

我通常发现自己利用动态编程语言的一种方法是简化和澄清语法。例如，如果我代表一个数据库，如果我可以在数据库对象上为其表动态加载属性和方法、为它们的列加载表和行等，我用于与之交互的语法会更清晰. 区别可能在于：

```
$row = $db->getTable('user')->getRow(27);
$row->setValue('name', 'Bob'); 
```

和

```
$row = $db->user->getRow(27);
$row->name = 'Bob'; 
```

当你做复杂的事情时，第二种形式的“视觉噪音节省”真的开始加起来。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-05T20:07:47.940

动态语言可以在运行时改变对象，可以添加方法、属性...

动态语言魔法的一个很好的例子是这个 Groovy 代码片段，它只用两行代码调用 Web 服务上的方法：

```
def proxy = new SoapClient("http://localhost:6980/MathServiceInterface?wsdl");
def result = proxy.add(1.0, 2.0); 
```

这是另一个从 XML 中提取数据的 Groovy 片段：

```
def contacts = new XmlParser().parseText("<contacts><name>Bahaa Zaid</name></contacts>");
def myName = contacts.name[0].text(); 
```

您不能在静态语言中执行此操作。动态语言可以更改对象以反映实际的运行时条件。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-10-14T15:01:07.080

我现在不能引用这个（我的记忆力下降了），但我听说过一些类似的东西：

> 编程行业最接近灵丹妙药的是托管语言——让程序员不必担心内存管理的细节，让他们将更多的精力集中在解决手头的问题上。

所以，我可能会大胆猜测并说，与其说你的编程*方式不同*，不如说你可以将更多的大脑投入到“解决问题”而不是解决方案的实现细节上。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-18T21:00:41.170

在动态语言中，我更具实验性。动态更改内容更容易，因此我可以更快地探索解决方案。

如果我知道自己想做什么，以及通常如何去做，我喜欢 C++。如果我不知道如何做我想做的事，并且可能不完全确定我想做什么，我更喜欢 Lisp。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-09T04:26:35.533

它归结为我最喜欢的比率之一：我花多少时间思考解决问题，与我花多少时间思考我用来解决问题的工具。将其视为等效于 S/N 比。

使用鸭式语言（我认为这是最能帮助我提高生产力的因素），我只是能够花更多的时间思考我的问题及其解决方案（并编写专门解决这些问题的代码），我花更少的时间让语言工件保持直。

还有很多我不写的代码，包括声明，尤其是类型转换。

但这主要是让我的注意力集中在最佳位置。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-19T05:43:16.793

快速迭代使程序员更快乐，而且它们的速度并不比交互式解释器快。良好的解释器开发可以同时为您提供沙盒、测试和原型设计。

但是，请注意通过排列进行编程。我个人的经验法则是，它只是因为它有效并不意味着它已经准备好，当你能解释它为什么有效时，它就已经准备好了。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-05T20:40:58.657

我最大的收获是在数据库和对象（ORM）之间的映射。

如果没有类型的概念，那么将一行中的每一列分配给对象中的一个值就变得非常容易。当然，权衡是您认为存在的值类型与计算机执行的类型之间可能存在不匹配。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-12-18T20:30:41.077

我认为最显着的差异是数据结构的选择。

在 Java 或 CI 中非常严格地定义结构或类。如果我需要添加一个属性，我会返回并更改定义。

在 Perl 中，我将只使用散列，并在编写代码时“发明”键。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-09T04:31:47.517

约翰，根据您对 1/5/09 的更新编辑，您可能会发现[AMOP](http://en.wikipedia.org/wiki/The_Art_of_the_Metaobject_Protocol)是一本有趣的读物，而且您正在考虑更多内容。它非常以 lisp 为中心，但毕竟许多好的动态想法都是从那里开始的。因此，如果您可以享受（或克服）该方面，作者确实讨论了需要并用于执行此类操作的动态方面。这是非常强大的东西。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-05T20:58:51.663

更多的库和更重要的*更有用的库*。

我的猜测是，通常与动态语言相关的“Duck Typing”有助于显着简化代码并使编写通用代码更加容易。您不受严格的类层次结构的限制，因此能够更轻松地将来自不同库的组件组合在一起。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-04-09T12:02:18.120

我没有具体的答案，只是一个建议：看看“ [Ruby 中的设计模式](http://designpatternsinruby.com)”一书：它涵盖了大多数经典设计模式（à la Gamma 等人，等等）并表达了它们，相当简而言之，在 Ruby 中:)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-11-26T01:54:49.827

阅读 Mark Jason Dominus 的“Higher Order Perl”。它只讨论了 Perl，但它确实提供了对 Perl 来说很自然的技术，而在大多数静态语言中却不那么自然。

```
All languages obviously have their strengths and weaknesses and dymanic vs static 
```

只是对语言进行分类的众多方法中的一种。我不会说动态语言作为一个整体比静态语言更好或更差。但我确实认为这本书非常擅长展示使用 Perl 解决问题的不同方法，这在大多数静态语言中会更加困难或不可能。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-12-18T21:16:35.147

动态语言能够执行在运行时创建的代码。如果注入恶意代码，这是非常危险的。但是，如果您可以对环境进行消毒，则非常强大。

我认为 Javascript 人通过执行 JSON 文件来做到这一点。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-10-14T15:15:25.780

对我来说是周转速度。我使用的动态语言（目前是 Python 和一点 JavaScript）都是解释型的。这意味着我可以随时尝试。如果我想看看 API 的某些部分是如何运行的，我可以在解释器上花几分钟时间。

如果我想用像 C# 这样的语言做同样的事情，我必须启动 VS，创建一个项目，然后编译它。如果我想测试我正在开发的更大软件的一部分，我可能必须编译它，这可能需要很长时间。幸运的是，在 .Net 中，我可以从 IronPython 的大项目中加载程序集，并获得一些与解释语言相同的好处（即快速测试 API 的不同部分）。

# .net - Silverlight 中文本框中的行信息/编号

> ID：379131
> 
> 赞同：3
> 
> 时间：2008-12-18T20:24:50.977
> 
> 标签：.net, silverlight

**区域：** Silverlight 中的文本框

**问题：** 我需要知道当前正在编辑的“行号”。

**我尝试过：** 作为一种解决方法，我尝试使用 textBox.Split("\r") 进行拆分，并在 Regex 上计算具有相似性能的匹配项。前 2000 行的性能是可以接受的，但随后会变慢。

**为什么：** 我有一个文本框和一个列表框并排。列表框中的项目索引对应于文本框中的行号，并且（ListboxItem 的）内容是文本框中相应行的“处理”版本。

**替代方案：** 比我的 hack 更适合性能的策略。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-21T00:09:12.783

在我看来，您实际上并不需要使用`string.Split`or `Regex`。只需遍历字符串并将`'\r'`s 计数到插入符号的位置。

```
var s = ...the string...
var r = 0;
var c = ...caret position...

for (var i = 0; i < c; i++)
  if (s[i] == '\r')
    r++; 
```

这样，您无需在内存中创建大量对象即可找到行号...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-08-18T18:08:03.043

这是解决方案。随意改进代码。

演示-> [http://briggs69.blogspot.com/2011/08/solution-maxlines-property-in.html](http://briggs69.blogspot.com/2011/08/solution-maxlines-property-in.html)

来源-> [http://www.codeproject.com/KB/edit/XTextBox.aspx](http://www.codeproject.com/KB/edit/XTextBox.aspx)

# iphone - 键值编码

> ID：379133
> 
> 赞同：5
> 
> 时间：2008-12-18T20:25:07.653
> 
> 标签：iphone, objective-c, cocoa, cocoa-touch, key-value-observing

当我启动一个简单的 iPhone 应用程序时，我有一种直接的方法将 XML 摘录的键/值对转换为 NSDictionary。问题是，我需要将那些曾经填充我的 UITableView 的 NSDictionary 实例转换为自定义类，因为它们需要行为和额外的复杂性。这里的问题是，现在为了让我实例化一个对象并用来自 Web 服务的键/值对填充其实例变量变得更加困难。我不能再将它放入一个遍历 XML 并使用 KVC 设置其实例变量的方法中。

还有什么样的其他解决方案？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-18T20:46:20.403

您仍然可以在自定义类上使用键值编码方法，只要您适当地命名变量，那里就没有区别。尽管如此，当我使用 XML 时，我通常最终会测试每个节点名称或创建一个键查找表，因为我正在使用的数据源中的名称不符合键值编码。但是，如果您可以控制数据源，则可以继续使用`setValue:forKey:`.

如果您还没有，我建议您阅读有关键值编码的[指南。](http://developer.apple.com/documentation/Cocoa/Conceptual/KeyValueCoding/KeyValueCoding.html#//apple_ref/doc/uid/10000107)它是 Cocoa 中许多优秀工具的基础。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-18T20:29:51.140

查看 NSCoding。您可以使用 NSCoding 协议将您的对象、属性和所有内容保存为数据。

一旦您的对象符合 NSCoding 标准，您就可以使用 NSKeyedArchiver 归档整个对象数组。

请注意，如果您有大量对象，这会在加载和保存期间极大地影响应用程序在 iPhone 上的性能。

# c++ - 我可以用 C++ 扩展 lisp 吗？

> ID：379136
> 
> 赞同：5
> 
> 时间：2008-12-18T20:26:04.907
> 
> 标签：c++, lisp, extend

我可以从用 c 或 c++ 编写的库中调用 lisp 中的函数吗？如何扩展 lisp？当你想做一些系统调用或类似的事情时，这很有用。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-19T02:34:42.277

从 lisp 调用非 lisp 代码是不常见的，而且很少需要。CLX（CL 的 X11 客户端实现）不链接到 Xlib 实现，而是直接“说”X11。在任何系统上，您的 CL 实现可能已经具有出色的操作系统钩子，从而使这变得不必要。

也就是说，答案取决于 lisp 的实现：

在[ECL](http://ecls.sourceforge.net/)中，您实际上可以在 C 下托管一个 CL 环境，然后简单地调用`cl_eval()`代码来执行。这可以让您用 C（或 C++）和“调用”lisp 代码编写您的应用程序（或应用程序主机）。

在[CCL](http://www.clozure.com/clozurecl.html)中，有一个与 C 兼容的调用接口，可让您执行以下操作：

```
(with-cstrs ((x "Hello World"))
  (#_puts x)) 
```

在大多数其他 CL 实现中（如 SBCL；是的，这也适用于 ECL 和 CCL），您可以使用 UFFI（或 CFFI），它只是让您调用 C 函数，这是其他人正在谈论的。如果这就是您想要做的全部，那么 CFFI 是一个很好、安全的起点。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-18T20:29:56.647

参见[UFFI](http://uffi.b9.com/)和[CFFI](http://common-lisp.net/project/cffi/)以及更简洁的[Clozure FFI](http://trac.clozure.com/openmcl/wiki/OpenMclFfi)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-19T01:26:43.380

[CFFI](http://common-lisp.net/project/cffi/)！

# web-services - 在 VS 2005 中创建 Web 服务

> ID：379138
> 
> 赞同：1
> 
> 时间：2008-12-18T20:27:37.337
> 
> 标签：web-services, app-code

与常规的 .aspx 文件不同，为什么 Web 服务文件 (.asmx) 默认将其代码隐藏放置在 app_code 文件夹中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-18T20:31:51.400

当您处理网站项目时，这是 Visual Studio 使用的样式。Web 应用程序项目并非如此。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-18T20:36:51.810

一般来说，asmx 文件更像是业务对象的代理，而业务对象不属于网站项目。Web 服务类应该放在专门用于业务逻辑而不是表示的不同项目中。另一方面，aspx 和 aspx.cs 是正确放置在网站项目中的互补文件，因为它们的工作是呈现数据。

# nhibernate - 使用 ActiveRecord/NHibernate，我可以在不刷新的情况下删除和刷新吗？

> ID：379140
> 
> 赞同：0
> 
> 时间：2008-12-18T20:29:11.530
> 
> 标签：nhibernate, activerecord, flush

我有以下单元测试方法：

```
void TestOrderItemDelete()
{
    using (new SessionScope())
    {
        var order = Order.FindById(1234);
        var originalItemCount = order.OrderItems.Count;
        Assert.IsTrue(originalCount > 0);
        var itemToDelete = order.OrderItems[0];
        itemToDelete.DeleteAndFlush(); // itemToDelete.Delete();
        order.Refresh();
        Assert.AreEqual(originalCount - 1, order.OrderItems.Count);
    }
} 
```

正如您从 DeleteAndFlush 命令后的评论中看到的那样，我必须将其从简单的 Delete 更改为通过单元测试。为什么是这样？对于我添加 OrderItem 的其他单元测试，情况并非如此。这工作得很好：

```
void TestOrderItemAdd()
{
    using (new SessionScope())
    {
        var order = Order.FindById(1234);
        var originalItemCount = order.OrderItems.Count;
        var itemToAdd = new OrderItem();
        itemToAdd.Order = order;
        itemToAdd.Create(); // Notice, this is not CreateAndFlush
        order.Refresh();
        Assert.AreEqual(originalCount + 1, order.OrderItems.Count);
    }
} 
```

当我开始使用 Order.OrderItems 关系映射的延迟实例化时，所有这些都出现了，并且必须在测试周围添加 using(new SessionScope) 块。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-19T20:03:32.530

如果不知道映射的内容，这很难排除故障，但一种可能性是您使用数据库中的标识字段（或序列等）映射了 OrderItem 的 ID 属性。如果是这种情况，NHibernate 必须访问数据库以生成 ID 字段，因此立即插入 OrderItem。删除不是这样，因此 SQL 删除语句在会话刷新之前不会执行。

# ruby-on-rails - 在创建新应用程序时指定要使用的 rails 版本

> ID：379141
> 
> 赞同：239
> 
> 时间：2008-12-18T20:29:27.037
> 
> 标签：ruby-on-rails

我的计算机中安装了两个版本的 rails（2.1.0 和 2.2.2）。

当我创建一个新应用程序时，是否可以指定我要使用旧 (2.1.0) 版本？

* * *

## 回答 #1

> 赞同：522
> 
> 时间：2009-01-16T23:51:13.467

我在[这里](http://craiccomputing.blogspot.com/2008/06/using-older-versions-of-rails.html)找到了一个未记录的选项来使用旧版本的 Rails 创建新应用程序。

```
rails _2.1.0_ new myapp 
```

* * *

## 回答 #2

> 赞同：70
> 
> 时间：2014-01-07T10:00:27.080

这是我通常使用的命令：

```
rails _version_ new application_name 
```

例如`rails _2.1.0_ new my_app`

以下是目前所有可用 Rails 版本的列表：

[http://rubygems.org/gems/rails/versions](http://rubygems.org/gems/rails/versions)

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2017-03-18T15:34:41.367

我在使用时遇到了一些问题`rails _version_ new application_name`（生成的项目仍然是为安装的最新版本的 Rails 生成的。）

经过一番挖掘后，我发现了[Michael Trojanek](https://relativkreativ.at/about)[的一篇文章](https://relativkreativ.at/articles/how-to-manage-multiple-rails-versions)，其中采用了另一种方法。这通过使用 Gemfile 创建一个文件夹来指定所需的 Rails 版本，然后使用Bundler 负责运行适当版本的. 例如，要制作一个新的 Rails 4.2.9 项目，步骤如下：`bundle exec rails...``rails`

```
mkdir myapp
cd myapp
echo "source 'https://rubygems.org'" > Gemfile
echo "gem 'rails', '4.2.9'" >> Gemfile
bundle install

bundle exec rails new . --force --skip-bundle
bundle update 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2018-10-24T23:01:40.547

**正如@mikej 为Rails 5.0.0 或更高**版本正确指出的那样，您应该遵循以下步骤：

为您的应用程序创建一个目录以及一个 Gemfile 以指定所需的 Rails 版本并让 bundler 安装依赖的 gem：

```
$ mkdir myapp
$ cd myapp
$ echo "source 'https://rubygems.org'" > Gemfile
$ echo "gem 'rails', '5.0.0.1'" >> Gemfile
$ bundle install 
```

检查是否安装了正确版本的 rails：`$ bundle exec rails -v`

现在创建你的应用程序，让 Rails 创建一个新的 Gemfile（或者使用`--force`标志覆盖现有的），而不是安装包（`--skip-bundle`）手动更新它：

```
$ bundle exec rails new . --force --skip-bundle 
```

如果您检查 rails in 的条目`Gemfile`，它应该是这样的：

```
gem 'rails', '~> 5.0.0', '>= 5.0.0.1' 
```

您应该将其更新为应用程序所需的确切版本：

```
gem 'rails', '5.0.0.1' 
```

现在，最后一步：

```
$ bundle update 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2020-03-25T08:32:43.563

有两种方法可以实现这一点：

一个在接受的答案中建议：

```
gem install rails -v 2.1.0 #only when the gem has not been installed in the desired ruby version you are using, so that you don't get error on next step
rails _2.1.0_ new my_app 
```

另一种方法是在初始化rails项目之前创建具有所需rails版本的gemfile

```
mkdir my_app
cd my_app
echo "source 'https://rubygems.org'" > Gemfile
echo "gem 'rails', '2.1.0'" >> Gemfile
bundle install

bundle exec rails new . --force --skip-bundle 
```

我已经在我的[文章中详细描述了这一点](https://www.sharmaprakash.com.np/rails/generate-an-application-with-a-specific-rails-version/)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-18T20:43:21.003

您可以使用任一版本生成骨架并需要您想要的骨架`config/environment.rb`：

```
# Specifies gem version of Rails to use when vendor/rails is not present
RAILS_GEM_VERSION = '2.1.2' unless defined? RAILS_GEM_VERSION 
```

或者使用您想要的版本的“rails”命令。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-12-18T22:06:44.750

您还应该查看将 Rails gem“冻结”到应用程序中。这对部署有很大帮助，特别是在共享托管环境中。

只需更改`RAILS_GEM_VERSION`变量`config/environment.rb`并发出 freeze rake 任务：

```
rake rails:freeze:gems 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2022-01-06T10:53:15.453

请注意您在 Rails 中使用的 ruby​​ 版本。

为特定版本的 Rail 创建新项目的命令可能不适合您。我对此有一些问题。问题是我默认的 ruby​​ 版本是 3.0.0。这个版本不适用于 Rails 5。然后我安装了 ruby​​ 2.7.5 并默认切换到它。只有这样我才能为 Rails 5 和 7 制作项目。

如果你想要与 ruby​​ 2.7.5 相同的环境

```
rvm install ruby-2.7.5 
```

默认切换到这个版本

```
rvm --default use 2.7.5 
```

安装捆绑器和 webpacker

```
gem install bundler
gem install webpacker 
```

安装最新的导轨（即 7 个​​）

```
gem install rails 
```

测试一下

```
rails new test_app_6
cd test_app_6
rails s 
```

检查本地主机 3000

```
http://localhost:3000 
```

然后停止服务器（control + c）并安装 Rails 5

```
gem install rails -v 5.2.6 
```

测试一下

```
rails _5.2.6_ new test_app_5
cd test_app_5
rails s 
```

检查本地主机 3000

```
http://localhost:3000 
```

你准备好了！

# sql - 我在哪里可以找到/学习行业标准 SQL 约定？

> ID：379145
> 
> 赞同：5
> 
> 时间：2008-12-18T20:30:01.763
> 
> 标签：sql, sql-server, tsql

我在一家有一些非常非标准化的 SQL 约定的公司工作（它们是几年前由 Delphi 开发人员编写的）。我可以在哪里找到最常用的 SQL 行业标准约定定义的最佳位置？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-18T20:38:33.837

1.  没有
2.  如果有，它们会过时的
3.  如果它们没有过时，您将不会喜欢它们
4.  如果你喜欢它们，它们是不够的
5.  如果它们足够了，没有其他人会喜欢它们

认真地，争取可读性，即使用有意义的字段和表名；没有什么是真正需要的

（好的一些常见的前缀，如 usp 和 udf 和 udt 可能有用，但不是必需的）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-18T20:52:33.653

在他的《[SQL 编程风格](https://rads.stackoverflow.com/amzn/click/com/0120887975)》一书中，Joe Celko 提出了一些约定，例如，集合（例如表）应该以复数形式命名，而标量数据元素（例如，列）应该以单数形式命名.

他引用[ISO-11179-4](http://en.wikipedia.org/wiki/ISO/IEC_11179)作为元数据命名的标准，它支持该指南。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-18T20:47:35.003

这是我见过的最好的……[命名约定](http://justinsomnia.org/writings/naming_conventions.html)

但是，标准实际上应该是关于清晰、简单和易于在您的团队中采用的。

不应该有一堆非常严格的命名准则，它应该专注于风格。关键不是要折磨开发人员，而是要在整个系统中创建一种一致的风格，以便轻松地从一个部分移动到另一个部分。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-18T20:50:39.193

没有确切的行业范围的 SQL 标准。最好的选择是搜索 SQL 标准，因为一些知识渊博的人已经发布了一些关于这个主题的相当好的、广泛和完整的文档。通读它们并吸收适用于您的环境的项目。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-09T01:36:14.397

[在这里你可以找到很多更好的 SQL /SQL Server 规则。](http://www.ssw.com.au/ssw/standards/Default.aspx)
是的，这是我工作的公司，但他们很好！这些规则来自客户项目的经验。

看看并拿走你喜欢的！

# c# - WCF REST Starter Kit - 名称为“UriTemplateMatchResults”的属性已存在

> ID：379162
> 
> 赞同：3
> 
> 时间：2008-12-18T20:36:38.990
> 
> 标签：c#, wcf, rest, wcf-client

我刚开始使用 WCF REST Starter Kit。

我创建了一个返回对象数组的简单服务。

使用浏览器，一切正常，但是当我使用 WCF 客户端时，我得到一个 ArgumentException。

我没有使用 IIS，代码如下：

**合同：**

```
[ServiceContract]
    public interface IGiftService {

        [WebGet(UriTemplate="gifts")]
        [OperationContract]
        List<Gift> GetGifts();

    }

    public class GiftService : IGiftService {

        public List<Gift> GetGifts() {
            return new List<Gift>() {
                new Gift() { Name = "1", Price = 1.0 },
                new Gift() { Name = "2", Price = 1.0 },
                new Gift() { Name = "3", Price = 1.0 }
            };
        }

    }

    [DataContract]
    public class Gift {

        [DataMember]
        public string Name { get; set; }
        [DataMember]        
        public double Price { get; set; }
    } 
```

**启动服务：**

```
WebServiceHost2 host = new WebServiceHost2(
                typeof(GiftService), 
                true, 
                new Uri("http://localhost:8099/tserverservice"));
            host.Open();

            Console.WriteLine("Running");
            Console.ReadLine();
            host.Close(); 
```

**启动客户端：**

```
WebChannelFactory<IGiftService> factory = new WebChannelFactory<IGiftService>(
                new Uri("http://localhost:8099/tserverservice"));

            IGiftService service = factory.CreateChannel();
            List<Gift> list = service.GetGifts();

            Console.WriteLine("-> " + list.Count);
            foreach (var item in list) {
                Console.WriteLine("-> " + item.Name);
            } 
```

服务器和客户端在同一个解决方案中，我在两者中使用相同的接口（描述服务合同）。

异常显示：“名称为 'UriTemplateMatchResults' 的属性已存在。” 这就是堆栈跟踪：

**触发异常的类**-> Microsoft.ServiceModel.Web.WrappedOperationSelector

**堆栈跟踪：**

```
 at System.ServiceModel.Channels.MessageProperties.UpdateProperty(String name, Object value, Boolean mustNotExist)
   at System.ServiceModel.Channels.MessageProperties.Add(String name, Object property)
   at System.ServiceModel.Dispatcher.WebHttpDispatchOperationSelector.SelectOperation(Message& message, Boolean& uriMatched)
   at System.ServiceModel.Dispatcher.WebHttpDispatchOperationSelector.SelectOperation(Message& message)
   at Microsoft.ServiceModel.Web.WrappedOperationSelector.SelectOperation(Message& message) in C:\Program Files\WCF REST Starter Kit\Microsoft.ServiceModel.Web\WrappedOperationSelector.cs:line 42
   at Microsoft.VisualStudio.Diagnostics.ServiceModelSink.ServiceMethodResolver.GetOperation()
   at Microsoft.VisualStudio.Diagnostics.ServiceModelSink.ServiceMethodResolver..ctor(ContractDescription contract, DispatchRuntime runtime, Message request, InstanceContext instanceContext) 
```

我究竟做错了什么？

**更新：**我禁用了帮助页面，该服务现在正在运行。它是一个错误吗？

```
host.EnableAutomaticHelpPage = false; 
```

谢谢！

安德烈·卡鲁奇

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-02T11:30:52.977

有同样的问题，禁用帮助页面并修复它。如果一些 REST url 被快速按顺序调用，则会引发异常。在通话之间等待时很好。

```
protected override ServiceHost CreateServiceHost(Type serviceType, Uri[] baseAddresses)
        {
            return new WebServiceHost2(serviceType, true, baseAddresses) {EnableAutomaticHelpPage = false};
        } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-05-14T13:54:19.223

我有同样的问题，但我想查看帮助页面，所以禁用它对我来说不是解决方案。我发现 WCF REST 工具包中的 URITemplating 导致了这些问题，当它看到模板表中已经有这个模板时。基本上，当您的方法的 URL 根据请求的数据而不同时，您只需要一个模板，毕竟，这就是模板的用途。我的 POST 操作具有相同的 URITemplates，因此导致此错误的单独查询之间的 URL 没有区别。然后我发现我实际上根本不需要任何模板，至少对于 POST 操作，此外，如果您的方法需要将复杂对象作为参数传递，则您不需要通过 URL 进行 POST 查询。所以我从服务接口的 WebInvoke 属性中删除了 URITemplate 命名参数，我认为这解决了问题。当然，如果您对服务器进行 GET 查询并依赖 URITemplating，您仍然必须忍受或放弃帮助页面。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-12-21T18:38:35.270

就我而言，问题仅在使用启用了 Visual Studio 调试器集成的 WCF 通道访问端点时发生。

我通过添加一些代码从 ChannelFactory 中删除 VS 行为来解决这个问题：

```
var vsBehaviour = channelFactory.Endpoint.EndpointBehaviors
    .FirstOrDefault(i =>
        i.GetType().Namespace == "Microsoft.VisualStudio.Diagnostics.ServiceModelSink");
if (vsBehaviour != null)
{
    channelFactory.Endpoint.Behaviors.Remove(vsBehaviour);
} 
```

显然，还有其他方法可以禁用 WCF Visual Studio 调试器集成，但它们似乎是系统范围的，而此解决方案是本地的。

# oracle - ORA-12638: 凭证检索失败

> ID：379164
> 
> 赞同：32
> 
> 时间：2008-12-18T20:37:22.777
> 
> 标签：oracle

我有一个继承的旧版 VB6 应用程序。我面临的问题是我越来越臭名昭著

```
ORA-12638: Credential retrieval failed 
```

每当它尝试连接到我们的 Oracle 数据库之一时都会出现错误消息。但是，我可以从 SQLPlus 和 Toad 很好地连接。我已经用谷歌搜索了，每个人似乎都说将他们的 sqlnet.ora 文件修改为

```
SQLNET.AUTHENTICATION_SERVICES=(NONE) 
```

成功了。我还没有找到任何有替代解决方案的人。这是我的连接字符串的样子：

```
"PROVIDER=OraOLEDB.Oracle;DATA SOURCE=(DESCRIPTION = " & _
"(ADDRESS = (PROTOCOL = TCP)(HOST = server1)
(PORT = 1521))" & _
"(ADDRESS = (PROTOCOL = TCP)(HOST = server2)
(PORT = 1521))" & _
"(LOAD_BALANCE = yes) " & _
"(CONNECT_DATA = " & _
"(SERVER = DEDICATED) " & _
"(SERVICE_NAME = database_name_here) " & _
") " & _
"); " & _
"User Id=username_here;Password=password_here;" 
```

至于我的VB代码，很简单。

```
Private oracleDatabaseConnection As ADODB.Connection

Set oracleDatabaseConnection = New ADODB.Connection
oracleDatabaseConnection.Open oracleConnectionString 
```

有人有想法么？

谢谢你。:)

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2012-06-13T16:20:16.663

我知道这是一篇非常古老的帖子，但我找到了一个对我有用的解决方案（旧版 VB6 应用程序）：

更改 sqlnet.ora 文件中的以下条目：

```
Original Entry - SQLNET.AUTHENTICATION_SERVICES= (NTS)

Modified Entry - SQLNET.AUTHENTICATION_SERVICES= (NONE) 
```

这是解决方案的[链接](http://www.dba-oracle.com/t_ora_12638_credential_retrieval_failed.htm)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-19T14:25:20.637

老实说，这是可能由许多不同的根本问题引起的错误之一。

假设您的数据库服务器是 Windows，请检查其事件日志，包括系统和应用程序。你可能会在那里找到有用的东西。

在某些情况下，我遇到此错误是因为运行 Oracle 服务的帐户被锁定。

在我们从未找到解释的情况下，我也遇到过这种情况，但我们总是能够通过让用户锁定和解锁他们的 PC 来解决问题。

VB 应用程序是否运行在与可以连接的客户端不同的机器上？如果是这样，是否可以在同一台机器上使用不同的客户端程序进行测试——或者是否可以在您的机器上尝试 VB 应用程序？

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2018-05-21T14:21:56.560

知道这是一个老问题，但它已经开始出现在最近的 Windows 更新中。轻松解决的方法是设置

```
SQLNET.AUTHENTICATION_SERVICES= (NONE) 
```

在 sqlnet.ora 中。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-11-28T17:32:03.260

我在 Windows 10 专业版 64 位（西班牙语版）上安装了 Oracle Database 11g Express Edition 32 位。

重启电脑后一切正常。
但是第二天我在使用 SQL*PLus 和 SQLTools 1.9 build 15 时遇到错误：

```
 ORA-12638: Credential retrieval failed 
```

我修改了 sqlnet.ora 文件，所以：

```
SQLNET.AUTHENTICATION_SERVICES= (NONE) 
```

现在我可以使用 SQLPlus、SQLTools 1.9 build 15 进行连接。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-01-20T21:48:51.373

如果您在 IIS 下运行 Web 应用程序，重新启动 IIS 似乎会有所帮助。但这是一个没有太多理由的问题的傻瓜。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-01-18T18:36:55.300

如果使用 IIS 和 VB 应用程序，它可能有助于在 ODBC 管理器中创建一个新的数据源并在连接字符串中按名称（而不是按提供程序）引用它。

例如，如果数据源的名称是“test_ds”，我将替换

```
ObjConn.open "Provider=MSDAORA;User ID=myuser;password=mypassword;Data Source=MYDATASOURCEFROMTNSNAMES;Persist Security Info=False" 
```

为了

```
ObjConn.open "dsn=test_ds;pwd=mypassword" 
```

无法真正解释解决方案背后的逻辑，但它对我有用。

# c++ - GOTO 还是不 GOTO？

> ID：379172
> 
> 赞同：63
> 
> 时间：2008-12-18T20:39:01.743
> 
> 标签：c++, goto

目前我正在研究一个大量使用 goto 语句的项目。goto 语句的主要目的是在例程中有一个清理部分，而不是多个返回语句。如下所示：

```
BOOL foo()
{
   BOOL bRetVal = FALSE;
   int *p = NULL;

   p = new int;
   if (p == NULL)
   {
     cout<<" OOM \n";
     goto Exit;
   }

   // Lot of code...

Exit:
   if(p)
   {
     delete p;
     p = NULL;
   }
   return bRetVal;
} 
```

这使得它更容易，因为我们可以在代码的一个部分（即 Exit 标签之后）跟踪我们的清理代码。

但是，我已经阅读了很多地方，使用 goto 语句是不好的做法。

目前我正在阅读*[Code Complete](https://en.wikipedia.org/wiki/Code_Complete)*这本书，它说我们需要使用接近其声明的变量。如果我们使用 goto，那么我们需要在第一次使用 goto 之前声明/初始化所有变量，否则编译器将给出错误，即 goto 语句跳过了 xx 变量的初始化。

哪种方式是正确的？

* * *

来自斯科特的评论：

看起来使用 goto 从一个部分跳转到另一个部分是不好的，因为它使代码难以阅读和理解。

但是，如果我们只使用 goto 前进并转到一个标签，那么它应该没问题（？）。

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2008-12-18T20:43:09.100

我不确定清理代码是什么意思，但在 C++ 中有一个名为“*资源获取就是初始化*”的概念，你的析构函数应该负责清理内容。

（注意，在 C# 和 Java 中，这通常通过 try/finally 来解决）

有关更多信息，请查看此页面： [http ://www.research.att.com/~bs/bs_faq2.html#finally](http://www.research.att.com/~bs/bs_faq2.html#finally)

**编辑**：让我澄清一下。

考虑以下代码：

```
void MyMethod()
{
    MyClass *myInstance = new MyClass("myParameter");
    /* Your code here */
    delete myInstance;
} 
```

**问题**：如果函数有多个退出会发生什么？您必须跟踪每个出口并在所有可能的出口处删除您的对象！否则，您将有内存泄漏和僵尸资源，对吗？

**解决方案**：改用对象引用，因为当控件离开范围时它们会自动清理。

```
void MyMethod()
{
    MyClass myInstance("myParameter");
    /* Your code here */
    /* You don't need delete - myInstance will be destructed and deleted
     * automatically on function exit */
} 
```

哦，是的，并且使用[`std::unique_ptr`](http://en.cppreference.com/w/cpp/memory/unique_ptr)或类似的东西，因为上面的例子显然是不完美的。

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2008-12-18T21:03:08.827

我从来不用在 C++ 中使用 goto。曾经。曾经。如果有一种情况应该使用它，那是非常罕见的。如果您实际上正在考虑将 goto 作为逻辑的标准部分，那么有些东西已经偏离轨道。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2008-12-18T21:46:46.693

关于 goto 和您的代码，人们基本上有两点：

1.  **后藤不好。** 很少会遇到需要 goto 的地方，但我不建议完全使用它。尽管 C++ 具有足够智能的控制流，使得 goto 很少适用。

2.  **您的清理机制是错误的：**这一点更为重要。在 C 中，自己使用内存管理不仅没问题，而且通常是最好的做事方式。在 C++ 中，您的目标应该是尽可能避免内存管理。您应该尽可能避免内存管理。让编译器为你做这件事。而不是使用`new`，只需声明变量。唯一真正需要内存管理的时候是您事先不知道数据的大小。即使这样，您也应该尝试只使用其中的一些`STL`集合。

如果您合法地需要内存管理（您还没有真正提供任何证据），那么您应该通过构造函数将内存管理封装在一个类中以分配内存和解构函数以释放内存。

从长远来看，您认为您的做事方式要容易得多的回答并不是真的。首先，一旦你对 C++ 有强烈的感觉，制作这样的构造函数将是第二自然。就个人而言，我发现使用构造函数比使用清理代码更容易，因为我不需要特别注意确保我正在正确地解除分配。相反，我可以让对象离开范围，让语言为我处理它。此外，维护它们比维护清理部分容易得多，而且更不容易出现问题。

简而言之，`goto`在某些情况下可能是一个不错的选择，但在这种情况下不是。这只是短期的懒惰。

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2008-12-18T20:58:43.670

您的代码非常不习惯，您永远不应该编写它。您基本上是在 C++ 中模拟 C。但其他人对此发表了评论，并指出 RAII 是替代方案。

但是，您的代码**不会**按预期工作，因为：

```
p = new int;
if(p==NULL) { … } 
```

永远不会*评估*为`true`（除非您`operator new`以一种奇怪的方式超载）。如果`operator new`无法分配足够的内存，它会抛出一个异常，它永远*不会**返回*，`0`至少不会使用这组参数；有一个特殊的放置新重载，它采用类型的实例`std::nothrow`并且确实返回`0`而不是抛出异常。但是这个版本很少用在普通代码中。在处理异常成本太高的情况下，一些低级代码或嵌入式设备应用程序可以从中受益。

`delete`正如 Harald 所说，您的街区也有类似的情况：`if (p)`在`delete p`.

此外，我不确定您的示例是否是故意选择的，因为此代码可以重写如下：

```
bool foo() // prefer native types to BOOL, if possible
{
    bool ret = false;
    int i;
    // Lots of code.
    return ret;
} 
```

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2008-12-18T20:53:10.267

可能[不是一个好主意](http://xkcd.com/292/)。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2008-12-18T21:07:20.737

一般来说，从表面上看，你的方法没有任何问题，只要你只有一个标签，并且 goto 总是前进。例如，这段代码：

```
int foo()
{
    int *pWhatEver = ...;
    if (something(pWhatEver))
    { 
        delete pWhatEver;
        return 1;
    }
    else
    {
        delete pWhatEver;
        return 5;
    }
} 
```

而这段代码：

```
int foo()
{
    int ret;
    int *pWhatEver = ...;
    if (something(pWhatEver))
    { 
        ret = 1;
        goto exit;
    }
    else
    {
        ret = 5;
        goto exit;
    }
exit:
    delete pWhatEver;
    return ret;
} 
```

真的没有什么不同。如果你能接受一个，你应该能接受另一个。

但是，在许多情况下，[RAII](https://en.wikipedia.org/wiki/Resource_Acquisition_Is_Initialization)（资源获取即初始化）模式可以使代码更清晰、更易于维护。例如，这段代码：

```
int foo()
{
    Auto<int> pWhatEver = ...;

    if (something(pWhatEver))
    {
        return 1;
    }
    else
    {
        return 5;
    }
} 
```

比前面的两个例子更短、更容易阅读、更容易维护。

所以，如果可以的话，我会推荐使用 RAII 方法。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2008-12-18T22:04:58.640

您的示例不是异常安全的。

如果您正在使用 goto 清理代码，那么如果在清理代码之前发生异常，则完全错过了。如果你声称你不使用异常，那么你就错了，因为`new`当它没有足够的内存时会抛出 bad_alloc。

同样在这一点上（当 bad_alloc 被抛出时），您的堆栈将被展开，在调用堆栈的过程中丢失每个函数中的所有清理代码，因此不会清理您的代码。

您需要对智能指针进行一些研究。在上述情况下，您可以只使用`std::auto_ptr<>`.

另请注意，在 C++ 代码中，无需检查指针是否为 NULL（通常是因为您从来没有 RAW 指针），但因为`new`不会返回 NULL（它会抛出）。

与 (C) 不同的是，在 C++ 中，通常会在代码中看到早期返回。这是因为[RAII](https://en.wikipedia.org/wiki/Resource_Acquisition_Is_Initialization)会自动进行清理，而在 C 代码中，您需要确保在函数末尾添加特殊的清理代码（有点像您的代码）。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2008-12-18T22:03:52.697

我认为其他答案（和他们的评论）已经涵盖了所有重要的观点，但这里有一件事还没有正确完成：

你的代码应该是这样的：

```
bool foo() //lowercase bool is a built-in C++ type. Use it if you're writing C++.
{
  try {
    std::unique_ptr<int> p(new int);
    // lots of code, and just return true or false directly when you're done
  }
  catch (std::bad_alloc){ // new throws an exception on OOM, it doesn't return NULL
    cout<<" OOM \n";
    return false;
  }
} 
```

嗯，它更短，据我所知，更正确（正确处理 OOM 情况），最重要的是，我不需要编写任何清理代码或做任何特殊的事情来“确保我的返回值已初始化”。

您的代码的一个问题是我在写这篇文章时才真正注意到，“此时 bRetVal 的值到底是什么？”。我不知道是因为，它在上面被声明为 waaaaay，它最后被分配到什么时候？在此之上的某个点。我必须通读整个函数以确保我了解将要返回的内容。

我如何说服自己内存被释放了？

我怎么*知道*我们永远不会忘记跳转到清理标签？我必须从清理标签向后工作，找到指向它的*每个goto，更重要的是，找到不存在的那些。*我需要跟踪函数的所有路径，以确保函数得到正确清理。这对我来说就像意大利面条代码。

非常脆弱的代码，因为*每次*必须清理资源时，您都必须*记住*复制清理代码。为什么不写一次，在需要清理的类型中？然后依靠它自动执行，每次我们需要它？

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2008-12-22T20:29:41.460

在我编程的八年里，我经常使用 goto，其中大部分是在第一年我使用[GW-BASIC](https://en.wikipedia.org/wiki/GW-BASIC)的一个版本和一本 1980 年的书，并没有明确 goto 应该只在某些情况下使用。我唯一一次在 C++ 中使用 goto 是当我有如下代码时，我不确定是否有更好的方法。

```
for (int i=0; i<10; i++) {
    for (int j=0; j<10; j++)
    {
        if (somecondition==true)
        {
            goto finish;
        }
        //Some code
    }
    //Some code
}
finish: 
```

我所知道的仍然大量使用 goto 的唯一情况是大型机汇编语言，我认识的程序员确保记录代码在哪里跳转以及为什么。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2008-12-19T02:36:41.943

在制定以下政策之前，您应该从 Linux 内核邮件列表中阅读此线程摘要（特别注意来自 Linus Torvalds 的回复）`goto`：

[http://kerneltrap.org/node/553/2131](http://kerneltrap.org/node/553/2131)

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2008-12-18T20:43:06.637

一般来说，您应该设计您的程序以限制对 goto 的需求。使用 OO 技术“清理”您的返回值。有一些方法可以做到这一点，不需要使用 goto 或使代码复杂化。在某些情况下 goto 非常有用（例如，深度嵌套的作用域），但如果可能的话应该避免使用。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2008-12-22T19:00:17.490

正如在 Linux 内核中使用的那样，当单个函数必须执行 2 个或更多可能需要撤消的步骤时，用于清理的 goto 可以很好地工作。步骤不必是内存分配。它可能是对一段代码或 I/O 芯片组寄存器的配置更改。Goto 应该只在少数情况下需要，但通常如果使用得当，它们可能是*最好*的解决方案。他们不是邪恶的。它们是一种工具。

代替...

```
do_step1;
if (failed)
{
  undo_step1;
  return failure;
}

do_step2;
if (failed)
{
  undo_step2;
  undo_step1;
  return failure;
}

do_step3;
if (failed)
{
  undo_step3;
  undo_step2;
  undo_step1;
  return failure;
}

return success; 
```

您可以对 goto 语句执行相同的操作，如下所示：

```
do_step1;
if (failed) goto unwind_step1;

do_step2;
if (failed) goto unwind_step2;

do_step3;
if (failed) goto unwind_step3;

return success;

unwind_step3:
  undo_step3;

unwind_step2:
  undo_step2;

unwind_step1:
  undo_step1;

return failure; 
```

应该清楚的是，鉴于这两个示例，一个比另一个更可取。至于 RAII 人群……只要他们能保证展开总是以完全相反的顺序发生：3、2、1，这种方法没有任何问题。最后，有些人不在他们的代码中使用异常并指示编译器禁用它们。因此，并非所有代码都必须是异常安全的。

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2008-12-22T19:46:56.897

GOTO 的缺点已得到很好的讨论。我只想补充一点：1）有时你必须使用它们并且应该知道如何最小化问题，2）一些公认的编程技术是伪装的，所以要小心。

1) 当您必须使用 GOTO 时，例如在 ASM 或 .bat 文件中，请像编译器一样思考。如果你想编码

```
 if (some_test){
  ... the body ...
} 
```

做编译器所做的事情。生成一个标签，其目的是跳过正文，而不是执行任何后续操作。IE

```
 if (not some_test) GOTO label_at_end_of_body
  ... the body ...
label_at_end_of_body: 
```

不是

```
 if (not some_test) GOTO the_label_named_for_whatever_gets_done_next
  ... the body ...

the_label_named_for_whatever_gets_done_next: 
```

换句话说，标签的目的不是**做某事**，而是**跳过**某事。

2) 我所说的 GOTO-in-disguise 是只要定义几个宏就可以变成 GOTO+LABELS 代码的任何东西。一个例子是通过具有状态变量和 while-switch 语句来实现有限状态自动机的技术。

```
 while (not_done){
    switch(state){
        case S1:
            ... do stuff 1 ...
            state = S2;
            break;
        case S2:
            ... do stuff 2 ...
            state = S1;
            break;
        .........
    }
} 
```

可以变成：

```
 while (not_done){
    switch(state){
        LABEL(S1):
            ... do stuff 1 ...
            GOTO(S2);
        LABEL(S2):
            ... do stuff 2 ...
            GOTO(S1);
        .........
    }
} 
```

只需定义几个宏。几乎任何 FSA 都可以转换为结构化的无 goto 代码。我更喜欢远离 GOTO-in-disguise 代码，因为它可能会陷入与未加掩饰的 goto 相同的意大利面条代码问题。

补充：只是为了保证：我认为优秀程序员的一个标志是认识到通用规则不适用。

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2008-12-18T20:48:44.923

使用 goto 去清理部分会导致很多问题。

首先，清理部分容易出现问题。它们具有低内聚性（没有真正的角色可以用程序试图做什么来描述），高耦合（正确性非常依赖于其他代码部分），并且根本不是异常安全的。看看是否可以使用析构函数进行清理。例如，如果`int *p`更改为`auto_ptr<int> p`，则 p 指向的内容将被自动释放。

其次，正如您所指出的，这将迫使您在使用之前很久就声明变量，这将使代码更难理解。

第三，当您建议对 goto 进行相当规范的使用时，会很容易以更宽松的方式使用它们，这样代码就会变得难以理解。

很少有适合 goto 的情况。大多数时候，当你想使用它们时，这表明你做错了。

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2008-12-18T21:13:06.467

由于这是一个经典话题，我将回复 Dijkstra 的[Go-to 声明被认为有害](http://www.cs.utexas.edu/users/EWD/ewd02xx/EWD215.PDF)（最初发表在 ACM 中）。

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2008-12-19T06:49:32.543

当“尾端逻辑”在某些但并非所有情况下都很常见时，Goto 提供了更好[的不要重复自己（DRY）。](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself)尤其是在“switch”语句中，当某些 switch 分支具有尾端通用性时，我经常使用 goto。

```
switch(){
   case a:  ... goto L_abTail;
   case b: ... goto L_abTail;
L_abTail: <commmon stuff>
    break://end of case b
case c:
.....
}//switch 
```

您可能已经注意到，当您需要在例程中间进行这种尾端合并时，引入额外的花括号就足以满足编译器的要求。换句话说，您不需要在顶部声明所有内容；这确实是较差的可读性。

```
...
   goto L_skipMiddle;
{
    int declInMiddleVar = 0;
    ....
}
L_skipMiddle: ; 
```

随着更高版本的[Visual Studio](http://en.wikipedia.org/wiki/Microsoft_Visual_Studio)检测到未初始化变量的使用，我发现自己总是初始化大多数变量，即使我认为它们可能会在所有分支中分配 - 编写一个引用从未分配的变量的“跟踪”语句很容易因为您的大脑并不认为跟踪语句是“真实代码”，但当然 Visual Studio 仍会检测到错误。

除了不要重复自己之外，为这种尾部逻辑分配标签名称甚至似乎通过选择好的标签名称来帮助我保持头脑清醒。如果没有有意义的标签，您的评论最终可能会说同样的话。

当然，如果您实际上是在分配资源，那么如果 auto-ptr 不适合，您确实必须使用 try-catch，但是当异常安全时，tail-end-merge-don't-repeat-yourself 经常发生没什么大不了。

总而言之，虽然 goto 可用于编写类似意大利面条的结构，但对于某些但并非所有情况常见的尾端序列，goto 提高了代码的可读性甚至可维护性如果您否则会复制/粘贴内容，以便稍后有人可能会更新一个而不是另一个。所以这是另一种情况，对教条狂热可能会适得其反。

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2013-04-22T00:50:29.753

我在 C++ 代码中使用 goto 的唯一两个原因是：

*   打破 2 级以上的嵌套循环
*   像这样的复杂流程（我的程序中的评论）：

    ```
    /* Analysis algorithm:

      1\.  if classData [exporter] [classDef with name 'className'] exists, return it,
          else
      2\.    if project/target_codename/temp/classmeta/className.xml exist, parse it and go back to 1 as it will succeed.
      3\.    if that file don't exists, generate it via haxe -xml, and go back to 1 as it will succeed.

    */ 
    ```

这里为了代码可读性，在这个注释之后，我定义了step1标签，并在第2步和第3步中使用了它。实际上，在60多个源文件中，只有这种情况和嵌套的一个4层是我使用goto的地方。只有两个地方。

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2008-12-18T21:01:31.153

C 中每个函数都有一个单一的出口点习语的全部目的是将所有清理内容放在一个地方。如果您使用 C++ 析构函数来处理清理，则不再需要 - 无论函数有多少退出点，清理都将完成。因此，在设计合理的 C++ 代码中，不再需要这种东西。

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2008-12-19T01:29:50.957

很多人都被 gotos 吓坏了。他们不是。也就是说，你永远不需要一个；几乎总是有更好的方法。

当我发现自己“需要”一个 goto 来做这类事情时，我几乎总是发现我的代码太复杂了，很容易分解成几个更容易阅读和处理的方法调用。您的调用代码可以执行以下操作：

```
// Setup
if(
     methodA() &&
     methodB() &&
     methodC()
 )
 // Cleanup 
```

并不是说这很完美，但它更容易遵循，因为您的所有方法都将被命名以清楚地表明问题可能是什么。

然而，通读评论应该表明您的团队有比 goto 处理更紧迫的问题。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2008-12-20T17:11:48.430

您给我们的代码（几乎）是写在 C++ 文件中的 C 代码。在不使用 C++ 代码/库的 C 程序中，您使用的内存清理类型是可以的。

在 C++ 中，您的代码根本不安全且不可靠。在 C++ 中，您要求的管理方式有所不同。使用构造函数/析构函数。使用智能指针。使用堆栈。总之，使用[RAII](https://en.wikipedia.org/wiki/Resource_Acquisition_Is_Initialization)。

您的代码可以（即，在 C++ 中，应该）写成：

```
BOOL foo()
{
   BOOL bRetVal = FALSE;

   std::auto_ptr<int> p = new int;

   // Lot of code...

   return bRetVal ;
} 
```

（请注意，在实际代码中新建一个 int 有点愚蠢，但您可以将 int 替换为任何类型的对象，这样就更有意义了）。假设我们有一个 T 类型的对象（T 可以是一个 int、某个 C++ 类等）。那么代码就变成了：

```
BOOL foo()
{
   BOOL bRetVal = FALSE;

   std::auto_ptr<T> p = new T;

   // Lot of code...

   return bRetVal ;
} 
```

或者更好的是，使用堆栈：

```
BOOL foo()
{
   BOOL bRetVal = FALSE;

   T p ;

   // Lot of code...

   return bRetVal;
} 
```

无论如何，上述任何示例都比您的示例更易于阅读和安全。

RAII 有很多方面（即使用智能指针、堆栈、使用向量而不是可变长度数组等），但总而言之，就是尽可能少地编写代码，让编译器在适当的时候清理这些东西。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2008-12-18T20:55:12.087

以上所有内容都是有效的，您可能还想看看是否可以通过减少标记为“大量代码”的部分中的代码量来降低代码的复杂性并减轻对 goto 的需求在你的例子中。Additionaly`delete 0`是一个有效的 C++ 语句

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2008-12-18T21:06:24.747

在 C++ 中使用 GOTO 标签是一种不好的编程方式，您可以通过执行**OO 编程**（解构函数！）并尝试**使过程尽可能小**来减少需求。

你的例子看起来有点奇怪，**没有必要删除 NULL 指针**。现在，当指针无法分配时会引发异常。

你的程序可以写成这样：

```
bool foo()
{
    bool bRetVal = false;
    int p = 0;

    // Calls to various methods that do algorithms on the p integer
    // and give a return value back to this procedure.

    return bRetVal;
} 
```

您应该在处理内存不足问题的主程序中放置一个 try catch 块，通知用户**内存不足，这是非常罕见的**......（操作系统本身也不会通知这一点吗？）

另请注意，并不总是需要使用**指针**，它们仅对**动态事物**有用。（在方法中创建不依赖于任何地方的输入的东西并不是真正动态的）

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2008-12-18T21:41:09.233

我不会说这`goto`总是不好的，但你对它的使用肯定是。这种“清理部分”在 1990 年代初期相当普遍，但将其用于新代码是纯粹的邪恶。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2008-12-18T21:46:59.597

避免您在这里所做的最简单的方法是将所有这些清理工作放入某种简单的结构中并创建它的一个实例。例如，而不是：

```
void MyClass::myFunction()
{
   A* a = new A;
   B* b = new B;
   C* c = new C;
   StartSomeBackgroundTask();
   MaybeBeginAnUndoBlockToo();

   if ( ... )
   {
     goto Exit;
   }

   if ( ... ) { .. }
   else
   {
      ... // what happens if this throws an exception??? too bad...
      goto Exit;
   }

Exit:
  delete a;
  delete b;
  delete c;
  StopMyBackgroundTask();
  EndMyUndoBlock();
} 
```

您应该以某种方式进行此清理，例如：

```
struct MyFunctionResourceGuard
{
  MyFunctionResourceGuard( MyClass& owner ) 
  : m_owner( owner )
  , _a( new A )
  , _b( new B )
  , _c( new C )
  {
      m_owner.StartSomeBackgroundTask();
      m_owner.MaybeBeginAnUndoBlockToo();
  }

  ~MyFunctionResourceGuard()
  {
     m_owner.StopMyBackgroundTask();
     m_owner.EndMyUndoBlock();
  }

  std::auto_ptr<A> _a;
  std::auto_ptr<B> _b;
  std::auto_ptr<C> _c;

};

void MyClass::myFunction()
{
   MyFunctionResourceGuard guard( *this );

   if ( ... )
   {
     return;
   }

   if ( ... ) { .. }
   else
   {
      ...
   }
} 
```

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2008-12-19T01:55:49.343

该代码有很多问题，其中大部分已经被指出，例如：

*   函数过长；将一些代码重构为单独的函数可能会有所帮助。

*   在正常实例时使用指针可能会正常工作。

*   不利用[STL](http://en.wikipedia.org/wiki/Standard_Template_Library)类型，例如 auto_ptr

*   错误地检查错误，而不是捕获异常。（我认为在绝大多数平台上检查 OOM 是没有意义的，因为如果你的内存用完，你会遇到比你的软件可以解决的更大的问题，除非你正在编写操作系统本身）

我从来不需要 goto，而且我一直发现使用 goto 是一系列更大问题的症状。你的情况似乎也不例外。

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2008-12-20T14:56:56.487

几年前，我想出了一个避免 goto 的伪习语，与在 C 中进行异常处理有点相似。它可能已经被其他人发明了，所以我想我“独立发现了它”:)

```
BOOL foo()
{
   BOOL bRetVal = FALSE;
   int *p=NULL;

   do
   {
       p = new int;
       if(p==NULL)
       {
          cout<<" OOM \n";
          break;
       }

       // Lot of code...

       bRetVal = TRUE;

    } while (false);

   if(p)
   {
     delete p;
     p= NULL;
   }

   return bRetVal;
} 
```

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2012-08-11T22:30:33.057

我认为将 goto 用于退出代码是不好的，因为还有许多其他开销较低的解决方案，例如具有退出函数并在需要时返回退出函数值。但通常在成员函数中，这不应该是必需的，否则这可能表明发生了太多的代码膨胀。

通常，我在编程时对“no goto”规则所做的唯一例外是在将嵌套循环中断到特定级别时，我只是在进行数学编程时才遇到需要这样做。

例如：

```
for(int i_index = start_index; i_index >= 0; --i_index)
{
    for(int j_index = start_index; j_index >=0; --j_index)
        for(int k_index = start_index; k_index >= 0; --k_index)
            if(my_condition)
                goto BREAK_NESTED_LOOP_j_index;
BREAK_NESTED_LOOP_j_index:;
} 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2008-12-18T20:59:18.757

试试这种方式：

```
BOOL foo()
{
   BOOL bRetVal = FALSE;
   int *p = NULL;

   p = new int;
   if (p == NULL)
   {
     cout<<" OOM \n";
   }
   else
   {
       // Lot of code...
   }

   if (p)
   {
     delete p;
     p = NULL;
   }
   return bRetVal;
} 
```

在“大量代码”部分中，“大量代码”很好地表明您可能应该将此部分重构为一个或多个方法或函数。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2008-12-18T21:02:30.467

使用“GOTO”将改变程序的“逻辑”以及您的输入方式或您想象它的工作方式。

避免 GOTO 命令一直对我有用，所以当你认为你可能需要它时，你可能需要重新设计。

但是，如果我们在汇编级别上看这个，判断“跳转”就像使用 GOTO 并且一直在使用，但是，在汇编中，您可以清除您所知道的堆栈和其他寄存器中的内容传下去。

因此，在使用 GOTO 时，我会确保软件会“出现”，因为 co-coders 会进入，GOTO 会对您的软件产生“不良”影响。

因此，这更多地解释了为什么不使用 GOTO 而不是替代解决方案，因为这在很大程度上取决于其他一切的构建方式。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2008-12-18T21:17:27.970

前面的评论都是不使用 goto 的好理由。

我可以根据经验说，对于可能需要维护您的代码 goto 的其他程序员来说，遵循逻辑非常困难。我遇到了繁重的 goto 意大利面条代码的情况，并且以我的 OO 背景为背景，调试和进行更改是一场噩梦。是的，这段代码也将 goto 用于清理功能。不需要的时候非常沮丧。除非绝对必要，否则不要使用 goto。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2008-12-18T21:33:07.953

从之前的所有评论中：

1.  goto 非常非常糟糕
2.  它使代码难以阅读和理解。
3.  它可能导致众所周知的问题“意大利面条代码”
4.  每个人都同意不应该这样做。

但我在以下场景中使用

1.  它用于前进并且仅适用于一个标签。
2.  goto 部分用于清理代码并设置返回值。如果我不使用 goto，那么我需要为每种数据类型创建一个类。就像我需要将 int * 包装到一个类中一样。
3.  整个项目都在遵循它。

我同意这很糟糕，但如果遵循得当，它仍然会让事情变得容易得多。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2008-12-18T23:19:31.017

我可能错过了一些东西：如果 P 为空，则跳转到标签 Exit，然后测试它是否不为空（不是），看看是否需要删除它（这不是必需的，因为它从未分配过第一名）。

if/goto 不会，也不需要删除 p。将 goto 替换为 return false 将具有相同的效果（然后您可以删除 Exit 标签）。

我知道 goto 唯一有用的地方是深埋在令人讨厌的解析器（或词法分析器）中，以及伪造状态机（埋在大量 CPP 宏中）。在这两种情况下，它们被用来使非常扭曲的逻辑变得更简单，但这种情况非常罕见。

函数（A 调用 A'）、Try/Catches 和 setjmp/longjmps 都是避免困难语法问题的更好方法。

保罗。

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2008-12-18T23:38:07.360

忽略 new 永远不会返回 NULL 的事实，请使用您的代码：

```
 BOOL foo()
  {
     BOOL bRetVal = FALSE;

     int *p=NULL;

     p = new int;

     if(p==NULL)
     {
        cout<<" OOM \n";
        goto Exit;
     }

     // Lot of code...

  Exit:
     if(p)
     {
        delete p;
        p= NULL;
     }

     return bRetVal;
  } 
```

并这样写：

```
 BOOL foo()
  {
     BOOL bRetVal = FALSE;

     int *p = new int;

     if (p!=NULL)
     {
        // Lot of code...

        delete p;
     }
     else
     {
        cout<<" OOM \n";
     }

     return bRetVal;
  } 
```

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2008-12-21T00:32:44.200

> **Alien01**写道: 目前，我正在研究一个大量使用 goto 语句的项目。goto 语句的主要目的是在例程中有一个清理部分，而不是多个返回语句。

换句话说，您希望将程序逻辑与简单重复乏味的例程分开，例如释放*可能*保留在不同代码位置的资源。

异常处理技术是一种与程序逻辑并行工作的错误处理逻辑。这是一个更优雅的解决方案，因为它提供了这样的分离，同时提供了将控制移动到其他代码块的能力，就像`goto`语句一样，所以我修改了你的脚本，如下所示：

```
class auxNullPtrException : public std::exception {
    public:
        auxNullPtrException::auxNullPtrException()
            : std::exception( " OOM \n") {}
    };

    BOOL foo()
    {
        BOOL bRetVal = FALSE;
        try {
            int *p = NULL;
            p = new int;
            if (p == NULL)
            {
                throw auxNullPtrException();
            }
            // Lot of code...
         }
         catch(auxNullPtrException & _auxNullPtrException)
         {
             std::cerr<<_auxNullPtrException.what();
             if(p)
             {
                 delete p;
                 p = NULL;
             }
         }
         return bRetVal;
    } 
```

* * *

## 回答 #35

> 赞同：-4
> 
> 时间：2012-09-11T16:01:55.100

我不知道goto这个东西是从哪里来的......

在编译语言中，每条条件指令（`if`、`switch`、`for`、`while`等）都解析为“cmp”、“jmp”或“j??” 在机器代码中（jmp IS goto）。

事实上，一个非常优化的代码知道最佳执行路径，因此必须使用“goto”......使用 goto 编写线性代码比不使用堆栈时的方法和调用（“call” =“推”+“jmp”）。

绝对没有充分的理由不应该在 C++ 中使用 GOTO：生成的代码到处都是“jmp”。

这只是脚本中的一个问题（通常不可用），因为当 goto 指令存在时，goto 的目的地不一定被解释。

反对 goto 的最初论点是代码更难检查。

这很荒谬：代码不是用来检查的（或只检查一次）：它是用来执行的，要小而快。一段优化的代码必须避免冗余（通过重用相同的指令）并避免运行时检查（与硬件故障无关的异常都应该在设计时避免，而不是在运行时）。

# c# - C# 字典内存管理

> ID：379175
> 
> 赞同：9
> 
> 时间：2008-12-18T20:39:12.073
> 
> 标签：c#, data-structures, memory-management, dictionary

我有一个`Dictionary<string,int>`可能包含超过 10+ 百万个唯一键的潜力。我试图减少这需要的内存量，同时仍然保持字典的功能。

我有将字符串的哈希存储为 long 的想法，这会将应用程序的内存使用量降低到可接受的量（~1.5 gig 到 ~.5 gig），但我对我的方法感觉不太好这。

```
long longKey=
BitConverter.ToInt64(cryptoTransformSHA1.ComputeHash(enc.GetBytes(strKey)), 0); 
```

基本上，这会切断 SHA1 哈希的末尾，并将其第一块放入一个 long 中，然后我将其用作密钥。虽然这可行，但至少对于我正在测试的数据而言，我不觉得这是一个非常可靠的解决方案，因为键冲突的可能性增加了。

有没有其他方法可以减少字典的内存占用，或者我上面的方法没有我想象的那么可怕？

[编辑]为了澄清，我需要保持使用字符串查找字典中包含的值的能力。将实际字符串存储在字典中会占用大量内存。我想做的是使用`Dictionary<long,int>`long 是字符串上散列函数的结果。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-18T22:20:26.580

所以我最近做了一些类似的事情，出于某些对我的应用程序来说相当独特的原因，我没有使用数据库。事实上，我试图停止使用数据库。我发现 GetHashCode 在 3.5 中得到了显着改进。一个重要的注意事项，永远不要持久存储来自 GetHashCode 的结果。永远不能。不保证它们在框架版本之间保持一致。

因此，您确实需要对您的数据进行分析，因为不同的哈希函数可能对您的数据效果更好或更差。您还需要考虑速度。作为一般规则，即使散列的数量达到数十亿，加密散列函数也不应该有很多冲突。对于我需要独特的东西，我通常使用 SHA1 Managed。一般来说，CryptoAPI 的性能很差，即使底层的哈希函数性能很好。

对于 64 位散列，我目前一起使用 Lookup3 和 FNV1，它们都是 32 位散列。要发生碰撞，两者都需要发生碰撞，这在数学上是不可能的，而且我还没有看到超过 1 亿个哈希值发生过。您可以在网络上找到公开可用的代码。

仍然进行自己的分析。对我有用的东西可能对你不起作用。实际上，在我的办公室内部，具有不同要求的不同应用程序实际上使用不同的散列函数或散列函数的组合。

我会避免任何未经证实的哈希函数。散列函数的数量与认为应该编写它们的人一样多。做你的研究和测试测试。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-18T21:21:31.223

有 1000 万多条记录，您是否考虑过使用具有非聚集索引的数据库？对于这类事情，数据库有更多的技巧。

根据定义，在任何算法下，散列都有可能发生冲突——尤其是在大容量的情况下。根据情况，我会对此非常谨慎。

使用字符串可能会占用空间，但它是可靠的......如果你在 x64 上，这不需要太大（尽管它绝对算作“大”；-p）

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-18T20:44:18.833

顺便说一句，加密散列/散列函数对字典非常不利。它们又大又慢。通过解决一个问题（大小），您只引入了另一个更严重的问题：该函数将不再均匀分布输入，从而破坏了用于接近无冲突寻址的良好哈希的一个最重要的属性（如你似乎已经注意到了自己）。

/编辑：正如安德鲁所指出的，这`GetHashCode`是解决此问题的方法，因为这是它的预期用途*。*就像在真正的字典中一样，您将不得不解决碰撞问题。最好的方案之一是[双散列](http://en.wikipedia.org/wiki/Double_hashing)。不幸的是，唯一 100% 可靠的方法是实际存储原始值。否则，您将创建无限压缩，我们知道这是不存在的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-18T20:41:36.093

为什么不直接使用`GetHashCode()`来获取字符串的哈希值？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-18T20:44:07.303

使用我过去使用过的哈希表实现，哈希会将您带到一个存储桶，该存储桶通常是具有相同哈希的其他对象的链接列表。哈希不是唯一的，但它们足以将您的数据拆分为非常易于管理的列表（有时只有 2 或 3 长），然后您可以搜索这些列表以找到您的实际项目。

一个好的散列的关键不是它的唯一性，而是它的速度和分布能力……你希望它尽可能均匀地分布。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-20T02:16:12.153

去获取 SQLite。您不太可能击败它，即使您做到了，也可能不值得花时间/精力/复杂性。

SQLite。

# java - 将双精度格式设置为分数

> ID：379176
> 
> 赞同：8
> 
> 时间：2008-12-18T20:39:37.157
> 
> 标签：java, string, formatting

是否有一个库可以将 Double 转换为带有整数的字符串，后跟分数？

例如

```
1.125 = 1 1/8 
```

我只在寻找 64 英寸的分数。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-18T21:01:18.407

您的问题很简单，因为您确信分母将始终在 C# 中除以 64.（有人可以随意翻译 Java 版本）：

```
string ToMixedFraction(decimal x) 
{
    int whole = (int) x;
    int denominator = 64;
    int numerator = (int)( (x - whole) * denominator );

    if (numerator == 0) 
    {
        return whole.ToString();
    }
    while ( numerator % 2 == 0 ) // simplify fraction
    {
        numerator /= 2;
        denominator /=2;
    }
    return string.Format("{0} {1}/{2}", whole, numerator, denominator);
} 
```

奖金：代码高尔夫

```
public static string ToMixedFraction(decimal x) {
    int w = (int)x,
        n = (int)(x * 64) % 64,
        a = n & -n;
    return w + (n == 0 ? "" : " " + n / a + "/" + 64 / a);
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-18T20:44:32.793

您可能会遇到的一个问题是，并非所有小数值都可以用双精度数表示。甚至一些看起来很简单的值，比如 0.1。现在开始使用伪代码算法。您可能最好确定一英寸的 64 分之一，但将小数部分除以 0.015625。之后，您可以将分数减少到最低公分母。但是，由于您声明英寸，您可能不想使用最小公分母，而只想使用通常表示英寸的值，2,4,8,16,32,64。

但是要指出的一件事是，由于您使用的是英寸，如果这些值都是英寸的真分数，分母为 2、4、8、16、32、64，那么该值不应包含浮点错误，因为分母始终是 2 的幂。但是，如果您的数据集的值为 0.1 英寸，那么您将开始遇到问题。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-18T21:55:13.760

org.apache.commons.math 怎么样？他们有一个分数类，需要双倍。

[http://commons.apache.org/math/api-1.2/org/apache/commons/math/fraction/Fraction.html](http://commons.apache.org/math/api-1.2/org/apache/commons/math/fraction/Fraction.html)

您应该能够扩展它并为其提供第 64 代的功能。您还可以添加一个 toString ，它可以轻松地为您打印出分数的整数部分。

> Fraction(double value, int maxDenominator) 在给定双精度值和最大分母的情况下创建一个分数。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-18T20:53:57.270

我不一定同意，基于 Milhous 想要覆盖高达 1/64" 英寸的事实假设程序始终要求 1/64" 精度，这应该占用 6 位尾数。在浮点数中，有 24-6 = 18，这（如果我的数学是正确的）应该意味着他的范围是 +/- 262144 + 63/64"

浮点数中的精度可能足以正确转换为派系而不会造成损失。

而且由于大多数在英寸上工作的人都使用 2 的幂分母，所以应该没问题。

但回到最初的问题，我不知道有任何图书馆会这样做。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-18T20:59:39.533

下面是一个名为 LPC 的 C 变体中的函数。一些注意事项：

1.  开始时除了输入值外，还试图处理精度问题，否则会很容易告诉你 5 是 4 999999/1000000。
2.  to_int() 函数截断为整数。
3.  语言有一个 to_string() 可以将一些浮点数转换为指数符号。

* * *

```
string strfrac(float frac) {
    int main = to_int(frac + frac / 1000000.0);
    string out = to_string(main);
    float rem = frac - to_float(main);
    string rep;
    if(rem > 0 && (to_int(rep = to_string(rem)) || member(rep, 'e') == Null)) {
        int array primes = ({ 2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47 });
        string base;
        int exp;
        int num;
        int div;
        if(sscanf(rep, "%se%d", base, exp) == 2) {
            num = to_int(replace(base, ".", ""));
            div = to_int(pow(10, abs(exp)));
        } else {
            rep = rep[2..];
            num = to_int(rep);
            div = to_int(pow(10, strlen(rep)));
        }
        foreach(int prime : primes) {
            if(prime > num)
                break;
            while((num / prime) * prime == num && (div / prime) * prime == div) {
                num /= prime;
                div /= prime;
            }
        }
        out += " " + num + "/" + div;
    }
    return out;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-09-11T08:04:54.413

我为我的项目写了这个我希望它有用：

```
//How to "Convert" double to fraction("a/b") - kevinlopez@unitec.edu
private boolean isInt(double number){
    if(number%2==0 ||(number+1)%2==0){
        return true;
    }
    return false;
}
private String doubleToFraction(double doub){
    //we get the whole part
    int whole = (int)doub;
    //we get the rest
    double rest = doub - (double)whole;
    int numerator=1,denominator=1;
    //if the whole part of the number is greater than 0
    //we'll try to transform the rest of the number to an Integer
    //by multiplying the number until it become an integer
    if(whole >=1){
        for(int i = 2; ; i++){
            /*when we find the "Integer" number(it'll be the numerator)
             * we also found the denominator(i,which is the number that transforms the number to integer)
             * For example if we have the number = 2.5 when it is multiplied by 2
             * now it's 5 and it's integer, now we have the numerator(the number (2.5)*i(2) = 5)
             * and the denominator i = 2
             */
            if(isInt(rest*(double)i)){
                numerator = (int)(rest*(double)i);
                denominator = i;
                break;
            }
            if(i>10000){
                //if i is greater than 10000 it's posible that the number is irrational
                //and it can't be represented as a fractional number
                return doub+"";
            }
        }
        //if we have the number 3.5 the whole part is 3 then we have the rest represented in fraction 0.5 = 1/2
        //so we have a mixed fraction 3+1/2 = 7/2
        numerator = (whole*denominator)+numerator;
    }else{
        //If not we'll try to transform the original number to an integer
        //with the same process
        for(int i = 2; ; i++){
            if(isInt(doub*(double)i)){
                numerator = (int)(doub*(double)i);
                denominator = i;
                break;
            }
            if(i>10000){
                return doub+"";
            }
        }
    }
    return numerator+"/"+denominator;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-19T11:59:52.507

正如其他几个人指出的那样，64 的小数可以用 IEEE 浮点数精确表示。这意味着我们还可以通过移动和屏蔽位来转换为分数。

这不是解释浮点表示的所有细节的地方，请参阅[维基百科](http://en.wikipedia.org/wiki/IEEE_754-1985)了解详细信息。

简而言之：浮点数存储为 (sign)(exp)(frac)，其中符号为 1 位，exp 为 11 位，frac 为小数部分（1 之后），为 52 位。这被输入为数字：

```
(sign == 1 ? -1 : 1) * 1.(frac) * 2^(exp-1023) 
```

因此，我们可以通过根据指数移动该点并屏蔽该点之后的 6 位来获得第 64 位。在 Java 中：

```
private static final long MANTISSA_FRAC_BITMAP = 0xfffffffffffffl;
private static final long MANTISSA_IMPLICIT_PREFIX = 0x10000000000000l;
private static final long DENOM_BITMAP = 0x3f; // 1/64
private static final long DENOM_LEN = 6;
private static final int FRAC_LEN = 52;

public String floatAsFrac64(double d) {
    long bitmap = Double.doubleToLongBits(d);
    long mantissa = bitmap & MANTISSA_FRAC_BITMAP | MANTISSA_IMPLICIT_PREFIX;
    long exponent = ((bitmap >> FRAC_LEN) & 0x7ff) - 1023;
    boolean negative = (bitmap & (1l << 63)) > 0;

    // algorithm:
    //   d is stored as SE(11)F(52), implicit "1." before F
    //   move point to the right <exponent> bits to the right:
    if(exponent > FRAC_LEN) System.out.println("warning: loosing precision, too high exponent");
    int pointPlace = FRAC_LEN-(int)exponent;
    //   get the whole part as the number left of the point: 
    long whole = mantissa >> pointPlace;
    //   get the frac part as the 6 first bits right of the point: 
    long frac = (mantissa >> (pointPlace-DENOM_LEN)) & DENOM_BITMAP;
    //   if the last operation shifted 1s out to the right, we lost precision, check with
    //   if any of these bits are set:
    if((mantissa & ((MANTISSA_FRAC_BITMAP | MANTISSA_IMPLICIT_PREFIX) >> (pointPlace - DENOM_LEN))) > 0) {
        System.out.println("warning: precision of input is smaller than 1/64");
    }
    if(frac == 0) return String.format("%d", whole);
    int denom = 64;
    // test last bit, divide nom and demon by 1 if not 1
    while((frac & 1) == 0) {
        frac = frac >> 1;
        denom = denom >> 1;
    }
    return String.format("%d %d/%d", whole, frac, denom);
} 
```

（这段代码可能会更短，但是阅读这样的位翻转代码已经够难了……）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-18T21:04:50.633

我的代码看起来像这样。

```
public static int gcd(int a, int b)
    {
        if (b == 0)
            return a;
        else
            return gcd(b, a % b);
    }

public static String doubleToStringFraction(Double d)
    {
        StringBuffer result = new StringBuffer(" " + ((int) Math.floor(d)));
        int whole = (int) ((d - Math.floor(d)) * 10000);
        int gcd = gcd(whole, 10000);
        result.append(" " + (whole / gcd) + "/" + 10000 / gcd + " ");
        return result.toString();
    } 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-10-27T18:59:48.977

我创建了简单的分数库。

该库可在此处获得：[https ://github.com/adamjak/Fractions](https://github.com/adamjak/Fractions)

例子：

```
String s = "1.125";
Fraction f1 = Fraction.tryParse(s);
f1.toString(); // return 9/8

Double d = 2.58;
Fraction f2 = Fraction.createFraction(d);
f2.divide(f1).toString() // return 172/75 (2.29) 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2008-12-18T21:22:59.723

为了解决这个问题（在我的一个项目中），我采取了以下步骤：

*   建立了一个十进制/分数字符串的字典。
*   编写了一个函数来根据数字的“小数”部分和匹配条件在字典中搜索最接近的匹配分数。

# nhibernate - 具有生成属性的 NHibernate SchemaExport

> ID：379184
> 
> 赞同：0
> 
> 时间：2008-12-18T20:42:32.470
> 
> 标签：nhibernate, schemaexport

我想知道是否有办法让 SchemaExport 为生成的属性生成和标识列。

```
<id name="Id" column="Id" type="Guid">
  <generator class="guid.comb" />
</id>
<property name="OrderNumber" column="OrderNumber" type="Int32" generated="insert"/> 
```

使用上面的映射，ShcemaExport 不会将 OrderNumber 列设置为 Identity 列。

格雷格

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-21T15:55:29.783

在 Fabio Maulo 的帮助下，我想通了：

```
<property name="OrderNumber" generated="insert" update="false">
  <column name ="OrderNumber" sql-type="int identity" not-null="true"/>
</property> 
```

# unicode - 将 GB2312 转换为 UTF-8

> ID：379191
> 
> 赞同：8
> 
> 时间：2008-12-18T20:43:29.287
> 
> 标签：unicode, utf-8, gb2312

我有一个文本文件，其中包含当前以 GB2312（简体中文）编码的本地化语言字符串，但我的所有其他语言文件都是 UTF-8。我发现使用此文件非常困难，因为我的文本编辑器都无法正常使用它并不断损坏它。是否有任何工具可以将其转换为 UTF-8，这样做有什么缺点吗？将其保留为 GB2312 并使用其他编辑器会更好（如果是，您能推荐一个）吗？

**更新：**我使用的是 Windows XP（英文安装）。

**更新 #2：**我尝试使用 Notepad++ 和 Notepad2 编辑 GB2312 文件，但两者都无法读取文件并损坏它们。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-19T02:05:55.143

您可以尝试使用开源实用程序的[在线服务。](http://www.iconv.org/) 您还可以在您的机器上安装[Charco](http://www.marblesoftware.com/Charco.html)，它的命令行版本。`iconv`

对于`GB2312`，您可以`CP936`用作编码。

If you are a .Net developer you can make a small tool that does just that.
I've struggled with this as well and found that it was actually simple to solve from a programmatic point of view.

All you need is something like this (I tested it and it works):

**In C#**

```
static void Main(string[] args) {
    string infile = args[0];
    string outfile = args[1];

    using (StreamReader sr = new StreamReader(infile, Encoding.GetEncoding(936))) {
        using (StreamWriter sw = new StreamWriter(outfile, false, Encoding.UTF8)) {
            sw.Write(sr.ReadToEnd());
            sw.Close();
        }
        sr.Close();
    }
} 
```

**In VB.Net**

```
Private Shared Sub Main(ByVal args() As String)
    Dim infile As String = args(0)
    Dim outfile As String = args(1)
    Dim sr As StreamReader = New StreamReader(infile, Encoding.GetEncoding(936))
    Dim sw As StreamWriter = New StreamWriter(outfile, false, Encoding.UTF8)
    sw.Write(sr.ReadToEnd)
    sw.Close
    sr.Close
End Sub 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-19T01:18:29.357

我可能在这里想得太简单了，但是如果它只是一个纯文本文件，您可以尝试以下操作：

1.  替换 all `&`by `&amp;`, all `<`by `&lt;`and all `>`by `&gt;`（为了安全起见）
2.  将以下内容添加到文本文件中：

    `<html><head><meta http-equiv="Content-Type" content="text/html; charset=gb2312" /></head><body><pre>`

3.  在您喜欢的浏览器中打开文件

4.  选择并复制所有文本
5.  将其粘贴到记事本中并另存为 UTF-8。

在您编写任何代码来进行转换或下载任何可以为您进行转换的程序之前，您就已经完成了这项工作。

当然，我不能百分百确定这会起作用，而且您的浏览器需要正确的字体和所有内容，但考虑到您正在使用这些类型的文件，我假设您已经拥有这些文件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-18T23:13:49.840

GB 2312 大多与 GB 18030 兼容，因此任何能够处理后者的工具也应正确对待 GB 2312。有很多工具可以将 GB 18030 转换为 UTF-8（或其他一些 Unicode 编码形式），但我不能推荐任何一种用于 Windows 的特定工具，因为我在 Unix 上工作。如果您想编写一些代码，就会想到 iconv 库或[ICU](http://www.icu-project.org/)：您会发现所有转换数据都可以在这些库中轻松获得。

从 GB 2312 转换为 UTF-8 是完全安全且无损的，您不必担心。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-01-08T05:53:11.017

I agree on the currently chosen answer in that "found that it was actually simple to solve from a programmatic point of view", especially when your source file contains sensitive information that you do not want to expose to an unknown 3rd-party online service.

And, nowadays Python is available out-of-box in most Linux environment, and also easy to install on a Windows environment (easier than installing C# stack, IMHO). So, without further ado, this is the 2-liner Python script that can convert GB2312 to UTF8\. I tested it, it works.

```
# Usage: python this_script.py your_input.txt your_output.txt
import io, sys
io.open(sys.argv[2], "w", encoding="utf-8").write(io.open(sys.argv[1], encoding="gb2312").read()) 
```

# .net - 为什么 DataViewManager 不排序？

> ID：379201
> 
> 赞同：0
> 
> 时间：2008-12-18T20:45:47.300
> 
> 标签：.net, vb.net, ado.net, dataviewmanager

首先，快速了解一下代码在做什么。我有两个表：公司和客户。公司和客户之间存在一对多的关系（一家公司可以有多个客户）。

在某些处理逻辑中，我将两个表都加载到数据集中——每个表都是数据表。我添加了一个 DataRelation 来设置关系，当我对 Companies 表中的记录使用 GetChildRows 时，它可以工作。

但是，我需要对返回的记录进行排序。在搜索了一些之后，看起来 DataViewManager 是要走的路，我已经检查了几个基本示例。但是，我无法对我的行进行排序。我是否遗漏了什么，或者我没有使用它应该如何使用它？示例代码：

```
Dim ldvmManager As New DataViewManager(mdsData)
ldvmManager.DataViewSettings("Companies").Sort = "comName ASC"
ldvmManager.DataViewSettings("Clients").ApplyDefaultSort = False
ldvmManager.DataViewSettings("Clients").Sort = "entLastName ASC, entFirstName ASC"

For Each mdrCurrentCompany in ldvmManager.DataViewSettings("Companies").Table.Rows
    Dim ldrClients() as DataRow = mdrCurrentCompany.GetChildRows("CompaniesClients")
Next 
```

不管我做什么，返回的第一个客户的姓氏以“B”开头，第二个客户的姓氏以“A”开头。从那里开始，订单就混乱了。如果我使用整个数据而不是用于测试的子集，则返回的第一个客户端的姓氏以“J”开头。在我尝试使用 DataViewManager 之前，它似乎仍在使用任何默认排序。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-18T21:18:49.933

我认为，您应该使用 DataView 来获取 DataTable 的排序视图。

查看 MSDN 文档，似乎 DataViewManager 存储默认设置（与创建时的 DataTable 一样）。

与此有关的人可以对此有所了解。

# cvs - 在签入时获取 CVS 到 chgrp

> ID：379202
> 
> 赞同：2
> 
> 时间：2008-12-18T20:45:47.677
> 
> 标签：cvs

我正在客户端站点上使用 cvs 存储库，并通过 ssh (CVS_RSH=ssh) 进行签入。

我的默认组是“foo”，我也是“bar”的成员。

存储库应该可由组“bar”的成员访问。但是，每当我进行签入时，它会将我签入的文件组更改为“foo”。这使得文件对仅在组“bar”中的人只读。

有没有办法告诉 cvs 保持正确的组设置？还是我需要制作一个特殊版本的 ssh 来通过连接执行“newgrp bar”？或者这只是一个需要更新的古老版本的 CVS。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-18T20:51:18.087

好吧，CVS 实际上没有二进制和可执行文件之外的文件元数据。

你可以做几件事

*   在您希望它保留的服务器目录上执行 chmod g+s bar
*   编写一个小的 shell 包装器来替换真正的 cvs，然后执行 chgrp 并调用真正的 cvs。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-18T21:48:53.117

可能的答案：

*   登录时使用 sg 或 newgrp 切换组
*   提前在存储库上使用 chmod -R g+s 来安排适当的访问
*   切换到使用 pserver 并将每个人映射到皮肤下的同一个用户（尽管意味着一些维护）

如果您无法更改存储库的操作方式，第一个答案是唯一真正有用的答案。在 Linux 上，这仅取决于您为当前会话切换组 ID 的能力，这两个给定命令都启用。

过去，对于我管理的存储库，我倾向于使用第三种方法。

# mysql - 如何将文件系统中的文件导入/导出 MySQL DB？

> ID：379210
> 
> 赞同：0
> 
> 时间：2008-12-18T20:48:11.837
> 
> 标签：mysql, linux, backup, scripting

我正在开发的应用程序会随着使用动态生成文件。这使得分段、开发和生产之间的备份和同步成为一个真正的巨大挑战。我们可能会获得平滑解决方案（如果可行）的一种方法是拥有一个脚本，在备份数据库时可以备份数据库内动态生成的文件，并且在恢复时可以将这些文件从数据库中取出并放入再次文件系统。

我想知道是否有任何可用的（付费或免费）应用程序可以用作脚本来实现这一点。

基本上如果我有

```
/usr/share/appname/server/dynamicdir
/usr/share/appname/server/otherdir/etc/resource.file 
```

然后把上面的例子和脚本放在mysql数据库上。

如果您需要更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-30T21:05:23.987

Do you mean that the application is storing a files as blobs in the MySQL database, and/or creating lots of temporary tables? Or that you just want temporary files - themselves unrelated to a database - to be stored in MySQL as a backup?

I'm not sure that trying to use MySQL as an net-new intermediary for backups of files is a good idea. If the app already uses it, thats one thing, if not, MySQL isn't the right tool here.

Anyway. If you are interested in capturing a filesystem at point-in-time, the answer is to utilize [LVM snapshots](http://tldp.org/HOWTO/LVM-HOWTO/snapshots_backup.html). You would likely have to rebuild your server to get your filesystems onto LVM, and have enough free storage there for as many snapshots as you think you'd need.

I would recommend having a new mount point just for this apps temporary files. If your MySQL tables are using InnoDB, a simple script to run mysqldump --single-transaction in the background, and then the lvm snapshot process, you could get these synced up to less then a second.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-19T15:23:06.590

使用 PHP、perl、python 等应该是微不足道的。你在找人为你写这个吗？

# user-interface - GUI 和游戏程序流程与 Web 程序相比如何

> ID：379231
> 
> 赞同：6
> 
> 时间：2008-12-18T20:54:15.193
> 
> 标签：user-interface, program-flow

我已经开发 Web 应用程序有一段时间了，并且已经涉足 GUI 和游戏应用程序开发。

在 Web 应用程序（对我来说是 php）中，向文件发出请求，该文件包含将信息处理到内存中的所有必要文件，然后每个请求的流程从上到下。（主要）

我知道对于游戏来说，动作发生在游戏循环中，但是游戏的所有不同元素是如何分层到单个循环中的（菜单系统、gui、加载资产和 3d 世界）并不断加载和卸载某些事物。

GUI程序也是如此，我相信存在某种“应用程序循环”。

大多数项目是否被调用到内存中然后被访问，这些项目是否在需要时链接并加载到内存中？

帮助我更快地开发 Web 应用程序的是当我了解程序的流程时，它不必详细，只需大致的想法或伪代码。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-18T21:07:04.323

所有这些几乎总是有一个循环——但这不是你在大部分开发过程中倾向于考虑的事情。

如果您退后一步，您的 Web 应用程序是基于一个循环 - Web 服务器的`accept()`循环：

```
while(listening) {
     get a socket connection;
     handle it;
} 
```

.. 但作为一名 Web 开发人员，您可以避免这种情况，并编写“事件驱动”代码——“当有人请求此 URL 时，执行此操作”。

GUI 也是事件驱动的，并且事件也被某处的循环检测到：

```
while(running) {
    get mouse/keyboard/whatever event
    handle it
} 
```

但是 GUI 开发人员不需要过多考虑循环。他们写道“当鼠标点击此处时，执行此操作”。

游戏，同样如此。有人必须写一个循环：

```
while(game is in progress) {
    invoke every game object's 'move one frame' method;
    poll for an input event;
} 
```

...而其他代码则以事件驱动的方式编写：“当子弹对象与该对象重合时，触发爆炸事件”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-18T21:05:42.753

对于应用程序和较小程度的游戏，该软件是事件驱动的。用户使用键盘或鼠标做“某事”，该事件被发送到软件的其余部分。

在游戏中，游戏循环很重要，因为它专注于处理屏幕和游戏状态。许多游戏需要实时性能。借助现代 3D 图形 API，大部分屏幕处理都可以转储到 GPU 上。然而，游戏状态由主循环跟踪。团队为游戏所做的大部分努力都集中在使循环的处理非常流畅。

对于应用程序，通常会在线程上产生繁重的处理。这是一个复杂的主题，因为围绕试图访问相同数据的两件事的问题。关于这个主题有整本书。

对于应用程序，顺序是

1.  用户执行 X、X 和相关信息（如 X、Y 坐标）被发送到 UI_Controller。
2.  UI 决定执行哪个命令。
3.  命令被执行。
4.  模型/数据被修改。
5.  该命令告诉 UI_Controller 更新 UI 的各个区域。
6.  UI_Controller 重绘 UI。
7.  命令返回。
8.  应用程序等待下一个事件。

这有几种变体。该模型可以允许侦听器等待数据的变化。当数据监听器执行并重绘 UI 时。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-18T21:13:58.210

就游戏编程而言，我只是一个业余爱好者，但这是我通常做的：

我有一个对象，它代表了游戏中“场景”的一个非常通用的概念。游戏的所有不同主要部分都源自此 Scene 对象。一个场景实际上可以是任何东西，这取决于它是什么类型的游戏。无论如何，从场景派生的每个更具体的场景都有一个为该场景加载所有必要元素的过程。

当游戏要改变场景时，指向活动场景的指针被设置为一个新场景，然后它将加载所有需要的对象。

通用场景对象具有虚拟函数，例如加载、绘制和逻辑，它们在游戏循环中的特定时间从活动场景指针调用。每个特定场景都有自己实现这些方法的方式。

I don't know if that's how it's supposed to be done or not, but it was a very easy way for me to control the flow of things. The scene concept also made it easy to store multiple scenes as collections. With multiple scene pointers stored in a stack of sorts at one time, scenes could be stored in reserve and maintain their full state when returned to, or even do things like dim but to continue to draw while the active scene drew over them as an overlay of sorts.

So anyway, if you do it like that it's not precisely like a web page but I guess if you think about it the right way it's similar enough.

# c# - C#中的字符串“排序模板”

> ID：379234
> 
> 赞同：4
> 
> 时间：2008-12-18T20:54:59.607
> 
> 标签：c#, sorting

我正在尝试提出一种基于“排序模板”对一组字符串进行排序的简洁方法。如果我的措辞令人困惑，我深表歉意，但我想不出更好的方式来描述它（也许有人可以在阅读我正在尝试做的事情后想出更好的方式来描述它？）。

考虑以下字符串列表（我的“排序模板”，列表中的每个项目都是“命令”）：

*   [FA、TY、AK、PO、PR、ZZ、QW、BC]

我想使用该列表中字符串的顺序来对这些命令的列表进行排序。例如，我想要以下列表：

*   [TY、PR、PR、ZZ、BC、AK]

根据“排序模板”排序到以下列表中：

*   [TY、AK、PR、PR、ZZ、BC]

什么是实现这一目标的好方法？我最好的想法是使用枚举......

```
enum Command
{
    FA,
    TY,
    AK,
    PO,
    PR,
    ZZ,
    QW,
    BC
}; 
```

...并对我想要排序的列表中的每个命令执行 Enum.Parse()，将该列表从字符串列表转换为命令列表，然后根据枚举的顺序对其进行排序。

我不知道。枚举似乎会起作用，但有没有更好的方法可以解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-18T21:20:58.383

这是一个非常简单的方法！

```
List<string> template = new List<string>{ "ZD", "AB", "GR"};

List<string> myList = new List<string>{"AB", "GR", "ZD", "AB", "AB"};
myList.Sort((a, b) => template.IndexOf(a).CompareTo(template.IndexOf(b))); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-18T21:07:14.123

您可以使用 a`Dictionary<string, int>`来存储和检索您的排序模板标记。但是，这基本上与您的枚举相同（可能只是以更易读的方式），因为`Enum.Parse`这里可能会造成混淆。

```
var ordering = Dictionary<string, int>();
ordering.Add("FA", 0);
ordering.Add("TY", 1); // …

MyList.Sort((a, b) => ordering[a].CompareTo(ordering[b])); 
```

这使用方法的适当重载来根据字典`List<T>.Sort`中的值比较两个元素。`template`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-18T21:01:53.120

你可以重命名你的命令，比如

```
[1FA, 2TY, 3AK, 4PO, 5PR, 6ZZ, 7QW, 8BC] 
```

并在您准备好使用它时去掉第一个字符。我认为这被称为[kludge](http://en.wikipedia.org/wiki/Kludge)。

我不禁想到你可能会从使用 a 中获得一些`SortedList`好处，但实际上它可能或多或少像你的那样工作`enum`

```
SortedList Commands = new SortedList();
Commands.Add(1,FA);
Commands.Add(2,TY);
//etc 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-18T21:07:05.573

使用命令模式（我认为它被称为）

编写一个排序方法，对列表进行排序，但使用外部方法在对象对之间进行比较...然后将委托传递给比较方法...编写比较方法以获取列表的两个成员，然后排序模板作为输入参数... 在该方法中，根据在模板列表中首先找到该对的第一个成员还是第二个成员，返回一个 -1、一个 0 或一个 + 1。
在您的排序方法中，使用比较方法的返回值来实现排序，无论您执行哪种排序...

# database-design - 数据库设计：捕获用户/朋友关系的最佳表结构？

> ID：379236
> 
> 赞同：39
> 
> 时间：2008-12-18T20:55:24.380
> 
> 标签：database-design, social-networking

我正在尝试设计一个数据模型，表示一个用户是另一个用户的朋友。到目前为止，这是我想出的，但看起来很笨拙，有没有更好的解决方案？

```
User
=====
Id
Name
etc...

UserFriend
===========
UserId
FriendId
IsMutual
IsBlocked 
```

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2008-12-18T21:04:15.017

```
UserRelationship
====
RelatingUserID
RelatedUserID
Type[friend, block, etc] 
```

同意相互性不属于列；打破规范化。

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2015-07-10T22:52:43.630

要**每两个用户记录一条记录**并避免消耗建议的方法建议的额外内存（需要两倍，因为每个用户有两条记录），您可以执行以下操作：

1.  表结构：

    ```
    USER_RELATIONSHIP {
        user_first_id,
        user_second_id,
        type

        primary key(user_first_id, user_second_id)
    } 
    ```

2.  确保：`user_first_id < user_second_id`

3.  最有趣的部分 - `type`：对于关系的**所有可能状态**，您创建相应的值。例如：

    ```
    pending_first_second
    pending_second_first
    friends
    block_first_second
    block_second_first
    block_both 
    ```

你有什么：

1.  这`user_first_id < user_second_id`确保了两个给定用户之间只有一个关系记录，因为这个和主键约束不允许以其他方式放置它。
2.  通过在关系状态之间进行适当的切换，您可以确定两个用户中的每一个如何相互关联。如果两个用户之间没有关系，则没有记录。
3.  要找出两个用户之间的关系（以及更新），您只需通过一个查询：

    ```
    select * from USER_RELATIONSHIP where
        user_first_id = user1_id and
        user_second_id = user2_id; 
    ```

    没有`or`将检查此列的语句，反之亦然，这样更快。

**示例场景**：

1.  `no record`: 没有关系

2.  `pending_first_second`: 第一个向第二个发了好友请求

3.  `friends`: 第二个批准了好友请求

4.  `no record`：其中一个用户从他的朋友中删除了另一个

该解决方案在内存和速度方面都很有效，因为您只创建、存储和更新一条记录。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-12-18T21:21:18.117

我目前正在为客户建立一个社交网站，我用这种方式表达了一些事情

```
CREATE TABLE [dbo].[PersonFriend] (
    [Id]                          INT            IDENTITY (1, 1) NOT NULL,
    [Timestamp]                   DATETIME       NOT NULL,
    [ChangeUser]                  NVARCHAR (200) NOT NULL,
    [FriendStatusId]              TINYINT        NOT NULL,
    [Person1Id]                   INT            NOT NULL,
    [Person2Id]                   INT            NOT NULL,
    [Person1RequestTimestamp]     DATETIME       NOT NULL,
    [Person2AcknowledgeTimestamp] DATETIME       NULL
); 
```

每个人都存储在 Person 表中（想象一下）。Person1Id 和 Person2Id 字段是 person 表的 FK。我在 FriendStatus 表中保留了一个状态列表，用于涵盖是否已请求、接受、拒绝、忽略等。Timestamp 字段在我的设计中是标准的，用于指示记录创建（它是基本持久性类中使用的模式事物) 及其在此表中的重复类型，因为 Person1RequestTimestamp 包含相同的数据。我还捕获了 Person2 何时看到请求并对其执行操作（在 FriendStatusId 中指示）并将其存储在 Person2AcknowledgeTimestamp 中）。

此设计的核心假设之一可以说是 Person1 请求 Person2 的友谊——如果接受该友谊，则认为该友谊是相互的。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-12-18T20:58:22.360

我会做与您所做的类似的事情，但删除“IsMutual”标志。当它是相互的时，只需添加具有反向值的第二行。它确实添加了行，但感觉更干净。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-18T20:57:55.590

也许添加一个关系表，将关系属性放在那里，然后从 UserFriend 引用它。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-11-09T10:35:27.590

我是这样做的：

表用户

```
id  name
-----------
1   foo
2   roo
3   shoo
4   mooo 
```

TABLE 好友关系

```
id   u_id f_id
--------------
1    1    2
2    2    1
3    3    1
4    1    3 
```

每次好友请求接受插入反向方式`1 2 & 2 1`和简单查询：

```
$ufq=mysql_query("SELECT t1.f_id,t2.id,t2.name FROM friends AS t1, user AS t2 WHERE t1.u_id='$u_id' AND t2.id=t1.f_id ORDER BY t2.name ")or die(mysql_error());
while($fn=mysql_fetch_array($ufq)){
    echo $fn["name"].'<br>';
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-18T21:16:25.303

可能超出了顶部，但可以使用语义网络来对此进行建模。可以使用 FOAF（朋友的 FOAF 朋友）格式。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2011-04-18T23:04:40.640

你觉得我的解决方案怎么样？

你有 3 张桌子

```
1 **the user** (id,.etc)
2 **friend_request**(id,flaggerID,flaggedID)
3 **friend**(id,frienderID,friendedID) 
```

你登录，检查我是否在朋友表中，如果是，列出朋友（我在friender>listfriended）（我在friended>listfriender）

我有要求吗？（我在 flaggedID 中吗？）认识他吗？如果没有，删除记录；如果是，请在请求中创建新记录，因为我被放入标记器并且标记器被标记。现在我们在请求表中的 2 条记录之间具有相互关系，因此我们将两者都删除并将它们放入朋友表中。易于分离请求/朋友。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-18T21:13:27.167

友谊没有经典的雇主/老板和用户/配偶自加入场景那么明确。友谊是一种关系还是一种活动？我因忽视后者而受到相当多的批评。无论哪种方式，无论您的数据模型多么通用，您都可能需要多个表。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-03T18:40:20.367

你真的需要一张实体表来发现是否有共同的朋友吗？为什么不执行如下 SQL 查询：

```
SELECT U.ID, U.NAME FROM USER U
INNER JOIN USERFRIEND UF
ON U.ID = UF.FRIENDID
WHERE U.ID = (SELECT USER.ID FROM USER
            WHERE USER.ID = friend_id AND USER.ID != your_id); 
```

查询的结果应该返回所有共同的朋友。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-08-10T08:47:21.043

好吧，我迟到了，但这是我的出价。

首先是表：

```
User
-id

Type
-id

Relationship
-user_id_1
-user_id_2
-type_id 
```

现在，我想让我的类型表保持简单。所以我添加的类型只代表一个用户与另一个用户的关系。它们从不代表双向关系。例如：

```
friend
ignored 
```

这使得添加新类型变得容易。我不必考虑或创建我所有类型的所有可能组合。我只是添加新类型。

要建立友谊，您需要在关系表中输入 2 个条目。如果两个用户都同意他们是朋友，那么他们就是朋友。如果只有一个人说他和另一个人是朋友，而另一个人把他屏蔽了，他们就不是朋友。

进行查询非常简单。以下是在 MySQL 中获得所有朋友的方法：

```
SELECT u.* FROM user u
LEFT JOIN relationship r1 ON u.id = r1.user_id_2
LEFT JOIN relationship r2 ON u.id = r2.user_id_1
WHERE r1.user_id_1 = <my_user_id> # my relationship with them
AND r1.type_id = <friend_type_id> # i say i'm a friend
AND r2.user_id_2 = <my_user_id> # their relationship with me
AND r2.type_id = <friend_type_id> # they say they're friends 
```

我也认为这种方法更“交易安全”。想象一下，您向某人发送好友请求，然后阻止该人。如果那个人后来接受了好友请求，那也没关系。它不会改变关系的状态，因为它们是完全独立的。

如果您有一个表示双向关系的单一类型，那么一旦朋友接受了朋友请求，您将被迫在代码中进行某种评估，以确定关系的新状态究竟应该是什么。如果您不这样做，您最终可能会解除对某个用户的阻止，并使该人与他或她已阻止的用户成为朋友。

我宁愿在数据库级别处理这个问题。如果您有一群程序员在开发应用程序，那么很快就会有人在某个地方忘记这个问题并创建一个难以发现的错误。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-06-26T14:23:10.327

据我了解，友谊是两个用户（用户 1 和用户 2）之间关系的结果，因为用户 1 可以有 0 个或多个用户作为朋友，反之亦然，用户 2，因此联结表“朋友”出现在中间表示这样的关系：

> User1 id(int) 用户名​​(string)
> 
> User2 id(int) 用户名​​(string)
> 
> 朋友 ---- id(int) user1_Id(int) user2_Id(int) active(bool)

user1_Id 和 user2_Id 都是 Frind 表中的 FK

我希望我是对的。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2014-02-07T04:54:02.960

我认为你应该创建两个表：

1\. user
u_id int
u_username string
balahhh............

2\. 友谊
fs_id int related_id int
related_id
int

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2020-11-02T12:05:40.130

我也在做一个类似的项目，你需要描述友谊，***其中关于你自己和朋友的信息是从一张表中获取的***。

答：我创建了“友谊”表，我通过“friend_id”获取朋友的数据，以及他们认识的日期。为了链接它们，我使用了“关系”表。此链接的 ERD 图（数据库）的图像[朋友关系](https://i.stack.imgur.com/uvPJ0.jpg)

# c++ - C++ 和 SOAP -> 如何开始

> ID：379238
> 
> 赞同：4
> 
> 时间：2008-12-18T20:56:03.257
> 
> 标签：c++, soap, gsoap

我的项目即将引入 SOAP。它将用于 C++ <-> Java 和 C++ <-> Flex 通信。我负责重构我们的应用程序以利用 Java 业务规则引擎和新的 Flex gui。

C++ SOAP 必须阅读哪些资源？我读过W3材料。我们可能在 Solaris 机器上使用 gSOAP。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-19T12:34:35.320

有一些相当不错的 SOAP 书籍，例如Snell、Tidwell 和 Kulchenko 的[Programming Web Services with SOAP ；](https://rads.stackoverflow.com/amzn/click/com/0596000952)过去，我曾将其提供给人们，以便在项目中向他们介绍 SOAP。我不知道 C++ 特定的书，但 gSOAP 站点有相当不错的文档。

我认为真正关键的事情可能是不要一开始就潜入一个复杂的项目；周围有一些 SOAP 教程，比如[这个](http://www.codeproject.com/KB/cpp/eBaygSOAP.aspx)，使用 gSOAP 构建简单的 Web 服务。获取“Hello, world!”的 SOAP 版本 先开始，然后可能在示例中构建那个 eBay 客户端，你会学到很多东西，而你会在尝试先构建一个大示例时更加缓慢和痛苦地学习。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-31T02:00:26.747

另一种选择是不使用 SOAP。您是否考虑过诸如 Protocol Buffers 或 Thrift 之类的东西？

# asp.net - 如何在 asp.net 中使用 jquery 表单插件？

> ID：379239
> 
> 赞同：7
> 
> 时间：2008-12-18T20:56:27.060
> 
> 标签：asp.net, jquery, forms, plugins

在 asp.net 2.0（不是 mvc）中，表单的操作是针对自身的。如何使用表单插件向服务器发送信息？我需要从表单发送数据（比如说姓名、电子邮件、评论）并在客户端显示结果。有任何想法吗？

谢谢，戴夫

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-18T21:42:39.667

女士阿贾克斯？如果我使用更新面板，我不需要 jquery。我只想使用 jquery 和表单插件（加上验证插件）。我没有microsoft ajax，谢谢！只需查看他们在 firebug 中产生的流量即可了解原因。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-19T21:44:49.673

这取决于您在表单提交期间要使用多少 asp.net。我以同样的方式使用表单插件，但您需要考虑更经典的网络模型。

表单插件执行不包含任何视图状态信息的“提交”。也就是说，如果你试图得到这样的值

sName = txtName.text

txtName 的文本将为空白。但是，如果您使用您的请求对象，您应该能够在您知道控件的 UniqueID 的情况下撤回该值

sName = Request.Form(txtName.UniqueID)

然后我要做的是使用表单插件的 success:callback 来运行一个 ajax 调用，这将拉回你的结果。您可以为此使用 ms ajax WebMethods，并且您可以直接从 jquery 调用 webmethods，而无需 ms 脚本管理器。在这种情况下，WebMethod 正在返回我希望在页面上显示的 html。

```
$(form).ajaxSubmit(function(){
   success:function(ret){
     $.ajax({
       type: "POST",
       contentType: "application/json; charset=utf-8",
       dataType: "json",
       data: "{}",
       url: "SomePage.aspx/SomeWebMethod",
       success: function(msg){
         $('#somediv').html(msg); 
       }
   }
}); 
```

[在此处](http://encosia.com/2008/03/27/using-jquery-to-consume-aspnet-json-web-services/)使用 jquery 调用 ms ajax 的更多信息

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-19T11:19:35.913

我目前混合使用 asp.net 和 jquery，我解决页面生命周期问题的方法就是不使用 autopostbacks 和 asp.net 按钮来提交表单。

我使用附加到简单 html 按钮的 ajax 调用，或者，当我真的想提交整个页面时，我使用 __doPostBack(eventTarget, eventArgument) javascript 函数。

这些文章对我有用：

*   [了解 JavaScript __doPostBack 函数](http://aspalliance.com/895_Understanding_the_JavaScript___doPostBack_Function.all#Page3)
*   [在 JavaScript 中调用 __doPostBack](http://geekswithblogs.net/mnf/archive/2005/11/04/59081.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-19T05:36:07.697

由于视图状态与 ASP.NET 中的表单紧密耦合的方式，除非您设置服务来接受请求，否则我不确定这是否可行。如果您不想使用视图状态，那么您可以在 aspx 页面上使用普通的 HTML 表单并将其提交给返回您预期结果的服务。

当您将 asp.net 表单提交到回发时，它会通过页面生命周期将所有内容发回，我认为 jQuery ajax 请求真的没有什么可以交谈的。你*可以*在页面上设置一个[WebMethod](http://msdn.microsoft.com/en-us/library/byxd99hx(VS.71).aspx)，它本质上公开了一个服务，你可以让 jQuery 请求与之对话，但我不相信它会起作用。

但是，您可以在不使用 UpdatePanel 的情况下使用 MS 库执行 ASP.NET AJAX，[请参阅这篇文章](http://encosia.com/2007/07/11/why-aspnet-ajax-updatepanels-are-dangerous/)，了解您可以使用 WebMethods 和 ajax javascript 库执行哪些操作

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-05-18T02:27:09.227

我今天遇到了这个问题，并最终使用以下黑客组合解决了它：

假设您有一个搜索页面和一个结果页面，并且您在搜索页面上有一个表单，您希望将其发布到结果页面并使用 jquery 表单插件通过 ajax 加载。您需要执行以下操作：

1.  创建 Search.aspx 页面和 Results.aspx 页面

2.  ASP.NET 网络表单页面在页面上有一个表单，其 id 为 aspnetForm，但操作将始终设置为发布到自身，因此在加载 Search.aspx 页面时需要做的第一件事是更改操作aspnetForm 的 Results.aspx 如下所示：

    $('#aspnetForm').attr('action', 'Results.aspx');

3.  然后，您需要处理视图状态，以便当您从 Search.aspx 发布到 Results.aspx 时，您不会收到无效的视图状态错误。为此，只需从页面中删除 viewstate 变量，如下所示：

    $('#__VIEWSTATE').remove();

4.  那么您应该能够设置 #aspnetForm 以使用 jquery 表单插件，如下所示：

    $('#aspnetForm').ajaxForm();

然后，这允许您发布到 Results.aspx 网络表单。这只是让您朝着正确方向前进的开始，但基本上归结为需要更改 aspnet 表单发布到的操作，然后删除视图状态。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-01T08:57:14.053

它不起作用，因为只要您使用服务器控件，ASP.NET 就会强制您将所有内容都放在服务器表单中（这是它处理回发的方式）。您遇到的主要问题是 HTML 无论如何都不允许嵌套表单，因此您甚至无法使用 jQuery 来查找表单元素（这就是我对 FF3 的经验）

好的答案（但很难实现）- 抛弃 WebForm 并使用 MVC。

折衷的解决方法——我自己做了一个小插件，将 div 转换为 ajax 提交，使用 method="post" 和 action="url" 装扮滥用的 div，然后使用 jQuery Form Plugin 序列化，使用插件模式提交. 虽然它不执行文件上传（因为这需要 IFrame，我认为它仍然可行，但需要更多技巧）。该代码在我客户的项目中，因此我仍然无权将其作为插件发布。但是，我认为一旦您了解了理论，这并不难做到:)

真的，下次要争取好的答案（摆脱 WebForm）。它不仅仅是 jQuery Form 会伤害你，如果你决定做 jQuery + Web Form，你必须承受更多的痛苦，如果这不是我客户的要求，我永远不会走这条路。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-18T21:46:49.160

VS08 似乎不适合您，但其他人可能会感兴趣：前几天我参加了 MSDN 路演，这似乎很容易。Scott Gu 的博客有这个： [http ://weblogs.asp.net/scottgu/archive/2008/11/21/jquery-intellisense-in-vs-2008.aspx](http://weblogs.asp.net/scottgu/archive/2008/11/21/jquery-intellisense-in-vs-2008.aspx)

# unicode - 是否有可以显示 Unicode 字符的 Windows 命令外壳？

> ID：379240
> 
> 赞同：52
> 
> 时间：2008-12-18T20:56:46.577
> 
> 标签：unicode, powershell

假设我安装了具有适当字形的字体，是否有用于 Windows XP 的命令外壳来显示 Unicode 字符？至少，应该正确显示 Unicode 的两件事：

*   目录列表。我不在乎我必须输入什么（dir、ls、get-childitem 等），只要名称中带有 Unicode 字符的文件以正确的字形出现，而不是不可打印的字符框。
*   文本文件内容列表。再一次，只要字符被打印出来，它是否是“少”、“多”、“猫”、“狗”等对我来说并不重要。我认识到由于文件的字符编码，这更复杂，所以如果我必须在命令行上指定它，那对我来说很好。

这是我到目前为止所尝试的：

*   命令文件
*   Windows PowerShell；包括多语言版本。
*   Cygwin 狂欢

没运气。我什至尝试[为 cmd/PowerShell 安装自定义字体](http://blogs.msdn.com/powershell/archive/2006/10/16/Windows-PowerShell-Font-Customization.aspx)。PowerShell 和 cmd.exe 似乎可以识别 Unicode，因为我可以从那里复制/粘贴不可打印的框，它会粘贴到具有正确字符的其他应用程序中。Cygwin (?) 似乎转换为 ? 字符，并且通过复制/粘贴来实现。

有任何想法吗？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-04-10T13:56:31.040

要使用*cmd.exe*执行此操作，您需要使用控制台属性对话框切换到 Unicode TrueType 字体。

然后使用这些命令：

```
 CHCP 65001
 DIR > UTF8.TXT
 TYPE UTF8.TXT 
```

命令：

*   将控制台切换到 UTF-8 (65001)
*   将 DIR 的输出重定向到*UTF8.TXT*
*   将 UTF-8 转储到控制台

这些字符仍需要字体支持才能在控制台上正确显示。

[I18N：Windows 命令提示符下的 Unicode（C++；.Net；Java）](http://illegalargumentexception.blogspot.com/2009/04/i18n-unicode-at-windows-command-prompt.html)

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-12-18T21:15:26.290

这是 PowerShell v1 中的一个主要问题。版本 2 附带了一个“图形外壳”来纠正问题，最终不是使用 PowerShell，而是使用 Windows 控制台主机（Cmd.exe 也使用它）。如果需要，您可以获取 PowerShell v2 的当前 CTP。

实际上，PowerShell v2.0 已在 8 月初完成并随 Windows 7 和 Windows Server 2008 R2 的发布一起发布。此外，向后移植的版本 (Windows Vista/2008) 就在前几天达到了它们的候选版本里程碑；Windows XP/Windows Server 2003 应该很快就会出现。[链接链接链接](http://blogs.msdn.com/powershell/archive/2009/08/14/powershell-2-0-for-windows-vista-and-windows-server-2008-release-candidate.aspx)。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-09T19:08:44.963

使用命令“chcp 65001”将代码页设置为 UTF-8 应该可以帮助您将文件内容正确地打印到 shell（使用 cmd.exe）。但是，这不适用于目录列表（NTFS 文件名中的 UTF-16 编码）。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-12-28T08:02:04.000

试试这个：

```
powershell.exe -NoExit /c "chcp.com 65001" 
```

谁使用 msysgit：

```
powershell.exe -NoExit /c "chcp.com 65001; sh --login -i" 
```

不要忘记将窗口字体更改为支持 UTF-8 的 TrueType 字体（“Lucida Console”）

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-04-28T00:42:28.263

这就是我`cmd.exe`在 Windows 7 Pro 英文版上运行时获得中文输出的方法。我还尝试了使用日语、俄语和波兰语的文件名，它们似乎都能正确显示。输入似乎也有效，至少当我尝试执行`dir xxx*`包含非 ascii 字符时。

1.  安装[console2](http://sourceforge.net/projects/console/)`cmd.exe` ，它是（和其他 shell）的前端

2.  安装后，请按照[以下说明进行操作](http://wrongpc.blogspot.ca/2008/03/concole2-unicode-traditional-chinese.html)

    删除`HKEY_CURRENT_USER\Console\Console2 command window`注册表中的键。

    将以下数据导入 Windows 注册表：

    ```
    Windows Registry Editor Version 5.00
    [HKEY_CURRENT_USER\Console\Console2 command window] 
    "CodePage"=dword:000003a8 
    "FontSize"=dword:000a0000 
    "FontFamily"=dword:00000036 
    "FontWeight"=dword:00000190 
    "FaceName"="細明體" 
    "HistoryNoDup"=dword:00000000 
    ```

3.  您可能需要也可能不需要更改字体。最初我将字体设置为`@NimSum`，汉字旋转了 90 度。然后我切换到`NimSum`（没有@），它正确地出来了。然后只是出于好奇，我切换到了`Consola`，但我仍然可以看到汉字。所以我不确定你是否真的需要设置字体。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-03T22:02:11.413

要获得真正的 shell，请尝试 PowerShell Plus。您可以选择 Unicode 字体并使用其他语言，不仅在编辑器中，而且在真正的控制台中。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-07T19:33:40.133

尝试[控制台 2](http://sourceforge.net/projects/console/)。不过要小心颜色/调色板配置。那些有点马车。我已经确认它们不起作用；它们的行为类似于 cmd.exe。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-08-01T09:37:54.703

打开提升的命令提示符（以管理员身份运行 cmd）。通过以下方式在您的注册表中查询可用的 TrueType 字体到控制台：

```
REG query "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Console\TrueTypeFont" 
```

您将看到如下输出：

```
0    REG_SZ    Lucida Console
00    REG_SZ    Consolas
936    REG_SZ    *新宋体
932    REG_SZ    *ＭＳ ゴシック 
```

现在我们需要添加一个支持您需要的字符的 TrueType 字体，例如 Courier New，我们通过在字符串名称中添加零来做到这一点，所以在这种情况下，下一个将是 "000" ：

```
REG ADD "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Console\TrueTypeFont" /v 000 /t REG_SZ /d "Courier New" 
```

现在我们实现 UTF-8 支持：

```
REG ADD HKCU\Console /v CodePage /t REG_DWORD /d 65001 /f 
```

将默认字体设置为“Courier New”：

```
REG ADD HKCU\Console /v FaceName /t REG_SZ /d "Courier New" /f 
```

将字体大小设置为 20 ：

```
REG ADD HKCU\Console /v FontSize /t REG_DWORD /d 20 /f 
```

如果您愿意，可以启用快速编辑：

```
REG ADD HKCU\Console /v QuickEdit /t REG_DWORD /d 1 /f 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-02-19T00:14:44.877

截至[2011 年 11 月](http://cygwin.com/ml/cygwin-announce/2011-11/msg00040.html)，MinTTY 现在是 Cygwin 的默认终端仿真器（由 安装`setup.exe`）。MinTTY 是 PuTTY 终端仿真器的一个分支，因此具有适当的 Unicode 支持，并且与其他终端仿真器的兼容性大大提高。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-09-18T18:26:20.593

[Console2](http://sourceforge.net/projects/console/)中的[PowerShell V2 CTP3](http://www.microsoft.com/downloads/details.aspx?FamilyID=c913aeab-d7b4-4bb1-a958-ee6d7fe307bc&displaylang=en)似乎可以做到这一点。唯一的缺点是默认的控制台编码是 UCS-2 LE 而不是 UTF-8。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2014-06-10T07:50:06.757

也来自 [cmd.exe 上的 UTF-16](https://stackoverflow.com/questions/10764920/utf-16-on-cmd-exe)

```
 Open/run cmd.exe
    Click on the icon at the top-left corner
    Select properties
    Then "Font" bar
    Select "Lucida Console" and OK.
    Write Chcp 10000 at the prompt
    Finally dir /b 
```

* * *

## 回答 #12

> 赞同：-5
> 
> 时间：2017-05-07T18:38:48.390

一种快速便捷的方法是在资源管理器上。

```
    1\. 打开资源管理器窗口。
    2\. 遍历到要查找的顶级目录。
    3\. 在右上角，有一个查找字段。

```

# java - Java I/O using inpout32.dll

> ID：379256
> 
> 赞同：2
> 
> 时间：2008-12-18T21:02:17.267
> 
> 标签：java, dll, io, java-native-interface, native

I am trying to control some LEDs wired to the parallel port on Windows XP. The easiest solution would be [Inpout32.dll](http://logix4u.net/Legacy_Ports/Parallel_Port/Inpout32.dll_for_Windows_98/2000/NT/XP.html) from [Logix4u.net](http://logix4u.net/). I have found many source code samples in various languages (C++, Visual Basic, C#) but nothing using Java.

Do you know any tutorials about calling DLL functions from Java ? (what I have found so far on Google are not so advanced).

Environment: Java 1.6.0, Windows XP

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-18T21:32:33.323

The generic way to access native code from Java is [JNI](http://en.wikipedia.org/wiki/Java_Native_Interface).

However, there are frameworks like [JNA](https://github.com/twall/jna/) and/or [JInvoke](http://www.jinvoke.com) hiding all complexity of JNI and providing interface similar to VBasic and C#.

BTW, there are JNI library and samples for your specific DLL [here](http://www.hytherion.com/beattidp/comput/pport.htm)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-18T21:46:36.507

There is also [JNIWrapper](http://www.teamdev.com/jniwrapper/index.jsf)

# database - 您的 SharePoint 数据库创建最佳实践清单是什么样的？

> ID：379261
> 
> 赞同：2
> 
> 时间：2008-12-18T21:03:20.993
> 
> 标签：database, sharepoint, settings

我注意到默认 SharePoint 数据库是在恢复模式中使用“完整”创建的，数据自动增长 1 Mb，日志文件增长 10%。

我知道这些设置应该针对特定客户进行调整，但我还没有找到任何关于最佳数据库设置的经验法则。

您以哪种方式调整数据库设置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-19T13:32:17.857

SharePoint 配置数据库和 SharePoint 内容数据库在生产环境中应始终配置为完全恢复。否则，您可能会失去回滚数据库超出意外数据丢失点的能力。SSP 数据库可以在 Simple Recovery 上，我认为它们也是默认的。它们只保存诸如设置和元数据搜索索引之类的东西，即它们不保存来自用户的任何内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-21T08:09:18.180

您不能允许 SharePoint 创建您的内容数据库。您注意到的默认值是 1MB 默认大小，增长 10%。如果在使用数据库期间发生数据库自动增长，则该网站集中的所有网站都将停止，同时数据库分配更多空间。此外，您几乎可以保证得到数据库碎片。

最好避免数据库的计划外自动增长。为此，您需要手动创建数据库并将其设置为创建时数据库的预期大小。一个文档繁重的网站应为 50 - 100GB，并且 SharePoint 应限制在不超过该数量。

这个数字确实取决于硬件和预计出现在站点中的数据量。因此，较小的网站集不需要这么大的数据库。

# c# - Windows 服务，无法从我的安装程序的构造函数中访问 app.config

> ID：379276
> 
> 赞同：9
> 
> 时间：2008-12-18T21:08:52.120
> 
> 标签：c#, .net, security, configuration, windows-services

我想将我的 Windows 服务“登录身份”用户的用户名/密码信息存储在 app.config 中。

因此，在我的安装程序中，我试图从 app.config 中获取用户名/密码并设置属性，但在尝试安装服务时出现错误。

如果我硬编码用户名/密码，它工作正常，当我尝试访问 app.config 时失败

```
public class Blah : Installer
{

    public Blah()
    {

        ServiceProcessInstaller oServiceProcessInstaller = new ServiceProcessInstaller();
                ServiceInstaller oServiceInstaller = new ServiceInstaller();            

                oServiceProcessInstaller.Account = ServiceAccount.User;

        oServiceProcessInstaller.Username =             ConfigurationManager.AppSettings["ServiceProcessUsername"].ToString();

    }
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-20T19:26:01.183

只是关于在安装程序中访问配置文件的一些想法。

```
Configuration config = ConfigurationManager.OpenExeConfiguration(assemblyPath);
ConnectionStringsSection csSection = config.ConnectionStrings; 
```

组装路径可以通过以下几种方式获得： 内部安装程序类实现：

```
this.Context.Parameters["assemblypath"].ToString(); 
```

或者有时带有反思：

```
Assembly service = Assembly.GetAssembly(typeof(MyInstaller));
string assemblyPath = service.Location; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-18T22:20:28.123

问题是当您的安装程序运行时，您仍处于安装阶段并且您的应用程序尚未完全安装。app.config 仅在实际应用程序运行时可用。

但是，您可以执行以下操作：

1.  在安装程序中（或在命令行中）提示用户输入用户名和密码。
2.  将此信息传递给您的安装程序类（google it）
3.  在您的安装程序类中，有一个变量告诉您​​安装路径
4.  在安装程序的相应事件中，使用 System.IO 函数打开 app.config 文件并插入用户输入的信息

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-10-05T13:05:48.890

我对服务安装程序有同样的问题。您必须调用配置文件“myService.exe.config”并使用带有程序集路径的 OpenExeConfiguration 方法来查找正确的配置文件（如第一个答案中所述，当您的安装程序运行时，基本目录是installUtil 的目录而不是您的安装程序的目录）

```
{
Assembly __ServiceAssembly = Assembly.GetAssembly(typeof(MyServiceInstaller));
Configuration config = ConfigurationManager.OpenExeConfiguration(__ServiceAssembly.Location);
KeyValueConfigurationCollection  svcSettings = config.AppSettings.Settings;
info("Service name : " + svcSettings["ServiceName"].Value);
} 
```

如果您不想遵循“myService.exe.config”格式，请使用 exeConfigurationFileMap：

```
{
Assembly __ServiceAssembly = Assembly.GetAssembly(typeof(SyslogServiceInstaller));
ExeConfigurationFileMap configFileMap = new ExeConfigurationFileMap();
configFileMap.ExeConfigFilename = 
     Path.Combine(Directory.GetParent(__ServiceAssembly.Location).ToString(),
     "App.config");

Configuration config = ConfigurationManager.OpenMappedExeConfiguration(
     configFileMap, ConfigurationUserLevel.None);
KeyValueConfigurationCollection mySettings = config.AppSettings.Settings;

Console.Out.WriteLine(mySettings["ServiceName"].Value);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-23T00:55:58.910

您真的不应该在 app.config 文件中存储密码，这非常糟糕。您需要使用服务帐户、当前用户或提示他们。用户还可以右键单击 .exe（可能是触发您的安装的原因）并选择“运行方式”以在安装前更改其凭据（在这种情况下，当前用户将是一个不错的选择）。

此外，在服务管理器中，用户可以在安装结束后更改服务应该运行的用户。但是您绝对不想将密码存储在纯文本文件中。

# language-agnostic - 为什么在多态中同时使用基类和接口？

> ID：379282
> 
> 赞同：1
> 
> 时间：2008-12-18T21:12:14.487
> 
> 标签：language-agnostic

在多态的 C# 示例中，有一个 Cat 类继承了一个名为 AnimalBase 的类和一个名为 IAnimal 的接口。

有问题的链接是：[http ://en.wikipedia.org/wiki/Polymorphism_in_object-oriented_programming](http://en.wikipedia.org/wiki/Polymorphism_in_object-oriented_programming)

我的问题是，为什么同时使用基类和接口？为什么不是其中一个？我认为只需要一个抽象类来实现多态性。

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-18T21:15:19.393

当您想要重用 BEHAVIOR 时使用基类

当您想要控制类如何与其他对象交互时，使用接口。它以精确的方式定义交互。

以我的经验，你想要控制类如何交互的次数远远超过你想要重用行为的次数。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-18T22:10:25.867

“从基类继承允许您继承 BEHAVIOR，而实现接口仅允许您指定 INTERACTION”的说法是绝对正确的。

但更重要的是，接口允许静态类型语言继续支持多态性。一个面向对象的纯粹主义者会坚持认为一种语言应该提供继承、封装、模块化和多态性，以便成为一种功能齐全的面向对象语言。在动态类型或鸭子类型的语言（如 Smalltalk）中，多态是微不足道的。然而，在静态类型语言（如 Java 或 C#）中，多态性远非微不足道（事实上，从表面上看，它似乎与强类型的概念不一致。）

让我演示一下：

在动态类型（或鸭子类型）语言（如 Smalltalk）中，所有变量都是对对象的引用（不多也不少。）所以，在 Smalltalk 中，我可以这样做：

```
|anAnimal|    
anAnimal := Pig new.
anAnimal makeNoise.

anAnimal := Cow new.
anAnimal makeNoise. 
```

该代码：

1.  声明一个名为 anAnimal 的局部变量（请注意，我们不指定变量的类型 - 所有变量都是对对象的引用，不多也不少。）
2.  创建名为“Pig”的类的新实例
3.  将 Duck 的新实例分配给变量 anAnimal。
4.  将消息发送`makeNoise`给猪。
5.  使用牛重复整个过程，但将其分配给与 Pig 相同的变量。

相同的 Java 代码看起来像这样（假设 Duck 和 Cow 是 Animal 的子类：

```
Animal anAnimal = new Pig();
duck.makeNoise();

anAnimal = new Cow();
cow.makeNoise(); 
```

这一切都很好，直到我们介绍蔬菜类。蔬菜有一些与动物相同的行为，但不是全部。例如，动物和蔬菜可能都可以生长，但显然蔬菜不会发出噪音，动物也无法收获。

在 Smalltalk 中，我们可以这样写：

```
|aFarmObject|
aFarmObject := Cow new.
aFarmObject grow.
aFarmObject makeNoise.

aFarmObject := Corn new.
aFarmObject grow.
aFarmObject harvest. 
```

这在 Smalltalk 中非常有效，因为它是鸭子类型的（如果它像鸭子一样走路，并且像鸭子一样嘎嘎叫 - 它就是鸭子。）在这种情况下，当消息发送到对象时，会在接收者的方法列表，如果找到匹配的方法，则调用它。如果没有，则会抛出某种 NoSuchMethodError 异常——但这一切都是在运行时完成的。

但是在 Java 这种静态类型语言中，我们可以为变量分配什么类型？玉米需要从蔬菜继承，以支持生长，但不能从动物继承，因为它不会发出噪音。Cow 需要从 Animal 继承来支持 makeNoise，但不能从 Vegetable 继承，因为它不应该实现收获。看起来我们需要*多重继承*——从多个类继承的能力。但事实证明这是一个非常困难的语言特性，因为会出现所有边缘情况（当多个并行超类实现相同的方法时会发生什么？等等）

随之而来的接口...

如果我们创建动物和蔬菜类，每个实现 Growable，我们可以声明我们的牛是动物，我们的玉米是蔬菜。我们还可以声明动物和蔬菜都是可生长的。这让我们写这个来增长一切：

```
List<Growable> list = new ArrayList<Growable>();
list.add(new Cow());
list.add(new Corn());
list.add(new Pig());

for(Growable g : list) {
   g.grow();
} 
```

它让我们这样做，发出动物的声音：

```
List<Animal> list = new ArrayList<Animal>();
list.add(new Cow());
list.add(new Pig());
for(Animal a : list) {
  a.makeNoise();
} 
```

鸭子类型语言的最大优势是您可以获得非常好的多态性：一个类提供行为所要做的就是提供方法（还有其他权衡，但在讨论类型时这是一个重要的权衡。）只要每个人都玩得很好，只发送与定义的方法匹配的消息，一切都很好。缺点是直到运行时才捕获到下面的错误类型：

```
|aFarmObject|
aFarmObject := Corn new.
aFarmObject makeNoise. // No compiler error - not checked until runtime. 
```

静态类型语言提供了更好的“契约式编程”，因为它们会在编译时捕获以下两种错误：

```
Animal farmObject = new Corn();  // Compiler error: Corn cannot be cast to Animal.
farmObject makeNoise(); 
```

--

```
Animal farmObject = new Cow();
farmObject.harvest(); // Compiler error: Animal doesn't have the harvest message. 
```

所以....总结一下：

1.  接口实现允许你指定对象可以做什么样的事情（交互），类继承让你指定应该如何做事情（实现）。

2.  接口为我们提供了“真正的”多态性的许多好处，而不会牺牲编译器类型检查。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-18T21:15:50.610

拥有一个抽象类可以让您以一种通用的方式实现一些/大部分成员。拥有一个接口意味着当您想将它用于多态性时，您*不仅限于使用该抽象基类。*

我不认为两者都有任何矛盾。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-18T21:18:48.343

*接口为您提供跨*类层次结构的多态行为的能力。缺点是您不能（直接）继承默认实现。使用类多态性，您只能在类层次结构中获得该多态行为，但您可以继承常见/默认行为。通过继承和提供接口，您提供了一个契约（接口），但获得了继承的简单实现好处，同时仍然允许其他人在基类限制之外支持“契约”。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-18T21:27:33.190

接口强制执行“行为”。任何声明为实现指定接口的类都必须使用接口中声明的签名来实现成员。即，它们必须公开指定的行为......它们不必以相同的方式实现行为，但它们必须具有相同的行为...即鸟和蠕虫都“CanMove”，因此它们都必须实现能够“移动”的行为，指定它们都必须实现接口 ICanMove 这样做...他们如何做到这一点是实现的功能。

基类用于重用“实现”......

这就是为什么接口的命名约定建议在 IEnumerable、ICanMove、ICanLog 等中使用“I[动词/副词]”。

您使用基类将通用实现放在一个地方。如果抽象基类在任何成员中都没有实现，那么它的功能与接口相同，接口不能有实现

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-18T21:18:57.313

基类和接口实际上大多具有不相关的用途。基类的主要目的是让您的继承类能够导入一些常用功能。接口的主要目的是让*其他*类能够提出问题，“这个对象是否支持接口 X”？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-18T21:19:23.317

所以我想我可以继承一个用于常见行为的动物类，比如走路、睡觉等，然后有一个专门的接口（也许是狮子），它包含特定的行为和属性——比如动物很危险，会吃人， ETC。

# python - Python 中的 []-esque 装饰器语法是什么意思？

> ID：379291
> 
> 赞同：8
> 
> 时间：2008-12-18T21:14:04.653
> 
> 标签：python, syntax, decorator

这是 TurboGears 1.0.6 中的一段代码：

```
[dispatch.generic(MultiorderGenericFunction)]
def run_with_transaction(func, *args, **kw):
    pass 
```

我不知道在函数定义之前放置一个列表会如何影响它。

在 dispatch.generic 的文档字符串中，它提到：

> 请注意，当使用较旧的 Python 版本时，您必须使用 '[dispatch.generic()]' 而不是 '@dispatch.generic()'。

好的，所以这显然是一种在 Python 的预装饰器版本中获得类似装饰器的行为的方法，但它到底是如何工作的呢？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-18T21:44:07.980

装饰器语法由 PyProtocols 提供。

""" 最后，需要注意的是，这些“魔法”装饰器使用了一种非常狡猾的技巧：它们滥用 sys.settrace() 调试器钩子来跟踪分配是否正在发生。Guido 对此持非常模糊的看法，但是hook现有的功能在2.2、2.3或2.4中都不会改变，所以不要太担心。这确实是一个“早期访问”装饰器的技巧，2.4的生命周期会足够长让我们的代码切换到 2.4 语法。在 Python 2.5 或 2.6 左右的某个地方，add_assignment_advisor() 可以放弃神奇的部分，而只是使用它的装饰器的向后兼容性包装器。“”“ [http://dirtsimple.org/ 2004/11/using-24-decorators-with-22-and-23.html](http://dirtsimple.org/2004/11/using-24-decorators-with-22-and-23.html)

所以听起来这些工作是通过将实际的装饰器包装在一些魔术中的，这些魔术挂钩到特殊的代码中，以便调试器操纵实际分配给函数的内容。

python 文档说这个关于 settrace

""" 注意 settrace() 函数仅用于实现调试器、分析器、覆盖工具等。它的行为是实现平台的一部分，而不是语言定义的一部分，因此可能并非在所有 Python 中都可用实现。"""

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2008-12-18T21:22:48.677

没什么神秘的，这就是以前的语法。

解析器发生了变化，可能是因为 Python Zen 声称“面对歧义，拒绝猜测的诱惑。”。

[] 应该仅用于列表，并且有它。

# c++ - Boost 是否因不像 Boost 那样感到内 疚？

> ID：379306
> 
> 赞同：5
> 
> 时间：2008-12-18T21:16:40.000
> 
> 标签：c++, boost, parsing, boost-spirit

我只是在阅读 Boost::Spirit LL Parser 框架的介绍。前言暗示作者和创作者喜欢使用这种解析技术来读取程序选项。Boost 没有自己的程序选项库吗？

我想知道，Boost 委员会是否会审查所有图书馆笔记的共同主题和风格？似乎每个图书馆的文档都有自己的风格。

一个令人惊叹的软件的小抱怨，我只是觉得它很好奇。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-11-19T15:42:14.490

简单地说，Spirit 存在于 Boost.Program-Options 库之前。现在，我总是使用 Boost.Program-Options 而不是自己使用 Spirit 手动滚动。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-18T22:21:05.300

你是对的，并不是所有的 boost 库都特别像 boost。Spirit就是一个很好的例子。部分原因是当它被接受时，其他 boost 库还没有被接受/还没有足够成熟，Spirit 可以使用它们。（这就是为什么有类似 3 个 Boost 库定义自己*的*（不兼容的）占位符值 _1、_2 等的原因）。

在大多数情况下，我相信他们正在逐渐努力将这些奇怪的东西重新组合在一起。但是，afaik，添加了 Spirit 是因为它是如此大而令人印象深刻的东西，以至于它的“unboostness”被原谅了。;)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-08-03T13:33:25.873

Spirit in Boost 有朝一日可能会成为 Boost in Spirit :-)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-07-02T18:50:25.483

正如 Joel 所说，Spirit 诞生时我们没有 Program-Options。Hartmut Kaiser 和我（都是 Spirit 开发人员）在工作中使用 Program-Options，而不是推出我们自己的 Spirit 解析器。Program-Options 的作用远不止解析，而且，至少对于我们的需要，命令行解析的性能并不重要。对于性能关键解析，我肯定会使用 Spirit。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-03T12:29:07.107

没有像 Boost 风格委员会这样的东西。ISO 的 WG21 将在通用样式上花费更多时间，但即使他们也设法忘记了 std::ifstream::ifstream((std::string const& filename)

# sql - 我可以在 SQL Server 2005 中禁用标识符检查吗？

> ID：379316
> 
> 赞同：0
> 
> 时间：2008-12-18T21:18:32.070
> 
> 标签：sql, sql-server, sql-server-2005, version-control

我有各种各样的数据库对象（表、函数、视图、存储过程），每个都编写到自己的文件中（约束与它们改变的表在同一个文件中），我希望能够以任意顺序执行。这在 SQL Server 2005 中可行吗？

以一些对象为例：
Table A（引用 Table B）
Table B（引用 Function A）
Function A（引用 View A）
View A（引用 Table C）

必须按以下顺序运行：
表 C
视图 A
函数 A
表 B
表 A

如果脚本无序运行，则会引发有关丢失对象的错误。

我问的原因是，在我正在处理的项目中，我们将每个数据库对象维护在其自己的文件中（出于源代码控制目的），然后维护一个主脚本，以正确的顺序创建每个数据库对象。这需要在将对象添加到模式时手动编辑主脚本。我希望能够执行在文件系统中找到的每个脚本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-18T21:42:50.867

以我的经验，最有问题的问题是视图，它可以递归引用。我曾经编写了一个实用程序来遍历脚本，直到错误全部解决。仅当您加载所有内容时才有效。顺序很重要——我认为我做了 UDT、表、FK、视图（迭代）、SP 和 UDF（迭代直到我们认为 SP 调用 SP 是一个坏主意，而 UDF 通常是一个坏主意。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-18T21:33:52.010

如果将外键脚本写入单独的文件，则可以摆脱表-表依赖关系，如果在创建所有表后运行 FK 脚本。

据我所知，函数和过程仅在 JOIN 子句中检查对象是否存在。

我发现的唯一困难是视图依赖于视图，因为视图定义要求视图所依赖的对象确实存在。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-18T21:32:27.190

我发现[这个页面](http://decipherinfosys.wordpress.com/2008/02/20/disableenable-foreign-key-and-check-constraints-in-sql-server/)，作者写了一个很好的程序来做你所说的事情。听起来您只需要拥有它的两个版本，一个用于禁用约束，另一个用于重新启用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-18T21:47:57.533

APEX SQL 脚本应该分析依赖关系并对脚本进行适当的排序，但即便如此我也遇到了问题。

# c# - 从目录中删除的权限

> ID：379319
> 
> 赞同：0
> 
> 时间：2008-12-18T21:18:53.740
> 
> 标签：c#, .net, security

我正在编写代码来检查某些目录的写入和删除权限。第一个相当容易。到白衣：

```
FileIOPermission writePermit = new FileIOPermission(FileIOPermissionAccess.Write, _ArchiveHome);
writePermit.Demand(); 
```

但是，对于从给定目录中删除的权限，我该如何做同样的事情？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-18T21:23:32.763

Write 属性相互表示您可以删除 [msdn 链接](http://msdn.microsoft.com/en-us/library/system.security.permissions.fileiopermissionaccess(VS.85).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-03T02:17:00.853

写许可允许您修改文件，如删除、修改、创建、添加。

# mappoint - JPG 可以导入 MapPoint 吗？

> ID：379323
> 
> 赞同：3
> 
> 时间：2008-12-18T21:20:01.193
> 
> 标签：mappoint

谁能告诉我是否可以将 .jpg 文件导入 MS Mappoint Europe 2006？如果可能的话，这可以通过 OCX 控件来完成吗？

我想将某个区域的一些航拍照片导入 MapPoint 以增强小区域的覆盖范围，

谢谢你的时间

伊恩

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-01-24T01:19:29.303

不是以一种简单而有意义的方式。

我听说有人将他们的图像图块作为图钉图像导入，然后在地图区域上绘制这些图块。这应该可行**，但**瓷砖大小将是比例不变的。IE。当您放大或缩小时，图像会变得混乱。

更复杂的方法是在 ActiveX 控件中使用 MapPoint 并拦截所有缩放/平移消息。然后使用这些来确定当前的视图区域和投影。然后使用 Win32 GDI+ 调用，您应该能够在 ActiveX 控件区域上覆盖图像（使用 alpha 设置透明度）。那是理论上的——要让它工作需要相当多的实验，而且使用替代实现（甚至是开源查看器）可能更容易。

# c# - C# 将参数命名为替换为参数值的字符串

> ID：379328
> 
> 赞同：8
> 
> 时间：2008-12-18T21:20:58.463
> 
> 标签：c#, regex, performance, string, named-parameters

我希望以一种良好的性能方式（我希望）将我的字符串中的命名参数替换为代码中的命名参数，例如，我的字符串：

```
"Hi {name}, do you like milk?" 
```

我怎么能用代码替换 {name} ，正则表达式？贵吗？你推荐哪种方式？

他们如何在示例 NHibernates HQL 中将 :my_param 替换为用户定义的值？或者在我更喜欢的 ASP.NET (MVC) 路由中，“{controller}/{action}”，new { controller = “Hello”，...}？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-12-18T21:25:12.870

你确认正则表达式太贵了吗？

正则表达式的成本被大大夸大了。对于这样一个简单的模式，性能将非常好，实际上可能只比直接搜索和替换稍差。另外，你`Compiled`在构造正则表达式的时候有没有尝试过flag？

也就是说，你不能只使用最简单的方法，即`Replace`？

```
string varname = "name";
string pattern = "{" + varname + "}";
Console.WriteLine("Hi {name}".Replace(pattern, "Mike")); 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-12-18T21:26:50.073

正则表达式当然是一个可行的选择，尤其是使用`MatchEvaluator`:

```
 Regex re = new Regex(@"\{(\w*?)\}", RegexOptions.Compiled); // store this...

    string input = "Hi {name}, do you like {food}?";

    Dictionary<string, string> vals = new Dictionary<string, string>();
    vals.Add("name", "Fred");
    vals.Add("food", "milk");

    string q = re.Replace(input, delegate(Match match)
    {
        string key = match.Groups[1].Value;
        return vals[key];
    }); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-18T21:45:19.863

现在，如果您在字典中有替换项，如下所示：

```
 var  replacements = new Dictionary<string, string>();
    replacements["name"] = "Mike";
    replacements["age"]= "20"; 
```

那么正则表达式变得非常简单：

```
Regex regex = new Regex(@"\{(?<key>\w+)\}");
    string formattext = "{name} is {age} years old";
    string newStr = regex.Replace(formattext, 
            match=>replacements[match.Groups[1].Captures[0].Value]); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-03-31T17:06:07.767

考虑到这一点，我意识到我真正想要的是 String.Format() 将 IDictionary 作为参数，并且可以使用名称而不是索引来编写模板。

对于具有许多可能的键/值的字符串替换，索引号会导致难以辨认的字符串模板 - 在某些情况下，您甚至可能不知道哪些项目将有什么数字，所以我想出了以下扩展名：

[https://gist.github.com/896724](https://gist.github.com/896724)

基本上，这使您可以使用带有名称而不是数字的字符串模板和字典而不是数组，并让您拥有 String.Format() 的所有其他良好功能，如果需要，允许使用自定义 IFormatProvider，并允许使用所有常用的格式化语法——精度、长度等。

String.Format 参考资料中提供的示例[是一个很好的示例，说明具有许多编号项目的模板如何变得完全难以辨认 - 将该示例移植到使用这种新的扩展方法，您会得到如下内容：](http://msdn.microsoft.com/en-us/library/1ksz8yb7.aspx)

```
var replacements = new Dictionary<String, object>()
                       {
                           { "date1", new DateTime(2009, 7, 1) },
                           { "hiTime", new TimeSpan(14, 17, 32) },
                           { "hiTemp", 62.1m },
                           { "loTime", new TimeSpan(3, 16, 10) },
                           { "loTemp", 54.8m }
                       };

var template =
    "Temperature on {date1:d}:\n{hiTime,11}: {hiTemp} degrees (hi)\n{loTime,11}: {loTemp} degrees (lo)";

var result = template.Subtitute(replacements); 
```

正如有人指出的那样，如果您正在编写的内容需要高度优化，请不要使用这样的东西 - 如果您必须以这种方式格式化数百万个字符串，在一个循环中，内存和性能开销可能会很大。

另一方面，如果您关心编写清晰、可维护的代码 - 并且如果您正在执行一系列数据库操作，从总体上看，此功能不会增加任何重大开销。

...

为方便起见，我确实尝试添加一个接受匿名对象而不是字典的方法：

```
public static String Substitute(this String template, object obj)
{
    return Substitute(
        template,
        obj.GetType().GetProperties().ToDictionary(p => p.Name, p => p.GetValue(obj, null))
    );
} 
```

由于某种原因，这不起作用 - 将匿名对象传递`new { name: "value" }`给该扩展方法会给出编译时错误消息，指出最佳匹配是该方法的 IDictionary 版本。不知道如何解决。（任何人？）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-02-03T17:41:05.957

怎么样

```
stringVar = "Hello, {0}. How are you doing?";
arg1 = "John";    // or args[0]
String.Format(stringVar, arg1) 
```

你甚至可以有多个参数，只需增加 {x} 并将另一个参数添加到 Format() 方法。不确定不同，但“字符串”和“字符串”都有这种方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-18T21:26:06.517

编译的正则表达式可能会解决问题，尤其是在要替换许多标记的情况下。如果只有少数几个并且性能是关键，我会简单地通过索引找到令牌并使用字符串函数替换。信不信由你，这将比正则表达式更快。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-29T01:15:14.683

尝试使用字符串模板。它比这更强大，但它完美地完成了这项工作。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-10-31T18:12:35.513

或者如果您将所有替换值都存储在 Dictionary obj 中，请尝试使用 Linq。

例如：

```
Dictionary<string,string> dict = new Dictionary<string,string>();
dict.add("replace1","newVal1");
dict.add("replace2","newVal2");
dict.add("replace3","newVal3");

var newstr = dict.Aggregate(str, (current, value) => current.Replace(value.Key, value.Value)); 
```

**dict**是您的搜索替换对定义的 Dictionary 对象。 **str**是您需要进行一些替换的字符串。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-11-09T16:05:44.853

我会选择 mindplay.dk 解决方案......效果很好。

并且，稍作修改，它支持模板模板，例如“Hi {name}，你喜欢 {0} 吗？”，替换 {name} 但保留 {0}：

在给定的源（[https://gist.github.com/896724](https://gist.github.com/896724)）中，替换如下：

```
 var format = Pattern.Replace(
            template,
            match =>
                {
                    var name = match.Groups[1].Captures[0].Value;

                    if (!int.TryParse(name, out parsedInt))
                    {
                        if (!map.ContainsKey(name))
                        {
                            map[name] = map.Count;
                            list.Add(dictionary.ContainsKey(name) ? dictionary[name] : null);
                        }

                        return "{" + map[name] + match.Groups[2].Captures[0].Value + "}";
                    }
                    else return "{{" + name + "}}";
                }
            ); 
```

此外，它支持长度 ({name,30}) 以及格式说明符，或两者的组合。

# soa - 有使用 Websphere Integration Developer (WID) 的经验吗？

> ID：379332
> 
> 赞同：4
> 
> 时间：2008-12-18T21:21:56.323
> 
> 标签：soa, wid

我的公司（一个大型组织）正在开发一个“路线图”，以将他们相当陈旧、复杂的系统联盟发展为 SOA 模型。一些人正在努力使用 Websphere Integration Developer 和 Websphere Process Server 作为开发未来应用程序的事实上的平台......因为他们觉得 IBM 是一个稳定的供应商，这些工具是为企业设计的，他们喝了“业务敏捷性” BPEL kool-aid 等

有人对这个平台有积极或消极的想法吗？GUI 工具是否有助于消除单调/冗余的编码......或者只是模糊事物并使事物更难维护？基本上，这些好处是否证明了复杂性？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-06T15:53:06.303

我对 IBM Java 工具集的体验是纯粹的痛苦。几天来安装许多不同版本的不同组件都彼此不兼容，发现组件 A 中的错误被告知更新以查看它是否修复，更新组件 A 会破坏组件 B 和 C，被告知更新这些等等。

我发现没有 IBM 扩展的 Eclipse 更加稳定和快速，并且提供了更多功能（因为它的稳定版本是 WID/RAD 之前的几个版本）。

我建议不要采用 IBM 方式开发工具。至于进程服务器，我的经验较少，但我团队中使用它的人似乎喜欢它，就像我喜欢 WID 一样。不是很多。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-04T14:43:07.460

到目前为止，我还没有对任何带有“SOA”和/或“BPM”标签的工具印象深刻。我的“路线图”将是非常非常迭代的，以尽可能快地看到架构的一些结果，同时试图抓住一些简单的成果。这样，您就可以了解对您和您的员工有用的方法。

我永远不会让任何供应商在架构的“雕刻”中将我推向任何地方。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-12-23T15:38:21.363

我同意其他用户抱怨 WID。我们使用 WID 的唯一原因是不久前我们的销售部门决定全面使用 IBM 产品。

没错，我们的**销售**部门决定使用 IBM 产品。

发展是痛苦和令人沮丧的。Process Server 存在很多稳定性问题，有时它不想正常启动或关闭。是的，您可以轻松地在 IDE 中绘制流程，但如今大多数工具集都提供了该功能。对于 WID 或 IBM 来说，它并没有什么特别或独特的地方。IBM 落后于主流几次迭代。

有很多开源实现可以提供很好的支持。结帐 JBoss 或 RedHat，它们非常好。如果这不能让你的船浮起来，你总是可以使用 Apache 工具。

沃尔特

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-01-15T16:11:16.113

开发人员不会选择 WID、WMB 或 WPS。经理们这样做，因为 IBM 是一个“稳定的供应商”。

看看 JBoss，或 KISS

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-05T15:21:04.387

WID/WPS is actually pretty simple. The original intention was for analysts and business people to "compose" services (DO NOT LET THEM DO THIS!) so the UI is simple and easy.

Most of the work will be in defineing and implementing the back end services which depending on the platform will mostly involve wrapping existing code in SOA service.

The most important thing to bear in mind is that SOAP is technoligy and SOA is an architecture and a state of mind.

There is a zen to a succesful SOA implementation. Its all about "business services", if you have a service that you cannot describe to a business user in less than six words you have done it wrong! Ideally the service name alone should be enough to describe the functionality of the service.

If you end up with a service called "MyApp.GetContactData" described as "get name, addresses tel fax etc." then you are there. If You have a service called MyAppGetFaxNoFromOldSys" described as "Retrieve current-fax-nmbr from telephony table in legacy system" you are doomed!

Incidently most of the Websphere tooling for WS* is pretty nice. But I would recommend the very wonderful SAOPUI tool from [http://www.eviware.com](http://www.eviware.com) which is very good for compsing/reading WSDL based messages and also function as a useful test client or server.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-12-29T02:38:43.127

> GUI 工具是否有助于消除单调/冗余的编码......或者只是模糊事物并使事物更难维护？基本上，这些好处是否证明了复杂性？

作为一名开发人员，我发现这些工具在不同程度上没有错误。6.0.1 很痛苦，6.2 好多了。但是，一旦您使用该工具进行开发，维护它的工作量就会很小。我在几个小时内开发了 Java 开发人员需要数天才能完成的工作。它也很容易维护，因为可以非常快速地进行更改。我无法从建筑师或经理的角度回答您的问题，但我同意这里其他一些人的评论。

# python - 如何将 StringTemplate 引擎集成到 CherryPy Web 服务器中

> ID：379338
> 
> 赞同：2
> 
> 时间：2008-12-18T21:23:50.017
> 
> 标签：python, cherrypy, stringtemplate

我喜欢 StringTemplate 引擎，也喜欢 CherryPy Web 服务器，而且我知道它们可以集成。

谁做过？如何？

编辑：TurboGears 框架采用 CherryPy Web 服务器并捆绑其他相关组件，例如模板引擎、数据访问工具、JavaScript 工具包等。我对 MochiKit 感兴趣，需要 CherryPy，但我不想要任何其他模板引擎StringTemplate（架构很关键——我不想要另一个损坏/坏的模板引擎）。

因此，通过解决如何将 StringTemplate 与 TurboGears 集成来回答这个问题是可以接受的。

通过解决如何在 Google App Engine 中使用 CherryPy 和 StringTemplate 来回答这个问题也是可以接受的。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-22T01:09:42.533

基于两者的教程，它看起来非常简单：

```
导入字符串模板
进口樱桃

类 HelloWorld（对象）：
    定义索引（自我）：
        你好 = stringtemplate.StringTemplate("你好，$name$")
        你好[“名称”] =“世界”
        返回str（你好）
    index.exposed = 真

cherrypy.quickstart(HelloWorld())

```

您可能希望 CherryPy 函数在磁盘上的某个位置找到 StringTemplate，但总体思路是这样的。

Django 在概念上是相似的：url 映射到 python 函数，python 函数通常构建一个上下文字典，使用该上下文对象呈现一个模板，并返回结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-20T20:49:25.947

抢，

人们选择工具是有原因的。StringTemplate 在 Python 中并不是很流行，有一些模板引擎得到了更好的支持并且拥有更广泛的受众。如果不喜欢 Kid，还有 Django 的模板、Jinja、Cheetah 等。也许您可以在其中一个中找到您在 StringTemplate 中非常喜欢的功能，并从此过上幸福的生活。

# php - 如何正确使用 HTML Purifier？

> ID：379339
> 
> 赞同：4
> 
> 时间：2008-12-18T21:23:53.137
> 
> 标签：php, utf-8, character-encoding, htmlpurifier

我在我的 PHP 项目中使用[HTML Purifier ，但无法让它与用户输入一起正常工作。](http://htmlpurifier.org)

我让用户使用 WYSIWYG 编辑器（[TinyMCE](http://tinymce.moxiecode.com/)）输入 HTML，但每当用户输入 HTML 实体`&nbsp;`（不间断空格）时，它都会作为这个奇怪的外来字符（`Â`）保存到数据库中。

但是，问题是，当我使用 WYSIWYG 编辑器编辑保存的条目时，它会正确显示为`&nbsp;`. 它在显示时也能正常工作，只是在源代码中它显示为一个真实的空格，而不是不间断的空格字符。

此外，在 MySQL 数据库中，它显示为奇怪的外来字符。

我阅读了有关[Unicode 和 HTML Purifier](http://htmlpurifier.org/docs/enduser-utf8.html)的文档，并将我的数据库和网页编码更改为 UTF-8，但我仍然遇到不破坏空格字符的问题。其他 HTML 实体，例如`&lt;`and `&gt;`，被保存为`<`and `>`，但为什么不`&nbsp;`呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-18T22:13:33.223

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-19T12:42:41.607

如果您输出任何人类可读的 XML，它还可以帮助您知道这`&#160;`是您可能需要的替代方案；）`&nbsp;`

# php - PHP 清理粘贴的 Microsoft 输入

> ID：379342
> 
> 赞同：9
> 
> 时间：2008-12-18T21:25:37.377
> 
> 标签：php, ms-word, tinymce, user-input

我有一个网站，用户可以使用 TinyMCE 的自定义实现发布内容（如在论坛、评论等中）。他们中的很多人喜欢从 Word 中复制和粘贴，这意味着他们的输入通常带有大量相关的 MS 内联格式。

我不能只是摆脱`<span whatever>`TinyMCE 依赖 span 标签进行某些格式设置，而且我不能（也不想）强迫用户使用 TinyMCE 的“从 Word 粘贴”功能（这不无论如何，t似乎工作得很好）。

有人知道可以为我处理这个问题的库/类/函数吗？这一定是一个普遍的问题，虽然我找不到任何确定的东西。我最近一直在想，寻找 MS 特定模式的一系列蛮力正则表达式可能会起到作用，但我不想重写可能已经可用的东西，除非我必须这样做。

此外，修正弯引号、破折号等会很好。我现在有自己的东西要做，但我真的只想找到一个 MS 转换过滤器来统治它们。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-18T21:39:26.990

[HTML Purifier](http://htmlpurifier.org/)将创建符合标准的标记并过滤掉许多可能的攻击（例如 XSS）。

对于不需要 XSS 过滤的更快清理，我使用 PECL 扩展[Tidy](http://www.php.net/tidy)，它是[Tidy HTML](http://www.w3.org/People/Raggett/tidy/)实用程序的绑定。

[如果这些对您没有帮助，我建议您切换到内置](http://docs.fckeditor.net/FCKeditor_2.x/Users_Guide/Common_Tasks/Cut%2C_Copy_and_Paste)此功能的 FCKEditor 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-07-05T19:51:13.740

就我而言，这工作得很好：

```
$text = strip_tags($text, '<p><a><em><span>'); 
```

与其尝试提​​取您不想要的东西，例如嵌入的词 xml，不如指定您被允许的标签。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-12T10:25:59.757

网站[http://word2cleanhtml.com/](http://word2cleanhtml.com/)在从 Word 转换方面做得很好。我通过报废在 PHP 中使用它来处理一些遗留的 HTML，直到现在它工作得很好（结果是非常干净的`<p>, <b>`代码）。当然，作为外部服务，像您的案例一样在在线处理中使用它并不好。

如果您尝试它并带来许多 400 错误，请先尝试使用[Tidy](http://php.net/manual/en/tidy.repairstring.php "整齐的")过滤 HTML 。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-17T19:14:55.417

就我而言，有一个模式。不需要的部分总是以

```
<!-- [if gte mso 9]> 
```

并以

```
<![endif]--> 
```

所以我的解决方案是在此块之前和之后删除所有内容：

```
$array = explode("<!-", $string, 2);
$begin = $array[0];
$end=substr(strrchr($string,'[endif]-->'),10);
echo $begin.$end; 
```

# .net - 隐式运算符和 TypeConverters 是否等效？

> ID：379343
> 
> 赞同：11
> 
> 时间：2008-12-18T21:25:50.543
> 
> 标签：.net, operator-overloading, implicit, typeconverter

在我看来，实现隐式运算符与 TypeConverter 相比非常容易，因此我假设它们不等效，因为 TypeConverters 在框架中很流行（请参阅任何扩展 FrameworkElement 的内容）。

但为什么？创建 string->object 和 object->string 隐式运算符并利用序列化中的那些（XML 和 XAML）不是更容易吗？

是雅格尼吗？单一责任？因为您不能在接口中指定运算符重载？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-18T22:32:33.980

类型转换器比看起来要复杂得多。*类型转换器可以访问有关转换上下文*的一系列元数据- 例如，所涉及的属性和对象。这用于为每个场景提供自定义选项（想想：链接的下拉列表，即国家/县/城市/等）。您还可以基于每个属性指定类型转换器，我在很多地方使用它来提供对各种字符串属性的不同处理。操作员会一视同仁地对待所有字符串。

隐式运算符只知道正在转换的*值*，但具有更大的编译时支持。

或者另一种方式： `TypeConverter`是框架支持的框架特性；运算符（主要）是具有语言支持的语言功能

要添加更多 - 类型转换器（尽管名称）不只是转换：

*   他们提供子属性元数据（想想：扩展属性`PropertyGrid`）
*   他们建议一种类型的可用选项（想想：下拉选项`PropertyGrid`）

请注意，它们不仅仅用于`PropertyGrid`;-p

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-18T21:46:34.573

我不是这方面的专家。

但乍一看，它看起来像 - 您可以在原始类之外提供转换器（相对于隐式运算符）&也许您可以为同一事物定义多个 TypeConverter 类（如果您想为相同的值获得不同的视图）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-18T21:30:48.257

隐式运算符很好，但它们也可能令人困惑。我认为，当您需要从一种类型转换为另一种类型时，最好是明确的，因为毫无疑问会发生什么。

此外，隐式运算符似乎是为非常相似的事物保留的，并且隐式转换是直观的。但我想这都是主观的，用你最好的判断。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-18T22:10:00.033

只是好奇：TypeConverters 可以与 Visual Studio 设计器一起使用，因此，如果您为 Lists 或 Arrays 等属性提供正确的 TypeConverter，则可以通过设计器设置它们。隐式运算符是否也提供此服务？如果不是，我怀疑这回答了您的问题：它们在框架中使用，以便使用这些项目的控件可以与设计器一起使用。

# python - python docstring中的@ivar @param和@type这些标签是什么？

> ID：379346
> 
> 赞同：16
> 
> 时间：2008-12-18T21:26:39.417
> 
> 标签：python, documentation, javadoc

安瓿项目在 docstring 中使用了一些标签，例如 javadoc 的标签。

例如从[pool.py](http://bazaar.launchpad.net/~dialtone/ampoule/main/annotate/26?file_id=pool.py-20080501191749-jqawtxogk4i0quu3-12)第 86 行：

```
def start(self, ampChild=None):
    """
    Starts the ProcessPool with a given child protocol.

    @param ampChild: a L{ampoule.child.AMPChild} subclass.
    @type ampChild: L{ampoule.child.AMPChild} subclass
    """ 
```

这些标签是什么，哪个工具使用它。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-19T11:34:22.343

只是为了好玩，我会注意到 Python 标准库正在使用 Sphinx/reStructuredText，其[信息字段列表](http://sphinx-doc.org/domains.html)是相似的。

```
def start(self, ampChild=None):
    """Starts the ProcessPool with a given child protocol.

    :param ampChild: a :class:`ampoule.child.AMPChild` subclass.
    :type ampChild: :class:`ampoule.child.AMPChild` subclass
    """ 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-12-18T21:45:41.453

文档工具的标记，可能是[epydoc](http://epydoc.sourceforge.net/)。

# google-app-engine - 如何在 Google App Engine 中运行 CherryPy 网络服务器

> ID：379352
> 
> 赞同：6
> 
> 时间：2008-12-18T21:28:20.087
> 
> 标签：google-app-engine, cherrypy

CherryPy Web 服务器应该可以部署在 Google App Engine 中。

谁做过，体验如何？

需要什么特别的努力（配置等）？

你会推荐给其他人吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-08-11T18:48:02.527

这篇[文章](http://web.archive.org/web/20120722170650/http://boodebr.org/main/python/cherrypy-under-google-appserver)是一个很好的例子，但它现在有点过时了，因为[不再需要补丁](https://bitbucket.org/cherrypy/cherrypy/issue/803/patch-for-running-under-google-app-engine)，最新版本的 Cherrypy 应该在没有它的情况下运行，我已经在开发环境中运行了下面的示例。我已将cherrypy 包含在一个zip 文件中，因为谷歌应用引擎每个应用程序限制为一千个文件，这也使其更易于部署。

我还使用cherrypy 调度处理程序来路由请求。

```
 import sys
    sys.path.insert(0, 'cherrypy.zip')
    import cherrypy
    import wsgiref.handlers 

    class Root:
        exposed = True
        def GET(self):
            return "give a basic description of the service"

    d = cherrypy.dispatch.MethodDispatcher()
    conf = {'/': 
            {
             'request.dispatch': d
            }
           }

    app = cherrypy.tree.mount(Root(), "/",conf)
    wsgiref.handlers.CGIHandler().run(app) 
```

到目前为止，我还没有遇到任何特定的问题，但我读到有些人在会话方面遇到了问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-08-15T04:45:13.160

看~~boodebr.org 文章~~（不见了，但[在 Wayback 机器上](http://web.archive.org/web/20120722170650/http://boodebr.org/main/python/cherrypy-under-google-appserver)）它对我有用。

如果您正在寻找示例，请在[此示例](https://code.google.com/p/yotsuba/source/browse/yotsuba/lib/tori.py)中的 ServerInterface.auto 中查找接受 ServerMode.GAE 的条件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T22:42:01.487

有一篇关于如何做到这一点的好文章~~[这边](http://boodebr.org/main/python/cherrypy-under-google-appserver)~~ [现在在这里](http://web.archive.org/web/20120722170650/http://boodebr.org/main/python/cherrypy-under-google-appserver)。我还没有真正尝试过，我在 App Engine 上坚持使用 django，但这似乎是一个可靠的例子。

# c - 什么是轻量级跨平台WAV播放库？

> ID：379353
> 
> 赞同：14
> 
> 时间：2008-12-18T21:28:27.120
> 
> 标签：c, windows, linux, audio, cross-platform

我正在寻找一种轻量级的方法来使我的程序（用 C 编写）能够在 windows 或 linux 上播放音频文件。我目前正在使用 Windows 本机调用，它本质上只是一个传递文件名的调用。我想要在 linux 上工作的类似的东西。

音频文件为 Microsoft PCM，单声道，22Khz

有什么建议么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-28T16:45:56.727

由于我也在寻找问题的答案，所以我做了一些研究，但我还没有找到任何简单的（像调用一个函数一样简单）播放音频文件的方法。但是通过一些代码行，甚至可以以可移植的方式使用已经提到的 portaudio 和 libsndfile (LGPL)。

这是我为测试两个库而编写的一个小测试用例：

```
 #include <portaudio.h>
#include <sndfile.h>

static int
output_cb(const void * input, void * output, unsigned long frames_per_buffer,
        const PaStreamCallbackTimeInfo *time_info,
        PaStreamCallbackFlags flags, void * data)
{
    SNDFILE * file = data;

    /* this should not actually be done inside of the stream callback
     * but in an own working thread 
     *
     * Note although I haven't tested it for stereo I think you have
     * to multiply frames_per_buffer with the channel count i.e. 2 for
     * stereo */
    sf_read_short(file, output, frames_per_buffer);
    return paContinue;
}

static void
end_cb(void * data)
{
    printf("end!\n");
}

#define error_check(err) \
    do {\
        if (err) { \
            fprintf(stderr, "line %d ", __LINE__); \
            fprintf(stderr, "error number: %d\n", err); \
            fprintf(stderr, "\n\t%s\n\n", Pa_GetErrorText(err)); \
            return err; \
        } \
    } while (0)

int
main(int argc, char ** argv)
{
    PaStreamParameters out_param;
    PaStream * stream;
    PaError err;
    SNDFILE * file;
    SF_INFO sfinfo;

    if (argc < 2)
    {
        fprintf(stderr, "Usage %s \n", argv[0]);
        return 1;
    }

    file = sf_open(argv[1], SFM_READ, &sfinfo);
    printf("%d frames %d samplerate %d channels\n", (int)sfinfo.frames,
            sfinfo.samplerate, sfinfo.channels);

    /* init portaudio */
    err = Pa_Initialize();
    error_check(err);

    /* we are using the default device */
    out_param.device = Pa_GetDefaultOutputDevice();
    if (out_param.device == paNoDevice)
    {
        fprintf(stderr, "Haven't found an audio device!\n");
        return -1;
    }

    /* stero or mono */
    out_param.channelCount = sfinfo.channels;
    out_param.sampleFormat = paInt16;
    out_param.suggestedLatency = Pa_GetDeviceInfo(out_param.device)->defaultLowOutputLatency;
    out_param.hostApiSpecificStreamInfo = NULL;

    err = Pa_OpenStream(&stream, NULL, &out_param, sfinfo.samplerate,
            paFramesPerBufferUnspecified, paClipOff,
            output_cb, file);
    error_check(err);

    err = Pa_SetStreamFinishedCallback(stream, &end_cb);
    error_check(err);

    err = Pa_StartStream(stream);
    error_check(err);

    printf("Play for 5 seconds.\n");
    Pa_Sleep(5000);

    err = Pa_StopStream(stream);
    error_check(err);

    err = Pa_CloseStream(stream);
    error_check(err);

    sf_close(file);

    Pa_Terminate();

    return 0;
} 
```

示例的一些注释。在流回调内部进行数据加载不是一个好习惯，而是在自己的加载线程中进行。如果您需要播放多个音频文件，则变得更加困难，因为并非所有 portaudio 后端都支持一台设备的多个流，例如 OSS 后端不支持，但 ALSA 后端支持。我不知道windows上的情况如何。由于您所有的输入文件都是相同类型的，您可以自己混合它们，这会使代码更加复杂，但您也可以支持 OSS。如果您也有不同的采样率或通道数，那将变得非常困难。

因此，如果您不想同时播放多个文件，这可能是一个解决方案，或者至少是您的一个开始。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-19T00:52:06.320

[SDL_Mixer](http://gpwiki.org/index.php/SDL_mixer:Tutorials:Playing_a_WAV_Sound_File)虽然不是很轻量级，但确实有一个简单的界面来播放 WAV 文件。我相信，像[SDL](http://www.libsdl.org/)一样， SDL_Mixer 也是 LGPL。

[OpenAL](http://connect.creativelabs.com/openal/default.aspx)是另一个更适合 3D 音频的跨平台音频库。

您可能想要查看的另一个开源音频库是[PortAudio](http://www.portaudio.com/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-21T09:52:54.197

我使用 OpenAL 在空中交通管制系统中播放 wav 文件作为警报/警告

我发现的优点是

1.  它是跨平台的
2.  与 C 一起工作（和其他人，但你的问题是关于 C 的）
3.  轻的
4.  良好的文档可在网络上获得
5.  许可证是 LGPL，因此您调用 API 时没有许可证问题

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-18T21:39:51.200

你可以试试这个：[libao](http://xiph.org/ao/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-22T19:47:44.493

我喜欢[FMOD](http://www.fmod.org/)。该[许可证](http://www.fmod.org/index.php/sales)免费供个人使用，对于小型共享软件或商业项目非常合理

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-02-23T15:02:24.120

你也可以试试[Audiere](http://audiere.sourceforge.net/)。最后一个版本是 2006 年发布的，但它是开源的，并且在 LGPL 下获得许可。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-22T19:30:23.820

我用了 irrKlang ！

“irrKlang 是 C++、C# 和所有 .NET 语言的跨平台声音库”

[http://www.ambiera.com/irrklang/](http://www.ambiera.com/irrklang/)

# java - Java GUI重绘错误？

> ID：379354
> 
> 赞同：3
> 
> 时间：2008-12-18T21:28:38.540
> 
> 标签：java, user-interface, jframe, repaint

这是一个艰难的 - 我有一个生成 JTextFields 的 JFrame。当我从生成 2 个 JTextField 到 12 个 JTextfield（例如）时，我看到了一些错误，其中最后有一个不同大小的 JTextField。这似乎是一个重绘错误。

**Main.java 代码：**

```
import java.awt.*;
import javax.swing.*;

public class Main {
    public static Display display = new Display();

    public static void main(String[] args) {
        display.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        display.setVisible(true);
    }
} 
```

**显示.java代码：**

```
import java.awt.*;
import java.awt.event.*;

import javax.swing.*;

public class Display extends JFrame {
    final int FRAME_WIDTH = 820;
    final int FRAME_HEIGHT = 700;
    final int X_OFFSET = 40;
    final int Y_OFFSET = 40;

    final int GRAPH_OFFSETX = 35;
    final int GRAPH_OFFSETY = 60;
    final int GRAPH_WIDTH = 500;
    final int GRAPH_HEIGHT = 500;
    final int GRAPH_INTERVAL = 20;

    JButton submit;
    JTextField top;
    JTextField bottom;
    JTextField numPoint;
    JPanel bpanel;
    JPanel points;

    int maxPoints;

    public Display() {
        init();
    }

    public void init() {
        setBackground(Color.WHITE);
        setLocation(X_OFFSET, Y_OFFSET);
        setSize(FRAME_WIDTH, FRAME_HEIGHT);
        setTitle("Geometric Transformations");
        getContentPane().setLayout(null);
        setDefaultLookAndFeelDecorated(true);

        top = new JTextField();    // parameter is size of input characters
        top.setText("1 2 3");
        top.setBounds(590, 150, 120, 25);

        bottom = new JTextField();    // parameter is size of input characters
        bottom.setText("5 6 7");
        bottom.setBounds(590, 200, 120, 25);

        numPoint = new JTextField();
        numPoint.setText("Number of Points?");
        numPoint.setBounds(550,200,200,25);
        this.add(numPoint);

        SubmitButton submit = new SubmitButton("Submit");
        submit.setBounds(570, 250, 170, 25);

        bpanel = new JPanel(new GridLayout(2,3));
        bpanel.add(top);
        bpanel.add(bottom);
        bpanel.add(submit);

        points = new JPanel(new GridLayout(2,2));
        points.setBounds(540,250,265,60);
        this.add(points);

        bpanel.setBounds(550,100,200,70);
        this.add(bpanel, BorderLayout.LINE_START);

        Component[] a = points.getComponents();
        System.out.println(a.length);
        repaint();
    }

    public void paint(Graphics g) {
        super.paint(g);
        g.setColor(Color.WHITE);
        g.fillRect(100, 100, 20, 30);
        g.setColor(Color.BLACK);
        genGraph(g, GRAPH_OFFSETX, GRAPH_OFFSETY, GRAPH_WIDTH, GRAPH_HEIGHT, GRAPH_INTERVAL);
    }

    public void genGraph (Graphics g, int x, int y, int width, int height, int interval) {
        // draw background
        int border = 5;
        g.setColor(Color.BLACK);
        width = width - (width % interval);
        height = height - (height % interval);
        for (int col=x; col <= x+width; col+=interval) {
            g.drawLine(col, y, col, y+height);
        }
        for (int row=y; row <= y+height; row+=interval) {
            g.drawLine(x, row, x+width, row);
        }
    }
    class SubmitButton extends JButton implements ActionListener {

        public SubmitButton(String title){
            super(title);
            addActionListener(this);
            this.setVisible(true);
        }
        public void actionPerformed(ActionEvent e) {
            maxPoints = Integer.parseInt(numPoint.getText()) * 2;

            points.removeAll();

            for (int i=0; i<maxPoints; i++) {
                JTextField textField = new JTextField();
                points.add(textField);
            }
            points.validate();        // necessary when adding components to a JPanel
            // http://stackoverflow.com/questions/369823/java-gui-repaint-problem-solved
            // What to Check:
            // Things between commas are either spaces (which will be stripped later)
            // or numbers!

            // Pairs must match up!
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-18T22:00:30.927

新组件在以前的组件上重新绘制。我添加了`points.repaint();`之后`points.validate();`，问题就消失了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-18T22:22:48.057

注意：我也对重新绘制网格的问题感到恼火（将窗口放在前面然后放在后面，你会看到）。
从快速搜索来看，最好避免直接在 JFrame 上进行绘制，而是将其委托给子组件。如果我错了，有人告诉我。这是我的解决方案（不完美，我留给你改进它的任务...... :-P

```
import java.awt.*;
import java.awt.event.*;

import javax.swing.*;

public class SODisplay extends JFrame {
    final int FRAME_WIDTH = 820;
    final int FRAME_HEIGHT = 700;
    final int X_OFFSET = 40;
    final int Y_OFFSET = 40;

    JButton submit;
    JTextField top;
    JTextField bottom;
    JTextField numPoint;
    JPanel bpanel;
    JPanel points;
    GridPanel grid;

    int maxPoints;

    public SODisplay() {
        init();
    }

    public void init() {
        setBackground(Color.WHITE);
        setLocation(X_OFFSET, Y_OFFSET);
        setSize(FRAME_WIDTH, FRAME_HEIGHT);
        setTitle("Geometric Transformations");
        getContentPane().setLayout(null);
        setDefaultLookAndFeelDecorated(true);

        grid = new GridPanel();
        grid.setBounds(0,0,530,FRAME_HEIGHT);
        this.add(grid);

        top = new JTextField();    // parameter is size of input characters
        top.setText("1 2 3");
        top.setBounds(590, 150, 120, 25);

        bottom = new JTextField();    // parameter is size of input characters
        bottom.setText("5 6 7");
        bottom.setBounds(590, 200, 120, 25);

        numPoint = new JTextField();
        numPoint.setText("Number of Points?");
        numPoint.setBounds(550,200,200,25);
        this.add(numPoint);

        SubmitButton submit = new SubmitButton("Submit");
        submit.setBounds(570, 250, 170, 25);

        bpanel = new JPanel(new GridLayout(2,3));
        bpanel.add(top);
        bpanel.add(bottom);
        bpanel.add(submit);

        points = new JPanel(new GridLayout(2,2));
        points.setBounds(540,250,265,60);
        this.add(points);

        bpanel.setBounds(550,100,200,70);
        this.add(bpanel, BorderLayout.LINE_START);

        Component[] a = points.getComponents();
        System.out.println(a.length);
        repaint();
    }

    class SubmitButton extends JButton implements ActionListener {

        public SubmitButton(String title){
            super(title);
            addActionListener(this);
            this.setVisible(true);
        }
        public void actionPerformed(ActionEvent e) {
            maxPoints = Integer.parseInt(numPoint.getText()) * 2;

            points.removeAll();

            for (int i=0; i<maxPoints; i++) {
                JTextField textField = new JTextField();
                points.add(textField);
            }
            points.validate();        // necessary when adding components to a JPanel
            points.repaint();
            // http://stackoverflow.com/questions/369823/java-gui-repaint-problem-solved
            // What to Check:
            // Things between commas are either spaces (which will be stripped later)
            // or numbers!

            // Pairs must match up!
        }
    }

    public static void main(String[] args) {
        // Schedule a job for the event-dispatching thread:
        // creating and showing this application's GUI.
        SwingUtilities.invokeLater(new Runnable()
        {
            public void run()
            {
                SODisplay display = new SODisplay();
                display.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                display.setVisible(true);
            }
        });
    }

    class GridPanel extends JPanel {
        // Or drop the offset and adjust the placement of the component
        final int GRAPH_OFFSETX = 35;
        final int GRAPH_OFFSETY = 60;
        final int GRAPH_WIDTH = 500;
        final int GRAPH_HEIGHT = 500;
        final int GRAPH_INTERVAL = 20;

        public GridPanel() {
        }

        public void paint(Graphics g) {
            super.paint(g);
            g.setColor(Color.WHITE);
            g.fillRect(100, 100, 20, 30);
            g.setColor(Color.BLACK);
            genGraph(g, GRAPH_OFFSETX, GRAPH_OFFSETY, GRAPH_WIDTH, GRAPH_HEIGHT, GRAPH_INTERVAL);
        }

        public void genGraph (Graphics g, int x, int y, int width, int height, int interval) {
            // draw background
            int border = 5;
            g.setColor(Color.BLACK);
            width = width - (width % interval);
            height = height - (height % interval);
            for (int col=x; col <= x+width; col+=interval) {
                g.drawLine(col, y, col, y+height);
            }
            for (int row=y; row <= y+height; row+=interval) {
                g.drawLine(x, row, x+width, row);
            }
        }
    }
} 
```

为简单起见，这只是我在一个文件中的测试代码，当然，您可能希望以不同的方式剖析它。

# c# - 创建控件时出错 - 自定义控件

> ID：379355
> 
> 赞同：3
> 
> 时间：2008-12-18T21:29:24.343
> 
> 标签：c#, composite-controls

我有一个自定义控件，它工作正常……除了控件不能在设计时呈现。（我正在使用 VS 2008）

我想很多开发自定义控件的人都会遇到这个问题......我得到的错误是“创建控件时出错 - CustomControlName”对象引用未设置为对象的实例。

我想要一个解决方法。或者至少调试这个......（因为这是一个设计时问题如何调试？）

我已经在 OnInit、OnPreRender、RenderContents、CreateChildControls 方法上尝试了 if(!DesignMode) 代码（我只是在黑暗中拍摄）......

请帮忙。我真的希望这不是 VS 错误！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-19T05:48:28.157

BFree 的评论是最有可能出现的问题，对于要在设计视图中显示的控件，它需要一个无参数的构造函数，因为设计查看器不知道您通常如何实例化控件。

如果你确实有一个无参数的构造函数，你能粘贴一些代码来显示发生了什么吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-24T00:46:31.223

在您的`OnPreRender`&`CreateChildControls`方法中，它正在调用 this.Page。您可能想尝试将它们包装在

```
if (this.Page != null)
{
.....
} 
```

因为我认为那时您不会有 Page 对象，而且我*很*确定`PreRender`，`CreateChildControls`并且会在设计视图中被调用。不过，我已经有一段时间没有编写自定义服务器控件了，所以我可能是错的（最近一直在 MVC 中工作）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-19T06:28:10.887

正如 Glenn 所说，第一个问题可能是没有无参数的构造函数。

第二个可能是您在 OnLoad 期间调用方法或您提到的其他方法，这些方法具有未初始化的参数或通常在运行时完成的某种数据库调用尝试等。

除非他们最近修复了这个错误*并且我不知道，否则要记住的是 DesignMode 属性适用于嵌套控件的第一级和第二级，但除此之外它通常不能正常工作。（例如包含包含另一个 UserControl[2] 的 UserControl[1] 的表单，DesignMode 对表单和 [1] 起作用，但对 [2] 不起作用）。

也同意 Glenn 的观点，查看一些代码会有所帮助。

*根据我最近使用嵌套用户控件的经验，它尚未修复。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-30T12:46:34.040

格伦，你得到了一个 VS 错误并且尚未发布任何修复程序的错误。

# javascript - VS 2008 JavaScript 智能感知问题

> ID：379357
> 
> 赞同：0
> 
> 时间：2008-12-18T21:29:49.833
> 
> 标签：javascript, visual-studio-2008, class, intellisense

我制作了一个 JavaScript 类并将其放入自己的 .js 文件中。当我从网页引用文件并创建该类的实例时，没有智能感知告诉我可用的方法\变量，它只是将构造函数显示为唯一的方法。但是当我复制课程并将其直接传递到网页时，智能感知工作得很好。

有谁知道问题可能是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-18T22:26:03.870

您需要在 javascript 文件的顶部添加参考：

> `/// <reference path="yourJSfile.js" />`

然后你必须刷新智能感知：菜单编辑 -> 智能感知 -> 更新 jscript 智能感知

# specifications - 什么是好的规格？

> ID：379371
> 
> 赞同：38
> 
> 时间：2008-12-18T21:34:28.513
> 
> 标签：specifications

[Joel 测试](http://www.joelonsoftware.com/articles/fog0000000043.html)中的一项是项目/公司应该有一个规范。

我想知道是什么让规范变得更好。一些公司会编写大量没有人阅读的无用规范，而另一些公司则不会写下任何内容，因为“无论如何也没有人会阅读任何内容”。那么，您在规范中添加了什么？这两个极端之间的良好平衡是什么？有什么特别重要的东西，真的，真的（！）应该总是记录在规范中吗？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2008-12-18T22:47:09.567

最好的规格是：

1.  存在
2.  描述什么，而不是如何（没有解决方案）
3.  可以用尽可能少的方式解释
4.  分布广泛
5.  被所有相关方同意为规范
6.  简洁
7.  是一致的
8.  随着需求的变化定期更新
9.  尽可能多且实用地描述问题
10.  可测试

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-12-18T22:19:43.977

**在规范中添加什么**

您需要查看规范的受众并找出他们需要知道的内容。它只是您和商业赞助商之间的文件吗？在这种情况下，它可能相当轻量级。如果它是一个 100 多人年 J2EE 项目的功能规范，它可能需要更多细节。

**观众**

关键问题是：谁将阅读规范 - 规范将有几组潜在的利益相关者：

*   签署系统的企业主。

*   构建系统的开发人员（可能是也可能不是你）

*   必须为其编写测试计划的 QA 人员。

*   想要了解系统的维护人员

*   可能希望将其他系统集成到其中的其他项目的开发人员或分析师。

**典型关键利益相关者的要求：**

*   **企业主**需要清楚地了解系统工作流程和业务规则是什么，这样他们才能有机会了解他们同意的内容。如果他们是规范的唯一主要受众，请专注于用户界面、屏幕屏幕工作流程以及业务和数据验证规则。

*   **开发人员**需要数据模型、数据验证规则、部分或全部用户界面设计以及对预期系统行为的足够描述，以便他们知道要构建什么。如果您正在为开发人员写作，则专注于用户界面，映射到用户界面中的数据模型和规则。这应该比您自己进行开发更详细，因为您在两个第三方之间的通信中充当中介。

    如果您要指定两个系统之间的接口，则必须非常精确。

*   **QA 人员**需要足够的信息来确定如何测试和验证应用程序的逻辑、验证和预期的用户界面行为。面向开发人员和 QA 人员的规范需要相当明确。

*   **维护人员**需要与开发人员大致相同的信息以及描述架构的系统路线图文档。

*   **集成商**需要数据模型和任何接口的清晰定义。

**规范的关键组成部分：**

我假设一个人正在为商业应用程序编写规范，所以下面的内容就是针对这个的。其他类型系统的规格将有不同的重点。根据我的经验，功能规范的关键要素是：

*   **用户界面：**屏幕模型以及对系统交互行为和屏幕之间工作流程的描述。

*   **数据模型：**定义数据项并映射到用户界面。用户界面映射通常在描述用户界面的规范中完成。

*   **数据验证和业务规则：**需要对数据进行哪些正确性检查、进行哪些计算以及定义。示例在这里非常有用。

*   **接口的定义：**如果您有其他系统可以使用的接口，您需要非常严格地指定这些接口。更简单的互联网 RFC 提供了很好的协议设计示例，并且是接口文档示例的良好开端。明确定义接口并不容易，但几乎可以肯定会让您免于烦恼。

*   **胶水：**这是用例、工作流程图和其他与需求相关的工件提供帮助的地方。通常，详尽列出这些内容是没有意义的，但系统内将有一些关键领域，此类文档有助于将项目置于上下文中。我的经验是，选择性地包含用例和其他需求级别的描述可以大大增加规范的清晰度和意义，但是为与系统的每一次交互编写用户故事是浪费时间。

[Joel](https://stackoverflow.com/users/4/joel-spolsky)（以“软件”着称）为此写了[一系列很好的文章](http://www.joelonsoftware.com/articles/fog0000000036.html)，称为*无痛功能规范*，我曾多次推荐人们参考这些文章。这是一组相当不错的文章，非常值得一读。在我看来，你的目标是清楚地解释系统应该做什么，以最大限度地减少歧义。将规范视为参考文档非常有用 - 各种利益相关者可能希望能够轻松查找。

在编写了一组关于规格的圆滑的要点之后，清晰的沟通部分比看起来更难。规格实际上是不平凡的技术文档，是对一个人的技术写作和编辑技能的考验。您实际上是在编写描述某人应该构建什么的文档。做好规格是一门艺术。

做规范的回报是没有其他人愿意做。当您编写了可能对系统具有任何重要性的唯一文档时，您就可以做主了。其他任何有议程的人都必须游说您更改规范或以某种方式将竞争规范强加给项目。这是笔比剑更强大的一个很好的例子。

**编辑：**根据我的经验，关于“如何”和“什么”之间区别的辩论往往是自私的。在任何不平凡的项目中，数据模型和用户界面都会有多个利益相关者，并非所有人都是系统的开发人员。从事数据仓库工作会让人们体验到当应用程序数据模型被允许免费提供给所有人时所带来的混乱，而[PFS](http://www.joelonsoftware.com/articles/fog0000000036.html)应该让人们感受到规范必须迎合的潜在利益相关者集合。

某人拥有数据模型或用户界面设计这一事实并不意味着这些只是由法定决定 - 可以有一个话语和谈判过程。然而，随着项目变得更大，所有权和一致性的价值会变得更大。我过去的观察是，欣赏优秀分析师价值的最佳方式是看到坏分析师造成的损害。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-12-18T21:42:16.860

以我的经验，如果规范具有以下内容，则更有可能被阅读：

*   尽可能使用图表 - 图片值 1000 字
*   有一个标题页，清楚地表明规范所描述的内容
*   具有在整个文档中使用的样式。使所有标题的字体、大小和样式相同。使字体始终相同，使用相同的项目符号样式等
*   DONT WAFFLE - 简洁明了，不要添加多余的东西来填充您的文档。如果一个点不能用几行文字解释，那么也许你需要进一步分解它

我曾在公司中看到编写规范的人不了解系统。这几乎是通过编写规范来学习系统的一种方式。这通常以眼泪结束......

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-18T22:13:31.290

作为为客户开发定制软件的人，**最好的规格是客户签署的规格**。

不管你的规范有多精致——如果客户没有以书面形式明确同意，他们会改变它，并期望你无缝地进行他们的改变，破坏你美丽的架构......

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-18T23:34:47.710

好的规范应该包含可测量和可验证的要求。在查看每个要求时，您应该能够轻松地回答“我如何证明我已满足此要求？”的问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-18T21:44:24.640

阅读 Joel对 Joel 测试文章的后续系列“[无痛功能规范”。](http://www.joelonsoftware.com/articles/fog0000000036.html)它们也出现在“Joel on Software”一书中。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-18T22:06:44.767

取决于项目有多大以及（像所有架构决策一样）约束是什么。一个好的开始是

*   一个简短的描述，一个“单传呼机”
*   上下文图——边界在哪里，什么与系统交互？
*   用例/用户故事
*   GUI 原型或纸质原型（如果适用）
*   对所需的非功能性要求（性能等）的描述

最重要的是要有一个验收测试，即可以检查的事情的可测试陈述，以及当这些事情完成时，项目完成的协议。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-13T13:33:23.347

如果您首先说明用户的目标或某个功能的全局理念是什么，这也会有所帮助；而不是填写确切的实现。这对我来说总是感觉像是缩小了开放的心态或使用了不太有创意（更有用）的解决方案。所以你应该保持“所有选项都打开”。

**示例** 您正在编写一个测量“X”的软件。

而不是说：必须有一个开始按钮和一个保存按钮。

用途：用户必须能够开始测量并保存它。

**为什么**？因为在第一种情况下，您已经确定了解决方案必须是什么，而第二种情况为您提供了**如何**实现某些东西的灵活性。现在这似乎微不足道，但我感觉“程序员”倾向于更多地考虑解决方案而不是问题（或情况）。当您添加更多功能时，这变得更加明显，因为使用向导或自动化该过程可能会更好，但您已经将想法缩小到使用按钮。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-02-01T21:13:23.410

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-18T21:36:55.263

我认为编写“用例”应该可以为您节省大量页面

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-18T21:49:26.440

+1 @ [KiwiBastard](https://stackoverflow.com/users/1075/kiwibastard)和我会添加类似子弹的写法并使每个子弹都可测试。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-18T23:26:22.280

描述实施所需的所有关键信息的蓝图，但不会浪费任何精力来描述所有必要的琐碎或明显的信息。

它应该只是足够的信息来确保实现“如预期”，而不会提供太多不必要的额外噪音。

在实践中，大多数人都犯了这个错误，因为他们专注于简单的东西（这是最不需要的）而回避困难的东西（这是你真正想要锁定的东西）。我见过太多 2 英寸的文件完全没有抓住重点，而 3 页的文件却很少。

规格不必很长，它们只需要包含正确的东西！

（提示：如果程序员在编码时没有查看该页面，则可能不需要）

保罗。

# java - 您将使用什么来构建 Web 应用程序？

> ID：379375
> 
> 赞同：0
> 
> 时间：2008-12-18T21:36:22.613
> 
> 标签：java

在我目前的工作中，我一直致力于使用 Java、Tapestry、Hibernate、MSSQL 和 Tomcat 制作 Web 应用程序。

我有一个我想写的小网页游戏的想法。我想知道 SO 社区会用什么来做这样的事情。

我应该坚持我所知道的吗？我认为学习不同的语言和框架对我来说是非常有益的。有什么建议么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-18T21:38:22.217

如果它是一个个人项目，那么就以此为契机学习新东西。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-18T21:40:06.567

使用 Spring MVC 3.0 的 Spring 框架

我建议学习一些新东西，因为即使你的想法失败了，至少你从中学到了一些新技术。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-18T21:47:07.287

我可以推荐[Grails](http://grails.org)，因为它是一个现代且易于使用的 RAD Web 框架，学习曲线很小，并且被证明是可扩展的。

它建立在 Spring MVC、Hibernate 和其他复杂框架的基础上，并将它们与[Groovy](http://groovy.codehaus.org)（JVM 的动态语言）的动态特性合并为一个全栈 Web 框架。它遵循 CoC（Convention over Configuration）和 DRY（不要重复自己）等现代原则。您可以在 tomcat 或任何其他 servlet 容器或应用程序服务器中将应用程序直接部署为 .war 文件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-18T21:56:31.463

我的建议是看看结合使用 Google App Engine、Django 和 JavaFX 可以做什么。

在此过程中，您将学习一些新技术（App Engine）和语言（Python for Django、JavaFX），同时利用您对 Web 应用程序和 Java 的了解。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-18T22:12:12.853

我会选择[Haxe](http://haxe.org/)。

> Haxe（发音为 hex）是一种开源编程语言
> 
> 虽然大多数其他语言都绑定到它们自己的平台（Java 绑定到 JVM，C# 绑定到 .Net，ActionScript 绑定到 Flash Player），但 Haxe 是一种多平台语言。
> 
> 这意味着您可以使用 Haxe 来定位以下平台：Javascript、Flash、NekoVM、PHP、C++、C# 和 Java

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-18T21:43:24.907

如果您考虑像 RPG 或纸牌游戏这样的在线游戏，我可能会很自私，建议您看看[Project Darkstar](http://www.projectdarkstar.org)并让我们知道您的进展情况。我一直在尝试开始使用它，但无法让它在我的环境中运行。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-18T22:04:09.763

PHP 和 MySQL 是 Web 应用程序的一个简单起点。您的 ISP 将支持它，并且网络上有大量教程。

一旦你掌握了它的窍门，看看 MVC 架构。这是一种构建 Web 应用程序的方式。

我个人建议看一下 CodeIgniter。

然而游戏是另一回事，也许试试Flash？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-18T22:09:03.403

如果您想提高自己的技能，请推动您已经知道的内容。如果您想学习新的语言和做事方式，请查看替代技术和堆栈。

这一切都取决于你的目标是什么......

# network-protocols - 广播 ARP 响应 - 丢弃它会导致问题吗？

> ID：379377
> 
> 赞同：0
> 
> 时间：2008-12-18T21:37:11.613
> 
> 标签：network-protocols, wireless, arp

在不支持单播 ARP 请求或广播 ARP 响应的网络上，是否存在连接问题的常见机器或操作系统？我正在提供公共 Wi-Fi 服务，并考虑阻止这些类型的 ARP 数据包。这会导致当代客户的连接问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-19T10:19:57.220

ARP 规范最近更新为[RFC 5227](http://tools.ietf.org/rfcmarkup/5227)，其中讨论了使用免费 ARP 数据包进行“地址冲突检测”。

如果您阻止 ARP 响应广播，则无法使用此 ACD。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-19T10:49:48.690

一些高可用性 IP-Takeover 方案使用广播 ARP 在切换时宣布新的 MAC 地址。

# c++ - 避免继承疯狂

> ID：379380
> 
> 赞同：3
> 
> 时间：2008-12-18T21:37:34.763
> 
> 标签：c++, design-patterns

所以，我有一个 API 需要在现有框架中实现。此 API 管理与外部服务器的交互。我负责想出一种方法来创建一个易于重复的“模式”，这样如果人们在给定框架中从事新项目，他们就有一个简单的解决方案来集成 API。

我的第一个想法是为框架的“主”类创建一个类来扩展它，提供与 API 交互所需的所有虚函数。然而，我的老板否决了这一点，因为现有的框架是“继承重”，他想避免增加疯狂。我显然不能封装我的 API，因为这就是 API 本身应该做的事情，这样做可能会隐藏功能。

没有要求期货开发人员复制和粘贴我的示例，我该怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-18T21:52:43.780

如果你的老板对继承怀有敌意，请尝试聚合。（*Has-a*关系而不是继承的*is-a*关系。）假设您通过对象与相关 API 进行交互，也许您可​​以将该对象保留在框架“主”类的属性中，这样您就可以与它喜欢`main->whateverapi->doWhatever()`。如果 API 不是对象实现的，或者您需要将许多特定于您的环境的功能加载到它上面，那么这表明您需要创建自己的类来扮演该角色并与第三方 API 相关，但它需要。是的，这基本上意味着您正在为 API 构建一个 API。但是，聚合允许您避免屏蔽功能问题；即使您必须做一个中间层，您也可以将原始 API 公开为`main->yourobject->originalapi`并且不必担心继承搞砸了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-18T21:59:34.610

在我看来，您的老板遇到的问题是其中的框架部分。框架和 API 之间有一个重要的区别，为了编写一个框架，你必须对它有一个很好的理解，以及它如何适应你的整体开发，更多的是一个整体的观点，添加到框架中绝不能掉以轻心。

另一方面，API 只是您的应用程序/框架的一个接口，通常只是一个实用程序调用库，我看不出他会对库中的继承或聚合有问题，在我看来，问题是在框架本身中创建额外的复杂性，即要求开发人员扩展框架的主类比创建一个人们可以调用的独立 API 库（如果他们选择）要繁重得多 我愿意打赌你的老板如果库本身包含继承，则不会关心（实际上可能支持）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-18T22:10:31.513

就像上面混乱的答案一样，我将建议将聚合作为继承的替代方案。您可以包装 API 并通过属性或依赖注入使其可配置。

[此外，有关相关主题，请参阅我对“代理、装饰器、适配器和桥接模式有何不同？](https://stackoverflow.com/questions/350404/how-do-the-proxy-decorator-adaptor-and-bridge-patterns-differ#350471) ”的回答，以了解其他“包装器”设计模式。

# wpf - 如何制作对象的副本

> ID：379382
> 
> 赞同：1
> 
> 时间：2008-12-18T21:38:22.047
> 
> 标签：wpf, vb.net

我有一个名为 Bookmarks 的对象的集合，它由 Bookmarks 的集合组成。此书签集合绑定到树视图控件。

我可以取回我需要的书签，但我需要书签的副本，这样我就可以使用它而不更改原始书签。

有什么想法吗。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-18T22:05:35.737

为您的书签类创建一个新的构造函数，该构造函数将现有书签作为参数。

在这个新的构造函数中，将现有书签中的所有属性值复制到新的书签中。

这种技术被称为“复制构造器”。

MSDN 上有一篇更详细的文章 - 请参阅[How to Write a Copy Constructor](http://msdn.microsoft.com/en-us/library/ms173116.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-18T21:40:35.270

.Net 中的大多数集合类都提供了一个构造函数重载，允许您传入另一个集合，例如

```
dim copyOfBookMars as New List(of BookMark)(myOriginalBookMarkList) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-18T21:55:57.813

使用 VB 已经有一段时间了，但 c# 提供了一个 clone() 方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-18T22:00:43.170

您通常不会复制对象，对象会复制自身（克隆）。由于对象包含状态信息，因此不能指望按位复制是合适的；所以定义类需要照顾它。

您可能希望在您的情况下实现多个同时指针（书签）。

# c++ - 查找数字序列中的空白

> ID：379383
> 
> 赞同：6
> 
> 时间：2008-12-18T21:38:22.077
> 
> 标签：c++, stl

我有一个 std::vector 包含一些数字，它们没有任何特定的顺序，并且数字之间可能有也可能没有间隔 - 例如，我可能有 { 1,2,3, 6 } 或 { 2 ,8,4,6 } 或 { 1, 9, 5, 2 } 等。

我想要一个简单的方法来查看这个向量并说'给我最小的数字> = 1，它*没有*出现在向量中'。所以，

对于上述三个示例，答案分别为 4、1 和 3。

它不是性能关键，并且列表很短，因此例如复制列表和对其进行排序没有任何问题。

我并没有真正坚持这样做的方法，但我的 STL 技能严重萎缩，我可以感觉到我即将做一些不雅的事情 - 我很想看看其他人想出了什么。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-18T22:32:15.837

您正在寻找的标准算法是**[std::adjacent_find](http://en.cppreference.com/w/cpp/algorithm/adjacent_find)**。

这是一个也使用 lambda 使谓词干净的解决方案：

```
int first_gap( std::vector<int> vec )
{
  // Handle the special case of an empty vector.  Return 1.
  if( vec.empty() )
    return 1;

  // Sort the vector
  std::sort( vec.begin(), vec.end() );

  // Find the first adjacent pair that differ by more than 1.
  auto i = std::adjacent_find( vec.begin(), vec.end(), [](int l, int r){return l+1<r;} );

  // Handle the special case of no gaps.  Return the last value + 1.
  if ( i == vec.end() )
    --i;

  return 1 + *i;
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-12-18T22:15:59.520

检查的答案使用 < 进行比较。!= 更简单：

```
int find_gap(std::vector<int> vec) {
    std::sort(vec.begin(), vec.end());
    int next = 1;
    for (std::vector<int>::iterator it = vec.begin(); it != vec.end(); ++it) {
        if (*it != next) return next;
       ++next;
    }
    return next;
}

find_gap(1,2,4,5) = 3
find_gap(2) = 1
find_gap(1,2,3) = 4 
```

我没有传递对向量的引用，因为a）他说时间无关紧要，b）所以我不改变原始向量的顺序。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-18T21:41:34.600

对列表进行排序然后进行线性搜索似乎是最简单的解决方案。根据列表的预期组成，您可以使用不太通用的排序算法，如果您自己实现排序，则可以在排序期间跟踪数据，以加快（或完全消除）搜索步骤。我认为这个问题没有任何特别优雅的解决方案

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-18T21:49:50.230

您可以分配一个位向量（与输入向量的长度相同），将其初始化为零，然后标记所有出现的索引（请注意，可以忽略大于长度的数字）。然后，返回第一个未标记的索引（如果所有索引都被标记，则返回长度，仅当所有索引在输入向量中恰好出现一次时才会发生）。

这应该比排序和搜索快。如果允许您销毁原始文件，它将比排序使用更多的内存，但如果您必须保留原始文件，它将比排序使用更少的内存。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-18T21:46:19.130

排序-n-搜索：

```
std::sort(vec.begin(), vec.end());
int lowest = 1;
for(size_t ii = 1; ii < vec.size(); ++ii)
{
    if (vec[ii - 1] + 1 < vec[ii])
    {
        lowest = (vec[ii - 1] + 1);
        break;
    }
}

/* 1, 2, ..., N case */
if (lowest == vec[0]) lowest = (*vec.back()) + 1; 
```

[迭代器的使用意图与@joe_mucchiello（*编辑：更好*）的回答](https://stackoverflow.com/questions/379383/finding-gaps-in-sequence-of-numbers#379507)中展示的一样清晰。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-18T22:00:05.793

实际上，如果你做一个冒泡排序（你知道......他们先教你然后告诉你永远不要再使用......），你将能够在排序过程的早期发现第一个差距，所以你可以停在那里。这应该会给你最快的整体时间。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-18T22:16:01.237

好的，这是我的 2 美分。假设你有一个长度为 N 的向量。

1.  如果 N<=2 你可以直接检查
2.  一、用min_element得到最小的元素，记为emin
3.  调用 nth_element 获取 N/2 处的元素，称其为 ehalf
4.  如果 ehalf != emin+N/2 左侧有一个间隙，则通过在整个数组上调用 nth_element 但要求元素 N/4 递归地应用此方法。否则，在右边递归请求元素 3*N/4。

这应该比完全预先排序要好一些。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-18T22:18:19.017

你可以选择类似的东西......

```
struct InSequence
{
    int _current;   bool insequence;
    InSequence() : _current(1), insequence(true){}
    bool operator()(int x) {         
        insequence = insequence ? (x == _current) : false;  
        _current++; 
        return insequence;
    }
};

int first_not_in_sequence(std::vector<int>& v)
{
    std::sort(v.begin(), v.end());
    return 1+std::count_if(v.begin(), v.end(),InSequence());
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-05-04T12:14:35.970

**Thomas Kammeyer 答案的可能实现**

我发现 Thomas 的方法非常聪明和有用——因为我们中的一些人梦想着代码，而我发现实际的实现有点棘手，我想提供一些现成的代码。

此处介绍的解决方案尽可能通用：

*   不对容器或范围的类型做出任何假设，除了它们的迭代器必须满足 ValueSwappable 和 RandomAccessIterator 的要求（由于使用 进行部分排序`nth_element`）
*   可以使用任何数字类型 - 下面概述了所需的特征

我认为的另一个改进是可以及早检查无间隙条件：因为无论如何我们都必须扫描最小值，我们也可以同时扫描最大值，然后确定数字范围是否甚至包含值得查找的间隙。

最后但并非最不重要的一点是，相同的递归方法可以适用于排序范围！如果您在模板值参数中编码范围是否已经排序，您可以简单地跳过部分排序加上确定最小/最大元素的无操作。

```
#include <type_traits>
#include <iterator>
#include <tuple>
#include <utility>
#include <algorithm>
#include <cstddef>

// number type must be:
// * arithmetic
//   * subtractable (a - b)
//   * divisible by 2 (a / 2)
// * incrementable (++a)
// * less-than-comparable (a < b)
// * default-constructible (A{})
// * copy-constructible
// * value-constructible (A(n))
// * unsigned or number range must only contain values >0

/** Find lowest gap value in a range */
template<typename Range>
typename std::remove_reference_t<Range>::value_type
lowest_gap_value_unsorted(Range&& r)
{
    static_assert(!std::is_lvalue_reference_v<Range> && !std::is_const_v<Range>, "lowest_gap_value_unsorted requires a modifiable copy of the passed range");

    return lowest_gap_value_unsorted(std::begin(r), std::end(r), std::size(r));
}

/** Find lowest gap value in a range with specified size */
template<typename Range>
typename std::remove_reference_t<Range>::value_type
lowest_gap_value_unsorted(Range&& r, std::size_t N)
{
    static_assert(!std::is_lvalue_reference_v<Range> && !std::is_const_v<Range>, "lowest_gap_value_unsorted requires a modifiable copy of the passed range");

    return lowest_gap_value_unsorted(std::begin(r), std::end(r), N);
}

/** Find lowest gap value in an iterator range */
template<typename Iterator>
typename std::iterator_traits<Iterator>::value_type
lowest_gap_value_unsorted(Iterator first, Iterator last)
{
    return lowest_gap_value_unsorted(first, last, std::distance(first, last));
}

/** Find lowest gap value in an iterator range with specified size */

template<typename Iterator>
typename std::iterator_traits<Iterator>::value_type
lowest_gap_value(Iterator first, Iterator last, std::size_t N)
{
    typedef typename std::iterator_traits<Iterator>::value_type Number;

    if (bool empty = last == first)
        return increment(Number{});

    Iterator minElem, maxElem;
    std::tie(minElem, maxElem) = std::minmax_element(first, last);

    if (bool contains0 = !(Number{} < *minElem))
        throw std::logic_error("Number range must not contain 0");

    if (bool missing1st = increment(Number{}) < *minElem)
        return increment(Number{});

    if (bool containsNoGap = !(Number(N) < increment(*maxElem - *minElem)))
        return increment(*maxElem);

    return lowest_gap_value_unsorted_recursive(first, last, N, *minElem);
}

template<typename Iterator>
typename std::iterator_traits<Iterator>::value_type
lowest_gap_value_unsorted_recursive(Iterator first, Iterator last, std::size_t N, typename std::iterator_traits<Iterator>::value_type minValue)
{
    typedef typename std::iterator_traits<Iterator>::value_type Number;

    if (N == 1)
        return ++minValue;
    if (N == 2)
    {
        // determine greater of the 2 remaining elements
        Number maxValue = !(minValue < *first) ? *std::next(first) : *first;
        if (bool gap = ++minValue < maxValue)
            return minValue;
        else
            return ++maxValue;
    }

    Iterator medianElem = std::next(first, N / 2);
    // sort partially
    std::nth_element(first, medianElem, last);

    if (bool gapInLowerHalf = (Number(N) / 2 < *medianElem - minValue))
        return lowest_gap_value_unsorted_recursive(first, medianElem, N / 2, minValue);
    else
        return lowest_gap_value_unsorted_recursive(medianElem, last, N / 2 + N % 2, *medianElem);
};

template<typename T>
T increment(T v)
{
    return ++v;
} 
```

# linux - 为 Linux bash 或 shell 脚本提供自动完成和错误检测的 IDE？

> ID：379385
> 
> 赞同：7
> 
> 时间：2008-12-18T21:39:03.963
> 
> 标签：linux, bash, vim, shell, scripting

我们的开发团队正在寻找像 vi 或 nano 甚至是用于 windows 的 textpad 之类的 IDE，它能够为 linux 的 bash 或 shell 脚本自动完成和纠错。基本上类似于 .NET 自动完成的东西，您可以在其中查看是否有

```
 if[ $# -ne 5 ]; then 
```

5 和 ] 之间没有空格会告诉你。

我希望这个问题简单易懂。我已经看到 RHE 中的 vi 使用了一些颜色，但在 CentOS5 中它没有显示不同的颜色。它们都不使用错误检测或自动完成。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-18T22:10:37.927

像大多数此类问题一样，唯一正确的答案是 EMACS。

然而，TextMate、BBEdit 和 SubEthaEdit 也做得很好。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-19T08:58:09.630

在 vim 中，除了添加语法突出显示以显示不正确的语法（“if”示例不会正确突出显示 if）之外，您还可以将其添加到 .vimrc：

```
autocmd FileType sh set makeprg=bash\ -n\ '%'
autocmd FileType sh let &efm = "%E%f:\ line\ %l:\ %m," . &efm 
```

现在，当您运行`:make`时，它将检查语法并跳转到错误。Map :make 到 F5 和语法检查只是一个按键。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-20T17:06:21.357

Red Hat 将 VIM RPM 分为 vim-minimal、vim-enhanced 和一些。您需要 vim 增强的 RPM 来进行语法高亮显示。由于 CentOS 只不过是重新打包的 RHEL，因此 CentOS 也是如此。如果它必须用于 Windows：GVim 是现成的。

您可以将语法高亮本身视为错误检测的一种形式。如果您在括号、花括号或其他内容中出现错误，您会看到语法高亮显示中断，向您显示有什么问题以及哪里出错了。

至于补全：Bash 中的大多数命令都很短，但 CTRL-N 会自动补全您之前在该文件中使用过的文件中的任何内容。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-05-29T18:35:11.720

您可以尝试[Griffon](http://griffon.lasotel.fr/en/)，它是专门为 BASH 脚本设计的 IDE。它的功能包括自动完成、语法高亮、错误检测等。

# php - 在单独的 php web 应用程序之间自动登录。安全问题？

> ID：379387
> 
> 赞同：2
> 
> 时间：2008-12-18T21:39:12.870
> 
> 标签：php, security, mantis

我们有一个工作中的技术支持网站/数据库，用于记录我们与客户的互动。我们的技术支持人员无法创建自己的帐户。我们还在同一台服务器上使用 Mantis 作为跟踪错误的一种方式。

在技​​术支持站点中，我们希望有一个 Mantis 的链接，以便我们的技术支持人员可以快速输入错误报告。很快，这意味着技术支持人员在单击链接后不必登录 Mantis。

因此，我们从我们的技术支持站点调用 Mantis 中修改后的身份验证功能，以检查用户名，如果存在，则自动将用户登录到 Mantis。没有密码检查，因为我们急于处理许多更重要的事情。

这是安全风险吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-18T21:58:02.397

这是一个风险吗？是的，但可能有缓解因素。

1.  检查是从服务器到服务器交互还是客户端javascript进行调用？如果服务器到服务器，这会降低一点风险。

2.  螳螂是公开面对还是完全内部？如果是内部的，那么这将范围仅限于内部用户。

3.  如果所有的错误信息都“泄露”到互联网上，这会对您的雇主产生潜在的影响吗？这是更难的一个。此外，这必须与已经提供给技术人员的访问权进行权衡。

4.  损坏的最大可能性是多少？换句话说，让我们假设您的一位支持技术人员很生气并决定对公司系统进行攻击。

他们能做什么？

Mantis 只存储错误跟踪信息。此外，如果您的服务器是每晚备份一次，那么您将被限制在可能破坏一天价值的错误。从黑客的角度来看几乎不值得，对公司没有真正的影响。

使用的安全量应该与它所保护的内容相称。

# c# - UI 模式：相同的对象，不同的显示

> ID：379412
> 
> 赞同：2
> 
> 时间：2008-12-18T21:44:59.880
> 
> 标签：c#, asp.net-mvc, user-interface, design-patterns

我有一个将序列号输入数据库的应用程序。序列号有一组定义它的属性，用户必须/可以提供它们来生成。

```
public class Serial
{
    public string Number {get; set;}
    public string Part {get; set;}
    public string MfgOrder {get; set;}
    public string CusOrder {get; set;}
    public string Note {get; set;}
    ... etc ...
} 
```

现在，此应用程序的起点要求用户提供几条信息之一（例如零件号或制造订单等）。这个起点可能已经填写了一些需要的用户输入。然后我想取那些已知的项目并根据它们更改表格。

例如。如果两条信息是零件号和制造订单号，并且用户提供制造订单号（与数据库中的零件号有关系）我想显示这些值但不允许它们是编辑。相反，如果用户只给我一个零件号，我希望允许将制造订单显示为一个文本框，旁边是（可能）可选或必需的。

```
public class MfgOrder
{
    public string MfgOrder {get; set;}
    public string Part {get; set;}
}

...

MfgOrder order = new MfgOrder(some_user_value); // queries database, returns populated object
Serial serial = new Serial() {
    MfgOrder = order.MfgOrder,
    Part = order.Part
}; 
```

这个应用程序现在可以通过在 UI 中使用 if/then 条件来运行——如果你给了我一个制造订单，以这种方式显示它，如果你给我别的东西，就以这种方式进行，等等。问题是几个新的选项已被请求并且不断链接 if/then 语句变得非常难看。

```
if(serial.comes_from_mfgOrder == true)
{
    %>Manufacturing Order: <%=serial.MfgOrder %><%
} else if (serial.comes_from_part_number == true) {
    %>Manufacturing Order: <%=Html.Textbox("MfgOrder")%><%
} else if // continue this for way too long now ... 
```

这里有好的设计模式吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-18T21:55:09.983

[如果有 IF，请制作一个 Helper](http://blog.wekeroad.com/blog/asp-net-mvc-avoiding-tag-soup/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-19T01:55:00.453

我相信您正在寻找的模式是模型视图控制器或 MVC。

[http://www.dotnetheaven.com/Uploadfile/rmcochran/MVC_intro02012006001723AM/MVC_intro.aspx](http://www.dotnetheaven.com/Uploadfile/rmcochran/MVC_intro02012006001723AM/MVC_intro.aspx)

# visual-studio - 在 Visual Studio 中更改成员变量的字体

> ID：379428
> 
> 赞同：8
> 
> 时间：2008-12-18T21:47:55.723
> 
> 标签：visual-studio, visual-studio-2005, syntax-highlighting

我不认为这是可能的，但无论如何我会问...

有没有办法在编辑器中设置用于类成员变量的颜色和字体？在过去 4 年的 Java 世界中，我刚刚回到 C++ 和 Visual Studio，我*真的很*想念 Jetbrains 的 IDEA（一个杀手级 Java IDE）。我真的已经习惯让我的编辑器使用颜色和字体来指示成员函数、静态等...

如果 Visual Studio 做不到，是否有更好的 IDE 用于 C++/MFC 编程？Visual Studio 让我感觉自己仿佛走进了时光机，仿佛回到了十年前。除了我还 38 岁，身材走样。

科里

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T17:29:49.947

不是免费的，但[Visual Assist](http://www.wholetomato.com/)是一个用于 vs2005/2008 的插件，可让您为类、变量、宏和函数（以及其他功能）分配不同的颜色。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-18T22:00:42.953

VS 2008 中没有。在 PDC 上，我们看到了 VS 2010 的预览版，据说它允许使用多种字体。

# html - 如何发布具有多个选定值的 HTML 列表框的选择

> ID：379432
> 
> 赞同：6
> 
> 时间：2008-12-18T21:49:17.000
> 
> 标签：html, html-select

我在带有提交按钮的 HTML 表单上有一个列表框。列表框启用了多项选择。我可以在列表框中选择多个值，但我不知道如何确定提交表单时选择了哪些值。另外，我正在使用 JavaScript 将用户生成的值动态添加到列表框中，并且我希望能够在表单提交时告诉两件事：

1.  用户添加到框中的选项是什么？
2.  用户在框中选择了哪些值？

这可能吗？谢谢。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2008-12-19T03:30:11.103

通过使用尾随方括号命名您`select`，PHP（以及可能的其他服务器语言）会将数据放入数组中

前任：

```
<form action="process.php" method="post">
  <select name="multiSelects[]" multiple="multiple" size="5">
    <option value="0">Zero</option>
    <option value="1">One</option>
  </select>
  <input type="submit" />
</form> 
```

选择将在数组中可用`$_POST['multiSelects']`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-19T02:56:52.373

下面是一个页面示例。

注意：

*   选择元素（和任何表单元素）需要一个名称才能包含在帖子中。
*   只会发布选择元素中的选定选项。

*用户在框中选择了哪些值？*

当用户提交表单时，只有选定的值将被发送到服务器。根据您在服务器上使用的语言，有不同的方法可以访问它们。

*用户添加到框中的选项是什么？*

如前所述，您只会看到选择了哪些选项。但是您如何区分您的选项和用户选项？这取决于您向用户发送的数据。普遍的答案是，这就是你没有发送的价值。但是，这可以根据您的数据进行简化。由于选项同时具有值​​和文本属性，因此它是使用数值作为预生成值的一种方法。这样，您的值在回复中将是数字，而用户值将是文本字符串。这种方法假定您的用户不会只输入数字值。另一种方法是为所有用户生成的值添加前缀（请记住，所有选项都有一个值和一个文本字段）

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>Test of select box</title>
    <script type="text/javascript">
      function addOpt(e) {
        var o=document.createElement("option");
        //o.value= -e.options.length;
        o.text = "Test " + e.options.length;
        o.selected=true;
        e.add(o,null);
      }
    </script>
  </head>
  <body>
    <form method="post" action="mypage.html">
      <input type="button" onclick="addOpt(this.form.myselect)" value="Add option"/>
      <br/>
      <select id="myselect" name="mydata" multiple="multiple" size="10">
        <option value="0">Test 0</option>
        <option value="1">Test 1</option>
        <option value="2">Test 2</option>
      </select>
      <br/>
      <input type="submit"/>
    </form>
  </body>
</html> 
```

# .net - 从复合控件获取数据 - 访问者模式？

> ID：379441
> 
> 赞同：1
> 
> 时间：2008-12-18T21:52:18.400
> 
> 标签：.net, design-patterns, visitor-pattern

我有一些相当复杂的表单，需要由网页设计师配置。

我一直在构建一些似乎正在完成这项工作的复合控件。

顶层控件只是一个容器，表单的各个部分都包含在其中。SubControls 实现通用接口，（即 NeptuneAddressControl 和 MarsAddressControl 实现 IPlanetaryAddressControl）

最终，一切都需要进入同一个数据库。

我不是将子控件的每个字段都公开为父控件中的道具，而是考虑实现一个跨越控件树的访问者，并填充一个实体对象，然后可以写入数据库。

这是正确的方法还是我离这里很远？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-31T15:50:00.160

我认为使用属性映射和访问者之间的权衡是实现访问者需要了解所有可能属性的类，而处理映射的代码可以独立于表单/数据库的内容。

有了访问者，当新类型的数据添加到结构中时，您的代码无法编译，因此编译器可以在您更改复杂结构时为您提供帮助。

如果稍后添加新字段或控件，属性的好处可能会导致代码量更少，根本不需要更改中间层，具体取决于您可以使该代码的通用程度。

我想还有其他选择，但我认为访问者方法是有道理的。您可能想要做一些特定于控制的事情，比如专门的验证，这将更难通用编码，因此任务会更容易，并且应该很好地防止由于控制结构的变化而导致的隐藏错误。

# c++ - 用 Python 编写的 wxWidget 比 C++ 慢多少？

> ID：379442
> 
> 赞同：6
> 
> 时间：2008-12-18T21:52:22.050
> 
> 标签：c++, python, performance, drawing, wxpython

我正在考虑编写一个显示图形节点网络的 wxWidget，因此会执行很多绘图操作。我知道使用 Python 来做这件事会更慢，但我宁愿让它工作并稍后在它运行时移植它。理想情况下，如果性能影响不是太大，我更愿意将代码库保留在 Python 中以便于更新。

我想知道的是我应该期望事情进展多慢？我意识到这是模糊和开放式的，但我只需要了解会发生什么。画 500 圈会卡住吗？会不会很明显？你有什么经验？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-18T22:41:00.093

恕我直言，主要瓶颈将是您将用于表示网络图的数据结构。我编写了一个类似的应用程序来跟踪系统中各种组件版本之间的依赖关系，而图形是我最不必担心的事情，而且我确实为其中一些绘制了 500 多个带有渐变填充的对象！

如果你陷入困境，你应该使用[PyGame](http://wiki.wxpython.org/IntegratingPyGame)来绘制东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-19T00:18:02.490

以我的经验，以天真的方式做事（将每个对象绘制到屏幕上）在 Python 中会比 C++ 更快地陷入困境。但是，使用 Python 以聪明的方式编写代码会更快，也不会那么痛苦（例如，参见[PseudoDC](http://www.wxpython.org/docs/api/wx.PseudoDC-class.html)），这将把天真的 C++ 实现从水中吹走。

我同意苏拉杰。与您将放弃的方便的 wxPython 相比，PyGame 可能是一个不错的选择，具体取决于应用程序的图形密集程度。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-19T10:00:42.313

对于绘图，人们建议使用 PyGame。我喜欢 PyGame，它易于使用且运行良好。其他选择是 Pyglet，或者使用 PyOpenGL（你很可能也可以绘制到 wx 小部件，尽管我从未这样做过）。

就个人而言，我会在 Python 中使用我最熟悉的任何库（在我的情况下，我会使用 pygtk 和 cairo）并且只在它成为问题时才担心性能 - 然后分析和优化瓶颈，如果它的 Python 代码很慢，我会知道在 C 中运行哪些位。

# c++ - 来自 AcquireCredentialsHandle() 的 SEL_E_SECPKG_NOT_FOUND 错误

> ID：379445
> 
> 赞同：1
> 
> 时间：2008-12-18T21:53:59.580
> 
> 标签：c++, windows, security, ssl

尝试从 Microsoft 的 Secure SOAP 示例 [http://msdn.microsoft.com/en-us/library/s2ya483s.aspx运行代码时出现上述错误](http://msdn.microsoft.com/en-us/library/s2ya483s.aspx)

来自 M'soft 代码的调用似乎是正确的：

```
Status = g_Sample_SecurityInit._SecurityFunc.AcquireCredentialsHandleA(
    NULL,                   // Name of principal    
    UNISP_NAME_A,           // Name of package
    SECPKG_CRED_OUTBOUND,   // Flags indicating use
    NULL,                   // Pointer to logon ID
    &m_SchannelCred,        // Package specific data
    NULL,                   // Pointer to GetKey() func
    NULL,                   // Value to pass to GetKey()
    &m_hClientCreds,        // (out) Cred Handle
    &tsExpiry);             // (out) Lifetime (optional) 
```

关于如何进行的任何想法？FWIW，这是 SSL 客户端的一部分，但我真的不需要客户端身份验证。

罗尼

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-30T17:53:41.053

你在什么操作系统上运行你的客户端？此文件应存在于 System32 for SSL 中：SChannel.dll。

如果您能够或想要使用 .NET，那么使用 SslStream 类有一种更简单的方法。

# c++ - 适用于本机 Visual Studio 开发人员的有用加载项或插件

> ID：379453
> 
> 赞同：76
> 
> 时间：2008-12-18T21:56:03.757
> 
> 标签：c++, visual-studio, visual-c++, visual-studio-addins

Visual Studio 有很多不同的加载项，请参阅[Visual Studio Gallery](http://visualstudiogallery.com) 。请分享您的经验和最爱。

作为动力，这里有一些我最喜欢的：

*   [版本控制构建](http://www.codeproject.com/KB/macros/versioningcontrolledbuild.aspx)[F/O] - 非常方便的自动构建编号扩展
*   [SlickEdit Gadgets](http://www.slickedit.com/products/slickedit-gadgets) [F] - 有用的编辑器小工具，内置文件浏览器......
*   [SlickEdit Tools](http://www.slickedit.com/products/slickedit-tools) [C] - 编辑和版本控制工具
*   [重构！for C++](http://www.devexpress.com/Products/Visual_Studio_Add-in/RefactorCPP/index.xml) [F/C] - 像 C# 一样重构 C++ 代码
*   [WiX](http://wix.sourceforge.net) [F/O] - 使用 XML 进行 Windows 安装程序设置
*   [AnkhSVN](http://ankhsvn.open.collab.net) [F/O] - 从你的 IDE 内部使用颠覆
*   [Visual Leak Detector](http://vld.codeplex.com/) [F/O] - 调试问题的助手
*   [Parasoft C++test](http://www.parasoft.com/jsp/products/home.jsp?product=CppTest&itemId=47) [C] - 代码质量保证套件
*   [Parasoft Insure++](http://www.parasoft.com/jsp/products/home.jsp?product=Insure&itemId=63) [C] - 运行时内存分析
*   [RockScroll](http://www.hanselman.com/blog/IntroducingRockScroll.aspx) [F] - 在长文件中滚动的助手
*   [Axialis IconWorkshop](http://www.axialis.com/download/iwlite.html) [F/C] - 图标和位图编辑器
*   [PowerCommands](http://www.visualstudiogallery.com/ExtensionDetails.aspx?ExtensionId=df3f0c30-3d37-4e06-9ef8-3bff3508be31) [F] - 在上下文菜单中添加一些有用的命令
*   [IncrediBuild](http://www.xoreax.com/main.htm) [C] - 加快构建过程
*   [Workspace Whiz](http://workspacewhiz.com) [F/C] - 许多有用的插件
*   [Consolas Font Pack](http://www.microsoft.com/downloads/details.aspx?familyid=22e69ae4-7e40-4807-8a86-b3d36fab68d3&displaylang=en) [F] - 非常适合编程的字体
*   [Intel Parallel Studio](http://software.intel.com/en-us/intel-parallel-studio-home) [C] - Intel 优化的 C/C++ 编译器分析器和调试助手
*   [Microsoft Visual Studio 2005 IDE Enhancements](http://www.microsoft.com/downloads/details.aspx?FamilyID=cd7c6e48-e41b-48e3-881e-a0e6e97f9534&DisplayLang=en) [F] - 仅适用于 VS2005、Outliner / C++ Snippets /...
*   [codekana](http://www.codekana.com) [F] - 与 Visual Assist 非常相似
*   [Visual Local History](http://www.codeplex.com/VLH2005) [F] - 本地文件历史 à la Eclipse
*   [ResOrg](http://www.riverblade.co.uk/products/resorg/index.html) [F] - 管理和重新编号资源符号 ID
*   [PVS-Studio](http://pvs-studio.viva64.com) [C] - 静态代码分析器，尤其是 64 位代码分析 (Viva64)
*   [ASP.NET/HTML Spell Checker for VS](http://blogs.msdn.com/webdevtools/archive/2008/11/29/spell-checker-update-2-2-full-support-for-vs-2008-sp1-simpler-setup-and-a-few-bug-fixes.aspx) [F] - 拼写检查器。

**工具**

*   [Ranorex](http://www.ranorex.com) [C] - GUI 测试和自动化框架
*   [OneTime](http://www.axosoft.com) [F/C] - 软件项目管理
*   [CppCheck](http://sourceforge.net/projects/cppcheck) [F/O] - C/C++ 代码的静态分析
*   [在线 GUID 生成器](http://www.guidgenerator.com)[F] - 如果您需要 GUID
*   [WinMerge](http://winmerge.org) [F] - 文件/目录比较
*   [codepad](http://codepad.org) [F] - 在线编译器
*   [Cilk++](http://www.cilk.com) [F/C] - 针对多核处理器优化您的应用程序
*   [Microsoft Application Verifier](http://www.microsoft.com/downloads/details.aspx?FamilyID=c4a25ab9-649d-4a1b-b4a7-c9d8b095df18&DisplayLang=en#filelist) [F] - 本机代码的运行时验证工具
*   [SourceMonitor](http://www.campwoodsw.com/sourcemonitor.html) [F] - 简单的代码度量测量工具
*   [WinUnit](http://winunit.codeplex.com/) [F] - Windows 上原生 (C/C++) 代码的良好单元测试
*   [非常困](http://www.codersnotes.com/sleepy/)[F] - 简单的代码分析工具
*   [Visual Sidekick](http://www.visualsidekick.com/Syntaxia/HomePage.php) [P] - 对符号和文件进行有效但廉价的增量搜索
*   [CodeAnalyst](http://developer.amd.com/cpu/codeanalyst/Pages/default.aspx) [F] - AMD 的代码分析工具（也部分适用于 Intel）
*   [Sisulizer](http://www.sisulizer.com/) [C] - 可视化软件本地化工具
*   [Innovasys HelpStudio Lite](http://www.innovasys.com/products/hslite/overview.aspx?cpid=vssdk) [F/C] - 创建 Microsoft Help 2.x 帮助系统。

**喝咖啡休息时间**

*   [粉末玩具](http://powder.unaligned.org)[F] - 自己构建惊险的模拟
*   [OE-CAKE](http://www.octaveengine.com/en_casual/oecake) [F/C] - 自己构建流体模拟。

**你的建议：**

*   [ViEmu](http://www.viemu.com) [C] - VI 仿真
*   [视觉辅助](http://www.wholetomato.com)[C] - “La Crème de la Crème”
*   [VisualSVN](http://www.visualsvn.com/visualsvn) [C] - 非常好的 SVN 提供者
*   [Visual Lint](http://www.riverblade.co.uk) [C] - 高级静态代码分析
*   [VSFileExplorer](http://www.mindscape.co.nz/products/vsfileexplorer) [F] - 自我解释
*   [P/Invoke](http://www.pinvoke.net) [F] - 帮助查找托管代码的本机代码签名。

* * *

[F] - 免费软件 [O] - 开源 [C] - 商业。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2008-12-18T22:16:14.403

我很惊讶[Visual Assist](http://www.wholetomato.com/)还没有被提及！

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-18T22:05:11.213

[ViEmu](http://www.viemu.com/)是我个人的最爱。在 VS 内部模拟 VI。:^)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-26T07:35:18.810

没有人使用[Resharper](http://www.jetbrains.com/resharper/index.html)吗？- 你太无耻了！;-)

说真的，你不知道你错过了什么（我知道，因为我还没有说服我的老板买它，我的评估期已经到期）

将此工具添加到 Visual Studio 几乎将其提升到[IntelliJ Idea for Java的水平](http://www.jetbrains.com/idea/index.html)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-06-24T21:48:18.343

RockScroll 很棒，但还有更强大的东西：[MetalScroll](http://code.google.com/p/metalscroll/) :)

顺便说一句...我也推荐这个补丁：[http ://code.google.com/p/metalscroll/issues/detail?id=9](http://code.google.com/p/metalscroll/issues/detail?id=9)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-05T12:21:06.353

*   Visual assist X
*   P/Invoke
*   Refactor!

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-22T09:30:32.057

[VSFileExplorer](http://www.mindscape.co.nz/products/vsfileexplorer/)是一个很好的 VS 文件浏览器。与 subversion/tortoiseSVN 一起使用时也非常有用，因为它在 VS 中显示乌龟覆盖图标。

而且当然

[GhostDoc](http://www.roland-weigelt.de/ghostdoc/)用于为方法、属性、类等生成 XML 文档注释

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-19T14:26:54.627

辅助非常有用，视觉棉绒很好但很无聊。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-26T07:30:12.003

我的一个小问题：[Linkify](http://www.codeproject.com/KB/macros/Linkify.aspx)，它简化了开发 wiki、msdn、bug 跟踪器等评论中的链接。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-12-04T08:51:16.780

我的两便士值：[TabStudio](http://www.tabsstudio.com/)和[RockScroll](http://www.hanselman.com/blog/IntroducingRockScroll.aspx)。

Tab Studio 在处理 WPF / Silverlight 应用程序时非常棒，它试图跟踪任意数量的代码、视图模型和 xaml 文件。

Rock scroll 非常适合较大的文件和快速查找参考。

# perl - 如何替换外部文件中的哈希值？

> ID：379465
> 
> 赞同：1
> 
> 时间：2008-12-18T21:59:47.010
> 
> 标签：perl, hash, substitution

对于我的程序，我试图用新创建的值替换外部文件中特定哈希的值。外部文件的值是从键中以制表符分隔的，我已经从外部文件中读取了哈希值。我一直在网上四处寻找，这是我能弄清楚如何做的最接近的方法，但它似乎不起作用。

```
 open(IN, ">>$file") || die "can't read file $file";
            while (<IN>) {
            print IN s/$hash{$key}/$newvalue/;
            }
           close (IN) 
```

我不太确定我在这个公式中缺少什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-18T22:09:54.587

[Tie::File](http://search.cpan.org/perldoc?Tie::File)可以为您解决这个问题。

```
use Tie::File;

tie @array, 'Tie::File', $file or die "Could not tie $file: $!";

for (@array) {
    s/$hash{$key}/$newvalue/;
}
untie @array; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-01-07T21:36:27.010

[http://www.sthomas.net/roberts-perl-tutorial.htm/ch13/Modifying_a_File_with___](http://www.sthomas.net/roberts-perl-tutorial.htm/ch13/Modifying_a_File_with___I)
我在“$INPLACE_EDIT perl”上搜索

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-18T22:04:26.097

您正在尝试读取和写入同一个文件，这是行不通的。您必须阅读，替换然后写入另一个文件。之后，如果您真的想要一个文件，您可以将输入文件替换为您刚刚编写的文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-18T22:06:15.330

这不会很有效，但它应该可以工作，除非我的 perl-fu 不好：

```
open(IN, "<<$file") || die "can't read file $file";
open(OUT, ">>${file}.tmp") || die "can't open file $file";
while (<IN>) {
    print OUT s/$hash{$key}/$newvalue/;
}
close(IN);
close(OUT);
exec("mv ${file}.tmp $file"); 
```

在 perl 中可能有一个命令可以为您执行此操作，但我不是 perl 人。

# web-applications - 确定应用程序硬件要求的最佳方法是什么

> ID：379478
> 
> 赞同：18
> 
> 时间：2008-12-18T22:05:04.473
> 
> 标签：web-applications, hardware, requirements

您使用什么方法来确定服务器需要什么样的硬件？

我经常发现很难预测带有数据库的基于 Web 的应用程序需要什么样的硬件。

对于如何最好地选择要使用的硬件，您有什么好的方法或建议吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-18T22:26:56.830

这是容量规划的基本问题。您首先定义一个*工作负载模型*，该模型描述了您期望获得的流量。这可以像“我预计每分钟最多点击 20 个页面”一样简单。

然后你需要考虑突发负载。如果没有任何其他数据，您可以假设到达间隔时间呈指数分布，这意味着如果您在时间*t [0]**有一个页面请求，那么您很可能在t* *[0]*之后很短的时间内有*[下]*一次到达*t*作为很久。（这是一个严重的过度简化，但对于一页的答案来说是可行的。）

因此，假设平均到达间隔时间为 λ。因为时间分布是指数的，我们知道我们可以用一个正态近似到达间隔时间分布，一个标准差 (1σ) 等于 √λ。所以，我们知道

*   大约 32% 的时间，两页的请求间隔小于 λ- √λ 秒。
*   大约 5% 的时间，两页的请求间隔小于 λ- 2√λ 秒。
*   不到 1% 的时间，两页的请求间隔小于 λ- 3√λ 秒。

确定您愿意接受的内容，并进行测试以确保您的 Web 系统能够维持该速率。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-19T01:12:07.107

补充一下查理所说的，一旦你有了一个工作负载模型，你就可以将它输入到你的系统模拟中，以确定你需要满足该负载的马力。有一些工具可以进行这种模拟：

*   [超形式](http://www.hyperformix.com/products/performance-optimizer)
*   [模拟](http://simpy.sourceforge.net/)
*   [维基百科的模拟工具列表](http://en.wikipedia.org/wiki/List_of_computer_simulation_software)

这东西不容易，商业工具会花你的钱。

您还可以尝试寻找与预期负载接近的基准，看看哪些系统可以为您提供所需的性能。[TPC 基准测试](http://www.tpc.org/)将是一个很好的起点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-18T22:21:52.800

我猜您的网络应用程序不是您所说的“服务器”和“数据库”的关键业务应用程序，否则您可能应该寻找一些冗余方法？

在工作中，我们有一些关于硬件的指导方针，最新的建议是服务器应该是 64 位，因为 SharePoint 14 看起来像一个仅 64 位的版本。

如果您负担得起，我建议 SQL 服务器应该是 64 位，因为大多数人都同意添加更多 RAM（4 Gb 以上）确实有回报。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-18T22:12:56.190

这实际上取决于您的 Web 应用程序需求和流量期望。

**在最初的几个月内，很少有网站需要一台以上合理的专用服务器。**如果你这样做了，那么你可能买得起更多的硬件；）

# eclipse - 有没有比内置工具更好的 Eclipse 重构工具？

> ID：379487
> 
> 赞同：7
> 
> 时间：2008-12-18T22:09:40.143
> 
> 标签：eclipse, refactoring

我知道 Visual Studio 有 re-sharper，但是是否有一个非常好的 Eclipse 重构工具，它比少量的内置重构更好？

最好是免费的东西。

（更新）

希望做一些事情，比如将所有字符串文字放在一个文件中并将它们设为常量。
以某种自动化方式解决大量 PMD 错误。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-07-19T15:24:34.587

我知道您更喜欢 Eclipse 的免费插件，但如果您喜欢 ReSharper 并且必须使用 Java，请查看 InteliJ IDEA [http://www.jetbrains.com/idea/index.html](http://www.jetbrains.com/idea/index.html)。它是 ReSharper 的原始灵感，也是由 JetBrains 开发的。我相信它具有与 RS 大部分相同的重构功能，并且还支持相同的键盘方案（如果您选择在 VS 中使用 inteliJ 方案。）如果您尝试过，请让我们 C# 的人知道它与您的 RS 体验相比如何.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-05-13T12:02:44.890

这并不能真正回答您的问题，但我无法将其正确格式化为评论。

这是在eclipse中将字符串提取为常量的好方法。（直到几周前我才知道挑选字符串）

我们有这一行：

```
System.out.println("This Line Contains a constant The 42 Constant that is stuck inside"); 
```

首先让我们用鼠标光标和 ctrl-1 + "pick out selected String" 标记所需的常量，结果是：

```
System.out.println("This Line Contains a constant " + "The 42 Constant" +" that is stuck inside"); 
```

现在您可以将鼠标光标放在挑选出的常量和 Alt+Shift+T 上，然后将生成常量 THE_42_CONSTANT 作为私有静态最终字符串的（提取常量）

```
private static final String THE_42_CONSTANT = "The 42 Constant";
...
...
System.out.println("This Line Contains a constant " + THE_42_CONSTANT+ " that is stuck inside"); 
```

希望这是您真正想要的，当然您可以为 eclipse 中的 aboe 操作调整热键

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-18T22:28:22.977

[Jackpot](http://wiki.netbeans.org/Jackpot)是一种内置于 javac 中的重构语言。它是 James Goslings 项目，并成为 Netbeans 重构模块的核心。它本质上是一种模式匹配语言，通过 AST 进行匹配。

有了它，您可以编写自己的模式。

**编辑**：将链接更改为更活跃的（Oracle 后）链接。我不知道这是否仍然是一个可行的独立项目，尽管 Netbeans 现在是 100% 开源的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-21T18:34:43.597

Checkstyle 之类的一些插件插入到快速修复框架中，并允许立即进行大规模修复。但是您要查找的内容应该插入现有的重构框架，而不是替换它。

# asp.net-mvc - 表单身份验证 + ASP.NET MVC 绝对 ReturnURL

> ID：379506
> 
> 赞同：11
> 
> 时间：2008-12-18T22:14:34.050
> 
> 标签：asp.net-mvc, forms-authentication

我在服务器 a 上有一个中央身份验证应用程序。服务器 b 在同一个域中有一个或多个应用程序需要从服务器 a 进行身份验证。设置它很容易，以便服务器 b 应用程序重定向到服务器 a。让 ReturnURL 成为绝对值并不容易。

这是皱纹。服务器 b 上的消费应用程序有两个控制器，一个是公共的，一个是安全的。如果将 [authorize] 装饰放在公共的操作（这是默认控制器）上，我会得到正确的绝对 URL。但是，如果它在它自己的控制器中，我会得到一个相对 URL。

我可以拦截消费应用程序中的预请求事件，但我需要网站的某些部分是公开的，而不是整个粉碎。

想法？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-12-18T22:43:26.847

如果请求未通过身份验证，标准 AuthorizeAttribute 的工作方式是将响应状态代码设置为 401。这会启动默认身份验证模块对未经授权的请求的标准响应。我假设您正在使用基于表单的身份验证，它将根据请求中的 url 构建返回 url。在这种情况下，可能是一个相对 URL。

您可以做的一件事是，您可以实现一个扩展 AuthorizeAttribute 类并覆盖 OnAuthorization 的 SSOAuthorizeAttribute，而不是依赖内置行为。然后，您可以从 Web 配置中的表单元素中提取 loginUrl 并构建您自己的 RedirectResult 并从 AuthorizationContext 参数中的 HttpContext.Request.Url.AbsoluteUri 属性中提取 returnUrl。

```
 public class SSOAuthorizeAttribute : AuthorizeAttribute
 {
      public override void OnAuthorization( 
                          AuthorizationContext filterContext )
      {
          if (filterContext == null)
          {
              throw new ArgumentNullException( "filterContext" );
          }

          if (!filterContext.HttpContext.User.Identity.IsAuthenticated)
          {
              // get from cached variable from web configuration
              string loginUrl = ... 
              if (filterContext.HttpContext.Request != null)
              {
                  loginUrl += "?ReturnUrl=" + filterContext.HttpContext
                                                           .Request
                                                           .Url
                                                           .AbsoluteUri;
              }

              filterContext.Result = new RedirectResult( loginUrl );
          }
      }
 } 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-24T21:05:54.647

假设表单身份验证，在服务器 B 应用程序 web.config 中，将表单标记上的 loginUrl 属性设置为控制器操作方法，该方法在重定向到服务器 A 之前附加绝对 url。

服务器 B 上的配置

```
<authentication mode="Forms">
  <forms loginUrl="/Account/LoginRedirect" />
</authentication> 
```

动作方法看起来像

```
 public RedirectResult LoginRedirect(string returnUrl)
    {
       var requestUrl = HttpContext.Current.Request.Url;
       return LoginUrlOnServerA + 
              "?returnUrl=" +          
              HttpUtility.UrlEncode(string.Format("http://{0}:{1}{2}",
                requestUrl.Host,
                requestUrl.Port,
                HttpUtility.UrlDecode(returnUrl)));
     } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-04T09:23:37.267

如[https://stackoverflow.com/a/583608/80589](https://stackoverflow.com/a/583608/80589)但更短：

```
public RedirectResult LogOn(string returnUrl)
{
  var r = new Uri(Request.Url, returnUrl).ToString();
  return Redirect("https://logonserver.com/?return_url=" + Url.Encode(r));
} 
```

# gpl - 这合法吗？（GPL 软件/许可问题）

> ID：379510
> 
> 赞同：21
> 
> 时间：2008-12-18T22:16:28.583
> 
> 标签：gpl

我在一家软件/设计公司工作，最近我发现我们的“内部”CMS 实际上是由我们的一位设计师重新设计的[MODx 。](http://modxcms.com/)MODx 在[GPL Ver 2](http://www.gnu.org/licenses/gpl-2.0.html)下获得许可。. 我想知道将其出售给客户是否合乎道德/合法。

我们还提供另一个实际上是[ZenCart](http://sourceforge.net/projects/zencart/)的包，这也合法吗？

我认为商业应用程序的软件需要是 LGPL，这些应用程序是否被“商业”使用？我们当然是把它们卖给客户，同时表现得好像它们是内部开发的......

我很想听听你对这个话题的想法/澄清，我觉得至少是不道德的。你怎么看？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-12-18T22:28:08.310

不要按照您在 StackOverflow 之类的论坛上阅读的任何法律建议采取行动——包括我的。:-)

这是来自 Wikipedia 的[一段](http://en.wikipedia.org/wiki/GPL#Terms_and_conditions)关于 GPL 的文章（重点是我的）：

> GPL 的条款和条件适用于收到应用了 GPL 的作品副本的任何人（“被许可人”）。任何遵守条款和条件的被许可人都被允许修改作品，以及复制和重新分发作品或任何衍生版本。被许可人 **可以为此服务收费，**或免费提供。后一点将 GPL 与禁止商业再分发的软件许可证区分开来。FSF 认为自由软件不应限制商业用途，而 GPL 明确规定 GPL 作品**可以以任何价格出售。**

但是，如果您的公司根据与 GPL 不兼容的另一个许可证分发软件，那么他们就违反了他们的许可证。

[ZenCart](http://sourceforge.net/projects/zencart/)也根据 GPL 获得许可，因此适用相同的限制。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-12-18T22:23:50.490

对于内部使用，你会没事的。

为了向客户销售，如果他们要求，您必须将源代码提供给他们，并确保他们知道他们有权获得源代码。

正如哈珀谢尔比建议的那样，您应该先与您的管理链交谈，然后再与您公司的律师交谈。如果他们不自行解决问题，那么您应该考虑联系自由软件基金会 ( [FSF](http://www.fsf.org/) ) 或软件自由法律中心 ( [SFLC](http://www.softwarefreedom.org/) )，也许还有这些软件包的作者。

最近在[Groklaw](http://www.groklaw.net/)上有一篇题为“ [FSFE 和 GPL-Violations.org 处理许可证违规的发布指南](http://www.groklaw.net/article.php?story=20081209091525428)”的帖子。 [FSFE](http://fsfeurope.org/)是欧洲自由软件基金会，[GPL-Violations.org](http://gpl-violations.org/)的目标是：

> gpl-violations.org 项目试图提高公众对 GPL 许可软件过去和现在侵权使用的认识。
> 
> 最终目标是让 GPL 许可软件的供应商了解 GPL 不是公共领域，并且需要满足许可条件。

有关 GPL 问题的另一个说明，请参阅 Dobbs CodeTalk 博士的“ [Stallman Calls Out Cisco - GPL Violations Alleged](http://dobbscodetalk.com/index.php?option=com_myblog&show=Stallman-Calls-Out-Cisco---GPL-Violations-Alleged.html&Itemid=29) ”。更多关于[Cisco 的 GPL 问题](http://www.sdtimes.com/link/33128)。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-18T22:26:17.473

出售修改版的 GPL（至少是 v2，我对 v3 不太熟悉）软件是完全合法的。但是，您仍然必须遵守许可条款 - 如果修改属于“衍生作品”的定义，您**必须**提供源代码，包括您的修改，从您的简短描述中他们似乎可以做到这一点。

Jonathan Leffler 的链接和建议很好，但我建议先向您的内部人员提及这些问题 - 至少在您释放猎犬之前让他们有机会做正确的事情。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-18T22:23:27.557

使用和销售任何 GPL 程序都是完全合法的。这就是 GPL 如此出色的部分原因。关于 GPL 唯一的事情是，如果他们对源代码进行更改，他们也必须将源代码作为 GPL 发布。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-12-18T22:29:00.120

如果他们将他人的作品冒充为自己的作品，那么无论法律地位如何，我个人都会认为这是非常不道德的。

从您自身利益的角度来看，这将是我匿名发布的一个。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-18T23:27:41.077

只要您将源代码提供给您的客户，并让他们自由阅读、修改和分发他们收到的代码，您就完全履行了许可协议。您还需要确保您的客户知道他们可以使用该软件做什么。处理您的客户许可证的文本和代码（或代码本身）的链接就可以了。

在 GPL 下修改和出售代码的做法是 FSF 明确批准的，您可以参考 GPL 官方 faq：

[http://www.gnu.org/licenses/gpl-faq.html#DoesTheGPLAllowMoney](http://www.gnu.org/licenses/gpl-faq.html#DoesTheGPLAllowMoney)

LGPL 与 GPl 不同，因为您可以混合使用 LGPL 代码和在封闭许可下发布的代码（据我所知，LGPL 是为库创建的，以便尽可能地传播免费软件的使用）。GPL 不允许与非 GPL 兼容许可下许可的代码链接。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-12-19T00:01:22.757

另一件需要注意的大事是，该公司是否正在用自己的版权声明替换 MODx 的版权声明。至于让管理层注意这一点，这取决于你的工作环境。他们会感谢你指出潜在的法律问题，还是责怪你造成了巨大的法律混乱？

如果*JohnClaymore*是您的真实姓名或可轻松与您的真实身份相关联的别名，那么如果您将此引起管理层的注意，您很可能会被解雇，因为在此处发布您的问题已经创造了支持故意侵权指控的潜在证据，这会增加三倍版权诉讼中判给的任何损害赔偿。

IANAL，这不是法律建议，等等，等等，等等……

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-19T17:36:00.300

我不知道法律方面的情况，但我认为将开源软件当成是贵公司内部开发的东西来销售是*非常*不道德的，而它只是开源项目的一个模式。

现在，如果您要销售服务和支持，例如“我们将负责为您的网站供电并保持其正常运行”，那么情况就不同了。
我的意思是，如果客户可能没有很多（或任何）人拥有关于运行网站的技术知识，那么他们是否知道您使用开源系统并没有太大区别，因为他们仍然不会不知道如何使用它来运行网站。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-19T17:39:21.307

你说的没有违法的。但是，当您的公司分发（销售）软件时，它必须

*   使用与未修改程序相同的许可分发修改后的程序。
*   履行您作为 GPL 下的分销商的所有义务。通常，这意味着您的客户必须能够以这样一种方式访问​​源代码，以便他们可以根据需要自行构建可执行文件。

当然，贵公司的法律部门应该意识到这种情况。如果没有，他们应该意识到这一点。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-18T22:55:34.793

在公司呆了一段时间的人的表现如何？例如，他们是否认真确保 GPL 的条款得到满足？还是他们表现得好像他们正在对他们的客户或软件（预）开发人员进行快速处理？他们是否表现得像法律专家，不需要咨询律师？

这个测试不是决定性的，但它可以很有启发性。

# vb.net - 在 VB.NET 中使用 WebRequest 将 URL 保存为图像缩略图

> ID：379512
> 
> 赞同：1
> 
> 时间：2008-12-18T22:17:06.977
> 
> 标签：vb.net, webrequest

我正在尝试编写一个简单的例程，在其中将 URL 传递给它，然后它将 webresponse 的内容呈现为 jpg。我在 C# 中找到了一个解决方案并将其移植到 vb.net，但是当我运行它时，它会在尝试实例化图像时抛出一个参数异常“参数无效”。有人可以看看下面的代码，让我知道我是否在正确的轨道上？

```
Sub SaveUrl(ByVal aUrl As String)
    Dim response As WebResponse
    Dim remoteStream As Stream
    Dim readStream As StreamReader
    Dim request As WebRequest = WebRequest.Create(aUrl)
    response = request.GetResponse
    remoteStream = response.GetResponseStream
    readStream = New StreamReader(remoteStream)
    Dim img As System.Drawing.Image = System.Drawing.Image.FromStream(remoteStream)
    img.Save(aUrl & ".jpg", System.Drawing.Imaging.ImageFormat.Jpeg)
    response.Close()
    remoteStream.Close()
    readStream.Close()
End Sub 
```

**澄清：** 是的，我知道我需要更多代码来完成我想做的事情，即渲染/截取 URL（html、图像、所有标记、所有内容）并将其保存为 jpg缩略图。

如果您使用过 Google Chrome，您会看到包含您经常使用的所有网站的缩略图的启动页面。类似的东西。

**更新：** 好的，我找到了商业付费产品来实现这一点，比如[http://www.websitesscreenshot.com/Index.html](http://www.websitesscreenshot.com/Index.html)但没有开源实现。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-18T22:23:08.167

仅仅因为 Image 类有一个`.FromStream()`方法并不意味着*任何*流都是有效的图像，来自 Web 服务器的 html 响应肯定不是有效的图像。渲染网页不是“简单的例程”。有很多内容。

您可以尝试使用 WebBrowser 控件，因为它可以为您完成很多工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-19T17:48:20.837

我刚刚[在 ActiveVB 上找到了一个德语代码片段，](http://activevb.de/cgi-bin/tippupload/preview.pl?type=vbc&tippnr=289)它创建了一个网站的屏幕截图。也许您可以在此基础上再接再厉？不幸的是，代码不仅用德语解释，而且用 VB6 解释。尽管如此，逻辑本质上是相同的，移植到 .NET 应该不难。希望有帮助。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-18T23:03:35.493

好吧，要么：

```
My.Computer.Network.DownloadFile("http://example.com/file.jpeg", "local.jpeg") 
```

或者，要*创建*缩略图：

```
Using wc As New Net.WebClient()
    Dim img = Image.FromStream(wc.OpenRead("http://example.com/file"))
    img.GetThumbnailImage(32, 32, Function() False, Nothing).Save("c:\local.jpg")
End Using 
```

…也许添加一些错误处理。;-)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-18T22:23:06.963

你想做什么？

您是否正在尝试将网页转换为 JPEG？这将需要更多代码，因为您的代码试图做的是下载已经存在的图像（例如 gif、png 甚至另一个 jpeg）并将其转换为 jpeg。您需要渲染 HTML 文档，然后需要捕获渲染文档的图像，然后将其保存为 JPEG。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-18T22:24:39.147

它可能更容易使用`System.Net.WebClient`，我认为您可以删除除 2 或 3 行代码之外的所有代码。IE：`WebClient.DownloadFile()`

[MSDN 页面](http://msdn.microsoft.com/en-us/library/system.net.webclient(VS.80).aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-18T22:43:18.857

我知道您要的是 VB，但这里有一些 C# 代码，我在我的一个项目中使用这些代码从图像 URL（异步）中捕获本地缩略图。我试图去掉所有特定于项目的东西，所以它作为一个独立的例子是有意义的。

```
var wc = new WebClient();
wc.CachePolicy = new RequestCachePolicy(RequestCacheLevel.NoCacheNoStore);
wc.DownloadDataCompleted += wc_DownloadDataCompleted;

wc.DownloadDataAsync(imageProvider.Image, "yourFilenameHere"); 
```

这是 wc_DownloadDataCompleted 事件处理程序：

```
private void wc_DownloadDataCompleted(object sender, DownloadDataCompletedEventArgs e)
{
    if (e.Error == null && !e.Cancelled)
    {
        var filename = e.UserState.ToString();

        using (var ms = new MemoryStream(e.Result))
        {
            var bi = new BitmapImage();
            bi.BeginInit();
            bi.StreamSource = ms;
            bi.DecodePixelWidth = 80; // _maxThumbnailWidth;
            bi.EndInit();

            var encoder = new JpegBitmapEncoder();
            encoder.Frames.Add(BitmapFrame.Create(bi));
            var filename = Path.Combine(_thumbFolder, filename);
            try
            {
                using (var fs = new FileStream(filename, FileMode.Create))
                {
                    encoder.Save(fs);
                }
            }
            catch { }
        }
    }
} 
```

**编辑**

我想我应该补充一点，这是在 WPF 应用程序中 - 因此使用“BitmapImage”和“BitmapFrame”来解码流。所以它可能对你没有帮助。反正我要把它留在这里。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-09-08T12:17:46.523

或者你可以这样做：

```
 Dim webclient As New Net.WebClient

    Dim FileName As String = "C:\Share\local.Gif"
    webclient.DownloadFile(URI, FileName)
    PictureBox1.Image = Image.FromFile(FileName) 
```

# wcf - 没有证书的 WCF 用户名

> ID：379526
> 
> 赞同：6
> 
> 时间：2008-12-18T22:22:41.597
> 
> 标签：wcf, authentication, authorization, certificate, x509

我正在做一个需要以下内容的项目。

*   服务器端的 WCF 服务 (.NET 3.5)
*   客户端的 WPF 客户端 (.NET 3.0)

我有一个现有的应用程序，我必须使用（在服务器端）的身份验证和授权。我还需要在 WCF 服务的线程主体（站点对象）中存储一些关于用户的元数据。我这样做是为了在必要时可以在 WCF 服务中使用它；一些业务逻辑可能需要它。所以我的计划是做以下......

为服务器创建一个自定义 ServiceAuthorizationManager，我将在其中登录用户并从现有应用程序中获取角色。我将缓存“站点”对象，并根据进一步的请求从缓存中提取。我还需要一个 CustomPrincipal 对象来保存我的自定义数据。我想模拟用户，以便可以使用 WCF 中的内置角色过滤，如下所示：

```
[PrincipalPermission(SecurityAction.Demand, Role = "Role1")]
public string[] RolesForUser(string username){} 
```

我尝试将 ASP.NET 授权与自定义角色提供程序一起使用，但无法在 Current Principal 上设置任何内容。我还尝试使用自定义 IAuthorizationPolicy，但出现了问题。这些问题涉及能够使用 WCFClient.exe 应用程序，当它发现（使用 mex 端点）时，它不会提供任何凭据，因此登录会失败。我最终决定 ServiceAuthorizationManager 是正确的方法，但我愿意接受其他建议。

在客户端上，我将收集凭据并将它们放入 WCF 代理类，如下所示。

```
proxy.ChannelFactory.Credentials.UserName.UserName = userName;
proxy.ChannelFactory.Credentials.UserName.Password = password; 
```

当我开始走这条路时，我注意到我无法在我的管理器类的 CheckAccessCore 方法中获取用户名/密码。进一步调查表明，我真的应该在自定义 UserNamePasswordValidator 中进行身份验证。所以我创造了其中之一。问题是 validate 方法从未被调用过。

进一步调查表明，为了调用 validate 方法，我的 WCF 服务必须具有消息或传输级别的安全性。问题是我无法弄清楚如何在没有[X.509](https://en.wikipedia.org/wiki/X.509)证书的情况下获得消息或传输级别的安全性。该产品将进入数百台令人难以置信的锁定机器，并且无法安装证书。

有没有办法在不安装证书的情况下完成我的要求？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-15T16:22:38.737

实际上这是可能的，但您需要实现自己的绑定。

Yaron Naveh 开发了一个 WCF 绑定，可以通过 HTTP 启用明文用户名/密码。他的[文章](http://webservices20.blogspot.com/2008/11/introducing-wcf-clearusernamebinding.html)包括绑定的代码。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-18T22:33:16.897

简短的回答；你不能。一旦您使用用户名/密码，您就需要某种安全通道。

但是，您不需要客户端上的证书；仅在服务器上。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-01-22T03:04:58.570

我不知道您的网络基础架构的详细信息，但如果您在 Windows 域中，您应该考虑使用 Windows 凭据。

如果您使用 Windows 凭据，则可以使用没有证书的消息安全性。这是 wsHttpBinding 的默认行为（开箱即用）。

使用开箱即用的解决方案（不实现您自己的绑定） WCF 鼓励（要求）您在消息中包含身份验证凭据时使用安全通道。

使用允许您以明文形式指定凭据的自定义绑定肯定是一种解决方案，但在使用它之前我会三思而后行。

# ruby - 在 Ruby 中，如何在不通过 DNS 的情况下获得他们的 IP 字节？

> ID：379530
> 
> 赞同：0
> 
> 时间：2008-12-18T22:23:20.130
> 
> 标签：ruby, sockets, ip-address

在我的某些系统上，我可以通过以下方式获取我的 IP 地址（192.68.mn 格式）：

```
addr = IPSocket::getAddress(Socket.gethostname()) 
```

...问题在于，这仅在本地计算机为自己使用的名称是 DNS 服务器与其关联的名称时才有效。

*&#( ruby​​ 只返回其主接口的 IP 地址有多难？我必须以独立于平台的方式执行此操作，或者我只需调用 ifconfig 或 ipconfig 并解析它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-18T22:30:04.813

看到[这个问题](https://stackoverflow.com/questions/42566/getting-the-hostname-or-ip-in-ruby-on-rails)。还`see Socket.getaddrinfo()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-23T21:44:45.997

这个怎么样

```
require 'socket'
ipaddr = UDPSocket.open {|s| s.connect('65.59.196.211'); s.addr.last } 
```

IP 地址可以是任何真实的（这是我为 stackoverflow.com 获得的），但它应该是您想要获取 IP 地址的接口上可访问的 IP 地址。由于它是一个 UDP 套接字，实际上没有尝试连接，但它会尝试找出要使用的接口。

# wordpress - 有没有办法以编程方式从 WordPress 中的插件启用小部件？

> ID：379533
> 
> 赞同：3
> 
> 时间：2008-12-18T22:24:04.373
> 
> 标签：wordpress, plugins, widget

我有一个为 wordpress 编写的插件，我需要启用 Pages 小部件才能使一切正常工作。如果我可以在插件中自己启用它而不是要求用户这样做，那就太好了。

你知道这样做的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-19T22:03:00.853

不完全确定您的小部件如何工作，但您可以通过将其添加到选项表来自动启用页面小部件，但您必须添加代码才能读取小部件存储类型，然后确定页面小部件是否可用在正确的侧边栏中（您没有说是否必须在主题内的同一侧边栏中启用小部件，但我猜它确实如此）。然后，您还必须确定在侧边栏中相对于其他页面小部件的位置，因为位置是 wp 管理员通常在小部件管理工具上所做的事情。

也就是说，我认为你最好的选择是让你的小部件要么引发错误，要么在它没有在运行时成功所需的东西时安静地失败。您应该能够向小部件配置添加文本，以在管理小部件工具中显示有关页面小部件依赖关系的消息。这是否可以轻松地动态完成，我还没有真正研究过。

# html - 是否有一个工具可以找到具有在 CSS 中没有相应类的类属性的 html 标签？

> ID：379536
> 
> 赞同：1
> 
> 时间：2008-12-18T22:25:35.087
> 
> 标签：html, css

我发现[http://www.sitepoint.com/dustmeselectors/](http://www.sitepoint.com/dustmeselectors/)与我想要的相反，识别 CSS 中未在 HTML 中使用的选择器。

我想要一个工具来查找具有类属性但该类未在页面加载的任何 CSS 中定义的元素。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-19T00:14:03.260

如果 CSS 文件在您的页面中正确链接并且是您项目的一部分，那么在 VS.NET 2008 中它会给您一个标准的小曲线警告。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-18T22:32:48.113

没有我知道的工具。

似乎是短节目的好候选人，因为您可能不需要经常这样做。

我会`class="someclass"`从我的源 html 中正则表达式，使用 Firefox 中的 Web 开发人员工具栏来连接我所有的 CSS，然后正则表达式输出 `.someclass'，然后比较两个列表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-19T00:08:22.663

您可以在 css 文件中使用文本编辑器查找您在 HTML 中找到的类。

# propel - 在重构代码之前你会考虑什么？

> ID：379540
> 
> 赞同：4
> 
> 时间：2008-12-18T22:26:29.500
> 
> 标签：propel, refactoring, amfphp

我有一个刚刚发布的应用程序。自从我写了它，我就了解了 amfphp 和 propel。两者都可以在应用程序中使用，但我不能说此时需要它。

在重构代码之前，您会考虑哪些类型的事情？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-18T22:28:54.893

重构后进行单元测试以检查代码。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-18T22:29:41.240

所需的努力与获得的收益以及它与其他工作的优先级。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-18T23:43:40.467

我是不是该？

仅仅因为我*可以*重构代码并不意味着我*应该*重构代码。在很多很多情况下，还有更重要的事情需要做。就像修复缺陷一样。

现在，如果我们谈论重构代码，因为我已经在那个特定的代码块中，并且作为缺陷解决或代码维护的一部分来处理它，那完全是另一回事。但是仅仅为了重构而重构？这听起来像是因为无聊而忙碌的工作。当然，您没有空的缺陷列表。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-18T22:34:17.190

重构代码的可维护性如何。后见之明是 20/20，但对于已发货的产品，优雅但神秘的设计可能是维护的噩梦。此外，重构设计中的灵活性以允许功能增强也非常重要。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-19T00:02:02.147

我破坏现有功能的可能性有多大？单元测试在这里是一个很好的安全网，自动重构工具也是如此。

之后代码真的会更容易理解和维护吗？这可能是一个很难回答的问题，需要经验才能更好地回答。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-18T22:35:17.517

在源代码管理中为当前生产代码库创建一个分支，并在源代码管理的实验分支中进行所有重构。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-18T22:47:01.893

单元测试会非常好，但是如果单元测试没有覆盖代码，你应该有一些其他的方法来确保你不会破坏代码。如果您能够获得生产数据库的副本，甚至可能是一些实时产品输入，那么您应该有一个公平的机会。

在一个 privious 项目中，我们实际上记录了 14 天的所有传入数据，并在这 14 天的开始和结束时保存了 prod db 的快照，然后我们能够使用旧代码和新代码比较数据库的状态. 但是单元测试肯定会消除一些恐惧:-)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-18T23:27:30.140

我嗅探代码。如果我不喜欢这种气味（换句话说，它闻起来不像我），那么我会在它身上撒尿，直到我喜欢它为止。

由于软件技术需要很酷的名字，比如敏捷或设计模式，我称之为犬重构。

重写代码后，我自己使用了一段时间，吃我自己的狗粮。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-19T00:48:39.027

我必须给Drejc +1。不重构的最主要原因是你没有单元测试。但即使这样也不意味着你不应该重构。我应该说，我的作案方式首先是代码功能，然后总是重构以处理设计债务。重复令人作呕。

“足够好”的模式可能是地球上最常用的编程方法，这也是我们的软件有缺陷和混乱的原因之一。我们总是选择最少能量的“步”，而不是选择能量最少的“路径”。

但是，当心！没有适当工具的重构（这将取决于语言和 IDE）就像敲钉子一样：您可以到达那里，但它不会有效（并且您可能会遇到麻烦）。

# haskell - 将 monad 限制为类型类

> ID：379546
> 
> 赞同：15
> 
> 时间：2008-12-18T22:28:16.063
> 
> 标签：haskell, types, monads, typeclass

在 Haskell 中，有没有办法限制 monad`M a`以`a`满足类型类约束？

我正在将[概率建模示例](http://github.com/namin/spots/tree/master/probabilisticModeling/README.markdown)从[F#](http://github.com/namin/spots/tree/master/probabilisticModeling/probabilisticModeling.fsx)转换为[Haskell](http://github.com/namin/spots/tree/6c5a3b78e8f5f559900bade7629fab0edcf225e8/probabilisticModeling/probabilisticModeling.hs)。但是，在 Haskell 中，我省略了，`support`因为它会更改`data Distribution a`为`data (Ord a) => Distribution a`. 通过此更改，我收到以下错误：

```
...probabilisticModeling.hs:42:13:
    Could not deduce (Ord a) from the context ()
      arising from a use of `always'
                   at ...probabilisticModeling.hs:42:13-18
    Possible fix:
      add (Ord a) to the context of the type signature for `return'
    In the expression: always
    In the definition of `return': return = always
    In the instance declaration for `Monad Distribution' 
```

实际上，`always`/的类型`return`是：`(Ord a) => a -> Distribution a`。有没有办法让我拥有一个 monad `Distribution`，但强制限制`(Ord a)`这个 monad？我试过：

```
instance Monad Distribution where
    (>>=) = bind
    return :: (Ord a) => a -> Distribution a = always 
```

但我得到了错误：

```
...probabilisticModeling2.hs:48:4:
    Pattern bindings (except simple variables) not allowed in instance declarations
      return :: (Ord a) => a -> Distribution a = always
Failed, modules loaded: none. 
```

所以它有一种方法可以有一个 monad `M a`，但是`a`用一个约束来限制`Ord a`?

谢谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-19T01:04:39.900

看来我在 Haskell 中遇到了一个众所周知的问题。我通过[谷歌搜索“restricted monads”](http://www.google.ch/search?q=restricted+monads)[找到了许多解决方法](http://delicious.com/adnamin/haskell+restricted+monads)。[这种解决方案](http://hsenag.livejournal.com/11803.html)似乎破坏性最小。不过，就我的目的而言，这似乎有点过头了。正如 Revolucent 所建议的那样，我想我会保持monad 的通用性，并通过受限功能简化支持。`Distribution`

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-12-18T22:53:42.410

我对此的理解是您根本不能，因为 monad 旨在泛化所有类型，而不是某些类型的受限子集，例如`(Ord a)`.

您可以简单地限制使用该单子类型的函数，而不是限制`M a`单子类型，例如，

```
foo :: Ord a => Int -> M a
```

事实上，最好保持类型尽可能通用，并且只使用类型类来限制功能。

等等

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-19T01:27:59.837

查看[Martin Erwig 的图书馆，PFP](http://web.engr.oregonstate.edu/~erwig/pfp/)：

> The PFP library is a collection of modules for Haskell that facilitates probabilistic functional programming, that is, programming with stochastic values. The probabilistic functional programming approach is based on a data type for representing distributions. A distribution represent the outcome of a probabilistic event as a collection of all possible values, tagged with their likelihood.

# java - Java：将一个列表拆分为两个子列表？

> ID：379551
> 
> 赞同：36
> 
> 时间：2008-12-18T22:29:37.903
> 
> 标签：java, list

在 Java 中将 List 拆分为两个子 List 的最简单、最标准和/或最有效的方法是什么？改变原始列表是可以的，所以不需要复制。方法签名可以是

```
/** Split a list into two sublists. The original list will be modified to
 * have size i and will contain exactly the same elements at indices 0 
 * through i-1 as it had originally; the returned list will have size 
 * len-i (where len is the size of the original list before the call) 
 * and will have the same elements at indices 0 through len-(i+1) as 
 * the original list had at indices i through len-1.
 */
<T> List<T> split(List<T> list, int i); 
```

[EDIT]`List.subList`返回原始列表上的视图，如果修改原始列表，则该视图无效。所以`split`不能使用`subList`，除非它也免除了原始参考（或者，如 Marc Novakowski 的回答，使用`subList`但立即复制结果）。

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2008-12-19T00:44:27.880

快速半伪代码：

```
List sub=one.subList(...);
List two=new XxxList(sub);
sub.clear(); // since sub is backed by one, this removes all sub-list items from one 
```

它使用标准的 List 实现方法，避免了所有的循环运行。clear() 方法还将`removeRange()`对大多数列表使用内部方法，并且效率更高。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2012-05-17T11:44:41.053

您可以使用常用实用程序，例如 Guava 库：

```
import com.google.common.collect.Lists;
import com.google.common.math.IntMath;
import java.math.RoundingMode;

int partitionSize = IntMath.divide(list.size(), 2, RoundingMode.UP);
List<List<T>> partitions = Lists.partition(list, partitionSize); 
```

结果是一个包含两个列表的列表 - 不完全符合您的规范，但如果需要，您可以轻松调整。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-18T23:01:08.243

在[Marc 的解决方案中](https://stackoverflow.com/questions/379551/java-split-a-list-into-two-sub-lists#379584)，这个解决方案使用一个`for`循环来保存一些调用`list.size()`：

```
<T> List<T> split(List<T> list, int i) {
    List<T> x = new ArrayList<T>(list.subList(i, list.size()));
    // Remove items from end of original list
    for (int j=list.size()-1; j>i; --j)
        list.remove(j);
    return x;
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-18T22:40:34.060

使用 subList 方法获取返回的数组非常简单，但是我知道没有简单的方法可以从 List 中删除一系列项目。

这是我所拥有的：

```
<T> List<T> split(List<T> list, int i) {
    List<T> x = new ArrayList<T>(list.subList(i, list.size()));
    // Remove items from end of original list
    while (list.size() > i) {
        list.remove(list.size() - 1);
    }
    return x;
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-01-27T10:57:33.433

我需要类似的东西，所以这是我的实现。它允许调用者指定应该返回 List 的哪个实现：

```
package com.mrojas.util;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

public class ListUtils {

/**
 * Splits a list into smaller sublists.
 * The original list remains unmodified and changes on the sublists are not propagated to the original list.
 *
 *
 * @param original
 *            The list to split
 * @param maxListSize
 *            The max amount of element a sublist can hold.
 * @param listImplementation
 *            The implementation of List to be used to create the returned sublists
 * @return A list of sublists
 * @throws IllegalArgumentException
 *             if the argument maxListSize is zero or a negative number
 * @throws NullPointerException
 *             if arguments original or listImplementation are null
 */
public static final <T> List<List<T>> split(final List<T> original, final int maxListSize,
        final Class<? extends List> listImplementation) {
    if (maxListSize <= 0) {
        throw new IllegalArgumentException("maxListSize must be greater than zero");
    }

    final T[] elements = (T[]) original.toArray();
    final int maxChunks = (int) Math.ceil(elements.length / (double) maxListSize);

    final List<List<T>> lists = new ArrayList<List<T>>(maxChunks);
    for (int i = 0; i < maxChunks; i++) {
        final int from = i * maxListSize;
        final int to = Math.min(from + maxListSize, elements.length);
        final T[] range = Arrays.copyOfRange(elements, from, to);

        lists.add(createSublist(range, listImplementation));
    }

    return lists;
}

/**
 * Splits a list into smaller sublists. The sublists are of type ArrayList.
 * The original list remains unmodified and changes on the sublists are not propagated to the original list.
 *
 *
 * @param original
 *            The list to split
 * @param maxListSize
 *            The max amount of element a sublist can hold.
 * @return A list of sublists
 */
public static final <T> List<List<T>> split(final List<T> original, final int maxListSize) {
    return split(original, maxListSize, ArrayList.class);
}

private static <T> List<T> createSublist(final T[] elements, final Class<? extends List> listImplementation) {
    List<T> sublist;
    final List<T> asList = Arrays.asList(elements);
    try {
        sublist = listImplementation.newInstance();
        sublist.addAll(asList);
    } catch (final InstantiationException e) {
        sublist = asList;
    } catch (final IllegalAccessException e) {
        sublist = asList;
    }

    return sublist;
} 
```

}

还有一些测试用例：

```
package com.mrojas.util;

import static org.junit.Assert.assertEquals;
import static org.junit.Assert.assertTrue;

import java.util.ArrayList;
import java.util.Collections;
import java.util.LinkedList;
import java.util.List;

import org.junit.Test;

public class ListUtilsTest {

@Test
public void evenSplitTest() {
    final List<List<Object>> sublists = ListUtils.split(getPopulatedList(10), 2, LinkedList.class);
    assertEquals(5, sublists.size());
    for (final List<Object> sublist : sublists) {
        assertEquals(2, sublist.size());
        assertTrue(sublist instanceof LinkedList<?>);
    }
}

@Test
public void unevenSplitTest() {
    final List<List<Object>> sublists = ListUtils.split(getPopulatedList(10), 3, LinkedList.class);
    assertEquals(4, sublists.size());

    assertEquals(3, sublists.get(0).size());
    assertEquals(3, sublists.get(1).size());
    assertEquals(3, sublists.get(2).size());
    assertEquals(1, sublists.get(3).size());
}

@Test
public void greaterThanSizeSplitTest() {
    final List<List<Object>> sublists = ListUtils.split(getPopulatedList(10), 20, LinkedList.class);
    assertEquals(1, sublists.size());
    assertEquals(10, sublists.get(0).size());
}

@Test
public void emptyListSplitTest() {
    final List<List<Object>> sublists = ListUtils.split(Collections.emptyList(), 10, LinkedList.class);
    assertEquals(0, sublists.size());
}

@Test(expected=IllegalArgumentException.class)
public void negativeChunkSizeTest() {
    ListUtils.split(getPopulatedList(5), -10, LinkedList.class);
}

@Test
public void invalidClassTest() {
    final List<List<Object>> sublists = ListUtils.split(getPopulatedList(10), 2, LinkedList.class);
    assertEquals(5, sublists.size());
    for (final List<Object> sublist : sublists) {
        assertEquals(2, sublist.size());
        assertTrue(sublist instanceof LinkedList<?>);
    }
}

private List<Object> getPopulatedList(final int size) {
    final List<Object> list = new ArrayList<Object>(10);
    for (int i = 0; i < 10; i++) {
        list.add(new Object());
    }

    return list;
} 
```

}

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-06-20T23:55:10.410

```
import java.util.Collection;

public class CollectionUtils {

  /**
   * Will split the passed collection so that the size of the new collections
   * is not greater than maxSize
   * @param t
   * @param maxSize
   * @return a List containing splitted collections
   */

  @SuppressWarnings("unchecked")
  public static <T> List<Collection<T>>split(Collection<T> t, int maxSize) {
    int counter = 0;
    List<Collection<T>> ret = new LinkedList<Collection<T>>();
    Iterator<T>itr = t.iterator();
    try {
      Collection<T> tmp = t.getClass().newInstance();
      ret.add(tmp);
      while(itr.hasNext()) {
        tmp.add(itr.next());
        counter++;
        if(counter>=maxSize && itr.hasNext()) {
          tmp = t.getClass().newInstance();
          ret.add(tmp);
          counter=0;
        }
      }
    } catch(Throwable e) {
      Logger.getLogger(CollectionUtils.class).error("There was an error spliting "+t.getClass(),e);
    }
    return ret;
  }

}

// JUnit test cases

import java.util.ArrayList;

/**
 *
 * $Change$
 * @version $Revision$
 * Last modified date & time $DateTime$
 */
public class CollectionUtilsTest {

  @Test
  public void testSplitList() {
    List<Integer>test = new ArrayList<Integer>(100);
    for (int i=1;i<101;i++) {
      test.add(i);
    }
    List<Collection<Integer>> tests = CollectionUtils.split(test, 10);
    Assert.assertEquals("Size mismatch", 10,tests.size());

    TreeSet<Integer> tmp = new TreeSet<Integer>();
    for(Collection<Integer> cs:tests) {
      for(Integer i:cs) {
        Assert.assertFalse("Duplicated item found "+i,tmp.contains(i));
        tmp.add(i);
      }
      System.out.println(cs);
    }
    int why = 1;
    for(Integer i:tmp) {
      Assert.assertEquals("Not all items are in the collection ",why,i.intValue());
      why++;
    }
  }
  @Test
  public void testSplitSet() {
    TreeSet<Integer>test = new TreeSet<Integer>();
    for (int i=1;i<112;i++) {
      test.add(i);
    }
    List<Collection<Integer>> tests = CollectionUtils.split(test, 10);
    Assert.assertEquals("Size mismatch", 12,tests.size());

    TreeSet<Integer> tmp = new TreeSet<Integer>();
    int cI = 0;
    for(Collection<Integer> cs:tests) {
      for(Integer i:cs) {
        Assert.assertFalse("Duplicated item found "+i,tmp.contains(i));
        tmp.add(i);
      }
//      if(cI>10) {
        System.out.println(cs);
//      }
      cI++;
    }
    int why = 1;
    for(Integer i:tmp) {

      Assert.assertEquals("Not all items are in the collection ",why,i.intValue());
      why++;
    }
  }
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2015-11-03T09:37:08.827

我使用“ [Apache Commons Collections 4](https://commons.apache.org/proper/commons-collections/) ”库。它在 ListUtils 类中有一个分区方法：

```
...
int targetSize = 100;
List<Integer> largeList = ...
List<List<Integer>> output = ListUtils.partition(largeList, targetSize); 
```

此方法改编自[http://code.google.com/p/guava-libraries/](http://code.google.com/p/guava-libraries/)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-19T12:43:53.617

```
<T> List<T> split(List<T> list, int i) {
   List<T> secondPart = list.sublist(i, list.size());
   List<T> returnValue = new ArrayList<T>(secondPart());
   secondPart.clear(),
   return returnValue;
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-04-26T13:21:11.023

将列表拆分为特定大小列表的通用函数。我在 java 集合中很长时间都错过了这个。

```
private List<List<T>> splitList(List<T> list, int maxListSize) {
        List<List<T>> splittedList = new ArrayList<List<T>>();
        int itemsRemaining = list.size();
        int start = 0;

        while (itemsRemaining != 0) {
            int end = itemsRemaining >= maxListSize ? (start + maxListSize) : itemsRemaining;

            splittedList.add(list.subList(start, end));

            int sizeOfFinalList = end - start;
            itemsRemaining = itemsRemaining - sizeOfFinalList;
            start = start + sizeOfFinalList;
        }

        return splittedList;
    } 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-19T01:08:18.067

同样抄袭 Marc 的列表，我们将使用 List.removeAll() 从第二个列表中删除重复的条目。请注意，严格来说，这仅在原始列表不包含重复项目时才遵循规范：否则，原始列表可能会丢失项目。

```
<T> List<T> split(List<T> list, int i) {
        List<T> x = new ArrayList<T>(list.subList(i, list.size()));
        // Remove items from end of original list
        list.removeAll(x);
        return x;
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-03-18T20:20:16.700

用于拆分列表的示例 java 代码

```
public List<List<Long>> split(List<Long> list, int i ){

    List<List<Long>> out = new ArrayList<List<Long>>();

    int size = list.size();

    int number = size/i;
    int remain = size % i; 
    if(remain != 0){
        number++;
    }

    for(int j=0; j < number; j++){
        int start  = j * i;
        int end =  start+ i;
        if(end > list.size()){
            end = list.size();
        }
        out.add(list.subList(start, end));
    }

    return out;
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-09-30T20:20:23.950

我的解决方案：

```
List<X> listToSplit = new ArrayList<X>();

List<X> list1 = new ArrayList<X>();
List<X> list2 = new ArrayList<X>();

for (X entry : listToSplit)
{
    if (list1.size () > list2.size ())
        list2.add (entry);
    else
        list1.add( entry );
} 
```

应该管用 ：）

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-01-10T07:24:14.893

```
//Here is my list
    ArrayList<T> items=new ArrayList<T>();
    Integer startIndex = 0;
            int j = 0;
            for (; j < items.size() - 1; j++) {//always start with next index not again 0
                for (int i = 0; i < 4; i++) { // divide into equal part with 4 item
                    startIndex = startIndex + 1;
                    j = startIndex;
                }
            } 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-08-13T21:07:58.073

使用流的解决方案，对每个项目使用切换/翻转布尔值进行分区：

```
Collection<String> big = ...;
AtomicBoolean switcheroo = new AtomicBoolean();
Map<Boolean, List<String>> subLists = big.stream()
        .collect(Collectors.partitioningBy(o -> switcheroo.getAndSet(!switcheroo.get()))); 
```

你最终得到一个包含两个条目的映射，键是`true`和`false`值是子列表。

这并不能完全回答原始问题，但您可以使用`AtomicInteger`每次递增的 an，而不是`AtomicBoolean`.

# c# - 在正在运行的进程中获取类的实例

> ID：379552
> 
> 赞同：2
> 
> 时间：2008-12-18T22:29:37.997
> 
> 标签：c#

使用 C#，有没有办法挂钩到正在运行的应用程序（我自己的应用程序）并获取一个类的实例？就目前而言，我正在这样做

```
// Find the IAutomation interface.
Type[] types = assembly.GetTypes();

foreach (Type type in types)
{
    if (!type.IsAbstract && type.GetInterface("IAutomation") != null)
        automation = (IAutomation)Activator.CreateInstance(type);
} 
```

这每次都会创建一个新的应用程序实例。我不想要一个单例应用程序！我想附加到现有实例（如果存在）并从那里取出 IAutomation。

这甚至可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-22T09:20:10.767

您可以使用[远程处理](http://msdn.microsoft.com/en-us/library/kwdt6w2k(VS.85).aspx)，或将现有实例设为 COM 服务器，并使用 COM 与现有实例互操作。

也许您也可以使用一些调试 API，但我不会认为它们是干净的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-18T22:33:59.437

如果 AppDomain 中存在 IAutomation 接口的现有实例，则必须有指向它的东西，否则它将被垃圾收集。因此，您需要确定指向实例的内容并使用它来获取实例。您应该问自己以下问题：谁创建了实例？可能是这个对象持有引用。

# sql - Oracle/SQL 中的时间片

> ID：379556
> 
> 赞同：5
> 
> 时间：2008-12-18T22:30:02.270
> 
> 标签：sql, oracle, optimization, reporting, graphing

我有一个很大的 Oracle 表，其中包含表示工作单元的行，除了其他元数据之外，还有开始时间和结束时间的列。

给定一些任意过滤标准和报告时间段，我需要从这些数据中生成使用图。例如，给我看一张爱丽丝在上周二早上 7:00 开始的 24 小时内所有工作的图表。每个 DB 行将在图中垂直堆叠。

我可以通过查询所有可能相关的行、将每行时间切片到 1 分钟的存储桶中并绘制结果来用高级语言来做到这一点。但是有没有一种有效的方法可以在 SQL 中进行时间切片？或者是否有现有的 Oracle 技术可以做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-19T09:05:52.690

在获取数据方面，您可以使用“分组依据”和“[截断](http://www.techonthenet.com/oracle/functions/trunc_date.php)”将数据分成 1 分钟的间隔。例如：

```
SELECT user_name, truncate(event_time, 'YYYYMMDD HH24MI'), count(*)
FROM job_table
WHERE event_time > TO_DATE( some start date time)
AND user_name IN ( list of users to query )
GROUP BY user_name, truncate(event_time, 'YYYYMMDD HH24MI') 
```

这将为您提供如下结果（假设爱丽丝在 8.00 和 8.01 之间有 20 行，在 8.01 和 8.02 之间有 40 行）：

```
Alice  2008-12-16 08:00   20
Alice  2008-12-16 08:01   40 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-18T22:50:10.093

你最好的选择是有一个表（如果时间片是动态的，一个临时生成的就可以了），然后加入反对它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-09T22:23:34.807

这应该做得很好。它将分解到分钟（一天的 1/1440）。

```
SELECT 
  to_char(Times.time,'hh24:mi'),
  count(*)   
FROM   
  (SELECT
     time
   FROM  
     dual
   WHERE 
     1=2 
   MODEL 
     dimension by ( 0 as key )
     measures     ( sysdate -1 as time )
     rules upsert ( time[ for key from 0 to 1 increment (1/1440) ] = sysdate-1 + cv(key)) ) Times,
  job_table
WHERE 
  begintime <= Times.time 
AND 
  endtime > Times.time 
AND
  user_name = 'Alice'
GROUP BY 
  Times.time 
ORDER BY
  Times.time 
```

我确信有一种更快的方法可以做到这一点，但这是我能想到的最好的方法。希望这可以帮助。

# asp.net-mvc - 用于搜索的 ASP.NET MVC 自定义路由

> ID：379558
> 
> 赞同：31
> 
> 时间：2008-12-18T22:30:57.760
> 
> 标签：asp.net-mvc, asp.net-mvc-routing, url-routing

这是我的场景。例如，假设我需要根据搜索条件返回汽车列表。我想要一个视图来显示结果，因为输出是相同的，但我需要几种方法来到达那里。例如，我可能有一个带有按年份搜索的文本框的表单。我可能有另一个单独的页面，其中包含所有红色丰田汽车的超链接。如何在同一个视图和控制器中处理这些多个场景。我的困境是搜索可能包含几个选项……年份、品牌、型号等，但我不知道把它们放在哪里。

最好的方法是什么？我应该在路由中定义参数还是使用查询字符串等？

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2008-12-19T00:43:54.107

**选项1**

当然，您始终可以选择 /car/search/?vendor=Toyota&color=Red&model=Corola 的方式，我认为这对您有好处。

```
routes.MapRoute(
    "CarSearch",
    "car/search",
    new { controller = "car", action = "search" }
); 
```

在这种情况下，您可以从 Request.Params 获取参数。

**选项 2**

或者您可以在路由表中定义参数，但是 AFAIK 需要为所有可能的组合制定一组规则，因为参数的顺序很重要，例如：

```
 routes.MapRoute(
            "CarSearch1",
            "car/search/vendor/{vendor}/color/{color}/model/{model}",
            new {controller = "car", action = "search"}
        );

        routes.MapRoute(
            "CarSearch2",
            "car/search/color/{color}/vendor/{vendor}/model/{model}",
            new {controller = "car", action = "search"}
        );

        routes.MapRoute(
            "CarSearch3",
            "car/search/model/{model}/color/{color}/vendor/{vendor}",
            new {controller = "car", action = "search"}
        ); 
```

……以此类推。如果您使用标准的 MvcRouteHandler，这是真的。

但这是一种简单的方法:)

**选项 3**

困难但我认为最优雅的方法是制作您自己的 IRouteHandler 实现——它将为您在参数顺序方面提供更大的灵活性。但同样，这是一条艰难的道路，如果您有一个简单的应用程序，请不要使用它。因此，仅举例说明如何以这种方式制作（非常简单的示例）：

将新路由添加到路由列表：

```
routes.Add
    (
        new Route
            (
                "car/search/{*data}",
                new RouteValueDictionary(new {controller = "car", action = "search", data = ""}),
                new MyRouteHandler()
            )
    ); 
```

添加将调整标准请求处理链的类：

```
class MyRouteHandler : IRouteHandler
{
    public IHttpHandler GetHttpHandler(RequestContext requestContext)
    {
        return new MyHttpHandler(requestContext);
    }
}

class MyHttpHandler : MvcHandler
{
    public MyHttpHandler(RequestContext requestContext) : base(requestContext)
    {
    }

    protected override void ProcessRequest(HttpContextBase httpContext)
    {
        IController controller = new CarController();
        (controller as Controller).ActionInvoker = new MyActionInvoker();
        controller.Execute(RequestContext);
    }
}

class MyActionInvoker : ControllerActionInvoker
{
    protected override ActionResult InvokeActionMethod(MethodInfo methodInfo, IDictionary<string, object> parameters)
    {
        // if form of model/{model}/color/{color}/vendor/{vendor}
        var data = ControllerContext.RouteData.GetRequiredString("data");
        var tokens = data.Split('/');

        var searchParams = new Dictionary<string, string>();
        for (var i = 0; i < tokens.Length; i++)
        {
            searchParams.Add(tokens[i], tokens[++i]);
        }

        parameters["searchParams"] = searchParams;

        return base.InvokeActionMethod(methodInfo, parameters);
    }
} 
```

在控制器中：

```
public ActionResult Search(IDictionary<string, string> searchParams)
{
    ViewData.Add
        (
            // output 'model = Corola, color = red, vendor = Toyota'
            "SearchParams",
            string.Join(", ", searchParams.Select(pair => pair.Key + " = " + pair.Value).ToArray())
        );
    return View();
} 
```

它适用于任何搜索参数顺序：

```
/car/search/vendor/Toyota/color/red/model/Corola
/car/search/color/red/model/Corola/vendor/Toyota
/car/search/model/Corola/color/red/vendor/Toyota 
```

但也不要忘记制作链接生成逻辑，因为 Html.ActionLink 和 Html.RenderLink 不会以 /car/search/model/Corola/color/red/vendor/Toyota 的漂亮形式为您提供 url，所以您需要制作自定义链接生成器。

所以，如果你需要一个非常灵活的路由——你最好用这种艰难的方式:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-18T22:40:59.533

控制器上的每个方法（操作）都会采用不同的参数，但会创建相同的搜索结果集合。那么，每个人都会

```
return View("SearchResult", searchResultCollection); 
```

它们都使用相同的视图 SearchResult.aspx。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-19T00:43:41.890

这些方面的东西应该做你所追求的。请注意如何有两种不同的操作方法，但它们都返回对 DisplayResults() 的调用 - 所以它们最终使用相同的视图，具有不同的 ViewData。

```
public class SearchController : Controller {

    public ActionResult ByColor(Color[] colors) {
         List<Car> results = carRepository.FindByColor(colors);
         return(DisplayResults(result));
    }

    public ActionResult ByMake(string make) {
         List<Car> results = carRepository.FindByMake(make);
         return(DisplayResults(results));
    }

    private ActionResult DisplayResults(IList<Car> results) {

        // Here we explicitly return the view /Views/Search/Results.aspx
        // by specifying the view name in the call to View();
        return(View("Results", results));
    }
} 
```

# c# - 如何将整数写入右侧低位的文本文件（Bigendian）

> ID：379560
> 
> 赞同：3
> 
> 时间：2008-12-18T22:31:45.607
> 
> 标签：c#, endianness

默认情况下，BinaryWriter 类将 int 值写入左侧的低位（例如，当在十六进制编辑器中查看结果文件时， (int)6 变为 06 00 00 00）。我需要右边的低位（例如00 00 00 06）。

我如何实现这一目标？

编辑：感谢 strager 为我提供了我所寻找的名称。我已经编辑了标题和标签，以便更容易找到。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-18T22:40:21.093

[Jon Skeet在这里](http://www.pobox.com/~skeet/csharp/miscutil/)有一个 EndianBitConverter应该可以完成这项工作。只需根据需要使用大/小端。或者，只需将数据移动几次；-p

```
 int i = 6;
        byte[] raw = new byte[4] {
            (byte)(i >> 24), (byte)(i >> 16),
            (byte)(i >> 8), (byte)(i)}; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-18T22:40:54.807

不是真正的内置方式，但您可以使用它：[EndianBit*](http://www.yoda.arachsys.com/csharp/miscutil/)。感谢乔恩斯基特：P

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-18T22:33:32.763

您正在寻找更改[字节顺序（又名字节顺序）](http://en.wikipedia.org/wiki/Byte_order)。你想打印出**big endian**。不确定如何在 C# 中执行此操作，但您可以在将整数发送到 BinaryWritter 类之前交换整数中的字节。

[您可以使用System.BitConverter.IsLittleEndian](http://msdn.microsoft.com/en-us/library/system.bitconverter.islittleendian.aspx)检查当前系统的字节序。我不确定 BinaryWriter 是否使用系统的字节序或小字节序来实现兼容性。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-18T23:15:34.907

如果你决定使用内置的东西，System.Net.IPAddress.HostToNetworkOrder() 有很多重载。

这些将满足您的要求，因为“主机”顺序很可能总是小端，而“网络”顺序很可能是大端，这就是您想要的。

但是，如果您根本不做任何与网络有关的事情，那么使用这些有点技巧。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-19T00:59:08.647

您还可以使用 BitConverter 获取字节数组，然后将其反转。就像是：

```
Byte[] bytes = BitConverter.GetBytes(number);
Array.Reverse(bytes);

// Then, to write the values you use
writer.Write(bytes); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-08-25T13:24:33.990

现在它无济于事，但我为 BinaryReder/Writer 创建了一个[连接票证](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=484149)，以支持 Bigendian。[去这里](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=484149)投票吧。

# c# - 单击复选框会导致 onCheckedChanged 触发两次

> ID：379571
> 
> 赞同：1
> 
> 时间：2008-12-18T22:34:22.183
> 
> 标签：c#, asp.net, events, checkbox, oncheckedchanged

我有一个带有复选框的 TemplateField 的 GridView。我的目标是使用自动回发捕获 onclick 事件并设置数据库标志。我唯一的问题是事件发生了两次。第一次 Checkbox （在 sender 参数中）保存点击的值，所以我根据点击设置它。第二次 sender 参数有一个始终选中=false 的复选框。我很乐意接受有关解决此问题的其他方法的建议，但我的目标是根据用户选中复选框来设置数据库标志。我的目标是 .NET Framework 2.0。

以下是相关代码：

```
<div style="margin-left : 1em;margin-right:1em;">
    <asp:GridView ID="RouteGridView" runat="server" AllowPaging="True" 
            AutoGenerateColumns="False" CellPadding="4" DataKeyNames="ROUTE_NUMBER" 
            ForeColor="#333333" GridLines="None" style="width:100%;" 
        onselectedindexchanged="RouteGridView_SelectedIndexChanged" 
        AllowSorting="True" onpageindexchanging="RouteGridView_PageIndexChanging" 
        onsorting="RouteGridView_Sorting" >
            <Columns>
<%-- Column one --%>
<asp:TemplateField HeaderText="Route" SortExpression="ROUTE_NUMBER">
    <ItemTemplate>
        <asp:LinkButton ID="HyperLink1" runat="server" CommandName="Select" CommandArgument='<%#Eval("ROUTE_NUMBER")%>'  
                            Text='<%# Eval("ROUTE_NUMBER") %>' ></asp:LinkButton>
    </ItemTemplate>
    <ItemStyle HorizontalAlign="Center" />
</asp:TemplateField>

<%-- Column 2 this is where the problem CheckBox is--%>
<asp:TemplateField HeaderText="Read?" 
    SortExpression="READ_FLAG">
    <ItemTemplate>
        <asp:CheckBox ID="CheckBox1" runat="server" 
            OnCheckedChanged="ChangeReadFlag"  
            AutoPostBack="true"
            Checked='<%# (string)DataBinder.Eval(Container.DataItem, "READ_FLAG") == "1" %>' Enabled='<%# isSelectedRow(Container)  %>' />
    </ItemTemplate>
    <ItemStyle HorizontalAlign="Center" />
</asp:TemplateField>

<%-- more columns --%
<%-- more columns --%>
</Columns>
</asp:GridView> 
```

这是后面代码中的事件处理程序：

```
protected void ChangeReadFlag(object sender, EventArgs e)
{
    if (RouteGridView.SelectedIndex != -1)
    {
        CheckBox cb = ((CheckBox)sender);
        DataKey key = RouteGridView.SelectedDataKey;

        //... do stuff here ...
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T09:41:46.077

这种行为可能有几个原因。在我的情况下，事件被注册了两次：一次自动作为复选框定义的一部分
`<asp:CheckBox ID="CheckBox1" runat="server" **OnCheckedChanged="ChangeReadFlag"** AutoPostBack="true" Checked='<%# (string)DataBinder.Eval(Container.DataItem, "READ_FLAG") == "1" %>' Enabled='<%# isSelectedRow(Container) %>' />`

第二次 - 代码中某处的显式注册，通常在 OnInit 方法中：
`CheckBox1.CheckedChanged += new EventHandler(ChangeReadFlag);`

为了修复它，您应该从后面的代码或您的控件中删除第二个注册。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-19T00:26:02.317

您是否在页面加载事件中将复选框的选中状态设置为 false？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-18T22:55:51.797

您想捕获 GridView 的偶数；识别导致回发的命令（发件人），然后您可以执行数据库更新。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-19T12:29:02.477

问题出现的原因之一（可能还有其他原因）是事件被注册了两次。

在“InitializeComponent”内部的代码中检查您的代码。这将导致事件被注册两次，因此触发两次。

您需要在一处将其删除才能解决问题。

内存。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-27T10:24:03.357

另一个潜在的问题是你的数据绑定发生在哪里——我在你的代码中没有看到数据源，所以我猜你是在代码隐藏中进行数据绑定。

如果您在回发时进行数据绑定，并且在第一个 onChange 事件触发后，很可能数据绑定事件正在重置复选框的状态，从而导致事件再次触发。

# java - JNA 导致 EXCEPTION_ACCESS_VIOLATION？

> ID：379574
> 
> 赞同：2
> 
> 时间：2008-12-18T22:35:27.580
> 
> 标签：java, java-native-interface, awt, jna

我的 Java UI 意外终止并转储了一个`hs_err_pid`文件。该文件显示“崩溃发生在 Java 虚拟机之外的本地代码中。” JNA 是我们使用的唯一本机代码。有谁知道可能导致此问题的任何 JNA 版本的任何已知问题或错误。我在下面的错误文件中包含了一些内容。

```
An unexpected error has been detected by Java Runtime Environment:

EXCEPTION_ACCESS_VIOLATION (0xc0000005) at pc=0x6d02bcbd, pid=312, tid=3616

 Java VM: Java HotSpot(TM) Client VM (11.0-b16 mixed mode, sharing windows-x86)<br>
 Problematic frame:
 C  [awt.dll+0x2bcbd]

 If you would like to submit a bug report, please visit:
   http://java.sun.com/webapps/bugreport/crash.jsp
 The crash happened outside the Java Virtual Machine in native code.
 See problematic frame for where to report the bug.

Current thread (0x02acf000):  JavaThread "AWT-Windows" daemon [_thread_in_native, id=3616, stack(0x02eb0000,0x02f00000)]

siginfo: ExceptionCode=0xc0000005, writing address 0xe2789280

Registers:
EAX=0x234f099c, EBX=0x00001400, ECX=0x00000100, EDX=0xe2789280
ESP=0x02eff4a4, EBP=0x00000400, ESI=0x234f099c, EDI=0xe2789280
EIP=0x6d02bcbd, EFLAGS=0x00010206

Top of Stack: (sp=0x02eff4a4)
0x02eff4a4:   02eff500 00000100 02eff584 00000100
0x02eff4b4:   6d0a5697 00000400 00000400 00000100
0x02eff4c4:   00000100 02eff700 02eff500 00000000
0x02eff4d4:   00000000 00000100 041ac3a0 00000100
0x02eff4e4:   00182620 00000400 e2789280 00000000
0x02eff4f4:   00000000 00000100 00000100 00000000
0x02eff504:   00000000 00000100 00000100 00000000
0x02eff514:   00000000 00000004 00000400 00000000

Instructions: (pc=0x6d02bcbd)
0x6d02bcad:   00 00 00 8b 4c 24 14 8b e9 c1 e9 02 8b f0 8b fa
0x6d02bcbd:   f3 a5 8b cd 83 e1 03 f3 a4 8b 74 24 18 8b 4c 24

Stack: [0x02eb0000,0x02f00000],  sp=0x02eff4a4,  free space=317k
Native frames: (J=compiled Java code, j=interpreted, Vv=VM code, C=native code)
C  [awt.dll+0x2bcbd]

[error occurred during error reporting (printing native stack), id 0xc0000005]

Java frames: (J=compiled Java code, j=interpreted, Vv=VM code)
j  sun.awt.windows.WToolkit.eventLoop()V+0
j  sun.awt.windows.WToolkit.run()V+69
j  java.lang.Thread.run()V+11
v  ~StubRoutines::call_stub 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-21T01:23:38.670

我刚刚遇到了同样的错误，这显然是 1.6.0_11 的新 Direct3d 加速 Java2d 功能中的错误，这种错误发生在视频 RAM 较低的机器上。如果您使用 -Dsun.java2d.d3d=false 启动您的应用程序，它应该可以再次工作。跟踪此的太阳错误如下：[http ://bugs.sun.com/view_bug.do?bug_id=6788497](http://bugs.sun.com/view_bug.do?bug_id=6788497)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-19T00:39:44.567

判断从：

```
Stack: [0x02eb0000,0x02f00000], sp=0x02eff4a4, free space=317k
Native frames: (J=compiled Java code, j=interpreted, Vv=VM code, C=native code)
C [awt.dll+0x2bcbd] 
```

（此时堆栈跟踪显然爆炸了）您可能遇到了 AWT 库中的错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-29T12:35:23.440

仅仅因为您有意使用的唯一一点本机代码是 JNI/并不意味着像您这样的崩溃在位置或时间上与它有关。在任何给定的 JVM/执行中都默默地使用了各种本机支持，我曾经遇到过由更早发生的损坏和 JVM 本身导致的奇怪崩溃。

就我而言，我在闪亮的新多 CPU (Niagara) 机器上的并发 GC 线程中发现了令人兴奋的错误，这让各种炸弹等待爆炸，而且我的应用程序中*没有*非 JDK 本机代码一点也不。

当 Sun 的 GC 团队修复了他们的错误（并且非常友好地为我提供了一个测试盗版 VM）时，我的问题消失了（好吧，在一两轮之后，自然而然）。

Rgds

达蒙

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-29T13:39:00.113

您遇到了访问冲突，这意味着某些代码试图访问它不允许访问的地址，通常是因为给定地址没有任何内存。堆栈跟踪指向发生问题的位置，这可能是*也可能不是*问题的根源。人们在谈论本机代码时有时会忘记这一点，即使他们不知道这一点。

我用过 JNA，但从来没有遇到过任何问题。如果存在访问冲突，那是我的错。这里有一些简单的建议。

确保您的机器在物理上是健全的。[使用Memtest86+](http://www.memtest.org/)测试您的记忆力。如果是硬件问题，那么寻找软件错误是没有用的。

查看使用 JNA 的代码。请注意，即使 Java 中的调用看起来不起眼，您编写的低级代码也可能与任何事情发生冲突。很可能，使用 JNA 的代码会出错并破坏内存。例如，确保使用正确的调用约定和数据对齐方式。如果有疑问，请让熟悉 C（或更一般地说，低级的东西）的人来帮助您。

不要完全排除其他因素。很可能您遇到了 JVM 错误或其他问题，但请注意这种可能性有多大。如果你听到蹄声，想想马，而不是斑马。

# seo - “建设中”网站的最佳 SEO 实践？

> ID：379579
> 
> 赞同：6
> 
> 时间：2008-12-18T22:38:35.293
> 
> 标签：seo

我们有一个已经在博客上的域：blog.domain.com

显然有指向实际网站 www.domain.com 的指针。我已经在谷歌索引中看到了它，但我担心谷歌在我们发布时会认为它很糟糕，因为它说“正在建设中”或“即将推出”。

是否有任何 HTTP 标头或实践来帮助解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-04-01T02:55:18.113

将 HTTP 状态**503**用于“*服务暂时不可用*” - 有关详细信息，请参阅 Google 的 HTTP 状态列表： [http ://www.google.com/support/webmasters/bin/answer.py?answer=40132](http://www.google.com/support/webmasters/bin/answer.py?answer=40132)

有关处理计划停机时间的推荐方法的更多相关信息：http: [//googlewebmastercentral.blogspot.com/2011/01/how-to-deal-with-planned-site-downtime.html](http://googlewebmastercentral.blogspot.com/2011/01/how-to-deal-with-planned-site-downtime.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-18T22:59:08.250

我从来不明白为什么有人会公开一个“正在建设中”的网站。那里的目标到底是什么？平面设计的史蒂夫制作了这个可爱的“建设中”图形，我们只是不想浪费，所以我们需要在网站准备好之前开始，这样人们才能看到它？

...无论如何，作为答案...如果您必须这样做，请尝试尽可能多地使用您希望 Google 在准备好时想到的内容来完善您的页面，而不是现在的内容。我不知道他们到底在做什么，但我听说过一旦你让自己处于引擎坏的一面，就很难爬回来。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-18T23:15:09.557

沙盒效应是完全不真实的。起初，该网站将被标记为“未排名”，因为它已在数据库中注册，但尚未完全编入索引。我的网站，NerdCulture.org，开始时页面排名为 3。这只是知道获得排名的技巧的问题。以下是我从接受 SEO 专业培训中学到的快速总结：

1.) 避免“正在建设”的占位符站点。拥有一个从一开始就没有内部链接的顶级页面几乎会将您置于 Google 的忽略列表中。

2.) 在您的 HTML 页面中，尽量减少代码与文本的比例——这是您可以直接控制的 Google 相关性平衡的最大因素之一。将所有样式移至 CSS 文件，不要将 Flash 与对象或嵌入标签一起放置 - 使用 SWFObject。这与 Googlebot 解析页面的方式有关。它通过元素内的字符数与元素声明内的字符数来衡量您的相关性。

3.) 没有桌子！一个表格使用多行来完成与样式化 div 相同的事情。

4.) XHTML 文档类型比非 XHTML 文档类型处理得更好

5.) RSS Feeds 在搜索排名中非常有价值。

6.) 确保使用 Google 网站管理员工具注册站点地图，并在进行更改时重新提交。使用自动处理的系统是非常有益的。Wordpress 可以通过插件做到这一点。

7.) 如果可能，不要使用 position:absolute。谷歌会反对你，因为它曾经经常被用来隐藏图片后面的关键词列表来欺骗高排名。

8.) 不要使任何文本颜色与任何背景颜色相同。就像前一点一样，这是用于人工排名的。Googlebot 不够聪明，无法分辨出您的文本相对于它的 CSS 样式放置在何处，因此即使背景是黑色的，然后您在白色 div 上有黑色文本，它也会被严重对待。

9.) 不要过度使用元标签！您的元关键字块的长度不应超过 150-200 个字符。如果它真的很长，谷歌会假设你只是不顾一切地抓住你可能的任何关键词，并且很难确定它们的优先级。最好有 4-6 个匹配良好的关键字或关键词。

10.) 持续更新。您可以每天抛出几个新页面，但如果内容太少，它的排名就不会很好。最好花时间制作一个经过深思熟虑的页面，并在准备好后发布。只要您以相对一致的速度发展网站（并且在日常活动后半年内不会消失，就像我对我的网站所做的那样......）您的排名应该稳步上升。

遵循这些规则，如果您的内容很好并且让您的用户传递信息，那么您的排名应该没有问题。自己在网络上放置一些链接并没有什么坏处，但是在大多数关键字区域中需要多少链接才能充分排名，您确实需要用户在链接放置方面的帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-08T06:56:09.520

施工现场的最佳实践是

1.  不允许搜索引擎索引网站。这可以通过 META ROBOTS Ex 实现：
2.  如果您设置了网站管理员工具，请不要提交站点地图，因为 google 有时会忽略为页面设置的 No index 和 no follow 属性。
3.  指定联系人电子邮件，基本上来自同一域并提供一些有价值的外部链接。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-18T22:41:52.183

我会继续描述您希望有一天会出现的网站，以便 Google 可以开始了解您的网站是关于什么的。

我主要基于一个广泛持有的信念，即谷歌让新网站[等待一段时间，然后再用竞争性条款对它们进行索引。](http://en.wikipedia.org/wiki/Sandbox_Effect)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-18T23:18:23.013

如果您想让 Google 满意，也许您应该在其上放置 AdSense for Domains 内容，而不是建设中的网站。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-18T23:34:58.660

谷歌不在乎你的排名中是否有 AdSense 广告。事实上，如果你有低水平的内容来平衡它，你最好不要在那里。

这两个“即将推出”网站的排名可能是合理的，因为它们位于竞争低的利基关键字区域，并且可能具有相当高的文本与代码比率。如果是这样的话，按照我所说的，他们的排名可能会更好。

尽管有数百万个竞争网站，但我的网站设法以 3 的页面排名开始，并位于我定位的大多数关键字的前 2 或 3 页中。关键字是其中一个非常重要的因素。尝试对“电子游戏”进行排名只会浪费时间——该词组的搜索与竞争比率远低于我排名的许多其他关键词，例如“罪与罚”。像这样更有针对性的关键字更能提高排名。常见的关键词甚至不值得尝试。

# c++ - 如何在应用程序退出时诊断访问冲突

> ID：379581
> 
> 赞同：3
> 
> 时间：2008-12-18T22:39:35.090
> 
> 标签：c++, wtl

我有一个正在尝试调试崩溃的应用程序。但是，由于以下几个原因，很难检测到该问题：

*   崩溃发生在关闭时，这意味着有问题的代码不在堆栈中
*   崩溃仅发生在发布版本中，这意味着符号不可用

崩溃是指以下异常：

```
0xC0000005: Access violation reading location 0x00000000. 
```

**你会使用什么策略来诊断这个问题？**

到目前为止，我所做的是从我的程序中删除尽可能多的代码，直到我得到导致崩溃的最低限度。它似乎发生在静态链接到项目的代码中，所以这也无济于事。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-18T23:15:29.777

您甚至可以为发布版本制作符号文件。这样做，运行你的程序，附加调试器，关闭它，然后在调试器中查看崩溃的原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-18T22:47:53.247

你似乎有一些读取空指针的东西 - 从来没有好过。

我不确定你在哪个平台上。在 Linux 下，你可以考虑使用`valgrind`.

除了存在或不存在调试信息之外，您的发布版本与调试版本有何不同？

您可以构建带有调试信息的静态链接代码吗？您可以获得静态链接代码的调试版本吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-18T23:51:08.597

我将使用的策略正是您所做的。删除尽可能多的代码，直到问题消失，然后重新添加最后一位并调试它。

但是，可能不是您的代码有问题。需要注意的一件事 - 我们在 AIX 上发现了这个问题，即使您运行的是 Windows，它也可能类似。

我们有一个第三方库，它动态加载另一个共享库，该库在其初始化例程中设置了一个 atexit 函数，以便在进程退出时调用。

然而，当我们的应用程序加载和卸载这些共享库时，当进程退出时，共享库的 atexit 函数不再在内存中，我们转储了核心。

**这在从 main() 返回后**显示为访问冲突，因此，如果这就是发生在您身上的事情，那几乎可以肯定是同一类事情。C RTL 启动代码将遍历 atexit 列表并调用其每个函数，无论您对它们做了什么。

当然，如果它在 main() 退出之前崩溃，那么这是一个有争议的问题。

您可以考虑的一件事（在跟踪和修复一个特别棘手的错误的成本/收益分析之后，我们实际上曾经这样做过）：将调试版本作为您的产品发送。如果它没有崩溃，那么当您在闲暇时研究更可接受的解决方案时，这可能是一个快速修复产品的方法。

# rcs - 非图形三向合并工具

> ID：379593
> 
> 赞同：7
> 
> 时间：2008-12-18T22:44:46.170
> 
> 标签：rcs, three-way-merge

我目前使用 RCS 的合并命令进行 3 路合并，但有一件事一直让我烦恼。如果我使用 -A 选项，在两个文件中所做的相同更改会显示为冲突：

<<<<<<< file1
file1 line 1
||||||| orig
orig line 1
=======
file2 line 1
>>>>>>> file2
orig line 2
<<<<<<< orig
=======
在两个更改中添加的行
>>>>> >> file2
原始第 3 行

如果我使用默认值 (-E)，则不会显示这些相同的更改，但输出仅显示两个贡献者，而不是祖先，如下所示：

<<<<<<< file1
file1 line 1
=======
file2 line 1
>>>>>>> file2
orig line 2
line added in both changes
orig line 3

是否有一些程序基本上会执行与 RCS 合并相同的行为，但有某种方式可以显示所有三个冲突版本，同时自动合并相同的更改？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-18T23:37:29.327

看起来 diff3 有一些有趣的选项。

在 ubuntu 上：

```
       -m --合并
              输出合并文件而不是 ed 脚本（默认 -A）。

```

您要求非图形，但 vimdiff 和 gvimdiff 可以做 3 个相邻的窗口。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-12T22:22:37.217

KDiff3 是图形化的，但它确实有一个“--auto”选项，当从命令行调用时，它将执行合并并仅在发生冲突时显示 GUI。我知道这意味着您仍然需要一个 GUI，但是 kdiff3 在命令行中仍然很有用。我一直以这种方式使用它（在 Windows 上 - 不确定其他版本）。

（我想将此评论添加到其他 KDiff3 帖子中，但不知道该怎么做 - 抱歉。）

# java - 为什么我不能从本机 java Blob 投射 oracle BLOB

> ID：379594
> 
> 赞同：4
> 
> 时间：2008-12-18T22:46:01.880
> 
> 标签：java, oracle, blob, classcastexception

我正在从 ResultSet 读取文件，需要将文件保存到 Oracle 数据库中。

```
...
ResultSet rs = ...
java.sql.Blob myfile = rs.getBlob("field")
java.io.OutputStream os = ((oracle.sql.BLOB) myfile).getBinaryOutputStream(); 
```

我收到此错误消息

```
java.lang.ClassCastException 
```

任何人有解决这个问题？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-07-23T00:13:00.917

我找到了解决方案。我想和有这个问题的人分享。

从 oracle blob 获取输出流的代码是：

```
java.io.OutputStream os = ((oracle.sql.BLOB) myBlob).setBinaryStream(1L); 
```

setBinaryStream() 实际上是返回 java.io.OutputStream 对象

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-18T22:52:10.697

`java.sql.Blob` [是一个接口](http://java.sun.com/javase/6/docs/api/java/sql/Blob.html)。大概您返回的`ResultSet`实现与`oracle.sql.BLOB`？

返回什么`myfile.getClass()`？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-18T22:53:19.087

您那里似乎没有 oracle.sql.BLOB（如果有，它应该可以工作，BLOB 实现了 Blob）。ClassCastException 说的是什么？

您使用的是什么版本的 Oracle 和什么版本的 JDBC 驱动程序？

*无论如何，不​​推荐使用*getBinaryOutputStream ，您应该在 JDBC (3.0) 接口中使用**setBinaryStream*，这可能根本不需要转到 Oracle 的内部类。*

 *# ruby-on-rails - Rails 中深度嵌套的 RESTful 资源

> ID：379595
> 
> 赞同：4
> 
> 时间：2008-12-18T22:46:42.470
> 
> 标签：ruby-on-rails, rest

我的应用程序中有这个结构：

用户 has_one :publicprofile, :privateprofile

PUBLICPROFILE 有很多 :emails, :phonenumbers

PRIVATEPROFILE 有很多 :adresses, :creditcards

我想知道如何为用户创建一个个人资料页面，我可以在其中更新他的嵌套资源（并以 RESTful 方式进行）。我找不到有关该主题的任何文档/示例（因为令人困惑的 has_one 关系）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-23T10:04:44.140

我相信任何比 1-level 更深的嵌套通常都是不受欢迎的，通常可以避免。Jamis Buck[不久前在博客上写过它](http://weblog.jamisbuck.org/2007/2/5/nesting-resources)。

Rails 2 截屏视频的 PeepCode [REST](https://peepcode.com/products/rest-for-rails-2)也非常好，但它并没有深入到嵌套，只是一般的资源。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-07T17:15:01.893

在您的 routes.rb 文件中，您可以使用块将您的配置文件添加为用户的嵌套资源：

```
map.resources :users do |user|
  user.resources :privateprofile
  user.resources :publicprofile
end 
```

然后，您可以使用如下 URL 访问您的个人资料：

```
users/1/publicprofiles
users/1/publicprofiles/new
users/1/publicprofiles/1/edit 
```

您可以在终端中运行 rake 路由，以获取更新路由文件后可用的所有嵌套 url 的列表。

有关真正深入的解释，请参阅这篇文章：[http ://adam.blog.heroku.com/past/2007/12/20/nested_resources_in_rails_2/](http://adam.blog.heroku.com/past/2007/12/20/nested_resources_in_rails_2/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-23T02:36:00.503

我建议您观看此截屏视频：[http ://railscasts.com/episodes/139-nested-resources](http://railscasts.com/episodes/139-nested-resources)

它确实帮助我理解了在 Rails 中使用嵌套路由和资源的真正可能性（尤其是 Rails 2.2 中的新变化）。

但是，我必须同意 Ryan Bates 的观点，小心使用嵌套资源。

# asp.net-mvc - 我可以跳过 ASP.NET MVC 中的 ActionFIlter 吗？

> ID：379604
> 
> 赞同：4
> 
> 时间：2008-12-18T22:51:27.297
> 
> 标签：asp.net-mvc

我的所有控制器都继承自一个基类，我有一个动作过滤器属性。我希望它（过滤器）适用于除一种之外的所有方法。可以做到吗？如何？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-03T17:48:06.120

这有点骇人听闻，但您可以在过滤器的 OnActionExecuting 方法中测试操作，如下所示：

```
var controllerName = filterContext.RouteData.Values["controller"].ToString();
var actionName = filterContext.RouteData.Values["action"].ToString();
if (controllerName == "Foo" && actionName == "Bar")
{
    return;
}
//do normal stuff 
```

# c# - 使用 Javascript 确定单击了哪个 ASP.NET 按钮

> ID：379607
> 
> 赞同：3
> 
> 时间：2008-12-18T22:53:24.907
> 
> 标签：c#, asp.net, javascript, client-side

确定使用 JavaScript 在单个页面上单击了哪个 ASP.NET 按钮的最佳方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-18T22:56:51.157

将客户端 onclick 处理程序添加到指向同一功能的每个按钮？

例如

```
<button onclick="myHandler(this.ID)" /> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-18T23:15:46.687

我只是使用我希望在 Page_Load 事件期间单击按钮时执行的 JavaScript 函数为按钮设置 OnClientClick 事件处理程序。

```
protected void Page_Load(object sender, EventsArgs e)
{
    MyButton.OnClientClick = "MyJavaScriptMethod();";
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-18T22:56:12.980

您可以像这样轻松地将客户端 Javascript 单击处理程序添加到 ASP 按钮。

```
Button1.Attributes.Add("onclick", "alert('You clicked me!');"); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-02-27T10:28:47.933

```
ScriptManager.RegisterStartupScript(btnDelSentMailMulti, this.GetType(), "script", "alert('Exchange password is empty.Please check.');", true); 
```

在您的 aspx 页面的 .cs 中调用此代码。替换为您的价值观。

# html - 你能嵌套html表单吗？

> ID：379610
> 
> 赞同：515
> 
> 时间：2008-12-18T22:54:57.883
> 
> 标签：html, nested-forms

是否可以嵌套这样的html表单

```
<form name="mainForm">
  <form name="subForm">
  </form>
</form> 
```

这样两种形式都有效吗？我的朋友对此有问题，部分`subForm`作品，而另一部分则没有。

* * *

## 回答 #1

> 赞同：511
> 
> 时间：2008-12-18T22:57:50.780

一句话，没有。一个页面中可以有多个表单，但它们不应嵌套。

来自[html5 工作草案](https://www.w3.org/TR/html5/forms.html#the-form-element)：

> **4.10.3`form`元素**
> 
> **内容模型：**
> 
> 流式内容，但没有表单元素后代。

* * *

## 回答 #2

> 赞同：152
> 
> 时间：2015-02-15T16:37:01.363

**HTML5** `<input> form`属性可以是解决方案。

来自[http://www.w3schools.com/tags/att_input_form.asp](http://www.w3schools.com/tags/att_input_form.asp)：

> 1.  form**属性**是 HTML5 中的新属性。
> 2.  指定元素属于哪个`<form>`元素。`<input>`此属性的值必须是`<form>`同一文档中元素的 id 属性。

**场景**：

*   input_Form1_n1
*   input_Form2_n1
*   input_Form1_n2
*   input_Form2_n2

**实施**：

```
<form id="Form1" action="Action1.php" method="post"></form>
<form id="Form2" action="Action2.php" method="post"></form>

<input type="text" name="input_Form1_n1" form="Form1" />
<input type="text" name="input_Form2_n1" form="Form2" />
<input type="text" name="input_Form1_n2" form="Form1" />
<input type="text" name="input_Form2_n2" form="Form2" />

<input type="submit" name="button1" value="buttonVal1" form="Form1" />
<input type="submit" name="button2" value="buttonVal2" form="Form2" /> 
```

[在这里](https://caniuse.com/#feat=form-attribute)你会发现浏览器的兼容性。

* * *

## 回答 #3

> 赞同：92
> 
> 时间：2012-02-15T13:57:19.213

第二种形式将被忽略，请参见 WebKit 的[片段](http://opensource.apple.com/source/WebCore/WebCore-855.7/html/HTMLParser.cpp)，例如：

```
bool HTMLParser::formCreateErrorCheck(Token* t, RefPtr<Node>& result)
{
    // Only create a new form if we're not already inside one.
    // This is consistent with other browsers' behavior.
    if (!m_currentFormElement) {
        m_currentFormElement = new HTMLFormElement(formTag, m_document);
        result = m_currentFormElement;
        pCloserCreateErrorCheck(t, result);
    }
    return false;
} 
```

* * *

## 回答 #4

> 赞同：75
> 
> 时间：2019-02-27T08:45:07.833

**可以**实现与嵌套表单相同的结果，但无需嵌套它们。

HTML5 引入了 form 属性。您可以将表单属性添加到表单外部的表单控件，以将它们链接到特定的表单元素（通过 id）。

[https://www.impressivewebs.com/html5-form-attribute/](https://www.impressivewebs.com/html5-form-attribute/)

这样你就可以像这样构造你的html：

```
<form id="main-form" action="/main-action" method="post"></form>
<form id="sub-form"  action="/sub-action"  method="post"></form>

<div class="main-component">
    <input type="text" name="main-property1" form="main-form" />
    <input type="text" name="main-property2" form="main-form" />

    <div class="sub-component">
        <input type="text" name="sub-property1" form="sub-form" />
        <input type="text" name="sub-property2" form="sub-form" />
        <input type="submit" name="sub-save" value="Save" form="sub-form" />
    </div>

    <input type="submit" name="main-save" value="Save" form="main-form" />
</div> 
```

所有现代浏览器都支持 form 属性。IE 不支持这一点，但 IE 不再是浏览器，而是一种兼容性工具，正如 Microsoft 本身所证实的那样：[https ://www.zdnet.com/article/microsoft-security-chief-ie-is-not-a -browser-so-stop-using-it-as-your-default/](https://www.zdnet.com/article/microsoft-security-chief-ie-is-not-a-browser-so-stop-using-it-as-your-default/)。现在是我们停止关心在 IE 中运行的时候了。

[https://caniuse.com/#feat=form-attribute](https://caniuse.com/#feat=form-attribute)
[https://html.spec.whatwg.org/multipage/form-control-infrastructure.html#attr-fae-form](https://html.spec.whatwg.org/multipage/form-control-infrastructure.html#attr-fae-form)

从 html 规范：

> 此功能允许作者解决对嵌套表单元素缺乏支持的问题。

* * *

## 回答 #5

> 赞同：44
> 
> 时间：2013-05-25T10:10:21.137

纯 html 不能让你这样做。但是使用 javascript 你可以做到这一点。如果您使用的是 javascript/jquery，您可以使用类对表单元素进行分类，然后使用 serialize() 仅序列化您要提交的项目子集的那些表单元素。

```
<form id="formid">
    <input type="text" class="class1" />
    <input type="text" class="class2">
</form> 
```

然后在你的javascript中你可以这样做来序列化class1元素

```
$(".class1").serialize(); 
```

对于 class2 你可以做

```
$(".class2").serialize(); 
```

对于整个表格

```
$("#formid").serialize(); 
```

或者干脆

```
$("#formid").submit(); 
```

* * *

## 回答 #6

> 赞同：32
> 
> 时间：2014-10-31T19:01:37.523

如果您使用的是 AngularJS，则`<form>`您内部的任何标签都会`ng-app`在运行时`ngForm`被设计为嵌套的指令替换。

> 在 Angular 表单中可以嵌套。这意味着当所有子表单都有效时，外部表单也有效。但是，浏览器不允许嵌套`<form>`元素，因此 Angular 提供了`ngForm`与行为相同`<form>`但可以嵌套的指令。这允许您拥有嵌套的表单，这在使用 Angular 验证指令动态生成的表单中非常有用`ngRepeat`。（[来源](https://docs.angularjs.org/api/ng/directive/form)）

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2013-11-13T14:51:02.463

解决此问题的另一种方法是，如果您使用一些允许您操作发布的数据的服务器端脚本语言，请像这样声明您的 html 表单：

```
<form>
<input name="a_name"/>
<input name="a_second_name"/>
<input name="subform[another_name]"/>
<input name="subform[another_second_name]"/>
</form> 
```

如果你打印发布的数据（我将在这里使用 PHP），你会得到一个这样的数组：

```
//print_r($_POST) will output :
    array(
    'a_name' => 'a_name_value',
    'a_second_name' => 'a_second_name_value',
    'subform' => array(
      'another_name' => 'a_name_value',
      'another_second_name' => 'another_second_name_value',
      ),
    ); 
```

然后你可以做类似的事情：

```
$my_sub_form_data = $_POST['subform'];
unset($_POST['subform']); 
```

您的 $_POST 现在只有您的“主表单”数据，而您的子表单数据存储在另一个您可以随意操作的变量中。

希望这可以帮助！

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2008-12-18T23:01:58.977

正如克雷格所说，不。

但是，关于您对*原因*的评论：

将 1 与输入和“更新”按钮一起使用可能更容易`<form>`，并在另一个中使用复制隐藏输入与“提交订单”按钮`<form>`。

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2012-07-11T19:55:56.790

> 请注意，您不允许嵌套 FORM 元素！

[http://www.w3.org/MarkUp/html3/forms.html](http://www.w3.org/MarkUp/html3/forms.html)

[https://www.w3.org/TR/html4/appendix/changes.html#hA.3.9](https://www.w3.org/TR/html4/appendix/changes.html#h-A.3.9)（html4 规范说明嵌套表单从 3.2 到 4 没有变化）

[https://www.w3.org/TR/html4/appendix/changes.html#hA.1.1.12](https://www.w3.org/TR/html4/appendix/changes.html#h-A.1.1.12)（html4 规范说明嵌套表单从 4.0 到 4.1 没有变化）

[https://www.w3.org/TR/html5-diff/](https://www.w3.org/TR/html5-diff/)（html5 规范说明嵌套表单从 4 到 5 没有变化）

[https://www.w3.org/TR/html5/forms.html#association-of-controls-and-forms](https://www.w3.org/TR/html5/forms.html#association-of-controls-and-forms)对“此功能允许作者解决缺乏对嵌套表单元素的支持”的评论，但确实不引用这是在哪里指定的，我认为他们假设我们应该假设它是在 html3 规范中指定的:)

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2018-07-29T18:58:30.340

您还可以在按钮标签内使用 formaction=""。

```
<button type="submit" formaction="/rmDog" method='post' id="rmDog">-</button> 
```

这将作为单独的按钮嵌套在原始表单中。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2013-09-30T06:43:37.957

一个简单的解决方法是使用 iframe 来保存“嵌套”表单。从视觉上看，表单是嵌套的，但在代码方面，它完全位于一个单独的 html 文件中。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2015-06-22T08:16:10.777

在嵌套表单之前使用空表单标签

在 Firefox、Chrome 上测试和工作

未在 IE 上测试

```
<form name="mainForm" action="mainAction">
  <form></form>
  <form name="subForm"  action="subAction">
  </form>
</form> 
```

@adusza 编辑：正如评论者指出的那样，上面的代码不会导致嵌套表单。但是，如果您添加如下所示的 div 元素，您将在 mainForm 中包含 subForm，并且第一个空白表单将被删除。

```
<form name="mainForm" action="mainAction">
  <div>
      <form></form>
      <form name="subForm"  action="subAction">
      </form>
  </div>
</form> 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2008-12-18T23:38:53.800

即使您可以让它在一个浏览器中工作，也不能保证它在所有浏览器中都能正常工作。因此，虽然您可能可以让它在*某些*时候工作，但您肯定无法让它一直*工作*。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2016-01-22T09:41:39.987

虽然我没有提供嵌套表单的解决方案（它不能可靠地工作），但我确实提供了一个适合我的解决方法：

使用场景：允许一次更改 N 个项目的超形式。它的底部有一个“全部提交”按钮。每个项目都希望有自己的带有“提交项目#N”按钮的嵌套表单。但是不能...

在这种情况下，实际上可以使用单个表单，然后将按钮的名称设置为`submit_1`..`submit_N`并`submitAll`在服务器端处理它，仅查看以`_1`按钮名称结尾的参数`submit_1`。

```
<form>
    <div id="item1">
        <input type="text" name="foo_1" value="23">
        <input type="submit" name="submit_1" value="Submit Item #1">
    </div>
    <div id="item2">
        <input type="text" name="foo_2" value="33">
        <input type="submit" name="submit_2" value="Submit Item #2">
    </div>
    <input type="submit" name="submitAll" value="Submit All Items">
</form> 
```

好吧，这算不上什么发明，但它确实有效。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2012-10-09T22:01:46.500

关于嵌套表单：我花了 10 年的时间尝试调试一个 ajax 脚本。

抱歉，我之前的答案/示例没有考虑到 html 标记。

```
<form id='form_1' et al>
  <input stuff>
  <submit onClick='ajaxFunction(That_Puts_form_2_In_The_ajaxContainer)' >
  <td id='ajaxContainer></td>
</form> 
```

form_2 不断失败，说无效的 form_2。

当我移动生成 form_1`<i>outside</i>`的 form_2 的 ajaxContainer 时，我又重新开始工作了。它回答了为什么人们可以嵌套表格的问题。我的意思是，真的，如果不定义要使用哪种形式，ID 是什么？必须有一个更好、更巧妙的解决方法。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2014-05-26T15:32:59.853

尽管这个问题已经很老了，而且我同意@everyone 的观点，即 HTML 中不允许嵌套表单

但这一切都可能希望看到

你可以在哪里破解（我称它为破解，因为我确定这不是合法的）html以允许浏览器具有嵌套形式

```
<form id="form_one" action="http://apple.com">
  <div>
    <div>
        <form id="form_two" action="/">
            <!-- DUMMY FORM TO ALLOW BROWSER TO ACCEPT NESTED FORM -->
      </form>
    </div>
      <br/>
    <div>
      <form id="form_three" action="http://www.linuxtopia.org/">
          <input type='submit' value='LINUX TOPIA'/>
      </form>
    </div>
      <br/>

    <div>
      <form id="form_four" action="http://bing.com">
          <input type='submit' value='BING'/>
      </form>
    </div>
      <br/>  
    <input type='submit' value='Apple'/>
  </div>  
</form> 
```

JS 小提琴链接

[http://jsfiddle.net/nzkEw/10/](http://jsfiddle.net/nzkEw/10/)

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2018-09-11T01:19:49.687

不，您不能有嵌套表单。相反，您可以打开一个包含表单的 Modal 并执行 Ajax 表单提交。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2018-12-16T22:06:33.167

真的不可能......我无法嵌套表单标签......但是我使用了这段代码：

```
<form>
    OTHER FORM STUFF

    <div novalidate role="form" method="post" id="fake_form_id_0" data-url="YOUR_POST_URL">
        THIS FORM STUFF
    </div>
</form> 
```

和`{% csrf_token %}`东西

并应用了一些 JS

```
var url = $(form_id).attr("data-url");

$.ajax({
  url: url,
  "type": "POST",
   "data": {
    'csrfmiddlewaretoken': '{{ csrf_token }}',
    'custom-param-attachment': 'value'
  },
  success: function (e, data) {
      if (e.is_valid) {
         DO STUFF
      }
  }
}); 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2013-09-30T12:22:08.740

今天，我也陷入了同样的问题，并解决了我添加了用户控件并
在此控件上使用此代码的问题

```
<div class="divformTagEx">

</div>

<asp:Literal runat="server" ID="litFormTag" Visible="false">
'<div> <form  style="margin-bottom: 3;" action="http://login.php" method="post" name="testformtag"></form> </div>'</asp:Literal> 
```

并在页面的 PreRenderComplete 事件上调用此方法

```
private void InitializeJavaScript()
{
        var script = new StringBuilder();
        script.Append("$(document).ready(function () {");
        script.Append("$('.divformTagEx').append( ");
        script.Append(litFormTag.Text);
        script.Append(" )");
        script.Append(" });");
        ScriptManager.RegisterStartupScript(this, GetType(), "nestedFormTagEx", script.ToString(), true);
    } 
```

我相信这会有所帮助。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2018-09-11T01:13:23.257

在我知道我不应该这样做之前，我已经嵌套了表单，以便拥有多个提交按钮。就这样跑了 18 个月，成千上万的注册交易，没有人打电话给我们任何困难。

嵌套表单给了我一个 ID 来解析以采取正确的行动。直到我尝试将一个字段附加到其中一个按钮并 Validate 抱怨才中断。解开它并没有什么大不了的——我在外部表单上使用了一个明确的字符串化，所以提交和表单不匹配并不重要。是的，是的，应该将按钮从提交变为点击。

关键是在某些情况下它没有完全损坏。但是“不完全破坏”可能是一个太低的标准，无法拍摄:-)

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2021-09-18T15:52:56.617

[见下面的[代码..](https://i.stack.imgur.com/emBW4.png)代码格式] [2个](https://i.stack.imgur.com/bltYG.png)简单的技巧根本不使用其他**在另一个表单标签内，请使用相同的元素而不使用表单标签。**

 **请参见下面的示例“”不要使用其他形式//只需在其中回忆输入图像描述here元素“”

# .net - 有哪些带有源代码的大型 .NET 项目？

> ID：379629
> 
> 赞同：2
> 
> 时间：2008-12-18T23:01:12.597
> 
> 标签：.net

我想找到一些具有公共源代码的大型 .NET 项目。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-18T23:06:03.413

对于 winforms 开发，[SharpDevelop](http://www.icsharpcode.net/OpenSource/SD/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-18T23:08:07.967

.NET 框架。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-18T23:05:26.940

[油漆网](http://getpaint.net)。

（话虽如此，我现在找不到源下载位置：}

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-18T23:10:47.413

[http://www.codeplex.com/](http://www.codeplex.com/) - 随你挑

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-18T23:48:22.423

由于依赖注入是目前的热门话题，请查看[城堡项目](http://castleproject.org/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-18T23:03:01.970

[DotNetNuke](http://www.dotnetnuke.com/)相当大。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-18T23:10:32.093

[如果这是您问题的目的， NHibernate](http://www.hibernate.org/343.html)是最大的项目之一，值得研究。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-19T00:28:07.977

SSCLI 中有很多 C# 代码。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-18T23:32:54.047

数据和对象工厂有一个他们发布的示例应用程序（*Patterns in Action*）来展示 .NET 中的设计模式。该应用程序展示了四人帮中的设计模式和*Head First Design Patterns*中模式的 .NET 版本的实现。这一切都是在 C# 中完成的，并显示了在 ASP.NET、WPF 和 WinForms 中完成的 UI。我一点也不后悔订阅（而且一点也不后悔）。

如果你不介意花几块钱买一些真正有用的、有大量文档的、可以模拟真实世界应用程序（在线商店的购物车）的工作代码，那么它是值得的（至少，在我的意见）。

我衷心推荐他们。

[数据和对象工厂](http://www.dofactory.com/Default.aspx)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-19T00:07:58.983

[NeuronDotNet](http://neurondotnet.freehostia.com/)，几种类型的人工神经网络的实现。

# sql - Oracle分析函数的窗口子句中的“当前行”和“0前/后”有什么区别？

> ID：379643
> 
> 赞同：2
> 
> 时间：2008-12-18T23:07:03.053
> 
> 标签：sql, oracle, analytics

Oracle 的一些分析函数允许使用[窗口子句](http://download.oracle.com/docs/cd/B19306_01/server.102/b14200/functions001.htm#i97640)指定当前分区的子集，使用诸如“无界前/后”、“当前行”或“value_expr 前/后”之类的关键字，其中 value_expr 是物理或逻辑偏移量当前行或值（取决于您是否分别指定了 ROW 或 RANGE）。

这是一个使用 scott/tiger 的示例，它显示部门 30 中的员工，以及在他们之前雇用的部门中的员工数量（包括他们自己）：

```
select deptno, 
       empno,
       hiredate,
       count(*) over (partition by deptno 
                          order by hiredate
                          range between unbounded preceding and current row) cnt_hired_before1,
       count(*) over (partition by deptno 
                          order by hiredate
                          range between unbounded preceding and 0 preceding) cnt_hired_before2
  from emp
 where deptno = 30
 order by deptno, hiredate; 
```

...任何人都可以提供“当前行”不同于“0前/后”的示例或文档吗？对我来说，这似乎是语法糖......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-29T21:46:20.317

It doesn't really matter which you use. They are two different ways of expressing the windowing, but the optimizer will perform the query the same way. The term "current row" is one that is common to multiple databases with analytic functions, not just Oracle. It's more of a stylistic difference, in the same way that some people prefer count(*) over count(1).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-19T16:52:17.640

我必须提供的 Oracle 文档（Oracle 9.2）说：

> 如果您指定范围：
> 
> *   value_expr 是一个逻辑偏移量。它必须是一个常数或表达式，计算结果为正数值或区间文字。

这意味着您不应该真正使用 0，因为它不是一个正数值。但是，显然可以使用 0 之前/之后，因为你是。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-12-18T23:16:29.367

这完全取决于您要完成的工作。您可能希望使用 RANGE BETWEEN/ROWS BETWEEN 使用它来查找子集中的 LAST_VALUE 或比较子集中的事物。但是您提供的示例肯定不需要。

```
 select deptno, 
       empno,
       hiredate,
       count(*) over (partition by deptno, trunc(hiredate,'mm')) cnt_same_month
  from emp
 where deptno = 30
 order by deptno, hiredate 
```

# c# - .Net WebServices 和 out/ref WebMethod 参数

> ID：379648
> 
> 赞同：11
> 
> 时间：2008-12-18T23:08:59.460
> 
> 标签：c#, .net, vb.net, web-services

我从我们的一个供应商那里收到了一些他们正在发布的网络服务的文档，他们非常具体地指出，在他们的一个 WebMethods 上，一个参数具有 out 修饰符（？不确定这是否是正确的描述符）例如考虑以下 WebMethod 签名：

```
[WebMethod]
public void HelloWorld(out string strVal) 
{ 
    strVal = "Hello World";
} 
```

[显然实际方法不是 Hello World 方法]

现在，我从来没有考虑过设计一个带有 out/ref 参数的 WebMethod，这让我想知道他们为什么会使用它。

为了理解这个设计决策的应用程序，我抛出了一个原型和一些基本的 Hello World 风格的网络方法......一个带有单个输出字符串参数，一个带有两个输出字符串参数，一个不接收任何参数但返回一个字符串。

在尝试从单独的应用程序中引用我的 webmethods 时，我注意到我必须使用单独的字符串参数访问该方法，就像我定义了输出字符串的方法一样，这样就客户端而言实际上是这样的：

```
public string HelloWorld1()
{
  return "Hello World";
} 
```

和

```
public void HelloWorld2(out string strVal)
{
  strVal = "Hello World";
} 
```

完全相同...因为我必须同时引用它们[其中 x 代替了正确的方法]：

```
string val = HelloWorldX(); 
```

如果它们不是网络方法[像这样]，我尝试以访问它们的方式引用这些方法：

```
string val = string.Empty;
MyService1.HelloWorld(out val);
Console.WriteLine(val); 
```

这会导致编译错误，指出没有方法参数接受 1 个输入。这是为什么？显然有一个接受一个参数的 web 方法 - 我正在查看它 [HelloWorld2]。

在检查 SOAP 响应后，我注意到 HelloWorld1 的响应内容是：

```
<HelloWorld1Response xmlns="http://tempuri.org/">
  <HelloWorld1Result>string</HelloWorld1Result>
</HelloWorld1Response> 
```

HelloWorld2 是

```
<HelloWorld2Response xmlns="http://tempuri.org/">
  <strVal>string</strVal>
</HelloWorld2Response> 
```

更进一步，我想，如果我有 2 个 ref 参数怎么办......

```
public void HelloWorld3(out string strVal1, out string strVal2)
{
    strVal1 = "Hello World";
    strVal2 = "Hello World Again!";
} 
```

这会生成 SOAP 内容：

```
<HelloWorld3Response xmlns="http://tempuri.org/">
  <strVal1>string</strVal1>
  <strVal2>string</strVal2>
</HelloWorld3Response> 
```

我认为很公平，所以理论上 [假设我可以找到一种方法将参数传递给 WebMethods] 这意味着我可以只传递两个可以由该方法设置的参数，但是当我这样做时：

```
string val1 = string.Empty;
string val2 = string.Empty;
MyService1.HelloWorld3(out val1,out val2);
Console.WriteLine(val1);
Console.WriteLine(val2); 
```

当我尝试以这种方式引用 HelloWorld2 时，我应该得到相同的编译错误。有一个明显的例外是它抱怨 2 个参数而不是 1 [事实上我确实得到了同样的例外，我测试了它]。

*   是什么赋予了？
*   是否有理由或方法在我缺少的 WebMethods 中使用 out/ref 参数？
*   如果有，我如何使用多个 out/ref 参数引用 WebMethods？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-12-19T04:30:41.543

我不知道为您自己的问题提供答案的协议是什么，但 Steven Behnke 引用的文章为我提供了一些线索，让我推断出解决这种奇怪情况的方法。与其让其他人去弄清楚这意味着什么，我想我会分享我的发现。

因此，请考虑在我的 WebService 中定义的以下 Web 方法：

```
[WebMethod]
public string Method1()
{
    return "This is my return value";
}

[WebMethod]
public void Method2(out string strVal1)
{
    strVal1 = "This is my value passed as an output";
    //No return value
}

[WebMethod]
public void Method3(out string strVal1, out string strVal2)
{
    strVal1 = "This is my strVal1 value passed as an output";
    strVal2 = "This is my strVal2 value passed as an output";
    //No return value
}

[WebMethod]
public string Method4(out string strVal1, out string strVal2)
{
    strVal1 = "This is my strVal1 value passed as an output";
    strVal2 = "This is my strVal2 value passed as an output";
    return "This is my return value";
} 
```

现在根据文档，第一个参数定义为Out，如果方法返回void，那么第一个参数自动作为返回参数。因此，我将按如下方式访问我的每个方法：

方法1：

```
public string Method1() {}

var str = svc.Method1();
Console.WriteLine(str); 
```

方法2：

```
public void Method2(out string strVal1) {}

var str = svc.Method2();
Console.WriteLine(str); 
```

因此，您以完全相同的方式访问它们，这非常令人困惑。地球上谁会在没有被其他人告知的情况下弄清楚这一点？这超出了我的理解，这怎么可能是个好主意。

方法3：

```
public void Method3(out string strVal1, out string strVal) {}

var str2 = String.Empty;
var str1 = svc.Method3(out str2);
Console.WriteLine(str1);
Console.WriteLine(str2); 
```

方法4：

```
public string Method4(out string strVal1, out string strVal2) {}

var str1 = String.Empty;
var str2 = String.Empty;
var str3 = svc.Method4(out str1, out str2);
Console.WriteLine(str1);
Console.WriteLine(str2);
Console.WriteLine(str3); 
```

因此，正如您所注意到的 - 如果方法签名不提供返回值 [即返回 void]，则第一个参数将成为返回值。如果它已经提供了返回值，那么它不会。

对于没有看过该文档的人来说，这可能会非常混乱。非常感谢提供该链接史蒂文 - 我真的很感激。

对于任何认为将设计模式写入 .NET Framework 是一个好主意的人来说——我想不出是什么让您认为这是一个好主意。毕竟，我真的非常不喜欢你。

**附录：**

我刚刚意识到的是，为了增加混乱，如果你使用*ref*而不是*out*然后你*不*这样做，你会像使用它们来调用常规方法一样对待 WebMethods在您的应用程序中：

```
[WebMethod()]
public void Method3(ref string strVal1, ref string strVal2)
{
    strVal1 = "First argument return value";
    strVal2 = "Second argument return value";
} 
```

现在调用你会使用：

```
string val1 = String.Empty;
string val2 = String.Empty;
svc.Method3(ref val1, ref val2);
Console.WriteLine(val1);
Console.WriteLine(val2); 
```

这种不一致令人难以置信。事实上，它是设计使然，对我来说是不可理解的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-19T01:39:11.110

也许这会有所帮助：

[http://kbalertz.com/322624/Proxy-Class-First-Parameter-Service-Method-Returns-Return-Value-Reference.aspx](http://kbalertz.com/322624/Proxy-Class-First-Parameter-Service-Method-Returns-Return-Value-Reference.aspx)

我最喜欢的部分是：

> 地位
> 
> 此行为是设计使然。

# sql - T-SQL Puzzler - 爬取对象依赖项

> ID：379649
> 
> 赞同：2
> 
> 时间：2008-12-18T23:08:59.650
> 
> 标签：sql, sql-server, tsql, recursion

此代码涉及递归存储过程调用和避免游标名称冲突的“不太好”的方法。最后我不在乎它是否使用游标。只是寻找最优雅的方法。我主要将其用作追踪存储过程层次结构的简单方法（无需购买产品）。我在“动态 sql”中尝试了游标，但运气不佳。我想深入大约 10 个级别。

所需的输出：

```
sp_Master_Proc_Name  
-- sp_Child_Proc_1_Name  
---- sp_Sub_Proc_1_Name    
-- sp_Child_Proc_2_Name  
-- sp_Child_Proc_3_Name

```

它不漂亮，但这里是代码（它没有按预期工作）

```
 CREATE PROCEDURE SP_GET_DEPENDENCIES
    (
      @obj_name varchar(300),
      @level int
    )
    AS
    DECLARE @sub_obj_name varchar(300)
    IF @level = 1
      BEGIN
        PRINT @obj_name
      END

    IF @level = 1
      BEGIN 
        DECLARE the_cursor_1 CURSOR FOR 
            SELECT DISTINCT REPLICATE('--', @level) + ' ' + c.name FROM dbo.sysdepends a
              INNER JOIN dbo.sysobjects b ON a.id = b.id
              INNER JOIN dbo.sysobjects c ON a.depid = c.id
              WHERE b.name = @obj_name
        OPEN the_cursor_1
        SET @level = @level + 1
        FETCH NEXT FROM the_cursor_1 INTO @sub_obj_name 
        WHILE @@FETCH_STATUS = 0 
          BEGIN 
            PRINT @sub_obj_name
            EXEC SP_GET_DEPENDENCIES @sub_obj_name, @level 
            FETCH NEXT FROM the_cursor_1 INTO @sub_obj_name 
          END
        CLOSE the_cursor_1
        DEALLOCATE the_cursor_1
      END

    IF @level = 2
      BEGIN 
        DECLARE the_cursor_2 CURSOR FOR 
            SELECT DISTINCT REPLICATE('--', @level) + ' ' + c.name FROM dbo.sysdepends a
              INNER JOIN dbo.sysobjects b ON a.id = b.id
              INNER JOIN dbo.sysobjects c ON a.depid = c.id
              WHERE b.name = @obj_name
        OPEN the_cursor_2
        SET @level = @level + 1
        FETCH NEXT FROM the_cursor_2 INTO @sub_obj_name 
        WHILE @@FETCH_STATUS = 0 
          BEGIN 
            PRINT @sub_obj_name
            EXEC SP_GET_DEPENDENCIES @sub_obj_name, @level 
            FETCH NEXT FROM the_cursor_2 INTO @sub_obj_name 
          END
        CLOSE the_cursor_2
        DEALLOCATE the_cursor_2
      END

    IF @level = 3
      BEGIN 
        DECLARE the_cursor_3 CURSOR FOR 
            SELECT DISTINCT REPLICATE('--', @level) + ' ' + c.name FROM dbo.sysdepends a
              INNER JOIN dbo.sysobjects b ON a.id = b.id
              INNER JOIN dbo.sysobjects c ON a.depid = c.id
              WHERE b.name = @obj_name
        OPEN the_cursor_3
        SET @level = @level + 1
        FETCH NEXT FROM the_cursor_3 INTO @sub_obj_name 
        WHILE @@FETCH_STATUS = 0 
          BEGIN 
            PRINT @sub_obj_name
            EXEC SP_GET_DEPENDENCIES @sub_obj_name, @level 
            FETCH NEXT FROM the_cursor_3 INTO @sub_obj_name 
          END
        CLOSE the_cursor_3
        DEALLOCATE the_cursor_3
      END 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-19T00:42:50.130

对于 ms sql server，您可以使用 CURSOR LOCAL，然后游标在 sproc 调用中是本地的，并且您的代码变得更加简单：

```
CREATE PROCEDURE uspPrintDependencies
(
    @obj_name varchar(300),
    @level int
)
AS
SET NOCOUNT ON
DECLARE @sub_obj_name varchar(300)

if @level > 0 begin
    PRINT Replicate(' ',@level) + @obj_name
end
else begin
    PRINT @obj_name
end

DECLARE myCursor CURSOR LOCAL FOR 
    SELECT 
        DISTINCT c.name 
    FROM dbo.sysdepends a
        INNER JOIN dbo.sysobjects b ON a.id = b.id
        INNER JOIN dbo.sysobjects c ON a.depid = c.id
    WHERE b.name = @obj_name
OPEN myCursor
SET @level = @level + 1
FETCH NEXT FROM myCursor INTO @sub_obj_name 
WHILE @@FETCH_STATUS = 0 BEGIN 
    EXEC uspPrintDependencies @sub_obj_name, @level 
    FETCH NEXT FROM myCursor INTO @sub_obj_name 
END
CLOSE myCursor
DEALLOCATE myCursor
GO 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-19T00:01:00.510

有关按深度对查询表外键依赖项进行排序的讨论，请参阅[此 Stackoverflow 问题](https://stackoverflow.com/questions/352176/sqlserver-how-to-sort-table-names-ordered-by-their-foreign-key-dependency#352294)- 这与您正在讨论的问题类似。答案中至少有两个针对该问题的可行解决方案，与您正在做的事情的唯一真正区别是他们正在爬行的表格。 [这篇文章](https://stackoverflow.com/questions/181909/tool-for-scripting-table-data#181942)有一个数据库逆向工程脚本，展示了如何使用许多主要的数据字典表。

# c#-3.0 - 返回数组片段

> ID：379650
> 
> 赞同：1
> 
> 时间：2008-12-18T23:09:02.160
> 
> 标签：c#-3.0, extension-methods

我需要从数组中获取数组片段。我厌倦了使用 Array.Copy()。new ArraySegment(..).Array 返回原始的 [full] 数组。下面是我想出来的，但我觉得它很蹩脚。有一个更好的方法吗？

 `````
class Program
{
    static void Main(string[] args)
    {
        var arr = new ArraySegment<byte>(new byte[5] { 5, 4, 3, 2, 1 }, 0, 2).ArrayFragment();
        for (int i = 0; i < arr.Length; i++)
            Console.WriteLine(i);
        Console.Read();
    }
}

static class Extensions
{
    public static T[] ArrayFragment<T>(this ArraySegment<T> segment)
    {
        var arr = new T[segment.Count];
        Array.Copy(segment.Array, segment.Offset, arr, 0, segment.Count);
        return arr;
    }
} 
````  `提前致谢。

更新：以上只是一个例子。
我有一个方法：byte [] CalculateXXX(byte [] key, byte [] message); 我在这个方法中进行数组操作。我想返回数组的一部分。ArraySegment 不实现 IEnumerable 并且它不返回仅包含段的数组 new ArraySegment(arr...).Array 返回完整的原始数组。

 ``var rval = new byte[4]; //new ArraySegment(finalOutputBuffer, 0, 4).SegmentedArray(); Array.Copy(finalOutputBuffer, 0, rval, 0, 4);`  `我发现我必须执行上述操作才能返回一个数组片段。只是想知道是否有更好的方法来返回数组的片段[作为新数组]。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-19T18:11:08.090

定义更好。ArraySegment 的缺点是什么？你有什么问题没有解决？

* * *

**编辑**：好的，我现在理解你的观点，但这是错误的。从某种意义上说，它可能是一个错误，您认为它应该做更多的事情，但它确实做了它应该做的事情。它允许您将有关您希望使用的数组以及要使用的数组部分的信息传递给一段代码。

它不提供 IEnumerable 或任何可以让您狭隘地查看数组的东西，即。x[0] 不会给你段的第一个元素，你也不能遍历它。

所以是的，它本身是没有用的，但你无法得到本质上*是*一个数组的东西，但它也是一个更大数组的一部分。

您可以轻松创建自己的类集合类，该类引用数组并将数组用作存储，并提供索引、枚举等。

但这不是这个结构的作用。我想这里的主要问题是他们通过它的名字让你对它有更多的期望。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-18T23:15:51.600

Vyas，我*真的*很抱歉发布了这么多无用的`****`. 自从我实际使用以来已经有很多年`ArraySegment`了，我只是假设它实现了一个（或多或少）一致的接口。有人（乔恩？）请告诉我在执行这个无用结构的过程中使用了哪些药物。

最后，长话短说，最好的解决方案可能是实现你自己的版本`ArraySegment`，只做对。

~~我不明白您使用`ArraySegment`. 如果这就是您的意思，这里不涉及额外的开销，因为没有复制原始数据。相反，`ArraySegment`提供数据的轻量级视图。~~

为了使这项工作，将您的（返回）类型从 更改`T[]`为`IEnumerable<T>`，或者，如果您需要索引访问，更改为`IList<T>`。通常更喜欢在方法签名中使用接口类型，并完全避免使用数组类型。理由很简单：它可以让您的问题消失，并使界面更加灵活和面向未来。它还提供了更好的信息隐藏，因为它隐藏了与此方法的使用者无关的部分实现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-13T22:52:34.333

顺便说一句，C# 中迭代​​器设计不佳的另一个副作用。有许多类似的实例（就像“lame”一样），其中只需简单的良好设计就能够通过或指向或控制段（又名称为范围的概念）而无需所有的古老的 shickanery .. 复制语义与否，数组也是一个定义明确的概念。

只需使用 C++。:-)

# css - 确保标签、输入框和文本区域中字体和字体大小相同的最简单方法

> ID：379652
> 
> 赞同：1
> 
> 时间：2008-12-18T23:09:52.393
> 
> 标签：css

我有一个页面，我结合标签、输入框和文本区域来显示一些内容。我希望它们都具有相同的字体系列和字体大小。我玩过*字体系列：继承*样式，但这似乎不适用于输入和文本区域。确保整个页面的字体/大小相同的最简单方法是什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-18T23:21:06.253

好的......这可以解决问题：

```
*
{
    font-family: arial;
}

input
{
    font-family: inherit;
    font-size: 100%
}

textarea
{
    font-family: inherit;
    font-size: 100%
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-18T23:12:38.330

我的 CSS 有问题，因为我已经有一段时间没有使用它了，但我相信这样做

```
*
{
    font-family: arial;
} 
```

将适用于所有人。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-18T23:21:50.247

我认为大多数 CSS 开发人员会做类似的事情

```
body {font: normal 10pt Arial} 
```

在 CSS 文件的顶部。

如果要从中更改标签，只需添加一个

```
label, input, textarea {font-family:Georgia} 
```

在路上的某个地方。

# asp.net - 具有 100 个字段的网络表单的良好模式或技术

> ID：379661
> 
> 赞同：3
> 
> 时间：2008-12-18T23:14:54.880
> 
> 标签：asp.net, web-applications, design-patterns

在我的工作中，我必须为有时多达一百个不同输入字段的贷款申请实现 Web 表单，然后将应用程序保存到数据库中以供以后检索。

我替换的人创建了一个包含 100 列的 sql 表，其中每一行代表一个贷款申请，每个字段都有一个列。

问题是我发现自己必须多次输入 100 个字段，从表单获取数据，保存到数据库，从数据库检索，写入输出 webform。

然后每当应用程序发生更改时，我必须在很多地方进行更改。

所以它不仅麻烦而且容易出错。

是否有一个很好的设计模式来处理这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-18T23:39:02.740

看看你能不能想出一个更好的桌子设计。IMO 100 Cols 实在是太多了。如果没有，您可以使用动态数据。还要寻找更好的 UI 模式或将其分成 1 个以上的页面，查看 100 个要填写的字段可能会让用户不知所措。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-18T23:39:16.623

代码生成是最好的选择。[MyGeneration](http://www.mygenerationsoftware.com/portal/default.aspx)和[CodeSmith](http://www.codesmithtools.com/)是两个非常好的工具。

我有非常相似的项目，我使用了这两种生成工具并且更喜欢 CodeSmith。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-23T14:24:24.380

一个表单中的 100 个字段太多了。尝试以每页最多 20 个为目标。

如果可以的话，试着将这个表单的每个部分隔离到一个单独的页面中，甚至更好的是，隔离到某种向导中。

例如（示例步骤）

第 1 步：客户资料（姓名、年龄、SSN 等）

第 2 步：贷款数据（固定、可变、金额、条款、特惠...）

第 3 步：信用检查？，预先批准？

第 4 步：变化/计算...

如果您将数据组织成结构化的组，您应该能够使每个部分独立工作（例如，您可以输入基本的贷款数据，并获得一些初步数字，而无需输入客户数据（目前）。

更重要的是，如果用户在导致后端不存储的 100 个字段之一中输入一个值（例如，值超出范围）会发生什么？用户是否丢失了他们输入的所有数据？- 为了可用性，请确保`nothing`当用户尝试保存/移动到下一步时丢失。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-18T23:26:27.150

也许[ASP.NET 动态数据](http://www.asp.net/dynamicdata/)会为您工作。它被描述为“使您能够快速构建功能性数据驱动应用程序的框架”

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-18T23:53:10.277

我以前处理过这些贷款申请，我会直截了当地告诉你，你的数据模型坏了。当借款人进来进行 refi 时，你会在 BigTable 中创建一个新行吗？如果交易失败，但他们想再次尝试购买不同的房子怎么办？如果您只是编辑该应用程序的行中的数据，那么您将失去有关已完成交易百分比的宝贵指标。

首先，修复您的数据模型。然后，尽可能采用 LINQ。

关于 UI，我要么将其作为向导（这与这些应用程序的填写方式非常接近），要么将其构建为用户滚动并添加内容的一个大表单（在每个部分中使用 AJAX以便用户可以随时保存）。

您还需要考虑这些东西的现成解决方案。不要在这里重新发明轮子；这些贷款应用程序的更改频率不足以让全职开发人员投入其中。

编辑：对不起，我假设这是住宅抵押贷款。我不知道这是否属实，但我仍然认为您的数据模型已损坏。如果你有能力改变它，你应该。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-18T23:40:43.080

您可以做的一件事是以编程方式获取列名并将它们以您需要的格式放在文件中。这将解决你眼前的痛苦。下面是一段 c# 代码，它将从 oledbreader 对象中获取列名。

```
internal List<string> GetFieldList(string sTableName)
    {
        tableName = sTableName;
        BuildQuery("*");
        command = SetupConnection();

        List<string> FieldList = new List<string>();
        OleDbDataReader reader = command.ExecuteReader();
        for (int i = 0; i < reader.FieldCount; i++)
            FieldList.Add(reader.GetName(i).ToString());
        return FieldList;
    } 
```

从长远来看，为了解决这种情况，您可能希望使用字段作为参数来执行存储过程或函数。您仍然必须将值放入每个参数中，但会更容易管理每个参数

> 他的问题是我发现自己不得不多次输入 100 个字段，从表单中获取数据，保存到数据库，从数据库中检索，写入输出 webform。

希望能帮助到你！！！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-18T23:40:46.277

哎哟。

您可以使用 LINQ 吗？我们在这里谈论的是什么版本的 .NET？

顺便说一句，如果还不是很明显，从 GUI 的角度来看，我建议您对最终用户隐藏大部分这些字段，并随着用户的进展分部分显示它们，这样做的好处是您可以避免显示不需要的内容在你去的时候成为并验证。

并带有某种进度指示器，因此他们知道站点已结束（哈哈）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-18T23:55:14.687

我以前也遇到过这样的问题，并且知道有这么多列可能是有正当理由的。这是罕见的，但它可能会发生。

您可能想要做的是在它自己的文件中创建一个包含所有数据字段代码的部分类。这可能是字段、属性和可能的​​方法参数，和/或只是您的 CRUD 功能。并生成部分类，这将有助于简化您未来的维护。

祝你好运。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-19T00:57:01.537

设计模式？但当然：[自适应对象模型](http://www.adaptiveobjectmodel.com/WICSA3/ArchitectureOfAOMsWICSA3.pdf)。

# mysql - 记录实时搜索未命中

> ID：379669
> 
> 赞同：2
> 
> 时间：2008-12-18T23:16:26.373
> 
> 标签：mysql, logging, livesearch

我的帮助页面上有一个实时搜索，它搜索我们的帮助数据库并返回相关结果。我认为确定需要更多文档的一个好方法是记录不向我们的数据库返回结果的搜索。

通常，这会非常简单，但它是实时搜索这一事实使它变得更加棘手。

所以当有人搜索：

*   此搜索不返回任何结果。

因为它是实时搜索，所以我们会搜索：

*   这是
*   这个搜索
*   此搜索返回 n
*   此搜索不返回任何结果。

显然，如果我们只能记录完整的短语而不是部分，那将是最好的。

所以现在我只是将所有搜索转储到一个看起来像这样的表中：（id int，search_string text，count int）

我能想到的唯一可能有帮助的方法是

*   在我们向表中添加新行之前，针对表中的搜索对搜索字符串进行类似搜索，如果有匹配项，则不要插入或增加计数。但是，我希望这张表会变得非常大，这样的类似查询会变得非常慢。

*   如果输入值在 2 秒内没有更改，则编写一些 javascript 发送一个特殊的实时搜索，并带有一个标志，如果它是未命中的，则记录它。

在我看来，必须有更好的方法来处理这个问题，但我对任何事情都一无所知。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-18T23:40:41.393

我在想你应该做的是使用候选“错过”搜索的临时表（每天，也许，或每小时，如果你需要更快的反馈）。在表的生命周期结束时，将对其进行后处理，以便忽略作为其他错过搜索或成功搜索前缀的任何搜索。其余的进入“真正的”错过搜索表。

# progress-4gl - 进度数据库 4GL

> ID：379671
> 
> 赞同：1
> 
> 时间：2008-12-18T23:16:41.317
> 
> 标签：progress-4gl, openedge

有谁知道我可以在哪里获得一些关于进度数据库的 4GL 语言的示例/资源，而不是进度数据库网站？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-28T12:20:12.457

[http://www.peg.com](http://www.peg.com)

[http://www.oehive.org](http://www.oehive.org)

[http://www.progresstalk.com](http://www.progresstalk.com)

[http://www.psdn.com](http://www.psdn.com)（由 Progress Software 维护）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-02-02T15:20:23.757

这是 Progress 网站上的 4GL 手册的副本。

[http://www.progress.com/progress/products/documentation/docs/dvhbk/dvhbk.pdf](http://www.progress.com/progress/products/documentation/docs/dvhbk/dvhbk.pdf)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-12T17:49:53.360

您究竟需要什么样的样品？如果您想提高 4GL 技能，那么 4GL 手册是了解该语言的一种非常好的方式，它附带了进度文档。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-12-19T14:04:32.273

[我在Scribd](http://scribd.com)上找到了几本关于 Progress、ProDatasets 等的参考书，当 Progress 官方社区的链接被破坏时，我去了这些参考书。

# oracle - Oracle 9i：同义表不存在？

> ID：379672
> 
> 赞同：2
> 
> 时间：2008-12-18T23:17:07.870
> 
> 标签：oracle, package, synonym, ora-00942

我创建了一个包，其中包含我计划从单独的应用程序调用的存储过程。存储过程将返回模式中所有视图和表的排序列表。为此，它对 DBA_TABLES 和 DBA_VIEWS 同义词执行简单的选择，如下所示：

```
CREATE OR REPLACE
PACKAGE BODY TITAN_ENTITY AS

  PROCEDURE GETSCHEMAOBJECTS (RESULTS IN OUT T_CURSOR)
  IS
    V_CURSOR T_CURSOR;
  BEGIN
    OPEN V_CURSOR FOR
       SELECT 'T' OBJECTTYPE, TABLE_NAME OBJECTNAME 
          FROM DBA_TABLES 
          WHERE OWNER = 'SONAR5'
       UNION ALL
       SELECT 'V' OBJECTTYPE, VIEW_NAME OBJECTNAME 
         FROM DBA_VIEWS 
         WHERE OWNER = 'SONAR5'
       ORDER BY OBJECTNAME;
    RESULTS := V_CURSOR;      

  END GETSCHEMAOBJECTS;

END TITAN_ENTITY; 
```

我已经验证了有问题的同义词存在并且是公开的：

```
CREATE PUBLIC SYNONYM "DBA_TABLES" FOR "SYS"."DBA_TABLES"
CREATE PUBLIC SYNONYM "DBA_VIEWS" FOR "SYS"."DBA_VIEWS" 
```

我的理解是，因为它们是公开的，所以我不需要任何进一步的权限即可访问它们。如果这种理解是不正确的，我希望有人能驳斥我的想法，并指出更准确的数据。

现在这是我的问题：我可以在 Oracle SQL Developer 中打开一个工作表并从这些表中进行选择就可以了。我得到有意义的数据就好了（事实上，567 行）。但是当我尝试执行存储过程时，Oracle报错编译错误，如下图：

```
Error(9,8): PL/SQL: SQL Statement ignored
Error(10,16): PL/SQL: ORA-00942: table or view does not exist 
```

当我双击第二条错误消息时，SQL Developer 将我带到第一个 FROM 子句（“FROM DBA_TABLES”）。

所以我很困惑。我非常了解 SQL Server，而且我是 Oracle 的新手，所以请多多包涵。如果您能提供一些线索，或指出正确的方向，我将不胜感激。

提前致谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-18T23:36:17.567

使用 ALL_TABLES 和 ALL_VIEWS 而不是 DBA_TABLES 和 DBA_VIEWS。所有用户都应该可以访问 ALL_% 视图。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-18T23:36:50.763

如果您从存储的 PL/SQL 过程或存储的 PL/SQL 函数中的表或视图中进行选择，则需要直接授权。通过数据库角色授予是不够的。

您可能需要直接授予视图 dba_tables。（公共）同义词只是（公共）同义词。您需要直接授予选择权限。

见这里：[http ://asktom.oracle.com/pls/asktom/f?p=100:11:0::::P11_QUESTION_ID:48704116042682#48798240264807](http://asktom.oracle.com/pls/asktom/f?p=100:11:0::::P11_QUESTION_ID:48704116042682#48798240264807)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-19T14:06:15.027

**编辑：** 对不起，我掩盖了你似乎说你可以直接从 DBA_TABLES 中选择的部分。最有可能的问题是您的权限是通过其他人回答的角色授予的。但仍然值得解释的是，您对 PUBLIC 同义词的理解是不完整的，如果使用 ALL_TABLES 能满足您的需要，它会更好。

同义词为 PUBLIC 仅表示所有用户都可以引用同义词；它不授予他们对同义词所指对象的任何访问权限。

最直接解决此错误的方法是将 SYS 视图的 SELECT 权限授予将运行此过程的用户。但是，我认为这是一个**非常糟糕的主意。**

正如 Raimonds 建议的那样，考虑是否可以从 USER_TABLES 或 ALL_TABLES 获得所需的信息。哪个用户正在调用此过程，该用户对 SONAR5 的表有什么访问权限？

一般来说，如果你的应用程序对一个表感兴趣，大概它对它有一些特权，在这种情况下，应该在 ALL_TABLES 中列出。

# java - 让 ENTER 像使用 JTextField 一样使用 JSpinner

> ID：379675
> 
> 赞同：5
> 
> 时间：2008-12-18T23:19:36.117
> 
> 标签：java, swing, jtextfield, listeners, jspinner

首先，为了让我的工作更容易解释，这是我的一些代码：

```
JSpinner spin = new JSpinner();
JFormattedTextField text = getTextField(spin);

text.addActionListener(new java.awt.event.ActionListener() {
    public void actionPerformed(java.awt.event.ActionEvent evt) {
            // Do stuff...
    }
}); 
```

...

```
private JFormattedTextField getTextField(JSpinner spinner) {
    JComponent editor = spinner.getEditor();

    if (editor instanceof JSpinner.DefaultEditor) {
        return ((JSpinner.DefaultEditor )editor).getTextField();
    } else {
        System.err.println( "Unexpected editor type: "
                           + spinner.getEditor().getClass()
                           + " isn't a descendant of DefaultEditor" );
        return null;
    }
} 
```

如您所见，我已经做到了。实际上，当我在微调器 ( `JFormattedTextField`) 的文本字段组件中输入一个值，然后按 ENTER 时，它就可以工作了。

我现在想要的是能够让文本字段响应 ENTER 而无需手动输入新值（这有点违背了制作微调器的目的）。我怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-19T00:15:14.507

我知道这不是动作监听器……但也许这对你有用？

```
 text.addKeyListener( new KeyAdapter() {
            @Override
            public void keyReleased( final KeyEvent e ) {
                if ( e.getKeyCode() == KeyEvent.VK_ENTER ) {
                    System.out.println( "enter pressed" );
                }
            }
        } ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-06-10T17:47:15.193

我自己遇到了一个与此相关的问题。就我而言，我有一个带有`SpinnerNumberModel`设置的 JSpinner，因此我可以输入数字 ID 值，然后从远程数据库中检索它们。使用 JButton 作为我的查询触发器，这一切都很好，但我希望能够通过 Tab 将焦点切换到该字段，然后按 Enter，并且还能够通过输入带有数字键的 ID 来更改值，然后按回车键。

给我最多的问题是使用数字键手动输入 ID，然后按 Enter。当我这样做时，查询仍然会发生，但它正在查询以前的 ID 而不是我刚输入的那个，所以我必须再次按 Enter 来查询新的 ID（见代码）

```
((JSpinner.DefaultEditor) minRng.getEditor()).getTextField().addKeyListener(new KeyAdapter() {
    @Override
    public void keyPressed(KeyEvent e) {
        if (e.getKeyCode() == KeyEvent.VK_ENTER) {
            queryData();
        }
    }
}); 
```

和查询方法：

```
private void queryData() {
    int minVal = Integer.parseInt(minRng.getValue().toString());
    queryDataBase(minVal);
} 
```

为了解决这个问题，我所要做的就是强制查询等待运行，直到微调器更新其值，这很容易通过使用`SwingUtilities.invokeLater()`强制它到 EDT 队列的末尾来完成，如下所示：

```
((JSpinner.DefaultEditor) minRng.getEditor()).getTextField().addKeyListener(new KeyAdapter() {
    @Override
    public void keyPressed(KeyEvent e) {
        if (e.getKeyCode() == KeyEvent.VK_ENTER) {
            SwingUtilities.invokeLater(new Runnable() {
                @Override
                public void run() {
                    queryData();
                }
            });
        }
    }
}); 
```

由于`invokeLater()`查询现在发生在新值而不是前一个值上，当按下回车时，JSpinner 已将其值更新为新输入的值。

我假设这样做的原因是输入的值没有正式应用于 ，`JSpinner`直到您按 Enter 键，这也会触发查询的键侦听器。自`KeyEvent`定义 [query] 键侦听器似乎是队列中的第一个，因此它首先运行其代码，然后`KeyEvent`将值应用于`JSpinner`from the internal `JFormattedTextField`，这就是它查询旧值的原因。 `SwingUtilities.invokeLater()`只是将查询本身放在队列的末尾，因此它允许另一个`KeyEvent`在运行查询之前完成其代码。

**编辑：**

实现此目的的另一种方法是直接从`JFormattedTextField`而不是请求值`JSpinner`，因为这也应该返回新输入的值，因为`JFormattedTextField`包含您输入的值，但它尚未传递给 JSpinner，这似乎是问题所在。

```
private void queryData() {
    JFormattedTextField tf = ((JSpinner.DefaultEditor) minRng.getEditor()).getTextField();
    int minVal = Integer.parseInt(tf.getText());
    queryDataBase(minVal);
} 
```

此方法的唯一问题是您必须`NumberFormatException`在解析值时捕获任何 s，该`SwingUtilities.invokeLater()`方法允许微调器模型自动删除任何无效字符并继续查询。

无论如何，我对Java仍然有些缺乏经验，所以如果我对此的理解不正确，请在评论中告诉我。

# c++ - 在读取文件（ifstream）时，有什么方法可以引导它换行吗？

> ID：379677
> 
> 赞同：1
> 
> 时间：2008-12-18T23:19:58.863
> 
> 标签：c++, arrays, input, newline, ifstream

在读取文件（ifstream）时，有什么方法可以引导它换行吗？

例如，我希望这发生：

我的文件>>数组[1]>>数组[2]>>endl；

显然，“endl”是不允许的。还有另一种方法可以做到这一点吗？

编辑---感谢你们的快速回复！

从一个文本文件中，我试图将该文件中的两个字符串存储到数组中，然后对下一行执行相同的操作（或者直到我需要，使用 for 循环）

使用字符串对我来说很重要，因为它将使我未来的程序更加灵活。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-19T00:13:47.803

几个选项：

您可以使用忽略。

```
myfile >> array[1] >> array[2];
myfile.ignore(std::numeric_limits<std::streamsize>::max(), '\n'); 
```

或者您可以将每一行读入字符串流

```
std::string line;
std::getline(myfile,line);
std::stringstream  stream(line);

stream >> array[1] >> array[2]; 
```

请注意：数组索引从 0 开始。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-19T00:13:58.380

用于`std::getline`将一行读入内存流，然后从中获取两个字符串。

```
while (cin)
{
  string line;
  getline(cin, line);

  stringstream stream;
  stream << line;

  stream >> array[1]>>array[2];
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-18T23:31:53.580

阅读你的两个项目，然后打电话`myfile.ignore(8192, '\n')`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-19T00:22:11.747

我不知道这个问题是什么意思。这是将文件的所有行读入字符串向量的简单方法。如果您先执行此操作，则执行您想做的事情可能会更容易。

```
std::vector<std::string> lines;

std::string line;
while (std::getline(myFile, line))
    lines.push_back(line); 
```

现在你可以说`lines[4]`得到第五行，或者`lines.size()`找出有多少行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-19T01:30:36.260

这应该有效：

```
stringstream stream;
string sLine;
int iLine;

while (cin)
{
  getline(cin, sLine);

  stream << sLine;
  stream >> data[iLine][0] >> data[iLine][1];
} 
```

早期答案的定制版本。

# macos - 与默认 xterm (X11) 字体一样易读且紧凑的 mac osx 字体

> ID：379682
> 
> 赞同：6
> 
> 时间：2008-12-18T23:21:46.877
> 
> 标签：macos, fonts, terminal, sysadmin

xterms 中使用的字体非常紧凑且可读。那是什么字体？我发现可以在其他应用程序中使用的最接近的是 DejaVu Sans Mono 或 Bitstream Vera Sans Mono。它们在垂直方向上与 xterm 一样紧凑，但在水平方向上占用更多空间。

我真的很想从 xterms 切换到 Terminal.app，这是阻碍我的一件事。

（我也认为字体对于 emacs、xcode 或任何编辑器会更好。）

添加：在 Terminal.app 中，您可以调整任何字体的字符和行距。这在其他应用程序中可能吗？

我对任何其他与 xterm 字体一样紧凑和可读的字体持开放态度。Dina 看起来非常漂亮，但它似乎不适用于 Mac。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-12-30T02:53:47.290

我已成功让 Emacs.App 使用心爱的 misc-fixed 7x14 字体。它看起来不错。

[1) 从http://www.cl.cam.ac.uk/~mgk25/ucs-fonts.html](http://www.cl.cam.ac.uk/~mgk25/ucs-fonts.html)下载 ucs-fonts.tar.gz

2) 提取文件 7x14.bdf

3) 安装 FontForge (fontforge.sourceforge.net)

4) 在 fontforge 中打开 7x14.bdf

5) 在 fontforge 中执行 File->Generate Fonts with "No Outline Font" 和 "Apple bitmap only sfont (dfont)"

6) 另存为 /Library/Fonts/FixedMedium7x14.dfont

7) 在你的 .emacs (setq default-font "-apple-Fixed-medium-normal-normal- *-14-* - *-* -m-0-iso10646-1")

8) 赢

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-26T04:21:07.107

我真的很喜欢 Inconsolata： http:
[//www.levien.com/type/myfonts/inconsolata.html](http://www.levien.com/type/myfonts/inconsolata.html)
但它并不适合 xterm。作为编程字体更好。

我强烈建议 Monaco 9pt，而不是抗锯齿：

![摩纳哥9.png](https://lh5.ggpht.com/_DfqRKZT12hg/SVRbOHRkE4I/AAAAAAAAAHM/HouAcxApMQA/monaco9.png?imgmax=800)

从来没有见过任何可读和节省空间的东西。请注意，它与 Monaco 10 的像素数相同，但稍短一些。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-19T02:17:39.440

它不*完全相同*，但 10 点摩纳哥（关闭抗锯齿）非常接近。我想说它实际上要好一些，因为 Monaco 的 1/l 和 O/0 字形比 X 字体更明显。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-19T22:08:35.193

这是我尝试过的替代方案。（感谢威尔和其他人。）

1.  Monaco 10pt 与 0.9 行间距（我不知道如何在 Terminal.app 以外的任何东西中压缩行或字符间距）占用与 xterm 字体一样多的垂直和水平空间。如果没有挤压行空间，它会占用更多的垂直空间。我不认为挤压会损害可读性。Monaco 具有斜线零的优点，但尖括号更差（它们尴尬地撞到相邻的字符，例如，“~>”）。大写字符（尤其是“A”）在摩纳哥看起来也不太好。大多数情况下，它们大致相同。

2.  Monaco 9pt 修复了尖括号，并且比 xterm 字体在垂直方向上更紧凑（水平方向相同）。大写 I 非常糟糕（很难与 l 和 i 以及 | 区分开来）。

3.  来自[Proggy Fonts](http://www.proggyfonts.com/)的 ProggyTiny，11pt。将行距设置为 0.9 使其在垂直方向上比 X11 的 xterm 字体更紧凑。无论哪种方式，它在水平方向上都占用了同样多的空间。不管有没有行空间压缩，我发现这个选项肯定比摩纳哥差。其他 Proggy 字体似乎不如 xterm 字体紧凑。

4.  [Anonymous](http://www.ms-studio.com/FontSales/anonymous.html) at 10pt，字符间距为 0.95（除了 Terminal.app，我仍然不知道如何压缩字符或行间距），正常行间距与 X11 字体的大小完全相同。压缩字符间距会导致大写字符彼此非常轻微地接触，这样数字就很难看。通过垂直（行）空间压缩，它可以比 xterm 字体在垂直方向上更紧凑，而不会损害可读性。（9pt 的匿名非常非常紧凑，并且仍然非常可读。）我真的不喜欢这种字体中的插入符号（“^”），无论是否挤压。

5.  [FixedMedium6x13](http://yootles.com/outbox/FixedMedium6x13.dfont)设置为大小 13 和行距 0.80*正好*产生 xterm 字体。我的朋友[David Yang](http://twitter.com/dyng)报告说，这对他在 Snow Leopard 上完美无缺。我在 Leopard 上，它对我来说是不可用的（因为有某种刷新问题，它会切断字母的顶部，直到终端窗口重新渲染，就像当你 alt-tab 远离它。

其他我打算尝试的：

*   羡慕代码 R：[http ://damieng.com/blog/2008/05/26/envy-code-r-preview-7-coding-font-released](http://damieng.com/blog/2008/05/26/envy-code-r-preview-7-coding-font-released)
*   Inconsolata： http: [//www.levien.com/type/myfonts/inconsolata.html](http://www.levien.com/type/myfonts/inconsolata.html)
*   Droid Sans Mono：[http://en.wikipedia.org/wiki/Droid_(font)](http://en.wikipedia.org/wiki/Droid_(font))

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-05-04T10:28:05.480

只需使用其中之一：

*   [http://henrik.synth.no/fonts/6x12.dfont](http://henrik.synth.no/fonts/6x12.dfont)
*   [http://henrik.synth.no/fonts/6x13.dfont](http://henrik.synth.no/fonts/6x13.dfont)
*   [http://henrik.synth.no/fonts/7x13.dfont](http://henrik.synth.no/fonts/7x13.dfont)
*   [http://henrik.synth.no/fonts/7x14.dfont](http://henrik.synth.no/fonts/7x14.dfont)

选择字体时，您可能希望将行高调整为 0.85。

（感谢[Marty Vona](https://stackoverflow.com/questions/379682/font-for-mac-osx-that-is-as-readable-and-compact-as-the-default-xterm-x11-font/1978169#1978169)的指导）

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-17T04:40:47.673

> xterms 中使用的字体非常紧凑且可读。那是什么字体？

您所指的字体称为“固定”或“6x13”。

我开始（但放弃了）[“6x13 redux”](http://fontstruct.fontshop.com/fontstructions/show/6x13_redux)，它本来是一种 TrueType 字体，它只在一种尺寸下看起来不错，但可以在 Terminal.app 中使用。我放弃了，因为使用 UNICODE 字形创建字体是一项艰巨的任务。 [看看这个 6x13 的字形表](http://rasher.dk/rockbox/fonts/misc/6x13-full.png)。顺便说一句，我创建的“6x13 Redux”字体似乎只适用于 Tiger 的 Terminal.app，而不是 Leopard。

我最接近 6x13 的是 11pt 的 ProggySquare。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-19T00:42:18.167

我最喜欢的像素字体是深色背景上 16pt 的“ **Dina** ttf 10px”。它是一种很好的编码字体，因为它有斜线零和不同的字符。

[您可以在http://www.geenat.com/?p=66](http://www.donationcoder.com/Software/Jibz/Dina/index.html)找到 Mac TrueType 版本，在[http://www.donationcoder.com/Software/Jibz/Dina/index.html](http://www.geenat.com/?p=66)找到 原始位图版本

Dina 基于的 Proggy 字体在小字体时也非常清晰。不幸的是，它对我来说有点太小了。

* * *

此外，您可以使用 SIMBL 插件来调整 Terminal.app 以更适合您。除了颜色偏好之外，我发现下面的所有插件在使用终端时都非常有用。

首先，Terminal.app 中的默认颜色很难看到。要解决此问题，您可以安装[Ciaran Walsh 的自定义颜色插件](http://ciaranwal.sh/2007/11/01/customising-colours-in-leopard-terminal)。

*   SIMBL - [http://www.culer.net/software/SIMBL/SIMBL.php](http://www.culater.net/software/SIMBL/SIMBL.php)
*   自定义颜色 - [http://ciaranwal.sh/2007/11/01/customising-colours-in-leopard-terminal](http://ciaranwal.sh/2007/11/01/customising-colours-in-leopard-terminal)
*   选项卡切换（如果您更喜欢 CMD-1 而不是 CMD-SHIFT-{}/箭头键）- [http://ciaranwal.sh/2007/12/10/tab-switching-in-terminal](http://ciaranwal.sh/2007/12/10/tab-switching-in-terminal)
*   遮阳板 - [http://visor.binaryage.com/](http://visor.binaryage.com/)
*   用于全屏的 MegaZoomer - [http://ianhenderson.org/megazoomer.html](http://ianhenderson.org/megazoomer.html)
*   IR_Black 配色方案 - [http://blog.infinitered.com/entries/show/6](http://blog.infinitered.com/entries/show/6)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-25T23:49:21.493

我一直在使用 Bitstream Vera Mono 后来 DeJaVu Sans Mono （用于更多 unicode 字符）很长一段时间，但几个月前我已经切换到 Android 使用的字体，谷歌的手机操作系统，称为[Droid Sans Mono](http://en.wikipedia.org/wiki/Droid_(font))。它对我来说真的更具可读性。对于 Terminal.app，我确实将其水平缩小了一点。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-19T00:20:32.093

X11 默认字体通常是位图字体，对非 X 应用程序没有任何用处……在我的 Mac 机器上，X11 应用程序的默认字体似乎是`-misc-fixed-medium-r-normal--14-130-75-75-c-70-iso8859-1`，对应于文件`/usr/X11/lib/X11/fonts/misc/7x14-ISO8859-1.pcf.gz`

您可以使用命令显示字符表`/usr/X11R6/bin/xfd -fn -misc-fixed-medium-r-normal--14-130-75-75-c-70-iso8859-1`并检查它是否是您在 xterms 中看到的字符表。如果是这样，恐怕没有什么可做的：PCF 字体是（非常）低分辨率的位图字体，这就是它们在屏幕上看起来如此出色的原因（它们恰好适合您的特定屏幕分辨率）；但是其他 Mac OS X 应用程序无法使用它们。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-07-13T06:27:26.223

我创建了类似于原始 Dina 的 DinaPro 字体，但对于 Mac ... [http://www.hexagonstar.com/blog/news/dinapro-coding-font-for-mac-released/](http://www.hexagonstar.com/blog/news/dinapro-coding-font-for-mac-released/)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-07-29T10:41:32.320

试试没有抗锯齿的andale mono...在我的mac pro 15in上看起来不错

# asp.net - 具有相同签名的网站上的程序集引用错误

> ID：379686
> 
> 赞同：2
> 
> 时间：2008-12-18T23:24:00.943
> 
> 标签：asp.net, iis-6, assemblies, reference, manifest

我在 IIS 6 和 Windows Server 2003 上拥有多个 ASP.NET 2.0 网站。每个网站都引用了一些 DLL：设计、逻辑等。每个站点都位于不同的 ApplicationPool 上，具有关于回收技术的默认配置。

每个 DLL 都是强命名的（不延迟）并且有一个永不改变的版本（2.0.0.0），所有的 DLL 都放在 GAC 中。

在我更新 GAC 中的 DLL（即 MyLibrary.dll）后，该 DLL 在某些东西（方法、类..）中发生了变化，以便在网站“A”中使用，并且在仅回收“A”应用程序池之后，当我尝试访问引用相同 DLL 的网站“B”我得到关于该 DLL 的常见错误：

> 找到的程序集的清单定义与程序集引用不匹配。（来自 HRESULT 的异常：0x80131040）

当然，DLL 中没有任何变化，而不是代码、相同的强键、相同的版本、文化。当然，错误在回收“B”应用程序池时消失了。

什么会产生奇怪的、**随机**的（我不得不说！）行为？还有更多的东西，比如散列，它用于比较程序集？

## 附录

*   [Perpetualcoder](https://stackoverflow.com/users/37494/perpetualcoder)问我如何引用 DLL，如果有完整的限定名，我认为是，这里有一行 web.config：

> 装配="MyNamespace.MyComponent，版本=2.0.0.0，文化=中性，PublicKeyToken=1234567890ASDFGH"

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-19T08:27:15.183

I keep repeating myself: don't store files in the GAC unless you absolutely have to. asp.net copies dlls to a temp folder and runs the site from there, it might be checksums mismatch between the loaded dll and the one in the tempfolder.

You should keep your site's dlls local to the sites, in their bin folder. It will give you more flexibility and you don't hurt application B by updating a dll for application A. you also get xcopy deployment for the low price of giving up a bit of diskspace.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-19T10:24:35.243

Frans，这是一个我理解的过程，它当然可以作为一种部署方式，但我不明白的是为什么即使完整的限定名称是正确的，但仍然会出现错误。我在 DLL 清单中看到，有哈希算法规范。ASP.NET 是否对 DLL 执行散列比较？

我的意思是：IIS/ASP.NET 发现 DDL“A”与 DLL“B”哈希不匹配，但三元组“key,culture,version”是相同的，所以为什么它不只是更新而是弹出出 web.config 错误？

# windows - 使用文件识别进程

> ID：379689
> 
> 赞同：27
> 
> 时间：2008-12-18T23:24:48.773
> 
> 标签：windows, winapi, wmi

我一直在试图弄清楚如何以编程方式识别锁定特定文件的进程。我已经搜索了 Win32 API 和 WMI，但到目前为止我找不到任何东西。我知道这是可能的 - Sysinternals 能够列出系统上每个进程访问/锁定的每个资源。

任何人都可以给我一个提示吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-01-11T20:00:53.523

您可以使用[Sysinternals 中的 handle.exe](http://technet.microsoft.com/en-us/sysinternals/bb896655)。

就像是：

```
> handle /accepteula C:\path\to\directory
...
program.exe           pid: 1234   type: File           2E4: C:\path\to\directory
... 
```

感谢[https://stackoverflow.com/a/599268/367916](https://stackoverflow.com/a/599268/367916)。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2016-05-20T06:47:49.450

您可以使用Microsoft 的[Process Explorer](https://technet.microsoft.com/pl-pl/sysinternals/processexplorer)

1.  下载并解压并运行**Process Explorer**
2.  单击**查找**菜单，然后单击**查找句柄或 DLL...**或按**CTRL + F**
3.  将路径复制并粘贴到文件的锁定文件夹
4.  单击**Search**，您可以从**Process Explorer**主窗口终止进程

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-08-12T21:31:36.890

如果您可以限制自己使用足够新的 Windows 版本，重新启动管理器可以告诉您[哪个进程打开了特定文件](http://blogs.msdn.com/b/oldnewthing/archive/2012/02/17/10268840.aspx)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-18T23:35:55.100

由于 Process Explorer 的工作方式，我怀疑您需要寻找的是一种查找附加到给定进程的文件句柄的方法，并且您必须为系统中的每个进程提取该列表并查找你的文件在里面。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-19T07:34:55.650

我不知道在 Windows 中，但有人可能会发现知道在 Linux 中，您可以使用*lsof*命令，或者只是搜索文件夹 /proc/PROCESS_ID/fd 并查看打开文件的进程很有用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-19T12:12:02.123

[WhoLockMe](http://www.dr-hoiby.com/WhoLockMe/)是一个不错的右键单击 Windows 资源管理器扩展。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-07-27T14:15:10.067

这篇[文章](http://www.codeguru.com/cpp/w-p/system/article.php/c2893)可能对你有帮助。

您似乎被迫使用 ntdll.dll 中未记录的函数搜索系统上每个进程的文件列表。

# php - 两个表的 PHP 连接帮助

> ID：379695
> 
> 赞同：1
> 
> 时间：2008-12-18T23:26:47.430
> 
> 标签：php, mysql, select, join

我只是在学习php，我完全迷失在这里。我以前从未真正使用过join，我想我需要在这里，但我不知道。我不指望任何人为我做这件事，但如果你能指出我正确的方向，那就太棒了，我已经尝试阅读有关连接的内容，但有 20 种不同的方法，我只是迷路了。

基本上，我手动编写了一个论坛，它工作正常但效率不高。

我有 board_posts（用于帖子）和 board_forums（用于论坛、类别和部分）。

我正在重做的部分是如何获取索引页最后一篇文章的信息。我设置它的方式是为了避免使用连接，我让它将最新帖子的信息存储在 board_forums 的表中，所以说有一个名为“Off Topic”的部分，我会有一个“forum_lastpost_username/userid”字段/posttitle/posttime”，当用户发布等时我会更新它。但这很糟糕，我试图动态地抓取它并摆脱这些字段。

现在我的查询就像：

```
`SELECT * FROM board_forums WHERE forum_parent='$forum_id'' 
```

然后我有一些东西，我可以在其中获取该论坛的信息（名称、描述等），最后一篇文章的所有数据都在那里：

```
 $last_thread_title = $forumrow["forum_lastpost_title"];
    $last_thread_time = $forumrow["forum_lastpost_time"];
    $lastpost_username = $forumrow["forum_lastpost_username"];
    $lastpost_threadid = $forumrow["forum_lastpost_threadid"]; 
```

但我需要摆脱它，并从 board_posts 获取它。在board_posts 中设置的方式是，如果是线程，post_parentpost 为NULL，如果是回复，则该字段具有线程的id（主题的第一篇文章）。所以，我需要获取最新的 post_date，看看是哪个用户发布的，然后看看 parentpost 是否为 NULL（如果它是 null，那么最后一个帖子是一个新线程，所以我可以在那里获取标题和用户的所有信息，但是如果不是，那么我需要获取该线程中第一个帖子的信息（标题，id）（可以通过查看 post_parentpost 是什么，查找该 ID 并从中获取标题来找到它。

这有任何意义吗？如果是这样，请帮助我:(

任何帮助是极大的赞赏！！！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-18T23:55:13.173

每当插入帖子或回复时更新 board___forums - 关于性能 - 并不是最糟糕的主意。要显示索引页面，您只需从一个表 board_forums 中选择数据 - 这绝对比选择第二个表来获取“最后帖子的信息”要快得多，即使使用巧妙的连接也是如此。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-19T02:27:57.837

看起来你已经做对了。

如果你要加入，你会这样做：

```
SELECT * FROM board_forums
JOIN board_posts ON board_posts.forum_id = board_forums.id
WHERE forum_parent = '$forum_id' 
```

这样做的问题是，它会让你*每篇文章都发帖*，这没有用（而且非常慢）。你*想要*做的是这样的

```
SELECT * FROM board_forums
JOIN board_posts ON board_posts.forum_id = board_forums.id ORDER BY board_posts.id desc LIMIT 1
WHERE forum_parent = '$forum_id' 
```

除了 SQL 不能那样工作。您不能订购或限制连接（或做许多其他有用的事情），因此您必须获取每一行，然后在代码中扫描它们（这很糟糕）。

简而言之，别担心。对于您确实希望一次加载所有论坛和所有帖子的实际情况，请使用连接。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-19T12:40:08.663

你最好只更新每个动作的统计信息，新帖子，删除帖子等。

其他实例可能不需要任何统计数据更新（删除线程将触发论坛更新，以在主题计数中显示更少的主题）。

想想用户会执行的所有操作，在大多数情况下，您不需要更新任何统计信息，因此，即时获取计数非常低效，您这样认为是正确的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-19T02:08:27.897

正如您已经发现的那样，简单的解决方案将导致大量查询，其中一些是可选的。

经典的方法是缓存结果，并且只偶尔检索一次。缓存不必长期存在；即使在繁忙的网站上两三秒也会产生重大影响。

将数据反规范化到您已经在阅读的表格中会有所帮助。这种方法可以节省您计算可选查询的时间，并且可能是一个便宜的胜利，因为它只是在插入已经发生时再进行一次更新。但它会将一些数据完整性转移到应用程序中。

顺便说一句，您的线程可能会遇到递归查询问题。如果您使用“简单”算法，关系数据库就不能很好地存储分层数据。更好的方法是有时称为“设置树”。不幸的是，谷歌有点难，所以[这里](http://blog.monstuff.com/archives/000026.html) [有](http://www.developersdex.com/gurus/articles/112.asp) [一些](http://weblog.openlaszlo.org/archives/2005/10/sorting-out-sql-trees/) [链接](https://stackoverflow.com/questions/201671/how-do-you-sort-a-tree-stored-using-the-nested-set-model#457424)。

# c# - F# 在数学上真的比 C# 更好吗？

> ID：379722
> 
> 赞同：31
> 
> 时间：2008-12-18T23:39:07.840
> 
> 标签：c#, math, f#

尽管有非托管语言，F# 在实现数学方面真的比 C# 更好吗？如果是这样，为什么？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-12-19T11:11:24.340

我认为其他人已经提到了大多数重要的观点：

1.  F# 让您以数学家思考问题的方式解决问题
2.  由于高阶函数，您可以使用更简单的概念来解决难题
3.  默认情况下一切都是不可变的，这使得程序更容易理解（也更容易并行化）

确实可以使用 C# 3.0 中的一些 F# 概念，但存在一些限制。您不能使用任何递归计算（因为 C# 没有尾递归），这就是您以函数/数学方式编写原始计算的方式。此外，在 C# 中编写复杂的高阶函数（将其他函数作为参数）很困难，因为您必须显式编写类型（而在 F# 中，类型是推断的，但也会自动泛化，因此您不必显式地使泛型函数）。

另外，我认为 Marc Gravell 的以下观点不是一个有效的反对意见：

> 从维护的角度来看，我认为适当命名的属性等比元组和头/尾列表更容易使用（在整个生命周期中），但这可能只是我。

这当然是真的。然而，F# 的伟大之处在于您可以开始使用元组和头/尾列表编写程序，然后在开发过程中将其转换为使用 .NET IEnumerables 和具有属性的类型的程序（这就是我认为典型的 F#程序员工作*）。Tuples 等和 F# 交互式开发工具为您提供了一种快速原型解决方案的好方法（在进行数学运算时，这是必不可少的，因为大多数开发只是在您寻找最佳解决方案时进行试验）。一旦有了原型，就可以使用简单的源代码转换将代码封装在 F# 类型中（也可以从 C# 中将其用作普通类）。F# 还为您提供了很多稍后在性能方面优化代码的方法。

这为您提供了易于使用的语言（例如 Python）的好处，许多人将其用于原型设计阶段。但是，一旦使用高效的语言（例如 C++ 或可能是 C#）完成原型设计后，您就不必在以后重写整个程序，因为 F# 既“易于使用”又“高效”，您可以流畅地切换这两种风格之间。

(*) 我在我的[函数式编程书中](http://manning.com/petricek/)也使用了这种风格。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2010-02-14T00:09:07.837

在数学程序的上下文中，F# 比 C# 有许多巨大的好处：

*   F# 交互式会话让您可以即时运行代码以立即获得结果，[甚至将其可视化](http://fsharpnews.blogspot.com/2010/02/f-for-visualization-video-tutorial.html)，而无需构建和执行完整的应用程序。

*   F# 支持一些可以在数学环境中提供大量性能改进的功能。最值得注意的是，`inline`高阶函数的组合允许优雅地分解数学代码，而不会对性能产生不利影响。C# 无法表达这一点。

*   F# 支持一些特性，这些特性使得实现数学概念比在 C# 中更自然地实现成为可能。例如，尾调用使简单可靠地实现递归关系变得更加容易。C# 也无法表达这一点。

*   数学问题通常需要使用更复杂的数据结构和算法。与 C# 相比，使用 F# 表达复杂的解决方案要容易得多。

如果您想要案例研究，我将 QR 分解的实现`System.Double`从 C# 的 2kLOC 转换过来。F# 只有 100 行代码，运行速度快了 10 倍以上，并且在数字类型上泛化，因此它不仅适用于`float32`，`float`甚至`System.Numerics.Complex`可以应用于符号矩阵以获得符号结果！

FWIW，我[写](http://www.ffconsultancy.com/products/fsharp_for_technical_computing/?so)关于这个主题的书以及商业软件。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-12-24T13:51:25.867

F# 支持[度量单位](http://blogs.msdn.com/andrewkennedy/archive/2008/08/29/units-of-measure-in-f-part-one-introducing-units.aspx)，这对于数学工作非常有用。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-12-19T08:34:40.553

我来自数学背景，并且看过 F#，但在大多数情况下我仍然更喜欢 C#。F# 让一些事情变得更容易，但总的来说，我仍然更喜欢 C#。

一些吹捧的 F# 好处（不变性、高阶函数等）仍然可以在 C# 中完成（后者使用委托等）。当使用具有 lambda 支持的 C# 3.0 时，这一点更加明显，这使得声明函数式代码变得非常容易和富有表现力。

从维护的角度来看，我认为适当命名的属性等比元组和头/尾列表更容易使用（在整个生命周期中），但这可能只是我。

C# 在数学方面让自己失望的领域之一是泛型及其对运算符的支持。所以我花了一些时间来解决这个问题；-p 我的结果在[MiscUtil中可用，](http://www.pobox.com/~skeet/csharp/miscutil/)[这里](http://www.pobox.com/~skeet/csharp/miscutil/usage/genericoperators.html)有概述。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-12-19T00:00:07.173

这篇文章看起来可能是相关的：http: [//fsharpnews.blogspot.com/2007/05/ffts-again.html](http://fsharpnews.blogspot.com/2007/05/ffts-again.html)

另外：[C#/F# 性能比较](https://stackoverflow.com/questions/144227/c-f-performance-comparison)

纯数学的最大优势是 PerpetualCoder 所说的，F# 看起来更像是一道数学题，所以对于数学家来说会更容易写。当我看着它时，它让我想起了很多 MATLAB。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-18T23:50:30.563

我不确定它是好是坏，但方法肯定有所不同。静态语言过度指定如何解决问题。F# 或 Haskell 等函数式语言不这样做，并且更适合数学家如何解决特定问题。然后你有像[这样](https://rads.stackoverflow.com/amzn/click/com/3540739157)的书，吹捧 python 擅长它。如果您从性能的角度来看，没有什么能比 C 更胜一筹。如果您从库中讨论，我相信函数式语言（F# 等）、Fortan（是的，它还没有死），Python 拥有出色的数学库。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2008-12-19T08:39:48.763

函数式语言的一大优势是它们可以在多处理器或多核系统上并行运行，而无需您更改任何代码。这意味着您可以通过简单地添加内核来加速您的算法。

# search - 搜索集成

> ID：379739
> 
> 赞同：1
> 
> 时间：2008-12-18T23:48:40.957
> 
> 标签：search

我正在一个网站上工作，该网站目前具有许多不同的搜索功能，例如：

*   “通过网站的前门”爬行
*   与 Web 服务通信的搜索
*   ETC...

将这些结合在一起并提供看似统一的搜索功能的最佳方式是什么？

[我在维基百科上](http://en.wikipedia.org/wiki/List_of_enterprise_search_vendors)找到了以下列表

### 免费和开源的企业搜索软件

*   Lucene 和 Solr
*   夏必安

### 专有企业搜索软件的供应商

*   现在问我
*   自治公司
*   概念搜索有限公司
*   康沃
*   Dieselpoint, Inc.
*   dtSearch 公司
*   Endeca 技术公司
*   Exalead
*   专家系统公司
*   漏斗
*   谷歌搜索设备
*   IBM
*   ISYS 搜索软件
*   微软（包括微软搜索服务器、快速搜索和传输）：
*   开放文本公司
*   甲骨文公司
*   Queplix 通用搜索设备
*   树液
*   兆文本
*   维维西莫
*   X1 技术公司
*   ZyLAB 技术

感谢您对此提出任何建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-11T01:08:35.563

Solr 是一个令人难以置信的灵活搜索解决方案。就在去年，我编写了 2 个基于 solr 的网站，并在现有的第三个网站上工作，每个网站都以非常不同的方式工作。

Solr 只是吃 XML 请求来添加一些东西到索引，以及 XML 请求来搜索索引中的东西。它不会为您进行爬网或文本提取，但大多数时候这些都很容易做到。Solr/Lucene 堆栈有许多现有的插件，所以可能已经存在适合您的东西。

除非您确定 Solr 不够用，否则我会避免使用专有软件。这是我用过的最好的程序之一，在您需要时非常灵活，同时您可以在几分钟内开始，而无需阅读冗长的手册。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-09T18:40:24.093

请注意，无论您使用哪种搜索解决方案，搜索设置本质上都是“不同的”。您仍将拥有一个索引器、一个搜索 UI 或“框架”。

通过结合特定的搜索技术，您将陷入困境。您实际上**希望**UI 尽可能与搜索后端分开。后端可能会停止扩展，或者明天可能会有更好的搜索引擎。

切换搜索引擎非常普遍，因此永远不要在编写界面时考虑到特定的搜索引擎。总是抽象它，所以 UI 不知道实际使用的搜索技术。

保持模块化，你以后会感谢自己的。

通过使用标准的 Web 服务界面，您还可以允许第 3 方为您构建东西，而他们不必“学习”您在后端使用的任何搜索引擎。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-19T01:03:57.793

看看这些类似的问题：

*   [与自定义 Web 应用程序集成的最佳文本搜索引擎？](https://stackoverflow.com/questions/117987/best-text-search-engine-for-integrating-with-custom-web-app)
*   [如何在网站中实现搜索功能？](https://stackoverflow.com/questions/34314/how-do-i-implement-search-functionality-in-a-website)

我个人的推荐：[Solr](http://lucene.apache.org/solr/)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-03T16:12:44.457

所有这些公司都提供通用搜索的不同功能。较小的公司为自己创造了非常实用且非常需要的利基市场。例如，Queplix 通过从所有索引应用程序中提取数据、业务对象、角色和权限，使任何搜索引擎都可以处理结构化数据和企业应用程序。它提供企业排名标准以及数据合规警报。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-02-05T17:24:07.160

在提出原始问题时，另外两个不那么知名和/或可用的解决方案：

*   [谷歌自定义搜索](https://www.google.com/cse/)- 特别是最近添加了禁用公共 URL 选项
*   [YaCy](http://yacy.net/en/index.html) - 您可以加入网络或下载并滚动您自己的独立服务器

# visual-studio - 如何使用 Visual Studio 和 Firebird 设置 NHibernate？

> ID：379748
> 
> 赞同：1
> 
> 时间：2008-12-18T23:54:17.000
> 
> 标签：visual-studio, nhibernate, firebird

我正在尝试设置一个小应用程序来在 Visual Studio 中试验 NHibernate，但我还没有走远。

我得到的错误是：“在配置中找不到方言”。

我尝试在 app.config 和 hibernate.cfg.xml 中指定设置，但似乎都不起作用。这些文件与我的应用程序源位于同一目录中（也尝试过其他目录）。我尝试将 hibernate.cfg.xml 上的构建操作设置为“嵌入式资源”，但这也无济于事。即使我完全删除了这些配置文件，我也会收到相同的错误消息。

我查看了网上的各种示例，但无法对其进行排序......有谁知道问题可能是什么？

这是我的应用程序源，app.config 和 hibernate.cfg.xml

## 应用程序源

```
using NHibernate;
using NHibernate.Cfg;

namespace Timer
{
    public partial class Form1 : Form
    {
        Configuration cfg;
        ISessionFactory factory;
        ISession session;
        ITransaction transaction;

        public Form1()
        {
            cfg = new Configuration();
            //cfg.AddAssembly("Timer");
            //cfg.AddFile("WorkoutSet.hbm.xml");

            factory = cfg.BuildSessionFactory();
            session = factory.OpenSession();
            transaction = session.BeginTransaction();

            InitializeComponent();
        }
    }
} 
```

## 应用程序配置

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
    <configSections>
        <section
          name="nhibernate"
          type="System.Configuration.NameValueSectionHandler, System, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"
        />
        <section
            name="log4net"
            type="log4net.Config.Log4NetConfigurationSectionHandler,log4net" 
        />

    </configSections>

    <nhibernate>
        <add
          key="hibernate.connection.provider"
          value="NHibernate.Connection.DriverConnectionProvider"
        />
        <add
          key="hibernate.dialect"
          value="NHibernate.Dialect.FirebirdDialect"
        />
        <add
          key="hibernate.connection.driver_class"
          value="NHibernate.Driver.FirebirdClientDriver"
        />
        <add
          key="hibernate.connection.connection_string"
          value="User=sysdba;Password=masterkey;Database=C:\X\Test\Timer\Timer.FDB;Dialect=3;ServerType=1;"
        />
    </nhibernate>

    <log4net debug="false">

        <!-- Define some output appenders -->
        <appender name="trace"
              type="log4net.Appender.TraceAppender, log4net">
            <layout type="log4net.Layout.PatternLayout,log4net">
                <param name="ConversionPattern"
                     value="%d{ABSOLUTE} %-5p %c{1}:%L - %m%n" />
            </layout>
        </appender>

        <appender name="console"
              type="log4net.Appender.ConsoleAppender, log4net">
            <layout type="log4net.Layout.PatternLayout,log4net">
                <param name="ConversionPattern"
                     value="%d{ABSOLUTE} %-5p %c{1}:%L - %m%n" />
            </layout>
        </appender>

        <appender name="rollingFile"
              type="log4net.Appender.RollingFileAppender,log4net" >

            <param name="File" value="h:\log.txt" />
            <param name="AppendToFile" value="false" />
            <param name="RollingStyle" value="Date" />
            <param name="DatePattern" value="yyyy.MM.dd" />
            <param name="StaticLogFileName" value="true" />

            <layout type="log4net.Layout.PatternLayout,log4net">
                <param name="ConversionPattern"
                  value="%d [%t] %-5p %c - %m%n" />
            </layout>
        </appender>

        <!-- Setup the root category, add the appenders and set the default priority -->
        <root>
            <priority value="DEBUG" />
            <appender-ref ref="console" />
        </root>

        <logger name="NHibernate">
            <level value="DEBUG" />
        </logger>

    </log4net>

    <runtime>
        <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
            <qualifyAssembly partialName="FirebirdSql.Data.FirebirdClient"
                fullName="FirebirdSql.Data.FirebirdClient, Version=2.0.1.0, Culture=neutral, PublicKeyToken=3750abcc3150b00c" />
        </assemblyBinding>
    </runtime>
</configuration> 
```

## 休眠.cfg.xml

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
    <configSections>
        <section
          name="nhibernate"
          type="System.Configuration.NameValueSectionHandler, System, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"
    />
    </configSections>

    <nhibernate>
        <add
          key="hibernate.connection.provider"
          value="NHibernate.Connection.DriverConnectionProvider"
    />
        <add
          key="hibernate.dialect"
          value="NHibernate.Dialect.FirebirdDialect"
    />
        <add
          key="hibernate.connection.driver_class"
          value="NHibernate.Driver.FirebirdClientDriver"
    />
        <add
          key="hibernate.connection.connection_string"
          value="User=sysdba;Password=masterkey;Database=C:\X\Test\Timer\Timer.FDB;Dialect=3;ServerType=1;"
    />
    </nhibernate>
</configuration> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-21T19:12:59.230

好的谢谢大家，我已经整理好了。看来我需要调用 cfg.Configure() 来处理 hibernate.cfg.xml ......一旦我这样做了，就会出现一些其他错误，但它们都是非常合乎逻辑的，可以修复有意义的错误消息。

这是有效的初始化代码。

```
public Form1()
{
    cfg = new Configuration();
    cfg.Configure();

    factory = cfg.BuildSessionFactory();
    session = factory.OpenSession();
    transaction = session.BeginTransaction();

    InitializeComponent();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-19T03:42:57.957

如果您使用的是 NHibernate 2.0，但按照参考 1.2 的说明进行操作，则配置 xml 已更改，这将导致您的问题。

尝试（在 app.config 中，省略`configSections`独立文件）：

```
 <configSections>
    <section name="hibernate-configuration" type="NHibernate.Cfg.ConfigurationSectionHandler, NHibernate"/>
  </configSections>
  <hibernate-configuration xmlns="urn:nhibernate-configuration-2.2">
    <session-factory>
      <property name="connection.provider">NHibernate.Connection.DriverConnectionProvider</property>
      <property name="dialect">NHibernate.Dialect.FirebirdDialect</property>
      <property name="connection.driver_class">NHibernate.Driver.FirebirdClientDriver</property>
      <property name="connection.connection_string">User=sysdba;Password=masterkey;Database=C:\X\Test\Timer\Timer.FDB;Dialect=3;ServerType=1;</property>
    </session-factory>
  </hibernate-configuration> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-07T07:40:27.630

> cfg.Configure();

真的有帮助......非常感谢。早些时候我正在使用

> cfg.AddAssembly(Assembly.GetCallingAssembly());

没有成功

# wpf - 在 Prism 中使用 ModuleManager 加载模块

> ID：379751
> 
> 赞同：6
> 
> 时间：2008-12-18T23:56:36.323
> 
> 标签：wpf, prism, modularity

这个问题也发布在[Prism 的 Codeplex 网站上](http://www.codeplex.com/CompositeWPF)。

我对按需加载模块有点迷茫，希望你们能不吝赐教。我正在使用**v2 #7**。

## 这是我想要完成的事情：

> 1) 我有 2 个区域 - 一个用于实例化模块的按钮 (MenuRegion)，另一个用于显示模块 (MainRegion)。在 MenuRegion 中一次只能看到一个模块。
> 2) 模块位于目录中
> 3) MenuModule 模块与 MenuRegion 相关联，用于创建显示模块名称的按钮。当单击其中一个按钮时，相应的模块将被加载并显示在 MainRegion 中。
> 4) 行为：
>     a) 单击 ModuleA 按钮并显示 ModuleA。用户在 ModuleA 中输入数据，数据处于未保存状态。
>     b) 单击 ModuleB 按钮并显示 ModuleB。用户在 ModuleB 中输入数据，数据处于未保存状态。
>     c) 单击 ModuleA 按钮，ModuleA 将显示先前输入的信息。

## 如果我的假设有误，请纠正我，并请给我其他建议：

> 1) MainRegion 应该是一个 ContentControl，因此一次只能看到一个模块。
> 2）我想我需要枚举我的目录的“GrouplessModules”来获取目录中可用模块的 ModuleInfo
> 3）要加载模块，我认为我需要调用 myModuleManager.LoadModule(moduleName)

## 最后，我的问题：

> 1) 我应该在 MenuModuleView 的构造函数中将 moduleManager 作为参数吗？
> 2) 我如何获取从 MenuModuleView 内部访问的目录，以便枚举可用模块？
> 3) 在MenuModuleView 中，当我枚举模块时，我创建了按钮，将ModuleInfo 分配给按钮的Tag 属性。这样，我只有一个点击事件来加载模块。它是否正确？对我来说，它闻起来有点变通...

非常感谢你的帮助！！！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-19T09:24:30.140

> 1) 我应该在 MenuModuleView 的构造函数中将 moduleManager 作为参数吗？

从技术上讲，你可以。但实际上，如果您这样做，您仍然需要为您的视图定义一个默认构造函数。否则，您的视图将不适用于设计师。因此，我建议使用属性将依赖项传递给 UI 组件。

> 2) 我如何获取从 MenuModuleView 内部访问的目录，以便枚举可用模块？

您将依赖 Prism 的`IModuleEnumerator`接口，并且依赖注入将负责将模块枚举器提供给您的视图。假设您将 Prism 与 Unity 容器一起使用，则看起来像这样：

```
[Dependency]
public IModuleEnumerator ModuleEnumerator 
{
    get; set;
} 
```

> 3) 在MenuModuleView 中，当我枚举模块时，我创建了按钮，将ModuleInfo 分配给按钮的Tag 属性。这样，我只有一个点击事件来加载模块。它是否正确？对我来说，它闻起来有点变通。

我建议您让每个按钮引发相同的 WPF 命令，而是将 分配`ModuleInfo`给`Button`'`CommandParameter`属性。同样，Prism 有基础设施来帮助您在复合场景中干净利落地完成此操作。见`DelegateCommand`课堂。

最后一点，请注意，虽然您可能能够延迟加载模块，但您将无法卸载它们。为此，您将需要`AppDomain`隔离，这是另一回事。

# .net - 关于IdeaBank的意见？

> ID：379753
> 
> 赞同：0
> 
> 时间：2008-12-19T00:00:07.160
> 
> 标签：.net, reference

我是一名 PHP 开发人员，正在考虑实施[IdeaBank](http://www.brainbankinc.com/idealinkOpen.aspx)的工作，这是用 .net 编写的创意管理软件。该软件似乎是根据其功能和客户选择的。[OpenDNS 社区](http://ideabank.opendns.com/)似乎正在使用它。

有人熟悉这个软件吗？定制和维护是什么感觉？你会推荐给其他程序员吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-19T16:29:25.643

尽管名称相似，但 OpenDNS 上的 IdeaBank 社区功能与您引用的 .Net 软件无关。它基于使用 PHP 的 Pligg。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-01T20:59:12.160

更新 - 我从未发现有人使用 IdeaBank，现在称为[IdeaLink](http://www.brainbankinc.com/idealinkSequential.aspx "创意链接")，这是 BrainBank 销售的[产品](http://www.brainbankinc.com/about.aspx "脑库")。但是他们没有给我这个职位，所以我的问题解决了！

# sql-server - 是否有适用于 SQL Server Compact 3.5 的 Perl DBI 驱动程序？

> ID：379765
> 
> 赞同：1
> 
> 时间：2008-12-19T00:07:27.457
> 
> 标签：sql-server, perl, dbi

也许我没有找对地方，但我想使用 SQL Server Compact 3.5 作为使用 DBI（在 Windows 上）的现有 Perl 应用程序的后端。

我特别关注 SQL Server Compact 3.5，因为我想使用[MS Sync Framework](http://msdn.microsoft.com/sync)中对它的现有支持来开始使用，而不是我目前使用的 SQLite db。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-19T01:09:37.440

我没有看到任何东西，因为没有用于 SQL Server Compact 的 ODBC 驱动程序，所以唯一的选择是使用 DBD::ADO。

# sql-server - 标识 (int) 超过 maxint 的 SQL Server 2005 表会发生什么情况？

> ID：379768
> 
> 赞同：7
> 
> 时间：2008-12-19T00:08:20.310
> 
> 标签：sql-server

例如，SQL Server 会警告您还是会死掉？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-12-19T00:15:11.277

当您溢出 IDENTITY 列时，SQL Server 2005 将引发以下错误。

```
Server: Msg 8115, Level 16, State 1, Line 1
Arithmetic overflow error converting IDENTITY to data type int.
Arithmetic overflow occurred. 
```

您的身份列不必限制为 INT，如果您怀疑 INT 不够大，确实可以将其设置为 BIGINT。

INT（32 位签名）将上升到 2,147,483,647，BIGINT（64 位签名）将上升到 9,223,372,036,854,775,807（即 9 万亿，足够地球上每人 13 亿个身份）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-19T00:16:22.943

它可能会两者兼而有之。

# arrays - 将字符串复制到指向指针的指针

> ID：379772
> 
> 赞同：1
> 
> 时间：2008-12-19T00:09:50.650
> 
> 标签：arrays, string, char

我正在使用这个例子：

```
char *myData[][2] =
{{"John", "j@usa.net"},
 {"Erik", "erik@usa.net"},
 {"Peter","peter@algonet.se"},
 {"Rikard","rikard@algonet.se"},
 {"Anders","anders@algonet.se"}};   

char **tableData[6];
tableData[0] = myData[0];
tableData[1] = myData[1];
tableData[2] = myData[2];
tableData[3] = myData[3];
tableData[4] = myData[4];
tableData[5] = NULL;//null terminated array 
```

而是想为姓名和电子邮件放置我自己的字符串。（尝试将字符串 xyz 放入 myData，然后放入 tableData）带有 myData 的 strcpy 将不起作用。我已经尝试了指针和引用的所有组合，但它似乎没有复制字符串。有什么建议么？

```
 ok--> strncpy(xyz, argv[i], strlen(argv[i]));
             ok--> strcpy(xyz + strlen(argv[i]), "\0");
run time stops here--> strncpy(myData[i][0], xyz, strlen(xyz));  
                   tableData[i] = myData[i]; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-19T00:18:49.243

初始化时的指针`myData[][]`指向文字字符串。无法写入该内存。

您可以为新字符串分配新内存，并将指向新字符串的指针放入`myData`. 或者对于您似乎正在做的事情，只需存储指向 argv[] 字符串的指针（只要您以后不打算修改字符串）。

另外，请确保您将字符串复制到的内存块足够大以容纳新字符串。

软件猴子编辑：包括 \0 终止符；并确保在适当的时候释放内存。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-19T00:39:31.883

创建您自己的数据本地副本并更改列表中的指针：

```
char **newentry = malloc(sizeof(char*) * 2);
newentry[0] = strdup(myNewName);
newentry[1] = strdup(myNewEmail);
tableData[i] = newentry; 
```

那是容易的部分。完成后最困难的部分是释放内存。如果这只是一个小小的一次性 C 程序，你可能可以在不释放内存的情况下逃脱，因为操作系统会在应用程序退出时自动释放它。

但是如果你想用大写的“P”正确地做到这一点，我会做几个小功能来复制和释放表格项目：

```
void tableFreeItem(int i)
{
    if(tableData[i] != 0)
    {
       free(tableData[i][0]);
       free(tableData[i][1]);
       free(tableData[i]);
    }
}

void tableSetItem(int i, char *name, char *email)
{
    tableFreeItem(i);

    tableData[i] = malloc(sizeof(char *) * 2);
    tableData[i][0] = strdup(name);
    tableData[i][1] = strdup(email);
} 
```

现在我们可以随意替换列表中的项目，并且可以通过调用 tableFreeItem() 函数轻松释放内存。以下是如何使用这些功能的示例：

```
#define TABLE_SIZE 5

char **tableData[TABLE_SIZE + 1]; /* +1 to make room for NULL terminator */

/* Clear out the table. This also sets up the NULL terminator at the end. */
    memset(tableData, 0, sizeof(tableData));

/* Copy the original data into the table */
    for(i = 0; i < TABLE_SIZE; i++)
        tableSetItem(i, mydata[i][0], myData[i][1]);

/* Change a data item */
    tableSetItem(3, "Adam Pierce", "adam@doctort.org");

/* Free memory when we have finished */
    for(i = 0; i < TABLE_SIZE; i++)
        tableFreeItem(i); 
```

*免责声明：我没有尝试编译或运行此代码，我只是从头顶敲下来。它可能会起作用。*

# xcode - 在 Xcode 中添加框架

> ID：379781
> 
> 赞同：3
> 
> 时间：2008-12-19T00:13:22.560
> 
> 标签：xcode, macos, frameworks

我试图在 Xcode 中添加第三方框架，但我收到一个错误，无法找到它

> 错误：MKAbeFook/MKAbeFook.h：没有这样的文件或目录

我已将其添加到 Linked Frameworks 组中，并将其添加到该项目的 Target 中。我还将它添加到该目标的新复制文件构建阶段。

基本上我已经按照这里的说明进行操作：http: [//pointlesscrap.net/mkabefook/desktop/gettingstarted](http://pointlesscrap.net/mkabefook/desktop/gettingstarted)

有什么想法我哪里出错了吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-19T05:51:12.037

诊断此问题的最佳方法是发布编译器调用行，而不仅仅是错误（您可以从“构建结果”窗口拖放显示“正在编译 foo.m”的行）。我的期望是您没有为框架的位置设置框架搜索路径。Xcode 通常在您添加框架时手动添加，但如果您将其放在某些位置，或者以某些方式添加它，您需要手动将目标的框架搜索路径指向其目录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-19T03:57:55.447

也许作者把 MKFaceBook 误认为是 MKAbeFook？

编辑：没关系，看起来这实际上是框架的名称。

# iphone - 当我在使用 MPMoviePlayerController 播放电影时按“完成”时，将显示哪个视图

> ID：379791
> 
> 赞同：1
> 
> 时间：2008-12-19T00:18:24.330
> 
> 标签：iphone, mpmovieplayercontroller

我正在使用 MPMoviePlayerController 播放电影，

我正在使用 TableView，我的应用程序发生的事情是，当我按下附件按钮时，它将显示详细视图，当我按下单元格区域时，它将播放我想要的电影，（youtube 应用程序的方式）

但是当我在播放电影时按“完成”时，它会导航到一个视图，该视图不是我的详细视图，而是一些空视图。

知道我应该怎么做才能实现它，以便当用户按下“完成”时，它会将我导航到我的详细视图而不是一些空视图。

我试图在执行“movieFinishedCallback”时推送视图，但它会在那个空视图上再推送一个视图。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-19T06:48:09.627

理想情况下，如果您的代码正确，按下 MPMoviePlayerController 对象上的 Done 按钮将关闭 MPMOviePlayerController 并返回调用它的控制器（在您的情况下是详细视图）

你不需要在movieDidFinishCallback 中做任何事情，除了释放movieplayer 对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-30T11:50:12.687

```
-(void)myMovieFinishedCallback:(NSNotification*)aNotification { 
    MPMoviePlayerController* theMovie = [aNotification object]; 
    theMovie.initialPlaybackTime = -1.0;
} 
```

# ruby-on-rails - 如何关闭“periodically_call_remote”

> ID：379797
> 
> 赞同：5
> 
> 时间：2008-12-19T00:24:12.773
> 
> 标签：ruby-on-rails, ruby, ajax

我在我的网络应用程序中`periodically_call_remote`更新了一个 div ( )。`main_div`这`main_div`包含用户可以单击的链接，这些链接会调用覆盖 .txt 中的数据的操作`main_div`。

我的问题是计时器正在`periodically_call_remote`函数上运行，即使用户已经离开页面，该函数调用仍然想要返回。如果`main_div`页面上存在 ，则函数调用会清除当前显示的数据。如果`main_div`不在页面上，则 javascript 返回一个错误对话框。

所以，我的问题是，当用户离开定期更新的 div 时，我该如何停止函数调用？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-19T18:04:56.467

该线程：[http](http://www.ruby-forum.com/topic/119372) ://www.ruby-forum.com/topic/119372提供了我需要的答案。

本质上，它归结为`periodically_call_remote`在`application_helper.rb`文件中覆盖以将其`PeriodicalExecutor`放入 js 变量中。

然后，您可以`poller.stop();`随时取消通话。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2008-12-19T12:03:26.587

您可能希望设置布局/模板以有条件地启用更新程序

# mysql - 使用脚本将 MYSQL 数据从 stage 复制到 dev

> ID：379815
> 
> 赞同：1
> 
> 时间：2008-12-19T00:40:59.510
> 
> 标签：mysql, replication

我的应用程序有两个版本，一个“阶段”和一个“开发”。

现在，“舞台”被暴露在现实世界中进行beta测试。

有时，我希望将数据的精确副本复制到“开发”数据库中。

两个数据库都在同一台托管的 Linux 机器上。

有时我会在开发环境中创建“虚拟”数据。在这个阶段，如果它需要在阶段被重写，我会很好。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-19T17:23:51.120

请务必为您的脚本添加安全性，以便只有您授权的用户才能运行该脚本。基本上你想使用 mysql 和 mysqldump 命令。

```
mysqldump -u username --password=userpass --add-drop-database --add=locks --create-options --disable-keys --extend-insert --result-file=database.sql databasename
mysql -u username --password=userpass -e "source database.sql;" 
```

第一个命令将进行备份，第二个命令将备份带到另一个数据库引擎。 **要小心**，因为如果你在 mysql 的同一个进程上运行它，你只是备份数据库然后将它恢复到同一个数据库，你必须更改数据库名称。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-19T00:54:59.217

只需使用[mysqldump](http://dev.mysql.com/doc/refman/5.1/en/mysqldump.html)创建临时数据库的备份，然后将转储文件加载到您的开发数据库上。这将为您提供舞台数据的准确副本。

# c# - 使用 CodeDomProvider 编译不允许 C# 或 VB 的新功能

> ID：379818
> 
> 赞同：6
> 
> 时间：2008-12-19T00:42:03.767
> 
> 标签：c#, .net, vb.net, scripting

我正在使用 CodeDomProvider、CompilerInfo 和 CompilerParameters 在运行时编译一些 C# 和 VB 代码。它工作得很好，我真的很喜欢能够为我的应用程序添加脚本支持，但它似乎只支持 .NET 2.0 语法。例如，C# 不支持 var 关键字，VB 不支持 If(bool, string, string) 表达式。

我如何告诉它以 3.5 框架为目标？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-19T00:42:13.890

好的，我从[Anders Norås](http://andersnoras.com/blogs/anoras/archive/2008/04/13/codedomproviders-and-compiler-magic.aspx)那里发现了一个重要提示，即 CSharpCodeProvider 构造函数有一个构造函数，它接受一些选项，包括编译器版本。当我查看[MSDN 文档](http://msdn.microsoft.com/en-us/library/bb537926.aspx)时，我发现在 App.config 文件中指定编译器选项更简洁。这是一个例子：

```
<system.codedom>
  <compilers>
    <compiler
      language="vb;vbs;visualbasic;vbscript"
      extension=".vb"
      type="Microsoft.VisualBasic.VBCodeProvider, System, 
        Version=2.0.3600.0, Culture=neutral, 
        PublicKeyToken=b77a5c561934e089"
      compilerOptions="/optimize"
      warningLevel="1" >
      <providerOption
        name="CompilerVersion"
        value="v3.5" />
    </compiler>
    <compiler
      language="c#;cs;csharp"
      extension=".cs"
      type="Microsoft.CSharp.CSharpCodeProvider, System, 
        Version=2.0.3600.0, Culture=neutral, 
        PublicKeyToken=b77a5c561934e089"
      compilerOptions="/optimize"
      warningLevel="1" >
      <providerOption
        name="CompilerVersion"
        value="v3.5" />
    </compiler>
  </compilers>
</system.codedom> 
```

我唯一的失望是，现在我从 CodeDomProvider.GetAllCompilerInfo() 获得了每个编译器的两个版本。配置文档说 App.config 应该覆盖 machine.config 设置，但我得到了两者。到目前为止，App.config 总是在 machine.config 之后，所以我只是让后面的覆盖前面的。有人知道如何避免重复吗？

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-19T00:57:24.873

不确定您将使用 app.config 去哪里，但这是您如何告诉它使用 3.5 框架的方法。

```
var csc = new CSharpCodeProvider(new Dictionary<string, string>() { { "CompilerVersion", "v3.5" } }); 
```

[http://blogs.msdn.com/lukeh/archive/2007/07/11/c-3-0-and-codedom.aspx](http://blogs.msdn.com/lukeh/archive/2007/07/11/c-3-0-and-codedom.aspx)

# javascript - 是否可以使用 Django 从 JS 文件中包含 CSS（这是棘手的部分）？

> ID：379827
> 
> 赞同：1
> 
> 时间：2008-12-19T00:49:34.860
> 
> 标签：javascript, css, django, dom

据我所知，没有办法在动态 JS 文件中使用 {% include %} 来包含样式。但我不想再次调用服务器来下载样式。

也许可以通过获取样式表并将其注入到文档的 head 元素中……以前有人这样做过吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-19T01:52:18.913

在您的 JS 文件中：

```
var style = document.createElement('link');
style.setAttribute('rel', 'stylesheet');
style.setAttribute('type', 'text/css');
style.setAttribute('href', 'style.css');
document.getElementsByTagName('head')[0].appendChild(style); 
```

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-27T23:44:54.923

用jquery...

```
$('head').append($('<link rel="stylesheet" type="text/css" href="style.css">')) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-19T01:49:18.873

我可以设想您想要动态生成 JS 或 CSS 的情况，但通常您最好为每个文件创建静态文件并使您的代码足够通用以满足您的所有需求。

这超出了代码重用的简单问题 - 如果您要动态生成其中的任何内容，则每次使用时都需要重新下载。您正在浪费 CPU 时间来渲染模板，并浪费带宽一遍又一遍地通过线路发送相同（或可能相同）的数据。

但是，如果您有一个很好的元编码用例，那么您也没有理由不能：

a) 将 JS 或 CSS 放在渲染模板的标题（或正文，如果是 JS）中 b) 为 JS 或 CSS 创建一个视图，并使用 Django 的模板引擎来渲染它们。

{% include %} 标签适用于 (a)，对于 (b)，您只需使用普通 HTML 来引用视图的 URL。

# sql - 如何从命令行搜索/替换“二进制”文件

> ID：379831
> 
> 赞同：1
> 
> 时间：2008-12-19T00:52:26.147
> 
> 标签：sql, unix, import

我有一些数据文件要导入到带有一些“唯一”分隔符的数据库中：

字段分隔符 (FS)：SOH（ASCII 字符 1）

记录分隔符（RS）：STX（ASCII 字符 2）+'\n'</p>

我想使用 COPY 命令将文件导入 Postgres，但是虽然我可以指定自定义字段分隔符，但它无法处理记录分隔符。

我也不能只从数据中删除 \002，因为如果其中一个字段（并且有）中有换行符，它会错误地将 COPY 认为它是一条新记录，而实际上它不是.

需要注意的一件重要事情：保留字段中的换行符并不重要，只要将它们转换为空格就可以了。

考虑到这一点，我正在考虑使用“sed”之类的东西将换行符转换为空格，然后将 \002 转换为换行符。但是，由于 sed 是一个基于行的工具，它似乎没有在每行的末尾看到换行符，也无法对它们进行搜索/替换。

是否有任何其他 unix 命令行工具可以完成这项工作？

编辑：我想我真正需要的是一个 unix 实用程序，它可以将文件（执行搜索/替换）处理为“二进制”而不将其拆分为行

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-19T04:04:54.887

根据[Patrick](https://stackoverflow.com/users/7903/patrick-cuff)给出的建议，我已经能够使用 Perl 做到这一点：

猫文件 | perl -pe 's/\002\n/\002\002/g' | perl -pe 's/\n/ /g' | perl -pe 's/\002\002/\n/g'

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-19T01:16:44.600

你可以多次通过文件吗？Pass 1 将所有 \002\n 转换为 \002\002 说。Pass 2 可以将所有的 \n 转换为空格。Pass 3可以将所有\002\002转换为\n。

# javascript - 将依赖项与 jQuery 验证插件一起使用

> ID：379838
> 
> 赞同：7
> 
> 时间：2008-12-19T00:57:46.170
> 
> 标签：javascript, jquery, jquery-validate

我有一个带有一堆默认禁用的文本框的表单，然后通过使用每个旁边的复选框启用。

启用时，这些文本框中的值必须是有效数字，但禁用时，它们不需要值（显然）。我正在使用 jQuery Validation 插件来执行此验证，但它似乎并没有达到我的预期。

`depends`当我单击复选框并禁用文本框时，尽管我已将子句添加到规则中，但我仍然收到无效字段错误（请参阅下面的代码）。奇怪的是，实际发生的是错误消息显示一瞬间然后消失了。

这是复选框和文本框列表的示例：

```
<ul id="ItemList">
<li>
    <label for="OneSelected">One</label><input id="OneSelected" name="OneSelected" type="checkbox" value="true" />
    <input name="OneSelected" type="hidden" value="false" />
    <input disabled="disabled" id="OneValue" name="OneValue" type="text" />
</li>
<li>
    <label for="TwoSelected">Two</label><input id="TwoSelected" name="TwoSelected" type="checkbox" value="true" />
    <input name="TwoSelected" type="hidden" value="false" />
    <input disabled="disabled" id="TwoValue" name="TwoValue" type="text" />
</li>
</ul> 
```

这是我正在使用的 jQuery 代码

```
//Wire up the click event on the checkbox
jQuery('#ItemList :checkbox').click(function(event) {
    var textBox = jQuery(this).siblings(':text');
    textBox.valid();
    if (!jQuery(this).attr("checked")) {
        textBox.attr('disabled', 'disabled');
        textBox.val('');
    } else {
        textBox.removeAttr('disabled');
        textBox[0].focus();
    }
});

//Add the rules to each textbox
jQuery('#ItemList :text').each(function(e) {
    jQuery(this).rules('add', {
        required: {
            depends: function(element) {
                return jQuery(element).siblings(':checkbox').attr('checked');
            }
        },
        number: {
            depends: function(element) {
                return jQuery(element).siblings(':checkbox').attr('checked');
            }
        }
    });
}); 
```

忽略其中的每个隐藏字段，`li`因为我使用的是 asp.net MVC 的`Html.Checkbox`方法。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-19T18:59:31.597

使用“忽略”选项（[http://docs.jquery.com/Plugins/Validation/validate#toptions](http://docs.jquery.com/Plugins/Validation/validate#toptions)）可能是您处理此问题的最简单方法。取决于你在表格上还有什么。例如，如果您有其他控件被禁用，但由于某种原因您仍需要验证，您将不会过滤禁用的项目。但是，如果该路线不起作用，则使用额外的类进行过滤（使用复选框添加和删除）应该可以让您到达您想去的地方，但更容易。

IE

```
 $('form').validate({
            ignore: ":disabled",
            ...
        }); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-26T01:29:04.383

通常在执行此操作时，我会跳过“依赖”并仅使用`required`jQuery Validate 规则并让它根据给定的选择器处理检查，而不是在验证规则和复选框单击处理程序之间拆分逻辑。我使用您的标记整理了一个[快速演示，说明我是如何完成此任务的。](http://www.command-tab.com/demos/checkbox_validate/)

真的，归结为**`required:'#OneSelected:checked'`**. 这使得仅当表达式为真时才需要相关字段。在演示中，如果您立即提交页面，它可以工作，但是当您选中复选框时，表单无法提交，直到选中的字段填充了一些输入。如果您希望整个表单在单击时进行验证，您仍然可以`.valid()`在复选框单击处理程序中进行调用。

（此外，我缩短了您的复选框切换时间，利用 jQuery 的精彩链接功能，尽管您的“缓存”`textBox`同样有效。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-01-31T20:46:05.740

Depends 参数无法正常工作，我想文档已过时。我设法让它像这样工作：

```
required : function(){ return $("#register").hasClass("open")} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-07-14T09:26:44.723

遵循@Collin Allen 的回答：

问题是，如果您在显示错误消息时取消选中复选框，则错误消息不会消失。

我已经通过在禁用该字段时删除错误消息来解决它。

以 Collin 的演示为例，对启用/禁用过程进行以下更改：

```
jQuery('#ItemList :checkbox').click(function()
{
    var jqTxb = $(this).siblings(':text')
    if ($(this).attr('checked'))
    {       
        jqTxb.removeAttr('disabled').focus();
    }
    else
    {
        jqTxb.attr('disabled', 'disabled').val('');
        var obj = getErrorMsgObj(jqTxb, "");
        jqTxb.closest("form").validate().showErrors(obj);
    }
});
function getErrorMsgObj(jqField, msg)
{
    var obj = {};
    var nameOfField = jqField.attr("name");
    obj[nameOfField] = msg;
    return obj;
} 
```

你可以看到我在禁用它时会从字段中删除错误消息

如果你担心`$("form").validate()`，不要！它不会重新验证表单，它只是返回 jQuery 验证的 API 对象。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-16T19:45:22.500

我不知道这是否是您想要的...但不会在选中该框时将 .required 更改为 .wasReq （作为一个占位符，以将其与可能不需要的占位符区分开来）做同样的事情事物？如果未选中，则不需要该字段-您也可以 removeClass(number) 以消除那里的错误。

据我所知，即使某个字段被禁用，应用到它的规则仍然可以应用。或者，你总是可以试试这个......

```
// Removes all values from disabled fields upon submit
$(form).submit(function() {
   $(input[type=text][disabled=disabled]).val();
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-22T02:35:47.933

我没有尝试过验证器插件，但消息显示一瞬间的事实对我来说听起来像是双重绑定，你怎么称呼你的活页夹？如果您在函数中绑定，请在开始之前尝试取消绑定，如下所示：

```
$('#ItemList :checkbox').unbind("click");
...Rest of code here... 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-26T01:16:40.627

禁用/启用后不应该验证字段吗？

```
jQuery('#ItemList :checkbox').click(function(event) {
        var textBox = jQuery(this).siblings(':text');

        if (!jQuery(this).attr("checked")) {
                textBox.attr('disabled', 'disabled');
                textBox.val('');
        } else {
                textBox.removeAttr('disabled');
                textBox[0].focus();
        }
        textBox.valid();    
}); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-04-11T05:25:29.133

我有同样的问题。

我通过让单选按钮更改事件处理程序在整个表单上调用 valid() 解决了这个问题。

工作完美。上面的其他解决方案对我不起作用。

# visual-studio-2010 - Visual Studio 2010 会是什么样子？

> ID：379841
> 
> 赞同：0
> 
> 时间：2008-12-19T00:59:37.443
> 
> 标签：visual-studio-2010

我听过几个播客（最近是[DotNetRocks](http://www.dotnetrocks.com/)上的人）说 Visual Studio 2010 的外观已经完全重新设计，并且 Visual Studio 用 WPF 重写。

我一直[在 Visual Studio 2010 CTP 的 channel9 上](http://channel9.msdn.com/posts/VisualStudio/Visual-Studio-2010-and-the-NET-Framework-40-Week/)观看一些演示，唯一对我来说看起来不同的是打开屏幕。

我阅读了[MSDN 上的通知](http://www.microsoft.com/presspass/press/2008/sep08/09-29VS10PR.mspx)，但它没有说明 Visual Studio 的外观/设计。

微软是否在这方面改变了方向，或者最终产品的 UI 是否会发生重大变化？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-19T01:10:37.517

我猜是带有空间主题的 3D。您将能够“飞过”您的代码、“环绕”类、“击落”错误并“启动”您的代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-19T01:16:09.017

现在猜测它会是什么样子还为时过早：我什至认为他们不知道它会是什么样子。

但是，据我所知，他们实际上是在将部分重写为 WPF/C#，但他们并没有抛弃所有内容并从头开始。相反，他们将在有意义的情况下重写部分内容。例如，我看到他们有一些新的 UML 工具，这些工具肯定可以在 WPF 中完成。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-19T01:36:22.613

呃，测试版已经发布了一个多月了。我一直在打开和关闭 Visual Studio 2010。它在整体设计上与 2008 年非常相似。

您可以在此处下载并亲自查看他们将产品带到哪里：

**[Microsoft.com 上的下载页面](http://www.microsoft.com/downloads/details.aspx?familyid=922b4655-93d0-4476-bda4-94cf5f8d4814&displaylang=en)**

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-19T01:47:50.903

Channel9 上有大量关于[VS2010](http://channel9.msdn.com/tags/Visual+Studio+2010/)、[TFS 2010](http://channel9.msdn.com/tags/Visual+Studio+Team+System+2010/)以及[PDC 2008](https://sessions.microsoftpdc.com/)在线会议的视频。他们还开始了一个名为[10-4](http://channel9.msdn.com/shows/10-4/)的新系列，专门用于 VS2010 - 各种演练。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-19T01:12:33.253

我听说它会有一个[历史调试器](http://channel9.msdn.com/posts/VisualStudio/Historical-Debugger-and-Test-Impact-Analysis-in-Visual-Studio-Team-System-2010/)。

另外-这应该是一个维基

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-19T01:13:46.340

让我们祈祷他们不要在视觉上与任何东西一起喝酒。我的第一个猜测是，他们会尝试将新的办公室丝带条缠绕在我们的脖子上。;|

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-25T13:16:01.833

来自[WPF 仙境](http://wpfwonderland.wordpress.com/)：

[Visual Studio 2010 获得 WPF 整容](http://wpfwonderland.wordpress.com/2009/02/24/visual-studio-2010-gets-wpf-facelift/)

WPF 已经出现了几年。这已经足够长，微软产品的新版本正在萌芽 WPF 接口。

去年在 PDC 上，微软宣布 Visual Studio 中的代码编辑器将用 WPF 重写。不过，微软并没有止步于代码编辑器。今天，Visual Studio 的总经理 Jason Zander[展示了新的基于 WPF 的 IDE](http://blogs.msdn.com/jasonz/archive/2009/02/20/a-new-look-for-visual-studio-2010.aspx)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-14T16:10:28.393

第 2 天 PDC Keynote #1 的亮点（参见：[PDC 网站](http://www.microsoftpdc.com)）

*   通过 WPF 对 IDE 的多显示器支持。
*   从测试类构建类。
*   在调试模式下切换代码段上的 TFS 错误。
*   用于调试、发布的部分配置文件。
*   所见即所得的 Silverlight 设计师。

# sql - 如何删除仅通过 ID 不同的两行

> ID：379854
> 
> 赞同：3
> 
> 时间：2008-12-19T01:13:51.830
> 
> 标签：sql, mysql

我有一个脚本，它使用相同的数据双重插入到数据库中。有没有一种好方法可以做到这一点（无需扫描，将每条记录插入数组，然后删除重复的数组条目）？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-19T01:16:49.530

```
DELETE
FROM t
WHERE ID IN (
    SELECT MAX(ID)
    FROM t
    GROUP BY {Your Group Criteria Here}
    HAVING COUNT(*) > 1
) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-19T01:33:09.030

MySQL 支持多表删除，这真的很酷，可以在这里提供帮助。您可以对除 之外的所有列的相等性进行自连接`id`，然后删除具有更大的匹配行`id`。

```
DELETE t2
 FROM mytable t1 JOIN mytable t2
  USING (column1, column2, column3) -- this is an equi-join
WHERE t1.id < t2.id; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-19T01:38:24.870

或者旧的简单方法，如果它不是最快的，我会感到惊讶。比匹配 GROUP BY 聚合函数特别快。

从 mytable m1
WHERE EXISTS中删除
（从 mytable
WHERE fields = m1.fields
AND id < m1.id 选择 1）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-19T04:56:28.107

如果您现在没有任何内容通过键引用到表中，我会 mysqldump --complete-insert 它，剥离主键，更改表定义以强制执行一些唯一键或其他可以捕获重复项的键，更改将插入替换为替换，然后重新加载数据。为您提供一个干净的表，在 PK 序列中没有漏洞或删除的行。

# asp-classic - 经典 ASP 中的线程休眠？

> ID：379856
> 
> 赞同：11
> 
> 时间：2008-12-19T01:13:57.493
> 
> 标签：asp-classic, vbscript

我正在对一个用经典 ASP/VbScript 编写的旧应用程序进行一些修改。

它具有向应用程序成员发送电子邮件的功能，但由于成员列表很大，服务器在发送前一百个左右后拒绝新电子邮件。

我已经编写了一些代码让它以 20 次突发发送电子邮件，但这仍然不起作用。我认为也许让它在突发之间休眠一秒钟可能会正常工作。

但是，我似乎在 VbScript 中找不到 Thread.Sleep 类型的方法。

有吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2011-06-23T17:24:07.410

此例程等待任意时间，并且不使用 CPU：

```
函数 asp_Wait(nMilliseconds)
  暗淡的外壳
  '' VBS: 设置 oShell=Wscript.CreateObject("WScript.Shell")
  '' ASP：
  设置 oShell=Server.CreateObject("WScript.Shell")
  调用 oShell.run("ping 1.1.1.1 -n 1 -w " & nMilliseconds,1,TRUE)
  '' 选项 TRUE：等到 ping 完成
  '' 1000 毫秒等待是 1 秒
结束功能

```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-19T01:56:00.560

还有一个很好的hta hack应该可以工作。在此处查找 A 合成睡眠功能： [http ://www.mvps.org/scripting/rube/index.htm](http://www.mvps.org/scripting/rube/index.htm)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-27T08:12:06.097

您可以使用 ：

```
<html>
<head>
    <title>Sleep</title>
</head>
<body>
    <% 

        function Sleep(seconds)
            set oShell = CreateObject("Wscript.Shell")
            cmd = "%COMSPEC% /c timeout " & seconds & " /nobreak"
            oShell.Run cmd,0,1
        End function

        Sleep(5)

        response.write("End") 
    %>
</body>
</html> 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-04-13T15:56:23.533

你在使用 CDO 吗？由于这被标记为经典 ASP，我猜是这样。

如果是这样，如果你可以使用

myMail.Configuration.Fields.Item("http://schemas.microsoft.com/cdo/configuration/sendusing")=1 '（使用取件发送）

代替

myMail.Configuration.Fields.Item("http://schemas.microsoft.com/cdo/configuration/sendusing")=2 '（使用端口发送）

它更可靠，因为它将电子邮件写入文件（通常是 C:\inetpub\mailroot\pickup），并且 IIS 的 SMTP 服务器会检查文件夹中是否有新邮件，如果第一次失败会重试。问题是您必须在 IIS 管理单元中设置 SMTP。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-22T21:17:02.333

抱歉，这个答案与问题并不严格相关，但在试图回答一个问题时，它只是得到了很大的评论。

@shahka，不同之处在于，当您尝试连接到数据库时，代码进入“等待状态”（如回调），因此不使用 CPU 时间。与 SESSION 或 THREAD 在做什么无关，与 CPU/核心在做什么 ELSE 无关。

例如，查找较旧的非多核 CPU。将您的样本设置为休眠 10 秒，然后运行 ​​2-5 秒左右，然后再次休眠 10 秒。这样做大约 20,000 次。在它运行时，尝试使用 box，看看它的响应速度如何。移动窗口，查看 CPU 使用率等。

这为您提供了这个人的 Web 服务器正在发生的事情的示例。它变得无响应，因为线程调度程序将倾向于“偏爱”未“旋转”的 CPU/核心（我们称之为）。因此，所有 Web 请求、操作系统操作等都将发生在 OTHER 核心上，从而使其超载，给人一种“旋转”的感觉。

现在，您有时可以紧密循环 CPU，这并不重要。但是，在我多年的编程生涯中，我从未发现有必要（故意）编写这样的紧密循环。其中一些又回到以正确的方式和错误的方式做事。以错误的方式做事通常会起作用，但这并不意味着它会正确地起作用。

如果你想要一个很好的例子，那就去挑选地球上几乎所有的病毒，然后分析它。你会发现它为了造成破坏，他们（病毒作者）经常不得不以“错误”的方式做事。当然，它完成了工作，但它也破坏了病毒，比如说，不同语言版本的 Windows，或者它使整个机器崩溃，否定了它的目的，等等。

[Greg Hewgill](https://stackoverflow.com/users/893/greg-hewgill "格雷格·休吉尔")是我早期教授这类东西的老师之一，自从我和他一起工作了很多年，支持他的软件，后来又对他的软件进行了质量检查，我从他那里学到了很多东西，就像我一样试图告诉你为什么你的代码示例不好。严格来说，代码没问题。有用。它写得很好。但是，它的功能不正确，并且具有其他可能正在阅读本文以寻找知识的成熟程序员不完全理解的不良副作用。这就是为什么我不推荐你的样品。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-19T01:17:34.333

据我所知不是。您必须使用一些用 VB 类编写的外部代码或任何其他代码来完成。

或忙等待（gak）。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-19T01:41:22.057

你知道，这是我认为设置私有 MSMQ 队列可能是一件好事的时期之一。将您要发送的电子邮件放入队列中，并让新开发的 .NET 服务进行发送。这将释放您的 ASP.NET 应用程序，并允许您集中管理您的发送！

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-19T01:45:27.447

这看起来像一个很好的黑客：

[http://www.ehow.com/how_2001270_sleep-asp-using-ado.html](http://www.ehow.com/how_2001270_sleep-asp-using-ado.html)

诀窍是创建一个 ADO 连接对象，然后尝试连接到不存在的服务器。这将在连接对象的超时设置期间阻塞。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-12-19T01:59:36.247

请注意，IIS 的默认[ASP 脚本执行超时](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/2275a2ba-5b12-4e18-8266-8a3b0678e419.mspx?mfr=true)默认值为 90 秒，因此运行以这种方式发送大量电子邮件的大型脚本将超时，除非您更改 asp 超时。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2011-10-10T10:20:37.893

```
var shell = Server.CreateObject("WScript.Shell");
shell.run("CHOICE /C:AB /D:A /T:1 > NUL", 1, true); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-11-05T20:44:29.487

答案是不要使用服务器等待，使用客户端。[您可以编写一个 javascript，使用setInterval](http://www.w3schools.com/jsref/met_win_setinterval.asp)每秒保持调用 Send()直到队列为空。使用[Ajax](http://api.jquery.com/jquery.ajax/)调用使用服务器端脚本发送一封电子邮件。然后在 ajax 调用返回时，您还可以在 html 页面中指示已发送电子邮件。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-09-17T14:03:35.007

如果您使用带有 ASP 经典的 SQL Server，您可以使用[`WAITFOR`](https://docs.microsoft.com/en-us/sql/t-sql/language-elements/waitfor-transact-sql)“查询”将脚本暂停几秒钟甚至几毫秒：

```
WAITFOR DELAY '00:00:01.234' -- 1,234 ms 
```

# css - CSS Ride SideBar 需要保持在顶部

> ID：379865
> 
> 赞同：1
> 
> 时间：2008-12-19T01:18:58.373
> 
> 标签：css, sidebar

我的右侧栏不在顶部。

例如，这两个页面。www.cafecartel.com

和 www.cafecartel.com.index2.php

目前网站的写法，右边栏必须这样放置：

body id="支持" div id="container1" div id="container2"

```
div id="header"
 ?php include("inc/header.inc"); ?
  h1 Point of Sale for Restaurants, POS Retail and Inventory by Cafe Cartel/h1
/div 
```

div id="包装器" div id="内容"

```
div id="sidebar"
 ?php include("inc/sidebar_justafew.inc"); ?
 ?php include("inc/sidebar_whouses.inc"); ?
/div 
```

div id="maincontent"

* * *

我想要的是能够将侧边栏放在主要内容**下方。**对于搜索引擎优化。

这是侧栏的 CSS：

# 侧边栏 {

```
float: right;
    position: relative;
    left: 178px;
    width: 166px;
    padding-top: 5px;
margin-left: -165px;
margin-bottom: 50px;
    line-height: 1.4em;
    voice-family: "\"}\"";
    voice-family: inherit;
    width: 165px;
    } 
```

感谢所有帮助。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-19T03:02:58.537

我无法完全理解这个问题，所以如果我误解了，我提前道歉，但是要让侧边栏出现在内容旁边并让内容出现在 HTML 中的侧边栏上方，您可以将 #maincontent div 向左浮动，然后#sidebar div 正确。

`#content { clear: both; }`

`#maincontent { float: left; }`

`#sidebar { float: right; }`

之后你还需要清除浮动，所以我在内容 div 上添加了 clear: both。

希望有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-21T23:04:39.450

cc_layout.css line: 63

```
#maincontent {
    margin:0;
    padding:0;
    position:relative;
    width:97%;
    float: left;
} 
```

@Carl, the difference between the two pages (old and new) is that he has placed the sidebar HTML below the maincontent (new) compared to above (old).

# asp.net-mvc - AjaxHelper 不工作

> ID：379866
> 
> 赞同：2
> 
> 时间：2008-12-19T01:19:57.233
> 
> 标签：asp.net-mvc, ajaxhelper

我正在研究 ASP.NET MVC。

为了使用 AjaxHelper，我在 site.master 中插入了两个 javascript 文件，如下所示。

```
<script src="../../Scripts/MicrosoftMvcAjax.debug.js" type="text/javascript"></script>
<script src="../../Scripts/MicrosoftAjax.debug.js" type="text/javascript"></script> 
```

然后我在视图页面中使用了 AjaxHelper，但它不起作用。

所以，我改变了javascript文件的顺序如下。

```
<script src="../../Scripts/MicrosoftAjax.debug.js" type="text/javascript"></script>
<script src="../../Scripts/MicrosoftMvcAjax.debug.js" type="text/javascript"></script> 
```

然后它起作用了:(

那么，我的问题是，JavaScript 文件效果的顺序要使用 AjaxHelper 类吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-20T13:25:01.070

绝对地。MVCAjax 类将需要引用更通用的 Ajax 类。因此，首先引用通用的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-31T23:49:14.687

MicrosoftMvcAjax.debug.jss 文件中的代码引用了 MicrosoftAjax.debug.js 中的代码。因此，它们被宣布的顺序很重要。

# linux - bash 脚本显示基于“Windows-speak”的兼容命令

> ID：379867
> 
> 赞同：5
> 
> 时间：2008-12-19T01:25:40.077
> 
> 标签：linux, bash, search, intellisense, usability

**问题：**客户 X 是一位 Windows 用户，当她通过 shell 登录到她的 RedHat 盒子时，她希望能够通过使用助记关键字或“标签提示”来触发预打包的 bash 命令。

**示例：**客户 X 使用 ssh 登录主机并想要执行一些常规文件操作。她希望能够打字

```
copy file 
```

并取回可供选择的预制填充空白 bash 命令列表

```
cp <@source@> <@dest@>               ### simple copy
cp -R <@startdir@>  <@destdir@>      ### recursive copy 
```

然后，她希望能够选择其中一项，填写空白，然后按 Enter 键运行命令。

客户 X 愿意提前指定她可能想要使用的命令（在 windows-speak 中），然后聘请开发人员将这些命令翻译成 bash 命令，然后将它们放在一个允许她与 windows 对话的脚本中- 与 bash 对话并取回命令列表。

注意：客户 X 不喜欢 apropos，因为它假定熟悉 bash 中使用的术语，而不是 windows-speak。例如：

```
 apropos shortcut 
```

没有给她任何关于创建符号链接的信息（尽管这正是她想要的），因为她不知道在 linux 中调用了哪些 windows 快捷方式。显然，windows 概念并没有超过 100%，所以她最终必须学习，但她是一个忙碌的人，并要求这样做是为了“缓解”她对 linux 的理解。

**问题：**开始这样的事情的最佳方式是什么？是否已经有一个 perl、python、ruby 脚本可以做这样的事情？bash 中有什么东西可以模拟这种功能请求吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-19T01:51:40.677

您可能想要的是覆盖 bash 的`command-not-found`处理程序。这是安装处理程序的标准 Ubuntu 安装中 /etc/bash.bashrc 中的部分：

```
...
# if the command-not-found package is installed, use it
if [ -x /usr/lib/command-not-found ]; then
        function command_not_found_handle {
                # check because c-n-f could've been removed in the meantime
                if [ -x /usr/lib/command-not-found ]; then
                   /usr/bin/python /usr/lib/command-not-found -- $1
                   return $?
                else
                   return 127
                fi
        }
fi
... 
```

实际上，如果找不到命令，则以该命令作为参数执行用户指定的程序。对于 Ubuntu，它是一个 Python 程序，用于检查用户键入的命令是否是可以安装的有效应用程序，如果是，则通知用户他/她可以安装它。

您可能想要做的是将它与命令和使用字符串的 hashref 进行比较，如果匹配，则显示适当的。

# asp.net - 诊断“% Time in Garbage Collection”问题

> ID：379871
> 
> 赞同：2
> 
> 时间：2008-12-19T01:28:54.797
> 
> 标签：asp.net, debugging, garbage-collection

我有一个 ASP.NET 2.0 应用程序，在生产级服务器（双四核，4g）上进行负载测试时，它在垃圾收集上花费了超过 40% 的时间。我一直试图找出问题所在，但它是一个庞大而复杂的代码库，导致进展缓慢。没有 GC.Collect() 调用。在尝试隔离此类问题时，哪些工具、技术等很有帮助？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-19T03:02:34.810

在查看此类问题时，我发现[Tess Ferrandez 博客上的调试实验室非常有帮助。](http://blogs.msdn.com/tess/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-19T02:14:39.103

首先使用[.Net CLR Profiler](http://www.microsoft.com/downloads/details.aspx?FamilyId=A362781C-3870-43BE-8926-862B40AA0CD0&displaylang=en)分析您的应用程序（它有一个漂亮的 GUI 用于显示收集的数据，而且它是免费的！）。可以在[此处](http://msdn.microsoft.com/en-us/library/ms979205.aspx#scalenethowto13_topic5)找到有关如何分析 ASP.Net 应用程序的具体说明，[本文](http://www.programmersheaven.com/2/CLR-Profiler)是关于内存/性能问题、分析和 .Net CLR Profiler 的 GC 的一个很好的概述。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-19T02:55:41.627

尝试查看您的团队中是否有人实际上已经覆盖`Dispose()`了经常调用的方法`GC.Collect()`。这发生在我的团队中，结果非常糟糕，其中一种`Dispose()`方法需要 1 秒才能执行。

这是我可以想象您的服务器将 40% 的时间用于垃圾收集的唯一方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-19T01:50:15.690

好吧，首先，我的特技膝盖正在起作用，当它发生这种情况时，它要么意味着它即将下雪，要么有人一直在使用大量“+”运算符进行字符串连接，而不是像上帝那样使用 StringBuilder .

[蚂蚁探查器](http://www.red-gate.com/Products/ants_profiler/index.htm)呢？我曾经使用过一段时间并且喜欢它。还有一个[Profiling API](http://msdn.microsoft.com/en-us/magazine/cc300553.aspx)，您可以使用它来捕获您自己的数据。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-28T21:41:23.590

在整个应用程序崩溃前不久，我发现 GC 耗尽了 100% 的 CPU 时间。问题是“对象泄漏”，我们一次泄漏 20mb。最终 GC 放弃尝试，内存耗尽。

您可以使用 perfmon 看到它执行此操作的时间，有一个 GC 对象有很多计数器。

# javascript - Google 小工具唯一 ID

> ID：379874
> 
> 赞同：3
> 
> 时间：2008-12-19T01:29:40.427
> 
> 标签：javascript, google-gadget

如何使用 Javascript 从添加到 iGoogle 网站的小工具中获取唯一的 Google 小工具 ID？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-17T21:05:02.723

如果您尝试从小工具本身的 JavaScript 访问小工具的 ID，您可以使用`__MODULE_ID__`. 这会被 iGoogle 服务器自动替换为实际的模块 ID，并在许多标准库中用作公共构造函数参数（请参阅[小工具 API 参考](http://code.google.com/apis/gadgets/docs/legacy/reference.html)）。

如果您正在使用[新的小工具 API](http://code.google.com/apis/gadgets/docs/reference/)（OpenSocial 规范的一部分，目前仅在 iGoogle 沙盒中的 iGoogle 上可用），那么您还有另一种选择：[`gadgets.Prefs.getModuleId()`](http://code.google.com/apis/gadgets/docs/reference/#gadgets.Prefs.getModuleId)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-23T13:45:13.257

我不是 100% 确定您的意思，但 Google 小工具的 URL 似乎是这样的： http: [//hosting.gmodules.com/ig/gadgets/file/unique_id/name.xml](http://hosting.gmodules.com/ig/gadgets/file/unique_id/name.xml) ...，在 Google 处理完他们的 JavaScript 之后，他们将添加一个带有 onclick 属性的 <a>-tag，其中包含这个 URL。因此，也许您可​​以尝试从页面中获取所有 <a>-tags（使用 delbox 类），并在 onclick 属性上使用正则表达式来获取唯一 ID。您只需要确保您的代码在 Google 之后执行。

像这样的东西可以工作（未经测试）：

```
/**
 * Grabs the id of a Google Gadget from an iGoogle page.
 *
 * @param name the name of the targeted Google Gadget. If omitted the first
 *             Gadget is used
 * @return the id of the targeted Google Gadget or null if it could not be found
 */
function grab_id (name) {
    var links = document.getElementsByClass("delbox");
    var url = "http://hosting.gmodules.com/ig/gadgets/file/";
    var id_length = 21;
    var regex = url + "[\d]{" id_length} + "}/" + name;
    for (var i = 0; i < links.length; i++) {
        var match = links[i].getAttribute("onclick").match(regex);
        if (match) {
            return match.substring(url.length+1, url.length+1+id_length);
        }

    }
    return null;
} 
```

# grails - 如何处理两个 Grails 应用程序之间的安全性？

> ID：379880
> 
> 赞同：2
> 
> 时间：2008-12-19T01:35:10.010
> 
> 标签：grails

如果我在同一个应用服务器（Tomcat/Glassfish）上运行两个单独的 Grails 应用，我如何允许用户登录第一个应用，然后让他对第二个应用进行身份验证，这样他在访问该应用时就不会收到提示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-19T10:29:58.930

IMO 最好的方法是实现联合登录服务器。例如[CAS](http://www.ja-sig.org/products/cas/)（中央身份验证服务），它是一种 Web 单点登录解决方案。这也将允许集成在不同应用服务器/机器上运行的应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-20T12:17:14.047

有一个用于 grails 的人群插件，可以实现人群集成 - 有关详细信息，请参阅[http://www.atlassian.com/software/crowd/](http://www.atlassian.com/software/crowd/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-24T17:25:27.947

我还建议走CAS路线。最新的 acegi 插件有 CAS 支持，这应该很容易。但是对于 CAS，您仍然需要授权（用户可以做什么），因为它的目的是身份验证（用户是谁）。

# drawing - 让我们画一只蜘蛛

> ID：379893
> 
> 赞同：2
> 
> 时间：2008-12-19T01:42:42.740
> 
> 标签：drawing

我是 c# 和 VS 的新手，但我明白了。该应用程序是这样的：一个程序，其中最终结果将从用户定义的选项中绘制蜘蛛。假设有 100 个选项：身体部位的大小和数量、颜色、与身体的连接点等。

第一个问题：我应该尝试使用 VS 2005 附带的库吗？或者，是否有另一种环境可以让我“利用”以获得良好的结果（flash、java 等）？

第二个问题：你能告诉我与你第一个问题的答案相对应的信息吗？

非常感谢，我教的孩子会喜欢的！

珍妮弗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-19T01:59:26.123

唔。

这确实是一个粗略的问题，不是因为我不知道该怎么做，而是因为对于初学者来说，这常常令人生畏。如果您使用“标准”Windows 窗体 C# 方法来执行此操作，您最终会问自己，“#*(&! 是 WM_PAINT 是什么？”或“为什么我的程序在我移动窗口时完全搞砸了在我的照片上？！”

基本上有两种主要技术可用于在 .NET 中进行绘图：Windows Forms（MusiGenesis 建议的）和[WPF](http://www.codeproject.com/KB/WPF/BeginWPF1.aspx)，或 Windows Presentation Foundation，它随 Visual Studio 3.0 版本一起提供。这意味着，如果您下载 .NET 3.5 SDK 或使用 Visual Studio 2008，WPF 会附带它。

如果您刚刚开始，我建议您使用 WPF 而不是 Windows 窗体，因为绘图和重绘的肮脏细节在很大程度上是抽象的。您还可以将很多图片定义为标记，就像网页一样，然后在代码中对其进行操作。祝好运并玩得开心点！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-19T01:50:33.363

以下是一些如何使用 C# 绘制事物的示例的链接：

[http://www.geekpedia.com/tutorial50_Drawing-with-Csharp.html](http://www.geekpedia.com/tutorial50_Drawing-with-Csharp.html)

此示例仅使用 .NET 的内置图形方法，因此您不需要任何其他库。

# wcf - 从 n 层客户端遍历对象图

> ID：379897
> 
> 赞同：3
> 
> 时间：2008-12-19T01:46:30.080
> 
> 标签：wcf, nhibernate, serialization, n-tier-architecture

我是一名学生，目前正在涉足使用 Nhibernate+WCF+WPF 的 .Net n-tier 应用程序。

其中一件非常糟糕的事情是对象图序列化，事实上它根本没有完成，目前关联被忽略了，我们到处都在使用 DTO。

据我所知，一种方法是预定义应该加载和序列化哪些对象和集合以通过网络，从而能够向客户端呈现一些关联，但这似乎是有限的、不灵活的和不一致的（你能告诉我不喜欢这个主意）。

我想到的一个选择是简单地将客户端层上延迟加载收集的 NHProxies 替换为“disconnectedProxy”，该代理将通过网络检索相关联的内容。这意味着我们必须稍微扩展我们的 Web 服务签名并对我们生成的代理做一些黑客攻击，但这似乎是一个很好的 T4/其他代码生成实验。

据我所知，这似乎是一个常见的绊脚石，但经过大量阅读后，我无法找出任何好的/普遍接受的解决方案。我正在寻找与任何特定解决方案一样多的方向，但如果有一种简单的方法可以让客户“感觉”连接，请告诉我。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-19T06:23:17.650

你问了一个非常好的问题，不幸的是没有一个非常干净的答案。即使您能够通过 WCF 进行延迟加载（我们能够做到），您仍然会在使用代理拦截器时遇到问题。相信我，您需要客户端层上的 POCO 对象！

您真正需要考虑的...从我所看到的研究中，被认为是解决此问题的行业标准方法称为*持久性与使用*或*持久性无知*。换句话说，您的对象模型和映射代表您的持久性域，但它与您理想的使用场景不匹配。您不想将整个数据库带到客户端只是为了显示几个属性，对吗？

这似乎是一个简单的问题，但解决方案要么非常简单，要么非常复杂。一方面，您可以围绕使用场景设计实体，但最终会导致对象域的扩散，从而使其难以维护。另一方面，您仍然需要丰富的对象模型关系来编写细粒度的业务逻辑。

为了简化这个问题，让我们检查一下我们需要填补的两个主要空白……数据库和数据库/服务层之间以及服务到客户端之间的空白。NHibernate 通过提供一个 ORM 来将数据加载到您的对象中，很好地填充了第一个。它做得不错，但为了获得出色的性能，需要使用自定义加载策略进行调整。我跑题了……</p>

服务器和客户端之间的第二个差距是事情变得危险的地方。为简化起见，想象一下，如果您没有通过网络向客户端发送任何映射实体？尝试创建一种机制，将业务实体交换为 DTO 对象，同样将 DTO 对象交换为业务实体。这样，您的客户只处理 DTO（当然是 POCO），您的业务逻辑可以保持其丰富的结构。这使您不仅可以利用 NHibernate 的延迟加载机制，还可以利用会话带来的其他好处，例如 L1 缓存。

出于简洁和知识产权的原因，我不会进入所述机制的设计，但希望这些信息足以为您指明正确的方向。如果您根本不关心性能或延迟……只需将延迟加载全部关闭并解决序列化问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-19T04:21:19.847

对我来说已经有一段时间了，但注入/断开的代理可能没有听起来那么糟糕。由于您是学生，我假设您有一些时间并想闲逛一下。

如果你想注入你自己的自定义序列化/反序列化逻辑，你可以使用[IDataContractSurrogate](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.idatacontractsurrogate.aspx)，它可以使用[DataContractSerializerOperationBehavior](http://msdn.microsoft.com/en-us/library/system.servicemodel.description.datacontractserializeroperationbehavior.aspx)应用。我只做了一些基本的事情，但它可能值得研究。通过在这一层添加一些有趣的逻辑（阅读：可能是骇人听闻的），您也许可以使其更加连接。

[这](http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/20e5c74c-b8ee-4cc9-9c36-63210b121dd5/)是一篇关于某人的 MSDN 帖子，他也有同样的认识，NHibernate 使用的 DynamicProxy 使得无法直接序列化 NHibernate 对象进行延迟加载。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T21:56:35.857

如果您真的决定通过网络传输对象图并保留延迟加载功能。看看我在这里生成的一些代码[http://slagd.com/?page_id=6](http://slagd.com/?page_id=6)。基本上，它会在网络的另一端创建一个假会话，并允许休眠代理保留其功能。并不是说这是做事的正确方式，但它可能会给你一些想法。

# jquery - 淡入每个元素 - 一个接一个

> ID：379900
> 
> 赞同：51
> 
> 时间：2008-12-19T01:49:58.387
> 
> 标签：jquery, ajax, load

我正在尝试找到一种方法来加载 JSON 页面以显示我目前拥有的内容。但我试图一个接一个地淡入每个元素？有没有人熟悉这样做的方法？

稍微延迟淡入每个元素？

这是我的代码示例，我使用的是 jquery 框架。

代码： http: [//pastie.org/343896](http://pastie.org/343896)

* * *

## 回答 #1

> 赞同：270
> 
> 时间：2011-01-11T19:43:25.427

假设您有一个跨度元素数组：

```
$("span").each(function(index) {
    $(this).delay(400*index).fadeIn(300);
}); 
```

*（快速说明：我认为您需要 jQuery 1.4 或更高版本才能使用 .delay 方法）*

这基本上会等待一段时间并淡入每个元素。这是因为您将等待时间乘以元素的索引。遍历数组时，延迟看起来像这样：

*   延迟 400 * 0（没有延迟，只是淡入，这是我们想要的第一个元素）
*   延迟 400 * 1
*   延迟 400 * 2
*   延迟 400 * 3

这会产生一个很好的“一个接一个”的淡入淡出效果。它也可以与 slideDown 一起使用。希望这可以帮助！

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-12-19T01:55:16.363

好吧，你可以设置你的淡入淡出功能来触发“下一个”。

```
 $("div#foo").fadeIn("fast",function(){
      $("div#bar").fadeIn("fast", function(){
           // etc.
      });
   }); 
```

但是计时器可能是一个更好的系统，或者是一个将它们全部获取的函数，将它们放入一个数组中，然后一次弹出一个，中间有延迟，一次淡入一个。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2011-02-15T11:57:59.033

这个怎么样？

```
jQuery.fn.fadeDelay = function() {
 delay = 0;
 return this.each(function() {
  $(this).delay(delay).fadeIn(350);
  delay += 50;
 });
}; 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-19T02:05:35.703

我认为您将需要这样的东西：

```
var elementArray = yourAjaxRequestReturningSomethingEdibleByJQuery();
fadeInNextElement(elementArray);

function fadeInNextElement(elementArray)
{
    if (elementArray.length > 0)
    {
        var element = elementArray.pop();
        $(element).fadeIn('normal', function()
        {
             fadeInNextElement(elementArray);
        }
    }
} 
```

注意：我还没有测试过，但即使它不起作用，你也应该得到这个想法并轻松修复它。

顺便说一句，我不同意使用计时器。使用计时器，无法保证元素一个接一个地淡入，并且只有在前一个元素结束时才会开始淡入一个元素。

从理论上讲，它应该可以工作，但是在某些情况下，您的“链”可能由于某种原因需要停止，或者褪色动画无法按时完成等。只需使用适当的链接即可。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-19T01:53:00.753

使用 setTimeout()（标准 JS 函数）查看 jQuery [fadeIn( )。](http://docs.jquery.com/Effects/fadeIn#speedcallback)您可以查看我在此站点[http://www.realstorage.ca/](http://www.realstorage.ca/)上所做的一些事情。我基本上隐藏并显示它们，以便它可以循环播放。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-09-01T01:02:27.063

从上面的答案中，我想出了这样的东西，对我来说效果很好。

**HTML**

```
<div id="errorMessage" class="d-none" ></div> 
```

**Javascript**

```
var vehicle = {

error: (error, message) => {
    if(error){
        vehicle.popUp(message, 'bg-danger');
    }else{
        vehicle.popUp(message, 'bg-success');
    }
},
popUp: (array, bgColor) => {

    var errorBox = $('#errorMessage');

    errorBox.removeClass('d-none');
    $.each(array, function(i,e){
        i=i+1;
        var messageBox = '<div id="'+i+'" class="'+bgColor+' text-white">'+e+'</div>';
        $(messageBox).appendTo(errorBox).delay(100*i+0).slideDown(100*i+0,function(){
            $('#'+i).delay(1000*i+0).slideUp(400*i+0, function(){
                $('#'+i).remove();    
            });
        });
    });               
},

} 
```

# python - 如何将字符串解析为浮点数或整数？

> ID：379906
> 
> 赞同：2583
> 
> 时间：2008-12-19T01:52:26.213
> 
> 标签：python, parsing, floating-point, type-conversion, integer

在 Python 中，如何解析数字字符串，例如

```
"545.2222" 
```

到其对应的浮点值，

```
545.2222 
```

? 或者将字符串解析为`"31"`整数，`31`？

我只想知道如何将*float* `str`解析为 a `float`，以及（单独）将*int* `str`解析为 an `int`。

* * *

## 回答 #1

> 赞同：2966
> 
> 时间：2008-12-19T01:54:51.420

```
>>> a = "545.2222"
>>> float(a)
545.22220000000004
>>> int(float(a))
545 
```

* * *

## 回答 #2

> 赞同：575
> 
> 时间：2014-01-05T04:15:39.507

## 检查字符串是否为浮点数的 Python 方法：

```
def is_float(value):
  try:
    float(value)
    return True
  except:
    return False 
```

此函数的更长更准确的名称可能是：`is_convertible_to_float(value)`

## [Python](http://en.wikipedia.org/wiki/Python_%28programming_language%29)中什么是浮点数，什么不是浮点数可能会让你感到惊讶：

```
val                   is_float(val) Note
--------------------  ----------   --------------------------------
""                    False        Blank string
"127"                 True         Passed string
True                  True         Pure sweet Truth
"True"                False        Vile contemptible lie
False                 True         So false it becomes true
"123.456"             True         Decimal
"      -127    "      True         Spaces trimmed
"\t\n12\r\n"          True         whitespace ignored
"NaN"                 True         Not a number
"NaNanananaBATMAN"    False        I am Batman
"-iNF"                True         Negative infinity
"123.E4"              True         Exponential notation
".1"                  True         mantissa only
"1,234"               False        Commas gtfo
u'\x30'               True         Unicode is fine.
"NULL"                False        Null is not special
0x3fade               True         Hexadecimal
"6e7777777777777"     True         Shrunk to infinity
"1.797693e+308"       True         This is max value
"infinity"            True         Same as inf
"infinityandBEYOND"   False        Extra characters wreck it
"12.34.56"            False        Only one dot allowed
u'四'                 False        Japanese '4' is not a float.
"#56"                 False        Pound sign
"56%"                 False        Percent of what?
"0E0"                 True         Exponential, move dot 0 places
0**0                  True         0___0  Exponentiation
"-5e-5"               True         Raise to a negative number
"+1e1"                True         Plus is OK with exponent
"+1e1^5"              False        Fancy exponent not interpreted
"+1e1.3"              False        No decimals in exponent
"-+1"                 False        Make up your mind
"(1)"                 False        Parenthesis is bad 
```

你以为你知道数字是什么？你没有你想的那么好！没有什么大惊喜。

## 不要在生命攸关的软件上使用此代码！

以这种方式捕获广泛的异常，杀死金丝雀并吞噬异常会产生一个很小的机会，即作为字符串的有效浮点数将返回 false。`float(...)`代码行可能由于与字符串内容无关的一千个原因中的任何一个而失败。但是，如果您正在使用 Python 之类的鸭式原型语言编写对生命至关重要的软件，那么您将遇到更大的问题。

* * *

## 回答 #3

> 赞同：563
> 
> 时间：2008-12-19T02:31:23.297

```
def num(s):
    try:
        return int(s)
    except ValueError:
        return float(s) 
```

* * *

## 回答 #4

> 赞同：151
> 
> 时间：2012-03-01T04:23:15.060

这是另一种值得在这里提及的方法，[ast.literal_eval](http://docs.python.org/library/ast.html#ast.literal_eval)：

> 这可用于安全地评估来自不受信任来源的包含 Python 表达式的字符串，而无需自己解析值。

也就是说，一个安全的“评估”

```
>>> import ast
>>> ast.literal_eval("545.2222")
545.2222
>>> ast.literal_eval("31")
31 
```

* * *

## 回答 #5

> 赞同：82
> 
> 时间：2013-07-23T16:00:21.820

## 本地化和逗号

`float("545,545.2222")`对于引发异常的情况，您应该考虑在数字的字符串表示中使用逗号的可能性 。相反，使用 in 方法`locale`将字符串转换为数字并正确解释逗号。一旦为所需的数字约定设置了区域设置，该`locale.atof`方法就会一步转换为浮点数。

**示例 1——美国数字约定**

在美国和英国，逗号可以用作千位分隔符。在此使用美国语言环境的示例中，逗号作为分隔符被正确处理：

```
>>> import locale
>>> a = u'545,545.2222'
>>> locale.setlocale(locale.LC_ALL, 'en_US.UTF-8')
'en_US.UTF-8'
>>> locale.atof(a)
545545.2222
>>> int(locale.atof(a))
545545
>>> 
```

**示例 2——欧洲号码约定**

在[世界上大多数国家/地区](https://en.wikipedia.org/wiki/Decimal_mark)，逗号用于小数点而不是句点。在此使用法语语言环境的示例中，逗号被正确处理为小数点：

```
>>> import locale
>>> b = u'545,2222'
>>> locale.setlocale(locale.LC_ALL, 'fr_FR')
'fr_FR'
>>> locale.atof(b)
545.2222 
```

该方法`locale.atoi`也可用，但参数应为整数。

* * *

## 回答 #6

> 赞同：81
> 
> 时间：2008-12-19T02:32:06.807

```
float(x) if '.' in x else int(x) 
```

* * *

## 回答 #7

> 赞同：32
> 
> 时间：2014-08-14T03:21:37.620

如果您不反对第三方模块，可以查看[fastnumbers](https://pypi.org/project/fastnumbers)模块。它提供了一个名为[fast_real](http://fastnumbers.readthedocs.io/en/master/api.html#fastnumbers.fast_real)的函数，它完全符合这个问题的要求，并且比纯 Python 实现更快：

```
>>> from fastnumbers import fast_real
>>> fast_real("545.2222")
545.2222
>>> type(fast_real("545.2222"))
float
>>> fast_real("31")
31
>>> type(fast_real("31"))
int 
```

* * *

## 回答 #8

> 赞同：27
> 
> 时间：2008-12-19T02:09:03.543

用户*codelogic*和*harley*是正确的，但请记住，如果您知道字符串是整数（例如 545），您可以调用 int("545") 而不首先转换为浮点数。

如果您的字符串在列表中，您也可以使用 map 函数。

```
>>> x = ["545.0", "545.6", "999.2"]
>>> map(float, x)
[545.0, 545.60000000000002, 999.20000000000005]
>>> 
```

只有当它们都是同一类型时才好。

* * *

## 回答 #9

> 赞同：26
> 
> 时间：2015-07-23T13:26:05.213

> **在 Python 中，如何将像“545.2222”这样的数字字符串解析为其对应的浮点值 542.2222？或者将字符串“31”解析为整数 31？** 我只想知道如何将浮点字符串解析为浮点数，以及（单独）将 int 字符串解析为 int。

您要求单独执行这些操作很好。如果您将它们混合在一起，您可能会在以后遇到问题。简单的答案是：

**`"545.2222"`浮动：**

```
>>> float("545.2222")
545.2222 
```

**`"31"`为整数：**

```
>>> int("31")
31 
```

# 其他转换、整数与字符串和文字之间的转换：

各种基数的转换，您应该提前知道基数（默认为 10）。请注意，您可以在它们前面加上 Python 对其文字的期望（见下文）或删除前缀：

```
>>> int("0b11111", 2)
31
>>> int("11111", 2)
31
>>> int('0o37', 8)
31
>>> int('37', 8)
31
>>> int('0x1f', 16)
31
>>> int('1f', 16)
31 
```

如果你事先不知道基数，但你知道它们会有正确的前缀，如果你`0`作为基数传递，Python 可以为你推断：

```
>>> int("0b11111", 0)
31
>>> int('0o37', 0)
31
>>> int('0x1f', 0)
31 
```

### 来自其他基数的非十进制（即整数）文字

但是，如果您的动机是让您自己的代码清楚地表示硬编码的特定值，那么您可能不需要从基数转换 - 您可以让 Python 使用正确的语法自动为您完成。

您可以使用 apropos 前缀通过[以下文字](https://docs.python.org/3/reference/lexical_analysis.html#integer-literals)自动转换为整数。这些对 Python 2 和 3 有效：

二进制，前缀`0b`

```
>>> 0b11111
31 
```

八进制，前缀`0o`

```
>>> 0o37
31 
```

十六进制，前缀`0x`

```
>>> 0x1f
31 
```

这在描述二进制标志、代码中的文件权限或颜色的十六进制值时很有用 - 例如，请注意没有引号：

```
>>> 0b10101 # binary flags
21
>>> 0o755 # read, write, execute perms for owner, read & ex for group & others
493
>>> 0xffffff # the color, white, max values for red, green, and blue
16777215 
```

### 使模棱两可的 Python 2 八进制与 Python 3 兼容

如果你看到一个以 0 开头的整数，在 Python 2 中，这是（不推荐使用的）八进制语法。

```
>>> 037
31 
```

这很糟糕，因为它看起来应该是`37`. 所以在 Python 3 中，它现在提出了一个`SyntaxError`：

```
>>> 037
  File "<stdin>", line 1
    037
      ^
SyntaxError: invalid token 
```

将您的 Python 2 八进制转换为可在 2 和 3 中使用的八进制，`0o`前缀为：

```
>>> 0o37
31 
```

* * *

## 回答 #10

> 赞同：21
> 
> 时间：2011-09-28T19:45:18.010

这个问题似乎有点老了。但是让我建议一个函数 parseStr，它可以做类似的事情，即返回整数或浮点数，如果给定的 ASCII 字符串不能转换为它们中的任何一个，它就会原封不动地返回它。当然可以调整代码以仅执行您想要的操作：

```
 >>> import string
   >>> parseStr = lambda x: x.isalpha() and x or x.isdigit() and \
   ...                      int(x) or x.isalnum() and x or \
   ...                      len(set(string.punctuation).intersection(x)) == 1 and \
   ...                      x.count('.') == 1 and float(x) or x
   >>> parseStr('123')
   123
   >>> parseStr('123.3')
   123.3
   >>> parseStr('3HC1')
   '3HC1'
   >>> parseStr('12.e5')
   1200000.0
   >>> parseStr('12$5')
   '12$5'
   >>> parseStr('12.2.2')
   '12.2.2' 
```

* * *

## 回答 #11

> 赞同：18
> 
> 时间：2008-12-19T01:54:11.093

`float("545.2222")`和`int(float("545.2222"))`

* * *

## 回答 #12

> 赞同：15
> 
> 时间：2013-04-16T03:03:11.720

[YAML](http://en.wikipedia.org/wiki/YAML)解析器可以帮助您确定您的字符串是什么数据类型。使用`yaml.load()`，然后您可以使用`type(result)`来测试类型：

```
>>> import yaml

>>> a = "545.2222"
>>> result = yaml.load(a)
>>> result
545.22220000000004
>>> type(result)
<type 'float'>

>>> b = "31"
>>> result = yaml.load(b)
>>> result
31
>>> type(result)
<type 'int'>

>>> c = "HI"
>>> result = yaml.load(c)
>>> result
'HI'
>>> type(result)
<type 'str'> 
```

* * *

## 回答 #13

> 赞同：13
> 
> 时间：2017-07-09T08:02:56.153

我为此使用此功能

```
import ast

def parse_str(s):
   try:
      return ast.literal_eval(str(s))
   except:
      return 
```

它将字符串转换为其类型

```
value = parse_str('1')  # Returns Integer
value = parse_str('1.5')  # Returns Float 
```

* * *

## 回答 #14

> 赞同：11
> 
> 时间：2015-10-08T13:39:08.103

```
def get_int_or_float(v):
    number_as_float = float(v)
    number_as_int = int(number_as_float)
    return number_as_int if number_as_float == number_as_int else number_as_float 
```

* * *

## 回答 #15

> 赞同：9
> 
> 时间：2015-10-09T18:04:52.547

```
def num(s):
    """num(s)
    num(3),num(3.7)-->3
    num('3')-->3, num('3.7')-->3.7
    num('3,700')-->ValueError
    num('3a'),num('a3'),-->ValueError
    num('3e4') --> 30000.0
    """
    try:
        return int(s)
    except ValueError:
        try:
            return float(s)
        except ValueError:
            raise ValueError('argument is not a string of number') 
```

* * *

## 回答 #16

> 赞同：6
> 
> 时间：2010-10-21T14:10:01.737

您需要考虑四舍五入才能正确执行此操作。

即 int(5.1) => 5 int(5.6) => 5 -- 错误，应该是 6 所以我们做 int(5.6 + 0.5) => 6

```
def convert(n):
    try:
        return int(n)
    except ValueError:
        return float(n + 0.5) 
```

* * *

## 回答 #17

> 赞同：6
> 
> 时间：2017-07-12T17:01:41.583

我很惊讶没有人提到正则表达式，因为有时必须在转换为数字之前准备好字符串并对其进行规范化

```
import re
def parseNumber(value, as_int=False):
    try:
        number = float(re.sub('[^.\-\d]', '', value))
        if as_int:
            return int(number + 0.5)
        else:
            return number
    except ValueError:
        return float('nan')  # or None if you wish 
```

用法：

```
parseNumber('13,345')
> 13345.0

parseNumber('- 123 000')
> -123000.0

parseNumber('99999\n')
> 99999.0 
```

顺便说一句，可以验证您是否有号码：

```
import numbers
def is_number(value):
    return isinstance(value, numbers.Number)
    # will work with int, float, long, Decimal 
```

* * *

## 回答 #18

> 赞同：6
> 
> 时间：2019-12-10T15:25:36.897

将您的字符串传递给此函数：

```
def string_to_number(str):
  if("." in str):
    try:
      res = float(str)
    except:
      res = str  
  elif(str.isdigit()):
    res = int(str)
  else:
    res = str
  return(res) 
```

它将根据传递的内容返回 int、float 或 string。

**一个 int 的字符串**

```
print(type(string_to_number("124")))
<class 'int'> 
```

**浮点数的字符串**

```
print(type(string_to_number("12.4")))
<class 'float'> 
```

**作为字符串的字符串**

```
print(type(string_to_number("hello")))
<class 'str'> 
```

**看起来像浮点数的字符串**

```
print(type(string_to_number("hel.lo")))
<class 'str'> 
```

* * *

## 回答 #19

> 赞同：5
> 
> 时间：2018-07-01T20:42:31.263

要在 python 中进行类型转换，请使用类型的构造函数，将字符串（或您尝试转换的任何值）作为参数传递。

例如：

```
>>>float("23.333")
   23.333 
```

在幕后，python 正在调用 objects`__float__`方法，该方法应该返回参数的浮点表示。这特别强大，因为您可以使用方法定义自己的类型（使用类），`__float__`以便可以使用 float(myobject) 将其转换为浮点数。

* * *

## 回答 #20

> 赞同：5
> 
> 时间：2019-11-22T15:14:34.333

**处理十六进制、八进制、二进制、十进制和浮点数**

该解决方案将处理数字的所有字符串约定（我所知道的一切）。

```
def to_number(n):
    ''' Convert any number representation to a number 
    This covers: float, decimal, hex, and octal numbers.
    '''

    try:
        return int(str(n), 0)
    except:
        try:
            # python 3 doesn't accept "010" as a valid octal.  You must use the
            # '0o' prefix
            return int('0o' + n, 0)
        except:
            return float(n) 
```

这个测试用例输出说明了我在说什么。

```
======================== CAPTURED OUTPUT =========================
to_number(3735928559)   = 3735928559 == 3735928559
to_number("0xFEEDFACE") = 4277009102 == 4277009102
to_number("0x0")        =          0 ==          0
to_number(100)          =        100 ==        100
to_number("42")         =         42 ==         42
to_number(8)            =          8 ==          8
to_number("0o20")       =         16 ==         16
to_number("020")        =         16 ==         16
to_number(3.14)         =       3.14 ==       3.14
to_number("2.72")       =       2.72 ==       2.72
to_number("1e3")        =     1000.0 ==       1000
to_number(0.001)        =      0.001 ==      0.001
to_number("0xA")        =         10 ==         10
to_number("012")        =         10 ==         10
to_number("0o12")       =         10 ==         10
to_number("0b01010")    =         10 ==         10
to_number("10")         =         10 ==         10
to_number("10.0")       =       10.0 ==         10
to_number("1e1")        =       10.0 ==         10 
```

这是测试：

```
class test_to_number(unittest.TestCase):

    def test_hex(self):
        # All of the following should be converted to an integer
        #
        values = [

                 #          HEX
                 # ----------------------
                 # Input     |   Expected
                 # ----------------------
                (0xDEADBEEF  , 3735928559), # Hex
                ("0xFEEDFACE", 4277009102), # Hex
                ("0x0"       ,          0), # Hex

                 #        Decimals
                 # ----------------------
                 # Input     |   Expected
                 # ----------------------
                (100         ,        100), # Decimal
                ("42"        ,         42), # Decimal
            ]

        values += [
                 #        Octals
                 # ----------------------
                 # Input     |   Expected
                 # ----------------------
                (0o10        ,          8), # Octal
                ("0o20"      ,         16), # Octal
                ("020"       ,         16), # Octal
            ]

        values += [
                 #        Floats
                 # ----------------------
                 # Input     |   Expected
                 # ----------------------
                (3.14        ,       3.14), # Float
                ("2.72"      ,       2.72), # Float
                ("1e3"       ,       1000), # Float
                (1e-3        ,      0.001), # Float
            ]

        values += [
                 #        All ints
                 # ----------------------
                 # Input     |   Expected
                 # ----------------------
                ("0xA"       ,         10), 
                ("012"       ,         10), 
                ("0o12"      ,         10), 
                ("0b01010"   ,         10), 
                ("10"        ,         10), 
                ("10.0"      ,         10), 
                ("1e1"       ,         10), 
            ]

        for _input, expected in values:
            value = to_number(_input)

            if isinstance(_input, str):
                cmd = 'to_number("{}")'.format(_input)
            else:
                cmd = 'to_number({})'.format(_input)

            print("{:23} = {:10} == {:10}".format(cmd, value, expected))
            self.assertEqual(value, expected) 
```

* * *

## 回答 #21

> 赞同：5
> 
> 时间：2020-10-09T07:15:39.783

```
a = int(float(a)) if int(float(a)) == float(a) else float(a) 
```

* * *

## 回答 #22

> 赞同：4
> 
> 时间：2021-09-12T02:02:53.870

你可以使用`json.loads`：

```
>>> import json
>>> json.loads('123.456')
123.456
>>> type(_)
<class 'float'>
>>> 
```

如您所见，它变成了`float`.

* * *

## 回答 #23

> 赞同：3
> 
> 时间：2017-05-18T07:28:27.643

**这是 [https://stackoverflow.com/a/33017514/5973334](https://stackoverflow.com/a/33017514/5973334)**的更正版本****

 **这将尝试解析字符串并根据字符串表示的内容返回`int`或返回。`float`它可能会引发解析异常或[出现一些意外行为](https://stackoverflow.com/a/1778381/5973334)。

```
 def get_int_or_float(v):
        number_as_float = float(v)
        number_as_int = int(number_as_float)
        return number_as_int if number_as_float == number_as_int else 
        number_as_float 
```

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2016-10-09T05:40:12.323

采用：

```
def num(s):
    try:
        for each in s:
            yield int(each)
    except ValueError:
        yield float(each)
a = num(["123.55","345","44"])
print a.next()
print a.next() 
```

这是我能想到的最 Pythonic 的方式。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2021-07-15T16:04:19.643

这是一个老问题，已经得到了很多答案。但是，如果您正在处理混合整数和浮点数并且想要一种一致的方式来处理您的混合数据，这是我使用正确文档字符串的解决方案：

```
def parse_num(candidate):
    """parse string to number if possible
    work equally well with negative and positive numbers, integers and floats.

    Args:
        candidate (str): string to convert

    Returns:
        float | int | None: float or int if possible otherwise None
    """
    try:
        float_value = float(candidate)
    except ValueError:
        return None

    # optional part if you prefer int to float when decimal part is 0 
    if float_value.is_integer():
        return int(float_value)
    # end of the optional part

    return float_value

# test
candidates = ['34.77', '-13', 'jh', '8990', '76_3234_54']
res_list = list(map(parse_num, candidates))
print('Before:')
print(candidates)
print('After:')
print(res_list) 
```

输出：

```
Before:
['34.77', '-13', 'jh', '8990', '76_3234_54']
After:
[34.77, -13, None, 8990, 76323454] 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2016-09-11T14:32:41.163

采用：

```
>>> str_float = "545.2222"
>>> float(str_float)
545.2222
>>> type(_) # Check its type
<type 'float'>

>>> str_int = "31"
>>> int(str_int)
31
>>> type(_) # Check its type
<type 'int'> 
```

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2019-08-12T09:18:46.880

这是一个函数，它将根据提供的实际字符串是否*类似于*or将任何`object`（不仅仅是`str`）转换为`int`or 。此外，如果它是同时具有和方法的对象，则默认为使用`float` *`int``float``__float``__int__``__float__`*

 *```
def conv_to_num(x, num_type='asis'):
    '''Converts an object to a number if possible.
    num_type: int, float, 'asis'
    Defaults to floating point in case of ambiguity.
    '''
    import numbers

    is_num, is_str, is_other = [False]*3

    if isinstance(x, numbers.Number):
        is_num = True
    elif isinstance(x, str):
        is_str = True

    is_other = not any([is_num, is_str])

    if is_num:
        res = x
    elif is_str:
        is_float, is_int, is_char = [False]*3
        try:
            res = float(x)
            if '.' in x:
                is_float = True
            else:
                is_int = True
        except ValueError:
            res = x
            is_char = True

    else:
        if num_type == 'asis':
            funcs = [int, float]
        else:
            funcs = [num_type]

        for func in funcs:
            try:
                res = func(x)
                break
            except TypeError:
                continue
        else:
            res = x 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2020-07-19T21:40:45.810

对于数字和字符一起：

```
string_for_int = "498 results should get"
string_for_float = "498.45645765 results should get" 
```

首先导入重新：

```
 import re

 #for get integer part:
 print(int(re.search(r'\d+', string_for_int).group())) #498

 #for get float part:
 print(float(re.search(r'\d+\.\d+', string_for_float).group())) #498.45645765 
```

对于简单的模型：

```
value1 = "10"
value2 = "10.2"
print(int(value1)) #10
print(float(value2)) #10.2 
```

* * *

## 回答 #29

> 赞同：-2
> 
> 时间：2020-05-26T12:34:07.447

通过使用 int 和 float 方法，我们可以将字符串转换为整数和浮点数。

```
s="45.8"
print(float(s))

y='67'
print(int(y)) 
```

* * *

## 回答 #30

> 赞同：-12
> 
> 时间：2008-12-19T02:29:34.797

这是对您的问题的另一种解释（提示：含糊不清）。您可能正在寻找这样的东西：

```
def parseIntOrFloat( aString ):
    return eval( aString ) 
```

它像这样工作......

```
>>> parseIntOrFloat("545.2222")
545.22220000000004
>>> parseIntOrFloat("545")
545 
```

* * *

理论上，存在注入漏洞。例如，字符串可以是`"import os; os.abort()"`. 然而，在没有任何关于字符串来自何处的背景的情况下，这种可能性是理论上的推测。由于问题含糊不清，因此根本不清楚该漏洞是否真的存在。

# .net - 如何实现一个定义规则

> ID：379916
> 
> 赞同：2
> 
> 时间：2008-12-19T01:56:23.587
> 
> 标签：.net, c++, one-definition-rule

[这篇文章](https://stackoverflow.com/questions/48496/how-to-teach-a-crash-course-on-c)引用了一个定义规则。

[维基百科在解释如何实现它方面非常糟糕](http://en.wikipedia.org/wiki/One_Definition_Rule)

我在哪里可以找到有关 C++ .NET 中要遵循的指南的良好资源？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-19T02:22:38.760

单一定义规则基本上意味着一个变量/函数只能位于编译的可执行文件的地址空间中的一个位置。一种思考方式是在编译时，在已编译的程序（目标代码）中使用一个内存数组，以及一个用于引用变量/函数位置的查找表。这是在每个进程级别上完成的。假设以下是一个简单的程序：

文件1.cpp

```
int square(int x); // this is a declaration
extern int someVariable; // this is a declration

void square(int x)  // this is a definition
{
    return x * someVariable;
} 
```

文件2.cpp

```
int square(int x); // this is a declaration

int someVariable; // this is a definition    
void main()
{
    someVariable = 12;
    someVariable = square(4);
} 
```

当编译器开始编译目标代码时，它会读入声明，并将事物放入其表中。在编译 file1.cpp 结束时，它最终会是这样的：

```
declarations:
    square (XX): function that returns int, and takes a single int as parameter [4 bytes]
    someVariable (YY): integer [4 bytes]
data:
    12 34 56 78 aa XX XX XX XX ab cd
definition:
    square: starts at address 0 
```

这假设函数被编译为那些特定的汇编指令。在链接器时，XX XX XX XX 将被替换为 someVariable 的地址。

File2 最终类似于：

```
declarations:
    square (XX): function that returns int, and takes a single int as parameter [4 bytes]
    someVariable (YY): integer [4 bytes]
data:
    00 00 00 00 12 34 56 78 12 34 56 YY YY YY YY 23 21
definitions:
    someVariable: starts at address 0
    main: starts at address 4 
```

在这种情况下，YY 将被替换为 square 的地址。

这就是链接器发挥作用的地方。链接器的工作是遍历列表，并在编译时建立一个表，其中所有内容都在程序的地址空间中。但是，如果两个目标文件在尝试链接时具有相同的变量定义，则会出现问题。如果上面的例子中有两个 someVariable 的定义，那么它就不会知道用什么来替换 YY。同样，如果*没有*定义，那么你会得到丑陋的链接器错误。

该规则的“解决方案”是对文件进行分区，以便仅在 .cpp 文件中具有定义，并在 .h 文件中声明事物，因此上面的示例将变为：

文件1.cpp

```
#include "file2.h"

void square(int x)  // this is a definition
{
    return x * someVariable;
} 
```

文件1.h

```
int square(int x); // this is a declaration 
```

文件2.cpp

```
#include "file1.h"

int someVariable; // this is a definition    
void main()
{
    someVariable = 12;
    someVariable = square(4);
} 
```

文件2.h

```
extern int someVariable; 
```

请注意，这是一个非常简单的示例，并且它并不真正适用于 .NET，因为在声明和定义之间没有区别的概念。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-19T02:04:39.233

遵守单一定义规则的最简单方法是将定义放在 .cpp 文件中，而不是在头文件中。

人们有时使用宏和/或预处理器条件将定义放入头文件中，以使对象或函数仅在一个编译单元中定义。但是通常将定义放在 .cpp 文件中更容易（当然也更容易理解）。

# javascript - iFrame / Javascript鼠标加速中的Javascript iPhone滚动效果

> ID：379917
> 
> 赞同：12
> 
> 时间：2008-12-19T01:59:13.220
> 
> 标签：javascript, jquery, iphone, iframe, acceleration

我正在尝试使用 JavaScript 在窗口中重新创建 iPhone 轻弹/滚动事件。

从 JQuery 开始，我正在使用计时器测量鼠标在单击 - 拖动 - 释放事件期间的加速度和偏移：

```
var MouseY = {

    init: function(context) {
        var self = this;
        self._context = context || window
        self._down = false;
        self._now = 0;
        self._last = 0;
        self._offset = 0;
        self._timer = 0;
        self._acceleration = 0;

        $(self._context).mousedown(function() {self._down = true;});
        $(self._context).mouseup(function() {self._down = false;});
        $(self._context).mousemove(function(e) {self.move(e);});

    },

    move: function(e) {
        var self = this;
        self._timer++;
        self._last = self._now;
        self._now = e.clientY + window.document.body.scrollTop;
        self._offset = self._now - self._last;
        self._acceleration = self._offset / self._timer;
    },

    reset: function() {
        this._offset = 0;
        this._acceleration = 0;
        this._timer = 0;
    }
};

$(function() {
    MouseY.init();
    setInterval(function() {
        $('#info').html(
            '_acceleration:' + MouseY._acceleration + '<br />' +
            '_now:' + MouseY._now + '<br />' +
            '_offset:' + MouseY._offset + '<br />' +
            '_timer:' + MouseY._timer + '<br />'
        );
        MouseY.reset();
    }, 10);

}); 
```

现在的问题是将加速转化为屏幕移动 - 是否有任何算法（缓动？）或动画库可以帮助我解决这个问题？（我已经查看了 JQuery 的 .animate() 但我不确定如何在拖动事件期间连续应用它！

**更新 - 这里的最终解决方案：**

[http://johnboxall.github.com/iphone.html](http://johnboxall.github.com/iphone.html)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2011-01-04T04:06:26.157

这是我在寻找动力学/动量滚动库时发现的：

*   [iScroll](http://cubiq.org/iscroll)
*   [Zynga 滚动条](https://github.com/zynga/scroller)
*   [过度滚动](http://www.azoffdesign.com/plugins/js/overscroll)
*   [触摸滚动](http://uxebu.com/blog/2010/09/15/touchscroll-0-2-first-alpha-available/)
*   [jScrollTouch](http://plugins.jquery.com/project/jScrollTouch)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-19T03:11:57.833

点击此链接以获得对似乎是您正在寻找的一种方法的完整解释。

[http://www.faqts.com/knowledge_base/view.phtml/aid/14742/fid/53](http://www.faqts.com/knowledge_base/view.phtml/aid/14742/fid/53)

这是一段摘录：

> 然后，此处理程序为鼠标移动设置事件捕获，并将鼠标光标位置存储在变量 mouseX 和 mouseY 中。然后它启动计时器monitorMouse()，它通过定期对这些变量中的值进行采样来测量鼠标光标速度。变量 mouseLeft 和 mouseTop 保存每个采样鼠标位置，并且在变量 monitor.timerDelay 中将采样率设置为 100 毫秒。

以及一些作者的代码：

```
nn4 = (document.layers)? true:false;
mouseLeft = mouseTop = mouseX = mouseY = 0;
monitor = {
    timerDelay:100,
    moveLimit:2,
    sampleLimit:10
};

function startMonitor(thisText) {
    if (!tip) return;
    toolTipText = thisText;
    writeTooltip(toolTipText);

    document.captureEvents(Event.MOUSEMOVE);
    document.onmousemove = function (evt) {
        mouseX = evt.pageX;
        mouseY = evt.pageY;
        return true;
    }
    monitorMouse();
}

function stopMonitor() {
    if (!tip) return;
    hideTooltip();
        if (monitor.timer) {
        clearTimeout(monitor.timer);
        monitor.timer = null;
    }
    document.releaseEvents(Event.MOUSEMOVE);
    document.onmousemove = null;
    monitor.slowSamples = 0;
}

function monitorMouse() {
    if (Math.abs(mouseX - mouseLeft)   > monitor.moveLimit
        || Math.abs(mouseY - mouseTop) > monitor.moveLimit)
    {
        monitor.slowSamples = 0;
    }
    else if (++monitor.slowSamples > monitor.sampleLimit) {
        showTooltip();
        return;
    }
    mouseLeft = mouseX;
    mouseTop  = mouseY;
    monitor.timer = setTimeout("monitorMouse()",monitor.timerDelay);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-02-04T20:29:26.493

您可能对名为 overscroll 的 jQuery 插件感兴趣： [http](http://www.azoffdesign.com/overscroll) ://www.azoffdesign.com/overscroll （[GitHub 页面](https://github.com/azoff/Overscroll)）

# php - 如何在 Joomla 1.5 中获取当前模板的路径？

> ID：379920
> 
> 赞同：24
> 
> 时间：2008-12-19T01:59:52.987
> 
> 标签：php, joomla, joomla1.5

我正在编写一个组件，并想从模板文件夹中插入图像。

如何获得模板文件夹的正确路径？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-12-19T15:49:08.300

IIRC，$mainframe 全局对象最终会消失。这是通过框架执行此操作的一种方法：

```
$app = JFactory::getApplication();
$templateDir = JURI::base() . 'templates/' . $app->getTemplate(); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-23T05:10:22.500

什么样的路径...在文件系统上：

```
$templateDir = JPATH_THEMES.DS.JFactory::getApplication()->getTemplate().DS; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-19T02:11:25.660

我想出了一种方法。使用全局 $mainframe 对象。

```
$templateDir = $mainframe->getBasePath() . "templates/" . $mainframe->getTemplate(); 
```

还有另一种（更好的）方法吗？

# inno-setup - INNO：文件正在使用时不允许“忽略”

> ID：379926
> 
> 赞同：3
> 
> 时间：2008-12-19T02:04:44.600
> 
> 标签：inno-setup

我正在为我的 Windows 应用程序的安装程序使用 Inno Setup。如果用户在安装程序运行时拥有应用程序（例如更新），安装程序将在无法替换正在使用的文件时停止，并允许用户选择是中止、忽略还是重试。

我希望它只允许中止或重试并删除忽略选项。有谁知道如何做到这一点？

或者如果这不能完成，如果应用程序正在运行，我怎样才能让安装程序中止？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-19T04:26:00.023

检测应用程序是否正在运行的简单方法需要应用程序的合作，因此最好在发布第一个版本*之前解决这个问题。***使用 Inno Setup 的`AppMutex`设置。**[Inno Setup 知识库中](http://www.jrsoftware.org/iskb.php?mutexsessions)有一个示例，用于设置在多个会话中可见的互斥锁。Inno Setup 的帮助文件中有更多内容`AppMutex`。

# perl - 您如何使用 Apache“ScriptInterpreterSource Registry-Strict”指令？

> ID：379930
> 
> 赞同：7
> 
> 时间：2008-12-19T02:06:23.783
> 
> 标签：perl, apache, cgi

我在 Windows 上运行 Apache Web 服务器，以便处理一些 Perl CGI 脚本。在生产中，这些脚本在 linux 机器上运行，并且在源代码存储库中它们都有 shebangs，例如：`#!/usr/bin/perl`，但在我的 windows 机器上，shebangs 会是`#!c:\perl\bin\perl.exe`，所以我与源代码库有冲突。

输入 Apache *ScriptInterpreterSource*指令。

我一直在努力使它工作，基于我可以谷歌。但到目前为止还没有运气。我有：

1.  将这些内容添加到相应的指令 AllowOverride None
    Options Indexes FollowSymLinks ExecCGI Order allow,deny Allow from all ScriptInterpreterSource Registry-Strict

2.  补充：AddHandler cgi-script .cgi

3.  编辑了我的注册表并添加了一个新字符串

> ```
> HKEY_CLASSES_ROOT\.cgi\Shell\ExecCGI\Command=C:\Perl\bin\perl.exe 
> ```

现在，我知道 CGI 只要有正确的 shebang 就可以在这台服务器上工作。

但是当我尝试在没有 shebang 的情况下访问 CGI 时，apache 日志会吐出：

> 找不到类型为“.cgi”的文件的 Exec CGI 动词

任何想法，见解，甚至是疯狂的猜测都会受到赞赏。

谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-22T18:35:43.047

听起来 ScriptInterpreterSource 行被忽略了。如果它设置为 Registry 或 Registry-Strict，它应该忽略 shebang 行并**仅**使用注册表。

此外，[Apache 2.2 文档](http://httpd.apache.org/docs/2.2/mod/core.html#scriptinterpretersource)的注册表项位置略有不同：

```
HKEY_CLASSES_ROOT\.cgi\Shell\ExecCGI\Command\(Default) => C:\Perl\bin\perl.exe -wT 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-07-18T00:20:26.110

这也适用于 Python 脚本。我执行以下操作来修复我的 Apache 安装以忽略脚本中的 shebang 要求。如果没有这个，当前版本的 Apache 2.4 中需要 shebang - 或者至少在我的版本中。

```
# tell apache to use registry - this requried a registry hack
# to the following: 
# [HKEY_CLASSES_ROOT\.py\Shell\ExecCGI\Command] = "c:\\python\\python.exe"
ScriptInterpreterSource Registry-Strict 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-24T20:53:19.150

与其在单独的 CGI 进程中运行 perl 代码，不如考虑使用**mod_perl**（参见[http://perl.apache.org](http://perl.apache.org)）。

Mod_perl 效率更高，因为 Perl 代码只加载和解析一次，然后直接在 Apache 进程中运行，无需启动或与其他进程通信。

# nhibernate - NHibernate 不持久化集合

> ID：379938
> 
> 赞同：1
> 
> 时间：2008-12-19T02:14:52.363
> 
> 标签：nhibernate, ado.net, isession

我对 NHibernate 有一个相当奇怪的错误。我在跨线程共享 ISession 时遇到错误，并通过提供我自己的 ADO.NET 连接解决了这个问题，例如：

```
 IDbConnection connection = new SqlConnection(ApplicationConfiguration.ConnectionString);
            connection.Open();

            ISession session = _sessionFactory.OpenSession(connection);
            session.FlushMode = FlushMode.Commit;

            return session; 
```

我的应用程序现在可以工作，但是所有带有集合的对象都被保存在数据库中，没有它们的集合。例如，假设一辆车有一个轮胎列表。然后我创建一辆车，然后根据数据库中已有的轮胎生成轮胎列表。保存汽车对象只会保存汽车而不是列表！

对我做错了什么有任何帮助吗？我正在使用 NHibernate 2.0，我确实调用了 Session.Flush() 和 Transaction.Commit()。

干杯。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-19T13:57:22.363

嗨，我弄清楚了收藏没有被持久化的原因。我的工作单元是调用一个属性，该属性返回一个 Isession 对象来持久化我的对象。然而，这个属性实际上为每次调用返回了一个新的 ISession。因为我更正了这一点以在每个工作单元中使用相同的 ISession，所以对象被正确地持久化了。感谢您的所有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-19T03:30:20.637

查看集合映射上的级联属性 - 默认情况下，该属性设置为“无”，这意味着需要显式保存子实体。您可能想要 cascade="all" 或 cascade="all-delete-orphan"。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-19T12:47:49.523

您在轮胎列表的刷新和提交之前使用 NHibernate.ISession.save(object) 吗？

# mysql - 如何编写此 INSERT 以使其正常工作

> ID：379939
> 
> 赞同：1
> 
> 时间：2008-12-19T02:15:12.423
> 
> 标签：mysql

基本上，我想将“今天”年、月、日放入两个字段中……类似于以下内容。尝试了各种但不能正确

> “插入到film_out（start_year，start_month，start_day），（end_year，end_month，end_day）值（'$year'，'$month'，'$day'）”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-19T02:18:53.620

?

```
"INSERT INTO film_out (start_year, start_month, start_day, end_year, end_month, end_day)
      VALUES ('$year', '$month', '$day', '$year', '$month', '$day')" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-19T02:19:17.423

```
INSERT INTO film_out 
(start_year, start_month, start_day, end_year, end_month, end_day) 
VALUES 
(?,?,?,?,?,?) 
```

你有六列，所以你需要六个值。

如果您有两组三个值，则需要重复相同的值。

您想使用绑定变量而不是直接插值（？而不是'$year'）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-19T02:24:51.907

不确定您的列类型是什么，所以我假设它们是数字...

```
INSERT INTO film_out (start_year, start_month, start_day, end_year, end_month, end_day)
VALUES (YEAR(), MONTH(NOW()), DAYOFMONTH() + 1, YEAR(), MONTH(NOW()), DAYOFMONTH() + 1) 
```

# emacs - 异步复制

> ID：379940
> 
> 赞同：11
> 
> 时间：2008-12-19T02:15:33.283
> 
> 标签：emacs, dired

有没有办法修改/告诉dired异步复制文件？如果您在 dired 中标记多个文件，然后使用“C”复制它们，emacs 会锁定，直到每个文件都被复制。相反，我希望启动此副本，并在后台继续编辑。有没有办法获得这种行为？

编辑：实际上，C 在 dired-aux 中调用'dired-do-copy'，而不是在 dired 本身中。很抱歉有任何混淆。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-19T03:19:52.997

我认为emacs主要限于单个线程-因此这可能无法通过标准的dired命令（例如'C' copy）直接实现。

但是，有一个 dired 命令“ [dired-do-shell-command](http://www.gnu.org/software/emacs/manual/html_node/emacs/Shell-Commands-in-Dired.html) ”，它调用 shell 在后台完成工作。如果您选择要复制的文件，然后使用键“！” （这运行 dired-do-shell-command）然后输入 'cp ? [destination]'（如果您在 Windows 上，可能可以使用 'copy'）。我还没有对此进行测试 - 所以请参阅“dired-do-shell-command”的帮助以获取完整的详细信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-16T09:34:24.237

另请参阅 Emacs 函数`dired-do-async-shell-command`。

对于更通用的解决方案，请参阅[https://github.com/jwiegley/emacs-async](https://github.com/jwiegley/emacs-async)，您还可以通过调用单独的 Emacs 进程来评估任意 Emacs Lisp 代码（这当然会产生一些额外的延迟）。更具体地说，关于文件操作，请参阅此 repo 中的文件 dired-async.el。

另请注意，在 Emacs 中以工作名称 Concurrent Emacs 进行线程化的工作，但还没有。有关详细信息，请参阅[http://www.emacswiki.org/emacs/ConcurrentEmacs](http://www.emacswiki.org/emacs/ConcurrentEmacs)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-04-26T19:17:47.177

我发现这个答案很有帮助：[https](https://emacs.stackexchange.com/a/13802/10761) ://emacs.stackexchange.com/a/13802/10761 。阅读该答案表明您可以使用该方法而不是该方法`dired`进行复制（后者最初使用该方法对文件进行编码，并且可能会很慢）。该方法仅在文件大于时才会与程序一起复制（默认情况下）。将此方法与 结合使用非常好，因为它不仅可以快速复制 with ，而且还可以异步进行并且不碍事。`scp``ssh``gzip``scp``scp``tramp-copy-size-limit``10240``scp`[`dired-async-mode`](https://github.com/jwiegley/emacs-async#install-dired-async)`scp`

另外，我认为这很有用：[https](https://oremacs.com/2016/02/24/dired-rsync/) ://oremacs.com/2016/02/24/dired-rsync/ 。它提供了这段代码用于`rsync`复制文件`dired`：

```
;;;###autoload
(defun ora-dired-rsync (dest)
  (interactive
   (list
    (expand-file-name
     (read-file-name
      "Rsync to:"
      (dired-dwim-target-directory)))))
  ;; store all selected files into "files" list
  (let ((files (dired-get-marked-files
                nil current-prefix-arg))
        ;; the rsync command
        (tmtxt/rsync-command
         "rsync -arvz --progress "))
    ;; add all selected file names as arguments
    ;; to the rsync command
    (dolist (file files)
      (setq tmtxt/rsync-command
            (concat tmtxt/rsync-command
                    (shell-quote-argument file)
                    " ")))
    ;; append the destination
    (setq tmtxt/rsync-command
          (concat tmtxt/rsync-command
                  (shell-quote-argument dest)))
    ;; run the async shell command
    (async-shell-command tmtxt/rsync-command "*rsync*")
    ;; finally, switch to that window
    (other-window 1)))

(define-key dired-mode-map "Y" 'ora-dired-rsync) 
```

# c# - 我可以强制 Windows 质询用户进行身份验证吗？

> ID：379941
> 
> 赞同：2
> 
> 时间：2008-12-19T02:15:40.723
> 
> 标签：c#, .net, security, networking, file-io

这是场景：

我希望我的程序可以访问网络上有一个文件。他们在运行我的软件时没有在网络上进行身份验证，因此访问文件失败。

如果我让用户打开资源管理器并手动导航到网络路径，Windows 会询问他们的凭据，从那时起，每当我的软件尝试访问该文件时，它都可以正常工作。

那么，有没有一种方法可以让我说“打开这个文件，如果有帮助，可以向用户询问密码”？

显然，让他们打开资源管理器并不是最好的解决方案:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-19T10:52:04.813

您需要 Windows API 函数[WNetAddConnection3](http://msdn.microsoft.com/en-us/library/aa385418(VS.85).aspx)，它可以直接通过[P/Invoke 调用](http://pinvoke.net/default.aspx/mpr.WNetAddConnection3)。传递`CONNECT_INTERACTIVE`旗帜。

# javascript - Subspace JavaScript 跨域通信的实现？

> ID：379957
> 
> 赞同：1
> 
> 时间：2008-12-19T02:25:38.143
> 
> 标签：javascript, apache-flex, flash, cross-domain

这篇[pdf 论文](http://www2007.org/papers/paper801.pdf)描述了一种在服务器的帮助下使用 JavaScript 管理跨域通信的方法。

有没有人有这种方法的经验？我知道[CrossSafe](http://groups.google.com/group/crosssafe)有一个实现，但那里很安静。（该组中的 NSFW 垃圾邮件。）

当我们在这里时，有人知道一个好的闪桥吗？我也可以将 crossdomain.xml 作为解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-27T13:36:39.340

该链接没有指向 pdf 论文。它通过一堆链接链接到一些人的个人资料。

如果您想进行跨域通信，您有两个主要选择：服务器端代理或 JSON 调用。

埃里克

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-05T13:33:28.897

你为什么不检查easyXDM（[http://easyxdm.net](http://easyxdm.net)）。它非常易于使用并具有一些漂亮的功能，例如，请查看[http://consumer.easyxdm.net/example/methods.html](http://consumer.easyxdm.net/example/methods.html)。它适用于使用最佳可用技术（postMessage、fragment）的所有浏览器

# .net - 通过 .NET WinForms Framework 2.0 中的上下文菜单进行编程导航

> ID：379958
> 
> 赞同：1
> 
> 时间：2008-12-19T02:25:49.533
> 
> 标签：.net, vb.net, winforms, menu

我有一个用 VB.NET 框架 2.0 编写的 Windows 窗体应用程序。

我有一个具有以下结构的关联上下文菜单的网格：

```
MenuItem1
MenuItem2 -->
             SubMenuItem1
             SubMenuItem2 -->
                             SubSubMenuItem1
MenuItem3
... 
```

我希望在网格中按下特定键时显示上下文菜单，并以`'SubMenuItem1'`编程方式进行选择。

`KeyUp`我可以通过以下方式从网格事件中调用上下文菜单项上的 Show() 方法来显示上下文菜单：

```
contextMenu.Show(MainForm.GetSingleton(), Cursor.Position) 
```

但是，我无法弄清楚如何以编程方式选择子菜单或子子菜单中的项目。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-19T09:24:02.573

如果有人在五分钟内出现类似以下内容的代码，这可能是最大最丑陋的代码：ToolStripMenuItem8.selectAllParents()。但据我所见，没有这样的功能。

所以这是我能想到的：

```
 Private Sub openTSMitem(ByVal menu As ContextMenuStrip, ByVal selectitem As ToolStripMenuItem)

    'The menu needs to be open befor we call ShowDropDown
    menu.Show()

    'The list will first contain the parents in the order of bottom to top
    'then we will reverse it so we can open the submenus from top to bottom
    'otherwise it will not open them all
    Dim parentsRevOrder As ArrayList = New ArrayList()

    'Add the parents to the list
    Dim parentItem As ToolStripMenuItem = selectitem.OwnerItem
    While Not parentItem Is Nothing
        parentsRevOrder.Add(parentItem)
        parentItem = parentItem.OwnerItem
    End While
    'reverse the list. now its in the order top to bottom
    'and the submenus will open correctly
    parentsRevOrder.Reverse()

    'now loop through and open the submenus
    For Each tsiParent As ToolStripMenuItem In parentsRevOrder
        tsiParent.ShowDropDown()
    Next

    'and finally select the menuItem we want
    selectitem.Select()

End Sub 
```

然后调用子：

```
openTSMitem(ContextMenuStrip1, ToolStripMenuItem8) 
```

希望能帮助到你。

编辑：我刚刚看到答案中的注释和代码有点混杂，不过只需将其粘贴到 Visual Studio 中，它应该看起来还不错

# sql - 如何使用 SQL Server 2005 透视我的数据

> ID：379962
> 
> 赞同：2
> 
> 时间：2008-12-19T02:28:31.307
> 
> 标签：sql, sql-server, sql-server-2005, pivot

我有以下数据

[![替代文字](https://i.stack.imgur.com/KWyXz.png)](https://i.stack.imgur.com/KWyXz.png)

如何将它（使用 SQL Server 2005）转换为以下格式？

[![替代文字](https://i.stack.imgur.com/1FVoX.png)](https://i.stack.imgur.com/1FVoX.png)

我有一个我想出的示例解决方案，但它似乎有点笨拙。可能有味道？

```
DECLARE @ProductLanguage TABLE
(
    [PRODUCT_ID] int
    , [LANGUAGE] varchar(50)
)

INSERT INTO @ProductLanguage ([PRODUCT_ID],[LANGUAGE]) VALUES (52035,'Czech')
INSERT INTO @ProductLanguage ([PRODUCT_ID],[LANGUAGE]) VALUES (52035,'English')
INSERT INTO @ProductLanguage ([PRODUCT_ID],[LANGUAGE]) VALUES (52035,'German')
INSERT INTO @ProductLanguage ([PRODUCT_ID],[LANGUAGE]) VALUES (54001,'Danish')
INSERT INTO @ProductLanguage ([PRODUCT_ID],[LANGUAGE]) VALUES (54001,'Spanish')
INSERT INTO @ProductLanguage ([PRODUCT_ID],[LANGUAGE]) VALUES (54001,'English')
INSERT INTO @ProductLanguage ([PRODUCT_ID],[LANGUAGE]) VALUES (70501,'Finnish')
INSERT INTO @ProductLanguage ([PRODUCT_ID],[LANGUAGE]) VALUES (70501,'Greek')
INSERT INTO @ProductLanguage ([PRODUCT_ID],[LANGUAGE]) VALUES (70501,'Hungarian')
INSERT INTO @ProductLanguage ([PRODUCT_ID],[LANGUAGE]) VALUES (52044,'Hebrew')

SELECT
    PRODUCT_ID
    ,MAX(CASE WHEN [ROW_ID]=1 THEN LANGUAGE ELSE NULL END) As LANG_1
    ,MAX(CASE WHEN [ROW_ID]=2 THEN LANGUAGE ELSE NULL END) As LANG_2
    ,MAX(CASE WHEN [ROW_ID]=3 THEN LANGUAGE ELSE NULL END) As LANG_3
FROM
    (SELECT
        ROW_NUMBER() OVER (PARTITION BY [PRODUCT_ID] ORDER BY [PRODUCT_ID] ASC) AS [ROW_ID]
        , [PRODUCT_ID]
        , [LANGUAGE]
    FROM
        @ProductLanguage) AS Temp
GROUP BY
    [PRODUCT_ID] 
```

有趣的是我不关心每个 LANG_* 列中显示的特定语言。此处发布的其他问题似乎都涉及按名称了解旋转列。但我不想用找到的语言来命名列。

**注意**：我知道我提到了“pivot”这个词，但这个问题的最佳解决方案可能不涉及 PIVOT 子句。我只是使用了这个词，因为我的问题似乎暗示了数据透视。也许 CTE 会帮助解决问题，我不知道。我只知道我对上面的示例解决方案不满意。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-19T03:06:50.823

您可以使用 PIVOT() 函数

```
SELECT    P.PRODUCT_ID,
          P.Czech,
          P.Other languages
FROM      TABLE AS T
PIVOT     (
              AGGREGATE(LANGUAGE) FOR LANGUAGE IN ([Czech],  ...)
          ) AS P 
```

如果您没有明确命名列，据我所知，您将被迫做一些技巧......

未经测试（显然）。参见： [MSDN](http://msdn.microsoft.com/en-us/library/ms177410.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-21T03:00:42.420

这可以通过`PIVOT`静态或动态的 a 来完成。

静态版本的列是硬编码的（参见[SQL Fiddle with Demo](http://sqlfiddle.com/#!3/1577e/2)）：

```
select *
from 
(
  select product_id, language,
    'Lang_' + cast(row_number() over(partition by PRODUCT_ID order by language) as varchar(10)) rn
  from ProductLanguage
) x
pivot
(
  max(language)
  for rn in ([Lang_1], [Lang_2], [Lang_3])
) p 
```

动态版本将在运行时获取列（参见[SQL Fiddle With Demo](http://sqlfiddle.com/#!3/1577e/5)）：

```
DECLARE @cols AS NVARCHAR(MAX),
    @query  AS NVARCHAR(MAX)

select @cols = STUFF((SELECT distinct ',' + QUOTENAME('Lang_' + cast(row_number() over(partition by PRODUCT_ID order by language) as varchar(10))) 
                    from ProductLanguage
            FOR XML PATH(''), TYPE
            ).value('.', 'NVARCHAR(MAX)') 
        ,1,1,'')

set @query = 'SELECT PRODUCT_ID, ' + @cols + ' from 
             (
              select product_id, language,
                ''Lang_'' + cast(row_number() over(partition by PRODUCT_ID order by language) as varchar(10)) rn
              from ProductLanguage
            ) x
            pivot 
            (
                max(language)
                for rn in (' + @cols + ')
            ) p '

execute(@query) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-19T02:52:34.767

这是一个想法……使用 Pivot 关键字……在 sql2005 中可用

[枢轴和取消枢轴](http://msdn.microsoft.com/en-us/library/ms177410.aspx)

然后在你完成这项工作后，将列名作为数据值输出，将整个 sql statemnt 作为子查询嵌入到外部 Select 语句中，你将列名命名为“Language1”、“Language2”等...

```
Select Z.Arabic as Language1, Z.Botwanese as Language2, etc.
From  (Inner Pivot Query Here ) Z 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-25T14:18:13.833

```
create table  #ProductLanguage 
(
    PRODUCT_ID int
    , [LANGUAGE] varchar(50)
)

INSERT INTO #ProductLanguage  ([PRODUCT_ID],[LANGUAGE]) VALUES (52035,'Czech')
INSERT INTO #ProductLanguage  ([PRODUCT_ID],[LANGUAGE]) VALUES (52035,'English')
INSERT INTO #ProductLanguage  ([PRODUCT_ID],[LANGUAGE]) VALUES (52035,'German')
INSERT INTO #ProductLanguage  ([PRODUCT_ID],[LANGUAGE]) VALUES (54001,'Danish')
INSERT INTO #ProductLanguage  ([PRODUCT_ID],[LANGUAGE]) VALUES (54001,'Spanish')
INSERT INTO #ProductLanguage  ([PRODUCT_ID],[LANGUAGE]) VALUES (54001,'English')
INSERT INTO #ProductLanguage  ([PRODUCT_ID],[LANGUAGE]) VALUES (70501,'Finnish')
INSERT INTO #ProductLanguage  ([PRODUCT_ID],[LANGUAGE]) VALUES (70501,'Greek')
INSERT INTO #ProductLanguage  ([PRODUCT_ID],[LANGUAGE]) VALUES (70501,'Hungarian')
INSERT INTO #ProductLanguage  ([PRODUCT_ID],[LANGUAGE]) VALUES (52044,'Hebrew')

declare @col as varchar(2000)
declare @query as varchar(4000)

--select language ,@col= replace('[Lang_'+str(row_number() over(order by language))+']',' ','') Lang  from (select distinct language  from #ProductLanguage)p
select  @col = stuff((select distinct '],['+language  from #ProductLanguage for xml path('')),1,2,'')+']' 
print @col

set @query = 'select PRODUCT_ID, '+@col+ ' from #ProductLanguage 
pivot (
max(LANGUAGE) for LANGUAGE in ('+@col+')
) pvt'
execute(@query) 
```

# .net - 这个属性在.NET中的含义是什么

> ID：379975
> 
> 赞同：2
> 
> 时间：2008-12-19T02:40:56.413
> 
> 标签：.net, attributes

这个属性是什么意思？

```
<System.ComponentModel.DataObjectMethod(ComponentModel.DataObjectMethodType.Select, True)> _ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-19T02:44:50.133

[这完美地解释了它](http://imar.spaanjaars.com/QuickDocId.aspx?quickdoc=390)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-19T05:10:52.693

[DataObjectAttribute](http://msdn.microsoft.com/en-us/library/system.componentmodel.dataobjectattribute.aspx) “将类型标识为适合绑定到 ObjectDataSource 对象的对象”。

[DataObjectMethodAttribute](http://msdn.microsoft.com/en-us/library/system.componentmodel.dataobjectmethodattribute.aspx)根据支持的数据方法类型（选择、更新、插入、删除）以及是否为默认方法，对用作 ObjectDataSource 的类的方法进行分类。引用的特定属性将该方法标记为类的默认选择方法。

# visual-c++ - 在线汇编语言资源

> ID：379977
> 
> 赞同：9
> 
> 时间：2008-12-19T02:42:28.627
> 
> 标签：visual-c++, assembly, x86

有人有在 x86 上学习汇编语言的资源吗？我正在尝试在 MSVC++6 中调试程序并经常遇到汇编（例如进入 memcpy）。以前我只是忽略了这些，但 memcpy 不断抛出异常，我需要找出原因。

任何帮助，将不胜感激 ：）

编辑：哇，有很多很棒的资源..我希望我可以将所有内容标记为已接受的答案：P

提示：结合任何人？:P

新编辑：我只是浏览了答案，这些似乎是最好的：

Aseraphim[针对英特尔 x86的帖子](http://developer.intel.com/design/pentiumii/manuals/243191.htm)

jkchong 的帖子[以获得更多介绍性文字](http://www.drpaulcarter.com/pcasm/)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-19T03:10:31.127

在线资源：

[PC 汇编语言](http://www.drpaulcarter.com/pcasm/)

[汇编语言编程艺术](http://webster.cs.ucr.edu/AoA/index.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-19T03:09:29.773

如果您只需要了解每条指令的作用，IA-32 (x86) 和 IA64 指令集的参考手册位于[此处](http://www.intel.com/content/www/us/en/processors/architectures-software-developer-manuals.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-19T03:06:52.803

[Dunteman 的“Assembly Language Step by Step”](https://rads.stackoverflow.com/amzn/click/com/0471375233)是 x86 汇编的一个很好的起点。

我确信网上有很好的教程网站，但我对它们并不熟悉。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-19T03:21:04.897

当我在学校学习时（早在 1900 年代），我们使用[IBM PC](https://rads.stackoverflow.com/amzn/click/com/0030095425)和[汇编语言逐步进行微型计算机实验。](https://rads.stackoverflow.com/amzn/click/com/0471578142)两本都是不错的入门书。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-12T19:26:48.917

还有两个很棒的关于 Windows 上 x86 汇编编程的社区：

*   [作为community.net](http://www.asmcommunity.net/board/)
*   [masmforum.com](http://www.masm32.com/board/index.php?)

如果您对 Visual Studio 和 MS 汇编器 (masm) 特别感兴趣，您将需要查看[masmforum.com](http://www.masm32.com/board/index.php?)。

# iphone - Instruments (ObjectAlloc/Leaks) 是否需要模拟器？

> ID：379983
> 
> 赞同：3
> 
> 时间：2008-12-19T02:49:48.547
> 
> 标签：iphone, objective-c, cocoa-touch, instruments

这可能是一个非常愚蠢的问题，所以我提前道歉。似乎 Instruments 仅在使用 iPhone Simulator 时对我有用。将应用程序绑定到 iPhone 时，它​​有什么特别之处吗？或者这甚至可能吗？我通过 Run->Start with performace 工具等以正常方式启动应用程序，然后看到它正在将应用程序安装到我配置的 iPhone，然后它启动 Instruments 但什么也没有。我想既然它是通过 USB 连接的，它会但不能让它工作。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-12-19T14:47:37.020

执行以下步骤后，我的设备与 Instruments 一起使用：

1.  拔下 iPhone。
2.  在 XCode 中，打开管理器。
3.  删除设备。
4.  插入设备。
5.  当被问及是否要使用设备进行开发时，回答是。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-19T06:23:46.120

首先启动 Instruments，而您的 iPhone 已经绑定。选择您想要的，然后从弹出菜单中选择应用程序并“记录”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-19T06:45:11.990

通过 XCode 在 iPhone 上以调试模式运行应用程序。您无法在 Instruments 中监控直接在设备上运行的应用程序。将您的设备连接到您的 Mac，选择 Device 作为目标而不是 Simulator，然后在 Run 菜单中选择“Start with Performance Tool”

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-12-19T03:46:01.947

它适用于设备，在 XCode 中，转到顶部栏，我认为它在“构建”内（我面前没有 mac，所以对于模糊的位置很抱歉）在那里你选择“使用性能工具运行应用程序"（类似的东西），这将启动一个连接到硬件的新 Instruments 会话。你不能（据我所知）直接从 Instruments 连接到设备，它需要通过 XCode。

# c++ - (C++) 需要数据库方面的帮助

> ID：379988
> 
> 赞同：0
> 
> 时间：2008-12-19T02:54:39.413
> 
> 标签：c++, database, string, inheritance, char

我正在尝试创建一个数据库，到目前为止，我一直在使用字符串将我的条目从一个文本文件存储到一个数组中，但这只是行不通。于是，我开始思考一种新的做法。

我想做的事：

假设我有一个包含以下数据库的文本文件......

约翰·史密斯 00001 jsmith@email pw1

Rob Deniro 00002 rdeniro@email pw2

阿尔·帕西诺 00003 apacino@email pw3

乔·佩西 00004 jpesci@email 307 pw4

Joaq Phoenix 00005 jphoe@email 208 pw5

约翰·马登 00006 jmadden@email 708 pw6

好吧，所以基本上我所坚持的就是让这种“继承”变得友好。存储每个条目的最佳方法是什么？单个字符串？我一直认为最好的方法是存储每个单独的字符，直到出现空格，然后将其存储到一个字符串中，但我不确定如何做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-19T03:18:26.057

正如TomWij所说，你先做ifstream然后strtok，但我建议你用“”转义你的字符串，而不仅仅是空格，这样你就可以存储“这样的东西，例如关于用户的注释”，这就是它的完成方式使用 CSV（逗号分隔值）。

```
#include <iostream>
#include <string>
#include <fstream>
#include <sstream>
#include <vector>
using namespace std;

void readCSV(std::istream &input, std::vector< std::vector<std::string> > &output)
{
    std::string csvLine;
    // read every line from the stream
    while( std::getline(input, csvLine) )
    {
        std::istringstream csvStream(csvLine);
        std::vector<std::string> csvColumn;
        std::string csvElement;
        // read every element from the line that is seperated by commas
        // and put it into the vector or strings
        while( std::getline(csvStream, csvElement, ',') )
        {
            csvColumn.push_back(csvElement);
        }       
        output.push_back(csvColumn);
    }
}

int main()
{
    std::fstream file("file.csv", ios::in);
    if(!file.is_open())
    {
        std::cout << "File not found!\n";
        return 1;
    }
    // typedef to save typing for the following object
    typedef std::vector< std::vector<std::string> > csvVector;
    csvVector csvData;

    readCSV(file, csvData);
    // print out read data to prove reading worked
    for(csvVector::iterator i = csvData.begin(); i != csvData.end(); ++i)
    {
        for(std::vector<std::string>::iterator j = i->begin(); j != i->end(); ++j)
        {
            std::cout << *j << ", ";
        }
        std::cout << "\n";
    }
} 
```

这让我想到了真正的解决方案，为什么不使用[CSV 模块](http://www.ioplex.com/~miallen/libmba/dl/src/csv.c)或更好的 CSV 库，[SQLite](http://www.sqlite.org/)，SQLite 非常易于安装和使用，而且它比手动编写数据库更好，除了它应该将[SQLite](http://www.sqlite.org/)加入您的代码库不会花费您超过 1 小时，因为它的 API 非常简单。

```
#include <stdio.h>
#include <sqlite3.h>

static int callback(void *NotUsed, int argc, char **argv, char **azColName){
  int i;
  for(i=0; i<argc; i++){
    printf("%s = %s\n", azColName[i], argv[i] ? argv[i] : "NULL");
  }
  printf("\n");
  return 0;
}

int main(int argc, char **argv){
  sqlite3 *db;
  char *zErrMsg = 0;
  int rc;

  if( argc!=3 ){
    fprintf(stderr, "Usage: %s DATABASE SQL-STATEMENT\n", argv[0]);
    exit(1);
  }
  rc = sqlite3_open(argv[1], &db);
  if( rc ){
    fprintf(stderr, "Can't open database: %s\n", sqlite3_errmsg(db));
    sqlite3_close(db);
    exit(1);
  }
  rc = sqlite3_exec(db, argv[2], callback, 0, &zErrMsg);
  if( rc!=SQLITE_OK ){
    fprintf(stderr, "SQL error: %s\n", zErrMsg);
    sqlite3_free(zErrMsg);
  }
  sqlite3_close(db);
  return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-19T03:16:25.687

通常，术语“数据库”保留为关系数据库的标准概念，例如 MySQL、MS SQL Server、Oracle 等

所以这引出了一个问题，为什么不使用标准的关系数据库？

您可能想尝试查找[TinySQL](http://www.jepstone.net/tinySQL/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-19T03:07:28.077

一次读取一行，[`ifstream`](http://www.cplusplus.com/reference/iostream/ifstream/)然后使用[`strtok`](http://www.cplusplus.com/reference/clibrary/cstring/strtok.html)分割每一行，使用空格作为分隔符。您应该使用`string`except 数值，如果您需要支持大值，您可以将其保存为 an`int`或 a 。`long`如果您想要安全，以加密方式存储密码也是更明智的做法。

出于各种原因，您可能希望寻找另一种解决方案来存储数据而不是纯文本：空间、性能、安全性……尝试使用二进制数据库文件可能是个好主意。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-21T21:27:55.590

```
 #include<iostream>
 #include<conio.h>
 #include<fstream>
 using namespace std;

int main(int argc, char *argv[])

  {

     char Name[100];

     char FTE[100];
      cout<<"What is the file name?\n";
      cin>>FTE;

   ifstream myfile (FTE);     

   while(1)
    {

    myfile.getline(Name, 30, '|');
    cout<<line;
   cin.ignore();

 }
  } 
```

所有这一切都是读取由“|”分隔的所有文本条目 特点。适合在 C++ 和其他使用相同方法的情况下制作平面文件数据库。

# python - 你如何制作一个不是标准数据类型的类属性？

> ID：379995
> 
> 赞同：0
> 
> 时间：2008-12-19T03:03:34.230
> 
> 标签：python, pygame

我有一个类需要获取另一个设置的属性。虽然它不是标准数据类型。这是代码；

```
class graphics:
def __init__(self, Fullscreen = False, Width = 640, Height = 480):
    print "Graphics Init"
    SCREEN_SIZE = (Width, Height)
    pygame.init()
    if Fullscreen:
        self.screen = pygame.display.set_mode(SCREEN_SIZE, FULLSCREEN, 32)
        print "Fullscreen Initialized"
    else:
        self.screen = pygame.display.set_mode(SCREEN_SIZE, 0, 32)
        print "Non-Fullscreen Initialized" 
```

我需要做的是引用屏幕属性，我可以用 self.screen 设置它并在该类中可读......但是我必须从另一个类中设置

```
screen = ? 
```

在下面

```
class graphics: 
```

这个问号需要是什么？我试过 0, None, "" ...似乎没有任何效果，我不知道 pygame 调用的数据类型是什么。:S

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-19T11:01:06.467

我认为对 Python 中类和实例属性之间区别的简短解释可能对您有所帮助。

当您编写这样的代码时：

```
class Graphics:
    screen_size = (1024, 768) 
```

类`Graphics`实际上是一个对象本身——一个类对象。因为你`screen_size`在它里面定义的，`screen_size`是`Graphics`对象的一个​​属性。您可以在以下内容中看到这一点：

```
assert Graphics.screen_size == (1024, 768) 
```

在 Python 中，这些类对象可以像函数一样使用——只需使用调用语法：

```
g = Graphics() 
```

`g`被称为类的“实例” `Graphics`。当您创建一个类的实例时，所有与该实例的属性不匹配的属性查找接下来都会查看该类对象的属性。这就是此查找有效的原因：

```
assert g.screen_size == (1024, 768) 
```

*但是，如果我们向实例*添加同名的属性，则对实例的查找将成功，并且不必查找类对象。您基本上使用直接在实例上设置的值“屏蔽”类对象的值。请注意，这*不会*更改类对象中属性的值：

```
g.screen_size = (1400, 1050)
assert g.screen_size == (1400, 1050)
assert Graphics.screen_size == (1024, 768) 
```

因此，您在`__init__`方法中所做的*正是*我们上面所做的：设置*实例*的属性，`self`.

```
class Graphics:

    screen_size = (1024, 768)

    def __init__(self):
        self.screen_size = (1400, 1050)

g = Graphics()
assert Graphics.screen_size == (1024, 768)
assert g.screen_size == (1400, 1050) 
```

该值`Graphics.screen_size`可以在此类定义之后的任何地方使用，如上面代码片段中的第一个断言语句所示。

编辑：不要忘记查看[Python 教程中关于 classes 的部分](http://docs.python.org/tutorial/classes.html)，它涵盖了所有这些以及更多内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-19T03:09:01.613

这可能是一种`object`类型

```
self.screen = object() 
```

可能有效（如果我正确理解了您的问题）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-19T03:22:25.580

呃...PEBKAC。

我已经习惯了 C，以至于我一直忘记你可以做的不仅仅是在 defs 之外做原型。

重写为这样，它的工作原理：

```
class graphics:
SCREEN_SIZE = (640, 480)
screen = pygame.display.set_mode(SCREEN_SIZE, 0, 32)
def __init__(self, Fullscreen = False, Width = 640, Height = 480):
    print "Graphics Init"
    self.SCREEN_SIZE = (Width, Height)
    pygame.init()
    if Fullscreen:
        self.screen = pygame.display.set_mode(SCREEN_SIZE, FULLSCREEN, 32)
        print "Fullscreen Initialized"
    else:
        self.screen = pygame.display.set_mode(SCREEN_SIZE, 0, 32)
        print "Non-Fullscreen Initialized" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-19T03:28:48.360

您很少（如果有的话）引用类的属性。您引用对象的属性。

（另外，类名应该是大写的：）`Graphics`。

```
class Graphics:
SCREEN_SIZE = (640, 480)
def __init__(self, Fullscreen = False, Width = 640, Height = 480):
    print "Graphics Init"
    self.SCREEN_SIZE = (Width, Height)
    pygame.init()
    if Fullscreen:
        self.screen = pygame.display.set_mode(SCREEN_SIZE, FULLSCREEN, 32)
        print "Fullscreen Initialized"
    else:
        self.screen = pygame.display.set_mode(SCREEN_SIZE, 0, 32)
        print "Non-Fullscreen Initialized" 
```

这是获取或设置对象属性的示例。

```
g= Graphics() # create an object
# access the object's instance variables
print "screen", g.screen
g.screen= pygame.display.set_mode(SCREEN_SIZE, FULLSCREEN, 32) 
```

请注意，我们`g`从类 ( ) 创建了一个对象 ( `Graphics`)。我们根本不经常引用该类。几乎唯一一次使用类名是创建对象实例 ( `Graphics()`)。我们很少说`Graphics.this`或`Graphics.that`提及类本身的属性。***````***