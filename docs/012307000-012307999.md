# StackOverflow 问答 12307000-12307999

# cakephp - Cakephp：仅插入后的afterSave（）？

> ID：12307002
> 
> 赞同：4
> 
> 时间：2012-09-06T19:25:37.667
> 
> 标签：cakephp

我想检测是否在 afterSave() 中插入了新记录或更新了旧记录，但我不知道如何。

我曾考虑在 beforeSave() 中编写一个配置变量（如果未设置 id，我可以在其中检测到插入）但也许这不是一种安全的方法。

有任何想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-06T19:41:10.077

您可以使用***[afterSave( $model, $created )](http://api20.cakephp.org/class/model-behavior#method-ModelBehaviorafterSave)***函数来完成。

因为，该函数的***第二个参数***`afterSave()`是`Boolean`并且`true`如果***创建了一个新行***，它将为您提供`false`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-03-28T10:41:26.023

您可以通过在此处编写以下代码行来检查这一点：

```
public function afterSave(Event $event, Entity $entity, array $options) {
    if ($entity->isNew()) {
        // do whatever you need to do here.
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-23T13:06:07.307

传递 id（当记录更新时）并在 saveall 或 save 之后立即保存它也可以提供帮助。例如; $this->set('id', $this->MyModule->id);

# iphone - iOS 辅助语言本地化

> ID：12307008
> 
> 赞同：0
> 
> 时间：2012-09-06T19:26:13.813
> 
> 标签：iphone, objective-c, ios, xcode, cocoa-touch

我正确设置了 es（西班牙语）、en（英语）和 ca（加泰罗尼亚语）的本地化。西班牙语和英语是主要的，而次要的就像 es-xx 和 en-xx。加泰罗尼亚语是具有 es-ca 代码的辅助语言。问题是，如果我使用 en-us 启动应用程序，则会调用 en.lproj 资源，因为 en-us 不存在。到目前为止都很好，但是，如果我删除加泰罗尼亚语本地化，应该做同样的事情并加载主要的，es。但是，不加载它并加载默认值（en）。我错过了什么？谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T01:19:07.573

我不确定您是否以正确的方式建模问题。

删除加泰罗尼亚语的问题（不确定为什么要删除本地化）是否会回到西班牙语正确？我假设巴塞罗那和说加泰罗尼亚语的人也会说西班牙语，但改变这些用户的语言感觉不对。

在我的应用程序中，我提供英语（英国、美国）、法语、日语和西班牙语。在启动时，我得到用户的首选语言环境并使用 NSDictionary 将它们映射到最合适的匹配项，如果没有找到匹配项，我会回退到美国英语。例如，如果你住在南非，最接近的英语是英国英语，但如果你住在菲律宾，美国英语更合适。

不幸的是，加泰罗尼亚语用户将退回到英语，但在下一个版本中，我将让用户从支持的语言列表中指定他们的首选语言，以便他们将来可以退回到西班牙语。

尝试使用 NSDictionary 将用户的区域设置映射到您应用的可用语言，看看它是否能解决您的问题。希望这可以帮助！

# ios - 更新可变数组

> ID：12307015
> 
> 赞同：0
> 
> 时间：2012-09-06T19:26:33.083
> 
> 标签：ios, nsmutablearray, uitableview

我在 Tableview 中有一个可变数组，这是在 View 上填充的，确实从 SQLite 数据库加载，但是这个数据库发生了变化，因为它是我的应用程序中产品的收藏夹数据库。当用户选择表视图中的一个项目（然后用户转到详细视图，使用数据库中的信息）时，用户可以选择将其从收藏夹（数据库）中删除，然后用户再按回导航栏，该项目仍然存在，我试过 tableview reload on view 确实出现了，视图会出现，但这没有帮助，

任何人都可以对此有所了解吗？

非常感谢，安德鲁

这是我的代码：FavTableViewController.h：

```
@interface FavTableViewController : UIViewController <UITableViewDelegate, UITableViewDataSource> {
IBOutlet UITableView *Table; 
}
@property (nonatomic, strong) UITableView *Table;
@property (nonatomic, strong) NSArray *cats;
@property (nonatomic, strong) IBOutlet UISearchBar *searchBar;
@property (nonatomic, strong) UISearchDisplayController *searchDisplayController;
@property (nonatomic, strong) NSMutableArray *filteredListContent;
@property (nonatomic, strong) NSMutableArray *listContent;
@property (nonatomic, strong) NSArray *everything;
@property (nonatomic, copy) NSString *savedSearchTerm;
@property (nonatomic) NSInteger savedScopeButtonIndex;
@property (nonatomic) BOOL searchWasActive;
@property (nonatomic, strong) NSString *cellText;
-(void) refresh;
@end 
```

FavTableViewController.m:

```
#import "FavTableViewController.h"
#import "DBFavAdapter.h"
#import "MenuData.h"
#import "DBAdapter.h"
#import "DetailViewController.h"
#import "ConsoleDetailController.h"
#import "EffectDetailViewController.h"
#import "DimmersDetailController.h"
#import "ConventionalController.h"
#import "ProDetailViewController.h"

@implementation FavTableViewController

@synthesize filteredListContent, savedSearchTerm, savedScopeButtonIndex, searchWasActive, searchBar, searchDisplayController, listContent, everything, cellText, cats, Table;

-(id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil {
self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
if (self) {
    listContent = [[NSMutableArray alloc] init];
}
return self;
}

- (void)didReceiveMemoryWarning {
// Releases the view if it doesn't have a superview.
[super didReceiveMemoryWarning];
// Release any cached data, images, etc that aren't in use.
}

#pragma mark - View lifecycle

- (void)viewDidLoad {
NSLog(@"Did Load");
[super viewDidLoad];

everything = [[DBFavAdapter allProducts] mutableCopy];
for (NSDictionary *dict in everything) {
    [listContent addObject: [dict objectForKey:@"Title"]];
}

// create a filtered list that will contain products for the search results table.

self.filteredListContent = [NSMutableArray arrayWithCapacity:[self.listContent count]];

// restore search settings if they were saved in didReceiveMemoryWarning.
if (self.savedSearchTerm)
{
    [self.searchDisplayController setActive:self.searchWasActive];
    [self.searchDisplayController.searchBar setSelectedScopeButtonIndex:self.savedScopeButtonIndex];
    [self.searchDisplayController.searchBar setText:savedSearchTerm];

    self.savedSearchTerm = nil;
}
//  [self.tableView reloadData];
self.Table.scrollEnabled = YES;
self.navigationItem.title = @"Favourites";
//  cats = [DBFavAdapter allCategories];
}

- (void)viewDidUnload {
[super viewDidUnload];
// Release any retained subviews of the main view.
// e.g. self.myOutlet = nil;
self.filteredListContent = nil;
NSLog(@"Unload");
}

- (void)viewWillAppear:(BOOL)animated {
NSLog(@"View will Appear");

[Table reloadData];
NSLog(@"Everything: %@",everything);
NSLog(@"list Content: %@",listContent);
[super viewWillAppear:animated];  
}

- (void)viewDidAppear:(BOOL)animated {
NSLog(@"View did Appear");
[super viewDidAppear:animated];
NSLog(@"list Content appeared: %@",listContent);
[Table reloadData];
}

- (void)viewWillDisappear:(BOOL)animated {
[super viewWillDisappear:animated];
}

- (void)viewDidDisappear:(BOOL)animated {
[super viewDidDisappear:animated];
NSLog(@"Did dissapear");
// save the state of the search UI so that it can be restored if the view is re-created
self.searchWasActive = [self.searchDisplayController isActive];
self.savedSearchTerm = [self.searchDisplayController.searchBar text];
self.savedScopeButtonIndex = [self.searchDisplayController.searchBar selectedScopeButtonIndex];
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
// Return YES for supported orientations
return (interfaceOrientation == UIInterfaceOrientationPortrait);
}

#pragma mark - Table view data source

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView {
return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
if(tableView == self.searchDisplayController.searchResultsTableView){
    return [self.filteredListContent count];
}
else {
    return [self.listContent count];
}
NSLog(@"Rows %i",[self.listContent count]);
}

- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath {    
//    NSDictionary *dictionary = [self.tableDataSource objectAtIndex:indexPath.row];
if (tableView == searchDisplayController.searchResultsTableView)
{
    cellText = [self.filteredListContent objectAtIndex:indexPath.row];
}
else
{
    cellText = [self.listContent objectAtIndex:indexPath.row];
}

// NSString *cellText = [self.listContent objectAtIndex:indexPath.row];
UIFont *cellFont = [UIFont fontWithName:@"Heiti TC" size:17.0];
CGSize constraintSize = CGSizeMake(280.0f, MAXFLOAT);
CGSize labelSize = [cellText sizeWithFont:cellFont constrainedToSize:constraintSize lineBreakMode:UILineBreakModeWordWrap];

return labelSize.height + 30;
}
- (NSInteger)tableView:(UITableView *)tableView indentationLevelForRowAtIndexPath:(NSIndexPath *)indexPath {
NSUInteger row = 1;
return row;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
static NSString *CellIdentifier = @"Cell";

UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
if (cell == nil) {
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    cell.textLabel.lineBreakMode = UILineBreakModeWordWrap;
    cell.textLabel.numberOfLines = 0;
    cell.textLabel.font = [UIFont fontWithName:@"Heiti TC" size:17.0];
}

// Configure the cell...
if (tableView == searchDisplayController.searchResultsTableView)
{
    cell.textLabel.text = [self.filteredListContent objectAtIndex:indexPath.row];
}
else
{
    cell.textLabel.text = [self.listContent objectAtIndex:indexPath.row];
}

return cell;
}

#pragma mark - Table view delegate

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
NSString *selectedItem;

if (tableView == self.searchDisplayController.searchResultsTableView)
{
    selectedItem = [self.filteredListContent objectAtIndex:indexPath.row];
}
else
{
    selectedItem = [self.listContent objectAtIndex:indexPath.row];
}

// Is the selection a category?
//    NSArray *cats = [DBAdapter allCategories];
__block BOOL cat = NO;
[cats enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) {
    if ([(NSString*)obj isEqualToString:selectedItem]) {
        cat = YES;
        *stop = YES;
    }
}];

if (cat) { // the user's selection was a category
//      NSLog(@"Selected item was a category");
}
else {
    NSArray *mans = [DBAdapter allManufacturers];
    __block BOOL man = NO;
    [mans enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) {
        if ([(NSString*)obj isEqualToString:selectedItem]) {
            man = YES;
            *stop = YES;
        }
    }];
    if (man) { // the user's selection was a manufacturer
//        NSLog(@"Selected item was a manufacturer");
    } else {
        // the user's selection was a product

        // Find selectedItem in products
        __block NSDictionary *selectedRow = nil;
        [self.everything enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop)
{
            //everything is an array of dictionaries 
            if ([(NSString*)[(NSDictionary*)obj objectForKey:@"Title"] isEqualToString:selectedItem]) {
                selectedRow = (NSDictionary*)obj;
                *stop = YES;
            }
        }];

        MenuData *selectionData =  [MenuData menuData];
        selectionData.manufacturerID = [[selectedRow objectForKey:@"Manufacturer_id"] integerValue];
        selectionData.categoryID = [[selectedRow objectForKey:@"Category_id"] integerValue];
        selectionData.sCategoryID = [[selectedRow objectForKey:@"SubCategory_id"] integerValue];
        selectionData.ssCategoryID = [[selectedRow objectForKey:@"SuperSubCategory_id"] integerValue];

        NSString *selectedTitle = [selectedRow objectForKey: @"Title"];  // You probably already have this value from your search. Here for the sake of clarity.

        NSDictionary *productDetails = [DBAdapter productDetails: selectedTitle forCurrentData: selectionData];

        NSArray *allKeys = [productDetails allKeys];
//        NSLog(@"values: %i", [allKeys count]);
        for (NSString *key in allKeys) {
            id value = [productDetails objectForKey:key];
            if ([value isKindOfClass:[NSString class]]) {
          //      NSLog(@"key: %@  value: %@", key, value); 
            }
        }

        NSInteger ViewNumber = [[productDetails objectForKey:@"View"] integerValue];
        switch (ViewNumber) {
            case 25: {
                DetailViewController *dvController = [[DetailViewController alloc] initWithNibName:@"DetailView" bundle:[NSBundle mainBundle]];
                dvController.dictionary = productDetails;
                [self.navigationController pushViewController:dvController animated:YES];
            }
                break;
            case 18: {
                EffectDetailViewController *edvController = [[EffectDetailViewController alloc] initWithNibName:@"EffectDetailView" bundle:[NSBundle mainBundle]];
                edvController.dictionary = productDetails;
                [self.navigationController pushViewController:edvController animated:YES];
            }
                break;
            case 17: {
                ConsoleDetailController *cdvController = [[ConsoleDetailController alloc] initWithNibName:@"ConsoleDetailController" bundle:[NSBundle mainBundle]];
                cdvController.dictionary = productDetails;
                [self.navigationController pushViewController:cdvController animated:YES];
            }
                break;
            case 2: {
                ConsoleDetailController *cdvController = [[ConsoleDetailController alloc] initWithNibName:@"ConsoleDetailController" bundle:[NSBundle mainBundle]];
                cdvController.dictionary = productDetails;
                [self.navigationController pushViewController:cdvController animated:YES];
            }
                break;
            case 3: {
                DimmersDetailController *ddvController = [[DimmersDetailController alloc] initWithNibName:@"DimmersDetailController" bundle:[NSBundle mainBundle]];
                ddvController.dictionary = productDetails;
                [self.navigationController pushViewController:ddvController animated:YES];
            }
                break;
            case 12: {
                ConventionalController *cController = [[ConventionalController alloc] initWithNibName:@"ConventionalController" bundle:[NSBundle mainBundle]];
                cController.dictionary = productDetails;
                [self.navigationController pushViewController:cController animated:YES];
            }
                break;
            case 5: {
                ProDetailViewController *pController = [[ProDetailViewController alloc] initWithNibName:@"ProDetailViewController" bundle:[NSBundle mainBundle]];
                pController.dictionary = productDetails;
                [self.navigationController pushViewController:pController animated:YES];
            }
                break;

        }

    }
}

}

#pragma mark -
#pragma mark Content Filtering

- (void)filterContentForSearchText:(NSString*)searchText scope:(NSString*)scope {
/*
 Update the filtered array based on the search text and scope.
 */

[self.filteredListContent removeAllObjects]; // First clear the filtered array.

/*
 Search the main list for products whose type matches the scope (if selected) and whose name matches searchText; add items that match to the filtered array.
 */
for (NSString *product in listContent)
{
    //Edit AD - NS Range works instead of NSComparisonResult
    NSRange result = [product rangeOfString:searchText options:(NSCaseInsensitiveSearch|NSDiacriticInsensitiveSearch)];
    if (result.location != NSNotFound)
    {
        [self.filteredListContent addObject:product];
    }
    /*
     //  NSComparisonResult result = [product compare:searchText options:(NSCaseInsensitiveSearch|NSDiacriticInsensitiveSearch) range:NSMakeRange(0, [searchText length])];
     if (result == NSOrderedSame)
     {
     [self.filteredListContent addObject:product];
     }
     */
}
}

#pragma mark -
#pragma mark UISearchDisplayController Delegate Methods

- (BOOL)searchDisplayController:(UISearchDisplayController *)controller shouldReloadTableForSearchString:(NSString *)searchString {
[self filterContentForSearchText:searchString scope:
 [[self.searchDisplayController.searchBar scopeButtonTitles] objectAtIndex:[self.searchDisplayController.searchBar selectedScopeButtonIndex]]];

// Return YES to cause the search result table view to be reloaded.
return YES;
}

- (BOOL)searchDisplayController:(UISearchDisplayController *)controller shouldReloadTableForSearchScope:(NSInteger)searchOption {
[self filterContentForSearchText:[self.searchDisplayController.searchBar text] scope:
 [[self.searchDisplayController.searchBar scopeButtonTitles] objectAtIndex:searchOption]];

// Return YES to cause the search result table view to be reloaded.
return YES;
}

- (void)refresh {
NSLog(@"Refresh");
if([NSThread isMainThread])
{
    [self.Table reloadData];
    [self.Table setNeedsLayout];
    [self.Table setNeedsDisplay];
}
else
{
    [self performSelectorOnMainThread:@selector(refresh) withObject:nil waitUntilDone:YES];
}
}

@end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T19:42:59.060

您有 2 个选项。

1.  也从 中删除该项目`listContent`。这可以通过`delegate`删除项目时从子视图控制器调用的方法来完成。
2.  将您的`viewDidLoad`功能`listContents`从数据库生成的位置移动到`viewWillAppear`. 这将导致`listContents`再次读取数据库，在项目被删除并点击后退按钮后，这也会在视图首次打开时被调用。

# java - 使用 iOS iPad2 连接并登录运行 HTTP 服务的 Java 服务器

> ID：12307016
> 
> 赞同：0
> 
> 时间：2012-09-06T19:26:42.007
> 
> 标签：java, ios, xcode, dns, bonjour

我正在使用 Xcode 4.4.1 为 iPad2 编写 iOS 5.1.1 应用程序。我希望能够找到在 Java 上运行的本地 http 服务器。

一旦我能够连接到 http 服务器，我只需要与它通信的 url 包括端口。

**我的问题：**

1) 我应该使用 Bonjour 还是运行在 http 服务器上的 DNS 服务器来发现 http 服务器本身？

2）一旦我发现它，我需要使用名称和密码验证 iPad2 用户才能使用 http 服务器。

我需要一些帮助来了解如何完成这两个步骤，包括源代码（如果适用于 iOS 5 和 Xcode 4.4.1）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T01:30:57.947

1) Bonjour 很容易与 Java 应用程序配合使用。如果你特别自虐，你可以编写自己的基于 Java 的 mDNS (Bonjour) 响应程序（我已经做到了，这不是火箭科学），但最快的方法是在你的 http 服务器中使用[jMDNS](https://github.com/quelgar/jmdns)来宣传它存在。我不会复制和粘贴代码示例，但它们对于大多数应用程序来说已经足够了。

在 iOS 端，[NSNetService](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSNetService_Class/Reference/Reference.html)是你的朋友。从根本上说，它涉及在后台启动响应程序以查找服务（即您的 Java 应用程序），然后在出现/消失时调用委托：

```
id delegateObject; // Assume this exists.
NSNetServiceBrowser *serviceBrowser;

serviceBrowser = [[NSNetServiceBrowser alloc] init];
[serviceBrowser setDelegate:delegateObject];
[serviceBrowser searchForServicesOfType:@"_http._tcp" inDomain:@""]; 
```

有一个[指南](https://developer.apple.com/library/mac/#documentation/networking/Conceptual/NSNetServiceProgGuide/Introduction.html#//apple_ref/doc/uid/TP40002520-SW2)可以解释这一切。该协议已经 10 多年没有改变，您指望所有支持它的现代 iOS/OS X 版本。jMDNS 库在这个阶段也经过了很好的实战测试。

如果您不希望搜索 的其他应用程序可以看到它，您可以考虑创建自己的服务类型`_http._tcp.`，尽管这只是一个装饰性的东西。

2) 最简单的方法是 HTTP 基本身份验证；您没有说明您的应用程序支持哪种身份验证或如何在客户端发出 HTTP 请求，但这已经[很好](http://objective-d.com/?page_id=160)地[涵盖](https://github.com/pokeb/asi-http-request)了。

# sql - 从当前值重新设置 SQL 自动增量

> ID：12307023
> 
> 赞同：1
> 
> 时间：2012-09-06T19:27:31.740
> 
> 标签：sql, sql-server

我正在尝试从 SQL 中表的当前自动增量值重新设置自动增量值。我做了类似的事情

```
USE [MyDatabase]
GO

SELECT IDENT_CURRENT('MyTable') AS Current_Identity
DBCC CHECKIDENT (MyTable, reseed, Current_Identity) 
```

我收到以下错误：

```
(1 row(s) affected)
Msg 2560, Level 16, State 9, Line 3
Parameter 3 is incorrect for this DBCC statement. 
```

知道出了什么问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T19:37:56.507

在 SQL Server 中，您可以将`IDENT_CURRENT`值保存在变量中，如下所示：

```
DECLARE @currentIdentity INT;
SELECT @currentIdentity = IDENT_CURRENT('MyTable');
DBCC CHECKIDENT (MyTable, reseed, @currentIdentity); 
```

要回答您的问题，您的问题是 Current_Identity 是列的别名，但您没有将其存储在任何地方。这意味着您进行的下一次调用`DBCC CHECKIDENT`无法引用上一个查询中的列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-18T15:13:45.733

If you run the following code on a table that never had a record in it, you will the following error :

> Parameter 3 is incorrect for this DBCC statement

```
DECLARE @max_id INT
SELECT @max_id = MAX(ID)+1 FROM testt; 
DBCC CHECKIDENT('Tablename',RESEED,@max_id); 
```

The reason is that `@max_id` is NULL in this case and you can't pass it.

Here is what I would do. I would check the value returned to make sure it's not NULL. Hope this helps

```
DECLARE @max_id INT, @var int
SELECT @max_id = MAX(ID)+1 FROM TABLENAME; 
IF @max_id IS NULL 
BEGIN
SELECT@var = 1 
END
ELSE
BEGIN 
SELECT @var = @max_id
END
DBCC CHECKIDENT('TABLENAME,RESEED,@var); 
```

# ios - 在ios中设置定时器

> ID：12307028
> 
> 赞同：1
> 
> 时间：2012-09-06T19:27:51.507
> 
> 标签：ios, timer, location, schedule

我有一个在后台运行的应用程序，我想在进入后台模式 30 分钟后停止所有定位服务。

所以在我的后台功能中，我这样做：

```
// 1800 sec = 30 min * 60 sec.
NSDate *date30min = [[NSDate alloc] initWithTimeIntervalSinceNow:1800.0];
NSLog(@"Date30min : %@", date30min);

self.timer = [[NSTimer alloc] initWithFireDate:date30min interval:1 target:self selector:@selector(stopLocation) userInfo:nil repeats:NO]; 
```

我的 stopLocation 函数是：

```
- (void)stopLocation
{
    NSLog(@"[My APP] [PASS INTO stopLocation]");
    [self.locationManager stopMonitoringSignificantLocationChanges];
    [self.locationManager stopUpdatingLocation];
    [self.locationManager stopUpdatingHeading];
} 
```

但是我的计时器从不调用该函数，请问我的错误是什么？（我的函数已正确实现到我的 .h 和 .m 文件中，我在后台函数中对此进行了测试。

请帮忙..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T21:32:34.123

忘记将计时器添加到运行循环（在这种情况下）不是问题。

`NSTimer`当您的应用程序进入后台时，对象不会触发。所以，如果你想在后台处理 30 分钟后做某事，我会使用另一种技术。

例如，稍后使用**后台任务**运行您的方法：`stopLocation`

```
- (void)applicationDidEnterBackground:(UIApplication *)application {       

    __block UIBackgroundTaskIdentifier bgTask = [application beginBackgroundTaskWithExpirationHandler: ^{
         NSLog(@" expiration handler!"); 
    }];

    dispatch_after(dispatch_time(DISPATCH_TIME_NOW, 30 * 60 * NSEC_PER_SEC), dispatch_get_current_queue(), ^{

         [self stopLocation];

         // we're done with this task now
         [application endBackgroundTask: bgTask]; 
         bgTask = UIBackgroundTaskInvalid;
    });
} 
```

当然，您还需要声明：

```
<key>UIBackgroundModes</key>
<array>
    <string>location</string>
</array> 
```

在您的 Info.plist 文件中，但我假设您已经弄清楚了。

# javascript - 变量在函数中定义但需要重新定义

> ID：12307035
> 
> 赞同：3
> 
> 时间：2012-09-06T19:28:26.170
> 
> 标签：javascript, jquery, jquery-mobile

我正在使用一个[JQuery 移动插件](https://github.com/commadelimited/autoComplete.js/blob/master/jqm.autoComplete-1.4.3.js)并且遇到了奇怪的问题。

如果我像下面这样使用它，它就可以工作。

```
 $("#mainPage").on("pageshow", function(e) {

        var availableTags = ['some', 'about', 'tags'];

        $("#searchField").autocomplete({
            target: $('#suggestions'),
            source: availableTags
        });
    }); 
```

但是，如果像下面这样使用它，它就不起作用。但是`cached`在函数中定义并正确显示了id。如果我`cached`在函数中重新定义它会再次起作用。谁能解释为什么？

```
 var cached = $("#searchField");

    $("#mainPage").on("pageshow", function(e) {

        var availableTags = ['some', 'about', 'tags'];

        //Alert says searchField
        alert(cached.attr('id'));

        //If I uncomment below line it works.
        //cached = $("#searchField");

        cached.autocomplete({
            target: $('#suggestions'),
            source: availableTags
        });
    }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T19:53:56.507

这似乎有效：http: [//jsfiddle.net/9uxtT/](http://jsfiddle.net/9uxtT/) 它与您的情况有何不同？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-06T19:40:15.747

这是第一个版本中的时间问题，当所有 jquery 模块都已加载且 DOM 完成时，您在 pageshow 之后搜索标签“#searchField”

在第二个版本中，每当加载 javascript 时，您都在搜索标记，如果 javascript 在同一文件的标题中，有时甚至可能找不到 #searchfield。

要完成答案：需要考虑到 JQuery 选择器返回对象而不是 DOM 元素检查此代码以查看您得到两个不同的对象：

```
 var cached = $("#searchField");
 cached.test = 1;
 $("#p2").on("pageshow", function(e) {
     var test2 = $("#searchField");
 test2.test =2; alert(cached.test +"!="+ test2.test);
 });​ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-06T19:45:22.420

`$("#searchField")`在函数外部调用它时未定义，这是第一次调用处理程序时缓存它的简单方法

```
var cached;

$("#mainPage").on("pageshow", function(e) {
    // This line will only call jQuery once
    cached = cached ||  $("#searchField");

    var availableTags = ['some', 'about', 'tags'];

    alert(cached.attr('id'));

    cached.autocomplete({
        target: $('#suggestions'),
        source: availableTags
    });
}); 
```

这是在没有全局变量的情况下如何使用自调用函数将该变量包装在闭包中的方法

```
$("#mainPage").on("pageshow", (function(){
    var cached;
    return function(e) {
        // This line will only call jQuery once
        cached = cached ||  $("#searchField");

        var availableTags = ['some', 'about', 'tags'];

        alert(cached.attr('id'));

        cached.autocomplete({
            target: $('#suggestions'),
            source: availableTags
        });
    }
})()); 
```

# java.util.scanner - 数学文本和过多标记的扫描仪问题

> ID：12307037
> 
> 赞同：1
> 
> 时间：2012-09-06T19:28:27.093
> 
> 标签：java.util.scanner, textinput

所以，我正在尝试制作一个基于文本的 Java 计算器，但扫描仪让我非常头疼。这是一个代码片段...

```
 Scanner input=new Scanner(in);
    while (input.hasNext()){
        System.out.print(input.next()+".");
    }
    System.out.print("\n"); 
```

我的输入是这样的：“1 + cake(3,4,6,10*30+sin(4)) * 3”，我的输出应该是这样的：“1.+.cake(3,4,6,10* 30+sin(4)).*.3."

扫描仪应该只标记空白，但这就是我得到的：“1.+.cake.(.3.,.4.,.6.,. *10..30.+.sin.(.4.)。 )..* 3."

出于某种原因，它删除了每个空格，但也分隔了每个单词、数字和标点符号！现在我做了一些功课，并使用 input.useDelimiter(String in) 尝试了各种分隔符。我使用的一些是：“\s”“\s+”“\s*”“\s*+”“[]”等等，但无济于事。我究竟做错了什么！？！？！？！？！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T08:29:06.660

尝试改用 StringTokenizer。

```
public class demo 
{
    public static void main(String args[])
    {
            StringTokenizer st = new StringTokenizer("1 + cake(3,4,6,10*30+sin(4)) * 3");
             while (st.hasMoreTokens()) 
             {
                 System.out.println(st.nextToken());
             }
    }
} 
```

# javascript - 如何根据页面其他地方的文本停止某些输入值？

> ID：12307046
> 
> 赞同：1
> 
> 时间：2012-09-06T19:29:03.147
> 
> 标签：javascript, greasemonkey, firefox2

我有一个运行完美的现有脚本！它是为**Firefox 2.x**和**Greasemonkey 0.8.x**编码的，我不能使用 jQuery！

***旧工作脚本：***

```
//--- Make sure this list of names is all uppercase.
var usersWhoCanSetPriority = ['JOHN', 'LUKE', 'JEFF', 'MAX', 'ANDY'];

var bDisablePrio    = true;
var tdNodes         = document.getElementsByTagName ("TD");
for (var J = tdNodes.length - 1;  J >= 0;  --J) {
    var tdNode      = tdNodes[J];
    if (tdNode.className == "user") {
        var userName        = tdNode.textContent.replace (
            /^(?:.|\n|\r)+\(User:\s+([^)]+)\)(?:.|\n|\r)+$/i, "$1"
        ).toUpperCase ();

        if (usersWhoCanSetPriority.indexOf (userName) > -1) {
            bDisablePrio    = false;
        }
    }
}

if (bDisablePrio) {
    var oldInput = document.getElementsByName ("prio");
    oldInput[0].setAttribute ("disabled", "disabled");
} 
```

1.  [**这是当用户不在**时它的外观/行为的小提琴`usersWhoCanSetPriority`](http://jsfiddle.net/WT9yZ/)。

2.  [这是用户拥有完全访问权限时它的外观/行为的一个小提琴](http://jsfiddle.net/WT9yZ/1/)。

***新脚本示例：***

现在，如果存在***目标***输入，特权用户应该能够设置任何值。
但是应该阻止非特权用户设置`12`和`22`.

1.  [特权用户，具有目标字段](http://jsfiddle.net/WT9yZ/2/)。

2.  [受限用户，带有目的地字段](http://jsfiddle.net/WT9yZ/3/)。

也就是说，如果用户**不是**-> 'JOHN', 'LUKE', 'JEFF', 'MAX', 'ANDY' (from footer) 然后禁用 prio 输入，并在用户输入“12”时**停止**输入或“22”，并写入错误消息。

您必须知道史蒂夫（“不允许的用户”）可以输入例如 120、121、220、222 和所有其他数字，但**不能**输入**12**和**22**！不知道是不是有问题，因为12也在120！'JOHN', 'LUKE', 'JEFF', 'MAX', 'ANDY' 允许在输入中输入**所有**数字。

旧脚本在 site-one.html 和 site-two.html 等不同页面上运行但是目标输入在 site-one.html 和 site-three.html 上 - 这意味着有时我只有 prio-input 有时我有prio-input和destination-input。

我该怎么做？

问候， 伯恩特

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T19:49:41.660

见[http://jsfiddle.net/WT9yZ/4/](http://jsfiddle.net/WT9yZ/4/)

你可以加

```
if(bDisablePrio){
    var destExcluded=['12','22'];
    document.getElementById('dest').onchange=function(){
        if(destExcluded.indexOf(this.value)>-1){
            this.value='';
        }
    }
} 
```

问题是如果`"122"`允许但`"12"`不允许，你不能使用`onkeypress`事件来防止用户写那个，因为如果用户不能写`"12"`，他也不能写`"122"`。

然后，解决方案是`onchange`事件，当文本字段失去焦点时触发（如果它已被修改）。然后，如果用户只写了`"12"`或`"22"`，您可以清除文本字段。​</p>

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T01:34:39.427

[用户 user1653020 的回答](https://stackoverflow.com/a/12307351/331508)很接近，但它有几个问题：

1.  它会在 Greasemonkey 0.8 中失败！请参阅[“陷阱 #2：事件处理程序”](http://commons.oreilly.com/wiki/index.php/Greasemonkey_Hacks/Getting_Started#Pitfall_.232:_Event_Handlers)。
2.  `destination`不存在时会崩溃。
3.  它不是很用户友好。（不让用户知道她做错了什么。）
4.  允许用户提交无效值。

转到[jsfiddle.net/P2VeG](http://jsfiddle.net/P2VeG/)，输入 12 作为目的地，然后按`Enter`或单击“提交”按钮。您会看到表单被发送到服务器，并且目标值无效，并且没有向用户发出警告！

下面的代码应该可以克服所有这些问题。（但出于显而易见的原因，它在 GM 0.8 和 FF2 中未经测试。）

[**请参阅 jsfiddle.net/P2VeG/2 上的实际代码**](http://jsfiddle.net/P2VeG/2/)。

```
//--- Make sure this list of names is all uppercase.
var usersWhoCanSetPriority  = ['JOHN', 'LUKE', 'JEFF', 'MAX', 'ANDY'];
var excludedDestinations    = ['12', '22'];

var bDisablePrio    = true;
var tdNodes         = document.getElementsByTagName ("TD");
for (var J = tdNodes.length - 1;  J >= 0;  --J) {
    var tdNode      = tdNodes[J];
    if (tdNode.className == "user") {
        var userName        = tdNode.textContent.replace (
            /^(?:.|\n|\r)+\(User:\s+([^)]+)\)(?:.|\n|\r)+$/i, "$1"
        ).toUpperCase ();
        if (usersWhoCanSetPriority.indexOf (userName) > -1) {
            bDisablePrio = false;
        }
    }
}

if (bDisablePrio) {
    var oldInput    = document.getElementsByName ("prio");
    if (oldInput  &&  oldInput.length) {
        oldInput[0].setAttribute ("disabled", "disabled");
    }

    var destInput   = document.getElementsByName ("dest");
    if (destInput  &&  destInput.length) {
        destInput[0].addEventListener (
            "change",
            function (zEvent) {
                bCheckdestinationValue (destInput[0]);
            },
            false
        );

        //--- Extra added to try and get FF2 to behave as later versions do.
        destInput[0].addEventListener (
            "keydown",
            function (zEvent) {
                if (zEvent.keyCode == 13) {
                    if ( bCheckdestinationValue (destInput[0]) ) {
                        zEvent.preventDefault ();
                        zEvent.stopPropagation ();
                        return false;
                    }
                }
            },
            true
        );

        destInput[0].form.addEventListener (
            "submit",
            function (zEvent) {
                var destValue   = destInput[0].value;
                if (    destValue === ''
                        ||  excludedDestinations.indexOf (destInput[0].value) > -1
                ) {
                    //--- Stop the submit
                    /*--- According to:
                        http://www.webdevout.net/browser-support-dom#dom2events
                        preventDefault() and stopPropagation() are supported by FF2
                    */
                    zEvent.preventDefault ();
                    zEvent.stopPropagation ();
                    return false;
                }
            },
            true
        );
    }
}

function bCheckdestinationValue (destInputNd) {
    //--- Returns true if value is bad.
    if (excludedDestinations.indexOf (destInputNd.value) > -1) {
        destInputNd.value = ''; // Blank input

        //--- Add or show Error message.
        var destErrNode = document.getElementById ("gmDestErrorDisp");
        if (destErrNode) {
            destErrNode.style.display = "inline";
        }
        else {
            destErrNode             = document.createElement ('b');
            destErrNode.id          = "gmDestErrorDisp";
            destErrNode.style.color = "red";
            destErrNode.textContent = "12 and 22 are forbidden";
            destInputNd.parentNode.appendChild (destErrNode);
        }
        //--- Uncomment this alert(), if all else fails in FF2.
        ////alert ('Destination cannot be 12 or 22.');
        return true;
    }
    else {
        var destErrNode = document.getElementById ("gmDestErrorDisp");
        if (destErrNode) {
            destErrNode.style.display = "none";
        }
    }
    return false;
} 
```

# java - 如何检查字符串的一部分是否等于android中的另一个字符串

> ID：12307050
> 
> 赞同：9
> 
> 时间：2012-09-06T19:29:09.323
> 
> 标签：java

如果一个字符串等于另一个字符串，我如何检查部分是否？例如，如果我有一个值为“hello”的字符串和一个值为“he”的字符串，我如何比较它们以检查“hello”是否包含“he”。

如果没有很好地解释，请告诉我，我会尽力澄清

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-06T19:30:18.620

`"Hello".toLowerCase().contains("He".toLowercase());`通过使用 String 类[contains()](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/String.html#contains%28java.lang.CharSequence%29)方法与 java 相同。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-06T19:31:12.470

有一个[`contains`](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#contains%28java.lang.CharSequence%29)方法`String`：

```
String str = "Hello";

if (str.toLowerCase().contains("he"))
    // ... 
```

还有一个[`startsWith`](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#startsWith%28java.lang.String%29)方法`String`：

```
if (str.toLowerCase().startsWith("he"))
    // ... 
```

如果两个字符串都是内容未知的变量，并且大小写不重要，则：

```
str.toLowerCase().contains(str2.toLowerCase()))
str.toLowerCase().startsWith(str2.toLowerCase())) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-06T19:30:47.840

试试 String.contains()。文档可以在[这里找到](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#contains%28java.lang.CharSequence%29)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-09-06T19:31:41.550

如果您不确定字符串的大小写，请将两者都转换为小写：

```
if("Hello".toLowerCase().indexOf("he".toLowerCase()) >= 0) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-06T19:52:28.080

```
string string1 = "yellow";
string string2 = "Hello";
boolean contains = false;

int length = string1.length();

for (int i=0; i < length; i++)
{
    for (int j=i+1; j < length; j++)
    {
        // Don't go beyond last letter for second part of substring
        if (j < length - 1)
        {
            string temp = string1.substring(i, j);
            contains == string2.contains(temp);
        }
    }
} 
```

# android - 尽管代码发生了变化，但我的 Android 应用程序没有在 Eclipse 中重新安装到我的 AVD 上？

> ID：12307052
> 
> 赞同：-1
> 
> 时间：2012-09-06T19:29:22.087
> 
> 标签：android

尽管对代码进行了更改，但我仍不断收到消息“活动未启动，其当前任务已被置于最前面”。除了创建新的 AVD 之外，我不知道更改 Eclipse 中的任何设置，并且它今天早些时候工作正常。现在它根本没有重新安装。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T19:55:15.910

我不确定为什么问题开始出现，但我从 Eclipse 和 Android 安装了一些更新，现在它似乎工作正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T21:37:42.190

你可以做几件事来解决这个问题：

1.  您可以关闭您的 AVD，然后重新启动它。
2.  您可以使用 AVD 界面手动卸载您的应用程序（主页 - 菜单按钮 - 管理应用程序 - 所有选项卡 - 您的应用程序 - 强制停止/卸载）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T19:15:19.567

解决方案是启动任务管理器并结束以某种方式建立的多个 AVD 模拟器进程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-17T11:00:44.820

我也经常遇到这个问题，即使我更改了代码。对我有帮助的只是在调试模式下启动我的应用程序；然后它开始没有那个警告。后来当我再次以非调试模式启动应用程序时，它通常会在没有警告的情况下启动（至少有一段时间）。

# ruby - 我应该如何使用 EventMachine 处理这个用例？

> ID：12307058
> 
> 赞同：8
> 
> 时间：2012-09-06T19:29:48.330
> 
> 标签：ruby, eventmachine

我有一个对客户端发送的消息做出反应的应用程序。一条消息是`reload_credentials`，应用程序在新客户端注册时收到。然后，此消息将连接到 PostgreSQL 数据库，查询所有凭据，然后将它们存储在常规 Ruby 哈希 (client_id => client_token) 中。

应用程序可能收到的其他一些消息是`start`, `stop`，`pause`它们用于跟踪某些会话时间。我的观点是，我设想应用程序以下列方式运行：

*   客户端发送消息
*   消息排队
*   正在处理队列

但是，例如，我不想阻塞反应器。此外，假设我有一条`reload_credentials`消息在队列中。在从数据库重新加载凭据之前，我不希望处理队列中的任何其他消息。此外，当我正在处理某个消息（例如等待凭据查询完成）时，我希望允许将其他消息排入队列。

你能指导我解决这样的问题吗？我想我可能必须使用`em-synchrony`，但我不确定。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-08T13:45:50.120

使用 Postgresql EM 驱动程序之一或 EM.defer，这样您就不会阻塞反应器。

当您收到“reload_credentials”消息时，只需翻转一个标志，该标志会导致所有后续消息入队。'reload_credentials' 完成后，处理队列中的所有消息。队列为空后，翻转导致消息在收到时被处理的标志。

此处列出了 Postgresql 的 EM 驱动程序：[https ://github.com/eventmachine/eventmachine/wiki/Protocol-Implementations](https://github.com/eventmachine/eventmachine/wiki/Protocol-Implementations)

```
module Server
  def post_init
    @queue               = []
    @loading_credentials = false
  end

  def recieve_message(type, data)
    return @queue << [type, data] if @loading_credentials || !@queue.empty?
    return process_msg(type, data) unless :reload_credentials == type
    @loading_credentials = true
    reload_credentials do
      @loading_credentials = false
      process_queue
    end
  end

  def reload_credentials(&when_done)
    EM.defer( proc { query_and_load_credentials }, when_done )
  end

  def process_queue
    while (type, data = @queue.shift)
      process_msg(type, data)
    end
  end

  # lots of other methods
end

EM.start_server(HOST, PORT, Server) 
```

如果您希望所有连接在任何连接收到“reload_connections”消息时都将消息排队，则必须通过特征类进行协调。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-09T18:44:29.813

以下是我假设的，类似于您当前的实现：

```
 class Worker
      def initialize queue
        @queue = queue
        dequeue
      end

      def dequeue
        @queue.pop do |item|
          begin
            work_on item
          ensure
            dequeue
          end
        end
      end

      def work_on item
        case item.type
        when :reload_credentials
          # magic happens here
        else
          # more magic happens here
        end
      end
    end

    q = EM::Queue.new

    workers = Array.new(10) { Worker.new q } 
```

如果我理解正确的话，上面的问题是你不希望工人从事*新*工作（在生产者时间线中较早到达的工作），而不是任何 reload_credentials 工作。以下内容应为此提供服务（最后还有额外的警告）。

```
 class Worker
      def initialize queue
        @queue = queue
        dequeue
      end

      def dequeue
        @queue.pop do |item|
          begin
            work_on item
          ensure
            dequeue
          end
        end
      end

      def work_on item
        case item.type
        when :reload_credentials
          # magic happens here
        else
          # more magic happens here
        end
      end
    end

    class LockingDispatcher
      def initialize channel, queue
        @channel = channel
        @queue = queue

        @backlog = []
        @channel.subscribe method(:dispatch_with_locking)

        @locked = false
      end

      def dispatch_with_locking item
        if locked?
          @backlog << item
        else
          # You probably want to move the specialization here out into a method or
          # block that's passed into the constructor, to make the lockingdispatcher
          # more of a generic processor
          case item.type
          when :reload_credentials
            lock
            deferrable = CredentialReloader.new(item).start
            deferrable.callback { unlock }
            deferrable.errback  { unlock }
          else
            dispatch_without_locking item
          end
        end
      end

      def dispatch_without_locking item
        @queue << item
      end

      def locked?
        @locked
      end

      def lock
        @locked = true
      end

      def unlock
        @locked = false
        bl = @backlog.dup
        @backlog.clear
        bl.each { |item| dispatch_with_locking item }
      end

    end

    channel = EM::Channel.new
    queue = EM::Queue.new

    dispatcher = LockingDispatcher.new channel, queue

    workers = Array.new(10) { Worker.new queue } 
```

所以，第一个系统的输入是打开的`q`，但在这个新系统中它是打开的`channel`。`queue`仍然用于工作人员之间的工作分配，但在刷新`queue`凭据操作正在进行时不会填充。不幸的是，由于我没有花更多的时间，所以我没有概括`LockingDispatcher`它不与项目类型和调度代码耦合`CredentialsReloader`。我会把它留给你。

您应该在这里注意，虽然我理解您的原始要求，但通常最好放宽这种要求。如果不更改该要求，则基本上无法消除几个突出的问题：

*   在启动凭据作业之前，系统不会等待执行作业完成
*   系统将非常糟糕地处理大量的凭证作业——其他可能可以处理的项目将无法处理。
*   在凭证代码中出现错误的情况下，积压可能会填满 ram 并导致失败。一个简单的超时可能足以避免灾难性影响，如果代码是可中止的，并且后续消息可以充分处理以避免进一步的死锁。

听起来您实际上对系统中有一些用户标识的概念。如果您仔细考虑您的要求，您可能只需要积压与凭据处于刷新状态的用户 ID 相关的项目。这是一个不同的问题，涉及不同类型的调度。为这些用户尝试锁定积压的哈希，在凭证完成时回调以将这些积压排入工作人员，或一些类似的安排。

祝你好运！

# javascript - 更改 VS2010 中“忽略”的 javascript 文件

> ID：12307059
> 
> 赞同：1
> 
> 时间：2012-09-06T19:29:50.537
> 
> 标签：javascript, visual-studio-2010, browser-cache

我有一个`harSympCode.js`要更改的 javascript 文件。它用于 5 个 aspx 页面 - .NET 4.0 和 VS2010 - 并且需要对所有 5 个页面保持一致。

在 js 文件中有一个`startstop()`触发浮动时钟计数的函数。它在 body 标签的 onload 事件中调用。它工作得很好。还有另一个函数（调用它`function1()`）应该将一些值加载到表单中。它几乎与`function2()`文件中的第二个（称为它）相同，除了第二个`form.submit()`在完成时执行 a 。我正在尝试修改`function1()`以在完成后提交表单但无论我做什么，我都无法让系统（VS2010 localhost）识别我添加的两行代码。由于它们工作得很好，`function2()`并且在我重建网站时没有看到任何错误代码或警告，我只能猜测这些更改被忽略了。

我试过的：

1.  从 aspx 页面中删除了`<script>`标记：结果 - `startstop()`，`function1()`并且`function2()`未找到。
2.  重新添加了`<script>`标签，但从解决方案/项目目录结构中删除了脚本文件：结果 - 一切运行，就好像文件仍然存在一样。
3.  删除 sln 和 suo 文件并重新打开网站，同时尝试选项 1 和 2：结果 - 与 1 和 2 相同。

我查看了整个目录结构并重命名和/或删除了我能找到的每个版本的 js 文件，但无济于事。

我已经查找了与预编译网站（不是应用程序）相关的任何内容，并尝试对假定的“预编译”目录进行更改，但 a) 找不到该目录和 b) 我所做的所有更改都被忽略和/或重置下次我去看看。

有没有人看到这个，你是如何解决的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-25T05:53:36.880

正如您的评论中提到的，这似乎不是 IDE 问题。确保将浏览器设置为在每次加载时刷新缓存。在 IE 中：

![在此处输入图像描述](../Images/713b77e9ed65ebfe47e004c5245e71ef.png)

如果您使用的是 Chrome，则缓存会从开发工具中清除并且非常持久。***还使用CTRL+F5***刷新页面。您还想确保您没有收到编译错误，并且您的项目没有从以前的工作版本运行。但是，您尝试过的第 1 点表明生成的 HTML 页面会在您运行项目时刷新，但您的浏览器缓存包含 javascript 文件，因此当脚本标签存在时，它会找到缓存的页面并执行它们。因此，您可以使用顶部的第二个按钮（清除浏览器缓存...）来删除它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-01T21:35:12.187

我一直有这个问题，清除我的缓存并想知道为什么 VS2010 一直在查看旧文件，即使它在 F12 中显示为新版本。

解决方案原来是 TFS 锁定了文件，一旦我检查了有问题的 javascript，调试器就会选择新版本。

# android - 如何动态调整Android TextView的宽度

> ID：12307060
> 
> 赞同：0
> 
> 时间：2012-09-06T19:29:50.920
> 
> 标签：android, android-layout

我有RelativeLayout，在其中我将TextView 放置在与父权对齐的按钮的左侧。因此，当要在 TextView 中显示的文本增加超过 wrap_Content 时，它会在 Button 上重叠。所以，我需要一个解决方案来在下一行显示超出的文本。谁能帮我解决这个问题？
在下面的布局中，如果 TextView2 的文本是“11111111111111111111111”，它将与 TextView1 重叠。如何预防？
我的布局如下：

```
 <ImageView
    android:id="@+id/imageView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_centerVertical="true"
    android:layout_margin="10dp"
    android:scaleType="fitXY"
    android:src="@drawable/icon" >
    </ImageView>

     <TextView
    android:id="@+id/textView1"
    android:layout_width="wrap_content"
      android:layout_height="wrap_content"
    android:layout_alignTop="@+id/imageView1"
    android:layout_margin="5dp"
    android:text="TextView"
    android:textSize="22dp" 
    android:layout_toRightOf="@id/imageView1"
    >
        </TextView>

 <Button
    android:id="@+id/button1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentRight="true"
    android:focusable="false"
    android:text="Button" 
    android:layout_alignTop="@+id/imageView1"

    >
</Button> 

<TextView
    android:id="@+id/textView2"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_toLeftOf="@id/button1"
    android:text="TextView222"
    android:textSize="22dp"
    android:layout_margin="5dp"
    android:layout_alignTop="@+id/imageView1"
    android:ellipsize="end"
    >
</TextView> 
```

在上述布局中，如果 TextView2 的 Text 为“11111111111111111111111”，它将与 TextView1 重叠。如何防止

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T19:53:12.623

只需添加`android:layout_toLeftOf="@+id/button"`到您的 TextView 以防止它与您的 Button 发生冲突。

它看起来像这样：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent">

    <TextView
        android:id="@+id/text"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_toLeftOf="@+id/button"
        android:text="11111111111111111111111111111111111111111111111111111111111111111111111111111111111"/>

    <Button
        android:id="@+id/button"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:text="Potatoe"/>

</RelativeLayout> 
```

* * *

你已经改变了问题......但我也会回答这个新问题。您可能正试图将*太多东西*挤进一排。但是，让我们将您的布局更改为水平 LinearLayout 并使用几个`layout_weight`属性：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="horizontal">

    <ImageView
        android:id="@+id/imageView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_margin="10dp"
        android:scaleType="fitXY"
        android:src="@drawable/ic_launcher"/>

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_margin="5dp"
        android:layout_weight="1"
        android:text="111111111111111111111111111111111"
        android:textSize="22dp"/>

    <TextView
        android:id="@+id/textView2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_margin="5dp"
        android:layout_weight="1"
        android:ellipsize="end"
        android:text="222222222222222222222222222222222"
        android:textSize="22dp"/>

    <Button
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:focusable="false"
        android:text="Button"/>

</LinearLayout> 
```

注意：`textView2`不会换行，因为您使用了该`ellipse`属性。祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-08-03T17:57:39.180

基于@Sam 解决方案，我添加`android:layoutDirection="rtl"`了想要的结果

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
                    android:layout_width="wrap_content"
                    android:layout_height="match_parent"
                    android:layoutDirection="rtl">

                    <TextView
                        android:id="@+id/text"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_toLeftOf="@+id/button"
                        android:text="1111111111111111111111111111111111111"/>

                    <Button
                        android:id="@+id/button"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_alignParentRight="true"
                        android:text="Potatoe"/>

                </RelativeLayout> 
```

# css - 手机/小屏幕的响应式 CSS

> ID：12307064
> 
> 赞同：10
> 
> 时间：2012-09-06T19:29:58.493
> 
> 标签：css, twitter-bootstrap, responsive-design, media-queries

我正在尝试设置一个基本的响应式 wordpress 主题。首先，我从 wordpress.org 获取了工具箱主题，并添加了[twitter bootstrap](http://twitter.github.com/bootstrap/scaffolding.html#responsive)响应式 css/js。

我添加了一些基本的测试样式，只是为了减少小屏幕上的填充并更改颜色以表明它可以正常工作。出于某种原因，横向手机的样式不起作用。

[你可以在这里](http://mrglass.org)查看我的网站。

我的响应式 CSS 代码：

```
/* Large desktop */
@media (min-width: 1200px) { 
    body    {
        padding-left: 50px;
        padding-right: 50px;
        color: green;
    }
}

/* Portrait tablet to landscape and desktop */
@media (min-width: 768px) and (max-width: 1199px) { 
    body    {
        padding-left: 30px;
        padding-right: 30px;
        color: purple;
    }
}

/* Landscape phone to portrait tablet */
@media (max-width: 767px) { 
    body    {
        padding-left: 20px;
        padding-right: 20px;
        color: blue;
    }
}

/* Landscape phones and down */
@media (max-width: 480px) { 
    body    {
        padding-left: 5px;
        padding-right: 5px;
        color: red;
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-13T07:13:36.430

看起来您没有正确设置视口的元标记：

它应该如下所示：

```
<meta name="viewport" content="width=device-width; maximum-scale=1; minimum-scale=1;" /> 
```

# sql - SQL Compact 到 SQL Server（共享主机）和表前缀

> ID：12307065
> 
> 赞同：0
> 
> 时间：2012-09-06T19:30:00.460
> 
> 标签：sql, asp.net-mvc, ef-code-first, sql-server-ce

对不起，如果以前有人问过这个问题，我一直在寻找，但没有真正找到我的答案。

我有一个我开发的博客（MVC 4，EF 代码优先）并且在本地使用 SQL Compact。现在我想转移到我的托管服务提供商，当我编写数据库模式（使用 sql server compact 工具箱）并在 SQL server 上运行它时——它会在我的所有表前面加上我的用户名。这显然导致我的应用程序出错，它找不到诸如“dbo.Posts”之类的表，因为它们都以我的用户名开头。

澄清错误：

System.Data.SqlClient.SqlException：对象名称“dbo.Posts”无效。

连接字符串正确。我可以从 SQL Management Studio 管理数据库。

这是我本地 sql compact db 的屏幕截图：

![本地数据库](../Images/f16e14a486ee065a0e3609a6546d94d0.png)

这是我的数据库在 SQL 服务器上迁移后的样子：

![在此处输入图像描述](../Images/73e30a7b76d638fcd2be64fd57ce6140.png)

看到前缀了吗？

如果你关心这里的堆栈跟踪：堆栈跟踪：

```
Stack Trace: 

[SqlException (0x80131904): Invalid object name 'dbo.Posts'.]
System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection) +2073486
System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection) +5064444
System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning() +234
System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj) +2275
System.Data.SqlClient.SqlDataReader.ConsumeMetaData() +33
System.Data.SqlClient.SqlDataReader.get_MetaData() +86
System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString) +311
System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async) +987
System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, DbAsyncResult result) +162
System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method) +32
System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method) +141
System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior) +12
System.Data.Common.DbCommand.ExecuteReader(CommandBehavior behavior) +10
System.Data.EntityClient.EntityCommandDefinition.ExecuteStoreCommands(EntityCommand entityCommand, CommandBehavior behavior) +443

[EntityCommandExecutionException: An error occurred while executing the command definition. See the inner exception for details.]
System.Data.EntityClient.EntityCommandDefinition.ExecuteStoreCommands(EntityCommand entityCommand, CommandBehavior behavior) +479
System.Data.Objects.Internal.ObjectQueryExecutionPlan.Execute(ObjectContext context, ObjectParameterCollection parameterValues) +736
System.Data.Objects.ObjectQuery`1.GetResults(Nullable`1 forMergeOption) +149
System.Data.Objects.ObjectQuery`1.System.Collections.Generic.IEnumerable<T>.GetEnumerator() +44
System.Data.Entity.Internal.Linq.InternalQuery`1.GetEnumerator() +40
System.Data.Entity.Internal.Linq.InternalSet`1.GetEnumerator() +23
System.Data.Entity.Infrastructure.DbQuery`1.System.Collections.Generic.IEnumerable<TResult>.GetEnumerator() +40
ASP._Page_Views_posts_Index_cshtml.Execute() in c:\PData\Bare Blog Blog Engine\Web\BareBlogAdmin\BareBlogAdmin\Views\Posts\Index.cshtml:48
System.Web.WebPages.WebPageBase.ExecutePageHierarchy() +207
System.Web.Mvc.WebViewPage.ExecutePageHierarchy() +97
System.Web.WebPages.StartPage.RunPage() +19
System.Web.WebPages.StartPage.ExecutePageHierarchy() +65
System.Web.WebPages.WebPageBase.ExecutePageHierarchy(WebPageContext pageContext, TextWriter writer, WebPageRenderingBase startPage) +76
System.Web.Mvc.RazorView.RenderView(ViewContext viewContext, TextWriter writer, Object instance) +255
System.Web.Mvc.BuildManagerCompiledView.Render(ViewContext viewContext, TextWriter writer) +115
System.Web.Mvc.ViewResultBase.ExecuteResult(ControllerContext context) +303
System.Web.Mvc.ControllerActionInvoker.InvokeActionResult(ControllerContext controllerContext, ActionResult actionResult) +13
System.Web.Mvc.<>c__DisplayClass1a.<InvokeActionResultWithFilters>b__17() +23
System.Web.Mvc.ControllerActionInvoker.InvokeActionResultFilter(IResultFilter filter, ResultExecutingContext preContext, Func`1 continuation) +260
System.Web.Mvc.<>c__DisplayClass1c.<InvokeActionResultWithFilters>b__19() +19
System.Web.Mvc.ControllerActionInvoker.InvokeActionResultWithFilters(ControllerContext controllerContext, IList`1 filters, ActionResult actionResult) +177
System.Web.Mvc.Async.<>c__DisplayClass2a.<BeginInvokeAction>b__20() +92
System.Web.Mvc.Async.<>c__DisplayClass25.<BeginInvokeAction>b__22(IAsyncResult asyncResult) +126
System.Web.Mvc.Async.WrappedAsyncResult`1.End() +57
System.Web.Mvc.Async.AsyncControllerActionInvoker.EndInvokeAction(IAsyncResult asyncResult) +45
System.Web.Mvc.<>c__DisplayClass1d.<BeginExecuteCore>b__18(IAsyncResult asyncResult) +14
System.Web.Mvc.Async.<>c__DisplayClass4.<MakeVoidDelegate>b__3(IAsyncResult ar) +25
System.Web.Mvc.Async.WrappedAsyncResult`1.End() +62
System.Web.Mvc.Controller.EndExecuteCore(IAsyncResult asyncResult) +61
System.Web.Mvc.Async.<>c__DisplayClass4.<MakeVoidDelegate>b__3(IAsyncResult ar) +25
System.Web.Mvc.Async.WrappedAsyncResult`1.End() +62
System.Web.Mvc.Controller.EndExecute(IAsyncResult asyncResult) +49
System.Web.Mvc.Controller.System.Web.Mvc.Async.IAsyncController.EndExecute(IAsyncResult asyncResult) +9
System.Web.Mvc.<>c__DisplayClassb.<BeginProcessRequest>b__4(IAsyncResult asyncResult) +28
System.Web.Mvc.Async.<>c__DisplayClass4.<MakeVoidDelegate>b__3(IAsyncResult ar) +25
System.Web.Mvc.Async.WrappedAsyncResult`1.End() +62
System.Web.Mvc.<>c__DisplayClasse.<EndProcessRequest>b__d() +50
System.Web.Mvc.SecurityUtil.<GetCallInAppTrustThunk>b__0(Action f) +7
System.Web.Mvc.SecurityUtil.ProcessInApplicationTrust(Action action) +22
System.Web.Mvc.MvcHandler.EndProcessRequest(IAsyncResult asyncResult) +60
System.Web.Mvc.MvcHandler.System.Web.IHttpAsyncHandler.EndProcessRequest(IAsyncResult result) +9
System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +8970061
System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +184 
```

如果我对主机的数据库运行 LinqPad，它会按预期工作，但不是我使用 DBContext 的 MVC 应用程序。

想法？我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T01:35:27.043

解决它！！！

我通过 SQL 管理登录到远程数据库，并将我的用户的默认模式更改为“dbo”。然后我删除了我的旧表并重新迁移......一切都以“dbo.table-name”的形式出现。运行我的应用程序 - 它工作正常！

啊，多么痛苦。如您所知...我不是 DBA。;)

# grails - commonsMultipartFile 麻烦

> ID：12307068
> 
> 赞同：-1
> 
> 时间：2012-09-06T19:30:18.763
> 
> 标签：grails, file-upload, groovy

您好我正在尝试在我的应用程序中实现文件上传，其中上传的文件被解析并使用该信息在数据库中创建一个条目。

```
 def save = {

        def file = request.getFile("file");
        def filename = file.getOriginalFilename();
        def type = filename.split('\\.');

        if(!file.isEmpty()){
            if(type[1] == "properties"){

                redirect(action:"parsePropertyFile", params:params);
            }
        }
 }

def parsePropertyFile = {

      println "\n"
      println params.file;
      println "\n";

      def f = params.file;
      println f;

      def filename = f.getOriginalFilename();
      println filename;
} 
```

当我打印出来`f`这是输出：

```
org.springframework.web.multipart.commons.CommonsMultipartFile@29d32df9 
```

但是当我尝试打电话`getOriginalFilename()`时，`f`我收到以下错误：

```
groovy.lang.MissingMethodException: No signature of method: 
java.lang.String.getOriginalFilename() is applicable for argument types: () values: [] 
```

我还从保存功能中打印出来`file`，其输出也是：

```
org.springframework.web.multipart.commons.CommonsMultipartFile@29d32df9 
```

那么为什么我会收到错误消息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T19:58:16.130

您可以直接调用另一个函数而不是重定向吗？重定向将使用文件作为参数发出一个 http 重定向，而无需。

```
if(type[1] == "properties") {
  parsePropertyFile(file)
} 
```

进而：

```
private def parsePropertyFile(def file) {
  String filename = file.getOriginalFilename();
  ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T19:59:05.333

在您的`parsePropertyFile`操作中，您没有获得 File 对象，而是从`params`. 就像在你的`save`行动中一样，你需要做

```
def f = request.getFile('file')
println f.getOriginalFilename() 
```

# android-intent - 有意图地将图片发送到 android facebook

> ID：12307069
> 
> 赞同：3
> 
> 时间：2012-09-06T19:30:23.267
> 
> 标签：android-intent

我无法将存储在 SD 卡中的图片发送到 Facebook。

我为此编写了两种方法：第一种方法是可以的。在这种情况下，会出现一个选择器。我选择了屏幕上的Facebook，带有完整界面的facebook启动。图片出现在脸书上。我键入文本并按发布按钮。

```
Uri screenshotUri = Uri.parse("file:///sdcard/"+nomFichier);  
try{
Intent intentPartager = new Intent(Intent.ACTION_SEND);
intentPartager.setType("image/*");
intentPartager.putExtra(Intent.EXTRA_STREAM, screenshotUri);
startActivity(Intent.createChooser(intentPartager, "Share image using"));               
} 
catch(Exception e){
        e.printStackTrace();
        Toast.makeText(this,R.string.erreurFaceBookAbsent,Toast.LENGTH_SHORT).show();
   } 
```

这种方法很好让用户选择发送图片的软件（彩信，推特，脸书，...），但我想简化命令，直接调用脸书。所以我使用第二种方法和 .setClassName("com.facebook.katana","com.facebook.katana.ShareLinkActivity") 指令来强制 facebook 调用。不幸的是，这第二个不起作用。Facebook 已启动，但没有在 facebook 中下载图片（没有出现在 facebook 中）。facebook的屏幕界面也不同于第一种方法???。

```
Uri screenshotUri = Uri.parse("file:///sdcard/"+nomFichier);  
try{
Intent intentFacebook = new Intent(Intent.ACTION_SEND);
intentFacebook.setType("image/*");
intentFacebook.setClassName("com.facebook.katana","com.facebook.katana.ShareLinkActivity");
intentFacebook.setFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION); 
//intentFacebook.putExtra(Intent.EXTRA_TEXT, "Mes performances avec SpeedMeter");
intentFacebook.putExtra(Intent.EXTRA_STREAM, screenshotUri);
//startActivity(intentFacebook);
startActivityForResult(intentFacebook, CODE_RETOUR_FACEBOOK);
} catch(Exception e){
        e.printStackTrace();
        Toast.makeText(this,R.string.erreurFaceBookAbsent,Toast.LENGTH_SHORT).show();
        } 
```

有人可以帮助我吗？第二种方法的问题在哪里？西里尔

# php - 处理对类函数的多次调用的异常

> ID：12307070
> 
> 赞同：2
> 
> 时间：2012-09-06T19:30:28.543
> 
> 标签：php, exception, exception-handling, custom-exceptions

**当我从类中调用函数时，我无法理解何时抛出和捕获异常。**

请想象我的`QuizMaker`班级是这样的：

```
// Define exceptions for use in class
private class CreateQuizException extends Exception {}
private class InsertQuizException extends Exception {}

class QuizMaker()
{

    // Define the items in my quiz object
    $quiz_id = null;
    $quiz_name = null;

    // Function to create a quiz record in the database
    function CreateQuizInDatabase()
    {

        try
        {

            $create_quiz = // Code to insert quiz

            if (!$create_quiz)
            {
                // There was an error creating record in the database
                throw new CreateQuizException("Failed inserting record");
            }
            else
            {
                // Return true, the quiz was created successfully
                return true;
            }

        }
        catch (CreateQuizException $create_quiz_exception)
        {
            // There was an error creating the quiz in the database
            return false;
        }
    }

    function InsertQuestions()
    {
        try
        {
            $insert_quiz = // Code to insert quiz

            if (!$insert_quiz)
            {
                // There was an error creating record in the database
                throw new CreateQuizException("Failed inserting quiz in to database");
            }
            else
            {
                // Success inserting quiz, return true
                return true;
            }
        }
        catch (InsertQuizException $insert_exception)
        {
            // Error inserting question
            return false;
        }
    }
} 
```

**...并使用此代码，我使用该类在数据库中创建一个新测验**

```
 class QuizMakerException extends Exception {}

try
{
    // Create a blank new quiz maker object
    $quiz_object = new QuizMaker();

    // Set the quiz non-question variables
    $quiz_object->quiz_name = $_POST['quiz_name'];
    $quiz_object->quiz_intro = $_POST['quiz_intro'];
            //... and so on ...

    // Create the quiz record in the database if it is not already set
    $quiz_object->CreateQuizRecord();

    // Insert the quiz in to the database
    $quiz_object->InsertQuestions();

}
catch (QuizMakerException $quiz_maker_error)
{
    // I want to handle any errors from these functions here
} 
```

对于这段代码，`QuizMakerException`如果任何函数没有执行我希望它们执行的操作（此时它们返回 TRUE 或 FALSE），我想调用 a。

当此代码中的任何函数未执行我想要的操作时，捕获的*正确方法是什么？*目前他们只是返回 TRUE 或 FALSE。

*   我*真的*必须在调用每个函数之间放置大量 if/else 语句吗，我认为这就是异常的全部意义所在，它们只是停止在 try/catch 中执行进一步的语句？
*   我是否从`catch`我的函数中抛出 QuizMakerException？

什么是正确的做法？

帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T19:49:39.857

好吧，通常在抛出异常的函数中，比如你的`InsertQuestions`方法，你不想捕获任何异常，你想抛出它们或让那些发生“冒泡”。然后您的“控制器”代码可以确定如何处理异常。

如果您的目标是在`CreateQuizRecord`失败时停止，我会在各自的 try 块中换`CreateQuizRecord`行。`InsertQuestions`

异常的一个优点是它们可以告诉您的不仅仅是简单的布尔通过/失败。将您的基本异常扩展到“Invalid_Parameter”之类的内容并测试特定异常，或者 - 不太理想 - 从异常的属性中推断。你可以嵌套你的 catch 块来单独处理异常。

> 我是否从我的函数捕获中抛出 QuizMakerException？

是的。通常，您的代码`// Code to insert quiz`本身会返回异常。假设模型未能插入它可能会引发数据库异常。在这种情况下，您可以让该数据库异常冒泡，或者做您现在正在做的事情并简单地捕获它以反过来抛出另一个异常（尽管这样做有点使您的异常变得愚蠢）。

> 我真的必须在调用每个函数之间放置大量 if/else 语句吗，我认为这就是异常的全部意义所在，它们只是停止在 try/catch 中执行进一步的语句？

我是这样看的，每个抛出异常的调用，然后是一个后续调用，该调用依赖于这个不抛出任何异常的调用，应该包装在一个 try 块中。假设您想优雅地处理它，如果您只是想让它出错并停止，请不要处理异常。你会得到一个错误和堆栈跟踪。有时这是可取的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-06T19:48:50.640

你可能想稍微改变一下结构。您的 QuizMaker 类可以变成：

```
<?php

// Define exceptions for use in class
public class CreateQuizException extends Exception {}
public class InsertQuizException extends Exception {}

class QuizMaker()
{

    // Define the items in my quiz object
    $quiz_id = null;
    $quiz_name = null;

    // Function to create a quiz record in the database
    function CreateQuizInDatabase()
    {

        try
        {

            $create_quiz = // Code to insert quiz

            if (!$create_quiz)
            {
                // There was an error creating record in the database
                throw new CreateQuizException("Failed inserting record");
            }
            else
            {
                // Return true, the quiz was created successfully
                return true;
            }

        }
        catch (Exception $create_quiz_exception)
        {
            // There was an error creating the quiz in the database
            throw new CreateQuizException(
                "Failed inserting record " . 
                $create_quiz_exception->getMessage()
            );
        }
    }

    function InsertQuestions()
    {
        try
        {
            $insert_quiz = // Code to insert quiz

            if (!$insert_quiz)
            {
                // There was an error creating record in the database
                throw new InsertQuizException("Failed inserting quiz in to database");
            }
            else
            {
                // Success inserting quiz, return true
                return true;
            }
        }
        catch (Exception $insert_exception)
        {
            // Error inserting question
            throw new InsertQuizException(
                "Failed inserting quiz in to database " . 
                $create_quiz_exception->getMessage()
            );
        }
    }
} 
```

实际上，如果您无法正确插入记录，则会引发 Insert 异常。如果该代码块出现任何问题，您将捕获它并再次抛出一个 Insert 异常。Create 函数（或您可能拥有的任何其他函数）也是如此。

在主代码块中，您可以拥有：

```
try
{
    // Create a blank new quiz maker object
    $quiz_object = new QuizMaker();

    // Set the quiz non-question variables
    $quiz_object->quiz_name = $_POST['quiz_name'];
    $quiz_object->quiz_intro = $_POST['quiz_intro'];
            //... and so on ...

    // Create the quiz record in the database if it is not already set
    $quiz_object->CreateQuizRecord();

    // Insert the quiz in to the database
    $quiz_object->InsertQuestions();

}
catch (InsertQuizException $insert_exception)
{
    // Insert error
}
catch (CreateQuizException $create_quiz_exception)
{
    // Create error
}
catch (Exception $quiz_maker_error)
{
    // Any other error
} 
```

如果您不想在那里有多个 catch 块，只需保留 catch(Exception) 一个，然后在其中检查引发的每个异常的类型，以指定从那里采取的操作。

高温高压

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-06T19:45:27.873

最好的办法是一开始就不必抛出异常。当程序崩溃并且它们不是用来处理错误输出时会引发异常。如果你的函数返回任何东西（甚至是错误的东西），它不需要异常。

要回答您的问题，如果需要使用很多 if/else，那么您必须使用它们。

# javascript - 滚动布局 - 像 facebook 或 google 加右侧边栏

> ID：12307082
> 
> 赞同：3
> 
> 时间：2012-09-06T19:31:15.497
> 
> 标签：javascript, jquery, html, css

知道如何制作像 google plus 或 facebook 这样的布局。您可以在 google plus home 上查看示例，

一开始，如果您在主要内容中滚动页面，它们会一起滚动（朋友帖子和侧边栏），但是当您滚动到侧边栏底部（在朋友帖子的右侧）时，侧边栏将停止滚动，但是另一个内容（朋友帖子）仍会滚动。可以向我解释如何制作这样的布局吗？示例代码或演示将非常有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T19:42:28.453

使用 CSS 进行固定定位是一种非常有限的方法。有很多方法可以实现这种“固定”区域，其中许多已经在此处对类似问题的回答中给出（尝试上面的搜索？）。

一种技术（许多都基于）就是这样（简而言之）..

1.  捕获浏览器的滚动
2.  获取所选元素顶部的位置 (x)
3.  检查滚动是否> x，如果是，则将类应用于元素以将其固定到某个位置。

反过来也一样，例如：

```
var target = $('#div-to-stick');
var div_position = target.offset().top;

$(window).scroll(function() { 
    var y_position = $(window).scrollTop();
    if(y_position > div_position) {
        target.addClass('fixed');
    }
    else {
        target.removeClass('fixed');
    }
} 
```

**注意：**根据您选择完成上述代码的方式，页面经常会随着 div 的位置被修改而“跳转”。这并不总是一个（明显的）问题，但您可以考虑通过使用 .before 和 target.height() 并附加一个具有相同高度的“假”替换 div 来解决这个问题。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T08:40:14.423

css3 的新方法是减少你的工作量。使用单一属性来获取它。

```
position:sticky; 
```

这是一篇解释它和演示的文章。

[文章](http://updates.html5rocks.com/2012/08/Stick-your-landings-position-sticky-lands-in-WebKit)

[演示](http://html5-demos.appspot.com/static/css/sticky.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-06T19:36:24.947

您正在寻找 CSS `position:fixed`（用于滚动侧边栏），您可以使用`left:[length]`、`right:[length]`、`top:[length]`和`bottom:[length]`正常的宽度和高度组合设置位置

您将需要在窗口滚动到侧边栏顶部后应用该属性的窗口`resize`和侦听器来扩充它。`scroll``position:fixed`

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-06T19:41:08.933

使用 css 属性（位置：固定）。即使您向下滚动或向上滚动，这也会保持 div 的位置固定。

# android - 与 Millinial 媒体、ZestAdz 和 InMobi 合作的 Adwhril 出现错误

> ID：12307086
> 
> 赞同：0
> 
> 时间：2012-09-06T19:31:25.920
> 
> 标签：android, adwhirl

我尝试实施 Adwhril 并向其中添加 Millenial Media、ZestAdz 和 InMobi 网络。我还设置了内部广告以供备份。

现在的问题是，当 Adwhril 尝试从 InMobi 显示广告时，会出现一个大的空白黑屏，并且应用程序挂起，之后什么也没有发生。一切都卡住了。它甚至没有抛出任何警告或错误。

只有显示的广告是我的 HouseAd（自定义广告）。除了 HouseAd 之外，其他广告均未显示 :(

当它尝试显示来自 Millenial Ads 的广告时，我收到以下错误：

```
09-06 21:37:04.227: D/AdWhirl SDK(281): Valid adapter, calling handle()
09-06 21:37:04.234: W/AdWhirl SDK(281): Caught an exception in adapter:
09-06 21:37:04.234: W/AdWhirl SDK(281): java.lang.NoSuchMethodError: com.millennialmedia.android.MMAdView.<init>
09-06 21:37:04.234: W/AdWhirl SDK(281):     at com.adwhirl.adapters.MillennialAdapter.handle(MillennialAdapter.java:77)
09-06 21:37:04.234: W/AdWhirl SDK(281):     at com.adwhirl.adapters.AdWhirlAdapter.handle(AdWhirlAdapter.java:168)
09-06 21:37:04.234: W/AdWhirl SDK(281):     at com.adwhirl.AdWhirlLayout.handleAd(AdWhirlLayout.java:231)
09-06 21:37:04.234: W/AdWhirl SDK(281):     at com.adwhirl.AdWhirlLayout.access$300(AdWhirlLayout.java:53)
09-06 21:37:04.234: W/AdWhirl SDK(281):     at com.adwhirl.AdWhirlLayout$HandleAdRunnable.run(AdWhirlLayout.java:399)
09-06 21:37:04.234: W/AdWhirl SDK(281):     at android.os.Handler.handleCallback(Handler.java:587)
09-06 21:37:04.234: W/AdWhirl SDK(281):     at android.os.Handler.dispatchMessage(Handler.java:92)
09-06 21:37:04.234: W/AdWhirl SDK(281):     at android.os.Looper.loop(Looper.java:123)
09-06 21:37:04.234: W/AdWhirl SDK(281):     at android.app.ActivityThread.main(ActivityThread.java:4627)
09-06 21:37:04.234: W/AdWhirl SDK(281):     at java.lang.reflect.Method.invokeNative(Native Method)
09-06 21:37:04.234: W/AdWhirl SDK(281):     at java.lang.reflect.Method.invoke(Method.java:521)
09-06 21:37:04.234: W/AdWhirl SDK(281):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
09-06 21:37:04.234: W/AdWhirl SDK(281):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
09-06 21:37:04.234: W/AdWhirl SDK(281):     at dalvik.system.NativeStart.main(Native Method)
09-06 21:37:04.234: D/AdWhirl SDK(281): Showing ad:
09-06 21:37:04.234: D/AdWhirl SDK(281):     nid: xxxxxxxxxxxxxxxxxxxxxxxxxxx
09-06 21:37:04.234: D/AdWhirl SDK(281):     name: custom
09-06 21:37:04.234: D/AdWhirl SDK(281):     type: 9
09-06 21:37:04.234: D/AdWhirl SDK(281):     key: __CUSTOM__
09-06 21:37:04.234: D/AdWhirl SDK(281):     key2: 
09-06 21:37:04.234: D/AdWhirl SDK(281): Generic adapter will get destroyed 
```

当它尝试显示 ZestAdz 时，我收到以下消息

```
09-06 22:02:44.063: D/AdWhirl SDK(328): Showing ad:
09-06 22:02:44.063: D/AdWhirl SDK(328):     nid: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
09-06 22:02:44.063: D/AdWhirl SDK(328):     name: zestadz
09-06 22:02:44.063: D/AdWhirl SDK(328):     type: 20
09-06 22:02:44.063: D/AdWhirl SDK(328):     key: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
09-06 22:02:44.063: D/AdWhirl SDK(328):     key2: 
09-06 22:02:44.063: W/AdWhirl SDK(328): Unsupported ration type: 20
09-06 22:02:44.122: D/dalvikvm(328): GC_FOR_MALLOC freed 2068 objects / 351008 bytes in 53ms
09-06 22:02:44.132: W/AdWhirl SDK(328): Caught an exception in adapter:
09-06 22:02:44.132: W/AdWhirl SDK(328): java.lang.Exception: Invalid adapter
09-06 22:02:44.132: W/AdWhirl SDK(328):     at com.adwhirl.adapters.AdWhirlAdapter.handle(AdWhirlAdapter.java:170)
09-06 22:02:44.132: W/AdWhirl SDK(328):     at com.adwhirl.AdWhirlLayout.handleAd(AdWhirlLayout.java:231)
09-06 22:02:44.132: W/AdWhirl SDK(328):     at com.adwhirl.AdWhirlLayout.access$300(AdWhirlLayout.java:53)
09-06 22:02:44.132: W/AdWhirl SDK(328):     at com.adwhirl.AdWhirlLayout$HandleAdRunnable.run(AdWhirlLayout.java:399)
09-06 22:02:44.132: W/AdWhirl SDK(328):     at android.os.Handler.handleCallback(Handler.java:587)
09-06 22:02:44.132: W/AdWhirl SDK(328):     at android.os.Handler.dispatchMessage(Handler.java:92)
09-06 22:02:44.132: W/AdWhirl SDK(328):     at android.os.Looper.loop(Looper.java:123)
09-06 22:02:44.132: W/AdWhirl SDK(328):     at android.app.ActivityThread.main(ActivityThread.java:4627)
09-06 22:02:44.132: W/AdWhirl SDK(328):     at java.lang.reflect.Method.invokeNative(Native Method)
09-06 22:02:44.132: W/AdWhirl SDK(328):     at java.lang.reflect.Method.invoke(Method.java:521)
09-06 22:02:44.132: W/AdWhirl SDK(328):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
09-06 22:02:44.132: W/AdWhirl SDK(328):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
09-06 22:02:44.132: W/AdWhirl SDK(328):     at dalvik.system.NativeStart.main(Native Method) 
```

谁能指出我做错了什么并指导我如何解决这个问题？

谢谢你！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T10:01:57.533

确保您已包含最新版本的适配器和 SDK。还要检查您是否已在 adwhirl 站点中添加了您正在集成的网络的网络 ID。

这是使用相同的示例代码。在xml文件中添加

```
<com.adwhirl.AdWhirlLayout
    android:id="@+id/adwhirl_layout"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content" /> 
```

代码更改：

```
AdWhirlLayout adWhirlLayout2 = new AdWhirlLayout(this,"46a9e26bb1f5499ab7b00c9807ae034b");
adWhirlLayout2.setAdWhirlInterface(this);
adWhirlLayout2.setMaxWidth(width);
adWhirlLayout2.setMaxHeight(height);
AdWhirlManager.setConfigExpireTimeout(1000 * 60 * 5);
RelativeLayout.LayoutParams adWhirlLayoutParams = new RelativeLayout.LayoutParams(
        LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT);
adWhirlLayoutParams.addRule(RelativeLayout.CENTER_HORIZONTAL);
layout.setGravity(Gravity.CENTER_HORIZONTAL);
layout.addView(adWhirlLayout2, adWhirlLayoutParams); 
```

不要忘记权限。

请发布您的代码。它将更容易调试。如有任何疑问，请联系 helpdesk@inmobi.com

# ruby-on-rails - 重新加载工厂_女孩工厂

> ID：12307091
> 
> 赞同：13
> 
> 时间：2012-09-06T19:31:42.900
> 
> 标签：ruby-on-rails, factory-bot

我希望当我在工厂中进行更改时，我可以在 rails 控制台中看到它们，而无需重新启动所有控制台。

我发现了一些行并在对发生的事情了解甚少的情况下对其进行了测试，[文档](http://rubydoc.info/gems/factory_girl/FactoryGirl.reload)对我来说并不清楚。：

```
FactoryGirl.reload 
```

我也测试过：

```
> FactoryGirl.factories.clear
> FactoryGirl.find_definitions # also tested FactoryGirl.factories.find_definitions
                               # but NoMethodError is raised
=> ActiveRecord::RecordNotFound: Couldn't find Address with ID=277 Torphy Squares 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-09-06T20:20:25.937

您也可以使用`reload!`重新加载控制台环境，但它不会重新加载工厂。用于`FactoryGirl.reload`重新加载工厂定义。它从以下位置（重新）加载这些定义（请参阅[文档](https://github.com/thoughtbot/factory_girl/blob/master/GETTING_STARTED.md#defining-factories)）：

```
test/factories.rb
spec/factories.rb
test/factories/*.rb
spec/factories/*.rb 
```

您提到的其他命令用于清除和加载定义。`FactoryGirl.factories.clear`清除所有加载的工厂定义，同时`FactoryGirl.find_definitions`从文件中重新加载所有定义。

`factory_girl_rails`如果您在 Rails 上，请务必使用gem。例如，当您定义 a`factory :user`时，您可以在控制台中将其与`FactoryGirl.build(:user)`or一起使用`FactoryGirl.create(:user)`。这将返回一个用户实例。

如果这不起作用，请发布更多详细信息。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-09-11T16:45:03.770

我正在使用[Faker](http://faker.rubyforge.org/)。查看解决问题的更改差异：

```
# factories/building.rb, address is a string

- address    Faker::Address.street_address
+ address    { Faker::Address.street_address }

# factories/user.rb, email is a string

- email Faker::Internet.email
+ email { Faker::Internet.email } 
```

然后`FactoryGirl.reload`工作。

# android - 如何将 ViewPager 添加为我的 ListView 中的顶部项目

> ID：12307092
> 
> 赞同：-1
> 
> 时间：2012-09-06T19:31:54.087
> 
> 标签：android, android-listview, android-viewpager, rotator

我有一个香草“新闻”应用程序，其中的主页是一个 ListView，它可以垂直滚动文章列表（缩略图、标题..等）。这工作得很好，但现在我想添加一个水平文章/照片旋转器作为该列表中的顶部项目。我真的不在乎它在技术上是否在列表中，但是当列表被拖动时它应该向上/离开屏幕......等等。我假设（d）它应该在列表中，但对 Android 来说还是很新的，不知道是否有更好的解决方案。

经过一整天的搜索，我仍然两手空空 - 不知道如何添加它，即使它是正确的方法。我正在为我的画廊视图使用 ViewPager（当他们单击照片时），这似乎工作正常......但这就是整个视图......而且这个已经有一个填充 listView 的适配器......我希望我只是把事情复杂化了。

**TLDR**：

```
1) Can I add a ViewPager as top item in a ListView?
2) How would one go about doing it?
3) Is there a better solution? 
```

注意： android:minSdkVersion="8" android:targetSdkVersion="15"

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T20:37:10.910

您可以使用`addHeaderView()`ListView API 来设置标题。它可以是任何视图，也可以是 ViewPager。我认为您必须以编程方式添加它。但是正确设置它的高度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T19:46:42.920

我不确定我是否理解你的问题。`ViewPager`与其他任何视图一样，因此在您`ListView`的适配器`getView()`方法中，返回一个包含`ViewPager`.

`ViewPager`本身就是一个主题，所以如果您的问题是您不理解`ViewPager`，请阅读这些链接，

> [http://developer.android.com/reference/android/support/v4/view/ViewPager.html](http://developer.android.com/reference/android/support/v4/view/ViewPager.html)
> 
> [http://android-developers.blogspot.com/2011/08/horizo​​ntal-view-swiping-with-viewpager.html](http://android-developers.blogspot.com/2011/08/horizontal-view-swiping-with-viewpager.html)

如果您使用的是 API 级别 8，则应该使用`ViewPager`兼容性包中的和朋友。

说了这么多，我想知道您是否在将可滚动视图放入可滚动视图中时遇到问题。我知道`ViewPager`如果它决定它无法处理它们，它包含将任何手势传递给子视图的代码。我不能说是否`ListView`有同样的智慧。

# ios - 在新 iPad 视网膜上播放高分辨率视频 (2048x1536)

> ID：12307094
> 
> 赞同：6
> 
> 时间：2012-09-06T19:32:09.040
> 
> 标签：ios, ipad, video, mpmovieplayercontroller, retina-display

我想知道是否有一些方法可以为 iPad 播放具有视网膜分辨率 (2048x1536) 的视频。我正在开发一个应用程序，它可以使用 MPMoviePlayerController 全屏播放视频，但无法播放 iPad 视网膜分辨率的视频。从文档中：

> 支持的格式 此类播放 iOS 支持的任何电影或音频文件。这包括流式内容和固定长度文件。对于电影文件，这通常意味着扩展名为 .mov、.mp4、.mpv 和 .3gp 并使用以下压缩标准之一的文件：
> 
> H.264 Baseline Profile Level 3.0 视频，在 30 fps 时高达 640 x 480。（基线配置文件不支持 B 帧。） MPEG-4 第 2 部分视频（简单配置文件） 如果您使用此类播放音频文件，它会在播放音频时显示带有 QuickTime 徽标的白屏。对于音频文件，此类支持最高 48 kHz 的 AAC-LC 音频和最高 48 kHz 的 MP3（MPEG-1 音频层 3）立体声音频。

这不是真的！！！我可以在 iPhone 上播放 H.264 视频 (960x640)，在 ipad 上播放 1024x768 视频...

那么：如何以 iPad 视网膜分辨率播放视频？是否可以？在没有 MPMoviePlayerController 的情况下，还有其他方法可以在 iOS 应用程序上播放视频吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-10T09:37:51.367

根据我的测试，可以使用 H264 编码在视网膜 iPad 上播放 2048x1536 的文件。[诀窍是手刹（或 FFMPEG）使用这些设置](https://s3.amazonaws.com/My-Online-Videos/Handbrake-Settings.png)生成文件。在此页面上，您将找到[一些 1536p 视频文件](http://www.reduser.net/forum/showthread.php?75085-quot-new-Ipad-quot-%283%29-how-do-I-get-highest-quality-demo-video-on-it&p=973240&viewfull=1#post973240)，可用于测试此分辨率下的播放。

顺便说一句，我在处理本地视频时建议的一件好事是只嵌入“半视网膜”分辨率的视频。**通过半视网膜，我的意思是 1536x1152**。这提供了比非视网膜分辨率更多的信息，因此视频在视网膜 iPad 上更清晰一些。而且它足够小巧，可以在任何比 iPhone 3GS 更早的 iOS 设备上播放。因此**，您只需为所有设备添加一个视频**。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T08:51:52.733

iPad 视网膜能够显示 1080p 视频内容。这种格式与各种分辨率兼容，但最典型的定义为 1920 x 1080。这也是使用内置相机拍摄的视频的大小，因此很明显它可以播放，并且比文档中描述的要大可接受的尺寸。

我能够使用以下代码验证这一点。创建一个基本的单视图项目并将视频文件添加到 Supporting Files 组。

视图控制器.h

```
#import <UIKit/UIKit.h>
#import <MediaPlayer/MediaPlayer.h>

@interface CDTViewController : UIViewController{
    MPMoviePlayerController *moviePlayer;
}

-(IBAction) playMovie;

@end 
```

视图控制器.m

```
@implementation CDTViewController
- (void)viewDidLoad {
    [super viewDidLoad];
}

-(void)playMovie {
    NSURL *url = [NSURL fileURLWithPath:[[NSBundle mainBundle] pathForResource:@"IMG_3803" ofType:@"MOV"]];
    moviePlayer = [[MPMoviePlayerController alloc] initWithContentURL:url];

    if ([moviePlayer respondsToSelector:@selector(loadState)]) {
        [moviePlayer setControlStyle:MPMovieControlStyleEmbedded];
        [moviePlayer setFullscreen:NO];
        [moviePlayer prepareToPlay];
        [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(moviePlayerLoadStateDidChange:) name:MPMoviePlayerLoadStateDidChangeNotification object:nil];
    }
}

- (void)moviePlayerLoadStateDidChange:(NSNotification *)notification {
    if ([moviePlayer loadState] == MPMovieLoadStateStalled) {
        //handle stall
    } else if([moviePlayer loadState] != MPMovieLoadStateUnknown) {
        [[NSNotificationCenter defaultCenter] removeObserver:self name:MPMoviePlayerLoadStateDidChangeNotification object:nil];

        [[moviePlayer view] setFrame:self.view.bounds];
        [[self view] addSubview:[moviePlayer view]];
        [moviePlayer play];
    }
}
@end 
```

不要忘记将 MediaPlayer.framework 添加到您的项目中。此示例假定 xib 文件中有一个播放按钮，它的 touchUpInside 事件附加到 playMovie IBAction。

# ruby - 如何在没有 Rails 的情况下使用 RSpec？

> ID：12307097
> 
> 赞同：52
> 
> 时间：2012-09-06T19:32:21.280
> 
> 标签：ruby, rspec, tdd, bdd

在没有 Rails 的情况下使用 RSpec 在 Ruby 中进行 TDD 的过程是什么？

我需要一个 Gemfile 吗？它只需要 rspec 吗？

红宝石 1.9.3

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2012-09-06T19:44:01.120

过程如下：

从控制台安装 rspec gem：

```
gem install rspec 
```

然后创建一个包含以下内容的文件夹（我们将其命名为 root）：

根/my_model.rb

根/spec/my_model_spec.rb

```
#my_model.rb
class MyModel
  def the_truth
    true
  end
end

#spec/my_model_spec.rb

require_relative '../my_model'

describe MyModel do
  it "should be true" do
    MyModel.new.the_truth.should be_true
  end
end 
```

然后在控制台运行

```
rspec spec/my_model_spec.rb 
```

瞧！

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2012-09-06T19:45:55.580

从您的项目目录中...

```
gem install rspec
rspec --init 
```

然后在创建的规范目录中编写规范并通过

```
rspec 'path to spec' # or just rspec to run them all 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2017-12-02T15:29:23.913

周围的工作流程`gem install rspec`存在缺陷。始终使用 Bundler 和 Gemfile 来确保一致性并避免项目在一台计算机上正常运行但在另一台计算机上失败的情况。

创建你的`Gemfile`：

```
source 'https://rubygems.org/'

gem 'rspec' 
```

然后执行：

```
gem install bundler
bundle install
bundle exec rspec --init 
```

以上将为您创建`.rspec`和`spec/spec_helpers.rb`。

现在在以下位置创建您的示例规范`spec/example_spec.rb`：

```
describe 'ExampleSpec' do
  it 'is true' do
    expect(true).to be true
  end
end 
```

并运行规格：

```
% bundle exec rspec
.

Finished in 0.00325 seconds (files took 0.09777 seconds to load)
1 example, 0 failures 
```

# python - 修改 pandas 数据框中的行子集

> ID：12307099
> 
> 赞同：178
> 
> 时间：2012-09-06T19:32:25.827
> 
> 标签：python, pandas

假设我有一个带有两列 A 和 B 的 pandas DataFrame。我想修改这个 DataFrame（或创建一个副本），以便在 A 为 0 时 B 始终为 NaN。我将如何实现？

我尝试了以下

```
df['A'==0]['B'] = np.nan 
```

和

```
df['A'==0]['B'].values.fill(np.nan) 
```

没有成功。

* * *

## 回答 #1

> 赞同：284
> 
> 时间：2012-09-06T19:37:18.910

用于[`.loc`](https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.loc.html)基于标签的索引：

```
df.loc[df.A==0, 'B'] = np.nan 
```

该`df.A==0`表达式创建一个布尔系列，索引行，`'B'`选择列。您还可以使用它来转换列的子集，例如：

```
df.loc[df.A==0, 'B'] = df.loc[df.A==0, 'B'] / 2 
```

我对 pandas 的内部结构了解得不够多，无法确切知道为什么会这样，但基本问题是有时索引到 DataFrame 会返回结果的副本，有时会返回原始对象的视图。根据[此处](http://pandas.pydata.org/pandas-docs/stable/indexing.html#advanced-indexing-with-labels)的文档，此行为取决于底层的 numpy 行为。我发现在一次操作中访问所有内容（而不是 [one][two]）更有可能用于设置。

* * *

## 回答 #2

> 赞同：102
> 
> 时间：2012-09-26T17:14:39.427

[以下](http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-advanced)是关于高级索引的 pandas 文档：

该部分将准确解释您的需求！事实证明`df.loc`（因为 .ix 已被弃用——正如许多人在下面指出的那样）可用于数据帧的冷切片/切块。和。它也可以用来设置东西。

```
df.loc[selection criteria, columns I want] = value 
```

所以布伦的回答是“找到我所有的地方`df.A == 0`，选择列`B`并将其设置为`np.nan`”

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2017-07-04T20:27:54.927

从 pandas 0.20 开始，[ix 已弃用](http://pandas.pydata.org/pandas-docs/stable/indexing.html#ix-indexer-is-deprecated)。正确的方法是使用[df.loc](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.loc.html)

这是一个工作示例

```
>>> import pandas as pd 
>>> import numpy as np 
>>> df = pd.DataFrame({"A":[0,1,0], "B":[2,0,5]}, columns=list('AB'))
>>> df.loc[df.A == 0, 'B'] = np.nan
>>> df
   A   B
0  0 NaN
1  1   0
2  0 NaN
>>> 
```

* * *

## 解释：

正如[此处](http://pandas.pydata.org/pandas-docs/stable/indexing.html#different-choices-for-indexing)文档中所解释的，`.loc` *主要基于标签，但也可以与布尔数组一起使用*。

因此，我们在上面所做的是`df.loc[row_index, column_index]`通过以下方式申请：

*   利用`loc`可以将布尔数组作为掩码的事实，告诉熊猫我们要更改的行子集`row_index`
*   利用这个事实`loc`也是基于标签的，使用标签`'B'`中的标签选择列`column_index`

我们可以使用逻辑、条件或任何返回一系列布尔值的操作来构造布尔值数组。在上面的示例中，我们想要`rows`包含 a 的任何内容`0`，因为我们可以使用`df.A == 0`，正如您在下面的示例中所见，这将返回一系列布尔值。

```
>>> df = pd.DataFrame({"A":[0,1,0], "B":[2,0,5]}, columns=list('AB'))
>>> df 
   A  B
0  0  2
1  1  0
2  0  5
>>> df.A == 0 
0     True
1    False
2     True
Name: A, dtype: bool
>>> 
```

然后，我们使用上面的布尔数组来选择和修改必要的行：

```
>>> df.loc[df.A == 0, 'B'] = np.nan
>>> df
   A   B
0  0 NaN
1  1   0
2  0 NaN 
```

有关更多信息，请查看[此处](http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-advanced)的高级索引文档。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2017-11-02T23:18:25.170

要大幅提高速度，请使用 NumPy 的 where 函数。

### 设置

创建一个包含 100,000 行且带有一些零的两列 DataFrame。

```
df = pd.DataFrame(np.random.randint(0,3, (100000,2)), columns=list('ab')) 
```

### 快速解决方案`numpy.where`

```
df['b'] = np.where(df.a.values == 0, np.nan, df.b.values) 
```

### 计时

```
%timeit df['b'] = np.where(df.a.values == 0, np.nan, df.b.values)
685 µs ± 6.4 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)

%timeit df.loc[df['a'] == 0, 'b'] = np.nan
3.11 ms ± 17.2 µs per loop (mean ± std. dev. of 7 runs, 100 loops each) 
```

Numpy 的`where`速度大约快 4 倍

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2017-10-25T04:22:16.613

要替换多个列，请使用以下命令转换为 numpy 数组`.values`：

```
df.loc[df.A==0, ['B', 'C']] = df.loc[df.A==0, ['B', 'C']].values / 2 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-12-09T13:50:44.803

**备择方案：**

*no 1 在我看来最好，但奇怪的是我找不到它的支持文档*

1.  将列过滤为系列（注意：过滤器出现在写入列之后，而不是之前）

*dataframe.column[过滤条件]=要更改为的值*

```
df.B[df.A==0] = np.nan 
```

2.  [位置](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.loc.html)

*dataframe.loc[过滤条件，要更改的列]=要更改的值*

```
df.loc[df.A == 0, 'B'] = np.nan 
```

3.  [麻木在哪里](https://numpy.org/doc/stable/reference/generated/numpy.where.html)

*dataframe.column=np.where（过滤条件，值为真，值为假）*

```
import numpy as np
df.B = np.where(df.A== 0, np.nan, df.B) 
```

4.  [应用 lambda](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.apply.html)

*dataframe.column=df.apply(lambda row: value if condition true else value if false, 使用行而不是列)*

```
df.B = df.apply(lambda x: np.nan if x['A']==0 else x['B'],axis=1) 
```

5.  [zip](https://www.w3schools.com/python/ref_func_zip.asp)和列表语法

*dataframe.column=[如果条件为真则取值，否则对于列 a 和 b 的 zip 函数列表中的元素 a、b 为假则取值]*

```
df.B = [np.nan if a==0 else b for a,b in zip(df.A,df.B)] 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-12-14T07:43:41.283

要在 Pandas 中修改 DataFrame，您可以使用“语法糖”运算符，如,`+=`等。因此，请不要：`*=``/=`

```
df.loc[df.A == 0, 'B'] = df.loc[df.A == 0, 'B'] / 2 
```

你可以写：

```
df.loc[df.A == 0, 'B'] /= 2 
```

要替换值，`NaN`可以使用 Pandas 方法[`mask`](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.mask.html)或[`where`](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.where.html). 例如：

```
df  = pd.DataFrame({'A': [1, 2, 3], 'B': [0, 0, 4]})

   A  B
0  1  0
1  2  0
2  3  4

df['A'].mask(df['B'] == 0, inplace=True) # other=np.nan by default
# df['A'].where(df['B'] != 0, inplace=True) 
```

结果：

```
 A  B
0  NaN  0
1  NaN  0
2  3.0  4 
```

# java - 将实用程序类转换为多线程类

> ID：12307104
> 
> 赞同：0
> 
> 时间：2012-09-06T19:32:37.197
> 
> 标签：java, multithreading

我在 Java 中有一个实用程序类，它正在访问一个大文件系统来访问一个文件。有些文件很大，所以发生的事情是`Utility`班级正在谈论很多时间来访问这些文件，而我在这里面临性能问题。我计划实施多线程以提高性能，但我对如何做到这一点感到有些困惑。下面是 Utility 类的结构。

```
public class Utility {

     public static void Method1(ArrayList values){
          //do some processing
          for(int i=0; i< values.size();i++){
             ArrayList<String> details= MethodAccessFileSystem();

             CreateFileInDir(details);
        } 
     }
     public ArrayList<String> MethodAccessFileSystem(){
        //Code to access the file system. This is taking hell lot of time.
     }
     public void CreateFileInDir(ArrayList<String> values){
       //Do some processing here. 
     }
} 
```

我曾经使用以下语法在独立类中调用此 Utilty 类

```
 Utility.Method1(values); //values is an ArayList. 
```

现在我需要将上面的代码转换成多线程代码。我知道如何通过扩展 Thread 类或实现 Runnable 来创建线程。我对此有一个基本的想法。

但我需要知道的是我是否应该将整个 Utilty 类转换为实现 Runnable。或者 Utilty 类的某些部分是否需要分离并作为 Runnable 任务。我的问题是 for() 循环，因为这些方法是在循环中调用的。如果我分离出 MethodAccessFileSystem() 并将其作为一项任务将其工作。如果 MethodAccessFileSystem() 需要一些时间，那么如果我使用 Threadpoolexecutor 来安排固定数量的线程，JVM 会自动启动另一个线程。我是否需要暂停此方法或不需要它，否则 JVM 会小心的。主要问题在于 For 循环。

最后，我需要的是 Utility 类应该是多线程的，并且对方法的调用应该与上面的相同。

```
 Utility.Method1(values); //values is an ArayList. 
```

我正在考虑如何实现这一点。您能帮我解决这个问题，并就需要进行的设计更改提供您的建议和反馈。

谢谢维肯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T19:38:12.097

从你的班级根据我的`chunk of work which fits in Parallelism principle is below loop`.

```
// do some processing
    for (int i = 0; i < values.size(); i++) {
        new Thread(new Runnable() {

            @Override
            public void run() {
                ArrayList<String> details = MethodAccessFileSystem();
                CreateFileInDir(details);
            }
        });

    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T19:38:59.110

在进行更改之前，请确保多个线程会有所帮助。运行该方法，您可以检查 CPU 和磁盘 i/o 活动。还要检查是否正在进行任何垃圾收集。

如果存在任何这些条件，那么添加线程真的无济于事。您必须解决该特定条件才能获得任何吞吐量改进。

话虽如此，使代码线程安全的技巧是在类上没有任何用于在方法执行期间保持状态的实例变量。对于每个现有的实例变量，您需要决定是使其成为方法中声明的局部变量还是方法参数。

# jquery - $(document.body) 和 $('body') 之间的区别

> ID：12307112
> 
> 赞同：112
> 
> 时间：2012-09-06T19:33:21.480
> 
> 标签：jquery, document, document-body

我是 jQuery 初学者，在浏览一些代码示例时，我发现：

`$(document.body)`和`$('body')`

这两者有什么区别吗？

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2012-09-06T19:36:45.180

它们指的是同一个元素，不同之处在于当您说`document.body`您将元素直接传递给 jQuery 时。或者，当您传递字符串`'body'`时，[jQuery 选择器引擎](http://api.jquery.com/category/selectors/)必须解释该字符串以找出它所指的元素。

在实践中，两者都可以完成工作。

如果您有兴趣，请参阅[jQuery 函数](http://api.jquery.com/jQuery/)的文档中的更多信息。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2016-02-03T16:19:49.003

这里的答案实际上并不*完全*正确。关闭，但有一个边缘情况。

不同之处在于 $('body') 实际上是通过标签名称选择元素，而 document.body 引用文档上的直接对象。

这意味着如果您（或流氓脚本）覆盖 document.body 元素（可耻！） $('body') 仍然可以工作，但 $(document.body) 不会。所以根据定义，它们是不等价的。

我大胆猜测还有其他极端情况（例如 IE 中的全局 id'ed 元素）也会触发相当于文档对象上覆盖的正文元素的内容，并且同样的情况也适用。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2018-03-23T12:43:17.823

在我的浏览器中进行测试时，我发现时间上有很大的差异。

我使用了以下脚本：

> **警告：运行它会使您的浏览器冻结一点，甚至可能导致它崩溃。**

```
var n = 10000000, i;
i = n;
console.time('selector');
while (i --> 0){
    $("body");
}

console.timeEnd('selector');

i = n;
console.time('element');
while (i --> 0){
    $(document.body);
}

console.timeEnd('element');
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
```

我进行了 1000 万次交互，结果如下（Chrome 65）：

> 选择器：19591.97509765625ms
> 元素：4947.8759765625ms

直接传递元素比传递选择器快 4 倍左右。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-09-06T19:36:15.593

`$(document.body)`是使用全局引用`document`来获取对 的引用`body`，而`$('body')`是一个选择器，jQuery 将在其中获取`<body>`对`document`.

我看不出有什么大的区别，从一个到另一个也没有任何明显的性能提升。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-09-06T19:35:54.063

应该没有区别，也许第一个性能更高一些，但我认为这很简单（你不应该担心这个，真的）。

`<body>`两者都将标签包装在 jQuery 对象中

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-09-06T19:55:32.763

输出上两者是等价的。尽管第二个表达式从 DOM 根目录进行了自上而下的查找。如果您手头已经有 document.body 对象供 JQuery 包装，您可能希望避免额外的开销（无论它可能多么微不足道）。请参阅[http://api.jquery.com/jQuery/ #Selector 上下文](http://api.jquery.com/jQuery/#jQuery-selector-context)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-09-24T18:59:27.780

今天尝试在 [https://developer.chrome.com/docs/extensions/mv3/getstarted/中制作 chrome 扩展示例](https://developer.chrome.com/docs/extensions/mv3/getstarted/)

我试图切换

```
document.body.style.backgroundColor = color; 
```

和

```
$("body").css("background-color", "black"); 
```

当然不得不说我在html文件中添加了这个

```
<script src="script/jquery-3.6.0.min.js"></script> 
```

结果是它不起作用。它不会改变页面的背景颜色，这就是扩展的目的。

但有效的是，jQuery 仍然能够更改/操作扩展弹出“中”的元素。

# ruby - 如何对这个哈希值进行排序

> ID：12307114
> 
> 赞同：0
> 
> 时间：2012-09-06T19:33:24.147
> 
> 标签：ruby, hash

我正在努力对下面列出的这个哈希进行排序：

```
{
  17=>{:id=>17, :count=>1, :created_at=>Wed, 05 Sep 2012 19:02:34 UTC +00:00},
  14=>{:id=>14, :count=>2, :created_at=>Sun, 02 Sep 2012 19:20:28 UTC +00:00},
  9=>{:id=>9, :count=>0, :created_at=>Sun, 02 Sep 2012 17:09:35 UTC +00:00},
  10=>{:id=>10, :count=>2, :created_at=>Sat, 01 Sep 2012 17:09:56 UTC +00:00},
  11=>{:id=>11, :count=>0, :created_at=>Fri, 31 Aug 2012 19:13:57 UTC +00:00},
  12=>{:id=>12, :count=>2, :created_at=>Thu, 30 Aug 2012 19:19:32 UTC +00:00},
  13=>{:id=>13, :count=>0, :created_at=>Thu, 23 Aug 2012 19:20:09 UTC +00:00}
} 
```

上面的哈希应该被排序`count`并且`created_of`看起来像这个哈希：

```
{
  12=>{:id=>12, :count=>2, :created_at=>Thu, 30 Aug 2012 19:19:32 UTC +00:00},
  10=>{:id=>10, :count=>2, :created_at=>Sat, 01 Sep 2012 17:09:56 UTC +00:00},
  14=>{:id=>14, :count=>2, :created_at=>Sun, 02 Sep 2012 19:20:28 UTC +00:00},
  17=>{:id=>17, :count=>1, :created_at=>Wed, 05 Sep 2012 19:02:34 UTC +00:00},
  13=>{:id=>13, :count=>0, :created_at=>Thu, 23 Aug 2012 19:20:09 UTC +00:00},
  11=>{:id=>11, :count=>0, :created_at=>Fri, 31 Aug 2012 19:13:57 UTC +00:00},
  9=>{:id=>9, :count=>0, :created_at=>Sun, 02 Sep 2012 17:09:35 UTC +00:00}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T19:41:35.310

假设您使用的是 Ruby 1.9，其中哈希有顺序：

```
Hash[data.sort_by { |key, h| [-h[:count], h[:created_at]] }] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-06T19:42:26.190

在 Ruby 1.8 中，您不能对散列进行排序，因为散列没有顺序。在 Ruby 1.9 中，哈希迭代顺序由插入顺序定义。因此，您必须创建一个新的散列，您将在其中以正确的顺序插入元素。

```
sorted_keys = hash.keys.sort
sorted_hash = Hash.new
sorted_keys.each do |k|
  sorted_hash[k] = hash[k]
end 
```

# java - 如何使用 SWT 列表？

> ID：12307116
> 
> 赞同：1
> 
> 时间：2012-09-06T19:33:34.890
> 
> 标签：java, arraylist, swt

```
private ArrayList<PrinterProfile> printersList = null;
private ArrayList<PrinterProfile> printers = null;    

...

void Method() {
    ...
    printers = (ArrayList<PrinterProfile>) listOp.getPrinters();
    printersList.setListData(printers.toArray(new PrinterProfile[0]));
} 
```

`setListData`仅适用于`JList`但我正在使用 SWT 和`ArrayList`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T19:47:30.773

我认为您正在寻找的是 SWT [`List`](http://help.eclipse.org/helios/topic/org.eclipse.platform.doc.isv/reference/api/org/eclipse/swt/widgets/List.html)。你可以像这样使用它：

```
import java.util.ArrayList;
import java.util.Arrays;

import org.eclipse.swt.SWT;
import org.eclipse.swt.layout.GridLayout;
import org.eclipse.swt.widgets.Display;
import org.eclipse.swt.widgets.Event;
import org.eclipse.swt.widgets.List;
import org.eclipse.swt.widgets.Listener;
import org.eclipse.swt.widgets.Shell;

public class MiniExample {

    public static void main(String[] args) {
        Display display = Display.getDefault();
        final Shell shell = new Shell(display);
        shell.setLayout(new GridLayout(1, false));

        // Fill your ArrayList with its content
        ArrayList<String> printer = new ArrayList<String>();
        printer.add("Epson");
        printer.add("Canon");
        printer.add("HP");

        final List printerList = new List(shell, SWT.MULTI | SWT.BORDER);

        // Fill the ArrayList into the SWT List
        for(String print : printer)
            printerList.add(print);

        // Print selection
        printerList.addListener(SWT.Selection, new Listener() {
            @Override
            public void handleEvent(Event arg0) {
                if(printerList.getSelectionCount() > 0)
                    System.out.println(Arrays.toString(printerList.getSelection()));
            }
        });

        shell.pack();
        shell.open();
        while (!shell.isDisposed()) {
            if (!display.readAndDispatch())
                display.sleep();
        }
    }
} 
```

由于您在之前的问题中已经使用过 JFace 查看器，因此我建议您[`ListViewer`](http://help.eclipse.org/indigo/topic/org.eclipse.platform.doc.isv/reference/api/org/eclipse/jface/viewers/ListViewer.html)也在这里使用。

**注意**：

既然你已经熟悉了`TableViewer`，为什么不使用只有一列的`setHeaderVisible(false)`和`SWT.MULTI`作为样式呢？它基本上具有相同的效果。

# php - 是否可以限制 unix 中未压缩压缩文件的大小？

> ID：12307117
> 
> 赞同：1
> 
> 时间：2012-09-06T19:33:42.593
> 
> 标签：php, unix, unzip

我正在实施一项服务，我必须提取用户上传的 zip 文件。

为了避免磁盘溢出，我必须限制 zip 文件大小和解压缩文件大小。

在解压缩之前是否有这样做（检查解压缩文件的大小）？（出于安全原因）。

我正在使用从 PHP 脚本调用的 unix。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T20:12:08.613

由于您使用 PHP，请使用其[ZipArchive](http://php.net/manual/en/ref.zip.php)库。

```
$zip = zip_open($file);
$extracted_size = 0;
while (($zip_entry = zip_read($zip))) {
    $extracted_size += zip_entry_filesize($zip_entry);
    if ($extracted_size > $max_extracted_size) {
        // abort
    }
}
// do the actual unzipping 
```

您可能还想限制文件的数量，或者为每个文件添加一个恒定的数量，以考虑每个文件的元数据大小。虽然您无法轻易获得准确的数字，但将几百字节添加到每个文件的几千字节是一个合理的估计。

# javascript - 一列中的Highcharts值

> ID：12307118
> 
> 赞同：2
> 
> 时间：2012-09-06T19:33:43.253
> 
> 标签：javascript, jquery, highcharts

我想将条形图右侧显示的值*（34.4、21.8、20.1 等）*与图表的远端对齐，如下图所示：

原来的： ![原始图像](../Images/54feef507f3b95e6bc7b9a97f970fd2b.png)

所需的价值观右对齐： [![期望的](../Images/1425581baabd3cca32124ea4b8971df4.png)](https://i.stack.imgur.com/xRjZn.jpg)

我正在使用 HighCharts，我的代码是：

```
$(function () {
    var chart;
    $(document).ready(function() {
        chart = new Highcharts.Chart({
            chart: {
                renderTo: 'container',
                type: 'column',
                margin: [ 50, 50, 100, 80],
                inverted: true
            },
            title: {
                text: 'World\'s largest cities per 2008'
            },
            xAxis: {
                categories: [
                    'Tokyo',
                    'Jakarta',
                    'New York',
                    'Seoul',
                    'Manila',
                    'Mumbai',
                    'Sao Paulo',
                    'Mexico City',
                    'Dehli',
                    'Osaka',
                    'Cairo',
                    'Kolkata',
                    'Los Angeles',
                    'Shanghai',
                    'Moscow',
                    'Beijing',
                    'Buenos Aires',
                    'Guangzhou',
                    'Shenzhen',
                    'Istanbul'
                ],
                labels: {
                    rotation: 0,
                    align: 'right',
                    style: {
                        fontSize: '13px',
                        fontFamily: 'Verdana, sans-serif'
                    }
                }
            },
            yAxis: {
                min: 0,
                title: {
                    text: 'Population (millions)'
                }
            },
            legend: {
                enabled: false
            },
            tooltip: {
                formatter: function() {
                    return '<b>'+ this.x +'</b><br/>'+
                        'Population in 2008: '+ Highcharts.numberFormat(this.y, 1) +
                        ' millions';
                }
            },
                series: [{
                name: 'Population',
                data: [34.4, 21.8, 20.1, 20, 19.6, 19.5, 19.1, 18.4, 18,
                    17.3, 16.8, 15, 14.7, 14.5, 13.3, 12.8, 12.4, 11.8,
                    11.7, 11.2],
                dataLabels: {
                    enabled: true,
                    rotation: 0,
                    color: 'Black',
                    align: 'right',
                    //x: parseFloat(this.y) + 10,
                    x: 40,
                    y: 10,
                    formatter: function() {
                        return this.y;
                    },
                    style: {
                        fontSize: '13px',
                        fontFamily: 'Verdana, sans-serif'
                    }
                }
            }]
        });
    });
}); 
```

我在[这里有一个 jsFiddle](https://jsfiddle.net/SL68H/1/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T21:37:03.550

我认为使用它的 API 还不可能做到这一点。
但是下面的代码可以为你做到这一点：

//`#container`是您的图表容器 ID

```
$('#container .highcharts-data-labels g').attr('transform', function(i, value) {
    return value.replace(/\d+/, chart.containerWidth - 150);
}); 
```

如果您检查图表内容，您会看到每个标签都有`transform`attr，这是用于将标签放入图表中的，因此上面的代码替换了`x`它的 attr 的第一个参数（）。

[**演示**](http://jsfiddle.net/SL68H/12/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-07T21:54:38.410

我必须为我的一个项目这样做。这是小提琴。[http://jsfiddle.net/kashyap02004/veJ38/](http://jsfiddle.net/kashyap02004/veJ38/)。

基本上你必须像这样渲染值：

```
$('#container').highcharts({
    chart: {
        type: 'bar'
    },
    title: {
        text: 'Historic World Population by Region'
    },
    subtitle: {
        text: 'Source: Wikipedia.org'
    },
    xAxis: {
        categories: ['Africa', 'America', 'Asia', 'Europe', 'Oceania'],
        title: {
            text: null
        }
    },
    yAxis: {
        min: 0,
        title: {
            text: 'Population (millions)',
            align: 'high'
        },
        labels: {
            overflow: 'justify'
        }
    },
    tooltip: {
        valueSuffix: ' millions'
    },
    plotOptions: {
        bar: {
            dataLabels: {
                enabled: false
            }
        }
    },
    credits: {
        enabled: false
    },
    series: [{
        name: 'Year 1800',
        data: [107, 31, 645, 203, 20]
    }]
}, 
```

// 这就是所有魔法发生的地方

```
function (chart) {
    for (var i = 0; i < chart.series[0].data.length; i++) {
        var point = chart.series[0].data[i];

        var text = chart.renderer.text(
        point.y, // you can display any property on that object.
        //tweek these values to align it
        chart.plotLeft + chart.plotSizeY - 30,
        chart.plotHeight - point.barX + 45).attr({
            zIndex: 5,
            fill: '#666679',
        }).add();
    }
}); 
```

# c++ - QGraphicsScene::items 不返回给定矩形的项目

> ID：12307119
> 
> 赞同：2
> 
> 时间：2012-09-06T19:33:54.040
> 
> 标签：c++, qt, qgraphicsitem, qgraphicsscene

我想选择某个区域内的所有项目并更改它们的不透明度。我曾经`QGraphicsScene::items()`这样做过，但我似乎无法让它返回任何物品。一个例子：

```
#include "MainWindow.h"
#include "ui_MainWindow.h"

#include <QDebug>
#include <QKeyEvent>
#include <QGraphicsPixmapItem>

MainWindow::MainWindow(QWidget *parent) :
    QMainWindow(parent),
    ui(new Ui::MainWindow)
  , scene(new QGraphicsScene())
{
    ui->setupUi(this);

    ui->graphicsView->setScene(scene);
    ui->graphicsView->installEventFilter(this);
    ui->graphicsView->show();

    for (int y = 0; y < 20; ++y) {
        for (int x = 0; x < 20; ++x) {
            QPixmap pixmap("desert.png");
            QGraphicsPixmapItem* newItem(scene->addPixmap(pixmap));
            newItem->setPos(x * 25, y * 25);
            newItem->setOpacity(0.0);
            qDebug() << newItem;
        }
    }
}

MainWindow::~MainWindow()
{
    delete ui;
    delete scene;
}

bool MainWindow::eventFilter(QObject *obj, QEvent *event)
{
    if(event->type() == QEvent::KeyPress) {
        QKeyEvent *keyEvent = static_cast<QKeyEvent*>(event);
        if (keyEvent->key() == Qt::Key_Space) {
            QRectF rect(0, 0, 25 * 3, 25 * 3);
            QList<QGraphicsItem*> items(scene->items(rect, Qt::ContainsItemBoundingRect, Qt::AscendingOrder));
            qDebug() << items;
            foreach (QGraphicsItem *item, items) {
                item->setOpacity(1.0);
            }
        }
        return true;
    }
    return QObject::eventFilter(obj, event);
} 
```

我很确定我不需要提供`deviceTransform`参数，而且我知道我传入的矩形应该覆盖 9 个图块。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T20:22:28.193

创建项目时，您已经将它们的不透明度设置为 0，因此它们不可见 - items() 仅返回可见项目，请参阅[http://qt-project.org/doc/qt-4.8/qgraphicsscene.html#items- 10](http://qt-project.org/doc/qt-4.8/qgraphicsscene.html#items-10)：

> 返回所有**可见**项目...

在构造函数中将不透明度设置为 > 0 的值，例如

```
newItem->setOpacity(0.001); 
```

现在按下空格键时，将出现给定矩形中的四个项目。

# wordpress - Wordpress 菜单未显示在主页上

> ID：12307125
> 
> 赞同：0
> 
> 时间：2012-09-06T19:34:17.367
> 
> 标签：wordpress, themes

有以下问题。在稍微定制的 211 版本中，我无法在主页上显示菜单。
主页显示最新帖子。菜单在所有页面（帖子、页面、自定义页面）中都可以正常工作，但在主页上却不行。但在主页上，它显示了指向我拥有的页面的链接。所有页面的头文件都相同，包含：

```
<?php wp_nav_menu(); ?> 
```

添加`$args`和`"menu_id"=>10 /* menu id here */`/或`"menu"=>"mymenu"`。
将主页类型更改为某些页面会使菜单工作，而使用一些不同的文件（如单个或页面）`index.php`则不会。可能原因在某个地方。研究过 wp-admin 并用谷歌搜索。
请帮我。

```
<?php
/**
 * The Header for our theme.
 *
 * Displays all of the <head> section and everything up till <div id="main">
 *
 * @package WordPress
 * @subpackage iwtech
 * @since iwtech.ru theme 1.0
 */
?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title><?php
    global $page, $paged;
    wp_title( '|', true, 'right' );
    bloginfo( 'name' );
    $site_description = get_bloginfo( 'description', 'display' );
    if ( $site_description && ( is_home() || is_front_page() ) )
        echo " | $site_description";
// Add a page number if necessary:
    if ( $paged >= 2 || $page >= 2 )
        echo ' | ' . sprintf( __( 'Page %s', 'iwtech' ), max( $paged, $page ) );
    ?>
</title>
<link rel="stylesheet" type="text/css" media="all" href="<?php bloginfo( 'template_directory' ); ?>/styles.css">
<link rel="stylesheet" type="text/css" media="all" href="<?php bloginfo( 'template_directory' ); ?>/n-corr.css">
<script type="text/JavaScript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<link rel="pingback" href="<?php bloginfo( 'pingback_url' ); ?>" >
<?php
if ( is_singular() && get_option( 'thread_comments' ) )
    wp_enqueue_script( 'comment-reply' );
?>
<?php if (isset($_POST['s2_admin'])): ?>
    <script type="text/javascript">
    document.location.reload(true)
    </script>
<?php endif; ?>
<?php 
wp_head();
?>
</head>
<body <?php body_class(); ?>>
    <div id="header">
        <?php 
        wp_nav_menu(); ?>
    </div>
</div>
<div id="wrapper"> 
```

明白了！

```
 function my_get_posts( $query ) {
    if ( is_home() )
        $query->set( 'post_type', array( 'post',  'albums', 'artists', 'clips', 'events' ) );

    return $query;
}
add_filter( 'pre_get_posts', 'my_get_posts' ); 
```

这个功能`functions.php`破坏了`navmenu`.

但我需要这样的东西才能在主页上拥有自定义帖子类型，而不仅仅是帖子。我该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T07:47:01.533

所以，最后我发现这应该是代码：

```
function my_get_posts( $query ) {
    if ( $query->is_main_query() and is_home() ) {
        $query->set( 'post_type', array( 'post',  'albums', 'artists', 'clips', 'events', 'quote', 'attachment' ) );
    }
    return $query;
}
add_filter( 'pre_get_posts', 'my_get_posts' ); 
```

希望，这对其他人有用:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-30T05:10:22.617

试试这个代码..希望能有所帮助

```
add_filter( 'pre_get_posts', 'my_get_posts' );
function my_get_posts( $query ) {

 if ( ( is_home() && false == $query->query_vars['suppress_filters'] )  ) {
    $query->set( 'post',  'albums', 'artists', 'clips', 'events', 'quote', 'attachment' ) );

return $query;
}
} 
```

# visual-studio-2010 - 是否可以在 TFS 中比较文件的两个修订版？

> ID：12307130
> 
> 赞同：3
> 
> 时间：2012-09-06T19:34:19.417
> 
> 标签：visual-studio-2010, version-control, tfs

我对 TFS 有点陌生。对于我使用过的所有其他源代码控制，一个非常简单的常见操作是比较两个不同的版本。假设您有 3 个修订版。修订版 3 是我当前的本地副本。修订版 2（或其他）引入了一些回归。所以，我需要看看从第 1 版到第 2 版的变化。我不关心第 3 版的变化。

我如何在 TFS 中执行此操作？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-06T19:49:08.540

如果您使用源代码浏览器对文件“查看历史记录”，您将看到 TFS 中的版本列表。然后您可以选择两个版本。然后右键单击以比较两个版本。

![使用 TFS 历史比较文件版本](../Images/42212a160e9e55bd9a544ed686136d2d.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-06T19:44:01.120

您可以右键单击文件，然后单击“比较...”。

在那里您可以设置相同的服务器路径（例如“$/Project/Main/File.cs”）并使用变更集“类型：”并在源和目标上设置变更集 ID。

![比较](../Images/ba92d5b0e71e15a938ce3204c6aea4b2.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-06T20:08:21.543

实际上，我非常喜欢 TFS 的一件事是比较各种文件版本的灵活性（我承认，我喜欢这种灵活性，但实际的比较工具？没那么多）。

您必须原谅任何错误，自从我使用 TFS 以来已经有一段时间了，但我仍然记得大致的想法。

在解决方案资源管理器中，如果您右键单击文件并单击比较，您将看到比较对话框。从这里您选择要比较的两个文件。确保它们都指向服务器版本路径。

在“类型：”下拉列表中的“源版本：”下，选择“变更集”（如果您有足够的信心，也可以选择“日期”）。您应该看到一个省略号，允许您搜索变更集。您现在可以从历史记录中选择您的变更集（您可能需要按“查找”按钮或其他东西，我记不得了）。选择您的修订版 1（无论是什么变更集 id）并从变更集选择中选择“ok”。

如果目标路径指向本地文件，“目标版本”框架将被禁用（对于“源版本”和“源路径”也是如此）。因此，请确保您的路径都指向服务器版本。

在类型：下拉列表中的“目标版本：”下，还选择“变更集”。现在使用与上述相同的步骤，选择修订版 2 变更集。

最后点击“比较”，尽情享受吧！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-06T19:50:53.293

如果您在 Visual Studio 中使用团队资源管理器，您可以转到源代码管理资源管理器窗口并选择一个文件，然后查看历史记录。选择2个版本，右键比较。

# mysql - 可预约

> ID：12307133
> 
> 赞同：0
> 
> 时间：2012-09-06T19:34:31.757
> 
> 标签：mysql

我有两个mysql表，日程表和约会。在日程表中有定义的医生终端，而在其他有预约的预约。问题是医生总是可以更改他的终端，我不能在约会表中粘贴参考，我只想在一个 mysql 查询中为两位医生获取可用的终端。那可能吗？

```
CREATE TABLE `schedule` (
  `id` int(11) unsigned NOT NULL AUTO_INCREMENT,
  `from` timestamp NULL DEFAULT NULL,
  `to` timestamp NULL DEFAULT NULL,
  `doctor_id` int(11) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=9 DEFAULT CHARSET=latin1;

INSERT INTO `schedule` (`id`, `from`, `to`, `doctor_id`)
VALUES
    (1, '2012-09-06 14:00:00', '2012-09-06 14:59:59', 1),
    (2, '2012-09-06 15:00:00', '2012-09-06 15:59:59', 1),
    (3, '2012-09-06 16:00:00', '2012-09-06 16:59:59', 1),
    (4, '2012-09-06 17:00:00', '2012-09-06 17:59:59', 1),
    (5, '2012-09-06 14:00:00', '2012-09-06 14:59:59', 2),
    (6, '2012-09-06 15:00:00', '2012-09-06 15:59:59', 2),
    (7, '2012-09-06 16:00:00', '2012-09-06 16:59:59', 2),
    (8, '2012-09-06 17:00:00', '2012-09-06 17:59:59', 2);

CREATE TABLE `appointments` (
  `id` int(11) unsigned NOT NULL AUTO_INCREMENT,
  `from` timestamp NULL DEFAULT NULL,
  `to` timestamp NULL DEFAULT NULL,
  `doctor_id` int(11) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=9 DEFAULT CHARSET=latin1;

INSERT INTO `appointments` (`id`, `from`, `to`, `doctor_id`)
VALUES
    (3, '2012-09-06 16:00:00', '2012-09-06 16:59:59', 1),
    (4, '2012-09-06 17:00:00', '2012-09-06 17:59:59', 1),
    (5, '2012-09-06 14:00:00', '2012-09-06 14:59:59', 2),
    (8, '2012-09-06 17:00:00', '2012-09-06 17:59:59', 2); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T20:15:36.600

如果保证约会 id 将等于计划 id，则：

```
select `id`,`from`,`to`,`doctor_id`
from schedule
where `id` not in 
(select `id` from appointments)
order by `doctor_id`,`from` 
```

[Sqlfiddle](http://sqlfiddle.com/#!2/1538e/22)

如果不能保证约会 id 被链接，那么：

```
select `id`,`from`,`to`,`doctor_id`
from schedule
where `id` not in 
(select `t1`.`id` 
from(
select `s`.`id`,`s`.`from`,`s`.`to`,`s`.`doctor_id` 
from schedule as s 
inner join 
appointments as a
on `s`.`doctor_id`=`a`.`doctor_id`
and `s`.`from`=`a`.`from`
and `s`.`to`=`a`.`to`)
as t1) 
```

[Sqlfiddle](http://sqlfiddle.com/#!2/1538e/21)

# facebook - 文章页面的 Facebook 点赞按钮和 Facebook 页面的点赞按钮未正确显示

> ID：12307134
> 
> 赞同：1
> 
> 时间：2012-09-06T19:34:39.260
> 
> 标签：facebook, facebook-like, sharing

我的全文页面上有一个类似 facebook 的按钮，但我也希望在标题的某处有一个类似 facebook 的按钮，它可以让我们喜欢我们的“Facebook 页面”，并且与我们网站上的文章无关，通过喜欢实际的帖子并分享它。

我使用 sharethis 作为文章页面的“赞”按钮以及我们所有的分享，但我也有一个单独的区域，它只是一个赞按钮，供用户赞我们的“Facebook 页面”。

出于某种原因，页面加载时。有时没有一个类似的按钮出现，或者有时只出现一个，而另一个不存在。

任何意见或建议将不胜感激。谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T21:34:03.063

您的页面上可以有多个不同的点赞按钮，它们点赞不同的 URL（例如您的文章页面和主页。）

为此，只需在不同的 Like 按钮中指定不同的 href 参数。这是一个 iframe 示例：

```
<iframe
  src="http://www.facebook.com/plugins/like.php?href=http%3A%2F%2Fwww.yourpageurl.com&amp;send=false&amp;layout=button_count&amp;width=100&amp;show_faces=false&amp;action=like&amp;colorscheme=light&amp;font&amp;height=21"
  scrolling="no" frameborder="0"
  style="border:none; overflow:hidden; width:100px; height:21px;"
  allowTransparency="true">
</iframe> 
```

Like 按钮的 href 参数用于指定 Like 操作绑定到哪个页面，它可以与您当前所在的页面不同。

除非您发布一些代码，否则我们无法轻松帮助您找出按钮不显示的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T19:41:18.640

转到：http: [//developers.facebook.com/docs/reference/plugins/like/](http://developers.facebook.com/docs/reference/plugins/like/)

编写 facebook 页面 url 获取代码，然后将其粘贴到您的网站上

# unix - awk 字段分隔符，当分隔符出现在双引号中时

> ID：12307135
> 
> 赞同：3
> 
> 时间：2012-09-06T19:34:40.937
> 
> 标签：unix, awk, field, delimiter

我正在尝试使用 awk 在 3、$3 的字段位置读取一些输入，字段 3 是一个字符串

```
awk -F'","' '{print $1}'  input.txt 
```

我的文件*input.txt*看起来像这样

```
field1,field2,field3,field4,field5 
```

问题是这些字段用逗号分隔，其中一些是双引号，而另一些则不是。字段 5 是双引号，包含各种类型的符号。例子：

```
imfield1,imfield2,"imfield3",imfield4,"im"",""fi"",el,""d5" 
```

awk 可以处理这样的情况吗？更详细地说，如何通过键入 $5 来获取整个字符串？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T20:03:29.120

您可以使用[Lorance Stinson 的 Awk CSV parser](http://lorance.freeshell.org/csv/)，在这种情况下，它很简单：

```
function parse_csv(..) {
    ..
}

{
    num_fields = parse_csv($0, csv, ",", "\"", "\"", "\\n", 1);
    print csv[2]
} 
```

如果你不喜欢 Awk，Python 还带有一个不错的 CSV 解析器：

```
import csv, sys

for row in csv.reader(sys.stdin):
    print row[2] 
```

或者从命令行（一行有点棘手）：

```
python -c 'import csv,sys;[sys.stdout.write(row[2]+"\n") for row in csv.reader(sys.stdin)]' < input.txt 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T19:55:51.863

分隔符是一个简单的逗号，而不是引号之间的逗号。如果字段不包含逗号，那么 awk 可能会胜任这项任务：

```
awk -F , '
  {
    if ($3 ~ /^".*"$/) {
        $3 = substr($3, 2, length($3)-2);
        gsub(/""/, "", $3);
     }
     print $3;
  }' input.txt 
```

这已经变得相当复杂了。如果字段内可以有逗号，请使用适当的 CSV 解析器，例如在 Perl 或 Python 中。请参阅[https://unix.stackexchange.com/questions/7425/is-there-a-robust-command-line-tool-for-processing-csv-files](https://unix.stackexchange.com/questions/7425/is-there-a-robust-command-line-tool-for-processing-csv-files)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T15:16:25.823

`awk`您可以在设置空字段分隔符时解析该行。而不是`printf("%s",$i)`你可以分配`$i`给一个 var 并在什么时候打印出来`inda==0`

```
#echo "\"AAA,BBB\",\"CCC\",\"DDD, EEE, FFF\"" > uno

awk 'BEGIN { FS="" }
{
    for ( i=1; i<NF; i++) {
        if ( $i == "\"" )
            if ( inda == 0 ) 
                inda = 1
            else
                inda = 0
        if ( $i == "," )
            if ( inda == 0 )
                $i="|"
        printf("%s",$i)
    }
    printf("\n")
}' uno 
```

# r - if/while（条件）{ 中的错误：参数的长度为零

> ID：12307139
> 
> 赞同：34
> 
> 时间：2012-09-06T19:34:53.343
> 
> 标签：r, r-faq

我收到了错误

```
Error in if (condition) { : argument is of length zero 
```

或者

```
Error in while (condition) { : argument is of length zero 
```

**导致此错误消息的原因是什么，它是什么意思？**

经过进一步检查，该值似乎是`NULL`。

```
condition
## NULL 
```

**为了处理这个错误，我如何测试 NULL 值？**

我预计这会返回`TRUE`，但我得到了一个空的逻辑值：

```
condition == NULL
## logical(0) 
```

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-09-06T19:37:11.503

看`?NULL`

你必须使用`is.null`

> 'is.null' 如果其参数为 'NULL' 则返回 'TRUE'，否则返回 'FALSE'。

尝试这个：

```
if ( is.null(hic.data[[z]]) ) { print("is null")} 
```

* * *

来自[R 语言定义的第 2.1.6 节](http://cran.r-project.org/doc/manuals/R-lang.pdf)

> 有一个特殊的对象叫做 NULL。每当需要指示或指定对象不存在时使用它。它不应与零长度的向量或列表相混淆。NULL 对象没有类型，也没有可修改的属性。R 中只有一个 NULL 对象，所有实例都引用它。要测试 NULL，请使用 is.null。您不能在 NULL 上设置属性。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2014-12-21T11:52:05.740

**导致此错误消息的原因是什么，它是什么意思？**

`if`语句将单个逻辑值（技术上是长度为 1 的逻辑向量）作为条件的输入。

当输入条件的长度为零时引发错误。您可以使用以下方法重现它：

```
if (logical()) {}
## Error: argument is of length zero

if (NULL) {}
## Error: argument is of length zero 
```

* * *

**导致此错误的常见错误**

`$`使用索引时很容易意外导致此错误。例如：

```
l <- list(a = TRUE, b = FALSE, c = NA)
if(l$d) {}   
## Error in if (l$d) { : argument is of length zero 
```

也[使用`if`-`else`当你的意思`ifelse`](https://stackoverflow.com/q/17252905/134830)，或[覆盖`T`and`F`](https://stackoverflow.com/a/6150337/134830)。

* * *

请注意其他不良情况的这些相关错误和警告：

[if/while（条件）错误{：缺少需要 TRUE/FALSE 的值](https://stackoverflow.com/q/7355187/134830)

[if/while（条件）中的错误：参数不能解释为逻辑](https://stackoverflow.com/q/27659841/134830)

```
if (NA) {}
## Error: missing value where TRUE/FALSE needed

if ("not logical") {}
## Error: argument is not interpretable as logical

if (c(TRUE, FALSE)) {}
## Warning message:
## the condition has length > 1 and only the first element will be used 
```

* * *

**如何测试这些值？**

[`NULL`](https://www.rdocumentation.org/packages/base/topics/NULL)值可以测试使用`is.null`。有关更多详细信息，请参阅[GSee 的答案](https://stackoverflow.com/a/12307158/134830)。

为了让您调用`if`安全，一个好的代码模式是：

```
if(!is.null(condition) && 
   length(condition) == 1 && 
   !is.na(condition) && 
   condition) {
  # do something
} 
```

您可能还想[`assert_is_if_condition`](https://www.rdocumentation.org/packages/assertive.code/topics/assert_is_if_condition)从`assertive.code`.

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-09-06T19:37:24.033

测试 NULL 值时，您希望使用`is.null(hic.data[[z]])`.

# c# - 详情查看更新

> ID：12307142
> 
> 赞同：1
> 
> 时间：2012-09-06T19:35:15.767
> 
> 标签：c#, asp.net, sql, detailsview

我有一个显示所有注册用户及其一些信息的 GridView，当您选择侧面的“选择”链接时，它会显示一个包含与该用户相关的所有详细信息的 DetailsView。选择工作正常并更新所选用户的详细信息视图，当我尝试编辑 DetailsView 时，它将更新数据库并在更改字段时填写为所有用户更新的信息（例如，如果我更改客户名字，每个注册的人都会得到这个名字）。这是我的 SqlDataSource 的 aspx 代码：

```
<asp:SqlDataSource ID="SqlDataSource1" runat="server" 
        ConnectionString="<%$ ConnectionStrings:ApplicationServices %>" OldValuesParameterFormatString="original_{0}" 
        SelectCommand="SELECT * FROM [UserProfile] ORDER BY [Email], [LastName], [Company]"
        UpdateCommand="UPDATE [UserProfile] SET [LastName] = @LastName, [PartsList] = @PartsList, [UserName] = @UserName, [Question] = @Question, 
                      [Answer] = @Answer, [Role] = @Role 
                      WHERE [FirstName] = FirstName AND [Company] = Company">
            <UpdateParameters>
                <asp:Parameter Name="FirstName" Type="String" />
                <asp:Parameter Name="LastName" Type="String" />
                <asp:Parameter Name="Company" Type="String" />
                <asp:Parameter Name="PartsList" Type="String" />
                <asp:Parameter Name="UserName" Type="String" />
                <asp:Parameter Name="Password" Type="String" />
                <asp:Parameter Name="Email" Type="String" />
                <asp:Parameter Name="Question" Type="String" />
                <asp:Parameter Name="Answer" Type="String" />
                <asp:Parameter Name="Role" Type="String" />                    
            </UpdateParameters>
    </asp:SqlDataSource> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T19:52:20.463

你忘`@original_`了你的`Where`参数

将 UpdateCommand 更改为：

`UPDATE [UserProfile] SET [LastName] = @LastName, [PartsList] = @PartsList, [UserName] = @UserName, [Question] = @Question, [Answer] = @Answer, [Role] = @Role WHERE [FirstName] = @original_FirstName AND [Company] = @original_Company`

# google-tv - 我应该使用 32 位还是 64 位 Ubuntu 进行 Google TV 开发？

> ID：12307144
> 
> 赞同：0
> 
> 时间：2012-09-06T19:35:22.050
> 
> 标签：google-tv

我刚买了一台装有 Win7 的机器，并且会设置双启动到 Ubuntu 12。我的问题是我应该选择 32 位还是 64 位？有关系吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T19:39:45.673

我会选择64位系统。这是因为越来越多的系统转向 64 位模型，也因为您可以在 64 位系统上同时进行 32 位和 64 位开发。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T21:31:16.213

> [https://developers.google.com/tv/android/docs/gtv_setup_android](https://developers.google.com/tv/android/docs/gtv_setup_android)

```
Operating Systems

Windows XP (32-bit), Vista (32- or 64-bit), or Windows 7 (32- or 64-bit)
Mac OS X 10.5.8 or later (x86 only)
Linux (tested on Ubuntu Linux, Lucid Lynx)
GNU C Library (glibc) 2.7 or later is required.
On Ubuntu Linux, version 8.04 or later is required.
64-bit distributions must be capable of running 32-bit applications.
Eclipse IDE

Eclipse 3.6.2 (Helios) or greater
Note: Eclipse 3.5 (Galileo) is no longer supported with the latest version of ADT.
Eclipse JDT plugin (included in most Eclipse IDE packages)
JDK 6 (JRE alone is not sufficient)
Android Development Tools plugin (recommended)
Not compatible with Gnu Compiler for Java (gcj)
Other development environments

JDK 6 (JRE alone is not sufficient)
Apache Ant 1.8 or later
Not compatible with Gnu Compiler for Java (gcj)
Note: Some Linux distributions may include JDK 1.4 or Gnu Compiler for Java, both of which are not supported for Android development. 
```

# wpf - 多个绑定到 IsEnable

> ID：12307148
> 
> 赞同：9
> 
> 时间：2012-09-06T19:36:07.217
> 
> 标签：wpf, textbox, contentcontrol, isenabled

我需要绑定一个`TextBox`满足两个条件的：

*   IsEnabled 如果 Text.Length > 0
*   IsEnabled 如果 user.IsEnabled

`user.IsEnabled`从数据源中提取的位置。我想知道是否有人有一个简单的方法来做到这一点。

这是 XAML：

```
<ContentControl IsEnabled="{Binding Path=Enabled, Source={StaticResource UserInfo}}"> 
    <TextBox DataContext="{DynamicResource UserInfo}" Text="{Binding FirstName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" IsEnabled="{Binding Path=Text, RelativeSource={RelativeSource Self}, Converter={StaticResource LengthToBool}}"/> 
</ContentControl> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-06T20:02:48.590

正如 GazTheDestroyer 所说，您可以使用 MultiBinding。

[您还可以使用 MultiDataTrigger 使用纯 XAML 解决方案来完成此操作](http://msdn.microsoft.com/en-us/library/system.windows.multidatatrigger.aspx)

但是你应该切换条件，因为触发器只支持相等

```
<Style.Triggers>  
  <MultiDataTrigger>
        <MultiDataTrigger.Conditions>
          <Condition Binding="{Binding RelativeSource={RelativeSource Self}, Path=Text.Length}" Value="0" />
          <Condition Binding="{Binding Source=... Path=IsEnabled}" Value="False" />
        </MultiDataTrigger.Conditions>
        <Setter Property="IsEnabled" Value="False" />
      </MultiDataTrigger>  
</Style.Triggers> 
```

如果不满足其中一个条件，则将值设置为其默认值或样式中的值。但不要设置本地值，因为它会覆盖样式和触发器的值。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-06T20:24:09.040

由于您只需要一个逻辑`OR`，因此您的每个属性只需要两个触发器。

试试这个 XAML：

```
<StackPanel>
        <StackPanel.Resources>
            <Style TargetType="{x:Type Button}">
                <Style.Triggers>
                    <DataTrigger Binding="{Binding ElementName=InputText, Path=Text}" Value="" >
                        <Setter Property="IsEnabled" Value="False" />
                    </DataTrigger>
                    <DataTrigger Binding="{Binding Path=MyIsEnabled}" Value="False" >
                        <Setter Property="IsEnabled" Value="False" />
                    </DataTrigger>
                </Style.Triggers>
            </Style>
        </StackPanel.Resources>
        <StackPanel Orientation="Horizontal">
            <Label>MyIsEnabled</Label>
            <CheckBox IsChecked="{Binding Path=MyIsEnabled}" />
        </StackPanel>
        <TextBox Name="InputText">A block of text.</TextBox>
        <Button Name="TheButton" Content="A big button.">     
        </Button>
    </StackPanel> 
```

我设置`DataContext`为`Window`有一个`DependencyProperty`被调用的类`MyIsEnabled`。显然，您必须针对您的特定`DataContext`.

这是相关的代码隐藏：

```
public bool MyIsEnabled
{
    get { return (bool)GetValue(IsEnabledProperty); }
    set { SetValue(IsEnabledProperty, value); }
}

public static readonly DependencyProperty MyIsEnabledProperty =
    DependencyProperty.Register("MyIsEnabled", typeof(bool), typeof(MainWindow), new UIPropertyMetadata(true));

public MainWindow()
{
    InitializeComponent();
    this.DataContext = this;
} 
```

希望有帮助！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-06T19:39:01.410

`IsEnabled`使用[MultiBinding](http://msdn.microsoft.com/en-us/library/system.windows.data.multibinding.aspx)绑定

# r - 合并的 xts 对象未对齐

> ID：12307156
> 
> 赞同：4
> 
> 时间：2012-09-06T19:37:04.527
> 
> 标签：r, xts

请尝试以下代码：

```
library(quantmod)
getSymbols('SPY', from = '1950-01-01')
SPY <- to.monthly(SPY)
temp <- xts(Cl(SPY), index(SPY)) 
```

您将获得一个`xts`具有相同长度`Cl(SPY)`和相同日期的对象......或者**应该是**这样。

如果你输入

```
merge(Cl(SPY), temp) 
```

您会看到，虽然`Cl(SPY)`和`temp`具有相同的索引日期，但它们没有对齐，代码会产生双精度数和很多`NA`s。

我怎样才能以正确的方式合并它们？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-06T19:48:32.037

这已在 R-Forge 上的 xts 中修复。如果您在从 R-Forge 安装 xts 时遇到问题，请参阅[无法使用 install.packages 安装 R-forge 包。](https://stackoverflow.com/questions/11105131/cannot-install-r-forge-package-using-install-packages)

```
install.packages("xts", repos="http://r-forge.r-project.org")

library(quantmod)
getSymbols('SPY', from = '1950-01-01')
SPY <- to.monthly(SPY)
temp <- xts(Cl(SPY), index(SPY))
merge(Cl(SPY),temp) 
```

# sed - Sed - 大写以点结尾的字符串的第一个字符

> ID：12307160
> 
> 赞同：1
> 
> 时间：2012-09-06T19:37:15.267
> 
> 标签：sed

我需要大写（无论字符串的大小（4、3、2 或 1））以点结尾的字符串。但是，不以点阵结尾的字符串保持小写。

这 3 个命令能够完成我需要的操作，但是 1-char 字符串以点结尾，2-char 字符串以点结尾。

```
sed -i -e "/<b>/ {s/\.\([^ ]\)/. \1/g}" file
sed -i -e "/<b>/ {s/\( [a-z]\.\)/\U\1/g}" file
sed -i -e "/<b>/ {s/\([a-z][^ ]\.\)/\u&/g}" file 
```

按照我的流，我认为这样做（如下）非常有意义，但它没有\没有\工作，并使 3-char 字符串看起来像这样：`YEs.`和 4-char 字符串像`HAHa.`

```
sed -i -e "/<b>/ {s/\([a-z][^ ][^ ]\.\)/\u&/g}" file 
```

有人可以帮忙吗？：p（如果可能的话，指出我做错了什么）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T19:47:40.547

这似乎做你想做的事：

```
sed '/<b>/{s/[a-z]*\./\u&/}' input 
```

在您的情况下，`[a-z][^ ][^ ]\.`仅匹配 3 个或更多字母。`[^ ]`您可以使用`*`使它们成为可选的，而不是强制存在's：`[a-z][^ ]*`

# c - C从dll写入文件，在应用程序中打开文件

> ID：12307161
> 
> 赞同：2
> 
> 时间：2012-09-06T19:37:15.087
> 
> 标签：c, dll, printf

我有一个从 dll 导出的文件指针，它由应用程序初始化（fopen），然后在 dll 中使用（fprintf）。

问题是 fprintf 会抛出异常。

**DLL文件.c**

```
#define BUILD_FOO
#include "API.H"

File *pFile;

void exportedFunction()
{
   fprintf(pFile,"This will result in an exception\n");//<-This print will crash
} 
```

**API.H**

```
#ifdef BUILD_FOO
#    define FOOAPI __declspec(dllexport)
#else
#    define FOOAPI __declspec(dllimport)
#endif

FOOAPI  extern File *pFile;
FOOAPI  void exportedFunction(); 
```

**应用程序.C**

```
#undef BUILD_FOO
#include "API.H"
void main()
{
pFile = fopen("path_to_folder","wt");
fprintf(pFile , "This print will work"); // <- This will be printed ok
exportedFunction(); 
} 
```

1 从我所做的调试来看，这就是我所看到的：

在**应用程序内部， fopen()**为**pFile**分配 一个来自**_iob[]**的元素。

在调用**fprintf的****DLL**中，检查**pFile**是否是**_iob[]**的一部分，但应用程序中的**_iob[]**似乎与 DLL 中的不一样（它们具有不同的地址）。

 ******2 我有相同的用例（使用相同的应用程序）和另一个有点相似的 DLL，那里一切正常（_iob[] 在应用程序和 DLL 中的相同位置）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T19:51:38.943

这可能是由于您的应用程序和您的 DLL[不同意他们使用的 C 运行时版本](http://blogs.msdn.com/b/oldnewthing/archive/2006/09/15/755966.aspx)。除非它们都是针对**完全相同**版本的 C 运行时编译的，否则所有的赌注都没有，并且您不能使用来自另一个的数据从一个调用 CRT 函数，反之亦然。

避免此问题的最安全方法是不要`FILE*`跨 DLL 边界传递指针。这样，与 a 的任何交互`FILE*`都将始终使用相同版本的 CRT 进行，并且不存在任何不匹配的危险。所以你的 DLL 不应该暴露一个`FILE*`变量；相反，它应该是一些不透明的类型，并且对变量的所有操作都需要在同一个模块中发生。

例如：

```
// API.h
FOOAPI void set_file(void *file);
FOOAPI void set_fprintf_callback(int (*my_fprintf)(void *, const char *, ...));
FOOAPI void exportedFunction();

// DLLFile.c
void *pFile;  // Not exported
int (*fprintf_callback)(void *, const char *, ...);  // Not exported

FOOAPI set_file(void *file)
{
    pFile = file;
}

FOOAPI set_fprintf_callback(int (*my_fprintf)(void *, const char *, ...))
{
    fprintf_callback = my_fprintf;
}

FOOAPI exportedFunction()
{
    // Call back into the application to do the actual fprintf
    fprintf_callback(pFile, "This should not crash");
}

// Application.c
int mydll_fprintf(void *pFile, const char *fmt, ...)
{
    va_list ap;
    va_start(ap, fmt);
    int result = vfprintf((FILE *)pFile, fmt, ap);
    va_end(ap);

    return result;
}

int main()
{
    FILE *pFile = fopen(...);
    set_file(pFile);
    set_fprintf_callback(&mydll_fprintf);
    exportedFunction();

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T19:40:20.403

让应用程序向 DLL 传递一个回调，并在该回调中让应用程序写入文件。******

# android - 在每个活动中进行 Flurry 分析？

> ID：12307163
> 
> 赞同：5
> 
> 时间：2012-09-06T19:37:22.627
> 
> 标签：android, android-activity, flurry

我想在我的 android 应用程序中集成 Flurry 分析，它看起来非常简单。但我不熟悉乱舞和它是如何工作的。

我应该添加代码：

```
public void onStart()
{
super.onStart();
FlurryAgent.onStartSession(sample, “APIXXXXXXXXXXXX”);

} 
```

在每一项活动中？

我的应用程序使用了很多活动，我并不关心跟踪使用了哪些活动，只关心安装数量、会话和会话长度。但是，如果只在启动活动中添加乱舞代码，会话长度是否可用？

我知道我想要的大部分信息已经在 Play 商店中可用，但我想尝试一下以了解不同平台上的应用程序。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-06T20:21:40.867

这是一个很好的答案：[https ://stackoverflow.com/a/8062568/1635817](https://stackoverflow.com/a/8062568/1635817)

我建议你创建一个“BaseActivity”并告诉你所有的活动来扩展它，这样你就不必在每个活动类中复制/粘贴这些行。

像这样的东西：

```
public class BaseActivity extends Activity
{
    public void onStart()
    {
       super.onStart();
       FlurryAgent.onStartSession(this, "YOUR_KEY");
       // your code
    }

    public void onStop()
    {
       super.onStop();
       FlurryAgent.onEndSession(this);
       // your code
    }
} 
```

回应@conor 评论：

来自[Flurry 的文档](http://support.flurry.com/sdkdocs/v3/android/classcom_1_1flurry_1_1android_1_1_flurry_agent.html#a6d845c03274c90a4280c93d2cf6111c6)

> So long as there is any Context that has called onStartSession(Context, String) but not onEndSession(Context), the session will be continued. Also, if a new Context calls onStartSession(Context, String) within 10 seconds (the default session timeout length) of the last Context calling onEndSession, then the session will be resumed, instead of a new session being created. Session length, usage frequency, events and errors will continue to be tracked as part of the same session. This ensures that as a user transitions from one Activity to another in your application they will not have a separate session tracked for each Activity, but will have a single session that spans many activities.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-05-29T08:52:01.020

Answer from florianmski has sense, but there are some problems when you have to use different kinds of activities in your application such as FragmentActivity, TabActivity, ListActivity and so on. In this case you are not able to extend all your activities from single BaseActivity. Personally I would prefer to put calls of onStartSession and onEndSession in each activity's onStart and onStop methods, but before wrap them into some class, for example:

```
public class Analytics {
    public static void startSession(Context context) {
        FlurryAgent.onStartSession(context, Config.FLURRY_KEY);
        // here could be some other analytics calls (google analytics, etc)
    }
    public static void stopSession(Context context) {
        FlurryAgent.onEndSession(context);
        // other analytics calls
    }
} 
```

Inside each activity:

```
public void onStart() {
    super.onStart();
    Analytics.startSession(this);
}

public void onStop() {
    super.onStop()
    Analytics.stopSession(this);
} 
```

# image - 用 DWT 处理亮度。总体思路是什么？

> ID：12307169
> 
> 赞同：1
> 
> 时间：2012-09-06T19:37:49.523
> 
> 标签：image, image-processing

伙计们，

我已经阅读了许多关于离散小波变换 (DWT) 的文章，并查看了一些示例代码。但是，我不清楚 DWT 究竟实现了什么。

这是我的理解。对于 YUV 格式的二维图像，我可以将 Y 平面（亮度）作为参数传递给 DWT 函数。该函数返回一个包含系数值的原始宽度和高度矩阵。

这些系数值告诉我什么？与相邻像素相比，像素的亮度变化有多快或多慢？

此外，返回的矩阵被重新排列为四个四分之一。由于系数已重新排列，我不再知道哪个系数属于哪个像素。这令人困惑。如果我无法将系数与其对应的像素位置相关联，我该如何真正使用这些系数？

一点背景。我正在考虑将图像中的一些信息隐藏为不可见的水印。据我了解，DWT 可以帮助我确定隐藏信息的最佳区域。但是，我无法将整个画面放在一起。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T08:31:09.293

行。我弄清楚了 DWT 是如何工作的。我假设生成的系数与原始图像有关系。但是，变换将输入亮度转换为完全不同的集合。可以对新值运行逆变换以再次获得原始值。

问候，
彼得

# python - Celery：长的专用单片任务与短的多任务

> ID：12307173
> 
> 赞同：6
> 
> 时间：2012-09-06T19:38:04.123
> 
> 标签：python, rabbitmq, celery, distributed-computing, django-celery

在我的解决方案中，我使用分布式任务来监控硬件实例一段时间（比如 10 分钟）。在以下情况下我必须做一些事情：

*   我开始这个监控会话
*   我完成了这个监控会话
*   （可能）在监控会话期间

在整个会话（10 分钟）中运行单个任务并执行所有这些操作是否安全，或者我应该将这些操作拆分为他们自己的任务？

在我看来，单一任务的优势在于更容易管理和实施时序约束。但：

运行一大群（大部分）睡着的工人是个好主意吗？例如，如果我知道我最多会打开 200 个会话，那么我有一个 500 名工人池来确保始终有可用的“会话”席位？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-10T16:14:36.410

对此没有一刀切的答案

*   将一个大任务 A 分成许多小部分（A¹、A²、A³、...）将增加潜在的并发性。

因此，如果您有 1 个具有 10 个工作线程/进程的工作实例，A 现在可以使用 10 个线程并行运行，而不是在一个线程上按顺序运行。

部分的数量称为任务*粒度*（细粒度或粗粒度）。

*   如果任务过于细化，消息传递的开销将拖累性能。

每个部分必须有足够的计算/IO 来抵消将任务消息发送到代理的开销，如果没有工作人员接收它，可能会将其写入磁盘，工作人员接收消息等等（请注意消息传递可以调整开销，例如，您可以有一个临时队列（不将消息持久化到磁盘），并发送在那里不那么重要的任务）。

*   一个繁忙的集群可能会让所有这些没有意义

如果您有一个繁忙的集群（例如，3 个工作实例，每个实例有 10 个线程/进程，所有正在运行的任务），则可能已经实现了最大并行度。

那么你很多人通过划分任务并没有得到太多好处，但是执行 I/O 的任务比 CPU 密集型任务（按 I/O 操作划分）有更大的改进机会。

*   长时间运行的任务很好

工人对长时间运行的任务不过敏，无论是 10 分钟还是一个小时。

但这也不理想，因为任何长时间运行的任务都会阻止该插槽完成任何等待任务。为了缓解这种情况，人们使用路由，以便您拥有一个专用队列，并为必须尽快运行的任务配备专门的工作人员。

-

# node.js - 使用 IISNode 在 IIS 中托管 nodejs 应用程序时如何启用静态文件（以及较少的支持）

> ID：12307174
> 
> 赞同：0
> 
> 时间：2012-09-06T19:38:10.707
> 
> 标签：node.js, less, express, iisnode

背景：

*   使用 expressjs 的 Nodejs 应用程序。
*   使用 IISNode 托管在 IIS 上
*   Nodejs 应用程序位于名为 /myVirtualDirectory 的虚拟目录中

问题：

您想使用 less 提供静态文件或 css，但传递给 nodejs 的 url 是完整的 url，与独立 nodejs 应用程序的预期不匹配。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T19:38:10.707

解决方案：

```
var express = require('express');
var app = express();
var lessMiddleware = require('less-middleware');

app.use('/myVirtualDirectory', lessMiddleware({
    src: __dirname + '/public',
    compress: true
}));

app.use('/myVirtualDirectory', express.static(__dirname + '/public')); 
```

注意我们在哪里指定了要使用的中间件，我们已经传入了 url 前缀以使其响应。只要这与虚拟目录的名称相同，这将匹配并且您的文件将按预期提供。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-06T19:57:15.553

使用 iisnode 在 IIS 中托管 node.js 应用程序的好处之一是您可以依靠 IIS 中的静态文件处理程序来提供静态文件。好处是性能的显着提高，因为对静态内容的请求由本机代码提供服务，而无需调用 JavaScript。

要使用 iisnode 设置托管在 IIS 中的 node.js 应用程序，以使用 IIS 静态文件处理程序提供静态文件，请使用[http://tomasz.janczuk.org/2012/05/yaml-configuration-support中所述的 URL 重写模块-in-iisnode.html](http://tomasz.janczuk.org/2012/05/yaml-configuration-support-in-iisnode.html)

要了解使用静态文件处理程序而不是 node.js 模块来提供静态文件的性能优势，请阅读[http://tomasz.janczuk.org/2012/06/performance-of-hosting-nodejs.html](http://tomasz.janczuk.org/2012/06/performance-of-hosting-nodejs.html)。

# plone - 将 Plone 2.5.5 升级到 Plone 3.3.5

> ID：12307179
> 
> 赞同：0
> 
> 时间：2012-09-06T19:38:18.893
> 
> 标签：plone

我有一个 2.5.5 版的 Plone 安装。我需要将其升级到 3.3.5。我对 Plone、Zope 或 Python 不是很熟悉。

这是在 Windows 2008 R2 环境中。我有两个版本的安装文件，我不担心破坏任何东西，因为所有东西都备份了十几次。

到目前为止我采取的步骤：1) 备份旧文件 2) 尝试将 3.3.5 安装到同一目录...在过程结束时收到几个 DLL 入口点错误。3) 必须重新启动计算机 4) 重新启动后 2.5.5 版本的 plone 控制器仍在工作，但 3.3.5 控制器没有。

我做错什么了吗？www.plone.org/upgrade 上的注释对我的经验水平再无帮助了。

感谢您的任何建议！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T06:01:21.053

[http://plone.org/documentation/manual/upgrade-guide/](http://plone.org/documentation/manual/upgrade-guide/)

这是一个很好的起点，总是。

基本上在某处安装 Plone 3.3.X，安装相同的附加组件（并检查兼容性，因此），复制 data.fs 并启动 plone 3。如果有效，请在 ZMI 中运行升级步骤并遵循通知。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T21:44:33.270

我认为没有对我所做的主要版本的 Plone 升级没有复杂性。

我的建议是不要就地升级，而是将更新的 Plone 版本安装到另一个目录，创建一个新实例并将*Data.fs*文件从旧站点复制到新站点。因此，您至少可以将新站点与旧站点进行比较，并排运行。

然后，您使用“迁移”产品更新数据库。首先尝试使用“试运行”。如果您在迁移过程中遇到错误，请尝试禁用导致错误的产品，然后重试。

这就是——粗略地——来自 Plone 升级文档的建议。

# visual-studio - SSRS/MDX - 作为列标题的参数值

> ID：12307183
> 
> 赞同：1
> 
> 时间：2012-09-06T19:38:43.073
> 
> 标签：visual-studio, tsql, reporting-services, mdx, business-intelligence

使用 SSRS 和 MDX

目标：拉取参数值并将其显示为列的标题文本

规格：参数值为MDX格式。一次生成报告时只有一个参数值。该值是根据用户在之前报告中单击的内容填充的。

即如果该人单击您是否获得了适当的帮助？超链接，下一个报告将具有以下 TextName 参数的值

[问卷调查].[问题层次结构].[问题名称].&[您得到了适当的帮助吗？]

我只想显示“你得到了适当的帮助吗？” 作为其中一列中的标题名称，没有其他内容。

“你得到了适当的帮助吗？” 只是用户可以在以前的报告中单击的许多选项的示例。根据他们单击的文本超链接，将填充参数值，这就是我需要显示为其中一列的标题名称的内容。

我不知道如何解决这个问题。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T22:22:01.710

这就是我在报告中处理此问题的方式：（我将此方法用于包含来自多个多维数据集的多个数据集的报告）

1- 在 SSRS 中，在设计视图中使用过滤器的默认值创建数据集，但不要将其设为查询参数。

2- 为您的报告参数创建另一个数据集。您可以在此数据集中创建计算列以具有不同的格式来显示值（特别是如果它的日期）让我们调用它`MonthDataSet`。

3-从`MonthDataSet`. 这是棘手的部分：为**值**和**标签选择不同的字段**

4- 打开您的数据集属性，然后从那里打开查询设计器。将参数添加到过滤器并单击确定关闭查询设计器，但不要关闭数据集属性。在参数选项卡中，使用表达式输入参数值。在以下示例中，我计算了月底：

```
="[Date Dimension].[Accounting Month].[Month].&[" &
format(DateValue(year(Parameters!MonthEnd.Value),
month(Parameters!MonthEnd.Value)+1,1).AddDays(-1),"yyyMMdd") & "]" 
```

现在您可以在报告中使用您的参数作为`[@MonthEnd].Label`

# php - jQuery - 从动态表单中获取多个函数的变量

> ID：12307184
> 
> 赞同：0
> 
> 时间：2012-09-06T19:38:42.550
> 
> 标签：php, jquery, ajax

几天前我开始使用 jQuery，虽然我找到了有关如何解决我遇到的任何问题的信息（或者至少通过一些变通方法让它工作），但我似乎被困在当前问题上：

我有一个具有可变数量字段的表单 - 字段数量可能随时根据用户输入而变化，我使用 AJAX 实现了这一点；由于我想在每次重新生成表单时保留用户输入的信息，所以我从表单字段中发布数据，并在每次更改字段数量时使用它来重新填充新生成的字段；这一切都有效（尽管我知道我做的不是*正确*的方法，更多关于它）。

我需要做的是使用表单字段中的值进行另一个 AJAX 调用以在页面上生成另一个表；我使用以下代码获取第一个 AJAX 调用的字段值，它由 php 生成，范围从 jq_calc11 到 jq_calc99（取决于字段数）。我知道这可能不是*正确*的方法，但我不知道如何使用 jQuery 发布二维数组。

```
$('#ts_addfields').change(function()
{   
 var comp_select=$('#ts_addfields').val();
var jq_calc11=$('#tb_calc11').val(); 
 var jq_calc21=$('#tb_calc21').val(); 
 var jq_calc31=$('#tb_calc31').val(); 
 var jq_calc41=$('#tb_calc41').val(); 
 var jq_calc51=$('#tb_calc51').val(); 
 var jq_calc61=$('#tb_calc61').val(); 
 var jq_calc71=$('#tb_calc71').val(); 
 var jq_calc81=$('#tb_calc81').val(); 
 $('#calculator_input').load('/elements/AJAX-addfields.php',{addFields: comp_select, pCalc11:jq_calc11, pCalc21:jq_calc21, pCalc31:jq_calc31, pCalc41:jq_calc41, pCalc51:jq_calc51, pCalc61:jq_calc61, pCalc71:jq_calc71, pCalc81:jq_calc81});    
   }); 
```

我现在的问题是，如何将这些变量的值重新用于不同的 AJAX 调用？我认为通过 php 为另一个函数生成另一个潜在的 99 行并不是一个好主意，所以我研究了将这些值放在一个单独的函数中的可能性，并从该`$('#ts_addfields').change(function()`函数或另一个函数内部调用它。我尝试了以下各种变体，但我找不到如何运行读取变量的函数的方法；

```
jQuery.fn.calcVars = function(){
 var jq_calc11=$('#tb_calc11').val(); 
 var jq_calc21=$('#tb_calc21').val(); 
 var jq_calc31=$('#tb_calc31').val(); 
 var jq_calc41=$('#tb_calc41').val(); 
 var jq_calc51=$('#tb_calc51').val(); 
 var jq_calc61=$('#tb_calc61').val(); 
 var jq_calc71=$('#tb_calc71').val(); 
 var jq_calc81=$('#tb_calc81').val(); 
 };

$('#ts_addfields').change(function()
{   
 var comp_select=$('#ts_addfields').val();
 $(this).calcVars();
$('#calculator_input').load('/elements/AJAX-addfields.php',{addFields: comp_select, pCalc11:jq_calc11, pCalc21:jq_calc21, pCalc31:jq_calc31, pCalc41:jq_calc41, pCalc51:jq_calc51, pCalc61:jq_calc61, pCalc71:jq_calc71, pCalc81:jq_calc81});    
   }); 
```

我尝试过的任何代码都会在萤火虫上返回“jq_calc*xx*”未定义错误。

有人能指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T19:45:59.457

好吧，你可以试试这个：

```
var str = $("form").serialize(); 
```

[http://api.jquery.com/serialize/](http://api.jquery.com/serialize/)

# sql - SQL通过匹配日期到日期范围来选择值？

> ID：12307187
> 
> 赞同：1
> 
> 时间：2012-09-06T19:38:49.593
> 
> 标签：sql, date, range

我有一个时间表表和一个包含日期范围的部门表，并希望将正确的部门附加到每个时间表条目。

```
Timesheet                        Department
----------------------           --------------------------------------
Name  |Date     |Hours           Name   |From     |To        |Dept
----------------------           --------------------------------------
Joe   |6/1/2012 | 4              Joe    |5/1/2012 |7/31/2012 |West
Joe   |7/8/2012 | 2              Joe    |8/1/2012 |1/1/2099  |East
Joe   |8/4/2012 | 8 
```

查询时间表数据时，我希望附上时间表当天的正确部门。查询应输出以下内容：

```
Joe   |6/1/2012 | 4 |West
Joe   |7/8/2012 | 2 |West
Joe   |8/4/2012 | 8 |East 
```

我很难弄清楚如何加入这些不同的数据集以实现我的目标。如果我没有可以加入的确切匹配日期而只有一个日期范围，如何为每个时间表条目选择正确的部门值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T19:41:43.437

```
SELECT
    t.Name,
    t.[Date],
    t.Hours,
    d.Dept
FROM
    Timesheet t
    JOIN Department d
        ON t.Name = d.Name
        AND t.[Date] BETWEEN d.[From] AND d.To 
```

# symfony - 捆绑“ApplicationSonataUserBundle”不存在或未启用

> ID：12307195
> 
> 赞同：15
> 
> 时间：2012-09-06T19:39:29.323
> 
> 标签：symfony, symfony-2.1, symfony-sonata, sonata-admin

我需要安装 SonataUserBundle 才能安装 SonataNewsBundle。

我一步一步按照[安装教程进行操作，但出现此错误：](http://sonata-project.org/bundles/user/master/doc/reference/installation.html)

```
./app/console sonata:easy-extends:generate SonataUserBundle

  [InvalidArgumentException]                                                 
  Bundle "ApplicationSonataUserBundle" does not exist or it is not enabled. 
```

尚未生成捆绑包。这个命令应该做到！

任何人都知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-10-08T12:21:17.463

**编辑 2016/09/23**：这个答案可能有点过时了。如果这不起作用，您可以在下面探索[@ashish 答案](https://stackoverflow.com/a/24588407/1548376)。

在 Sonata User Bundle 设置过程中，建议您将dictionary **:orm**映射到**ApplicationSonataUserBundle ，这在****sonata:easy-extends:generate SonataUserBundle**期间无法完成，因为 ApplicationSonataUserBundle 尚不存在。

所以在启动你的**奏鸣曲:easy-extends:generate SonataUserBundle**命令之前，你可以评论**ApplicationSonataUserBundle**行：

```
# app/config/config.yml
[...]
# Doctrine Configuration
doctrine:
  [...]
  orm:
    auto_generate_proxy_classes: %kernel.debug%
      entity_managers:
        default:
          mappings:
            # ApplicationSonataUserBundle: ~
            SonataUserBundle: ~ 
```

然后你启动你的**奏鸣曲：easy-extends:generate SonataUserBundle**命令，最后，你删除 ***ApplicationSonataUserBundle: ~ ** 上的注释（#）

**捆绑“ApplicationSonataUserBundle”不存在或未启用**错误消失了。

祝你有美好的一天。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2014-07-05T16:28:50.677

在运行 sonata:easy-extends:generate 之前执行以下步骤

(1) 注释 config.yaml 中的 ApplicationSonataUserBundle 这一行

```
 mappings:
               # ApplicationSonataUserBundle: ~
                SonataUserBundle: ~ 
```

(2) 将 Application\Sonata\UserBundle\Entity\User 替换为 Sonata\UserBundle\Entity\BaseUser

(3) 将 Application\Sonata\UserBundle\Entity\Group 替换为 Sonata\UserBundle\Entity\BaseGroup

(4) 运行奏鸣曲:easy-extends:generate "php app/console sonata:easy-extends:generate SonataUserBundle -d src"

现在还原步骤 1、2 和 3

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-02T10:04:33.867

我通过从 config.yml 和 AppKernel.php 中删除对 Application\Sonata\UserBundle\Entity\User 和 Application\Sonata\UserBundle\Entity\Group 和 'new Application\Sonata\UserBundle\ApplicationSonataUserBundle()' 的引用来安装它。

然后运行 ​​easy extends generate 命令，然后把引用放进去。我认为文档把这些步骤搞混了。在 config.yml 中的包存在之前，您不能引用它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-12-12T07:43:19.590

嗨，我遇到了同样的问题。但我可以解决这个问题。让我们看看我在做什么：

在命令中：

```
php app/console sonata:easy-extends:generate -d src/ SonataUserBundle 
```

然后在 AppKernel 文件中写入：

```
new Application\Sonata\UserBundle\ApplicationSonataUserBundle 
```

现在这是工作;）

而这个命令

```
sonata:easy-extends:generate SonataUserBundle 
```

在“App/”文件中创建 Bundle。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-07-06T09:45:55.863

你的步骤是正确的，除了它已经在“app/”文件夹中创建了你的 ApplicationSonataAdminBundle，所以你应该剪切这个生成的 ApplicationSonataAdminBundle 并粘贴到“src/”文件夹中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-07T22:21:11.383

好吧，该命令是第 5 步，您需要先执行前 4 步，然后才能运行第 5 步。

你得到的错误是因为你错过了第 2 步：安装包和配置框架（例如`AppKernel`不知道包）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-10-12T14:32:08.520

如果您不想使用“easy-extends”——另一种可能的解决方案是覆盖*config.yml中的默认设置*

```
sonata_user:
    class:
        user: Acme\UserBundle\Entity\User
        group: Acme\UserBundle\Entity\Group 
```

# eclipse - 我可以将特定项目的调试配置绑定到 FlashBuilder 中的 F11 吗？

> ID：12307200
> 
> 赞同：0
> 
> 时间：2012-09-06T19:39:49.267
> 
> 标签：eclipse, flash-builder

我目前正在开发一个大型 AS3 系统，该系统由一个核心项目和几个模块组成，这些模块在运行时由核心项目动态加载。通常，当我在处理其中一个模块时，我会反射性`F11`地进入调试模式，但由于这些项目不会作为独立应用程序运行，它们会打开一个空的 Flash 播放器或浏览器窗口，而我必须切换到进度选项卡，取消启动，从核心项目打开一个文件并重新启动。

这是一个相当小的问题，我可以通过记住手动单击调试按钮而不是按 来解决`F11`，但无论它发生的频率如何，我总是忘记这样做。每次只浪费几秒钟，但这是我每天做几十次甚至几百次的事情，而且它加起来。

`F11`有没有一种方法可以仅将核心项目绑定到调试配置？如果没有，有什么方法可以配置模块以将启动委托给核心项目？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T13:39:54.557

我通过更改这些项目的运行配置来代替启动主项目，解决了意外启动不可运行项目的潜在问题。

# perl - 如何修复损坏/“不符合标准”的 PDF

> ID：12307204
> 
> 赞同：2
> 
> 时间：2012-09-06T19:40:02.237
> 
> 标签：perl, pdf

我正在用 Perl 构建一个 Web 应用程序。用户向我发送一个 XML 文件，其中包含对许多 PDF 文档的引用。我使用 XSLT 将 XML 转换为 XHTML，然后使用 PrinceXML 从 XHTML 创建 PDF 文档。此 PDF 为将包含的附件​​保留带有页眉和页脚的空白页面。

获得 PDF 后，我使用 PDF::API2 Perl 模块逐一打开 XML 中引用的 PDF 文档，如果需要，缩放和旋转页面，然后将它们包含在我创建的 PDF 文档中。

我的问题是用户提交的许多 PDF 都以某种方式损坏。即，它们不符合 Adob​​e 的 PDF 规范，并且 PDF::API2 不知道如何操作它们。PDF::API2 文档建议使用 pdftk 修复损坏的 PDF，但这通常需要很长时间并且在许多情况下并不成功。

修复此类损坏的 PDF 的最佳方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-06T20:32:28.237

您在这里所提倡的有时被称为*“重新煎炸*PDF”：转换为 PostScript 并返回 PDF。

但是，虽然这可能会解决一些其他方法可能无法轻松解决的问题，但您也应该注意此路径中经常存在的问题和缺点：

*   PostScript 的图形功能比 PDF 更受限制。PDF 添加了对真实透明度、更多色彩空间、ICC 颜色配置文件和更多字体类型的支持——这些功能在 PostScript 中不可用。（事实上​​，将这些功能添加到原始 PostScript 图形模型的需要是 Adob​​e 开始开发 PDF 文件格式的动机之一！）

*   因此，从 PDF 转换为 PostScript 必然会降低质量，而在转换回 PDF 时您将无法恢复。

但是，您可以尝试另一种选择，以避免重新油炸绕道：

*   **借助 Ghostscript 直接转换 PDF -> PDF：**

    ```
    gs                        \
      -o output.pdf           \
      -dPDFSETTINGS=/prepress \
      -sDEVICE=pdfwrite       \
       input.pdf 
    ```

请使用可用的最新 Ghostscript 版本。

Ghostscript 有很多选项可用于控制 PDF 修复过程的各个方面。在不知道您的具体问题的情况下，我不能在这里更具体。

但是在过去的 10 年里，我还没有遇到很多 Ghostscript 无法修复的 PDF 问题，而通过 Acroread 重炸可以做到（虽然有一些）。OTOH，我有更多的例子，A​​croread 的重炸没有成功，而 Ghostscript 的 PDF -> PDF 做到了......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-06T19:56:07.937

我回答这个问题是为了分享我在构建这个工具时找到的答案。

如问题中所述，我首先尝试使用 Linux 命令行工具 pdftk 修复损坏的 PDF。这在某些情况下有效，但大多数损坏的 PDF 仍然无法修复，而且此工具通常需要很长时间。

然后，我想到将 PDF 转换为 PostScript，然后再转换回 PDF。我使用 pdf2ps 和 ps2pdf 进行转换。这两个工具都是 ghostscript 的包装器。这种方法获得了更高的命中率，但仍有不少损坏的 PDF 无法转换为 PostScript 文件。

然后我尝试使用 Adob​​e 的 PDF 阅读器 acroread 将 PDF 转换为 PostScript，而不是 pdf2ps。事实证明，这是一个非常好的解决方案，几乎可以修复所有 PDF。我仍然使用 ps2pdf 将文件转换回 PDF。

我使用的 acroread 命令是：

```
acroread -toPostScript -choosePaperByPDFPageSize -pairs input.pdf output.ps 
```

更新（2015 年 2 月 25 日）：我遵循了 Kurt Pfeifle 的建议并将其纳入我的流程。这比 'refrying' 慢（见 Kurt 的帖子），但成功率更高。有趣的是，在极少数情况下它不起作用，而“重炸”起作用，所以这成为了我的后备方案。

# c# - 子线程完成后主线程不继续

> ID：12307205
> 
> 赞同：0
> 
> 时间：2012-09-06T19:40:13.233
> 
> 标签：c#, multithreading, manualresetevent, waitone, countdownevent

我正在尝试在我的应用程序中使用多线程。该方法`test5`尝试从 Internet 获取一些内容，而`main`线程在继续其他工作之前等待所有线程完成。

但是我的`main`线程在调用后没有回来`test5`，我的控制台线`Done Inside!!`也`thread all got back!!`永远不会到达。

我该如何解决这个问题？

```
class Program
{
    static void Main(string[] args)
    {
        string[] url =
        {
            "http://...", "http://...", "http://...", "http://...", "http://..."
        };

        test5(url); 
        Console.WriteLine("thread all got back!!");

        // Do some other work after all threads come back
        Console.ReadLine();
    }

    private static void test5(string[] _url)
    {
        int numThreads = _url.Length;
        ManualResetEvent resetEvent = new ManualResetEvent(false);
        int toProcess = numThreads;

        for (int i = 0; i < numThreads - 1; i++)
        {
            new Thread( delegate() {
                testWebWorking(_url[i]);
                if (Interlocked.Decrement(ref toProcess) == 0)
                    resetEvent.Set();
            }).Start();
        }
        resetEvent.WaitOne();
        Console.WriteLine("Done inside!!");
    }

    private static void test6(string[] _url)
    {
        int numThreads = _url.Length;
        var countdownEvent = new CountdownEvent(numThreads);

        for (int i = 0; i < numThreads - 1; i++)
        {
            new Thread(delegate() {
                testWebWorking(_url[i]);
                countdownEvent.Signal();
            }).Start();
        }
        countdownEvent.Wait();
        Console.WriteLine("Done inside!!");
    }

    private static void testWebWorking(object url)
    {
        Console.WriteLine("start {0}", Thread.CurrentThread.ManagedThreadId);
        string uri = (string)url;
        HttpWebRequest request = (HttpWebRequest)WebRequest.Create(uri);
        request.KeepAlive = true;
        request.Timeout = 5000;
        request.ReadWriteTimeout = 5000;
        request.Proxy = null;

        try
        {
            using (HttpWebResponse response = (HttpWebResponse)request.GetResponse())
            {
                //Console.WriteLine(response.ContentType + "; uri = " + uri);
                Stream receiveStream = response.GetResponseStream();
                Encoding encode = System.Text.Encoding.GetEncoding("utf-8");
                // Pipes the stream to a higher level stream reader with the required encoding format. 
                StreamReader readStream = new StreamReader(receiveStream, encode);
                //Console.WriteLine("\r\nResponse stream received.");
                Char[] read = new Char[256];
                // Reads 256 characters at a time.    
                int count = readStream.Read(read, 0, 256);
                //Console.WriteLine("HTML...\r\n");
                String str = "";
                while (count > 0)
                {
                    // Dumps the 256 characters on a string and displays the string to the console.
                    str = new String(read, 0, count);
                    //Console.Write(str);
                    count = readStream.Read(read, 0, 256);
                }
                //Console.WriteLine(str);
                // Releases the resources of the response.
                response.Close();
                // Releases the resources of the Stream.
                readStream.Close();

                Console.WriteLine("end {0}", Thread.CurrentThread.ManagedThreadId);
            }
        }
        catch (WebException ex)
        {
            //Console.WriteLine(ex.GetBaseException().ToString() );
            //Console.WriteLine(url);
            Console.WriteLine("time out !!");
        }
        finally
        {
            request.Abort();
            request = null;
            GC.Collect();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T19:44:01.857

看这个：

```
for (int i = 0; i < numThreads - 1; i++) 
```

你只是开始`numThreads - 1`线程。你的计数器从开始`numThreads`倒计时，所以它只会达到 1，而不是 0。

顺便说一句，这也被打破了::

```
for (int i = 0; i < numThreads - 1; i++)
{
    new Thread( delegate()
    {
        testWebWorking(_url[i]);
        ...
    }
    ...
} 
```

在这里，您在委托中捕获*变量* ，因此当您执行它时它将具有任何值。您可以多次测试同一个 URL，并跳过其他 URL。相反，您应该将 的值复制到循环*内*的变量中，以便每次捕获不同的变量：`i``i``i`

 *```
// Fixed the loop boundary as well
for (int i = 0; i < numThreads; i++)
{
    int copy = i;
    new Thread(() => // Use a lambda expression for brevity
    {
        // Fix naming convention for method name, too...
        TestWebWorking(_url[copy]);
        if (Interlocked.Decrement(ref toProcess) == 0))
        {
            resetEvent.Set();
        }
    }).Start()
} 
```

您的两种方法都有相同的问题。

就个人而言，无论如何我都不会`for`在这里使用循环 - 我会使用`foreach`循环：

```
private static void TestWithResetEvent(string[] urls)
{
    ManualResetEvent resetEvent = new ManualResetEvent(false);
    int counter = urls.Length;

    foreach (string url in urls)
    {
        string copy = url;
        Thread t = new Thread(() =>
        {
            TestWebWorking(copy);
            if (Interlocked.Decrement(ref toProcess) == 0))
            {
                resetEvent.Set();
            }
        });
        t.Start();
    }
    resetEvent.WaitOne();
    Console.WriteLine("Done inside!!");
} 
```

或者，使用它会更简单`Parallel.ForEach`，它专为这类事情而设计。*

# rubygems - RVM：列出当前 gemset 中的所有 gem，忽略全局和默认值

> ID：12307217
> 
> 赞同：37
> 
> 时间：2012-09-06T19:41:18.097
> 
> 标签：rubygems, gem, rvm, gemset

在 RVM gemset 中寻找类似的东西`gem list`，但让它忽略**全局**和**默认**gemsets 中的 gems，这样我就可以轻松地看到活动 gemsets 中的 gems（并且*只有*活动 gemsets）。

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2012-09-06T19:50:01.747

对于全球：

```
rvm @global do gem list 
```

对于其他宝石：

```
GEM_PATH=$GEM_HOME gem list 
```

* * *

`@global`是所有其他 gemset 为给定 ruby​​ 继承的 gemset，它不会为 m 本身继承，因此选择它并`gem list`在它的上下文中运行是安全的。

对于所有其他 gemset，您可以使用显示来自and`gem list`中所有可用路径的 gem的事实，重置为相等将仅使一个路径可用 - so中的一个将仅显示所选 gemset 中的 gem，忽略所有其他 gemset（在此时间，但 RVM 2.0 将支持多个 gemsets 继承）。`GEM_HOME``GEM_PATH``GEM_PATH``GEM_HOME``GEM_HOME``gem list``@global`

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2012-09-06T19:47:34.737

最简单的方法是使用 bash 命令显示当前 gemset 目录中的目录列表

```
$ ls `rvm gemdir`/gems 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-06-06T17:19:52.683

首先，无论何时选择任何其他 gemset，默认（无名）gemset 的内容都会变得不可见。

如您所知，@global gemset 通常[包含](https://rvm.io/gemsets/global/)在当前所选 Ruby 的所有其他 gemset 中。

但是，要查看 gemset 的内容，不包括 @global gemset，首先 do `rvm use 2.0.0@some-gemset --ignore-gemsets`（或[类似](https://rvm.io/gemsets/ignoring/)的其他红宝石） then `gem list`。

同样要查看 @global gemset 的内容，首先执行`rvm use 2.0.0@global`then `gem list`。

同样，要查看默认 gemset 的内容，请执行`rvm use 2.0.0 --ignore-gemsets`then `gem list`。

顺便说一句，您可以选择一个 gemset作为新（非登录）shell的（所谓的）[默认值](https://rvm.io/gemsets/using/)`.bash_profile`（我总是在等中为每个 Ruby 解释器分别这样做），但这是另一种默认 gemset，不是上面的（未命名的）默认 gemset。

# web-services - Matlab 中带有身份验证的 RESTful Web 服务

> ID：12307218
> 
> 赞同：2
> 
> 时间：2012-09-06T19:41:23.217
> 
> 标签：web-services, matlab, restful-authentication

我已经能够让以下 Matlab 插件与我的 JSON 返回字符串一起使用：http: [//www.mathworks.com/matlabcentral/fileexchange/23393](http://www.mathworks.com/matlabcentral/fileexchange/23393)（我只是从我的网络浏览器将 JSON 复制并粘贴到一个文件中）

但是，我正在访问的 RESTful 网络服务需要登录。我已经能够在java中使用`org.apache.commons.httpclient.HttpClient;`但似乎无法在Matlab中找到一种干净的方法......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T15:08:47.990

Matlab 允许[集成和使用 Java](http://www.mathworks.com/help/techdoc/matlab_external/f4863.html)类和方法。因此，如果您已经有在 Java 中工作的代码，我会在 matlab 中使用该代码。

**编辑**：如果你死心塌地使用 matlab 那么你应该检查一下[urlread2](http://undocumentedmatlab.com/blog/expanding-urlreads-capabilities/)。虽然我不知道您是否可以使用它来保存和使用会话 cookie。

# javascript - 将点击链接的目标 URL 传递给 javascript/jQuery

> ID：12307222
> 
> 赞同：0
> 
> 时间：2012-09-06T19:41:52.307
> 
> 标签：javascript, jquery

阅读[此问答](https://stackoverflow.com/questions/6575957/jquery-get-url-from-click-and-pass-to-confirm-button-in-dialog)后，我能够在单击链接时将特定 div 的 URL 传递给 jQuery。但是，我有多个页面链接，我想在单击时将它们各自的 href 值传递给 jQuery。现在代码选择页面上的所有链接：

```
jQuery(document).ready(function(){
  jQuery(".view-frontpage a").click(function (event) {
    href = $('.view-frontpage a').attr('href');
    event.preventDefault();
    alert(href);
   });
}); 
```

当前的结果是它会弹出一个对话框，显示页面上第一个链接的 href 属性，而不管单击哪个链接。如何更改它以给我刚刚单击的链接的href？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-06T19:44:14.443

这应该有效。改变：

```
href = $('.view-frontpage a').attr('href'); 
```

到：

```
href = $(this).attr('href'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T19:50:31.123

首先，使用[事件](http://davidwalsh.name/event-delegate) [委托](http://www.nczonline.net/blog/2009/06/30/event-delegation-in-javascript/)是个好主意，这样您实际上就不会为页面上的每个链接创建处理程序。

在您的情况下，jQuery`this`在您的点击处理程序内绑定到点击事件目标（被点击的元素），因此您需要`href = $(this).attr('href');`获取所需链接的 href。

这是使用新的 jQuery [on()](http://api.jquery.com/on/)函数的完整代码（从 1.7 开始可用）

```
$(document).on('click', '.view-frontpage a', function(e) {
    alert($(this).attr('href'));

    e.preventDefault();
    return false;
});​​​ 
```

# ios - MonoTouch：SystemSound 无法在设备上运行

> ID：12307226
> 
> 赞同：1
> 
> 时间：2012-09-06T19:42:04.583
> 
> 标签：ios, xamarin.ios

在模拟器中的 MonoTouch 5.2.13 中，声音有效。但在真正的 5.1.1 设备上，它不会。没有报告错误或消息。

我错过了什么吗？

```
 SystemSound sound;
    void PlayRevSound()
    {
        try
        {
            Console.WriteLine("Start Sound");
            //enable audio
            AudioSession.Initialize();
            //load the sound
            sound = SystemSound.FromFile("Images/rev.wav");
            sound.PlaySystemSound();
            Console.WriteLine("End Sound");
        }
        catch(Exception e)
        {
            Console.WriteLine("Error Sound: " + e.Message);
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T22:30:33.527

设备已静音。[脸红]

当有疑问时，这通常是最简单的问题......

# oracle - 无法使用 RODM 从 R 连接到 Oracle 数据库

> ID：12307228
> 
> 赞同：0
> 
> 时间：2012-09-06T19:42:21.697
> 
> 标签：oracle, r

我正在尝试从 R 连接到 Oracle 数据库。

我用过`RODM_open_dbms_connection(dsn, uid = "", pwd = "")`，但它不起作用。我不确定它是什么类型的错误。

这是来自 R 的错误屏幕。

```
> library(RODM) Loading required package: RODBC DB<-
> RODM_open_dbms_connection(dsn="****",uid="****", pwd="****") Error in
> typesR2DBMS[[driver]] <<- value[c("double", "integer", "character",  :
> cannot change value of locked binding for 'typesR2DBMS' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-26T18:31:12.207

我探索了 RODM_open_dbms_connection。我注释掉了部分***setSqlTYpeInfo()***。之后我没有收到那个错误。从源代码安装 RODM 包，然后只有您可以编辑包。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-12T18:00:40.663

你试过[ROracle](http://cran.r-project.org/web/packages/ROracle/index.html)吗？在您的机器上安装即时客户端后，从 R 连接和获取记录如下所示：

```
library(ROracle)
con <- dbConnect(dbDriver("Oracle"), username="username", password="password", dbname = "dbname")
res <- dbSendQuery(con, "select * from schema.table")
dt <- data.table(fetch(res, n=-1)) 
```

# jquery - jQuery：选择具有特定 ID 的跨度

> ID：12307234
> 
> 赞同：6
> 
> 时间：2012-09-06T19:42:41.170
> 
> 标签：jquery

我在这个函数上收到一条错误消息，告诉我 parseInt 没有基数参数，即使我将变量 moveCount 传递给它。我假设这意味着 ID 为 #moveCount 的跨度值未分配给变量 moveCount。我在下面的行中标记了我认为出现问题的地方。我试过这条线

```
moveCount = $('span #moveCount').html(); 
```

在选择器中使用和不使用“跨度”一词，都得到相同的结果。

```
function incrementMoveCount() {
    //gets the html of the span with id
    //moveCount
    //turns it into a number
    //increments it by one
    //sets the html of the span with id moveCount
    //to the new move count
    var moveCount = 0; 
    var newMoveCount = 0;
    moveCount = $('span #moveCount').html();   # problem here
    newMoveCount = parseInt(moveCount);
    newMoveCount = newMoveCount + 1; 
    $('span #moveCount').html('newMoveCount');
} 
```

html

```
<div id="meta">
<h1>Checkers</h1>
<h4>Moves: <span id="moveCount">0</span></h4>
</div> 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-06T19:44:27.967

如果它是跨度的 id，您可以删除空间 - 空间指定后代.. 所以您实际上是在寻找 id=moveCount 的跨度后代

```
$('span#moveCount').html(); 
```

或者，由于您是按 ID 选择的，因此您不需要指定 span，因为 ID 选择器是最快的 - ID 是唯一的，因此它将始终查找具有该 id 的第一个元素

```
$('#moveCount').html(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T19:44:48.253

尝试删除空间...

```
moveCount = $('span#moveCount').html(); 
```

您的选择器正在选择元素中具有id`#moveCount` **的**`span`元素

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-06T19:45:31.377

给定的 id 只能有一个元素，您无需指定它是一个跨度。

```
$("#moveCount").html() 
```

如果这不能满足您的需求，那么问题不在 jQuery 代码中，我们需要查看 html。

**编辑：**

```
$('#moveCount').html('newMoveCount'); 
```

应该

```
$('#moveCount').html(newMoveCount); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-06T19:57:50.607

如果您通过 id 获取元素，则不需要标签名称来搜索它。因为，理论上一个 HTML 文档应该只有一个具有特定 id 的元素。因此，在您的情况下： $('#moveCount'); 也应该给你元素。我会将代码更改为：

```
var moveCount = + $('#moveCount').text();
$('#moveCount').text(moveCount + 1); 
```

jquery .text() 方法会正确获取 span 的值，前面的 '+' 号会自动将其转换为 int。您不需要调用 parseInt()。我们可以通过只触发一次 jQuery 选择来进一步加快它：

```
var moveCountElement = $('#moveCount');
moveCountElement.text(+ moveCountElement.text() + 1); 
```

希望有帮助！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-06T19:58:27.967

```
.html('newMoveCount'); 
```

表示跨度的 html 应该是字符串 'newMoveCount' 而不是 newMoveCount 变量的值。跨度和id之间也不应该有空格。总而言之，这应该有效：

```
function incrementMoveCount() {
    var moveCount = 0;
    var newMoveCount = 0;
    moveCount = $('span#moveCount').html();
    newMoveCount = parseInt(moveCount);
    newMoveCount = newMoveCount + 1;
    $('span#moveCount').html(newMoveCount);
} 
```

# ms-access - Access 2007：条件格式不适用于基于查找值的控制

> ID：12307241
> 
> 赞同：0
> 
> 时间：2012-04-19T16:40:30.077
> 
> 标签：ms-access

我有一个 Access 2007 报告，其中包含一个基于具有值列表的查找字段的控件。字段值是字符串：

```
0\. Late
1\. Critical
2\. Urgent
3\. Normal
4\. Low
5\. Closed
6\. Draft/On Hold 
```

在条件格式框中，我使用：

```
Field Value Is equal to "0) Late" 
```

并选择不同的颜色背景和文本颜色。当文本框的值与“0) Late”匹配时，这应该有条件地更改文本框的背景和文本颜色，但是报告并没有按预期显示，而是根本不打印该值。

访问帮助说“当您将条件格式应用于查找字段时，条件必须基于查找 ID，而不是查找字段返回的值。”

我不确定它是什么意思`Lookup ID`。这是一个基于查找值列表中位置的数字吗？我尝试过使用`1`而不是`0) Late`，但这也不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T13:35:58.173

报告中的字段设置为背景“透明”；背景需要设置为“正常”才能显示填充颜色。

# java - Java：类中间的静态关键字

> ID：12307243
> 
> 赞同：1
> 
> 时间：2012-09-06T19:43:07.103
> 
> 标签：java, class, static

这是示例代码：

```
class A {

   static {
       int a;
       class B {
       }
   }

   public static void main(String[] args){
       // cannot access class B and in a;
   }
} 
```

我不知道`static`这个上下文中的关键字是什么意思。我在其中声明了一个`int`变量和一个类。但我不能在 A 类或主要方法中使用它。我编译它不会产生任何错误。所以，我认为这种声明是有目的的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-06T19:44:52.413

这是一个*静态初始化块*。您可以使用它来收集静态/类成员的初始化。

同样，您可以有一个非静态初始化块来初始化每个新对象的*实例成员：*

```
class A
{
    static int a;

    private int b;

    // static/class initialization:
    static
    {
        // initialize class members
        a = 5;
    }

    // instance initialization:
    {
        // initialize instance members
        b = 5;
    }
} 
```

这个例子很简单，你可以改为在它们的声明中初始化变量：`static int a = 5`，实际上通常会更清楚。但是当初始化是多步的，或者一般比较复杂的时候使用初始化块，例如建立一个数据库连接。

有关更多示例，请参阅： Java 教程中的[初始化字段](http://docs.oracle.com/javase/tutorial/java/javaOO/initial.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-06T19:48:41.050

静态 {} 块中的代码将在第一次加载类（不是此类的对象）时执行。 [看到这个](http://www.javatutorialhub.com/java-static-variable-methods.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-06T19:46:19.580

它在Java中被称为静态块。这通常用于您的 A 类可能需要的初始化目的

JVM 加载此类时执行静态块。可以有很多这样的块，它们将按照出现的顺序执行

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-06T19:49:30.437

这是一个静态初始化块。这是[Oracle Java SE 文档静态初始化块](http://docs.oracle.com/javase/tutorial/java/javaOO/initial.html)。

在您的示例中，`int a`是静态初始化块的局部变量。这是关于静态初始化块中的局部变量的另一篇 Stackoverflow 帖子：[Java 中静态块内声明的变量的范围是什么？](https://stackoverflow.com/questions/9950132/what-is-the-scope-of-variables-declared-inside-a-static-block-in-java). 这就是为什么您无法在 main 方法中访问它的原因。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-06T19:51:59.843

该定义是一个静态初始化块。它允许额外的初始化逻辑，在这种情况下应用于静态成员。

如果您调用类 A 构造函数，您将能够访问您在块中初始化的任何内容，因为“Java 编译器将初始化块复制到每个构造函数中”。检查[文档](http://docs.oracle.com/javase/tutorial/java/javaOO/initial.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-06T19:54:30.500

这是静态初始化程序块。

无法在块外访问int`a`和 class的原因是*作用域*。与构造函数和方法类似，在初始化块范围内声明的变量不能在块外访问。`B`

# ios - iOS：iPhone 应用上的弹出框

> ID：12307246
> 
> 赞同：0
> 
> 时间：2012-09-06T19:43:18.483
> 
> 标签：ios, popover

在我的 IPHONE 应用程序中，我使用了弹出框，但我不知道如果我在 iPhone 应用程序而不是 iPad 应用程序中使用此元素，我的应用程序是否会被拒绝；你知道我是否会遇到这个问题吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T19:45:19.060

苹果可以拒绝任何事情。然而，话虽如此，我已经看到了许多使用自定义弹出框的 iPhone 应用程序。Facebook 应用程序只是一个例子。只要您不使用任何私有 API，您应该没问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T19:51:19.787

这没问题，并且有许多应用程序具有该功能，但您需要自己编写代码，因为 iPhone 不支持弹出框功能。我经常使用的具有该功能的应用程序称为 Week Cal。

# php - 如何使用 XAMPP 在 Windows 中为 Zend Framework 创建别名以与 Cygwin 一起使用

> ID：12307248
> 
> 赞同：1
> 
> 时间：2012-09-06T19:43:27.750
> 
> 标签：php, zend-framework, windows-7, cygwin, xampp

我在办公室的 Windows7+XAMPP 环境中使用 Zend Framework；即使我想改变这一点，我也无法改变，所以我需要适应。所以，我自然而然地安装了 Cygwin 和 Console2，以便在更像 Linux 的环境中工作。PHP 和 MySQL 路径在 Windows 的环境变量中，所以如果我在 CMD 中这样做：

```
php --version
PHP 5.4.4 (cli) (built: Jun 13 2012 21:27:06) 
```

有回应。如果我在 Cygwig 环境中做同样的事情，我也会得到响应，所以 Cygwin 可以找到 PHP 路径。关于 Zend Framework，我下载了 zip 文件并将 ZF bin 目录的内容解压缩到`C:\xampp\php`（即 zf.sh、zf.bat 和 zf.php）以及所有库文件夹内容，`C:\xampp\php\pear\Zend`因此它们位于正确的路径中用过的。

在 Windows CMD 中，我设法以这种方式创建了类似于别名的东西：

```
#cmd_aliases.txt
zf=php C:\xampp\php\zf.php $*

#cmd_autorun.cmd
@echo off
cls
doskey /macrofile=C:\Users\hector.ayala\Documents\cmd_aliases.txt

#cmd_autorun_install.cmd
reg add "hkcu\software\microsoft\command processor" /v Autorun /t reg_sz /d C:\cmd_autorun.cmd 
```

现在在 CMD 中我可以这样做：

```
>zf show version
Zend Framework Version: 1.11.12 
```

...如预期。**但是**我不能在 CygWin 中做类似的事情......我在 Cygwin 中做了这个： $ cd ZendFramework-XX $ mv bin/* /usr/local/bin $ chmod +x /usr/local/bin/zf.sh $ ln -s /usr/local/bin/zf.sh /usr/local/bin/zf

这意味着我做了一个符号链接，`zf.sh`以便仅使用`zf`. 但是我得到了这个：

```
$ zf show version
Could not open input file: /usr/local/bin/zf.php 
```

然后我说，哦，好吧！也许是 ZF 的问题......我的 PHP 将它的版本返回给我，所以 PHP 可以工作，当然任何 php 文件的扭结都可以工作：

```
$ php simple_test.php
Could not open input file: simple_test.php 
```

什么……？为什么 PHP 可以工作，但同时却不能？有什么想法可以`zf`像使用 CMD 一样使用简单的自定义调用 Zend Framekork CLI 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T21:56:50.317

我找到方法了！！！！我不知道[cygpath](http://cygwin.com/cygwin-ug-net/using-effectively.html)它是一个命令行实用程序，用于在 Windows 和 POSIX 路径之间进行转换。因为 Windows 无法理解路径，`zf.sh`无法处理它，因此我可以获得 PHP 版本，但 PHP 无法理解文件的路径以使用它们，因此出现`Could not open input file`错误。所以 PHP 需要的只是理解路径。

所以阅读`cygpath`给定链接中的帮助，我能够理解这个命令并使官方适应`zf.sh`我的需要。所以我把它改成了最后一行：

```
"$PHP_BIN" -d safe_mode=Off -f "$PHP_DIR/zf.php" -- "$@" 
```

对此：

```
"$PHP_BIN" -d safe_mode=Off -f "$(cygpath -aw $PHP_DIR/zf.php)" -- "$@" 
```

现在它起作用了！

```
$ zf show version
Zend Framework Version: 1.11.12 
```

希望有人会发现这很有用；）

# r - 使用 plyr 匹配两个数据框中的列值

> ID：12307254
> 
> 赞同：3
> 
> 时间：2012-09-06T19:43:51.400
> 
> 标签：r, plyr, data.table

df

```
av  bv  tv   u   l value           s
30 120 360 330 210  6600 0.005238424 
35 125 360 325 200  6875 0.005028887
40 130 360 320 190  7150 0.004835468
45 135 360 315 180  7425 0.004656377
50 140 360 310 170  7700 0.004490078
55 145 360 305 160  7975 0.004335247
60 150 360 300 150  8250 0.004190739
65 155 360 295 140  8525 0.004055554
70 160 360 290 130  8800 0.003928818
75 165 360 285 120  9075 0.003809763
80 170 360 280 110  9350 0.003697711 
```

输入（df）

```
df<-structure(list(av = c(30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 
80), bv = c(120, 125, 130, 135, 140, 145, 150, 155, 160, 165, 
170), tv = c(360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 
360), u = c(330, 325, 320, 315, 310, 305, 300, 295, 290, 285, 
280), l = c(210, 200, 190, 180, 170, 160, 150, 140, 130, 120, 
110), value = c(6600, 6875, 7150, 7425, 7700, 7975, 8250, 8525, 
8800, 9075, 9350), s = c(0.005238424, 0.00502888704, 0.00483546830769231, 
0.00465637688888889, 0.00449007771428572, 0.00433524744827586, 
0.0041907392, 0.00405555406451613, 0.003928818, 0.00380976290909091, 
0.00369771105882353)), .Names = c("av", "bv", "tv", "u", "l", 
"value", "s"), row.names = c(1L, 13L, 25L, 37L, 49L, 61L, 73L, 
85L, 97L, 109L, 121L), class = "data.frame") 
```

df2

```
 av  bv  tv   u  l value
  30 120   0   0  0     0
  30 120  20   0  0     0
  30 120  40  10  0   550
  30 120  60  30  0  1650
  30 120 120  90  0  4950
  30 120 180 150 30  6600 
```

输入（df2）

```
df2<-structure(list(av = c(30, 30, 30, 30, 30, 30), bv = c(120, 120, 
120, 120, 120, 120), tv = c(0, 20, 40, 60, 120, 180), u = c(0, 
0, 10, 30, 90, 150), l = c(0, 0, 0, 0, 0, 30), value = c(0, 0,
550, 1650, 4950, 6600)), .Names = c("av", "bv", "tv", "u", "l", 
"value"), row.names = c(1L, 2602L, 5203L, 7804L, 10405L, 13006L
), class = "data.frame") 
```

我要做的就是将`df$s`值添加`df`到`df2`where `df$bv == df2$bv`。`df2`中会有更多相同的`bv`值`df`，因此会有一些重复的`s`值。

我正在尝试以下

```
 newDF <- ddply(df2, .(bv,tv), summarise, s = df[df$bv %in% df2$bv,]$s) 
```

虽然这对我不起作用，但也许是因为我并不真正理解这个函数中的变量参数。

在这一点上，实际上所有其他列都是任意的，但我想保持整个数据框完好无损。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-06T20:20:31.193

这会将“df”中相应的“s”项拉入“df2”的匹配行中：

```
df2$s <- df$s[ match(df2$bv, df$bv)]
df2
#-----------------------
      av  bv  tv   u  l value           s
1     30 120   0   0  0     0 0.005238424
2602  30 120  20   0  0     0 0.005238424
5203  30 120  40  10  0   550 0.005238424
7804  30 120  60  30  0  1650 0.005238424
10405 30 120 120  90  0  4950 0.005238424
13006 30 120 180 150 30  6600 0.005238424 
```

这将比 'subset()' 和 'merge()' 更有效。哎呀。我没有看到 plyr 部分。它也将比任何 plyr 方法快得多，但那是因为我是一个 base-R 人。如果你想用 plyr 来做，那么这会提供我认为你所要求的：

```
> newDF <- ddply(df2, .(bv), summarise, s = df$s[match(df2$bv , df$bv)])
> newDF
   bv           s
1 120 0.005238424
2 120 0.005238424
3 120 0.005238424
4 120 0.005238424
5 120 0.005238424
6 120 0.005238424 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-06T23:27:14.873

尽管问题已得到解答，但我想我会使用该`data.table`软件包为您提供解决此问题的不同方法。

```
library(data.table)
df <- data.table(df)
setkey(df, bv)
df2 <- data.table(df2)
setkey(df2, bv)
 df2[df, roll = T] 
```

我想你的完整数据集比这个简单的例子要大得多，所以你可能会得到更好的性能`data.table`。

```
 > system.time(df2[df, roll = T])
   user  system elapsed 
  0.007   0.000   0.008 
> system.time(ddply(df2, .(bv), summarise, s = df$s[match(df2$bv , df$bv)]))
   user  system elapsed 
  0.013   0.001   0.065 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-06T19:48:42.387

```
dfsub<-data.frame(bv=df$bv,s=df$s)
newdf<-merge(df2,dfsub,by="bv",all=TRUE) 
```

如果您不希望添加未`df`出现的额外值，`df2`请删除`all=TRUE` 例如

```
newdf<-merge(df2,dfsub,by="bv") 
```

编辑

在我的情况下，它本来是：

```
df2sub<-data.frame(bv=df2$bv)
dfsub<-data.frame(bv=df$bv,s=df$s)
newdf<-merge(df2sub,dfsub,by="bv")

newdf
   bv           s
1 120 0.005238424
2 120 0.005238424
3 120 0.005238424
4 120 0.005238424
5 120 0.005238424
6 120 0.005238424 
```

# coldfusion - 在 ColdFusion 中替换而不丢失字符

> ID：12307268
> 
> 赞同：1
> 
> 时间：2012-09-06T19:44:37.157
> 
> 标签：coldfusion, coldfusion-9

我有一个字符串，我想用它`replace()`来删除一些字符而不丢失字符值，包括间距。

这是一个例子：

```
Extremely Dissatisfied_______________________________________Extremely Satisfied 
```

我想在这个字符串上使用替换：

```
<cfoutput>
#REPLACE("#attributes.question.questionsub#","_","","ALL")#
</cfoutput> 
```

得到类似的东西

```
Extremely Dissatisfied                                       Extremely Satisfied 
```

但相反，我得到了这个：

```
Extremely DissatisfiedExtremely Satisfied 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T19:52:08.953

我找到了答案：

```
<cfoutput>
#REPLACE("#attributes.question.questionsub#","_","&nbsp;","ALL")#
</cfoutput> 
```

# c# - C++ CLR Windows 窗体应用程序是否结合了 C++ 和 C# 的所有优点？

> ID：12307269
> 
> 赞同：4
> 
> 时间：2012-09-06T19:44:37.247
> 
> 标签：c#, c++, .net, clr

如果我选择创建 C++ CLR Windows 窗体应用程序，这是否意味着我能够使用整个 C++ 集以及所有 C# .NET 库？

如果这个问题听起来很愚蠢，我很抱歉，但我真的很想知道我是否应该使用 CLR。

# html - 为什么我不能实现@font-face？

> ID：12307270
> 
> 赞同：-2
> 
> 时间：2012-09-06T19:44:39.193
> 
> 标签：html, css, fonts, font-face

我的问题是自定义字体在使用时不显示`@font-face`。

我的 CSS 在它自己的文件中被引用，代码是：

```
@font-face {
    font-family: 'MerceariaAntique';
    src: url('type/mercearia_new/21319b_0_0-mercearia.eot');
    src: url('type/mercearia_new/21319b_0_0-mercearia.eot?#iefix') format('embedded-    opentype'),
         url('type/mercearia_new/21319b_0_0-mercearia.woff') format('woff'),
         url('type/mercearia_new/21319b_0_0-mercearia.ttf') format('truetype'),
         url('type/mercearia_new/21319b_0_0-mercearia.svg#webfontuploaded_file')     format('svg');
    font-weight: normal;
    font-style: normal;
    } 
```

在我的 HTML 文件中，我在主 CSS 文件旁边将其引用为以下内容：

```
<link rel="stylesheet" type="text/css" media="all" href="css/fonts.css" /> 
```

我怀疑我错误地引用了它，但我不知道如何正确引用它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T19:55:18.660

你的文件夹结构是什么？如果您在文件夹“css”中调用 css，则必须指出自定义字体的正确路径，例如“../”

```
src: url('../type/mercearia_new/21319b_0_0-mercearia.eot'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T19:50:14.507

以下是如何使用@font-face 的示例：

```
@font-face {
  font-family: "Example Font";
  src: url("http://www.example.com/fonts/example");
}
h1 {
  font-family: "Example Font",  sans-serif;
} 
```

我假设您已经检查了字体文件的路径并且它们是正确的。我还假设您已经检查了错误控制台是否有任何 CSS 警告或错误，例如找不到文件。

尝试仔细检查您在代码中将字体分配为 a的位置`font-family`。

另外，`font-face`参考：[http ://reference.sitepoint.com/css/at-fontface](http://reference.sitepoint.com/css/at-fontface)

**更新：**试试Google 的[WebFont Loader](https://developers.google.com/webfonts/docs/webfont_loader#Example)

# sql-server-2008 - 如何从一个表中获取一行并将其插入另一个表并获取新的 PK 值

> ID：12307273
> 
> 赞同：0
> 
> 时间：2012-09-06T19:44:40.993
> 
> 标签：sql-server-2008, c#-4.0

我在不同的数据库上有两个相似的表。

```
Database1/TableA

Database2/TableA 
```

我想从一个表中获取一行并将其插入到其他服务器上的另一个表中。像：

```
Database1/TableA
Id        State            Name
500        OH              John  [Fetch this row]

Database2/TableA
Id        State            Name
1          OH              John  [Insert and fetch PK '1'] 
```

我使用批量复制尝试了这个，它工作正常。

但问题是我需要从新插入中获取 PK，因为我需要填充另一个子表。

有没有更好的方法来实现这一目标？请使用 C# 代码，不要使用数据库链接或 SQL 查询。只是 C# 解决方案。或者，如果可以在 C# 代码中使用查询，那很好。任何带有 Dataset 或 Datarow 的工作示例代码都会有很大帮助。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T19:53:32.157

首先，您需要从中获取行`Database.TableA`。例如，您可以将 a`SqlDataAdapter`与 a`DataTable`或 a一起使用`SqlDataReader`。

[SCOPE_IDENTITY](http://msdn.microsoft.com/en-us/library/ms190315.aspx)返回插入到同一范围内的标识列中的最后一个标识值。范围是一个模块：存储过程、触发器、函数或批处理。因此，如果两条语句在同一个存储过程、函数或批处理中，则它们属于同一范围。

您可以使用[SqlCommand.ExecuteScalar](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.executescalar.aspx)执行插入命令并在一次查询中检索新 ID。

```
const String sqlSelect = "SELECT COL1,COl2,Col3 FROM TableA WHERE COL1=@COL1;"
const String sqlInsert = "INSERT INTO TableA (COl2,Col3)VALUES (@Col2,@Col3);"
                       + "SELECT CAST(scope_identity() AS int)";
using (var con1 = new SqlConnection(db1ConnectionString))
using (var con2 = new SqlConnection(db2ConnectionString))
{
    con1.Open();
    con2.Open();
    using(var selectCommand = new SqlCommand(sqlSelect, con1))
    {
        selectCommand.Parameters.AddWithValue("@COL1", 4711);
        using (var reader = selectCommand.ExecuteReader())
        {
            if (reader.Read())
            {
                int newID;
                using (var insertCommand = new SqlCommand(sqlInsert, con2))
                {
                    for (int i = 0; i < reader.FieldCount; i++)
                    {
                        insertCommand.Parameters.AddWithValue("@" + reader.GetName(i), reader[i]);
                    }
                    newID = (int)insertCommand.ExecuteScalar();
                }
            }
        }
    }
} 
```

# opengl - GLSL中的纹理与texture2D

> ID：12307278
> 
> 赞同：29
> 
> 时间：2012-09-06T19:44:55.627
> 
> 标签：opengl, glsl

在 GLSL (a `uniform sampler2D`) 中对 2D 纹理进行采样时，`texture`使用该函数并从采样器中推断出尺寸（在本例中为 2D）。这是自 1.30 以来在 GLSL 中采样纹理的现代方式（[GLSL 参考页](http://www.opengl.org/sdk/docs/manglsl/)）。但是，您也可以使用该`texture2D`功能。

该`texture2D`函数是否已弃用，如果是，是否会`texture2D`在某些版本的 GLSL 中删除（或已删除）对该函数的支持？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-09-06T22:16:05.137

是的，`texture2D()`（至少）OpenGL 3.3 已弃用；请参阅[3.30 GLSL 规范](http://www.opengl.org/registry/doc/GLSLangSpec.3.30.6.clean.pdf)的第 99 页。OpenGL 兼容性配置文件将继续支持它以避免破坏现有代码，但强烈建议不要在新代码中使用它。

**编辑**：OpenGL ES 的细节略有不同，但最终结果是相同的：在 OpenGL ES 3.0 中`texture2D()`已弃用并替换为；[请参阅3.0 GLSL ES 规范](https://www.khronos.org/registry/gles/specs/3.0/GLSL_ES_Specification_3.00.3.pdf)`texture()`的第 8.8 节。

# sublimetext2 - 用于格式化评论的插件

> ID：12307284
> 
> 赞同：0
> 
> 时间：2012-09-06T19:45:27.700
> 
> 标签：sublimetext2

谁能指出我的插件方向或其他格式化评论？

我使用的是coffeescript，注释与python 相同（#line，### 块###），尽管javascript 注释也直接通过编译器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T19:05:09.077

好的，事实证明，`Edit -> Wrap`评论保持不变 - 完整的 newby。

还有[https://github.com/spadgos/sublime-jsdocs](https://github.com/spadgos/sublime-jsdocs)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-06T06:06:22.573

我没有插件，但我可以提供我编写的 python 脚本。在“用户输入的评论”（uec）变量中输入您的评论作为字符串，保存并运行。它将格式化一个由 80 个字符的井号包围的块引用。如果您需要更短或更长的块报价，则只需更改 80、78 和 76。

```
def first2lines(): return str(('#' * 80) + '\n' + '#' + (' ' * 78) + '#') # first two lines
def leftSide(): return '# '                                               # left side of border
def rightSide(): return ' #'                                              # right side of border
def last2lines(): return str('#' + (' ' * 78) + '#' + '\n' + ('#' * 80))  # last two lines

# user entered comment
uec = "This program will neatly format a programming comment block so that it's surrounded by pound signs (#). It does this by splitting the comment into a list and then concatenating strings each no longer than 76 characters long including the correct amount of right side space padding. "

if len(uec) > 0:
    eosm = '<<<EOSM>>>'                                   # end of string marker
    comment = uec + ' ' + eosm
    wordList = comment.split()                            # load the comment into a list
    tmpString = ''                                        # temporarily holds loaded elements
    loadComment = ''                                      # holds the elements that will be printed
    counter = 0                                           # keeps track of the number of elements/words processed
    space = 0                                             # holds right side space padding
    last = wordList.index(wordList[-1])                   # numerical position of last element

    print first2lines()
    for word in wordList:
        tmpString += word + ' '                           # load the string until length is greater than 76

        # processes and prints all comment lines except the last one
        if len(tmpString.rstrip()) > 76:
            tmpList = tmpString.split()
            tmpString = tmpList[-1] + ' '                 # before popping last element load it for the beginning of the next cycle
            tmpList.pop()
            for tmp in tmpList:
                loadComment += tmp + ' '
            loadComment = loadComment.rstrip()
            space = 76 - len(loadComment)
            print leftSide() + loadComment + (space * ' ') + rightSide()
            loadComment = ''

        # processes and prints the last comment line
        elif len(tmpString.rstrip()) <= 76 and counter == last:
            tmpList = tmpString.split()
            tmpList.pop()
            for tmp in tmpList:
                loadComment += tmp + ' '
            loadComment = loadComment.rstrip()
            space = 76 - len(loadComment)
            print leftSide() + loadComment + (space * ' ') + rightSide()

        counter += 1
    print last2lines()

else:
    print first2lines()
    print leftSide() + "The length of your comment is zero, it must be at least one character long. " + rightSide()
    print last2lines() 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-31T09:01:01.870

您可以使用 netbeans，它具有自动格式化 Alt+Mayus+F

# java - Java loadLibrary() 从 64 位 jdk 切换到 32 位后找不到库

> ID：12307289
> 
> 赞同：2
> 
> 时间：2012-09-06T19:45:44.183
> 
> 标签：java, dll, jvm, loadlibrary

我正在尝试加载一个相应地加载原始 dll 的本机库。但是在另一台运行 XP 32bit 的计算机上，它工作正常。在 win7 64 位系统上执行时将无法加载。在 xp 机器上，dll 文件可能与类文件位于同一目录中，但是为了不出现不满意的链接错误，我不得不将文件复制到 system32 文件夹中。然后它给出了一个错误，指出不能在 64 位进程上加载 32 位 dll。我下载了32位jdk，并在项目中设置jdk加载32位jdk。完成后，我再次收到不满意的链接错误，文件仍在 system32 以及类文件旁边。我很困惑为什么它会在使用 64 位 jdk 时找到库，而在 32 位 jdk 中找不到。

```
...
static {
    System.loadLibrary("K8055jni");
} 
```

* * *

```
Exception in thread "main" java.lang.UnsatisfiedLinkError: no K8055jni in java.library.path
at java.lang.ClassLoader.loadLibrary(ClassLoader.java:1860)
at java.lang.Runtime.loadLibrary0(Runtime.java:845)
at java.lang.System.loadLibrary(System.java:1084)
at K8055jni.<clinit>(K8055jni.java:50)
at Test.main(Test.java:4) 
```

如何让 32 位 jdk 找到相同的文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T20:05:59.810

如果我正确理解您的问题和问题，那么您可以尝试以下任一方法：

1.  Windows 7 将您的 32 位 DLL 放入 \Windows\SysWOW64 而不是 \Windows\System32。奇怪的是，在 Win 7 下，System32 仅适用于 64 位二进制文​​件。有关详细信息，请参阅[此](http://www.samlogic.net/articles/32-64-bit-windows-folder-x86-syswow64.htm)和[此](http://en.wikipedia.org/wiki/WoW64)。

2.  更好的是，将二进制文件放在应用程序文件夹中，并在 java 命令行中指定：

    `-Djava.library.path=<path-to-dll-lib>`

# google-fusion-tables - 我们的 fusion 桌子在一个小的改变后很快就失去了所有的风格

> ID：12307291
> 
> 赞同：1
> 
> 时间：2012-09-06T19:45:48.813
> 
> 标签：google-fusion-tables

我有同一张表的一系列融合表视图，每个视图都使用不同的列来设置多边形填充或渐变的样式。原始表本身是几个表的合并。

在我只更改了一个视图（更改多边形填充颜色渐变）后不久，这对于前半个小时左右的回合来说很好，样式开始表现得很有趣。现在大约 2 小时后，地图正在手动加载为灰色（“数据可能仍在加载”）。想知道这种样式的变化是否与每个视图的样式都表现得很奇怪有关。这是创建视图的基表：[https ://www.google.com/fusiontables/embedviz?viz=MAP&q=select+col6%3E%3E1+from+1tGJyhsf9R2F9zFSmcsuleLYGLLcAXR0fTLzBX5g&h=false&lat=54.72855272934226&lng=-68.35017360696 5&t=1&l=col6%3E%3E1](https://www.google.com/fusiontables/embedviz?viz=MAP&q=select+col6%3E%3E1+from+1tGJyhsf9R2F9zFSmcsuleLYGLLcAXR0fTLzBX5g&h=false&lat=54.72855272934226&lng=-68.35017360696594&z=5&t=1&l=col6%3E%3E1)

或者它们只是 Fusion Tables 的一些临时渲染问题？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T21:28:02.533

There was a temporary issue that we have have resolved. Thanks for reporting the problem.

# php - json 将 php 变量编码为 javascript

> ID：12307297
> 
> 赞同：-1
> 
> 时间：2012-09-06T19:46:19.480
> 
> 标签：php, javascript, json

我正在使用这样的 php 从 MySql 中检索数据 =>

```
while ($birthday_row = $birthday_r->fetch_row()){
    $birthday_array[] = array(
    'title' => $birthday_row[0],
    'start' => $birthday_row[1] . "-" . $birthday_row[2]
    );
} 
```

JavaScript：

```
var json_obj_birthday = <?php if (isset($birthday_array)){echo json_encode($birthday_array);} ?>;
var json_obj_birthday_len = json_obj_birthday.length;
var d = new Date();
var event = [];
for (var i=0;i<json_obj_birthday_len;i++){ // adding manually year
    json_obj_birthday[i].start = d.getFullYear() + "-" + json_obj_birthday[i].start;
    event = {
        'title' : json_obj_birthday[i].title,
        'start' : json_obj_birthday[i].start
    };
} 
```

在上面的 JavaScript 代码到`event`数组中只存储第一个数据，它只存储`json_obj_birthday[0]`，我怎样才能将所有信息存储到`event`数组中？谢谢

PS。我希望该数组`event`使用完整信息进行 json 编码

**更新**

现在我试过这样

```
var events = <?php if (isset($birthday_array)){echo json_encode($birthday_array);} ?>;
        var d = new Date();
        for (var i = 0; i < events.length; i++){
            events[i].start = d.getFullYear() + "-" + events[i].start;
        } 
```

也没有得到想要的结果

**第二次更新**

我需要我正在尝试做的事情，因为想将此`event`变量传递给 jQuery 完整日历，这里是脚本 =>

```
jQuery("#calendar").fullCalendar({ // initialize full calendar
        header: {
            left: 'prev,next today',
            center: 'title',
            right: 'month,basicWeek,basicDay'
        },
        events: [
            event
        ] // here was my fault , I must to have `events: event,`
    }); 
```

绑定你的代码后，日历中的信息没有插入，这就是我的意思不起作用

PS。如果有人对我在做什么以及为什么更感兴趣，请看一下我之前的问题，也[可以每年将生日事件添加到 jQuery 完整日历中](https://stackoverflow.com/questions/12306351/add-birthday-events-into-jquery-full-calendar-each-year)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T19:52:48.643

为什么不直接将 json 分配给`events`，然后更正`start`条目？

```
var events = <?php echo isset($birthday_array) ? json_encode($birthday_array) : "[]" ?>;
var d = new Date();
for (var i = 0; i < events.length; i++){
    events[i].start = d.getFullYear() + "-" + events[i].start;
} 
```

请注意，我在 PHP 中添加了一个子句，以便如果`$birthday_array`未设置，javascript 会收到一个空数组，而不是语法错误。

* * *

您的代码不起作用，因为该行将存储的数组`event = { ... }` *替换*`event`为单个 javascript 对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T19:57:18.063

PHP：

```
while ($birthday_row = $birthday_r->fetch_row()){
    $birthday_array[] = array(
    'title' => $birthday_row[0],
    'start' => $birthday_row[1] . "-" . $birthday_row[2]
    );
} 
```

JavaScript：

```
var json_obj_birthday = <?php if (isset($birthday_array)){echo json_encode($birthday_array);} ?>;
var json_obj_birthday_len = json_obj_birthday.length;
var d = new Date();
var event = [];
for (var i=0;i<json_obj_birthday_len;i++){ // adding manually year
    json_obj_birthday[i].start = d.getFullYear() + "-" + json_obj_birthday[i].start;
    event.push({
        'title' : json_obj_birthday[i].title,
        'start' : json_obj_birthday[i].start
    });
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-06T19:55:49.670

```
var json_obj_birthday = <?php if (isset($birthday_array)){echo json_encode($birthday_array);} ?>;
var json_obj_birthday_len = json_obj_birthday.length;
var d = new Date();
var event = [];
for (var i=0;i<json_obj_birthday_len;i++){ // adding manually year
    json_obj_birthday[i].start = d.getFullYear() + "-" + json_obj_birthday[i].start;
  var  event2 = {
        'title' : json_obj_birthday[i].title,
        'start' : json_obj_birthday[i].start
    };
event.push(event2);
} 
```

在javascript中试试这个

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-06T19:58:00.107

我认为你在这里的整个方法是错误的。这是我的做法（此外，它不会显示警告/通知）：

```
<?php

    $birthday_array = array();

    while ($birthday_row = $birthday_r->fetch_row()){
        $birthday_array[] = array(
            'title' => $birthday_row[0],
            'start' => $birthday_row[1] . "-" . $birthday_row[2],
        );
    }

?><script type="text/javascript">

    var json_obj_birthday = <?php echo json_encode($birthday_array); ?>;
    var json_obj_birthday_len = json_obj_birthday.length;
    var d = new Date();
    var event = [];

    for (var i=0; i < json_obj_birthday_len; i++){ // adding manually year
        json_obj_birthday[i].start = d.getFullYear() + "-" + json_obj_birthday[i].start;
        event.push({
            'title' : json_obj_birthday[i].title,
            'start' : json_obj_birthday[i].start
        });
    }

</script> 
```

我的建议是；*总是声明变量*......永远不要只是将/递增/等附加到虚构变量。

最后，虽然将某些处理卸载到客户端 javascript 并没有错，但您可能需要考虑将其放在 PHP/服务器端。只是一个小笔记，不是很重要。

# php - For 循环从 0001 开始而不是 1

> ID：12307302
> 
> 赞同：3
> 
> 时间：2012-09-06T19:46:41.070
> 
> 标签：php, loops, for-loop

我正在做一个从 0001 到 0999 的 for 循环

我怎么能用php做到这一点。到目前为止，我所拥有的只是一个普通的 php for 循环。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-06T19:49:29.017

像这样的东西？

```
for($i = 1; $i<=999; $i++){
    echo str_pad($i, 4, '0', STR_PAD_LEFT);
} 
```

此外，您可以使用`sprintf()`代替`str_pad()`，但我认为`str_pad()`看起来比`sprintf()`这种情况要清晰得多。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-06T19:47:35.880

您要做的是正常循环并格式化输出：

```
for( $i=1; $i<=999; $i++) {  
  $myformat = str_pad($i, 4, '0', STR_PAD_LEFT);         
  // do something with $myformat
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-06T19:49:41.367

试试那个代码：

```
for($n=1;$n<=999;$n++)
{
    $formatted_n = str_pad($n, 4, '0', STR_PAD_LEFT);
    // add some code here
} 
```

[文档`str_pad`](http://php.net/str_pad)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-06T19:51:27.523

```
<?php

for($i=1; $i<=999; $i++) {
 echo str_pad($i, 4, "0", STR_PAD_LEFT);
}

?> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-06T20:31:07.600

这是使用的版本`sprintf()`：

```
foreach (range(1, 999) as $i){
  echo sprintf("%04d", $i); 
} // output: 000100020003... 
```

# javascript - 如何定义常量以与 webkitTransition 一起使用？

> ID：12307303
> 
> 赞同：0
> 
> 时间：2012-09-06T19:46:41.390
> 
> 标签：javascript

如何重写以下内容以使用变量：

```
element.style.webkitTransition = "opacity 1.0s ease"; 
```

我尝试了这些，但它们都不起作用：

```
var kDuration = 1.0;
element.style.webkitTransition = "opacity kDurations ease";

var kDuration = 1.0;
element.style.webkitTransition = "opacity kDuration ease";

var kDuration = 1.0;
element.style.webkitTransition = "opacity kDuration s ease";

var kDuration = 1.0;
element.style.webkitTransition = "opacity kDuration + s ease";

var kDuration = 1.0s;
element.style.webkitTransition = "opacity kDuration ease"; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T19:50:36.443

```
var kDurationfirst = "1.0s"; var kDuration= "opacity "+kDurationfirst +" ease";
element.style.webkitTransition = kDuration ; 
```

# ruby-on-rails - NoMethodError（未定义的方法 `persisted?' for nil:NilClass）：

> ID：12307305
> 
> 赞同：4
> 
> 时间：2012-09-06T19:46:43.940
> 
> 标签：ruby-on-rails

NoMethodError（未定义的方法 `persisted?' for nil:NilClass）：

这是我尝试将omniauth与Devise一起使用时遇到的错误......

我可以使用 facebook 注册该网站...但是一旦我注销并尝试重新登录，我就会得到

NoMethodError（未定义的方法 `persisted?' for nil:NilClass）：

类模型::OmniauthCallbacksController < 设计::OmniauthCallbacksController

def facebook # 你需要在你的模型中实现下面的方法 (eg app/models/user.rb) @model = Model.find_for_facebook_oauth(request.env["omniauth.auth"], current_model)

```
if @model.persisted?
  flash[:notice] = I18n.t "devise.omniauth_callbacks.success", :kind => "Facebook"
  sign_in_and_redirect @model, :event => :authentication
else
  session["devise.facebook_data"] = request.env["omniauth.auth"]
  redirect_to new_model_registration_url
end 
```

结尾

def passthru render :file => "#{Rails.root}/public/404.html", :status => 404, :layout => false # 或者，# raise ActionController::RoutingError.new('Not Found' ） 结尾

结尾

模型.rb

```
class Model < ActiveRecord::Base
  # Include default devise modules. Others available are:
  # :token_authenticatable, :confirmable,
  # :lockable, :timeoutable and 
  devise :database_authenticatable, :registerable,
         :recoverable, :rememberable, :trackable, :validatable, :omniauthable

  # Setup accessible (or protected) attributes for your model
  attr_accessible :name, :email, :password, :password_confirmation, :remember_me, :provider, :uid
  # attr_accessible :title, :body

  def self.find_for_facebook_oauth(auth, signed_in_resource=nil)
    model = Model.where(:provider => auth.provider, :uid => auth.uid).first
    unless model
    model = Model.create(name:auth.extra.raw_info.name,
                         provider:auth.provider,
                         uid:auth.uid,
                         email:auth.info.email,
                         password:Devise.friendly_token[0,20]
                         )
    end
  end

  def self.new_with_session(params, session)
    super.tap do |model|
      if data = session["devise.facebook_data"] && session["devise.facebook_data"]["extra"]["raw_info"]
        model.email = data["email"] if model.email.blank?
      end
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T21:31:23.240

Your `find_for_facebook_oauth` method is implicitly returning nil in cases where a model is found. You should explicitly return the model if it is found instead.

```
def self.find_for_facebook_oauth(auth, signed_in_resource=nil)
  model = Model.where(:provider => auth.provider, :uid => auth.uid).first
  return model if model
  model = Model.create(name:auth.extra.raw_info.name,
                         provider:auth.provider,
                         uid:auth.uid,
                         email:auth.info.email,
                         password:Devise.friendly_token[0,20]
                         )
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-11T20:50:20.300

```
def self.find_for_facebook_oauth(auth, signed_in_resource=nil)
  model = Model.where(:provider => auth.provider, :uid => auth.uid).first
  unless model
  model = Model.create(name:auth.extra.raw_info.name,
                     provider:auth.provider,
                     uid:auth.uid,
                     email:auth.info.email,
                     password:Devise.friendly_token[0,20]
                     )
  end
  model #Add this here
end 
```

# objective-c - 使用 NSDictionary 代码问题在文件中迁移和添加数据

> ID：12307308
> 
> 赞同：0
> 
> 时间：2012-09-06T19:47:00.097
> 
> 标签：objective-c, ios, nsdictionary, nsmutabledictionary

我正在从我的应用程序的旧版本 (v2) 迁移到新版本 (v3)，然后将每个玩家的两个新字段添加到 playerdata.plist 中。我将“99”放在新字段中的原因只是为了测试，因为我正在测试带有额外字段的 v3 文件，以使其更容易。

我想要完成的是：

一个。读取带有播放器数据的文件

湾。添加到新字段

C。存储文件

目前的结果是我在迁移后为每个玩家存储了相同的数据。

代码：

```
- (void)migratePlayerDataPlist {
//====THIS PIECE OF CODE SHOULD BE REMOVED AFTER CERTAIN TIME AS IT WILL NOT BE NEEDED====//
//====..WHEN ALL OLD USERS HAVE MIGRATED. THIS IS WRITTEN SEPTEMBER 5 2012 VERSION 3.0====//

// This procedure migrates the old playerdatafile to version 3 of the game

//Prepare File Manager
NSString *filePath = [self dataFilePath]; 

NSFileManager *fileMgr;
fileMgr = [NSFileManager defaultManager];

if ([fileMgr fileExistsAtPath: filePath] == YES) {

    dataArray = [[NSMutableArray alloc]init];

    NSMutableDictionary *gameFileDict = [NSMutableDictionary dictionaryWithContentsOfFile:filePath];

    NSLog(@"gameFileDict: %@", gameFileDict);

    myKeyArray = [gameFileDict allKeys];

    int nrOfKeys = [myKeyArray count];

    NSMutableDictionary *migrationDict = [[NSMutableDictionary alloc]initWithCapacity:200];
    NSMutableDictionary *xmigrationDict = [[NSMutableDictionary alloc]initWithCapacity:200];
    NSLog(@"nrOfKeys: %i", nrOfKeys);

    for (int oo = 0; oo < nrOfKeys; oo++) {

        [dataArray removeAllObjects]; // Clean array

        theObjects = [gameFileDict valueForKey:[myKeyArray objectAtIndex:oo]];
        [dataArray addObject:[theObjects objectAtIndex:0]]; // diffSelection
        [dataArray addObject:[theObjects objectAtIndex:1]]; // # of games played
        [dataArray addObject:[theObjects objectAtIndex:2]]; // # correct answers
        [dataArray addObject:[theObjects objectAtIndex:3]]; // # questions
        [dataArray addObject:[NSNumber numberWithInt:99]];   // >>New field<< # of games won
        [dataArray addObject:[NSNumber numberWithInt:99]];   // >>New field<< # of games lost

        xmigrationDict = [NSMutableDictionary dictionaryWithObjectsAndKeys:dataArray, [myKeyArray objectAtIndex:oo], nil];

        [migrationDict addEntriesFromDictionary:xmigrationDict];
    }

    NSLog(@"xmigrationDict: %@", xmigrationDict);
    NSLog(@"migrationDict: %@", migrationDict);
    NSLog(@"theObjects: %@", theObjects);

    // Delete the old file
    [fileMgr removeItemAtPath:filePath error:NULL];

    // Resave the file with the new data
    [migrationDict writeToFile:filePath atomically: TRUE];

    //  ...and the migration is done

}   
} 
```

当前基于 NSLog 的输出：

```
2012-09-06 20:57:50.332 xxxx_3[1505:fb03] gameFileDict: {
Barnspelare =     (
    1,
    1,
    2,
    2,
    1,
    0
);
"Ton\U00e5rsspelare" =     (
    2,
    0,
    0,
    0,
    0,
    0
);
Vuxenspelare =     (
    3,
    1,
    0,
    2,
    0,
    1
);
}
2012-09-06 20:57:50.334 xxxx_3[1505:fb03] nrOfKeys: 3
2012-09-06 20:57:50.335 xxxx_3[1505:fb03] xmigrationDict: {
"Ton\U00e5rsspelare" =     (
    2,
    0,
    0,
    0,
    99,
    99
);
}
2012-09-06 20:57:50.336 xxxx_3[1505:fb03] migrationDict: {
Barnspelare =     (
    2,
    0,
    0,
    0,
    99,
    99
);
"Ton\U00e5rsspelare" =     (
    2,
    0,
    0,
    0,
    99,
    99
);
Vuxenspelare =     (
    2,
    0,
    0,
    0,
    99,
    99
);
}
2012-09-06 20:57:50.336 xxxx_3[1505:fb03] theObjects: (
2,
0,
0,
0,
0,
0
) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T21:12:12.883

我认为有一种更简单的方法。这是一种方法：

（假设您已在名为的字典中获取数据`d`并跳过您读取/写入文件的部分......）

```
 NSMutableDictionary *md = [d mutableCopy];
    for (NSString *key in d)
    {
        NSMutableArray *values = [[md valueForKey:key] mutableCopy];
        [values addObject:[NSNumber numberWithInt:99]]; // 1st new field
        [values addObject:[NSNumber numberWithInt:99]]; // 2nd new field
        [md setObject:values forKey:key];
    } 
```

* * *

现在你的新字典（`md`）包含：

```
{
    Barnspelare =     (
        1,
        1,
        2,
        2,
        1,
        0,
        99,
        99
    );
    "Ton\U00e5rsspelare" =     (
        2,
        0,
        0,
        0,
        0,
        0,
        99,
        99
    );
    Vuxenspelare =     (
        3,
        1,
        0,
        2,
        0,
        1,
        99,
        99
    );
} 
```

# drupal-7 - 具有自动完成功能的自定义字段

> ID：12307312
> 
> 赞同：0
> 
> 时间：2012-09-06T19:47:20.830
> 
> 标签：drupal-7

我正在尝试构建我自己的节点引用自定义字段 - 我知道那里有几个项目已经这样做了，我正在构建它以便学习...... :)

我的问题是自动完成路径，它没有被触发，我检查了 noderefcreate 项目并基于该项目实施了我的解决方案。但是还是；当我检查萤火虫时，什么都没有被触发。

这是我的代码：

```
function nodereference_field_widget_info() {
  return array(
    'nodereference_nodereference_form' => array(
      'label' => t('Node Reference Form'),
      'field types' => array('nodereference'),
      'behaviors' => array(
        'multiple values' => FIELD_BEHAVIOR_DEFAULT,
        'default value' => FIELD_BEHAVIOR_DEFAULT,
      ),
      'settings' => array(
        'autocomplete_match' => 'contains',
        'autocomplete_path' => 'nodereference/autocomplete',
      ),
    ),
  );
}

function nodereference_field_widget_form(&$form, &$form_state, $field, $instance, $langcode, $items, $delta, $element) {
  if ($instance['widget']['type'] == 'nodereference_nodereference_form') {
    $widget = $instance['widget'];
    $settings = $widget['settings'];

    $element += array(
      '#type' => 'textfield',
      '#default_value' => isset($items[$delta]['nid']) ? $items[$delta]['nid'] : NULL,
      '#autocomplete_path' => $instance['widget']['settings']['autocomplete_path'],
    );
  }

  return array('nid' => $element);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T16:25:51.387

您需要定义自动竞争从中获取建议的方法。可以这样做：

```
/**
 * implements hook_menu
 */
function your_module_name_menu() {
  $items['master_place/autocomplete'] = array(
    'page callback' => '_your_module_name_autocomplete',
    'access arguments' => array('access example autocomplete'),
    'type' => MENU_CALLBACK
  );
  return $items;
}

/**
 * Auto complete method implementation
 * @param $string
 */
function _your_module_name_autocomplete($string) {
  $matches = array();

  // Some fantasy DB table which holds cities
  $query = db_select('target_db_table', 'c');

  // Select rows that match the string
  $return = $query
    ->fields('c', array('target_column'))
    ->condition('c.target_column', '%' . db_like($string) . '%', 'LIKE')
    ->range(0, 10)
    ->execute();

  // add matches to $matches
  foreach ($return as $row) {
    $matches[$row->city] = check_plain($row->city);
  }

  // return for JS
  drupal_json_output($matches);
} 
```

# node.js - 在heroku上的socket.io上获取socket ip

> ID：12307319
> 
> 赞同：2
> 
> 时间：2012-09-06T19:47:37.847
> 
> 标签：node.js, heroku, socket.io

我在heroku上使用socket.io，在socket连接上我想获取客户端IP，目前我得到的IP不是真实IP（我认为这是heroku的IP）。

我正在使用 socket.manager.handshaken[socket.id].address.address 来获取用户的 ip .. 你还有其他方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T19:55:58.517

尝试：

`socket.manager.handshaken[socket.id].remoteAddress`

如果您需要客户端端口，那将是： `socket.manager.handshaken[socket.id].remotePort`

# visual-studio - 如何在 Visual Studio 中创建托管 C++ 静态库（错误 C1189）

> ID：12307324
> 
> 赞同：0
> 
> 时间：2012-09-06T19:48:12.523
> 
> 标签：visual-studio, visual-c++, clr, static-libraries, managed

似乎不可能在托管 /CLR 生成的代码中创建静态链接库。我首先创建了一个默认为 DLL 库的 C++ /CLR 库。当我将其更改为**静态库 (.lib)**时，出现错误：

C1189 “使用 /MD[d]（CRT dll 版本）构建 MFC 应用程序需要 MFC 共享 dll 版本。请 #define _AFXDLL 或不要使用 /MD[d]”

我不想包含 MFC DLL。我选择了使用标准 Windows 库，所以不确定它为什么认为我正在构建 MFC 应用程序。

当我尝试*“不使用 /MD[d]”*时，我发现所有四个选项（ /MT /MTd /MD /MDd ）都与 /CLR 不兼容

```
D8015 /CLR and /MT command-line options are incompatible
D8015 /CLR and /MTd command-line options are incompatible
C1189 for both /MDd and /MD 
```

我是否正在尝试做一些在托管代码中不可能的事情。那就是创建一个不需要其他外部 DLL 文件的单个托管代码可执行文件？

# google-chrome-extension - IndexedDB、unlimitedStorage 和访问从背景/选项脚本的内容脚本中创建的数据库

> ID：12307326
> 
> 赞同：10
> 
> 时间：2012-09-06T19:48:33.573
> 
> 标签：google-chrome-extension, indexeddb

关于 IndexedDB、unlimitedStorage 权限和从背景/选项脚本访问内容脚本中创建的数据库的几个问题：

1.  “unlimitedStorage”权限是否涵盖在 background.js 中创建的数据库？（在文档中不清楚）
2.  “unlimitedStorage”权限是否涵盖在 content.js 中在匹配域上创建的数据库？
3.  在匹配域上的 content.js 中创建的数据库是无方案的吗？（即在 http:// 和 https:// 上运行的内容脚本会访问同一个数据库吗？）
4.  是否可以从其他扩展的内容脚本访问在匹配域的内容脚本中创建的数据库，并且它会在扩展删除后继续存在吗？
5.  从 background/options.js 访问给定域的数据库的方法是什么？（假设没有可用于向其发送消息的内容脚本）

我希望 1-4 的答案是肯定的，但最好从开发人员那里得到明确的答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-27T11:36:47.757

是的，你所有的问题（除了问题 4）... ^_^

顺便说一句，我建议您只在 background.js 中直接与 localStorage（或其他一些）交互，然后其他脚本可以通过 background.js 处理 localStorage 数据（使用[消息传递](http://developer.chrome.com/extensions/messaging.html)）

# objective-c - 在 Objective C 中使用多个模型设计控制器

> ID：12307329
> 
> 赞同：0
> 
> 时间：2012-09-06T19:48:39.383
> 
> 标签：objective-c

我正在为 Mac 应用程序设计一个控制器，其中我有多个模型，这些模型从多个来源获取数据。例如我的控制器类是 DataController 和模型是 (HTTPData, SQLiteData) 我应该如何使用控制器中的模型类，我应该根据服务类型的一些参数来分配它们，还是应该使用弱引用？

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T19:50:56.833

也许尝试使用泛化，这意味着拥有一个基本控制器，然后是处理您支持的不同类型数据的子类

# javascript - jQuery展开和折叠功能

> ID：12307334
> 
> 赞同：1
> 
> 时间：2012-09-06T19:48:44.383
> 
> 标签：javascript, jquery, expand, collapse

我是 Jquery/javascript 的新手，我自己有一堆链接级别，我需要将这些链接组织到可以通过 +/- 按钮展开和折叠的列表中。

我正在使用的信息的一个例子是：

```
Category1 (Level 1)
- Subcategory 1 (Level 2)
- Subcategory 2
- Subcategory 3
Category2 (Level 1)
- Subcategory 1 (Level 2)
- Subcategory 2
- Subcategory 3
Category3 (Level 1)
- Subcategory 1 (Level 2)
----Subcategory 1 (Level 3)
- Subcategory 2
- Subcategory 3 
```

代码明智的，它看起来像这样：

```
<div class="navCol">
<h4>Pet Club</h4>
<ul>
    <li><a href="/pc/home">Pet Home</a></li>
    <li><a href="/pc/articles">Arts</a></li>
    <li><a href="/pc/coupons">ns</a></li>
    <li><a href="/pc/pet-prescriptions">Pet Prescrions</a></li>
</ul>
</div>
<div class="navCol">
<h4>Fresh Ideas</h4>
<ul>
    <li><a href="/fi/cooking-guide">Know Yur Food</a></li>
    <li><a href="/fi/departments">Depaments</a></li>
    <li><a href="/fi/gluten-free">Free</a></li>
    <li><a href="/fi/house-of-bbq">HoBQ</a></li>
    <li><a href="/fi/how-to-shop">rt</a></li>
    <li><a href="/fi/kids-cooking-club">Kidsb</a></li>
    <li><a href="/fi/price-chopper-products">Tr</a></li>
</ul>
</div>
<div class="navCol">
<h4>vings</h4>
<ul>
    <li><a href="/vings/advantedge-card">w</a></li>
    <li><a href="/vings/baby-club">Bb</a></li>
    <li><a href="/vings/blue-rhino">asdf</a></li>
    <li><a href="/vings/grocery-apps">On </a></li>
    <li><a href="/vings/grocery-coupons">C</a></li>
    <li><a href="/vings/grocery-offers">Em</a></li>
    <li><a href="/vings/grocery-sweepstakes">P</a></li>
    <li><a href="/vings/meal-deals">W</a></li>
    <li><a href="/vings/pc">Pet</a></li>
    <li><a href="/vings/price-chopper-fuel-advantedge">Fuel</a></li>
    <li><a href="/vings/school-vings-program">School</a></li>
    <li><a href="/vings/weekly-flyer">Weekly</a></li>
</ul>
</div> 
```

我希望能够单击类别 +- ，它将显示/隐藏其下方的所有链接。与我正在处理第三级的 category3 中的 subcategory1 相同。我如何能够一直实施到第 3 级？

我应该在所有链接之前加上 L1、L2、L3 标签吗？我已经查看了一些处理 +/- 符号和实现的问题，但我不太了解。

另外，我将如何实现一个在切换时显示全部或全部展开的按钮？也就是说，它会扩展到最深的级别并折叠回仅显示级别 1 的类别。

如果您有任何地方可以让我自己开始学习，那也将不胜感激。这是我的第一个项目，我不知道从哪里开始。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T19:53:00.393

虽然我通常建议在继续使用 jQuery 之前完全掌握 javascript，但后者在这里提供了一个更简单的解决方案。

看看[.toggle()](http://api.jquery.com/toggle/)

编辑：乔希的建议是一个很好的建议，但可能值得事先掌握构建更简单的版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T20:19:10.263

您首先要考虑您的 HTML 结构。您将需要某种嵌套元素来表达列表。我建议使用嵌套`<ul>`元素，因为它在语义上代表您的数据结构。

不用担心有多少关卡；如果你做得对，相同的代码将适用于任何级别的可折叠元素。

您将真正完成三个任务：了解何时单击树元素、查找其子元素以及切换它们的可见性。

您可以使用 jQuery 的[.click()](http://api.jquery.com/click/)处理程序来确定单击元素的时间。但是要小心：例如，如果您有嵌套`<li>`元素，并且您将`$('li').click`其用作事件，您将捕获对子元素的多次点击（因为它们也会触发其父元素的`click`事件）。所以你必须对你的选择器有点聪明。

一旦您能够检测到点击，您就可以使用 jQuery 的[.children()](http://api.jquery.com/children/)函数找到任何子项。

最后，切换子元素的可见性是一件简单的事情，您可以使用 jQuery 的[.toggle()](http://api.jquery.com/toggle/)函数轻松完成。

最后，我同意乔希评论的观点：为什么要重新发明轮子？如果您这样做是为了学习，那很好，您可以使用我在此答案中概述的方法。如果您只是需要它，您应该考虑使用现有的 jQuery 扩展，例如 Josh 对[Accordion](http://jqueryui.com/demos/accordion/)或[jQuery Treeview](http://jquery.bassistance.de/treeview/demo/)的建议。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-06T20:59:31.630

这是一个非常简单的例子[http://jsfiddle.net/xNh6R/4/](http://jsfiddle.net/xNh6R/4/)

Javascript：

```
$('.level1').click(function(){
    if($(this).next('div').is(':visible')){
        $(this).next('div').hide("blind");
    } else {
        $(this).next('div').show("blind");
    }
});

$('.level2').click(function(){
    if($(this).next('div').is(':visible') && $(this).next('div').hasClass("level3")){
        $(this).next('div').hide("blind");
    } else if($(this).next('div').hasClass("level3")) {
        $(this).next('div').show("blind");
    }
});​ 
```

# c - 第二个 printf 与我的第一个 printf 相同，使程序崩溃

> ID：12307335
> 
> 赞同：0
> 
> 时间：2012-09-06T19:48:47.947
> 
> 标签：c, malloc, printf

我显然不是在这里责怪 printf，我可能搞砸了我的内存分配和访问，但我不明白我哪里做错了。程序在 main 中的第二个 printf 上崩溃。如果我评论第二个，它也会在第三个崩溃。实际上，每当我在第一个 printf 之后访问 p 时它就会崩溃！

有人可以解释我做错了什么吗？

非常感谢。

```
typedef struct 
{
    char * firstname;
    char * lastname;
    int age;
} person;

person * new_person(char * firstname, char * lastname, int age)
{
    person p;
    int lf = strlen(firstname);
    int ll = strlen(lastname);
    p.firstname = (char *)malloc(++lf * sizeof(char));
    p.lastname = (char *)malloc(++ll * sizeof(char));
    strcpy(p.firstname, firstname);
    strcpy(p.lastname, lastname);
    p.age = age;

    return &p;
}    

int main()
{
    person * p = new_person("firstname", "last", 28);

    printf("nom : %s ; prenom : %s ; age : %d\n", p->lastname, p->firstname, p->age);
    printf("nom : %s ; prenom : %s ; age : %d\n", p->lastname, p->firstname, p->age);

    printf("nom : %s ; prenom : %s ; age : %d\n", (*p).lastname, (*p).firstname,(*p).age);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-06T19:51:25.787

您正在返回一个局部变量的地址。

您可以修改您`new_person`的参数以获取参数（指向人员的指针），也可以`malloc`在函数内部进行操作并对其进行操作。

当函数返回时，您在函数中声明的人超出范围。之后发生的一切都是未定义的。它可能会巧合地保持其价值一段时间，但你不应该依赖于此。当你调用 printf 时，堆栈会增长并用新的东西覆盖你的人的旧位置。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-06T19:52:21.540

我认为问题出在这一行：

```
return &p; 
```

请注意，您正在返回一个指向局部变量的指针。这会导致未定义的行为，因为一旦函数返回，局部变量`p`就不再存在。结果，读取或写入该指针将读取或写入垃圾数据。

这不会立即崩溃的事实是编译器如何生成代码的产物。很有可能，您第一次调用 时`printf`，它会重用以前使用的空间，而`p`这种方式纯属巧合，效果很好。但是，在函数返回后，它的堆栈帧已经破坏了`p`. 结果，第二次调用`printf`是读取调用留下的垃圾数据`printf`，因此崩溃。

（特别是：当您传递参数时，它将指向字符串的指针复制到堆栈上，因此在`printf`运行时，它可能会丢弃原始指针，但使用副本。然后第二次调用从过期的`printf`堆栈帧中加载垃圾指针，因为它住在以前居住的同一个地址`p`。）

要解决此问题，请考虑更改`p`为指向 a 的指针`person`，然后使用`malloc`来分配它。这样，内存在函数调用之后仍然存在，所以这个崩溃应该会消失。

希望这可以帮助！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-06T19:52:38.280

```
 person p;

// stuff

return &p 
```

这是**错误**的。函数返回后，局部变量将离开作用域——它的地址将无效。您必须在堆上分配结构：

```
person *new_person(char *firstname, char *lastname, int age)
{
    person *p = malloc(sizeof(*p));
    p->firstname = strdup(firstname);
    p->lastname = strdup(lastname);
    p->age = age;

    return p;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-06T19:52:35.823

问题出在函数 new_person 中。您在堆栈上创建人员 p 并返回其地址。您需要分配 person* p = new person(.....

# java - 单个 JDBC 查询中的许多删除查询

> ID：12307348
> 
> 赞同：2
> 
> 时间：2012-09-06T19:49:32.970
> 
> 标签：java, mysql, jdbc

我在课堂上生成删除命令时遇到问题：

```
 private String generateDeleteCommand() {
    StringBuilder deleteCommand = new StringBuilder();
    for (ForeignKey fk : exportedForeignKeys) {
        deleteCommand.append("DELETE FROM ").append(fk.foreignTableName)
                .append(" WHERE ").append(fk.foreignColumnName)
                .append("=:").append(fk.primaryColumnName).append(";\n");
    }
    deleteCommand.append("DELETE FROM ").append(tableName)
            .append(" WHERE ");
    for (String key : primaryKeys.keySet()) {
        deleteCommand.append(key).append("=:").append(key).append(" AND ");
    }
    deleteCommand
            .delete(deleteCommand.length() - 5, deleteCommand.length());
    deleteCommand.append(";");
    System.out.println(deleteCommand);
    return deleteCommand.toString();
} 
```

在 phpmyadmin 中使用时，我得到的查询是有效的 - 但是当我尝试将它与 jdbc executeUpdate() 一起使用时，我得到 MySQLSyntaxError，即对于带有两个导出外键的表“trasy”查询看起来像：

```
DELETE FROM kursy WHERE ID_TRASY=19;
DELETE FROM przystanki WHERE ID_TRASY=19;
DELETE FROM trasy WHERE ID_TRASY=19; 
```

例外：

```
com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your    SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELETE FROM przystanki WHERE ID_TRASY=19;
DELETE FROM trasy WHERE ID_TRASY=19' at line 2 
```

查询之间是否有 \n 无关紧要。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-06T19:51:45.070

使用[`.addBatch()`](http://docs.oracle.com/javase/6/docs/api/java/sql/Statement.html#addBatch%28java.lang.String%29)on 方法`Statement`并分别添加每个`DELETE`查询并将[`.executeBatch()`](http://docs.oracle.com/javase/6/docs/api/java/sql/Statement.html#executeBatch%28%29)它们作为批处理。

如果使用事务，您可以测试每个语句返回的计数，如果有任何问题，您可以测试[`.rollback()`](http://docs.oracle.com/javase/6/docs/api/java/sql/Connection.html#rollback%28%29)整个批次。

我有一个开源项目，它准确地展示了如何做到这一点。

[GitHub 上的 SQL 构建工具包](https://github.com/jarrodhroberson/sqlck)，有一个[AbstractDatabase.java](https://github.com/jarrodhroberson/sqlck/blob/master/src/main/java/com/vertigrated/db/AbstractDatabase.java)类，它有一个`.executeBatch()`方法，您可以复制和使用自己，只需很少修改。它甚至有用于测试每个命令和执行提交/回滚的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T19:55:37.237

jdbc 一次执行**一个**语句，所以你的语句，即使是由 \n 分隔的多个语句，实际上也是作为一条指令执行的，因此来自 m​​ysql。

# mysql - 我可以配置 MySQL 以便新添加的列默认允许空值吗？

> ID：12307357
> 
> 赞同：1
> 
> 时间：2012-09-06T19:50:02.853
> 
> 标签：mysql

我们的开发人员在向现有表添加列时经常忘记指定允许空值。如果在使用 Alter Table 命令添加列时不包含 Null，MySQL 默认不允许空值

有没有办法配置 MySQL 以便新列允许空值，除非在 alter table 命令中明确包含 Not Null？

我们使用 PHPMyAdmin 来更改表，因此通过 PHPMyAdmin 使所有新添加的字段允许空值的方法将起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T19:52:43.417

MySQL 的默认行为**是**`alter table`在命令上默认允许空值。它可能与**PHPMyAdmin**有关。

```
mysql> desc foo;
+-----------+---------+------+-----+---------+-------+
| Field     | Type    | Null | Key | Default | Extra |
+-----------+---------+------+-----+---------+-------+
| id        | int(11) | YES  |     | NULL    |       | 
| client_id | int(11) | YES  |     | NULL    |       | 
| item_id   | int(11) | YES  |     | NULL    |       | 
+-----------+---------+------+-----+---------+-------+
3 rows in set (0.00 sec)

mysql> alter table foo add (a char(1));
Query OK, 0 rows affected (0.01 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql> desc foo;
+-----------+---------+------+-----+---------+-------+
| Field     | Type    | Null | Key | Default | Extra |
+-----------+---------+------+-----+---------+-------+
| id        | int(11) | YES  |     | NULL    |       | 
| client_id | int(11) | YES  |     | NULL    |       | 
| item_id   | int(11) | YES  |     | NULL    |       | 
| a         | char(1) | YES  |     | NULL    |       | 
+-----------+---------+------+-----+---------+-------+
4 rows in set (0.00 sec) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T19:52:50.560

您可以在创建新列时指定 DEFAULT NULL，例如：

```
ALTER TABLE table
ADD COLUMN column VARCHAR(255) DEFAULT NULL; 
```

# sql-server - 从最新的历史表或项目行获取当前数据？

> ID：12307359
> 
> 赞同：0
> 
> 时间：2012-09-06T19:50:15.177
> 
> 标签：sql-server, performance

我必须存储历史定价数据历史列表。我使用历史数据查看过去 28 天。我选择过去 28 天中的最高值，然后将其与当前值进行比较，差值是销售折扣。

我们的 DBA 说将数据存储在具有 FROM DATE 和 TO DATE 的表中，TO DATE 为 NULL 将是当前价格。然而，出于性能原因，他还希望将当前价格存储在库存项目表中。将有触发器来确保库存项目价格与价格历史数据中的最新价格相匹配。我认为库存商品的价格变化不会超过 10 次

我不禁认为在两个位置拥有当前价格是个坏主意。但是，我也喜欢从股票项目行中获取当前股票价格。我们有一个 sql 2000 数据库。

不确定最好的方法是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T19:58:33.667

任何一种方法都是有效的。决定因素应该是每个解决方案的整体性能影响。

由于查找当前价格可能比更新价格更频繁，因此您应该选择一种能够最大限度地提高查找性能的解决方案。

取决于整体设计，这很可能是实际库存项目行中的价格（无论如何，您可能已经为其他数据获取该行）。

更新另一个表中价格的触发器只会在价格更新时执行，因此触发器的性能命中不会影响应用程序的整体性能。

此外，如果您需要经常查找过去 28 天的最高价格，最好让触发器将该值也存储在您的库存项目行中。

这确实会导致一些数据冗余，但性能优势可能是值得的。

数据完整性的关键是确保触发器正常工作。

# visual-studio-2010 - 为 F# 格式化文档

> ID：12307361
> 
> 赞同：2
> 
> 时间：2012-09-06T19:50:28.353
> 
> 标签：visual-studio-2010, f#, format

我想格式化文档：给它缩进之类的东西。

`Ctrl K`Visual Studio 中的+`Ctrl D/F`不适用于 F#，有人对此有任何解决方法吗？它确实适用于 C#...

**编辑：**我想做的是从外部源复制粘贴一些代码。我通常使用`Ctrl K`+`Ctrl D`来格式化它，它适用于 C#。但是，在 .fs 文件中，它似乎不起作用。最重要的是，缩进似乎几乎是 F# 的必备项......

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-06T20:35:48.653

F# 对缩进敏感，因此如果您将有效代码从一个位置复制到另一个位置，您可能需要做的唯一一件事就是确保它与左侧有正确的偏移量。例如，假设您有：

```
let test () = 
  printfn "Hello world" // (*)

let another () = 
  for i in 0 .. 10 do
    test()              // (#)
  printfn "finished" 
```

现在，如果您想复制该行`(*)`并使用它而不是调用`test`，只需复制和粘贴即可将您的代码转换为以下内容：

```
let another () = 
  for i in 0 .. 10 do
  printfn "Hello world" // (*)
  printfn "finished" 
```

但这有不同的含义！它重复这两条`printfn`线10次。所以，相反，你想要得到的是：

```
let another () = 
  for i in 0 .. 10 do
    printfn "Hello world" // (*)
  printfn "finished" 
```

在 Visual Studio 中进行复制和粘贴以保持代码含义相同的方法是像往常一样粘贴复制的代码 ( `Ctrl`+ `V`)，然后在代码仍处于选中状态时更正缩进。进一步使用缩进代码`Tab`并减少缩进使用`Shift`+ `Tab`。

这样，您就可以很好地对 F# 代码使用复制和粘贴。您不需要重新格式化整个块，因为复制到另一个地方的有效 F# 代码将自动格式化。你只需要修复缩进。

关于`#light`注释中提到的模式 - 在 F# 的早期版本中，可以使用额外的关键字和分号来代替缩进敏感模式。现代缩进敏感样式被称为`#light`，但它现在是默认的，您无需担心旧样式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-22T14:54:42.997

似乎唯一的答案是使用其中之一：

[https://github.com/dungpa/fantomas](https://github.com/dungpa/fantomas)

[http://visualstudiogallery.msdn.microsoft.com/24ef5c87-b4e3-4c3b-b126-1064cc66e148](http://visualstudiogallery.msdn.microsoft.com/24ef5c87-b4e3-4c3b-b126-1064cc66e148)

[https://github.com/tpetricek/FSharp.Formatting](https://github.com/tpetricek/FSharp.Formatting)

处理空格等

# sql-server-2008 - SQL Server 2008 left join where 子句基于最大日期

> ID：12307364
> 
> 赞同：1
> 
> 时间：2012-09-06T19:50:42.260
> 
> 标签：sql-server-2008, select, join, where

前几天在这方面得到了一些帮助，现在真的想做出更好的改变

这是代码

```
select 
    machines.serialnum, DRPS.assetnumber, DRPS.MOCALCSUM, DRPS.MICALCSUM,
    DRPS.COCALCSUM, DRPS.CICALCSUM, ISSUED.TotalIssued,
    REDEEMED.TotalRedeemed,drps.dropdate1,drps.dropdate2
from
    (select serialnum
     from machineinfo) as machines
LEFT JOIN 
    (select 
        assetnumber, min(dropdate) as [dropdate1], max(dropdate) as [dropdate2], 
        sum(mocalc) AS [MOCALCSUM], sum(micalc) AS [MICALCSUM],
        sum(cocalc) AS [COCALCSUM],sum(cicalc) AS [CICALCSUM]
     from drops
     where dropdate > '09/04/2012' and dropdate < dateadd(hour, -0, getdate())
     GROUP BY assetnumber) AS DRPS on machines.serialnum = drps.assetnumber
LEFT JOIN 
    (select 
        snissued, cast(sum(amount) as money) / 100 AS [TotalIssued] 
     from tickets
     where  dateissued > '09/04/2012' and dateissued < dateadd(hour, 0, getdate())
     group by snissued) AS ISSUED ON machines.serialnum = ISSUED.snissued
LEFT JOIN 
    (select 
         snredeemed, cast(sum(amount) as money) / 100 AS [TotalRedeemed] 
     from tickets
     where  dateredeemed > '09/04/2012' and dateredeemed < dateadd(hour, 0, getdate())
     group by snredeemed) AS REDEEMED ON machines.serialnum = REDEEMED.snredeemed 
```

如果可能的话，我想要完成的是第二次和第三次连接是`drps.drop1`在 where 子句中使用这样的

```
where  dropdate > drps.dropdate1 and dropdate < drps.dropdate2 
```

但它不起作用

这是工作输出

```
    序列号 MOCALCSUM MICALCSUM COCALCSUM CICALCSUM TotalIssued TotalRedeemed dropdate1 dropdate2
0-2739-41401 5482 5498 132 148 3258.00 3110.00 2012-09-04 13:36:53.450 2012-09-05 13:55:38.750
0-2459-36182 1110 1054 114 58 1895.00 1657.00 2012-09-04 15:01:19.973 2012-09-05 13:55:38.967

```

最终结果是我需要总发行日期和总赎回日期范围在每个序列号的最小和最大日期之间

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T20:37:07.850

```
declare @datebegin datetime
declare @dateend datetime
set @datebegin = '09/04/2012'
set @dateend = '09/08/2012'

select machines.serialnum,     DRPS.MOCALCSUM,DRPS.MICALCSUM,DRPS.COCALCSUM,DRPS.CICALCSUM,ISSUED.TotalIssued,
        REDEEMED.TotalRedeemed,drps.dropdate1,drps.dropdate2

from (select serialnum
    from machineinfo) as machines

LEFT JOIN (select assetnumber,min(dropdate)as [dropdate1], max(dropdate)as [dropdate2], sum(mocalc) AS [MOCALCSUM],sum(micalc) AS [MICALCSUM],
    sum(cocalc) AS [COCALCSUM],sum(cicalc) AS [CICALCSUM]
    from drops
    where  dropdate > @datebegin and dropdate < @dateend AND  (ignore is null)
            group by assetnumber) AS DRPS
    on machines.serialnum = drps.assetnumber
LEFT JOIN (select snissued,cast(sum(amount)as money)/100 AS [TotalIssued] from tickets
where  (dateissued > (select min(dropdate)
                        from drops 
                        where dropdate > @datebegin AND  (ignore is null) and snissued = assetnumber ))
                        and
       (dateissued < (select max(dropdate)
                        from drops 
                        where dropdate < @dateend AND  (ignore is null) and snissued = assetnumber))
group by snissued) AS ISSUED
ON machines.serialnum=ISSUED.snissued
LEFT JOIN (select snredeemed,cast(sum(amount)as money)/100 AS [TotalRedeemed]

from tickets
where  (dateredeemed > (select min(dropdate)
                        from drops 
                        where dropdate > @datebegin AND  (ignore is null)and snissued = assetnumber))
                        and
       (dateredeemed < (select max(dropdate)
                        from drops 
                        where dropdate < @dateend AND  (ignore is null)and snissued = assetnumber ))

group by snredeemed) AS REDEEMED
ON machines.serialnum=REDEEMED.snredeemed
order by REDEEMED.TotalRedeemed desc 
```

根据评论的建议，我将子查询添加到选择中，现在我得到了预期的结果

# php - 检查特定用户是否登录到 facebook

> ID：12307365
> 
> 赞同：0
> 
> 时间：2012-09-06T19:50:44.297
> 
> 标签：php, facebook-graph-api, facebook-php-sdk

我在用户第一次授权我的应用程序时存储用户的 facebook 用户 ID，并将其设置为 cookie，直到他明确没有单击从我的网站注销以保持登录状态。当用户再次打开我的网站时，我想检查该用户是否仍然登录到 facebook。如果没有，我想提示他登录 facebook 以使用我网站的完整功能。如何检查该特定用户是否使用他的 facebook id 登录到 facebook？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-09-06T20:04:44.097

如果在画布页面内并使用 PHP SDK：

```
require_once("lib/facebook-sdk/facebook.php");
$facebook = new Facebook
(   array('appId'=>$fb_app_id, 'secret'=>$fb_app_secret, 'fileUpload'=>true)
);
if ($facebook->getUser()) // if current user has logged in
{   echo "Logged in";
}
else
{   echo "Not logged in";
} 
```

# cloudify - 如何将用户和密码添加到本地 cloudify 部署

> ID：12307367
> 
> 赞同：0
> 
> 时间：2012-09-06T19:50:51.497
> 
> 标签：cloudify

我正在关注 Cloudify 用户指南——它非常容易理解，并且已经成功安装了本地部署。

现在想在web管理界面添加用户和密码，怎么做？默认情况下，Web 界面支持匿名登录。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T17:03:19.953

假设您的目标是获得对部署的完全控制，请使用[Cloudify shell](http://www.cloudifysource.org/guide/2.1/qsg/quick_start_guide#step1)（或“Cloudify CLI”）。

由于 Cloudify shell 当前公开了*只读*操作，因此不需要登录详细信息。但是，可以使用 spring security 来为*REST API*配置安全访问（很快就会记录下来）。

# python - Python中“返回函数外”语法错误的原因？

> ID：12307369
> 
> 赞同：2
> 
> 时间：2012-09-06T19:50:55.677
> 
> 标签：python, syntax-error

我在这段代码中有问题；

```
'return' outside function (<module1>, line 4)   <module1>   4 
```

书中的这段代码叫做**Learn the python hard way**；“练习 25：更多练习”

```
def break_words(stuff):
    """This function will break up words for us."""
words = stuff.split(' ')
return words

def sort_words(words):
    """Sorts the words."""
    return storred(words)

def print_first_word(words):
    """Prints the first word after popping it off."""
    word = words.php(0)
    print word

def sort_last_word(words):
    """prints the last word after popping it off."""
    word = words.pop(-1)
    print word

def sort_sentence(sentence):
    """Takes in a full sentence and returns the sorted words."""
    words = break_words(sentence)
    return sort_words(words)

def print_first_and_last(sentence):
    """Prints the first and last words of the sentence. """
    Words = break_words(sentence)
    print_first_word(words)
    print_last_word(words)

def print_first_and_last_sorted(sentence):
    """Sorts the words then prinits the first and last one."""
    words = sort_sentence(sentence)
    print_first_word(words)
    print_last_word(words) 
```

任何解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T19:51:54.977

在这个函数中，`return`没有正确缩进。

```
def break_words(stuff):
    """This function will break up words for us."""
    words = stuff.split(' ')
    return words 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-06T19:52:03.733

你的缩进关闭了，试试这个：

```
def break_words(stuff):
    """This function will break up words for us."""
    words = stuff.split(' ')
    return words 
```

与其他一些语言不同，缩进是 Python 的关键组成部分——因此确保代码格式正确非常重要。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-06T19:52:37.197

缩进在 python 中很重要。从您粘贴的最后两行来看，这不在 break_words 的范围内。

```
def break_words(stuff):
    """This function will break up words for us."""
words = stuff.split(' ')
return words 
```

# ios - XCode没有在核心数据映射工具上保存实体的位置

> ID：12307379
> 
> 赞同：1
> 
> 时间：2012-09-06T19:51:42.770
> 
> 标签：ios, xcode, core-data

似乎每次我打开项目时，实体都（视觉上）堆叠在一起。有没有其他人有这个问题？任何线索如何解决它？当我必须拖动超过 10 个实体来查看它们的关系时，它会变得很烦人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T19:55:04.227

我过去注意到了这一点。我停止使用模型的映射工具，只使用列表，因为每次启动应用程序时都必须组织关系和实体，这很烦人。

# xsd - 使用 jaxb 从我的类路径中的 xsd 生成源代码

> ID：12307396
> 
> 赞同：3
> 
> 时间：2012-09-06T19:52:42.483
> 
> 标签：xsd, classpath, cxf, jaxb2, generated-code

我正在尝试使用 JAXB 从我的类路径中的模式生成 java 类。对于 CXF，我从类路径中的 wsdl 生成 java 类，如下所示：

```
<wsdlOptions>
    <wsdlOption>
        <wsdl>classpath:wsdl/MetsInterfaceService.wsdl</wsdl>
    </wsdlOption>
</wsdlOptions> 
```

我希望 JAXB 存在类似的东西。我确实尝试过使用目录，但是当模式（存储在同一个 Maven 模块中）在类路径中导入另一个模式时，这似乎更符合要求。

任何帮助，将不胜感激！-萨尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T00:40:17.977

**[CXF XJC Maven 插件](http://cxf.apache.org/cxf-xjc-plugin.html)似乎`classpath:`支持.**

> XsdOption 对象用于为要处理的每个 XSD 文件传递​​特定选项和配置。

该站点上的示例显示`classpath:`在`<xsdOption>`路径中以多种方式使用`<xsd>`、`<bindingFile>`和`<catalog>`路径：

```
<configuration>
    <sourceRoot>${basedir}/target/generated/src/main/java</sourceRoot>
    <xsdOptions>
        <xsdOption>
            <xsd>classpath:/schemas/wsdl/http.xsd</xsd>
            <bindingFile>classpath:/schemas/wsdl/http.xjb</bindingFile>
            <catalog>${basedir}/src/main/build-resources/catalog.cat</catalog>
        </xsdOption>
        <xsdOption>
            <xsd>classpath:/schemas/wsdl/ws-addr.xsd</xsd>
            <packagename>org.apache.cxf.ws.addressing</packagename>
        </xsdOption>
        <xsdOption>
            <xsd>classpath:/schemas/wsdl/addressing.xsd</xsd>
            <bindingFile>classpath:/schemas/wsdl/addressing.xjb</bindingFile>
        </xsdOption>
        <xsdOption>
            <xsd>classpath:/schemas/configuration/security.xsd</xsd>
            <bindingFile>classpath:/schemas/configuration/security.xjb</bindingFile>
            <catalog>${basedir}/src/main/build-resources/catalog.cat</catalog>
            <extensionArgs>
                <extensionArg>-Xdv</extensionArg>
            </extensionArgs>
        </xsdOption>
        <xsdOption>
            <xsd>classpath:/schemas/wsdl/ws-addr-wsdl.xsd</xsd>
            <bindingFile>classpath:/schemas/wsdl/ws-addr-wsdl.xjb</bindingFile>
            <extension>true</extension>
        </xsdOption>
        <xsdOption>
            <xsd>classpath:/schemas/wsdl/addressing200403.xsd</xsd>
            <bindingFile>classpath:/schemas/wsdl/addressing200403.xjb</bindingFile>
        </xsdOption>
    </xsdOptions>
</configuration> 
```

# asp.net - 在 Umbraco 中发布到另一个页面

> ID：12307400
> 
> 赞同：0
> 
> 时间：2012-09-06T19:52:49.127
> 
> 标签：asp.net, post, umbraco

好的，我已经问过 Umbraco 论坛和 Umbraco 支持的这个问题，如果我也问 stackoverflow，让我们看看谁会赢得比赛。=)

ASP.net 提供[了几种将数据发布到站点内的另一个页面或用户控件的](http://msdn.microsoft.com/en-us/library/6c3yckfw%28v=vs.100%29.aspx) [选项](http://msdn.microsoft.com/en-us/library/ms178140%28v=vs.100%29.aspx)，但它们在 Umbraco 中似乎都失败了（至少在阅读 Umbraco 论坛帖子或自己尝试它们时看起来是这样）。

*   我试过使用 PostBackURL，但在一些论坛帖子中不推荐使用它，而且它似乎破坏了页面上其他按钮的 onclick。

*   我尝试过使用 Server.Transfer，但它似乎不适用于像 Button onclick 这样的处理程序。

*   我不能使用 Response.Redirect 并将数据放入 GET 查询字符串中，因为要传输大量数据......我需要 POST。

对于 Umbraco 网站，是否有推荐的方法？

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-09-07T05:27:29.257

因此，如果我正确理解您的问题，您是否正在尝试使用 umbraco 导入/使用 ASP .Net 用户控件？问题是您在尝试实现这一目标时遇到问题吗？

如果是这样，请对此答案发表评论，我将更新解决方案。

# php - 成功将 MSSQL 数据库值设置为 NULL

> ID：12307408
> 
> 赞同：0
> 
> 时间：2012-09-06T19:53:14.243
> 
> 标签：php, sql-server, null

我有一个尝试将列的值设置为 NULL 的查询（暂时不安全）。基本上只是将其恢复为空。在数据库设计中选中“允许 NULL”。它是一个 MSSQL 数据库。首先我试过：

```
$query = "UPDATE  Table_Name SET Image = '', Thumb = '' WHERE PageID = 5"; 
```

然后：

```
$query = "UPDATE  Table_Name SET Image = NULL, Thumb = NULL WHERE PageID = 5"; 
```

第二个不会产生错误，但不会将数据库值设置为 NULL。从我所看到的（网站研究）“NULL”是否正确？抱歉，PHP 新手。

**编辑**

查询由 if 语句调用。这将检查 GET 值是否等于。我知道这不是很安全。我只是想测试/玩一点技巧。完整的调用和查询如下。

```
<?php
if (isset($_GET['change']) && $_GET['change'] == "image1") {
    $query = "UPDATE  Table_Name SET Image = NULL, Thumb = NULL WHERE     NewsID = ".$_GET['id']." ";
}
?> 
```

这个 if 语句触发了一个删除“按钮”。代码如下所示：

```
<a href="Update.php?change=image1&cid=<?php echo $row["NewsID"]; ?>&id=<?php echo $row["NewsID"]; ?>">delete</a></td> 
```

我现在相信，查询没有被调用？但是，该按钮确实会更改并设置其要执行的值，因此我只能假设 if 语句不会对此进行处理。Update.php 是查询当前所在的页面，因此它几乎只是作为刷新。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-20T14:02:39.773

好久没用PHP了，NULL需要用引号括起来吗？

尝试这个：

```
$query = "UPDATE  Table_Name SET Image = 'NULL', Thumb = 'NULL' WHERE PageID = 5"; 
```

希望这可以帮助。

# c# - 在 C# 中，如何根据经度和纬度值从 Bing 地图中获取最近的地点？

> ID：12307409
> 
> 赞同：0
> 
> 时间：2012-09-06T19:53:20.217
> 
> 标签：c#, latitude-longitude, bing-maps

是的，我对此很陌生，所以我不能真正理解 Bing 提供的所有文档。但是，如果我有一个经度和纬度的双（数字）值，那么如何在 C# 中获得最近的位置，最好是字符串？我从旧教程中知道如何在 MSRMaps 中执行此操作，但我完全不知道如何在这里执行此操作。

非常感谢！

编辑：我在这里找到了本教程：http: [//msdn.microsoft.com/en-us/library/dd221354.aspx](http://msdn.microsoft.com/en-us/library/dd221354.aspx)

我决定只使用反向地理编码位，这就是我得到的：

```
static void Main(string[] args)
    {
        string location;
        location = ReverseGeocodePoint("47.608, -122.337");
        Console.WriteLine(location);

    }

    static string ReverseGeocodePoint(string locationString)
    {
        string results = "";
        string key = "Aq4VS_9C4juJKsP7hRFqWlYj0Mpd_ybl2vOmj_J9rugPvptWiOEa3tCzmXWvzm9J";
        ReverseGeocodeRequest reverseGeocodeRequest = new ReverseGeocodeRequest();

        // Set the credentials using a valid Bing Maps key
        reverseGeocodeRequest.Credentials = new GeocodeService.Credentials();
        reverseGeocodeRequest.Credentials.ApplicationId = key;

        // Set the point to use to find a matching address
        GeocodeService.Location point = new GeocodeService.Location();
        string[] digits = locationString.Split(',');

        point.Latitude = double.Parse(digits[0].Trim());
        point.Longitude = double.Parse(digits[1].Trim());

        reverseGeocodeRequest.Location = point;

        // Make the reverse geocode request
        GeocodeServiceClient geocodeService = new GeocodeServiceClient();
        GeocodeResponse geocodeResponse = geocodeService.ReverseGeocode(reverseGeocodeRequest);

        if (geocodeResponse.Results.Length > 0)
        results = geocodeResponse.Results[0].DisplayName;
        else
        results = "No Results found";

        return results;
     }
 } 
```

只有我在 GeocodeServiceClient 遇到错误 geocodeService = new GeocodeServiceClient();

说：无法加载合同“GeocodeService.IGeocodeService”的端点配置部分，因为找到了该合同的多个端点配置。请按名称指明首选端点配置部分。

这对我意味着什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T20:02:12.133

尝试从这里开始。[地理编码服务](http://msdn.microsoft.com/en-us/library/cc966793.aspx)特别是您正在寻找的是[反向地理编码](http://msdn.microsoft.com/en-us/library/cc966828.aspx)

根据 MSDN 上的示例。

```
// Set a Bing Maps key before making a request
string key = "Bing Maps Key";

GeocodeService.ReverseGeocodeRequest reverseGeocodeRequest = new GeocodeService.ReverseGeocodeRequest();

// Set the credentials using a valid Bing Maps key
reverseGeocodeRequest.Credentials = new GeocodeService.Credentials();
reverseGeocodeRequest.Credentials.ApplicationId = key;

// Set the point to use to find a matching address
GeocodeService.Location point = new GeocodeService.Location();
point.Latitude = 47.608;
point.Longitude = -122.337;

reverseGeocodeRequest.Location = point;

// Make the reverse geocode request
GeocodeService.GeocodeServiceClient geocodeService =
new GeocodeService.GeocodeServiceClient("BasicHttpBinding_IGeocodeService");
GeocodeService.GeocodeResponse geocodeResponse = geocodeService.ReverseGeocode(reverseGeocodeRequest);

Results = geocodeResponse.Results[0].DisplayName; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T11:49:56.113

您必须从 App.Config/web.config 中删除端点之一

原始生成

```
<client>
            <endpoint address="http://dev.virtualearth.net/webservices/v1/geocodeservice/GeocodeService.svc"
                binding="basicHttpBinding" bindingConfiguration="BasicHttpBinding_IGeocodeService"
                contract="Microsoft.Bing.GeocodeService.IGeocodeService" name="BasicHttpBinding_IGeocodeService" />
            <endpoint address="http://dev.virtualearth.net/webservices/v1/geocodeservice/GeocodeService.svc/binaryHttp"
                binding="customBinding" bindingConfiguration="CustomBinding_IGeocodeService"
                contract="Microsoft.Bing.GeocodeService.IGeocodeService" name="CustomBinding_IGeocodeService" />
        </client> 
```

如果您从 app.config/web.config 中删除其中一个端点配置，您的代码就可以正常工作。

```
 <client>
            <endpoint address="http://dev.virtualearth.net/webservices/v1/geocodeservice/GeocodeService.svc"
                binding="basicHttpBinding" bindingConfiguration="BasicHttpBinding_IGeocodeService"
                contract="Microsoft.Bing.GeocodeService.IGeocodeService" name="BasicHttpBinding_IGeocodeService" />
        </client> 
```

# wordpress - 创建/注册新用户时会触发哪些操作挂钩？

> ID：12307414
> 
> 赞同：7
> 
> 时间：2012-09-06T19:53:43.510
> 
> 标签：wordpress

在我的 Wordpress 网站中创建新用户时，我经常需要“做事”。*我知道*我可以依靠的唯一动作钩子是`user_register`.

问题是我觉得是在创建用户的过程中比较早触发的，所以在我的函数被调用***后经常会出现用户信息不可用或者其他插件修改的情况。***

我已经研究过但没有运气，哪些资源可以解释 WordPress 创建用户的方式以及哪些钩子何时触发？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-08T13:02:21.837

在这种情况下，最好的文档是[代码本身](http://www.codinghorror.com/blog/2012/04/learn-to-read-the-source-luke.html)。

钩子**`user_register`**被触发，[`/wp-includes/user.php#L1418`](http://core.trac.wordpress.org/browser/tags/3.5.1/wp-includes/user.php#L1418)那里似乎没有其他有用的操作可用。

我们[**`user_profile_update_errors`**](http://core.trac.wordpress.org/browser/tags/3.5.1/wp-admin/includes/user.php#L153)进去了`/wp-admin/includes/user.php`，但不确定它在这里的可用性。

上一个文件中调用的函数**[`wp_new_user_notification()`](http://core.trac.wordpress.org/browser/tags/3.5.1/wp-includes/pluggable.php#L1184)**是可插入的，这意味着[您可以覆盖它](http://codex.wordpress.org/Pluggable_Functions)并在那里做自己的事情。也许这是一个不错的选择。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-08-03T02:10:40.203

该`user_register`操作实际上是最后触发的与注册相关的钩子之一。此操作在记录保存到数据库后触发。在注册过程中会触发许多不同的操作和过滤器，其中大部分是在之前调用的`user_register`。

`user_register``wp_insert_user()`任何时候通过该函数创建用户时都会触发。这包括默认的 WordPress 用户注册表单、管理仪表板中的“添加新用户”页面，甚至是使用此功能的自定义注册表单。如果您只需要针对通过 WordPress 注册表单创建的新用户，您也可以使用该`register_new_user`操作。同样，如果您只想通过管理仪表板（添加新用户页面）定位用户创建，您可以使用该`edit_user_created_user`操作。

您还可以使用其他钩子来实现自定义验证规则，例如`registration_errors`过滤器。[所有这一切都在WordPress 用户注册钩子的视觉指南](https://usersinsights.com/wordpress-user-registration-hooks-visualized/)文章中进行了详细解释，该文章介绍了所有主要的注册钩子，包括一些可视化它们被触发的顺序的图形。

# php - MySql 查询出错

> ID：12307415
> 
> 赞同：2
> 
> 时间：2012-09-06T19:53:47.663
> 
> 标签：php, mysql

我在使用这个 MySql 查询时遇到问题：

```
INSERT INTO groups (NAME, DESC, TIME, OWNER) VALUES ('$GNAME', '$DESC', '$TIME', '$UID') 
```

本质上，该脚本将组名、说明、时间和注册组的人的用户名添加到 mysql 数据库中。

完整脚本：

```
<?php
include_once('include/session.php');
$GNAME = $_POST['groupname'];
$DESC = $_POST['desc'];
$SPAM = $_POST['spam'];
$UID = $_POST['UID'];
$TIME = date('Y-m-d H:i:s');
if($SPAM == "queuee"){

$query ="INSERT INTO groups (NAME, DESC, TIME, OWNER) VALUES ('$GNAME','$DESC','$TIME', '$UID')";

$result = mysql_query($query) or die("There as been an Error! <hr>Error:<hr>".mysql_error() ."<br><hr><a href=\"../index.php\">Go Back</a>");
header("Location: ../group.php?id=$GNAME");
}else{
?>
The Security Question was wrong. Try Again.

<?
}
?> 
```

我使用 Phpmyadmin 将查询直接运行到 MySql 本身。但是它仍然抛出了一个错误。错误是：

```
#1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DESC, TIME, OWNER) VALUES ('$GNAME', '$DESC', '$TIME', '$UID')' at line 1 
```

非常感谢任何帮助，也许我完全是个傻瓜，没有注意到明显的错误。如果您需要更多信息，请询问！

非常感谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-06T19:55:19.287

“DESC”是关键字。把它放在反引号中。

```
..., `DESC`, ... 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-06T19:55:38.617

`DESC`是保留[关键字](http://dev.mysql.com/doc/refman/5.0/en/reserved-words.html)。如果您必须将其用作列名，请将其包装在反引号中：

> `DESC`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-06T19:55:48.770

尝试：

```
INSERT INTO groups (`NAME`, `DESC`, `TIME`, `OWNER`) VALUES ('$GNAME','$DESC','$TIME', '$UID')"; 
```

您使用保留字作为列名 - 在这种情况下，PHP 会变得非常混乱。

我还应该补充一点，您的代码对 SQL 注入是开放的，您应该考虑远离使用 mysql_* 函数。

mysqli 的快速入门指南位于[http://www.php.net/manual/en/mysqli.quickstart.php](http://www.php.net/manual/en/mysqli.quickstart.php)

PDO 是另一种选择；有关准备好的报表的信息位于[http://www.php.net/manual/en/pdo.prepared-statements.php](http://www.php.net/manual/en/pdo.prepared-statements.php)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-06T19:56:12.977

DESC 是 SQL 关键字，使用 `` 转义列名：

```
$query ="INSERT INTO `groups` (`NAME`, `DESC`, `TIME`, `OWNER`) VALUES ('$GNAME','$DESC','$TIME', '$UID')"; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-06T19:56:58.963

根据[MySQL Reserved Words](http://dev.mysql.com/doc/refman/5.5/en/reserved-words.html)，单词 `DESC 不能用作字段名，除非你用反引号括起来。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-06T19:56:59.610

在“INSERT INTO groups”部分中，在 DESC 周围加上单引号（或双引号）。DESC 是保留字，必须加引号。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-06T19:58:06.080

采用

```
$DESCRIPTION = $_POST['desc']; 
```

插入的

```
$DESC = $_POST['desc']; 
```

**在您的查询中使用$DESCRIPTION**变量

```
$query ="INSERT INTO groups (NAME, DESC, TIME, OWNER) VALUES ('$GNAME','$DESCRIPTION','$TIME', '$UID')"; 
```

# html - 是否可以选择所有没有任何 CSS 类的元素？

> ID：12307418
> 
> 赞同：1
> 
> 时间：2012-09-06T19:53:54.683
> 
> 标签：html, css, css-selectors, anchor

[W3C 建议](http://www.w3.org/TR/CSS2/selector.html#attribute-selectors)定义了使用 选择具有已定义类的任何锚点的能力`A[CLASS]{/*Code*/}`，但是有先例吗？

**我可以选择所有没有类的锚吗？**

我的直觉是使用`A[~CLASS]{/*Code*/}`，但这没有记录，并`A[CLASS=]{/*Code*/}`选择所有类名为空字符串的锚（例如，`<A CLASS="" HREF="http://example.com/">This anchor has a class, but it's empty.</A>`）。

## 示例用法

* * *

在这段代码中，我只希望无类链接是绿色的。

```
<HTML>
<HEAD>
<LINK REL="stylesheet" TYPE="text/css" HREF="http://example.com/externalUneditableStyles.CSS" />
<STYLE>
A.deadLink{
color:#FF0000 !important;
}
A{
color:#00FF00;
}

</STYLE>
</HEAD>

<BODY>
<A HREF="http://fakesite.not/" CLASS="deadLink">This link is red, as specified by the CSS above.</A>
<A HREF="http://example.com/">This link is green, as specified by the CSS above.</A>
<A HREF="#/childpage/" CLASS="childLink">This is a link to a child page, and is styled by external uneditable CSS. That CSS doesn't specify a color, so it is green, even though that might not be the intended effect.</A>
</BODY>
</HTML> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-06T19:57:57.893

使用这样的东西：

```
a:not([class]) {
    /*some styling here*/
} 
```

小演示：[小链接](http://jsfiddle.net/glee/T8FjX/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T22:25:48.097

尝试使用`.foo:not(.bar)`-pseudo 选择器。我还建议您不要在大写字母中编码标签。我相信它在 HTML5 中是允许的，但在 XHTML 中是不允许的。即便如此，这种做法还是不受欢迎。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-06T20:02:06.337

这正是级联的用途，如果你这样做：

```
a { color: #000; } /* this targets all anchors */ 
```

然后在你的样式表中之后你可以做

```
a.classname { color: #ffcc00; } /* to override the color for the once with the classname class defined. */ 
```

我希望这能澄清你的问题。

# javascript - JavaScript 中的连接域名

> ID：12307421
> 
> 赞同：0
> 
> 时间：2012-09-06T19:54:16.487
> 
> 标签：javascript, html

我已经接手了一个项目的开发，并注意到 JavaScript 中有一个奇怪的片段，开发人员在其中编写了以下内容：

```
/* ... code */

var el = document.getElementById('foo');

el.href = "http://" + "w" + "w" + "w" + "." + "d" + "o" + "main.com/foobar/";

/* ... code */ 
```

我对目的是什么有一些预感，但会避免表达，以免误导，可能更好，答案......

***连接域的目的是什么？***

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T20:00:19.597

就 JavaScript 本身而言，这实际上没有任何效果——结果是一样的。

但原因可能与在 JavaScript 中完成某些任务不同。我想这里最有可能出现两种可能性：

1.  **误导其他程序员**（所以域名不容易通过简单的文本搜索找到）。蠕虫使用类似（但更复杂）的方式将代码插入网站，而不显示其中包含的内容，除非您付出更多努力来分析它。
2.  试图**误导爬虫**，这可能假设他们没有解析 JavaScript 并获得实际结果。例如，如果程序员担心代码将是例如，则可能是这种情况。索引并通过在搜索引擎中搜索此域名，任何人都可以发现它在您描述的网站的代码中被提及。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T20:00:12.667

好吧，通常你会连接它，因为你会在其中使用变量......

```
el.href = "http://www." + domain + "." + ext "/" + additionalUrl; 
```

否则，像这样逐个字母分开是没有用的。我假设以前的程序员只是无聊:)

# android - BluetoothSocket 在 OutputStream.write() 上停止传输

> ID：12307423
> 
> 赞同：5
> 
> 时间：2012-09-06T19:54:23.850
> 
> 标签：android, bluetooth

我有一个`BluetoothSocket`正在与自定义设备（双向）通信。有时（在以 300 字节块传输 8 Mb 数据时，大约有 4 次发生这种情况），在文件传输过程中，蓝牙停止传输数据。对于大约 100-200 块数据（我没有确切的数量），`OutputStream.write(byte[], int, int)`每次调用后继续正常返回。没有生成异常。然后，调用`OutputStream.write(byte[], int, int)`锁。

该代码在华硕 eee 变压器 Pad TF101 上进行了测试。

我无权访问低`OutputStream`代码来查看正在发生的事情并进行调试。我的猜测是有一个缓冲区被填满但没有被清空。当缓冲区满时，`write`就会锁定。

有人知道发生了什么吗？

这是示例代码：

```
private class ConnectedThread extends Thread {
    private final BluetoothSocket mmSocket;
    private final InputStream mmInStream;
    private final OutputStream mmOutStream;

    public ConnectedThread(BluetoothSocket socket, String socketType) {
        mmSocket = socket;
        InputStream tmpIn = null;
        OutputStream tmpOut = null;

        setName( "BT Connected Thread" );

        // Get the BluetoothSocket input and output streams
        try {
            tmpIn = socket.getInputStream();
            tmpOut = socket.getOutputStream();
        } 
        catch (IOException e) 
        {
            Log.e( "BT GetStreams", e.getMessage() );
            e.printStackTrace();
        }

        mmInStream = tmpIn;
        mmOutStream = tmpOut;
    }

    public void run() {

        byte[] buffer = new byte[1024];

        int bytes;

        // Keep listening to the InputStream while connected
        while (true) {
            try {
                // Read from the InputStream
                bytes = mmInStream.read(buffer);

                // Send the obtained bytes to the UI Activity
                mHandler.obtainMessage( FirmwareHandler.COMMAND_READ, bytes, -1, buffer.clone() ).sendToTarget();

            } catch (IOException e) 
            {
                connectionLost();
                break;
            }
        }
    }

    public void write(byte[] buffer, int size) {
        try {
            Log.d(this.getClass().getSimpleName(), "Before Write, size = " + size + ", mmOutStream.toString() = " + mmOutStream.toString() + ", mmSocket..toString() = " + mmSocket.toString());

            mmOutStream.write(buffer, 0, size); // This is the call that locks.
            Log.d(this.getClass().getSimpleName(), "After Write");
            mmOutStream.flush(); // Make sure the command is sent entirely immediately
            Log.d(this.getClass().getSimpleName(), "After Flush");

        } catch (IOException e) 
        {
            e.printStackTrace();
        }
    }

    public void cancel() {
        try {
            mmSocket.close();
        } catch (IOException e) 
        {
            e.printStackTrace();
        }
    }
} 
```

**编辑：**

一旦锁定发生，如果我关闭，然后打开远程`Bluetooth`设备，套接字就会解锁并出现 IO 异常。然后，当我尝试连接时，回到`Bluetooth`设备，我得到一个`Bluetooth java.IOException:Service discovery failed`. 恢复的唯一方法`Bluetooth`是重新启动平板电脑。

**编辑#2：**

如果我在有这样的锁定后手动断开套接字，它会毫无例外地返回。远程设备的连接状态保持连接。但是，如果我尝试连接到任何设备（不一定是锁定的设备，即使设备已连接已断电），我会收到以下异常：

```
09-13 09:34:45.342: E/BT Connection Assert(1864): Service discovery failed
09-13 09:34:45.342: W/System.err(1864): java.io.IOException: Service discovery failed
09-13 09:34:45.342: W/System.err(1864):     at android.bluetooth.BluetoothSocket$SdpHelper.doSdp(BluetoothSocket.java:397)
09-13 09:34:45.342: W/System.err(1864):     at android.bluetooth.BluetoothSocket.connect(BluetoothSocket.java:207)
09-13 09:34:45.342: W/System.err(1864):     at com.brioconcept.hit001.communication.bluetooth.BluetoothService$ConnectThread.run(BluetoothService.java:177) 
```

恢复的唯一方法似乎是重新启动平板电脑。

# asp.net-mvc-3 - ASP.NET MVC 3：附加到部分

> ID：12307426
> 
> 赞同：10
> 
> 时间：2012-09-06T19:54:36.400
> 
> 标签：asp.net-mvc-3

我试图弄清楚是否可以附加到一个部分。这是我的结构：

_Layout.cshtml

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<link href="@Url.Content("~/Content/style.css")" rel="stylesheet" type="text/css" />
@RenderSection("Css", false)
<script type="text/javascript" src="@Url.Content("~/Content/scripts/head.load.min.js")"></script>
</head>
<body class="bg_g">
    @RenderBody()
    <script type="text/javascript">
        @RenderSection("Javascript", false)
    </script>
</body>
</html> 
```

登录.cshtml

```
@{
    Layout = "~/Views/Shared/_DMZ.cshtml";
    ViewBag.Title = "Logon";
}

@section Javascript += {
    // JAVASCRIPT CODE;
}

<div>
    Stuff
    @{ Html.RenderAction("Register", "Account"); }
    @{ Html.RenderAction("Register2", "Account"); }
</div> 
```

注册.cshtml

```
@{
    Layout = null;
}

@section Javascript += {
    // More javascript code
}

<div>
    Register stuff
</div> 
```

Register2.cshtml

```
@{
    Layout = null;
}

@section Javascript += {
    // Even More javascript code
}

<div>
    Register stuff part 2
</div> 
```

希望这能解释我真正想做的事情。我也想对我的 css 部分做同样的事情。如果我也可以让它像这样呈现 Javascript，那就更好了：

```
head.js(
    "@Url.Content("~/Content/scripts/jquery-1.6.2.min.js")",
    "@Url.Content("~/Content/scripts/jquery.tools.min.js")",
    "@Url.Content("~/Content/lib/jquery-validation/jquery.validate.js")",
// Loop through all javascript files included from the sub views and add them just like above
function () {
    loginTabs.init();
    // Loop through all javascript functions that have been added to the InitFunctions section?
}
) 
```

也许部分不是这个问题的正确解决方案，但我知道必须有一种方法来完成这样的事情。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-03-18T20:34:20.813

有点晚了 - 但希望对那里的人仍然有用：

我不知道是否有实现它的本机方法，但我已经使用了一段时间了，它真的很有帮助：

```
public static IHtmlString Resource( this HtmlHelper HtmlHelper, Func<object, HelperResult> Template, string Type )
{
    if( HtmlHelper.ViewContext.HttpContext.Items[Type] != null ) ( (List<Func<object, HelperResult>>)HtmlHelper.ViewContext.HttpContext.Items[Type] ).Add( Template );
    else HtmlHelper.ViewContext.HttpContext.Items[Type] = new List<Func<object, HelperResult>> { Template };

    return new HtmlString( String.Empty );
}

public static IHtmlString RenderResources( this HtmlHelper HtmlHelper, string Type )
{
    if( HtmlHelper.ViewContext.HttpContext.Items[Type] == null ) return new HtmlString( String.Empty );

    var Resources = (List<Func<object, HelperResult>>)HtmlHelper.ViewContext.HttpContext.Items[Type];

    foreach( var Resource in Resources.Where( Resource => Resource != null ) )
    {
        HtmlHelper.ViewContext.Writer.Write( Resource( null ) );
    }

    return new HtmlString( String.Empty );
} 
```

用法是：

```
//This is how you save it
@Html.Resource(@<style>.test{color: #4e4e4e}</style>, "css")

//This is how you read it
@Html.RenderResources("css") 
```

# python - 如何从行中解析一个数字

> ID：12307428
> 
> 赞同：0
> 
> 时间：2012-09-06T19:54:49.810
> 
> 标签：python, regex, python-3.x

我有一个如下的文本文件，并正在尝试创建一个新的文本文件。每个字符串都有一个带括号的数字。我需要一些关于如何解析这个数字的帮助。

测试.txt

```
itemA (3)     
itemB (test) abcd (2)    
itemC xyx (3) 
```

output.txt 文件创建为：

```
itemA-1  
itemA-2  
itemA-3  
itemB (test) abcd-1  
itemB (test) abcd-2  
itemC xyx-1  
itemC xyx-2   
itemC xyx-3 
```

我当前的代码：

```
import os  
f = open('C:\\Dropbox\\test.txt','r')  
data = f.read()  
print (data)  
f.close() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T19:58:07.507

使用正则表达式很容易：

```
r'\s*\((\d+)\)' 
```

这将匹配（可选）空格，后跟括号中的数字，并将数字放在一个组中以便于替换：

```
parensnumber = re.compile(r'\s*\((\d+)\)')

count = int(parensnumber.search(line).group(1))
for i in range(count):
    print(parensnumber.sub('-{0}'.format(i + 1), line)) 
```

演示：

```
>>> import re
>>> parensnumber = re.compile(r'\s*\((\d+)\)')
>>> parensnumber.sub(r'-\1', 'itemA (3)')
'itemA-3'
>>> parensnumber.sub(r'-\1',  'itemB (test) abcd (2)')
'itemB (test) abcd-2'
>>> line = 'itemB (test) abcd (2)'
>>> count = int(parensnumber.search(line).group(1))
>>> for i in range(count):
...     print(parensnumber.sub('-{0}'.format(i + 1), line))
... 
itemB (test) abcd-1
itemB (test) abcd-2 
```

您的特定示例的完整代码：

```
import os
import re

parensnumber = re.compile(r'\s*\((\d+)\)')

with open('C:\\Dropbox\\test.txt','r') as input:
    for line in input:
        count = int(parensnumber.search(line).group(1))
        for i in range(count):
            print(parensnumber.sub('-{0}'.format(i + 1), line)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T19:59:14.850

试试这个：

```
o = open('output.txt', 'w')
for line in open('text.txt'):
    vals = line.split(' ')
    n = int(vals[-1][1:-1])
    for i in range(n):
        o.write("%s-%d" % (" ".join(vals[:-1]), i))
o.close() 
```

只要您的输入是正确的。尽管您可能要考虑使用 REGEXP 而不是“手动”解析它。

# python - scipy、fftpack 和 float64

> ID：12307429
> 
> 赞同：1
> 
> 时间：2012-09-06T19:54:54.760
> 
> 标签：python, 64-bit, scipy

我想将 scipy.fftpack 中的 dct 功能与 numpy float64 数组一起使用。但是，它似乎只针对 np.float32 实现。我有什么快速的解决方法可以完成这项工作吗？我很快调查了它，但我不确定所有的依赖关系。所以，在搞砸一切之前，我想我会在这里寻求提示！

到目前为止，我唯一找到的就是这个链接： http: [//mail.scipy.org/pipermail/scipy-svn/2010-September/004197.html](http://mail.scipy.org/pipermail/scipy-svn/2010-September/004197.html)

提前致谢。

这是它引发的 ValueError：

```
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-12-f09567c28e37> in <module>()
----> 1 scipy.fftpack.dct(c[100])

/usr/local/Cellar/python/2.7.3/lib/python2.7/site-packages/scipy/fftpack/realtransforms.pyc in dct(x, type, n, axis, norm, overwrite_x)
    118         raise NotImplementedError(
    119               "Orthonormalization not yet supported for DCT-I")
--> 120     return _dct(x, type, n, axis, normalize=norm, overwrite_x=overwrite_x)
    121 
    122 def idct(x, type=2, n=None, axis=-1, norm=None, overwrite_x=0):

/usr/local/Cellar/python/2.7.3/lib/python2.7/site-packages/scipy/fftpack/realtransforms.pyc in _dct(x, type, n, axis, overwrite_x, normalize)
    215             raise ValueError("Type %d not understood" % type)
    216     else:
--> 217         raise ValueError("dtype %s not supported" % tmp.dtype)
    218 
    219     if normalize:

ValueError: dtype >f8 not supported 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-06T21:02:00.677

The problem is not the double precision. Double precision is of course supported. The problem is that you have a little endian computer and (maybe loading a file from a file?) have big endian data, note the `>` in `dtype >f8 not supported`. It seems you will simply have to cast it to native double yourself. If you know its double precision, you probably just want to convert everytiong to your native order once:

```
c = c.astype(float) 
```

Though I guess you could also check `c.dtype.byteorder` which I think should be `'='`, and if, switch... something along:

```
if c.dtype.byteorder != '=':
    c = c.astype(c.dtype.newbyteorder('=')) 
```

Which should work also if you happen to have single precision or integers...

# android - android布局最小宽度（sw800dp）和不同的密度

> ID：12307433
> 
> 赞同：5
> 
> 时间：2012-09-06T19:55:03.883
> 
> 标签：android, layout

如何在具有相同 sw800dp 最小宽度的 ICS 上为不同的 dpi 放置不同的资源？

详细信息：有两款采用 ICS 4.0.4 的平板电脑。第一个具有 1280x800 分辨率和 mdpi (160) 密度​​。第二个具有 1920x1200 分辨率和 hdpi (240) 密度​​。因此，就最小宽度而言，它们都具有相同的 sw800dp 限定符，但具有不同的 mdpi/hdpi 密度限定符。

对于这两种分辨率，我需要有不同的布局和图像。

所以我创建了两个目录：

> 布局-sw800dp-mdpi
> 
> 布局-sw800dp-hdpi

我以为每个设备都会根据最小的宽度和密度来选择自己的目录。但是它们都从同一个 sw800dp-hdpi 文件夹中获取资源！

我很困惑，不知道如何为这两种不同的分辨率分离资源。

非常感谢任何帮助。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T16:50:24.167

您应该使用位于 /layout/sw800dp 中的相同布局，并创建 /drawable-mdpi 、 /drawable-hdpi 来放置您的自定义可绘制对象，系统将使用相同的布局将正确的布局应用于每个设备。这些设备应该具有相似的尺寸和外观......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T21:08:54.907

使用它来获得密度：

```
float density = getBaseContext().getResources().getDisplayMetrics().density; 
```

屏幕高度：

```
int h = 0;

Display display = ((WindowManager) getSystemService(WINDOW_SERVICE)).getDefaultDisplay();

h = (int) display.getHeight(); 
```

屏幕宽度：

```
int w = 0;

Display display = ((WindowManager) getSystemService(WINDOW_SERVICE)).getDefaultDisplay();

w = (int) display.getWidth() 
```

之后，只需选择正确的资源。

# build - 将 Gradle 脚本从根目录导入子项目

> ID：12307434
> 
> 赞同：13
> 
> 时间：2012-09-06T19:55:05.680
> 
> 标签：build, gradle

我想在我的根 build.gradle 中执行“应用自：./gradle/script/common.gradle”，并让它可用于我的所有子项目。

我已经尝试将应用程序放在“子项目”中，但由于路径是相对的，它并不总是能够解决（子项目不是平坦的）。我也把它放在根目录的子项目之外，但是子项目没有解决目标。

我还没有找到一种方法来以“应用自：”喜欢的方式获取工作目录，或者如何获取正在执行原始 gradle 脚本的根目录或目录。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-09-06T20:15:15.040

在你的根目录下`build.gradle.`：

```
allprojects { // or: subprojects { ... }
    apply from: "gradle/script/common.gradle"
} 
```

如果您需要此类脚本的绝对路径，您可以随时使用`"$rootProject.projectDir/gradle/script/common.gradle"`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-10-16T04:55:36.877

在每一行中附加“apply false”为我解决了这个问题。

例子

```
id 'org.springframework.boot' version '2.5.5'  apply false
id 'io.spring.dependency-management' version '1.0.11.RELEASE' apply false
```

# c# - 具有自动增量文件版本的固定程序集版本？

> ID：12307435
> 
> 赞同：9
> 
> 时间：2012-09-06T19:55:13.713
> 
> 标签：c#, .net, version

我正在尝试找到一种更有意义的方式来处理我的应用程序的版本控制，我遇到了这篇知识库文章

[http://support.microsoft.com/kb/556041](http://support.microsoft.com/kb/556041)

基本上，它建议固定装配版本，并为每个构建增加文件版本。现在这对我来说很有意义，但对于我的生活，我似乎无法实现它。

下面的代码片段自动增加程序集版本和 FileVersion。

```
[assembly: AssemblyVersion("1.0.*")] 
```

虽然下一个似乎设置了一个固定的程序集版本`1.0.0.0`和一个固定的文件版本`1.0.*`。

```
[assembly: AssemblyVersion("1.0")]
[assembly: AssemblyFileVersion("1.0.*")] 
```

顺便说一句，文件属性的详细信息选项卡中的产品版本现在也可以读取`1.0.*`。现在我可以用这个修复文件属性中的产品版本......

```
[assembly: AssemblyInformationalVersion("1.0")] 
```

但这对我最初的任务没有帮助。出于好奇，我尝试了以下内容并将文件版本更改为`2.0.*`，所以它至少正在使用它。它只是不是自动递增。

```
[assembly: AssemblyVersion("1.0")]
[assembly: AssemblyFileVersion("2.0.*")] 
```

因此，从我可以收集到的唯一自动递增的版本号是程序集版本，但是如果您没有指定文件版本，它会被设置为与程序集版本相同。

有谁知道在固定程序集版本的同时自动增加文件版本的方法？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-06T20:10:08.890

是的，这有点傻，微软似乎搞错了。`AssemblyVersion`在 .NET 程序集版本控制系统中使用，因此您永远不应自动递增它，而是`AssemblyFileVersion`写入文件版本资源中的文件版本条目，因此您可能有理由期望它始终默认自动递增。

我确信有一些 3rd 方构建系统可以为您执行此操作，但我只是编写了一个小命令行 C# 应用程序来执行此操作，它作为我们构建过程的一部分在每个项目上运行。这非常简单：

1.  `AssemblyInfo.cs`逐行读取文件。
2.  `RegEx`搜索该行，将所有`AssemblyFileVersion`四个版本部分捕获到单独的捕获组中。你可以自己解析它，但是一个正则表达式会一次性完成所有的检测和解析，所以不利用它似乎很愚蠢。
3.  一旦你有了四个整数，就可以实现你自己认为合适的递增逻辑。

# javascript - highcharts可点击标签如何转到锚点

> ID：12307443
> 
> 赞同：2
> 
> 时间：2012-09-06T19:55:39.857
> 
> 标签：javascript, highcharts

我在我的 Backbone 应用程序中使用 Highcharts 在柱形图中显示一些信息。

我使用图表中的数据标签来允许用户单击并移动到该数据点的详细信息页面。这不是一个普通的 window.location 调用，而应该是一个 window.location.hash 调用。这是因为我想移动到一个锚点，它将被我的 Backbone 路由器拾取。

这是一个典型的标签（使用格式化程序）被转换成的内容：

```
<tspan onclick="location.href=&quot;/#/test/1&quot;" style="cursor: pointer; " x="360">Sectie nummer 6</tspan> 
```

所以换句话说，是否可以让 Highcharts 执行 onclick="window.location.hash=..." 而不是 location.href？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T20:33:40.093

`window.location.hash="comment-16513878"`&`window.location="#comment-16513878"`似乎有相同的结果。你试过吗？

```
formatter: function() {
    return '<a href="#somePlaceHolder" >' + this.y + '</a>';
} 
```

[http://jsfiddle.net/jugal/BUxMZ/](http://jsfiddle.net/jugal/BUxMZ/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-08T09:20:01.773

另一种解决方案（不是最跨浏览器的解决方案，因为它依赖于`<text>`但你可以让它与不兼容的 IE 版本一起使用）

```
$(".highcharts-data-labels").on("click", "text", function() {
    window.location.hash = "anchor";
}); 
```

[为什么*`jQuery.on()`*？](http://api.jquery.com/on/)

[jsFiddle 演示](http://jsfiddle.net/jugal/ZuqGZ/)

# android - 尝试在 Android 中的选项卡上更改颜色

> ID：12307444
> 
> 赞同：1
> 
> 时间：2012-09-06T19:55:47.447
> 
> 标签：android, android-activity, tabs, android-tabhost

下面是我的 Tab 类。我正在尝试在选中和未选中时更改选项卡的颜色。但是当我调用**tabHost.setOnTabChangedListener(MyOnTabChangeListener)**时，应用程序崩溃了？我什至无法使用该方法启动应用程序，并且它给出了空指针异常。我不知道该怎么办？有任何想法吗？/问候

```
@SuppressWarnings("deprecation")
public class Tabs extends TabActivity
{
private static final String TAG = "TabHostActivity";
private boolean mHaveShownStartDialog = false;
static TabHost tabHost;

@Override
public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.tab_host);
    setOnCreatePreferences();

    try
    {

        addTab(getString(R.string.Search), R.drawable.searchtab, SearchTask.class );
        addTab(getString(R.string.Bookmarks), R.drawable.blackheart1, Bookmarks.class );
        addTab(getString(R.string.Latest), R.drawable.clock3, Latest.class );
        addTab(getString(R.string.QAndA), R.drawable.pen, LatestFeedback.class );

        getTabHost().setCurrentTab( 0 );
        tabHost.setOnTabChangedListener(MyOnTabChangeListener);

    }
    catch(Exception e)
    {
        Log.e(TAG, e.getMessage());
    }

}

public static OnTabChangeListener MyOnTabChangeListener = new OnTabChangeListener(){

    public void onTabChanged(String tabId) {
      for(int i=0;i<tabHost.getTabWidget().getChildCount();i++)
      {
          tabHost.getTabWidget().getChildAt(i).setBackgroundColor(Color.WHITE);
      }

      tabHost.getTabWidget().getChildAt(tabHost.getCurrentTab()).setBackgroundColor(Color.GRAY);
    }
};

//public static void setTabColor(TabHost tabhost) {
//    for(int i=0;i<tabhost.getTabWidget().getChildCount();i++)
//    {
//        tabhost.getTabWidget().getChildAt(i).setBackgroundColor(Color.parseColor("#FF0000")); //unselected
 //   }
 //   tabhost.getTabWidget().getChildAt(tabhost.getCurrentTab()).setBackgroundColor(Color.parseColor("#0000FF")); // selected
//}

private void addTab( CharSequence label, int drawable_id, Class<?> c ) 
{
    TabHost.TabSpec spec = getTabHost().newTabSpec("tab" + " "+ label);

    spec.setIndicator( label, getResources().getDrawable( drawable_id ) );

    spec.setContent( new Intent().setClass( this, c ) );

    getTabHost().addTab( spec );
}

@Override
public boolean onCreateOptionsMenu(Menu menu) 
{
    MenuInflater inflater = getMenuInflater();
    inflater.inflate( R.menu.tabs_menu, menu );
    return true;
}

@Override
public boolean onOptionsItemSelected(MenuItem item) 
{
    switch ( item.getItemId() ) 
    {
        case R.id.tabs_menu_options_item:
            //startActivityForResult( new Intent( this, Options.class ) , 0 ); 
            return true;

        default: return super.onOptionsItemSelected(item);
    }
}

private void setOnCreatePreferences()
{
    SharedPreferences preferences = PreferenceManager.getDefaultSharedPreferences( getBaseContext() );

    boolean mUseStartDialog = preferences.getBoolean( "use_dialog", true );
    if( mUseStartDialog ) 
    {
        if( !mHaveShownStartDialog )
        {
            mHaveShownStartDialog = true;
            startActivity( new Intent( this, WelcomeDialog.class ) );
        }
    }
} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T20:04:32.587

我看不到你在哪里初始化 tabHost 变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T20:21:54.143

不要通过 OnTabChangeListener 执行此操作。您不想每次用户按下选项卡时都调用代码；）您可以在之后直接编写

```
getTabHost().setCurrentTab( 0 ); 
```

这是我用于此场景的代码：

```
TabWidget widget = tabHost.getTabWidget();
int size = widget.getChildCount();
for (int i = 0; i < size; i++) {

    // Hail to the master of unreadable code!
    ((TextView)((ViewGroup)widget.getChildAt(i)).findViewById(android.R.id.title)).setTextColor(0xffffffff);
    widget.getChildAt(i).setBackgroundResource(R.drawable.tab_widget_background_selector);
} 
```

我在这里的建议是您应该使用选择器并让平台为您处理一切。

```
<?xml version="1.0" encoding="utf-8"?>
<selector
  xmlns:android="http://schemas.android.com/apk/res/android">
  <item 
    android:state_selected="true"
    android:drawable="@drawable/tab_widget_background_selected"/>
  <item
    android:drawable="@drawable/tab_widget_background_casual"/>
  </selector> 
```

# c - 使用 dtrace 分析 C 代码

> ID：12307447
> 
> 赞同：0
> 
> 时间：2012-09-06T19:55:48.937
> 
> 标签：c, linux, profiling, dtrace

我正在通过 stackoverflow 寻找最佳的分析技术。

我有一堆 24/7 运行的进程，用 C 语言编写并使用 Oracle 10g。我发现了几个我想尝试的工具：oprofile、strace、systemtap 和 dtrace。

我想从 dtrace 开始，因此我一直在寻找一些简单的 dtrace 脚本，它将连接到正在运行的进程'并打印出所有函数调用，每个函数所花费的时间......也许是调用图。
请建议一些好的脚本开始，任何链接，教程，手册。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T20:00:37.907

简单的。Linux 上没有 DTrace（我最后一次听说）。

如果您渴望 DTrace 并愿意尝试一个真正的操作系统（呃，哦，flamebait :-)，请尝试带有功能和集成 DTrace 的[FreeBSD 。](http://wiki.freebsd.org/DTrace)

# javascript - 在光标处显示 div 并将 div 保持在可视区域内

> ID：12307450
> 
> 赞同：1
> 
> 时间：2012-09-06T19:55:56.570
> 
> 标签：javascript, jquery, html

将鼠标悬停在附加到照片的超链接上时，我让 div 加载页面，但是如果照片离可视屏幕区域太近，则 div 将被切断，您必须滚动才能看到它。如何偏移 div 以使整个 div 显示在可视区域内？另外，当鼠标在照片上移动时，我希望 div 与鼠标一起移动，但这并没有发生。

```
<script type="text/javascript">
var mouseX;
var mouseY;
$(document).mousemove( function(e) {
mouseX = e.pageX; 
mouseY = e.pageY;
});  
$(".ttip").mouseover(function(){
$('#meminfotip').css({'top':mouseY,'left':mouseX}).show().load('blah.php?id='+this.id);
});

$('.ttip').mouseout(function(){
$('#meminfotip').hide();
});
</script>

<a class="ttip" id="1" href="blahh.php?id=1>"><img src="images/blah.jpg" /></a>

<div id="meminfotip" style="display:none;z-index:999999;position:absolute;"></div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T20:09:20.847

您可以使用 jquery UI [position](http://docs.jquery.com/UI/Position)方法：

```
$('.ttip').mousemove(function (ev) {
 $("#meminfotip").position({
    my: "left bottom",
    of: ev,
    offset: "3 -3",
    collision: "fit"
  });
}); 
```

# php - PHP 回显每条记录并获得总数

> ID：12307455
> 
> 赞同：-2
> 
> 时间：2012-09-06T19:56:14.880
> 
> 标签：php, sql, for-loop, foreach

我在这里得到了这个PHP代码......

```
$totalBalance = 0;
    foreach($resultArray as $row) {
        foreach($row as $key =>$field) {
            echo $field['remaining'] . "<br>";
        }
    } 
```

$resultArray 是从我的 SQL 查询返回到数组中的内容。

余额栏的前几条记录是..

389.96 6433.66 52.52 107.25

但是，当我运行这个 php 代码时，我得到了

1 5 1 3

为什么要这样做，我该如何解决？

如果有帮助，这是 SQL 查询

```
SELECT c.clientid, c.clientname, c.billingdate, 
case when (select ifnull(sum(total), 0) from invoice i
where i.client = c.clientid and i.isdeleted = 0) - (select ifnull(sum(p.amount), 0) from payment p inner join invoice i on p.invoice = i.invoiceid
where i.client = c.clientid and i.isdeleted = 0) < 0 then (select ii.total from invoice ii where ii.client = c.clientid and ii.isdeleted=0 order by ii.invoiceid desc limit 1)  else (select ifnull(sum(total), 0) from invoice i
where i.client = c.clientid and i.isdeleted = 0) - (select ifnull(sum(p.amount), 0) from payment p inner join invoice i on p.invoice = i.invoiceid
where i.client = c.clientid and i.isdeleted = 0) end as remaining,
case c.isactive+0
        when '1' then 'Stop'
        else 'Start' 
        end as Active
FROM client c 
ORDER BY clientname 
```

我做了一个 $resultArray 的 print_r 并得到了这个......

```
Array ( [0] => Array ( [clientid] => 1 [clientname] => client A [billingdate] => 14 [remaining] => 389.96 [active] => Stop ) [1] => Array ( [clientid] => 178 [clientname] => client B [billingdate] => 23 [remaining] => 6433.66 [active] => Stop ) [2] => Array ( [clientid] => 3 [clientname] => client C [billingdate] => 19 [remaining] => 52.52 [active] => Stop ) [3] => Array ( [clientid] => 105 [clientname] => client D [billingdate] => 23 [remaining] => 107.25 [active] => Start ) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T19:59:56.157

你正在做 1 对许多：

```
$totalBalance = 0;

foreach($resultArray as $row) {
  echo $row['remaining'] . "<br>";        
} 
```

如果你想计算总余额：

```
$totalBalance = 0;

foreach($resultArray as $row) {
  echo $row['remaining'] . "<br>";        
  $totalBalance += $row['remaining'] ; 
}

echo $totalBalance . "<br>"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T19:59:01.540

```
<?php
$results = array( array('balance'=>123.45), array('balance'=>32.12));

$total = 0;

foreach( $results as $row )
{
    $total+=$row['balance'];
}

echo $total;
?> 
```

输出：

> 155.57

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-06T20:06:59.747

来自 print_r 不应该是：

```
$totalBalance = 0;
    foreach($resultArray as $row) {
        foreach($row as $key =>$field) {
            echo $field['remaining'] . "<br>";
        }
    } 
```

代替 ：

```
$totalBalance = 0;
    foreach($resultArray as $row) {
        foreach($row as $key =>$field) {
            echo $field['balance'] . "<br>";
        }
    } 
```

# jquery - JQGrid 未在列排序上显示“正在加载”消息

> ID：12307457
> 
> 赞同：2
> 
> 时间：2012-09-06T19:56:31.490
> 
> 标签：jquery, jqgrid

当我执行列排序时，我的 JQGrid 不会显示默认的“正在加载”消息。为了安全起见，我明确添加了默认代码：

loadui：'启用'

但它仍然没有在网格中间显示“加载”消息。我错过了什么？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T21:47:50.433

该`loadui`选项仅适用于使用 AJAX 操作的网格，例如，如果它们直接从外部源加载 XML 或 JSON 数据。从[jqGrid 文档](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3aoptions)：

> 此选项控制在进行 ajax 操作时要执行的操作。

如果您的网格使用本地数据源，那么您将永远不会看到加载对话框。另一方面，如果您的网格正在检索自己的数据，那么如果您可以提供一些代码让我们帮助缩小问题范围，将会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T14:27:10.760

我自己解决了这个问题。我删除了这条线

```
loadonce: true, 
```

从我的 JQGrid 属性中，这解决了这个问题。不知道为什么，但现在，我会接受它。这是来自wiki on loadonce的信息：

> 如果此标志设置为 true，则网格仅从服务器加载一次数据（使用适当的数据类型）。第一次请求后，数据类型参数自动更改为本地，所有进一步的操作都在客户端完成。寻呼机（如果存在）的功能被禁用。

# java - Spring roo 实体依赖

> ID：12307459
> 
> 赞同：0
> 
> 时间：2012-09-06T19:56:50.710
> 
> 标签：java, spring, jakarta-ee, spring-roo

我正在与 Spring-Roo 合作。

是否可以从依赖包中添加字段引用？我在脚本的请求中添加了依赖项，

```
dependency add --groupId com.testroo.platform --artifactId platform --version 0.1.0.BUILD-SNAPSHOT 
```

然后我在添加 jpa 实体时执行此操作

```
field reference --fieldName city --type ~.domain.City --notNull 
```

但它抱怨以下。

```
The specified target '--type' does not exist or can not be found. Please create
this type first. 
```

我认为 spring-roo 足够聪明，可以从依赖中解决它。我在这里错过了什么吗？干杯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T20:10:39.177

使用 Spring roo 并创建一个新项目时，您首先声明一个顶级包名称（假设输入 com.foo）。**~**符号用于稍后引用此包名称。

因此，在您的情况下，如果您将 ~.domain.City 作为类型参数的参数，roo 将在 com.foo.domain.City 中查找它，因为 ~ 符号替换了顶级包。

简短回答：如果要从依赖包中添加字段引用，请给出类的全名。

# ios - 为 iOS 应用内购买提供折扣代码

> ID：12307463
> 
> 赞同：10
> 
> 时间：2012-09-06T19:57:02.963
> 
> 标签：ios

所以我知道 iOS 中没有用于应用内购买的促销代码。我想知道的是，Apple 是否会拒绝这种机制：

1.  提供两种应用内购买，一种是全价，比如 9.99 美元，另一种是折扣价，比如 7.99 美元（同样的东西）

2.  当您点击 7.99 美元时，首先会要求您输入优惠券代码以允许使用折扣价。这个折扣代码可以在其他地方找到——博主赠送它，优惠券网站等。

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T20:23:14.463

我真的认为只有苹果才能说出来，但这是一个很好的机会。

有时我只是继续打电话给他们，而且我很幸运，经常有一个真正能干的人在电话里告诉我这样的事情的答案，有时我有一个更谨慎的人，但在法律合同中为我指明了正确的方向。无论他们最后说什么，都会由非常隐蔽的应用程序审批团队（没有电话号码，没有电子邮件地址）做出决定。可能发生的最糟糕的情况是您必须在没有它的情况下重新提交您的应用程序。花费您的时间，但仅此而已。

我总是将此[链接](https://developer.apple.com/contact/phone.php)用于电话号码，我认为它们仍然有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T20:00:02.697

我相信您提出的方法会起作用，因为 a）您没有链接到外部网站来购买产品（即，您仍在使用 App Store iAP 方法）和 b）还有其他使用类似功能的程序（例如，输入在您的 OpenFeint 用户名中启用该服务）。

祝你好运！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-01-10T13:48:46.970

我遇到了同样的问题......所以我打电话给苹果开发者 IAP 帮助台，他们将我重定向到通过电子邮件发送该`App Store Review`部分。

第二天他们给我写信：

> 我们了解到，您希望了解您正在为您的应用开发的商业模式。
> 
> 我们无法就应用创意或概念提供预先批准或指导。在您提交应用后，我们将在审核过程中提供反馈（如果适用）。

所以我祝你好运......没有一个明确的选择

# apache-flex - 在 Flex 中将文本显示为超链接

> ID：12307464
> 
> 赞同：4
> 
> 时间：2012-09-06T19:57:07.473
> 
> 标签：apache-flex, hyperlink, styling

```
<mx:VBox id="paSenate" label="PA Senate" width="100%" verticalGap="0">
            <mx:HBox>
                <mx:Label text="PA Senate" fontWeight="bold"></mx:Label>
                <mx:Label id="paSenateConf" text="" />
            </mx:HBox>
            <mx:Label id="paSenateNameLabel" text="" paddingLeft="5"/>
            <mx:Label id="paSenateCountyLabel" text="" paddingLeft="5"/>
            <mx:Label id="paSenateURLLabel" text="" paddingLeft="5"/>
        </mx:VBox> 
```

我上面的代码显示了基于地址搜索的结果。显示的所有信息都来自数据库或 Web 服务。包括参议院和众议院成员的网址。该网站以字符串形式返回。现在它只是简单地被传递到 paSenateURLLabel 的文本字段中。我需要以某种方式将其更改为超链接，以便它可以点击。这是在 Flex 3.5 中完成的。不完全确定我将如何去做。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-06T20:07:20.647

Flex 3 有一个可以执行此操作的[LinkBut​​ton组件。](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/mx/controls/LinkButton.html)（注意，如果您使用的是 Flex 4，您只需为 a 制作基于文本的皮肤`Button`或使用具有超链接功能的 TLF 文本。）

```
<mx:LinkButton label="I'm a link" click="linkClickhandler()" /> 
```

# sql - 更新为 NULL 的列

> ID：12307471
> 
> 赞同：3
> 
> 时间：2012-09-06T19:57:34.460
> 
> 标签：sql, sql-server, sql-server-2005

我有一个包含列 isStaff（位）的 Person 表，它允许 NULL 值。

目的是该字段必须包含值 0/1；但是，由于首先缺乏对用户输入的应用程序处理，因此该列中有多个值为 NULL 的记录。

如果我尝试执行此查询：

```
UPDATE Person
SET isStaff = 0
WHERE isStaff IS NULL 
```

我得到错误：

> *子查询返回超过 1 个值。当子查询跟随 =、!=、<、<=、>、>= 或子查询用作表达式时，这是不允许的。*

知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-06T20:19:29.897

如果那是您发布的完全一样的查询，那么我倾向于相信您在`Person`您甚至不知道的表上有一个触发器。

我也倾向于相信它正在做一些事情：

```
UPDATE SomeOtherTable
SET SomeColumn = 1
WHERE SomeOtherTable.ID = inserted.ID 
```

使用触发器，`inserted`表包含**所有**更新的记录，而不仅仅是一条记录，您会想要这样的东西：

```
UPDATE SomeOtherTable
SET SomeColumn = 1
WHERE ID IN (SELECT ID FROM inserted) 
```

当然，这一切都是推测性的，直到您可以确认桌子上是否有触发器，如果​​有，触发器正在做什么。

# javascript - 通过 URL 参数在远程页面上设置 iframe 源

> ID：12307479
> 
> 赞同：1
> 
> 时间：2012-09-06T19:58:14.100
> 
> 标签：javascript, jquery, html, iframe, parameter-passing

我正在使用 3 页。

**shop_mobile.php**

此页面从 MySQL 数据库中检索产品数据并列出其格式。它接受url 参数brand=BRANDNAME 和cat=CATEGORY。

以下是此页面的两个实际操作示例：
[http ://solanocycle.com/shop_mobile.php?brand=KYMCO&cat=KYMCO%20Scooters](http://solanocycle.com/shop_mobile.php?brand=KYMCO&cat=KYMCO%20Scooters)

[http://solanocycle.com/shop_mobile.php?brand=peacesports&cat=Peace%20Sports%20Scooter](http://solanocycle.com/shop_mobile.php?brand=peacesports&cat=Peace%20Sports%20Scooter)

**车辆.html**

此页面包含查看特定产品列表页面的链接（即“KYMCO 滑板车”、“Peace Sports 滑板车”）。当这些链接被点击时，它们都应该将用户带到同一个页面（view.html），但传递 URL 参数，这些参数告诉 view.html 中的 iframe 使用哪个 url 作为其源。

**视图.html**

此页面包含一个 iframe，它从来自 vehicle.html 的链接传递的 URL 参数获取其源

*笔记：*

我尝试使用[如何将 URL 参数传递给 Wordpress 页面中的 iFrame？](https://stackoverflow.com/questions/7790867/how-do-i-pass-url-parameter-to-an-iframe-in-wordpress-page)解决我的问题，但我以前从未使用过 jquery，我无法让它正常工作。

任何帮助将不胜感激。

***更多信息***

Vehicles.html 中的链接示例

`<a href="view.html?http://solanocycle.com/shop_mobile.php?brand=KYMCO&cat=KYMCO%20Scooters">KYMCO Scooters</a>`

我认为 View.html 应该做什么：

1.  从网址“view.html? [http](http://solanocycle.com/shop_mobile.php?brand=KYMCO&cat=KYMCO%20Scooters) ://solanocycle.com/shop_mobile.php?brand=KYMCO&cat=KYMCO%20Scooters”中提取“ [http://solanocycle.com/shop_mobile.php?brand=KYMCO&cat=KYMCO%20Scooters](http://solanocycle.com/shop_mobile.php?brand=KYMCO&cat=KYMCO%20Scooters) ”并将其存储为名为 $embedLink 的变量。

2.  显示一个以 $embedLink 作为其源 URL 的 Iframe。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T23:00:10.123

假设您在 vehicle.html 上的链接结构良好，如下所示：

view.html?url=http://solanocycle.com/shop_mobile.php?brand=KYMCO&cat=KYMCO%20Scooters

view.html 所需的 jQuery 将是：

```
<script type="text/javascript">
$(document).ready(function(){
    var regex = /\?url=(.*)/,
    $embedLink = document.location.href.match(regex)[1];
    $('iframe').attr('src', $embedLink);
});
</script> 
```

显然，您可以将“iframe”替换为 iframe 的 id 或类以更具体。

另一种方法是使用 php 提取请求参数并将其回显，以代替 iframe 的 src 属性：

```
<?php $embedLink = (isset($_GET['url']) ? $_GET['url'] : ''); ?>

<iframe src="<?php echo $embedLink; ?>"></iframe> 
```

我建议在这两种情况下都对请求参数进行清理，以防止 XSS。

# python - 在 Python 中使用 email.mime.multipart 发送电子邮件

> ID：12307485
> 
> 赞同：5
> 
> 时间：2012-09-06T19:58:44.113
> 
> 标签：python, email, mime-types

我正在尝试从一本书（“Hello！Python”）中学习 python。根据这本书，这段代码应该发送一封电子邮件。到目前为止没有运气。

```
import os

from email.mime.multipart import MIMEMultipart
from email.mime.text import MIMEText
import smtplib

def send_message(message):
    s = smtplib.SMTP('smtp.me.com')
    s.sendmail(message['From'], message['To'], message.as_string())
    s.quit()

def mail_report(to, ticker_name):
    outer = MIMEMultipart()
    outer['Subject'] = "Stock report for " + ticker_name
    outer['From'] = "myemail@mac.com"
    outer['To'] = to

    # Internal text container
    inner = MIMEMultipart('alternative')
    text = "Here is the stock report for " + ticker_name
    html = """\
    <html>
      <head></head>
      <body>
        <p>Here is teh stock report for
          <b> """ + ticker_name + """ </b>
        </p>
      </body>
    </html>
    """
    part1 = MIMEText(text, 'plain')
    part2 = MIMEText(html, 'html')
    inner.attach(part1)
    inner.attach(part2)
    outer.attach(inner)

    filename = 'stocktracker-%s.csv' % ticker_name
    csv_text = ''.join(file(filename).readlines())
    csv_part = MIMEText(csv_text, 'csv')
    csv_part.add_header('Content-Disposition', 'attachment', filename=filename), outer.attach(csv_part)
    return outer

if __name__ == '__main__':
    email = mail_report('myemail@mac.com', 'GOOG')
    send_message(email) 
```

我没有收到错误消息，但我也没有收到电子邮件。（不用说，我使用的是我的实际电子邮件，而不是'myemail@mac.com'）所有建议和建议阅读都表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T20:29:56.297

您可以运行本地 smtp 调试服务器。找到 smtpd.py 所在的位置，然后运行命令：

```
$ python /usr/lib/python2.7/smtpd.py -n -c DebuggingServer localhost:8025 
```

然后在第二个终端屏幕上运行 Python 解释器：

```
>>> import smtplib
>>> s = smtplib.SMTP('localhost', 8025)
>>> s.sendmail('me', 'you', 'Hi!') 
```

你应该看到“嗨！” 在第一个屏幕中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T20:22:49.493

[如果smtplib.sendmail](http://docs.python.org/library/smtplib.html#smtplib.SMTP.sendmail)无法发送邮件，它最终应该会引发异常 - 由于连接被防火墙断开，超时可能只需要一段时间。给它几分钟。同时，请阅读下文，了解可能出现的问题。

该代码尝试直接连接到**smtp.me.com**并通过 SMTP（端口 25）发送邮件。这仅在以下情况下有效：

*   您的互联网设置允许您在端口 25 上建立传出连接
*   smtp.me.com 在端口 25 上侦听（确实如此）
*   收件人电子邮件是以**@mac.com**结尾的有效地址（**myemail@mac.com**无效`550 5.1.1 unknown or illegal alias: myemail@mac.com` ：）
*   smtp.me.com 仍在处理@mac.com 的电子邮件（Mobile Me 前段时间被 iCloud 关闭，所以我不确定@mac.com 地址是否仍然有效）

您可以将任何其他邮件服务器替换为**smtp.me.com**，最好是您的 ISP 的，它应该愿意将电子邮件中继到任何地址（与 smtp.me.com 不同，它只关心 mac.com 域）。

# regex - 在双引号之间的文本文件中查找特定单词

> ID：12307497
> 
> 赞同：2
> 
> 时间：2012-09-06T20:00:12.263
> 
> 标签：regex, notepad++

我有很多文本文件，需要找到文件上下文中可能存在的某些单词，但只需要引号中的单词。

示例：仅在引号中的“搜索”一词下方的文本中查找（“搜索”一词可能会有所不同）。

```
1\.  text text text text text text search text
2\.  text "search text text text text" text
3\.  text "SEARCH text text text text" text 
```

对于这个精确的例子，我只期望第 2 行和第 3 行的单词。

感谢任何可以帮助我的人。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T20:18:36.980

如果你能保证只有一组报价，那么

```
/".*search.*"/i 
```

应该做。但是如果可以有不止一对引号，那么您必须确保已传递偶数个引号，以免您将结束引号误认为开始引号：

```
/^[^"]*("[^"]*"[^"]*)*"[^"]*search[^"]*"/i 
```

Here's [a demo](http://regexpal.com/?flags=gim&regex=%5E%5B%5E%22%5Cn%5D%2a%28%22%5B%5E%22%5Cn%5D%2a%22%5B%5E%22%5Cn%5D%2a%29%2a%22%5B%5E%22%5Cn%5D%2asearch%5B%5E%22%5Cn%5D%2a%22&input=1.%20text%20text%20text%20text%20text%20text%20search%20text%0D%0A%0D%0A2.%20text%20%22search%20text%20text%20text%20text%22%20text%0D%0A%0D%0A3.%20text%20%22SEARCH%20text%20text%20text%20text%22%20text%0D%0A%0D%0A4.%20text%20%22hello%20world%22%20test%20%22search%20text%20text%22%20text%0D%0A%0D%0A5.%20text%20%22hello%20world%22%20search%20%22text%20text%20text%22%0D%0A). (Note that the demo contains `\n`s purely for presentation purposes.) **If you see two `#`s in the demo regex, please replace them with parentheses `(` `)`—it is a limitation of the way RegexPal encodes its data in the URL.**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T20:05:14.063

我想要双引号之间的所有单词，我会简单地使用`grep`：

```
 grep -E -o '".*"' inputfile 
```

如果你只想要第一个词：

```
sed  -E 's/.+"([[:alpha:]]+) .*/\1/' inputfile 
```

# java - 验证 Xml、Xsd 并转换为其他 Xml

> ID：12307499
> 
> 赞同：0
> 
> 时间：2012-09-06T20:00:18.347
> 
> 标签：java, javascript, xml, eclipse, hibernate

我试图在java中输入一个xml，xsd并验证它们。接下来，如果我发现它们是真的，那么我必须将输入 xml 转换为其他 xml。我以这样一种方式完成了我的程序，尽管 xml 和 xsd 没有验证真实......我可以使用我不想的 xsl 将 xml 转换为其他 xml。需要帮助。

**代码如下：**在此代码中，XsdFile、XslFile 都预定义到我要测试的文件夹中。它们只是对象。或者，像文件“c:\abc.xml”一样思考。我只关心**if(doc!=null)**的情况。我应该给那里什么才能正常工作。尽管验证失败，但以下代码仍在工作。

```
DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
    factory.setValidating(true);
    factory.setAttribute(
            "http://java.sun.com/xml/jaxp/properties/schemaLanguage",
            "http://www.w3.org/2001/XMLSchema");
    factory
            .setAttribute(
                    "http://java.sun.com/xml/jaxp/properties/schemaSource",
                    XsdFile);

    try {
        System.out.println();
        DocumentBuilder parser = factory.newDocumentBuilder();
        Document doc = parser.parse(XmlFile);

        if (doc != null) {
            Source xmlInput = new StreamSource(new File(XmlFile));
            Source xsl = new StreamSource(new File(inputXslFile));
            Result xmlOutput = new StreamResult(new File(transformedXml));

            try {
                Transformer transformer = TransformerFactory.newInstance()
                        .newTransformer(xsl);
                transformer.transform(xmlInput, xmlOutput);
                System.out.println("The transformed xml is:" + xmlOutput);
            } catch (TransformerException e) {
                // Handle.
            }

        }

    } catch (ParserConfigurationException e) {
        System.out.println("Parser not configured: " + e.getMessage());
    } catch (SAXException e) {
        System.out.print("Parsing XML failed due to a "
                + e.getClass().getName() + ":");
        System.out.println(e.getMessage());
    } catch (IOException e) {
        e.printStackTrace();
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T20:31:31.867

这有点烦人。XML 解析的默认 ErrorHandler 只是打印出错误。因此，当验证失败时，您只会收到一条错误消息。您应该在 DocumentBuilderFactory 上指定一个自定义 ErrorHandler，当验证失败时它会引发异常。

附带说明一下，由于您已经将 xml 解析为 DOM，因此您应该使用 DOMSource 进行转换（因此您无需重新解析 xml 即可对其进行转换）。

# coffeescript - $q defer 和 promises 以及如何使用它们在视图呈现之前为控制器加载数据

> ID：12307501
> 
> 赞同：2
> 
> 时间：2012-09-06T20:00:22.367
> 
> 标签：coffeescript, angularjs, promise

这是我发现的最相关的事情：[https ://stackoverflow.com/a/11972028/110233](https://stackoverflow.com/a/11972028/110233)

当我只想返回一个东西时，它似乎工作正常，但是当其他东西取决于第一件事时，我不确定如何返回多个东西。

因为这有点迟钝，所以这是我目前正在做的一个小例子：

```
window.EventRosterCtrl = ($scope, subevent) ->
    $scope.subevent = subevent

EventRosterCtrl.resolve = 
    subevent: (SubEvent, $route) ->
        deferred = $q.defer()

        SubEvent.get {subevent_id: $route.current.pathParams.subevent_id}, (subevent) ->
            deferred.resolve subevent

        return deferred.promise 
```

这是我想做的一个例子：

```
window.EventRosterCtrl = ($scope, subevent, addresses) ->
    $scope.subevent = subevent
    $scope.addresses = addresses

EventRosterCtrl.resolve = 
    subevent: (SubEvent, $route) ->
        deferred = $q.defer()

        SubEvent.get {subevent_id: $route.current.pathParams.subevent_id}, (subevent) ->
            deferred.resolve subevent

        return deferred.promise

    addresses: (User) ->
        deferred = $q.defer()

        # how do you get subevent called first and how would you access it here?
        for participant in subevent.participants
            User.get {user_id: participant.user}, (user) ->
                addresses[participant._id] = user.address

        deferred.resolve addresses

        return deferred.promise 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T05:47:50.183

您需要使用 .then() 链接承诺

```
  var promise = firstOperation();
  承诺 = promise.then（函数（值）{
    // 做更多的工作
    返回值；// 它可以是另一个promise
  });
  回报承诺；// 当两个步骤都解决时，这一个将被解决

```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-15T23:38:00.737

好的，所以您无法以这种方式控制它，但想到的解决方法（当一个解决方案首先取决于另一个完成时）只需将所有内容放在一个对象中并解决它。最终对我最有效的是提供服务，但要遵循我原来的例子：

```
window.EventRosterCtrl = ($scope, info) ->
    $scope.subevent = info.subevent
    $scope.addresses = info.addresses

EventRosterCtrl.resolve = 
    info: (SubEvent, User, $route, $q) ->
        deferred = $q.defer()
        resolvedInfo = {}

        SubEvent.get {subevent_id: $route.current.pathParams.subevent_id}, (subevent) ->
            resolvedInfo.subevent = subevent

            for participant in subevent.participants
                User.get {user_id: participant.user}, (user) ->
                    addresses[participant._id] = user.address

                    if addresses.length is subevent.participants.length
                        resolvedInfo.addresses = addresses
                        deferred.resolve resolvedInfo

        return deferred.promise 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-10T18:35:09.860

EventRosterCtrl 仅在子事件准备就绪时才被初始化，因此以下应该可以工作：

```
window.EventRosterCtrl = ($scope, subevent) ->
    $scope.subevent = subevent

    for participant in subevent.participants
        User.get {user_id: participant.user}, (user) ->
            $scope.addresses[participant._id] = user.address

EventRosterCtrl.resolve = 
    subevent: (SubEvent, $route) ->
        deferred = $q.defer()

        SubEvent.get {subevent_id: $route.current.pathParams.subevent_id}, (subevent) ->
            deferred.resolve subevent

        return deferred.promise 
```

# php - 将对象传递给函数

> ID：12307502
> 
> 赞同：0
> 
> 时间：2012-09-06T20:00:28.390
> 
> 标签：php

我有一个在执行 SQL 语句之前转义数据的函数。现在的问题是我有 4 个数据库，那么如何将数据库对象传递给函数。

```
function escape($what) 
{
global $db;

foreach ($what as $variable => $value)
{
    if (is_string($value) || is_numeric($value))
    {

        $GLOBALS[$variable] = $db->real_escape_string();
    }
    else
    {
        $GLOBALS[$variable] = $value;
    }
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T20:02:27.093

只需向您的函数添加另一个参数：

```
function escape($db, $what) 
```

并更改对函数的调用。

# java - 在Java中缓冲输出流比输入流更有效吗？

> ID：12307503
> 
> 赞同：10
> 
> 时间：2012-09-06T20:00:33.037
> 
> 标签：java, stream

今天早些时候感到无聊，我开始思考 Java 中缓冲和非缓冲字节流的相对性能。作为一个简单的测试，我下载[了一个相当大的文本文件](http://norvig.com/big.txt)并编写了一个简短的程序来确定缓冲流在复制文件时的效果。进行了四项测试：

1.  使用无缓冲的输入和输出字节流复制文件。
2.  使用缓冲输入流和非缓冲输出流复制文件。
3.  使用无缓冲输入流和缓冲输出流复制文件。
4.  使用缓冲的输入和输出流复制文件。

毫不奇怪，使用缓冲输入和输出流比使用无缓冲流快几个数量级。然而，*真正*有趣的事情（至少对我而言）是案例 2 和案例 3 之间的速度差异。一些示例结果如下：

```
Unbuffered input, unbuffered output
Time: 36.602513585

Buffered input, unbuffered output
Time: 26.449306847

Unbuffered input, buffered output
Time: 6.673194184

Buffered input, buffered output
Time: 0.069888689 
```

对于那些感兴趣的人，代码可以[在 Github](https://gist.github.com/3659948)上找到。谁能解释为什么案例 2 和 3 的时间如此不对称？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-06T20:08:04.450

当你**读取**一个文件时，它下面的文件系统和设备会做不同级别的缓存。他们几乎从不一次读取一个字节；他们读了一个块。在随后读取下一个字节时，该块将在缓存中，因此速度会快得多。

因此，如果您的缓冲区大小与块大小相同，那么缓冲输入流实际上并不会为您带来太多好处（它节省了一些系统调用，但就实际的物理 I/O 而言不会为您节省太多）。

当你**写**一个文件时，文件系统不能*为你*缓存，因为你没有给它积压的东西要写。它可能会为您缓冲输出，但它必须对刷新缓冲区的频率做出有根据的猜测。通过自己缓冲输出，您可以让设备一次完成更多工作，因为您手动建立了积压工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-06T20:35:22.530

对于您的标题问题，缓冲输出更有效。原因是硬盘驱动器 (HDD) 将数据写入其扇区的方式。特别是考虑到碎片磁盘。读取速度要快得多，因为磁盘已经知道数据的位置，而不必确定它适合的位置。使用缓冲区，磁盘将找到比无缓冲方式更大的连续空白空间来保存数据。再进行一次测试以获取咯咯笑声。在磁盘上创建一个新分区并运行测试读取和写入到干净的状态。要将苹果与苹果进行比较，请在测试之间格式化新创建的分区。如果您进行测试，请在此之后发布您的号码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-06T20:07:39.850

通常，写入对于计算机来说更加繁琐，因为它无法缓存而读取可以。一般来说，它就像在现实生活中一样——阅读比写作更快、更容易！

# javascript - 检测图像是否在 Javascript 中损坏

> ID：12307506
> 
> 赞同：5
> 
> 时间：2012-09-06T20:00:48.267
> 
> 标签：javascript, image, html, canvas

我正在使用 Javascript 将图像添加到 HTML5 画布：

```
img = new Image(); 
img.addEventListener('load', loadCallBack, false);
img.src = image_url; 
```

然后`loadCallBack`绘制图像。

问题是有时`image_url`指的是损坏的或不存在的图像。发生这种情况时，我在控制台中收到 404 错误，并且画布上的图像保持白色。相反，我希望能够将图像的`src`属性替换为另一个`image_url`.

我尝试了以下方法，但没有奏效：

```
img.addEventListener("error", function(){console.log("404");}); 
```

如何检测图像的 404？

**注意：**我仍在寻找解决方案，因为到目前为止发布的两个都没有工作。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-06T22:11:24.980

与 Kostia 的答案相同的代码：只是为了比较 jQuery 的丑陋和 vanilla javascript 的美感：

```
function brokenImage() { ... }

img = new Image();
img.onerror = brokenImage;
img.src = "invalid_img_name.png";​ 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-06T20:06:24.017

在 jQuery 中为我工作... [http://jsfiddle.net/5v2qG/](http://jsfiddle.net/5v2qG/)

```
img = new Image(); 
$(img).bind('error', function () {
      alert('error called');                                                
});
img.src = "invalid_img_name.png";​ 
```

# python - 在 python 中计算属性的时间和频率是多少？

> ID：12307509
> 
> 赞同：5
> 
> 时间：2012-09-06T20:01:02.290
> 
> 标签：python

> **可能重复：**
> [python：属性字段是否被自动缓存？](https://stackoverflow.com/questions/6428723/python-are-property-fields-being-cached-automatically)

作为对 python 中属性效率的关注，我想知道它们何时以及多久被调用一次。

举一个简单的例子，假设我是 namedtuple 的子类，我有类似的东西：

```
from collections import namedtuple
from math import pi

class Circle (namedtuple('Circle', 'x, y, r')):
    __slots__ = ()

    @property
    def area(self):
        return pi*self.r**2

unitCircle = Circle(0, 0, 1.0)
print 'The area of the unit circle is {0} units'.format(unitCircle.area) 
```

我假设直到第一次调用该区域时才计算该区域，但是一旦调用该区域，该值是否会缓存到某些内容发生更改或每次调用时都会重新计算？

换句话说，如果我有一个属性（与这个不同）计算起来相对昂贵并且会被重复使用，我应该让它成为一个属性，还是将它存储为一个值并在何时显式计算它更有效？它真的需要更新吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-06T20:02:23.180

除非您明确执行，否则不会缓存属性，因此每次访问属性时都会运行代码。尝试：

```
@property
def area(self):
    try:
        return self._area
    except AttributeError:
        area = pi*self.r**2
        self._area = area
        return area 
```

如果您希望能够偶尔根据需要重新计算值，请执行以下操作：

```
@property
def area(self):
    try:
        return self._area
    except AttributeError:
        self.recalc_area()
        return self._area

def recalc_area(self):
    self._area = pi*self.r**2 
```

或者，如果您想更自动地执行此操作：

```
@property
def area(self):
    try:
        return self._area
    except AttributeError:
        area = pi*self.radius**2
        self._area = area
        return area

@property
def radius(self):
    return self._radius

@radius.setter
def radius(self, radius):
    try:
        del self._area
    except AttributeError:
        pass
    self._radius = radius 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T20:07:20.803

python 中的装饰器（如@property）在加载类时得到评估。有时对类产生的影响会包括额外的功能，但装饰器本身只运行一次。

# javascript - 嵌套在 SVG 标记中的脚本标记直接嵌入 HTML 会导致 SVG 显示为空白

> ID：12307514
> 
> 赞同：0
> 
> 时间：2012-09-06T20:01:38.043
> 
> 标签：javascript, safari, svg

我试图在 SVG 标记内嵌套一个脚本标记，但 SVG 在 Safari 中显示为空白。

以下小提琴适用于 FF 15.0、Chrome 21.0 和 IE9，但不适用于 Windows 上的 Safari 5。

[http://jsfiddle.net/5rnbU/4/](http://jsfiddle.net/5rnbU/4/)

```
<svg height="320" width="320" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg"> 
    <script >
    setTimeout("run()",1000);

    function run(){
        var e = document.getElementById("rect");
        console.log(e);
        setTimeout("run()",1000);
    }
    </script>
    <rect id="rect" ry="6" rx="6" fill="silver" height="320" width="320" y="0" x="0"/>
</svg> 
```

SVG 直接嵌入到 HTML 中。如果删除了 script 标签，这将起作用，如果您检查 SVG，您将看到 script 标签包含以下 SVG 元素。为什么？有哪些解决方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-29T14:58:52.343

JSFiddle 需要你在 javascript 面板中编写 javascript 代码。您在 html 面板中编写 javascript 代码，而 JSFiddle 无法正确运行它。

正确的方法是：

[http://jsfiddle.net/5rnbU/7/](http://jsfiddle.net/5rnbU/7/)

在 html 面板中编写 html：

```
<svg height="320" width="320" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg"> 
    <rect id="rect" ry="6" rx="6" fill="silver" height="320" width="320" y="0" x="0"/>
</svg> 
```

在 javascript 面板中编写 javascript：

```
setTimeout("run()",1000);

function run(){
    var e = document.getElementById("rect");
    console.log(e);
    setTimeout("run()",1000);
} 
```

不要把它们都写在 html 面板中。

# jquery - 使用单选按钮显示/隐藏 div 的多种重力形式验证

> ID：12307516
> 
> 赞同：1
> 
> 时间：2012-09-06T20:01:45.753
> 
> 标签：jquery, forms, wordpress

我在同一页面上使用 2 个重力形式时遇到问题。首先，每个表单都在一个隐藏的“div”中，用户必须从 3 个显示/隐藏另一个表单的单选按钮中进行选择。这部分有效，*但是*如果验证失败，页面会刷新并且表单会被隐藏。用户必须重新单击同一个收音机才能查看验证失败的原因。我还将重力形式设置为使用 ajax 模式，但这并不能解决问题。

这就是我的 JavaScript 的样子：

```
<script type="text/javascript">

    jQuery(document).ready(function(){ 

        jQuery(".cdiv").hide();

        jQuery("input[name=contact_type]").change(function() {
            var _div_id = jQuery(this).val();
            jQuery(".cdiv").hide('slow');
            jQuery("#"+_div_id).show('slow');
        }); 
    });

</script> 
```

HTML 看起来像这样（我删除了表单以保持 html 简短）

```
<input type="radio" name="contact_type" value="c1" /> Careers <br />
<input type="radio" name="contact_type" value="c2" /> Partner with us <br />
<input type="radio" name="contact_type" value="c3" /> Media Inquiries <br />

<div class="cdiv" id="c1">
[career info here]
</div>

<div class="cdiv" id="c2">
form 1 loads here
</div>

<div class="cdiv" id="c3">
form 2 loads here
</div> 
```

非常感谢您的帮助和建议。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T20:15:23.043

网页是无状态的——当他们加载（或重新加载）时，他们不知道他们之前的状态是什么。

恢复状态由您决定，因此您必须在某处记录此状态。这通常存储在 URL 哈希或 cookie 中。

这应该如何与 URL 哈希一起工作（您需要编写代码来执行此操作）：

当用户单击其中一个单选按钮时，您设置`document.location.hash`为一个已知值，例如“b1”。

然后当页面重新加载时，您查看`document.location.hash`（使用 JS）的当前值，如果该值为“b1”，则您知道用户按下了单选按钮 #1。然后您的脚本会显示相应的面板。

# twitter - 在 Amazon Elastic Compute Cloud (Amazon EC2) 上托管 twitter 流 api 的优缺点是什么

> ID：12307518
> 
> 赞同：0
> 
> 时间：2012-09-06T20:01:52.523
> 
> 标签：twitter, amazon-web-services, amazon-ec2, twitter-streaming-api

对于我的一个研究项目，我正在编写一个用于分析推文的情绪分析工具。

我现在的问题是：在 Amazon Elastic Compute Cloud (Amazon EC2) 上托管 twitter 流 API 的优缺点是什么？

微型（免费）包就足够了吗？有人在推特方面有任何经验吗？

谢谢你的帮助

克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T20:06:51.457

使用 Amazon Elastic 计算 (Amazon EC2) 可能有很多优点和缺点。我建议你看看[这个答案](https://stackoverflow.com/questions/3495582/amazon-ec2-as-web-server)，使用 twitter 流 API 绝对是在这个问题中给出答案的一个子集。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T20:18:55.170

Amazon EC2 是一种与其他任何服务器一样的虚拟服务器，只是具有比大多数传统竞争对手更动态的定价系统。亚马逊网络服务最大的优点是高可靠性。另一方面，它不是很便宜。当您确切知道需要多少 CPU 和 RAM 容量时，我会建议您使用专用服务器。一个经常被忽视的专业人士是与其他非常有用的 Amazon Web 服务（如 DynamoDB 和 S3）的集成。

什么对您的服务最好完全取决于您需要什么。

# c# - 激活器.CreateInstance vs 编译表达式。两台不同机器上的逆向性能

> ID：12307519
> 
> 赞同：8
> 
> 时间：2012-09-06T20:02:04.207
> 
> 标签：c#, reflection, lambda, activator

我和一个朋友正在测试使用编译表达式来创建对象，而不是`Activator.CreateInstance<T>`遇到了一些有趣的结果。我们发现，当我们在每台机器上运行相同的代码时，我们看到的结果完全相反。他得到了预期的结果，编译表达式的性能明显更好，而我很惊讶地看到`Activator.CreateInstance<T>`性能提高了 2 倍。

两台计算机都运行在 .NET 4.0 中编译

计算机 1 安装了 .NET 4.5。计算机 2 没有。

**计算机 1 超过 100000 个对象：**

```
45ms - Type<Test>.New()
19ms - System.Activator.CreateInstance<Test>(); 
```

**计算机 2 超过 100000 个对象：**

```
13ms - Type<Test>.New()
86ms - System.Activator.CreateInstance<Test>(); 
```

这是代码：

```
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Linq;
using System.Linq.Expressions;

namespace NewNew
{
    class Program
    {
        static void Main(string[] args)
        {
            Stopwatch benchmark = Stopwatch.StartNew();
            for (int i = 0; i < 100000; i++)
            {
                var result = Type<Test>.New();
            }
            benchmark.Stop();
            Console.WriteLine(benchmark.ElapsedMilliseconds + " Type<Test>.New()");

            benchmark = Stopwatch.StartNew();
            for (int i = 0; i < 100000; i++)
            {
                System.Activator.CreateInstance<Test>();
            }
            benchmark.Stop();
            Console.WriteLine(benchmark.ElapsedMilliseconds + " System.Activator.CreateInstance<Test>();");
            Console.Read();
        }

        static T Create<T>(params object[] args)
        {
            var types = args.Select(p => p.GetType()).ToArray();
            var ctor = typeof(T).GetConstructor(types);

            var exnew = Expression.New(ctor);
            var lambda = Expression.Lambda<T>(exnew);
            var compiled = lambda.Compile();
            return compiled;
        }
    }

    public delegate object ObjectActivator(params object[] args);

    public static class TypeExtensions
    {
        public static object New(this Type input, params object[] args)
        {
            if (TypeCache.Cache.ContainsKey(input))
                return TypeCache.Cache[input](args);

            var types = args.Select(p => p.GetType());
            var constructor = input.GetConstructor(types.ToArray());

            var paraminfo = constructor.GetParameters();

            var paramex = Expression.Parameter(typeof(object[]), "args");

            var argex = new Expression[paraminfo.Length];
            for (int i = 0; i < paraminfo.Length; i++)
            {
                var index = Expression.Constant(i);
                var paramType = paraminfo[i].ParameterType;
                var accessor = Expression.ArrayIndex(paramex, index);
                var cast = Expression.Convert(accessor, paramType);
                argex[i] = cast;
            }

            var newex = Expression.New(constructor, argex);
            var lambda = Expression.Lambda(typeof(ObjectActivator), newex, paramex);
            var result = (ObjectActivator)lambda.Compile();
            TypeCache.Cache.Add(input, result);
            return result(args);
        }
    }

    public class TypeCache
    {
        internal static IDictionary<Type, ObjectActivator> Cache;

        static TypeCache()
        {
            Cache = new Dictionary<Type, ObjectActivator>();
        }
    }

    public class Type<T>
    {
        public static T New(params object[] args)
        {
            return (T)typeof(T).New(args);
        }
    }

    public class Test
    {
        public Test()
        {

        }

        public Test(string name)
        {
            Name = name;
        }

        public string Name { get; set; }
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-06T20:37:35.363

这至少有两个原因：

*   `Type<Test>.New()`调用或`System.Activator.CreateInstance<Test>()`第一次的开销比较大。因此，我将 100000 更改为 10000000。
*   在发布模式下构建您的应用程序，无需调试器即可运行它。

通过这两个更改，这两种方法花费的时间大致相同。在我的系统上，两种方法的结果都在 1100 到 1200 之间，有时一种会高一点，有时另一种会高一些。

注意`Activator.CreateInstance<T>()`只能调用默认构造函数，而你`New()`接受多个参数。如果你让你的`New()`功能不那么强大，并且总是在那里使用默认构造函数，它会比`Activator.CreateInstance<T>()`我的系统稍微快一点。

另请注意，如果应使用两个相同类型的不同构造函数，则您对带参数的构造函数的处理实际上不起作用，具体取决于传递的参数。您选择一次将哪个构造函数用于整个程序的其余部分。

# visual-studio-2010 - 如何折叠所有 html '区域'

> ID：12307521
> 
> 赞同：1
> 
> 时间：2012-09-06T20:02:05.883
> 
> 标签：visual-studio-2010

给定一个在正文中有许多 div 的页面（x.cshtml），我想知道是否有办法折叠整个文档？折叠到 [html] 然后展开到 [body] 和我的目标 div 比单独折叠每个 div 快得多。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T20:08:25.043

使用 jQuery .hide() .show() 功能

# c# - 多个线程向 List 提供数据 > 到主线程；多线程

> ID：12307524
> 
> 赞同：1
> 
> 时间：2012-09-06T20:02:19.527
> 
> 标签：c#, multithreading, list, concurrency, .net-3.5

我有多个线程创建一个`public List<List<String>> listOfLists`并用数据填充它。完成所有线程后，我想使用主线程`list.AddRange()`中多个线程中的所有这些列表进行组合`listOfLits`。

所以，如果我有三个线程并且`listOfLists`每个线程有 10 个元素，那么`listOflists`主线程将有 30 个元素。只需简单地添加它们，主线程对象必须具有线程插入的所有数据。

如果我`static`使用`listOfLists`. 我要做的就是**摆脱`static`**.

这是一个小例子。

1.  我创建了一个简单的 Person 对象（主线程）
2.  主线程调用一个方法创建3个线程
3.  这些线程中的每一个都调用另一个方法来填充自己`listOfLists`的数据
4.  在该方法结束时，我将自己的线程添加`listOfLists`到`static listOfLists`
5.  这就是我想要避免的。不能有任何静电。
6.  我只想让这些线程数据在我的主线程中可用，并在主线程上继续应用程序。

编辑：它必须是 .NET 3.5

Edit2：一种解决方案似乎是在启动线程时提供 listOfLists （主线程）的引用作为参数。有没有其他方法可以解决这样的线程问题？

* * *

```
namespace Threading
{
    class Program
    {
        static void Main(string[] args)
        {
            Person p = new Person("mainThread");
            p.startMultiThreading();
        }                   
 } 
```

* * *

```
class Person
{
    public String name;
    public List<String> privatePet;
    public List<List<String>> listOfLists = new List<List<string>>();
    public static List<List<String>> familyPets = new List<List<string>>();

    public Person(String n) { name = n; } //constructor
    public Person() { }

    public void startMultiThreading()
    {
        List<Thread> list_threads = new List<Thread>();
        for (int i = 0; i < 3; i++)
        {
            Person multiThreadPerson = new Person("multi: " + i); //create new Person
            Thread t = new Thread(multiThreadPerson.fill_List); //create new Thread
            t.Name = multiThreadPerson.name; //name the Thread with PersonName

            list_threads.Add(t);
            list_threads[i].Start(); //new Person is calling fill_list()
        }

        for (int i = 0; i < list_threads.Count; i++)
        {
            list_threads[i].Join();
        }

        familyPets.Add(new List<string>{"this is mainthread again"});
        foreach (List<String> list in familyPets)
        {
            list.ForEach(e => Debug.WriteLine(e));
        }
    }

    public void fill_List()
    {
        privatePet = new List<string>();
        lock (familyPets)
        {
            for (int i = 0; i < 20; i++)
            {
                privatePet.Add("dog :" + Thread.CurrentThread.Name);
                privatePet.Add("cat :" + this.name);
                listOfLists.Add(privatePet);
            }
            familyPets.AddRange(listOfLists); //adding up all listOfLists to the mainthread listOfLists
        }//lock 
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T21:06:32.343

除了`ThreadStart`委托之外，您还可以使用委托创建线程`ParameterizedThreadStart`，然后`Start()`使用带有单个对象参数的重载。您可以使用需要传递到线程的 delgate 的任何信息来创建该对象，在这种情况下，它只是您关心的列表的单个列表。

另请注意，您的锁定范围如此之广，以至于只能让一个这样的线程执行任何操作，从而破坏了多线程。您希望他们自己处理只有他们可以处理的事情（`privatePet`例如，在这种情况下，并且还`i`因为每个线程都有自己独立的视图。`Thread.CurrentThread`是静态但线程安全的（否则将毫无意义），而`this`不是线程安全的并且是共享的，在零线程写入时从字符串字段读取多个线程是安全的（您可以通过使您更安全`name` `readonly`，然后您可以通过查看 100% 的信心知道那段代码什么都不会写给它，除非它特意把事情搞砸了。

```
public void fill_List(object targetList)
{
    List<List<String>> familyPets = (List<List<String>>)targetList;
    List<List<String>> listOfLists = new List<List<String>>();//we'll use our own local one of these thanks, as it's just this thread's concern write now.
    privatePet = new List<string>();
    for (int i = 0; i < 20; i++)
    {
        privatePet.Add("dog :" + Thread.CurrentThread.Name);
        privatePet.Add("cat :" + this.name);
        listOfLists.Add(privatePet);
    }
    //note you don't need to lock until you are doing something
    //that hits on something that other threads might hit on.
    //otherwise you've just got each thread locked for their entire
    //duration and you might as well just do the whole thing
    //in one thread.
    lock (familyPets)
    {
        familyPets.AddRange(listOfLists); //adding up all listOfLists to the mainthread listOfLists
    } 
} 
```

然后在调用方法中，设置列表并将其传递给`start`：

```
list_threads[i].Start(whateverTheListIsCalled); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T21:05:55.550

我认为问题在于您使用同一类“Person”来填充数据和连接数据。

```
Person p = new Person("mainThread"); 
```

从不调用 fill_List() 并且不使用变量 privatePet 和 listOfLists。

在不过多修改代码的情况下，一个简单的解决方案是添加一个新的构造函数：

```
public Person(String n, List<List<String>> pRefFamilyPets) { name = n; familyPets = pRefFamilyPets; } //constructor 
```

并覆盖这一行，添加 familyPets 参考

```
Person multiThreadPerson = new Person("multi: " + i, familyPets); //create new Person 
```

我无法遵循逻辑，但这似乎避免了使用 STATIC，因为您将引用传递给其他线程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T07:56:45.147

```
Enumerable.Range(0, 3).AsParallel().WithDegreeOfParallelism(3).Select(n => {
    var list = new List<string>();
    list.Add(n + ": One");
    list.Add(n + ": Two");
    list.Add(n + ": Three");
    return list;
}).ToList(); 
```

或者合并列表：

```
Enumerable.Range(0, 3).AsParallel().WithDegreeOfParallelism(3).Select(n => {
    var list = new List<string>();
    list.Add(n + ": One");
    list.Add(n + ": Two");
    list.Add(n + ": Three");
    return list;
}).Aggregate((a, b) => a.Union(b).ToList()); 
```

阅读 MSDN 上的 Tasks 和 Parallel。

# javascript - 登录错误信息

> ID：12307525
> 
> 赞同：0
> 
> 时间：2012-09-06T20:02:19.713
> 
> 标签：javascript, html, login

我正在尝试使用 html、css 和 javascript 为登录页面创建登录错误消息。当有人登录页面失败时，我希望显示一条消息，说明他们的登录失败。我有几个想法，但我不确定如何实施。我在伪代码中的一个想法是......

```
var counter = 0;
if(login fails) {
counter++; }
if( counter > 0) {
var errorTag = document.createElement("div");   //display error message
errorTag.innerHTML = "<p>THIS IS AN ERROR</p>";
} 
```

我不确定您将如何将登录失败作为事件来实现。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T20:13:19.603

您应该在服务器端实现登录失败。让登录表单提交到对其进行身份验证的服务器端脚本。如果失败，将用户返回登录页面并显示错误。如果成功，则允许用户转发。

仅使用 JavaScript 和 HTML 确实没有安全的方法来验证用户身份。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T20:11:29.353

您将通过 SSL 提交表单，`https`并让服务器上的任何登录系统给出回复。

# c# - 将属性从反射传递到表达式

> ID：12307526
> 
> 赞同：2
> 
> 时间：2012-09-06T20:02:21.073
> 
> 标签：c#, asp.net-mvc, reflection, lambda

我想使用反射遍历我的模型属性，然后将它们传递给一个方法，期望我的属性作为 en 表达式。

例如，给定这个模型：

```
public class UserModel
{
    public string Name { get; set; }
} 
```

这个验证器类：

```
public class UserValidator : ValidatorBase<UserModel>
{
    public UserValidator()
    {
        this.RuleFor(m => m.Username);
    }
} 
```

还有我的 ValidatorBase 类：

```
public class ValidatorBase<T>
{
    public ValidatorBase()
    {
        foreach (PropertyInfo property in 
                     this.GetType().BaseType
                         .GetGenericArguments()[0]
                         .GetProperties(BindingFlags.Public | BindingFlags.Insance))
        {
            this.RuleFor(m => property); //This line is incorrect!!
        }
    }

    public void RuleFor<TProperty>(Expression<Func<T, TProperty>> expression)
    {
        //Do some stuff here
    }
} 
```

问题在于`ValidatorBase()`构造函数——假设我有`PropertyInfo`我需要的属性，我应该将什么作为方法中的`expression`参数传递给`RuleFor`它，这样它就可以像`UserValidator()`构造函数中的行一样工作？

或者，我应该使用其他东西`PropertyInfo`来让它工作吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-06T20:06:02.317

我怀疑你想要：

```
ParameterExpression parameter = Expression.Parameter(typeof(T), "p");
Expression propertyAccess = Expression.Property(parameter, property);
// Make it easier to call RuleFor without knowing TProperty
dynamic lambda = Expression.Lambda(propertyAccess, parameter);
RuleFor(lambda); 
```

基本上，这是为属性构建表达式树的问题......来自 C# 4 的动态类型仅用于使其更容易调用`RuleFor`，而无需通过反射显式执行此操作。当然，您*可以*这样做 - 但您需要获取`RuleFor`方法，然后`MethodInfo.MakeGenericMethod`使用属性类型调用，然后调用方法。

# c# - 如何在后面的代码中从转发器控件中获取整行？

> ID：12307529
> 
> 赞同：3
> 
> 时间：2012-09-06T20:02:29.433
> 
> 标签：c#, asp.net, .net, repeater

我正在使用转发器控件来创建一个包含少量行和列的表。在 Repeater_ItemCommand 我想在后面的代码中选择单击的行并将其存储在会话中。我该怎么做呢 ？

当我单击该行时，我的 e.Item.DataItem 将变为 NULL。我正在使用 <%# DataBinder.Eval(Container.DataItem, "FILE_NAME")%> 在 asp.net 中绑定我的值

我不能使用 LINQ。

谢谢韦德

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T20:39:50.183

这是中继器的代码

```
<asp:Repeater ID="Repeater1" runat="server" 
        onitemcommand="Repeater1_ItemCommand">
        <HeaderTemplate>
            <ul>
        </HeaderTemplate>
        <ItemTemplate>
        <li>
            <asp:LinkButton ID="btnDeleteComment" runat="server" Text="Delete" CommandName="DeleteComment" CommandArgument=<%#Eval("myId") %>></asp:LinkButton>
            <asp:Label ID="Label1" runat="server" Text='<%# DataBinder.Eval(Container.DataItem, "FileName")%>'></asp:Label>
            </li>
        </ItemTemplate>
        <FooterTemplate>
        </ul>
        </FooterTemplate>
    </asp:Repeater> 
```

这是后面代码的代码

```
public partial class _Default : System.Web.UI.Page
    {
        public class myObject
        {
            public string FileName { get; set; }
            public int myId { get; set; }
        }
        protected void Page_Load(object sender, EventArgs e)
        {
            List<myObject> myList = new List<myObject>();
            myList.Add(new myObject {myId = 1, FileName = "one" });
            myList.Add(new myObject { myId = 2, FileName = "two" });
            myList.Add(new myObject { myId = 3, FileName = "three" });

            Repeater1.DataSource = myList;
            Repeater1.DataBind();
        }

        protected void Repeater1_ItemCommand(object source, RepeaterCommandEventArgs e)
        {
            Label item = (Label)e.Item.FindControl("label1");

        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T20:37:24.660

您可以使用 Buttons'/LinkBut​​tons'/等。命令参数字段。

```
<table>
    <asp:Repeater ID="someRepeater" OnItemCommand="someRepeater_ItemCommand" runat="server">
        <HeaderTemplate>
            <tr><th>
                File Name Header
            </th></tr>                                    
        </HeaderTemplate>
        <ItemTemplate>
            <tr><td>
                <asp:LinkButton Text="File Name Item" CommandArgument='<%# DataBinder.Eval(Container.DataItem, "FILE_NAME")%>' Style="display: block" runat="server" />
            </td></tr>
        </ItemTemplate>
    </asp:Repeater>
</table> 
```

在后面的代码中：

```
protected void someRepeater_ItemCommand(object Sender, RepeaterCommandEventArgs e)
{
    Session["FILE_NAME"] = e.CommandArgument; //Here you have your FILE_NAME
} 
```

当然，这是一些示例代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-06T20:27:28.320

根据我对中继器的了解，它不应该那样使用。为什么不直接使用 GridView 和 TemplateField？

```
 <asp:GridView ID="GridView1" runat="server" AutoGenerateColumns="False"                 
            DataKeyNames="KeyColumnName"   
            DataSourceID="SqlDataSource1">  
            <Columns>  
                <asp:TemplateField>
                     ...Same template as in repater...
                </asp:TemplateField>
            </Columns>  
        </asp:GridView> 
```

# eclipse - 在视图之间共享数据 (ViewPart) Equinox

> ID：12307530
> 
> 赞同：1
> 
> 时间：2012-09-06T20:02:36.610
> 
> 标签：eclipse, eclipse-plugin, osgi, equinox

这里有一个关于 Eclipse Plugins 的小问题。

我有一个包含一些数据的 java 类，例如链表和其他一些东西。我需要 2 个视图中的这些数据。在一个视图中，我想显示其中的一些，而另一个视图应该显示一个包含数据的列表。（这是我的特例，但我一般会问这个问题）。

那么，如何在两个视图中都使用这一类？在“普通”java中，我会在创建视图时提供参考，但据我所知，这在 eclipse 插件中是不可能的。

我的解决方案是，数据类是单例。但我不喜欢这个解决方案，我认为这只适用于我的情况。

希望你明白了:) 你们中有人知道更好的解决方案吗？

（我是 eclipse 插件的新手，没有好书或教程，不是吗？）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T21:05:55.487

要回答您帖子中的第二个问题...试试这个站点以获取有关 Eclipse 插件和 RCP 应用程序的基本教程。

[www.vogella.com/eclipse.html](http://www.vogella.com/eclipse.html)

这个答案应该有助于解决您帖子中的第一个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T11:34:54.363

在 SWT 中，所有视图只显示底层业务对象的表示。因此，当您实现列表和树时，它们只需要具有相同的对象作为输入（例如调用时`treeViewer.setInput(theSharedDataObject)`）。

你的数据类不需要是一个单例，你只需要指向数据的*同一个实例*。

# c# - 获取与其输入名称标签 asp.net 关联的文件的字节 []

> ID：12307531
> 
> 赞同：0
> 
> 时间：2012-09-06T20:02:42.210
> 
> 标签：c#, asp.net, forms, post

我有 N 个文件正在上传到此应用程序。每个名称都是唯一的，但我不知道如何根据某个名称获取字节数组。

```
<input type="file" name="file1" /> 
```

并且在服务器上会有类似的东西

```
byte[] data = Request.Files["file1"];  //doesnt work, as i believe it wont take a string, but only an int index 
```

当我查找这些解决方案时， FileName 并没有那么在意，所以 Files[0].FileName 无济于事，索引也无济于事。我希望能够根据上面的名称引用内容。

我不确定我在哪里可以找到这个。正在环顾 MSDN 和这里。

我有很多文件，每个文件都有一个唯一的名称....然后根据唯一的名称，其中实际上包含一些附加信息，会告诉我如何处理它。

它似乎不像在 PHP 中那么容易。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T20:14:17.973

像这样的东西：

```
 byte[] buffer = new byte[Request.Files["file1"].ContentLength];
  Request.Files["file1"].InputStream.Read(buffer,0,buffer.Length); 
```

并遍历所有这些：

```
foreach (var item in Request.Files.AllKeys)
{
     byte[] buffer = new byte[Request.Files[item].ContentLength];
     Request.Files[item].InputStream.Read(buffer, 0, buffer.Length);    

     //do something with the byte[] - buffer 
} 
```

~~**更新：** 有趣......我刚刚运行了一个测试，如果我将其设置`runat="server"`为文件元素，它只会看到填充的 Request.Files 集合： `<input type="file" runat="server" name="file1" />`~~

**更新 2**`enctype="multipart/form-data"` ：如果您希望能够`Request.Files`使用常规 html`input:file`元素浏览集合，请确保在表单上进行设置。

# python - Python 相当于 Perl Net::NBName 来获取 Windows 用户名？

> ID：12307533
> 
> 赞同：0
> 
> 时间：2012-09-06T20:02:48.453
> 
> 标签：python, perl, netbios

我正在尝试将一些我必须使用 Python 的 Perl 脚本重新编码（并对其进行扩展）。使用 Perl，使用 Net 库，我可以提供主机名并获取 Windows 用户名。下面是一段 Perl 代码：

```
my $NetBios = Net::NBName->new;
my $nbName = $NetBios->node_status($hostname);
if ( $nbName ) {
    if ( $nbName->as_string =~ /^(\S+)\s+/ ) {
        ($user = $1) =~ tr/A-Z/a-z/;
    }
} 
```

我想在 Python 中做同样的事情，但我似乎找不到合适的库来做这件事。有没有等效的方法？

对于后台，我获取连接到终端服务器端口的用户的主机名。由此，如果主机名中包含“dhcp”或“vpn”，我想使用 NetBIOS 并尝试获取该系统（可能是 PC）的用户名。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T20:05:08.357

虽然 afaik 你不能给它一个域

```
 import getpass
 print getpass.getuser() 
```

平台 uname 也可能有用

```
 import platform
 platform.uname() 
```

我在 activestate 找到了以下内容（尽管我不能保证它的作用）

[http://code.activestate.com/recipes/66314-get-user-info-on-windows-for-current-user/](http://code.activestate.com/recipes/66314-get-user-info-on-windows-for-current-user/)

```
import win32api
import win32net
import win32netcon
def UserGetInfo():
    dc=win32net.NetServerEnum(None,100,win32netcon.SV_TYPE_DOMAIN_CTRL)
    user=win32api.GetUserName()
    if dc[0]:
        dcname=dc[0][0]['name']
        return win32net.NetUserGetInfo("\\\\"+dcname,user,1)
    else:
        return win32net.NetUserGetInfo(None,user,1)
if __name__=="__main__":
    print UserGetInfo() 
```

# c# - 有没有比这更具体的将 Sql char 转换为 c# char 的方法？

> ID：12307536
> 
> 赞同：0
> 
> 时间：2012-09-06T20:02:51.787
> 
> 标签：c#, .net, sql, sql-server, entity-framework

> **可能重复：**
> [如何使用 Entity Framework 4.1“仅代码”流式 API 映射 char 属性？](https://stackoverflow.com/questions/6760765/how-do-i-map-a-char-property-using-the-entity-framework-4-1-code-only-fluent-a)

我有一些代码需要我在 c# 中使用 char。

当我将数据作为 char(1) 存储在数据库中并通过实体框架返回时，我得到一个字符串。

我目前只是通过执行 string[0] 来转换它。抱歉，如果这是一个菜鸟问题，但有更具体的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T20:07:00.333

我认为是完美的，一个字符串是一个字符后跟一个空字节，这样你只检索第一个字符。它既快速又安全，因为如果您收到一个空字符串，char 将为空，您可以检查它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T20:07:50.740

在幕后，这应该是最快的方法，但您可能应该使用检查 null 和 .length == 0;

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-06T20:10:50.157

我相信这是处理这种情况的更好方法之一。我之前需要这样做，并且我还在那里进行了检查以确保它不为空。

所以

> 字符串[0]

是最简单的处理方法。只要确保您正在检查 null 和所有好东西

# ruby-on-rails-3 - Ruby On Rails：PdfKit 运行时错误

> ID：12307540
> 
> 赞同：6
> 
> 时间：2012-09-06T20:03:12.130
> 
> 标签：ruby-on-rails-3, ruby-on-rails-3.1, wkhtmltopdf, pdfkit

pdfkit gem 成功安装在我的机器上。然后我运行`gem install wkhtmltopdf-binary`并输出是

```
Successfully installed wkhtmltopdf-binary-0.9.9.1
1 gem installed
Installing ri documentation for wkhtmltopdf-binary-0.9.9.1...
unable to convert "\xC0" from ASCII-8BIT to UTF-8 for bin/wkhtmltopdf_linux_386, skipping
unable to convert "\xA3" from ASCII-8BIT to UTF-8 for bin/wkhtmltopdf_linux_x64, skipping
unable to convert "\xCE" from ASCII-8BIT to UTF-8 for bin/wkhtmltopdf_darwin_386, skipping
Installing RDoc documentation for wkhtmltopdf-binary-0.9.9.1...
unable to convert "\xC0" from ASCII-8BIT to UTF-8 for bin/wkhtmltopdf_linux_386, skipping
unable to convert "\xA3" from ASCII-8BIT to UTF-8 for bin/wkhtmltopdf_linux_x64, skipping
unable to convert "\xCE" from ASCII-8BIT to UTF-8 for bin/wkhtmltopdf_darwin_386, skipping 
```

好吧，然后尝试访问我页面的pdf版本。但它也向我显示了一个错误 **Runtime Error ControllerName#show**

```
command failed: "/home/yasir/.rvm/gems/ruby-1.9.3-p194/bin/wkhtmltopdf" "--page-size" "Letter" "--margin-top" "0.75in" "--margin-right" "0.75in" "--margin-bottom" "0.75in" "--margin-left" "0.75in" "--encoding" "UTF-8" "--quiet" "-" "- 
```

"

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-11-18T09:57:12.040

在您的 pdfkit 配置文件 (config/initializers/pdfkit.rb) 中添加 wkhtmltopdf 安装路径，如下所示

```
PDFKit.configure do |config|
  # Download compatible version of wkhtmltopdf from 'http://wkhtmltopdf.org/downloads.html'
  # Install it in your system.
  # Then run 'which wkhtmltopdf' in your terminal to identify the path and update it below
  config.wkhtmltopdf = '/usr/local/bin/wkhtmltopdf'
end 
```

# facebook-graph-api - 移动应用程序上的“赞”按钮，无需将您重定向到 FB 页面

> ID：12307541
> 
> 赞同：0
> 
> 时间：2012-09-06T20:03:15.017
> 
> 标签：facebook-graph-api

有没有办法让移动应用程序开发人员添加 FB 功能，让您“喜欢”某些东西，而无需真正离开您正在从中进行操作的页面/应用程序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T20:20:18.937

是的。Like 按钮是目前 Facebook 唯一可用于移动网络应用的社交插件。

[Facebook 的Mobile Web Tutorial](http://developers.facebook.com/docs/guides/mobile/web/)中描述了如何实现它。

这是一个带有 Like 按钮的[简单示例应用程序。](http://www.facebookmobileweb.com/hello/)

# jquery - 停止运行两次 Jquery 动画

> ID：12307542
> 
> 赞同：1
> 
> 时间：2012-09-06T20:03:21.693
> 
> 标签：jquery, jquery-animate

我试图让这个动画在第一次运行后停止，但如果我添加 .stop(true) 将不起作用..任何想法？

这是我的 jQuery。

```
function doDisplayError(){  
    $("#errors").animate (
            { 'top': '200px' }, {
                duration: '300',
                easing: 'easeOutQuad'
            }).delay(3000).animate (
            { 'top': '-200px' }, {
                duration: '200',
                easing: 'easeInBack'
            });
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T20:08:44.483

```
error_run_once=0;
function doDisplayError(){  
    if (error_run_once=0){
        $("#errors").animate (
            { 'top': '200px' }, {
               duration: '300',
               easing: 'easeOutQuad'
            }).delay(3000).animate (
           { 'top': '-200px' }, {
               duration: '200',
               easing: 'easeInBack'
            });
        error_run_once = 1;
    } else{
       // what else you want to do if you don't show animation?
    }
} 
```

看看它是否有效.. == 编辑 ==

而且，就像另一位评论的那样，更好的方法可能是根本不调用它。修改它的调用方式可能是更好的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T20:09:43.763

您可以使用一个变量来确定是否发生了类似这样的执行：

```
var animationExecuted = false;

function doDisplayError() {
    if(animationExecuted){
        return false;
    };
    console.log("executed");
    animationExecuted = true;

    $("#errors").animate({
        'top': '200px'
    }, {
        duration: '300',
        easing: 'easeOutQuad'
    }).delay(3000).animate({
        'top': '-200px'
    }, {
        duration: '200',
        easing: 'easeInBack'
    });
}​ 
```

### [DEMO](http://jsfiddle.net/uvF5w/) - 只执行一次代码

但是，最好了解它为什么会多次执行，并尽可能解决该问题而不是对其进行补偿。

# programming-languages - 用于开发操作大量字符串工件的算法的选项

> ID：12307545
> 
> 赞同：2
> 
> 时间：2012-09-06T20:03:53.707
> 
> 标签：programming-languages

我目前正在开发处理数十万个字符串（每个约 4000 个字符）的算法，并根据应用于这些字符串的函数的结果执行简单的操作。目前我使用 Java 和一个带有一个表的 Mysql 数据库：

```
 ID | String | attribute a | attribute b | ....
    |        |             |             | .... 
```

基本上，该算法从一个 ID 开始，读取存储的字符串，对其执行功能（为当前活动的列设置和读取属性）。例如，一个函数从字符串中提取一个 ID（简单的字符串解析），将该 ID 存储在“属性 a”列中。解析条目后，算法读取“属性 a”，跳转到具有此 ID 的行，然后重新开始该过程。

也许我有点想多了；但是当前设置的开销太大，几乎不可能进行一些快速更改或快速测试查询。是否有更好的工具或编程语言被设计用于直接操作像这样的大型数据集并为字符串操作提供有效的函数？

我绝对不介意花时间学习一门全新的语言，因为我相信使用正确的工具来完成工作可以节省时间并防止长期的挫败感。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T20:27:52.890

我有一个宠物项目，多年来我一直在进行，断断续续地工作。它存储大量字符串（尽管不是文本）。过去，我在内存中的 Java、带有数据库的 Scala、MySQL、内存中的 C、Python + Redis ……最后是 Go 中实现了它。

Go 做得最好。我有大约 300,000 个字符串（虽然比你的短）存储在内存中的数据结构中。它们形成可搜索、可分析的数据结构。我确信用例与您的用例足够相似，因此我的经验是相关的。

Go 在数据处理方面与 C 具有相似的效率。它具有类似于 Python 的良好语法，可用于快速编码。它具有类型安全性...类型安全性。它有垃圾收集。

我的建议是，学习 Go 并在内存中完成所有操作。依靠虚拟内存来容纳大型数据集。一旦加载，我的 RAM 大约有 500 MB，但我没有任何问题，但它可以正常运行两倍。

我不坚持到磁盘，因为我不需要。我可以在 15 分钟内从输入文件重新创建数据结构。该应用程序是一个持续运行的服务器。如果您正在运行大批量操作来进行适合的分析。否则，我相信您可以轻松地保留到磁盘。

（FWIW 我说的是 www.folktunefinder.com 旋律搜索索引）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T20:20:53.897

看起来您不需要关系数据库。也许尝试像 MongoDB 这样的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T03:26:13.653

我不认为这是一个真正的语言选择问题：您绝对可以在 Java 中进行大数据字符串处理。您可能可以通过以下方式解决大部分问题：

*   使用受控的数据子集创建体面的 JUnit 测试
*   进行一些分析以找到性能热点并对其进行调整
*   内存中行/字符串的智能缓存（而不是一直往返于数据库）

话虽如此，我几乎肯定会选择 Clojure 作为此类任务的语言/环境：

*   在 REPL 进行交互式开发，用于测试查询等。
*   比Java简洁多了
*   惰性函数式编程*非常*适合大数据集（即使是大于内存的数据集）
*   您仍然可以访问所有 J​​ava 库
*   一些非常简洁的数据库工具，例如[Korma](http://sqlkorma.com/)（一种用于 SQL 查询的 DSL）和[Datomic](http://www.datomic.com/)（一种革命性的新型数据库）

# ios - drawRect 绘制的内容是否能够使用 UIView 动画制作动画？

> ID：12307548
> 
> 赞同：4
> 
> 时间：2012-09-06T20:04:08.123
> 
> 标签：ios, cocoa-touch, uiview, uiviewanimation

在 iOS 上，如果有两个圆圈，它们都是`UIView`对象，那么它们的`center`或`frame`可以使用动画制作`UIView`动画。

但困难在于，`UITreeView`包含这两个圆的容器，使用 . 画一条连接圆心的线`drawRect`。在`drawRect`中，我可以使用`CG`or`UIKit`来画线，而我选择使用`UIBezierPath`'s`moveToPoint`和`addLineToPoint`来画线，其实应该只是`CG`下面的调用，但更容易使用。

但是当一个圆圈动画到另一个位置时，线条不会随之动画，所以动画看起来有点奇怪。有没有办法让它动画？

我尝试在 TreeView 类中而不是在`UINodeView`类（圆圈）内设置动画，但这无济于事。事实上，如果我在它的`drawRect`方法中使用随机颜色绘制圆，当圆在动画中缓慢移动时，颜色不会快速变化，表明它`drawRect`没有被调用。它可能只是`CALayer`保存一个正在动画的缓存图像。

那么有没有办法让线条也有动画呢？

我能想到的其他方法是：

1) 使用 hack 也可以使用 a`UIView`来保持线条，因此它的框架可以动画，但是如果圆圈移动以便需要在 UIView 内从 (0, 0) 到 (200, 200) 绘制线条怎么办，但是现在这条线需要向另一个方向倾斜，从 (200, 0) 绘制到 (0, 200)，所以在这种情况下，它可能不起作用。（但如果我同时使用某种变换来翻转图像，它可能会起作用，但考虑何时应该使用变换似乎很复杂）

2）`CADisplayLink`用来做动画，让它调用`[treeView setNeedsDisplay];`，在这种情况下，`drawRect`肯定会调用。（这可能有点矫枉过正，由于 TreeView 的整个背景将首先被擦除，因此屏幕上可能会有一点闪烁）

还是有更简单或更好的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T20:16:04.107

您可以将路径分配给[CAShapeLayer](http://developer.apple.com/library/ios/#documentation/uikit/reference/uiview_class/uiview/uiview.html)（例如将其包装在 UIView 子类中，该子类将 CAShapeLayer 作为其 +layerClass 返回）。路径分配给 CGPath -path 属性（请注意 UIBezierPath 提供 CGPath 属性）。然后，您可以在视图中有一条线，您可以制作动画（例如使用 UIView [+beginAnimations](http://developer.apple.com/library/ios/documentation/uikit/reference/uiview_class/uiview/uiview.html#//apple_ref/occ/clm/UIView/beginAnimations%3acontext%3a)的组动画 。

# android - 在锁屏上切换活动显示锁屏

> ID：12307549
> 
> 赞同：2
> 
> 时间：2012-09-06T20:04:14.523
> 
> 标签：android, android-4.0-ice-cream-sandwich

所以我正在为我的公司制作一个应用程序，用于像“信息亭”一样使用的安卓平板电脑。用户应该只能使用这个应用程序，而不能在平板电脑上做任何其他事情。

我通过在活动上使用 WindowManager.LayoutParams.FLAG_SHOW_WHEN_LOCKED 找到了解决方案。但是，当我在我的应用程序中切换到另一个活动时，离开的活动会淡出，快速显示锁定屏幕，然后出现下一个活动。

我猜这是因为 FLAG_SHOW_WHEN_LOCKED 在 onCreate() 中，而不是在 Activity 创建过程的早期。

有没有其他地方可以放置这个标志，或者任何其他方式来防止锁屏在活动之间显示？这不是一个大问题，但它是一个糟糕的用户体验。

它是运行 ICS 4.0.3 的三星 Galaxy Tab 10.1。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-16T16:06:44.933

我能够通过使用`Fragments`和使用`FragmentManager`来交换活动中的片段来最好地解决这个问题，因此从未显示过锁屏，因为我从未离开过活动。android 开发者指南有一个很好的例子。

[http://developer.android.com/reference/android/app/Fragment.html](http://developer.android.com/reference/android/app/Fragment.html)

# performance - Socket.io 缩放 - 减少消息数量或消息大小

> ID：12307554
> 
> 赞同：1
> 
> 时间：2012-09-06T20:04:27.787
> 
> 标签：performance, node.js, socket.io, scaling

我正在通过 socket.io node.js 服务器发送大量消息，并且我能够发送数组中的多条消息，或者单独发送每条消息。我的问题是，什么可以更好地扩展：更多的消息发送更少的数据，还是更少的消息发送更多的数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T04:32:50.270

一般来说，@freakish 所说的成立：消息越少越好，主要是因为每条消息的开销。

然而，在某些情况下，这可能不是真的。

例如，如果您的服务器有一个处理线程，并且您的客户端正在发送大量数据，例如兆字节，那么其他尝试与服务器通信的客户端将阻塞，直到传输完成。如果您以较小的块发送数据，则其他客户端将在请求之间进行处理。如果您碰巧遇到这种情况，那么您可能需要进行一些测试以找到最佳的最大消息大小。

# c++ - 用模板参数替换常量会更好吗？

> ID：12307561
> 
> 赞同：2
> 
> 时间：2012-09-06T20:04:52.753
> 
> 标签：c++, templates

这样做更好吗：

```
const int MY_CONST = 20; // global constant in the program
class A {
    // uses MY_CONST all over the class implementation and definition
} 
```

或这个？

```
const int MY_CONST = 20; // global constant in the program
template<int my_const>
class A {
    //uses my_const only and never MY_CONST
};

//A<MY_CONST> used later in the program 
```

这些模式中的一种是否比另一种更好？为什么？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T20:43:06.623

除非该全局常量在类之外的其他地方使用，否则我不会使用这些方法中的任何一种，并使常量成为`A`：

```
class A {
public:
    static const int MY_CONST = 20;
};

const int A::MY_CONST; // Possibly need definition also 
```

然后`A::MY_CONST`在您的代码中使用。

我唯一会使用模板的时候是当您出于某种原因需要根据实例更改值时。

```
template <int I>
class A
{
public:
    static const int MY_CONST = I;
};

template <int I>
const int A<I>::MY_CONST; // Definition 
```

然后像这样创建实例：

```
A<1> a1;
A<2> a2; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-06T20:39:27.000

`A<MY_CONST + 1>`如果实例化例如、 或`A<0>`或除 之外的任何其他值有意义，则第二种解决方案是明智的`MY_CONST`。但是，如果`A`严格设计为与一个值一起使用，那么您不会从中获得任何收益。在这方面，第一个解决方案可为您提供所需的一切。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-06T21:43:15.143

我总是会**删除全局变量**。让我们区分2种情况，`MY_CONST`要么

**一个实现细节**，在这种情况下，我宁愿将其设为私有常量

```
class A
{
private:
    static int const MY_CONST = 20;
}; 
```

或**类接口的一部分，**在这种情况下，我更愿意将其设为模板参数并将其作为公共成员提供

```
template<int N>
class A
{
public:
    static int const MY_CONST = N;
}; 
```

这样，用户不仅可以读取，还可以“写入”（在编译时）到`MY_CONST`. 如果用户不想为 指定默认值`N`，您可以提供默认模板参数，或提供简单的 typedef

```
typedef A<20> DefaultA; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-06T21:34:07.013

一种看待它的方法是，您正在引入对`A`（仅对数字，而不是任何具有行为的事物，但仍然是一种依赖关系）的依赖关系，问题是是否通过模板参数注入该依赖关系，或者让类通过命名的 const 对象引入依赖项。

我可以看到该模板对于测试类很有用`A`——您希望编写类以使用任何值，这样您就可以在将来更改该值，确信您不会立即遇到测试失败并且必须修复错误。

因此，您可以编写模板并使用许多不同的值对其进行测试，即使没有“真正的”程序会使用多个模板实例。

显然，还有其他方法可以编写行为取决于整数值的类，并对其进行测试。例如，您可以使用宏并让测试工具多次编译代码，或者您可以创建`MY_CONST`一个外部值并将代码链接到包含不同值的不同目标文件，或者您可以`A`将该值存储为数据成员（甚至静态数据成员）。

哪些对您有用取决于类将如何使用该值，但由于模板参数是一个整数常量表达式，因此它适用于大多数用途`const int`。您不能获取模板参数的地址，这是唯一立即浮现在脑海中的东西。

# c++ - 无法在 Linux 上使用 C++ 保存文本文件

> ID：12307567
> 
> 赞同：0
> 
> 时间：2012-09-06T20:05:17.263
> 
> 标签：c++, linux, file, pointers, save

我想我又遇到了那些指针问题。我创建了一个简单的函数，将 char 数组保存到指定的文件中。**这是我所有的代码**：

```
#include <stdio.h>
#include <string.h>

void Output(const char*, const char*, const char*);
void OutPutSomething();

// main.cpp --------------------------------------------------
int main(int argc, char** argv) {
    char Message[256];
    snprintf(Message, 256, "This message will be saved\n");
    Output("Output.txt", Message, "w");
    return 0;
}

void OutPutSomething() {
    Output("Output.txt", "This text will not be saved (???)\n", "w");
}

void Output(const char *FileName, const char *Text, const char *Mode) {
    FILE *OutputFIle;
    OutputFIle = fopen(FileName, Mode);
    if (OutputFIle != NULL) {
        printf(Text, "\n");
        fputs(Text, OutputFIle);
        fclose(OutputFIle);
    } else {
        printf("Output function failed!");
    }
} 
```

所以，我的问题是这样的：当从主函数调用时，`Output()`函数可以正确工作——文本保存在文件中。然而，当我从中调用该`Output()`函数时，`OutPutSomething()`它并没有将文本正确地保存到文件中（它只保存了一个 '\B0' 文本）。我看到`printf()`控制台中显示的文本，但文本未保存。

可能是什么原因？谢谢！

**更多：** 我使用 Code::Blocks （GCC 编译器），应用程序是控制台应用程序。没有链接库，没有添加其他标题。看到如此简单的事情不起作用，令人沮丧。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T20:15:13.277

您的代码在我的系统上运行良好。我同意其他人的观点，尽管您不应该将函数实现放在头文件中。

# vb.net - 打开excel表从单元格中提取值并将其作为字符串存储在vb.net中

> ID：12307570
> 
> 赞同：1
> 
> 时间：2012-09-06T20:05:30.647
> 
> 标签：vb.net, excel

基本上vb.net中的人我需要打开一个excel文档并读取某个单元格（例如A1）的值，无论是文本还是数字，并将其存储为字符串值以在我的代码中的其他地方使用。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T20:08:41.860

尝试

```
'start Excel app
Dim App1 As Microsoft.Office.Interop.Excel.Application
App1 = CreateObject("Excel.Application")

' load excel document
exApp.Workbooks.Open(fname)
Dim Sheet1 As Microsoft.Office.Interop.Excel.Worksheet
Sheet1 = exApp.Workbooks(1).Worksheets(1)
a = Sheet1.Range("A1").Value.ToString 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T20:15:54.760

您可以在此示例中使用 Excel 互[操作](http://www.dotnetperls.com/excel-vbnet)。或者，您可以使用[Open XML SDK](http://www.microsoft.com/en-us/download/details.aspx?id=5124)，如本例[所示](http://msdn.microsoft.com/en-us/library/office/ff921204.aspx)。对于 XLSX 文件，您还可以开发自定义解决方案，xlsx 只不过是 XML 文件的压缩文件夹，[这](http://www.codeproject.com/Articles/208075/How-to-read-and-write-xlsx-Excel-2007-file-Part-I)可能会有所帮助。

# javascript - 如何使用相同的 AJAX 机制获取 JSON 响应

> ID：12307573
> 
> 赞同：0
> 
> 时间：2012-09-06T20:05:44.063
> 
> 标签：javascript, ajax, json

这是我使用的 Ajax 代码

```
function AJAXInteraction(url, callback) {
    var req = init();
    req.onreadystatechange = processRequest;

    function init() {
        if (window.XMLHttpRequest) {
            return new XMLHttpRequest();
        } else if (window.ActiveXObject) {
            return new ActiveXObject("Microsoft.XMLHTTP");
        }
    }

    function processRequest () {
        // readyState of 4 signifies request is complete
        if (req.readyState == 4) {
            // status of 200 signifies sucessful HTTP call
            if (req.status == 200) {
                if (callback) callback(req.responseXML);
            }
        }
    }

    this.doGet = function() {
    req.open("GET", url, true);
    req.send(null);
        }
    }

function mainCall(){
    var req_url = "requestItems.php?format=json&num=100"
    var ajax = new AJAXInteraction(req_url, firstPageData);
    ajax.doGet();   
}

function firstPageData(resJSON){
} 
```

在页面加载开始时，我调用`mainCall()`. 当我用 XML 格式调用相同的系统时，此功能可以完美运行。但是当我用 JSON 格式调用时，则`firstPageData(resJSON)`变为`resJSON`null。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T20:20:58.227

```
function processRequest () {
        // readyState of 4 signifies request is complete
        if (req.readyState == 4) {
            // status of 200 signifies sucessful HTTP call
            if (req.status == 200) {
                var type = req.getResponseHeader("Content-Type");
                if (type.indexOf("xml") !== -1 && req.responseXML)
                    callback(req.responseXML);
                else if (type=== "application/json")
                    callback(JSON.parse(req.responseText));
                else
                    callback(req.responseText);
                //if (callback) callback(req.responseXML);
            }
        } 
```

这行得通！！，我在*[JavaScript: The Definitive Guide: The Definitive Guide中找到了它](http://books.google.fi/books?id=6TAODdEIxrgC&pg=PA501&lpg=PA501&dq=callback%28req.responseXML%29%20json&source=bl&ots=obbmMTMsZF&sig=ZKn5L6Li_O5LOXO4oV8KbQNn0J4&hl=fi&redir_esc=y#v=onepage&q=callback%28req.responseXML%29%20json&f=false)*

# c# - Microsoft.Web.Administration - ApplicationHost.Config 中带有 httpErrors 的 NullReferenceException

> ID：12307576
> 
> 赞同：2
> 
> 时间：2012-09-06T20:05:57.933
> 
> 标签：c#, iis

我试图弄清楚为什么我会得到`NullReferenceException`以下代码。一切看起来都像是正确嵌套的。我正在使用`Microsoft.Web.Administration`并且正在尝试修改所有错误的 prefixLanguageFilePath。任何帮助，将不胜感激！

```
 public static void ModifyCustomErrDir(string dir)
    {
        try
        {
            ServerManager serverManager = new ServerManager();
            Configuration config = serverManager.GetApplicationHostConfiguration();

            config.GetSection("system.webServer/httpErrors").ChildElements["error"].Attributes["prefixLanguageFilePath"].Value = dir;
        }
        catch (ServerManagerException e)
        {
            Console.WriteLine(e);
        }
    }

    <httpErrors lockAttributes="allowAbsolutePathsWhenDelegated,defaultPath">
        <error statusCode="401" prefixLanguageFilePath="%SystemDrive%\inetpub\custerr" path="401.htm" />
        <error statusCode="403" prefixLanguageFilePath="%SystemDrive%\inetpub\custerr" path="403.htm" />
        <error statusCode="404" prefixLanguageFilePath="%SystemDrive%\inetpub\custerr" path="404.htm" />
        <error statusCode="405" prefixLanguageFilePath="%SystemDrive%\inetpub\custerr" path="405.htm" />
        <error statusCode="406" prefixLanguageFilePath="%SystemDrive%\inetpub\custerr" path="406.htm" />
        <error statusCode="412" prefixLanguageFilePath="%SystemDrive%\inetpub\custerr" path="412.htm" />
        <error statusCode="500" prefixLanguageFilePath="%SystemDrive%\inetpub\custerr" path="500.htm" />
        <error statusCode="501" prefixLanguageFilePath="%SystemDrive%\inetpub\custerr" path="501.htm" />
        <error statusCode="502" prefixLanguageFilePath="%SystemDrive%\inetpub\custerr" path="502.htm" />
    </httpErrors> 
```

* * *

编辑：

我通过循环遍历集合而不表示错误标记并仅查找属性来使其工作。我将不得不回到它，看看这样做是否会有任何意想不到的不利“特征”。

```
var httpErrorsCollection = config.GetSection("system.webServer/httpErrors")
       .GetCollection(); 

foreach (var error in httpErrorsCollection) 
    error.Attributes["prefixLanguageFilePath"].Value = dir; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T20:09:43.643

```
//config.GetSection("system.webServer/httpErrors").ChildElements["error"].
//        Attributes["prefixLanguageFilePath"].Value = dir;

var errorSection = config.GetSection("system.webServer/httpErrors");
// check errorSection    
var errors = errorSection.ChildElements["error"];
// check errors
errors.Attributes["prefixLanguageFilePath"].Value = dir; 
```

ETC

# xtk - 在 XTK 2D 视图中显示十字准线

> ID：12307582
> 
> 赞同：0
> 
> 时间：2012-09-06T20:06:08.837
> 
> 标签：xtk

有没有办法在 2D 切片中显示在 3D 体积视图中可见的彩色 x、y、z 十字准线（如第 13 课中所示）？

谢谢！

诺兰

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T20:40:37.913

十字准线只是切片周围的边界。你有什么想法以 2D 显示它们？

# rest - 替代获取查询类型调用的 REST 路由

> ID：12307586
> 
> 赞同：1
> 
> 时间：2012-09-06T20:06:36.093
> 
> 标签：rest, asp.net-web-api

我正在使用 .NET Web API，需要一种策略来创建查询的路由。例如，从页面上说代码处于决策点，需要服务器上的业务逻辑指导如何继续。

只是为了审查，这条路线将返回一个标准用户......

```
http://mysite/api/user/5 
```

但是，如果我想知道用户是否具有由业务逻辑确定的某些特征，我会根据这些特征做出 UI 决定，那么对于这样的事情，一个好的 REST 调用会是什么？

也许...

```
http://mysite/api/user/5?canbake=true 
```

还是这样更好...

```
http://mysite/api/user/5/canbake 
```

如果是后者，那么路由定义是怎样实现的呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T20:26:39.937

我相信普遍的共识是后者更好。
也就是说，路由定义看起来像：

```
public static void RegisterApiRoutes(HttpConfiguration config)
{
    config.Routes.MapHttpRoute(
        name:"UserApi",
        routeTemplate: "api/{controller}/{id}/{bake}",
        defaults: new 
            {
                bake = RouteParameter.Optional
            });
} 
```

# android - Android - 如何将图像放置在 2 列列表的其中一列中并将图像垂直居中？

> ID：12307593
> 
> 赞同：2
> 
> 时间：2012-09-06T20:07:18.443
> 
> 标签：android, android-layout

我有一个 2 列的行布局，如下所示：

```
<?xml version="1.0" encoding="utf-8"?>

<LinearLayout
     xmlns:android="http://schemas.android.com/apk/res/android"
     android:paddingTop="4dip"
     android:paddingBottom="6dip"
     android:layout_width="fill_parent"
     android:layout_height="wrap_content"
     android:orientation="horizontal"
     android:textSize="13sp">

     <TextView android:id="@+id/TRAIN_CELL"
         android:layout_width="275dip"
         android:layout_height="wrap_content"/>

  <ImageView android:id="@+id/TO_CELL"
         android:layout_width="25dip"
         android:layout_height="wrap_content"  
         android:layout_weight="1"
         android:gravity="center"
         android:src="@drawable/arrow_button"/>

</LinearLayout> 
```

一旦我从数据库中获取项目，我将它们显示在左列中，在右列中我想要一个带有箭头的小图像，表示它是一个可点击的项目。但我不确定如何使图像渲染。这是我目前填充该列表的方式：

我有这两个变量：

```
private List<HashMap<String, String>> fillMaps;
private SimpleAdapter adapter; 
```

起初我是这样设置它们的：

```
list = (ListView) findViewById(android.R.id.list);

ArrayList<HashMap<String, String>> mylist = new ArrayList<HashMap<String, String>>();
//HashMap<String, String> map = new HashMap<String, String>();

// My data
fillMaps = new ArrayList<HashMap<String, String>>();

adapter = new SimpleAdapter(this, fillMaps, R.layout.questions_list,
        new String[] {"train", "to"}, 
        new int[] {R.id.TRAIN_CELL,  R.id.TO_CELL});
// This was the middle item R.id.FROM_CELL,

list.setAdapter(adapter);       
list.setTextFilterEnabled(true); 
```

当数据从服务器返回时，我会像这样填充列表：

```
if ( obj != null )
                        {
                            questions.clear();

                            for ( int i = 0; i < obj.length(); i++ )
                            {
                                HashMap<String, String> map = new HashMap<String, String>();
                                JSONObject o = obj.getJSONObject(i);

                                question_id = o.getString("question_id");
                                question = o.getString("question");
                                question_by_member_id = o.getString("member_id");

                                Question q = new Question ( );
                                q.setQuestion( question );                      
                                q.setQuestionId( question_id );
                                q.setQuestionByMemberId(question_by_member_id);

                                map.put("train", question);

                                //map.put("from", ">");
                                //map.put("to", ">");

                                fillMaps.add(map);
                                questions.add( q );                             
                            }

                            adapter.notifyDataSetChanged();
                        } 
```

但我没有得到要渲染的图像。我认为部分问题是我使用字符串作为列表期望的数据，但我不确定如何处理图像。顺便说一句，图像始终是相同的图像。

谢谢！！:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T20:14:32.917

这是你想要的吗？

```
<LinearLayout
     xmlns:android="http://schemas.android.com/apk/res/android"
     android:paddingTop="4dip"
     android:paddingBottom="6dip"
     android:layout_width="fill_parent"
     android:layout_height="wrap_content"
     android:orientation="horizontal"
     android:textSize="13sp">

     <TextView android:id="@+id/TRAIN_CELL"
         android:layout_width="275dip"
         android:layout_height="wrap_content"/>

     <ImageView android:id="@+id/TO_CELL"
         android:layout_width="25dip"
         android:layout_height="wrap_content"  
         android:layout_weight="1"
         android:gravity="center"
         android:src="@drawable/arrow_button"/>

</LinearLayout> 
```

* * *

**加法**
（抱歉，有时我会在通知堆积一夜时错过通知。我相信您应该能够在 Stack Overflow 上一次一个或全部阅读消息/删除通知，就像收件箱一样......）

无论如何，如果`TO_CELL`' 的图像总是相同的，只需在 XML 中设置图像。将您的 SimpleAdapter 更改为：

```
adapter = new SimpleAdapter(this, fillMaps, R.layout.questions_list,
        new String[] {"train"}, 
        new int[] {R.id.TRAIN_CELL}); 
```

现在您的适配器只处理一个字符串，您可以将其简化为 ArrayAdapter（如果需要。）

* * *

**简化示例**
您还可以显示一个 TextView 并显示一个小的“下一步”箭头，如下所示：

```
<TextView xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/text"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:drawableRight="@android:drawable/ic_media_play"
    android:padding="10sp"
    android:textAppearance="?android:attr/textAppearanceMedium" /> 
```

（LinearLayout 和单独的 ImageView 并不是绝对必要的。我将其保存为`list_item.xml`。）这是一个简单的预览，请理解我留下了很多非关键行，以免重复：

```
public class Example extends Activity {
    ArrayAdapter<String> adapter;
    List<String> list = new ArrayList<String>();
    ListView listView;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        adapter = new ArrayAdapter<String>(this, R.layout.list_item, R.id.text, list);
        listView = (ListView) findViewById(R.id.list);
        listView.setAdapter(adapter);

        updateList();
    }

    public void updateList() {
        ...
        if ( obj != null ) {
            questions.clear();
            list.clear();

            for ( int i = 0; i < obj.length(); i++ ) {
                JSONObject o = obj.getJSONObject(i);
                ...
                question = o.getString("question");
                list.add(question);
            }

            adapter.notifyDataSetChanged();
        }
    }
} 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T02:20:30.563

我相信最简单的方法是尝试扩展 ArrayAdapter 以满足您的需要，而不是使用 SimpleAdapter。您可以覆盖 getView() 方法并以您需要的方式填充您的列表！

[这里](http://developerlife.com/tutorials/?p=327)有几个例子，[这里](http://w2davids.wordpress.com/android-listview-with-iconsimages-and-sharks-with-lasers/)和[这里](http://www.coderzheaven.com/2011/03/25/android-image-listview/)。

**编辑**

首先，您需要在 xml 中进行一些修改

```
<LinearLayout
 xmlns:android="http://schemas.android.com/apk/res/android"
 android:paddingTop="4dip"
 android:paddingBottom="6dip"
 android:layout_width="fill_parent"
 android:layout_height="wrap_content"
 android:orientation="horizontal"
 android:textSize="13sp">

     <TextView android:id="@+id/TRAIN_CELL"
     android:layout_width="275dip"
     android:layout_height="wrap_content"/>

 <ImageView android:id="@+id/TO_CELL"
     android:layout_width="wrap_content"
     android:layout_height="wrap_content"
     android:gravity="center"              
     android:background="#fff"/>
</LinearLayout> 
```

在下面的代码中，为了简单起见，我使用了字符串的 ArrayList。您必须将其替换为您用来填充列表的任何对象的列表。（也许是问题？）

创建一个 ExtendedAdapter 并覆盖 getView() 方法来做你想做的事。这将在列表的每一行上创建一个 TextView 和一个 ImageView，使用 ArrayList 项目中的项目填充 TextView 并在项目可点击时显示图像。（您必须自己进行验证，但应该不难弄清楚）

```
public class ExtendedAdapter extends BaseAdapter {

public static final String TAG = "TodoAdapter";

private Context mContext;
private int layoutResource;
private boolean clickable = false;
private List<String> items; // you can replace this list with whathever you need
                            // for simplicity i'm assuming you already have the strings 
                            // you need for the textviews

public ExtendedAdapter(Context context, int textViewResourceId,
        List<String> items) {
    this.items = items;
    this.mContext = context;
    this.layoutResource = textViewResourceId;
}

public int getCount() {
    return items.size();
}

public Object getItem(int position) {
    return position;
}

public long getItemId(int position) {
    return position;
}

@Override
public View getView(int position, View convertView, ViewGroup parent) {
    View v = convertView;
    if (v == null) {
        LayoutInflater vi = (LayoutInflater) mContext
                .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        v = vi.inflate(layoutResource, null);
    }

    ImageView arrow = (ImageView) v.findViewById(R.id.TO_CELL);
    TextView text = (TextView) v.findViewById(R.id.TRAIN_CELL);
    text.setText(items.get(position));
    if (clickable)  // here you have to do your check if it's clickable or not
        arrow.setBackgroundResource(R.drawable.ic_launcher);
    return v;
}
} 
```

在您的活动中，只需设置列表适配器

```
public class MainActivity extends Activity {

ListView yourList;
ArrayList<String> itemList = new ArrayList<String>();
ExtendedAdapter adapter;
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    yourList = (ListView) findViewById(R.id.yourList);

    adapter = new ExtendedAdapter(this, R.layout.row_layout, itemList);
    yourList.setAdapter(adapter);
    updateItems();
}

public void updateItems(){
    //dummy method, you should fetch your data and populate your array in a separate thread 
    //or something
    itemList.add("Text 1");
    itemList.add("Text 2");
    itemList.add("Text 3");
    itemList.add("Text 4");
    itemList.add("Text 5");
    itemList.add("Text 6");     
    adapter.notifyDataSetChanged();
}     

} 
```

这就是您创建包含文本和图像的列表的方式。

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T06:15:01.257

我认为您应该自定义列表适配器，这样会很容易。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-18T06:03:08.020

问题在于 Layout 和 Simple adpater。

1.不要使用linearLayout`android:textSize="13sp"`将它用于TextView，

你可以使用下面的代码

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal"
    android:paddingBottom="6dip"
    android:paddingTop="4dip" >

    <TextView
        android:id="@+id/TRAIN_CELL"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_weight=".25"
        android:text="try out by yourself..."
        android:textSize="13sp" />

    <ImageView
        android:id="@+id/TO_CELL"
        android:layout_width="0dp"
        android:layout_height="wrap_content"
        android:layout_weight=".05"
        android:gravity="center"
        android:src="@android:drawable/arrow_down_float" />

</LinearLayout> 
```

2.问题出在SimpleAdapter使用中

adapter = new SimpleAdapter(this, fillMaps, R.layout.questions_list, new String[] {"train"}, new int[] {R.id.TRAIN_CELL});

# javascript - CSS/Javascript 灯箱

> ID：12307594
> 
> 赞同：1
> 
> 时间：2012-09-06T20:07:19.693
> 
> 标签：javascript, css, lightbox

首先，我将从以下内容开始：我绝不会塑造或形成开发人员、编码员等。我只是一名平面设计师，帮助朋友建立她的网站。

截至目前，我在将缩略图链接到我的灯箱调用上的完整图像时遇到问题 - 您可以在[www.chrissybulakites.com上查看该网站](http://www.chrissybulakites.com)

我注意到

在`VOID:(0)`每一个中……我的想法是，如果我将 0 拇指与 0 满，然后将 1 拇指与 1 满，然后将 2 拇指与 2 满，等等，它会起作用.. 它没有。

有人可以向我解释我是否走在正确的道路上，或者我可以做些什么来完成这项工作。

谢谢

抢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T20:13:31.390

每个图像有两个基本元素；拇指和完整的图像。拇指使用 JavaScript 来显示和隐藏一个 div（有点像一个框架）来保存完整的图像。

页面上的 HTML 会重复很多次，您可以在消除一些重复的同时解决您的问题。我会保留你所有的拇指，但在每个拇指上，添加对拇指所代表的完整图像的引用。除了减少重复之外，它还可以使将来更容易更新页面，因为更改拇指和主图像是在一个地方而不是两个地方完成的。

在下面，我在“onclick”中添加了另一部分，以将“frame”的 src 更新为拇指的完整版本。

```
<a href = "javascript:void(0)" onclick="document.getElementById('light').style.display='block';document.getElementById('fade').style.display='block';document.getElementById('frame').src='http://chrissybulakites.com/images/longshot_full.png';"><img src="http://chrissybulakites.com/thumbnails/longshot_thumbnail.png" /></a> 
```

然后删除除一个之外的所有大图像，更新它以使 img 标签的 ID 为“frame”

```
<div id="light" class="white_content"><img id='frame' src="http://chrissybulakites.com/images/longshot_full.png" /> <br />Actor Observor - Boston, MA <a href = "javascript:void(0)" onclick = "document.getElementById('light').style.display='none';document.getElementById('fade').style.display='none'">Close</a></div>
    <div id="fade" class="black_overlay"></div> 
```

这意味着当每个拇指被点击时，它会做之前做的光和时尚位，但它也会更新正在显示的图像。

* * *

对两个图像执行此操作作为概念证明，我得到了按预期工作的结果：

```
<a href = "javascript:void(0)" onclick="document.getElementById('light').style.display='block';document.getElementById('fade').style.display='block';document.getElementById('frame').src='http://chrissybulakites.com/images/longshot_full.png';"><img src="http://chrissybulakites.com/thumbnails/longshot_thumbnail.png" /></a>

<a href = "javascript:void(0)" onclick ="document.getElementById('light').style.display='block';document.getElementById('fade').style.display='block';document.getElementById('frame').src='http://chrissybulakites.com/images/actor_full.png';"><img src="http://chrissybulakites.com/thumbnails/actor_thumbnail.png" /></a>

<div id="light" class="white_content"><img id='frame' src="http://chrissybulakites.com/images/longshot_full.png" /> <br />Actor Observor - Boston, MA <a href = "javascript:void(0)" onclick = "document.getElementById('light').style.display='none';document.getElementById('fade').style.display='none'">Close</a></div>
    <div id="fade" class="black_overlay"></div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T20:12:44.743

您需要为每个完整图像 div 赋予其自己的唯一 ID，例如：`id="image23"`。然后修改onclick来引用对应的id：`onclick="document.getElementById('image23')...`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-06T20:11:47.693

JavaScript中函数的含义`void()`是“什么都不做”。这可以防止它加载新页面（或打开缩略图）。

```
onclick = "document.getElementById('light').style.display='block';  
           document.getElementById('fade').style.display='block' " 
```

表示当用户单击该项目时，它将捕获元素`light`并将显示更改为`block`它还将捕获元素`fade`并将显示更改为`block`。问题是您的所有图像都包含在一个名为“light”的元素中，因此浏览器选择显示第一个（而不是抛出错误）。

这里有很多*模糊*的逻辑。
从您正在加载所有图像（高清图像）的事实开始。

如果你想要我的两分钱（你只想得到结果，而不是学习 JavaScript 的工作原理），我会选择类似[**prettyPhoto**](http://www.no-margin-for-errors.com/projects/prettyphoto-jquery-lightbox-clone/)的东西，它开箱即用，以简单直接的方式完成，并且有据可查。

**如何将漂亮照片添加到您的页面？**
下载代码并在标题中包含 Javascript 和 CSS 文件。

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js"></script>
<link rel="stylesheet" href="css/prettyPhoto.css" type="text/css" media="screen" charset="utf-8" />
<script src="js/jquery.prettyPhoto.js" type="text/javascript" charset="utf-8"></script> 
```

然后将此代码放在您的页面上

```
<script type="text/javascript" charset="utf-8">
  $(document).ready(function(){
    $("a[rel^='prettyPhoto']").prettyPhoto();
  });
</script> 
```

文档说要把它放在页面底部，但你（应该）也把它放在页眉上。

然后将缩略图与实际图像的链接放在一起。PrettyPhoto 会处理其他所有事情。请注意`rel="prettyPhoto[my_gal]"`

```
<a href="img/full/1.jpg" rel="prettyPhoto[my_gal]" title="Caption 1">
    <img src="images/thumbnails/t_1.jpg" width="60" height="60" alt="Red round shape" />
</a> 
```

[您可以进一步自定义它，并且应该真正阅读此处的手册。](http://www.no-margin-for-errors.com/projects/prettyphoto-jquery-lightbox-clone/documentation/)

# iphone - 从 CSV 文件中读取第一列数据并将其与用户输入进行比较？

> ID：12307597
> 
> 赞同：0
> 
> 时间：2012-09-06T20:07:26.233
> 
> 标签：iphone, ios5

我正在开发一个应用程序，用户可以将 csv 文件上传到应用程序的文档文件夹（我完成了）。但我想在应用程序中为用户提供一个文本字段并要求他们输入一个 ID 号，这个数字将与上传的 csv 文件的第一列一起检查。如果它匹配，则显示一个警报，说明它找到了匹配，否则它没有。

我使用以下代码，但它只检查第一行第一列而不检查其他...我在按钮单击时调用该函数...

```
NSString * pstrCSVFilePath= [[NSBundle mainBundle] pathForResource:@"CSVFile" ofType:@""] 
NSString * pstrCSVFile= [NSString stringWithContentsOfFile:pstrCSVFilePath encoding:NSASCIIStringEncoding error:NULL]; 
NSArray * paRowsOfCSVFile= [pstrCSVFile componentsSeparatedByString:@"\n"]; 
NSArray * paColumnsOfRow; 
NSString * pstrFirstColumn; 
for(NSString * pstrRow in paRowsOfCSVFile) 
{ 
paColumnsOfRow= [pstrRow componentsSeparatedByString:@","]; 
pstrFirstColumn= [paColumnsOfRow objectAtIndex:0]; 
if([pstrFirstColumn localizedCaseInsensitiveCompare:myTextField.text] == NSOrderedSame)
{ 
     //Found the search string in the CSV file.  
break; 
} 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T01:21:25.810

您是否检查过您已成功将输入拆分为多少行？我猜你的输入文件没有用 \n 换行，但可能是 \r ...

如果这是问题所在，那么您会将文件解释为只有一行。查看有关如何正确拆分行的相关答案：[如何从 NSString 获取每一行？](https://stackoverflow.com/questions/342577/how-do-i-get-each-line-from-an-nsstring). 根据您所针对的 iOS 版本，您可以使用问题本身中调用的方法。

# php - 安装网站蛋糕

> ID：12307601
> 
> 赞同：1
> 
> 时间：2012-09-06T20:07:38.803
> 
> 标签：php, config

我正在尝试在我的网站上使用 sitecake www.sitecake.com。我使用此处的说明安装了它[http://sitecake.com/install.html](http://sitecake.com/install.html)并在关于页面上对其进行了测试。

PHP 行为不端，不幸的是我不知道问题出在哪里。几天来，我已经搜索了不同的 PHP 错误，并为部分问题提出了一种解决方案，但我仍然无法使其正常工作。

在我安装了 sitecake 并将该行添加到 about 页面的顶部后，当我尝试访问该页面时出现此错误：

PHP 错误信息

PHP代码：

> 警告：realpath() [function.realpath]：open_basedir 限制生效。文件（/usr/local/apache/htdocs）不在允许的路径中：/home/a5940384/public_html/sitecake/server/config 中的 (/home/:/usr/lib/php:/tmp)。第 12 行的 php

PHP 错误信息

PHP代码：

> 警告：substr_compare() [function.substr-compare]：第 14 行 /home/a5940384/public_html/sitecake/server/config.php 中的长度必须大于零

发生错误应用程序错误异常信息：

PHP代码：

```
Message: file_exists() [function.file-exists]: open_basedir
restriction in effect. File(/usr/local/apache/htdocs//about.php) is
not within the allowed path(s): (/home/:/usr/lib/php:/tmp)  Stack trace: 
#0 /home/a3779563/public_html/sitecake/server/application/services/impl/basic/PageTemplateImpl.php(30): Bootstrap::globalErrorHandler(2, 'file_exists() [...', '/home/a3779563/...', 30, Array)
#1 /home/a3779563/public_html/sitecake/server/application/services/impl/basic/RenderServiceImpl.php(54): PageTemplateImpl->setPageRequest('/usr/local/apac...')
#2 /home/a3779563/public_html/sitecake/server/application/services/impl/basic/RenderServiceImpl.php(23): RenderServiceImpl->renderResponse('/index.php')
#3 /home/a3779563/public_html/sitecake/server/application/controllers/RenderController.php(13): RenderServiceImpl->render()
#4 /home/a3779563/public_html/sitecake/server/library/Zend/Controller/Action.php(513): RenderController->renderAction('/index.php', false)
#5 /home/a3779563/public_html/sitecake/server/library/Zend/Controller/Dispatcher/Standard.php(295): Zend_Controller_Action->dispatch()
#6 /home/a3779563/public_html/sitecake/server/library/Zend/Controller/Front.php(954): Zend_Controller_Dispatcher_Standard->dispatch('renderAction')
#7 /home/a3779563/public_html/sitecake/server/library/Zend/Application/Bootstrap/Bootstrap.php(97): Zend_Controller_Front->dispatch(Object(Zend_Controller_Request_Http), Object(Zend_Controller_Response_Http))
#8 /home/a3779563/public_html/sitecake/server/library/Zend/Application.php(366): Zend_Application_Bootstrap_Bootstrap->run()
#9 /home/a3779563/public_html/sitecake/server/sitecake_entry.php(47): Zend_Application->run()
#10 /home/a3779563/public_html/index.php(1): include('/home/a3779563/...')
#11 {main} 
```

请求参数：

> 数组（“控制器”=>“渲染”，“动作”=>“渲染”，）

我能够通过替换来修复这些错误

PHP代码：

```
$doc_root= $_SERVER['DOCUMENT_ROOT']; 
```

在第 12 和 23 行

和

PHP代码：

```
$doc_root = dirname(_FILE_); 
```

在 sitecake/server/config.php 中（在搜索 open_basedir 限制时在论坛上找到了该修复）

这是更改后有问题的整个 config.php 脚本： PHP 代码：

```
 <?php  
define( 'CONTENT_DIR', dirname(dirname(SITECAKE_SERVER_BASE_DIR)).DS.'sitecake-content'); 
define( 'APP_TMP_DIR', CONTENT_DIR.DS.'temp' ); 

define('LICENSE_PATH', dirname(SITECAKE_SERVER_BASE_DIR).DS.'license.key'); 
define( 'CREDENTIAL_FILE', SITECAKE_SERVER_BASE_DIR.DS.'credential.php' ); 
define( 'SITECAKE_EDITOR_CONFIG_FILE', dirname(SITECAKE_SERVER_BASE_DIR).DS.'editor.cfg' ); 

# define( 'SITECAKE_BASE_RELATIVE_URL', '/' ); 
if ( !defined('SITECAKE_BASE_RELATIVE_URL') ) 
{ 
    $doc_root = dirname(_FILE_);  
    $entryDir = realpath(dirname(dirname(SITECAKE_SERVER_BASE_DIR))); 
    if ( substr_compare($entryDir, $docRootDir, 0, strlen($docRootDir)) != 0 ) die('Unable to determine SITECAKE_BASE_RELATIVE_URL'); 
    define( 'SITECAKE_BASE_RELATIVE_URL', str_replace('\\', '/', substr($entryDir, strlen($docRootDir)))); 
} 

define( 'SERVICE_URL', SITECAKE_BASE_RELATIVE_URL.'/sitecake/server/sitecake_entry.php' ); 
define( 'SITECAKE_PUBLIC_MANAGER_URL', SITECAKE_BASE_RELATIVE_URL.'/sitecake/client/publicmanager/publicmanager.nocache.js' ); 
define( 'SITECAKE_CONTENT_MANAGER_URL', SITECAKE_BASE_RELATIVE_URL.'/sitecake/client/contentmanager/contentmanager.nocache.js' ); 
define( 'CONTENT_BASE_URL', SITECAKE_BASE_RELATIVE_URL.'/sitecake-content'); 

define( '$doc_root = dirname(_FILE_);'] ); 

define( 'PHP_TEMPLATE', false ); 
define( 'TEMPLATE_CACHING', true ); 

$applicationIncludes = array( 
    realpath(APPLICATION_PATH), 
    realpath(APPLICATION_PATH.DS.'controllers'), 
    realpath(APPLICATION_LIBRARY_PATH), 
    realpath(APPLICATION_PATH.DS.'services'.DS.'impl'.DS.'onesite'), 
    realpath(APPLICATION_PATH.DS.'services'.DS.'impl'.DS.'basic'), 
    realpath(APPLICATION_PATH.DS.'services'), 
    get_include_path(), 
); 

?> 
```

并且能够访问该站点，但是当我尝试登录到 sitecake 时，我在登录框中收到此错误：

```
Parse error: syntax error, unexpected ']' in /home/a3779563/public_html/sitecake/server/config.php on line 23 
```

我找不到任何有用的 PHP 错误，所以现在我很茫然。

关于如何使用 000webhost 网站蛋糕的任何想法？

如果你能做到这一点，感谢阅读！

该站点的 URL：http: [//nave.net23.net/](http://nave.net23.net/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T20:13:38.243

如果可以的话，我会为初学者关闭[base_dir 。](http://www.php.net/manual/en/ini.core.php#ini.open-basedir)注意，禁用 safe_mode 不会阻止 base_dir 的东西。

至于您现在遇到的错误，它只是告诉您存在语法错误。现在我没有在您发布的内容中看到它。也许您在本地修复它但尚未在服务器上修复它？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T20:18:01.930

`/home/a5940384/public_html`您在该服务器上设置了 PHP 安全模式（从您的目录结构来看，它可能是某个共享主机服务器，

无论出于何种原因，该应用程序想要在`/usr/local/apache/htdocs`. 因此，您可能需要查看所有代码以找出为什么它认为这是您的基本目录。也许找出`SITECAKE_SERVER_BASE_DIR`定义的位置，因为这似乎是用于计算文件路径的主要常量。

共享主机是魔鬼的事。

# c# - 了解 IlMerge - 如何将可执行文件与所有相关的 dll 打包在一起

> ID：12307602
> 
> 赞同：1
> 
> 时间：2012-09-06T20:07:37.923
> 
> 标签：c#, .net, winforms, dll, ilmerge

我知道我不是第一个在 Stack Overflow 上提出这个问题的人，而且我相信我不会是最后一个。但是，在花了几个小时研究如何做到这一点，然后在身体上尝试做到这一点之后，我几乎准备放弃了。

我有一个构建为可执行文件的 .NET Framework 4、C#、WinForms 应用程序。我依赖很多很多 dll。dll 分为多个类别。

*   我编写的库没有自己的依赖项
*   我编写的库依赖于我编写的其他库
*   我编写的依赖第三方 dll 的库
*   第三方独立 dll
*   第三方 dll 具有自己对其他 dll 的依赖关系

所以在我编译我的应用程序后，我有一个包含可执行文件和大约 15 个 dll 的目录。

我想将所有 dll 打包到一个可执行文件中，以便我可以简单地分发一个可执行文件。

我知道 IlMerge 是通常建议使用的应用程序，但我很好奇是否有更容易使用、更直观且适用于 WinForms 和 WPF 的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T20:29:38.600

这里的问题是ILMerge 只能合并.Net 程序集。您的文件 lame_enc.dll 不是 .Net 程序集，而是标准 Windows dll，因此 ILMerge 无法加载。

为了解决这个问题，您可以将 lame_enc.dll 嵌入到您的程序集中，然后在应用程序需要时将其提取出来。查看这篇文章以获取更多信息。

[http://weblogs.asp.net/ralfw/archive/2007/02/04/single-assembly-deployment-of-managed-and-unmanaged-code.aspx](http://weblogs.asp.net/ralfw/archive/2007/02/04/single-assembly-deployment-of-managed-and-unmanaged-code.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T17:41:19.567

最后，我走向了完全不同的方向。

我决定使用[位于此处的 Costura Visual Studio Extensions](http://visualstudiogallery.msdn.microsoft.com/70c0e54d-07de-4ff3-a62f-aac9c31e8c39)。

这些扩展使用两种方法的组合

*   Jeffrey Richter 关于使用[嵌入式资源作为合并程序集的方法的建议](http://blogs.msdn.com/b/microsoft_press/archive/2010/02/03/jeffrey-richter-excerpt-2-from-clr-via-c-third-edition.aspx)
*   Einar Egilsson 建议[使用 cecil 创建模块初始化程序](http://einaregilsson.com/module-initializers-in-csharp/)

这里的好处是您只需将扩展安装到 Visual Studio 中。完成此操作后，对于要将 DLL 打包到单个可执行文件中的任何项目，只需选择该项目，单击菜单栏上的项目、Costura、配置，然后单击确定。它会要求您重新加载项目 - 单击是。现在，每当您构建项目时，它只会创建一个可执行文件（或 DLL，如果您在库上执行它）。再简单不过了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-06T20:25:14.380

ILMerge 仅组合纯（非混合模式）CLR 程序集。它的工作原理是提取所有 CIL 模块，然后将它们重新链接到一个新的程序集中。装配资源也被重新组合。

ILMerge 无法合并本机可执行代码。lame_enc.dll 是一个原生 DLL 文件，不包含任何 CIL 模块，这就是你不能组合它的原因。

如果您想将您的应用程序打包到一个可执行文件中，一种解决方法是将 lame_enc.dll 作为程序集资源包含在内，然后将 lame_enc.dll 保存到磁盘中的临时文件夹中，然后将保存的文件夹添加到应用程序的 PATH 中，因此您的 [DllImport] 运行时链接器将能够访问它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-06T20:27:40.760

要解决您的确切问题，请验证该文件是否`C:\Release\lame_enc.dll`存在并且它实际上是一个 .NET 文件。ILMerge 只能合并 .NET 程序集。

现在，如果您只担心应用程序的分发，您可以考虑创建一个安装程序来安装所有二进制文件，而不必担心使用 ILMerge 合并它们。

使用 ILMerge 的另一种替代方法是将二进制文件嵌入到程序集中，[如此处](http://blogs.msdn.com/b/microsoft_press/archive/2010/02/03/jeffrey-richter-excerpt-2-from-clr-via-c-third-edition.aspx)所述。

# java - Java 小程序将信息发送到 php 页面

> ID：12307611
> 
> 赞同：3
> 
> 时间：2012-09-06T20:08:15.963
> 
> 标签：java, php, mysql, applet

我想知道是否可以通过单击按钮（在 Java 小程序内）将信息从 Java 小程序发送到 PHP 页面（从长远来看，是一个 mysql 数据库）。
当然，如果只合并 jar 文件而不是小程序更容易，那也是一种可能性，但我只是不知道该怎么做......有什么
想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T20:09:46.877

是的，你可以这么做。不过，您需要授予 Applet 访问网络的权限。[这是一个例子](http://www.innovation.ch/java/HTTPClient/HTTPClientExample.html)。

# c++ - 通过引用传递向量的 typdef 向量

> ID：12307616
> 
> 赞同：1
> 
> 时间：2012-09-06T20:08:34.373
> 
> 标签：c++, vector, pass-by-reference, typedef

我正在尝试通过引用传递向量的向量。我已经输入了数据类型，在我看来，我得到的是一个副本，而不是参考。我在这里找不到任何有效的语法来做我想做的事。建议？

```
#include <iostream>
#include <fstream>
#include <vector>
#include <string>
#include <cmath>

#define __DEBUG__

using namespace std;

//Define custom types and constants
typedef std::vector< std::vector<float> > points;
//Steup NAN
float NaN = 0.0/0.0;  //Should be compiler independent

//Function prototypes
void vectorFunction(float t0, float tf,  points data );

//Global constants
string outFilename = "plotData.dat";
int sampleIntervals = 10000; //Number of times to sample function.

int main()
{
    ofstream plotFile;
    plotFile.open(outFilename.c_str());

    points data;

    vectorFunction( 0, 1000, data );

#ifdef __DEBUG__
    //Debug printouts
    cout << data.size() << endl;
#endif

    plotFile.close();
    return 0;
}

void vectorFunction(float t0, float tf, points data )
{
    std::vector< float > point(4);
    float timeStep = (tf - t0)/float(sampleIntervals);
    int counter = floor(tf*timeStep);

    //Resize the points array once.

    for( int i = 0; i < counter; i++)
    {
        point[0] = timeStep*counter;
        point[1] = pow(point[0],2);
        point[2] = sin(point[0]);
        point[3] = -pow(point[0],2);
        data.push_back(point);
    }

#ifdef __DEBUG__
    //Debug printouts
    std::cout << "counter: " << counter
              << ", timeStep: " << timeStep
              << ", t0: " << t0
              << ", tf: " << tf << endl;
    std::cout << data.size() << std::endl; 
#endif

}

void tangentVectorFunction(float t0, float tf, points data)
{

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T20:13:53.930

假设您的 typedef 仍然存在：

```
typedef std::vector< std::vector<float> > points; 
```

通过引用传递的原型如下所示：

```
void vectorFunction(float t0, float tf, points& data);
void tangentVectorFunction(float t0, float tf, points& data); 
```

您的`points`类型只是一个值类型，相当于`std::vector< std::vector<float> >`. 对这样一个变量的赋值会产生一个副本。将其声明为引用类型`points&`（或`std::vector< std::vector<float> >&`）使用对原始的引用。

它当然不会影响您的问题范围，但您可以考虑简单地使用一维向量。通过这种方式，您可以节省一点内存分配、释放和查找。你会使用：

```
point_grid[width * MAX_HEIGHT + height] // instead of point_grid[width][height] 
```

# latex - Matplotlib，py2exe 应用程序中的 mathtext findfont 问题

> ID：12307619
> 
> 赞同：1
> 
> 时间：2012-09-06T20:08:48.070
> 
> 标签：latex, matplotlib, wxpython, py2exe

我创建了一个使用 Matplotlib/mathtext 字体的 wxapp，并使用 py2exe 将其转换为 exe。生成的 exe 在我的电脑上运行良好。但是，当我将它带到其他地方时，它会在 app.exe.log 中崩溃并显示以下内容：

```
~\dist\library.zip\matplotlib\font_manager.py:1216: UserWarning: findfont: Font family ['STIXGeneral'] not found. Falling back to Bitstream Vera Sans
~\dist\library.zip\matplotlib\font_manager.py:1226: UserWarning: findfont: Could not match :family=Bitstream Vera Sans:style=normal:variant=normal:weight=normal:stretch=normal:size=12\. Returning c:\windows\fonts\browai.ttf
~\dist\library.zip\matplotlib\font_manager.py:1216: UserWarning: findfont: Font family ['STIXSizeOneSym'] not found. Falling back to Bitstream Vera Sans
~\dist\library.zip\matplotlib\font_manager.py:1226: UserWarning: findfont: Could not match :family=Bitstream Vera Sans:style=normal:variant=normal:weight=bold:stretch=normal:size=12\. Returning c:\windows\fonts\browai.ttf
~\dist\library.zip\matplotlib\font_manager.py:1216: UserWarning: findfont: Font family ['STIXSizeThreeSym'] not found. Falling back to Bitstream Vera Sans
~\dist\library.zip\matplotlib\font_manager.py:1216: UserWarning: findfont: Font family ['STIXSizeFourSym'] not found. Falling back to Bitstream Vera Sans
~\dist\library.zip\matplotlib\font_manager.py:1216: UserWarning: findfont: Font family ['STIXSizeFiveSym'] not found. Falling back to Bitstream Vera Sans
~\dist\library.zip\matplotlib\font_manager.py:1216: UserWarning: findfont: Font family ['STIXSizeTwoSym'] not found. Falling back to Bitstream Vera Sans
~\dist\library.zip\matplotlib\font_manager.py:1226: UserWarning: findfont: Could not match :family=Bitstream Vera Sans:style=italic:variant=normal:weight=normal:stretch=normal:size=12\. Returning c:\windows\fonts\browai.ttf
~\dist\library.zip\matplotlib\font_manager.py:1216: UserWarning: findfont: Font family ['STIXNonUnicode'] not found. Falling back to Bitstream Vera Sans
~\dist\library.zip\matplotlib\font_manager.py:1216: UserWarning: findfont: Font family ['cmb10'] not found. Falling back to Bitstream Vera Sans
~\dist\library.zip\matplotlib\font_manager.py:1216: UserWarning: findfont: Font family ['cmtt10'] not found. Falling back to Bitstream Vera Sans
~\dist\library.zip\matplotlib\font_manager.py:1216: UserWarning: findfont: Font family ['cmmi10'] not found. Falling back to Bitstream Vera Sans
~\dist\library.zip\matplotlib\font_manager.py:1216: UserWarning: findfont: Font family ['cmex10'] not found. Falling back to Bitstream Vera Sans
~\dist\library.zip\matplotlib\font_manager.py:1216: UserWarning: findfont: Font family ['cmsy10'] not found. Falling back to Bitstream Vera Sans
~\dist\library.zip\matplotlib\font_manager.py:1216: UserWarning: findfont: Font family ['cmr10'] not found. Falling back to Bitstream Vera Sans
~\dist\library.zip\matplotlib\font_manager.py:1216: UserWarning: findfont: Font family ['cmss10'] not found. Falling back to Bitstream Vera Sans 
```

而且我还看到了一个以以下结尾的回溯：

```
...
File "matplotlib\mathtext.pyo", line 720, in _get_glyph
KeyError: 98 
```

找不到的字体都是matplotlib/mathtext使用的。

我发现我尝试获取 data_files 的 setup.py 中的两种方法（使用 glob 和 matplotlib.get_py2exe_datafiles）都不起作用，并且没有任何内容被复制到我的 mpl-data/fonts 目录中。源码目录：C:\Python27\Lib\site-packages\matplotlib\mpl-data\fonts 包含 3 个文件夹：afm、pdfcorefonts & ttf。ttf 文件夹是上面提到的 mathtext 字体所在的位置。

在 setup.py 上运行 py2exe 并修改 glob 以获取 3 个字体目录后，我尝试手动将整个 mpl-data 文件夹复制到 dist 文件夹中，但仍然出现相同的错误。

似乎 matplotlib 的 font_manager 中的 findfont 方法在运行 py2exe 后不起作用，我猜当 mathtext.pyo 中的 _get_glyph 尝试使用 Bitstream Vera Sans 字体时它会崩溃。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T13:23:21.477

使用`matplotlib.get_py2exe_datafiles()`对我来说很好。只要确保您使用的是最新版本的 matplotlib 并像这样使用它`setup.py`：

```
datafiles = matplotlib.get_py2exe_datafiles()

setup(...
      ...
      data_files = datafiles,
      ...
     ) 
```

# cakephp - 删除查询字符串

> ID：12307627
> 
> 赞同：0
> 
> 时间：2012-09-06T20:09:24.153
> 
> 标签：cakephp, get, query-string

我正在使用一个古老的 API，它将结果通过`GET`方法发送到我的应用程序。因此，用户将使用如下网址重定向到我的操作：

```
http://example.com/api/result?request=102&state=1 
```

它看起来不太好..我也不希望用户知道他的`request`和`state`（API发送的`GET`，我不能设置它来发布它们）

可以`CakePHP`获取查询字符串并将其存储在会话中，然后将其从 url 中删除吗？自动地...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T21:26:39.163

不，它不能。由于您使用的是古老的 API，并且**无法**将请求方法更改为 POST，因此任何框架都无能为力。

但是您可以使用 PHP 函数之类的东西非常快地更改 URL（取决于用户连接/浏览器速度）。`header("LOCATION: http://example.com/api/result");` 不过，用户可以在短时间内看到请求和状态值。或者他可以随时按下浏览器停止按钮来停止请求......

# css - 字体对自定义语言字符不起作用

> ID：12307628
> 
> 赞同：2
> 
> 时间：2012-09-06T20:09:27.227
> 
> 标签：css, font-face, placeholder

不知道如何在 jsFiddle 中重现这个问题，但我会尽我所能解释这个问题。

我们正在将购买的字体导入 CSS：

```
@font-face {
    font-family: 'ForoItalicRegular'; 
    src: url('../Fonts/foro_italic/ForoIta-webfont.eot');
    src: url('../Fonts/foro_italic/ForoIta-webfont.eot?#iefix') format('embedded-opentype'),
    url('../Fonts/foro_italic/ForoIta-webfont.woff') format('woff'),
    url('../Fonts/foro_italic/ForoIta-webfont.ttf') format('truetype'),
    url('../Fonts/foro_italic/ForoIta-webfont.svg#Foro-ItalicRegular') format('svg');
    font-weight: normal;
    font-style: normal;
} 
```

然后我们将该字体应用于具有占位符属性的输入标签：

```
.m_hdr_glb_search input { width:230px; margin:0; padding:13px 0px 12px 5px; text-overflow:ellipsis; background:transparent; color:#221b33; font-size:0.750em; font-family:ForoItalicRegular,Georgia,serif; border:none; } 
```

我们的网站支持法语，因此在将法语重音字符引入占位符时会显示问题文本：

```
<input type="text" placeholder="Quartier, ville ou numéro"> 
```

结果如下：

![在此处输入图像描述](../Images/44bb9364988654c10a27884787a4b3a0.png)

经过仔细检查和一些测试，我发现单词“numero”中的重音“e”正在从字体堆栈降级到格鲁吉亚。

我能想到的唯一原因是重音字符在该尺寸下不可用，但经过更多测试后，情况并非如此。我可以将导入的字体调整为其他标签中的任何大小（即 - div、p、span 等），并且重音字符不会降级为 Georgia。

它只发生在输入标签的占位符属性中。我能够在所有主要浏览器中重现。

这是对占位符属性实施的疏忽吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-13T18:00:08.123

结果是在生成 Web 字体文件时，Font Squirrel 生成器没有正确配置。

必须选择以下 Font Squirrel 选项才能生成正确的语言字形：

单击**自定义子集**单选按钮并选择以下选项：

**字符编码**：Mac Roman

**字符类型**：选中此部分中的所有复选框

**语言**：英语、法语*等*

我用新生成的网络字体替换了旧的网络字体文件，法语字符显示没有问题。

# c# - Math.Round 不保留尾随零

> ID：12307630
> 
> 赞同：13
> 
> 时间：2012-09-06T20:09:42.063
> 
> 标签：c#, rounding

我需要将所有值四舍五入到小数点后两位。所以 1.401 应该四舍五入到 1.40，但`Math.Round(value, 2)`四舍五入到 1.4。

如何强制尾随零？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-09-06T20:11:51.323

`1.4`是一样的`1.40`- 你只是想以不同的方式显示它。调用时使用格式字符串`ToString`- 比如`value.ToString("0.00")`

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-09-06T20:11:35.940

`1.4 == 1.40`唯一需要尾随 0 的时候是显示数字时。即，将其格式化为字符串。

```
.ToString("N2"); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-09-06T20:11:57.200

尾随零更多的是格式而不是值问题，因此请使用

```
foo.ToString("0.00") 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2017-05-04T19:15:37.380

我知道这是一个老问题，但可能会对某人有所帮助！

我正在使用 ac# xml 类来填充然后序列化为 xml。其中一个值是双精度值。如果我为该值分配“7”，当我实际需要“7.00”时，它会被序列化为“7”。最简单的方法就是这样做：

```
foo = doubleValue + 0.00M 
```

这使得值 7.00 而不仅仅是 7。认为这比做一个 ToString 然后解析它更好。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-09-06T20:12:27.157

尾随零只是一个演示文稿。在数学方面，`1.40`并且`1.4`是等价的。

改用格式来显示小数点后 2 位：

```
String.Format("{0:0.00}", 1.4);

or

yourNumber.ToString("0.00"); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-01-30T16:57:06.750

这与您使用小数还是双精度有关。

虽然在内部（从[源代码](https://referencesource.microsoft.com/#mscorlib/system/math.cs,f0afe85387e48317,references)中显示）`Math.Round()`即使在双精度数上也保留尾随零，但它在内存中保存为双精度的事实仍然会自动删除所有尾随零

因此，如果您确实想要拖尾零，您可以使用字符串显示函数对其进行格式化，就像其他人回答的那样，或者确保将原始值作为小数传递（导致内部使用`Decimal.Math.Round`仅处理小数），并且确保不要将结果转换为双精度，也不要将其保存在双精度变量中。

同样，如果您有一个小数并且您不想要尾随零，只需将其转换为双精度（您可以将输入`Math.Round`或结果转换为，只要它在某处变成双精度就无关紧要了）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-09-06T20:12:45.973

它是一个数字（双精度？），因此它没有尾随零 - 您必须将其设为文本并强制尾随零。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-12-30T09:25:02.990

您可以使用此函数而不是 round 并像使用 round 函数一样使用它。

```
import decimal

def printf(x, n):
    d = decimal.Decimal(str(x))
    d0 = -(d.as_tuple().exponent)
    if d0 < n:
        print("x = ", x)
    else:
        d1 = decimal.Decimal(str(round(x, n)))
        d2 = d1.as_tuple().exponent
        MAX = n + d2
        if MAX == 0:
            print("x = ", round(x, n))
        else:
            i = 0
            print("x = ", round(x, n), end = '')
            while i != MAX:
                if i == (MAX - 1):
                    print("0")
                else:
                    print("0", end = '')
                i = i + 1 
```

所以你必须有这样的东西。

```
>>> printf(0.500000000000001, 13)
>>> 0.5000000000000 
```

# css - CSS UL Menu IE 无法正确查看

> ID：12307632
> 
> 赞同：0
> 
> 时间：2012-09-06T20:09:43.460
> 
> 标签：css, internet-explorer

我正在尝试在我的网站上使用菜单。所以我已经准备好了，它在 Firefox、Chrome、Safari 上运行良好，但在 IE 上不行。这是那个小 html 的[链接](http://minas.miroglu.com/testing/)，它是一个带有 li 项目的菜单。知道如何使它也可以在 IE 上运行吗？此外，afaik css 渐变背景应该适用于 IE，但它不能：

# actionscript-3 - 如何覆盖 flex actionscript 中的 titlewindow 4px 填充？

> ID：12307634
> 
> 赞同：1
> 
> 时间：2012-09-06T20:09:44.357
> 
> 标签：actionscript-3, apache-flex, actionscript, border, padding

我是 flex 新手，我正在尝试创建一个侧面没有任何填充的标题窗口。在 adobe 文档[http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/mx/containers/TitleWindow.html](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/mx/containers/TitleWindow.html)中，它说标题窗口有 4px 的填充。我想知道是否可以通过覆盖 updateDisplayList 函数并将填充设置为 0 来摆脱它（我一直在尝试这个，但我似乎找不到要设置的正确属性）。基本上我想要做的是在标题窗口的左下角有一个按钮，并且按钮的边缘应该距离窗口边框 0px。

PS：我只需要对标题窗口执行此操作。使用 Panel 或我不感兴趣的其他组件可能还有另一种方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T20:17:20.310

`TitleWindow`文档的链接有一个[样式](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/mx/containers/TitleWindow.html#styleSummary)部分。它具有`paddingTop`、`paddingBottom`、`paddingLeft`和的样式`paddingRight`。

在 Actionscript 和 MXML 中，CSS 样式的设置略有不同。由于 css 样式不是对象的属性，因此您必须使用`setStyle()`Actionscript 中的方法。您也可以使用样式表。

MXML：

```
<mx:TitleWindow paddingLeft="0" paddingRight="0" /> 
```

动作脚本：

```
var tw:TitleWindow = new TitleWindow();
tw.setStyle("paddingLeft", 0);
tw.setStyle("paddingRight", 0); 
```

# java - java-如何在单个变量中管理多个数据列表-轻松访问每个列表

> ID：12307636
> 
> 赞同：1
> 
> 时间：2012-09-06T20:09:48.070
> 
> 标签：java, list, multidimensional-array, arraylist

我有一个场景，我必须在 java 应用程序中处理多个数据列表......现在每个列表中可以包含任意数量的元素......此外，这些列表的数量最初也不知道......

哪种方法最适合我的情况？我可以想到列表的arraylist，或者列表的列表或arraylist的列表等（即arraylist + list/arraylist+arraylist/list+list的组合）......我想知道的是 -

(1) 以上哪一项（或您自己的解决方案）最容易管理——即存储/获取数据 (2) 以上哪一项将使用最少的内存？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T20:15:58.360

我将我的变量声明为：

```
List<List<DataType>> lists = new ArrayList<List<DataType>>(); 
```

通过接口类型的变量访问列表方法会有一点时间损失，但我认为，这完全可以与您根据需要更改类型的灵活性相平衡。（例如，如果您决定将其设为`lists`不可变，则可以通过 中的一种方法来实现`java.util.Collections`，但如果您已将其声明为`ArrayList<List<DataType>>`.）

请注意，`lists`必须保存一些实现的具体类的实例`List<DataType>`，因为（正如其他人所指出的）`List`是一个接口，而不是一个类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T20:12:40.887

[`List`](http://docs.oracle.com/javase/6/docs/api/java/util/List.html)是一个接口。[`ArrayList`](http://docs.oracle.com/javase/6/docs/api/java/util/ArrayList.html)是 的一种实现`List`。

当您*构造*a时`List`，您必须选择特定的具体类型（例如`ArrayList`）。当您*使用*列表时，如果可能，最好针对界面进行编程。这可以防止您的代码和特定`List`实现之间的紧密耦合，`List`如果您愿意，您以后可以更轻松地更改为另一个实现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-06T20:52:03.713

如果您知道一种方法来确定您将处理哪个列表，请使用列表映射。

```
Map<String,List<?>> = new HashMap<String,List<?>>(); 
```

这样，您就可以避免必须遍历外部元素才能到达实际列表。哈希映射比迭代器执行得更好。

# cakephp - CakePHP：保存相关数据

> ID：12307640
> 
> 赞同：2
> 
> 时间：2012-09-06T20:10:21.767
> 
> 标签：cakephp

我正在尝试保存属于 IssueHistory 的 IssueHistoryDe​​scription。所以IssueHistory有很多IssueHistoryDe​​scription。这一切都已经在模型中设置好了。

然而，当我将其保存在 IssueHistory 中时，使用`$IssueHistory->save($data);`

（有或没有`$IssueHistory->create();`之前...）

```
大批
(
    [问题历史] => 数组
        (
            [id] => 22
        )

    [问题历史描述] => 数组
        (
            [old_description] => 旧
            [描述] => 新
        )

)

```

它不起作用，没有任何保存。

当我尝试使用时`saveAssociated()`出现错误：

致命错误：不能在第 2248 行的 /var/www/xdev/kipdomanager/cakephp/lib/Cake/Model/Model.php 中使用字符串偏移作为数组

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-06T20:23:02.677

你可以试试这个：

```
$data = array(
    'IssueHistory' => array('id' => 2),
    'IssueHistoryDescription' => array(
        array('old_description' => 'OLD', 'description' => 'new')
    )
);

$IssueHistory->create();
$IssueHistory->saveAll( $data ); 
```

# vb.net - 检查以查看 GridViewRow 单元格在 Visual Basic 中是否为空

> ID：12307646
> 
> 赞同：1
> 
> 时间：2012-09-06T20:11:05.430
> 
> 标签：vb.net

我有一个我正在处理的 VB 项目，我必须将 GridView 分解为每一行并检查一个特定的单元格。如何检查是否有空值？以下代码导致错误消息

“指定的参数超出了有效值的范围。参数名称：索引”

我检查了 GridViewRow 变量“row”的单元格计数，它出现在 5，所以我不确定我做错了什么。

```
Protected Sub grdProduct_RowDataBound(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewRowEventArgs) Handles grdProduct.RowDataBound

    ' Grey out expired products
    Dim row As GridViewRow
    row = e.Row

    Dim incomingStatus As String
    If row.Cells(5).Text.ToString() <> vbNull Then
        incomingStatus = row.Cells(5).Text.ToString()
    Else
        incomingStatus = ""
    End If 
```

我修改了代码以首先检查单元格计数，但它仍然返回完全相同的错误。

```
 If row.Cells.Count > 5 And row.Cells(5).Text.ToString() <> vbNull Then
        incomingStatus = row.Cells(5).Text.ToString()
    Else
        incomingStatus = ""
    End If 
```

最终编辑

像这样修改代码解决了这个问题。多谢你们：

```
 If row.Cells.Count > 5 Then
        If row.Cells(5).Text.ToString() <> vbNull Then
            incomingStatus = row.Cells(5).Text.ToString()
        Else
            incomingStatus = ""
        End If
    End If 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T20:17:04.210

> 我检查了 GridViewRow 变量“row”的单元格计数，它出现在 5，所以我不确定我做错了什么。

`row.Cells(5)`返回第 6 个单元格，而不是第 5 个单元格，因为索引在 .NET 中为 0。但该`Count`属性返回实际的单元格数。

对于`GridView.Rows`.

```
GridView1.Rows(9) 
```

返回第 10 个`GridViewRow`。

# android - 没有图形的android活动

> ID：12307647
> 
> 赞同：0
> 
> 时间：2012-09-06T20:11:10.653
> 
> 标签：android

从 BroadcastReceiver 我想调用一个没有图形的活动。没有图形，因为它会说一些话。

```
Intent iSpeechIntent = new Intent(context, TTS.class);                          
iSpeechIntent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
context.startActivity(iSpeechIntent); 
```

但活动周期未正确完成。`onDestroy()`方法永远不会执行。为什么？

```
@Override
    public void onDestroy() {
        // Don't forget to shutdown!
        if (tts != null) {
            tts.stop();
            tts.shutdown();
        }
        super.onDestroy();
    } 
```

如果我使用没有图形 XML 的活动只是为了用 TTSEngine 说出一些文本，可以吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T20:19:57.883

您误解了[Activity 生命周期](http://developer.android.com/reference/android/app/Activity.html#ActivityLifecycle)。`onDestroy()`关闭您的活动时**不会**调用。并且解除它（即通过启动另一个活动）并不**等于**破坏活动（但是您可以通过调用强制破坏活动`finish()`- 然后`onDestroy()`将调用您的方法）。您可能希望将代码分别移动到`onPause()`和 ，`onResume()`或者如果您确实需要任何 UI 来完成任务，您可能应该使用[IntentService 。](http://developer.android.com/reference/android/app/IntentService.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T20:15:20.317

我建议将 Android 服务用于此类任务[http://developer.android.com/reference/android/app/Service.html](http://developer.android.com/reference/android/app/Service.html)。

# python - 手动切换小部件在 pygtk 中发出信号的能力

> ID：12307652
> 
> 赞同：3
> 
> 时间：2012-09-06T20:11:30.543
> 
> 标签：python, pygtk

我可能在我的 pygtk 编程中遗漏了一些基本的东西，但是我想将一个信号连接到例如 an`gtk.Entry`然后让它只在我允许它这样做时才发出连接的信号。

也就是说，我想`toggle_signalling`在这个最小代码中添加一些东西（仅用于交互使用），以便`Hello`仅在“允许”信号时打印：

```
import gtk

signal_states = ['On', 'Off']
signal_state = True

def reporter_function(*args,**kwargs):
    print "Hello"

def toggle_signaling(widget, **kwargs):
    global signal_state
    signal_state = not signal_state
    widget.set_label(signal_states[signal_state])
    print ['Emit allowed', 'Emit not allowed'][not signal_state]

w = gtk.Window()
e = gtk.Entry()
b = gtk.Button(label=signal_states[signal_state])

hbox = gtk.HBox()
hbox.pack_start(e)
hbox.pack_end(b)

e.connect("changed", reporter_function)
b.connect("clicked", toggle_signaling)
w.add(hbox)
w.show_all() 
```

我以前让这种发送信号状态有一个布尔标志，例如`self._updating`在我的自定义小部件类中，并让回调函数在做任何事情之前检查这个状态。那不是我想要的。

我想要一种 gtk-native 方式让小部件知道它不应该发送信号（当我单击示例中的按钮时）。我很确定我曾经偶然发现过这样做的方法，但我迷失了再次找到它。

此外，绝对清楚，仍然必须允许启用小部件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-06T22:15:45.230

我认为没有办法绕过布尔标志。是否允许小部件发出信号是附加的应用程序逻辑，因此必须保存在某个地方。
根据您之前对该主题的研究和相当准确地描述的功能，您很可能正在寻找[PyGTK 教程的第 20.1.2 章](http://www.pygtk.org/pygtk2tutorial/ch-AdvancedEventAndSignalHandling.html#id2871063)。
我将综合示例代码放在一起。除了布尔指标外，唯一需要保留的是`handler_id`已连接信号的。正如您可能注意到的，它是在 Gtk3 中编写的，但重要的方法`handler_block`和`handler_unblock`功能在 Gtk 2 和 3 中完全相同。

```
from gi.repository import Gtk

class TestWindow(Gtk.Window):

    def __init__(self, *args, **kwargs):
        Gtk.Window.__init__(self, *args, **kwargs)
        self.connect("destroy", Gtk.main_quit)
        self.is_allowed = True
        self.create_widgets()
        self.show_all()

    def create_widgets(self):
        box = Gtk.HBox()
        self.entry = Gtk.Entry()
        self.handler_id = self.entry.connect("changed", self.on_entry_changed)
        box.pack_start(self.entry, True, True, 0)
        button = Gtk.Button("Toggle")
        button.connect("clicked", self.on_button_clicked)
        box.pack_start(button, True, True, 0)
        self.add(box)

    def on_entry_changed(self, *args):
        print "entry has changed"

    def on_button_clicked(self, *args):
        if self.is_allowed:
            self.entry.handler_block(self.handler_id)
            print "now blocking"
        else:
            self.entry.handler_unblock(self.handler_id)
            print "now unblocking"
        self.is_allowed = not self.is_allowed

TestWindow()
Gtk.main() 
```

# c# - 如何在 VS 2012 中编辑 .testsettings

> ID：12307653
> 
> 赞同：2
> 
> 时间：2012-09-06T20:11:30.627
> 
> 标签：c#

VS 2012 附带的 .testsettings 文件包含过时的浏览器（IE 除外，它是最新的），例如 Chrome 2.0 和 Firefox 3.0（无法理解 MS 是如何错过这些的，呵呵）。但无论如何，我怎样才能编辑这个文件并更新浏览器并删除旧的？我正在使用 VS 2012 和 .webtest 文件类型编写自动化脚本。

谢谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-11-12T15:08:25.977

这与 .testsettings 文件无关，它与 VS2012 MTM 的未来有关。遗憾的是，您无法在 VS2012 测试设置上更新浏览器。

VS2015 具有强大的测试能力。

> 借助 Visual Studio 和 Team Foundation Server 2015——我们在 Visual Studio 中提供持续集成和持续交付解决方案。
> 
> 作为持续集成和交付的一部分，您可以创建构建定义/发布定义来运行针对构建 vNext 或发布工作流程中的各种浏览器的自动化测试。在目标机器上，您只需要设置一个您想要定位的浏览器，我们将对浏览器执行测试 - 请参阅此博客的更多详细信息：http: [//aka.ms/testingblog](http://aka.ms/testingblog)。

# html - 不透明背景上的透明图像

> ID：12307659
> 
> 赞同：1
> 
> 时间：2012-09-06T19:30:51.860
> 
> 标签：html, css, png

**问题**：

我有一个 png 图像作为 jquery 对话框标题。图像角是透明的（圆角）

当我在 50% 不透明的覆盖层上显示对话框时，我看到角落不透明。

**解决方案**：

问题是图像作为标题的定位。不透明的角不是图像的，而是包含它的 div 的。它甚至不透明我在“.ui-dialog .ui-dialog-titlebar”中将背景颜色设置为透明

我找到的解决方案是将“.ui-dialog .ui-dialog-titlebar”边距顶部属性设置为“-18px”，以便将 png 图像定位在外部，隐藏 div 的角

谢谢您的帮助

# php - 绝对假人的 SQL

> ID：12307660
> 
> 赞同：0
> 
> 时间：2012-09-06T20:12:18.850
> 
> 标签：php, sql

对于任何类型的基于服务器的脚本，我都是一个完全的傻瓜，这太糟糕了，我什至无法连接到我的服务器的数据库。SQL/PHP 教程说我应该使用：

```
mysql_connect($database, $user,$password);
@mysql_select_db($database) or die( "Unable to select database"); 
```

如何找出数据库的名称？这是我应该问管理员的事情吗？

我知道这是一个非常愚蠢的问题，但我花了相当多的时间在网上寻找答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T20:15:27.780

简而言之：是的 - 这是您的管理员可以给您的，因为他在创建数据库时选择了名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T20:20:28.087

看情况：

*   如果您使用的是非常便宜的主机，您将获得 1 个固定数据库。有时您可以选择带有固定前缀的名称
*   如果您有一个体面的主机，您通常可以创建 5 个左右的数据库，并选择您自己的名称。名称通常有前缀。
*   如果您有自己的服务器，在 vps 上，或者安装了 xamp 或 Lamp，您可以创建自己的数据库，并为它们提供自己的逻辑名称。

所以，选择你的选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-06T20:28:42.047

如果您对此不熟悉并且正在寻找学习 SQL/php 编程的机会，我强烈建议您安装 XAMPP ( [http://www.apachefriends.org/en/xampp.html](http://www.apachefriends.org/en/xampp.html) ) 的副本，因为它会给您一个本地的安装 MySQL、Apache Web 服务器和 PHP 供您在不使用生产数据的情况下学习。

[您还可以从http://dev.mysql.com/doc/index-other.html](http://dev.mysql.com/doc/index-other.html)获取一些高质量的学习数据库，以便从中学习。

# php - 在 php 中启用 user_birthday 权限 facebook 生日

> ID：12307661
> 
> 赞同：4
> 
> 时间：2012-09-06T20:12:20.173
> 
> 标签：php, facebook, facebook-graph-api, user-profile

我正在制作一个 facebook 应用程序来显示用户的生日......

```
 <?
         require_once('php-sdk/facebook.php');
         $config = array(
                          'appId' => 'YOUR_APP_ID',
                          'secret' => 'YOUR_APP_SECRET',
                         );

         $facebook = new Facebook($config);
         $user_id = $facebook->getUser();
     ?>
     <html>
     <head></head>
     <body>

     <?
            if($user_id) 
            {

                  // We have a user ID, so probably a logged in user.
                  // If not, we'll get an exception, which we handle below.
                  try 
                  {

                        $user_profile = $facebook->api('/me','GET');
                        echo "Name: " . $user_profile['name'];

                        // Birth Date to be printed here........
                       echo "DOB:  ".$user_profile['birthday'];
                  } 
                  catch(FacebookApiException $e) 
                  {
                       // If the user is logged out, you can have a 
                       // user ID even though the access token is invalid.
                      // In this case, we'll get an exception, so we'll
                      // just ask the user to login again here.
                     $login_url = $facebook->getLoginUrl(); 
                     echo 'Please <a href="' . $login_url . '">login.</a>';
                     error_log($e->getType());
                     error_log($e->getMessage());
                  }   
             } 
             else 
             {

                    // No user, print a link for the user to login
                    $login_url = $facebook->getLoginUrl();
                    echo 'Please <a href="' . $login_url . '">login.</a>';

              }
     ?>

     </body>
     </html> 
```

现在，问题是`This prints the name as expected but prints nothing in place on date of birth`......当我进一步提到时，我听说了 facebook 权限（扩展）这个术语......并从以下链接 [http://developers.facebook.com/docs/reference /api/用户/](http://developers.facebook.com/docs/reference/api/user/)

我发现我们需要启用权限`users_birthday`或`friends_birthday`.

***现在，我们如何在 php 代码中启用它？***...请提供样品帮助.......如果这个问题看起来很愚蠢，我很抱歉。我只是 facebook 应用程序开发的新手，也是 php 的初学者……我尝试了 stackoverflow.com 中的其他示例，但对我没有多大帮助……

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-06T20:39:14.670

[我看不到您已阅读许可](https://developers.facebook.com/docs/authentication/permissions/)或[身份验证](https://developers.facebook.com/docs/authentication/)文档的迹象；您不是在请求用户访问他们的生日的权限。

添加`user_birthday`到将`scope`用户发送到身份验证对话框时，如果他们批准权限，您将能够访问他们的生日。

您在 App Settings 中配置的权限仅适用于（已弃用）Authenticated Referrals 或 App Center 登录屏幕，您的应用需要在所有其他登录流程中明确请求权限

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-06-05T22:34:45.993

您必须要求 Facebook 批准您的申请。在 facebook 审核后，您可以使用扩展权限。

根据[本](https://developers.facebook.com/docs/facebook-login/permissions/v2.0#categories)文档，如果您的应用要求的不仅仅是 public_profile、email 和 user_friends，则需要经过 Facebook 审核，然后您的应用才能被应用开发人员以外的人使用。[1](https://developers.facebook.com/docs/facebook-login/permissions/v2.0#categories)

我和你有同样的问题。我认为它是错误的编码，一切。然后我刚刚在 facebook v2.0 文档上看到了这个。

# javascript - 如何创建“显示更多”按钮并指定最初可以显示多少行文本

> ID：12307666
> 
> 赞同：22
> 
> 时间：2012-09-06T20:12:35.370
> 
> 标签：javascript, jquery, css, html

我正在寻找一种在我的响应式网站上创建滑出“显示更多”功能的方法，该功能会在段落的**两行之后切断。**

我之前通过静态网站实现了这一点，方法是对容器应用设置的高度并使用`overflow: hidden`，然后为容器的高度设置动画。

但是响应式，容器以不同的浏览器宽度挤压文本，因此文本可能会占用更多/更少的空间。每次下推，段落上方也可能有不同的内容。所以设置`height`可能不会完全覆盖两条线。

如果您需要演示，请查看这个 jsFiddle：http: [//jsfiddle.net/XVAzU/ 。](http://jsfiddle.net/XVAzU/)

所以我需要在段落的两行之后切断，无论容器的宽度是多少，或者该段落之前或之后是什么。

感谢您的关注！

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-09-06T20:42:17.297

从你的小提琴开始，将内容包装成`<div>`一个默认类`content`，用于选择和一个名为的类，单击链接 时`hideContent`将与之交换。`showContent``show more/show less`

我还删除了`<p>`文本。文本现在在 content-div 中，我们现在也可以应用正确的高度和行高设置。

HTML：

```
<div class="text-container">
    <h1>Title goes here</h1>
    <h2>Subtitle</h2>
    <div class="content hideContent">
        Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua.
        <p>Some more text</p>
        <ul>
            <li>Some more text</li>
            <li>Some more text</li>
            <li>Some more text</li>
        </ul>
    </div>
    <div class="show-more">
        <a href="#">Show more</a>
    </div>
</div>​ 
```

CSS：

```
.hideContent {
    overflow: hidden;
    line-height: 1em;
    height: 2em;
}

.showContent {
    line-height: 1em;
    height: auto;
} 
```

我假设设置`line-height`将确保它在所有浏览器中都是相同的。不过，我不是 100% 确定这一点。

我在“显示更多”链接上附加了一个点击事件，该链接使用 jQueryUI [**switchClass()**](http://jqueryui.com/demos/switchClass/)切换 div 上的类：

```
$(".show-more a").on("click", function() {
    var $this = $(this); 
    var $content = $this.parent().prev("div.content");
    var linkText = $this.text().toUpperCase();    

    if(linkText === "SHOW MORE"){
        linkText = "Show less";
        $content.switchClass("hideContent", "showContent", 400);
    } else {
        linkText = "Show more";
        $content.switchClass("showContent", "hideContent", 400);
    };

    $this.text(linkText);
});​ 
```

### [JsFiddle Demo](http://jsfiddle.net/Wpn94/) - 显示更多/显示更少并应用行高和动画

```
$(".show-more a").on("click", function() {
  var $this = $(this);
  var $content = $this.parent().prev("div.content");
  var linkText = $this.text().toUpperCase();

  if (linkText === "SHOW MORE") {
    linkText = "Show less";
    $content.switchClass("hideContent", "showContent", 400);
  } else {
    linkText = "Show more";
    $content.switchClass("showContent", "hideContent", 400);
  };

  $this.text(linkText);
});
```

```
div.text-container {
  margin: 0 auto;
  width: 75%;
}

.hideContent {
  overflow: hidden;
  line-height: 1em;
  height: 2em;
}

.showContent {
  line-height: 1em;
  height: auto;
}

.showContent {
  height: auto;
}

h1 {
  font-size: 24px;
}

p {
  padding: 10px 0;
}

.show-more {
  padding: 10px 0;
  text-align: center;
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.0/jquery.min.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>

<div class="text-container">
  <h1>Title goes here</h1>
  <h2>Subtitle</h2>
  <div class="content hideContent">
    Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata
    sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua.
    <p>Some more text</p>
    <ul>
      <li>Some more text</li>
      <li>Some more text</li>
      <li>Some more text</li>
    </ul>
  </div>
  <div class="show-more">
    <a href="#">Show more</a>
  </div>
</div>
```

上面的代码只是一个例子，但应该让你开始朝着正确的方向前进。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2017-03-20T12:22:49.410

如果您正在寻找仅使用 css 的解决方案，请查看以下内容：

HTML

```
 <div class="show-hide-text">
  <a  id="show-more" class="show-less" href="#show-less">Show less</a>
  <a  id="show-less" class="show-more" href="#show-more">Show more</a>
  <p>
    Lorem Ipsum is simply dummy text of  the printing and typesetting industry...
  </p>
</div> 
```

// CSS

```
.show-hide-text {
  display: flex;
  flex-wrap: wrap;
}

.show-hide-text a {
  order: 2;
}

.show-hide-text p {
  position: relative;
  overflow: hidden;
  max-height: 60px; // The Height of 3 rows
}

.show-hide-text p {
  display: -webkit-box;
  -webkit-line-clamp: 3; // 3 Rows of text
  -webkit-box-orient: vertical;
}

.show-less {
  display: none;
}

.show-less:target {
  display: block;
}

.show-less:target ~ p {
  display: block;
  max-height: 100%;
}

.show-less:target + a {
  display: none;
} 
```

一个例子：[https ://codepen.io/srekoble/pen/WGBzZa?editors=1100](https://codepen.io/srekoble/pen/WGBzZa?editors=1100)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-07-10T13:47:09.403

我的解决问题的建议

```
$("#slider_desc_toogler").on( "click", function() { 
  $('#slider_desc_toogler > i').toggleClass('fa-arrow-circle-down')
  $('#slider_desc_toogler > i').toggleClass('fa-arrow-circle-up')
  if ($("#slider_desc_toogler > i").hasClass( "fa-arrow-circle-down" )) {
    $(".slider_desc").css("max-height","38px");
  } else $(".slider_desc").css("max-height","500px");
});
```

```
.slider_desc {
  margin: 16px;
  margin-top: 0px;
  color: #333333;
  font-family: Arial;
  font-size: 14px;
  line-height: 18px;
  text-align: justify;
  overflow: hidden;
  transition: all 0.5s ease 0s;
  max-height: 38px;
}

#slider_desc_toogler{
  border-top: silver 1px dotted;
  margin-bottom: 30px;
  margin-top: 20px;
  width: 70%;
  margin-left: auto;
  margin-right: auto;
}

#slider_desc_toogler i {
      position: absolute;
      text-align: center;
      color: silver;
      font-size: 25px;
      font-family: fontawesome;
      left: calc(50% - 10px);
      margin-top: -13px;
      background: #fff;
  }
```

```
<link href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" rel="stylesheet"/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<div class="slider_desc">
            Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.

            </div>
            <div id="slider_desc_toogler"><i class="fas fa-arrow-circle-down"></i></div>
```

# asp.net - 下载链接给我filenotfound异常

> ID：12307671
> 
> 赞同：1
> 
> 时间：2012-09-06T20:12:45.537
> 
> 标签：asp.net, asp.net-mvc-3, controller, download

在我的控制器中，这是我拥有的代码

```
 public FileResult Download(string file)
    {

        var vFullFileName = HostingEnvironment.MapPath("~/App_Data/Files/");

        var files = uploadedfileRepository.AllIncluding();
        string filename = (from f in files

                           select f.FileName).First();

        return File(Path.Combine(vFullFileName, filename), "application/csv", filename);
    } 
```

我把断点和文件指向了正确的目录，但是为什么还是给我File not found异常呢？

在我看来，这就是我所拥有的

```
 <td>
            @Html.ActionLink("Download", "Download", new { id = item.FileName})
        </td 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T20:29:53.460

`App_Data`适用于 MS SQL Server 访问的数据库文件，也可能是您的应用程序自己的数据文件（如 Lucene 索引）。

IIS（和 ASP.NET）被配置为阻止任何客户端对该目录的请求。

解决方案是将文件移动到另一个目录。只需在您网站的根目录中创建一个新文件夹（例如“CsvFiles”）并链接到该文件夹​​。

也就是说，您为什么不向 CSV 文件提供 HTTP 301 重定向（甚至是直接链接），而不是通过您的应用程序提供它们？

更新：这个答案是不正确的，因为通过 MVC 文件响应提供文件内容，用户的浏览器不会真正访问`App_Data`目录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T20:37:53.907

您的`action`方法有一个名为**file**的参数。但是您的 HTML 将有一个名为 **id**的参数/查询字符串，而不是 od 文件，因此将您的视图代码更改为

```
@Html.ActionLink("Download", "Download", new { file= item.FileName}) 
```

还要获得路径，试试这个

```
string fullFilePath=Path.Combine(Server.MapPath("~/App_Data"),filename)
return File(fullFilePath,"application/csv",filename); 
```

# actionscript-3 - Adobe Air 原生扩展和 IO 操作

> ID：12307676
> 
> 赞同：1
> 
> 时间：2012-09-06T20:13:04.520
> 
> 标签：actionscript-3, flash, air, air-native-extension

我需要用 Adob​​e AIR 本机扩展 API (ANE) 包装一个 C 库。扩展应该针对 IOS 和 Android。首先，我意识到对于 Android，如果不使用 NDK API，我必须将该库移植到 Java。但是我的主要关注的是 IO 操作，例如对该库中存在的文件系统的读写。我通读了[ANE 开发手册](http://help.adobe.com/en_US/air/extensions/air_extensions.pdf)，但没有发现关于限制本机库与主机文件系统通信的说明。这是否意味着我的本机库被允许在 AIR 扩展中自由读写文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T22:22:15.407

您绝对可以访问文件系统来读取和写入文件。

这里唯一需要注意的是，您只能访问应用程序有权访问的文件系统部分。因此，您基本上只需要遵守普通原生应用程序开发人员所具有的任何限制。

我已经使用 java.io.File 访问 ANE 中的文件没问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T21:59:06.603

根据我看到的扫描结果，它对我来说就像它是可行的，但我无法确认 100%

> 创建本机扩展时，您需要提供以下内容：
> 
> 您定义的 ActionScript 扩展类。这些 ActionScript 类使用允许访问本机代码并与本机代码交换数据的内置 ActionScript API。
> 
> 本机代码实现。本机代码使用本机代码 API，允许访问您的 ActionScript 扩展类并与之交换数据。

在我看来，您有任何可用于编写本机扩展的本机 API，它们只是提供“桥梁”或“数据隧道”来在动作脚本代码和本机扩展之间进行通信。他们从 android 库中导入了一个用于登录他们的示例，所以我想您可以使用每个平台可用的任何对象/方法，我想唯一真正的问题是本机进程对文件系统的访问权限每个平台。如果您没有得到答案，请尝试回帖（如果我有时间，我也会这样做）。

# jquery - Primefaces 3.3.1 和 jQuery Datepicker 不工作

> ID：12307679
> 
> 赞同：0
> 
> 时间：2012-09-06T20:13:13.530
> 
> 标签：jquery, primefaces, datepicker

我下面的 xhtml 有一个 datepicker，它工作正常，直到我包含 primefaces 的命名空间以使用自动完成功能。这是我在包含 primefaces 自动完成之前的 xhtml

**在 Primeface xhtml 之前：**

```
<div xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core" 
    lang="en" xml:lang="en" style="padding-bottom: 8px;">
    <h:head>
        <script type="text/javascript" src="#{lookupBean.themePath}/js/jquery-1.7.2.min.js" />
        <script type="text/javascript" src="#{lookupBean.themePath}/js/javascript.js" />
        <script type="text/javascript" src="#{lookupBean.themePath}/js/jquery.tablesorter.min.js" />
        <script type="text/javascript" src="#{lookupBean.themePath}/js/ui.datepicker.js" />

        <script type="text/javascript">
           jQuery(document).ready(function() 
            {
                jQuery('input:text[id$="endDate"]').datepicker({
                showOn : 'button',
                buttonImageOnly : true,
                buttonImage : '/vcc-theme/images/common/calendar.png',
                minDate : +0
            });
        </script>
    </h:head>
    <h:body>
        End Date:  <h:inputText id="endDate" for="endDate" value="#{manageMarketingProgramsBean.endDate}">
                        <f:convertDateTime pattern="MM/dd/yyyy" timeZone="America/New_York" />
                    </h:inputText>
    </h:body>
</div> 
```

**包括 primefaces 自动完成后：**

```
<div xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core" 
     xmlns:p="http://primefaces.org/ui"
    lang="en" xml:lang="en" style="padding-bottom: 8px;">
    <h:head>
        <script type="text/javascript" src="#{lookupBean.themePath}/js/jquery-1.7.2.min.js" />
        <script type="text/javascript" src="#{lookupBean.themePath}/js/javascript.js" />
        <script type="text/javascript" src="#{lookupBean.themePath}/js/jquery.tablesorter.min.js" />
        <script type="text/javascript" src="#{lookupBean.themePath}/js/ui.datepicker.js" />

        <script type="text/javascript">
           jQuery(document).ready(function() 
            {
                jQuery('input:text[id$="endDate"]').datepicker({
                showOn : 'button',
                buttonImageOnly : true,
                buttonImage : '/vcc-theme/images/common/calendar.png',
                minDate : +0
            });
        </script>
    </h:head>
    <h:body>
        End Date:  <h:inputText id="endDate" for="endDate" value="#{manageMarketingProgramsBean.endDate}">
                        <f:convertDateTime pattern="MM/dd/yyyy" timeZone="America/New_York" />
                    </h:inputText>

        Name:<p:autoComplete value="#{programManagerBean.programManager}"
                        completeMethod="#{programManagerBean.getInternalUsers}" maxResults="150" scrollHeight="250" size="50"
                        minQueryLength="2">
                    </p:autoComplete>
    </h:body>
</div> 
```

**Prime Faces 自动完成之前的日期选择器：** ![在 Prime 面临自动完成之前](../Images/586a243c9ccb0356fe68cb98f4f42b73.png)

**Prime面临自动完成后的日期选择器** ![Prime Faces 自动完成后](../Images/b073b6d38bf993d8f224578e39bdc189.png)

自动完成功能正在运行，但在我的 xhtml 中添加该标签会搞砸日期选择器，不确定会发生什么？我可以选择月份、年份，但没有出现任何日期。如果我在这里做错了什么，请告诉我。

我还注意到日期选择器问题并非特定于主要面部自动完成功能。如果我添加任何其他素面元素或标签，我将面临 datepicker 的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T07:01:42.540

你的css搞砸了。查看此问题以解决您的问题：

[如何覆盖 Primefaces jQuery 和 css](https://stackoverflow.com/questions/9597025/how-to-override-primefaces-jquery-and-css)

# c# - 什么类型的参数参数允许使用管道“|” 在参数列表中？

> ID：12307682
> 
> 赞同：6
> 
> 时间：2012-09-06T20:13:23.693
> 
> 标签：c#

> **可能重复：**
> [按位或 | 是什么？运营商呢？](https://stackoverflow.com/questions/612072/what-does-the-bitwise-or-operator-do)

```
new Font(textBox1.Font, FontStyle.Bold | FontStyle.Italic); 
```

接受此构造函数调用的方法签名是什么样的？

我从来不知道我可以使用“|” 方法调用中的运算符。我想了解更多。

'|'的英文单词是什么 操作员？（我什至不知道如何用谷歌搜索，因为我不知道用什么词来描述它）

在方法中使用它时，我如何向其他开发人员解释它？

你会建议我把这个运算符包含在我的技巧包中吗？

运营商有什么特别的注意事项吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-06T20:15:57.713

接受方法的签名看起来像：

```
public Font(Font prototype, FontStyle newStyle)
{
    ...
} 
```

此上下文中的`|`运算符（按位或）表示字体应为粗体*和*斜体。它的工作原理是这样的，因为它`FontStyle`是一个`enum`装饰有`FlagsAttribute`. `FontStyle`定义是：

```
[Flags]
public enum FontStyle
{
    Bold = 1,
    Italic = 2,
    Regular = 0,
    Strikeout = 8,
    Underline = 4
} 
```

因此，当您说 时`FontStyle.Bold | FontStyle.Italic`，它是按位或：

```
FontStyle.Bold                    = 1 = 00000001
FontStyle.Italic                  = 2 = 00000010
                                        ========
FontStyle.Bold | FontStyle.Italic = 3 = 00000011 
```

稍后，您可以测试`style`参数以查看使用另一个位运算符 ( ) 设置了哪些位`&`。例如，如果您想查看上面生成的样式是否为粗体，您可以执行以下操作：

```
FontStyle myStyle = FontStyle.Bold | FontStyle.Italic;
bool isBold = (myStyle & FontStyle.Bold) == FontStyle.Bold; 
```

例如，类`Bold`上的属性使用与上面几乎相同的代码`Font`检查是否是您给它的样式的一部分：`FontStyle.Bold`

```
public bool Bold
{
    get
    {
        return ((this.Style & FontStyle.Bold) != FontStyle.Regular);
    }
} 
```

请注意，从 .NET Framework 4 开始，您可以使用它[`Enum.HasFlag()`](https://docs.microsoft.com/en-us/dotnet/api/system.enum.hasflag?view=netframework-4.0)来测试标志的存在。例如，上面的属性定义可以简化为（使用 C# 6 中的一点语法糖）：

```
public bool Bold => this.Style.HasFlag(FontStyle.Bold); 
```

# r - 使用 RSQLite 在 R 中加入超过 2 个表

> ID：12307685
> 
> 赞同：2
> 
> 时间：2012-09-06T20:13:29.457
> 
> 标签：r, sqlite

我的数据库中有三个以上的表（t1，t2，t3）。我在 R 中使用 RSQLite。这些数据库由数据框组成。

```
+t1
  fileA valA
     a   12
     b   34
     c   78
     d   98
+t2
fileB valB
     b   45
     e   45
     f  452
     g    6
     d   89
+t3
fileC valC
     a   45
     b   34
     g   45
     i    3
     q    3 
```

让我们从简单的场景开始（实际上，我有 16 个以 GB 为单位的表要加入），我想以下列方式将上述 3 个表连接在一起。

* * *

## 预期结果

```
valA   valB   valC
a   12      NA      45
b   34      45      34
c   78      NA      NA
d   98      89      NA
e   NA      45      NA
f   NA      452     NA
......... 
```

我使用了以下命令，但没有得到两个表的预期结果：

```
 res <-dbSendQuery(con,"SELECT fileA,fileB,valA,valB from t1 LEFT OUTER JOIN t2 On t11.fileA= t2.fileB  UNION select fileA,fileB,valA,valB from t2 LEFT OUTER JOIN t1 ON t11.fileA= t2.fileB") 
```

* * *

## 上述命令的输出

```
fileA fileB valA valB
1  <NA>     e <NA>   45
2  <NA>     f <NA>  452
3  <NA>     g <NA>    6
4     a  <NA>   12   NA
5     b     b   34   45
6     c  <NA>   78   NA
7     d     d   98   89 
```

因此，如果我可以加入输出的前两列，我可以使用上述命令。（删除所有 NA 并仅保留名称，正如我在预期结果中提到的那样）

否则，如果有人能告诉我如何加入三个以上的表，那将会很有帮助。RSQLite 不支持 RIGHT 和 FULL OUTER JOIN

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T20:42:06.920

您可以将这些列与 SQLite [coalesce() 核心函数合并](http://www.sqlite.org/lang_corefunc.html#coalesce)：

```
 select coalesce(fileA,fileB),valA,valB
               from t1 LEFT OUTER JOIN t2 On t1.fileA= t2.fileB
UNION select coalesce(fileA,fileB),valA,valB
               from t2 LEFT OUTER JOIN t1 ON t1.fileA= t2.fileB 
```

# java - 是否可以在不将其添加到 JPanel 的情况下移动 JMenuBar

> ID：12307689
> 
> 赞同：0
> 
> 时间：2012-09-06T20:13:38.267
> 
> 标签：java, windows, swing, jpanel, jmenubar

我的 Java 应用程序中的 JMenuBar 位置存在问题。

我实际上使用的是[文章](http://tips4java.wordpress.com/2009/09/13/resizing-components/)中的 ComponentResizer.java 代码。

除了我的应用程序的北部区域（未装饰的 JFrame）及其角落（北部区域）之外，所有调整大小的东西都可以正常工作，因为 JMenuBar 阻止我从该区域调整大小。

是否有解决方案或黑客可以将 JMenuBar 向下移动一点或启用北部区域的调整大小？

我还使用`setJMenuBar()`方法将 JMenuBar 添加到我的应用程序的北部区域。

代码：

```
 public class MyApp extends JFrame {

private MyApp frame;
private JMenuBar menuBar;

public static void main(String[] args) {
    frame = new MyApp();
    frame.setUndecorated(true);
    frame.setVisible(true);
}
public MyApp(){
    initComponents();
}
private void initComponents(){
    setTitle("MediaForm");
    setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    setBounds(100, 100, 673, 482);
    menuBar = new JMenuBar();
    setJMenuBar(menuBar);
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T22:45:01.883

JMenuBar 扩展了 JComponent，因此您可以将它放在任何放置普通组件的位置。请注意，如果您将其放在意外位置，可能会使用户感到困惑。

另请参阅：[将 JMenuBar 添加到 JPanel？](https://stackoverflow.com/questions/4299846/add-jmenubar-to-a-jpanel)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T22:41:11.280

我没有对此进行测试，但它`JRootPane`是 a `JComponet`，可以添加 a `EmptyBorder`，允许`JMenuBar`偏移。

如果做不到这一点，您可能需要实现自己的`JRootPane`来管理`JMenuBar`& 内容窗格的布局

**更新测试**

```
public class TestMenuFrame extends JFrame {

    public TestMenuFrame() throws HeadlessException {

        setTitle("Test");

        getRootPane().setBorder(new EmptyBorder(10, 10, 10, 10));

        JMenuBar mb = new JMenuBar();
        mb.add(new JMenu("Test"));

        setJMenuBar(mb);

        setSize(100, 100);

        getContentPane().setBackground(Color.RED);

        setLocationRelativeTo(null);

    }

    /**
     * @param args the command line arguments
     */
    public static void main(String[] args) {

        new TestMenuFrame().setVisible(true);

    }
} 
```

![样本](../Images/72fd003949c30a1dcd9402ba30a4ba73.png)

# python - PyQt4：重启主循环？

> ID：12307696
> 
> 赞同：1
> 
> 时间：2012-09-06T20:14:10.510
> 
> 标签：python, events, pyqt4, forms

我有一个 PyQt4 类，它显示一个 html 表单并获取输入，这要归功于这里以前的[问题](https://stackoverflow.com/q/12240195/289572)（这里有一个[较旧的](https://stackoverflow.com/q/10121864/289572)问题）。

现在我想退出主循环，做些别的事情，然后用不同的 html 表单重新启动主循环。问题是，我的事件句柄在主循环的第二次执行中不起作用。我究竟做错了什么？

问题似乎是该类在第二次调用`MyWebPage`时无法正常工作`app.exec_()`，因为没有提交表单。

这是我运行的代码，但不提交第二种形式：

```
import sys
from urllib import unquote_plus

from PyQt4 import QtCore, QtGui, QtWebKit

class MyWebPage(QtWebKit.QWebPage):
    formSubmitted = QtCore.pyqtSignal(QtCore.QUrl)

    def acceptNavigationRequest(self, frame, req, nav_type):
        if nav_type == QtWebKit.QWebPage.NavigationTypeFormSubmitted:
            self.formSubmitted.emit(req.url())
        return super(MyWebPage, self).acceptNavigationRequest(frame, req, nav_type)

class PsyTML(QtGui.QWidget):
    def __init__(self):
        super(PsyTML, self).__init__()
        self.elements = {}
        self.view = QtWebKit.QWebView(self)
        layout = QtGui.QVBoxLayout(self)
        layout.addWidget(self.view)
        layout.setContentsMargins(0, 0, 0, 0)
        self.view.setPage(MyWebPage())
        self.view.page().formSubmitted.connect(self.handleFormSubmitted)

    def viewPsyTML(self, html):
        self.view.setHtml(html)
        self.show()

    def handleFormSubmitted(self, url):
        elements = self.elements
        self.close()
        for key, value in url.encodedQueryItems():
            key = unquote_plus(bytes(key)).decode('utf8')
            value = unquote_plus(bytes(value)).decode('utf8')
            elements[key] = value
        # do stuff with elements...
        for item in elements.iteritems():
            print '"%s" = "%s"' % item
        QtGui.qApp.quit()

# setup the html form
html = """
<form action="" method="get">
Like it?
<input type="radio" name="like" value="yes"/> Yes
<input type="radio" name="like" value="no" /> No
<br/><input type="text" name="text" value="" />
<input type="submit" name="submit" value="Send"/>
</form>
"""

html2 = """
<form action="" method="get">
Choose wisely?
<input type="radio" name="choose" value="A"/> Yes
<input type="radio" name="choose" value="B" /> No
<br/><input type="text" name="text" value="" />
<input type="submit" name="submit" value="Send"/>
</form>
"""

def main():
    app = QtGui.QApplication(sys.argv)
    intro = PsyTML()
    intro.viewPsyTML(html)
    # now, the html form is displayed nicely and the form elemtns returned
    app.exec_()
    # do something else here

    # in the secomd run, the form is not submitted.
    intro.viewPsyTML(html2)
    app.exec_()

if __name__ == "__main__":
    main() 
```

我正在使用 Python 2。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T23:56:24.823

您的程序的当前结构需要更改。

首先，`main`函数应该尽可能简单。它应该只创建一个应用程序对象和一个主窗口，然后运行事件循环。在那之后，一切都应该围绕信号/事件及其处理程序构建。

目前，只有一个中心事件：表单提交。这是*异步*发生的，因此应用程序必须保存其当前状态，然后被动地等待每个表单完成，然后才能继续执行下一个任务。

**编辑**

现在您的规范更加清晰，实现您想要的一种方法是使用 a `QDialog`，它有自己的事件循环。

这是您的脚本的修订版本，希望更接近您想要的：

```
import sys
from urllib import unquote_plus

from PyQt4 import QtCore, QtGui, QtWebKit

class MyWebPage(QtWebKit.QWebPage):
    formSubmitted = QtCore.pyqtSignal(object)

    def acceptNavigationRequest(self, frame, req, nav_type):
        if nav_type == QtWebKit.QWebPage.NavigationTypeFormSubmitted:
            elements = {}
            for key, value in req.url().encodedQueryItems():
                key = unquote_plus(bytes(key)).decode('utf8')
                value = unquote_plus(bytes(value)).decode('utf8')
                elements[key] = value
            self.formSubmitted.emit(elements)
        return super(MyWebPage, self).acceptNavigationRequest(frame, req, nav_type)

class PsyTML(QtGui.QDialog):
    def __init__(self):
        super(PsyTML, self).__init__()
        self.elements = {}
        self.view = QtWebKit.QWebView(self)
        layout = QtGui.QVBoxLayout(self)
        layout.addWidget(self.view)
        layout.setContentsMargins(0, 0, 0, 0)
        self.view.setPage(MyWebPage())
        self.view.page().formSubmitted.connect(self.handleFormSubmitted)

    def viewPsyTML(self, html):
        self.view.setHtml(html)
        self.exec_()

    def handleFormSubmitted(self, elements):
        self.elements = elements
        self.accept()

# setup the html form
html = """
<form action="" method="get">
Like it?
<input type="radio" name="like" value="yes"/> Yes
<input type="radio" name="like" value="no" /> No
<br/><input type="text" name="text" value="" />
<input type="submit" name="submit" value="Send"/>
</form>
"""

html2 = """
<form action="" method="get">
Choose wisely?
<input type="radio" name="choose" value="A"/> Yes
<input type="radio" name="choose" value="B" /> No
<br/><input type="text" name="text" value="" />
<input type="submit" name="submit" value="Send"/>
</form>
"""

def main():
    app = QtGui.QApplication(sys.argv)

    intro = PsyTML()
    intro.viewPsyTML(html)

    # do stuff with elements...
    for item in intro.elements.iteritems():
        print '"%s" = "%s"' % item

    intro = PsyTML()
    intro.viewPsyTML(html2)

if __name__ == "__main__":
    main() 
```

# python - 为什么我的 HTTP POST 请求数据字符串（可能）编码不正确？

> ID：12307699
> 
> 赞同：2
> 
> 时间：2012-09-06T20:14:23.047
> 
> 标签：python, http, twisted.web

我在使用 twisted.web.client.Agent 时遇到了一些问题......

我认为我的帖子请求中的字符串数据格式不正确。我正在尝试做一些类似于这个同步代码的事情：

```
from urllib import urlencode
import urllib2

page = 'http://example.com/'
id_string = 'this:is,my:id:string'

req = urllib2.Request(page, data=urlencode({'id': id_string}))  # urlencode call returns 'id=this%3Ais%2Cmy%3Aid%3Astring'
resp = urllib2.urlopen(req) 
```

以下是我现在构建代理请求的方式：

```
from urllib import urlencode
from StringIO import StringIO

page = 'http://example.com/'
id_string = 'my:id_string'

head = {'User-Agent': ['user agent goes here']}
data = urlencode({'id': id_string})

request = agent.request('POST', page, Headers(head), FileBodyProducer(StringIO(data)))
request.addCallback(foo) 
```

由于我得到的 HTTP 响应（空 JSON 字符串），我开始怀疑 POST 请求中的 id 没有正确编码，但我不确定我能做些什么。将 urlencode 与 Agent.request 调用一起使用是否有效？我应该用另一种方式对这些东西进行编码吗？

编辑： 一些 IRC 家伙建议问题可能源于我没有发送标头信息，表明数据是在 url 字符串中编码的。我对这类东西知之甚少......有人能指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T01:43:36.357

根据要求，这是我以答案形式发表的评论：

带有正文的 HTTP 请求应该设置 Content-Type 标头（告诉服务器如何解释正文中的字节）；在这种情况下，服务器似乎需要 URL 编码的数据，就像填写表单时 Web 浏览器会发送一样。

`urllib2.Request`显然为您默认了内容类型，但扭曲的库似乎需要手动设置它。在这种情况下，您需要一个内容类型`application/x-www-form-urlencoded`.

# jsf - socialauth - 您可以在重定向中使用相同的会话吗？

> ID：12307702
> 
> 赞同：3
> 
> 时间：2012-09-06T20:14:38.770
> 
> 标签：jsf, single-sign-on, socialauth

我正在尝试使用[socialauth](http://code.google.com/p/socialauth/wiki/GettingStarted/ "社会认证")登录 google、facebook 等（我将在此处假设 google），并对它的工作原理有疑问。我正在使用没有 Seam 的 JSF 2。基本思想是你：

*   进行一些 API 调用，表明您想使用 google 登录。

*   进行另一个 API 调用，该调用返回 google 的 URL。

*   提供一个结果 URL，google 将使用该 URL 重定向回您的站点。

*   重定向到谷歌网址。

*   然后谷歌将立即重定向回您的网站或首先询问登录详细信息。

我的困惑是将出站和入站的数据链接在一起。在*入门*页面（上面链接）中，他们建议这样做：

**出境**

```
SocialAuthManager manager = new SocialAuthManager();
String successUrl = "http://my.domain.com/socialauthd/successAction.xhtml";
String url = manager.getAuthenticationUrl(id, successUrl);
// Store in session
session.setAttribute("authManager", manager); 
```

**入站**

```
// get the auth provider manager from session
SocialAuthManager manager = (SocialAuthManager)session.getAttribute("authManager"); 
```

我遇到的问题是我看不到它是如何工作的，而且它在测试中也没有。他们建议在会话中存储对 SocialAuthManager 实例的引用，但是当从 google 收到请求时，会创建一个新会话。它没有 JSESSIONID cookie，因此不是首先向 google 发送请求的会话的一部分。

为了解决这个问题，我从 socialauth api (openid.assoc_handle - 它作为查询参数发送) 获得了一个唯一的每个请求 id，将它放在应用程序范围 bean 中的 concurrentHashMap 中，并在 preRenderView 侦听器中检索引用完成页面（successUrl - 在示例中命名错误，因为它被称为任何一种方式）。

对于文档中未包含的内容，这一切似乎很麻烦。尽管我通常使用 CODI @ViewAccessScoped，但我已经尝试使用 @RequestScoped CDI bean。使用 CODI，我尝试将 windowId 添加到成功 URL，并将 JSESSIONID cookie 添加到重定向，但两种方法都不起作用。我不认为 bean 范围是相关的，但信息越多越好。

我可以深入研究 spring、seam 和 struts 示例，但对于纯粹的 EE 6 开发人员来说，这是很多开销，并且通过更好地理解这个问题，我可以生成一个简单的、工作的、仅 JSF 的示例，我将提供给用于 google 代码的 socialauth 团队。

我是否遗漏了一些明显的东西，或者这只是很复杂？如果是这样，他们为什么要记录一种根本行不通的方法？

**编辑：**我认为successUrl 的命名可能比我想象的更合适，因为在使用Yahoo 进行测试时，我意识到除非提供正确的登录详细信息，否则您不会被重定向回自己的站点。我希望这对所有提供商都是一样的。我已向 socialauth 网站添加了一些关于此解决方案的评论，以及我记录的有关此问题的问题（两者都没有收到任何参与 socialauth 项目的人的任何回复）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T02:16:36.773

在回调 URL 中包含`jsessionid`路径参数。

```
String successUrl = "http://my.domain.com/socialauthd/successAction.xhtml"
    + ";jsessionid=" + session.getId(); 
```

请注意，这不是特定于 JSF API，而是特定于[Servlet API](http://jcp.org/aboutJava/communityprocess/final/jsr315/index.html)（第 7.1.3 章，URL 重写）。

# java - 迁移到 64 位后 JVM 崩溃

> ID：12307703
> 
> 赞同：4
> 
> 时间：2012-09-06T20:14:40.000
> 
> 标签：java, crash, garbage-collection, jvm, 64-bit

在我们将其迁移到 64 位后，我的应用程序开始崩溃。我们的生产 Linux 服务器每 2-3 天就会发生一次崩溃。我们正在使用 jdk1.6.0_15-x86_64。当我的应用程序使用 Xalan 转换器将 XSLT 转换为 HTML 时，崩溃发生在同一个地方。

我已经确认这不会发生在我们的 32 位服务器上，并且当应用程序不执行 XSLT 到 HTML 转换时也不会发生。所以只有在 64 位服务器上发生转换时才会发生这种情况。

任何帮助将不胜感激。

这是转储文件中的内容

```
 ######################################
    # A fatal error has been detected by the Java Runtime Environment:
    #
    #  SIGSEGV (0xb) at pc=0x00002b288a0457d1, pid=9161, tid=1213643072
    #
    # JRE version: 6.0_15-b03
    # Java VM: Java HotSpot(TM) 64-Bit Server VM (14.1-b02 mixed mode linux-amd64 )
    # Problematic frame:
    # V  [libjvm.so+0x3837d1]
    #
    # If you would like to submit a bug report, please visit:
    #   http://java.sun.com/webapps/bugreport/crash.jsp
    #

    ---------------  T H R E A D  ---------------

    Current thread (0x0000000044267800):  JavaThread "[default]-careers_ente_com-/resume_list_intermediate.html-76.125.192.80-B8FF993FA76C999A3568847142ECA47C.JS1-Thread-57504" daemon [_thread_in_vm, id=18390, stack(0x000000004846b000,0x000000004856c000)]

    siginfo:si_signo=SIGSEGV: si_errno=0, si_code=128 (), si_addr=0x0000000000000000

    Registers:
    RAX=0x0000000000000001, RBX=0x002f840f1fb10f4c, RCX=0x0000000000000000, RDX=0x0000000000000001
    RSP=0x0000000048569d50, RBP=0x0000000048569d70, RSI=0x0000000000000000, RDI=0x0000000043d7c830
    R8 =0x0000000000000001, R9 =0x00002aaab073f9d8, R10=0x00002b288a582c2a, R11=0x0000000044269a98
    R12=0x00002aaab07431c8, R13=0x0000000000000008, R14=0x0000000044267800, R15=0x0000000048569dd0
    RIP=0x00002b288a0457d1, EFL=0x0000000000010202, CSGSFS=0x0000000000000033, ERR=0x0000000000000000
      TRAPNO=0x000000000000000d

    Stack: [0x000000004846b000,0x000000004856c000],  sp=0x0000000048569d50,  free space=1019k
    Native frames: (J=compiled Java code, j=interpreted, Vv=VM code, C=native code)
    V  [libjvm.so+0x3837d1]
    V  [libjvm.so+0x3a2f72]
    j  com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet.addParameter(Ljava/lang/String;Ljava/lang/Object;Z)Ljava/lang/Object;+8
    j  hrxmlresume2html.topLevel(Lcom/sun/org/apache/xalan/internal/xsltc/DOM;Lcom/sun/org/apache/xml/internal/dtm/DTMAxisIterator;Lcom/sun/org/apache/xml/internal/serializer/SerializationHandler;)V+218
    j  hrxmlresume2html.transform(Lcom/sun/org/apache/xalan/internal/xsltc/DOM;Lcom/sun/org/apache/xml/internal/dtm/DTMAxisIterator;Lcom/sun/org/apache/xml/internal/serializer/SerializationHandler;)V+24
    j  com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet.transform(Lcom/sun/org/apache/xalan/internal/xsltc/DOM;Lcom/sun/org/apache/xml/internal/serializer/SerializationHandler;)V+9
    j  com.sun.org.apache.xalan.internal.xsltc.trax.TransformerImpl.transform(Ljavax/xml/transform/Source;Lcom/sun/org/apache/xml/internal/serializer/SerializationHandler;Ljava/lang/String;)V+152
    j  com.sun.org.apache.xalan.internal.xsltc.trax.TransformerImpl.transform(Ljavax/xml/transform/Source;Ljavax/xml/transform/Result;)V+119
    j  com.ente.hrxml.resume.HtmlConverter.toHtml(Lorg/jdom/Document;)Ljava/lang/String;+49
    j  com.ente.er.form.hrxmledit.generateHtmlResumeBuilder(Lcom/ente/erom/candidate/Candidate;Ljava/lang/String;)Ljava/lang/String;+42
    j  com.ente.er.form.hrxmledit.save()Lcom/ente/services/webui/UIStatus;+574
    j  com.ente.er.form.hrxmledit.postprocess()Lcom/ente/services/webui/UIStatus;+202

    Java frames: (J=compiled Java code, j=interpreted, Vv=VM code)
    j  com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet.addParameter(Ljava/lang/String;Ljava/lang/Object;Z)Ljava/lang/Object;+8
    j  hrxmlresume2html.topLevel(Lcom/sun/org/apache/xalan/internal/xsltc/DOM;Lcom/sun/org/apache/xml/internal/dtm/DTMAxisIterator;Lcom/sun/org/apache/xml/internal/serializer/SerializationHandler;)V+218
    j  hrxmlresume2html.transform(Lcom/sun/org/apache/xalan/internal/xsltc/DOM;Lcom/sun/org/apache/xml/internal/dtm/DTMAxisIterator;Lcom/sun/org/apache/xml/internal/serializer/SerializationHandler;)V+24
    j  com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet.transform(Lcom/sun/org/apache/xalan/internal/xsltc/DOM;Lcom/sun/org/apache/xml/internal/serializer/SerializationHandler;)V+9
    j  com.sun.org.apache.xalan.internal.xsltc.trax.TransformerImpl.transform(Ljavax/xml/transform/Source;Lcom/sun/org/apache/xml/internal/serializer/SerializationHandler;Ljava/lang/String;)V+152
    j  com.sun.org.apache.xalan.internal.xsltc.trax.TransformerImpl.transform(Ljavax/xml/transform/Source;Ljavax/xml/transform/Result;)V+119
    j  com.ente.hrxml.resume.HtmlConverter.toHtml(Lorg/jdom/Document;)Ljava/lang/String;+49
    j  com.ente.er.form.hrxmledit.generateHtmlResumeBuilder(Lcom/ente/erom/candidate/Candidate;Ljava/lang/String;)Ljava/lang/String;+42
    j  com.ente.er.form.hrxmledit.save()Lcom/ente/services/webui/UIStatus;+574
    j  com.ente.er.form.hrxmledit.postprocess()Lcom/ente/services/webui/UIStatus;+202
    J  com.ente.services.webui.Form.process()Lcom/ente/services/webui/UIStatus;
    j  com.ente.er.form.hrxmledit.process()Lcom/ente/services/webui/UIStatus;+1
    J  com.ente.services.webui.Form.eval(Lcom/ente/services/webui/Request;)V
    j  com.ente.services.webui.Nav.evalForm()V+232
    j  com.ente.services.webui.Nav.initPage()Lcom/ente/services/webui/Nav;+151
    j  com.ente.er.ERecruiter.getER(Ljavax/servlet/http/HttpServletRequest;Ljavax/servlet/http/HttpServletResponse;Z)Lcom/ente/er/ERecruiter;+353
    j  com.ente.er.ERecruiter.getER(Ljavax/servlet/http/HttpServletRequest;Ljavax/servlet/http/HttpServletResponse;)Lcom/ente/er/ERecruiter;+3
    j  jsp__careers_2eente_2ecom_80___resume_list_intermediate_2ehtml._jspService(Ljavax/servlet/http/HttpServletRequest;Ljavax/servlet/http/HttpServletResponse;)V+114
    j  org.gjt.jsp.HttpJspPageImpl.service(Ljavax/servlet/http/HttpServletRequest;Ljavax/servlet/http/HttpServletResponse;)V+3
    j  javax.servlet.http.HttpServlet.service(Ljavax/servlet/ServletRequest;Ljavax/servlet/ServletResponse;)V+29
    j  org.gjt.jsp.JspServlet$Page.process(Ljavax/servlet/http/HttpServletRequest;Ljavax/servlet/http/HttpServletResponse;)V+937
    j  org.gjt.jsp.JspServlet.xservice(Ljavax/servlet/http/HttpServletRequest;Ljavax/servlet/http/HttpServletResponse;Ljava/lang/String;)V+39
    j  org.gjt.jsp.JspServlet.service(Ljavax/servlet/http/HttpServletRequest;Ljavax/servlet/http/HttpServletResponse;)V+162
    j  javax.servlet.http.HttpServlet.service(Ljavax/servlet/ServletRequest;Ljavax/servlet/ServletResponse;)V+29
    j  org.apache.jserv.JServConnection.processRequest()V+627
    j  org.apache.jserv.JServConnection.run()V+80
    j  java.lang.Thread.run()V+11
    v  ~StubRoutines::call_stub

    Java Threads: ( => current thread )
    =>0x0000000044267800 JavaThread "[default]-careers_ente_com-/resume_list_intermediate.html-76.125.192.80-B8FF993FA76C999A3568847142ECA47C.JS1-Thread-57504" daemon [_thread_in_vm, id=18390, stack(0x000000004846b000,0x000000004856c000)]
      0x00000000447a1800 JavaThread "3C758A73EA22FCDE9E41A2149C9E8F43.JS1-Thread-54838" daemon [_thread_blocked, id=14006, stack(0x000000004836a000,0x000000004846b000)]
      0x00000000446a5000 JavaThread "108.243.174.151-3C758A73EA22FCDE9E41A2149C9E8F43.JS1-Thread-54742" daemon [_thread_in_native, id=13872, stack(0x000000004745b000,0x000000004755c000)]
      0x000000004400a800 JavaThread "TaskManager-IdleThread" daemon [_thread_blocked, id=20114, stack(0x0000000047057000,0x0000000047158000)]
      0x0000000044a8a800 JavaThread "TaskManager-IdleThread" daemon [_thread_blocked, id=9567, stack(0x0000000046d54000,0x0000000046e55000)]
      0x000000004479a800 JavaThread "TaskManager-IdleThread" daemon [_thread_blocked, id=9566, stack(0x0000000046c53000,0x0000000046d54000)]
      0x0000000044b2d800 JavaThread "TaskManager-IdleThread" daemon [_thread_blocked, id=9565, stack(0x0000000046b52000,0x0000000046c53000)]
      0x0000000043f6b800 JavaThread "TaskManager-IdleThread" daemon [_thread_blocked, id=9564, stack(0x00000000439a4000,0x0000000043aa5000)]
      0x0000000044214000 JavaThread "TaskManager-IdleThread" daemon [_thread_blocked, id=9327, stack(0x0000000043ba6000,0x0000000043ca7000)]
      0x0000000044018000 JavaThread "TaskManager-IdleThread" daemon [_thread_blocked, id=9326, stack(0x0000000043aa5000,0x0000000043ba6000)]
      0x00000000441bc800 JavaThread "TaskManager-IdleThread" daemon [_thread_blocked, id=9324, stack(0x0000000042893000,0x0000000042994000)]
      0x0000000044a89000 JavaThread "TaskManager-IdleThread" daemon [_thread_blocked, id=9323, stack(0x0000000040ec5000,0x0000000040fc6000)]
      0x0000000044923800 JavaThread "internal_careers_ente_com-Timer-Timer-13" daemon [_thread_blocked, id=9318, stack(0x00000000438a3000,0x00000000439a4000)]
      0x0000000045643800 JavaThread "ImportAgent-Timer-Timer-12" daemon [_thread_blocked, id=9317, stack(0x00000000437a2000,0x00000000438a3000)]
      0x00000000461e9000 JavaThread "internal_careers_ente_com-Retry-Timer-Timer-11" daemon [_thread_blocked, id=9316, stack(0x00000000436a1000,0x00000000437a2000)]
      0x000000004466a800 JavaThread "XPostDirector-Timer-Timer-10" daemon [_thread_blocked, id=9315, stack(0x00000000435a0000,0x00000000436a1000)]
      0x0000000044667800 JavaThread "internal_careers_ente_com-EventInformant1554828645.1" daemon [_thread_blocked, id=9314, stack(0x000000004349f000,0x00000000435a0000)]
      0x0000000044798800 JavaThread "internal_careers_ente_com-EventInformant1554828645.2" daemon [_thread_blocked, id=9313, stack(0x000000004339e000,0x000000004349f000)]
      0x0000000044797800 JavaThread "internal_careers_ente_com-EventInformant1554828645.3" daemon [_thread_blocked, id=9312, stack(0x000000004329d000,0x000000004339e000)]
      0x0000000043ff1000 JavaThread "internal_careers_ente_com-EventInformant1554828645.4" daemon [_thread_blocked, id=9311, stack(0x000000004319c000,0x000000004329d000)]
      0x0000000044795000 JavaThread "careers_ente_com-Retry-Timer-Timer-9" daemon [_thread_blocked, id=9310, stack(0x000000004309b000,0x000000004319c000)]
      0x0000000044792800 JavaThread "careers_ente_com-EventInformant190296991.1" daemon [_thread_blocked, id=9309, stack(0x0000000042f9a000,0x000000004309b000)]
      0x0000000046233800 JavaThread "careers_ente_com-EventInformant190296991.2" daemon [_thread_blocked, id=9308, stack(0x0000000042e99000,0x0000000042f9a000)]
      0x0000000046231800 JavaThread "careers_ente_com-EventInformant190296991.3" daemon [_thread_blocked, id=9307, stack(0x0000000042d98000,0x0000000042e99000)]
      0x0000000046231000 JavaThread "careers_ente_com-EventInformant190296991.4" daemon [_thread_blocked, id=9306, stack(0x0000000042c97000,0x0000000042d98000)]
      0x0000000044c0c000 JavaThread "LDAPConnThread ldap5.ente.com:389" daemon [_thread_in_native, id=9305, stack(0x0000000042b96000,0x0000000042c97000)]
      0x0000000044c0a000 JavaThread "LDAPConnThread ldap5.ente.com:389" daemon [_thread_in_native, id=9304, stack(0x0000000042a95000,0x0000000042b96000)]
      0x0000000044c0d800 JavaThread "LDAPConnThread ldap4.ente.com:389" daemon [_thread_in_native, id=9303, stack(0x0000000042994000,0x0000000042a95000)]
      0x0000000044c07800 JavaThread "LDAPConnThread ldap4.ente.com:389" daemon [_thread_in_native, id=9301, stack(0x0000000042691000,0x0000000042792000)]
      0x000000004597d000 JavaThread "LDAPConnThread ldap4.ente.com:389" daemon [_thread_in_native, id=9300, stack(0x0000000041723000,0x0000000041824000)]
      0x000000004404e000 JavaThread "OracleTimeoutPollingThread" daemon [_thread_blocked, id=9226, stack(0x0000000042792000,0x0000000042893000)]
      0x00002aab10677000 JavaThread "careers_ente_com-Timer-Timer-8" daemon [_thread_blocked, id=9224, stack(0x0000000042590000,0x0000000042691000)]
      0x00002aab1059a000 JavaThread "SessionReaper-Timer-7" daemon [_thread_blocked, id=9223, stack(0x000000004248f000,0x0000000042590000)]
      0x00002aab11230000 JavaThread "DebugListener-1234-Thread-16" daemon [_thread_in_native, id=9222, stack(0x000000004238e000,0x000000004248f000)]
      0x00002aab10628800 JavaThread "ImportAgent-Timer-Timer-6" daemon [_thread_blocked, id=9221, stack(0x00000000419ae000,0x0000000041aaf000)]
      0x00002aab106b0800 JavaThread "careers_ente_com-Retry-Timer-Timer-5" daemon [_thread_blocked, id=9219, stack(0x000000004020b000,0x000000004030c000)]
      0x00002aab104c9800 JavaThread "XPostDirector-Timer-Timer-4" daemon [_thread_blocked, id=9218, stack(0x00000000405c3000,0x00000000406c4000)]
      0x00002aab1056c000 JavaThread "careers_ente_com-EventInformant74291610.1" daemon [_thread_blocked, id=9216, stack(0x000000004228d000,0x000000004238e000)]
      0x00002aab1053e000 JavaThread "careers_ente_com-EventInformant74291610.2" daemon [_thread_blocked, id=9215, stack(0x000000004218c000,0x000000004228d000)]
      0x00002aab1048a800 JavaThread "careers_ente_com-EventInformant74291610.3" daemon [_thread_blocked, id=9214, stack(0x0000000041cd6000,0x0000000041dd7000)]
      0x00002aab104e9000 JavaThread "careers_ente_com-EventInformant74291610.4" daemon [_thread_blocked, id=9213, stack(0x00000000408ef000,0x00000000409f0000)]
      0x00002aab1021d800 JavaThread "CacheReporter-Timer-2" [_thread_blocked, id=9212, stack(0x000000004208b000,0x000000004218c000)]
      0x00002aab1000f800 JavaThread "StatsReporter-Timer-1" daemon [_thread_blocked, id=9211, stack(0x0000000041f8a000,0x000000004208b000)]
      0x00002aab10025800 JavaThread "LDAPConnThread ldap5.ente.com:389" daemon [_thread_in_native, id=9210, stack(0x0000000041e89000,0x0000000041f8a000)]
      0x000000004406d800 JavaThread "LDAPConnThread ldap5.ente.com:389" daemon [_thread_in_native, id=9209, stack(0x0000000041622000,0x0000000041723000)]
      0x000000004401e000 JavaThread "Periodic Collector-Timer-0" [_thread_blocked, id=9208, stack(0x00000000418ad000,0x00000000419ae000)]
      0x00002aab10003000 JavaThread "Thread-0" daemon [_thread_blocked, id=9186, stack(0x0000000040a6f000,0x0000000040b70000)]
      0x0000000043e0d000 JavaThread "Low Memory Detector" daemon [_thread_blocked, id=9184, stack(0x0000000041ad4000,0x0000000041bd5000)]
      0x0000000043e0a000 JavaThread "CompilerThread1" daemon [_thread_blocked, id=9183, stack(0x0000000041380000,0x0000000041481000)]
      0x0000000043e05800 JavaThread "CompilerThread0" daemon [_thread_blocked, id=9182, stack(0x0000000040753000,0x0000000040854000)]
      0x0000000043e03800 JavaThread "Signal Dispatcher" daemon [_thread_blocked, id=9181, stack(0x000000004010a000,0x000000004020b000)]
      0x0000000043ddf800 JavaThread "Finalizer" daemon [_thread_blocked, id=9180, stack(0x00000000414fe000,0x00000000415ff000)]
      0x0000000043dde000 JavaThread "Reference Handler" daemon [_thread_blocked, id=9179, stack(0x000000004127f000,0x0000000041380000)]
      0x0000000043d7f000 JavaThread "main" [_thread_in_native, id=9173, stack(0x000000004107d000,0x000000004117e000)]

    Other Threads:
      0x0000000043dd7000 VMThread [stack: 0x00000000403e4000,0x00000000404e5000] [id=9178]
      0x0000000043e0f000 WatcherThread [stack: 0x0000000041bd5000,0x0000000041cd6000] [id=9185]

    VM state:not at safepoint (normal execution)

    VM Mutex/Monitor currently owned by a thread:  ([mutex/lock_event])
    [0x0000000043d7c830] OsrList_lock - owner thread: 0x0000000044267800

    Heap
     PSYoungGen      total 471680K, used 20796K [0x00002aaaed940000, 0x00002aab0abe0000, 0x00002aab0abe0000)
      eden space 465664K, 4% used [0x00002aaaed940000,0x00002aaaeed8f0a8,0x00002aab0a000000)
      from space 6016K, 0% used [0x00002aab0a000000,0x00002aab0a000000,0x00002aab0a5e0000)
      to   space 5760K, 0% used [0x00002aab0a640000,0x00002aab0a640000,0x00002aab0abe0000)
     PSOldGen        total 955776K, used 110793K [0x00002aaab33e0000, 0x00002aaaed940000, 0x00002aaaed940000)
      object space 955776K, 11% used [0x00002aaab33e0000,0x00002aaaba012550,0x00002aaaed940000)
     PSPermGen       total 43072K, used 42828K [0x00002aaaadfe0000, 0x00002aaab09f0000, 0x00002aaab33e0000)
      object space 43072K, 99% used [0x00002aaaadfe0000,0x00002aaab09b32f8,0x00002aaab09f0000)

    VM Arguments:
    jvm_args: -Xms1400m -Xmx1400m -Djava.protocol.handler.pkgs=com.sun.net.ssl.internal.www.protocol -Dsecurity.provider.1=com.sun.net.ssl.internal.ssl.Provider -Der.logfile=var/log/e-Recruiter.log -Dsun.net.inetaddr.ttl=7200 -DHTMLDOCPATH=/usr/bin/htmldoc -Doracle.jdbc.V8Compatible=true -Dldap.enable=true -Dldap.path=ldap://recruiter:recruiter@ldap4.ente.com:389,ldap5.ente.com:389,ldap6.ente.com:389/er-10.15.0.2 
    java_command: org.apache.jserv.JServ etc/jserv.properties
    Launcher Type: SUN_STANDARD

    Environment Variables:
    JAVA_HOME=
    PATH=/sbin:/usr/sbin:/bin:/usr/bin
    USERNAME=root
    LD_LIBRARY_PATH=/usr/local/ente-20080222/Sun/jdk1.6.0_15-x86_64/jre/lib/amd64/server:/usr/local/ente-20080222/Sun/jdk1.6.0_15-x86_64/jre/lib/amd64:/usr/local/ente-20080222/Sun/jdk1.6.0_15-x86_64/jre/../lib/amd64:/usr/local/ente/Oracle/client/lib
    SHELL=/bin/bash
    _JAVA_SR_SIGNUM=12

    Signal Handlers:
    SIGSEGV: [libjvm.so+0x6bdd00], sa_mask[0]=0x7ffbfeff, sa_flags=0x10000004
    SIGBUS: [libjvm.so+0x6bdd00], sa_mask[0]=0x7ffbfeff, sa_flags=0x10000004
    SIGFPE: [libjvm.so+0x594ed0], sa_mask[0]=0x7ffbfeff, sa_flags=0x10000004
    SIGPIPE: [libjvm.so+0x594ed0], sa_mask[0]=0x7ffbfeff, sa_flags=0x10000004
    SIGXFSZ: [libjvm.so+0x594ed0], sa_mask[0]=0x7ffbfeff, sa_flags=0x10000004
    SIGILL: [libjvm.so+0x594ed0], sa_mask[0]=0x7ffbfeff, sa_flags=0x10000004
    SIGUSR1: SIG_DFL, sa_mask[0]=0x00000000, sa_flags=0x00000000
    SIGUSR2: [libjvm.so+0x597690], sa_mask[0]=0x00000000, sa_flags=0x10000004
    SIGHUP: [libjvm.so+0x5973e0], sa_mask[0]=0x7ffbfeff, sa_flags=0x10000004
    SIGINT: SIG_IGN, sa_mask[0]=0x00000000, sa_flags=0x00000000
    SIGTERM: [libjvm.so+0x5973e0], sa_mask[0]=0x7ffbfeff, sa_flags=0x10000004
    SIGQUIT: [libjvm.so+0x5973e0], sa_mask[0]=0x7ffbfeff, sa_flags=0x10000004

    ---------------  S Y S T E M  ---------------

    OS:CentOS release 5.4 (Final)

    uname:Linux 2.6.18-164.15.1.el5 #1 SMP Wed Mar 17 11:30:06 EDT 2010 x86_64
    libc:glibc 2.5 NPTL 2.5 
    rlimit: STACK 10240k, CORE 0k, NPROC infinity, NOFILE 1024, AS infinity
    load average:0.00 0.00 0.00

    CPU:total 2 (1 cores per cpu, 1 threads per core) family 6 model 26 stepping 4, cmov, cx8, fxsr, mmx, sse, sse2, sse3, ssse3, sse4.1, sse4.2

    Memory: 4k page, physical 4044572k(274688k free), swap 2031608k(2031532k free)

    vm_info: Java HotSpot(TM) 64-Bit Server VM (14.1-b02) for linux-amd64 JRE (1.6.0_15-b03), built on Jul  2 2009 15:26:16 by "java_re" with gcc 3.2.2 (SuSE Linux)

    time: Sun Aug 12 21:34:09 2012
    elapsed time: 162182 seconds 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T20:29:21.190

我建议增加 perm gen 空间（-XX:MaxPermSize）并在其上启用 GC（-XX:+CMSPermGenSweepingEnabled）——40M 并不多！如果您要加载很多库，我还建议启用类卸载 (-XX:+CMSClassUnloadingEnabled)。请注意，如果您确实确实存在内存泄漏，这只会在崩溃之间为您提供更多喘息空间，您仍然需要修复根本原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T20:18:39.927

```
 PSPermGen       total 43072K, used 42828K [0x00002aaaadfe0000, 0x00002aaab09f0000, 0x00002aaab33e0000)
      object space 43072K, 99% used [0x00002aaaadfe0000,0x00002aaab09b32f8,0x00002aaab09f0000) 
```

似乎您的 permgen 已损坏，这可能是由于您的代码试图加载库。我怀疑以下代码加载的库可能与 64 位 JVM 不兼容。

在使用 JVM 提交错误之前，我会按照代码行检查程序，这似乎是罪魁祸首。

```
 com.ente.hrxml.resume.HtmlConverter.toHtml(Lorg/jdom/Document;)Ljava/lang/String;+49 
```

# android - 将文本更改为数据库值

> ID：12307704
> 
> 赞同：0
> 
> 时间：2012-09-06T20:14:42.180
> 
> 标签：android, database, sqlite, text

当按下按钮时，我想将文本更改为数据库列值，我知道它错了，但这里是代码：

```
 private void MostraDados() {
    // TODO Auto-generated method stub
    final TextView text = (TextView) findViewById(R.id.tvUSUARIO);

    Button mostrar = (Button) findViewById(R.id.bMostrar);
    mostrar.setOnClickListener(new OnClickListener() {

        public void onClick(View v) {
            // TODO Auto-generated method stub

            db = openOrCreateDatabase("dbtest.db", Context.MODE_PRIVATE, null);

            String q = "SELECT * FROM dbtest.db WHERE usuarioorigem='";

            text.setText(q);

            //text.execSQL("DROP COLUMN IF EXISTS usuarioorigem");
        }
    });
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T20:30:33.787

SQL 编写不正确。您必须从列中选择。并且您正在将查询字符串传递给文本视图。您应该首先回顾如何使用游标查询数据库，以及如何从游标中检索您想要的内容。

所以我会研究如何使用 curosr，所有这些都在 Android 文档中可用，你可能想在模拟器中尝试 API 演示，我相信你也可以在那里学习如何使用光标。所以看这里，[http://developer.android.com/reference/android/database/Cursor.html](http://developer.android.com/reference/android/database/Cursor.html)。

在这里，[Android Cursor.moveToNext() 文档是否正确？](https://stackoverflow.com/questions/5985753/is-android-cursor-movetonext-documentation-correct).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T21:23:11.003

获得光标后，您可以执行以下操作：

```
while(c.moveToNext(){

text.setText(c.getString(0))

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-06T22:12:54.377

您的代码缺少一些关键部分，例如管理游标和数据库的 DatabaseClass。

```
private void MostraDados() {

final TextView text = (TextView) findViewById(R.id.tvUSUARIO);

Button mostrar = (Button) findViewById(R.id.bMostrar);
mostrar.setOnClickListener(new OnClickListener() {

    public void onClick(View v) {
        // our missing a database helper
        MyDatabaseClass dbhelper = new MyDatabaseClass();
        dbhelper.open();

        Cursor result = dbhelper.doMyQuery();
        String mystring = result.getString(0);

        text.setText(mystring);

        dbhelper.close();
    }
});
....
public class WorkoutDbAdapter {
    ....
    public Cursor doMyQuery()
    {
        return this.mDb.query( yourQuery );
    }

} 
```

这是您需要的最低要求，即使有了上述内容，我也遗漏了很多较小的细节。搜索有关创建和使用数据库的一些教程。

但是本质上，您需要取回光标，设置光标的位置，或者 cursor.moveNext()，然后获取可以分配给 textField 的值。

您的源代码缺少对数据库的正确调用和对游标的访问。希望您能找到一些体面的教程，为您充实其余部分。

# debugging - 用plone.app.debugtoolbar解决paste.evalexception ImportError？

> ID：12307705
> 
> 赞同：0
> 
> 时间：2012-09-06T20:14:46.913
> 
> 标签：debugging, plone, buildout

我正在尝试将 plone.app.debugtoolbar 包含到我的 plone4.2 构建中，但遇到了马丁公告结尾处描述的相同“ImportError：没有名为 paste.evalexception 的模块”：[http://plone.293351.n2 .nabble.com/ANN-plone-app-debugtoolbar-td6988915.html](http://plone.293351.n2.nabble.com/ANN-plone-app-debugtoolbar-td6988915.html)。这让我认为依赖关系已经修复，但我仍然得到它？

```
 File "/home/rik/Plone/buildout-cache/eggs/plone.app.debugtoolbar-1.0a2-py2.7.egg/plone/app/debugtoolbar/browser/interactive.py", line 10, in <module>
    from paste.evalexception import evalcontext
zope.configuration.xmlconfig.ZopeXMLConfigurationError: File "/home/rik/Plone/zeocluster/parts/client1/etc/site.zcml", line 16.2-16.23
    ZopeXMLConfigurationError: File "/home/rik/Plone/buildout-cache/eggs/Products.CMFPlone-4.2.0.1-py2.7.egg/Products/CMFPlone/configure.zcml", line 102.4-106.10
    ZopeXMLConfigurationError: File "/home/rik/Plone/buildout-cache/eggs/plone.app.debugtoolbar-1.0a2-py2.7.egg/plone/app/debugtoolbar/configure.zcml", line 10.2-10.32
    ZopeXMLConfigurationError: File "/home/rik/Plone/buildout-cache/eggs/plone.app.debugtoolbar-1.0a2-py2.7.egg/plone/app/debugtoolbar/browser/configure.zcml", line 113.4-120.10
    ImportError: No module named paste.evalexception 
```

这是否需要一些补丁，固定贴纸......？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T15:58:18.470

只需将对 Paste 的显式依赖添加到我的构建中：

```
devtools = 
    ...
    Paste
    plone.app.debugtoolbar 
```

成功了！我仍然不确定为什么这种依赖关系不是/不能成为 plone.app.debugtoolbar 的一部分，但它似乎确实是一个完全内部构建问题并且与“外部”外壳的 python 无关，如@Martijn我在上面追求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T20:33:08.060

你错过了`Paste`鸡蛋；在某些情况下，这个鸡蛋嵌套在你的构建中的一个开发鸡蛋中，这会混淆构建并且它不会安装它。

解决方法是手动安装：

```
python -m easy_install Paste 
```

# samsung-mobile - Plasma SDK 中的 PlasmaTester 在没有任何更改的情况下无法工作

> ID：12307718
> 
> 赞同：1
> 
> 时间：2012-09-06T20:15:34.443
> 
> 标签：samsung-mobile, plasma

我已经从这里下载了 Plasma sdk：http: [//innovator.samsungmobile.com/cms/cnts/knowledge.detail.view.do](http://innovator.samsungmobile.com/cms/cnts/knowledge.detail.view.do?cntsId=9986&platformId=1) ?cntsId=9986&platformId=1并尝试运行 PlasmaTester。我正在使用 Android 4.0.3 和 Plasma SDK 1.80.0 在 Galaxy Note 上进行测试。

选择简单购买后 --> 项目 1 --> 支付选项 - 信用卡 --> 输入密码（正确 - 见附件，当密码不正确时消息不同）并点击“购买”我得到了“过程错误”警报。我应该怎么做才能修复它？

# sql-server - LoadFromSQLServer 方法遇到了 OLE DB

> ID：12307721
> 
> 赞同：2
> 
> 时间：2012-09-06T20:15:55.227
> 
> 标签：sql-server, dtexec

我有这个错误：

> LoadFromSQLServer 方法遇到 OLE DB 错误代码 0x80004005（登录超时已过期）。发出的 SQL 语句失败

这是我的代码，有什么问题？

```
DECLARE @FileName VARCHAR(50); 
DECLARE @VendorID VARCHAR(50); 
DECLARE @sql VARCHAR(2000); 
DECLARE @Local_File_FullPath VARCHAR(100);   

SET @FileName = 'Extgt_skinny_file.txt.pgp' 
Set @VendorID = 'ET' 

Select @Local_File_FullPath = dw03_path  FROM GMAC_META.dbo.VENDOR_XFER_METADATA where vendor_id = @VendorID 

SET @sql = 'dtexec /SQL "\EMAP_FTP_XFER_CHECK" /SET \Package.Variables[User::FileName].Properties[Value];"' 
+ @FileName+'" /SET \Package.Variables[Local_File_FullPath].Properties[Value];' 
+ @Local_File_FullPath+' /SERVER "hqgmdw02/dw_dev"   /CHECKPOINTING OFF /REPORTING E'

 exec xp_cmdshell @sql 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T20:55:57.717

尝试以下操作：

`GRANT exec ON xp_cmdshell TO '<somelogin>'`. 请参考[xp_cmdshell (Transact-SQL)](http://msdn.microsoft.com/en-us/library/ms175046.aspx)。

检查您是否在 64 位计算机上使用 32 位 DTExec。

确保将运行 SSIS 包的用户具有足够的权限。我认为您在 SQL Server 代理中的 SSIS 下运行，或者您可以手动运行它。运行 SQL 代理的服务帐户和您的帐户必须具有执行作业的权限。请参阅[通过代理执行 SSIS 包时出错](http://social.technet.microsoft.com/Forums/en-US/sqlintegrationservices/thread/68de81bd-b9cf-46fc-a200-e4143c1d19c4#e9198db6-059f-411b-938a-584097f91a16)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-05-10T09:41:49.787

正如 OP 所提到的，服务器路由（用于参数`/SERVER`）应该使用反斜杠而不是普通斜杠。在这种情况下，显示的错误有点误导，因为登录超时是因为服务器路径不正确。

所以改变

```
/SERVER "hqgmdw02/dw_dev" 
```

为了

```
/SERVER "hqgmdw02\dw_dev" 
```

# javascript - Jquery幻灯片从一行左侧的图像开始，但我希望它从右端开始

> ID：12307726
> 
> 赞同：-2
> 
> 时间：2012-09-06T20:16:08.693
> 
> 标签：javascript, jquery

我正在使用这个 javascript，幻灯片从右到左滑动，图像按以下顺序和位置：

起始位置 > 1 | 2 | 3 | 4 | 5 | 6等

但我想交换它们，让它们在这个位置上运行

6 | 5 | 4 | 3 | 2 | 1 < 起始位置

有点像从头到尾读一本书，但要保持正确的顺序

我被告知我需要修改下面标记的行：//MODIFY ME

我希望有人能帮帮忙！谢谢

这是我的代码

```
 (function($) {
        $.fn.slideshow = function(method) {
if ( this[0][method] ) {
    return this[0][ method ].apply( this, Array.prototype.slice.call( arguments, 1 ));
} else if ( typeof method === 'object' || ! method ) {
    return this.each(function() {
        var ANIMATION_DURATION = .6;        // The duration to flick the content. In seconds.
        var MOVE_THRESHOLD = 10;            // Since touch points can move slightly when initiating a click this is the
                                            // amount to move before allowing the element to dispatch a click event.

        var itemWidth;
        var horizontalGap;
        var $this = $(this);
        var collection;

        var viewItems = [];

        var touchStartTransformX;           // The start transformX when the user taps.
        var touchStartX;                    // The start x coord when the user taps.
        var interval;                       // Interval used for measuring the drag speed.
        var wasContentDragged;              // Flag for whether or not the content was dragged. Takes into account MOVE_THRESHOLD.
        var targetTransformX;               // The target transform X when a user flicks the content.
        var touchDragCoords = [];           // Used to keep track of the touch coordinates when dragging to measure speed.
        var touchstartTarget;               // The element which triggered the touchstart.
        var selectedIndex = 0;              // The current visible page.
        var viewPortWidth;                  // The width of the div that holds the horizontal content.

        var isAnimating;

        var pageChangedLeft;

        // The x coord when the items are reset.
        var resetX;

        var delayTimeout;

        init(method);

        function init(options) {
            collection = options.data;
            renderer = options.renderer;
            itemWidth = options.itemWidth;
            horizontalGap = options.horizontalGap;

            initLayout();

            $this[0].addEventListener("touchstart", touchstartHandler);
            $this[0].addEventListener("mousedown", touchstartHandler);

            viewPortWidth = $this.width();
            $this.on("webkitTransitionEnd", transitionEndHandler);
            collection.on("add", addItem);
        }

    // MODIFY ME

        function initLayout() {
            // Layout five items. The one in the middle is always the selected one.
            for (var i = 0; i < 5; i++) {
                var viewItem;
                if (i > 1 && collection.at(i - 2)) // Start at the one in the middle. Subtract 2 so data index starts at 0.
                    viewItem = new renderer({model: collection.at(i - 2)});
                else
                    viewItem = new renderer();

                viewItem.render().$el.appendTo($this);
                viewItem.$el.css("left", itemWidth * i + horizontalGap * i);

                viewItem.setState(i != 2 ? "off" : "on");

                viewItems.push(viewItem);
            }

            // Center the first viewItem
            resetX = itemWidth * 2 - ($this.width() - itemWidth - horizontalGap * 4) / 2;
            setTransformX(-resetX);
        }

        function getCssLeft($el) {
            var left = $el.css("left");
            return Number(left.split("px")[0]);
        }

    // MODIFY ME

        function transitionEndHandler() {
            if (pageChangedLeft != undefined) {
                var viewItem;
                if (pageChangedLeft) {
                    // Move the first item to the end.
                    viewItem = viewItems.shift();
                    viewItems.push(viewItem);
                    viewItem.model = collection.at(selectedIndex + 2);
                    viewItem.$el.css("left", getCssLeft(viewItems[3].$el) + itemWidth + horizontalGap);
                } else {
                    // Move the last item to the beginning.
                    viewItem = viewItems.pop();
                    viewItems.splice(0, 0, viewItem);
                    viewItem.model = collection.at(selectedIndex - 2);
                    viewItem.$el.css("left", getCssLeft(viewItems[1].$el) - itemWidth - horizontalGap);
                }

                viewItem.render();

                // Reset the layout of the items.
                for (var i = 0; i < 5; i++) {
                    var viewItem = viewItems[i];
                    viewItem.$el.css("left", itemWidth * i + horizontalGap * i);

                    viewItem.setState(i != 2 ? "off" : "on");
                }

                // Reset the transformX so we don't run into any rendering limits. Can't find a definitive answer for what the limits are.
                $this.css("-webkit-transition", "none");
                setTransformX(-resetX);

                pageChangedLeft = undefined;
            }
        }

        function touchstartHandler(e) {
            clearInterval(interval);

            wasContentDragged = false;

            transitionEndHandler();

            // Prevent the default so the window doesn't scroll and links don't open immediately.
            e.preventDefault(); 

            // Get a reference to the element which triggered the touchstart.
            touchstartTarget = e.target;

            // Check for device. If not then testing on desktop.
            touchStartX = window.Touch ? e.touches[0].clientX : e.clientX;

            // Get the current transformX before the transition is removed.
            touchStartTransformX = getTransformX();

            // Set the transformX before the animation is stopped otherwise the animation will go to the end coord
            // instead of stopping at its current location which is where the drag should begin from.
            setTransformX(touchStartTransformX);

            // Remove the transition so the content doesn't tween to the spot being dragged. This also moves the animation to the end.
            $this.css("-webkit-transition", "none");

            // Create an interval to monitor how fast the user is dragging.
            interval = setInterval(measureDragSpeed, 20);

            document.addEventListener("touchmove", touchmoveHandler);
            document.addEventListener("touchend", touchendHandler);
            document.addEventListener("mousemove", touchmoveHandler);
            document.addEventListener("mouseup", touchendHandler);
        }

        function measureDragSpeed() {
            touchDragCoords.push(getTransformX());
        }

        function touchmoveHandler(e) {
            var deltaX = (window.Touch ? e.touches[0].clientX : e.clientX) - touchStartX;
            if (wasContentDragged || Math.abs(deltaX) > MOVE_THRESHOLD) { // Keep track of whether or not the user dragged.
                wasContentDragged = true;
                setTransformX(touchStartTransformX + deltaX);
            }
        }

        function touchendHandler(e) {
            document.removeEventListener("touchmove", touchmoveHandler);
            document.removeEventListener("touchend", touchendHandler);
            document.removeEventListener("mousemove", touchmoveHandler);
            document.removeEventListener("mouseup", touchendHandler);

            clearInterval(interval);

            e.preventDefault();

            if (wasContentDragged) { // User dragged more than MOVE_THRESHOLD so transition the content. 
                var previousX = getTransformX();
                var bSwitchPages;
                // Compare the last 5 coordinates
                for (var i = touchDragCoords.length - 1; i > Math.max(touchDragCoords.length - 5, 0); i--) {
                    if (touchDragCoords[i] != previousX) {
                        bSwitchPages = true;
                        break;
                    }
                }

                // User dragged more than halfway across the screen.
                if (!bSwitchPages && Math.abs(touchStartTransformX - getTransformX()) > (viewPortWidth / 2))
                    bSwitchPages = true;

                if (bSwitchPages) {
                    if (previousX > touchStartTransformX) { // User dragged to the right. go to previous page.
                        if (selectedIndex > 0) { // Make sure user is not on the first page otherwise stay on the same page.
                            selectedIndex--;
                            tweenTo(touchStartTransformX + itemWidth + horizontalGap);
                            pageChangedLeft = false;
                        } else {
                            tweenTo(touchStartTransformX);
                            pageChangedLeft = undefined;
                        }
                    } else { // User dragged to the left. go to next page.
                        if (selectedIndex + 1 < collection.length) {// Make sure user is not on the last page otherwise stay on the same page.
                            selectedIndex++;
                            tweenTo(touchStartTransformX - itemWidth - horizontalGap);
                            pageChangedLeft = true;
                        } else {
                            tweenTo(touchStartTransformX);
                            pageChangedLeft = undefined;
                        }
                    }
                } else {
                    tweenTo(touchStartTransformX);
                    pageChangedLeft = undefined;
                }
            } else { // User dragged less than MOVE_THRESHOLD trigger a click event.
                var event = document.createEvent("MouseEvents");
                event.initEvent("click", true, true);
                touchstartTarget.dispatchEvent(event);
            }
        }

        // Returns the x of the transform matrix.
        function getTransformX() {
            var transformArray = $this.css("-webkit-transform").split(","); // matrix(1, 0, 0, 1, 0, 0)
            var transformElement = $.trim(transformArray[4]); // remove the leading whitespace.
            return transformX = Number(transformElement); // Remove the ). 
        }

        // Sets the x of the transform matrix.
        function setTransformX(value) {
            $this.css("-webkit-transform", "translateX("+ Math.round(value) + "px)");
        }

        function tweenTo(value) {
            isAnimating = true;
            targetTransformX = value;
            // Set the style for the transition.
            $this.css("-webkit-transition", "-webkit-transform " + ANIMATION_DURATION + "s");

            // Need to set the timing function each time -webkit-transition is set.
            // The transition is set to ease-out.
            $this.css("-webkit-transition-timing-function", "cubic-bezier(0, 0, 0, 1)");
            setTransformX(targetTransformX);
        }
                    // MODIFY ME

        function addItem(folio) {
            clearTimeout(delayTimeout);
            // Create a timeout in case multiple items are added in the same frame.
            // When the timeout completes all of the view items will have their model
            // updated. The renderer should check to make sure the model is different
            // before making any changes.
            delayTimeout = setTimeout(function(folio) {
                var index = collection.models.indexOf(folio);
                var dataIndex = index;
                var firstIndex = selectedIndex - 2;
                var dataIndex = firstIndex;
                var viewItem;
                for (var i = 0; i < viewItems.length; i++) {
                    viewItem = viewItems[i];

                    if (dataIndex >= 0 && dataIndex < collection.length) {
                        viewItem.model = collection.at(dataIndex);
                        viewItem.render();
                    }

                    viewItem.setState(i != 2 ? "off" : "on");

                    dataIndex += 1;
                }
            }, 200);
        }

        // Called when the data source has changed. Resets the view with the new data source.
        this.setData = function(data) {
            $this.empty();
            viewItems = [];
            collection = data;
            selectedIndex = 0;
            initLayout();
        }
    });
} else {
    $.error( 'Method ' +  method + ' does not exist on Slideshow' );
} 
    }
    })(jQuery); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T21:12:05.187

据我所知，您需要简单地“翻转”在幻灯片中创建侧面的循环，以便它在制作第一张幻灯片的地方制作最后一张幻灯片。它似乎在两个地方这样做。

然后，您需要修改添加幻灯片的代码，使其在其他幻灯片之前而不是之后添加。

这听起来很像家庭作业——最好先尝试回答，然后再在这里提问。像 JSFiddle 这样的网站上的示例也普遍受到赞赏。

# ruby-on-rails - Ruby on Rails 3.2 使用下拉列表创建表单错误

> ID：12307729
> 
> 赞同：0
> 
> 时间：2012-09-06T20:16:17.330
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我是 Ruby on Rails 新手，在使用 Create 表单上的下拉菜单时遇到问题。这是我收到的错误：

nil:NilClass 的未定义方法 `map' 提取的源代码（第 8 行附近）：

5: :message => "您必须修复以下字段：", 6: :header_tag => :h3 %> --> 7: 8: <%= f.select :subCategoryId, options_for_select(@subcategories_for_select, {:prompt => '选择一个子类别...'}) %> 9: 10: <%=f.label :name%> 11: <%=f.text_field :name%>

**这是我的 new.html.erb：**

# 新设备

"无效设备！", :message => "您必须修复以下字段：", :header_tag => :h3 %> --> '选择子类别...'}) %>

如果您在不从下拉列表中选择值的情况下提交表单，我希望会显示验证错误。

注意：如果我删除下拉菜单，我的创建表单就可以正常工作。

我将不胜感激任何可以向我展示我做错了什么的人的帮助。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T21:48:58.813

我将原始选择中的变量 @subcategories_for_select 换成了以下内容：

```
<%= select("SubCategory", "name", options_for_select(SubCategory.all.map{ |p| [p.name, p.id, {:class => p.category_id}] }), {:prompt => 'Select a SubCategory...'}) %> 
```

现在一切正常！

# c++ - C++：为什么会出现分段错误？

> ID：12307732
> 
> 赞同：0
> 
> 时间：2012-09-06T20:16:33.600
> 
> 标签：c++, segmentation-fault

这是我的代码：

```
#include <iostream>
#include <stdio.h>
#include <stdlib.h>

using namespace std;

struct Computer
{
    char * model;
    char * assembler;
    int processorInt;
};

int main()
{
    Computer comp;
    char* model;
    char* assembler;
    int processorInt;

    cin>>model;
    cin>>assembler;
    cin>>processor int;

    comp.model = model;
    comp.assembler = assembler;
    comp.processorInt = processorInt;

    return 0;
} 
```

//如果我这样做，它可以工作，但是如果我以另一种方式这样做，它会给出分段错误

```
#include <iostream>
#include <stdio.h>
#include <stdlib.h>

using namespace std;

struct Computer
{
    char * model;
    char * assembler;
    int processorInt;
};

void setValues()
{
    Computer comp;
    char* model;
    char* assembler;
    int processorInt;

    cin>>model;
    cin>>assembler;
    cin>>processor int;

    comp.model = model;
    comp.assembler = assembler;
    comp.processorInt = processorInt;
}

int main()
{
    setValues();

    return 0;
} 
```

那么是什么原因呢？

我的目标是创建一个结构数组，我可以在其中保存有关每台“计算机”的一些信息，然后可以编辑任何结构，然后通过procesorInt 对整个数组进行排序。但我什至不能创建一个正常的可编辑结构。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-06T20:19:49.210

您正在阅读一个`char`没有指向任何地方的指针。没有空间存储读取的字符。

使用 a 更容易`std::string`，因为它会自动调整自身大小以保存输入中的旧字符。

```
Computer comp;
std::string model;
std::string assembler;
int processorInt;

cin>>model;
cin>>assembler;
cin>>processorInt; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-06T20:20:53.147

这两个版本都不起作用，您正在尝试将数据读入未初始化的指针。仅仅声明 eg`char* model;`会给你一个未初始化的指针：它可以指向内存中的任何位置。当您尝试使用在该位置存储字符串时，`cin >>`您将写入不属于您的内存。这可能会出现段错误，或者它可能看起来有效。

只是声明`char*`不会给你字符串空间：如果你使用标准 C 字符串，那么你需要给它们一些数据：使你的`char`指针数组具有固定大小，或用于`malloc`分配字符串缓冲区：

```
char model[MAX_STRING_LENGTH]; 
```

或者使用 malloc，但请注意，稍后您将需要`free`此内存：

```
char *model = malloc(MAX_STRING_LENGTH); 
```

现在，如果您要同时使用标准 C 字符串`cin`，则根本不应该使用`>>`：没有办法限制输入大小。而是使用[`cin.getline`](http://www.cplusplus.com/reference/iostream/istream/getline/)with`MAX_STRING_LENGTH`作为限制（有关详细信息，请参阅文档中的示例）。

但绝对更喜欢`std::string`改用：如果你这样做，那么你不需要自己为字符串提供空间，你的代码根本不需要改变太多。

# c# - 将点减少到只需要绘制的点

> ID：12307733
> 
> 赞同：2
> 
> 时间：2012-09-06T20:16:34.580
> 
> 标签：c#, wpf, graphics, drawing, geometry

我有一个大的复杂几何图形，我正在绘制一个 256x256 像素的图块。几何由相当密集的区域和更稀疏的区域组成。这意味着使用诸如 douglas-peucker 之类的 reduce 算法在这种情况下不会产生非常好的结果。

我想做的只是包括尚未绘制的几何图形中的像素。IE 我可以有一个从 x=0,y=0 到 x=256,y=256 的几何图形。然后我有一个从 x=0,y=0 到 x=0,y=256 到 x=256,y=256 的几何图形。因此，因为我已经从第一个几何图形中有效地绘制了 x=0,y=0 和 x=256,y=256，所以我只需要包含并绘制第二个几何图形的 x=0,y=256。

目前，我有 100 的数千个点试图在图块上渲染，大约需要一分钟才能完成。有什么我可以消除已经绘制的点而不会丢失任何几何细节的吗？

谢谢

# android - 按钮在软糖中消失了

> ID：12307736
> 
> 赞同：3
> 
> 时间：2012-09-06T20:16:37.080
> 
> 标签：android, android-layout

我的应用程序通过 jellybean 更新工作正常，除了登录按钮是不可见的......可点击......但你只是看不到它。

这是按钮代码

```
<Button
        android:id="@+id/login_button"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:background="@drawable/signin"
        android:text="" /> 
```

我不知道是否有一些我们应该做按钮图像的新方法或者我刚刚错过的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T21:13:08.540

我将图像的格式从 gif 更改为 png ...问题已修复。这可能有利于其他人知道！

（我也重命名了，仅供参考）

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-06T20:20:11.600

`drawable/signin`是透明的。

# scala - “未找到：类型”错误

> ID：12307738
> 
> 赞同：0
> 
> 时间：2012-09-06T20:16:59.277
> 
> 标签：scala

我正在阅读“在 Scala 中编程”，在其中一个示例中，当我尝试在 Eclipse 中编译它时收到错误消息：“未找到：类型 ChecksumAccumulator”该类型声明如下。下面的代码是否正确？

```
import scala.collection.mutable.Map

object ChecksumAccumulator {

  private val cache = Map[String, Int]()

  def calculate(s: String): Int = 
    if(cache.contains(s))
      cache(s)
    else {
      val acc = new ChecksumAccumulator
      for(c <- s)
        acc.add(c.toBye)
      val cs = acc.checksum()
      cache += (s -> cs)
      cs
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T20:33:26.533

来自[*Scala编程*](http://www.artima.com/pins1ed/classes-and-objects.html)：

> 此图中的单例对象名为`ChecksumAccumulator`，与上例中的类同名。当一个单例对象与一个类同名时，它被称为该类的伴生对象。您必须在同一个源文件中定义类及其伴随对象。该类称为单例对象的伴生类。

如果您尝试在没有`ChecksumAccumulator`类的情况下单独编译此代码，您将收到编译器错误，因为您无法使用`new`. 这本书很好地解释了伴生对象和类是如何协同工作的，既然你已经在阅读它，我就不再费心在这里添加任何进一步的总结了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-02-06T17:17:22.543

问题是在书上类定义得太早，后来在文件**ChecksumAccumulator.scala**中没有类定义。对于初学者来说，误导就足够了，而且会卡住。这必须是两个文件的完整代码。

在**ChecksumAccumulator.scala**

```
import scala.collection.mutable.Map
class ChecksumAccumulator {
 private
 var sum = 0
 def add(b: Byte) {
  sum += b
 }
 def checksum(): Int = ~(sum & 0xFF) + 1
}
object ChecksumAccumulator {
 private val cache = Map[String, Int]()
 def calculate(s: String): Int =
  if (cache.contains(s))
   cache(s)
  else {
   val acc = new ChecksumAccumulator
   for (c < -s)
    acc.add(c.toByte)
   val cs = acc.checksum()
   cache += (s -> cs)
   cs
  }
} 
```

在**Summer.scala**

```
import ChecksumAccumulator.calculate
object Summer {
 def main(args: Array[String]) {
  for (arg < -args)
   println(arg + ": " + calculate(arg))
 }
} 
```

然后就可以编译使用了。

```
scalac ChecksumAccumulator.scala Summer.scala 
```

然后运行示例

```
scala Summer of love 
```

这将为您提供以下输出：

```
of: -213
love: -182 
```

# firefox-addon - 从链接安装 Firefox 插件，而不是下载 .xpi

> ID：12307742
> 
> 赞同：6
> 
> 时间：2012-09-06T20:17:16.357
> 
> 标签：firefox-addon

我刚刚制作了一个 FF 插件并制作了一个简单的网站。我希望访问者单击“下载”按钮来安装插件，而不是下载。它在本地工作，但在我上传网站时不起作用。我检查了 mozilla 存储库，它们也只是链接到 xpi 文件。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-06T21:26:54.027

问题是您还没有为您的网站注册 XPI MIME 类型。您可以通过将以下规则添加到站点`.htaccess`文件来执行此操作（假设您的站点使用 Apache 服务器）：

```
AddType application/x-xpinstall .xpi 
```

这应该会产生您想要的结果（用户单击链接并被提示安装 XPI 文件）。

更多参考[https://developer.mozilla.org/en-US/Add-ons/Extension_Packaging#Making_an_extension_XPI](https://developer.mozilla.org/en-US/Add-ons/Extension_Packaging#Making_an_extension_XPI)

# android - 如何解析 Google Places Detail JSON 文件？

> ID：12307748
> 
> 赞同：0
> 
> 时间：2012-09-06T20:17:39.367
> 
> 标签：android, json, string, parsing, int

我是 android 的菜鸟，我想用与此处示例相同的格式解析 google 响应 JSON： [https](https://developers.google.com/places/documentation/details) ://developers.google.com/places/documentation/details 。我正在尝试获取字符串格式的电话号码。但是，当我从数组“事件”编码到 .getString 时，我的编辑器会要求一个 int 索引。我不明白发生了什么事。任何帮助是极大的赞赏。这是我的代码：

```
try {   
        JSONObject googleObject = StoresNearMe.getJSONfromURL(googleplacedetailapi);
        JSONObject parsedGoogle = googleObject.getJSONObject("results");
        JSONArray  parsedevents = parsedGoogle.getJSONArray("events");
        //thing.setText(googleplacesapi);
        if(parsedevents.equals("") ){
            Toast.makeText(FindDealer.this, "No nearby locations", Toast.LENGTH_LONG).show();
        }else{
            String phonenumber = parsedevents.getString("formatted_phone_number");
            thing.setText(phonenumber);   
      }            
  } catch (JSONException e) {
      Log.d("log_tag","JSON parsing error - Google Places Api:" + e.getMessage());
  } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T20:36:20.793

`formatted_phone_number`在`results`json 对象中，而不是在`events`json 数组中。

换行：

```
String phonenumber = parsedevents.getString("formatted_phone_number"); 
```

到

```
String phonenumber = parsedGoogle.getString("formatted_phone_number"); 
```

您可能会在 json.org 上阅读有关 json 结构的内容。

# jquery - 找出 $(...).slideDown() 动画的值

> ID：12307749
> 
> 赞同：0
> 
> 时间：2012-09-06T20:17:45.863
> 
> 标签：jquery, animation, height, slidedown

据我了解，jQuery 做了一些神奇的测量来确定元素的“正常”高度是多少，以便能够使用`.slideDown()`. 有没有办法在 jQuery 获得这些测量值后立即获得这些测量值？

具体来说，我想要做的是开始将 html 动画`scrollTop`到即将显示的目标的底部。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T21:03:36.170

If I'm understanding your question correctly, jquery's `height` already handles this "magic". Native `offsetHeight` will return 0 for hidden elements but jquery's `height` will return their proper height.

Also, if you're curious about the magic. They basically set the `{ position: "absolute", visibility: "hidden", display: "block" }` on the element, check the height, then revert back to the original values.

# javascript - 传递参数：Objective javascript

> ID：12307750
> 
> 赞同：5
> 
> 时间：2012-09-06T20:17:46.500
> 
> 标签：javascript

即使我在 Javascript 方面有丰富的经验，我也是 Objective javascript 的新手。如何在这里将我的参数传递给 calc 闭包？

```
var calc = (function() {
    var a = 5;
    var b = 0;
    return {
        add: function() {
            return a + b;
        },
        subtract: function() {
            return a - b;
        },
        multiply: function() {
            return a * b;
        },
        divide: function() {
            if (b != 0) return a / b
            else {
                alert('division by zero');
                return false;
            }
        }
    }
})();​

    console.log(calc.divide()); 
```

我想将参数传递给像 (calc.multiply(10,20));

提前致谢..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T20:21:47.250

根据您的调用方法`calc.multiply(a, b)`：应该是这样的：

```
var calc = (function() {
    return {
        add: function(a, b) {
            return a + b;
        },
        subtract: function(a, b) {
            return a - b;
        },
        multiply: function(a, b) {
            return a * b;
        },
        divide: function(a, b) {
            if (b != 0) return a / b
            else {
                alert('division by zero');
                return false;
            }
        }
    }
})();

console.log(calc.divide(20, 2)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-06T20:21:52.313

这里有一个简单的方法！

```
var calc = function(a,b) {
    return {
        add: function() {
            return a + b;
        },
        subtract: function() {
            return a - b;
        },
        multiply: function() {
            return a * b;
        },
        divide: function() {
            if (b != 0) return a / b
            else {
                alert('division by zero');
                return false;
            }
        }
    }
};

//console.log(calc.divide());
//I want to pass the parameters to calc like (calc.multiply(10,20));

calc(10,20).multiply(); 
```

否则，您必须修改每种方法以接受形式参数...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-07T18:02:27.570

```
var calc = function(a,b) {
    return {
        add: function() {
            return a + b;
        },
        subtract: function() {
            return a - b;
        },
        multiply: function() {
            return a * b;
        },
        divide: function() {
            if (b != 0) return a / b
            else {
                alert('division by zero');
                return false;
            }
        }
    }
}; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-06T20:21:59.707

你的意思是这样的：

```
var calc = (function() {
    var a = 5;
    var b = 0;
    return {
        add: function() {
            return a + b;
        },
        subtract: function() {
            return a - b;
        },
        multiply: function() {
            return a * b;
        },
        divide: function(n, d) {
            if (n != 0) return n / d
            else {
                alert('division by zero');
                return false;
            }
        }
    }
})();

alert(calc.divide(3, 4));​ 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-06T20:22:15.263

下面的代码应该适合你：

```
var calc = (function() {
    var a = 5;
    var b = 0;

    return {
        add: function(a, b) {
            return a + b;
        },
        subtract: function(a, b) {
            return a - b;
        },
        multiply: function(a, b) {
            return a * b;
        },
        divide: function(a, b) {
            if (b !== 0) return a / b;
            else {
                alert('division by zero');
                return false;
            }
        }
    };
})();

console.log(calc.multiply(10, 10)); 
```

我所做的编辑是在每个返回的函数上设置`a`和`b`参数，并`divide`通过使其严格来使您在函数上与零进行比较更安全。

希望这可以帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-06T20:22:32.753

```
var calc = (function() {
    return {
        add: function(a, b) {
            return a + b;
        },
        subtract: function(a, b) {
            return a - b;
        },
        multiply: function(a, b) {
            return a * b;
        },
        divide: function(a, b) {
            if (b != 0) return a / b
            else {
                alert('division by zero');
                return false;
            }
        }
    }
})();​ 
```

尽管我会考虑将您的警报更改为引发错误。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-06T20:26:31.287

您可以将参数提供给`calc`，它返回一个对象以使用这两个数字进行计算，或者您只需`calc`使用计算某事的函数创建一个对象。您的要求`calc.multiply(10,20)`是第二种解决方案：

```
var calc = {
    add: function(a, b) {
        return a + b;
    },
    subtract: function(a, b) {
        return a - b;
    },
    multiply: function(a, b) {
        return a * b;
    },
    divide: function(a, b) {
        if (b != 0) return a / b
        alert('division by zero');
        return false;
    }
};​ 
```

否则，对于 using `calc(10,20).multiply()`，它将构建您已经拥有的闭包，但使用参数而不是两个局部常量：

```
function calc(a, b) {
    return {
        add: function() {
            return a + b;
        },
        subtract: function() {
            return a - b;
        },
        multiply: function() {
            return a * b;
        },
        divide: function() {
            if (b != 0) return a / b
            alert('division by zero');
            return false;
        }
    };
} 
```

# objective-c - 如何在不使用 Objective-C 中的“退出”命令的情况下组合两种方法，我有一个循环？

> ID：12307751
> 
> 赞同：0
> 
> 时间：2012-09-06T20:17:46.030
> 
> 标签：objective-c, ios

好的，我并不认真地希望使用某种退出命令来退出循环，但在这种情况下，我倾向于使用两种方法，当我确定我可以使用一种时。

对于这个例子，最好的方法是什么？

```
typedef enum {
    FirstParamHigherThanSecond,
    FirstParamLowerThanSecond,
    ParamsEqual
} VersionStatus;

VersionStatus compareVersions(NSString* left, NSString* right) {

    VersionStatus retVal;

    NSComparisonResult res = analyszeVersions(left, right);
    if (res == NSOrderedSame) {
        retVal = ParamsEqual;

    } else if (res == NSOrderedDescending) {
        retVal = FirstParamHigherThanSecond;

    } else if ( res == NSOrderedAscending) {
        retVal = FirstParamLowerThanSecond;
    }
    return retVal;
} 
```

.

```
NSComparisonResult analyszeVersions(NSString* leftVersion, NSString* rightVersion)
{
    int i;

    NSMutableArray *leftFields  = [[NSMutableArray alloc] initWithArray:[leftVersion  componentsSeparatedByString:@"."]];
    NSMutableArray *rightFields = [[NSMutableArray alloc] initWithArray:[rightVersion componentsSeparatedByString:@"."]];

    if ([leftFields count] < [rightFields count]) {
        while ([leftFields count] != [rightFields count]) {
            [leftFields addObject:@"0"];
        }
    } else if ([leftFields count] > [rightFields count]) {
        while ([leftFields count] != [rightFields count]) {
            [rightFields addObject:@"0"];
        }
    }

    for(i = 0; i < [leftFields count]; i++) {
        NSComparisonResult result = [[leftFields objectAtIndex:i] compare:[rightFields objectAtIndex:i] options:NSNumericSearch];
        if (result != NSOrderedSame) {
            return result;
        }
    }
    return NSOrderedSame;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T21:15:37.653

```
NSComparisonResult result = NSOrderedSame;
for(int i = 0; i < [leftFields count]; i++) {
    result = [[leftFields objectAtIndex:i] compare:[rightFields objectAtIndex:i] options:NSNumericSearch];
    if (result != NSOrderedSame) {
        break;
    }
}
return result; 
```

这是你要找的吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T20:37:51.553

如果我正确理解您的问题，您可以只使用`while`循环而不是`for`循环，例如：

```
i = 0;
NSComparisonResult result;
while (i < [lefFields count]  &&  
       NSOrderedSame == (result = [[leftFields objectAtIndex:i] compare:[rightFields objectAtIndex:i] options:NSNumericSearch]))
    ++i;
return result; 
```

# r - ggplot2 parse =T 函数内部

> ID：12307754
> 
> 赞同：1
> 
> 时间：2012-09-06T20:18:10.480
> 
> 标签：r, ggplot2

我最近发表了一篇关于在 ggplot2 ( [LINK](http://trinkerrstuff.wordpress.com/2012/09/01/add-text-annotations-to-ggplot2-faceted-plot/) ) 中向构面添加文本的博文。我想稍微自动化这个过程，所以我做了以下功能。在我尝试使用`parse=TRUE`. 我的功能不尊重这个论点。我怎样才能像在博客文章中那样在我的函数中适当地使用这个参数？

PS我知道这不是最小的，但实际功能可能对其他人有用。

```
qfacet_text <- function(ggplot2.object, x.coord, y.coord, labels = NULL, 
    text.df = NULL, ...) {
    dat <- ggplot2.object$data
    rows <- ggplot2.object$facet[[1]][[1]]
    cols <- ggplot2.object$facet[[2]][[1]]
    fcol <- dat[, as.character(cols)]
    frow <- dat[, as.character(rows)]
    len <- length(levels(fcol)) *  length(levels(frow))
    vars <- data.frame(expand.grid(levels(frow), levels(fcol)))
    colnames(vars) <- c(as.character(rows), as.character(cols))
    if (is.null(labels)) {
        labels <- LETTERS[1:len]
    }
    if (length(x.coord) == 1) {
       x.coord <- rep(x.coord, len)
    }
    if (length(y.coord) == 1) {
       y.coord <- rep(y.coord, len)
    }
    if (is.null(text.df)) {
        text.df <- data.frame(x = x.coord, y = y.coord, vars, labs=labels)
    } 
    p <- ggplot2.object + geom_text(aes(x, y, label=labs, group=NULL), 
        data=text.df, ...)
    print(p)
    invisible(list(original = ggplot2.object, new = p, dat = text.df))
}

mtcars[, c("cyl", "am", "gear")] <- lapply(mtcars[, c("cyl", "am", "gear")], as.factor)

x <- ggplot(mtcars, aes(mpg, wt, group = cyl)) + 
    geom_line(aes(color=cyl)) +
    geom_point(aes(shape=cyl)) + 
    facet_grid(gear ~ am) +
    theme_bw()  

z <- qfacet_text(x, 33, 2.2, 1:6, color="red")     #as expected
z$dat[5, 1:2] <- c(15, 5)
qfacet_text(x, 33, 2.2, paste("beta ==", 1:6), text.df = z$dat, 
    size = 3, color = "grey50", parse = TRUE)  #doesn't parse 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T21:13:20.470

当你调用它时，不要传递一个`text.df`

```
qfacet_text(x, 33, 2.2, paste("beta ==", 1:6), text.df = NULL, 
    size = 3, color = "grey50", parse = TRUE) 
```

# desire2learn - 如何在 Desire2Learn 的 Valence API 中为用户找回 100 多个注册？

> ID：12307755
> 
> 赞同：0
> 
> 时间：2012-09-06T20:18:12.150
> 
> 标签：desire2learn

获取当前用户注册的当前方法`/d2l/api/lp/{ver}/enrollments/myenrollments/`仅呈现有限数量的注册（大约 100 个）。有没有办法再次调用该方法来获取所有剩余的注册？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T20:18:12.150

用于检索当前用户的注册列表的 Valence API 在*[分页结果集](http://docs.valence.desire2learn.com/basic/apicall.html#paged-result-sets)*数据结构中分页数据。排序到每个页面的结果数量无法通过 API 控制。因此，如果要检索*所有*用户的注册，则必须多次调用。在每次调用时，检查返回的分页结果集结构中的顶级`HasMoreItems`布尔属性——它会告诉您是否有更多数据页要获取。

# java - 独立于分辨率的 SWT 对话框

> ID：12307757
> 
> 赞同：0
> 
> 时间：2012-09-06T20:18:16.380
> 
> 标签：java, dialog, swt, screen-resolution

有人可以告诉我如何实现 swt 对话框的大小和外观的分辨率独立性。我的对话框在 1680x1050 下工作正常，但是当分辨率更改为 1280x800 时，对话框的一部分被剪掉了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T18:43:55.347

您不应该使用绝对坐标，而是查看布局。`GridLayout`我相信是最容易使用的。

见[这篇](http://www.eclipse.org/articles/article.php?file=Article-Understanding-Layouts/index.html)文章。

# jquery - Grails：request.JSON 是从哪里来的，我如何用 jQuery 的 .ajax() 或 .post() 把东西放在那里？

> ID：12307760
> 
> 赞同：6
> 
> 时间：2012-09-06T20:18:20.030
> 
> 标签：jquery, json, grails, curl, postdata

我有一个控制器，在*?request 正文中需要一些 json？*并用它做了很棒的事情：

```
def myController(){
  def myAction(){
    println "Here is request.JSON: ${request.JSON as JSON}"
    println "Here is params: $params"
    //do awesome stuff with request.JSON only
    return
  }
} 
```

所以我可以像这样用 cURL 打这个：

```
curl -i -H "content-type: application/json" -d "{\"someVariable\":\"Absolutely\"}" 
```

我的 grails 控制器打印：

```
Here is request.JSON: {"someVariable":"Absolutely"}
Here is params: [controller:'myController', action:'myAction'] 
```

到目前为止一切都很好，但是当我尝试使用 jQuery 执行此操作时，它会进入 params ！！！

阅读了这两个问题： [Setting the POST-body to a JSON object with jQuery](https://stackoverflow.com/questions/10857382/setting-the-post-body-to-a-json-object-with-jquery)

[jQuery 在请求正文中发布有效的 json](https://stackoverflow.com/questions/4159701/jquery-posting-valid-json-in-request-body)

我对如何编写 .js 的最佳猜测是：

```
var sendMe = {"someVariable":"Absolutely"}
$.ajax({
  url: '/myController/myAction',
  type: 'POST',
  processData: false,
  data: JSON.stringify(sendMe),
  dataType: 'json',
  success: function(data) {

  },
  error: function(request, status, error) {

  }                     
}); 
```

但是当我这样做时，我的控制器会打印：

```
Here is request.JSON: {}
Here is params: [{"someVariable":"Absolutely"}:, controller:'myController', action:'myAction'] 
```

我一定在 jQuery 上做错了什么。

更新：看起来这个白痴实际上遇到了同样的问题：[How to get at JSON in grails 2.0](https://stackoverflow.com/questions/9863874/how-to-get-at-json-in-grails-2-0)但他没有面对 jQuery 问题，而是使用了 cURL 和 reqeust.JSON 的东西。真是个懒惰的家伙。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-06T20:29:16.103

前几天我也遇到了和你一样的问题。

对我来说 - 解决方案是用来`jQuery.ajaxSetup`设置 ajax 内容类型的默认值。

```
$(function() {
    $.ajaxSetup({
        contentType: "application/json; charset=utf-8"
    });
} 
```

有了这个，您可以使用`$.ajax`或`$.post`将您的 JSON 传输到控制器并像这样使用它：

```
def yourJSON = request.JSON 
```

我不知道为什么里面的 'contentType' 选项在我的测试`$.ajax`中`$.post`被忽略了。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-06-11T15:51:02.507

也有类似的问题但不需要使用ajaxSetup，只需要设置contentType：

```
$.ajax({
  method: "POST",
  url: "/api/bar"
  data: JSON.stringify({a:true}),
  contentType:"application/json; charset=utf-8",
  dataType: "json",
  success: function(){
    console.log("args: %o", arguments);
  }
}); 
```

# ruby-on-rails - 日期和时间隐藏表单字段 (Rails3)

> ID：12307761
> 
> 赞同：0
> 
> 时间：2012-09-06T20:18:31.787
> 
> 标签：ruby-on-rails

我为我的应用程序生成了一个脚手架。数据库有一个日期和时间字段，我想设置提交表单的当前日期和时间。

我在 _form.html.erb 创建

```
<div class="field">
    <%= f.label :t_date %><br />
    <%= f.date_select :t_date %>
  </div>

   <div class="field">
    <%= f.label :t_time %><br />
    <%= f.time_select :t_time %>
  </div> 
```

但我不希望用户设置它们，但必须作为表单参数传递。我为他们准备了隐藏字段，但即使我将它们设置为隐藏，你也可以发送一个错误的表单 trought json 或一个 POST 请求，对吗？传递当前日期和时间，将它们保存到数据库并在没有用户通知的情况下显示它们的正确方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T20:24:16.007

如果表单用于创建或更新模型，您只需使用 Activerecord 提供的时间戳功能。

从文档：

> 如果表具有名为 created_at/created_on 或 updated_at/updated_on 的字段，Active Record 会自动为创建和更新操作添加时间戳。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T20:21:39.217

除非您需要知道表单*加载*而不是*提交*的确切时间，否则我建议您在收到表单提交后在控制器中添加当前日期和时间。很好很简单，您可以回避用户提交“恶意”日期的可能性。

# c# - 似乎无法通过 c# 连接到我的 MySQL 数据库

> ID：12307776
> 
> 赞同：0
> 
> 时间：2012-09-06T20:19:18.997
> 
> 标签：c#, mysql

就像标题所说，我无法通过 c# 连接到我的数据库，当我尝试打开连接时出现以下异常：

> 无法连接到任何指定的 MySQL 主机

但是我可以使用完全相同的登录信息与 PHP 连接没有问题。

**编辑**我只是在更改数据库。此连接字符串已使用不同的数据库工作了 2 年。我已经尝试使用服务器而不是数据源和 UID/用户 ID 而不是用户 ID，结果相同

C＃：

```
ProjectDBC = new MySqlConnection("Data Source=combinedsystems.ca;Database=combined_project;UserID=xxxxx;Password=xxxxx;"); 
```

PHP：

```
$db_user = "xxxxx";
$db_pass = "xxxxx";
$db_database = "combined_project"; 
$db_host = "combinedsystems.ca";

$mysqli = new mysqli($db_host, $db_user, $db_pass, $db_database); 
```

这可能很容易，但我现在无法弄清楚。有任何想法吗？

该数据库通过 hosteasysolutions.com 托管，如果这有什么不同的话

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T20:33:02.823

确保您没有（不知何故 - 某处）在您的项目中定义了两个连接字符串，因为您正在更改数据库！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T20:30:28.450

尝试在 User 和 ID 之间使用空格或仅使用 User= 或 UID=

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-06T20:23:25.643

你没有指定服务器，是吗？我使用以下字符串连接到 mysql 主机：

```
Server=localhost;Database=db;UID=user;Password=pass 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-06T20:22:38.117

您的连接字符串看起来错误...您需要指定`Server`,`Uid`而`Pwd`不是`Data Source`, `UserID`and `Password`, 或指定`Data Source`, `User ID`and `Password`（用户 ID 有空格）

```
Server=combinedsystems.ca;Database=combined_project;Uid=xxxxx;Pwd=xxxxx; 
```

或者

```
Data Source=combinedsystems.ca;Database=combined_project;User ID=xxxxx;Password=xxxxx; 
```

检查[此链接](http://www.connectionstrings.com/mysql)以获取示例。

# android - BouncyCastle 版本和 SSL 证书接受

> ID：12307787
> 
> 赞同：1
> 
> 时间：2012-09-06T20:20:33.923
> 
> 标签：android, ssl, bouncycastle

我对 SSL 证书有疑问。我正在使用 1.46 的 BouncyCastle，这已被证明对 3.1 是成功的。和我测试过的 4.0 硬件。但是它在 2.3.5 上失败了。

我检查了 android 文档，并注意到，虽然 BC 的 1.46 对于 3.1 和 4.04 是成功的，但 1.45 应该对 2.3.5 有效。

但事实并非如此。我尝试了下面的代码片段，其中 BKS 数据 mystore_gb 是使用 bcprov-jdk15-145.jar 生成的（我已经尝试了 jdk13-16 变体）：

```
KeyStore trusted = KeyStore.getInstance("BKS");
InputStream in;
if (Build.VERSION.SDK_INT<11) {
  in = context.getResources().openRawResource(R.raw.mystore_gb);
} else {
  in = context.getResources().openRawResource(R.raw.mystore);
}

try {
  trusted.load(in, PWD.toCharArray());
} finally {
  in.close();
} 
```

我用来生成的脚本似乎产生了 OK 信息，如下所示：

```
#!/bin/bash

echo | openssl s_client -connect $1:443 2>&1 | \
 sed -ne '/-BEGIN CERTIFICATE-/,/-END CERTIFICATE-/p' > mycert.pem

export CLASSPATH=bcprov-jdk15-145.jar
CERTSTORE=res/raw/mystore_gb.bks
if [ -a $CERTSTORE ]; then
    rm $CERTSTORE || exit 1
fi
keytool \
      -importcert \
      -v \
      -trustcacerts \
      -alias 0 \
      -file mycert.pem \
      -keystore $CERTSTORE \
      -storetype BKS \
      -provider org.bouncycastle.jce.provider.BouncyCastleProvider \
      -providerpath ./ \
      -storepass $2 
```

那么为什么这不起作用呢？我明白了

09-06 21:51:36.397: D/ServerBase(26999): javax.net.ssl.SSLPeerUnverifiedException: 没有对等证书

我的目标硬件有 2.3.5 Android，并且应该还包含 1.45 版本的 BouncyCastle。如果我使用 1.45 生成 BC 证书并将其部署在我的 2.3.5 硬件上，那么应该正确处理它并为我提供 SSL 连接。

我在这里想念什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T20:47:52.080

`SSLPeerUnverifiedException`不是证书验证的问题，而是服务器没有发送证书的问题。我怀疑这与 BouncyCastle 的版本有很大关系。

只要结果是有效的 X.509，您生成证书的内容不应该与任何这些有关。在这里，您似乎只是在导入现有证书，将您在初始连接上获得的服务器证书作为参考。

您在这里遇到的异常可能是由于所选密码套件和/或 SSL/TLS 版本存在问题。（你可以看看[这个问题，包括评论](https://stackoverflow.com/a/12096398/372643)，虽然我不建议你降级到 SSLv3）。

您可以尝试各种密码套件和/或 SSL/TLS 版本`openssl s_client`（例如，`-cipher`选项或组合`-ssl2, -ssl3, -tls1, -no_ssl2, -no_ssl3, -no_tls1`，查看文档`s_client`）。其中一些可能是由于服务器配置不正确造成的。

# php - 没有显示受保护和私有属性的 var_dump()

> ID：12307790
> 
> 赞同：4
> 
> 时间：2012-09-06T20:20:46.237
> 
> 标签：php

是否有任何功能或如何 var_dump() 对象而不显示它受保护和私有属性？

例子：

```
class foo {
    public $public = 'public';
    protected $protected = 'protected';
    private $private = 'private';
}

$Foo = new foo;
var_dump($Foo);
// Expected output "(string) public" 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-06T20:27:51.463

`json_encode`只会对公共属性进行编码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-06T20:24:13.807

如[本页](http://www.tuxradar.com/practicalphp/6/7/6)所示，您可以遍历对象：

```
<?php
    class person {
        public $FirstName = "Bill";
        public $MiddleName = "Terence";
        public $LastName = "Murphy";
        private $Password = "Poppy";
        public $Age = 29;
        public $HomeTown = "Edinburgh";
        public $FavouriteColour = "Purple";
    }

    $bill = new person();

    foreach($bill as $var => $value) {
        echo "$var is $value\n";
    }
?> 
```

> 注意 $Password 变量是看不见的，因为它被标记为 Private 并且我们试图从全局范围访问它。

如果你想制作自己的 var 转储，你可以这样做：

```
function dumpObj( $obj )
{
    foreach( $obj as $k=>$v )
    {
        echo $k . ' : ' . $v ."\n";
    }
}

dumpObj( new WhateverClass() ); 
```

这样做的原因是，当您在其外部访问对象时，您只能访问其面向公众的成员变量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-07T03:44:21.997

怎么样`json_decode(json_encode($obj))`？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-03-17T16:39:41.017

一种选择是在您的类中使用 __clone 方法。在那里，您可以从对象实例的克隆中取消设置任何不需要的属性，例如：

```
public function __clone() {
    unset( $this->my_secret_property ); 
} 
```

那么您的 var_dump 将引用克隆：

```
var_dump( clone My_Object_Instance ); 
```

或者，如果您需要在其他地方进行克隆，您的类可以在取消设置任何不需要的数组元素后使用 __debugInfo() 方法来完全控制其 var_dump 输出，例如返回 get_object_vars( $this )。

# c# - AutoMapper 映射使用接口与具体映射

> ID：12307794
> 
> 赞同：6
> 
> 时间：2012-09-06T20:20:59.230
> 
> 标签：c#, interface, automapper, automapper-2

我认为这是不可能的，但我想这是值得的问题。

我有以下共享接口的类型（我保证，这不是我之前问过的同一个问题）。

```
public interface ICustomer;

public class CustomerBO : ICustomer

public class CustomerSO : ICustomer // SO is Service Object in this case. 
```

然后，我有以下映射：

```
Mapper.Map<ICustomer, ICustomer>(); 
```

现在，这就是有趣/令人困惑的地方。

这有效：

```
Mapper.Map<ICustomer, ICustomer>(customerSO, new CustomerBO); 
```

这不起作用：

```
Mapper.Map(customerSO, new CustomerBO()); 
```

现在，通常我只输入定义了两个接口类型的第一个 Map 语句不会有问题，但我的问题是当 Customer 对象被埋在某个地方时。

```
public class CustomerOrderDTO
{
    ICustomer customer;
}

public class CustomerOrderSO
{
    CustomerSO customer;
}

Mapper.Map<CustomerOrderDTO, CustomerOrderSO>(); 
```

这不起作用，因为没有从 ICustomer 到 CustomerSO 的映射，所以配置断言失败。

目前，我正在通过这样做来解决这个问题：

```
Mapper.CreateMap<CustomerOrderDTO, CustomerOrderSO>()
    .ForMember(desc => dest.customer
        , exp => exp.MapFrom(src => Mapper.Map<ICustomer, ICustomer>(src.customer
            , new CustomerSO)); 
```

但是，我必须对我们拥有的每个 DTO 类型对象执行此操作，然后很可能会产生级联效果。

我了解从技术上讲，我可以执行以下操作来解决此问题：

```
Mapper.Map<CustomerBO, CustomerSO>(); 
```

但是，在 CustomerBO 中，还有很多其他属性在业务逻辑中使用，而不是在接口中。同样，CustomerSO中有很多属性不在界面中。如果我采用上述路线，我将有大量的 Ignore() 调用，我必须将 CustomerBO 映射到 CustomerSO，然后将 CustomerSO 映射到 CustomerBO，每个都有自己独特的 Ignore 调用列表。使用接口消除了对忽略调用的需要，因为我希望从一个到另一个可见的数据是在接口中定义的。

所以，简而言之，我的问题是：有什么方法可以告诉 AutoMapper 在遇到其中一个实现类时使用接口映射？如果做不到这一点，是否有其他（阅读：更好的）方法比 MapFrom 委托中的 Map 调用根据需要强制执行我的接口到接口映射？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-11-25T21:09:55.913

通常，您希望配置到`ICustomer`接口的映射并使用`.As<TDestination>()`. *（也许这是您第一次提出问题后的补充。）*

这适用于 2 层之间的映射，例如您的示例：

```
Mapper.CreateMap<CustomerDTO, ICustomer>().As<CustomerModel>();
Mapper.CreateMap<CustomerModel, ICustomer>().As<CustomerDTO>(); 
```

但是，将其扩展到另一层，例如映射`CustomerModel`到`CustomerViewModel`，这将分崩离析。您只能告诉 AutoMapper 一种用于实例化的目标类型。

但与上面的评论类似，我会质疑将属性类型化为其他类中的接口的原因。为什么要有`CustomerOrderModel`财产`ICustomer customer`？您可以用 a 的实例替换 customer`CustomerDTO`并且您的程序仍然正确吗？如果您对包含客户的对象有共同的行为，您可以让这些父对象实现一个接口，`ICustomerAccessor`. 然后，使用[显式接口实现](https://msdn.microsoft.com/en-us/library/ms173157.aspx)添加较弱类型的属性，它不会干扰名称。

# c++ - 从 C++ 返回对对象的引用时，是否需要在返回变量中使用“&”运算符？

> ID：12307796
> 
> 赞同：4
> 
> 时间：2012-09-06T20:21:13.067
> 
> 标签：c++

假设我有以下代码：

```
#include <iostream>

using namespace std;

class Account
{
private:
    float balance;

public:
    Account() { balance = 0.0; };
    float GetBalance() { return balance; };
    void SetBalance(float newBalance) { balance = newBalance; };
};

Account mainAccount;

Account& GetAccount()
{
    return mainAccount;
}

void PrintAccountInfo()
{
    cout << "mainAccount's balance is " << mainAccount.GetBalance() << endl;
}

int main()
{
    PrintAccountInfo();
    Account &a = GetAccount(); // Line 31
    a.SetBalance(30.0);
    PrintAccountInfo();
    return 0;
} 
```

当我运行它时，我得到以下输出（如预期的那样）：

```
mainAccount's balance is 0
mainAccount's balance is 30 
```

但是，在第 31 行，如果我取出“Account &a”中的“&”，使其变为：

```
Account a = GetAccount(); // note lack of "&" 
```

我得到这个输出：

```
mainAccount's balance is 0
mainAccount's balance is 0 
```

怎么会？我想在返回引用时，“&”是多余的/不是必需的？我是否从根本上误解了引用在 C++ 中的工作方式？

编辑：谢谢，我现在明白为什么两者不同了。但是，那么我不应该这样做：

```
Account GetAccount()
{
    return mainAccount;
}

int main()
{
    Account &a = GetAccount();
    // ....
} 
```

但是，当我运行它时，我收到一个错误：

> 无标题：在函数“int main()”中：
> 
> 无标题：31：错误：从“Account”类型的临时变量中“Account&”类型的非常量引用无效初始化</p>

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T20:25:57.253

> *我想在返回引用时，“&”是多余的/不是必需的？*

你想错了。

考虑这两条不同的线：

```
Account &a = GetAccount(); // Line 31

Account a = GetAccount(); // Line 31 
```

首先，您声明一个被调用的引用，该引用`a`绑定到函数返回的对象`GetAccount`。

在第二个中，您声明一个`a`由函数返回的对象复制初始化的对象`GetAccount`。

从根本上说：一个声明一个引用，另一个声明一个对象。

* * *

**编辑**：回答后续问题：

> “*我可以`&`从函数声明中的返回类型中删除吗`GetAccount`：`Account GetAccount() { return mainAccount; }`* ”

你当然*可以*删除`&`，但是你的行为会改变。考虑这两个函数：

```
Account GetAccount() { return mainAccount; }

Account &GetAccount() { return mainAccount; } 
```

首先，您返回一个已从该对象复制初始化的临时`mainAccount`对象。在第二个中，您返回对该`mainAccount`对象的引用。

*   如果你想`a`成为一个参考`mainAccount`，你需要`&`在这两个地方。

*   如果您想`a`成为 的副本`mainAccount`，则不需要`&`在 的声明中`a`。*在这种情况下*，另一个声明无关紧要。

*   如果您想`a`成为对编译器生成的临时值的引用（提示：您不这样做），请声明`a`with `&`，但`GetAccount`不声明。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-06T20:23:01.860

您返回一个引用，然后使用该引用创建一个新对象。`a`是使用从返回的引用进行复制初始化的新对象`GetAccount`。

请记住，引用是别名。这就像在说：

```
int x = 0;
int& y = x;

int z = y;
//is equivalent to
z = x; 
```

`z`在这种情况下不引用`x`也不`y`，因为`z`它本身不是引用。

所以：

```
x = 1; 
```

将同时修改`x`和`y`，但`z`仍为 0。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-06T20:26:18.427

在这两种情况下，您都会返回一个引用，但您使用它的方式有所不同：

```
Account &a = GetAccount(); 
```

在这种情况下，您使用引用来初始化另一个引用，`a`对原始数据进行引用。

```
Account a = GetAccount(); 
```

在这种情况下，您使用返回的引用来初始化 type 的对象`Account`，而不是对 Account 的引用。因此，您将原始对象**复制**到新创建的`a`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-06T20:25:17.317

这很重要。

这个版本

```
Account a = GetAccount(); // note lack of "&" 
```

创建帐户的*副本*，而不是参考。因此，在更改余额时，您更改的是副本的余额，而不是原始的余额。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-07T08:35:55.823

从标题中回答问题：不直接。

```
typedef Account& AccountRef; // Hiding here
AccountRef GetAccount()
{
    return mainAccount;
} 
```

顺便说一句，`&`这里不用作运算符。它修改`Account`类型。它可以用作一元和二元运算符，例如 in`&obj`或`5 & 6`。当用作运算符时，它必须出现在表达式之前或之间。

# node.js - 从 node.js 中的异步传回数据

> ID：12307798
> 
> 赞同：0
> 
> 时间：2012-09-06T20:21:32.617
> 
> 标签：node.js, asynchronous

我正在使用`async`并试图让数据传回。这是可能的还是我需要使用另一种库方法？

理想情况下，我想做类似的事情：

`async.forEach(txids, processTransaction, function(asyncErr, outputTotal) {`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T20:24:15.943

我想你想要[`async.reduce()`](https://github.com/caolan/async#reduce)，类似于[`Array.reduce()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/Reduce)但异步。

给定的示例是：

```
async.reduce([1,2,3], 0, function(memo, item, callback){
    // pointless async:
    process.nextTick(function(){
        callback(null, memo + item)
    });
}, function(err, result){
    // result is now equal to the last value of memo, which is 6
}); 
```

你可能会做类似的事情：

```
async.reduce(txids, {}, processTransaction, function(err, output) { }); 
```

我不确定`processTransaction`返回的是什么，所以我不确定你的`memo`（或`initialValue`）应该是什么。

# wpf - 如何使 TreeView 内容为空

> ID：12307799
> 
> 赞同：0
> 
> 时间：2012-09-06T20:21:33.050
> 
> 标签：wpf, xaml, treeview

我想让 TreeViewItem 的内容中包含空的 ListBox 看起来像没有任何内容的 TreeViewItem。例如，TreeViewItem“A”看起来像我希望的那样。当 TreeViewItem“B”中的 ListBox 为空时，我希望“B”看起来像“A”。

```
 <TreeView>
        <TreeViewItem x:Name="A" Header="Header" />
        <TreeViewItem x:Name="B" Header="Header with empty list">
            <ListBox x:Name="localContent" ItemsSource="{Binding listContent}">
                <!--ListBox.Style>
                    <Style TargetType="ListBox">
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding listContent.Count}" Value="0">
                                <Setter Property="{Binding ElementName=localItem, Path=Background}">
                                    <Setter.Value>
                                        <Color R="0" G="0" B="0" /> 
                                    </Setter.Value>
                                </Setter>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </ListBox.Style-->
            </ListBox>
        </TreeViewItem>
    </TreeView> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T20:28:33.407

看起来你已经在用 count 做类似的事情了。

```
 <TreeViewItem x:Name="B" Header="Header with empty list">
            <ListBox x:Name="localContent" ItemsSource="{Binding listContent}">
                <ListBox.Style>
                    <Style TargetType="ListBox">
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding listContent.Count}" Value="0">
                                <Setter Property="Visiblity" Value="Hidden" />
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </ListBox.Style>
            </ListBox>
        </TreeViewItem> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T20:25:43.367

您可以将`Visibility`您的 ListBox 设置`Collapsed`为使其不会出现在您的`TreeView`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-06T23:38:35.723

使用以下触发器实现了所需的行为（为任何控件添加它）：

```
<Style.Triggers>
            <DataTrigger Binding="{Binding Count, Converter={StaticResource int2bool}}" Value="False">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate>
                            <StackPanel Orientation="Horizontal">
                                <Expander Visibility="Hidden" />
                                <TextBlock Text="list is empty" />
                            </StackPanel>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </DataTrigger>
            <DataTrigger Binding="{Binding Count, Converter={StaticResource int2bool}}" Value="True"  >
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate>
                            <Expander Header="{Binding}">
                                <Expander.Content>
                                    <ListBox ItemsSource="{Binding}" />
                                </Expander.Content>
                            </Expander>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </DataTrigger>
        </Style.Triggers> 
```

# ruby-on-rails - 无法在没有清单的应用程序/资产中引用文件

> ID：12307802
> 
> 赞同：1
> 
> 时间：2012-09-06T20:21:43.250
> 
> 标签：ruby-on-rails, asset-pipeline

我是一个经验丰富的 Rails 开发人员，但我对资产管道有点陌生，我有一个可能非常简单的问题。我想玩 redactor js 库，所以我将文件夹（包含 css 和 js 文件）放入 app/assets 但我不能只写

```
<%= javascript_include_tag "javascripts/redactor/redactor.min.js" %> 
```

Rails 一直说找不到文件。我最终只是将它移到了公用文件夹，但我的问题是...... lib/assets、vendor/assets 或 app/assets 中的所有内容都必须预编译（或在清单中引用）才能使用吗？

PS：顺便说一句，这是在开发中。我有

```
config.assets.compress = false
config.assets.debug = true 
```

在 development.rb 中设置

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T20:30:13.193

是的，你必须预编译它。您可以将其添加到预编译资产中，`production.rb`这意味着您不需要仅引用另一个文件的清单文件。

```
config.assets.precompile += %w( redactor.min.js ) 
```

您可以在开发中使用未缩小的版本，这将帮助您找到错误。它将在生产中自动缩小。

[在此处](http://guides.rubyonrails.org/asset_pipeline.html)了解有关资产管道的更多信息。

# rtf - 替换 RTF 字符串中的文本 - 不保留结果

> ID：12307808
> 
> 赞同：5
> 
> 时间：2012-09-06T20:22:05.837
> 
> 标签：rtf

对不起这个蹩脚的标题，但想不出更好的方式来表达它，并在这上面放了几天的Bingleing。

我有读取 RTF 文件的代码，我在其中放置了占位符以充当合并字段。代码将替换文本，但是当文件被保存回来时，新值不会显示出来。

```
var fileName = @"C:\Users\James\SkyDrive\Sandbox\MailMerge\MailMerge\templates\Template1.rtf";
StreamReader sr = new StreamReader(fileName);
string text = sr.ReadToEnd();
sr.Close();
text = text.Replace("{\\{Title\\}\\}", "Mr.");
text = text.Replace("{\\{LastName\\}\\}", "Johnson");
text = text.Replace("{\\{FirstName\\}\\}", "James"); 
```

**替换前的 RTF：** {\rtf1\ansi\ansicpg1252\deff0\nouicompat\deflang1033{\fonttbl{\f0\fnil\fcharset0 Calibri;}} {*\generator Riched20 6.2.9200}\viewkind4\uc1 \pard\sa200\sl276 \slmult1\f0\fs22\lang9 嗨 {{Title}} {{LastName}}\par 你好吗，{{FirstName}}\par }

**替换后的 RTF：** {\rtf1\ansi\ansicpg1252\deff0\nouicompat\deflang1033{\fonttbl{\f0\fnil\fcharset0 Calibri;}} {*\generator Riched20 6.2.9200}\viewkind4\uc1 \pard\sa200\sl276 \slmult1\f0\fs22\lang9 嗨\先生。\Johnson\par 你好吗，\James\par }

**RTF保存后在记事本中打开：** {\rtf1\ansi\ansicpg1252\deff0\deflang1033{\fonttbl{\f0\fnil\fcharset0 Calibri;}} \viewkind4\uc1\pard\sa200\sl276\slmult1\lang9\f0 \fs22 嗨。\par 你好吗，\par }

我还需要做一些其他步骤，它将文件保存为正确的格式吗？我也尝试过使用 RichTextBox 控件，将字符串加载到其中，然后调用 Save() 方法。这给了我相同的结果。

谢谢，詹姆斯

在阅读这篇文章后想通了，[清理 RTF 文本](https://stackoverflow.com/questions/20450/cleaning-up-rtf-text)并使用以下代码：

```
var fileName = @"C:\Users\James\SkyDrive\Sandbox\MailMerge\MailMerge\templates\Template1.rtf";
StreamReader sr = new StreamReader(fileName);
string text = sr.ReadToEnd();
sr.Close();
rtb.Rtf = text;
rtb.Text = rtb.Text.Replace("{{Title}}", "Mr.");
rtb.Text = rtb.Text.Replace("{{LastName}}", "Johnson");
rtb.Text = rtb.Text.Replace("{{FirstName}}", "James");
rtb.SaveFile(@"C:\Users\James\SkyDrive\Sandbox\MailMerge\MailMerge\templates\Johnson2.rtf"); 
```

# jenkins - Jenkins 刷新环境变量以使 Python 插件正常工作

> ID：12307817
> 
> 赞同：0
> 
> 时间：2012-09-06T20:22:24.723
> 
> 标签：jenkins, jenkins-plugins

我正在尝试让 Jenkins 工作为我安装 python，然后使用**Python Plugin**执行脚本。

到目前为止，我得到了 python 并安装得很好，我还为 python 设置了环境变量，但是***插件不会启动***：

> 系统找不到指定的文件 FATAL: command execution failed java.io.IOException: Cannot run program "python" (in directory "C:\Jenkins\workspace\install and configure python"): CreateProcess error=2, 系统不能找到指定的文件

据我了解，这是**因为 python.exe 不在 PATH 中**。所以我尝试过：
1）在批处理中将其添加到 PATH -FAILED
2）使用 Environment Injector Plugin -FAILED 添加到作业中的 PATH 变量以“为运行准备环境”

所以我的猜测是我必须重置节点的*java.library.path*或重新启动 Jenkins 从代理。

问题：有什么想法可以做到吗？

以下是我目前所拥有的用于 python 安装的“Windows 批处理命令”：

```
::verify installation is needed
python --version
if %errorlevel% EQU 0 EXIT 0

:: get the wget utility
cscript.exe .\web\vbs\download-wget.vbs

::get python 27 from server
wget.exe --no-check-certificate https://qaa.myserver.com/public/python27/python-2.7.3.msi

::install python
msiexec /i python-2.7.3.msi /qn TARGETDIR=c:\Python27

::because of the stupid bug https://issues.jenkins-ci.org/browse/JENKINS-3425
set temppath=%PATH:"=%
setx PATH "%temppath%" /m 
```

在此之后，我通过 Python 插件进行了第二次构建步骤`print "Hello, World"`

# ios - 除非请求获取，否则不会删除 NSManagedObject

> ID：12307819
> 
> 赞同：1
> 
> 时间：2012-09-06T20:22:27.390
> 
> 标签：ios, core-data, nsmanagedobject

我正在从核心数据中删除一个托管对象，如下所示：

```
[item.managedObjectContext deleteObject:item]; 
```

（请注意，此项目已创建，但此时未保存。）

试图修复一个错误，我想确认该项目确实已被删除。首先，由于每个“项目”都属于一个“列表”，我记录了 list.items 前后的计数。没有变化。怀疑。

为了更加确定，我在删除前后添加了一个获取请求，并记录了上下文中的项目总数。这就是它变得奇怪的地方。

我发现执行 fetch 的行为消除了我最初的错误。换句话说，如果我在删除前后执行一次 fetch，我可以清楚地看到上下文中的项目数减少了一个。但是，如果没有此获取，则不会删除该项目（或至少不会立即删除）。

有没有人对这里发生的事情有所了解？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T20:39:33.663

该`deleteObject`方法实际上并没有删除该对象 - 它会将其标记为删除。在提交更改之前，实际上并未进行更改。

**编辑添加**

为了响应评论扩展答案：

如果您想知道上下文是否已更改，以便知道何时触发 fetch 请求，那么您可以注册以观察`NSManagedObjectContextObjectsDidChangeNotification`上下文中的对象发送 deleteObject 消息时发送的内容。

# ruby-on-rails-3 - 将数据对象数组转换为原始数据

> ID：12307821
> 
> 赞同：0
> 
> 时间：2012-09-06T20:22:27.547
> 
> 标签：ruby-on-rails-3, railscasts, ransack

这可能是我的一个巨大的疏忽，但我一直在寻找解决方案大约一个小时，但没有运气！

我正在关注[关于将数据导出到 .CSV 的 RailsCast 教程](http://railscasts.com/episodes/362-exporting-csv-and-excel?autoplay=true)

我用来填充 CSV 的数据来自[Ransack](https://github.com/ernie/ransack)查询（在参数中）

然而，被吐出的数据是数据对象的集合，而不是原始数据本身——

**浏览器中的输出：**

```
#<Order:0x007f820823c738>,#<Order:0x007f82082ad708>,#<Order:0x007f82082ace98>,
#<Order:0x007f82082ac718> 
```

我只是想得到那些相同的对象，但只是打印出来......就像在 RailsCasts 教程（[截图](http://cl.ly/JGvl)）

这是我的 Orders_Controller

```
def index
  @search = Order.search(params[:q])
  @orders = @search.result

  @results = @orders

  respond_to do |format|
    format.html # index.html.erb
    format.csv { render text: @results.to_csv }
  end
end 
```

那么有没有一种简单的方法可以将这些数据对象转换为教程中的原始字符串？

**编辑**

这是我`to_csv`的模型中的方法

```
def self.to_csv(options = {})
  CSV.generate(options) do |csv|
    csv << column_names
    all.each do |order|
      csv << order.attributes.values_at(*column_names)
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T22:01:01.373

所以我认为这就是问题所在：`@search.result`是一个订单数组，`@results.to_csv`调用`Array#to_csv`方法也是如此。由于您没有得到，`ActiveRecord::Relation`您可能需要以不同的方式转换为 csv。

在中创建一个`ransack_helpers.rb`模块`lib`：

```
module RansackHelpers
  def self.to_csv(ransack_result, options = {})
    CSV.generate(options) do |csv|
      result_array = ransack_result.result
      column_names = result_array.first.class.column_names
      csv << column_names
      result_array.each do |item|
        csv << item.attributes.values_at(*column_names)
      end
    end
  end
end 
```

在`orders_controller.rb`：

```
def index
  @search = Order.search(params[:q])
  @orders = @search.result

  respond_to do |format|
    format.html # index.html.erb
    format.csv { render text: RansackHelpers.to_csv(@search) }
  end
end 
```

我没有测试过这段代码，所以可能会有一些问题，但我认为这是你想要做的。

# ios - iOS开发。检查网络并重定向到应用程序的开头

> ID：12307827
> 
> 赞同：0
> 
> 时间：2012-09-06T20:22:49.120
> 
> 标签：ios, networking

我正在开发一个应用程序，它应该具有与 appStore Ace Card（现在称为 Casino）中的游戏类似的功能。如果您的应用程序在后台运行了一段时间，或者当您再次激活游戏时失去了连接，则此应用程序将从头开始。如果您仍然没有连接，您的应用程序将无法继续。

我的应用程序需要从我的服务器检索一些信息，并将一些其他信息发送到服务器，因此如果设备没有网络连接或丢失它，则没有必要做任何事情或处于应用程序中间。

*   如何检查连接？
*   我怎样才能回到第一个 ViewController 并重置它的所有字段？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-06T20:26:02.550

看看 Apple 的可达性示例。这在 StackOverflow 上和其他地方都有完整的介绍。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T20:26:39.083

至于视图控制器……这完全取决于您的设计……如果您使用的是`UINavigationController`：

```
[navigationController popToRootViewController:NO]; 
```

并在该控制器上强制重置

# java - 动态名称变量java（解析器创建结构）

> ID：12307830
> 
> 赞同：0
> 
> 时间：2012-09-06T20:23:02.863
> 
> 标签：java, class, variables, dynamic, linked-list

据我在任何地方都读过，您无法在 Java 中创建具有动态名称的变量，因此我将解释该问题以查看是否有替代方法。我的问题是我必须解析一个包含英文法律的长文本，它有一个层次结构：

它是这样划分的：

图书

----章节

--------文章或

图书

----标题

--------章节

-------------文章或

图书

----标题

--------章节

-------------部分

-----------------文章

如您所知，它取决于情况，结构必须有所不同。信息必须取自如下文件：

第一卷：第一卷名称 第一卷：第一卷名称 第 1 章：第 1 章名称 第 1 条：第 1 条名称 第 2 条：第 2 条名称 第 2 章：第 2 章名称 第 1 条：第 1 条名称 条3：第 3 条的名称 标题 2：……第 1 章：……第 2 册：…………第 3 册

* * *

所以你明白了，文本可能包含随机的分类，它不像首先是所有章节，然后是所有文章等等。

为此提出的实施方案是：

```
 public class Book {
   private int id;
   private List<Chapter> chapters;
   private List<Title> titles;

   // getters/setters/constructor
}

public class Chapter {
   private int id;
   private List<Section> section;
   private List<Article> articles;

   // getters/setters/constructor
}

public class Title {
   private int id;
   private List<Chapter> chapters;

   // getters/setters/constructor
}

public class Section {
   private int id;
   private List<Article> articles;

   // getters/setters/constructor
} 
```

问题是必须以动态方式创建列表。这是当解析器说我需要书号 n 中的新章节列表时，我必须创建它。

我怎样才能做到这一点？

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T20:27:46.963

最简单的解决方案是让它们都实现一个`Element`接口，然后让接口包含对其他`Element`对象的引用：

```
public interface Element {
    List<Element> getSubElements();
} 
```

然后预订：

```
public class Book implements Element {
    // Your other stuff
    private List<Element> subElements;

    public void getSubElements() {
        return subElements;
    }
} 
```

[多态性](http://en.wikipedia.org/wiki/Polymorphism_%28computer_science%29)处于最佳状态。

# vb.net - 检查 DataGridView 中的重复项

> ID：12307835
> 
> 赞同：1
> 
> 时间：2012-09-06T20:23:41.683
> 
> 标签：vb.net, datagridview

我有一个 If 和一个 nested-If ，它拒绝列值大于 0 的行。nested-If 应该检查双精度值并添加我需要的重复值，但事实并非如此。我不确定我在这里缺少什么。

```
 Dim rowValue As String
    Dim cellValue As String()

    If System.IO.File.Exists("shortlist.csv") Then

        Using streamReader As System.IO.StreamReader = New StreamReader("shortlist.csv")
            'Defines columns
            rowValue = streamReader.ReadLine()
            cellValue = rowValue.Split(",")
            With dgv.Columns
                .Add(cellValue(0).ToString, cellValue(0).ToString)
                .Add(cellValue(3).ToString, cellValue(3).ToString)
                .Add(cellValue(5).ToString, cellValue(5).ToString)
                .Add(cellValue(6).ToString, cellValue(6).ToString)
                .Add(cellValue(8).ToString, cellValue(8).ToString)
            End With

            ' Reading content
            While streamReader.Peek() <> -1
                Dim cnt As Integer = 0
                rowValue = streamReader.ReadLine()
                cellValue = rowValue.Split(",")
                If (cellValue(6) > 0) Then
                    'comparing works. need to tinnker with loop.
                    If (cellValue(0).ToString <> dgv.Rows(cnt).Cells("Phone Number").Value) Then
                        dgv.Rows.Add(cellValue(0).ToString, cellValue(3).ToString, cellValue(5).ToString, cellValue(6).ToString, cellValue(8).ToString)
                    Else
                        dgv.Rows(cnt).Cells(3).Value = (cellValue(6) + Integer.Parse(dgv.Rows(cnt).Cells(3).Value))
                        dgv.Rows(cnt).Cells(4).Value = (cellValue(8) + Integer.Parse(dgv.Rows(cnt).Cells(4).Value))
                        cnt += 1
                    End If

                End If
            End While
        End Using
    Else
        MsgBox("No File is Selected")
    End If 
```

我正在使用的 .CSV 文件有几列，第一列是电话号码。当我阅读每一行电话号码并遇到重复的电话号码时，我想将两列中的值添加到它们唯一的行中。

# javascript - 从元素的id中获取数字

> ID：12307840
> 
> 赞同：0
> 
> 时间：2012-09-06T20:23:55.483
> 
> 标签：javascript

我有一些输入如下：

```
<input type="hidden" id="selected_id-1" name="id[]" />
<input type="hidden" id="selected_id-2" name="id[]" />
<input type="hidden" id="selected_id-3" name="id[]" />
<input type="hidden" id="selected_id-5" name="id[]" /> 
```

该列表可以包含不止 4 个元素。

所以，我想从名为“id”的元素的 id 中提取最大的数字（在我们的例子中 = 5）。

需要纯 JavaScript。

**编辑：**谢谢大家回答我的问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-06T20:26:06.913

```
var number = element.id.replace(/^[^\d]+/, ""); 
```

或者

```
var number = element.id.match(/\d+/)[0]; 
```

**编辑**：刚刚看到你想得到最后一个元素：

```
var elements = document.getElementsByName("id[]");
var element = elements[elements.length - 1]; 
```

现在您可以使用我在编辑上方显示的任何一种方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-06T20:25:50.733

假设您的元素可能不是按 id 排序的，您必须检查它们以找到最高的元素。

```
var inputs = document.getElementsByTagName('input');
var highest = 0;
for(var i=0; i<inputs.length; i++) {
    if(inputs[i].name == 'id[]') {
        var current = inputs[i].id.split('-')[1];
        highest = (current > highest) ? current : highest;
    }
}
// Now highest contains the highest numeric id
console.log(highest); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-06T20:26:32.587

您可以使用正则表达式或`slice()`：

```
var num = this.id.match(/(\d+)/)[0]; 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/Mfef8/)。

或者，使用切片：

```
var num = this.id.slice(-1); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/Mfef8/1/)。

但是，带有 的选项`slice()`仅适用于一位数。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-06T20:28:57.000

这假定元素按数字顺序排列。

```
var elems = document.getElementsByName("id[]");
//or var elems = document.getElementById("formId").elements["id[]"];
//or var elems = document.formName.elements["id[]"];
//or var elems = document.forms[0].elements["id[]"];//0 is the index of the form on the page
var lastElem = elems[elems.length-1];
var lastId = lastElem.id;
var parts = lastId.split("-");
var num = parts[1];
alert(num); 
```

如果它们不是按数字顺序排列的，则需要循环并跟踪。

```
function getNumber(elem){
    return parseInt(elem.id.split("-")[1],10);
}

var elems = document.getElementsByName("id[]");
var max = getNumber(elems[0]);
for (var i=1;i<elems.length;i++) {
    var num = getNumber(elems[i]);
    if (num>max) {
        max = num;
    }
}
alert(max); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-06T20:34:44.317

使用 jQuery 之类的东西更容易做到这一点，因为它会为您处理所有困难的部分。但是，如果您使用的是现代浏览器，则可以这样做：

```
var highestNum = (function() {
    var highest = 0, r = /\-(\d+)$/, i, elems = document.getElementsByName("id[]");
    for(i=0; i<elems.length; i++) {
        highest = Math.max(highest, +elems[i].id.match(r)[1]);
    }

    return highest;
}); 
```

这也说明了元素可能出现故障。~~尽管它依赖于一个相当新的浏览器来工作（IE>=8 或任何不是 IE 的东西）。如果您想要对 IE6 之类的东西提供后备支持，最好的选择是使用 jQuery 或其他此类库。~~使用 jQuery，解决方案将是这样的：

```
var highestNum = (function() {
    var highest = 0, r = /\-(\d+)$/;

    $("input[name='id[]']").each(function() {
         highest = Math.max(highest, +this.id.match(r)[1]);
    });

    return highest;
}); 
```

**更新：**我欺骗了别人的解决方案，使它对 IE6 更友好。jQuery 解决方案仍然稍微简单一些，但 vanilla 解决方案应该适合您的需求。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-06T20:39:42.927

假设您的表单是页面上的第一个表单，您可以执行以下操作：

```
var c = document.forms[0].children;

for( var i=0; i<c.length; i++ ) {
    var prefix = "selected_id-";
    if( c[i].id.search( prefix )===0 )
        console.log( c[i].id.substring( prefix.length ) );
} 
```

​</p>

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-09-06T20:45:31.897

```
function check(){
 var form = document.forms[0];
 var txtS =  form["id[]"];
 var len = txtS.length;
var numb =txts[len-1].split('-')[1]
} 
```

或者你可以使用

```
var elementgroup = document.getElementsByName("id[]");
var nub= elementgroup[elementgroup .length - 1].split('-')[1]; 
```

# linux - 为什么我不能在 localhost 上访问 Xampp 的 phpmyadmin？禁止访问。

> ID：12307842
> 
> 赞同：12
> 
> 时间：2012-09-06T20:24:01.333
> 
> 标签：linux, ubuntu, phpmyadmin, xampp

我可以在 ubuntu 上使用 phpmyadmin 在 Xampp 上访问 localhost。我可以看到我完全清除并为之编写的 /htdocs 的内容。我想访问 phpmyadmin，但不能。

加载 phomyadmin 时，我收到一个 403 错误和一条建议我配置文件中的设置的注释`httpd-xampp.conf`。我看了看`/opt/lampp/etc/extra/httpd-xampp.conf`，但不知道要配置什么。

在这种情况下，文件中的两个区域似乎很有用：

```
<Directoy "/opt/lampp/phpmyadmin">
    AllowOverride AuthConfig Limit
    Order allow,deny
    Deny From all
</Directory> 
```

和

```
#
# New XAMPP security concept
#

<LocationMatch "^/(?:xampp|security|licenses|phpmyadmin|webalizer|server-status|server-info))">
    Order deny,allow
    Deny from all
    Allow from ::1 127.0.0.0/8 \
    fc00::/7 10.0.0.0/8 172.16.0.0/12 192.168.0.0/16 \
    fe00::/10 169.254.0.0/16

    ErrorDocument 403 /error/XAMPP_FORBIDDEN.html.var
</LocationMatch> 
```

在这两个部分中，我尝试将“全部拒绝”更改为“全部允许”并使用命令重新启动 Xampp `sudo /opt/lampp/lampp restart`。我收到了与以前相同的错误页面。我尝试了网上找到的其他解决方案，但都没有奏效。

我必须配置什么才能访问 phpmyadmin？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-01-30T11:30:06.080

[可以在这里找到解决方案](http://www.apachefriends.org/f/viewtopic.php?f=17&t=50902&p=196185#p196185)。总结如下：

编辑`/opt/lampp/etc/extra/httpd-xampp.conf`.

将该行添加`Require all granted`到块的底部，`<Directory "/opt/lampp/phpmyadmin">`如下所示：

```
<Directory "/opt/lampp/phpmyadmin">
  AllowOverride AuthConfig Limit
  Order allow,deny
  Allow from all
  Require all granted
</Directory> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-17T20:24:55.543

我通过创建一个新的虚拟主机来解决这个问题`phpmyadmin`

## 对于 Windows 系统：

将以下内容附加到`C:/xampp/apache/conf/httpd.conf`：

```
NameVirtualHost phpmyadmin.local

<VirtualHost phpmyadmin.local>
  ServerName phpmyadmin.local
  DocumentRoot "C:/xampp/htdocs/phpmyadmin"
  <Directory "C:/xampp/htdocs/phpmyadmin">
    AllowOverride All
    Allow from All
  </Directory>
</VirtualHost> 
```

将 更改为`DocumentRoot/Directory`安装版本的路径`phpmyadmin`。

在文本编辑器中打开`C:\Windows\System32\drivers\etc\hosts`文件并添加以下行：

```
127.0.0.1     phpmyadmin.local 
```

然后保存主机文件并重新启动`xampp`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-06T06:31:04.730

# 尝试这个

新的 XAMPP 安全概念

在 httpd-xampp.conf 中搜索

```
<LocationMatch "^/(?i:(?:xampp|security|phpmyadmin|licenses|webalizer|server-status|server-info))">
        Require local
    ErrorDocument 403 /error/XAMPP_FORBIDDEN.html.var
</LocationMatch> 
```

# 替换为或删除 phpmyadmin

```
<LocationMatch "^/(?i:(?:xampp|security|licenses|webalizer|server-status|server-info))">
        Require local
    ErrorDocument 403 /error/XAMPP_FORBIDDEN.html.var
</LocationMatch> 
```

# sqlite - 如何确定 SQLite 中的保存点之间是否进行了任何更改？

> ID：12307851
> 
> 赞同：1
> 
> 时间：2012-09-06T20:24:19.563
> 
> 标签：sqlite, transactions, delta

我想知道是否有人知道是否可以确定自创建给定保存点以来是否进行了更改。我正在考虑使用它来确定用户是否进行了更改，然后在移动到另一个页面/关闭应用程序之前询问他是否要保存。

在此先感谢，艾坦。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T20:55:36.687

`total_changes()`检查(SQL) 或(C)的返回值`sqlite3_total_changes()`是否增加。（但是，这确实包括来自回滚保存点/事务的更改。）

# python - 如何让matplotlib重绘轴

> ID：12307854
> 
> 赞同：-2
> 
> 时间：2012-09-06T20:25:01.350
> 
> 标签：python, user-interface, numpy, matplotlib, tkinter

这是我已经研究了一段时间的程序，我已经在这里获得了一些很好的故障排除技巧。

它运行得很好，速度不是主要问题，因为它只是应该直观地了解不同的图表如何随着不同的输入而变化。但是，我怎样才能让图表完全变成 REDRAW，而不仅仅是线条（它在旧轴的顶部重新绘制每个轴而不清除它，所以它会堆积起来并很快陷入困境）。

谢谢大家！

```
#!/usr/apps/Python/bin/python
import matplotlib, sys
matplotlib.use('TkAgg')
from numpy import arange, sin, pi
from matplotlib.backends.backend_tkagg import FigureCanvasTkAgg, NavigationToolbar2TkAgg
from matplotlib.figure import Figure
from Tkinter import *
import math
from matplotlib import pylab
import scipy
from scipy.stats import norm

master = Tk()
master.title("DePaul University Interactive Options Graphs")

pricePlot = Figure(figsize=(4,3), dpi=100, frameon=False)
a = pricePlot.add_subplot(111)
a.set_title('The Greeks')
priceDataPlot = FigureCanvasTkAgg(pricePlot, master=master)
priceDataPlot.get_tk_widget().grid(column=1, columnspan=2, row=1, rowspan=2)

vegaPlot = Figure(figsize=(4,3.5), dpi=75, frameon=False)
b = vegaPlot.add_subplot(1,1,1)
b.set_title('Vega')
vegaDataPlot = FigureCanvasTkAgg(vegaPlot, master=master)
vegaDataPlot.get_tk_widget().grid(row=2)

deltaPlot = Figure(figsize=(4,3.5), dpi=75, frameon=False)
c = deltaPlot.add_subplot(111)
c.set_title('Delta')
deltaDataPlot = FigureCanvasTkAgg(deltaPlot, master=master)
deltaDataPlot.get_tk_widget().grid(row=0,rowspan=2)

gammaPlot = Figure(figsize=(4,3.5), dpi=75, frameon=False)
d = gammaPlot.add_subplot(111)
d.set_title('Gamma')
gammaDataPlot = FigureCanvasTkAgg(gammaPlot, master=master)
gammaDataPlot.get_tk_widget().grid(column=3,row=2)

rhoPlot = Figure(figsize=(4,3.5), dpi=75, frameon=False)
e = rhoPlot.add_subplot(111)
e.set_title('Rho')
rhoDataPlot = FigureCanvasTkAgg(rhoPlot, master=master)
rhoDataPlot.get_tk_widget().grid(column=3,row=3)

thetaPlot = Figure(figsize=(4,3.5), dpi=75, frameon=False)
f = thetaPlot.add_subplot(111)
f.set_title('Theta')
thetaDataPlot = FigureCanvasTkAgg(thetaPlot, master=master)
thetaDataPlot.get_tk_widget().grid(column=3,row=0,rowspan=2)

a3Plot = Figure(figsize=(4,3.5), dpi=75, frameon=False)
g = a3Plot.add_subplot(111)
g.set_title('Price')
a3DataPlot = FigureCanvasTkAgg(a3Plot, master=master)
a3DataPlot.get_tk_widget().grid(row=3)

CallPutFlag='c'

def changePut():
    CallPutFlag='p'
    print CallPutFlag

def changeCall():
    CallPutFlag='c'
    print CallPutFlag

def main():

    T=250                                 # This will 
    timeSpread = range(T-200,T+200,20)    # all be user
                                          # inputted
                                          # values through
                                          # Tkinter GUI
                                          # 
                                          # JV 7/27/2012

    r=float(interestRate.get())
    S=float(stockPrice.get())
    K=float(strikePrice.get())
    v=float(volatility.get())

    def BlackScholes(t):

            d1 = (math.log(S/K)+(r+v*v/2.)*(float(t)/365))/(v*math.sqrt((float(t)/365)))
            d2 = d1-v*math.sqrt((float(t)/365))

            if CallPutFlag=='c':

                    return S*scipy.stats.norm.cdf(d1)-K*math.exp(-r*float(t))*scipy.stats.norm.cdf(d2)

            else:

                    return K*math.exp(-r*float(t))*scipy.stats.norm.cdf(-d2)-S*scipy.stats.norm.cdf(-d1)

    def delta(t):

            d1 = (math.log(S/K)+(r+v*v/2.)*(float(t)/365))/(v*math.sqrt((float(t)/365)))
            d2 = d1-v*math.sqrt((float(t)/365))

            if CallPutFlag=='c':
                    callDelta = scipy.stats.norm.cdf(d1)

                    return callDelta

            else:
                    putDelta = -scipy.stats.norm.cdf(-d1)

                    return putDelta

    def gamma(t):

            d1 = (math.log(S/K)+(r+v*v/2.)*(float(t)/365))/(v*math.sqrt((float(t)/365)))
            d2 = d1-v*math.sqrt((float(t)/365))
            gamma = scipy.stats.norm.pdf(d1)/(S*v*math.sqrt(float(t)))

            return gamma

    def rho(t):
            d1 = (math.log(S/K)+(r+v*v/2.)*(float(t)/365))/(v*math.sqrt((float(t)/365)))
            d2 = d1-v*math.sqrt((float(t)/365))

            if CallPutFlag=='c':
                    callRho = (K*t*scipy.stats.norm.cdf(d2)/100)*math.e**-(r*t)

                    return callRho

            else:
                    putRho = (-K*t*scipy.stats.norm.cdf(-d2)/100)*math.e**-(r*t)

                    return putRho

    def vega(t):
            d1 = (math.log(S/K)+(r+v*v/2.)*(float(t)/365))/(v*math.sqrt((float(t)/365)))

            return S*scipy.stats.norm.pdf(d1)*math.sqrt(float(t))/100

    def theta(t):

        d1 = (math.log(S/K)+(r+v*v/2.)*(float(t)/365))/(v*math.sqrt((float(t)/365)))
        d2 = d1-v*math.sqrt((float(t)/365))
        b = math.e**-(r*t)

        if CallPutFlag=='c':

                callTheta = -S*scipy.stats.norm.pdf(d1)*v/(2*math.sqrt(float(t))-r*K*b*scipy.stats.norm.cdf(d2))

                return callTheta

        else:
                putTheta = -S*scipy.stats.norm.pdf(d1)*v/(2*math.sqrt(float(t))+r*K*b*scipy.stats.norm.cdf(-d2))

                return putTheta

    tprices = [BlackScholes(i) for i in timeSpread]
    tdeltas = [delta(i) for i in timeSpread]
    tgammas = [gamma(i) for i in timeSpread]
    trhos = [rho(i) for i in timeSpread]
    tvegas = [vega(i) for i in timeSpread]
    tthetas = [theta(i) for i in timeSpread]

    a.cla()
    a.plot(timeSpread,tdeltas,'g-')
    a.plot(timeSpread,tgammas,'b-')
    a.plot(timeSpread,trhos,'m-')
    a.plot(timeSpread,tvegas,'r-')
    a.plot(timeSpread,tthetas,'c-')
    priceDataPlot.show()

    line, = b.plot(timeSpread,tvegas,'r-')
    vegaDataPlot.show()
    line.remove()

    line, = c.plot(timeSpread,tdeltas,'g-')
    deltaDataPlot.show()
    line.remove()

    line, = d.plot(timeSpread,tgammas,'b-')
    gammaDataPlot.show()
    line.remove()

    line, = e.plot(timeSpread,trhos,'m-')
    rhoDataPlot.show()
    line.remove()

    line, = f.plot(timeSpread,tthetas,'c-')
    thetaDataPlot.show()
    line.remove()

    line, = g.plot(timeSpread,tprices,'k-')
    a3DataPlot.show()
    line.remove()

##photo=PhotoImage(file='/Users/jaredvacanti/Desktop/Depaul.gif')
##Label(master, image=photo).grid()

w = Label(master, text="DePaul University Department of Finance \nInteractive Options Graphs")
w.grid(row=0,column=1,columnspan=2,pady=100)

r1 = Radiobutton(master, variable=CallPutFlag, value='c', text="Call",command=lambda root=master:main())
r2 = Radiobutton(master, variable=CallPutFlag, value='p', text="Put",command=lambda root=master:main())
r1.grid(row=0,column=1,columnspan=2,pady=50, sticky=N)
r2.grid(row=0,column=1,columnspan=1,pady=50, sticky=N)

interestRate = Scale(master, from_=0, to=5,orient=HORIZONTAL,label='Interest Rate', command=lambda root=master:main())
interestRate.set(1)
interestRate.grid(row=3,column=2)
stockPrice = Scale(master, from_=0, to=100,orient=HORIZONTAL,label='Stock Price', command=lambda root=master:main())
stockPrice.set(10.0)
stockPrice.grid(row=3,column=1,pady=10)
strikePrice = Scale(master, from_=0, to=100,orient=HORIZONTAL,label='Strike Price', command=lambda root=master:main())
strikePrice.set (11.0)
strikePrice.grid(row=3,rowspan=2,column=1,sticky=N)
volatility = Scale(master, from_=0, to=10,orient=HORIZONTAL,label='Volatility', command=lambda root=master:main())
volatility.set(1)
volatility.grid(row=3,rowspan=2,column=2,sticky=N)

def quit(master):
    master.destroy()

Button(master, borderwidth=0, bg='gray', text="Quit", command=lambda root=master:quit(master)).grid(row=3,rowspan=2,column=2,sticky=S,pady=30)
Button(master, borderwidth=0, bg='gray', text="Calculate").grid(row=3,rowspan=2, column=1,columnspan=1,sticky=S,pady=30)

main()
master.mainloop() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T06:30:47.617

`frameon=False`创建 Figure 对象时删除：

```
Figure(figsize=(4,3), dpi=100) 
```

如果希望 Figure 的背景颜色与 Tk 窗口相同，可以通过`facecolor`参数设置：

```
Figure(figsize=(4,3), dpi=100, facecolor=TK_BACKGROUND_COLOR) 
```

在我的系统上：

```
TK_BACKGROUND_COLOR = (212.0/256,208.0/256,200.0/256) 
```

# c# - 网格视图以显示选中的复选框并仅更改唯一行的背景颜色

> ID：12307859
> 
> 赞同：0
> 
> 时间：2012-09-06T20:25:15.310
> 
> 标签：c#, asp.net, vb.net

如何：添加背景颜色为蓝色的数据行和“选中”复选框，但其余部分的背景颜色为蓝色

请参阅下面的代码。谢谢您的帮助

```
Dim table2 As New DataTable
' Create four typed columns in the DataTable.
table2.Columns.Add("ID", GetType(Integer))
table2.Columns.Add("Drug", GetType(String))
table2.Columns.Add("Patient", GetType(String))
table2.Columns.Add("Date", GetType(DateTime))
' Add five rows with those columns filled in the DataTable.
table2.Rows.Add(25, "Indocin", "David", DateTime.Now)
table2.Rows.Add(50, "Enebrel", "Sam", DateTime.Now)
table2.Rows.Add(10, "Hydralazine", "Christoff", DateTime.Now)
table2.Rows.Add(21, "Combivent", "Janet", DateTime.Now)
table2.Rows.Add(10, "Dilantin", "Melanie", DateTime.Now)
table2.Rows.Add(125, "Indocin", "David", DateTime.Now)
table2.Rows.Add(150, "Enebrel", "Sam", DateTime.Now)
table2.Rows.Add(2, "Hydralazine", "Christoff", DateTime.Now)

'GridView1.DataSource = table2

For Each dr As DataRow In table2.Rows

    If dr("ID") = 21 Or dr("ID") = 150 Then

        ' add  a data row with a back ground colour - blue and check check box

    Else

        ' add  a data row with a back ground colour - yellow

    End If

Next

GridView1.DataBind() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T21:13:11.900

我会将 DataTable 绑定到 GridView 并通过[RowDataBound Event](http://msdn.microsoft.com/en-US/library/system.web.ui.webcontrols.gridview.rowdatabound%28v=vs.80%29)进行处理。

```
Sub GridView1_RowDataBound(ByVal sender As Object, ByVal e As GridViewRowEventArgs) Handles GridView1.RowDataBound

    'Assuming your ID column is in the first cell.
    If e.Row.RowType = DataControlRowType.DataRow AndAlso _
       (e.Row.Cells(0).Text = "21" OrElse e.Row.Cells(0).Text = "150") Then

        e.Row.BackColor = Drawing.Color.Blue

        'Assuming CheckBox is in the second cell with ID of "IdOfCheckBox"
        CType(e.Row.Cells(1).FindControl("IdOfCheckBox"), CheckBox).Checked = True

    End If

End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T21:10:35.257

```
Sub GridView_RowDataBound(ByVal sender As Object, _
  ByVal e As System.Web.UI.WebControls.GridViewRowEventArgs)

    If e.Row.RowType = DataControlRowType.DataRow Then
                If (Check your condition ) Then
                e.Row.BackColor = Drawing.Color.Blue
                'Then find your checkbox control from row and set it's value to Checked...

   ELSE
     e.Row.BackColor = Drawing.Color.yellow

 End If
    End If
End Sub 
```

# regex - 用于查找和替换动态 URL 的正则表达式

> ID：12307862
> 
> 赞同：-2
> 
> 时间：2012-09-06T20:25:30.693
> 
> 标签：regex, url, replace

我需要从 XML 文件中清除 120,000 个动态 URL。如何编写正则表达式来查找“？” 一行中的字符，然后删除该行（或用空格替换它）

需要删除的行示例：

```
<url>http://www.website.com/order/index.asp?type=something%20something&DisplayName=N&Material=blah</url> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T20:53:27.627

您的正则表达式将只是：

```
<url>.*?\?.*?<\/url> 
```

如果你想用 C# 替换它，那么：

```
 String sourcestring = "BlahBlahBlah\n<url>http://www.website.com/order/index.asp?type=something%20something&DisplayName=N&Material=blah</url>\nBlah?BlahB?lah\nBlahBla?hBlah\n<url>http://www.website.com/order/index.asp?type=something%20somethi\nng&DisplayName=N&Material=blah</url>\nBlahBlahBlah";
  String matchpattern = @"<url>.*?\?.*?<\/url>";
  String replacementpattern = @"";
  Console.WriteLine(Regex.Replace(sourcestring,matchpattern,replacementpattern,RegexOptions.Multiline | RegexOptions.Singleline)); 
```

请注意，这会将 url 标记替换为空格，即使它们像示例文本中所示那样进入下一行。

*替换前的示例文本：*

*   等等等等等等
*   <url>http://www.website.com/order/index.asp?type=something%20something&DisplayName=N&Material=blah</url>
*   等等等等等等
*   等等等等等等
*   <url>http://www.website.com/order/index.asp?type=something%20somethi
*   ng&DisplayName=N&Material=blah</url>

*替换后的结果文本：*

> 等等等等等等
> 
> 哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇哇
> 
> 等等等等等等

* * *

**更新：**
如果您使用的是 Notepad++，则需要在“查找/替换”对话框中选中*匹配换行符*复选框（以便匹配溢出的 url 标记行，因为`.`在正则表达式中不匹配 CR/LF。

另一种方法是使用 Ωmega 的正则表达式，因为它匹配除其类中的字符之外的所有内容：`<url>[^<?]*\?[^<]*<\/url>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T20:33:24.327

一个简单`gsub`的红宝石就可以了。例如用问号代替空格：

```
string_containing_urls = "<url>http://example.com?sdfhkldj</url>\n<url>http://example.com</url>"
string_containing_urls.gsub(/\?/, ' ') # => "<url>http://example.com sdfhkldj</url>\n<url>http://example.com</url>" 
```

如果您想`<url> ... </url>`用空格替换标签之间的任何 url，您可以使用以下内容：

```
string_containing_urls = "<url>http://example.com?sdfhkldj</url>\n<url>http://example.com</url>"
string_containing_urls.gsub(/<url>.*\?.*<\/url>/, ' ') # => " \n<url>http://example.com</url>" 
```

以下将删除整行

```
string_containing_urls = "<url>http://example.com?sdfhkldj</url>\n<url>http://example.com</url>"
string_containing_urls.gsub(/<url>.*\?.*<\/url>\n/, '') # => "<url>http://example.com</url>" 
```

类似的替换功能也可以在大多数其他语言中使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-06T20:37:52.833

替换`<url>[^<?]*\?[^<]*<\/url>`为空字符串

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-06T20:39:08.170

就像是

```
(<url>http://[^?<]+)(\?[^<]*)(</url>) 
```

应该管用。如果您只想摆脱动态部分，请返回 1 美元 3 美元。如果要删除整行，请执行

```
(<url>http://[^?<]+\?[^<]*</url>) 
```

并用空字符串替换。如果您以每行为基础运行它，那么如果没有“？”，它就不会匹配任何东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-06T20:39:41.277

假设您的文件名为`input.txt`包含：

```
<urls>
     <url>http://www.google.com/search?type=something%20something&DisplayName=N&Material=blah</url>
     <url>http://www.yahoo.com/finance</url>
     <url>http://www.stackoverflow.com/questions?type=somestuff</url>
     <url>http://www.facebook.com/person?type=someotherstuff</url>
     <url>http://www.amazon.com/order/index.asp</url>
</urls> 
```

使用[sed](http://www.grymoire.com/Unix/Sed.html)命令：

```
sed '/<url>.*\?.*<\/url>/d' input.txt >> output.txt 
```

然后输出将是：

```
<urls>
     <url>http://www.yahoo.com/finance/</url>
     <url>http://www.amazon.com/order/index.asp</url>
</urls> 
```

# ios - 如果 deviceToken 错误，则推送通知不发送给其他人

> ID：12307879
> 
> 赞同：0
> 
> 时间：2012-09-06T20:26:43.887
> 
> 标签：ios, push-notification, apple-push-notifications

我已经制作了一个代码，可以在许多保存在 db 上的设备上发送推送通知（用于分发），我已经制作了 php：

```
// Put your alert message here:
$message = "send push";
// Put your private key's passphrase here:
$passphrase = 'phrase';
$ctx = stream_context_create();
stream_context_set_option($ctx, 'ssl', 'local_cert', 'apns.pem');
stream_context_set_option($ctx, 'ssl', 'passphrase', $passphrase);

// Open a connection to the APNS server
$fp = stream_socket_client(
'ssl://gateway.push.apple.com:2195', $err,
$errstr, 60, STREAM_CLIENT_CONNECT|STREAM_CLIENT_PERSISTENT, $ctx);

if (!$fp)
    exit("Failed to connect: $err $errstr" . PHP_EOL);
echo 'Connected to APNS'. "<br>" ;
ob_flush();
flush();

// Create the payload body
$body['aps'] = array(
'alert' =&gt; $message,
'sound' =&gt; 'default'
);

// Encode the payload as JSON
$payload = json_encode($body);
if (mysql_num_rows($results)!=0) {
    while($row = mysql_fetch_array($results))
    {
        $deviceToken= $row['deviceToken'];

        if(isset($deviceToken)&&(strcmp($deviceToken,"(null)")!=0)){
            echo "<br>".$deviceToken."<br>";
            // Build the binary notification
            $msg = chr(0) . pack('n', 32) . pack('H*', $deviceToken) . pack('n', strlen($payload)) . $payload;
            $result = fwrite($fp, $msg, strlen($msg));
            if (!$result)
                echo 'Message not delivered';
            else
                echo 'Message successfully delivered' ;
            ob_flush();
            flush();
        }
    }
    // Close the connection to the server
    fclose($fp);
} 
```

如果我在 db 上有，只有 deviceToken 正确或具有值（null），则发送消息，但如果我有一个 deviceToken 错误，我会收到消息“消息已成功传递”，该消息已发送所有消息但不起作用。我在哪里犯了错误？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T20:46:25.050

You does nothing wrong, this is an apple quality control. I met this phenomenon, and - if I remember well - if the structure of the device token was invalid, no push notification was delivered...

So, if you have a valid token, which currently does not belong to a device (e.g the device has removed your app), your other push notification will be delivered, but if a token seems to have an absolutely incorrect structure, no push notification will be delivered.

So, this phenomenon will not be dangerous for your production system, because your device will register a valid token to your provider's DB.

Maybe more details are between the comment of this tutorial: [http://www.raywenderlich.com/3443/apple-push-notification-services-tutorial-part-12](http://www.raywenderlich.com/3443/apple-push-notification-services-tutorial-part-12)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T22:44:30.153

这是无法做到的。没有可靠的方法来判断推送通知是否成功发送。有替代品，但它们不是即时的，也不那么可靠。

1.  确保应用程序安装在用户设备上。
2.  将逻辑添加到您的应用程序以在收到推送通知时发布到您的数据库。这样你就知道推动是好的。这样做的缺点是推送通知并不总是即时的，因此可能会有延迟。

一位用户对此进行了解释，并在另一篇文章中给出了一些链接。[如何从我们的服务器中找到发送给用户的 Apple 推送通知？](https://stackoverflow.com/questions/10493145/how-to-find-the-apple-push-notification-delivered-to-user-or-not-from-our-server)

# python - 命令行 tar 和 shutil.make_archive 之间的区别？

> ID：12307880
> 
> 赞同：2
> 
> 时间：2012-09-06T20:26:52.883
> 
> 标签：python, tar

`tar cfz cl.tar.gz Sources`当我使用与 python 相比生成 tar.gz 文件时`shutil.make_archive ( "py", "gztar", "Sources" )`，我得到不同的结果：

```
$ tar -tf cl.tar.gz | head -3
algorithm/
aligned_storage.hpp
algorithm/cxx11/

$ tar -tf py.tar.gz | head -3
./algorithm/
./aligned_storage.hpp
./algorithm/cxx11/ 
```

大多数情况下，这没有什么区别。但是如果你`--strip-components`在解压缩时通过了，那么这两个档案的行为会有所不同。

我真的很想从 python 代码中获得与我从 shell 脚本中所做的相同的结构，但我不太确定如何做到这一点。我在 Mac OS 10.8.1 上使用 Python 2.7.3，如果有区别的话。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T20:47:33.030

make_archive函数有两个参数[，](http://docs.python.org/library/shutil.html#shutil.make_archive)`root_dir`和`base_dir`. 如果将 base_dir 设置为其他值，它会去掉`./`前缀。例如：

```
$ tree
.
├── blah
│   ├── file1
│   └── file2

$ python
>>> import shutil
>>> shutil.make_archive("test", "gztar", ".", "blah")

$ tar -tf test.tar.gz 
blah/
blah/file1
blah/file2 
```

这仅限于单个目录。如果要添加多个这样的目录或文件，则必须直接使用[tarfile](http://docs.python.org/library/tarfile.html)模块。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T20:31:02.583

直接使用[`tarfile`](http://docs.python.org/library/tarfile.html)，这将允许您将您喜欢的任何文件名编码到存档中。

# asp.net-mvc-3 - 带有复选框的 MVC3 Webgrid

> ID：12307883
> 
> 赞同：0
> 
> 时间：2012-09-06T20:27:26.873
> 
> 标签：asp.net-mvc-3, checkbox, webgrid

我是MVC3的新手...

我正在尝试显示一个网格（3 列），其中包含学生列表（在第 1 列中），第 2 列和第 3 列中带有复选框。这些列的标题按顺序排列：`student Name, Seminar1 & Seminar 2`。复选框将代表学生是否参加了每个研讨会。

两条信息（学生和研讨会）来自数据库中未连接的表。所以，我正在考虑这种方法：

1.  在控制器中创建一个数据表。
2.  使其成为模型类中的属性
3.  在视图中的 webgrid 中显示它

最后，我希望能够显示具有正确值的复选框，捕获它们的 CHECKED 事件，并且最好将其全部设为 ajaxable

如果我在控制器中进行与视图相关的工作，我是否违反了任何规则？如果我不应该如何在 Webgrid 中做到这一点？你会如何处理它？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T20:36:24.003

我通常将 JQGrid 用于此类表。你可以在这里看到一个例子：[ASP.Net MVC 3 JQGrid](https://stackoverflow.com/questions/5092866/asp-net-mvc-3-jqgrid)

您可以将 Student 对象作为模型，并使用 linq 和 Entity Framework 返回学生列表。

JQGrid 也支持 Ajax。这里有更多的演示：[http ://www.trirand.com/blog/jqgrid/jqgrid.html](http://www.trirand.com/blog/jqgrid/jqgrid.html)

# database - 重新审视数据建模 - 坚持旧身份？

> ID：12307886
> 
> 赞同：0
> 
> 时间：2012-09-06T20:27:39.980
> 
> 标签：database, sql-server-2005, datamodel

我一直在重新审视为什么我一直在 SQL Server 2005 数据建模中做某些事情。

我习惯性地使用标识作为表键，为应该唯一的实际数据创建唯一索引，而不是关闭它。

所以，如果我有一张学生桌，我可能会有：

```
ID identity primary key,
StudentIdentifier char(8) 
```

我会在 StudentIdentifier 上放置一个唯一索引，因为这是大学用来引用学生的代码，但我会将 Student.ID 存储在引用 Student 的任何表中。

在 SQL Server（2005 版）中使用自动编号标识字段仍然是一个好习惯吗？

还 -

我使用 int 代码来查找值并将这些 int 存储在相应的引用表中。

例如，我可能有一个这样的工作流表：

```
id  statuscode      DESCRIPTION         
1   CIProgress      CI Grade in Progress
2   Finalized       Finalized           
3   NeedsSingle     Needs Single Read   
4   NeedsFirst      Needs First Read    
5   SingleProgress  Single Read in Progress 
```

在具有工作流属性的表中，我将存储 id (1)，然后加入工作流表以获取状态代码或描述。

例如，可以存储状态码吗？通过在短代码上使用 int 可以获得多少效率？

自从我开始编码以来的 15 年里，我已经看到了很多实现，我突然想到，也许我正在把旧的“规则”铭记在心，而不考虑实践。

# php - 需要帮助将行添加到交叉引用表

> ID：12307894
> 
> 赞同：-1
> 
> 时间：2012-09-06T20:28:37.577
> 
> 标签：php, mysql, sql, relational-database, database-normalization

我正在为我的厨房应用程序编写一个食谱脚本（php/mysql），使用这些表：

```
ingredients
-----------
ingredient_id (PK)
ingredient_name 
```

*（一种成分可以是许多食谱的一部分）*

```
recipes
-------
recipe_id (PK)
recipe_name 
```

*（一个食谱可以有很多成分）*

```
recipe_ingredients_map
---------------------
recipe_id_map (FK)
ingredient_id_map (FK) 
```

添加新配方时，我需要在 recipe_ingredients_map 表中为配方中的每种成分插入一行。我无法弄清楚如何为所有这些编写查询。请救救我好吗？=P

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T20:38:21.717

不要尝试为所有 3 个表编写插入查询。

*   首先插入一个食谱。
*   接下来插入一些成分。
*   最后在recipe_ingredients_map中链接在一起。

您的 recipe_ingredients_map 缺少主键。

如果需要，您可以将其全部包含在事务中。

# javascript - jQuery 表格滚动

> ID：12307898
> 
> 赞同：1
> 
> 时间：2012-09-06T20:28:54.287
> 
> 标签：javascript, jquery, html-table

在过去的两天里，我一直在为这段代码苦苦挣扎，也许有人可以指出我正确的方向？

基本上这个表需要像 jQuery 日历一样工作，点击顶部的下一个按钮应该带你到下一列 + 突出显示，并且顶部的“事件 1”块中的内容也应该改变，一旦你位于最后一列，然后单击下一步，将新列滑入表中，因此它从 E2-E7 开始，依此类推。

我开始认为这在 jQuery 中甚至是不可能的，但话又说回来，我的 jQuery 技能相当生锈。谁能告诉我我想要的是否可能以及提示或帮助？

代码可以在这里找到：http: [//jsfiddle.net/yunowork/wDAdp/2/](http://jsfiddle.net/yunowork/wDAdp/2/)

 `* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T20:48:24.637

演示：http: [//jsfiddle.net/wDAdp/5/](http://jsfiddle.net/wDAdp/5/)

```
$(".next").click(function(e){
    e.preventDefault();
    var $nextCol = $('.highlighted').next('td'); // Grab the next column
    if($nextCol.length != 0){ //If it exists
        $('.highlighted').removeClass("highlighted"); //Remove previous highlight
        $nextCol.addClass("highlighted"); // add highlight to the new column
    }else{
        // Add a new column here.
    }
}); 
```

这并不是您所要求的一切，但足以为您提供一个坚实的开端。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-09-04T07:33:45.737

你仍然找到你需要的东西吗？

如果没有，您可以执行以下操作。

HTML

```
<table class="tbl-1">
<tbody>

    <tr>
      <td colspan="2" class="emptyrace"></td>
      <td colspan="6" class="race"><a class="previous" href="#">◄&lt;/a><span class="event"></span><a class="next" href="#">►&lt;/a></td>
    </tr>
    <tr>
      <td colspan="2" class="raceorder"><strong>Player</strong></td>
      <td id="r1" data-e1="Event 1" data-e2="Miami - 10:00" class="roundnumber"><strong>E1</strong></td>
      <td id="r2" data-e1="Event 2" data-e2="Miami - 10:00" class="roundnumber"><strong>E2</strong></td>
      <td id="r3" data-e1="Event 3" data-e2="Miami - 10:00" class="roundnumber"><strong>E3</strong></td>
      <td id="r4" data-e1="Event 4" data-e2="Miami - 10:00" class="roundnumber"><strong>E4</strong></td>
      <td id="r5" data-e1="Event 5" data-e2="Miami - 10:00" class="roundnumber"><strong>E5</strong></td>
      <td id="r6" data-e1="Event 6" data-e2="Miami - 10:00" class="roundnumber"><strong>E6</strong></td>
      <td id="r7" data-e1="Event 7" data-e2="Miami - 10:00" class="roundnumber"><strong>E7</strong></td>
    </tr>
    <tr class="selectionrow">
      <td colspan="2">Jeff</td>
      <td id="r1"><input type="checkbox" name="race1" value="R1"></td>
      <td id="r2"><input type="checkbox" name="race1" value="R2"></td>
      <td id="r3"><input type="checkbox" name="race1" value="R3"></td>
      <td id="r4"><input type="checkbox" name="race1" value="R4"></td>
      <td id="r5"><input type="checkbox" name="race1" value="R5"></td>
      <td id="r6"><input type="checkbox" name="race1" value="R6"></td>
      <td id="r6"><input type="checkbox" name="race1" value="R6"></td>
    </tr>
    <tr class="selectionrow">
      <td colspan="2">Kevin</td>
      <td id="r1"><input type="checkbox" name="race2" value="R1"></td>
      <td id="r2"><input type="checkbox" name="race2" value="R2"></td>
      <td id="r3"><input type="checkbox" name="race2" value="R3"></td>
      <td id="r4"><input type="checkbox" name="race2" value="R4"></td>
      <td id="r5"><input type="checkbox" name="race2" value="R5"></td>
      <td id="r6"><input type="checkbox" name="race2" value="R6"></td>
      <td id="r6"><input type="checkbox" name="race2" value="R6"></td>
    </tr>
    <tr class="selectionrow">
      <td colspan="2">William</td>
      <td id="r1"><input type="checkbox" name="race3" value="R1"></td>
      <td id="r2"><input type="checkbox" name="race3" value="R2"></td>
      <td id="r3"><input type="checkbox" name="race3" value="R3"></td>
      <td id="r4"><input type="checkbox" name="race3" value="R4"></td>
      <td id="r6"><input type="checkbox" name="race3" value="R5"></td>
      <td id="r6"><input type="checkbox" name="race3" value="R6"></td>
      <td id="r6"><input type="checkbox" name="race3" value="R6"></td>
    </tr>
  </tbody>
</table> 
```

JAVASCRIPT

```
$.fn.c_tbl = function(){

    var range       = parseInt($("tr:eq(0) td:eq(1)",this).attr("colspan")); // range for visiblity(td) based on colspan

    $("tr",this) // Find all tr and its td
    .not("tr:eq(0)").each(function(m,n){
        $(this).find("td:not(:eq(0))").each(function(x,y){
            if(x>=range)
                $(this).hide(); // Hide the rest of the td that outside of range (colspan)
        });
    });

    $(this).highlighted(1); // highlight 1st td (default active, can change to any index.)

    $(".previous",this).on("click",function(e){
        var target  = $(this).parents("table");
        var active  = parseInt($("tr:eq(1)",target).find("td.highlighted").index());
        var ind_first_visible   = parseInt($("tr:eq(1)",target).find("td:not(:eq(0)):visible:first").index());
        var ind_last_visible    = parseInt($("tr:eq(1)",target).find("td:not(:eq(0)):visible:last").index());

        if(active>1){ // Prevent previous action after reached 1st event

            if(active == ind_last_visible && active !== range){
                $(target).show_td(ind_first_visible-1);
                $(target).hide_td(ind_first_visible+range-1);
            }

            $(target).highlighted(active-1);    
            $("tr",target).not("tr:eq(0)").find("td:eq("+active+")").removeClass("highlighted");

        }

        e.preventDefault();
    });

    $(".next",this).on("click",function(e){
        var target  = $(this).parents("table");
        var active  = $("tr:eq(1)",target).find("td.highlighted").index();
        var ind_last_visible    = $("tr:eq(1)",target).find("td:not(:eq(0)):visible:last").index();

        if(active < $("tr:eq(1)",target).find("td").length-1){ // Prevent next action after reached last event

            if(active == ind_last_visible){
                $(target).show_td(ind_last_visible+1);
                $(target).hide_td(ind_last_visible-range+1);
            }

            $(target).highlighted(active+1);
            $("tr",target).not("tr:eq(0)").find("td:eq("+active+")").removeClass("highlighted");

        }

        e.preventDefault();
    });

};

$.fn.highlighted = function(x){
    /*
        x = index of td to be highlighted
        funtion to hightlight the active `td` 
        change its title event name
    */

    var top_title   = $("tr:eq(0) td:eq(1)",this);
    var e_title     = $("tr:eq(1) td:eq("+x+")",this).data("e1")+"<br>"+$("tr:eq(1) td:eq("+x+")",this).data("e2");

    $(".event",top_title).html(e_title); // Change events name

    $("tr",this)
    .not("tr:eq(0)") // Ignore 1st row because this row is for event
    .find("td:eq("+x+")")
    .addClass("highlighted"); // Add class to next active `td`
};

$.fn.show_td = function(x){ // Funtion to show the `td` 
    // x = index of td to be show
    $("tr",this).not("tr:eq(0)").find("td:eq("+x+")").show();
};

$.fn.hide_td = function(x){ // Funtion to hide the `td` 
    // x = index of td to be hide
    $("tr",this).not("tr:eq(0)").find("td:eq("+x+")").hide();
};

$(".tbl-1").c_tbl(); // Example for the 1st table with different colspan value 
```

JSFiddle 示例：[https ://jsfiddle.net/synz/182xtgoL/](https://jsfiddle.net/synz/182xtgoL/)

我在那个 JSFiddle 示例中使用了 2 个表。展示不同之处以及如何使用它。`

# mysql - mysql查询以匹配名称但避免uid不起作用

> ID：12307907
> 
> 赞同：0
> 
> 时间：2012-09-06T20:29:35.197
> 
> 标签：mysql

您好，我正在尝试将组名与特定名称的 uid 匹配

```
 group_name  sort    date    uid
    friends       0     2011    gname
    family        1     2011    gname1
    following     4     2011    gname2
    acqaintances  3     2011    gname3 
```

我希望无论用户输入什么来创建一个新组，它都不能是默认组。其余组可以与它们具有 unqiue uid 相同，我将这些 uid gname,gname1,gname2,game3 用于全部。有什么帮助吗？我尝试了一个不起作用的查询，因为它显示了结果，即使用户输入了这四个组之外的任何内容

这里是

> 从 group_name="example" 和 uid='gname' 或 uid='gname1' 或 uid='gname2' 或 uid='gname3' 的组中选择 group_name

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T20:31:58.580

您需要括号来确保和/或条件得到正确分组：

```
select group_name from groups where group_name="example" and
  (uid='gname' or uid='gname1' or uid='gname2' or uid='gname3') 
```

在您的原始查询中，`and`绑定比 更紧密`or`，因此您最终有效地执行了以下操作：

```
select group_name from groups where (group_name="example" and uid='gname')
  or uid='gname1' or uid='gname2' or uid='gname3' 
```

# c# - 为什么 C# 中的某些方法返回窄数据类型，而更广泛的数据类型更有意义？

> ID：12307910
> 
> 赞同：4
> 
> 时间：2012-09-06T20:29:46.590
> 
> 标签：c#

我认为自己是一名优秀的中级 .Net 开发人员，在过去 3 年多的时间里，我对 C# 中的所有概念和术语都有了不错的理解。但是，我有一个问题，如果它看起来像一个愚蠢而愚蠢的问题，我深表歉意。我想知道的是为什么框架类库中的某些方法在更广泛的数据类型更有意义时返回窄数据类型，我们必须稍后将其转换为我们感兴趣的数据类型。我想给出以下两个例子来支持我的问题：

1.  `Label Label1 = (Label)Grid.FindControl("Label1");`
    在这个例子中，为什么 FindControl 返回一个 Control 类型的实例，我们必须将它转换为 Label 类型。它可能返回了一个 Label 类型的实例，因为我们传递了一个在方法参数的标记中声明的有效 ID。

2.  `protected override object SaveViewState()`
    在此示例中，返回 on 对象，我们必须将其强制转换为字符串类型。

如果我的问题令人困惑，我再次抱歉。我只想知道为什么这些场景在返回窄类型时会返回更宽的类型，并且它可以避免我们额外的转换为我们想要的类型的步骤。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-06T20:35:03.050

这是因为当您设计一个*框架*时，您需要尽可能在*一般*级别上进行操作，或者如果您愿意，可以在*抽象级别上进行操作。*返回最*可能的*基类，在这种情况下，它创建了一个几乎可以支持任何东西的抽象。想象：

```
Label     label1 = (Label)Grid.FindControl("Label1"); 
TextBox   textBox1 = (TextBox)Grid.FindControl("TextBox1"); 
Calendar  calendar1= (Grid)Grid.FindControl("Calendar1"); 
```

只有**一种**方法*可以*从`Grid`. *调用者*知道它到底是什么，所以转换为已知类型。

如果我像一个框架设计师一样，想为 , , 制作特殊的方法`Label`，`TextBox`我`Calendar`需要为每种类型添加一个方法。*我想你会同意，从框架设计者*的角度来看，这简直是不可想象的。从应该为其他开发人员设计通用基础架构的开发人员的角度来看。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-06T20:40:26.483

首先，您有点转过身来，因为“更宽”通常用于派生较少的类型。例如`Control`比 更广泛，`Label`因为该定义涵盖了从 派生的所有内容`Control`，其中包括`Label`以及其他事物。

至于实际问题。有时人们可以争论例如一个方法的利弊，该方法返回的实际上是`List<T>`返回它的`List<T>`or`IList<T>`或`ICollection<T>`or `IEnumerable<T>`。我们可以将一些好的原则应用于该决定，但是在尽可能广泛地保持有用和尽可能地缩小范围仍然有优势。

但这并不适用于此。除非将其定义为仅返回标签，否则无法`Control.FindControl()`返回。`Label`这不是它的用途，它是用于返回任何类型的控件，因此结果可能很容易成为中继器或网格。

您自己说`SaveViewState`，“转换为可能是字符串类型。” 答案就在那个“也许”中。当然它*可能*是一个字符串，但它*可能*是一个`object[]`或一个`List<string>`或一个`Dictionary<string, string>`。

如果是你写的程序员`SaveViewState`，你会如何定义它？您必须涵盖所有这些可能性以及更多，因此您必须将其定义为返回`object`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-06T20:36:26.443

在标记文件中定义这一事实`ID`并不意味着在编译时该类型是已知的，更糟糕​​的是，根本没有办法验证这一点，因为标记文件不是编译过程的一部分。

单独使用标识符也不太可能做这样的事情`string`，因为 C# 中的返回类型不支持协变（你不能有一个调用的方法`FindControl`同时返回`Label`和`Control`）。

您可以从中获得的最接近的东西是让 IDE 生成一个扩展方法`FindLabel1`，然后为您进行强制转换，但这就像您的代码一样只是一个 hack，它不能保证任何事情。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-09-06T20:37:07.687

> `Label Label1 = (Label)Grid.FindControl("Label1");`
> 
> 在这个例子中，为什么 FindControl 返回一个 Control 类型的实例，我们必须将它转换为 Label 类型。

你错了。方法*返回类型*是`Control`，但返回的*实例类型*是`Label`（否则您将无法向上转换它）。

> 它可能返回了一个 Label 类型的实例，因为我们传递了一个在方法参数的标记中声明的有效 ID。

可以而且确实可以。但是您在这里真正要问的是“为什么我需要向上转型”。因为方法返回类型被声明为`Control`，*那*是因为在编译时，当变量类型被解析时，根本无法知道你的控件类型。

# excel - 使用 ADO.NET 修改 excel 文件时处理并发问题的最佳方法是什么？

> ID：12307913
> 
> 赞同：0
> 
> 时间：2012-09-06T20:30:02.143
> 
> 标签：excel, concurrency, ado.net

我知道不应将 Excel 文件视为数据库，但假设您不得不使用 ADO.NET 将数据添加到任何用户可以随时修改的 excel 文件中，那么处理并发问题的最佳方法是什么？

更具体地说，如何在 ADO.NET 尝试更新文件之前锁定 excel 文件，而不会阻止 ADO.NET 进行更新？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T20:58:16.693

将您的锁放在一个完全独立的文件上，该文件是为此目的而创建的。这是一个丑陋的解决方案，但必须使用 ADO.NET 修改 Excel 文件。

# python - PIL - 在 .png 周围添加透明度

> ID：12307914
> 
> 赞同：-1
> 
> 时间：2012-09-06T20:30:04.963
> 
> 标签：python, python-imaging-library

我有几个 586 x 428 的 .png。我需要将它们转换为 512 x 512 的 .png。我想这样做而不拉伸图像。所以基本上，我想将宽度缩小到 512，然后在原始图像上方和下方的高度添加等量的透明度。

因此，最终产品将是一个 512 x 512 的 .png，顶部和底部的透明度为 69 像素，图像的“彩色”部分为 512 x 374。

我正在尝试使用 Python Imaging Library 来做到这一点。我对此很陌生，所以如果有人可以帮助我，那将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T01:33:55.833

```
from PIL import Image

def adjust(image):
    image = image.convert('RGBA')
    width, height = image.size
    new_width = 512
    new_height = new_width * height // width
    image = image.resize((new_width, new_height), resample=Image.ANTIALIAS)
    new_image = Image.new('RGBA', (512, 512), (0, 0, 0, 0))
    upper = (512 - image.size[1]) // 2
    new_image.paste(image, (0, upper))
    return new_image 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-06T23:38:51.620

好的，距离您发布问题已经两个小时了。由于您尚未发布代码并且没有人发布答案，因此以下内容可以帮助您入门：

1.  加载源图像
2.  [将源图像大小调整](https://stackoverflow.com/questions/273946/how-do-i-resize-an-image-using-pil-and-maintain-its-aspect-ratio)为 512x534
3.  制作尺寸为 512x512 的新图像
4.  将调整大小的像素复制到新图像中的矩形中，其角为`(0, 69, 512, 441)`
5.  [使以下两个矩形透明](https://stackoverflow.com/questions/4379978/python-pil-how-to-make-area-transparent-in-png) `(0,0,512,69)`并`(0,441,512,512)`

希望能帮助您入门

# c++ - 未处理的异常错误

> ID：12307918
> 
> 赞同：0
> 
> 时间：2012-09-06T20:30:17.513
> 
> 标签：c++, visual-studio-2008, memory-management, out-of-memory, cplex

我调用 cplex 来解决 Visual Studio 中的优化问题。我的问题很简单：

```
IloNumVarArray a(env,N,0,IloInfinity);
IloNumVarArray d(env,N,0,IloInfinity);

IloModel Model(env);    
//objective function
IloExpr obj(env);
for(IloInt n=0; n<N;n++)
  obj+=a[n]*c1[n]-d[n]*c2[n];
Model.add(IloMinimize(env,obj));
obj.end();

for(IloInt n=0;n<N;n++){
    Model.add(a[n]==0);
    Model.add(d[n]==0);
}
IloCplex cplex_p(Model);
cplex_p.setParam(IloCplex::EpGap,0.0001);
cplex_p.solve(); 
cplex_p.end();
Model.end(); 
```

但每次它给我这个错误信息：

```
Unhandled exception at 0x74eeb9bc in For-Calling-Cplex.exe: Microsoft C++ exception: IloWrongUsage at memory location 0x0027fbe4.. 
```

我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T20:44:49.210

根据 C++ 规则，如果程序抛出未被捕获的异常，程序会立即终止（通过`std::terminate()`）。在这种情况下，我们可以看到运行时`IloWrongUsage`在终止时打印异常 ( ) 的名称。

为了获得有关问题原因的更多详细信息，您应该将代码包装在异常处理程序中并检查异常携带的信息。

例如：

```
int main(int, char*[])
{
    try
    {
        // your code goes here
    }
    catch ( IloException& e )
    {
        // based on the ILOG CPLEX 10.0 User’s Manual / Languages and APIs / Handling Errors
        std::cout << e << std::endl;
        e.end();
    }
    catch ( ... )
    {
        std::cout << "Unknown exception\n";
    }
} 
```

之后，您将（可能）看到异常的详细信息。谷歌搜索表明这`IloWrongUsage`意味着某些参数是错误的或类似的东西（我不知道 cplex 是什么）。

**UPD**我在网上找到了一个 CPLEX 手册，它似乎暗示`IloException`不继承`std::exception`（这不是一个好的做法，一般来说）。所以我根据手册编辑了我的例子。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T21:18:28.213

使用 end 函数为时尚早。

```
obj.end(); 
```

由于您将其作为目标函数添加到模型中。除非您正在迭代创建模型并且内存不足，否则您不应该真正调用 .end() 函数。

如果您使用的是 msvc，则应在调试模式下编译并[设置断点](https://stackoverflow.com/questions/4558436/break-on-exception-throw-setting-the-default)以使调试器在实际抛出异常时停止。接下来，您应该始终在较高级别捕获 IloException。在 try/catch 块中编写函数调用

```
try {
   buildModel():
} catch (const IloException& e)
{
   cerr << e;
   throw; // if you like
} 
```

# asp.net - GDI+ 中发生的“一般”错误正在杀死我

> ID：12307924
> 
> 赞同：0
> 
> 时间：2012-09-06T20:30:34.953
> 
> 标签：asp.net, vb.net, file-upload, iis-7

我正在尝试使用文件上传控件调整用户上传的图像的大小并将其保存在文件夹中。但是在 bmp.save(..) 上，我得到了这个异常。

**异常类型**：System.Runtime.InteropServices.ExternalException

**错误消息**：GDI+ 中出现一般错误。

**堆栈跟踪**：在 System.Drawing.Image.Save(String filename, ImageCodecInfo encoder, EncoderParameters encoderParams) at btnUpload_Click(Object sender, EventArgs e)

**这是我的代码**

```
 If fileUpload1.HasFile Then
        Dim flStream = fileUpload1.FileContent
        Dim imgMemStream = New MemoryStream

        imgMemStream.SetLength(flStream.Length)
        flStream.Read(imgMemStream.GetBuffer, 0, flStream.Length)

        imgMemStream.Flush()
        flStream.Close()

        Dim imgStream = System.Drawing.Image.FromStream(imgMemStream)
        Dim bmp = New Bitmap(200, 200)
        Dim gr = Graphics.FromImage(bmp)
        gr.DrawImage(imgStream, 0, 0, 200, 200)

        If System.IO.Directory.Exists(Server.MapPath("ProfilePics\")) Then
            bmp.Save(Server.MapPath("ProfilePics\" & employeeId & ".jpg"), Drawing.Imaging.ImageFormat.Jpeg)
        Else
            Throw New Exception("Path not found")
        End If

        imgStream.Dispose()
        bmp.Dispose()
        gr.Dispose()

        Response.Redirect(Me.Request.Url.AbsolutePath) 
End If 
```

我还尝试让 iis_wpg 完全控制该文件夹。

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T20:49:22.653

对我来说这听起来像是一个权限问题（你已经开始调查它听起来像）。您是否尝试过授予 NETWORK SERVICE 写入该文件夹的权限？

如果这不起作用，请尝试将文本文件写入该文件夹以确定它是否是权限，使用这些方法应该会得到更好的错误。我似乎记得在 IIS 中，有时您还需要在文件系统和通过 IIS 中启用写权限，但这可能是过时的信息。

# xslt - Saxon 在 XSLT 期间是否在属性中使用空格？

> ID：12307928
> 
> 赞同：0
> 
> 时间：2012-09-06T20:30:48.340
> 
> 标签：xslt, saxon

我想知道 Saxon 在 XSLT 期间如何以及为什么在 XSL 元素之间使用空格。这是一个可能受上述行为影响的示例：

**在 XSLT 期间，Saxon 如何以及为什么在 XSL 元素之间使用空格？**

```
<div style="display:none;">
    <xsl:choose>
      <xsl:when test="true">
        <xsl:attribute name="id">
           <xsl:choose>
              <xsl:when>
               etc ec
              </xsl:when>
              <xsl:otherwise></xsl:otherwise>
            </xsl:choose>
          </xsl:attribute>
         </xsl:when>
         <xsl:otherwise></xsl:otherwise>

</div> 
```

为什么 the`<div`和 the之间的空格`<xsl:choose>`可能会导致以下错误：

```
XSLT attribute node (id) cannot be created after the children of the containing element 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T22:50:50.903

仅包含空格的文本节点（如您的示例中的那个）没有效果（它们在解析的早期阶段被删除）除非您碰巧在样式表中的某些父元素上具有属性 xml:space="preserve" . （由于这样的原因，将 xml:space="preserve" 放在样式表中几乎总是坏消息，但人们不时这样做，这可能会导致这里的问题。）

另一种可能性（我在 12 年内只见过一次......）是看起来像空格的东西不是。例如，它可能包含一个不间断空格或零宽度空格，它们看起来是白色的，但不是正式的空格。

# c# - 使用 TFS API 和 SSRS 以编程方式生成报告

> ID：12307931
> 
> 赞同：6
> 
> 时间：2012-09-06T20:31:04.937
> 
> 标签：c#, reporting-services, tfs, tfs-sdk

是否有使用 TFS API 和 SSRS 生成 PDF、Excel、Word 或 TIFF 格式的简单方法？我可以通过使用 TFS 的 SSRS 仪表板从组合框中选择参数来手动生成报告，但我想在我的 Web 应用程序中包含一个导出按钮，以便我可以轻松绕过 Team Web Access 来生成报告。有任何想法吗？

我在[这篇文章](https://stackoverflow.com/questions/4381314/programmatically-exporting-reports-via-ssrs-api)中读到我可以使用`ReportExecutionService`SSRS 中的类，所以我想知道这是否可以从 TFS 服务器中使用。

我已使用此 Web 服务参考导入了命名空间： `http://<TFS server>/reportserver/ReportExecution2005.asmx`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T15:27:51.903

我找到了一种使用`ReportExecutionService`Web 服务生成报告的方法。如果已将 Web 服务引用添加到项目中，这将生成具有给定参数的文件。此处开始和结束日期作为参数提供，并且使用[Render() 方法](http://msdn.microsoft.com/en-US/library/microsoft.wssux.reportingserviceswebservice.rsexecutionservice2005.reportexecutionservice.render%28v=SQL.90%29.aspx)生成报告。

```
private void GenerateReport()
{
    ReportExecutionService rs = new ReportExecutionService();
    rs.Credentials = System.Net.CredentialCache.DefaultCredentials;
    rs.Url = "http://<TFS server name>/reportserver/ReportExecution2005.asmx";

    // Render arguments
    byte[] result = null;
    string reportPath = @"<SSRS report path>";
    string format = "PDF";
    string historyID = null;
    string devInfo = @"<DeviceInfo><Toolbar>False</Toolbar></DeviceInfo>";

    // Prepare report parameter.
    ParameterValue[] parameters = new ParameterValue[2];
    parameters[0] = new ParameterValue();
    parameters[0].Name = "StartDateParam";
    parameters[0].Value = "2012-06-01 00:00:00";
    parameters[1] = new ParameterValue();
    parameters[1].Name = "EndDateParam";
    parameters[1].Value = "2012-09-01 00:00:00";
    parameters[2] = new ParameterValue();
    parameters[2].Name = "AreaParam";
    parameters[2].Value = "[Work Item].[Area Hierarchy].[All]";
    parameters[3] = new ParameterValue();
    parameters[3].Name = "WorkItemTypeParam";
    parameters[3].Value = "[Work Item].[System_WorkItemType].&[Task]";
    parameters[4] = new ParameterValue();
    parameters[4].Name = "StateParam";
    parameters[4].Value = "[Work Item].[System_State].&[Active]";
    parameters[5] = new ParameterValue();
    parameters[5].Name = "TrendLineParam";
    parameters[5].Value = "both";

    DataSourceCredentials[] credentials = null;
    string showHideToggle = null;
    string encoding;
    string mimeType;
    string extension;
    Warning[] warnings = null;
    ParameterValue[] reportHistoryParameters = null;
    string[] streamIDs = null;

    ExecutionInfo execInfo = new ExecutionInfo();
    ExecutionHeader execHeader = new ExecutionHeader();

    rs.ExecutionHeaderValue = execHeader;

    execInfo = rs.LoadReport(reportPath, historyID);

    var parameters_ = rs.GetExecutionInfo().Parameters;

    rs.SetExecutionParameters(parameters, "en-us"); 
    String SessionId = rs.ExecutionHeaderValue.ExecutionID;

    Console.WriteLine("SessionID: {0}", rs.ExecutionHeaderValue.ExecutionID);

    try
    {
        result = rs.Render(format, devInfo, out extension, out encoding, out mimeType, out warnings, out streamIDs);

        execInfo = rs.GetExecutionInfo();

        Console.WriteLine("Execution date and time: {0}", execInfo.ExecutionDateTime);

    }
    catch (SoapException e)
    {
        Console.WriteLine(e.Detail.OuterXml);
    }
    // Write the contents of the report to an MHTML file.
    try
    {
        FileStream stream = File.Create("report.pdf", result.Length);
        Console.WriteLine("File created.");
        stream.Write(result, 0, result.Length);
        Console.WriteLine("Result written to the file.");
        stream.Close();
    }
    catch (Exception e)
    {
        Console.WriteLine(e.Message);
    }

} 
```

顺便说一句，为参数设置的值是 MDX 查询，我还没有找到如何设置特定的 AreaPath，所以现在我只能列出“全部”。

# android - 活跃安装量还是总安装量？

> ID：12307933
> 
> 赞同：3
> 
> 时间：2012-09-06T20:31:08.820
> 
> 标签：android, google-play

我对 Google Play 的安装数感到困惑。我的应用程序的总安装量超过 5000，但活动安装量约为 2600。当我查看应用程序的 Google Play 页面时，它显示 1000-5000 次安装。这部分考虑的是哪一个？活动安装或总安装量？或者这些天 Google Play 上是否存在更新问题？

编辑：问题已解决。这里是：http://support.google.com/googleplay/android-developer/bin/static.py?hl=en&page=known_issues.cs

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-06T20:42:39.447

Play 商店显示下载总量。您的控制台还会显示仍有多少人处于活动状态（已取消安装该应用程序）

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-06T20:41:16.453

总安装量是下载您的应用程序的总人数。Active installs 是仍然安装了您的应用的总人数。

# javascript - Javascript 时区偏移不反映本地机器的时区

> ID：12307934
> 
> 赞同：2
> 
> 时间：2012-09-06T20:31:14.310
> 
> 标签：javascript, windows, internet-explorer, web

面对一个独特的问题，其中一台用户机器不反映本地时区。

用户机器的时区是 GMT（伦敦），对于当前日期（2012 年 9 月 6 日），偏移量应该是 -60（BST），即 GMT+1。但它返回 0 UTC 偏移量，并且日期也反映在 UTC 中，这有点奇怪。

```
window.alert("Current Local Desktop Date \"" + new Date() + "\" whose offset difference is " + new Date().getTimezoneOffset() + " mins from UTC"); 
```

windows有什么需要更新的吗？？

排除可能性：

1.  Date&Time 服务中的夏令时设置。因为如果未选中此设置，则任务栏时间应该不同。但任务栏时间反映在 BST 中。
2.  浏览器问题 --> 在 IE 和 Chrome 中都试过了。两者返回相同。

# c++ - 在 C++ 中迭代对象名称

> ID：12307935
> 
> 赞同：0
> 
> 时间：2012-09-06T20:31:19.507
> 
> 标签：c++, arrays, object, iteration, objectname

如何遍历数组来操作或访问不同的对象及其成员函数？我有 10 个对象。现在我有相同的代码访问每个对象成员函数并操作基本上为每个对象复制和粘贴的对象数据。我只是想知道是否有一种方法可以使用循环一次编写该代码并让它遍历所有 10 个对象。

而不是像下面这样手动执行此操作：

```
Color red.set();
Color green.set();
Color blue.set();
Color yellow.set();
Color purple.set();
      ... 
```

有没有办法通过循环来做到这一点，例如：

```
colors[5] = {"red", "green", "blue", "yellow", "purple", ...};

for(int i = 0; i < 10; i++){
    Color colors[i].set();
} 
```

我知道 PHP 做类似的事情是这样的：

```
$colors = array("red", "green", "blue", "yellow", "purple" ...);

for($i = 0; $i < 10; $i++){
    ${$colors[$i]} = $colors[$i];
    // $red = "red";
} 
```

是否可以为 C++ 做到这一点？

下面是另一个例子，说明我为什么要问这个问题以及我在做什么：而不是：

```
if(grid[row][col].ship == "red")
{
    red.setShipDamage();

    if(red.getShipSunk() == true)
        red.destroy();
}
else if(grid[row][col].ship == "green")
{
    green.setShipDamage();

    if(green.getShipSunk() == true)
        green.destroy();
}
else if( ... ) 
```

要在循环中执行所有这些操作：

```
for(int i = 0; i < 10; i++)
{
    if(grid[row][col].ship == colors[i])
    {
        **colors[i]**.setShipDamage();

        if(**colors[i]**.getShipSunk() == true)
            **colors[i]**.destroy();
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T20:38:50.947

你的问题有点令人困惑。您需要提供 Color 类的功能。这是你想要的吗？

```
Color colors[5];
char *color_txt[5] = {"red", "green", "blue", "yellow", "purple"};

for (int i = 0; i < 5; i++){
    colors[i].set(color_txt[i]);
} 
```

* * *

根据您编辑的问题，您可以按照我的描述创建一个对象数组：

```
Color colors[10]; 
```

假设每个对象都有一个默认构造函数。然后您可以通过数组中的索引访问每个对象。因此，您的示例按预期工作：

```
for(int i = 0; i < 10; i++)
{
    if(grid[row][col].ship == colors[i])
    {
        colors[i].setShipDamage();

        if(colors[i].getShipSunk() == true)
            colors[i].destroy();
    }
} 
```

此外，您的 Color 类应该具有覆盖的相等运算符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-06T21:07:51.313

你需要做这样的事情：

```
std::map<std::string, Color*> colors;
colors["red"] = &red;
colors["green"] = &green;
colors["blue"] = &blue;
colors["purple"] = &purple;

///....
Color *color = colors[grid[row][col].ship];
color->setShipDamage();
if(color->getShipSunk() == true)
    color->destroy(); 
```

我希望它有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-06T20:36:31.183

目前还不完全清楚你想要做什么，但这里有一个尝试：

```
Color red, green, blue, yellow, purple;
Color *colors[5] = {&red, &green, &blue, &yellow, &purple};
for (int i = 0; i < 5; i++) {
   colors[i]->set();
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-06T21:00:46.980

您的示例一开始就令人费解且设计不佳。如果网格只是存储对飞船的引用（实际上是指针），那么您就不需要循环开始了！考虑：

```
if (Ship* ship = grid[y][x].ship()) {// ship() returns nullptr if there's no ship
    ship->setDamage();
    if (ship->sunk())
        // ...
} 
```

* * *

另一方面，如果您*想将*字符串与船舶相关联，则需要一个关联容器，例如`unordered_map`标准库中的：

```
Ship red, green, blue, white;
std::unordered_map<std::string, Ship*> = { { "red", &red },
                                           { "green", &green },
                                           /* ... */ }; 
```

# sql-server - 如何计算一个月内某事发生的次数

> ID：12307942
> 
> 赞同：0
> 
> 时间：2012-09-06T20:32:04.150
> 
> 标签：sql-server

我想统计当月投票的人数

我的桌子看起来像：

```
Table_votes
    ID
    Person_ID
    voteitem_ID
    vote
    Date 
```

表中的数据如下所示：

```
1  1  1  2/2/2012
2  1  2  2/2/2012
3  2  1  3/3/2012
4  2  2  3/3/2012
5  3  1  2/12/2012
6  3  2  2/12/2012 
```

我希望查询输出的是第 2 个月有 2 人投票，第 3 个月有 1 人投票

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T20:35:15.027

```
select count(person_id) as person_count
       month(Date) as Month
from table_votes
group by month(Date) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T20:53:03.133

如果您的数据超过一年，则需要考虑到这一点。

尝试

```
select 
 count(distinct person_id) as count_personID,
 year(date) as yr,
 month(date) as mo
from
 table_votes
group by
 year(date),
 month(date) 
```

# web-services - Delphi 将 TXMLData 包装在 SOAP 请求中 标签

> ID：12307943
> 
> 赞同：2
> 
> 时间：2012-09-06T20:32:10.753
> 
> 标签：web-services, delphi, soap, schema, delphi-xe2

我正在使用 TXMLData 发送 XML，而 Delphi 在请求中添加了一个标签，我的代码是这样的：

```
RequestData := TXMLData.Create;
RequestData.LoadFromXML('<MyXML>[contents here]</MyXML>');

MyService.ExecuteRequest(RequestData); 
```

我使用了 THTTPRIO 的 OnBeforeExecute 来获取请求的内容，并且内容被包装在一个标签中，如下所示：

```
<SOAP-ENV:Body>
    <schema xmlns="http://www.w3.org/2001/XMLSchema">
              <MyXML>
    </schema>
</SOAP-ENV:Body> 
```

我不知道为什么要添加这个标签。我怎样才能防止它被添加？

此外，我不喜欢在 OnBeforeExecute 事件中编辑 SOAPRequest 以在不知道它是否存在的情况下将其删除的想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T16:19:42.130

解决了。

Delphi 将网络服务映射为：

```
RequestData = TXMLData;

MyService = interface(IInvokable)
  ['{5D2D1DD8-AE56-AD82-FC59-8669C576E1AF}']
  function ExecuteRequest(const RequestData: RequestData): RequestResult; stdcall;
end; 
```

改变：

```
RequestData = TXMLData; 
```

至

```
RequestData = class(TXMLData); 
```

解决了这个问题。

现在 delphi 使用“RequestData”作为请求正文中 XML 的顶部节点，而不是添加模式标记。

现在调用正在生成如下内容：

```
<RequestData>[MyXML]</RequestData> 
```

这是我需要发送的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T12:44:39.607

看起来德尔福看着`<MyXML>`并认为

> “这段 XML 没有关联的命名空间，所以我只是把它扔到`XMLSchema`命名空间中 - 嘿！这个命名空间还没有在 SOAP 消息的命名空间中，所以我将添加它以使 SOAP 服务器满意！ "

*   请注意，在您的示例`<MyXML>`中不是格式良好的 XML 文档。它只是开始的“标签”。

* * *

我不知道 TXMLData 详细信息，但它可能支持命名空间。也许您可以在 XML 文档中添加名称空间声明，然后 SOAP 请求会看起来更好。

* * *

SOAP 请求正文示例（来自[Wikipedia](http://de.wikipedia.org/wiki/SOAP#Arbeiten_mit_SOAP)）：

```
<s:Body>
    <m:TitleInDatabase xmlns:m="http://www.lecture-db.de/soap">
        DOM, SAX and SOAP
    </m:TitleInDatabase>
</s:Body> 
```

这表明 SOAP 主体可以是在根元素中具有命名空间声明的“独立”XML 文档（而不是在您的情况下是单独的外部元素）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T12:28:34.223

听起来您必须使用不兼容的 Web 服务，但是 SOAP 库阻碍了您。因此，您可能需要诉诸“蛮力”方法来替换 OnBeforeExecute 处理程序中的请求。不过，在此之前，我会尝试使用 SoapUI 使用服务 WSDL。查看服务是否接受了 SoapUI 请求。如果不对请求进行严格的编辑就无法做到这一点，那么上述方法是合理的。

# asp.net - 动态加载的模式，可以提交到与主页不同的 url

> ID：12307944
> 
> 赞同：1
> 
> 时间：2012-09-06T20:32:11.690
> 
> 标签：asp.net, webforms, updatepanel, modal-dialog, jquery-ui-dialog

我有一个显示可编辑列表视图的“testMain.aspx”页面。此外，它还包含一个触发 jquery UI 模式对话框的按钮，该对话框动态加载“testModal.aspx”。此模式包含一个下拉列表，用户选择并单击一个按钮以提交回服务器。我希望模态提交（到 testModal.aspx）然后关闭，所以我正在查看 testMain.aspx。

我遇到的问题是在提交和关闭模式之后，任何点击（即编辑列表视图的链接按钮）现在提交到 modal.aspx 而不是 main.aspx。

**注意：**

*   testMain.aspx 使用母版页（其中包含一个表单元素）
*   列表视图包含在 asp:updatepanel 中
*   在我加载（.load（））模式之前，问题不会发生，在这样做之前，我的点击回发到 testMain.aspx（如预期的那样）

**母版页.master**

```
<%@ Master Language="VB" CodeFile="MasterPage.master.vb" Inherits="MasterPage" %>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head id="Head1" runat="server">
    <asp:ContentPlaceHolder ID="head" runat="server">
    </asp:ContentPlaceHolder>
</head>
<body>
    <div id="page">
        <form id="form1" runat="server">
        <table summary="" class="pageTable">
            <tr>
                <td class="contentArea">
                    <asp:ContentPlaceHolder ID="ContentPage" runat="server">
                    </asp:ContentPlaceHolder>
                </td>
            </tr>
        </table>
        </form>
    </div>
</body>
</html> 
```

**测试主程序.aspx**

```
<script type="text/javascript">
    $(document).ready(function () {
        var $dialog = $('#foo').dialog({
            autoOpen: false,
            modal: true
        });

        $("#foo").parent().appendTo($("form:first"));

        $('#fooBtn').click(function () {
            $dialog.load('testModal.aspx');
            $dialog.dialog('open');
            return false;
        });
    });
</script>

<ajax:UpdatePanel runat="server" ID="updPanelGrid" UpdateMode="Conditional" RenderMode="Inline"
    ChildrenAsTriggers="false">
    <ContentTemplate>
        <asp:ListView ID="ListView1" runat="server" EnableModelValidation="True"
         ...
        </asp:ListView>
    </ContentTemplate>
    <Triggers>
        <ajax:AsyncPostBackTrigger ControlID="listview1" EventName="ItemEditing" />
        <ajax:AsyncPostBackTrigger ControlID="listview1" EventName="ItemDeleting" />
        <ajax:AsyncPostBackTrigger ControlID="listview1" EventName="ItemCanceling" />
        <ajax:AsyncPostBackTrigger ControlID="listview1" EventName="ItemUpdating" />
        <ajax:AsyncPostBackTrigger ControlID="listview1" EventName="ItemInserting" />
    </Triggers>
</ajax:UpdatePanel> 
```

**测试模式.aspx**

```
<form id="form1" runat="server">
<asp:ToolkitScriptManager ID="ToolkitScriptManager2" runat="server">
</asp:ToolkitScriptManager>
<div>
    <ajax:UpdatePanel ID="updPnl" runat="server">
        <ContentTemplate>
            <asp:LinkButton ID="btnModalSubmit" runat="server" Text="Modal Server Submit" />
            <div>
                The current time is:
                <%= Now.ToString%></div>
        </ContentTemplate>

    </ajax:UpdatePanel>
</div>
</form> 
```

在我看来，通过在 jquery 对话框上调用 .load() ，它会对更新面板（即回发路径）造成严重破坏。如何在模态中加载整个 .net 页面，单击所述模态中的按钮，将其回传到服务器（异步），并允许我在模态关闭后继续在主页中工作？

这甚至可能吗？有没有更好的办法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T20:32:35.103

You can have only one Form runat=server in a aspx file. Make you modal to load in an iframe and this should solve a problem. (Assuming it already does not load it like that)

# qmake - 对多个文件运行一次 QMAKE_EXTRA_COMPILERS

> ID：12307949
> 
> 赞同：1
> 
> 时间：2012-09-06T20:32:45.830
> 
> 标签：qmake

是否可以有一个 QMAKE_EXTRA_COMPILERS 目标只为多个输入运行一次？我有一些遗留脚本可以一次生成所有文件。

说这样的话：

```
FILE_LIST = __Test1.cpp __Test2.cpp __Test.h

Extra.name = Extra Compilers Tests
Extra.input = FILE_LIST
Extra.output = ${QMAKE_FILE_IN}
Extra.commands += <generate what is in FILE_LIST with a single command>
Extra.CONFIG   += no_link target_predeps ordered
Extra.variable_out = GENERATED_SOURCES

QMAKE_EXTRA_COMPILERS += Extra 
```

我可能会重写脚本，但如果我能让 QMAKE_EXTRA_COMPILERS 为我完成这项工作，那就太好了。

奥西

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T19:56:02.457

我已经找到了我正在寻找的“组合”选项。

所以说我们有这样的东西。

```
ExtraGen.name =  Id Generator
ExtraGen.input = GENINPUT
ExtraGen.output = $$GENOUTPUT
ExtraGen.clean_command = $$ExtraGen.output
ExtraGen.commands = <Process> ${QMAKE_FILE_IN}
ExtraGen.CONFIG = combine
ExtraGen.variable_out = HEADERS
#silent:ExtraGen.commands = @echo Processing ${QMAKE_FILE_IN} && $$ExtraGen.commands
QMAKE_EXTRA_COMPILERS += ExtraGen 
```

因此，只要在 ExtraGen 之前定义了 GENOUTPUT，它就可以很好地工作。这有点痛苦，因为我想在包含的 pri 文件中定义 ExtraGen。

有什么办法可以解决这个问题，还是我让自己陷入困境？

奥西

# java - JVM 何时在堆栈跟踪中省略行信息，我该如何防止它？

> ID：12307951
> 
> 赞同：4
> 
> 时间：2012-09-06T20:32:54.010
> 
> 标签：java, debugging, jvm, stack-trace

我有一个非常混乱的情况：

我有一个使用行信息编译的类（使用验证`javap -l`）。此类使用 ASM 加载和检测。我确认加载了正确的类（即不是来自其他地方的陈旧类文件）。而且我还确保`ClassReader.SKIP_DEBUG`没有设置 ASM 标志。现在，如果我打电话`Thread.currentThread().getStackTrace()`，我会收到`StackTraceElement`有关错过线路信息的此类的信息。在 Eclipse 中调试时，行信息显示在堆栈跟踪中。我还确保启动 JVM`-Xint`只是为了确保在 JIT 编译代码时不会将信息作为优化删除。

最令人困惑的是：尽管所有类的加载和检测都是相同的，但这仅适用于某些类，而不是所有类。这是主要原因，为什么我认为这与 JVM 有关。

所以我的问题是：JVM 是否在堆栈跟踪中省略了行信息，如果是，我何时以及如何防止这种情况发生？

**编辑：**为了清楚起见：这是我面前的源文件的类文件，而不是第 3 方库的类文件。正如上面应该清楚的那样，我努力确保信息在字节码中。

**编辑：**现在我什至找到了一个例子，其中一个`StackTraceElement`有行号信息而另一个没有，他们关心***的是同一类的***不同方法！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T20:37:24.393

这与类文件的编译方式有关。看看这里：

[http://docs.oracle.com/javase/1.5.0/docs/tooldocs/windows/javac.html](http://docs.oracle.com/javase/1.5.0/docs/tooldocs/windows/javac.html)

并在 -g 标志周围查找“调试信息”。如果您添加 -g，您的代码将包含行号（以及许多其他有用的信息）。

恐怕这不会将调试信息追溯添加到第 3 方库中。您必须了解获取源代码或从供应商处获取调试版本。我发现这通常是没有必要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T20:52:36.193

我想知道在 ASM 检测您的类时是否生成了堆栈跟踪中报告的行（或不是，因为它是）。由于它们是在编译后修改的，因此任何行号都不会出现在类文件中，因此它们对类加载器不可用（或由 javap 报告）。我在运行时代码生成方面没有太多经验，所以这只是一个猜测，但也许你可以考虑一下。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-06T20:36:07.253

并非所有行号都在 JVM 中可用。一些第三方库可能在没有行号的情况下编译，特别是非开源库，甚至一些 Java 类已经保护了正在执行加密或其他一些受保护逻辑的源代码。简而言之，并不是所有的东西都会有行号。

# scala - Scala中的方法参数验证，用于理解和单子

> ID：12307965
> 
> 赞同：35
> 
> 时间：2012-09-06T20:35:01.340
> 
> 标签：scala, monads, for-comprehension, either

我正在尝试验证无效方法的参数，但我没有找到解决方案......

有人可以告诉我该怎么做吗？

我正在尝试这样的事情：

```
 def buildNormalCategory(user: User, parent: Category, name: String, description: String): Either[Error,Category] = {
    val errors: Option[String] = for {
      _ <- Option(user).toRight("User is mandatory for a normal category").right
      _ <- Option(parent).toRight("Parent category is mandatory for a normal category").right
      _ <- Option(name).toRight("Name is mandatory for a normal category").right
      errors : Option[String] <- Option(description).toRight("Description is mandatory for a normal category").left.toOption
    } yield errors
    errors match {
      case Some(errorString) => Left( Error(Error.FORBIDDEN,errorString) )
      case None =>  Right( buildTrashCategory(user) )
    }
  } 
```

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2012-09-06T22:00:22.653

如果你愿意使用[Scalaz](https://github.com/scalaz/scalaz)，它有一些工具可以让这种任务更方便，包括一个新`Validation`类和一些用于普通 old 的有用的右偏类型类实例`scala.Either`。我将在这里举一个例子。

## 累积错误`Validation`

首先是我们的 Scalaz 导入（请注意，我们必须隐藏`scalaz.Category`以避免名称冲突）：

```
import scalaz.{ Category => _, _ }
import syntax.apply._, syntax.std.option._, syntax.validation._ 
```

我在这个例子中使用了 Scalaz 7。您需要进行一些小的更改才能使用 6。

我假设我们有这个简化的模型：

```
case class User(name: String)
case class Category(user: User, parent: Category, name: String, desc: String) 
```

接下来，我将定义以下验证方法，如果您转向不涉及检查空值的方法，您可以轻松地调整它：

```
def nonNull[A](a: A, msg: String): ValidationNel[String, A] =
   Option(a).toSuccess(msg).toValidationNel 
```

该`Nel`部分代表“非空列表”， a 与 a`ValidationNel[String, A]`基本相同`Either[List[String], A]`。

现在我们使用这个方法来检查我们的参数：

```
def buildCategory(user: User, parent: Category, name: String, desc: String) = (
  nonNull(user,   "User is mandatory for a normal category")            |@|
  nonNull(parent, "Parent category is mandatory for a normal category") |@|
  nonNull(name,   "Name is mandatory for a normal category")            |@|
  nonNull(desc,   "Description is mandatory for a normal category")
)(Category.apply) 
```

请注意，这`Validation[Whatever, _]`不是一个 monad（例如，出于[此处](https://stackoverflow.com/q/12211776/334519)讨论的原因），而是一个应用函子，当我们“提升”到它`ValidationNel[String, _]`时，我们在这里使用了这个事实。`Category.apply`有关应用函子的更多信息，请参阅下面的附录。

现在如果我们写这样的东西：

```
val result: ValidationNel[String, Category] = 
  buildCategory(User("mary"), null, null, "Some category.") 
```

我们会因为累积的错误而失败：

```
Failure(
 NonEmptyList(
   Parent category is mandatory for a normal category,
   Name is mandatory for a normal category
  )
) 
```

如果所有参数都已检出，我们将使用`Success`带有`Category`值的 a。

## 快速失败`Either`

使用应用函子进行验证的方便之处之一是您可以轻松地更换处理错误的方法。如果你想在第一次失败而不是累积它们，你基本上可以改变你的`nonNull`方法。

我们确实需要一组稍微不同的导入：

```
import scalaz.{ Category => _, _ }
import syntax.apply._, std.either._ 
```

但是没有必要改变上面的案例类。

这是我们的新验证方法：

```
def nonNull[A](a: A, msg: String): Either[String, A] = Option(a).toRight(msg) 
```

几乎与上面的相同，除了我们使用`Either`而不是`ValidationNEL`，Scalaz 提供的默认应用函子实例`Either`不会累积错误。

这就是我们需要做的所有事情来获得所需的快速失败行为——不需要对我们的`buildCategory`方法进行任何更改。现在如果我们这样写：

```
val result: Either[String, Category] =
  buildCategory(User("mary"), null, null, "Some category.") 
```

结果将仅包含第一个错误：

```
Left(Parent category is mandatory for a normal category) 
```

正是我们想要的。

## 附录：应用函子快速介绍

假设我们有一个带有单个参数的方法：

```
def incremented(i: Int): Int = i + 1 
```

并且还假设我们想将此方法应用于某些人`x: Option[Int]`并获得`Option[Int]`回报。这`Option`是一个函子并因此提供了一个`map`方法的事实使这很容易：

```
val xi = x map incremented 
```

我们已经“提升”`incremented`到`Option`函子中；也就是说，我们本质上已经将一个函数映射`Int`to更改`Int`为一个映射`Option[Int]`to `Option[Int]`（尽管语法有点混乱——“提升”隐喻在 Haskell 之类的语言中更清晰）。

现在假设我们想以类似的方式应用以下`add`方法。`x``y`

```
def add(i: Int, j: Int): Int = i + j

val x: Option[Int] = users.find(_.name == "John").map(_.age)
val y: Option[Int] = users.find(_.name == "Mary").map(_.age) // Or whatever. 
```

作为函子的事实`Option`是不够的。然而，它是一个 monad 的事实是，我们可以使用它`flatMap`来获得我们想要的：

```
val xy: Option[Int] = x.flatMap(xv => y.map(add(xv, _))) 
```

或者，等效地：

```
val xy: Option[Int] = for { xv <- x; yv <- y } yield add(xv, yv) 
```

但是，从某种意义上说，`Option`对于这个操作来说， monadness 是多余的。有一个更简单的抽象——称为*应用*函子——介于函子和单子之间，它提供了我们需要的所有机制。

请注意，它*在形式上介于两者之间*：每个 monad 都是应用函子，每个应用函子都是函子，但并非每个应用函子都是 monad，等等。

Scalaz 为我们提供了一个应用函子实例`Option`，因此我们可以编写以下代码：

```
import scalaz._, std.option._, syntax.apply._

val xy = (x |@| y)(add) 
```

语法有点奇怪，但概念并不比上面的仿函数或 monad 示例复杂——我们只是提升`add`到应用仿函数。如果我们有一个`f`带有三个参数的方法，我们可以编写以下代码：

```
val xyz = (x |@| y |@| z)(f) 
```

等等。

那么，当我们有 monad 时，为什么还要操心应用函子呢？首先，根本不可能为我们想要使用的一些抽象提供 monad 实例——<code>Validation 就是一个完美的例子。

其次（也是相关的），使用最*不*强大的抽象来完成工作只是一种可靠的开发实践。原则上，这可能会实现原本不可能的优化，但更重要的是，它使我们编写的代码更具可重用性。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-09-06T21:49:01.127

我完全支持 Ben James 的建议，即为产生空值的 api 做一个包装器。但是在编写该包装器时，您仍然会遇到同样的问题。所以这是我的建议。

为什么单子为什么要理解？一个过度复杂的国际海事组织。您可以这样做：

```
def buildNormalCategory
  ( user: User, parent: Category, name: String, description: String )
  : Either[ Error, Category ] 
  = Either.cond( 
      !Seq(user, parent, name, description).contains(null), 
      buildTrashCategory(user),
      Error(Error.FORBIDDEN, "null detected")
    ) 
```

或者，如果您坚持让错误消息存储参数的名称，您可以执行以下操作，这需要更多样板：

```
def buildNormalCategory
  ( user: User, parent: Category, name: String, description: String )
  : Either[ Error, Category ] 
  = {
    val nullParams
      = Seq("user" -> user, "parent" -> parent, 
            "name" -> name, "description" -> description)
          .collect{ case (n, null) => n }

    Either.cond( 
      nullParams.isEmpty, 
      buildTrashCategory(user),
      Error(
        Error.FORBIDDEN, 
        "Null provided for the following parameters: " + 
        nullParams.mkString(", ")
      )
    )
  } 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-02-27T23:47:24.443

如果您喜欢@Travis Brown 答案的应用函子方法，但您不喜欢 Scalaz 语法或者只是不想使用 Scalaz，那么这里有一个简单的库，它丰富了标准库 Either 类以充当应用程序函子验证：[https ://github.com/youdevise/eithervalidation](https://github.com/youdevise/eithervalidation)

例如：

```
import com.youdevise.eithervalidation.EitherValidation.Implicits._    

def buildNormalCategory(user: User, parent: Category, name: String, description: String): Either[List[Error], Category] = {     
  val validUser = Option(user).toRight(List("User is mandatory for a normal category"))
  val validParent = Option(parent).toRight(List("Parent category is mandatory for a normal category"))
  val validName = Option(name).toRight(List("Name is mandatory for a normal category"))
  Right(Category)(validUser, validParent, validName).
    left.map(_.map(errorString => Error(Error.FORBIDDEN, errorString)))
} 
```

换句话说，如果所有的 Either 都是 Right，则此函数将返回包含您的 Category 的 Right，或者如果一个或多个是 Left，它将返回包含所有 Errors 的 List 的 Left。

请注意可以说是更多的 Scala 风格和更少的 Haskell 风格的语法，以及更小的库；）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-11-12T15:37:29.750

让我们假设您已经使用以下快速而肮脏的东西完成了 Either：

```
object Validation {
  var errors = List[String]()  

  implicit class Either2[X] (x: Either[String,X]){

def fmap[Y](f: X => Y) = {
  errors = List[String]()  
  //println(s"errors are $errors")
  x match {
    case Left(s) => {errors = s :: errors ; Left(errors)}
    case Right(x) => Right(f(x))
  }
}    
def fapply[Y](f: Either[List[String],X=>Y]) = {
  x match { 
    case Left(s) => {errors = s :: errors ; Left(errors)}
    case Right(v) => {
      if (f.isLeft) Left(errors) else Right(f.right.get(v))
    }
  }
}
}} 
```

考虑一个返回 Either 的验证函数：

```
 def whenNone (value: Option[String],msg:String): Either[String,String] = 
      if (value isEmpty) Left(msg) else Right(value.get) 
```

一个返回元组的 curryfied 构造函数：

```
 val me = ((user:String,parent:String,name:String)=> (user,parent,name)) curried 
```

您可以使用以下方法对其进行验证：

```
 whenNone(None,"bad user") 
   .fapply(
   whenNone(Some("parent"), "bad parent") 
   .fapply(
   whenNone(None,"bad name") 
   .fmap(me )
   )) 
```

没有大碍。

# javascript - 移除 CKEditor 的图片插件中的 htmlPreview

> ID：12307967
> 
> 赞同：6
> 
> 时间：2012-09-06T20:35:06.470
> 
> 标签：javascript, ckeditor, wysiwyg

我在 CKEditor 的图像插件中隐藏预览元素时遇到问题。我需要一个非常简单的图像对话框，只有图像源的输入字段和带有图像上传按钮的表单。所以我使用这些自定义配置设置删除了不必要的元素：

```
CKEDITOR.on( 'dialogDefinition', function( ev )
{
    var dialogName = ev.data.name;
    var dialogDefinition = ev.data.definition;
    if ( dialogName == 'image' ){
        dialogDefinition.removeContents( 'advanced' );
        dialogDefinition.removeContents( 'Link' );
        var infoTab = dialogDefinition.getContents( 'info' );
        infoTab.remove( 'ratioLock' ); 
        infoTab.remove( 'txtHeight' );          
        infoTab.remove( 'txtWidth' );          
        infoTab.remove( 'txtBorder'); 
        infoTab.remove( 'txtHSpace'); 
        infoTab.remove( 'txtVSpace'); 
        infoTab.remove( 'cmbAlign' ); 
        infoTab.remove( 'txtAlt' ); 
    }
}); 
```

当我尝试隐藏 htmlPreview 元素时，问题就开始了。如果我只是简单地添加`infoTab.remove( 'htmlPreview ' );`，就会发生错误：`Uncaught TypeError: Cannot call method 'setStyle' of null`因为已删除元素的代码依赖关系。我用谷歌搜索了很多，似乎有两种方法可以解决这个问题 - 手动编辑[那里](http://cksource.com/forums/viewtopic.php?t=16587)写的插件的源代码（

> 我想唯一的解决方案是从 image/dialogs/image.js 中删除所有引用这些 html 对象的 javascript 函数，这些 html 对象已被删除。

我尝试遵循此建议，但无法在没有后续错误的情况下编辑源文件）或编写我自己的。当然，我可以简单地添加一些 css 规则并隐藏元素，但我想这不是一个好主意。这个问题已经够老了，我确信有一个很好的解决方案，但我没能找到它。希望你能帮助我。先感谢您。

PS 我有最新版本的 CKEditor - 3.6.4。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-16T18:44:03.050

由于图像对话框的编写方式，如果不进一步调整文件的其余部分以删除其所有引用，您将无法轻松删除预览。

我建议您使用我的配置插件（或编写类似的代码），如下所述：http: [//alfonsoml.blogspot.com.es/2012/04/hide-dialog-fields-in-ckeditor.html](http://alfonsoml.blogspot.com.es/2012/04/hide-dialog-fields-in-ckeditor.html)

```
config.hideDialogFields="image:info:htmlPreview"; 
```

您可以从我的博客下载插件，或者如果您已切换到 CKEditor 4，请将其添加到您的构建中：[http ://ckeditor.com/addon/confighelper](http://ckeditor.com/addon/confighelper)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T17:59:43.500

你可以试试`infoTab.remove( 'htmlPreview' );`

# c# - Monodevelop：从 C#/Visual Studio 移植：双击消失

> ID：12307969
> 
> 赞同：4
> 
> 时间：2012-09-06T20:35:19.163
> 
> 标签：c#, visual-studio, monodevelop, double-click

在过去的 2 个月里，我在 Visual Studio 中用 C# 编写了应用程序。现在我必须通过 Monodevelop 将该应用程序移植到 Linux。好吧，我已经解决了大部分移植错误，但有一个我无法弄清楚。Visual Studio 中的所有双击和鼠标双击事件都停止工作 - 我什至创建了小型 1-form 应用程序，我只用窗体和一个事件（双击）移植到 Mono - 它也不起作用 - 这意味着 Monodevelop 不能移植双Visual Studio 中的单击事件？我已经检查了 WND_Proc 函数，Linux 没有抛出任何相应的双击事件（窗口中为 515，标题栏上为 300 ……）。我已经放弃并准备编写额外的代码来修复我的代码中的所有双击问题，但也许有人有答案。

我正在使用 Ubuntu linux（如果需要的话，我明天可能会检查内核版本）、MONO：2.8.3、Visual Studio 2008 和 .NET 3.5 中的项目。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-08T00:52:24.633

在实现鼠标点击时，您应该记住 Windows 和 Gtk# 之间的两个主要区别：

1.  Gtk# 不提供“双击”信号（Windows 术语中的“事件”），而仅提供“单击”信号。**但是 Gdk 库确实使用其 EventButton 类实现了双击和三次单击！**
2.  Gtk# 区分小部件（或 Windows 术语中的“控件”）和“容器”（在 Windows 中没有直接可比性）。大多数放置在 Gtk# 表单上的小部件不会接收鼠标点击事件。为了接收鼠标事件，您需要将小部件放置在特定容器内 - 例如 EventBox。

这是你如何做到的Gtk#：

A. 在表单中添加一个 EventBox 容器（在下面的示例中：eventbox1）。您可以将其放置在其他小部件之后，或者因为它不可见，除非您专门选择它（或更改其背景颜色）。您可以在 EventBox 中放置一个小部件，但您只能使用一个小部件，这也将获得 EventBox 的形状和大小。

B. 将“Common Widget Signals”中的“ButtonPressEvent”信号添加到此 EventBox（在下面的示例中：OnEventbox1ButtonPressEvent）

每次在 EventBox 内单击鼠标按钮（左、中、中或组合）时，都会触发该事件，并调用函数 OnEventbox1ButtonPressEvent()。如果您需要识别在处理此事件时单击的按钮，请使用以下 uint 值：args.Event.Button 通常“1”是鼠标左键，“2”是中间按钮，“3”是右键（“2”也可能是同时单击左右按钮时）。

顺便说一句，默认情况下不发送鼠标运动事件（没有按下按钮）。因此，如果您需要感知它们，您还需要在下面的代码示例中添加 PointMotionMask。

下面是一个使用 EventButton 类捕获双击事件的 ButtonPress 事件处理程序（EventBox 名称为 'eventbox1'）的代码示例：

```
// The following line is may not be needed but is here to show how to do it
eventbox1.GdkWindow.Events = eventbox1.GdkWindow.Events | Gdk.EventMask.ButtonPressMask;

protected void OnEventbox1ButtonPressEvent (object o, ButtonPressEventArgs args)
{
    if( ((Gdk.EventButton)args.Event).Type == Gdk.EventType.TwoButtonPress)
        System.Media.SystemSounds.Beep.Play (); // Play a sound only if this is a double-click event
} 
```

接收到的事件的顺序（在双击的情况下）是：

1.  Gdk.EventType.ButtonPress
2.  Gdk.EventType.ButtonRelease
3.  Gdk.EventType.ButtonPress
4.  Gdk.EventType.TwoButtonPress
5.  Gdk.EventType.ButtonRelease

希望有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T20:47:13.930

GTK# 处理双击事件的方式与 Windows 窗体不同。您将不得不编写代码来翻译事件。如果你这样做，你不妨花时间反对双击作为成语。

# ruby-on-rails - 带有 Nginx 和 Unicorn 的 Rails 3 子域

> ID：12307972
> 
> 赞同：1
> 
> 时间：2012-09-06T20:35:27.643
> 
> 标签：ruby-on-rails, nginx, unicorn

我有一个 Rails 应用程序，它通过 Capistrano 部署到 VPS，其设置与[此 Railscast](http://railscasts.com/episodes/335-deploying-to-a-vps)非常相似。我有 mydomain.co.uk 和 admin.mydomain.co.uk。子域在本地使用 lvh.me 和标准 Webbrick 服务器可以正常工作，但在生产中 admin.mydomain.co.uk 显示的内容与 mydomain.co.uk 完全相同。

**我的 routes.rb 文件：**

```
class AdminDomain
  def self.matches?(request)
    puts "Sub = #{request.subdomain}"
    request.subdomain.present? && request.subdomain == "admin"
  end
end

MyApp::Application.routes.draw do

  constraints(AdminDomain) do
    scope :module => "admin" do
      match '', to: 'admin#index'

      resources :users
    end
  end

  # All the mydomain.co.uk routes... 
```

**我的 Nginx 配置：**

```
upstream unicorn {
  server unix:/tmp/unicorn.<%= application %>.sock fail_timeout=0;
}

server {
  listen 80;
  root <%= current_path %>/public;

  server_name mydomain.co.uk admin.mydomain.co.uk;

  listen 443 ssl;
  ssl_certificate /home/deployer/mydomain_combined.crt;
  ssl_certificate_key /home/deployer/mydomain.key;
  proxy_set_header X-Forwarded-Proto $scheme;

  auth_basic            "Restricted";
  auth_basic_user_file  htpasswd;

  location ^~ /assets/ {
    gzip_static on;
    expires max;
    add_header Cache-Control public;
  }

  location = /favicon.ico {
    expires    max;
    add_header Cache-Control public;
  }

  if (-f $document_root/system/maintenance.html) {
    return 503;
  }

  error_page 503 @maintenance;

  location @maintenance {
    rewrite  ^(.*)$  /system/maintenance.html last;
    break;
  }

  try_files $uri/index.html $uri @unicorn;
  location @unicorn {
    proxy_set_header X-Forwarded-Proto $scheme;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header Host $http_host;
    proxy_redirect off;
    proxy_pass http://unicorn;
  }

  error_page 500 502 503 504 /500.html;
  client_max_body_size 4G;
  keepalive_timeout 10;
} 
```

我唯一的想法是 Nginx 没有将请求 url 传递给独角兽。我对 SSL 有类似的问题，但通过添加`proxy_set_header X-Forwarded-Proto $scheme;`. 如何让子域在 Nginx 和 Unicorn 下的生产环境中正常运行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T10:04:00.577

It seems that under my setup in production `request.subdomain` was set to 'admin.mydomain' whereas in development it was just 'admin'.

Therefore adding this into the routes.rb with a regex works both locally and on my production server:

```
constraints :subdomain => /admin.*/ do
  scope :module => "admin" do
    root to: 'admin#index'
  end
end 
```

# wcf - Silverlight 调用 WCF 服务的性能

> ID：12307974
> 
> 赞同：1
> 
> 时间：2012-09-06T20:35:54.803
> 
> 标签：wcf, performance, web-services, silverlight

我遇到了从 Silverlight 调用 WCF Web 服务非常慢的问题。[这种情况与http://forums.silverlight.net/t/148027.aspx/1](http://forums.silverlight.net/t/148027.aspx/1)中概述的情况非常相似。像那张海报一样，我建立了一个简单的 Silverlight 应用程序项目和一个简单的控制台应用程序项目。在每一个中，我都向我的 WCF 服务添加了一个服务引用，并向该服务添加了一些测试调用。但是，每次通话所需的时间却截然不同。控制台应用程序以毫秒为单位进行调用。Silverlight 应用程序可以在 3-5 秒内完成。

在我上面链接的帖子中，当发帖人将他的服务更改为使用二进制消息编码时，速度差距消失了。但是，在我的情况下，无论我使用的是二进制消息编码还是文本消息编码，都会存在很大的速度差距。

什么可以解释这种速度差异？我已经通过 fiddler 验证，当我将请求和响应配置为使用我的二进制端点时，它都是二进制编码的。我还通过多次连续的 Web 服务调用验证了慢速仍然存在，因此它不能只是启动时间。问题必须在 Silverlight 方面的某个地方。

这是我用来测量时差的代码片段：

```
 var proxy = new WCFRef.WebServicesClient("binary");
    var callbegin = DateTime.Now;
    proxy.CallWSMethodAsync();
    var callend = DateTime.Now;
    var span = callend.Subtract(callbegin);
    Debug.WriteLine("call time: " + span.Seconds + "." + span.Milliseconds + " sec"); 
```

该代码中捕获的时间跨度是我所说的跨度，控制台（几毫秒）和 SL（几秒）之间的差异很大。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T17:52:02.767

几个月前，我们也遇到了 WCF 的这个减速带。为什么它很慢我们不知道。我猜 SOAP 通常有点慢（很多开销），而且序列化程序的性能也不是那么好。

我们最近切换到了 REST 架构（服务堆栈，但 web API/asp.net mvc 也可以正常工作。我们只是更喜欢服务堆栈），我们的性能从 2 倍提高到 15 倍。WCF 在接受和序列化/反序列化请求方面非常慢。

我猜想silverlight与它被剥离了.net与它有关。

我们还用纯序列化器做了一些测试。将 wcf 使用的 xml/binary 序列化程序切换为 costum JSON 序列化程序，我们得到了巨大的提升。唉，用 silverlight 切换 WCF 中的序列化程序并不容易。

# python - 无法在 SocketServer.TCPServer 中重用套接字

> ID：12307986
> 
> 赞同：3
> 
> 时间：2012-09-06T20:36:52.097
> 
> 标签：python, sockets, socketserver

我遇到了 SocketServer.TCPServer 的问题。我正在线程中运行服务器。使用 Watchdog 观察目录树。当“on_any_event”运行时，我需要关闭服务器并重新启动它。不幸的是，我无法让 SocketServer.TCPServer 重用该地址。我检查了 SocketServer.py 文件，如果`allow_reuse_address`是 True 它应该设置`socket.SO_REUSEADDR`为 1。但它仍然失败`error: [Errno 98] Address already in use` 。在重试之前睡 10 秒也无济于事。有什么帮助吗？

```
class Server(SocketServer.TCPServer):
    allow_reuse_address = True

class ChangeHandler(FileSystemEventHandler):
    def __init__(self):
        FileSystemEventHandler.__init__(self)
        self.rebuild()

    def on_any_event(self, event):
        print event
        self.httpd.shutdown()
        self.t.join()
        self.rebuild()

    def rebuild(self):
        self.t, self.httpd = runserver()

def runserver():
    handler = SimpleHTTPServer.SimpleHTTPRequestHandler
    httpd = Server((HOST, PORT), handler, bind_and_activate=False)
    httpd.server_bind()
    httpd.server_activate()
    t = threading.Thread(target=httpd.serve_forever)
    t.daemon = True
    t.start()
    print "Live at http://{0}:{1}".format(HOST, PORT)
    return t, httpd

if __name__ == "__main__":
    handler = ChangeHandler()
    observer = Observer()
    observer.schedule(handler, path=ROOT, recursive=True)
    observer.start()

    try:
        while True:
            time.sleep(1)
    except KeyboardInterrupt:
        observer.stop()
    observer.join() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-06T21:10:26.663

TCPServer 实现了未记录的方法 server_close()，在事件处理程序中的 self.t.join() 之前或之后调用它，因为这将实际关闭底层套接字。正如所写的那样，您似乎可能会泄漏套接字。

```
def on_any_event(self, event):
    print event
    self.httpd.shutdown()
    self.httpd.server_close() # actually close the socket
    self.t.join()
    self.rebuild() 
```

在您关闭套接字之前，地址实际上正在使用中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-06T21:02:29.840

添加一个`self.httpd.server_close()`之后`self.httpd.shutdown()`就可以了。

# r - 在 ggplot 箱线图中显示平均值

> ID：12307987
> 
> 赞同：4
> 
> 时间：2012-09-06T20:37:02.683
> 
> 标签：r, ggplot2

我需要能够在 ggplot 箱线图中显示平均值。下面适用于一个点，但我需要白色虚线？任何身体帮助？

```
x

Team     Value
A        10
B        5
C        29
D        35
ggplot(aes(x = Team , y = Value), data = x) 
+ geom_boxplot (aes(fill=Team), alpha=.25, width=0.5, position = position_dodge(width = .9)) 
+ stat_summary(fun.y=mean, colour="red", geom="point") 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-05-30T22:02:20.867

这是我为箱线图添加均值的方法：

```
ggplot(RQA, aes(x = Type, y = engagementPercent)) + 
geom_boxplot(aes(fill = Type),alpha = .6,size = 1) + 
scale_fill_brewer(palette = "Set2") + 
stat_summary(fun.y = "mean", geom = "text", label="----", size= 10, color= "white") +
ggtitle("Participation distribution by type") + 
theme(axis.title.y=element_blank()) + theme(axis.title.x=element_blank()) 
```

![在此处输入图像描述](../Images/4a370afeefd6e311dee2be1e21bb9e42.png)

```
ggplot(df, aes(x = Type, y = scorepercent)) + 
geom_boxplot(aes(fill = Type),alpha = .6,size = 1) + 
scale_fill_brewer(palette = "Set2") + 
stat_summary(fun.y = "mean", geom = "point", shape= 23, size= 3, fill= "white") +
ggtitle("score distribution by type") + 
theme(axis.title.y=element_blank()) + theme(axis.title.x=element_blank()) 
```

![在此处输入图像描述](../Images/8d113e88408ee7a1c9f9d1c86290120b.png)

我会警告不要对此使用文本并改为使用 geom_line，因为文本会稍微偏移并给出错误的均值描述。

嘿，user1471980，我认为如果你有一个独特的用户名，人们会更愿意提供帮助，但是你又有很多要点 :)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T21:24:54.200

这是一个技巧，但这有帮助吗：

```
Value<-c(1,2,3,4,5,6)
Team<-c("a","a","a","b","b","b")
x<-data.frame(Team,Value) #note means for a=2, mean for b=5

ggplot(aes(x = Team , y = Value), data = x) + geom_boxplot (aes(fill=Team), alpha=.25, width=0.5, position = position_dodge(width = .9)) + 
annotate(geom="text", x=1, y=2, label="----", colour="white", size=7, fontface="bold", angle=0) + 
annotate(geom="text", x=2, y=5, label="----", colour="white", size=7, fontface="bold", angle=0) 
```

![在此处输入图像描述](../Images/d2e3ba6a077979c5c066f445b5f2cb7e.png)

# c - 在 C 中执行 Rot13 时崩溃

> ID：12307991
> 
> 赞同：1
> 
> 时间：2012-09-06T20:37:10.553
> 
> 标签：c, arrays, char, rot13

我觉得这应该是非常基本的，但由于某种原因我被卡住了。

这是我所拥有的：

```
char *rot13(char *s)
{        
    char *p=s;        
    int upper;

    while (*p) {    
        upper=toupper(*p);              
        if (upper >='A' && upper <= 'M')
            *p+=13;  
        else if (upper>='N' && upper <= 'Z')
            *p-=13;  
        ++p;    
    }       
    return s;
} 
```

我不是 C 大师，但我相对确定这是一件微不足道的事情，我似乎无法确定它。我得到的错误是，一旦它碰到任何一个 char 修饰符（`*p+=13`或`*p-=13`），我就会得到“############ 处的未处理异常：访问冲突写入位置 #####”

我究竟做错了什么？

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-06T20:40:52.287

您是否可能`rot13()`使用（指向a）字符串文字作为实际参数进行调用？字符串文字在 C 中是只读的。试试看

```
char foo[] = "YOUR STRING TO BE ROT13'D IN-PLACE.";

rot13 (foo); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T23:44:16.413

就像pmg所说，阅读FAQ。以下示例可能会帮助您朝着正确的方向前进。

这是使用指向 char 而不是 char 数组的指针的示例：

```
char *foo = malloc(36); // 35 + 1 for ending '\0'
strcpy(foo, "YOUR STRING TO BE ROT13'D IN-PLACE."); // requires #include <string.h>
printf("%s\n", rot13(foo)); 
```

# sql - 使用 SQL 计算 AVG 限制为最后 10 行并按 SQLite 中的字段分组

> ID：12307997
> 
> 赞同：2
> 
> 时间：2012-09-06T20:37:22.757
> 
> 标签：sql, sqlite

我有一个具有以下布局的表格：

```
CREATE TABLE uploads ( 
    id      INTEGER     PRIMARY KEY AUTOINCREMENT
                        NOT NULL,
    user    CHAR( 32 )  NOT NULL,
    score   INTEGER     NOT NULL,
); 
```

我正在尝试计算每个用户最近 10 个分数的平均值。

我已经尝试了许多不同的 SQL 查询，所有这些查询似乎都没有接近工作，所以我不会在这里粘贴它们中的任何一个:(

以下查询适用于获取单个用户的平均值，但我无法按用户列分组或基于用户字段执行相关子查询。

select avg(score) from (select score from upload where user="TEST" order by id limit 10)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T20:43:52.020

我不肯定这在 SQLite 中有效，但这是获得此结果的标准 SQL 方式：

```
select u.*
       (select avg(score*1.0) from (select * from uploads u2 where u2.user = u.user order by id desc limit 10)) as avg10
from uploads u 
```

德姆斯提出了一个很好的观点。要为每个用户获取一行，您可以执行以下操作：

```
select u.user,
       (select avg(score*1.0) from (select * uploads u2 where u2.user = u.user order by id desc limit 10) t) as avg10
from (select distinct user
      from uploads
     ) u 
```

我将 distinct 放在子查询中，因此 SELECT 中的子查询不会被评估太多次。用户表也是一个好主意，而不是子查询。