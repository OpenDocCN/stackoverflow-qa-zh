# StackOverflow 问答 000809000-000809999

# windows - 获取目录总大小的 PowerShell 脚本

> ID：809014
> 
> 赞同：18
> 
> 时间：2009-04-30T20:53:28.533
> 
> 标签：windows, powershell, scripting, filesystems, sysadmin

我需要递归地获取目录的大小。我每个月都必须这样做，所以我想制作一个[PowerShell](http://en.wikipedia.org/wiki/Windows_PowerShell)脚本来完成它。

我该怎么做？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-04-30T21:04:28.817

尝试以下

```
function Get-DirectorySize() {
  param ([string]$root = $(resolve-path .))
  gci -re $root |
    ?{ -not $_.PSIsContainer } | 
    measure-object -sum -property Length
} 
```

这实际上会产生一些汇总对象，其中将包括项目计数。您可以只获取 Sum 属性，这将是长度的总和

```
$sum = (Get-DirectorySize "Some\File\Path").Sum 
```

**编辑**为什么这有效？

让我们按管道的组件对其进行分解。该`gci -re $root`命令将递归地从起始`$root`目录中获取所有项目，然后将它们推送到管道中。因此， 下的每个文件和目录`$root`都将通过第二个表达式`?{ -not $_.PSIsContainer }`。传递给此表达式的每个文件/目录都可以通过变量访问`$_`. 前面的 ? 表示这是一个过滤器表达式，意思是只保留管道中满足此条件的值。PSIContainer 方法将为目录返回 true。所以实际上过滤器表达式只保留文件值。最终的 cmdlet measure-object 将对管道中剩余的所有值的属性 Length 的值求和。所以它本质上是为当前目录下的所有文件（递归）调用 Fileinfo.Length 并对值求和。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-01T17:34:25.960

如果您对包含隐藏文件和系统文件的大小感兴趣，则应将 -force 参数与 Get-ChildItem 一起使用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-14T14:42:38.113

这是获取特定文件扩展名大小的快速方法：

```
(gci d:\folder1 -r -force -include *.txt,*.csv | measure -sum -property Length).Sum 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-27T23:37:37.177

感谢那些在这里发帖的人。我采用了知识来创建这个：

```
# Loops through each directory recursively in the current directory and lists its size.
# Children nodes of parents are tabbed

function getSizeOfFolders($Parent, $TabIndex) {
    $Folders = (Get-ChildItem $Parent);     # Get the nodes in the current directory
    ForEach($Folder in $Folders)            # For each of the nodes found above
    {
        # If the node is a directory
        if ($folder.getType().name -eq "DirectoryInfo")
        {
            # Gets the size of the folder
            $FolderSize = Get-ChildItem "$Parent\$Folder" -Recurse | Measure-Object -property length -sum -ErrorAction SilentlyContinue;
            # The amount of tabbing at the start of a string
            $Tab = "    " * $TabIndex;
            # String to write to stdout
            $Tab + " " + $Folder.Name + "   " + ("{0:N2}" -f ($FolderSize.Sum / 1mb));
            # Check that this node doesn't have children (Call this function recursively)
            getSizeOfFolders $Folder.FullName ($TabIndex + 1);
        }
    }
}

# First call of the function (starts in the current directory)
getSizeOfFolders "." 0 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-02-11T00:28:52.240

要通过@JaredPar 完善[此答案](https://stackoverflow.com/a/809074/7163041)以扩展并提高性能：

```
function Get-DirectorySize() {
  param ([string]$root = $(Resolve-Path .))
  Get-ChildItem $root -Recurse -File |
    Measure-Object -Property Length -Sum |
    Select-Object -ExpandProperty Sum
} 
```

或者，为了更方便地使用 explore [type data](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_types.ps1xml?view=powershell-7.2)：

```
Update-TypeData -TypeName System.IO.DirectoryInfo -MemberType ScriptProperty -MemberName Size -Value {
  Get-ChildItem $this -Recurse -File |
    Measure-Object -Property Length -Sum |
    Select-Object -ExpandProperty Sum
} 
```

然后使用`Get-ChildItem | Select-Object Name,Length,Size`

# vb6 - 创建 ActiveX OCX 控件

> ID：809020
> 
> 赞同：1
> 
> 时间：2009-04-30T20:54:22.103
> 
> 标签：vb6, activex, ocx

我们使用的系统允许通过 .ocx 文件进行 ActiveX 扩展。

我需要编写一个扩展来绘制一些特定的专有图形。经过大量搜索，我发现 Visual Basic 6.0 可以创建这些 ActiveX 控件并将它们部署为 .ocx 文件。

那么，VB6 是唯一的选择吗？我不愿意相信微软自 1998 年以来没有引入其他选项。

* * *

作为对 RichieHindle 和 Arnshea 的回应，

在研究过程中，我发现 ActiveX 控件可能是使用 C++ 创建的，但我找不到将它们部署为 .ocx 文件的方法。就像dll一样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T20:57:41.860

您可以使用 Visual Studio 2005 或 2008，通过 ATL 或 MFC 在 C++ 中创建 ActiveX 控件。有向导可以提供帮助——这个过程相对轻松。8-)

OCX*是*一个 DLL - 它完全相同，只是文件扩展名不同。（学究的角落：我知道反之亦然；并非所有 DLL 都是 ActiveX 控件。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-30T20:58:45.413

您可以使用 Win32、ATL 或 MFC 项目在 C++ 或 C 中制作 ActiveX 控件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-27T22:45:32.823

Microsoft 有一个名为 ActivexPad 的工具。检查它是否适用于您的情况。

# ruby-on-rails - 在没有 HTTP 重定向的情况下从另一个控制器操作运行一个控制器操作的正确方法是什么？

> ID：809028
> 
> 赞同：10
> 
> 时间：2009-04-30T20:55:31.023
> 
> 标签：ruby-on-rails

我希望能够根据查询参数和数据库中的数据的组合，有条件地从一个控制器操作分派到另一个控制器操作。

我现在拥有的是这样的：

```
class OldController < ApplicationController
  def old_controller_action
    if should_use_new_controller
      new_params = params.dup
      new_params[:controller] = "new_controller_action"
      redirect_to new_params
      return
    end
    # rest of old and busted
  end
end

class NewController < ApplicationController
  def new_controller_action
    # new hotness
  end
end 
```

这工作得很好，但它发出一个 HTTP 重定向，这很慢。我希望能够在同一个 HTTP 请求中做同样的事情。

有没有一种干净的方法可以做到这一点？

**编辑：**赏金将交给可以向我展示一种干净的方法来做到这一点的人，使控制器及其操作相对保持不变（重定向代码本身除外）。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-30T22:18:42.400

不要跨动作调用代码，而是将代码提取到 lib/ 或其他东西，然后从两个控制器调用该代码。

```
# lib/foo.rb
module Foo
  def self.bar
  # ...
  end
end

# posts_controller
def index
  Foo.bar
end

# things_controller
def index
  Foo.bar
end 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-15T18:29:14.123

创建控制器类的实例：

```
@my_other_controller = MyOtherController.new 
```

然后调用它的方法：

```
@my_other_controller.some_method(params[:id]) 
```

我更喜欢模块的想法，但这应该可以解决问题。

您还可以从另一个控制器整体传递参数：

```
@my_other_controller.params = params 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T19:29:31.630

我怀疑你想要选项 3，但让我们先看看一些替代方案

**选项 1** - 将控制器选择逻辑推送到帮助器中，该帮助器将正确的链接插入到您的视图中。优点 - 控制器保持干净，缺点 - 如果决策逻辑取决于提交的值，则此方法将不起作用。如果外部网站正在调用 URL，那么这将不起作用。

**选项 2** - 将逻辑推回您的模型中。专业人士 - 保持控制器清洁。缺点 - 如果您有很多 sesson、params 或 render / redirect_to 交互，则效果不佳。

**选项 3** - 留在同一个控制器内。我怀疑您正在尝试用一些新功能替换一些现有功能，但仅在某些情况下。Pro's - 简单，可以访问您需要的一切。缺点 - 仅在使用相同控制器有意义时才有效，即您正在使用相同的实体，例如用户、地点或公司。

让我们看一个选项 3 的示例。我的链接控制器对管理员的行为与其他用户完全不同......

```
class LinksController < ApplicationController
  #...

  def new
    #Check params and db values to make a choice here
    admin? ? new_admin : new_user
  end

  #...

private

  def new_admin
    #All of the good stuff - can use params, flash, etc 
    render :action => 'new_admin'    
  end

  def new_user
    #All of the good stuff - can use params, flash, etc 
    render :action => 'new_user' 
  end

end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-17T06:19:20.620

如果两个控制器试图做同样的事情，那么这很有可能应该在模型中。好好看看你的设计——很抱歉，我不知道你对 MVC 的经验水平——阅读瘦控制器技术：

[http://weblog.jamisbuck.org/2006/10/18/skinny-controller-fat-model](http://weblog.jamisbuck.org/2006/10/18/skinny-controller-fat-model) [http://www.robbyonrails.com/articles/2007/06/19/put-your-controllers-on-a -饮食已经](http://www.robbyonrails.com/articles/2007/06/19/put-your-controllers-on-a-diet-already) [http://andrzejonsoftware.blogspot.com/2008/07/mvc-how-to-write-controllers.html](http://andrzejonsoftware.blogspot.com/2008/07/mvc-how-to-write-controllers.html)

如果问题是您需要另一个控制器来进行渲染，那么也许路线应该从一开始就指向那里，而瘦控制器技术仍然可以挽救这一天。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-19T10:14:52.067

如果将控制器之间的公共代码提取到模块中对您不起作用，我会使用 Rack 中间件。我还没有看到`ActiveRecord`在中间件中使用的代码，但我不知道为什么它不应该是不可能的，因为人们已经使用过`Redis`等等。

否则，我认为您唯一的选择是使用类似（未经测试的伪示例）重新开始处理请求：

```
env['REQUEST_URI'] = new_controller_uri_with_your_params
call(env) 
```

这类似于集成测试的实现方式。但我不知道从`call`你击中控制器之前的一切是否是幂等的并且像这样重新运行是安全的。您可以追溯源并查看。但即使现在没问题，它也可能会在任何未来版本的导轨或机架中损坏。

使用中间件可以通过让您在请求运行之前拦截请求来避免这种情况。您应该仍然能够通过将代码提取到两个地方都包含的公共模块中来与您的 Rails 应用程序共享代码。

老实说，我认为仅仅做一些简单的事情来分解公共控制器代码可能会更干净，但是如果没有你的情况的细节就很难知道，所以我想我会继续提出这个建议。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-05-19T00:20:12.483

做这个：

```
class OldController < ApplicationController
  def old_controller_action
    if should_use_new_controller
      new_controller_action
    end
    # rest of old and busted
  end
end 
```

和新的控制器

```
class NewController < OldController
  def new_controller_action
    # new hotness
  end
end 
```

# jquery - 在 AJAX 样式 jQuery UI 选项卡中加载的 jQuery UI 对话框窗口

> ID：809035
> 
> 赞同：59
> 
> 时间：2009-04-30T20:56:57.650
> 
> 标签：jquery, jquery-ui, modal-dialog

AJAX 选项卡运行良好。这部分非常简单。但是，让 AJAX UI Dialog 模式窗口触发链接并不成功。

对此的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：121
> 
> 时间：2009-09-25T12:13:54.220

没有比那个人更容易的了。试试这个：

```
<?xml version="1.0" encoding="iso-8859-1"?>
<html>
<head>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
    <link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" type="text/css" />
    <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/jquery-ui.min.js"></script>
    <style>
        .loading { background: url(/img/spinner.gif) center no-repeat !important}
    </style>
</head>
<body>
    <a class="ajax" href="http://www.google.com">
      Open as dialog
    </a>

    <script type="text/javascript">
    $(function (){
        $('a.ajax').click(function() {
            var url = this.href;
            // show a spinner or something via css
            var dialog = $('<div style="display:none" class="loading"></div>').appendTo('body');
            // open the dialog
            dialog.dialog({
                // add a close listener to prevent adding multiple divs to the document
                close: function(event, ui) {
                    // remove div with all data and events
                    dialog.remove();
                },
                modal: true
            });
            // load remote content
            dialog.load(
                url, 
                {}, // omit this param object to issue a GET request instead a POST request, otherwise you may provide post parameters within the object
                function (responseText, textStatus, XMLHttpRequest) {
                    // remove the loading class
                    dialog.removeClass('loading');
                }
            );
            //prevent the browser to follow the link
            return false;
        });
    });
    </script>
</body>
</html> 
```

请注意，您无法从本地远程加载，因此您必须将其上传到服务器或其他任何地方。另请注意，您无法从外部域加载，因此您应该将链接的 href 替换为托管在同一域上的文档（[这是解决方法](http://jquery-howto.blogspot.com/2009/04/cross-domain-ajax-querying-with-jquery.html)）。

干杯

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2011-02-11T21:30:51.743

为了避免在多次单击链接时添加额外`div`的 s，并避免在使用脚本显示表单时出现问题，您可以尝试使用 @jek 代码的变体。

```
$('a.ajax').live('click', function() {
    var url = this.href;
    var dialog = $("#dialog");
    if ($("#dialog").length == 0) {
        dialog = $('<div id="dialog" style="display:hidden"></div>').appendTo('body');
    } 

    // load remote content
    dialog.load(
            url,
            {},
            function(responseText, textStatus, XMLHttpRequest) {
                dialog.dialog();
            }
        );
    //prevent the browser to follow the link
    return false;
});` 
```

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2011-02-10T18:47:28.830

//正确格式化

```
<script type="text/Javascript">
  $(function ()    
{
    $('<div>').dialog({
        modal: true,
        open: function ()
        {
            $(this).load('mypage.html');
        },         
        height: 400,
        width: 600,
        title: 'Ajax Page'
    });
}); 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2012-04-13T01:46:23.497

只是对nicktea答案的补充。此代码加载远程页面的内容（不重定向到那里），并在关闭它时进行清理。

```
<script type="text/javascript">
    function showDialog() {
        $('<div>').dialog({
            modal: true,
            open: function () {
                $(this).load('AccessRightsConfig.htm');
            },
            close: function(event, ui) {
                    $(this).remove();
                },
            height: 400,
            width: 600,
            title: 'Ajax Page'
        });

        return false;
    }
</script> 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2011-10-20T17:09:50.863

对于可以打开指向不同页面的对话框的多个元素，前两个答案都不适用于我。

这感觉像是最干净的解决方案，只在加载时创建一次对话框对象，然后使用事件适当地打开/关闭/显示：

```
$(function () {
      var ajaxDialog = $('<div id="ajax-dialog" style="display:hidden"></div>').appendTo('body');
      ajaxDialog.dialog({autoOpen: false});
      $('a.ajax-dialog-opener').live('click', function() {
          // load remote content
          ajaxDialog.load(this.href);
          ajaxDialog.dialog("open");
          //prevent the browser from following the link
          return false;
      });
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-03-12T11:34:46.157

好奇 - 为什么“没有比这更容易”的答案（上面）不起作用？看起来合乎逻辑？ [http://206.251.38.181/jquery-learn/ajax/iframe.html](http://206.251.38.181/jquery-learn/ajax/iframe.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-02-23T10:45:58.130

我结合了几个答案，并想出了下面是在模式对话框中打开外部 url 的 JQuery 代码。

```
<html>
<head>
<script src="https://code.jquery.com/jquery-1.9.1.min.js" integrity="sha256-wS9gmOZBqsqWxgIVgA8Y9WcQOa7PgSIX+rPA0VL2rbQ=" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/ui/1.9.2/jquery-ui.js" integrity="sha256-PsB+5ZEsBlDx9Fi/GXc1bZmC7wEQzZK4bM/VwNm1L6c=" crossorigin="anonymous"></script>
<link rel="stylesheet" type="text/css" href="https://code.jquery.com/ui/1.9.2/themes/base/jquery-ui.css">
<body>
    <a href="https://wikipedia.com/" class="test">comment #1</a>
    <br>
    <a href="https://ebay.com/" class="test">comment #2</a>
    <br>
    <a href="https://ask.com/" class="test">comment #3</a>
    <br>
    <a class="ajax" href="https://api.github.com">Open github</a>
    <br>
    <a class="ajax" href="https://code.google.com/p/html5security/wiki/CrossOriginRequestSecurity">Open code google</a>
    <br>
    <a class="ajax" href="https://enable-cors.org/">Open enable-cors</a>
    <br>
    <div id="somediv" title="this is a dialog" style="display:none;">
        <iframe id="thedialog" width="350" height="350"></iframe>
    </div>
    <script type="text/javascript">
        $(document).ready(function () {
        $(".test").click(function () 
        {
            var url = $(this).attr("href");
            return openDialogwithiFrame(url);
        });
        });
    </script>
    <script type="text/javascript">
        $(function (){
            $('a.ajax').click(function() {
                var url = this.href;
                return openDialogwithiFrame(url);
            });
        });

        function openDialogwithiFrame(url)
        {
            $("#thedialog").attr('src', url);
            $("#somediv").dialog({
            width: 400,
            height: 450,
            modal: true,
            close: function () {
            $("#thedialog").attr('src', "about:blank");
            }
            });
            return false;
        }

        function openDialogwithoutiFrame(url)
        {
                // show a spinner or something via css
                var dialog = $('<div style="display:none" class="loading"></div>').appendTo('body');
                // open the dialog
                dialog.dialog({
        // add a close listener to prevent adding multiple divs to the document
                    close: function(event, ui) {
                        // remove div with all data and events
                        dialog.remove();
                    },
                    modal: true
                });
                // load remote content
                dialog.load(
                    url, 
                    //{},  omit this param object to issue a GET request instead a POST request, otherwise you may provide post parameters within the object
                    function (responseText, textStatus, XMLHttpRequest) {
                        // remove the loading class
                        dialog.removeClass('loading');
                    }
                );
                //prevent the browser to follow the link
                return false;
        }
    </script>
</body>
</html> 
```

该代码有两个功能。

1.  openDialogwithiFrame(url) :- 这可以在模型对话框中打开任何外部 url。但它使用 iframe。
2.  openDialogwithoutiFrame(url):-这也会在模型对话框中打开外部 url，但它的标题为“Access-Control-Allow-Origin”以更正值。我已将此类 url 放入示例代码中。此设置需要在 Web 服务器上完成。参考 [https://medium.com/pareture/simple-local-cors-test-tool-544f108311c5](https://medium.com/pareture/simple-local-cors-test-tool-544f108311c5)。对于在 Apache Web 服务器上设置标题“Access-Control-Allow-Origin”，应在 Apache 服务器的 .htaccess 中添加以下内容。

```
 Header set Access-Control-Allow-Origin “*” //Replace domain of host sites separated by comma for *
    Header always set Access-Control-Allow-Methods "POST, GET, OPTIONS"
    Header always set Access-Control-Allow-Headers "content-type "
    Header always set Access-Control-Allow-Credentials "true" 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-04-30T20:59:53.290

```
<a href="javascript:void(0)" onclick="$('#myDialog').dialog();">
  Open as dialog
</a>

<div id="myDialog">
I have a dialog!
</div> 
```

[请参阅我在 jsbin.com 上发布的示例](http://jsbin.com/eyaqu)。

# python - 查找 HTML 页面上的所有 IP

> ID：809037
> 
> 赞同：0
> 
> 时间：2009-04-30T20:57:12.593
> 
> 标签：python, regex, screen-scraping, extract

我想用 python 获取一个 HTML 页面，然后从中打印出所有的 IP。我将定义一个IP如下：

**x**。**x**。**x**。**x** :**是的**

其中： x = 0 到 256 之间的数字。y = < 7 位数字。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-30T21:14:43.537

> 正确的。我唯一不能做的是正则表达式。– das 9 分钟前 如果有人告诉我，我会没事的。– 达斯 8 分钟前

```
import re

ip = re.compile(r"\b(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?):\d{1,6}\b")
junk = " 1.1.1.1:123 2.2.2.2:321 312.123.1.12:123 "
print ip.findall(junk)

# outputs ['1.1.1.1:123', '2.2.2.2:321'] 
```

这是一个完整的例子：

```
import re, urllib2

f = urllib2.urlopen("http://www.samair.ru/proxy/ip-address-01.htm")
junk = f.read()

ip = re.compile(r"\b(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?):\d{1,6}\b")
print ip.findall(junk)

# ['114.30.47.10:80', '118.228.148.83:80', '119.70.40.101:8080', '12.47.164.114:8888', '121.
# 17.161.114:3128', '122.152.183.103:80', '122.224.171.91:3128', '123.234.32.27:8080', '124.
# 107.85.115:80', '124.247.222.66:6588', '125.76.228.201:808', '128.112.139.75:3128', '128.2
# 08.004.197:3128', '128.233.252.11:3124', '128.233.252.12:3124'] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-30T21:01:45.593

基本方法是：

*   用于[`urllib2`](http://docs.python.org/library/urllib2.html)下载页面内容
*   使用[正则表达式](http://docs.python.org/library/re.html)提取类似 IPv4 的地址
*   根据每个八位字节的数字约束验证每个匹配项
*   打印匹配列表

请提供更清晰的说明，说明您遇到问题的具体部分，以及证明您迄今为止尝试过的证据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-30T21:12:25.430

尝试：

```
re.compile("\d?\d?\d.\d?\d?\d.\d?\d?\d.\d?\d?\d:\d+").findall(urllib2.urlopen(url).read()) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-30T00:17:38.600

**[在行动](http://regexr.com?3202m)**：

```
\b(?:                # A.B.C in A.B.C.D:port
    (?:
       25[0-5]
    |  2[0-4][0-9]
    |  1[0-9][0-9]
    |  [1-9]?[0-9]
    )\.
  ){3}
  (?:                # D in A.B.C.D:port
    25[0-5]
  | 2[0-4][0-9]
  | 1[0-9][0-9]
  | [1-9]?[0-9]
  )
  :[1-9]\d{0,5}     # port number any number in (0,999999]
\b 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-30T21:15:45.577

不要把这变成一场谁是更好的正则表达式作者之战，但是......

```
(\d{1,3}\.){3}\d{1,3}\:\d{1,6} 
```

# jquery - 如何手动触发使用 jQuery 连接的事件？

> ID：809038
> 
> 赞同：0
> 
> 时间：2009-04-30T20:57:12.750
> 
> 标签：jquery

如何在之前使用 jQuery 连接的按钮上手动触发单击事件？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-30T20:58:09.487

使用[触发器。（链接到触发器的文档）](http://docs.jquery.com/Events/trigger)

```
$("button:first").click(function () {
  update($("span:first"));
});
$("button:last").click(function () {
  $("button:first").trigger('click');

  update($("span:last"));
});

function update(j) {
  var n = parseInt(j.text(), 10);
  j.text(n + 1);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-30T20:59:09.360

我这样做的一种方法是：

$('#pSearch').click();

pSearch 是我要单击的按钮的 ID。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-04T00:01:18.283

您可以使用 ID 或类名作为选择器来选择元素

然后你可以这样做

$(".className").click();

$("#ID").click();

它适用于我，您可以在 chrome 控制台中尝试

# c# - IoC、Dll 引用和程序集扫描

> ID：809051
> 
> 赞同：10
> 
> 时间：2009-04-30T21:00:20.030
> 
> 标签：c#, inversion-of-control, structuremap

虽然这个问题与 StructureMap 有关，但我的*一般*问题是：

> **在代码中**使用 IoC 容器连接组件（而不是通过**xml**配置）时，您通常需要对所有程序集的显式项目/构建引用吗？

为什么是单独的程序集？因为：

* * *

> “抽象类位于与其具体实现不同的程序集中，是实现这种分离的好方法。” -**框架设计指南 p.91**

* * *

例子：

假设我有*PersonBase.dll*和*Bob.dll*

*Bob*继承自抽象类*PersonBase*。它们都在*Person*命名空间中。**但在不同的程序集中**。

我正在编程*PersonBase*，而不是*Bob*。

回到我的主要代码，我需要一个人。StructureMap 可以扫描程序集。太好了，我会向 StructureMap 要一个！

现在，在我的主要代码中，我当然只指*PersonBase*，而不是*Bob*。我实际上不希望我的代码知道*任何*关于*Bob*的信息。没有项目参考，没有 nuthin。这就是重点。

所以我想说：

```
//Reference: PersonBase.dll (only)
using Person;  
...

//this is as much as we'll ever be specific about Bob:
Scan( x=> { x.Assembly("Bob.dll"); }

//Ok, I should now have something that's a PersonBase (Bob). But no ?
ObjectFactory.GetAllInstances<PersonBase>().Count == 0 
```

没运气。什么是明确的，我想要鲍勃：

```
//Reference: PersonBase.dll and Bob.dll
using Person; 
...
Scan( x => {x.Assembly("Bob.dll"); }

//If I'm explicit, it works. But Bob's just a PersonBase, what gives?
ObjectFactory.GetAllInstances<Bob>().Count == 1 //there he is! 
```

但是现在我不得不在我的项目中引用*Bob.dll*，这正是我不想要的。

我可以使用 Spring + Xml 配置来避免这种情况。但后来我回到 Spring + Xml 配置......！

> 我是否在使用 StructureMap 时遗漏了什么，或者作为一般原则，（流利的）IoC 配置是否需要对所有程序集的显式引用？

可能相关的问题：[StructureMap 和扫描程序集](https://stackoverflow.com/questions/508399/structuremap-and-scanning-assemblies)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-03T05:04:14.280

我终于解决了这个问题。它看起来像这样：

[IoC Uml http://img396.imageshack.us/img396/1343/iocuml.jpg](http://img396.imageshack.us/img396/1343/iocuml.jpg)

与组件

*   核心程序
*   PersonBase.dll（Core.exe 引用的**编译时间**）
*   Bob.dll（通过 StructureMap 扫描 **加载运行时）**
*   Betty.dll（通过 StructureMap Scan **加载运行时）**

为了使用 StructureMap 获得它，我需要一个自定义的“ITypeScanner”来支持扫描程序集：

```
public class MyScanner : ITypeScanner {
  public void Process(Type type, PluginGraph graph) {

    if(type.BaseType == null) return;

    if(type.BaseType.Equals(typeof(PersonBase))) {
      graph.Configure(x => 
        x.ForRequestedType<PersonBase>()
        .TheDefault.Is.OfConcreteType(type));
    }
  }
} 
```

所以我的主要代码如下：

```
ObjectFactory.Configure(x => x.Scan (
  scan =>
  {
    scan.AssembliesFromPath(Environment.CurrentDirectory 
    /*, filter=>filter.You.Could.Filter.Here*/);

    //scan.WithDefaultConventions(); //doesn't do it

    scan.With<MyScanner>();
  }
));

ObjectFactory.GetAllInstances<PersonBase>()
 .ToList()
  .ForEach(p => 
  { Console.WriteLine(p.FirstName); } ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-30T21:12:09.877

您也可以使用 StructureMap 进行 xml 配置。如果你愿意，你甚至可以混合它们。

您还可以将 StructureMap 属性放入 Bob 类中，以告诉 StructureMap 如何加载程序集。DefaultConstructor 是我不时使用的一个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-30T21:25:12.060

自动扫描选项仅在您保持命名、程序集和命名空间约定时才有效。您可以使用流畅的界面手动配置结构图。例子：

```
ObjectFactory.Initialize(initialization => 
   initialization.ForRequestedType<PersonBase>()
    .TheDefault.Is.OfConcreteType<Bob>()); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-02T20:02:23.753

我们在我当前的项目上做了什么（它使用 AutoFac，而不是 StructureMap，但我认为它不应该有所作为）：

我们有定义应用程序在核心程序集中使用的外部服务的接口，比方说`App.Core`（比如您的 PersonBase）。

然后我们在`Services.Real`（如 Bob.dll）中有这些接口的实现。

在我们的例子中，我们也有`Service.Fake`，用于促进 UI 测试，依赖于其他企业服务和数据库等。

前端“客户端”应用程序本身（在我们的例子中是 ASP.NET MVC 应用程序）引用`App.Core`.

当应用程序启动时，我们使用`Assembly.Load`基于配置设置加载适当的“服务”实现 DLL。

这些 DLL 中的每一个都有一个 IServiceRegistry 实现，它返回它实现的服务列表：

```
public enum LifestyleType { Singleton, Transient, PerRequest}

public class ServiceInfo {
    public Type InterfaceType {get;set;}
    public Type ImplementationType {get;set;}
    // this might or might not be useful for your app, 
    // depending on the types of services, etc.
    public LifestyleType Lifestyle {get;set;} 
}

public interface IServiceRegistry {
    IEnumerable<ServiceInfo> GetServices();
} 
```

...应用程序通过反射找到这个 ServiceRegistry 并枚举这些 ServiceInfo 实例并将它们注册到容器上。对我们来说，这个 register-all-services 存在于 Web 应用程序中，但是可以（并且在许多情况下更可取）将它放在一个单独的程序集中。

通过这种方式，我们可以将域逻辑与基础设施代码隔离开来，并防止应用程序最终依赖于对基础设施代码的直接引用而出现“仅此一次”的变通方法。我们还避免在每个服务实现中都必须引用容器。

如果您这样做，一件非常重要的事情是：*确保*您有测试来验证您可以使用 IOC 容器的每个潜在配置创建每个“顶级”类型（在我们的示例中为 ASP.NET MVC 控制器）。

否则，很容易忘记实现一个接口并破坏应用程序的大部分。

# sql - 在你的 ON 子句中加入更多逻辑是否更好，或者它应该只有最低限度的必要条件？

> ID：809052
> 
> 赞同：7
> 
> 时间：2009-04-30T21:00:47.750
> 
> 标签：sql, sql-server

鉴于这两个查询：

```
Select t1.id, t2.companyName 
from table1 t1 
  INNER JOIN table2 t2 on t2.id = t1.fkId 
WHERE t2.aField <> 'C' 
```

或者：

```
Select t1.id, t2.companyName 
from table1 t1 
  INNER JOIN table2 t2 on t2.id = t1.fkId  and t2.aField <> 'C' 
```

两者之间有明显的区别吗？在我看来，“t2.aField <> 'C'”子句将在 t2 中满足连接条件的每一行上运行。我不正确吗？

**更新：**我在 SQL Server 中做了一个“包括实际执行计划”。这两个查询是相同的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-30T21:13:12.183

我更喜欢使用 Join 标准来解释表是如何连接在一起的。所以我会将附加条款放在 where 部分。

我希望（尽管我没有统计数据）SQL Server 足够聪明，可以找到最佳查询计划，而不管您使用何种语法。

但是，如果您的索引中也有 id 和 aField，我建议您将它们放在内部连接条件中。

看看这 2 个（或 3 个）场景中的查询计划，看看会发生什么会很有趣。好问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-30T21:14:26.813

它们是有区别的。您应该为这两个选择做一个 EXPLAIN PLAN 并详细查看它。

至于更简单的解释：WHERE 子句仅在两个表连接后执行，因此它对连接返回的每一行执行，而不是 table2 中的每一行。

性能方面，最好尽早消除不需要的结果，因此以后要处理的连接、where 子句或其他操作的行数应该更少。

在第二个示例中，有 2 列必须相同才能将行连接在一起，因此它通常会给出与第一个不同的结果。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-30T21:47:50.600

这取决于。

```
SELECT
  t1.foo,
  t2.bar
FROM
  table1 t1
  LEFT JOIN table2 t2 ON t1.SomeId = t2.SomeId
WHERE
  t2.SomeValue IS NULL 
```

不同于

```
SELECT
  t1.foo,
  t2.bar
FROM
  table1 t1
  LEFT JOIN table2 t2 ON t1.SomeId = t2.SomeId AND t2.SomeValue IS NULL 
```

这是不同的，因为前者删除了 t2 中在 t2.SomeValue 中具有 NULL 的所有记录*以及*t1 中未在 t2 中引用的所有记录。后者仅删除 t2.SomeValue 中为 NULL 的 t2 记录。

只需将 ON 子句用于连接条件，将 WHERE 子句用于过滤器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-30T22:51:55.393

除非将连接条件移动到 where 子句会改变查询的含义（如上面的左连接示例），否则将它们放在哪里都没有关系。SQL 将重新排列它们，只要它们可证明是等效的，您就会得到相同的查询。

话虽这么说，我认为这更像是一个逻辑/可读性的事情。我通常将与两个表相关的任何内容放在联接中，并将任何过滤的内容放在 where 中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-30T21:16:57.603

我更喜欢第一个查询。SQL Server 将根据您拥有的索引为您的查询使用最佳连接类型，之后将应用 WHERE 子句。但是您可以同时运行两个查询，查看执行计划，比较并选择最快的（还可以优化添加索引）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-30T21:58:21.590

除非您正在开发单用户应用程序或类似的小型应用程序，否则会产生微不足道的负载，唯一有意义的考虑因素是服务器将如何处理您的查询。

提到查询计划的答案提供了很好的建议。

此外，设置 io statistics on 以了解您的查询将产生多少读取（我特别喜欢 Azder 的帖子）。

将每个数据库服务器视为从磁盘到客户端的数据泵。如果该泵仅执行完成工作所需的 IO，它的运行速度会更快。如果数据在缓存中，它会更快。但是您不想从磁盘读取超过您需要的内容 - 这将导致无缘无故地挤出缓存中的有用数据。

# survey - 什么是涉及编码的好游戏？

> ID：809053
> 
> 赞同：8
> 
> 时间：2009-04-30T21:00:48.967
> 
> 标签：survey

我记得 Shadowrun 的那些日子让我对黑客技术感到兴奋。CodeWar 和 LightBot 都很有趣（虽然 CoreWar 有点过时了）。还有哪些其他涉及编码的游戏既有趣又具有挑战性，可以用来让人们对编码感到兴奋或发挥他们的才能，甚至学习基础知识？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-30T21:32:20.920

[RoboCode](https://robocode.sourceforge.io/)怎么样

你用 Java 对你的坦克进行编码，然后让它与其他编码的坦克一起在“环”中释放。人们非常喜欢编码策略、定位等。IBM 赞助了它，并提供了一些很好的入门编程教程来帮助你入门。

这是一篇很棒的文章，可以感受一下：

[**Rock 'em, sock 'em Robocode！**](https://www.ibm.com/developerworks/java/library/j-robocode/)

[![替代文字](https://i.stack.imgur.com/jExOj.jpg)](https://i.stack.imgur.com/jExOj.jpg)
[（来源：[sourceforge.net](http://sourceforge.net/dbimage.php?id=89605)）]

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-30T21:20:56.563

[Uplink](http://www.introversion.co.uk/uplink/home.html)与其说是一种编码游戏，不如说是一款让您感觉像黑客的出色游戏。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-30T21:48:13.173

有一大堆“拖放”编码游戏，您可以在其中制作一个小东西（通常是机器人），通过给它一个指令列表来解决一些难题。它们与实际编码只是模糊地相似，但它们仍然很有趣。

[RoboZZle](http://robozzle.com/)

[炼金术法典](http://www.zachtronicsindustries.com/alchemy/alchemy.htm)

[光机器人](http://www.kongregate.com/games/Coolio_Niato/light-bot)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-30T21:03:48.820

不确定它是否被视为“游戏”，但[TopCoder 比赛](http://www.topcoder.com)很有趣，并且有各种规模和承诺级别。您还可以从档案中解决难题，以获得一些良好的编程实践。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-30T21:08:54.533

[Python Challenge](http://www.pythonchallenge.com/)就像那些“查看 html 源代码”的谜语，但需要一些编程才能获得答案。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-30T21:02:57.433

当我还是个孩子的时候，我玩过“洛基的靴子”，你必须在其中连接逻辑门来解决难题。这对我的想法产生了很大的影响。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-30T21:32:27.800

[核心战争。](http://www.corewars.org/)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-30T21:06:46.330

这里有一些东西可以让你*制作*游戏和动画：[Alice](http://www.alice.org/ "爱丽丝")

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-30T21:11:46.600

如果您正在寻找棋盘游戏，您可能想看看[Robo Rally](http://www.boardgamegeek.com/boardgame/18)。在这场比赛中，2-8 人试图尽快将他们的机器人操纵在棋盘上，躲避致命的障碍物，并试图将其他机器人推入途中的障碍物。

每一轮比赛，所有玩家都必须“编码”机器人将在下一轮执行的程序，然后机器人就按照他们的程序进行操作。这些程序只有五个指令长，但仍然创建一个最佳程序可能相当棘手。通常很少涉及运气，这就是我非常喜欢这个游戏的原因。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-30T22:18:09.407

与 Uplink 类似的是[HackWars](http://hackwars.net)。它不是指向和点击黑客攻击，而是多人游戏，您可以编写自己的攻击脚本。实际上有一个包含用于编写 2d/3d 游戏的运行时，并且有很多不同的地方可以挂接脚本（用于防御、银行、游戏网站等）。

脚本语言看起来类似于 Java。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2019-04-06T03:35:43.550

[爱板](https://aiBoard.blog)怎么样

*   您可以在手机/平板电脑上播放。
*   它的IDE内置在游戏中。

[![在此处输入图像描述](https://i.stack.imgur.com/K8EQX.gif)](https://i.stack.imgur.com/K8EQX.gif)

它具有内置的基于节点的可视化编程语言，其代码隐藏是一种类似 python 的语言。

[![在此处输入图像描述](https://i.stack.imgur.com/JDkvt.gif)](https://i.stack.imgur.com/JDkvt.gif)

您编写代码，驱动 Ai，移动棋子，玩游戏，所有这些仍然在您的移动设备上。

[YouTube 视频：移动设备上的可视化编程延时](https://youtu.be/DIDgu9jrdLc)

[![在此处输入图像描述](https://i.stack.imgur.com/Lm3AO.png)](https://i.stack.imgur.com/Lm3AO.png)

它附带了许多向玩家介绍编程、遗传算法等的教程，您可以逐步了解所有这些方法。

它还带有现成的脚本，开箱即用，您可以将其复制到免费的“开发”和“测试”环境中，...

...这样您就可以随心所欲地调整它们，因为您知道您可以随时恢复到原始状态。

内置的机器学习引擎允许您

*   训练您的 AiBot 玩棋盘游戏，
*   用你的 AiBot 对抗他们内置的 Ai
*   与自己的 AiBot 对战
*   培育你的 AiBot（遗传算法）
*   微调你的 AiBot（反向传播）

...调试您的 AiBot，等等。

[YouTube 视频：机器学习是移动的！](https://youtu.be/8oQmjUHGehQ)

它目前处于 BETA 测试阶段，但很快就会发布，并且所描述的一切都是免费的。

此外，还有单人和多人模式，但它主要是一个关于编码的游戏，完成了“......包括电池！”

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2009-04-30T21:02:56.013

[欧拉计划](http://projecteuler.net/)

# sql - SQL SELECT：使用子查询在三个表之间组合和分组数据

> ID：809056
> 
> 赞同：1
> 
> 时间：2009-04-30T21:01:09.513
> 
> 标签：sql, oracle, select, subquery

抱歉，这个问题很长，而且不是一个描述性很强的标题，但我的问题很难简单解释。

我有三个数据库表：

```
TABLE A:  
AID PK  
STATUS VARCHAR

TABLE B:  
BID PK  
AID FK  
CID FK

TABLE C:  
CID PK  
CREATIONTIME DATE 
```

对于表 AI 中的每个 STATUS = 'OK' 行，希望在 C 中找到具有最新创建时间的相应行。

首先，我可以从 STATUS = 'OK' 的表 A 中获取所有行。
接下来我可以从表 B 中获取所有相应的行。
但是如何从那里继续呢？

例如：

```
select AID, CID from B where AID in (select AID from A where STATUS = 'OK') 
```

可以返回类似：

```
AID, CID  
1    1  
2    2  
2    3  
3    4  
4    5  
4    6 
```

假设 CID 2 的创建时间比 CID 3 晚，CID 6 比 CID 5 新。这意味着正确的结果将是表 C 中的第 1、2、4 和 6 行。

有没有办法用查询来表达这一点？

编辑：对不起，我不够具体。我想得到的是表 C 中的 CID。

编辑：我用不同的解决方案计算了返回的行。结果非常有趣且多样化：
HAINSTECH：298 473 行
JMUCCHIELLO：298 473 行
RUSS CAM：290 121 行
CHRIS：344 093 行
暴龙：290 119 行

我还没有时间深入分析返回的行，但我真的很感激关于哪些查询被“破坏”以及原因的看法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-30T21:06:29.670

像这样，如果我理解正确的话

```
SELECT
    MAX(CREATIONTIME),
    A.AID
FROM
    A
INNER JOIN
    B
    ON 
    A.AID = B.AID
INNER JOIN
    C
    ON 
    B.CID = C.CID
WHERE
    A.STATUS = 'OK'
GROUP BY
    A.AID 
```

**编辑：**

我现在已经在 SQL Server 中检查了以下内容（我希望在 Oracle 中得到相同的结果），它返回id`CID`中相关记录`C`的最大值`CREATIONTIME`的记录。`STATUS``A``'OK'`

```
SELECT C.CID
FROM 
C C
INNER JOIN
B B
ON 
C.CID = B.CID
INNER JOIN
(
    SELECT
        MAX(C.CREATIONTIME) CREATIONTIME,
        A.AID
    FROM
        A A
    INNER JOIN
        B B
        ON 
        A.AID = B.AID
    INNER JOIN
        C C
        ON 
        B.CID = C.CID
    WHERE
        A.STATUS = 'OK'
    GROUP BY
        A.AID
) ABC
ON B.AID = ABC.AID
AND C.CREATIONTIME = ABC.CREATIONTIME 
```

用以下***T-SQL演示***

```
DECLARE @A TABLE(AID INT IDENTITY(1,1), STATUS VARCHAR(10))
DECLARE @B TABLE(BID INT IDENTITY(1,1), AID INT, CID INT)
DECLARE @C TABLE(CID INT IDENTITY(1,1), CREATIONTIME DATETIME)

INSERT INTO @A VALUES ('OK')
INSERT INTO @A VALUES ('OK')
INSERT INTO @A VALUES ('NOT OK')
INSERT INTO @A VALUES ('OK')
INSERT INTO @A VALUES ('NOT OK')

INSERT INTO @C VALUES ('10 MAR 2008')
INSERT INTO @C VALUES ('13 MAR 2008')
INSERT INTO @C VALUES ('15 MAR 2008')
INSERT INTO @C VALUES ('17 MAR 2008')
INSERT INTO @C VALUES ('21 MAR 2008')

INSERT INTO @B VALUES (1,1)
INSERT INTO @B VALUES (1,2)
INSERT INTO @B VALUES (1,3)
INSERT INTO @B VALUES (2,2)
INSERT INTO @B VALUES (2,3)
INSERT INTO @B VALUES (2,4)
INSERT INTO @B VALUES (3,3)
INSERT INTO @B VALUES (3,4)
INSERT INTO @B VALUES (3,5)
INSERT INTO @B VALUES (4,5)
INSERT INTO @B VALUES (4,1)
INSERT INTO @B VALUES (4,2)

SELECT C.CID
FROM 
@C C
INNER JOIN
@B B
ON 
C.CID = B.CID
INNER JOIN
(
SELECT
    MAX(C.CREATIONTIME) CREATIONTIME,
    A.AID
FROM
    @A A
INNER JOIN
    @B B
    ON 
    A.AID = B.AID
INNER JOIN
    @C C
    ON 
    B.CID = C.CID
WHERE
    A.STATUS = 'OK'
GROUP BY
    A.AID
) ABC
ON B.AID = ABC.AID
AND C.CREATIONTIME = ABC.CREATIONTIME 
```

结果如下

```
CID
-----------
3
4
5 
```

**编辑2：**

为了回应您对每个给出不同结果的语句的评论，我使用上面的测试数据通过 SQL Server 2005 运行了一些不同的答案（感谢您使用 Oracle）。这是结果

```
--Expected results for CIDs would be

--CID
-----------
--3
--4
--5

--As indicated in the comments next to the insert statements

DECLARE @A TABLE(AID INT IDENTITY(1,1), STATUS VARCHAR(10))
DECLARE @B TABLE(BID INT IDENTITY(1,1), AID INT, CID INT)
DECLARE @C TABLE(CID INT IDENTITY(1,1), CREATIONTIME DATETIME)

INSERT INTO @A VALUES ('OK') -- AID 1
INSERT INTO @A VALUES ('OK') -- AID 2
INSERT INTO @A VALUES ('NOT OK')
INSERT INTO @A VALUES ('OK') -- AID 4
INSERT INTO @A VALUES ('NOT OK')

INSERT INTO @C VALUES ('10 MAR 2008')
INSERT INTO @C VALUES ('13 MAR 2008')
INSERT INTO @C VALUES ('15 MAR 2008')
INSERT INTO @C VALUES ('17 MAR 2008')
INSERT INTO @C VALUES ('21 MAR 2008')

INSERT INTO @B VALUES (1,1)
INSERT INTO @B VALUES (1,2)
INSERT INTO @B VALUES (1,3) -- Will be CID 3 For AID 1
INSERT INTO @B VALUES (2,2)
INSERT INTO @B VALUES (2,3)
INSERT INTO @B VALUES (2,4) -- Will be CID 4 For AID 2
INSERT INTO @B VALUES (3,3)
INSERT INTO @B VALUES (3,4)
INSERT INTO @B VALUES (3,5)
INSERT INTO @B VALUES (4,5) -- Will be CID 5 FOR AID 4
INSERT INTO @B VALUES (4,1)
INSERT INTO @B VALUES (4,2)

-- Russ Cam
SELECT C.CID, ABC.CREATIONTIME
FROM 
@C C
INNER JOIN
@B B
ON 
C.CID = B.CID
INNER JOIN
(
SELECT
    MAX(C.CREATIONTIME) CREATIONTIME,
    A.AID
FROM
    @A A
INNER JOIN
    @B B
    ON 
    A.AID = B.AID
INNER JOIN
    @C C
    ON 
    B.CID = C.CID
WHERE
    A.STATUS = 'OK'
GROUP BY
    A.AID
) ABC
ON B.AID = ABC.AID
AND C.CREATIONTIME = ABC.CREATIONTIME

-- Tyrannosaurs
select   A.AID,  
         max(AggC.CREATIONTIME)  
from    @A A,  
         @B B,  
         (  select  C.CID,  
             max(C.CREATIONTIME) CREATIONTIME  
            from @C C  
            group by CID
          ) AggC  
where    A.AID = B.AID  
and    B.CID = AggC.CID  
and    A.Status = 'OK'  
group by A.AID

-- jmucchiello
SELECT c.cid, max(c.creationtime)
FROM @B b, @C c
WHERE b.cid = c.cid
 AND b.aid IN (SELECT a.aid FROM @A a WHERE status = 'OK')
GROUP BY c.cid

-- hainstech
SELECT agg.aid, agg.cid
FROM (
    SELECT a.aid
        ,c.cid
        ,max(c.creationtime) as maxcCreationTime
    FROM @C c INNER JOIN @B b ON b.cid = c.cid
        INNER JOIN @A a on a.aid = b.aid
    WHERE a.status = 'OK'
    GROUP BY a.aid, c.cid
) as agg

--chris
SELECT A.AID, C.CID, C.CREATIONTIME
FROM @A A, @B B, @C C
WHERE A.STATUS = 'OK'
AND A.AID = B.AID
AND B.CID = C.CID
AND C.CREATIONTIME = 
(SELECT MAX(C2.CREATIONTIME) 
FROM @C C2, @B B2 
WHERE B2.AID = A.AID
AND C2.CID = B2.CID); 
```

结果如下

```
--Russ Cam - Correct CIDs (I have added in the CREATIONTIME for reference)
CID         CREATIONTIME
----------- -----------------------
3           2008-03-15 00:00:00.000
4           2008-03-17 00:00:00.000
5           2008-03-21 00:00:00.000

--Tyrannosaurs - No CIDs in the resultset
AID         
----------- -----------------------
1           2008-03-15 00:00:00.000
2           2008-03-17 00:00:00.000
4           2008-03-21 00:00:00.000

--jmucchiello - Incorrect CIDs in the resultset
cid         
----------- -----------------------
1           2008-03-10 00:00:00.000
2           2008-03-13 00:00:00.000
3           2008-03-15 00:00:00.000
4           2008-03-17 00:00:00.000
5           2008-03-21 00:00:00.000

--hainstech - Too many CIDs in the resultset, which CID has the MAX(CREATIONTIME) for each AID?
aid         cid
----------- -----------
1           1
1           2
1           3
2           2
2           3
2           4
4           1
4           2
4           5

--chris - Correct CIDs, it is the same SQL as mine
AID         CID         CREATIONTIME
----------- ----------- -----------------------
1           3           2008-03-15 00:00:00.000
2           4           2008-03-17 00:00:00.000
4           5           2008-03-21 00:00:00.000 
```

我建议针对较少数量的记录运行每个给定的答案，以便您可以确定返回的结果集是否是预期的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-30T21:17:56.757

编辑：我之前的回答是胡说八道。现在这是一个完整的重写

这实际上是一个困扰我整个 SQL 生活的问题。我要给你的解决方案非常混乱，但它确实有效，我很感激有人说“是的，这很混乱，但这是唯一的方法”或说“不，这样做...... ”。

我认为不安来自于参加两个约会。它在这里发生的方式不是问题，因为它们将是完全匹配的（它们具有完全相同的根数据），但它仍然感觉不对......

无论如何，打破这个，你需要分两个阶段来做。

1) 首先是返回一个结果集 [AID], [earliest CreationTime] 为您提供每个 AID 的最早创建时间。

2）然后您可以使用 latestCreationTime 拉出您想要的 CID。

所以对于第 (1) 部分，我会亲自创建一个视图来做到这一点，只是为了保持整洁。它允许您在将其与其他内容合并之前测试此部分并使其正常工作。

```
create view LatestCreationTimes
as
select b.AID,
       max(c.CreationTime) LatestCreationTime
from   TableB b,
       TableC c
where  b.CID = c.CID
group by b.AID 
```

请注意，我们尚未考虑此时的状态。

然后，您需要将其加入 TableA（以获取状态）和 TableB 和 TableC（以获取 CID）。您需要完成所有明显的链接（AID、CID）并将视图中的 LatestCreationTime 列连接到 TableC 中的 CreationTime 列。也不要忘记加入 AID 视图，否则如果同时为不同的 A 记录创建了两条记录，您会遇到问题。

```
select A.AID,
       C.CID
from   TableA a,
       TableB b,
       TableC c,
       LatestCreationTimes lct
where  a.AID = b.AID
and    b.CID = c.CID
and    a.AID = lct.AID
and    c.CreationTime = lct.LatestCreationTime
and    a.STATUS = 'OK' 
```

我确信它有效 - 我已经对其进行了测试，调整了数据，重新测试了它并且它的行为。至少它做了我认为它应该做的事情。

但是，它不处理表 C 中相同记录的两个相同 CreationTimes 的可能性。我猜这不应该发生，但是除非你在某个时间写了绝对限制它需要考虑的东西。

为此，我需要假设您更喜欢哪一个。在这种情况下，我会说如果有两个匹配的 CID，您宁愿拥有更高的一个（它很可能是最新的）。

```
select A.AID,
       max(C.CID) CID
from   TableA a,
       TableB b,
       TableC c,
       LatestCreationTimes lct
where  a.AID = b.AID
and    b.CID = c.CID
and    c.CreationTime = lct.LatestCreationTime
and    a.STATUS = 'OK'
group by A.AID 
```

而且，我相信应该为你工作。如果您希望它作为一个查询而不是视图，那么：

```
select A.AID,
       max(C.CID) CID
from   TableA a,
       TableB b,
       TableC c,
       (select b.AID,
               max(c.CreationTime) LatestCreationTime
        from   TableB b,
               TableC c
        where  b.CID = c.CID
        group by b.AID) lct
where  a.AID = b.AID
and    b.CID = c.CID
and    c.CreationTime = lct.LatestCreationTime
and    a.STATUS = 'OK'
group by A.AID 
```

（我刚刚将视图嵌入到查询中，否则主体完全相同）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T07:29:44.977

```
SQL> create table a (aid,status)
  2  as
  3  select 1, 'OK' from dual union all
  4  select 2, 'OK' from dual union all
  5  select 3, 'OK' from dual union all
  6  select 4, 'OK' from dual union all
  7  select 5, 'NOK' from dual
  8  /

Tabel is aangemaakt.

SQL> create table c (cid,creationtime)
  2  as
  3  select 1, sysdate - 1 from dual union all
  4  select 2, sysdate - 2 from dual union all
  5  select 3, sysdate - 3 from dual union all
  6  select 4, sysdate - 4 from dual union all
  7  select 5, sysdate - 6 from dual union all
  8  select 6, sysdate - 5 from dual
  9  /

Tabel is aangemaakt.

SQL> create table b (bid,aid,cid)
  2  as
  3  select 1, 1, 1 from dual union all
  4  select 2, 2, 2 from dual union all
  5  select 3, 2, 3 from dual union all
  6  select 4, 3, 4 from dual union all
  7  select 5, 4, 5 from dual union all
  8  select 6, 4, 6 from dual union all
  9  select 7, 5, 6 from dual
 10  /

Tabel is aangemaakt.

SQL> select a.aid
  2       , max(c.cid) keep (dense_rank last order by c.creationtime) cid
  3       , max(c.creationtime) creationtime
  4    from a
  5       , b
  6       , c
  7   where b.aid = a.aid
  8     and b.cid = c.cid
  9     and a.status = 'OK'
 10   group by a.aid
 11  /

       AID        CID CREATIONTIME
---------- ---------- -------------------
         1          1 30-04-2009 09:26:00
         2          2 29-04-2009 09:26:00
         3          4 27-04-2009 09:26:00
         4          6 26-04-2009 09:26:00

4 rijen zijn geselecteerd. 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-02T18:04:12.337

使用所有 3 个表的连接选择您要查找的字段，然后将结果限制为 CREATIONDATE 是最近的那些。

```
SELECT A.AID, C.CID, C.CREATIONTIME
FROM A A, B B, C C
WHERE A.STATUS = 'OK'
AND A.AID = B.AID
AND B.CID = C.CID
AND C.CREATIONTIME = 
(SELECT MAX(C2.CREATIONTIME) 
FROM C C2, B B2 
WHERE B2.AID = A.AID
AND C2.CID = B2.CID); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-02T18:22:57.113

我错过了什么吗？出什么问题了：

编辑：好的，我看到你实际上想通过援助进行分组。

```
SELECT c.cid FROM b, c,
    (SELECT b.aid as aid, max(c.creationtime) as creationtime
     FROM b, c
     WHERE b.cid = c.cid
       AND b.aid IN (SELECT a.aid FROM a WHERE status = 'OK')
     GROUP BY b.aid) as z
WHERE b.cid = c.cid
  AND z.aid = b.aid
  AND z.creationtime = c.creationtime 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-02T19:01:45.540

不需要子查询，确定最新 cid 创建时间的聚合很简单：

```
SELECT a.aid
    ,c.cid
    ,max(c.creationtime) as maxcCreationTime
FROM c INNER JOIN b ON b.cid = c.cid
    INNER JOIN a on a.aid = b.aid
WHERE a.status = 'OK'
GROUP BY a.aid, c.cid 
```

如果您真的不希望行集中的创建时间，您可以将其包装在子查询中并将其从投影中删除：

```
SELECT agg.aid, agg.cid
FROM (
    SELECT a.aid
        ,c.cid
        ,max(c.creationtime) as maxcCreationTime
    FROM c INNER JOIN b ON b.cid = c.cid
        INNER JOIN a on a.aid = b.aid
    WHERE a.status = 'OK'
    GROUP BY a.aid, c.cid
) as agg 
```

在网页中编码，请原谅任何语法错误。另外，我是一个 mssql 人，所以我希望 Oracle 世界对此没有什么不同。

请注意，您提供的架构不会强制每个 cid 的 CREATIONTIME 唯一性。如果有两个 cid 值映射到具有相同创建时间的给定辅助值，则它们都将被输出。如果您依赖 cid,creationtime 对是唯一的，您应该使用约束以声明方式强制执行它。

# javascript - 如何以编程方式单击 JavaScript 中的元素？

> ID：809057
> 
> 赞同：73
> 
> 时间：2009-04-30T21:01:18.030
> 
> 标签：javascript, dom, firefox, dom-events, dhtml

在 IE 中，我只能`element.click()`从 JavaScript 调用——如何在 Firefox 中完成相同的任务？理想情况下，我希望有一些可以在跨浏览器上同样运行良好的 JavaScript，但如有必要，我将为此使用不同的每个浏览器 JavaScript。

* * *

## 回答 #1

> 赞同：94
> 
> 时间：2014-03-18T02:07:46.970

[`document.createEvent`文档](https://developer.mozilla.org/en-US/docs/Web/API/document.createEvent)说“不推荐**使用*createEvent*方法。请改用[事件构造函数](https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent)。** ”

所以你应该改用这个方法：

```
var clickEvent = new MouseEvent("click", {
    "view": window,
    "bubbles": true,
    "cancelable": false
}); 
```

并在这样的元素上触发它：

```
element.dispatchEvent(clickEvent); 
```

[如此处](https://developer.mozilla.org/en-US/docs/Web/Guide/Events/Creating_and_triggering_events#Triggering_built-in_events)所示。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-04-30T23:42:52.977

对于 Firefox 链接似乎是“特殊的”。我能够完成这项工作的唯一方法是使用[MDN 上描述](https://developer.mozilla.org/en/DOM/document.createEvent)的 createEvent 并调用 initMouseEvent 函数。即使那没有完全起作用，我不得不手动告诉浏览器打开一个链接......

```
var theEvent = document.createEvent("MouseEvent");
theEvent.initMouseEvent("click", true, true, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);
var element = document.getElementById('link');
element.dispatchEvent(theEvent);

while (element)
{
    if (element.tagName == "A" && element.href != "")
    {
        if (element.target == "_blank") { window.open(element.href, element.target); }
        else { document.location = element.href; }
        element = null;
    }
    else
    {
        element = element.parentElement;
    }
} 
```

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2009-04-30T21:10:00.910

使用[jQuery](http://www.jquery.com)你可以做同样的事情，例如：

```
$("a").click(); 
```

这将“单击”页面上的所有锚点。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-04-30T21:12:20.313

element.click() 是[W3C DOM 规范](http://www.w3.org/TR/DOM-Level-2-HTML/html.html#ID-2651361)概述的标准方法。Mozilla 的 Gecko/Firefox[遵循标准](https://developer.mozilla.org/en/DOM/element.click)，只允许在 INPUT 元素上调用此方法。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-04-30T21:13:47.283

您是在尝试实际关注链接还是触发 onclick？您可以通过以下方式触发 onclick：

```
var link = document.getElementById(linkId);
link.onclick.call(link); 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-04-30T21:27:34.363

这是一个跨浏览器工作功能（也可用于点击处理程序以外的其他）：

```
function eventFire(el, etype){
    if (el.fireEvent) {
      el.fireEvent('on' + etype);
    } else {
      var evObj = document.createEvent('Events');
      evObj.initEvent(etype, true, false);
      el.dispatchEvent(evObj);
    }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-02-20T12:29:51.883

我使用了上面列出的 KooiInc 的功能，但我必须使用两种不同的输入类型，一种用于 IE 的“按钮”，一种用于 FireFox 的“提交”。我不完全确定为什么，但它有效。

// HTML

```
<input type="button" id="btnEmailHidden" style="display:none" />
<input type="submit" id="btnEmailHidden2" style="display:none" /> 
```

// 在 JavaScript 中

```
var hiddenBtn = document.getElementById("btnEmailHidden");

if (hiddenBtn.fireEvent) {
    hiddenBtn.fireEvent('onclick');
    hiddenBtn[eType]();
}
else {
    // dispatch for firefox + others
    var evObj = document.createEvent('MouseEvent');
    evObj.initEvent(eType, true, true);
    var hiddenBtn2 = document.getElementById("btnEmailHidden2");
    hiddenBtn2.dispatchEvent(evObj);
} 
```

我已经搜索并尝试了许多建议，但这最终奏效了。如果我有更多的时间，我会想调查为什么提交与 FF 和按钮与 IE 一起工作，但现在这将是一种奢侈，等到下一个问题。

# wcf - System.ServiceModel.Security.MessageSecurityException 在 ExceptionShielding 下发生

> ID：809059
> 
> 赞同：5
> 
> 时间：2009-04-30T21:01:24.533
> 
> 标签：wcf, exception-handling, enterprise-library

我们将 Enterprise Library 4.1 异常处理应用程序块的 ExceptionShielding 功能与自定义 RoleProvider 与我们的 WCF 服务结合使用。

当 RoleProvider 确定用户不在角色中并从 IsInRole 方法返回 false 时，将发生以下异常：

```
    System.ServiceModel.Security.MessageSecurityException，System.ServiceModel，版本=3.0.0.0，文化=中性，PublicKeyToken=b77a5c561934e089
    没有为具有“{XXX}”操作的消息指定签名消息部分。

```

WCF 然后中止`RequestContext`服务操作，客户端超时。

我尝试了此链接中提到的解决方案，但没有成功：

[http://www.codeplex.com/entlib/Thread/View.aspx?ThreadId=25236](http://www.codeplex.com/entlib/Thread/View.aspx?ThreadId=25236)

我们还`System.Exception`从 EHAB 策略中删除了异常类型，实际上让 EHAB 对此策略没有任何作用，这没有任何效果。

唯一阻止此异常的方法是注释掉`ExceptionShielding`服务实现上的属性。

对此问题的任何修复将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-03-09T23:34:58.463

我花了好几个小时试图找出原因。我已经在[这里](https://stackoverflow.com/questions/3650846/using-ierrorhandler-and-tcp-message-security-causes-a-timeout/4367726#4367726)发布了我的答案。

基本上，您需要定义故障操作并将其设置为相同的命名空间。

# java - 使用 AffineTransform 缩放 Java 字体

> ID：809068
> 
> 赞同：0
> 
> 时间：2009-04-30T21:03:37.680
> 
> 标签：java

任何人都有一个示例片段显示如何使用 AffineTransform 缩放字体？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-30T21:11:53.090

好吧，你真的不需要 AffineTransform 来做一个简单的字体缩放。您可以使用[`Font.deriveFont(float size)`](http://java.sun.com/javase/6/docs/api/java/awt/Font.html#deriveFont(float))来获取具有指定大小的新字体对象。

但我想如果你愿意的话，你可以使用[`AffineTransform.getScaleInstance(double sx, double sy)`](http://java.sun.com/javase/6/docs/api/java/awt/geom/AffineTransform.html#getScaleInstance%28double,%20double%29)转换并将转换应用于你的`Graphics2D`对象（假设你有一个）。这真的取决于你在做什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T21:09:51.130

从记忆里：

```
Font tallerFont = font.deriveFont(AffineTransform.getScaleInstance(1.0, 2.0)); 
```

# c# - 需要帮助将嵌套 SQL 语句转换为 LINQ

> ID：809072
> 
> 赞同：0
> 
> 时间：2009-04-30T21:03:53.593
> 
> 标签：c#, sql, linq, linq-to-sql

我有一个与此类似的声明，我需要在 Linq 中运行。我开始使用 .Contains，并且可以让第一层工作，但似乎无法掌握我需要做什么才能获得额外的层。

这是 SQL 语句：

```
select * 
from aTable
where aTableId in
    (select aTableId from bTable
    where bTableId in 
        (select bTableId from cTable
        where cTableId in
            (select cTableId from dTable
            where dField = 'a guid'
            )
        )
    ) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-30T21:10:08.740

好吧，最简单的翻译是：

```
var query = from a in aTable
            where (from b in bTable
                   where (from c in cTable
                          where (from d in dTable
                                 where dField == "a guid"
                                 select d.cTableId)
                                .Contains(c.cTableId)
                          select c.bTableId)
                         .Contains(b.bTableId)
                   select b.aTableId)
                   .Contains(a.aTableId)
            select a; 
```

但是，连接可能会更简单：

```
var query = from a in aTable
            join b in bTable on a.aTableId equals b.aTableId
            join c in cTable on b.bTableId equals c.bTableId
            join d in dTable on c.cTableId equals d.cTableId
            where d.dField == "a guid"
            select a; 
```

我还没有检查，但我*认为*他们会做同样的事情......

# asp.net - ASP.NET：如何在*用户控件*初始加载时进行初始化

> ID：809075
> 
> 赞同：0
> 
> 时间：2009-04-30T21:04:45.587
> 
> 标签：asp.net, user-controls

我有一个嵌入到另一个用户控件中的 ASP.NET 用户控件。这工作正常。

我需要知道检测*控件*何时加载的最佳逻辑/方法。换句话说，我有一些显示初始化逻辑需要在控件最初显示时运行。这肯定有一个模式。

典型的方法是将(!IsPostBack) 逻辑放在控件的Page_Load 方法中。这很有效，直到您最终获得父页面已经多次回发的状态。我的用户控件已添加到页面，但其显示未正确初始化。

我希望找到一种将这种逻辑保留在控件中的方法，而不是在父页面的代码隐藏中进行各种黑客攻击。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-30T21:25:47.847

请参阅[以下 MS 文章](http://msdn.microsoft.com/en-us/library/system.windows.forms.usercontrol.aspx)。他们有一个示例，将多个控件放在用户控件中并对其进行初始化。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-04-30T21:24:08.053

StackOverflow 上的另一个帖子看起来很相似。您可能想[检查一下](https://stackoverflow.com/questions/243232/asp-net-usercontrol-does-not-initialize-child-controls)，看看它是否为您指明了正确的方向。

[查看页面生命周期和事件](http://john-sheehan.com/blog/wp-content/uploads/aspnet-life-cycles-events.pdf)也可能会有所帮助。

# ruby-on-rails - 如何以 RESTful 方式设计模型的不同“视图”？

> ID：809076
> 
> 赞同：0
> 
> 时间：2009-04-30T21:04:59.377
> 
> 标签：ruby-on-rails, rest

这里的“视图”是指模型属性的不同组合，而不是传统 MVC 的视图。例如，我有以下模型：

```
class Game < ActiveRecord::Base
  has_many :players
  belongs_to :status
  has_one :deck
  has_many :turns
  has_one :current_turn, :class_name => 'Turn', :conditions => ['turn_num = ?', '#{self.turn_num}']
end 
```

我`full_xml`为 Game 编写了一个用于“正常”获取操作的方法，这样我就可以包含玩家和 current_turn 的某些属性，然后我就不必一直对每个玩家进行 GET 操作。我也不想在每个 GET 中包含 Game 模型的所有属性以及子属性和子属性

但是，现在我想获取游戏历史记录，即所有回合（及其属性/子项）。最初我想到了一个没有相应表格的新模型，然后意识到这不是必需的，因为数据和关系已经存在于游戏中并转换模型。我也想过写一个新的动作，但我想我在某个地方读到过，在 RESTful 世界中，除了核心 7 之外，你不应该编写任何动作。

顺便说一句，我在这里考虑返回 xml，因为我使用的是 Flex 前端而不是 rails 视图。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T21:18:32.683

您在这里有几个选项 - 我会使用“嵌套资源”，因此您最终会得到一个 /game/:game_id/turns 路由，该路由在 Turns 控制器上调用“index”。另一种选择是创建一个 GameHistory 控制器，如果有与您的游戏历史相关的其他逻辑，这可能会很有用。

控制器和模型之间没有一一对应的关系；然而，控制器和资源之间存在一对一的对应关系。游戏历史是与游戏完全不同的资源，就像用户会话资源与实际用户资源不同（这通常用于允许 RESTful 登录和 RESTful 用户管理）希望这会有所帮助:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T18:36:56.463

是的，嵌套资源就是答案。[这个 Railscast](http://railscasts.com/episodes/139-nested-resources "这个 Railscast")很好地解释了它。我之前曾短暂尝试过嵌套资源，但无法使其正常工作。它返回**所有**子资源，而不仅仅是父资源的嵌套资源。这是因为我认为 Rails 会自动为我这样做，但事实并非如此。Railscast 解释说您仍然必须对子资源的控制器进行更改，如下所示：

```
class TurnsController < ApplicationController
  # GET /turns
  # GET /turns.xml
  def index
    @game = Game.find(params[:game_id])
    @turns = @game.turns

    respond_to do |format|
      format.html # index.html.erb
      format.xml  { render :xml => @turns.to_xml( :except => [:created_at, :updated_at] ) }
    end
  end
  ... more methods
end 
```

您还必须编辑您的 routes.rb 文件。在这种情况下，我想要玩家和游戏回合的嵌套路线，所以我这样做了：

```
map.resources :games do |game|
    game.resources :players
    game.resources :turns
end 
```

# asp.net - 根据文化显示正确的日期格式

> ID：809078
> 
> 赞同：4
> 
> 时间：2009-04-30T21:05:46.520
> 
> 标签：asp.net, javascript, culture, date-format

我正在使用弹出日历日期选择器的控件。这使用 javascript 函数 SetText 将文本框设置为给定日期。我无法更改日历控件本身的任何内容，但我可以覆盖 SetText 函数。SetText javascript 只采用字符串格式的文本框名称和日期值，并将文本框设置为字符串。

问题：我需要以“April 30”格式显示日期。

很容易做到。使用 getMonth() 和 getDate() 我可以从那里解析信息。

现在，我需要确保这对于不同的文化正确显示。例如，英国将日期显示为“4 月 30 日”。由于代码隐藏（c#）可能以英国格式发送日期，我如何在 javascript 中知道他们使用的是英国（dd/mm/yyyy）而不是美国（mm/dd/yyyy）？
浏览器导航器语言可以设置为一种设置，而服务器设置为另一种设置，从而导致 1 月 4 日与 4 月 1 日不匹配。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-07-24T02:18:54.710

您正在使用 Microsoft Ajax 框架，该框架定义了一组“[客户端类型扩展](http://msdn.microsoft.com/en-us/library/bb397506.aspx)”，它们为 JavaScript 基本类型提供了附加功能或“扩展”。

[日期类型扩展](http://msdn.microsoft.com/en-us/library/bb310850.aspx)是您正在寻找的，特别是Date.parseLocale[函数](http://msdn.microsoft.com/en-us/library/bb397521.aspx)。

使用此函数，您可以使用给定的格式解析字符串。

[您可以通过将ScriptManager.EnableScriptGlobalization](http://msdn.microsoft.com/en-us/library/system.web.ui.scriptmanager.enablescriptglobalization.aspx)属性设置为 true来同步服务器端和客户端文化，并使用 Date.parseLocale 函数而不指定任何格式。

看看这篇文章：

*   [演练：使用客户端脚本全球化日期](http://msdn.microsoft.com/en-us/library/bb386581.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-30T21:10:16.387

请参阅[toLocaleString](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/Date/toLocaleString)和相关函数。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-07-26T09:02:18.593

如果您控制后端，为什么不直接发送时间戳并将其推送到`Date`对象中呢？

至于客户端的格式化，由于我已经在使用Dojo，所以我通过使用`dojo.date.locale.format`. 这是完全无痛的。

*   语言环境是自动检测的，也可以任意设置。
*   速记格式选项（例如：long short）
*   数据选择器（例如：时间、日期）
*   能够指定任意日期/时间模式（可能不适用于此应用程序，但仍然有用）。

教程：[http](http://docs.dojocampus.org/dojo/date/locale)
://docs.dojocampus.org/dojo/date/locale API 文档： [http](http://api.dojotoolkit.org/jsdoc/1.3/dojo.date.locale.format)
://api.dojotoolkit.org/jsdoc/1.3/dojo.date.locale.format 日期格式说明：[http://www .unicode.org/reports/tr35/tr35-4.html#Date_Format_Patterns](http://www.unicode.org/reports/tr35/tr35-4.html#Date_Format_Patterns)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-05T13:19:46.350

您可以使用的三件事：

1) [toLocaleString](http://www.w3schools.com/jsref/jsref_toLocaleString.asp) - 正如已经建议的那样。问题是当发送“2009 年 4 月 1 日”的字符串时，这可能会导致几件事。1 月 4 日或 4 月 1 日。

2) navigator.language 和[navigator.systemLanguage](http://www.w3schools.com/htmldom/prop_nav_systemlanguage.asp) - 获得日期字符串后，您可以检查系统使用的语言并从那里解析日期。这个问题和解决方案 1 的问题是，如果您有一台英国服务器并且浏览器机器是美国的。您将拥有在 2009 年 1 月 4 日发送 4 月 1 日背后的代码，其中 javascript 会将字符串读取为客户端浏览器使用的任何语言。所以，英国服务器和美国浏览器会给你一个错误的结果。

3) 使用代码背后的文化 - 在您的 javascript 中创建一个变量，当页面加载时，它将在您的代码中调用一个`this.Page.Culture`从那里返回的函数，您将知道字符串被发送回的文化。这将消除前两种解决方案可能导致的不匹配。确保它正确显示需要一些额外的工作，但至少您将能够使用该字符串而不会出现文化不匹配的可能性。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-07-25T16:50:11.420

[对于您的问题， toLocaleDateString](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/Date/toLocaleDateString)将是比[toLocaleString](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/Date/toLocaleString)更好的解决方案，因为它不包括时间（因为您只请求日期）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-07-30T06:10:55.060

开源 JavaScript 库 Date.js 有一些很好的格式化日期的方法，并且它支持多种语言：

Google 代码中的 Date.js：[http ://code.google.com/p/datejs/](http://code.google.com/p/datejs/)

如果您想要格式良好的日期/时间，您只需将[格式字符串](http://code.google.com/p/datejs/wiki/FormatSpecifiers)（与 .NET Framework 中使用的字符串几乎相同）传递给任何 Date 对象的`.toString()`方法。

它还具有一整套文化，允许您简单地包含该文化的适当脚本。

如果您想自己管理它（就像我们在我们的应用程序中所做的那样），您可以找到资源，为您提供给定文化的适当资源字符串列表。这是一个显示大量文化的正确格式字符串：[http ://www.transactor.com/misc/ranges.html](http://www.transactor.com/misc/ranges.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-07-28T09:22:01.700

当您使用 ASP.NET 时，您也可能使用 ASP.NET Ajax。如果是这样，[ScriptManager](http://msdn.microsoft.com/en-us/library/system.web.ui.scriptmanager_members.aspx)上有两个对您有用的属性：

[EnableScriptLocalization](http://msdn.microsoft.com/en-us/library/system.web.ui.scriptmanager.enablescriptlocalization.aspx) - 获取或设置一个值，该值指示 ScriptManager 控件是否呈现脚本文件的本地化版本。

[EnableScriptGlobalization](http://msdn.microsoft.com/en-us/library/system.web.ui.scriptmanager.enablescriptglobalization.aspx) - 获取或设置一个值，该值指示 ScriptManager 控件是否呈现支持解析和格式化特定区域性信息的脚本。

```
<asp:ScriptManager ID="AjaxManager" runat="Server" EnablePartialRendering="true"
            EnableScriptGlobalization="true" EnableScriptLocalization="true" /> 
```

当您启用这两者（设置为 true）时，ASP.NET Ajax 扩展程序等应自动本地化为 web.config 中指定的区域性：

```
<configuration>
  <system.web>
    <globalization 
       fileEncoding="utf-8" 
       requestEncoding="utf-8" 
       responseEncoding="utf-8" 
       culture="en-GB" 
       uiCulture="en-GB" />  
  </system.web>
</configuration> 
```

例如，设置此项会将[AjaxControlToolkit 日历](http://www.asp.net/AJAX/AjaxControlToolkit/Samples/Calendar/Calendar.aspx)本地化为您的特定文化。

即使您不使用 ASP.NET Ajax，添加 ScriptManager 并启用本地化也会为您提供一个有用的 javascript 变量，该变量称为`__cultureInfo`包含本地化格式的 JSON 数组，例如货币、日期等。

```
"CalendarType":1,"Eras":[1],"TwoDigitYearMax":2029,"IsReadOnly":true},"DateSeparator":"/","FirstDayOfWeek":1,"CalendarWeekRule":0,"FullDateTimePattern":"dd MMMM yyyy HH:mm:ss","LongDatePattern":"dd MMMM yyyy","LongTimePattern":"HH:mm:ss","MonthDayPattern":"dd MMMM","PMDesignator":"PM","RFC1123Pattern":"ddd, dd MMM yyyy HH\u0027:\u0027mm\u0027:\u0027ss etc.... 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-10-14T16:40:29.797

我通过使用 Datejs 解决了这个问题

*   在 codebehind(aspx.cs) 中，我获得了员工的文化，并将适当的 js 添加到标题中

> 字符串路径 = " [http://datejs.googlecode.com/svn/trunk/build/date-](http://datejs.googlecode.com/svn/trunk/build/date-) " + GetCulture() + ".js"; Helper.AddJavaScript(this, path);

（在您的情况下，您可以从 navigator.systemLanguage （或 navigator.browserLanguge 等）获取文化，并将脚本标签添加到标头，其中 src 属性指向适当的路径）

*   在我使用的客户端

> d.toString(Date.CultureInfo.formatPatterns.shortDate)

其中 d 是任何日期对象（我尝试使用 Date.today().toShortDateString() 但它抛出异常。（CultureInfo JSON 对象的结构与函数预期的不同）。

# c# - 创建组合命令行/Windows 服务应用程序

> ID：809082
> 
> 赞同：14
> 
> 时间：2009-04-30T21:06:53.820
> 
> 标签：c#, .net, command-line, windows-services

在 C# 中设置可以从命令行运行并产生一些输出（或写入文件）的实用程序应用程序的最佳方法是什么，但它也可以作为 Windows 服务运行以在后台完成其工作（例如监视目录或其他）。

我想编写一次代码，并且能够从 PowerShell 或其他 CLI 以交互方式调用它，但同时也找到一种方法将相同的 EXE 文件安装为 Windows 服务并让它在无人值守的情况下运行。

我可以这样做吗？如果是这样：我该怎么做？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-04-30T21:13:29.327

是的你可以。

一种方法是使用命令行参数，比如“/console”，将控制台版本与作为服务运行的版本分开：

*   创建一个 Windows 控制台应用程序，然后
*   在 Program.cs 中，更准确地说，在 Main 函数中，您可以测试“/console”参数是否存在
*   如果有“/console”，正常启动程序
*   如果参数不存在，请从 ServiceBase 调用您的服务类

```
 // Class that represents the Service version of your app
public class serviceSample : ServiceBase
{
    protected override void OnStart(string[] args)
    {
        // Run the service version here 
        //  NOTE: If you're task is long running as is with most 
        //  services you should be invoking it on Worker Thread 
        //  !!! don't take too long in this function !!!
        base.OnStart(args);
    }
    protected override void OnStop()
    {
        // stop service code goes here
        base.OnStop();
    }
} 
```

...

然后在 Program.cs 中：

```
 static class Program
{
    // The main entry point for the application.
    static void Main(string[] args)
    {
        ServiceBase[] ServicesToRun;

```
 if ((args.Length > 0) && (args[0] == "/console"))
    {
        // Run the console version here
    }
    else
    {
        ServicesToRun = new ServiceBase[] { new serviceSample () };
        ServiceBase.Run(ServicesToRun);
    }
} 
```

} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-30T21:28:55.780

从设计的角度来看，实现这一点的最佳方法是在库项目中实现所有功能并围绕它构建单独的包装器项目以执行您想要的方式（即 Windows 服务、命令行程序、asp.net Web 服务, wcf 服务等)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-30T21:16:12.003

是的，它可以做到。

您的启动类必须扩展 ServiceBase。

您可以使用静态 void Main(string[] args) 启动方法来解析命令行开关以在控制台模式下运行。

就像是：

```
static void Main(string[] args)
{
   if ( args == "blah") 
   {
      MyService();
   } 
   else 
   {
      System.ServiceProcess.ServiceBase[] ServicesToRun;
      ServicesToRun = new System.ServiceProcess.ServiceBase[] { new MyService() };
      System.ServiceProcess.ServiceBase.Run(ServicesToRun);
   } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-30T21:15:58.027

Windows 服务与普通的 Windows 程序完全不同。你最好不要同时做两件事。

您是否考虑过将其改为计划任务？

[Windows 服务与计划任务](https://stackoverflow.com/questions/390307/windows-service-vs-scheduled-task)

# javascript - 表格仅在 tbody 中突出显示

> ID：809089
> 
> 赞同：1
> 
> 时间：2009-04-30T21:08:28.277
> 
> 标签：javascript, jquery, css

我有几页与每页上的几个表格有关。我有 JQUERY 在偶数线上做斑马条纹并在悬停时改变颜色。但是，它来了，它改变了 THEAD 和 TFOOT 的颜色，我不能将 css 应用到 TFOOT 来改变颜色。

这是代码

```
<script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"></script>

<script type="text/javascript">
$(document).ready(function() {
    $(function() {
        $('tr').hover(function() {
            $(this).css('background-color', '#FFFF99');
        },
        function() {
            $(this).css('background-color', '');
        });
    });
});

$(function() {
    $("table.tiger-stripe tr:odd").addClass("oddrow");
});
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-30T21:11:56.350

仅将条带化应用于表 tbody

```
$(function() { 
    $('table.tiger-stripe tbody tr').hover(
        function() { $(this).css('background-color','#FFFF99'); }, 
        function() { $(this).css('background-color', '#000000');}

    );       
    $("table.tiger-stripe tbody tr:odd").addClass("oddrow");  
 }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T21:13:14.833

请问我们可以查看您的表格代码吗？您确定 tfoot 中有不止一个 tr 行，因为 :odd 只会在交替行上触发，因此必须至少存在两行。

哦，你的意思是你*不想*触发 tfoot 吗？

在这种情况下，只需`$('tbody tr:odd')`用作您的选择器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-30T21:16:20.053

谢谢大家....

这就是代码的样子......

```
<script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js">
</script><script type="text/javascript">
$(function() {
           $('table.tiger-stripe tbody tr').hover(
                function() { $(this).css('background-    color','#FFFF99'); },
                function() { $(this).css('background-    color', '');}    );
           $("table.tiger-stripe tbody tr:nth-child(even)").addClass    ("oddrow");   });

</script> 
```

# windows-7 - Windows 7 TextureBrush..ctor() 错误

> ID：809098
> 
> 赞同：5
> 
> 时间：2009-04-30T21:10:36.743
> 
> 标签：windows-7, .net-2.0, crash

我有一个在 XP 和 Vista 上运行良好的 .NET 2.0 应用程序，但在 Windows 7 RC (x64) 上它崩溃并出现以下错误：

异常信息

* * *

异常类型：System.OutOfMemoryException 消息：内存不足。数据：System.Collections.ListDictionaryInternal TargetSite：Void .ctor（System.Drawing.Image，System.Drawing.Drawing2D.WrapMode） HelpLink：NULL 来源：System.Drawing

StackTrace 信息

* * *

在 System.Drawing.TextureBrush..ctor(Image image, WrapMode wrapMode) at System.Windows.Forms.ControlPaint.DrawBackgroundImage(Graphics g, Image backgroundImage, Color backColor, ImageLayout backgroundImageLayout, Rectangle bounds, Rectangle clipRect, Point scrollOffset, RightToLeft rightToLeft ) 在 System.Windows.Forms.Control.PaintBackground(PaintEventArgs e, Rectangle rectangle) 在 System.Windows.Forms.Control 的 System.Windows.Forms.Control.PaintBackground(PaintEventArgs e, Rectangle rectangle, Color backColor, Point scrollOffset)。 OnPaintBackground(PaintEventArgs pevent) 在 System.Windows.Forms.ScrollableControl.OnPaintBackground(PaintEventArgs e) 在 System.Windows.Forms.Control.PaintWithErrorHandling(PaintEventArgs e, Int16 层, Boolean disposeEventArgs) 在 System.Windows.Forms.Control.WmPaint( System.Windows.Forms.Control 处的消息和 m)。WndProc(Message& m) 在 System.Windows.Forms.ScrollableControl.WndProc(Message& m)

关于为什么会发生这种情况的任何想法，或者我如何围绕它进行编程？它只是绘制没有特殊背景的标准winform。

更新：我发现这只是当 BackgroundImageLayout = ImageLayout.Tile 时的问题，这也是默认设置。将其设置为缩放或居中，问题就会消失。但这很不令人满意，因为我需要它来平铺。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-07-22T15:02:41.560

我有一个类似的问题。在我的情况下，我已经处理了我从中加载图像的 MemoryStream。

```
//The following throws and OutOfMemoryException at the TextureBrush.ctor():

    /*someBytes and g declared somewhere up here*/
    Bitmap myBmp = null;
    using(MemoryStream ms = new MemoryStream(someBytes))
       myBmp = new Bitmap(ms);

    if(myBmp != null) //that's right it's not null.
       using(TextureBrush tb = new TextureBrush(myBmp)) //OutOfMemoryException thrown
          g.FillRectangle(tb,0,0,50,50);

//This code does not throw the same error:

    /*someBytes and g declared somewhere up here*/
        MemoryStream ms = new MemoryStream(someBytes);
        Bitmap myBmp = new Bitmap(ms);

        if(myBmp != null)
           using(TextureBrush tb = new TextureBrush(myBmp))
              g.FillRectangle(tb,0,0,50,50); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-12T20:30:44.490

事实证明，这个问题的解决方案与用于背景的 PNG 文件本身有关。我只是用 Paint.NET 打开它并重新保存它，然后将它放回项目中并且它工作。

不知道发生了什么变化，但它解决了问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-02-15T05:03:41.243

在调用 TextureBrush 类进行平铺之前，请不要释放 Image 或关闭获取 Image 的文件流对象。否则 TextureBrush 类将抛出 Out of Memory 异常。

所以更好的方法是通过调用TextureBrush Image来显示平铺的Image，然后在windows窗体的Paint事件中关闭filestream对象。

# .net - 插值模式.高

> ID：809099
> 
> 赞同：2
> 
> 时间：2009-04-30T21:11:07.740
> 
> 标签：.net, graphics, interpolation

我试图找出.Net（System.Drawing.Drawing2D.InterpolationMode.High）中High和HighQualityBicubic InterpolationMode之间的区别。

高是否意味着它将根据图像以及您正在使用它做什么来选择最佳算法？它只是 HighQualityBicubic 的别名吗？还有什么？

根据 MSDN 文档，

> **高**- 指定高质量插值。
> 
> **HighQualityBicubic** - 指定高质量的双三次插值。执行预过滤以确保高质量的收缩。此模式产生最高质量的转换图像。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T03:44:45.877

.NET 中有很多类似这样的看似重复的条目，尤其是 System.Drawing。我想他们在那里是为了将来可能的补充。HighQualityBicubic 特别要求 Bicubic，而 High 将使用当时最好的。

明天有人可能会发现一个超棒的调整大小算法，它会让所有其他人感到羞耻。高将允许 .NET.NEXT 使用它。

不过，只是一个理论。某处可能有文档，但现在是就寝时间；）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-28T10:23:25.803

我设置 Graphics.InterpolationMode 并为每个可能的值读回它的值。

我发现 Default 和 Low 变成了双线性，High 变成了 HighQualityBicubic。

# c# - 使用 System.Reflection.Emit 嵌套枚举

> ID：809101
> 
> 赞同：0
> 
> 时间：2009-04-30T21:11:30.347
> 
> 标签：c#, reflection, .net-3.5, reflection.emit

我想创建一个带有嵌套枚举的类。

```
public class Foo
{
    public enum Views
    {
    }
} 
```

但是 System.Reflection.Emit.TypeBuilder 类没有 DefineNestedEnum，只有 DefinedNestedType。ModuleBuilder.DefineEnum 存在，让我创建一个枚举，但我找不到让它嵌套的方法。我可以在不伪造的情况下创建一个枚举（即，使用 EnumBuilder）吗？

* * *

我将我的解决方案移至下面的答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-30T21:39:31.090

[请参阅本文](http://msdn.microsoft.com/en-us/library/system.reflection.emit.typebuilder.createtype.aspx)末尾的示例，它完全符合您的要求。（您使用具有正确参数的 DefineNestedType）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-30T22:21:39.210

将我的答案移动到这里。

* * *

我唯一能想到的是将嵌套类型定义为扩展 System.Enum 的密封类并定义具有常量值的 public|static|literal 字段。这本质上是 C# 编译器根据我通过反汇编学到的东西所做的。如果我这样做并引用程序集，Intellisense 会将其识别为枚举并且功能就像枚举一样。

* * *

这正是 MSDN 显示 Jeremy 链接的方法。

# c# - 处理州和国家（或省）：最佳实施方式

> ID：809102
> 
> 赞同：1
> 
> 时间：2009-04-30T21:11:40.440
> 
> 标签：c#, .net, vb.net

在我的职业生涯中，我已经看到人们选择处理实施州和国家数据的数十种方式（如在纽约或美国）。我见过枚举、多维数组、来自 XML 文档或数据库的数据驱动类，以及很好的老式字符串。

所以，我想知道，人们认为处理这种非常常见的实现的“最佳方式”是什么？我知道大多数答案将主要基于意见和偏好；但是，我很想听到争论，因为最近对我正在开发的应用程序的讨论导致了一场小辩论。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-30T21:19:37.643

如果您认为美国的州数不变，那么您所拥有的是一组有限的、小的、固定的值，可以很容易地与一个数字相关联。对于这种类型的数据结构，枚举非常有用。然后我的选择将是枚举，因为它们具有良好的编译时验证，并且键入类似以下内容的内容很好读。

```
var state = GetStateInfo(States.Nebraska); 
```

但是，如果您认为状态数是一个不断变化的值，那么枚举可能不是最佳选择。框架设计指南（[链接](http://msdn.microsoft.com/en-us/library/ms229058.aspx)）建议您不要对一组被认为是开放（变化）的值使用枚举。原因是如果值确实改变了，你就有可能破坏已经发布的代码。相反，我会使用静态类和字符串常量作为名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T15:06:49.277

我会选择一个标准来枚举地理区域，然后将表中的键关联起来。过去我使用过[FIPS 5-2 地方代码](http://en.wikipedia.org/wiki/FIPS_place_code)。它是联邦标准，数字和缩写是众所周知的。对于国际国家代码，我们使用[FIPS 10-4](http://en.wikipedia.org/wiki/FIPS_10-4)对位置进行编码。有一些 ISO 标准，例如 ISO 3166，可能也很吸引人，但这是更多的偏好和品味。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T00:46:02.887

如果您想要的只是一个简单的状态列表，我认为枚举或 XML 都很好。如果您有其他相关数据，例如州税率或邮政编码数据，那么我想我会将这些州存储在数据库中。

国家也一样。您可能希望根据国家/地区控制语言、货币等。如果它在数据库中，我认为这更容易处理。

# database - 如何处理大型数据集的增量负载 ssis

> ID：809119
> 
> 赞同：0
> 
> 时间：2009-04-30T21:14:07.623
> 
> 标签：database, performance, ssis, etl

我有 2 个表（约 400 万行），我必须对匹配和不匹配的记录执行插入/更新操作。我对必须用于增量负载的方法感到非常困惑。我应该使用 Lookup 组件还是新的 sql server 合并语句？会不会有太多的性能差异？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T02:36:14.223

我已经遇到过几次这个确切的问题，我总是不得不求助于通过 ETL 将完整的数据集加载到 SQLserver 中，然后使用存储的过程进行操作。在 SSIS 转换中动态更新数据的时间似乎总是太长了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T17:19:15.697

SSIS 查找具有三种缓存模式，它们是从中获得最佳性能的关键。如果您正在查看一张大表，FULL Cache 模式会占用您的大量内存并可能会影响性能。如果您的查找目标很小，请将其保存在内存中。您还必须确定您正在查找的数据是否在处理数据时发生变化。如果是，那么您不想缓存。

你能给我们更多关于你在做什么的信息，这样我就可以制定一个更准确的答案。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-05-03T01:10:11.033

过早的优化是万恶之源，我不知道 ssis，但考虑这个总是为时过早。

400 万行可能是“大”或“小”，具体取决于数据类型和您使用的硬件配置。

# ms-access - MS Access SQL 中是否有等效的 SUBSTRING 函数？

> ID：809120
> 
> 赞同：24
> 
> 时间：2009-04-30T21:14:15.270
> 
> 标签：ms-access

我想在 MS Access 查询中做这样的事情，但 SUBSTRING 是一个未定义的函数。

```
SELECT DISTINCT SUBSTRING(LastName, 1, 1)
FROM Authors; 
```

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-04-30T21:17:33.670

您可以使用 VBA 字符串函数（正如 @onedaywhen 在评论中指出的那样，它们并不是真正的 VBA 函数，而是 MS Jet 库中的等效函数。就函数签名而言，它们的调用和工作方式相同，甚至尽管不需要 MS Access 的实际*存在*才能使它们可用。）：

```
SELECT DISTINCT Left(LastName, 1)
FROM Authors;

SELECT DISTINCT Mid(LastName, 1, 1)
FROM Authors; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-30T21:19:10.607

我认为 Access 中有 MID() 和 LEFT() 和 RIGHT() 。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-08-31T14:08:35.277

我用 msaccess vba 做了很多工作。我认为您正在寻找 MID 功能

例子

```
 dim myReturn as string
    myreturn = mid("bonjour tout le monde",9,4) 
```

会给你“吹捧”的价值

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-29T05:31:24.073

我找不到添加此功能的现成模块，所以我写了一个：

在 Access 中，转到数据库工具功能区，在宏区域中单击 Visual Basic。在左上角的项目区域中，右键单击文件名并选择插入 -> 模块。在模块中粘贴：

```
Public Function Substring_Index(strWord As String, strDelim As String, intCount As Integer) As String

Substring_Index = delims

start = 0
test = ""

For i = 1 To intCount
    oldstart = start + 1
    start = InStr(oldstart, strWord, strDelim)
    Substring_Index = Mid(strWord, oldstart, start - oldstart)
Next i

End Function 
```

将模块另存为 module1（默认）。您现在可以使用如下语句：

```
SELECT Substring_Index([fieldname],",",2) FROM table 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-06-25T09:38:31.587

我使用了如下更新查询：我为我需要的字符串元素添加到我的访问表一个空列。然后我在“UpdateTo”行中用更新查询填充了新列：“Mid([TABLE].[FIELD],3,1)”，因为我需要该字段的 3 个字符。前面的答案把我带到了这里（谢谢）。

# sql - 查找嵌套集的面包屑

> ID：809124
> 
> 赞同：4
> 
> 时间：2009-04-30T21:14:56.250
> 
> 标签：sql, sql-server-2005, breadcrumbs, nested-sets, mptt

我正在使用嵌套集（又名修改的预排序树遍历）来存储组列表，并且我试图找到一种快速的方法来为所有组生成面包屑（作为字符串，而不是表格）一次。我的数据也使用邻接列表模型存储（有触发器使两者保持同步）。

例如：

```
ID   Name    ParentId  Left   Right
0    Node A  0         1      12
1    Node B  0         2      5
2    Node C  1         3      4
3    Node D  0         6      11
4    Node E  3         7      8
5    Node F  4         9      9 
```

代表树：

*   节点 A
    *   节点 B
        *   节点 C
    *   节点 D
        *   节点 E
        *   节点 F

我希望能够有一个返回表的用户定义函数：

```
ID  Breadcrumb
0   Node A
1   Node A > Node B
2   Node A > Node B > Node C
3   Node A > Node D
4   Node A > Node D > Node E
5   Node A > Node D > Node F 
```

* * *

为了使这稍微复杂一些（尽管它有点超出了问题的范围），我还有需要遵守的用户限制。例如，如果我只能访问 id=3，当我运行查询时，我应该得到：

```
ID  Breadcrumb
3   Node D
4   Node D > Node E
5   Node D > Node F 
```

我确实有一个用户定义的函数，它以用户 ID 作为参数，并返回一个表，其中包含所有有效组的 ID，只要在查询中的某个位置

```
WHERE group.id IN (SELECT id FROM dbo.getUserGroups(@userid)) 
```

它会起作用的。

* * *

我有一个现有的标量函数可以做到这一点，但它不适用于任何合理数量的组（2000 个组需要 >10 秒）。它以 groupid 和 userid 作为参数，并返回一个 nvarchar。它找到给定的组父母（1个查询来获取左/右值，另一个查询来查找父母），将列表限制为用户有权访问的组（使用与上面相同的 WHERE 子句，因此还有另一个查询），然后使用游标遍历每个组并将其附加到字符串，最后返回该值。

我需要一种可以快速运行的方法（例如<= 1s），即时运行。

这是在 SQL Server 2005 上。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2011-08-04T16:13:29.367

这是对我有用的 SQL，可以从树中的任何点获取“面包屑”路径。希望能帮助到你。

```
SELECT ancestor.id, ancestor.title, ancestor.alias 
FROM `categories` child, `categories` ancestor 
WHERE child.lft >= ancestor.lft AND child.lft <= ancestor.rgt 
AND child.id = MY_CURRENT_ID 
ORDER BY ancestor.lft 
```

凯丝

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-03-04T03:55:53.353

行。这适用于 MySQL，而不是 SQL Server 2005。它使用带有子查询的 GROUP_CONCAT。

这应该将完整的面包屑作为单列返回。

```
SELECT 
 (SELECT GROUP_CONCAT(parent.name SEPARATOR ' > ')
 FROM category parent
 WHERE node.Left >= parent.Left
 AND node.Right <= parent.Right
 ORDER BY Left
 ) as breadcrumb
FROM category node
ORDER BY Left 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-30T22:27:52.033

如果可以，请使用路径（或者我想我听说它被称为沿袭）字段，例如：

```
ID   Name    ParentId  Left   Right   Path
0    Node A  0         1      12      0,
1    Node B  0         2      5       0,1,
2    Node C  1         3      4       0,1,2,
3    Node D  0         6      11      0,3,
4    Node E  3         7      8       0,3,4,
5    Node F  4         9      9       0,3,4, 
```

要仅获取节点 D 及以后（伪代码）：

```
path = SELECT Path FROM Nodes WHERE ID = 3
SELECT * FROM Nodes WHERE Path LIKE = path + '%' 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-10-16T23:09:39.560

我修改了凯西的声明以获得每个元素的面包屑

```
SELECT
    GROUP_CONCAT(
        ancestor.name
        ORDER BY ancestor.lft ASC
        SEPARATOR ' > '
    ),
    child.*
FROM `categories` child
JOIN `categories` ancestor
ON child.lft >= ancestor.lft
AND child.lft <= ancestor.rgt
GROUP BY child.lft
ORDER BY child.lft 
```

随意添加 WHERE 条件，例如

```
 WHERE ancestor.lft BETWEEN 6 AND 11 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-08-14T20:49:14.200

我最终做的是做一个大的连接，简单地将这个表与它本身联系起来，一遍又一遍地为每个级别。

首先我用第一级组填充一个表@topLevelGroups（如果你只有一个根，你可以跳过这一步），然后用用户可以看到的组填充@userGroups。

```
SELECT groupid,
   (level1 
    + CASE WHEN level2 IS NOT NULL THEN ' > ' + level2 ELSE '' END
    + CASE WHEN level3 IS NOT NULL THEN ' > ' + level3 ELSE '' END
   )as [breadcrumb]
FROM (
  SELECT g3.*
    ,g1.name as level1
    ,g2.name as level2
    ,g3.name as level3
  FROM @topLevelGroups g1
  INNER JOIN @userGroups g2 ON g2.parentid = g1.groupid and g2.groupid <> g1.groupid
  INNER JOIN @userGroups g3 ON g3.parentid = g2.groupid 

  UNION

  SELECT g2.*
    ,g1.name as level1
    ,g2.name as level2
    ,NULL as level3
  FROM @topLevelGroups g1 
  INNER JOIN @userGroups g2 ON g2.parentid = g1.groupid and g2.groupid <> g1.groupid

  UNION

  SELECT g1.*
    ,g1.name as level1
    ,NULL as level2
    ,NULL as level3 
  FROM @topLevelGroups g1

) a
ORDER BY [breadcrumb] 
```

这是一个相当大的 hack，并且显然仅限于一定数量的级别（对于我的应用程序，我可以选择一个合理的限制），问题是支持的级别越多，它的连接数量就会成倍增加，因此要慢得多。

用代码做这件事肯定更容易，但对我来说，这并不总是一种选择——有时我需要直接从 SQL 查询中获得它。

* * *

我接受这个作为答案，因为这是我最终做的，它可能对其他人有用——但是，如果有人能想出一个更有效的方法，我会把它改给他们。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-30T22:28:54.653

没有特定于 sql server 的代码，但您只是在寻找：

SELECT * FROM table WHERE left < (currentid.left) AND right > (currentid.right)

# sql-server - DB2 中的 SQL Server 事务等价于什么？

> ID：809136
> 
> 赞同：8
> 
> 时间：2009-04-30T21:16:48.443
> 
> 标签：sql-server, db2

DB2 中以下 SQL Server 语句的等价物是什么？

*   开始交易
*   提交事务
*   回滚事务

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-09-24T15:09:41.430

答案实际上比这里指出的要复杂一些。诚然，事务是 ANSI 标准化的，DB2*可能*支持它们。

DB2 for z/OS 与其他变体（LUW、Linux-Unix-Windows 是最常见的）完全不同。冒着陷入咆哮的风险，这使得谈论 DB2 的想法几乎毫无意义。您正在谈论 IBM 数据库的某些特定变体，但在一个数据库中有效的内容在另一个数据库中可能完全无效。我将假设 OP 使用的任何风格都不是 z/OS 风格，因为`BEGIN TRANSACTION`答案已被接受。

对于那些在尝试将事务与 DB2 z/OS 一起使用时偶然发现的人，以下是概要：大型机的 DB2 没有显式事务。没有`BEGIN TRANSACTION`或任何其他类似的结构。事务是隐式开始的（通常称为文档中的一个工作单元）并显式提交或回滚（通常 - 许多 GUI 工具，如 Toad，具有自动提交功能，可以偶尔偷偷摸摸）。

从 9.1 z/OS SQL 参考手册（第 28 页；可在[http://www-01.ibm.com/support/docview.wss?uid=swg27011656#manuals](http://www-01.ibm.com/support/docview.wss?uid=swg27011656#manuals)获得）：

“一个工作单元是在一个应用程序启动时启动的。一个工作单元也是在前一个工作单元被应用程序结束之外的其他东西结束时启动的。一个工作单元是由一个提交操作结束的、完整的回滚操作或应用程序进程的结束。提交或回滚操作仅影响在其结束的工作单元内所做的数据库更改。

编写脚本时最接近的事情是手动指定保存点。

这些看起来像这样：

```
 SAVEPOINT A ON ROLLBACK RETAIN CURSORS;

 UPDATE MYTABLE SET MYCOL = 'VAL' WHERE 1;

 ROLLBACK WORK TO SAVEPOINT A; 
```

从表面上看，这些类似于显式事务，但实际上并非如此。相反，它们实际上只是单个隐式事务中的时间点。对于许多目的，它们可能就足够了，但重要的是要了解概念上的差异。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-30T23:58:50.147

请参阅[此处](https://stackoverflow.com/questions/25494089/db2-sql-script-how-to-start-a-transaction-and-rollback-on-error)了解更多信息。但基本上

```
BEGIN TRANSACTION
COMMIT TRANSACTION
ROLLBACK 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-07-18T10:14:07.327

[![在此处输入图像描述](https://i.stack.imgur.com/jmw6m.png)](https://i.stack.imgur.com/jmw6m.png)如果您使用 Intellij Idea（或其他）之类的 IDE，那么您将无法显式启动事务。换句话说，您不能在 IDE 的控制台中键入“开始事务”。

但是您可以禁用“自动提交”（稍后重新启用），然后在控制台中输入“提交”或“回滚”。

在 IDEA 中还有一个“提交”按钮和一个“回滚”按钮。有一个查看附加的屏幕转储。

# language-agnostic - Rot13 表示数字

> ID：809137
> 
> 赞同：13
> 
> 时间：2009-04-30T21:16:51.410
> 
> 标签：language-agnostic, math, encryption, function

### 编辑：现在是[http://messymatters.com/sealedbids上的主要动议博客文章](http://messymatters.com/sealedbids)

[rot13](http://rot13.com)的想法是隐藏文本，例如防止剧透。它并不意味着加密安全，而是简单地确保只有确定要阅读它的人才能阅读它。

对于涉及密封投标的应用程序，我想对数字做类似的事情。大致上，我想将我的号码发送给某人，并相信他们会选择自己的号码，不受我的影响，但是当他们准备好时，他们应该能够透露我的号码（纯粹是客户端）。他们不应要求我或任何第三方提供进一步的意见。

（补充：请注意接受者被信任不会作弊的假设。）

它不像 rot13 那样简单，因为某些数字，比如 1 和 2，会经常出现，以至于你可能会记得，比如 34.2 确实是 1。

这是我正在寻找的具体内容：

将实数映射到实数（或字符串）的函数 seal()。它不应该*是*确定性的—— seal(7) 不应该每次都映射到同一个东西。但是相应的函数 unseal() 应该是确定性的—— unseal(seal(x)) 应该等于所有 x 的 x。我不希望 seal 或 unseal 调用任何 web 服务甚至获取系统时间（因为我不想假设同步时钟）。（补充：可以假设所有出价都低于某个最大值，每个人都知道，比如一百万。）

完整性检查：

```
> seal(7)
482.2382   # some random-seeming number or string.
> seal(7)
71.9217    # a completely different random-seeming number or string.
> unseal(seal(7))
7          # we always recover the original number by unsealing. 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-30T21:57:04.790

您可以将您的数字打包为 4 字节浮点数和另一个随机浮点数，然后发送。然后客户端只需要获取前四个字节。在蟒蛇中：

```
import struct, random
def seal(f):
   return struct.unpack("d",struct.pack("ff", f, random.random() ))[0]
def unseal(f):
   return struct.unpack("ff",struct.pack("d", f))[0]

>>> unseal( seal( 3))
3.0
>>> seal(3)
4.4533985422978706e-009
>>> seal(3)
9.0767582382536571e-010 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-01T15:23:46.443

这是一个受 Svante 回答启发的解决方案。

```
M = 9999  # Upper bound on bid.
seal(x) = M * randInt(9,99) + x
unseal(x) = x % M 
```

完整性检查：

```
> seal(7)
716017
> seal(7)
518497
> unseal(seal(7))
7 
```

这需要调整以允许负出价：

```
M = 9999  # Numbers between -M/2 and M/2 can be sealed.
seal(x) = M * randInt(9,99) + x
unseal(x) = 
  m = x % M; 
  if m > M/2 return m - M else return m 
```

这个解决方案的一个好处是接收者解码是多么微不足道——只需 9999 的 mod（如果是 5000 或更多，那么它是一个负出价，所以再减去 9999）。隐藏的出价最多为 6 位数，这也很好。（这对于我的想法来说是足够的安全性——如果出价可能超过 5000 美元，那么我会使用更安全的方法。当然，这种方法中的最高出价可以设置为你想要的最高值。）

### 平信徒须知

选择一个 9 到 99 之间的数字并乘以 9999，然后加上您的出价。这将产生一个 5 或 6 位数字，用于对您的出价进行编码。要打开它，除以 9999，减去小数点左边的部分，然后乘以 9999。（这被儿童和数学家称为“除以 9999 时求余数”或“除以 9999” ， 分别。）

这适用于小于 9999 的非负出价（如果这还不够，请使用 99999 或任意数量的数字）。如果您想允许负出价，那么神奇的 9999 数字需要是最大可能出价的两倍。并且在解码时，如果结果大于9999的一半，即5000或更多，则减去9999得到实际（负）出价。

再次请注意，这是在荣誉系统中：技术上没有什么可以阻止您在看到对方的号码时立即打开它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-30T21:24:53.900

您想要做的（[承诺方案](http://en.wikipedia.org/wiki/Commitment_scheme "承诺方案")）不可能仅在客户端进行。您能做的最好的事情就是使用共享密钥进行加密。

如果客户不需要你的合作来显示号码，他们可以修改程序来显示号码。您还不如只是发送它而不显示它。

要正确执行此操作，您可以发送出价的安全哈希 + 随机盐。这会让你承诺你的出价。其他客户可以以同样的方式承诺他们的出价。然后你们每个人分享你的出价和盐。

[编辑] 由于您信任其他客户：

```
Sender:
Let M be your message
K = random 4-byte key
C1 = M xor hash(K) //hash optional: hides patterns in M xor K
//(you can repeat or truncate hash(K) as necessary to cover the message)
//(could also xor with output of a PRNG instead)
C2 = K append M //they need to know K to reveal the message
send C2 //(convert bytes to hex representation if needed)

Receiver:
receive C2
K = C2[:4]
C1 = C2[4:]
M = C1 xor hash(K) 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-30T21:49:48.897

如果您依赖用户的诚实并且只处理整数出价，那么您只需要一个带有随机数的简单 XOR 操作，C# 中的一个示例：

```
static Random rng = new Random();

static string EncodeBid(int bid)
{
    int i = rng.Next();
    return String.Format("{0}:{1}", i, bid ^ i);
}

static int DecodeBid(string encodedBid)
{
    string[] d = encodedBid.Split(":".ToCharArray());
    return Convert.ToInt32(d[0]) ^ Convert.ToInt32(d[1]);
} 
```

采用：

```
int bid = 500;
string encodedBid = EncodeBid(bid); // encodedBid is something like 54017514:4017054 and will be different each time
int decodedBid = DecodeBid(encodedBid); // decodedBid is 500 
```

将解码过程转换为客户端构造应该足够简单。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-30T21:49:53.793

有最高出价吗？如果是这样，你可以这样做：

设为`max-bid`最高出价和`a-bid`您要编码的出价。乘以`max-bid`一个相当大的随机数（如果你想在最后一步使用 base64 编码，`max-rand`应该是`(2^24/max-bid)-1`，`min-rand`也许是一半），然后加上`a-bid`. 对此进行编码，例如通过`base64`.

然后接收者只需解码并找到余数模`max-bid`。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-30T21:24:23.950

您是否知道如果您希望它起作用，您需要比原来更大的“密封”数字集？

所以你需要以某种方式限制你的真实数字，或者存储你没有显示的额外信息。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-30T21:25:31.870

一种简单的方法是编写如下消息：

“我的出价是：14.23 美元：aduigfurjwjnfdjfugfojdjkdskdfdhfddfuiodrnfnghfifyis”

所有这些垃圾都是随机生成的，并且每次都不同。

向对方发送消息的 SHA256 哈希。让他们向您发送他们出价的哈希值。然后，一旦你们都有哈希值，发送完整的消息，并确认他们的出价对应于他们给你的哈希值。

这提供了比您需要的更强有力的保证——在您向他们发送完整信息之前，他们实际上不可能计算出您的出价。但是，没有您描述的 unseal() 函数。

这个简单的方案具有完全零知识方案所没有的各种弱点。例如，如果他们通过向您发送随机数而不是散列来欺骗您，那么他们可以在不透露自己的情况下计算出您的出价。但你没有要求防弹。这可以防止意外和（我认为）无法检测到的作弊，并且只使用一个常用的命令行实用程序，加上一个随机数生成器（骰子就可以）。

如果，如您所说，您希望他们能够在没有您进一步输入的情况下恢复您的出价，并且您愿意相信他们只会在发布出价后才这样做，那么只需使用任何旧的对称密码 ( `gpg --symmetric`，也许) 和键“rot13”。这将防止意外作弊，但允许无法察觉的作弊。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-30T21:25:17.020

由于您似乎假设其他人在他们提出自己的出价之前*不想知道您的出价，并且可以相信不会作弊，您可以尝试可变轮换方案：*

```
from random import randint

def seal(input):
    r = randint(0, 50)
    obfuscate = [str(r)] + [ str(ord(c) + r) for c in '%s' % input ]
    return ':'.join(obfuscate)

def unseal(input):
    tmp = input.split(':')
    r = int(tmp.pop(0))
    deobfuscate = [ chr(int(c) - r) for c in tmp ]
    return ''.join(deobfuscate)

# I suppose you would put your bid in here, for 100 dollars
tmp = seal('$100.00') # --> '1:37:50:49:49:47:49:49' (output varies)
print unseal(tmp) # --> '$100.00' 
```

在某些时候（我想我们可能已经通过了）这会变得很愚蠢，因为它非常简单，你应该只使用简单的加密，消息接收者总是知道密钥——也许是这个人的用户名。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-30T22:12:18.017

我脑海中浮现的一个想法是，您的算法可能基于用于安全密钥共享的数学。

如果你想给两个人，鲍勃和爱丽丝，每人半把钥匙，这样只有当他们结合在一起时，他们才能打开任何钥匙锁，你怎么做？解决这个问题的方法来自数学。假设您在 ax/y 坐标系中有两个点 A (-2,2) 和 B (2,0)。

```
 |
       A       +
               |
               C
               |
---+---+---+---|---+---B---+---+---+---
               |
               +
               |
               + 
```

如果你在它们之间画一条直线，它将恰好在一个点 C (0,1) 处穿过 y 轴。如果你只知道 A 点或 B 点之一，就不可能知道它会在哪里交叉。因此，您可以让点 A 和 B 成为共享键，当它们组合时将显示交叉点的 y 值（即本例中的 1），然后该值通常用作某物的真实键。

对于您的投标应用程序，您可以让 seal() 和 unseal() 交换 C 点和 B 点之间的 y 值（确定性），但 A 点会不时变化。

这种方式 seal(y-value of point B) 将根据 A 点给出完全不同的结果，但 unseal(seal(y-value of point B)) 应该返回 B 的 y-value，这正是您所要求的。

PS 不需要将 A 和 B 放在 y 轴的不同侧，但从概念上来说，以这种方式考虑它要简单得多（我也建议以这种方式实现它）。

使用这条直线，您可以在几个人之间共享密钥，这样只需其中两个人就可以解锁任何东西。可以使用直线以外的曲线类型来创建其他密钥共享属性（即需要 3 个密钥中的 3 个等）。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-01T03:27:24.357

伪代码：

编码：

```
value = 2000
key = random(0..255); // our key is only 2 bytes

// 'sealing it'
value = value XOR 2000;

// add key
sealed = (value << 16) | key 
```

解码：

```
key = sealed & 0xFF
unsealed = key XOR (sealed >> 16) 
```

那行得通吗？

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-30T21:21:39.027

如果出价是相当大的数字，那么与一些预定的随机数进行按位异或怎么样？然后再次异或将检索原始值。
只要客户端和服务器都知道，您可以随意更改数字。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-30T21:23:46.977

您可以设置不同的基数（例如 16、17、18 等），并跟踪您使用哪个基数“密封”出价...

当然，这是假设大量数字（> 至少您正在使用的基数）。如果它们是十进制，您可以删除该点（例如，27.04 变为 2704，然后您将其转换为基数 29...）

您可能希望使用基数 17 到 36（只是因为有些人可能会识别十六进制并能够在他们的脑海中翻译它......）

这样，您将拥有 G4 或 Z3 或 KW 之类的数字（取决于您要密封的数字）...

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-04-30T21:24:32.747

这是一种搭载 rot13 的廉价方法：

假设我们有一个生成类似“fdjk alqef lwwqisvz”的函数 gibberish() 和一个将数字 x 转换为单词的函数 words(x)，例如 words(42) 返回“四十二”（没有连字符）。

然后定义

```
seal(x) = rot13(gibberish() + words(x) + gibberish()) 
```

和

```
unseal(x) = rot13(x) 
```

当然 unseal 的输出不是一个实际的数字，只对人类有用，但这可能没问题。您可以使用 word-to-number 函数让它变得更复杂一些，它也会丢弃所有乱码（定义为任何不是数字词之一的东西——我认为少于一百个） .

完整性检查：

```
> seal(7)
fhrlls hqufw huqfha frira afsb ht ahuqw ajaijzji
> seal(7)
qbua adfshua hqgya ubiwi ahp wqwia qhu frira wge
> unseal(seal(7))
sueyyf udhsj seven ahkua snsfo ug nuhdj nwnvwmwv 
```

我知道这很愚蠢，但如果您只有 rot13 可用，这是一种“手动”操作的方法。

# java - 从 Scala 文件创建 jar 文件

> ID：809138
> 
> 赞同：50
> 
> 时间：2009-04-30T21:16:55.450
> 
> 标签：java, scala, jar

我是 Scala 新手，不懂 Java。我想用一个简单的 Scala 文件创建一个 jar 文件。于是我有了我的HelloWorld.scala，生成了一个HelloWorld.jar。

清单.mf：

```
Main-Class: HelloWorld 
```

在我运行的控制台中：

```
fsc HelloWorld.scala
jar -cvfm HelloWorld.jar Manifest.mf HelloWorld\$.class HelloWorld.class
java -jar HelloWorld.jar 
  => "Exception in thread "main" java.lang.NoClassDefFoundError: HelloWorld/jar"

java -cp HelloWorld.jar HelloWorld 
  => Exception in thread "main" java.lang.NoClassDefFoundError: scala/ScalaObject
    at java.lang.ClassLoader.defineClass1(Native Method)
    at java.lang.ClassLoader.defineClass(ClassLoader.java:675)
    at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:124)
    at java.net.URLClassLoader.defineClass(URLClassLoader.java:260)
    at java.net.URLClassLoader.access$100(URLClassLoader.java:56)
    at java.net.URLClassLoader$1.run(URLClassLoader.java:195)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:188)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:316)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:280)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:251)
    at java.lang.ClassLoader.loadClassInternal(ClassLoader.java:374)
    at hoppity.main(HelloWorld.scala) 
```

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-04-30T22:31:11.450

示例目录结构：

```
X:\scala\bin
X:\scala\build.bat
X:\scala\MANIFEST.MF
X:\scala\src
X:\scala\src\foo
X:\scala\src\foo\HelloWorld.scala 
```

HelloWorld.scala：

```
//file: foo/HelloWorld.scala
package foo {
  object HelloWorld {
    def main(args: Array[String]) {
      println("Hello, world!")
    }
  }
} 
```

清单.MF：

```
Main-Class: foo.HelloWorld
Class-Path: scala-library.jar 
```

构建.bat：

```
@ECHO OFF

IF EXIST hellow.jar DEL hellow.jar
IF NOT EXIST scala-library.jar COPY %SCALA_HOME%\lib\scala-library.jar .

CALL scalac -sourcepath src -d bin src\foo\HelloWorld.scala

CD bin
jar -cfm ..\hellow.jar ..\MANIFEST.MF *.*
CD ..

java -jar hellow.jar 
```

* * *

为了成功使用*-jar*开关，您需要*META-INF/MANIFEST.MF*文件中的两个条目：主类；任何依赖项的相对 URL。文档说明：

> **-罐**
> 
> 执行封装在 JAR 文件中的程序。第一个参数是 JAR 文件的名称，而不是启动类名称。为了使此选项起作用，JAR 文件的清单必须包含格式为 Main-Class: classname 的行。在这里，classname 标识具有用作应用程序起点的 public static void main(String[] args) 方法的类。有关使用 Jar 文件和 Jar 文件清单的信息，请参阅 Jar 工具参考页面和 Java 教程的 Jar 跟踪。
> 
> 使用此选项时，JAR 文件是所有用户类的来源， **其他用户类路径设置将被忽略。**

*   [java命令行用法](http://java.sun.com/javase/6/docs/technotes/tools/windows/java.html)
*   [清单规格](http://java.sun.com/javase/6/docs/technotes/guides/jar/jar.html#JAR%20Manifest)

*（注意：大多数 ZIP 应用程序都可以检查 JAR 文件；我可能忽略了批处理脚本中目录名中的空格处理；Scala 代码运行器版本 2.7.4.final。）*

* * *

为了完整起见，一个等效的 bash 脚本：

```
#!/bin/bash

if [ ! $SCALA_HOME ]
then
    echo ERROR: set a SCALA_HOME environment variable
    exit
fi

if [ ! -f scala-library.jar ]
then
    cp $SCALA_HOME/lib/scala-library.jar .
fi

scalac -sourcepath src -d bin src/foo/HelloWorld.scala

cd bin
jar -cfm ../hellow.jar ../MANIFEST.MF *
cd ..

java -jar hellow.jar 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-30T22:20:48.137

因为 Scala 脚本需要安装 Scala 库，所以您必须在 JAR 中包含 Scala 运行时。

有很多策略可以做到这一点，例如[jar jar](http://code.google.com/p/jarjar/)，但最终您看到的问题是您启动的 Java 进程找不到 Scala JAR。

对于一个简单的独立脚本，我建议使用 jar jar，否则你应该开始寻找依赖管理工具，或者要求用户*在 JDK*中安装 Scala 。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-12-29T13:49:36.903

我最终使用了[sbt assembly](https://github.com/sbt/sbt-assembly)，它使用起来非常简单。`assembly.sbt`我在项目的根目录中添加了一个名为`project/`单行的文件（请注意，您的版本可能需要更改）。

```
addSbtPlugin("com.eed3si9n" % "sbt-assembly" % "0.11.2") 
```

然后只需在以下位置运行`assembly`任务`sbt`：

```
> assembly 
```

或者只是项目根目录中的“sbt 程序集”

```
$ sbt assembly 
```

它将首先运行您的测试，然后将新的 jar 生成到`target/`目录中（假设我`build.sbt`已经列出了所有依赖项）。

就我而言，我只是使该`.jar`文件可执行，重命名以删除扩展名，然后就可以发货了！

此外，如果您正在使用命令行工具，请不要忘记添加[手册页](http://asciidoctor.org/docs/what-is-asciidoc/)（我讨厌没有适当手册页或带有多页纯文本文档的脚本，这些文档甚至没有通过管道传输到您的寻呼机中）。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-03-09T21:19:40.027

您还可以使用 maven 和 maven-scala-plugin。一旦你设置了 maven，你可以只做 mvn package，它会为你创建你的 jar。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-11-25T16:02:47.770

我试图重现 MyDowell 的方法。最后我可以让它工作。但是，我发现答案虽然正确，但对于新手来说有点过于复杂（特别是目录结构过于复杂）。

我可以用非常简单的方法重现这个结果。一开始只有一个目录，其中包含三个文件：

```
helloworld.scala
MANIFEST.MF
scala-library.jar 
```

helloworld.scala

```
object HelloWorld
{
  def main(args: Array[String])
  {
    println("Hello, world!")
  }
} 
```

清单.MF：

```
Main-Class: HelloWorld
Class-Path: scala-library.jar 
```

首先编译helloworld.scala：

```
scalac helloworld.scala 
```

然后创建罐子：

```
\progra~1\java\jdk18~1.0_4\bin\jar -cfm helloworld.jar MANIFEST.MF . 
```

现在你可以运行它：

```
java -jar helloworld.jar 
```

我找到了这个简单的解决方案，因为原来的解决方案不起作用。后来我发现不是因为它错了，而是因为一个小错误：如果我没有用换行符关闭 MANIFEST.MF 中的第二行，那么这行将被忽略。这花了我一个小时才找到，我之前尝试了所有其他的东西，在这个过程中找到了这个非常简单的解决方案。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-04-22T08:48:46.123

我不想写为什么和如何，而只是展示在我的案例中有效的解决方案（通过 Linux Ubuntu 命令行）：

1)

```
mkdir scala-jar-example
cd scala-jar-example 
```

2)

```
nano Hello.scala
object Hello extends App   {  println("Hello, world")   } 
```

3)

```
nano build.sbt
import AssemblyKeys._

assemblySettings

name := "MyProject"

version := "1.0"

scalaVersion := "2.11.0" 
```

3)

```
mkdir project
cd project 
nano plugins.sbt
addSbtPlugin("com.eed3si9n" % "sbt-assembly" % "0.9.1") 
```

4)

```
cd ../   
sbt assembly 
```

5)

```
java -jar target/target/scala-2.11/MyProject-assembly-1.0.jar
>> Hello, world 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-03-25T17:34:23.820

我修改了 bash 脚本，添加了一些智能，包括自动清单生成。

此脚本假定主对象的名称与其所在的文件相同（区分大小写）。此外，当前目录名称必须等于主对象名称，或者主对象名称应作为命令行参数提供。从项目的根目录启动此脚本。根据需要修改顶部的变量。

请注意，该脚本将生成 bin 和 dist 文件夹，并将删除 bin 中的所有现有内容。

```
 #!/bin/bash

SC_DIST_PATH=dist
SC_SRC_PATH=src
SC_BIN_PATH=bin
SC_INCLUDE_LIB_JAR=scala-library.jar
SC_MANIFEST_PATH=MANIFEST.MF
SC_STARTING_PATH=$(pwd)

if [[ ! $SCALA_HOME ]] ; then
    echo "ERROR: set a SCALA_HOME environment variable"
    exit 1
fi

if [[ ! -f $SCALA_HOME/lib/$SC_INCLUDE_LIB_JAR ]] ; then
    echo "ERROR: Cannot find Scala Libraries!"
    exit 1
fi

if [[ -z "$1" ]] ; then
    SC_APP=$(basename $SC_STARTING_PATH)
else
    SC_APP=$1
fi

[[ ! -d $SC_DIST_PATH ]] && mkdir $SC_DIST_PATH

if [[ ! -d $SC_BIN_PATH ]] ; then
    mkdir "$SC_BIN_PATH"
else
    rm -r "$SC_BIN_PATH"
    if [[ -d $SC_BIN_PATH ]] ; then
        echo "ERROR:  Cannot remove temp compile directory:  $SC_BIN_PATH"
        exit 1
    fi
    mkdir "$SC_BIN_PATH"
fi

if [[ ! -d $SC_SRC_PATH ]] || [[ ! -d $SC_DIST_PATH ]] || [[ ! -d $SC_BIN_PATH ]] ; then
    echo "ERROR: Directory not found!:  $SC_SRC_PATH or $SC_DIST_PATH or $SC_BIN_PATH"
    exit 1
fi

if [[ ! -f $SC_DIST_PATH/$SC_INCLUDE_LIB_JAR ]] ; then
    cp "$SCALA_HOME/lib/$SC_INCLUDE_LIB_JAR" "$SC_DIST_PATH"
fi

SCALA_MAIN=$(find ./$SC_SRC_PATH -name "$SC_APP.scala")
COMPILE_STATUS=$?
SCALA_MAIN_COUNT=$(echo "$SCALA_MAIN" | wc -l)

if [[ $SCALA_MAIN_COUNT != "1" ]] || [[ ! $COMPILE_STATUS == 0 ]] ; then
    echo "Main source file not found or too many exist!:  $SC_APP.scala"
    exit 1
fi

if [[ -f $SC_DIST_PATH/$SC_APP.jar ]] ; then
    rm "$SC_DIST_PATH/$SC_APP.jar"  
    if [[ -f $SC_DIST_PATH/$SC_APP.jar ]] ; then
        echo "Unable to remove existing distribution!:  $SC_DIST_PATH/$SC_APP.jar"
        exit 1
    fi
fi

if [[ ! -f $SC_MANIFEST_PATH ]] ; then
    LEN_BASE=$(echo $(( $(echo "./$SC_SRC_PATH" |wc -c) - 0 )))
    SC_MAIN_CLASS=$(echo $SCALA_MAIN |cut --complement -c1-$LEN_BASE)
    SC_MAIN_CLASS=${SC_MAIN_CLASS%%.*}
    SC_MAIN_CLASS=$(echo $SC_MAIN_CLASS |awk '{gsub( "/", "'"."'"); print}')

    echo $(echo "Main-Class: "$SC_MAIN_CLASS) > $SC_MANIFEST_PATH
    echo $(echo "Class-Path: "$SC_INCLUDE_LIB_JAR) >> $SC_MANIFEST_PATH
fi

scalac -sourcepath $SC_SRC_PATH -d $SC_BIN_PATH $SCALA_MAIN
COMPILE_STATUS=$?

if [[ $COMPILE_STATUS != "0" ]] ; then
    echo "Compile Failed!"
    exit 1
fi

cd "$SC_BIN_PATH"
jar -cfm ../$SC_DIST_PATH/$SC_APP.jar ../$SC_MANIFEST_PATH *
COMPILE_STATUS=$?
cd "$SC_STARTING_PATH"

if  [[ $COMPILE_STATUS != "0" ]] || [[ ! -f $SC_DIST_PATH/$SC_APP.jar ]] ; then
    echo "JAR Build Failed!"
    exit 1
fi

echo " "
echo "BUILD COMPLETE!... TO LAUNCH:  java -jar $SC_DIST_PATH/$SC_APP.jar"
echo " " 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-07-27T08:52:27.643

可能导致类似问题的一件事（尽管这不是上面最初问题中的问题）是 Java vm 似乎要求 main 方法返回`void`. 在 Scala 中，我们可以这样写（*观察 main 定义中的 =-符号*）：

```
object MainProgram {

  def main(args: Array[String]) = {
    new GUI(args)
  }
} 
```

其中 main 实际上返回一个`GUI`-object （即它不是`void`），但是当我们使用 scala 命令启动它时，程序会很好地运行。

如果我们将这段代码打包成一个 jar 文件，`MainProgram`作为 Main-Class，Java vm 会抱怨没有 main 函数，因为我们的 main 的返回类型不是`void`（我觉得这个抱怨有点奇怪，因为返回类型不是签名的一部分）。

如果我们在 main 的头文件中省略了 =- 符号，或者我们将它显式声明为`Unit`.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-12-15T20:38:35.037

如果你不想使用 sbt 工具，我推荐使用 makefile。

这是一个将**foo**包替换为**foo.bar.myApp**以确保完整性的示例。

生成文件

```
NAME=HelloWorld
JARNAME=helloworld

PACKAGE=foo.bar.myApp
PATHPACK=$(subst .,/,$(PACKAGE))

.DUMMY: default
default: $(NAME)

.DUMMY: help
help:
    @echo "make [$(NAME)]"
    @echo "make [jar|runJar]"
    @echo "make [clean|distClean|cleanAllJars|cleanScalaJar|cleanAppJar]"

.PRECIOUS: bin/$(PATHPACK)/%.class

bin/$(PATHPACK)/%.class: src/$(PATHPACK)/%.scala
    scalac -sourcepath src -d bin $<

scala-library.jar:
    cp $(SCALA_HOME)/lib/scala-library.jar .

.DUMMY: runjar
runJar: jar
    java -jar $(JARNAME).jar

.DUMMY: jar
jar: $(JARNAME).jar

MANIFEST.MF:
    @echo "Main-Class: $(PACKAGE).$(NAME)" > $@
    @echo "Class-Path: scala-library.jar" >> $@

$(JARNAME).jar: scala-library.jar bin/$(PATHPACK)/$(NAME).class \
                                MANIFEST.MF
    (cd bin && jar -cfm ../$(JARNAME).jar ../MANIFEST.MF *)

%: bin/$(PATHPACK)/%.class
    scala -cp bin $(PACKAGE).$@

.DUMMY: clean
clean:
    rm -R -f bin/* MANIFEST.MF

cleanAppJar:
    rm -f $(JARNAME).jar

cleanScalaJar:
    rm -f scala-library.jar

cleanAllJars: cleanAppJar cleanScalaJar

distClean cleanDist: clean cleanAllJars 
```

# dependencies - 无法加载文件或程序集“someProject”或其依赖项之一。访问被拒绝

> ID：809144
> 
> 赞同：18
> 
> 时间：2009-04-30T21:18:44.430
> 
> 标签：dependencies, assemblies

我遇到了一个 asp.net 错误。我的应用程序在开发和测试环境中运行良好。但是在生产中它给了我以下错误：

> 无法加载文件或程序集“someProject”或其依赖项之一。访问被拒绝。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-30T21:52:45.660

转到 Sysinternals 并下载进程监视器：[http ://technet.microsoft.com/en-us/sysinternals/bb896645.aspx](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)

然后启动它，过滤掉线程和注册表操作。清除内容。运行您的应用程序并获取错误，然后在进程监视器中停止收集。现在搜索 ACCESS DENIED 状态，您将能够看到导致问题的确切文件，以及试图获得访问权限的用户帐户。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-05-05T15:13:01.570

只需删除 bin 文件夹，然后再复制它。现在，它正在工作...

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-10-19T15:12:57.753

在

> C:\Windows\Microsoft.NET\Framework\v4.0.30319\Temporary ASP.NET 文件

如果不是 .net 4.0，请使用您的目标 .net 版本号而不是 v4.0.30319。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-06-08T18:03:29.820

将一个新的 Web API 项目部署到我们的网络场后，我们的一个网络服务器出现故障并给出错误：

`Could not load file or assembly 'Microsoft.CodeDom.Providers.DotNetCompilerPlatform, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35' or one of its dependencies. Access is denied.`

事实证明，托管 Web API 站点的文件夹缺少**`IIS_IUSRS`**. 添加具有 、 和 权限的用户`Read`解决`Read & execute`了`List folder contents`该问题。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-06-20T11:32:54.260

在我的情况下，通过将应用程序池标识从**applicationpoolidentity**更改为**网络服务**，它可以工作，希望这会对您有所帮助。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-30T21:22:37.340

检查服务器用户是否有权访问程序集所在的目录。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-30T21:22:41.690

听起来像是一个错误配置的服务器。

首先，验证程序集确实存在。

其次，验证您的工作进程帐户是否有权访问它。

# mysql - COUNT(*) 和 LEFT JOIN

> ID：809148
> 
> 赞同：1
> 
> 时间：2009-04-30T21:20:08.017
> 
> 标签：mysql

这个查询：

```
SELECT staff.staff_id, COUNT(references_table.staff_id) 
FROM staff 
LEFT JOIN references_table USING (staff_id) 
```

返回这个：

```
staff_id    COUNT(references_table.staff_id)
1            2 
```

我怎样才能让它返回 0 作为`staff_ids`没有任何引用的计数？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-30T21:23:36.917

一个`GROUP BY`子句就可以了

```
SELECT staff.staff_id, COUNT(references_table.staff_id) 
FROM staff 
LEFT JOIN references_table USING (staff_id)
GROUP BY staff.staff_id 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-30T21:21:11.477

尝试左外连接。

# apache-flex - 基于 Flex 的 UML 设计器

> ID：809155
> 
> 赞同：2
> 
> 时间：2009-04-30T21:21:52.800
> 
> 标签：apache-flex, uml

有谁知道任何基于 flex（最好是开源）的框架或组件来编辑 UML？我一直在寻找类似 gliffy.com 的东西，但是它不允许您导出到 XMI 文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-03-31T15:32:36.780

我们将很快发布[UML4AS - 用于 ActionScript 和 Flex 的 UML](http://www.uml4as.com)。它支持 .as 和 .mxml 文件的双向代码同步。

它目前没有导出到 XMI 选项。您可以将其作为我们网站上的新功能来请求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T21:38:09.190

这是支持 XML 导出选项的开源 UML 工具之一。 [看看这个](http://bouml.free.fr/features.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T21:50:53.663

在我看来，没有基于 Flex 的开源 UML 工具。我认为你应该在此基础上向公众开放。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T21:51:37.237

经过几天的谷歌搜索，看起来我正在寻找的东西不存在。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-11-13T14:14:15.670

查看[适用于 Flex 和 AS 的 CrocusModeller - UML](http://crocusmodeller.com)。

# .net - 120 MB CSV 文件的 String.Split() 上的 .NET System.OutOfMemoryException

> ID：809156
> 
> 赞同：6
> 
> 时间：2009-04-30T21:22:18.870
> 
> 标签：.net, csv, split, out-of-memory

我正在使用 C# 读取 ~120 MB 纯文本 CSV 文件。最初我通过逐行读取来进行解析，但最近确定首先将整个文件内容读入内存要快几倍。解析已经很慢了，因为 CSV 在引号内嵌入了逗号，这意味着我必须使用正则表达式拆分。这是我发现的唯一一个可靠的工作：

```
string[] fields = Regex.Split(line, 
@",(?!(?<=(?:^|,)\s*\x22(?:[^\x22]|\x22\x22|\\\x22)*,)
(?:[^\x22]|\x22\x22|\\\x22)*\x22\s*(?:,|$))");
// from http://regexlib.com/REDetails.aspx?regexp_id=621 
```

为了在将全部内容读入内存后进行解析，我对换行符进行了字符串拆分，以获取包含每一行的数组。但是，当我对 120 MB 文件执行此操作时，我得到一个`System.OutOfMemoryException`. 为什么当我的电脑有 4 GB 的 RAM 时它会如此快地耗尽内存？有没有更好的方法来快速解析复杂的 CSV？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-30T21:34:58.900

除非必须，否则不要滚动自己的解析器。我有这个运气：

[一个快速的 CSV 阅读器](http://www.codeproject.com/KB/database/CsvReader.aspx)

如果没有别的，你可以看看引擎盖下，看看别人是怎么做的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-30T21:30:07.477

对于基本上任何大小的分配，您都可以获得 OutOfMemoryException。当您分配一块内存时，您实际上是在要求一块具有所请求大小的连续内存。如果不能兑现，您将看到 OutOfMemoryException。

您还应该知道，除非您运行的是 64 位 Windows，否则您的 4 GB RAM 将分为 2 GB 内核空间和 2 GB 用户空间，因此您的 .NET 应用程序默认无法访问超过 2 GB 的空间。

在 .NET 中执行字符串操作时，由于 .NET 字符串是不可变的，您可能会创建大量临时字符串。因此，您可能会看到内存使用量急剧上升。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-30T21:33:56.937

如果您将整个文件读入字符串，您可能应该使用[StringReader](http://msdn.microsoft.com/en-us/library/system.io.stringreader.aspx)。

```
StringReader reader = new StringReader(fileContents);
string line;
while ((line = reader.ReadLine()) != null) {
    // Process line
} 
```

这应该与从文件流式传输大致相同，不同之处在于内容已经在内存中。

**测试后编辑**

使用 140MB 文件尝试上述方法，其中处理包括使用 line.Length 递增长度变量。这在我的电脑上花了大约 1.6 秒。在此之后，我尝试了以下操作：

```
System.IO.StreamReader reader = new StreamReader("D:\\test.txt");
long length = 0;
string line;
while ((line = reader.ReadLine()) != null)
    length += line.Length; 
```

结果大约是 1 秒。

当然，您的里程可能会有所不同，特别是如果您正在从网络驱动器读取数据，或者您的处理时间足以让硬盘驱动器寻找其他地方。但是，如果您使用 FileStream 读取文件并且您没有缓冲。StreamReader 提供缓冲，极大地增强了读取。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-30T21:30:35.323

您可能无法分配具有那么多连续内存的单个对象，也不应该期望能够。流式传输是执行此操作的普通方式，但您是对的，它可能会更慢（尽管我认为它通常不应该慢得多。）

作为一种折衷方案，您可以尝试使用类似的函数一次读取文件的较大部分（但仍不是全部）`StreamReader.ReadBlock()`，然后依次处理每个部分。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-30T21:43:03.453

正如其他海报所说，OutOfMemory 是因为它找不到请求大小的连续内存块。

但是，您说逐行解析比一次全部读取然后进行处理要快几倍。这仅在您采用简单的阻塞读取方法时才有意义，例如（在伪代码中）：

```
while(! file.eof() )
{
    string line = file.ReadLine();
    ProcessLine(line);
} 
```

您应该改用流式传输，其中您的流由正在读取文件的备用线程的 Write() 调用填充，因此无论您的 ProcessLine() 做什么，文件读取都不会被阻塞，反之亦然。这应该与一次读取整个文件然后进行处理的性能相当。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-30T21:31:51.887

您可能应该尝试使用[CLR 分析器](http://www.microsoft.com/downloads/details.aspx?familyid=A362781C-3870-43BE-8926-862B40AA0CD0&displaylang=en)来确定您的实际内存使用情况。可能是您的系统 RAM 以外的内存限制。例如，如果这是一个 IIS 应用程序，您的内存就会受到应用程序池的限制。

使用此配置文件信息，您可能会发现需要使用更具可扩展性的技术，例如您最初尝试的 CSV 文件的流式传输。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-30T21:37:16.850

您的堆栈内存不足，而不是堆内存不足。

您可以尝试重构您的应用程序，以便以更易于管理的数据“块”处理输入，而不是一次处理 120MB。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-15T08:32:26.820

我同意这里的大多数人，你需要使用流媒体。

我不知道到目前为止是否有人说过，但你应该看看一种扩展方法。

而且我知道，毫无疑问，.NET / CLR 上最好的 CSV 拆分技术就是 [这个](http://blogs.msdn.com/ericwhite/archive/2008/09/30/linq-to-text-and-linq-to-csv.aspx)

该技术从输入 CSV 生成了 +10GB XML 输出，包括广泛的输入过滤器等等，比我见过的任何其他方法都快。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-02-22T23:52:26.780

您应该将一个块读入缓冲区并进行处理。然后读取另一个块，依此类推。

有许多图书馆可以有效地为您完成这项工作。我维护一个名为[CsvHelper 的](http://joshclose.github.io/CsvHelper/)。您需要处理许多边缘情况，例如逗号或行尾位于字段中间时。

# c# - 电源外壳。C# 测量 powershell 主机内存使用情况

> ID：809176
> 
> 赞同：1
> 
> 时间：2009-04-30T21:25:44.477
> 
> 标签：c#, memory, powershell

我正在使用 powershell 异步管道调用从 C# 自动使用 powershell 脚本，我注意到当我一遍又一遍地执行脚本时，使用相同的运行空间，`<scriptname>.vhost.exe`内存使用量会不断增加，它会用完经过一天的操作后的内存。

有没有办法测量运行空间占用了多少内存，或者实际上，即使是你测量它的方式。我知道我可以准备一个调用 WMI 的特殊脚本，它会返回一个进程列表，我可以搜索正确的虚拟主机，然后对特定行进行子串化，但我认为这只会增加概率。

我在想也许 runspaceconfiguration 类或 $host 变量会提供总结，但我什么也看不到。

理想情况下，我想调整分配给它的内存大小，一旦它达到那个大小，我就会处理它，并创建一个新的运行空间，但这很昂贵。是他们通过释放内存，比如说一个powershell dispose。

2009 年 5 月 26 日

我真正想知道的是，当长时间执行多个脚本会影响运行时内存时，内存是如何使用的。本质上，我有一个由规则驱动的执行引擎。当规则触发时，有时会执行脚本。每个规则库（规则集）都有自己的 powershell 主机。问题是如果我执行多个脚本，那么当前的 appdomain 会如何影响内存。将主机转储到另一个应用程序域中会更好，还是在当前标准 c# 方式之外设置它的运行时。问题是，他们缺乏好的文档。本质上，我想通过重复使用确保它们不是内存使用的累积。如果我将它发射到一个远程域中，那么至少当它达到一定大小时，我可以转储它并重新创建它。

你的想法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T19:24:03.370

One of the first areas to check would be that any objects you create in that runspace are dereferenced (no variables pointing towards them) so they can be garbage collected.

A similar issue can happen in the PowerShell console and [I blogged about that problem here](https://stevenmurawski.com/powershell/2009/03/tip-free-up-some-memory/).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T22:51:30.650

我认为您需要发布一个代码片段，说明您是如何使用 powerscript 对象来执行此操作的。

另外，VSHost只是你从IDE运行时的宿主进程（换句话说就是调试）你在IDE外运行应用程序时有同样的情况吗？

# sharepoint - 将文档保存到 SharePoint 会显示包含错误元数据的“Web 文件属性”对话框

> ID：809179
> 
> 赞同：1
> 
> 时间：2009-04-30T21:26:27.797
> 
> 标签：sharepoint, moss, document, content-type

**情况：**

*   自定义“主文档”内容类型继承自 Document
*   “主文档”内容类型有五个额外的选择字段
*   有五种自定义“文档模板”内容类型继承自“主文档”内容类型
*   每个“文档模板”内容类型都使用不同的 Word 文档模板 (.dot) 文件
*   每个“文档模板”内容类型都已添加到文档库中

**问题：**

1.  我单击库中的文档
2.  在 Word 2003 中打开文档供我编辑
3.  我做了一些更改并保存
4.  弹出一个名为“Web 文件属性”的框。该窗口包含我的所有自定义元数据属性和 ContentType 字段。ContentType 字段正确设置为当前内容类型。其他字段将重置为其默认值。通过转到文件-> 属性显然可以打开同一个窗口

这个窗口本身就可以了，除了两个原因：

*   它包括 ContentType 列
*   我的所有自定义元数据属性都是可见的，但会重置为其默认值，而不是之前选择的任何值。这意味着，每次用户想要保存文档时，他们都必须记住标记了哪些属性并将它们重新设置。

**问题：**

1.  我可以禁用此 Web 文件属性框吗？
2.  如果没有...我可以将显示的字段填充为正确的值吗？
3.  如果没有...有没有办法禁止我的字段显示在此窗口中？
4.  如果不是...这是我可以修改的 SharePoint 页面吗？

`***`***编辑更多信息***`***`

看起来这只发生在 Office 2003 中，并且看起来它会影响选择字段。*如果我创建与查找*字段相同的列，它似乎可以工作。

*再次编辑*

看起来如果查找字段是多选字段，那么它根本不会显示在 Web 文件属性框中（单选查找仍然有效）。

*编辑 2009 年 10 月 14 日*

Brenda 下面提到的知识库文章链接：http: [//support.microsoft.com/kb/971500/](http://support.microsoft.com/kb/971500/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T14:10:43.303

这更像是一种解决方法而不是答案，但我想我不妨把它放在这里，以防它帮助别人。

Web 文件属性框的这些问题似乎是 Office 2003 特有的。我上面报告的问题似乎在 Office 2007 中得到修复。

如果您想让它在 2003 年工作，并且您的**文档**内容类型中有选择/查找字段，这里是摘要：

*   单选选项字段**不起作用**
*   多选选择字段确实有效
*   单选查找字段确实有效
*   多选查找字段**不起作用**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-08T14:56:12.800

我们有确切的问题。早在 2 月份，我就向 Microsoft 立案，他们终于能够复制我的问题。

我一直被告知并告知我的修复将在 6 月累积更新时可用。我刚刚从我的 Microsoft 代表那里收到了一个特定的修补程序并应用了它，但它仍然没有解决我的问题。我希望他给了我一个错误的并且有一个真正的给我。

谢谢你的帖子。我可能会尝试上面的一些建议，但我只想让微软解决这个问题。我们不能升级到Office2007！

谢谢。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-10T16:58:03.880

仅供参考 - 我想更正我以前的帖子。 **删除互联网缓存后，该修复解决了我的问题。** 现在完美运行。这是您需要的知识库： KB971500 如果您找不到它，我可以通过电子邮件向您发送修复程序。文档中的注释并没有完全按照我的意愿描述问题，但它是针对我的情况的解决方法。

bhartson@lbrealty.com

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-06T00:34:38.167

伙计，这真的要了我的命，在我认为这是一个错误之前，我花了一整天的时间重新创建文档库以及我的 excel 模板的各种内容类型和变体……至少 MS 现在有一个小的修补程序请求。 ..我猜他们会把它寄给我的：\

我没有在 excel/office 2003 中对此进行测试，并且在展示我们的小工作流程时确实搞砸了……令人尴尬……总是使用人们将要使用的应用程序和环境进行测试！！！

感谢 KB 文章编号

# sql-server - 在 SQL Server 2000 中授予对存储过程的选择权限

> ID：809180
> 
> 赞同：2
> 
> 时间：2009-04-30T21:27:17.530
> 
> 标签：sql-server

我想授予用户访问存储过程的权限，但不授予用户访问该存储过程需要使用的数据库中所有对象的权限。

授予存储过程权限以使其工作的最佳方法是什么，但仅授予用户执行访问权限以运行它。

我正在使用 sql server 2000 sp4。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-30T21:39:24.507

来自[MSDN](http://msdn.microsoft.com/en-us/library/aa214299.aspx)

> 用户可以被授予执行存储过程的权限，即使他们没有直接执行过程语句的权限

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-30T21:31:17.553

尝试

exec grant exec ON 'myprocname' TO 'myusername'

# java - Java - 安排日常任务

> ID：809183
> 
> 赞同：7
> 
> 时间：2009-04-30T21:27:41.647
> 
> 标签：java, scheduling, timer, task

我正在寻找一种有效的方法来每天下午 3 点执行一个方法，而不管应用程序最初运行的时间或运行了多长时间。

这必须完全由应用程序完成，无需操作系统干预（例如 Windows 任务计划程序）

我一直在尝试不同配置的 java.util.Timer，但没有成功。

任何帮助，将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-30T21:31:18.487

你应该看看[Quartz](http://www.quartz-scheduler.org/)，它是一个基于 Java 的作业调度系统。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-30T21:39:36.097

您可能想要使用类似[石英引擎](http://www.quartz-scheduler.org/)的东西，它可以执行诸如执行错过的任务（例如在*ahem*崩溃期间）之类的事情，并且它可以消除尝试管理线程的工作。

例如，如果您使用线程并将其置于睡眠状态并在 86400 秒（一天）后将其唤醒，您将在 DST 一天内延迟一小时（天 = 82800 秒）或提前一小时（天 = 90000 秒）醒来，所以小心你选择的任何解决方案

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-30T22:16:58.660

一个内置的 JDK 方法是按照其他人的建议并首先计算：

*   当前时间 - 期望时间

然后，您可以使用[调度执行器之类的](http://java.sun.com/javase/6/docs/api/java/util/concurrent/ScheduledExecutorService.html)东西来提交任务，并以特定的延迟运行它们。[这比Quartz](http://www.quartz-scheduler.org/)等框架的选项要简单得多 ，但不需要外部依赖项。

此外，您应该始终列出您正在使用的 JDK，以便人们可以为您的 JDK 版本提供解决方案。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-30T21:32:48.250

您可以启动一个线程来计算到下一个下午 3 点的差值并在这段时间内休眠。当它醒来时，它会执行该方法并重新计算并休眠。这是你的意思吗？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-30T21:55:02.893

正如其他人所说，Quartz 是一种选择，您可以使用它执行类似 cron 的操作、作业或触发器，这里有一个关于此主题的链接：http: [//www.ibm.com/developerworks/java/library/j-quartz /index.html](http://www.ibm.com/developerworks/java/library/j-quartz/index.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-01T06:15:57.727

[Jcrontab](http://www.jcrontab.org/index.shtml)

> Jcrontab 是一个用 Java 编写的调度程序。项目目标是为 Java 项目提供一个功能齐全的时间表。

# objective-c - 链接到 Cocoa / Xcode 中的常量文件

> ID：809187
> 
> 赞同：4
> 
> 时间：2009-04-30T21:28:25.703
> 
> 标签：objective-c, cocoa, cocoa-touch, xcode

关于stackoverflow的这个相关[问题：](https://stackoverflow.com/questions/538996/constants-in-objective-c)

如果你创建一个常量文件，你如何在你的目标中“链接”到它，所以你不必

```
#import "Constants.h" 
```

在您使用常量的每个文件中？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-02T05:13:25.937

你真的应该使用`#import "Constants.h"`你想在其中使用常量的每个地方；Objective-C 是一种基于 C 的语言。

`#import`此外，当您在代码中放置指令或在前缀文件中放置指令时，您并没有“链接”到它。在这两种情况下，文件的内容都包含在由预处理器提供给编译器的文本流中。

最后，您通常不应该在前缀文件中添加随机的东西。（Panagiotis Korros 将此称为“您的预编译头文件”，但这有点不正确；您的前缀文件用于生成预编译头文件。）如果您在项目之间保持构建设置一致，并使用相同的跨项目为您的前缀文件命名，Xcode 实际上会非常积极地为您缓存和重用预编译版本。通过将特定于项目的内容放入其中来解决这个问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-30T21:53:21.400

您可以将导入行放在预编译的头文件中。那就是以您的应用程序名称命名的 .pch 文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-28T08:45:34.177

当我在应用程序内的更多文件中使用常量时，通常我使用 .pch 文件（在“支持文件”文件夹下找到它）。

在我的 .pch 文件中插入常量，例如：

```
static const int NAME_CONSTANT = 200; 
```

并在我的项目中使用 NAME_CONSTANT 到所有文件中，而不使用 import never 文件，因为 .pch 是预编译的头文件。

# templates - 用编程语言实现模板的最佳方法是什么？

> ID：809188
> 
> 赞同：2
> 
> 时间：2009-04-30T21:28:41.210
> 
> 标签：templates, language-design

我正在设计一种高级的、面向对象的、垃圾收集的编程语言，但我在如何制作模板方面遇到了问题。我计划创建一个类似于 .NET 或 JVM 的 VM 类型系统（但它会在底层使用 LLVM）。问题是我想拥有强大的、类似 C++ 的模板，但具有动态链接（因此我可以替换模板库而无需重新编译使用它的所有内容）。我希望能够在没有模板定义的情况下编译源文件。应尽量减少 JIT 时的代码生成。

以下是我正在考虑的选项：

*   具有静态链接到每个编译单元的模板库的概念。模板库本质上就像一个 AST，在模板实例化时需要填充空白。这样做的问题是，如果使用不同版本的模板库编译两个文件，它们可能不兼容，或者如果模板库有错误，则所有内容都必须重新编译。这就是 C++ 的做法。
*   具有在 JIT 时间链接的模板库。这解决了大部分问题，但要求 IR 本质上是 AST。我希望 IR 的水平要低得多。这需要更多的 JIT 工作。
*   拥有类似 C# 的懦弱泛型，只有类型作为参数。这是相当有限的，但允许简单的代码生成和动态链接。

还有其他我没有想到的好方法吗？我倾向于第一个选项，但我真的不喜欢任何选项。你认为最好的选择是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T21:41:43.800

我想这取决于你想要的专业化程度，即模板编译器的强大程度。

如果你看一下 c++，编译器可以做各种花哨的事情（比如通过递归生成子类，可能计算分形继承图以及即时计算 Pi 的数量）。

如果你想要这种能力，你可能需要一个强大的高级 JIT。FWIW，我认为那会很酷。（只需在运行时包含完整的编译器。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-13T21:09:40.227

想想这些模板会有多强大。您必须记住，拥有即时编译的语言意味着必须在加载时和运行时完成大量繁重的工作。因此，您制作的模板越强大，您从中获得的性能就越低。

* * *

如果您真的要走这条路，您还可以按照[Macke 的建议](https://stackoverflow.com/a/809248/402022)在运行时包含编译器。事实上，有很多语言可以做到这一点。

通过这样做，您正在使您的语言实现成为“解释”或部分“解释”的语言。在这些术语中，模板只是 match-replace-eval 的化装，这有什么问题，模板通常在动态语言中像这样工作。请记住，最后将是功率与性能。

* * *

注意：当面对这种决定时，可能值得稍微退后一步。确定用例并确定它们的优先级，将如何实现与设计分开，这样您就可以迭代设计，而不会让实现成为瘫痪的原因，但仍然要考虑它。

每次迭代您都会扩展设计以涵盖更多用例，同时确定最佳设计。当你达到你喜欢的设计时，你可以迭代，然后你也可以迭代实现。这种方法允许您首先涵盖更重要的情况。

是的，我建议采用迭代增量方法。我这样做是因为这个问题是关于一种语言的设计，但它似乎非常关心实现。有必要保持这些想法的基础，否则您最终会陷入极端之一（功能太强大而可怜的性能或根本没有高性能解决方案的模板）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-09-21T19:27:24.227

你想要达到的目标几乎是不可能的。您必须为模板定义和使用这些模板的代码保留几乎所有语言的高级表示，并从几乎经过轻微处理的源代码级别执行 JIT 编译。如果您对此感到满意 - 您必须让编译器的其余部分非常简单，并且您将无法使用任何重量级的 LLVM 优化。没有其他方法可以解决，模板元编程依赖于高级信息的可用性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-09-21T18:13:40.670

有点依赖于语言的其余部分......如果你有运算符重载、值类型等，那么你真的很复杂（并且可能错过了很好的优化机会）不走 C++ 路线：使用模板的代码还必须在 JIT 时间内表示为 AST，以实现最大程度的专业化。

由于 C++ 模板本质上是一种宏形式，因此在生成代码之前，它们可以减少由重复产生的所有膨胀。

模板类型（至少在 C++ 中）往往是所有其他代码基础的最核心类型，因此，如果它们发生变化，假设其他代码仍然与它兼容，除了最小的变化之外，其他代码仍然兼容。

# iphone - 你什么时候必须在 iPhone 上显式地实例化 UINavigationController？

> ID：809192
> 
> 赞同：1
> 
> 时间：2009-04-30T21:29:55.980
> 
> 标签：iphone, objective-c

我们用于 Navigation 的通用模板在 iPhone 上的 AppDelegate 中的 applicationDidFinishLoading: 中看起来像这样：

```
 [window addSubview:navController.view];
    [window makeKeyAndVisible]; 
```

我的问题很简单。如果 navController 有一个 IBOutlet，它是否已经为我们实例化了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T21:43:12.187

除了使 navController 成为 IBOutlet 之外，您还需要将 outlet 链接到 Interface Builder 中的 UINavigationController 对象。加载 NIB 时，会实例化其中的所有对象。IBOutlet 只是为您提供一个指向在加载 NIB 的过程中自动实例化的对象的指针。

# php - 如何使用正则表达式从网页中提取数据？

> ID：809202
> 
> 赞同：0
> 
> 时间：2009-04-30T21:32:11.310
> 
> 标签：php, regex, screen-scraping

我正在编写一个 curl 脚本来收集有关某些性犯罪者的信息，我开发了该脚本来获取如下所示的链接：

[http://criminaljustice.state.ny.us/cgi/internet/nsor/...](http://criminaljustice.state.ny.us/cgi/internet/nsor/fortecgi?serviceName=WebNSOR&templateName=detail.htm&requestingHandler=WebNSORDetailHandler&ID=368343543)（截断的网址）

现在，当我们访问此链接时，我想在此页面上的所有字段下获取信息，例如罪犯 ID：、姓氏等，并将其放入我自己的变量中。我的正则表达式很弱，这就是我在这里的原因。还是有其他方法？

有人可以帮我这样做吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-30T21:50:51.997

[phpQuery](http://code.google.com/p/phpquery/)非常适合在 PHP 中进行屏幕抓取。它允许您使用与 jQuery 相同的方法访问 DOM。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-30T21:46:23.647

您不想要正则表达式（请参阅[Can you provide some examples of why it is hard to parse XML and HTML with a regex?](https://stackoverflow.com/questions/701166/can-you-provide-some-examples-of-why-it-is-hard-to-parse-xml-and-html-with-a-rege) [，](https://stackoverflow.com/questions/773340/can-you-provide-an-example-of-parsing-html-with-your-favorite-parser/774853#774853)寻找PHP 的 HTML 解析器。请参阅[Can you provide an example of parsing HTML with your最喜欢的解析器？](https://stackoverflow.com/questions/773340/can-you-provide-an-example-of-parsing-html-with-your-favorite-parser)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-30T21:58:08.563

我倾向于同意之前关于 RegEx 不是适合这项工作的工具的海报。如果你只是想要一个快速而肮脏的表达，这里是：

```
Offender Id:.*
.*&amp;nbsp;[0-9]* 
```

注意：您必须在此表达式中包含换行符。另请注意，这是非常脆弱的，因为如果您正在解析的源发生很大变化，它就会中断。

# c++ - c ++从std :: cin读取X字节，并将字符串截断为X字节长度

> ID：809203
> 
> 赞同：1
> 
> 时间：2009-04-30T21:32:11.823
> 
> 标签：c++, string

我有一个 c++ 程序，它从 linux 管道获取输入，并输出到 std::cout 以供进一步处理。

目前我的代码如下所示：

```
std::istreambuf_iterator<char> it(std::cin);
std::istreambuf_iterator<char> end;
std::string str(it, end);

//Lots of string manipulation here.

str = str.substr(0, 65535);
std::cout << str << std::endl; 
```

这是浪费的，因为传入的字符串很大。

1.  我如何只读取大约 100kB 的 cin 到 c++ 字符串而忽略其余部分？
2.  如何将 c++ 字符串截断为 65535 字节而不是字符？（我以后需要处理多字节字符。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-30T21:35:58.930

1.  std::cin.read(&buf, 100*1024);
2.  std::string.size() 返回 num 个字节，我很确定。

# python - Django Manager Chaining

> ID：809210
> 
> 赞同：31
> 
> 时间：2009-04-30T21:33:29.450
> 
> 标签：python, django, django-models, django-managers

I was wondering if it was possible (and, if so, how) to chain together multiple managers to produce a query set that is affected by both of the individual managers. I'll explain the specific example that I'm working on:

I have multiple abstract model classes that I use to provide small, specific functionality to other models. Two of these models are a DeleteMixin and a GlobalMixin.

The DeleteMixin is defined as such:

```
class DeleteMixin(models.Model):
    deleted = models.BooleanField(default=False)
    objects = DeleteManager()

    class Meta:
        abstract = True

    def delete(self):
        self.deleted = True
        self.save() 
```

Basically it provides a pseudo-delete (the deleted flag) instead of actually deleting the object.

The GlobalMixin is defined as such:

```
class GlobalMixin(models.Model):
    is_global = models.BooleanField(default=True)

    objects = GlobalManager()

    class Meta:
        abstract = True 
```

It allows any object to be defined as either a global object or a private object (such as a public/private blog post).

Both of these have their own managers that affect the queryset that is returned. My DeleteManager filters the queryset to only return results that have the deleted flag set to False, while the GlobalManager filters the queryset to only return results that are marked as global. Here is the declaration for both:

```
class DeleteManager(models.Manager):
    def get_query_set(self):
        return super(DeleteManager, self).get_query_set().filter(deleted=False)

class GlobalManager(models.Manager):
    def globals(self):
        return self.get_query_set().filter(is_global=1) 
```

The desired functionality would be to have a model extend both of these abstract models and grant the ability to only return the results that are both non-deleted and global. I ran a test case on a model with 4 instances: one was global and non-deleted, one was global and deleted, one was non-global and non-deleted, and one was non-global and deleted. If I try to get result sets as such: SomeModel.objects.all(), I get instance 1 and 3 (the two non-deleted ones - great!). If I try SomeModel.objects.globals(), I get an error that DeleteManager doesn't have a globals (this is assuming my model declaration is as such: SomeModel(DeleteMixin, GlobalMixin). If I reverse the order, I don't get the error, but it doesn't filter out the deleted ones). If I change GlobalMixin to attach GlobalManager to globals instead of objects (so the new command would be SomeModel.globals.globals()), I get instances 1 and 2 (the two globals), while my intended result would be to only get instance 1 (the global, non-deleted one).

I wasn't sure if anyone had run into any situation similar to this and had come to a result. Either a way to make it work in my current thinking or a re-work that provides the functionality I'm after would be very much appreciated. I know this post has been a little long-winded. If any more explanation is needed, I would be glad to provide it.

**Edit:**

I have posted the eventual solution I used to this specific problem below. It is based on the link to Simon's custom QuerySetManager.

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-01T21:04:31.600

See this snippet on Djangosnippets: [http://djangosnippets.org/snippets/734/](http://djangosnippets.org/snippets/734/)

Instead of putting your custom methods in a manager, you subclass the queryset itself. It's very easy and works perfectly. The only issue I've had is with model inheritance, you always have to define the manager in model subclasses (just: "objects = QuerySetManager()" in the subclass), even though they will inherit the queryset. This will make more sense once you are using QuerySetManager.

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-02T06:00:37.820

Here is the specific solution to my problem using the custom QuerySetManager by Simon that Scott linked to.

```
from django.db import models
from django.contrib import admin
from django.db.models.query import QuerySet
from django.core.exceptions import FieldError

class MixinManager(models.Manager):    
    def get_query_set(self):
        try:
            return self.model.MixinQuerySet(self.model).filter(deleted=False)
        except FieldError:
            return self.model.MixinQuerySet(self.model)

class BaseMixin(models.Model):
    admin = models.Manager()
    objects = MixinManager()

    class MixinQuerySet(QuerySet):

        def globals(self):
            try:
                return self.filter(is_global=True)
            except FieldError:
                return self.all()

    class Meta:
        abstract = True

class DeleteMixin(BaseMixin):
    deleted = models.BooleanField(default=False)

    class Meta:
        abstract = True

    def delete(self):
        self.deleted = True
        self.save()

class GlobalMixin(BaseMixin):
    is_global = models.BooleanField(default=True)

    class Meta:
        abstract = True 
```

Any mixin in the future that wants to add extra functionality to the query set simply needs to extend BaseMixin (or have it somewhere in its heirarchy). Any time I try to filter the query set down, I wrapped it in a try-catch in case that field doesn't actually exist (ie, it doesn't extend that mixin). The global filter is invoked using globals(), while the delete filter is automatically invoked (if something is deleted, I never want it to show). Using this system allows for the following types of commands:

```
TemporaryModel.objects.all() # If extending DeleteMixin, no deleted instances are returned
TemporaryModel.objects.all().globals() # Filter out the private instances (non-global)
TemporaryModel.objects.filter(...) # Ditto about excluding deleteds 
```

One thing to note is that the delete filter won't affect admin interfaces, because the default Manager is declared first (making it the default). I don't remember when they changed the admin to use Model._default_manager instead of Model.objects, but any deleted instances will still appear in the admin (in case you need to un-delete them).

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-01T22:26:05.383

I spent a while trying to come up with a way to build a nice factory to do this, but I'm running into a lot of problems with that.

The best I can suggest to you is to chain your inheritance. It's not very generic, so I'm not sure how useful it is, but all you would have to do is:

```
class GlobalMixin(DeleteMixin):
    is_global = models.BooleanField(default=True)

    objects = GlobalManager()

    class Meta:
        abstract = True

class GlobalManager(DeleteManager):
    def globals(self):
        return self.get_query_set().filter(is_global=1) 
```

If you want something more generic, the best I can come up with is to define a base `Mixin` and `Manager` that redefines `get_query_set()` (I'm assuming you only want to do this once; things get pretty complicated otherwise) and then pass a list of fields you'd want added via `Mixin`s.

It would look something like this (not tested at all):

```
class DeleteMixin(models.Model):
    deleted = models.BooleanField(default=False)

    class Meta:
        abstract = True

def create_mixin(base_mixin, **kwargs):
    class wrapper(base_mixin):
        class Meta:
            abstract = True
    for k in kwargs.keys():
        setattr(wrapper, k, kwargs[k])
    return wrapper

class DeleteManager(models.Manager):
    def get_query_set(self):
        return super(DeleteManager, self).get_query_set().filter(deleted=False)

def create_manager(base_manager, **kwargs):
    class wrapper(base_manager):
        pass
    for k in kwargs.keys():
        setattr(wrapper, k, kwargs[k])
    return wrapper 
```

Ok, so this is ugly, but what does it get you? Essentially, it's the same solution, but much more dynamic, and a little more DRY, though more complex to read.

First you create your manager dynamically:

```
def globals(inst):
    return inst.get_query_set().filter(is_global=1)

GlobalDeleteManager = create_manager(DeleteManager, globals=globals) 
```

This creates a new manager which is a subclass of `DeleteManager` and has a method called `globals`.

Next, you create your mixin model:

```
GlobalDeleteMixin = create_mixin(DeleteMixin,
                                 is_global=models.BooleanField(default=False),
                                 objects = GlobalDeleteManager()) 
```

Like I said, it's ugly. But it means you don't have to redefine `globals()`. If you want a different type of manager to have `globals()`, you just call `create_manager` again with a different base. And you can add as many new methods as you like. Same for the manager, you just keep adding new functions that will return different querysets.

So, is this really practical? Maybe not. This answer is more an exercise in (ab)using Python's flexibility. I haven't tried using this, though I do use some of the underlying principals of dynamically extending classes to make things easier to access.

Let me know if anything is unclear and I'll update the answer.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-01T22:41:21.130

Another option worth considering is the PassThroughManager:

[https://django-model-utils.readthedocs.org/en/latest/managers.html#passthroughmanager](https://django-model-utils.readthedocs.org/en/latest/managers.html#passthroughmanager)

# iphone - 在 mailto 中包含 HTML img 标签：iPhone 上的 URL

> ID：809214
> 
> 赞同：1
> 
> 时间：2009-04-30T21:33:43.973
> 
> 标签：iphone, html, image, email, mailto

我正在尝试在电子邮件中包含一张图片，该图片是使用 iPhone 应用程序中的 mailto: URL 发送的。该图像显示在发件人的邮件应用程序上，但在发送后，标签似乎被完全剥离。这是一个片段，它已被手动转义：

```
[mailUrl appendString:@"&body=%3Cimg%20src%3D%22http%3A//stackoverflow.com/content/img/stackoverflow-logo.png%22%20/%3E"]; 
```

没有使用我自己的 SMTP 服务器，或者将它们作为附件发送，有没有办法在 iPhone 上的电子邮件中嵌入图像？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-30T21:36:40.427

不，直到 2.2.1 版之前，都无法使用 iPhone SDK 来做到这一点。

有一种使用 3.0 SDK 的方法，但它在 NDA 下，所以我不能在这里讨论它:(

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-11-16T13:09:55.523

[http://webbuilders.wordpress.com/2009/11/16/url-must-be-url-encoded-inside-a-nsstring-in-objective-c/](http://webbuilders.wordpress.com/2009/11/16/url-must-be-url-encoded-inside-a-nsstring-in-objective-c/)

这个新帐户不允许我发布我的答案。我在这里包含信息

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-15T13:30:44.827

卢克，可能对你不再有用了，但是在研究这个主题时，有人提到用包装图像可以`<b></b>`防止 iphone 邮件应用程序剥离 img 标签。我试过了，它对我有用。

# c# - nHibernate 是否转义字符串？

> ID：809215
> 
> 赞同：0
> 
> 时间：2009-04-30T21:33:44.830
> 
> 标签：c#, nhibernate, escaping

从用户报告中，'当编辑 foo. textboxBar 允许在保存时产生警告 .net 错误的特殊字符 '

textboxBar.Text 被分配给一个对象并使用 nHibernate 保存

```
<property name="TextboxBar" length="255" not-null="false" /> 
```

认为它可能是 nHibernate 没有转义字符串，但在文档中找不到它。

nHibernate 1.2.0 是否自动转义字符串，链接赞赏？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T21:37:45.213

我怀疑它甚至需要转义字符串 - 我希望在参数化语句中传递值。

我强烈怀疑这与 nHibernate 无关——我怀疑这只是一个 ASP.NET 错误，尽管承认这是假设它是一个 ASP.NET 应用程序。如果是这种情况，您可能只想关闭该页面的验证。

有关更多详细信息，请参阅[有关验证的 ASP.NET 常见问题解答页面。](http://www.asp.net/learn/whitepapers/request-validation/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-30T21:43:14.590

从您的问题来看，情况并不完全清楚，或者即使这是 ASP.NET，但用户是否可能指的是“从客户端检测到潜在危险的 Request.Form 值……”错误消息，即 ASP.NET。 NET 生成？

如果是这样，则此错误消息与 NHibernate 无关，但与默认情况下 ASP.NET 尝试检测可能是跨站点脚本攻击尝试的危险表单输入这一事实有关。

要解决此问题，您需要负责对所有输出进行 HTML 编码。如果您使用 Web 表单，则应将此页面指令添加到您的页面...

```
<%@ Page ValidateRequest="false" ... %> 
```

...然后确保您自己验证输入和/或在以后将其包含在 HTML 中时小心始终对输出进行编码。

如果您使用的是 ASP.NET MVC，您可以通过将 [ValidateInput] 属性添加到控制器操作来执行相同的操作：

```
[AcceptVerbs(HttpVerbs.Post)]
[ValidateInput(false)]
public ActionResult Edit(...)
{
   return View();
} 
```

# asp.net-ajax - 在 ASP.NET AJAX 中单击 ModalPopup 中的 OkButton 时进行回发

> ID：809222
> 
> 赞同：2
> 
> 时间：2009-04-30T21:35:04.423
> 
> 标签：asp.net-ajax, postback, ajaxcontroltoolkit, modalpopupextender

我遵循[Atlas: Creating a Confirmation Using the ModalPopup Extender](http://blogs.vertigosoftware.com/alanl/archive/2006/07/25/Creating_a_Confirmation_Using_the_ModalPopup_Extender.aspx) to make a postback when the OkButton in a ModalPopup is clicked（它使用 ASP.NET Ajax Control Toolkit 中的 ModalPopupExtender）中的示例，但正如我所见，Sys .WebForms.PostBackAction() 不再存在于 ASP.NET AJAX 中（该示例适用于 Atlas）。当我运行它时，在我创建 PostBackAction 的 javascript 行中出现“Microsoft JScript 运行时错误：预期对象”错误消息。我怎样才能使它在 ASP.NET AJAX 中工作，或者也许有另一种方法可以做到这一点？谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-22T17:11:20.910

服务器端事件确实适用于 ModalPopupExtender。您需要做的是创建一个显示样式设置为无的按钮。然后将 ModalPopupExtender 的 TargetControlID 属性设置为隐藏按钮 ID。

```
<asp:Button ID="btnShowModal" runat="server" Text="Show" OnClick="btnShowModal_Click" />
<asp:Button ID="btnHidden" runat="server" Style="display: none" />
<ajaxControlToolkit:ModalPopupExtender ID="modalExtender" runat="server" 
    TargetControlID="btnHidden" PopupControlID="divId" /> 
```

在 OnClick 处理程序中显示模式：

```
modalExtender.Show(); 
```

在将关闭模式（通常是按钮）的控件的处理程序中隐藏模式：

```
modalExtender.Hide(); 
```

我能够成功地使用此方法回发到服务器，以便在回发期间使用来自数据库的信息填充我的模式中的控件。像冠军一样工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-30T21:45:50.730

如果我没记错 ModalPopupExtender，它有一个 OKControlID，您将其设置为按钮 ID。

你不能只在调用回发的“onclick”客户端处理程序上分配你的按钮吗？

例如，类似：

```
 myModalPopupExtender.OkButtonID = myOKButton.ID;
 string script = ClientScriptManager.GetPostBackEventReference(myOKButton, myOKButton.ID);

 myOKButton.Attributes.Add("onclick", script); 
```

**编辑**：这里看起来像是[另一个潜在的解决方案。](http://forums.asp.net/t/1218424.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-30T22:00:55.763

您是否考虑过使用[ConfirmButtonExtender](http://www.asp.net/AJAX/AjaxControlToolkit/Samples/ConfirmButton/ConfirmButton.aspx)？您通过扩展程序获得模态“bling”，并且您将获得所需的 PostBack 处理。

您可以正常连接按钮单击事件以进行处理，但 Confirm 扩展程序将“拦截”处理并在用户确认操作时允许事情继续进行。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-04T13:39:14.423

您可以在面板中放置一个不可见的按钮并将其设置为 OkButton。在面板中添加您的实际按钮并添加其 OnClick 事件处理程序。请参见下面的代码：

```
<cc1:ModalPopupExtender 
TargetControlID="btnSubmit"
DropShadow="true"
OkControlID="btnOK"
CancelControlID="btnDecline"
PopupControlID="pnlTermsAndConditions"
BackgroundCssClass="popup"
ID="ModalPopupExtender1" 
runat="server">
</cc1:ModalPopupExtender>
<asp:Panel ID="pnlTermsAndConditions" runat="server">
<table width="500" cellpadding="6" cellspacing="0" border="0" bgcolor="white">
<tr>
    <td><b>Tables and Content</b></td>
</tr>
<tr>
    <td><asp:TextBox ID="TermsAndCondition" runat="server" TextMode="MultiLine" Rows="10" Columns="60">
    This is my terms and condoition
    </asp:TextBox></td>
</tr>
<tr>
    <td align="center">
    <asp:Button ID="btnAccept" runat="server" CssClass="btn" Text=" Accept " OnClick="btnAccept_Click" />&nbsp;&nbsp;
    <asp:Button ID="btnDecline" runat="server" CssClass="btn" Text=" Decline " />
    <asp:Button ID="btnOK" style="display:none;visible:false;" runat="server" CssClass="btn" Text=" OK " />
    </td>
</tr>
</table>
</asp:Panel> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-07-30T18:36:38.167

这是我一直在寻找的解决方案。很棒的帖子。顺便说一句，不必创建模拟 OK 按钮。只是不要在 Modal Popup Extension 定义中包含可选的 OKbutton 参数。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-30T21:38:51.420

也许只是将服务器端 OnClick 事件添加到按钮？这应该发回整个表格。或者您可以从 html ($find('myFormName') 或其他东西) 获取主表单并对其执行 .submit() 。

# asp.net - WPF 应用程序转换为 ASP

> ID：809225
> 
> 赞同：2
> 
> 时间：2009-04-30T21:36:49.503
> 
> 标签：asp.net, wpf

有没有办法将 WPF 应用程序转换为 ASP 应用程序？或者它们是完全不相关的技术？XAML 格式让我想起了很多 HTML，似乎有办法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-30T22:06:05.423

WPF 应用程序是 Windows 应用程序，而 ASP.Net 应用程序是 Web 应用程序。这两个平台存在巨大差异，因此很难转换。在大多数情况下，由于这些平台的不同限制和优势，这甚至是不可行的。

对于查看这可能是可能的，但如果 WPF 应用程序执行任何操作，例如写入本地文件系统或修改用户计算机上的某些内容，这将无法在 Web 上运行。

如果应用程序供内部使用，您可以查看 XAML 浏览器应用程序 (XBAP)。这些只有安全限制，您可以通过签署部署并通过域将正确的证书传播到客户端计算机来绕过这些限制。XBAP 的优点在于它们可以与 WPF 应用程序共享程序集，因此将 WPF 应用程序转换为 XBAP 非常简单。

Silverlight 是另一种可能性，但 WPF 和 Silverlight 之间存在相当大的差异，将 WPF 应用程序转换为 Silverlight 应用程序需要比最初想象的更多的重写。Silverlight 引擎建立在 .Net 之上，但它使用不同的虚拟机并且不兼容二进制文件。它仍然比 ASP.Net 更容易移植！

即使您设法将 XAML 转换为 ASP.Net HTML，您也会遇到控制行为的细微差别的问题。如果您的 WPF 应用程序正在使用主要的 WPF 功能，例如在选项卡页标题中嵌入控件或应用转换，则甚至不要考虑尝试这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-30T21:53:39.637

我不相信有一种简单的方法可以做到这一点。它们确实基本上是不相关的技术。WPF 呈现到您的屏幕，而 ASP.NET 呈现 HTML 以通过浏览器查看，并且所有事件/数据管道都完全不同。

如果您想在 Web 上运行 WPF 应用程序，您可以稍微轻松地将其转换为 Silverlight 应用程序。

# c++ - 使用 -1 将所有位设置为真是否安全？

> ID：809227
> 
> 赞同：144
> 
> 时间：2009-04-30T21:37:02.623
> 
> 标签：c++, c, binary, bit-fields

我已经看到这种模式在 C 和 C++ 中使用了很多。

```
unsigned int flags = -1;  // all bits are true 
```

这是实现此目的的一种很好的便携方式吗？还是正在使用`0xffffffff`或`~0`更好？

* * *

## 回答 #1

> 赞同：166
> 
> 时间：2009-04-30T22:08:08.073

我建议您完全按照您的说明进行操作，因为它是最直接的。Initialize to `-1`which will *always* work ，独立于实际的符号表示，而`~`有时会出现令人惊讶的行为，因为您必须拥有正确的操作数类型。`unsigned`只有这样你才能得到一个类型的最高价值。

对于一个可能的惊喜示例，请考虑以下示例：

```
unsigned long a = ~0u; 
```

它不一定会将所有位为 1 的模式存储到`a`. 但它会首先创建一个所有位为 1 的模式`unsigned int`，然后将其分配给`a`。当`unsigned long`有更多位时会发生什么，并不是所有的位都是 1。

并考虑这个，它将在非二进制补码表示上失败：

```
unsigned int a = ~0; // Should have done ~0u ! 
```

原因是`~0`必须反转所有位。反转将`-1`在二进制补码机器上产生（这是我们需要的值！），但*不会*`-1`在另一个表示上产生。在一个补码机器上，它产生零。因此，在一个补码机器上，以上将初始化`a`为零。

您应该理解的是，这一切都与价值有关，而不是位。变量用*value*初始化。如果在初始化程序中修改了用于初始化的变量的位，则将根据这些位生成值。初始化`a`为可能的最高值所需的值是`-1`或`UINT_MAX`。第二个将取决于类型`a`- 您需要`ULONG_MAX`使用`unsigned long`. 但是，第一个不取决于它的类型，这是获得最高价值的好方法。

**我们*不是*在谈论是否`-1`所有位都为一（并非总是如此）。而且我们*不是*在谈论是否`~0`所有位都为一（当然有）。**

但是我们说的是初始化`flags`变量的结果是什么。为此，**仅`-1`**适用于每种类型和机器。

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2009-05-01T01:31:29.190

*   `unsigned int flags = -1;` 是便携式的。
*   `unsigned int flags = ~0;`不可移植，因为它依赖于二进制补码表示。
*   `unsigned int flags = 0xffffffff;`不可移植，因为它采用 32 位整数。

如果您想以 C 标准保证的方式设置所有位，请使用第一个。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2009-04-30T21:42:34.950

坦率地说，我认为所有 fff 都更具可读性。至于它是一种反模式的评论，如果你真的关心所有位都被设置/清除，我认为你可能处于关心变量大小的情况，这需要像 boost 这样的东西::uint16_t 等

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2009-05-01T13:26:28.490

避免上述问题的一种方法是简单地做：

```
unsigned int flags = 0;
flags = ~flags; 
```

便携且切中要害。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2011-06-01T16:11:21.940

> ```
> unsigned int flags = -1;  // all bits are true 
> ```
> 
> “这是一种很好的[，]便携方式来实现这一点吗？”

便携的？ **是**的。

好的？ **值得商榷**，正如该线程上显示的所有混淆所证明的那样。足够清楚以使您的程序员同事能够理解代码而不会混淆，这应该是我们衡量好代码的维度之一。

此外，这种方法容易出现**编译器警告**。要在不破坏编译器的情况下消除警告，您需要显式强制转换。例如，

```
unsigned int flags = static_cast<unsigned int>(-1); 
```

显式转换要求您注意目标类型。如果您关注目标类型，那么您自然会避免其他方法的陷阱。

我的建议是注意目标类型并确保没有隐式转换。例如：

```
unsigned int flags1 = UINT_MAX;
unsigned int flags2 = ~static_cast<unsigned int>(0);
unsigned long flags3 = ULONG_MAX;
unsigned long flags4 = ~static_cast<unsigned long>(0); 
```

对于你的程序员伙伴来说，所有这些都是**正确且更明显的。**

**并且使用 C++11**：我们可以`auto`用来使这些变得更简单：

```
auto flags1 = UINT_MAX;
auto flags2 = ~static_cast<unsigned int>(0);
auto flags3 = ULONG_MAX;
auto flags4 = ~static_cast<unsigned long>(0); 
```

我认为正确和明显比简单正确更好。

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2009-04-30T21:41:17.543

我不确定在 C++ 中首先使用 unsigned int 作为标志是一个好主意。bitset 之类的呢？

`std::numeric_limit<unsigned int>::max()`更好，因为`0xffffffff`假设 unsigned int 是一个 32 位整数。

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2010-08-01T21:02:49.757

**标准保证**将 -1 转换为任何无符号类型会导致全一。使用`~0U`通常很糟糕，因为`0`has 类型`unsigned int`并且不会填充更大的无符号类型的所有位，除非您明确编写类似`~0ULL`. 在健全的系统上，`~0`应该与 相同`-1`，但由于标准允许补码和符号/大小表示，严格来说它不是可移植的。

当然，`0xffffffff`如果你知道你需要正好 32 位，写出来总是可以的，但是 -1 的优点是它可以在任何上下文中工作，即使你不知道类型的大小，例如适用于多种类型的宏，或者如果类型的大小因实现而异。如果您知道类型，另一种获得全一的安全方法是限制宏`UINT_MAX`、`ULONG_MAX`、`ULLONG_MAX`等。

我个人总是使用-1。它总是有效的，你不必考虑它。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2009-05-01T00:20:58.750

只要你有`#include <limits.h>`作为你的包括之一，你应该只使用

```
unsigned int flags = UINT_MAX; 
```

如果你想要很长的位，你可以使用

```
unsigned long flags = ULONG_MAX; 
```

无论有符号整数如何实现，这些值都保证将结果集的所有值位设置为 1。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2013-07-16T04:55:08.697

是的。正如其他答案中提到的，`-1`是最便携的；但是，它不是很语义化并且会触发编译器警告。

为了解决这些问题，试试这个简单的助手：

```
static const struct All1s
{
    template<typename UnsignedType>
    inline operator UnsignedType(void) const
    {
        static_assert(std::is_unsigned<UnsignedType>::value, "This is designed only for unsigned types");
        return static_cast<UnsignedType>(-1);
    }
} ALL_BITS_TRUE; 
```

用法：

```
unsigned a = ALL_BITS_TRUE;
uint8_t  b = ALL_BITS_TRUE;
uint16_t c = ALL_BITS_TRUE;
uint32_t d = ALL_BITS_TRUE;
uint64_t e = ALL_BITS_TRUE; 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-04-30T22:58:52.443

我不会做-1的事情。这是相当不直观的（至少对我来说）。将有符号数据分配给无符号变量似乎违反了事物的自然顺序。

在你的情况下，我总是使用`0xFFFF`. （当然，为可变大小使用正确数量的 F。）

[顺便说一句，我很少看到在实际代码中使用 -1 技巧。]

此外，如果您真的关心变量中的各个位，那么最好开始使用固定宽度`uint8_t`, `uint16_t`,`uint32_t`类型。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-05-02T10:53:37.333

在 Intel 的 IA-32 处理器上，可以将 0xFFFFFFFF 写入 64 位寄存器并获得预期结果。这是因为 IA32e（IA32 的 64 位扩展）仅支持 32 位立即数。在 64 位指令中，32 位立即数*符号扩展*为 64 位。

以下是非法的：

```
mov rax, 0ffffffffffffffffh 
```

下面将 64 个 1 放入 RAX：

```
mov rax, 0ffffffffh 
```

为了完整起见，以下将 32 个 1 放在 RAX（又名 EAX）的下部：

```
mov eax, 0ffffffffh 
```

事实上，当我想将 0xffffffff 写入 64 位变量时，我的程序失败了，而我得到了 0xffffffffffffffff。在 C 中，这将是：

```
uint64_t x;
x = UINT64_C(0xffffffff)
printf("x is %"PRIx64"\n", x); 
```

结果是：

```
x is 0xffffffffffffffff 
```

我想将此作为对所有表示 0xFFFFFFFF 假定为 32 位的答案的评论发布，但有很多人回答了它，我想我会将其添加为单独的答案。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-05-12T13:41:33.717

有关这些问题的非常清楚的解释，请参阅 litb 的答案。

我的不同意见是，非常严格地说，这两种情况都不能保证。我不知道有任何体系结构不代表所有位设置的无符号值“小于 2 的位数的幂”，但这是标准实际所说的（3.9.1/7 plus注 44)：

> 整数类型的表示应使用纯二进制计数系统定义值。[注 44：] 使用二进制数字 0 和 1 的整数的位置表示，其中由连续位表示的值是相加的，从 1 开始，并乘以 2 的连续整数幂，可能除了具有最高的位置。

这使得其中一个位有可能成为任何东西。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2011-06-01T14:37:25.383

尽管`0xFFFF`(or`0xFFFFFFFF`等) 可能更易于阅读，但它可能会破坏代码的可移植性，否则这些代码本来是可移植的。例如，考虑一个库例程来计算数据结构中有多少项设置了某些位（确切的位由调用者指定）。该例程可能完全不知道这些位代表什么，但仍然需要有一个“所有位设置”常量。在这种情况下，-1 将比十六进制常量好得多，因为它适用于任何位大小。

如果一个`typedef`值用于位掩码，另一种可能性是使用 ~(bitMaskType)0; 如果位掩码恰好是 16 位类型，则该表达式将仅设置 16 位（即使 'int' 否则将是 32 位），但由于 16 位将是所有必需的，*只要*有一个就可以了实际上在类型转换中使用了适当的类型。

`longvar &= ~[hex_constant]`顺便说一句，如果十六进制常数太大而无法放入 ，则表单的表达式有一个讨厌的陷阱`int`，但可以放入`unsigned int`. 如果 an`int`是 16 位，则`longvar &= ~0x4000;`or `longvar &= ~0x10000`; 将清除 的一位`longvar`，但`longvar &= ~0x8000;`将清除第 15 位和高于该位的所有位。适合的值`int`将补码运算符应用于 type `int`，但结果将符号扩展为`long`，设置高位。太大的值`unsigned int`会将补码运算符应用于 type `long`。但是，介于这些大小之间的值会将补码运算符应用于 type `unsigned int`，然后将其转换为`long`没有符号扩展的 type 。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2012-12-12T02:26:58.753

正如其他人所提到的，-1 是创建整数的正确方法，该整数将转换为所有位都设置为 1 的无符号类型。但是，C++ 中最重要的是使用正确的类型。因此，您的问题的正确答案（包括您提出的问题的答案）是这样的：

```
std::bitset<32> const flags(-1); 
```

这将始终包含您需要的确切位数。`std::bitset`出于其他答案中提到的相同原因，它构造了所有位设置为 1 的 a 。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-04-30T21:40:28.747

这当然是安全的，因为 -1 将始终设置所有可用位，但我更喜欢 ~0。-1 对于`unsigned int`. `0xFF`...不好，因为它取决于类型的宽度。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-04-30T21:41:52.237

实际上：是的

理论上：不会。

-1 = 0xFFFFFFFF（或您平台上的任何大小的 int）仅适用于二进制补码算法。在实践中，它会起作用，但是那里有遗留机器（IBM 大型机等），你有一个实际的符号位而不是二进制补码表示。您提出的 ~0 解决方案应该适用于任何地方。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2010-10-11T11:28:57.730

我说：

```
int x;
memset(&x, 0xFF, sizeof(int)); 
```

这将始终为您提供所需的结果。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-02-05T10:35:41.967

**另一个努力要强调的是，为什么 Adrian McCarthy 的方法可能是自 C++11 以来在标准一致性、类型安全/显式清晰性和减少可能的歧义之间的折衷方面的最佳解决方案：**

```
unsigned int flagsPreCpp11 = ~static_cast<unsigned int>(0);
auto flags = ~static_cast<unsigned int>(0); // C++11 initialization
predeclaredflags = ~static_cast<decltype(predeclaredflags)>(0); // C++11 assignment to already declared variable 
```

我将在下面详细解释我的偏好。正如约翰内斯完全正确地提到的那样，这里激怒的根本原因是关于值与根据位表示语义以及我们正在谈论的确切类型（分配的值类型与可能的编译时间积分常量的类型）的问题。由于没有标准的内置机制来明确确保对于 OP 关于无符号整数值的具体用例将所有位设置为 1，因此很明显，这里不可能完全独立于值语义（std::bitset是一个常见的纯位层引用容器，但问题一般是关于无符号整数）。但我们也许可以减少这里的歧义。

**“更好”的符合标准的方法的比较：**

*OP的方式：*

```
unsigned int flags = -1; 
```

优点：

*   是“成立的”并且很短
*   就“自然”位值表示的取模角度而言，非常直观
*   例如，可以将目标无符号类型更改为无符号长，无需任何进一步的调整

缺点：

*   至少初学者可能不确定标准的一致性（“我必须关心填充位吗？”）。
*   违反类型范围（以较重的方式：有符号与无符号）。
*   仅从代码中，您不会直接看到任何位语义关联。

*通过定义参考最大值：*

```
unsigned int flags = UINT_MAX; 
```

这规避了 -1 方法的有符号无符号转换问题，但引入了几个新问题：如果您想将目标类型更改为无符号长整数，则必须再次查看这里两次。在这里，必须确定这样一个事实，即最大值导致标准将所有位设置为 1（以及再次填充位问题）。位语义在这里也不是很明显，直接来自代码。

*更明确地引用最大值：*

```
auto flags = std::numeric_limits<unsigned int>::max(); 
```

在我看来，这是更好的最大值方法，因为它是免费的宏/定义，并且对所涉及的类型是明确的。但是关于方法类型本身的所有其他问题仍然存在。

*Adrian 的方法（以及为什么我认为它是 C++11 之前的首选方法）：*

```
unsigned int flagsPreCpp11 = ~static_cast<unsigned int>(0);
auto flagsCpp11 = ~static_cast<unsigned int>(0); 
```

优点：

*   仅使用最简单的整数编译时间常数：0。因此不必担心进一步的位表示或（隐式）强制转换。从直观的角度来看，我认为我们都可以同意这样一个事实，即零的位表示通常比最大值更清晰，不仅仅是无符号整数。
*   不涉及类型歧义，无需进一步查找有疑问。
*   这里通过补码 ~ 涉及显式位语义。所以从代码中可以很清楚地看出意图是什么。它也非常明确，在哪种类型和类型范围上应用补码。

缺点：

例如，如果分配给一个成员，那么您很有可能将类型与 C++11 之前的类型不匹配：

课堂声明：

```
unsigned long m_flags; 
```

构造函数中的初始化：

```
m_flags(~static_cast<unsigned int>(0)) 
```

但是从 C++11 开始，使用 decltype + auto 非常强大，可以防止大多数可能出现的问题。并且这些类型不匹配的场景中的一些（例如在接口边界上）对于 -1 方法也是可能的。

*用于预声明变量的强大的最终 C++11 方法：*

```
m_flags(~static_cast<decltype(m_flags)>(0)) // member initialization case 
```

因此，在这里全面了解所有方法的优缺点的权重，我推荐这种方法作为首选方法，最迟从 C++11 开始。

更新：感谢 Andrew Henle 的提示，我删除了关于其可读性的声明，因为这可能是一个过于主观的声明。但我仍然认为，它的可读性至少不比大多数最大值方法或那些通过编译时积分/文字明确提供最大值的方法差，因为 static_cast-usage 也“建立”并且内置于定义/宏，甚至是标准库。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2019-04-11T15:47:52.177

一种使含义更明显但又避免重复类型的方法：

```
const auto flags = static_cast<unsigned int>(-1); 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2016-10-06T14:11:35.343

利用将所有位分配给无符号类型的事实等价于获取给定类型的最大可能值，
并将问题的范围扩展到所有*无符号*整数类型：

[分配 -1 适用于 C 和 C++ 的任何*无符号*整数类型](https://stackoverflow.com/a/39865015/2436175)（无符号整数、uint8_t、uint16_t 等）。

作为替代方案，对于 C++，您可以：

1.  包括`<limits>`和使用`std::numeric_limits< your_type >::max()`
2.  编写一个[自定义模板函数](https://stackoverflow.com/a/39878362/2436175)（这也将允许进行一些完整性检查，即目标类型是否真的是无符号类型）

目的可能是增加清晰度，因为分配`-1`总是需要一些解释性评论。

* * *

## 回答 #21

> 赞同：-6
> 
> 时间：2010-10-11T09:22:38.597

是的，所显示的表示非常正确，就像我们以相反的方式进行操作一样，您将需要运算符来反转所有位，但是在这种情况下，如果我们考虑机器中整数的大小，则逻辑非常简单

例如，在大多数机器中，整数是 2 字节 = 16 位，它可以容纳的最大值是 2^16-1=65535 2^16=65536

0%65536=0 -1%65536=65535 对应于 1111.............1 并且所有位都设置为 1（如果我们考虑残基类 mod 65536）因此它很多直截了当。

我猜

不，如果你考虑这个概念，它非常适合无符号整数，它实际上可以解决

只需检查以下程序片段

int main() {

```
unsigned int a=2;

cout<<(unsigned int)pow(double(a),double(sizeof(a)*8));

unsigned int b=-1;

cout<<"\n"<<b;

getchar();

return 0; 
```

}

b = 4294967295 的答案在 4 字节整数上是 -1%2^32

因此它对无符号整数完全有效

如有任何差异请报告

# asp.net - 将 BoundField 插入 DetailsView

> ID：809235
> 
> 赞同：0
> 
> 时间：2009-04-30T21:38:45.350
> 
> 标签：asp.net, dynamic, hide, code-behind, detailsview

基本上我有一个详细信息视图，取决于它是什么查询，我有某些我想显示或隐藏的 BoundFields。

使用visual basic，我知道我可以使用.visible = false。这样做可以解决问题，但是，它在此过程中牺牲了我的交替行样式。

有任何想法吗？

谢谢

顺便说一句，如果你用 C# 编写它，我可能会明白。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-12-10T15:36:33.303

您需要做的是创建几个 asp:panel 对象。在每个面板对象中，放置一个 DetailsView。在您的代码隐藏中，您将希望显示包含适合查询的详细信息视图的面板，并隐藏其余面板。

# java - MyEclipse+Hibernate 不按 ID 对属性集进行排序？

> ID：809243
> 
> 赞同：0
> 
> 时间：2009-04-30T21:40:59.573
> 
> 标签：java, hibernate, myeclipse

我将 Hibernate 与 Java 一起使用。

我有两个与外键关联的表。

```
表：国家
字段：ID、名称
POJO 类名：国家
POJO 类属性：id、name、city

表：城市
字段：ID、名称、CountryID
POJO 类名：国家

```

然后我使用 MyEclipse 的“休眠逆向工程”。它自动创建 DAO、摘要和 pojo 类。

一切都很好。当我请求一个 Country 对象时，Hibernate 检索它并用 CountryID 作为 country.id 的城市填充属性“城市”。

一切都很好，但是当我列出“城市”属性（java Set 类型）时，然后打印出所有城市的 ID，我得到了这个无序列表：

```
编号：5
编号：1
编号：4
编号：2

```

当我从 CountryDAO 类获取 Country 实例时，我应该在哪里编辑以获取按 ID 排序的城市？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-30T22:57:51.150

您可以尝试使用 Hibernate 的 Criteria API 来提供这样的约束。以下文章将按 id 升序对帖子进行排序。

```
List posts = session.createCriteria(Post.class)
    .addOrder( Order.asc("id") )
    .list(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-30T21:47:00.400

您使用的是 XML 映射还是注释？

通常，在映射集合上有一个“order-by”属性，可让您指定一个列来对集合进行排序，以及 asc 或 desc 排序。

请参阅此页面：

[http://docs.jboss.org/hibernate/stable/core/reference/en/html/collections-mapping.html](http://docs.jboss.org/hibernate/stable/core/reference/en/html/collections-mapping.html)

搜索“order-by” - 您需要为您的示例找到合适的集合映射。

# c# - 使用 C# 在 SQLite 中添加参数

> ID：809246
> 
> 赞同：27
> 
> 时间：2009-04-30T21:41:27.170
> 
> 标签：c#, sqlite, system.data.sqlite

我刚刚学习 SQLite，我无法让我的参数正确编译到命令中。当我执行以下代码时：

```
this.command.CommandText = "INSERT INTO [StringData] VALUE (?,?)";

this.data = new SQLiteParameter();
this.byteIndex = new SQLiteParameter();

this.command.Parameters.Add(this.data);
this.command.Parameters.Add(this.byteIndex);

this.data.Value = data.Data;
this.byteIndex.Value = data.ByteIndex;

this.command.ExecuteNonQuery(); 
```

我得到一个 SQLite 异常。在检查 CommandText 后，我​​发现无论我在做什么都没有正确添加参数：`INSERT INTO [StringData] VALUE (?,?)`

有什么我想念的想法吗？

谢谢

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2009-04-30T21:48:22.427

尝试不同的方法，命名查询中的字段并命名查询中的参数：

```
this.command.CommandText = "INSERT INTO StringData (field1, field2) VALUES(@param1, @param2)";
this.command.CommandType = CommandType.Text;
this.command.Parameters.Add(new SQLiteParameter("@param1", data.Data));
this.command.Parameters.Add(new SQLiteParameter("@param2", data.ByteIndex));
... 
```

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-04-30T21:47:01.447

尝试`VALUES`代替`VALUE`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-09-14T21:09:55.280

```
var connectionstring = "Data Source=" + Environment.CurrentDirectory + "\\game.db";
using (var connection = new SqliteConnection(connectionString))
{
    var insertCmd = connection.CreateCommand();
    insertCmd.CommandText = "INSERT INTO Results(result, win) VALUES (@prizes, @win)";
    insertCmd.Parameters.AddWithValue("prizes", prizes);
    insertCmd.Parameters.AddWithValue("win", winAmount);
    insertCmd.ExecuteNonQuery();
} 
```

# oracle - Oracle：序列 MySequence.currval 尚未在此会话中定义

> ID：809247
> 
> 赞同：47
> 
> 时间：2009-04-30T21:41:37.760
> 
> 标签：oracle, sequence

这是什么意思，我该如何解决？

```
SELECT MySequence.CURRVAL FROM DUAL; 
```

结果：

> ORA-08002: 序列 MySequence.CURRVAL 尚未在此会话中定义

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2009-05-01T10:35:13.487

mysequence.CURRVAL 返回从会话中的序列 mysequence 获得的最新值，因此直到**您**在会话中至少使用一次 mysequence.NEXTVAL 获得一个值后才定义。CURRVAL 的目的是让您在代码中多次使用序列值，例如

```
insert into parent (parent_id, ...) values (mysequence.NEXTVAL, ...);

insert into child (parent_id, ...) values (mysequence.CURRVAL, ...); 
```

**如果 CURRVAL 只是返回任何**会话从序列中获取的最后一个值，那么在上面的代码中它是没有用的，实际上可能导致数据损坏！

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-04-30T21:44:30.843

事实证明，在会话中至少使用一次 NEXTVAL 之前，您不能使用 CURRVAL。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2010-03-04T21:50:07.857

用这个

```
select sequence_name, 
   to_char(min_value) min_value,
   to_char(max_value) max_value, 
   increment_by,
   cycle_flag, 
   order_flag, 
   cache_size, 
   to_char(Last_number) last_number
from user_sequences
where sequence_name='MYSEQUENCE' 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-01T07:34:25.730

道格，

真正的问题是，当您在会话中没有使用 nextval 时，为什么需要 currval？您可以查看 USER/ALL/DBA_SEQUENCES 视图的 LAST_NUMBER 列，但是当您开始使用它时要考虑并发问题。

问候，罗布。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-02-05T06:08:48.750

```
select * from user_sequences     where sequence_name='SEQ_V_WORKORDER_RECNO'; 
```

在上面的查询中，`SEQ_V_WORKORDER_RECNO`我的序列名称将其替换为您的序列名称

# php - PHP 列出动态成员变量

> ID：809250
> 
> 赞同：1
> 
> 时间：2009-04-30T21:42:25.450
> 
> 标签：php, oop, dynamic, object

鉴于我们一开始不知道变量名称，我将如何列出实例化对象中的所有公共变量？

场景
一个类可能有一个声明如下的函数：

```
function addVar($name, $val) {
    $this->$name = $val;
} 
```

我想要一个动态添加到对象实例的 $names 列表。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-30T21:48:20.320

[`get_object_vars()`](http://php.net/manual/en/function.get-object-vars.php)应该做的伎俩。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T23:38:47.747

此外，我建议您查看[PHP 的反射](http://www.php.net/manual/en/language.oop5.reflection.php)功能。

# database - 用于标记项目的良好架构

> ID：809256
> 
> 赞同：0
> 
> 时间：2009-04-30T21:43:13.700
> 
> 标签：database, performance, tags

> ### 重复：[您如何建议实施标签或标记](https://stackoverflow.com/questions/20856/how-do-you-recommend-implementing-tags-or-tagging)

什么是标签系统（例如帖子或照片）的高效、快速和优雅的架构。例如，您有一个像 StackOverflow 这样的网站，每个项目都有几个标签。跟踪这些并使其可搜索的最佳方法是什么。可扩展性也很重要。

* * *

每个项目都有一个“标签”列。因此，在该项目行的数据库中，您有带有所有标签“tag1 tag2 tag3 keyword anothertag etc”的字符串。然后您可以在该列上允许全文搜索索引。

* * *

有一个标签表。它在哪里映射“tag”：“item_id”。这将使搜索更快...您可以搜索 tag=keyowrd 并获取所有 item_id 的列表。

* * *

这两个似乎都是显而易见的解决方案，但对于非常非常大的数据集，似乎是一种非常低效的方法。有什么想法或其他方法来实现标记系统？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-30T21:46:52.570

这将有助于阅读 [http://www.pui.ch/phred/archives/2005/04/tags-database-schemas.html](http://www.pui.ch/phred/archives/2005/04/tags-database-schemas.html)

# c# - 如何以编程方式修改 app.config 中的 assemblyBinding？

> ID：809262
> 
> 赞同：10
> 
> 时间：2009-04-30T21:45:28.970
> 
> 标签：c#, xml, configuration, configuration-files, xmldocument

我试图通过使用 XmlDocument 类并直接修改值来在安装时更改 bindingRedirect 元素。这是我的 app.config 的样子：

```
<configuration>
    <configSections>
        <sectionGroup name="applicationSettings" type="System.Configuration.ApplicationSettingsGroup, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">            
            ...
        </sectionGroup>      
    </configSections>
    <runtime>
      <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
        <dependentAssembly>
          <assemblyIdentity name="MyDll" publicKeyToken="31bfe856bd364e35"/>
          <bindingRedirect oldVersion="0.7" newVersion="1.0"/>
        </dependentAssembly>
     </assemblyBinding>
    </runtime>    
...
</configuration> 
```

然后我尝试使用以下代码将 1.0 更改为 2.0

```
private void SetRuntimeBinding(string path, string value)
{
    XmlDocument xml = new XmlDocument();

    xml.Load(Path.Combine(path, "MyApp.exe.config"));
    XmlNode root = xml.DocumentElement;

    if (root == null)
    {
        return;
    }

    XmlNode node = root.SelectSingleNode("/configuration/runtime/assemblyBinding/dependentAssembly/bindingRedirect/@newVersion");

    if (node == null)
    {
        throw (new Exception("not found"));
    }

    node.Value = value;

    xml.Save(Path.Combine(path, "MyApp.exe.config"));
} 
```

但是，它会引发“未找到”异常。如果我将路径备份到 /configuration/runtime 它可以工作。但是，一旦我添加了 assemblyBinding，它就找不到节点。可能这与 xmlns 有关吗？知道如何修改吗？ConfigurationManager 也无权访问此部分。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-01T00:04:56.480

我找到了我需要的东西。XmlNamespaceManager 是必需的，因为 assemblyBinding 节点包含 xmlns 属性。我修改了代码以使用它并且它可以工作：

```
 private void SetRuntimeBinding(string path, string value)
    {
        XmlDocument doc = new XmlDocument();

        try
        {
            doc.Load(Path.Combine(path, "MyApp.exe.config"));
        }
        catch (FileNotFoundException)
        {
            return;
        }

        XmlNamespaceManager manager = new XmlNamespaceManager(doc.NameTable);
        manager.AddNamespace("bindings", "urn:schemas-microsoft-com:asm.v1");

        XmlNode root = doc.DocumentElement;

        XmlNode node = root.SelectSingleNode("//bindings:bindingRedirect", manager);

        if (node == null)
        {
            throw (new Exception("Invalid Configuration File"));
        }

        node = node.SelectSingleNode("@newVersion");

        if (node == null)
        {
            throw (new Exception("Invalid Configuration File"));
        }

        node.Value = value;

        doc.Save(Path.Combine(path, "MyApp.exe.config"));
    } 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2010-02-26T20:40:53.080

听起来您现在已经对配置文件进行了调整，但我认为您可能仍然对如何在运行时调整绑定重定向感兴趣。关键是要使用[AppDomain.AssemblyResolve](http://msdn.microsoft.com/en-us/library/system.appdomain.assemblyresolve.aspx)事件，详情在[这个答案](https://stackoverflow.com/questions/1460271/how-to-use-assembly-binding-redirection-to-ignore-revision-and-build-numbers/2344624#2344624)中。我更喜欢它而不是使用配置文件，因为我的版本号比较可能更复杂一些，而且我不必在每次构建期间调整配置文件。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-30T22:30:08.470

我认为正确的 Xpath 语法是：

/configuration/runtime/assemblyBinding/dependentAssembly/bindingRedirect@newVersion

（你的斜线太多了）。

或者，如果这不起作用，您可以选择 bindingRedirect 元素（使用 SelectSingleNode）：

/configuration/runtime/assemblyBinding/dependentAssembly/bindingRedirect

然后修改这个元素的属性newVersion。

# xml - Linq to XML - 将二进制数据写入 XML 的方法

> ID：809266
> 
> 赞同：0
> 
> 时间：2009-04-30T21:46:38.577
> 
> 标签：xml, linq

如何使用从寄存器读取的 LINQ 将二进制数据写入 XML。

例如：Î®ì\ÎQÝÜ$Ñ.Ì6Å·xxµ0©ÐQfô:S9}:&......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-30T21:50:29.330

使用 Base64 编码之类的东西将二进制文件转换为 XML 可接受的字符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-30T21:50:48.800

我认为最简单的方法是对数据进行base64编码，然后将其设置为元素文本。应该让你开始[`Convert.ToBase64String`](http://msdn.microsoft.com/en-us/library/system.convert.tobase64string.aspx)。[`Convert.FromBase64String`](http://msdn.microsoft.com/en-us/library/system.convert.frombase64string.aspx)

# database-design - 如果要进行复制，为什么 GUID 是 PK 的最佳选择？

> ID：809276
> 
> 赞同：3
> 
> 时间：2009-04-30T21:48:52.033
> 
> 标签：database-design, primary-key, replication, guid

我正在构建一个带有 Oracle 后端的 Intranet Web 应用程序。出于对本讨论不重要的原因，Oracle DB 将被复制到另一台服务器上。我有理由确定我们将使用 Oracle Basic Replication，而不是 Advanced。

有人可以向我解释为什么围绕主键的大多数讨论都类似于：

*   在 99% 的情况下，对 PK 使用自动递增的整数就可以了
*   除非您正在进行复制。然后为您的 PK 使用 GUID。

似乎没有人解释为什么复制异常，我不明白为什么。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-30T21:50:04.730

我相信仅当两台服务器都将接收新数据时，复制的 GUID 参数才真正适用。然后您不希望新行发生冲突，因此使用 GUID 作为 PK - 复制可以双向进行。

我们一直在复制自增表，但这是一个严格的主/从复制，其中数据只写入主控。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-30T22:00:15.487

一个字：合并

合并复制可以工作的唯一方法是，如果所有“主”框都可以创建一个新密钥，而不会与其他密钥冲突。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-30T22:01:39.460

如果您考虑当两台服务器相互复制并在同步之间添加数据时会发生什么，问题就变得很明显：

```
Time  Server  NewID
001   A       1
002   A       2
003 <sync of server A and B>
004   A       3
005   B       3
006 <sync of server A and B> 
```

<---两个不同的记录现在有相同的ID，所以有冲突！

# c++ - C++ 并发 GET 请求

> ID：809289
> 
> 赞同：2
> 
> 时间：2009-04-30T21:51:15.320
> 
> 标签：c++, http, concurrency, networking, get

我正在编写一个 C++ 应用程序，并希望通过 HTTP GET 请求同时请求多个数据文件，我应该从哪里开始（需要跨平台）。

1.  运行应用程序
2.  创建 URL 列表 { " [http://host/file1.txt](http://host/file1.txt) ", " [http://host/file2.txt](http://host/file2.txt) ", " [http://host/file3.txt](http://host/file3.txt) "}
3.  同时请求所有 URL 并将内容加载到变量中（不希望磁盘写入）。每个文件有大约 10kB 的数据。

你会推荐我使用哪些库？库库尔？卷曲？提升 asio? 我需要滚动我自己的多线程来同时请求所有文件吗？有没有更简单的方法？

编辑：我需要同时请求大约 1000 个 GET 请求。我很可能会分批执行此操作（一次 100 个，并在完成后创建更多连接）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-30T21:58:41.450

我会推荐[libcurl](http://curl.haxx.se/)。我对它不是很熟悉，但它确实有一个用于执行多个同时 HTTP 操作的[多接口。](http://curl.haxx.se/libcurl/c/libcurl-multi.html)

根据您使用的解决方案，可以在不使用多线程的情况下进行异步 I/O。关键是使用[`select(2)`](http://linux.die.net/man/2/select)系统调用。 `select()`获取一组文件描述符并告诉您其中是否有可用数据。如果他们这样做，您可以继续使用`read(2)`或`recv(2)`在它们上，而不必担心阻塞。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-30T22:13:55.763

Web 浏览器通常维护一个工作线程池来进行下载，并在它们变得免费时将下载分配给它们。IIRC HTTP RFC 关于您应该同时与同一服务器建立多少个同时连接有话要说：太多是粗鲁的。

如果多个请求发往同一台服务器，并且它支持 keep-alive（几乎每个人都这样做），那么这可能比同时发送多个请求向它发送垃圾邮件更好。一般的想法是您使用一个 TCP/IP 连接来处理多个串行请求，从而节省握手开销。根据我实现 Java HTTPConnection 类的经验，实际结果是引入了一个微妙的错误，即当您将连接重新用于新请求时并不总是正确清除状态，并且花费大量时间盯着日志记录/嗅探器数据 ;-）

libcurl 当然支持keepalive（我认为默认启用）。

# sql - SQl 从表中删除前 100 个

> ID：809294
> 
> 赞同：9
> 
> 时间：2009-04-30T21:53:43.380
> 
> 标签：sql

我正在尝试删除表中除了最近的 3,000 个项目之外的所有项目。该表有 105,000 条记录。

我正在尝试这个，但是会生成错误语法不正确。

```
delete tRealtyTrac where creation in( select top 103000 from tRealtyTrac order by creation) 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-30T21:58:14.680

删除语法将与您所拥有的略有不同。一个例子是：

```
DELETE FROM tRealtyTrac
WHERE creation in( select top 103000 creation from tRealtyTrac order by creation) 
```

注意“from”关键字是如何存在的。这表示我们要从名为 tRealtyTrac 的表中删除

我预见到的一个问题是，您可能不想使用创建...

反而：

```
DELETE FROM tRealtyTrac
WHERE someuniqueidcolumnlikeakeyofsomesort in( select top 103000 someuniqueidcolumnlikeakeyofsomesort from tRealtyTrac order by creation) 
```

否则，您可能会删除超出预期的内容。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-30T21:56:13.810

内部查询需要是：

从...中选择前 103000 个**创作**

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-09-24T14:01:01.653

对我来说，CTE 是有序删除的更好解决方案

```
;WITH records_delete AS (
    select top 103000 creation 
    from tRealtyTrac 
    order by creation)
DELETE records_delete 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-30T21:57:36.600

一个超级简单的方法来做到这一点：

1.  从 tRealtyTrac order by creation desc 中选择前 3001

2.  取最后一个日期，然后删除 tRealtyTrac where creation < 'thedateyoufound'

但安迪也有一个好主意。;)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-30T22:04:25.337

试试这个：

```
DELETE FROM tRealtyTrac WHERE creation IN (SELECT top 103000  * FROM tRealtyTrac ORDER by creation) 
```

您忘记了 tRealtyTrac 中的字段（我使用星号选择所有字段，但您可以列出它们或仅列出一个）。您还忘记了 FROM 子句。

# c# - 使用 ac# 类中的字符/字符串/字节流向 java 提供数据

> ID：809295
> 
> 赞同：0
> 
> 时间：2009-04-30T21:54:24.300
> 
> 标签：c#, java, oledb

我想在 ac# 类中使用函数/方法（我希望尽可能少的延迟！）运行一个 java 应用程序...... c# 函数从 java 应用程序中获取一个字符串，并返回一个字符串.. 有在 c# 中执行此操作以在 Windows 中创建 OleDbConnection ..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-30T22:02:07.960

我不确定你到底需要什么。

如果您需要从 C# 内部调用 Java 代码，您可以尝试[IKVM](http://www.ikvm.net/)。

如果您需要启动一个独立的 Java 应用程序，请使用任何 .NET 来生成子进程。

如果您使用 C# 的唯一原因是 OleDbConnection，您可以查看您需要联系的数据库是否有 Java 驱动程序。或 ODBC 驱动程序，并使用 JDBC/ODBC 桥。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-31T19:45:59.647

我是[jni4net](http://jni4net.sf.net/)的作者，它是 JVM 和 CLR 之间的开源进程间桥梁。它建立在 JNI 和 PInvoke 之上。无需 C/C++ 代码。我希望它会帮助你。

# django - 搜索引擎和将静态站点迁移到 Web 应用程序

> ID：809297
> 
> 赞同：3
> 
> 时间：2009-04-30T21:55:47.027
> 
> 标签：django, search-engine, web-applications

我们正在用 Django 应用程序替换静态网站。所有的uri都会改变。当前的网站在搜索引擎排名中占有重要地位，我们不想把它搞砸太多。是否只是将 301 重定向设置为新 uri 的情况，还是我们需要做一些更微妙的事情来确保搜索引擎了解发生了什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-01T00:41:49.543

通常，当您更改网站时，您的搜索结果页面排名会受到影响，这将持续大约 2-4 周。

Apex Internet 有一篇关于在 Apache、IIS 和其他变体上设置 301 重定向的好文章。看看[这里](http://www.apexinternet.co.nz/blog/How-to-setup-a-301-Permanent-Redirect/)。

Steven Hargrove 在这里也有一篇很好的文章，并[在此处](http://www.stevenhargrove.com/redirect-web-pages/comment-page-20/)进行了跟进。

此外，Webmaster World 在 Google、Yahoo 和其他网站上发布了关于 301 更新的影响的帖子，以及一些提示和更多建议。看看[这里](http://www.webmasterworld.com/google/3452276.htm)。

最后[，这里](http://googlewebmastercentral.blogspot.com/2008/09/dynamic-urls-vs-static-urls.html)有一篇来自 Google Groups 的关于动态与静态 URL 的文章，其中涉及不断变化的结构及其映射方式。

我希望我能为您提供更多信息，以及在您开始迁移时使用 robots.txt 文件帮助保持排名的方法。我会继续寻找，看看我能为你找到什么。干杯和好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T22:30:44.693

301 实际上应该涵盖它。

搜索引擎通常很擅长这一点:)

# http - 查看响应标头的工具

> ID：809302
> 
> 赞同：52
> 
> 时间：2009-04-30T21:56:31.453
> 
> 标签：http, browser, networking, http-headers

从针对特定 URL 的请求中查看 HTTP 响应标头的最佳方法是什么？Telnet 还是有其他一些非常好的命令或工具？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-04-30T21:58:33.040

我发现[Fiddler](http://www.fiddler2.com/fiddler2/)是我的首选武器，尽管也有 firefox 插件。Fiddler 将向您显示所有 HTTP 请求、它们的响应状态、所有标头、不同视图（原始、十六进制、图像）、时间线视图、HTTPS 连接等所有内容。

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2009-04-30T22:10:23.060

我使用[httpfox](https://addons.mozilla.org/en-US/firefox/addon/6647) Firefox 扩展来查看在我指定的时间间隔内从 Web 浏览器发起的所有 HTTP 请求和响应（包括标题和正文）（通过按下开始录制和停止录制按钮）。httpfox 以结构化的方式呈现数据，我可以快速找到我感兴趣的请求。它很好地补充了 LiveHTTPHeaders，因为 httpfox 也可以查看过去的请求。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2009-04-30T21:59:00.497

在 Linux 上，我使用：

```
wget -S [url] 
```

这将获取文件并显示服务器发送的所有标头。

在 Windows 上，如果安装了 Cygwin，则可以使用相同的命令；在常规命令提示符下，如果环境变量已正确调整，或通过 Cygwin 命令窗口。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2009-04-30T22:13:56.093

*   [Firefox 的HttpFox](https://addons.mozilla.org/en-US/firefox/addon/6647)相当不错。它将实时显示标题。我更喜欢[Live HTTP Headers](https://addons.mozilla.org/en-US/firefox/addon/3829)。
*   [Microsoft Fiddler](http://www.ieaddons.com/en/details/other/Microsoft_Fiddler/) for Internet Explorer 是一个 Web 调试器，它记录您的计算机和 Internet 之间的所有 HTTP 流量。Fiddler 允许您检查所有 HTTP 流量、设置断点以及处理传入或传出数据
*   [Wireshark](http://www.wireshark.org/)是一个完整的网络协议分析器。这很好，但如果只需要 HTTP 标头，那可能就有点过头了。如果客户端和服务器在同一台机器上，就会出现问题。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2013-03-03T22:47:13.943

使用最新版本的 Firefox（在我的情况下为 19.0），转到菜单*工具*-> *Web 开发人员*-> *Web 控制台*（在 Windows 上为`Ctrl`+ `Shift`+ `K`），然后刷新页面会生成请求日志。

然后单击第一个 GET 请求，即带有页面 URL 的请求，打开一个包含有关它的信息的框，包括请求和响应标头。它开箱即用，不再需要花哨的附加组件。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2013-02-23T15:21:31.577

查看[httpie](https://github.com/jkbr/httpie)，一个非常好的 Python 工具： ![在此处输入图像描述](https://i.stack.imgur.com/vSllz.png)

您可以使用该`--headers`选项仅查看标题：

![在此处输入图像描述](https://i.stack.imgur.com/rhjak.png)

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-04-30T21:58:14.540

Firefox的[Firebug](http://en.wikipedia.org/wiki/Firebug_%28software%29)插件是我认为最简单的方法。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-04-30T22:00:01.010

对于 Internet Explorer，[Fiddler](http://www.ieaddons.com/en/details/other/Microsoft_Fiddler/)可以工作。[或者你可以用Wireshark](http://en.wikipedia.org/wiki/Wireshark)全力以赴。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-04-30T22:10:43.417

有更好的选择（在我看来）

这是一个名为 HTTPfox 的 Firefox 扩展。您不仅可以看到标题，还可以看到更多信息。这是一个非常完整的 HTTP 分析器

[https://addons.mozilla.org/en-US/firefox/addon/6647](https://addons.mozilla.org/en-US/firefox/addon/6647)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2013-03-01T02:03:33.893

如果您熟悉浏览器中的开发人员工具，请打开开发人员工具上的网络选项卡，刷新页面，然后单击标题选项卡。将列出响应标头。例如，此页面发送此标头：

```
HTTP/1.1 200 正常
缓存控制：公共，最大年龄=60
内容类型：文本/html；字符集=utf-8
内容编码：gzip
过期：格林威治标准时间 2013 年 3 月 1 日星期五 02:00:20
最后修改时间：格林威治标准时间 2013 年 3 月 1 日星期五 01:59:20
各不相同： *
X 框架选项：SAMEORIGIN
日期：格林威治标准时间 2013 年 3 月 1 日星期五 01:59:19
内容长度：13555

```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-30T22:07:16.280

我为 Firefox 找到了一个很好的工具，叫做[Live HTTP Headers](https://addons.mozilla.org/en-US/firefox/addon/3829)。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-11-02T23:55:33.740

[burpsuite](http://portswigger.net/burp/download.html)是一个免费工具，基于 Java，可在所有平台上运行。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-12-19T15:03:29.627

Chris Pederick有一个很棒的插件/插件/扩展，称为[Web Developer](http://chrispederick.com/work/web-developer/)。

它适用于 Chrome、Firefox 和 Opera，并具有强大的开发功能，还可以“查看响应标头”。您可以在“信息”选项卡中找到它。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-09-07T06:34:56.853

如果您不想在您的机器上执行此操作，您可以使用任意数量的在线应用程序为您执行此操作。

1.  [Rex Swain 的 HTTP 查看器](http://www.rexswain.com/cgi-bin/httpview.cgi)
2.  [http://web-sniffer.net/](http://web-sniffer.net/)：这个在应用层协议（HTTP/S）方面更灵活一些
3.  [Ask Apache](http://www.askapache.com/online-tools/http-headers-tool/)：这个可以让您自定义更多的请求。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2015-01-09T07:12:50.317

如果您正在寻找在线工具[View-Http-Request-and-Response-Headers](http://spdypage.com/view-http-request-and-response-header)很棒

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2015-03-19T15:31:34.833

在 Internet Explorer 上的开发人员工具中（按 F12），转到网络选项卡并按“开始捕获”。刷新页面，单击“转到详细视图”，您将获得请求和响应数据的非常好的概览。

# asp.net - ASP.NET MVC 模型绑定和验证问题

> ID：809305
> 
> 赞同：9
> 
> 时间：2009-04-30T21:57:06.337
> 
> 标签：asp.net, asp.net-mvc

在使用了所有示例和教程等之后，我正在尝试将 MVC 用于一个新项目。但是，我很难弄清楚某些事情应该在哪里发生。

例如，我有一个名为 Profile 的实体。该实体包含正常的配置文件类型内容以及 DateTime 类型的 DateOfBirth 属性。在 HTML 表单中，出生日期字段分为 3 个字段。现在，我知道我可以使用自定义模型绑定器来处理这个问题，但是如果输入的日期不是有效日期怎么办？我应该在模型活页夹中检查吗？我的所有验证都应该放在模型活页夹中吗？是否可以只在模型绑定器中验证一些内容并在控制器或模型本身中验证其余内容？

这是我现在拥有的代码，但它对我来说看起来不正确。看起来很脏或有异味。

```
namespace WebSite.Models
{
    public class ProfileModelBinder : IModelBinder
    {
        public object BindModel(ControllerContext controllerContext, ModelBindingContext bindingContext)
        {
            DateTime birthDate;

            var form = controllerContext.HttpContext.Request.Form;
            var state = controllerContext.Controller.ViewData.ModelState;

            var profile = new Profile();
            profile.FirstName = form["FirstName"];
            profile.LastName = form["LastName"];
            profile.Address = form["Address"];
            profile.Address2 = form["Address2"];
            profile.City = form["City"];
            profile.State = form["State"];
            profile.Zip = form["Zip"];
            profile.Phone = form["Phone"];
            profile.Email = form["Email"];
            profile.Created = DateTime.UtcNow;
            profile.IpAddress = controllerContext.HttpContext.Request.UserHostAddress;

            var dateTemp = string.Format("{0}/{1}/{2}",
                form["BirthMonth"], form["BirthDay"], form["BirthYear"]);

            if (string.IsNullOrEmpty(dateTemp))
                state.AddModelError("BirthDate", "Required");
            else if (!DateTime.TryParse(dateTemp, out birthDate))
                state.AddModelError("BirthDate", "Invalid");
            else
                profile.BirthDate = birthDate;

            return profile;
        }        
    }
} 
```

基于上面的示例代码，您将如何为 3 部分字段生成验证消息？在上述情况下，我使用了一个完全独立的键，它实际上并不对应于表单中的字段，因为我不希望在所有 3 个字段旁边出现错误消息。我只希望它出现在 Year 字段的右侧。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-02T01:19:14.937

我认为在模型绑定器中进行验证是合理的。正如 Craig 指出的那样，验证主要是您的业务领域的属性，但是：

1.  有时您的模型只是一个愚蠢的演示模型，而不是业务对象
2.  您可以使用多种机制将验证知识呈现到模型绑定器中。

托马斯给你一个#1的例子。

#2 的一个示例是当您使用属性（如 DataAnnotation 属性 [Required]）以声明方式描述验证知识，或将一些业务层验证服务注入自定义模型绑定器时。在这些情况下，模型绑定器是进行验证的理想场所。

话虽如此，模型绑定（查找、转换和混洗数据到对象）和验证（数据符合我们的规范）是两个独立的问题。您可能会争辩说它们应该是单独的阶段/组件/扩展点，但我们拥有我们所拥有的，尽管 DefaultModelBinder 对这两个职责做了一些区分。如果您只想为特定类型的对象提供一些验证，您可以从 DefaultModelBinder 派生并覆盖 OnPropertyValidating 方法以进行属性级别验证或 OnModelUpdated（如果需要整体视图）。

> 这是我现在拥有的代码，但它对我来说看起来不正确。看起来很脏或有异味。

对于您的特定代码，我会尝试仅为 DateTime 编写模型绑定器。默认模型绑定器可以处理绑定名字、姓氏等，并在它到达 Profile 上的 DateTime 属性时委托给您的自定义模型绑定器。此外，尝试在 bindingContext 中使用 valueProvider，而不是直接进入表单。这些东西可以给你更多的灵活性。

更多想法在这里：[ASP.NET MVC 模型绑定的 6 个技巧](http://odetocode.com/Blogs/scott/archive/2009/04/27/12788.aspx)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-01T23:22:13.237

有时模型是视图模型，而不是域模型。在这种情况下，您可以从分离这两者中受益，并设计视图模型以匹配您的视图。

现在您可以让视图模型验证输入并将三个字段解析为`DateTime`. 然后它可以更新域模型：

```
public ActionResult SomeAction(ViewModel vm)
{
    if (vm.IsValid)
    {
        var dm = repositoryOrSomething.GetDomainModel();
        vm.Update(dm);
    }

    // more code...
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-01T14:06:57.190

前几天我也遇到了同样的情况……下面是我的模型绑定代码。基本上它绑定了所有的日期时间？模型的字段到表单中的月/日/年字段（如果可能）所以，是的，我确实在此处添加了验证，因为这样做似乎很合适。

```
public class DateModelBinder : DefaultModelBinder  
    {

        protected override void BindProperty(ControllerContext controllerContext, ModelBindingContext bindingContext, System.ComponentModel.PropertyDescriptor propertyDescriptor)
        {

            if (propertyDescriptor.PropertyType == typeof(DateTime?))
            {
                string DateMonth = _GetDateValue(bindingContext, propertyDescriptor.Name + "Month");
                string DateDay = _GetDateValue(bindingContext, propertyDescriptor.Name + "Day");
                string DateYear = _GetDateValue(bindingContext, propertyDescriptor.Name + "Year");
                // Try to parse the date if we have at least a month, day or year
                if (!String.IsNullOrEmpty(DateMonth) || !String.IsNullOrEmpty(DateDay) || !String.IsNullOrEmpty(DateYear))
                {
                    DateTime fullDate;
                    CultureInfo enUS = new CultureInfo("en-US");
                    // If we can parse it, set the model property
                    if (DateTime.TryParse(DateMonth + "/" + DateDay + "/" + DateYear,
                                         enUS,
                                         DateTimeStyles.None, out fullDate))
                    {
                        SetProperty(controllerContext, bindingContext, propertyDescriptor, (DateTime?)fullDate);
                    }
                    // The date is invalid, so we need to add a model error
                    else
                    {
                        string ModelPropertyName = bindingContext.ModelName;
                        if(ModelPropertyName != "")
                        {
                            ModelPropertyName += ".";
                        }
                        ModelPropertyName += propertyDescriptor.Name;
                        bindingContext.ModelState.AddModelError(ModelPropertyName, "Invalid date supplied for " + propertyDescriptor.Name);
                    }
                }
                return;
            }
            base.BindProperty(controllerContext, bindingContext, propertyDescriptor);
        }

        // Get a property from binding context
        private string _GetDateValue(ModelBindingContext bindingContext, string key)
        {
            ValueProviderResult valueResult;
            bindingContext.ValueProvider.TryGetValue(bindingContext.ModelName + "." + key, out valueResult);
            //Didn't work? Try without the prefix if needed...  
            // && bindingContext.FallbackToEmptyPrefix == true
            if (valueResult == null)
            {
                bindingContext.ValueProvider.TryGetValue(key, out valueResult);
            }
            if (valueResult == null)
            {
                return null;
            }
            return (string)valueResult.ConvertTo(typeof(string));
        }

    } 
```

注意：我在 bindingContext.FallbackToEmptyPrefix 总是为假时遇到了一些问题......找不到任何有用的信息，但你明白了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T13:49:33.347

根据每个地方的功能，应在多个地方进行验证。例如，如果您的模型绑定器无法将提交的值找到正确的 DateTime 值，则绑定器可以添加模型状态错误。另一方面，如果您的业务逻辑要求日期在一定范围内，则不适合这样做并且模型绑定器；它应该在业务逻辑层。例如，如果无法将编辑模型转换为实体模型，控制器也可能会添加验证错误。

诸如 xVal 之类的验证框架使这变得更加简单。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-30T23:04:16.237

[http://www.asp.net/mvc](http://www.asp.net/mvc)站点上的[Contact Manager](http://www.asp.net/learn/mvc/tutorial-29-cs.aspx)示例应用程序很好地描述了将验证逻辑从控制器和模型分离到服务层。

读起来很好

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-12-20T15:06:12.907

我厌倦了创建只涉及我一英里范围内的部分领域模型的小型小型 ViewModel。

因此，我制定了自己的方法来解决这个问题。我的 ViewModel 是一个 typeOf DomainModel，我使用[自定义模型绑定器](https://stackoverflow.com/questions/19280598/best-way-to-do-partial-update-to-net-mvc-4-model) 来确保首先加载其身份属性 - 一旦设置了身份 - 它会触发 DomainModel.Load，并且绑定活动的其余部分基本上执行“合并”。

同样，当我的 ViewModel 被绑定时（例如，在表单 POST 上），在设置了包含 ID 的基本字段之后 - 它会立即从数据库加载域模型。我只需要想出替换 DefaultModelBinder 的方法。[我在 StackOverflow 上发布](https://stackoverflow.com/questions/19280598/best-way-to-do-partial-update-to-net-mvc-4-model)的自定义模型绑定器允许您控制属性的绑定顺序。

一旦我可以保证身份属性被绑定，（我的视图模型的内部监听身份设置器的完成）我触发我的域模型的加载，因为其余的属性被绑定，它们被覆盖，即“合并”进入加载的域模型。

基本上，我可以拥有我所有的各种剃刀视图，无论它们是公开 5 个表单字段还是模型的 50 个字段。所有这些都提交给一个看起来像这样的控制器操作（当然，我仍然在需要做适当的自定义业务时进行单独的操作东西..但重点是，我的控制器动作集中且简洁）

```
<HttpPost()>
<Authorize(Roles:="MYCOMPANY\activeDirRoleForEditing")>
Function Edit(<Http.FromBody()> ByVal mergedModel As OrderModel) As ActionResult
    'notice: NO loading logic here - it already happened during model binding
    'just do the right thing based upon resulting model state
    If Me.ModelState.IsValid Then

        mergedModel.SaveAndReload("MyServiceWebConfigKey")

        ViewBag.SuccessMessage = String.Format("You have successfully edited the order {0}", mergedModel.Id)

        Return View("Edit", mergedModel)
    Else
        ViewBag.ErrorText = String.Format("Order {0} not saved. Check for errors and correct.", mergedModel.Id)
        Return View("Edit", mergedModel)
    End If
End Function 
```

# c# - Windows Mobile - 只保持一个表单打开。最佳设计问题

> ID：809309
> 
> 赞同：1
> 
> 时间：2009-04-30T21:57:51.590
> 
> 标签：c#, .net, windows-mobile, compact-framework

所以我认为自己是 .Net 和 ASP.NET 专业人士，但我对 Windows Mobile 有点陌生（我的目标是 .net 3.5 CF 和 Windows Mobile 6）。

我正在创建一个具有 3-4 个表的数据驱动应用程序。我为每个表格创建了一个表格，允许用户搜索表格。

每个表单都从主表单继承，因此它们每个都有相同的菜单。

我的问题是如何确保只打开一个窗口。我想让用户进入菜单并选择一个将打开一个新表单的表格。我不希望用户打开每个表单，然后当他们完成时必须关闭 3 或 4 个窗口。这可能吗？如果是这样，我该怎么做？附带说明一下，有更好的方法可以做到这一点。我不希望我的所有逻辑都在一种形式上。所以我不只是想隐藏和显示和面板。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T22:14:42.237

我保留了一个我称之为应用程序中心的东西，但一切正常。

所以每次菜单点击都会调用应用程序中心，每个表单都会引用它。

然后，当切换表单时，应用程序中心需要跟踪当前表单，关闭它，然后加载请求的表单。

这不需要编写太多代码，并且性能良好。

或者...在性能方面，保持应用程序中心的理念，并保持对话框打开。这样会表现得更好，而不必一直重新加载表单。

然后在关闭时，应用程序中心可以检查哪些表单是打开的（它应该有对每个正在运行的表单的引用）并为用户关闭它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-30T23:29:20.640

您可以将表格内容放在 UserControls 上，而不是拥有多个表单（继承表单 mainForm），并且可以更轻松地完全控制它们的创建/销毁/可见性。使用接口或 BaseUserControl 来实现通用功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T21:03:07.540

这篇文章虽然不完全符合您的要求，但在我重新设计 .NET CF 应用程序时非常有用：[为 .NET Compact Framework 创建多表单应用程序框架](http://msdn.microsoft.com/en-us/library/aa446546.aspx)

我的应用程序需要两全其美——我想打开一个表单，但有时也想在第一个表单之上堆叠一个辅助表单（例如，如果他们转到 Prefs 页面或其他类型的表单应该只在片刻后将其关闭）。

（此后的伪编码）
我创建了一个 ViewManager 并将其实现为单例。当应用程序首次启动时，我调用 ViewManager.GotoForm(frm)。这会将当前形式设置为我需要的任何形式。然后我立即调用 ViewManager.CurrentForm.ShowDialog() - 我确信有更好的方法，但我发现我必须在某些时候调用 ShowDialog() 才能让表单出现。

对 ViewManager 的后续调用可以采用 .ReplaceForm 或 .StackForm 形式。差异应该是相当直观的。
您还可以在这样的视图管理器中执行的缓存表单不会显示，但可能会再次显示并且具有昂贵的设置成本（例如，在数据驱动的应用程序中，您可能必须查询数据库以确定要在表单上显示的字段或表格，并且在运行时不会更改）。

这里的诀窍是你永远不会在应用程序的任何地方调用 .Show() 或 .ShowDialog() - 你通过视图管理器路由所有表单导航，该管理器处理加载表单的下一个实例，处理旧表单（如果没有被缓存)，如果您想在表单加载之前将新数据传递到表单的 UI，则可以调度任何类型的填充逻辑。

# iis - 将 Firefox 3.0.x 配置为使用 Kerberos 进行身份验证而不提示

> ID：809317
> 
> 赞同：5
> 
> 时间：2009-04-30T21:59:41.663
> 
> 标签：iis, firefox, kerberos, intranet

我有一个 Intranet http 应用程序在我们 Windows 域中的几台机器上运行；使用 IE 7 时一切正常，因为我可以将其配置为使用 Kerberos 身份验证，并且我已经弄清楚如何让其中一台中间机器受信任以进行委派。

我已经研究并尝试让 Firefox 3.0.10 使用 Kerberos：

*   导航到 about:config
*   过滤到`network.negotiate`
*   更新`network.negotiate-auth.delegation-uris`并`network.negotiate-auth.trusted-uris` 使用以下条目（以逗号分隔）：`http://jupiter2000/trimbrokerclient,http://johnxp/fileservicedemo`

我已经这样做了，甚至重新启动了 Firefox，当我在我们的 LAN 上浏览上述网站时，仍然会提示输入用户名和密码，即使我提供了它们并加载了网页，我在应用程序中有一些代码显示有效的身份验证方法，它仍然是 NTLM，而不是使用 IE 时的 Kerberos。

有人可以评论如何让 Firefox 在我的这个 Intranet 应用程序上可用吗？谢谢你。

ps 虽然上面的名称不同，但应用程序是相同的。JUPITER2000 是 IIS 6.0；JOHNXP 是 IIS 5.1。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-30T22:29:20.970

根据我自己所做的，您只想输入域，而不是 http:// 或路径。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-12-30T14:23:11.917

在 FireFox 中有 5 个设置需要更改。只有域是必需的。

在这里看到它们：

[集成 Windows 身份验证的 FireFox 设置](http://blog.webonweboff.com/2010/12/integrated-windows-authentication-and.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-11-25T10:41:43.447

您必须只使用服务器名称：

jupiter2000，约翰XP

# javascript - 在rails中实现“无尽页面”的最佳方式？

> ID：809319
> 
> 赞同：6
> 
> 时间：2009-04-30T22:00:11.913
> 
> 标签：javascript, ruby-on-rails, pagination

分页很烂！用户应该能够永远向下滚动，在适当的时候自动拉入新内容。

对此有一个[不错的看法](http://railscasts.com/episodes/114-endless-page)，但 Ryan 承认他的解决方案在 IE 中不起作用。

在 Rails 中完成此任务的最佳方法是什么（最好以 jQuery 友好的方式）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T04:57:45.123

刚刚尝试了[jQuery.pageless](http://github.com/jney/jquery.pageless/tree/master)，它运行良好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-15T12:08:11.280

这是适用于 IE、Opera 和 FF 的 Rails 插件：http: [//bewhite.blogspot.com/2008/05/rails-endless-page-plugin.html](http://bewhite.blogspot.com/2008/05/rails-endless-page-plugin.html)

...和 ​​git 存储库：git://github.com/shine/endless_page

# c++ - 链接器错误：未定义的参考 C++

> ID：809324
> 
> 赞同：4
> 
> 时间：2009-04-30T22:01:50.723
> 
> 标签：c++, reference, linker, undefined

我尝试过查看类似的问题，但无法轻易找到对我的问题有帮助的问题。

我已经用 C++ 创建了一个项目，并且正在 UNIX 上编译、链接和运行它。我的具体问题是对我在单独文件中声明的方法的未定义引用。

在文件 SharedCache.cpp 中，我有以下方法：

```
int SharedCache::replaceLine(ullong address){
    int evictPID = -1;

    int cacheSet = calcCacheSet( address );
    //random uniformly-distributed value for cache line
    float numLines = static_cast<float>(CACHE_LINES_PER_SET);
    uint cacheLine = static_cast<uint>(uniformDistr( numLines ));

    if(cache[cacheSet][cacheLine] != NULL){
        evictPID = cache[cacheSet][cacheLine]->PID;
    }

    uint PID= calcPID(address);
    uint tag= calcTag(address);

    cache[cacheSet][cacheLine]->setLine(PID, tag); //mutex method

    return PID;
} 
```

该行`uint cacheLine = static_cast<uint>( uniformDistr( numLines ));`从另一个文件调用我想使用的函数。链接器错误是对此方法的未定义引用。

均匀分布（浮动）；在头文件distributions.h 中声明并在distributions.cpp 中定义。在我的项目选项中，我设置了链接器标志 -distributions 并且我还编译了 distributions.cpp 以确保存在可以链接的 distributions.o 文件。

从这里开始，我不知道该去哪里，因为这并没有解决问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-30T22:33:00.510

如果没有关于调用了哪些编译器/链接器命令以及确切的错误输出的更精确信息，很难提供一个好的答案。

但是，从您对所做操作的描述来看，您似乎没有传递`distributions.o`给链接器。与编译器/链接器自动搜索要链接的目标文件的其他语言不同，C++ 链接器需要明确指定要链接在一起的对象。

您在此处使用 -ldistributions 是不正确的：-l 标志用于链接到静态或动态*库*（在 Linux 上分别为 .a 和 .so 文件），而您想指定链接器应考虑的另一个*目标文件。*指定`-ldistributions`使链接器在标准库位置中查找`distributions.a`或查找。`distributions.so`

基本上，您的链接器调用现在看起来像这样（可能有更多的标志和库）：

```
gcc -o my_program SharedCache.o -ldistributions 
```

要正确链接发行版代码，您需要使其看起来像这样（同样，与真实的东西相比，许多标志和库可能缺失）：

```
gcc -o my_program SharedCache.o distributions.o 
```

这应该解决缺少符号的问题并产生一个工作二进制文件（或至少一个不同的错误;-)）。但是我不知道如何在 KDevelop 中执行此操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-30T22:31:52.883

我没有使用 KDevelop，但是，在命令行上，您只需将 distributions.o 作为输入文件添加到链接过程。无需破折号或省略 .o 扩展名。

或者，您可以将distributions.cpp 添加到您的KDevelop 项目中吗？这样它应该会自动编译和链接（这就是它在 Visual Studio 或 Eclipse 中的工作方式）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-30T22:07:33.347

您是否将distributions.cpp 添加到您的makefile 中？另外我相信所需的链接器标志是`-ldistributions`.

# php - 使用php将相似数据插入两个表中

> ID：809328
> 
> 赞同：0
> 
> 时间：2009-04-30T22:03:49.080
> 
> 标签：php, mysql, select, insert

我有以下代码用于将表单数据插入数据库中的单个表中。`

```
function insert_interests($uid, $interests) {
/* first, we'll delete any entries this user already has in the table */
    purge_lookup("jss_users_interests_table", $uid);
/* now create the sql insert query */
    global $db;
    $db->query(create_checkbox_query($interests, "jss_users_interests_table", $uid));
}
/* helper function for insert_interests(). removes all rows in $table with $uid */
function purge_lookup($table, $uid) {
    global $db;
    $db->query("DELETE FROM $table WHERE users_id = '".$db->escape($uid)."'");
}
/* helper function for insert_interests(). generates the actual SQL query */
function create_checkbox_query($arr, $table, $uid) {
    $q = "INSERT INTO $table (users_id, subcategories_id) VALUES";
    foreach ($arr as $check) {
    $q .=  " ( '$uid' , $check )" . ",";
    }
/* remove the last comma and return */  
return substr($q, 0, -1);
}` 
```

在此代码之后，我想使用相同的表单数据与另一个表中的其他数据配对，将新记录插入到另一个表中。这是两个表的结构。

**jss_users_interests_table**

*   users_id
*   子类别_id

**jss_info_requests_table**

*   users_id
*   provider_id
*   子类别_id

**jss_providers_assignments_table**

*   provider_id
*   子类别_id

**因此，在将数据插入到jss_provider_assignment_table**之后，我需要做的`jss_users_interests_table`是将相同的数据与每个`subcategories_id's`对应`provider_id`的数据一起插入到**jss_info_requests_table**中。有道理？我是不是把它搞砸了，让它变得复杂？

 **对语法的任何帮助都会很棒。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T22:14:01.943

此 SQL 可能有效。

```
 INSERT INTO jss_info_requests_table 
 (users_id, provider_id, subcategories_id)
SELECT a.users_id,
 b.provider_id, b.subcategories_id FROM
 jss_users_interests_table a,
 jss_providers_assignments_table b 
 WHERE a.subcategories_id =
 b.subcategories_id AND a.users_id =
 [USERID] 
```

# command-line - Powershell命令处理（传入变量）

> ID：809333
> 
> 赞同：7
> 
> 时间：2009-04-30T22:04:52.323
> 
> 标签：command-line, powershell, parameters, arguments, command

我正在创建一个 Powershell 脚本来部署一些代码，该过程的一部分是调用一个名为 RAR.EXE 的命令行压缩工具来备份一些文件夹。

我正在尝试动态构建参数，然后让 powershell 使用变量调用命令，但我遇到了麻烦。它不工作...

运行以下脚本，您应该会看到我在说什么。作为变量传入的参数正在被破坏。如果我在其中传递整个命令 + 参数，我会收到臭名昭著的“不被识别为 cmdlet ...”消息。

谢谢你的帮助！

```
echo "this should succeed"
& cmd /c echo foo

echo "why does this echo out an additional double quote?"
$param = "/c echo foo"
& cmd "$param"

echo "this does the same"
$param = "/c echo foo"
& cmd $param

echo "escaping the slash doesn't work either..."
$param = "`/c echo foo"
& cmd $param

echo "this fails, but why?"
$cmd = "cmd /c echo foo"
&$cmd 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-01T18:01:42.307

在这种情况下，呼叫运算符“&”是不必要的。它用于在新范围内调用命令。这通常用于调用由字符串或脚本块指定的命令。它还有一个附带好处，即在命令完成并且范围消失后，在 PowerShell 脚本中创建的任何变量都会被丢弃。

然而，由于 cmd 是一个 EXE，它在一个完全不同的过程中执行。FWIW，您可以直接从 cmd.exe 获得类似的输出：

```
> cmd "/c echo foo"
foo" 
```

所以最后的额外引号是一个 cmd.exe 问题。通常，当 PowerShell 进行解析以调用命令时，您需要将命令与参数分开，例如

```
45> & { $foo = "foo" }
46> $foo  # Note that $foo wasn't found - it went away with the scope
47> . { $foo = "foo" } # dotting executes in the current scope
48> $foo 
foo 
```

这里值得注意的例外是 Invoke-Expression 的行为类似于“评估此字符串”函数。小心使用，*尤其是*在用户提供字符串的情况下。如果他们提供“ri C:\ -r”，你的日子会很糟糕。

在这种情况下，正如其他人所建议的那样，我会将 /c 从字符串 $param 字符串中提取出来并指定它，例如：

```
cmd /c $param 
```

或者使用 Invoke-Expression 但要小心使用。顺便说一句，当您尝试调试从 PowerShell 向 EXE 发送参数的问题时，请查看 PowerShell 社区扩展 ( [http://pscx.codeplex.com](http://pscx.codeplex.com) ) 中的 echoargs 实用程序。它非常方便：

```
49> $param = "/c echo foo"
50> echoargs $param
Arg 0 is </c echo foo> 
```

这表明 cmd.exe 接收“/c echo foo”作为*单个*参数。“/c”应该是与“echo foo”（要执行的命令）分开的参数。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-01T01:15:33.097

过去，在尝试像您尝试调用可执行类型命令时，我遇到了 & 调用运算符的问题。不知道我明白为什么。然而，Invoke-Expression 似乎总是在这种情况下工作：

```
PS C:\> $cmd = "cmd /c echo foo"
PS C:\> Invoke-expression $cmd
foo 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-12-09T18:28:26.763

我发现的另一种方法是为命令行创建一个参数数组，并将其与 apersand & 调用运算符一起使用。像这样的东西：

```
$exe = "cmd";
[Array]$params = "/c", "echo", "foo";

& $exe $params; 
```

这对我来说效果很好。

我最初在这里找到了这种技术：http: [//techstumbler.blogspot.com/2009/12/windows-commands-with-arguments-in.html](http://techstumbler.blogspot.com/2009/12/windows-commands-with-arguments-in.html)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-01T02:02:11.800

您的最后一个示例如果失败，因为“&”将字符串视为一个参数，因此它正在寻找一个名为“cmd /c echo foo.exe”的程序。:)

这有效：

```
& $cmd $params 
```

至于双引号问题，似乎 cmd 不喜欢 PowerShell 放置的参数周围的引号。它得到这个：

```
cmd "/c echo foo" 
```

所以我认为它将 /c 之后的所有内容都视为确切的命令，就像这样：

```
echo foo" 
```

一些命令行程序和时髦的命令行解析（这就是 PowerShell 接管函数和 cmdlet 的工作的原因）。在 cmd 的情况下，我建议这样做：

```
$param = "echo foo"
& cmd /c $param 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T00:00:56.227

我认为这是使用 cmd /c 的产物。跑步

```
$param = "echo foo"
cmd /c $param 
```

工作正常。除非你有一个真实的代码示例，否则很难排除故障。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-20T00:52:27.690

当 Args 包含在 String 中时，它们的处理方式不同：

```
PS D:\> echo "1 2 3"
1 2 3
PS D:\> echo 1 2 3
1
2
3 
```

当您为 args 使用变量时，会出现相同的结果：

```
PS D:\> $param = "1 2 3"
PS D:\> echo $param
1 2 3 
```

解决方案是使用数组：

```
PS D:\> $param = @(1,2,3)
PS D:\> echo $param
1
2
3 
```

# c++ - 在 C++ 中创建一个 Point 类

> ID：809334
> 
> 赞同：6
> 
> 时间：2009-04-30T22:05:46.220
> 
> 标签：c++, inheritance, operator-overloading

现在我正在使用 std::pair 来表示 C++ 中的二维点。但是，我对不得不写作感到恼火

```
typedef std::pair<double, double> Point;

Point difference = Point(p2.first - p1.first,
                         p2.second - p1.second); 
```

而不是能够重载 operator+ 和 operator-。

所以，我的问题是，要让我的点课，我应该

*   公开派生自 std::pair 并添加我自己的成员函数？这很好，因为我所有的代码都可以保持不变。我不会做类似的事情，`std::pair<double, double>* p = new Point;`所以我不必担心虚拟析构函数之类的事情。
*   滚动我自己的 Point 类，这很烦人，因为我正在复制 std::pair 的功能，但是我“以纯粹的方式做”。
*   为 std::pair 制作 operator+ 和 operator- 的模板特化，诚然我不记得它们是放在源文件还是头文件中。

我想这是有争议的，我真的很想做#1，但我不知道这是否是一个坏主意，因为我听说从 STL 继承是一个禁忌。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-30T22:08:24.797

您可以滚动自己的 Point 类，但在内部使用 std::pair 来存储数据。这可以防止从 STL 问题继承，但仍然使用 std::pair 的功能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-30T22:19:04.833

比自己滚动更好：获取现有的免费矢量/点库。一项推荐：附在[《游戏程序员基本数学》中](http://www.essentialmath.com/)的一项。您可以使用您找到的任何库作为起点，然后从那里优化/专门化/调整。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-30T22:25:28.060

如果您想使用 std::pair 的功能，我会支持创建您自己的 Point 类并使用私有继承或组合。typedef 的问题（我相信您知道）是您编写的任何采用 Point 的函数也可以被表示为 std::pair<double, double> 的任何东西使用，这可能是无效的。

考虑到这一点，存在另一种选择，即仅创建一些免费的构建器功能，例如

```
Point addPoints(const Point& p1, const Point& p2);
Point diffPoints(const Point& p1, const Point& p2); 
```

（函数名称可能会更好）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-30T22:09:38.800

另一种选择可能是让您拥有 Point 类，并让您的类“拥有”代表点坐标的 std::pair 。

很多时候，“HAS A”（组合）关系比“IS A”（继承）关系更可取。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-30T22:09:41.093

我认为“最佳实践”会说推出您自己的 Point 课程。通过这种方式，您可以更轻松地完成 3D 制作。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-30T22:12:16.313

私有继承又名实现的继承，是你的朋友。

这在逻辑上遵循：a Point 不是 std::pair，您不想进行从 Point 到 std::pair 的公共向上转换，但您确实想使用 std::pair 的内部结构。

另一种可能性是has-a关系或组合：每个Point都有一个它在内部使用的privbate std::pair。

事实上，组合和私有继承之间没有太大区别，除了在后者中您可以在 Point 成员函数中强制向上转换为 std::pair 。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-30T22:14:29.197

滚动您自己的 Point 课程。这将允许您在将来用它做任何事情。具体来说，我以前解决过这类问题，我发现有用的是定义我自己的 Point 结构，并创建一个继承自它的 Point 类。

完全披露：我不太喜欢 STL。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-01-24T12:26:11.260

不要从 std::pair 公开继承，因为 std::pair 有一个 operator< 但你的 Point 不应该有。

# .net - .NET WPF MissingMethodException 启动新线程时

> ID：809337
> 
> 赞同：6
> 
> 时间：2009-04-30T22:06:43.333
> 
> 标签：.net, wpf, multithreading, exception

我有一个 WPF 应用程序，该应用程序在启动时会在新线程中调用自定义方法。

```
Private Sub TestStep1_Loaded(ByVal sender As Object, ByVal e As System.Windows.RoutedEventArgs) Handles Me.Loaded
    Dim oThread As New Thread(AddressOf DisplayNextPicture)
    oThread.Start()
End Sub

Private Sub DisplayNextPicture()
    '' do stuff
End Sub 
```

这在我的机器上运行良好，但在客户端机器上启动新线程会导致 MissingMethodException。我不确定为什么会发生这种情况（不幸的是，客户端位于远程位置，所以我不得不通过插入跟踪语句和反复试验来调试它）。肯定是找不到 DisplayNextPicture() 方法，因为我已经能够通过跟踪确定。

我唯一能想到的是，这与框架级别的安全性有关。从 WPF 应用程序启动新线程是否有限制？

我无法通过 Application.DispatcherUnhandledException 捕获此异常，因此无法获取任何异常详细信息或堆栈跟踪。客户端获得一个带有以下信息的 .NET 运行时异常对话框，这是我知道异常类型的唯一方法：

> 事件类型：clr20r3 P1：testapp.exe P2：1.0.0.0 P3：49fa2234 P4：mscorlib P5：2.0.0.0 P6：471ebc5b P7：1295 P8：14
> P9：system.missingmethodexception

请帮忙 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-04-26T10:33:00.143

在 Windows XP SP3 上测试面向 .NET 3.5 的应用时，我得到了 System.MissingMethodException。我最终安装了 Visual Studio 2008 Express 以尝试从头开始编译应用程序。直到那时，编译器才给我相关的错误，原来 AutoResetEvent 中的方法 WaitOne 只有一个带有 2 个参数的签名，因此我不得不重写：

`reset.WaitOne(1000);`

至

`reset.WaitOne(1000, true);`

我猜微软忘记在 Windows XP .NET 3.5 版本中添加第一个重载。因为它在 Windows 7 中有效并且存在。去看看吧。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-07-31T14:49:11.597

我使用的是 VS2008、.Net 3.5 并且在启动服务线程时遇到了类似的问题。升级到 .Net 3.5 SP1 解决了这个问题。谢谢你们的帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-08-26T04:09:52.367

尝试运行 Windows 服务（我已经编写过）时遇到了这个问题。该服务可以在我的测试环境中正常运行，但不能在其他机器上运行。

问题原来是麻烦的机器运行的是 3.5 版框架，而我的开发机器是 3.5 Service Pack 1。将机器升级到 SP1 解决了这个问题。

希望这能减轻一些人的痛苦。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-08-27T19:15:43.570

FWIW，我有一个 P9 system.missingmethodexception 错误，它在某些机器上崩溃了一个简单的应用程序，但在其他机器上却没有。我将其追踪到在线程内执行的“.WaitOne(2000)”行。永远不会在我的机器上造成问题，但它肯定会在其他机器上崩溃，即使代码从未执行过！线程甚至没有到达那条线。程序启动时就发生了崩溃，这真是令人沮丧。我什至在问题代码行周围有一个“try..catch”，但它没有帮助。我停止使用 AutoResetEvent 并使用了一个变量和一个 " `while( ! signaled ) { Thread.sleep(20); }`，这是一个 kludge，但它工作....

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-26T20:25:47.323

MissingMethodException 由 JITer（即时编译器）抛出。抖动一次将代码编译成汇编语言一种方法。委托方法（DisplayNextPicture）中有一些方法正在调用目标机器上的库中不存在的方法，我猜它正在运行旧版本的.net。由于jitter找不到它炸毁的方法。

我现在在安装了 VS 2008 和 3.5 SP1 的计算机上构建时遇到过几次，然后尝试在仅安装 3.0 的计算机上运行。有时微软会在库中添加一个方法，而不是升级它们的主要或次要版本。通常这是在 .net 框架服务包之一中完成的。

浏览委托方法中的代码并查看 MSDN 上的任何可疑方法，并仔细检查“版本信息”以查看方法支持哪些框架版本。

如果可能的话，您也可以让您的客户端升级到最新的框架。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-26T22:26:37.720

我遇到了同样的问题。我正在调用 .Net 的执行版本中不存在的 Dispatcher.Invoke 方法的重载。尽管我的问题略有不同，但我在 MSDN 上找到了一条有用的评论，该评论对我有帮助。

[http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatcher.invoke.aspx](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatcher.invoke.aspx)

如果您使用 Invoke 方法，请尝试使用具有 DispatcherPriority 作为第一个参数的重载。

# dojo - Dojo 对话框嵌套

> ID：809350
> 
> 赞同：2
> 
> 时间：2009-04-30T22:11:01.497
> 
> 标签：dojo, dialog

一个dojo 对话框能否调出另一个dojo 对话框？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-11-06T00:42:50.410

dojo 1.3 一次只支持一个模态对话框，因此，是的，一个对话框可以打开另一个对话框，关闭第二个对话框会破坏第一个对话框。

发生这种情况是因为 dojo.Dialog 使用单个全局底层对象，该对象在对话框和页面上的任何其他内容之间提供屏幕。如果您愿意为每个对话框创建自己的底层并自己管理 z-index，则可以使其工作。

我知道这将在 1.4 中得到纠正。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T16:44:12.317

是的，一个对话框可以打开另一个对话框，但是你会显示两个对话框——它们之间不是模态的。

因为这不是我想要的行为，所以我通过创建自己的处理程序来解决这个问题——它首先检查打开的对话框，如果找到，在打开新对话框之前关闭它（并将其放在堆栈上） . 当它关闭一个时，它会查看堆栈并重新打开堆栈中较低的对话框。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-28T12:51:54.513

在 Dojo 1.4 之前可以打开多个对话框，但在这种情况下会出现可访问性问题（`tabIndex`处理错误） - 因此，如果您需要您的应用程序可访问并支持多个对话框，则需要升级到 Dojo 1.4出去。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-04T16:49:23.267

是的，你可以在 dojo 1.6 及以上版本中做到这一点

# windows - 使用 Browser Helper 对象修改 HTTP 请求和响应

> ID：809352
> 
> 赞同：4
> 
> 时间：2009-04-30T22:11:30.780
> 
> 标签：windows, internet-explorer, http, bho

我想使用 Internet Explorer 浏览器帮助程序对象修改 HTTP 请求标头。我基本上需要为每个请求更改一些标头，然后在响应返回浏览器之前对其进行修改。

我尝试使用 OnNavigate2 事件，但这些事件甚至无法让您访问所有标题。

我尝试制作一个异步可插入协议，但是我真的无法访问默认的 HTTP 实现，也无法覆盖默认的 HTTP 请求。

你知道这应该怎么做吗？我更喜欢 C#，但必要时可以使用 C++。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T07:14:02.603

它可以通过 URL monikers 来完成。有一个叫 Igor Tandetik 的人实现了类似的东西。您可以在以下位置找到代码链接：microsoft.public.inetsdk.programming google group - 只需查找 PassthruAPP。（我会发布一个链接，但显然不允许新用户这样做）

它不直接支持修改响应正文。您必须在 IInternetProtocolImpl::Read 方法中插入一个钩子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T22:26:42.660

最简单的方法是使用 http 代理来拦截 Fiddler 所做的一切。

请参阅[Fiddler PowerToy（第 1 部分）](http://msdn.microsoft.com/en-us/library/bb250446.aspx)的说明。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-30T22:52:32.363

您似乎只能通过使用 BeforeNavigate2 事件的 headers 参数来修改 CUSTOM 标头。并非所有标题都可以访问。这是一种尝试将 BHO 作为特洛伊木马的可能性降到最低的方法。请改用 HTTP 代理。

# apache-flex - 在 Flex 中更改单个 TextArea/TextEditor 行？

> ID：809354
> 
> 赞同：0
> 
> 时间：2009-04-30T22:11:58.687
> 
> 标签：apache-flex, actionscript-3

因此，对于一个暑期项目，我正在考虑在 Flex 中编写一个协作式代码编辑应用程序。为了做到这一点，我需要能够在不同用户修改同一个文档时修改文本区域中的单个行或字符。

我想我听说过 Flex 4 支持文本原语，但仍在开发中。有没有办法修改或获取文本区域中的各个行？

此外，如果有人可以阐明文本区域/编辑器如何存储和处理它显示的文本，这将非常有帮助。我一直在深入研究源代码，但仍在努力解决它。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T15:01:21.693

如果您愿意使用测试版，您现在可以使用 flex 4 中的内容：

[http://opensource.adobe.com/wiki/display/flexsdk/Gumbo+Text+Primitives](http://opensource.adobe.com/wiki/display/flexsdk/Gumbo+Text+Primitives)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T22:23:39.703

我相信你可以绑定一个TextArea的htmlText。当您可以响应更改时，它将调度 htmlTextChanged 事件。我不知道这对于您要完成的工作是否足够全面（可能有必要从头开始推出编辑器？）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-22T22:44:21.540

为什么不使用 htmlText 属性，并手动将标记添加到文本字符串？这可能是您最简单的选择。否则，您可以深入研究内部 textfield 属性并使用 selectionIndex 属性并在范围上设置 textFormat 。查看 Flash 文档中的 TextField / TextFormat 内容。

不确定如何通过 TextArea 完成它，但我保证它会令人沮丧......

# .net - flex 和 .net 2.0 网络服务，如何允许从其他域访问？

> ID：809356
> 
> 赞同：0
> 
> 时间：2009-04-30T22:12:14.817
> 
> 标签：.net, vb.net, apache-flex, service

我在 flex builder 中创建了一个项目，应用程序服务器类型设置为 none。

当我调试时，我可以从位于站点[http://mysite.com/ws/ws.aspx?wsdl的本地计算机访问 Web 服务](http://mysite.com/ws/ws.aspx?wsdl)

当我将 flex 应用程序上传到 mysite.com/myapp.html 时，效果很好。

但是，当我将它上传到 myapp.mysite.com/myapp.html 时，它不会访问网络服务。

有人知道我错过了什么吗？

谢谢

PS WS 是用 VB.net 创建的，当我创建一个应用程序服务器类型设置为 .net 的 flex 项目时，它不会从我的本地计算机访问 WS

这是我的 crossdomain.xml 文件

```
<?xml version="1.0"?>
<!DOCTYPE cross-domain-policy SYSTEM "http://www.adobe.com/xml/dtds/cross-domain-policy.dtd">
<cross-domain-policy>
  <site-control permitted-cross-domain-policies="all"/>
  <allow-access-from domain="*"/>
  <allow-http-request-headers-from domain="*" headers="*"/>
</cross-domain-policy> 
```

**我的猜测是这不是 flex 问题，而是 .net 安全功能......我不知道如何配置。

.NET 不允许应用程序在其自己的域之外使用它。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T22:21:56.883

默认情况下，Flex 不允许访问远程主机上的 Web 服务。这是 Flex 的一项安全功能。由于您的 Flex 应用程序部署在`myapp.mysite.com`与`mysite.com`.

您可以`crossdomain.xml`向 mysite.com 添加一个，Flex 将检查该服务是否允许来自不同域的访问。该`crossdomain.xml`文件必须位于域的 Web 根目录 ( `mysite.com/crossdomain.xml`)。我使用了以下内容来允许调试使用。请注意，它允许所有使用，因此如果您想在生产中限制使用，则需要稍后对其进行修改。

```
<?xml version="1.0"?>
<!DOCTYPE cross-domain-policy SYSTEM
    "http://www.macromedia.com/xml/dtds/cross-domain-policy.dtd">
<cross-domain-policy>
   <allow-access-from domain="*" to-ports="*" />
   <allow-http-request-headers-from domain="*" headers="*"/>
</cross-domain-policy> 
```

[Flex 文档](http://labs.adobe.com/wiki/index.php/Flex:Accessing_Data)中的更多信息，尤其是[知识库文章](http://kb.adobe.com/selfservice/viewContent.do?externalId=tn_14213&sliceId=1)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T15:29:05.557

尝试检查使用 Tamper Data（Firefox 的扩展）发出的请求。检查以便应用找到 crossdomain.xml 文件。如果路径关闭，那是你的问题。

# python - 如何计算累积正态分布？

> ID：809362
> 
> 赞同：124
> 
> 时间：2009-04-30T22:13:11.477
> 
> 标签：python, numpy, scipy, statistics

我正在 Numpy 或 Scipy（或任何严格的 Python 库）中寻找一个函数，它会给我 Python 中的累积正态分布函数。

* * *

## 回答 #1

> 赞同：149
> 
> 时间：2009-04-30T22:24:02.590

这是一个例子：

```
>>> from scipy.stats import norm
>>> norm.cdf(1.96)
0.9750021048517795
>>> norm.cdf(-1.96)
0.024997895148220435 
```

换句话说，大约 95% 的标准正态区间位于两个标准差内，以标准均值 0 为中心。

如果您需要逆 CDF：

```
>>> norm.ppf(norm.cdf(1.96))
array(1.9599999999999991) 
```

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2015-03-26T07:40:44.443

回答这个问题可能为时已晚，但由于谷歌仍然在这里引领人们，我决定在这里写下我的解决方案。

即从Python 2.7开始，该`math`库已经集成了error函数`math.erf(x)`

该`erf()`函数可用于计算传统的统计函数，例如累积标准正态分布：

```
from math import *
def phi(x):
    #'Cumulative distribution function for the standard normal distribution'
    return (1.0 + erf(x / sqrt(2.0))) / 2.0 
```

参考：

[https://docs.python.org/2/library/math.html](https://docs.python.org/2/library/math.html)

[https://docs.python.org/3/library/math.html](https://docs.python.org/3/library/math.html)

[误差函数和标准正态分布函数有什么关系？](https://stats.stackexchange.com/a/187909)

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2019-02-28T19:50:14.893

开始`Python 3.8`，标准库将[`NormalDist`](https://docs.python.org/3.8/library/statistics.html?highlight=normaldist#statistics.NormalDist)对象作为[`statistics`](https://docs.python.org/3.8/library/statistics.html)模块的一部分提供。

它可用于获取给定*均值*( ) 和*标准差*( ) 的***累积分布函数***( [`cdf`](https://docs.python.org/3.8/library/statistics.html#statistics.NormalDist.cdf)- 随机样本 X 小于或等于 x 的概率)：*`mu`*`sigma`**

 **```
from statistics import NormalDist

NormalDist(mu=0, sigma=1).cdf(1.96)
# 0.9750021048517796 
```

可以简化为*标准正态分布*(`mu = 0`和`sigma = 1`)：

```
NormalDist().cdf(1.96)
# 0.9750021048517796

NormalDist().cdf(-1.96)
# 0.024997895148220428 
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2009-04-30T22:23:28.830

改编自这里[http://mail.python.org/pipermail/python-list/2000-June/039873.html](http://mail.python.org/pipermail/python-list/2000-June/039873.html)

```
from math import *
def erfcc(x):
    """Complementary error function."""
    z = abs(x)
    t = 1\. / (1\. + 0.5*z)
    r = t * exp(-z*z-1.26551223+t*(1.00002368+t*(.37409196+
        t*(.09678418+t*(-.18628806+t*(.27886807+
        t*(-1.13520398+t*(1.48851587+t*(-.82215223+
        t*.17087277)))))))))
    if (x >= 0.):
        return r
    else:
        return 2\. - r

def ncdf(x):
    return 1\. - 0.5*erfcc(x/(2**0.5)) 
```

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2010-08-19T19:35:08.430

以 Unknown 的示例为基础，在许多库中实现的函数 normdist() 的 Python 等价物将是：

```
def normcdf(x, mu, sigma):
    t = x-mu;
    y = 0.5*erfcc(-t/(sigma*sqrt(2.0)));
    if y>1.0:
        y = 1.0;
    return y

def normpdf(x, mu, sigma):
    u = (x-mu)/abs(sigma)
    y = (1/(sqrt(2*pi)*abs(sigma)))*exp(-u*u/2)
    return y

def normdist(x, mu, sigma, f):
    if f:
        y = normcdf(x,mu,sigma)
    else:
        y = normpdf(x,mu,sigma)
    return y 
```

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2015-11-20T10:24:57.540

Alex 的回答向您展示了标准正态分布的解决方案（均值 = 0，标准差 = 1）。`mean`如果您具有和`std`（即）的正态分布`sqr(var)`并且您想要计算：

```
from scipy.stats import norm

# cdf(x < val)
print norm.cdf(val, m, s)

# cdf(x > val)
print 1 - norm.cdf(val, m, s)

# cdf(v1 < x < v2)
print norm.cdf(v2, m, s) - norm.cdf(v1, m, s) 
```

在此处阅读有关[cdf 的更多信息，并在此处](https://en.wikipedia.org/wiki/Cumulative_distribution_function)[阅读](http://docs.scipy.org/doc/scipy-0.16.0/reference/generated/scipy.stats.norm.html)具有许多公式的正态分布的 scipy 实现。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2019-02-06T22:17:18.240

从上面拍摄：

```
from scipy.stats import norm
>>> norm.cdf(1.96)
0.9750021048517795
>>> norm.cdf(-1.96)
0.024997895148220435 
```

对于双尾测试：

```
Import numpy as np
z = 1.96
p_value = 2 * norm.cdf(-np.abs(z))
0.04999579029644087 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-05-30T14:55:18.013

像这样简单：

```
import math
def my_cdf(x):
    return 0.5*(1+math.erf(x/math.sqrt(2))) 
```

我在此页面中找到了公式[https://www.danielsoper.com/statcalc/formulas.aspx?id=55](https://www.danielsoper.com/statcalc/formulas.aspx?id=55)

# asp.net - ASP.NET 水平菜单，下面显示子菜单，也是水平的

> ID：809367
> 
> 赞同：0
> 
> 时间：2009-04-30T22:14:07.073
> 
> 标签：asp.net, menu, submenu, aspmenu

我有一个带有 UL/LI 标记的水平菜单，我想将其转换为 .net 3.5 中的 ASP:Menu。

当单击主菜单选项时，我希望在主菜单下方的水平菜单中呈现子菜单中的选项。我也想：

*   通过突出显示/加粗主菜单和子菜单来指示选择了哪个菜单选项，
*   检查呈现（或通过其他机制）用户的角色以仅显示正确的菜单选项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T22:36:17.410

使用 CSS 友好的适配器：[http ://www.asp.net/CssAdapters/](http://www.asp.net/CssAdapters/)

这些将允许您保留 ul/li 标记，并让您能够通过 css 突出显示并控制渲染，就像使用带有角色的普通 asp:Menu 一样。

# c - 在 C 中传递枚举

> ID：809373
> 
> 赞同：1
> 
> 时间：2009-04-30T22:16:26.010
> 
> 标签：c, types, enums, compiler-errors

这似乎是一个简单的问题，但编译时出现错误。我希望能够将枚举传递给 C 中的方法。

枚举

```
enum TYPES { PHOTON, NEUTRINO, QUARK, PROTON, ELECTRON }; 
```

调用方法

```
makeParticle(PHOTON, 0.3f, 0.09f, location, colour); 
```

方法

```
struct Particle makeParticle(enum TYPES type, float radius, float speed, struct Vector3 location, struct Vector3 colour)
{
    struct Particle p;
    p.type = type;
    p.radius = radius;
    p.speed = speed;
    p.location = location;
    p.colour = colour;

    return p;
} 
```

我得到的错误是当我调用该方法时：

> 赋值中的不兼容类型

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-30T22:20:48.993

在这个精简的示例中，它对我来说编译得很好：

```
enum TYPES { PHOTON, NEUTRINO, QUARK, PROTON, ELECTRON };

void makeParticle(enum TYPES type)
{
}

int main(void)
{
    makeParticle(PHOTON);
} 
```

你确定你已经`TYPES`在定义`makeParticle`和调用中声明了代码可用吗？如果您这样做，它将不起作用：

```
int main(void)
{
    makeParticle(PHOTON);
}

enum TYPES { PHOTON, NEUTRINO, QUARK, PROTON, ELECTRON };

void makeParticle(enum TYPES type)
{
} 
```

因为`main()`代码还没有看到 TYPES。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-04-30T22:22:13.000

尝试改变

```
p.type = type; 
```

到

```
p.type = (int)type; 
```

如果这没有帮助，请添加整个 .c 文件，包括`struct Particle`问题的定义。

# sql - SQL Server：varbinary 或 int 存储位掩码？

> ID：809375
> 
> 赞同：12
> 
> 时间：2009-04-30T22:17:03.620
> 
> 标签：sql, sql-server, database-design, bitmask

就性能或灵活性而言，使用 int vs varbinary 存储位掩码是否有任何优势。

出于我的目的，我将始终对这些位掩码进行读取（不写入或更新）。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-30T22:30:50.420

您绝对应该使用`INT`（如果您需要 32 个标志）或`BIGINT`（对于 64 个标志）。如果您需要更多可以使用的标志[`BINARY`](http://technet.microsoft.com/en-us/library/ms188362.aspx)（但您可能还应该问自己为什么在应用程序中需要这么多标志）。

此外，如果使用整数类型，则可以直接使用标准的[位运算符](http://msdn.microsoft.com/en-us/library/ms176122.aspx)，而无需将字节数组转换为整数类型。

如果您确实需要更多标志并且必须使用`BINARY`，那么您将失去对位运算符的本机支持，因此很容易支持检查标志值。我可能会将检查标志值转移到客户端应用程序，但如果您习惯使用 T-SQL 编程，这也是一个选项。如果您使用 C#，则您有一个[`BitArray`](http://msdn.microsoft.com/en-us/library/system.collections.bitarray.aspx)具有必要操作的类，而在 Java 中您有一个[`BitSet`](http://docs.oracle.com/javase/7/docs/api/java/util/BitSet.html)类。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-30T22:34:06.667

通常认为使用一堆位列而不是位掩码更可取。它们将在页面中打包在一起，因此它们不会占用更多空间。虽然我似乎也总是使用 int 或 bigint 列来避免输入所有列名。但使用智能感知我可能会使用位列。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-30T22:22:09.223

好吧，考虑到 int 的存储空间较小，并且通常使用起来更容易一些，我不确定您为什么要使用 varbinary。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-30T22:49:00.377

我通常同意@hainstech 使用位字段的回答，因为您可以明确命名每个位字段以指示它应该存储的内容。但是，我还没有看到与位字段进行位掩码比较的实用方法。使用 SQL Server 的按位运算符（&、| 等），很容易找出是否设置了一系列标志。使用等式运算符针对大量位字段进行更多工作。

# wpf - 如何以编程方式导航 WPF UI 元素制表位？

> ID：809382
> 
> 赞同：10
> 
> 时间：2009-04-30T22:18:40.183
> 
> 标签：wpf, keyboard, navigation, tabstop

谁能告诉我如何以编程方式浏览 WPF 应用程序中的所有 UI 元素制表位？我想从第一个制表位开始嗅探相应的元素，访问下一个制表位，嗅探相应的元素，依此类推，直到到达最后一个制表位。

谢谢， - 迈克

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-04-30T22:41:02.643

您可以使用 MoveFocus 来执行此操作，如这篇 MSDN 文章中所示，该文章解释了有关焦点的所有内容：[Focus Overview](http://msdn.microsoft.com/en-us/library/aa969768.aspx)。

这是一些示例代码，用于获取下一个焦点元素（从那篇文章中获得，稍作修改）。

```
// MoveFocus takes a TraversalRequest as its argument.
TraversalRequest request = new TraversalRequest(FocusNavigationDirection.Next);

// Gets the element with keyboard focus.
UIElement elementWithFocus = Keyboard.FocusedElement as UIElement;

// Change keyboard focus.
if (elementWithFocus != null) 
{
    elementWithFocus.MoveFocus(request);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-30T22:48:58.287

您可以使用 MoveFocus 调用来执行此操作。您可以通过 FocusManager 获取当前聚焦的项目。以下代码将迭代窗口中的所有对象并将它们添加到列表中。请注意，这将通过切换焦点来物理修改窗口。如果窗口不活动，代码很可能无法工作。

```
// Select the first element in the window
this.MoveFocus(new TraversalRequest(FocusNavigationDirection.First));

TraversalRequest next = new TraversalRequest(FocusNavigationDirection.Next);
List<IInputElement> elements = new List<IInputElement>();

// Get the current element.
UIElement currentElement = FocusManager.GetFocusedElement(this) as UIElement;
while (currentElement != null)
{
    elements.Add(currentElement);

    // Get the next element.
    currentElement.MoveFocus(next);
    currentElement = FocusManager.GetFocusedElement(this) as UIElement;

    // If we looped (If that is possible), exit.
    if (elements[0] == currentElement)
        break;
} 
```

# css - css选择器规则——选择器中所有元素的规则集？

> ID：809385
> 
> 赞同：4
> 
> 时间：2009-04-30T22:19:15.597
> 
> 标签：css, inheritance, css-selectors, rules

使用 at-rules，可以在 at-rule 事件期间为元素设置一个规则集（例如打印、移动设备等）。但是对于特定的选择器呢？

我正在处理一个较大站点的子页面，并且我必须对我的任何页面使用主样式表。有时，样式规则会被主样式表中的规则打败。为了克服这个问题，我最终不得不在所有规则之前添加“#mypage #content blah blah”，以确保我的 css 更具体。它很快就会变得混乱。我更喜欢做的是：

```
@#mypage {
       div {
           border: 1px solid #000;
           }
       div p {
           color: #00f;
           }
       } 
```

这样我制定的任何规则都包含在我正在处理的页面部分的 id 中。

哦，我忘了提，我不能（据我所知）使用@namespace，因为我的页面在模板框架内（因此需要主样式表），所以如果我只是说@namespace（我的- page-url) 我的样式表会覆盖主样式表。

我错过了一些简单的东西吗？

* * *

澄清：

对不起，我想我试图保持简单，我太含糊了......

我正在开发一个页面的内容，该页面将放置在一个更通用的模板（标头、侧边栏导航等）中，该模板具有全局样式表，我无法控制任何内容。

我对我的部分的样式表有一些自由。我不希望我的任何规则意外覆盖全局样式表，并且我希望避免为我的规则使用非常长的选择器以避免全局样式表覆盖我的样式表。例如，如果我想说

“所有表格都有黑色边框”

我冒着在侧边栏中的某个桌子周围放置黑色边框的风险。但是，如果我说

“div #content 中的所有表格都有黑色边框”

这只有在他们没有更具体的规则时才有效。

现在，我可以遍历每条规则并添加一长串选择器，以确保我的每条规则都适用并且仅适用于我的部分，但这并不是真正有吸引力或有趣的做法。我希望我可以将所有规则嵌套在一个更大的规则中，就像我上面的例子一样，这样我就可以有一个主要规则：

```
 #content {

    //and place all of my style rules inside of that:

 p {
     border: pink;
   } 
```

这样我只需声明一次我的特异性，它涵盖了该主要规则中的每条规则。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-30T22:47:32.003

这不是一个完美的解决方案，因为它使用基于 PHP 的服务器端处理，但这对您来说可能已经足够了：

[http://www.shauninman.com/archive/2007/06/27/css_server_side_pre_processor](http://www.shauninman.com/archive/2007/06/27/css_server_side_pre_processor)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-30T23:31:52.927

不久前提出了一个[非常相似的问题](https://stackoverflow.com/questions/591743/css-more-short-query/591959#591959)（标题相当糟糕）。

最受欢迎的答案是[Shaun Inman 的服务器端预处理器](http://www.shauninman.com/archive/2007/06/27/css%5Fserver%5Fside%5Fpre%5Fprocessor)（现已被[CSSCacheer](http://www.shauninman.com/archive/2008/05/30/check_out_css_cacheer)取代）。

我的建议是[Sass](http://haml.hamptoncatlin.com/docs/rdoc/classes/Sass.html)。

在任何一种情况下，这都是 vanilla CSS 的不足之处。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-30T22:21:49.957

您可以使用“！important”声明覆盖其他样式表：

```
div {
    border: 1px solid #000 !important;
    }
div p {
    color: #00f !important;
    } 
```

更多信息：[http ://www.w3.org/TR/CSS2/cascade.html#important-rules](http://www.w3.org/TR/CSS2/cascade.html#important-rules)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-30T22:24:10.280

从我读过的内容来看，以下规则符合要求，只有一层深度，坦率地说，这是我见过和使用的大多数网站的典型特征：

```
#content div {
  ... your rules ...
} 
```

这只会影响具有内容 id 的元素下的 div。

没有办法像这样“分组”这些规则：

```
#content {
  div {
    ... your rules ...
  }
} 
```

那会很好，但可惜，它不是这样写的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-02T23:58:51.313

有一种方法可以使用 CSS 引擎，例如`less`（node.js 库）。

根据[lesscss](http://lesscss.org/)的网站（和个人经验），您可以像这样嵌套 css 规则：

```
#header {
  h1 {
    font-size: 26px;
    font-weight: bold;
  }
  p { font-size: 12px;
    a { text-decoration: none;
      &:hover { border-width: 1px }
    }
  }
} 
```

并使用命令行实用程序`less`将其编译为

```
#header h1 {
  font-size: 26px;
  font-weight: bold;
}
#header p {
  font-size: 12px;
}
#header p a {
  text-decoration: none;
}
#header p a:hover {
  border-width: 1px;
} 
```

您还可以使用`less`字体大小等变量，因此它可以更快地进行更改。

# php - 生成简短且唯一的文件/文件夹名称的好方法是什么？

> ID：809390
> 
> 赞同：3
> 
> 时间：2009-04-30T22:21:01.020
> 
> 标签：php, string, unique

标准基本上是这样的：

*   文件夹将存在约 24-48 小时
*   文件夹名称不容易被用户猜到（如果在 URL 中使用）
*   文件夹名称应短 5-15 个字符

初步想法：

```
printf('%u',crc32(microtime(true))); 
```

细节：上传文件时，我基本上想保持上传者命名的唯一文件名，所以为了避免任何命名冲突，我想把它放在一个唯一命名的目录中......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-30T22:27:00.663

[编辑] 等一下。PHP 在标准库中包含一个[唯一的 id 生成器函数](http://us.php.net/uniqid)。还有[其他方法](http://phpgoogle.blogspot.com/2007/08/four-ways-to-generate-unique-id-by-php.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-30T22:40:54.780

经典技术看起来像

```
 + uploader-name  
    + 20090401
      + 010000     // hhmmss
      + 013000     // hhmmss
      + 014500     // hhmmss
    ...

    + 20090402 
```

根据所需的粒度添加级别、附加“a”、“b”、“c”等。

这特别有效。好吧，如果用户完全按时间顺序与文件相关。

您最终会进行一些存在枚举，但这并不那么痛苦。我已经使用了很多次（包括使用 PHP），主要是因为用户阻力低于我发现的任何替代方案。

如果您愿意，可以美化日期表达式 - “2009-Apr-01”、“01:45AM”等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-30T22:25:31.307

没有指定语言，在 Ruby 中我会这样做：

```
require 'digest/md5'
Digest::MD5.hexdigest(Time.now.to_s)

=> "f531384b3cc8c60b7c5b7ad087cb0ae4" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-30T22:26:40.273

这听起来像是一个“默默无闻的安全”问题。我建议反对任何创建潜在敏感数据并以安全的方式公开它（即使是很短的时间）的事情，因为期望没有人会猜到位置。存在蛮力攻击，它们可以破坏这种类型的“安全性”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-30T22:28:07.150

使用日期和时间来生成名称

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-30T22:29:49.877

我会使用类似的东西：

```
$salt='Whatever you want';
$folderName=SHA1($salt.date('U')); 
```

Date('U') 返回自 Unix 纪元（格林威治标准时间 1970 年 1 月 1 日 00:00:00）以来的秒数，因此除非您同时生成多个文件夹，否则它可能是唯一的？

在这种情况下，只需巧妙地更改 $salt 值（使其成为用户名或随机数等）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-01T08:19:59.583

如果用户大致知道何时生成目录，则基于时间的哈希（md5 或 sha）可以猜测。他们需要做的就是设置一个简单的脚本来生成涵盖几秒钟的所有可能性，然后点击站点寻找响应。添加盐虽然会有所帮助，但从长远来看并没有多大好处。

对于 OP，以上内容适用于任何方法。如果您正在运行一个非常快的服务器，您将需要监控随机目录的命中。只有 5 个字母的目录意味着有人可以手动访问该站点足够多次来发现该目录。15 确实增加了它，但有一些机器以脚本方式执行它，这并非不可能。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-01T07:48:54.163

C++ 标准在 cstdio (stdio.h) 中具有函数 tmpfile 和 tmpnum，并相应地创建临时文件和临时文件名。tmpfile 在程序结束时被删除。我会链接它们，但遗憾的是我还不能发布链接。

# eclipse-rcp - Eclipse RCP：如何显示源代码？

> ID：809398
> 
> 赞同：3
> 
> 时间：2009-04-30T22:22:36.320
> 
> 标签：eclipse-rcp

如果可以在文本编辑器中打开源代码并用装饰显示它（例如Java），我在徘徊吗？我不需要花哨的 Eclipse 编辑器功能，只需用行号适当修饰源代码，它甚至可以是只读的。我读到 RCP 对文本编辑器有很多限制，因为它拖在繁重的插件后面。可以做到吗？打开文件时是否可以导航到特定的代码行？如果有人能指出正确的方向或举一些例子，那就太好了......提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T18:49:36.073

Eclipse (3.4.2) 本身带有一个示例 XML 编辑器，它实现了语法高亮。只需创建一个新的插件项目，选择“此插件将对 UI 做出贡献”并为富客户端应用程序选择“否”。以下向导页面提供了一个“带有编辑器的插件”模板，这是您的朋友。

将其用作任务的真实模板可能过于简单，但它演示了如何为文本文件创建彩色编辑器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-29T15:37:03.170

我正在实现一个专注于 TTCN 语言的 eclipse 插件，编辑器是它最重要的部分。实际上，我正在使用 Eclipse 编辑器框架。我想有比你想要的更多有用的功能。而且很容易扩展。正如Andreads_D所说，你可以参考eclipse默认提供的基本示例。我想你不需要知道一切，只需要关注你的需求。您也可以参考[https://quitus-kitt](https://quitus-kitt.googlecode.com/svn/trunk) .​​googlecode.com/svn/trunk 。有什么问题，我们可以讨论。:)

# .htaccess - mod_rewrite ：为什么它在本地工作而不是在线工作？

> ID：809412
> 
> 赞同：0
> 
> 时间：2009-04-30T22:24:56.330
> 
> 标签：.htaccess, mod-rewrite, friendly-url

我正在本地开发一个应用程序（在域名*<mydomain>.dev*下）。

为了使用友好的 url，我设置了我的 .htaccess，如下所示：

```
RewriteEngine on
# Externally redirect to add missing trailing slash
RewriteRule ^(([a-z0-9._\-]+/)*[a-z0-9_\-]+)$ http://example.com/$1/?%{QUERY_STRING}[NC,R,L]
RewriteRule ^about/$ about.php [NC,L]
RewriteRule ^issues/$ issues.php [NC,L]
RewriteRule ^issue/([a-z0-9_\-]+)/$ issue.php?slug=$1 [NC,L]

SetEnv PHP_VER 5
IndexIgnore *
Options +FollowSymLinks 
```

它工作正常。烦人的是，上网的时候就不是那么好了：

[http://example.com/issue/my-slug/#23](http://example.com/issue/my-slug/#23)不返回 GET 变量。为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-30T22:48:14.543

我没看到

```
RewriteRule ^(([a-z0-9._\-]+/)*[a-z0-9_\-]+)$ http://mydomain.eu/$1/?%{QUERY_STRING}[NC,R,L] 
```

应该与该 URL 匹配，但这是唯一一个带有 [R] 标志来执行外部重定向的 URL。尝试注释掉该行，以确保应用程序的其他部分没有执行重定向。我的猜测是有。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T22:49:52.933

根据过去的经验，我的猜测是 RewriteBase，可能是因为您在共享服务器上，或者其他一些非标准配置。

```
RewriteEngine on

#Set base as doc root.
RewriteBase /

# Externally redirect to add missing trailing slash
RewriteRule ^(([a-z0-9._\-]+/)*[a-z0-9_\-]+)$ http://mydomain.eu/$1/?%{QUERY_STRING}[NC,R,L]
RewriteRule ^about/$ about.php [NC,L]
RewriteRule ^issues/$ issues.php [NC,L]
RewriteRule ^issue/([a-z0-9_\-]+)/$ issue.php?slug=$1 [NC,L]

SetEnv PHP_VER 5
IndexIgnore *
Options +FollowSymLinks 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-23T17:08:59.350

替换 URL 和标志之间缺少一些空格。您还可以按如下方式简化您的第一条规则：

```
RewriteRule ^([a-z0-9._-]+/)*[a-z0-9_-]+$ %{REQUEST_URI}/ [NC,R=301,L] 
```

# asp.net - 什么可能导致“客户端断开连接”ASP.NET 异常？

> ID：809413
> 
> 赞同：32
> 
> 时间：2009-04-30T22:25:19.200
> 
> 标签：asp.net, iis-6, windows-server-2003, load-balancing

我的 .NET 3.5 应用程序偶尔会抛出以下异常 System.Web 异常：

> 客户端断开连接

为什么会发生此异常？我的应用程序在负载平衡的 Windows Server 2003 IIS 6.0 服务器上运行。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-06-11T12:57:07.987

vbdork.net 域现在似乎已失效。在搜索这个错误时，我发现了这篇文章的几个参考。所以我找到了它的谷歌缓存版本，现在将其发布在这里以供参考。原始 URL 为：http: [//vbdork.net/post/2009/02/10/The-client-disconnected.aspx](http://vbdork.net/post/2009/02/10/The-client-disconnected.aspx)

> ### 您收到消息客户端已断开连接。
> 
> 如果您在网络场中并且您有一个用户可以进行多项选择的页面，您可能会偶尔收到此错误消息，这通常发生在这种情况下：
> 
> 用户选择了一个下拉列表框，该下拉列表框在回发时有一个事件，但用户在将请求发送回用户之前再次执行此操作，用户现在正在创建另一个 Web 服务器上触发的第二个事件，前一个网络服务器尝试将旧事件的结果返回给用户，但用户不再存在，因为用户现在在另一个网络服务器上。
> 
> 用户永远不会看到错误，但如果您发现错误并通过电子邮件发送/记录它们，您会看到如下所示的错误并且完全感到沮丧。不用担心，忽略它甚至都不是问题，只要您捕获这种错误就不会出错。
> 
> ```
> Type : System.Web.HttpException, System.Web, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a
> Message : The client disconnected.
> Source : System.Web
> Help link :
> ErrorCode : -2147467259
> Data : System.Collections.ListDictionaryInternal
> TargetSite : Void ThrowError(System.Exception, System.String, System.String, Boolean)
> Stack Trace :    at System.Web.UI.ViewStateException.ThrowError(Exception inner, String persistedState, String errorPageMessage, Boolean macValidationError)
>            at System.Web.UI.HiddenFieldPageStatePersister.Load()
>            at System.Web.UI.Page.LoadPageStateFromPersistenceMedium()
>            at System.Web.UI.Page.LoadAllState()
>            at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)
>            at System.Web.UI.Page.ProcessRequest(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)
>            at System.Web.UI.Page.ProcessRequest()
>            at System.Web.UI.Page.ProcessRequestWithNoAssert(HttpContext context)
>            at System.Web.UI.Page.ProcessRequest(HttpContext context)
>            at ASP.src_rptprefs_chainhierarchy_aspx.ProcessRequest(HttpContext context)
>            at System.Web.HttpApplication.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()
>            at System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously)
> 
>         Inner Exception
>         ---------------
>         Type : System.Web.UI.ViewStateException, System.Web, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a
>         Message : Invalid viewstate.
> 
> Client IP: 10.21.4.8
> Port: 46784
> User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; InfoPath.1; .NET CLR 1.1.4322; MS-RTC LM 8) 
> ```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-30T22:31:12.527

也许是因为“客户端断开连接”......

关闭浏览器，导航到新页面，厌倦了等待应用加载...

说真的，请查看[此页面](http://vbdork.net/post/2009/02/10/The-client-disconnected.aspx)以获取有关该问题的大量信息。

总而言之，这是因为浏览器正在发起一个新请求，该请求在第一台服务器处理原始请求时反弹到第二台服务器。他的建议是简单地忽略它。

我的建议是弄清楚为什么您的负载均衡器没有在后续请求中将客户端固定在同一台服务器上；也称为“粘性”会话。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-12-13T16:35:25.127

另请查看有关类似问题的[答案。](https://stackoverflow.com/a/5351673/241211)在这种情况下没有网络农场。

> `ViewState`当已变为“大”并且用户在前一个请求完成之前单击按钮时，将引发此异常。[...] 这很容易发生，因为回发使用的是 ajax，所以浏览器`ViewState`在发送到服务器时不会停止响应。

[归功于罗素](https://stackoverflow.com/users/665982/russell-clarvoe)克拉沃

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-10-11T11:23:45.977

如果您使用 Telerik 组件，请摆脱 RadCompression 模块。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-19T21:01:07.170

尝试通过在 web.config 中使用 maxPageStateFieldLength 将视图状态分块为多个字段来修复：

```
<pages enableSessionState="true" enableViewState="true" enableViewStateMac="true" validateRequest="false" maxPageStateFieldLength="20"> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-05-15T10:11:52.850

其他可能的原因：您使用的控件实际上不支持 Ajax。Ajax 应该能够处理异步请求，但是某些控件不起作用，例如 Telerik (ajax) 树视图。（像往常一样，等待 Telerik 互联网警察来审查这种不良宣传。）

# editor - 具有自定义语法的最佳文本编辑器

> ID：809415
> 
> 赞同：18
> 
> 时间：2009-04-30T22:25:30.557
> 
> 标签：editor, syntax-highlighting, customization

能够创建自定义语法的最佳文本编辑器是什么？我使用了 notepad++，但自定义语法有点受限，并且插件（即 textFX）有一些错误让我满意。我听说过 Vim 和 Emacs（哪个更好？），但我想要一个具有许多功能的 FAST 编辑器。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-30T22:42:10.160

Vim 和 Emacs**速度**很快并且有很多特性，包括语法高亮。

我个人使用 Vim，但它们都是强大的编辑器。如果您使用 Visual Studio，那么 ViEmu 插件是一个非常好的选择，因为它允许在 Visual Studio 中进行几乎完整的 Vim 编辑。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-30T22:27:54.780

超编辑。很好！ [http://www.ultraedit.com/products/ultraedit/ultraedit_tour.html](http://www.ultraedit.com/products/ultraedit/ultraedit_tour.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-01T00:00:23.857

我喜欢[SciTE](http://www.scintilla.org/SciTE.html)。它非常可定制（使用[lua](http://en.wikipedia.org/wiki/Lua_(programming_language))），并且在 windows 和 linux 上运行良好。修改现有语言规则或添加新语言很容易。一般来说，我只做语法高亮和制表行为，但如果你使用 lua，那就没有限制了。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-07-06T12:35:17.257

The [Zeus editor](http://www.zeusedit.com/) syntax highlighter is highly configurable.

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-30T23:14:44.730

你可能想试试[PSPad 。](http://www.pspad.com/%20)免费且功能丰富。甚至不需要安装，如果您生活在受限环境中（即没有本地管理员权限），这是一个加分项。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-09-07T09:42:09.140

[](http://www.sublimetext.com/)

# **[**崇高的文本**](http://www.sublimetext.com/)**

***   快速地*   轻的*   语法高亮、代码完成、代码折叠*   完全可定制*   自定义语法*   代码片段*   插件*   已经支持多种语言*   小地图导航*   键重新映射*   宏*   正则表达式*   项目处理*   构建和执行脚本/exe*   全屏，多显示器，一次最多 4 列（文件）*   真的快速成长等等...**

 *** * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-30T22:28:09.757

请参阅以下信息： [http ://www.textpad.com](http://www.textpad.com)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-04-30T22:32:03.273

在 Windows 上，[E 文本编辑器](http://www.e-texteditor.com/)支持 TextMate 包，考虑到它们的数量和功能的强大程度，它们似乎很容易创建。（基本上，TM 包可以用你喜欢的任何语言完成繁重的工作。）

但是，它是付费软件，并且在下面使用 Cygwin，这使得它在执行捆绑命令时有点滞后和不稳定。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-04-30T22:50:05.663

对于 Windows，我对[Programmer's Notepad](http://www.pnotepad.org/ "程序员的记事本")很满意有一段时间了。它稳定、可定制、足够轻巧，而且是开源的。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-04-30T23:32:07.463

[notepad2](http://www.flos-freeware.ch/notepad2.html)是一个非常简单易用的工具。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-05-01T08:26:04.030

我对 Visual Studio 非常满意——无论是原生编辑能力、简单的[扩展](http://msdn.microsoft.com/en-us/library/b4c73967(VS.80).aspx) [模型](http://msdn.microsoft.com/en-us/library/174179de(VS.80).aspx) *还是* [可定制的语法](http://msdn.microsoft.com/en-us/library/zy61y8b8.aspx)。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-06-23T13:52:51.703

如果您使用的是 Mac，Smultron 提供了极其简单的自定义语法突出显示。这几乎是指向和点击。您被限制在大约 7 或 8 个不同的标签/关键字组合中，但是一旦我知道在哪里查找，我就花了大约 5 分钟来整理自定义突出显示方案。

我还赞同其他人对 vim 现有语法文件的看法。很有可能有人为你正在做的事情创建了一个语法文件（或接近它的东西）。我的建议：尝试找到一个类似的语法文件，然后将其修改并放在您的 ~/.vim/syntax 目录中。不过，在您遇到麻烦之前，请先阅读 vim 教程（您应该可以在命令提示符下键入“vimtutor”）并查看古怪的键盘命令是否适合您。

至于 Jens Alfke 对 vi 的评论，我经常使用 vim（“VI-iMproved”），并发现在处理多个大型文本文件时，没有箭头键或鼠标的移动速度要快得多。在我浏览 vimtutor 之前，我和 Jens 对神秘的字母命令有同样的感觉——从那时起，vim 一直是我最喜欢的编辑器。唯一的副作用是有时我会在非 vim 文本字段中输入奇怪的字符。:wq

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-07-06T12:48:51.980

试试[HippoEDIT](http://www.hippoedit.com)。这是我抛弃 Notepad++ 后选择的编辑器。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-04-30T22:29:02.123

对于类 C 语言的简单语法突出显示，请尝试使用 Textpad。您可以在几分钟内为您的语言定义运算符、大括号、注释分隔符和关键字。

Komodo Edit、Emacs、VIM 和 Epsilon 编辑器让您能够定义几乎任何类型的语法高亮。如果你非常了解这些编辑器的语法高亮模型（需要几个小时或更长时间来学习），通常你必须花费至少一个小时，但通常是一天来创建你的自定义语法高亮，VIM 是最容易编写语法的突出显示。

我在 Linux 上使用了编辑器[Joe](http://joe-editor.sf.net/)，它也允许用户定义自定义语法高亮，但是它基于状态机的模型没有上一段中提到的编辑器那么强大。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-04-30T23:05:17.857

几年前我也会回答 Textpad，但从那时起开发似乎已经放缓，并且这些天几乎标准的自动突出显示括号完成等功能仍然缺失（请参阅 Textpad 论坛进行讨论）。语法突出显示选项是用户提供的，但多年来一直没有在 Textpad 网站上进行园艺，因此您可以自行查找，例如，11 个 PHP 突出显示中哪一个效果最好。

对我来说最近的一个发现是[Editra](http://editra.org/)，这是一个基于 Scintilla 的应用程序，它快速、多平台和可定制。它仍处于早期版本，但到目前为止在 Windows 上没有给我带来任何麻烦。对于语法自定义，请在安装后查看 library.zip 文件中的语法文件夹。

Komodo 功能强大，但我发现它慢于慢，尤其是在启动时。卸载后，它还在我的注册表中留下了“使用 Komodo 编辑”条目，因此不会被邀请回来。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2017-01-03T18:17:10.600

这适用于 Windows 操作系统

**Atom**是一个很酷的文本编辑器 [https://atom.io/](https://atom.io/)

支持智能自动补全，有很多插件可用。它帮助我使用简单的插件 pretty-json 制作漂亮的 json 文档。**100mb**左右的大尺寸。

但是**感觉编辑器真的很棒**。

# multithreading - 在 Castle Windsor 上注册服务/组件是线程安全的吗？

> ID：809421
> 
> 赞同：3
> 
> 时间：2009-04-30T22:26:53.033
> 
> 标签：multithreading, castle-windsor

在城堡温莎上注册组件是线程安全的吗？

即，多个线程可以同时在同一个容器实例上注册组件吗？

（作为记录，是的，我知道这样做可能很疯狂。）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-01T03:35:41.950

很难判断像 Windsor 这样的复杂软件是否是线程安全的。Windsor 有几个子系统和内部服务。每个组件注册都可以做很多事情（设置代理、不同的生活方式、自定义依赖项......）。AFAIK 没有特定于线程安全的测试。

但是，假设您使用的是默认子系统并且您的线程没有添加自定义贡献者、子解析器等（即只是简单的组件注册），它应该是线程安全的，因为组件注册中涉及的类看起来既可以是无状态或正确锁定。[DefaultKernel](http://fisheye2.atlassian.com/browse/castleproject/trunk/InversionOfControl/Castle.MicroKernel/DefaultKernel.cs?r=5531)主要将操作委托给各种子系统/内部服务，特别是[DefaultNamingSubSystem](http://fisheye2.atlassian.com/browse/castleproject/trunk/InversionOfControl/Castle.MicroKernel/SubSystems/Naming/DefaultNamingSubSystem.cs?r=5358)（服务映射存储子系统）被正确锁定。

我建议您在[城堡用户](http://groups.google.com/group/castle-project-users)或[城堡开发](http://groups.google.com/group/castle-project-devel)谷歌群组中询问，这就是真正的城堡大师所在的地方。

# regex - 编写语法荧光笔

> ID：809423
> 
> 赞同：29
> 
> 时间：2009-04-30T22:27:08.870
> 
> 标签：regex, actionscript-3, syntax-highlighting

我希望为我正在考虑从事的暑期项目编写自己的语法荧光笔，但我不确定如何编写自己的语法荧光笔。

我知道那里有很多实现，但我想了解正则表达式以及语法突出显示的工作原理。

语法高亮是如何工作的，有哪些很好的参考来开发一个？语法荧光笔是在键入每个字符时扫描它，还是在键入每个字符后将整个文档/文本区域扫描？

任何见解将不胜感激。

谢谢。

PS：我打算用 ActionScript 写它

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-04-30T22:44:20.950

语法荧光笔可以以两种非常通用的方式工作。第一个为突出显示的语言实现完整的词法分析器和解析器，准确识别每个标记的类型（关键字、类名、实例名、变量类型、预处理器指令......）。这提供了根据某些规范准确突出代码所需的所有信息（红色的关键字，蓝色的类名，你有什么）。

第二种方式类似于[Google Code Prettify](https://github.com/google/code-prettify)采用的一种方式，它不是为每种语言实现一个词法分析器/解析器，而是使用几个非常通用的解析器，它们可以在大多数语法上做得不错。例如，这个荧光笔将能够很好地解析和高亮任何类 C 语言，因为它的词法分析器/解析器可以识别这些语言的一般组件。

这也有一个优点，因此，您不需要明确指定语言，因为引擎将自行确定其通用解析器中的哪个可以做得最好。当然，缺点是突出显示不如使用特定于语言的解析器时完美。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2017-05-09T08:23:04.357

构建语法高亮器就是在代码中找到特定的关键字并赋予它们特定的样式（字体、字体样式、颜色等）。为了实现这一点，您需要定义特定于编写代码的编程语言的关键字列表，然后解析文本（例如使用正则表达式），找到特定的标记并用正确样式的替换它们HTML 标记。

用 JavaScript 编写的一个非常基本的高亮程序如下所示：

```
var keywords = [ "public", "class", "private", "static", "return", "void" ];
for (var i = 0; i < keywords.length; i++)
{
        var regex = new RegExp("([^A-z0-9])(" + keywords[i] + ")([^A-z0-9])(?![^<]*>|[^<>]*</)", "g");
        code = code.replace(regex, "$1<span class='rm-code-keyword'>$2</span>$3");
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-30T22:40:17.887

在[StackOverflow 播客第 50](https://blog.stackoverflow.com/2009/04/podcast-50/)期中，Steve Yegge 谈到了他创建一些通用高亮机制的项目。不是成品，可能比您正在寻找的更复杂，但可能会有一些有趣的东西。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-06-15T12:05:10.300

[Udacity 课程 CS262](https://www.udacity.com/course/programming-languages--cs262)是一种方法的良好开端。标题是构建一个 Web 浏览器，但该课程真正关注的是您正在寻找的问题 - 如何解析和 lex 一组文本。在您的情况下，您将使用该信息进行突出显示。我刚拿了它，它非常好。课程现在“结束”了，但视频和练习题/作业仍然可以观看。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-30T22:45:07.953

不幸的是，我从未使用过 Actionscript，所以我无法帮助解决这部分问题。

但除此之外，编写语法荧光笔的一个好的开始是查看现有的。例如，[vim](http://www.vim.org)具有普通文本文件形式的语法文件，因此您可以先查看这些文件。那里有一堆正则表达式（正则表达式有几种风格，但它们并没有太大的不同......），所以对于这部分你可能会看一些书。

就个人而言，我发现[Beginning 正则表达式](https://rads.stackoverflow.com/amzn/click/com/0764574892)是一个不错的表达式。[掌握正则表达式](http://oreilly.com/catalog/9781565922570/)对于更高级的科目也很好。[另一方面，正则表达式袖珍参考](https://rads.stackoverflow.com/amzn/click/com/059600415X)非常适合确定上述风格的差异，因为它还包括关于 vim 正则表达式的一章。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-30T22:36:18.253

如果您解释此语法荧光笔的用途可能会有所帮助。如果您是在动作脚本中编写它，您的想法是在 Flash 电影中使用一个文本框并在按下提交按钮后突出显示语法吗？或者您想从某个 web 服务中读取文本，然后显示突出显示的语法？...我很难提供帮助，因为我很难想象你在做什么

但是，语法高亮器读取文本，然后将代码行与一些正则表达式进行比较，这有助于语法高亮器找出单词的含义。例如，它可能会将单词“function”或“int”读取为保留字，并将它们替换为 html 文本：

```
<span class="reserved">function</span>, <span class="reserved"></span> 
```

假设你有 css 并且想要红色的保留字，

```
.reserved{
  color: #ff0000;
} 
```

这是基本概念，您可能想从[geshi](http://qbnz.com/highlighter/)那里获取想法，因为您可以查看源代码。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-17T01:00:45.573

前段时间我在我的博客上发布了一个 SQL 代码着色工具：http: [//gruchalski.com/2009/04/26/flex-textrange-performance-issue-on-linux/](http://gruchalski.com/2009/04/26/flex-textrange-performance-issue-on-linux/)

您可以找到包含源代码的 sqlcodecoloring.zip 链接。它是使用标记器和 TextRange 类实现的。

另一个链接，作为原型应用程序一部分的 sql 代码着色：http: [//github.com/radekg/mysqlinterface/tree/master](http://github.com/radekg/mysqlinterface/tree/master)

# c# - ASP.NET - 如何使用 MVC 模式通过服务器端代码 (C#) 加载页面？

> ID：809430
> 
> 赞同：0
> 
> 时间：2009-04-30T22:28:29.910
> 
> 标签：c#, asp.net, javascript

我正在尝试使用更多的服务器端代码（MVC 模式），我正在考虑实现的方法之一是：LoadWebPage()。如果用户在一个页面上，比如 Page1.aspx，并且他们点击了一个超链接，我想调用上面的方法 LoadWebPage()。但问题是，我不知道如何将另一个页面加载为子窗口（模态表单），例如通过服务器端的 Page2.aspx？我是否使用 Server.Transfer()、Response.Redirect() 或 JavaScript（例如 jQuery）来加载页面？我当然想坚持会话。

顺便问一下，有没有办法通过服务器端代码（C#）调用 JavaScript？

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T22:46:47.993

看起来您正在尝试使用标准的 ASP.net WebForms 框架执行 MVC。现在对您来说可能有点晚了，但是您看过 ASP.net MVC 框架了吗？这可能会让你的生活更轻松。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-30T22:54:39.397

我使用 ASP.NET MVC 已经有一段时间了，我使用 jquery 来做你正在做的事情。您要做的是创建另一个视图，该视图将由 jquery 使用 AJAX 调用检索。例如，在您的情况下，我会有一个带有动作的`Controller`命名（当然还有相应的 view ）。jQuery 会简单地调用 URL：`AjaxController``LoadWebPage``LoadWebPage.aspx`

```
$.get('<%= Url.Action("LoadWebPage", "Ajax") %>', function(data) {
    $('#mydiv').html(data); // here we load the contents of the page to a div with an id of 'mydiv'
}); 
```

基本上，你的方法应该是相反的。通过 jQuery 使用客户端来加载页面，而不是相反。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-30T22:34:49.723

我想你可能在这里混合了一些模型。如果您希望在页面加载后触发一个事件，这通常称为 PostBack，如果您查看 Button 控件及其事件，有一些特定的方法可以在 ASP.NET 中触发该`On_Click`事件。

要将用户路由到另一个页面，这取决于您希望发生的事件序列：

1.  请求只是转移到`Page2.aspx`加载。在这种情况下，`Server.Transfer`只要您认识到客户端不会知道这`Page2`是他们请求的当前 URL，就可以了`Page1.aspx`。

2.  将用户路由到不同的页面，更新浏览器的历史记录。在这里，您使用 a`Response.Redirect`将客户端发送到`Page2.aspx`并可以设置完成工作所需的任何查询字符串参数。

3.  AJAX 处理。如果您不想进行回发，有一些方法可以使用 AJAX 来处理调用服务器端函数而无需用户离开页面。然而，这可能是最棘手的，也是最巧妙的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-30T22:37:14.930

嗯... Page1.aspx，Page2.aspx .. 这不是 MVC ...您正在使用 webforms 模型。

至于在模态窗口中打开子页面，有几十个例子。你可以很聪明地使用[ASP.Net AJAX](http://www.asp.net/ajax)和[AjaxControlToolkit](http://www.asp.net/ajax/ajaxcontroltoolkit/)

您可以使用来自[Telerik等供应商的第 3 方商业控制](http://www.telerik.com/products/aspnet-ajax.aspx)

您可以使用[jQuery](http://jquery.com/)`iFrame`并以使用标准获取请求的方式加载弹出模式表单...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-30T22:56:04.930

如果您不打算使用 MVC 框架 ( [http://www.asp.net/mvc](http://www.asp.net/mvc) )，我将使用 MVP 模型。WebForms 本身对 MVC 不友好。

现在，如果您想在另一个页面中加载一个页面，您可以使用 IFrame 来执行此操作。

如果您想将用户控件加载到您的页面上，您实际上可以将控件从工具箱中拖放到您的表单上。

但是你真的应该得到一本 Web 开发书籍，或者浏览 ASP.NET 网站上的示例。

编辑：从服务器端调用 JavaScript 并不容易。但是您可以使用 JavaScript 调用可能在您的服务器上的 Web 服务。JavaScript 可以在页面加载时运行。

编辑 2：我看到的另一个让桌面开发人员感到困惑的项目：如何导航。我认为这也可能会给您带来一些麻烦。

该链接本身将告诉浏览器重定向到另一个页面。您不想为此返回服务器。它不是必需的。该链接需要另一个属性：`target="_blank"`并且下一页将出现在弹出对话框中。您通过查询字符串参数将数据传递给弹出窗口。否则，您也可以将数据“保存”到会话中。

注意：整个浏览器弹出模型已损坏。在选项卡式浏览器和弹出窗口拦截器之间，您会遇到麻烦。如果您可以使用普通浏览器导航并完全放弃整个弹出窗口的想法，那就最好了。您在桌面上使用的 UI 范例并不总是适用于 Web。

# javascript - 在页面正文中保持 jQuery .getJSON() 连接打开并等待？

> ID：809434
> 
> 赞同：2
> 
> 时间：2009-04-30T22:29:43.653
> 
> 标签：javascript, jquery, comet, server-push

我正在编写一个基本的推送消息系统。一个小的变化导致它停止正常工作。让我解释。在我的原始版本中，我能够将代码放入文档中，如下所示：

```
<head>
  ...text/javascript">
  $(document).ready(function(){
    $(document).ajaxStop(check4Updates);
    check4Updates();
  });

  function check4Updates(){
    $.getJSON('%PATH%', callback);
  };
...
</head> 
```

这工作得很好，即使服务器返回 null（它会在 2 分钟超时之后）也会保持连接打开。它只会无限期地一遍又一遍地调用 getJSON 函数。快乐的熊猫。

现在，我必须将代码段放在标签之间。访问 $(document).ready() 函数几乎是行不通的。

```
<body>
...
check4Updates();
$("body").ajaxStop(check4Updates);
...
</body> 
```

这工作......一段时间。此后不久，它将停止调用 check4Updates 并进入无限循环并使用 100% 的处理器时间。

我正在尝试获取它，以便重复调用 check4Updates 直到页面关闭。如果有人对为什么我的简单更改不再按预期运行有任何见解，请告诉我。感谢您花时间阅读并帮助我。

最好的问候，范阮

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-30T23:11:29.463

是的，你不会想要使用那个循环，你几乎是在[做](http://en.wikipedia.org/wiki/Denial-of-service_attack)自己，更不用说锁定客户端了。

很简单，创建一个投票插件：

来源：[http ://web.archive.org/web/20081227121015/http://buntin.org:80/2008/sep/23/jquery-polling-plugin/](http://web.archive.org/web/20081227121015/http://buntin.org:80/2008/sep/23/jquery-polling-plugin/)

用法：

```
$("#chat").poll({
    url: "/chat/ajax/1/messages/",
    interval: 3000,
    type: "GET",
    success: function(data){
        $("#chat").append(data);
    }
}); 
```

备份它的代码：

```
(function($) {
    $.fn.poll = function(options){
        var $this = $(this);
        // extend our default options with those provided
        var opts = $.extend({}, $.fn.poll.defaults, options);
        setInterval(update, opts.interval);

        // method used to update element html
        function update(){
            $.ajax({
                type: opts.type,
                url: opts.url,
                success: opts.success
            });
        };
    };

    // default options
    $.fn.poll.defaults = {
        type: "POST",
        url: ".",
        success: '',
        interval: 2000
    };
})(jQuery); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T22:39:09.340

使用超时，这些类型的循环是一个非常糟糕的主意，所以如果您出于某种原因必须使用轮询，请确保您不要一直敲打您的后端。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-10T16:42:26.873

您要么需要更改为 altCognito 描述的轮询方法，要么可以使用 comet，它旨在将数据从服务器推送到客户端。根据您的需要，您可以使用类似 Jetty (for Java) 或 Twisted (Python) 或[WebSync](http://www.frozenmountain.com/websync) (ASP.NET/IIS)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-14T03:23:02.580

我认为这是关于服务器推送？

使用 Socket.IO 怎么样？

参考：Google Group ( [http://socket.io/](http://socket.io/) )介绍 Socket IO 0.9

参考：[http ://techoctave.com/c7/posts/60-simple-long-polling-example-with-javascript-and-jquery](http://techoctave.com/c7/posts/60-simple-long-polling-example-with-javascript-and-jquery)

参考： websockets、Node.js 和 jQuery 的乐趣 ( [http://nayna.org/blog/?p=159](http://nayna.org/blog/?p=159) )

# c# - 在 WinForms 中托管 IE 8 并打开 PDF

> ID：809442
> 
> 赞同：6
> 
> 时间：2009-04-30T22:31:27.703
> 
> 标签：c#, vb.net, file, internet-explorer-8, acrobat

我们有一个承载 WebBrowser 控件的表单。这是表单上的唯一控件。

我们将临时 PDF 文件的文件路径传递给表单，它会：

```
WebBrowser1.Navigate(Me._PathToPdf) 
```

当表单关闭时，它会离开 PDF 文件：

```
WebBrowser1.Hide()
WebBrowser1.Navigate("about:blank")

Do Until WebBrowser1.ReadyState = WebBrowserReadyState.Complete
    Application.DoEvents()
    System.Threading.Thread.Sleep(50)
Loop 
```

一旦表单关闭，调用类就会删除临时 PDF 文件。

这个过程非常有效......直到我们安装了 Internet Explorer 8。出于某种原因，IE8 和 Adob​​e Acrobat 8​​（或 9）的组合导致在临时 PDF 文件上放置了一个额外的文件锁定句柄。在整个应用程序关闭之前，额外的锁定句柄不会消失。我还应该提到，在 Acrobat 打开文件之前，文件上没有锁定。

我们可以在多台机器上重现它，它总是 IE8 和 Adob​​e Acrobat Reader 的组合。我们可以安装 Foxit Reader 3 而不是 Adob​​e Acrobat，一切正常。同样，我们可以在装有 IE7 和 Adob​​e Acrobat 的机器上运行该应用程序，一切正常。但是，当您将 IE 8 和 Acrobat 的魔药混合在一起时，您最终会变得一团糟。

谁能告诉我为什么我得到一个额外的文件锁，它一直持续到应用程序结束？

谢谢。

可以在此处找到演示我的问题的示例应用程序：[PDFLockProblemDemo.zip](http://www.centrolutions.com/downloads/PDFLockProblemDemo.zip)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T15:17:50.907

仍然没有找到解决方案，但有更多信息：以前我使用 XP Pro、Acrobat *.x 和 .NET 2.0（使用 VS 2005 构建）进行了测试。从那时起，我还在各种场景中进行了测试，包括 Vista、Acrobat 9.x 和 .NET 3.5（使用 VS 2008 构建）。

但是结果相同：只要浏览器是 IE8，当您在 WebBrowser 控件上调用 Dispose() 时，PDF 文件就不会被释放。当应用程序关闭时它确实会被释放，但这对我们没有帮助......

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T15:00:45.520

在我看来，真正的问题是使用`WebBrowser`控件来托管 Adob​​e Reader 网络浏览器插件来显示 PDF。难道没有更好的方法来直接显示 PDF 而不引入对 Web 浏览器的依赖吗？Adobe 不提供可以直接在表单中托管的 SDK 或 ActiveX 控件吗？

* * *

更新：我环顾四周，发现[这篇文章](http://www.ureader.com/message/819807.aspx)他们访问 Adob​​e ActiveX 控件 ( `AxAcroPDFLib.AxAcroPDF`) 并简单地调用：

```
axAcroPDF1.LoadFile("mypdf.pdf");
axAcroPDF1.Show(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-11-25T15:48:59.590

我有一个不需要任何临时文件的答案。

在我不想重写所有代码以使用临时文件之后，我被迫创建一个解决方案。

所以，这就是你要做的。

1.  创建一个字符串列表来保存要删除的文件
    `Dim filesToDelete As List(Of String) = New List(Of String)`

2.  您需要将网络浏览器设置为另一个 pdf 文件，
    （我创建了一个空白文件 - 黑色或白色；任何适合您的文件）。
    所以喜欢`webbrowser1.navigate("blank.pdf" )`

3.  将要删除的文件添加到字符串列表中。所以`filesToDelete.Add(filename)`

4.  现在，这是诀窍。在您退出此事件之前，不会释放资源。
    因此，您需要关注会导致另一个事件被触发的其他事情。
    就我而言，我使用树视图来查看 pdf。
    因此，在使用上述方法将文件标记为删除后，
    我会将树视图设置为不同的文件。
    所以在这个`TreeView1_BeforeSelect`方法中，我做了很明显的事情：

    `If filesToDelete.Count > 0 Then`
        `For Each f As String In filesToDelete`
           `File.Delete(f)`
        `Next`
        `filesToDelete.Clear()`
    `End If`

    你可以采用你自己的事件，但我确信在为删除做标记之后，你可以找到一些会导致另一个事件触发的事情。只需按照您的代码流程，接下来会发生什么。

所以你有它。希望这对某人有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T12:27:09.307

我们在使用 IE8 和 Acrobat 时遇到了同样的问题。在我们的例子中，我们只需要能够覆盖临时 PDF 并重新显示它。我们发现我们可以简单地打开 PDF，写入 0 个字节然后关闭。之后，我们将打开文件并写入新的 PDF 信息，然后重新显示临时文件。

总之，我们并没有解决文件锁定问题，而是我们只是保留了文件句柄并重复使用文件，直到用户关闭应用程序。

希望这可以帮助。

# windows - 如何将文件安装到 Installshield Installscript-MSI 项目中的注册表项/值所指向的目录？

> ID：809459
> 
> 赞同：1
> 
> 时间：2009-04-30T22:40:15.233
> 
> 标签：windows, installation, registry, installshield, installscript-msi

我安装中的一个文件需要复制到用户目标计算机上的注册表键/值对指向的位置。

现在，我有一种笨拙的解决方案，我将文件设置为复制到组件视图中的 [TempFolder]，然后在我的 OnFirstUIBefore() 函数中获取一些自定义 InstallScript 代码，该代码从注册表中获取值，然后执行[TempFolder] 上的 MSIGetProperty，最后是 [TempFolder] 中的 CopyFile() 进入我们之前从注册表中获取的路径。

这可行，但有点麻烦。一位同事说他认为我*应该*能够对自定义属性名称（如 MY_RSRC_DIR）执行 MSISetProperty，然后以某种方式在“组件”窗格中使用该自定义属性将文件复制到正确的位置。

我可以在 OnBegin() 函数中执行 MSISetProperty，但是尝试将该属性插入到组件视图中是我还不能开始工作的事情。

有没有人这样做过，如果有，怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T18:52:20.297

In an InstallScript MSI project, you should take the MSI approach. Create an auxiliary folder (for example adding it to the Files and Folders view), and add your files to it. Make sure to find out its directory property (something like NEWFOLDER1; make sure it's all upper-case). If you want, you can edit the Directory table to make this a child of TARGETDIR, but that's optional and can result in files being placed under [WindowsVolume] if the registry search fails, so it's probably best to leave it as a child of INSTALLDIR.

Then if you can locate the directory before costing (i.e. before CostInitialize, which OnBegin would be), you can set the property (e.g. NEWFOLDER1) with a System Search, SetProperty custom action (type 51), or MsiSetProperty(). If you must find it after costing, you'll need to use either a SetDirectory custom action (type 35), or MsiSetTargetPath(), as the property will no longer update the directory.

This way Windows Installer will track the file location for you and uninstall should work properly.

# java - java匿名类和同步以及“this”

> ID：809464
> 
> 赞同：11
> 
> 时间：2009-04-30T22:41:12.843
> 
> 标签：java, synchronization, class, this, anonymous

我相信，在我的 JAVA GUI 中，我正在处理一个竞争条件。

我有一些方法可以在这样的匿名类中创建“匿名方法”：

```
synchronized foo()
{
     someMethod(new TimerTask()
     {
          public synchronized run()
          {

               //stuff

          }
     };
} 
```

问题：该运行方法是在 TimerTask 对象上同步还是在 foo 所在的类上同步？

QUESTION2：如果我去掉了 run() 声明中的“synchronized”，而是在 run() 主体内有一个 synchronized(this) {} 块，“this”是指 TimerTask 对象还是指是包含 foo() 的方法的实例吗？

请帮帮我。

谢谢，jbu

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-30T22:49:38.393

该`run`方法在`TimerTask`自身上同步。同步[的实例方法*总是*在`this`](http://java.sun.com/docs/books/jls/third_edition/html/classes.html#8.4.3.6)对象上同步。（类方法在`Class`对象上同步。）

如果要在其`foo`成员对象上进行同步，则需要[限定`this`关键字。](http://java.sun.com/docs/books/jls/third_edition/html/expressions.html#15.8.4)假设`foo()`是`Bar`类的成员，在 的`run()`方法里面`TimerTask`，可以使用

```
public void run() {
  synchronized(Bar.this) {
    ...
  }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-30T22:46:25.530

我很确定这些答案，但我无法找到一个好的来源 atm。

第一个问题：
synchronized会锁定TimerTask。

第二个问题：
this指的是TimerTask；如果您想锁定包含对象，请使用 MyContainingObject.this

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-30T23:14:12.547

只有一个线程可以访问摆动元素。那是 AWT-EventQueue-0。你需要意识到这一点。如果您的其他线程正在淹没或更改元素，则 gui 很可能会崩溃。用这个线程运行你的 gui：

```
  尝试 {
            SwingUtilities.invokeAndWait(new Runnable(){
                公共无效运行（）{
                    Swing_Prozor1 prozor = 新 Swing_Prozor1();
                }
            });
        } 捕捉（InterruptedException e）{
            //namjerno zanemareno
        } 捕捉（InvocationTargetException e）{
            //namjerno zanemareno
        }

```

如果你有匿名类，这会给你你所在的类的实例，所以如果你在匿名类中写这个。是该类的实例。要获取您想要编写的类的实例：

> 类名.this

嗯，你写的上面的代码告诉我这一点。您两次保护了部分代码。当您编写同步方法时，这意味着一次只有一个线程可以访问该方法。其他线程在同步方法解锁时等待。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T11:35:53.950

如果您正在寻找同步 foo() 和 run() 那么您可以创建一个显式锁定对象，例如

最终对象锁 = 新对象（）；

然后同步就可以了。

```
foo() {
    synchronized(lock) {
       someMethod(new TimerTask() {
          public void run() {
              synchronized(lock)  {
                     //stuff
              }
          }
      } 
```

# nhibernate - nhibernate 会为我的存储过程生成包装器吗？

> ID：809467
> 
> 赞同：2
> 
> 时间：2009-04-30T22:42:16.790
> 
> 标签：nhibernate

刚刚进入nhibenate。

它会为我的存储过程生成包装器吗？

我正在尝试构建产品，不确定是否还有其他可能更好的产品？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-30T23:01:07.273

有许多代码生成器将创建 NHibernate 映射和来自 Datamodel 的类。不确定是否会生成 SP 签名。如果 SP 都遵循相同的结构，那么您可以创建自己的模板并从中生成代码 - 试试[MyGeneration](http://mygenerationsoftware.com)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-11T22:52:34.930

据我了解 - Fluent-NHibernate 不支持存储过程。这意味着 - 您必须在 xml 中手动添加这些地图。

并谨慎使用 Linq To Entity Framework。对我来说，它只映射了头痛。：/

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-30T23:06:14.047

NHibernate 是一个对象关系映射 (ORM) 库。它是通过 XML 配置的，或者您可以使用[Fluent-NHibernate](http://code.google.com/p/fluent-nhibernate/)，它使用代码来配置映射。

NHibernate 不是代码生成器。一个好的代码生成器是[CodeSmith](http://www.codesmithtools.com/)或[LLGLGen Pro](http://www.llblgen.com/defaultgeneric.aspx)。如果您是高级程序员，您可以使用 Visual Studio 2008 中的 T4 模板。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-11T15:00:34.630

您可以像这样调用存储过程：http: [//knol.google.com/k/fabio-maulo/nhibernate-chapter-14/1nr4enxv3dpeq/17#14%282E%293%282E%29%28C2%29%28A0% 29Custom_SQL_for_create%282C%29_update_and_delete](http://knol.google.com/k/fabio-maulo/nhibernate-chapter-14/1nr4enxv3dpeq/17#14%282E%293%282E%29%28C2%29%28A0%29Custom_SQL_for_create%282C%29_update_and_delete)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-30T22:53:03.707

nHibernate 不生成任何东西，它不是代码生成器。您可以使用 nHibernate 与存储过程通信，但您必须自己编写映射。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-30T23:00:57.227

会因为这个而被标记...叹息

如果您想要的只是存储过程的包装器，并且您使用的是 SQL Server，则可以考虑使用 LINQ to SQL 或实体框架。这对你来说可能会少一些工作。通常它只是一个拖放操作，一切都为您映射。

否则，克雷格所说的（大部分）是真的。您必须自己为存储过程创建 hbm 映射。

# ruby-on-rails - 表单提交后数据返回浏览器时单位转换导致问题--Ruby on Rails

> ID：809488
> 
> 赞同：0
> 
> 时间：2009-04-30T22:50:47.627
> 
> 标签：ruby-on-rails, ruby

**背景，第 1 部分**我有一个表格，可以收集用户的频率和持续时间。我们以秒为单位设置频率和持续时间，但对用户来说，它们总是以天或周的形式呈现。例如，用户看到“每隔一天”，但选项上设置的值是“172800”，因为它是 2 天的秒数。

**背景，第 2 部分**我正在开发一个应用程序，我们希望用户拥有一个邀请码以便能够使用。因此，作为注册的一部分，用户必须输入连接到特定电子邮件地址的邀请码。

**背景，第 3 部分**我是 RoR 的新手，正在研究其他人的代码。我已经读到第 3 版“使用 Rails 进行敏捷 Web 开发”的 10 章了。写这篇文章的人直到下周某个时候才能让我问他们问题，我想在那之前解决这个问题。如果在那之前我没有得到解决方案，一旦我得到答案，我会在这里发布答案。

**问题**当用户提交表单时，除了邀请码和电子邮件地址之外的所有内容都匹配，表单返回并且频率和持续时间不会重新填充。现在，我知道为什么会这样了。我只是不知道如何解决它。让我们深入研究一些代码，好吗？

这是创建持续时间和频率选择表单字段的 RoR 代码：

```
<%= frequency_select c, :frequency %> 
<%= duration_select c, :duration %> 
```

这是“frequency_select”的详细信息

```
def frequency_select(f, method)
    options = [["day", 1.day], ["other day", 2.days], ["week", 1.week]]
    f.select method, options, :include_blank => true
end 
```

这是“duration_select”的详细信息

```
def duration_select(f, method, unit="day" )
    values, units = *case unit
        when "day" : [[[5, 5], [15, 15], [30, 29]], "days"]
        when "other day" : [[[15, 15], [30, 29], [45,45]], "days"]
        when "week" : [[[4, 29], [6, 43], [8, 57]], "weeks"]
    end
    f.select method, values.map {|(label, i)| ["#{label} #{units}", i.days]}, :include_blank => true
end 
```

现在，有趣的部分。这是“：频率”的代码

```
def frequency(unit=:days)
    seconds = super
    convert_seconds_to_units(seconds, unit)
end 
```

（等一下。）

这是 ":duration" 的代码

```
def duration(unit=:days)
    seconds = super
    convert_seconds_to_units(seconds, unit)
end 
```

不重新填充持续时间和频率字段的原因是，在频率和持续时间转换为天数*之后，会进行匹配邀请代码和电子邮件地址的检查。*

看，如果表单除了电子邮件和邀请代码不匹配之外还有其他错误，则不会发生从秒到天的转换。但是，如果其他所有内容都检查完毕，则会发生转换，然后比较邀请代码和电子邮件地址。如果出现错误，数据将返回浏览器，但持续时间和频率值现在以天为单位，与 HTML 表单中的持续时间和频率值（以秒为单位）不匹配。

所以，我的问题是——我想这是一个完整的新手问题——在邀请代码和电子邮件地址匹配之前，你如何推迟转换频率和持续时间值。

让我知道您是否需要查看更多代码。我试图在不压倒你的情况下提供你需要的一切。不过，如果我错过了什么，请告诉我。

谢谢！瑞克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-01T13:34:08.627

我认为你在试图在秒和天之间转换时让自己陷入困境。如果您在为您进行转换的天数中有特定的频率/持续时间访问者会更容易：

```
def frequency_in_days
  self.frequency && self.frequency / 86400 
end

def frequency_in_days=(days)
  self.frequency = days.to_i * 86400
end 
```

然后在您的表单中，您可以执行以下操作：

```
<%= frequency_select c, :frequency_in_days %> 
```

在你的助手中：

```
def frequency_select(f, method)
  options = [["day", 1], ["other day", 2], ["week", 1]]
  f.select method, options, :include_blank => true
end 
```

应该让一切变得更简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T20:04:05.690

我找不到合适的解决方案。主要问题是我不应该将秒数转换为天数——我应该只使用天数。

tomafro 解决方案的问题是我需要 2 个脚本来生成持续时间和频率选择选项的选项，这是可行的，但是所有这些额外的代码都引出了一个问题：为什么我首先需要转换？我不确定我是否这样做。我将进一步研究这一点，看看更改它是否会产生无法预料的错误。

# mfc - 如何启用 AfxMessageBox 是/否（MB_YESNO）“关闭”按钮？（右上角“X”）

> ID：809491
> 
> 赞同：5
> 
> 时间：2009-04-30T22:52:28.793
> 
> 标签：mfc, windows-vista, dialog, messagebox

调用时：

```
AfxMessageBox(strMsg, MB_YESNO); 
```

显示带有“是”和“否”按钮的消息框。但是右上角的“X”（关闭按钮）是禁用的，按ESC没有效果。

这是因为唯一有效的结果是 IDYES 和 IDNO，而不是 IDCANCEL。

是否有快速启用此行为的方法？我想避免的：

*   为此创建一个自定义对话框。
*   有是/否/取消按钮。

在vista中，删除文件时，要求确认的对话框只有“是”和“否”，也可以用关闭按钮或ESC取消。我猜这是一个自定义对话框。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-30T23:06:33.970

AfxMessageBox() 只是在内部调用[MessageBox()](http://msdn.microsoft.com/en-us/library/ms645505(VS.85).aspx)。所以，不，如果不使用添加按钮的 MB_YESNOCANCEL，您将无法在此处获得所需的行为......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T21:21:34.833

不是这样，但 Hans Dietrich 的免费[XMessageBox](http://www.codeproject.com/KB/dialog/xmessagebox.aspx)是标准消息框的功能非常丰富的扩展。你可能想要你检查一下。

另外，我不太明白为什么您不想要取消按钮却想要一个功能相同但不那么明确的 UI 元素。

编辑：回答您的评论：

如果“否”可以与“取消”互换，那么我认为“否”是一个不好的标签选择。例如：DeleteFolder() 函数询问的 Q：

“我也应该清空子文件夹吗？”。显然，no 和 Cancel/Escape 的含义不同。

OTOH，“删除文件？” 看起来按钮应该是是/否。但我更喜欢确定/取消。因为您要求用户确认，而不是要求用户提供更多信息。在这种情况下，让 Escape 键/红十字会起作用肯定是一个加分项。

# c# - 为什么 SelectSingleNode 返回 null？

> ID：809496
> 
> 赞同：6
> 
> 时间：2009-04-30T22:53:53.673
> 
> 标签：c#, xml, xmldocument, xml-attribute, selectsinglenode

我正在使用一个 XML 文档，该文档包含一个类似于此的结构：

```
<MT>
  <Events>
    <event id="1">
      <field name="blah" value="a_value" type="atype" />
      .
      .
      .
     </event>
   </Events>
 </MT> 
```

我目前正在以这种方式将其从文件加载到 XML 文档中：

```
XmlDocument xdoc = new XmlDocument();
xdoc.Load("somefile.xml");  //Successfully loads btw 
```

但是，当我尝试运行下一行代码时，我遇到了一个问题，并且只有这个特定的文档：

```
xdoc.SelectSingleNode("//event[@id='1']"); //This returns a null 
```

由于使用名为“id”的属性存在问题，我猜测这是返回 null，还是我在代码中遗漏了什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-30T23:10:10.310

我无法使用 XML 文件复制它

```
<MT>
  <Events>
    <event id="1">
      <field name="blah" value="a_value" type="atype" />
     </event>
   </Events>
</MT> 
```

和代码

```
XmlDocument doc = new XmlDocument();
doc.Load(@"C:\test.xml");

XmlNode node = doc.SelectSingleNode("//event[@id='1']"); 
```

这将按预期返回一个非空节点。

**更新**

将 a 添加`xmlns="example.org"`到`<MT>`元素后，我必须为 XPath 配置命名空间管理器并为事件使用命名空间。由于某种原因，无法让默认命名空间工作。

```
XmlDocument doc = new XmlDocument();
doc.Load(@"D:\test.xml");

XmlNamespaceManager manager = new XmlNamespaceManager(doc.NameTable);
manager.AddNamespace("e", "http://example.org");

XmlNode node = doc.SelectSingleNode("//e:event[@id='1']", manager); 
```

*试图让它发挥作用时，有一件事让我感到困惑。为什么 XmlNamespaceManager 需要文档中的 XmlNameTable 如果不是为了找出它包含哪些命名空间？如，为什么我需要定义 NameTable**和**命名空间？如果知道的人可以发表简短评论，我将不胜感激。*

# java - 如何将自定义启动类添加到 tomcat？

> ID：809499
> 
> 赞同：3
> 
> 时间：2009-04-30T22:55:37.520
> 
> 标签：java, tomcat

在启动任何 Web 应用程序或侦听器之前，我需要在 Tomcat 6.0 中调整一些东西。这样做的标准方法是什么？我无法从 Web 应用程序或 servlet init() 执行此操作，因为它在加载时为时已晚。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-30T23:00:47.133

创建自定义[LifecycleListener](http://tomcat.apache.org/tomcat-6.0-doc/api/org/apache/catalina/LifecycleListener.html)可能是这样做的正确方法。有关详细信息，请参阅[Tomcat 配置指南；](http://tomcat.apache.org/tomcat-6.0-doc/config/)生命周期监听器可以添加到大多数容器中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T21:36:00.337

您可以运行“嵌入式 Tomcat”，您可以在其中完全控制其设置，就像通常使用 Jetty 的方式一样。

谷歌指出以下文档：

*   [ [http://www.theserverside.com/discussions/thread.tss?thread_id=30625]](http://www.theserverside.com/discussions/thread.tss?thread_id=30625])
*   [ [http://tomcat.apache.org/tomcat-5.5-doc/catalina/docs/api/org/apache/catalina/startup/Embedded.html]](http://tomcat.apache.org/tomcat-5.5-doc/catalina/docs/api/org/apache/catalina/startup/Embedded.html])

这似乎在 Tomcat 5.5 中涵盖了这一点，但也应该与 6 一起使用。

# caching - 清除 xsl 图像缓存

> ID：809502
> 
> 赞同：2
> 
> 时间：2009-04-30T22:56:53.947
> 
> 标签：caching, xsl-fo

我有一个 xsl:fo 样式表，它引用了一个图像 URL。在我的代码中，我更改了 URL 指向的 jpg 文件。然后我希望使用 xsl 创建一个 pdf，并希望它包含当前位于 URL 的任何文件。但是，XSL 会缓存图像，这样一旦创建了 PDF 并更改了图像，下次创建 PDF 时就会使用旧图像。

1.  显然，最好的解决方案是清除 xsl 缓存。但是，我只能访问 xslt 文件本身，是否有 xsl/xml 命令来清除图像缓存？
2.  我的第二个解决方案涉及在创建 jpg 时对其进行时间戳记。如果我将 jpg 放在它自己的目录中，那么我必须读取该目录并获取其中唯一的文件，然后在 xsl 中使用它。但是，我是 xsl 新手，不知道如何读取目录。

第一个解决方案显然更优雅，但我也不知道该怎么做。

有任何想法吗？？？？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-07T17:08:41.160

我不知道您使用的是什么语言/库，但就我而言，使用 Java 和 Apache FOP，我终于发现我需要调用`FopImageFactory.resetCache();`（这是针对 FOP 0.20，此后 API 已更改）。只是为了它，以防其他人在同样的情况下失去一些时间来寻找解决方案:)

# sql-server - 如何运行返回值的 TSQL 脚本？

> ID：809506
> 
> 赞同：0
> 
> 时间：2009-04-30T23:00:08.353
> 
> 标签：sql-server, sql-server-2005, tsql

我说它是 TSQL 是否正确？我是数据库脚本的新手。这叫做脚本吗？我是这方面的新手，真的。

我刚刚在 SQL Server Management Studio 中写了一个存储过程：

```
CREATE PROCEDURE dbo.LogTable_Count

@Count INT OUT

AS

SELECT @Count = Count(ExperimentId) FROM LogTable

GO 
```

我想通过调用类似的东西来测试脚本：

执行 logtable_count

但管理工作室说它需要一个参数@Count，但没有提供。我如何写几行特别的行来测试这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T03:18:28.967

您也可以使用 RETURN 语句从存储过程返回一个整数值（只有一个整数）。

您的存储过程看起来会有些不同：

```
CREATE PROCEDURE dbo.LogTable_Count  
AS
DECLARE @Count int
SELECT @Count = Count(ExperimentId) 
FROM LogTable
RETURN @Count
GO 
```

您必须像这样调用您的存储过程：

```
DECLARE @RC int
EXEC @RC=dbo.LogTable_Count
PRINT @RC --or SELECT @RC 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T17:20:50.343

因为 COUNT(*) 表示计算结果集中的行数。Count(ColumnName) 表示计算结果集中该列不为空的行数。

见 - [http://sqlinthewild.co.za/index.php/2009/04/14/on-counts/](http://sqlinthewild.co.za/index.php/2009/04/14/on-counts/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T17:33:38.643

对于像这样的单个值，我更喜欢使用函数，因为您可以在 select 语句中使用它们：

```
print 'Creating countRows Stored Proc ...'
go
if exists (select * from dbo.sysobjects where  name = 'countRows') drop function countRows;
go
create function dbo.countRows()
   -- **************************************************************************
   --  Procedure: countRows()
   --     Author: Ron Savage
   --       Date: 05/01/2009
   --
   --  Description:
   --  This function counts the rows in a table and returns it.
   -- **************************************************************************
   returns integer
begin
   return(select count(*) from mytable);
end
go

-- Now you can use it in a select ...
select dbo.countRows()
go

-- Or store it in a variable ...
declare @mycount integer

select @mycount = dbo.countRows()

select @mycount
go 
```

像那样。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-30T23:07:42.483

```
declare @myout int
exec logtable_count @myout
print @myout 
```

编辑：正如正确答案所述，中间线应该是：

```
exec logtable_count @myout OUTPUT 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-30T23:07:42.953

```
DECLARE @Count INT

EXEC logtable_count @Count OUTPUT

SELECT @Count 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-30T23:08:58.643

你想用

```
CREATE PROCEDURE dbo.LogTable_Count

AS

SELECT Count(*) FROM LogTable

GO 
```

# java - Java/Eclipse 中 SQL 调用的“静态检查”？

> ID：809511
> 
> 赞同：1
> 
> 时间：2009-04-30T23:03:09.623
> 
> 标签：java, sql, eclipse

在 Eclipse 中编写 Java，我最近被一些琐碎的错误所困扰，其中我的 SQL 语法已经关闭（例如，没有正确引用常量）。有什么工具可以用来帮助自己在编写它们时捕捉它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T00:21:48.780

Intellij 8.x 的 IDEA 有一个可以识别此类内容的 SQL 解析器（它连接到可以读取数据库的数据源，并了解 Java 代码中的标准 JDBC 调用在其字符串中包含 SQL 并突出显示 SQL 语法。

Eclipse至少有[一个](https://jsqleditor.dev.java.net/)这样的插件（非常 alpha），但我不知道有任何人甚至试图像 IDEA 那样在 java 文件中进行突出显示。

但在实践中，除非你是直接进行 JDBC 交互，否则 java 代码中的 SQL 的使用是有限的，因为通常中间有某种类，然后 IDEA 认为它是一个普通的字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T23:06:21.177

dbunit 来测试您的查询，或 Ibatis 将查询移动到 XML。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-09-05T12:33:07.360

试试 Alvor，虽然不完美但很好： [http ://code.google.com/p/alvor/](http://code.google.com/p/alvor/)

# model-view-controller - MVC（模型视图控制器）范式是一种更好的开发方式还是只是一种新的复杂方式？

> ID：809523
> 
> 赞同：1
> 
> 时间：2009-04-30T23:08:58.393
> 
> 标签：model-view-controller, design-patterns

我试图使用 RoR 或 ASP.NET MVC，但在我的第一印象中，MVC 似乎是改变编程范式的一种激进方式。这只是我对变化的抵制还是真的很奇怪？有时候真的觉得很失落！有什么建议，或者我只需要回头以旧方式编程吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-30T23:20:35.463

改变是艰难的，对我们所有人来说。在 DOS 时代，我们使用 MTF Menu-Table-Form 模式。

MVC 已经存在很长时间了，互联网编程中使用的所有主要语言都有自己的风格。

一旦你使用 MVC 一段时间，你可能就不想回去了。它提供了代码分离和重用。我使用过 RoR、Django 和 ASP.NET MVC，MVC 模式促成了我的开发。

我会鼓励你坚持下去！买书或找导师。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-30T23:15:03.357

MVC 并不是特别新。它的历史可以追溯到 1979 年（[参考](http://en.wikipedia.org/wiki/Model-view-controller)），所以它已经足够老了，可以喝了。

通常，MVC会**强制**您采用某种形式的封装。也就是说，您的视图需要在很大程度上独立于您的模型。一旦你习惯了它，你会发现它很有用；也就是说，对于您的个人需求，其他范例可能更合适。MVC 不是万能的。但这是查看某些问题的有用方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-30T23:17:51.057

你比较的依据是什么？如果你习惯 perl / CGI，那么它可能会更复杂一点！

在 Web 术语中，MVC（或 Django 首选的 Model-Template-View，与原始的 Smalltalk MVC 分开）倾向于允许更好地分离应用程序中的关注点。根据我（和许多其他人）的经验，这会导致更易于维护的可扩展、经过良好测试的代码。

一些关于前进的建议。在不了解您的背景的情况下很难提出具体的建议，而且学习无论如何都是一件很私人的事情：

*   RoR - Sam Ruby 出版了一本新书。有各种截屏。
*   Django - 我也建议这样做，因为这两个 Web 框架在我使用过的框架中摩擦最小。

抱歉，我已经离开 MS 平台几年了，所以我无法提供有关 ASP.NET 的任何建议。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-30T23:39:40.893

嗯，它当然很受欢迎。如果你在做 RoR，不要与范式对抗，顺其自然，这就是 RoR 的全部意义所在。

如果您处于定义范式的位置，那么事实是 MVC 往往只是 MV。根据该模式的一些拥护者的说法，控制器更多地用于多视图的情况，而在给定项目中几乎总是不会出现这种情况（尽管数据最终可能最终在企业内的不同上下文中以非常不同的方式被查看） . 但是，取决于 GUI，单独的控制器可以帮助代码的可测试性（如果控制器充当被测类，并且 GUI 组件只是以尽可能最小的方式命中被测方法）。

MVC 起源于 SmallTalk 人群，它最近进入了 Morphic 模式（其中对象通过子类相关 GUI 组件的内部类显示自己）。这肯定不是一个很难的方式来做 HTML 的东西，因为 html 不能有效地提供给设计师。

就个人而言，如果我真的要从头开始，我更喜欢将视图和数据绑定放入表示类的演示模式（我已经看到它叫它，但我现在找不到参考）。如果整个屏幕的呈现由部分数据的不同呈现组成，则模式的力量就来了。在普通无聊的商业应用程序（我倾向于编写的那种）中，数据位（比如地址）往往会显示在很多屏幕上，因此能够分块和重用 gui 演示组件会有所帮助。

但是现在，如果你需要从头开始，你真的需要仔细考虑，至少在老式无聊的数据显示和操作应用程序中是这样。那里有很多，如果你使用一个工具，你应该使用它的模式。与工具作斗争会适得其反。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-30T23:15:39.750

MVC 既不新鲜也不特别复杂。MVC 是一种已经存在很长时间的标准范式。我记得它是大约 10 年前在我的软件工程课程中突出显示的模式之一。MVC，一旦你理解了它，就会为你的项目提供一个非常干净、可测试的实现。它肯定与 WebForms 不同——知道 WebForms 实际上会成为学习 ASP.NET MVC 的障碍——但我不打算回去。我只希望 ASP.NET MVC 变得越来越好，因为我们看到为它构建的控件与为 WebForms 构建的控件相同。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-30T23:20:19.583

只是因为它是新的而感觉很激烈。实际上并没有那么糟糕。

看看现实生活中的应用程序可能会有所帮助。

查看[http://www.nerddinner.com/](http://www.nerddinner.com/)以获得一个不错的示例，以及涵盖代码的[Professional ASP.NET MVC 1.0](http://www.wrox.com/WileyCDA/Section/id-321793.html)书中的免费章节。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-30T23:21:42.950

一个更高度分解/分层的设计总是更难一开始就让人头疼——只有当这种情况发生时才会有回报。好处是现在你已经清楚地定义了放置什么的地方；虽然被迫坚持预先确定的关注点分离一开始似乎很繁重，但代码结构的可预测性使以后的维护变得更加容易。

# ruby-on-rails - before_filter 和 respond_to 格式

> ID：809528
> 
> 赞同：26
> 
> 时间：2009-04-30T23:10:13.493
> 
> 标签：ruby-on-rails, rest

在我的 Rails 应用程序的控制器中，我可以这样做：

```
before_filter :login_required, :except => :index 
```

但我想应用过滤器不仅基于操作名称，而且基于请求的格式。换句话说，我想做这样的事情：

```
before_filter :login_required, :except => {:action => :index, :format => :js} 
```

这可能吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-05-01T00:00:44.340

你需要自己动手。试试这个作为起点。

```
 before_filter :login_required, :except => [:index]

 before_filter(:only => :index) do |controller|
   login_required unless controller.request.format.js?
 end 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2014-08-04T21:56:22.823

请记住，您也可以将 lambda 提取到方法中。这有助于提高可读性。它还可以更轻松地对多个过滤器使用相同的检查。

```
before_filter :login_required, except: :index, unless: :js_request?

private

def js_request?
  request.format.js?
end 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2013-10-07T21:18:01.740

另一种我认为比公认答案更干净的方法是将`if`or`unless`选项与 lambda 一起使用。我只是喜欢将方法名称列为符号，以便与其他控制器过滤器进行标准化。这适用于 Rails 3 及更高版本。

```
before_filter :login_required, except: :index,
  unless: -> { |controller| controller.request.format.js? } 
```

# c# - SoapFormatter 版本控制问题

> ID：809529
> 
> 赞同：1
> 
> 时间：2009-04-30T23:10:29.357
> 
> 标签：c#, soap, serialization, soap-serialization

在我正在维护的应用程序（C#）中，有一些序列化的对象存储在数据库中，有些是在几个版本之前创建的。

现在，当应用程序尝试反序列化这些对象时，它会引发异常：解析错误，没有与 Xml 键关联的程序集....（程序集名称和版本）

据我了解，当 SoapFormatter 尝试反序列化对象时，它首先检查反序列化程序集是否与序列化程序集相同，否则将抛出上述错误消息。会是这样吗？

如果是这种情况，有没有办法转换这些旧数据以使它们可以被最新版本的应用程序读取？

在旁注中，我正在考虑编写一个程序以具有相同的程序集名称和版本来假装是序列化这些对象的同一个程序集，这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T23:31:51.397

我还没有尝试过，但我想知道您是否可以使用 XSLT 将旧版本转换为更新的“版本”结构。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T22:59:46.797

Jordan 提到的 XSLT 转换可能会起作用，但在我的情况下，我需要更改一些属性，并且节点名称使它变得相当复杂。

我最终只是使用 Regex.Replace 来转换更改后的程序集名称和成员名称，如下所示：

```
newData = Regex.Replace(textData, "(" + String.Join("|", keys) + ")",
                        new MatchEvaluator(this.EvaluateReplacement));

string EvaluateReplacement(Match m)
{
    if (this.convertDict.ContainsKey(m.Value))
    {
        return this.convertDict[m.Value];
    }
    return m.Value;
} 
```

其中 this.convertDict 是包含转换映射的 Dictionary 对象。

# iphone - 如何在没有浏览器嗅探的情况下将样式表仅应用于 iPhone（而不是 IE）？

> ID：809532
> 
> 赞同：4
> 
> 时间：2009-04-30T23:11:29.557
> 
> 标签：iphone, css, internet-explorer, ios, mobile-safari

我想将样式表专门应用于 iPhone，而不是在服务器上或通过 JavaScript 进行浏览器嗅探（通过用户代理字符串）。

我特别不希望 Internet Explorer 应用样式表。Apple 建议的应用 iPhone 特定样式表的代码，即：

```
<link media="only screen and (max-device-width: 480px)" href="small-device.css" type= "text/css" rel="stylesheet"> 
```

似乎导致样式表被 IE 7 和 6 应用。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-30T23:12:47.917

使用 Apple 建议的代码，但将其包装在条件注释中以将其隐藏在 IE 中：

```
<!--[if !IE]><!-->
<link media="only screen and (max-device-width: 480px)" href="small-device.css" type= "text/css" rel="stylesheet">
<!--<![endif]--> 
```

我认为这要[归功于 Sitepoint 的 iPhone 开发文章](http://www.sitepoint.com/article/iphone-development-12-tips/)。

# c# - 隐式运算符、Linq 和 Lambda 表达式会降低代码的可读性。但是什么更具可读性？

> ID：809533
> 
> 赞同：0
> 
> 时间：2009-04-30T23:12:01.647
> 
> 标签：c#, linq, lambda

在回答这个问题 [时，当我定义了隐式强制转换时，为什么 Linq Cast<T> 操作会失败？](https://stackoverflow.com/questions/808725/why-does-a-linq-castt-operation-fail-when-i-have-an-implicit-cast-defined)

我发现有很多方法可以在对象之间隐式转换。

考虑以下两个类：

```
public class Class1 
{ 
    public int Test1;
}
public class Class2
{
    public int Test2;
    public static implicit operator Class1(Class2 item)
    {
        return new Class1 { Test1 = item.Test2 };
    }
} 
```

为了将列表转换为列表，我们可以执行以下任何操作：

```
List<Class2> items = new List<Class2> { new Class2 { Test2 = 9 } };

foreach (Class1 item in items)
{
    Console.WriteLine(item.Test1);
}

foreach (Class1 item in items.ConvertAll<Class1>(i=>i))
{
    Console.WriteLine(item.Test1);
}

foreach (Class1 item in items.Select<Class2, Class1>(i=> i))
{
    Console.WriteLine(item.Test1);
}

foreach (Class1 item in items.Select(i=>i))
{
    Console.WriteLine(item.Test1);
} 
```

但是哪个更清楚阅读和理解正在发生的事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-30T23:16:22.400

第一，自然。隐式强制转换的全部意义在于这两种类型非常相似，以至于仅仅认为它们是相同的就具有概念意义。

你会对此犹豫吗？

```
List<byte> items = new List<byte> { 1, 2, 3, 4 };

foreach (int i in items) // since bytes implictly cast to ints
{
    Console.WriteLine(i + 1000);
} 
```

如果你没问题，但你不喜欢上面问题中的第一个公式，那么我认为你应该使用显式转换。

# .net - 如何使用默认电子邮件客户端发送电子邮件？

> ID：809538
> 
> 赞同：21
> 
> 时间：2009-04-30T23:13:52.080
> 
> 标签：.net, winforms, email

我想使用系统的默认电子邮件客户端（thunderbird、outlook 等）从 .net windows 窗体应用程序发送电子邮件。我想预设主题和正文——我认为有一种方法可以通过向 Windows 资源管理器发送类似的内容来做到这一点：“mailto:test@example.invalid?subject=mysubject&body=mymessage”。你有这方面的例子吗？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-04-30T23:35:02.670

尝试这个：

```
 System.Diagnostics.Process proc = new System.Diagnostics.Process();
    proc.StartInfo.FileName = "mailto:someone@somewhere.com?subject=hello&body=love my body";
    proc.Start(); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-08-23T12:08:40.103

如果您仅在 MS Windows 环境中工作，则可以使用 MAPI32.DLL。可以在此处找到托管包装器：

[http://www.codeproject.com/KB/IP/SendFileToNET.aspx](http://www.codeproject.com/KB/IP/SendFileToNET.aspx)

代码如下所示：

```
MAPI mapi = new MAPI();
mapi.AddAttachment("c:\\temp\\file1.txt");
mapi.AddAttachment("c:\\temp\\file2.txt");
mapi.AddRecipientTo("person1@somewhere.com");
mapi.AddRecipientTo("person2@somewhere.com");
mapi.SendMailPopup("testing", "body text");

// Or if you want try and do a direct send without displaying the mail dialog
// mapi.SendMailDirect("testing", "body text"); 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-08-23T12:26:08.557

执行此操作的正确方法是使用 MAPI，但对 MAPI dll 使用互操作代码[实际上既不支持也不推荐执行此操作](http://blogs.msdn.com/mstehle/archive/2007/10/03/fyi-why-are-mapi-and-cdo-1-21-not-supported-in-managed-net-code.aspx)。我已经这样做了，只要您非常小心您的互操作代码并且不做比打开邮件客户端发送电子邮件更多的交互，您***应该***没问题。

使用“mailto”方法有几个问题，其中至少是您不能附加文件。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-30T23:32:13.283

这是我尝试过的：

```
Process.Start("mailto:demo@example.invalid?subject=" +
    HttpUtility.HtmlAttributeEncode("Application error report") + 
    "&body=" + HttpUtility.HtmlAttributeEncode(memoEdit1.Text)); 
```

但是，如果正文太大，我会遇到异常：

Win32Exception“传递给系统调用的数据区域太小”

所以这个问题仍然悬而未决，因为我需要处理长正文。我不知道这个错误的大小限制。

# c# - 如何使用 Linq-To-Sql 在同一查询中进行 TOP、ORDER BY 和 DISTINCT？

> ID：809545
> 
> 赞同：2
> 
> 时间：2009-04-30T23:16:04.367
> 
> 标签：c#, .net, linq, linq-to-sql, ado.net

如何将以下查询翻译成 Linq？

```
 SELECT DISTINCT TOP 10 A.*,A.X+A.Y AS SUMXY
  FROM TABLE_A AS A INNER JOIN TABLE_B AS B ON A.ID = B.AID
  ORDER BY SUMXY 
```

我不想分成两个查询。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-30T23:25:56.217

使用扩展方法并假设您在 Table_A 和 Table_B 之间有一个外键关系，以便在 TableAs 表上有一个名为 TableBs 的 EntitySet（使用真实的表名会更容易......叹息）。

```
var query = db.TableAs.Where( a => a.TableBs.Count() > 0 )
                      .Select( a => new { A = a, SumXY = a.X + a.Y } )
                      .OrderBy( a => a.SumXY )
                      .Take( 10 ); 
```

这将为您返回一个匿名类型对象的集合，这些对象具有一个名为 A 的 TableA 对象和一个 SumXY（可能是一个 int）。或者，您可以创建一个真正的类来保存 A 的数据以及总和并选择这种类型的对象。

# javascript - HTML/JavaScript UI 小部件 GUI 构建器

> ID：809546
> 
> 赞同：30
> 
> 时间：2009-04-30T23:16:07.910
> 
> 标签：javascript, user-interface, widget

我听说过并使用过一些库，例如 Ext JS、qooXdoo、jQuery UI、dijit。我知道有一些非官方的尝试来创建 GUI 构建器，但它们并不是很好。

有没有一个带有不错的 GUI 构建器的 HTML/JavaScript UI 小部件库？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2010-11-05T07:02:52.590

我有一个很棒的：**[http ://spabuilder.appspot.com](http://spabuilder.appspot.com)**

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-04-06T10:25:13.620

您可以尝试基于 Web 的 sigma 构建器。它支持 30 多个 GUI 组件。这个构建器是纯 JavaScript 的东西，唯一需要 PHP 的就是将生成的脚本保存在服务器端。

顺便说一句，这个构建器是在 LGPL 许可下免费和开源的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-30T23:25:50.787

Ext 有（现在有）几个 GUI 构建器。

[tof2k 的GUI Builder](http://tof2k.com/ext/formbuilder/)（他承认当他发布它时他没有时间再做它了）

其中大部分被[Ext Designer](http://www.sencha.com/products/designer/)替换/冗余。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-05-17T18:02:28.487

我还不能投票，但我想第二个 sigma 小部件。它目前确实支持 jquery ... [http://www.sigmawidgets.com/products/sigma_visual/VisualJS/index.html](http://www.sigmawidgets.com/products/sigma_visual/VisualJS/index.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-16T01:57:07.510

1.  [Glimmer](http://visitmix.com/articles/glimmer-a-jquery-interactive-design-tool)是一个用于 jQuery 的 GUI 构建器。该构建器是一个封闭源代码的 Windows 应用程序，但生成的代码都是开源的。
2.  Isomorphic Software[有一个基于 Web 的 GUI 构建器](https://www.isomorphic.com/company/pr_56_release.jsp)，并且是开源的。
3.  还有 altCognito 提到的 ExtJS GUI 构建器。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-04-29T08:56:35.763

我正在寻找同样的东西。在尝试了几个之后，我找到了一个开源的 gui builder。设计 gui 非常容易，您可以在实际中看到它。 [http://www.sigmawidgets.com/products/sigma_visual/VisualJS/index.html](http://www.sigmawidgets.com/products/sigma_visual/VisualJS/index.html) 首先加载它需要几秒钟。不幸的是，它不支持 jquery。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-04-20T13:47:18.840

我更喜欢但不幸的是仍处于测试阶段的其中一个是 www.280atlas.com，这是一个非常有前途的框架“à la Apple”。目前开发者测试版需要注册（这需要 20 美元）

# c# - C# 编译器：无法在非静态上下文中访问静态方法

> ID：809550
> 
> 赞同：32
> 
> 时间：2009-04-30T23:17:46.750
> 
> 标签：c#

我有以下代码：

```
public class Anything
{
    public int Data { get; set;}
}

public class MyGenericBase<T>
{
    public void InstanceMethod(T data)
    {
        // do some job
    }

    public static void StaticMethod(T data)
    {
        // do some job
    }

    // others members...
}

public sealed class UsefulController : MyGenericBase<Anything>
{
    public void ProxyToStaticMethod()
    {
        StaticMethod(null);
    }

    // others non derived members...
}

public class Container
{
    public UsefulController B { get; set; }
}

public class Demo
{
    public static void Test()
    {
        var c = new Container();
        c.B.InstanceMethod(null);   // Works as expected.
        c.B.StaticMethod(null);     // Doesn't work. 
                                    // Static method call on object rather than type. 
                                    // How to get the static method on the base type ?
        c.B.ProxyToStaticMethod();  // Works as expected.
    }
} 
```

编译器很生气...我理解错误信息但我不知道如何解决这个问题。我试图获取一个类型而不是一个对象来进行我的静态方法调用，但我找不到正确执行此操作的方法。此外，这会导致一些不优雅的东西。

基本上，GenericBase 是框架中的一个类，具有许多静态方法和一些实例方法。控制器正在键入此类并对其进行扩展。

容器是一组逻辑相关的控制器。

有趣的是：此代码的 Java 版本可以正确编译，但会出现警告。执行也是正确的。

是否存在解决此问题的设计模式？

感谢您的投入！

* * *

感谢您的回答，我找到了解决此问题的方法。它似乎有效，但我不知道是否有副作用。

```
 public class GenericBase<T> : MyGenericBase<T>
{
    // Create instance calls here for every base static method.
}

public sealed class UsefulController : GenericBase<Anything>
{
    // others non derived members...
} 
```

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-04-30T23:21:49.003

对静态方法的调用将被编译为调用特定类的特定静态方法。换句话说，它不会使用 B 的内容来确定调用哪个静态方法。

因此调用必须在编译时可解析，因此它会抱怨，因为据它所知，您可以用多个具体类型替换该属性的内容，这意味着对静态方法的调用必须解析为这些类中的任何一个中的静态方法。

编译器没有虚拟或抽象静态方法之类的东西，因此您不能保证所有这些类都具有该静态方法。而且由于调用必须在编译时可解析，所以它不会那样工作。

正如您所注意到的，您可以调用对象的实例方法，该方法又调用静态方法。这不会使上述规则无效，因为当编译器编译该实例方法时，它将调用的静态方法是常量且已知的。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-30T23:28:56.693

要调用静态方法，您需要从定义它的类中引用它，而不是该类的实例。

```
 MyGenericBase<Anything>.StaticMethod( null ); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-30T23:22:51.450

您不能在 C# 中执行此操作。您可以在 VB.NET 和 Java 中做到这一点，但老实说，这并没有什么意义。它只是给你一种`static`方法中的多态性的错误感觉，这无论如何都不是真实的。由于它不是多态的，因此整个方法调用在编译时（静态）是已知的，您可以直接使用类名来提及调用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-30T23:32:51.863

您可以执行以下操作之一：

```
UsefulController.StaticMethod(null);  
MyGenericBase<Anything>.StaticMethod(null); 
```

正如其他人已经解释的那样，无法使用该实例。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2018-10-31T18:07:28.067

因为已经是 9 年前了，我知道那是太多年前的事了。我继续练习 C# 而不关心 rl 实现。我认为您的帖子没有进行继承、OOAD 或封装（信息隐藏）的目标。

从您的代码到我的代码。

```
public class Anything
{
    private int data, data2; //field

    public Anything()
    {
        data = default(int);
    }
    public int Data { get; set; }
}

public class GenericParentClass<T>
{
    public static void StaticMethod(T data)
    {
        // do some job
    }

    public void InstanceMethod(T data)
    {
        // do some job
    }
}

public sealed class UsefulController<T> : GenericParentClass<T> where  T : Anything, new()
{
    //all static public methods must be placed before all non-static public methods. [StyleCop Rule: SA1204]
    public static new void StaticMethod(T data)  //'UsefulController'.StaticMethod(Anything) hides inherited member 'GenericParentClass<Anything>.StaticMethod(Anything)'. Use the new keyword if hiding was intended.
    {
        GenericParentClass<T>.StaticMethod(data);  //'data' is a variable but used like a type //arugement type T is not assignable to parameter type 'data'.
    }

    public void EncapsulatedStaticMethod()
    {
        T @class = new T(); //cannot create an instance of the variable type T because it does not have the new() constraint. //T is type and @class is variable and new is an instance.
        StaticMethod(@class);  
    }

    public void EncapsulatedInstanceMethod(T data)
    {
        base.InstanceMethod(data);
    }
}

public class Container
{
    public UsefulController<Anything>  B { get; set; }
}

public class Testing   
{
    public static void Main()
    {
        Anything @var = new Anything();
        var c = new Container();
        c.B.InstanceMethod(null);   
        c.B.EncapsulatedStaticMethod();    
        c.B.EncapsulatedInstanceMethod(var);  
    }
} 
```

# social-networking - 有人知道 Microsoft Vine 的已发布 API 吗？

> ID：809553
> 
> 赞同：-1
> 
> 时间：2009-04-30T23:19:03.127
> 
> 标签：social-networking

我对新发布的 Microsoft Vine 有一个想法，我想知道是否有可用的公共 API。我没有运气搜索，只是一堆新闻文章。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-30T23:27:51.767

除非您可以进入私人测试版，否则我的猜测是“不”。

# sql-server - 使用 LINQ To SQL 通过视图更新多个表的好方法是什么？

> ID：809556
> 
> 赞同：1
> 
> 时间：2009-04-30T23:20:57.163
> 
> 标签：sql-server, linq

我有一个视图，它由两个表组成。我想通过视图编辑每个表中的值并保存这些更改，但 LINQ 抛出一个错误，即无法在同一视图上编辑两个值。

有谁知道一个好的解决方法？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-30T23:37:51.180

SQLServer 不支持从视图上的多个表中更新列。您可以通过分离列更改来解决此问题，以便您只更新一个表上的列、提交更改、更新另一个表上的更改，然后再次提交更改。您还可以使用存储过程在同一事务中独立更新各个表。可以使用设计器将此存储过程作为方法添加到您的数据上下文中。假设它在完成时返回与视图相同的模式，它可以返回与视图相同类型的对象。

[参考](http://msdn.microsoft.com/en-us/library/ms187956(SQL.90).aspx)

> 可更新视图 只要满足以下条件，您就可以通过视图修改基础基表的数据：
> 
> 任何修改，包括 UPDATE、INSERT 和 DELETE 语句，都必须仅引用一个基表中的列。视图中被修改的列必须直接引用表列中的基础数据。列不能以任何其他方式派生，例如通过以下方式： 聚合函数：AVG、COUNT、SUM、MIN、MAX、GROUPING、STDEV、STDEVP、VAR 和 VARP。一个计算。无法从使用其他列的表达式计算该列。使用集合运算符 UNION、UNION ALL、CROSSJOIN、EXCEPT 和 INTERSECT 形成的列相当于计算并且也不可更新。正在修改的列不受 GROUP BY、HAVING 或 DISTINCT 子句的影响。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T11:23:14.243

第三种选择是创建一个 INSTEAD OF 触发器，您可以在其中编写代码以将更新的值拆分为两个不同的查询。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T00:23:37.717

虽然@tvanfosson 的答案是绝对正确的，但如果您使用的是 LINQ-to-SQL，您可以直接在代码中引用这两个表，获取对象集合，更新它们，然后将它们推回。发出更新命令后，我的理解是 LINQ-to-SQL 会将所有命令放在事务中并为您处理。

# linux - 防止 gtk FileChooserDialog 对目录中的所有文件调用 stat？

> ID：809560
> 
> 赞同：2
> 
> 时间：2009-04-30T23:22:35.210
> 
> 标签：linux, performance, dialog, gtk

对于包含许多文件的 nfs 目录，打开 gtk FileChooserDialog 非常缓慢。strace 显示很多时间调用“stat”。对目录中的每个文件进行大约 5 次调用。我们如何关闭对“stat”的调用，只显示文件名列表而不显示修改时间？

我们正在使用运行 Redhat Enterprise 4、x86_64、Linux 2.6.9-42.0.8.ELsmp 和 FileChooser 来自： /usr/lib64/libgtk-x11-2.0.so.0.400.13 。一个测试程序打开一个 FileChooserDialog 并需要 10 秒才能出现，而 'ls' 列出同一目录大约需要 25 毫秒。

我们的 Eclipse 应用程序被这个文件选择器问题削弱了......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T23:00:54.613

至少自 2005 年以来，gtk+ 和 gnome 团队有一个与此问题相关的[错误报告。gnome 核心库最近和未来的变化有望提高性能。](http://bugzilla.gnome.org/show_bug.cgi?id=310642)如果您在文件选择器菜单中有任何网络驱动器书签，则此问题可能会更加严重。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T21:53:03.653

GTK 文件打开对话框很可能是 stat(2)ting 目录中的所有文件。它相当于`ls -l`目录上的 ，它应该运行缓慢。的输出`ls | cat`（明显更快）可能还不够，因为它无法区分文件和目录。

我建议 measure`ls | cat`和`ls -l`GTK 文件打开对话框。如果 GTK 文件打开对话框比 慢很多`ls -l`，那么 GTK（不是 NFS）有问题。我会通过 运行 GTK 应用程序`strace`，看看什么是慢的。如果 GTK 文件打开对话框的速度`ls -l`与作为桑巴。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-01T16:07:12.597

目录是否已挂载？这可能对统计信息有所帮助，因为每个文件的时间都将使用统计信息进行更新。

您需要使用 -o noatime 重新安装 nfs 以关闭 atime 更新。

# c++ - isAbstract 模板和视觉工作室

> ID：809562
> 
> 赞同：1
> 
> 时间：2009-04-30T23:23:13.413
> 
> 标签：c++, visual-studio, templates, boost, typetraits

以下模板将决定 T 是否是 g++ 的抽象。

```
/**
   isAbstract<T>::result is 1 if T is abstract, 0 if otherwise.
 */
template<typename T>
class isAbstract
{
   class No { };
   class Yes { No no[3]; }; 

   template<class U> static No test( U (*)[1] ); // not defined
   template<class U> static Yes test( ... ); // not defined 

public:
   enum { result = sizeof( isAbstract<T>::template test<T>( 0 ) ) == sizeof(Yes) }; 
}; 
```

例如：struct myClass2 { virtual void f() {} }; 结构 myClass1 { 虚拟 void f() = 0; };

```
bool twoAbstract = isAbstract<myClass2>::result;
bool oneAbstract = isAbstract<myClass1>::result; 
```

但是，它在 Visual Studio 9.0 中失败并出现以下错误：

```
error C2784: 'AiLive::isAbstract<T>::No AiLive::isAbstract<T>::test(U (*)[1])' : could not deduce template argument for 'U (*)[1]' from 'myClass2' 
```

有谁知道问题是什么以及如何解决这个问题？

[MSDN](http://msdn.microsoft.com/en-us/library/bb982572.aspx)报告说他们现在有一个`is_abstract`自 VS2008 以来的类作为 TR1 的一部分（在 header 内`type_traits`）。但是，我的安装中似乎缺少它。

PS。由于冗长而无聊的原因，我无法通过 Boost 重新实现它。

*更新*

另外，尝试更换，

```
template<class U> static No test( U (*)[1] ); 
```

与每一个，

```
template<class U> static No test( U (*x)[1] );
template<class U> static No test( U (*)() );
template<class U> static No test( U (*x)() ); 
```

和

```
template <typename U>
struct U2 : public U
{
   U2( U* ) {}
};

// Match if I can make a U2
template <typename U> static No test( U2<U> x  ); 
```

和

```
// Match if I can make a U2
template <typename U> static No test( U2<T> x  ); 
```

不走运——所有人都说不能为 U 推导出模板参数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T20:32:44.330

这在 VC9 中对我有用：

```
template<typename T>
class isAbstract
{
    class No { };
    class Yes { No no[3]; }; 

    template<class U> static No test( U (*)[1] ); // not defined
    template<class U> static Yes test( ... ); // not defined 

public:
    enum { result = sizeof( test<T>( 0 ) ) == sizeof(Yes) }; 
}; 
```

请注意，我只需`isAbstract<T>::`要从对`test`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T23:52:47.307

不确定，因为我已经注意到 C++ 有一段时间了，但你可以使用

```
template< typename  T, typename  U>
class isAbstract
{
   class No { };
   class Yes { No no[3]; }; 

   template<class U> static No test( U (*)[1] ); // not defined
   template<class U> static Yes test( ... ); // not defined 

public:
   enum { result = sizeof( isAbstract<T>::template test<T>( 0 ) ) == sizeof(Yes) }; 
};

bool twoAbstract = isAbstract<myClass2, SomeTypeU>::result; 
```

# python - 分布式/更快的python单元测试

> ID：809564
> 
> 赞同：4
> 
> 时间：2009-04-30T23:25:02.163
> 
> 标签：python, unit-testing

我对一个项目有很多 python 单元测试，它已经到了需要很长时间才能运行它们的地步。我不想添加更多，因为我知道他们会让事情变得更慢。人们如何解决这个问题？是否有任何简单的方法可以将测试执行分布到集群上？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-02T09:46:16.623

你不能经常运行所有的测试，因为它们太慢了。这是您的项目越来越大的必然结果，并且不会消失。当然，您可能能够并行运行测试并获得不错的加速，但问题会稍后再出现，并且永远不会像您的项目很小时那样。

为了提高生产力，您需要能够编写代码并运行相关的单元测试并在几秒钟内获得结果。如果您有测试层次结构，您可以有效地做到这一点：为您经常使用的模块运行测试，偶尔为您正在使用的组件运行测试，以及不经常进行项目范围的测试（可能在您之前'正在考虑检查它）。你可能有集成测试，或者你可能在一夜之间运行的完整系统测试：这个策略是这个想法的延伸。

设置它所需要做的就是组织代码和测试以支持层次结构。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-01T12:52:28.163

请参阅 py.test，它能够将单元测试传递给一组机器，或 Nose，它（作为主干，不是当前发布的版本）支持与多处理模块并行运行测试。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-30T23:49:30.620

分析他们以查看真正慢的地方。您可以通过分发解决此问题。如果测试是真正的单元测试，那么我认为跨多个执行引擎运行测试不会有太多问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T02:14:55.203

解决这个问题的第一部分是只运行需要运行的测试。在提交到共享分支之间，一个人只运行与新工作交互的那些测试；这应该需要五秒钟。如果采用这种模型，那么在提交共享资源之前运行整个测试套件就变得至关重要。

当然，为了回归目的而运行完整的测试套件的问题仍然存在，尽管通过减少运行完整套件的频率已经部分解决了这个问题。为了避免在该作业运行时必须等待，可以将测试任务转移到另一台机器上。这很快就变成了持续集成系统的任务；[buildbot](http://pypi.python.org/pypi/buildbot/0.7.6)似乎非常适合您的用例。

您还应该能够使用 buildbot 在主机之间分发测试，启动两个具有不同入口点的作业到测试套件。但我不相信这会让你比我在这里提到的前两个步骤受益更多。它应该保留用于测试运行时间比提交共享资源之间的时间间隔长得多的情况。

D'A

[警告讲师：我对 buildbot 的理解在这一点上主要是理论上的，它可能比看起来更难。]

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-01T02:45:58.467

编码时，只运行您刚刚更改的类的测试，而不是整个项目中的所有测试。

尽管如此，在您提交代码之前运行所有测试是一个好习惯（但持续集成服务器可以为您完成）。

# perl - 为什么 shl_load() 对于具有线程本地存储的库会失败？

> ID：809571
> 
> 赞同：1
> 
> 时间：2009-04-30T23:27:19.317
> 
> 标签：perl, shared-libraries, loadlibrary, thread-local

Perl 中的线程默认使用自己的本地存储来存储所有变量，以尽量减少线程对现有非线程感知代码的影响。在 Perl 中，可以使用属性创建线程共享变量：

```
use threads;
use threads::shared;

my $localvar;
my $sharedvar :shared; 
```

**HP-UX 运行时加载程序不支持动态加载包含 (TLS) 线程本地存储的共享库。**
因此，当尝试导入包含 TLS 的模块时，会报告以下错误：

```
“/usr/lib/dld.sl：不能 shl_load() 包含线程本地存储的库”

```

所以我知道为什么我会收到一个错误我只是不清楚为什么很难用 TLS 加载一个库？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-09T21:35:45.817

TLS 存储的设置方式取决于 TLS 访问[模型](http://docs.oracle.com/cd/E23824_01/html/819-0690/chapter8-20.html#scrolltoc)。

在更简单的“初始可执行文件/静态 TLS”模型中，加载程序在运行主可执行文件的第一条指令之前设置 TLS 段。它通过将主可执行文件和它直接依赖的所有共享库的 TLS 要求相加来计算该段的大小。

一旦分配和设置了这个 TLS 段，应用程序就会开始运行，并且可以很好地将指针存储到 TLS 段中。因此，存储段是不可能`realloc()`的——加载器不知道应用程序中的哪些指针必须更新。

由于您无法重新分配该段，并且其中没有空间用于其他变量；loader 如何处理需要自身 TLS 存储的动态加载库？

glibc 加载器实际上在初始 TLS 中分配了一些额外的空间，因此它*可以*使用 TLS 动态加载库，只要它们不使用太多空间。一旦这个储备用完，glibc 加载器也将拒绝加载任何具有 TLS 要求的附加库。

在 Solaris 和 Linux 上，可以使用“通用动态 TLS[模型](http://docs.oracle.com/cd/E23824_01/html/819-0690/chapter8-20.html#scrolltoc)”动态加载具有任意 TLS 要求的库。

看起来 HP-UX v1.6 也[支持](http://docs.hp.com/en/5187-0701/ch07s09.html)该模型，实际上将其设为默认模型。但是您可能正在运行较旧的操作系统版本，该模型不是默认模型，并且可能根本不受支持。检查您的编译器版本是否支持`+tls=dynamic`选项，如果支持，使用它进行构建是否有帮助。

# java - 我在哪里可以找到用于模拟超时和错误代码的测试 http 服务器

> ID：809573
> 
> 赞同：3
> 
> 时间：2009-04-30T23:28:21.653
> 
> 标签：java, apache, http, browser

我在想这将是一个带有一些自定义页面的 Apache 服务器，或者可能是一个 java 应用程序。用于浏览器或 http 客户端测试，当请求特定页面时，它应该会给我各种 500 错误。给我一个 5 秒、10 秒、30 秒或其他任何时间响应的页面。给我一个第一个字节在 30 秒内没有返回的页面。给我一个页面，我每秒可以得到几个字节。

我希望别人以前做过这种东西，我知道这并不太难，但我当然想用别人已经做过的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T23:32:06.513

我用[CherryPy](http://www.cherrypy.org/)做这类事情。使用快速启动功能时，如果您编辑运行它的脚本文件，它将自动重新启动。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-14T16:18:30.253

我主要在 Java 世界工作，所以跳入 Python 并不理想。以下是一些基于 Java 的替代方案：

*   FitNesse-fitnesse.org
*   码头 - www.mortbay.org/jetty/
*   Java HTTP 服务器 (Sun) - java.sun.com/javase/6/docs/jre/api/net/httpserver/spec/

我不知道 sun httpserver，但这似乎提供了轻量级的实现，我可以添加少量代码来模拟超时和错误响应。

# terminology - 什么是领域特定语言？有人用吗？以什么方式？

> ID：809574
> 
> 赞同：123
> 
> 时间：2009-04-30T23:28:35.040
> 
> 标签：terminology, dsl

我想我正在寻找某种介绍，看看是否有人使用过它。使用它有什么特别的好处吗？

维基百科：

> [领域特定语言 (DSL)](http://en.wikipedia.org/wiki/Domain_specific_language)是专用于特定问题域、特定问题表示技术和/或特定解决方案技术的编程语言或规范语言。

任何人都可以给出任何具体的例子来说明你是如何实现它的，或者它在给定的场景中是如何有用的？

* * *

## 回答 #1

> 赞同：123
> 
> 时间：2009-04-30T23:40:23.640

领域特定语言是为处理特定领域或一组关注点而编写的语言。它们有很多，例如用于描述软件构建的 make、ant 和 rake，或者用于语言构建的 lexx 和 yacc。近年来，它们变得流行起来，因为一些东西结合在一起使它们更容易构建。其中最重要的是 Ruby 的日益流行，它有几个特性可以很容易地构建新的 DSL。

Martin Fowler 是这个想法的大力支持者，就像[这里](http://martinfowler.com/bliki/DomainSpecificLanguage.html)一样。

* * *

## 回答 #2

> 赞同：74
> 
> 时间：2009-05-01T00:19:38.007

您可以将 DSL 视为用更通用的编程语言编写的函数的复杂参数。真正的编程语言会解析 DSL 代码并对其进行处理，通常情况下，DSL 代码只关注*您*想要做的事情，而更大的系统会弄清楚*如何*做。

DSL 的示例包括所有查询语言（SQL、XPath、...）、所有模板语言（Django、Smarty、...）、shell 脚本，尤其包括 twill、命令驱动的 Web 浏览器（主要用于自动化测试） )、数据存储和交换语言（XML、YAML、...），以及 LaTex、HTML 或 CSS 等文档语言。

一些语法非常灵活的语言，如 TCL 和 Lisp，将它们的 DSL 直接构建到语言中……如果可能的话。大多数语言使用字符串，通常从外部文件加载。

使用它们有什么特别的好处吗？将它们用于预期目的非常有利，以至于您会在不知不觉中转向它们，就像您一直在使用（我认为）SQL 或 HTML 而不将它们视为 DSL。

我敢说那里有足够的 DSL 来满足您可能需要的任何类型的应用程序。你几乎可以肯定不需要学习如何编写自己的。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-04-30T23:48:30.577

（解决问题的症结）

我认为当我第一次在某处看到[DSL](http://en.wikipedia.org/wiki/Domain-specific_language)并将其定义为“领域特定语言”*时，我还认为它是一种特殊的、具体的语言*，我只是没有听说过——但是，不，它是语言的通用术语针对特定应用领域量身定制。

具有讽刺意味的是，如果您刚刚听说过[TCL](http://en.wikipedia.org/wiki/Tcl)作为一种“工具命令语言”，您可能会认为，就像 DSL 一样，会有很多用于各种工具的 TCL——但是，不，它是特定脚本语言的特定名称。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-04-30T23:34:05.730

我认为它是一种适合解决特定领域问题的语言。它可以是某种规则处理语言或服务描述语言。

与领域特定语言（DSL）相反的是*通用语言*。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2014-08-29T23:36:36.130

一切都是DSL...

汇编器：MOV R1 到 R2
编译器：赋值语句 -- A = A + 1，条件 -- IF (TRUE) ...，分支 -- RETURN
HTML：... 描述嵌套结构
TCP/IP：描述到/从地址
PDF：描述文本/图像在纸上的位置
字体：描述字符

我们用来描述特定过程的任何语言都是 DSL。不幸的是，即使是我们最基本的流程也缺乏特定领域的语言来描述，所以我们使用我们必须的少数语言来描述我们所做的一切。“压缩我网站中的所有 html 文件”需要 300 行 3 或 4 种不同语言才能完成。

要构建 DSL，请确定描述您可以记住且不需要文档的过程所需的最少字符数。请记住，速度和易用性是主要的设计标准。解析速度如此之快，以至于您使用的任何语法都可以，在大多数情况下，我更喜欢自然语言作为我的语法，“每月第一天支付员工工资”，但特定领域就是这样，特定领域，您确定最好的语法适合问题。

我会远离使用其他可能方便但不适合问题的解决方案，例如用于定义数据 (XML) 的 HTML。CSV 非常有用，它适合大多数问题。JSON 不适合易用性部分，如果 CSV 适用于大多数问题，它会增加不必要的复杂性。我们在 DSL 中经常使用 EXCEL，它非常适合描述小问题，在 65K 到 1M 行以下，例如树结构或菜单，A 列是级别，其他列是图标、颜色、标签等（EXCEL 是可编辑的 CSV）。

我发现 HTML 并没有真正解决页面布局的问题，所以我把它去掉，定义了一个适合的 DSL。我在页面上定义了 6 个区域，HEADER、BODY、FOOTER、LEFT/RIGHT MARGINS 和 LEFT/RIGHT FULL MARGINS。然后我可以告诉页面生成器将标题栏、状态栏、菜单、表格、表格、...添加到特定的单元格。然后可以将这些单元中的每一个拆分为任意深度的行和列。任何样式的页面布局都需要几秒钟。

**BODY 包含我的员工表
HEADER 包含标题栏标题“Hello World”，并登录到柯林斯软件**

菜单 DSL 不适合页面布局 DSL，所以我为菜单构建了一个独特的 DSL。

**资源 我的主菜单
*define:menu,m,Level,Label,Icon,Action;
米，0，文件；
m,1,open,open.gif,对话框打开文件；**

每个问题都是独一无二的，计算机可以使用任何格式，DSL 是为人类设计的，所以要让人类可以理解，可以输入的东西，并用真实的单词制作语言；因为我们描述的是真实的人物、地点和事物。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-04-30T23:38:10.727

DSL 是开发供非程序员使用的语言的好方法。例如，如果您为公司的财务人员准备了 DSL，那么您可以让他们编写他们想要完成的程序，而不是按照他们的规范进行编程。然后，如果它太慢，那么您可以按照他们想要的方式使用他们编写的内容，用编译语言编写以加快速度。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2017-10-06T18:16:22.103

好！上面解释了很多事情。我将尝试以更简单的方式解释这一点，因为像我这样的人会明白。

由于通用语言用于广泛用途，因此 DSL 仅适用于特定领域。像 HTML 或 CSS。

你可以说，如果你在一篇论文上写了一些指令，只有某个人或你唯一最好的朋友能理解，而其他人都不能理解。那么它可能是一个DSL。但是，如果您以许多人可以理解并可以遵循的方式编写说明，那么这不是 DSL。

我曾经为用户创建了一个可以通过计算机的串行端口操作的开关板，用户想要一个可以在该板上执行的程序，继电器开关将相应地打开和关闭。所以我写了一些说明并告诉用户根据这些说明对该板进行编程。这是 DSL 的一个例子。我没有发明一种新语言，而是创建了一堆字符串，微控制器可以从 EEPROM 读取并可以相应地解析并执行特定任务。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2015-07-26T22:17:55.933

我写了一篇简短的博客文章讨论我为什么喜欢使用 DSL：

[我希望我们更多地使用领域特定语言 (DSL)](http://adamjonrichardson.com/2015/07/26/i-wish-we-used-domain-specific-languages-dsls-more/)

在其中，我将 DSL 定义为：

> 一种小型编程语言，专门设计用于交流特定领域问题的解决方案。

在使用方面，如果您曾经使用过 Ant、结构化查询语言 (SQL) 或级联样式表 (CSS)，那么您就使用过 DSL。

我喜欢使用 DSL，因为它们专注于促进针对特定问题空间的解决方案的交流，并且它们以促进领域专家参与的方式这样做。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2015-03-19T02:54:55.323

我最近才听说 DSL，但找到了一个非常有用的例子：LUNA（以前的 lunascript）。

它是 Asana 团队为他们自己的平台定制的编程语言/框架。

我进一步发现，许多公司为了创造适当的竞争优势而制作自己的框架和语言，一些例子是：

*   SAP 与 AbAp
*   PeopleSoft 与 PeopleCode
*   ~~苹果与 Objective-C~~
*   Facebook 有 FBML 和 FQL 之类的东西

这些是特定于域的，因为您几乎将它们专门用于在这些平台上工作。

我希望这个答案可以帮助您澄清这个概念。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2015-09-12T11:49:34.490

域特定语言 (DSL) 的一个简单示例是 HTML，它用于称为基于 Web 的应用程序的特定域。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2018-11-19T22:32:17.243

机器学习中使用的 DSL 示例是 python 中的 patsy： [https ://patsy.readthedocs.io/en/latest/formulas.html#](https://patsy.readthedocs.io/en/latest/formulas.html#)

它基于 R 中的公式 DSL： [https ://stat.ethz.ch/R-manual/R-devel/library/stats/html/formula.html](https://stat.ethz.ch/R-manual/R-devel/library/stats/html/formula.html)

[https://cran.r-project.org/web/packages/Formula/vignettes/Formula.pdf](https://cran.r-project.org/web/packages/Formula/vignettes/Formula.pdf)

哈德利在他的高级 R 书中有一个很好的部分描述了如何使用 R 构建 DSL：http: [//adv-r.had.co.nz/dsl.html](http://adv-r.had.co.nz/dsl.html)

一旦深度学习领域在某种程度上（甚至现在）稳定下来，我很乐意看到 Apache MXnet 项目中出现类似的东西。[但是，我还没有在提案页面](https://cwiki.apache.org/confluence/display/MXNET/Design+Proposals)上看到任何提案。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2017-10-13T13:55:26.090

特定领域的语言以直接使用特定领域的概念和逻辑的语言表达您的领域过程和知识。

社区肯定在增长，但仍然没有达到其他“主流”技术的水平。

大多数时候，DSL 是为了提高公司内部的生产力，所以他们将其保密并且不分享他们的结果/见解。

这是一个会议，演讲者给出了一些使用[JetBrains MPS](https://www.jetbrains.com/mps/)的 DSL 示例，以及投影编辑技术：[https ://vimeo.com/197381453](https://vimeo.com/197381453)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2019-10-27T22:25:53.830

DSL - 领域特定语言。让我们开始什么是域 - 域是一些定义的区域，范围。这个域可以是网站外观，你有它的 CSS，第二个域可以是网站结构，这里有 HTML。

但是，域也可以是 Company X Application。在这个领域的范围内，可以创建一些语言。语言并不意味着 - 具有自己的语法、语法、编译器或运行时的完全风味的东西。DSL 可以只是解决领域问题的工具列表。

让我们考虑 OOP 及其模型，通过类和方法将域对象表示为这些对象的行为。如果我们创建这样的结构，并赋予这些对象行为，那么我们可以使用这些概念编写代码。考虑这个伪代码示例：

```
cookie = async getCookie(cookieId)
user = async getUser(userId)
result async user.buy(cookie)
if (result.isError()) {
  error.showAlert("User has not enough money")
} else {
  confirmation.showSuccess("Cookie was bought")
} 
```

上面多少是 GPL（通用语言），多少是特定领域术语和工具。这是两者的混合，但所有命令在这里都是特定于域的。也就是说，我们可以说上面是用 DSL 编写的，其中域是某个应用程序 x。

继续这个例子，我可以创建更多的抽象工具，并且主要通过这些工具执行控制流，考虑（这是更多的 FP，但希望你明白我的意思）：

```
waitForMany(getCookie(cookieId), getUser(userId)
  .andThen([cookie, user] -> user.buy(cookie))
  .andThen(showSuccess("Cookie was bought"))
  .whenError(showError("User has not enough money")) 
```

正如你所看到的，我能够抽象很多，并使用这个抽象来执行控制流。一切都基于 GPL 并在 GPL 范围内工作。

说实话，我们都写 DSL，你可以使用的每个特定领域的抽象都是这样的。但是这些抽象中的大多数都不是完整的解决方案，这就是为什么我们不经常使用这个词的原因。但是，如果您有一组工具和功能来抽象您的领域，它们就会形成一种 DSL。

什么也是DSL，很多东西，例如任何提供规则集的框架都是DSL。如果您看到有人声称他是 React 开发人员，那么您就知道他是特定领域的开发人员，因为 React 正是 DSL，它可以替代使用原生 Web 平台。如果您可以从现有的特定领域工具组合功能，那么您就是在使用 DSL 编写代码。更深入地了解 React，对不起所有不是来自这个 DSL 的人：D，你可以创建一组组件，并将它们组合成构建块，哇！，现在你在 DSL 之上制作了 DSL。

是的，在这里重复 DSL 太多次了，抱歉。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-12-02T06:40:37.153

nextflow( [https://github.com/nextflow-io/nextflow](https://github.com/nextflow-io/nextflow) )是groovy编写的一种DSL语言；

nextflow 的主要目的是编写用于分析的管道，并轻松地从笔记本电脑到 HPC 到云，并使用 conda、docker、singularity 重复 env

# php - PHP CURL 调用失败到 wordpress RSS 提要

> ID：809577
> 
> 赞同：0
> 
> 时间：2009-04-30T23:29:10.903
> 
> 标签：php, wordpress, curl

我正在尝试从 wordpress 对 RSS 提要进行 CURL 调用，我没有使用 simplexml_load_file() 因为 php.ini 禁止执行此类调用，所以我试图通过 CURL 获取 xml，所以到目前为止，它适用于任何 URL，但不适用于 wordpress RSS 提要，即使它们位于同一服务器上。

如果我直接在浏览器上访问 Feed URL，我可以看到 XML，但服务器出现故障，我正在尝试以下操作

```
<?php
    $url = "http://www.legrandjournal.com.mx/category/actu-monde/feed/";

    $ch = curl_init();
    curl_setopt($ch, CURLOPT_RETURNTRANSFER,true);
    curl_setopt($ch, CURLOPT_URL,$url);
    curl_setopt($ch, CURLOPT_VERBOSE, 1);        
    $awel = curl_exec($ch);

    if($awel == false)
    {
        echo 'Curl error: ' . curl_error($ch);      
        echo "cookie";
    }

    //echo $awel;
    curl_close($ch);
    echo $awel;

?> 
```

提前感谢您的任何建议！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-30T23:32:14.640

不带最后一个斜线试试？: [http://www.legrandjournal.com.mx/category/actu-monde/feed](http://www.legrandjournal.com.mx/category/actu-monde/feed)

ps：您应该始终使用：

```
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1); 
```

如果您没有提供确切的 URL（例如使用斜杠，而不是等）

# css - 开源美国状态显示

> ID：809580
> 
> 赞同：1
> 
> 时间：2009-04-30T23:31:41.210
> 
> 标签：css, open-source

我想知道是否有人知道用于显示美国各州数字的开源项目。

具体来说，您总是会看到这些图形，其中加利福尼亚为深灰色，蒙大拿州为绿色等。基于某种标准。

我正在考虑为我维护的网站构建一个，但我希望我可能不必重新发明轮子。

[http://upload.wikimedia.org/wikipedia/commons/7/70/World_map_of_Energy_consumption_1979-1981.svg](http://upload.wikimedia.org/wikipedia/commons/7/70/World_map_of_Energy_consumption_1979-1981.svg)

类似上面的东西，但对于美国，你可以定义你自己的标准吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T23:35:38.017

试试[Google Charts API 中的地图](http://code.google.com/apis/chart/types.html#maps)。您可以以编程方式选择国家和颜色。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-30T23:36:22.790

这是我能在开源中找到的最好的。

我会采用这样的插件，只需根据您的动态数据将其更改为“突出显示”：

*   [http://plugins.jquery.com/project/maphilight](http://plugins.jquery.com/project/maphilight)

*   插件演示： http: [//davidlynch.org/js/maphilight/docs/demo_usa.html](http://davidlynch.org/js/maphilight/docs/demo_usa.html)

目前它在鼠标悬停时突出显示，但使用给定数据突出显示应该非常简单。

它带有美国地图并突出显示准备就绪的事实只是肉汁。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-04T23:50:10.073

为这个问题找到了更好的解决方案。

[http://en.wikipedia.org/wiki/File:Blank_US_Map.svg](http://en.wikipedia.org/wiki/File:Blank_US_Map.svg)

简单的 SVG（xml 文档）。只需遍历并根据需要更改填充/描边/任何值。完成后您可能需要转换为光栅，以便 IE(groan) 工作，但这确实是一个非常简单易用的解决方案。

更新：这是一个示例 javascript+jquery 代码块，它将通过百分比参数更新状态。从白色到蓝色的过渡。

```
for(var i = 0; i < states.length; i++) {
        var state = states[i];
        var stateDom = $("#"+state.id);
        var domArray = [];
        //hack to support multiple path state of Michigan
        if(stateDom.is("path"))
            domArray.push(stateDom);
        else {
            var children = $("#"+state.id + " path");
            for(var k = 0; k < children.length; k++){
                domArray.push($(children[k]));
            }
        }
        for(var l = 0; l < domArray.length; l++) {
            var stateObj = domArray[l];
            //Onlick event for each state
//              var closed = function (percentage) {
//                  return function (){
//                      alert("P"+percentage);
//                  }
//              }(state.percentage);
//              stateObj.click(closed);
                var svgStyle = stateObj.attr("style");
                var stylesArray = svgStyle.split(";");
                svgStyle = "";
                for(var j = 0; j < stylesArray.length; j++) {
                    var styleObj = stylesArray[j].split(":");
                    if(styleObj[0] == "fill") {
                        var mask = 256 - Math.round((state.percentage)/100 * 256);
                        styleObj[1] = "rgb("+mask+","+mask+",256)";
                    }
                    svgStyle += styleObj[0]+":"+styleObj[1] +";";
                }
                stateObj.attr("style",svgStyle);
            }
        } 
```

# iphone - 你什么时候在 iPhone 上使用 encodeWithCoder: 和 initWithCoder: ？

> ID：809588
> 
> 赞同：8
> 
> 时间：2009-04-30T23:33:00.457
> 
> 标签：iphone, objective-c, cocoa-touch, initwithcoder

正如我在上述主题中的问题所述，您通常必须满足哪些要求才能说“好的，我需要`encodeWithCoder:`为此`initWithCoder:`实例化”？通常您可以将对象状态写入`NSUserDefaults`，所以我很好奇您的专家何时决定使用一个与另一个？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-01T00:51:09.507

`initWithCoder:`解压缩 XIB 文件时由操作系统使用；如果您仔细观察，您会发现`initWithFrame:`您在 XIB 中创建的视图不需要这样做；他们会`initWithCoder:`打电话来的。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-01T00:19:33.780

用户默认值基本上是一个属性列表。属性列表类似于 JSON，只能存储特定类型的数据——NSString、NSNumber、NSData、NSDate、NSArray、NSDictionary。如果您尝试在用户默认值中存储任何其他内容，您将收到异常。属性列表也不能处理任意对象图，只能处理树。

您可以随时获取自定义状态并将其转换为与属性列表兼容的数据结构，然后将其存储在用户默认值中；但是你基本上是在实现一种对象序列化机制，你不妨使用 NSArchiver 已经提供的更强大的机制。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-30T23:53:43.950

`NSCoder`是实现序列化的标准 Cocoa 方法。有关详细信息，请参阅 Apple 的[Cocoa 存档和序列化编程指南](http://developer.apple.com/documentation/Cocoa/Conceptual/Archiving/Archiving.html)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T00:58:45.727

每当我有某种复杂的数据要存储而我不必手动编辑时，我都会使用 NSCoder。例如，我的应用[Converter](http://converterapp.com)将从 Internet 下载的货币汇率存储在 NSCoder 存档中。但是，这是它保存在此类存档中的唯一内容：只能手动更改的单位定义保存在应用程序包中的一系列 plist 文件中，最近选择的单位和值等内容保存在NSUserDefaults。

# xcode - 用 vim 中的自定义脚本替换 :make 命令

> ID：809589
> 
> 赞同：15
> 
> 时间：2009-04-30T23:33:03.187
> 
> 标签：xcode, macos, vim, makefile

我在 Xcode 中使用 MacVim 作为我的编辑器。默认情况下，Command-B 和 :make 必须从命令行调用 'make'。当我们使用 Xcode 进行构建和项目配置时，我想将 :make/Command-B 调用替换为 applescript 命令。这是可能的，我将如何去做？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-04-30T23:57:34.283

试试 :help makeprg

您使用 :set makeprg=xxx 更改执行的命令。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-04-20T09:57:37.847

为了从 CLI 运行 XCode 构建，命令是 xcodebuild。不过，我从未在 vim 中尝试过。

# java - 如何在 Java 中解码 PKCS#5 加密的 PKCS#8 私钥

> ID：809590
> 
> 赞同：2
> 
> 时间：2009-04-30T23:33:35.900
> 
> 标签：java, cryptography, keystore, pkcs#8

我有一个 PKCS#5 加密的 PKCS#8 RSA 私钥存储在磁盘文件中（最初由 SSLPlus 生成，大约在 1997 年），例如：

```
-----BEGIN ENCRYPTED PRIVATE KEY-----
MIICmDAaBgkqhkiG9w0BBQMwDQQIybM2XFqx4EwCAQUEggJ4MKg/NE+L6NJgbOf4
...
8QnGu4R7lFlweH/VAK8n0L75h3q2g62MKLJqmKLtAILNve4zymnO+LVZ4Js=
-----END ENCRYPTED PRIVATE KEY----- 
```

为此，我需要获取一个 Java Key 对象，然后我可以将其与匹配的证书一起添加到 KeyStore。私钥使用 100 字节的二进制密钥加密。

证书对象的创建很简单，但我似乎无法弄清楚如何从上述 Base64 编码的 PKCS#5 密钥到解密的 PKCS#8 RSA 私钥。在这一点上，我受到了阻碍，因为 SecretKeyFactory.generateSecret() 调用失败：

```
InvalidKeySpecException: Password is not ASCII 
```

现在，密码确实不是 ASCII，在最严格的意义上是 0x00 到 0x7F，但是 PBEWithMD5AndDES 算法应该接受从 0x00 到 0xFF 的字符值。

谁能告诉我如何从 Base64 编码的值到我可以添加到密钥库的 Key 对象？

* * *

**结论**

使用 Java 发布的 PBEKey 只接受 ASCII 值在 0x20<=char<=0x7E 范围内的密码。通过制作我自己的 BinaryPBEKey 解决了我的非 ASCII 密码的这个问题，它允许从 0x00 到 0xFF 的字节值（见下文）。

我遇到的后续问题是我的 PKCS#8 数据未正确编码（显然是早期 SSL 实现的常见错误），因为 PKCS#1 数据需要包装在 ASN.1 八位字节字符串中。我编写了一个简单的修补程序来处理我的密钥，这些密钥的长度在 512 到 4096 位之间（见下文）。

* * *

**私钥解码器**

```
private PrivateKey readPrivateKey(File inpfil) throws IOException, GeneralSecurityException {
    String[]                            pbeb64s;                                // PBE ASN.1 data base-64 encoded

    byte[]                              pbedta;                                 // PBE ASN.1 data in bytes
    EncryptedPrivateKeyInfo             pbeinf;                                 // PBE key info
    PBEParameterSpec                    pbeprm;                                 // PBE parameters
    Cipher                              pbecph;                                 // PBE decryption cipher

    byte[]                              pk8dta;                                 // PKCS#8 ASN.1 data in bytes
    KeyFactory                          pk8fac=KeyFactory.getInstance("RSA");   // PKCS#8 key factory for decoding private key from ASN.1 data.

    pbeb64s=readDataBlocks(inpfil,"ENCRYPTED PRIVATE KEY");
    if(pbeb64s.length!=1) { throw new GeneralSecurityException("The keystore '"+inpfil+"' contains multiple private keys"); }
    pbedta=base64.decode(pbeb64s[0]);
    log.diagln("  - Read private key data");

    pbeinf=new EncryptedPrivateKeyInfo(pbedta);
    pbeprm=(PBEParameterSpec)pbeinf.getAlgParameters().getParameterSpec(PBEParameterSpec.class);
    pbecph=Cipher.getInstance(pbeinf.getAlgName());
    pbecph.init(Cipher.DECRYPT_MODE,pbeDecryptKey,pbeprm);

    pk8dta=pbecph.doFinal(pbeinf.getEncryptedData());
    log.diagln("  - Private Key: Algorithm= "+pbeinf.getAlgName()+", Iterations: "+pbeprm.getIterationCount()+", Salt: "+Base16.toString(pbeprm.getSalt()));
    pk8dta=patchKeyData(inpfil,pk8dta);
    return pk8fac.generatePrivate(new PKCS8EncodedKeySpec(pk8dta));
    } 
```

* * *

**二进制PBEKey**

```
import java.io.*;
import java.security.*;
import java.security.spec.*;
import java.util.*;
import javax.crypto.*;
import javax.crypto.spec.*;

class BinaryPBEKey
extends Object
implements SecretKey
{
private final byte[]                    key;

/**
 * Creates a PBE key from a given binary key.
 *
 * @param key       The key.
 */
BinaryPBEKey(byte[] key) throws InvalidKeySpecException {
    if(key==null) { this.key=new byte[0];         }
    else          { this.key=(byte[])key.clone(); }
    Arrays.fill(key,(byte)0);
    }

public byte[] getEncoded() {
    return (byte[])key.clone();
    }

public String getAlgorithm() {
    return "PBEWithMD5AndDES";
    }

public String getFormat() {
    return "RAW";
    }

/**
 * Calculates a hash code value for the object.
 * Objects that are equal will also have the same hashcode.
 */
public int hashCode() {
    int                             ret=0;

    for(int xa=1; xa<this.key.length; xa++) { ret+=(this.key[xa]*xa); }
    return (ret^=getAlgorithm().toLowerCase().hashCode());
    }

public boolean equals(Object obj) {
    if(obj==this                 ) { return true;  }
    if(obj.getClass()!=getClass()) { return false; }

    BinaryPBEKey                    oth=(BinaryPBEKey)obj;

    if(!(oth.getAlgorithm().equalsIgnoreCase(getAlgorithm()))) {
        return false;
        }

    byte[]  othkey=oth.getEncoded();
    boolean ret   =Arrays.equals(key,othkey);
    Arrays.fill(othkey,(byte)0);
    return ret;
    }

public void destroy() {
    Arrays.fill(this.key,(byte)0);
    }

/**
 * Ensure that the password bytes of this key are zeroed out when there are no more references to it.
 */
protected void finalize() throws Throwable {
    try { destroy(); } finally { super.finalize(); }
    } 
```

* * *

**PKCS#8 补丁**

```
/**
 * Patch the private key ASN.1 data to conform to PKCS#8.
 * <p>
 * The SSLPlus private key is not properly encoded PKCS#8 - the PKCS#1 RSAPrivateKey should have been wrapped
 * inside an OctetString, thus:
 * <pre>
 * SSLPlus Encoding:
 *        0 30  627: SEQUENCE {
 *        4 02    1:   INTEGER 0
 *        7 30   13:   SEQUENCE {
 *        9 06    9:     OBJECT IDENTIFIER rsaEncryption (1 2 840 113549 1 1 1)
 *       20 05    0:     NULL
 *                 :     }
 *       22 30  605:   SEQUENCE {
 *       26 02    1:     INTEGER 0
 *       29 02  129:     INTEGER
 *                 :       00 CA 72 B8 D1 B8 8E B9 39 C0 92 C1 4C 53 B4 F4
 *       ...
 *
 * PKCS#8 Encoding
 *       0 30  631: SEQUENCE {
 *       4 02    1:   INTEGER 0
 *       7 30   13:   SEQUENCE {
 *       9 06    9:     OBJECT IDENTIFIER rsaEncryption (1 2 840 113549 1 1 1)
 *      20 05    0:     NULL
 *                :     }
 * ==>  22 04  609:   OCTET STRING, encapsulates {
 *      26 30  605:       SEQUENCE {
 *      30 02    1:         INTEGER 0
 *      33 02  129:         INTEGER
 *                :           00 CA 72 B8 D1 B8 8E B9 39 C0 92 C1 4C 53 B4 F4
 *      ...
 * </pre>
 *
 * Hex Dumps (1K key, space padded for clarity):
 *    Before      : 30 820271 020100300D06092A864886F70D0101010500           30 82025B ... A228
 *    After       : 30 820275 020100300D06092A864886F70D0101010500 04 82025F 30 82025B ... A228
 *                     ^^^^^^                                         ^^^^^^
 *                     Add 4 for later 0482xxxx                       Original total + 4 - 22 (equals the key length of 025B+4)
 */
private byte[] patchKeyData(File inpfil, byte[] asndta) throws IOException, GeneralSecurityException { // except it really doesn't throw an exception
    ByteArrayOutputStream               patdta=new ByteArrayOutputStream();
    int                                 orglen=decodeAsnLength(inpfil,asndta,1);

    patdta.write(asndta,0,1);                                                   // original leader type
    patdta.write(encodeAsnLength(inpfil,(orglen+4)));                           // new total length
    patdta.write(asndta,4,(22-4));                                              // bit between total length an where octet-string wrapper needs to be inserted
    patdta.write(0x04);                                                         // octet-string type
    patdta.write(encodeAsnLength(inpfil,(orglen+4-22)));                        // octet-string length (key data type+key data length+key data)
    patdta.write(asndta,22,asndta.length-22);                                   // private key data
    return patdta.toByteArray();
    }

private int decodeAsnLength(File inpfil, byte[] asndta, int ofs) throws GeneralSecurityException {
    if((asndta[ofs]&0xFF)==0x82) { return (((asndta[ofs+1]&0x000000FF)<< 8)|((asndta[ofs+2]&0x000000FF)));                                                           }
    else                         { throw new GeneralSecurityException("The private key in file '"+inpfil+"' is not supported (ID="+Base16.toString(asndta,0,4)+")"); }
    }

private byte[] encodeAsnLength(File inpfil, int len) throws GeneralSecurityException {
    if(len>=0x0100 && len<=0xFFFF) { return new byte[]{ (byte)0x82,(byte)((len>>>8)&0x000000FF),(byte)len };                                                            }
    else                           { throw new GeneralSecurityException("The new length of "+len+" for patching the private key in file '"+inpfil+"' is out of range"); }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T06:41:03.597

我刚刚将您的解密数据转储到 ASN.1 解析器中，对我来说它看起来非常好 ASN.1：

```
 0 30  627: SEQUENCE {
       4 02    1:   INTEGER 0
       7 30   13:   SEQUENCE {
       9 06    9:     OBJECT IDENTIFIER rsaEncryption (1 2 840 113549 1 1 1)
      20 05    0:     NULL
                :     }
      22 30  605:   SEQUENCE {
      26 02    1:     INTEGER 0
      29 02  129:     INTEGER
                :       00 CA 72 B8 D1 B8 8E B9 39 C0 92 C1 4C 53 B4 F4
                :       38 48 3F C3 1C DC 6B BC BE 26 A3 B2 F7 7C 60 A8
                :       2C 0D 86 ED FC 2D D2 5C 99 B6 B6 71 A8 6D 2F 51
                :       25 FA 9C 42 FE 10 C1 2F 39 EA E8 FF 1A 78 BA 6B
                :       64 B8 39 34 3B F4 1C 45 06 C3 B9 98 DC 01 FF 41
                :       56 36 4F DD 35 69 A4 27 BB 5F FD DD 5C 73 BA 9A
                :       94 5A 4F 37 A9 48 3D 5B 89 EA EE BA 8D 02 6E D7
                :       6E D4 6F BC 7D 7A A4 41 4C 4D CA 08 05 20 66 A3
                :               [ Another 1 bytes skipped ]
     161 02    3:     INTEGER 65537
     166 02  128:     INTEGER
                :       21 6A E2 7B 2B DD D3 51 67 2A 52 62 09 07 3B B0
                :       F6 AC 1F C6 E9 D3 96 EA 44 72 8D 1E 31 17 BB 6A
                :       DA 28 C5 AB F4 DC 5E 90 B9 0A 50 A4 9E B1 4A D1
                :       DC 16 63 30 91 0F 72 7E 3A FA 8E F1 8D B0 27 FD
                :       C2 BA B5 F8 FC 7C 46 C0 FD AD A7 39 7C 36 71 7A
                :       33 8B AD 0D 0C DA 50 B7 0E BF D8 64 7D 44 BD 64
                :       6F E2 51 B7 5E 2D 7B BA 02 DB A6 2F 20 88 66 98
                :       85 34 2E EF D4 29 61 23 79 87 27 27 55 15 8D 21
     297 02   65:     INTEGER
                :       00 F9 62 BD 22 4A C8 56 7A C3 17 EB CE CC 5F 42
                :       E1 40 F5 A5 66 60 32 54 86 67 26 AD 7C 34 C2 FE
                :       FE 8A F7 7F BE 79 53 5F C9 73 D9 47 8B 0F 89 A1
                :       09 F1 27 16 FC F1 4B C3 A9 27 59 29 0D DA 9C AE
                :       53
     364 02   65:     INTEGER
                :       00 CF D1 4A 31 50 9A B4 BA 90 42 25 49 54 7C 20
                :       54 2E CF E8 F1 35 DA 92 C2 A3 94 9D B7 B1 85 3F
                :       13 D0 CA BC 77 D9 8A F3 32 83 59 93 E1 F0 11 1B
                :       4C E5 A2 30 50 FE 1F B6 8D A5 B1 44 DA 4D 4B 11
                :       09
     431 02   64:     INTEGER
                :       46 53 3A C4 9D D4 0A D7 09 87 08 5F 43 B0 A5 5A
                :       82 08 03 81 70 25 21 42 D9 79 C5 B8 5D E4 93 25
                :       D2 A8 62 A4 A2 F0 08 F5 F5 2E 53 87 7A 75 34 2D
                :       6A 8C BC 65 CD E1 B0 A6 55 CB 45 D1 7B 51 6D B3
     497 02   65:     INTEGER
                :       00 81 CC 61 7F 9D AD 92 F5 F7 86 28 CD BD 43 ED
                :       D9 46 87 BB 21 75 16 78 95 B3 1F EE C6 3D CD 50
                :       91 6A D6 45 92 C1 C0 24 97 C7 2C 5A CE 42 68 1C
                :       DA 11 8F 14 88 71 C0 92 FF B3 9E 9D B7 8F 91 34
                :       29
     564 02   65:     INTEGER
                :       00 88 7A 99 AC AA A9 D5 2B 6E E1 87 0A E8 D2 4C
                :       04 8E A2 EA 00 3F 8D AF 9F 76 61 86 B0 1D 18 69
                :       C8 64 22 D4 6B A3 A4 BB 52 B1 AC 38 DB 6B 5C 28
                :       F0 78 73 3E 37 FD C8 54 72 C7 FD A9 EB C9 F2 45
                :       96
                :     }
                :   } 
```

不幸的是，它不是正确编码的 PKCS#8 PrivateKeyInfo。从索引 22 开始的序列是 PKCS#1 PKCS1RSAPrivateKey，它应该被包装在 OctetString 中，以便正确编码结构。

试试这个：30820277020100300D06092A864886F70D0101010500048202613082025D02010002818100CA72B8D1B88EB939C092C14C53B4F438483FC31CDC6BBCBE26A3B2F77C60A82C0D86EDFC2DD25C99B6B671A86D2F5125FA9C42FE10C12F39EAE8FF1A78BA6B64B839343BF41C4506C3B998DC01FF4156364FDD3569A427BB5FFDDD5C73BA9A945A4F37A9483D5B89EAEEBA8D026ED76ED46FBC7D7AA4414C4DCA08052066A3EB0203010001028180216AE27B2BDDD351672A526209073BB0F6AC1FC6E9D396EA44728D1E3117BB6ADA28C5ABF4DC5E90B90A50A49EB14AD1DC166330910F727E3AFA8EF18DB027FDC2BAB5F8FC7C46C0FDADA7397C36717A338BAD0D0CDA50B70EBFD8647D44BD646FE251B75E2D7BBA02DBA62F2088669885342EEFD42961237987272755158D21024100F962BD224AC8567AC317EBCECC5F42E140F5A566603254866726AD7C34C2FEFE8AF77FBE79535FC973D9478B0F89A109F12716FCF14BC3A92759290DDA9CAE53024100CFD14A31509AB4BA90422549547C20542ECFE8F135DA92C2A3949DB7B1853F13D0CABC77D98AF332835993E1F0111B4CE5A23050FE1FB68DA5B144DA4D4B1109024046533AC49DD40AD70987085F43B0A55A8208038170252142D979C5B85DE49325D2A862A4A2F008F5F52E53877A75342D6A8CBC65CDE1B0A655CB45D17B516DB302410081CC617F9DAD92F5F78628CDBD43EDD94687BB2175167895B31FEEC63DCD50916AD64592C1C02497C72C5ACE42681CDA118F148871C092FFB39E9DB78F913429024100887A99ACAAA9D52B6EE1870AE8D24C048EA2EA003F8DAF9F766186B01D1869C86422D46BA3A4BB52B1AC38DB6B5C28F078733E37FDC85472C7FDA9EBC9F24596

解析：

```
 0 30  631: SEQUENCE {
   4 02    1:   INTEGER 0
   7 30   13:   SEQUENCE {
   9 06    9:     OBJECT IDENTIFIER rsaEncryption (1 2 840 113549 1 1 1)
  20 05    0:     NULL
            :     }
  22 04  609:   OCTET STRING, encapsulates {
  26 30  605:       SEQUENCE {
  30 02    1:         INTEGER 0
  33 02  129:         INTEGER
            :           00 CA 72 B8 D1 B8 8E B9 39 C0 92 C1 4C 53 B4 F4
            :           38 48 3F C3 1C DC 6B BC BE 26 A3 B2 F7 7C 60 A8
            :           2C 0D 86 ED FC 2D D2 5C 99 B6 B6 71 A8 6D 2F 51
            :           25 FA 9C 42 FE 10 C1 2F 39 EA E8 FF 1A 78 BA 6B
            :           64 B8 39 34 3B F4 1C 45 06 C3 B9 98 DC 01 FF 41
            :           56 36 4F DD 35 69 A4 27 BB 5F FD DD 5C 73 BA 9A
            :           94 5A 4F 37 A9 48 3D 5B 89 EA EE BA 8D 02 6E D7
            :           6E D4 6F BC 7D 7A A4 41 4C 4D CA 08 05 20 66 A3
            :                   [ Another 1 bytes skipped ]
 165 02    3:         INTEGER 65537
 170 02  128:         INTEGER
            :           21 6A E2 7B 2B DD D3 51 67 2A 52 62 09 07 3B B0
            :           F6 AC 1F C6 E9 D3 96 EA 44 72 8D 1E 31 17 BB 6A
            :           DA 28 C5 AB F4 DC 5E 90 B9 0A 50 A4 9E B1 4A D1
            :           DC 16 63 30 91 0F 72 7E 3A FA 8E F1 8D B0 27 FD
            :           C2 BA B5 F8 FC 7C 46 C0 FD AD A7 39 7C 36 71 7A
            :           33 8B AD 0D 0C DA 50 B7 0E BF D8 64 7D 44 BD 64
            :           6F E2 51 B7 5E 2D 7B BA 02 DB A6 2F 20 88 66 98
            :           85 34 2E EF D4 29 61 23 79 87 27 27 55 15 8D 21
 301 02   65:         INTEGER
            :           00 F9 62 BD 22 4A C8 56 7A C3 17 EB CE CC 5F 42
            :           E1 40 F5 A5 66 60 32 54 86 67 26 AD 7C 34 C2 FE
            :           FE 8A F7 7F BE 79 53 5F C9 73 D9 47 8B 0F 89 A1
            :           09 F1 27 16 FC F1 4B C3 A9 27 59 29 0D DA 9C AE
            :           53
 368 02   65:         INTEGER
            :           00 CF D1 4A 31 50 9A B4 BA 90 42 25 49 54 7C 20
            :           54 2E CF E8 F1 35 DA 92 C2 A3 94 9D B7 B1 85 3F
            :           13 D0 CA BC 77 D9 8A F3 32 83 59 93 E1 F0 11 1B
            :           4C E5 A2 30 50 FE 1F B6 8D A5 B1 44 DA 4D 4B 11
            :           09
 435 02   64:         INTEGER
            :           46 53 3A C4 9D D4 0A D7 09 87 08 5F 43 B0 A5 5A
            :           82 08 03 81 70 25 21 42 D9 79 C5 B8 5D E4 93 25
            :           D2 A8 62 A4 A2 F0 08 F5 F5 2E 53 87 7A 75 34 2D
            :           6A 8C BC 65 CD E1 B0 A6 55 CB 45 D1 7B 51 6D B3
 501 02   65:         INTEGER
            :           00 81 CC 61 7F 9D AD 92 F5 F7 86 28 CD BD 43 ED
            :           D9 46 87 BB 21 75 16 78 95 B3 1F EE C6 3D CD 50
            :           91 6A D6 45 92 C1 C0 24 97 C7 2C 5A CE 42 68 1C
            :           DA 11 8F 14 88 71 C0 92 FF B3 9E 9D B7 8F 91 34
            :           29
 568 02   65:         INTEGER
            :           00 88 7A 99 AC AA A9 D5 2B 6E E1 87 0A E8 D2 4C
            :           04 8E A2 EA 00 3F 8D AF 9F 76 61 86 B0 1D 18 69
            :           C8 64 22 D4 6B A3 A4 BB 52 B1 AC 38 DB 6B 5C 28
            :           F0 78 73 3E 37 FD C8 54 72 C7 FD A9 EB C9 F2 45
            :           96
            :         }
            :       }
            :   } 
```

要修复您的文件，您可以使用 ASN.1 库（但我不知道 Java 有一个好的库），或者执行以下操作：

检查您的数据 是否以以下形式之一开始`30(*1)020100300D06092A864886F70D010101050030(*2)` `(*1)`并且将是长度编码`(*2)`

*   length<=0x7F: `XX`，其中 XX 是长度
*   0x80<=length<=0xFF: `81XX`，其中 XX 是长度
*   0x0100<=length<=0xFFFF: `82XXXX`，其中 XXXX 是长度
*   0x010000<=length<=0xFFFFFF: `83XXXXXX`，其中 XXXXXX 是长度等。

如果您的密钥长度相同，您可能会假设长度编码总是在 form 上`82XXXX`，但实际长度可能会有所不同。

读取 中的长度`(*2)`，将长度（以字节为单位）添加`30(*2)`到数字（这可能是 4）并如上所述对长度进行编码（很可能是形式`82XXXX`）。让我们称之为长度编码`(*3)`。`04(*3)`在 .之前插入`30(*2)`。`04(*3)`现在将（可能也是4）的长度添加到`(*1)`并重新编码（可能仍然适合`82XXXX`）并用`(*1)`它替换。

我希望这是可以理解的，否则我建议阅读[ASN.1、BER 和 DER 子集的外行指南](http://luca.ntop.org/Teaching/Appunti/asn1.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T17:33:48.187

您是否尝试过使用一些 Bouncy Castle 内部类打开密钥？也许通过直接使用它们而不是仅仅将 BC 定义为加密提供者，您可以解析该文件......

# apache - mod_rewrite 帮助通过查询字符串传递完整路径

> ID：809600
> 
> 赞同：3
> 
> 时间：2009-04-30T23:38:13.410
> 
> 标签：apache, mod-rewrite, rewrite

我正在根据整个 url 做一些缓存，包括查询字符串，并且需要 Apache 来识别文件并使用它。它似乎找到了匹配项，但随后在呈现文件之前将查询字符串剥离。

网址：www.somesite.com/default.asp?foo=bar

缓存文件夹中文件系统上的缓存页面文件名：default.asp?foo=bar

我目前的重写尝试：

```
RewriteCond /site_root/cache/%{REQUEST_FILENAME}?%{QUERY_STRING} -f
RewriteRule ^.*$ /site_root/cache/%{REQUEST_FILENAME}?%{QUERY_STRING} [L,QSA] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T03:10:55.613

您可能想尝试这样的事情：

```
RewriteRule ^(.+)$ /site_root/cache/$1 [L,QSA] 
```

这应该将 URL 中的“default.asp”重写为我*认为*您正在尝试使用的内容。QSA 应该使原始查询字符串附加到重写的 URL。

我不是 100% 确定这就是你要找的东西，所以如果没有让我知道，我会尽力提供帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T06:37:38.847

我找到了一个适合我需要的解决方案。

看来 Apache 真的很想把查询字符串拉出来成一组 params，这很正常。

为了在 Apache 上完成任务，我刚刚替换了 ? 在带有 | 的字符串中。一旦我这样做了，它就不再将字符串视为查询字符串。由于参数在我的情况下无关紧要，因此可以正常工作。我所要做的就是确保我用管道而不是问号写出文件名。很容易。

如果您有更好的解决方案，请随时发表评论。

这是为我做的规则。由于 Apache 无法将结果识别为它知道的 MIME，因此我将其强制为 text/html。

```
RewriteRule ^(.+)$ /site_root/cache/%{HTTP_HOST}$1|%{QUERY_STRING} [L,T=text/html] 
```

# c# - Excel 加载项安装和设置 .Net 安全/信任

> ID：809602
> 
> 赞同：1
> 
> 时间：2009-04-30T23:39:30.693
> 
> 标签：c#, security, excel, installation, vsto

我的环境是面向 Excel 2003 的 VS2005 C#。当我看到在解决方案中专门为我创建了一个 .msi 项目时，我对这个插件的安装程序有点过度自信。不用说，这是整个项目中最棘手的部分，我完全不知道如何在安装过程中为我的加载项部署和设置完全信任。

我遵循了来自[http://msdn.microsoft.com/en-us/library/aa537179(office.11](http://msdn.microsoft.com/en-us/library/aa537179(office.11).aspx) ​​).aspx 的非常有用的示例——“使用 Windows Installer 为 Office 解决方案部署 Visual Studio 2005 工具：演练（第 2 部分） 2)"。

该文档中似乎存在一些不准确之处，但确实是很小的事情。我正在使用 VSTO 2005 工具示例项目将 .net 安全设置为 .msi 的自定义操作。这似乎可行，但目前不允许加载我的插件，除非我使用 .Net Framework 配置工具手动更改一些内容。安装完成后，我看到 Excel 插件的相应注册表项和 0x03 的相应 LoadBehavior。从控制面板中的 .Net 2.0 框架配置小程序中，我看到 2 个节点添加到我的运行时安全策略中。

运行时安全策略-->用户-->代码组-->All_Code-->MyCodeGroup-->MyCodeGroupChild。

MyCodeGroup 设置设置为 NONE 的 URL 验证和策略级别。MyCodeGroup 子设置是 STRONG NAME，并且与我为我的加载项 dll 设置的匹配。

在此设置中，插件不会加载。如果我将“MyCodeGroup”策略从无更改为完全信任，它会起作用。（在我将注册表加载行为从 0x02 重置回 0x03 之后）。

对此有什么想法吗？我在网上没有找到太多可以指出我哪里出错的地方。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T16:09:36.847

担，

根据我的经验，我发现使用 CASPOL.exe 是设置安全策略的最简单方法。

例如，您可以使用以下命令向文件夹中的所有 DLL 授予完全信任： caspol -u -ag All_Code -url C:\FolderName\FolderName* FullTrust -n"Name" -d"Description"

查看这篇 MSDN 文章：http: [//msdn.microsoft.com/en-us/library/zdc263t0.aspx](http://msdn.microsoft.com/en-us/library/zdc263t0.aspx)

或者这个关于CASPOL的：http: [//msdn.microsoft.com/en-us/library/cb6t8dtz.aspx](http://msdn.microsoft.com/en-us/library/cb6t8dtz.aspx)

或者您可以使用以下代码作为基础推出您自己的 c# 项目： [http ://www.koders.com/csharp/fidDC5A2D42FE98AD20FFC65C44​​35785CDFE3CB5B10.aspx](http://www.koders.com/csharp/fidDC5A2D42FE98AD20FFC65C4435785CDFE3CB5B10.aspx)

这就是我们所做的。

**同样根据评论：**从您的 msi 构建中排除 PIA 和 VSTO 运行时（转到 msi 项目中的引用，右键单击它们并选择“排除”）并单独安装它们。只需在谷歌上搜索“Excel 2003 PIA 下载”和“VSTO 运行时下载”即可获取安装程序。让您的所有客户在您的应用程序之前安装它们。

这样你只需要担心插件的安全性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-20T05:38:16.627

如果您有自定义程序集，则仅需要 setsecurity。您是对的，示例代码不起作用，但需要进行一些小改动。让我知道 CaspolSecurityPolicyCreator 的代码更改是否会修复它。（否则需要比较我的原件并找出不同之处） internal static void AddSecurityPolicy( bool machinePolicyLevel, string solutionCodeGroupName, string solutionCodeGroupDescription, string assemblyPath, string assemblyCodeGroupName, string assemblyCodeGroupDescription) { string frameworkFolder = GetFrameworkFolder();

```
 string solutionInstallationLocation = Path.GetDirectoryName(assemblyPath);
        string solutionInstallationUrl = Path.Combine(solutionInstallationLocation, "*");

        string policyLevel;
        string parentCodeGroup;
        if (machinePolicyLevel)
        {
            policyLevel = "-m"; // Use Machine-level policy.
            parentCodeGroup = "My_Computer_Zone"; // Use My_Computer_Zone for assemblies installed on the computer.
        }
        else
        {
            policyLevel = "-u"; // Use User-level policy.
            parentCodeGroup = "All_Code";
        }

        // Add the solution code group. Grant no permission at this level.
        string arguments = policyLevel + " -q -ag " + parentCodeGroup + " -url \"" + solutionInstallationUrl + "\" Nothing -n \"" + solutionCodeGroupName + "\" -d \"" + solutionCodeGroupDescription + "\"";
        try
        {
            RunCaspolCommand(frameworkFolder, arguments);
        }
        catch (Exception ex)
        {
            string error = String.Format("Cannot create the security code group '{0}'.", solutionCodeGroupName);
            throw new Exception(error, ex);
        }

        // Add the assembly code group. Grant FullTrust permissions to the main assembly.
        try
        {
            // Use the assembly strong name as the membership condition.
            // Ensure that the assembly is strong-named to give it full trust.
            //AssemblyName assemblyName = Assembly.LoadFile(assemblyPath).GetName();
            //arguments = policyLevel + " -q -ag \"" + solutionCodeGroupName + "\" -strong -file \"" + assemblyPath + "\" \"" + assemblyName.Name + "\" \"" + assemblyName.Version.ToString(4) + "\" FullTrust -n \"" + assemblyCodeGroupName + "\" -d \"" + assemblyCodeGroupDescription + "\"";

            //RunCaspolCommand(frameworkFolder, arguments);
            //TODO- MS Hardcoded for now (better at assembly dll level use todo 1)
            arguments = policyLevel + " -q -ag \"" + solutionCodeGroupName + "\" -url \"" + solutionInstallationUrl + "\" FullTrust -n \"" + assemblyCodeGroupName + "\" -d \"" + assemblyCodeGroupDescription + "\"";
            RunCaspolCommand(frameworkFolder, arguments);
            //TODO: 1 code below will create a separate group per assembly path, also need to check if AcnUI assembly is installed in GAC.
            //AddFullTrust(frameworkFolder, assemblyPath, policyLevel, solutionCodeGroupName, assemblyCodeGroupName, assemblyCodeGroupDescription);
        }
        catch (Exception ex)
        {
            try
            {
                // Clean the solutionCodeGroupName.
                RemoveSecurityPolicy(machinePolicyLevel, solutionCodeGroupName);
            }
            catch {}

            string error = String.Format("Cannot create the security code group '{0}'.", assemblyCodeGroupName);
            throw new Exception(error, ex);
        }
    }

    internal static void RemoveSecurityPolicy(
        bool   machinePolicyLevel,
        string solutionCodeGroupName)
    {
        string frameworkFolder = GetFrameworkFolder();
        string policyLevel;
        if (machinePolicyLevel)
            policyLevel = "-m"; // Use Machine-level policy.
        else
            policyLevel = "-u"; // Use User-level policy.

        string arguments = policyLevel + " -q -rg \"" + solutionCodeGroupName + "\"";
        RunCaspolCommand(frameworkFolder, arguments);
    }

    private static string GetFrameworkFolder()
    {
        // Get the targeted Framework folder.
        Version version = new Version(2, 0, 50727);
        return GetRuntimeInstallationDirectory(version, true);
    } 
```

# objective-c - NSUserDefaults：转储 NSUserDefaults 的 standardUserDefaults 的结构

> ID：809607
> 
> 赞同：17
> 
> 时间：2009-04-30T23:41:19.800
> 
> 标签：objective-c, cocoa-touch

有谁知道通过 NSLog 转储 NSUserDefaults 的 standardUserDefaults 的快速方法？这就是我所拥有的：

```
NSLog(@"NSUserDefaults dump: %@", [NSUserDefaults standardUserDefaults]); 
```

但它返回：

```
NSUserDefaults dump: <NSUserDefaults: 0x50b520> 
```

...这不是我想要的。我真的很想拥有键值对。

任何帮助或正确方向的观点将不胜感激。干杯!

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-04-30T23:45:37.340

```
NSLog(@"NSUserDefaults dump: %@", [[NSUserDefaults standardUserDefaults] dictionaryRepresentation]); 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-05-05T19:54:50.003

感谢我的商业伙伴兼朋友 Don McCaughey 为我修改了代码并提供了简洁的答案。在这里与大家分享它是一个代码片段：

```
 NSDictionary *bundleInfo = [[NSBundle mainBundle] infoDictionary];
  NSString *bundleId = [bundleInfo objectForKey: @"CFBundleIdentifier"];

  NSUserDefaults *appUserDefaults = [[NSUserDefaults alloc] init];
  NSLog(@"Start dumping userDefaults for %@", bundleId);
  NSLog(@"userDefaults dump: %@", [appUserDefaults persistentDomainForName: bundleId]);
  NSLog(@"Finished dumping userDefaults for %@", bundleId);
  [appUserDefaults release]; 
```

如您所见，回答问题的每个人都在正确的轨道上，但没有提供任何代码是解决方案 - 直到 Don 在源代码控制中编辑我们的代码。谢谢大家！

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-04-30T23:46:24.530

尝试：

```
NSLog(@"NSUserDefaults dump: %@", [[NSUserDefaults standardUserDefaults] dictionaryRepresentation]); 
```

[dictionaryRepresentation](http://developer.apple.com/DOCUMENTATION/Cocoa/Reference/Foundation/Classes/NSUserDefaults_Class/Reference/Reference.html#//apple_ref/occ/instm/NSUserDefaults/dictionaryRepresentation)返回默认值的 NSDictionary 表示。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-09-25T13:16:33.480

```
NSLog(@"%@ defaults = %@", [self class], 
  [[NSUserDefaults standardUserDefaults] 
   persistentDomainForName:[[NSBundle mainBundle] bundleIdentifier]]); 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-05-01T03:13:45.373

默认情况下，共享的 NSUserDefaults 使用三个搜索域初始化（如果需要，您也可以添加其他域）：应用程序参数、应用程序首选项（存储在应用程序的 plist 中的内容）和本地化系统首选项。最后一个是为什么您会看到那些不熟悉的 Apple 密钥，但您实际上不必担心“覆盖”它们。如果您使用相同的键名，它只会将该值放入应用首选项域中。在系统首选项之前搜索您的应用程序首选项，因此您将获得相同的值，但不会影响其他任何内容。

但是，如果您确实只需要应用程序的首选项，则可以删除其他搜索域（您需要的特定名称在文档中）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-02-27T08:12:58.510

这是一个方便的类，您可以使用它来转储各种废话：

[https://github.com/VTPG/CommonCode/blob/master/VTPG_Common.h](https://github.com/VTPG/CommonCode/blob/master/VTPG_Common.h)

要使用它，请将标题添加到您的“m”

```
#import "VTPG_Common.h" 
```

然后在你班级的任何地方调用LOG_EXPR（foo）：

```
NSUserDefaults *userDefaults = [[NSUserDefaults alloc] init];
[userDefaults addSuiteNamed:@"com.apple.spaces"];
NSDictionary *foo = [userDefaults dictionaryForKey:@"SpacesDisplayConfiguration"];
LOG_EXPR(foo); 
```

# mysql - Mysql 断开连接

> ID：809608
> 
> 赞同：0
> 
> 时间：2009-04-30T23:42:40.293
> 
> 标签：mysql, ruby-on-rails, connection

我正在使用 Instant Ruby on Rails Mysql 5.0.27 版，正在开发一个系统，一切正常（有点）。现在数据库不断下降。我发现一些评论说用户ID需要root和密码空白，我已经更改了密码，所以我把它改回来了。视图运行良好，显示和更改超过 500 内部错误，日志显示 Mysql 连接已断开。有什么线索吗？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-30T23:48:45.757

ActiveRecord::StatementInvalid (Mysql::Error: Lost connection to MySQL server during query: SELECT * FROM `events` WHERE ( `events`. `id`= 1) ): 其次是很多失败的错误

# c# - C# 简单事件引发 - 使用“发送者”与自定义 EventArgs

> ID：809609
> 
> 赞同：17
> 
> 时间：2009-04-30T23:42:41.497
> 
> 标签：c#, events

考虑这种情况。我有一个对象，我们称之为.... Foo。Foo 引发了一个名为“Loaded”的简单事件。作为事件信息的一部分，消费者需要知道哪个 foo 对象引发了事件。我们的团队采用了以下模式。

1) 创建一个继承自 EventArgs 的新类 - 例如 FooEventArgs : System.EventArgs。

2) 向 FooEventArgs 添加一个 Foo 类型的属性，该属性是通过构造函数传入来设置的。

3）使用EventHandler的通用版本声明事件，所以

```
public event EventHandler<FooEventArgs> Loaded; 
```

4) 使用以下签名从 Foo 类引发事件：

```
Loaded(this, new FooEventArgs(this)); 
```

本质上，它的作用是使“发送者”成为 foo 对象，但它*也*将 foo 对象引用作为强类型属性放入事件参数中。

这样做的一个好处是，当他们处理事件时，没有人必须为“发送者”而烦恼，这降低了事件消费者和事件引发者之间的耦合。另一个“优点”是，如果事件引发者的类型必须改变，因此强类型属性（希望永远不会发生），那么当它出现为空时，而不是简单地让代码开始在强制转换中失败， API 实际上会中断，因此可以在编译时修复。

对我来说，这种模式似乎有点矫枉过正。他们是否应该更加信任“sender”参数，并放弃自定义事件参数？我的团队认为没有人真正使用 sender 参数。传递对事件引发对象的引用的最佳实践是什么？

**编辑：到目前为止，反馈很好，我会在接受之前将其保留一天左右。**

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-30T23:45:05.157

常见的模式是使用 sender，而不是将 sender 单独添加到 EventArgs。自定义 EventArgs 用于其他状态，例如用于树事件的树节点、用于可取消事件的（可设置的）布尔值等。

我们使用通用模式，因为它也被 BCL 类使用，并且为“自制事件”做出改变可能会令人困惑。此外，我们有一个全局 IoC 发布者-订阅者模式，但这个模式只适用于普通的 EventHandler 委托签名，因为事先不知道类型。在这种情况下，无论如何都需要强制转换（例如到自定义 EventArgs），所以我们也可以强制转换发送者。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-30T23:49:34.240

我不认为这是矫枉过正。我同意您所说的拥有单独的 FooEventArgs 类的优势。这样做的另一个好处是，如果您将来需要向事件添加更多信息，您只需向 FooEventArgs 添加更多属性，而无需更改委托。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-01T01:06:12.137

我会说您删除 EventArgs 的子类并使用 sender 属性来识别事件的发送者。我认为遵循约定的参数有优点，但 EventArgs 中的参数不是必需的。我个人会放弃它，只使用 sender 属性。

如果您想将其作为强类型传递，您也可以创建一个自定义委托以用于您的事件......

```
public delegate void LoadedHandler(FooEventArgs args); 
```

这样你就可以把它当作一个强大的类型......重用代表很棒，但如果它们不适合你想要做的事情，你不应该只使用内置的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-01T04:13:40.020

就推荐的做法而言，我已经看到很多在 Windows Workflow Foundation 中作为发件人提供的 null。理想情况下，您的订阅者应该忘记引发事件的对象。

因此，如果您需要将调用者对象作为一个整体传递给处理程序，则必须将其放置在 EventArgs 派生对象中。或者，我更喜欢明确地传递事件引发者/调用者状态的点点滴滴，而不是整个事情。

好吧，有时更容易想到 dotNET 1.1，其中

```
Control.Invoke() 
```

经常使用

```
int i; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-30T23:46:42.377

我会说公约有很多事情要做。从长远来看，需要维护的东西更少——尤其是。如果你让新人进来。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-30T23:48:35.117

我想这在某种程度上是一个偏好问题，但就我而言，当我阅读时，`consumers will need to know which foo object raised the event.`我立即认为你可以从 sender 参数中获取引发事件的对象，那么问题是什么？

您的团队有一些有效的观点（在具有强类型属性方面），但我想说，从长远来看，使用框架指南而不是发明自己的指南会是一个更好的决定。

# php - 如何在函数中调用数组？PHP

> ID：809614
> 
> 赞同：1
> 
> 时间：2009-04-30T23:45:03.643
> 
> 标签：php, arrays

全局作用域允许您在函数中使用在函数外部定义的变量。例如

```
$a=1;
function $test(){
echo $a;
}

//outputs 1 
```

但是为什么如果我用数组定义一个变量我不能以同样的方式使用它呢？

```
$test = array(
0=>'zero', 
1=>'one', 
2=>'two',
3=>'three', 
);

function doesntWork($something){
echo "My favorite number is " . $test[$something]; 
}

//outputs My favorite number is 0 
```

我如何将数组传递给函数，而不必将数组重新复制到函数本身。

任何解释将不胜感激谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-01T00:13:02.577

脚本 #1 不正确。它既不工作（函数**$**test（）{...}），也不输出“1”。和全局是不好的做法。将它们包装在一个类中与它无关。*类不是与面向对象无关的随机问题的解决方案。*

只需将 $a 作为参数传递：

```
<?php 
  $a=1; 
  function test($foo) { 
    echo 'number ' . $foo; 
  }; 

  test($a);
  // -> "number 1". 
 ?> 
```

脚本#2：

```
<?php
  $test = array(
    0=>'zero', 
    1=>'one', 
    2=>'two',
    3=>'three', 
  );

  function doesntWork($test, $something){
    echo "My favorite number is " . $test[$something]; 
  }

  doesntWork($test, mt_rand(0,3));
?> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-30T23:51:02.397

您的第一个示例不应输出 1。在特定函数中使变量成为全局变量的唯一方法是使用 global 关键字，如下所示：

```
function test() {
    global $a;
    echo $a;
}

function doesWork($something) {
    global $test;
    echo "My favorite number is " . $test[$something]; 
} 
```

更多信息在这里：[http ://ca2.php.net/manual/en/language.variables.scope.php](http://ca2.php.net/manual/en/language.variables.scope.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-30T23:51:53.940

PHP 没有隐式全局作用域；您必须使用[global](http://us.php.net/manual/en/language.variables.scope.php)关键字来访问“全局”变量。

$a 输出 1 可能是由于 PHP 对变量的可疑处理的复杂性。

# utf-8 - UTF8 还是 UTF-8？

> ID：809620
> 
> 赞同：46
> 
> 时间：2009-04-30T23:47:17.490
> 
> 标签：utf-8, terminology

两者哪个是正确的术语？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-04-30T23:54:28.050

那要看你用在什么地方了...

编码的名称是`UTF-8`.

破折号不能在任何地方使用，因此例如在 .NET 框架中，返回处理 UTF-8 编码的类`System.Text.Encoding`的实例的类的属性被命名为.`UTF8Encoding``UTF8`

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-04-30T23:53:06.883

它绝对是 UTF-8。UTF8 通常只用于不允许使用破折号的地方（编程语言标识符）或因为人们太懒惰。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-04-30T23:53:46.803

遵循 RFC 标准，答案是 UTF-8

[http://www.ietf.org/rfc/rfc3629](http://www.ietf.org/rfc/rfc3629)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-04-30T23:50:49.200

我相信根据 Unicode Consortium，它是 UTF-8。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-04-30T23:53:21.267

还有[UTF-8](http://en.wikipedia.org/wiki/UTF-8)（对 UTF-8 的伟大而彻底的解释）

# wpf - 定位第一个 WPF 制表位

> ID：809622
> 
> 赞同：1
> 
> 时间：2009-04-30T23:48:06.803
> 
> 标签：wpf, keyboard, navigation, tabstop

感谢对上一个问题（[上一个问题](https://stackoverflow.com/questions/809382/how-to-programmatically-navigate-wpf-ui-element-tab-stops)）的回答，我现在有一段代码可以导航 WPF 制表位（如下所示）。除了第一个制表位外，它工作正常。调用 this.MoveFocus(...First) 后跟 FocusManager.GetFocusedElement 返回 null。有任何想法吗？如何在我的窗口中获得第一个制表位？

谢谢， - 迈克

```
// Select the first element in the window
this.MoveFocus(new TraversalRequest(FocusNavigationDirection.First));

TraversalRequest next = new TraversalRequest(FocusNavigationDirection.Next);
List<IInputElement> elements = new List<IInputElement>();

// Get the current element.
UIElement currentElement = FocusManager.GetFocusedElement(this) as UIElement;
while (currentElement != null)
{
    elements.Add(currentElement);

    // Get the next element.
    currentElement.MoveFocus(next);
    currentElement = FocusManager.GetFocusedElement(this) as UIElement;

    // If we looped (If that is possible), exit.
    if (elements[0] == currentElement)
        break;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-04-12T19:50:04.770

我需要在我正在从事的项目中做类似的事情，我发现一些似乎工作得很好的东西。

这是一个带有代码的快速演示项目：

XAML：

```
<Window x:Class="WpfApplication3.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:WpfApplication3"
        Title="MainWindow" SizeToContent="WidthAndHeight">

    <StackPanel>
        <TextBox Width="200" />
        <TextBox Width="200" />
        <TextBox Width="200" />
    </StackPanel>
</Window> 
```

代码背后：

```
using System.Collections.Generic;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Input;

namespace WpfApplication3
{
    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            this.InitializeComponent();

            // Code needs window to be active to work, so just call it in Loaded event for demo
            this.Loaded += (s, e) =>
            {
                FocusManager.SetFocusedElement(this, this);
                UIElement element = FocusManager.GetFocusedElement(this) as UIElement;
                element.MoveFocus(new TraversalRequest(FocusNavigationDirection.First));
            };
        }
    }
} 
```

我知道这真的是迟到的回应，但这对你有帮助吗？

# c# - 如何从字符串中提取格式化部分

> ID：809631
> 
> 赞同：0
> 
> 时间：2009-04-30T23:50:21.290
> 
> 标签：c#, regex

如何仅从字符串中提取格式化部分。例如：如果我有一个字符串 =“警告：错误 {0} 已发生。{1, 9} 模块已完成 {2:0%}。” 我想将 {0}、{1,9} 和 {2:0%} 提取到一个字符串数组中。除了我用 Substring indexof '{' 和 '}' 交替循环字符串的方式之外，是否有正则表达式或其他可以做的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T23:56:09.530

"\{[^}]+\}" 的某些变体会不起作用吗？通过查找匹配项和从匹配开始到结束的子串来运行它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T15:39:42.910

以下代码与其他答案的不同之处在于它使用非贪婪匹配（“。*？”）：

```
 private static void Main(string[] args) {
        const string input = "Warning: the error {0} has occurred. {1, 9} module has {2:0%} done.";
        const string pattern = "{.*?}"; // NOTE: "?" is required here (non-greedy matching).
        var formattingParts = Regex.Matches(input, pattern).Cast<Match>().Where(item => item.Success).Select(item => item.Groups[0].Value);
        foreach (var part in formattingParts) {
            Console.WriteLine(part);
        }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-30T23:57:32.100

```
new Regex(@"\{[0-9:,% .]+\}"); 
```

您可能需要调整/调整它以考虑您在示例中未提供的任何其他格式选项。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T00:07:22.793

在 Java 中，[Matcher](http://java.sun.com/j2se/1.5.0/docs/api/java/util/regex/Matcher.html)类采用正则表达式并将返回所有匹配的子字符串。

例如：

```
String str = "Warning: the error {0} has occurred. {1, 9} module has {2:0%} done.";

Matcher matcher = pattern.matcher( "{.*}");
while (matcher.find()){
    String matched = matcher.group()
    \\do whatever you want with matched
} 
```

# html - 记事本++ HTML整洁

> ID：809636
> 
> 赞同：49
> 
> 时间：2009-04-30T23:51:44.033
> 
> 标签：html, notepad++, tidy, htmltidy

Notepad++ 的 HTML Tidy 坏了吗？除了 Tidy（第一个）之外的所有命令都不起作用。即使选择了所有文本，它们也不显示任何消息。我真的需要 Tidy 才能工作，还是只是 N++ 最新版本的限制，还是缺乏支持？

此外，每当我从颜色对话框中选择一种颜色时，自定义语法对话框就会冻结。在我单击粗体、斜体或下划线复选框之一之前，它一直没有响应。这是一个错误吗？我如何解决它？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2011-10-28T23:11:22.783

**Windows 7-10 x64，Notepad++ 5.9.5 解决方案：**

它与当前发行版中未包含的 libTidy.dll 有关。
但是，它在早期版本中可用。

解决方案是下载[5.9 zip](http://notepad-plus-plus.org/repository/5.x/5.9/npp.5.9.bin.zip)，然后
将以下文件夹之一复制：
**ansi\plugins\Config\tidy**或 **Unicode\plugins\Config\tidy**
到您当前的**Notepad++\plugins\Config**文件夹

此外，如果您安装到 c:\Program Files 或 c:\Program Files (x86) 目录，则需要调整 tidy 文件夹的权限以允许非管理员访问

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-05-18T17:56:22.053

除了第一个选项之外的所有菜单选项都重写了 HTMLTIDY.CFG 文件，该文件指定了 HTML Tidy 使用的格式规则。如果 HTMLTIDY.CFG 不存在，这些菜单选项可能不起作用。

创建一个文本文件并输入一个简单的指令，例如：

> `text-spaces: 2`

在***%ProgramFiles%*** **\Notepad++\plugins\Config\tidy**中将文件另存为**htmltidy.cfg**。重新启动记事本++，所有选项都应该工作。

 ** * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-08-07T17:34:21.923

我在 Windows 7 中遇到了这个问题......我的解决方案是确保在 HTMLTIDY.CFG 上正确设置了权限

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2010-05-26T08:29:26.413

实际上需要可写的是**文件夹**(%ProgramFiles%\Notepad++\plugins\Config\tidy)，而不仅仅是 TIDYCFG.INI。这也将允许 Notepad++ 编写 HTMLTIDY.ERR。

让“所有用户”（或您机器上的任何名称）完全控制该文件夹，一切都应该正常工作。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2011-05-03T18:50:52.087

我正在运行 Windows 7 和 Notepad++ 5.9。有同样的问题。解决：

1.  为所有用户授予对“C:\Program Files (x86)\Notepad++”文件夹的完全权限
2.  在“C:\Program Files (x86)\Notepad++\plugins”下创建一个名为“Config”的新文件夹
3.  下载此文件：http: [//jwaltonmedia.com/tools/tidy.zip](http://jwaltonmedia.com/tools/tidy.zip)。它是“整洁”文件夹的压缩版本
4.  将压缩文件夹解压缩到您在上面创建的“Config”文件夹中。它应该创建一个名为“tidy”的文件夹

重新启动记事本++，你应该设置。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-09-10T14:36:37.027

这是一个有用的默认 HTMLTIDY.CFG，它可以为您漂亮地打印 HTML：

```
// sample config file for HTML tidy
indent: auto
indent-spaces: 2
wrap: 72
markup: yes
output-xml: no
input-xml: no
show-warnings: yes
numeric-entities: yes
quote-marks: yes
quote-nbsp: yes
quote-ampersand: no
break-before-br: no
uppercase-tags: no
uppercase-attributes: no
char-encoding: latin1
new-inline-tags: cfif, cfelse, math, mroot,
  mrow, mi, mn, mo, msqrt, mfrac, msubsup, munderover,
  munder, mover, mmultiscripts, msup, msub, mtext,
  mprescripts, mtable, mtr, mtd, mth
new-blocklevel-tags: cfoutput, cfquery
new-empty-tags: cfelse 
```

取自：http: [//sourceforge.net/p/notepad-plus/discussion/482781/thread/c6afffe0](http://sourceforge.net/p/notepad-plus/discussion/482781/thread/c6afffe0)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-05-24T01:27:02.570

右键记事本++
以管理员身份运行

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-04-09T10:37:27.370

我在 v6.6.8 上，这个插件运行良好：

[https://code.google.com/p/npp-tidy2/downloads/list](https://code.google.com/p/npp-tidy2/downloads/list)

ZIP 包有一个 dll 文件和一个 doc 文件夹。

将 dll 复制到：`%ProgramFiles%\Notepad++\plugins\` 并将 doc 的内容提取到：`%ProgramFiles%\Notepad++\plugins\doc\`

复制后重新启动 N++。

用法：插件 > Tidy2 > ...

默认情况下，Tidy2 会生成其他 HTML 标签。`output-xml: no`您可以通过配置和`show-body-only: yes`从 Plugins > Tidy2 > Edit config...来防止这种情况发生。

更多内容请参见：[防止 tidy 添加 html 标签](https://stackoverflow.com/questions/1963298/prevent-tidy-from-adding-html-tags)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-01T02:43:43.213

我的猜测是你需要升级。我有 Notepad++ 5.3.1 (Unicode)。TextFX HTML Tidy 插件工作得很好，颜色选择器——它*曾经*给我和你描述的同样的问题——不再锁定 Styler 对话框。

# java - Libraries / tutorials for manipulating video in java

> ID：809646
> 
> 赞同：11
> 
> 时间：2009-04-30T23:55:19.797
> 
> 标签：java, video-processing

I need to do some simple video editing within a Java application, but the frameworks I've found ([JMF](http://java.sun.com/javase/technologies/desktop/media/jmf/2.1.1/download.html) and [FMJ](http://fmj-sf.net/index.php)) appear to be quite stale, and thus far I haven't found any evidence that either can actually edit video. The type of operations I need are: cropping, redacting sections, and extracting clips.

I've never worked with video in any real capacity before, so I may just be misunderstanding what FMJ/JMF do, but I am still concerned by the age of the most recent releases of those tools.

What do people use to do this sort of thing? What keywords should I be using to get more relevant results?

(The specific format of video is not particularly important to me -- anything common is just fine.)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-01T00:13:43.793

You may take a look on [Xuggler](http://www.xuggle.com/xuggler/index). Also some alternatives to JMF were covered in [Wikipedia](http://en.wikipedia.org/wiki/Java_Media_Framework#Alternatives).

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-01T00:15:17.267

[GStreamer](http://www.gstreamer.net/) has some Java bindings.

# java - Java vs Javascript 正则表达式问题

> ID：809647
> 
> 赞同：1
> 
> 时间：2009-04-30T23:55:51.090
> 
> 标签：java, regex

我的正则表达式有问题：`<a.*href=[\"'](.*?)[\"'].*>(.*?)</a>`. 正如您可能知道的那样，它应该从 HTML 字符串中获取所有链接并返回第 2 组中的链接文本和第 1 组中的链接目标。但我遇到了问题。如果我在 Javascript 中尝试它（使用[http://www.regextester.com/](http://www.regextester.com/)，所有标志都打开），它工作正常，但在 Java 中，如下所示：

```
Pattern myPattern = Pattern.compile("<a.*href=[\"'](.*?)[\"'].*>(.*?)</a>", Pattern.CASE_INSENSITIVE);
Matcher match = myPattern.matcher(htmlData);
while(match.find()) {
 String linkText = match.group(2);
 String linkTarget = match.group(1);
} 
```

我没有得到我期望的所有比赛。使用正则表达式测试器，我得到了更多，它的工作原理与预期的完全一样，但使用 Java 版本，每页只有 1 或 2 个链接。
对不起，如果这很明显，但我是正则表达式的新手。
谢谢，
艾萨克·沃勒

编辑：我认为我的正则表达式可能有问题。看，从这个 Apache indexof 页面：

```
<tr><td valign="top"><img src="/icons/sound2.gif" alt="[SND]"></td><td><a href="Bryan%20Adams%20-%20Here%20I%20Am.mp3">Bryan Adams - Here I Am.mp3</a></td><td align="right">27-Aug-2008 11:48  </td><td align="right">170K</td></tr>
<tr><td valign="top"><img src="/icons/sound2.gif" alt="[SND]"></td><td><a href="Cars%20-%20Drive.mp3">Cars - Drive.mp3</a></td><td align="right">26-Aug-2008 19:04  </td><td align="right">149K</td></tr>
<tr><td valign="top"><img src="/icons/sound2.gif" alt="[SND]"></td><td><a href="Cock%20Robin%20-%20When%20Your%20Heart%20Is%20Weak.mp3">Cock Robin - When Your Heart Is Weak.mp3</a></td><td align="right">26-Aug-2008 19:04  </td><td align="right">124K</td></tr>
<tr><td valign="top"><img src="/icons/sound2.gif" alt="[SND]"></td><td><a href="Colbie%20Caillat%20-%20Bubbly.mp3">Colbie Caillat - Bubbly.mp3</a></td><td align="right">27-Aug-2008 11:49  </td><td align="right">215K</td></tr>

<tr><td valign="top"><img src="/icons/sound2.gif" alt="[SND]"></td><td><a href="Colbie%20Caillat%20-%20The%20Little%20Things.mp3">Colbie Caillat - The Little Things.mp3</a></td><td align="right">27-Aug-2008 11:49  </td><td align="right">176K</td></tr>
<tr><td valign="top"><img src="/icons/sound2.gif" alt="[SND]"></td><td><a href="Coldplay%20-%20Violet%20Hill.mp3">Coldplay - Violet Hill.mp3</a></td><td align="right">27-Aug-2008 11:49  </td><td align="right">136K</td></tr>
<tr><td valign="top"><img src="/icons/sound2.gif" alt="[SND]"></td><td><a href="Corrs%20-%20Radio.mp3">Corrs - Radio.mp3</a></td><td align="right">26-Aug-2008 19:04  </td><td align="right">112K</td></tr>
<tr><td valign="top"><img src="/icons/sound2.gif" alt="[SND]"></td><td><a href="Corrs%20-%20What%20Can%20I%20Do.mp3">Corrs - What Can I Do.mp3</a></td><td align="right">26-Aug-2008 19:04  </td><td align="right">146K</td></tr>
<tr><td valign="top"><img src="/icons/sound2.gif" alt="[SND]"></td><td><a href="Counting%20Crows%20-%20Big%20Yellow%20Taxi.mp3">Counting Crows - Big Yellow Taxi.mp3</a></td><td align="right">26-Aug-2008 19:04  </td><td align="right">135K</td></tr>

<tr><td valign="top"><img src="/icons/sound2.gif" alt="[SND]"></td><td><a href="Curtis%20Stigers%20-%20I%20Wonder%20Why.mp3">Curtis Stigers - I Wonder Why.mp3</a></td><td align="right">26-Aug-2008 19:03  </td><td align="right">213K</td></tr>
<tr><td valign="top"><img src="/icons/sound2.gif" alt="[SND]"></td><td><a href="Cyndi%20Lauper%20-%20Time%20After%20Time.mp3">Cyndi Lauper - Time After Time.mp3</a></td><td align="right">26-Aug-2008 19:03  </td><td align="right">193K</td></tr>
<tr><td valign="top"><img src="/icons/sound2.gif" alt="[SND]"></td><td><a href="David%20Bowie%20-%20Absolute%20Beginners.mp3">David Bowie - Absolute Beginners.mp3</a></td><td align="right">26-Aug-2008 19:04  </td><td align="right">155K</td></tr>
<tr><td valign="top"><img src="/icons/sound2.gif" alt="[SND]"></td><td><a href="Depeche%20Mode%20-%20Enjoy%20The%20Silence.mp3">Depeche Mode - Enjoy The Silence.mp3</a></td><td align="right">26-Aug-2008 19:03  </td><td align="right">230K</td></tr>
<tr><td valign="top"><img src="/icons/sound2.gif" alt="[SND]"></td><td><a href="Dido%20-%20White%20Flag.mp3">Dido - White Flag.mp3</a></td><td align="right">27-Aug-2008 11:48  </td><td align="right">158K</td></tr> 
```

我应该得到：
1: Bryan%20Adams%20-%20Here%20I%20Am.mp3
2: Bryan Adams - Here I Am.mp3
等等。使用正则表达式测试器，我得到了我想要的所有结果。使用 Java，我一无所获。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-30T23:58:59.210

您必须转义反斜杠字符和引号：

```
Pattern myPattern = Pattern.compile("<a.*href=[\\\"'](.*?)[\\\"'].*>(.*?)</a>", Pattern.CASE_INSENSITIVE); 
```

但是，这可能不是您真正的问题。模式中并不真正需要反斜杠。该模式还有一些其他可能的问题。

您在 href 属性之前使用了贪婪匹配，这意味着它将从该行的第一个链接的开头匹配到该行的最后一个链接的 href 属性。`.*`通过将匹配从 " "更改为 " " 来使匹配不贪婪`.*?`。href 属性之后的匹配也是如此，它必须是非贪婪的，否则它将匹配到该行最后一个链接的末尾。

该`.`字符不匹配换行符，因此如果链接代码或链接中的文本中有换行符，则链接将不匹配。您可以使用`[\W\w]`而不是`.`匹配任何字符。

因此，删除反斜杠，使匹配不贪婪并允许换行符将使模式：

```
Pattern myPattern = Pattern.compile("<a[\\W\\w]*?href=[\"'](.*?)[\"'][\\W\\w]*?>([\\W\\w]*?)</a>", Pattern.CASE_INSENSITIVE); 
```

编辑：
我忘了转义`[\W\w]`字符串代码中的反斜杠。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T00:14:51.450

不是*所有*的句号/通配符匹配都需要不贪婪吗？

```
<a.*?href=[\"'](.*?)[\"'].*?>(.*?)</a> 
```

我不是 Java 开发人员，所以我不知道模式的转义规则。

# delphi - 你知道 Win32 Delphi 应用程序的 MVC 框架吗？

> ID：809649
> 
> 赞同：10
> 
> 时间：2009-04-30T23:56:21.620
> 
> 标签：delphi, model-view-controller

据我所知，没有。

你知道任何？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-01T07:49:59.750

你真的需要一个框架吗？MVC 只是一种模式。您可以查找它并直接实现它。但是，我建议您实现 MVP 而不是 MVC。MVP 是一种更现代的 MVC 变体，更适合于 Windows 等 View 进行用户输入和输出的环境。（与 MVC 中 View 仅输出，Controller 仅输入不同。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-01T00:13:33.590

看看这个[实现](http://translate.google.com/translate?u=http%3A%2F%2Foszhdl.be.schule.de%2Fgymnasium%2Ffaecher%2Finformatik%2Fdelphi%2Fmvc.htm&sl=de&tl=en)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-01T00:27:39.670

有点不同，但您可以在此处查看 MVP 实现：

[http://jazz-sdk.googlecode.com](http://jazz-sdk.googlecode.com)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-01T04:17:08.840

ti Object Persistence Framework 提供了一个 model-gui-mediator 框架。

MGM 类似于 MVC。[Graeme Geldenhuys 在http://opensoft.homeip.net/articles/](http://opensoft.homeip.net/articles/)上有一篇描述它的文章。

AFAIAA MGM 框架需要使用 tiOPF（这不是一件坏事，但它会使学习变得更加困难），但它仍应演示基本概念。

tiOPF 可在 tiOPF.com 上获得。如果您有兴趣，请从存储库中获取代码，因为它是最新的。存储库中也有一个 D2009 分支。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-06-10T14:32:17.050

我知道这是一篇旧文章，但这里有另一种选择：[http](http://www.torry.net/pages.php?id=53) ://www.torry.net/pages.php?id=53 查找：eMVC v.1.0

# build-process - 在 Nant 中评估属性平等

> ID：809650
> 
> 赞同：7
> 
> 时间：2009-04-30T23:57:26.420
> 
> 标签：build-process, nant

在我的 Nant 脚本中，我想将属性值与已知字符串进行比较。在阅读了[Nant Expressions](http://nant.sourceforge.net/release/0.85-rc1/help/fundamentals/expressions.html#op-string-equal)文档后，我相信我能够进行基本的“==”比较来评估为布尔值。

但是给定脚本块：

```
<if test="${target.env} == Dev">
  <echo message="***** You are using DEV"/>
</if> 
```

执行时我收到以下错误：

```
'Dev == Dev' is not a valid value for attribute 'test' of <if ... />.
    Cannot resolve 'Dev == Dev' to boolean value.
    String was not recognized as a valid Boolean. 
```

这似乎应该很简单（而且可能很简单）。如何比较 Nant 中的两个字符串或属性以评估为布尔值？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-13T15:44:57.967

如果您在花括号中包含整个表达式，它也可以工作：

```
<if test="${target.env =='Dev'}">
    ....
</if> 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-01T00:01:45.100

例如，请参见[此处](http://nant.sourceforge.net/release/latest/help/tasks/if.html)。例如

```
<if test="${target.env}=='Dev'">
    ....
</if> 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-10-20T11:21:27.727

如果你想比较两个变量 ${test.var1} 和 ${test.var2} 那么

```
<if test="${test.var1 == test.var2}">
....
</if> 
```

# collision-detection - Pygame - 不同侧面碰撞问题！

> ID：809655
> 
> 赞同：0
> 
> 时间：2009-04-30T23:58:46.480
> 
> 标签：collision-detection, pygame

我正在制作一个“Breakout”的 Pygame。
我正在使用碰撞，并且想要一种简单的方法来对一个矩形的不同边产生不同的反弹效果。
我目前对球与球棒的碰撞是这样的：
“点”=球；“蝙蝠”=蝙蝠；所以你们都明白。

```
if dot.rect.colliderect(bat.rect):<br>
 dot.dy *= -1 
```

我想要与每一侧相互作用的东西，因此可以在球击中球棒一侧时反转球的 self.dx 值，并且仅在击球顶部时反转 self.dy 值。

谢谢！！！:D

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-01T16:54:17.740

谢谢！根本没花多少时间。对于其他人，这是我用作指导的代码：

> if dot.rect.colliderect(bat.rect): if 570 < dot.rect.centery < 610 and (bat.rect.centerx - 75) < dot.rect.centerx < (bat.rect.centerx + 75): dot .dx *= -1 其他：dot.dy *= -1

效果很好。只有一个问题：对于 Python 碰撞，对象在对碰撞做出反应之前会稍微进入其他对象。因此，您不能将 if 语句的限制设置为精确测量值，因为如果它以这些精确测量值达到顶部，它将触发第一个 if 语句并彻底搞砸。但这非常适合简单。

再次感谢 McWafflestix！:D

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T00:04:56.573

您想要的是第二次检查（在 if 内），检查点的 Y 坐标是否与球棒的 Y 坐标相同（即，当球与球棒处于相同高度时，球击中球棒，这意味着它一定是从侧面击中的），然后反转 X 速度；否则，你已经击中了顶部的球棒，所以反转 Y 速度。

这并不完全正确，但这会让你继续前进。

# wpf - WPF WindowsFormsHost VS2008 Toolbox 已灰显所有 Windows Forms 控件

> ID：809664
> 
> 赞同：0
> 
> 时间：2009-05-01T00:02:42.960
> 
> 标签：wpf, visual-studio-2008, toolbox, windowsformshost

我正在尝试在 WPF 应用程序中使用 WindowsFormsHost，以便可以使用一些 Windows 窗体组件。

```
<Grid>
    <WindowsFormsHost>

    </WindowsFormsHost>
</Grid> 
```

这一切正常，没有错误，但是当我从 VS2008 的工具箱中拖动一个 Windows 窗体组件时，它们都变灰了。在某种程度上，这是有道理的，因为只有 WPF 组件可用。但是，如果 Windows Forms 组件全部变灰且不可用，如何将它们拖放到 WindowsFormsHost 上？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T00:10:46.093

我认为 WPF 设计器不支持 Windows 窗体组件。您需要在 XAML 或代码中指定这些。如何将 WinForms 按钮添加到 WPF 应用程序的简单示例。请注意，该按钮在设计图面上不可见。

```
<Window x:Class="DataTemplateBind.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:forms="clr-namespace:System.Windows.Forms;assembly=System.Windows.Forms"
    Title="Window1" Height="300" Width="300">

    <WindowsFormsHost Height="200" Name="windowsFormsHost1" Width="258" >
        <forms:Button Text="Waaa :("></forms:Button>
    </WindowsFormsHost>
</Window> 
```

`xmlns:forms`请注意默认情况下不存在的添加的命名空间。

# javascript - 我如何知道 AJAX 加载的内容何时完成图像加载？

> ID：809672
> 
> 赞同：1
> 
> 时间：2009-05-01T00:06:50.720
> 
> 标签：javascript, ajax, image, loading

我正在从 AJAX 请求中加载 HTML，以及其中的一些`img`标签。

我需要知道 AJAX 中加载的图像何时完全加载以调整容器的大小。我不知道结果中有多少图像，所以我不能简单地检查`.complete`值。

您知道解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T00:18:33.173

如果您使用的是 jQuery，该`$(window).load()`命令可以设置一个函数，以便在所有图像加载后调用，如下所示：

```
$(window).load(
    function() {
        // weave your magic here.
    }
); 
```

*如果您不使用 jQuery，当我想要它的一点*功能时，我会做我所做的：下载它并检查源代码以了解它是如何实现的。然后这样做:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T01:01:32.663

`XMLHTTPrequests`具有可用于确定加载何时完成的属性。如果您直接使用 JavaScript，则需要为`onreadystatechange`事件分配一个函数。每次状态更改时都会调用它。状态存储在`ReadyState`：

0.  外行
1.  正在加载
2.  已加载
3.  交互的
4.  完全的

在您的函数中，您检查状态是否为 4 并调用其他必需的函数。

jQuery 有一些事件可以告诉你什么时候发生了某些事情。[查看 AJAX 文档](http://docs.jquery.com/Ajax)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T01:21:46.280

好的，感谢 Pax，我找到了解决方案。

关于 ajax 请求的**成功**事件（使用 jQuery），我添加了以下代码：

```
 $('img', this).load(function() {
    resize_element(this);
}); 

```

谢谢你们俩！

# spam-prevention - 用 Java 或 Python 创建垃圾邮件检查器服务的工具

> ID：809674
> 
> 赞同：2
> 
> 时间：2009-05-01T00:07:40.810
> 
> 标签：spam-prevention

假设我想创建一个可重用的 REST Web 服务，它允许检查一段文本/博客评论是否是垃圾邮件，一劳永逸。（讨厌在我工作的每个网络应用程序中添加此功能）

您会推荐哪些工具、库、框架可以很好地集成到 Java 或 Python 中？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T00:11:33.050

你看过[RECAPTCHA](http://recaptcha.net/)吗？你想从头开始构建一些东西吗？或者您可以使用像这样的现有工具吗？

我想到的另一个是[UCLASSIFY](http://www.uclassify.com/)，它是一项免费的网络服务，您可以在其中轻松创建自己的文本分类器。

# jsp - JSP 中的母版页

> ID：809677
> 
> 赞同：5
> 
> 时间：2009-05-01T00:08:39.733
> 
> 标签：jsp, master-pages

JSP 中是否有类似 ASP Masterpages 的概念？

问候。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-01T00:17:55.547

在这里我要跳出一个肢体，说你要找的是[JSP 模板](http://java.sun.com/developer/technicalArticles/javaserverpages/jsp_templates/)

工作方式并不完全相同，但它实际上看起来比 MasterPages 更灵活（允许您定义模板的多个区域以从中提取不同的内容）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T12:45:07.950

在 Java 世界中，有多种解决方案。我的建议是使用您的框架建议的任何内容。例如 Struts 瓦片、JSF Facelets 等 您确实使用 Web 框架，不是吗？

*   [瓷砖](http://struts.apache.org/2.0.14/docs/tiles-plugin.html)
*   [小面](https://facelets.dev.java.net/)

# php - 将 ssl 证书与 PHP 一起使用时出错

> ID：809682
> 
> 赞同：9
> 
> 时间：2009-05-01T00:11:35.000
> 
> 标签：php, sockets, ssl

我是 php 新手，尝试加载证书时遇到此错误

```
jameys-macbookpro41:~ user$ php -f ~/Sites/providerService.php 
```

警告：stream_socket_client()：无法设置本地证书链文件“cert.pem”；检查您的 cafile/capath 设置是否在第 27 行的 /Users/jamey/Sites/providerService.php 中包含您的证书及其颁发者的详细信息

cert.pem 与 php 文件位于同一文件夹中。文件 cert.pem 是在 Apple 钥匙串工具中创建的

```
class pushNotifications {
...
     private $sslPem = 'cert.pem';
...
     function connectToAPNS(){
          $streamContext = stream_context_create();
          stream_context_set_option($streamContext, 'ssl', 
             'local_cert', $this->sslPem); 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-01T00:18:33.033

您收到一个错误，因为它试图在您运行脚本的目录中找到您的 cert.pem 文件，而不是脚本所在的目录。在您的示例中，它是您的用户目录“~”。

尝试将您的课程更改为此，或类似的东西：

```
class pushNotifications {
...
     private $sslPem = 'cert.pem';
...
     function connectToAPNS(){
          $streamContext = stream_context_create();
          stream_context_set_option($streamContext, 'ssl', 'local_cert', dirname(__FILE__) . '/' . $this->sslPem); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-09-26T23:34:51.397

我也遇到了这个问题，事实证明，由于某种原因，我的私钥与我拥有的 aps_developer_identity.cer 相关联的私钥不匹配......

我最终从我的“登录”钥匙串项目中清除了我*所有*的公钥和私钥，然后我重新开始了整个过程（生成了请求）......我在程序门户上提交了新的请求文件并生成了一个新证书，下载并通过双击安装它（developer_identity.cer）。然后，我重置配置文件以使用新的 Push SSL 证书，下载并通过双击 (aps_developer_identity.cer) 安装它们。最后，我重置了配置文件并下载了新的。我在 Xcode Organizer 中清除了旧的，并安装了新的。最后，我将我的“私有”密钥导出为 key.p12，将我的 aps_developer_identity.cer 导出为 apsdi.p12，并对它们运行以下命令：

```
openssl pkcs12 -clcerts -nokeys -out apsdi.pem -in apsdi.p12
openssl pkcs12 -nocerts -out key.pem -in key.p12 
```

如果您可以使用密码（推荐用于生产）：

```
cat apsdi.pem key.pem > cert.pem 
```

*如果您希望使用“空白”密码，您需要先使用您在将其转换为 pem 格式时指定的密码*来解密您的私钥：

```
openssl rsa -in key.pem -out key.unencrypted.pem 
```

然后将证书和未加密的密钥放入 apns.pem （或您选择的任何文件名）：

```
cat apsdi.pem key.unencrypted.pem > apns.pem 
```

将您的 aps_developer_identity 证书导出为 apsdi.pem 非常重要，*而不是*您的 developer_identity 证书。

*如果您可以在 Keychain Access 中扩展您的 developer_identity.cer 和 aps_developer_identity.cer 条目，并且在您这样做时会看到一个“私有”密钥，那么一切都应该正常工作。*

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-05-06T07:47:19.797

作为补充提示，对于遇到相同问题的任何人：从 Apple 的钥匙串访问导出私钥并转换为 .pem 时，请指定密码。

出于某种原因，似乎在其中一个导出中留下空白密码会删除私钥，因此最终的 .pem 不完整。

因此，请输入一个虚拟密码，即使您稍后使用 openssl 将其删除。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-02-22T01:54:09.307

未来的注意事项（因为这一切而头疼之后）： 1\. 如果您收到握手错误 - 您创建的 pem 文件可能是错误的。

一种。确保该文件与您尝试运行的 php 位于同一目录中。湾。在钥匙串访问实用程序中导出证书 p12 文件及其下的密钥。这两个文件的大小相同，但它们不同。C。在 macintosh 终端中执行上述“openssl”命令。

2.  目前，我所能做的就是将 php 作为 sudo 运行，因为 ck.pem 的 chmod 400。有些东西必须给...

顺便说一句，当系统正常运行时，“无法启用加密”消息将消失。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-19T09:40:27.273

只需将所有者更改为 www-data 即可：)

> sudo chown www-data.www-data ck.pem

apache www-data 的默认用户

# web-services - XmlInclude 或 SoapInclude

> ID：809683
> 
> 赞同：3
> 
> 时间：2009-05-01T00:12:00.257
> 
> 标签：web-services

我正在开发一个 web 服务，它返回我在 web 服务中定义的类数组。当我测试它时，我得到：“System.InvalidOperationException：类型 WebSite+HostHeader 不是预期的。使用 XmlInclude 或 SoapInclude 属性来指定静态未知的类型。”

以下是部分代码：

```
[WebService(Namespace = "http://WebSiteInfo.Podiumcrm.com/")]
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
public class WebSite : System.Web.Services.WebService
{
    public class WebSiteEntry
    {
        public string SiteName = "";
        public string Comment = "";
        public string IISPath = "";
        public int SiteID = 0;
        public ArrayList HostHeaders;

        public WebSiteEntry()
        {
        }
    }
    public class HostHeader
    {
        public string IPAddress = "";
        public int Port = 0;
        public string URL = "";

        public HostHeader()
        {
        }
    }

    [WebMethod(EnableSession = true)]
    [TraceExtension(Filename = @"C:\DotNetLogs\WebSiteServices.log")]
    public WebSiteEntry[] WebSites()
    {...}
} 
```

当我尝试：

```
[WebService(Namespace = "http://WebSiteInfo.Podiumcrm.com/")]
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
[XmlInclude(typeof(WebSiteEntry))]
[XmlInclude(typeof(WebSiteProperty))]
[XmlInclude(typeof(HostHeader))]

public class WebSite : System.Web.Services.WebService
{...} 
```

我得到：“找不到类型或命名空间名称 XmlInclude（您是否缺少 using 指令或程序集引用？）”

指点能给我编译和执行的咒语的人！

谢谢...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-01T00:28:44.100

从您收到的错误中：

*找不到类型或命名空间名称“XmlInclude”（您是否缺少 using 指令或程序集引用？）*

您似乎缺少[System.Xml.Serialization Namespace](http://msdn.microsoft.com/en-us/library/system.xml.serialization.aspx)。您可以完全限定 XmlInclude 类型，如下所示：

```
System.Xml.Serialization.XmlInclude(typeof(WebSiteProperty)) 
```

或通过 using 指令添加命名空间：

```
using System.Xml.Serialization 
```

# assembly - 如何对给定的 32 位地址进行远调用（x86）？

> ID：809696
> 
> 赞同：5
> 
> 时间：2009-05-01T00:18:14.313
> 
> 标签：assembly, x86

好的，我需要对 PCI BIOS 服务目录（32 位模式）执行 CALL FAR 以验证 PCI BIOS 是否存在。

注意：我正在为我们正在开发的大学的简单操作系统开发一个简单的磁盘驱动程序。我知道这是非常具体的，但我将从内核代码中完成所有这些工作。

假设我已经找到了相关地址。对给定地址执行远调用的正确汇编语言是什么？有人可以发布一些对给定 32 位地址进行远调用的汇编代码吗？到目前为止，我所看到的示例的语法一直令人困惑。

谢谢！

编辑：在我的具体情况下，我已经找到了 PCI BIOS 服务目录，它给了我物理地址（32 位）。给定这个 32 位地址，我需要什么类型的远调用？例如，我在英特尔手册中阅读了远调用可以更改任务以及不能更改的内容。我怎么知道我必须做什么才能调用这个 PCI BIOS 服务目录物理地址？

更新：

这是我发现的一些让我感到困惑的代码（内联）：

```
 **asm**("lcall (%%edi)"
        : "=a" (return_code),
          "=b" (address),
          "=c" (length),
          "=d" (entry)
        : "0" (service),
          "1" (0),
          "D" (&bios32_indirect));我在这个源文件中发现：[http ://www.pell.portland.or.us/~orc/Code/Archive/linux-1.2.13/arch/i386/kernel/bios32.c](http://www.pell.portland.or.us/~orc/Code/Archive/linux-1.2.13/arch/i386/kernel/bios32.c)

我想我想要做的是在实际汇编中相当于上面的内联。

            回答 #1

赞同：2

时间：2012-09-16T05:33:56.293

从手册：

```
to make a asm call use the below format

asm(  command1 %0
      command2
      :output registers with there mapping to variable
      :input registers with mapping.
   );

example
    asm ("movl %1, %%ebx;"
         "movl %%ebx, %0;"
         : "=r" ( val )
         : "r" ( no )
         : "%ebx"         // clobbered register
        );

    here %1 is input variable %0 is output. 
```

要制作`lcall`您需要的段和实际的 32 位地址：

```
bios32_indirect.address = directoy_address;
  uint32 kernelcodesegment = 0;
  asm ("movl %%cs, %0;"
       : "=r" (kernelcodesegment)
       :);
bios32_indirect.segment = kernelcodesegment; 
```

            回答 #2

赞同：1

时间：2009-05-01T01:08:39.073

如果内存是平坦的，即 CS 以 0 为基数并覆盖整个 32 位地址空间

```
call <address> 
```

其中 address 是 32 位目标地址。

编辑：啊，我看到你有一个实际地址。我假设这是针对在 Linux 上运行的设备驱动程序。我对 linux 内核没有任何经验，但我认为这个物理地址没有 1:1 映射到虚拟地址。您需要将其映射到虚拟地址（抱歉，不知道在 Linux 中如何），然后调用该虚拟地址。

但这提出了您需要什么 PCI BIOS 功能的问题，直接进入操作系统之外的 BIOS 通常是错误的方法。

            回答 #3

赞同：0

时间：2015-08-02T07:10:12.577

如果您提到您正在使用的操作系统，那肯定会有所帮助。假设它是 Windows 32Bit，那么假设您确定知道物理地址，您仍然需要获取与其相关的 PTE。您不能只调用该特定地址，因为您处于保护模式并且您拥有的地址是虚拟地址。您可以将物理映射到虚拟，但这很复杂。

如果您想查看是否可以查看该地址的内容，请使用 WinDBG 并执行以下操作：

```
!dd <address> 
```

**这将在您指定的物理**地址处显示 DWORD 。当您知道要做什么时，物理到虚拟的转换很简单（查看 CR3 对您没有帮助:)

现在，如果您使用的是不同的操作系统，那就另当别论了，因为 PTE 的映射方式不同。

此外，如前所述，您不能只调用 bios，因为它实际上是 16 位而不是 32 位。在保护模式下（在 i386 和可能更高版本中）有一种特定的技术可以使用 vx86 或类似的东西，但我忘记了确切的术语。可行但成本很高，因为它涉及任务切换和其他杂项。

如果您需要开发磁盘驱动程序，那么您组中的硬件人员应该能够为您提供可用的端口，以便您可以对设备进行 IO 调用，而无需访问 BIOS。

        sql - 选择平均值和不同值 SQL

ID：809705

赞同：0

时间：2009-05-01T00:22:19.340

标签：sql, select, distinct, average

我有一张带有纬度、经度和美国州字段的位置表。我想选择每个州的平均纬度和经度。

我正在尝试以下代码，但在 distinct 上出现语法错误。

```
select avg(lat), avg(lon), distinct(state) from tRealtyTrac order by state group by state 
```

            回答 #1

赞同：6

时间：2009-05-01T00:27:39.890

你不需要独特的。如果您按州分组，无论如何您都会得到一个结果

很确定您也需要在 order by 子句之前使用 group by 子句。

```
select state, avg(lat), avg(lon) 
from tRealtyTrac 
group by state 
order by state 
```

        .net - 如何使用 Visual Basic 在 XDocument 中插入一些 XML？

ID：809706

赞同：3

时间：2009-05-01T00:22:46.097

标签：.net, asp.net-mvc, xml, vb.net, sitemap

我正在尝试在 ASP.NET MVC 项目中创建站点地图。

我的节点控制器中的这段代码......

```
Function Sitemap() As ContentResult
    Dim db As New EfrDotOrgEntities
    Dim Nodes = db.Node.ToList
    Dim RequestUrl As Uri = Url.RequestContext.HttpContext.Request.Url
    Dim AbsoluteRoot As String = String.Format("{0}://{1}", RequestUrl.Scheme, RequestUrl.Authority)

    Dim map As XDocument = <?xml version="1.0" encoding="UTF-8"?>
                           <urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">
                           </urlset>
    For Each n As Node In Nodes
        map.Add(<url>
                    <loc><%= AbsoluteRoot + Url.RouteUrl("IdOnly", New With {.id = n.Id}) %></loc>
                </url>)
    Next
    Return Content(map.ToString, "text/xml", Encoding.UTF8)
End Function 
```

（这是一张图片，因为 Stack Overflow 无法很好地为 VB 代码着色）

![Visual Basic 内联 XML](https://i.stack.imgur.com/yQ3Oy.gif)

...产生此错误：

此操作将创建结构不正确的文档。

它不知道*在哪里*添加该内容。

我如何告诉它把那一点 XML 插入到`<urlset>`?

            回答 #1

赞同：5

时间：2009-05-01T00:39:43.263

您需要将其添加到文档中的顶级元素（根）：

```
map.Root.Add(...) 
```

            回答 #2

赞同：5

时间：2009-05-01T00:57:39.397

为什么不用另一个 xml 文字孔完全填满它呢？

```
Dim map As XDocument = <?xml version="1.0" encoding="UTF-8"?>
                       <urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">
                           <%= From n In Nodes.Cast(Of Node)() _
                               Select <url>
                                          <loc><%= AbsoluteRoot + Url.RouteUrl("IdOnly", New With {.id = n.Id}) %></loc>
                                      </url> %>
                       </urlset> 
```

        actionscript-3 - 为什么我不能访问没有命名空间的 xml 节点？

ID：809722

赞同：1

时间：2009-05-01T00:27:46.707

标签：actionscript-3, youtube, gdata-api, e4x, atom-feed

几个小时以来，我一直在我的办公桌上敲打我的头，试图弄清楚为什么我无法访问 entry.author.name 内容？我已经尝试了所有可能的方法来访问它，但失败了。  

但是当我用 xml.children 遍历所有节点时，我看到了作者节点。  

我看到作者节点是 atom 命名空间的一部分，但它没有像其他命名空间那样的命名空间。

```
包裹 {
    导入 flash.display.Sprite；

`public class Gdata extends Sprite
{

    private var xml:XML = <entry xmlns="http://www.w3.org/2005/Atom" xmlns:media="http://search.yahoo.com/mrss/" 
    xmlns:gd="http://schemas.google.com/g/2005" xmlns:yt="http://gdata.youtube.com/schemas/2007">           
                http://www.w3.org/2005/Atom,http://search.yahoo.com/mrss/,http://schemas.google.com/g/2005,                                              http://gdata.youtube.com/schemas/2007
              <id>
                http://gdata.youtube.com/feeds/api/videos/bwbZJw-C4Jk
              </id>
              <published>
                2009-04-17T19:11:48.000Z
              </published>
              <updated>
                2009-04-29T10:19:50.000Z
              </updated>
              <category scheme="http://gdata.youtube.com/schemas/2007/categories.cat" term="News" label="News & Politics"/>
              <category scheme="http://gdata.youtube.com/schemas/2007/keywords.cat" term="Garofalo"/>
              <category scheme="http://gdata.youtube.com/schemas/2007/keywords.cat" term="Olbermann"/>
              <category scheme="http://gdata.youtube.com/schemas/2007/keywords.cat" term="commentary"/>
              <category scheme="http://gdata.youtube.com/schemas/2007/keywords.cat" term="Janeane"/>
              <category scheme="http://gdata.youtube.com/schemas/2007/keywords.cat" term="news"/>
              <category scheme="http://schemas.google.com/g/2005#kind" term="http://gdata.youtube.com/schemas/2007#video"/>
              <category scheme="http://gdata.youtube.com/schemas/2007/keywords.cat" term="Keith"/>
              <category scheme="http://gdata.youtube.com/schemas/2007/keywords.cat" term="analysis"/>
              <category scheme="http://gdata.youtube.com/schemas/2007/keywords.cat" term="Party"/>
              <category scheme="http://gdata.youtube.com/schemas/2007/keywords.cat" term="Tea"/>
              <title type="text">
                Janeane Garofalo Calls Tea Party Protesters Racists
              </title>
              <content type="text">
                Janeane Garofalo: http://tinyurl.com/cr6rt8

            EPA: http://tinyurl.com/clpyqo

            Veterans: http://tinyurl.com/ckbhb6

            DHS: http://tinyurl.com/cctf54

            DHS2: http://tinyurl.com/dahaxr

            John Ziegler: http://tinyurl.com/d7qbo4

            Teabagging: http://tinyurl.com/ddskjo
              </content>
              <link rel="alternate" type="text/html" href="http://www.youtube.com/watch?v=bwbZJw-C4Jk"/>
              <link rel="http://gdata.youtube.com/schemas/2007#video.responses" type="application/atom+xml" href="http://gdata.youtube.com/feeds/api/videos/bwbZJw-C4Jk/responses"/>
              <link rel="http://gdata.youtube.com/schemas/2007#video.related" type="application/atom+xml" href="http://gdata.youtube.com/feeds/api/videos/bwbZJw-C4Jk/related"/>
              <link rel="http://gdata.youtube.com/schemas/2007#mobile" type="text/html" href="http://m.youtube.com/details?v=bwbZJw-C4Jk"/>
              <link rel="self" type="application/atom+xml" href="http://gdata.youtube.com/feeds/api/videos/bwbZJw-C4Jk"/>
              <author>
                <name>
                  HowTheWorldWorks
                </name>
                <uri>
                  http://gdata.youtube.com/feeds/api/users/howtheworldworks
                </uri>
              </author>
              <gd:comments>
                <gd:feedLink href="http://gdata.youtube.com/feeds/api/videos/bwbZJw-C4Jk/comments" countHint="2249"/>
              </gd:comments>
              <media:group>
                <media:category label="News & Politics" scheme="http://gdata.youtube.com/schemas/2007/categories.cat">
                  News
                </media:category>
                <media:content url="http://www.youtube.com/v/bwbZJw-C4Jk&f=videos&app=youtube_gdata" type="application/x-shockwave-flash" medium="video" isDefault="true" expression="full" duration="236" yt:format="5"/>
                <media:content url="rtsp://rtsp2.youtube.com/CiILENy73wIaGQmZ4IIPJ9kGbxMYDSANFEgGUgZ2aWRlb3MM/0/0/0/video.3gp" type="video/3gpp" medium="video" expression="full" duration="236" yt:format="1"/>
                <media:content url="rtsp://rtsp2.youtube.com/CiILENy73wIaGQmZ4IIPJ9kGbxMYESARFEgGUgZ2aWRlb3MM/0/0/0/video.3gp" type="video/3gpp" medium="video" expression="full" duration="236" yt:format="6"/>
                <media:description type="plain">
                  Janeane Garofalo: http://tinyurl.com/cr6rt8
                </media:description>
                <media:keywords>
                  Janeane, Garofalo, Keith, Olbermann, Tea, Party, commentary, analysis, news
                </media:keywords>
                <media:player url="http://www.youtube.com/watch?v=bwbZJw-C4Jk"/>
                <media:thumbnail url="http://i.ytimg.com/vi/bwbZJw-C4Jk/default.jpg" height="90" width="120" time="00:01:58"/>
                <media:thumbnail url="http://i.ytimg.com/vi/bwbZJw-C4Jk/1.jpg" height="90" width="120" time="00:00:59"/>
                <media:thumbnail url="http://i.ytimg.com/vi/bwbZJw-C4Jk/3.jpg" height="90" width="120" time="00:02:57"/>
                <media:thumbnail url="http://i.ytimg.com/vi/bwbZJw-C4Jk/0.jpg" height="240" width="320" time="00:01:58"/>
                <media:title type="plain">
                  Janeane Garofalo Calls Tea Party Protesters Racists
                </media:title>
                <yt:duration seconds="236"/>
              </media:group>
              <gd:rating average="3.9231105" max="5" min="1" numRaters="2289" rel="http://schemas.google.com/g/2005#overall"/>
              <yt:statistics favoriteCount="304" viewCount="33463"/>
            </entry>;

    namespace atom = "http://www.w3.org/2005/Atom"
    namespace media ="http://search.yahoo.com/mrss/";
    namespace gd = "http://schemas.google.com/g/2005";
    namespace yt = "http://gdata.youtube.com/schemas/2007";

    public function Gdata()
    {
        var atom:Namespace = new Namespace();
        trace("0",xml.children()[22]);          
        trace("1",xml.inScopeNamespaces());
        trace("2",xml..media::group);           
        trace("3",xml..yt::statistics.@favoriteCount);          
        trace("4",xml..yt::duration.@seconds);          
        trace("5",xml..author ); // why?????????
        trace("6",xml.author ); // why?????????

        var x:int = 0;
        for each (var i in xml.children())
        {
            if(i.localName() == 'author')
            {
                trace("author", i);
            }
        }           

    }
}` 

}

            回答 #1

赞同：4

时间：2009-05-01T01:02:51.570

试试这个 ...

```
public function Gdata()
{
    var atom:Namespace = new Namespace("http://www.w3.org/2005/Atom");
    var media:Namespace = new Namespace("http://search.yahoo.com/mrss/");
    var gd:Namespace = new Namespace("http://schemas.google.com/g/2005");
    var yt:Namespace = new Namespace("http://gdata.youtube.com/schemas/2007");

    default xml namespace = atom; // IMPORTANT

    trace("0",xml.children()[22]);                  
    trace("1",xml.inScopeNamespaces());
    trace("2",xml..media::group);                   
    trace("3",xml..yt::statistics.@favoriteCount);                  
    trace("4",xml..yt::duration.@seconds);                  
    trace("5",xml..author ); // why?????????
    trace("6",xml.author ); // why?????????

    var x:int = 0;
    for each (var i in xml.children())
    {
        if(i.localName() == 'author')
        {
            trace("author", i);
        }
    }
} 
```

            回答 #2

赞同：1

时间：2011-08-26T11:59:42.227

你也可以完全去掉命名空间......这是我找到的最佳解决方案（它只是将命名空间细节转换为属性）：

```
public function removeNS(data:XML):XML {
    var myXML;
    try {
        var modified:String = data.toString().replace("xmlns=", "xmlns:default=");
        var pattern:RegExp = new RegExp(":(?!/)", "gi");
        var transmuted:String = modified.replace(pattern, "_");
        myXML = new XML(transmuted);
    } catch (e:Error) {
        myXML = data;
    }
    return myXML;
} 
```

            回答 #3

赞同：0

时间：2009-05-01T00:34:22.027

在您的 mxml 文件中的某处，您需要以下代码片段（在您使用 XML 文档之前）

```
<mx:Script>
    <![CDATA[

        private namespace atom = "http://www.w3.org/2005/Atom";
        use namespace atom; // This is the important line right here!!!!

    ]]>
</mx:Script> 
```

        fluent-nhibernate - NHibernate 映射空对象/特例模式

ID：809724

赞同：5

时间：2009-05-01T00:28:13.460

标签：fluent-nhibernate, nhibernate-mapping

我想要一个“UnassignedDepartment”对象，而不是让员工有一个空部门：

```
public class UnassignedDepartment : Department
{
    public UnassignedDepartment() : base("not yet assigned") {
        Id = -99; <-- just some Id that can be held constant, not be generated..
    }
} 
```

这可以通过 Department 类中的静态便利字段访问：

```
public class Department : Entity
{
    public static readonly Department UNASSIGNED = new UnassignedDepartment();

    ....    
} 
```

我使用 S#rpArch 的框架作为基础实体，混合了 FNH 自动映射、覆盖和约定。从持久性的角度来看，将其与具有“特殊” ID 的其他部门保持一致似乎是合乎逻辑的，但我不知道如何正确地做到这一点。请赐教！

谢谢，贝里尔

            回答 #1

赞同：2

时间：2009-05-01T02:16:23.497

我不明白你想要完成什么，但也许这会有所帮助。将 Department 映射为 Employee 中的私有字段，如果它为 null，则返回 UnassignedDepartment。

```
private Department _department; // map this in FNH

public Department Department
{
    get { return _department ?? _department.UNASSIGNED; }
} 
```

        vba - 将多个单元格乘以另一个数字的最快方法是什么？

ID：809725

赞同：15

时间：2009-05-01T00:28:19.623

标签：vba, excel, excel-formula

如果我有一个单元格块，例如 A1:D5，使用 Microsoft Excel 将每个单元格乘以另一个数字 1.1 的最快方法是什么？

            回答 #1

赞同：34

时间：2009-05-01T03:21:15.497

1.  在单元格中输入乘数
2.  将该单元格复制到剪贴板
3.  选择要乘以乘数的范围
4.  （Excel 2003 或更早版本）选择**编辑**| **特殊粘贴**| **乘**

    （Excel 2007 或更高版本）单击粘贴向下箭头 | **特殊粘贴**| **乘**

            回答 #2

赞同：10

时间：2009-05-01T00:35:12.757

您是在问如何在 excel 中执行此操作，还是在 VBA 应用程序中执行此操作？如果您只想在 excel 中执行此操作，[这是一种方法。](https://support.office.com/en-us/article/Multiply-numbers-9d152e08-002c-47a1-a88a-264483e68fa1?ui=en-US&rs=en-US&ad=US)

            回答 #3

赞同：6

时间：2013-01-07T07:19:25.880

要将一列数字与一个常数（相同的数字）相乘，我已经这样做了。

让`C2`成为`C12`需要乘以单个数字（常数）的不同数字。然后键入从`C2`到 C12 的数字。

在`D2`类型 1（统一）和`E2 type formula =PRODUCT(C2:C12,CONSTANT)`. 选择正确的图标来应用。现在拖`E2`过`E12`。你已经做到了。

```
C       D       E=PRODUCT(C2:C12,20)

25  1   500
30      600
35      700
40      800
45      900
50      1000
55      1100
60      1200
65      1300
70      1400
75      1500 
```

            回答 #4

赞同：4

时间：2009-05-01T03:47:41.343

将要乘以的数字放在不在您范围内的单元格中。选择单元格并将其“复制”到剪贴板。接下来，选择 Range A1:D5，然后从菜单中选择 Edit|Paste Special。将出现一个对话框。在“操作”区域中，选择“乘法”并单击“确定”。

            回答 #5

赞同：3

时间：2015-12-16T09:53:12.830

从答案单元格的公式栏中选择`Product`。

选择要相乘的单元格。

            回答 #6

赞同：1

时间：2009-05-01T00:33:08.550

如果它不需要是宏，则只需放入`=A1*1.1`（例如）D7，然后将公式填充手柄拖过，然后向下。

            回答 #7

赞同：0

时间：2014-11-24T04:01:01.953

正如上面的答案之一所说：“然后拖动公式填充手柄。” MS的解释中没有提到这个KEY特性，这里的其他人也没有提到。我花了一个多小时试图遵循各种指示，但无济于事。这是因为您必须在单元格底部附近单击并按住恰到好处（至少在我的计算机上这并不容易），以便出现一种“句柄”。一旦你足够幸运地得到它，然后小心地将光标向下滑动 [“drag”] 到你想要乘以常数的单元格的最下方。当您向下移动时，产品应显示在每个单元格中。只需向下拖动只会在第一个单元格中为您提供答案和大量空白区域。

        asp.net-membership - Application_AuthenticationRequest 中设置的 Thread.CurrentPrincipal 稍后在应用程序中未设置

ID：809727

赞同：6

时间：2009-05-01T00:28:33.477

标签：asp.net-membership

在 Application_AuthenticationRequest 的 global.asax 文件中，我将 Thread.CurrentPrincipal 设置为自定义主体。我还将 HttpContext.Current.User 设置为相同的主体。

但是，稍后在应用程序中，当我需要将 Thread.CurrentPrincipal 转换为我们的自定义类型时，我收到运行时错误消息：无法将“System.Web.Security.RolePrincipal”类型的对象转换为“OurCustomPrincipal”类型。

Thread.CurrentPrincipal 是如何重置为 RolePrincipal 的，以及如何将其保留在我们在 global.asax 中设置的 CustomPrincipal 中

提前致谢

            回答 #1

赞同：6

时间：2009-09-27T14:04:36.853

您现在肯定已经解决了您的问题，但以防万一，如果您使用的是 ASP.NET 中的 RoleProvider，RoleManagerModule 会覆盖由 FormsAuthenticationModule 创建的 GenericPrincipal 对象，并在 PostAuthenticateRequest 期间将其替换为 RolePrincipal 对象： 
 [http://www .asp.net/Learn/Security/tutorial-11-vb.aspx](http://www.asp.net/Learn/Security/tutorial-11-vb.aspx)

            回答 #2

赞同：3

时间：2011-04-06T01:06:39.733

总而言之，一个快速的解决方法是在 Application_OnPostAuthenticateRequest 处理程序上执行您的主体和身份替换。

            回答 #3

赞同：0

时间：2009-06-25T08:08:55.300

请确认您已经为 IIDentity & Iprincipal 接口实现了一个类，然后您正在使用类似于以下代码的代码来分配 currentprincipal。

```
 Dim userIdentity As CustomIdentity
    userIdentity = New CustomIdentity(username, True,"forms", sessionId)

    Dim principal As New CustomPrincipal(userIdentity, arrRoles)
    HttpContext.Current.User = principal
    System.Threading.Thread.CurrentPrincipal = principal 
```

        php - 托管 PHP

ID：809735

赞同：3

时间：2009-05-01T00:31:40.893

标签：php

对于进行开发，运行 PHP 的操作系统是否重要？换句话说，在 Windows 上开发 PHP 应用程序并在 Unix 上部署（反之亦然）是否可以？

换句话说，PHP 应用程序在 Windows 和 Unix 上运行相同吗？

            回答 #1

赞同：5

时间：2009-05-01T00:38:47.290

差不多，但不完全。您需要注意几件事。

**1)**文件名：Windows 是不区分大小写的操作系统。如果您创建文件 Foo.php，则可以使用`include('Foo.php')` *OR* `include('foo.php')`将其包含在内。当您将项目迁移到 Linux/Unix 时，如果您没有正确的案例，这将中断。

**2)**存在一些特定于语言的平台差异，通常是在涉及依赖集成操作系统功能的东西时。这些很少出现，但您可能偶尔会遇到它们。例如，[checkdnsrr()](http://www.php.net/manual/en/function.checkdnsrr.php)函数直到版本 5.3.0 才存在于 Windows PHP 中。

我也有一个，但我想我需要一杯咖啡，我的大脑刚刚停止。

编辑：哦，是的，我记得：

**3)**安装。与 Windows 相比，您为 Linux/Unix 获得的 PHP 包可以非常广泛地包含在默认安装中。您需要确保在相反平台的开发盒上测试您的应用程序，以确保您已编译/添加了所有必需的库，否则您会从看起来正常的应用程序中得到一些不错的致命错误。

            回答 #2

赞同：2

时间：2009-05-01T00:36:50.663

核心 PHP 语言的运行方式相同，但对于任何一种语言，如果您开发一个平台并部署在另一个平台上，您都会遇到操作系统问题。在路径（文件位置）、Web 服务器配置（在 $_SERVER 超全局中可用的键）、使用操作系统功能时可用的扩展（某些 PHP 扩展是特定于平台的）方面存在差异。

然而，这些问题是相当具体的。它们可能会令人沮丧，但您将解决每一个问题，然后继续前进。在实践中，大多数 Web 开发人员最终使用的开发机器与其生产服务器的配置存在差异，学习解决这些问题是有帮助的，并且会产生更便携的应用程序。

            回答 #3

赞同：1

时间：2009-05-01T00:33:43.947

Windows 和 Linux 上的 PHP 之间存在一些差异，例如执行进程的能力。

在大多数情况下，它们是相同的，但某些功能在 Windows 上不起作用或行为略有不同。您需要在每种情况下参考 PHP 手册页以查看内容。Linux 确实是 PHP 的原生操作系统。话虽如此，差异很小。

            回答 #4

赞同：0

时间：2009-05-01T00:36:15.937

您应该注意平台特定的功能，例如 fork（仅限 Unix）。

[http://us3.php.net/pcntl_fork](http://us3.php.net/pcntl_fork)

            回答 #5

赞同：0

时间：2009-05-01T01:13:57.393

另一件事，你没有在你的帖子中指定它，但我要在这里寻找原始的 WAMP 堆栈......

请注意，在 MySQL 中，标识符在 Windows 上不区分大小写，但在 Linux 上区分大小写。

            回答 #6

赞同：0

时间：2009-05-01T01:26:11.123

如上所述，有些功能在 Windows 中不存在，但在 Unix 中存在。

刚开始时我会警惕的一件事是权限：Windows 通常会让 PHP 脚本在任何地方读/写任何东西，而 Unix 安装不会（特别是因为实际的 Web 服务器可能以完全不同的“用户”身份运行比拥有脚本的用户）。

            回答 #7

赞同：0

时间：2009-05-01T08:13:22.440

linux和windows之间的文件IO有很多区别（除了区分大小写）。最常见的是大多数 Windows (DOS) 文件以 \r\n 结尾，unix 以 \n 结尾，macs 以 \r 结尾。虽然很简单，但可以编写代码。

            回答 #8

赞同：-1

时间：2009-05-01T00:33:52.980

我一直在 windows / xampplite 上运行 Drupal（具有各种附加模块的几个版本）并部署到 unix 盒子.. 从未发现任何差异。

我还以同样的方式运行了 SugarCRM、Joomla、Pligg、Zend Framework、CMS Simple、WordPress、Mantis、PhPBB 和其他我现在不记得的东西。

        .net - 在 Windows 上为 TDD 学习 Python

ID：809737

赞同：1

时间：2009-05-01T00:32:03.017

标签：.net, tdd, ironpython

我有兴趣学习 python 以使用更敏捷的语言在我的 .NET 项目中编写测试。

IronPython 对于这些目的是否足够成熟？我满足于用 C# 编写测试，但发现像 ruby​​ 和 python 这样的动态语言非常有吸引力。学习的时候放弃 IronPython，坚持使用官方版本 3 分发会更好吗？

我很想听听任何成功为 Ironruby 或 Ironpython 中的 .net 项目编写测试的人的来信。

编辑：修改了我的问题以解决在 .NET 中为 TDD 使用动态语言的真正问题——版本问题并不那么重要。为措辞不当的问题道歉。

            回答 #1

赞同：2

时间：2009-05-01T00:47:50.357

正如其他人所说，网上的大部分资源仍然适用于 Python 2.x。我将从[官方教程](http://docs.python.org/tutorial/)开始。如果您喜欢视频，[showmedo](http://showmedo.com/)有大量教程。Python 3.x 还没有真正准备好生产。

IronPython 非常成熟，[这位博主](http://www.voidspace.org.uk/voidspace/index.shtml)在 Resolver Systems 工作，这家公司使用 IronPython 编写了[整个电子表格](http://www.resolversystems.com/products/)程序。

他们非常广泛地使用测试驱动开发，所以我认为这是使用 IronPython 进行 TDD 的成功案例，尽管被测系统不是用 C# 编写的。

            回答 #2

赞同：0

时间：2009-05-01T00:37:19.897

然而，我发现，据我所知，IronPython 似乎基于 Python v2，而网络上的许多学习资源都集中在 Python v3 上。

我不知道您一直在查看哪些资源，但其中大多数是针对 v2 的。

            回答 #3

赞同：0

时间：2009-05-01T00:39:41.280

您会发现 Python 2 和 Python 3 之间的最大区别是`print`语句。

蟒蛇2：

```
print "Hello world" 
```

蟒蛇 3：

```
print("Hello world") 
```

我不确定您在哪里可以找到所有这些 Python 3 学习资源，但仍然有数以万计的 Python 2 学习资源。

            回答 #4

赞同：0

时间：2009-05-01T00:41:18.157

**“对于这些目的，IronPython 已经足够成熟了吗？”**

尖刻的答案是“显然”，因为它是视觉工作室的一流部分。

[http://search.microsoft.com/results.aspx?mkt=en-us&setlang=en-us&q=ironpython](http://search.microsoft.com/results.aspx?mkt=en-us&setlang=en-us&q=ironpython)

更好的答案是“是”。它确实有效，多年来一直有效，并且与其他已经工作了很多年的 Python 运行时兼容。  

以下是说明：[http ://www.microsoft.com/downloads/details.aspx?FamilyId=55932211-0D7E-4C6E-9B18-8F9D2AC1EE43&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyId=55932211-0D7E-4C6E-9B18-8F9D2AC1EE43&displaylang=en)

**“在学习的同时放弃 IronPython，坚持使用官方版本 3 分发会更好吗？”**

这没有多大意义。

您在 .Net 中工作，因此 IronPython 是您的最佳选择。“forgo IronPython”很难解析——你在考虑使用 CPython 吗？它也有效。并且效果很好，但它可能不适用于您的其他视觉工作室工具。

“坚持使用官方版本 3 发行版”根本没有意义。有两个并行发行版，*都是*官方的。有 2.6 和 3.x。在可预见的未来，它们将同时存在。  

您应该从与您要使用的工具一起使用的任何版本开始。目前，您的工具在 2.6 中可能比 3.x 更好地工作。在某些时候，您会注意到您的工具正在迁移到 3.x。然后 - 只有这样 - 您可以迁移到 3.x。

        sql-server - 在数据库中创建新行后，我应该返回该行的主键还是数据传输对象？

ID：809738

赞同：2

时间：2009-05-01T00:33:03.387

标签：sql-server, database, design-patterns, database-design

我有一个三层系统，SQL Server 后端，手写数据访问层，并使用存储过程。

我有一个名为 EventTable 的表。每行都是一个“事件”。一个事件有一个主键和一个开始日期。

```
CREATE TABLE EventTable
(
  ID INT IDENTITY(100,1) PRIMARY KEY,
  StartTime DateTime NOT NULL
) 
```

有一个名为 EventTable_Create 的存储过程。顺便说一句，create 方法写得好吗？

```
CREATE PROCEDURE Event_Create
    @NewID INT OUT
AS
    DECLARE @START DATETIME
    SELECT @START = getdate() 
    INSERT INTO EventTable VALUES(@START, NULL)
    SELECT @NewID = MAX(ID) FROM EventTable
GO 
```

数据访问层向调用者返回一个 int，但它应该返回一个名为 Event 的数据传输对象的实例吗？如果是这样，我是否应该同时返回新创建的 ID 和开始时间，以便数据访问层可以创建事件传输对象？

            回答 #1

赞同：3

时间：2009-05-01T01:01:23.523

这一切都取决于您通过数据访问在域层中需要什么。由于您是通过从域层传递信息来创建它的，因此我假设您已经在域逻辑中拥有大部分事件信息。在这种情况下，您只需要一个 ID 来填充它作为您的事件对象的一部分（如果您有的话）。

因此，这完全取决于您在域层中需要什么以及出于什么原因。

            回答 #2

赞同：2

时间：2009-05-01T03:46:44.827

就您需要返回的内容而言，任何一种方式都可能有效。正如 CodeToGlory 所说，这取决于。我会倾向于自己返回这两个值。

我将更改在存储过程中获取标识列的方式。有几种方法可以得到它。

而不是：SELECT @NewID = MAX(ID) FROM EXPERIMENTTABLE

我会这样做：设置@NewID = @@Identity

或者

设置@NewID = SCOPE_IDENTITY()

这是网上书籍的摘录，并附有示例。我可以帮助您决定使用哪个：

例如，有两个表，T1 和 T2，并且在 T1 上定义了一个 INSERT 触发器。当向 T1 插入一行时，触发器将触发并在 T2 中插入一行。这个场景说明了两个作用域：T1 上的插入和触发器在 T2 上的插入。

假设 T1 和 T2 都有标识列，@@IDENTITY 和 SCOPE_IDENTITY 将在 T1 上的 INSERT 语句末尾返回不同的值。@@IDENTITY 将返回在当前会话的任何范围内插入的最后一个标识列值。这是插入到 T2 中的值。SCOPE_IDENTITY() 将返回插入到 T1 中的 IDENTITY 值。这是在同一范围内发生的最后一个插入。如果在作用域中出现任何插入标识列的 INSERT 语句之前调用该函数，则 SCOPE_IDENTITY() 函数将返回空值。

            回答 #3

赞同：1

时间：2009-05-01T18:22:11.663

除非您需要整个数据结构，否则您应该返回唯一的主键。默认返回整个数据结构，没有特定原因，是浪费。

            回答 #4

赞同：0

时间：2009-05-01T05:10:10.193

您不应该使用 MAX(ID) 来检索新添加记录的主键。

请改用@@Identity。

```
INSERT INTO tbl(...) VALUES(...);

SELECT @@Identity as NewID; 
```

        html - 如何阻止 IE 创建像素化按钮？

ID：809743

赞同：1

时间：2009-05-01T00:33:51.980

标签：html, css, internet-explorer

我知道我以前遇到过这个问题，但出于某种原因，IE 决定像素化我的提交按钮。

有谁知道如何解决这一问题？

            回答 #1

赞同：7

时间：2009-05-01T01:07:32.040

像素化通常只发生在 IE6 和 IE7 中，因为它已在 IE8 中修复：
 [Bug 101](http://webbugtrack.blogspot.com/2007/08/bug-101-buttons-render-stretched-and.html)

诀窍是将CSS应用于按钮......

```
/* Apply CSS class "button" to your input buttons */
.button{
  width:auto; /* fix stretching in IE for 16-20 char buttons */
  overflow:visible; /* fix stretching in IE for 16-20 char buttons */
  padding-left:4px; /* force sensible padding in IE */
  padding-right:4px; /* force sensible padding in IE */
} 
```

这并**不能解决**所有问题，但它肯定会最大限度地减少影响。

下面的屏幕截图显示所有按钮（应用了样式）都有“可敬的”填充（例如，它不会疯狂​​增长）。另请注意，在某些时候按钮仍然会失败并像素化......但您可以在它们失败之前挤入更多字符。（最多 25 个字符与 19 个字符...取决于字体系列和大小）

[IE 按钮拉伸部分修复 http://img523.imageshack.us/img523/3990/iebuttons.png](http://img523.imageshack.us/img523/3990/iebuttons.png)

        css - CSS 溢出：隐藏

ID：809747

赞同：2

时间：2009-05-01T00:34:09.377

标签：css

我有这个 HTML 和 CSS，并且“溢出：隐藏”标签在 Firefox 中不起作用。这让我很难过......有人知道为什么它不起作用吗？仅仅是因为 A 标签不支持溢出标签吗？

```
#page_sidebar_tabs A {
    float: left;
    border: 1px solid #0F0;
    display: block;
    line-height: normal;
    padding-top: 18px !important;
    height: 18px !important;
    overflow: hidden !important;
    border-bottom: 2px solid #EEB31D;
}

#page_sidebar_tabs A:hover, .sidebar_active_tab {
    background-position: 0 -18px !important;
}

a#sidebar1 {
    background: url(../sidebar/tab1.gif) top left transparent no-repeat;
    width: 76px;
}

a#sidebar2 {
    background: url(../sidebar/tab2.gif) top left transparent no-repeat;
    width: 55px;
}

a#sidebar3 {
    background: url(../sidebar/tab3.gif) top left transparent no-repeat;
    width: 55px;
} 
```

HTML：

```
<div id="page_sidebar_tabs">
    <a href="#" id="sidebar1" onClick="return SidebarTabOnClick('1');">ABC</a>
    <a href="#" id="sidebar2" onClick="return SidebarTabOnClick('2');">DEF</a>
    <a href="#" id="sidebar3" onClick="return SidebarTabOnClick('3');">GHI</a>
</div> 
```

编辑：

我只是想更新/澄清：

这是为了实现 CSS 翻转，A 块应该是 18px 高，背景图像是 36px 高，并且翻转会向上/向下推动背景图像以实现翻转。

如果它们没有 CSS 或其他任何东西，则适当的文本可以优雅地（希望）降级。padding-top 理想地将文本推到 A 标签的可见块下方，因此隐藏了溢出。

溢出应该隐藏垂直向下推的文本（只留下背景图像可见），但是，它仍然显示在 Firefox 中。

            回答 #1

赞同：3

时间：2009-05-01T00:44:28.447

它确实有效。它似乎不是的唯一原因是您的内容不够长而导致溢出...如果您的 html 看起来像这样，您会发现它工作得很好：

```
<div id="page_sidebar_tabs">
    <a href="#" id="sidebar1" onClick="return SidebarTabOnClick('1');">ABCABCABCABCABCABCABC</a>
    <a href="#" id="sidebar2" onClick="return SidebarTabOnClick('2');">DEFDEFDEFDEFDEFDEFDEF</a>
    <a href="#" id="sidebar3" onClick="return SidebarTabOnClick('3');">GHIGHIGHIGHIGHIGHIGHI</a>
</div> 
```

            回答 #2

赞同：2

时间：2009-05-01T09:04:34.517

溢出应该隐藏垂直向下推的文本（只留下背景图像可见），但是，它仍然显示在 Firefox 中。

填充被添加到元素的内容高度（这是默认盒子模型中的 height 属性指定的），不会从中减去。尝试 height: 0 以查看文本消失并且框保持与 padding-top 一样高。

[CSS 2.1 规范：盒子模型](http://www.w3.org/TR/CSS21/box.html)

            回答 #3

赞同：1

时间：2009-05-01T00:44:27.667

为了`overflow: hidden;`有所作为，您需要将`width`对象的 设置为固定值。

```
#page_sidebar_tabs A {
    float: left;
    border: 1px solid #0F0;
    display: block;
    line-height: normal;
    padding-top: 18px !important;
    height: 18px !important;
    width: 30px;                /* <--- note this line */
    overflow: hidden !important;
    border-bottom: 2px solid #EEB31D;
} 
```

如果您需要在具有此 css id 的对象上具有不同的宽度，只需为它们创建不同的类并在类中设置宽度。您可以通过用空格分隔任意数量的 css 类来将它们应用于对象：

```
<div class="oneclass anotherclass">this div will apply both the .oneclass
    and the .anotherclass css style classes.</div> 
```

            回答 #4

赞同：1

时间：2009-05-01T00:56:41.850

它工作得很好。

如果您发现 Firefox 与 Internet Explorer 的差异，那是因为它在 Internet Explorer 中显示不正确。

如果您的页面上没有正确的文档类型，它将在 IE 中以 quirks 模式呈现，这意味着它使用了不正确的框模型，其中填充没有添加到元素的大小。这使得链接高 18 像素，而不是正确的 36 像素。

[W3C：推荐的文档类型列表](http://www.w3.org/QA/2002/04/valid-dtd-list.html)

[维基百科：IE框模型错误](http://en.wikipedia.org/wiki/Internet_Explorer_box_model_bug)

            回答 #5

赞同：1

时间：2009-05-01T03:38:04.380

什么 Alconja 说的，但也是迂腐的，你应该`a`用小写 a 而不是大写 A 真正定义你的元素规则。

        sql-server - 复制表不存在的视图

ID：809757

赞同：0

时间：2009-05-01T00:38:23.763

标签：sql-server, reporting-services, replication, dynamics-crm

我正在从 MS SQL Server 2005 复制到 MS SQL Server 2008（Microsoft CRM Dynamics 数据库）。

源数据库中有许多视图不再具有它们的基础表。我不知道为什么会这样或它是如何发生的。

问题是订阅者无法创建这些视图，因此订阅在中途一直失败。

我一直在逐个查看，试图找到所有依赖项。每次我更改要发布的文章时，我都需要创建一个新快照，这会给服务器带来巨大的负载并给我们的用户带来问题。

1.  有没有办法将视图结构传输到另一台服务器，然后复制数据/表？

2.  有没有办法确保在找到故障点后继续订阅的其余部分？

3.  有没有办法更新快照而不让它重复已经成功的位？

谢谢，卡尔

            回答 #1

赞同：0

时间：2009-05-12T16:44:49.780

首先在旧服务器上创建丢失的表，然后设置/执行正常复制不是更有意义吗？

似乎您将需要以一种或另一种方式创建它们....不妨先这样做，让您的生活更轻松。无论如何，如果没有基础表，视图将毫无用处。

        linux - 将文件和文件夹意外移动到不存在的地方

ID：809761

赞同：6

时间：2009-05-01T00:39:55.383

标签：linux, file, directory, mv

我经常执行以下命令：

```
mv folder $something_that_does_not_exist
mv files* $something_that_does_not_exist 
```

然后，我意识到我的文件不见了。即使在文件夹“$something_that_does_not_exist”中我也看不到它们。我的文件和文件夹到哪里去了？我怎样才能让他们回来？

            回答 #1

赞同：10

时间：2009-05-01T00:47:34.117

为了防止这个问题，我习惯在使用`cp`or时总是在目录名称的末尾附加 / `mv`：

```
$ touch foo
$ mv foo bar/
mv: cannot move `foo' to `bar/foo': No such file or directory 
```

如果没有尾部斜杠，`mv`则执行文件重命名操作。您可能会发现您的文件已更改名称。

            回答 #2

赞同：2

时间：2009-05-01T00:52:56.943

如果`$something_that_does_not_exist`扩展为空（但我不确定这是否是您的问题？）那么第一个 mv 将失败。第二个 mv 命令也将失败，除非`"files*"`扩展为恰好两个文件，或者最后一个文件名`"files*"`扩展为恰好是一个目录。然后文件将被移动到该目录。

如果命令在脚本中，并且您希望脚本在尝试扩展变量且未设置时中止，则可以使用问号修饰符。例子：

```
$ echo ${DISPLAY?}; echo display
:0.0
display
$ echo ${MYTEST?}; echo mytest
bash: MYTEST: parameter null or not set
$ 
```

所以如果你使用

```
mv folder ${something_that_does_not_exist?} 
```

并且`something_that_does_not_exist`未设置，则不会执行以下命令。

            回答 #3

赞同：0

时间：2009-05-01T00:49:25.470

您将无法取回您的文件，因为 shell 会扩展您的文件，我相信列表中的最后一个文件现在将被称为 $something_that_does_not_exist。

列表中的所有其他文件都将被覆盖。所以你不能让他们回来。

编辑：在我的 smoothwall 虚拟机上（现在我手头上唯一的 GNU/Linux！）我明白了：

```
$ mkdir t1
$ mv t1 t2
$ ls
t2/
$ mv t2 t1
$ cd t1
$ touch f1 f2 f3 f4
$ mv f* ../t2
mv: target `../t2' is not a directory 
```

            回答 #4

赞同：0

时间：2009-05-01T01:09:52.893

```
mv folder $something_that_does_not_exist 
```

这应该是一个错误：

```
$ mkdir folder
$ mv folder
mv: Insufficient arguments (1)
Usage: mv [-f] [-i] f1 f2
       mv [-f] [-i] f1 ... fn d1
       mv [-f] [-i] d1 d2 
```

另一种情况取决于`files*`匹配的内容：

```
mv files* $something_that_does_not_exist 
```

如果最终匹配是一个目录，您可能会在那里找到您的文件。否则，您要么将第一个文件重命名为与第二个文件相同，要么出现如上所述的另一个错误。

            回答 #5

赞同：0

时间：2009-05-01T01:19:49.173

**1）**您尝试移动目录“文件夹”：

```
mv folder abcde 
```

如果“abcde”是一个现有目录，它会将“文件夹”移动到“abcde”中。如果“abcde”是现有文件，该命令将失败。否则它将把“文件夹”重命名为“abcde”。

**2）**您尝试移动一些文件：

```
mv files* abcde 
```

如果“abcde”是一个现有目录，它会将“files*”移动到“abcde”中。否则，如果只有一个文件匹配“files*”，它将将该文件重命名为“abcde”。否则命令将失败。

        android - Android：跟踪创建的对象数

ID：809763

赞同：14

时间：2009-05-01T00:40:43.977

标签：android, garbage-collection, debugging, profiling, allocation

我正在将游戏移植到 Android（有很多代码，而我的代码很少），DalvikVM 正在（通过 LogCat）告诉我所有关于垃圾收集的信息。在代码中的某个时刻，我收到一条“GC 释放 x 个对象 / x 毫秒”消息流，基本上是通知我刚刚删除了大约 150,000 个对象，这需要整整一秒钟。

我想知道这些是从哪里来的！我很确定我不是故意创建那么多对象。

那么，有没有办法得到......基本上与该消息相反？*创建*任何对象时打印日志消息的东西？

这样我就可以跳过代码，检查生成了多少消息，并查看代码的哪些部分正在生成对象。我怀疑在循环的一部分中创建了某种形式的对象，但如果可能的话，这将是一种确定的简单方法。

我正在使用`Eclipse 3.4.2`，如果那是相关的。

有任何想法吗？

            回答 #1

赞同：8

时间：2009-05-03T15:52:33.487

这可以使用 Android 附带的 ddms 工具（不是 Eclipse 版本）。使用它，查看分配跟踪器选项卡。您可以开始跟踪所有对象的分配以及它们分配位置的堆栈跟踪。但是，此工具可以生成大量信息，而您想要的特定信息并不总是易于解析或查找。如果你有 Sun JVM 的版本，我会推荐使用 Kai 提到的工具，它们更发达。如果您必须在 Android 中执行此操作，则使用分配跟踪器将为您提供一个开始。

            回答 #2

赞同：3

时间：2009-05-01T02:35:40.317

为什么不分析 Sun JVM 上的现有游戏代码（假设您正在移植 Java 游戏）？然后，您可以利用 JProfiler、Yourkit 等，查看正在清理哪些庞大的对象集。（使用 -XX:+PrintGCDetails 来查看 GC 运行的时间。）

如果事实证明它不在游戏中，那么您已经很轻松地发现了这一点，然后可以将注意力转移到您的 Android 代码上。不幸的是，我对此知之甚少。

        php - 使用指定的排序规则对多列上的关联数组进行排序

ID：809771

赞同：7

时间：2009-05-01T00:42:48.933

标签：php, arrays, sorting, multidimensional-array

我希望能够对多个列上的关联数组进行排序。更复杂的是，我希望能够为每个键/列设置特定的排序选项。我有一组类似于 db 查询结果集的数据，但它实际上并不是来自一个，所以我需要在 PHP 而不是 SQL 中对其进行排序。

```
[
    ['first_name' => 'Homer', 'last_name' => 'Simpson', 'city' => 'Springfield', 'state' => 'Unknown', 'zip' => '66735'],
    ['first_name' => 'Patty', 'last_name' => 'Bouvier', 'city' => 'Scottsdale', 'state' => 'Arizona', 'zip' => '85250'],
    ['first_name' => 'Moe', 'last_name' => 'Szyslak', 'city' => 'Scottsdale', 'state' => 'Arizona', 'zip' => '85255'],
    ['first_name' => 'Nick', 'last_name' => 'Riviera', 'city' => 'Scottsdale', 'state' => 'Arizona', 'zip' => '85255'],
]; 
```

我希望能够对其进行排序，类似于使用数据库查询可以完成的操作。哦，有时需要按数字指定列/键。

我想到的是与此类似的东西：

```
$sortOptions = array(
    array( 'city', SORT_ASC, SORT_STRING),
    array( 'zip', SORT_DESC, SORT_NUMERIC),
    array( 2, SORT_ASC, SORT_STRING) // 2='last_name'
);
$sorter = new MultiSort($data, $sortOptions);
$sortedData = $sorter->getSortedArray();
print_r($jmsSorted); 
```

我想结束的是：

```
Array
(
    [0] => Array
        (
            [first_name] => Nick
            [last_name] => Riviera
            [city] => Scottsdale
            [state] => Arizona
            [zip] => 85255
        )

    [1] => Array
        (
            [first_name] => Moe
            [last_name] => Szyslak
            [city] => Scottsdale
            [state] => Arizona
            [zip] => 85255
        )

    [2] => Array
        (
            [first_name] => Patty
            [last_name] => Bouvier
            [city] => Scottsdale
            [state] => Arizona
            [zip] => 85250
        )

    [3] => Array
        (
            [first_name] => Homer
            [last_name] => Simpson
            [city] => Springfield
            [state] => Unknown
            [zip] => 66735
        )

) 
```

**更新：**我认为理想情况下，解决方案将导致动态创建

```
array_multisort( $city, SORT_ASC, SORT_STRING, $zip, SORT_DESC, SORT_NUMERIC, $last_name, SORT_ASC, SORT_STRING, $inputArray); 
```

问题是**我不想在那里“硬编码”那些键名**。我尝试根据示例 #3从最终使用的文档中**对数据库结果进行排序**创建一个解决方案，但我似乎无法找到一种方法来使用我的动态构建的参数列表。[`array_multisort()`](http://us.php.net/manual/en/function.array-multisort.php)`array_multisort()``array_multisort()`

我的尝试是将这些参数“链接”到一个数组中，然后

```
call_user_func_array( 'array_multisort', $functionArgs); 
```

这导致

警告：array_multisort() 的参数 2 应为参考，值在...

            回答 #1

赞同：4

时间：2009-05-01T02:45:34.677

这应该适用于您描述的情况。

```
usort($arrayToSort, "sortCustom");

function sortCustom($a, $b)
{
    $cityComp = strcmp($a['city'],$b['city']);
    if($cityComp == 0)
    {
        //Cities are equal.  Compare zips.
        $zipComp = strcmp($a['zip'],$b['zip']);
        if($zipComp == 0)
        {
            //Zips are equal.  Compare last names.
            return strcmp($a['last_name'],$b['last_name']);
        }
        else
        {
            //Zips are not equal.  Return the difference.
            return $zipComp;
        }
    }
    else
    {
        //Cities are not equal.  Return the difference.
        return $cityComp;
    }
} 
```

您可以将其压缩为一行，如下所示：

```
function sortCustom($a, $b)
{
    return ($cityComp = strcmp($a['city'],$b['city']) ? $cityComp : ($zipComp = strcmp($a['zip'],$b['zip']) ? $zipComp : strcmp($a['last_name'],$b['last_name'])));
} 
```

就具有可定制的排序功能而言，您正在重新发明轮子。看一下[`array_multisort()`](http://us2.php.net/manual/en/function.array-multisort.php)功能。

            回答 #2

赞同：4

时间：2010-05-11T13:26:30.700

在 PHP 5.3 中，数组中的每个参数在调用时都必须是一个`array_multisort()`引用`call_user_func_array()`。

此函数对多维数组进行排序，并展示了一种构建正确工作的引用参数数组的方法。

```
function msort()
{
  $params = func_get_args();
  $array = array_pop($params);

  if (!is_array($array))
    return false;

  $multisort_params = array();
  foreach ($params as $i => $param) 
  {
    if (is_string($param)) 
    {
      ${"param_$i"} = array();
      foreach ($array as $index => $row) 
      {
        ${"param_$i"}[$index] = $row[$param];
      }
    }
    else 
      ${"param_$i"} = $params[$i];

    $multisort_params[] = &${"param_$i"};
  }
  $multisort_params[] = &$array; 

  call_user_func_array("array_multisort", $multisort_params);

  return $array;
} 
```

例子：

$data 是问题中的给定数组

```
$sorted_data = msort('city', SORT_ASC, SORT_STRING, 'zip', SORT_DESC, SORT_NUMERIC, $data) 
```

            回答 #3

赞同：1

时间：2009-05-01T01:39:55.723

您可能想尝试使用[usort](http://us2.php.net/manual/en/function.usort.php)。您所要做的就是创建一个函数来告诉分拣机如何对其进行排序。文档有更多关于如何做到这一点的信息。

            回答 #4

赞同：1

时间：2011-08-13T00:23:28.260

这是我最终决定对多维数组进行排序的原因。上面的两个答案都很好，但我也在寻找灵活的东西。

我绝对不认为有任何一个“正确”的答案，但这符合我的需求并且很灵活。

正如您在我`@link`的评论中看到的那样，`_usortByMultipleKeys()`它改编自当前似乎不存在的 PHP 手册中的评论，但我相信[http://www.php.net/manual/en/function.usort。 php#104398](http://www.php.net/manual/en/function.usort.php#104398)是原始评论的新版本。我还没有探索过使用这个新建议。

```
/**
 * Sort the resultSet.
 *
 * Usage: $sortOptions = array(
 *          'section', // Defaults to SORT_ASC
 *          'row' => SORT_DESC,
 *          'retail_price' => SORT_ASC);
 *        $results->sortResults($sortOptions);
 *
 * @param array $sortOptions    An array of sorting instructions
 */
public function sortResults(array $sortOptions)
{
    usort($this->_results, $this->_usortByMultipleKeys($sortOptions));
}

/**
 * Used by sortResults()
 *
 * @link http://www.php.net/manual/en/function.usort.php#103722
 */
protected function _usortByMultipleKeys($key, $direction=SORT_ASC)
{
    $sortFlags = array(SORT_ASC, SORT_DESC);
    if (!in_array($direction, $sortFlags)) {
        throw new InvalidArgumentException('Sort flag only accepts SORT_ASC or SORT_DESC');
    }
    return function($a, $b) use ($key, $direction, $sortFlags) {
        if (!is_array($key)) { //just one key and sort direction
            if (!isset($a->$key) || !isset($b->$key)) {
                throw new Exception('Attempting to sort on non-existent keys');
            }
            if ($a->$key == $b->$key) {
                return 0;
            }
            return ($direction==SORT_ASC xor $a->$key < $b->$key) ? 1 : -1;
        } else { //using multiple keys for sort and sub-sort
            foreach ($key as $subKey => $subAsc) {
                //array can come as 'sort_key'=>SORT_ASC|SORT_DESC or just 'sort_key', so need to detect which
                if (!in_array($subAsc, $sortFlags)) {
                    $subKey = $subAsc;
                    $subAsc = $direction;
                }
                //just like above, except 'continue' in place of return 0
                if (!isset($a->$subKey) || !isset($b->$subKey)) {
                    throw new Exception('Attempting to sort on non-existent keys');
                }
                if ($a->$subKey == $b->$subKey) {
                    continue;
                }
                return ($subAsc==SORT_ASC xor $a->$subKey < $b->$subKey) ? 1 : -1;
            }
            return 0;
        }
    };
} 
```

            回答 #5

赞同：0

时间：2020-06-17T00:03:48.943

我已经看到了许多使用`array_multisort()`inside of的 Stack Overflow 解决方案`call_user_function_array()`，但是从 PHP5.6 开始，splat 运算符可以取消嵌套排序函数并允许它被独占调用。

假设您的数据声明为`$array`：

```
$array = [
    ['first_name' => 'Homer', 'last_name' => 'Simpson', 'city' => 'Springfield', 'state' => 'Unknown', 'zip' => '66735'],
    ['first_name' => 'Patty', 'last_name' => 'Bouvier', 'city' => 'Scottsdale', 'state' => 'Arizona', 'zip' => '85250'],
    ['first_name' => 'Moe', 'last_name' => 'Szyslak', 'city' => 'Scottsdale', 'state' => 'Arizona', 'zip' => '85255'],
    ['first_name' => 'Nick', 'last_name' => 'Riviera', 'city' => 'Scottsdale', 'state' => 'Arizona', 'zip' => '85255'],
]; 
```

我的代码片段将使用一组不确定的规则对您的数据进行正确排序。它允许使用一个单独的字符串来说明应该对哪一列进行 ASC 排序，或者您可以明确说明排序标志。它还被构建为允许列的数字引用，以防您事先不知道确切的列名。

```
$sortingRules = [
    'city',                       // sort by city column ASC (could have also been: ['city'])
    ['zip', 'desc', 'numeric'],   // then sort by zip column DESC treating as numbers
    [1, 'desc'],                  // then sort by last_name column DESC
]; 
```

我已经创建了两个函数声明，但是如果您的项目从不希望处理传入的丢失/无效列键，那么您可以消除该`sanitizeColumnReference()`函数并只使用`$column = array_column($input, array_shift($rule));`. 事实上，如果您删除所有异常抛出逻辑，该代码段的大小可能大约是其一半。

TLDR；这种技术的美妙之处在于，您需要做的就是在`array_multisort()`“splat 运算符”（`...`.

```
function sanitizeColumnReference($row, $columnReference) {
    if (!isset($row[$columnReference]) && is_int($columnReference)) {
        $columnReference = array_keys($row)[$columnReference] ?? null;  // attempt to derive column name by position
        if ($columnReference === null) {
            throw new Exception('Failed to locate column by position using column reference: ' . $columnReference);
        }
    }
    return $columnReference;
}

function dynamicSort(&$input, $sortingRules) {
    if (!$input || !$sortingRules || !is_array($input) || !is_array($sortingRules)) {
        return;  // return silently
    }
    $firstRow = current($input);
    $sortingParams = [];
    foreach ($sortingRules as $rule) {
        $rule = (array)$rule; // permit the passing of a solitary string as a sorting rule
        $columnReference = sanitizeColumnReference($firstRow, array_shift($rule)); 
        $column = array_column($input, $columnReference);
        if (!$column) {
            throw new Exception('Failed to source sortable data from column reference: ' . $columnReference);
        }
        $sortingParams[] = $column;
        foreach ($rule as $flag) {
            $sortingParams[] = constant('SORT_' . strtoupper($flag));  // convert strings to usable CONSTANTs
        }
    }
    $sortingParams[] = &$input;
    // var_export($sortingParams);
    array_multisort(...$sortingParams); // unpack into native sorting function
} 
```

以下是调用自定义/动态排序函数的方法：

```
dynamicSort($array, $sortingRules);  // this modifies by reference like native sorting functions 
```

输出：（[演示](https://3v4l.org/JKhtR)）

```
array (
  0 => 
  array (
    'first_name' => 'Moe',
    'last_name' => 'Szyslak',
    'city' => 'Scottsdale',
    'state' => 'Arizona',
    'zip' => '85255',
  ),
  1 => 
  array (
    'first_name' => 'Nick',
    'last_name' => 'Riviera',
    'city' => 'Scottsdale',
    'state' => 'Arizona',
    'zip' => '85255',
  ),
  2 => 
  array (
    'first_name' => 'Patty',
    'last_name' => 'Bouvier',
    'city' => 'Scottsdale',
    'state' => 'Arizona',
    'zip' => '85250',
  ),
  3 => 
  array (
    'first_name' => 'Homer',
    'last_name' => 'Simpson',
    'city' => 'Springfield',
    'state' => 'Unknown',
    'zip' => '66735',
  ),
) 
```

        jakarta-ee - servlet 有什么作用
价值表示

ID：809775

赞同：181

时间：2009-05-01T00:45:02.390

标签：jakarta-ee, servlets, web.xml

我在这里有点困惑。在我们的应用程序中，我们定义了一些 servlet。`web.xml`以下是其中一个 servlet的摘录：

```
<servlet>
    <servlet-name>AxisServlet</servlet-name>
    <display-name>Apache-Axis Servlet</display-name>
    <servlet-class>com.foo.framework.axis2.http.FrameworkServlet</servlet-class>
    <load-on-startup>0</load-on-startup>
</servlet> 
```

据我了解，它的值`<load-on-startup>`必须是一个正整数才能自动加载。我在谷歌上查找，但我遇到的回复只会让我更加困惑。

            回答 #1

赞同：192

时间：2009-05-01T04:25:50.490

[Resin 3.0](http://www.caucho.com/resin-3.0/config/webapp.xtp)记录了这种行为：

load-on-startup 可以指定一个（可选的）整数值。如果该值为 0 或更大，则表示加载 servlet 的顺序，编号较大的 servlet 在编号较小的 servlet 之后加载。

[JSP 3.1 规范](https://jcp.org/aboutJava/communityprocess/final/jsr340/)(JSR 340) 在第 14-160 页这样说：

该元素`load-on-startup`指示应该在 Web 应用程序启动时加载（实例化并调用它的 init()）这个 servlet。此元素的元素内容必须是一个整数，指示应加载 servlet 的顺序。如果该值为负整数，或者该元素不存在，则容器可以在选择时自由加载 servlet。如果该值为正整数或 0，则容器必须在部署应用程序时加载并初始化 servlet。容器必须保证在标有大整数的 servlet 之前加载标有小整数的 servlet。容器可以选择加载相同`load-on-startup`值的 servlet 的顺序。

您可能不仅要检查 JSR，还要检查 Web 容器的文档。可能存在差异

            回答 #2

赞同：133

时间：2009-08-19T10:26:18.837

**简短答案**：值 >= 0 表示 servlet 在部署 web 应用程序或服务器启动时加载。value < 0 ：当容器感觉像时加载 servlet。

**长答案**（来自规范）：

load-on-startup 元素表明这个 servlet 应该在 Web 应用程序启动时被加载（实例化并调用它的 init()）。这些元素的可选内容必须是一个整数，指示应加载 servlet 的顺序。如果该值为负整数，或者该元素不存在，则容器可以在选择时自由加载 servlet。如果该值为 128 正整数或 0，则容器必须在部署应用程序时加载并初始化 servlet。容器必须保证在标有大整数的 servlet 之前加载标有小整数的 servlet。容器可以选择加载具有相同加载启动值的 servlet 的顺序。

            回答 #3

赞同：11

时间：2009-05-01T00:47:59.233

它表明 servlet 在请求尝试访问它之前不会启动。

如果 load-on-startup 大于或等于 0，那么当容器启动时，它将按照您放在那里的启动时负载值的升序启动该 servlet（即 0、1 然后 2 然后 5 然后 10 等等） .

            回答 #4

赞同：9

时间：2009-05-01T07:16:18.083

[Servlet 生命周期](https://docs.oracle.com/javaee/7/tutorial/servlets002.htm)

servlet 的生命周期由部署 servlet 的容器控制。当请求映射到 servlet 时，容器会执行以下步骤。

1.  如果 servlet 的实例不存在，则 Web 容器：

    **一种。**加载 servlet 类

    **湾。**创建 servlet 类的实例

    **C。**通过调用 init 方法初始化 servlet 实例（初始化在[创建和初始化 Servlet](https://docs.oracle.com/javaee/7/tutorial/servlets004.htm#BNAFU)中介绍）

2.  容器调用服务方法，传递请求和响应对象。服务方法在[编写服务](https://docs.oracle.com/javaee/7/tutorial/servlets005.htm#BNAFV)方法中讨论。

0 值`load-on-startup`表示当请求到达该 servlet 时执行点 1。其他值表示第 1 点在容器启动时执行。

            回答 #5

赞同：1

时间：2011-12-20T09:48:24.613

如其他答案所述，并且此[加载启动文章](http://javarevisited.blogspot.com/2011/12/load-on-startup-servlet-webxml-example.html)零是可以接受的，并且在没有任何其他 servlet 的情况下，这将在部署期间优先加载和加载。load-on statup 的最佳用途是加载 servlet，这在第一个请求到来之前需要更长的时间来初始化，就像 servlet 创建连接池或进行网络调用或持有大量资源，这将显着减少前几个请求的响应时间。

            回答 #6

赞同：1

时间：2013-03-14T08:56:34.633

1.  如果两个 servlet 的值相同，则它们将按照在 web.xml 文件中声明的顺序加载。
2.  如果是 0 或负整数，那么当 Container 感觉要加载它们时，将加载 Servlet。
3.  保证 web 容器加载、初始化和调用 servlet 的 init() 方法。
4.  如果没有任何 servlet 的元素，那么它们将在 Web 容器决定加载它们时被加载。

            回答 #7

赞同：0

时间：2010-12-29T10:52:47.213

是的，它可以具有相同的值....在启动时为加载提供数字的原因是为服务器定义一个序列以加载所有 servlet。启动时加载值为 0 的 servlet 将首先加载，之后加载值为 1 的 servlet。

如果两个 servlet 的 load-on-startup 值相同，那么它将按照 web.xml 中从上到下的声明方式进行加载。web.xml 中最先出现的 servlet 将首先加载，然后再加载另一个。

            回答 #8

赞同：0

时间：2012-02-10T13:32:20.913

--> (Absence of load-on-start-up) 标签 首先，当 servlet 部署在服务器中时，服务器负责创建 servlet 对象。例如：假设 Servlet 部署在服务器中，（Servlet 对象在服务器中不可用）客户端第一次向 servlet 发送请求，然后服务器在默认构造函数的帮助下创建 servlet 对象并立即调用 init() 。从那以后，当客户端发送请求时，只有服务方法将被执行，因为对象已经可用

如果在部署描述符中使用了 load-on-start-up 标签：在部署本身时，服务器根据标签之间提供的正值为 servlet 创建 servlet 对象。servlet 类的对象的创建将遵循从 0 到 128 0 编号的 servlet 将首先创建，然后是其他编号。

如果我们在 web.xml 中为两个 servlet 提供相同的值，那么对象的创建将基于 web.xml 中类的位置完成，也因服务器而异。

如果我们在启动标签之间的负载之间提供负值，那么服务器将不会创建 servlet 对象。

服务器为 servlet 创建对象的其他场景。

如果我们不在 web.xml 中的启动标签上使用加载，那么当客户端第一次发送请求服务器创建对象并且服务器负责调用其生命周期方法时，就会部署项目。然后，如果在服务器（tomcat）中修改了 .class 。客户端再次发送修改 servlet 的请求，但在 tomcat 的情况下，不会创建新对象并且服务器使用现有对象，除非重新启动服务器。但是在 web-logic 类中，当服务器中的 .class 文件被修改时，如果它收到请求而不重新启动服务器，则服务器调用现有 servlet 上的 destroy 方法并创建一个新的 servlet 对象并调用 init() 进行初始化.

            回答 #9

赞同：-1

时间：2011-08-29T21:08:13.860

如果值 <0，则在请求到来时实例化 serlet，否则 >=0 容器将按值的递增顺序加载。如果 2 个或多个 servlet 具有相同的值，则 web.xml 中声明的 servlet 的顺序。

            回答 #10

赞同：-2

时间：2011-04-01T07:32:47.447

servlet 容器在启动期间或发出第一个请求时加载 servlet。servlet 的加载取决于“web.xml”文件中的“load-on-startup”属性。如果属性有一个正整数（0 到 128），那么 servlet 会随着容器的加载而加载，否则它会在第一个服务请求到来时加载。

当 servlet 在收到请求后被加载时，它被称为“延迟加载”。

            回答 #11

赞同：-6

时间：2012-11-22T06:11:28.777

这很简单，你甚至没有想到。

如果值为正，则在容器启动时加载

如果该值不是正数，则在发出请求时将加载 serverlet。

        oracle - DBCA：在重新配置数据库时看不到新的数据库实例

ID：809777

赞同：0

时间：2009-05-01T00:47:11.823

标签：oracle

我使用 DBCA 创建了一个新的数据库实例。创建实例后。

我再次启动 DBCA 以重新配置这个特定的数据库。但是我看不到这个数据库。

我也尝试使用

dbca -slient -adddb 新数据库

但它提示我 DISPLAY 变量设置不正确。

在我设置 DISPLAY 变量之后。它再次提示我说 -slent 不是有效的命令行参数。

有什么问题以及如何解决这个问题？

            回答 #1

赞同：0

时间：2009-05-01T04:08:21.810

我将从查看环境变量开始；我遇到了这样一种情况，我从一个 ORACLE_HONME 创建了 DB，但在另一个 ORACLE_HOME 的 DBCA 中看不到它。

其他 xwindows 工具是否有效？例如，这是一个 DBCA 问题还是更根本的问题？

您可以从运行 DBCA 的帐户停止和启动实例吗？

        sql-server-2008 - 将自定义列添加到 SQL Server 2008 Studio 中视图的对象资源管理器详细信息

ID：809784

赞同：1

时间：2009-05-01T00:50:17.683

标签：sql-server-2008, ssms

我正在使用“对象资源管理器详细信息”，当我在“表”上时，我可以选择许多列，尤其是“创建日期”。

但是，当我在“视图”或数据库的大多数其他部分上时，我只能选择“名称”和“策略健康状态”列。我真的很想拥有“创建日期”（就像我以前在 SQL Server 2000 企业管理器中拥有的那样）。

我知道右键单击单个视图并选择“属性”将为我提供该特定视图的创建日期。但我想查看所有视图的所有创建日期，并能够对该列进行排序。

它在 Microsoft SQL Server 2008 Studio 中吗？

            回答 #1

赞同：1

时间：2009-05-02T15:14:35.523

你可以做：

```
use dbName
select name, create_date from sys.views 
```

这将为您提供您正在寻找的所有信息。

        scripting - 批处理文件 - 进入变量

ID：809790

赞同：2

时间：2009-05-01T00:53:44.400

标签：scripting, batch-file, variables, cmd

我在尝试获取字符串之后遇到问题：例如，在以下两行中，从名为 file.txt 的文本文件的底部将字符串转换为两个单独的变量

```
Number of files to delete:  27 Total
Total size of files to delete: 1,427 KB 
```

我只想要一个变量中的 27 和另一个变量中的 1,427。这些是从扫描中随机生成的，并且可能包含更多数字。

批处理文件，我用的是windows

            回答 #1

赞同：4

时间：2009-05-01T11:14:01.693

像这样的东西应该工作：

```
@echo off
setlocal enableextensions enabledelayedexpansion

:: Get the number of lines in the file
set LINES=0
for /f "delims==" %%I in (file.txt) do (
    set /a LINES=LINES+1
)

:: Parse the last 2 lines and get the numbers into variable NUMS
set /a LINES=LINES-2
for /f "skip=%LINES% delims=" %%L in (file.txt) do (
    for /f "tokens=1-2* delims=:" %%A in ("%%L") do (
        for /f "tokens=1-2*" %%N in ("%%B") do set NUMS=!NUMS!%%N;
    )

)

:: Parse variable NUMS
for /f "tokens=1-2* delims=;" %%A in ("%NUMS%") do (
    set NUM_FILES=%%A
    set TOTAL_SIZE=%%B
)

@echo Number of files     = %NUM_FILES%
@echo Total size of files = %TOTAL_SIZE% 
```

            回答 #2

赞同：1

时间：2009-08-26T12:32:01.827

jimbob，这是我想出的：

**删除文件.cmd**

```
@echo off
set file=clean.txt
call :grep "Number of files to delete:"
set files=%grep%
call :grep "Total size of files to delete:"
set size=%grep%

echo %Files% files of a total size of %size% are to be deleted.
exit /b 0

:grep
    setlocal
    for /F "tokens=2 delims=:" %%i in ('findstr /i /c:"%~1" "%file%"') do (
      for /F "tokens=1 delims= " %%j in ("%%i") do set _find=%%j
    )
    endlocal& set grep=%_find%
    exit /b 0 
```

这是一个可重复使用的脚本，因为可以更改文件和字符串并获得相同的结果。我复制/粘贴了您的示例，效果很好。

**@Patrick Cuff：如果没有****/c:".."**部分，您可能会遇到查找整个字符串的问题。可能是问题的一部分，但也许我的脚本会给出相同的结果/问题......我猜是生活和学习。  

**______Notes__________** 

**set file= ：**将此设置为要扫描的文件的文件（和路径，如果需要）。

**call :grep *"string"*：**  使用要查找的字符串调用 :grep 函数。

**set *var* =%grep% ：**  将变量（此处为文件和大小）设置为来自 :grep 的答案。  

**:grep 函数：**它首先在 %file% 中查找“%string%”，然后在 ':' 字符处解析它，保留右侧部分。然后它用“空格”再次解析它并保留第一个单词。该函数返回包含找到的字符串的变量 %grep%。  

与我通常的答案一样，我希望这会有所帮助。

            回答 #3

赞同：0

时间：2009-05-05T08:52:48.723

这是我的完整批处理文件；

```
@echo on
setlocal enableextensions enabledelayedexpansion

:: Get the number of lines in the file
set LINES=0
for /f "delims==" %%I in (D:\clean.txt) do (
    set /a LINES=LINES+1
    echo %LINES%
)

:: Parse the last 2 lines and get the numbers into variable NUMS
set /a LINES=LINES-2
echo %LINES%
for /f "skip=%LINES% delims=" %%L in (D:\clean.txt) do (
    for /f "tokens=1-2* delims=:" %%A in ("%%L") do (
        for /f "tokens=1-2*" %%N in ("%%B") do set NUMS=!NUMS!%%N;
    )

)

:: Parse variable NUMS
for /f "tokens=1-2* delims=;" %%A in ("%NUMS%") do (
    set NUM_FILES=%%A
    set TOTAL_SIZE=%%B
)

@echo Number of files     = %NUM_FILES%
@echo Total size of files = %TOTAL_SIZE% 
```

你可以看到我把额外的回声放在哪里，也可以看到变量的值，我得到了之前的截图。为什么它对你有用而不对我有用？这不公平大声笑我正在运行 Vista Home Basic SP1 32 位

            回答 #4

赞同：0

时间：2009-05-05T11:41:14.777

看起来您在阅读整个文件以获取行数时遇到了一些问题。此解决方案将仅找到您感兴趣的字符串并获取值：

```
@echo off
setlocal enableextensions enabledelayedexpansion

:: Get number of files to delete.
for /f "usebackq tokens=1-7" %%A in (`findstr /b "Number of files to delete:" file.txt`) do (
    set NUM_FILES=%%F
)

:: Get total size of files.
for /f "usebackq tokens=1-8" %%A in (`findstr /b "Total size of files to delete:" file.txt`) do (
    set TOTAL_SIZE=%%G
)

@echo Number of files     = %NUM_FILES%
@echo Total size of files = %TOTAL_SIZE% 
```

如果包含文件数量和总大小的字符串发生变化，您必须相应地更改脚本。

            回答 #5

赞同：-1

时间：2009-05-01T02:25:28.517

我假设您需要在纯 bash 中完成此操作。

```
#!/bin/bash
S="$(<testfile.txt)" # load the data

A="${S#*:}" # remove everything before the first : (including it)
A="${A%%Total*}" # remove everything after the first "Total" (including it)

B="${S##*:}" # remove everything before the last : (including it)
B="${B% *}" # remove everything after the last space (including it)

A="${A// }" # remove all spaces
B="${B// }"

echo "-$A-" # print results (showing that there are no spaces in it)
echo "-$B-" 
```

*我鼓励*`man bash`您探索. 你会在那里找到许多有用的技巧。

        gcc - 在 gcc 中同时使用静态和动态链接库

ID：809794

赞同：55

时间：2009-05-01T00:56:12.660

标签：gcc, linker

我需要分发一个可以在尽可能多的 x86 Linux 发行版上运行的二进制文件。这意味着我必须静态链接一些库，比如 glibc，因为用户可能没有我使用的版本。其他库必须动态链接，例如 fontconfig，因为它依赖于缓存文件格式和硬编码位置，每个系统可能不同。

执行此操作的命令行选项是什么？如果我指定 -static，那么 gcc 将拒绝动态链接任何库。

            回答 #1

赞同：96

时间：2009-05-03T02:28:59.473

在现代 UNIX 或 Linux 系统上静态链接到任何系统库，尤其是针对`libc`.，使得二进制文件的可移植性大大*降低。*只是不要这样做。

相反，使用向后兼容性（链接在旧系统上的二进制文件继续在所有新系统上运行）对你有利，或者通过将二进制文件链接到旧系统上（我使用 RedHat 6.2，我还没有看到我的二进制文件在 Linux 系统上将不会在过去 8 年内运行），或者使用类似[autopackage](https://web.archive.org/web/20100613022915/http://autopackage.org/apbuild-apgcc.php)的东西（在编写此答案后已被删除）。

要回答您的原始问题：

```
gcc main.o -Wl,-Bstatic -lfoo -Wl,-Bdynamic 
```

将导致链接器使用 libfoo 的归档版本。[精确的尾随很重要，`-Wl,-Bdynamic`这样您就不会强制使用静态 libc。]

            回答 #2

赞同：7

时间：2009-05-05T02:32:22.177

应该注意的是，在 Linux 下，如果没有动态库依赖于库，则只能（安全地）静态链接库。这意味着如果您使用任何动态库，您可以忘记静态链接 libc。只需使用相当旧的版本来针对 libc 的情况进行构建；多年来，libc 一直保持强大的 ABI 向后兼容性。

            回答 #3

赞同：4

时间：2009-05-01T01:06:07.270

尝试在链接器命令行（无论是 .a 还是 .so 库）上传递要链接的库文件的路径并删除 -static。这应该够了吧。

        html - 抑制链接标题

ID：809795

赞同：4

时间：2009-05-01T00:56:22.567

标签：html, hyperlink, title

有什么方法可以抑制链接上的弹出标题，但仍将它们保留在视障人士的页面上？

            回答 #1

赞同：5

时间：2009-05-01T01:03:23.393

这是浏览器解释链接标题并显示工具提示/弹出窗口的功能。没有办法压制他们。我试过了（因为客户也不喜欢它们）但没有办法绕过它们。

            回答 #2

赞同：3

时间：2009-08-19T14:43:59.420

我知道这已经解决，但我也找到了这个解决方法：[使用 jQuery 隐藏本机工具提示](https://stackoverflow.com/questions/1299772/jquery-hide-native-tooltip-resolved)

            回答 #3

赞同：1

时间：2015-07-22T19:15:53.693

我在一个项目中遇到了这个问题，客户想要显示他们自己的工具提示（使用 CSS 完成），但由于浏览器启动的工具提示也显示了，所以它显示了两次。我们通过删除 'title' 属性并使用 'data' 来填充 CSS 中的文本来解决这个问题。

我不确定您将它们保留在视障人士的页面上是什么意思，因为它们仅在源代码中可见？

例如：

`<a href="link" title="something">Link title here</a>` 

将在页面上显示链接“此处的链接标题”以及当您将鼠标悬停在其上时烦人的弹出窗口。

`<a href="link" data="something">Link title here</a>` 

将显示链接“此处的链接标题”，但不会在悬停时显示烦人的弹出窗口，尽管您仍然可以使用`data`标签来引用您想放在那里的任何内容（在我们的例子中，我们将 CSS 工具提示的文本放在参考）。

显然，如果你完全删除标题标签，问题就解决了，但你说你需要把它保留在那里，所以这是我以前使用的解决方法。

            回答 #4

赞同：0

时间：2009-05-01T01:13:03.417

...它可能并不理想，但你总是可以尝试，代替标签中的`title`属性`<a href>`，a ：`<span>``<a>`

```
/* screen.css */

a   { }

a span.titleText {
    display: none;
    position: absolute;
    bottom: 1.2em;
    left: 0;
}

a:hover span.titleText,
a:active span.titleText,
a:focus span.titleText {
    display: block;
}

/* audio.css */

a span {
    display: inline; /* or whatever the relevant attribute would 
                        be in an audio stylesheet. */
} 
```

```
<head>
    <link href="screen.css" type="text/css" rel="stylesheet" media="screen" />
    <link href="audio.css" type="text/css" rel="stylesheet" media="screen-reader, audio" />
</head>

<a href="http://some.url.com">
    <span class="titleText">This is the title</span>This is the link
</a> 
```

但是，我不建议将其作为特别实用的解决方案。而且我相当肯定它不会验证。如果我知道 JS，我会建议一些更可行的方法，但即便如此我也不相信它会起作用。

            回答 #5

赞同：0

时间：2013-01-20T18:39:06.660

这适用于 jQuery。

```
var val;
$('[YOUR_SELECTOR]').hover(function() {
    val = $(this).attr('title');
    $(this).removeAttr('title');
  },function() {
    $(this).attr('title',val);
}) 
```

            回答 #6

赞同：-1

时间：2009-05-01T01:12:08.100

我的浏览器中的链接不会显示类似的工具提示，除非它们具有`title`属性。

如果你愿意，你可以使用[Greasemonkey](https://addons.mozilla.org/en-US/firefox/addon/748)在每个页面上运行这段 javascript 来删除它们。

```
var anchorTags;
anchorTags = document.getElementsByTagName("a");
for(var i = 0; i < anchorTags.length; i++) {
  anchorTags[i].removeAttribute("title");
} 
```

        python - 在 Python 2.6 中使用 unicode_literals 的任何陷阱？

ID：809796

赞同：101

时间：2009-05-01T00:56:37.200

标签：python, unicode, python-2.6, unicode-literals

我们已经让我们的代码库在 Python 2.6 下运行。为了准备 Python 3.0，我们开始添加：

```
从 __future__ 导入 unicode_literals

```

到我们的`.py`文件中（当我们修改它们时）。我想知道是否有其他人一直在这样做并且遇到了任何不明显的问题（可能是在花了很多时间调试之后）。

            回答 #1

赞同：101

时间：2009-05-05T23:52:06.657

我在使用 unicode 字符串时遇到的问题的主要来源是当您将 utf-8 编码字符串与 unicode 字符串混合时。

例如，考虑以下脚本。

二.py

```
# encoding: utf-8
name = 'helló wörld from two' 
```

一个.py

```
# encoding: utf-8
from __future__ import unicode_literals
import two
name = 'helló wörld from one'
print name + two.name 
```

运行的输出`python one.py`是：

```
Traceback (most recent call last):
  File "one.py", line 5, in <module>
    print name + two.name
UnicodeDecodeError: 'ascii' codec can't decode byte 0xc3 in position 4: ordinal not in range(128) 
```

在这个例子中，`two.name`是一个 utf-8 编码的字符串（不是 unicode），因为它没有 import `unicode_literals`，并且`one.name`是一个 unicode 字符串。当您混合使用两者时，python 会尝试解码编码的字符串（假设它是 ascii）并将其转换为 unicode 并失败。如果你这样做了，它会起作用`print name + two.name.decode('utf-8')`。

如果您对字符串进行编码并稍后尝试混合它们，也会发生同样的事情。例如，这有效：

```
# encoding: utf-8
html = '<html><body>helló wörld</body></html>'
if isinstance(html, unicode):
    html = html.encode('utf-8')
print 'DEBUG: %s' % html 
```

输出：

```
DEBUG: <html><body>helló wörld</body></html> 
```

但是在添加之后`import unicode_literals`它不会：

```
# encoding: utf-8
from __future__ import unicode_literals
html = '<html><body>helló wörld</body></html>'
if isinstance(html, unicode):
    html = html.encode('utf-8')
print 'DEBUG: %s' % html 
```

输出：

```
Traceback (most recent call last):
  File "test.py", line 6, in <module>
    print 'DEBUG: %s' % html
UnicodeDecodeError: 'ascii' codec can't decode byte 0xc3 in position 16: ordinal not in range(128) 
```

它失败了，因为它`'DEBUG: %s'`是一个 unicode 字符串，因此 python 尝试解码`html`。修复打印的几种方法是执行`print str('DEBUG: %s') % html`或`print 'DEBUG: %s' % html.decode('utf-8')`.

我希望这可以帮助您了解使用 unicode 字符串时的潜在问题。

            回答 #2

赞同：16

时间：2009-11-24T10:10:01.817

同样在 2.6（python 2.6.5 RC1+ 之前）中，unicode 文字不能很好地与关键字参数（[issue4978](http://bugs.python.org/issue4978)）配合使用：

例如，以下代码可以在没有 unicode_literals 的情况下工作，但会因 TypeError 失败：`keywords must be string`如果使用 unicode_literals。

```
 >>> def foo(a=None): pass
  ...
  >>> foo(**{'a':1})
  Traceback (most recent call last):
    File "<stdin>", line 1, in <module>
      TypeError: foo() keywords must be strings 
```

            回答 #3

赞同：13

时间：2009-05-05T20:09:56.817

我确实发现，如果您添加`unicode_literals`指令，您还应该添加以下内容：

```
 # -*- coding: utf-8 
```

到您的 .py 文件的第一行或第二行。否则行如：

```
 foo = "barré" 
```

导致错误，例如：

```
SyntaxError：第 198 行的文件 mumble.py 中的非 ASCII 字符“\xc3”，
 但没有声明编码；见http://www.python.org/peps/pep-0263.html
 详情

```

            回答 #4

赞同：7

时间：2010-10-21T11:51:19.223

还要考虑到`unicode_literal`会影响`eval()`但不会影响`repr()`（恕我直言是一个错误的不对称行为），即`eval(repr(b'\xa4'))`不等于`b'\xa4'`（就像 Python 3 那样）。

理想情况下，以下代码将是一个不变量，它应该始终适用于`unicode_literals`Python {2.7, 3.x} 用法的所有组合：

```
from __future__ import unicode_literals

bstr = b'\xa4'
assert eval(repr(bstr)) == bstr # fails in Python 2.7, holds in 3.1+

ustr = '\xa4'
assert eval(repr(ustr)) == ustr # holds in Python 2.7 and 3.1+ 
```

第二个断言恰好起作用，因为在 Python 2.7 中`repr('\xa4')`计算为。`u'\xa4'`

            回答 #5

赞同：5

时间：2013-09-18T12:48:43.330

还有更多。

有一些库和内置函数需要不容忍 unicode 的字符串。

两个例子：

内置：

```
myenum = type('Enum', (), enum) 
```

（有点深奥）不适用于 unicode_literals：type() 需要一个字符串。

图书馆：

```
from wx.lib.pubsub import pub
pub.sendMessage("LOG MESSAGE", msg="no go for unicode literals") 
```

不起作用：wx pubsub 库需要一个字符串消息类型。

前者是深奥的，很容易用

```
myenum = type(b'Enum', (), enum) 
```

但如果你的代码充满了对 pub.sendMessage() 的调用（我的就是这样），后者是毁灭性的。

该死的，嗯？！？

            回答 #6

赞同：0

时间：2019-01-24T09:53:39.213

`from __future__ import unicode_literals`如果在您使用的地方导入了任何模块，[Click 将在所有地方引发 unicode 异常](https://click.palletsprojects.com/en/7.x/python3/#unicode-literals)`click.echo`。这是一场噩梦……</p>

        c# - WPF：当用户按下关闭按钮 [X] 时是否会触发事件？

ID：809801

赞同：1

时间：2009-05-01T00:57:51.610

标签：c#, wpf, events

当用户按下关闭按钮时是否会触发事件？

这是因为当手动关闭窗口（使用该方法）以及当用户按下 [X] 按钮`Closing`时都会触发 Window 事件......但我不知何故只需要知道用户何时按下 [X] 按钮`Close`不是在手动关闭窗口时。

            回答 #1

赞同：2

时间：2009-05-01T01:08:31.210

我不相信有一种方法可以在 WPF 中区分它们（尽管我并不肯定）。

我一直在 WinForms 中处理它的方式是创建一个成员变量“_Closing”，将其设置为 false，以及一个将 _Closing 设置为 true 的方法“ReallyClose()”，然后调用 Close。如果 _Closing 未设置为 true，我的 Closing 处理程序将取消关闭。

是的，这有点像黑客，但它确实有效。

            回答 #2

赞同：0

时间：2009-05-01T01:14:54.333

我也不认为有办法区分它们。您可以在 Application.Exit 事件上放置一个处理程序，但它不区分“红色 X 按钮关闭”和“alt-F4 关闭”（或您正在考虑的任何其他类型的关闭）。

顺便说一句，如果您检查 Application.Exit，请务必检查 Application.SessionEnding - 如果有人在您的应用程序运行时注销，则不能保证会调用 Application.Exit。

            回答 #3

赞同：0

时间：2016-07-25T15:03:17.913

尝试在您的类中放置名称为 Cancel 和 bool 变量的按钮，这样当您单击按钮时，将其设置为 true 并在关闭事件中检查是否为 true，使用 e.Cancel=false 退出窗口我尝试了一切，但它不起作用对我来说，我就是这样做的，如果你插入一些信息，你也可以删除 X 按钮，只是为了让接受或取消按钮。

        regex - 使用 Perl，如何使用每个数组元素内的数字值对数组进行排序？

ID：809804

赞同：4

时间：2009-05-01T00:58:39.363

标签：regex, perl, algorithm, sorting

假设我有一个数组 @theArr，它包含 1,000 个左右的元素，如下所示：

```
01  '12 16 sj.1012804p1012831.93.gz'
02  '12 16 sj.1012832p1012859.94.gz'
03  '12 16 sj.1012860p1012887.95.gz'
04  '12 16 sj.1012888p1012915.96.gz'
05  '12 16 sj.1012916p1012943.97.gz'
06  '12 16 sj.875352p875407.01.gz'
07  '12 16 sj.875408p875435.02.gz'
08  '12 16 sj.875436p875535.03.gz'
09  '12 16 sj.875536p875575.04.gz'
10  '12 16 sj.875576p875603.05.gz'
11  '12 16 sj.875604p875631.06.gz'
12  '12 16 sj.875632p875659.07.gz'
13  '12 16 sj.875660p875687.08.gz'
14  '12 16 sj.875688p875715.09.gz'
15  '12 16 sj.875716p875743.10.gz'
... 
```

如果我的第一组数字（在“sj.”和“p”之间）总是 6 位数字，我不会有问题。但是，当数字翻转为 7 位数字时，默认排序将停止工作，因为较大的 7 位数字排在较小的 6 位数字之前。

有没有办法告诉 Perl 在每个数组元素的字符串中按该数字排序？

            回答 #1

赞同：18

时间：2009-05-01T01:06:57.987

看起来你需要一个[Schwartzian 变换](http://en.wikipedia.org/wiki/Schwartzian_transform)：

```
#!/usr/bin/perl

use strict;
use warnings;

my @a = <DATA>;

print 
    map  { $_->[1] }                #get the original value back
    sort { $a->[0] <=> $b->[0] }    #sort arrayrefs numerically on the sort value
    map  { /sj\.(.*?)p/; [$1, $_] } #build arrayref of the sort value and orig
    @a;

__DATA__
12 16 sj.1012804p1012831.93.gz
12 16 sj.1012832p1012859.94.gz
12 16 sj.1012860p1012887.95.gz
12 16 sj.1012888p1012915.96.gz
12 16 sj.1012916p1012943.97.gz
12 16 sj.875352p875407.01.gz
12 16 sj.875408p875435.02.gz
12 16 sj.875436p875535.03.gz
12 16 sj.875536p875575.04.gz
12 16 sj.875576p875603.05.gz
12 16 sj.875604p875631.06.gz
12 16 sj.875632p875659.07.gz
12 16 sj.875660p875687.08.gz
12 16 sj.875688p875715.09.gz
12 16 sj.875716p875743.10.gz 
```

            回答 #2

赞同：3

时间：2009-05-01T01:11:47.600

您可以使用正则表达式从传递给排序函数的块内的每一行中提取数字：

```
@newArray = sort { my ($anum,$bnum); $a =~ /sj\.([0-9]+)p/; $anum = $1; $b =~ /sj\.(\d+)p/; $bnum = $1; $anum <=> $bnum } @theArr; 
```

然而，查斯。Owens 的解决方案更好，因为它只为每个元素匹配一次正则表达式。

            回答 #3

赞同：2

时间：2009-05-01T01:12:43.090

这是一个将它们升序排序的示例，假设您不太关心效率：

```
use strict;

my @theArr = split(/\n/, <<END_SAMPLE);
12 16 sj.1012804p1012831.93.gz
12 16 sj.1012832p1012859.94.gz
12 16 sj.1012860p1012887.95.gz
12 16 sj.1012888p1012915.96.gz
12 16 sj.1012916p1012943.97.gz
12 16 sj.875352p875407.01.gz
12 16 sj.875408p875435.02.gz
12 16 sj.875436p875535.03.gz
12 16 sj.875536p875575.04.gz
12 16 sj.875576p875603.05.gz
END_SAMPLE

my @sortedArr = sort compareBySJ @theArr;

print "Before:\n".join("\n", @theArr)."\n";
print "After:\n".join("\n", @sortedArr)."\n";

sub compareBySJ {
    # Capture the values to compare, against the expected format
    # NOTE: This could be inefficient for large, unsorted arrays
    #       since you'll be matching the same strings repeatedly
    my ($aVal) = $a =~ /^\d+\s+\d+\s+sj\.(\d+)p/
        or die "Couldn't match against value $a";
    my ($bVal) = $b =~ /^\d+\s+\d+\s+sj\.(\d+)p/
        or die "Couldn't match against value $a";

    # Return the numerical comparison of the values (ascending order)
    return $aVal <=> $bVal;
} 
```

输出：

```
Before:
12 16 sj.1012804p1012831.93.gz
12 16 sj.1012832p1012859.94.gz
12 16 sj.1012860p1012887.95.gz
12 16 sj.1012888p1012915.96.gz
12 16 sj.1012916p1012943.97.gz
12 16 sj.875352p875407.01.gz
12 16 sj.875408p875435.02.gz
12 16 sj.875436p875535.03.gz
12 16 sj.875536p875575.04.gz
12 16 sj.875576p875603.05.gz
After:
12 16 sj.875352p875407.01.gz
12 16 sj.875408p875435.02.gz
12 16 sj.875436p875535.03.gz
12 16 sj.875536p875575.04.gz
12 16 sj.875576p875603.05.gz
12 16 sj.1012804p1012831.93.gz
12 16 sj.1012832p1012859.94.gz
12 16 sj.1012860p1012887.95.gz
12 16 sj.1012888p1012915.96.gz
12 16 sj.1012916p1012943.97.gz 
```

            回答 #4

赞同：1

时间：2009-05-01T01:08:18.530

是的。[sort](http://perldoc.perl.org/5.8.8/functions/sort.html)函数采用一个可选的比较函数，用于比较两个元素。它可以采用代码块或要调用的函数名称的形式。

链接文档中有一个与您想要执行的操作类似的示例：

```
# inefficiently sort by descending numeric compare using
# the first integer after the first = sign, or the
# whole record case-insensitively otherwise

@new = sort {
($b =~ /=(\d+)/)[0] <=> ($a =~ /=(\d+)/)[0]
            ||
            uc($a)  cmp  uc($b)
} @old; 
```

        xcode - 如何在文件系统上映射相同的 Xcode 中的组

ID：809806

赞同：5

时间：2009-05-01T00:59:35.367

标签：xcode

我有点不知如何正确地问这个问题。基本上，我希望这些组在物理上转换为文件系统上的目录，而不是 Xcode“智能组”。这是如何在 Xcode 3.1.2 中完成的？

            回答 #1

赞同：4

时间：2009-05-18T20:56:34.517

在 Xcode 中，文件结构有点用词不当，您在 Xcode 项目中看到的结构是项目的引用映射，而不是项目所在结构的关系映射。例如，如果您在项目的根目录中创建一个名为“foo”的组，这将创建对由项目设置管理的容器“foo”的引用，它不会创建名为“foo”的文件夹在文件系统中您的应用程序所在的根目录中。这是许多使用 Xcode 的开发人员争论的焦点。

相反，我建议（正如@smorgan 所避免的那样）您在文件系统（Finder）的项目文件夹中创建文件夹结构，例如，导航到您的项目并创建文件夹“bar”。然后在您的项目中控制并单击项目并选择 ADD > Existing Files... 并选择文件夹。这会将“bar”文件夹导入您的项目 - 实际上只是为您的项目中的所述位置创建一个名为“bar”的引用指针。

如果您是喜欢为您的项目拥有标准或定义结构的人，请创建一个项目文件夹以及您通常拥有的所有文件夹和子文件夹 - 项目骨架/树。这可能在根目录下有 Source 和 Resources，然后在 Resources 内，您可能还有其他文件夹，例如 Images、Audio、Views、Cells 等……您的 Source 文件夹可能有 UI、Model、Util 等……而 UI 可能有开始、设置、应用程序等...一旦定义了默认项目文件夹，将根文件夹压缩并命名为“XCode Project Outline”之类的名称或对您有意义的名称。

当您有一个即将开始的新项目时，将 ZIP 文件复制到您希望项目所在的位置，然后简单地解压缩文件并将文件夹命名为项目名称。然后在文件夹中创建新的项目文件，然后按照 ADD Existing File.../Folders... （递归=选中），它将整个项目文件夹层次结构添加到项目中。为了更高级的魔法；包括非特定于应用程序的常见应用程序框架位，并将这些文件包含在 ZIP 文件中。然后，当您解压缩并添加文件夹层次结构时，您还可以快速轻松地添加基本文件（.h、.m 等...）。

我应该提到的一件事是，如果您从一个已经拥有的项目开始并且该项目处于版本控制之下，那么您最好从您的存储库中“导出”该项目。这将基于 (head) 中的当前版本构建所有文件，并删除所有隐藏的 .svn 引用。然后，您可以根据需要修剪和修改该文件夹，以创建您的项目文件夹模板 ZIP 文件。祝你好运，编码愉快！

            回答 #2

赞同：1

时间：2009-05-01T01:56:35.947

如果我正确理解您要查找的内容，答案是右键单击“组和文件”列中的项目，选择“添加”>“现有文件...”，然后选择要映射的根文件夹。在将弹出的选项表中，将默认的“为任何添加的文件夹递归创建组”更改为“为任何添加的文件夹创建文件夹引用”。

        c++ - 如何在 Visual Studio 2005 中禁止警告 4200？

ID：809807

赞同：1

时间：2009-05-01T01:00:46.550

标签：c++, visual-studio, visual-studio-2005, visual-c++-2005, suppress-warnings

我可以在 C/C++ 高级属性页中禁止 Visual Studio 2005 SP1 中的许多警告，这会导致 IDE 在调用编译器的命令行上使用 /wd 开关。但是，当我尝试禁止警告 4200（使用了非标准扩展：结构/联合中的零大小数组）时，它仍然在我编译时出现。（当然这是有道理的；我只是无法修复代码，也不值得打扰，因为**它是生成的**，并且警告在这种情况下完全是良性的。）有没有人碰巧知道这是否是编译器中的错误？或者我可以做些什么？

            回答 #1

赞同：3

时间：2009-05-01T01:02:56.873

要完全禁用文件中的警告，您可以将以下内容添加到文件顶部

```
#pragma warning(disable:2400) 
```

如果您想要文件的全面禁用以外的更多灵活性，以下页面列出了其他几个更细粒度的选项。

*   [http://msdn.microsoft.com/en-us/library/2c8f766e(VS.80).aspx](http://msdn.microsoft.com/en-us/library/2c8f766e(VS.80).aspx)

根据您的信息尚不清楚这是编译器中的错误还是配置问题。我倾向于配置问题，特别是冲突的编译器选项，这使得抑制警告变得困难。  

**编辑** 

OP 提到他们无法控制生成的代码，因此他们不能直接包含编译指示。如果是这种情况，那么试试这个技巧。假设文件名为 Generated.cpp。不再包含 Generated.cpp 作为要编译的文件之一。而是创建一个名为 Example.cpp 的新文件，其中包含以下内容

```
#pragma warning(disable:2400)
#include "Generated.cpp" 
```

现在，您只需编译 Example.cpp 即可获得带有禁用警告的 Generated.cpp 文本。

            回答 #2

赞同：1

时间：2009-05-01T01:04:49.350

你的意思是和[pragma](http://msdn.microsoft.com/en-us/library/d9x1s805.aspx)一样？

```
#pragma warning( disable : 2400 ) 
```

        python - 如何在 pygtk 中使用线程

ID：809818

赞同：5

时间：2009-05-01T01:05:26.837

标签：python, multithreading, pygtk

我对 pygtk 中的线程有疑问。我的应用程序包含一个从 Internet 下载图片然后使用 pygtk 显示的程序。问题是，为了做到这一点并保持 GUI 响应，我需要使用线程。

因此，在用户单击“下载图片”按钮后，我进入了回调，我调用了该方法来下载同一类中的图片。

thread.start_new_thread（self.images_download，（路径，页面）

这行不通。我让我的程序进入线程的唯一方法是使用

gtk.threads_init()

在开始任何线程之前。现在它下载了图片，但 GUI 仍然没有响应。我用谷歌搜索了这个并尝试将 gtk.threads_enter 和 gtk.threads_leave 放在线程周围，但它不起作用。

            回答 #1

赞同：12

时间：2009-05-01T10:03:37.993

你的问题有点模糊，如果没有参考你的实际代码，很难推测你做错了什么。

所以我会给你一些阅读的建议，然后根据经验进行疯狂的推测。

首先，您似乎认为您只能通过使用线程来保持 GUI 响应。这不是真的。您还可以异步编写代码，并在单线程应用程序中完成所有操作。  [Twisted](http://twistedmatrix.com "扭曲的")建立在这种编程模型之上。我最近[发表了一篇博文](http://thomas.apestaart.org/log/?p=851)，解释了我如何创建异步任务接口，以及 CLI 和 GTK+ 的示例运行器。您可以查看这些示例以了解如何异步实现任务，并且 UI 仍会更新。

其次，如果您出于某种原因更喜欢使用线程，则需要稍微了解 GTK+ 线程模型。

您应该首先阅读[有关该主题的 PyGTK 常见问题解答条目](http://faq.pygtk.org/index.py?file=faq20.006.htp&req=show)，并且您可能会发现[这篇博](http://unpythonic.blogspot.com/2007/08/using-threads-in-pygtk.html)文也很容易理解。

现在，开始猜测。我猜您正在尝试从线程更新您的 GTK UI，并且没有正确处理锁定。如果是这种情况，您最好现在使用 gobject.idle_add() 将您想要从线程执行的所有 UI 更新推迟到主线程。这样，所有 UI 调用都将从主线程进行。在您的编程中，这是一个更容易遵循的思维模型。

一旦你觉得你真正了解线程和锁定模型，你可以考虑从你的线程更新 UI，但很容易错过threads_enter()/threads_leave()

            回答 #2

赞同：1

时间：2009-05-23T03:32:33.280

您可以使用 gtk.gdk.threads_init() 以允许任何线程使用相应的 gtk.gdk.threads_enter() 和 gtk.gdk.theads_leave() 锁修改 UI，但是，这样做的问题是在 Windows 上运行良好。我已经在 Linux 上对其进行了测试并且性能相当不错，但是我没有运气让它在 win32 上运行。

=== 编辑 ===

我一直在浏览这个，你可以使用 gobject.io_add_watch 来检查你的套接字中是否有东西，抓住它然后更新 GUI。查看我的帖子： 
 [Sockets (and some other files) and PyGTK without threads。](http://islascruz.org/html/index.php?Blog/SingleView/id/Sockets-%28and-some-other-files%29-and-PyGTK-without-threads.)

        iis-7 - 我可以以编程方式定义我的 IIS7 站点绑定（例如 foo.domain.com）吗？

ID：809826

赞同：4

时间：2009-05-01T01:08:10.510

标签：iis-7, web-config

对于我的 IIS7 网站，我必须进入 IIS7 服务管理器并定义该站点的所有绑定。工作正常。

我想知道是否可以在 web.config 文件中以编程方式执行此操作？我知道您可以在其中提供一些 iis7 设置。不确定是否还可以包含绑定？

例如。

1.  http; 所有未分配的IP；端口 80；foo.domain.com
2.  HTTPS；192.168.0.2；端口 443；blah.domain.com

            回答 #1

赞同：2

时间：2011-10-17T18:57:45.573

该配置在父 applicationHost.config 的配置文件中找到，但我不确定它是否可以被覆盖。例如，在 IIS Express 中，您要查找的部分是：

```
<system.applicationHost>
...

    <sites>
        <site name="Development Web Site" id="1" serverAutoStart="true">
            <application path="/">
                <virtualDirectory path="/" physicalPath="%IIS_BIN%\AppServer\empty_wwwroot" />
            </application>
            <bindings>
                <binding protocol="http" bindingInformation=":8080:localhost" />
            </bindings>
        </site>
        <siteDefaults>
            <logFile logFormat="W3C" directory="%IIS_USER_HOME%\Logs" />
            <traceFailedRequestsLogging directory="%IIS_USER_HOME%\TraceLogFiles" enabled="true" maxLogFileSizeKB="1024" />
        </siteDefaults>
        <applicationDefaults applicationPool="IISExpressAppPool" />
        <virtualDirectoryDefaults allowSubDirConfig="true" />
    </sites>

</system.applicationHost> 
```

您可以尝试运行（抱歉 - 我自己没有尝试过任何这些）：

%windir%\system32\inetsrv\appcmd.exe 解锁配置-section:system.applicationHost

但是从安全的角度来看，允许 web.configs 单独与 system.applicationHost 混淆是没有意义的，因为一个站点的配置可能会破坏所有其他站点。

            回答 #2

赞同：1

时间：2009-05-01T01:40:12.103

查看 Microsoft.Web.Administration 命名空间。然后，您可以从 C# 代码配置和操作大部分 IIS 7。

还有一个实用程序[Appcmd](http://learn.iis.net/page.aspx/228/appcmdexe/)，它允许您操作 IIS 7.0 中的几乎所有内容。请注意，此工具具有大量选项和开关。我只将它用于最基本的任务，例如更改应用程序的物理目录。

        c++ - 这是什么编程技术？（升压库）

ID：809827

赞同：4

时间：2009-05-01T01:08:16.610

标签：c++, boost

我正在尝试从 boost 库的 program_options 中理解示例（[http://www.boost.org/doc/libs/1_38_0/doc/html/program_options/tutorial.html#id3761458](http://www.boost.org/doc/libs/1_38_0/doc/html/program_options/tutorial.html#id3761458)）

特别是这部分：

```
desc.add_options()
    ("help", "produce help message")
    ("compression", po::value<int>(), "set compression level")
; 
```

他到底在做什么？那是什么技术？

这部分 desc.add_options() 可能是一个函数调用，但另一个 () 如何适合这里？这是某种运算符重载吗？

谢谢！

            回答 #1

赞同：14

时间：2009-05-01T01:14:19.793

“add_options()”函数实际上返回一个[函子](http://en.wikipedia.org/wiki/Function_object)，即一个覆盖 () 运算符的对象。这意味着下面的函数调用

```
desc.add_options() ("help", "produce help message"); 
```

实际上扩展到

```
desc.add_options().operator()("help", "produce help message"); 
```

“operator()”还返回一个仿函数，以便可以将调用链接起来，如您所示。

            回答 #2

赞同：10

时间：2009-05-01T01:17:24.000

大概 add_options() 返回某种具有 operator() 重载以支持“链接”的仿函数（这是一种非常有用的技术，顺便说一句）

重载 (...) 允许您创建一个像函数一样工作的类。

例如：

```
struct func
{
    int operator()(int x)
    {
        cout << x*x << endl;
    }
};

...

func a;
a(5); //should print 25 
```

但是，如果您让 operator() 返回*对 object 的引用*，那么您可以“链接”运算符。

```
struct func
{
    func& operator()(int x)
    {
        cout << x*x << endl;
        return *this;
    }
};

...

func a;
a(5)(7)(8); //should print 25 49 64 on separate lines 
```

由于 a(5) 返回 a，因此 (a(5))(7) 或多或少与 相同`a(5); a(7);`。

        visual-studio - Visual Studio 查找和替换变量

ID：809831

赞同：7

时间：2009-05-01T01:09:06.607

标签：visual-studio, variables, replace, find

我正在尝试用文本替换两个字母的状态缩写，然后是缩写。最终我想找到并替换其余的。如何捕获找到的值？....我试过 \1 和 {1}   

```
AL  32.2679134368897    -86.5251510620117
AR  35.2315113544464    -92.2926173210144
AZ  33.3440766538127    -111.955985217148
CO  39.7098631425337    -104.899092934348

if( usState == "AZ") dpos= "33.4736704187888" + " " + "-112.043138087587";
if( usState == "CA") dpos= "36.0783581515733" + " " + " -119.868895584259";
if( usState == "CO") dpos= "39.8950788035537" + " " + " -104.831521872318";
if( usState == "CT") dpos= "41.6001570945562" + " " + " -72.6606015937273"; 
```

更新 $1 不起作用。

我发现： [AZ][AZ] 替换为： if( usState == "$1

            回答 #1

赞同：7

时间：2009-05-01T02:11:04.743

奇怪的是，Visual Studio 正则表达式与普通的 .Net 正则表达式不同。它们的标记和替换语法略有不同。为了标记一段文本以供以后匹配，您必须将其包裹在大括号 {} 中。然后您可以在替换字符串中使用 \n ，其中 n 是第 n 个标记表达式。对于您的场景，这里是您应该使用的字符串

*   寻找：`{[A-Z][A-Z]}`
*   代替：`if( usState == "\1")`

            回答 #2

赞同：4

时间：2009-05-01T01:11:45.183

我的正则表达式匹配器匹配 $1。试试看。

            回答 #3

赞同：1

时间：2009-05-01T01:53:49.013

我可能不明白你的问题，但你为什么不记录一个临时宏来做转换呢？

            回答 #4

赞同：1

时间：2018-03-19T16:16:27.787

由于这个问题似乎与[https://stackoverflow.com/a/3147177/154480](https://stackoverflow.com/a/3147177/154480)重复，但我首先找到了这个问题：从 Visual Studio 2012 开始，您可以使用`(pattern)`和`$1`. 作为这个特定问题的一个例子，`([A-Z]{2})`找到`if( usState == "$1")`

            回答 #5

赞同：0

时间：2009-05-01T01:47:39.557

将 [AZ][AZ] 括在括号中，以捕获它；然后，在替换字符串中使用 \1 来引用捕获。

        math - 如何计算多面体的质量和转动惯量？

ID：809832

赞同：6

时间：2009-05-01T01:09:51.083

标签：math, physics, rigid-bodies

为了在刚体模拟中使用，我想计算质量和惯性张量（惯性矩），给定一个三角形网格表示（不一定是凸的）对象的边界，并假设内部的密度恒定。

            回答 #1

赞同：11

时间：2009-05-01T02:18:45.677

假设您的修剪是*封闭*的（无论是否凸出），有一种方法！

正如 dmckee 指出的那样，一般的方法是从每个表面三角形构建四面体，然后应用显而易见的数学计算每个 tet 的质量和力矩贡献。当从任何参考点观察时，当身体表面有凹面时，技巧就出现了，这些凹面会形成内部口袋。

所以，开始时，选择一些参考点（模型坐标中的原点可以正常工作），它甚至不需要在身体内部。对于每个三角形，将该三角形的三个点连接到参考点以形成一个四面体。*诀窍是：使用三角形的表面法线来确定三角形是面向还是背离参考点（您可以通过查看法线的点积*的符号和指向三角形）。如果三角形背离参考点，则正常处理其质量和力矩，但如果它面向参考点（表明参考点和实体之间存在开放空间），则否定该 tet 的结果.

实际上，这样做是过度计算体积块，然后在这些区域显示不是实体的一部分时进行纠正。如果一个身体有很多油脂状的凸缘和怪诞的褶皱（有那个图像吗？），一个特定的体积可能会被一个很大的因素高估，但如果你的网格是，它会被减去足够的时间来抵消它关闭。以这种方式工作，您甚至可以处理对象中的内部空间气泡（假设法线设置正确）。最重要的是，每个三角形都可以独立处理，因此您可以随意并行化。享受！

事后思考：您可能想知道当该点积给您的值为零或接近零时会发生什么。这只发生在三角形面平行（其法线垂直）指向参考点的方向时——这只会发生在面积小或为零的退化 tets 上。也就是说，增加或减去 tet 的贡献的决定只有在 tet 无论如何都不打算贡献任何东西时才值得怀疑。

            回答 #2

赞同：2

时间：2009-05-01T01:18:11.500

将您的对象分解为一组围绕选定内部点的[四面体。](http://en.wikipedia.org/wiki/Tetrahedron)（即使用每个三角形面元素和所选中心的实体。）

您应该能够查看每个元素的体积。[惯性矩](http://number-none.com/blow/inertia/bb_inertia.doc)也应该可用。

如果表面是非凸的，那就更麻烦了。

我似乎记错了命名法，而 skew 不是我想要的形容词。我的意思是非常规。

            回答 #3

赞同：2

时间：2011-03-13T10:19:22.347

这在 D. Eberly 的“游戏物理学，第二版”一书中有所介绍。第[2.5.5 章和](http://www.geometrictools.com/LibPhysics/RigidBody/RigidBody.html)示例代码可在线获取。（刚找到，还没试过。）

另请注意，多面体不必是凸的公式才能起作用，它只需[简单](http://mathworld.wolfram.com/SimplePolyhedron.html)。

            回答 #4

赞同：1

时间：2009-05-01T01:13:36.113

我会看看[vtkMassProperties。](http://www.vtk.org/doc/release/4.0/html/classvtkMassProperties.html)  给定一个包含一个体积的表面，这是一个相当稳健的计算算法。

            回答 #5

赞同：1

时间：2009-05-17T00:49:51.267

如果您的多面体很复杂，请考虑使用蒙特卡罗积分，该积分通常用于多维积分。您将需要一个封闭的超立方体，并且您将需要能够测试给定点是在多面体内部还是外部。您需要耐心等待，因为蒙特卡洛积分很慢。

像往常一样从 Wikipedia 开始，然后按照外部链接页面进行进一步阅读。

（对于那些不熟悉蒙特卡洛积分的人，这里是计算质量的方法。在包含的超立方体中选择一个点。添加到`point_total`计数器中。它在多面体中吗？如果是，添加到`point_internal`计数器中。做这个很多（见收敛和误差范围估计。）然后

`mass_polyhedron/mass_hypercube \approx points_internal/points_total`.

对于惯性矩，您可以通过点到参考轴的距离的平方对每个计数进行加权。

棘手的部分是测试一个点是在多面体内部还是外部。我确信有计算几何算法。

        python - 用于查找 MediaWiki 标记链接内容的 Python 正则表达式

ID：809837

赞同：3

时间：2009-05-01T01:11:52.157

标签：python, regex, mediawiki

如果我有一些 xml 包含以下 mediawiki 标记之类的内容：

“ ...收集于 12 世纪，其中 [[亚历山大大帝]] 是英雄，他在其中的代表，有点像英国 [[亚瑟王|亚瑟]]”

什么是适当的论点，例如：

`re.findall([[__?__]], article_entry)`

我在转义双方括号并获得正确的文本链接时有点磕磕绊绊，例如：`[[Alexander of Paris|poet named Alexander]]`

            回答 #1

赞同：5

时间：2009-05-01T01:20:08.580

这是一个例子

```
import re

pattern = re.compile(r"\[\[([\w \|]+)\]\]")
text = "blah blah [[Alexander of Paris|poet named Alexander]] bldfkas"
results = pattern.findall(text)

output = []
for link in results:
    output.append(link.split("|")[0])

# outputs ['Alexander of Paris'] 
```

版本 2 将更多内容放入正则表达式，但结果更改了输出：

```
import re

pattern = re.compile(r"\[\[([\w ]+)(\|[\w ]+)?\]\]")
text = "[[a|b]] fdkjf [[c|d]] fjdsj [[efg]]"
results = pattern.findall(text)

# outputs [('a', '|b'), ('c', '|d'), ('efg', '')]

print [link[0] for link in results]

# outputs ['a', 'c', 'efg'] 
```

版本 3，如果您只想要没有标题的链接。

```
pattern = re.compile(r"\[\[([\w ]+)(?:\|[\w ]+)?\]\]")
text = "[[a|b]] fdkjf [[c|d]] fjdsj [[efg]]"
results = pattern.findall(text)

# outputs ['a', 'c', 'efg'] 
```

            回答 #2

赞同：1

时间：2009-05-01T01:52:23.103

**正则表达式：** \w+( \w+)+(?=]])

**输入**

[[巴黎的亚历山大|名叫亚历山大的诗人]]

**输出**

诗人亚历山大

**输入**

[[巴黎的亚历山大]]

**输出**

巴黎的亚历山大

            回答 #3

赞同：1

时间：2009-05-01T01:57:28.473

```
import re
pattern = re.compile(r"\[\[([\w ]+)(?:\||\]\])")
text = "of which [[Alexander the Great]] was somewhat like [[King Arthur|Arthur]]"
results = pattern.findall(text)
print results 
```

会给输出

```
["Alexander the Great", "King Arthur"] 
```

            回答 #4

赞同：1

时间：2009-05-01T04:23:25.750

如果您尝试从一个页面获取所有链接，当然如果可能的话，使用 MediaWiki API 会容易得多，例如[http://en.wikipedia.org/w/api.php?action=query&prop=链接&标题=Stack_Overflow_(网站)](http://en.wikipedia.org/w/api.php?action=query&prop=links&titles=Stack_Overflow_%28website%29)。

请注意，这两种方法都缺少嵌入在模板中的链接。

        web-services - 如何从 SharePoint Web 服务更新 spFieldUserValue 类型的字段

ID：809842

赞同：0

时间：2009-05-01T01:13:08.110

标签：web-services, sharepoint, moss

我正在尝试更新 spFieldUserValue 类型的字段，你知道的，PeoplePicker。

相关代码是

```
batchElement.InnerXml = "<Method ID='1' Cmd='Update'>" +
    "<Field Name='ID'>1</Field>" +
    "<Field Name='APersonField'>32;#This is pretty much ignored</Field>" +
    "<Field Name='Title'>Wow edited!</Field></Method>";
result = listService.UpdateListItems(strListID, batchElement); 
```

由于我的代码成功地使用该网站的 No.32 更新了 APersonField（为了澄清，他们没有被命名为“这几乎被忽略了”，这似乎被忽略了。

无论如何，如果给定格式 [域] [用户] 的帐户名称，我将如何在仅使用 Web 服务的站点安全性中找到他们的查找 ID 的相关号码？

            回答 #1

赞同：2

时间：2009-05-01T01:27:42.833

我相信这个数字是网站内的用户 ID。这可以通过调用使用用户和组 Web 服务来确定`UserGroup.GetUserInfo`（有关详细信息，请参阅[此 MSDN 页面](http://msdn.microsoft.com/en-us/library/ms774637.aspx)）

        javascript - 是否可以从在javascript中？

ID：809851

赞同：2

时间：2009-05-01T01:16:38.587

标签：javascript, file-upload

是否可以读取已使用文件输入控件选择的文件的内容？我想做类似的事情：

```
<input type="file" id="fileInput" onblur="readFile(this)"/>

<script language="javascript">
   function readFile(file) {
     document.write(file);
   }
</script> 
```

这样的事情可能吗？还是文件上传只是将文件发送到服务器。

            回答 #1

赞同：2

时间：2009-05-01T01:25:35.400

它在[Firefox](https://developer.mozilla.org/en/nsIDOMFile)中是可能的，但它不是标准化的，所以它不可能跨浏览器移植（例如，WebKit 不支持它）。您最好的选择可能是将文件上传到服务器，然后使用`XMLHTTPRequest`.

            回答 #2

赞同：1

时间：2009-05-01T06:55:25.747

如果您使用 HTA（超文本终端应用程序，请参阅[http://msdn.microsoft.com/en-us/library/ms536496(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms536496(VS.85).aspx)），则可以。如果这样做，您将绑定到 Internet Explorer，但可以自由访问文件、注册表等。（当然）存在安全问题。

            回答 #3

赞同：0

时间：2009-05-01T04:49:31.837

在许多浏览器中可能是不可能的。如果我们让 arbitraty javascript 能够使用用户的凭据读取文件系统中的任意文件，会发生什么？坏事。恶意 javascript 可以轻松获取文件数据并将其发送回服务器，在后台悄悄地窥探您的所有文件。

我怀疑这是可能的，我强烈建议不要这样做。

如果它需要专门用于客户端，那么您为什么要使用 Web 应用程序呢？唯一可以显示的文件是纯文本文件，有许多更简单的查看内容的方法。

        asp.net - 在 ASP.net 中反转图像透明度

ID：809856

赞同：1

时间：2009-05-01T01:19:33.807

标签：asp.net, image-processing

我正在尝试构建一个允许我获取输入图像并从中生成蒙版的页面。输入将是具有透明背景的索引 PNG。生成的图像将是黑色的，原始图像是透明的，而原始图像是不透明的则是透明的。

我已经在 asp.net 中进行了一些非常基本的图像处理，但我不确定如何进行。我希望有一些比逐个像素更快的解决方案。

如果有人能指出我正确的方向，我将不胜感激。

            回答 #1

赞同：1

时间：2009-05-01T01:25:39.843

您可能应该研究转换。

[http://en.csharp-online.net/GDIplus_Graphics_Transformation%E2%80%94Image_Transformation](http://en.csharp-online.net/GDIplus_Graphics_Transformation%E2%80%94Image_Transformation)

            回答 #2

赞同：0

时间：2009-05-01T15:05:06.490

好的，我有一个使用转换的工作解决方案。老实说，我不是 100% 了解我在用颜色矩阵做什么 - 所以我这样做的方式可能不是最佳的。代码粘贴在下面，以防其他人遇到同样的问题。

基本上，转换使透明像素变黑，彩色像素变白。然后我在白色像素上使用 MakeTransparent。应该有一种方法可以一步完成，但不幸的是，今天它超出了我的范围

再次感谢克里斯-我一直在寻找几个小时来寻找一种可行的技术，但我没有遇到任何关于这种类型的转换。

```
<%@ page language="vb" contenttype="image/png" %>

<%@ Import Namespace="System.IO" %>
<%@ import namespace="system.drawing" %>
<%@ import namespace="system.drawing.imaging" %>
<%@ import namespace="system.drawing.drawing2d" %>

<script runat="server">
    Sub Page_Load()
        Dim tmpImage As Bitmap = Bitmap.FromFile(Server.MapPath("test.png"))
        Dim input As Bitmap = New Bitmap(tmpImage.Width, tmpImage.Height, PixelFormat.Format32bppArgb)

        Dim trans As New ColorMatrix(New Single()() _
                       {New Single() {0, 1, 1, 1, 0}, _
                        New Single() {1, 0, 1, 1, 0}, _
                        New Single() {1, 1, 0, 1, 0}, _
                        New Single() {1, 1, 1, 1, 0}, _
                        New Single() {0, 0, 0,255, 1}})

        Dim attr As New ImageAttributes
        Dim rc As New Rectangle(0, 0, input.Width, input.Height)
        Dim out As New memorystream
        Dim g As Graphics = Graphics.FromImage(input)
        g.Clear(Color.Transparent)

        attr.SetColorMatrix(trans, System.Drawing.Imaging.ColorMatrixFlag.Default, System.Drawing.Imaging.ColorAdjustType.Bitmap)      
        g.DrawImage(tmpImage, rc, 0, 0, input.Width, input.Height, GraphicsUnit.Pixel, attr)
        input.makeTransparent(System.Drawing.Color.White)
        input.Save(out, ImageFormat.Png)
        g.Dispose()
        input.Dispose()
        tmpImage.Dispose()
        out.WriteTo(Response.OutputStream)
    End Sub

</script> 
```

        python - 代码可读性的最佳标签大小

ID：809859

赞同：23

时间：2009-05-01T01:21:40.587

标签：python, readability

除了个人喜好，是否有最佳的标签大小（2 个空格？3 个空格？8 个空格？）以提高代码的可读性？在我从事的不同项目中，人们似乎有截然不同的标准。我似乎无法阅读 2 个空格缩进，但像 Google 这样的公司使用它作为标准。

任何人都可以为标签的最佳大小指出文档、研究或有充分理由的论据吗？

如果我们想具体一点，我主要在 python 中工作。这个问题的目的是为我工作的团队选择一个标准。

            回答 #1

赞同：40

时间：2009-05-01T02:08:08.290

如果您是 Pythonista，则[四个空格且没有硬制表符。](https://david.goodger.org/projects/pycon/2007/idiomatic/handout.html#whitespace-1)

            回答 #2

赞同：13

时间：2009-05-01T01:48:31.053

我喜欢 8 个空格（我知道，对吗？）。它使块的开始/结束非常明显。

至于您的问题，需要进行正式的可用性研究。让我们看看限制：

**0 个空格**

```
function test(){
var x = 1;
for (i=0; i<=5; i++){
doSomething();
}
} 
```

没有缩进显然是不好的。你无法分辨任何事情的开始或结束。

**19 个空间**

```
function test(){
                   var x = 1;
                   for (i=0; i<=5; i++){
                                      doSomething();
                   }
} 
```

大量缩进显然也很糟糕，因为您无法将代码直观地链接到其父函数或循环（或您拥有的），因为您的周边视觉不会延伸那么远。你的眼睛必须前后晃动太远才能方便阅读。

**8个空格**

```
function test(){
        var x = 1;
        for (i=0; i<=5; i++){
                doSomething();
        }
} 
```

我想我决定使用 8 个空格，因为“函数”这个词有 8 个字符长。但它似乎对可读性非常有用。所有代码都在我的余光中，如果我快速扫描，我绝不会错过新代码块的开始。

            回答 #3

赞同：12

时间：2009-06-02T06:23:02.227

```
2 space 4 busy coder
3 space for heavy if statement using script kiddies 
4 space for those who make real money pressing space 4 times
8 space for the man in ties and suit who doesn't need to code 
```

            回答 #4

赞同：5

时间：2009-05-01T03:34:23.950

这种讨论经常涉及误解，因为（[正如 jwz 所描述的](http://www.jwz.org/doc/tabs-vs-spaces.html)）它通常涉及**三个不同的问题**：

*   当我`Tab`在文本编辑器中按下键时会发生什么？

*   当我要求我的编辑器缩进一行或多行时会发生什么？

*   当我查看包含 U+0009 水平制表符的文件时会发生什么？

我的回答：

*   按下该`Tab`键应将**当前行**（或选定行）缩进一级。

    作为次要选择，我还可以容忍像 Emacs 这样的编辑器使用此键来执行上下文相关的 fix-my-indentation 命令。

*   如果共识足够强烈，则缩进一行或多行应遵循现行惯例；否则，我非常喜欢每个级别**的 4 空格缩进**。

*   U+0009 字符应将后续字符移动到**下一个制表位**。制表位从第 1 列开始，相隔 8 列，没有例外。

            回答 #5

赞同：4

时间：2009-05-01T03:31:06.720

过去我使用了 3 个空格。这仍然是我的偏好。但是 4 个空格似乎是 VB 世界的标准。所以我已经切换到 4 以与我看到的大多数代码示例以及我团队的其他成员保持一致。

            回答 #6

赞同：3

时间：2009-05-01T01:24:41.220

我不知道有任何研究可以回答你的问题。我不认为这是非主观的，但我个人的偏好是 4 个空格。  

            回答 #7

赞同：2

时间：2009-05-01T04:16:00.620

由于您使用的是 Python，因此如前所述，您可以采用 Python 的样式指南 ( [PEP 8](http://www.python.org/dev/peps/pep-0008/) ) 建议：

缩进

```
Use 4 spaces per indentation level. 
```

但是[Linux 内核 CodingStyle](http://lxr.linux.no/linux+v2.6.29/Documentation/CodingStyle)说的不同：

制表符是 8 个字符，因此缩进也是 8 个字符。有一些异端运动试图使压痕深度为 4（甚至 2！）个字符，这类似于试图将 PI 的值定义为 3。 基本原理：压痕背后的整个想法是明确定义一个块控制开始和结束。尤其是当您连续看屏幕 20 个小时时，如果您有较大的压痕，您会发现更容易看到压痕是如何工作的。

该文档还提供了一些示例，说明代码的外观以及标识如何更改（尽管它在 C 中）

            回答 #8

赞同：2

时间：2016-03-16T21:11:29.917

到目前为止还没有人提到这一点，所以我觉得我有义务发布一个。缩进大小的选择（我认为 OP 的意思）不仅会影响代码的缩进方式，还会影响一行中可以容纳多少代码以及它们如何对齐。

开发团队最终需要就线路的长度达成某种协议。我从 80 列开始，直到今天我仍然坚持 80 列。AFAIK，stackoverflow 在源代码降价中也使用了 80 列。

当您使用 8 级缩进，以及嵌套 3 级深度的典型函数时，您的代码将从第 24 列开始。这使我只剩下 56 个字符来编写一行代码。

下面是 VLC 中一些代码在 indent=4 时的样子：

```
 msg_Dbg( p_libvlc, "Adds %s to the running media player", mrl );
            free( mrl );

            /* send message and get a handle for a reply */
            DBusMessage *reply = dbus_connection_send_with_reply_and_block( conn, msg, -1,
                                                                            &err );
            dbus_message_unref( msg ); 
```

这是 indent=8 的样子

```
 msg_Dbg( p_libvlc, "Adds %s to the running media player", mrl );
                        free( mrl );

                        /* send message and get a handle for a reply */
                        DBusMessage *reply = dbus_connection_send_with_reply_and_block( conn, msg, -1,
                                                                                        &err );
                        dbus_message_unref( msg ); 
```

虽然大缩进使代码更易于阅读，但它也使您在嵌套代码回绕之前编写嵌套代码的空间更小。

将制表符大小保持在 8 非常重要。制表符！= 缩进。虽然将硬制表符作为缩进很容易，但它也会产生非常糟糕的后果。很多人也喜欢对齐他们的代码。所以上面的代码在 tab = 4 的情况下看起来像这样：

```
 msg_Dbg( p_libvlc, "Adds %s to the running media player", mrl );
            free( mrl );

            /* send message and get a handle for a reply */
            DBusMessage *reply = dbus_connection_send_with_reply_and_block( conn, msg, -1,
                                        &err );
            dbus_message_unref( msg ); 
```

你会看到这条线`&err`不再与`conn`上面对齐。当每行末尾添加多个注释时，情况会变得更糟。

            回答 #9

赞同：1

时间：2009-05-02T08:15:42.660

制表符优于空格的论点是它允许每个人自定义他们的编辑器以查看他们想要的任何缩进级别。反对制表符的论点是当它们混合制表符和空格时（对于作者而言）很难发现。有时您会想要不缩进到制表位的行，这会导致混合制表符/空格。

使用 2 个空格具有以下优点：可以有更多的嵌套块（如果您也有行限制，这很重要），并且使用双缩进（即 4 个空格）是包装长行的可读性很好的方式。缺点是有时很难判断两行是否在同一个缩进。

使用 8 个空格与 2 个空格有相反的优点和缺点。判断缩进级别很容易，但深度嵌套变得难以管理。许多人会认为后者的缺点是优点（因为它使深度嵌套不太理想）。

4 个空格介于这两个极端之间。

但我个人的看法是，你使用什么级别的缩进没有区别。最重要的是选择一些标准并坚持下去。正如其他人所说，如果您正在编写 python，请遵循 PEP8，如果您正在编写 java，请遵循 Sun 的 java style guide，如果您正在执行 linux kernel hacking，请遵循他们的 style guide。即使使用一个比另一个有一些小的优势，也浪费精力争论选择哪个。做出决定，然后继续进行软件工程中有趣的部分。

            回答 #10

赞同：0

时间：2009-05-01T02:20:06.267

根据一项要求程序员根据缩进估计嵌套级别的研究，我读到 2 个空格实际上是最佳的，但是当被问到时，程序员认为 4 是最佳的。需要引用，但找不到。

            回答 #11

赞同：0

时间：2009-05-01T03:51:47.230

我想我记得[Code Complete](https://rads.stackoverflow.com/amzn/click/com/0735619670)中有一个关于缩进的部分，引用了一些关于哪个级别的标识使代码最易读的研究，但我现在没有它的副本，所以我无法检查它.

            回答 #12

赞同：-1

时间：2009-05-01T01:26:17.520

我一直使用一个制表符作为两个空格。

            回答 #13

赞同：-3

时间：2011-04-22T20:27:53.887

我想 4 个选项卡空间使代码更具可读性......至少就我的项目工作而言，4 个选项卡空间是最舒适的选择......

        javascript - 使用 XML 和 Javascript/Jquery 填充页面，检查 url 是否与 xml 标记相同

ID：809864

赞同：0

时间：2009-05-01T01:24:12.547

标签：javascript, jquery, xml, if-statement, auto-populate

我需要创建一个 javascript 函数来编写基于 url 的页面，所以基本上我正在尝试创建一个 javascript 函数来检查 url，并从那里找到相应的 xml 项。

这背后的原因是，html 页面可以被复制、重命名和 xml 更新，并且页面将填写 xml 表中的所有其他内容。

请让我知道这是否是完全错误的方法，有更好的方法。谢谢！！！

XML 代码::

```
<!--XML INFORMATION-->      
<channel>
<design>
<motion><!--design content-->

<item><!--//////////POST//////////POST//////////POST//////////-->
    <tag>/portfolio_dec.html</tag>

<!--RSS INFORMATION-->      
    <title>Decoze</title>
    <link>http://payamrajabi.com/portfoliotest.html</link>
    <description><img src="http://payamrajabi.com/thumbs/small_jump.png" title="JUMP!." /></description>

<!--PROJECT CONTENT-->

<project><!--project start-->

    <titl>TITLE</titl><!--project title-->
    <dsc>PROJECT DESCRIPTION</dsc><!--project description-->

</project><!--project end-->

</item><!--//////////END//////////END//////////END//////////-->

</motion>
</design>   
</channel> 
```

JAVASCRIPT：

```
$(document).ready(function(){

    $.ajax({
    type: "GET",
    url: "code/content9.xml",
    dataType: "xml",
    success: function(xml) {

    var xpathname = window.location.pathname;
    var xproject = $(xml).find('tag').text();

    if (xpathname == xproject) {

        $(xml).find('item').children('tag').text(xpathname).each(function(){
            var ttl = $(this).find('titl').text();
            $('<p>'+ttl+'</p>').appendTo('h1#ttl');
        });

        $(xml).find('item').children('tag').text(xpathname).each(function(){
            var dsc = $(this).find('dsc').text();
            $('<p>'+dsc+'</p>').appendTo('h1#ttl');
        });                 

    } else {
        PUT ERROR MESSAGE HERE
    }
    }
    });                 
}); 
```

和 HTML：

```
<html>
<head>

<script type="text/javascript" src="code/jquery-1.3.1.js"></script>
<script type="text/javascript" src="code/project/project_design.js"></script>

</head>

<body>
<h1 id="ttl"></h1>
<p id="dsc"></p>
</body>
</html> 
```

任何帮助都将不胜感激，我对 javascript/jquery/xml 很陌生，我真的遇到了麻烦。我想做的主要事情是有一个填充网站的 xml 文件，每个项目都是新页面的内容，在这种情况下是投资组合项目。

干杯！

威廉

            回答 #1

赞同：2

时间：2009-05-02T00:35:50.970

嗯……恐怕你不太明白 jquery 是如何工作的。

您的代码应如下所示：

```
var xpathname = window.location.pathname; 

var xitem = $(xml).find('tag:contains(' + xpathname + ')').parent(); 

if (xproject.length != 0) { 
  $('#ttl').append('<p>' + xitem.find('titl').text() + '</p>'); 
  $('#dsc').append('<p>' + xitem.find('dsc').text() + '</p>'); 
} 
else {
  $('#err').text('The page you requested does not exist'); 
} 
```

演示 1

这是一个快速演示。查看源代码以查看 XML 和 JavaScript。

[http://jsbin.com/ujiho#itemOne](http://jsbin.com/ujiho#itemOne)

[http://jsbin.com/ujiho#itemTwo](http://jsbin.com/ujiho#itemTwo)

[http://jsbin.com/ujiho#itemThree](http://jsbin.com/ujiho#itemThree)

演示 2

我创建了另一个演示，用于`$.get`从单独的 URL 检索 XML。

[http://jsbin.com/aqefo#nov](http://jsbin.com/aqefo#nov)

[http://jsbin.com/aqefo#dec](http://jsbin.com/aqefo#dec)

XML：http: [//jsbin.com/afiwa](http://jsbin.com/afiwa)

这是JavaScript。如果您需要帮助理解任何事情，请告诉我。

```
$(function(){
  $.get(
    'http://jsbin.com/afiwa',
    function(xml){

      var hash = window.location.hash.substring(1);

      if ($.trim(hash) === '') {
        showError();
        return;
      }

      var xitem = $(xml).find('urlname:contains(' + hash + ')').parent();

      if (xitem.length != 0) {
        $('#ttl').append(xitem.find('titl').text());
        $('#dsc').append( xitem.find('dsc').text());
      }
      else {
        showError();
      }

      function showError() {
        $('#err').text('The page you requested does not exist');
      }
    }
  );
}); 
```

        iphone - 导航控制器第二次崩溃

ID：809866

赞同：0

时间：2009-05-01T01:24:53.340

标签：iphone, uinavigationcontroller

我在我的应用程序中使用了一个导航控制器。我有一个主视图（带有主视图控制器）和几个选项视图。当单击主视图工具栏上的按钮时，导航控制器会查看选项视图。

一切都第一次按预期工作。当我从导航控制器返回主视图并再次尝试转到选项视图（即导航控制器）时，我的应用程序崩溃了。

以下是我的代码，

```
//Jump to navigation controller from main view controller

optionsViewController *optionsView = [[optionsViewController alloc] initWithNibName:@"optionsView" bundle:nil];
navControllerSettings = [[UINavigationController alloc] initWithRootViewController:(UIViewController *) optionsView];
[self presentModalViewController:self.navControllerSettings animated:YES];

//Code to go back to main view from navigation controller

[self.navigationController dismissModalViewControllerAnimated:YES]; 
```

处理导航控制器的正确机制是什么？我需要释放/释放导航控制器或选项视图吗？

示例代码将有更好的帮助。

            回答 #1

赞同：0

时间：2009-05-01T02:26:34.283

您的导航控制器只设置一次，然后您从其堆栈中推送和弹出其他视图。

```
UINavigationController *navController = [[UINavigationController alloc] init];
UIViewController *yourMainViewController = [[yourMainViewControllerClass alloc] init];

// when you are ready to go to your options view
optionsViewController *optionsView = [[optionsViewController alloc] initWithNibName:@"optionsView" bundle:nil];

[navController pushViewController:optionsViewController animated:YES];

// the back button and the pop from the stack when it is hit is handled auto-magically for you 
```

            回答 #2

赞同：0

时间：2009-05-02T01:06:06.653

谢谢回复。

但是我的应用程序架构是，我有一个主视图，在该主视图上显示的东西很少，并且有工具栏。工具栏包含一个按钮，单击后该导航控制器将创建并显示在屏幕上。

使用后退按钮我来到了主视图。但是在我无法再次导航之后，因为它在执行以下行时崩溃了

[self presentModalViewController:self.navControllerSettings Animation:YES];

这里可能有什么问题？

维沙尔 N

            回答 #3

赞同：0

时间：2010-01-29T17:24:23.603

我遇到了与此类似的问题，它在第二次尝试时在 presentModalViewController: 中崩溃。问题是由`[self becomeFirstResponder]`在我呈现的第一个 UIViewController 中调用 viewDidAppear: 引起的，但我未能`[self resignFirstResponder]`在 viewWillDisappear:中调用。

        android - Android：如何在给定网址的情况下显示大型动画 gif？

ID：809878

赞同：15

时间：2009-05-01T01:29:13.597

标签：android, animated-gif

假设我有大型动画 gif 的 URL，并且我想制作一个类似 youtube 的活动，以流式方式显示动画。我如何

1.  图像中的流？
2.  让它与实际动画一起显示？

我知道`ImageView`不是答案，因为它只显示第一帧。  

一个好处是可以访问它的缓冲状态，这样我也可以同步流式声音——这是[YTMND](http://ytmnd.com/)查看器应用程序的一部分。虽然我可以创建一个将公共 gif 文件转码为更好格式的服务，但我希望该应用程序能够在没有额外依赖项的情况下运行。

            回答 #1

赞同：12

时间：2009-05-05T06:47:29.087

解决方案的总体思路是使用定期`View`绘制请求的应用`Movie`程序来绘制自身。`Canvas`

第一步是构建`Movie`实例。有一个工厂调用`decodeStream`可以在给定的情况下制作电影，`InputStream`但仅使用来自 a 的流是不够的`UrlConnection`。如果你尝试这个，`IOException`当电影加载器尝试调用`reset`流时，你会得到一个。不幸的是，黑客是使用`BufferedInputStream`带有手动设置的分隔符`mark`来告诉它保存足够的数据而`reset`不会失败。幸运的是，它`URLConnection`可以告诉我们需要多少数据。我说这个 hack 很不幸，因为它实际上需要将整个图像缓冲在内存中（这对于桌面应用程序来说没有问题，但在内存受限的移动设备上却是一个严重的问题）。

这是`Movie`设置代码的片段：

```
URL url = new URL(gifSource);
URLConnection conn = url.openConnection();
InputStream is = conn.getInputStream();
BufferedInputStream bis = new BufferedInputStream(is);
bis.mark(conn.getContentLength());
Movie movie = Movie.decodeStream(bis);
bis.close(); 
```

接下来，您需要创建一个将显示 this 的视图`Movie`。`View`带有自定义的子类可以解决问题`onDraw`（假设它可以访问`Movie`您使用前面的代码创建的）。

```
@Override protected void onDraw(Canvas canvas) {
    if(movie != null) {
        long now = android.os.SystemClock.uptimeMillis();
        int dur = Math.max(movie.duration(), 1); // is it really animated?
        int pos = (int)(now % dur);
        movie.setTime(pos);
        movie.draw(canvas, x, y);
    }
} 
```

视图不会在没有帮助的情况下触发自身重绘，并且`invalidate()`在末尾盲目调用`onDraw`只是一种能量浪费。在另一个线程（可能是您用来下载图像数据的线程）中，您可以向主线程发布消息，要求视图以稳定（但不是疯狂）的速度失效。

```
Handler handler = new Handler();
new Thread() {
    @Override public void run() {
        // ... setup the movie (using the code from above)
        // ... create and display the custom view, passing the movie

        while(!Thread.currentThread().isInterrupted()) {
            handler.post(new Runnable() {
                public void run(){
                    view.invalidate();
                }
            });
            try {
                Thread.sleep(50); // yields 20 fps
            } catch (InterruptedException e) {
                Thread.currentThread().interrupt();
            }
        }
    }
}.start(); 
```

一个非常好的解决方案应该有各种甜蜜的进度条和错误检查，但核心就在这里。

            回答 #2

赞同：1

时间：2009-05-02T15:38:15.403

你试过了`BitmapDecode`吗？[此处](http://developer.android.com/guide/samples/ApiDemos/src/com/example/android/apis/graphics/BitmapDecode.html)
的 API 演示中有一个示例。

            回答 #3

赞同：1

时间：2015-12-02T19:55:01.030

[**Glide**](https://github.com/bumptech/glide)证明了只需一行代码即可实现这一目标的最简单有效的方法：-

```
Glide.with(getApplicationContext())
            .load(Uri.parse("https://media1.giphy.com/media/5ziaphcUWGKPu/200.gif"))
            .asGif().placeholder(R.drawable.ic_launcher).crossFade()
            .into(imageView); 
```

结果在这里：-

[![在此处输入图像描述](https://i.stack.imgur.com/3dtyt.png)](https://i.stack.imgur.com/3dtyt.png)

Gif 取自这里[http://giphy.com/search/big-gif/3](http://giphy.com/search/big-gif/3)

从这里添加罐子：- [https://github.com/bumptech/glide/releases](https://github.com/bumptech/glide/releases)

            回答 #4

赞同：0

时间：2011-07-10T15:10:07.757

也许**AnimationDrawable**可以为你工作？编辑：如果你想从像这篇文章这样的 URL 加载，则不是。对不起

[http://developer.android.com/reference/android/graphics/drawable/AnimationDrawable.html](http://developer.android.com/reference/android/graphics/drawable/AnimationDrawable.html)

根据 GIF 的复杂性，即如果它是一个简单的加载/进度指示器，您可以将 GIF 分开，分别保存每个图像并使用 Android 框架的 AnimationDrawable。

对于简单的进度条，这可能不太容易出错，甚至可能更高性能。

        linq - linq to sql OnLoaded() with SQL View？

ID：809895

赞同：3

时间：2009-05-01T01:46:17.940

标签：linq, linq-to-sql, extension-methods

我正在尝试使用一些额外的属性来扩展我的 Linq-to-Sql 实体。这些是基于来自底层 SQL 视图的数据的“计算”属性。例如，考虑有一个 Date of Birth 字段，用于计算扩展的 Age 字段。

我试图通过扩展 OnLoaded() 方法来扩展我的实体类。

我收到一个编译时错误，但说明我无法创建它。我检查了我的 LTS 实体类的设计器代码，它没有任何预期扩展点的部分定义。

我检查了一些其他 LTS 实体类，它们确实有这些扩展点。我看到的唯一区别是没有从 SQL 视图加载，而不是从表加载。从 SQL 视图加载时，有没有办法挂钩到“已加载”事件？

蒂亚！

            回答 #1

赞同：4

时间：2009-05-06T19:55:22.287

我发现我没有为我的 Linq-to-Sql 实体类指定 PrimaryKey。我相信没有指定主键，实体类中不会生成扩展方法。一旦我在 LTS 实体类定义中指定了主键（通过设计器），我就能够扩展 OnLoaded() 事件。

            回答 #2

赞同：1

时间：2009-05-01T08:17:55.313

您可以通过属性来做到这一点。只需创建一个与您的实体同名的部分类。您添加的任何属性或方法都将自动成为实体的一部分，并允许使用其任何成员。

**这是该模式的示例：**

```
public partial class [The Name of the Entity]
{
   public int Age
   {
      get
      {
         return CalculateAge(this.DateOfBirth);
      }
   }
} 
```

这是关于如何计算年龄的一些逻辑（来源：[Geekpedia](http://www.geekpedia.com/code81_Calculate-age-using-Csharp.html)）

```
public static int CalculateAge(DateTime BirthDate)
{
    int YearsPassed = DateTime.Now.Year - BirthDate.Year;
    // Are we before the birth date this year? If so subtract one year from the mix
    if (DateTime.Now.Month < BirthDate.Month || 
          (DateTime.Now.Month == BirthDate.Month && DateTime.Now.Day < BirthDate.Day))
    {
        YearsPassed--;
    }
    return YearsPassed;
} 
```

        iphone - 在没有 xib 的 Cocoa Touch 中以编程方式加载视图控制器和视图层次结构

ID：809898

赞同：7

时间：2009-05-01T01:50:50.517

标签：iphone, cocoa-touch, uikit, uiviewcontroller

似乎所有 Cocoa Touch 模板都设置为加载笔尖。

如果我想开始一个将使用视图控制器的新项目，并以编程方式而不是从 nib/xib 加载其视图（层次结构），那么设置或调整模板的步骤是什么。

尽管我所要做的就是实现-loadView，但每次尝试执行此操作时都会遇到麻烦。

            回答 #1

赞同：16

时间：2009-05-01T16:27:46.400

进行完全编程的用户界面生成相当简单。首先，您需要将 main.m 编辑为如下所示：

```
int main(int argc, char *argv[]) 
{
    NSAutoreleasePool *pool = [NSAutoreleasePool new];  
    UIApplicationMain(argc, argv, nil, @"MyAppDelegate");
    [pool release];
    return 0;   
} 
```

其中 MyAppDelegate 是您的应用程序委托类的名称。这意味着 MyAppDelegate 的实例将在启动时创建，通常由应用程序的主 Nib 文件处理。

在 MyAppDelegate 中，实现类似于以下的 applicationDidFinishLaunching: 方法：

```
- (void)applicationDidFinishLaunching:(UIApplication *)application 
{    
    window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
    if (!window) 
    {
        [self release];
        return;
    }
    window.backgroundColor = [UIColor whiteColor];

    rootController = [[MyRootViewController alloc] init];

    [window addSubview:rootController.view];
    [window makeKeyAndVisible];
    [window layoutSubviews];    
} 
```

其中 MyRootViewController 是窗口中主视图的视图控制器。这应该初始化主窗口，并将 MyRootViewController 管理的视图添加到其中。rootController 作为实例变量保存在委托中，以供以后参考。

这应该让您通过 MyRootViewController 以编程方式生成用户界面。

            回答 #2

赞同：3

时间：2009-05-01T02:10:35.900

UIViews 本身没有层次结构，UINavigationControllers 有。所以初始化其中一个，然后将 UIViewController 弹出到它的堆栈上。这应该以最基本的方式完成，根本没有 XIB 文件。您应该能够以此为基础。

```
- (void)applicationDidFinishLaunching:(UIApplication *)application {    
   UINavigationController *navController = [[UINavigationController alloc] init];

   UIViewController *viewController = [[UIViewController alloc] init];

   // set the properties of viewController here, to make it look like you want

   [navController pushViewController:viewController animated:NO];

   [window addSubview:navController.view];

   // Don't forget memory management
   [navController release];
   [viewController release];

   [window makeKeyAndVisible];
} 
```

        c++ - C ++中的64位ntohl（）？

ID：809902

赞同：67

时间：2009-05-01T01:53:08.483

标签：c++, linux, 64-bit, endianness

的手册页`htonl()`似乎建议您最多只能将其用于 32 位值。（实际上，`ntohl()`是为 unsigned long 定义的，在我的平台上是 32 位。我想如果 unsigned long 是 8 个字节，它将适用于 64 位整数）。

我的问题是我需要将 64 位整数（在我的情况下，这是一个 unsigned long long）从大端转换为小端。现在，我需要进行特定的转换。`ntohl()`但是，如果目标平台是大端序时函数（如）不会转换我的 64 位值，那就更好了。（我宁愿避免添加我自己的预处理器魔法来做到这一点）。

我可以使用什么？如果它存在，我想要一些标准的东西，但我愿意接受实施建议。我在过去看到过这种类型的转换使用联合。我想我可以有一个 unsigned long long 和一个 char[8] 的联合。然后相应地交换字节。（显然会在大端平台上中断）。

            回答 #1

赞同：60

时间：2010-12-10T16:02:29.250

文档：`man htobe64`在 Linux (glibc >= 2.9) 或 FreeBSD 上。

不幸的是，在 2009 年的一次尝试中，OpenBSD、FreeBSD 和 glibc (Linux) 并没有很好地协同工作来为此创建一个（非内核 API）libc 标准。

目前，这一小段预处理器代码：

```
#if defined(__linux__)
#  include <endian.h>
#elif defined(__FreeBSD__) || defined(__NetBSD__)
#  include <sys/endian.h>
#elif defined(__OpenBSD__)
#  include <sys/types.h>
#  define be16toh(x) betoh16(x)
#  define be32toh(x) betoh32(x)
#  define be64toh(x) betoh64(x)
#endif 
```

（在 Linux 和 OpenBSD 上测试）应该隐藏差异。它为您提供了这 4 个平台上的 Linux/FreeBSD 风格的宏。

使用示例：

```
 #include <stdint.h>    // For 'uint64_t'

  uint64_t  host_int = 123;
  uint64_t  big_endian;

  big_endian = htobe64( host_int );
  host_int = be64toh( big_endian ); 
```

这是目前可用的最“标准 C 库”的方法。

            回答 #2

赞同：18

时间：2012-11-12T21:44:04.447

我建议阅读此内容：[http ://commandcenter.blogspot.com/2012/04/byte-order-fallacy.html](http://commandcenter.blogspot.com/2012/04/byte-order-fallacy.html)

```
#include <stdio.h>
#include <stdint.h>
#include <inttypes.h>

uint64_t
ntoh64(const uint64_t *input)
{
    uint64_t rval;
    uint8_t *data = (uint8_t *)&rval;

    data[0] = *input >> 56;
    data[1] = *input >> 48;
    data[2] = *input >> 40;
    data[3] = *input >> 32;
    data[4] = *input >> 24;
    data[5] = *input >> 16;
    data[6] = *input >> 8;
    data[7] = *input >> 0;

    return rval;
}

uint64_t
hton64(const uint64_t *input)
{
    return (ntoh64(input));
}

int
main(void)
{
    uint64_t ull;

    ull = 1;
    printf("%"PRIu64"\n", ull);

    ull = ntoh64(&ull);
    printf("%"PRIu64"\n", ull);

    ull = hton64(&ull);
    printf("%"PRIu64"\n", ull);

    return 0;
} 
```

将显示以下输出：

```
1
72057594037927936
1 
```

如果您删除了前 4 个字节，您可以使用 ntohl() 进行测试。

你也可以在 C++ 中把它变成一个很好的模板函数，它适用于任何大小的整数：

```
template <typename T>
static inline T
hton_any(const T &input)
{
    T output(0);
    const std::size_t size = sizeof(input);
    uint8_t *data = reinterpret_cast<uint8_t *>(&output);

    for (std::size_t i = 0; i < size; i++) {
        data[i] = input >> ((size - i - 1) * 8);
    }

    return output;
} 
```

现在你的 128 位也安全了！

            回答 #3

赞同：14

时间：2009-05-01T02:01:12.240

要检测您的字节序，请使用以下联合：

```
union {
    unsigned long long ull;
    char c[8];
} x;
x.ull = 0x0123456789abcdef; // may need special suffix for ULL. 
```

然后您可以检查 的内容`x.c[]`以检测每个字节的位置。

为了进行转换，我会使用该检测代码一次来查看平台使用的字节序，然后编写我自己的函数来进行交换。

您可以使其动态化，以便代码可以在任何平台上运行（检测一次，然后使用转换代码中的开关来选择正确的转换）但是，如果您只打算使用一个平台，我会这样做在单独的程序中检测一次，然后编写一个简单的转换例程，确保您记录它仅在该平台上运行（或已测试）。

这是我为说明它而编写的一些示例代码。尽管没有以彻底的方式对其进行过测试，但应该足以让您入门。

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#define TYP_INIT 0
#define TYP_SMLE 1
#define TYP_BIGE 2

static unsigned long long cvt(unsigned long long src) {
    static int typ = TYP_INIT;
    unsigned char c;
    union {
        unsigned long long ull;
        unsigned char c[8];
    } x;

    if (typ == TYP_INIT) {
        x.ull = 0x01;
        typ = (x.c[7] == 0x01) ? TYP_BIGE : TYP_SMLE;
    }

    if (typ == TYP_SMLE)
        return src;

    x.ull = src;
    c = x.c[0]; x.c[0] = x.c[7]; x.c[7] = c;
    c = x.c[1]; x.c[1] = x.c[6]; x.c[6] = c;
    c = x.c[2]; x.c[2] = x.c[5]; x.c[5] = c;
    c = x.c[3]; x.c[3] = x.c[4]; x.c[4] = c;
    return x.ull;
}

int main (void) {
    unsigned long long ull = 1;
    ull = cvt (ull);
    printf ("%llu\n",ull);
    return 0;
} 
```

请记住，这只是检查纯大/小端。如果您有一些奇怪的变体，其中字节存储在，例如，{5,2,3,1,0,7,6,4} 顺序，`cvt()`会更复杂一点。这样的架构不应该存在，但我并没有贬低我们在微处理器行业的朋友的疯狂:-)

还要记住，这在技术上是未定义的行为，因为除了最后一个写入的字段之外，您不应该通过任何字段访问工会成员。它可能适用于大多数实现，但从纯粹主义者的角度来看，您可能应该硬着头皮使用宏来定义自己的例程，例如：

```
// Assumes 64-bit unsigned long long.
unsigned long long switchOrderFn (unsigned long long in) {
    in  = (in && 0xff00000000000000ULL) >> 56
        | (in && 0x00ff000000000000ULL) >> 40
        | (in && 0x0000ff0000000000ULL) >> 24
        | (in && 0x000000ff00000000ULL) >> 8
        | (in && 0x00000000ff000000ULL) << 8
        | (in && 0x0000000000ff0000ULL) << 24
        | (in && 0x000000000000ff00ULL) << 40
        | (in && 0x00000000000000ffULL) << 56;
    return in;
}
#ifdef ULONG_IS_NET_ORDER
    #define switchOrder(n) (n)
#else
    #define switchOrder(n) switchOrderFn(n)
#endif 
```

            回答 #4

赞同：13

时间：2015-02-06T11:02:07.720

快速回答

```
#include <endian.h>    // __BYTE_ORDER __LITTLE_ENDIAN
#include <byteswap.h>  // bswap_64()

uint64_t value = 0x1122334455667788;

#if __BYTE_ORDER == __LITTLE_ENDIAN
value = bswap_64(value);  // Compiler builtin GCC/Clang
#endif 
```

头文件

正如[zhaorufei](https://stackoverflow.com/users/64469/zhaorufei)报告的（见她/他的评论）`endian.h`不是 C++ 标准头和宏`__BYTE_ORDER`，`__LITTLE_ENDIAN`可能是未定义的。因此该`#if`语句是不可预测的，因为未定义的宏被视为`0`.

*如果您想分享您的 C++ 优雅技巧来检测字节序，请编辑此答案。*

可移植性

此外，该宏`bswap_64()`可用于 GCC 和 Clang 编译器，但不适用于 Visual C++ 编译器。要提供可移植的源代码，您可能会受到以下代码段的启发：

```
#ifdef _MSC_VER
  #include <stdlib.h>
  #define bswap_16(x) _byteswap_ushort(x)
  #define bswap_32(x) _byteswap_ulong(x)
  #define bswap_64(x) _byteswap_uint64(x)
#else
  #include <byteswap.h>  // bswap_16 bswap_32 bswap_64
#endif 
```

另请参阅更便携的源代码：[跨平台`_byteswap_uint64`](https://stackoverflow.com/a/46137633/938111)

C++14`constexpr`模板函数

通用`hton()`16 位、32 位、64 位等...

```
#include <endian.h>   // __BYTE_ORDER __LITTLE_ENDIAN
#include <algorithm>  // std::reverse()

template <typename T>
constexpr T htonT (T value) noexcept
{
#if __BYTE_ORDER == __LITTLE_ENDIAN
  char* ptr = reinterpret_cast<char*>(&value);
  std::reverse(ptr, ptr + sizeof(T));
#endif
  return value;
} 
```

C++11`constexpr`模板函数

*   C++11 不允许在`constexpr`函数中使用局部变量。

    因此，诀窍是使用具有默认值的参数。
*   此外，C++11`constexpr`函数必须包含一个表达式。

    因此，正文由一个 return 组成，其中包含一些逗号分隔的*statements*。

```
template <typename T>
constexpr T htonT (T value, char* ptr=0) noexcept
{
  return 
#if __BYTE_ORDER == __LITTLE_ENDIAN
    ptr = reinterpret_cast<char*>(&value), 
    std::reverse(ptr, ptr + sizeof(T)),
#endif
    value;
} 
```

使用 clang-3.5 和 GCC-4.9 时没有编译警告（请参阅[coliru](http://coliru.stacked-crooked.com/a/3f8a9941c2904e18)`-Wall -Wextra -pedantic`

上的编译和运行输出）。

C++11`constexpr`模板 SFINAE 函数

但是，上述版本不允许将`constexpr`变量创建为：

```
constexpr int32_t hton_six = htonT( int32_t(6) ); 
```

最后，我们需要根据 16/32/64 位来分离（专门化）这些功能。

但是我们仍然可以保留泛型函数。

（请参阅[coliru](http://coliru.stacked-crooked.com/a/25019ad184048704)的完整片段）

下面的 C++11 片段使用[特征](https://en.wikipedia.org/wiki/Trait_(computer_programming)) [`std::enable_if`](http://en.cppreference.com/w/cpp/types/enable_if)来利用[替换失败不是错误](https://en.wikipedia.org/wiki/SFINAE)(SFINAE)。

```
template <typename T>
constexpr typename std::enable_if<sizeof(T) == 2, T>::type
htonT (T value) noexcept
{
   return  ((value & 0x00FF) << 8)
         | ((value & 0xFF00) >> 8);
}

template <typename T>
constexpr typename std::enable_if<sizeof(T) == 4, T>::type
htonT (T value) noexcept
{
   return  ((value & 0x000000FF) << 24)
         | ((value & 0x0000FF00) <<  8)
         | ((value & 0x00FF0000) >>  8)
         | ((value & 0xFF000000) >> 24);
}

template <typename T>
constexpr typename std::enable_if<sizeof(T) == 8, T>::type
htonT (T value) noexcept
{
   return  ((value & 0xFF00000000000000ull) >> 56)
         | ((value & 0x00FF000000000000ull) >> 40)
         | ((value & 0x0000FF0000000000ull) >> 24)
         | ((value & 0x000000FF00000000ull) >>  8)
         | ((value & 0x00000000FF000000ull) <<  8)
         | ((value & 0x0000000000FF0000ull) << 24)
         | ((value & 0x000000000000FF00ull) << 40)
         | ((value & 0x00000000000000FFull) << 56);
} 
```

或者基于内置编译器宏和 C++14 语法的更短的版本`std::enable_if_t<xxx>`作为`std::enable_if<xxx>::type`:

```
template <typename T>
constexpr typename std::enable_if_t<sizeof(T) == 2, T>
htonT (T value) noexcept
{
    return bswap_16(value);  // __bswap_constant_16
}

template <typename T>
constexpr typename std::enable_if_t<sizeof(T) == 4, T>
htonT (T value) noexcept
{
    return bswap_32(value);  // __bswap_constant_32
}

template <typename T>
constexpr typename std::enable_if_t<sizeof(T) == 8, T>
htonT (T value) noexcept
{
    return bswap_64(value);  // __bswap_constant_64
} 
```

第一版测试代码

```
std::uint8_t uc = 'B';                  std::cout <<std::setw(16)<< uc <<'\n';
uc = htonT( uc );                       std::cout <<std::setw(16)<< uc <<'\n';

std::uint16_t us = 0x1122;              std::cout <<std::setw(16)<< us <<'\n';
us = htonT( us );                       std::cout <<std::setw(16)<< us <<'\n';

std::uint32_t ul = 0x11223344;          std::cout <<std::setw(16)<< ul <<'\n';
ul = htonT( ul );                       std::cout <<std::setw(16)<< ul <<'\n';

std::uint64_t uL = 0x1122334455667788; std::cout <<std::setw(16)<< uL <<'\n';
uL = htonT( uL );                      std::cout <<std::setw(16)<< uL <<'\n'; 
```

第二版测试代码

```
constexpr uint8_t  a1 = 'B';               std::cout<<std::setw(16)<<a1<<'\n';
constexpr auto     b1 = htonT(a1);         std::cout<<std::setw(16)<<b1<<'\n';

constexpr uint16_t a2 = 0x1122;            std::cout<<std::setw(16)<<a2<<'\n';
constexpr auto     b2 = htonT(a2);         std::cout<<std::setw(16)<<b2<<'\n';

constexpr uint32_t a4 = 0x11223344;        std::cout<<std::setw(16)<<a4<<'\n';
constexpr auto     b4 = htonT(a4);         std::cout<<std::setw(16)<<b4<<'\n';

constexpr uint64_t a8 = 0x1122334455667788;std::cout<<std::setw(16)<<a8<<'\n';
constexpr auto     b8 = htonT(a8);         std::cout<<std::setw(16)<<b8<<'\n'; 
```

输出

```
 B
               B
            1122
            2211
        11223344
        44332211
1122334455667788
8877665544332211 
```

代码生成

在线 C++ 编译器[gcc.godbolt.org](https://godbolt.org/g/A6GXDt)指示生成的代码。

**`g++-4.9.2 -std=c++14 -O3`**

```
std::enable_if<(sizeof (unsigned char))==(1), unsigned char>::type htonT<unsigned char>(unsigned char):
    movl    %edi, %eax
    ret
std::enable_if<(sizeof (unsigned short))==(2), unsigned short>::type htonT<unsigned short>(unsigned short):
    movl    %edi, %eax
    rolw    $8, %ax
    ret
std::enable_if<(sizeof (unsigned int))==(4), unsigned int>::type htonT<unsigned int>(unsigned int):
    movl    %edi, %eax
    bswap   %eax
    ret
std::enable_if<(sizeof (unsigned long))==(8), unsigned long>::type htonT<unsigned long>(unsigned long):
    movq    %rdi, %rax
    bswap   %rax
    ret 
```

**`clang++-3.5.1 -std=c++14 -O3`**

```
std::enable_if<(sizeof (unsigned char))==(1), unsigned char>::type htonT<unsigned char>(unsigned char): # @std::enable_if<(sizeof (unsigned char))==(1), unsigned char>::type htonT<unsigned char>(unsigned char)
    movl    %edi, %eax
    retq

std::enable_if<(sizeof (unsigned short))==(2), unsigned short>::type htonT<unsigned short>(unsigned short): # @std::enable_if<(sizeof (unsigned short))==(2), unsigned short>::type htonT<unsigned short>(unsigned short)
    rolw    $8, %di
    movzwl  %di, %eax
    retq

std::enable_if<(sizeof (unsigned int))==(4), unsigned int>::type htonT<unsigned int>(unsigned int): # @std::enable_if<(sizeof (unsigned int))==(4), unsigned int>::type htonT<unsigned int>(unsigned int)
    bswapl  %edi
    movl    %edi, %eax
    retq

std::enable_if<(sizeof (unsigned long))==(8), unsigned long>::type htonT<unsigned long>(unsigned long): # @std::enable_if<(sizeof (unsigned long))==(8), unsigned long>::type htonT<unsigned long>(unsigned long)
    bswapq  %rdi
    movq    %rdi, %rax
    retq 
```

注意：我[原来的答案](http://coliru.stacked-crooked.com/a/aac0cf97ddc0702d)不`constexpr`符合 C++11。

[这个答案在[公共领域 CC0 1.0 Universal](http://creativecommons.org/publicdomain/zero/1.0/)]

            回答 #5

赞同：12

时间：2009-05-01T02:07:00.290

一些 BSD 系统可以满足`betoh64`您的需求。

            回答 #6

赞同：6

时间：2012-04-25T15:22:55.097

用于小端机器上 64 位交换的一行宏。

```
#define bswap64(y) (((uint64_t)ntohl(y)) << 32 | ntohl(y>>32)) 
```

            回答 #7

赞同：5

时间：2012-01-10T13:50:06.907

一个不依赖于输入大小的通用版本怎么样（上面的一些实现假设`unsigned long long`是 64 位，这不一定总是正确的）：

```
 // converts an arbitrary large integer (preferrably >=64 bits) from big endian to host machine endian
    template<typename T> static inline T bigen2host(const T& x)
    {
        static const int one = 1;
        static const char sig = *(char*)&one; 

        if (sig == 0) return x; // for big endian machine just return the input

        T ret;
        int size = sizeof(T);
        char* src = (char*)&x + sizeof(T) - 1;
        char* dst = (char*)&ret;

        while (size-- > 0) *dst++ = *src--;

        return ret;
    } 
```

            回答 #8

赞同：5

时间：2012-01-17T16:11:33.687

```
uint32_t SwapShort(uint16_t a)
{
  a = ((a & 0x00FF) << 8) | ((a & 0xFF00) >> 8);
  return a;
}

uint32_t SwapWord(uint32_t a)
{
  a = ((a & 0x000000FF) << 24) |
      ((a & 0x0000FF00) <<  8) |
      ((a & 0x00FF0000) >>  8) |
      ((a & 0xFF000000) >> 24);
  return a;
}

uint64_t SwapDWord(uint64_t a)
{
  a = ((a & 0x00000000000000FFULL) << 56) | 
      ((a & 0x000000000000FF00ULL) << 40) | 
      ((a & 0x0000000000FF0000ULL) << 24) | 
      ((a & 0x00000000FF000000ULL) <<  8) | 
      ((a & 0x000000FF00000000ULL) >>  8) | 
      ((a & 0x0000FF0000000000ULL) >> 24) | 
      ((a & 0x00FF000000000000ULL) >> 40) | 
      ((a & 0xFF00000000000000ULL) >> 56);
  return a;
} 
```

            回答 #9

赞同：3

时间：2009-06-05T13:55:45.693

怎么样：

```
#define ntohll(x) ( ( (uint64_t)(ntohl( (uint32_t)((x << 32) >> 32) )) << 32) | 
    ntohl( ((uint32_t)(x >> 32)) ) )                                        
#define htonll(x) ntohll(x) 
```

            回答 #10

赞同：2

时间：2009-05-01T18:22:18.760

我喜欢工会的答案，很整洁。通常我只是在小端和大端之间进行转换，尽管我认为联合解决方案的分配更少并且可能更快：

```
//note UINT64_C_LITERAL is a macro that appends the correct prefix
//for the literal on that platform
inline void endianFlip(unsigned long long& Value)
{
   Value=
   ((Value &   UINT64_C_LITERAL(0x00000000000000FF)) << 56) |
   ((Value &   UINT64_C_LITERAL(0x000000000000FF00)) << 40) |
   ((Value &   UINT64_C_LITERAL(0x0000000000FF0000)) << 24) |
   ((Value &   UINT64_C_LITERAL(0x00000000FF000000)) << 8)  |
   ((Value &   UINT64_C_LITERAL(0x000000FF00000000)) >> 8)  | 
   ((Value &   UINT64_C_LITERAL(0x0000FF0000000000)) >> 24) |
   ((Value &   UINT64_C_LITERAL(0x00FF000000000000)) >> 40) |
   ((Value &   UINT64_C_LITERAL(0xFF00000000000000)) >> 56);
} 
```

然后检测你是否需要在没有宏魔法的情况下进行翻转，你可以做一个与 Pax 类似的事情，当一个短路分配给 0x0001 时，它在相反的字节序系统上将是 0x0100。

所以：

```
unsigned long long numberToSystemEndian
(
    unsigned long long In, 
    unsigned short SourceEndian
)
{
   if (SourceEndian != 1)
   {
      //from an opposite endian system
      endianFlip(In);
   }
   return In;
} 
```

因此，要使用它，您需要 SourceEndian 作为指示符来传达输入数字的字节顺序。这可以存储在文件中（如果这是一个序列化问题），或者通过网络进行通信（如果这是一个网络序列化问题）。

            回答 #11

赞同：2

时间：2009-05-17T21:01:43.253

一种简单的方法是分别在这两个部分上使用 ntohl ：

```
unsigned long long htonll(unsigned long long v) {
    union { unsigned long lv[2]; unsigned long long llv; } u;
    u.lv[0] = htonl(v >> 32);
    u.lv[1] = htonl(v & 0xFFFFFFFFULL);
    return u.llv;
}

unsigned long long ntohll(unsigned long long v) {
    union { unsigned long lv[2]; unsigned long long llv; } u;
    u.llv = v;
    return ((unsigned long long)ntohl(u.lv[0]) << 32) | (unsigned long long)ntohl(u.lv[1]);
} 
```

            回答 #12

赞同：1

时间：2017-11-19T18:06:29.760

`htonl`可以通过以下步骤完成

*   如果它的大端系统直接返回值。无需进行任何转换。如果它的小端系统，需要做以下转换。
*   取 LSB 32 位并应用 'htonl' 并移位 32 次。
*   取 MSB 32 位（通过将 uint64_t 值向右移动 32 次）并应用 'htonl'
*   现在对第 2 步和第 3 步中收到的值应用按位或。

同样对于`ntohll`也

```
#define HTONLL(x) ((1==htonl(1)) ? (x) : (((uint64_t)htonl((x) & 0xFFFFFFFFUL)) << 32) | htonl((uint32_t)((x) >> 32)))
#define NTOHLL(x) ((1==ntohl(1)) ? (x) : (((uint64_t)ntohl((x) & 0xFFFFFFFFUL)) << 32) | ntohl((uint32_t)((x) >> 32))) 
```

您也可以将上述 2 个定义定义为函数。

            回答 #13

赞同：0

时间：2014-04-08T02:28:34.097

```
template <typename T>
static T ntoh_any(T t)
{
    static const unsigned char int_bytes[sizeof(int)] = {0xFF};
    static const int msb_0xFF = 0xFF << (sizeof(int) - 1) * CHAR_BIT;
    static bool host_is_big_endian = (*(reinterpret_cast<const int *>(int_bytes)) & msb_0xFF ) != 0;
    if (host_is_big_endian) { return t; }

    unsigned char * ptr = reinterpret_cast<unsigned char *>(&t);
    std::reverse(ptr, ptr + sizeof(t) );
    return t;
} 
```

适用于 2 字节、4 字节、8 字节和 16 字节（如果您有 128 位整数）。应该独立于操作系统/平台。

            回答 #14

赞同：0

时间：2020-09-24T02:51:17.043

```
union help64
{
    unsigned char byte[8];
    uint64_t quad;
};
uint64_t ntoh64(uint64_t src)
{
    help64 tmp;
    tmp.quad = src;
    uint64_t dst = 0;
    for(int i = 0; i < 8; ++i)
        dst = (dst << 8) + tmp.byte[i];
    return dst;
} 
```

            回答 #15

赞同：0

时间：2016-04-17T14:49:03.843

任何值大小的通用函数。

```
template <typename T>
T swap_endian (T value)
{
    union {
        T src;
        unsigned char dst[sizeof(T)];
    } source, dest;

    source.src = value;
    for (size_t k = 0; k < sizeof(T); ++k)
        dest.dst[k] = source.dst[sizeof(T) - k - 1];

    return dest.src;
} 
```

            回答 #16

赞同：0

时间：2015-09-07T20:50:27.447

这是假设您使用 64 位操作系统在 Linux 上进行编码；大多数系统都有`htole(x)`或`ntobe(x)`等等，这些通常是各种`bswap`的宏

```
#include <endian.h>
#include <byteswap.h>

unsigned long long htonll(unsigned long long val)
{
    if (__BYTE_ORDER == __BIG_ENDIAN) return (val);
    else return __bswap_64(val);
}

unsigned long long ntohll(unsigned long long val)
{
    if (__BYTE_ORDER == __BIG_ENDIAN) return (val);
    else return __bswap_64(val);
} 
```

边注; 这些只是调用以交换字节顺序的函数。例如，如果您使用 little endian 和 big endian 网络，但如果您使用 big endian 编码，那么这将不必要地反转字节顺序，因此`if __BYTE_ORDER == __LITTLE_ENDIAN`可能需要进行一点“”检查以使您的代码更具可移植性，具体取决于您的需要.

更新：编辑显示字节序检查的例子

            回答 #17

赞同：-1

时间：2011-05-09T12:48:48.730

通常不需要知道机器的字节顺序来将主机整数转换为网络顺序。不幸的是，仅当您以字节而不是另一个整数写出您的净订单值时才成立：

```
static inline void short_to_network_order(uchar *output, uint16_t in)
{
    output[0] = in>>8&0xff;
    output[1] = in&0xff;
} 
```

（根据需要扩展更大的数字）。

这将（a）适用于任何架构，因为我绝不会使用有关整数在内存中布局方式的特殊知识，并且（b）应该主要在大端架构中进行优化，因为现代编译器并不愚蠢。  

当然，缺点是这与 htonl() 和朋友的标准接口不同（我不认为这是一个缺点，因为 htonl() 的设计是一个糟糕的选择 imo）。

        apache - 基本 apache 服务器，映射 127.0.0.1 到 10.0.0.7:8000

ID：809909

赞同：0

时间：2009-05-01T01:58:45.007

标签：apache, windows-server-2003, localhost, ip

我正在处理这个项目，其中客户端有一个虚拟服务器设置。我安装了 apache 等，并且在 localhost 上一切正常。但是为了让它出现在互联网上，运行这个虚拟服务器的人需要我：

“如果您尝试访问 10.0.0.7:8000，您不会进入索引页面，但如果您访问 localhost，则会显示索引页面。您需要进行配置，使其监听本地 IP 10.0.0.7。”

现在我对这个法庭有点陌生（我只是一个简单的 webdev，喜欢把所有东西放在 localhost 上，并用常规的 ftp 上传他的东西）。我敢打赌，答案很简单，但他们的热线已关闭，因为他们横跨大西洋。有人可以告诉我如何绕过并做到这一点吗？（我几乎脸红，因为我不知道）。虚拟服务器在 Windows 2003 操作系统上运行

            回答 #1

赞同：3

时间：2009-05-01T02:05:59.920

我相信你应该会发现它相对容易做到：[听指令](http://httpd.apache.org/docs/2.0/mod/mpm_common.html#listen)

            回答 #2

赞同：1

时间：2009-05-01T02:51:54.443

转到 apache/conf 目录中的 httpd.conf 文件，并将监听指令中的端口和地址更改为：

听 10.0.0.7:8000

不要忘记重新启动服务。

        asp.net - ASP.Net 查看 PDF

ID：809913

赞同：2

时间：2009-05-01T02:01:20.587

标签：asp.net, pdf

有没有可能当你有一个网页时，当你打开 PDF 时，文件视图默认为 100% 大小？

谢谢。

            回答 #1

赞同：7

时间：2009-05-01T02:30:08.100

使用 Acrobat PDF 的[打开参数](http://partners.adobe.com/public/developer/en/acrobat/PDFOpenParameters.pdf)。

```
 <a href="/path/to/doc.pdf#zoom=100">PDF Link</a> 
```

            回答 #2

赞同：0

时间：2011-11-28T14:57:17.933

[在 URL 中指定 PDF 打开参数](http://www.heinelt.info/index.php?option=com_content&view=article&id=36&Itemid=52)有更多您可以指定的其他行为的示例，并且还链接到[tvanfosson 引用的 pdf。](https://stackoverflow.com/a/809967/41153)

        java - 基于 Parens 将字符串拆分为更小的部分

ID：809914

赞同：1

时间：2009-05-01T02:02:03.627

标签：java, algorithm, language-agnostic, string

使用java我正在尝试开发一种使用递归来分析形式的字符串的方法：

```
(PART0(PART1(PART2)(PART3))) 
```

我希望该方法拆分相关的字符串。我希望这种方法能够使我能够在字符串的每个部分上执行一些逻辑，而无需在此顺序中涉及括号：

```
PART2
PART3
PART1
PART0 
```

这是我的方法目前的样子：

```
private void check(String stmt) throws Exception {

    System.out.println(stmt);
    int firstIndex = 0;
    int lastIndex = 0;
    while(firstIndex !=-1){
        firstIndex = stmt.indexOf('(');
        lastIndex = stmt.lastIndexOf(')');

        check(stmt.substring(firstIndex+1,lastIndex));

     }
} 
```

到目前为止，这是我的输出：

```
(PART0(PART1(PART2)(PART3)))
PART0(PART1(PART2)(PART3))
PART1(PART2)(PART3)
PART2)(PART3 
```

基本上它在这部分分解：PART1(PART2)(PART3)

有没有更优雅的方法来做到这一点？

            回答 #1

赞同：11

时间：2009-05-01T02:28:35.793

嵌套上下文最自然地作为堆栈工作。

- 每次开始一个新的上下文（遇到'(') push()

-每次退出上下文（遇到'）'）pop（）

- 然后每个 pop() 将对应于完整的上下文

IE：

```
public static void main(String args[])
    {
         String s   = "(PART0(PART1(PART2)(PART3)))";
        Stack<StringBuilder> stack = new Stack<StringBuilder>();
        StringBuilder curr = null;
        for (int i = 0; i < s.length(); i++)
        {
            char c = s.charAt(i);
            if (c == '(')
            {
                curr = new StringBuilder();
                stack.push(curr);
            }
            else if (c == ')')
            {
                System.out.println(stack.pop());
            }
            else
            {
                curr.append(c);
            }
        }
    } 
```

您可能还想添加一些错误检查，即如果没有要推送或弹出的上下文，那么您的括号不匹配（格式错误的字符串）。

        php - 评论投票数据库结构的最佳实践

ID：809916

赞同：8

时间：2009-05-01T02:02:25.327

标签：php, mysql, comments, voting

我正在开发一个 PHP 应用程序，它有几个可以评论的对象。每个评论都可以投票，用户可以给它 +1 或 -1（如 Digg 或 Reddit）。现在我正计划有一个带有 user_id 和他们的投票信息的“投票”表，这似乎工作正常。

问题是，每个对象都有数百条评论，这些评论存储在一个单独的评论表中。加载评论后，我必须对投票进行统计，然后单独检查对用户的每张投票，以确保他们只能投票一次。这很有效，但似乎真的是数据库密集型的——很多查询只是为了评论。

有没有一种更简单的方法可以减少数据库密集度？我当前的数据库结构是最好的方法吗？

为了更清楚地了解当前的数据库结构：

**评论表：**

*   用户身份
*   object_id
*   总票数

**投票表：**

*   comment_id
*   用户身份
*   投票

**最终目标：**

*   允许用户对每条评论只投票一次，至少有 # 个 MySQL 查询（每个对象有多个评论）

            回答 #1

赞同：11

时间：2009-05-01T02:12:37.097

为确保每个选民只投票一次，请使用以下字段设计您的投票表：CommentID、UserID、VoteValue。将 CommentID 和 UserID 设为主键，这将确保一个用户只能获得一票。然后，要查询评论的投票，请执行以下操作：

```
SELECT SUM(VoteValue)
FROM Votes
WHERE CommentID = ? 
```

这有帮助吗？

            回答 #2

赞同：0

时间：2009-05-01T02:15:50.003

为什么不保存每条评论的总票数？当新的投票发生时增加/减少。

然后，您必须检查用户是否专门为此评论投票，以便每个用户每条评论只允许投一票。

            回答 #3

赞同：0

时间：2009-05-01T02:23:04.263

您可以放置​​一个 sql 连接条件，该条件返回当前用户对该对象所做的评论的所有投票，如果您没有得到任何行，则该用户没有投票。这与您在程序中逐条检查每个评论略有不同。

就数据库结构而言，将这些东西分开似乎是完全合乎逻辑的。投票 { user_id, object_id, object_type, vote_info ...)

你可能已经这样做了，抱歉，如果是这样的话，我无法从你的帖子中解释。

        c# - 控件中的多个 MouseHover 事件

ID：809922

赞同：7

时间：2009-05-01T02:08:09.773

标签：c#, winforms

我正在尝试在 C# 中实现自定义控件，我需要在鼠标悬停时获取事件。我知道有 MouseHover 事件，但它只触发一次。要让它再次触发，我需要使用控件的鼠标并再次输入。

有什么办法可以做到这一点吗？

            回答 #1

赞同：8

时间：2009-05-01T02:42:55.807

让我们将“停止移动”定义为“保持在`x`像素半径内`n`毫秒”。

订阅 MouseMove 事件并使用计时器（设置为`n`ms）来设置超时。每次鼠标移动时，检查公差。如果超出您的容忍范围，请重置计时器并记录新的原点。

伪代码：

```
Point lastPoint;
const float tolerance = 5.0;

//you might want to replace this with event subscribe/unsubscribe instead
bool listening = false;

void OnMouseOver()
{
    lastpoint = Mouse.Location;
    timer.Start();
    listening = true; //listen to MouseMove events
}

void OnMouseLeave()
{
    timer.Stop();
    listening = false; //stop listening
}

void OnMouseMove()
{
    if(listening)
    {
        if(Math.abs(Mouse.Location - lastPoint) > tolerance)
        {
            //mouse moved beyond tolerance - reset timer
            timer.Reset();
            lastPoint = Mouse.Location;
        }
    }
}

void timer_Tick(object sender, EventArgs e)
{
    //mouse "stopped moving"
} 
```

            回答 #2

赞同：6

时间：2009-10-22T21:04:05.703

我意识到这是一个老话题，但我想分享一种我发现的方法：在鼠标移动事件中，在捕获事件的控件上调用 ResetMouseEventArgs()。

            回答 #3

赞同：2

时间：2009-05-01T02:30:23.213

为什么不在 MouseHover 事件中订阅 MouseMove 事件，然后在 MouseLeave 事件中取消订阅

编辑：

确定鼠标是否停止的一种方法是每次收到鼠标移动事件时启动一个计时器，当计时器已过时，您可以认为鼠标已停止。删除 MouseLeave 上的 MouseMove 事件的原因将允许您仅在鼠标悬停在您的控件上时接收事件。

            回答 #4

赞同：1

时间：2012-08-17T20:49:01.840

这是我能想到的最干净的实现。它工作得很好：

```
 [DllImport("user32.dll")]
    static extern IntPtr SendMessage
    (
        IntPtr controlHandle,
        uint message,
        IntPtr param1,
        IntPtr param2
    );

    const uint WM_MOUSELEAVE = 0x02A3;

    Point lastMousePoint = Point.Empty;

    void richTextBox_MouseMove(object sender, MouseEventArgs e)
    {
        if (Math.Abs(e.Location.X - lastMousePoint.X) > 1 || Math.Abs(e.Location.Y - lastMousePoint.Y) > 1)
        {
            lastMousePoint = e.Location;

            SendMessage((sender as RichTextBox).Handle, WM_MOUSELEAVE, IntPtr.Zero, IntPtr.Zero);
        }
    }

    void richTextBox_MouseHover(object sender, EventArgs e)
    {
        foo();
    } 
```

            回答 #5

赞同：0

时间：2016-03-10T14:31:44.503

这是一个不依赖定时器的稍微简单的版本。只需记录最后一次鼠标移动的时间，然后在您想检查鼠标是否悬停时比较当前时间。

```
 private DateTime mouseMoveTime = DateTime.Now;
    private Point mouseMoveLoc = new Point();

    private bool IsHovering()
    {
        return (mouseMoveTime.AddMilliseconds(SystemInformation.MouseHoverTime)).CompareTo(DateTime.Now) < 0;
    }

    private void myControl_MouseMove(object sender, MouseEventArgs e)
    {
        // update mouse position and time of last move
        if (Math.Abs(e.X - mouseMoveLoc.X) > SystemInformation.MouseHoverSize.Width || 
            Math.Abs(e.Y - mouseMoveLoc.Y) > SystemInformation.MouseHoverSize.Height)
        {
            mouseMoveLoc = new Point(e.X, e.Y);
            mouseMoveTime = DateTime.Now;
        }
    } 
```

或者一个没有距离公差的非常短的版本。

```
 private DateTime mouseMoveTime = DateTime.Now;

    private bool IsHovering()
    {
        return (mouseMoveTime.AddMilliseconds(SystemInformation.MouseHoverTime)).CompareTo(DateTime.Now) < 0;
    }

    private void myControl_MouseMove(object sender, MouseEventArgs e)
    {
        mouseMoveTime = DateTime.Now;
    } 
```

只需使用 if (IsHovering())... 当您需要检查鼠标是否在移动时。

我注意到的一件事是，当您拖动时，MouseMove 不会被触发。但是，您可以将 mouseMoveTime/Loc 更新代码复制到您的拖动事件以解决此问题。

        php - 这是用 PHP 发送电子邮件的正确方法吗？

ID：809924

赞同：16

时间：2009-05-01T02:08:52.657

标签：php, email, encoding, utf-8

如果此功能以应有的方式发送可以在大多数电子邮件和网络邮件客户端上正确识别的电子邮件，我有点担心，特别是我最担心这个疑问：

*   UTF-8 声明和附件格式是否正确？
*   我需要使用quoted_printable_decode() 吗？如果是，在哪里？
*   内容传输编码：7 位还是 8 位？我一直看到 7，但由于我发送的是 UTF-8 编码的邮件，所以我不确定。
*   我应该使用 mb_send_mail() 还是 mail() 就足够了？

**编辑：我不知道为什么，但代码没有正确显示，我使它可用@ [http://gist.github.com/104818](http://gist.github.com/104818)**

**编辑 2：我知道用于电子邮件处理的其他替代方案（库），但为了我自己的好奇心和知识，我只想知道这段代码是否 100% 好，或者它是否有问题。**

```
function Email($name, $from, $to, $subject, $message, $bcc = null, $attachments = null)
{
    ini_set('SMTP', 'localhost');
    ini_set('sendmail_from', $from);

    $name = filter_var($name, FILTER_SANITIZE_STRING);
    $from = filter_var($from, FILTER_SANITIZE_EMAIL);
    $subject = filter_var($subject, FILTER_SANITIZE_STRING);

    $boundary = '_Boundary_' . md5(microtime(true) . mt_rand(0, PHP_INT_MAX));

    $headers = array
    (
        'MIME-Version: 1.0',
        'Content-Type: multipart/mixed; boundary="Mixed' . $boundary . '"',
        'Date: ' . date('r', time()),
        'From: "' . $name . '" <' . $from . '>',
        'Reply-To: "' . $name . '" <' . $from . '>',
        'Return-Path: "' . $name . '" <' . $from . '>',
        'X-Mailer: PHP ' . phpversion(),
        'X-Priority: 2',
        'X-MSMail-Priority: High',
        'X-Originating-IP: ' . $_SERVER['SERVER_ADDR'],
    );

    if (is_null($to) === false)
    {
        if (is_array($to) === false)
        {
            $to = explode(',', $to);
        }

        foreach ($to as $key => $value)
        {
            $to[$key] = filter_var($value, FILTER_SANITIZE_EMAIL);
        }

        $to = implode(', ', array_filter($to));
    }

    if (is_null($bcc) === false)
    {
        if (is_array($bcc) === false)
        {
            $bcc = explode(',', $bcc);
        }

        foreach ($bcc as $key => $value)
        {
            $bcc[$key] = filter_var($value, FILTER_SANITIZE_EMAIL);
        }

        $headers[] = 'BCC: ' . implode(', ', array_filter($bcc));
    }

    if (is_null($attachments) === false)
    {
        settype($attachments, 'array');

        foreach ($attachments as $key => $value)
        {
            if (is_file($value) === true)
            {
                $attachments[$key] = array
                (
                    '',
                    '--Mixed' . $boundary,
                    'Content-Type: application/octet-stream; name="' . basename($value) . '"',
                    'Content-Disposition: attachment; filename="' . basename($value) . '"',
                    'Content-Transfer-Encoding: base64',
                    '',
                    trim(chunk_split(base64_encode(file_get_contents($value)))),
                );

                $attachments[$key] = implode("\n", $attachments[$key]);
            }

            else
            {
                unset($attachments[$key]);
            }
        }

        $attachments = implode("\n", $attachments) . "\n";
    }

    $message = array
    (
        'This is a multi-part message in MIME format.',
        '',
        '--Mixed' . $boundary,
        'Content-Type: multipart/alternative; boundary="Alt' . $boundary . '"',
        '',
        '--Alt' . $boundary,
        'Content-Type: text/plain; charset="UTF-8"',
        'Content-Disposition: inline',
        'Content-Transfer-Encoding: 8bit',
        '',
        trim(strip_tags($message, '<a>')),
        '',
        '--Alt' . $boundary,
        'Content-Type: text/html; charset="UTF-8"',
        'Content-Disposition: inline',
        'Content-Transfer-Encoding: 8bit',
        '',
        trim($message),
        '',
        '--Alt' . $boundary . '--',
        $attachments,
        '--Mixed' . $boundary . '--',
    );

    if (@mail($to, stripslashes($subject), implode("\n", $message), implode("\n", $headers)) === true)
    {
        return true;
    }

    return false;
} 
```

            回答 #1

赞同：27

时间：2009-05-01T02:18:12.153

虽然这应该可行，但我强烈建议使用预构建的 Mail/SMTP 类，例如[Zend_Mail](http://framework.zend.com/manual/en/zend.mail.html)。虽然我不认为整个 Zend 框架是猫的睡衣，但我确实对他们的邮件处理代码有很好的看法。
编辑：我还应该补充一点，使用预构建的 Mail/SMTP 类将抽象多部分电子邮件的几乎所有复杂性/结构。
**2009-05-06 更新：**直接回答您的问题。

*   UTF-8 声明和附件格式是否正确？

他们看起来足够体面。

*   我需要使用`quoted_printable_decode()`吗？如果是，在哪里？

不，您只想`quoted_printable_decode()`在解码电子邮件时使用。不是当你编码一个。你应该使用**`quoted_printable_encode()`**吗？我接下来会讨论这个。

*   内容传输编码：7 位还是 8 位？我一直看到 7，但由于我发送的是 UTF-8 编码的邮件，所以我不确定。

如果您知道目标 SMTP 服务器可以支持，请仅使用 8 位编码。但是，由于您将电子邮件传递给本地 MTA，因此我不建议设置此值。默认值为 7 位编码，但它有自己的一组限制：代码范围 1-127 的每行最多 998 个八位字节，CR 和 LF 只允许作为 CRLF 行结尾的一部分出现（[https://www .rfc-editor.org/rfc/rfc2045#section-2.7](https://www.rfc-editor.org/rfc/rfc2045#section-2.7)）。
我建议您使用 Quoted-Printable ( [https://www.rfc-editor.org/rfc/rfc2045#section-6.7](https://www.rfc-editor.org/rfc/rfc2045#section-6.7) ) Content-Transfer-Encoding。你在哪里打电话`trim(strip_tags($message, '<a>'))`，`trim($message)`你会想用`quoted_printable_encode(trim(...))`.

*   我应该使用`mb_send_mail()`还是`mail()`足够？

如果您知道您**不会**处理多字节消息（日语、韩语、中文等），那么`mail()`就足够了。
现在我已经回答了您最初的问题，让我告诉您存在哪些问题。

1.  您正在指定纯文本和 Html 内容部分的字符集是 UTF-8，但是它并没有出现，因为您实际上是在确保它们确实是 UTF-8 编码的。
2.  `null`在进一步处理它们之前，您正在检查`$to`, `$bcc`，`$attachments`但是，当它们实际上可能是 时，您并没有做任何事情`null`。因此，如果您碰巧收到一个`null`for `$to`，您不会处理该变量，而是继续向 发送电子邮件`null`。

到目前为止，这就是我要介绍的全部内容，但我仍然强烈推荐一个预构建的解决方案，因为他们有很多用户/时间来解决错误。

            回答 #2

赞同：17

时间：2009-05-01T02:43:24.353

在大多数情况下，我完全支持自己滚动，但在邮件方面，我衷心建议让自己更轻松，并使用[Swift Mailer](http://swiftmailer.org/)或[PHPMailer](http://phpmailer.codeworxtech.com/)之类的东西（按这个顺序，为了我的钱）。

作为附带奖励（假设您指定回复等），您被标记为垃圾邮件的机会也少得多。

        silverlight - Silverlight 企业表单设计

ID：809927

赞同：3

时间：2009-05-01T02:10:35.463

标签：silverlight, user-interface, usability

我目前参与设计一个原型 Silverlight 3 应用程序，该应用程序由一家企业的呼叫中心操作员使用，他们通过电话和电子邮件进行查询。原型的目的是演示如何使用 Silverlight 来改进 UX 并克服在高延迟环境中使用 ASP.NET 网络表单的一些障碍。我不会详细介绍 Silverlight 3 vs 2 或 WPF 的环境或基本原理，这个问题是关于可用性的；

我正在寻找适合上述要求的优秀用户界面设计示例，这些示例突出了 Silverlight 的一些优点。它是一个原型，因此它可能比您通常的企业应用程序更性感，并且比您通常从用户需求中获得的更多花里胡哨。目标是既提供功能性的东西，又引入“哇”的因素。感谢您能想到的任何资源或示例。

            回答 #1

赞同：3

时间：2009-05-02T17:20:12.193

你有一个有状态的客户端——其中一件有趣的事情就是利用这个状态。例如：

1.  具有多个活动任务的以任务为中心的 UI。每个任务代表一个已经开始但尚未完成的流程/工作流。在有中断的情况下特别有用。

2.  在应用程序重新启动、浏览器关闭等情况下自动将草稿保存到本地隔离存储。当应用程序重新启动时，可以恢复任何部分填写的表格。

另一件事是上下文......或保留手头任务的上下文。例如，如果您想进行查找，您可以弹出一个对话框，而不是离开当前页面。

只是一些快速的想法......

            回答 #2

赞同：1

时间：2009-05-01T17:42:27.860

你看过[http://quince.infragistics.com](http://quince.infragistics.com)吗？虽然不是特定于 Silverlight，但它充满了经过验证的 UI 方法 - 而不是 Infragistics 特定的！

我发现它在设计表单和控件时非常有用，也许你会在那里找到一些好的建议。

            回答 #3

赞同：0

时间：2009-05-01T02:30:52.527

我喜欢它鼓励（强制）所有服务调用异步的方式。从用户体验的角度来看，这意味着您的表单在执行可能滞后的操作时没有被锁定。

动画也不错。虽然它们通常被认为是无用的绒毛，但它们可以减少用户在某些事情突然发生变化时所体验到的惊讶程度。它们也可以用来以一种比面部消息框更微妙的方式来吸引注意力。

        c# - Assembly.LoadFrom - 使用证据重载来验证强名称签名

ID：809934

赞同：1

时间：2009-05-01T02:12:46.627

标签：c#, .net, assemblies

是否可以使用带有 Evidence 参数的 Assembly.LoadFrom 重载来确保程序集被强命名？我希望能够指定程序集名称、文化、版本和公钥标记。如果任何这些信息不匹配，则程序集将无法加载。

            回答 #1

赞同：4

时间：2009-05-01T02:46:24.923

您可以在加载程序集后获取它的公钥 - 如果它成功加载并且有一个公钥，那么它就是强命名的：

```
Assembly assembly = Assembly.LoadFrom (...);
byte[] pk = assembly.GetName().GetPublicKey(); 
```

更好的是，在加载*之前*检查程序集的公钥和版本信息：

```
AssemblyName an = AssemblyName.GetAssemblyName ("myfile.exe");
byte[] publicKey = an.GetPublicKey();
CultureInfo culture = an.CultureInfo;
Version version = an.Version; 
```

如果 GetPublicKey() 返回非空值，然后程序集成功加载，则它具有有效的强名称。

            回答 #2

赞同：1

时间：2009-05-01T02:48:42.797

我有办法打破修补 System.Windows.Forms.dll 的强名称验证。如果我正在使用它，那么您无能为力。我的把戏需要完全信任。

我所做的是修补 dll，部署修补的 dll，ngen 它，然后修补加载程序以获取修补的 ngen 图像而不是原始图像。我本可以做的是破坏股票 ngened dll。（我实际上测试了这条路径，并认为可能破坏其他人的软件是一个糟糕的选择。）

我并不是说这是一个好主意。我是说根据 Assembly.Load 验证签名是一个坏主意。

            回答 #3

赞同：0

时间：2009-05-01T21:36:56.063

我找到了另一种方法来做到这一点。

```
var assemblyName = new AssemblyName(<fully qualified type name>);
assemblyName.CodeBase = <path to assembly>

Assembly.Load(assemblyName); 
```

            回答 #4

赞同：0

时间：2018-12-15T07:15:37.617

试试[System.ReflectionAssemblyNameFlags](https://docs.microsoft.com/en-us/dotnet/api/system.reflection.assemblynameflags)枚举：

```
bool f_public_key = ((asm.GetName().Flags & AssemblyNameFlags.PublicKey) != 0); 
```

        macos - .Xresources 无法在 Screen 中没有分散的窗口

ID：809935

赞同：1

时间：2009-05-01T02:12:59.683

标签：macos, terminal, gnu-screen

**初始问题：**当我在屏幕内的 Vim 中使用 vspilt 时没有分散的窗口

**尝试解决问题：** 

1.  **不可能：**增加Mac终端代码的显示刷新率
2.  向 .Xresources 添加一些内容

[替代文字 http://dl.getdropbox.com/u/175564/bugWithScreen.png](http://dl.getdropbox.com/u/175564/bugWithScreen.png)

Unix Power Tools -book 说这个问题可以在 .Xresources 中解决。但是，它没有具体说明如何。

我已将以下代码收集到我的 .Xresources

```
 mrxvt*scrollBar: true 
     mrxvt*loginShell: true
     mrxvt*syncTabTitle: true
     mrxvt*font: Monaco
     mrxvt*faceSize: 11 
     mrxvt*xft: True
     mrxvt*xftFont: Monaco
     mrxvt*xftSize: 12 
     mrxvt*xftAntialias: True
     mrxvt*termName: xterm-256color

     XTerm*VT100.metaSendsEscape: True                                                                                                                                                                        

     # translations used to coordinate xterm with xcilpboard
     # Unix Power Tools: p.117
     *VT100.Translations: #override\
         Button1 <Btn3Down>: select-end(primary,CUT_BUFFER0,CLIPBOARD)\n\
         !Shift <Btn2Up>: insert-selection(CLIPBOARD)\n\
         ~Shift ~Ctrl ~Meta <Btn2Up>: insert-selection(primary,CUT_BUFFER0) 
```

            回答 #1

赞同：2

时间：2009-05-01T02:32:00.730

这是在您运行 Tlist 时发生的，还是在重新连接到以前打开的会话时发生的？

如果是后者（并且您的窗口大小会有所不同），则可能是因为启动了选项屏幕。尝试使用这些选项“-aADR”启动屏幕。“-a”和“-A”将在重新连接时强制屏幕重绘。

            回答 #2

赞同：1

时间：2009-05-13T04:04:55.737

~/.Xresources 的解析在 X11 服务器启动时完成，作为 X11 会话初始化脚本的一部分。如果您编辑 ~/.Xresources 则需要使用 xrdb(1) 加载新文件，以告知正在运行的 X11 服务器有关更改。

请注意，默认情况下 xrdb(1) 将替换当前资源而不是覆盖它们，并且从标准输入读取是默认设置，因此不要在没有参数的情况下调用它！所以你想使用

```
xrdb -merge ~/.Xresources 
```

加载更改的文件。您可以使用

```
xrdb -query 
```

查看已经加载的内容。

对于 Mac，我不知道在哪里或何时查看 ~/.Xresources；因为 X11 的东西是一个使用显示器运行的程序，而不是一切图形的主人，它可能相当小，默认情况下不这样做。xrdb -query 会有所帮助。

可能有帮助的一件事是将 XAPPLRESDIR 设置为导出的 shell 变量；在 MacOS 的某个地方有一些旋钮可以将环境变量设置为会话事物，所有程序都可以看到而无需点击用户 shell，但我忘记了在哪里（在设置 SSH 钥匙串时找到了它）。XAPPLRESDIR 是一个环境变量变量，用于指向用户自己对应用程序资源的覆盖。它的值应该是一个目录（例如 $HOME/share/xapps/）。每个与 X Intrinsics 库 ( **libXt** ) 链接的 X11 应用程序都将在 X11 初始化时在该目录中查找与应用程序类名匹配的文件。这样就不用担心加载资源等问题了；编辑应用程序文件，启动程序。

因此 xterm 的资源进入文件 XTerm 等；要找出任意程序的类，您可以使用不带参数的 xprop(1)，在指针为十字准线时单击目标窗口，然后查看来自 xprop 的标准输出以获取 WM_CLASS 属性。对于一些像 xterm 这样的旧工具，您还可以使用 editres(1) 来通过远程检查以交互方式查看正在运行的 X 应用程序的小部件；有一个 Get Tree 菜单项，可让您单击目标应用程序和另一个菜单项以显示类名。

我自己，我的 ~/share/xapps/XTerm 文件将菜单背景颜色设置为可怕的黄色；这样，当我**控制-<left|middle|right>-click**在 XTerm 中时，我会立即知道是否有问题并且我的资源没有加载。

```
#ifdef 颜色
XTerm.SimpleMenu*背景：黄色
＃万一

```

        c# - 使用 Lambda 和委托进行重构

ID：809945

赞同：1

时间：2009-05-01T02:20:58.790

标签：c#, .net, refactoring, delegates, lambda

我刚刚安装了 VS2008 并遇到了一个问题，我确信可以使用 lambda 或委托（或组合！）来解决。

```
 private string ReadData(TcpClient s, string terminator)
    {
        // Reads a byte steam into a string builder until either data is unavailable or the terminator has not been reached
        var sb = new StringBuilder();
        do
        {
            var numBytesRead = s.GetStream().Read(byteBuff, 0, byteBuff.Length);
            sb.AppendFormat("{0}", Encoding.ASCII.GetString(byteBuff, 0, numBytesRead));
        } while (s.GetStream().DataAvailable && !sb.ToString().Contains(terminator));

        return sb.ToString();
    } 
```

问题是，有时我需要检查字符串是否包含两个不同值中的任何一个。有时我可能需要检查它的三个值。

所以我建议将“！sb.ToString().Contains(terminator)”更改为传递给方法的函数。

我可以编写不同的函数，例如：

```
private bool compare1(string s, string t) {
    return s.contains(t)
}

private bool compare2(string s, string t1, string t2) {
    return (s.compare(t1) or s.compare(t2)
}

// etc... 
```

然后，当我想与 3 个不同的值进行比较时，为其中一个函数创建一个委托，然后将其传递给 ReadData() 方法。

我对代表一无所知，我不确定这是否是 lambda 的正确位置，但有些东西告诉我它是。

调用代码是这样的：

```
 // Enter username .
        if (HasData(s,"login:"))
            SendData(s, switchUser + TelnetHelper.CRLF); 
```

HasData 与 ReadData 相同，但返回一个 bool 而不是字符串（我也想使用一些技巧将其分解为一种方法 - 但这是一个次要问题 - 尽管可以随意回答。

仅供参考：

```
 private bool HasData(TcpClient s, string terminator)
    {
        // Reads a byte steam into a string builder until either data is unavailable or the terminator has not been reached
        var sb = new StringBuilder();
        do
        {
            var numBytesRead = s.GetStream().Read(byteBuff, 0, byteBuff.Length);
            sb.AppendFormat("{0}", Encoding.ASCII.GetString(byteBuff, 0, numBytesRead));
        } while (s.GetStream().DataAvailable && !sb.ToString().Contains(terminator));

        return sb.ToString().Contains(terminator);
    } 
```

            回答 #1

赞同：4

时间：2009-05-01T02:26:27.733

听起来您正在寻找谓词函数。代替硬编码检查，将委托作为参数而不是可以进行检查

```
 private string ReadData(TcpClient s, Func<string,bool> predicate)
    {
        // Reads a byte steam into a string builder until either data is unavailable or the terminator has not been reached
        var sb = new StringBuilder();
        do
        {
            var numBytesRead = s.GetStream().Read(byteBuff, 0, byteBuff.Length);
            sb.AppendFormat("{0}", Encoding.ASCII.GetString(byteBuff, 0, numBytesRead));
        } while (s.GetStream().DataAvailable && !predicate(sb));

        return sb.ToString();
    } 
```

然后您可以创建几个包装器，它们只创建适当的委托并将其传递下去

```
public bool HasData(TcpClient c, string terminator) {
  return HasData(c, (s) => s.Contains(terminator));
}

public bool HasData(TcpClient c, string t1, string t2) {
  return HasData(c, (s) => s.Contains(t1) || s.Contains(t2));
} 
```

您甚至可以根据任意数量的终止符即时构建委托

```
public bool HasData(TcpClient c, params string[] terminatorList) {
  return HasData(c, (s) => terminatorList.Where(x => s.Contains(x)).Any());
} 
```

            回答 #2

赞同：1

时间：2009-05-01T12:07:49.037

一种选择是重载 ReadData() 方法以获取包含您正在检查的值的字符串数组。使用[扩展方法](http://msdn.microsoft.com/en-us/library/bb383977.aspx)，您可以扩展 Contains() 以获取字符串数组。

您的 ReadData() 方法可能是：

```
private string ReadData(TcpClient s, string[] terminators) {
    // Reads a byte steam into a string builder until either data is unavailable or the terminator has not been reached
    var sb = new StringBuilder();
    do
    {
        var numBytesRead = s.GetStream().Read(byteBuff, 0, byteBuff.Length);
        sb.AppendFormat("{0}", Encoding.ASCII.GetString(byteBuff, 0, numBytesRead));
    } while (s.GetStream().DataAvailable && !sb.ToString().Contains(terminators));

    return sb.ToString();
} 
```

Contains() 方法扩展可以是：

```
public static bool Contains ( this String str , String[] testValues )
{
    foreach ( var value in testValues )
    {
        if ( str.Contains( value ) )
            return true;
    }
    return false;
} 
```

此实现消除了每次需要测试不同数量的字符串时创建新谓词的需要。

            回答 #3

赞同：0

时间：2009-05-03T07:56:53.570

因为 lambdas 的语法对我自己（以及我团队的其他成员）来说有点陌生，所以我最终选择了一个稍微不同的解决方案。从上面的 .Any() 函数修改时，我无法弄清楚 .All() 的语法。

我还需要一个 .All() 函数，以确保找到列表中的所有终止符。所以我最终选择了以下内容：

```
delegate bool Predicate (string s, params [] string terminators);

bool HasAll(string s, params string [] terminators) {
    foreach (var t in terminators) {
       if (!s.contains(t)) return false;
    }
    return true;
}

bool HasAny(string s, params string [] terminators) {
    foreach (var t in terminators) {
        if (s.contains(t)) return true;
    }
    return false;
}
// Just looking now, I could also pass in a bool to switch between the two and remove one of these functions. But this is fairly clear

string ReadData(TcpClient sock, Function predicate, params [] string terminators) {
    var sb = new StringBuilder();
    do
    {  
        var numBytesRead = s.GetStream().Read(byteBuff, 0, byteBuff.Length);
        sb.AppendFormat("{0}", Encoding.ASCII.GetString(byteBuff, 0, numBytesRead));
    } while (s.GetStream().DataAvailable && !predicate(sb.ToString(), terminators);

    return sb.ToString();
} 
```

然后调用代码如下所示：

```
private void someFunc() 
{
    Predicate any = new Predicate(HasAny);
    Predicate all = new Predicate(HasAll);
    String response;

    // Check all strings exist
    response = ReadData(this.sock, all, "(", ")", "->")
    if (all(response, "(", ")", "->")
        SendData(this.sock, ...);

    // Check any string exists
    response = ReadData(this.sock, any, "Hi", "Hey", "Hello");
    if (any(response, "Hi", "Hey", "Hello"))
       SendData(this.sock, ...);
} 
```

我可能会在 Has[Any|All] 函数中添加空检查，将 do..while 反转为一段时间，然后只检查 response != null 而不是复制参数。这个解决方案适合我所有的用例，并且我认为是相当易读的。只要我做出我刚才提到的小改动。

不过，这整件事对我来说突出了我需要学习 lambda 表达式！

        windows-mobile - 在 Windows Mobile 上加载 JPEG

ID：809946

赞同：0

时间：2009-05-01T02:21:37.853

标签：windows-mobile, gdi, jpeg, windows-mobile-5.0

我正在寻找一种更快的方法将 JPEG（或 PNG？）加载到 Windows Mobile 上的 .NET 位图中...

我刚刚尝试加载 JPEG、PNG 和 GIF：

```
for (int i = 0; i < files.Length; i++)
{
    int tries = 10;
    while (--tries > 0)
    {
        int size = (int)new FileInfo(files[i]).Length;
        FileStream fs = new FileStream(files[i], FileMode.Open);
        sw.Reset();
        sw.Start();
        Bitmap b2 = new Bitmap(fs);
        sw.Stop();
        Debug.WriteLine(files[i] + "\n\t" + 
            sw.ElapsedMilliseconds.ToString());
        fs.Close();
    }
} 
```

```
JPEG（中）100ms~
```

```
JPEG (中档) 200ms~
```

```
PNG（64色）50ms~
```

```
GIF (32 dith) 50ms~
```

托管的 Bitmap 类可能不是最快的 - 但有人确定吗？

            回答 #1

赞同：0

时间：2009-05-01T12:55:59.187

真的没有别的了。你可以使用像 Imaging APIs 这样的东西来加载它，但是 1）我怀疑它真的会更快，2）你不能将它用作托管图像或位图，所以它会非常没用（加上 I/我很确定这就是框架正在做的事情）。  

这些图像有多大（分辨率和颜色深度）？这将是一个很大的因素是加载需要多长时间。

        c++ - Visual C++ 中的 DLL 引用

ID：809948

赞同：49

时间：2009-05-01T02:22:21.550

标签：c++, visual-c++, dll

我有 C++ 经验，但没有 MSVC。

我想做的是将开源项目中的 .dll 合并到我的项目中。代码可用，我已经构建了它。我有 .dll 和 .lib，据我了解，它是 C++ 项目所必需的。

现在不幸的是，没有简单的“添加引用”，将我的 .dll 放入包含目录并将其添加到我的解决方案中。我已经编辑了项目属性页、C/C++ 附加包含目录选项以及添加 .lib 作为附加链接器依赖项。我在我的解决方案树中为 dll 和 lib 创建了一个包含目录。

我的问题是当我尝试包含文档中的头文件时，VS 输出会吐出错误消息。现在我意识到我正在使用 dll/lib 组合，并且我的解决方案中不存在 .h 文件，那么如何添加正确的包含？我正在使用 QT 工具包，它也在工作，但我如何从开源库中添加其他头文件/dll 却让我望而却步。

有人可以指出我正确的方向。

            回答 #1

赞同：80

时间：2009-05-01T03:48:14.743

你需要做几件事来使用这个库：

1.  确保您拥有要使用的库中的 *​​.lib 和 *.dll。如果您没有 *.lib，请跳过 #2

2.  在项目中添加对 *.lib 的引用。右键单击解决方案资源管理器中的项目名称，然后选择 Configuration Properties->Linker->Input 并将 lib 的名称放在 Additional Dependencies 属性中。

3.  您必须确保 VS 可以找到您刚刚添加的库，因此您必须转到工具菜单并选择选项...然后在项目和解决方案下选择 VC++ 目录，编辑库目录选项。在此处，您可以通过在“显示目录：”下拉框中选择“库文件”来设置包含新库的目录。只需在目录列表中添加 lib 文件的路径即可。如果你没有一个库，你可以省略它，但是当你在这里时，你还需要在“包含文件”下设置包含头文件的目录。以与添加库相同的方式执行此操作。

完成此操作后，您应该可以使用您的库了。如果您没有 lib 文件，您仍然可以通过自己导入来使用 dll。在应用程序启动期间，您可以通过调用 LoadLibrary 显式加载 dll（有关详细信息，请参阅：http: [//msdn.microsoft.com/en-us/library/ms684175 (VS.85).aspx）](http://msdn.microsoft.com/en-us/library/ms684175(VS.85).aspx)

干杯!

编辑

请记住使用#include < Foo.h > 而不是#include "foo.h"。前者搜索包含路径。后者使用本地项目文件。

            回答 #2

赞同：3

时间：2009-05-01T03:50:54.987

附加的包含目录是相对于项目目录的。这通常是您的项目文件 *.vcproj 所在的目录。我想在您的情况下，您必须将“包含”添加到您的包含和库目录中。

如果你想确定你的项目目录是什么，你可以检查 $(ProjectDir) 宏的值。为此，请转到“C/C++ -> Additional Include Directories”，按“...”按钮，然后在弹出对话框中按“Macros>>”。

            回答 #3

赞同：1

时间：2009-05-01T02:46:26.327

您提到添加额外的包含目录 (C/C++|General) 和额外的 lib 依赖项 (Linker|Input)，但您是否还添加了额外的库目录 (Linker|General)？

包含示例错误消息也可能有助于人们回答问题，因为甚至不清楚错误是在编译期间还是在链接期间。

        php - 数据库搜索词突出显示和结果截断

ID：809950

赞同：1

时间：2009-05-01T02:22:48.367

标签：php, mysql, full-text-search

我目前正在数据库中对我的“页面”执行全文搜索。虽然用户得到了他们想要的结果，但我无法向他们提供相关信息，说明为什么会出现这些结果。

我正在寻找的规格：

1.  我有 HTML 数据，这意味着如果您搜索诸如“测试”之类的术语并且结果页面包含`<b>here is some test</b> page`. 我应该能够在不对页面上的 html 代码产生不利影响的情况下突出显示该术语。
2.  我只想返回文档的一部分，就像 google 一样；返回的部分包含我的搜索词的很大一部分。如何确定哪个部分包含最多的术语？最好是确定哪个部分返回的总体字词最多，还是具有最多单个搜索字词的部分，或两者的组合？还是应该包含多个信息片段？
3.  我想做这个服务器端，如果这是一个可行的选择？

我不确定做这两件事的最佳方法是什么。我确实知道一个很容易被忽视的问题，需要考虑：

一个。如果您不小心，在随机点截取 html 数据可能会完全破坏页面，例如，不关闭 div 标签可能会破坏我的整个布局。围绕这个问题的最佳解决方案是什么？

实现上述搜索系统的最佳方法是什么？

            回答 #1

赞同：1

时间：2009-05-01T03:58:53.987

1.  我不会在搜索结果中保留 HTML 格式。这会使您的结果页面非常混乱。在结果描述中包含标题、换行符、图像、段落边距等是没有意义的——特别是如果您只打算打印截断内容的简短摘录。
2.  我认为在大多数情况下，一次匹配 100% 的搜索词的结果将比仅匹配 50% 的搜索词重复两次的结果更相关。但这也取决于查询。
3.  这是唯一可行的选择，除非您想一次向客户端发送所有结果页面。

由于您使用的是 MySQL 的内置全文搜索功能，因此您无法真正向用户展示结果*为何*如此——除非详细了解全文搜索如何确定相关性。您可以做的是向用户显示可能与他们的搜索相关的每个页面的摘录，并可以帮助他们做出有用的决定来查看哪些结果。

我会首先使用 剥离任何标记的页面内容`strip_tags()`，然后`explode()`将内容转换为单个句子的数组。然后您可以遍历数组以确定每个句子的相关性，然后简单地向用户显示最相关的句子。如果最相关的句子太长，则在单词边界处截断它。

```
$text = strip_slashes($content);
$sentences = explode('.  ', $text);
$relevance = array();
foreach ($sentences as $i=>$sentence) {
    $rel = 0;
    $relevance[$i] = calcRel($sentence);
}
arsort($relevance);
list($i, $j) = array_keys($relevance);
$ellips = (abs($i-$j)>1?'...':'');
if ($i < $j) {
    $description = $sentences[i].$ellips.$sentences[j];
} else {
    $description = $sentences[j].$ellips.$sentences[i];
} 
```

`calcRel($sentence)`将返回一个数值，表示通过以下方式计算的相关性：

1.  搜索`$sentence`整个查询字符串。对于每次出现，相关性数将增加 2^n；其中 n 是查询字符串中的单词数。
2.  搜索部分匹配——再次按 2^n 加权；n 是匹配的单词数。
3.  搜索单个查询词，为每个匹配项赋予 1 的权重。
4.  最后，在上述每个搜索中，应该删除匹配的单词/短语，`$sentence`这样它们就不会被计算多次。

另一种策略可能是扫描整个文本以查找搜索词，记录每个匹配项的位置。然后使用简单的算术，您可以找到最紧密的搜索关键字集群并以这种方式选择您的摘录，在单词边界或句子边界处截断。

            回答 #2

赞同：0

时间：2009-05-09T20:24:10.263

```
try preg_match(); with preg_replace(); 
```

        vb.net - 在 VS 2005 (VB.net) 中创建应用程序最重要部分的概述“大纲”的最简单方法是什么？

ID：809953

赞同：0

时间：2009-05-01T02:23:15.760

标签：vb.net, visual-studio

我想在我们的 VB.net 中编写代码，以便更容易理解，既可以提高可读性，也可以更轻松地了解放置新代码/功能的最佳位置。

本质上，我想要一个 10,000 英尺的代码“大纲”，其中包含从大纲到代码的超链接。

它需要是可移植的，所以 BookMarks 不会起作用（我认为）。我在想也许是 TODO 评论。我想创建我们自己的 Todo 样式注释，例如“大纲”或其他内容，但该关键字也需要在 VS 的配置文件中（但保持同步只是一件事）。

所以像：

TODO: 1 : 应用程序启动

TODO: 2 : 读取 INI 设置

TODO: 3: 显示启动画面

TODO：4：开始课程（这是教育软件）

TOOO：5：开始锻炼

TODO：6：下一个练习

TODO：7：结束课程

待办事项：8：AppExit

还有其他想法吗？

            回答 #1

赞同：0

时间：2009-05-10T21:19:02.053

我正在使用一些旧的 VB6 代码并想到了这种方法：

创建一个`Sub CodeOutline (Order as Double, Description as string)`

然后在代码的各个地方调用它：

```
CodeOutline 1, "App Starts"
CodeOutline 2, "Load Settings"
CodeOutline 3, "Start Lession" 'This is educational software to it has "lessons and exercises"
CodeOutline 4, "Next Exercise"
CodeOutline 5, "Lesson Finished" 
```

现在你可以做几件事：

1.  在上面`Sub`你可以放一个调试语句。（我们有一个“调试模式”，我们可以将应用程序置于任何调试消息将报告为 的位置`Msgox`）。

    ```
    CodeOutline (Order as double, descr as string)
       SysMsg cstr(Order) & " -" & Descr, Msg_Debug
    end 
    ```

2.  您还可以在 CodeOutline 中放置断点

3.  您可以在 CodeOutline 上搜索并获得一个列表（如果您使用 MzTools 的 vb6 插件搜索功能（远优于内置的 vb6），则通常按 Order 参数排序。搜索结果是超链接的。

搜索结果示例

```
Tutor
   Modules
      COMMON (COMMON.BAS)
         Sub Main()
            CodeOutline 1, "Startup"
            CodeOutline 6, "Checking Registration status"
            CodeOutline 4, "Loading Splash Screen"
         Public Sub CodeOutline(Order As Double, sDescription As String)
            Public Sub CodeOutline(Order As Double, sDescription As String)
            '   do a Search on CodeOutline  to see all the code outlines
            On Error GoTo CodeOutline_Error
            CodeOutline_Error:
            sysMsg "Error " & Err.Number & " (" & Err.Description & ") in procedure CodeOutline of Module COMMON" & ",," & Err.Description, MSG_LOG
      IO (IO.BAS)
         Sub APP_INITIALIZE()
            CodeOutline 2, "Initializine App"
            CodeOutline 3, "Exiting from App_initialize"
   Forms
      frmSplash (SPLASH.FRM)
         Private Sub Command2_Click(index As Integer)
            CodeOutline 4.1, "User Clicked button # " & index & " on Splash screen"
         Private Sub Form_Load()
            CodeOutline 5, "Exiting from frmSplash.Load"
         Private Sub tmrUnload_Timer()
            CodeOutline 6, "Preparing to unload the Splash Form, tmrUnload" 
```

            回答 #2

赞同：0

时间：2009-05-01T02:29:53.857

您是否检查过 Visual Studio 的 Rock Scroll 插件。它具有您正在寻找的几个功能。

*   [http://microsoftdev.blogspot.com/2008/05/rock-scroll-visual-studio-plugin.html](http://microsoftdev.blogspot.com/2008/05/rock-scroll-visual-studio-plugin.html)
*   [http://weblogs.asp.net/nunogomes/archive/2008/12/09/visual-studio-add-in-rockscroll.aspx](http://weblogs.asp.net/nunogomes/archive/2008/12/09/visual-studio-add-in-rockscroll.aspx)

            回答 #3

赞同：0

时间：2009-05-06T10:34:15.630

这可能很明显，如果我错过了您所要求的内容的精髓，很抱歉，但会是这样的：

```
#Region "application start"
.
.
#End region 
```

有帮助吗？

            回答 #4

赞同：0

时间：2009-05-01T14:16:23.237

看起来您可以使用带有良好注释的 Whitehorse 图（VS 2005 类图工具）走得很远。我什至可能会建议一个影响排序顺序的名称。如果它是唯一的类图，那么优秀的 VS 开发人员会感觉到它必须告诉他们关于代码模型的内容。

如果代码不能通过简单、良好的注释来描述流程的对象模型......也许它需要重构，以便它确实适合那个简单的视图？

        regex - 如何使用 Perl 匹配 Unicode 文本中的俄语单词？

ID：809956

赞同：3

时间：2009-05-01T02:25:29.170

标签：regex, perl, unicode

我有一个我想在其上进行正则表达式的网站，例如[http://www.ru.wikipedia.org/wiki/perl](http://www.ru.wikipedia.org/wiki/perl)。该网站是俄语的，我想提取所有俄语单词。匹配`\w+`不起作用，匹配会`\p{L}+`检索所有内容。

我该怎么做？

            回答 #1

赞同：4

时间：2013-02-05T15:30:38.503

所有这些答案都过于复杂。用这个

`$text =~/\p{cyrillic}/`

班。

            回答 #2

赞同：3

时间：2009-05-01T03:08:19.490

```
perl -MLWP::Simple -e 'getprint "http://ru.wikipedia.org/wiki/Perl"'
403 Forbidden <URL:http://ru.wikipedia.org/wiki/Perl> 
```

好吧，这没有帮助！

首先下载一个副本，这似乎工作：

```
use Encode;

local $/ = undef;
my $text = decode_utf8(<>);

my @words = ($text =~ /([\x{0400}-\x{04ff}]+)/gs);

foreach my $word (@words) {
  print encode_utf8($word) . "\n";
} 
```

            回答 #3

赞同：0

时间：2009-05-01T02:38:01.153

好的，那就试试这个：

```
#!/usr/bin/perl

use strict;
use warnings;
use LWP::UserAgent;

my $ua = LWP::UserAgent->new;

my $response = $ua->get("http://ru.wikipedia.org/wiki/Perl");

die $response->status_line unless $response->is_success;

my $content = $response->decoded_content;

my @russian = $content =~ /\s([\x{0400}-\x{052F}]+)\s/g;

print map { "$_\n" } @russian; 
```

我相信西里尔文字符集以 开始，`0x0400`而西里尔文补充字符集以 结束`0x052F`，所以这应该得到很多单词。

            回答 #4

赞同：-1

时间：2015-01-21T10:41:45.687

把这个留在这里。匹配特定的俄语单词

```
use utf8;
...
utf8::decode($text);
$text =~ /привет/; 
```

        .net - 使用 linq to xml 读取 CDATA

ID：809964

赞同：2

时间：2009-05-01T02:28:51.660

标签：.net, xml, linq, linq-to-xml

我有以下 xml 文件，似乎无法弄清楚如何获取元素中的值（这些元素隐藏在 CDATA 中）。我正在尝试为此使用 linq to xml。如果有人知道如何将其转换为“产品”对象（假设我们有一个产品对象，其属性与元素名称相同）。提前致谢。

鲍勃

```
<CNETResponse realm="cnet" version="1.0" xmlns="http://api.cnet.com/rest/v1.0/ns" xmlns:xlink="http://www.w3.org/1999/xlink">
<TechProduct id="33517677">
    <Name><![CDATA[Nikon CoolPix L20 (deep red)]]></Name>
    <Topic id="1670"></Topic>
    <ImageURL width="60"><![CDATA[http://i.i.com.com/cnwk.1d/sc/33517677-2-60-0.gif]]></ImageURL>
</TechProduct>
</CNETResponse> 
```

            回答 #1

赞同：2

时间：2009-05-01T04:20:30.080

问题是名称空间 - 例如，类似：

```
XNamespace ns = "http://api.cnet.com/rest/v1.0/ns";
XElement techProd = doc.Root.Element(ns + "TechProduct");

Product product = new Product {
    Id = (int)techProd.Attribute("id"),
    Name = techProd.Element(ns + "Name").Value,
    Topic = techProd.Element(ns + "Topic").Value,
    TopicId = (int)techProd.Element(ns + "Topic").Attribute("id"),
    ImageUrl = techProd.Element(ns + "ImageURL").Value,
    ImageWidth = (int)techProd.Element(ns + "ImageURL").Attribute("width"),
}; 
```

您可能还喜欢`XmlSerializer`- 类似：

```
XmlSerializer ser = new XmlSerializer(typeof(CnetResponse));
CnetResponse response = (CnetResponse)ser.Deserialize(new StringReader(xml));
TechProduct product = response.TechProduct; 
```

类定义如下：

```
[Serializable, XmlRoot("CNETResponse", Namespace = CnetResponse.Namespace)]
public class CnetResponse {
    public const string Namespace = "http://api.cnet.com/rest/v1.0/ns";
    public TechProduct TechProduct { get; set; }
}
[Serializable, XmlType(Namespace = CnetResponse.Namespace)]
public class TechProduct
{
    [XmlAttribute("id")]
    public int Id { get; set; }
    public string Name {get;set;}
    public Topic Topic { get; set; }
    [XmlElement("ImageURL")]
    public Image Image { get; set; }        
}
[Serializable, XmlType(Namespace = CnetResponse.Namespace)]
public class Topic {
    [XmlAttribute("id")]
    public int Id { get; set; }
    [XmlText]
    public string Text {get;set;}
}
[Serializable, XmlType(Namespace = CnetResponse.Namespace)]
public class Image {
    [XmlAttribute("width")]
    public int Width { get; set; }
    [XmlText]
    public string Url {get;set;}
} 
```

或者，只需运行 xml`xsd.exe`以获取适合的 C# 代码：

```
xsd foo.xml
xsd foo.xsd /classes 
```

            回答 #2

赞同：1

时间：2009-05-01T04:14:53.197

假设你的`Product`类有这里使用的构造函数，试试这个，`rawXml`CNET 响应 XML 在哪里：

```
XElement cnetResponse = XElement.Parse(rawXml);

IEnumerable<NameQty> products =
    from e in cnetResponse.Descendants("TechProduct")
    select new Product(
        (string)e.Element("Name"),
        (int)e.Element("Topic").Attribute("id"),
        (string)e.Element("ImageURL")
    );

foreach(Product p in products)
{
    // do stuff
} 
```

我无法使用机器来测试它，所以我不做任何保证。

        jquery - jQuery 和 ajax 库在拇指点击时淡入淡出效果！

ID：809965

赞同：0

时间：2009-05-01T02:29:43.373

标签：jquery, fade

需要一些帮助，请。

我有一行水平缩略图加载为一个图像，其中通过图像映射引用不同的缩略图图像，如下所示：

```
<div id="zoom">
    <img src="" />
</div>
<div id="collectionindex">
    <img src="thumbnail-strip.jpg" alt="" usemap="#Map" />
        <map name="Map" id="Map">
            <area shape="rect" coords="151,0,211,39" href="image1.jpg" alt="" />
            <area shape="rect" coords="215,0,275,39" href="image2.jpg" alt="" />
            <area shape="rect" coords="279,0,339,39" href="image3.jpg" alt="" />
            <area shape="rect" coords="343,0,403,39" href="image4.jpg" alt="" />
            <area shape="rect" coords="407,1,467,40" href="image5.jpg" alt="" />
            <area shape="rect" coords="471,0,531,39" href="image6.jpg" alt="" />
        </map>
</div> 
```

id="zoom" 的 div 中的 IMG 标记是我的 AJAX 缩放窗口，当用户“单击”缩略图以显示图像的较大版本时。

这是我必须在 ZOOM 框中的缩略图的 LARGE 版本中淡入淡出的 jQuery 代码。

```
<script type="text/javascript">
$(document).ready(function(){

$("area").click(function(){

        var largePath = $(this).attr("href");

        $("#zoom img").attr({ src: largePath }).fadeIn("slow"); return false;
            });
    });
</script> 
```

现在，jQuery 只在第一次点击缩略图时淡入，其余的只是在点击时出现，而不是淡入。我希望它以这种方式工作：

*   用户点击缩略图
*   大图像淡入缩放框
*   用户点击另一个缩略图
*   第一个图像 FADES OUT 和第二个选定的缩略图 FADES IN
*   等等

我希望我解释清楚。:) 任何帮助将不胜感激。

            回答 #1

赞同：2

时间：2009-05-01T02:32:53.740

您只需要在更改路径并将其淡入之前淡出图像...因此您的点击功能应变为：

**编辑**：忘记了显示/隐藏动画是异步发生的，所以你需要在淡出上使用回调来触发其余的......代码应该是：

```
<script type="text/javascript">
    $(document).ready(function () {
        $("area").click(function () {
            var largePath = $(this).attr("href");
            $("#zoom img").fadeOut("slow", function () {
                $(this).attr({ src: largePath }).fadeIn("slow");
            });
            return false;
        });
    });
</script> 
```

            回答 #2

赞同：0

时间：2009-05-01T02:44:37.190

我是新来的，刚刚看到我对您的回复的评论风格非常糟糕。:P

感谢您的快速回复 - 刚刚尝试过，但它看起来像是显示新选择的大图像，淡出，然后再次淡入。

我需要它：

*   用户选择后淡入第一张图像
*   用户选择下一张图片 > 淡出第一张图片 > 淡入下一张图片
*   等等等等。

        linux - 如何创建 77 个文件，其内容是每个文件的名称？

ID：809970

赞同：1

时间：2009-05-01T02:30:39.393

标签：linux, file

让我们举个例子。“file1”-文件有一个内容“file1”，它自己的名字。“file2”文件有一个内容“file2”，也是它自己的名字。这种模式一直持续到我们覆盖了 77 个文件。做77个文件的最简单方法是什么？

*由于我在编译时往往很难，所以我总结了一些细节。*

**说明如何编译代码**

权限：“chmod 700 文件名.some_ending”

正在运行：“../filename.some_ending”

**如何编译？** 

1.  将 gcc 用于 C++/C，如“gcc filename.c”，然后运行“../a.out”
2.  将 javac 用于 Java，例如“javac filename.javac”，然后使用“java class”运行它（错误？！）
3.  弗兰克？
4.  ... 更多的？

            回答 #1

赞同：19

时间：2009-05-01T02:33:06.860

```
#!/bin/bash
for i in {1..77}
do
   echo file$i > file$i
done 
```

            回答 #2

赞同：6

时间：2009-05-01T02:48:37.913

Python：

```
for i in range(1,78): open("file" + str(i), "w").write("file" + str(i)) 
```

            回答 #3

赞同：4

时间：2009-05-01T03:09:52.323

C++：

```
#include <sstream>
#include <fstream>

using namespace std;

int main()
{
     for (int i = 1; i <= 77; i++) {
          stringstream s;
          s << "file" << i;
          ofstream out(s.str().c_str());
          out << s.str();
          out.close();
     }
     return 0;
} 
```

            回答 #4

赞同：4

时间：2009-05-01T03:25:16.920

C：

```
#include <stdio.h>

int main() {
    char buffer[8];
    FILE* f;
    int i;
    for(i = 1; i <= 77; i++){
        sprintf(buffer, "file%d", i);
        if((f = fopen(buffer, "w")) != NULL){
            fputs(buffer, f);
            fclose(f);
        }
    }
    return 0;
} 
```

            回答 #5

赞同：3

时间：2009-05-01T02:39:26.390

Java版，好玩。

```
import java.io.*;

public class HA {
    public static void main(String[] args) throws Exception {
        String file = "file";
        for (int i = 1; i <= 77; i++){
            PrintStream out = new PrintStream(new File(file + i));
            out.print(file + i);
            out.close();
        }
    }
} 
```

            回答 #6

赞同：3

时间：2009-05-01T02:44:14.523

珀尔：

```
#!/usr/bin/env perl
for ( my $i = 1; $i <= 77; ++$i )
{
    open( my $fh, '>', 'file' . $i );
    print { $fh } ( 'file' . $i );
    close( $fh );
} 
```

            回答 #7

赞同：3

时间：2009-05-01T03:02:38.050

我添加了扩展名，假设文件会有它。

Fortran：

```
character(11) file_name
do i=1,77
  write(file_name,"('file',i2.2,'.txt')")i
  open(unit=1, file=file_name, status='replace')
  write(1,"(a)")file_name
  close(unit=1)
enddo
end 
```

            回答 #8

赞同：2

时间：2009-05-01T03:20:41.130

Python 版本适合那些更喜欢可读而不是简洁的人：

```
filenames = ("file%(num)d" % vars() for num in range(1, 78))
for filename in filenames:
    open(filename, 'w').write(filename) 
```

            回答 #9

赞同：1

时间：2009-05-01T03:51:44.673

C#，为什么不：

```
using System.IO;

namespace FileCreator
{
    class Program
    {
        static void Main(string[] args)
        {
            for (int i = 1; i <= 77; i++)
            {
                TextWriter f = new StreamWriter("file" + i);
                f.Write("file" + i);
                f.Close();
            }
        }
    }
} 
```

            回答 #10

赞同：1

时间：2009-05-01T04:19:18.477

红宝石：

```
77.times { |i| File.open("file#{i+1}", "w") { |f| f.puts "file#{i+1}" } } 
```

            回答 #11

赞同：1

时间：2009-05-01T04:31:17.557

德尔福/自由帕斯卡

```
program Create77Files;

{$APPTYPE CONSOLE}

uses
  Classes, SysUtils;

var
  I: Integer;
  S: string;
begin
  for I := 1 to 77 do
  begin
    S:= 'file' + IntToStr(I);
    with TStringStream.Create(S) do
    begin
      SaveToFile(S);
      Free;
    end;
  end;
end. 
```

            回答 #12

赞同：0

时间：2012-10-15T19:08:45.217

时髦的：

```
77.times{n->n++;new File('file'+n).withWriter{it.writeLine('file'+n)}} 
```

        hibernate - 是否实现了休眠缓存机制，以便它可以（如果配置正确）作为它背后的数据库的短期“替换”？

ID：809972

赞同：0

时间：2009-05-01T02:31:33.367

标签：hibernate, caching

这意味着我想加载一组对象并在对该数据对象或对象集进行操作的不同查询时专门使用缓存，而不是让查询“泄漏”回数据库。如果答案是肯定的，哪个缓存提供程序提供或全部提供，我需要利用哪些配置参数？

            回答 #1

赞同：0

时间：2009-05-01T04:10:24.240

我认为，如果您在查询缓存中缓存所需的查询以及二级缓存中的所有实体（查询缓存仅存储标识符），那么是的，只要实体被水合到您在二级缓存中需要它们的程度。

但是，对会话中表的任何更新都会强制刷新查询缓存，并且任何未水合的延迟加载集合都会在访问它们时导致查询发生。

        c# - 在面板上使用 C# WinForms Designer 而不是再次使用表单？

ID：809981

赞同：0

时间：2009-05-01T02:35:15.310

标签：c#, winforms, user-controls, panel

我有同样的问题，但使用 UserControl 的答案不行。我还需要创建一个控件容器，我可以在设计时添加其他控件，这样我就可以将它添加到另一个容器（Splitter Panel）中，这在设计时对我来说是不可用的（插件架构）。当我制作一个用户控件时，它缺少设计时支持，当我将控件放到这个表面上时，我得到的只是图标。

我是否需要自己添加所有设计时间支持，或者我是否缺少一些对我有用的东西？

            回答 #1

赞同：0

时间：2010-04-30T03:38:10.873

您将不得不使用 Form 或 UserControl 来完成设计器中的任何表单设计。  

我经常创建需要大量操作的控件。从 UserControl 开始，然后添加一个填充 UserControl 的面板。这是您将使用所有控件填充的基本面板。然后我保存为一个重复的控件并简单地删除 UserControl 并将面板保留为公共 UI 控件，然后将其实例化。如果我要进行更改，我可以返回到原来的 UserControl，进行更改、添加代码等 - 冲洗并重复。

        jquery - 有没有人使用过 MIX 实验室的 Glimmer 工具，一般意见是什么？

ID：809985

赞同：0

时间：2009-05-01T02:36:36.257

标签：jquery, ide

Mix Labs 发布了[Glimmer 应用程序](http://visitmix.com/lab/glimmer)，这是一个使用 jQuery 制作精美效果的 IDE。我下载了它并用它做了一些事情。我认为这很漂亮，但我不确定我会在“现实生活”中使用它。关于它的有用性和它生成的代码质量的普遍看法是什么？

            回答 #1

赞同：1

时间：2009-05-01T07:17:36.317

看到这个，我的第二个感觉很糟糕。这个应用程序与我们被告知要远离的所见即所得应用程序完全相同。另外，我没有看到它的利基——如果你是一名网络开发人员，那么你当然不应该使用它；花点时间自己做。

我很好奇这个应用程序会生成什么样的代码；你能解释一下吗？

事实上，任何添加到您网站的 JavaScript 增强功能都应该由实施它们的 Web 开发人员完全管理和理解。JavaScript 不是玩具；这不仅仅是为了让事物在屏幕上跳舞；它是一种具有设计模式、方法论、范式等的编程语言。你不能只是放弃所有这些，并假设这一切都是关于结果的。

如果您认真对待自己的工作，那么您将不会使用此类应用程序..

另外，对于新手来说，jQuery 非常容易使用，那么为什么会有人需要使用这个应用程序呢？

        asp.net - 使用 HttpModule 显示图像

ID：809991

赞同：0

时间：2009-05-01T02:41:56.790

标签：asp.net, httpmodule, isapi

我有一个 HttpModule 显示遵循特定 URL 模式的图像。例如，/images/employees/jason.jpg 由模块处理，但所有其他图像不是。它在我的本地机器（Cassini 和 IIS 7）上运行良好。但是，IIS6 生产服务器不工作。我让托管公司将图像映射到 ASP.NET 工作进程。现在，除了应该由模块渲染的图像之外，所有图像都显示它们无法渲染。他们工作正常。

我在其中一个文件上运行了一个 HttpWatch 实例并收到以下错误：

ERROR_HTTP_INVALID_SERVER_RESPONSE

有任何想法吗？

            回答 #1

赞同：1

时间：2009-05-01T19:29:59.287

最终答案：

1.  该模块需要更新以传输服务器文件。因此，我在原始 if 中添加了 else 并检查它是否是图像类型（通过使用实用程序方法），然后使用 Response.TransmitFile() 将文件传递给浏览器。

2.  然后我遇到了图像的间距问题。这是因为我忘记了我已将 .aspx 文件注册为图像类型来执行测试。因此，每个页面都会在调试过程中崩溃或添加从 CSS 建立的填充。嗬！

现在一切都很美好。谢谢大家！

            回答 #2

赞同：0

时间：2009-05-01T05:04:41.800

您的模块似乎没有什么特别的问题，所以问题一定来自其他地方。您是否有可能阻止图像的安全性？当您请求静态文件时，实际返回了什么？

我建议使用诸如 firebug 之类的东西查看返回的内容（及其标头），以检查响应代码、内容类型、实际原始响应等内容……

            回答 #3

赞同：0

时间：2009-05-01T05:13:28.987

检查您的 web.config IIS6 / IIS7 有不同的位置来添加模块，这取决于您的 IIS7 运行的模式。

[http://arcware.net/use-a-single-web-config-for-iis6-and-iis7](http://arcware.net/use-a-single-web-config-for-iis6-and-iis7/)

        xcode - iPhone SDK 是否包含用于 Mac OS X 开发的 Xcode？

ID：809992

赞同：2

时间：2009-05-01T02:42:02.610

标签：xcode, installation

iPhone SDK 是否包含用于 Mac OS X 开发的 Xcode？还是我需要单独安装 Xcode for Mac？

如果是后者，安装顺序重要吗？

            回答 #1

赞同：8

时间：2009-05-01T02:44:14.663

它包括它。都是同一个应用程序（嗯，iPhone 版本较新，所以下载一份，不要安装 Mac 附带的版本）

文档是模块化的，您可以指定要从 IDE 内部下载的文档集。

            回答 #2

赞同：-1

时间：2009-05-01T02:46:52.253

据我记得，我不得不单独安装它。虽然我可能是错的......

```

```*******