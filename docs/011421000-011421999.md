# StackOverflow 问答 11421000-11421999

# c# - 将 c++-cli dll 暴露给 c#

> ID：11421002
> 
> 赞同：0
> 
> 时间：2012-07-10T20:00:34.327
> 
> 标签：c#, c++-cli

我正在使用 c++-cli 生成一个 dll。dll 中的类如下所示：

```
ref class Locator

{
public:
Locator(int HP) : m_HP(HP) { } 
~Locator() 
{ } 
Dictionary<String^, array< Byte >^>^ Locate(Dictionary<String^, String^>^ imgParms) 
{ .....  }

private:
int m_HP; 
```

如何公开它以在 c# 中使用它？类和成员没有在 c# 中公开

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-10T22:03:31.353

您需要使用`public`关键字使托管类型对程序集的使用者可见。尝试

```
public ref class Locator { ... }; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T22:08:54.163

几个月前我问过一个关于类似问题的问题：

[如何使用 C# 中的 C 回调？](https://stackoverflow.com/questions/10166970/how-to-use-a-c-callback-from-c)

以下是我对这个问题的回答中的一些额外提示：

[从 C++ 调用 C++ DLL 有效，但不能从 C#](https://stackoverflow.com/questions/11345724/calling-c-dll-from-c-works-but-not-from-c-sharp/11403445#11403445)

我读到你正在使用 OpenCV，你知道[Emgu CV: OpenCV in .NET (C#, VB, C++ and more)](http://www.emgu.com/wiki/index.php/Main_Page)吗？:-)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-10T20:02:20.927

C++/CLI 生成标准的 .NET 托管程序集。这就是 C++/CLI => 将现有 C++ 代码编译为托管程序集而不将其重写为 CLS 语言的全部意义所在。

因此，只需将此程序集作为您使用项目中的任何其他 .NET 程序集进行引用。然后消费：

```
var imgParms = new Dictionary<string, string> { { "foo", "bar" }, { "baz", "bazinga" } };
var locator = new Locator(123);
var result = locator.Locate(imgParams);
// TODO: do something with the result dictionary 
```

# serial-port - LabVIEW 串行连接教程

> ID：11421003
> 
> 赞同：0
> 
> 时间：2012-07-10T20:00:36.317
> 
> 标签：serial-port, labview, serial-communication

有谁知道关于串行连接（RS232）的好LabVIEW教程在哪里。任何帮助表示赞赏。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T17:58:38.273

非常简单的例子：

[http://www.ni.com/white-paper/2897/en](http://www.ni.com/white-paper/2897/en)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-28T21:48:15.847

Example 目录中有一些完整的应用程序。首先，确保您没有任何硬件问题，并检查操作系统配置中的串行端口设置。

我希望您知道您可以通过将 Rx 直接连接到 Tx 引脚来测试您的 RS232 通信。

# html - 无效的财产价值？

> ID：11421008
> 
> 赞同：0
> 
> 时间：2012-07-10T20:00:40.763
> 
> 标签：html, css

我正在尝试使用 css 为我的搜索栏提供背景。但是 chrome 不断给出错误“无效的属性值”。这很奇怪，因为我的导航栏是完全相同的代码但没有给出错误？ [http://ispiked.net/tests/](http://ispiked.net/tests/)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-10T20:03:56.357

这是因为您还指定了“不重复”以及背景图像。将您的代码更改为：

```
background: url(images/searchbar.png) no-repeat; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-10T20:06:28.043

另一种方法是使用 background-repeat 属性。

```
background-image: url('images/searchbar.png');
background-repeat: no-repeat; 
```

# android - android查看默认填充或边距

> ID：11421009
> 
> 赞同：6
> 
> 时间：2012-07-10T20:00:49.133
> 
> 标签：android, view

似乎像 TextView 这样的视图有自己的填充或边距......我的意思是当我将 textSize 16dp 设置为 textView 时，在 hdpi 设备屏幕上需要超过 24 个像素才能显示此控件。也许我错过了什么，请帮忙

```
<LinearLayout
        android:id="@+id/uc_button_title_panel"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:orientation="vertical" >

        <View
            android:layout_width="match_parent"
            android:layout_height="1px"
            android:background="@color/closed_red" />

        <TextView
            android:id="@+id/uc_button_title_text"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_margin="0dp"
            android:includeFontPadding="false"
            android:background="@null"
            android:padding="0dp"
            android:text="@string/demo_text"
            android:textColor="#325083"
            android:textSize="16dp"
            android:textStyle="bold" />

        <View
            android:layout_width="match_parent"
            android:layout_height="1px"
            android:background="@color/closed_red" />
    </LinearLayout> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-09-03T12:36:48.960

```
 <LinearLayout 
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_marginTop="@dimen/activity_vertical_margin"
        android:layout_marginBottom="@dimen/activity_vertical_margin"
        android:layout_marginLeft="@dimen/activity_horizontal_margin"
        android:layout_marginRight="@dimen/activity_horizontal_margin"
        android:orientation="vertical">
  </LinearLayout> 
```

在 android 中使用布局时，可用的默认边距和填充是这样的：@dimen/activity_vertical_margin 或 @dimen/activity_horizo​​ntal_margin。我在上面放了一个示例代码。

# android - EditText 和按钮高度问题

> ID：11421022
> 
> 赞同：0
> 
> 时间：2012-07-10T20:01:44.917
> 
> 标签：android, android-edittext, android-button

我在使用 LinearLayout 包装的 EditText 控件旁边有一个 Button。一切似乎都很好，除了 Button 明显高于 EditText 并且我希望它具有相同的高度。@drawable/main_edittext 和@drawable/main_edittext_button 的高度相同，但即使没有设置背景，高度也不同。在应用程序清单文件中，应用程序主题仅设置为 windowNoTitle=true。

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:background="@drawable/main_background"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <EditText
        android:id="@+id/edit_message"
        style="@style/MainEditText"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:hint="@string/edit_message"
        android:singleLine="true" />

    <Button
        android:id="@+id/edit_message_button"
        style="@style/MainSearchButton"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:onClick="sendMessage"
        android:text="@string/button_send" />

</LinearLayout>

<style name="MainEditText">
    <item name="android:background">@drawable/main_edittext</item>
    <item name="android:textSize">16sp</item>
    <item name="android:textStyle">normal</item>
    <item name="android:textColor">#262626</item>
</style>

<style name="MainSearchButton">
    <item name="android:background">@drawable/main_edittext_button</item>
    <item name="android:textSize">16sp</item>
    <item name="android:textStyle">normal</item>
    <item name="android:textColor">#ff5500</item>
</style> 
```

+main_edittext.xml

```
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item 
        android:state_pressed="true" 
        android:drawable="@drawable/edit_text">
    </item>
    <item 
        android:state_enabled="true" 
        android:state_focused="true" 
        android:drawable="@drawable/edit_text">
    </item>
    <item android:state_enabled="true" 
        android:drawable="@drawable/edit_text">
    </item>
</selector> 
```

-main_edittext.xml

+main_edittext_button.xml

```
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item 
        android:state_pressed="true" 
        android:drawable="@drawable/edit_text_button">
    </item>
    <item
        android:state_focused="true" 
        android:drawable="@drawable/edit_text_button">
    </item>
    <item android:drawable="@drawable/edit_text_button" />
</selector> 
```

-main_edittext_button.xml

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-10T20:19:14.340

尝试删除填充和边距：`android:layout_margin="0dp"`和`android:padding="0dp"`

此外，根据您的评论，也将其修改`minHeight`为 0：`android:minHeight="0dp"`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T20:55:54.730

如果按钮“edit_text_button”的可绘制对象是九个补丁可绘制对象，请尝试删除或缩小填充。以防万一，为不同的密度放置不同的资源：ldpi、mdpi 和 hdpi。

# iphone - 调用 setHidden 函数时 TableView 不会消失

> ID：11421025
> 
> 赞同：1
> 
> 时间：2012-07-10T20:01:56.757
> 
> 标签：iphone, uitableview, uigesturerecognizer

我，

在我的 handleLongPress 函数（cf：手势识别器）中，我尝试让 TableView 出现，最后，当手势被移除时，消失。为此，我使用手势识别器状态属性以及 tableView 的 setHidden 函数。不幸的是，tableView 出现后并没有消失。我不明白为什么。如果您有想法，我将不胜感激。

这是我的代码：

```
-(void)handleLongPress:(UILongPressGestureRecognizer *)gestureRecognizer
{
    UITableView *tableView = [[UITableView alloc]initWithFrame:CGRectMake(gestureRecognizer.view.center.x - 10, gestureRecognizer.view.center.y - 10, 100, 100)];

    tableView.layer.cornerRadius = 20.0;
    tableView.layer.frame = CGRectInset(tableView.layer.frame, 20, 20);

    if (gestureRecognizer.state == UIGestureRecognizerStateBegan) {
    [self addSubview:tableView];
    }

    if(gestureRecognizer.state == UIGestureRecognizerStateEnded)
    {
        [tableView setHidden:YES];
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-10T20:08:46.100

您每次都在重新创建表格视图，无论是否将其添加到屏幕，您需要在属性或 ivar 中捕获您的表格视图，然后从那里开始，我假设您只想要一个表格视图，以下将解决问题

在您的界面中有一个 tableView 属性

```
@interface ..
{

}
@property(nonatomic, retain) UITableView *tableView;
@end 
```

在您的实现中综合它...

```
 -(void)handleLongPress:(UILongPressGestureRecognizer *)gestureRecognizer
    {
       if(tableView==nil)
      {
        self.tableView = [[UITableView alloc] initWithFrame:CGRectMake(gestureRecognizer.view.center.x - 10, gestureRecognizer.view.center.y - 10, 100, 100)] autorelease];
      [self addSubview:self.tableView];
     }

        self.tableView.layer.cornerRadius = 20.0;
        self.tableView.layer.frame = CGRectInset(tableView.layer.frame, 20, 20);

        if (gestureRecognizer.state == UIGestureRecognizerStateBegan) {
           [self.tableView setHidden:false];
        }

        if(gestureRecognizer.state == UIGestureRecognizerStateEnded)
        {
            [self.tableView setHidden:YES];
        }
   } 
```

有关属性的更多信息，请查看[此](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/ObjectiveC/Chapters/ocProperties.html)内容，希望对您有所帮助.. 丹尼尔

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T20:19:39.260

```
if(gestureRecognizer.state == UIGestureRecognizerStateEnded)
{
    [tableView removeFromSuperview];
} 
```

因为您要添加一个表格视图，所以您应该删除它。否则，将 tableview 添加到 longPressGestureRecognizer 方法之外，并根据需要隐藏/取消隐藏

# asp-classic - 经典asp发送邮件

> ID：11421026
> 
> 赞同：0
> 
> 时间：2012-07-10T20:01:57.573
> 
> 标签：asp-classic, jmail

我正在使用此代码使用经典 ASP 发送电子邮件：

```
Set oJMail = Server.CreateObject("JMail.SMTPMail")
with oJMail
    .Sender = "myemail"
    .SenderName = "Me"
    .AddRecipient "some email"
    .Subject = "some subject"
    .Body = "Name: " & fname & " Email:" & email & "Phone: " & phone
end with

oJMail.ServerAddress = "mysmtp:25"
oJMail.Execute
Set oJMail = Nothing 
```

但是服务器不断抛出这个错误：

```
Microsoft JScript 编译错误“800a03ec”

预期的 ';'

/index.asp，第 108 行

设置 oJMail = Server.CreateObject("JMail.SMTPMail")
----^

```

这可能与我的页眉有关吗？

```
<%@ Language="javascript" %> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-10T20:06:25.657

是的，这看起来像 VBScript 代码，在这种情况下，您希望您的页眉具有：

```
<%@ Language="VBScript" %> 
```

当然，如果页面的其余部分已经用 JavaScript 编写，这会导致问题。

# ruby - 在 Ruby 对象类中创建数组

> ID：11421035
> 
> 赞同：4
> 
> 时间：2012-07-10T20:02:41.520
> 
> 标签：ruby, arrays, class, object, struct

我只想编写一个包含 id 数组的类的 Ruby 脚本（没有 rails）。这是我原来的课程：

```
# define a "Person" class to represent the three expected columns
class Person <

  # a Person has a first name, last name, and city
  Struct.new(:first_name, :last_name, :city)

  # a method to print out a csv record for the current Person.
  # note that you can easily re-arrange columns here, if desired.
  # also note that this method compensates for blank fields.
  def print_csv_record
    last_name.length==0 ? printf(",") : printf("\"%s\",", last_name)
    first_name.length==0 ? printf(",") : printf("\"%s\",", first_name)
    city.length==0 ? printf("") : printf("\"%s\"", city)
    printf("\n")
  end
end 
```

现在我想在类中添加一个名为 ids 的数组，我可以将它包含在 Struct.new 语句中，如 Struct.new(:first_name, :last_name, :city, :ids = Array.new) 还是创建一个实例数组变量或任何定义单独的方法或其他东西？

我希望能够执行以下操作：

```
p = Person.new
p.last_name = "Jim"
p.first_name = "Plucket"
p.city = "San Diego"

#now add things to the array in the object
p.ids.push("1")
p.ids.push("55") 
```

并遍历数组

```
p.ids.each do |i|
  puts i
end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-10T20:24:13.980

假设我明白你想要什么，就这么简单。将此添加到您的`Person`课程中：

```
def initialize(*)
  super
  self.ids = []
end 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-10T20:32:58.547

```
# define a "Person" class to represent the three expected columns
class Person
 attr_accessor :first_name,:last_name,:city ,:ids
#  Struct.new(:first_name, :last_name, :city ,:ids) #used attr_accessor instead  can be used this too 

def initialize
     self.ids = [] # on object creation initialize this to an array
end
  # a method to print out a csv record for the current Person.
  # note that you can easily re-arrange columns here, if desired.
  # also note that this method compensates for blank fields.
  def print_csv_record
    print last_name.empty? ? "," : "\"#{last_name}\","
    print first_name.empty? ? "," : "\"#{first_name}\","
    print city.empty? ? "" : "\"#{city}\","
    p "\n"
  end
end

p = Person.new
p.last_name = ""
p.first_name = "Plucket"
p.city = "San Diego"

#now add things to the array in the object
p.ids.push("1")
p.ids.push("55")

#iterate
p.ids.each do |i|
  puts i
end 
```

# java - 是否有动态的 java 类级别的类似 Ivy 的解析器？

> ID：11421036
> 
> 赞同：1
> 
> 时间：2012-07-10T20:02:44.170
> 
> 标签：java, dynamic, dependencies, ivy

**这更多是关于那里有什么的问题，以及**关于解决工具（如`Ivy`. 有什么可以提到`class-level`包的依赖关系而不是`package level`依赖关系吗？
例如，假设我有一个`apache-xyxy package`, 附带一个`ivy.xml`列出所有依赖项的 ,。但是假设我只使用`WX`apache-xyxy 中的类，它不需要大多数依赖项。解析器不能是***智能的吗***并确定类 WX 只能调用其他类（AB、DC、EF）的集合，并且这些类都不使用任何其他依赖项，以创建所需依赖项的最小子集？这将比樱桃采摘更容易和更安全，以删除由于该包中使用的特定类而不需要的一些包依赖关系，并且还可以防止仅仅因为这个原因将几个较大的包分解成较小的包。

然后，如果我后来决定使用 apache-xyxy 中的 GH 类，我可以做一个 ivy 解析，它会动态引入额外的所需库。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T19:20:20.503

在打包已编译的 Java 代码以进行分发时，通常将 Java“包”捆绑在一起。将一个 java 包拆分为多个 jar 也是很可能的（但很愚蠢）。大型框架（如 Spring）在不同的 jar 中包含许多子包，因此用户可以在运行时选择他们需要的内容.....当然，jar 选项越多，填充运行时类路径...

这里的关键字是“运行时”...... [Apache ivy](http://ant.apache.org/ivy/)和[Apache Maven](http://maven.apache.org/)等工具主要用于管理构建时所需的依赖关系......

[Apache Maven](http://maven.apache.org/)确实有一个“运行时”范围，因为它是依赖项，但它仅限于单个 jar 列表。通常，此范围用于确定需要哪些 jar 来测试和填充 WAR 文件的 lib 目录。

[Apache ivy](http://ant.apache.org/ivy/)有一个类似的更灵活的机制，称为“配置”。可以根据需要创建任意数量的运行时配置，这些配置可用于决定 ivy 下载哪些 jar。因此，虽然看起来常春藤有答案，但我很少看到常春藤在启动程序时使用（一个例外是 Groovy 的[Grape 注释](http://groovy.codehaus.org/Grape)）

那么，你可能会问，答案是什么？

“运行时”类路径管理的未来是[OSGI](http://www.eclipse.org/osgi/)或[项目拼图](http://openjdk.java.net/projects/jigsaw/)。我更熟悉 OSGI，在 jar 文件的清单中添加了特殊的依赖项指示符，说明它的依赖项是什么。这个想法是，当一个容器加载一个 jar（称为“包”）时，它可以检查并查看其他依赖项是否已经加载。这些依赖关系可以从公共存储库中检索和加载。这是启动java的根本不同方式。传统上，每个应用程序都加载到它自己的隔离类路径中......

Time will tell if either project catches on. In the meantime we use [Apache ivy](http://ant.apache.org/ivy/) and [Apache Maven](http://maven.apache.org/) to build self-contained and possibly over-bloated WAR (EAR, etc) packages.

# php - PHP 读取和显示 Excel 图表 - PHP-ExcelReader 是否支持？

> ID：11421043
> 
> 赞同：0
> 
> 时间：2012-07-10T20:03:01.460
> 
> 标签：php, excel

我的要求是显示 MS Office excel 2007 中的图表。

我正在研究 PHP-ExcelReader 但没有得到任何帮助。

有人可以帮我用 PHP 做对吗？

注意：我在一个 Excel 工作表中的所有工作表中都有超过 1 个图表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-04-15T09:48:20.403

是的 PHP-ExcelReader 支持通过 PHP 读取/写入和显示 Excel 图表，您可以使用以下代码执行此操作：-

```
error_reporting(E_ALL);
date_default_timezone_set('Europe/London');
require_once '../Classes/PHPExcel/IOFactory.php';
require_once '../Classes/PHPExcel.php';
$excel2 = PHPExcel_IOFactory::createReader('Excel2007');

/*Enable chart read on excel*/
$excel2->setIncludeCharts(TRUE);
/*Enable chart read on excel*/

$excel2 = $excel2->load('excelname.xlsx'); // Empty Sheet

/*update cell data if you required */
$excel2->getActiveSheet()->setCellValue('B6', '2');
$excel2->getActiveSheet()->setCellValue('B7', '1');
$excel2->getActiveSheet()->setCellValue('B8', '3');
/*-----------------------------*/

$objWriter = PHPExcel_IOFactory::createWriter($excel2, 'Excel2007');
/*Enable chart write on excel*/
$objWriter->setIncludeCharts(TRUE);
/*Enable chart write on excel*/
$objWriter->save('excelout.xlsx'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T20:06:24.810

我会查看这个[问题](https://stackoverflow.com/questions/4943551/working-with-excel-files-in-php)中的链接。他们应该给你你需要的信息。

另外，[这个问题](https://stackoverflow.com/questions/563670/reading-an-excel-file-in-php?rq=1)，几乎和你的一样。

也看看[这篇文章](http://devzone.zend.com/27/reading-and-writing-spreadsheets-with-php)。

# eclipse - Scala-IDE 和 Eclipse Juno 的代码完成问题

> ID：11421047
> 
> 赞同：11
> 
> 时间：2012-07-10T20:03:20.660
> 
> 标签：eclipse, scala, code-completion, scala-ide, eclipse-juno

我将 Eclipse Juno 与 Java（Java build 1.7.0_05-b05 64bit）和 Scala-IDE 插件（用于 Eclipse 2.1.0.nightly-2_09-201207100348-f1d9c23 org.scala-ide.sdt.feature 的 Scala IDE。 feature.group scala-ide.org)。

以下是我对 Eclipse eclipse.ini 的自定义设置：

```
-vmargs
-Dosgi.requiredJavaVersion=1.7
-Dhelp.lucene.tokenizer=standard
-Xss8m
-Xms256m
-Xmx1536m
-XX:PermSize=64m
-server
-Xverify:none
-XX:+UnlockExperimentalVMOptions
-XX:+UseG1GC
-XX:MaxGCPauseMillis=50
-XX:+DoEscapeAnalysis
-XX:+UseCompressedOops 
```

每次我尝试使用代码完成 Eclipse 时都会抛出 2 个错误窗口：

```
The 'Code Recommenders Calls Proposals' proposal computer from
the 'org.eclipse.recommenders.completion.rcp.calls' plug-in did
not complete normally.
The extension has thrown a runtime exception. 
```

和

```
The 'Code Recommenders Overrides Proposals' proposal computer from
the 'org.eclipse.recommenders.completion.rcp.overrides' plug-in did
not complete normally.
The extension has thrown a runtime exception. 
```

下面我的 scala-ide 日志显示：

```
[Xlint:cantFindType]
2012-07-10 15:37:29,404 ERROR [main] - System.err - 
[org.eclipse.jdt.launching] error can't determine modifiers of missing type
org.eclipse.pde.internal.ui.wizards.imports.PluginImportHelper
when weaving type org.eclipse.jdt.launching.JavaRuntime
when weaving classes 
when weaving 
[Xlint:cantFindType] 
```

有没有什么办法解决这一问题？

谢谢你。

**更新 1**：禁用代码推荐器后，我的 Slaca-Ide 日志中出现不同的错误：

```
2012-07-10 16:10:24,342 ERROR [main] - System.err - [org.eclipse.jdt.debug.ui] 
error can't determine modifiers of missing type
org.eclipse.pde.internal.ui.wizards.imports.PluginImportHelper
when weaving type org.eclipse.jdt.internal.debug.ui.actions.ToggleBreakpointAdapter
when weaving classes
when weaving 
[Xlint:cantFindType] 
```

但是 scala 代码完成现在可以正常工作

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T07:42:25.957

你介意打开一个关于代码推荐器的错误报告，包括一个堆栈跟踪来解决这个问题吗？

# android - Android / iOS - 自定义 URI / 协议处理

> ID：11421048
> 
> 赞同：50
> 
> 时间：2012-07-10T20:03:24.397
> 
> 标签：android, ios, protocols, manifest, custom-url-protocol

**有没有办法在 Android和**iOS中定义某种处理机制，让我可以拦截以下任何一种：

```
myapp:///events/3/
- or -
http://myapp.com/events/3/ 
```

我想“监听”协议或主机，并打开相应的 Activity/ViewController。

我也希望这些可以在系统范围内尽可能。我想这在 iOS 上将是一个更大的问题，但理想情况下，我可以从任何应用程序中单击这两个方案中的任何一个，作为超链接。Gmail、Safari 等

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2012-07-10T20:17:29.673

编辑 5/2014，因为这似乎是一个受欢迎的问题，所以我在答案中添加了很多细节：

**安卓：**

对于 Android，请参阅[Intent Filter to Launch My Activity when custom URI is clicked](https://stackoverflow.com/questions/5596261/intent-filter-to-launch-my-activity-when-custom-uri-is-clicked)。

您使用意图过滤器：

```
<intent-filter>
  <action android:name="android.intent.action.VIEW" /> 
  <category android:name="android.intent.category.DEFAULT" /> 
  <category android:name="android.intent.category.BROWSABLE" /> 
  <data android:scheme="myapp" /> 
</intent-filter> 
```

这附加到您要启动的活动。例如：

```
<activity android:name="com.MyCompany.MyApp.MainActivity" android:label="@string/app_name">
  <intent-filter>
      <action android:name="android.intent.action.MAIN" />
      <category android:name="android.intent.category.LAUNCHER" />
  </intent-filter>
  <intent-filter>
      <action android:name="android.intent.action.VIEW" />
      <category android:name="android.intent.category.DEFAULT" />
      <category android:name="android.intent.category.BROWSABLE" /> 
      <data android:scheme="myapp" android:host="com.MyCompany.MyApp" />
  </intent-filter>
</activity> 
```

然后，在您的活动中，如果未运行，活动将使用 Intent 中传递的 URI 启动。

```
Intent intent = getIntent();
Uri openUri = intent.getData(); 
```

如果已经运行，onNewIntent() 将在您的活动中被调用，再次使用意图中的 URI。

最后，如果您想处理原生应用程序中托管的 UIWebView 中的自定义协议，您可以使用：

```
myWebView.setWebViewClient(new WebViewClient()
{
 public Boolean shouldOverrideUrlLoading(WebView view, String url)
 {
  // inspect the url for your protocol
 }
}); 
```

**IOS：**

对于 iOS，请参阅[使用 URL（通过 UIApplicationDelegate 的 handleOpenURL）在 iOS 4 下工作但在 iOS 3.2 下不工作的启动应用程序](https://stackoverflow.com/questions/3612460/lauching-app-with-url-via-uiapplicationdelegates-handleopenurl-working-under)。

通过 Info.plist 键定义您的 URL 方案，类似于：

```
<key>CFBundleURLTypes</key>
    <array>
        <dict>
            <key>CFBundleURLName</key>
            <string>com.yourcompany.myapp</string>
        </dict>
        <dict>
            <key>CFBundleURLSchemes</key>
            <array>
                <string>myapp</string>
            </array>
        </dict>
    </array> 
```

然后定义一个处理函数以在您的应用委托中调用

```
- (BOOL)application:(UIApplication *)application openURL:(NSURL *)url sourceApplication:(NSString *)sourceApplication annotation:(id)annotation
{
 // parse and validate the URL
} 
```

如果你想在你的原生应用中处理**UIWebViews**中的自定义协议，你可以使用 UIWebViewDelegate 方法：

```
- (BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType
{
 NSURL *urlPath = [request URL];
 if (navigationType == UIWebViewNavigationTypeLinkClicked)
 {
    // inspect the [URL scheme], validate
    if ([[urlPath scheme] hasPrefix:@"myapp"]) 
    {
      ...
    }
  }
} 
```

}

对于**WKWebView** (iOS8+)，您可以改用 WKNavigationDelegate 和此方法：

```
- (void)webView:(WKWebView *)webView decidePolicyForNavigationAction:(WKNavigationAction *)navigationAction decisionHandler:(void (^)(WKNavigationActionPolicy))decisionHandler
{
 NSURL *urlPath = navigationAction.request.URL;  
 if (navigationAction.navigationType == WKNavigationTypeLinkActivated)
 {
   // inspect the [URL scheme], validate
   if ([[urlPath scheme] hasPrefix:@"myapp"])
   {
    // ... handle the request
    decisionHandler(WKNavigationActionPolicyCancel);
    return;
   }
 }

 //Pass back to the decision handler
 decisionHandler(WKNavigationActionPolicyAllow);
} 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-07-10T20:27:24.090

**更新：**这是一个非常古老的问题，iOS 和 Android 上的情况都发生了很大变化。我将在下面留下原始答案，但是任何从事新项目或更新旧项目的人都应该考虑使用两个平台都支持的[深度链接。](https://medium.com/@ageitgey/everything-you-need-to-know-about-implementing-ios-and-android-mobile-deep-linking-f4348b265b49)

在 iOS 上，深层链接称为[通用链接](https://developer.apple.com/library/archive/documentation/General/Conceptual/AppSearch/UniversalLinks.html)。您需要在您的网站上创建一个 JSON 文件，将您的应用与指向您网站部分的 URL 相关联。接下来，更新您的应用程序以接受`NSUserActivity`对象并设置应用程序以显示与给定 URL 对应的内容。您还需要向应用程序添加一项权利，列出应用程序可以处理的 URL。在使用中，操作系统负责从您的站点下载关联文件并在有人尝试打开您的应用处理的 URL 之一时启动您的应用。

[在 Android 上](https://developer.android.com/training/app-links/#app-links-vs-deep-links)设置应用链接的工作方式类似。首先，您将在您的网站和您的应用程序之间建立关联，然后您将添加[意图过滤器](https://developer.android.com/training/app-links/deep-linking)，让您的应用程序拦截打开您的应用程序可以处理的 URL 的尝试。

尽管细节明显不同，但两个平台上的方法几乎相同。它使您能够将您的应用程序插入到您网站内容的显示中，无论哪个应用程序尝试访问该内容。

* * *

**原答案：**

对于 iOS，是的，您可以做两件事：

1.  让您的应用宣传它可以处理具有给定方案的 URL。

2.  安装协议处理程序来处理您喜欢的任何方案。

第一个选项非常简单，并在[实施自定义 URL 方案](http://developer.apple.com/library/ios/DOCUMENTATION/iPhone/Conceptual/iPhoneOSProgrammingGuide/AdvancedAppTricks/AdvancedAppTricks.html#//apple_ref/doc/uid/TP40007072-CH7-SW50)中进行了描述。要让系统知道您的应用可以处理给定的方案：

*   使用 CFBundleURLTypes 条目更新应用的 Info.plist

*   `-application:didFinishLaunchingWithOptions:` 在您的应用委托中实现。

第二种可能性是编写自己的协议处理程序。这仅适用于您的应用程序，但您可以将其与上述技术结合使用。使用上述方法让系统针对给定的 URL 启动您的应用程序，然后在您的应用程序中使用自定义 URL 协议处理程序来利用 iOS 的 URL 加载系统的功能：

*   创建一个您自己的[`NSURLProtocol`](https://developer.apple.com/library/ios/documentation/Cocoa/Reference/Foundation/Classes/NSURLProtocol_Class/Reference/Reference.html#//apple_ref/doc/uid/20001700-387826).

*   覆盖`+canInitWithRequest:`——通常您只需查看 URL 方案并在它与您要处理的方案匹配时接受它，但您也可以查看请求的其他方面。

*   注册你的子类：`[MyURLProtocol registerClass];`

*   分别覆盖`-startLoading`和`-stopLoading`开始和停止加载请求。

阅读上面链接的 NSURLProtocol 文档以获取更多信息。这里的难度很大程度上取决于您要实现的内容。iOS 应用程序通常会实现自定义 URL 处理程序，以便其他应用程序可以发出简单的请求。实现您自己的 HTTP 或 FTP 处理程序涉及更多。

对于它的价值，这正是 PhoneGap 在 iOS 上的工作方式。PhoneGap 包含一个名为 PGURLProtocol 的 NSURLProtocol 子类，它查看应用程序尝试加载的任何 URL 的方案，如果它是它识别的方案之一，则接管它。PhoneGap 的开源表亲是[Cordova——](http://incubator.apache.org/cordova/)你可能会发现看看它会有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-10-20T17:46:42.173

对于您问题中的第二个选项：

```
http://myapp.com/events/3/ 
```

iOS 9 引入了一种新技术，称为通用链接，它允许您拦截指向您网站的链接，如果它们是 https://

[https://developer.apple.com/library/content/documentation/General/Conceptual/AppSearch/UniversalLinks.html](https://developer.apple.com/library/content/documentation/General/Conceptual/AppSearch/UniversalLinks.html)

# google-apps-script - 在 Google Apps 脚本中停止错误“执行该操作需要授权”

> ID：11421055
> 
> 赞同：36
> 
> 时间：2012-07-10T20:03:48.927
> 
> 标签：google-apps-script, web-applications

当我尝试查看已部署的应用程序时，我不断收到此错误消息。

> 执行该操作需要授权

我如何绕过错误？

脚本中使用的服务：

*   `ScriptDB`
*   `UiApp`

（我认为仅此而已）

我在文档中找不到答案，因此我将非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2012-07-10T20:44:05.807

您需要先进入脚本编辑器并尝试手动运行任何功能。

当您第一次部署为 Web 应用程序时会显示第一个授权弹出窗口，但如果您更改访问新服务的代码，则必须重新授权它。

# c# - 使用 foreach 循环从 excel 工作表创建列表

> ID：11421059
> 
> 赞同：0
> 
> 时间：2012-07-10T20:03:58.973
> 
> 标签：c#, excel, foreach, arraylist, epplus

我正在从 Excel 表中检索单元格，这是我得到的输出。

```
Cell A2 has value 113,295
Cell B2 has value 540
Cell C2 has value 41,044
Cell A3 has value 192,653
Cell B3 has value 510
Cell C3 has value 41,037 
```

代码：

```
using (ExcelPackage package = new ExcelPackage(existingFile))
{
    ExcelWorksheet sheet = package.Workbook.Worksheets[1];

    //Select all cells in column d between 9990 and 10000
    var query1 = (from cell in sheet.Cells["A2:C2"] select cell);

    int count = 0;
    string[] s = null;

    foreach (var cell in query1)
        Console.WriteLine("Cell {0} has value {1:N0}", cell.Address, cell.Value);
} 
```

我的问题是我想创建一个包含成员 a、b 和 c 的类，并且我想要一个 List<> 来保存这些对象的集合。

目前，它正在迭代，但我不知道 for 循环中哪个单元格是 A、B 或 C。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T21:08:47.553

您可以编写一个 Partition 方法并给它行的长度......在你的情况下 3

```
IEnumerable<List<T>> Partition<T>(IEnumerable<T> col, int partitionSize) {
 if (col.Count() == 0) {
  return new List<List<T>>();
 } else {
  var l = new List<List<T>>();
  l.Add(col.Take(partitionSize).ToList());
  return l.Concat(Partition(col.Skip(partitionSize), partitionSize));
 }
}

class TheClass {
 public int A, B, C;
}

return Partition(sheet.Cells["A2:C2"], 3)
         .Select(cells => new TheClass { 
           A = int.Parse(cells[0].Value),
           B = int.Parse(cells[1].Value),
           C = int.Parse(cells[2].Value)
         }); 
```

我希望这有帮助

# javascript - 在 ie9 中进行插值双三次工作

> ID：11421061
> 
> 赞同：2
> 
> 时间：2012-07-10T20:04:06.167
> 
> 标签：javascript, jquery, css, internet-explorer-9

任何 javascript/jquery 解决方法可以使 css -ms-interpolation-mode 双三次图像在 ie9 中工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T20:11:08.883

根据[http://msdn.microsoft.com/en-us/library/ie/ms530822.aspx](http://msdn.microsoft.com/en-us/library/ie/ms530822.aspx) ，该属性在 IE 9 中已过时。换句话说，对于 IE 9 中的拉伸图像，插值始终是双三次的；它从来都不是最近邻算法。

如果你使用类似的 CSS 属性`filter`，祝你好运。

# maven - 哪个 Maven 目标用作无操作（用于脚本目的）？

> ID：11421062
> 
> 赞同：18
> 
> 时间：2012-07-10T20:04:09.177
> 
> 标签：maven, plugins

我在 Jenkins CI 上有一个脚本，它可以选择依赖：go-offline。另一种选择应该是什么都不做。但我不能把“”放在那里——它一定是一个目标。

那么 - 你会选择哪一个？它应该：

*   处于中心位置，始终可达
*   花费最少的时间
*   输出最少
*   没有副作用

我正在考虑一些帮助：...目标，但那些往往有很多输出。好点？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2014-11-19T15:36:22.270

您可以使用此目标和选项：

```
mvn --quiet help:help 
```

,选项导致输出仅显示错误`-q`。`--quiet`

请注意，Jenkins 允许您添加选项，如`--quiet`用法中显示的：`mvn [options] [<goal(s)>]`. 您可以在 Jenkins 作业的“目标和选项”字段中配置这些。

检查`mvn --help`输出以获取更多信息。

我知道这是一个老问题，但是当我有相同的要求并且仍然没有答案时，我遇到了它，所以我为将来需要它的任何人发帖。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-06-07T19:03:18.650

这仍然取决于当前项目，但如果您出于某种原因不想对特定插件进行硬编码，这可能会很有用：

```
mvn -pl ./ validate 
```

`-pl ./`仅表示当前项目，忽略子模块。或者，您可以通过相对路径或`[groupId]:artifactId`.
`validate`是[默认生命周期](https://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html#Lifecycle_Reference)的第一阶段。不会改变或构建任何东西。

或者，如果您根本没有 maven 项目，则可以在没有它的情况下执行一些 maven 插件，或者更确切地说是特定的插件目标。例如：

```
mvn org.apache.maven.plugins:maven-dependency-plugin:2.1:help 
```

如果在当前目录中看到 POM，它仍然会扫描项目。当然，您仍然需要在本地存储库中拥有该插件。

# mysql - ORDER BY 行为错误 (MySQL)

> ID：11421068
> 
> 赞同：0
> 
> 时间：2012-07-10T20:04:45.403
> 
> 标签：mysql

所以我的问题如下：我从 MySQL 数据库中获取了一个项目列表，然后我想用 Javascript 对其进行排序（可以动态编辑）。主要问题是数字和字符。假设这是数据库中的列表：

`3, a, 2, 1, b`

该语句将返回：

`a, b, 1, 2, 3`

但我希望它是：

`1, 2, 3, a, b`

我的数据库是`utf8_unicode_ci`，但这无济于事。它仍然会产生错误的结果。（我不能只检查它们是否是数字，然后将它们排序到顶部，因为一个项目也可以命名为“2some56thing”并且必须在“asome56thing”之前）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T20:13:13.180

我想这个链接可能会有所帮助：http: [//matthewturland.com/2008/11/05/natural-ordering-in-mysql/](http://matthewturland.com/2008/11/05/natural-ordering-in-mysql/)

试试这个：

```
ORDER BY CONCAT(`name`, `login`)+0, CONCAT(`name`, `login`) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T20:13:25.997

你在mysql中有什么语言环境设置？

我的排序得到这个输出：

```
SELECT * FROM sorting ORDER BY a;
+------+
| a    |
+------+
| 1    |
| 2    |
| 3    |
| a    |
| b    |
+------+ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-10T20:14:05.293

```
sort(function(a, b) {
    // Stuff to get the text out of the DOM
    return textb > texta;
} 
```

如果大于，则需要从[自定义比较函数](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/sort)返回 -1 （或任何数字 < 0），否则排序将不起作用（并且可能根本无法排序）。更好的：`texta``textb`

```
 return textb>=texta ? textb>texta ? 1 : 0 : -1; 
```

或者

```
 return textb>texta - texta>textb; 
```

或者

```
 return texta.localeCompare(textb); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-10T20:15:53.590

不要只使用`>`运算符。

由于您正在实现自己的排序功能，因此您可以随心所欲地复杂。

首先，检测`texta`和`textb`是否属于同一类型，如果不是，则表明 numeric 在 string 之前（使用 1 或 -1，取决于哪个变量是 numeric 的）。

如果它们属于同一类型，则可以使用`>`，但这并不合适；比较运算符应该返回一个数值，而不是布尔值。

因此：

```
 (a == b) ? 0 : ( (a < b) ? -1 : 1 ) 
```

# twig - Twig 是否允许在条件下分配以及如何分配？

> ID：11421069
> 
> 赞同：0
> 
> 时间：2012-07-10T20:04:45.790
> 
> 标签：twig

根据标题，Twig 是否允许有条件的分配以及如何分配？我知道并非所有人都喜欢这些作业，但有时它们会很有帮助。

这：

```
{% if (name = attribute(mappings, property)) is defined %}
    {% else %}
    {% set attrs = attrs|merge(['%s="%s"'|format(name, value)]) %}
{% endif %} 
```

...不工作并给我和错误：

> 打开的括号没有正确关闭。第 29 行 ::tooltips.html.twig 中的值“=”（“标点符号”应为值“）”）的意外标记“运算符”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T15:21:56.240

你的树枝错误是因为这条线

```
{% if (name = attribute(mappings, property)) is defined %} 
```

Twig 不喜欢条件表达式，我个人也不喜欢，这只是一个懒惰的快捷方式，潜在的问题不值得节省一些击键。

但我现在必须承认，我对这应该做什么感到困惑。您正在尝试捕获`attribute(mappings, property)`into的结果，`name`但如果失败了，*那么*您才使用 执行某些操作`name`，但到那时`name`将没有值，除非它已在模板中的其他地方定义。

# vim - 从vim运行时如何使shell命令持续存在

> ID：11421070
> 
> 赞同：3
> 
> 时间：2012-07-10T20:05:02.437
> 
> 标签：vim, hotkeys

我有一个脚本，我映射到 vim 中的一个键。

它运行良好，除了 vim 立即终止 shell，这就是导致脚本无法正常工作的原因。

我怎样才能让它正常工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-10T20:42:43.390

使用映射您的脚本`:!nohup COMMAND &`，它应该可以工作。这将创建一个 nohup.out 文件，其中包含命令的任何输出

# javascript - 设置在没有父子节点的其他选择器上可见

> ID：11421072
> 
> 赞同：1
> 
> 时间：2012-07-10T20:05:06.953
> 
> 标签：javascript, jquery, html

我可以使用 children() 和 parent() 但如果输入不是孩子和父母怎么办？

```
<table>
<tr>
<td>
    <input type="checkbox" class="check">
    <select style="display: none"><option>1</option><option>2</option></select>
    <select style="display: none"><option>1</option><option>2</option></select>
    <input type="text" style="display: none">
</td>
    </tr><tr>
    <td>
    <input type="checkbox" class="check">
    <select style="display: none"><option>1</option><option>2</option></select>
    <select style="display: none"><option>1</option><option>2</option></select>
    <input type="text" style="display: none">
</td></tr><tr>
    <td>
    <input type="checkbox" class="check">
    <select style="display: none"><option>1</option><option>2</option></select>
    <select style="display: none"><option>1</option><option>2</option></select>
    <input type="text" style="display: none">
</td></tr><tr>
    <td>
    <input type="checkbox" class="check">
    <select style="display: none"><option>1</option><option>2</option></select>
    <select style="display: none"><option>1</option><option>2</option></select>
    <input type="text" style="display: none">
</td>
</tr>
</table> 
```

如果我用类检查选中复选框，那么 2 选择和输入应该是可见的。我怎样才能用 jQuery 制作？

**小提琴：http :** [//jsfiddle.net/ykyNq/1/](http://jsfiddle.net/ykyNq/1/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T20:11:06.637

根据您的情况，您可以使用几个不同的选择器来查找兄弟姐妹。在这种情况下，您可以使用`siblings()`

```
$('.check').click(function(){    
    $(this).siblings("select, input").toggle() 
}) 
```

[http://jsfiddle.net/ykyNq/3/](http://jsfiddle.net/ykyNq/3/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-10T20:14:44.350

您可以使用[兄弟姐妹](http://api.jquery.com/siblings/)来选择它的所有兄弟姐妹（同一父级下同一级别的元素）

```
$('.check').click(function(){
    $(this).siblings().toggle();
})​ 
```

[http://jsfiddle.net/ykyNq/4/](http://jsfiddle.net/ykyNq/4/)

# android - Android LBS 服务 - 模拟器不显示地图

> ID：11421074
> 
> 赞同：0
> 
> 时间：2012-07-10T20:05:11.163
> 
> 标签：android, android-emulator

我做了一个项目，它显示了模拟器控制传递的纬度和经度值的当前地址。我还构建了一个**MapView**，它也显示了地图上的点。

**但问题是即使在生成MD5 指纹密钥**并在谷歌注册它之后 MapView 也不起作用。

我正在使用**模拟器 - Google API7**。

有人提出了一些建议，以便地图在模拟器上显示坐标。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T20:13:48.673

是的，它不会加载地图。

您的 gmaps 密钥是使用 Live API 密钥生成的，当您运行模拟器时，它会使用您的 debug.keystore 或默认的 eclipse/intellij debug.keystore。

您可以使用 debug.keystore 生成另一个 google maps api 密钥并使用它，然后在生产时将其换出。

或者现在使用您的实时密钥库对其进行测试，然后相信它会在您创建实时 APK 时工作:-)

# xna - 控制声音在 XNA 中只播放一次

> ID：11421075
> 
> 赞同：0
> 
> 时间：2012-07-10T20:05:16.027
> 
> 标签：xna

每次按下键发射导弹时，我都会发出声音。但这听起来不太好。我想这是因为按下键时声音重复了很多次，并且代码在 Update 方法中。我正在寻找一个简单的解决方案，只在按下键时播放一次声音？（我已经测试过第一次使用布尔变量为真，然后在播放声音后为假，但这效果不佳，因为我应该在何时何地再次将其设置为真） 帮助是preciated！

```
// Fire
if (keyboardState.IsKeyDown(Keys.Space))
{
missile.launchMissile(spaceship.spaceshipPosition, spaceship.spaceshipDirection);

soundExplosion.Play();
} 
```

编辑不起作用的新代码！？

```
 KeyboardState keyboardState = Keyboard.GetState();

        KeyboardState prevKeyboardState;

        prevKeyboardState = keyboardState;

        keyboardState = Keyboard.GetState();

        if (keyboardState.IsKeyDown(Keys.Space) && prevKeyboardState.IsKeyUp(Keys.Space))
        {
            missile.launchMissile(spaceship.spaceshipPosition, spaceship.spaceshipDirection);
            soundExplosion.Play();
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T13:46:03.230

也存储您以前的键盘状态

```
KeyBoardState prevKeyboardState; 
```

然后在你的更新中

```
prevKeyboardState = keyboardState;
keyboardState = Keyboard.GetState();

if (keyboardState.IsKeyDown(Keys.Space) && prevKeyboardState.IsKeyUp(Keys.Space))
{
  //your code
} 
```

你基本上只是每秒触发无数次声音，让它听起来很糟糕。

# python - Python：无法解释类成员列表行为

> ID：11421077
> 
> 赞同：-2
> 
> 时间：2012-07-10T20:05:23.863
> 
> 标签：python, list, class

> **可能重复：**
> [Python 中的“Least Astonishment”：可变默认参数 参数的](https://stackoverflow.com/questions/1132941/least-astonishment-in-python-the-mutable-default-argument)
> [默认值](https://stackoverflow.com/questions/6938655/default-values-for-arguments)

我无法解释属于某个类的列表的行为方式。

```
>>> class A(object):
...     def __init__(self, L=[]):
...         self.L = L
...
>>> a1 = A()
>>> a2 = A()
>>> a1.L.append("test")
>>> print a1.L
['test']
>>> print a2.L
['test'] 
```

在这个例子中，a2.L 是如何在其中得到一个值的？我只在 a1 的列表中添加了一个项目。他们现在如何共享列表。

谢谢，

亨利

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T20:08:34.783

您将获得的所有评论的简短摘要：

问题与班级无关。这是因为您将值存储在函数的默认参数中，而默认参数存储*在函数对象*中。

# r - knitr 换行

> ID：11421078
> 
> 赞同：8
> 
> 时间：2012-07-10T20:05:43.437
> 
> 标签：r, latex, knitr

> **可能重复：**
> [在 R Markdown 中的代码块中添加换行符](https://stackoverflow.com/questions/11306745/adding-a-line-break-to-code-blocks-in-r-markdown)

knitr 中是否有任何选项可以保留 R 代码中的换行符？编译文档后，代码应如下例所示：

```
\documentclass[a4paper]{scrartcl}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}

\begin{document}

<<hist>>=
df <- data.frame(x=rnorm(100,100,20))
library(lattice)
histogram(~x,
      df,
      main="histogram",
      nint=20)
@ 

\end{document} 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-10T20:12:20.030

`knitr`自动整理 R 代码。所以要换行，设置`tidy=FALSE`，即

```
<<hist, tidy=FALSE>>=
df <- data.frame(x=rnorm(100,100,20))
library(lattice)
histogram(~x,
      df,
      main="histogram",
      nint=20)
@ 
```

# php - jquery 将新页面加载到带有动画的 div 中的问题

> ID：11421079
> 
> 赞同：1
> 
> 时间：2012-07-10T20:05:45.580
> 
> 标签：php, javascript, jquery

我正在寻找一个 div，它包含一个 php 页面以淡出、卸载，然后在每个菜单上淡入一个新页面：

```
 $('#home').click(function() {
        $('#page_container').fadeOut(500).unload();
        $('#page_container').load('php/home.php').fadeIn(550);
    }); 
```

出于某种原因，它会闪烁新页面，然后在第一个实例中淡出，淡出并重新加载。

有人可以帮我解决这个问题。我确信这很简单，但我似乎找不到正确的语法来让它工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-10T20:09:20.827

您应该将`load()`调用设置为在淡入淡出函数的回调中发生：

```
$("#home").on("click", function () {
    $('#page_container').fadeOut('fast', function() {
        $(this).unload();
        $(this).load('php/home.php');
    });
}) 
```

`load()`一旦淡入淡出完成，这将触发。

`fadeOut()`是异步的，因此下一行在调用后立即执行。您的问题是因为`load()`它开始淡出时立即将内容加载到您的 div 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-10T20:08:17.527

没有演示很难完全理解，但是您是否看过使用回调？

```
$('#home').click(function() {
    $('#page_container').fadeOut(500, function(){ 
        $(this).unload(); 
        $('#page_container').load('php/home.php', function(){ 
            $(this).fadeIn(550) 
        });
    });

}); 
```

# c# - 为什么在 Flash 文本框中只显示一些字符？

> ID：11421081
> 
> 赞同：1
> 
> 时间：2012-07-10T20:05:47.803
> 
> 标签：c#, flash

我正在用 C# 编写一个程序，该程序使用 Flash 在表单上显示文本框。当我向表单发送消息时，仅显示一些字符。我使用的 swf 文件来自 Internet 文章，该文章解释了如何从 Flash 发送和接收数据，它包含源代码。

这是有趣的事情。如果我使用我下载的原始 swf 文件，它可以工作。如果我采用该 ela 文件并重命名并发布它而根本没有更改，它只会显示一些字符。没有嵌入字体。

我在 C# 程序中更改的只是 swf 文件的名称。

帮助！！！！

谢谢，加里

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T20:49:22.387

在查看了一些 Flash 论坛后，我发现了这个解决方案[http://ps3sg.blogspot.com/2011/03/adobe-flash-cs5-as2-problem-some.html](http://ps3sg.blogspot.com/2011/03/adobe-flash-cs5-as2-problem-some.html)。虽然这似乎可行，但这一定是 Flash CS5.5 中的一个错误

1.  单击文本框。
2.  单击“属性”的“字符”部分中的“嵌入...”按钮
3.  在 Embedded Font 窗口中，我在 Character Ranges 中选择了 All。
4.  单击确定。

重新发布 ela 后，我能够看到整个字母表。

加里

# git - 为什么即使文件/文件夹权限正常，git push 也会被拒绝？

> ID：11421084
> 
> 赞同：1
> 
> 时间：2012-07-10T20:06:01.843
> 
> 标签：git, push, permission-denied

我已经使用 putty/plink 使用 rsa 私钥/公钥建立了一个远程仓库。

我设法从远程仓库中获取，但我无法向它推送任何内容。

这是我得到的输出：

```
C:\cygwin\home\git\new_trunk>git push main login-2
Counting objects: 9993, done.
Delta compression using up to 4 threads.
Compressing objects: 100% (6971/6971), done.
fatal: Unable to create temporary file: Permission denied
error: pack-objects died of signal 13
error: failed to push some refs to 'ssh://git@remote.ps/appdata/git/yao/webapps.git' 
```

系统管理员检查文件权限是好的，但我不能推送？知道为什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T18:17:08.797

确保仔细检查文件夹的权限。

# java - 在 Android 中实现类似 Spring 的包扫描

> ID：11421085
> 
> 赞同：4
> 
> 时间：2012-07-10T20:06:21.190
> 
> 标签：java, android, spring, reflection, dalvik

`component-scan`我正在尝试为我正在开发的 Android 框架实现类似于 Spring 的包扫描功能。基本上，我希望能够指定一个基本包，例如`com.foo.bar`并检索所有`Class`具有特定注释的实例。我不想在我的框架中注册每个组件，因为这会破坏自动扫描的目的。

根据我的研究，Java 似乎无法使用反射检索给定包名称的资源。但是，我简要研究了[反射框架](http://code.google.com/p/reflections/)，我想知道是否有与 Android 兼容的等价物。如果没有，也许有一种不太明显的方法来完成我想做的事情。

我稍微研究了 Spring 源代码，看看他们是如何实现这一点的，但我认为他们所做的事情不会在 Dalvik 运行时中起作用。

**更新**

目前，下面的代码是我能做的最好的检索所有包含特定注释的类，但坦率地说，这是一个非常糟糕的解决方案。`ClassLoader`它对扫描（和加载）所有应用程序类的加号做了一些非常不安全的假设。

```
public Set<Class<?>> getClassesWithAnnotation(Class<? extends Annotation> annotation) {
    Set<Class<?>> classes = new HashSet<Class<?>>();
    Field dexField = PathClassLoader.class.getDeclaredField("mDexs");
    dexField.setAccessible(true);
    PathClassLoader classLoader = (PathClassLoader) Thread.currentThread().getContextClassLoader();
    DexFile[] dexs = (DexFile[]) dexField.get(classLoader);
    for (DexFile dex : dexs) {
        Enumeration<String> entries = dex.entries();
        while (entries.hasMoreElements()) {
            String entry = entries.nextElement();
            Class<?> entryClass = dex.loadClass(entry, classLoader);
            if (entryClass != null && entryClass.isAnnotationPresent(annotation)) {
                classes.add(entryClass);
            }
        }
    }
    return classes;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-01T10:17:57.380

我想在运行时找到所有子类。所以我一直在寻找android类扫描。这是我在 web.xml 中收集到的最终代码。你会明白的。

```
public static void findSubClasses(Context context, Class parent) {
    ApplicationInfo ai = context.getApplicationInfo();
    String classPath = ai.sourceDir;
    DexFile dex = null;
    try {
        dex = new DexFile(classPath);
        Enumeration<String> apkClassNames = dex.entries();
        while (apkClassNames.hasMoreElements()) {
            String className = apkClassNames.nextElement();
            try {
                Class c = context.getClassLoader().loadClass(className);
                if (parent.isAssignableFrom(c)) {
                    android.util.Log.i("nora", className);
                }
            } catch (ClassNotFoundException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            //              android.util.Log.i("nora", className);
        }
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } finally {
        try {
            dex.close();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-13T06:42:13.190

我同意 Joop Eggen 的观点，并发现他的方法很好。在 Android 中，我尽量避免导致应用程序长时间启动的常见网络应用程序功能。我不使用反射或包扫描。

但是，如果您想....如果我理解正确，您希望为班级添加注释。除了使用注释，您还可以使用标记接口（只是有更多的可能性）。

## 1）看

*   注释：[Java 自定义注释和动态加载](https://stackoverflow.com/questions/5105842/java-custom-annotation-and-dynamic-loading)
    **在问题中有一个实现，可以回答您的问题。**
*   注释：[在运行时扫描 Java 注释](https://stackoverflow.com/questions/259140/scanning-java-annotations-at-runtime)
*   接口：[查找实现接口的 Java 类](https://stackoverflow.com/questions/435890/find-java-classes-implementing-an-interface)
*   接口：[类似于 Java 1.5 中的 ServiceLoader 吗？](https://stackoverflow.com/questions/251336/is-something-similar-to-serviceloader-in-java-1-5)
*   接口：[如何在 Java 中以编程方式获取接口的所有实现的列表？](https://stackoverflow.com/questions/347248/how-can-i-get-a-list-of-all-the-implementations-of-an-interface-programmatically)
*   接口：由于这种方法很昂贵，也许[ServiceLoader](http://developer.android.com/reference/java/util/ServiceLoader.html)是执行时间和舒适度之间的折衷方案，因为它只加载服务文件中给定的类。另一方面，如果您的包中只有具有特定接口的类，那么 ServiceLoader 并没有那么快。

## 2）Android注解

我更喜欢[AndroidAnnotations](https://github.com/excilys/androidannotations/wiki)的工作方式（也许 AndroidAnnotations 中的集成是更可取的方式）：它使用标准的 Java Annotation Processing Tool 自动添加一个额外的编译步骤来生成源代码。因此，不是运行时扫描，而是基于编译时生成的注释执行代码。

我认为 Bean/EBean 注释可以为你工作（只有一个类）：[https ://github.com/excilys/androidannotations/wiki/Enhance%20custom%20classes](https://github.com/excilys/androidannotations/wiki/Enhance%20custom%20classes)

扫描功能不可用，请参阅此[线程](https://groups.google.com/forum/?fromgroups#!topic/androidannotations/fH1ary2ly3E)

## 3）编写自己的注释处理器

*   请参阅[APT（注释处理工具）](https://stackoverflow.com/questions/5032629/aptannotation-processing-tool)。这个想法是生成一个静态函数，它返回一个带注释的类列表，因此不需要类扫描。
*   一个很好的资源是[http://javadude.com/articles/annotations/index.html](http://javadude.com/articles/annotations/index.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-10T20:18:14.193

***编辑：***

我在 Android 问题跟踪器中发现[了这个问题。](http://code.google.com/p/android/issues/detail?id=10076)似乎`ClassLoader.getResource(String)`“按预期工作”，因为它返回`null`. 这是意料之中的，因为 DalvikVM 在编译后不会保留资源。问题中列出了解决方法，但可能还有另一种方法可以访问您想要的类。

使用[`PackageManager`](http://developer.android.com/reference/android/content/pm/PackageManager.html)获取 的实例[`ApplicationInfo`](http://developer.android.com/reference/android/content/pm/ApplicationInfo.html)。 `ApplicationInfo`有一个名为的公共字段，它是该应用程序源目录位置的[`sourceDir`](http://developer.android.com/reference/android/content/pm/ApplicationInfo.html#sourceDir)完整路径 (a )。从此`String`创建一个，您应该能够导航到源目录中的包。在那里，您可以使用我原始答案中的方法来查找您正在寻找的课程。`File``String`

```
String applicationSourceDir = 
    getPackageManager().getApplicationInfo(androidPackageName, 0).sourceDir; 
```

***/编辑***

您应该能够使用[`ClassLoader.getResource(String)`](http://developer.android.com/reference/java/lang/ClassLoader.html#getResource%28java.lang.String%29)来获取`URL`您的特定包（传入的`String`是您感兴趣的包名称，由路径分隔符而不是句点分隔）。有了这个`URL`，您可以调用[`getFile()`](http://developer.android.com/reference/java/net/URL.html#getFile%28%29)，您可以从中创建一个 Java`File`到包文件夹。从那里打电话[`packageFile.listFiles()`](http://developer.android.com/reference/java/io/File.html#listFiles%28%29)，你就有了你的类/子包。

对子包进行递归，对类`Class`使用静态[`Class.forName(String)`](http://developer.android.com/reference/java/lang/Class.html#forName%28java.lang.String%29)方法查找对象。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-11T12:10:56.300

看看 Vogar 的[ClassPathScanner](https://code.google.com/p/vogar/source/browse/trunk/src/vogar/target/ClassPathScanner.java)。它使用它来查找类路径上的测试用例。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-12T21:03:55.127

在您的 java 构建过程中合并类路径扫描，生成注入数据/代码。然后这也可以移植到 Dalvik。它甚至比动态扫描更有效。

# java - new LinkedList<>() 与 new LinkedList() 有何不同

> ID：11421090
> 
> 赞同：4
> 
> 时间：2012-07-10T20:06:26.353
> 
> 标签：java, generics

我只是偶然发现编译器对这两个术语的处理方式不同。当我输入：

```
LinkedList<String> list = new LinkedList(); 
```

我收到有关原始类型的编译器警告。然而：

```
LinkedList<String> list = new LinkedList<>(); 
```

删除警告。在我看来，这两个语句的含义基本相同（即创建一个没有指定对象类型的新 LinkedList）。那么为什么编译器允许空泛型呢？这里有什么区别？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-10T20:12:49.373

这些陈述根本不意味着同样的事情。

第一条语句尝试将未类型化的类型`LinkedList`放入已声明的泛型中`LinkedList<String>`并适当地引发警告。

第二条语句在 Java 1.7 及以后版本中有效，它使用*类型推断*通过使用声明类型的类型参数来猜测类型参数。此外，有时这可以在方法调用中使用。然而，它并不总是有效。

有关更多信息，请参阅[此页面](http://docs.oracle.com/javase/7/docs/technotes/guides/language/type-inference-generic-instance-creation.html)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-10T20:10:40.257

它是 Java 7 中的菱形运算符，可帮助您节省再次编写类型。在 Java 7 中，这等效于声明左侧使用的同一个泛型类型参数。所以初始化是类型安全的，不会发出警告。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-10T20:11:07.150

使用 LinkedList<>，您可以使用来自 java 7 的新菱形运算符。

Diamod 运算符使用行左侧设置的通用值。

在 Java 6 中，这不起作用！

> 然而，菱形运算符允许将赋值的右侧定义为真正的泛型实例，具有与左侧相同的类型参数......而无需再次键入这些参数。它允许您以与使用原始类型几乎相同的努力来保持泛型的安全性。
> 
> 我认为要理解的关键是原始类型（没有 <>）不能被视为与泛型类型相同。当你声明一个原始类型时，你没有得到泛型的任何好处和类型检查。您还必须记住，泛型是 Java 语言的通用部分……它们不仅仅适用于 Collections 的无参数构造函数！

摘自：[https ://stackoverflow.com/a/10093701/1281306](https://stackoverflow.com/a/10093701/1281306)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-10T20:07:12.983

Backword 兼容性（与遗留代码互操作）是 java 允许上述签名的原因。泛型只是编译时语法。在运行时“所有通用”语法将被删除。您将只查看是否反编译任何类文件。阅读本[文档](http://docs.oracle.com/javase/tutorial/java/generics/rawTypes.html)。

```
LinkedList list = new LinkedList(); 
```

# c# - .Net UI 和 Java 中间件

> ID：11421094
> 
> 赞同：3
> 
> 时间：2012-07-10T20:06:44.707
> 
> 标签：c#, java, .net

嗨，我们正在构建新的应用程序，它将具有 .Net UI 和 Java 中间件（服务）。由于我对 Java 还很陌生，所以我想根据什么是好的做法来探索我的选择，以便 .net uis 可以与 Java 中间层对话。Java中间层最终将调用数据库......

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-10T20:28:58.360

除了设计 WCF 可以理解的东西之外，您还可以考虑使用标准 HTTP 语义设计一个 ReSTful 服务。

对于 Java 端，您可以使用：

*   [泽西岛](http://jersey.java.net/)或
*   [RESTlet](http://www.restlet.org/)

在 .NET 的消费者端，您可以使用：

*   [RestSharp](https://www.github.com/restsharp/RestSharp)或
*   [HttpClient](http://msdn.microsoft.com/en-us/library/system.net.http.httpclient%28v=vs.110%29.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T20:10:26.163

使用 WCF 可以与之通信的某种服务构建您的 java 中间件，您应该一切顺利

这是一个简单的例子 [http://blogs.msdn.com/b/bursteg/archive/2008/07/19/how-to-call-a-java-ee-web-service-from-a-net-client .aspx](http://blogs.msdn.com/b/bursteg/archive/2008/07/19/how-to-call-a-java-ee-web-service-from-a-net-client.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-10T22:10:59.357

任何可以发送 HTTP 请求（REST 或 SOAP）的客户端都可以与 HTTP 侦听器或服务进行通信，而不管它们是用哪种语言实现的。这就是为什么基于 HTTP 的服务如此胜出，击败了 Corba、RMI、COM ， ETC。

简单而开放的胜利。

# visual-studio-2010 - 如何启用安装了 ReSharper 的 CU/CD

> ID：11421096
> 
> 赞同：2
> 
> 时间：2012-07-10T20:06:46.073
> 
> 标签：visual-studio-2010, resharper, vsvim

我最近在 VS 2010 中安装了 VsVim 和 ReSharper。ReSharper 热键似乎覆盖了 VsVim 的热键。

有没有办法让 VsVim 命令的优先级高于 ReSharper 的命令？

更具体地说，我希望`Ctrl`+`U`和`Ctrl`+`D`像在 Vim 中一样工作。

当我按`Ctrl`+`D`快捷方式冲突窗口出现时，似乎没有`PgDown`选项。

![ReSharper 快捷方式冲突窗口](../Images/5754cda8e454f199ddcf2c632e172baf.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-10-29T16:25:09.600

您需要告诉 ReSharper 您希望 Visual Studio 处理这些键盘快捷键而不是 ReSharper（在您在问题中显示的窗口中），并告诉 VsVim 您希望它处理它们而不是 Visual Studio。

在最新版本的 VsVim 中，您可以通过转到`Tools -> Options -> VsVim -> Keyboard`（“工具”是指 Visual Studio 菜单栏中的菜单）来执行此操作。在那里你可以配置你希望 VsVim 处理的内容。[正如约翰的回答](https://stackoverflow.com/a/14421214/834176)所说， Vim 的状态栏末尾曾经有一个“选项”按钮，但这不再是真的。

![选项窗口](../Images/0d432e28c0e15ba7aa0615e74f81acd4.png)

我已经`CTRL`-`d`并且`CTRL`-`u`设置为在我的 VsVim 配置中滚动，这样我就可以保证它可以正常工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T02:45:53.623

在图像中的窗口上选择 Visual Studio。然后打开一个文本文件（.cs、.cshtml 等），在窗口的右下角是一个“选项”按钮，位于您键入的 vsVim cmd 行的最右侧。单击选项按钮，您将获得一个列表。它会说“Ctrl_D handle with”，你的选项将是 Visual Studio 或 vsVim；只是切换它。您可以稍后返回并撤消它。我有 VS2010、Resharper 和 vsVim 并且没有问题，但它也可能是一个 .vimrc 配置设置，您需要在其中禁用 msvim 选项。

# video - 在 Firefox 上，我嵌入的 Youtube 视频无法正确显示

> ID：11421099
> 
> 赞同：0
> 
> 时间：2012-07-10T20:06:55.837
> 
> 标签：video, youtube, embedding

我在我正在开发的粉丝网站中嵌入了一些 YouTube 视频。但是，当您在 Firefox 中滚动浏览网页时，由于某种原因，div 和标题与视频重叠。坦率地说，它只是疯了。我打开了错误控制台（虽然我真的不知道如何处理它），它一直给我一个 JavaScript 错误。这是什么原因造成的？如果其他人想了解我的意思，请在 FireFox 中查看我的网站。网址是 www.theguildwars2hq.com

第一张图片是它应该看起来的样子，第二张是当你开始滚动时会发生什么。

我不能直接发布图片，所以去这里查看图片..

[正常的样子](http://img850.imageshack.us/img850/8612/supposedtolooklike.png)

[开始滚动时会发生什么](http://img23.imageshack.us/img23/6501/notsupposedto.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T20:46:46.433

我查看了该站点并得到了这个 JavaScript 错误：

```
Unsafe JavaScript attempt to access frame with URL http://www.theguildwars2hq.com/ from frame with URL http://www.youtube.com/embed/CgYZk8Rkf3g. Domains, protocols and ports must match. 
```

如果这不会让你有任何问题，那么它也可能与你的操作系统或浏览器有关，你是否在不同的系统上尝试过它或在你的系统上尝试过类似的网站？

祝你好运！

# jna - 使用 JNA 列出所有导出的符号名称

> ID：11421102
> 
> 赞同：2
> 
> 时间：2012-07-10T20:07:07.420
> 
> 标签：jna

如何使用 JNA 列出给定 dll 中的所有可用函数名称？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-11T17:49:38.740

JNA 允许您在运行时调用这些函数。要查看可用的内容，请使用适合该工作的工具。在 Windows 上，您有“ [dumpbin /exports](http://msdn.microsoft.com/en-us/library/c1h23y6c%28v=vs.71%29.aspx) ”。在 linux 上，你有[objdump](http://linux.die.net/man/1/objdump)。在 MacOSX 上，你有[otool](http://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man1/otool.1.html)。

如果您想使用 JNA 从正在运行的 Java 程序动态查找 DLL 中的函数名称，那么您需要复制这些程序的至少一些功能来解析目标文件以查找导出的符号。如果你只对 windows 感兴趣，那么[这个问题](https://stackoverflow.com/questions/1128150/win32-api-to-enumerate-dll-export-functions)提供了一个相对简洁的 DLL 数据解析。

# ruby-on-rails - 如何在 Rails 中创建自定义方法？

> ID：11421105
> 
> 赞同：2
> 
> 时间：2012-07-10T20:07:14.893
> 
> 标签：ruby-on-rails, methods

我目前正在尝试在 Rails 中使用自定义方法，但我不知道该怎么做。除了控制器中的默认方法之外，我还想添加以下内容：

```
 def cancel
    @newsletter = Newsletter.find(params[:id])

   respond_to do |format|

  #SendGrid Newsletter API - Delete Newsletter Schedule
  SendGrid.delete_schedule(@newsletter.name)

  @newsletter.status = "CANCELLED"

  @newsletter.save

  format.html { redirect_to newsletters_url }
  format.json { head :no_content }
end 
```

结尾

该方法就像默认的 :destroy 方法一样，但它实际上并没有销毁对象。

在我看来，我有以下几点：

```
<% @newsletters.each do |newsletter| %>
  <tr>
    <td><%= newsletter.identity %></td>
    <td><%= newsletter.name %></td>
    <td><%= newsletter.recipients %></td>
    <td><%= newsletter.subject %></td>
    <td><%= newsletter.html %></td>
    <td><%= newsletter.text %></td>
    <td><%= newsletter.schedule %></td>
    <td><%= newsletter.status %></td>
    <td><%= link_to 'Show', newsletter %></td>
    <td><%= link_to 'Edit', edit_newsletter_path(newsletter) %></td>
    <td><%= link_to 'Destroy', newsletter, method: :delete, data: { confirm: 'Are you sure?' } %></td>
    <td><% if newsletter.status == "SCHEDULED" %><%= link_to 'Cancel', newsletter, method: :cancel, data: { confirm: 'Cancel Schedule?' }%><% end %></td>

  </tr>
<% end %> 
```

我收到错误消息：没有路线匹配 [POST]“ ***_*** *newsletter url* **__** ”

当我耙路线时，没有任何路线可以解决上述错误。我可以知道如何添加路线以及为什么需要路线吗？

* * *

**更新** 目前，我仍然有没有路线匹配错误。以下是我与“取消”方法相关的所有文件：

### 路线.rb

```
 resources :newsletters do
    match '/cancel/:id' => 'newsletters#cancel', :as => :cancel
  end 
```

### newsletters_controller.rb

def cancel @newsletter = Newsletter.find(params[:id])

```
respond_to do |format|

#SendGrid Newsletter API - Delete Newsletter Schedule
  SendGrid.delete_schedule(@newsletter.name)

  @newsletter.status = "CANCELLED"

  @newsletter.save

  format.html { redirect_to newsletters_path(@newsletter) }
  format.json { head :no_content }
end
end 
```

### 时事通讯/index.html.erb

```
<%= link_to 'Cancel', newsletter_cancel_path(newsletter) %> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-10T20:16:43.517

您的`config/routes.rb`文件中应该有这样的一行

```
resources :newsletters 
```

你会想把它改成这个

```
resources :newsletters do
  member do
    put 'cancel'
  end
end 
```

您需要查看 Иван Бишевац 发布的路线指南。您还需要了解基本的 RESTful 路由以及 Rails 如何处理 GET、POST、PUT、DELETE 等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-10T20:11:57.463

这里是关于路由的完整解释：http: [//guides.rubyonrails.org/routing.html](http://guides.rubyonrails.org/routing.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-10T20:17:01.463

我认为您将 中的`method:`参数误认为`link_to`与控制器中的方法相对应。实际上它指的是 RESTful HTTP 动词，即 :post、:delete 和 :put。所以你不要通过这种方式传递控制器动作。

相反，您可以传入 :controller 和 :action 参数...

最好还是在 routes.rb 中创建一个路由并使用 rails 生成的路径。

```
match "/cancel/:id", to: "controller#cancel", as: :cancel 
```

然后 link_to 将类似于：

```
link_to 'Cancel', cancel_path(newsletter) 
```

**更新：** 你得到的错误是你的取消方法中的redirect_to（在控制器中）。将 newsletters_url 改为`newsletter_path(@newsletter)`改为。

如果您想重定向回单个时事通讯的显示页面，那么您需要执行上述操作（传入@newsletter 参数），如果您希望它返回到时事通讯索引页面，那么它将是`newsletters_path`.

`rake routes`您可以通过在终端中输入来检查路线是否存在。你会在那里看到所有的路线名称。

更改为 后仍然出现错误`redirect_to newsletter_path(@newsletter)`吗？

**不太正确的事情**是您没有定义 POST 路由 - 这通常指向格式错误的`form_for`. 检查您的时事通讯相关表格，尤其是在您不定期进行的任何地方`form_for @newsletter do |f|`。

# php - Facebook Graph 公共签到和位置

> ID：11421110
> 
> 赞同：2
> 
> 时间：2012-07-10T20:07:51.413
> 
> 标签：php, facebook, facebook-graph-api

在 facebook graph api 中，有一个提取“公共”信息的选项 - 即 - 搜索不是您朋友的用户的帖子，他们的用户不被视为“私人”。

我想知道是否可以选择提取“公共信息”，例如用户（不是我的朋友）签到。我在 facebook graph api 中没有找到这样的选项，但是如果有拉公共帖子数据的选项，那么拉签到数据也是有道理的。

我想知道是否存在这样的选项，在此先感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-10T22:12:52.790

在评论中发布的同一[查询](https://graph.facebook.com/search?q=hate%20my%20boss&type=checkin)中使用 type=checkin会导致 OAuthException 104“请求此资源需要访问令牌”。因此，似乎公共帖子可用于搜索，但公共签到不可用。

会将此添加为评论，但我还没有代表。

# symfony - Symfony2：访问控制的最佳实践

> ID：11421111
> 
> 赞同：4
> 
> 时间：2012-07-10T20:07:58.853
> 
> 标签：symfony, acl

我正在尝试找到一种在 Symfony2 中处理我的访问控制的好方法。

我的要求：

*   我的应用程序的 90% 只能由经过身份验证的用户访问
*   在许多控制器中，我需要检查用户是否是所有者
*   不同的用户角色也有一些差异

我已经做了什么：

*   安装 JMSSecurityExtraBundle 以通过注释检查权限
*   为我的实体类定义了全局 ace
*   在创建过程中，我为每个对象的所有者创建了一个 ace

检查所有者和角色没有问题。我只想以全局方式定义用户必须经过身份验证，并且对于异常（可以匿名访问的站点），我想将它分开定义（最好通过注释）。我不想通过路由模式来做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T22:02:20.190

我不确定这是否是您要查找的内容，但是您是否尝试过使用[Event Listener](http://symfony.com/doc/master/cookbook/event_dispatcher/before_after_filters.html)？

您可以在 onKernelController 方法中进行验证。然后，您将可以创建不同的接口并在侦听器中检查控制器的类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-25T22:58:33.933

类 AceBuilderListener 实现 EventSubscriber{

```
private $container;

public function setContainer($container){
    $his->container = $container;
}

public function getSubscribedEvents()
{
    return array(
            Events::prePersist,
            Events::preUpdate,
            Events::preRemove,
            Events::postPersist,
            Events::postUpdate,
            Events::postRemove,
            Events::loadClassMetadata,
    );
}

public function prePersist(){ echo( get_class($entity) ); }
public function preUpdate(){ echo( get_class($entity) ); }
public function preRemove(){ echo( get_class($entity) ); }
public function postPersist(){ echo( get_class($entity) ); }

public function postUpdate(LifecycleEventArgs $args)
{

    $entity = $args->getEntity();
    $entityManager = $args->getEntityManager();

    echo get_class($entity);
    // perhaps you only want to act on some "Product" entity
    if ($entity instanceof Product | x) {
        // ... do something with the Product
    }
}

public function postRemove(){ die( get_class($entity) ); }

public function loadClassMetadata( LoadClassMetadataEventArgs $args ){ 
    $classMetadata = $args->getClassMetadata();
    $entityManager = $args->getEntityManager();

            $user = $this->container->get('security.context')->getToken()->getUser();

            // you can check here if isGranted();
            // and get the entity from the object $classMetadata  
            $this->container->get('security.context')->isGranted('EDIT', $entity);

} 
```

}

# c# - 没有为此对象定义无参数构造函数 - 无法解决

> ID：11421112
> 
> 赞同：6
> 
> 时间：2012-07-10T20:08:10.897
> 
> 标签：c#, asp.net-mvc-3

我是 C# 和 MVC 的新手，所以请原谅我的幼稚/愚蠢。我已经看到多个帖子处理我遇到的错误，并且我已经尝试了所有解决方案，但它们似乎不适用于我的情况。请指导我找到解决此问题的正确方法。

**背景：** 我有 2 个模型 tblPrograms 和 tblReports。我正在尝试构建一个简单的表单，用户可以在其中创建一个新的 tblReport。创建新 tblReport 的部分过程是从列表中选择一个 tblProgram。

**代码概述：**

**控制器：**

```
 // GET: /Reports/

    public ViewResult New()
    {

        ProgramListModel progList = new ProgramListModel();
        tblReports2 report = new tblReports2();

        ExistingReportViewModel ervm = new ExistingReportViewModel(report,progList);

        return View(ervm);
    }

    [HttpPost]
    public ActionResult GenerateSQL(ExistingReportViewModel evrm)
    {
         evrm.Report.ProgramName = evrm.progList.selectedProgram;
        return View(evrm);
    } 
```

**查看型号：**

```
 public class ExistingReportViewModel
{
    public tblReports2 Report { get; set; }       
    public ProgramListModel progList { get; set; }

    //public ExistingReportViewModel() { }
    public ExistingReportViewModel(tblReports2 report, ProgramListModel progList)
    {            
        this.Report = report;
        this.progList = progList;   
    }    
} 
```

**楷模：**

```
public class tblReports2
{

    [Key]
    public string ProgramName { get; set; }
    public string ReportDesc { get; set; }
    ....
}
public class ProgramListModel
{
    public SelectList progList;
    public string selectedProgram;

    public ProgramListModel() {
        ReportHelper helper = new ReportHelper();
        this.progList = helper.getProgramList();
    }

} 
```

**辅助方法：**

```
public SelectList getProgramList()
    {
        var programs = from p in this.DB.tblProgramsSet
                       select p;
        programs = programs.Where(s => s.ProgramType.Equals("RPT"));                      
        SelectList list = new SelectList(programs, "ProgramName", "ProgramDescription");
        return list;

    } 
```

**看法：**

```
@model ReportsSetup.Models.ExistingReportViewModel

 @{
     ViewBag.Title = "New";
  }

  New
 @using (Html.BeginForm("GenerateSQL", "Reports"))
  {
@Html.ValidationSummary(true)
<fieldset>
    <legend>ExistingReportViewModel</legend>

        @Html.DropDownListFor(model=>model.progList.selectedProgram, Model.progList.progList)
        <div class="editor-label">
        @Html.LabelFor(model => model.Report.ReportDesc)
    </div>
    <div class="editor-field">
        @Html.EditorFor(model => model.Report.ReportDesc)
        @Html.ValidationMessageFor(model => model.Report.ReportDesc)
    </div>

    <div class="editor-label">
        @Html.LabelFor(model => model.Report.Formerly)
    </div>
    <div class="editor-field">
        @Html.EditorFor(model => model.Report.Formerly)
        @Html.ValidationMessageFor(model => model.Report.Formerly)
    </div>

    <div class="editor-label">
        @Html.LabelFor(model => model.Report.ExtendedDesc)
    </div>
    <div class="editor-field">
        @Html.EditorFor(model => model.Report.ExtendedDesc)
        @Html.ValidationMessageFor(model => model.Report.ExtendedDesc)
    </div>

    <div class="editor-label">
        @Html.LabelFor(model => model.Report.ReportCode)
    </div>
    <div class="editor-field">
        @Html.EditorFor(model => model.Report.ReportCode)
        @Html.ValidationMessageFor(model => model.Report.ReportCode)
    </div>

   ...

        <input type="submit" value="Create" />

</fieldset>
}

 <div>
     @Html.ActionLink("Back to List", "Index")
 </div> 
```

**错误：**

```
![Exception Details: System.MissingMethodException: No parameterless constructor defined for this object.][1] 
```

[http://i.stack.imgur.com/GHJpG.jpg](http://i.stack.imgur.com/GHJpG.jpg)

**尝试的解决方案：**

1.  重构代码以在 ProgramListModel 中使用 IEnumerable <tblPrograms> 而不是 SelectList，并使用类似于以下示例的函数在 View 中转换为 IEnumerable：

    ```
    public static IEnumerable<SelectListItem> ToSelectListItems(
              this IEnumerable<Album> albums, int selectedId)
    {
    return 
        albums.OrderBy(album => album.Name)
              .Select(album => 
                  new SelectListItem
                  {
                    Selected = (album.ID == selectedId),
                    Text = album.Name,
                    Value = album.ID.ToString()
                   });
     } 
    ```

2.  重构代码以使用 IEnumerable<SelectListItem> 而不是 ProgramListModel 中的 SelectList

**提前谢谢了！！**

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-10T20:09:23.963

不，你不能这样做：

```
public ActionResult GenerateSQL(ExistingReportViewModel evrm) 
```

如果您`ExistingReportViewModel`没有无参数构造函数。如果没有默认构造函数，默认模型绑定器不知道如何实例化此类。

所以你有两种可能性：

1.  为此类定义一个无参数构造函数：

    ```
    public class ExistingReportViewModel
    {
        public ExistingReportViewModel()
        { }

        ... some other stuff of course
    } 
    ```

2.  编写自定义模型绑定器

绝对去 1\. 除非你需要一些非常特别的东西。如果您需要一些非常特别的东西，请准确定义它，以便我们可以帮助您解决 2。

# asynchronous - 我需要关闭 IAsyncOperation 吗？

> ID：11421114
> 
> 赞同：2
> 
> 时间：2012-07-10T20:08:14.993
> 
> 标签：asynchronous, windows-runtime, winrt-async

在 WinRT 中，我需要调用`Close()`对象`IAsyncOperation<T> ^`吗？是操作启动代码，还是在完成处理程序中？如果没有，为什么会在那里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T01:45:51.637

从您的语法来看，您使用的是 C++/CX。

对于 C++/CX，IAsyncOperation::Close 会在析构函数中自动调用，因此您无需显式调用它。

对于 JS，您必须显式调用 .close()。

对于 C#，它被投影为 IDisposable，因此 using() 语句是合适的。

# amazon-s3 - 回形针 Mongoid S3 错误

> ID：11421118
> 
> 赞同：0
> 
> 时间：2012-07-10T20:08:26.590
> 
> 标签：amazon-s3, mongoid, paperclip

上传文件时出现此错误： **LoadError（没有要加载的文件——aws-sdk（您可能需要安装 aws-sdk gem））：app/controllers/uploaded_files_controller.rb:19:in `create'**

我正在使用 Mongo 和 Paperclip。我可以在不使用 s3 的情况下很好地上传文件。但是，我们的生产服务器在 Heroku 上，所以我必须使用 Amazon 来存储文件。

我已经阅读了关于此的其他 Stack Overflow 帖子，但没有一个解决我的具体问题。

1.  我已经多次重新启动服务器。不是这个。
2.  我确实需要我的 Gemfile 中的 Amazon gem
3.  放入亚马逊 gem 后，我已经完成了捆绑安装（我知道这很明显，但我仍然必须说明这一点）

4.  我没有使用 ImageMagick。这些上传是简单的文本文件上传。

5.  我知道我的 Amazon 存储桶名称和身份验证内容是正确的，因为我使用此应用程序以不同的容量连接到其他 Amazon 资源。

有人能帮忙吗 ？这是我的代码：

```
class UploadedFile
  include Mongoid::Document
  include Mongoid::Paperclip

  require "aws/s3"

  has_mongoid_attached_file :file,
    :storage        => :s3,
    :bucket_name    => 'my-uploads',
    :path           => ':attachment/:id/:style.:extension',
    :s3_credentials => File.join(Rails.root, 'config', 'amazon_s3.yml')

end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T14:14:54.427

好的，我找到了答案：gem 需要更新。

Paperclip 现在需要 Amazon SDK gem 而不是 s3 gem。

```
gem 'aws-s3', :require => "aws/s3" 
```

应该改为

```
gem 'aws-sdk',   :require => "aws-sdk" 
```

# php - PHP：require 与 include：实际考虑？

> ID：11421121
> 
> 赞同：3
> 
> 时间：2012-07-10T20:08:40.237
> 
> 标签：php, include, require

我已经读过 include 和 require 之间的区别之一是，虽然 include 仅在遇到 include 语句时才包含包含的文件，但 require 将文件包含到托管 require 语句的文件中，即使在 require 代码未到达时也是如此。执行流程。

这怎么可能有任何影响。毕竟，如果我有一个文件说：

```
<?php
  echo __LINE__;
?> 
```

输出将始终为 3，而不是在包含此类包含文件的文件内的位置打印行。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-10T20:12:32.313

据我所知，这根本不是真的。如果`require`代码中没有到达该行，则该文件肯定不会被包含在内。

[关于状态的 PHP 手册`require`](http://php.net/manual/en/function.require.php)：

> `require`与失败相同，`include` *但*它也会产生致命的**E_COMPILE_ERROR**级别错误。

^(（强调我添加的“除外”）)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-10T20:13:11.363

据我所知，这不是 require 的工作方式。唯一实际的区别是，如果无法包含文件， require 将导致脚本终止，并且 include 只会发出警告并继续执行。

一个非常重要的习惯用法取决于您声明的行为不正确：条件要求的文件。

```
if(is_secure_page()) {
  require "security.php";
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-10T20:19:22.433

两者`require`并`include`在执行流程中包含它们的文件。

一个简单的测试用例是：

```
if (false) {
  require_once("Nonexistent.php");
}
echo "I'm doing SCIENCE and I'm still alive.\n"; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-10T20:17:57.403

`require`，甚至更好，当您想要包含应用程序实际*需要*`require_once`的代码时，应该专门使用，例如您需要的任何库。和它的兄弟，应该只在包含文件不是执行脚本所必需的情况下使用，例如当您加载侧边栏或一些切线内容时。*`include``include_once`*

 *这两个语句之间唯一真正的**区别**是找不到文件，`require`抛出一个致命错误，并且`include`只会抛出一个警告，然后愉快地继续前进。

我相信两者都以完全相同的方式加载和解析`require`。`include`如果`require`会在给定的上下文中加载文件，那么`include`.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-10T20:18:40.783

我个人总是使用`require_once`，我发现在大多数情况下它是你需要的（要么你得到页面一次，要么你停止脚本）。如果`include`你想“尝试”包括一些东西，就会抛出你需要隐藏的警告。但这只是糟糕的编程习惯，一个简单`if (file_exists($file)) require_once $file;`的技巧就可以了，而且完全胜过`include`.

所以在我看来，`require`到目前为止，赢了。

PS：被秒杀！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-10T20:18:57.867

假设您正在运行一个关键任务应用程序，并且每秒将损失 1 美元。有些库仅在特定情况下使用，不会影响您的业务流程。您可能应该对这些可选库使用**include_once**。因为如果该文件不存在，**require**将阻止您的应用程序运行并出现致命错误。*

# php - 本地主机 WAMP 配置上的 AJAX 和 PHP 通信失败

> ID：11421124
> 
> 赞同：1
> 
> 时间：2012-07-10T20:08:49.837
> 
> 标签：php, ajax

首先，我是 AJAX 新手，这是我第一次尝试将 AJAX 与 PHP 结合使用。我遇到的问题是，虽然我的 XMLHttpRequest 状态成功将其状态更改为 4，即：完成，但 responseText 和所有其他响应类型都是“”（空）。

我尝试了非常简单的代码版本，最近尝试了 W3Schools AJAX 和 PHP 示例[http://www.w3schools.com/ajax/ajax_aspphp.asp](http://www.w3schools.com/ajax/ajax_aspphp.asp)的副本，该示例也未能返回任何内容。这让我相信这可能是一个配置问题，但我不知道从哪里开始？有什么建议吗？

这是我的 js 的一部分，适用于 AJAX PHP Comms：

```
$("#submitButton").click(function() {
    alert("The button has been clicked")
    if(($("#title").val().length < 3 ) || ($("#description").val().length < 3 ))
    {
        alert("Title and Description must be 3 characters or more!");
    }
    else
    {
            var ajaxRequest;

            try{
                // Opera 8.0+, Firefox, Safari
                ajaxRequest = new XMLHttpRequest();
            } catch (e){
                // Internet Explorer Browsers
                alert("THE PROBLEM WAS IE " + e);
                try{
                    ajaxRequest = new ActiveXObject("Msxml2.XMLHTTP");
                } catch (e) {
                    alert("THE PROBLEM WAS second " + e);
                    try{
                        ajaxRequest = new ActiveXObject("Microsoft.XMLHTTP");
                    } catch (e){
                        // Something went wrong
                        alert("Your browser broke!");
                        return false;
                    }
                }
            }   

            // receive data sent from the server
            ajaxRequest.onreadystatechange = function(){
                if(ajaxRequest.readyState == 4){
                    // Get the data from the server's response
                    var test = ajaxRequest.responseText; 
                    alert(test);
                    //console.log(xmlHttp);
                    console.log(ajaxRequest);
                }
            }

            //Variables
            var title =$("#title").val();
            var description =$("#description").val();
            var url = $("#url").val();

            ajaxRequest.open('GET','http://localhost/TestPHP/Model/AddNewVideo.php');
            try {
                ajaxRequest.send();
            }
            catch(e) {
                alert("THE PROBLEM WAS " + e);
            }   
    }
}); 
```

这是我的PHP代码。PHP 本身没有经过测试以确保 SQL 查询正常工作，但如果我只是将其简化为 echo 'hello world'，它甚至都不起作用。

```
 <?PHP
header('Access-Control-Allow-Origin: *');
//Connect to dBase
include("mysql_connect.php");
if ($_SERVER['REQUEST_METHOD'] == 'POST') {
    echo 'POSTed Method';
  }
if ($_SERVER['REQUEST_METHOD'] == 'GET') {
    echo 'GET Method';
  }

//Debugging
ini_set('display_errors', 'On');
error_reporting(E_ALL | E_STRICT);

//Gather Variables
echo $title = mysql_real_escape_string($_GET["TITLE"]);
$description = mysql_real_escape_string($_GET["DESCRIPTION"]);
$url = mysql_real_escape_string($_GET["URL"]);

//Insert new query
mysql_query('INSERT INTO video VALUES($title, $description, $url') or die(mysql_error());

//Close the DBase
mysql_close($connect);

echo $description;
?> 
```

我的使用 JQuery 的 js 更新和增强版；

```
$("#submitButton").click(function(event) {
        alert("The button has been clicked")
        if(($("#title").val().length < 3 ) || ($("#description").val().length < 3 ))
    {
        alert("Title and Description must be 3 characters or more!");
    }
    else
    {
            // Variables to pass
            var $form = $("#AddVideoForm"),
            // Gather all fields 
            $inputs = $form.find("input, select, button, textarea"),
            // serialize the data in the form
            serializedData = $form.serialize();

            try
            {
                //JQuery Based AJAX HTTP Request
                $.ajax({
                    url: "http://localhost/TestPHP/Model/AddNewVideo.php",
                    type: "POST",
                    data: serializedData,
                    success: function(response, textStatus, jqXHR){
                    // Show success
                    alert("Wonderful It worked");
                    console.log("Hooray, it worked!");
                    },
                    // callback handler that will be called on error
                    error: function(jqXHR, textStatus, errorThrown){
                    // log the error to the console
                    console.log("The following error occured: "+ textStatus, errorThrown)
                    },
                    complete: function(){
                    // Display Completed message
                    alert("Totally Completed!  Hoorah!");
                    }
                });
            } 
            catch (e)
            {
                alert("THE PROBLEM WAS " + e);
            }
            event.preventDefault();
    }
});' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T22:01:32.540

在评论中交流了几句后： 答案：

```
$("#submitButton").click(function(event) {
    /* ajax request here */
    event.preventDefault();
}); 
```

原因是浏览器在单击锚点或提交按钮时尝试执行其正常行为（我不知道被单击的元素）。preventDefault() 用于停止正常执行。

需要注意的一件事。对 Ajax 请求使用 jQuery。上面执行 ajax 请求的所有代码逻辑已经在 jQuery 框架上完成，您可以从 20 多行代码减少到几行。

# events - 如何触发传单地图多边形上的事件？

> ID：11421127
> 
> 赞同：20
> 
> 时间：2012-07-10T20:08:56.680
> 
> 标签：events, map, geojson, leaflet

我试图弄清楚如何手动触发 Leaflet 多边形的事件（通过 GeoJSON 加载）。

简而言之，我有一张带有许多多边形的传单地图。我在地图外还有一个常规超链接，单击该超链接时，应在特定多边形上触发鼠标悬停事件（或任何事件）。

**如何为我的所有多边形分配 ID，以便我可以将超链接绑定到特定多边形的事件？或者这甚至是最合乎逻辑的方式吗？**

最终，我试图创建一个包含许多多边形的地图以及与每个多边形相关联的文本标签的 HTML 表。单击 HTML 表格文本时，我想在地图多边形上触发事件（反之亦然）。我只是不知道如何引用每个多边形。

**这是我非常简化的 HTML：**

```
<body>

    <div id="map" style="height: 550px; width:940px"></div>

    <a href="#" id="testlink">Click to trigger a specific polygon mouseover event</a>

</body> 
```

**这是我非常简化的 JS：**

```
$(document).ready(function () {

// build the map and polygon layer
function buildMap(data) {

    var map = new L.Map('map');

    var cloudmadeUrl = 'http://{s}.tile.cloudmade.com/***yourkeyhere***/66267/256/{z}/{x}/{y}.png',
        cloudmadeAttribution = '',
        cloudmade = new L.TileLayer(cloudmadeUrl, {maxZoom: 18, attribution: cloudmadeAttribution});

    var mapLoc = new L.LatLng(43.675198,-79.383287);
    map.setView(mapLoc, 12).addLayer(cloudmade);

    var geojsonLayer = new L.GeoJSON(null, {});

    geojsonLayer.on("featureparse", function (e){

        // apply the polygon style
        e.layer.setStyle(polyStyle);

        (function(layer, properties) {
            layer.on("mouseover", function (e) {
                // change the style to the hover version
                layer.setStyle(polyHover);
                });
            });
            layer.on("mouseout", function (e) {
                // reverting the style back
                layer.setStyle(polyStyle);
            });
            layer.on("click", function (e) {
                // do something here like display a popup
                console.log(e);
            });
        })(e.layer, e.properties);

    });

    map.addLayer(geojsonLayer);

    geojsonLayer.addGeoJSON(myPolygons);    

}

// bind the hyperlink to trigger event on specific polygon (by polygon ID?)
$('#testlink').click(function(){
    // trigger a specific polygon mouseover event here
});

}); 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-07-24T20:56:58.367

好的，我已经想通了。

您需要为打开弹出窗口的每个多边形创建一个单击事件，并为每个多边形分配一个唯一的 ID，以便您以后可以引用它并手动触发其弹出窗口。

以下实现了这一点：

```
 var polyindex = 0;

    popup = new L.Popup();

    geojsonLayer = new L.GeoJSON(null, {});

    geojsonLayer.on("featureparse", function (e){

        (function(layer, properties) {

            //click event that triggers the popup and centres it on the polygon
            layer.on("click", function (e) {
                var bounds = layer.getBounds();
                var popupContent = "popup content here";
                popup.setLatLng(bounds.getCenter());
                popup.setContent(popupContent);
                map.openPopup(popup);
            });

        })(e.layer, e.properties);

        //assign polygon id so we can reference it later
        e.layer._leaflet_id = 'polyindex'+polyindex+'';

        //increment polyindex used for unique polygon id's
        polyindex++;
    });

    //add the polygon layer
    map.addLayer(geojsonLayer);
    geojsonLayer.addGeoJSON(neighbourhood_polygons); 
```

然后手动触发特定图层的点击事件，只需像这样调用它：

```
map._layers['polyindex0'].fire('click'); 
```

方括号之间的所有内容都是您要触发的图层的唯一 ID。在这种情况下，我触发了图层 ID polyindex0 的点击事件。

希望此信息对其他人有所帮助！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-06-02T01:36:06.980

所以，快速更新。

只需在您需要的任何层上调用[fireEvent](http://leafletjs.com/reference.html#events-fireevent)（或其别名`fire`）。

您不需要冒险._private [Vars]，只需获取对目标层的引用并开火，例如

```
var vectorLayer = map.getLayer('myVectorLayer');
vectorLayer.fire('click'); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-11T15:10:35.573

```
function clickMarker(i){
var popupContent = "content here or html format",
popup = new L.Popup({offset:new L.Point(0,-28)});

popup.setLatLng(LatLng);
popup.setContent(popupContent);
map.panTo(LatLng);
map.openPopup(popup); } 
```

i = 得到一个对应的坐标，即 LatLng

# cuda - 推力设备管理和内核

> ID：11421128
> 
> 赞同：4
> 
> 时间：2012-07-10T20:09:02.730
> 
> 标签：cuda, thrust

我在当前项目中使用 Thrust，因此我不必自己编写`device_vector`抽象或（分段）扫描内核。

到目前为止，我已经使用推力抽象完成了所有工作，但是对于简单的内核或不容易转换为 for_each 或转换抽象的内核，我更愿意在某些时候编写自己的内核。

所以我的问题是：我可以通过 Thrust（或者可能是 CUDA）询问当前正在使用哪个设备以及它具有哪些属性（最大块大小、最大共享内存，所有这些东西）？

如果我无法获得当前设备，那么如果我提供内核寄存器和共享内存要求，是否有某种方法可以让我获得计算内核尺寸的动力？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T02:53:30.207

您可以使用 CUDA 查询当前设备。请参阅有关[设备管理](http://developer.download.nvidia.com/compute/cuda/4_2/rel/toolkit/docs/online/group__CUDART__DEVICE.html)的 CUDA 文档。寻找`cudaGetDevice()`, `cudaSetDevice()`,`cudaGetDeviceProperties()`等。

Thrust 目前没有设备管理的概念。我不确定“获得推力以计算内核尺寸”是什么意思，但是如果您正在寻找确定用于启动自定义内核的网格尺寸，那么您需要自己做。它可以帮助查询内核的属性[`cudaFuncGetAttributes()`](http://developer.download.nvidia.com/compute/cuda/4_2/rel/toolkit/docs/online/group__CUDART__EXECUTION_ge89e3ebfbbdfa352b048c7d19904fc1b.html#ge89e3ebfbbdfa352b048c7d19904fc1b)，这是 Thrust 使用的。

# c# - 每行多个匹配集合

> ID：11421135
> 
> 赞同：0
> 
> 时间：2012-07-10T20:09:46.997
> 
> 标签：c#, .net, regex

我正在逐行解析文本文件，如何创建多个匹配集合并在处理的每一行上尝试多个匹配？

目前我正在尝试这个：

```
while ((line = reader.ReadLine()) != null) {

string match1 = @"\s+([^)]*):entry:\s+cust\(([^)]*)\)\s+custno\(([^)]*)\)\s+id\(([^)]*)\)\s+name\(([^)]*)\)";
string match2 = @"group\(([^)]*)\)\s+spec\(([^)]*)\)\s+goodtill([^)]*)$";
string match3 = @"returns\(([^)]*)\)";

MatchCollection matches = Regex.Matches(line, match1);
MatchCollection matches2 = Regex.Matches(line, match2);
MatchCollection matches3 = Regex.Matches(line, match3);

foreach (Match matchr1 in matches)
{

    line1.Add("Date:" + matchr1.Groups[1].Value + ", Customer:"
                    + matchr1.Groups[2].Value + ", CustID:" + matchr1.Groups[3].Value +
                    ", ID:" + matchr1.Groups[4].Value + ", Name:" + matchr1.Groups[5].Value);
}

foreach (Match matchr2 in matches2)
{

    line2.Add("Group:" + matchr2.Groups[1].Value + ", Spec:" + matchr2.Groups[2].Value + ", Good Till:" + matchr2.Groups[3].Value);
}

foreach (Match matchr3 in matches3)
{

    line3.Add("Returns: " + matchr3.Groups[1].Value);
}

} 
```

处理文件并尝试计算数组列表大小后：

```
MessageBox.Show(line1.Count + " " + line2.Count + " " + line3.Count); 
```

我收到 5000 0 0。为什么我的最后 2 个数组列表是空的？应该有很多匹配，正则表达式被确认是正确的。

样本数据：

```
LUCIE:496 27AUG120755:entry: cust(GUIR) custno(j010705) id(293746) name(mike)
LUCIE:496 27AUG120755:       group(0000) spec(03) stripdn(N) pre228(N)       goodtill 01/MAR/08
LUCIE:496 27AUG120755:getprotcode given (m000029374603MAR08), returns (TUUjFDEO) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T20:45:33.933

如果您要对数据字面化，则必须要求第二个和第三个正则表达式中缺少的组件。或者，如果它的变量，只需添加一些填充`.*?`

```
 group
 \(
   ( [^)]* )
 \)
 \s+ spec
 \(
   ( [^)]* )
 \)
  # missing :
  #      \s+ stripdn
  #      \(
  #        ( [^)]* )
  #      \)
  #      \s+ pre228
  #      \(
  #        ( [^)]* )
  #      \)

 \s+ goodtill
 ( [^)]* )
 $

 returns
  # missing a \s* here
 \(
     ( [^)]* )
 \)

LUCIE:496 27AUG120755:entry: cust(GUIR) custno(j010705) id(293746) name(mike)
LUCIE:496 27AUG120755:       group(0000) spec(03) stripdn(N) pre228(N)       goodtill 01/MAR/08
LUCIE:496 27AUG120755:getprotcode given (m000029374603MAR08), returns (TUUjFDEO) 
```

# c++ - 计算 2 [C++] 的幂的不良结果

> ID：11421140
> 
> 赞同：0
> 
> 时间：2012-07-10T20:10:15.540
> 
> 标签：c++, debugging, loops, vector

好吧，我已经把头撞在桌子上了。我试图通过将数字保存在 'char's 向量中来计算 2 的巨大幂 [超出 uint64_t 数据类型中能够保存的内容]。这是我的程序，后面是我的实际输出：

```
/*
This program doubles a very large number by using a vector of char types
Usage: program.exe [number]
Output will be 2^[number]
*/

#include <iostream>
#include <vector>
#include <stdlib.h>
using namespace std;

int main(int argc, char *argv[])
{
    vector<char> BigNum;
    BigNum.push_back('2');
    int carry=0, digit;
    int power=atoi(argv[1]);
    power-=1;
    for(int x=0;x<power;x++)                            //Example: going from 16 to 32\.  x==4
    {
        for(int y=BigNum.size()-1;y>=0;y--)             //Go from BigNum[1] to BigNum[0] ('6' then '1')
        {
            digit=atoi(&BigNum[y]);                     //digit = 6, then digit=1
            BigNum[y]=(char)(((digit*2+carry)%10)+48);  //BigNum[1]=(char)(6*2+0)%10+48 = '2' in char
                                                        //BigNum[0]=(char)(1*2+1)%10+48 = '3' in char
            carry=digit*2/10;                           //carry=1, then 0
        }
        if(carry==1)                                    //does not execute.  BigNum=={'3','2'}
        {
            BigNum.push_back('0');
            for(int y=BigNum.size()-1;y>0;y--)
            {
                BigNum[y]=BigNum[y-1];
            }
            BigNum[0]='1';
            carry=0;
        }
    }
    for(int x=0;x<BigNum.size();x++) cout<<BigNum[x];
} 
```

编译：

```
g++ program.cpp -o program 
```

所以这是我运行程序时的结果：

```
C:\MyApps\program 2
4
C:\MyApps\program 3
8
C:\MyApps\program 4
16 
```

好的，到目前为止看起来不错......甚至我的“if（carry == 1）”部分，我将一个数字推到向量的前面，因为我们“携带1”进入两位数。让我们继续：

```
C:\MyApps\program 5
52 
```

什么？

```
C:\MyApps\program 6
26 
```

什么什么？

```
C:\MyApps\program 654
84
C:\MyApps\program 654444
00 
```

它永远不会达到三位数......到底发生了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-10T20:28:12.673

您正在申请`atoi`的不是以空字符结尾的字符串。在实践中，它在内存中可能看起来像一个以 null 结尾的字符串，但不是您真正希望它看起来的样子。

解决此问题的最简单方法可能是在向量中存储实际数字值 0..9 而不是 ASCII '0'..'9'。你会发现这样的代码也更好。

# c++ - 在 linux 上构建静态 c++ 库 - 我需要链接到其他库吗？

> ID：11421143
> 
> 赞同：1
> 
> 时间：2012-07-10T20:10:33.327
> 
> 标签：c++, linux, linker, g++, static-libraries

我一直在 Linux 上构建一个静态库。到目前为止，它完全是自包含的，里面的所有代码都没有使用标准库以外的任何东西。我最近进行了更改，现在一些编译单元正在使用 boost 代码。我一直在使用以下方法构建库：

```
g++ -c -Wall -pedantic  *.cpp
ar -cvq libbfclass.a *.o 
```

我的问题是：我是否有必要调整这种方法来处理新库的使用，或者在构建使用我自己的库的可执行文件时我是否只需要提供链接库？据我了解，静态库基本上只是目标文件的存档，但我想知道是否需要修改构建脚本以使一切正常工作，还是仅在构建可执行文件时才需要？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-10T20:13:13.860

你是对的 - 静态库只是目标文件的存档。编译最终可执行文件时会解析符号，因此您需要提供对其他库的引用。

# asp.net - Crystal Report Viewer（Web 查看器）在 Internet Explorer 中不显示向下钻取

> ID：11421146
> 
> 赞同：1
> 
> 时间：2012-07-10T20:10:50.663
> 
> 标签：asp.net, internet-explorer, crystal-reports

我有一个带有水晶报告的应用程序，我刚刚注意到它有一个相当大的问题。左侧的树形视图/向下钻取菜单不会显示在 Internet Explorer 中，但它确实适用于其他浏览器（chrome/firefox/等）。我以前从未使用过 CR（这些实际上是继承的，我没有接触过它们），但我猜它是一个 IE 选项，它没有在某个地方设置。知道如何解决这个问题吗？

![Internet Explorer 缺少左侧面板](../Images/1542451bd84e4ebf12f96aae2178b297.png)

![带有左侧面板的 Chrome](../Images/b4ae0b78e9b0b88224f2e0e509e96977.png)

**编辑：**

根据有关浏览器版本的问题，我正在使用 IE8。我确实注意到，当关闭兼容模式时，它会按我的预期显示。但是，该应用程序也应该处理 IE7（我无权访问）。

# mysql - MySQL - 使用“重复值”连接 2 个表以填补时间序列中的空白

> ID：11421147
> 
> 赞同：0
> 
> 时间：2012-07-10T20:10:55.983
> 
> 标签：mysql

所以我有 2 张桌子需要加入。表 1 包含一个名为 JDAY 的列，其中包含值 1.5、2.5、3.5...365.5。看起来像：

```
JDAY
1.5
2.5
3.5
4.5
5.5
etc. 
```

我想将它与 Table2 一起加入，它看起来像：

```
JDAY  WSC
1     1
5     .9
8     .7
366   .5 
```

最终结果应该有一个 JDAY 列，其中包含 Table1 中的所有值，并且 Table2 中的 WSC 值对应于小于或等于 Table2 中的最接近的 JDAY 值。例如，表 1 中的 JDAY=5.5 对应于 WSC=.9，因为 5.5 介于 5 和 8 之间。它看起来像这样：

```
JDAY   WSC
1.5    1
2.5    1
3.5    1
4.5    1
5.5    .9
6.5    .9
7.5    .9
8.5    .7
9.5    .7
etc. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T20:19:29.280

获得结果的一种方法是使用相关子查询：

**更新**

```
SELECT t1.JDAY
     , (SELECT t2.WSC FROM Table2 t2 
         WHERE t2.JDAY < t1.JDAY
         ORDER BY t2.JDAY DESC LIMIT 1
       ) AS WSC
  FROM Table1 t1
 ORDER BY t1.JDAY 
```

您注意到您希望~~WSC 的最大值~~小于 JDAY；我认为这意味着您希望Table2 中 JDAY 值小于 Table1 行中 JDAY 值的行中~~的 WSC 最大值。~~这似乎与您显示的结果集相符。（如果我弄错了（我可能有），那是我的误解，阅读了一些你不打算的东西，如果是这样，请随时纠正我。）

**更新**

我有一个更好的理解，您希望表 2 中具有比表 1 中的 JDAY 值早的最大 JDAY 值的行中的 WSC 值。您希望 WSC 从具有最新较早日期的行中获取。我的答案中的查询已修改以满足此要求。

* * *

获得基本相同结果集的另一种方法是使用 theta-join（即，不等式谓词的连接）

**更新**

```
SELECT t.JDAY
     , s.WSC
  FROM ( SELECT t1.JDAY
              , MAX(t2.JDAY) AS max_t2_jday
           FROM Table1 t1
           LEFT
           JOIN Table2 t2
             ON t2.JDAY < t1.JDAY
          GROUP BY t1.JDAY
          ORDER BY t1.JDAY
       ) t
  LEFT
  JOIN Table2 s
    ON s.JDAY = t.max_t2_jday 
```

只要表 2 中没有任何“重复”的 JDAY 值，这将起作用。如果有重复值，您需要有一种方法来消除返回的任何重复值。添加 a`GROUP BY t.JDAY`就足够了，但不是确定性的。（也就是说，您无法保证从哪一行获得 WSC 值。）

在这里，我们要求 Table1 中的每一行，以及 Table2 中的任何“匹配”行，匹配 Table2 中的 JDAY 小于 Table1 中的 JDAY。对于 Table1 中的每一行，我们将翻阅 Table2 中的所有“匹配”行（如果有），我们将从 Table2 中挑选出与 JDAY 匹配的最大~~WSC 值~~，并将其返回到别名为 t 的子查询（内联视图）中。然后，我们可以将该结果集连接回 Table2，以获取匹配的行以及该行上的 WSC 值。

当表 1 中有 JDAY 的“重复”值时，这些查询之间的一个区别就会发挥作用，它们将返回略有不同的结果集。第一个查询将返回 Table1 中的所有行，包括 JDAY 的重复值。第二个查询将从表 1 中删除 JDAY 的重复值，并返回一组不同的 JDAY 值。

* * *

更新：

我已经更新了上面的答案，没有得到`MAX(WSC)`值，而是从 Table2 中最接近的 JDAY 小于 Table1 JDAY 的行中获取 WSC 值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T20:28:28.180

你试过这个吗？

```
select t1.*,t2.* from table 1 as t1
join table2 as t2
on round(t2.jday)=(t1.jday+1)
group by t1.jday
order by t1.jday; 
```

# c++ - QTableView，一个标题的多列

> ID：11421153
> 
> 赞同：2
> 
> 时间：2012-07-10T20:11:15.077
> 
> 标签：c++, qt, user-interface

我正在寻找一种在 QTableView 中跨三列显示一个列标题的方法。

这似乎应该是可能的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T20:32:14.613

void QTableView::setSpan ( int row, int column, int rowSpanCount, int columnSpanCount )

[文档](http://qt-project.org/doc/qt-4.8/qtableview.html#setSpan)

# linux - 如何为 Eclipse 设置 Super/Windows/mod4 键绑定

> ID：11421156
> 
> 赞同：11
> 
> 时间：2012-07-10T20:11:36.573
> 
> 标签：linux, eclipse, keyboard-events, xmodmap, windows-key

我想在涉及键（“windows”键）的eclipse（3.7.2）中设置一些键绑定，但是当我按下它时它似乎没有拾取那个修饰键。为什么？我该怎么做才能检测到它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-25T06:55:27.000

Eclipse 不挂钩 Windows 键。您唯一能做的就是使用工具将 Windows 键重新绑定到例如`CTRL`++ （如果您不使用它）`ALT`。`SHIFT`像 [AutoHotkey](https://autohotkey.com/)这样的工具可以完成这项工作。

然后，每当您按下 windows 键时，就好像您按下了++ `CTRL`，然后您可以使用它来绑定您想要的热键。`ALT``SHIFT`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-09-02T22:07:14.947

您在问题中标记了“linux”，所以我假设您使用的是 Linux 和 X ...

所以，要在 Eclipse 中使用 Super，首先你必须发现你是否*有*一个 Super，如果没有，就做一个。在 xmodmap 的主题上，剩下的部分可能比你需要的要多得多。

首先要做的是查看您是否已经拥有 Super 修饰键。运行“xmodmap -pm”来查看你当前的修饰符是什么。这是一个常见的输出：

```
$ xmodmap -pm
xmodmap:  up to 4 keys per modifier, (keycodes in parentheses):

shift       Shift_L (0x32),  Shift_R (0x3e)
lock        Caps_Lock (0x42)
control     Control_L (0x25),  Control_R (0x69)
mod1        Alt_L (0x40),  Alt_R (0x6c),  Meta_L (0xcd)
mod2        Num_Lock (0x4d)
mod3      
mod4        Super_L (0x85),  Super_R (0x86),  Super_L (0xce),  Hyper_L (0xcf)
mod5        ISO_Level3_Shift (0x5c),  Mode_switch (0xcb) 
```

在上面的输出中，一堆键已经映射到 Super，（十六进制）键码为 0x85、0x86、0xce 和 0xcf。要查看键盘上的任何东西是否恰好是这些键之一（并非总是如此），请在终端中运行“xev”并将鼠标指针移动到“xev”的大部分为白色的输入窗口中，然后尝试不同的键。键的典型输出如下所示（尝试 control 和 shift 以查看示例） - 特别注意带有键码和键符号名称的第三行，此处为 64 和 Meta_L。

一定要试试你的“Windows”键，看看它目前有什么键码和映射。

```
KeyPress event, serial 42, synthetic NO, window 0xe600003,
    root 0x6b6, subw 0x0, time 2232472454, (-1,167), root:(871,683),
    state 0x0, keycode 64 (keysym 0xffe7, Meta_L), same_screen YES,
    XLookupString gives 0 bytes: 
    XmbLookupString gives 0 bytes: 
    XFilterEvent returns: False 
```

找到“keycode”部分并将其转换为基数 16。如果您点击了其中一个 Supers，则转换后的代码将匹配其中一个（在上面的示例中为四个）十六进制键码，并显示 Super_L 或 Super_R 而不是Meta_L 如上所示。

如果您没有任何键映射到 Super，或者您的键盘上没有任何键，则使用 xev 查找您*要*用于 Super 的键的键码（CapsLock 对于某些人来说可能是一个不错的选择伙计们），然后使用 xmodmap 或桌面 UI 中的其他工具进行设置。后者不在此回复的范围内，但使用 xmodmap，您可以在主目录中创建一个名为 .Xmodmap 的文件，其中包含以下内容：

```
! note: replace the 0xff below with your *actual* Super_L key's keycode.
! note: whether to use mod3 or mod4 depends on your environment.
keycode 0xff = Super_L
clear mod4
add mod4 = Super_L 
```

使用“xmodmap ~/.Xmodmap”应用结果。许多 X 初创公司会自动为您应用这些。如果您使用的是 Ubuntu Unity，请在 Dash 中查找启动应用程序并为同一命令添加一个。我不确定“~”在上下文中是否有效，您可能想尝试 $HOME 或者只是在那里使用您的主目录。它最终在 ~/.config/autostart/xmodmap.desktop 中生成一个文件，如下所示（erlkonig = me; 把你的家放在里面）：

```
$ cat ./.config/autostart/xmodmap.desktop
[Desktop Entry]
Type=Application
Exec=/usr/bin/xmodmap /home/erlkonig/.Xmodmap
Hidden=false
NoDisplay=false
X-GNOME-Autostart-enabled=true
Name[en_US]=Xmodmap Keymap Settings
Name=Xmodmap Keymap Settings
Comment[en_US]=Set Keyboard Bindings
Comment=Set Keyboard Bindings 
```

您可以使用“xmodmap -pm”或“xev”验证结果。这是我的环境从更复杂的设置中获得的前者的输出（这可能与您自己想要的不匹配）。

```
$ xmodmap -pm
xmodmap:  up to 4 keys per modifier, (keycodes in parentheses):

shift       Shift_L (0x32),  Shift_R (0x3e)
lock        Caps_Lock (0x7f)
control     Control_L (0x25)
mod1        Meta_L (0x40),  Meta_L (0xcd)
mod2        Alt_L (0x6c),  Alt_L (0xcc)
mod3        Super_R (0x69),  Super_L (0x85),  Super_R (0x86),  Super_L (0xce)
mod4        Hyper_L (0x42),  Hyper_L (0xcf)
mod5        Num_Lock (0x4d) 
```

Hyper 取代了 CapsLock（我已将其移至别处）；我将它用于窗口管理器功能，例如 Hyper-f 用于“前置”窗口，Hyper-r 用于调整大小等。

对于另一个使用 xmodmap 可以实现的随机（ish）示例，这里有一个键映射，它将任何键码 78 映射到 Mode_switch，然后允许您将其与 '、"、` 和 ~ 组合以输入构成下一个元音的前缀有类似的变音符号。你也可以使用 Mode_switch 和 a 来获取 æ，d 来获取 ð，? 来获取 ¿，以及其他一些。

```
! note: 78 is probably not the keycode most would want here; pick your own :-)
keycode 78 = Mode_switch
!                      no mods shift           mode-switch shift+mode-switch
keysym a          =          a A                        ae AE 
keysym d          =          d D                     thorn THORN
keysym n          =          n N                    ntilde Ntilde
keysym o          =          o O                    oslash Oslash
keysym t          =          t T                       eth ETH
keysym s          =          s S                    ssharp
keysym 0          =          0 parenright           degree     
keysym 6          =          6 asciicircum dead_circumflex
keysym 8          =          8 asterisk           multiply    
keysym apostrophe = apostrophe quotedbl         dead_acute dead_diaeresis
keysym grave      =      grave asciitilde       dead_grave
keysym comma      =      comma less           dead_cedilla guillemotleft
keysym period     =     period greater            NoSymbol guillemotright
keysym slash      =      slash question           NoSymbol questiondown
keysym 1          =          1 exclam             NoSymbol exclamdown
keysym equal      =      equal plus               notequal plusminus 
```

有关更多信息，请使用“man xmodmap”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-05-07T00:20:13.357

我怀疑您的核心目标是在现有的控件和 alt 绑定之外创建键绑定。因此，例如，让 Windows-L 执行与 Control-L、Alt-L 或 Shift-L 不同的操作。

不幸的是，Linux 上的 Eclipse 似乎不支持 shift、control 和 alt 之外的修饰符（在 xmodmap 中是 mod1）。因此，您无需将 Windows 键映射到其他修饰符。合乎逻辑的选择是 mod4，但似乎 SWT 在非 Windows 平台上不支持 mod4。

[在https://bugs.eclipse.org/bugs/show_bug.cgi?id=55236](https://bugs.eclipse.org/bugs/show_bug.cgi?id=55236)添加非 Windows mod4 支持存在一个错误。不幸的是，它被标记为“不会修复”一段时间了。我建议去那里投票并分享其他用户案例/重新打开它的原因，如果你有的话。

# iphone - Brightcove 视频无法通过 iphone 4 上的 fancybox 显示

> ID：11421157
> 
> 赞同：2
> 
> 时间：2012-07-10T20:11:38.477
> 
> 标签：iphone, fancybox, brightcove

我遇到了一个问题，fancybox 在 iphone 4 上不显示 Brightcove 视频，而它在 Firefox、IE 7、IE8、IE9、Safari 和 Chrome 以及 Android 手机上工作。

我有js来填充视频的fancybox，如下所示，

```
$(".myfancybox").fancybox({
    'showCloseButton'   : true,
    'titlePosition'         : 'inside',
    'titleFormat'       : formatVideoTitle,
    'content'       : formatVideoContent,
    'scrolling'     : 'no',
    'autoScale'     : true
}); 
```

名为 formatVideoContent 的函数将获取 html（brightcove 视频 html 代码，如下，需要 videoPlayer、playerID 和 Key）并将其传递给“content”参数。

```
<object id="flashObj" width="486" height="412" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,47,0" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000">
<param value="http://c.brightcove.com/services/viewer/federated_f9?isVid=1" name="movie">
<param value="#FFFFFF" name="bgcolor">
<param value="@videoPlayer=xxx&playerID=xxx&playerKey=xxx&domain=embed&dynamicStreaming=true" name="flashVars">
<param value="http://admin.brightcove.com" name="base">
<param value="false" name="seamlesstabbing">
<param value="true" name="allowFullScreen">
<param value="true" name="swLiveConnect">
<param value="always" name="allowScriptAccess">
</object> 
```

我知道iOS不支持.flv或.mov，但我在fancybox中使用的brightcove视频html代码在iphone上的常规html页面中工作，只是在插入fancybox后在iphone上不起作用。Fancybox 版本是 1.3.4，jQuery 是 1.4.4。

有没有人尝试通过 iphone 上的 fancybox 播放 Brightcove 视频？感谢您的任何提示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T13:06:00.357

这是 Brightcove 的 Flash 播放器的简单嵌入代码。它不适用于iOS。您需要使用他们的 javascript 代码，因为正是该 javascript 决定是否将对象替换为适当的 Flash 或 HTML 播放器。看起来像这样：

```
<object id="bcPlayer" class="BrightcoveExperience">
  <param name="bgcolor" value="#FFFFFF" />
  <param name="width" value="480" />
  <param name="height" value="270" />
  <param name="playerID" value="xxxx" />
  <param name="playerKey" value="xxxx" />
  <param name="isVid" value="true" />
  <param name="isUI" value="true" />
  <param name="dynamicStreaming" value="true" />  
  <param name="@videoPlayer" value="xxxx" />
</object> 
```

您需要在页面中包含 Brightcove javascript：

```
<script type="text/javascript" src="http://admin.brightcove.com/js/BrightcoveExperiences.js"></script> 
```

您需要`brightcove.createExperiences()`在插入播放器代码后调用。

这有效：

```
<script type="text/javascript" src="http://admin.brightcove.com/js/BrightcoveExperiences.js"></script>
<script type="text/javascript">
formatVideoContent = '<object id="myExperience1353062063001" class="BrightcoveExperience">';
bcVideo += '  <param name="bgcolor" value="#FFFFFF" />';
bcVideo += '  <param name="width" value="400" />';
bcVideo += '  <param name="height" value="225" />';
bcVideo += '  <param name="playerID" value="1150189326001" />';
bcVideo += '  <param name="playerKey" value="AQ~~,AAAA0vRfoQE~,baHF9-H5aHJPAl3cZ-KjgHH9A7WtanGe" />';
bcVideo += '  <param name="isVid" value="true" />';
bcVideo += '  <param name="isUI" value="true" />';
bcVideo += '  <param name="dynamicStreaming" value="true" />';
bcVideo += '  <param name="@videoPlayer" value="1353062063001" />';
bcVideo += '</object>';
bcVideo += '<scr'+'ipt>brightcove.createExperiences();</scr'+'ipt>';
$(document).ready( function() {
  $(".myfancybox").fancybox({
    showCloseButton: true,
    content: bcVideo,
    scrolling: 'no',
    width: '400',
    height: '225'
  });
});
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T03:01:27.920

> *....我在fancybox 中使用的相同brightcove 视频html 代码在iphone 上的常规html 页面中工作*

`iframe`您可以使用此类代码创建一个单独的 html 页面，并使用以下脚本类型的内容在 fancybox 中打开它：

```
$(".myfancybox").fancybox({
    'showCloseButton': true,
    'titlePosition' : 'inside',
    'titleFormat'   : formatVideoTitle,
 // 'content'       : formatVideoContent,
    'scrolling'     : 'no',
 // 'autoScale'     : true,
    'width'         : 486,
    'height'        : 412,
    'type'          : 'iframe'
}); 
```

# octave - 在 Octave 中获取没有线条的 yerror 图

> ID：11421163
> 
> 赞同：0
> 
> 时间：2012-04-14T11:01:44.810
> 
> 标签：octave

我想用 y-error-bars 和简单的点打印一个图。我当前的 Octave 脚本如下所示：

```
errorbar(x_list, y_list, Delta_y_list, "~.x");
title("physikalisches Pendel");
xlabel("a^2 [m^2]");
ylabel("aT^2 [ms^2]");
print -dpdf plot.pdf 
```

我得到的情节有一条线，虽然我指定了`.x`样式选项：

[http://wstaw.org/m/2012/04/14/umbrella5.png](http://wstaw.org/m/2012/04/14/umbrella5.png)

我怎样才能摆脱那条线？

而且 ylabel 也在比例尺中，有什么方法可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T16:20:08.643

必须设置线型：

```
p1 = errorbar(plot_x, plot_y, plot_error, "~.k");

set(p1, "linestyle", "none");
set(p1, "marker", "+"); 
```

# javascript - 在 three.js 程序中运行 webgl 函数

> ID：11421166
> 
> 赞同：1
> 
> 时间：2012-07-10T20:12:10.410
> 
> 标签：javascript, webgl, three.js

在我的 three.js 脚本中，我想使用这个 webgl 函数：gl.blendFunc(gl.ONE,gl.ONE)。我怎么能用 three.js 做到这一点？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T05:21:56.510

```
var gl = renderer.context;
gl.blendFunc(gl.ONE,gl.ONE); 
```

# algorithm - 如何在比 O(n^2) 时间更好的时间内找到冒泡排序中的预期交换次数

> ID：11421170
> 
> 赞同：1
> 
> 时间：2012-07-10T20:12:18.323
> 
> 标签：algorithm, swap, bubble-sort

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-10T21:22:23.147

好吧，让我们考虑一下。

我们意识到，每个数字最终都需要与小于它之后的每个数字交换，迟早。因此，给定数字的掉期总数是它后面小于它的数字的总数。然而，这仍然是`O(n^2)`时间。

对于冒泡排序的外循环的每一次通过，一个元素被放置在正确的位置。不失一般性，我们会说，对于每一次通过，剩余的最大元素都会被排序到列表的末尾。

因此，在外循环的第一遍中，最大的数字放在最后。这需要*q*次交换，其中*q*是从最终位置开始的位置数。

因此，我们可以说需要*q [1] +q [2] + ... +q [n]*交换来完成这个冒泡排序。但是，请记住，每次交换时，都会将一个数字靠近一个位置或远离其最终位置一个位置。在我们的特定情况下，如果一个数字在一个更大的数字前面，并且在其正确位置或前面，则需要再进行一次交换。但是，如果一个数字落后于一个更大的数字并且落后于它的正确位置，则需要少交换一次。

我们可以通过以下示例看到这是正确的：

```
 5 3 1 2 4
=> 3 5 1 2 4
=> 3 1 5 2 4
=> 3 1 2 5 4
=> 3 1 2 4 5
=> 1 3 2 4 5
=> 1 2 3 4 5 (6 swaps total) 
```

"5" 移动 4 个空格。"3" 移动 1 个空格。"1" 移动 2 个空格。"2" 移动 2 个空格。"4" 移动 1 个空格。总计：10 个空格。

请注意，3 在 5 之后，在其正确位置的前面。因此，将需要再进行一次交换。1 和 2 落后于 3 和 5 - 将需要少四次交换。4 落后于 5 并且落后于它的正确位置，因此需要少交换一次。我们现在可以看到，预期值 6 与实际值匹配。

我们可以通过首先对列表进行排序来计算 Σq *，*在进行排序时将每个元素的原始位置保留在内存中。这在`O(nlogn + n)`时间上是可能的。

我们还可以看到哪些数字落后于其他数字，但这不可能比`O(n^2)`时间更快。但是，我们可以获得更快的解决方案。

每次交换都有效地将两个数字移动到正确的位置，但有些交换实际上什么也没做，因为一个最终被交换，每个数字在它小于它之后变得更近，而另一个数字迟早会变得更远。我们前面的例子中的第一次交换因此，在“3”和“5”之间是我们例子中唯一的例子。

我们必须计算有多少所述掉期的总数。这留给读者作为练习，但这里有最后一个提示：您只需遍历列表的前半部分。虽然这对于给定的数字仍然是，最后`O(n^2)`，我们只需要对`O(n^2)`列表的前半部分总数进行操作，使其后面的数字总体上更快。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-25T23:52:06.113

使用分而治之

除：序列n的大小到两个大小为n / 2的列表征服：递归计算两个列表组合：这是一个技巧部分（在线性时间内完成）

结合使用合并和计数。假设这两个列表是 A，B。它们已经排序。从 A、B 生成输出列表 L，同时还计算反转次数 (a,b)，其中 a 在 A 中，b 在 B 中，并且 a > b。

这个想法类似于合并排序中的“合并”。将两个排序的列表合并为一个输出列表，但我们也计算反转。

每次将 a_i 附加到输出时，都不会遇到新的反转，因为 a_i 小于列表 B 中剩下的所有内容。如果将 b_j 附加到输出中，则它小于 A 中的所有剩余项，我们增加按 A 中剩余元素数计算的反转计数。

合并和计数（A，B）；A,B 两个输入列表（已排序）；C 输出列表；i,j 当前指向每个列表的指针，从开头开始；a_i, b_j 由 i, j 指向的元素；count 反转次数，初始为 0

while A,B != empty 将 min(a_i,b_j) 附加到 C if b_j < a_i count += A j++ else i++ 中剩余的元素数；现在一个列表是空的，将列表的其余部分附加到 C 返回计数，C

使用merge-and-count，我们可以设计计数反转算法如下：

sort-and-count(L) 如果 L 有一个元素返回 0 否则将 L 分成 A, B (rA, A) = sort-and-count(A) (rB, B) = sort-and-count(B) (r, L) = 合并计数(A,B) 返回 r = rA+rB+r, L

T(n) = O(n lg n)

# vb.net - Vb.net 期刊程序问题

> ID：11421173
> 
> 赞同：1
> 
> 时间：2012-07-10T20:12:30.630
> 
> 标签：vb.net, arrays, data-structures, streamreader, streamwriter

好的，所以对于实习项目，我正在与 streamwriters 和 streamreaders 一起制作日记。

我必须到哪里可以创建一个具有名称、用户名和密码的帐户。当您创建帐户时，我还拥有它以该人的姓名创建一个 txt 文件的位置。现在，他们登录并将他们带到日记页面。日记页面大部分都有日记条目的日期、日记的标题和日记条目文本本身。

我遇到的问题是，当您单击按钮创建/编辑日记帐分录时，它会通过一个子例程检查该日记帐是否存在（意味着该日期已经有一个）。如果它不存在，那么它应该在文本文件的底部创建一个新的。如果它确实存在，那么它应该编辑该日志驻留在文本文件中的行。

代码：

```
Private Sub CreateBtn_Click(sender As System.Object, e As System.EventArgs) Handles CreateBtn.Click

    Errors = ""

    Dim TempCounter As Integer = 0

    If TitleTxt.Text = "" Then

        Errors = "You must enter a title." & vbCrLf

    End If

    If JournalTextRtxt.Text = "" Then

        Errors &= "You must enter an entry for the journal."

    End If

    If Errors <> "" Then

        MessageBox.Show("There's an error in creating/editing your journal." & vbCrLf & "Error(s):" & vbCrLf & Errors, "Error", MessageBoxButtons.OK, MessageBoxIcon.Error)

    Else

        JournalDate = DateTimePicker1.Value
        JournalTitle = TitleTxt.Text
        JournalText = JournalTextRtxt.Text

        arrJournalEntries(TempCounter).TheDate = JournalDate
        arrJournalEntries(TempCounter).Title = JournalTitle
        arrJournalEntries(TempCounter).JournalEntry = JournalText

        CheckAndWrite()

    End If

End Sub

Private Sub CheckAndWrite()

    Dim Reader As New StreamReader(MyName & ".txt", False)
    Dim Sline As String = Reader.ReadLine

    Counter = 0

    Do Until (Sline Is Nothing) 'Perform the code until the line in the text file is blank

        If Not Sline Is Nothing Then 'If the line in the text file is NOT blank then

            For i As Integer = 1 To 3

                Select Case i

                    Case 1

                        arrJournalEntries(Counter).TheDate = Sline
                        Sline = Reader.ReadLine

                    Case 2

                        arrJournalEntries(Counter).Title = Sline
                        Sline = Reader.ReadLine

                    Case 3

                        arrJournalEntries(Counter).JournalEntry = Sline
                        Sline = Reader.ReadLine

                End Select

            Next
        End If

        JournalDate = arrJournalEntries(Counter).TheDate

        Time = DateTimePicker1.Value

        MsgBox("Journal Date = " & JournalDate & vbCrLf & "Today's Date = " & Time)

        If Time = JournalDate Then

            JournalFound = True

        Else

            Counter += 1

            JournalFound = False

        End If

    Loop

    Reader.Close()

    Try

        If Sline Is Nothing Or JournalFound = False Then

            MsgBox("Your journal is now going to be created.")

            JournalDate = DateTimePicker1.Value
            JournalTitle = TitleTxt.Text
            JournalText = JournalTextRtxt.Text

            arrJournalEntries(Counter).TheDate = JournalDate
            arrJournalEntries(Counter).Title = JournalTitle
            arrJournalEntries(Counter).JournalEntry = JournalText

            Dim Writer As New StreamWriter(MyName & ".txt", True)

            Do Until (arrJournalEntries(Counter).TheDate = Nothing)

                Writer.WriteLine(arrJournalEntries(Counter).TheDate)
                Writer.WriteLine(arrJournalEntries(Counter).Title)
                Writer.WriteLine(arrJournalEntries(Counter).JournalEntry)

                Counter += 1

            Loop

            Writer.Close()

        End If

        If JournalFound = True Then

            MsgBox("Your journal is now going to be edited.")

            JournalDate = DateTimePicker1.Value
            JournalTitle = TitleTxt.Text
            JournalText = JournalTextRtxt.Text

            arrJournalEntries(Counter).TheDate = JournalDate
            arrJournalEntries(Counter).Title = JournalTitle
            arrJournalEntries(Counter).JournalEntry = JournalText

            Dim Writer As New StreamWriter(MyName & ".txt", True)

            Do Until (arrJournalEntries(Counter).TheDate = Nothing)

                Writer.WriteLine(arrJournalEntries(Counter).TheDate)
                Writer.WriteLine(arrJournalEntries(Counter).Title)
                Writer.WriteLine(arrJournalEntries(Counter).JournalEntry)

                Counter += 1

            Loop

            Writer.Close()

        End If

    Catch ex As Exception

        MessageBox.Show("An error has occured" & vbCrLf & vbCrLf & "Original Error:" & vbCrLf & ex.ToString)

    End Try

End Sub` 
```

正在发生的问题是它不仅在第一次写错了。当它应该说它要编辑时，它没有，它只是说创造。但它只是添加到文件中。按下按钮 3 次后显示当前日期。标题为“测试标题”，日记条目文本为“测试文本”。这就是发生的事情。

![日记帐分录不正确](../Images/ef7f7d6399f0d4b599c5caa41392a906.png)

它应该只是

2012 年 7 月 10 日下午 3:52:08

测试标题

测试文本

2012 年 7 月 10 日下午 3:52:08

测试标题

测试文本

整个过程。但当然，如果它是相同的日期，那么它只会覆盖它。那么有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T20:37:34.793

您只是按日期过滤数组，因此看起来您有一个带有日期但没有标题或文本的对象：

```
Do Until (arrJournalEntries(Counter).TheDate = Nothing) 
```

“快速”修复：

```
Do Until (arrJournalEntries(Counter).TheDate = Nothing)
  If arrJournalEntries(Counter).Title <> String.Empty Then
    Writer.WriteLine(arrJournalEntries(Counter).TheDate)
    Writer.WriteLine(arrJournalEntries(Counter).Title)
    Writer.WriteLine(arrJournalEntries(Counter).JournalEntry)
  End If
  Counter += 1
Loop 
```

请考虑摆脱数组并改用 a `List(of JournalEntry)`。您的代码在当前状态下看起来很难维护。

# selenium - 使用 Cucumber 跨所有浏览器的 JS 错误检测

> ID：11421174
> 
> 赞同：1
> 
> 时间：2012-07-10T20:12:31.037
> 
> 标签：selenium, cucumber, automated-tests, capybara

`JSErrorCollector is`很酷，但只能与**FireFox**一起使用。
任何人都知道如何**使用任何浏览器**`js`检测我网站上的错误？

# matlab - MATLAB - 需要将矩阵拆分为名称来自另一个矩阵的列变量吗？

> ID：11421176
> 
> 赞同：0
> 
> 时间：2012-07-10T20:12:33.110
> 
> 标签：matlab

我是 Matlab 新手，遇到了一些麻烦。

我有两个通过导入数据获得的矩阵，它们是“标签”（文本的单元格矩阵）和“数据”（双精度矩阵？）。我需要能够创建与每一列相关的变量，以允许它们被单独绘制并用于计算。这些变量应该使用标签矩阵中的文本自动命名。我不能使用 textread，因为这些 matices 的大小取决于源数据

下面是我的问题的一个例子

数据 =

```
 1  2  3  4

    5  6  7  8

    9 10 11 12 
```

标签 = ABCD

我需要一些代码来使 Matlab 自动创建变量，如下所示

A =
1

5

9

乙 =

2

6

10

等等

我尝试使用“eval”来评估我的标签矩阵，然后使用“=”来分配列，但我收到一条错误消息，因为我的数据矩阵是“双精度”矩阵而不是“单元格”矩阵。

谢谢你的尽心帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-10T20:44:41.503

我推荐[动态字段名称](http://blogs.mathworks.com/loren/2005/12/13/use-dynamic-field-references/)：

```
Data= [1 2 3 4;
       5 6 7 8; 
       9 10 11 12];
Label={'A','B','C','D'};

for iter=1:length(Label)
    DataStruct.(Label{iter})=Data(:,iter);
                ___________<--- field name created automatically
end

>> DataStruct

DataStruct = 

    A: [3x1 double]
    B: [3x1 double]
    C: [3x1 double]
    D: [3x1 double]

>> DataStruct.A

ans =

     1
     5
     9 
```

这种方法的优点是它将来自电子表格或其他来源的所有数据保存在一起（在概念单元中），并且如果列的名称恰好已经作为变量存在，则不会意外覆盖工作区中的变量（或者更糟糕的是，可能是一个函数......）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T14:36:51.440

我同意这是一项棘手的任务......这是解决方案

```
 Data=[1 2 3 4; 5 6 7 8; 9 10 11 12]; % A matrix
label=['A', 'B', 'C', 'D']; % its a cell array
for i=1:numel(label)
    v=genvarname(label(i)); %  Generating the variable names
    eval([v ' = Data(i,:)']); % Assinging values into named variables 
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-28T12:01:46.513

Hasan 的代码运行良好，但“label”必须是元胞数组而不是向量，因此您必须编写 label={'A', 'B', 'C', 'D'} 和 label{i}。如果您想要 4 列，请写入 Data(:,i)。

```
Data=[1 2 3 4; 5 6 7 8; 9 10 11 12]; % A matrix
label={'A', 'B', 'C', 'D'}; % its a cell array
for i=1:numel(label)
    v=genvarname(label{i}); %  Generating the variable names
    eval([v ' = Data(:,i)']); % Assinging values into named variables 
end 
```

# python - 如何在 matplotlib 的轴上添加单词？

> ID：11421177
> 
> 赞同：0
> 
> 时间：2012-07-10T20:12:33.563
> 
> 标签：python, matplotlib

我在 matplotlib 中创建了一个颜色图。我不确定如何编辑轴值，以便它们显示单词而不是数字。我在颜色图上绘制了包含抑制剂的网络中物种状态的变化，因此我希望抑制剂名称位于 y 轴上，然后是观察到的物种的名称位于 x 轴上。例如，如果我引入抑制剂 z，并观察物种 A、B、C 和 D 的状态，那么我希望 z 在 y 轴上，A、B、C 和 D 在 x 轴上。我不想要记号或任何东西，只想要单词。

# android - xhdpi 是迄今为止最大的密度，对吧？

> ID：11421181
> 
> 赞同：2
> 
> 时间：2012-07-10T20:12:53.860
> 
> 标签：android

没有像“xxhdpi”这样的密度，对吧？（我当然知道有“xhdpi”）。我有一个合作伙伴要求提供这种密度的资产，但我找不到任何相关文件。我是否以某种方式错过了这个？是否有所有已知密度名称的完整列表？我在这里看不到任何东西，xhdpi 是提到的最大的：

[http://developer.android.com/guide/practices/screens_support.html](http://developer.android.com/guide/practices/screens_support.html)

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-02T07:10:14.883

API 16（果冻豆）中有 xxhdpi。您可以在最新版本的 ADT 中找到它。

似乎xxhdpi的dpi范围应该在400dpi-500dpi之间（我猜是这样），证据之一是HTC J Butterfly（或HTC DLX）使用xxhdpi，屏幕为441dpi。

在某些情况下，较低 dpi 的设备可能会使用较高 dpi 的资源来以更大的尺寸显示内容。例如，xhdpi Nexus 10 使用 xxhdpi 启动器图标。

参考：

G+官方显示xxhdpi为480dpi：

[https://plus.google.com/118292708268361843293/posts/ePQya3KsTjW](https://plus.google.com/118292708268361843293/posts/ePQya3KsTjW)

ADT 显示 xxhdpi 支持：

![带有 xxhdpi 的新布局](../Images/2ad67d718c01e554c8cde554b0e1e0ea.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-10T20:14:55.327

截至 ICS`xhdpi`是支持的最高密度。您当然可以命名一个文件夹`layout-xxhdpi`并将其放在您的资源目录中，但我认为 android 不知道如何处理它。

（注：我不知道这对果冻豆是否正确）

**编辑：** 从 Jens 的评论中，我看到[XXHIGH](http://developer.android.com/reference/android/util/DisplayMetrics.html#DENSITY_XXHIGH)密度有常数（在果冻豆中添加）。但是，它表示应用程序可能不需要担心这一点，因为 XHIGH 图形可以按比例放大。我仍然看不到任何有关`layout-xxhdpi`文件夹之类的信息，但也许这些文档页面还没有更新。

# javascript - 提交/验证 Jquery

> ID：11421184
> 
> 赞同：3
> 
> 时间：2012-07-10T20:12:58.367
> 
> 标签：javascript, jquery, html, css

我试图在单击提交时验证表单。有许多需要验证的输入都分配了 .ipv4val 类。我遇到的问题是我似乎无法将“坏”类添加到验证失败的单个输入元素中？

```
$("form").submit(function() {
    var REGEX = /^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}$/;  
    if (REGEX.test($(".ipv4val").val())) {
      return true;
    }
else {
      $(this).addClass("bad");
  return false;
   } 
```

有任何想法吗 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-10T20:15:12.713

注意您的使用：`$(this).addClass("bad")`

`$(this)`是`form`执行时的元素。尝试使用输入的元素 ID。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-10T20:27:46.417

您是否考虑过[jquery.validate 插件](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)，而不是滚动您自己的验证？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-10T20:17:44.683

试试这种方式：

```
$("form").submit(function() {
    var REGEX = /^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}$/;
    var ok=true;
    $(".ipv4val").each(function(){
        if (!REGEX.test($(this).val())) {
            $(this).addClass("bad");
            ok = false;
        }
    });
    return ok;
}; 
```

# xml - ActionScript3：如何搜索 XML 列表？

> ID：11421186
> 
> 赞同：0
> 
> 时间：2012-07-10T20:13:08.350
> 
> 标签：xml, actionscript-3

我有以下 XML 变量：

```
public var Country:XML=new XML(
    <countries>
         <country code="US" iso="840" label="United States" />
         <country code="CA" iso="124" label="Canada" />
         <country code="GB" iso="826" label="United Kingdom" />
         ...
    </countries>); 
```

我将如何遍历列表以找到与存储在 String 变量中的值相对应的索引号`myCountry`？例如，如果

```
var myCountry:String = "Canada"; 
```

如何创建一个返回索引值为 1 的循环，这意味着加拿大是 XML 列表中的第二个元素？

或者，如果可以以其他方式返回 1 的索引值，则可能不需要循环。我试过：

```
var desiredIndex:int = Country.country.(@label==myCountry) 
```

但它给出了错误`No such variable: @label`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T20:43:09.520

这样的事情应该做你想做的事：

```
var index:int = 0;
for each (var country:XML in Country.country)
{
    if (country.@label == myCountry)
        break;

    index++;
} 
```

（`Country`变量应该被命名`countries`或类似的东西......通常大写的名称仅用于类）

我希望这有帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T14:11:46.053

您的句子返回一个 XMLList，而不是一个 int 变量。

childIndex 方法返回 XML 树中节点的索引：

var desiredIndex:int = Country.country.(@label.toString() == myCountry).childIndex();

# jquery-plugins - 怪癖模式兼容灯箱？（IE）

> ID：11421196
> 
> 赞同：1
> 
> 时间：2012-07-10T20:13:39.033
> 
> 标签：jquery-plugins, internet-explorer-8, lightbox, colorbox, quirks-mode

我正在尝试将灯箱添加到较旧的网站。此站点仅在 IE 8 中打开 quirks 模式才能正确显示。鉴于此限制，是否有任何灯箱插件可以正常运行？是否有*不*支持怪癖模式的插件的解决方法？

我试过 ColorBox 没有成功（[ColorBox FAQ](http://www.jacklmoore.com/colorbox/faq#faq-doctype)明确指出不支持怪癖模式）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-10T20:38:33.783

今天几乎*没有任何东西*可以与 Quirks 模式一起正常工作。

Quirks 模式在 2001 年已经过时——它基本上是一种 IE5 兼容模式。如果您的代码仍在使用它，那么它就有一个严重的问题。到目前为止，最好的答案是升级您的网站，不再使用怪癖模式。

好消息是这实际上并不难，如果你只需要支持 IE8 及以上版本，因为 IE8 支持一个名为[`box-sizing`](https://developer.mozilla.org/En/CSS/Box-sizing). （这在 IE6 或 IE7 中不起作用，这就是怪癖模式徘徊这么久的原因，但在 IE8 中很好）

`box-sizing`是适用于所有浏览器的标准 CSS 功能，并允许您指定盒子模型以像 quirks 模式一样工作。

盒子模型是 quirks 模式和标准模式的主要区别，因此为了使为 quirks 模式编写的站点在所有浏览器中都可以工作，只需设置`box-sizing`整个站点：以下代码应该这样做：

```
* {
   -moz-box-sizing:    border-box;
   -webkit-box-sizing: border-box;
   -ms-box-sizing:     border-box;
    box-sizing:        border-box;
} 
```

然后，您可以添加 doctype 并将站点置于标准模式，它应该会像以前一样继续工作。

完成此操作后，您应该能够开始使用一些现代浏览器功能和最新的脚本库，就像您所询问的那样。

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T13:27:22.567

看起来像 slimbox 支持 quirks 模式，但我自己没有尝试过。[http://www.digitalia.be/software/slimbox2](http://www.digitalia.be/software/slimbox2)

# c# - 类型安全的 Equals()

> ID：11421197
> 
> 赞同：8
> 
> 时间：2012-07-10T20:13:39.360
> 
> 标签：c#, equals, type-safety

由于我的（单元）测试覆盖率仍然很低，不幸的是，我不得不以艰难的方式找到很多错误。因此，在重构期间，我严重依赖 C# 编译器的类型检查。

今天，我修复了重构过程中引入的一个错误，因为缺少`x.Equals(aThingWrappingOriginalThing)`. 事实上`bool Equals(object T)`，编译器没有抱怨。然而，90% 的时间我`Equals()`直接使用（而不是通过 BCL），我打算在逻辑上比较相同类型的对象。

现在我想知道为什么我从未见过有人`Equals()`为这种情况（在 C# 中）推广类型安全的版本。对此有最佳做法吗？

我很想对这些比较使用扩展方法，如下所示：

```
public static bool SafeEquals<T>(this T a, T b)
{
    if (a == null) return b == null;
    return a.Equals(b);
}
public static bool SafeEquals<X>(this IEquatable<X> a, IEquatable<X> b)
{
    if (a == null) return b == null;
    return a.Equals(b);
} 
```

这些可以优化吗？

这是我找到的关于该主题的唯一一篇博客文章，适用于 java： [http ://rickyclarkson.blogspot.com/2006/12/making-equalsobject-type-safe.html](http://rickyclarkson.blogspot.com/2006/12/making-equalsobject-type-safe.html)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-10T20:23:15.357

You are looking for

```
EqualityComparer<T>.Default.Equals(x,y); 
```

this supports `IEquatable<T>` (if implemented), else uses the potentially-boxing `Equals(object)`; it supports classes and structs, with expected null-behaviour for both, including support for `Nullable<T>` (without boxing).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-10T20:18:27.883

我所看到的对我来说看起来不错。

我的 2 美分：我认为跳过空检查会更简单，并使用它：

```
public static bool SafeEquals<T>(this T a, T b)
{
    return object.Equals(a, b);
} 
```

在极少数情况下会偏离预期行为。其中之一是`Equals`当两个对象都是同一个对象时返回 false （无论如何都不应该发生）。

作为参考，这里是反编译的`object.Equals`，所以你可以自己看看会发生什么。

```
public static bool Equals(object objA, object objB)
{
    return ((objA == objB) || (((objA != null) && (objB != null)) && objA.Equals(objB)));
} 
```

# python - 使用 BigInts 创建位掩码

> ID：11421199
> 
> 赞同：4
> 
> 时间：2012-07-10T20:13:42.173
> 
> 标签：python, bitmask

是否有更有效的方法来执行以下计算？它工作得很好，但有些东西告诉我`x &= (1 << 8) - 1 ^ 1 << 3`可以写来避免一些计算并提高速度。

```
def unset_mask(width, index):
    return (1 << width) - 1 ^ 1 << index

x = 0b11111111
x &= unset_mask(8, 3)
assert x == 0b11110111 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-10T20:40:43.033

实际上，您不需要声明`width`. 当你这样做时，Bigints 的行为是正确的：

```
>>> bin(255 & ~(1 << 3))
'0b11110111'
>>> bin(65535 & ~(1 << 3))
'0b1111111111110111'
>>> bin(75557863725914323419135 & ~(1 << 3))
'0b1111111111111111111111111111111111111111111111111111111111111111111111110111' 
```

这是因为负数[前面有一个“无限”字符串](http://wiki.python.org/moin/BitwiseOperators)。因此，当您对一个正数（以“无限”零字符串开头）进行补码时，您会得到一个负数（`-(x + 1)`准确地说）。只是不要相信`bin`负数的表示；它不反映内存中的实际位。

所以你会像这样重写`unset_mask`：

```
def unset_mask(index):
    return ~(1 << index)

x = 0b11111111
x &= unset_mask(3)
print x == 0b11110111  # prints True 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-10T20:38:53.627

这将取消设置位：

```
x ^= 1 << 3 & x 
```

在一个函数中：

```
def unset_bit(x, n):
    return 1 << n & x ^ x 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-10T20:50:07.087

您可以使用它来清除以下内容`x`：

```
x &= ~(1 << index) 
```

# c# - 在 Linq to Sql 中如何获取实体的所有外键字段

> ID：11421200
> 
> 赞同：2
> 
> 时间：2012-07-10T20:13:42.643
> 
> 标签：c#, linq-to-sql, foreign-keys

我想在我的实体的表中获取所有外键列。例如：

```
class User
{
    Id {get;set;}
    Name {get;set;}
    ColumnWithForeignKey1Id{get;set;}
    ColumnWithForeignKey2Id{get;set;}        
    ColumnWithForeignKey3Id{get;set;}
} 
```

结果应该是这样的：

*   ColumnWithForeignKey1Id
*   ColumnWithForeignKey2Id
*   ColumnWithForeignKey3Id

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T20:26:49.890

在 xml 编辑器中打开 dbml 文件，您将看到外键：

```
 <Association Name="Table1_Table2" Member="Table1" ThisKey="Table2ID" OtherKey="ID" Type="Table2" IsForeignKey="true" /> 
```

打开 Designer.cs 文件，您将看到外键实现为具有 a 的属性，该属性`System.Data.Linq.Mapping.AssociationAttribute`由 a`EntityRef`或`EntitySet`.

如果您使用反射，请查找`AssociationAttribute`.

* * *

如果您不使用设计器来生成建模类，请使用您自己的属性装饰这些属性，以便您可以找到它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T15:06:17.353

这是一个示例，用于收集使用特殊属性定义的 ForeignKeys；对于这个问题“AssociationAttribute”和给定的类，对于这个例子“ClassName”。

感谢您`David B`的指导。

```
public void Get<TAttribute>(object obj, bool inherit) where TAttribute : System.Attribute
{
     var ForeignKeyCollection = typeof(ClassName).GetProperties(BindingFlags.Instance | BindingFlags.Public)
                .Where(p => p.GetCustomAttributes(typeof(TAttribute), true).Any())
                .Select(p => new
                                 {
                                     Property = p,
                                     Attribute = (AssociationAttribute)Attribute.GetCustomAttribute(p, typeof(TAttribute), true)
                                 })
                .Where(p => p.Attribute.IsForeignKey).ToList();
} 
```

# c++ - c++中向量的使用

> ID：11421202
> 
> 赞同：-4
> 
> 时间：2012-07-10T20:13:51.020
> 
> 标签：c++, vector

我们什么时候应该使用向量，什么时候应该使用普通数组。同样在我的一个代码中，我发现了一个奇怪的问题。

```
 class TwoTrains   
   {  
          public:  
          int pass(int t1, int t2, vector <int>);  
   };

int TwoTrains::pass(int t1, int t2, vector <int> times)  
     {  
         int size_of_array=(int)times.size();  
         for(int i=0;i<size_of_array;i++)  
         {  
              cout<<times[i]<<endl;  
         }  
         return 0;  
     } 
```

这个编译但是当我使用它时它给出了一个错误。为什么 -

```
 for(int i=0; i< times.size();i++) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-10T20:17:41.007

`vector`是你想要的。为纯 C 用户提供数组。

```
for(int i=0; i< times.size();i++) 
```

不给出错误，但给出警告（与 比较`signed`）`unsigned`。利用

```
for(size_t i=0; i< times.size();i++) 
```

或者

```
for(int i=0; i<(int) times.size();i++) 
```

由于您不需要索引，请使用迭代器，如[0A0D](https://stackoverflow.com/users/195488/0a0d)通知：

```
for(vector<int>::iterator it = times.begin(); it!=times.end();++it){
    cout<<*it;
} 
```

甚至

```
for(int t: times){
    cout<<t;
} 
```

使用 C++11

# api - Twitter API - 从单个用户中提取主题标签

> ID：11421203
> 
> 赞同：0
> 
> 时间：2012-07-10T20:13:54.703
> 
> 标签：api, twitter, hashtag

我正在尝试从单个推特中提取所有包含#multitouch 的推文。（不只是从一个人那里拉出曾经使用#multitouch 发推文的每个人）

我现在的代码[只是通过标签拉出]： $(document).ready(function () {

```
$.getJSON('http://search.twitter.com/search.json?q=%23multitouch:&screen_name=25KDIGITAL:&callback=?', function (json) { 
             for(i = 0; i < 3; i++)
             {
                $("#TweetBar").append("<li>" + json.results[i].text + "</li>", "<p>" + json.results[i].from_user + "</p>");
             }

             //$("#TweetBar").show(2500, 'linear');
         });

     }); 
```

这是可能吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T20:17:12.353

当然，只要确保您使用正确的 URL 来提取数据

[http://search.twitter.com/search.json?q=%23multitouch%20from:25KDIGITAL](http://search.twitter.com/search.json?q=%23multitouch%20from:25KDIGITAL)
（查询：“#multitouch from:25KDIGITAL”）

# ruby - eventmachine 多个套接字

> ID：11421207
> 
> 赞同：1
> 
> 时间：2012-07-10T20:14:17.033
> 
> 标签：ruby, process, eventmachine, reactor

在反应器循环内启动多个侦听套接字“服务器”时 - 假设在一个侦听套接字回调中发生阻塞导致其他套接字停止接受新连接是否安全，因为反应堆循环将被阻塞？

那么最好的做法是为每个侦听套接字启动一个单独的 ruby​​ 进程，还是有其他方法可以更好地处理这个用例？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T02:04:37.433

套接字仍将接受连接，但如果任何单个服务器阻塞并且不会将任何数据传递给其他服务器，则反应器将被阻塞。产生一个新进程并不是一个坏主意。避免在回调中阻塞操作甚至是一个更好的主意。

# methods - Ada 参考手册中的方法调用样式子程序调用

> ID：11421209
> 
> 赞同：2
> 
> 时间：2012-07-10T20:14:36.247
> 
> 标签：methods, ada

我知道 Ada 中有一个方法调用风格的子程序调用，但是，我在参考手册中找不到任何内容。

有人可以指点我到相应的部分吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-10T20:43:05.383

通过“方法调用样式子程序调用”，我假设您的意思是“object.method(parameters)”调用样式。

这在子程序调用部分中没有解决，人们可能已经想到了，而是在[4.1.3，选定组件](http://www.adaic.org/resources/add_content/standards/05rm/html/RM-4-1-3.html)，第 9.1/2 和 9.2/2 段中解决。报价：

*   selected_component ::= 前缀。选择器名称
*   选择器名称 ::= 标识符 | 字面量 | operator_symbol

前缀（在任何隐式取消引用之后）应解析为表示特定标记类型 T 或类范围类型 T'Class 的对象或值。selector_name 应解析为在声明类型 T 的祖先的声明区域内立即声明的子程序的视图。

# zend-framework - Zend 框架：数据库查找抛出“主键的列太少”异常

> ID：11421212
> 
> 赞同：1
> 
> 时间：2012-07-10T20:14:51.567
> 
> 标签：zend-framework

我正在尝试使用该`find`函数通过 id 查询数据库表。该表有 4 个主键（3 个外键）。
这是表数据网关的代码：

```
class Application_Model_DbTable_Assigneduser extends Zend_Db_Table_Abstract
{  
    protected $_name = 'assigneduser';  
} 
```

这是映射器的代码：

```
public function find($id)
{
    $result = $this->getDbTable()->find($id);
    if(count($result) == 0)
        return;
    $row=$result->current();
    $assignedUser = new Application_Model_AssignedUser();
    $assignedUser->setId($row->id)
        ->setIdProject($row->id_project)
        ->setIdUser($row->id_user)
            ->setIdTask($row->id_task);
} 
```

我用来实例化映射器的代码以及我使用该方法的位置`find`：

```
public function indexAction()
{
        echo "<xmp>";
        $user=new Application_Model_AssignedUserMapper();
        print_r($user->find(3));
        echo '</xmp>';
} 
```

我使用`print_r`and`xmp`标记很好地查看了代码返回的内容。我得到的异常消息是：

```
Message: Too few columns for the primary key 
```

我不知道该怎么做才能解决它。任何想法？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T08:51:52.667

**好的 find() 将按主键**返回行，如果您需要传递复合主键，则只有主键必须是数组。

这是 find() 的文档块：

```
/**
 * Fetches rows by primary key.  The argument specifies one or more primary
 * key value(s).  To find multiple rows by primary key, the argument must
 * be an array.
 *
 * This method accepts a variable number of arguments.  If the table has a
 * multi-column primary key, the number of arguments must be the same as
 * the number of columns in the primary key.  To find multiple rows in a
 * table with a multi-column primary key, each argument must be an array
 * with the same number of elements.
 *
 * The find() method always returns a Rowset object, even if only one row
 * was found.
 *
 * @param  mixed $key The value(s) of the primary keys.
 * @return Zend_Db_Table_Rowset_Abstract Row(s) matching the criteria.
 * @throws Zend_Db_Table_Exception
 */ 
```

修理：

```
class Application_Model_DbTable_Assigneduser extends Zend_Db_Table_Abstract
{  
    protected $_name = 'assigneduser';
    protected $_primary = array('column','column'...); //This is not strictly required but may help.
} 

public function indexAction()
{
        $user=new Application_Model_AssignedUserMapper();
        Zend_Debug::dump($user->find(array(3,,,)), 'User');//outputs formatted var_dump with optional label as second arg.
} 
```

现在让这变得简单：

```
public function find($id)
{
    $select = $this->getDbTable->select();
    $select->where('id = ?', $id);
    $result = $this->getDbTable()->fetchRow($select);//will return only one row, if you need more use fetchAll()
    if(is_null($result)) //fetchRow() returns NULL if no rows found.
        return;
    $row=$result;
    $assignedUser = new Application_Model_AssignedUser();
    $assignedUser->setId($row->id)
                 ->setIdProject($row->id_project)
                 ->setIdUser($row->id_user)
                  ->setIdTask($row->id_task);
} 
```

使用 fetchRow() 您可以查询行中的任何列，但它只会返回一行。如果您需要返回一个行集，您可以使用具有相同查询选项的 fetchAll()，您将获得一个行集。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-29T04:39:51.333

我只是有同样的问题。在 ZF 版本 1.11.11 上，正如 RockyFord 所说，您只需在 DbTable 类中映射一个作为主键的列数组，如下所示：

```
class AssignedUser extends Zend_Db_Table_Abstract
{
    protected $_name = 'assigned_user';
    protected $_primary = array('user_id','project_id','task_id');
} 
```

但是当你想找到这条记录时，你不能只通过一个主键来查找，甚至不能用它们传递一个数组（这就是我正在做的），find 方法正在等待无限数量的参数作为主键键的值（按照您声明的相同顺序），如下所示：

```
$assignedUserTable = new AssignedUser();
$rowset = $assignedUserTable->find( $userId, $projectId, $taskId );
$row = $rowset->current(); 
```

# cakephp - $this->Auth->login() 创建返回 1 行的正确查询，但 IF 检查失败（服务器特定问题）

> ID：11421213
> 
> 赞同：2
> 
> 时间：2012-07-10T20:14:52.067
> 
> 标签：cakephp, authentication, cakephp-2.2

我们有一个网站，我们正在移动到新服务器。在旧服务器上一切正常。这只是一个网站的开始，所以它非常简单。

移动到我们的新服务器时，尝试登录不再有效。但是 - 根据 debugKit，生成的查询`$this->Auth->login()`：

```
SELECT `User`.`id`, `User`.`name`, `User`.`email`, `User`.`username`, `User`.`password`, `User`.`role`, `User`.`created`, `User`.`modified` 
FROM `shopping_main`.`users` AS `User` 
WHERE `User`.`username` = 'another' 
AND `User`.`password` = '3813dd3a5eeb39c857d56f9ae58ec7f8237e5eb3' 
LIMIT 1 
```

正在返回 1 行 - 但如果块失败：

```
if ($this->Auth->login()) {
    $this->Session->setFlash(__('You are now logged in.'));
} else {
    $this->Session->setFlash(__('Invalid username or password, try again'));
} 
```

PDO 安装在两者上（相同版本） - 不确定这是否重要，但在此之前我们遇到过奇怪的问题。

全新安装 CakePHP 2.2 stable 时，一切都亮起绿色（数据库连接、modrewrite...等）

我会认为我们的数据或代码......等等有问题，但是 - 它是相同的数据，相同的代码，并且通过它确实返回 1 行这一事实得到验证。

`$components`下面是我在 AppController 中的最新数组：

```
public $components = array(
    'DebugKit.Toolbar',
    'Session',
    'Cookie',
    'Auth' => array(
        'loginRedirect' => array('controller' => 'dashboard', 'action' => 'index', 'admin'=>true),
        'logoutRedirect' => array('controller' => 'users', 'action' => 'login', 'admin'=>true)
    )
); 
```

* * *

**更新：**

根据我们的服务器人员的说法，我们遇到问题的服务器是唯一一个安装了 PECL 的服务器 - 当他删除它时，登录工作正常。（我们在服务器上需要它来处理其他事情 - 为什么/什么会导致我们的登录无法正常工作？）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T14:42:27.580

**原始海报（我）的回答：**

据我们的服务员说，“加载PDO有两种方式。第一种是使用easyapache安装PDO php扩展。第二种是通过PECL安装PDO。看起来问题模块不同。”

显然，这台服务器上有 PECL，而不是普通的 easyapache PDO。当他删除它并使用easyapache PDO重新启动/重置它时，一切都很好。

所以 - 听起来像 CakePHP 需要“正常”的 PDO。

谜团已揭开。

* * *

如果您有 PECL，则可以使用此解决方法：

1.  在您的数据源文件夹中创建一个文件“HpMysql.php”并添加此代码/类：[https ://github.com/lorenzo/HipHop/blob/master/Model/Datasource/Database/HpMysql.php](https://github.com/lorenzo/HipHop/blob/master/Model/Datasource/Database/HpMysql.php)

2.  将你的 database.php 'datasource' 更改为 'HpMysql'

# asp.net-mvc-3 - 中等信任、ninject 和实体框架的安全异常

> ID：11421214
> 
> 赞同：-1
> 
> 时间：2012-07-10T20:14:52.040
> 
> 标签：asp.net-mvc-3, ninject-2, medium-trust

每当我尝试以中等信任度运行我的项目时，我都会收到此异常。该项目是 MVC 论坛，尽管我不需要以中等信任度运行我自己的任何网站，但我认为我最好让它在中等信任度环境中运行。

我正在为 DI 使用 Ninject（在中等信任下工作的 DLL），并且可以正常工作 - MVC 控制器按预期加载了构造函数注入。

“有趣”的事情是失败的方法（在我的代码中）采用 2 个参数，这些都是使用实体框架从数据库中加载的，所以我不知道为什么会失败，当实体框架显然已经在其他部分工作时的代码。

这个异常背后的原因是什么？这就像大海捞针一样。

这是堆栈跟踪：

```
[SecurityException: Request for the permission of type 'System.Security.Permissions.ReflectionPermission, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' failed.]
   System.Security.CodeAccessSecurityEngine.Check(Object demand, StackCrawlMark& stackMark, Boolean isPermSet) +0
   System.Security.CodeAccessSecurityEngine.Check(CodeAccessPermission cap, StackCrawlMark& stackMark) +31
   System.Security.CodeAccessPermission.Demand() +46
   System.Data.Common.Internal.Materialization.Translator.DemandMemberAccess() +50
   System.Data.Common.Internal.Materialization.Shaper`1..ctor(DbDataReader reader, ObjectContext context, MetadataWorkspace workspace, MergeOption mergeOption, Int32 stateCount, CoordinatorFactory`1 rootCoordinatorFactory, Action checkPermissions, Boolean readerOwned) +165
   System.Data.Common.Internal.Materialization.ShaperFactory`1.Create(DbDataReader reader, ObjectContext context, MetadataWorkspace workspace, MergeOption mergeOption, Boolean readerOwned) +93
   System.Data.Objects.Internal.ObjectQueryExecutionPlan.Execute(ObjectContext context, ObjectParameterCollection parameterValues) +736
   System.Data.Objects.ObjectQuery`1.GetResults(Nullable`1 forMergeOption) +149
   System.Data.Objects.ObjectQuery`1.System.Collections.Generic.IEnumerable<T>.GetEnumerator() +44
   System.Linq.Enumerable.FirstOrDefault(IEnumerable`1 source) +182
   System.Data.Objects.ELinq.ObjectQueryProvider.<GetElementFunction>b__1(IEnumerable`1 sequence) +41
   System.Data.Objects.ELinq.ObjectQueryProvider.ExecuteSingle(IEnumerable`1 query, Expression queryRoot) +59
   System.Data.Objects.ELinq.ObjectQueryProvider.System.Linq.IQueryProvider.Execute(Expression expression) +150
   System.Data.Entity.Internal.Linq.DbQueryProvider.Execute(Expression expression) +102
   System.Linq.Queryable.FirstOrDefault(IQueryable`1 source) +265
   ApplicationBoilerplate.DataProvider.EntityFramework.Repository`1.ReadOne(ISpecification`1 spec) +217
   mvcForum.Web.Extensions.ForumExtensions.GetAccess(Forum forum, Group group) +129
   mvcForum.Web.Extensions.ForumExtensions.GetAccess(Forum forum) +895
   mvcForum.Web.ViewModels.ForumViewModel..ctor(Forum forum, Int32 topicsPerPage) +1353
   mvcForum.Web.Areas.Forum.Controllers.HomeController.Index() +1260
   lambda_method(Closure , ControllerBase , Object[] ) +74
   System.Web.Mvc.ActionMethodDispatcher.Execute(ControllerBase controller, Object[] parameters) +17
   System.Web.Mvc.ReflectedActionDescriptor.Execute(ControllerContext controllerContext, IDictionary`2 parameters) +208
   System.Web.Mvc.ControllerActionInvoker.InvokeActionMethod(ControllerContext controllerContext, ActionDescriptor actionDescriptor, IDictionary`2 parameters) +27
   System.Web.Mvc.<>c__DisplayClass15.<InvokeActionMethodWithFilters>b__12() +55
   System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodFilter(IActionFilter filter, ActionExecutingContext preContext, Func`1 continuation) +263
   System.Web.Mvc.<>c__DisplayClass17.<InvokeActionMethodWithFilters>b__14() +19
   System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodFilter(IActionFilter filter, ActionExecutingContext preContext, Func`1 continuation) +263
   System.Web.Mvc.<>c__DisplayClass17.<InvokeActionMethodWithFilters>b__14() +19
   System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodFilter(IActionFilter filter, ActionExecutingContext preContext, Func`1 continuation) +263
   System.Web.Mvc.<>c__DisplayClass17.<InvokeActionMethodWithFilters>b__14() +19
   System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodFilter(IActionFilter filter, ActionExecutingContext preContext, Func`1 continuation) +263
   System.Web.Mvc.<>c__DisplayClass17.<InvokeActionMethodWithFilters>b__14() +19
   System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodWithFilters(ControllerContext controllerContext, IList`1 filters, ActionDescriptor actionDescriptor, IDictionary`2 parameters) +191
   System.Web.Mvc.ControllerActionInvoker.InvokeAction(ControllerContext controllerContext, String actionName) +343
   System.Web.Mvc.Controller.ExecuteCore() +116
   System.Web.Mvc.ControllerBase.Execute(RequestContext requestContext) +97
   System.Web.Mvc.ControllerBase.System.Web.Mvc.IController.Execute(RequestContext requestContext) +10
   System.Web.Mvc.<>c__DisplayClassb.<BeginProcessRequest>b__5() +37
   System.Web.Mvc.Async.<>c__DisplayClass1.<MakeVoidDelegate>b__0() +21
   System.Web.Mvc.Async.<>c__DisplayClass8`1.<BeginSynchronous>b__7(IAsyncResult _) +12
   System.Web.Mvc.Async.WrappedAsyncResult`1.End() +62
   System.Web.Mvc.<>c__DisplayClasse.<EndProcessRequest>b__d() +50
   System.Web.Mvc.SecurityUtil.<GetCallInAppTrustThunk>b__0(Action f) +7
   System.Web.Mvc.SecurityUtil.ProcessInApplicationTrust(Action action) +22
   System.Web.Mvc.MvcHandler.EndProcessRequest(IAsyncResult asyncResult) +60
   System.Web.Mvc.MvcHandler.System.Web.IHttpAsyncHandler.EndProcessRequest(IAsyncResult result) +9
   System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +8970061
   System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +184 
```

小更新，我先使用代码。感谢您的关注！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T19:58:17.190

如果您的实体类包含非公共属性（即它们是内部的、受保护的或私有的），这看起来就像您遇到的异常。EF5 及更低版本仅支持在部分信任环境中运行时映射到公共属性。

# sql - SQL - 查找重复项，然后添加到另一个具有计数的表

> ID：11421215
> 
> 赞同：1
> 
> 时间：2012-07-10T20:14:52.610
> 
> 标签：sql, sql-server, count, duplicates

有大量关于如何查找重复行、删除它们或列出重复行的列表。在我尝试在这里搜索的大量回复中，这些是我找到的唯一回复。我想我会提出我的问题，因为已经一个小时了，但仍然没有运气。

这是我的示例数据

```
Table Name: Customers
_____________________________
ID   | CompanyName
--------------
1    | Joes
2    | Wendys
3    | Kellys
4    | Ricks
5    | Wendys
6    | Kellys
7    | Kellys 
```

我需要能够在此表中找到所有重复项，然后将结果放入另一个表中，其中列出了公司名称是什么，以及找到了多少个重复项。

例如上表我应该有一个新表，上面写着类似

```
Table Name: CustomerTotals
_______________________________
ID   | CompanyName  |   Totals
-------------------------------
1    | Joes         |    1
2    | Wendys       |    2
3    | Kellys       |    3
4    | Ricks        |    1 
```

-----编辑在2个回复后添加，遇到另一个问题------

感谢您的回复！相反的呢？说我只想从 CustomerTotals 表中不存在的客户表中将项目添加到新表“UniqueCustomers”？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-10T20:16:46.373

试试这个 ：

```
INSERT INTO CustomerTotals
(CompanyName, Totals)
SELECT CompanyName, COUNT(*)
FROM Customer
GROUP BY CompanyName 
```

对该字段使用[标识](http://msdn.microsoft.com/en-us/library/ms186775%28v=sql.105%29.aspx)列`ID`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T20:18:28.220

为了得到重复，你可以做

```
Insert into CustomerTotals (Id, CompanyName, Totals)
    Select min(Id), CompanyName, count(*) From Customers
    group by CompanyName 
```

在那里你得到了结果，保留了每个公司名称的最小 id（如果你真的需要原始表中的第一个 id，正如我在结果中看到的那样）。如果没有，您可以使用身份列

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-10T20:21:49.027

如果您只想将重复项插入到第二个表中，请使用：

```
INSERT INTO CustomerTotals
(CompanyName, Totals)
SELECT CompanyName, COUNT(*)
FROM Customer
GROUP BY CompanyName
HAVING Count(*) > 1 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-11T05:08:16.373

上面的例子很好。但是您应该使用`count(1)`而不是`count(*)`来提高性能。阅读[这个](https://stackoverflow.com/questions/1221559/count-vs-count1)问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-04-16T07:04:44.300

我认为下面的脚本是最简单的......

```
SELECT CompanyName, COUNT(*) AS Total
INTO #tempTable
FROM Customer
GROUP BY CompanyName 
HAVING Count(*) > 1 
```

# ios - 在 NSOperationQueue 非主队列上创建 UI 元素会导致奇怪的行为

> ID：11421219
> 
> 赞同：0
> 
> 时间：2012-07-10T20:15:07.740
> 
> 标签：ios, ios5, user-interface, nsoperationqueue

我有一些代码`UIView`通过创建的队列创建和添加子视图`[[NSOperationQueue alloc] init]`，这导致了奇怪的滞后行为。仅在异常长时间延迟后才添加子视图。

但后来我转而使用`[NSOperationQueue mainQueue]`这些部件，响应变得正常。

我只想解释我使用第一种方法看到的滞后行为。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-10T20:43:26.793

来自苹果文档

> **线程和您的用户界面**
> 
> 如果您的应用程序具有图形用户界面，建议您接收与用户相关的事件并从应用程序的主线程启动界面更新。**这种方法有助于避免与处理用户事件和绘制窗口内容相关的同步问题。**一些框架，例如 Cocoa，通常需要这种行为，但即使对于那些不需要这种行为的框架，将这种行为保留在主线程上具有简化管理用户界面的逻辑的优点。有一些值得注意的例外情况是从其他线程执行图形操作是有利的。例如，QuickTime API 包括许多可以从辅助线程执行的操作，包括打开电影文件、渲染电影文件、压缩电影文件以及导入和导出图像。同样，在 Carbon 和 Cocoa 中，您可以使用辅助线程来创建和处理图像并执行其他与图像相关的计算。对这些操作使用辅助线程可以大大提高性能。**但是，如果您不确定特定的图形操作，请计划从主线程执行**

此外，根据[线程编程指南](http://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/Multithreading/Multithreading.pdf)，UI 类不是线程安全的。

**因此，请避免从与主线程不同的线程更新 UI。**

如果您运行`NSOperation`（在队列中），您可以更新您的 UI（例如，在下载了应用程序生命周期所需的一些数据之后）在主线程中执行如下方法：

```
-(void)main {

    // e.g the delegate could be the controller that has the view that you want to update
    if (delegate) {

        NSURL *url = [delegate urlForDownloadOperation:self];
        if ( nil == url ) return;
        self.downloadedImage = [[NSImage alloc] initWithContentsOfURL:url];

        // e.g. rather than invoking processImage directly on the delegate, ensure that the method draw the image on the main thread
        [delegate performSelectorOnMainThread:@selector(processImage:) 
            withObject:self waitUntilDone:YES];
    }
} 
```

或者，您可以向需要更新 UI 的组件发送通知，例如：

```
- (void)main {

   NSURL *url = [delegate urlForDownloadOperation:self];
   if ( nil == url ) return;
   self.downloadedImage = [[NSImage alloc] initWithContentsOfURL:url];

   // e.g. send a notificatio to inform some components that it is ready to update the UI with some content
   [[NSNotificationCenter defaultCenter] postNotificationName:@"importData" object:self];
} 
```

需要更新 UI 的组件将注册该通知，例如

```
- (void)processImage:(NSNotification*)notification
{
    if (![NSThread isMainThread]) {
        [self performSelectorOnMainThread:@selector(processImage:) withObject:notification waitUntilDone:YES];
        return;
    }

    // update the UI here, you are running on the main thread
} 
```

# objective-c - 优化drawRect中的CGContextDrawRadialGradient：

> ID：11421222
> 
> 赞同：4
> 
> 时间：2012-07-10T20:15:17.027
> 
> 标签：objective-c, drawrect

在我的 iPad 应用程序中，我有一个 UITableView，它在每次选择新单元格时分配/初始化一个 UIView 子类。我已`drawRect:`在此 UIView 中重写以绘制径向渐变，它工作正常，但性能受到影响 - 当点击单元格时，UIView 以编程方式绘制渐变需要更长的时间，而不是使用 .png 作为背景。有没有办法“缓存”我的`drawRect:`方法或它生成的梯度以提高性能？我宁愿使用`drawRect:`而不是.png。我的方法如下所示：

```
- (void)drawRect:(CGRect)rect
{
     CGContextRef context = UIGraphicsGetCurrentContext();

     size_t gradLocationsNum = 2;
     CGFloat gradLocations[2] = {0.0f, 1.0f};
     CGFloat gradColors[8] = {0.0f,0.0f,0.0f,0.0f,0.0f,0.0f,0.0f,0.5f}; 
     CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();
     CGGradientRef gradient = CGGradientCreateWithColorComponents(colorSpace, gradColors, gradLocations, gradLocationsNum);
     CGColorSpaceRelease(colorSpace);

     CGPoint gradCenter = CGPointMake(CGRectGetMidX(self.bounds), CGRectGetMidY(self.bounds));
     float gradRadius = MIN(self.bounds.size.width , self.bounds.size.height) ;

     CGContextDrawRadialGradient (context, gradient, gradCenter, 0, gradCenter, gradRadius, kCGGradientDrawsAfterEndLocation);

     CGGradientRelease(gradient);
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T20:56:28.703

您可以将图形渲染到上下文中，然后将其存储为 UIImage。[这个答案](https://stackoverflow.com/questions/10878141/is-it-possible-to-draw-graphics-with-cgcontext-and-save-them-into-a-nsmutablearr)应该让你开始：

> `drawRect:`是一种`UIView`用于绘制视图本身的方法，而不是预先创建图形对象。
> 
> 由于您似乎想要创建形状来存储它们并稍后绘制，因此创建形状`UIImage`并使用`UIImageView`. `UIImage`可以直接存储在`NSArray`.
> 
> 要创建图像，请执行以下操作（在主队列中；不在 drawRect 中：）：
> 
> 1）创建位图上下文
> 
> ```
> UIGraphicsBeginImageContextWithOptions(size, opaque, scale); 
> ```
> 
> 2）获取上下文
> 
> ```
> CGContextRef context = UIGraphicsGetCurrentContext(); 
> ```
> 
> 3）画你需要的任何东西
> 
> 4) 将上下文导出为图像
> 
> ```
> UIImage *image = UIGraphicsGetImageFromCurrentImageContext(); 
> ```
> 
> 5）破坏上下文
> 
> ```
> UIGraphicsEndImageContext(); 
> ```
> 
> 6）存储对图像的引用
> 
> ```
> [yourArray addObject:image]; 
> ```
> 
> 对您要创建的每个形状重复此操作。
> 
> 有关详细信息，请参阅上述功能的[文档。](https://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIKitFunctionReference/Reference/reference.html)为了更好地理解`drawRect:`在程序中任意位置绘制和使用上下文之间的区别，我建议您阅读[Quartz2D 编程指南](https://developer.apple.com/library/ios/#documentation/GraphicsImaging/Conceptual/drawingwithquartz2d/Introduction/Introduction.html)，尤其是图形上下文部分。

# android - 在 Android 运行时更改和应用主题

> ID：11421223
> 
> 赞同：11
> 
> 时间：2012-07-10T20:15:23.237
> 
> 标签：android, themes, android-activity, android-theme

> **可能重复：**
> [如何在 Android 运行时更改当前主题](https://stackoverflow.com/questions/2482848/how-to-change-current-theme-at-runtime-in-android)

我有一个 Android 应用程序，允许用户在运行时在主题之间切换。切换主题很容易，但[在重新创建活动之前不会应用主题。](https://developer.android.com/reference/android/view/ContextThemeWrapper.html#setTheme%28int%29)我找到了一种[将主题应用于当前活动](https://stackoverflow.com/questions/9446193/theme-programmatically-set-how-to-reload-activity-to-apply)的方法，但是如果用户按下后退按钮，以前的屏幕仍然具有旧主题。如何更改这些活动的主题？支持它的应用程序示例：[Tasks Free](https://play.google.com/store/apps/details?id=ch.teamtasks.tasks&hl=en)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-13T07:14:46.597

在运行时动态地，在调用 setContentView() 之前，在活动的 onCreate() 方法中调用 setTheme()。要更改主题，您只需重新启动您的活动。

请看[这个文件..！](http://www.androidengineer.com/2010/06/using-themes-in-android-applications.html)

也想看看[这个](http://www.linuxtopia.org/online_books/android/devguide/guide/topics/ui/themes.html)和[这个](http://www.anddev.org/applying_a_theme_to_your_application-t817.html)......希望这有帮助......！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-12T22:36:01.643

我想只是一个提示：

`finish();`通话前

```
setResult(AnIntegerThatNotifiesThePreviousActivitiesToChangeTheme); 
```

现在在您的所有活动中，实施 onActivityResult

```
protected void onActivityResult(int request, int result, Intent data) {
    if(result == AnIntegerThatNotifiesThePreviousActivitiesToChangeTheme)
    {
        //update the current theme
    }
} 
```

* * *

另一种解决方案（更好）：

实现一个保存主题的类：

```
public class CurrentThemeHolder {
    private CurrentThemeHolder() {
    }
    private static instance;
    public static getInstance() {
        if(instance == null)
            return new CurrentThemeHolder();
        else
            return instance;
    }
    private int mTheme; //identifier of the theme
    public getTheme() {
        return mTheme;
    }
    public setTheme(int newTheme){
        mTheme = newTheme;
    }
} 
```

现在让你所有的活动扩展这个 ThemeActivity：

```
public class ThemeActivity extends Activity {
    private int mTheme;
    protected void onResume() {
        if(mTheme != CurrentThemeHolder.getInstance().getTheme()) {
            //do what you should do to set the theme
            mTheme = CurrentThemeHolder.getInstance().getTheme();
            //everytime you set the theme save it
            //this maybe should be done in onCreate()
        }
    }
} 
```

# bazaar - 强制集市客户端协议使用服务器协议 2？

> ID：11421225
> 
> 赞同：0
> 
> 时间：2012-07-10T20:15:25.597
> 
> 标签：bazaar

我得到了带有 bazaar 2.5.1 的 ubuntu 12.04，并且想要访问 bazaar 1.5 服务器上的存储库。服务器只理解 bazaars 协议版本**2**，但客户端尝试连接版本**3**。如何强制客户端使用协议的第 2 版？

错误信息：

```
Server does not understand Bazaar network protocol 3, reconnecting.  (Upgrade the server to avoid this.) 
```

似乎在几次重新连接集市后自动切换到较低版本（正如 bialix 在他的评论中提到的那样），但之后它只是抱怨分支格式：

```
'error', "Unknown branch format: 'Bazaar Branch Format 7 (needs bzr 1.6) 
```

所以没有什么真正的收获。没有办法告诉新客户表现得像老客户吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T01:09:25.077

存储库格式可能会解决问题。尝试这个 ：

```
bzr init-repo --pack-0.92 myRepo
bzr branch my1.5branch myRepo 
```

# session - Joomla 自定义模块 oop php 不起作用

> ID：11421228
> 
> 赞同：0
> 
> 时间：2012-07-10T20:15:40.833
> 
> 标签：session, joomla, joomla2.5

我正在尝试使用 Joomla 的会话代码让会话变量与 Joomla 一起工作，因为 php 的会话不起作用。我在尝试访问 joomla 自定义代码模块编辑器中的会话变量时遇到了问题。当我尝试使用代码访问会话变量时：

```
define( '_JEXEC', 1 );
define('JPATH_BASE', "../");
define( 'DS', DIRECTORY_SEPARATOR );
require_once ( JPATH_BASE .DS.'includes'.DS.'defines.php' );
require_once ( JPATH_BASE .DS.'includes'.DS.'framework.php' );
require_once ( JPATH_BASE .DS.'libraries'.DS.'joomla'.DS.'factory.php' );
$session = JFactory::getSession();
$print $session->get('status'); 
```

我什么都得不到。如果我采用相同的代码并将其粘贴到它自己的 php 文件中，我可以很好地获取状态变量。当我查看 Joomla 预览的纯文本版本时，我看到：

```
get('status'); ?> 
```

做一些测试我认为它与'->'操作数有关。有没有人遇到过这个问题并且知道如何解决它？我正在运行 Direct PHP，并且可以在模块 fwiw 中打印出字符串和其他变量。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T20:41:08.333

1.  如果不安装支持它的插件，您将无法在 Joomla 文章中运行 PHP（或 Javascript！）。我推荐使用：[http ://www.kksou.com/php-gtk2/Joomla/DirectPHP-plugin.php](http://www.kksou.com/php-gtk2/Joomla/DirectPHP-plugin.php)
2.  更改`$print`为`print`

尝试注释掉前面的所有行，看看其中一个“包含”是否弄乱了页面：

```
/*define( '_JEXEC', 1 );
define('JPATH_BASE', "../");
define( 'DS', DIRECTORY_SEPARATOR );
require_once ( JPATH_BASE .DS.'includes'.DS.'defines.php' );
require_once ( JPATH_BASE .DS.'includes'.DS.'framework.php' );
require_once ( JPATH_BASE .DS.'libraries'.DS.'joomla'.DS.'factory.php' );
*/
$session = JFactory::getSession();
print $session->get('status'); 
```

# macros - Komodo 编辑宏用剪贴板内容替换当前文档中的特定单词；是否可以？

> ID：11421229
> 
> 赞同：1
> 
> 时间：2012-07-10T20:15:42.157
> 
> 标签：macros, clipboard, copy-paste, replace, komodoedit

我创建了这个宏来用当前文档中的另一个词替换一个特定的词，但理想情况下，我想用剪贴板内容替换它。我目前的代码如下：

```
// Macro recorded on: Wed Jul 11 2012 01:29:42 GMT+0530 (India Standard Time)
komodo.assertMacroVersion(3);
if (komodo.view) { komodo.view.setFocus(); }
ko.find.replaceAllInMacro(window, 0, 'Itemlink', 'target', true, 0, 2, false, false); 
```

上面的代码用单词'target'替换了单词'Itemlink'，但是如何使用剪贴板内容呢？到目前为止，我发现这个 Komodo 命令可以从剪贴板粘贴数据，但我不知道如何使用它。命令是：

```
komodo.doCommand('cmd_paste'); 
```

请帮忙，谢谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T01:43:20.723

使用对 scimoz 对象的引用，该对象使用[Scintilla API](http://www.scintilla.org/ScintillaDoc.html#CutCopyAndPaste)的子集，并包括用于添加到剪贴板的 copyText() 方法和用于输出当前数据的 paste() 方法：

```
komodo.assertMacroVersion(2);
var editor = ko.views.manager.currentView.scimoz;
editor.copyText(1,"("); //add left parentheses to clipboard buffer

Find_ReplaceAllInMacro(window, 0, 'Itemlink', editor.paste(), true, 0, 2, false, false); 
```

# django - Django：我如何在数据库中存储地理点

> ID：11421230
> 
> 赞同：8
> 
> 时间：2012-07-10T20:15:43.433
> 
> 标签：django, geocoding

地理点需要正确的数据类型。

我将使用谷歌地图 API 获取并显示它，格式如下

*   42.761819,11.104863
*   41.508577,-101.953125

用例：

*   用户点击地图
*   django 用附加数据保存这一点
*   在下次访问 django 时在地图上显示此点

因此，点之间没有距离等黑客攻击。

数据库：postgres 8

姜戈：1.4

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2015-12-31T18:05:36.873

查看 GeoDjango，看看它是否对您有帮助。如果您的堆栈配置为运行 GeoDjango，您可以执行此操作。

你的模型看起来像这样

```
from django.contrib.gis.db import models
class LocationPoint(models.Model):
    point = models.PointField(srid=4326,dim=3)
    accuracy = models.FloatField(default=0.0)
    objects = models.GeoManager() 
```

要将点保存到数据库中，您所要做的就是

```
from django.contrib.gis.geos import Point
point = Point(x=12.734534, y=77.2342, z=0, srid=4326)

location = LocationPoint()
location.point = point
location.save() 
```

GeoDjango 为您提供了在不久的将来可能会感兴趣的地理空间查询的扩展能力，例如查找点之间的距离、查找点周围最近的位置等。

这是[GeoDjango的链接](https://docs.djangoproject.com/en/1.9/ref/contrib/gis/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-10T20:26:04.993

看起来您将要存储纬度和经度。我会为此使用[DecimalField](https://docs.djangoproject.com/en/dev/ref/models/fields/#decimalfield)，并分别存储每个数字。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-11-11T03:50:59.537

来自[有关 DecimalField 的 django 文档](https://docs.djangoproject.com/en/dev/ref/models/fields/#decimalfield)：

> ### DecimalField.max_digits
> 
> 数字中允许的最大位数。请注意，此数字必须大于或等于 decimal_places。
> 
> ### DecimalField.decimal_places
> 
> 与数字一起存储的小数位数。

这是指[Python Decimal](http://docs.python.org/2.7/library/decimal.html#decimal.Decimal)

要正确选择准确的数据类型和精度，您应该考虑：

1.  什么是最小可能值（纬度可以从 0（下）到（-）90 度）_ _。
2.  什么是最大可能值（经度范围可以从 0（向下）到（-）180 度）_ _ _。
3.  你希望什么是准确度（decimal_places）。请注意，它会影响 Google 地图上的缩放级别。

顺便说一下，为了更好地理解，最好知道计算是如何完成的（Python代码）：

```
def deg_to_dms(deg):
    d = int(deg)
    md = abs(deg - d) * 60
    m = int(md)
    sd = (md - m) * 60
    return [d, m, sd]

def decimal(deg,min,sec): 
    if deg < 0:
       dec= -1.0 * deg + 1.0 * min/60.0 + 1.0 * sec/3600.0
       return -1.0 * dec
    else:
        dec=1.0 * deg + 1.0 * min/60.0 + 1.0 * sec/3600.0;

    return dec 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-10T22:21:39.357

我在 django 设置中使用经度和纬度。

我的模型包括：

```
long_position   = models.DecimalField (max_digits=8, decimal_places=3)
lat_position   = models.DecimalField (max_digits=8, decimal_places=3) 
```

为了更精确，您可能希望 decimal_places 更多。

当您想在 Google Map API 方法中显示它时，您将引用您的模型并编写一个 python 代码来输出，如下所示：

```
output = some_long_position + "," + some_lati_position 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-05-01T02:03:13.767

我在模型中使用它

```
latitude = models.DecimalField(max_digits=11, decimal_places=7,null=True,blank=True)
longitude = models.DecimalField(max_digits=11, decimal_places=7,null=True,blank=True) 
```

# c# - 如何在 Win Forms 应用程序 C# 中生成 *.XmlSerializers.dll

> ID：11421234
> 
> 赞同：1
> 
> 时间：2012-07-10T20:16:10.377
> 
> 标签：c#, .net, xml-serialization, clickonce, visual-studio-2012

我正在**Visual Studio 2012 RC 中使用 C# 开发 Win Forms**。问题是我的项目没有创建

**example.XmlSerializers.dll**

在

*我的项目的**\bin\Debug**目录。

**当我使用Click Once**发布项目时会出现此问题。

## *我已经做了什么来摆脱这个问题。*

1.  在项目的属性构建选项卡中。我已设置**生成序列化程序集 = ON**
2.  在项目的属性发布选项卡中。我单击应用程序文件按钮并选择**example.XmlSerializers.dll = Include**

我在谷歌上搜索过，但没有找到满意的答案。

请帮忙。我有麻烦了。我怎样才能摆脱它。我将非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T17:06:38.097

如果您构建您的应用程序，dll 是否显示在 \bin\debug 文件夹中？如果是，则构建应用程序，然后打开“应用程序文件”对话框（在主项目属性的“发布”选项卡中）。在屏幕底部，选中“显示所有文件”。那些dll应该出现。将它们设置为“包括”和“必需”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T23:00:30.727

我找到[了这个链接](http://drybridge.wordpress.com/2009/04/29/xmlserializersdll-file-not-uploaded-when-using-clickonce-publish/)，它帮助我解决了问题。

似乎“立即发布”按钮有一个不包括 [application_name].XMLserializers.dll 的错误。如果您选择“发布向导”按钮，则应包含您丢失的文件...

# php - 使用 JS 复制表单并更改名称数据

> ID：11421238
> 
> 赞同：1
> 
> 时间：2012-07-10T20:16:26.817
> 
> 标签：php, javascript, forms

如果可能的话，我想大致解释一下我应该如何解决这个问题，这样我就可以尝试自己直接解决这个问题。照原样，我在思考解决方案时遇到了麻烦。

我正在从包含图书信息（ISBN、价格、条件等）的表单中传递值。它与一本书一起工作得很好。所有这些表单信息都放在一个 div 中。

我最近实现了一个简单的 JS 'duplicate' 函数，它复制 div 中的所有表单数据，以便用户可以添加另一本书或多本其他书籍。问题似乎是我复制的原始 div 中的所有名称值都没有改变，或者不接受它们现在应该包含多个值。

我应该如何让每本“书”都有自己的价值观？每个输入中的名称是否应该是数组（例如 book[0]['price']），然后每次添加另一个 div 时，JS 都会更改名称（例如 book[1]['price']）？

我之所以这样问，是因为我真的不确定这是否可行，而且我宁愿在更改表单工作的（已经有效的）方式之前听取更有经验的意见。如果需要更多信息，请询问，我会提供。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T20:26:13.223

```
<div id="book1">
<input type="text" name="price[]" id="price1" />
<input type="text" name="isbn[]" id="isbn1" />
</div> 
```

使用js复制并仅更新ID（因为每个ID都应该是唯一的），

```
<div id="book2">
<input type="text" name="price[]" id="price2" />
<input type="text" name="isbn[]" id="isbn2" />
</div> 
```

现在`$_POST['price']`应该给你价格数组​​，isbn的每个对应元素应该给你那本书的isbn

服务器端就像，

```
$price = $_POST['price'];
$isbn = $_POST['isbn'];

foreach( $price as $key => $value ) {
  echo "The price is ".$value." and isbn is ".$isbn[$key];
} 
```

这是我会去的一种方式..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-10T20:27:44.853

您在 html 表单中指定的名称可以是数组。例如价格[]

```
<input type="text" name="price[]"> 
```

现在，如果您有多个名为“price[]”的表单输入，那没关系。事实上，这使它很有用。

现在在 php 中，您可以使用以下方法轻松访问每个名称

```
$_POST['price'][$i] //where $i is 0,1,2,3..... 
```

基本上，它的作用是在 $_POST 数组下为“价格”创建一个数组。您也可以轻松地遍历 $i 并获取其他字段的值。

这回答了您的陈述“或者不接受它们现在应该包含多个值。”

# java - SpringMVC 给 404 返回一个视图

> ID：11421239
> 
> 赞同：1
> 
> 时间：2012-07-10T20:16:36.123
> 
> 标签：java, spring, spring-mvc

我有以下控制器...

```
@Controller
@RequestMapping(value = "/userManagement")
public class UserManagementController {

@RequestMapping(value = "/", method = RequestMethod.GET)
    public Object home(Locale locale, Model model) {

        logger.info("User management view controller loaded...");

        return "userManagement";
    }

@RequestMapping(value = "/createUserView", method = RequestMethod.GET)
    public Object createUser(Locale locale, Model model) {
        logger.info("create controller loaded...");
        return "createUser";
    } 
```

我的 servlet-context 设置了以下值...

```
<beans:bean
    class="org.springframework.web.servlet.view.InternalResourceViewResolver">
    <beans:property name="prefix" value="/WEB-INF/views/" />
    <beans:property name="suffix" value=".jsp" />
</beans:bean> 
```

现在如果我去`http://localhost:8080/myapp/userManagement`然后我得到视图 userManagement.jsp 这正是我想要的......

但是如果我去`http://localhost:8080/myapp/userManagement/createUserView`我会得到一个 404 错误。

```
NetworkError: 404 Not Found - http://localhost:8080/myapp/userManagement/createUserView" 
```

我没有看到为什么会发生这种情况，因为我已经将 requestMapping 设置为与上面完全相同，并且在 /WEB-INF/views 我有一个 createUser.jsp 和 userManagement.jsp

关于提供来自 spring mvc 的观点，我做错了什么吗？

谢谢，

编辑：web.xml 添加在下面...

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" version="2.5">
  <context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>/WEB-INF/spring/root-context.xml 
    /WEB-INF/spring/security-app-context.xml
    /WEB-INF/spring/appServlet/servlet-context.xml</param-value>
  </context-param>
  <filter>
    <filter-name>springSecurityFilterChain</filter-name>
    <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
</filter>
<filter-mapping>
  <filter-name>springSecurityFilterChain</filter-name>
  <url-pattern>/*</url-pattern>
</filter-mapping>
  <listener>
    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
  </listener>
  <servlet>
    <servlet-name>appServlet</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <init-param>
      <param-name>contextConfigLocation</param-name>
      <param-value>/WEB-INF/spring/appServlet/servlet-context.xml</param-value>
    </init-param>
    <load-on-startup>1</load-on-startup>
  </servlet>
  <servlet-mapping>
    <servlet-name>appServlet</servlet-name>
    <url-pattern>/</url-pattern>
  </servlet-mapping>
</web-app> 
```

编辑2：

此外，如果我直接转到浏览器中的地址而不是使用 Ajax（转到 myapp/userManagement/createUserView，我会收到错误消息...

HTTP 状态 404 - /myapp/WEB-INF/views/userManagement/createUserView.jsp 所以它似乎正在查看一个太高的目录（尽管文件名也是错误的）。

编辑3。

好的，即使我执行以下操作似乎也是如此..

```
 @Controller
@RequestMapping(value = "/userManagement")
public class UserManagementController {

    @RequestMapping(value = "/", method = RequestMethod.GET)
        public Object home(Locale locale, Model model) {

            logger.info("User management view controller loaded...");

            return "createUser";
        } 
```

我仍然看到 userManagement.jsp 页面，所以看起来这个返回没有正确触发，但我不知道为什么。记录器详细信息仍然会被触发到控制台，因此它实际上已经到达那里，只是 springmvc 返回 JSP 的方式有些奇怪。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T20:21:43.140

你能检查两件事吗：1）向控制器添加断点或查看服务器日志，检查请求是否进入方法。2）如果第一步没问题，检查jsp是否存在于正确的路径或jsp的名称是否正确

**编辑**

等等，如果您使用 Ajax 进行请求，您的控制器应该具有以下 requestMapping：

```
 @RequestMapping(value = "/url", method = RequestMethod.GET, 
  headers = "X-Requested-With=XMLHttpRequest") 
```

否则你的 ajax 请求不会被映射，你会得到 404。

**旁注** 您可以将方法返回类型从对象更改为字符串吗？看看有没有影响？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T20:28:31.107

我认为您的 web.xml 映射不正确，应该是：

```
 <servlet-mapping>
    <servlet-name>appServlet</servlet-name>
    <url-pattern>/*</url-pattern>
  </servlet-mapping> 
```

（注意`/*`在 url 模式中）

# php - 为什么 display_errors 会改变 HTTP 状态码？

> ID：11421240
> 
> 赞同：8
> 
> 时间：2012-07-10T20:16:39.160
> 
> 标签：php, http

正如许多其他问题所指出的，在 php.ini 中将 display_errors 设置为 Off 会使 Web 服务器在遇到致命错误时以状态码 500 Internal server error 而不是 200 OK 回答。我用一个未定义的函数设置了一个简单的测试来解释这种行为：

php.ini

```
display_errors = On 
```

索引.php

```
<?php test(); 
```

给出：

```
Fatal error: Call to undefined function test()
in D:\xampp\htdocs\index.php on line 1 
```

或者如果我像这样使函数调用静音，则只是一个空白页：

```
<?php @test(); 
```

在这两种情况下，答案标题如下：

```
HTTP/1.1 200 OK
Date: Tue, 10 Jul 2012 20:08:22 GMT
Server: Apache/2.2.21 (Win32) mod_ssl/2.2.21 OpenSSL/1.0.0e PHP/5.3.8 mod_perl/2.0.4 Perl/v5.10.1
X-Powered-By: PHP/5.3.8
Content-Length: 0
Keep-Alive: timeout=5, max=100
Connection: Keep-Alive
Content-Type: text/html 
```

将 php.ini 更改为：

```
display_errors = Off 
```

原因：

```
HTTP/1.0 500 Internal Server Error
Date: Tue, 10 Jul 2012 20:10:35 GMT
Server: Apache/2.2.21 (Win32) mod_ssl/2.2.21 OpenSSL/1.0.0e PHP/5.3.8 mod_perl/2.0.4 Perl/v5.10.1
X-Powered-By: PHP/5.3.8
Content-Length: 0
Connection: close
Content-Type: text/html 
```

任何人都可以向我解释当 display_errors 关闭时使 Web 服务器回答 500 的底层机制吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-10T20:22:00.773

原因是，使用`display_errors = On`，您实际上是在要求 PHP 给您一个不错的 HTTP 响应，即使您的脚本中有错误也是如此。将其视为脚本和响应之间的附加层。它不再是您的脚本控制输出，而是 PHP。

当您打开此选项时，您实际上是在说，“*如果有错误，请仍然给我一个有效的 HTTP 响应页面（它甚至可能包含适当的标记），因为我将查看**它**而不是我的日志。* "

设置为`Off`时，HTTP 响应应该是无意义的，因此是 500。使用它时，预计会出现 PHP 错误，因此即使您的脚本失败，**整个请求也不是 500。**

# ruby-on-rails - Rails 在模型故障中包含模块

> ID：11421243
> 
> 赞同：1
> 
> 时间：2012-07-10T20:16:47.783
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.1

我在**/lib/models/scopes.rb中有模块**

```
module Models
    module Scopes
        extend ActiveSupport::Concern
        ...
    end
end 
```

我正在尝试从模型中包含它：

```
class User < ActiveRecord::Base
  include Models::Scopes
end 
```

并得到错误：

> NameError: 未初始化的常量 User::Models

如何解决这个麻烦？将这种类型的文件保存在 /lib 中可能是错误的？

环境：Rails v3.1 Ruby v1.9.3

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-10T20:41:40.200

Rails 不会`lib`自动要求目录中的文件，但您可以添加到自动加载的路径中`config/application.rb`：

```
config.autoload_paths += %W(#{config.root}/lib) 
```

重新启动服务器以获取新设置。

这将在*第一次*使用模块名称时自动加载文件。在开发模式下，您可能希望在*每次*更改后重新加载模块，以便在不重新启动服务器的情况下查看更改。为此，请将其添加为急切加载路径：

```
config.eager_load_paths += %W(#{config.root}/lib) 
```

只要您*在内部*或其他任何地方没有`Models`类或模块，范围就不应该成为问题。 *`User`*

 ** * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-10T20:24:27.577

当你定义你的班级时，你正在“打开”一个新的范围。所以当你这样做时`Models::Scopes`，ruby 正在寻找`User::Models::Scopes`。你可以通过使用来解决这个问题`::Models::Scopes`，`::`告诉 ruby​​ 在全局范围内查看。

仅供参考：我不确定我使用的术语，或者我的思路是否正确；但无论如何，解决方案应该是好的。我认为 Ruby`::Models::Scope`在 find 失败后会尝试`User::Models::Scope`，但它没有......也许在`User::Models`某处定义了一个范围？无论如何，如您所见，我还不熟悉这些。如果您感兴趣，您可能想深入研究这个主题*

# asp.net-mvc-3 - MVC3 HTML ActionLink 不起作用

> ID：11421248
> 
> 赞同：1
> 
> 时间：2012-07-10T20:17:07.870
> 
> 标签：asp.net-mvc-3

我有一个 DashBoardController.cs 这里我有这个代码

```
public class DashBoardController : Controller
    {
        //
        // GET: /DashBoard/

        [Authorize]
        public ActionResult Index()
        {
            return View();
        }

        //
        // GET: /New Project/

        [Authorize]
        public ActionResult NewProject()
        {
            return View();
        }

        //
        // GET: /File Upload/

        public ActionResult UploadFile()
        {
            return View();
        }

        [HttpPost]
        public ActionResult UploadFile(HttpPostedFileBase file)
        {
            // Verify that the user selected a file
            if (file != null && file.ContentLength > 0)
            {
                // extract only the fielname
                var fileName = Path.GetFileName(file.FileName);
                // store the file inside ~/App_Data/uploads folder
                var path = Path.Combine(Server.MapPath("~/Uploads"), fileName);
                file.SaveAs(path);
            }
            // redirect back to the index action to show the form once again
            return RedirectToAction("Index", "Home");
        }

    } 
```

我这里有另一个 masterlayout 文件我有这个代码

```
<div id="LeftColumn" class="ui_style_floatLeft">
            <div id="menuWrapper">
                <ul class="menu">
                    <li class="menuDashBoard">@Html.ActionLink("Dashboard","Index")</li>
                    <li class="menuProject"><a href="#">Project</a>
                        <ul>
                            <li>@Html.ActionLink("New Project","NewProject")</li>
                            <li><a href="#">Projects</a></li>
                        </ul>
                    </li>                   
                    <li class="menuAccount"><a href="#">Account</a>
                        <ul>
                            <li>@Html.ActionLink("Change Password", "ChangePassword", "Account")</li>
                        </ul>
                    </li>                  
                </ul>               
             </div>
        </div> 
```

但是，如果我转到`Change Password`操作链接，则其他链接 ( `New Project`, `Dashboard`) 不起作用。我尝试`@Url.Action`使用 herf attr 但不工作:(

我现在该怎么办 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T20:19:40.087

您需要在[操作链接](http://msdn.microsoft.com/en-us/library/dd505070.aspx)中包含控制器名称：

```
@Html.ActionLink("Dashboard","Index","DashBoard") 
```

如果省略`controllerName`，则将使用*当前控制器*构造链接。由于您导航到`AccountController`，应该指向损坏的链接`DashboardController`。

在共享区域（如导航）中，您通常需要包含控制器引用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-10T20:59:38.597

*   链接文本：“仪表板”
*   动作名称：“索引”
*   控制器名称：“仪表板”

    @Html.ActionLink("仪表板"、"索引"、"仪表板")

如果您使用[区域](https://stackoverflow.com/questions/5243158/how-to-configure-areas-in-asp-net-mvc3)将控制器分组到您需要的不同区域。

```
@Html.ActionLink("Dashboard", "index", "dashboard", new { area = "YourAreaName"}) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-10T20:20:28.310

使用[这个](http://msdn.microsoft.com/en-us/library/dd505070.aspx)重载

```
@Html.ActionLink("New Project","NewProject","DashBoard") 
```

这是格式

```
public static MvcHtmlString ActionLink(
    this HtmlHelper htmlHelper,
    string linkText,
    string actionName,
    string controllerName
) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-10T20:21:21.927

仔细看，我想你没有把控制器放在`"NewProject"`and`"Index"`方法上

尝试更换

```
@Html.ActionLink("New Project","NewProject") 
```

为了

```
@Html.ActionLink("New Project","NewProject", "DashBoard") 
```

和

```
@Html.ActionLink("Dashboard","Index") 
```

为了

```
@Html.ActionLink("Dashboard","Index", "DashBoard") 
```

# ruby-on-rails-3 - Rails 中的 ViewBag 之类的东西

> ID：11421250
> 
> 赞同：1
> 
> 时间：2012-07-10T20:17:28.320
> 
> 标签：ruby-on-rails-3, asp.net-mvc-3, viewbag

首先，我想原谅所有真正的 Rails 开发人员，询问是否有像副本一样的原始版本。我的问题是：Rails 中是否有类似 ViewBag 的东西，我可以在其中放置简单的字符串？

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-10T20:18:59.390

> 我的问题是：Rails 中是否有类似 ViewBag 的东西，我可以在其中放置简单的字符串？

不，感谢上帝，不。Rails 并没有像微软那样犯同样的错误，因为它允许像`ViewBag`. 如果要将数据传递给视图，则应使用视图模型。顺便说一句，您也应该使用视图模型来传递数据以在 ASP.NET MVC 中查看 :-)

不，我在开玩笑，你可以在 Rails 中这样做：

```
def foo
    @name = "foo bar"
end 
```

在视图中：

```
<%= @name %> 
```

但是请不要`ViewBag`在 ASP.NET MVC 中使用。使用视图模型:-) 这句话让我发笑。我每天都在重复它无数次，但我仍然看到使用 ViewBag 的家伙。这是令人难以置信的。

# php - 从 wp_query 中对 meta_value 进行排序，但在排序之前删除特殊字符

> ID：11421259
> 
> 赞同：0
> 
> 时间：2012-07-10T20:17:54.837
> 
> 标签：php, mysql, wordpress

我有一个插件，可以对搜索页面和分类页面上的帖子进行排序。循环已经处理了缩小结果的范围，所以我需要的是能够将帖子排序为自定义元值。在这种情况下价格。我希望能够进入现有查询，替换任何特殊字符，然后根据干净的元值进行排序。

我使用了这个选择，但问题是它查询数据库上的所有帖子而不是 wp_query 中找到的结果，这会大大减慢排序速度

```
function join_it( $join ) {
global $wpdb;
    $sym = get_option('sort_by_ignore');
    $join .= "LEFT JOIN (SELECT $wpdb->prefix" . "postmeta.post_id AS ID, CAST(REPLACE(REPLACE(REPLACE($wpdb->prefix" . "postmeta.meta_value, ',', ''), '" . $sym . "',''),' ','') AS SIGNED) AS price FROM $wpdb->prefix" . "postmeta WHERE meta_key = 'my_price'" . ") P ON (P.ID = wp_posts.ID)";

return $join;
}
add_filter('posts_join', 'join_it' );

$args = array_merge( $wp_query->query, array('caller_get_posts' => 1,'paged' => $paged ));

        query_posts($args); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T21:00:18.427

如果您仅将其用于排序，则最好使用`posts_orderby`过滤器，而不是`posts_join`.

如果您发现过滤器影响其他查询，您可以`remove_filter`在它在您需要的地方运行后使用。

[我在这里](https://stackoverflow.com/questions/11314896/wordpress-query-order-by-custom-field-missing-posts/11316027#11316027)的回答做了一些类似的事情（没有用`replace`函数清理值——我认为你必须把它留在里面）。

# excel - Excel中的CSV小数点

> ID：11421260
> 
> 赞同：39
> 
> 时间：2012-07-10T20:17:57.193
> 
> 标签：excel, csv

我有一个包含以下值的 CSV 文件：

```
3271.96;274;272;1;1;0;1;0.071690;0;0;0;0;0;0;1.753130;1.75;0;1.75; 
```

但是当我用 Excel 打开文件时，我得到了这个：

```
3271.96 274 272 1   1   0   1   0.071690    0   0   0   0   0   0   1.753.130   1.75    0   1.75 
```

为什么“1.753130”转换成“1.753.130”？（1.753130 是十进制数）我如何“强制”Excel 理解这些是十进制数？

我使用 Web 应用程序创建 CSV 文件，因此仅修改我的 Excel 配置很困难，因为很多人访问我的网站并将 CSV 文件下载到他们的计算机上。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2019-06-27T07:27:05.390

对于使用 Excel 365 等较新版本的 Excel 寻求此问题的用户...正如[Excel 教授](https://professor-excel.com/import-csv-text-files-excel/)所写，您可以在设置中激活/恢复“来自文本（旧版）”。

**我的首选解决方案**

```
File - Options - Data 
```

[![Excel 设置 - 来自文本（旧版）](../Images/f4c5a5458ed77b3780866b8130ac1558.png)](https://i.stack.imgur.com/7yGSj.png)

然后你将能够获得旧的导入向导......遗留但在我看来更直观。

[![链接到旧版导入向导](../Images/042fb1cb30b894fd5c00ee5a78a050ae.png)](https://i.stack.imgur.com/nfcNR.png)

**其他可能性**

在链接的 Excel 教授网站上，还显示了其他可能性。使用 Excels 新的导入对话框，如果您有几列数字都在与您的计算机区域设置不同的区域设置中，那么进行导入将更加努力。使用旧向导，您将在一分钟内完成设置。使用新的导入对话框，我还没有找到与旧导入方法一样快的方法。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2015-05-26T12:10:02.813

这是我使用的答案：

*   转到 Excel 工作表上的数据选项卡。

*   点击`from Text`按钮。

*   然后选择文本或 csv 文件。

*   然后会出现导入向导。选择逗号分隔或空格分隔选项。

*   然后选择分隔符。（如果您不希望在导入小数时出现问题，这会更好）

*   然后在下一个窗口中将有 General 列类型的 Advanced 选项。单击高级按钮并选择如何分隔小数和千位。

将小数点分隔符更改为“。” 并删除带有空格的千位分隔符。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-07-10T22:31:07.697

1.  重命名`csv`为`.txt`
2.  打开excel
3.  转到文件->打开并指向您的txt文件
4.  完成导入它的步骤
5.  确保`;`用作分隔符

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2020-10-01T00:01:52.247

截至目前（2020 年 9 月），我设法以稍微不同的方式做到了这一点。我正在使用 Office 365 订阅中的 Excel。

打开 Excel 工作表，转到：

*   数据（选项卡）> 从文本/CSV（获取和转换数据部分）

选择您的文件（.txt 或 .csv），然后您将有 3 个选项：

*   文件来源：可能你不必改变这个
*   分隔符：选择您的分隔符（可能是逗号）
*   **数据类型检测**：将其更改为**“不检测数据类型”**

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-12-11T04:53:29.223

我遇到了同样的问题，但仅此解决方案对我不起作用。

在此之前，我必须转到 Office 图标 -> Excel 选项 -> 高级并从“。”设置千位分隔符。到“”（什么都没有）。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2017-08-22T08:53:08.630

有一种更直接的方法可以将数据从 text/csv 导入 Excel (2017)：

*   在 Excel 中打开一本空白书，然后单击从 text/csv 导入数据。
*   选择文件。
*   助手将显示数据的预览，但如果您从带有十进制/科学数字的 csv 导入，则所有数据都将被识别为文本。
*   在导入之前，单击编辑，您将看到一个带有数据预览的 Excel 电子表格。
*   如果单击高级编辑器按钮，将出现一个带有 Excel 查询的新窗口。

你会看到类似的东西：

```
let
    Origin = Csv.Document(File.Contents("C:\Users\JoseEnriqueP\Downloads\evaluation_output.txt"),[Delimiter=",", Columns=8, Encoding=1252, QuoteStyle=QuoteStyle.None]),
    #"Updated type" = Table.TransformColumnTypes(Origin,{{"Column1", Int64.Type}, {"Column2", type text}, {"Column3", type text}, {"Column4", type text}, {"Column5", type text}, {"Column6", type text}})
in
    #"Updated type" 
```

然后，您可以直接写下每一列的类型： - 文本：输入文本 - 整数：Int64.Type - 小数：Double.Type

导入代码如下：

```
let
    Origin = Csv.Document(File.Contents("C:\Users\JoseEnriqueP\Downloads\evaluation_output.txt"),[Delimiter=",", Columns=8, Encoding=1252, QuoteStyle=QuoteStyle.None]),
    #"Updated type" = Table.TransformColumnTypes(Origin,{{"Column1", Int64.Type}, {"Column2", Int64.Type}, {"Column3", Int64.Type}, {"Column4", type text}, {"Column5", Double.Type}, {"Column6", Double.Type}})
in
    #"Updated type" 
```

通过这样做，您可以将数据直接导入 Excel。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-04-10T07:37:06.853

如果您有更新版本的 Excel（例如 Office 365）并且您不需要更正文件的编码，这对我有用：

1.  在文件资源管理器中双击打开 .csv 文件
2.  选择包含十进制数字的列
3.  使用查找和替换将所有点 (.) 更改为逗号 (,) 符号

这假定不需要其他数据转换（这可能需要通过导入向导），并且 Excel 可以正确识别文件的编码。

如果编码也是一个问题，请在上述步骤**之前执行以下操作：**

1.  在记事本++中编辑文件
2.  打开编码菜单选项卡
3.  选择所需的值来转换文件的编码

其他一些答案也有效，但为了简单起见，您无法击败 Find and Replace 方法。不管你做什么，这是**最重要的一步**：长寿和繁荣！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2022-01-14T00:09:14.757

在 2012 版 Excel 中对我有用的是，当您导入数据时，您可以选择打开“**转换数据**”框。在右侧面板的此框中，您可以看到“**应用步骤**”列表。这些是 excel 应用于源文件的步骤。您可以**从此列表中删除导致问题的步骤**。 *从我的文本文件导入时，我遇到了 excel 忽略小数点的问题，但这解决了问题。*

# javascript - 对象包装与对象“污染” - 性能取决于对象大小或数量？

> ID：11421266
> 
> 赞同：2
> 
> 时间：2012-07-10T20:18:00.947
> 
> 标签：javascript, design-patterns

我正在重写我前段时间写的一个 JavaScript 库。其目的是将对象数组显示为表格，无需服务器通信即可对其进行排序、过滤和编辑。

当前的解决方案“污染”了具有附加属性的对象，这些属性是控制显示所需的。原始对象可能看起来像这样

```
{"name":"...","lastname":"...","age":27} 
```

然后它有像这样的附加属性

```
{"name":"...","lastname":"...","age":27,"TTMDecode":true,"TTMChildren":[]} 
```

另一种解决方案可能是仅包装原始对象，然后使用这些包装器。

```
{"decode":true,"children":[],"data":{"name":"...","lastname":"...","age":27}} 
```

**我不确定哪种解决方案更可取。** 使用第二种解决方案，如果原始对象被更改，则更容易将原始对象返回到服务器，但它会使 JavaScript 引擎的对象数量增加一倍。

该解决方案能够处理超过 20.000 个对象，并且在当前浏览器中运行速度很快。但是 40.000 个对象会是个问题吗？

我希望我能很好地解释我的担忧。

问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-10T20:27:09.947

您需要的是设计模式。你碰巧已经在使用一个。

首先，您不应该用视图所需的东西污染模型。这与说您不能在模型上使用便捷方法或计算属性不同。一个表明你做错了的危险信号是模型上是否有特定于你的视图层的东西，比如 DOM。我不知道`TTMDecode`你的例子是什么......

其次，您已经在使用设计模式。您正在使用**合成**来**装饰**您的模型对象。

[有关装饰器模式的描述，请参见 this ，](http://en.wikipedia.org/wiki/Decorator_pattern)有关
[Composition 的描述](http://en.wikipedia.org/wiki/Object_composition)，请参见 this 。

我认为你做得很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-10T20:28:29.047

首先，关于您的体系结构问题：为什么不使用两个属性`display`和创建一个父对象`data`？你不应该因为担心性能而限制你的架构，如果它有效果，你会在测量性能时注意到它。

```
var obj = {
    display: {
      // display data
    },
    data: {
      // personal data
    }
); 
```

这隐含地回答了关于对象计数的问题，这通常无关紧要（如果对象本身并不大，它不会影响你的表现）

# linear-algebra - gcc 2.95 浮点线性代数与 gcc 4.3.2 不匹配

> ID：11421274
> 
> 赞同：1
> 
> 时间：2012-07-10T20:18:38.133
> 
> 标签：linear-algebra, floating-point-precision

我正在编译使用线性代数计算色谱的遗留代码。矩阵使用 float 作为类型，所有计算都使用 float。当我们使用旧的编译器（turbo-linux gcc 2.95）时，我们会得到一个答案。当我使用我们的新编译器（SuSE gcc 4.3.2）时，我们会得到不同的光谱。

我需要获取使用新编译器编译的同一程序的输出，以匹配使用旧编译器的输出。

我试过使用这些编译器选项： g++ -g -lstdc++ -mfpmath=no-sse -mno-sse -mno-sse2 -ffloat-store -mieee-fp

这个代码：

```
volatile unsigned short int cw;
__asm__ volatile("fstcw %0" : "=m" (*&cw));
printf("floating point control word was: %x\n",cw);
cw=0x027f;
__asm__ volatile("fldcw %0" :: "m" (*&cw));
    printf("floating point control word  now is: %x\n",cw); 
```

这些都不能使色谱匹配。

那么问题是......是否有灵丹妙药可以使从两个不同编译器编译的代码产生的色谱相匹配？我希望浮点控制宽度（上面的 flpcw）是解决方案，但事实并非如此。（注意，代码太复杂，无法发布，）。

PS上面代码的结果是：gcc 2.95浮点控制字是：0x37f浮点控制字现在是0x27f。

gcc 4.3.2 浮点控制字是：0x37f 浮点控制字现在是 0x27f。

# asp.net - 如何从 MVC 应用程序中删除 WebForms 依赖项

> ID：11421281
> 
> 赞同：1
> 
> 时间：2012-07-10T20:19:01.790
> 
> 标签：asp.net, asp.net-mvc, webforms

我有一个开始使用 WebForms 的 Web 应用程序。我们一直在稳步将每个页面转换为使用 ASP.NET MVC，而我们终于即将完全删除所有 WebForms 依赖项。

是否有任何依赖项融入 WebForms 项目，但如果我们只使用 MVC 页面，可以将其删除？

（我发现一篇关于如何删除[WebForms 视图引擎](https://stackoverflow.com/questions/5912980/turning-off-the-webformviewengine-when-using-razor)的帖子，但我认为这是在谈论基于 MVC .ascx 的视图渲染器，我们还没有完全消除它。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T20:47:45.223

> 如何从 MVC 应用程序中删除 WebForms 依赖项

很简单，3个步骤：

1.  `Ctrl+F`在`System.Web.UI`您的整个解决方案中。如果您发现超过 0 次出现，您仍然有旧代码。删除它们。由于此删除，您的项目可能无法编译 => 修复编译时错误。修复编译时错误还没有任何意义。在运行时，您可能仍然会在视图中留下一些服务器端控件时遇到故障。

2.  `Ctrl+F`在`runat="server"`您的整个解决方案中。如果您在内容占位符以外的地方发现超过 0 次出现，则您仍然有旧代码。

3.  `Ctrl+F`在`HttpContext.Current`您的整个解决方案中。如果您发现超过 0 次出现，您仍然有旧代码。

但是将经典 ASP.NET 应用程序移植到 ASP.NET MVC 的正确方法不是进行就地替换。你肯定会忘记东西。正确的方法是从头开始。通过使用 Visual Studio 中的创建新的 ASP.NET MVC 3 应用程序向导并逐步迁移代码和视图。

# algorithm - 生成与指定百分比成比例的序列的算法

> ID：11421283
> 
> 赞同：1
> 
> 时间：2012-07-10T20:19:05.743
> 
> 标签：algorithm, language-agnostic, sequences, random-sample

给定一个对象的地图和指定的比例（假设它们加起来是 100 以便于计算）：

```
val ss : Map[String,Double] = Map("A"->42, "B"->32, "C"->26) 
```

我怎样才能生成一个序列，使得对于一个大小的子集`n`有~42%的“A”、~32%的“B”和~26%的“C”？（显然，小`n`的会有更大的错误）。

（工作语言是 Scala，但我只是要求算法。）

**更新**：我反对随机方法，因为例如，序列开始的可能性约为 16%，开始的`AA`可能性约为 11%，并且精确 ==（比例总和）的`BB`可能性非常低`n`分配将是完美的。所以，按照@MvG的回答，我实现如下：

```
/**
Returns the key whose achieved proportions are most below desired proportions
*/
def next[T](proportions : Map[T, Double], achievedToDate : Map[T,Double]) : T = {
    val proportionsSum = proportions.values.sum
    val desiredPercentages = proportions.mapValues(v => v / proportionsSum)
    //Initially no achieved percentages, so avoid / 0 
    val toDateTotal = if(achievedToDate.values.sum == 0.0){
        1
    }else{
        achievedToDate.values.sum
    }
    val achievedPercentages = achievedToDate.mapValues(v => v / toDateTotal)
    val gaps = achievedPercentages.map{ case (k, v) =>
        val gap = desiredPercentages(k) - v
        (k -> gap)
    }
    val maxUnder = gaps.values.toList.sortWith(_ > _).head
    //println("Max gap is " + maxUnder)
    val gapsForMaxUnder = gaps.mapValues{v => Math.abs(v - maxUnder) < Double.Epsilon }
    val keysByHasMaxUnder = gapsForMaxUnder.map(_.swap)
    keysByHasMaxUnder(true)
}

/**
Stream of most-fair next element 
*/
def proportionalStream[T](proportions : Map[T, Double], toDate : Map[T, Double]) : Stream[T] = {
    val nextS = next(proportions, toDate)
    val tailToDate = toDate + (nextS -> (toDate(nextS) + 1.0))
    Stream.cons(
        nextS,
        proportionalStream(proportions, tailToDate)
    )
} 
```

使用时，例如：

```
val ss : Map[String,Double] = Map("A"->42, "B"->32, "C"->26)
val none : Map[String,Double] = ss.mapValues(_ => 0.0)
val mySequence = (proportionalStream(ss, none) take 100).toList
println("Desired : " + ss)
println("Achieved : " + mySequence.groupBy(identity).mapValues(_.size))
mySequence.map(s => print(s))
println 
```

产生：

```
Desired : Map(A -> 42.0, B -> 32.0, C -> 26.0)
Achieved : Map(C -> 26, A -> 42, B -> 32)
ABCABCABACBACABACBABACABCABACBACABABCABACABCABACBA
CABABCABACBACABACBABACABCABACBACABABCABACABCABACBA 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-10T20:23:08.950

对于序列中的每一项，计算一个（伪）随机数*r* ，它在 0（包括）和 100（不包括）之间均匀分布。

*   如果 0 ≤ *r* < 42，取`A`
*   如果 42 ≤ *r* < (42+32)，取`B`
*   如果 (42+32) ≤ *r* < (42+32+26)=100，取`C`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-10T20:28:13.673

对于确定性方法，最明显的解决方案可能是：

*   跟踪到目前为止序列中每个项目的出现次数。
*   对于下一个项目，选择预期计数与实际计数（或比例，如果您愿意）之间的差异最大的项目，但前提是预期计数（或比例）大于实际计数。
*   如果有平局，以任意但确定的方式打破它，例如选择字母顺序最低的项目。

这种方法将确保以这种方式生成的无限序列的每个前缀都最佳地遵守规定的比率。

快速而肮脏的 python 概念证明（不要期望任何变量“名称”有意义）：

```
import sys

p = [0.42, 0.32, 0.26]
c = [0, 0, 0]
a = ['A', 'B', 'C']
n = 0

while n < 70*5:
    n += 1
    x = 0
    s = n*p[0] - c[0]
    for i in [1, 2]:
        si = n*p[i] - c[i]
        if si > s:
            x = i
            s = si
    sys.stdout.write(a[x])
    if n % 70 == 0:
        sys.stdout.write('\n')
    c[x] += 1 
```

生成

```
ABCABCABACABACBABCAABCABACBACABACBABCABACABACBACBAABCABCABACABACBABCAB
ACABACBACABACBABCABACABACBACBAABCABCABACABACBABCAABCABACBACABACBABCABA
CABACBACBAABCABCABACABACBABCABACABACBACBAACBABCABACABACBACBAABCABCABAC
ABACBABCABACABACBACBAACBABCABACABACBACBAABCABCABACABACBABCABACABACBACB
AACBABCABACABACBACBAABCABCABACABACBABCAABCABACBACBAACBABCABACABACBACBA 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-10T20:27:14.807

您的子集中每个条目的数量将与您的地图中的相同，但应用了比例因子。

比例因子为`n/100`。

因此，如果 n 为 50，您将拥有`{ Ax21, Bx16, Cx13 }`.

根据您的喜好随机排列顺序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-10T20:44:20.383

最简单的“确定性”[就每个类别的#elements] 解决方案 [IMO] 将是：**以预定义的顺序添加元素，然后对结果列表进行洗牌**。

首先，`map(x)/100 * n`从每个元素中添加元素 x 选择如何处理整数算术以避免偏离一个元素]，然后打乱结果列表。

[使用fisher-yates shuffle](http://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle)对列表进行洗牌很简单，它在大多数语言中都有实现：例如 java 有[`Collections.shuffle()`](http://docs.oracle.com/javase/6/docs/api/java/util/Collections.html#shuffle%28java.util.List%29)，而 C++ 有[`random_shuffle()`](http://www.cplusplus.com/reference/algorithm/random_shuffle/)

在java中，它会很简单：

```
int N = 107;
List<String> res = new ArrayList<String>();
for (Entry<String,Integer> e : map.entrySet()) { //map is predefined Map<String,Integer> for frequencies
    for (int i = 0; i < Math.round(e.getValue()/100.0 * N); i++) {
        res.add(e.getKey());
    }
}
Collections.shuffle(res); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-11T20:01:44.760

这是不确定的，但给出了接近 MvG 的值分布。它的问题是它可以在一开始就给 AAA。考虑到它如何证明我对 MvG 的异议是错误的（而且我不希望有任何支持），我将它发布在这里是为了完整起见。

现在，如果有人对一个确定性的函数有一个想法，`expand`并且不会只是复制 MvG 的方法（使`calc`函数变得无用），我会全力以赴！

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
   "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<title>ErikE's answer</title>
</head>
<body>
<div id="output"></div>
<script type="text/javascript">
if (!Array.each) {
   Array.prototype.each = function(callback) {
      var i, l = this.length;
      for (i = 0; i < l; i += 1) {
         callback(i, this[i]);
      }
   };
}

if (!Array.prototype.sum) {
   Array.prototype.sum = function() {
      var sum = 0;
      this.each(function(i, val) {
         sum += val;
      });
      return sum;
   };
}

function expand(counts) {
   var
      result = "",
      charlist = [],
      l,
      index;
   counts.each(function(i, val) {
      char = String.fromCharCode(i + 65);
      for ( ; val > 0; val -= 1) {
         charlist.push(char);
      }
   });
   l = charlist.length;
   for ( ; l > 0; l -= 1) {
      index = Math.floor(Math.random() * l);
      result += charlist[index];
      charlist.splice(index, 1);
   }
   return result;
}

function calc(n, proportions) {
   var percents = [],
      counts = [],
      errors = [],
      fnmap = [],
      errorSum,
      worstIndex;

   fnmap[1] = "min";
   fnmap[-1] = "max";

   proportions.each(function(i, val) {
      percents[i] = val / proportions.sum() * n;
      counts[i] = Math.round(percents[i]);
      errors[i] = counts[i] - percents[i];
   });

   errorSum = counts.sum() - n;
   while (errorSum != 0) {
      adjust = errorSum < 0 ? 1 : -1;
      worstIndex = errors.indexOf(Math[fnmap[adjust]].apply(0, errors));
      counts[worstIndex] += adjust;
      errors[worstIndex] = counts[worstIndex] - percents[worstIndex];
      errorSum += adjust;
   }
   return expand(counts);
}

document.body.onload = function() {
   document.getElementById('output').innerHTML = calc(99, [25.1, 24.9, 25.9, 24.1]);
};
</script>
</body>
</html> 
```

# javascript - jqvmap - 除非在浏览器控制台中调用，否则不会触发 regionclick 方法

> ID：11421284
> 
> 赞同：0
> 
> 时间：2012-07-10T20:19:08.123
> 
> 标签：javascript, jquery

我正在使用 JQVMap 插件 (http://jqvmap.com/) 创建地图。该插件有一个名为 onRegionClick 的方法，如果选择了地图上的区域，您可以调用该方法。

我正在使用名为 loadSlide 的函数动态加载地图，但由于某种原因，没有调用 onRegionClick 方法，也没有调用我之后调用的 bind 方法。奇怪的是，如果我在页面加载后将该绑定方法加载到我的浏览器控制台中，它会很好用。

如有必要，我很乐意提供更多代码/上下文，但我对此束手无策。任何熟悉此插件并有此问题经验的人？谢谢！

相关代码如下：

```
function loadSlide(url,data) {
data.slide_id = $('#slide-data input#slide_id').val();
$.getJSON(url, data, function(response) {
    $('#slide-content').replaceWith(response.html);

        if ( $("#vmap").length > 0 ) {

              $('#vmap').vectorMap({
                map: 'usa_en',
                backgroundColor: null,
                color: '#6a1912',
                hoverColor: '#fdb33f',
                selectedColor: '#fdb33f',
                enableZoom: true,
                showTooltip: true,
                onRegionClick: function(event, code, region) {
                    event.preventDefault();
                    $('input[type=hidden]#state-click').val(code.toUpperCase());
                    console.log($('input[type=hidden]#state-click').val());
                }
            });

            $('#vmap').bind('regionClick.jqvmap', function(event, code, region) {
                $('input[type=hidden]#state-click').val(code.toUpperCase());
                console.log($('input[type=hidden]#state-click').val());
            });

            setClickHandlers();
        }
    });
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T23:28:25.730

我知道这是一个老问题，但我敢打赌问题是 Console.log 行？

# javascript - 无法让 jqPlot 图表显示变量中的线

> ID：11421287
> 
> 赞同：0
> 
> 时间：2012-07-10T20:19:21.447
> 
> 标签：javascript, jqplot

我正在使用 jqPlot 在我的 webApp 中绘制一些点，所以我正在尝试这个：

```
var plot10 = $.jqplot ('heightChartDiv', [[3,7,9,1,5,3,8,2,5]]); 
```

[它工作正常，我这里](http://www.jqplot.com/tests/line-charts.php)有这个确切的图表

但是当我把它拿出来时，给它一个价值，就像这样：

```
$(document).ready(function(){
var serie1 = [[3,7,9,1,5,3,8,2,5]];
}

function doGraph(){
 var plot10 = $.jqplot ('heightChartDiv', serie1);
} 
```

它不起作用。我声明变量错误吗？请帮忙！

～喵喵

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T00:25:12.870

您的变量范围已全部关闭。该变量具有事件中`serie1`定义的匿名函数的局部范围。[在此处](https://stackoverflow.com/questions/500431/javascript-variable-scope)和[此处](http://robertnyman.com/2008/10/09/explaining-javascript-scope-and-closures/)`$(document).ready`阅读 javascript 范围。

也许是这样的：

```
// the document ready will fire when the page is finished rendering
// inline javascript as you've done with your doGraph will fire as the page renders
$(document).ready(function(){

  // first define graph function
  // make the series an argument to the function
  doGraph = function(someSeries){
    var plot10 = $.jqplot ('heightChartDiv', someSeries);
  }

  // now call the function with the variable
  var serie1 = [[3,7,9,1,5,3,8,2,5]];
  doGraph(serie1);

} 
```

**回应评论的编辑**

请参阅下面的示例：

```
$(document).ready(function(){

  var a = 1;

  someFunc = function(){
    var b = 2;
    alert(a);                   
  }

  someFunc();  // this works
  alert(b);  // this produces an error

});​ 
```

这里变量 a 被认为是函数 someFunc 的全局变量。但是，在 someFunc 中声明的变量不会在它之外持续存在。

# ruby-on-rails - Rails Model.create SQLite3::SQLException

> ID：11421295
> 
> 赞同：2
> 
> 时间：2012-07-10T20:19:40.497
> 
> 标签：ruby-on-rails, sqlite, migration

我是 Rails 的初学者，使用 Rails 的迁移将行插入数据库时​​遇到问题。

```
class Actions < ActiveRecord::Migration
  def up
    create_table :actions do |t|
      t.integer :channel_id
      t.string :name
      t.text :description
      t.integer :weight

      t.timestamps
    end

    add_index :actions, :channel_id

    Actions.create :name => 'name', :description => '', :weight => 1, :channel_id => 1
  end 
```

运行此代码会导致：

```
==  Actions: migrating ========================================================
-- create_table(:actions)
   -> 0.0076s
-- add_index(:actions, :channel_id)
   -> 0.0036s
-- create({:name=>"name", :description=>"", :weight=>1, :channel_id=>1})
rake aborted!
An error has occurred, this and all later migrations canceled:

SQLite3::SQLException: unrecognized token: "{": {:name=>"name", :description=>"", :weight=>1, :channel_id=>1} 
```

动作模型：

```
class Actions < ActiveRecord::Base
  belongs_to :channels
  attr_accessible :name, :description, :weight, :channel_id
end 
```

我不知道大括号来自哪里以及它们为什么会导致异常。谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-10T20:27:20.727

哦，看来您的*迁移*类名称与您尝试访问的*模型*的名称相同（ `Actions`）。因此，将在*迁移类上调用该方法而不是**模型类*，该`create`方法可能会尝试使用您的哈希或其他东西创建一个表。这就是您收到该错误消息的原因。

 *重命名您的迁移类（以及为了一致性起见的文件），它应该可以正常运行：

```
class CreateActions < ActiveRecord::Migration 
```*

# ms-access - MS Access 2007 添加一个新的控制字段来报告

> ID：11421299
> 
> 赞同：0
> 
> 时间：2012-07-10T20:20:22.987
> 
> 标签：ms-access, ms-access-2007

我使用 MS Access 中的报告向导制作了一份报告。生成报告后，我意识到我想从表中添加另一个值（该表已在报告中使用），我在生成报告时没有包含在报告向导中。我尝试使用控制源选项添加新值，但未能显示。请以任何方式提供帮助！非常感谢您的参与。我要添加的值在表“tblAuthor”值“流派”中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T20:24:50.923

在设计视图中打开报表并检查表的记录源。如果是查询，您可以使用三个点 (...) 对其进行编辑并确保它包含流派。如果是表，大概是包括 Genre 的。然后，您可以使用添加现有字段向报表添加控件。

# php - 在 foreach 循环中更正我的自动增量

> ID：11421303
> 
> 赞同：2
> 
> 时间：2012-07-10T20:20:40.600
> 
> 标签：php, magento, commission-junction

我有一个脚本循环遍历订单数组，内部循环遍历该特定订单中的所有项目。在脚本结束时，我需要将一个字符串与所有项目数据连接起来，每个项目数据都有一个唯一标识符。当我通过第一个订单时，我的问题就出现了。

我们将假设此循环将遍历 3 个订单。这是我的例子：

```
foreach ($_orders as $order)
{
$oid = $order['id'];
$i = 1;
foreach ($order['items'] as $item)
         {
            $cjItemStr .= '&ITEM'. $i . '=' . $item['sku'] . '&AMT' . $i . '=' . $item['price'] . '&QTY' . $i . '=' . $item['qty'];
            $i++;
         }
} 
```

这将正确输出我需要的 1 个订单。该字符串将显示为：

&ITEM1=TT-5555&AMT1=5.00&QTY1=2&ITEM2=TT-3333&AMT2=10.00&QTY2=1&ITEM3=TT-2222&AMT3=15.00&QTY3=1

这对一个订单很有用，但是一旦我进入下一个订单，我需要增量器从另一个订单停止的地方继续。它需要移动到 ITEM4、AMT4、QTY4、ITEM5、AMT5、QTY5 等。现在它只是回到 1。有人知道我该如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-10T20:22:49.880

只需将您的初始化移到`$i`外循环之外。

```
// Initialize $i outside the first loop:
$i = 1;
foreach ($_orders as $order)
{
  $oid = $order['id'];
  foreach ($order['items'] as $item)
  {
     $cjItemStr .= '&ITEM'. $i . '=' . $item['sku'] . '&AMT' . $i . '=' . $item['price'] . '&QTY' . $i . '=' . $item['qty'];
     // And increment $i for each order item
     $i++;
  }
}
// Assuming count($_orders) == 3 and each has count($order['items'] == 3)
// $i is now 10 after all loops complete. 
```

但是，如果您需要在每次运行此脚本`$i`后保留的值，则需要将其存储在某处，例如将其写入文本文件或将其粘贴到数据库中*。*就像现在一样，任何时候你运行这个脚本，你都从`$i = 0`

最后，我不确定 Magento 是如何处理数组元素的，但是如果这个查询字符串要由 PHP 解析，您可以将其格式化为每个元素都是一个数组。然后在收到时，`$_GET['ITEM'][]`例如访问。

```
 // Surrounding each with [] will allow PHP to process them as arrays in the script that receives this
 $cjItemStr .= '&ITEM['. $i . ']=' . $item['sku'] . '&AMT[' . $i . ']=' . $item['price'] . '&QTY[' . $i . ']=' . $item['qty']; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-10T20:22:59.443

如果我正确理解你的逻辑，你只需要在所有循环之外初始化你的计数器：

```
$i = 1;
foreach ($_orders as $order) {
    $oid = $order['id']; 
```

否则，它会在每个订单上重新设置为 1。

# installation - Installshield Silent Uninstall not working at Command Line

> ID：11421306
> 
> 赞同：9
> 
> 时间：2012-07-10T20:20:53.360
> 
> 标签：installation, installshield, uninstallation

We have an older app from 2006 we'd like to uninstall at the command line using group policy, but I can't get a silent uninstall to work.

This works. Of course I need to click Next to uninstall:

```
 "C:\App\Setup.exe" /uninst 
```

But this does not. I see an hourglass for a couple seconds but the app is not uninstalled.

```
 "C:\App\Setup.exe" /uninst /s 
```

I also unsuccessfully tried some VBScripts. They find the app listed but the uninstall fails. I'm not too familiar with how this process is supposed to work.

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-11T12:47:51.740

您需要先创建一个 ISS 响应文件以静默删除您的应用程序，

1.  创建响应文件： `C:\App\Setup.exe /r /f1c:\app\uninstall1.iss` 您将被要求卸载，....并可能回复其他窗口。然后你的应用程序将被卸载，你会得到一个新的响应文件 c:\app\uninstall1.iss

2.  接下来，如果您想在另一台计算机上静默删除此应用程序：启动：`C:\App\Setup.exe" /s /f1c:\app\uninstall1.iss`

有关更多信息，请参阅：

[http://www.itninja.com/blog/view/installshield-setup-silent-installation-switches](http://www.itninja.com/blog/view/installshield-setup-silent-installation-switches)

最好的问候， 斯蒂芬

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-03-03T16:25:29.690

试试这个，使用用于安装**的原始 setup.exe版本**

```
"C:\App\Setup.exe" /x /s /v/qn 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-04-29T14:16:53.060

我一直在为静默卸载程序苦苦挣扎，终于找到了一个在大多数情况下都适用于我的解决方案，无论是对于 InstallShield v6 还是 v7。

**1.**首先（如上所述），您必须生成一个InstallShield 响应文件（例如uninstall.iss）。为此，您必须使用参数启动 setup.exe：

```
> setup.exe -x -r -f1"C:\Your\Installer\Location\uninstall.iss" 
```

这将通过正常的卸载向导并为您生成一个响应文件：*uninstall.iss*

**2.**然后，在尝试您的静默卸载程序之前，我想您应该重新安装该软件。

**3.**最后，运行您的静默卸载程序，播放最近生成的响应文件：

```
> setup.exe -x -s -l0x9 -ARP -f1"C:\Your\Installer\Location\uninstall.iss" 
```

而已。

**现在，一些重要的注意事项：**

***注意 1：***我正在使用我自己没有构建的 3 方安装包。

***注 2：*** 我使用破折号 (-) 而不是斜杠 (/) 来定义参数。出于某种原因，它不适用于我的斜杠。奇怪但真实。

***注意 3：***某些安装包**需要-ARP**和**-l**开关来管理从“添加/删除程序”列表中删除的软件，并相应地预设默认输入语言。

**成功的静默卸载完全取决于正确的参数！** 因此，请继续探索，正确的参数取决于特定的包和安装程序版本。

我希望我的意见是有帮助的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-13T01:28:43.540

尝试格式：Setup.exe **M{Your Product GUID}** /s /f1[Full path]\*.iss 用于创建用于卸载的 ISS 文件。从 Stephanie 的示例中，我认为它缺少 GUID。

开发者网站[@Creating the Response File](http://kb.flexerasoftware.com/doc/Helpnet/installshield12helplib/CreatetheResponseFile.htm)有一个很好的链接。

试试看告诉我们，

汤米奎

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-09-08T08:36:17.907

还有另一种卸载应用程序的方法，方法是在注册表中搜索应用程序并使用 UninstallString（此示例代码在 windows 10 上使用 powershell）：

```
# Get all installed apps from Registry
$Apps = @()
$Apps += Get-ItemProperty "HKLM:\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall\*" # 32 Bit
$Apps += Get-ItemProperty "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\*"             # 64 Bit

# Uninstall My App
$my_app = $Apps | Where-Object{$_.DisplayName -eq "The Name Of My App"}
$uninstall_string = " /C " + $my_app.UninstallString+' /S'
Start-Process -FilePath "cmd.exe" -ArgumentList $uninstall_string -Wait 
```

如果您不知道应用程序的确切完整显示名称，您可以将“应用程序”数组打印到文件中，并在那里搜索：

```
$Apps | Out-File C:\filename.txt 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-07-16T14:50:02.937

我为此苦苦挣扎了很长时间，所以把它贴在这里以防其他人偶然发现它。

如果您碰巧有一个使用传统*Package-For-The-Web*格式的安装程序，那么您需要使用该参数`-a`将其他参数传递给提取的安装文件。

记录（卸载）安装文件（手动点击安装程序）：

```
.\DWG2PDF2019.exe -a /r /f1"c:\app\dwg2019_install.iss"
.\DWG2PDF2019.exe -a /r /f1"c:\app\dwg2019_uninstall.iss" 
```

静默（卸载）安装：

```
.\DWG2PDF2019.exe -s -a /s /f1"c:\app\dwg2019_install.iss"
.\DWG2PDF2019.exe -s -a /s /f1"c:\app\dwg2019_uninstall.iss" 
```

来源：[https ://help.hcltechsw.com/caa/3.0/topics/appacc_silent_install_t.html](https://help.hcltechsw.com/caa/3.0/topics/appacc_silent_install_t.html)

# ruby-on-rails - How can I redirect root based upon role using Rolify?

> ID：11421308
> 
> 赞同：2
> 
> 时间：2012-07-10T20:21:12.150
> 
> 标签：ruby-on-rails, authentication, device, cancan

I tried to follow [this answer](https://stackoverflow.com/a/4753922/1393002) to a similar question but in my case I'm using [Rolify](https://github.com/EppO/rolify).

The problem I'm running into is in `passthrough_controller.rb` where I can't access the Rolify `.has_role?` function:

```
class PassthroughController < ApplicationController
  def index
    if current_user.has_role? :admin
      redirect_to 'restaurants#index'
    else
      redirect_to 'http://www.google.com'
    end
  end
end 
```

I have logged in using a user that I know has an admin role but it still redirects me to my `else` clause.

I couldn't find anything on the [Rolify github](https://github.com/EppO/rolify) page on how to do this.

Any help would be much appreciated

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-30T14:29:01.333

看起来您可以只使用渲染来执行此操作，而不是使用路由或重定向。

```
def index
    if current_user.has_role? :admin
      render "admin" # where admin.html.erb is in the same folder as index.html.erb
    else
      # do nothing - render default view
    end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T22:47:52.060

解决方案实际上非常简单。

我只需要在 my前面`restaurants#index`加上 a`/`所以我的代码应该是这样的：

```
 def index
    if current_user.has_role? :admin
      redirect_to '/restaurants#index'
    else
      redirect_to 'http://www.google.com'
    end
  end 
```

我一开始没有前缀，因为这就是我在`routes.rb`( `root :to => 'restaurants#index'`)中定义我的根的方式

# validation - Validate $.getJSON before its being sent to the server in JQmobile

> ID：11421310
> 
> 赞同：1
> 
> 时间：2012-07-10T20:21:29.560
> 
> 标签：validation, jquery-mobile, getjson

I'm trying to Validate my form before it's being sent to the server. I tried couple of J/S plugins for regular validation and none of them seem to work.

I tried looking for `getJSON` validation method with jquerymobile but haven't seen anything related. Is using `$.getJSON` the right approach?

Here is a fiddle [http://jsfiddle.net/Kimbley/kMsXK/2/](http://jsfiddle.net/Kimbley/kMsXK/2/)

Thanks :D

Code Here:

```
 function mAddBusiness() {
        $.getJSON("API.php", {
            command: "addBusiness",
            bsnName: $("#mBsnName").attr("value"),
            bsnCity: $("#mBsnCity").attr("value"),
            bsnAddress: $("#mBsnAddress").attr("value"),
            bsnMenu: $("#mBsnMenu").attr("value"),
            bsnLat: bsnLat,
            bsnLong: bsnLong
        },
            function () {
            $("#mBsnName").attr("value", "");
            $("#mBsnCity").attr("value", "");
            $("#mBsnAddress").attr("value", "");
            $("#mBsnMenu").attr("value", "");
            alert("Business was added successfully ");
        }
            );
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T20:25:46.307

在您的`mAddBusiness()`函数中，您可以在发送 AJAX 请求之前进行验证。就像是：

```
function mAddBusiness() {
    if ($("#mBsnName").val() !== '') {
        $.getJSON("API.php", {
            command: "addBusiness",
            bsnName: $("#mBsnName").val(),
            bsnCity: $("#mBsnCity").val(),
            bsnAddress: $("#mBsnAddress").val(),
            bsnMenu: $("#mBsnMenu").val(),
            bsnLat: bsnLat,
            bsnLong: bsnLong
            },
            function () {
                $("#mBsnName").val("");
                $("#mBsnCity").val("");
                $("#mBsnAddress").val("");
                $("#mBsnMenu").val("");
                alert("Business was added successfully ");
            }
        );
    } else {
        alert('Please enter a business name.');
    }
} 
```

请注意，您必须将`data-ajax="false"`属性添加到相关`<form>`标记中，以便 jQuery Mobile 不会尝试提交表单本身。

另外，请注意`$('input').attr('value')`，它不会返回输入的当前值，它会在用户有机会输入任何内容之前返回初始值。要获取表单输入的当前值，请使用`.val()`：[http ://api.jquery.com/val](http://api.jquery.com/val)

# google-app-engine - 如何使用 NDB 的 id 属性？

> ID：11421311
> 
> 赞同：1
> 
> 时间：2012-07-10T20:21:30.397
> 
> 标签：google-app-engine, app-engine-ndb

对于旧数据存储，我使用了密钥。现在我必须使用 ids（取自[NDB Cheat Sheet doc](https://docs.google.com/document/d/1qGgoBlSvd3sUxz2PgWJVeEHBRPzsLh-haHConITDHZU/edit)）：

```
user = User.get_by_id(user_id)
if user is None:
    user = User(id=user_id) 
```

但看起来这段代码不起作用 - 记录被添加了几次。

（在我的情况下，user_id 是字符串）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T15:35:45.353

我找到了原因，我上面的代码是正确的，但是我的类包含 id 属性：

```
class User(ndb.Model):
    id = ndb.StringProperty() 
```

这就是问题所在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T01:56:41.247

请参阅 NDB 备忘单的“构建密钥”部分。

```
user = ndb.Key('User', user_id).get()
if user is None:
  user = User(id=user_id) 
```

或试试这个，让我知道它是否有效：

```
user = User.get_by_id(user_id)
  if user is None:
  user = User(id=user_id) 
```

顺便说一句，即使 user_id 是您应该使用的字符串`'%s' % user_id`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-11T02:29:43.057

听起来你想要一个事务操作：

```
user = User.get_or_insert(user_id) 
```

# scala - Scala pattern match on the type of two bind variables

> ID：11421314
> 
> 赞同：3
> 
> 时间：2012-07-10T20:21:43.140
> 
> 标签：scala

I have two variables of unknown type. I want to do a pattern match on the combination of the variable types, and then take action based on that -- specifically, I want to implement `Comparator[Any]` and compare the two variables based on their type. This code produces the desired result:

```
class SomethingComparator extends util.Comparator[Any] {
  override def compare(o1: Any, o2: Any) = List(o1, o2).map(_.isInstanceOf[Something]) match {
    case List(true, true) => o1.asInstanceOf[Something].someInt.compareTo(o2.asInstanceOf[Something].someInt)
    case List(true, false) => -1
    case List(false, true) => 1
    case _ => 0
  }
} 
```

Is there a way to avoid the `map` call and pattern match on the types directly, and therefore avoid the two `asInstanceOf` calls in the first match?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-10T20:21:43.637

This works:

```
class SomethingComparator extends util.Comparator[Any] {
  override def compare(o1: Any, o2: Any) = (o1, o2) match {
    case (o1:Something, o2:Something) => o1.someInt.compareTo(o2.someInt)
    case (o1:Something, o2:Any) => -1
    case (o1:Any, o2:Something) => 1
    case _ => 0
  }
} 
```

# mysql - mysql query building to get 2 different data from single column

> ID：11421321
> 
> 赞同：2
> 
> 时间：2012-07-10T20:21:57.570
> 
> 标签：mysql

Guys i m having a table in which i have gender and date columns as described. now i wan to count both male n females registered in particular month,so how can i make my query for that.

```
mysql> select id,gender,entrydate from patient_master;

+----+--------+------------+
| id | gender | entrydate  |
+----+--------+------------+
|  1 | Male   | 2012-07-02 |
|  2 | Female | 2012-05-10 |
|  3 | Male   | 2012-05-25 |
|  4 | Female | 2012-07-09 |
|  5 | Male   | 2012-07-10 |
|  6 | Female | 2012-07-10 |
|  7 | Male   | 2012-07-10 |
+----+--------+------------+ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-10T20:24:14.113

```
select gender, count(id) as`count` 
from patient_master
where month(entrydate) = 1 and year(entrydate) = 2012
group by gender 
```

月份`1`= 一月，`2`= 二月...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T20:24:23.893

要获得所有月份的结果：

```
SELECT YEAR(entrydate) AS yr, MONTH(entrydate) AS mnth, gender, COUNT(*) AS cnt
FROM patient_master
GROUP BY YEAR(entrydate), MONTH(entrydate), gender 
```

如果您想要一年中的所有月份：

```
SELECT MONTH(entrydate) AS mnth, gender, COUNT(*) AS cnt
FROM patient_master
WHERE YEAR(entrydate) = 2012
GROUP BY MONTH(entrydate), gender 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-10T20:30:46.433

```
SELECT
    date_format(entrydate,'%Y-%m-%b') YearMonth,
    gender,COUNT(1) GenderCount
FROM
    patient_master
GROUP BY
    date_format(entrydate,'%Y-%m-%b'),gender
; 
```

这是您的示例数据

```
mysql> CREATE TABLE patient_master
    -> (
    ->     id int not null auto_increment,
    ->     gender varchar(10),
    ->     entrydate date,
    ->     primary key (id)
    -> );
Query OK, 0 rows affected (0.06 sec)

mysql> INSERT INTO patient_master (gender,entrydate) VALUES
    -> ('Male'  ,'2012-07-02'),
    -> ('Female','2012-05-10'),
    -> ('Male'  ,'2012-05-25'),
    -> ('Female','2012-07-09'),
    -> ('Male'  ,'2012-07-10'),
    -> ('Female','2012-07-10'),
    -> ('Male'  ,'2012-07-10');
Query OK, 7 rows affected (0.06 sec)
Records: 7  Duplicates: 0  Warnings: 0 
```

这是输出

```
mysql>     SELECT
    ->         date_format(entrydate,'%Y-%m-%b') YearMonth,
    ->         gender,COUNT(1) GenderCount
    ->     FROM
    ->         patient_master
    ->     GROUP BY
    ->         date_format(entrydate,'%Y-%m-%b'),gender
    ->     ;
+-------------+--------+-------------+
| YearMonth   | gender | GenderCount |
+-------------+--------+-------------+
| 2012-05-May | Female |           1 |
| 2012-05-May | Male   |           1 |
| 2012-07-Jul | Female |           2 |
| 2012-07-Jul | Male   |           3 |
+-------------+--------+-------------+
4 rows in set (0.02 sec)

mysql> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-10T20:31:10.833

@juergen_d 是对的。

他的查询将返回：

```
+--------+--------+
| gender | count  |
+--------+--------+
| Male   |  1     |
| Female |  1     |
+--------+--------+ 
```

# asp.net-mvc-3 - Scaffolding Get-ProjectType not recognized as the name of a cmdlet

> ID：11421324
> 
> 赞同：2
> 
> 时间：2012-07-10T20:22:14.123
> 
> 标签：asp.net-mvc-3, powershell, asp.net-mvc-4, scaffolding, asp.net-mvc-scaffolding

just tried to get the basic basics up and running and getting some fancy error conditions - most probably some basic steps are screwed up but I don't see the point - so some hints are highly appreciated.

**So whats the setup?**

*   VS2010
*   MVC3 or MVC4 Project - no strings attached, just the templates
*   Create a really simple Model-Class Team like shown on [http://blog.stevensanderson.com/2011/01/13/scaffold-your-aspnet-mvc-3-project-with-the-mvcscaffolding-package/](http://blog.stevensanderson.com/2011/01/13/scaffold-your-aspnet-mvc-3-project-with-the-mvcscaffolding-package/)

**What happens?**

Try (after installing MvcScaffolding through NuGet Console) to call:

```
Scaffold Controller Team 
```

And get the following error:

```
PM> Scaffold Controller Team
Scaffolding TeamsController...
Invoke-Scaffolder : The term 'Get-ProjectType' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or
if a path was included, verify that the path is correct and try again.
At O:\Code\Resource\packages\MvcScaffolding.1.0.7\tools\Controller\MvcScaffolding.Controller.ps1:66 char:40
+         $dbContextScaffolderResult = Scaffold <<<<  DbContext -ModelType $foundModelType.FullName -DbContextType $DbContextType -Area $Area -Project $Project -CodeLang
uage $CodeLanguage -BlockUi
    + CategoryInfo          : NotSpecified: (:) [Invoke-Scaffolder], CommandNotFoundException
    + FullyQualifiedErrorId : T4Scaffolding.Cmdlets.InvokeScaffolderCmdlet 
```

Fancy thing: of course Get-ProjectType itself seems to work (see below), so I'm kind of stuck right now - as this looks like a powershell issue somehow but the cmdlet itself works at least if called directly but not when inside the script? Any hints would be greatly appreciated!

Thanks a lot.

```
PM> Get-ProjectType
cmdlet Get-ProjectType at command pipeline position 1
Supply values for the following parameters:
Type: Team

DTE                   : System.__ComObject
Collection            : System.__ComObject
Name                  : Team
FullName              : Resource.Models.Team
ProjectItem           : System.__ComObject
Kind                  : 1
IsCodeType            : True
InfoLocation          : 1
Children              : System.__ComObject
Language              : {B5E9BD34-6D3E-4B5D-925E-8A43B79820B4}
StartPoint            : System.__ComObject
EndPoint              : System.__ComObject
ExtenderNames         : 
ExtenderCATID         : 
Parent                : System.__ComObject
Namespace             : System.__ComObject
Bases                 : System.__ComObject
Members               : System.__ComObject
Access                : 1
Attributes            : System.__ComObject
DocComment            : <doc>
                        </doc>
Comment               : 
DerivedTypes          : 
ImplementedInterfaces : System.__ComObject
IsAbstract            : False
ClassKind             : 1
PartialClasses        : System.__ComObject
DataTypeKind          : 1
Parts                 : System.__ComObject
InheritanceKind       : 0
IsGeneric             : False
IsShared              : False

PM> 
```

With Kind Regards, Ives

# javascript - ignore text from input onfocus

> ID：11421325
> 
> 赞同：0
> 
> 时间：2012-07-10T20:22:19.533
> 
> 标签：javascript, css

I've a snag , here it is simple case

```
<input type="text" id="some" value="something"> 
```

and javascript

```
document.getElementById("some").onfocus = function(){
    this.style.opacity = 0.5;
}; 
```

It works just fine , but I want also that during this time (onfocus) mouse pointer be at the beginning of input field ( I mean to ignore default value , not to continue from "something") , any ideas ? thanks :))

P.S This is the just same like it is on facebook search, when focus search field and the default text become dim and the pointer moves at the beginning of input field

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T20:57:37.787

你可以使用这个事件来做这样的`onkeypress`事情。授予不是最伟大的代码，但它应该让你开始。

HTML：

```
<input type="text" id="some" value="something"> 
```

​ Javascript：

```
i = 1;
document.getElementById("some").onkeypress= function(){    
    if(i === 1) {
        document.getElementById("some").value = '';
        i = 0;
    }
    this.style.color = 'black';
}

document.getElementById("some").onfocus = function(){
    this.style.color = 'gray';
}; 
```

​ JS 小提琴：http: [//jsfiddle.net/wZAvn/](http://jsfiddle.net/wZAvn/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T20:33:18.047

或类似的东西：

```
var some = document.getElementById("some"),
val = some.value; 
some.onfocus = function(){
    some.style.opacity = 0.5;
    some.value = (some.value == val )?"":some.value;        
};​ 
```

[http://jsfiddle.net/w5Kv8/1/](http://jsfiddle.net/w5Kv8/1/)

# c# - JuiceUI implementation on a Virtual Directory in IIS

> ID：11421328
> 
> 赞同：0
> 
> 时间：2012-07-10T20:22:31.227
> 
> 标签：c#, jquery, asp.net, .net, juice-ui

**General Description :**

I have installed JuiceUI on a local build of a web form application in asp.net in Visual Studio 2010\. What I want to do is take this application and add it to a virtual directory that has been setup for me. I have JuiceUI working on my local version, but it does not load the AJAX (such as the datepicker [i.e. calendar]) on the virtual directory.

Any help to get this loaded onto the virtual directory would be very much appreciated.

**Details I know to give at the moment :**

This is a web form application. To deploy to the virtual directory, I copy and paste the directory of my code into the directory space on the server. Therefore my bin folders and jquery are loaded on my app folder. I have configured the parent website web.config membership provider so that I can connect and access my app. So I have had my page working just fine on the virtual directory. I installed JuiceUI on my local build and was now copying it to the website to realize that none of the ajax functionality was working.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T16:27:10.290

我想说第一步是验证浏览器是否正在加载必要的 js 和 css 文件。使用 chrome 检查器或 firefox+firebug 并在资源上查找任何 404。如果脚本和 css 没有加载，那么您需要调整它们在代码中的位置以匹配您的设置。

# c# - How to draw this path?

> ID：11421330
> 
> 赞同：0
> 
> 时间：2012-07-10T20:22:48.780
> 
> 标签：c#, xaml, path, styles, shape

I´m trying to get the exact shape or path from the following image.

I was using Visual Studio but it still makes me difficult to write point by point.

I guess there´s another way or software to draw this better, and a little hand about how would be those points in xaml.

Thanks in advance!

![enter image description here](../Images/95bd670f0be38b3f651b14477bfde73f.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T01:08:50.640

为了回答你问题的第一部分，这里有一个例子（你可以使用 Stroke & Fill Color 显然得到你想要的。）

WPF 示例：

```
<Path StrokeThickness="1.0" Stroke="#fffbaf3f" StrokeMiterLimit="1.0" Fill="#fff7931d" Data="F1 M 0.500,0.500 L 0.500,30.500 L 23.340,30.500 L 29.750,40.000 L 36.750,30.500 L 120.500,30.500 L 120.500,0.500 L 0.500,0.500 Z"/> 
```

至于您问题的第二部分，我个人主要使用 Adob​​e Illustrator 和 Mike Swanson 制作的 XAML Exporter 插件（[http://www.mikeswanson.com/XAMLExport](http://www.mikeswanson.com/XAMLExport)）

或者，我也经常将 Microsoft Expression Blend 用于各种相关的事情。希望这可以帮助。

# jquery - jQuery 移动临时页面缓存

> ID：11421339
> 
> 赞同：1
> 
> 时间：2012-07-10T20:23:21.960
> 
> 标签：jquery, forms, jquery-mobile, modal-dialog

根据jQuery [docs](http://jquerymobile.com/demos/1.1.0/docs/pages/page-cache.html%5d)调用

```
pageContainerElement.page({ domCache: true }); 
```

将以编程方式缓存特定页面。[但是，正如这个github issue](https://github.com/jquery/jquery-mobile/issues/4052)正确指出的那样，如果在`pagecreate`事件之后调用，这将不起作用。

从我的应用程序的主页，用户可以进入另一个页面，在那里他们可以将信息放入其中。此表单上有一个用于模式弹出窗口的按钮，用户可以从中选择某些标签。当此模式关闭并且用户返回到表单时，它会被重置，因为页面已被删除并重新添加。

我可以做的一件事是用表单缓存页面，这样数据就不会被清除。以编程方式执行此操作的唯一方法是

```
function cachePage() { $('#tags').closest('div[data-role=page]').page({ domCache: true }); }
$(document).on('pagebeforecreate', cachePage); 
```

假设 #tags 只是我要缓存的页面上的一个元素。但是，我现在无法取消缓存页面并让 jQM 清理它。

我想知道我是否正确地解决了这个问题，如果是，如何处理这个页面缓存和禁用。如果我没有正确处理它，我该如何获取它以便保留我的表单并且我仍然可以从模式弹出窗口或附加页面获取表单信息？

# 编辑

我最近发现的一件事是 jQM 将在 DOM 中保留一个“根”页面，然后是它在表面上加载的任何其他页面。如果我添加`data-ajax='false'`到表单的所有链接，它们应该可以安全地与任何调用它们的模式一起使用。此外，可以使用相同的方式提交它们`data-ajax='false'`以重定向到另一个页面，而无需标题栏的后退按钮返回到表单。

这是否比缓存表单页面或将表单数据存储在 JavaScript 中并在加载时重新填充表单更好的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-10T20:31:34.333

如果您有一个伪页面，并且您知道要在 DOM 中持久化，请将`data-dom-cache="true"`属性添加到伪页面元素中。文档：http: [//jquerymobile.com/demos/1.1.0/docs/pages/page-cache.html](http://jquerymobile.com/demos/1.1.0/docs/pages/page-cache.html)

如果要删除 DOM 中已缓存的伪页面，请使用`.remove()`：

```
$('#some-page').remove(); 
```

> 除了元素本身，所有与元素关联的绑定事件和 jQuery 数据都将被删除。要删除元素而不删除数据和事件，请改用 .detach()。

*来源：[http ://api.jquery.com/remove/](http://api.jquery.com/remove/)*

从 DOM 中删除伪页面后，jQuery Mobile 将无法找到它，并且会在您下次导航到伪页面时从外部文档中获取新版本。

# internet-explorer - Internet explorer gradients coming out blue

> ID：11421340
> 
> 赞同：1
> 
> 时间：2012-07-10T20:23:23.367
> 
> 标签：internet-explorer, css

A few elements of my webpage are rendering blue in IE 8 for some reason, i thought it was due to me using the rgba styling instead of rgb, but i removed it and still renders blue. Works perfect on every other browser including mobile ones. Heres the site:

[http://www.morzi.com/constantine](http://www.morzi.com/constantine)

Thanks a bunch

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T20:25:54.207

想通了，正在使用过滤器而不是 -ms-filter

# wpf - 根据数据值更改 ItemsControl ItemsTemplate

> ID：11421341
> 
> 赞同：0
> 
> 时间：2012-07-10T20:23:24.920
> 
> 标签：wpf, xaml

我有一个绑定到 Dictionary 的 ItemsControl，并且正在尝试根据 Dictionaries 键的值应用模板。我正在尝试做：

```
<ItemsControl ItemsSource="{Binding Path=CommonItems, Mode=OneWay}">
    <ItemsControl.Style>
        <Style TargetType="ItemsControl">
            <Style.Triggers>
                <DataTrigger Binding="{Binding Path=Key}" Value="authentication">
                    <Setter Property="ItemTemplate" Value="{StaticResource AuthenticationTemplate}"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </ItemsControl.Style>
</ItemsControl> 
```

这根本不起作用，我的错误说 Key 在 ItemsControl 上不存在。这让我相信它正在使用我的 TargetType 来搜索绑定。那么我该如何做到这一点并让它实际使用 ItemsSource？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T20:47:06.853

如果您想按项目执行此操作，我建议使用[`ItemTemplateSelector`](http://msdn.microsoft.com/en-us/library/system.windows.controls.itemscontrol.itemtemplateselector.aspx).

# jquery - jquery 关于动态元素的提示

> ID：11421342
> 
> 赞同：2
> 
> 时间：2012-07-10T20:23:32.680
> 
> 标签：jquery, cluetip

我似乎无法让它正常工作。

我正在编写几个指向 DOM 的链接（循环通过 json 文件并附加到 DOM），然后我需要这些元素在悬停时触发工具提示。

我在任何地方都没有看到这种方法的一个很好的例子——线索提示网站显示了一个简短的例子，寻找 a 然后调用线索提示。我认为必须有一个 .live 或 .delegate 方式来做到这一点：

```
$("body").delegate("a.toolTip", "mouseover", function (event) {

            $('a.toolTip').cluetip({
                showTitle: false,
                attribute: 'title',
                local: false
                });

            event.preventDefault();

        }); 
```

但这不会触发第一次鼠标悬停，我收到“抱歉，无法加载内容”

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-10T20:34:40.223

您需要重新触发 mouseover 事件。

```
$("body").delegate("a.toolTip", "mouseenter", function (event) {
    $('a.toolTip').cluetip({
        showTitle: false,
        attribute: 'title',
        local: false
    }).trigger("mouseenter");

    event.preventDefault();
}); 
```

其他挑剔的东西：

~~`event.preventDefault()`应该是第一位~~的，并且你应该防止插件被多次应用。

```
$("body").delegate("a.toolTip:not(.hasTooltip)", "mouseenter", function (event) {

    $('a.toolTip').cluetip({
        showTitle: false,
        attribute: 'title',
        local: false
    }).addClass("hasTooltip").trigger("mouseenter");
    event.preventDefault();
}); 
```

编辑：mouseover 应该是 mouseenter，并且 event.preventDefault 真的应该是最后一个，所以如果它确实失败了，默认的工具提示仍然有效。

# java - 防止 Java Web Start/JNLP 的多次下载

> ID：11421345
> 
> 赞同：2
> 
> 时间：2012-07-10T20:23:40.323
> 
> 标签：java, jnlp, java-web-start

我们有一个 Swing 应用程序，它通过单击链接从 Web 应用程序启动。该链接只不过是一个 JNLP 网址。我们在 Apache 下的四台服务器上托管了一个 jar 文件。这些在负载平衡器下。即使同一个 jar 使用相同的时间戳托管，但或多或​​少地对 JNLP 的每个请求，jar 都会被下载。一般来说，如果 jar 没有变化，java Web start 只会下载一次，后续请求无需下载即可工作。它还会检查哪些信息以与服务器版本和 jar 的本地副本进行比较？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T00:58:00.850

Jar 托管在 Apache 中，默认情况下 apache 查看三件事（时间戳+大小+ETAG） 由于它托管在四个 apache 服务器中，每个服务器的 ETAG 不同，这就是为什么每当请求转到这四个服务器之一时它都会下载服务器。修复方法是通过覆盖 apache 配置来删除 ETAG。

# python - 如何与 getattr() 结合使用 lambda: 在 python 中动态加载 python 模块？

> ID：11421346
> 
> 赞同：2
> 
> 时间：2012-07-10T20:23:47.727
> 
> 标签：python, nuke

从环境（它是一个名为 nuke 的图形程序）中获得了一个全局对象，我可以在其中添加菜单项并将其与函数连接。这个全局对象的工作方式如下：

```
menu.addCommand("Do This!", lambda: DoThings()) 
```

我想动态读取python模块并将模块函数添加为全局菜单对象中的一个项目。我写了一个类来做到这一点。我的课程的简化版本：

```
class mymenu():
.
.
.
def _builMenuFromPath(self, basepath, module):

    items = []

    # ...
    # there is code to build the items list. this is a list of the python filenames
    # ...

    if len(items) > 0:

        for item in items:

            try:
                f = getattr(__import__(module + "." + item), item) # item is the python filename of an module in the folder with the python files and module is the folder

                menu.addCommand(item, lambda: f.call()) # f.call() is a function in the dynamic loaded python file

            except Exception, e:
                pass 
```

动态导入效果很好。但是每个生成的菜单项都链接到最后一个导入的函数。这样每个菜单项都一样。

我不是专业的程序员。所以我认为我犯了一个简单的错误。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T20:45:58.580

表达式中的问题`lambda: f.call()`，`f`是一个自由术语，指的`f`是封闭范围内的变量。这意味着`f`在 lambda 中值的变化是显而易见的。例如：

```
>>> n = 1
>>> lambda: n
<function <lambda> at 0x00000000027F0898>
>>> l = lambda: n
>>> l()
1
>>> n = 2
>>> l()
2 
```

但是，这`lambda`是不必要的，因为 python 中的函数和方法是对象，它们本身可以在任何可以传递任何可调用（如 lambda）的地方传递。在这段代码中：

```
menu.addCommand(item, f.call) 
```

`f.call`是一个表达式，它将评估为可调用的绑定方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T20:32:38.697

尝试传递 f.call 而不是 lambda:f.call()。

# html - 从日期开始分配多参数属性时出现 1 个错误

> ID：11421348
> 
> 赞同：0
> 
> 时间：2012-07-10T20:24:02.233
> 
> 标签：html, ruby-on-rails, ruby

我收到此错误

```
1 error(s) on assignment of multiparameter attributes 
```

我很确定它来自 date_selector。

这是我的模型

```
class Order < ActiveRecord::Base
  attr_accessor :card_type, :card_number, :card_verification, 
    :card_expires_on # I do not have these fields in my database
  attr_accessible :cart_id, :card_expires_on, :card_type, :first_name, 
    :ip_address, :last_name,:card_number, :card_verification, :zip, :address, 
    :state, :city

  def credit_card
    @credit_card ||= ActiveMerchant::Billing::CreditCard.new(
      :brand              => card_type,
      :number             => card_number,
      :verification_value => card_verification,
      :month              => card_expires_on.month,
      :year               => card_expires_on.year,
      :first_name         => first_name,
      :last_name          => last_name
      )
  end
end 
```

以及涉及的控制器部分

```
def create
  @user = current_user
  @cart = current_cart
  @order = @cart.build_order(params[:order]) # here is where the error is
  @order.user_id = @user.id
  @order.ip_address = request.remote_ip
  ...
end 
```

**这是购物车模型**

```
class Cart < ActiveRecord::Base
  has_many :line_items, :dependent => :destroy
  has_one :order
  belongs_to :user

  def add_product(product_id)
    current_item = line_items.find_by_product_id(product_id)
    if current_item
      current_item.quantity += 1
    else
      current_item = line_items.build(:product_id => product_id)
    end
    current_item
  end

  def total_price
    line_items.to_a.sum { |item| item.total_price}
  end

  def total_price_in_cents
    return Integer(total_price * 100)
  end
end 
```

下面是 order.rb 附带的订单...再次感谢您的帮助！！！

```
<div class="field">
   <%= f.label :first_name %><br />
<%= f.text_field :first_name %>
</div>
<div class="field">
  <%= f.label :last_name %><br />
  <%= f.text_field :last_name %>
</div>
<div class="field">
  <%= f.label :address %>
  <%= f.text_field :address %>
</div>
<div class="field">
  <%= f.label :city %>
  <%= f.text_field :city %>
</div>
<div class="field">
  <%= f.label :state %>
  <%= f.select :state, @order.us_states %>
</div>
<div class="field">
  <%= f.label :zip %>
  <%= f.text_field :zip %>
</div>
<div class ="field">
  <%= f.label :card_type %> <br />
  <%= f.select :card_type, [["Visa", "visa"], ["MasterCard", "master"], ["Discover", "discover"], ["American Express", "american_express"]] %>
</div>
<div class="field">
  <%= f.label :card_number %><br />
  <%= f.text_field :card_number %>
</div>
<div class="field">ry
  <%= f.label :card_verification, "Card Verification (CVV)" %><br />
  <%= f.text_field :card_verification %>
</div>
<div class="field">
  <%= f.label :card_expires_on %><br />
  <%= f.date_select :card_expires_on, :discard_day => true, :start_year => Date.today.year, :end_year => (Date.today.year+10), :add_month_numbers => true %>
</div>
<div class="actions">
  <%= f.submit %>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T20:46:38.010

你试过@order = @cart.orders.new(params[:order]) 吗？

在订单和购物车之间的一对一关系的情况下，这将是：@cart.order.new(params[:order])

# java - 日食错误crlf

> ID：11421349
> 
> 赞同：1
> 
> 时间：2012-07-10T20:24:03.700
> 
> 标签：java, eclipse, newline

几天前的 Eclipse 更新后，我开始收到一些有趣的错误，如下所示：

```
package a.b.c;

import android.app.ListActivity;
import android.os.Bundle;

public class MyActivity extends ListActivity {
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
    }
}

Description Resource    Path    Location    Type
Syntax error on token "}", delete this token    MyActivity.java /src/a/b/c  line 11 Android Lint Problem
Syntax error on token "}", delete this token    MyActivity.java /src/a/b/c  line 11 Android Lint Problem
Syntax error, insert "}" to complete ClassBody  MyActivity.java /src/a/b/c  line 10 Android Lint Problem 
```

有时关闭/重新启动项目会有所帮助。

有时关闭/重新打开 Eclipse 会有所帮助。

我厌倦了这些错误。

什么是修复它的正确方法。

如果在 Eclipse 开始弄乱 *.java 文件中的 CR/LF 时总是发生这种情况。

我从 Windows->Preferences 设置 Eclipse 首选项。导航到 General -> Workspace，然后将“New text file line delimiter”导航到其他“Windows”，但它没有帮助。

仍然得到同样的错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T20:28:59.243

我会尝试在命令行上使用 -clean 选项启动 Eclipse。我敢打赌 Eclipse 正在以旧格式存储信息，而更新的插件不喜欢它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T20:08:53.477

Android Lint 中显然存在一个错误。它有时会从 Java 工具中接管错误（如您在问题视图的“类型”列中所见）。要摆脱错误的错误，只需按下“Lint 警告”视图中的“删除所有警告”按钮。

下次再次运行 Lint 时，您将获得有效的错误/警告。

# ios - CTFramesetterCreateWithAttributedString 导致内存泄漏

> ID：11421350
> 
> 赞同：0
> 
> 时间：2012-07-10T20:24:08.160
> 
> 标签：ios, memory-leaks, core-text

我不知道为什么这段简单的代码有时会导致内存泄漏（并非总是如此）。

这段代码被包装在一个 NSOperation 中并在一个 NSOperationQueue 队列中运行。该操作将修剪 sourceNSAString 以适应某个大小，并将其返回给其他线程。

```
//sourceNSAString is a NSMutableAttributedString that will be set to nil elsewhere in another GCD queue.
CTFramesetterRef frameSetter = CTFramesetterCreateWithAttributedString((__bridge CFAttributedStringRef) sourceNSAString); 

if (frameSetter) {

    CFRange fitRange = {static_cast<CFIndex>(range.location), 0};

    CFRange totalRange = {static_cast<CFIndex>(range.location), static_cast<CFIndex>(range.length)};

    CGSize suggestedSize = CTFramesetterSuggestFrameSizeWithConstraints(frameSetter, totalRange, NULL, size, &fitRange);

    CFRelease(frameSetter);

      ...... trim sourceNSAString to fit in fitRange
 } 
```

是不是因为： 1，我不应该将 sourceNSAString 返回到另一个线程？或者2，CTFramesetterCreateWithAttributedString不能在后台线程中使用？

有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-22T17:45:05.610

好的，这似乎是一个模拟器错误（至少现在是这样）。我在设备上分析了我的应用程序，内存泄漏就消失了。在多线程环境中使用核心文本时，模拟器似乎有很多内存泄漏。例如，创建一个 CTFrameSetter 并稍后将其释放到同一个 GCD 串行队列中（根据 Doc 是允许的），可能会导致随机内存泄漏。无论如何，当在真实设备中进行分析时，所有这些内存泄漏都会消失。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-24T19:55:00.920

这个泄漏不仅仅是一个模拟器错误，它出现在实际设备上。请参阅我对这个相关问题的回答以深入调试[内存使用量随着 CTFontCreateWithName 和 CTFramesetterRef 的增长而增长](https://stackoverflow.com/questions/8491841/memory-usage-grows-with-ctfontcreatewithname-and-ctframesetterref)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-07-16T10:37:49.940

我认为您应该在 if 语句之后释放 frameSetter，因为如果不执行 if 语句，则不会释放 frameSetter。

```
 CTFramesetterRef frameSetter = CTFramesetterCreateWithAttributedString((__bridge CFAttributedStringRef) sourceNSAString); 

if (frameSetter) {

    CFRange fitRange = {static_cast<CFIndex>(range.location), 0};

    CFRange totalRange = {static_cast<CFIndex>(range.location), static_cast<CFIndex>(range.length)};

    CGSize suggestedSize = CTFramesetterSuggestFrameSizeWithConstraints(frameSetter, totalRange, NULL, size, &fitRange);

 }

CFRelease(frameSetter); 
```

这应该工作

# java - 用于 Tcl 的 Java GUI

> ID：11421351
> 
> 赞同：1
> 
> 时间：2012-07-10T20:24:11.570
> 
> 标签：java, user-interface, tcl, tk, jacl

我在用 Java 编写可以与 Tcl 脚本交互的 GUI 时遇到了一些麻烦。运行 Tcl 脚本时，我希望将信息传递到此 GUI 并显示。在 GUI 上进一步输入的信息应该能够返回给脚本。

我目前正在使用 Tcl/Java。不幸的是，我使用的是 Teamcenter，根据用户手册，不支持 Tk 工具包。所以我正在尝试再次与 Swing 合作。

这就是我尝试为 Swing 工作的内容，但是当我运行脚本时没有任何显示：

```
package require java

java::import javax.swing.JFrame 
set window [java::new javax.swing.JFrame] 
$window setSize 100 100
$window setVisible true 
```

我也发现了[Swank](http://www2.tcl.tk/2858)，但似乎没有什么文档，所以我不确定如何继续。

关于如何最好地解决这个问题的任何建议？或者在哪里可以找到其他资源？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T07:08:30.597

我不熟悉您提到的 Java 库，但从

> 运行 Tcl 脚本时，我希望将信息传递到此 GUI 并显示。在 GUI 上进一步输入的信息应该能够返回给脚本。

声明您的案例非常适合[IPC](http://en.wikipedia.org/wiki/Inter-process_communication)。我的意思是我只是启动一个 Tcl 程序，通过某种 IPC 连接你正在运行的 Java 和 Tcl 程序，然后使用商定的协议在它们之间进行交换。

最简单的跨平台 IPC 可能使用 TCP 套接字：例如，您的 Java 应用程序在随机端口上打开一个套接字，侦听某个环回接口地址，然后将该套接字的地址传递给它产生的 Tcl 应用程序；然后 Tcl 应用程序[连接](http://www.tcl.tk/man/tcl8.5/TclCmd/socket.htm)到那个套接字，两个应用程序确实交换它们的命令和响应。

另一种可能性是使用托管它的 Tcl shell 的标准 IO 通道与脚本通信——stdin 和 stdout：您的 Java 主机将其命令写入衍生的 Tcl 应用程序的 stdin 并从其 stdout 读回其输出。这种方式可能比 TCP 套接字更简单，但需要在 Windows 上进行特殊处理（您必须使用 运行脚本`tclsh`，而不是`wish`在后一种情况下，它的标准通道将无处连接）。

如果您不需要跨平台 IPC 并且可以使用外部 Tcl 库，那么您可以通过特定于平台的东西进行通信，例如[Unix 域套接字](http://wiki.tcl.tk/ceptcl)、[D-Bus](http://dbus-tcl.sourceforge.net/)、[Windows 命名管道](http://twapi.magicsplat.com/namedpipe.html)（可以使用 Unix 命名管道而无需额外的包）、[DDE](http://www.tcl.tk/man/tcl8.5/TclCmd/dde.htm)等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T09:03:37.490

在搜索您的问题可能是什么的背景时，我[在 comp.lang.tcl 上找到了这个线程，](https://groups.google.com/forum/#!topic/comp.lang.tcl/QiqSmNriiac)它解释了这个问题。问题是您没有从 AWT 事件线程创建 GUI。为此，您需要创建一个小的 Java 类来实现`Runnable`（`Runner`在下面调用）并创建您的 GUI 对象并显示它们。然后，您可以`SwingUtilities.invokeLater`通过 JTcl 实例化并启动它：

```
java::call javax.swing.SwingUtilities invokeLater [java::new Runner] 
```

但是，您使用的 JTcl 包含一个包 ( [`hyde`](http://wiki.tcl.tk/2745))，可让您将 Java 代码放入 Tcl 代码中：

```
package require java
package require hyde

hyde::jclass Runner -package your.helper -implements Runnable {
    public void run() {
        your.Frame f = new your.Frame();
        // ...
        f.setVisible(true);
    }
}
java::call javax.swing.SwingUtilities invokeLater [java::new your.helper.Runner] 
```

遗憾的是没有[更清楚地记录](http://jtcl.kenai.com/docs/jtcllib/hyde.html)它；它很容易被忽略，因为它位于 jtcllib 文档组中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T19:05:54.140

Teamcenter 不支持“外部自定义”。

我分别用 Java 编写了 GUI，最后使用 Teamcenter 的内部 API 来显示 GUI。

# java - Android OnClickListener 复杂度

> ID：11421360
> 
> 赞同：0
> 
> 时间：2012-07-10T20:24:26.413
> 
> 标签：java, android, complexity-theory, onclicklistener

我需要知道，在复杂性方面什么更好。从 xml 中为每个按钮标识一个单独的 onClick 方法，如下所示：

```
android:onClick:"clickHandler" 
```

和java代码：

```
public void clickHandler(View v){ 
         Button b = (Button) v;
         //do something for that button
      }; 
```

, 或为所有按钮确定一种方法，并用 if 条件分隔它们。

```
Public void clickHandler(View v){
      Button b = (Button) v; 
      if(b.getText().equals("a")){
      }
         elseif(b.getText().equals("b")){
            }
       //And so on.
    } 
```

我在计算复杂度等方面不是那么好，但是这个问题很烦人，我无法回答。但是据我了解，第一种方法增加了很多代码行！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T20:27:55.220

我会使用第二个选项的版本。创建一个处理程序，然后使用 switch 语句来确定哪个视图接收到事件。它的代码效率很高，而且一点也不凌乱。此外，您不需要在 xml 中列出该属性......我个人认为在您的活动中查找 ViewById() 并实现 onClickListener 要容易得多。然后你可以在你的 switch 语句中使用每个按钮的 id。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-10T20:29:03.620

我一般喜欢后者。除了我倾向于做一些看起来更像这样的事情：

```
public void onClick(View v){
   switch(v.getId()){
      case R.id.button_a:
        //do button a logic here
        break;
      case R.id.button_b:
        //do button b logic here
        break;
   }
} 
```

考虑让你的`Activity implement View.OnClickListener`比在你的`OnCreate()`简单附加`findViewById(R.id.button_a).setOnClickListener(this);`

# google-maps - 如何忽略（或不获取）未填充多边形内部的点击

> ID：11421362
> 
> 赞同：0
> 
> 时间：2012-07-10T20:24:32.663
> 
> 标签：google-maps, google-maps-api-3

任何人都知道一种方法，这样我的点击处理程序就不会被调用，或者如果被调用可以确定点击是在未填充（或 fillOpacity 为 0）多边形的内部？（多边形不可编辑，因此路径和顶点不会包含在点击事件中）

我想忽略这样的点击并允许点击通过多边形“流血”，我只想处理多边形轮廓上的点击。

我想我可以对点击的纬度做一些事情，以确定它是否比边缘的一些像素多，但这似乎很复杂，特别是如果需要考虑 strokeWeight 和缩放级别。

（我经常在多边形内有自定义标记，我通过子类化 OverlayView 来呈现自己，并希望在这种情况下处理对它们的点击。）

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T20:51:49.677

在 PolygonOptions 上将 clickable 设置为 false 并不能解决问题？如果没有，请尝试使用折线而不是多边形。那你就不用担心中间的点击了。

# javascript - JavaScript 'var' 数据/对象大小

> ID：11421365
> 
> 赞同：2
> 
> 时间：2012-07-10T20:24:48.170
> 
> 标签：javascript, variables, memory-management, size

JavaScript 是否优化了存储在内存中的变量的大小？例如，具有布尔值的变量会比具有整数值的变量占用更少的空间吗？

基本上，将以下数组：

```
var array = new Array(8192);
for (var i = 0; i < array.length; i++)
  array[i] = true; 
```

在计算机内存中小于：

```
var array = new Array(8192);
far (var i = 0; i < array.length; i++)
  array[i] = 9; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T20:36:19.307

简短的回答：是的。

布尔值通常（取决于用户代理和实现）将占用 4 个字节，而整数将占用 8 个字节。

查看另一个 StackOverflow 问题，了解其他人如何设法测量 JS 中的内存占用：[JavaScript 对象大小](https://stackoverflow.com/questions/1248302/javascript-object-size)

编辑：ECMAScript 规范的第 8.5 节规定如下：

> Number 类型正好有 18437736874454810627 个值，代表二进制浮点算术的 IEEE 标准中指定的双精度 64 位格式 IEEE 754 值

...因此，无论实现如何，所有数字都应该是 8 个字节。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T22:18:24.260

嗯，js只有一种数字类型，就是64位浮点数。字符串中的每个字符都是 16 位（src: douglas crockford's , javascript the good parts ）。因此，布尔值的处理可能是特定于解释器实现的。如果我没记错的话，V8 引擎肯定会将“布尔”对象作为“c bool”处理。

# lotus-notes - 在 XPage 上格式化 checkBoxGroup

> ID：11421366
> 
> 赞同：1
> 
> 时间：2012-07-10T20:24:50.487
> 
> 标签：lotus-notes, xpages

我有一个 checkBoxGroup 可以扩展到大约 20 个项目，因为用户可以从视图中选择要导出到电子表格的字段。我很好奇如何将这 20 个复选框（动态确定）的显示控制为不止一行，甚至显示在一列中。

```
<xp:checkBoxGroup id="fieldChoicesBox">
    <xp:eventHandler event="onclick" submit="false" id="eventHandler2">
       <xp:this.script>
       <![CDATA[var x= '#{javascript:getClientId("fieldChoicesBox")}';
                var y= '#{javascript:getClientId("fieldChoicesBoxList")}';
                copyRadioChoices(x,y)]]>
       </xp:this.script>
    </xp:eventHandler>
    <xp:selectItems>
       <xp:this.value>
          <![CDATA[#{javascript: var viewName=@UpperCase(getComponent("viewChoice").getValue());
                     var tmp = @DbLookup(@DbName(),"dbprofile",viewName,"Value");
                     @If(@IsError(tmp),"None",tmp)}]]>
       </xp:this.value>
    </xp:selectItems>
</xp:checkBoxGroup> 
```

这都是我最初从 Russ Maher 那里得到的代码（参见[http://xpagetips.blogspot.com/2012/06/extending-your-xpages-applications-with.html](http://xpagetips.blogspot.com/2012/06/extending-your-xpages-applications-with.html)）所以任何辉煌都归功于他，而所有错误是我的。

或者，如果您知道如何选择更轻松或更优雅地在导出中显示的字段或列，我会很高兴听到它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T07:23:49.210

如果您使用或可以使用 ExtLib，我会使用 valuePicker 控件，让您从一个控件中选择多个值（在选择时按住 ctrl）。这是一个例子：

```
<xp:inputtext id="example" multipleSeparator=","></xp:inputText>
<xe:valuePicker for="example" pickerText="text">
    <xe:this.dataProvider>
        <xe:simpleValuePicker valueList="test1, test2, test3, test4"
            valueListSeperator=",">
        </xe:simpleValuePicker>
    </xe:this.dataProvider>
</xe:valuePicker> 
```

# android - 带有手势的 Android 片段 onCreateView

> ID：11421368
> 
> 赞同：25
> 
> 时间：2012-07-10T20:24:53.733
> 
> 标签：android

我正在尝试在片段中使用手势；我在处理我的详细信息片段的 FragmentActivity 中有以下内容。我试图发生的是当在视图上检测到滑动以用上一个或下一个条目替换该视图内的数据时。

如果有更好的处理方法；我完全同意。然而，这里发生的是 onFling 方法从未真正被调用过。

```
public static class DetailsFragment extends Fragment {
    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
        Bundle savedInstanceState) {
        if (container == null) {
            return null;
        }
        View v = inflater.inflate(R.layout.my_view, null, false);
        final GestureDetector gesture = new GestureDetector(getActivity(),
            new GestureDetector.SimpleOnGestureListener() {
                @Override
                public boolean onFling(MotionEvent e1, MotionEvent e2, float velocityX,
                    float velocityY) {

                    final int SWIPE_MIN_DISTANCE = 120;
                    final int SWIPE_MAX_OFF_PATH = 250;
                    final int SWIPE_THRESHOLD_VELOCITY = 200;
                    try {
                        if (Math.abs(e1.getY() - e2.getY()) > SWIPE_MAX_OFF_PATH)
                            return false;
                        if (e1.getX() - e2.getX() > SWIPE_MIN_DISTANCE
                            && Math.abs(velocityX) > SWIPE_THRESHOLD_VELOCITY) {
                            Log.i(Constants.APP_TAG, "Right to Left");
                        } else if (e2.getX() - e1.getX() > SWIPE_MIN_DISTANCE
                            && Math.abs(velocityX) > SWIPE_THRESHOLD_VELOCITY) {
                            Log.i(Constants.APP_TAG, "Left to Right");
                            titles.showDetails(getPosition() - 1);
                        }
                    } catch (Exception e) {
                        // nothing
                    }
                    return super.onFling(e1, e2, velocityX, velocityY);
                }
            });

        v.setOnTouchListener(new View.OnTouchListener() {
            @Override
            public boolean onTouch(View v, MotionEvent event) {
                return gesture.onTouchEvent(event);
            }
        });

        return v;
    }
} 
```

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-07-10T20:39:07.853

看起来以下问题解释了这一点：[Android：GestureDetector won't catch Gestures](https://stackoverflow.com/questions/4027553/android-gesturedetector-wont-catch-gestures)

另外这里是结果：

解决办法其实就是重写onDown方法，返回true；否则手势检测器将停止并且不会检测到向上：

```
 final GestureDetector gesture = new GestureDetector(getActivity(),
            new GestureDetector.SimpleOnGestureListener() {

                @Override
                public boolean onDown(MotionEvent e) {
                    return true;
                }

                @Override
                public boolean onFling(MotionEvent e1, MotionEvent e2, float velocityX,
                    float velocityY) {
                    Log.i(Constants.APP_TAG, "onFling has been called!");
                    final int SWIPE_MIN_DISTANCE = 120;
                    final int SWIPE_MAX_OFF_PATH = 250;
                    final int SWIPE_THRESHOLD_VELOCITY = 200;
                    try {
                        if (Math.abs(e1.getY() - e2.getY()) > SWIPE_MAX_OFF_PATH)
                            return false;
                        if (e1.getX() - e2.getX() > SWIPE_MIN_DISTANCE
                            && Math.abs(velocityX) > SWIPE_THRESHOLD_VELOCITY) {
                            Log.i(Constants.APP_TAG, "Right to Left");
                        } else if (e2.getX() - e1.getX() > SWIPE_MIN_DISTANCE
                            && Math.abs(velocityX) > SWIPE_THRESHOLD_VELOCITY) {
                            Log.i(Constants.APP_TAG, "Left to Right");
                        }
                    } catch (Exception e) {
                        // nothing
                    }
                    return super.onFling(e1, e2, velocityX, velocityY);
                }
            });

        v.setOnTouchListener(new View.OnTouchListener() {
            @Override
            public boolean onTouch(View v, MotionEvent event) {
                return gesture.onTouchEvent(event);
            }
        }); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2016-08-12T04:08:43.700

一些评论

1.  我不得不调整我的代码如下：

    ```
    v.setOnTouchListener(new View.OnTouchListener() {
        @Override        
        public boolean onTouch(View v, MotionEvent event) {

            // return gesture.onTouchEvent(event);

            gesture.onTouchEvent(event);
            return true; // <-- this line made the difference
        }
    }); 
    ```

2.  此外，如果您使用 xml 文件来创建视图

    ```
    View v = inflater.inflate(R.layout.my_view, null, false); 
    ```

确保您实际上正在按下预期的视图。夸大测试的一个好方法是在布局 xml 文件中将宽度和高度设置为“match_parent”而不是“wrap_content”。

# c# - 更新实体列表的有效方法

> ID：11421370
> 
> 赞同：31
> 
> 时间：2012-07-10T20:24:57.457
> 
> 标签：c#, sql, asp.net-mvc, entity-framework, entity

我正在开发一个允许用户编辑实体列表的项目。我将这些实体映射到视图模型并使用编辑器字段显示它们。当用户按下提交按钮时，我会浏览每个模型并像这样更新它：

```
foreach (var viewModel in viewModels)
{
    //Find the database model and set the value and update
    var entity = unit.EntityRepository.GetByID(fieldModel.ID);
    entity.Value = viewModel.Value;
    unit.EntityRepository.Update(entity);
} 
```

上面的代码有效，但是正如您所见，我们需要为每个实体访问数据库两次（一次检索，另一次更新）。有没有使用实体框架更有效的方法来做到这一点？我注意到每次更新都会生成一个单独的 SQL 语句。有没有办法在循环完成后提交所有更新？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-07-10T20:50:11.183

以下是我所知道的在不先检索实体的情况下更新数据库中的实体的两种方法：

```
//Assuming person is detached from the context
//for both examples
public class Person
{
  public int Id { get; set; }
  public string Name { get; set; }
  public DateTime BornOn { get; set; }   
}

public void UpdatePerson(Person person)
{
  this.Context.Persons.Attach(person)
  DbEntityEntry<Person> entry = Context.Entry(person);
  entry.State = System.Data.EntityState.Modified;
  Context.SaveChanges();
} 
```

应该产生：

```
Update [schema].[table]
Set Name = @p__linq__0, BornOn = @p__linq__1
Where id = @p__linq__2 
```

或者，如果需要，您可以只指定字段（对于具有大量列的表可能很好，或者出于安全目的，只允许更新特定列：

```
public void UpdatePersonNameOnly(Person person)
{
  this.Context.Persons.Attach(person)
  DbEntityEntry<Person> entry = Context.Entry(person);
  entry.Property(e => e.Name).IsModified = true;
  Context.SaveChanges();
} 
```

应该产生：

```
Update [schema].[table]
Set Name = @p__linq__0
Where id = @p__linq__1 
```

> .Attach() 不是先去数据库检索记录，然后将您的更改与它合并吗？所以无论如何你最终都会往返

不 [，我们可以测试一下](https://dotnetfiddle.net/hLwRHL)

```
using System;
using System.Data.Entity;
using System.Linq;
using System.Collections.Generic;
using System.ComponentModel.DataAnnotations.Schema;
using System.ComponentModel.DataAnnotations;

public class Program
{
    public static void Main()
    {

        var movie1 = new Movie { Id = 1, Title = "Godzilla" };
        var movie2 = new Movie { Id = 2, Title = "Iron Man" };
        using (var context = new MovieDb())
        {
            /*
            context.Database.Log = (s) => {
                Console.WriteLine(s);
            };
            */

            Console.WriteLine("========= Start Add: movie1 ==============");
            context.Movies.Add(movie1);
            context.SaveChanges();
            Console.WriteLine("========= END Add: movie1 ==============");

            // LET EF CREATE ALL THE SCHEMAS AND STUFF THEN WE CAN TEST

            context.Database.Log = (s) => {
                Console.WriteLine(s);
            };

            Console.WriteLine("========= Start SELECT FIRST movie ==============");
            var movie1a = context.Movies.First();
            Console.WriteLine("========= End SELECT FIRST movie ==============");

            Console.WriteLine("========= Start Attach Movie2 ==============");
            context.Movies.Attach(movie2);
            Console.WriteLine("========= End Attach Movie2 ==============");

            Console.WriteLine("========= Start SELECT Movie2 ==============");
            var movie2a = context.Movies.FirstOrDefault(m => m.Id == 2);
            Console.WriteLine("========= End SELECT Movie2 ==============");
            Console.Write("Movie2a.Id = ");
            Console.WriteLine(movie2a == null ? "null" : movie2a.Id.ToString());
        }
    }

    public class MovieDb : DbContext
    {
        public MovieDb() : base(FiddleHelper.GetConnectionStringSqlServer()) {}
        public DbSet<Movie> Movies { get; set; }
    }

    public class Movie
    {
        [Key]
        [DatabaseGenerated(DatabaseGeneratedOption.None)]
        public int Id { get; set; }

        public string Title { get; set; }
    }
} 
```

如果 attach 进行任何数据库调用，我们将在*Start Attach Movie2*和*End Attach Movie2*之间看到它们。我们还验证了说明以下内容的文档：

> **评论**
> 
> 附加用于使用已知已存在于数据库中的实体重新填充上下文。
> 
> SaveChanges 因此不会尝试将附加实体插入到数据库中，因为假定它已经存在。

附加movie2后，我们可以尝试从数据库中选择它。它不应该在那里（因为 EF 只假设它在那里）。

> ========= 开始添加：movie1 ==============
> 
> ========= END 添加：movie1 ===============
> 
> ========= 开始选择第一部电影 ==============
> 
> 于 2020 年 1 月 15 日下午 5:29:23 +00:00 开放连接
> 
> 选择顶部 (1)
> 
> [c].[Id] AS [Id],
> 
> [c].[标题] AS [标题]
> 
> FROM [dbo].[电影] AS [c]
> 
> -- 执行于 2020 年 1 月 15 日下午 5:29:23 +00:00
> 
> -- 在 23 毫秒内完成，结果：SqlDataReader
> 
> 2020 年 1 月 15 日下午 5:29:23 +00:00 关闭连接
> 
> ========= 结束选择第一部电影 ==============
> 
> ========= 开始附加影片2 ===============
> 
> ========= End Attach Movie2 ===============
> 
> ========= 开始选择电影2 ==============
> 
> 于 2020 年 1 月 15 日下午 5:29:23 +00:00 开放连接
> 
> 选择顶部 (1)
> 
> [Extent1].[Id] AS [Id],
> 
> [Extent1].[标题] AS [标题]
> 
> FROM [dbo].[电影] AS [Extent1]
> 
> 其中 2 = [Extent1].[Id]
> 
> -- 执行于 2020 年 1 月 15 日下午 5:29:23 +00:00
> 
> -- 在 2 毫秒内完成，结果为：SqlDataReader
> 
> 2020 年 1 月 15 日下午 5:29:23 +00:00 关闭连接
> 
> =========结束选择电影2 ===============
> 
> Movie2a.Id = null

所以在附加过程中没有调用 SQL，附加它没有错误消息，它不在数据库中。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-10T20:51:19.497

您可以尝试以下操作以最小化查询：

```
using (var ctx = new MyContext())
{
    var entityDict = ctx.Entities
        .Where(e => viewModels.Select(v => v.ID).Contains(e.ID))
        .ToDictionary(e => e.ID); // one DB query

    foreach (var viewModel in viewModels)
    {
        Entity entity;
        if (entityDict.TryGetValue(viewModel.ID, out entity))
            entity.Value = viewModel.Value;
    }

    ctx.SaveChanges(); //single transaction with multiple UPDATE statements
} 
```

请注意[，`Contains`](https://stackoverflow.com/a/8108643/270591)如果列表`viewModels`很长，[可能会很慢。](https://stackoverflow.com/a/8108643/270591)但它只会运行一个查询。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-10T20:52:08.070

HatSoft 已经提到过 EntityFramework.Extended。只需查看以下基于扩展框架的示例。

[http://weblogs.asp.net/pwelter34/archive/2011/11/29/entity-framework-batch-update-and-future-queries.aspx](http://weblogs.asp.net/pwelter34/archive/2011/11/29/entity-framework-batch-update-and-future-queries.aspx)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-10T20:33:11.790

我不确定实体框架的 beta 或 RC 中的当前版本是否支持批量更新之类的功能。但它们是 Nuget 上 EF 4.3.1 的扩展

[http://nuget.org/packages/EntityFramework.Extended](http://nuget.org/packages/EntityFramework.Extended)

希望这可以帮助您实现您的要求

# php - mysql_fetch_assoc() 期望参数 1 是资源，在 php 中错误地给出布尔值

> ID：11421371
> 
> 赞同：-1
> 
> 时间：2012-07-10T20:25:02.160
> 
> 标签：php

> **可能重复：**
> [PHP 错误：mysql_fetch_array() 期望参数 1 是资源，给定布尔值](https://stackoverflow.com/questions/2973202/php-error-mysql-fetch-array-expects-parameter-1-to-be-resource-boolean-given)

对于下面在 php 中提到的代码，我收到以下错误：

> **警告**：mysql_fetch_assoc() 期望参数 1 是资源，布尔值在第**62**行的**/Users/pubs/Sites3/parse/includes/parseAuthorSearch.php中给出****警告**：mysql_fetch_assoc() 期望参数 1 是资源，布尔值在**/Users/中给出****pubs/Sites3/parse/includes/parseAuthorSearch.php**在第**62行**

 ******```
function findExactAuthorMatch($firstname, $lastname)
{
    $query22 = "SELECT COUNT(*) FROM authors WHERE lastname='".$lastname."' AND firstname='".$firstname."'";    
    $result22 = mysql_query($query22);
    $count22 = mysql_fetch_assoc($result22);
    if($count22 == 0) return false;
    else return true;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T20:26:58.190

您的查询错误，请尝试在 PHPMyAdmin 或其他中执行它，或者尝试回显它并查看它是否一致。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-10T20:27:31.320

看起来您的`mysql_query`呼叫返回`false`（布尔值），然后您在`mysql_fetch_assoc`没有检查它是否有效的情况下调用它。

尝试这个：

```
$result22 = mysql_query($query22) or die('Invalid MySQL query: ' . mysql_error()); 
```

这将告诉您查询在哪里死亡。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-10T20:31:16.190

*   你不应该再使用 mysql_* 函数了
    *   见：[http ://us2.php.net/manual/en/mysqlinfo.api.choosing.php](http://us2.php.net/manual/en/mysqlinfo.api.choosing.php)
*   您永远不应该直接将变量放入查询中；查看可用于相应 API 的各种转义函数。在这种情况下使用 mysql_real_escape_string
*   要查看查询的错误，请执行以下操作：

    if (!$result22) { die(mysql_error()); }

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-10T20:28:33.017

这意味着您之前对`mysql_query()`返回的调用`false`，因此没有要获取的结果。当查询出现问题时会发生这种情况，例如语法错误。

在这种情况下，您将要检查 if `$result22`is `false`，然后看看`mysql_error()`有什么要说的：

```
if ($result22 === false) {
    echo mysql_error();
    return false;
} 
```******

# javascript - 每 5 秒使用 jquery/javascript 读取 XML

> ID：11421373
> 
> 赞同：3
> 
> 时间：2012-07-10T20:25:13.957
> 
> 标签：javascript, jquery, html, xml

我有一个 html

索引.html：

```
<html>

<head>
    <title>Facebook</title>

    <script type="text/javascript" src="../xdata/js/jquery.js"></script>
</head>

<body>
    Tasks (<span id="tasks">0</span>)
    Messages (<span id="messages">0</span>)
    Notifications (<span id="notifications">0</span>)

    <script type="text/javascript">
    $(document).ready(function() {
    var pagetitle = document.title;
    document.title = pagetitle+' NEW NOTIFICATON';
    });
    </script>
</body>

</html> 
```

和一个xml文件

页面.xml：

```
<?xml version="1.0" ?>
<page tasks="1" messages="3" notifications="3"/> 
```

我如何使每 5 秒`index.html`读取`page.xml`和修改 Facebook 中的标题（“(1) Facebook”）以及修改任务、消息、通知......

我在阅读 xml 时遇到问题。如果有人可以帮助我吗？

PS - 我更喜欢 jQuery ...但 JavaScript 也可以

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-10T21:55:51.370

以下是在 jquery 中完成的，尽管您的 xml 文件有一个小错误，导致解析问题。

假设你的 xml 文件是这样的：

```
<?xml version="1.0"?>
<data>
    <page tasks="1" messages="3" notifications="3"/>
</data> 
```

以下代码将相应地修改页面，当然使用 jquery：

```
$(document).ready(function() {
    function get_info() {
        $.ajax({
            type: "GET",
            url: "page.xml",
            dataType: "xml",
            cache: false,
            complete: function(doc) {
                var tasks = $(doc.responseText).find("page").attr("tasks");
                var msgs = $(doc.responseText).find("page").attr("messages");
                var notes = $(doc.responseText).find("page").attr("notifications");
                if (tasks != $('#tasks').text() ||
                    msgs != $('#messages').text() ||
                    notes != $('#notifications').text()) {
                    document.title = "Facebook" + ' NEW NOTIFICATON';
                }
                $('#tasks').text(tasks);
                $('#messages').text(msgs);
                $('#notifications').text(notes);
            }
        });

    }
    setInterval(function() {
        get_info();
    }, 5000);
}); 
```

我花了一些时间来开发这个，我知道它确实有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T20:28:11.257

将您的逻辑放在 setTimeout 方法调用中：

```
setTimeout(function(){
    alert('I am displayed after 3 seconds!');
}, 3000); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-10T20:28:32.223

```
 var tid = setTimeout(function_name, 5000);

function function_name() {
  // do some stuff...
  tid = setTimeout(function_name, 5000); // repeat
}
function abortTimer() { // to stop the timer
  clearTimeout(tid);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-11T13:14:58.217

```
 Try this:
    (document).ready(function() {
        function getPage() {
           var page= $.ajax({
                type: "GET",
                url: "page.xml",
                dataType: "xml",
                async : false,
            }).responseXML;
       $(page).find('page').each(function(){
         var tasks = $(this).attr("tasks");
         var msgs = $(this).attr("messages");
         var notes = $(this).attr("notifications");
         $('#tasks').html(tasks);
         $('#messages').html(msgs);
         $('#notifications').html(notes);
      });
   }
});
    setInterval(getPage,5000); 
```

# ruby - 使用 Ruby 1.9 String 作为字节流，而不是编码字符串

> ID：11421375
> 
> 赞同：0
> 
> 时间：2012-07-10T20:25:18.043
> 
> 标签：ruby, string

是否可以在字符串上获得旧的 Ruby 1.8 行为，并将其作为字节流而不是编码字符串使用？

特别是，我试图将几个字节与 Unicode 编码的字符串结合起来，所以：

```
\xFF\x00\x01#{Unicode encoded string} 
```

但是，如果我尝试这样做，它也会尝试对 \xFF\x00\x01 进行编码，这是行不通的。

**代码**

我在 irb 中尝试做的事情：

```
"#{[4278190080].pack("V").force_encoding("BINARY")}\xFF".force_encoding("BINARY") 
```

这给了我：

```
Encoding::CompatibilityError: incompatible character encodings: ASCII-8BIT and UTF-8
        from (irb):41
        from /usr/bin/irb:12:in `<main>' 
```

我也尝试过使用 ASCII-8BIT，但没有成功。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T20:28:50.457

只需`string = string.force_encoding("ASCII-8BIT")`对您想要视为普通旧字节系列的任何字符串执行操作即可。然后你应该能够将两个字符串加在一起。

我觉得`.force_encoding("BINARY")`也可以。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T21:30:31.403

默认情况下，您插入的字符串文字采用 UTF-8 格式。我认为这`Encoding::CompatibilityError`是由在 UTF-8 字符串中插入 BINARY 编码字符串引起的。

尝试使用兼容的编码连接字符串，例如：

```
irb> s = [4278190080].pack("V") + "\xFF".force_encoding("BINARY")
=> "\x00\x00\x00\xFF\xFF"
irb>> s.encoding
=> #<Encoding:ASCII-8BIT>
irb> s=[4278190080].pack("V") + [0xFF].pack("C")
=> "\x00\x00\x00\xFF\xFF"
irb> s.encoding
=> #<Encoding:ASCII-8BIT> 
```

# python - PyGTK：过滤输入小部件的键盘输入时，在打开大缓冲区时无法正确设置光标位置

> ID：11421376
> 
> 赞同：1
> 
> 时间：2012-07-10T20:25:20.510
> 
> 标签：python, pygtk

我正在使用 PyGTK 编写一个用于导航大型（>20 MB）文本文件的程序。我为此使用了一个 TextViewer 小部件，它可以很好地处理它们，只是需要几秒钟才能完成填充相应的 TextBuffer。同时，我还有几个对话框需要对其输入进行过滤（仅十六进制数字或其他内容）。我将我想要允许的字符和信号的名称传递给这个函数：

```
def FilterText(self, chars, signal):

    def Filt(entry, text, length, position):
        position = entry.get_position()
        chrs = set(chars)
        realtext = ''.join([c for c in text if c in chrs])
        if len(realtext) > 0:
            entry.handler_block_by_func(Filt)
            entry.insert_text(realtext, position)
            entry.handler_unblock_by_func(Filt)
            newPos = position + len(realtext)
            gobject.idle_add(entry.set_position, newPos)
        entry.stop_emission(signal)
    return Filt 
```

然后将结果连接到该信号的 Entry 小部件的处理程序。这有效，除了在填充 TextBuffer 时，排队的 entry.set_position 调用在完成之前都不会运行。结果是光标停留在条目的开头，并且输入的所有内容都是向后的，不用说，这很烦人。这大概是因为在填充 TextBuffer 之前没有空闲时间。有没有办法解决这个问题并在输入过滤的条目小部件时允许正确的行为？（这应该是可能的，因为未过滤的不会遇到这样的问题）由于某种原因直接调用 entry.set_position 不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T20:06:43.107

终于弄明白了——换个电话

```
gobject.idle_add(entry.set_position, newPos) 
```

到

```
gobject.timeout_add(0, entry.set_position, newPos) 
```

Since entry.set_position returns None, it will call it once immediately, then never again, doing exactly what I wanted.

# java - 如何使用Java存储公钥mysql？

> ID：11421377
> 
> 赞同：1
> 
> 时间：2012-07-10T20:25:24.643
> 
> 标签：java, mysql

我需要将公钥存储在我的 MySQL 数据库中。我有以下内容：

```
 rsaModulus=rsaPk.getModulus(); 
```

该方法`getModulus()` 返回 BigInt。但是，当我使用`preparedstatement`为了在表中插入值时，我找不到合适的方法来做到这一点（即，类似于`toString`, `toInt`）。我需要检索此公钥并稍后进行一些数学计算。这就是为什么，我认为将其存储为 String 不是一个好主意。此外，`toLong`由于数据库中的字段被定义为 BigInt，因此不起作用。这个问题有解决办法吗？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T20:35:52.943

该线程有一个使用 BLOB 的有趣解决方法。

[将 BigInteger 存储到 Mysql 中](https://stackoverflow.com/questions/4374930/store-biginteger-into-mysql)

也许你可以使用它。

PS。下一次，先搜索SO :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T21:14:13.417

文件，如密钥和证书通常存储为一个比特数组。这可以通过 blob 列来完成。

Mysql doc显示了这些java类型和mysql类型的关系： [http ://dev.mysql.com/doc/refman/5.0/en/connector-j-reference-type-conversions.html](http://dev.mysql.com/doc/refman/5.0/en/connector-j-reference-type-conversions.html)

如果您能够以字节 [] 的形式获取您的公钥，请使用如下示例代码：

```
...
   InputStream is = PapelServiceTest.class.getResourceAsStream("MY_FILE_HERE");
   byte[] pkBytes = IOUtils.toByteArray(is);

   String query = "INSERT INTO my_table (my_key_col) VALUES (?)";
   PreparedStatement pstat = conn.prepareStatement(query);
   pstat.setBytes(1, pkBytes);
   pstat.execute();
... 
```

# xml - Mule ESB：XSLT 转换器还是 Java 转换器？

> ID：11421379
> 
> 赞同：0
> 
> 时间：2012-07-10T20:25:37.103
> 
> 标签：xml, performance, esb, mule

如果我在 Mule 中使用自定义 Java 转换器代替 XSLT 转换器，是否有任何性能改进？

我有一个 cxf 代理服务和代理客户端模式，并且我的转换器用于更改有效负载，使其成为后续 SOAP Web 服务调用的有效输入。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T08:01:55.933

Measure it and see. You should never make a change to your system for performance reasons unless you can measure the effect. Focus your efforts on instrumentation, and good performance will follow naturally.

# python - “NoneType”类型的对象没有 len()，但我很确定我的对象是有效列表

> ID：11421382
> 
> 赞同：1
> 
> 时间：2012-07-10T20:25:44.907
> 
> 标签：python, list

以下模块对我来说一直失败，告诉我“NoneType”类型的对象没有 len()，但似乎传递的对象是一个列表，而不是“NoneType”类型的对象。我包括下面的模块和输出。

```
def Purge_Polyploid_MisScores(dictOfLists):
  #print "dict getting passed to Purge_Polyploid_MisScores function", dictOfLists
  for x in dictOfLists.keys():
    for y in range (0, len(dictOfLists[x])):
      print "x", x, " and y", y
      print dictOfLists[x][y]
      #if not dictOfLists[x][y]:
        #print "error at ",x,dictOfLists[str(int(x)-1)][0]
      if len(dictOfLists[x][y])>3:
        try:
          dictOfLists[x][y]=dictOfLists[x][y].remove('**')
        except:
          for z in dictOfLists[x][y]:
            if dictOfLists[x][y].count(z)>2:
              print "removed ",z," at dictOfLists[",x,"][",y,"]", dictOfLists[x][y]
              dictOfLists[x][y].remove(z)
              #I think this produces an error: dictOfLists[x][y]=dictOfLists[x][y].remove(z)
              print "now, it looks like", dictOfLists[x][y]
        if len(dictOfLists[x][y])>3:
          print "The Length is still greater than 3! at dictOfLists[",x,"][",y,"]", dictOfLists[x][y]

          #print "the reason you have a polyploid is not a mis-score"
          #print "dictOfLists[",x,"][",y,"]",dictOfLists[x][y]
      print "Reached the end of the loop"
  return dictOfLists 
```

错误之前的错误/输出：

```
x 449  and y 100
['Yellow submarine', '273', '273']
Reached the end of the loop
x 449  and y 101
['Heartland', '250', '250', '250']
removed  250  at dictOfLists[ 449 ][ 101 ] ['Heartland', '250', '250', '250']
now, it looks like ['Heartland', '250', '250']
Reached the end of the loop
x 449  and y 102
['Julia', '116', '119', '**']
Traceback (most recent call last):
  File "fast_run.py", line 11, in <module>
    sample_names_list_e1_keys_as_numbers_e2=transpose.combine_allele_report_pipeline_dict(pipeline_directory, keeplist_address, rejected_samples_address)
  File "/Users/markfisher/transpose.py", line 887, in combine_allele_report_pipeline_dict
    samples=Purge_Polyploid_MisScores(samples)
  File "/Users/markfisher/transpose.py", line 1332, in Purge_Polyploid_MisScores
    if len(dictOfLists[x][y])>3:
TypeError: object of type 'NoneType' has no len() 
```

换句话说，`['Julia', '116', '119', '**']`似乎在 if 上失败了`len(['Julia', '116', '119', '**'])>3`，我不知道为什么。

我希望我已经为你们装备了足够的东西来看到我的错误！谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-10T20:28:43.650

问题是这样的：`dictOfLists[x][y]=dictOfLists[x][y].remove('**')`。列表的方法*在原地*`remove`删除元素，改变原始列表，并返回无，因此您将列表设置为无。相反，只需执行.*`dictOfLists[x][y].remove('**')`*

 ** * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-10T20:35:59.287

@BrenBarn 得到了正确的答案，我知道这应该是评论，而不是答案；但我不能很好地在评论中发布代码。

如果在你的循环中你有`dictOfLists[x][y]`九次，那么结构上有问题。

*   用于`items()`获取键和值，而不仅仅是键然后查找值
*   用于`enumerate`获取列表中的索引和值，而不是迭代`range(len(`

更像是：

```
def Purge_Polyploid_MisScores(dictOfLists):
    for key,lst in dictOfLists.items():
        for i,val in enumerate(lst):
                print "key: %s index: %i val: %s"%(key,i,val)
                if len(val)>3:
                    val.remove('**') 
```

抱歉，如果重写冒犯了，但您考虑发布测试代码（+1）所以我想让您有建设性（希望）反馈作为回报*

# css - 图像仅在 Firefox 中具有奇怪的色调

> ID：11421389
> 
> 赞同：4
> 
> 时间：2012-07-10T20:26:10.033
> 
> 标签：css, image, firefox

我在 Firefox 渲染一些 .png 时遇到问题，这些 .png 已加载到我正在为客户准备的 Wordpress 博客中。这些图像在 IE 8 & 9 和 chrome 中看起来不错，但在 Mozilla 中看起来很不一样。我们的另一个 UX 人员告诉我，Firefox 符合嵌入式颜色配置文件，这可能会扭曲您的图像色调。您可以通过以下方式查看色调变化：

[http://blog.hendrickspower.com](http://blog.hendrickspower.com)

如果有人对如何超越颜色配置文件有任何想法，我绝对会感谢您的提醒！

谢谢

这是一张显示我所看到的差异的图像。

[替代 http://s11.postimage.org/jbnzek4g3/color_embed.jpg](http://s11.postimage.org/jbnzek4g3/color_embed.jpg)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T07:08:56.050

渲染的差异是由于图像中嵌入了 ICC 颜色配置文件。当 Firefox 找到颜色配置文件时，它会将其与显示器的颜色配置文件结合起来，并相应地调整图像渲染。这通常会确保图像在不同的显示器上显示相同。但是，如果显示配置文件不正确，也可能会导致不良影响。

至少 Windows 7 允许您[校准显示颜色](http://windows.microsoft.com/en-us/windows7/calibrate-your-display)。不确定此功能是否也存在于早期的 Windows 版本中，但他们肯定允许在高级显示设置中选择颜色配置文件 - 您可以将驱动程序提供的配置文件替换为 sRGB。

如果您绝对不希望在不同的计算机上显示不同的图像，那么您应该使用[jStrip](http://davidcrowell.com/jstrip/)和[pngcrush](http://en.wikipedia.org/wiki/Pngcrush#Reducing_filesize_by_removing_color-correction_data)之类的工具从图像中删除颜色配置文件。

# foreach - 如何根据每个循环计数动态设置元素值

> ID：11421391
> 
> 赞同：0
> 
> 时间：2012-07-10T20:26:13.847
> 
> 标签：foreach, xslt

这是我正在尝试制作的 xsl 文件的片段。

我想`request-tot-queries`根据正文中的循环计数更改标题中元素的值。您的帮助将不胜感激！

```
<HEADER>
  <request-tot-queries>$Counter</request-tot-queries>
</HEADER>
<Body>
 <xsl:for-each select="//Request/Responses/Pooled/ResidenceHistory/Residencies/Residency">
 <count><xsl:variable name="counter" select="position()"/></count>
  <xsl:if test="DateRange/To/Date[@Type!='Present']">
   <subject-query>
      .
      .
      .
   </subject-query>
  </xsl:if>
 </xsl:for-each>
</Body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T03:05:40.507

使用`count()`功能：

```
<HEADER>
  <request-tot-queries>
    <xsl:value-of select="count(//Request/Responses/Pooled/ResidenceHistory/Residencies/Residency)"/>
  </request-tot-queries>
</HEADER> 
```

# haskell - 试图制作我的类型类/实例。GHC 说“无法推断……”

> ID：11421392
> 
> 赞同：1
> 
> 时间：2012-07-10T20:26:19.830
> 
> 标签：haskell, instance, typeclass

我正在尝试制作一个简单的图形结构，并编写了以下内容。但是 GHG 会引发错误，我就堆在那里。这是我第一次制作自己的类型类，所以也许我做错了什么。有人可以解释什么是错的吗？

我发现了一个类似的问题，但我认为它不适用于我的情况。： [Error binding type variables in instance of typeclass](https://stackoverflow.com/questions/9501625/)

```
class Link l where
  node :: (Node n) => l -> n

class Node n where
  links :: (Link l) => n -> [l]

data (Node n) => SimpleLink n =
  SimpleLink
  { simpleLinkNode :: n
  } deriving (Show, Read, Eq)

instance (Node n) => Link (SimpleLink n) where
  node = simpleLinkNode

data (Link l) => SimpleNode l =
  SimpleNode
  { simpleNodeLinks :: [l]
  } deriving (Show, Read, Eq)

instance (Link l) => Node (SimpleNode l) where
  links = simpleNodeLinks 
```

这是我收到的错误消息：

```
***.hs:13:10:Could not deduce (n ~ n1)
from the context (Node n)
  bound by the instance declaration
  at ***.hs:12:10-40
or from (Node n1)
  bound by the type signature for
             node :: Node n1 => SimpleLink n -> n1
  at ***.hs:13:3-23
  `n' is a rigid type variable bound by
      the instance declaration
      at ***.hs:12:16
  `n1' is a rigid type variable bound by
       the type signature for node :: Node n1 => SimpleLink n -> n1
       at ***.hs:13:3
Expected type: SimpleLink n -> n1
  Actual type: SimpleLink n -> n
In the expression: simpleLinkNode
In an equation for `node': node = simpleLinkNode

***.hs:21:11:Could not deduce (l ~ l1)
from the context (Link l)
  bound by the instance declaration
  at ***.hs:20:10-40
or from (Link l1)
  bound by the type signature for
             links :: Link l1 => SimpleNode l -> [l1]
  at ***.hs:21:3-25
  `l' is a rigid type variable bound by
      the instance declaration
      at ***.hs:20:16
  `l1' is a rigid type variable bound by
       the type signature for links :: Link l1 => SimpleNode l -> [l1]
       at ***.hs:21:3
Expected type: SimpleNode l -> [l1]
  Actual type: SimpleNode l -> [l]
In the expression: simpleNodeLinks
In an equation for `links': links = simpleNodeLinks 
```

# 编辑 1

我尝试了[丹尼尔的一些建议](https://stackoverflow.com/questions/11421392/trying-to-make-my-typeclass-instance-ghc-says-could-not-deduce/11421801#comment15086538_11421801)。但我无法让它们工作。

## 构造函数类

得到：“`n' 没有应用于足够的类型参数”

```
class Link l n where
  node :: Node n l => l n -> n l
class Node n l where
  links :: Link l n => n l -> [l n] 
```

## 多参数类型类（MPTC）

得到：“在类声明中循环（通过超类）”

```
class (Node n) => Link l n where
  node :: l -> n
class (Link l) => Node n l where
  links :: n -> [l] 
```

## 具有函数依赖关系的 MPTC

得到：“在类声明中循环（通过超类）”

```
class (Node n) => Link l n | l -> n where
  node :: l -> n
class (Link l) => Node n l | n -> l where
  links :: n -> [l] 
```

# 目标（编辑 2）

我想要实现的是一个有向无环图结构，如下所示（更具体地说，是[因子图](https://en.wikipedia.org/wiki/Factor_graph)）。

[![PRML 图 8.51](../Images/2ea46b6384ca07e68af0faddd0121e49.png)](https://i.stack.imgur.com/BDpOV.png)
[（来源：[microsoft.com](http://research.microsoft.com/en-us/um/people/cmbishop/prml/prmlfigs-png/Figure8.51.png)）]

有两种节点（白色圆圈和红色正方形），它们只连接到不同类型的节点，这意味着有两种链接。

我想要不同版本的节点和链接，它们附加了数据（数组）。我还想要只有一种类型的节点和链接的“香草”DAG。但是为了遍历它们，我只想要一个接口来做到这一点。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-10T20:55:55.550

类方法的签名

```
class Link l where
  node :: (Node n) => l -> n

class Node n where
  links :: (Link l) => n -> [l] 
```

说“**调用者**想要的任何类型，只要它是 resp. 的成员，就可以产生它`node`。” ，但实现说只能产生一种特定类型的值。`links``Link``Node`

它与 OOP 中的接口根本不同，其中实现决定类型，调用者必须接受它，这里由调用者决定。

* * *

您在尝试构造函数时遇到了一些问题。你的类有两个参数，`l`kind`kl`和`n`of kind `kn`。参数的种类`(->)`必须都是`*`，类型的种类。因此，`l n`要成为 , 的良好参数`(->)`，`l`必须是一个类型构造函数，采用 kind 的参数`kn`并创建 kind 的结果`*`，即

```
l :: kn -> * 
```

现在您尝试将结果类型`node`设为 be `n l`，这意味着

```
n :: kl -> * 
```

但在上面我们看到`kl = kn -> *`了

```
n :: (kn -> *) -> * 
```

分别 `kn = (kn -> *) -> *`, 是无限种。无限类型，如无限类型，是不允许的。但是种类推断只实现了非常基本的，因此编译器假定参数`l`有 kind `*`，但从中看到`n l`有`n`kind `kl -> *`，因此作为 的参数`l`，`n`有错误的种类，它没有应用于足够的类型参数。

构造函数类的正常使用是单参数类

```
class Link l where
    node :: l nod -> nod

class Node n where
    links :: n lin -> [lin]

-- note that we don't have constraints here, because the kinds don't fit

instance Link SimpleLink where
    node = simpleLinkNode

instance Node SimpleNode where
    links = simpleNodeLinks 
```

您必须`DatatypeContexts`从数据声明中删除

1.  它们已从语言中删除（可通过扩展获得）
2.  无论如何，它们从来没有用过

然后上面的编译。不过，我认为这对你没有帮助。正如 Chris Kuklewicz 所观察到的，你的类型追逐自己的尾巴，你会把它们当作

```
SimpleLink (SimpleNode (SimpleLink (SimpleNode ... {- ad infinitum -}))) 
```

对于多参数类，正如编译器所说，您不能互相要求，这会导致依赖循环（此外，在您的约束中，您只使用一个参数，

```
class Node n => Link l n where ... 
```

这是格式错误的，如果循环被破坏，编译器会拒绝）。

您可以通过合并类来解决循环，

```
class NodeLinks l n | l -> n, n -> l where
    node :: l -> n
    links :: n -> l 
```

但是您仍然会遇到您的类型对此无用的问题。

抱歉，我不太了解您的目标，无法提出可行的解决方案。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-10T22:16:39.340

> 有人可以解释什么是错的吗？

在我解释错误消息之前的一个初始问题：多态数据类型很好，但最终必须使用具体类型。

对于种类的 SimpleNode 和种类的`* -> *`SimpleLinks，`* -> *`没有具体的类型：

```
SimpleNode (SimpleLink (SimpleNode (SimpleLink (SimpleNode (... 
```

你不能在 Haskell 中拥有无限类型，尽管 newtype 和 data 让你更接近：

```
type G0 = SimpleNode (SimpleLink G0)  -- illegal
newtype G1 = G1 (SimpleNode (SimpleLink G1))   -- legal
data G2 = G2 (SimpleNode (SimpleLink G2))   -- legal 
```

也许您需要在创建类型类之前重新考虑您的数据类型。

现在来解释错误消息：您的类型类`Link`定义了一个函数`node`

```
class Link l where
  node :: (Node n) => l -> n 
```

是一个神奇的`node`OOP 工厂，给定 的类型和值`l`，然后可以使任何类型`n`（以 为界`Node n`）成为愿望的调用者*。*`node`这与您的实例`n`无关：`n`

```
instance (Node n) => Link (SimpleLink n) where
  node = simpleLinkNode 
```

重复我自己：`n`上面实例中的与定义`n`中的`node :: (Node n) => l -> n`不同。编译器创建一个相关但新鲜的名称`n1`，并给您错误：

```
 `n' is a rigid type variable bound by
      the instance declaration
      at ***.hs:12:16
  `n1' is a rigid type variable bound by
       the type signature for node :: Node n1 => SimpleLink n -> n1
       at ***.hs:13:3 
```

实例中的`n`取自`node`函数输入的类型 (SimpleLink n)。`n1`是召唤者`node`要求这个魔法工厂生产的那种。如果 n 和 n1 相同，那么编译器会很高兴......但是您对类型类和实例的定义不限制这一点，因此代码片段被拒绝。

SimpleLink 中的错误重复了类似的故事。对此没有灵丹妙药。我希望您需要重新考虑和重新设计它，可能是在阅读其他人的代码之后，以便学习实现目标的方法。

你的目标是什么？图形数据结构可以是多种多样的，细节很重要。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-12T11:19:49.327

我正在打破堆栈溢出礼仪并添加第二个答案以保持独立。这是带有未标记边的二分无向图的简单代码示例，它可能对建模[因子图](http://en.wikipedia.org/wiki/Factor_graph)有用：

```
-- Bipartite graph representation, unlabeled edges

-- Data types to hold information about nodes, e.g. ID number
data VariableVertex = VV { vvID :: Int }  deriving (Show)
data FactorVertex = FV { fvID :: Int }  deriving (Show)

-- Node holds itself and a list of neighbors of the oppostite type
data Node selfType adjacentType =
  N { self :: selfType
    , adj :: [Node adjacentType selfType] }

-- A custom Show for Node to prevent infinite output
instance (Show a, Show b) => Show (Node a b) where
  show (N x ys) = "Node "++ show x ++ " near " ++ show (map self ys)

-- Type aliases for the two node types that will be used
type VariableNode = Node VariableVertex FactorVertex
type FactorNode = Node FactorVertex VariableVertex

data FactorGraph = FG [VariableNode] [FactorNode]  deriving (Show)

v1 = N (VV 1) [f1,f2]
v2 = N (VV 2) [f2]
v3 = N (VV 3) [f1,f3]
f1 = N (FV 1) [v1,v3]
f2 = N (FV 2) [v1,v2]
f3 = N (FV 3) [v3]

g = FG [v1,v2,v3] [f1,f2,f3] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-12T16:40:14.223

在 Chris Kuklewicz (http://stackoverflow.com/a/11450715/727827) 的提示下，我首先得到了我想要的代码。

但是，我认为 Crhis 的答案（`*Vertex`用于保存数据）简单且更好。我把它留在这里是为了澄清我想要什么。

```
class NodeClass n where
  adjacent :: n a b -> [n b a]

data Node selfType adjacentType =
  N
  { selfNode :: selfType
  , adjNode :: [Node adjacentType selfType] }

data NodeWithData selfType adjacentType =
  NWD
  { selfNodeWithData :: selfType
  , adjNodeWithData :: [NodeWithData adjacentType selfType]
  , getDataWithData :: [Double]
  }

instance NodeClass Node where
  adjacent = adjNode

instance NodeClass NodeWithData where
  adjacent = adjNodeWithData

data VariableVertex = VV { vvID :: Int }  deriving (Show)
data FactorVertex = FV { fvID :: Int }  deriving (Show)

type VariableNode = Node VariableVertex FactorVertex
type FactorNode = Node FactorVertex VariableVertex

type VariableNodeWithData = NodeWithData VariableVertex FactorVertex
type FactorNodeWithData = NodeWithData FactorVertex VariableVertex 
```

# php - 为什么在静态函数上显示致命错误

> ID：11421396
> 
> 赞同：15
> 
> 时间：2012-07-10T20:26:56.280
> 
> 标签：php

我有一小部分将支付记录插入数据库。下面给出：

```
<?php

class pay{
        public static function pay($user, $income, $type, $refid='--'){
        mysql_query("INSERT INTO earn VALUES (NULL, '$user', '$income', '$refid', '$type', ".time().")");   
        }
    }

?> 
```

但是浏览器给出了以下致命错误..

> 致命错误：构造函数 pay::pay() 在第 41 行的 F:\xampp\htdocs\new\sts\class.php 中不能是静态的

我很困惑为什么会发生错误..请帮助我理解。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-07-10T20:28:40.707

如果你有一个与类名相同的方法名，则认为它是一个构造函数。构造函数不能是静态的。您必须重命名此类或方法，或者使该方法*不是*静态的，并在您想要使用它时创建该类的实例。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-07-10T20:28:51.327

在 PHP 5 中，构造函数被调用`__construct`。在 PHP 4 中，它曾经是类的名称，例如`function pay`for `class pay`。PHP 5 向后兼容 PHP 4，所以它仍然有效。构造函数不能`static`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-10T20:29:14.203

构造函数在创建对象时被调用，因此不能是静态的。通过命名与类相同的函数，php 认为您希望它成为构造函数

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-10T20:30:01.497

与定义它的类名称相同的方法不是普通方法，而是构造函数，用于创建该类的新实例。构造函数不允许是静态的，因为它们的全部意义在于作用于新创建的类实例。

# python - 使用 yum 时如何修复“错误的解释器”错误？

> ID：11421399
> 
> 赞同：3
> 
> 时间：2012-07-10T20:27:10.040
> 
> 标签：python, yum

```
$ yum install httpd-devel
-bash: /usr/bin/yum: /usr/bin/python: bad interpreter: No such file or directory 
```

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-10T21:19:31.110

任何 bash、Perl 或 Python 脚本的第一行都告诉 bash 在哪里可以找到正确的解释器。对于百胜是：

```
#!/usr/bin/python 
```

您可以通过键入以下内容来判断 Python 的实际安装位​​置：

```
which python 
```

解决此问题的最佳方法是添加符号链接。例如：

```
ln -s /usr/local/bin/python /usr/bin/python 
```

这样你就不必在每个脚本中修复它。

# django - 在哪里删除模型图像？

> ID：11421404
> 
> 赞同：4
> 
> 时间：2012-07-10T20:27:31.113
> 
> 标签：django, django-models, django-forms

我有一个带有图像字段的模型，我希望能够使用 ModelForm 更改图像。更换镜像时，应将旧镜像删除，换上新镜像。

我曾尝试在 ModelForm 的 clean 方法中执行此操作，如下所示：

```
 def clean(self):
        cleaned_data = super(ModelForm, self).clean()

        old_profile_image = self.instance.image
        if old_profile_image:
            old_profile_image.delete(save=False)        
        return cleaned_data 
```

这可以正常工作，除非用户指示的文件不正确（例如，如果它不是图像），这会导致图像被删除而没有保存任何新图像。我想知道删除旧图像的最佳位置在哪里？我的意思是在删除旧图像之前，我在哪里可以确定新图像是正确的？

编辑：如果可能的话，我更喜欢在我的 ModelForm 类中执行此操作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T21:21:40.607

一些答案：

ImageField 应该通过 Python 图像库验证上传的文件是图像。如果不是，则表单将无法验证。

您的 ImageField 应该在其路径属性中包含旧文件的路径。

保存新图像后，您可以删除旧图像。更好的是，永远不要使用用户的文件名输入作为文件名。这样更安全，您可以只使用相同的文件名 - 然后您每次只需覆盖旧文件即可删除删除步骤。

祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-15T18:55:09.297

好的，我想出了如何使用 ModelForm 以干净的方式做到这一点。基本上我创建了一个名为“ChangeImageForm”的类，它将确保在更改图像时删除旧图像。此外，如果图像无效，它也可以工作：

```
class ChangeImageForm(ModelForm):

    def clean(self):
        cleaned_data = super(ModelForm, self).clean()
        self.old_image = self.instance.image
        return cleaned_data

    def save(self, commit=True):
        instance = super(ChangeImageForm, self).save(commit)

        if self.old_image:
            self.old_image.delete(save=False)

        return instance 
```

现在我可以通过继承 ChangeImageForm 轻松地将上述功能添加到具有图像字段的 ModelForm 中，如下所示：

```
class MyModelForm(ChangeImageForm):
    class Meta:
        model = MyModel # model with an image field 
```

我认为覆盖 ModelForm 是最好的方法，而不是在 Model 类中，因为在某些情况下我只想删除旧图像。

# javascript - Bootstrap scrollspy 在选项卡中不起作用？

> ID：11421408
> 
> 赞同：5
> 
> 时间：2012-07-10T20:27:46.423
> 
> 标签：javascript, jquery, css, twitter-bootstrap

下面是我的代码，但我知道它没有任何问题，因为当您将其从选项卡中取出时它工作正常。也没有重复的 ID，我认为这可能是导致问题的原因。无论如何，如果有人有任何想法或解决方法，那就太好了！

```
<div id="sampleNavbar" class="navbar navbar-static">
    <div class="navbar-inner">
        <div class="container" style="width: auto;">
            <a class="brand" href="#">Project Name</a>
            <ul class="nav">
                <li><a href="#PA">PA</a></li>
                <li><a href="#VT">VT</a></li>
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Dropdown <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        <li><a href="#uno">uno</a></li>
                        <li><a href="#dos">dos</a></li>
                        <li class="divider"></li>
                        <li><a href="#tres">tres</a></li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
</div>
<div id="scrollspy-example" data-spy="scroll" data-target="#sampleNavbar" data-offset="300" style="height: 200px; overflow-y: scroll;">
    <h4 id="PA">PA</h4>
    <p>Ad leggings keytar, brunch id art party dolor labore. Pitchfork yr enim lo-fi before they sold out qui. Tumblr farm-to-table bicycle rights whatever. Anim keffiyeh carles cardigan. Velit seitan mcsweeney's photo booth 3 wolf moon irure. Cosby sweater lomo jean shorts, williamsburg hoodie minim qui you probably haven't heard of them et cardigan trust fund culpa biodiesel wes anderson aesthetic. Nihil tattooed accusamus, cred irony biodiesel keffiyeh artisan ullamco consequat.
    </p>
    <h4 id="VT">VT</h4>
    <p>Veniam marfa mustache skateboard, adipisicing fugiat velit pitchfork beard. Freegan beard aliqua cupidatat mcsweeney's vero. Cupidatat four loko nisi, ea helvetica nulla carles. Tattooed cosby sweater food truck, mcsweeney's quis non freegan vinyl. Lo-fi wes anderson +1 sartorial. Carles non aesthetic exercitation quis gentrify. Brooklyn adipisicing craft beer vice keytar deserunt.
    </p>
    <h4 id="uno">uno</h4>
    <p>Occaecat commodo aliqua delectus. Fap craft beer deserunt skateboard ea. Lomo bicycle rights adipisicing banh mi, velit ea sunt next level locavore single-origin coffee in magna veniam. High life id vinyl, echo park consequat quis aliquip banh mi pitchfork. Vero VHS est adipisicing. Consectetur nisi DIY minim messenger bag. Cred ex in, sustainable delectus consectetur fanny pack iphone.
    </p>
    <h4 id="dos">dos</h4>
    <p>In incididunt echo park, officia deserunt mcsweeney's proident master cleanse thundercats sapiente veniam. Excepteur VHS elit, proident shoreditch +1 biodiesel laborum craft beer. Single-origin coffee wayfarers irure four loko, cupidatat terry richardson master cleanse. Assumenda you probably haven't heard of them art party fanny pack, tattooed nulla cardigan tempor ad. Proident wolf nesciunt sartorial keffiyeh eu banh mi sustainable. Elit wolf voluptate, lo-fi ea portland before they sold out four loko. Locavore enim nostrud mlkshk brooklyn nesciunt.
    </p>
    <h4 id="tres">tres</h4>
    <p>Ad leggings keytar, brunch id art party dolor labore. Pitchfork yr enim lo-fi before they sold out qui. Tumblr farm-to-table bicycle rights whatever. Anim keffiyeh carles cardigan. Velit seitan mcsweeney's photo booth 3 wolf moon irure. Cosby sweater lomo jean shorts, williamsburg hoodie minim qui you probably haven't heard of them et cardigan trust fund culpa biodiesel wes anderson aesthetic. Nihil tattooed accusamus, cred irony biodiesel keffiyeh artisan ullamco consequat.
    </p>
    <p>Keytar twee blog, culpa messenger bag marfa whatever delectus food truck. Sapiente synth id assumenda. Locavore sed helvetica cliche irony, thundercats you probably haven't heard of them consequat hoodie gluten-free lo-fi fap aliquip. Labore elit placeat before they sold out, terry richardson proident brunch nesciunt quis cosby sweater pariatur keffiyeh ut helvetica artisan. Cardigan craft beer seitan readymade velit. VHS chambray laboris tempor veniam. Anim mollit minim commodo ullamco thundercats.
    </p>
</div> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-11T15:25:41.767

这不是 Bootstrap 中的错误。发生的情况是，当您的页面加载时，带有 scrollspy 元素的选项卡被隐藏。因此，当 scrollspy 插件试图在你的滚动 div 中找到`$.position()`每个的时`<h4 id="foo">`，它们会调用 return `{top: 0, left: 0}`。这就是为什么您在滚动时看到闪烁的原因；该插件认为你所有的滚动目标都在同一个位置。

如果您查看[scrollspy 插件的文档](http://twitter.github.com/bootstrap/javascript.html#scrollspy)，您会看到它提到如果您在 DOM 中添加或删除元素，您需要调用该`.scrollspy('refresh')`函数，以便插件可以重新评估各种滚动目标的位置。

也就是说，您需要做的是等到加载了滚动间谍内容的选项卡，然后调用刷新函数，就像这样。请注意，我还将所有单独的点击处理程序合并到一个处理程序中

```
$(function(){
    $('.nav-tabs li a').click(function(e) {
        e.preventDefault();
        $(this).tab('show');

        // If we are showing the scrollspy tab, let the
        // plugin refresh itself so it can function properly
        if(this.id === 'scrotab') {
            $(this).on('shown',function(){ 
                $('#scrollspy-example').scrollspy('refresh'); 
            });
        }
    });
}); 
```

此外，您需要使用 CSS将元素设置为，而不是在元素上使用`data-offset="300"`属性：`<div id="scrollspy-example">``position``relative`

```
#scrollspy-example {
    position: relative;
} 
```

这是一个有效的 jsFiddle 演示：

[**http://jsfiddle.net/GyMYE/3/**](http://jsfiddle.net/GyMYE/3/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T18:52:55.140

添加：

```
$('#scrollspy-example').scrollspy('process'); 
```

之后：

```
$('#scrollspy-example').scrollspy('refresh'); 
```

确保在您加载此特定选项卡时更新正确的位置。否则，scrollspy 将突出显示错误的 li 元素，直到您移动/开始滚动，从而导致刷新。'process' 行在选项卡加载时执行此操作。

# c++ - Xcode 和 Clang 神秘地包含我未指定的标头

> ID：11421410
> 
> 赞同：0
> 
> 时间：2012-07-10T20:27:47.497
> 
> 标签：c++, compiler-errors, cmake, xcode4.3, clang

我有一个带有以下代码的标头，该标头具有源自头文件 /usr/include/sys/param.h 中 CROUND 定义的神秘错误，该错误未包含在代码本身或通过命令行参数中：

```
#ifndef _PARSERTYPES_H_
#define _PARSERTYPES_H_    

#ifdef CROUND
#warning #undef CROUND applied, defined in /usr/include/sys/param.h  
#undef CROUND
#endif // CROUND
enum TokType
{
  FLOATING, INTEGER, STRING, SYMBOL,
    OCURLY, CCURLY, OROUND, CROUND, OSQUARE, CSQUARE, 
};    

#endif // _PARSERTYPES_H_ 
```

使用简化的 clang (c++) 或 gcc (g++) 编译器命令编译：

```
cd /path/to/build3/modules/device/examples/sweep && /usr/bin/g++   -DQT_OPENGL_LIB -DQT_DESIGNER_LIB -DQT_GUI_LIB -DQT_SQL_LIB -DQT_NETWORK_LIB -DQT_CORE_LIB -D__DC1394__ - -DQT_NO_DEBUG -O3 -DNDEBUG -I/path/to/modules//. -I/opt/local/include -I/opt/local/include/opencv -I/usr/local/include -I/opt/local/include/QtOpenGL -I/opt/local/include/QtDesigner -I/opt/local/include/QtGui -I/opt/local/include/QtSql -I/opt/local/include/QtNetwork -I/opt/local/include/QtCore -I/Library/Frameworks/FreeType.framework/Headers -F/Library/Frameworks -I/opt/local/include/glib-2.0 -I/opt/local/lib/glib-2.0/include -I/opt/local/include/gdk-pixbuf-2.0 -I/opt/local/include/gtk-2.0 -I/opt/local/lib/gtk-2.0/include -I/Library/Frameworks/cairo.framework/Headers -I/opt/local/include/pango-1.0 -I/opt/local/include/atk-1.0    -o CMakeFiles/Example.dir/Example.cpp.o -c /path/to/modules/Example.cpp 
```

这会产生以下（clang）错误：

```
In file included from /path/to/parser/parser.h:69:
path/to/parser/parserTypes.h:58:26: error: expected '}'
        OCURLY, CCURLY, OROUND, CROUND, OSQUARE, CSQUARE, 
                                ^
/usr/include/sys/param.h:171:16: note: expanded from macro 'CROUND'
#define CROUND  (CBLOCK - 1)    /* Clist rounding. */
                ^
/path/to/parser/parserTypes.h:56:1: note: to match this '{'
{ 
```

我能够使用#undef CROUND 解决这个问题，但显然这是一个非常临时的解决方案。

什么可能是这个问题的根源和适当的解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-10T20:30:40.083

你可能包括一些系统头文件，对吧？这些通常包括一大堆其他标题......

编辑：至于解决方案...

a) 使用其他不冲突的名称

b）在相当新的编译器上，使用枚举类（除非您与宏冲突......这里似乎就是这种情况）

编辑2：一般来说，我不建议尝试通过廉价的技巧来“解决”其他标题，例如#defining包含保护宏或类似的东西。系统标头最好不要管。

# python - neo4j-python 错误

> ID：11421417
> 
> 赞同：0
> 
> 时间：2012-07-10T20:28:08.917
> 
> 标签：python, neo4j

我有一个奇怪的问题。刚开始用neo4j db，想玩一点

我从那里下载了代码

[https://github.com/neo4j-examples/python-shop-categories](https://github.com/neo4j-examples/python-shop-categories)

在示例中

```
import neo4j # works fine 
```

但

```
from neo4j.util import Subreference # doesnt work 
```

# 错误

```
 File "/usr/lib/python2.7/runpy.py", line 162, in _run_module_as_main
 "__main__", fname, loader, pkg_name)
 File "/usr/lib/python2.7/runpy.py", line 72, in _run_code
  exec code in run_globals
 File "/home/mohit/Documents/personal_pro/python-shop-categories/shop/__main__.py", line 65, in <module>
   options.ui.start(*args, **params)
 File "/home/mohit/Documents/personal_pro/python-shop-categories/shop/__main__.py", line 49, in start
  exec("from shop.%sui import start" % (self.module,), environ)
 File "<string>", line 1, in <module>
  File "/home/mohit/Documents/personal_pro/python-shop-categories/shop/__init__.py", line 13, in <module>
   from neo4j.util import Subreference
 ImportError: cannot import name Subreference 
```

所以我猜一切都已安装..并设置..一个导入如何工作但另一个不工作？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T02:50:30.343

那是一些在 2 年内没有更新的旧代码，所以它不会工作。

请尝试使用灯泡快速入门：http: [//bulbflow.com/quickstart/](http://bulbflow.com/quickstart/)

*   詹姆士

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T11:49:21.087

有关更多更新示例，请尝试[http://docs.neo4j.org/chunked/snapshot/python-embedded-installation.html](http://docs.neo4j.org/chunked/snapshot/python-embedded-installation.html)等。

# java - 重写方法的方法

> ID：11421422
> 
> 赞同：0
> 
> 时间：2012-07-10T20:28:25.917
> 
> 标签：java, overriding

我的超类我有一个方法：

```
public void addController(ActionListener controller)
{
    button.addActionListener(controller);
} 
```

在派生类中我必须实现`addController`添加`button.setActionCommand("something");`我必须重写方法`addcontroller()`或简单地添加`super()`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-10T20:32:01.823

尝试这个...

如果您想**在 Super 类中实现该方法，并且还想添加 button.setActionCommand("something")，那么请执行此操作..**

通过**在 addController 中添加超级调用以及您的 setActionCommand**

```
public void addController(ActionListener controller)
{
    super.addController(controller)
    button.setActionCommand("something");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-10T20:35:58.833

你有两个选择：

```
@Override
public void addController(ActionListener controller)
{
    super.addController(controller)
    button.setActionCommand("something");
} 
```

或者

```
@Override
public void addController(ActionListener controller)
{
    button.addActionListener(controller);
    button.setActionCommand("something");
} 
```

两者的表现将相似。

# c++ - 具有 boost 变体递归包装器的字符串解析器

> ID：11421430
> 
> 赞同：4
> 
> 时间：2012-07-10T20:28:46.590
> 
> 标签：c++, parsing, boost-spirit, boost-variant

下面的代码（改编自 Spirit qi mini_xml 示例）无法编译。存在与`brac`具有递归属性的规则相关的错误`boost::variant`。
但是，所有注释掉的`brac`do compile 版本。

我很想知道是什么让简单的字符串解析器在这种情况下如此特别：

```
#include <boost/config/warning_disable.hpp>
#include <boost/spirit/include/qi.hpp>
#include <boost/spirit/include/phoenix_core.hpp>
#include <boost/spirit/include/phoenix_operator.hpp>
#include <boost/spirit/include/phoenix_fusion.hpp>
#include <boost/spirit/include/phoenix_stl.hpp>
#include <boost/spirit/include/phoenix_object.hpp>
#include <boost/fusion/include/adapt_struct.hpp>
#include <boost/variant/recursive_variant.hpp>

#include <string>
#include <vector>

namespace client
{
   namespace fusion = boost::fusion;
   namespace phoenix = boost::phoenix;
   namespace qi = boost::spirit::qi;
   namespace ascii = boost::spirit::ascii;

   struct ast_node;

   typedef boost::variant<
      boost::recursive_wrapper<ast_node>,
      std::string
   > ast_branch;

   struct ast_node
   {
      std::string text;
      std::vector<ast_branch> children;
   };
}

BOOST_FUSION_ADAPT_STRUCT(
      client::ast_node,
      (std::string, text)
      (std::vector<client::ast_branch>, children)
)

namespace client
{
   template <typename Iterator>
      struct ast_node_grammar
      : qi::grammar<Iterator, ast_branch(), ascii::space_type>
      {
         ast_node_grammar()
            : ast_node_grammar::base_type(brac)
         {
            using qi::_1;
            using qi::_val;
            using ascii::char_;
            using ascii::string;

            name %= *char_;

            brac %= string("no way") ;
//            brac = string("works")[_val = _1] ;
//            brac %= string("this") | string("works");
//            brac %= name ; // works
//            brac %= *char_ ; // works
         }
         qi::rule<Iterator, std::string()> name;
         qi::rule<Iterator, ast_branch(), ascii::space_type> brac;
      };
}

int main(int argc, char **argv)
{
   typedef client::ast_node_grammar<std::string::const_iterator> ast_node_grammar;
   ast_node_grammar gram;
   client::ast_branch ast;

   std::string text("dummy");
   using boost::spirit::ascii::space;
   std::string::const_iterator iter = text.begin();
   std::string::const_iterator end = text.end();
   bool r = phrase_parse(iter, end, gram, space, ast);
   return r ? 0 : 1;
} 
```

部分错误信息：

```
/usr/include/boost/spirit/home/qi/detail/assign_to.hpp:38:17: error: No match for ‘boost::variant<
        boost::recursive_wrapper<client::ast_node>, basic_string<char> 
>::variant(
        const __normal_iterator<const char *, basic_string<char> > &, const __normal_iterator<
            const char *, basic_string<char> > &)’ 
```

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-10T22:04:10.623

我建议问题是属性兼容性。与[文档](http://www.boost.org/doc/libs/1_50_0/libs/spirit/doc/html/spirit/qi/reference/string/string.html)相反， ascii::string 解析器似乎公开了一个*迭代器范围*而不是一个*字符串*。

```
name = string("no way"); 
```

没问题，因为 ascii::string 暴露的属性可以毫无困难地强制转换为规则的属性类型。

但是，`brac`规则的属性类型是`ast_branch`，它只是一个*变体*，它具有其中一种可能包含的类型。因此，该`ast_branch`类型有几个构造函数，Spirit 并不清楚哪个构造函数适合这种特定的转换。

有几种方法（除了你已经展示的方法）：

*   利用`attr_cast`

    ```
    brac = qi::attr_cast( string("no way") ); 
    ```

*   利用`as_string`

    ```
    brac = qi::as_string[ string("no way") ]; 
    ```

*   使用自定义点

    ```
    namespace boost { namespace spirit { namespace traits {
        template <typename It>
            struct assign_to_attribute_from_iterators<client::ast_branch, It>
            {
                static void call(It const& f, It const& l, client::ast_branch& val)
                {
                    val = std::string(f, l);
                }
            };
    }}} 
    ```

每一个都有相同的效果：让Spirit实现使用什么属性转换。

这是一个完整的工作示例，显示了所有三个：

```
// #define BOOST_SPIRIT_ACTIONS_ALLOW_ATTR_COMPAT
#include <boost/config/warning_disable.hpp>
#include <boost/spirit/include/qi.hpp>
#include <boost/fusion/adapted.hpp>
#include <boost/spirit/include/phoenix.hpp>
#include <boost/variant/recursive_variant.hpp>

#include <string>
#include <vector>

namespace client
{
   namespace fusion  = boost::fusion;
   namespace phoenix = boost::phoenix;
   namespace qi      = boost::spirit::qi;
   namespace ascii   = boost::spirit::ascii;

   struct ast_node;

   typedef boost::variant<
      boost::recursive_wrapper<ast_node>,
      std::string
   > ast_branch;

   struct ast_node
   {
      std::string text;
      std::vector<ast_branch> children;
   };
}

namespace boost { namespace spirit { namespace traits {
    template <typename It>
        struct assign_to_attribute_from_iterators<client::ast_branch, It>
        {
            static void call(It const& f, It const& l, client::ast_branch& val)
            {
                val = std::string(f, l);
            }
        };
}}}

BOOST_FUSION_ADAPT_STRUCT(
      client::ast_node,
      (std::string, text)
      (std::vector<client::ast_branch>, children)
)

namespace client
{
    template <typename Iterator>
        struct ast_node_grammar : qi::grammar<Iterator, ast_branch(), ascii::space_type>
    {
        ast_node_grammar()
            : ast_node_grammar::base_type(brac)
        {
            using qi::_1;
            using qi::_val;
            using ascii::char_;
            using ascii::string;

            name %= *char_;

            brac = string("works");
            brac = string("works")[_val = _1] ;
            brac %= string("this") | string("works");
            brac %= name ; // works
            brac %= *char_ ; // works

            brac = qi::as_string[ string("no way") ];
            brac = qi::attr_cast( string("no way") );
        }
        qi::rule<Iterator, std::string()> name;
        qi::rule<Iterator, ast_branch(), ascii::space_type> brac;
    };
}

int main(int argc, char **argv)
{
   typedef client::ast_node_grammar<std::string::const_iterator> ast_node_grammar;
   ast_node_grammar gram;
   client::ast_branch ast;

   std::string text("dummy");
   using boost::spirit::ascii::space;
   std::string::const_iterator iter = text.begin();
   std::string::const_iterator end = text.end();
   bool r = phrase_parse(iter, end, gram, space, ast);
   return r ? 0 : 1;
} 
```

# c++ - 如何在 C++11 中输出枚举类的值

> ID：11421432
> 
> 赞同：123
> 
> 时间：2012-07-10T20:28:50.303
> 
> 标签：c++, c++11, templates, enums, enum-class

如何`enum class`在 C++11 中输出 an 的值？在 C++03 中是这样的：

```
#include <iostream>

using namespace std;

enum A {
  a = 1,
  b = 69,
  c= 666
};

int main () {
  A a = A::c;
  cout << a << endl;
} 
```

在 c++0x 中，此代码无法编译

```
#include <iostream>

using namespace std;

enum class A {
  a = 1,
  b = 69,
  c= 666
};

int main () {
  A a = A::c;
  cout << a << endl;
}

prog.cpp:13:11: error: cannot bind 'std::ostream' lvalue to 'std::basic_ostream<char>&&'
/usr/lib/gcc/i686-pc-linux-gnu/4.5.1/../../../../include/c++/4.5.1/ostream:579:5: error:   initializing argument 1 of 'std::basic_ostream<_CharT, _Traits>& std::operator<<(std::basic_ostream<_CharT, _Traits>&&, const _Tp&) [with _CharT = char, _Traits = std::char_traits<char>, _Tp = A]' 
```

在[Ideone.com编译](https://ideone.com/)

* * *

## 回答 #1

> 赞同：152
> 
> 时间：2012-07-10T20:32:20.277

与无范围枚举不同，有范围枚举不能*隐式*转换为其整数值。您需要使用强制转换将其*显式*转换为整数：

```
std::cout << static_cast<std::underlying_type<A>::type>(a) << std::endl; 
```

您可能希望将逻辑封装到函数模板中：

```
template <typename Enumeration>
auto as_integer(Enumeration const value)
    -> typename std::underlying_type<Enumeration>::type
{
    return static_cast<typename std::underlying_type<Enumeration>::type>(value);
} 
```

用作：

```
std::cout << as_integer(a) << std::endl; 
```

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2012-07-10T20:33:41.400

```
#include <iostream>
#include <type_traits>

using namespace std;

enum class A {
  a = 1,
  b = 69,
  c= 666
};

std::ostream& operator << (std::ostream& os, const A& obj)
{
   os << static_cast<std::underlying_type<A>::type>(obj);
   return os;
}

int main () {
  A a = A::c;
  cout << a << endl;
} 
```

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2015-01-29T04:02:12.413

可以使您的第二个示例（即使用范围枚举的示例）使用与无范围枚举相同的语法来工作。此外，该解决方案是通用的，适用于所有范围枚举，而不是为每个范围枚举编写代码（如[@ForEveR](https://stackoverflow.com/users/1498580/forever)提供的[答案](https://stackoverflow.com/a/11421489/4505712)所示）。

解决方案是编写一个`operator<<`适用于任何范围枚举的通用函数。解决方案采用[SFINAE](http://en.cppreference.com/w/cpp/language/sfinae) via [`std::enable_if`](http://en.cppreference.com/w/cpp/types/enable_if)，如下。

```
#include <iostream>
#include <type_traits>

// Scoped enum
enum class Color
{
    Red,
    Green,
    Blue
};

// Unscoped enum
enum Orientation
{
    Horizontal,
    Vertical
};

// Another scoped enum
enum class ExecStatus
{
    Idle,
    Started,
    Running
};

template<typename T>
std::ostream& operator<<(typename std::enable_if<std::is_enum<T>::value, std::ostream>::type& stream, const T& e)
{
    return stream << static_cast<typename std::underlying_type<T>::type>(e);
}

int main()
{
    std::cout << Color::Blue << "\n";
    std::cout << Vertical << "\n";
    std::cout << ExecStatus::Running << "\n";
    return 0;
} 
```

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2019-01-31T14:41:59.060

为了写得更简单，

```
enum class Color
{
    Red = 1,
    Green = 11,
    Blue = 111
};

int value = static_cast<int>(Color::Blue); // 111 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2014-11-07T19:57:27.737

（我还不允许发表评论。）我建议对 James McNellis 已经很好的答案进行以下改进：

```
template <typename Enumeration>
constexpr auto as_integer(Enumeration const value)
    -> typename std::underlying_type<Enumeration>::type
{
    static_assert(std::is_enum<Enumeration>::value, "parameter is not of type enum or enum class");
    return static_cast<typename std::underlying_type<Enumeration>::type>(value);
} 
```

和

*   `constexpr`：允许我使用枚举成员值作为编译时数组大小
*   `static_assert`+ `is_enum`：“确保”函数执行某事的编译时间。仅使用枚举，如建议的那样

顺便问一下自己：`enum class`当我想为我的枚举成员分配数字值时，为什么要使用？！考虑转换工作。

也许我会像我在这里建议的那样回到普通状态`enum`：[如何在 C++ 中使用枚举作为标志？](https://stackoverflow.com/questions/1448396/how-to-use-enums-as-flags-in-c/26690986#26690986)

* * *

根据@TobySpeight 的建议，它的另一种（更好的）风格没有 static_assert：

```
template <typename Enumeration>
constexpr std::enable_if_t<std::is_enum<Enumeration>::value,
std::underlying_type_t<Enumeration>> as_number(const Enumeration value)
{
    return static_cast<std::underlying_type_t<Enumeration>>(value);
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2019-07-20T09:04:10.813

以下在 C++11 中为我工作：

```
template <typename Enum>
constexpr typename std::enable_if<std::is_enum<Enum>::value,
                                  typename std::underlying_type<Enum>::type>::type
to_integral(Enum const& value) {
    return static_cast<typename std::underlying_type<Enum>::type>(value);
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-10-22T08:10:15.637

由于 c++23 有

[`std::to_underlying`](https://en.cppreference.com/w/cpp/utility/to_underlying)它与所有其他答案的作用相同，但它在 std

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-10-02T16:37:46.443

你可以这样做：

```
//outside of main
namespace A
{
    enum A
    {
        a = 0,
        b = 69,
        c = 666
    };
};

//in main:

A::A a = A::c;
std::cout << a << std::endl; 
```

# c++ - 如何可移植地调用在某些平台上采用 char** 而在其他平台上采用 const char** 的 C++ 函数？

> ID：11421439
> 
> 赞同：91
> 
> 时间：2012-07-10T20:29:03.687
> 
> 标签：c++, constants, portability

在我的 Linux（和 OS X）机器上，该`iconv()`函数具有以下原型：

```
size_t iconv (iconv_t, char **inbuf... 
```

在 FreeBSD 上它看起来像这样：

```
size_t iconv (iconv_t, const char **inbuf... 
```

我希望我的 C++ 代码能够在两个平台上构建。`char**`对于 C 编译器，为参数传递 a `const char**`（反之亦然）通常只会发出警告；但是在 C++ 中，这是一个致命错误。所以如果我通过 a `char**`，它不会在 BSD 上编译，如果我通过 a`const char**`它不会在 Linux / OS X 上编译。我怎样才能编写在两者上编译的代码，而不诉诸于尝试检测平台？

我的一个（失败的）想法是提供一个本地原型来覆盖标头提供的任何原型：

```
void myfunc(void) {
    size_t iconv (iconv_t, char **inbuf);
    iconv(foo, ptr);
} 
```

这失败了，因为`iconv`需要 C 链接，并且您不能放入`extern "C"`函数中（为什么不呢？）

我想出的最好的工作想法是转换函数指针本身：

```
typedef void (*func_t)(iconv_t, const char **);
((func_t)(iconv))(foo, ptr); 
```

但这有可能掩盖其他更严重的错误。

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2012-07-10T21:45:51.920

如果你想要的只是对一些 const 问题视而不见，那么你可以使用模糊区别的转换，即使 char** 和 const char** 可互操作：

```
template<class T>
class sloppy {}; 

// convert between T** and const T** 
template<class T>
class sloppy<T**>
{
    T** t;
    public: 
    sloppy(T** mt) : t(mt) {}
    sloppy(const T** mt) : t(const_cast<T**>(mt)) {}

    operator T** () const { return t; }
    operator const T** () const { return const_cast<const T**>(t); }
}; 
```

然后在程序的后面：

```
iconv(c, sloppy<char**>(&in) ,&inlen, &out,&outlen); 
```

sloppy() 接受 a`char**`或 a`const char*`并将其转换为 a`char**`或 a `const char*`，无论 iconv 的第二个参数需要什么。

更新：更改为使用 const_cast 并调用 sloppy 而不是 as cast。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2012-07-10T20:52:59.090

您可以通过检查声明函数的签名来消除两个声明之间的歧义。这是检查参数类型所需的模板的基本示例。这可以很容易地概括（或者您可以使用 Boost 的函数特征），但这足以证明您的特定问题的解决方案：

```
#include <iostream>
#include <stddef.h>
#include <type_traits>

// I've declared this just so the example is portable:
struct iconv_t { };

// use_const<decltype(&iconv)>::value will be 'true' if the function is
// declared as taking a char const**, otherwise ::value will be false.
template <typename>
struct use_const;

template <>
struct use_const<size_t(*)(iconv_t, char**, size_t*, char**, size_t*)>
{
    enum { value = false };
};

template <>
struct use_const<size_t(*)(iconv_t, char const**, size_t*, char**, size_t*)>
{
    enum { value = true };
}; 
```

这是一个演示该行为的示例：

```
size_t iconv(iconv_t, char**, size_t*, char**, size_t*);
size_t iconv_const(iconv_t, char const**, size_t*, char**, size_t*);

int main()
{
    using std::cout;
    using std::endl;

    cout << "iconv: "       << use_const<decltype(&iconv)      >::value << endl;
    cout << "iconv_const: " << use_const<decltype(&iconv_const)>::value << endl;
} 
```

一旦你可以检测到参数类型的限定，你可以编写两个调用的包装函数`iconv`：一个`iconv`用`char const**`参数调用`iconv`，一个用`char**`参数调用。

因为应该避免函数模板特化，所以我们使用类模板来进行特化。请注意，我们还将每个调用程序都设为函数模板，以确保仅实例化我们使用的特化。如果编译器试图为错误的特化生成代码，你会得到错误。

然后我们用 a 包装它们的用法，`call_iconv`使调用它就像`iconv`直接调用一样简单。以下是显示如何编写的一般模式：

```
template <bool UseConst>
struct iconv_invoker
{
    template <typename T>
    static size_t invoke(T const&, /* arguments */) { /* etc. */ }
};

template <>
struct iconv_invoker<true>
{
    template <typename T>
    static size_t invoke(T const&, /* arguments */) { /* etc. */ }
};

size_t call_iconv(/* arguments */)
{
    return iconv_invoker<
        use_const<decltype(&iconv)>::value
    >::invoke(&iconv, /* arguments */);
} 
```

（后一种逻辑可以被清理和概括；我试图让每一部分都明确，希望能更清楚地说明它是如何工作的。）

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-07-10T21:05:30.177

您可以使用以下内容：

```
template <typename T>
size_t iconv (iconv_t i, const T inbuf)
{
   return iconv(i, const_cast<T>(inbuf));
}

void myfunc(void) {
  const char** ptr = // ...
  iconv(foo, ptr);
} 
```

您可以通过`const char**`，在 Linux/OSX 上它将通过模板功能，在 FreeBSD 上它将直接转到`iconv`.

缺点：它将允许像这样的调用`iconv(foo, 2.5)`，这将使编译器无限重复。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-07-10T20:36:28.230

```
#ifdef __linux__
... // linux code goes here.
#elif __FreeBSD__
... // FreeBSD code goes here.
#endif 
```

[在这里](http://sourceforge.net/apps/mediawiki/predef/index.php?title=Operating_Systems)，您有所有操作系统的 ID。对我来说，在不检查这个系统的情况下尝试做一些依赖于操作系统的事情没有任何意义。这就像买了一条绿裤子，却不看它们。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-10T20:41:12.530

怎么样

```
static void Test(char **)
{
}

int main(void)
{
    const char *t="foo";
    Test(const_cast<char**>(&t));
    return 0;
} 
```

编辑：当然，“不检测平台”有点问题。哎呀:-(

编辑2：好的，改进版本，也许？

```
static void Test(char **)
{
}

struct Foo
{
    const char **t;

    operator char**() { return const_cast<char**>(t); }
    operator const char**() { return t; }

    Foo(const char* s) : t(&s) { }
};

int main(void)
{
    Test(Foo("foo"));
    return 0;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-10T20:50:50.080

您已经表明使用自己的包装函数是可以接受的。你似乎也愿意接受警告。

因此，不要用 C++ 编写包装器，而是用 C 编写它，在某些系统上您只会收到警告：

```
// my_iconv.h

#if __cpluscplus
extern "C" {
#endif

size_t my_iconv( iconv_t cd, char **restrict inbuf, ?* etc... */);

#if __cpluscplus
}
#endif

// my_iconv.c
#include <iconv.h>
#include "my_iconv.h"

size_t my_iconv( iconv_t cd, char **inbuf, ?* etc... */)
{
    return iconv( cd, 
                inbuf /* will generate a warning on FreeBSD */,
                /* etc... */
                );
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-07-10T20:53:22.367

*更新：现在我看到可以在没有自动工具的情况下在 C++ 中处理它，但我将 autoconf 解决方案留给寻找它的人。*

您正在寻找的是`iconv.m4`由 gettext 包安装的。

AFAICS 只是：

```
AM_ICONV 
```

在 configure.ac 中，它应该检测到正确的原型。

然后，在您使用的代码中：

```
#ifdef ICONV_CONST
// const char**
#else
// char**
#endif 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-07-10T22:18:16.570

关于什么：

```
#include <cstddef>
using std::size_t;

// test harness, these definitions aren't part of the solution
#ifdef CONST_ICONV
    // other parameters removed for tediousness
    size_t iconv(const char **inbuf) { return 0; }
#else
    // other parameters removed for tediousness
    size_t iconv(char **inbuf) { return 0; }
#endif

// solution
template <typename T>
size_t myconv_helper(size_t (*system_iconv)(T **), char **inbuf) {
    return system_iconv((T**)inbuf); // sledgehammer cast
}

size_t myconv(char **inbuf) {
    return myconv_helper(iconv, inbuf);
}

// usage
int main() {
    char *foo = 0;
    myconv(&foo);
} 
```

我认为这违反了 C++03 中的严格别名，但在 C++11 中却没有，因为在 C++11`const char**`中`char**`是所谓的“相似类型”。`const char*`除了通过创建 a ，将其设置为等于`*foo`，使用指向临时的指针调用`iconv`，然后将结果复制回`*foo`a 之后，您不会避免违反严格别名`const_cast`：

```
template <typename T>
size_t myconv_helper(size_t (*system_iconv)(T **), char **inbuf) {
    T *tmpbuf;
    tmpbuf = *inbuf;
    size_t result = system_iconv(&tmpbuf);
    *inbuf = const_cast<char*>(tmpbuf);
    return result;
} 
```

这对于 const-correctness 的 POV 来说是安全的，因为`iconv`所做的`inbuf`只是增加存储在其中的指针。因此，当我们第一次看到它时，我们从一个派生自非 const 指针的指针中“抛弃 const”。

我们还可以编写一个重载的`myconv`and `myconv_helper`，它在另一个方向上把`const char **inbuf`事情搞砸了，这样调用者就可以选择是传入 a`const char**`还是传入 a `char**`。可以说，它`iconv`应该首先在 C++ 中提供给调用者，但是当然接口只是从没有函数重载的 C 中复制而来。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-07-21T21:35:44.923

我参加这个聚会迟到了，但仍然是我的解决方案：

```
// This is here because some compilers (Sun CC) think that there is a
// difference if the typedefs are not in an extern "C" block.
extern "C"
{
//! SUSv3 iconv() type.
typedef size_t (& iconv_func_type_1) (iconv_t cd, char * * inbuf,
    size_t * inbytesleft, char * * outbuf, size_t * outbytesleft); 

//! GNU iconv() type.
typedef size_t (& iconv_func_type_2) (iconv_t cd, const char * * inbuf,
    size_t * inbytesleft, char * * outbuf, size_t * outbytesleft);
} // extern "C"

//...

size_t
call_iconv (iconv_func_type_1 iconv_func, char * * inbuf,
    size_t * inbytesleft, char * * outbuf, size_t * outbytesleft)
{
    return iconv_func (handle, inbuf, inbytesleft, outbuf, outbytesleft);
}

size_t
call_iconv (iconv_func_type_2 iconv_func, char * * inbuf,
    size_t * inbytesleft, char * * outbuf, size_t * outbytesleft)
{
    return iconv_func (handle, const_cast<const char * *>(inbuf),
        inbytesleft, outbuf, outbytesleft);
}

size_t
do_iconv (char * * inbuf, size_t * inbytesleft, char * * outbuf,
    size_t * outbytesleft)
{
    return call_iconv (iconv, inbuf, inbytesleft, outbuf, outbytesleft);
} 
```

# asp.net-mvc-4 - 如何使用内置的内容类型协商并获得决策权

> ID：11421440
> 
> 赞同：3
> 
> 时间：2012-07-10T20:29:08.080
> 
> 标签：asp.net-mvc-4, asp.net-web-api, content-negotiation

我想利用内置的内容协商器，并且可以决定使用什么格式化程序。我不想使用 Request.Headers.Accept 并检查它是 json 还是 xml 内容类型，因为该决定涉及很多事情。有没有办法可以在控制器级别检查或覆盖任何告诉我将使用什么格式化程序或请求内容类型是什么的类？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-10T21:06:32.300

您可以手动运行 conneg：

```
var conneg = Configuration.Services.GetContentNegotiator();
        var connegResult = conneg.Negotiate(
            typeof(YOUR_TYPE), Request, Configuration.Formatters
        ); 
```

并以您想要的任何方式使用输出：

```
//the valid media type
var mediaType = connegResult.MediaType;
//do stuff

//the relevant formatter
var formatter = connegResult.Formatter;
//do stuff 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T20:41:11.377

如果您想查看发生了什么，请安装 TraceWriter，您将看到 conneg 的作用。

TraceWriter 看起来像：

```
 public class TraceWriter : ITraceWriter {
        public bool IsEnabled(string category, TraceLevel level) {
            return true;
        }

        public void Trace(HttpRequestMessage request, string category, TraceLevel level, Action<TraceRecord> traceAction) {
            var rec = new TraceRecord(request, category, level);
            traceAction(rec);
            Log(rec);
        }

        private void Log(TraceRecord record) {
            Console.WriteLine(record.Message);
        }
    } 
```

并且是这样安装的，

```
 config.Services.Replace(typeof(ITraceWriter), new TraceWriter()); 
```

如果你想手动调用 conneg 那么你可以使用，

```
 config.Services.GetContentNegotiator().Negotiate(...) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T10:21:56.070

Tugberk 对此有一个[博客](http://www.tugberkugurlu.com/archive/running-the-content-negotiation-conneg-manually-in-asp-net-web-api)。看一看。

# javascript - 将 twitter 推文放入 javascript 变量中进行显示...？

> ID：11421443
> 
> 赞同：0
> 
> 时间：2012-07-10T20:29:26.090
> 
> 标签：javascript, jquery, twitter

这将比平时更加​​模糊，因为我正在寻找方向并且还没有任何代码可以分享。

在我的业务网页上有一个 jquery 插件欢迎消息（咆哮风格），由我在 JS 文件中键入的文本填充。我希望让我的员工更容易更改此文本，我希望我能以某种方式将我最近的推文放入一个变量中，然后我可以自动显示......这样就不需要更改代码。

我希望以某种方式获取一个字符串，例如“这是一个标题：这是消息”，并能够通过冒号作为分隔符将它们分成 2 个不同的变量。然后我可以使用它们的 var 名称显示这些变量。

这将是最终产品的示例，减去 twitter 解析：

```
jQuery(function($) {
            $("#stdWelcome").ready(function(){
                growlwelcomeid = ("gs"+$.Growl._statsCount);
                $.Growl.show(TwitterMessage, {
                  'title'  : TwitterTitle,
                  'icon'   : "star",
                  'timeout': "10000",
                  'speed': "900"
                });
              });
        }); 
```

任何帮助将不胜感激！

更新：

那么像这样的东西看起来如何：

```
var Wusername = "username"; 
var Wurl = 'http://api.twitter.com/1/statuses/user_timeline/'+Wusername+'.json?callback=?'; 

$.getJSON(Wurl, function(tweet){ 
    $Wtitle = tweet[0].text.split('|');
}); 

jQuery(function($) {
            $("#stdWelcome").ready(function(){
                growlwelcomeid = ("gs"+$.Growl._statsCount);
                $.Growl.show(Wtitle[1], {
                  'title'  : Wtitle[0],
                  'icon'   : "star",
                  'timeout': "10000",
                  'speed': "900"
                });
              });
        }); 
```

再次感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-10T20:37:31.557

如果您将标题和消息作为单独的推文，您可以执行以下操作

```
var username = "twitter username";
var url = 'http://api.twitter.com/1/statuses/user_timeline/'+username+'.json?callback=?';

$.getJSON(url, function(tweet){
    $title = tweet[0].text;
    $message = tweet[1].text;
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-10T20:36:51.533

您可以向 Twitter API 发出请求以检索给定用户的“时间线”。

> [https://api.twitter.com/1/statuses/user_timeline.json?include_entities=true&include_rts=true&screen_name=USERNAME&count=1](https://api.twitter.com/1/statuses/user_timeline.json?include_entities=true&include_rts=true&screen_name=USERNAME&count=1)

[https://dev.twitter.com/docs/api/1/get/statuses/user_timeline](https://dev.twitter.com/docs/api/1/get/statuses/user_timeline)

编辑：请参阅[@Jon Taylor 的帖子](https://stackoverflow.com/a/11421540#143327)以了解实现

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-10T20:39:24.237

这可能不是您想要的，但这是我不久前编写的一个 twitter 小部件。我已经包含了客户端可以编辑的 JS（顶部）以及他们不应该编辑的压缩“齿轮和工作部件”，以及 HTML 容器。显然，您需要添加自己的 CSS 并根据需要进行自定义。

这是一个工作示例：（[jsfiddle](http://jsfiddle.net/TXDAs/)）

```
/* Twitter initiates. Enter your username here. */
    jQuery(function($){
          $(".tweeter_widget").tweet({
            join_text: "auto",
            username: "YOUR_USERNAME",
            avatar_size: null,
            count: 1,
            auto_join_text_default: "",
            auto_join_text_ed: "",
            auto_join_text_ing: "",
            auto_join_text_reply: "",
            auto_join_text_url: "",
            loading_text: "loading tweets..."
          })
          // if tweet is over 106 characters long, set the line-height so that the text will wrap to the next line and appear centered in the tweet bar.
          .bind("loaded", function() {
        var $tweet = $(".tweet_first"); // maybe using  $(this)  is better
        var $numWords = $tweet.text().length;
        if (($numWords >= 1) && ($numWords > 106)) {
            $tweet.css({ "line-height": "24px !important" });
        }
        else {
            $tweet.css({ "line-height": "50px !important" });
        }
      });
}); 
```

压缩后的代码：

```
//twitter widget
(function(a){a.fn.tweet=function(b){function l(b){var d={};d.item=b;d.source=b.source;d.screen_name=b.from_user||b.user.screen_name;d.avatar_size=c.avatar_size;d.avatar_url=j(b.profile_image_url||b.user.profile_image_url);d.retweet=typeof b.retweeted_status!="undefined";d.tweet_time=g(b.created_at);d.join_text=c.join_text=="auto"?i(b.text):c.join_text;d.tweet_id=b.id_str;d.twitter_base="http://"+c.twitter_url+"/";d.user_url=d.twitter_base+d.screen_name;d.tweet_url=d.user_url+"/status/"+d.tweet_id;d.reply_url=d.twitter_base+"intent/tweet?in_reply_to="+d.tweet_id;d.retweet_url=d.twitter_base+"intent/retweet?tweet_id="+d.tweet_id;d.favorite_url=d.twitter_base+"intent/favorite?tweet_id="+d.tweet_id;d.retweeted_screen_name=d.retweet&&b.retweeted_status.user.screen_name;d.tweet_relative_time=h(d.tweet_time);d.tweet_raw_text=d.retweet?"RT @"+d.retweeted_screen_name+" "+b.retweeted_status.text:b.text;d.tweet_text=a([d.tweet_raw_text]).linkUrl().linkUser().linkHash()[0];d.tweet_text_fancy=a([d.tweet_text]).makeHeart().capAwesome().capEpic()[0];d.user=e('<a class="tweet_user" href="{user_url}" target="_blank">{screen_name}</a>',d);d.join=c.join_text?e(' <span class="tweet_join">{join_text}</span> ',d):" ";d.avatar=d.avatar_size?e('<a class="tweet_avatar" href="{user_url}" target="_blank"><img src="{avatar_url}" height="{avatar_size}" width="{avatar_size}" alt="{screen_name}\'s avatar" title="{screen_name}\'s avatar" border="0"/></a>',d):"";d.time=e('<span class="tweet_time"><a href="{tweet_url}" target="_blank" title="view tweet on twitter">{tweet_relative_time}</a></span>',d);d.text=e('<span class="tweet_text">{tweet_text_fancy}</span>',d);d.reply_action=e('<a class="tweet_action tweet_reply" href="{reply_url}" target="_blank">reply</a>',d);d.retweet_action=e('<a class="tweet_action tweet_retweet" href="{retweet_url}" target="_blank">retweet</a>',d);d.favorite_action=e('<a class="tweet_action tweet_favorite" href="{favorite_url}" target="_blank">favorite</a>',d);return d}function k(){var a="https:"==document.location.protocol?"https:":"http:";var b=c.fetch===null?c.count:c.fetch;if(c.list){return a+"//"+c.twitter_api_url+"/1/"+c.username[0]+"/lists/"+c.list+"/statuses.json?page="+c.page+"&per_page="+b+"&callback=?"}else if(c.favorites){return a+"//"+c.twitter_api_url+"/favorites/"+c.username[0]+".json?page="+c.page+"&count="+b+"&callback=?"}else if(c.query===null&&c.username.length==1){return a+"//"+c.twitter_api_url+"/1/statuses/user_timeline.json?screen_name="+c.username[0]+"&count="+b+(c.retweets?"&include_rts=1":"")+"&page="+c.page+"&callback=?"}else{var d=c.query||"from:"+c.username.join(" OR from:");return a+"//"+c.twitter_search_url+"/search.json?&q="+encodeURIComponent(d)+"&rpp="+b+"&page="+c.page+"&callback=?"}}function j(a){return"https:"==document.location.protocol?a.replace(/^http:/,"https:"):a}function i(a){if(a.match(/^(@([A-Za-z0-9-_]+)) .*/i)){return c.auto_join_text_reply}else if(a.match(d)){return c.auto_join_text_url}else if(a.match(/^((\w+ed)|just) .*/im)){return c.auto_join_text_ed}else if(a.match(/^(\w*ing) .*/i)){return c.auto_join_text_ing}else{return c.auto_join_text_default}}function h(a){var b=arguments.length>1?arguments[1]:new Date;var c=parseInt((b.getTime()-a)/1e3,10);var d="";if(c<60){d=c+" seconds ago"}else if(c<120){d="a minute ago"}else if(c<45*60){d=parseInt(c/60,10).toString()+" minutes ago"}else if(c<2*60*60){d="an hour ago"}else if(c<24*60*60){d=""+parseInt(c/3600,10).toString()+" hours ago"}else if(c<48*60*60){d="a day ago"}else{d=parseInt(c/86400,10).toString()+" days ago"}return" "+d}function g(a){return Date.parse(a.replace(/^([a-z]{3})( [a-z]{3} \d\d?)(.*)( \d{4})$/i,"$1,$2$4$3"))}function f(b,c){return function(){var d=[];this.each(function(){d.push(this.replace(b,c))});return a(d)}}function e(a,b){if(typeof a==="string"){var c=a;for(var d in b){var e=b[d];c=c.replace(new RegExp("{"+d+"}","g"),e===null?"":e)}return c}else return a(b)}var c=a.extend({username:null,list:null,favorites:false,query:null,avatar_size:null,count:3,fetch:null,page:1,retweets:true,intro_text:null,outro_text:null,join_text:null,auto_join_text_default:"i said,",auto_join_text_ed:"i",auto_join_text_ing:"i am",auto_join_text_reply:"i replied to",auto_join_text_url:"i was looking at",loading_text:null,refresh_interval:null,twitter_url:"twitter.com",twitter_api_url:"api.twitter.com",twitter_search_url:"search.twitter.com",template:"{avatar}{time}{join}{text}",comparator:function(a,b){return b["tweet_time"]-a["tweet_time"]},filter:function(a){return true}},b);var d=/\b((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?«»“”‘’]))/gi;a.extend({tweet:{t:e}});a.fn.extend({linkUrl:f(d,function(a){var b=/^[a-z]+:/i.test(a)?a:"http://"+a;return'<a href="'+b+'" target="_blank">'+a+"</a>"}),linkUser:f(/@(\w+)/gi,'@<a href="http://'+c.twitter_url+'/$1" target="_blank">$1</a>'),linkHash:f(/(?:^| )[\#]+([\w\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u00ff\u0600-\u06ff]+)/gi,' <a href="http://'+c.twitter_search_url+"/search?q=&tag=$1&lang=all"+(c.username&&c.username.length==1?"&from="+c.username.join("%2BOR%2B"):"")+'" target="_blank">#$1</a>'),capAwesome:f(/\b(awesome)\b/gi,'<span class="awesome">$1</span>'),capEpic:f(/\b(epic)\b/gi,'<span class="epic">$1</span>'),makeHeart:f(/(<)+[3]/gi,"<tt class='heart'>&#x2665;</tt>")});return this.each(function(b,d){var f=a('<ul class="tweet_list">').appendTo(d);var g='<p class="tweet_intro">'+c.intro_text+"</p>";var h='<p class="tweet_outro">'+c.outro_text+"</p>";var i=a('<p class="loading">'+c.loading_text+"</p>");if(c.username&&typeof c.username=="string"){c.username=[c.username]}if(c.loading_text)a(d).append(i);a(d).bind("tweet:load",function(){a.getJSON(k(),function(b){if(c.loading_text)i.remove();if(c.intro_text)f.before(g);f.empty();var j=a.map(b.results||b,l);j=a.grep(j,c.filter).sort(c.comparator).slice(0,c.count);f.append(a.map(j,function(a){return"<li>"+e(c.template,a)+"</li>"}).join("")).children("li:first").addClass("tweet_first").end().children("li:odd").addClass("tweet_even").end().children("li:even").addClass("tweet_odd");if(c.outro_text)f.after(h);a(d).trigger("loaded").trigger(j.length===0?"empty":"full");if(c.refresh_interval){window.setTimeout(function(){a(d).trigger("tweet:load")},1e3*c.refresh_interval)}})}).trigger("tweet:load")})}})(jQuery); 
```

然后是 HTML 容器：

```
<section class="footer-top">
            <div class="f-top-inner"  id="follow-me"> <a class="twit-logo" href="https://twitter.com/intent/follow?original_referer=https%3A%2F%2Ftwitter.com%2Fabout%2Fresources%2Fbuttons&screen_name=YOUR_USER_NAME&source=followbutton&variant=2.0" title="Follow Us" target="_blank" onClick="_gaq.push(['_trackEvent', 'Social', 'Social_Click', 'Twitter']);"></a> 
                <!--tweet position-->
                <div class="tweeter_widget" id="tweetDiv"></div>
            </div>
        </section> 
```

# c - C语言：Newb将代码从javascript翻译成C，代码包括malloc、strncpy、指针

> ID：11421444
> 
> 赞同：0
> 
> 时间：2012-07-10T20:29:26.590
> 
> 标签：c, string, pointers, malloc, strncpy

我正在转换（从 javascript）一个程序，该程序将采用可变长度的字符串（但始终低于 100 个字符）并返回单个变量中字符串中包含的数据。这是我的代码的第一部分，显然，我是 C 和一般编程的新手。此代码用于代码的第一部分，但学习如何正确编码这将使我知道如何编码其余部分。

我需要：

*   要存储为“stringID”的前 4 位数字
*   要存储为“myindicator”的第 5 个数字
*   第 6 到 (indicator + 6) 个数字被存储为 'var1'

示例输入：

'12345678901234567890123'

示例输出：

*   字符串 ID = 1234
*   我的指标 = 5
*   var1 = 67890123456

当我运行程序时，它返回“字符串 ID：H>a”，然后程序崩溃。任何帮助，将不胜感激。不，这不是家庭作业。

```
int main()

{
char mystring[100];
char *stringID;
int nep;
int *myindicator;
char *var1;

nep = 0;
printf("Please enter your CODE\n");
scanf("%s", &mystring);

stringID = (char *)malloc(4 * sizeof(char));

if(NULL != stringID)
{

    strncpy(stringID, mystring, 4);
    stringID[4] = '\0';
    free(stringID);
    nep = nep +4;
    printf("stringID: %s\n",myindicator);
}

if(NULL != myindicator)
{
    strncpy(myindicator, (mystring+nep, 1);
    nep++; 
    myindicator = *myindicator - '0';
    printf("Indicator : %d\n",myindicator);
}

var1 = (char *)malloc((nep + 6) * sizeof(char));
if(NULL != var1)
{
    strncpy(var1, mystring+nep, (myindicator+nep+6));
    var1[myindicator+nep+6] = '\0';
    free(var1);

    printf("Var 1: %s", var1);

    nep = nep +myindicator+6;
}

getchar();
return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T20:41:25.720

我修复了一些东西，在评论中找到它。但是您需要查看 C 语言手册...！

```
int main()
{
   char mystring[100];
   char *stringID;
   int nep;
   // Changed to integer, not pointer to int.
   int myindicator;
   char *var1;

   nep = 0;
   printf("Please enter your CODE\n");

   /*
       This scanf is a bad idea for the same reason for which, below, we take
       care to allocate memory enough for whatever we have to do.
       Should someone input 250 characters in a buffer of size 100, those 150
       extra characters would wreak havoc and possibly endanger the system.
   */
   // scanf("%s", &mystring);
   fgets(mystring, sizeof(mystring)-1, stdin);
   // fgets will read at most "sizeof(mystring)-1", that is, 99 bytes,
   // from "stdin" (STanDard INput), the same as scanf. But it will halt
   // when reaching the limit given. It's up to us to give a "real" limit
   // (nothing stops you from saying 15000 -- even if the true value is 100).

   // C strings are made of characters, terminated by a zero byte.
   // So you need 5 here, to store 4 characters
   stringID = (char *)malloc(5 * sizeof(char));

   if (NULL == stringID)
   {
       // Serious out of memory error: no sense going on.
       // fprintf(stderr, "Out of memory\n");
       abort();
   }

   strncpy(stringID, mystring, 4);
   stringID[4] = '\0';

   printf("ID: %s\n", stringID);

   free(stringID);

   nep = nep + 4;
   printf("NEP: %d\n", nep);

   // Now we want to decode the fifth digit.

   // I use '0' as character. So if the fifth digit is '0', '0'-'0' will give 0
   // and if it is '9', '9'-'0' will give 9 (the number).
   // The trick does not work with more than one digit, of course.
   myindicator = mystring[nep] - '0';

   // Had I wanted to read 3 digits, I would have had to copy them into a 
   // temporary buffer, add a zero in the fourth position, then run atol()
   // on the resulting buffer: atol("12345\0" /* A STRING */) = 12345 /* A NUMBER */;

   printf("VLI : %d\n", myindicator);

   // Copy "myindicator" bytes, so alloc myindicator+1 chars
   var1 = (char *)malloc((myindicator + 1) * sizeof(char));

   // Check that var1 is not null and abort if it is
   if (NULL == var1)
        abort();

   strncpy(var1, mystring + 6, myindicator);
   var1[myindicator+1] = '\0';

   // Moved this printf before the free. See why below.
   printf("Prefix : %s\n", var1);

   // NEVER use a variable after you freed it!!!
   // it might APPEAR to work, but will stab you in the back the first chance it gets.
   // Good if paranoid habit: null a var as soon as you've freed it.
   free(var1); var1 = NULL;

   getchar(); 
   return 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T20:41:30.533

你为什么要释放你的阵列？从堆中释放它们后，您正在引用它们。

您的代码将在这些地方出现段错误：

1.  你在哪里分配的`myindicator`？

    strncpy(myindicator, (mystring+nep, 1); // 这里会出现段错误。

2.  免费（var1）；

    printf("前缀：%s", var1); // 再次出现段错误

3.  又来了

    strncpy(var1, mystring+nep, (myindicator+nep+6)) //你的mystring在哪里？

4.  接受字符串输入`scanf()`是可怕的可怕想法。使用缓冲 IO，如`fgets()`.

5.  您正在使您`mystring`的缓冲区溢出。谁在阻止用户输入 120 字节的字符串？我可以通过仔细跳转指令将您的堆栈写入我的恶意代码。

# javascript - 如何在鼠标悬停时停止幻灯片放映？

> ID：11421446
> 
> 赞同：0
> 
> 时间：2012-07-10T20:29:49.340
> 
> 标签：javascript, jquery, slideshow

我很抱歉发布之前已经在这里问过几次的东西，但我无法在这些帖子中找到我的答案，非常感谢你的帮助！

在我们的页面上，我们有以下部分，其中在 LHS 上看到的选项/选项卡会自动旋转，在 RHS 上显示其内容（例如，在下图中，Direct TV 选项卡正在 RHS 上显示视频）

![我在我的页面上的截图](../Images/b8fef5ed96c0f107b1437d44c29d3f80.png)

现在，当用户将鼠标悬停在面板的 RHS 上或在本例中，在视频顶部时，我需要停止/暂停幻灯片放映。现在，即使视频正在播放，标签（在 LHS 上）也会不断变化……这真的很烦人。这是我收到的关于幻灯片的脚本：http: [//jsfiddle.net/walahh/6RbYt/](http://jsfiddle.net/walahh/6RbYt/)

目前我正在为其他一些事情苦苦挣扎，如果有人可以帮助我解决这个问题，我将不胜感激**。**感谢您的时间和帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T20:36:16.830

“鼠标”一词在您的 JS Fiddle 代码中没有出现。如果您希望“鼠标悬停”发生某些事情，那么您需要将事件处理程序挂钩到该事件。

在本质上：

```
$('#RHS').mouseEnter(pauseSlideshow())
         .mouseLeave(unpauseSlideshow()); 
```

除了您必须将“#RHS”、“pauseSlideshow”和“unpauseSlideshow”替换为您的实际 ID/方法。

# python - PyInstaller - ImportError：没有名为 win32api 的模块

> ID：11421448
> 
> 赞同：0
> 
> 时间：2012-07-10T20:30:00.473
> 
> 标签：python, pyinstaller

我正在尝试使用带有默认选项的 PyInstaller 将 Python 项目（在 Windows XP 上使用 Python 2.7）编译为 EXE。当我尝试运行 EXE 时，我收到以下消息：

PyInstaller - ImportError：没有名为 win32api 的模块

我将 win32api 路径添加到 Windows PATH 环境变量（我确实安装了 Python Win32 扩展），但它不起作用。我对此很陌生，对所有选项等有点不知所措，我真的不知道从哪里开始（或者什么信息对解决这个问题有用。）我认为这是我的一些小事失踪，但我还没有找到任何人在网上遇到这个问题，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T17:31:27.393

好的，看起来我的一个模块中的“import os”导致了这个问题。我没有运气让它成功使用 win32api 模块，但由于这仅用于设置程序名称，我只是将其注释掉并且这个特定问题得到了解决。感谢卢克的帮助！

# c# - 创建数据并将数据绑定到下拉列表的更有效方法是什么？

> ID：11421450
> 
> 赞同：0
> 
> 时间：2012-07-10T20:30:02.010
> 
> 标签：c#, asp.net

我想加快我一直在从事的 asp.net 项目的加载时间。其中之一`dropdownlists`是通过将 sql 表中的员工列表与 Active Directory 成员资格进行比较而获得的经理列表。

这被称为`Page_Load`

```
 SqlDataSource empDB = (SqlDataSource)Page.Master.FindControl("EmployeeData");
        DataView dv = (DataView)empDB.Select(DataSourceSelectArguments.Empty);

        foreach (DataRowView drv in dv)
        {
            employeeList.Add(new Employee(int.Parse(drv["EMP_ID"].ToString()), drv     ["FULL_NAME"].ToString()));
        }

        managerTest();

        managerDropDownList.DataSource = managerList;
        managerDropDownList.DataTextField = "fullName";
        managerDropDownList.DataValueField = "emp_Id";
        managerDropDownList.DataBind(); 
```

经理测试方法：

```
 private void managerTest()
    {

        PrincipalContext domainContext = new PrincipalContext(ContextType.Domain, "the_domain");
        GroupPrincipal managersGroup = GroupPrincipal.FindByIdentity(domainContext, "Managers and Supervisors");
        GroupPrincipal offManagersGroup = GroupPrincipal.FindByIdentity(domainContext, "Office Managers");
        GroupPrincipal executivesGroup = GroupPrincipal.FindByIdentity(domainContext, "Executives");
        GroupPrincipal managers2Group = GroupPrincipal.FindByIdentity(domainContext, "Managers");

        foreach (Employee emp in employeeList)
        {
            UserPrincipal user = UserPrincipal.FindByIdentity(domainContext, emp.fullName);

            if (user != null)
            {
                if (user.IsMemberOf(managersGroup) || user.IsMemberOf(offManagersGroup) || user.IsMemberOf(executivesGroup) || user.IsMemberOf(managers2Group))
                {
                    managerList.Add(emp);
                }
            }
        }

    } 
```

Employee 只是一个简单的类，用于分隔名字、姓氏和全名的值。

问题是页面加载速度非常慢，并且页面上有几个控件可以回发并导致回发需要很长时间。我能做些什么来提高这项工作的效率吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-10T20:43:09.880

几件事。第一的。您应该将您在 page_load 中发布的所有代码包装在`if (!IsPostBack)`. 您只需要绑定一次，而不是每次加载页面。除非您当然关闭了视图状态。

第二。经理多久更换一次？可能不会那么频繁。我建议将其存储在 asp.net 中`Cache`。哎呀，您可能想在`Global.asax`Application_Start 中缓存它。否则，第一个访问该页面的人将受到性能影响。但这肯定比每次有人访问该页面时都加载它要好得多。然后，您可以根据需要关闭页面上的视图状态。

下一个。我认为您使用 AD 的方式非常低效。您正在循环中为每个员工调用它。你这样做的唯一原因是要查明他们是否是经理。与其那样做，不如先找出所有经理是谁。换句话说：调用 AD 以获取您关心的组的成员。请参阅此问题：[get all users from a group in Active Directory](https://stackoverflow.com/questions/7915145/get-all-users-from-a-group-in-active-directory)，了解如何找到 AD 组的所有成员。我怀疑这真的有助于提高性能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-10T20:37:03.177

一个简单的改进是只加载`DropDownList`一次，然后依靠页面的视图状态来维护其状态，只需将以下检查添加到您的页面：`if (!this.IsPostBack)`

```
if (!this.IsPostBack)
{
       SqlDataSource empDB = (SqlDataSource)Page.Master.FindControl("EmployeeData");
        DataView dv = (DataView)empDB.Select(DataSourceSelectArguments.Empty);

        foreach (DataRowView drv in dv)
        {
            employeeList.Add(new Employee(int.Parse(drv["EMP_ID"].ToString()), drv     ["FULL_NAME"].ToString()));
        }

        managerTest();

        managerDropDownList.DataSource = managerList;
        managerDropDownList.DataTextField = "fullName";
        managerDropDownList.DataValueField = "emp_Id";
        managerDropDownList.DataBind();
} 
```

> 问题是页面加载速度非常慢，并且页面上有几个控件回发并导致回发需要很长时间

我认为在这种情况下，如果您使用 AJAX，您的页面响应能力将会得到改善。

在没有控件的情况下实现 AJAX`UpdatePanel`将为您提供最佳的 UI 性能，但是您需要更改一些内容才能使其正常工作

您可以使用`UpdatePanel`控件执行*部分更新*，*感知性能*会提高，因为您不会做完整的帖子，并且与实现纯 AJAX 调用相比，学习曲线非常小。

*进行部分页面回发*的基本步骤是：

*   `ScriptManager`向 ASPX 页面添加控件（每个使用`UpdatePanel`必须有`ScriptManager`控件的页面）

*   `UpdatePanel`在您的 ASPX 页面中创建一个，并将`ContentTemplate`您希望**作为部分回发响应的一部分呈现的所有控件放入其中**

*   像在正常的完整回发中一样创建服务器事件

您可以检查以下问题以获得更详细的`UpdatePanel`控件使用

[如何在同一个 .aspx 页面上使用两个更新面板](https://stackoverflow.com/q/11358141/1268570)

作为参考，请查看以下文章：

*   [http://msdn.microsoft.com/en-us/library/bb399001.aspx](http://msdn.microsoft.com/en-us/library/bb399001.aspx)

*   [http://www.asp.net/ajax/documentation/live/overview/UpdatePanelOverview.aspx](http://www.asp.net/ajax/documentation/live/overview/UpdatePanelOverview.aspx)

# objective-c - XCode 自定义活动指示器 - UIWebView 加载后隐藏 (webViewDidFinishLoad)

> ID：11421453
> 
> 赞同：0
> 
> 时间：2012-07-10T20:30:17.423
> 
> 标签：objective-c, ios, xcode, uiimageview, activity-indicator

我正在使用此处找到的代码[http://blog.blackwhale.at/?p=336](http://blog.blackwhale.at/?p=336)`activityIndicator`在当前版本的 xCode 中创建自定义。此代码使用`.png`数组中的一系列图像，然后以设置的间隔显示它们以创建动画加载图像，然后您可以随时将其放置在屏幕上（并假设您可以以某种方式将其删除）。

在我的主 ViewController.m 文件中，我的`viewDidLoad`部分中有以下代码：

```
/* --- START CUSTOM ACTIVITY INDICATOR */
    //Create the first status image and the indicator view
    UIImage *statusImage = [UIImage imageNamed:@"activity1.png"];
    UIImageView *activityImageView = [[UIImageView alloc] 
                                      initWithImage:statusImage];

    //Add more images which will be used for the animation
    activityImageView.animationImages = [NSArray arrayWithObjects:
                                         [UIImage imageNamed:@"activity1.png"],
                                         [UIImage imageNamed:@"activity2.png"],
                                         [UIImage imageNamed:@"activity3.png"],
                                         [UIImage imageNamed:@"activity4.png"],
                                         [UIImage imageNamed:@"activity5.png"],
                                         [UIImage imageNamed:@"activity6.png"],
                                         [UIImage imageNamed:@"activity7.png"],
                                         [UIImage imageNamed:@"activity8.png"],
                                         [UIImage imageNamed:@"activity9.png"],
                                         [UIImage imageNamed:@"activity10.png"],
                                         [UIImage imageNamed:@"activity11.png"],
                                         [UIImage imageNamed:@"activity12.png"],
                                         nil];

    //Set the duration of the animation (play with it
    //until it looks nice for you)
    activityImageView.animationDuration = 0.6;

    //Position the activity image view somewhere in 
    //the middle of your current view
    activityImageView.frame = CGRectMake(
                                         self.view.frame.size.width/2
                                         -statusImage.size.width/2, 
                                         self.view.frame.size.height/1.2
                                         -statusImage.size.height/1.2, 
                                         statusImage.size.width, 
                                         statusImage.size.height);

    //Start the animation
    [activityImageView startAnimating];

    //Add your custom activity indicator to your current view
    [self.view addSubview:activityImageView];

   /*  --- END CUSTOM ACTIVITY INDICATOR */ 
```

我想清除/删除/隐藏`activityImageView`元素，因为我只希望它在应用程序首次启动时显示，直到`UIWebView`完成加载。

我想调用它并让 gif 出现 while`webViewDidStartLoad`然后清除 when `webViewDidFinishLoad`。有人帮忙？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-30T02:58:26.337

你应该这样：

```
- (void)viewDidLoad {
    [super viewDidLoad];

    //Create the first status image and the indicator view
    UIImage *statusImage = [UIImage imageNamed:@"activity1.png"];
    UIImageView *activityImageView = [[UIImageView alloc] 
                                  initWithImage:statusImage];

    //Add more images which will be used for the animation
    activityImageView.animationImages = [NSArray arrayWithObjects:
                                     [UIImage imageNamed:@"activity1.png"],
                                     [UIImage imageNamed:@"activity2.png"],
                                     [UIImage imageNamed:@"activity3.png"],
                                     [UIImage imageNamed:@"activity4.png"],
                                     [UIImage imageNamed:@"activity5.png"],
                                     [UIImage imageNamed:@"activity6.png"],
                                     [UIImage imageNamed:@"activity7.png"],
                                     [UIImage imageNamed:@"activity8.png"],
                                     [UIImage imageNamed:@"activity9.png"],
                                     [UIImage imageNamed:@"activity10.png"],
                                     [UIImage imageNamed:@"activity11.png"],
                                     [UIImage imageNamed:@"activity12.png"],
                                     nil];

    //Set the duration of the animation (play with it
    //until it looks nice for you)
    activityImageView.animationDuration = 0.6;

    //Position the activity image view somewhere in 
    //the middle of your current view
    activityImageView.frame = CGRectMake(
                                     self.view.frame.size.width/2
                                     -statusImage.size.width/2, 
                                     self.view.frame.size.height/1.2
                                     -statusImage.size.height/1.2, 
                                     statusImage.size.width, 
                                     statusImage.size.height);

    //Start the animation
    [activityImageView startAnimating];

    //Add your custom activity indicator to your current view
    [self.view addSubview:activityImageView];

    self.timer = [NSTimer scheduledTimerWithTimeInterval:(1.0/2.0)
                                                  target:self
                                                selector:@selector(loading)
                                                userInfo:nil
                                                 repeats:YES];

}

- (void)loading {

    if (!self.webView.loading) {
        [activityImageView stopAnimating];
        activityImageView.hidden = 1;
    } else {
        [activityImageView startAnimating];
    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-10T20:44:02.193

好的，所以您无法访问 activityImageView 的原因是它在您的 viewDidLoad 函数中声明。将其作为属性添加到您的 ViewController 类中，您应该能够做您想做的事。确保从 viewDidLoad 中删除了 activityImageView 的声明，并在那里对其进行初始化。

此外，您要在哪里显示活动指示器的 web 视图？它有单独的视图控制器还是包含在您的主视图控制器中？听起来您的 activityImageView 范围不正确，尽管不知道您是如何设置所有内容的，但我很难告诉您将其放在哪里。

在这两个地方使用您的活动指示器后，您打算在应用程序运行期间再次使用它，还是仅在重新加载应用程序时才可见？根据对此的答案，您可能只想隐藏它，或者将其从主视图中删除。

UIImageView.hidden 控制可见性。

编辑，要求的代码：

```
ViewController.h

@interface ViewController : UIViewController
{
    UIWebView *_webView;
}

@property(nonatomic, strong) UIWebView *webView;
@property(nonatomic, strong) UIImageView *activityImageView;

ViewController.m

@implementation ViewController
@synthesize activityImageView;
@synthesize webView = _webView;

-(void)viewDidLoad {

    //all your previous stuff with the change that you just alloc activityImageView instead of declare it
    activityImageView = [[UIImageView alloc] initWithImage:statusImage];
    //The above is the initialization, below is where your old code should go
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-10T20:43:03.133

将您的 activityImageView 声明为头文件中的属性并在您的`viewDidLoad:`方法中进行配置

您应该在 UIWebViewDelegate 方法中添加您的 activityImageView

```
- (void)webViewDidStartLoad:(UIWebView *)webView 
```

然后在 UIWebViewDelegate 方法`stopAnimating`中`removeFromSuperview`

```
- (void)webViewDidFinishLoad:(UIWebView *)webView
- (void)webView:(UIWebView *)webView didFailLoadWithError:(NSError *)error 
```

您应该阅读[UIImageView 文档](https://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIImageView_Class/Reference/Reference.html)和[UIWebViewDelegate 协议参考](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIWebViewDelegate_Protocol/Reference/Reference.html)

更新

在您的标题中：

```
@property(nonatomic, retain) UIImageView *activityImageView; 
```

在您的实施中

```
@synthesize activityImageView;

-(void)viewDidLoad{
  activityImageView = [[UIImageView alloc] 
                                      initWithImage:statusImage];

    //Add more images which will be used for the animation
    activityImageView.animationImages = [NSArray arrayWithObjects:
                                         [UIImage imageNamed:@"activity1.png"],
                                         [UIImage imageNamed:@"activity2.png"],
                                         [UIImage imageNamed:@"activity3.png"],
                                         [UIImage imageNamed:@"activity4.png"],
                                         [UIImage imageNamed:@"activity5.png"],
                                         [UIImage imageNamed:@"activity6.png"],
                                         [UIImage imageNamed:@"activity7.png"],
                                         [UIImage imageNamed:@"activity8.png"],
                                         [UIImage imageNamed:@"activity9.png"],
                                         [UIImage imageNamed:@"activity10.png"],
                                         [UIImage imageNamed:@"activity11.png"],
                                         [UIImage imageNamed:@"activity12.png"],
                                         nil];

    //Set the duration of the animation (play with it
    //until it looks nice for you)
    activityImageView.animationDuration = 0.6;

    //Position the activity image view somewhere in 
    //the middle of your current view
    activityImageView.frame = CGRectMake(
                                         self.view.frame.size.width/2
                                         -statusImage.size.width/2, 
                                         self.view.frame.size.height/1.2
                                         -statusImage.size.height/1.2, 
                                         statusImage.size.width, 
                                         statusImage.size.height);
}

- (void)webViewDidStartLoad:(UIWebView *)webView{
[self.activityImageView startAnimating];
[self.view addSubview:activityImageView];
}

- (void)webViewDidFinishLoad:(UIWebView *)webView{
[activityImageView stopAnimating];
[activityImageView removeFromSuperview];
}
- (void)webView:(UIWebView *)webView didFailLoadWithError:(NSError *)error{
[activityImageView stopAnimating];
[activityImageView removeFromSuperview];
} 
```

# objective-c - 在 mergeChangesFromContextDidSaveNotification 上调试 EXC_BAD_ACCESS

> ID：11421454
> 
> 赞同：0
> 
> 时间：2012-07-10T20:30:24.280
> 
> 标签：objective-c, ios, exc-bad-access, nsmanagedobjectcontext

在以下代码行中，我的 iPad 应用程序每运行 5 次就会得到一个 EXC_BAD_ACCESS。我运行了 Zombies，但应用程序崩溃了，而且 Instruments 没有显示任何僵尸，它只是停止录制。

```
[self.managedObjectContext mergeChangesFromContextDidSaveNotification:notification]; 
```

下面是我在 AppDelegate.m 中使用的代码

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{

  [[NSNotificationCenter defaultCenter] addObserver:self 
                                         selector:@selector(contextChanged:) 
                                             name:NSManagedObjectContextDidSaveNotification 
                                           object:nil];

  .....blah blah balh........

  return YES;
}

- (void) contextChanged:(NSNotification *)notification 
{
    if(self.managedObjectContext)
    {
      if ([notification object] == [self managedObjectContext] ) return;

      if(![NSThread isMainThread])
      {
          [self performSelectorOnMainThread:@selector(contextChanged:) withObject:notification waitUntilDone:YES];
      }

      [self.managedObjectContext setMergePolicy:NSMergeByPropertyStoreTrumpMergePolicy];
      [self.managedObjectContext mergeChangesFromContextDidSaveNotification:notification];
    }
} 
```

我不确定如何调试这个？奇怪的是，它只会在我运行应用程序的第 5 次到第 7 次时崩溃（每次运行测试时我总是在模拟器上重置内容）。

# file - PowerShell：复制文件然后压缩

> ID：11421455
> 
> 赞同：1
> 
> 时间：2012-07-10T20:30:31.800
> 
> 标签：file, powershell, zip, copy-paste

我把这个拼凑在一起，但有点卡住了。代码将项目放置在根目录而不是它来自的文件夹中，即如果它位于测试文件夹中，则将其直接放置在用户文件夹中，我希望它创建一个测试文件夹并将项目放在那里。在它复制了项目后，我希望它压缩该位置。有一次我在想我可以创建一个 txt 文件，然后用它来复制项目，但后来我迷路了。

```
$PCName = Read-Host "Enter Machine Name"
$User = Read-Host "Enter User Name"
$NAS = "\\<nas>\users\$user"
$Dir = get-childitem \\$PCName\C$\users\$User -force -recurse | where {
$_.extension -match "doc|xls|docx|xlsx|pdf|pst|txt|jpg|tif"} | ForEach {
Copy-Item $_.FullName -Destination $NAS -force -ErrorAction:SilentlyContinue
}

#$Dir | ft fullname | out-file C:\Scripts\logs\FileList\$User.txt
$Dir | format-table name# PowerShell script to list the DLL files under the system32 folder 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T23:30:18.317

您需要将源目录的根目录替换为目标路径中目标目录的根目录：

```
$PCName = Read-Host "Enter Machine Name"
$User = Read-Host "Enter User Name"
$NAS = "\\<nas>\users\$user"
$sourceRoot = "\\$PCName\C$\users\$User"
$Dir = get-childitem $sourceRoot -force -recurse | 
    where { $_.extension -match "doc|xls|docx|xlsx|pdf|pst|txt|jpg|tif"} | 
    ForEach {  
        $destFile = $_.FullName.Replace($sourceRoot, $NAS)
        New-Item -ItemType File -Path $destFile -Force
        Copy-Item $_.FullName -Destination $destFile -force -ErrorAction:SilentlyContinue } 
```

# sql-server-2008 - 将标量引用传递给另一个标量

> ID：11421458
> 
> 赞同：0
> 
> 时间：2012-07-10T20:30:46.560
> 
> 标签：sql-server-2008, scalar

在 SQL Server 中，我有一个接受日期参数的存储过程。然后将该日期参数传递给另一个存储过程。但是，第二个存储过程参数被命名为第一个参数。然后我需要有 2 个不同的标量变量：

```
DECLARE @date date, @sql varchar(100);

SET @date = '2012-07-01';
SELECT @sql = ('EXEC pStoredprocedure @date = '''+@date+'''') 
```

我需要`@sql`标量来包含此文本，以便存储过程可以调用其他存储过程：

`EXEC pStoredprocedure @date = '2012-07-01'`

但是，当我在上面运行我的代码时，我得到了这个错误：

`Msg 402, Level 16, State 1, Line 4 The data types varchar and date are incompatible in the add operator.`

这几乎就像我需要逃避`@date`运营商一样。这可以做到吗？

旁注：是的，我正在尝试动态传递一些变量。我理解这样做的危险，但这样做要简单得多......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-10T21:02:36.757

date 变量用于字符串连接，因此应将其视为字符串，无论是通过其声明、转换函数还是强制转换。我试过这个：

```
 DECLARE @date varchar(20), @sql varchar(100);
SET @date = '2012-07-01';
SELECT @sql = ('EXEC pStoredprocedure @date = ''' + @date + '''')

 PRINT @sql 
```

得到了这个：

```
 EXEC pStoredprocedure @date = '2012-07-01' 
```

我被困在 2005 年，所以我没有 date 数据类型，但是当我尝试使用 datetime 时，我收到了这个错误：

> 消息 241，级别 16，状态 1，第 4 行从字符串转换日期时间时转换失败。

你也可以试试

```
 DECLARE @date datetime, @sql varchar(100);
SET @date = '2012-07-01';
SELECT @sql = ('EXEC pStoredprocedure @date = ''' + CONVERT(varchar(20), @date, 102) + '''')
 PRINT @SQL; 
```

并得到

```
 EXEC pStoredprocedure @date = '2012.07.01' 
```

# objective-c - CGImageCreate 对图像底部产生噪音 Objective C

> ID：11421464
> 
> 赞同：0
> 
> 时间：2012-07-10T20:31:20.223
> 
> 标签：objective-c, cgimage, cgimageref

我正在使用`CGImageCreate`从字节缓冲区（的）创建图像`uint8_t`。图像似乎在底部出现噪点。有没有其他方法可以做到这一点，或者我做错了什么`CGImageCreate`？

# apache - virtualhost多个站点，apache linux服务器

> ID：11421468
> 
> 赞同：0
> 
> 时间：2012-07-10T20:32:03.837
> 
> 标签：apache, virtualhost

抱歉，如果这听起来很愚蠢，这是我的感受，因为我过去做过这件事，但不知道出了什么问题。

无论如何，我在我的 fedora linux 机器上设置了两个站点，现在我正在尝试添加第三个站点。但是，当我访问 www.site3.com 时，它会被重定向到第一个站点。

我的 VirtualHost 代码非常基本，请让我知道我还应该添加什么以及任何问题，您可以看到我提到的问题的结果。

httpd.conf：

```
<VirtualHost *:80>
   DocumentRoot /var/www/html/web/site1/
   ServerName site.com
</VirtualHost>
<VirtualHost *:80>
   DocumentRoot /var/www/html/web/site2/
   ServerName site2.com
</VirtualHost>
<VirtualHost *:80>
   DocumentRoot /var/www/html/web/site3/
   ServerName site3.com
</VirtualHost> 
```

除了这个，我还有什么需要改变的吗？其他前两个站点仍然可以正常工作，我已经重新启动了 httpd 服务，但无济于事

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-10T20:34:24.403

`www.site3.com`并且`site3.com`不是相同的主机名。请参阅[ServerAlias 指令](http://httpd.apache.org/docs/2.0/mod/core.html#serveralias)。

```
<VirtualHost *:80>
   DocumentRoot /var/www/html/web/site3/
   ServerName site3.com
   ServerAlias www.site3.com
</VirtualHost> 
```

# android - 自定义适配器不起作用

> ID：11421474
> 
> 赞同：2
> 
> 时间：2012-07-10T20:32:35.893
> 
> 标签：android

我有一个自定义适配器用于我的`ListView`. 它给了我`NullPointerException`在`setAdapter`. 我已经多次检查了我的代码，但无法弄清楚导致 NPE 的原因。以下是相关的代码片段：

活动：

```
ListView mListView;
Vector<DashboardBean> dashboardBean= new Vector<DashboardBean>();
MyCustomAdapter adapter;

adapter = new MyCustomAdapter(MyDashboardActivity.this, 
              R.layout.testdashboard_row, dashboardBean);

        adapter.clear();

dashboardBean.add(new DashboardBean(projects, workRequests, status)); 
        mListView.setAdapter(adapter); 
```

仪表板豆：

```
public class DashboardBean {

    public String project;
    public String workRequest;
    public String startDate;
    public String status;   
    public String actualHours;
    public String actualMins;

    public DashboardBean(String project, String workRequest,String status)
    {
        this.project = project;
        this.workRequest = workRequest;
        this.status = status;
    }

} 
```

自定义适配器：

```
public class MyCustomAdapter extends ArrayAdapter<DashboardBean> {

Context context;
int layoutResourceId;
DashboardBean currentMRB;
Vector<DashboardBean> data;

public MyCustomAdapter(Context context, int layoutResourceId, Vector<DashboardBean> data) 
{
    super(context,layoutResourceId,data);
    this.layoutResourceId = layoutResourceId;
    this.context=context;
    this.data = data;
}

@Override
public View getView(int position, View convertView, ViewGroup parent) {

    View row = convertView;
    MyStringReaderHolder holder;

    if(row==null)
    {
        LayoutInflater inflater = ((Activity)context).getLayoutInflater();
        row = inflater.inflate(layoutResourceId, parent,false);

        holder= new MyStringReaderHolder();

        holder.project = (TextView)row.findViewById(R.id.project);
        holder.workRequest = (TextView)row.findViewById(R.id.work_request);
        holder.status = (TextView) row.findViewById(R.id.status);

        row.setTag(holder);
    }
    else
    {
        holder=(MyStringReaderHolder) row.getTag();
    }

    DashboardBean mrb = data.elementAt(position);

    holder.project.setText(mrb.project);
    holder.workRequest.setText(mrb.workRequest);
    holder.status.setText(mrb.status);

    return row;
}

static class MyStringReaderHolder
{
TextView project, workRequest, startDate, status, actualHours;

 }
 } 
```

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-10T20:34:14.700

在您的“活动”片段中，您永远不会将值分配给`mListView`：

```
ListView mListView; //initialize me please :) 
```

因此，它为 null，并且总是会抛出一个`NullPointerException`. 也许你在 xml 中定义了一些东西，并且你想调用`findViewById(int)`.

```
mListView = (ListView) findViewById(R.id.theListViewId); 
```

# python - 在windows上的eclipse中集成networkx

> ID：11421476
> 
> 赞同：3
> 
> 时间：2012-07-10T20:32:43.337
> 
> 标签：python, eclipse, networkx

我在 Eclipse 中使用 PyDev 和 Windows 7 上的 Python 2.7。我安装了 networkx 并且它在 Python shell 中正常运行，但是在 Eclipse 中它显示错误，因为它无法找到 networkx 谁能告诉我如何删除这个错误？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-10T20:37:55.557

你需要重建你的解释器

转到项目 > 属性 > pyDev-Interpreter/Grammar

点击“点击此处进行配置”

删除现有的解释器

点击“自动配置”按钮并按照提示操作

有点痛苦，但我发现自动发现新安装的软件包的唯一方法

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T20:39:20.070

我认为有两种选择：

1.  重建你的解释器
2.  通过将networkx的位置附加到python中，将其添加到您的python路径`sys.path`中

# visual-studio-2008 - TextBlock 在 Windows Phone 模拟器中消失

> ID：11421492
> 
> 赞同：2
> 
> 时间：2012-07-10T20:33:55.840
> 
> 标签：visual-studio-2008, windows-phone-7, expression-blend-4

我的应用程序中有文本块，一切看起来都很好，它在表达式混合和视觉工作室中完全可见（所有文本块）。问题是当我启动模拟器时。文本块在某一时刻消失，正好在“目标：下背部、腹直肌和腹横肌、斜肌和臀部”之后。是模拟器的错误，还是错误的？我删除了部分文字。

```
<!--LayoutRoot is the root grid where all page content is placed-->
<Grid x:Name="LayoutRoot">
    <Grid.Background>
        <ImageBrush ImageSource="/Excercises;component/Images/tlo.png" />
    </Grid.Background>
    <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="*"/>
    </Grid.RowDefinitions>

    <!--ContentPanel - place additional content here-->
    <ScrollViewer x:Name="ScrollViewer1" Grid.Row="1" VerticalScrollBarVisibility="Auto">
    <Grid x:Name="ContentPanel" Grid.Row="1" Margin="12,0,12,0" Height="4610">
    <TextBlock HorizontalAlignment="Left" Margin="8,0,0,214" Width="472" Name="TextBlock1" TextWrapping="Wrap" > 
            <LineBreak />
        <Run FontFamily="Segoe WP" FontSize="27" FontWeight="ExtraBlack" TextDecorations="Underline">
           7 Waist-Slimming Ab Exercises
            </Run>
            <LineBreak />
            <LineBreak />            
        <Run Text="Fly up"/>
        <LineBreak/>
        <Run Text="Target: Rectus abdominis"/>
        <LineBreak/>
        <LineBreak/>
        <Run Text="1.Sit on a folded towel on floor, lean back to rest on elbows and place feet together on a wall in front of you so that knees are bent about 90 degrees."/>
        <LineBreak/>
        <LineBreak/>
        <Run Text="2.Extend legs up, keeping feet against wall, then press rounded lower back into floor and squeeze abs as you lift arms to reach toward feet, elbows soft. Make it harder: Press feet into wall as you reach."/>
        <LineBreak/>
        <LineBreak/>
        <Run Text="3\. Do 20 pulses: Curl torso up 1 inch, then lower 1 inch."/>
        <LineBreak/>
        <LineBreak/>
        <Run Text="4.Do 3 sets, hugging knees to chest to rest between sets."/>
        <LineBreak/>
        <LineBreak/>
        <LineBreak/>
        <LineBreak/>
        <LineBreak/>
        <LineBreak/>
        <LineBreak/>
        <LineBreak/>
        <LineBreak/>
        <Run Text="Pelvic Scoop"/>
        <LineBreak/>
        <Run Text="Targets: Lower back, rectus and transversus abdominis, obliques, and butt"/>
        <LineBreak/>
        <LineBreak/>
        <Run Text=" 1.Lie faceup on floor with back resting on folded towel, knees bent and feet flat on floor, arms by sides."/>
        <LineBreak/>
        <LineBreak/>
        <Run Text="2.Cross right ankle onto left thigh just above knee so bent right knee points out to side; flex left foot so only heel rests on floor."/>
        <LineBreak/>
        <LineBreak/>
        <Run Text="3\. Rounding lower back and squeezing abs, lift hips off floor so pelvis tilts up toward ribs. Curl pelvis as far as you can without arching back; pull abs in to lift rather than press through left heel. Lower to floor."/>
        <LineBreak/>
        <LineBreak/>
        <Run Text="4.Do 10 reps, holding the lift for 10 seconds on the final one. Switch sides and repeat. Do 3 sets."/>

    </TextBlock>
    </Grid>
    </ScrollViewer>
</Grid> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-10T21:22:27.317

您现在对大量文本采取的方法绝对是您要重新考虑的事情。即使使用了所有额外的格式，您也可能希望堆叠标签，或将它们放置在 Grid 的上下文中（如 William 提到的）。

详情在这里：

*   [如何使用堆栈面板](http://www.silverlightshow.net/items/Using-the-StackPanel-control-in-Silverlight-2-Beta-1.aspx)
*   [如何使用网格](http://www.silverlightshow.net/items/Using-the-Grid-control-in-Silverlight-2-Beta-1.aspx)

# php - 仅为特定目录启用 APC？

> ID：11421494
> 
> 赞同：1
> 
> 时间：2012-07-10T20:34:00.723
> 
> 标签：php, linux, caching, centos, apc

我目前在 CentOs 服务器上安装并运行了 APC，它工作正常，但是它目前缓存所有目录中的所有文件。

如何更改设置以使其仅缓存我选择的目录？

因此，例如，我可以使用 .htaccess 将其启用一个目录？

我目前拥有的唯一 APC 设置`php.ini`如下：

```
extension = apc.so
apc.enabled = 1
apc.shm_size = 30 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T20:38:30.683

您可以使用[apc.filters](http://www.php.net/manual/en/apc.configuration.php#ini.apc.filters)告诉 APC 不要缓存某些文件/目录。匹配是通过正则表达式完成的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-10T20:41:55.387

> **apc.filters 字符串**
> 
> POSIX 扩展正则表达式的逗号分隔列表。如果任何模式与源文件名匹配，则不会缓存该文件。请注意，用于匹配的文件名是传递给 include/require 的文件名，而不是绝对路径。如果表达式的第一个字符是 + 则表达式将是附加的，即任何与表达式匹配的文件都将被缓存，如果第一个字符是 - 那么任何匹配的文件都不会被缓存。- 大小写是默认值，因此可以省略。

这是一个 PHP_INI_SYSTEM 参数，因此*如果*您在 cgi/suEXEC/suPHP 下运行并且可以在每个目录的基础上设置 php.ini，则只能在每个目录的基础上执行此操作。

# ruby - MongoID find 或 find_by

> ID：11421496
> 
> 赞同：16
> 
> 时间：2012-07-10T20:34:17.383
> 
> 标签：ruby, mongodb, mongoid

MongoID[文档](http://mongoid.org/en/mongoid/docs/querying.html#queries)似乎很清楚我应该能够运行它并让它工作：

```
Band.find_by(name: "Photek") 
```

但至少对于 MongoID 2.4.11，这给了我一个`NoMethodError`.

另一方面，这有效：

```
Band.find(name: "Photek") 
```

更改为 很容易`find_by`，`find`但我很困惑发生了什么。这是我的 gem 版本落后于文档的情况，还是什么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-07-10T21:35:14.007

Mongoid 文档现在默认显示版本 3（它是 RC）。您想在[此处](http://two.mongoid.org)查看 Mongoid 2 的文档。

在`find`vs`find_by`上，这是来自Mongoid 2 -> 3的[升级指南：](http://mongoid.org/en/mongoid/docs/upgrading.html)

> Model.find 和 model.relation.find 现在只接受一个或多个 id。Model.first、Model.last 也不再带参数。对于这些，请改用 Model.find_by。

爱荷华州：

蒙古人2：

```
Band.find(some_id)
Band.find(name: "Billy Talent") 
```

Mongoid 3：

```
Band.find(some_id)
Band.find(some_id, some_other_id)
Band.find_by(name: "Billy Talent") 
```

# android - 自升级到冰淇淋三明治后，SIGSEGV 深入 MediaPlayer

> ID：11421497
> 
> 赞同：2
> 
> 时间：2012-07-10T20:34:24.443
> 
> 标签：android, media-player, android-4.0-ice-cream-sandwich, chromium

我开发了一个音乐应用程序，它在 Android 之前的冰淇淋三明治上运行良好。但是自从我升级到 4.0.3 后，我开始遇到以前从未遇到过的 MediaPlayer 随机问题。例如，这是我刚刚在实例处于播放完成状态时调用 mediaPlayer.reset 得到的：

```
07-10 15:27:51.842: D/NuCachedSource2(13537): [setBreak]mForceBreak = 2  
07-10 15:27:51.842: I/ChromiumHTTPDataSourceSupport(13537): initiateDisconnect start  
07-10 15:27:51.852: A/libc(13537): Fatal signal 11 (SIGSEGV) at 0x00000010 (code=1)  
07-10 15:27:52.362: I/DEBUG(13536): debuggerd: 2012-07-10 15:27:52  
07-10 15:27:52.362: I/DEBUG(13536): *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** ***  
07-10 15:27:52.362: I/DEBUG(13536): Build fingerprint: 'tmous/htc_ruby/ruby:4.0.3/IML74K/373265.3:user/release-keys'  
07-10 15:27:52.362: I/DEBUG(13536): pid: 13537, tid: 13537  >>> /system/bin/mediaserver <<<  
07-10 15:27:52.362: I/DEBUG(13536): signal 11 (SIGSEGV), code 1 (SEGV_MAPERR), fault addr 00000010  
[...]  
07-10 15:27:52.402: I/DEBUG(13536):  scr 60000010  
07-10 15:27:52.542: I/DEBUG(13536):          #00  pc 00000010    
07-10 15:27:52.542: I/DEBUG(13536):          #01  pc 0010f70e  /system/lib/libchromium_net.so (_ZNK3net11BoundNetLog8AddEntryENS_6NetLog9EventTypeENS1_10EventPhaseERK13scoped_refptrINS1_15EventParametersEE)  
07-10 15:27:52.542: I/DEBUG(13536):          #02  pc 0010f71a  /system/lib/libchromium_net.so (_ZNK3net11BoundNetLog8EndEventENS_6NetLog9EventTypeERK13scoped_refptrINS1_15EventParametersEE)  
07-10 15:27:52.542: I/DEBUG(13536):          #03  pc 001a4458  /system/lib/libchromium_net.so (_ZN3net10URLRequest11set_contextEPNS_17URLRequestContextE)  
07-10 15:27:52.552: I/DEBUG(13536):          #04  pc 0012467e  /system/lib/libstagefright.so (_ZN7android10SfDelegate18initiateDisconnectEv)  
07-10 15:27:52.552: I/DEBUG(13536):          #05  pc 00121ca6  /system/lib/libstagefright.so (_ZN7android22ChromiumHTTPDataSource12disconnect_lEv)  
07-10 15:27:52.552: I/DEBUG(13536):          #06  pc 00121d04  /system/lib/libstagefright.so (_ZN7android22ChromiumHTTPDataSource10disconnectEv)  
07-10 15:27:52.552: I/DEBUG(13536):          #07  pc 00121776  /system/lib/libstagefright.so (_ZN7android22ChromiumHTTPDataSource12breakNetworkEv)  
07-10 15:27:52.552: I/DEBUG(13536):          #08  pc 00083b38  /system/lib/libstagefright.so (_ZN7android13AwesomePlayer12breakNetworkENS_18FORCE_BREAK_STATUSE)  
07-10 15:27:52.552: I/DEBUG(13536):          #09  pc 00086c9e  /system/lib/libstagefright.so (_ZN7android13AwesomePlayer5resetEv)  
07-10 15:27:52.552: I/DEBUG(13536):          #10  pc 00027e5e  /system/lib/libmediaplayerservice.so (_ZN7android17StagefrightPlayer5resetEv)  
07-10 15:27:52.552: I/DEBUG(13536):          #11  pc 0002304a  /system/lib/libmediaplayerservice.so (_ZN7android18MediaPlayerService6Client5resetEv)  
07-10 15:27:52.552: I/DEBUG(13536):          #12  pc 00041734  /system/lib/libmedia.so (_ZN7android13BnMediaPlayer10onTransactEjRKNS_6ParcelEPS1_j) 
```

不久之后：

```
07-10 15:27:55.645: W/AudioSystem(236): AudioFlinger server died!  
07-10 15:27:55.645: W/AudioSystem(236): AudioPolicyService server died!  
07-10 15:27:55.645: W/AudioSystem(13123): AudioFlinger server died!  
07-10 15:27:55.645: W/IMediaDeathNotifier(13123): media server died  
07-10 15:27:55.645: E/MediaPlayer(13123): error (100, 0)  
07-10 15:27:55.645: E/MediaPlayer(13123): error (100, 0)  
07-10 15:27:55.645: I/ServiceManager(116): service 'media.audio_flinger' died  
07-10 15:27:55.645: I/ServiceManager(116): service 'media.player' died  
07-10 15:27:55.645: I/ServiceManager(116): service 'media.camera' died  
07-10 15:27:55.645: I/ServiceManager(116): service 'media.audio_policy' died  
07-10 15:27:55.645: I/DEBUG(13536): debuggerd committing suicide to free the zombie!  
07-10 15:27:55.665: I/DEBUG(13617): debuggerd: May  2 2012 21:31:04 
```

有人暗示什么会导致此级别的分段错误？

谢谢。

编辑：经过进一步调查，我发现了一些简单的步骤来重现运行 Android 4.0.3 的 HTC Ruby (HTC Amaze 4G) 上的分段错误：

使用 2 个 MediaPlayer 实例：

1.  使用第一个实例开始播放一些远程音频文件；
2.  在第一个实例仍在播放时，使用第二个实例开始播放另一个远程音频文件；
3.  当第一个实例完成播放时，对其调用重置。这可以。
4.  当第二个实例完成播放时，对其调用 reset()。出乎意料的是，这会导致 Chromium 内部出现 SIGSEGV，从而导致将媒体服务器死亡错误分派到所有实例。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T20:50:55.587

看着那里的logcat，

```
07-10 15:27:52.542: I/DEBUG(13536):          #00  pc 00000010    
07-10 15:27:52.542: I/DEBUG(13536):          #01  pc 0010f70e  /system/lib/libchromium_net.so (_ZNK3net11BoundNetLog8AddEntryENS_6NetLog9EventTypeENS1_10EventPhaseERK13scoped_refptrINS1_15EventParametersEE)  
07-10 15:27:52.542: I/DEBUG(13536):          #02  pc 0010f71a  /system/lib/libchromium_net.so (_ZNK3net11BoundNetLog8EndEventENS_6NetLog9EventTypeERK13scoped_refptrINS1_15EventParametersEE)  
07-10 15:27:52.542: I/DEBUG(13536):          #03  pc 001a4458  /system/lib/libchromium_net.so (_ZN3net10URLRequest11set_contextEPNS_17URLRequestContextE)  
07-10 15:27:52.552: I/DEBUG(13536):          #04  pc 0012467e  /system/lib/libstagefright.so (_ZN7android10SfDelegate18initiateDisconnectEv)  
07-10 15:27:52.552: I/DEBUG(13536):          #05  pc 00121ca6  /system/lib/libstagefright.so (_ZN7android22ChromiumHTTPDataSource12disconnect_lEv)  
07-10 15:27:52.552: I/DEBUG(13536):          #06  pc 00121d04  /system/lib/libstagefright.so (_ZN7android22ChromiumHTTPDataSource10disconnectEv)  
07-10 15:27:52.552: I/DEBUG(13536):          #07  pc 00121776  /system/lib/libstagefright.so (_ZN7android22ChromiumHTTPDataSource12breakNetworkEv)  
07-10 15:27:52.552: I/DEBUG(13536):          #08  pc 00083b38  /system/lib/libstagefright.so (_ZN7android13AwesomePlayer12breakNetworkENS_18FORCE_BREAK_STATUSE)  
07-10 15:27:52.552: I/DEBUG(13536):          #09  pc 00086c9e  /system/lib/libstagefright.so (_ZN7android13AwesomePlayer5resetEv)  
07-10 15:27:52.552: I/DEBUG(13536):          #10  pc 00027e5e  /system/lib/libmediaplayerservice.so (_ZN7android17StagefrightPlayer5resetEv)  
07-10 15:27:52.552: I/DEBUG(13536):          #11  pc 0002304a  /system/lib/libmediaplayerservice.so (_ZN7android18MediaPlayerService6Client5resetEv)  
07-10 15:27:52.552: I/DEBUG(13536):          #12  pc 00041734  /system/lib/libmedia.so (_ZN7android13BnMediaPlayer10onTransactEjRKNS_6ParcelEPS1_j) 
```

这些行精确地指出了跟踪的来源，它`libchromium`在某个地方出现了故障，是的，使用的符号名称看起来很模糊，但它是在构建 ROM 时链接的损坏的 C++ 名称。

您从下往上读取跟踪。这就是线索，通常是最上面的`#00/pc....`或`#01/pc....`如上图所示，是失败的精确点。

可能值得与您的制造商核实以查看是否有可用的更新或查看他们的 HTC 论坛以了解该问题是否已解决？

# dojo - Dojo dnd（拖放）1.7.2 - 如何维护一个单独的（非dojo-dnd）列表？

> ID：11421499
> 
> 赞同：0
> 
> 时间：2012-07-10T20:34:31.727
> 
> 标签：dojo, drag-and-drop, dojo-dnd

我正在使用 Dojo dnd 1.7.2 版，它通常运行良好。我很高兴。

我的应用程序维护了许多项目数组，当用户拖放项目时，我需要确保我的数组被更新以反映用户正在看到的内容。

为了做到这一点，我想我需要在`Source`.`onDndDrop`

如果我过去在我的 Source 上为or`dojo.connect`设置处理程序，我的代码似乎被调用得太晚了。也就是说，传递给处理程序的 that 实际上不再包含该项目。`onDndDrop``onDrop``source`

这是一个问题，因为我想调用`source.getItem(nodes[0].id)`以获取正在拖动的实际数据，以便我可以在我的数组中找到它并更新这些数组以反映用户所做的更改。

也许我说错了；还有更好的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T21:23:56.010

好的，我找到了一个很好的方法来做到这一点。在另一个问题的答案中发现了一个提示： [https ://stackoverflow.com/a/1635554/573110](https://stackoverflow.com/a/1635554/573110)

我成功的通话顺序基本上是：

```
var source = new dojo.dnd.Source( element, creationParams );
var dropHandler = function(source,nodes,copy){
  var o = source.getItem(nodes[0].id); // 0 is cool here because singular:true.
  // party on o.data ...
  this.oldDrop(source,nodes,copy);
}
source.oldDrop = source.onDrop;
source.onDrop = dropHandler; 
```

这确保了`onDrop`( `dropHandler`) 的新实现在之前安装的之前被调用。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-11T08:57:55.913

我猜有点空白，dndSource有几种不同的实现。但是对于在鼠标悬停/dnddrop 期间调用的事件/检查函数，有一些事情需要了解。

一种方法是为`checkAcceptance(source, nodes)`您可能拥有的任何目标进行设置。然后保留当前拖动的节点的引用。但是，由于多个容器具有动态内容，因此变得很棘手。

设置您的源，同时覆盖`checkAcceptance`并使用已知的（可能是全局的）变量来跟踪。

```
var lastReference = null;
var target = dojo.dnd.Source(node, {
    checkAcceptance(source, nodes) : function() {
        // this is called when 'nodes' are attempted dropped - on mouseover
        lastReference = source.getItem(nodes[0].id)
        // returning boolean here will either green-light or deny your drop
        // use fallback (default) behavior like so:
        return this.inhertied(arguments);
    }
}); 
```

最好的方法可能就是这样 - 你手头有目标和源加上节点，但是你需要找出哪个是在其中查找节点的正确堆栈。我相信它与事件同时发布（`onDrop`）你已经在使用：

```
dojo.subscribe("/dnd/drop", function(source, nodes, copy, target) {
  // figure out your source container id and target dropzone id
  // do stuff with nodes
  var itemId = nodes[0].id
} 
```

通过 dojo.subscribe 和事件可用的机制/主题在此处列出 [http://dojotoolkit.org/reference-guide/1.7/dojo/dnd.html#manager](http://dojotoolkit.org/reference-guide/1.7/dojo/dnd.html#manager)

# asp.net - Asp.Net CertEnroll CX509CertificateRequestPkcs10 异常

> ID：11421502
> 
> 赞同：3
> 
> 时间：2012-07-10T20:34:55.690
> 
> 标签：asp.net, exception, windows-server-2008, certenroll

我有一个 asp.net 4.0 项目，它结合使用 Bouncy Castle 和 .Net 框架来创建 X509 证书。

它在我的 W7 开发机器上正常运行，但是当安装在 W2008（32 位，而不是 r2）上时，这段代码：

```
CX509CertificateRequestPkcs10 csr = new CX509CertificateRequestPkcs10(); 
```

抛出此异常：

> 无法将“System.__ComObject”类型的 COM 对象转换为接口类型“CERTENROLLLib.CX509CertificateRequestPkcs10”。此操作失败，因为 IID 为“{728AB35B-217D-11DA-B2A4-000E7BBB2B09}”的接口的 COM 组件上的 QueryInterface 调用因以下错误而失败：不支持此类接口（来自 HRESULT 的异常：0x80004002 (E_NOINTERFACE)） .

最初我认为这可能是 64 位服务器问题，因为 COM 仅兼容 32 位，但服务器是 32 位的。

该应用程序是使用 Framework 4.0 构建的，分配的 IIS AppPool 正在运行 4.0，集成模式，具有“网络服务”的标识 - 与我的开发机器上的所有内容完全相同，与使用的客户端浏览器 (IE8 32) 一样。

W2008-32（标准）是否没有开箱即用地实现 CERTENROLLLib？有谁知道如何使它在这种情况下表现？

感谢您的任何建议！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-10T21:30:06.787

当您实例化 CX509CertificateRequestPkcs10 对象时，明确指定您要使用的接口（通过 ProgID）。在 Win2008 R2 中，微软重写了界面。代替：

```
CX509CertificateRequestPkcs10 objPkcs10 = new CX509CertificateRequestPkcs10(); 
```

采用：

```
IX509CertificateRequestPkcs10 objPkcs10 = (IX509CertificateRequestPkcs10)Activator.CreateInstance(Type.GetTypeFromProgID("X509Enrollment.CX509CertificateRequestPkcs10")); 
```

由于在 Win2008 R2 中微软重写了界面，如果代码是在 Win2008 R2 中编写的，则运行时正在寻找新的界面 GUID，而在常规 Win2008 中则找不到，因为 Win2008 R2 界面 GUID 与 Win2008 界面 GUID 不同。

因此，无法创建对象，并引发异常。

通过 ProgID 访问接口解决了这个问题。

请参阅：[TechNet 答案](http://social.technet.microsoft.com/Forums/en-NZ/winserversecurity/thread/45781b46-3eb7-4715-b877-883bf0dc2ae7)- 在 W2008-32 上，创建 Pkcs10 对象时必须指定接口 GUID，因为 R2 覆盖了旧的“标准”接口。

# html - Div 在容器之外，但为什么呢？

> ID：11421503
> 
> 赞同：0
> 
> 时间：2012-07-10T20:34:58.097
> 
> 标签：html, css-float

我已经花了太多时间来处理由于某种原因放置在容器外部的页脚内的两个 div。一遍又一遍地检查我的 HTML 和 CSS，但看不出有什么问题。

这可能是我的代码中的浮动/清除问题或一些小错字，但我找不到它。非常感谢任何解决此问题的帮助。

该页面可以在[http://nionwebdesign.com/dev/check](http://nionwebdesign.com/dev/check)找到。这是关于放置在白色容器外的“Bestellen”和“Info”部分。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T20:39:23.220

可能你让它们漂浮起来。父元素永远不会扩展以包含浮动元素。要让它做你想做的事，请添加`overflow:auto`到“容器”父元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-10T20:51:36.917

在这里您可以找到问题的描述和评论的解决方案： [http ://www.quirksmode.org/css/clearing.html](http://www.quirksmode.org/css/clearing.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-10T22:08:26.537

这个 SO 答案列出了所有最好的解决方案，从 2011 年更新的“micro-clearfix”开始。

溢出：隐藏的解决方案并非没有问题，您可能会或可能不会遇到这些问题，具体取决于您的页面布局。

[我可以使用哪些“clearfix”方法？](https://stackoverflow.com/questions/211383/which-method-of-clearfix-is-best/1633170#1633170)

# vb.net - VB.Net 按整数的值订购字典（字符串，整数）

> ID：11421515
> 
> 赞同：3
> 
> 时间：2012-07-10T20:36:02.883
> 
> 标签：vb.net, dictionary

我有一个字符串字典，整数所以键是字符串，值是整数，我想按整数值升序排列键。我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-10T20:56:51.343

您可以使用[LINQ](http://msdn.microsoft.com/en-us/library/bb534966.aspx)按值排序`Dictionary`：

```
Dim dictionary = New Dictionary(Of String, Integer)() 
dictionary.Add("A", 2)
dictionary.Add("B", 4)
dictionary.Add("C", 5)
dictionary.Add("D", 3)
dictionary.Add("E", 1)

Dim sorted = From pair In dictionary
             Order By pair.Value
Dim sortedDictionary = sorted.ToDictionary(Function(p) p.Key, Function(p) p.Value) 
```

实际上它不会修改原始字典，而是使用新顺序创建一个新字典。

**但是**：除了可行性之外， a`Dictionary`不是一个`IList`（作为一个数组或`List<T>`）。它的目的是非常有效地查找密钥，但不是循环所有条目。

它们是无序的，这意味着尽管您可以使用 foreach 循环以某种顺序检索元素，但该顺序没有特殊含义，并且可能会无缘无故地更改。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-10T20:47:11.543

首先，字典没有内在顺序。它用于查找。但是，您可以将键变成它们自己的有序列表。

```
Dim keyList as List(Of String) = (From tPair As KeyValuePair(Of String, Integer) _
                                  In myDictionary Order By tPair.Value Ascending _
                                  Select tPair.Key).ToList 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-10T20:46:30.577

我不得不对自定义对象做类似的事情。我认为这应该接近（但可能不完全是）您正在寻找的内容：

```
Dim sortedL As List(Of KeyValuePair(Of String, Integer)) = yourDictionary.ToList
sortedL.Sort(Function(firstPair As KeyValuePair(Of String, Integer), nextPair As KeyValuePair(Of String, Integer)) CInt(firstPair.Value).CompareTo(CInt(nextPair.Value))) 
```

# java - 将一个文本文件解析为多个文本文件

> ID：11421519
> 
> 赞同：-2
> 
> 时间：2012-07-10T20:36:15.193
> 
> 标签：java

我想通过Java解析输入文件来获取多个文件。输入文件包含数千个蛋白质序列的许多 fasta 格式，我想生成每个蛋白质序列的原始格式（即，没有任何逗号分号，也没有任何额外的符号，如“>”、“[”、“]”等）。

fasta 序列从“>”符号开始，然后是蛋白质描述，然后是蛋白质序列。

例如 ► >lcl|NC_000001.10_cdsid_XP_003403591.1 [gene=LOC100652771] [protein=假设蛋白质 LOC100652771] [protein_id=XP_003403591.1] [location=join(12190..12227,12595..12721,13403). ] MSESINFSHNLGQLLSPPRCVVMPGMPFPSIRSPELQKTTADLDHTLVSVPSVAESLHHPEITFLTAFCL PSFTRSRPLPDRQLHHCLALCPSFALPAGDGVCHGPGLQGSCYKGETQESVESRVLPGPRHRH

与上述格式一样，输入文件包含 1000 多个蛋白质序列。我必须生成数千个原始文件，其中仅包含单个蛋白质序列，没有任何特殊符号或间隙。

我已经用 Java 开发了它的代码，但输出是：无法打开文件，然后找不到文件。

请帮我解决我的问题。

问候 Vijay Kumar Garg Varanasi Bharat（印度）

代码是

```
/*Java code to convert FASTA format to a raw format*/
import java.io.*;
import java.util.*;
import java.util.regex.*;
import java.io.FileInputStream;

// java package for using regular expression
public class Arrayren
{
    public static void main(String args[]) throws IOException  
    {
        String a[]=new String[1000];
        String b[][] =new String[1000][1000];
        /*open the id file*/
        try
        {
            File f = new File ("input.txt"); 
            //opening the text document containing genbank ids
            FileInputStream fis = new FileInputStream("input.txt");
            //Reading the file contents through inputstream
            BufferedInputStream bis = new BufferedInputStream(fis);
            // Writing the contents to a buffered stream
            DataInputStream dis = new DataInputStream(bis);
            //Method for reading Java Standard data types
            String inputline;
            String line;
            String separator = System.getProperty("line.separator");
            // reads a line till next line operator is found
            int i=0;
            while ((inputline=dis.readLine()) != null) 
            {
                i++;
                a[i]=inputline;
                a[i]=a[i].replaceAll(separator,"");
                //replaces unwanted patterns like /n with space
                a[i]=a[i].trim();
                // trims out if any space is available
                a[i]=a[i]+".txt";
                //takes the file name into an array
                try
                // to handle run time error
                /*take the sequence in to an array*/
                {
                    BufferedReader in = new BufferedReader (new FileReader(a[i]));
                    String inline = null;
                    int j=0;
                    while((inline=in.readLine()) != null)
                    {
                        j++;
                        b[i][j]=inline;
                        Pattern q=Pattern.compile(">");
                        //Compiling the regular expression
                        Matcher n=q.matcher(inline);
                        //creates the matcher for the above pattern
                        if(n.find())
                        {
                            /*appending the comment line*/
                            b[i][j]=b[i][j].replaceAll(">gi","");
                            //identify the pattern and replace it with a space
                            b[i][j]=b[i][j].replaceAll("[a-zA-Z]","");
                            b[i][j]=b[i][j].replaceAll("|","");
                            b[i][j]=b[i][j].replaceAll("\\d{1,15}","");
                            b[i][j]=b[i][j].replaceAll(".","");
                            b[i][j]=b[i][j].replaceAll("_","");
                            b[i][j]=b[i][j].replaceAll("\\(","");
                            b[i][j]=b[i][j].replaceAll("\\)","");
                        }
                        /*printing the sequence in to a text file*/
                        b[i][j]=b[i][j].replaceAll(separator,"");
                        b[i][j]=b[i][j].trim();
                        // trims out if any space is available
                        File create = new File(inputline+"R.txt");
                        try
                        {
                            if(!create.exists())
                            {
                                create.createNewFile();
                                // creates a new file
                            }
                            else
                            {
                                System.out.println("file already exists");
                            }
                        }
                        catch(IOException e)
                        // to catch the exception and print the error if cannot open a file
                        {
                            System.err.println("cannot create a file");
                        }
                        BufferedWriter outt = new BufferedWriter(new FileWriter(inputline+"R.txt", true));
                        outt.write(b[i][j]);
                        // printing the contents to a text file
                        outt.close();
                        // closing the text file
                        System.out.println(b[i][j]);
                    }
                }
                catch(Exception e)
                {
                    System.out.println("cannot open a file");
                }
            }
        }
        catch(Exception ex)
        // catch the exception and prints the error if cannot find file
        {
            System.out.println("cannot find file ");
        }
    }
} 
```

如果您提供正确的信息，它将更容易理解。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T21:15:41.070

您的代码包含以下两个`catch`块：

```
 catch(Exception e)
    {
        System.out.println("cannot open a file");
    } 
```

```
 catch(Exception ex)
    // catch the exception and prints the error if cannot find file
    {
        System.out.println("cannot find file ");
    } 
```

这两个都吞下了异常并打印了一条通用的“它不起作用”消息，它告诉您该`catch`块已被输入，但仅此而已。

异常通常包含有用的信息，可以帮助您找出真正的问题所在。通过忽略它们，您将更难诊断您的问题。更糟糕的是，您正在捕获`Exception`，这是许多异常的超类，因此这些`catch`块正在捕获许多不同类型的异常并忽略它们。

从异常中获取信息的最简单方法是调用其`printStackTrace()`方法，该方法会打印异常类型、异常消息和堆栈跟踪。在这两个`catch`块中添加对 this 的调用，这将帮助您更清楚地看到抛出了什么异常以及从哪里抛出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T21:12:41.437

由于缺少 java 专业知识，此代码不会赢得价格。例如，即使它是正确的，我也会期望 OutOfMemory。最好是重写。*尽管如此，我们都从小事开始。*

*   给出文件的完整路径。同样在输出中，文件中可能缺少目录。
*   更好地使用 BufferedReader 等 io DateInputStream。
*   用 -1 初始化 i。更好用`for (int i = 0; i < a.length; ++i)`。
*   最好在循环外编译 Pattern。但删除匹配器。你也可以这样做`if (s.contains(">")`。. 不需要创建新文件。

代码：

```
const String encoding = "Windows-1252"; // Or "UTF-8" or leave away.
File f = new File("C:/input.txt");
BufferedReader dis = new BufferedReader(new InputStreamReader(
    new FileInputStream(f), encoding)); 
```

...

```
 int i= -1; // So i++ starts with 0.
        while ((inputline=dis.readLine()) != null) 
        {
            i++;
            a[i]=inputline.trim();
            //replaces unwanted patterns like /n with space
            // Not needed a[i]=a[i].replaceAll(separator,""); 
```

# javascript - KnockoutJS - 依赖的可观察对象或计算的可观察对象

> ID：11421520
> 
> 赞同：3
> 
> 时间：2012-07-10T20:36:16.527
> 
> 标签：javascript, knockout.js

*KnockoutJS*中的**依赖可观察对象**和**计算可观察**对象之间有什么区别吗？

 *我的理解是，**计算出的 observables 是****依赖 observables**的继承者（在新版本的 Knockout 中基本上只是不同的名称） - 但是网络上的一些教程使用一个，而一些使用另一个。

有人可以一劳永逸地回答这个问题吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-10T20:40:30.237

同样的，在淘汰赛 2.0 中更改了名称。较早的示例可能使用旧名称。

请参阅：http: [//knockoutjs.com/documentation/dependentObservables.html](http://knockoutjs.com/documentation/dependentObservables.html)

从淘汰赛的文档中：

> 在运行时，ko.dependentObservable 与 ko.computed 引用相同的函数，因此您现有的代码将继续正常工作。*

# php - DOM全选，如何遍历

> ID：11421523
> 
> 赞同：0
> 
> 时间：2012-07-10T20:36:25.740
> 
> 标签：php, dom, xpath, domdocument

我有一张看起来像这样的 trs 表。

```
<tr> 
  <td><a href="http://www.mysite.com">Link</a></td>
  <td>value 2</td>
  <td>value 3</td>
  <td>value 4</td>
  <td>value 5</td>
</tr> 
```

我正在使用 xPath 来全选`<tr>`并遍历它们。

```
foreach($xpathResult as $item){
  //print the href of the first td
  //print the nodeValue of the second td
  //print the nodeValue of the 3rd td
  //print the nodeValue of the 4th td
  //print the nodeValue of the 5th td
} 
```

如何打印第一个 td 的 href 和`nodeValue`之后每个 td 的 href？有`firstChild`and `lastChild`，但我如何到达中间 s？我可以使用`firstChild->nextSibling`，`firstChild->nextSibling->nextSibling`但没有更简单的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T20:50:54.070

只需在 上使用循环`childNodes`，如下所示：

```
foreach( $trs as $tr) {
    echo $tr->firstChild->firstChild->attributes->getNamedItem( 'href')->value;
    foreach( $tr->childNodes as $k => $td) {
        if( $k == 0) continue; // Skip the first one
        echo $td->nodeValue . "\n";
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T20:38:10.810

为什么不直接选择td？

```
$results = $dom->xpath('//tr/td');
foreach($results as $td) {
   echo $td->nodeValue;
} 
```

# java - 仅从时间戳中获取日期

> ID：11421527
> 
> 赞同：12
> 
> 时间：2012-07-10T20:36:57.843
> 
> 标签：java, date, timestamp

这是我传递时间戳的下方函数，我只需要从时间戳返回的日期，而不是小时和秒。使用下面的代码，我得到-

```
private String toDate(long timestamp) {
        Date date = new Date (timestamp * 1000);
        return DateFormat.getInstance().format(date).toString();
} 
```

这是我得到的输出。

```
11/4/01 11:27 PM 
```

但我只需要这样的日期

```
2001-11-04 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-07-10T20:43:33.957

请改用 SimpleDateFormat：

```
private String toDate(long timestamp) {
    Date date = new Date(timestamp * 1000);
    return new SimpleDateFormat("yyyy-MM-dd").format(date);
} 
```

*更新*：Java 8 解决方案：

```
private String toDate(long timestamp) {
    LocalDate date = Instant.ofEpochMilli(timestamp * 1000).atZone(ZoneId.systemDefault()).toLocalDate();
    return date.format(DateTimeFormatter.ofPattern("yyyy-MM-dd"));
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-12-13T11:07:16.283

您可以使用此代码获得所需的结果

```
protected Timestamp timestamp = new Timestamp(Calendar.getInstance().getTimeInMillis());

protected String today_Date=timestamp.toString().split(" ")[0]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-11-05T13:55:46.440

# *java.time*

`java.util`日期时间 API 及其格式化 API已`SimpleDateFormat`过时且容易出错。建议完全停止使用它们并切换到[现代 Date-Time API](https://www.oracle.com/technical-resources/articles/java/jf14-Date-Time.html) ^*。

另外，下面引用的是来自[**Joda-Time**](https://www.joda.org/joda-time/)[主页](https://www.joda.org/joda-time/)**的通知：**

 **> 请注意，从 Java SE 8 开始，用户被要求迁移到 java.time (JSR-310) - JDK 的核心部分，它取代了这个项目。

**使用`java.time`现代日期时间 API 的解决方案：**

您可以使用[`Instant#ofEpochSecond`](https://docs.oracle.com/javase/8/docs/api/java/time/Instant.html#ofEpochSecond-long-)to get a `Instant`out of the given `timestamp`，然后使用[`LocalDate.ofInstant`](https://docs.oracle.com/javase/9/docs/api/java/time/LocalDate.html#ofInstant-java.time.Instant-java.time.ZoneId-)to get a `LocalDate`out of the getting `Instant`。

**演示：**

```
import java.time.Instant;
import java.time.LocalDate;
import java.time.ZoneId;

public class Main {
    public static void main(String[] args) {
        // Test
        System.out.println(toDate(1636120105L));
    }

    static LocalDate toDate(long timestamp) {
        return LocalDate.ofInstant(Instant.ofEpochSecond(timestamp), ZoneId.systemDefault());
    }
} 
```

**输出：**

```
2021-11-05 
```

[`ONLINE DEMO`](https://ideone.com/P350dp)

**[从Trail: Date Time](https://docs.oracle.com/javase/tutorial/datetime/index.html)**了解有关现代日期时间 API 的更多信息。检查[此答案](https://stackoverflow.com/a/67752047/10819573)和[此答案](https://stackoverflow.com/a/67505173/10819573)以了解如何将`java.time`API 与 JDBC 一起使用。

* * *

^(* 如果您正在为一个 Android 项目工作，并且您的 Android API 级别仍然不符合 Java-8，请[通过 desugaring 检查可用的 Java 8+ API](https://developer.android.com/studio/write/java8-support-table)。请注意，Android 8.0 Oreo 已经提供[对`java.time`](https://developer.android.com/reference/java/time/package-summary).)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-19T07:37:24.340

# 乔达时间

[Joda-Time](http://www.joda.org/joda-time/)库提供了一个[`LocalDate`](http://www.joda.org/joda-time/apidocs/org/joda/time/LocalDate.html)类来表示没有任何时间或时区的仅日期值。

## 时区

确定日期需要[时区](http://en.wikipedia.org/wiki/List_of_tz_database_time_zones)。巴黎午夜刚过的时刻意味着比蒙特利尔同一时刻早一天的日期。如果您忽略指定时区，则会应用 JVM 当前的默认时区——可能不是您想要的，因为结果可能会有所不同。

## 示例代码

```
long millisecondsSinceUnixEpoch = ( yourNumberOfSecondsSinceUnixEpoch * 1000 ); // Convert seconds to milliseconds.
DateTimeZone timeZone = DateTimeZone.forID( "America/Montreal" );
LocalDate localDate = new LocalDate( millisecondsSinceUnixEpoch, timeZone );
String output = localDate.toString(); // Defaults to ISO 8601 standard format, YYYY-MM-DD. 
```

## 前一天

按照评论中的要求获得前一天。

```
LocalDate dayBefore = localDate.minusDays( 1 ); 
```

## 转换为 juDate

**应该避免**使用 java.util.Date 和 .Calendar 类，因为它们是出了名的麻烦。但如果需要，您可以转换。

```
java.util.Date date = localDate.toDate(); // Time-of-day set to earliest valid for that date. 
```**

# android - Salesforce android 应用程序中的自定义 url 方案

> ID：11421530
> 
> 赞同：0
> 
> 时间：2012-07-10T20:37:02.613
> 
> 标签：android, intentfilter

我希望实现一个自定义 url 方案（例如 myapp://），以便可以在浏览器和/或电子邮件链接中打开我的 android 应用程序。我知道这里有很多答案都指向 AndroidManifest.xml 中的意图过滤器作为答案，但我无法让它工作。我不确定如何让我的应用程序检测到这些意图过滤器。如果有人可以在这方面帮助我，那就太好了。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T21:04:07.837

尝试像这样的教程：[http](http://www.vogella.com/articles/AndroidIntent/article.html#intentfilter) ://www.vogella.com/articles/AndroidIntent/article.html#intentfilter 在它说`<data android:scheme="http"/>`设置它的部分`<data android:scheme="myapp"/>`

然后在你把这个 IntentFilter 放入的 Activity 中，继续做一个`getIntent().getData()`，这会给你 URI。然后你可以随心所欲地处理。例如，如果您发送`myapp://opencontact/joe_bob`，您可以拉出零件并打开您的 ContactProfileActivity 或其他任何内容并显示用户乔鲍勃......

# c# - 如何在 C# 中检查字符串是否包含可反序列化的数据？

> ID：11421532
> 
> 赞同：3
> 
> 时间：2012-07-10T20:37:04.660
> 
> 标签：c#, .net, serialization, xml-serialization

我们在为特定列序列化之后保存数据，所以在检索数据和反序列化之前如何检查字符串是否可反序列化？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-10T20:57:35.590

确保一个字符串表示一个有效的序列化对象几乎与执行反序列化本身一样困难，因为您需要遍历序列化对象图，找出每个序列化字段的开始位置，以及进入该字段的数据是什么。

您可以保存的唯一操作是对象及其依赖项的分配。这些操作当然不是免费的，但它们经过高度优化，因此您的节省不会太大。

您可以采取推测的方法，并假设您的反序列化将成功，而不是在反序列化之前预先验证字符串。您的代码可以直接反序列化您的字符串，并且在大多数情况下它会成功！^*为确保您的代码在字符串无效时不会中断，请将反序列化调用包装到 a`try/catch`中，并注意反序列化异常。如果你抓住其中任何一个，你就知道这个字符串是无效的；如果您没有捕获反序列化异常，您将知道该字符串是有效的，*并且*您还可以准备好您的反序列化对象以供使用。

假设 XML 序列化，您的代码可以执行以下操作：

```
static bool TryDeserialize<T>(string xmlStr, out T obj) {
    var ser = new XmlSerializer(typeof(T));
    using(var stringReader = new StringReader(xmlStr)) {
        using (var xmlReader = new XmlTextReader(stringReader)) {
            try {
                obj = ser.Deserialize(xmlReader);
            } catch {
                obj = default(T);
                return false;
            }
        }
    }
    return true;
} 
```

* * *

^*如果你的反序列化在绝大多数情况下都失败了，你可能需要重新考虑这个策略。

# python - Matplotlib：如何将两个自定义颜色条添加到图像映射

> ID：11421534
> 
> 赞同：2
> 
> 时间：2012-07-10T20:37:23.040
> 
> 标签：python, matplotlib

设置...我有一组映射到二维空间（即 f(x,y) = (z,w)）的配对值（z,w），我正在从中制作图像映射。我首选的方法是每个点的 rgb 颜色为：(r,g,b) = (z' *w', z'* (1-w'), z'), z' and w'被归一化为 0 和 1 之间（用于颜色映射目的）。通过这种方式，z 值有效地确定了点的亮度，而 w 值确定了红蓝色调。

这是问题......我可以制作这个图像映射，但颜色条是彩虹颜色映射（不知何故），这不是很有帮助。相反，我需要两个独立的自定义颜色条。我想要的是在右侧有一个垂直颜色条，它是黑白的，缩放到 z 的范围，底部有一个水平颜色条，是蓝红色，缩放到 w 的范围。

有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T22:38:22.650

正如 imsc 在对我的问题的评论中指出的那样，答案在于他链接到的[matplotlib 示例。](http://matplotlib.sourceforge.net/examples/api/colorbar_only.html)这是我正在使用的代码，遵循链接的示例，专门解决了我的问题中的情况：

```
import matplotlib as mpl

ax_cb1 = fig.add_axes((0.85, 0.125, 0.03, 0.75))
BW_cdict = {
    'red':    ((0.0, 0.0, 0.0),
               (1.0, 1.0, 1.0)),
     'green': ((0.0, 0.0, 0.0),
               (1.0, 1.0, 1.0)),
     'blue': ((0.0, 0.0, 0.0),
               (1.0, 1.0, 1.0))
    }
black_white = mpl.colors.LinearSegmentedColormap('BlackWhite', BW_cdict)
norm = mpl.colors.Normalize(vmin=z_min, vmax=z_max)
cb1 = mpl.colorbar.ColorbarBase(
    ax_cb1, cmap=black_white, norm=norm, orientation='vertical'
)

ax_cb2 = fig.add_axes((0.125, 0.95, 0.75, 0.03))
BR_cdict = {
    'red':    ((0.0, 0.0, 0.0),
               (1.0, 1.0, 1.0)),
     'green': ((0.0, 0.0, 0.0),
               (1.0, 0.0, 0.0)),
     'blue':  ((0.0, 1.0, 1.0),
               (1.0, 0.0, 0.0))
    }
blue_red = mpl.colors.LinearSegmentedColormap('BlueRed', BR_cdict)
norm = mpl.colors.Normalize(vmin=w_min, vmax=w_max)
cb2 = mpl.colorbar.ColorbarBase(
    ax_cb2, cmap=blue_red, norm=norm, orientation='horizontal'
) 
```

# php - How to take snapshots/image of excel sheets?

> ID：11421535
> 
> 赞同：-2
> 
> 时间：2012-07-10T20:37:22.907
> 
> 标签：php, perl, excel, charts

My requirement is to display charts present in MS Office excel 2007 in web page.

Can someone please help me getting it right by any language? PHP is my preference by i didn't get any help on google.

I have more than 1 chart in all sheets inside a single excel file.

PHPExcel and equivalent API's doesn't support chart import support, so only solution i see is to import excel sheets as image and display.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-10T20:47:50.763

Take a look at the 32chartreadwrite.php in PHPExcel's /Tests directory. This provides the basic code for reading an Excel 2007+ .xlsx file with its chart data.

```
$objReader = PHPExcel_IOFactory::createReader($fileType);
$objReader->setIncludeCharts(TRUE);
$objPHPExcel = $objReader->load($fileName);

PHPExcel_Settings::setChartRenderer(
    PHPExcel_Settings::CHART_RENDERER_JPGRAPH,
    dirname(__FILE__).'/../../libraries/Charts/jpgraph3.5.0b1/src'
);

$chart = $objPHPExcel->getSheetByName($sheetName)->getChartByName($chartName);
$chart->render(); 
```

While it doesn't support every feature (only a single Y-axis, for example) or every chart type (stock charts aren't supported by the renderer), it can work with a wide variety of chart types.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-10T20:40:53.877

2 sec search on google for "php chart" gets me:

[http://pchart.sourceforge.net/](http://pchart.sourceforge.net/)

A fully open source charting library...

Note that charting is not part of the excel per se. It is an object that is rendered by the charting library used by Excel. You still need to extrapolate the data from the excel spreadsheet and pass it on correctly to your charting engine...

# c++ - 使用事件和状态重用来提升 msm 问题

> ID：11421537
> 
> 赞同：1
> 
> 时间：2012-07-10T20:37:26.983
> 
> 标签：c++, boost, boost-msm

我的转换表和事件有问题。让我解释一下说明问题的假设计：

我有一个包含 2 个状态（s0 和 s1）和 1 个子状态机（subm1）的状态机（myStateMachine）。

子状态机 subm1 包含初始状态“sub0”和 s1（与 myStateMachine 中的状态相同）。

这是主要的转换表：

事件 'ES1' 上的 s0->s1

事件 'ES2' 上的 s0->s2

事件 'ESUB' 上的 s0->subm1

这是submachine转换表：

事件“ES1”上的 sub0->s1

现在，假设状态 s1 正在使用触发它的事件来提取一些信息，即

```
struct s1 : public msm::front::state<>
{
   template <class Event,class FSM>
   void on_entry(Event const& evt,FSM& fsm)
   { 
      evt.getEventData();
   }
} 
```

所以每个可以转换到 s1 的事件都需要实现 getEventData() 方法。

-> 这是正常的！

现在我的问题是 ESUB 没有实现 getEventData() 但显然它应该（编译器给出错误）。我不明白为什么。

我没有使用 ESUB 转换到 s1，但我正在使用 ESUB 转换到 subm1，并且 subm1 包含 s1，但那时我没有访问它。

我希望这很清楚。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T16:26:30.807

我收到了 BOOST MSM 设计师 Christophe Henry 的答复：

“你好，

这是 msm（用于复合材料）的不幸限制，我在我的清单上列出了要尽快解决的问题。问题是虽然事件 esub 不用于转换到 s1，但对于编译器来说它可以。无论如何，这是我的错，而且我在文档中忘记了它:(

解决方案是通过为具有特殊属性的事件启用 on_entry evt.getEventData() 来帮助编译器，例如您的 es1。例如：

```
BOOST_MPL_HAS_XXX_TRAIT_DEF(get_event_data) 

// this event supports getEventData 
struct es1 
{ 
   typedef int get_event_data; 
   void getEventData(){...} 
 }; 
```

然后在您的状态下使用它：

```
 struct s1 : public msm::front::state<> 
 { 
   template <class Event,class FSM> 
   typename boost::enable_if<typename 
   has_get_event_data<Event>::type,void>::type 
   on_entry(Event const& evt,FSM& fsm) 
   { 
      evt.getEventData(); 
   } 
   // for events not supporting getEventData like esub 
   template <class Event,class FSM> 
   typename boost::disable_if<typename 
   has_get_event_data<Event>::type,void>::type 
   on_entry(Event const& ,FSM& ) 
   {    } 
   }; 
```

"

# java - 没有 main 方法如何运行 Java 程序？

> ID：11421542
> 
> 赞同：16
> 
> 时间：2012-07-10T20:37:40.207
> 
> 标签：java

> **可能重复：**
> [在控制台上打印消息而不使用 main() 方法](https://stackoverflow.com/questions/8605137/printing-message-on-console-without-using-main-method)

有人可以建议如何在**不**编写**主要方法**的情况下运行 JAVA 程序..

例如：

```
System.out.println("Main not required to print this"); 
```

如何在**不**使用类中的**public static void main(String arg[])**的情况下在控制台上打印上面的行。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-07-10T20:42:36.190

在 Java 6 之前（包括**Java 6**），可以使用[静态初始化块来执行此操作，正如](http://docs.oracle.com/javase/tutorial/java/javaOO/initial.html)[在控制台上打印消息而不使用 main() 方法](https://stackoverflow.com/questions/8605137/printing-message-on-console-without-using-main-method)的问题中指出的那样。例如使用以下代码：

```
public class Foo {
    static {
         System.out.println("Message");
         System.exit(0);
    } 
} 
```

让程序在`System.exit(0)`JVM寻找`main`方法之前退出，否则会抛出以下错误：

> 线程“main”中的异常 java.lang.NoSuchMethodError: main

但是，在**Java 7**中，**这不再起作用**，即使它可以编译，当您尝试执行它时也会出现以下[错误：](http://ideone.com/WMQkH)

> 程序编译成功，但是没有找到主类。主类应包含方法：public static void main (String[] args)。

这里另一种方法是编写自己的启动器，这样您就可以根据需要定义入口点。

在文章[JVM Launcher](https://web.archive.org/web/20140311103404/http://www.codeproject.com/Articles/17352/JVM-Launcher)中，您将找到入门所需的信息：

> 本文介绍了如何创建 Java 虚拟机启动器（如 java.exe 或 javaw.exe）。它探讨了 Java 虚拟机如何启动 Java 应用程序。它为您提供了有关您正在使用的 JDK 或 JRE 的更多想法。这个启动器在带有 Java Native Interface 的 Cygwin（Linux 模拟器）中非常有用。本文假设您对 JNI 有基本的了解。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2012-07-10T20:39:15.557

在 JDK6 之前，您可以使用[静态初始化程序块](http://docs.oracle.com/javase/tutorial/java/javaOO/initial.html)来打印消息。这样，一旦你的类被加载，消息就会被打印出来。然后诀窍就变成了使用另一个程序来加载你的类。

```
public class Hello {
  static {
    System.out.println("Hello, World!");
  }
} 
```

当然，你可以运行程序`java Hello`，你会看到消息；但是，该命令也会失败并显示一条消息：

> 线程“main”中的异常 java.lang.NoSuchMethodError: main

**[编辑]**正如其他人所指出的，您可以通过`System.exit(0)`在打印消息后立即调用来避免 NoSuchmethodError。

从 JDK6 开始，您不再看到来自`static`初始化程序块的消息；[详情在这里](https://www.geeksforgeeks.org/main-method-compulsory-java/)。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2012-07-10T20:38:59.253

```
public class X { static {
  System.out.println("Main not required to print this");
  System.exit(0);
}} 
```

从 cmdline 运行`java X`.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-07-10T20:47:07.573

[我记得的小程序](http://docs.oracle.com/javase/tutorial/deployment/applet/)不需要 main 方法，尽管我不确定它们在技术上是否是一个程序。

# php - 使用 PHP/PDO 从 MySQL 表中返回数据

> ID：11421546
> 
> 赞同：0
> 
> 时间：2012-07-10T20:37:48.320
> 
> 标签：php, mysql, pdo

我是 PHP 新手，对 PDO 很陌生。每个人都在告诉我要学习。

我已经设法建立到我的数据库的连接，我试图返回我的结果并将每一行包装在 a 中`DIV`，但它只返回一个包含所有列标题的数组。

我目前有：

```
$sql = "SELECT * FROM users";
$q   = $conn->query($sql) or die("failed!");
while($r = $q->fetchAll(PDO::FETCH_ASSOC)){
    print_r($r);
} 
```

谁能指出我正确的方向或给我一些有用的网站可以提供帮助？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-10T20:47:02.823

```
$stmt = $conn->prepare("SELECT * FROM users");

$stmt->execute();

foreach( $stmt as $row )
{
    echo "<div>" . $row['column'] . "</div>"
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T21:10:24.450

我这样做更容易......

```
while($r = $q->fetch(PDO::FETCH_LAZY)){

    echo '<div>';
    echo $r['id'];
    echo $r['first_name'];
    echo $r['surname'];
    echo $r['hometown'];
    echo $r['facebook'];
    echo '</div>';

} 
```

# java - 保存变量以在类上使用

> ID：11421551
> 
> 赞同：0
> 
> 时间：2012-07-10T20:38:07.400
> 
> 标签：java, android, android-intent

我想将字符串传递给我的 android 应用程序中的所有页面。当用户登录时，我将 userName 和其他人保存到字符串中。我想通过多个页面发送字符串。我怎样才能做到这一点？

我试图通过 Intent 发送它

```
Intent myIntent = new Intent(view.getContext(), Help.class);  
myIntent.putExtra("userName", userNameString);
startActivityForResult(myIntent, 0); 
```

但是当我转到另一个页面时，我不想每次都通过 Intent 发送数据。

我试图从我解析的类中获取它并将它们放入字符串中

```
HomeScreen home = new HomeScreen();
String userName= home.userNameString; 
```

但是因为我正在创建 HomeScreen 的新实例，所以`userNameString`是`null`

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-10T20:46:50.017

请注意使用静态或实例变量来保存此状态，因为 Android 应用程序的内存状态可能会不断变化。如果您的应用程序进程在后台被终止，则仅存储在内存中的数据可能会在您不知情的情况下被破坏。

最简单的机制是将您的数据持久化到`SharedPreferences`您可以从应用程序中的任何位置访问的数据中。因此，首先您保存从登录中获得的字符串（这在 Activity 中调用，仅供参考）：

```
//Write the username string to preferences
SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(this);
prefs.edit().putString("userName", userNameString).commit(); 
```

然后在您的应用程序的其他地方（即其他 Activity 实例）可以读取该字符串：

```
//Read the username string
SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(this);
String userName = prefs.getString("userName", ""); 
```

使用`SharedPreferences`，您的值实际上是持久的，这意味着它们将永远存在于磁盘上，并且不会因为您的应用程序的内存被重置而消失（这通常是一个优势，尤其是对于登录信息）。因此，您还需要在用户“注销”时**删除字符串，如下所示：**

```
//Remove the username string from preferences
SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(this);
prefs.edit().remove("userName").commit(); 
```

还有一些方法`contains()`可以让您检查当前是否保存了值（用户是否登录？）等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-10T20:42:25.387

调用`Activity`不保证保留在内存中...... Android系统可能随时销毁它。

如果孩子`Activity`依赖于用户名，那么传递信息的正确方法是使用`Intent`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-10T20:40:16.353

声明一个静态变量并在任何地方使用它：

```
public class SomeClass
{
    public static String userNameString;
} 
```

像这样使用它：

```
Strign s = SomeClass.userNameString; 
```

将其值更改为：

```
SomeClass.userNameString = "new string"; 
```

# jquery - 如何发出警报呼叫以不重复单击按钮？

> ID：11421552
> 
> 赞同：0
> 
> 时间：2012-07-10T20:38:09.817
> 
> 标签：jquery

我的 jsfiddle 在这里 - [http://jsfiddle.net/rDe9V/3/](http://jsfiddle.net/rDe9V/3/)

**相关的 jQuery**

```
$(function() {
    $('form input[type="text"]').live('keyup', function() {
        var val = $.trim(this.value);
        $('form .create-playlist-button').prop('disabled', val.length == 0)
    });
    $('form .create-playlist-button').click(function(e) {
        var title = $(e.target).closest('.video-detail').find('.title').text();
        alert(title);
    });
}); 
```

**要求**

a.) 当我点击“新建”时，我应该能够选择相应的表单值，如标题、视图等

b.）现在，它会在每次按键时不断发出警报

我是 jQuery 新手，不太了解

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T21:12:06.180

看看[我的更新](http://jsfiddle.net/rDe9V/4/)。

我使用[.on()](http://jqapi.com/#p=on)而不是 .live() 和 .click() 因为这适用于页面中的所有未来元素（类似`live`但*更好*）。另外，我将处理函数添加到`submit`表单的事件中，因为这是在您单击“新建”按钮时触发的（现在这适用于您体内的所有表单，因此您可能希望缩小该选择器的范围一点点）。

在该处理程序中，您可以获得所需的一切并使用[.post()](http://jqapi.com/#p=jQuery.post)函数将其提交给服务器。我想这就是你想要的。

在下面找到相关的代码。

* * *

```
$(document).ready(function() {
    // activate "New" buttons if input is not empty
    $('form input[type="text"]').live('keyup', function() {
        var val = $.trim(this.value);
        $(this).next("button").prop('disabled', val.length === 0);
    });

    $("body").on("submit","form",function(e){
        // do not submit the form
        e.preventDefault();

        // handle everything yourself
        var $form = $(this);
        var title = $form.closest('.video-detail').find('.title').text();
        var entryTitle = $form.find('.input-small').val();
        console.debug(title);
        console.debug(entryTitle);
        // send the data to the server using .ajax() or .post()
    });
}); 
```

# jquery - jQuery 插件 - 传递自定义事件

> ID：11421554
> 
> 赞同：1
> 
> 时间：2012-07-10T20:38:27.060
> 
> 标签：jquery, jquery-plugins

我已经构建了自己的 jQuery 分页插件。见下文：

```
$.fn.extend({
    pager: function(options) {
        var settings = {
            pageSize: 10,
            onPageChanged: function() { }
        };

        if (options)
            $.extend(settings, options);

        return this.each(function() {
            // Trigger onPageChanged event
        });
    }
}); 
```

可以这样称呼：

```
$('#placeholder').pager({ pageSize: 20, onPageChanged: function() { alert('Page Changed!'); } }); 
```

我想知道如何触发通过插件中的选项传入的函数。我确定这很简单，但我似乎在文档中找不到任何帮助。

我会很感激帮助。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T20:54:51.947

尝试使用：

```
settings.onPageChanged.call(this); 
```

您还可以选择添加`.call()`将传递给函数的其他参数。

如果您想要一个可以在 `$('#placeholder').on("onPageChanged",handler)`以后绑定使用的真正自定义事件，请改为执行以下操作：

```
this.on("onPageChanged",settings.onPageChanged); 
```

然后触发它：

```
this.triggerHandler("onPageChanged"); 
```

# r - 编写读取示例文件的 R 包小插图？

> ID：11421559
> 
> 赞同：6
> 
> 时间：2012-07-10T20:38:40.243
> 
> 标签：r, sweave

我正在尝试为 R 中的一个包编写一个小插图。我一直在关注[范德比尔特大学的教程](http://biostat.mc.vanderbilt.edu/wiki/Main/HowToCreateAnRPackage)以及[官方文档](http://cran.r-project.org/doc/manuals/R-exts.pdf)。

我制作了一个`.Rnw`Sweave 文件并将其放入`inst/doc`包内的子目录中。在同一个子目录`inst/doc`中，我放置了一个`example`包含一些示例文本文件的文件夹。我的包有一个`myparser(path)`我想在小插图中演示的功能；`myparser(path)`通过读取具有绝对路径名的文件夹内的文本文件来创建多个数据框`path`。

然后我使用 检查包`R CMD CHECK`，并收到此错误：

```
* checking running R code from vignettes ...
   ‘mypackage-vignette.Rnw’ using ‘UTF-8’ ... failed
 ERROR
Errors in running code in vignettes:
when running code in ‘mypackage-vignette.Rnw’
  ...
> library(mypackage)
Loading required package: ggplot2

> myparser("/example/")
Warning in file(file, "rt") :
  cannot open file '/example/': No such file or directory

  When sourcing ‘mypackage-vignette.R’:
Error: cannot open the connection
Execution halted 
```

我看到我尝试使用文件夹的相对路径没有工作（可能对我来说应该很明显），但我仍然不确定如何解决这种情况。我不想用*我计算机*`path`上文件夹的绝对路径替换，因为那样小插曲的代码将无法在其他人的计算机上重现。

 *如何在包中包含示例文件，以便小插图的代码可重现？我是否以正确的方式解决这个问题？

（抱歉，这个问题本身并不能重现！）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-11T01:43:02.647

您可以使用`system.file('doc', 'example', package = 'mypackage')`来引用该目录，因为 R 将在构建小插图之前安装包，正如您在运行`R CMD build mypackage`.*

# jquery - jQuery Mobile 无法通过 SSLVPN 工作

> ID：11421560
> 
> 赞同：2
> 
> 时间：2012-07-10T20:38:49.707
> 
> 标签：jquery, jquery-mobile, vpn

**在下面的 Firebug 控制台错误中**更新错误。**谢谢，`Jasper`因为我没有想到。`my.url.com`是我的更改，但它是通过 SSLVPN 引用某些内容的正确地址。**

 **> ```
> Security error
> https://my.url.com/mobile/1.1.0/,DanaInfo=code.jquery.com,CT=js+jquery.mobile-1.1.0.js
> Line 3903 
> ```

该位置的代码在`jquery.mobile-1.1.0.js`

```
init: function() {
  $win.bind( "hashchange", self.onHashChange );
  // Handle popstate events the occur through history changes
  $win.bind( "popstate", self.onPopState );
  // if there's no hash, we need to replacestate for returning to home
  if ( DanaGetHash(location) === "" ) {
    history.replaceState( self.state(), document.title, DanaGetHref(location) );
  }
} 
```

看起来是由 SSLVPN 添加的`DanaGetHash`。`DanaGetHref`

**原来**，我使用 jQuery Mobile 创建了一个移动页面，我遇到了一个问题，当从我们网络中的非 SSLVPN 计算机访问时，它工作得非常好，但是当通过我们的 SSLVPN 访问它时，页面被严重破坏。

在 IE8 和 IE9 中，首页显示，但通过 a 链接的后续页面都`listview`不会尝试显示。单击链接会显示*等待的微调器*，但不会显示页面。

在 Chrome 和 Firefox 中，首页是空白的。

我尝试使用 jQuery 的 CDN 以及相对目录中的本地副本。

*   我们的 SSLVPN 是瞻博网络
*   jQuery 1.7.2**非最小化**
*   jQuery Mobile 1.1.0**非最小化**

随时询问您可能需要的任何详细信息，我们将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-03T21:20:18.863

对于可能遇到此问题的任何人，我都能够通过配置选择性重写规则来解决该问题，该规则将避免重写特定的 js 文件。不需要对安全性不利的直通代理。

**资源**：`http://my.site/lib/jquery.mobile-1.0rc1.js`

**政策适用于选定的角色：** my_mobileapp_role

**行动**：不要重写内容：不要重定向到目标网络服务器

然后页面将正确加载。希望我帮助了某人。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T15:34:55.660

万一其他人感兴趣，如何解决这个问题是瞻博网络 SSLVPN 的两件事。

1.  我们必须使用传递方法而不是重写。JQuery 和 re-write 不是朋友。所以为了让 jQuery 工作，我们必须在登录后代理访问。Juniper 告诉我，这对于 Sharepoint 来说很常见，因为在 Sharepoint 网站上很多重写往往会失败。
2.  在本地托管和引用 jQuery 脚本。这很重要，因为（根据 Juniper 的解释）我们不能通过代理到外部站点，也不能通过传递代理重写外部站点。

希望这对某人感兴趣。**

# selection - Sublime Text 2 在选择边界处多选（Mac OS X）

> ID：11421563
> 
> 赞同：0
> 
> 时间：2012-07-10T20:39:04.710
> 
> 标签：selection, sublimetext2

假设我在一行中选择了一个单词“two”，例如：

一`two`三

是否有一个组合键可以在前一个选择的两端使用光标创建多个选择，如下所示（其中 | 字符表示光标）：

一|二| 三

我正在寻找类似 command-shift-L 的功能，但它需要在一行上工作。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-02T15:26:30.987

曾经有一个捷径。它是`Ctrl+Shift+K`。它仍在[文档](http://www.sublimetext.com/docs/selection)中：

> 给定一个选定的文本块，Ctrl+Shift+K 将把它分成两个选择，一个用于每一端。

它看起来不再存在，但我希望他们能把它带回来。

# jquery - 使用jquery在不同屏幕分辨率上的热图

> ID：11421566
> 
> 赞同：0
> 
> 时间：2012-07-10T20:39:10.027
> 
> 标签：jquery, heatmap

我阅读了 Chris Coyier 的文章 ( [http://css-tricks.com/tracking-clicks-building-a-clickmap-with-php-and-jquery/](http://css-tricks.com/tracking-clicks-building-a-clickmap-with-php-and-jquery/) )。它展示了如何通过页面跟踪用户点击，将其保存到数据库，然后从中构建热图。

没有问题，它可以在固定屏幕分辨率下正常工作，但是如果失败，我会在调整窗口大小的那一刻。

假设我想跟踪我整个网站的点击，不同屏幕分辨率之间会发生什么，所以假设用户使用 1024×768 屏幕分辨率，另一个来自桌面的用户是 1024×640，另一个来自移动设备电话。

最后，我正在使用完全不同的屏幕分辨率（比如 1280×720）查看我的网站报告。是不是会造成混乱。

很想听听是否有任何解决方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T20:45:19.940

您可以使用特定的固定分辨率（例如 1024 x 768 ）来实现这一点。如果调整了窗口大小，则需要重新计算宽度和高度，然后尝试将单击位置“缩放”回固定的 1024 x 768 设计。这不会是 100% 准确的，但它会给你不错的结果。

# asp.net-mvc - ASP.NET MVC Metro 风格

> ID：11421570
> 
> 赞同：5
> 
> 时间：2012-07-10T20:39:19.027
> 
> 标签：asp.net-mvc

任何人都尝试过使用 jQuery UI 的 ASP.NET MVC Metro 风格外观。我正在寻找现成的可用皮肤/主题或插件。

任何人都知道在哪里看..

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-10T22:51:13.287

有许多。

如果您有 SVN，请从 [https://github.com/rwhitmire/MetroMvc下载示例](https://github.com/rwhitmire/MetroMvc)

教程来自

[http://social.msdn.microsoft.com/Forums/en-US/winappswithhtml5/thread/f90d5571-ff80-4f87-ac77-c217a5a22139](http://social.msdn.microsoft.com/Forums/en-US/winappswithhtml5/thread/f90d5571-ff80-4f87-ac77-c217a5a22139)

[http://code52.org/metro.css/](http://code52.org/metro.css/)

[http://stephenwalther.com/](http://stephenwalther.com/)

主题来自

[http://code.google.com/p/jq-metro/](http://code.google.com/p/jq-metro/)

[http://www.jqmetro.com/Pages/](http://www.jqmetro.com/Pages/)

[http://jquit.com/builder/](http://jquit.com/builder/)

[http://archive.plugins.jquery.com/project/metro](http://archive.plugins.jquery.com/project/metro)

[http://www.dustinhorne.com/post/2012/02/21/Metro-Style-UI-With-jQuery.aspx](http://www.dustinhorne.com/post/2012/02/21/Metro-Style-UI-With-jQuery.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-24T18:42:32.367

检查此链接...

地铁主题和网站

[http://www.webresourcesdepot.com/everything-you-need-to-create-windows-8-metro-ui-styled-websites/](http://www.webresourcesdepot.com/everything-you-need-to-create-windows-8-metro-ui-styled-websites/)

[http://www.codeproject.com/Articles/138661/Metro-UI-Zune-like-Interface-form](http://www.codeproject.com/Articles/138661/Metro-UI-Zune-like-Interface-form)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-05T07:40:14.720

多一个！酷酷的

[http://metroui.org.ua/](http://metroui.org.ua/)

此支持菜单组件：菜单导航、表格等...

# iso8583 - ISO 8583 Rev 93 字母和数字字符打包/拆包

> ID：11421574
> 
> 赞同：2
> 
> 时间：2012-07-10T20:39:23.440
> 
> 标签：iso8583, openiso8583.net

我面临着发送 ISO 8583 Rev 93 消息的任务，并且正在使用 openiso8583.net。使用我的消息的公司提供了消息样本，我不清楚以下字段属性：

特殊字符 字母和数字字符 字母和特殊字符 数字和特殊字符 字母、数字和特殊字符

这是示例：

```
Signon Reply
0810822000000200000004000000000000000501130427000005F0F00001
NUM  |FLDNAME |FIELD DESCRIPTION              |LEN |T|FIELD VALUE
-----|--------|-------------------------------|----|-|--------------------------
N/A  |MSGTYPE |MESSAGE TYPE                   |F2  |H|0810`
N/A  |BITMAP1 |FIRST BITMAP                   |B8  |H|8220000002000000`
1    |BITMAP2 |SECOND BITMAP                  |B8  |H|0400000000000000`
7    |MISDTMDT|TRANSMISSION DATE AND TIME     |F5  |H|0501130427`
11   |MISDSTAN|SYSTEM TRACE AUDIT NUMBER      |F3  |H|000005`
39   |MISDRSPC|RESPONSE CODE                  |F2  |C|00`      <------?
70   |MISDNMIC|NETWORK MANAGEMENT INFO CODE   |F2  |H|0001` 
```

首先看一下消息字节：0810822000000200000004000000000000000501130427000005* *F0F0* *0001

我的问题是两个字节 { 0xF0, 0xF0 } 如何转换为“00”。如果公司发送 ASCII，我希望“00”是 { 0x30, 0x30 }。BCD 用于数值，但我似乎无法弄清楚字符值是如何编码的。

以下是字段 39 的说明：

```
039:
Network Response Code

Attributes: 
an 2*

Description:
A field that indicates the result of a previous related request. It will indicate
approval or reason for rejection if not approved. It is also used to indicate to the
device processor whether or not machines that are capable of retaining the customer's
card should do so.

Format:
In transaction replies, the response code must contain one of the following values
with their corresponding meanings. For debit/host-data-capture 0220 / 0420 messages, a
response code of '00' must be returned to indicate the transaction was approved. For
EBT transactions, please refer to section 4.8 EBT Transaction Receipt Requirements. 
```

an2 表示字母和数字字符

位图 1 是 64 位

位图 2 是 64 位

消息类型为 4 个字节

字段 7 是数字 4 位 BCD（压缩无符号）10、5 字节

字段 11 是数字 4 位 BCD（压缩无符号）6、3 字节

字段 39 是 2，我假设 2 个字节

字段 70 是数字 4 位 BCD（压缩无符号）3、2 字节

任何线索或指针将不胜感激。也许有人知道一些我显然不知道的编码，或者可以对 ISO 8583 Rev 93 的字符编码方式进行一般解释。我确实意识到每个公司都可以有不同的实现。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-10T21:04:20.640

我讨厌快速回答自己的问题，但是……我刚刚找到了答案。

[EBCDIC](http://en.wikipedia.org/wiki/EBCDIC)

我想在打卡时代不是程序员让我在这个方面放慢了速度

0xF0 = '0'

# sql - 在 1 个单一查询中获得问题和答案

> ID：11421577
> 
> 赞同：4
> 
> 时间：2012-07-10T20:39:25.110
> 
> 标签：sql, database

我需要进行一个查询来获取所有用户的问题，并且对于每个问题，从数据库中获取 3 个答案。此查询需要尽可能高效。

我有桌子：

```
questions:
  id
  user_id
  title
  date_created
  date_updated

answers:
  id
  question_id
  user_id
  body
  date_created 
```

我可以在 1 个查询中完成吗？基本上我需要显示问题，与用户表连接以获取用户名，显示问题的 3 个答案并为每个答案显示发布者的用户名。

我的做法是这样的：

```
SELECT questions.*, GROUP_CONCAT(answers.id) as answers 
  FROM (questions) 
  JOIN users ON users.id = questions.user_id 
  LEFT JOIN answers ON answers.question_id = questions.id 
 WHERE questions.user_id = '1' 
 GROUP BY questions.id 
 ORDER BY questions.date_updated desc 
 LIMIT 3 
```

但这还没有完成，也不能很好地工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T03:23:01.653

我建议使用交叉应用...它取决于您使用的 SQL 服务器版本，但这是一个示例查询。
如果您不确定问题是否有答案，请使用外部应用 如果您
只想要有答案的问题，请使用交叉应用

```
SELECT
  q.id,
   q.[user_id],
   q.title,
   q.date_created,
   q.date_updated,
   ans.id,
   ....
FROM
  questions q
     CROSS APPLY
     (
     SELECT TOP 3
        a.id,
       a.question_id,
       a.[user_id],
       a.body,
       a.date_created
     FROM
       answers a
     WHERE
       q.id = a.question_id
     ) ans 
```

[在这里查看更多](http://technet.microsoft.com/en-us/library/ms175156%28v=sql.105%29.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T00:58:13.937

您可以尝试将数据库设计更改为：

```
post:
  id
  parent_id
  user_id
  title
  date_created
  date_updated 
```

在这个设计问题中有一个 NULL parent_id。现在您可以进行如下查询：

```
select posts.* from
(
    SELECT id, parent_id, user_id, title, date_created, date_updated FROM post WHERE id = 67
    UNION ALL
    SELECT id, parent_id, NULL as user_id, NULL as title, NULL as date_created, NULL as date_updated FROM post WHERE parent_id = 67
) posts
Left JOIN users ON users.id = posts.user_id
WHERE posts.user_id = '1' 
ORDER BY posts.date_updated desc 
LIMIT 3 
```

当您从数据库中提取数据时，请确保 NULL parent_id 排在第一位，这样问题就排在第一位。通过这种方式，它更快、更易于管理并且具有更高的可读性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-10T21:19:24.170

假设标题是问题，正文是答案，并且由于某种奇怪的原因，问题表中的 id 字段与答案表中的问题 id 相关。要限制三个答案，您可能需要创建一个子查询。

```
SELECT title, FROM questions 
WHERE user_id IN 
(SELECT users.username, answers.body FROM users, answers WHERE 
 answers.user_id = users.user_id LIMIT 3); 
```

但是，我会修复 question_id 在您的问题表中被称为 id 的事实，不给外键提供与其相关的主键相同的名称是非常糟糕的做法。

# sql - 使用游标在表的行上循环

> ID：11421578
> 
> 赞同：1
> 
> 时间：2012-07-10T20:39:29.073
> 
> 标签：sql, sql-server

我正在尝试使用演示数据更新表，所以我决定构建一个`stored procedure`.

这里是：

```
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:      Tommy Bergeron
-- Create date: 2011-07-10
-- Description: This SP updates a Patient's CreateDate row
-- with realistic demo DateTime data.
-- =============================================
CREATE PROCEDURE UpdatePatientCreateDateWithDemoData @PatientID int
AS
BEGIN
    -- SET NOCOUNT ON added to prevent extra result sets from
    -- interfering with SELECT statements.
    SET NOCOUNT ON

    DECLARE @IncrementalDateTime DATETIME,
    @BGID int,
    @CreateDate DATETIME

    -- Setting starting datetime    
    SET @IncrementalDateTime = '2012-01-01 10:00 AM'

    -- Declaring cursor
    DECLARE BGCursor CURSOR FOR
        SELECT BGID, CreateDate FROM G2_BloodGlucose WHERE PatientID = @PatientID ORDER BY CreateDate ASC

    -- Opening cursor and starting the loop
    OPEN BGCursor
    FETCH NEXT BGCursor INTO @BGID, @CreateDate
    WHILE @@FETCH_STATUS = 0
    BEGIN
        -- Updating row with generated DateTime
        UPDATE G2_BloodGlucose SET CreateDate = @IncrementalDateTime WHERE BGID = @BGID

        -- Incrementing DateTime
        SET @IncrementalDateTime = DATEADD(hour, 1, @IncrementalDateTime)

        FETCH NEXT BGCursor INTO @BGID, @CreateDate
    END

    CLOSE BGCursor
    DEALLOCATE BGCursor

END
GO 
```

我构建了它，以更新表中的 DateTime 字段。所以我为查询找到的每一行增加一个变量 1 小时。

我实际遇到的问题是这些错误：

```
Msg 102, Level 15, State 1, Procedure UpdatePatientCreateDateWithDemoData, Line 27
Incorrect syntax near 'NEXT'.
Msg 102, Level 15, State 1, Procedure UpdatePatientCreateDateWithDemoData, Line 33
Incorrect syntax near 'NEXT'. 
```

我很少构建存储过程，所以我有点迷茫。是否有可能提供有关如何解决这些错误的提示？我查看了几个网站来比较我的代码，但找不到任何有用的东西。

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-10T20:42:51.320

虽然游标可能是魔鬼的工具，但如果你想使用它们，你需要：

```
 FETCH NEXT FROM BGCursor INTO @BGID, @CreateDate 
```

代替

```
 FETCH NEXT BGCursor INTO @BGID, @CreateDate 
```

有关语法，请参阅[MSDN 文章](http://msdn.microsoft.com/en-us/library/ms180152.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-10T20:44:00.057

我认为您的语法不正确您缺少 FROM 关键字

```
FETCH NEXT FROM BGCursor INTO @BGID, @CreateDate 
```

# mysql - 为什么 Coldfusion/MySQL 中的左连接会导致无限循环？

> ID：11421579
> 
> 赞同：1
> 
> 时间：2012-07-10T20:39:33.513
> 
> 标签：mysql, coldfusion, left-join, infinite-loop

我在 Coldfusion8 (MySQL 5.0.88) 中运行搜索查询。

该查询在 Coldfusion 中构造一个 LEFT JOIN，如下所示：

```
<cfquery datasource="db" name="q">
    SELECT ...
</cfscript> 
```

并循环遍历结果以创建 MySQL 查询语法：

```
<cfset variables.pl= "LEFT JOIN pricelists p ON ">
<cfloop query="q" >
    <cfscript>
    if( q.listitem IS '' )    
        variables.pl = variables.pl & '(a.iln = p.iln AND p.pl= "-Standard-" AND p.ean = a.ean AND p.iln = "#q.iln_verkaeufer#") OR ';
    else
        variables.pl= variables.pl & '(a.iln = p.iln AND p.pl= "#q.pl#" AND p.ean = a.ean AND p.iln = "#q.userID#") OR
    </cfscript>
</cfloop>
<cfset variables.pl= variables.pl& "(1=0)"> 
```

所以决赛看起来像这样：

```
LEFT JOIN plist p ON (p.iln = a.iln AND p.pl= "-Standard-" AND p.iln = "1111111111111") OR (p.iln = a.iln AND p.pl= "I" AND p.iln = "1111122222221") OR (1=0) 
```

这被输入到实际的查询语法中：

```
SELECT art, count(*) as number
    FROM article a
    <cfqueryparam value="#variables.pl#" cfsqltype="cf_sql_longvarchar">
WHERE ... 
```

如果我尝试触发此操作，服务器就会挂起，我需要重新启动浏览器选项卡以结束会话。我已从我的选择中删除了所有其他搜索条件。该错误是由提供我的文本构造的 cfqueryparam 引起的。

但是我不知道问题可能是什么，因为我从来没有收到错误。浏览器刚刚死机，所以我想我正在创建某种无限循环。

**问题**
谁能从我的代码中看出我做错了什么？

谢谢！

**编辑：** 我设法从服务器挂断到提交错误。但是由于脚本是由 Ajax 调用触发的，并且我无法远程访问 CFadmin，因此我需要猜测问题可能是什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-10T21:05:08.413

你在这里做的不是 cfqueryparam 的目的，我建议阅读 cfqueryparam 的正确用法 - [http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7f6f.html](http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7f6f.html)

将您的代码重构为如下所示应该可以按您的预期工作。我只是根据我的喜好替换了标签的脚本，如果这是您的喜好，请随意使用脚本。

```
<cfquery ...>
SELECT art, count(*) as number
FROM article a
LEFT JOIN pricelists p ON
<cfloop query="q" >
<cfif q.listitem IS ''>
    (a.iln = p.iln
    AND p.pl= "-Standard-"
    AND p.ean = a.ean
    AND p.iln = <cfqueryparam value='#q.iln_verkaeufer#' />
    )
<cfelse>
    (a.iln = p.iln
    AND p.pl= <cfqueryparam value="#q.pl#"/>
    AND p.ean = a.ean
    AND p.iln = <cfqueryparam value="#q.userID#" />
    )
</cfif>
<cfif NOT q.isLast()>OR</cfif>
</cfloop>
WHERE ...
</cfquery> 
```

# java - 来自 getParameter (Tomcat Servlet) 的 null 返回值

> ID：11421580
> 
> 赞同：0
> 
> 时间：2012-07-10T20:39:42.640
> 
> 标签：java, html, ajax, servlets, post

我正在尝试从发布的表单数据中获取复选框的值。我已经让表单工作了，因为我可以很容易地获取文件的值（我在下面的代码中省略了文件表单字段），但复选框不会返回 null 以外的任何内容。我究竟做错了什么？

小服务程序：

```
protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

    String str = request.getParameter("isTransform");

    System.out.println("parameter: " + str);
} 
```

html客户端：

```
<form enctype="multipart/form-data" id="compareForm1" >
    <input type="checkbox" value="true" name="isTransform" id="isTransform1" >
</form> 
```

我有 jquery.form.js 发送实际的帖子

```
var options = {
                url:          "http://localhost:8080/TestingTomcat/someClassName",
                type:         "POST",
                success:      function (html){
                    $("#placeholder").html(html);
                    change_active("comparison_page");
                }
        };

        $("#compareForm1").submit(function () {
            $(this).ajaxSubmit(options);

            return false;
        }); 
```

实际发布数据：

```
POSTDATA =-----------------------------153501500631101
Content-Disposition: form-data; name="isTransform"

true
-----------------------------153501500631101
Content-Disposition: form-data; name="isTransform"

true
-----------------------------153501500631101-- 
```

单击或未单击按钮得到的结果是：

```
parameter: null 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-10T20:56:00.923

无法从 getParameter 方法获取来自“multipart/form-data”表单的参数。您应该使用 3rd-party 库来处理多部分数据，以便自己解析 req.getInputStream() 的内容。我认为[Apache Commons fileUpload](http://commons.apache.org/fileupload/using.html)会帮助你。

# mysql - MySQL SELECT 对一组数字中的一个数字进行排名

> ID：11421581
> 
> 赞同：0
> 
> 时间：2012-07-10T20:39:53.917
> 
> 标签：mysql, select, case, rank

我有来自 SELECT 查询的数据行，其中包含一些价格（本例中为三个）。一个是我们的价格，一个是竞争对手 1 的价格，一个是竞争对手 2 的价格。我想添加一个列来显示我们的价格与其他两个价格相比的排名；如果我们的价格是最低的，它会吐出数字 1 如果最高，它会吐出它的数字。

像这样的东西：

```
Make |  Model  |  OurPrice | Comp1Price  | Comp2Price | Rank |  OutOf
MFG1    MODEL1     350         100           500         2        3
MFG1    MODEL2     50          100           100         1        3
MFG2    MODEL1     100         NULL          50          2        2
MFG2    MODEL2     9999        500           NULL        2        2 
```

- 有时竞争对手的价格会如上所示为 NULL，我相信这就是我的问题所在。我试过 a`CASE`并且它只在一个竞争对手上有效，但是当我添加一个`AND`声明时，它会吐出所有的排名`NULL`。有没有更好的方法通过 MySQL 查询来做到这一点？

```
SELECT
      MT.MAKE as Make,
      MT.MODEL as Model,
      MT.PRICE as OurPrice,
      CT1.PRICE as Comp1Price,
      CT2.PRICE as Comp2Price,
      CASE
         WHEN MT.PRICE < CT1.PRICE AND MT.PRICE < CT2.PRICE
         THEN 1 END AS Rank
      (CT1.PRICE IS NOT NULL) + (CT2.PRICE IS NOT NULL) + 1 as OutOf
  FROM mytable MT

LEFT JOIN competitor1table as CT1 ON CT1.MODEL = MT.MODEL
LEFT JOIN competitor2table as CT2 ON CT2.MODEL = MT.MODEL

ORDER BY CLASS 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T22:42:01.813

未测试，但您可以尝试：

```
SELECT
    a.MAKE AS Make,
    a.MODEL AS Model,
    a.PRICE AS OurPrice
    MAX(CASE WHEN a.compnum = 1 THEN pricelist END) AS Comp1Price,
    MAX(CASE WHEN a.compnum = 2 THEN pricelist END) AS Comp2Price,
    FIND_IN_SET(a.PRICE, GROUP_CONCAT(a.pricelist ORDER BY a.pricelist)) AS Rank,
    COUNT(a.pricelist) AS OutOf
FROM
(
    SELECT MAKE, MODEL, PRICE, PRICE AS pricelist, 0 AS compnum
    FROM mytable

    UNION ALL

    SELECT a.MAKE, a.MODEL, a.PRICE, CT1.PRICE, 1
    FROM mytable a
    LEFT JOIN competitor1table CT1 ON a.MODEL = CT1.MODEL

    UNION ALL

    SELECT a.MAKE, a.MODEL, a.PRICE, CT2.PRICE, 2
    FROM mytable a
    LEFT JOIN competitor2table CT2 ON a.MODEL = CT2.MODEL
) a
GROUP BY
    a.MAKE, a.MODEL 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T20:55:50.750

```
(CT1.PRICE IS NOT NULL AND CT1.PRICE < MT.PRICE) + (CT2.PRICE IS NOT NULL AND CT2.PRICE < MT.PRICE) + 1 as Rank 
```

# mdx - MDX 查询显示今年的销售额和去年的销售额

> ID：11421589
> 
> 赞同：0
> 
> 时间：2012-07-10T20:40:27.557
> 
> 标签：mdx

这是我的查询。我想显示今年第 12 周到第 24 周的数据以及去年第 12 周到第 24 周的数据。但即使我有“prevMember”，这两年的数据也一样。你可以帮帮我吗？

```
WITH MEMBER [Measures].[Net Sales This Year] AS ([Measures].[Ticket Net Sales],[Date].[Fiscal].[Fiscal Year].currentmember.prevmember)  

SELECT {[Measures].[Ticket Net Sales],[Measures].[Net Sales Last Year]} on 0,

NON EMPTY {([Concepts].[Concept Name].[Concept Name],[Locations].[Department Name].[Department Name],
            [Date].[Fiscal].[Fiscal Year].Members,[Date].[Week Of Year].&[12]:[Date].[Week Of Year].&[24])} on 1

FROM spbi 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T23:13:56.557

您可以使用该`PARALLELPERIOD()`功能来实现这一点。

请参阅[http://technet.microsoft.com/en-us/library/ms145500](http://technet.microsoft.com/en-us/library/ms145500)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T21:12:08.630

你可以试试这个查询：

```
WITH MEMBER [Measures].[Net Sales This Year] AS ([Measures].[Ticket Net Sales],[Date].[Fiscal].CurrentMember.PrevMember)  

SELECT {[Measures].[Ticket Net Sales],[Measures].[Net Sales Last Year]} ON 0,

NON EMPTY [Date].[Fiscal].[Fiscal Year].Members * [Date].[Week Of Year].&[12]:[Date].[Week Of Year].&[24]) ON 1

FROM spbi 
```

# javascript - 骨干路由查询字符串证明

> ID：11421596
> 
> 赞同：0
> 
> 时间：2012-07-10T20:41:04.747
> 
> 标签：javascript, backbone.js

我正在寻找在所有路线上忽略 queryString 的正确和更快的方法。

我发现这个[插件](https://github.com/jhudson8/backbone-query-parameters)工作正常；但是，我只需要忽略查询字符串，最好避免包含所有这些代码。

我试图做这样的事情：

```
var queryStrip = /(\?.*)$/,
myRouter =  Backbone.Router.extend({
        initialize: function(){
           this.on('all', function(){
           Backbone.history.fragment = Backbone.history.fragment.replace(queryStrip, '');
           })
        }
}); 
```

但是，这种方法行不通。似乎历史片段是只读的。

任何想法 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T05:17:00.337

您是否尝试过简单地使用“#”或“/”开始路由，您也可以尝试显式禁用推送状态（尽管默认情况下应该关闭）

我可以在 # 之前轻松访问查询字符串的所有主干应用程序，并且导航仍然可以正常工作

# c# - 在 VSPackage 中加载 XNA 内容（Texture2Ds）？

> ID：11421606
> 
> 赞同：0
> 
> 时间：2012-07-10T20:41:26.223
> 
> 标签：c#, xna, texture2d, vspackage

我正在尝试将 XNA 内容动态加载到 VSPackage 项目中。我们希望能够将 Texture2D 作为加载项绘制到 Visual Studio 内的图形设备控件。我们设法在表单内动态加载 XNA 内容（使用此代码：[http ://create.msdn.com/en-US/education/catalog/sample/winforms_series_2](http://create.msdn.com/en-US/education/catalog/sample/winforms_series_2)) 在一个单独的 Windows 窗体项目中，但现在我们的目标是使用基本相同的代码实现我们所拥有的插件。我们遇到的问题是我们用来在 XNA 内容中动态加载的代码似乎在 VSPackages 中不起作用。当 ContentBuilder 正在构建时，它会返回一条错误消息，指出无法找到我们正在加载的内容 (Texture2D) 的导入器。ContentBuilder 类适用于不同的项目类型，但似乎不适用于 VSPackage。有没有人熟悉在 VSPackage 中实现 XNA？您知道是否甚至可以在 VSPackage 中动态加载 Texture2D？如果没有，是否有任何替代方案？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T21:48:09.877

您可以使用 Texture2D.FromStream() 加载图像文件...

# asp.net - 模板字段中的下拉列表 - 更新失败（空值插入）

> ID：11421607
> 
> 赞同：1
> 
> 时间：2012-07-10T20:41:26.433
> 
> 标签：asp.net, data-binding, gridview, drop-down-menu, edititemtemplate

我有一个网格视图。在这个我有一个带有 DropDownList 的模板字段（在 EditItemTemplate 模式下的 DDL，在 ItemTemplate 模式下的标签）。当我点击详细信息视图行的编辑时，我可以从 DDL 中选择任何值（DDL 是从 sqldatasource 填充的），但是如果我尝试执行更新，它会失败，因为它认为我没有提供数据...

这是确切的错误（数据库拒绝 NULL 数据）：

> 无法将值 NULL 插入到列 'status'、表 'gyumolcs.dbo.orders' 中；列不允许空值。更新失败。该语句已终止。

这是gridview的代码：

```
<!-- language: c# -->
<asp:SqlDataSource ID="orderadminSqlDataSource" runat="server" 
    ConnectionString="<%$ ConnectionStrings:dotnetConnectionString %>" 
    SelectCommand="SELECT orders.ID, aspnet_Users.UserName, orders.quantity AS Quantity, product.name AS Product, status.name AS Status, orders.date AS Date FROM orders INNER JOIN product ON orders.ordertype = product.ID INNER JOIN status ON orders.status = status.ID INNER JOIN aspnet_Users ON orders.userid = aspnet_Users.UserId ORDER BY date" 
    DeleteCommand="DELETE FROM orders WHERE (ID = @ID)" 
    UpdateCommand="UPDATE orders SET status = @status WHERE (ID = @ID)">
    <DeleteParameters>
        <asp:Parameter Name="ID" />
    </DeleteParameters>
    <UpdateParameters>
        <asp:Parameter Name="status" />
        <asp:Parameter Name="ID" />
    </UpdateParameters>
</asp:SqlDataSource><asp:GridView ID="GridView1" runat="server" AutoGenerateColumns="False" 
        DataSourceID="orderadminSqlDataSource" DataKeyNames="ID" Width="608px" 
        AllowPaging="True" AllowSorting="True" PageSize="15">
        <Columns>
            <asp:CommandField ShowDeleteButton="True" ShowEditButton="True" />
            <asp:BoundField DataField="ID" HeaderText="ID" 
                SortExpression="ID" InsertVisible="False" ReadOnly="True" >
            <ItemStyle HorizontalAlign="Right" />
            </asp:BoundField>
            <asp:BoundField DataField="UserName" HeaderText="Felhasználónév" 
                SortExpression="UserName" >
            <HeaderStyle HorizontalAlign="Center" />
            <ItemStyle HorizontalAlign="Center" />
            </asp:BoundField>
            <asp:BoundField DataField="Quantity" HeaderText="Mennyiség (kg)" 
                SortExpression="Quantity" >
            <HeaderStyle HorizontalAlign="Center" />
            <ItemStyle HorizontalAlign="Center" />
            </asp:BoundField>
            <asp:BoundField DataField="Product" HeaderText="Termék" 
                SortExpression="Product" >
            <HeaderStyle HorizontalAlign="Center" />
            <ItemStyle HorizontalAlign="Center" />
            </asp:BoundField>
            <asp:TemplateField HeaderText="Rendelés státusz" SortExpression="status">
                <EditItemTemplate>
                    <!--<asp:TextBox ID="TextBox1" runat="server" Text='<%# Bind("Status") %>'></asp:TextBox>-->

                    <asp:DropDownList ID="DropDownList1" runat="server" 
                        DataSourceID="statustypeDDLSqlDataSource" DataTextField="name"
                        DataValueField="ID">
                    </asp:DropDownList>
                    <asp:SqlDataSource ID="statustypeDDLSqlDataSource" runat="server" 
                        ConnectionString="<%$ ConnectionStrings:dotnetConnectionString %>" 
                        SelectCommand="SELECT [ID], [name] FROM [status]">
                    </asp:SqlDataSource>

                </EditItemTemplate>
                <ItemTemplate>
                    <asp:Label ID="status" runat="server" Text='<%# Bind("Status") %>'></asp:Label>
                </ItemTemplate>
                <HeaderStyle HorizontalAlign="Center" />
                <ItemStyle HorizontalAlign="Center" />
            </asp:TemplateField>
            <asp:BoundField DataField="Date" HeaderText="Dátum" SortExpression="Date" />
        </Columns>
        <PagerSettings PageButtonCount="15" Mode="NumericFirstLast" />
    </asp:GridView> 
```

这是 orderadminSqlDataSource 的代码（gridview 的数据源）

```
<!-- language: c# -->
    <asp:SqlDataSource ID="orderadminSqlDataSource" runat="server" 
        ConnectionString="<%$ ConnectionStrings:dotnetConnectionString %>" 
        SelectCommand="SELECT orders.ID, aspnet_Users.UserName, orders.quantity AS Quantity, product.name AS Product, status.name AS Status, orders.date AS Date FROM orders INNER JOIN product ON orders.ordertype = product.ID INNER JOIN status ON orders.status = status.ID INNER JOIN aspnet_Users ON orders.userid = aspnet_Users.UserId ORDER BY date" 
        DeleteCommand="DELETE FROM orders WHERE (ID = @ID)" 
        UpdateCommand="UPDATE orders SET status = @status WHERE (ID = @ID)">
        <DeleteParameters>
            <asp:Parameter Name="ID" />
        </DeleteParameters>
        <UpdateParameters>
            <asp:Parameter Name="status" />
            <asp:Parameter Name="ID" />
        </UpdateParameters>
    </asp:SqlDataSource> 
```

请帮助我，我无法弄清楚问题所在。提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T20:56:17.833

我认为您忘记设置 DropDown 的`SelectedValue`属性：

```
<asp:DropDownList ID="DropDownList1"
                  runat="server" 
                  DataSourceID="statustypeDDLSqlDataSource"
                  DataTextField="name"
                  DataValueField="status"
                  SelectedValue='<%# Bind("status") %>'
                  AppendDataBoundItems="True" > 
```

更改您的代码`statustypeDDLSqlDataSource`：

```
<asp:SqlDataSource ID="statustypeDDLSqlDataSource" runat="server" 
                   ConnectionString="<%$ ConnectionStrings:dotnetConnectionString %>" 
                   SelectCommand="SELECT [ID] as status, [name] FROM [status]">
</asp:SqlDataSource> 
```

你也可以简化这个（不需要括号）：

```
UPDATE orders SET [status] = @status WHERE [ID] = @ID 
```

注意：我必须重命名查询中的 ID 列，使其符合`status`您在此处定义的参数：

```
<UpdateParameters>
    <asp:Parameter Name="status" />
    <asp:Parameter Name="ID" />
</UpdateParameters> 
```

**我在这里的最后一次编辑和尝试：D**

仔细查看您的 GridView 的`SELECT`声明后，我看到了错误所在：

```
SELECT orders.ID,
       aspnet_Users.UserName,
       orders.quantity AS Quantity,
       product.name AS Product,
       status.name AS Status,
       orders.date AS Date
FROM orders
INNER JOIN product ON
orders.ordertype = product.ID
INNER JOIN status ON orders.status = status.ID
INNER JOIN aspnet_Users ON orders.userid = aspnet_Users.UserId
ORDER BY date 
```

将其更改为：

```
SELECT orders.ID,
       aspnet_Users.UserName,
       orders.quantity AS Quantity,
       product.name AS Product,
       status.ID AS status,
       status.name AS StatusName,
       orders.date AS Date
FROM orders
INNER JOIN product ON
orders.ordertype = product.ID
INNER JOIN status ON orders.status = status.ID
INNER JOIN aspnet_Users ON orders.userid = aspnet_Users.UserId
ORDER BY date 
```

现在您也必须更改这部分：

```
<ItemTemplate>
<asp:Label ID="status" runat="server" Text='<%# Bind("StatusName") %>'></asp:Label>
</ItemTemplate> 
```

* * *

顺便说一句......这是关于这个问题的一个很好的分步教程：

[演练：在 GridView Web 服务器控件中进行编辑时显示下拉列表](http://msdn.microsoft.com/en-us/library/ms178294%28v=vs.100%29.aspx)

# ios - 如何让 iOS 应用程序与数据库服务器通信？

> ID：11421611
> 
> 赞同：0
> 
> 时间：2012-07-10T20:41:56.183
> 
> 标签：ios, web-services, asmx, asp.net-web-api

我在数据库服务器上有一个数据库。没有可供 Web 应用程序使用的 Web 服务。

如果我希望我的 iOS 应用程序与数据库服务器通信（发送和接收数据），我知道我可以创建一个 Web 服务，然后从我的 iOS 应用程序调用该服务。但是为此推荐什么网络服务？我应该只在 .NET 中编写一个 .asmx Web 服务，还是应该使用 MVC WEB API 或者可能使用 WCF？我花了几个小时对此进行研究。请帮忙。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-10T21:03:10.587

很大程度上取决于您希望将服务托管在哪里，以及主机支持哪些技术堆栈。如果您是自托管的，那么在您了解和理解的技术中做任何有效的事情。如果您想使用针对中小型独立开发团队提供服务的主机，Heroku 等许多提供商都支持 Rails 服务等服务。PHP 也始终是一种选择。基于 Microsoft 的解决方案和基于 Java 的解决方案往往更广泛地用于大型企业和数据中心，如果您将在那里托管您的服务，那么这些也是不错的选择。当然，我在这里泛泛而谈：对于我可能在此处列出的任何一般趋势，都有很多例外，其他方法也有意义。

如果您宁愿让决定由使您的 iOS 代码最简单的事情来驱动，我建议您从支持 REST-ful 接口的服务器端技术开始，使用 JSON 来表示您的服务资源。REST-ful 服务很容易在 iOS 中使用，基于 JSON 的资源表示很容易在 Objective-C 中解析和生成。

我个人使用这种方法为我的应用程序设定方向。对于服务端，我将使用 REST-ful Web 服务的 Rails 实现。我是一名专业的 Java 开发人员，但对于一个小型独立项目，托管 Java 服务的选项比使用 Rails 更受限制，所以我选择了 Rails 来让我的项目工作。到目前为止，它非常适合我的项目。

# r - 黑白文档的代码样式

> ID：11421614
> 
> 赞同：14
> 
> 时间：2012-07-10T20:42:22.047
> 
> 标签：r, latex, knitr

knitr 的优点之一是您可以轻松更改 R 代码的颜色。但是，大多数文档都是黑白打印的。那么在使用黑白打印机打印文档时，R 代码的样式设置会是一个很好的设置吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-18T13:49:46.570

正如其他评论者所提到的，你真的只能选择改变一些灰色阴影，加上粗体和斜体。这是一个样式表，按最显眼到最不显眼的项目的松散顺序排列。您的偏好可能会有所不同。

```
.background {
  color: #ffffff;
}
.source, .output, .warning, .error, .message {
  padding: 0em 1em;
  border: solid 1px #f7f7f7;
}
.error, .warning, .message {
  font-weight: bolder;
  font-style: italic;
  color: #000000;
}
.keyword {
  font-weight: bolder;
  color: #000000;
}
.functioncall, .package {
  font-weight: bolder;
  color: #202020;
}
.source, .output, .number, .argument, .formalargs, .eqformalargs, .assignement, .symbol, .prompt {
  color: #404040;
}
.string {
  font-weight: bold;
  color: #606060;
}
.comment, .roxygencomment, .slot {
  font-style: italic;
  color: #808080;
} 
```

使其可用的最简单方法是在 knitr 包所在的任何库中另存为“knitr/themes/bw.css”。然后您可以通过调用来使用它

```
knit_theme$set("bw") 
```

（或者，对于少量的额外输入，您可以提供`knit_theme`CSS 文件的路径。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-06-20T10:59:21.373

knitr 中现在有灰度主题`greyscale0`：`greyscale1`和`greyscale2`. 您可以通过以下方式查看所有 knitr 主题：

```
library("knitr")
knit_theme$get() 
```

要在 knitr 文档中设置主题，请添加（例如）行

```
knit_theme$set("greyscale2") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-15T20:07:10.013

坦率地说，我没有出售任何用于黑白印刷的针织主题，它们都不如旧款*`enscript -E<lang>`*

以下是我认为对黑白打印输出的易读性很重要的标准，斜体和粗体以及着色：

```
#Comments should be italicized - very important
fn.name.declarations.should.be.heavily.bolded <- function(...) {
"strings should be bolded"
numbers, NA, Nan should be a different color (prints as something dark gray)
Your choice of how to treat variable names
Your choice of how to treat fncalls, builtins 
```

您没有说它特别需要是LaTex，那为什么不考虑输出PS或PDF格式呢？

# unix - pkginfo 命令的格式化输出

> ID：11421619
> 
> 赞同：0
> 
> 时间：2012-07-10T20:42:38.923
> 
> 标签：unix, solaris

要获取安装在我们的 Solaris 10 服务器上的软件版本列表，我可以使用命令`pkginfo -l`. 但是，它返回不同行的属性，如下所示：

```
 PKGINST:  bteq1310
      NAME:  Teradata BTEQ Utility
  CATEGORY:  application
      ARCH:  Solaris9/SPARC
   VERSION:  13.10.00.04
   BASEDIR:  /opt
    VENDOR:  Teradata Corporation
    PSTAMP:  esssol00920110210172759
  INSTDATE:  Jul 01 2012 21:23
    STATUS:  completely installed
     FILES:       10 installed pathnames
                   6 shared pathnames
                   6 directories
                   4 executables
                1403 blocks used (approx) 
```

是否有类似的命令`pkginfo`将在列中而不是在单独的行中返回相同的信息？我真的只对 PKGINST、NAME、VERSION、INSTDATE 和 STATUS 值感兴趣。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T12:37:31.183

这个 awk 脚本似乎可以工作：

```
BEGIN { FS=":  "; }
/PKGINST/ { pkg = $2; p[$2] = $2; } 
/NAME/ { n[pkg] = $2; } 
/VERSION/ { v[pkg] = $2; } 
/INSTDATE/ { i[pkg] = $2; } 
/STATUS/ { s[pkg] = $2; } 
END { for (m in p) printf ("%s\t%s\t%s\t%s\t%s\n", m, n[m], v[m], i[m], s[m]) } 
```

# domain-driven-design - 使用工厂模式对类似订阅进行建模

> ID：11421625
> 
> 赞同：0
> 
> 时间：2012-07-10T20:42:59.747
> 
> 标签：domain-driven-design, factory-pattern

我有以下问题一直困扰着我很长一段时间。我想为以下域实体“联系人”建模：

```
public class Contact:IEntity<Contact>
{
    private readonly ContactId _Id;
    public ContactId Id
    {
        get { return this._Id; }
    }

    private CoreAddress _CoreAddress;
    public CoreAddress CoreAddress
    {
        get { return this._CoreAddress; }
        set
        {
            if (value == null)
                throw new ArgumentNullException("CoreAddress");
            this._CoreAddress = value;
        }
    }

    private ExtendedAddress _ExtendedAddress;
    public ExtendedAddress ExtendedAddress
    {
        get { return this._ExtendedAddress; }
        set
        {
            if (value == null)
                throw new ArgumentNullException("ExtendedAddress");
            this._ExtendedAddress = value;
        }
    }

    private readonly IList<ContactExchangeSubscription> _Subscriptions
        = new List<ContactExchangeSubscription>();

    public IEnumerable<ContactExchangeSubscription> Subscriptions
    {
        get { return this._Subscriptions; }
    }

    public Contact(ContactId Id, CoreAddress CoreAddress, ExtendedAddress ExtendedAddress)
    {
        Validations.Validate.NotNull(Id);
        this._Id = Id;
        this._CoreAddress = CoreAddress;
        this._ExtendedAddress = ExtendedAddress;
    }
  } 
```

如您所见，它有一系列订阅。订阅的建模如下：

```
 public class ContactExchangeSubscription
{
    private ContactId _AssignedContact;
    public ContactId AssignedContact
    {
        get { return this._AssignedContact; }
        set
        {
            if (value == null)
                throw new ArgumentNullException("AssignedContact");
            this._AssignedContact = value;
        }
    }

    private User _User;
    public User User
    {
        get { return this._User; }
        set
        {
            Validations.Validate.NotNull(value, "User");
            this._User = value;
        }
    }

    private ExchangeEntryId _EntryId;
    public ExchangeEntryId EntryId
    {
        get { return this._EntryId; }
        set
        {
            if (value == null)
                throw new ArgumentNullException("EntryId");
            this._EntryId = value;
        }
    }

    public ContactExchangeSubscription(ContactId AssignedContact, User User, ExchangeEntryId EntryId)
    {
        this._AssignedContact = AssignedContact;
        this._User = User;
        this._EntryId = EntryId;
    }

} 
```

现在我一直在想，我不应该在我的领域中为存储技术 (Exchange) 建模，毕竟，我们可能希望将我们的应用程序切换到其他订阅提供商。属性“EntryId”特定于 Exchange。不过，订阅总是需要一个 User 和一个 ContactId。有没有更好的方法来为订阅建模？如果需要，我应该为 Subscription 类型使用工厂还是抽象工厂来涵盖其他类型的订阅？

编辑：所以让我们在环中折腾一个抽象工厂并引入一些接口：

```
public interface IContactSubscriptionFactory
{
    IContactSubscription Create();
}

public interface IContactSubscription
{
    ContactId AssignedContact { get;}
    User User { get; }
} 
```

ContactExchangeSubscription 的具体工厂如何编码？请记住，此类型将需要 EntryID 字段，因此它必须获取一个额外的 ctr 参数。一般如何处理工厂中不同子类型的不同构造函数参数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T06:13:01.400

我认为答案就在你眼前，因为你需要努力在未来`interface`更容易引入新的*订阅提供商*（如果这是正确的术语）。我认为这更像是 DDD 的一个 OO 设计问题。

```
public interface ISubscriptionProvider
{
    ContactId AssignedContact { get; }
    User User { get; }
} 
```

你合同中的代码变成了

```
private readonly IList<ISubscriptionProvider> _subscriptions
    = new List<ISubscriptionProvider>();

public IEnumerable<ISubscriptionProvider> Subscriptions
{
    get { return _subscriptions; }
} 
```

关于使用*工厂*；工厂的目的是在需要创建策略时构造域对象。例如，当您重新水化聚合时，可以在您的存储库中使用 SubscriptionProviderFactory，并根据传入的数据决定返回 ContactExchangeSubscription（作为 ISubscriptionProvider）或其他内容。

最后一点，但也许这只是因为您展示示例的方式。但我想说你没有真正遵循 DDD，缺乏行为以及你所有的属性都有公共 getter 和 setter，这表明你掉进了构建[Aemic Domain Model](http://martinfowler.com/bliki/AnemicDomainModel.html)的陷阱。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T18:57:51.290

经过一番研究，我想出了这个。先上代码，解释如下：

```
public interface IContactFactory<TSubscription> where TSubscription : IContactSubscription
{
    Contact Create(ContactId Id, CoreAddress CoreAddress, ExtendedAddress ExtendedAddress, TSubscription Subscription);
}

public class ContactFromExchangeFactory : IContactFactory<ContactExchangeSubscription>
{
    public Contact Create(ContactId Id, CoreAddress CoreAddress, ExtendedAddress ExtendedAddress, ContactExchangeSubscription ExchangeSubscription)
    {
        Contact c = new Contact(Id, CoreAddress, ExtendedAddress);
        c.AddSubscription(ExchangeSubscription);
        return c;
    }
} 
```

我意识到我不需要联系人订阅的工厂，而是联系人本身。

一路上我学到了一些关于工厂的事情：

*   它们仅在创建（真正）新实体时使用，而不是在从 SQL DB 重建它们时使用
*   他们生活在领域层（见上文！）
*   工厂更适合行为不同的相似对象而不是数据

我欢迎评论和更好的答案。

# c++ - 如何像在python中一样将字符的'n'个副本写入ostream

> ID：11421632
> 
> 赞同：13
> 
> 时间：2012-07-10T20:43:12.657
> 
> 标签：c++, ostream

在 python 中，以下指令：`print 'a'*5`将输出`aaaaa`. `std::ostream`为了避免`for`构造，如何在 C++ 中结合 s 编写类似的东西？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-07-10T20:48:24.583

显而易见的方法是`fill_n`：

```
std::fill_n(std::ostream_iterator<char>(std::cout), 5, 'a'); 
```

另一种可能性是只构造一个字符串：

```
std::cout << std::string(5, 'a'); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-10T20:50:52.777

使用一些棘手的方法： `os << setw(n) << setfill(c) << "";` 其中 n 是要写入的字符 c 的数量

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2020-12-16T16:06:44.143

在 C++20 中，您将能够使用它[`std::format`](https://en.cppreference.com/w/cpp/utility/format)来执行此操作：

```
std::cout << std::format("{:a<5}", ""); 
```

输出：

```
aaaaa 
```

同时你可以使用[基于的 {fmt}](https://github.com/fmtlib/fmt)库`std::format`。{fmt} 还提供了`print`使这更容易和更高效的功能（[godbolt](https://godbolt.org/z/c4eneT)）：

```
fmt::print("{:a<5}", ""); 
```

**免责声明**：我是 {fmt} 和 C++20 的作者`std::format`。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-10T20:50:19.350

您可以通过重载`*`std::string 的运算符来执行类似的操作。这是一个小例子

```
#include<iostream>
#include<string>
std::string operator*(const std::string &c,int n)
{
    std::string str;
    for(int i=0;i<n;i++)
    str+=c;
    return str;
}
int main()
{
    std::string str= "foo";
    std::cout<< str*5 <<"\n";
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-06-19T08:20:16.607

该标准没有提供任何优雅的方式。但是一种可能性（我最喜欢的）是使用这样的代理对象

```
class repeat_char
{
public:
    repeat_char(char c, size_t count) : c(c), count(count) {}
    friend std::ostream & operator<<(std::ostream & os, repeat_char repeat)
    {
        while (repeat.count-- > 0)
            os << repeat.c;
        return os;
    }
private:
    char c;
    size_t count;
}; 
```

然后以这种方式使用它

```
std::cout << repeat_char(' ', 5); 
```

# asp.net - 与 .Net 4.0 的共享点

> ID：11421634
> 
> 赞同：0
> 
> 时间：2012-07-10T20:43:22.310
> 
> 标签：asp.net, sharepoint, .net-4.0, .net-2.0, .net-framework-version

我们有一个基于 .NET 2.0 的 ASP.NET 站点。它具有共享点集成，并且在站点迁移到 .NET 4.0 之前一切正常。我知道 sharepoint 是建立在 3.5 框架上的，因此它现在失败了。是否有任何变通方法或任何最新发展可以使 sharepoint 在 ASP.NET 4.0 站点上工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T22:20:56.470

我和我的 string.IsNullOrWhitespace / 喜欢自我的命名参数希望这是可能的，但它肯定是不可能的。最接近的是，如果您要使用 SOA，并且（显然）您的服务可以用 .NET 4.0（或任何语言）编写，但是您的 Web 部件、工作流、功能接收器、模块等都被困在旧版 3.5。

此外，作为 Office 365 一部分的 SharePoint (SharePoint Online) 的“下一个”版本只是具有云兼容性的 SharePoint 2010……而且仍然没有 .NET 4.0。

# eclipse-plugin - MyEclipse 的 Eclipse Marketplace 插件？

> ID：11421640
> 
> 赞同：0
> 
> 时间：2012-07-10T20:43:51.087
> 
> 标签：eclipse-plugin, myeclipse, cloud-foundry, eclipse-marketplace

我正在尝试使用此处的说明安装 Cloud Foundry 插件：http: [//docs.cloudfoundry.com/tools/STS/configuring-STS.html](http://docs.cloudfoundry.com/tools/STS/configuring-STS.html)

问题是我的 MyEclipse 10.0 不适用于 Eclipse Marketplace。有没有办法从 Eclipse Marketplace 获取插件并将它们安装到 MyEclipse？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-10T21:38:00.020

它有普通的 P2 安装管理器吗？如果是这样，您可以通过这种方式安装 Marketplace 客户端。在正常的 Eclipse 安装中，即*Help -> Install new software*。在以下对话框中，在组合框中选择*Indigo*更新站点，或者如果没有，请自行添加[http://download.eclipse.org/releases/indigo 。](http://download.eclipse.org/releases/indigo)

当 Eclipse 检查更新站点时，您将看到可供安装的组件列表。您应该在“通用工具”下找到 Marketplace 客户端。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T17:28:12.620

首先，我要感谢 Bananeweizen 提供上述答案的核心部分。基本上，由于 MyEclipse 10.5 和更早版本没有预装 Eclipse Marketplace Client，第一步是从以下位置安装客户端：Help > MyEclipse Configuration Center... > Software 选项卡并单击“+”图标添加它到 MyEclipse 配置...（如果您访问我们的博客，我们会在其中向您展示图片：[http](http://www.genuitec.com/blog/?p=4461) ://www.genuitec.com/blog/?p=4461 ）

接下来，按照向导的指示，让 MyEclipse 在安装后重新启动。重新启动后，您可以按预期从 Help > Eclipse Marketplace... 添加项目。

现在，您可以从 Eclipse Marketplace Client 添加任何您想要的软件，例如您询问的 Cloud Foundry 插件。

安装并重新启动后，您可以通过使用 Help > Open Perspective... 打开 WTP Java Extras 透视图并选择“显示全部”复选框来添加您的云服务器...

然后要添加您的云服务器，您可以在 WTP 服务器视图中右键单击并选择“新建 > 服务器”

并选择 VMWare > Cloud Foundry 并按照向导中的步骤操作。就是这样。

最后，既然你不得不问这个问题，很明显我们可以稍微改进一下这个过程，我们会的。为了让如何从 Eclipse Marketplace 获取插件更加明显，我们将把 Eclipse Marketplace Client 添加到 MyEclipse 10.6 的默认配置中。我认为这对我们所有的用户来说都是一个很好的增强。感谢您对 MyEclipse 的支持！

# php - 检查用户是否使用 CakePHP 登录

> ID：11421645
> 
> 赞同：4
> 
> 时间：2012-07-10T20:44:06.910
> 
> 标签：php, cakephp

我想根据用户是否登录向他们显示不同的导航栏。我已经处理了注册和登录阶段，但无法检查用户是否已登录并显示正确的导航栏。

这就是我所拥有的`AppController.php`：

```
public $components = array('Session', 'Auth' => array(
    'loginRedirect' => array('controller' => 'users', 'action' => 'account'),
    'logoutRedirect' => array('controller' => 'pages', 'action' => 'home')
));

public $loggedIn = false;

public function beforeFilter() {
    $this->Auth->allow('home', 'register', 'login');
    if ($this->Auth->user('id')) {
        $this->set('loggedIn', true);
    }
} 
```

然后在我的布局中（不是视图）：

```
<?php if ($loggedIn): ?>
    logged in
<?php else: ?>
    <li class="right"><a href="/register">Register</a></li>
    <li class="right"><a href="/login">Login</a></li>
<?php endif; ?> 
```

然而，`$loggedIn`总是假的。如果`$this->set('loggedIn', $this->loggedIn);`从我的个人控制器中执行它可以正常工作，但是为了保持我的代码干燥，我只希望它在我的所有其他控制器从 ( `AppController`) 继承的控制器中。

有没有一种我想念的简单方法来做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-10T21:06:34.797

尝试使用：

```
if ($this->Auth->loggedIn()) { 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-05-31T00:35:53.403

我知道这已经得到了回答，但无论如何我都会发布我的发现..

我解决此问题并使 $loggedIn 全局可用的方法是将其添加到 beforeFilter() 中的 AppController.php 文件中

```
public function beforeFilter() {
    $this->set('loggedIn', $this->Auth->loggedIn());
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-01-19T14:05:57.847

对于cakephp3

控制器范围：

```
public function beforeFilter(Event $event) {
    $this->set('login_status', $this->Auth->user('id'));
} 
```

在模板中，您可以检查会话对象

```
$user = $this->request->session()->read('Auth.User'); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-17T16:56:37.210

只需将此代码放在 login() 操作之后：

```
if($this->Auth->loggedIn()){
        $this->redirect(array('action' => 'index'));
    } 
```

# json - WCF 数据服务 5.0 返回 POCO 的解决方法？

> ID：11421648
> 
> 赞同：2
> 
> 时间：2012-07-10T20:44:17.153
> 
> 标签：json, wcf, wcf-data-services

我很确定它没有，但如果这个问题已经被问过，我很抱歉。如果这只是一个愚蠢的问题，另外道歉，但我觉得我要么完全错过了一些东西，要么有正确的想法，只需要一些备份来保持我自己的理智。

我一直在我们的应用程序中实现 WCF 数据服务 5.0，并且读取操作返回实体对象没有问题。

不幸的是，在服务操作方面存在令人讨厌的限制，即它们只能返回原始类型（[请参阅 MSDN](http://msdn.microsoft.com/en-us/library/cc668788%28v=vs.103%29.aspx)）。考虑到实体对象没有问题，这很烦人。

我知道一种解决方法是创建一个“虚拟”复杂类型，因为 WCFDS 会识别这一点，但我不想只是将随机 POCO 扔到我的数据模型中，而这些数据模型实际上并不在数据库中。

所以我想到的解决方案是为我的对象创建一个扩展方法，该方法可以将它们序列化为 JSON 字符串以由服务返回。**我的问题是；**是否有任何令人信服的论点为什么我不应该这样做，或者任何人都可以提出更好的选择？

* * *

**编辑：**澄清我当前问题的附加信息

我创建了一个非常简单的示例，说明我正在做的事情最初提出了这个问题。我的服务类首先如下：

```
[JsonpSupportBehavior]
public partial class SchedulingService : DataService<ChronosDataContext>, ISchedulingService
{
    public static void InitializeService(DataServiceConfiguration config)
    {
        #if DEBUG
        config.UseVerboseErrors = true;
        #endif

        config.DataServiceBehavior.MaxProtocolVersion = DataServiceProtocolVersion.V3;

        config.SetServiceOperationAccessRule(
        "TestService",
        ServiceOperationRights.All);
    }

    [WebGet]
    public SchedulingResult TestService(
         string testParam1,
         string testParam2)
    {
         // NOTE: I never use the params, they're just there for this example.
         SchedulingResult result = SchedulingResult.Empty;

         result.Status = OperationStatus.Success;
         result.ResponseID = Guid.NewGuid();
         result.AffectedIDs = new List<int>(new int[] { 1, 2, 3, 4, 5, 6, 7 });
         result.RecordsAffected = 10;

         return result;
    }
} 
```

尝试使用我的浏览器访问此服务，我收到以下请求错误：

```
The server encountered an error processing the request. The exception message is 
'Unable to load metadata for return type 
    'Chronos.Services.SchedulingResult' of method 
    'Chronos.Services.SchedulingResult TestService(System.String, System.String)'.'. 
See server logs for more details. 

The exception stack trace is:
at System.Data.Services.Providers.BaseServiceProvider.AddServiceOperation(MethodInfo method, String protocolMethod) 
at System.Data.Services.Providers.BaseServiceProvider.AddOperationsFromType(Type type) 
at System.Data.Services.Providers.BaseServiceProvider.LoadMetadata() 
at System.Data.Services.DataService`1.CreateMetadataAndQueryProviders(IDataServiceMetadataProvider& metadataProviderInstance, IDataServiceQueryProvider& queryProviderInstance, BaseServiceProvider& builtInProvider, Object& dataSourceInstance) 
at System.Data.Services.DataService`1.CreateProvider() 
at System.Data.Services.DataService`1.HandleRequest() 
at System.Data.Services.DataService`1.ProcessRequestForMessage(Stream messageBody) 
at SyncInvokeProcessRequestForMessage(Object , Object[] , Object[] ) 
at System.ServiceModel.Dispatcher.SyncMethodInvoker.Invoke(Object instance, Object[] inputs, Object[]& outputs) 
at System.ServiceModel.Dispatcher.DispatchOperationRuntime.InvokeBegin(MessageRpc& rpc) 
at System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage5(MessageRpc& rpc) 
at System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage41(MessageRpc& rpc) 
at System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage4(MessageRpc& rpc) 
at System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage31(MessageRpc& rpc) 
at System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage3(MessageRpc& rpc) 
at System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage2(MessageRpc& rpc) 
at System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage11(MessageRpc& rpc) 
at System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage1(MessageRpc& rpc) 
at System.ServiceModel.Dispatcher.MessageRpc.Process(Boolean isOperationContextSet) 
```

以下是构成我试图返回的 SchedulingResult 的类：

```
public class SchedulingResult : ServiceInvocationResponse
{
    public SchedulingResult()
        : base()
    {
        this.Payload = new object[] 
        {
            new List<int>(),
            new List<int>()
        };
    }

    public List<int> AffectedIDs 
    {
        get { return (List<int>)Payload[0]; }
        set { Payload[0] = value; }
    }

    public List<int> FailedIDs
    {
        get { return (List<int>)Payload[1]; }
        set { Payload[1] = value; }
    }

    public static SchedulingResult Empty
    {
        get { return new SchedulingResult(); }
    }
}

public class ServiceInvocationResponse : AbstractJsonObject<ServiceInvocationResponse>
{
    public ServiceInvocationResponse()
    {
        this.Status = OperationStatus.Unknown;
        this.Severity = ErrorSeverity.None;
    }

    public virtual int RecordsAffected { get; set; }

    public virtual Exception ErrorObject { get; set; }

    internal virtual object[] Payload { get; set; }
}

public abstract class AbstractJsonObject<TBaseType>
{
    public virtual object Deserialize(string source)
    {
        return JsonConvert.DeserializeObject(source);
    }

    public virtual T Deserialize<T>(string source)
    {
        return JsonConvert.DeserializeObject<T>(source);
    }

    public string Serialize()
    {
        return JsonConvert.SerializeObject(
            this, Formatting.Indented);
    }

    public override string ToString()
    {
        return this.Serialize();
    }

    public static TBaseType FromString(string json)
    {
        return JsonConvert.DeserializeObject<TBaseType>(json);
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T17:56:03.550

可以从服务操作返回一种或多种原始、复杂或实体类型。

*   原始类型是您所期望的：string、int、bool 等。
*   复杂类型是没有唯一键的类（命名`ID`的属性或`[DataServiceKey("<yourkeyhere>")]`属性）
*   实体类型是具有唯一键的类

例如：

```
using System.Data.Services;
using System.Data.Services.Common;
using System.Linq;
using System.ServiceModel;
using System.ServiceModel.Web;

namespace Scratch.Web
{
    [ServiceBehavior(IncludeExceptionDetailInFaults = true)]
    public class ScratchService : DataService<ScratchContext>
    {
        public static void InitializeService(DataServiceConfiguration config)
        {
            config.SetEntitySetAccessRule("*", EntitySetRights.All);
            config.SetServiceOperationAccessRule("*", ServiceOperationRights.AllRead);
            config.DataServiceBehavior.MaxProtocolVersion = DataServiceProtocolVersion.V3;
            config.UseVerboseErrors = true;
        }

        [WebGet]
        public string GetPrimitive()
        {
            return "Success";
        }

        [WebGet]
        public IQueryable<string> GetPrimitives()
        {
            return new[] { "Success", "Hello World" }.AsQueryable();
        }

        [WebGet]
        public ComplexType GetComplexType()
        {
            return new ComplexType { Property1 = "Success", Property2 = "Hello World" };
        }

        [WebGet]
        public IQueryable<ComplexType> GetComplexTypes()
        {
            return new[] {
                           new ComplexType { Property1 = "Success", Property2 = "Hello World" },
                           new ComplexType { Property1 = "Success", Property2 = "Hello World" }
                       }.AsQueryable();
        }

        [WebGet]
        public EntityType GetEntityType()
        {
            return new EntityType { Property1 = "Success", Property2 = "Hello World" };
        }

        [WebGet]
        public IQueryable<EntityType> GetEntityTypes()
        {
            return new[] {
                           new EntityType { Property1 = "Success1", Property2 = "Hello World" },
                           new EntityType { Property1 = "Success2", Property2 = "Hello World" }
                       }.AsQueryable();
        }
    }

    public class ScratchContext { }

    public class ComplexType
    {
        public string Property1 { get; set; }
        public string Property2 { get; set; }
    }

    [DataServiceKey("Property1")]
    public class EntityType
    {
        public string Property1 { get; set; }
        public string Property2 { get; set; }
    }
} 
```

也许您遇到了其他问题？

# xml - 恢复 Visual Studio 损坏的“所有空”XML 文件？

> ID：11421650
> 
> 赞同：2
> 
> 时间：2012-07-10T20:44:29.517
> 
> 标签：xml, corruption

当 Windows 由于已知问题而意外崩溃时，我正在使用 Visual Studio 处理 XML 文件。

现在，当我打开文件时，6KB 的 XML 代码已被 6KB 的空字符替换。我用来打开它的所有东西（包括文件恢复程序）似乎都认为它是一个完全有效的文件，只是充满了空值。Scandisk 什么都不做。

我在想，如果没有备份，我几乎是一条小河，但我想在我花几个小时重写这件事之前，我会看看是否有人对此有所了解（我的 Google-fu 让我失望了）。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-31T23:07:53.910

我刚刚遇到了同样的问题，一直等到一天结束才提交我的代码，突然间，我的文件被所有 NULL 字符替换了。我感觉其他一些取证文件恢复包也会有同样的效果，但我使用了 Encase，文件很容易找到并恢复..

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-05-25T04:27:14.957

在这里查看我的答案： [https ://stackoverflow.com/questions/16344290/lost-the-content-of-aspx-page-on-computer-restart-before-saving-the-file/16740939#16740939](https://stackoverflow.com/questions/16344290/lost-the-content-of-aspx-page-on-computer-restart-before-saving-the-file/16740939#16740939)

下次你会得救的......：D

# python - 控制python线程的调度优先级？

> ID：11421651
> 
> 赞同：32
> 
> 时间：2012-07-10T20:44:32.163
> 
> 标签：python, multithreading, threadpool, scheduling, nice

我编写了一个脚本，它使用两个线程池（每个线程池有十个线程）从 API 中提取数据。线程池[在 ActiveState 上实现此代码](http://code.activestate.com/recipes/577187-python-thread-pool/)。每个线程池都通过[PubSub](http://redis-py.readthedocs.org/en/latest/index.html#redis.StrictRedis.pubsub)监视 Redis 数据库中的新条目。当一个新条目发布时，python 将数据传递给一个函数，该函数使用 python 的[Subprocess.POpen](http://docs.python.org/library/subprocess.html#popen-constructor)来执行 PHP shell 来执行调用 API 的实际工作。

这个启动 PHP shell 的系统对于我的 PHP Web 应用程序的功能是必要的，因此无法避免使用 Python 启动 PHP shell。

此脚本将仅在 Linux 服务器上运行。

~~如何控制应用程序线程的[好坏](http://en.wikipedia.org/wiki/Nice_(Unix))（调度优先级）？~~

*编辑：*

在 Python 中控制单个线程的调度优先级似乎是不可能的。是否有 python 解决方案，或者至少可以与我的脚本一起运行的 UNIX 命令来控制优先级？

*编辑2：*

好吧，我最终没有找到处理它的 python 方法。我现在就像这样运行我的脚本：

```
nice -n 19 python MyScript.py 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-07-10T21:18:02.370

我相信线程优先级在 python 中是不可控制的，因为它们是如何使用全局解释器锁 (GIL) 实现的。话虽如此，即使您可以给一个线程更多的 CPU 处理优先级，传递 GIL 的 python 实现在传递 GIL 时也不会意识到这一点。如果您能够提高池中单个线程的友好度（比如说它正在做一项更重要的工作），您将需要使用自己的锁实现来更频繁地让更高优先级的线程访问 GIL。

谷歌搜索返回这篇文章，我相信这与你所问的相似

解释为什么它不起作用 [http://www.velocityreviews.com/forums/t329441-threading-priority.html](http://www.velocityreviews.com/forums/t329441-threading-priority.html)

解释了我建议的解决方法 [http://bytes.com/topic/python/answers/645966-setting-thread-priorities](http://bytes.com/topic/python/answers/645966-setting-thread-priorities)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2018-08-22T16:40:10.530

它不起作用，但我尝试了：

1.  获取父 pid 和优先级
2.  使用 concurrent.futures.ThreadPoolExecutor 启动线程
3.  使用 ctypes 从线程中获取 (linux) 线程 id(works)
4.  将 tid 与 os.setpriority(os.PRIO_PROCESS,tid,parent_priority+1) 一起使用
5.  从父级调用 pool.shutdown() 。

即使使用 os.sched_yield() 的自由洒，子线程实际上也不会超过 setpriority()。

阅读手册页，似乎线程没有能力改变（甚至他们的）调度优先级；您必须使用“功能”来为线程提供“CAP_SYS_NICE”功能。以 root 权限运行该进程也无济于事。子线程仍然没有运行。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2018-08-23T15:22:40.387

python [threading-docs](https://docs.python.org/3/library/threading.html)明确提到不支持设置线程优先级：

> 该模块的设计松散地基于 Java 的线程模型。然而，Java 使锁和条件变量成为每个对象的基本行为，它们在 Python 中是独立的对象。Python 的 Thread 类支持 Java 的 Thread 类行为的一个子集；**目前，没有优先级**，没有线程组，线程不能被销毁、停止、暂停、恢复或中断。Java Thread 类的静态方法在实现时被映射到模块级函数。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-06-20T12:13:46.087

我知道，已经过去了很多时间，但是我最近遇到了这个问题，我认为添加另一个选项会很有用。

看一下[threading2](https://github.com/rfk/threading2)，它是默认*线程模块***的**替代和扩展，支持 - 有点 - **优先级**和亲和性。

 **** * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-08T22:59:45.063

我想知道[另一个相关问题的答案](https://stackoverflow.com/a/2470061 "在子进程上使用 preexec_fn")在这种情况下是否有用？（[链接](https://stackoverflow.com/a/2470061 "在子进程上使用 preexec_fn")）

由于您已经在使用[Subprocess.POpen](https://docs.python.org/3/library/subprocess.html#popen-constructor "Subprocess.POpen 构造函数")来启动您的 PHP 脚本，让我感到震惊的是，您可以使用“preexec_fn”和预定义函数或 lambda 函数*（如上面链接的答案所示）*来设置每个的好级别启动 PHP 线程？***

# python - 传递变量，创建实例，自我，类的机制和用法：需要解释

> ID：11421659
> 
> 赞同：66
> 
> 时间：2012-07-10T20:45:45.260
> 
> 标签：python, class, call, parameter-passing, instance-variables

我只是将一个工作程序重写为一个类中的函数，一切都搞砸了。

**首先**，在`__init__`类的部分中，我声明了一堆变量`self.variable=something`。

我应该能够通过`self.variable`在该函数中使用来访问/修改类的每个函数中的这些变量吗？换句话说，通过声明`self.variable`我已经取得了这些变量，全局变量在类的范围内对吗？

如果没有，我该如何处理自己？

**其次**，我如何正确地将参数传递给类？

**三**、如何在类作用域之外调用类的函数？

**四**、如何`class INITIALCLASS`在另一个中创建一个实例`class OTHERCLASS`，将变量从`OTHERCLASS`到传递`INITIALCLASS`？

我想用来自`OTHERCLASS`的参数调用一个函数`INITIALCLASS`。到目前为止我所做的是。

```
class OTHERCLASS():
    def __init__(self,variable1,variable2,variable3):
        self.variable1=variable1
        self.variable2=variable2
        self.variable3=variable3
    def someotherfunction(self):
        something=somecode(using self.variable3)
        self.variable2.append(something)
        print self.variable2
    def somemorefunctions(self):
        self.variable2.append(variable1)

class INITIALCLASS():
    def __init__(self):
        self.variable1=value1
        self.variable2=[]
        self.variable3=''
        self.DoIt=OTHERCLASS(variable1,variable2,variable3)

    def somefunction(self):
        variable3=Somecode
        #tried this
        self.DoIt.someotherfunctions()
        #and this
        DoIt.someotherfunctions() 
```

我显然不明白如何将变量传递给类或如何处理`self`，何时使用，何时不使用。我可能也不明白如何正确创建一个类的实例。一般来说，我不了解课程的机制，所以请帮助我并向我解释，就像我不知道一样（我似乎不知道）。或者指向我一个完整的视频，或可读的教程。

我在网上找到的只是超级简单的例子，对我没有多大帮助。或者只是类和类方法实例等的非常简短的定义。

如果你们愿意，我可以把我的原始代码发给你，但它很长。

* * *

## 回答 #1

> 赞同：116
> 
> 时间：2012-07-10T21:07:50.440

```
class Foo          (object):
    # ^class name  #^ inherits from object

    bar = "Bar" #Class attribute.

    def __init__(self):
        #        #^ The first variable is the class instance in methods.  
        #        #  This is called "self" by convention, but could be any name you want.
        #^ double underscore (dunder) methods are usually special.  This one 
        #  gets called immediately after a new instance is created.

        self.variable = "Foo" #instance attribute.
        print self.variable, self.bar  #<---self.bar references class attribute
        self.bar = " Bar is now Baz"   #<---self.bar is now an instance attribute
        print self.variable, self.bar  

    def method(self, arg1, arg2):
        #This method has arguments.  You would call it like this:  instance.method(1, 2)
        print "in method (args):", arg1, arg2
        print "in method (attributes):", self.variable, self.bar

a = Foo() # this calls __init__ (indirectly), output:
                 # Foo bar
                 # Foo  Bar is now Baz
print a.variable # Foo
a.variable = "bar"
a.method(1, 2) # output:
               # in method (args): 1 2
               # in method (attributes): bar  Bar is now Baz
Foo.method(a, 1, 2) #<--- Same as a.method(1, 2).  This makes it a little more explicit what the argument "self" actually is.

class Bar(object):
    def __init__(self, arg):
        self.arg = arg
        self.Foo = Foo()

b = Bar(a)
b.arg.variable = "something"
print a.variable # something
print b.Foo.variable # Foo 
```

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2012-07-10T21:33:28.067

所以这里有一个如何使用类的简单例子：假设你是一个金融机构。您希望客户的帐户由计算机管理。因此，您需要对这些帐户进行建模。这就是类的用武之地。使用类称为面向对象编程。使用类，您可以在计算机中对真实世界的对象进行建模。那么，我们需要对一个简单的银行账户进行建模吗？我们需要一个保存余额的变量和一个保存客户姓名的变量。此外，还有一些方法可以增加和减少平衡。这可能看起来像：

```
class bankaccount():
    def __init__(self, name, money):
        self.name = name
        self.money = money

    def earn_money(self, amount):
        self.money += amount

    def withdraw_money(self, amount):
        self.money -= amount

    def show_balance(self):
        print self.money 
```

现在您有了一个简单帐户及其机制的抽象模型。`def __init__(self, name, money)`是类的构造函数。它在内存中建立对象。如果您现在想开设一个新帐户，您必须创建一个类的实例。为此，您必须调用构造函数并传递所需的参数。在 Python 中，构造函数由类的名称调用：

```
spidermans_account = bankaccount("SpiderMan", 1000) 
```

如果蜘蛛侠想给 MJ 买一个新戒指，他必须提取一些钱。`withdraw`他会在他的帐户上调用该方法：

```
spidermans_account.withdraw_money(100) 
```

如果他想查看余额，他会调用：

```
spidermans_account.show_balance() 
```

类的全部内容是对对象、它们的属性和机制进行建模。要创建一个对象，请像示例中一样实例化它。值通过 getter 和 setter 方法（如“earn_money()”）传递给类。这些方法访问您的对象变量。如果您希望您的类存储另一个对象，则必须在构造函数中为该对象定义一个变量。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-07-10T21:09:59.127

类的全部意义在于您创建了一个*实例*，并且该实例封装了一组数据。所以说你的变量在类的范围内是全局的是错误的：而是说一个实例拥有属性，并且该实例可以在其任何代码中引用它自己的属性（通过`self.whatever`）。类似地，给定实例的任何其他代码都可以使用该实例来访问实例的属性 - 即`instance.whatever`.

# php - 如何上传使用 javascript 和 PHP 转换缩略图的图像文件？

> ID：11421664
> 
> 赞同：1
> 
> 时间：2012-07-10T20:46:04.670
> 
> 标签：php, javascript

我有一些代码，在上传原始图像之前，它会创建缩略图图像。我想做的是，我不想上传客户的原始图片，而是上传缩略图。原因是原始图像文件通常太大，而我的系统可以处理非常小的图像，例如缩略图。我怎样才能实现我的目标？

到目前为止，这是我的代码：

### PHP代码：

```
if (isset($HTTP_POST_VARS['action'])) {
   $SafeFile = $_FILES['client_image']['name'];
} 
```

### HTML 代码：

```
< input type="file"  valign=middle  name="client_image" id="client_image" >
< output id="list" > <  /output> 
```

### JavaScript 代码：

```
document.getElementById('client_image').addEventListener('change', handleFileSelect, false);
function handleFileSelect(evt) {
    var files = evt.target.files; 
    for (var i = 0, f; f = files[i]; i++) {
        // Only process image files.
        if (!f.type.match('image.*')) {
            continue;
        }
        reader.onload = (function(theFile) {
            return function(e) {
                // Render thumbnail.
                var span = document.createElement('span');
                span.innerHTML = ['<img class="thumb" id="thumb_image" src="', e.target.result,
                                '" title="', escape(theFile.name), '"/>'].join('');
                document.getElementById('list').insertBefore(span, null);
            };  
        })(f);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T20:56:03.217

唯一适用于所有流行浏览器的解决方案是使用带有图像预处理的 Flash 上传器。

[SWFUploader](http://code.google.com/p/swfupload/) (version >=2.5.0) 有这个功能。

这是一个使用示例（文件夹`demos/resizedemo`）：[SWFUpload_v250_beta_3_samples.zip](http://code.google.com/p/swfupload/downloads/detail?name=SWFUpload_v250_beta_3_samples.zip)

# jquery - jQuery隐藏由孩子继承

> ID：11421673
> 
> 赞同：0
> 
> 时间：2012-07-10T20:46:55.117
> 
> 标签：jquery, hide, show, inheritance

我有一个有趣的 jquery 问题。本质上，当我将鼠标悬停在另一个父级上以显示子菜单时，我需要一个粘性子菜单来隐藏，然后当我没有将鼠标悬停在具有子菜单的另一个父级上时重新出现。这一切都很好，问题是当我将鼠标悬停在我的粘性子菜单中的一个子 li 上时，子菜单会翻转，在显示和不显示之间闪烁。好像我的jquery被子li继承了？无论如何，这是代码：

CSS

```
.current-menu-parent ul{
  display:block;
  position:absolute;
}
#primary-nav ul li:hover ul {
  display:inline;
  position:absolute;
}
#primary-nav ul li > ul{
  display:none;
} 
```

JavaScript

```
$(document).ready(function(){
  $(".current-menu-parent ul").show()
  $("#primary-nav > ul.menu li").mouseover(function(){
    $(".current-menu-parent ul").hide();
  });
  $("#primary-nav > ul.menu li").mouseout(function(){
    $(".current-menu-parent ul").show();
  });
}); 
```

HTML

```
<div id="primary-nav">
  <ul class="menu">
    <li>item</li>
    <li class="current-menu-parent">This is the current menu parent item
        <ul>
            <li>Current page</li>
            <li>page</li>
            <li>page</li>
        </ul>
     </li>
   <ul>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T20:52:36.960

这是因为您的选择器的第二部分`ul.menu li`, 适用于 ALL`li`中包含的`ul.menu`. 您可能希望使用 a`ul.menu > li`来代替它，以便事件仅在悬停时触发，`li`它是`ul.menu`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T20:55:15.277

```
$("#primary-nav > ul.menu li").hover(function() {
    $(this).children("ul").show();
}, function() {
    $(this).children("ul").hide();
}); 
```

这样，它将显示/隐藏 li 的任何 ul 子级。它适用于您的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-10T21:07:30.310

您需要应用安德鲁的答案并添加以下内容：

```
$(".current-menu-parent ul").mouseover(function(e){

     e.stopPropagation();

}); 
```

请参阅完整的小提琴 jsfiddle.net/CBpHg/1/

更新：

稍微解释一下，当您将鼠标悬停在最低级别的 li 上时，悬停事件会一直冒泡到具有隐藏功能的父级，这就是菜单消失的原因。所以我们在 ul 上使用 stopPropagation 来防止它继续前进。您也可以在 li 的最低级别上使用它。

# c++ - 如何使用 Boost 在 C++ 中制作代理服务器

> ID：11421678
> 
> 赞同：3
> 
> 时间：2012-07-10T20:47:07.240
> 
> 标签：c++, boost, proxy

我正在制作一个 Web 应用程序模糊器，对于我的代理服务器，我正在使用由一个名叫 Alex Ott 的人开发的开源代码（目前）。我注意到，当我从一些网站发出请求时，这些请求没有被捕获，所以我真的很想用 C++ 编写自己的代理，但我完全不知道从哪里开始。有人可以向我解释吗？

最终目标实际上是能够捕获通过代理发出的每个请求并将其写入文件，我已经在这样做了，但是我现在拥有的代理服务器并没有捕获所有这些请求，我知道这些请求在那里.

编辑：由于问题不清楚，所以这里是：我想知道使用 Boost 扩展库用 C++ 编写的代理服务器的代码是什么。过去四个月的同样问题。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-10T21:36:24.547

好吧，这是一个有点实用的示例，可以帮助您入门。它在两个连接之间转发。请注意，此简单示例不适用于 Web 浏览器，因为客户端将尝试建立多个连接，而此示例仅侦听一个。使用它作为（非常简单的）基础，您应该能够取得一些进展。

有趣的事情发生在 中`handle_read`，这是接收到数据时执行的回调。该函数在套接字之间转发数据。请注意，当我们最初为“本地”和“远程”连接调用它时，我们传递套接字的顺序是相反的（`read_from`和`write_to`）。

```
#include <iostream>
using namespace std;

#include <boost/asio.hpp>
#include <boost/lexical_cast.hpp>
#include <boost/thread.hpp>
#include <boost/bind.hpp>

boost::asio::io_service& io_service()
{
   static boost::asio::io_service svc;
   return svc;
}

char local_data[1024] = {0};
char remote_data[1024] = {0};

void handle_read(
   boost::asio::ip::tcp::socket& read_from,
   boost::asio::ip::tcp::socket& write_to,
   char* read_buffer,
   size_t bytes,
   const boost::system::error_code& e)
{
   // this function is called whenever data is received

   // for debugging purposes, show the data in the console window
   // or write to file, or whatever...
   std::string data(read_buffer, read_buffer + bytes);    
   std::cout << data << "\n";

   // forward the received data on to "the other side"    
   write_to.send(
      boost::asio::buffer(read_buffer, bytes));

   // read more data from "this side"
   read_from.async_read_some(
      boost::asio::buffer(read_buffer, 1024),
      boost::bind(handle_read, boost::ref(read_from), boost::ref(write_to), read_buffer, boost::asio::placeholders::bytes_transferred, boost::asio::placeholders::error));
}

int main(int argc, char** argv)
{
   if(argc == 5)
   {
      boost::asio::io_service::work w(io_service());

      boost::thread t(boost::bind(&boost::asio::io_service::run, (&io_service())));

      // extract the connection information from the command line
      boost::asio::ip::address local_address = boost::asio::ip::address::from_string(argv[1]);
      uint16_t local_port = boost::lexical_cast<uint16_t>(argv[2]);
      boost::asio::ip::address remote_address = boost::asio::ip::address::from_string(argv[3]);
      uint16_t remote_port = boost::lexical_cast<uint16_t>(argv[4]);

      boost::asio::ip::tcp::endpoint local_ep(local_address, local_port);
      boost::asio::ip::tcp::endpoint remote_ep(remote_address, remote_port);

      // start listening on the "local" socket -- note this does not
      // have to be local, you could in theory forward through a remote device
      // it's called "local" in the logical sense    
      boost::asio::ip::tcp::acceptor listen(io_service(), local_ep);
      boost::asio::ip::tcp::socket local_socket(io_service());
      listen.accept(local_socket);

      // open the remote connection
      boost::asio::ip::tcp::socket remote_socket(io_service());
      remote_socket.open(remote_ep.protocol());
      remote_socket.connect(remote_ep);

      // start listening for data on the "local" connection
      local_socket.async_receive(
         boost::asio::buffer(local_data, 1024),
         boost::bind(handle_read, boost::ref(local_socket), boost::ref(remote_socket), local_data, boost::asio::placeholders::bytes_transferred, boost::asio::placeholders::error));

      // also listen for data on the "remote" connection
      remote_socket.async_receive(
         boost::asio::buffer(remote_data, 1024),
         boost::bind(handle_read, boost::ref(remote_socket), boost::ref(local_socket), remote_data, boost::asio::placeholders::bytes_transferred, boost::asio::placeholders::error));

      t.join();
   }
   else
   {
      cout << "proxy <local ip> <port> <remote ip> <port>\n";
   }

   return 0;
} 
```

# python - 将 Maya 模块导入 Nuke (Python)

> ID：11421680
> 
> 赞同：1
> 
> 时间：2012-07-10T20:47:08.020
> 
> 标签：python, import, maya, nuke

我可以通过 Python 2.7 IDE 轻松导入 Maya 模块，但是在使用 Nuke 的脚本编辑器时，我无法导入 Maya 并出现“No module named maya”错误

有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T12:15:24.707

好吧，如果您想导入maya模块，您可以将“E:\Program Files\Autodesk\Maya2013\Python\Lib\site-packages”的路径添加到nuke中的sys.path，

这是一个解释如何做到这一点..

首先使用下面的代码测试路径是否它们

```
import sys
[each for each in sys.path] 
```

现在在此列表中，您可以通过这行代码在开头插入或在末尾附加您的 Maya 模块**的路径（在我的情况下，下面的路径在您的计算机上会有所不同**）

```
sys.path.append("E:/Program Files/Autodesk/Maya2013/Python/Lib/site-packages") 
```

当您使用斜杠添加路径检查时，应该是 // 或**/** ...

然后再次使用我在开始时给您的代码测试是否添加了路径...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-17T15:23:15.170

除了使用系统模块之外，您还可以使用 nuke 模块本身附加路径：

```
nuke.pluginAddPath('C:/Program Files/Autodesk/Maya2016/Python/Lib/site-packages/') 
```

并测试：

```
import maya 
```

# oop - Matlab 实例变量未保存，恢复为 0

> ID：11421682
> 
> 赞同：0
> 
> 时间：2012-07-10T20:47:17.553
> 
> 标签：oop, class, matlab, instance

我很难理解为什么我的实例变量没有被保存。每当我对 CurrentSettings 进行更改时，下次调用另一个函数时它就不会出现。基本上它不会`0`在每个函数之后保存并恢复为 s 。

```
classdef laserControl
%LASERCONTROL This module is designed to control the laser unit. 
%   It can set the filter position, open and close the shutter and turn
%   on/off the laser.
%
%%%%%%%%%%PORT LISTINGS%%%%%%%%%%%
%The set filter command is on port0
%The set shutter is in port1
%Laser 1 on port2
%Laser 2 on port3
%The filter digits are on ports 8-15 (the are on the second box)

properties%(GetAccess = 'public', SetAccess = 'private')
    laserPorts; %The #'s of the output ports
    currentSettings; %Current high/low settings
    dio;
end

methods

    %Constructor
    %Opens the connection with the digital outputs
    %Make sure to close the connection when finished
    function Lobj = laserControl()
        %Setup the laser
        Lobj.laserPorts = [0:3 8:15];% 8:15
        Lobj.currentSettings = zeros(1, length(Lobj.laserPorts));
        %Make connection and reset values
        Lobj.dio = digitalio('nidaq','Dev1');
        addline(Lobj.dio, Lobj.laserPorts, 'out');
        putvalue(Lobj.dio, Lobj.currentSettings);
    end

    %Closes the connection to the digital output
    function obj = CloseConnection(obj)
        putvalue(obj.dio, zeros(1, length(obj.currentSettings)));
        delete(obj.dio);
        clear obj.dio;
    end

    %Sets the position of the filter.
    %positionValue - the integer amount for the position, cannot be
    %larger than 150, as regulated by the box.
    %The set filter command is on port0
    %The filter digits are on ports 8-15 (the are on the second box)
    function obj = SetFilterPosition(obj, positionValue)
        if 0 <= positionValue && positionValue < 150
            binaryDigit = de2bi(positionValue); %Convert it to binary form
            %LaserOn OldSettings NewValue ExtraZeros
            obj()
            obj.currentSettings()
            obj.currentSettings = [1 obj.currentSettings(1, 2:4) binaryDigit...
                zeros(1, 8 - length(binaryDigit))];
            putvalue(obj.dio, obj.currentSettings);
        else
            display('Error setting the filer: Value invalid');
        end
    end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T07:15:54.050

因为您的类不继承自`handle`，所以您编写了一个“值”类型的类 - 换句话说，当您进行更改时，您必须捕获返回值，如下所示：

```
myObj = SetFilterPosition( myObj, 7 ); 
```

有关句柄和值类的更多信息，请参阅[文档](http://www.mathworks.com/help/techdoc/matlab_oop/brfylyl-1.html "句柄和值类")

# sql - nHibernate SQL 日志记录 + 堆栈跟踪一起

> ID：11421686
> 
> 赞同：0
> 
> 时间：2012-07-10T20:47:55.973
> 
> 标签：sql, asp.net-mvc, nhibernate, log4net, missing-data

我遇到了一个问题，即我们的生产数据库中偶尔会丢失记录。这是一个带有 nHibernate 的 .NET MVC 2 应用程序。在过去的几年里，几位开发人员一直在研究它，所以我们假设某个地方的映射设置不正确，并且 nHibernate 认为它应该删除这些记录。

我使用 log4net 从我们的管理员和前端（在单独的文件中）记录 nHibernate 生成的所有 SQL。奇怪的是，我们网站的前端似乎偶尔会为当时丢失的记录生成删除。这很奇怪，因为尽管前端和后端共享相同的数据模型，但前端不应该有任何写入/更新功能。我们确信这是所有 CRUD 所在的管理员中的一个错误。然而它在日志中......一批DELETES。

我想获得更多关于这些 SQL 语句是从堆栈中生成的位置的信息。如果我能在每个 nHibernate 事务之前以某种方式获得一个小的堆栈跟踪，那就太好了。到目前为止，我的 log4net 设置如下所示：

```
<appender name="RollingFile" type="log4net.Appender.RollingFileAppender,log4net" >

    <param name="File" value="nHibernate.txt" />
    <param name="AppendToFile" value="true" />
    <param name="DatePattern" value="yyyy.MM.dd" />

    <layout type="log4net.Layout.PatternLayout,log4net">
        <conversionPattern value="%d %p %m%n" />
    </layout>

</appender>

<logger name="NHibernate.SQL" additivity="false">
    <level value="DEBUG" />
    <appender-ref ref="RollingFile" />
</logger> 
```

也许我只需要分别记录这两件事并自己比较时间？我只是在寻找建议。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T20:57:49.873

您可以使用`stacktrace`或`stacktracedetail` [转换模式](http://logging.apache.org/log4net/release/sdk/log4net.Layout.PatternLayout.html)。

**堆栈跟踪**

> 用于输出日志事件的堆栈跟踪堆栈跟踪级别说明符可以用大括号括起来。例如，%stacktrace{level}。如果没有给出堆栈跟踪级别说明符，则假定为 1。输出使用格式：type3.MethodCall3 > type2.MethodCall2 > type1.MethodCall1。此模式不适用于 Compact Framework 程序集。

**堆栈跟踪详细信息**

> 用于输出日志事件的堆栈跟踪堆栈跟踪级别说明符可以用大括号括起来。例如，%stacktracedetail{level}。如果没有给出堆栈跟踪级别说明符，则假定为 1。输出使用格式：type3.MethodCall3(type param,...) > type2.MethodCall2(type param,...) > type1.MethodCall1(type param,...)。此模式不适用于 Compact Framework 程序集。

你可以像这样使用它：

```
<conversionPattern value="%d %p %m%n%stacktrace" /> 
```

* * *

**编辑：**

关于 log4net 堆栈跟踪的几个 SO 问题：
[如何在 log4net 中的每个日志调用中添加 StackTrace？](https://stackoverflow.com/questions/2606514/add-stacktrace-to-every-log-in-log4net)
[如何使用 log4net (C#) 记录堆栈跟踪 log4net](https://stackoverflow.com/questions/9319810/how-to-log-stack-trace-using-log4net-c)
[是否支持在日志消息中包含调用堆栈](https://stackoverflow.com/questions/1906227/does-log4net-support-including-the-call-stack-in-a-log-message)

# javascript - 将 Treeview Selected Node 值发送到文本框而不回发

> ID：11421688
> 
> 赞同：1
> 
> 时间：2012-07-10T20:48:08.613
> 
> 标签：javascript, asp.net, treeview

我已经为此工作了很长一段时间，但没有找到任何可以解决我的问题的方法。当我选择一个节点时，我希望该节点的值填充一个文本框。我可以使用 vb codebehind 让它工作，但它会导致回发，我不希望它这样做。我想尝试使用 javascript 来代替，但我不确定在哪里调用该函数或如何设置它。

这是我的树视图的代码和我想将其发送到的文本框：

> ```
> <asp:TextBox ID="tbSelectedOrg" runat="server" Enabled="false" asp:TextBox> 
> ```

```
 <asp:TreeView 
                ID="tvOrganizationTree" 
                ExpandDepth="0"
                runat="server" 
                PopulateNodesFromClient = "true" 
                ShowLines="true" 
                ShowExpandCollapse="true"
                OnSelectedNodeChanged="tvOrganizationTree_SelectedNodeChanged"> // currently calls vb code causing postback
              </asp:TreeView> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T22:46:00.033

我很快就创建了这个例子。试试看。

```
<asp:Content ID="HeaderContent" runat="server" ContentPlaceHolderID="HeadContent">
    <script src="Scripts/jquery-1.4.1.min.js" type="text/javascript"></script>
<script language="javascript" type="text/javascript">
    $(document).ready(function () {
        $("#<%= TreeView1.ClientID %> div a").click(function () {
            $("#txt").val(this.innerHTML);
            return false;
        });
    });
</script>
</asp:Content>
<asp:Content ID="BodyContent" runat="server" ContentPlaceHolderID="MainContent">
    <asp:TreeView ID="TreeView1" runat="server">
    </asp:TreeView>
    <input type="text" id="txt" />
</asp:Content> 
```

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T20:54:45.437

我会使用 JQuery 来解决这样的问题。

这段代码并不完美，但应该让您知道在哪里查看：

```
 $("#tvOrganizationTree .what-ever-class-aspnet-gives-the-nodes")
        .click(function() 
        { 
            $("#id-of-textbox").html(this.html());
        }); 
```

# java - Spring MVC + Apache tile，表单验证和重定向

> ID：11421695
> 
> 赞同：2
> 
> 时间：2012-07-10T20:49:00.020
> 
> 标签：java, spring, tiles

我在重定向页面时遇到问题。

控制器：

```
@Controller
@RequestMapping("/user")
public class UserController {

    @RequestMapping(method = RequestMethod.POST)
    public String processSubmit(@Valid User user,
            BindingResult result) {

        if (result.hasErrors()) {

                    return "userForm";

                    **It will show error - Could not resolve view with name 'userForm' in servlet with name 'dispatcher'**

                    return "redirect:user.htm";

                    **It will redirect page but without error messages**                                                    

        } else {
           **same problem here**
            return "userResult";
        }
    }

    @RequestMapping(method = RequestMethod.GET)
    public ModelAndView initForm(ModelAndView model) {
        User us = new User();
        model.addObject("user", us);
        return model;

    }

} 
```

调度程序-servlet：

```
<bean id="viewResolver"
    class="org.springframework.web.servlet.view.UrlBasedViewResolver">
    <property name="viewClass">
        <value>
            org.springframework.web.servlet.view.tiles2.TilesView
        </value>
    </property>
</bean>
<bean id="tilesConfigurer"
    class="org.springframework.web.servlet.view.tiles2.TilesConfigurer">
    <property name="definitions">
        <list>
            <value>/WEB-INF/tiles.xml</value>
        </list>
    </property>
</bean> 
```

网页.xml：

```
 <servlet>
        <servlet-name>dispatcher</servlet-name>
        <servlet-class>
            org.springframework.web.servlet.DispatcherServlet
        </servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>dispatcher</servlet-name>
        <url-pattern>*.htm</url-pattern>
    </servlet-mapping> 
```

没有瓷砖一切都好。但是当我将调度程序配置为使用磁贴时，重定向不起作用，我不知道如何修复它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T12:47:37.807

解决方案：

我必须返回瓷砖的名称而不是 jsp 文件。感谢杰罗姆。

# c# - AddAttributeBefore 如何在 Resharper API 中工作？

> ID：11421696
> 
> 赞同：0
> 
> 时间：2012-07-10T20:49:00.957
> 
> 标签：c#, resharper, resharper-6.1, resharper-plugins

在 Resharper API 中，`JetBrains.Resharper.Psi.Csharp.Tree.AddAttributeBefore`接受一个`IAttribute param`, 和一个`IAttribute anchor`. 这些论点有何不同，如何构建它们？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-10T20:54:10.667

看一看里面[的 XML 文档](http://confluence.jetbrains.net/exportword?pageId=38963614)，它显示了`AddAttributeBefore`调用的使用，第一个是您希望插入的属性。第二个是您希望之前插入的已经存在的属性。如果第二个属性是`NULL`新属性，则在最后一个属性之后插入。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-11T17:58:26.530

基本上，这`param`是您要添加的内容，并且`anchor`是您要在其之前添加内容的元素。请记住，在大多数情况下，您可以拥有`anchor == null`，这将导致元素最后添加。

# asp.net - MVC3-将具有动态数据的整个模型从视图传递到控制器

> ID：11421699
> 
> 赞同：0
> 
> 时间：2012-07-10T20:49:35.320
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3, model-binding

我有两个模型：OuterModel 和 InnerModel。OuterModel 和 InnerModel 之间分别存在一对多的关系。为了澄清我的问题，我的模型属于 IEnumerable<OuterModel> 类型。我将随机数量的 OuterModel 传递给视图，用户为每个 OuterModel 创建任意数量的 InnerModel。然后在提交时，我希望控制器接收 OuterModels 列表，以便 InnerModels 可以添加到数据库中以添加到它们预期的 OuterModels。

我相信我的命名约定是正确的，可以使用 MVC 的内置模型绑定。看起来是这样的：

```
OuterModel[i].InnerModel[j].Property 
```

我的问题是，我真的不知道如何获取传递给控制器​​的 OuterModel 列表。这是我在视图中尝试过的：

```
 @model IEnumerable<OuterModel>

    @using (Html.BeginForm("Create", "Controller", new { OuterModels = Model }, FormMethod.Post))
    {
       //Code to create the InnerModels here
    } 
```

这是我的控制器中的内容：

```
 [HttpPost]
    public ActionResult Create(IEnumerable<OuterModel> OuterModels, FormCollection fc)
    {
       String[] keys = fc.AllKeys;
       if(ModelState.IsValid){
          //Add to db
       }
    } 
```

Keys 显示我的所有属性都遵循我之前指定的命名约定，但 ModelState.IsValid 返回 false。它表明 OuterModels 的计数为 0。

即使我告诉表单在创建任何 InnerModels 之前提交 OuterModels = Model，您仍会认为 OuterModels 中仍有数据，因为它已传递给视图。我今天真的很累，所以我猜我正在查看一个（或多个）小细节。有什么建议么？

**- 编辑 -**

将 OuterModel 列表传递给控制器​​可能不是最好的方法。如果有人有更好的建议，请分享。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T21:41:19.647

只要正确使用索引，这应该不是问题。这是我设想表单名称的方式。

型号[0].foo

模型[0].Inner[0].bar

模型[0].Inner[1].bar

其中外部模型有一个名为 foo 的属性，而外部模型有一个名为 inner 的属性，它是内部对象的集合。内部对象有一个名为 bar 的属性。如果您的表单使用正确的索引呈现，那么模型绑定应该可以工作。如果表单字段是在客户端生成的，事情会变得很棘手。我建议返回服务器以操作模型。有一些额外的往返，但您可以通过 Ajax 请求进行。

这是一个更充实的示例中的更多细节。

```
public class InnerModel{
    public string Name{get; set;}
}

public class OuterModel{
   public List<InnerModel> InnerModels{get; set;}
   public string Name{get; set;}
} 
```

以下是我设想的我的观点：

```
@model IEnumerable<OuterModel>

<ul>
  @{int i = 0;}
  @foreach(var item in Model){
     <li>
        Outer Name : @Html.TextBoxFor(m=>Model[i].Name)
        <br />
        @{int j = 0;}
        <ul>
            @foreach(var innerItem in Model[i].InnerModels){
               <li>Inner Name : @Html.TextBoxFor(m=> Model[i].InnerModels[j].Name)</li>
               j++;

            }
        </ul> 
        i++;
     </li>
  }
</ul> 
```

如果它被包装在一个表单中---并且控制器动作如下所示：

```
public ActionResult Action(List<OuterModel> model){
} 
```

那么我认为模型会正确填充。

我注意到你的表格..它看起来不对我......我不认为像这样传递 OuterModels 会起作用 - 尽管坦率地说我可能是错的。

```
@using (Html.BeginForm("Create", "Controller", new { OuterModels = Model }, FormMethod.Post))
{
   //Code to create the InnerModels here
} 
```

这是我为我教的课做的一个例子..这绝对有效..

```
public class Author
{
    public string Name { get; set; }
}

public class Book
{
    public string Name { get; set; }

    public List<Author> Authors { get; set; }
} 
```

控制器：

```
public class BookController : Controller
{

    public static List<Book> _model = null;

    public List<Book> Model
    {
        get
        {
            if (_model == null)
            {
                _model = new List<Book>
                {
                    new Book{
                        Name = "Go Dog Go", 
                        Authors = new List<Author>{
                            new Author{Name = "Dr. Seuss"}
                        }},
                    new Book{
                        Name = "All the Presidents Men", 
                        Authors = new List<Author>{
                            new Author{Name = "Woodward"},
                            new Author{Name = "Bernstein"}
                        }},
                    new Book{
                        Name = "Pro ASP.NET MVC Framework", 
                        Authors = new List<Author>{
                            new Author{Name = "Sanderson"},
                            new Author{Name = "Stewart"},
                            new Author {Name = "Freeman"}
                        }}
                };
            }
            return _model;
        }
    }

    public ActionResult Index()
    {
        return View(Model);
    }

    public ActionResult Edit()
    {
        return View(Model);
    }

    [HttpPost]
    public ActionResult Edit(List<Book> books)
    {
        _model = books;
        return RedirectToAction("Index");
        //return View(books);
    }

} 
```

和查看：

```
@model List<AmazonWeb.Models.Book>
@{
    ViewBag.Title = "Index";
}

<div class="content">

@Html.ActionLink("Index", "Index")

@using (Html.BeginForm())
{
  <input type="submit" value="save" />
<ul class="book-list">

@for (var i = 0; i < Model.Count; i++ )
{
    <li>
        <label>Book Name</label> : @Html.TextBoxFor(m => Model[i].Name)
        <ul>
            @for (var j = 0; j < Model[i].Authors.Count; j++ )
            {
                <li><label>Author Name</label> : @Html.TextBoxFor(m => Model[i].Authors[j].Name)</li>
            }
        </ul>
    </li>
}
</ul>
    <input type="submit" value="save" />
}
</div> 
```

# ninject - 从 Ninject 2 移动到 Ninject 3。绑定错误。确保提供者正确处理创建请求

> ID：11421700
> 
> 赞同：2
> 
> 时间：2012-07-10T20:49:35.287
> 
> 标签：ninject

我刚刚使用 Ninject 3 更新了我的应用程序。将 App_Start 中的文件从 NinjectMVC3 更改为 NinijectWebCommon.cs。移动了我的文件，更新了 DLL。现在我开始收到这个错误：

“使用 Dictionary{string, string} Provider 的条件隐式自绑定激活 Dictionary{string, string} 时出错。激活路径：4) 将依赖 Dictionary{string, string} 注入 MapWidgetViewModel 类型构造函数的参数 widgetSettings 3)将依赖项 IDetailedSearchResultCollectionWidget 注入到 MediaSourcesViewModel 类型的构造函数的参数 mediaWidgets 2) 将依赖项 ITabItem 注入到 TabNavigationController 类型的构造函数的参数 tabItems 1) 请求 TabNavigationController

建议：1）确保提供者正确处理创建请求。”

在这里生成它的代码：

```
public MediaSourcesViewModel(IEnumerable<IMediaSourcesDataProvider> dataProviders,
               IEnumerable<IDetailedSearchResultCollectionWidget> mediaWidgets,
               IMediaItemDetailsWidget itemDetailsWidget)
        {
        this.Description = "Source list";
            this.ActionName = "DisplaySourcesAsPartial";
            this.ControllerName = "MediaSources";
            this.DefaultType = "MediaManagement";

            _dataProviders = dataProviders;

            MediaWidgets = new List<IDetailedSearchResultCollectionWidget>();
            MediaWidgets.AddRange(mediaWidgets);         //Set Tab Info
            this.Name = "Sources";
        } 
```

MapWidgetViewModel 类定义如下：

```
public class MapWidgetViewModel : IDetailedSearchResultCollectionWidget, IMapWidgetSettings
{
   //constructor:
   public MapWidgetViewModel(IEnumerable<IDetailedSearchResult> dataSet, 
          Dictionary<String,String> widgetSettings = null)
        {
            InitParentInterfaceProperties();
        }
} 
```

最后绑定：

```
kernel.Bind<IDetailedSearchResultCollectionWidget>().To<MapWidgetViewModel>(); 
```

没有

```
kernel.Bind<MapWidgetViewModel>().ToSelf(); 
```

感谢您提供如何解决此问题的任何想法。

多谢！

亚历克斯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T16:11:54.480

好的..找到有帮助的答案..这里是： [Using default parameter values with Ninject 3.0](https://stackoverflow.com/questions/10517962/using-default-parameter-values-with-ninject-3-0)

只需要覆盖设置： kernel.Settings.AllowNullInjection = true;

谢谢，艾尔

# c# - XML 新行内文本

> ID：11421701
> 
> 赞同：1
> 
> 时间：2012-07-10T20:49:40.183
> 
> 标签：c#, .net, xml, newline, indentation

我正在使用 XML，但我遇到了这个问题：我想在单行上添加一个内部文本，由开始和结束元素标签分隔。像这样的东西：

```
<root>
 <child name="name">
  Hi! I'm inner text!
 </child>
</root> 
```

但如果我添加内部文本：

```
child.InnerText = "Hi! I'm inner text!"; 
```

我都在同一条线上：

```
<root>
 <child name="name">Hi! I'm inner text!</child>
</root> 
```

我试图添加：

```
xDoc.PreserveWhitespace = true; 
```

在没有结果的保存功能之前。试过：

```
child.AppendChild(xDoc.CreateWhitespace("\n")); 
```

在 InnerText 指令之后或之前。没有什么。一些帮助？

编辑：这就是我保存 XML 的方式：

```
xDoc.Save(filename); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T21:22:36.683

有几个不同的选择。您可以设置 XmlElement 的 InnerText 或附加文本节点。

```
XmlDocument xDoc = new XmlDocument();
xDoc.PreserveWhitespace = true;

XmlNode root = xDoc.AppendChild(xDoc.CreateElement("root"));
XmlNode child = root.AppendChild(xDoc.CreateElement("child"));

((XmlElement)child).InnerText = "\nHi! I'm Inner Text!\n";
child.AppendChild(xDoc.CreateTextNode("\nHi! I'm also Inner Text\n"));
xDoc.Save(@"c:\temp\temp.xml");
Debug.Write(xDoc.InnerXml.ToString()); 
```

请记住，根据您查看生成的 XML 的方式，您可能看不到文档中生成的换行符。例如，IE 在向您显示文档的漂亮版本时会很高兴地忽略它们。

# windows - SQLLOCALDB 的问题

> ID：11421702
> 
> 赞同：2
> 
> 时间：2012-07-10T20:49:42.827
> 
> 标签：windows, azure, emulation, storage

在尝试启动 azure storage emulator 时，出现以下错误。

探测失败。正在重试 localDB 探测 SQL 实例的探测：'(localdb)\v11.0'。探测 SQL 端点时捕获异常。建立与 SQL Server 的连接时发生与网络相关或特定于实例的错误。服务器未找到或无法访问。验证实例名称是否正确以及 SQL Server 是否配置为允许远程连接。（提供者：SQL 网络接口，错误：50 - 发生 LocalDB 错误。无法创建自动实例。有关错误详细信息，请参阅 Windows 应用程序事件日志。）报告的 SqlErrors 数：1 SqlError：System.Data.SqlClient.SqlError：网络- 与 SQL Server 建立连接时发生相关或特定于实例的错误。服务器未找到或无法访问。验证实例名称是否正确以及 SQL Server 是否配置为允许远程连接。（提供者：SQL 网络接口，错误：50 - 发生 LocalDB 错误。无法创建自动实例。有关错误详细信息，请参阅 Windows 应用程序事件日志。） LocalDB 已安装但无法正常运行。您可能缺少先决条件。确保您已安装 .NET 4.0.2 或更高版本。未找到 SQL 实例。

一项或多项初始化操作失败。在尝试再次运行存储模拟器之前解决这些错误。有关详细信息，请参阅 go.microsoft.com/fwlink/?LinkID=248088。

我也安装了.net 4.0.2。我也尝试卸载和安装 sqllocaldb。

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T20:33:37.713

我有同样的问题。安装 .NET Framework 4.5 后，我的问题就消失了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-03T12:01:33.577

重新初始化存储模拟器时，我也遇到了同样的问题。我在命令提示符下使用了“自动检测”参数，它对我有用。

DSInit /sqlinstance:(localdb)\v11.0 /Autodetect /ForceCreate

希望这对你也有帮助。

阿米特

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T11:22:49.143

如果您可以再次检查本地数据库是否已正确安装并启动，那就更好了。有关详细信息，请参阅[SQL Server 2012 Express LocalDB](http://msdn.microsoft.com/en-us/library/hh510202.aspx)。

# c++ - MFC VSListBox 更改图标

> ID：11421709
> 
> 赞同：1
> 
> 时间：2012-07-10T20:50:23.103
> 
> 标签：c++, mfc

有谁知道是否可以更改 MFC VSListBox 对话框控件上的图标？

具体来说，我正在尝试将文件夹图标更改为“+”图标：

![在此处输入图像描述](../Images/3d4e00df25733ca4bc28ffe801a84021.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T07:13:24.810

我自己没有尝试过，但[`CVSListBoxBase::AddButton()`](http://msdn.microsoft.com/en-us/library/cc701719)似乎是你需要的。

CVSListBox 派生自 CVSListBoxBase，当您调用`CVSListBoxBase::SetStandardButtons`设置按钮时，它会调用`AddButton()`每个按钮。

CVSListBoxBase 的文档尚未完成，因此您必须“玩”它，但您可以阅读 afxvslistbox.cpp/.h 中的代码

# android - 自定义按钮

> ID：11421710
> 
> 赞同：-1
> 
> 时间：2012-07-10T20:50:28.797
> 
> 标签：android, button

谁能告诉我这些按钮是什么？在 colornote 应用程序的顶部使用，以及如何像它们一样，您可以在第三个屏幕截图中看到它们：

[https://play.google.com/store/apps/details?id=com.socialnmobile.dictapps.notepad.color.note&feature=search_result#?t=W251bGwsMSwyLDEsImNvbS5zb2NpYWxubW9iaWxlLmRpY3RhcHBzLm5vdGVwYWQuY29sb3Iubm90ZSJd](https://play.google.com/store/apps/details?id=com.socialnmobile.dictapps.notepad.color.note&feature=search_result#?t=W251bGwsMSwyLDEsImNvbS5zb2NpYWxubW9iaWxlLmRpY3RhcHBzLm5vdGVwYWQuY29sb3Iubm90ZSJd)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T21:04:00.600

看看[android-actionbar](https://github.com/johannilsson/android-actionbar)。它不完全相同，但相似。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-10T21:07:14.543

看起来像操作栏。以下是关于它的 Android 开发文档：

[http://developer.android.com/guide/topics/ui/actionbar.html](http://developer.android.com/guide/topics/ui/actionbar.html)

# facebook - 登录后是否可以从 facebook 检索私人照片？

> ID：11421711
> 
> 赞同：-1
> 
> 时间：2012-07-10T20:50:29.560
> 
> 标签：facebook, facebook-graph-api

我在我的网站上使用 facebook 登录。

登录后，我获得了访问信息的许可。

登录后可以找回私人照片吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T21:14:05.343

我的猜测是它不能。确定的最好方法是设置一个测试用户，看看你的访问令牌是否能让你在[Graph Explorer](http://developers.facebook.com/tools/explorer)中找到私人图片。

# iphone - cimg编译错误

> ID：11421713
> 
> 赞同：0
> 
> 时间：2012-07-10T20:50:44.230
> 
> 标签：iphone, objective-c, ios, xcode, cimg

当我将 CIMG 库添加到 Xcode 时出现此错误：

未找到“cstdio”文件

这是图书馆链接： [http ://cimg.sourceforge.net/](http://cimg.sourceforge.net/)

请帮忙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T20:56:47.030

在您开始考虑使用 C++ 库之前，您的源文件扩展名必须是接受 C++ (.cpp) 或 ObjC++ (.mm) 的类型。当然，CImg 不是在 iOS 设备上运行的（特别是如果你看不到它的源代码）。它甚至不应该在 OS X 上运行（因为 Carbon 支持问题）。使用 OpenGL、CoreImage、CoreGraphics 等以获得更好的性能和支持。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T13:31:28.577

使用 GPUImageFramework 它是一个很棒的图像处理工具

# vb.net - 如何添加到 vb.net 中的简单数组

> ID：11421716
> 
> 赞同：0
> 
> 时间：2012-07-10T20:50:53.140
> 
> 标签：vb.net, arrays, string, add

如果我有

`Dim a As String() = ("One,Two").Split(",")`

如何添加到该字符串？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-10T20:59:23.300

最简单的方法是将其转换为 List 然后添加。

```
Dim a As List(Of String) = ("One,Two").Split(",").ToList
a.Add("Three") 
```

或者如果你真的想保留一个数组。

```
 Dim a As String() = ("One,Two").Split(",")
    Dim b as List(Of String) = a.ToList
    b.Add("Three")
    a=b.ToArray 
```

这里有一些真正开箱即用的东西：

```
a = (String.Join(",", a) & ",Three").Split(",") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-10T21:01:43.590

对于不同的方法，请尝试：

```
Dim a As String() = ("One,Two").Split(CChar(","))
Debug.Print(CStr(UBound(a)))
ReDim Preserve a(9)
Debug.Print(CStr(UBound(a))) 
```

即时窗口的输出是：

```
1
9 
```

注意：我不得不稍微改变你原来的行，因为我总是使用`Option Strict On`不允许隐式转换的。

# blackberry - 为什么在黑莓中绕过 FOCUSABLE LabeField 的 navigationMovement？

> ID：11421718
> 
> 赞同：0
> 
> 时间：2012-07-10T20:50:53.693
> 
> 标签：blackberry, focus, lost-focus, labelfield, focusable

我有一个带有[FOCUSABLE](http://www.blackberry.com/developers/docs/5.0.0api/net/rim/device/api/ui/Field.html#FOCUSABLE)样式的[LabelField](http://www.blackberry.com/developers/docs/5.0.0api/net/rim/device/api/ui/component/LabelField.html)和许多可聚焦的[Field](http://www.blackberry.com/developers/docs/5.0.0api/net/rim/device/api/ui/Field.html)，并且我覆盖了[LabelField的](http://www.blackberry.com/developers/docs/5.0.0api/net/rim/device/api/ui/component/LabelField.html)[navigationMovement](http://www.blackberry.com/developers/docs/5.0.0api/net/rim/device/api/ui/Field.html#navigationMovement%28int,%20int,%20int,%20int%29)方法。问题是：代码永远不会进入[navigationMovement](http://www.blackberry.com/developers/docs/5.0.0api/net/rim/device/api/ui/Field.html#navigationMovement%28int,%20int,%20int,%20int%29)的新实现，但焦点通常从[LabelField](http://www.blackberry.com/developers/docs/5.0.0api/net/rim/device/api/ui/component/LabelField.html)移动到下一个[Field](http://www.blackberry.com/developers/docs/5.0.0api/net/rim/device/api/ui/Field.html)而没有通过[navigationMovement](http://www.blackberry.com/developers/docs/5.0.0api/net/rim/device/api/ui/Field.html#navigationMovement%28int,%20int,%20int,%20int%29)实现！ PS，我还使用调试器进行了测试，以确保它永远不会进入其实现。**为什么会发生这种情况以及如何捕获 FOCUSABLE LabelField 的 navigationMovement 事件？**

 ****代码：**
这是课程：

```
public abstract class FocusableLabelField extends LabelField {
public boolean isDownUnfocused = false;

public FocusableLabelField(String text) {
    super(text, FOCUSABLE);
}

protected void drawFocus(Graphics graphics, boolean on) {
        // DO NOTHING, FOCUS IS HANDLED IN PAINT
}

protected void paint(Graphics graphics) {
    if(isDownUnfocused == true)
        graphics.setColor(0xFFFFFF);
    else {
        if(isFocus())
            graphics.setColor(0xFFFFFF);
        else {
            graphics.setColor(0x777777);
        }
    }
    super.paint(graphics);
}

protected void onFocus(int direction) {
    isDownUnfocused = false;
    onFocusing();
    super.onFocus(direction);
}

public abstract void onFocusing();

public void redraw() {
    invalidate();
}

protected boolean navigationMovement(int dx, int dy, int status, int time) {
    //TODO CHECK WHY IT'S NOT ENTERING HERE !
    if(dy>0)
        isDownUnfocused = true;
    invalidate(); // IF REMOVED NO EFFECT WILL BE APPLIED
    return super.navigationMovement(dx, dy, status, time);
}
} 
```

这是我在屏幕中使用它的方式：

```
FocusableLabelField field = new FocusableLabelField("title") {
    public void onFocusing() {
        // some logic in the screen is done here ...
    }
} ; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T11:10:09.213

我刚刚在5.0 8900 模拟器和 7.1 9900 模拟器上的应用程序中运行了您的**确切代码，我****确实**看到了您的`navigationMovement()`调用。但是，我不能 100% 确定它会在你想要的时候被调用。

我不确切知道您要做什么，但是查看上面的代码，您似乎只是在尝试为焦点颜色添加自定义绘图。那正确吗？

如果是这样，我不知道你为什么甚至需要覆盖`navigationMovement()`. 为什么不使用这样的代码：

```
public abstract class FocusableLabelField extends LabelField {

   public FocusableLabelField(String text) {
      super(text, FOCUSABLE);
   }

   protected void drawFocus(Graphics graphics, boolean on) {
      // DO NOTHING, FOCUS IS HANDLED IN PAINT
   }

   protected void paint(Graphics graphics) {  
      int oldColor = graphics.getColor();
      if(isFocus())
         graphics.setColor(0xFFFFFF);
      else {
         graphics.setColor(0x777777);
      }
      super.paint(graphics);
      graphics.setColor(oldColor);
   }

   protected void onFocus(int direction) {
      onFocusing();
      invalidate();
      super.onFocus(direction);
   }

   protected void onUnfocus() {
      invalidate();
      super.onUnfocus();
   }

   public abstract void onFocusing();
} 
```**

# c# - 创建另一个页面实例时，不会重新初始化 asp.net 页面上的用户控件

> ID：11421721
> 
> 赞同：0
> 
> 时间：2012-07-10T20:50:56.183
> 
> 标签：c#, variables, user-controls, initialization, private

我有一个 C# 网站，它有一个用户控件，我在用户控件的顶部初始化了一系列私有变量：

```
using System.IO;

namespace FF.Core
{

    public partial class _Job : System.Web.UI.UserControl
    {
        private static long _JobID = 0;
        private static string _JobNumber = String.Empty; 
```

我已将此用户控件拖到 .aspx 页面上，标记如下：

```
<%@ Register Src="_Job.ascx" TagName="_Job" TagPrefix="uc1" %>

<uc1:_JobDataEntry ID="_Job" runat="server" /> 
```

我的应用程序将启动包含此用户控件的多个页面。似乎在第一个实例启动后，用户控件没有重新初始化，即_JobID 没有设置回0，而是包含先前加载的_JobID 的值。我有这样的印象，因为我正在启动一个新页面，_JobID 将被设置回 0。我可以在页面加载时初始化我的变量，但我想了解为什么会发生这种情况并了解重用用户控件的最佳方法。我的每个新页面都在新的浏览器窗口“target=_blank”中启动

谢谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T21:15:59.953

你有静态变量，只要你的网络应用程序正在运行，它们就会保持它们的状态。静态变量在给定类的所有实例之间共享。这适用于诸如 winforms 之类的东西，但不适用于 Web 应用程序。通常避免在 Web 应用程序和 Web 服务以及将由 Web 应用程序/服务使用的类库中使用静态变量。

只需将它们设为私有非静态变量。并在您的应用程序中搜索静态变量，并将它们转换为实例变量（除非您有*充分*的理由将它们保持为静态。

# sql - SSRS 报告：报告在哪里处理？

> ID：11421722
> 
> 赞同：0
> 
> 时间：2012-07-10T20:51:00.480
> 
> 标签：sql, reporting-services

如果我将报表部署到 SSRS 门户，那么聚合和呈现都由报表服务器处理，而不是在我运行报表时在本地处理，对吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-10T21:09:47.583

**简短回答：**
是的，报表服务器通常处理部署在门户上的报表。

**长答案：**
如果您有：

1.  报表服务器
2.  门户服务器
3.  访问门户的客户端电脑

然后根据你正在做什么，报告在不同的地方处理：

*   通过[远程处理](http://msdn.microsoft.com/en-us/library/aa337090.aspx)，报表将在报表服务器 (1) 上完成。
*   使用[本地处理](http://msdn.microsoft.com/en-us/library/aa337090.aspx)，报告将在门户服务器 (2) 上完成。
*   在您的设计器中预览报告时，报告会在您的本地 PC (3) 上进行处理。

请注意，尽管报表中的聚合（tablixes 中的聚合）由处理报表的机器处理，但数据集的 SQL（例如`GROUP BY`）中的聚合将由处理数据集的服务器处理，该服务器通常是 SQL 服务器。

# java - 将依赖项添加到我的 Java API

> ID：11421723
> 
> 赞同：1
> 
> 时间：2012-07-10T20:51:02.030
> 
> 标签：java

我是 Java 新手，我已经编写了一个 API，我想分发它。我正在创建一个 Jar 文件来制作 API，但我的程序使用了一些其他 API，例如 Jena 和 XSOM。如何在 Eclipse 的帮助下将这些 API 包含到我的 Jar 发行版中？我已经阅读了类似的问题，但找不到答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T21:26:18.747

问题没有澄清。这取决于为不同目的分发。

如果你不能说清楚，只需拿起一些工具来做：

*   **胖子**呢？它只是将任何依赖项 JAR 添加到一个 jar 中，您可以从 eclipse 菜单中的导出可执行 jar 中执行此操作。

*   [Apache Maven](http://maven.apache.org/)怎么样？它简化了任何 java 项目的依赖管理，但学习如何使用它需要一些时间。

*   构建工具怎么样？例如，[Apache ANT](http://ant.apache.org/)只是一个为 java 项目设计的类似 make 的工具。与 maven 不同，它以您想要的任何顺序组装项目构建。

*   [JSmooth](http://jsmooth.sourceforge.net/)怎么样？它将您的项目打包成可执行文件。

    *不要忘记包含许可证。当您分发 3rd-party JAR 时，许可证声明也应该分发。*

无论如何，分发的目的有很多。例如，准备在 Web 容器中部署和运行的依赖项。通常，我们有部署工具（由 Web 容器提供商提供的 ant 任务或 maven 插件）。例如，为独立的 java 应用程序准备依赖项。在这种情况下，我们应该制作部署工具并自行考虑流程：

*   应用程序如何运送到生产环境？通过 url 下载，通过 scp 复制，从 git repo 中的发布分支结帐？
*   如何更新生产上的应用程序？这是一个重要的问题，当您遇到问题时，需要快速修复和热部署。
*   类路径中 JAR 的更好顺序是什么？错误的顺序会导致类阴影或加载错误的配置文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-10T21:33:39.720

您需要将依赖的 jar 添加到类路径中。

您可以：

*   将其他 jar 列为依赖项，并指示“api”的用户将它们添加到他们的类路径中。

*   如果您的“api”涉及一个主类并且您希望将其作为可执行 jar 分发，您可以使用包含所需库的外部文件夹分发您的 jar，然后更改您的 jar 清单以指定您的主类和类路径以包含那些[外部依赖项](http://docs.oracle.com/javase/tutorial/deployment/jar/downman.html)。

*   如果您使用 maven，那么通过将它们列出在您的依赖项中，它们将自动包含在客户端代码中，因为它们将被视为[传递依赖项。](http://maven.apache.org/guides/introduction/introduction-to-dependency-mechanism.html#Transitive_Dependencies)

*   遮住罐子 - 所以通过打开它们的内容并将它们包含在你的罐子中来包含它们。为此，我想到了三种方法*：

    *   如果您在 maven 中构建您的 api，您可以查看[shade 插件](http://maven.apache.org/plugins/maven-shade-plugin/)
    *   你可以看看使用有点有趣的名字 (?!) [Jar Jar Links](http://code.google.com/p/jarjar/)
    *   eclipse“导出为可执行 jar”允许您保存具有类似功能的 ant 文件。

（*在任何这些情况下，取决于依赖库的许可证是否允许您这样做） -

# java - 我需要使用 TableLayout...我下载了 .jar...不知道如何使用它

> ID：11421724
> 
> 赞同：2
> 
> 时间：2012-07-10T20:51:04.387
> 
> 标签：java, layout

制作我的第一款游戏，它与 Advance Wars/Fire Emblem 类似。出于这个原因，神秘的布局管理器，TableLayout 看起来很简单。

我安装了罐子，现在我觉得我很容易。在 Eclipse 中与它斗争了很长时间（导致我在下面放置的结构）之后，我来到了 SO。

如何让我的类文件使用我的 jar？您看到的是一个复制粘贴的演示，没有遵循任何良好的 Java 约定。我知道这些都是禁忌。一旦我在 gridbag.java 中使用 TableLayout （我偷的例子）我将删除它并在我的实际类文件中实现它/

![这里发生了什么。](../Images/83164df2b7a4775a6bca54b167a1aa2d.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-10T21:26:29.863

第一个选项：右键单击项目名称 -> 构建路径 -> 配置构建路径，然后单击库选项卡并单击“添加外部 jars”。在文件对话框中找到你的 jar。

第二个选项（更好）：在您的项目中创建名为“libs”的文件夹，将您的 jar 复制到该文件夹​​中并执行与第一个选项相同的操作，但选择“添加 jars”而不是“添加外部 jars”。您应该能够从 libs 文件夹中添加 jar。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-10T21:34:54.030

右键单击 jar 并添加到构建路径。
然后你应该能够在类名上使用自动完成（控制+空格）来添加你的导入。
或者试试 control + 1 快速修复类名的错误

# database - Liquibase：PostgreSQL 序列类型与 Oracle 序列

> ID：11421729
> 
> 赞同：0
> 
> 时间：2012-07-10T20:51:24.497
> 
> 标签：database, postgresql, oracle11g, liquibase

我有一个使用 liquibase 定义的 PostgreSQL 模式。我使用了“SERIAL”数据类型。对于这些数据类型，数据库会在其 pg_catalog 表中创建一个具有特定名称的序列。现在我正在移植我的应用程序以支持 Oracle。我添加了一个单独的更改集来创建序列。PostgreSQL创建的序列名很大，Oracle不允许。我需要修改我的模式定义，以便两者都具有相同的序列名称。这是因为我使用的是 hibernate 并且需要在各自的 hbm 文件中指定相同的内容。

我能想到的替代方法是为 PostgreSQL 和 Oracle 设置不同的更改集。对于 PostgreSQL，它会创建表标签来生成类似于此处提到的查询 [http://www.postgresql.org/docs/8.1/static/datatype.html#DATATYPE-SERIAL]。然后是 Oracle 的另一个更改集，用于创建表和关联的序列。

我有兴趣知道这是否是实现这一目标的正确且唯一的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T21:41:49.833

在 PostgreSQL 中，您可以使用任何名称创建序列。数据类型`serial`只是简写 - 我在[这里](http://www.postgresql.org/docs/current/interactive/datatype-numeric.html#DATATYPE-SERIAL)引用手册：

```
CREATE SEQUENCE tablename_colname_seq;
CREATE TABLE tablename (
    colname integer NOT NULL DEFAULT nextval('tablename_colname_seq')
);
ALTER SEQUENCE tablename_colname_seq OWNED BY tablename.colname; 
```

因此，为您的序列使用较短的名称。或者使用较短的表名并省去麻烦。

# objective-c - 将 MKAnnotation 坐标转换为视图坐标

> ID：11421732
> 
> 赞同：3
> 
> 时间：2012-07-10T20:51:38.380
> 
> 标签：objective-c, ios, mapkit, mkannotation

当用户单击图钉（如 Zillow 应用程序）时，我正在显示自定义 UIView。现在的问题是我需要将视图放在实际引脚的正上方。MKAnnotationView 坐标系与地图相关。如何获取相对于 iPhone 屏幕的坐标，然后将视图放置在该坐标上。

```
- (void)mapView:(MKMapView *)mv didSelectAnnotationView:(MKAnnotationView *)view
{  
    // get view from storyboard 
    ZillowSearchResultAnnotation *annotation = (ZillowSearchResultAnnotation *) view.annotation;

    PropertyAbstractViewController *propertyAbstractViewController = [self.storyboard instantiateViewControllerWithIdentifier:@"PropertyAbstractIdentifier"];
    propertyAbstractViewController.view.frame = CGRectMake(0, 0, 100, 100);

    [propertyAbstractViewController bind:annotation.data];

    [mv addSubview:propertyAbstractViewController.view];

} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-10T21:22:35.050

使用[convertCoordinate:toPointToView:](http://developer.apple.com/library/ios/DOCUMENTATION/MapKit/Reference/MKMapView_Class/MKMapView/MKMapView.html#//apple_ref/occ/instm/MKMapView/convertCoordinate%3atoPointToView%3a)。就像是：

```
UIView *view = ...
CGPoint p = [mv convertCoordinate:annotation.coordinate toPointToView:mv];
CGRect frame = CGRectMake(p.x,p.y,view.frame.size.width,view.frame.size.height);
view.frame = frame;
[self.view addSubView:view]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-09-15T13:19:23.097

这是完美的，但有一个小问题。如果您对 Pin 图使用不同的图像，则需要对您的视图进行更正，将其指定到您的 Pin 图的中心。像这样

```
UIView *view = ...
CGPoint p = [mv convertCoordinate:annotation.coordinate toPointToView:mv];
CGRect frame = CGRectMake(p.x - (view.frame.size.width/2), 
                          p.y- (view.frame.size.height / 2),
                          view.frame.size.width,
                          view.frame.size.height);
view.frame = frame;
[self.view addSubView:view]; 
```

# asp.net-mvc - ASP.NET MVC - 从 SQL Server Express 切换到 Compact Edition - 连接问题

> ID：11421733
> 
> 赞同：2
> 
> 时间：2012-07-10T20:51:38.763
> 
> 标签：asp.net-mvc, entity-framework, sql-server-ce, connection-string, appharbor

我有一个 ASP.NET MVC 4 项目——**带有实体框架的 CodeFirst——**它连接到由 EF 生成的 SQL Server Express 数据库，并且运行良好。

但是，我正在尝试部署到 AppHarbor，并且在连接我的应用程序时运行的 SQL 版本存在一些问题。

所以，我注意到他们有一个使用 SQL Server Compact Edition 4 的示例项目。这是该项目的 web.config 文件： [https://github.com/friism/CodeFirstMigrations/blob/master/Web/Web。配置](https://github.com/friism/CodeFirstMigrations/blob/master/Web/Web.config)

此外，我在 Microsoft 的 ASP.NET 站点上找到了有关如何在项目中包含 SQL Server CE 数据库的教程： [http ://www.asp.net/mvc/tutorials/mvc-music-store/mvc-music-store -第 4 部分](http://www.asp.net/mvc/tutorials/mvc-music-store/mvc-music-store-part-4)

我决定`FranchiseManagerData.sdf`在我的**App_Data**文件夹中创建一个文件并修改我的连接字符串和应用程序设置以匹配他们的。这是我的 Web.config 的样子：

```
<appSettings>
    <add key="webpages:Version" value="2.0.0.0" />
    <add key="ClientValidationEnabled" value="true" />
    <add key="UnobtrusiveJavaScriptEnabled" value="true" />
  </appSettings>

  <connectionStrings>
    <add name="FranchiseManagerEntities"
         connectionString="Data Source=|DataDirectory|FranchiseManagerData.sdf"
         providerName="System.Data.SqlServerCe.4.0"/>
  </connectionStrings> 
```

当我运行我的应用程序时，我收到一个 DataException 错误，上面写着： `The underlying provider failed on Open.`

看起来正在发生的事情是应用程序仍在寻找由实体框架生成的旧数据库，该数据库具有以下名称： `FranchiseManagerTest.Models.FranchiseManagerContext`- EF 在我的数据上下文类之后命名它。

这是停止调试后显示的错误：

```
 Cannot open database "FranchiseManagerTest.Models.FranchiseManagerContext" requested by the login. The login failed.
Login failed for user 'COMPANY\UserName'. 
```

我已经尝试清理和重建解决方案。此外，我已经删除了 bin 文件夹的内容并再次进行了干净的重建，但是，它似乎仍在寻找旧的数据库连接。

我究竟做错了什么？如何让我的项目查找我创建的本地 SQL Server CE 数据库而不是以前的数据库？

如果我需要提供任何进一步的细节，请告诉我。

**提前致谢。**

* * *

## 编辑

这是我的 Web.config 文件的 System.Web 部分的一部分：

```
<compilation debug="true" targetFramework="4.0" />
<customErrors mode="Off"></customErrors>
<authentication mode="Forms">
  <forms loginUrl="~/Account/Login" timeout="2880" />
</authentication> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-10T21:16:06.350

FormsAuthentication 默认情况下不能使用 Sql CE（据我所知）。
我使用[EJ 的 SQL Server Compact 4.0 ASP.NET Membership 提供程序](http://erikej.blogspot.com/2010/08/sql-server-compact-40-aspnet-membership.html)没有任何问题。

此外，听起来您必须更新实体框架连接才能正确使用 SQL Server CE 数据库。

**更新**

从 .Net 4.5 开始，新的 SimpleMemembership Providers 和 Universl Providers 天真地支持 Sql CE。

# ruby-on-rails - call rake 系统找不到指定的文件

> ID：11421734
> 
> 赞同：0
> 
> 时间：2012-07-10T20:51:43.917
> 
> 标签：ruby-on-rails, ruby, rake

我正在使用 rake 运行一个任务的 Rails 2.3.2 应用程序。

这是我的代码的一部分：

```
 application_controller.rb

 def call_rake(task, options = {})
    options[:rails_env] ||= Rails.env
    args = options.map { |n, v| "#{n.to_s.upcase}='#{v}'" }
    system "/usr/bin/rake #{task} #{args.join(' ')} start"
  end 
```

运行线路时：

```
system "/usr/bin/rake #{task} #{args.join(' ')} start" 
```

它不运行任务并说：

```
The system cannot find the file specified. 
```

我在 Windows 上运行它并且已经不得不更改 & 开始，这是与 Windows 相关还是我遗漏了什么？

其他一些代码：

```
forbidden_file.rake

desc "Process CSV file"
task :process_file => :environment do
  forbidden_file = ForbiddenFile.find(ENV["csv"])
  forbidden_file.upload_file
end 
```

控制器

```
...
call_rake :process_file, :csv => params[:files]
redirect_to forbidden_files_url
... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T21:09:43.107

是的，与 Windows 相关，在 Windows rake 位置中类似于`c:\ruby\ruby192\bin\rake`. 如果您想独立于平台，请不要使用绝对路径来调用命令。

要从控制器运行任务，请使用：

```
%x[rake name_task] 
```

或其他方式：

```
require 'rake'

Rake::Task.clear #clears tasks loaded in dev mode
YourApplicationName::Application.load_tasks # put your application name

class RakeController < ApplicationController

  def call_rake(task, options = {})
    Rake::Task[task].reenable # if you going to invoke the same task second time.
    Rake::Task[task].invoke(options)
  end

end 
```

# python - int 到二进制 python

> ID：11421735
> 
> 赞同：0
> 
> 时间：2012-07-10T20:51:47.193
> 
> 标签：python, networking, binary, int

这个问题对你们大多数人来说可能很容易，但到目前为止我找不到答案。

我正在构建一个像这样的网络数据包生成器：

```
class PacketHeader(Packet):
fields = OrderedDict([
    ("head", "\x00"),
    ("headpad", "\x00"),
    ("headlen", "\x1a\x00" ),
    ("presentflag", "\x2e"),
    ("timestamp", "\x43\x10\x58\x16\xa1\x01\x00\x00"),
    ("flag", "\x03"),
    ("Sequencenum", "\x04\x00"),

]) 
```

后来，我打电话给我的班级并像这样发送数据包：

```
send(PacketHeader(Sequencenum=257))
send(PacketHeader(Sequencenum=258))
send(PacketHeader(Sequencenum=259)) 
```

不幸的是，在电线上我有`\x32\x35\x37`（257 in `hex`）而不是这个：`\x01\x01`。

我想做的是能够：

```
send(PacketHeader(Sequencenum=257+1)) 
```

并在电线上正确转换为 int

提前致谢 ！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-10T20:55:57.117

如果您想将`int`任何其他原始数据类型转换为二进制，那么该`struct`模块可能会帮助您。

[http://docs.python.org/library/struct](http://docs.python.org/library/struct)

```
>>> import struct
>>> struct.pack('>i', 257)
'\x00\x00\x01\x01'
>>> struct.pack('<i', 257)
'\x01\x01\x00\x00'
>>> struct.unpack('<i', '\x01\x01\x00\x00')
(257,)
>>> struct.unpack('>i', '\x00\x00\x01\x01')
(257,) 
```

`ms4py`提到你可能想要转换 2 字节整数，所以：

```
>>> struct.pack('>h', 257)
'\x01\x01'
>>> struct.unpack('>h', '\x01\x01')
(257,)
>>> 
```

哦，还有：

```
>>> struct.unpack('>h', '\x10\x00')
(4096,)
>>> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T20:57:31.983

如果你有一个整数并且想要十六进制：

```
hex(257)
'0x101' 
```

其他方式

```
int('0x101', 16)
257 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-10T21:03:00.877

在我看来，你想要一个整数到二进制转换器。

如果是这样的话，那么这应该工作：

```
def convert(N):
    if not N:
        return ''
    else:
        return "%s%s" %(convert(N/2), N%2) 
```

希望这可以帮助

# objective-c - 将对象类型存储在变量中然后初始化

> ID：11421737
> 
> 赞同：0
> 
> 时间：2012-07-10T20:51:50.637
> 
> 标签：objective-c, class, variables, pointers

Objective-C 中是否有办法将对象/类存储在变量中以传递给其他地方的 alloc/init？

例如：

```
UIViewController = foo
foo *bar = [[foo alloc] init] 
```

我正在尝试创建一个系统来根据当前视图控制器在单独的类中动态创建导航按钮。我可以将“self”传递给方法，但结果变量不允许我分配/初始化。我总是可以直接导入 .h 文件，但理想情况下，我希望尽可能简单地重用代码。也许我会以错误的方式解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-10T21:07:28.260

不确定是否理解您的问题，但如果您尝试创建与另一个实例相同的类的新实例，您可以执行以下操作：

```
id foo; // an actual instance of any class

id bar = [[[foo class] alloc] init]; // another instance 
```

如果 foo 未声明为`id`，您甚至可以使用快捷方式：`[[foo.class alloc] init]`甚至更短的：`[foo.class new]`。

您还可以使用类对象：

```
id foo;
Class fooClass = [foo class];

id bar = [[fooClass alloc] init]; 
```

或者类名：

```
id foo;
NSString* fooClassName = NSStringFromClass( [foo class] );

id bar = [[NSClassFromString( fooClassName ) alloc] init]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-10T21:10:15.720

假设您将要创建的类名存储为`NSString`

你可以试试： `id bar = [[NSClassFromString(foo) alloc] init]`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-10T21:12:36.200

是的，只需制作 type 的变量`Class`。要为其分配一个命名类，您可以这样做：

```
Class foo = [UIViewController class]; 
```

或者如果类名是一个动态选择的字符串（嘿，它发生了），你会这样做：

```
NSString *className = @"UIViewController";
Class foo = NSClassFromString(className); 
```

# java - Integers.parseint（在扫描仪输入上），我也想限制，所以用户只能输入 0 到 100 范围内的数字

> ID：11421739
> 
> 赞同：1
> 
> 时间：2012-07-10T20:51:52.530
> 
> 标签：java, parsing, integer, java.util.scanner

大家好，我这里有一点问题，首先我想将来自扫描仪的字符串解析为 int，这样我以后可以使用它的 IF 语句。代码看起来像这样

```
List<String> list = new ArrayList<String>();
    Scanner numbers = new Scanner(System.in);

    do {
        System.out.println("Current list is " + list);
        System.out.println("Add more? (y/n)");

        if (numbers.next().startsWith("y")) 
        {
            if(Integer.parseInt(numbers)> 0 && Integer.parseInt(numbers) < 101)
            {// i get error on above line, and im kinda lost here

                System.out.println("Enter : ");
                list.add(numbers.next());
            }
        }
        else
        {            
            break;                
        }           
    }while (true); 
```

任何帮助表示赞赏，希望我清楚自己的问题和我的问题

编辑：

```
 do {

        System.out.println("Current list is " + list);
        System.out.println("Add more? (y/n)");

        if (numbers.next().startsWith("y")) 
        {                               
            System.out.print("Enter: "); 
            System.out.flush();                
            final int n = Integer.parseInt(numbers.next());
            if (n > 0 && n < 101) 
            {
                list.add(n);
                // this is where i get the error.

                //no suitable method found for add(int)
                // method java.util.List.add(int,java.lang.String) is not applicable
                // (actual and formal arguments lists differ in length)
                // method java.util.List.add(java.lang.String) is not applicable
                // (actual argument int cannot be converted to java.lang.String 
                // by method invocation conversion).

                // end of log
            }
            else
            {
                System.out.println("Number you have entered exceeds raange between 0-100");
            } 
        }
        else
        {            
            break;                
        }           
    }while (true); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T20:53:50.980

我想你想写

```
System.out.print("Enter: "); System.out.flush();
final int n = Integer.parseInt(numbers.next());
if (n > 0 && n < 101) list.add(n); 
```

`java.util.Scanner`还包含该方法`nextInt`，从而消除了对`Integer.parseInt`. 你可以说`numbers.nextInt()`。

您还需要将您的列表声明从 更改`List<String>`为`List<Integer>`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T20:54:32.537

您正在尝试将非整数（字符串）解析为`NumberFormatException`在输入为非整数的情况下抛出的整数。

```
int n=0;

try
{
n = Integer.parseInt(numbers.next());
}catch(Exception e)
{
}

if(n > 0 && n<101)
{
//your logic
} 
```

# c - 将物理地址映射到模拟系统的内核空间中的虚拟地址

> ID：11421740
> 
> 赞同：2
> 
> 时间：2012-07-10T20:51:52.977
> 
> 标签：c, linux, kernel, mmap, qemu

我正在使用基于 QEMU 的 x86 模拟器 MARSSx86 做一些工作。我正在尝试在来宾操作系统和模拟器之间发送一些数据。通常，这是通过使用开发人员提供的库来处理的，该库写入内存中为此类通信保留的特殊区域。但是，我正在尝试在内核空间中执行此操作，而库依赖于执行 mmap，这显然行不通。据我了解，我需要做的就是访问一个已知的物理地址并在那里写入一些数据。

我对内存操作非常陌生，尤其是在内核中，但我觉得这应该是直截了当的。我相信我可以只使用 ioremap，但它没有提供我理解的可用虚拟地址，这是实现代码所需要的。为了让事情更清楚，这里是设置映射的代码：

```
#define bits(x, i, l) (((x) >> (i)) & bitmask(l))
#define LO32(x) (W32)((x) & 0xffffffffLL)
#define bitmask(l) (((l) == 64) ? (W64)(-1LL) : ((1LL << (l))-1LL))

static int ptlsim_check_status __attribute__((common)) = 0;
static W64 supported_ptlcall_methods __attribute__((common)) = 0;
static int selected_ptlcall_method __attribute__((common)) = -1;
static W64 ptlcall_mmio_page_physaddr __attribute__((common)) = 0;
static W64* ptlcall_mmio_page_virtaddr __attribute__((common)) = NULL;
static W16 ptlcall_io_port __attribute__((common)) = 0;

static int ptlsim_ptlcall_init() {
  W32 rax = PTLSIM_CPUID_MAGIC;
  W32 rbx = 0;
  W32 rcx = 0;
  W32 rdx = 0;
  int ptlcall_mmio_page_offset;
  static const char* mmap_filename = "/dev/mem";

  // a.k.a. cpuid(PTLSIM_CPUID_MAGIC, rax, rbx, rcx, rdx);
  asm volatile("cpuid" : "+a" (rax), "+b" (rbx), "+c" (rcx), "+d" (rdx) : : "memory");

  if (rax != PTLSIM_CPUID_FOUND) {
    ptlsim_check_status = -1;
    return 0;
  }

  supported_ptlcall_methods = rbx;
  ptlcall_mmio_page_physaddr = (bits(rdx, 0, 16) << 32) | LO32(rcx);
  ptlcall_mmio_page_offset = (ptlcall_mmio_page_physaddr & 0xfff);
  ptlcall_mmio_page_physaddr &= ~0xfff;
  ptlcall_io_port = bits(rdx, 16, 16);

  if (supported_ptlcall_methods & PTLCALL_METHOD_MMIO) {
    // We use O_SYNC to guarantee uncached accesses:
    int fd = open(mmap_filename, O_RDWR|O_LARGEFILE|O_SYNC, 0);

    if (fd < 0) {
      fprintf(stderr, "ptlsim_ptlcall_init: cannot open %s for MMIO to physaddr %p (%s)\n",
      mmap_filename, (void*)ptlcall_mmio_page_physaddr, strerror(errno));
      supported_ptlcall_methods &= ~PTLCALL_METHOD_MMIO;
      ptlsim_check_status = -2;
      return 0;
    }

    ptlcall_mmio_page_virtaddr = (W64*)mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_SHARED, fd, ptlcall_mmio_page_physaddr);

    if (((int)(Waddr)ptlcall_mmio_page_virtaddr) == -1) {
      fprintf(stderr, "ptlsim_ptlcall_init: cannot mmap %s (fd %d) for MMIO to physaddr %p (%s)\n", mmap_filename, fd, (void*)ptlcall_mmio_page_physaddr, strerror(errno));
      supported_ptlcall_methods &= ~PTLCALL_METHOD_MMIO;
      ptlsim_check_status = -3;
      close(fd);
      return 0;
    }

    // Adjust the pointer to the actual trigger word within the page (usually always offset 0)
    ptlcall_mmio_page_virtaddr = (W64*)(((Waddr)ptlcall_mmio_page_virtaddr) + ptlcall_mmio_page_offset);

    close(fd);

    selected_ptlcall_method = PTLCALL_METHOD_MMIO;
    fprintf(stderr, "ptlsim_ptlcall_init: mapped PTLcall MMIO page at phys %p, virt %p\n", (void*)ptlcall_mmio_page_physaddr, (void*)ptlcall_mmio_page_virtaddr);
  }

  ptlsim_check_status = +1;

  return 1;
} 
```

这是设置完成后进行实际通信的代码（为了简洁起见，我显然在这里留下了很多内容，但如果缺少重要的东西，请告诉我，我可以编辑它）：

```
static inline W64 ptlcall_single(const char* command, int flush) {
  struct  PTLsimCommandDescriptor desc;
  desc.command = (W64)command;
  desc.length = strlen(command);

  return ptlcall(PTLCALL_ENQUEUE, (W64)&desc, 1, flush, 0, 0, 0);
}

static inline W64 ptlcall(W64 op, W64 arg1, W64 arg2, W64 arg3, W64 arg4, W64 arg5, W64 arg6) 
{
  if (!is_running_under_ptlsim())
    return (W64)(-ENOSYS);

  if (selected_ptlcall_method == PTLCALL_METHOD_MMIO) {
    return do_ptlcall_mmio(op, arg1, arg2, arg3, arg4, arg5, arg6);
  } else
    return (W64)(-ENOSYS);
}

static inline W64 do_ptlcall_mmio(W64 callid, W64 arg1, W64 arg2, W64 arg3, W64 arg4, W64 arg5, W64 arg6)
{
  W64 rc;
  asm volatile ("movq %[arg4],%%r10\n"
            "movq %[arg5],%%r8\n"
            "movq %[arg6],%%r9\n"
            "mfence\n"
            "smsw %[target]\n"
            : "=a" (rc),
              [target] "=m" (*ptlcall_mmio_page_virtaddr)
            : [callid] "a" (callid),
              [arg1] "D" ((W64)(arg1)),
              [arg2] "S" ((W64)(arg2)),
              [arg3] "d" ((W64)(arg3)),
              [arg4] "g" ((W64)(arg4)),
              [arg5] "g" ((W64)(arg5)),
              [arg6] "g" ((W64)(arg6))
            : "r11","rcx","memory" ,"r8", "r10", "r9");
  return rc;
} 
```

基本上，我想把所有这些代码放在内核中，然后重写第一块代码中的内存操作，以便第二块代码可以不加修改地运行。根据我的发现，我觉得 remap_pfn_range 可能是我需要的功能，但我不知道如何在这种情况下使用它。我意识到这很多，所以即使他们没有回答整个问题，任何指针都会受到赞赏。

# mysql - MySQL WHERE：如何写“！=”或“不等于”？

> ID：11421741
> 
> 赞同：104
> 
> 时间：2012-07-10T20:51:55.167
> 
> 标签：mysql, sql-delete

我需要这样做

```
DELETE FROM konta WHERE taken != '' 
```

但是 != 在 mysql 中不存在。有人知道怎么做吗？

* * *

## 回答 #1

> 赞同：160
> 
> 时间：2012-07-10T20:53:13.333

```
DELETE FROM konta WHERE taken <> ''; 
```

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2012-07-10T20:56:10.953

! [= 运算符](http://dev.mysql.com/doc/refman/5.0/en/comparison-operators.html#operator_not-equal)肯定存在！它是标准`<>`运算符的别名。

也许您的字段实际上不是空字符串，而是`NULL`？

要进行比较，`NULL`您可以使用`IS NULL`or`IS NOT NULL`或[null 安全等于运算符`<=>`](http://dev.mysql.com/doc/refman/5.0/en/comparison-operators.html#operator_equal-to)。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2015-07-27T06:06:26.043

您可能使用的是旧版本的 Mysql，但您肯定可以使用

```
 DELETE FROM konta WHERE taken <> '' 
```

但是还有许多其他选项可用。你可以试试下面的

```
DELETE * from konta WHERE strcmp(taken, '') <> 0;

DELETE * from konta where NOT (taken = ''); 
```

# javascript - 如何增加 highchart.js 图表上 x 轴标签区域的高度？

> ID：11421748
> 
> 赞同：6
> 
> 时间：2012-07-10T20:52:18.320
> 
> 标签：javascript, css, highcharts

我有一个由 highcharts.js 创建的简单折线图。我在 x 轴 (30) 上有很多刻度线，所以我将 stagger 设置为 2 以处理水平相互重叠的标记。但是，图表末尾的 x 轴刻度标签的下一行被截断。

无论我将图表制作多高，x 轴刻度线标签的下一行都会被切断。我怎样才能增加这个区域的高度来解决这个问题？还是有其他方法？

```
month_chart = new Highcharts.Chart({
chart: {
    borderRadius: 0,
    height: chart_height,
    marginRight: 30,
    marginBottom: 25,
    renderTo: 'leads-by-month',
    type: 'line',
},
title: {
    text: 'Past 30 Days',
},
xAxis: {
    categories: [<?php print $bymonth_categories; ?>],
    labels: {
        staggerLines: 2,
    },
},
yAxis: {
    title: {
        text: 'Leads',
        style: {color: '#3d3e41', }
    },
    plotLines: [{
        value: 0,
        width: 1,
        color: '#808080'
    }],
    min: 0,
},
plotOptions: {
    line: {
        color: '#578df1',
        dataLabels: {
            enabled: true,
            color: '#3d3e41',
        },
        enableMouseTracking: false
    }
},
legend: {
    layout: 'vertical',
    align: 'right',
    verticalAlign: 'top',
    x: -100,
    y: 74,
    floating: true,
    borderWidth: 1,
    backgroundColor: '#FFFFFF',
    shadow: true
},
series: [{
    name: '<?php print $organization['name']; ?>',
    data: [<?php print $bymonth_data; ?>]
}]
        }); 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-10T23:35:26.627

只需提高[marginBottom](http://api.highcharts.com/highcharts#chart.marginBottom)选项。默认值为 70，这对于 2 行刻度标签应该足够了，但您已将其设置为 25，但不是。

# iphone - 获取无效的上下文错误

> ID：11421749
> 
> 赞同：1
> 
> 时间：2012-07-10T20:52:20.673
> 
> 标签：iphone, objective-c, ios, core-graphics

到目前为止，我没有太多代码，只有这个开始：

```
UIGraphicsBeginImageContextWithOptions(bounds.size, NO, 0);

    CGContextRef context = UIGraphicsGetCurrentContext();
CGMutablePathRef outerPath;

CGMutablePathRef highlightPath;

CGRect outerRect = rectForRectWithInset(bounds, 1); 

CGRect highlightRect = CGRectMake(outerRect.origin.x,
                                      outerRect.origin.y + 1,
                                      outerRect.size.width,
                                      outerRect.size.height); 
```

然后是有问题的位，当被注释掉时，错误就消失了：

```
CGContextSaveGState(context);

CGContextAddPath(context, highlightPath);
CGContextSetFillColorWithColor(context, [[UIColor colorWithWhite:1.0 alpha:0.05]CGColor]);
CGContextFillPath(context);

CGContextRestoreGState(context); 
```

下面是简单的：

```
UIImage *image = UIGraphicsGetImageFromCurrentImageContext();

    UIGraphicsEndImageContext(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T21:12:46.967

似乎边界 0,0,0,0 或 highlightPath 有问题。这些价值观从何而来？

# wcf - 从 Asp.net WebApi 使用 WCF 服务

> ID：11421750
> 
> 赞同：4
> 
> 时间：2012-07-10T20:52:22.170
> 
> 标签：wcf, asp.net-web-api

我正在为我们的服务创建一个 Asp.net Webapi。另一方面，我必须从现有的 WCF 服务中提取一些数据。

我正在我的 asp.net webapi 项目中创建一个 Web 引用。但似乎没有生成代理。

我尝试使用 VS 2012 RC，然后使用 VS 2010。我无法在项目中的任何位置从我的模型/控制器中引用它。在 MVC webapi 中创建代理是否有不同的方法。我不知道出了什么问题。

它是否必须做一些事情，比如我不能从休息服务中消费 wcf 服务

我在这里缺少什么。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T10:43:32.087

尝试添加服务引用而不是 Web 引用，后者用于已弃用的 ASP.NET Web 服务 (ASMX)。

我刚试过这个，它按预期工作。这是我所做的：

1.  创建了一个新的 ASP.NET MVC 4 Web 应用程序并选择了 Web API 项目模板。
2.  向解决方案添加了 WCF 服务应用程序项目。请记住在添加服务引用之前构建它。
3.  在 Web APi 项目中，我添加了对 WCF 服务的服务引用。
4.  将 ValuesController.Get(int id) 中的代码替换为

    ```
    public string Get(int id)
    {
        var serviceReference1 = new ServiceReference1.Service1Client();
        return serviceReference1.GetData(id);
    } 
    ```

浏览时

```
http://localhost:<port>/api/values/2 
```

我收到

```
<?xml version="1.0" encoding="utf-8"?><string>You entered: 2</string> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-06T06:20:33.080

如果添加了您的服务引用，但 reference.cs 生成为空，则可能是类型冲突的问题。以下解决方法对我有用。

要更正它，请右键单击服务引用，单击配置服务引用。在配置屏幕上，取消选中“在引用的程序集中重用类型”。如果没有强制更新，它应该自动更新服务引用。

这应该会适当地生成 reference.cs 文件。

# windows - maven 301 永久移动

> ID：11421752
> 
> 赞同：3
> 
> 时间：2012-07-10T20:52:23.263
> 
> 标签：windows, linux, apache, maven, command-line

每次我在我构建的任何项目上运行 mvn clean install 时，我总是会遇到 5-6 个包含以下内容的 pom 文件：

```
<html>
<head><title>301 Moved Permanently</title></head>
<body bgcolor="white">
<center><h1>301 Moved Permanently</h1></center>
<hr><center>nginx/0.6.39</center>
</body>
</html> 
```

这也意味着这个 jar 文件只有 1 KB，里面什么都没有。我可以通过访问 search.maven.org 并找到 pom 和 .jar 并重新下载两者来解决此问题。这个问题有解决方案吗？我讨厌每次都这样做。在我的 linux 环境中，我看不到这个问题，但在 Windows 上，它看起来比正常情况更多。谢谢，史蒂夫。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T07:46:33.977

看起来您的某个存储库无法正常工作。特别是消息 nginx 意味着您不使用存储库管理器。如果您在代理后面，那可能是问题所在。

# objective-c - “-Weverything”产生“将浮点数与 == 或 != 进行比较是不安全的”

> ID：11421756
> 
> 赞同：27
> 
> 时间：2012-07-10T20:52:37.033
> 
> 标签：objective-c, cocoa, llvm, clang

我有一个字符串，可以像这样转换为双精度：

```
double d = [string doubleValue]; 
```

的文档`doubleValue`告诉我们，在溢出时，此方法返回`HUGE_VAL`or `-HUGE_VAL`。这就是我之前检查的方式：

```
if (d == HUGE_VAL || d == -HUGE_VAL)
   //overflow 
```

现在，由于添加了新的“-Weverything”警告标志，编译器现在抱怨

```
Comparing floating point with == or != is unsafe 
```

我该如何解决这个问题？我**应该**如何进行这些比较？

* * *

关于比较两个“正常”浮点数（即不是“HUGE_VAL”），我也有同样的问题。例如，

```
double a, b;
//...
if (a != b) //this will now yield the same warning
  //... 
```

这应该如何解决？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-07-10T21:30:18.573

您无需担心此警告。在很多情况下，包括您的情况，这都是无稽之谈。

的文档`doubleValue`并没有说它返回的东西足够接近`HUGE_VAL`或`-HUGE_VAL`溢出。它说它会在溢出的情况下准确地返回这些值。

换句话说，在溢出的情况下方法返回的值`==`与`HUGE_VAL`or比较`-HUGE_VAL`。

**为什么警告首先存在？**

考虑这个例子`0.3 + 0.4 == 0.7`。此示例的计算结果为 false。人们，包括您遇到的警告的作者，都认为浮点`==`是不准确的，而意想不到的结果来自这种不准确。

他们都错了。

浮点*加法*是“不准确的”，从某种意义上说是不准确的：它为您请求的操作返回最接近的可表示浮点数。在上面的示例中，转换（从十进制到浮点）和浮点加法是导致奇怪行为的原因。

另一方面，浮点*相等的工作方式与其他离散类型的工作方式几乎完全相同。*浮点相等是精确的：除了少数例外（NaN 值和 +0\. 和 -0\. 的情况），当且仅当所考虑的两个浮点数具有相同的表示时，相等才计算为真。

您不需要 epsilon 来测试两个浮点值是否相等。而且，正如[Dewar 所说的那样](http://gcc.gnu.org/ml/gcc/2001-08/msg00853.html)，示例中的警告`0.3 + 0.4 == 0.7`应该是 on `+`，而不是 on `==`，这样警告才有意义。

最后，与 epsilon 内的比较意味着不相等的值看起来相等，这不适用于所有算法。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-07-10T22:23:26.990

在这种情况下，请尝试使用`>=`and `<=`。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2016-08-22T13:39:41.190

如果你确定你的比较并且你想让它发出叮当声，在你的代码周围加上：

```
#pragma clang diagnostic push
#pragma clang diagnostic ignored "-Wfloat-equal"
/* My code triggering the warnings */
#pragma clang diagnostic pop 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-11-01T14:31:48.083

对于这个非常简单的用例可能不需要，但这里有一个示例，说明如果您尝试检查数字是否等于 -1，您将如何解释潜在的差异：

```
#include <float.h>
#include <math.h>

int main(void) {
  float sales = -1;

  // basically if sales == -1
  if (fabs(1 + sales) < FLT_EPSILON) {
    return 0;
  }
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-07-10T21:04:10.517

由于浮点类型不准确，浮点数不应与 == 或 != 进行比较，这可能会在使用这些运算符时导致意外错误。您应该测试浮动是否位于彼此的距离内（大多数情况下称为“Epsilon”）。

它可能看起来像这样：

```
const float EPSILON = 1.0f; // use a really small number instead of this

bool closeEnough( float f1, float f2)
{
    return fabs(f1-f2)<EPSILON; 
    // test if the floats are so close together that they can be considered equal
} 
```

# django - 将额外的上下文传递给 Django Haystack 模板

> ID：11421760
> 
> 赞同：2
> 
> 时间：2012-07-10T20:53:00.733
> 
> 标签：django, get, django-forms, django-haystack

使用 Django Haystack 设置搜索页面需要放入他们的 URLconf 片段`url(r'^search/', include('haystack.urls'))`。然而，这意味着（至少从我对 Django/MVC 极其基本的理解来看），没有简单的方法可以传递额外的上下文（即额外的字典键/值）以呈现到页面上。

特别是，我想自定义一个搜索字段来镜像从 GET 请求传递到页面的变量：

```
<form method="get" action=".">
<input type="text" name="q" value="">
<!-- result html here -->
</form> 
```

假设参数`?q=twitter`作为 GET 请求的一部分附加到 URL；我想让`value`选择器等于`twitter`. 如果我可以控制视图，我可能会这样做：

```
if request.method == 'GET':
    q = request.GET['q']
    return render(request, 'template.html', {'q': q}) 
```

然后用作HTML 中选择器`q`的值。`value``<input>`

除了编辑 Haystack 源代码之外，还有什么方法可以简单地完成此任务？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-03T10:24:54.723

您可以对 Haystack 视图进行**子类**化以添加到上下文中：

在您的搜索应用程序中创建一个`views.py`文件（如果您没有）。然后确保导入 Haystack 视图。然后你可以像这样创建一个子类：

```
import haystack.views

class SearchView(haystack.views.SearchView):
    """
    We subclass the base haystack view in order to add context.
    """

    def extra_context(self):
        return {
            'yourValue': yourValue,
        } 
```

`urls.py`不要忘记在 Search 应用程序中更改视图的路径：

```
from yourSite.apps.search.views import SearchView 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-13T23:21:26.483

使用自定义上下文处理器完成此操作：

```
from django.template import RequestContext
from django.http import HttpResponse

def get_search_query(request):
    search_query = request.GET.get('q', '')
    print search_query
    return {
        'search_query':search_query
    } 
```

然后，只需调用`{{ search_query }}`任何 HTML 模板。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-21T23:21:46.027

Haystack 已经将查询传递给您。模板变量称为查询：

```
<div>Your query was {{ query }}</div> 
```

如果你在上下文中仍然需要更多的东西，那么你必须使用 basic_search 方法。您必须创建视图并调用 basic_search。所以，在views.py中：

```
from haystack.views import basic_search

def yourview(request):
    ...
    return basic_search(request, extra_context={ 'foo': 'boo', }) 
```

如果需要，您可以设置更多参数：

```
basic_search(request, template='search/search.html', load_all=True, form_class=ModelSearchForm, searchqueryset=None, context_class=RequestContext, extra_context=None, results_per_page=None) 
```

奇怪的是，除了 extra_context 之外，所有这些都可以直接使用 URL 中的 SearchView() 调用。在 urls.py 中：

```
from haystack.views import SearchView
...
url(r'^$', SearchViewtemplate='path/to/your/template', load_all=True, form_class='YouForm', searchqueryset=AQuerySet, context_class=RequestContext, results_per_page=10), name='the_name_you_want') 
```

不需要任何参数。事件

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-08-27T16:00:23.660

如果您使用的是基于 generic_views 的新 SearchView，`haystack.generic_views.SearchView`那么您需要将其移动到`get_context_data`函数中，而不是`extra_context`这里提到的 [https://django-haystack.readthedocs.io/en/v2.4.1/views_and_forms.html#upgrading](https://django-haystack.readthedocs.io/en/v2.4.1/views_and_forms.html#upgrading)

示例：下面我将拼写建议添加到上下文字典

```
from haystack.generic_views import SearchView

# Custom view.
class MySearchView(SearchView):

    template_name = 'search/search.html'
    queryset = SearchQuerySet().all()
    form_class = SearchForm  

    def get_context_data(self, *args, **kwargs):
        context = super(MySearchView, self).get_context_data(*args, **kwargs)

        # Add any additional context data we need to display in forms
        spell_suggestion = self.get_form().get_suggestion()
        context['spell_suggestion'] = spell_suggestion

        return context 
```

然后可以访问此上下文`search.html`变量`{{ spell_suggestion }}`

希望能帮助到你 ：）

# c# - OnSerializing/OnSerialized 方法并不总是被调用

> ID：11421761
> 
> 赞同：11
> 
> 时间：2012-07-10T20:53:01.093
> 
> 标签：c#, serialization, binaryformatter

这是我在项目中序列化的结构：

```
[Serializable]
class A : List<B> //root object being serialized

[Serializable]
class B
  + [A few serializable fields]
  + C customList

[Serializable]
class C : List<D>

[Serializable]
class D
  + [several serializable fields]
  |
  + [NonSerialized] nonserializable3rdPartyClass data
  + string xmlOf3rdPartyData
  |
  + [OnSerializing]
  + private void OnSerializing(StreamingContext context)
  |
  + [OnSerialized]
  + private void OnSerialized(StreamingContext context)
  |
  + [OnDeserialized]
  + private void OnDeserialized(StreamingContext context) 
```

`nonserializable3rdPartyClass`虽然没有标记为，但`[Serializable]`提供了我在我的和`.ToXml`方法中使用的方法 ，分别用于在 中存储和检索 XML 字符串。`.FromXml``.OnSerializing``.OnDeserialized``xmlof3rdPartyData`

我最近遇到了一个问题，在某些未知情况下（到目前为止，我只能使用来自客户的序列化数据文件重现该问题，该客户首先报告了该问题），我的`.OnSerializing`和`.OnSerialized`方法仅被称为 57 /160 次（其中 160 是结构中对象的总数`D`），当使用 a`BinaryFormatter`序列化到文件时，留下 103 个设置为 的`D`对象。使用[此处](https://stackoverflow.com/questions/800031/efficient-cloning-of-cached-objects)描述的方法克隆结构时（这与我用来序列化到文件的方法基本相同），我看到/的结果相同，但我的方法被调用了 160 次。`xmlOf3rdPartyData``null``.OnSerializing``.OnSerialized``.OnDeserialized`

这段代码已经使用了几个月没有问题（至少据我所知），我仍在试图确定为什么现在而不是更早发生这种情况。在调试时我没有看到任何第一次机会异常，而且我在方法开始时的断点根本没有被击中超过 57 次。关于为什么会发生这种情况/如何解决它的任何想法？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-13T01:09:09.817

经过几天的挖掘，我发现问题既是我的错，也可能是 .NET Framework 中的错误。

## .NET 问题的一半

在我的方法的堆栈跟踪中四处寻找`OnSerializing`时，我遇到了in 中的`RegisterObject`方法`System.Runtime.Serialization.SerializationObjectManager`，它决定是否调用`OnSerializing`正在序列化的对象中的任何方法。它以两种方式确定这一点（这是基于 .NET Reflector 的反编译代码）：

1.  该类是否有任何`OnSerializing`方法可以调用
2.  这是一个以前看不见的对象吗（在此调用中`BinaryFormatter.Serialize`）

2号是问题儿童。它通过将对象/布尔对存储在 a 中来跟踪已经看到的对象`Hashtable`（当然，它使用`GetHashCode`）。如果其中任何一个为假，则**不会**调用对象的`OnSerializing`方法。这显然在绝大多数情况下都可以正常工作（否则微软会在某个时候修复它，对吗？），除了我似乎偶然发现的那个。

 **## 我的一半问题

很简单，我忘记在我`GetHashCode`的`D`课程中包含不可序列化的字段，所以我遇到了冲突。愚蠢的错误，我知道，不知道我是怎么错过的。

## 可是等等...

...这是否意味着这根本不是 .NET 的错，只是我自己的错？不，这就是原因。无论如何，我希望`OnSerializing`和方法在 100% 的时间内被调用。`OnSerialized`文档中没有其他地方另有说明。如果没有发生这种情况，我的对象没有正确序列化，我最终花费的时间比我想要解决的奥秘要多得多。即使故意序列化两个相同的对象，它们显然最终也不会指向 中的相同二进制数据/位置`Stream`，因此它们不会反序列化相同的对象。**我认为这是一个错误，而不是一个功能。**

我已经编写了一个[测试用例](http://pastebin.com/1DMDATvt)来演示这一切。如果我做错了什么，我会很感激这样说的反馈，否则我可能会将其发布在 MSDN 论坛上或作为 Connect 错误。在任何人提出建议之前，由于在 SO 其他地方发布的所有各种原因，我已经计划离开`BinaryFormatter`一段时间了，我只是有更重要的事情要处理。

**编辑**：显然[这个错误](http://connect.microsoft.com/VisualStudio/feedback/details/631223/binary-serialization-omits-calls-to-the-onserializing-custom-serialization-callback-when-there-are-equal-subobjects)是一年半前提交的。**

# jquery - jQuery单击变量范围问题

> ID：11421764
> 
> 赞同：0
> 
> 时间：2012-07-10T20:53:32.037
> 
> 标签：jquery

我用我遇到的一个问题设置了这个小提琴。我需要脚本来隐藏动画完成后单击的按钮。这样做的正确方法是什么？

[http://jsfiddle.net/digitalaxis/utJKU/](http://jsfiddle.net/digitalaxis/utJKU/)

HTML：

```
<div>
    <a id='button1' href="#">Button 1</a>
    <a id='button2' href="#">Button 2</a>
    <a id='button3' href="#">Button 3</a>
    <a id='button4' href="#">Button 4</a>
    <a id='button5' href="#">Button 5</a>
</div>
<div id="box">
    Some element
</div> 
```

JS：

```
$('a[id^="button"]').click(function() {    
    $('#box').hide('slow', function() {        
        $('a').hide('slow');
    });
}); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-10T20:56:01.287

在接收位置设置一个全局变量`$(this)`，并在回调中使用，如下所示：

```
$('a[id^="button"]').click(function() {
   var $this = $(this);
   $('#box').hide('slow', function() {
        $this.hide('slow');
   });
});​ 
```

# c# - DataGridView 绑定到 Access 数据库问题

> ID：11421765
> 
> 赞同：0
> 
> 时间：2012-07-10T20:53:43.370
> 
> 标签：c#, datagridview, datatable, bindingsource, dataadapter

我有一个绑定到 Acces 数据库的 DataGridView。如果我直接在 DataGridView 中进行编辑，我可以很好地更新数据库，但是如果我使用类似的东西：

```
dgView.Rows[0].Cells[1].Value = "Some text"; 
```

它将在第 0 行的第一个单元格中写入文本，但是当我调用时：

```
dAdapter.Update(dTable); 
```

它不会更新数据库。相反，旧值被保留。如果我自己编辑了代码并通过双击单元格并输入它来编写“一些文本”，它会更新得很好。我知道这是一个问题，但实际上我不知道它是什么。

请帮忙，我真的需要完成这件事（这是学校的一个项目）。如果您需要帮助我，请问我任何其他问题。提前致谢。

瓦利

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T22:12:07.947

这里的问题是，当您以编程方式更新 DataGridView 时，不会通知 DataGridView 的底层数据源（您的 DataTable）它已更改 - 所以只是 UI 更改，而不是您的数据源。

您可以使用[DataGridView.BeginEdit](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.beginedit.aspx)方法来触发这些事件，如下所示：

```
dgView.BeginEdit(false);
dgView.Rows[0].Cells[1].Value = "Some text"; 
dgView.EndEdit(); 
```

与其尝试像您一样通过 DataGridView 以编程方式更新您的 DataTable，更好的方法是直接更新您的 DataTable。

# java - 鼠标输入了一个 JUNG2 顶点

> ID：11421768
> 
> 赞同：0
> 
> 时间：2012-07-10T20:53:51.670
> 
> 标签：java, mouse, jung

当我将鼠标悬停在 JUNG2 中的顶点上时，我正在寻找将自定义组件显示为弹出窗口的“正确”方式。

这个问题本质上是一样的

[Jung2：如何实现鼠标悬停在节点上时显示节点的详细信息？](https://stackoverflow.com/questions/7075713)

但是那个人似乎对一个简单的工具提示弹出窗口很满意，而我却不是。

注意：我目前正在使用[PluggableGraphMouse](http://jung.sourceforge.net/doc/api/edu/uci/ics/jung/visualization/control/PluggableGraphMouse.html)的实现和一个`MouseMotionListener`类似这样的插件（我有`Note`对象作为顶点）：

```
 @Override
    public void mouseMoved(MouseEvent e) {
        Note note = graphVisualiser.getPickSupport().getVertex(getGraphLayout(), e.getX(), e.getY());
        if (note != null && note != lastMouseOverNote) {
            lastMouseOverNote = note;
            // my handling code here
        }
    } 
```

当我将鼠标悬停在一个顶点上时它可以工作，我也可以在上面展开以在鼠标离开时关闭弹出窗口，但我担心这种方法效率非常低：它本质上是检查我是否在鼠标移动每次鼠标移动时在一个顶点上。

我宁愿有一个监听器方法 - 有没有办法注册`mouseEntered`/`mouseExited`事件到顶点？（据我所知，这一切都是通过原始绘画发生的，并且没有我可以注册的组件）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-29T20:59:46.693

它无法完成，因为顶点被绘制为图元并且没有鼠标移动的侦听器 - 只有选择/取消选择。

# javascript - 获取所有表单数组到JS数组

> ID：11421769
> 
> 赞同：0
> 
> 时间：2012-07-10T20:53:56.977
> 
> 标签：javascript, html, arrays

我在将所有表单数组值获取到 JS 数组时遇到问题，其中一个值可以正常工作：

```
 var el = document.getElementsByName('p[]');
          for (var i = 0, j = el.length; i < j; i++) {
          var elem = el[i];
          alert(elem.value);
          } 
```

但是，当我尝试添加更多内容时，它不起作用：

```
var el = document.getElementsByName('p[]', 'k[]', 'ka[]', 's[]');
              for (var i = 0, j = el.length; i < j; i++) {
              var elem = el[i];
                      alert(elem.value);
                    $.post("test.php", { 'p': [elem.value] });
                      } 
```

这是我的表单：表单是动态的（通过单击按钮，我可以使用以下 4 个字段添加新行：

```
 <form name="form">
    <input type="text" name="p[]" id=name" />
    <input type="text" name="k[]" id="quant" size="3" />
    <input type="text" name="ka[]" id="price" size="10" />
    <input type="text" name="s[]" id="sum" size="10" disabled="disabled"/><br />
    </form> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-10T20:56:03.940

[`document.getElementsByName`](https://developer.mozilla.org/en/DOM/document.getElementsByName)不会以您尝试使用它的方式神奇地采用多个参数。您需要`gEBN`多次调用，每个名称一次（由[另一个答案](https://stackoverflow.com/a/11421870/139010)更详细地描述）。

或者，只需遍历`<form>`的输入：

```
var form = document.getElementsByName('form')[0];
var inputs = form.getElementsByTagName('input');
for (var i = 0, j = inputs.length; i < j; i++) {
    // snip
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-10T21:00:45.477

get elementsByName 方法接受一个字符串参数，所以你应该这样做：

```
var listOfElements = ['p[]', 'k[]', 'ka[]', 's[]'];
for (var i=0; i<listOfElements.length; i++) {
   var el = document.getElementsByName(listOfElements[i]);
   ...
} 
```

# excel - 使用 OR 条件筛选 Excel 数据透视表

> ID：11421773
> 
> 赞同：6
> 
> 时间：2012-07-10T20:54:16.803
> 
> 标签：excel, excel-2007, pivot-table

我是 Excel 爱好者，我刚刚开始学习使用数据透视表。问题是，我需要数据透视表过滤结果具有包容性。

所以，我有一个表，其中包含一些数据行和 3 列 A、B、C，可能值 X、Y、Z... 我为列 A、B、C 指定了一个过滤器，这样我就可以检索有 A=Y 或 B=Z 或 C=X。

我遇到的问题是默认过滤器使用 AND 条件。因此，如果我选择第一个值作为 A=Y，它将删除所有其他行。

有任何想法吗？我知道您可以使用高级过滤器做类似的事情，但我不知道是否有更简单的解决方案。

非常感谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-10T22:47:37.177

理想情况下，数据透视表的所有数据操作都在计算字段中完成。但是，我发现您不能将计算字段用于除值部分以外的部分（您似乎在这里尝试这样做）。

我使用的一种解决方法是在源数据中添加一个新列，其中包含用于对数据进行分组的公式。

您可以执行以下操作：

```
IF(OR(A=Y, B=Z, C=X), "Display", "Hide") 
```

并在数据透视表中过滤该列的显示或隐藏结果。

# c++ - 具有多个线程的程序，不打印预期的输出

> ID：11421775
> 
> 赞同：-3
> 
> 时间：2012-07-10T20:54:37.520
> 
> 标签：c++, linux, pthreads, shared-memory

我正在使用 Ubuntu 12，当我在终端上编译代码时，我使用: `$ g++ -o ./myProgram ./main.cpp`，然后 `$ ./myProgram` 我没有收到任何错误或警告，但它不会打印主函数之外的任何内容。

由于某种原因，主函数中的 pthread_creat 命令似乎不起作用。

这是我的程序代码：

```
#include <stdlib.h>
#include <stdio.h>
#include <iostream>
#include <unistd.h>
#include <time.h>
#include <pthread.h>
#include <sys/types.h>
#include <sys/ipc.h>
#include <sys/shm.h>
#include <sys/stat.h>

using namespace std;

pthread_mutex_t jobMutex;
key_t key = 5678;
#define SHMSZ 27

int shmid;

class Job {
public:
int speed, pleasant, easy;

//initialization, constructor, destructor

Job() {
}

Job(int new_s, int new_p, int new_e) {
    speed = new_s;
    pleasant = new_p;
    easy = new_e;
}

~Job() {
}
};

struct sh_data {
Job j_list[10]; //array of jobs on bulletin board
int clock;
int kid_count;
} *shared, *update;

class Child {
private:
int pid;
int j_pref;
Job* j_list;
int clock;
int score;

public:

Child() {
} //constructor

void read_mem() {
    sh_data* data;

    if ((shmid = shmget(key, SHMSZ, 0666)) < 0) {
        cerr << "\tshmget\n";
        exit(EXIT_FAILURE);
    }

    pthread_mutex_lock(&jobMutex);

    if ((data = (sh_data *) shmat(shmid, NULL, 0)) == (sh_data *) -1) {
        cerr << "\tshmat\n";
        exit(EXIT_FAILURE);
    }

    j_list = data->j_list;
    clock = data->clock;
    pthread_mutex_unlock(&jobMutex);
}

void write_mem(int index) {
    sh_data* data;

    if ((shmid = shmget(key, SHMSZ, 0666)) < 0) {
        cerr << "\tshmget\n";
        exit(EXIT_FAILURE);
    }

    pthread_mutex_lock(&jobMutex);

    if ((data = (sh_data *) shmat(shmid, NULL, 0)) == (sh_data *) -1) {
        cerr << "\tshmat\n";
        exit(EXIT_FAILURE);
    }

    data->j_list[index].speed = 0;
    pthread_mutex_unlock(&jobMutex);
}

//all preference functions

void pref_quick() {
    cout << "Child prefers a quick job \n";
    read_mem();

    while (clock < 20) {
        pthread_mutex_lock(&jobMutex);
        read_mem();

        int cur_job;
        int speed = j_list[0].speed;

        for (int i = 0; i < 10; i++) {
            if (j_list[i].speed < speed && j_list[i].speed > 0) {
                cur_job = i;
                speed = j_list[i].speed;
            }
        }

        cout << "Child " << pid << " selected job " << cur_job << " with speed " << speed << "\n";

        //calculate total score so far
        score += j_list[cur_job].speed + j_list[cur_job].pleasant + j_list[cur_job].easy;

        write_mem(cur_job);
        pthread_mutex_unlock(&jobMutex);
        sleep(j_list[cur_job].speed);
    }
}

void pref_profit() {
    cout << "Child prefers a job with highest profit \n";\
    read_mem();

    while (clock < 20) {
        pthread_mutex_lock(&jobMutex);
        read_mem();

        int cur_job;
        int profit = 0;

        for (int i = 0; i < 10; i++) {
            if (j_list[i].speed + j_list[i].pleasant + j_list[i].easy > profit) {
                cur_job = i;
                profit = j_list[i].speed + j_list[i].pleasant + j_list[i].easy;
            }
        }

        cout << "Child " << pid << " selected job " << cur_job << " with profit " << profit << "\n";

        //calculate total score so far
        score += profit;

        write_mem(cur_job);
        pthread_mutex_unlock(&jobMutex);
        sleep(j_list[cur_job].speed);
    }
}

void pref_simple() {
    cout << "Child prefers a simple job \n";
    read_mem();

    while (clock < 20) {
        pthread_mutex_lock(&jobMutex);
        read_mem();

        int cur_job;
        int ease = j_list[0].easy;

        for (int i = 0; i < 10; i++) {
            if (j_list[i].easy < ease) {
                cur_job = i;
                ease = j_list[i].easy;
            }
        }

        cout << "Child " << pid << " selected job " << cur_job << " with ease " << ease << "\n";

        //calculate total score so far
        score += j_list[cur_job].speed + j_list[cur_job].pleasant + j_list[cur_job].easy;

        write_mem(cur_job);
        pthread_mutex_unlock(&jobMutex);
        sleep(j_list[cur_job].speed);
    }
}

void pref_clean() {
    cout << "Child prefers a clean job \n";
    read_mem();

    while (clock < 20) {
        pthread_mutex_lock(&jobMutex);
        read_mem();

        int cur_job;
        int clean = j_list[0].pleasant;

        for (int i = 0; i < 10; i++) {
            if (j_list[i].pleasant < clean) {
                cur_job = i;
                clean = j_list[i].pleasant;
            }
        }

        cout << "Child " << pid << " selected job " << cur_job << " with cleanliness " << clean << "\n";

        //calculate total score so far
        score += j_list[cur_job].speed + j_list[cur_job].pleasant + j_list[cur_job].easy;

        write_mem(cur_job);
        pthread_mutex_unlock(&jobMutex);
        sleep(j_list[cur_job].speed);
    }
}

void* worker() {
    sh_data* data;

    if ((shmid = shmget(key, SHMSZ, 0666)) < 0) {
        cerr << "\tshmget\n";
        exit(EXIT_FAILURE);
    }

    pthread_mutex_lock(&jobMutex);

    if ((data = (sh_data *) shmat(shmid, NULL, 0)) == (sh_data *) -1) {
        cerr << "\tshmat\n";
        exit(EXIT_FAILURE);
    }

    j_list = data->j_list;
    pid = data->kid_count;
    j_pref = rand() % 4;
    data->kid_count++;
    pthread_mutex_unlock(&jobMutex);

    cout << "Job Preference for Child " << pid << " is: " << j_pref << "\n";

    //select a job preference
    switch (j_pref) {
        case 0: //fastest job
            cout << "Selecting quickest job\n";
            pref_quick();
            break;
        case 1: //cleanest job
            cout << "Selecting the most pleasant job\n";
            pref_clean();
            break;
        case 2: //simplest job
            cout << "Selecting the most simple job\n";
            pref_simple();
            break;
        case 3: //most profitable job
            cout << "Selecting the most profitable job\n";
            pref_profit();
            break;
        default: //quickest job by default
            cout << "Selecting quickest job\n";
            pref_quick();
            break;
    }
}

~Child() { //destructor
}

//static helper function to get rid of hidden "this" parameter from pthread_create

static void *Child_helper(void *context) {
    cout << "\tChild helper function called\n";
    return ((Child *) context)->worker();
}
};

class Mom {
private:
Job j_list[10]; //unending list of 10 jobs
int clock;
pthread_t child_id[4]; //thread ids for each child

public:
//create job with random speed, pleasant, easy values

Job newJob() {
    int rand_val[3];

    for (int i = 0; i < 3; i++) {
        rand_val[i] = rand() % 5 + 1;
    }

    return Job(rand_val[0], rand_val[1], rand_val[2]);
}

void read_mem() {
    sh_data* data;

    if ((shmid = shmget(key, SHMSZ, 0666)) < 0) {
        cerr << "\tshmget\n";
        exit(EXIT_FAILURE);
    }

    pthread_mutex_lock(&jobMutex);

    if ((data = (sh_data *) shmat(shmid, NULL, 0)) == (sh_data *) -1) {
        cerr << "\tshmat\n";
        exit(EXIT_FAILURE);
    }

    for (int i = 0; i < 10; i++) {
        j_list[i] = data->j_list[i];
    }

    clock = data->clock;
    pthread_mutex_unlock(&jobMutex);
}

void write_mem(Job new_job, int index, int clock) {
    sh_data* data;

    if ((shmid = shmget(key, SHMSZ, 0666)) < 0) {
        cerr << "\tshmget\n";
        exit(EXIT_FAILURE);
    }

    pthread_mutex_lock(&jobMutex);

    if ((data = (sh_data *) shmat(shmid, NULL, 0)) == (sh_data *) -1) {
        cerr << "\tshmat\n";
        exit(EXIT_FAILURE);
    }

    data->j_list[index] = new_job;
    data->clock = clock;
    pthread_mutex_unlock(&jobMutex);
}

void write_mem(int clock) {
    sh_data* data;

    if ((shmid = shmget(key, SHMSZ, 0666)) < 0) {
        cerr << "\tshmget\n";
        exit(EXIT_FAILURE);
    }

    pthread_mutex_lock(&jobMutex);

    if ((data = (sh_data *) shmat(shmid, NULL, 0)) == (sh_data *) -1) {
        cerr << "\tshmat\n";
        exit(EXIT_FAILURE);
    }

    data->clock = clock;
    pthread_mutex_unlock(&jobMutex);
}

//chores() creates shared memory, checks checks and update shared memory, and creates children

void* chores() {
    cout << "\tChores function called\n";

    shmid = shmget(IPC_PRIVATE, 1, IPC_CREAT);
    cout << "\tValue of shmid: " << shmid << "\n";

    if (shmid == -1) {
        shmid = shmget(key, sizeof (sh_data), IPC_CREAT);

        if (-1 == shmid) {
            cout << "\tCould not get shmid\n";
        } else {
            pthread_mutex_lock(&jobMutex);

            //system chooses the address
            shared = (sh_data *) shmat(shmid, 0, 0);
            update = shared;

            pthread_mutex_unlock(&jobMutex);
        }
    } else {
        pthread_mutex_lock(&jobMutex);

        cout << "Mom created job list!\n";

        //system chooses the address
        shared = (sh_data *) shmat(shmid, (void*) 0, 0);
        update = shared;
        update->kid_count = 0;

        pthread_mutex_unlock(&jobMutex);
    }

    sh_data* data;

    Child * child[4];

    for (int i = 0; i < 4; i++) {
        cout << "~~Thread created for Child " << i + 1 << "\n";
        child[i] = new Child();

        //calls worker function from Child class
        pthread_create(&child_id[i], NULL, &Child::Child_helper, child[i]);
    }

    while (clock < 20) {
        cout << "\tMom will sleep for 2 units\n";
        sleep(2);
        pthread_mutex_lock(&jobMutex);
        read_mem();

        for (int i = 0; i < 10; i++) {
            if (j_list[i].speed == 0) {
                cout << "Mommy added a new job to the bulletin board!!\n";
                j_list[i] = newJob();
                write_mem(j_list[i], i, clock);
            }
        }

        clock += 2;
        write_mem(clock);
        pthread_mutex_unlock(&jobMutex);
        cout << "Mom says time is now: " << clock << "\n";
    }

    payup();
}

void payup() {
    int max, winner;

    max = 0;
    for (int i = 0; i < 4; i++) {
        //wait for all children to finish tasks
        int* status = 0;
        pthread_join(child_id[i], (void**) status);
        cout << "Child " << i << " completes tasks that earned him/her " << *status << " points!\n";
        if (max < *status) {
            max = *status;
            winner = i;
        }
    }

    cout << "The winner is child " << winner << ", with " << max << " points!\n";
}

Job* get_jlist() {
    return j_list;
}

int get_time() {
    return clock;
}

//static helper function to get rid of hidden "this" parameter from pthread_create

static void *Mom_helper(void *context) {
    cout << "\tHelper function called\n";
    return ((Mom *) context)->chores();
}

//initialization, constructor, destructor

Mom() {
    srand(time(NULL));
}

~Mom() {
}
};

int main() {
cout << "Program 7: Chores using Threads\n\n";

pthread_t threads;
pthread_mutex_init(&jobMutex, NULL);

//instantiate mom class and call chores()
Mom* mommy = new Mom();
cout << "~~Made Mom\n";

//calls chores function from Mom class
pthread_create(&threads, NULL, &Mom::Mom_helper, mommy);
cout << "~~Created threads\n";

pthread_mutex_destroy(&jobMutex);
cout << "~~Destroyed threads\n";

return 0;
} 
```

我做错了什么吗，我一直在寻找并将我的代码与其他人进行比较，这似乎是正确的。但它不起作用。任何人都可以对这种情况有所了解吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-10T20:56:49.707

有很多代码要阅读，但您似乎并没有在等待线程。您的主线程调用`pthread_create`并（可能）在新线程有机会运行之前退出进程。

你可能想打电话[`pthread_join`](http://www.kernel.org/doc/man-pages/online/pages/man3/pthread_join.3.html)，之前的某个地方`pthread_mutex_destroy`。

```
pthread_create(&threads, ...);
pthread_join(threads, zahir); 
```

# asp.net - Gridview 排序不适用于 Linq to SQL

> ID：11421779
> 
> 赞同：1
> 
> 时间：2012-07-10T20:54:48.340
> 
> 标签：asp.net, linq, entity-framework, sorting, gridview

在我的 gridview 上排序时出现以下错误。“数据源不支持服务器端数据分页。” 我没有使用 obejctdatasource 和 linqdatasource。我发现的每个关于堆栈溢出的示例或解决方案都使用了 obejctdatasource。[如：http://www.devtoolshed.com/content/gridview-objectdatasource-linq-paging-and-sorting]

下面是我的代码。如何修复代码中的排序错误？我可以在不使用 objectdatasource 的情况下修复它吗？

* * *

```
public List<SearchLoanViewItem> GetSearchresult(EmpowerEntities empower)
        {
            var searchresult = (from m in dbo.MTGTERMS
                                join p in dbo.PROPINFOes
                                    on m.LNKEY equals p.LNKEY
                                join b in dbo.BORRINFOes
                                    on m.LNKEY equals b.LNKEY
                                join d in dbo.DBLOCKS
                                    on m.LNKEY equals d.LNKEY
                                join u in dbo.UCODES3
                                    on m.LNKEY equals u.LNKEY
                                join c in dbo.CODES
                                    on m.LNKEY equals c.LNKEY
                                where b.WHICHBORR == 1
                                      && (c.APPSTATS == null ? "" : c.APPSTATS) != "DEL"
                                select new SearchLoanViewItem
                                           {
                                               lnkey = m.LNKEY,
                                               prop_addr = p.PROP_ADDR,
                                               networklocked = d.NETWORKLOCKED == "Y" ? "Yes" : "No",
                                               username = (d.USERNAME ?? ""),
                                               mailbox = d.MAILBOX,
                                               borr_name = b.BORR_NAME,
                                               ssn = b.BORR_SSN,
                                               phone = b.BORR_PHONE,
                                               employee_loan = (u.CODE67N ?? -1)
                                           }).Take(5).ToList();
            return searchresult;
        }

        public void ShowSearchResults()
        {
            try
            {
                var empower = new EmpowerEntities();
                var searchresult = GetSearchresult(empower);                

                gdvSearchResult.DataSource = searchresult;
                gdvSearchResult.DataBind();
            }
            catch (Exception ex)
            {
                Logger.log("ucSearchLoan", ex.Message, Logger.ERROR);
            }
        }

 protected void Paging_gdvSearchResult(object source, GridViewPageEventArgs e)
        {  
            gdvSearchResult.PageIndex = e.NewPageIndex;
            ShowSearchResults();
        }

protected void gdvSearchResult_SortCommand(object source, GridViewSortEventArgs e)
        {
            try
            {
                var empower = new EmpowerEntities();
                var searchresult = GetSearchresult(empower);

                if (SearchSortType == Constants.ASC)
                    SearchSortType = Constants.DESC;
                else
                    SearchSortType = Constants.ASC;

                SeachSortField = e.SortExpression.ToString();

                if (SeachSortField.Equals(Constants.ASC))
                    gdvSearchResult.DataSource = searchresult.AsEnumerable().OrderBy(a => a.GetType().GetProperty(SeachSortField).GetValue(a, null));
                else
                    gdvSearchResult.DataSource = searchresult.AsEnumerable().OrderByDescending(a => a.GetType().GetProperty(SeachSortField).GetValue(a, null));

                gdvSearchResult.DataBind();        

            }

and my gridview looks like below.

    <asp:GridView runat="server" ID="gdvSearchResult" 
             AutoGenerateColumns="false" OnRowCommand="gdvSearchResult_RowCommand" OnRowCreated="gdvSearchResult_RowCreated" PageSize="2" AllowPaging="true"      AllowSorting="true" OnPageIndexChanging="Paging_gdvSearchResult" OnSorting="gdvSearchResult_SortCommand"> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T23:10:14.273

当我添加铸造 [`Cast<object>().ToList()`部分]时问题已修复

```
 if (SeachSortField.Equals(Constants.ASC))
                    gdvSearchResult.DataSource = searchresult.AsEnumerable().OrderBy(a => a.GetType().GetProperty(SeachSortField).GetValue(a, null)).Cast<object>().ToList();
                else
                    gdvSearchResult.DataSource = searchresult.AsEnumerable().OrderByDescending(a => a.GetType().GetProperty(SeachSortField).GetValue(a, null)).Cast<object>().ToList(); 
```

# python - 使用 BeautifulSoup 查找嵌套标签的原始位置

> ID：11421782
> 
> 赞同：1
> 
> 时间：2012-07-10T20:54:54.277
> 
> 标签：python, beautifulsoup

我有一组标签，我试图从 XML 文本中提取并确定它们在“渲染”文本中的位置。

例如：

XML:

```
<p>The risk of sexual transmission of HIV-1 correlates strongly with plasma HIV-1 level.
  <xref ref-type="bibr" rid="pone.0012598-Fideli1">[1]</xref>, 
  <xref ref-type="bibr" rid="pone.0012598-Quinn1">[2]</xref>This association has motivated proposed interventions (such as use of antiretroviral therapy (ART),
  <xref ref-type="bibr" rid="pone.0012598-Cohen1">[3]</xref>, 
  <xref ref-type="bibr" rid="pone.0012598-Granich1">[4]</xref> therapeutic HIV-1 vaccines,<xref ref-type="bibr" rid="pone.0012598-Gurunathan1">[5]</xref> and treatment for co-infections<xref ref-type="bibr" rid="pone.0012598-Corey1">[6]</xref>–&lt;xref ref-type="bibr" rid="pone.0012598-Walson1">[8]</xref> that reduce HIV-1 infectiousness by reducing levels of plasma HIV-1 RNA. 
```

渲染：

> HIV-1 的性传播风险与血浆 HIV-1 水平密切相关。[1]、[2] 这种关联促使提出了干预措施（例如使用抗逆转录病毒疗法 (ART)、[3]、[4] HIV-1 疫苗 [5] 和合并感染的治疗 [6]-[8] 通过降低血浆 HIV-1 RNA 的水平来降低 HIV-1 的传染性。

为了提取标签及其在渲染文本中的位置。目前我正在使用`bs4`与此代码类似的代码（`sent_tokenize`来自 NLTK 工具箱，并`list`从输入文本创建一个句子）：

```
for n, p in enumerate(article.find_all('p')):
    rawtext = str(p) #returns the XML version of the text
    readtext = p.text #returns the rendered version
    sents = sent_tokenize(readtext) #splits sentences

    for ref in p.find_all('xref'):
        startloc = rawtext.find(str(ref))
        prestart = max(0, startloc-20)
        for s in sents:
            if s.find(rawtext[prestart:startloc]) > -1:
                print s, ref
                break 
```

此代码无法在第二个外部参照上找到 ，因为它之前的文本是前一个外部参照标记的一部分。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T18:47:33.997

好吧，没有人回应，所以我不得不即兴发挥。这是我目前的方法：

```
lens = [len(tag.string) for tag in p.contents]
clens = [sum(lens[:ind]) for ind in xrange(1,len(lens))]
locs = [spot for tag, spot in zip(p.contents, clens) if isinstance(tag, Tag) and tag.name == 'xref'] 
```

基本思想是使用`string`返回渲染文本的方法。我用它来确定段落的每个子项的长度。然后我使用这些长度来确定我正在寻找的标签的位置。

希望对其他人有所帮助！

-将要

# c# - 为什么许多基类库类都有显式接口实现成员？

> ID：11421783
> 
> 赞同：1
> 
> 时间：2012-07-10T20:54:56.257
> 
> 标签：c#, .net

MSDN：[系统类型](http://msdn.microsoft.com/en-us/library/system.type.aspx)

与上面的链接一样，C# 中的许多 BCL 类都将显式接口实现作为类成员。

我知道当基本接口的成员之间存在名称冲突时，我们必须使用显式接口实现。但是为什么在上述情况下我们必须使用显式接口实现呢？它与哪些接口存在名称冲突？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T00:34:49.607

接口的显式实现用于隐藏实例属性/方法，除非调用代码明确要求接口。

这在以下情况下很有用：

*   类作者认为接口的实现只在极少数情况下使用，并且为了可用性默认应该隐藏（这显然是*Type*类的情况，因为显式接口实现是特定于 COM 的）
*   一个类实现了两个或多个具有公共方法/属性签名的接口，但有必要根据接口提供不同的实现，因为接口在方法签名之外具有隐式但不同的行为契约（*Type*类也有这样的示例；大概 _MemberInfo.GetIDsOfNames 和 _Type.GetIDsOfNames 的实现共享相同的签名，但根据您将*Type*实例转换为 _MemberInfo 接口还是 _Type 接口，执行不同的操作）。
*   这已被使用（尽管不鼓励）让类实现 IDisposable 以便它的实例可以在*using*块中使用，但鼓励调用者在调用方法时使用更特定于域的方法来“释放”类直接地。请参阅[http://blogs.msdn.com/b/kimhamil/archive/2008/03/15/the-often-non-difference-between-close-and-dispose.aspx](http://blogs.msdn.com/b/kimhamil/archive/2008/03/15/the-often-non-difference-between-close-and-dispose.aspx)
*   当 API 开发人员想要一个他们公开的公共类来实现一个接口，该接口的实现只能在他们的程序集中使用时，可以由他们使用。在这种情况下，接口将使用*internal*关键字声明，并且其面向公众的类将显式实现该接口。最终结果是只有程序集中的代码才能将类的实例转换为内部接口并访问其实现，而程序集之外的调用者则不能。

这些是我想到的用例；我敢肯定还有其他我没有列出的。

# c# - 如何在当前类型中使用泛型

> ID：11421791
> 
> 赞同：0
> 
> 时间：2012-07-10T20:55:14.043
> 
> 标签：c#, .net, generics

我有这个基类：

```
public abstract class Parent {
    public void DoSomething() {
        var c=new GenericClass<**ThisInstanceType**>();
        c.DoYourThing();
    }
} 
```

为了使用具有“this”类型（当前子实例）的泛型， 我应该用什么代替**ThisInstanceType ？**

我无法更改`Parent.DoSomething()`. 不可能`void DoSomething<T>()`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T21:00:08.953

如果你让你的抽象类通用，你可以像这样实现它：

```
public abstract class Parent<T> where T : Parent<T> {
    public void DoSomething() {
        var c = new GenericClass<T>();
        c.DoYourThing();
    }
 }

public class Child : Parent<Child> {} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T21:05:35.697

你可以这样做：

```
public abstract class Parent<T> : IParent
{
    public void DoSomething() {
        var c=new GenericClass<T>();
        c.DoYourThing();
    }
}

public sealed class Child : Parent<Child>
{
} 
```

如有必要，您可以添加：

公共接口 IParent { void DoSomething(); }

顺便说一句：如果你包括完整的现实生活示例，我可能会给你一个更好的解决方案

另一种解决方案是使用反射来获取正确的类型并在运行时调用该方法......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-10T21:06:53.200

如果你真的不能正确设计它，你可以通过反射来做。我不愿建议，因为您确实应该重新设计您的界面，但是：

```
Type t = typeof(GenericClass<>).MakeGenericType(this.GetType());
object c = Activator.CreateInstance(t);
c.InvokeMember("DoYourThing", BindingFlags.Public | BindingFlags.Instance | BindingFlags.InvokeMethod, null, c, new object[] {}); 
```

# math - LookAt 函数背后的数学

> ID：11421794
> 
> 赞同：0
> 
> 时间：2012-07-10T20:55:32.107
> 
> 标签：math, matrix, directx

在 MSDN（http://msdn.microsoft.com/en-us/library/windows/desktop/bb281710%28v=vs.85%29.aspx）上，LookAt 函数是这样的数学：

```
zaxis = normal(cameraTarget - cameraPosition)
xaxis = normal(cross(cameraUpVector, zaxis))
yaxis = cross(zaxis, xaxis)

xaxis.x           yaxis.x           zaxis.x          0
xaxis.y           yaxis.y           zaxis.y          0
xaxis.z           yaxis.z           zaxis.z          0
-dot(xaxis, cameraPosition)  -dot(yaxis, cameraPosition)  -dot(zaxis, cameraPosition)  1 
```

据我所知，最后一行是翻译。您能否解释一下为什么不能只将 cameraPosition 放在这一行并且需要 dot 函数？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-10T23:09:12.647

这是因为 View 矩阵将对象从世界空间转换到相机空间。将相机放置在其位置的不是转换。这将是逆变换。考虑一个简单的二维坐标系：

![坐标系](../Images/2ec566d29de42b8fd1de9883dfc08026.png)

黑色坐标系是世界系统。蓝色的是带有系统的相机。绿色箭头是相机在世界空间中的平移向量。

视图矩阵会将相机从其当前位置放回原点。第一步是旋转，使两个系统的相应轴指向同一方向：

![坐标系变换](../Images/540a97fc29dcc2f5fd37e83245986105.png)

这是通过矩阵的其他条目（m_11 到 m_33）来实现的。

现在只剩下一个翻译了。但是平移向量被转换了。幸运的是，我们知道，如何。平移向量等于相机位置（注意，DirectX 使用转置矩阵。为了显示背后的数学，我将它们转回）：

```
/ xAxis.x   xAxis.y  xAxis.z   ...\    / camPos.X \   / camPos.x * xAxis.x + camPos.Y * xAxis.y + camPos.z * xAxis.z \
| yAxis.x   yAxis.y  yAxis.z   ...|    | camPos.Y |   | camPos.x * yAxis.x + camPos.Y * yAxis.y + camPos.z * yAxis.z |
| zAxis.x   zAxis.y  zAxis.z   ...|  * | camPos.Z | = | camPos.x * zAxis.x + camPos.Y * zAxis.y + camPos.z * zAxis.z |
\    0        0         0      .../    \    0     /    \                       0                                     / 
```

如果你看看结果：

```
camPos.X * xAxis.x + xamPos.Y * xAxis.y + camPos.z * xAxis.z 
```

然后你会看到这等于

```
dot ( camPos, xAxis) 
```

最后，点积用于补偿旋转。没有它，相机会有些位移（在示例中右上角太远）。

# c# - SQL C# 交互不起作用

> ID：11421795
> 
> 赞同：2
> 
> 时间：2012-07-10T20:55:35.447
> 
> 标签：c#, sql, sql-server-2008, datatable, sqldataadapter

我正在尝试使用信息查询 ping 我的 SQL 服务器，然后将该信息传递到 DataGridView。虽然它不会显示在我的代码中，但我会先打开我的 DBConnection，然后再将其关闭。我的代码如下所示：

```
 using (SqlDataAdapter newDA = new SqlDataAdapter(query, DBConnection))
        {
            DataTable Table = new DataTable();
            newDA.Fill(Table);

            dgvOutput.DataSource = Table;
        } 
```

我知道 query 和 DBConnection 都可以正常工作，因为它们在程序的类似部分中工作，但由于某种原因，newDA 似乎没有从这里的数据库中获取任何数据。当我将查询的值直接复制到 Microsoft SQL Server Management Studio 并运行它时，它会很好地获取数据。有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-10T21:06:31.440

```
string connectionString = YOUR_NAME_SPACE.Properties.Settings.Default.CONNECTION_STRING;
            SqlConnection con = new SqlConnection(connectionString);
            DataTable DT = new DataTable();
            con.Open();

            SqlDataAdapter DA = new SqlDataAdapter(YOUR_QUERYQUERY, connectionString);
            DA.Fill(DT);
            con.Close();
            return DT; 
```

现在放上这段代码。在您的项目中几乎没有变化。**我希望你能得到改变。**

您将拥有数据表。这包含所有内容。您可以轻松地将内容放到数据网格视图中。这简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T20:18:14.497

好吧，在盯着我的屏幕又看了几个小时之后，我意识到我错过了什么：

```
dgvOutput.AutoGenerateColumns = true; 
```

一旦我进入这个，一切都很好。

# clojurescript - Clojurescript 协议的用法？

> ID：11421805
> 
> 赞同：3
> 
> 时间：2012-07-10T20:56:00.850
> 
> 标签：clojurescript

首次尝试在 ClojureScript 中使用协议。以下是协议定义/实现：

```
(defprotocol IDataTable
  (-pages [this])
  (-cnt! [this cnt])
  (-paginate [this])
 )

(deftype DataTable [id url info]
 IDataTable
 (-cnt! [_ cnt] (swap! info (fn [v] (assoc v :cnt cnt))) )
 (-pages [_]
   (inc (.round js/Math (/ (:cnt @info) (:length @info))))
 )

(-paginate [_]
  (let [arr (take 5 (drop (- (:page @info) 1) (range 1 (pages))))]
   (c/paging id (flatten ["Prev" arr "Next"]) )
  ))
 ) 
```

我对如何调用协议中定义的函数感到困惑。

以下是实例化的代码：

```
(def table-id "some-table")
(def paging (atom {:page 1 :length 10 :cnt 0  }))
(def data-table (DataTable. table-id "/list/data" paging)) 
```

上面的代码有效，并且可以使用以下形式访问属性：

```
(js/alert (.-id data-table)) 
```

我面临的问题是如何调用协议中定义的函数。以下形式会导致错误（运行时）。

```
 (-cnt! data-table 10) ;; Error: -cnt! is not a method
 (.-cnt! data-table 10) ;; Error 
```

浏览生成的 Javascript 代码，它的函数名称很冗长。

谢谢

编辑：认为我找到了答案。看起来我需要命名空间中的支持功能。

```
(defn cnt! [t cnt]
   (when (satisfies? IDataTable t)
     (-cnt! t cnt))
 ) 
```

使用上面定义的功能，我能够访问这些功能。想知道这是否是正确的方法？

EDIT2：好吧，通过进一步分析生成的javascript代码，意识到不需要像上面编辑的辅助函数，函数调用需要以命名空间为前缀：

```
 (:require [table :as tbl])

(def table-id "some-table")
(def paging (atom {:page 1 :length 10 :cnt 0  }))
(def data-table (DataTable. table-id "/list/data" paging))

 (tbl/-cnt! data-table 10) ;; Works!!! 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-27T11:14:00.883

看起来你回答了你自己的问题，但万一有人在这里结束......

协议方法会自动提升到声明它们的命名空间，这意味着如果你想调用这些函数，你调用它们就好像它们是命名空间中的常规函数​​一样。

# django - Django collectstatic 无法使用 django-storages（使用 AWS）

> ID：11421809
> 
> 赞同：2
> 
> 时间：2012-07-10T20:56:09.283
> 
> 标签：django, amazon-web-services

我正在尝试部署一个 django 站点，但无法`manage.py collectstatic`完成命令。它收集了大部分文件，但从未完成......返回以下回溯。我正在使用 django1.3 和 python2.7。

此外，`DEBUG = False`并且`'django.contrib.staticfiles'`在我安装的应用程序中。

追溯：

```
Traceback (most recent call last):
  File "manage.py", line 14, in <module>
    execute_manager(settings)
  File "/home/rowapparel/.virtualenvs/dev_ra_env/lib/python2.7/site-packages/django/core/management/__init__.py", line 438, in execute_manager
    utility.execute()
  File "/home/rowapparel/.virtualenvs/dev_ra_env/lib/python2.7/site-packages/django/core/management/__init__.py", line 379, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File "/home/rowapparel/.virtualenvs/dev_ra_env/lib/python2.7/site-packages/django/core/management/base.py", line 191, in run_from_argv
    self.execute(*args, **options.__dict__)
  File "/home/rowapparel/.virtualenvs/dev_ra_env/lib/python2.7/site-packages/django/core/management/base.py", line 220, in execute
    output = self.handle(*args, **options)
  File "/home/rowapparel/.virtualenvs/dev_ra_env/lib/python2.7/site-packages/django/core/management/base.py", line 351, in handle
    return self.handle_noargs(**options)
  File "/home/rowapparel/.virtualenvs/dev_ra_env/lib/python2.7/site-packages/django/contrib/staticfiles/management/commands/collectstatic.py", line 80, in handle_noargs
    for path, storage in finder.list(ignore_patterns):
  File "/home/rowapparel/.virtualenvs/dev_ra_env/lib/python2.7/site-packages/django/contrib/staticfiles/finders.py", line 210, in list
    for path in utils.get_files(self.storage, ignore_patterns):
  File "/home/rowapparel/.virtualenvs/dev_ra_env/lib/python2.7/site-packages/django/contrib/staticfiles/utils.py", line 21, in get_files
    directories, files = storage.listdir(location)
    File "/home/rowapparel/.virtualenvs/dev_ra_env/lib/python2.7/site-    packages/django/core/files/storage.py", line 109, in listdir
    raise NotImplementedError()
NotImplementedError 
```

同样，它适用于我的很多静态文件，但不是全部。它似乎每次都停在同一个文件上，但是当我忽略该应用程序和/或文件时，它仍然返回上述回溯。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T22:08:43.403

根据 django-storages[文档](http://django-storages.readthedocs.org/en/latest/backends/amazon-S3.html)，将 collectstatic 文件放入 s3 存储桶的正确方法是在设置中定义以下内容：

`STATICFILES_STORAGE = 'storages.backends.s3boto.S3BotoStorage'`

...**您不能**使用`storeages.backends.s3.s3Storage`，因为该后端没有定义 listdir 方法... boto 后端可以。

# linux - nohup 不适用于铬

> ID：11421810
> 
> 赞同：3
> 
> 时间：2012-07-10T20:56:10.080
> 
> 标签：linux, bash, chromium, nohup

我正在制作一个小的 shell 脚本，它会在启动后启动各种程序。我`dialog`用于制作菜单，然后是运行所需应用程序的简单 case 语句。除了我最喜欢的浏览器 Chromium 之外，一切都运行良好。

`nohup chromium &`不起作用 - 当我关闭终端时，Chromium 也会关闭。

这是我的脚本：

```
selection=`dialog --menu "Choose a session:" 20 50 10 "Surfing" "" "Surfing (blank)" "" "Programming" "" "Gaming" "" "Nothing" "" --stdout`

case "$selection" in
    "Surfing" )
        nohup chromium http://www.facebook.com &
        nohup chromium http://www.twitter.com &
        nohup chromium http://reader.google.com &
        nohup chromium http://plus.google.com &
        nohup chromium http://www.youtube.com &
        nohup chromium http://www.reddit.com &
        nohup chromium http://mail.google.com &

        nohup sonata &
        mpc play &
        ;;
    "Surfing (blank)" )
        nohup chromium &>/dev/null </dev/null &
        nohup sonata &

        mpc play &
        ;;
    "Programming" )
        nohup subl &
        nohup chromium ~/Programming &
        nohup sonata &

        mpc play &
        ;;
    "Gaming" )
        nohup thunar ~/HRY &
        ;;
    * )
        echo "nothing" ;;
esac
read && exit 
```

我的一部分`.xinitrc`：

```
urxvt -e sh ~/session.sh & 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-01-10T09:07:39.303

`nohup chromium-browser & disown`应该管用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T01:05:48.193

也许这个信息很有用：当我使用“nohup chromium-browser &”并用 ALT+F4 关闭终端时，铬也会关闭，但是当用 CTRL+D 关闭它时，退出或使用窗口顶部的 X 铬继续运行。关于为什么会发生这种情况的任何想法？它只发生在铬上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T02:35:24.297

而不是读取 && 退出，只需退出，它在这里工作正常。

# css - 自定义样式不适用于deck.js

> ID：11421812
> 
> 赞同：2
> 
> 时间：2012-07-10T20:56:15.827
> 
> 标签：css, deck.js

我正在使用deck.js 创建一个演示文稿，我遇到的问题是，每当我尝试使用自定义样式（例如为表格添加边框或使用谷歌代码美化）时，它绝对没有任何效果。演示文稿可以在[这里](https://github.com/nikhilbhardwaj/Intro-to-CLI/blob/master/presentation.html)找到。

**编辑：** 我有以下代码片段用于显示源代码。

```
<code class="prettyprint">
chmod 000 filename
cat filename
</code> 
```

这究竟是如何受 CSS 特异性问题影响的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T15:28:47.717

大多数套牌样式都在`.deck-container`. 如：`.deck-container pre { ... }`。您的自定义样式可能没有足够的[特异性](http://coding.smashingmagazine.com/2007/07/27/css-specificity-things-you-should-know/)来覆盖它。相应调整。

# scala - 从 java.util.Vector 转换为 scala Seq

> ID：11421814
> 
> 赞同：8
> 
> 时间：2012-07-10T20:56:24.900
> 
> 标签：scala, scala-java-interop

我可以看到有一些方法可以从 Java 列表转换为 Scala seq（使用`asScala`方法），但我找不到任何`java.util.Vector`.

这种转换也有类似的方法吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-10T21:11:50.947

`JavaConverters`比`JavaConversions`.

```
import collection.JavaConverters._

val v = new java.util.Vector[Int]
val s: Seq[Int] = v.asScala 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-10T20:59:38.263

进口`JavaConversions`：

```
import collection.JavaConversions._

val v = new java.util.Vector[Int]()
val s = v.toSeq
// s is of type Seq[Int] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-03-30T14:43:43.427

请注意，开始`Scala 2.13`时，包通过 pimp 提供[`scala.jdk.CollectionConverters`](https://www.scala-lang.org/files/archive/api/2.13.x/scala/jdk/CollectionConverters$.html)并替换包：[`asScala`](https://www.scala-lang.org/files/archive/api/2.13.x/scala/jdk/CollectionConverters$.html#asScala[A](l:java.util.List[A]):scala.collection.mutable.Buffer[A])`java.util.List``scala.collection.JavaConverters/JavaConversions`

```
import scala.jdk.CollectionConverters._

// val javaVector = new java.util.Vector(java.util.Arrays.asList(1, 2, 3))
javaVector.asScala.toSeq
// Seq[Int] = List(1, 2, 3) 
```

# spring-mvc - Spring 3.1 REST MVC 示例

> ID：11421818
> 
> 赞同：0
> 
> 时间：2012-07-10T20:56:41.860
> 
> 标签：spring-mvc

我正在尝试使用 Spring 3.1 REST 控制器实现简单的示例。问题是由于某种原因，我没有为我的请求找到任何资源。我做错了什么？我正在使用Tomcat 7.0。这是我所拥有的：

web.xml

```
 <?xml version="1.0" encoding="utf-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns="http://java.sun.com/xml/ns/javaee"
xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
xsi:schemaLocation="http://java.sun.com/xml/ns/javaee
http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" version="2.5">

    <servlet>
        <servlet-name>mvc-dispatcher</servlet-name>
        <servlet-class>
                    org.springframework.web.servlet.DispatcherServlet
                </servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>

    <servlet-mapping>
        <servlet-name>mvc-dispatcher</servlet-name>
        <url-pattern>/mvc/*</url-pattern>
    </servlet-mapping>

    <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>/WEB-INF/mvc-dispatcher-servlet.xml</param-value>
    </context-param>

    <listener>
        <listener-class>
                    org.springframework.web.context.ContextLoaderListener
                </listener-class>
    </listener>

    <welcome-file-list> 
```

mvc-调度程序-servlet.xml：

```
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:mvc="http://www.springframework.org/schema/mvc" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans     
        http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
        http://www.springframework.org/schema/context 
        http://www.springframework.org/schema/context/spring-context-3.0.xsd
        http://www.springframework.org/schema/mvc
        http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd">

<context:component-scan base-package="my.spring31.mvc.*">

</context:component-scan>

<mvc:annotation-driven />

<bean class="my.spring31.mvc.TestController">
    <property name="message">
        <value>Hello World</value>
    </property>
</bean>

<bean
   class="org.springframework.web.servlet.view.InternalResourceViewResolver">
    <property name="prefix">
        <value></value>
    </property>
    <property name="suffix">
        <value>.jsp</value>
    </property>
</bean> 
```

控制器：

```
 package my.spring31.mvc;
import org.springframework.stereotype.Controller;
import org.springframework.ui.ModelMap;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;

@Controller
@RequestMapping("/movie")
public class TestController {
        //DI via Spring
        String message;

        @RequestMapping(value="/{name}", method = RequestMethod.GET)
        public String getMovie(@PathVariable String name, ModelMap model) {

            model.addAttribute("movie", name);
            model.addAttribute("message", this.message);

            //return to jsp page, configured in mvc-dispatcher-servlet.xml, view resolver
            return "list";

        }

        public void setMessage(String message) {
            this.message = message;
        }
} 
```

还有我的 list.jsp：

```
 <html>
<body>
    <h1>Spring 3 MVC REST example</h1>

    <h3>Movie : ${movie} , DI message : ${message}</h3> 
</body>
</html> 
```

# tumblr - 如何在基于 {TagsAsClasses} 的 tumblr 主题上集成 Isotope Corner-stamp？

> ID：11421824
> 
> 赞同：0
> 
> 时间：2012-07-10T20:57:09.150
> 
> 标签：tumblr, jquery-masonry, jquery-isotope

我有一个同位素的 tumblr 页面，我想知道是否可以在同位素中使用角戳选项：

[http://isotope.metafizzy.co/custom-layout-modes/masonry-corner-stamp.html](http://isotope.metafizzy.co/custom-layout-modes/masonry-corner-stamp.html)

...函数基于使用 {TagsAsClasses} 的指定标签？

在脚本中，我有：

砌体：{ columnWidth：267，cornerStampSelector：'.stamp'}

因此，在一个帖子上，如果我将其标记为“邮票”，它就不会停留在角落里，而是会随着其他帖子不断下降。但是，当我将项目直接添加到标记时，它会起作用。不幸的是，在这种情况下无法编辑 html。

总结了这么长的问题，是否可以在同位素/tumblr 主题上使用corner-stamp 选项，而无需编辑 html 并且在 tumblr 的 UI 中仅使用“stamp”标签？

有问题的网站是：[www.itschucksbday.tumblr.com](http://itschucksbday.tumblr.com)

这是同位素 html 标记，未经任何修改即可添加角戳。

{/block:索引页}

```
 <div id="main">
    <div id="iso">

        {block:IndexPage}
        {block:Posts}
            <div class="article-box {TagsAsClasses}">
            {block:Text}
            <article class="text {TagsAsClasses}" id="post_{PostID}" data-postID="{PostID}" data-permalink="{Permalink}" data-notes="{PostNotesURL}" data-urlencoded="{URLEncodedPermalink}" data-summary="{block:PostSummary}{PostSummary}{/block:PostSummary}">
                <header>
                    {block:Title}<a href="{Permalink}"><p>{Title}</p></a>{/block:Title}
                </header>

                <section class="post-full">
                {block:Title}<a href="{Permalink}"><p>{Title}</p></a>{/block:Title}
                    {Body}
                    {block:More}
                    <a href="{Permalink}" class="more-link">&#133;{lang:More}</a>
                    {/block:More}
                </section>
                <ul class="post-meta clearfix">
                    <li class="timeago"><a href="{Permalink}">{Timeago}</a></li>
                    <li class="icon"><a href="{Permalink}">{Icon}</a></li>

                </ul>
            {/block:Text}

            {block:Photo}
            <article class="photo {TagsAsClasses}" id="post_{PostID}" data-postID="{PostID}" data-permalink="{Permalink}" data-notes="{PostNotesURL}" data-urlencoded="{URLEncodedPermalink}" data-summary="{block:PostSummary}{PostSummary}{/block:PostSummary}">
                <header>
                    {LinkOpenTag}<img src="{PhotoURL-HighRes}" data-highres="{PhotoURL-HighRes}"  alt="{PhotoAlt}" />{LinkCloseTag}
                </header>

                <section class="post-full">
                    <div class="post-image-holder"><img src="{PhotoURL-HighRes}" data-highres="{PhotoURL-HighRes}"  alt="{PhotoAlt}" /></div>
                    {block:Caption}{Caption}{/block:Caption}
                </section>
                <ul class="post-meta clearfix">
                    <li class="timeago"><a href="{Permalink}">{Timeago}</a></li>
                    <li class="icon"><a href="{Permalink}">{Icon}</a></li>
                </ul>
            {/block:Photo}

            {block:Photoset}
            <article class="photoset" id="post_{PostID}" data-postID="{PostID}" data-permalink="{Permalink}" data-notes="{PostNotesURL}" data-urlencoded="{URLEncodedPermalink}" data-summary="{block:PostSummary}{PostSummary}{/block:PostSummary}">
                        <header>
                            <div class="custom-photoset visuallyhidden" data-photoset-layout="{PhotosetLayout}" data-photoset-id="photoset{PostID}">
                            {block:Photos}
                                <img src="{PhotoURL-250}" data-500px="{PhotoURL-500}" {block:HighRes}data-highres="{PhotoURL-HighRes}"{/block:HighRes} alt="{Caption}">
                            {/block:Photos}
                            </div>
                        </header>
                        <section class="post-summary"></section>
                        <section class="post-full">
                        <div class="custom-photoset visuallyhidden" data-photoset-layout="{PhotosetLayout}" data-photoset-id="photoset{PostID}">
                            {block:Photos}
                                <img src="{PhotoURL-250}" data-500px="{PhotoURL-500}" {block:HighRes}data-highres="{PhotoURL-HighRes}"{/block:HighRes} alt="{Caption}">
                            {/block:Photos}
                            </div>
                            {block:Caption}{Caption}{/block:Caption}
                        </section>
                        <ul class="post-meta clearfix">
                    <li class="timeago"><a href="{Permalink}">{Timeago}</a></li>
                    <li class="icon"><a href="{Permalink}">{Icon}</a></li>
                </ul>
            {/block:Photoset}

            {block:Quote}
            <article class="quote {TagsAsClasses}" id="post_{PostID}" data-postID="{PostID}" data-permalink="{Permalink}" data-notes="{PostNotesURL}" data-urlencoded="{URLEncodedPermalink}" data-summary="{block:PostSummary}{PostSummary}{/block:PostSummary}">
                <header>
                    <p><span class="quote_start">&ldquo;</span>{Quote}<span class="quote_end">&rdquo;</span></p>
                </header>

                <section class="post-full"><p><span class="quote_start">&ldquo;</span>{Quote}<span class="quote_end">&rdquo;</span></p>
                    {block:Source}- {Source}{/block:Source}
                </section>
                <ul class="post-meta clearfix">
                    <li class="timeago"><a href="{Permalink}">{Timeago}</a></li>
                    <li class="icon"><a href="{Permalink}">{Icon}</a></li>
                </ul>
            {/block:Quote}

            {block:Link}
            <article class="link {TagsAsClasses}" id="post_{PostID}" data-postID="{PostID}" data-permalink="{Permalink}" data-notes="{PostNotesURL}" data-urlencoded="{URLEncodedPermalink}" data-summary="{block:PostSummary}{PostSummary}{/block:PostSummary}">
                <header>
                    <a href="{URL}" {Target}><p>{Name}</p></a>
                </header>

                <section class="post-full">
                    <a href="{URL}" {Target}><p>{Name}</p></a>
                    {block:Description}{Description}{/block:Description}
                </section>
                <ul class="post-meta clearfix">
                    <li class="timeago"><a href="{Permalink}">{Timeago}</a></li>
                    <li class="icon"><a href="{Permalink}">{Icon}</a></li>
                </ul>
            {/block:Link}

            {block:Chat}
            <article class="chat" id="post_{PostID}" data-postID="{PostID}" data-permalink="{Permalink}" data-notes="{PostNotesURL}" data-urlencoded="{URLEncodedPermalink}" data-summary="{block:PostSummary}{PostSummary}{/block:PostSummary}">
                <header>
                    {block:Title}<h2>{Title}</h2>{/block:Title}
                </header>

                <section class="post-full">
                    {block:Lines}<p class="{Alt} clearfix">{block:Label}<strong>{Label}</strong> &nbsp;{/block:Label}<span>{Line}</span></p>{/block:Lines}
                </section>
                <ul class="post-meta clearfix">
                    <li class="timeago"><a href="{Permalink}">{Timeago}</a></li>
                    <li class="icon"><a href="{Permalink}">{Icon}</a></li>
                </ul>
            {/block:Chat}

            {block:Audio}
            <article class="audio {TagsAsClasses}" id="post_{PostID}" data-postID="{PostID}" data-permalink="{Permalink}" data-notes="{PostNotesURL}" data-urlencoded="{URLEncodedPermalink}" data-summary="{block:PostSummary}{PostSummary}{/block:PostSummary}">
                <header>
                    <a href="{Permalink}"><p></p></a>
                </header>
                <section class="post-full">

                    {block:AudioEmbed}{AudioEmbed-500}{/block:AudioEmbed}

                {block:AudioPlayer}
                    {block:AlbumArt}<img class="album-art" src="{AlbumArtURL}" />{/block:AlbumArt}
                    {block:TrackName}{TrackName}{/block:TrackName}
                    <p><strong>{block:Artist}{Artist}{/block:Artist}{block:Album}, {Album}{/block:Album}</strong></p>
                    <div class="player">{AudioPlayerGrey}</div>
                    <div class="js-dump hidden">{JSAudioPlayerGrey}</div>
                    {/block:AudioPlayer}

                    {block:Caption}{Caption}{/block:Caption}
                </section>
                <ul class="post-meta clearfix">
                    <li class="timeago"><a href="{Permalink}">{Timeago}</a></li>
                    <li class="icon"><a href="{Permalink}">{Icon}</a></li>
                </ul>
            {/block:Audio}
            {block:Video}
            <article class="video {TagsAsClasses}" id="post_{PostID}" data-postID="{PostID}" data-permalink="{Permalink}" data-notes="{PostNotesURL}" data-urlencoded="{URLEncodedPermalink}" data-summary="{block:PostSummary}{PostSummary}{/block:PostSummary}">
                <header>
                    <!--<div class="click-block"></div>
                    <a href="{Permalink}">{Video-500}</a>
                    <div class="js-dump hidden">{JSAudioPlayerGrey}</div>-->
                </header>
                <section class="post-caption">
                    <div><span>
                    {block:Caption}{Caption}{/block:Caption}
                    </span></div>                    
                </section>
                <section class="post-full">
                    <a href="{Permalink}">{Video-500}</a>
                    <div class="js-dump hidden">{JSAudioPlayerGrey}</div>
                    {block:Caption}{Caption}{/block:Caption}
                </section>
               <ul class="post-meta clearfix">
                    <li class="timeago"><a href="{Permalink}">{Timeago}</a></li>
                    <li class="icon"><a href="{Permalink}">{Icon}</a></li>
                </ul>
            {/block:Video}

            {block:Answer}
            <article class="ask" id="post_{PostID}" data-postID="{PostID}" data-permalink="{Permalink}" data-notes="{PostNotesURL}" data-urlencoded="{URLEncodedPermalink}" data-summary="{block:PostSummary}{PostSummary}{/block:PostSummary}">
                <header>
                    <h2>{Question}</h2>
                    <p class="asker"><small>{lang:Asked by Asker}</small><br />
                        <img src="{AskerPortraitURL-16}" height="16" width="16"></p>
                </header>

                <section class="post-full">
                    {Answer}
                </section>
                <ul class="post-meta clearfix">
                    <li class="timeago"><a href="{Permalink}">{Timeago}</a></li>
                    <li class="icon"><a href="{Permalink}">{Icon}</a></li>
                </ul>
            {/block:Answer}

            {block:Date}
            <div class="post-details">                  
                <p><strong>Posted on</strong> {DayOfWeek}, {Month} {DayOfMonth}{DayOfMonthSuffix} {Year}{block:GroupMembers}, by <a href="{PostAuthorURL}" class="author-name">{PostAuthorTitle}</a>{/block:GroupMembers}</p>

                {block:HasTags}<p><strong>{lang:Tags}</strong> {block:Tags}<a href="{TagURL}" title="{Title} - {Tag}">{Tag}</a> {/block:Tags}</p>{/block:HasTags}
                <p>{block:RebloggedFrom}<strong>{lang:Reblogged from}</strong> <a href="{ReblogParentURL}">{ReblogParentTitle}</a>&nbsp;{/block:RebloggedFrom}{block:ContentSource}&nbsp;<strong>{lang:Source}</strong> {block:SourceLogo}<a href="{SourceURL}"><img src="{BlackLogoURL}" width="{LogoWidth}" height="{LogoHeight}" alt="{SourceTitle}" /></a>{/block:SourceLogo}
                {block:NoSourceLogo}{SourceLink}{/block:NoSourceLogo}{/block:ContentSource}</p>
            </div>
            <footer>
                <ul class="post-meta clearfix">

                </ul>
            </footer>
            {/block:Date}
        </article>
    </div>
    {/block:Posts}
    {/block:IndexPage} 

    </div> <!--! end of #iso --> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T05:27:16.057

# jsf - JSF 2 -- 从托管 bean 获取 PhaseListener 的实例

> ID：11421826
> 
> 赞同：1
> 
> 时间：2012-07-10T20:57:28.377
> 
> 标签：jsf, jsf-2, phaselistener

有没有办法通过 el 上下文或应用程序上下文获取 PhaseListener 的当前实例？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-10T23:18:05.350

`<f:phaseListener>`您可以使用页面上的标签获取附加到 UIViewRoot 的阶段侦听器，如下所示：

```
List<PhaseListener> phaseListeners = FacesContext.getCurrentInstance().getViewRoot().getPhaseListeners(); 
```

它返回附加到此 UIViewRoot 实例的 PhaseListener 实例的列表。

如果您想获取在 faces-config.xml 文件中注册的所有全局阶段侦听器，您可以从 LifeCycle 实例中获取它们，如下所示：

```
FacesContextFactory contextFactory = (FacesContextFactory)FactoryFinder.getFactory(FactoryFinder.FACES_CONTEXT_FACTORY);    
LifecycleFactory lifecycleFactory = (LifecycleFactory)FactoryFinder.getFactory(FactoryFinder.LIFECYCLE_FACTORY);
Iterator<String> lifecycleIds = lifecycleFactory.getLifecycleIds(); 
while (lifecycleIds.hasNext()) { 
    String lifecycleId = lifecycleIds.next(); 
    Lifecycle lifecycle = lifecycleFactory.getLifecycle(lifecycleId);
    PhaseListener[] phaseListeners= lifecycle.getPhaseListeners();
} 
```

[文档 UIViewRoot](http://docs.oracle.com/javaee/6/api/javax/faces/component/UIViewRoot.html#getPhaseListeners%28%29)

[文档生命周期](http://docs.oracle.com/javaee/6/api/javax/faces/lifecycle/Lifecycle.html#getPhaseListeners%28%29)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-13T17:08:05.097

您可以通过以下方式获取 JSF 2.0 中的当前 PhaseID：

```
PhaseId currentPhaseId = FacesContext.getCurrentInstance().getCurrentPhaseId(); 
```

# c# - Monotouch : 在 5.0 之前的设备中设置窗口

> ID：11421828
> 
> 赞同：3
> 
> 时间：2012-07-10T20:57:32.963
> 
> 标签：c#, ios, mono, xamarin.ios

在我的应用程序中，我检查设备是否运行低于 iOS 5.0 并将主视图添加到窗口，如下所示：

```
if (UIDevice.CurrentDevice.CheckSystemVersion(5, 0))
    window.RootViewController = tabBarController;
else
    window.AddSubview(tabBarController.View);
// make the window visible
window.MakeKeyAndVisible(); 
```

我的问题是：这真的需要吗？我可以总是这样做吗：

```
window.RootViewController = tabBarController; 
```

后续问题：理论上iOS（超过5.x）问世时这会起作用吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-10T21:46:47.387

如果您没有针对 iOS 5.0 进行上述检查，您的应用程序将在旧操作系统上崩溃。较旧的操作系统在 UIWindow 上没有 RootViewController 值。

具体来说，RootViewController 在 iOS 4 及更高版本中受支持，但在 iOS 5 及更高版本中是必需的：http: [//developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UIWindow_Class/UIWindowClassReference/UIWindowClassReference.html](http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UIWindow_Class/UIWindowClassReference/UIWindowClassReference.html)

当 iOS 6 出来时，代码仍然可以工作，因为`CheckSystemVersion()`确保你大于传入的值。

# binding - 在 D 中使用 Windows 库的正确方法？

> ID：11421835
> 
> 赞同：3
> 
> 时间：2012-07-10T20:58:05.633
> 
> 标签：binding, d, parallel-port

我想为[InpOut32 library](http://www.highrez.co.uk/Downloads/InpOut32/default.htm)编写 C 绑定。

首先，我为这个库下载了[二进制文件。](http://www.highrez.co.uk/scripts/download.asp?package=InpOutBinaries)

里面有三个文件：

*   inpout32.lib
*   输入32.h
*   inpout32.dll

这是我试图让 D 使用这个库的方法。

```
//io.d

extern(C)
{
    void    Out32(short PortAddress, short data);
    short   Inp32(short PortAddress);
} 
```

* * *

```
// test.d 

import std.stdio;
import io;

// parallel port address
short port = 0x0378;

void main()
{
    /* data */
    short data = 0b_00000000;
    Out32(port, data);
} 
```

**编译：** dmd -c test.d io.d**结果：**成功

**链接：**链接 test.obj io.obj inpout32.lib

但是当我尝试链接时，我得到了这个链接器错误：

> OPTLINK (R) for Win32 Release 8.00.12 版权所有 (C) Digital Mars
> 
> 1989-2010 保留所有权利。
> 
> [http://www.digitalmars.com/ctg/optlink.html](http://www.digitalmars.com/ctg/optlink.html) inpout32.lib 偏移量 00000H
> 
> 记录类型 0021 错误 138：模块或字典损坏

库文件可能是 COFF 格式。我认为`coffimplib`工具不是免费的，所以我使用 Borland 的`coff2omf`工具转为 OMF 格式。转换后我仍然得到如下链接器错误：

> 适用于 Win32 版本 8.00.12 的 OPTLINK (R)
> 
> 版权所有 (C) Digital Mars 1989-2010 保留所有权利。
> 
> [http://www.digitalmars.com/ctg/optlink.html](http://www.digitalmars.com/ctg/optlink.html)
> 
> test.obj(test) 错误 42：符号未定义 _Out32

任何想法如何使用这个库？谢谢..

* * *

**更新：** 今天我读到一篇[有趣的文章](http://www.gamedev.net/blog/1140/entry-2254003-binding-d-to-c)，关于为 D 编程语言创建与 C 库的绑定。

现在 test.exe 按预期工作。到目前为止，我已经完成了这些步骤。

**编译：** dmd -c -g test.d io.d

感谢[Ali Çehreli](https://stackoverflow.com/users/131995/ali-cehreli)提到 -g 选项。添加 -g 标志后`access violation errors`消失。

**生成OMF导入库：** implib -a inpout32.lib inpout32.dll

**链接：**链接 test.obj io.obj inpout32.lib

在此之后，我想尝试手动加载 DLL。谢谢大家花时间回答！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T12:58:17.070

您可能需要摆弄 coff2omf 或类似工具的有关前导 _ 字符的标志（检查 lib 文件以确保符号包含它们）。

或者，您可能会发现使用 implib 实用程序直接从 .dll 生成 OMF 导入库更容易。

最后，如果您只需要使用少量函数，则使用动态加载 DLL`LoadLibrary`并使用获取函数地址`GetProcAddress`将避免使用 .lib 文件的所有麻烦。

# c - 如何在 ANSI C 的数组中保存位置的值和索引？

> ID：11421836
> 
> 赞同：-1
> 
> 时间：2012-07-10T20:58:09.067
> 
> 标签：c, arrays, indexing, int

我只想知道如何将我的数组“cadenaNumeros”的值和索引保存在一个整数中，如果用户条目是这样的：123456789 或 48934013 或 183853025 ... 等。

我想用 FOR 来做，但我的代码不起作用。

例如：如果我们有这个数组“123456789”，则值将是 2 并且 index = 1，并且这个数字将它保存在一个整数中。

我正在用 ANSI C 编程。

```
#include <stdio.h>
#include <stdlib.h>

void main()
{
    int a = 0, i = 0, indice, numero[20], vuelta, quedan, x;
    int cadenaNumeros[20000];
    int num, num2;

    printf("\n\nEscribe el numero de palancas: ");
    scanf("%d", &num2);

    printf("\n\nEscriba el numero de la palanca roja: ");
    scanf("%d", &num);

    printf("\n\nIntroduzca una cadena de numeros: ");
    scanf("%d", &cadenaNumeros);

    for(i = 0; cadenaNumeros[i] < num2; i++); {
        cadenaNumeros[0] == numero[x];
        printf("%d", numero[x]);
    }

    system("PAUSE");
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T21:04:03.447

```
int index = -1, i = 0;

// Assuming num2 is the number you're searching for
// And the array size is 20000
for( ; i < 20000; i++) {
    if( cadenaNumeros[i] == num2) {
        index = i;
        break;
    }
}

if( index != -1) {
    printf( "Found %d at index %d\n", num2, index);
} 
else {
    printf( "Number not found\n");
} 
```

# python - 如何在颜色图中的颜色之间放置线条？

> ID：11421838
> 
> 赞同：0
> 
> 时间：2012-07-10T20:58:15.883
> 
> 标签：python, matplotlib

我使用 matplotlib 创建了一个离散的颜色图。如何在垂直和水平方向的颜色之间添加一条细白线，以便我可以将一个部分或盒子与另一个区分开来？

好的，这是我的代码：

```
def create_colormap(matrix):

    cmap = mpl.colors.ListedColormap(['#003300','#980000','#FF0000','#006600'])
    bounds = [-.5,.5,1.5,2.5,3.5,4.5]
    norm = mpl.colors.BoundaryNorm(bounds,cmap.N)

    img = pyplot.imshow(matrix,interpolation = 'nearest',cmap = cmap,norm=norm)

    pyplot.show() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T21:44:41.860

如果你的意思是这样的：

![在此处输入图像描述](../Images/d7a0a7d389f4a0ec708fafb4d6e8a3c1.png)

然后你需要设置`edgecolors`（你也可以设置`linewidths`属性）。这是示例代码：

```
from pylab import *
data = rand(10, 10)

c = pcolor(data)
set_cmap('Blues')
colorbar()
c = pcolor(data, edgecolors='w')
axis([0,10,0,10])
show() 
```

# javascript - 通过 JavaScript 编辑外部 SVG 图形

> ID：11421841
> 
> 赞同：1
> 
> 时间：2012-07-10T20:58:32.097
> 
> 标签：javascript, html, svg

我有一个普通的 HTML 页面，就像这个示例一样：

```
<html>
  <head>
    <title>Test</title>
  </head>
  <body>
    <img src='test.svg' id='myImage' />
  </body>
</html> 
```

是否可以编辑“img”标签中包含的 SVG 图像？我想添加圆形或动画之类的元素。

感谢帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T17:24:26.053

您应该直接在 html 中使用 svg 以便能够轻松地操作 svg。如果你有一个外部文件，你可以通过 ajax 加载它以避免重复代码（或者只是将它包含在服务器上）。我的经验是 html 中的 svg 比使用 src 属性更容易处理。

```
<html>
 <body>

 <svg xmlns="http://www.w3.org/2000/svg" version="1.1">
   <circle cx="100" cy="50" r="40" stroke="black"
   stroke-width="2" fill="red"/>
 </svg>

 </body>
 </html> 
```

# sql - 更改 SQL Server 2008 中的列名

> ID：11421842
> 
> 赞同：10
> 
> 时间：2012-07-10T20:58:44.823
> 
> 标签：sql, sql-server, sql-server-2008

如何将预定义的列名称更改为新名称。

```
eg: Column name is "Accounts"
I want to change it to "A/c" 
```

alter table emp change Accounts....[下一步]

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-07-10T21:01:04.203

重命名任何列的脚本：

```
sp_RENAME 'TableName.[OldColumnName]' , 'NewColumnName', 'COLUMN' 
```

（请注意，令人惊讶的是，您*没有*在第二个参数中使用转义符。）

重命名任何对象（表、sp 等）的脚本：

```
sp_RENAME '[OldTableName]' , 'NewTableName' 
```

请参阅[此处](http://blog.sqlauthority.com/2008/08/26/sql-server-how-to-rename-a-column-name-or-table-name/)了解更多信息

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-07-10T21:05:50.030

您需要使用 sp_rename 命令，或使用 Management Studio 直观地执行此操作 - 确保您在安静的时期执行此操作，并确保它已在预生产中通过测试首先完成！

顺便说一句，我会远离空调——斜线符号是特殊含义的除法。

sp_rename 的文档在这里，示例 B 是最合适的。 [http://msdn.microsoft.com/en-us/library/ms188351.aspx](http://msdn.microsoft.com/en-us/library/ms188351.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-12-21T06:36:56.150

```
sp_rename 'table_name.accounts', 'A/C', 'column' 
```

this query will solve your problem.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-19T11:49:38.033

重命名任何列名的命令：

```
sp_RENAME 'TableName.[OldColumnName]' , 'NewColumnName' 
```

它在最后不使用第三个参数**“列”**的情况下工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-11T06:12:28.950

您可以`sp_rename`用作：

```
sp_RENAME 'TableName.[OldColumnName]' , '[NewColumnName]', 'COLUMN' 
```

因为你的代码是这样的：

```
sp_RENAME 'table.Accounts','Acc','COLUMN' 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-07-26T15:00:29.293

这是 sp_rename 的代码

```
sp_RENAME 'emp.Accounts' , 'Acc' 
```

我使用了类似的东西并且工作了

# c# - WP7 如何简化此代码或任何更好的方法？

> ID：11421843
> 
> 赞同：0
> 
> 时间：2012-07-10T20:58:49.647
> 
> 标签：c#, windows-phone-7

有没有办法简化这段代码？或以任何方式创建另一个类页面以保持主页尽可能干净。我计划拥有数百个文本文件，因为我是新手，所以我不是解决这个问题的最佳方法。我正在尝试制作一个带有 Xbox 360 成就指南的应用程序，但每场游戏平均大约有 40 个成就。（这是分配的文本文件）。

```
if (selectedIndex == "0")
{
    var Tutorial = Application.GetResourceStream(new Uri("Resources/Games/MaxPayne3/StoryRelated.txt", UriKind.Relative));

    using (Stream Text = Tutorial.Stream)
    {
        StreamReader sr = new StreamReader(Text);
        Guide.Text = "Story Complete [MEDIUM]\n" + Environment.NewLine + sr.ReadToEnd();
        Title.Text = "Feel The Payne";
        AppBarMenuDisable.IsEnabled = false;
    }
}
else if (selectedIndex == "1")
{
    var Tutorial = Application.GetResourceStream(new Uri("Resources/Games/MaxPayne3/StoryRelated.txt", UriKind.Relative));

    using (Stream Text = Tutorial.Stream)
    {
        StreamReader sr = new StreamReader(Text);
        Guide.Text = "Story Complete [HARD]\n" + Environment.NewLine + sr.ReadToEnd();
        Title.Text = "Serious Payne";
        AppBarMenuDisable.IsEnabled = false;
    }
}
else if (selectedIndex == "2")
{
    var Tutorial = Application.GetResourceStream(new Uri("Resources/Games/MaxPayne3/StoryRelated.txt", UriKind.Relative));

    using (Stream Text = Tutorial.Stream)
    {
        StreamReader sr = new StreamReader(Text);
        Guide.Text = "Story Complete [OLD SCHOOL]\n" + Environment.NewLine + sr.ReadToEnd();
        Title.Text = "Maximum Payne";
        AppBarMenuDisable.IsEnabled = false;
    }
}
else if (selectedIndex == "3")
{
    var Tutorial = Application.GetResourceStream(new Uri("Resources/Games/MaxPayne3/TextFile1.txt", UriKind.Relative));

    using (Stream Text = Tutorial.Stream)
    {
        StreamReader sr = new StreamReader(Text);
        Guide.Text = sr.ReadToEnd();
        Title.Text = "Payne In The Ass";
        AppBarMenuDisable.IsEnabled = false;
    }
}
else if (selectedIndex == "4")
{
    var Tutorial = Application.GetResourceStream(new Uri("Resources/Games/MaxPayne3/StoryRelated.txt", UriKind.Relative));

    using (Stream Text = Tutorial.Stream)
    {
        StreamReader sr = new StreamReader(Text);
        Guide.Text = sr.ReadToEnd();
        Title.Text = "Part I Complete";
        AppBarMenuDisable.IsEnabled = false;
    }
}
else if (selectedIndex == "5")
{
    var Tutorial = Application.GetResourceStream(new Uri("Resources/Games/MaxPayne3/StoryRelated.txt", UriKind.Relative));

    using (Stream Text = Tutorial.Stream)
    {
        StreamReader sr = new StreamReader(Text);
        Guide.Text = sr.ReadToEnd();
        Title.Text = "Part II Complete";
        AppBarMenuDisable.IsEnabled = false;
    }
}
else if (selectedIndex == "6")
{
    var Tutorial = Application.GetResourceStream(new Uri("Resources/Games/MaxPayne3/StoryRelated.txt", UriKind.Relative));

    using (Stream Text = Tutorial.Stream)
    {
        StreamReader sr = new StreamReader(Text);
        Guide.Text = sr.ReadToEnd();
        Title.Text = "Part III Complete";
        AppBarMenuDisable.IsEnabled = false;
    }
}
else if (selectedIndex == "7")
{
    var Tutorial = Application.GetResourceStream(new Uri("Resources/Games/MaxPayne3/TextFile2.txt", UriKind.Relative));

    using (Stream Text = Tutorial.Stream)
    {
        StreamReader sr = new StreamReader(Text);
        Guide.Text = sr.ReadToEnd();
        Title.Text = "A New York Minute";
        AppBarMenuDisable.IsEnabled = false;
    }
}
else if (selectedIndex == "8")
{
    var Tutorial = Application.GetResourceStream(new Uri("Resources/Games/MaxPayne3/TextFile3.txt", UriKind.Relative));

    using (Stream Text = Tutorial.Stream)
    {
        StreamReader sr = new StreamReader(Text);
        Guide.Text = sr.ReadToEnd();
        Title.Text = "The Shadows Rushed Me";
        AppBarMenuDisable.IsEnabled = false;
    }
}
else if (selectedIndex == "9")
{
    var Tutorial = Application.GetResourceStream(new Uri("Resources/Games/MaxPayne3/TextFile4.txt", UriKind.Relative));

    using (Stream Text = Tutorial.Stream)
    {
        StreamReader sr = new StreamReader(Text);
        Guide.Text = sr.ReadToEnd();
        Title.Text = "Out The Window";
        YouTubeLink.URL = "http://www.youtube.com/watch?v=lRg6ygA-M_Y";
    }
} 
```

我希望将这些文本文件放在 Internet 的某个位置，因为用户可以根据需要检索它们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T21:25:13.743

这只是一个匿名结构的例子，你也可以用 xml + linq 扩展它

```
var actions = new[]
{
 new {
  index = 0, 
  uri = "Resources/Games/MaxPayne3/StoryRelated.txt", 
  guide = "Story Complete [MEDIUM]\n\n", 
  title = "Feel The Payne", 
  appBar = false, 
  youtube = ""
 },

 new {
  index = 7, 
  uri = "Resources/Games/MaxPayne3/TextFile2.txt", 
  guide = "", 
  title = "A New York Minute", 
  appBar = false, 
  youtube = ""
 },

 new {
  index = 9, 
  uri = "Resources/Games/MaxPayne3/TextFile4.txt", 
  guide = "", 
  title = "Out The Window", 
  appBar = true, 
  youtube = "http://www.youtube.com/watch?v=lRg6ygA-M_Y"
 },
};

var actionQuery = actions.Where(a => a.index == selectedIndex).ToArray();

if (actionQuery.Length == 0) throw new Exception("Index not found: " + selectedIndex);
if (actionQuery.Length > 1) throw new Exception("Duplicate entries found: " + selectedIndex);

var action = actionQuery[0];

var Tutorial = Application.GetResourceStream(new Uri(action.uri, UriKind.Relative));

using (Stream Text = Tutorial.Stream)
{
 StreamReader sr = new StreamReader(Text);
 Guide.Text = action.guide + sr.ReadToEnd();
 Title.Text = action.title;
 AppBarMenuDisable.IsEnabled = action.appBar;
 if (action.youtube != "") YouTubeLink.URL = action.youtube;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T21:30:13.527

你应该用实际的类填充 ListBox（我猜它是一个 ListBox）

```
public class Tutorial
{
    public string Location { get; set; }
    public string Title { get; set; }
    public string Prefix { get; set; }
} 
```

使用此类，用这些类填充 ListBox。最好将此列表采用 xml/json 格式，或者更好地从网络上获取。

```
List<Tutorial> tutorials = new List<Tutorial()
{
    new Tutorial 
    { 
        Location = "Resources/Games/MaxPayne3/StoryRelated.txt",
        Title = "Feel the Payne",
        Prefix = "Story Complete [MEDIUM]\n"
    }
    // add more
};
ListBox.ItemsSource = tutorials; // better to do binding to this property 
```

然后在 selectionchanged 事件中

```
Tutorial tutorial = ListBox.SelectedItem as Tutorial;
if(tutorial == null) return;

var item = Application.GetResourceStream(new Uri(tutorial.Location, UriKind.Relative));

using (Stream Text = Tutorial.Stream)
{
    StreamReader sr = new StreamReader(Text);
    Guide.Text = tutorial.Prefix + sr.ReadToEnd();
    Title.Text = tutorial.Tile;
    AppBarMenuDisable.IsEnabled = false;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-10T21:18:34.357

你把事情复杂化了。如果您真的想将所有数据与应用程序捆绑在一起，您可以[将其序列化为 XML](http://www.eugenedotnet.com/2010/11/windows-phone-7-serialization-xmlserializer/)或[JSON](http://mobile.dzone.com/news/windows-phone-7-serialization-1?utm_source=feedburner&utm_medium=feed&utm_campaign=Feed%3a%20zones/dotnet%20%28.NET%20Zone%29)，然后在内部对其进行反序列化。

这也为您的代码增加了灵活性，因为从长远来看，当您决定添加更改时，像您一样直接使用硬编码值可能会导致一些麻烦。

# forms - 将会话值设置为 jsp 隐藏表单值

> ID：11421845
> 
> 赞同：0
> 
> 时间：2012-07-10T20:59:23.047
> 
> 标签：forms, jsp, session, jstl

我正在检索并将值（数据）设置到会话中。

```
session.setAttribute("data", result.getBody().getData()); 
```

如何将会话的值设置为表单值？路径数据接受字符串值。

```
<td><form:input type="hidden" path="data" value="?"/></td> 
```

这可能吗？我应该使用 JSTL 函数来成功吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T03:53:46.583

尝试如下操作（使用 EL）：

```
<form:input type="hidden" value="${sessionScope.data}"/> 
```

# wpf - 如何翻译 StringFormat 表达式中的文本？

> ID：11421846
> 
> 赞同：2
> 
> 时间：2012-07-10T20:59:23.420
> 
> 标签：wpf

我正在使用资源文件进行翻译，典型的标签如下所示：

```
<Label Content="{x:Static Resx:FrmMngView.MsgLastModification}"/> 
```

在某些情况下正在使用 StringFormat，我想翻译它们：

```
<TextBlock Text="{Binding Items.ItemCount, StringFormat=users: {0}}" /> 
```

其中“用户”一词在法语中的翻译是“utilisateur”。我如何在这里使用我的 resx 翻译密钥？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-10T21:01:32.060

您可以将整个格式字符串保存为资源并在`Binding.StringFormat`.

# mysql - 更新域 (DB) 实体时添加列或创建新表？

> ID：11421850
> 
> 赞同：0
> 
> 时间：2012-07-10T20:59:29.003
> 
> 标签：mysql, sql, database, database-normalization

在我的数据库中，我有一个名为 Person 的表，其中包含 ID 和名称的行，这暂时可以正常工作。后来，在部署之后，我意识到我希望一个人也有一个地址（每个人一个地址）。做这个的最好方式是什么？使用地址的新列更新表或为地址创建新表地址并将两个表与引用链接？或者，也许，我应该有一张 Person 表、一张 Address 表和一张 PersonAddressRelation 表，两者都有键。

我对表格规范化有所了解。我的问题是：如果您预测它们可能会改变，如何建立一个表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-10T21:07:51.650

总是，在每个表中，使用一个主要的、自动递增的键；并确保您从一开始就拥有最好的数据库结构；为什么 ？因为一旦你开始填充信息，数据库表就会增加，你不知道它们会变得多大；如果假设每张桌子有 1000 万条信息，您需要添加一个新字段，没关系，这需要一些时间......但是如果您尝试 1 亿条......你就完成了......游戏结束......所以，从一开始就尽力而为，始终通过唯一的ID识别每个信息

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-10T21:04:24.267

我建议多`address`一张桌子。这样你就可以在`person`表中添加一个外键，也许有一天你需要有多个地址的人。

# jquery - 如何使用 jQuery 扩大点击并缩小点击其他地方？

> ID：11421857
> 
> 赞同：0
> 
> 时间：2012-07-10T21:00:00.237
> 
> 标签：jquery

我只是在学习 jQuery，我想知道为什么我的小脚本不起作用。它扩大了，但我似乎无法让它缩小。

```
$('.strech').click(function(){
    $(this).animate({
        width: '210px'
    }, 500 );
});

$('body').click(function(e) {
    if (!$(e.target).is('.strech')) {
        ('.strech').animate({
            width: '185px'
        }, 500 );
    }
}); 
```

# java - 在 Java 中，更改后的 @NamedQueries 是否立即可用，或者 Hibernate 中是否存在缓存问题？

> ID：11421858
> 
> 赞同：0
> 
> 时间：2012-07-10T21:00:04.543
> 
> 标签：java, hibernate, named-query

在 Java 中，更改后的 @NamedQueries 是否立即可用，或者 Hibernate 中是否存在缓存问题？

```
@NamedQueries( {
    @NamedQuery(name = etc.. 
```

我对 2 @NamedQuery 进行了更改，但他们没有做他们应该做的事情。

Hibernate 需要重启吗？

缓存在某处清除？

只是需要时间，他们会出现吗？

更改@NamedQueries 时的具体过程是什么？

太感谢了！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-10T21:40:15.937

您不能更改命名查询。它们是类源代码的一部分。如果在源文件中更改它们，则需要重新编译源文件并重新启动应用程序。

# nservicebus - 在自托管场景中测试 ProfileHandler

> ID：11421861
> 
> 赞同：1
> 
> 时间：2012-07-10T21:00:14.403
> 
> 标签：nservicebus

我和我的团队目前正在开发一个服务框架，并且正在努力解决如何最好地处理集成测试。目前，我们正在自托管 NServiceBus，这在一定程度上很好；但是，现在我们想使用 NServiceBus Profiles/ProfileHandlers 引导框架。我不知道如何在自托管场景中指定配置文件，或者是否有可能。我们想使用通用主机，但我真的不知道它在测试场景中如何工作，因为主机需要自己的进程（无论如何据我所知）。

基本上，我想知道我的上述假设是否正确，如果是，其他人是如何解决这些问题的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T18:04:45.660

我们通过 NSB(NServiceBus.Testing.dll) 中提供的测试框架运行单元测试。这里的一切都是在本地内存中完成的。使用基础设施，我们只在命令行上使用通用主机。这不需要您安装 Windows 服务。只需使用您指定的配置文件从命令行运行 NServiceBus.Host.exe。我你想启动一堆这些，一个简单的脚本就可以了。

# php - 如何为 CURLOPT_RETURNTRANSFER 实施解决方法

> ID：11421862
> 
> 赞同：0
> 
> 时间：2012-07-10T21:00:15.417
> 
> 标签：php, curl, transfer

我使用此代码[http://martinsikora.com/how-to-steal-google-s-did-you-mean-feature](http://martinsikora.com/how-to-steal-google-s-did-you-mean-feature)对我的搜索执行“您的意思是”，但我的托管服务提供商设置了 open_basedir 并且不会 leyt我改变。我已经看到了一些解决方法，但我不知道如何将这些实现到他的代码中。

这里的片段：

```
$ch = curl_init($url);
curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 10);
curl_setopt($ch, CURLOPT_TIMEOUT, 10);
curl_setopt($ch, CURLOPT_HEADER, true);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_USERAGENT, $agents[rand(0, count($agents) - 1)]);
$data = curl_exec($ch);
curl_close($ch); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T22:35:28.550

多么奇怪和烦人（基本上没有记录）的限制，尤其是当它可以很容易地解决时。您需要做的就是检查`3xx`响应代码，然后检查`Location:`标头的内容以找到您被重定向到的 URL。

这并不像我喜欢的那样微不足道，因为有许多应用程序违反了 RFC，并且不使用完整的 URL 作为位置标头中的数据 - 所以你需要做一些捏造来获得正确的地点。

像这样的东西应该适用于您的代码（未经测试）：

```
function make_url_from_location ($oldUrl, $locationHeader) {
  // Takes a URL and a location header and calculates the new URL
  // This takes relative paths (which are non-RFC compliant) into
  // account, which most browsers will do. Requires $oldUrl to be
  // a full URL

  // First check if $locationHeader is a full URL
  $newParts = parse_url($locationHeader);
  if (!empty($newParts['scheme'])) {
    return $locationHeader;
  }

  // We need a path at a minimum. If not, return the old URL.
  if (empty($newParts['path'])) {
    return $oldUrl;
  }

  // Construct the start of the new URL
  $oldParts = parse_url($oldUrl);
  $newUrl = $oldParts['scheme'].'://'.$oldParts['host'];
  if (!empty($oldParts['port'])) {
    $newUrl .= ':'.$oldParts['port'];
  }

  // Build new path
  if ($newParts['path'][0] == '/') {
    $newUrl .= $newParts['path'];
  } else {
    // str_replace() to work around (buggy?) Windows behaviour where one level
    // paths cause dirname to return a \ instead of a /
    $newUrl .= str_replace('\\', '/', dirname($oldParts['path'])).$newParts['path'];
  }

  // Add a query string
  if (!empty($newParts['query'])) {
    $newUrl .= '?'.$newParts['query'];
  }

  return $newUrl;

}

$maxRedirects = 30;

$redirectCount = 0;
$complete = FALSE;

// Get user agent string once at start - array_rand() is tidier
// For these purposes, a single static string will probably be fine
$userAgent = $agents[array_rand($agents)];

do {

  // Make the request
  $ch = curl_init($url);
  curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 10);
  curl_setopt($ch, CURLOPT_TIMEOUT, 10);
  curl_setopt($ch, CURLOPT_HEADER, true);
  curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
  curl_setopt($ch, CURLOPT_USERAGENT, $userAgent]);
  $data = curl_exec($ch);

  // Get the response code (easier than parsing it from the headers)
  $responseCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);

  // Split header from body
  $data = explode("\r\n\r\n", $data, 2);
  $header = $data[0];
  $data = $data[1];

  // Check for redirect response codes
  if ($responseCode >= 300 && $responseCode < 400) {

    if (!preg_match('/^location:\s*(.+?)$/mi', $header, $matches)) {
      // This is an error. If you get here the response was a 3xx code and
      // no location header was set. You need to handle that error here.
      $complete = TRUE;
    }

    // Get URL for next iteration
    $url = make_url_from_location(curl_getinfo($ch, CURLINFO_EFFECTIVE_URL), trim($matches[1]));

  } else {

    // Non redirect response code (might still be an error code though!)
    $complete = TRUE;

  }

// Loop until no more redirects or $maxRedirects is reached
} while (!$complete && ++$redirectCount < $maxRedirects);

// Perform whatever error checking is necessary here

// Close the cURL handle
curl_close($ch); 
```

# spring - 使用 Spring 和 Embedded Jetty 8 发布 JAX-WS 服务

> ID：11421865
> 
> 赞同：0
> 
> 时间：2012-07-10T21:00:20.207
> 
> 标签：spring, maven, jax-ws, netbeans-7, embedded-jetty

我正在尝试将 JAX-WS Web 服务添加到我的 Embedded Jetty 应用程序。Web 服务客户端将是一个 .NET 应用程序。

我的项目是在 Netbeans 7.1.1 中作为 Maven 应用程序创建的。它使用 Spring 3.0。

我采取了以下步骤将 JAX-WS 添加到我的应用程序中：

1.  在 pom.xml 中添加了 jaxws-spring。

    ```
    <dependency>
        <groupId>org.jvnet.jax-ws-commons.spring</groupId>
        <artifactId>jaxws-spring</artifactId>
        <version>1.8</version>
        <exclusions>
            <exclusion>
                <groupId>javax.servlet</groupId>
                <artifactId>servlet-api</artifactId>
            </exclusion>
            <exclusion>
                <groupId>org.springframework</groupId>
                <artifactId>spring</artifactId>
            </exclusion>
            <exclusion>
                <groupId>org.springframework</groupId>
                <artifactId>spring-core</artifactId>
            </exclusion>
            <exclusion>
                <groupId>org.springframework</groupId>
                <artifactId>spring-context</artifactId>
            </exclusion>
        </exclusions>
    </dependency> 
    ```

2.  在我的 Spring Web 服务上下文中，配置 WSSpringServlet。

    ```
    webservicesContext.addServlet(new ServletHolder(new WSSpringServlet()), "/service/*"); 
    ```

3.  为我的服务创建了一个实现类。

    ```
    @WebService(name = "GenerateUEIDService")
    public class GenerateUEIDService {

        @WebMethod(operationName = "generateUniqueIds")
        public String generateUniqueIds() {
            return "Hello World";
        }

    } 
    ```

4.  在 Spring applicationContext.xml 文件中配置我的服务。

    ```
    <bean id="generateUEIDService" class="com.mycompany.GenerateUEIDService"/>

    <wss:binding url="/service/GenerateUEID.svc">
     <wss:service>
      <ws:service bean="#generateUEIDService" />
     </wss:service>
    </wss:binding> 
    ```

对于上面的第 3 步，我没有在 Netbeans 中使用任何 Web 服务创建向导。相反，我将 GenerateUEIDService 创建为普通的 Java 类，但添加了注释。即使我没有 Netbeans 确实以某种方式检测到这是一个 Web 服务，因为它在项目视图中创建了一个“Web 服务”节点，其下方有“GenerateUEIDServiceService”。如果我展开 GenerateUEIDServiceService，我会看到“generateUniqueIds: String”。

它似乎构建得很好。但是当我运行应用程序时，我得到：

> com.sun.xml.ws.model.RuntimeModelerException：运行时建模器错误：未找到包装类 com.mycompany.jaxws.GenerateUniqueIds。你有没有运行 APT 来生成它们？

不，我没有运行 APT 来生成任何东西。鉴于我的配置，我应该怎么做？我需要在我的 pom.xml 中添加插件吗？还是 Netbeans 神奇地应该为我生成包装器？

请注意，我的 Web 服务客户端将是 .NET。所以我假设我应该使用文档/文字包装的默认 SOAPBinding。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T12:46:36.400

我决定创建一个简单的 Netbeans Maven java 应用程序来查看服务的包装类是否会自动生成。原来它们是由 JAX-WS 运行时在运行时动态创建的。

```
[exec:exec]
Jul 12, 2012 8:30:05 AM com.sun.xml.internal.ws.model.RuntimeModeler getRequestWrapperClass
INFO: Dynamically creating request wrapper Class com.mycompany.mavenjaxwsjetty.jaxws.Greet
Jul 12, 2012 8:30:05 AM com.sun.xml.internal.ws.model.RuntimeModeler getResponseWrapperClass
INFO: Dynamically creating response wrapper bean Class com.mycompany.mavenjaxwsjetty.jaxws.GreetResponse 
```

所以回到我原来的应用程序（来自上面的原始帖子）。由于不相关的原因，我删除了 jaxws-spring 的东西。我可能还做了一些我不记得的其他更改。现在，当我运行该应用程序时，我可以在日志中看到正在创建包装类。

所以我想我的问题的答案是 Netbeans 不会神奇地为我创建包装类，而是 jax-ws 运行时会。

我仍然想知道在什么情况下不会为我自动生成包装类。或者当我想使用 wsgen 或 maven-jaxb2-plugin 生成我自己的。像往常一样，我想“给猫剥皮”的方法不止一种，每种方法都有其优点和缺点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T05:18:09.073

您可以使用 Maven 插件生成 jaxb 类。它应该如下所示：

```
<plugin>
    <groupId>org.jvnet.jaxb2.maven2</groupId>
    <artifactId>maven-jaxb2-plugin</artifactId>
    <version>0.8.1</version>
    <executions>
        <execution>
            <goals>
                <goal>generate</goal>
            </goals>
        </execution>
    </executions>
    <configuration>
        <source>1.6</source>
        <target>1.6</target>
        <!--
        <generatePackage>if you wan to force the package</generatePackage>
        -->
        <generateDirectory>target/jaxb/generate/</generateDirectory>
        <schemaDirectory>src/main/webapp/WEB-INF/</schemaDirectory>
        <includeSchemas>
            <includeSchema>yourXSDfile.xsd</includeSchema>
        </includeSchemas>
    </configuration>
</plugin> 
```

# mysql - Qt 4.8.0 构建的 MySQL 插件失败

> ID：11421868
> 
> 赞同：0
> 
> 时间：2012-07-10T21:00:34.627
> 
> 标签：mysql, qt

我正在尝试为 Qt 项目构建 MySQL 插件。我正在按照其他地方给出的说明进行操作，但似乎 qmake 生成的 makefile 有错误，并且生成 DLL 的 nmake 失败。

有人有替代程序吗？

有谁知道为什么我们不能为此下载 MySQL DLL？为什么每个人都必须建造它？

这是过程；

```
qmake "INCLUDEPATH+=c:/'Program Files'/MySQL/'Connector C 6.0.2'/include" "LIBS+=-Lc:/'Program Files'/MySQL/'Connector C 6.0.2'/lib/debug " mysql.pro

c:\QtSDK\QtSources\4.8.0\src\plugins\sqldrivers\mysql>nmake debug

Microsoft (R) Program Maintenance Utility Version 10.00.30319.01
Copyright (C) Microsoft Corporation.  All rights reserved.
    "c:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\bin\nmake.exe" -f Makefile.Debug

Microsoft (R) Program Maintenance Utility Version 10.00.30319.01

Copyright (C) Microsoft Corporation.  All rights reserved.

    rc -D_DEBUG -DUNICODE -DWIN32 -DQT_LARGEFILE_SUPPORT -DQT_NO_CAST_TO_ASCII -DQT_NO_CAST_FROM_ASCII -DQT_DLL -DQT_PLUGIN -DQT_SQL_LIB -DQT_CORE_LIB -DQT_HAVE_MMX -DQT_HAVE_3
DNOW -DQT_HAVE_SSE -DQT_HAVE_MMXEXT -DQT_HAVE_SSE2 -DQT_THREAD_SUPPORT -fo debug\qsqlmysqld_resource.res qsqlmysqld_resource.rc

'rc' is not recognized as an internal or external command,
operable program or batch file.
NMAKE : fatal error U1077: 'rc' : return code '0x1'
Stop.
NMAKE : fatal error U1077: '"c:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\bin\nmake.exe"' : return code '0x2'
Stop. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T06:53:33.110

我会冒险猜测您是从普通命令提示符/窗口而不是 Visual Studio 版本构建的。这意味着可能并非所有路径都设置正确，并且找不到 rc 命令。

所以尝试再次构建，但这次来自[Visual Studio 命令提示符](http://msdn.microsoft.com/en-us/library/ms229859%28v=vs.100%29.aspx)。例如，您可以在开始菜单的 Visual Studio 条目中的“Visual Studio 工具”下找到它。

您也可以运行[VCVARS32](http://msdn.microsoft.com/en-us/library/f2ccy3wt%28v=vs.100%29.aspx)在常规命令提示符中设置所有适当的路径，但实际上没有必要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T17:09:49.707

虽然我解决了使用 nmake 构建插件的问题，但它并没有产生 Qt 识别的插件。

相反，我使用 QtCreator 和包含在 (Your Qt source folder path/src/plugins/sqldrivers/mysql

必须编辑 .pro 文件，以便包含和 lib 路径与您的 MySQL 安装相匹配。.pro 文件中的条目在路径中包含空格，但这并没有构建。我必须从 mysql 路径中取出所有空格才能构建它。我将 MySQL 从“Program Files (x86)”拖到 C: 并从文件夹名称中删除了空格。

接下来，调试版本指定 -llibmysqld 似乎不再存在。我将其更改为 -llibmysql （与发行版相同），然后两个 dll 都构建得很好。

我使用了 Qt Creator 2.6.2、Qt 4.8.4。生成的 dll 可用于在 Visual Studio 2010 和 Windows 7 下构建的 Qt 项目。

# ruby-on-rails - 无法更新用户属性 - Rails 和 Devise

> ID：11421873
> 
> 赞同：4
> 
> 时间：2012-07-10T21:00:54.370
> 
> 标签：ruby-on-rails, ruby, activerecord, devise

我正在将 Rails (3.0.9) 与 Devise (1.5.3) 一起使用，并且我有一个用户模型，其中的属性由于某种我不知道的原因而无法更新。

此 User 对象的表单具有许多属性，包括来自 devise 的属性：例如 password 和 password_confirmation。

当我提交表单时，我在记录器中得到了这个：

`WARNING: Can't mass-assign protected attributes: current_password`

但是当我添加时`current_password`，`attr_accessible`我得到：

`ActiveRecord::UnknownAttributeError at /users unknown attribute: current_password`

我不是很喜欢设计，但我认为 current_password 只是一个虚拟属性。这个错误很烦人，你知道为什么会这样吗？我一无所知。

顺便说一句，我的`Users::RegistrationsController#update`行动：

```
def update
  logger.error "SALMONELLA " + self.resource.password.inspect

  self.resource = resource_class.to_adapter.get!(send(:"current_#{resource_name}").to_key)

  #params[:user].delete [:current_password]

  if resource.update_attributes(params[:user])
    Resque.enqueue(MdcUpdateUser, resource.id)
    set_flash_message :notice, :updated if is_navigational_format?
    sign_in resource_name, resource, :bypass => true
    respond_with resource, :location => after_update_path_for(resource)
  else
    clean_up_passwords(resource)
    respond_with_navigational(resource){ render_with_scope :edit }
  end
end 
```

我尝试过使用 Devise`update_without_password`并尝试`current_password`从`params[:user]`哈希中删除但没有成功。

我很感激你给我的任何帮助。如果您认为此问题中缺少任何信息，请询问更多信息。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-17T19:08:20.877

然后您可能还必须添加`attr_accessor :current_password`到您的模型中。另请参阅 [Devise Wiki](https://github.com/plataformatec/devise/wiki/How-To:-Allow-users-to-edit-their-password)和[此问题](https://github.com/plataformatec/devise/issues/1620)以获取更多信息。

# java - Downsampling audio from 44.1kHz to 16kHz in Java

> ID：11421874
> 
> 赞同：5
> 
> 时间：2012-07-10T21:01:02.867
> 
> 标签：java, audio, applet, javasound, apache-commons-httpclient

I have an application that records a speech sample from the user's microphone and uploads it to a server which then does some stuff with it. It seems I must record with the following parameters to avoid an `IllegalArgumentException`:

```
Encoding encoding = AudioFormat.Encoding.PCM_SIGNED;
float sampleRate = 44100.0F;
int sampleSizeInBits = 16;
int channels = 2;
int frameSize = 4;
float frameRate = 44100.0F;
boolean bigEndian = false; 
```

But I need to have it recorded at 16khz, not 44.1, (sampleRate and framerate both, I assume) and it must be in mono (1 channel). The PCM signed is also mandatory, so thats good. (The server is VERY picky and I cannot make any changes to it.) How can I convert this using Java?

I am submitting the audio file via HttpClient as a Filebody to a servlet, saving it on the server, and then processing it.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-10T21:18:52.707

Here are a few good links to get started on your own:

*   [Using Files and Format Converters](http://docs.oracle.com/javase/7/docs/technotes/guides/sound/programmer_guide/chapter7.html#114640)
*   [Java Sound Tutorial](http://docs.oracle.com/javase/tutorial/sound/index.html)

Alternatively (for quick use) this **FREE** library here is what you'd want:

*   [SampleRateConverter.java](http://www.jsresources.org/examples/SampleRateConverter.html)

# ruby-on-rails - 创建或更新后可以自动重新加载实例吗？

> ID：11421875
> 
> 赞同：4
> 
> 时间：2012-07-10T21:01:03.513
> 
> 标签：ruby-on-rails, postgresql, activerecord

在我们的 Rails 3.2.6 应用程序中，我们有一个名为“version”的模型属性，每当创建或更新实例（通过触发器）时，该属性都会在数据库级别递增。但是，在我们成功创建或更新后，数据库设置的新值不会返回给我们的实例，除非我们显式执行 instance.reload。

**有谁知道在持久化到数据库后让活动记录自动重新加载实例的方法？**

## 背景

在我们的 Rails 3.2.6 应用程序中，我们有 3 个表，每个表都有一个“版本”列。在所有 3 个表中，“版本”整数列需要在每次插入和更新期间递增，并且“版本”绝不能重复。

简单的解决方案：我们在 postgres 中创建了一个所有 3 个表共享的 version_sequence。我们有一个小触发器，它使用 nextval('version_sequence') 值更新这些表中任何记录的版本列：

```
 -- Resource Version Sequence
  CREATE SEQUENCE resource_versions_seq;

  -- Resource Version Trigger
  CREATE FUNCTION update_resource_version() RETURNS trigger AS $update_resource_version$
    BEGIN
      NEW.version := nextval('resource_versions_seq');
      RETURN NEW;
    END;
  $update_resource_version$ LANGUAGE plpgsql; 
```

但是，当我们在 active_record 中创建、保存或更新属性时，新的“版本”值不会在记录被持久化后重新加载。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-10T21:17:43.870

如何使用 after_save 回调？在此回调中，您可以仅获取该字段，然后将其设置在模型上。像这样的东西：

```
class Thing < ActiveRecord::Base
  after_save :refresh_version

  def refresh_version
    self.version = Thing.find(self.id).select(:version)
  end

end 
```

# python - 使用列表而不是 numpy 数组

> ID：11421879
> 
> 赞同：1
> 
> 时间：2012-07-10T21:01:12.547
> 
> 标签：python, numpy, python-3.x, scipy

我将列表（和列表列表）作为标准数据结构（我的大多数函数返回列表/列表列表）。但现在我必须使用一些 Numpy 函数。在使用 numpy/scipy 中的任何函数之前，我是否必须将所有列表转换为 numpy 数组？例如

```
>>>x= [[1, 2, 3], [4, 5, 6], [7, 8, 9]] 
>>>y= [ 1, 10, 20]
>>>dot(x,y)
#array([ 81, 174, 267])
>>>X_np=array(x)
>>>y_np=array(y)
>>>dot(x_np,y_np)
#array([ 81, 174, 267]) 
```

在这种情况下 dot(x,y) 和 dot(x_np,y_np) 给出了相同的结果，所以使用 list 而不是 numy 数组并没有什么区别......但这是所有 numpy/scipy 函数的情况还是我`my_np_array= array(my_list)`在调用任何/所有 numpy/scipy 函数之前必须做什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-10T22:51:43.003

几乎所有 numpy/scipy 函数都会在对输入进行操作之前将输入转换为数组。但为什么要相信我？只需尝试您需要的任何一个，看看它是否有效。

例外情况是任何修改数组的函数，`np.put`例如。

```
>>> np.put([1,2,3],[0,1],[2,1])
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/usr/lib/python2.7/dist-packages/numpy/core/fromnumeric.py", line 394, in put
    return a.put(ind, v, mode)
AttributeError: 'list' object has no attribute 'put' 
```

# python - 两个等高线图的颜色条

> ID：11421882
> 
> 赞同：1
> 
> 时间：2012-07-10T21:01:37.193
> 
> 标签：python, colorbar

我有两个等高线图，但我希望颜色条适用于两者。到目前为止，我的代码已显示。如何创建可以应用于两个图的单个颜色条？

```
 import numpy as np
    import matplotlib.pyplot as plt
    import matplotlib.tri as tri
    import scipy, pylab
    x=[14.86,   14.48,  14.09,  13.70,  13.32,  12.93,  12.54,  12.16,  14.82,  14.43,  14.04,  13.65,  13.26,  12.87,  12.48,  12.09,  14.16,  13.71,  13.26,  12.82,  12.37,  11.92,  11.47,  11.02,  13.48,  12.96,  12.44,  11.93,  11.41,  10.90,  10.38,  9.86,   12.79,  12.21,  11.62,  11.04,  10.45,  9.87,   9.29,   8.70,   12.10,  11.48,  10.85,  10.23,  9.60,   8.98,   8.35,   7.73,   11.72,  11.08,  10.44,  9.79,   9.15,   8.51,   7.87,   7.23]

    y= [0.00,   0.00,   0.00,   0.00,   0.00,   0.00,   0.00,   0.00,   3.17,   3.17,   3.17,   3.17,   3.17,   3.17,   3.17,   3.17,   6.43,   6.43,   6.43,   6.43,   6.43,   6.43,   6.43,   6.43,   9.60,   9.60,   9.60,   9.60,   9.60,   9.60,   9.60,   9.60,   12.77,  12.77,  12.77,  12.77,  12.77,  12.77,  12.77,  12.77,  16.03,  16.03,  16.03,  16.03,  16.03,  16.03,  16.03,  16.03,  19.20,  19.20,  19.20,  19.20,  19.20,  19.20,  19.20,  19.20]

    z=[80.73,   81.75,  82.44,  82.81,  82.85,  82.57,  81.97,  81.04,  82.75,  83.78,  84.54,  85.01,  85.19,  85.09,  84.71,  84.04,  87.38,  88.11,  88.82,  89.50,  90.14,  90.76,  91.35,  91.91,  91.33,  92.04,  92.84,  93.73,  94.71,  95.79,  96.95,  98.21,  93.24,  94.24,  95.30,  96.41,  97.57,  98.79,  100.06, 101.39, 94.10,  95.35,  96.59,  97.83,  99.06,  100.29, 101.52, 102.74, 94.39,  95.77,  97.11,  98.41,  99.66,  100.86, 102.02, 103.14]

    z1=[84.18,  84.96,  85.49,  85.77,  85.81,  85.59,  85.13,  84.42,  86.23,  87.02,  87.63,  88.03,  88.25,  88.27,  88.10,  87.73,  91.09,  91.28,  91.64,  92.19,  92.92,  93.82,  94.90,  96.16,  94.83,  94.99,  95.46,  96.23,  97.30,  98.69,  100.37, 102.36, 96.42,  96.90,  97.64,  98.65,  99.91,  101.44, 103.23, 105.28, 97.02,  97.81,  98.79,  99.95,  101.29, 102.82, 104.53, 106.43, 97.16,  98.16,  99.28,  100.51, 101.86, 103.33, 104.91, 106.61]
    plt.subplot(121)
    triang = tri.Triangulation(x, y)
    plt.tricontour(x, y, z, 15, linewidths=0.5, colors='k')
    plt.tricontourf(x, y, z, 15, cmap=plt.cm.jet)
    plt.plot(x, y, 'ko', ms=3)
    plt.xlim(min(x),25)
    plt.ylim(min(y),25)
    plt.xlabel('e')
    plt.ylabel('d')
    plt.title('title1')
    plt.subplot(122)
    triang = tri.Triangulation(x, y)
    plt.tricontour(x, y, z1, 15, linewidths=0.5, colors='k')
    plt.tricontourf(x, y, z1, 15, cmap=plt.cm.jet)
    plt.plot(x, y, 'ko', ms=3)
    plt.xlim(min(x),25)
    plt.ylim(min(y),25)
    plt.xlabel('e')
    plt.ylabel('d')
    plt.title('title2')
    plt.show() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T21:14:01.430

我认为您可以添加一组单独的轴，然后将颜色条添加到这些轴。就像是：

```
fig = plt.figure()
ax2 = fig.add_axes([0.9, 0.1, 0.05, 0.9])
fig.colorbar(z1, cax=ax2) #specifies to put the colorbar in ax2 
```

# c - 结构指针数组的内存分配

> ID：11421884
> 
> 赞同：1
> 
> 时间：2012-07-10T21:01:46.540
> 
> 标签：c, arrays, pointers, memory-management

我正在尝试在 C 中构建一个内存分配器。用户首先说他想要使用多少内存，以及可以使用的最小内存块大小。

因此，例如，假设用户请求 1024B，最小块大小为 8B。这意味着可能的块大小为 1024、512、256、128、64、32、16 和 8。

为了跟踪空闲的内存块，我有一个指向结构的指针数组。这些结构称为 Header，数组称为 FreeList。我的意思是，FreeList[0] 将包含一个指向内存中内存大小为 8 块的空间的指针。 FreeList[1] 将包含一个指向内存中内存大小为 16 块的空间的指针。 ETC。

```
typedef void * Addr;
struct Header
{
    Addr next;
    int order;
};

struct Header *FreeList[]; 
```

我正在尝试为此空闲列表分配内存以与以下代码一起使用：

```
FreeList = malloc(Order*sizeof(struct Header)); 
```

其中 Order 是您可以拥有的不同块大小的数量。

我收到编译错误“FreeList”的类型不完整。

我不希望这些指针指向任何地方，我只想为数据分配空间。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-10T21:09:10.143

在 C 语言中

```
struct Header *FreeList[]; 
```

是未知大小（不完整类型）的静态数组的暂定定义。这个数组应该稍后用已知的编译时大小来定义。关键是它是一个*静态*数组。它不是“可分配”的`malloc`。

如果您需要一个可以在运行时由 分配的指针数组，则必须`malloc`声明一个指向指针的变量

```
struct Header **FreeList; 
```

后者分配了适当的大小

```
FreeList = malloc(Order * sizeof *FreeList); 
```

请注意，在这种情况下，您正在分配一个*指针*数组，就像您想要的那样。而`sizeof`上述分配中的 等价于`sizeof(struct Header *)`。即指针的大小（与`sizeof(struct Header)`原始代码中的不正确相反）。

这再次分配了一个未初始化的指针数组。初始化这些指针是您的责任，即使它们指向您希望它们指向的任何位置。如有必要，您还必须为实际标头分配内存。

* * *

但是，从您发布的内容中并不清楚您是否真的需要一个指向 headers 的*指针*数组，或者可能需要一个*实际 headers*的数组。您的解释令人困惑，有时甚至自相矛盾。如果您需要一个实际标头数组，则指针声明和分配将如下所示

```
struct Header *FreeList;
...
FreeList = malloc(Order * sizeof *FreeList); 
```

在这种情况下`sizeof`，上面的表达式等价于`sizeof(struct Header)`，就像我们原来的例子一样。请记住，分配的标头数组仍未初始化。

# ssl - DNN 重定向到 https

> ID：11421885
> 
> 赞同：7
> 
> 时间：2012-07-10T21:02:02.747
> 
> 标签：ssl, dotnetnuke

我们有一个自托管的 DNN 6.01.03 站点，在 Windows 2003x64 中，std。

我们已启用它以使用 SSL，但我们希望对其进行设置，以便通过 HTTP 的用户被重定向到 HTTPs。

有没有办法做到这一点？似乎在 IIS7 中我们可以使用 IIS Rewrite URL 模块，但这是 IIS6。

请指教。谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-11T17:37:14.413

最快的方法是在 DNN 中将站点设置为“强制 SSL”。

我注意到当使用来自 IFinity.com.au 的 UrlMaster 之类的工具时，这种行为会更好。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-21T20:17:49.300

设置一个重定向页面并在那里指出 403.4 错误。重定向页面将是唯一**不**强制 SSL 的 url。

### 1.创建重定向页面

您可以在这里使用几乎所有可用的网络技术。

例子：

*   [客户端 html/js](http://www.jppinto.com/index.php/2009/01/automatically-redirect-http-requests-to-https-on-iis-6/)（需要 javascript）
*   [经典 ASP](http://blog.opsan.com/2005/04/30/iis-redirect-from-http-to-https/)

在 ASP.NET 中，redirect.aspx 的编写方式与经典 ASP 中的编写方式类似：

```
<%@ Page Language="C#" %>

<!DOCTYPE html>

<script runat="server">
    protected void Page_Load(object sender, EventArgs e) 
    {   
        if (!Request.IsSecureConnection)
        {
            string query = Request.ServerVariables["QUERY_STRING"];
            query = query.Replace("http:", "https:");
            query = query.Replace("403;", "");
            query = query.Replace(":80", "");
            Response.Redirect(query);
        }
    }
</script> 

<html>
<head runat="server">
    <title></title>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        Redirecting...
    </div>
    </form>
</body>
</html> 
```

### 2\. 检查是否在重定向页面上未强制执行 SSL

![在 IIS 管理器中编辑 redirect.aspx 属性](../Images/ae1ebd4705a95d6e928df24510856f39.png)

### 3.将403.4错误指向重定向页面url

![在此处输入图像描述](../Images/bab1d5daaa213ed82336a9a6ffb2c589.png)

### 也可以看看：

*   [asp.net c#从http重定向到https](https://stackoverflow.com/questions/5305443/asp-net-c-sharp-redirecting-from-http-to-https)
*   [在 IIS 6 上自动将 HTTP 请求重定向到 HTTPS](http://www.jppinto.com/index.php/2009/01/automatically-redirect-http-requests-to-https-on-iis-6/)
*   [IIS：从 http 重定向到 https](http://blog.opsan.com/2005/04/30/iis-redirect-from-http-to-https/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-10-04T16:18:50.327

帮助他人：这里的答案来自 2 个不同的人的 2 个部分：

1) 作为 Mitchel 状态，转到您的 DNN 站点设置，启用 SSL 和强制 SSL。站点设置 > 高级设置 > SSL 设置 > 选中“启用 SSL 和强制 SSL”

[![网站设置](../Images/596f769f34f70ad7a4a66864235cf43f.png)](https://i.stack.imgur.com/O1CCO.png)

2）正如布鲁斯指出的那样，您必须转到每个页面并使其成为安全页面。页面设置 > 其他设置 > 选中“安全”。我必须为所有页面执行此操作……甚至是站点管理和设置页面。

[![页面设置](../Images/d6abf7dbccbddd1fb9bf4febcdec8e2d.png)](https://i.stack.imgur.com/WdICN.png)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-02-25T14:42:56.443

您可以设置重定向`Global.asax`以强制重定向托管域上的**所有**页面请求。这将比任何 DNN 设置具有更高的优先级。

```
<script RunAt="server">
protected void Application_BeginRequest(object sender, EventArgs e)
{
  // ENABLE SSL REDIRECTS
  if (!HttpContext.Current.Request.IsSecureConnection)
  {
    Response.Redirect("https://" + Request.ServerVariables["HTTP_HOST"] + HttpContext.Current.Request.RawUrl);
  }
}
</script> 
```

或者，如果您使用自定义标头或负载均衡器

```
<script RunAt="server">
protected void Application_BeginRequest(object sender, EventArgs e)
{
  // ENABLE SSL REDIRECTS
  if (!string.Equals(Request.Headers["X-Forwarded-Proto"], "https", StringComparison.InvariantCultureIgnoreCase))
  {
    Response.Redirect("https://" + Request.ServerVariables["HTTP_HOST"] + HttpContext.Current.Request.RawUrl);
  }
}
</script> 
```

# css - CSS 不透明度覆盖其他层

> ID：11421886
> 
> 赞同：7
> 
> 时间：2012-07-10T21:02:04.823
> 
> 标签：css, opacity

我有一个问题......我有这样的标题类

```
.header{
    background-color:#626262;
    width:250px;
    height:745px;
    opacity:0.4;
    filter:alpha(opacity=40); /* For IE8 and earlier */
} 
```

在这堂课里，我有这些课......

```
.logo{
    background-color:#626262;
    opacity:1.0;
    filter:alpha(opacity=100); /* For IE8 and earlier */
    color:#FFF;
    font-size:28px;
    padding-top:125px;
    margin-left:20px;
}

.navigation{
    background-color:#626262;
    opacity:1.0;
    filter:alpha(opacity=100); /* For IE8 and earlier */
    color:#FFF;
    margin-left:20px;
    text-align:left;
    margin-bottom: 125px;
}

.navigation ul{
    list-style:none;
    padding-left:0;
    padding-top:35px;
}

.navigation ul li{
    padding-bottom:20px;
    font-size:24px;
}

.navigation li a{
    color:#FFF;
    text-decoration:none;
}

.social{
    width:100%;
    font-size:18px;
    height: 50px;
    line-height: 72px;
    padding-right: 10px;
}

.social ul {
    list-style-type: none;
    margin: 0;
    padding: 0 0 0 8px;
}

.social li {
    float: left;
}

.social ul .facebook a {
    color: #FFFFFF;
    display: block;
    text-decoration: none;
    background-image: url(http://jamessuske.com/karl/images/facebook.png);
    background-position: center right;
    background-repeat: no-repeat;
    padding-right:65px;
}

.social ul .facebook a:hover {
    background-image: url(http://jamessuske.com/karl/images/facebook_hover.png);
}

.social ul .twitter a {
    color: #FFFFFF;
    display: block;
    text-decoration: none;
    background-image: url(http://jamessuske.com/karl/images/twitter.png);
    background-position: center right;
    background-repeat: no-repeat;
    padding-right:70px;
}

.social ul .twitter a:hover {
    background-image: url(http://jamessuske.com/karl/images/twitter_hover.png);
}

.social ul .pinterest a {
    color: #FFFFFF;
    display: block;
    text-decoration: none;
    background-image: url(http://jamessuske.com/karl/images/pinterest.png);
    background-position: center right;
    background-repeat: no-repeat;
    padding-right:70px;
}

.social ul .pinterest a:hover {
    background-image: url(http://jamessuske.com/karl/images/pinterest_hover.png);
} 
```

并且这些图层褪色到 0.4 的不透明度 ....我的问题是如何让这些图层不褪色，不透明度为 0.4？我希望这是有道理的......这方面的一个例子是[http://www.yourthirdeye.ca/](http://www.yourthirdeye.ca/)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-10T21:11:53.580

如果它只是用于部分透明的背景，您可以使用`rgba()`，如下所示：

```
.header{
    background-color: #626262;
    background-color: rgba(98, 98, 98, 0.4);
    width:250px;
    height:745px;
} 
```

这在较旧的浏览器（例如 IE8 和更早版本）中不起作用，所以这`background-color`就是设置两次的原因 - 第一次是后备。

您还可以使用一些 css 技巧 - 但它们有缺点。如果上述解决方案对您有用，我会同意的。

如果没有，这些链接应该可以帮助您入门：

[http://css-tricks.com/non-transparent-elements-inside-transparent-elements/](http://css-tricks.com/non-transparent-elements-inside-transparent-elements/)

[http://www.impressivewebs.com/css-opacity-that-doesnt-affect-child-elements/](http://www.impressivewebs.com/css-opacity-that-doesnt-affect-child-elements/)

# css - css中的位置标签防止使用超链接

> ID：11421887
> 
> 赞同：0
> 
> 时间：2012-07-10T21:02:06.837
> 
> 标签：css, hyperlink, position, conflict

**NEWBIE ALERT**`position: relative;`在 Firefox 中，但不是 IE 超链接由于标签而不起作用。我相信就是这样，因为如果我删除标签，超链接就可以正常工作。URL 是[http://www.dryerase.com/g1116-2x-test.htm](http://www.dryerase.com/g1116-2x-test.htm)或者您可以使用[http://dryerase.com/Default-sidebar-test-4.htm](http://dryerase.com/Default-sidebar-test-4.htm)它们都具有相同的 CSS。我也相信它不是 HTML，因为它在提到的两个网站上都一样。但是我确实使用了一个作为模板。提前感谢您的洞察力。

```
#Content_Wrapper { 

position:relative;
top:-30px;
display: table;
width: 960px;
min-height:500px;
max-height:auto; 
z-index:-10;

-webkit-box-shadow: 1px 1px 20px 1px rgba(0, 0, 0, .5);
box-shadow: 1px 1px 20px 1px rgba(0, 0, 0, .5);

-webkit-border-radius: 8px 8px 8px 8px;
border-radius: 8px 8px 8px 8px; 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-10T21:16:51.407

问题在于 z-index。#Page_Wrapper 位于#Content_Wrapper 前面，因此您无法点击链接。仅当元素具有位置时才考虑 z-index 属性，因此当您删除它时，链接会起作用，因为它没有有效的 z-index 属性。

IE 以不同的方式理解 z-index。

# eclipse - Jadclipse 插件安装问题

> ID：11421889
> 
> 赞同：4
> 
> 时间：2012-07-10T21:02:16.730
> 
> 标签：eclipse, jadclipse

我已经为 Eclipse 安装了 JAD 插件。我刚刚下载了 jar 并将其放在 eclipse 插件文件夹中，然后从[这里](http://www.varaneckas.com/jad/%20and%20picked%20the%20first%20one%20as%20i%20am%20running%20winows%20-7)下载了可执行文件。

解压 zip 文件后，我现在看到 jad.exe 并双击它。我不确定安装步骤中是否有任何问题，但在 Eclipse 中，我在 Eclipse 编辑器中看到了jadeclispe。

当我打开一个类文件时，我看到以下错误

```
java.io.IOException：无法运行程序“jad”（在目录“C:\Users\sgudla
.net.sf.jadclipse\1341954004841"): CreateProcess error=2, 系统找不到指定的文件
    在 java.lang.ProcessBuilder.start（未知来源）
    在 java.lang.Runtime.exec（未知来源）
    在 net.sf.jadclipse.JadDecompiler.decompile(JadDecompiler.java:160)
    在 net.sf.jadclipse.JadDecompiler.decompileFromArchive（JadDecompiler.java:217）
    在 net.sf.jadclipse.JadclipseSourceMapper.findSource(JadclipseSourceMapper.java:150)
    在 net.sf.jadclipse.JadclipseSourceMapper.findSource(JadclipseSourceMapper.java:83)
    在 net.sf.jadclipse.JadclipseClassFileEditor.doOpenBuffer（JadclipseClassFileEditor.java:87）
    在 net.sf.jadclipse.JadclipseClassFileEditor.doSetInput(JadclipseClassFileEditor.java:45)
    在 net.sf.jadclipse.JadclipseActionBarContributor.setActiveEditor(JadclipseActionBarContributor.java:87)
    在 org.eclipse.ui.internal.EditorActionBars.partChanged(EditorActionBars.java:343)
    在 org.eclipse.ui.internal.WorkbenchPage$3.run(WorkbenchPage.java:635)
    在 org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42)
    在 org.eclipse.core.runtime.Platform.run（Platform.java:888）
    在 org.eclipse.ui.internal.WorkbenchPage.activatePart(WorkbenchPage.java:624)
    在 org.eclipse.ui.internal.WorkbenchPage.setActivePart(WorkbenchPage.java:3533)
    在 org.eclipse.ui.internal.WorkbenchPage.internalActivate(WorkbenchPage.java:617)
    在 org.eclipse.ui.internal.WorkbenchPage.activate(WorkbenchPage.java:589)
    在 org.eclipse.ui.internal.WorkbenchPage.busyOpenEditorBatched(WorkbenchPage.java:2875)
    在 org.eclipse.ui.internal.WorkbenchPage.busyOpenEditor(WorkbenchPage.java:2768)
    在 org.eclipse.ui.internal.WorkbenchPage.access$11(WorkbenchPage.java:2760)
    在 org.eclipse.ui.internal.WorkbenchPage$10.run(WorkbenchPage.java:2711)
    在 org.eclipse.swt.custom.BusyIndi​​cator.showWhile(BusyIndi​​cator.java:70)
    在 org.eclipse.ui.internal.WorkbenchPage.openEditor(WorkbenchPage.java:2707)
    在 org.eclipse.ui.internal.WorkbenchPage.openEditor(WorkbenchPage.java:2691)
    在 org.eclipse.ui.internal.WorkbenchPage.openEditor(WorkbenchPage.java:2682)
    在 org.eclipse.jdt.internal.ui.javaeditor.EditorUtility.openInEditor（EditorUtility.java:378）
    在 org.eclipse.jdt.internal.ui.javaeditor.EditorUtility.openInEditor(EditorUtility.java:178)
    在 org.eclipse.jdt.ui.actions.OpenAction.run(OpenAction.java:229)
    在 org.eclipse.jdt.ui.actions.OpenAction.run(OpenAction.java:208)
    在 org.eclipse.jdt.ui.actions.SelectionDispatchAction.dispatchRun(SelectionDispatchAction.java:274)
    在 org.eclipse.jdt.ui.actions.SelectionDispatchAction.run（SelectionDispatchAction.java:250）
    在 org.eclipse.jdt.internal.ui.navigator.OpenAndExpand.run(OpenAndExpand.java:49)
    在 org.eclipse.ui.actions.RetargetAction.run(RetargetAction.java:221)
    在 org.eclipse.ui.navigator.CommonNavigatorManager$3.open(CommonNavigatorManager.java:185)
    在 org.eclipse.ui.OpenAndLinkWithEditorHelper$InternalListener.open(OpenAndLinkWithEditorHelper.java:48)
    在 org.eclipse.jface.viewers.StructuredViewer$2.run(StructuredViewer.java:845)
    在 org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42)
    在 org.eclipse.ui.internal.JFaceUtil$1.run(JFaceUtil.java:49)
    在 org.eclipse.jface.util.SafeRunnable.run(SafeRunnable.java:175)
    在 org.eclipse.jface.viewers.StructuredViewer.fireOpen(StructuredViewer.java:843)
    在 org.eclipse.jface.viewers.StructuredViewer.handleOpen(StructuredViewer.java:1131)
    在 org.eclipse.ui.navigator.CommonViewer.handleOpen(CommonViewer.java:462)
    在 org.eclipse.jface.viewers.StructuredViewer$6.handleOpen(StructuredViewer.java:1235)
    在 org.eclipse.jface.util.OpenStrategy.fireOpenEvent(OpenStrategy.java:264)
    在 org.eclipse.jface.util.OpenStrategy.access$2(OpenStrategy.java:258)
    在 org.eclipse.jface.util.OpenStrategy$1.handleEvent(OpenStrategy.java:298)
    在 org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84)
    在 org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1053)
    在 org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:4066)
    在 org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3657)
    在 org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2629)
    在 org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2593)
    在 org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2427)
    在 org.eclipse.ui.internal.Workbench$7.run(Workbench.java:670)
    在 org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)
    在 org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:663)
    在 org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)
    在 org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:115)
    在 org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196)
    在 org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)
    在 org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)
    在 org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:369)
    在 org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179)
    在 sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    在 sun.reflect.NativeMethodAccessorImpl.invoke（未知来源）
    在 sun.reflect.DelegatingMethodAccessorImpl.invoke（未知来源）
    在 java.lang.reflect.Method.invoke（未知来源）
    在 org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:619)
    在 org.eclipse.equinox.launcher.Main.basicRun(Main.java:574)
    在 org.eclipse.equinox.launcher.Main.run(Main.java:1407)
    在 org.eclipse.equinox.launcher.Main.main(Main.java:1383)
原因：java.io.IOException: CreateProcess error=2, 系统找不到指定的文件
    在 java.lang.ProcessImpl.create（本机方法）
    在 java.lang.ProcessImpl.（未知来源）
    在 java.lang.ProcessImpl.start（未知来源）
    ... 71 更多

```

有人可以告诉这里缺少什么以使其正常工作吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-07-23T14:34:29.813

# 如何安装 JAD 以与 Eclipse 一起使用（在 Windows 中）

1.  从这里下载可执行文件 (.exe)：http: [//www.softpedia.com/get/Programming/Debuggers-Decompilers-Dissasemblers/JAD.shtml](http://www.softpedia.com/get/Programming/Debuggers-Decompilers-Dissasemblers/JAD.shtml)

    将文件（README 也是，它有很好的说明）保存在文件系统的某个位置，例如 C:\Program Files\JadDecompiler\

2.  [从http://sourceforge.net/projects/jadclipse/](http://sourceforge.net/projects/jadclipse/)下载 JAD Eclipse 插件 (.jar)

3.  将下载的jar文件复制到Eclipse的plugins文件夹中，例如C:\dev\eclipse\plugins

4.  重启Eclipse（使插件生效）

5.  在 Eclipse 中，单击**Window –> Preferences –> Java –> Jadclipse**并输入例如：

![JadClipse 设置](../Images/a091e1b5de0f72480f1a676d93cfff3f.png)

完毕。

现在您将能够看到任何附加的但以压缩（jar）格式的源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-18T07:30:01.813

嘿只是为了添加到 ceiroa 的答案步骤。完成所有步骤后，使用 -clean 命令启动 eclipse，否则 jad 将无法按预期工作。我遇到了这个问题，所以想补充一下。日食-清洁

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-10T21:16:15.613

插件有一个表单，您可以在其中输入可执行文件的地址，或者您必须将其放在路径上。如果您选择更改注册表中的路径，请记住重新启动 eclipse。

这些年来，我多次使用 Jad。我发现最简单的使用方法是解压缩 jar 并从命令行使用 jad 反编译所有内容。然后我将扩展名从 jad 重命名为 java 并从那里开始。这样我就可以根据需要重命名变量并提取代码。我什至创建了一个项目，以便可以链接文件之间的引用。我发现这比插件更快、更有用——对于那些一直是 IDE 粉丝并且通常更喜欢命令行方法的人来说是特有的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-05-24T09:41:35.813

32 位 eclipse 的 Jaceclipse 插件错误 -

错误：F:\eclipse\configuration\org.eclipse.osgi\431\0.cp\win32\x86\jd-eclipse.dll

解决方案：安装包 Microsoft Visual C++ 2008 SP1 Redistributable Package (x86)

它会解决你的问题..

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-05-02T19:55:39.920

我想在 ceiroa 的回答步骤中添加更多步骤。完成所有步骤后。如果您使用的是 spring 工具套件 (STS) 而不是 eclipse。

只需更改弹簧工具套件文件即可。

```
-clean
-startup
plugins/org.eclipse.equinox.launcher_1.5.700.v20200207-2156.jar
--launcher.library
plugins/org.eclipse.equinox.launcher.win32.win32.x86_64_1.1.1100.v20190907-0426
-product
org.springframework.boot.ide.branding.sts4
--launcher.defaultAction
openFile
-vmargs
-Dosgi.requiredJavaVersion=1.8
-Xms256m
-Xmx1024m
-XX:+UseG1GC
-XX:+UseStringDeduplication
--add-modules=ALL-SYSTEM 
```

# c++ - SDL+OpenGL程序没有出现在linux上

> ID：11421896
> 
> 赞同：1
> 
> 时间：2012-07-10T21:03:01.530
> 
> 标签：c++, linux, opengl, sdl

我开始在 Windows 上使用 SDL 和 OpenGL 制作这个超级简单的游戏引擎。引擎位于静态库中，到目前为止，它所做的只是显示一个蓝色窗口，其中包含引擎的所有基础工作。

它在 Windows 上运行良好，但后来我将它移植到 Linux 上，什么也没有。该程序运行良好并显示在系统监视器中，但没有出现任何窗口。我安装了几个 mesa 和 gl 库来检查是不是这样。现在它不会运行并说进程以状态-1终止。

这是引擎中的初始化代码。请询问其他任何事情。

```
#include "Scales.h"
#include "SDL/SDL.h"
#include "gl.h"
#include "glu.h"

Engine *scalesEngine;

bool OnInit(int WindowHeight, int WindowWidth){

    SDL_Surface* Surf_Display;

    if(SDL_Init(SDL_INIT_EVERYTHING) < 0) {
        return false;
   }
    SDL_GL_SetAttribute(SDL_GL_RED_SIZE,        8);
    SDL_GL_SetAttribute(SDL_GL_GREEN_SIZE,      8);
    SDL_GL_SetAttribute(SDL_GL_BLUE_SIZE,       8);
    SDL_GL_SetAttribute(SDL_GL_ALPHA_SIZE,      8);

    SDL_GL_SetAttribute(SDL_GL_DEPTH_SIZE,      16);
    SDL_GL_SetAttribute(SDL_GL_BUFFER_SIZE,        32);

    SDL_GL_SetAttribute(SDL_GL_ACCUM_RED_SIZE,    8);
    SDL_GL_SetAttribute(SDL_GL_ACCUM_GREEN_SIZE,    8);
    SDL_GL_SetAttribute(SDL_GL_ACCUM_BLUE_SIZE,    8);
    SDL_GL_SetAttribute(SDL_GL_ACCUM_ALPHA_SIZE,    8);

    SDL_GL_SetAttribute(SDL_GL_MULTISAMPLEBUFFERS,  1);
    SDL_GL_SetAttribute(SDL_GL_MULTISAMPLESAMPLES,  2);

   if((Surf_Display = SDL_SetVideoMode(WindowWidth, WindowHeight, 32, SDL_HWSURFACE | SDL_GL_DOUBLEBUFFER | SDL_OPENGL)) = NULL){
        return false;
   }

   glClearColor(0.422f,0.576f,1.0f,1.0f);
   glClearDepth(1.0f);

   glViewport(0, 0, WindowWidth, WindowHeight);

   glMatrixMode(GL_PROJECTION);
   glLoadIdentity();

   glOrtho(0, WindowWidth, WindowHeight, 0, 1, -1);

   glMatrixMode(GL_MODELVIEW);

   glEnable(GL_TEXTURE_2D);

   glLoadIdentity();

   game_Init();

   return true;
}

int main(int argc, char* argv[]){

    scalesEngine = new Engine;

    game_preload();

    if(OnInit(scalesEngine->WindowHeight(), scalesEngine->WindowWidth()) == false){
        return -1;
    }

    SDL_Event Event;

    //Main Game Loop
    while(scalesEngine->Running){

        while(SDL_PollEvent(&Event)){
            scalesEngine->OnEvent(&Event);
        }

        scalesEngine->Update();
        scalesEngine->Render();
    }

    scalesEngine->OnCleanUp();
    delete scalesEngine;

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-10T21:59:16.793

```
if((Surf_Display = SDL_SetVideoMode(WindowWidth, WindowHeight, 32, SDL_HWSURFACE | SDL_GL_DOUBLEBUFFER | SDL_OPENGL)) = NULL){
    return false;
} 
```

我很确定你的意思是`== NULL`，对吧？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T21:23:27.690

如果你没有得到一个窗口，我会怀疑你没有得到你的硬件上下文。尝试使用`SDL_SWSURFACE`而不是`SDL_HWSURFACE`.

```
SDL_SetVideoMode(... SDL_SWSURFACE ... 
```

我在虚拟机中开发时看到过这种情况，但我确信还有其他原因。

编辑：

`SDL_OPENGL`如评论中所述，无论如何，这两个表面标志都可能是多余的。

# python - 应用程序挂起在 threading.Timer.start()

> ID：11421897
> 
> 赞同：0
> 
> 时间：2012-07-10T21:03:04.107
> 
> 标签：python, multithreading, timer, resize, wxpython

我有一个`wx.Frame`来自 wxPython 的信息，想对调整大小进行中间和最终更新。

因为我没有找到调整大小结束事件，所以我的方法是`wx.EVT_SIZE`在我开始的计时器中进行中间更新和最终更新`wx.EVT_SIZE`。它大部分时间都在工作，但有时它会挂起`threading.Timer.start`（意思`Before`是最后打印[见代码]）。你知道为什么吗？

这是调整大小处理程序和计时器方法的代码：

```
def _on_resize(self, event):
    self.Layout()
    self._resize_lock.acquire()
    print 'resize event'
    #Intermediate update is done here
    self._resize_lock.release()
    if self._resize_timer != None:
        self._resize_timer.cancel()
    self._resize_timer = threading.Timer(0.75,
        self._resize_timer_method)
    print 'Before'
    self._resize_timer.start()
    print 'After'

def _resize_timer_method(self):
    self._resize_lock.acquire()
    print 'resize timer'
    #Final update is done here
    self._resize_lock.release() 
```

PS：如果您知道如何获得调整大小结束事件，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T13:15:25.930

为什么在调整大小时必须更新？无论如何，我认为你最好使用 wx.Timer()。我怀疑您正在做的事情不是线程安全的，这会使事情变得不可预测。

# shell - grepping多个字符串

> ID：11421900
> 
> 赞同：3
> 
> 时间：2012-07-10T21:03:14.527
> 
> 标签：shell, awk, grep

我正在使用 grep 命令从文件中获取所需的信息。我正在使用两个 grep 语句，如下所示

```
XXXX='grep XXXX FILE A|sort|uniq|wc -l'
grep YYYY FILE A|uniq| > FILE B 
```

现在该文件被遍历两次。但我只想知道，如果我能够在单个文件遍历中完成这两个步骤，即我想知道我是否可以使用类似于 egrep 的东西，我可以 grep 两个字符串和一个字符串，我将使用它存储一个变量并将另一个字符串输出到一个文件中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T22:17:31.993

您可以使用以下代码。在这里，我们只在所有文件中搜索包含 XXXX 或 YYYY 的行一次，并将结果行存储到一个数组中。然后我们使用这个数组的元素来选择包含 XXXX 的行和包含 YYYY 的行。

```
filtered=`grep -E '(XXXX|YYYY)' FILE A`
XXXX=`for line in ${filtered[@]}; do echo $line; done | grep XXXX | sort | uniq | wc -l`
for line in ${filtered[@]}; do echo $line; done | grep YYYY | uniq > FILE B 
```

所以文件不会被遍历两次！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T21:25:02.187

或者使用带有析取的 egrep：

```
egrep '(XXXX|YYYY)' FILE A | sort | uniq | ... 
```

或 awk：

```
awk '/XXXX|YYYY/' FILE A | sort | uniq | ... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T13:39:42.557

有一个尾随'|' 您的问题中的符号，也许您打算将 YYYY 行也通过管道传输到`sort`（或使用`sort -u`！），在这种情况下，您可以简单地执行以下操作：

```
awk '/XXXX/ { if( !x[$0]++ ) xcount += 1 } 
     /YYYY/ { if( !y[$0]++ ) ycount += 1 }
  END { print "XXXX:", xcount
        print "YYYY:", ycount
        for( i in y ) print i | "sort > FILEB"
  }' FILE 
```

这将扫描文件一次，每当看到包含适当模式的 uniq 行时递增计数器。请注意，这里没有很好地定义 YYYY 行数组上的迭代顺序，因此排序是必要的。某些版本的 awk 提供了不依赖外部实用程序对数组进行排序的能力，但并非所有版本都这样做。如果你想这样做，请使用 perl。

# python - 如何正确合并鸭子类型以返回原始类型？

> ID：11421901
> 
> 赞同：8
> 
> 时间：2012-07-10T21:03:20.943
> 
> 标签：python, numpy, duck-typing

我真的希望这不是重复的。我试图搜索我的问题，但似乎找不到。

所以我有一个相当简单的函数将英尺转换为米：

```
def feetToMeters(val):
    return numpy.array(val) * 0.3048 
```

这很好用并且接受整数、浮点数、数组和列表。但是，如果我放入一个列表（而不是一个 numpy 数组），我希望返回一个列表。所以我写了这个：

```
def feetToMeters(val):
    try:
        return val * 0.3084
    except TypeError:
        return [0.3084 * v for v in val] 
```

（或者`return list(numpy.array(val) * 0.3084)`，如果我想在`numpy`这里使用，我可以使用最后一行，我不知道这是否真的很重要。）

这是在此处合并鸭子类型的最佳方法，以便我可以避免使用该`type`功能吗？最初我尝试过`AttributeError`，但没有奏效。`TypeError`尽管如此，即使它似乎有效，我仍然感到厌倦。

使用它会亵渎神明`if type(val) is list`吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-10T21:15:14.210

> 使用它会亵渎神明`if type(val) is list`吗？

是的，因为它不适用于列表的子类。如果你想走这条路，至少要这样做`isinstance(val, list)`。这是一个专门处理列表并将其他所有内容（包括标量和元组）转换为 NumPy 数组的解决方案：

```
def feetToMeters(feet):
    meters = np.asarray(feet) * 0.3048
    return list(meters) if isinstance(feet, list) else meters 
```

注意：

*   传递一个子类的实例`list`将导致一个普通`list`的被返回；
*   传递列表列表将导致返回 NumPy 数组列表。

您可以扩展它以专门处理更多类型，但通常，对于要处理的每种类型，您需要编写更多代码，因为您需要知道如何构造该类型。因此，这种类型转换通常留给客户端代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-10T21:15:00.500

由于您已经使用 numpy 我会避免在这里使用异常，例如

```
def feetToMeters(val):
    if numpy.isscalar(val):
        return val * 0.3084
    else:
        return numpy.array(val) * 0.3048 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-10T21:13:42.927

捕获 TypeError 很危险，因为它可能是由列表以外的许多事情引起的。为此，我通常会使用 isinstance(val, list) 。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-10T21:15:38.167

诀窍是您正在尝试支持标量和序列-也许这样的东西对您有用：

```
def feetToMeters(val):
    try:
        return type(val)(val * 0.3048)
    except TypeError:
        return type(val)(v*0.3048 for v in val) 
```

# php - 发送多个带有 jQ uery POST 的元素我有这个 jQuery 代码可以在带有“添加”按钮的表格行中添加 <select>元素： $("#add").click(function() { $('#selected > tbody:last' ).append('</select><option value="\'1\'">一个</option> <option< h1="">> ID：11421904
> 
> 赞同：2
> 
> 时间：2012-07-10T21:03:31.423
> 
> 标签：php, jquery, mysql, select

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-10T21:38:48.203

首先，您必须为您的选择使用类而不是 id。当你使用 id 时，jQuery 只会返回一个元素。之后，以下函数会将您作为参数提供的选择的所有值转换为数组。

```
/**
 * Convert select to array with values
 */    
function serealizeSelects (select)
{
    var array = [];
    select.each(function(){ array.push($(this).val()) });
    return array;
} 
```

所以：

```
var course_ids = serealizeSelects($('.course_id')); 
```

例如应该返回：

```
[1,3,2] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-10T21:06:54.660

我会给每个`select`元素一个唯一的名称，一个数组在这里也可以做得很好，看这个例子：

```
$('#selected > tbody:last').append('<tr><td><select id=\'plan_id\' name="my_select[]"><option value=\'1\'>One</option><option value=\'2\'>Two</option><option value=\'3\'>Three</option></select></td></tr>'); 
```

然后在发送之前序列化表单：

```
var my_data = $("form").serialize();
... 
```

**编辑：**完整的例子：

```
$("#add").click(function() {
    $('#selected > tbody:last').append('<tr><td><select id=\'plan_id\' name="my_select[]"><option value=\'1\'>One</option><option value=\'2\'>Two</option><option value=\'3\'>Three</option></select></td></tr>');
    });
                                                                      ^^^^^^^^^^^^^^^^^^^ 
```

和：

```
$('#course_update').click(function() {

var my_data = $("form").serialize();

$('#update_status').html('<img src="../images/ajax-loader.gif" />');
$.post('../update.php', my_data, function(data) {
    $('#update_status').html(data);
    return false;
 });
}); 
```</option<>

# java - java整数到字节，字节到整数

> ID：11421905
> 
> 赞同：6
> 
> 时间：2012-07-10T21:03:33.077
> 
> 标签：java, int, byte

我知道 - 在 Java 中 - int 是 4 个字节。但我希望将 int 转换为 n 字节数组，其中 n 可以是 1、2、3 或 4 个字节。我想将它作为带符号的字节/字节，这样如果我需要将它们转换回 int（如果它是 1 个字节，则事件），我会得到相同的带符号的 int。我完全意识到从 int 转换为 3 或更低字节时精度损失的可能性。

我设法从 int 转换为 n 字节，但将其转换回负数会产生无符号结果。

**编辑：**

int 到字节（参数 n 指定所需的字节数 1、2、3 或 4，而不管可能的进动损失）

```
public static byte[] intToBytes(int x, int n) {
    byte[] bytes = new byte[n];
    for (int i = 0; i < n; i++, x >>>= 8)
        bytes[i] = (byte) (x & 0xFF);
    return bytes;
} 
```

字节到 int（不管 1、2、3 或 4 有多少字节）

```
public static int bytesToInt(byte[] x) {
    int value = 0;
    for(int i = 0; i < x.length; i++)
        value += ((long) x[i] & 0xffL) << (8 * i);
    return value;
} 
```

字节到 int 转换器可能存在问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-10T21:20:20.653

无论如何，这是我放在一起的代码：

```
public static void main(String[] args) throws Exception {
  final byte[] bi = encode(-1);
  System.out.println(Arrays.toString(bi));
  System.out.println(decode(bi));
}
private static int decode(byte[] bi) {
  return bi[3] & 0xFF | (bi[2] & 0xFF) << 8 |
         (bi[1] & 0xFF) << 16 | (bi[0] & 0xFF) << 24;
}
private static byte[] encode(int i) {
  return new byte[] { (byte) (i >>> 24), (byte) ((i << 8) >>> 24),
                      (byte) ((i << 16) >>> 24), (byte) ((i << 24) >>> 24)
  };
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-10T21:34:19.500

[`BigInteger.toByteArray()`](http://docs.oracle.com/javase/6/docs/api/java/math/BigInteger.html#toByteArray%28%29)会为你做这...

> 返回包含 this 的二进制补码表示的字节数组`BigInteger`。字节数组将采用大端字节序：最高有效字节位于第零个元素中。**该数组将包含表示它所需的最小字节数，`BigInteger,`**包括至少一个符号位，即`(ceil((this.bitLength() + 1)/8))`. （此表示与`(byte[])`构造函数兼容。）

示例代码：

```
final BigInteger bi = BigInteger.valueOf(256);
final byte[] bytes = bi.toByteArray();

System.out.println(Arrays.toString(bytes)); 
```

印刷：

```
[1, 0] 
```

要从字节数组返回 int，请使用[`BigInteger(byte[])`](http://docs.oracle.com/javase/6/docs/api/java/math/BigInteger.html#BigInteger%28byte%5b%5d%29)构造函数：

```
final int i = new BigInteger(bytes).intValue();
System.out.println(i); 
```

打印预期的：

```
256 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-10T21:19:46.617

就像是：

```
int unsignedByte = ((int)bytes[i]) & 0xFF;

int n = 0;
n |= unsignedByte << 24; 
```

# node.js - Node.js 程序错误 (Module.js)

> ID：11421906
> 
> 赞同：1
> 
> 时间：2012-07-10T21:03:46.450
> 
> 标签：node.js

嘿，伙计们，我一直在用 node.js 测试水，我写了一个由 Ryan Dahl 编写的简单 Web 服务器程序。

```
//web-server.js
var http= require('http');
http.createServer(function(req,res){
   res.writeHead(200, {'content-type':'text/plain'});
   res.end("helo world \n");
});

s.listen(8000); 
```

奇怪的是，我收到了这个错误

![在此处输入图像描述](../Images/99b08dbdb6fd9b35f8117efa60dc7918.png)

可以看到，第一个命令是`node-webserver.js` 第二个命令是显示错误的地方

但是我知道 node.js 并没有损坏，因为 node.js 上提供的基本介绍程序仍然可以正常工作。很抱歉出现大量错误截图！

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T21:44:38.733

这是错误消息实际上意味着什么的时候：`{\rtf1\ansi\ansi`不是有效的 JavaScript 代码。这是您的文本编辑器插入的行。

并且，请，请，请不要使用写字板来编辑代码。这里有很多优秀的免费文本编辑器/IDE：我个人将[Geany](http://www.geany.org/)用于小任务，将[NetBeans](http://netbeans.org/)用于大型项目。我想你也可以试试[Visual Studio Express](http://www.microsoft.com/visualstudio/11/en-us/downloads#express-web)（它是免费的，不像它的大兄弟）。还有[Notepad++](http://notepad-plus-plus.org/)这样的好东西。

但在我看来，使用写字板编写代码就像使用电锯钉书架一样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-10T21:45:01.467

您的文件显然保存为 RTF 文件，而需要另存为纯文本。

# c# - CSV 导出 Response.End 抛出异常

> ID：11421908
> 
> 赞同：3
> 
> 时间：2012-07-10T21:03:49.320
> 
> 标签：c#, asp.net, multithreading

在过去的几天里，我一直在尝试解决这个问题。我已经进行了详尽的谷歌搜索，尝试了许多解决方案，但没有运气。

本质上，我正在尝试将数据导出到 CSV 并下载。该代码有效，但引发异常。我的特殊用法需要连续进行多次下载（如下面的示例），但例外情况会阻止这种情况发生。

```
string attachment = string.Format("attachment; filename={0}_OutPut.csv", companyName);

HttpContext.Current.Response.Clear();
HttpContext.Current.Response.ClearHeaders();
HttpContext.Current.Response.ClearContent();
HttpContext.Current.Response.AddHeader("content-disposition", attachment);
HttpContext.Current.Response.ContentType = "text/csv";
HttpContext.Current.Response.AddHeader("Pragma", "public");
WriteColumnName("Column1,Column2,Column3");

StringBuilder stringBuilder = new StringBuilder();

foreach (Item i in list.Items)
{
    AddData(i.TaxCodeValue.ToString(), stringBuilder);
    AddData(i.Description.ToString(), stringBuilder);
    AddData(i.Description.ToString(), stringBuilder);

    stringBuilder.Length = 0; //Reset Stringbuilder value
    HttpContext.Current.Response.Write(stringBuilder.ToString());
    HttpContext.Current.Response.Write(Environment.NewLine);
}

HttpContext.Current.Response.End(); <---This is the problem 
```

我读了：

[http://support.microsoft.com/kb/312629](http://support.microsoft.com/kb/312629)

[Response.End() 的替代方案？](https://stackoverflow.com/questions/7867238/alternative-to-response-end)

[导出到excel时线程被中止？](https://stackoverflow.com/questions/421199/thread-was-being-aborted-when-exporting-to-excel)

我了解 Response.End() 引发异常，因为它正在中止线程（通常不建议）。但是，对于我的情况，我没有看到任何替代方案。

我尝试过的一些事情：

1.  `HttpContext.Current.ApplicationInstance.CompleteRequest();`作为 Response.End() 的替代方法。它导致我的 CSV 被垃圾填满，而不是我正在编写的实际数据。
2.  `HttpContext.Current.Response.Redirect("Page.aspx", false);`只是刷新页面，并没有下载写入的数据。
3.  在 catch 块中捕获异常。它总是设法逃脱并激起涟漪。

有任何想法吗？

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T19:53:54.413

当您像在这里一样将文件输出到流时，您基本上必须“劫持” `Page`. 您应该改用通用处理程序（实现 .ashx 文件`IHttpHandler`）。

在实现通用处理程序时，您无需担心调用`Response.Clear`，`Response.End`因为您将自己提供完整的响应。然后，您的页面将具有指向 ashx 处理程序的链接，传递必要的查询字符串参数以加载您的数据。

**示例：**您的页面将包含指向“/MyCsvDownload.ashx?CompanyID=11”的链接

您的项目将定义一个 HelperClass 声明 WriteColumnHeaders 和 AddData 静态方法，以及一个带有如下代码的 MyCsvDownload.ashx：

```
public class MyCsvDownload : IHttpHandler
{
    public void ProcessRequest(HttpContext context)
    {
        var companyId = int.Parse(context.Request.QueryString["CompanyID"]);

        string companyName;
        ItemList list;

        // TODO: Load company name and items from Company ID.

        string attachment = string.Format("attachment; filename={0}_OutPut.csv", companyName); 

        context.Response.AddHeader("content-disposition", attachment);
        context.Response.ContentType = "text/csv";
        context.Response.AddHeader("Pragma", "public");

        StringBuilder stringBuilder = new StringBuilder();

        HelperClass.WriteColumnName("Column1,Column2,Column3", stringBuilder);
        context.Response.Write(stringBuilder.ToString());
        context.Response.Write(Environment.NewLine);
        stringBuilder.Clear();

        foreach (Item i in list.Items)
        {
            HelperClass.AddData(i.TaxCodeValue.ToString(), stringBuilder);
            HelperClass.AddData(i.Description.ToString(), stringBuilder);
            HelperClass.AddData(i.Description.ToString(), stringBuilder);

            context.Response.Write(stringBuilder.ToString());
            context.Response.Write(Environment.NewLine);
            stringBuilder.Clear();
        }

        context.Response.Flush();
    }

    public bool IsReusable
    {
        get
        {
            return false;
        }
    }
} 
```

# c# - 将 VB.NET 转换为 C# 的奇怪警告 - 十六进制常量

> ID：11421914
> 
> 赞同：1
> 
> 时间：2012-07-10T21:04:10.507
> 
> 标签：c#, vb.net, warnings, vb.net-to-c#

除非我使用 HTML，否则我通常不会处理十六进制数字，因此我真的没有太多转换涉及它们的代码的经验。本质上，这里的问题是我正在将一些类从 VB.NET 转换为 C#.NET，并且有几个地方 VB 版本将一些值与十六进制常量进行比较。当我将该值转换为其 C# 等效项时，我从 Visual Studio 收到以下“警告”消息：

> 与整型常数的比较是无用的，该常数超出了“int”类型的范围

现在，显然 VB 版本没有这个警告，或者我不会费心问这个问题。我会注意到，如果我将要比较的属性转换为 Int64，警告就会消失。

我想知道的是我是否做对了，如果我不应该放弃整个比较，因为它显然不适用于现实世界的场景？

VB代码：

```
 Catch ex As COMException
        If bInsert AndAlso ex.ErrorCode = &H80042776 Then
            ' DO THINGS
    End Try 
```

C#代码：

```
 catch (COMException come)
        {
            if (insert && come.ErrorCode == 0x80042776)
            {
                // DO THINGS
            }
        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-10T21:10:17.933

在 VB.NET 中，当涉及到[整数文字](http://msdn.microsoft.com/en-us/library/aa711649.aspx)时：

> Integer 范围之外的值被键入为 Long

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-10T22:00:34.740

我不知道这在 VB.NET 中是否有效（不确定那里的规则），但 C# 不会轻易让您指定这样的负数。我想你不得不说

```
...    come.ErrorCode == unchecked((int)0x80042776) 
```

否则，恐怕 C# 不会将其视为负 32 位整数。即使您的代码已经在`unchecked`上下文中编译（我敢打赌！），您仍然必须`unchecked`像上面那样显式编写，当它是一个编译时常量时，您正在“转换”。

当 8 个十六进制数字非常适合 32 位 ( `System.Int32`) 时，这很烦人。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-10T21:10:41.910

COMException::ErrorCode 是 int32 类型。所以它的最大值是 2^31 - 1\. (2,147,483,647)。

您正在与十六进制数 0x80042776 进行比较。十进制值为 2,147,755,894。

这些数字非常接近，但请注意十六进制数字大于 int32 可能的最大数字。这就是编译器警告您的内容。在 VB 中也是如此，只是编译器没有警告你。

魔法十六进制常数从何而来？很可能是错的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-10T21:30:13.807

好的，所以我对这个问题进行了一些额外的搜索（可能应该首先这样做），并找到了我正在寻找的答案。事实证明，COMException 的 ErrorCode 实际上是一个 UNSIGNED 整数（参见 HRESULT）。也许VB也会自动处理这个？

我在这里看到了详细的堆栈溢出帖子： [Catching COMException specific Error Code](https://stackoverflow.com/questions/1426147/catching-comexception-specific-error-code) - 查看选择的问题答案

在我标记答案之前，我想听听其他人对此的回复。

# java - 如何在 JFrame 中动态更改对 JPanel 的引用？

> ID：11421915
> 
> 赞同：0
> 
> 时间：2012-07-10T21:04:10.187
> 
> 标签：java, swing, jpanel

是的，这可能看起来像一个重复的问题，但请耐心等待。采取下面的代码，这是功能性的：

```
private void setMainLayout(Container pane) {

    String imagePath = Start.getProperty("IMAGE_DIR");      

    characters.add(char1); // pseudocode
    characters.add(char2);
    characters.add(char3);
    characters.add(char4);

    // "CharacterDisplay.getMainLayout()" returns a Box object:
    for (CharacterDisplay character : characters)
        character.getMainLayout().setBorder(BorderFactory.createMatteBorder(2, 2, 2, 2, Color.WHITE));

    // "mainFrame" is a JFrame:
    mainFrame.setLayout(new GridBagLayout());
    GridBagConstraints gbc = new GridBagConstraints();

    /* do random gridbagconstraints stuff */   

    pane.add(characters.get(0).getMainLayout(), gbc);

    /* do random gridbagconstraints stuff */   

    // "nonCharacterArea" is a JPanel:    
    nonCharacterArea.setOpaque(true);
    nonCharacterArea.setBackground(Color.BLACK);
    nonCharacterArea.setLayout(new GridBagLayout());
    GridBagConstraints constCenter = new GridBagConstraints();

    /* do random gridbagconstraints stuff */  

    nonCharacterArea.add(actionPane, constCenter); // actionPane is a kind of JPanel

    /* do random gridbagconstraints stuff */        

    nonCharacterArea.add(menuPane, constCenter); // menuPane is a kind of JPanel
    pane.add(nonCharacterArea, gbc);

    /* do random gridbagconstraints stuff */      

    pane.add(characters.get(1).getMainLayout(), gbc);

    gbc.gridx = 0;
    gbc.gridy = 2;      

    pane.add(characters.get(2).getMainLayout(), gbc);

    gbc.gridx = 2;
    gbc.gridy = 2;        

    pane.add(characters.get(3).getMainLayout(), gbc);
} // setMainLayout 
```

我希望能够`actionPane`在执行期间动态更改对象。实现这一目标的最佳方法是什么？我专门编写了这个伪代码块，以表明它并不像人们在类似问题中发布的其他示例那样简单——因为它基于 JPanel 在屏幕上某个位置的精确放置，而这个 setMainLayout () 方法不必在每次我只想更改 actionPane 对象时调用。

有时是横屏，有时是商店界面，可以是很多不同的东西。

想法？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-10T23:11:53.563

如果它`actionPane`是从一小组预定义的面板中获取的，并且具有相对较小的实时更新和更改，那么一个不错的选择是使用[CardLayout](http://docs.oracle.com/javase/7/docs/api/java/awt/CardLayout.html)，并根据需要在预定义的 actionPanes 之间切换。

如果 actionPane 非常动态并且您真的无法提前预测它可能是什么，那么@Greg Kopff 有一个合理的答案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-10T23:02:35.283

不要添加和删除`actionPane`- 保留它，而是添加/删除子组件到`actionPane`. 然后，此任务变得相对微不足道，因为`actionPane`仅包含一个组件。

# webdav - Box.net 和 WebDAV - 返回的格式似乎错误

> ID：11421921
> 
> 赞同：0
> 
> 时间：2012-07-10T21:04:39.687
> 
> 标签：webdav, box-api

我正在尝试使用 WebDAV (https://box.com/dav) 从 Box.net 获取文件/文件夹列表。

但是，即使我正在构建（我认为是）一个有效的 WebDAV PROPFIND 请求。数据以 HTML 格式从 Box 返回。

我期待这样的事情： [http ://www.webdav.org/specs/rfc2518.html#rfc.section.8.1.2](http://www.webdav.org/specs/rfc2518.html#rfc.section.8.1.2)

但是，它回来列出这个：

```
<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>Box WebDAV list</title>
  </head>
  <body>
    <p>
      <a href="http://www.box.com/dav/A%20Test.pdf">A Test.pdf</a>
    </p>
    <p>
    ... 
```

我做错了什么，还是这是一个有效的 WebDAV 响应？

我宁愿回到我目前处理的 WebDAV 格式而不是自定义解析它，但如果有必要可以这样做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-10T21:39:34.633

尝试向[https://www.box.com/dav](https://www.box.com/dav) 发出[PROPFIND](https://box.com/dav)请求将导致您看到的 HTML 输出

# php - Symfony2 Twig Asset Base_Url 是不可预测的？

> ID：11421925
> 
> 赞同：3
> 
> 时间：2012-07-10T21:04:59.927
> 
> 标签：php, symfony, twig

我正在使用 Twig 循环`<img src="">`为多个图像生成。我最终使用此代码是在框架配置中利用带有 base_url 的 CDN。

下面是`Twig`代码：

```
{% for key, mobj in productmedia.getImages %}
    <img src="{{ asset(path('cropImage', {'filename': mobj.getFilename }),'cdn') }}" />
{% endfor %}

{% for key, mobj in productmedia.getImages %}
  <img src="{{ asset(path('cropImageSm', {'filename': mobj.getFilename }),'cdn') }}" />
{% endfor %} 
```

我希望，至少输出会有一些一致性。但似乎 SF2 有时会使用一个 base_url，有时不使用一个。为什么会这样？

下面是输出。

```
<img src="http://cdn.cloudfront.net/cri/1/matt-skydiving.SH340_SW340.jpg" />
<img src="/cri/1/Swimming.SH340_SW340.jpg" />
<img src="http://cdn.cloudfront.net/cri/1/successman2.SH340_SW340.jpg" />

<img src="/cri/1/matt-skydiving.SH40_SW40.jpg" />
<img src="http://cdn.cloudfront.net/cri/1/Swimming.SH40_SW40.jpg" />
<img src="http://cdn.cloudfront.net/cri/1/successman2.SH40_SW40.jpg" /> 
```

正如您在第一个循环中看到的那样..有些继承了base_url ..有些没有..我已经清除了所有缓存..完成了所有常规调试步骤..为什么不这样做是没有意义的持续的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-10T21:50:33.273

您可以切换到`url`twig 函数，它与此相同，`path`但始终返回一个绝对 url：

```
url('cropImageSm', {'filename': mobj.getFilename }) 
```

进一步参考：

`Asset()`将使用 config.yml 中提供的主机

```
framework:
    templating:
        packages:
            {althostname}:
                base_urls:  { http: ["http://www.domain2.com"], ssl: "/"] } 
```

所以`{{ asset(path('route1', {'page': 1 }),'althostname') }}`会输出..`http://www.domain2.com/route1/page/1`

# android - 可停靠片段

> ID：11421930
> 
> 赞同：0
> 
> 时间：2012-07-10T21:05:07.323
> 
> 标签：android, android-fragments

我的活动中有两个片段。其中之一是列表片段。

我想让 listfragment 可停靠，有什么想法可以做到这一点吗？

# php - 如何检查数字的顺序是否正确？

> ID：11421931
> 
> 赞同：3
> 
> 时间：2012-07-10T21:05:07.027
> 
> 标签：php, validation, numbers

我有一个二维数组，其中包含必须使用以下规则验证的数字范围，范围应从 0 开始并遵循算术级数。

例如：

```
$array = array();
$array[] = array(0);//VALID
$array[] = array(0,1,2,3,4,5);//VALID
$array[] = array("0","1");//VALID
$array[] = array(0,1,3,4,5,6);//WRONG
$array[] = array(1,2,3,4,5);//WRONG
$array[] = array(0,0,1,2,3,4);//WRONG 
```

在 php 中最有效的方法是什么？

**更新** 我忘了添加数字可以表示为字符串

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-10T21:07:27.337

比较它`range($firstelt, $lastelt)`？

```
function isProgression($arr){
    return $arr == range(0, $arr[count($arr)-1]);
} 
```

* * *

完全任意的基准：

```
function isProgression($array){
        return ($array == range(0, $array[sizeof($array)-1]));
}

function isProgression2($array){
    $count = count($array);
    for ($i = 0; $i < $count; ++$i) {
        if($array[$i] != $i){
             return true;
        }
    }
    return false;
}

for ($x = 0; $x < 1000000; $x++) {
        // Pick one
        isProgression(array(0,1,2,3,4,5));
        isProgression2(array(0,1,2,3,4,5));
} 
```

结果：

```
isProgression:   0m2.345s
isProgression2:  0m1.906s 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-10T21:08:33.180

```
array_map(function($inner){
    foreach(array_values($inner) as $key => $value){
        if($key != $value)return "WRONG";
    }
    return "VALID";
},$array) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-10T21:13:25.460

尝试：

```
for ($i = 0; $i < count($array); ++$i) {
    if($array[$i] != $i){
        //invalid
    }
}
//valid 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-10T21:15:05.390

通过引用传递数组对于小型数组可能不是最佳的。

```
 $valid = true;
 foreach ($array as &$inner) {
      $i = -1;
      foreach ($inner as $key => $value) {
           if ((++$i != $key) || ($key != $value)) {
                $valid = false;
                break 2;
           }
      }
 } 
```

# sql-server-2008 - Coldfusion CFSTOREDPROC 不返回表

> ID：11421933
> 
> 赞同：2
> 
> 时间：2012-07-10T21:05:08.253
> 
> 标签：sql-server-2008, coldfusion, coldfusion-9, temp-tables, cfstoredproc

我正在使用 Coldfusion 9 和 SQL Server 2008。我正在尝试学习这些平台并真正学习如何有效地利用这两个平台来生成报告解决方案。我在存储过程或存储过程方面遇到了一些巨大的挑战。我想要的只是一个非常简单的答案，让我的存储过程达到我可以在 CFML 中利用它们并将数据提供给需要它的人的程度。

我在网上做了一些研究，似乎 SQL Server 2008 利用了放置在 RAM (@) 中或为本地用户 (#) 写入磁盘的临时表。我的问题是我似乎无法让生成的临时表从进程调用中将数据返回给 ColdFusion，尽管当我运行添加到 SQL Server 中的临时表中的 SQL 查询部分时，它的工作原理类似于魅力。我要做的就是将一个简单的表返回给 ColdFusion，并确保我以最有效的方式对其进行编码。

我试过： - 使用 Return 语句，但这似乎会产生 RAM 表 (@) 的语法错误。- 使用持久临时表 (#) - 尽管各种在线论坛似乎认为使用此功能，但应用程序会因此而受到很大的性能影响。（每个人都是批评家。）

我的目标是： - 尽可能多地学习这个过程，尽可能多地重复使用它 - 学习正确的方法来做到这一点，以便查询尽可能好地执行。- 了解在什么情况下我在 SPROCS 中使用 (@) 和 (#) 临时表以及为什么。一些人认为持久临时表 (#) 更好，因为它可以为编译期间触发的其他存储过程释放内存，而另一些人认为让服务器去硬盘写入数据更慢。- 了解为什么下面的语法不起作用

目前我的 CFML 代码如下所示：

```
<!--- ===========================================================================================================================
================================================= Page Resources ================================================================
=============================================================================================================================--->
<CFSTOREDPROC datasource="PoliticalDonationsDB" procedure=" sp_GetCurrentDonationCount_withDateRange" result="DONATIONCOUNT">
    <!--- In --->
    <cfprocparam cfsqltype="INT" dbvarname="SDate" value="2004">
    <cfprocparam cfsqltype="INT" dbvarname="EDate" value="2005">
    <!--- OUT --->
    <cfprocresult name="DonationCount">
</CFSTOREDPROC>

<!--- ===========================================================================================================================
================================================= Page Display ==================================================================
=============================================================================================================================--->

<HTML>
    <HEAD>
        <TITLE><CFOUTPUT>Title</CFOUTPUT></TITLE>
    </HEAD>

    <BODY>

        <div id="logo">
        </div><!--- End logo div --->

        <div id="currentRecords">
            <CFDUMP var="#VARIABLES#">
            <CFDUMP VAR="#DONATIONCOUNT#">
        </div><!---End currentRecords--->

        <div id="navigation">
            <ul>
                <li>Companies</li>
                    <ul>
                        <li></li>
                    </ul>
            </ul>
        </div><!--- End navigation div--->

        <div id="statisticsTab">
        </div> <!--- End Statistics div--->

    </BODY>
</HTML> 
```

我的 SQL Server 代码如下所示：

```
Use Politics 
GO

ALTER procedure sp_GetCurrentDonationCount_withDateRange
@SDate AS int,
@EDate AS int
AS
BEGIN
    --Create RAM Table
    DECLARE @DonationCountTable TABLE
    ( donationKey INT,
      CompanyKey INT,
      SenatorKey INT,
      donationAmount MONEY,
      donationDateFY INT
    )

    --Put the stuff into the RAM table
    INSERT INTO @DonationCountTable (donationKey, CompanyKey, SenatorKey, donationAmount, donationDateFY)
    SELECT * FROM PoliticalDontations
    WHERE donationDateFY BETWEEN @SDate AND @EDate
    ORDER BY donationDateFY, CompanyKey ASC

    --Get the stuff out of the RAM Table
    SELECT * FROM @DonationCountTable
END 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-10T21:18:54.503

你需要这个：

```
<cfprocparam cfsqltype="CF_SQL_INTEGER" value="2004"> 
```

DBVARNAME 已弃用：
[http ://livedocs.adobe.com/coldfusion/8/htmldocs/help.html?content=Tags_p-q_14.html](http://livedocs.adobe.com/coldfusion/8/htmldocs/help.html?content=Tags_p-q_14.html)

这是可接受的 CFSQLTYPES 列表

```
CF_SQL_BIGINT
CF_SQL_BIT
CF_SQL_BLOB
CF_SQL_CHAR
CF_SQL_CLOB
CF_SQL_DATE
CF_SQL_DECIMAL
CF_SQL_DOUBLE
CF_SQL_FLOAT
CF_SQL_IDSTAMP
CF_SQL_INTEGER
CF_SQL_LONGVARCHAR
CF_SQL_MONEY
CF_SQL_MONEY4
CF_SQL_NUMERIC
CF_SQL_REAL
CF_SQL_REFCURSOR
CF_SQL_SMALLINT
CF_SQL_TIME
CF_SQL_TIMESTAMP
CF_SQL_TINYINT
CF_SQL_VARCHAR 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T19:05:28.313

```
--把东西放到RAM表中
--/// 注释 /// （这实际上返回第一个结果集，由一个 ADO accessibel 对象组成，该对象包含受影响的记录计数 *RW）
     插入@DonationCountTable（donationKey、CompanyKey、SenatorKey、donationAmount、donationDateFY）
     从政治捐款中选择 *
     @SDate 和 @EDate 之间的捐赠日期
     ORDER BYdonationDateFY, CompanyKey ASC

```

我想说-人们有时会陷入存储过程的陷阱是许多命令会导致记录集对象（您的 INSERT...SELECT 在此示例中执行），我怀疑您要么不想要所有这些记录集，或者至少你需要使用来选择合适的。

解决此问题的一种方法是在 CREATE...AS 之后立即开始。使用“SET NOCOUNT ON”语句。我经常这样做 - 然后你的：

```
        -- 从 RAM 表中取出东西
       选择 * 从 @DonationCountTable  

```

应该返回唯一的结果集。我知道这很旧，但也许它可以帮助某人。这肯定是在过去几年影响了我的 SQL 编码的东西——不确定 MySQL 或 Oracle 是否会产生类似的问题/或有类似的修复。

R White - 路过的贡献者

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-10T21:11:30.627

尝试：

```
 <cfprocparam cfsqltype="INT" dbvarname="@SDate" value="2004">
 <cfprocparam cfsqltype="INT" dbvarname="@EDate" value="2005"> 
```

# c# - CSLA Silverlight 项目 (C#) 示例 N 层应用程序（添加删除功能）

> ID：11421940
> 
> 赞同：0
> 
> 时间：2012-07-10T21:05:56.060
> 
> 标签：c#, silverlight, business-objects, csla

我知道这是一个非常具体的问题，但我试图了解 CSLA 框架。我已经成功加载了“Sample N-Tier”应用程序，可以在这里找到：

[http://lhotka.net/files/csla40/CslaSamples-4.3.13.zip](http://lhotka.net/files/csla40/CslaSamples-4.3.13.zip)

示例 N-Tier silverlight 应用程序允许您将 LineItem 对象添加到 LineItems 集合，该集合与 Customer Name 和 Customer ID 字段一起构成 Order 对象。

我正在尝试扩展应用程序的功能，作为使订单项可删除的练习。下面的代码来自 OrderVM.cs 文件，定义了“添加”按钮单击事件的功能。它调用不带任何参数的 Model.LineItems.AddNew() 方法。我想删除*选定*的LineItem，而不仅仅是第一个项目，因为我现在已经对其进行了编码写入。我的代码有效，但我不知道如何检索 LineItem 对象或我当前选择的行的索引/ID。

```
namespace SilverlightUI
{
  public class OrderVm : ViewModel<BusinessLibrary.Order>
  {
    public OrderVm()
    {
      //BeginRefresh(BusinessLibrary.Order.NewOrder);
      BeginRefresh(callback => BusinessLibrary.Order.GetOrder(231, callback));
    }

    protected override void OnError(Exception error)
    {
      Bxf.Shell.Instance.ShowError(error.Message, "Error");
    }

    public override void AddNew(object sender, ExecuteEventArgs e)
    {
      Model.LineItems.AddNew();
    }
    public override void Remove(object sender, ExecuteEventArgs e)
    {
        //Bxf.Shell.Instance.ShowError(Model.LineItems.AllowRemove.ToString(), "Delete");
        if(Model.LineItems.Count>0)
            Model.LineItems.RemoveAt(0);        
    }
  }
} 
```

有人可以解释如何从选定的 DataGrid 行中检索 LineItem 对象吗？

谢谢！

编辑：下面发布的是 OrderEdit.xaml 文件的 XAML。

```
 <UserControl
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:csla="clr-namespace:Csla.Xaml;assembly=Csla.Xaml"
        xmlns:cslaRules="clr-namespace:Csla.Rules;assembly=Csla"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
        xmlns:sdk="http://schemas.microsoft.com/winfx/2006/xaml/presentation/sdk" 
        xmlns:my="clr-namespace:SilverlightUI" 
        xmlns:System="clr-namespace:System;assembly=mscorlib"
        xmlns:c="clr-namespace:System.Windows.Controls;assembly=System.Windows"
        xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity" 
        xmlns:ei="http://schemas.microsoft.com/expression/2010/interactions" 
        x:Class="SilverlightUI.OrderEdit"    
        mc:Ignorable="d"
        d:DesignHeight="410" d:DesignWidth="667" 
        Loaded="UserControl_Loaded">

      <UserControl.Resources>
        <ResourceDictionary>
          <ResourceDictionary.MergedDictionaries>
            <ResourceDictionary Source="./Themes/CslaSampleResources.xaml" />
          </ResourceDictionary.MergedDictionaries>

          <CollectionViewSource x:Key="orderVmViewSource" d:DesignSource="{d:DesignInstance my:OrderVm, CreateList=True}" />
          <CollectionViewSource x:Key="orderVmLineItemsViewSource" Source="{Binding LineItems, Source={StaticResource orderVmViewSource}}" />
        </ResourceDictionary>
      </UserControl.Resources>

      <Border Padding="0,10,0,0" CornerRadius="10,10,0,0">
        <Border.Background>
          <LinearGradientBrush EndPoint="1.005,0.5" StartPoint="0,0.5">
            <GradientStop Color="#7FFFFFFF" Offset="0"/>
            <GradientStop Color="#99FFFFFF" Offset="1"/>
          </LinearGradientBrush>
        </Border.Background>

        <Grid x:Name="LayoutRoot" DataContext="{Binding Source={StaticResource orderVmViewSource}}">
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="*" />
          </Grid.ColumnDefinitions>
          <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
          </Grid.RowDefinitions>

          <TextBlock Text="Customer Id:" Grid.Column="0" Grid.Row="0" Style="{StaticResource LabelTextStyle}" />
          <TextBox Grid.Column="1" Grid.Row="0" x:Name="idTextBox" Text="{Binding Model.Id, Mode=OneWay}" Style="{StaticResource TextBoxStyle}" />

          <TextBlock Text="Customer Name:" Grid.Column="0" Grid.Row="1" Style="{StaticResource LabelTextStyle}" />
          <TextBox Grid.Column="1" Grid.Row="1" x:Name="customerNameTextBox" Text="{Binding Model.CustomerName, Mode=TwoWay, ValidatesOnNotifyDataErrors=False}" Style="{StaticResource TextBoxStyle}" />
          <!--<csla:PropertyInfo Property="{Binding Path=Model.CustomerName}" x:Name="pi" />-->

          <TextBlock Grid.Row="2" Grid.ColumnSpan="2" Text="orders" Style="{StaticResource SubHeadingTextStyle}" Margin="10,15,0,0" />

          <sdk:DataGrid Grid.Row="3" Grid.ColumnSpan="2" 
                        AutoGenerateColumns="False" 
                        ItemsSource="{Binding Model.LineItems}"
                        x:Name="lineItemsDataGrid" 
                        RowDetailsVisibilityMode="VisibleWhenSelected" 
                        RowBackground="{x:Null}" 
                        BorderBrush="{x:Null}" 
                        HorizontalGridLinesBrush="{x:Null}" 
                        VerticalGridLinesBrush="{x:Null}" 
                        GridLinesVisibility="None" 
                        Background="White" 
                        ColumnHeaderHeight="35"
                        ColumnHeaderStyle="{StaticResource DataGridHeaderStyle}"
                        RowStyle="{StaticResource DataGridRowStyle}"
                        CellStyle="{StaticResource DataGridCellStyle}">
            <sdk:DataGrid.Columns>
              <sdk:DataGridTextColumn x:Name="idColumn" Binding="{Binding Id}" Header="ID" Width="Auto" />
              <sdk:DataGridTextColumn x:Name="nameColumn" Binding="{Binding Name}" Header="NAME" Width="*" />
            </sdk:DataGrid.Columns>
          </sdk:DataGrid>

          <Button Grid.Row="3" Grid.Column="1" x:Name="AddNewButton" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0,5,10,5" Style="{StaticResource AddButtonStyle}" />
          <csla:TriggerAction TargetControl="{Binding ElementName=AddNewButton}" MethodName="AddNew" DataContext="{Binding CurrentItem}" />

<Button Grid.Row="3" Grid.Column="1" x:Name="DeleteButton" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0,5,10,5" />
          <csla:TriggerAction TargetControl="{Binding ElementName=DeleteButton}" MethodName="Remove" DataContext="{Binding CurrentItem}" />

          <Border Grid.Row="4" Grid.ColumnSpan="2" Background="#FFE0E0E0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" />

          <StackPanel Grid.Row="4" x:Name="stackPanel1" DataContext="{Binding CurrentItem}" Orientation="Horizontal" VerticalAlignment="Center" HorizontalAlignment="Right" Grid.Column="1">
            <Button Content="cancel" x:Name="CancelButton" IsEnabled="{Binding CanCancel}" Margin="3" Style="{StaticResource CslaButtonStyle}" />
            <Button Content="save" x:Name="SaveButton" IsEnabled="{Binding CanSave}" Margin="3" Style="{StaticResource CslaButtonStyle}" />
            <csla:TriggerAction TargetControl="{Binding ElementName=SaveButton}" MethodName="Save"/>
            <csla:TriggerAction TargetControl="{Binding ElementName=CancelButton}" MethodName="Cancel"/>
          </StackPanel>

          <StackPanel Grid.Row="4" Orientation="Horizontal">
            <Rectangle Style="{StaticResource DecoratorRectangle}"/>
            <Rectangle Style="{StaticResource DecoratorRectangle}"/>
            <Rectangle Style="{StaticResource DecoratorRectangle}"/>
            <Rectangle Style="{StaticResource DecoratorRectangle}"/>
          </StackPanel>

        </Grid>
      </Border>
    </UserControl> 
```

* * *

我相信为了访问在 DataGrid 中选择的 ListItem，我必须以某种方式将 DataGrid 的 SelectedItem 属性绑定到我的 ViewModel 中的属性，我是否理解正确？

我可以添加如下内容：

```
SelectedItem="{Binding ViewModel.SelectedListItem}", 
```

到 XAML DataGrid 元素，但我仍然有点不清楚要为绑定属性放置什么才能真正让它在我的 OrderVm.cs 中设置属性...

有人可以帮我装订什么吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T15:03:06.687

我们有一个使用 CSLA 的 Silverlight 应用程序。这是我们的 DataGrid 中用于删除行的代码（如果它们也选择了多行，它也可以工作）：

```
/// <summary>
/// Removes selected items from the IEditableCollection
/// </summary>
public void RemoveSelectedRows()
{
    var item = CurrentItem as IEditableBusinessObject;

    // if row is not valid, cancel rather than commit to avoid validation
    if (item != null)
    {
        item.CheckRules();

        if (!item.IsValid)
            this.CancelEdit();
        else
            this.CommitEdit();
    }
    else
    {
        this.CommitEdit();
    }

    //          _lastErrorRow = -1;

    if (SelectedItems.Count == 0)
    {
        MsgBox.ShowMsg(SharedResources._PleaseSelectRowFirst);
        return;
    }

    var col = ItemsSource as Csla.Core.IEditableCollection;
    if (col != null)
    {
        var deleteItems = SelectedItems.OfType<IEditableBusinessObject>().ToList();

        int i = 0;
        while (i < deleteItems.Count)
        {
            col.RemoveChild(deleteItems[i]);
        }
    }
} 
```

请记住，这里的上下文是此代码位于 DataGrid 本身中。因此，在您的按钮单击中，您将拥有以下内容：

lineItemsDataGrid.RemoveRows();

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T11:59:55.587

```
public override void Remove(object sender, ExecuteEventArgs e) 
{ 
    //Bxf.Shell.Instance.ShowError(Model.LineItems.AllowRemove.ToString(), "Delete"); 
    if(Model.LineItems.Count>0) 
        Model.LineItems.RemoveAt(0);         
} 
```

ExecuteEventArgs 不公开某种论点吗？查看文档，它看起来像“CommandOption”可用（其中包含一个`Arg`成员）。您不能将 SelectedItem 绑定到 TriggerAction 的 CommandOption 吗？我实际上还没有在 CSLA 中使用 TriggerActions，所以我可能会自己看一下。您必须能够绑定命令的参数，以便命令处理程序具有某种上下文

编辑：

查看 Rocky 在他的博客上的一篇文章：

[http://www.lhotka.net/weblog/UsingTheTriggerActionControl.aspx](http://www.lhotka.net/weblog/UsingTheTriggerActionControl.aspx)

看起来 TriggerAction 上有一个 Parameter 成员，它必须将参数传递给执行上下文

编辑2：

所以只需绑定`YourControl.SelectedItem`到`TriggerAction.MethodParameter`，然后在您的方法中`ExecuteEventArgs`应该包含对所选对象的引用。

然后你可以使用

```
Model.LineItems.Remove(e.???); 
```

不确定事件参数上的成员是什么，但你可以解决这个问题:)

# html - 使用 HTML 和 CSS，如何使图像与水平线垂直对齐？

> ID：11421943
> 
> 赞同：1
> 
> 时间：2012-07-10T21:06:26.963
> 
> 标签：html, css, alignment, line

我希望左侧的图像与右侧的水平线相邻（底部对齐）。它应该具有响应性，以便线条可以根据需要更改宽度。现在，图像位于线条的顶部，而不是旁边。

编辑：这将提供更多说明。橙色部分是图像。细的灰色线是线。 [http://screencast.com/t/beMBRhpBpZ](http://screencast.com/t/beMBRhpBpZ)

这是HTML

```
<div>
    <img src="image.png">
    <hr>
</div> 
```

这是CSS

```
img {
    float:left
}
hr {
    width:100%
} 
```

如何做到这一点？可以根据需要更改 HTML/CSS。但应该是跨浏览器兼容和响应式的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T02:12:33.730

```
div {
border-bottom: 3px solid #000;
}

img {
    position: relative;
    bottom: -3px;
} 
```

你真的不需要hr。border-bottom 是你需要的。

# sql - 内连接，每个产品只返回1行

> ID：11421951
> 
> 赞同：2
> 
> 时间：2012-07-10T21:06:55.123
> 
> 标签：sql

希望这很简单，但我想做的只是为 CartContents 表中的每个产品拉回 1 行。我遇到的问题是某些产品有多个图像，所以如果有超过 1 个图像链接到一个产品，这些图像将被返回。

这是我创建的，但它仍然为每个产品拉回多行。

```
SELECT DISTINCT (pri.FileName), p.Title, tc.Quantity, tc.FK_ProductID
    FROM [Ordering].[CartContents] tc
    INNER JOIN [Ordering].[Products] p ON p.ProductID = tc.FK_ProductID
    INNER JOIN [Ordering].[ProductImages] pri on pri.FK_ProductID = p.ProductID
    WHERE FK_UserID = @FK_UserID 
```

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-10T21:13:54.883

假设您没有文件名，“in”会解决这个问题：

```
SELECT p.Title, tc.Quantity, tc.FK_ProductID
FROM [Ordering].[CartContents] tc  INNER JOIN
     [Ordering].[Products] p
     ON p.ProductID = tc.FK_ProductID
where p.ProductID in (select pri.FK_ProductID 
                      from [Ordering].[ProductImages] pri
                     ) and
      FK_UserID = @FK_UserID 
```

使用文件名，您必须任意选择一个：

```
SELECT min(pri.FileName) as FileName, Title, tc.Quantity, tc.FK_ProductID
FROM [Ordering].[CartContents] tc  INNER JOIN
     [Ordering].[Products] p
     ON p.ProductID = tc.FK_ProductID INNER JOIN
     [Ordering].[ProductImages] pri on pri.FK_ProductID = p.ProductID
where FK_UserID = @FK_UserID 
group by Title, tc.Quantity, tc.FK_ProductID 
```

# html - 为什么内联元素不从其子元素继承高度？

> ID：11421952
> 
> 赞同：4
> 
> 时间：2012-07-10T21:07:08.703
> 
> 标签：html, css

我正在尝试制作一个相当复杂的图像和信息网格（几乎像 Pinterest）。具体来说，我正在尝试将一组依次内联`<ul>s`。我让它工作但一个方面导致问题所以我试图询问这个小部分以避免整个问题的复杂化。

为了水平对齐图像及其信息，我们将内联`<li>s`与其中的其他内联块级元素一起使用。`<li>s`除了几乎没有高度之外，一切都正常工作。

HTML 和 CSS[在 JSFiddle 中，](http://jsfiddle.net/GaJm2/2/)如果你想弄乱它，除了下面：

HTML：

```
<div>
<ul class="Container">
    <li>
        <span class="Item">
            <a href="#"><img src="http://jsfiddle.net/img/logo.png"/></a>
            <span class="Info">
                <a href="#">Title One</a>
                <span class="Details">One Point One</span>
            </span>
        </span>
    </li>
    <li>
        <span class="Item">
            <a href="#"><img src="http://jsfiddle.net/img/logo.png"/></a>
            <span class="Info">
                <a href="#">Title Two</a>
                <span class="Details">Two Point One</span>
            </span>
        </span>
    </li>
</ul> 
```

CSS：

```
.Container {
    list-style-type:none;
}
.Container li {
    background-color:grey;
    display:inline;
    text-align:center;
}
.Container li .Item {
    border:solid 2px #ccc;
    display:inline-block;
    min-height:50px;
    vertical-align:top;
    width:170px;
}
.Container li .Item .Info {
    display:inline-block;
}
.Container li .Item .Info a {
    display:inline-block;
    width:160px;
} 
```

如果您查看 jsfiddle 链接中的结果，您会看到灰色背景仅包含整个`<li>`. 我知道改变`<li>`来`display:inline-block`解决这个问题，但由于其他原因这是不可行的。

所以首先，我只是想看看是否有人理解为什么内联`<li>`元素没有任何高度。我在规范中找不到任何解释这一点的东西。我知道我不能将高度添加到内联元素，但是任何关于为什么会发生这种情况的解释可能会让我修复它会很棒。

其次，如果您使用 IE 的开发人员模式检查元素，您会看到虽然背景颜色在正确的位置，但`<li>'s`根据将鼠标悬停在元素上，边界框的实际位置在容器的底部。如果它在每个浏览器中都位于顶部，我可以处理这个问题，但它显然会有所不同。

注意：在这种情况下，我并不真正关心旧版浏览器，但我不使用 HTML5 或 JavaScript 定位。

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-10T21:38:39.573

内联元素没有设置`height`. 内联元素是在一行上的元素，因此继承了行的高度。块元素是占据整个宽度的元素，可以指定宽度、高度和其他使它们更容易设置样式的东西。

有关规范中的详细说明，请参见： [http ://www.w3.org/TR/CSS2/visuren.html#inline-formatting](http://www.w3.org/TR/CSS2/visuren.html#inline-formatting)

`inline-block`使元素显示为内联，但您可以分配`height`和`width`给它，它会随着其中的内容而扩展。我没有`inline-block`经常使用，因为它在 IE 中的错误行为，但那些日子现在已经结束了： [http ://www.quirksmode.org/css/display.html](http://www.quirksmode.org/css/display.html)

`<li>`使用 using解决`inline-block`了这个问题，但你说这不是你的选择。为什么不？另一种解决方案是使那些 li 的块元素，并使它们向左浮动。如果您遇到内容重叠的问题，请在整个 ul 上使用溢出属性，以确保 ul 正在下推其他内容。

```
ul.Container {
  list-style-type: none;
  overflow: hidden; /* so height expands with the floated content */
}

ul.Container li {
  display: block;
  float: left;
  ... more styling ...
} 
```

这是否可以解决您的难题？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-10T23:28:19.510

CSS 2.1 规范的相关位是[第 10.6.1 节的 Inline, non-replaced elements](http://www.w3.org/TR/CSS2/visudet.html#inline-non-replaced) of [section 10.6 Calculating heights and margins](http://www.w3.org/TR/CSS2/visudet.html#Computing_heights_and_margins)。它说：

> 'height' 属性不适用。内容区域的高度应该基于字体，但是这个规范没有具体说明如何。例如，UA 可以使用 em-box 或字体的最大升序和降序。（后者将确保部分高于或低于 em-box 的字形仍在内容区域内，但会导致不同字体的不同大小的框；前者将确保作者可以控制相对于“行高”的背景样式，但会导致字形在其内容区域之外绘制。）

该`<li>`元素采用内联样式，其内容是一个不能跨行的内联块对象，因此 的内容区域`<li>`只有一行高。因此，内容区域的高度`<li>`为 1 xf（字体高度）。有关字体高度的增加使灰色区域变大的演示，请参见[http://jsfiddle.net/dh8nU/1/ 。](http://jsfiddle.net/dh8nU/1/)

该部分继续说：

> 内联非替换框的垂直内边距、边框和边距从内容区域的顶部和底部开始，**与 'line-height' 无关**。但在计算行框高度时只使用“行高”。 *[我的重点]*

当您将较大的 inline-block 元素放在 inline 元素中时，行框的高度会增加以包含 inline-block 元素，但根据上面的文本，这不会增加包含 inline 元素的高度。

# android - Windows下adb中运行vi

> ID：11421955
> 
> 赞同：9
> 
> 时间：2012-07-10T21:07:20.537
> 
> 标签：android, windows, adb, vi

偶尔，我会想在我的 Android 设备上编辑一个文件，比如 /system/build.prop 或 /etc/hosts。我发现最简单的方法是：

```
c:\> adb shell
$ su
# vi /etc/hosts 
```

如果我使用的是 Linux，这可以正常工作。但是，在使用 Windows 时尝试在我的手机上运行 vi 会导致 vi 屏幕出现奇怪的字符。我假设这是因为`cmd`不支持 ANSI 控制字符。

有什么办法可以解决这个问题（例如，一个可以完成这项工作的 cmd 替代品）？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2015-03-13T13:05:57.047

您可以使用[PuTTYTray](https://puttytray.goeswhere.com/)来完成。它是 PuTTY 的改进版本，具有许多附加功能。其中一项功能是 Android *adb*支持。要使用它：

*   选择`Adb`作为*连接类型*
*   在*主机*字段中输入`-d`（对于单个 USB 设备）或[设备序列号](http://developer.android.com/tools/help/adb.html#directingcommands)
**   ？？？*   利润！！！*

 *![PuTTYTray 配置](../Images/7082a80389ebe3db3cf909736a09be5a.png)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-03-30T18:57:18.693

这是您在 2012 年的问题的较晚答案。我发现如果我运行 Windows PowerShell，我可以在 adb shell 下执行“vi”。

启动 PowerShell（使用您的 Android SDK 位置，而不是我的）

```
PS C:\Users\Me> cd Downloads\Android\Sdk\Platform-Tools
PS C:\Users\Me\Downloads\Android\Sdk\Platform-Tools> .\adb shell
root@vbox86p:/ # cd data/data/com.mycorporation.myproj/shared_prefs
root@vbox86p:/data/data/com.mycorporation.myproj/shared_prefs # vi log_prefs 
```

我只使用了简单的 vi 命令，如 'o'、'esc' 和 ':wq'，但它在全屏时效果很好（在 Windows 命令提示符中不会看到任何垃圾）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-10T22:21:14.893

我从来没有遇到过你的确切问题，但似乎[Cygwin](http://www.cygwin.com/)是一个不错的选择。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-03-19T22:42:32.417

您基本上需要的是一个真正的命令行... [Windows 上的 Unix 风格的工具？](https://stackoverflow.com/questions/1414383/unix-style-tools-on-windows)MinGW [http://www.mingw.org/](http://www.mingw.org/)是 Cygwin 的替代品，值得研究。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-12-24T10:00:46.183

我终于找到了一个在 Windows 2012 R2 中工作的工具。你需要运行cmder 可以在[这里找到下载](https://cmder.net/)

然后运行

```
cmder 
```

转到 adb 文件夹，

```
cd XXX 
```

然后

```
adb shell
su
cd /system/etc
vi hosts 
```

正确显示*

# ruby - 将块的结果连接到没有临时变量的数组中？

> ID：11421959
> 
> 赞同：1
> 
> 时间：2012-07-10T21:07:40.693
> 
> 标签：ruby

我目前正在使用以下代码：

```
text = "a, 1; b, 2"
temp = []
text.gsub(/\s+/, "").split(";").each {|x| temp << x.split(",")}
temp # => [["a","1"],["b","2"]] 
```

我想知道是否有一种巧妙的方法可以在一行中完成所有操作而无需额外的`temp = []`一行？如何将每个块执行的结果加入一个数组？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-10T21:10:45.873

[Enumerable](http://ruby-doc.org/core-1.9.3/Enumerable.html)模块是任何 Ruby 新手必读的。使用[Enumerable#map](http://ruby-doc.org/core-1.9.3/Enumerable.html#method-i-map)代替：

```
text.gsub(/\s+/, "").split(";").map { |x| x.split(",") }
#=> [["a", "1"], ["b", "2"]] 
```

看来您不熟悉函数式编程原理，这是一个可以帮助您的[链接（特别是：](http://code.google.com/p/tokland/wiki/RubyFunctionalProgramming) [see this](http://code.google.com/p/tokland/wiki/RubyFunctionalProgramming#init-empty_+_each_+_push_=_map)）。每次你写一个`each`想法时，如果有一些替代方案（可以做一个像写文件这样的副作用，但更新变量通常是个坏主意）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-10T21:19:57.113

对于您提供的非常有限的语料库，您可以使用*#scan*将字符串解析为数组，然后将一系列切片转换为子数组。例如：

```
"a, 1; b, 2".scan(/\w+/).each_slice(2).to_a
=> [["a", "1"], ["b", "2"]] 
```

这在更一般的意义上是否有用取决于您。

# jquery - 查找部分来源并删除 - 结束

> ID：11421965
> 
> 赞同：1
> 
> 时间：2012-07-10T21:07:59.527
> 
> 标签：jquery, regex

我有这个图片来源：

```
domain.com/wp-content/themes/directorypress/thumbs/CambridgeSlide_harvardsquare.jpg&w=695 
```

我想尝试删除 "&w=695" - 最好的方法是什么？用正则表达式找到它然后删除它并更新图像源？

一直在尝试一些方法，但似乎没有任何效果。

谢谢，

瑞安

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-10T21:11:06.307

甚至比这更简单！只需用 & 分割字符串，你就有答案了！

```
var str = "domain.com/wp-content/themes/directorypress/thumbs/CambridgeSlide_harvardsquare.jpg&w=695";
arr = str.split("&");
return arr[0]; 
```

​</p>

[http://jsfiddle.net/9KhwX/1/](http://jsfiddle.net/9KhwX/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-10T21:11:54.947

无需使用正则表达式，`lastIndexOf`这`substring`就是您所需要的：

```
var $img = $("img"),
    imgSrc = $img.attr('src'),
    newImgSrc = imgSrc.substring(0, imgSrc.lastIndexOf('&'));
$img.attr('src', newImgSrc); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-10T21:11:40.973

```
$('img').prop('src', function(i, value) {
    return value.replace(/\&.+$/, '');
});

alert($('img').prop('src')); 
```

[**演示**](http://jsfiddle.net/ricardolohmann/uqHjt/1/)

# objective-c - UINavigationBar 中的 UISearchBar 与 ScopeBar

> ID：11421967
> 
> 赞同：0
> 
> 时间：2012-07-10T21:08:02.470
> 
> 标签：objective-c, ios, uinavigationbar, uisearchbar

我试图在 UINavigationBar 中放置一个 UISearchBar，我可以毫无问题地做到这一点。问题是我在编辑以显示范围栏时有逻辑。这一切都很好，只有一个例外。导航栏尝试将 UISearchBar 在标题视图内居中。这会导致搜索栏向上移动到导航栏上方。我尝试添加一些逻辑来设置搜索栏的框架，这样它就可以绘制在我的主视图之上，这很好。我只能设置高度，这会导致搜索栏很好地绘制在视图上，但它的宽度不足以覆盖整个屏幕。如果我在框架上设置宽度，它会回到尝试将 UISearchBar 在导航栏上居中的相同行为。有谁知道我怎么能做到这一点？

谢谢，

缺口

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T21:12:55.170

隐藏导航栏，并使用 UItoolbar 代替。您会看到相同类型的条形图，但在自定义方面更加灵活。

# ruby-on-rails - 我如何用 rspec 写这个

> ID：11421969
> 
> 赞同：5
> 
> 时间：2012-07-10T21:08:21.033
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rspec, tdd, capybara

我将我的 rspec 版本升级到最新版本，并且我的测试中断具有相似的语法

```
it "should delete a company" do
  expect { click_link "Delete Company" }.should change(Company, :count).by(-1)
end 
```

我查看了[文档](https://www.relishapp.com/rspec/rspec-expectations/v/2-11/docs/diffing)，但在当前版本中看不到任何可以做到这一点的东西......关于如何实现这一点的任何想法

我得到的错误是

```
9) Company Pages Edit page as an admin user should delete a company
   Failure/Error: expect { click_link "Delete Company" }.should change(Company, :count).by(-1)
   NoMethodError:
     undefined method `call' for #<RSpec::Expectations::ExpectationTarget:0x007fccafdfc360>
   # ./spec/requests/companies_spec.rb:79:in `block (3 levels) in <top (required)>' 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-10T23:18:22.980

这是关于使用期望的[文档](https://www.relishapp.com/rspec/rspec-expectations/v/2-0/docs/matchers/expect-change)

```
it "should delete a company" do
  expect { click_link "Delete Company" }.to change{Company.count}.by(-1)
end 
```

请注意以下更改

1.  `should`变成`to`
2.  `(Company, :count)`变成`{Company.count}`

# javascript - 避免 Jquery 插件冲突

> ID：11421971
> 
> 赞同：0
> 
> 时间：2012-07-10T21:08:31.783
> 
> 标签：javascript, jquery

在同一页面上我正在使用这个插件：

```
$g=jQuery.noConflict();
$g(function() {
    /*
    number of fieldsets
    */
    var fieldsetCount = $g('#formElem').children().length;

    /*
    current position of fieldset / navigation link
    */
    var current     = 1;

    /*
    sum and save the widths of each one of the fieldsets
    set the final sum as the total width of the steps element
    */
    var stepsWidth  = 0;
    var widths      = new Array();
    $g('#steps .step').each(function(i){
        var $step       = $g(this);
        widths[i]       = stepsWidth;
        stepsWidth      += $step.width();
    });
    $g('#steps').width(stepsWidth);

    /*
    to avoid problems in IE, focus the first input of the form
    */
    $g('#formElem').children(':first').find(':input:first').focus();    

    /*
    show the navigation bar
    */
    $g('#navigation_form').show();

    /*
    when clicking on a navigation link 
    the form slides to the corresponding fieldset
    */
    $g('#navigation_form a').bind('click',function(e){
        var $this   = $g(this);
        var prev    = current;
        $this.closest('ul').find('li').removeClass('selected');
        $this.parent().addClass('selected');
        /*
        we store the position of the link
        in the current variable 
        */
        current = $this.parent().index() + 1;
        /*
        animate / slide to the next or to the corresponding
        fieldset. The order of the links in the navigation
        is the order of the fieldsets.
        Also, after sliding, we trigger the focus on the first 
        input element of the new fieldset
        If we clicked on the last link (confirmation), then we validate
        all the fieldsets, otherwise we validate the previous one
        before the form slided
        */
        $g('#steps').stop().animate({
            marginLeft: '-' + widths[current-1] + 'px'
        },500,function(){
            if(current == fieldsetCount)
                validateSteps();
            else
                validateStep(prev);
            $g('#formElem').children(':nth-child('+ parseInt(current) +')').find(':input:first').focus();   
        });
        e.preventDefault();
    });

    /*
    clicking on the tab (on the last input of each fieldset), makes the form
    slide to the next step
    */
    $g('#formElem > fieldset').each(function(){
        var $fieldset = $g(this);
        $fieldset.children(':last').find(':input').keydown(function(e){
            if (e.which == 9){
                $g('#navigation_form li:nth-child(' + (parseInt(current)+1) + ') a').click();
                /* force the blur for validation */
                $g(this).blur();
                e.preventDefault();
            }
        });
    });

    /*
    validates errors on all the fieldsets
    records if the Form has errors in $('#formElem').data()
    */
    function validateSteps(){
        var FormErrors = false;
        for(var i = 1; i < fieldsetCount; ++i){
            var error = validateStep(i);
            if(error == -1)
                FormErrors = true;
        }
        $g('#formElem').data('errors',FormErrors);  
    }

    /*
    validates one fieldset
    and returns -1 if errors found, or 1 if not
    */
    function validateStep(step){
        if(step == fieldsetCount) return;

        var error = 1;
        var hasError = false;
        $g('#formElem').children(':nth-child('+ parseInt(step) +')').find(':input:not(button)').each(function(){
            var $this       = $g(this);
            var valueLength = jQuery.trim($this.val()).length;

            if(valueLength == ''){
                hasError = true;
                $this.css('background-color','#FFEDEF');
            }
            else
                $this.css('background-color','#FFFFFF');    
        });
        var $link = $g('#navigation_form li:nth-child(' + parseInt(step) + ') a');
        $link.parent().find('.error,.checked').remove();

        var valclass = 'checked';
        if(hasError){
            error = -1;
            valclass = 'error';
        }
        $g('<span class="'+valclass+'"></span>').insertAfter($link);

        return error;
    }

    /*
    if there are errors don't allow the user to submit
    */
    $g('#registerButton').bind('click',function(){
        if($g('#formElem').data('errors')){
            alert('Please correct the errors in the Form');
            return false;
        }   
    });
}); 
```

和这个：

```
 (function($){

 $countCursos = 1;
 $countFormsA = 1;
 $countFormsB = 1;

      $.fn.addForms = function(idform){

                    var adicionar_curso = "<p>"+
                     "  <label for='nome_curso'>Nome do Curso</label>"+
                     "  <input id='nome_curso' name='nome_curso["+$countCursos+"]' type='text' />"+
                     "  </p>";

    var myform2 = "<table>"+
                     "  <tr>"+
                     "     <td>Field C</td>"+
                     "     <td><input type='text' name='fieldc["+$countFormsA+"]'></td>"+
                     "     <td>Field D ("+$countFormsA+"):</td>"+
                     "     <td><textarea name='fieldd["+$countFormsA+"]'></textarea></td>"+
                     "     <td><button>remove</button></td>"+
                     "  </tr>"+
                     "</table>";

    var myform3 = "<table>"+
                     "  <tr>"+
                     "     <td>Field C</td>"+
                     "     <td><input type='text' name='fieldc["+$countFormsB+"]'></td>"+
                     "     <td>Field D ("+$countFormsB+"):</td>"+
                     "     <td><textarea name='fieldd["+$countFormsB+"]'></textarea></td>"+
                     "     <td><button>remove</button></td>"+
                     "  </tr>"+
                     "</table>";

                    if(idform=='novo_curso'){
                        alert(idform);
                        adicionar_curso = $("<div>"+adicionar_curso+"</div>");
                        $("button", $(adicionar_curso)).click(function(){ $(this).parent().parent().remove(); });
                        $(this).append(adicionar_curso);
                        $countCursos++;
                    }

                        if(idform=='mybutton1'){
                        alert(idform);
                        myform2 = $("<div>"+myform2+"</div>");
                        $("button", $(myform2)).click(function(){ $(this).parent().parent().remove(); });
                        $(this).append(myform2);

                            $countFormsA++;

                        }

                    if(idform=='mybutton2'){
                        alert(idform);
                        myform3 = $("<div>"+myform3+"</div>");
                        $("button", $(myform3)).click(function(){ $(this).parent().parent().remove(); });
                        $(this).append(myform3);

                            $countFormsB++;

                        }

      };
})(jQuery);         

 $(function(){
    $("#mybutton1").bind("click", function(e){
    e.preventDefault();
    var idform=this.id;

        if($countFormsA<3){
            $("#container1").addForms(idform);
        }       
    });
});

$(function(){
    $("#novo_curso").bind("click", function(e){
    e.preventDefault();
    var idform=this.id;
    alert(idform);
        if($countCursos<3){
            $("#outro_curso").addForms(idform);
        }       
    });
});

$(function(){
    $("#mybutton2").bind("click", function(e){
    e.preventDefault();
    var idform=this.id;

        if($countFormsB<3){
            $("#container2").addForms(idform);
        }       
    });
}); 
```

我的问题是两者发生冲突：

我之前在第一个上添加了 $g 以避免冲突，但事实是它们不能一起工作，任何提示我如何配置第二个以避免这种情况？

提前致谢！

好吧，在同一页面上，我想运行另一个 jquery 文件：

```
$j=jQuery.noConflict();

    $j(function() {
    $j('#menu > li').hover(
        function () {
            var $this = $j(this);
            $j('a',$this).stop(true,true).animate({
                    'bottom':'-55px'  /* para não elevar muito o separador*/
                }, 300);
            $j('i',$this).stop(true,true).animate({
                    'top':'-10px'
                }, 400);
        },
        function () {
            var $this = $j(this);
            $j('a',$this).stop(true,true).animate({
                    'bottom':'-130px'  /* para baixar o separador para o sitio original*/
                }, 300);
            $j('i',$this).stop(true,true).animate({
                    'top':'50px'
                }, 400);
        }
    );
}); 
```

它确实冲突：/它是一个jquerycore？

# blackberry - 在 BlackBerry 上使用线程并行获取自治和 CellSite 位置修复

> ID：11421972
> 
> 赞同：1
> 
> 时间：2012-07-10T21:08:32.767
> 
> 标签：blackberry, java-me, gps, blackberry-eclipse-plugin, blackberry-jde

我尝试使用两个线程并行使用自治和 CellSite 模式获取 GPS 纬度和经度值，但是在执行时只有一个线程处于活动状态并且我仅从中获取值，而另一个线程根本不返回任何值。

是否可以使用并行运行的多个线程检索 GPS 信息，并且我可以在屏幕上显示线程的纬度和经度值，而这些值之间的准确率较低？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T00:04:48.737

至少在不同的应用程序上下文中，当然可以在两个线程中获得修复。我从未尝试在一个应用程序中这样做。正如 Nate 暗示的那样，我想不出一个用例。

综上所述，我怀疑操作系统会满足来自一个底层线程的两个请求，这些请求满足或超过每个请求的规范。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T08:10:03.010

恕我直言，产生一个线程来检索基于 Cellsite 的位置是一种资源浪费，因为检索它只需不到一秒的时间（当 cellsite 提供程序可用时）。否则，无论您等待多长时间，它都不可用。

通常，出于定位目的，您只需要尽可能准确的修复。您可以实例化 a[`BlackBerrycriteria`](http://www.blackberry.com/developers/docs/5.0.0api/net/rim/device/api/gps/BlackBerryCriteria.html)并设置其字段以首先尝试使用 GPS 提供程序，如果不可用，则切换到 cellsite 提供程序作为后备机制。

# javascript - 使用 nodejs/express 出现意外的换行符

> ID：11421974
> 
> 赞同：2
> 
> 时间：2012-07-10T21:08:35.847
> 
> 标签：javascript, node.js, express

我正在使用 Nodejs 和 Express 完成一个示例。尝试时出现错误。

主文件的一部分：

```
 app.post('/send', express.bodyParser(), function(req, res) {
    if(req.body && req.body.tweet) {
        tweets.push(req.body.tweet);
        res.send({status:"ok",message:"Tweet received"});
    } else {
        res.send({status: "nok", message: "No tweet received"});    
    } 
```

});

部分测试脚本：

```
 var req = http.request(opts, function(res) {
res.setEncoding('utf8');

var data = "";
res.on('data', function(d) {
    data += d;  
});
res.on('end', function() {
    assert.strictEqual(data, '{"status":"ok","message":"Tweet received"}');
}); 
```

});

这是错误：

```
assert.js:104
  throw new assert.AssertionError({
        ^
AssertionError: "{\n  \"status\": \"ok\",\n  \"message\": \"Tweet received\"\n}" === "{\"status\":\"ok\",\"message\":\"Tweet received\"}"
    at IncomingMessage.<anonymous> (/home/jfb/Documents/Info/Nodejs/Up_and_Running/test.js:19:11)
    at IncomingMessage.EventEmitter.emit (events.js:115:20)
    at IncomingMessage._emitEnd (http.js:366:10)
    at HTTPParser.parserOnMessageComplete [as onMessageComplete] (http.js:149:23)
    at Socket.socketOnData [as ondata] (http.js:1356:20)
    at TCP.onread (net.js:404:27) 
```

我使用设置为显示特殊字符的编辑器检查了我的文件，并且没有如错误消息所示的换行符。

有人可以告诉我这里发生了什么。

谢谢，吉姆

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-10T21:31:56.580

您在响应中发送了一个对象，该对象被 Express 编码为实际的 JSON 字符串。显然 Express 在 JSON 字符串的格式中添加了一些缩进，这是完全有效的。您的断言测试 JSON 字符串与定义原始对象的实际 Javascript 源代码完全相同；这不是*任何JSON 编码器**都*可以保证的，因为 Express 只能看到您的对象，但永远看不到生成它的代码以及该代码中是否存在无意义的空白。在您的测试中，您实际上应该将 JSON 解码为本机对象，并将生成的对象与另一个包含您预期状态的对象进行深度比较。另一种选择是实际发送一个*字符串***而不是响应中的对象；通过这种方式，您可以控制响应的确切字符串表示，而无需依赖外部 JSON 编码。这是*非常*不灵活的，并且在测试方面没有任何好处。**

# c# - 字典trygetvalue null

> ID：11421980
> 
> 赞同：2
> 
> 时间：2012-07-10T21:09:04.310
> 
> 标签：c#, dictionary, nullreferenceexception

```
 private Dictionary<Type, Bag<Event>> events = new Dictionary<Type, Bag<Event>>();

 internal Bag<T> GetEventList<T>() where T:class
 {
    Type type = typeof(T);
    Bag<Event> b;
    if (events.TryGetValue(type, out b))
    {
        return b as Bag<T>;
    }
    else {
        b = new Bag<T>() as Bag<Event>;
        events[type] = b;
        return b as Bag<T>;
    }
}

internal void AddEvent<T>(T ev) where T:class,Event
{
    Type type = typeof(T);
    Bag<Event> b;
    if (events.TryGetValue(type, out b))
    {
        b.Add(ev); // <= NullReferenceException, b is null
    }
    else {
        b = new Bag<T>() as Bag<Event>;
        events.Add(type, b);
        b.Add(ev);
    }
} 
```

我总是在 AddEvent 中得到 NullReferenceException。事件字典仅在这两个函数中使用，我不知道为什么值为空......我没有在任何地方插入空值！

我在这里疯了...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-10T21:13:46.170

可能的罪魁祸首是这一行：

```
b = new Bag<T>() as Bag<Event>; 
```

演员表`as`可能失败，这将分配`null`给`b`.

我的猜测是，您使用的子类`Event`作为.`T``Bag<T>``b``null`

**更新**：根据下面的评论，问题确实是`as`演员。要解决问题，只需创建一个`new Bag<Event>()`，不需要强制转换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T21:23:03.230

`NullReferenceException``Bag<T>`无法施放时被抛出`Bag<Event>`

如果您将签名更改为`internal void AddEvent<T>(Event ev) where T : class`异常将关闭

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-10T21:13:47.800

某处空值与键类型相关联。

单步调试器中的代码并在`NullReferenceException`抛出 之前检查字典的状态。

# android - 在 Android 中尝试多线程时为什么会收到处理程序警告？

> ID：11421981
> 
> 赞同：0
> 
> 时间：2012-07-10T21:09:06.007
> 
> 标签：android, static, warnings, handler

所以我正在处理一个活动，因为我想放入一个加载屏幕

当它进入加载屏幕时，应用程序首先检查用户是否已登录，以及他们是否不是错误屏幕加载。

在线程的末尾，我只有

```
handler.sendEmptyMessage(0); 
```

对于处理程序，我有

```
private Handler handler = new Handler() {
    @Override
    public void handleMessage(Message msg) {
        dataAdapter.notifyDataSetChanged();
        pd.dismiss();
        if (badkey==1)
        {
            reloginDlog().show();
        }
    }
    }; 
```

pd 是一个进度对话框，而 badkey 是一个公共 int。

我在私有 Handler 行中收到一条警告，上面写着“这个 Handler 类应该是静态的，否则可能会发生泄漏 (MyActivity.1)”

那么有谁知道为什么这很糟糕以及我该如何解决它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T21:19:08.503

尝试类似的事情：（与处理程序相关联的线程应该具有初始化的消息循环 -`Looper.prepare()`并且`.loop()`）：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    new Thread(new Runnable() {

        @Override
        public void run() {

            Looper.prepare();

            handler = new Handler() {

                public void handleMessage(Message msg) {

                    // process incoming messages here
                    //...

                    //destroy message cue when no longer needed 
                    if(noMoreMessagesToHandle) {

                        Looper.myLooper().quit();
                    }
                }
            };

            Looper.loop();

        }

    }).start(); 
```

# javascript - 在Javascript中向Array对象添加方法？

> ID：11421986
> 
> 赞同：17
> 
> 时间：2012-07-10T21:09:23.653
> 
> 标签：javascript

是否可以在 javascript 中向 array() 添加方法？（我知道原型，但我不想为每个数组添加一个方法，特别是一个）。

我想这样做的原因是因为我有以下代码

```
function drawChart()
{
    //...
    return [list of important vars]
}

function updateChart(importantVars)
{
    //...
}

var importantVars = drawChart();

updateChart(importantVars); 
```

我希望能够做这样的事情：

```
var chart = drawChart();<br>
chart.redraw(); 
```

我希望有一种方法可以将方法附加到我要返回的内容上`drawChart()`。有什么办法吗？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-07-10T21:13:02.707

数组是对象，因此可以保存诸如方法之类的属性：

```
var arr = [];
arr.methodName = function() { alert("Array method."); } 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-10T21:12:21.130

是的，很容易做到：

```
array = [];
array.foo = function(){console.log("in foo")}
array.foo();  //logs in foo 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-10T21:11:59.540

只需实例化数组，创建一个新属性，然后为该属性分配一个新的匿名函数。

```
var someArray = [];
var someArray.someMethod = function(){
    alert("Hello World!");
}

someArray.someMethod(); // should alert 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-07-10T21:26:15.823

```
function drawChart(){
{
    //...
    var importantVars = [list of important variables];
    importantVars.redraw = function(){
        //Put code from updateChart function here using "this"
        //in place of importantVars
    }
    return importantVars;
} 
```

这样做可以使您在收到该方法后直接访问该方法。
IE

```
var chart = drawChart();
chart.redraw(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-03-03T10:06:02.353

```
var arr = [];
arr.methodName = function () {return 30;}
alert(arr.methodName); 
```

# asp.net - 如何让 jQuery.Ajax 使用 ASP.NET MVC 执行带有重定向的普通 POST

> ID：11421987
> 
> 赞同：3
> 
> 时间：2012-07-10T21:09:37.930
> 
> 标签：asp.net, asp.net-mvc-3, jquery

我目前在我的页面上有一个 JSON 对象，它随着用户向其中添加项目而构建。这一切都是在 JavaScript/jQuery 中完成的。

当用户完成添加项目时，我想将此对象发布到控制器操作并让操作返回使用此数据的强类型视图。

目前，我有 jQuery.ajax POST 发送这个 JSON 对象到一个动作方法，然后将这个对象绑定到我的强类型模型。问题是，我实际上希望这个 jQuery.ajax POST 重定向，就好像 JSON 对象在一个 FORM 中并且只是被提交一样。

我也不能使用 jQuery.post() 方法，它会根据需要重定向，因为我需要能够将 contentType 设置为“application/json”，这样我的绑定才能正常工作。不幸的是，jQuery.post() 方法不允许您设置此参数。

我读过 jQuery.post() 方法基本上使用 jQuery.ajax() 方法，所以我一直在努力让 jQuery.ajax() 方法重定向。

我还读到我可以为所有 jQuery.ajax() 方法设置默认的 contentType，这将允许我使用 jQuery.post() 方法，但如果可能的话想尽量避免这种情况。

谢谢

**编辑：更新了 Saedeas 的建议：**

我在“索引”视图上的 JavaScript：

```
<script language="javascript" type="text/javascript">

    //  Initialize the Shopping Cart object
    var m_ShoppingCart = {
        UserId: 10,
        DeliveryInstructions: "Leave at front desk",
        CartItems: []
    };

    $(document).ready(function () {
        $.extend({
            postJSON: function (url, data, callback) {
                return $.ajax({
                    type: "POST",
                    url: url,
                    data: JSON.stringify(data),
                    success: callback,
                    dataType: "json",
                    contentType: "application/json",
                    processData: false
                });
            }
        });
    });

    function PostDataWithRedirect() {
        var url = '@Url.Action("ConfirmOrder", "Store")';
                $.postJSON(url, m_ShoppingCart, function () { });
    }

    function AddToCart(id, itemName, price, quantity) {

        //  Add the item to the shopping cart object
        m_ShoppingCart.CartItems.push({
            "Id": id,
            "ItemName": itemName,
            "Price": price.toFixed(2), //   Issue here if you don't specify the decimal     place
            "Quantity": quantity
        });

        //  Render the shopping cart object
        RenderShoppingCart();
    }

    function RenderShoppingCart() {

        $("#CartItemList").html("");

        var totalAmount = 0;

        $.each(m_ShoppingCart.CartItems, function (index, cartItem) {

            var itemTotal = Number(cartItem.Price) * Number(cartItem.Quantity);
            totalAmount += itemTotal;

            $("#CartItemList").append("<li>" + cartItem.ItemName + " - $" +     itemTotal.toFixed(2) + "</li>");
        });

        $("#TotalAmount").html("$" + totalAmount.toFixed(2));
    }
</script> 
```

然后是控制器动作“ConfirmOrder”

```
[HttpPost]
public ActionResult ConfirmOrder(ShoppingCartModel model)
{
    return View(model);
} 
```

因此，当调用 PostDataWithRedirect() JavaScript 方法时，它必须命中 ConfirmOrder 控制器操作并重定向到 ConfirmOrder 视图。我的 Index 视图上的 Shopping Cart 对象完全是用 JavaScript 构建的，然后用户单击“Proceed to Checkout”按钮并被重定向等。

PS：我的完整工作示例可以在文章 [[如何在 MVC 中发布 JSON 对象](http://www.webcognoscere.com/post/2012/07/03/How-to-POST-a-JSON-object-to-a-Controller-Action.aspx)] 中找到，我只需要更新此代码，以便它可以执行发布和重定向，如上所述

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-10T21:14:01.373

在success方法中，做一个`location.href = "TARGET LOCATION"`使页面转到`TARGET LOCATION`。

```
$.ajax({
    url: myurl,data,
    data: myData,
    // processData: false, // you may need this option depending on service setup
    success: function(){
        location.href = "TARGET LOCATION";
    },
    type: "POST",
    contentType: "application/json"
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-13T19:21:27.227

返回一个重定向的视图：

控制器

```
return View("redirectionView"); 
```

看法

```
RedirectionView.cshtml
@{
Layout = null;
}

<script type="text/javascript">
  alert("Success! Redirecting...");
  window.location = "./";
</script> 
```

**编辑**

为了适应数据保留，请使用 tempdata。

控制器

```
TempData["collectedUserData"] = collectedData;
return View("redirectionView"); 
```

重定向视图.cshtml

```
@{
Layout = null;
}

<script type="text/javascript">
 alert("Success! Redirecting...");
 window.location = "./Rebuilder/ActionMethod";
</script> 
```

控制器重建器

```
public ActionResult ActionMethod()
{
 if( TempData.ContainsKey("collectedUserData") )
 {
  var collectedData = TempData["collectedUserData"];
 }
 //todo: use else clause to catch data not present
         use collectedData to build new view
 return View();
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-13T15:05:41.400

也许我没有关注这个问题，但为什么经典帖子、重定向、获取模式不起作用？

```
[HttpGet]
public ActionResult WhateverActionName()
{
    YourViewModel yvm = new YourViewModel();
    //Initalize viewmodel here
    Return view(yvm);
}

[HttpPost]
public ActionResult WhateverActionName(YourViewModel yvm)
{
    if (ModelState.IsValid) {
        RedirectToAction("OtherAction", "OtherController")
    }
    return View(yvm);
} 
```

您的意思是您想要发布一个帖子，将其绑定到视图模型以在一个控制器中进行验证，然后将该控制器发布到另一个验证所有内容的控制器？如果是这样，我建议查看此代码以在 c# [http://geekswithblogs.net/rakker/archive/2006/04/21/76044.aspx](http://geekswithblogs.net/rakker/archive/2006/04/21/76044.aspx)中发布。

编辑：或者，如果其他控制器操作并不真正需要发布，您可以将数据放在 tempdata 对象中。

编辑 2：等等，问题是如何用 jquery 发帖？如果是这样的话，

```
$("#YourForm").submit(function () {
        $.post('@Url.Action("WhateverActionName", "YourController")';
    });
}); 
```

注意：可能是小的语法错误，但接近。@Url.Action 是重要的部分。

编辑 3：这应该终于可以工作了。

```
jQuery.extend({
    postJSON: function(url, data, callback) {
      return jQuery.ajax({
        type: "POST",
        url: url,
        data: JSON.stringify(data),
        success: callback,
        dataType: "json",
        contentType: "application/json",
        processData: false
      });
    }
  }); 
```

在您看来将其称为

```
$.postJSON('@URL.Action("Action", "Controller")', yourJson, callback) 
```

然后在控制器内部重定向。

# ios - 设置从数组中选择的按钮的标题 - Xcode iOS

> ID：11421990
> 
> 赞同：1
> 
> 时间：2012-07-10T21:09:55.180
> 
> 标签：ios, xcode, arrays, button, title

我有很多按钮，我想在加载视图时给它们一个标题。按钮的标题根据月份中的哪一天而有所不同。因此，我创建了一个包含所有按钮名称的数组。我的代码如下：

**我的界面：**

```
@property (strong, nonatomic) IBOutlet UIButton *button1;
@property (strong, nonatomic) IBOutlet UIButton *button2;
@property (strong, nonatomic) IBOutlet UIButton *button3;
@property (strong, nonatomic) IBOutlet UIButton *button4;
@property (strong, nonatomic) IBOutlet UIButton *button5;
@property (strong, nonatomic) IBOutlet UIButton *button6;
@property (strong, nonatomic) IBOutlet UIButton *button7;
@property (strong, nonatomic) IBOutlet UIButton *button8;
@property (strong, nonatomic) IBOutlet UIButton *button9;
@property (strong, nonatomic) IBOutlet UIButton *button10; 
```

**我的实现：**

```
@synthesize button1 = _button1;
@synthesize button2 = _button2;
@synthesize button3 = _button3;
@synthesize button4 = _button4;
@synthesize button5 = _button5;
@synthesize button6 = _button6;
@synthesize button7 = _button7;
@synthesize button8 = _button8;
@synthesize button9 = _button9;
@synthesize button10 = _button10;

NSArray *myArray = [NSArray arrayWithObjects: @"dummyButton", @"_button1", @"_button2", @"_button3", @"_button4", @"_button5", @"_button6", @"_button7", @"_button8", @"_button9", @"_button10", nil];

for (int i = varDefinedEarlier; i<=totalAmountOfNeededTitles; i++) {
     NSString *theTitleSting = [NSString stringWithFormat:@"%i",i];
     NSLog(@"arrayValue:%@", [myArray objectAtIndex:i]); //Works prints the button name (for example _button7)

    [[myArray objectAtIndex:i] setTitle:theTitleSting forState:UIControlStateNormal];
//The line above is where the app crashes. Everything else works just fine.
} 
```

提供给我的错误是“线程 1：信号 SIGABRT

除此之外，这就是日志所说的：

> -[__NSCFConstantString setTitle:forState:]：无法识别的选择器发送到实例 0x14a48 2012-07-10 22:57:49.649 不要破坏链 [10302:707] * * * 由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因： ' - [__ NSCFConstantString的setTitle：forState：]：发送到实例0x14a48无法识别选择' * * *第一掷调用堆栈：（0x3774788f 0x3544c259 0x3774aa9b 0x37749915 0x376a4650 0xdc2f 0x31454c8b 0x314611e9 0x31461059 0x31460f3f 0x3146070b 0x31460503 0x31454aff 0x314547d5 0x314cd903 0x31547627 0x37fb8933 0x3771ba33 0x3771b699 0x3771a26f 0x3769d4a5 0x3769d36d 0x33e5c439 0x31449cd5 0xb7cf 0xb774）终止调用抛出异常（lldb）

我认为错误是我试图告诉应用程序女巫按钮它需要设置标题的方式，但我无法真正弄清楚如何让它接受我的数组的值并将其用作按钮名称。

我是 iPhone iOS 开发的新手，如果答案很简单，请耐心等待；）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-10T21:14:59.657

您没有引用按钮实例，而是引用该数组中的一些字符串。现在在您的循环中，您尝试在那些不存在 NSString 实例的字符串上调用 setTitle:forState: 方法。

尝试以下操作：

```
NSArray *myArray = [NSArray arrayWithObjects:_button1, _button2, _button3, _button4, _button5, _button6, _button7, _button8, _button9, _button10, nil]; 
```

这将按预期将实际按钮实例放入您的数组中，并且您的代码应该可以正常工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-10T21:15:26.733

你应该做类似的事情`[myButton setTitle:[myArray objectAtIndex:i] forState: UIControlStateNormal]`

目前，您正在将 setTitle 消息传递给字符串类型，这当然会导致崩溃……希望对您有所帮助

# android - 我是否需要学习如何构建 Web 服务才能获得 iOS / Android 开发人员工作？

> ID：11421993
> 
> 赞同：0
> 
> 时间：2012-07-10T21:10:04.137
> 
> 标签：android, ios, ios5

我知道每个 iOS 工作都是不同的。但是，如果您是 iOS/Android 开发人员，您是否曾经必须处理创建 Web 服务或团队中的其他人负责处理它？

我知道从 iOS 应用程序调用 Web 服务的方法，但我对创建 Web 服务一无所知。我只是想知道这是否是获得 iOS 开发人员工作的障碍。

很抱歉问了这么一个含糊不清的问题，但我只是对获得 iOS 开发人员工作所需的所有技能感到不知所措。我以后会避免问这样的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-10T21:18:10.870

这真的取决于规模，但我想说不是初创公司的公司应该有自己的网络服务团队。这也取决于公司是仅 iOS 还是他们是否拥有已经使用 API 的 web/android/其他产品。

您绝对应该在这里查看 Ray Wenderlich 关于 Web 服务的教程： [http ://www.raywenderlich.com/2941/how-to-write-a-simple-phpmysql-web-service-for-an-ios-app](http://www.raywenderlich.com/2941/how-to-write-a-simple-phpmysql-web-service-for-an-ios-app)

他今天还发布了一个关于创建类似网络服务的 instagram 的新教程。

大多数公司不会使用 PHP 作为他们的服务，所以要熟悉不同的语言，最常见的是：java、python 和 ruby​​。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-10T21:29:07.547

在当今的软件开发环境中，我发现无论是作为雇员还是雇主，机会和报酬都属于具有广泛专业知识的人。广度并不一定意味着深度有限——专注于你认为最有趣（和最有利可图）的领域，但始终保持你的眼睛和耳朵对新技术和“下一个立方体中的人”正在做什么保持开放。

您不必学习*如何*编写 Web 服务来使用它（毕竟它是一项服务），但学习如何编写它们将有助于您使用服务并让您在市场。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-10T21:44:37.627

如果您可以编程 iOS，您可以使用 PHP 或创建 Web 服务所需的任何其他 Web 语言进行编程。

今天，“Web 服务”一词有点误导。它曾经意味着您使用 SOAP 来实现它。但通常今天，Web 服务是返回您的应用程序（或某些应用程序）知道如何解析/理解的结果的任何网页。

现在很多人都在使用 JSON 作为 Web 服务的“有效负载”，因此学习如何从 iOS 发送 JSON 并解析 JSON 结果可能会有所帮助。然后您可以学习在 PHP 中解析 JSON 请求并创建 JSON 结果的基础知识。

要回答您的问题，至少能够从 iOS 调用 Web 服务（并处理响应）至关重要。我还要说，为了证明你可以做到这一点，你应该能够创建一个基本的 PHP 页面来充当你的 Web 服务的服务器。用 PHP 做一个简单的 hello world web 服务并从 iOS 调用它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-10T21:13:56.007

您不需要知道如何在专家级别创建它们，但您需要知道如何使用它们。创建应用程序时，您将与 Web 服务交互，并且根据您创建的应用程序的类型，可能需要开发 Web 服务。了解它们不会损害您的机会，但可能不是必需的。这完全取决于公司的结构。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-10T21:44:47.017

除了游戏之外，大多数应用程序都在从网络上下载内容。您当然需要知道如何使用这些服务。一般来说，如果你也知道如何编写后端，你会更好地使用它们。

最重要的是，您希望应用程序中的逻辑尽可能少。将所有逻辑推送到后端。要有效地做到这一点，您需要同时在前端和后端工作，而不是事先构建 API。我会遵循[REST in Practice](http://restinpractice.com/book/)书中概述的 REST 原则。

# python - 在python中，下划线参数在函数中的含义

> ID：11421997
> 
> 赞同：15
> 
> 时间：2012-07-10T21:10:20.900
> 
> 标签：python

例如，我读了一段代码：

```
def parse_doc(self, _, doc): 
```

下划线“_”是什么意思？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-07-10T21:11:49.457

它通常是我们不关心的变量的占位符。例如，如果您有一个`for`-loop 并且您不关心索引的值，则可以执行类似的操作

```
for _ in xrange(10):
   print "hello World." # just want the message 10 times, no need for index val 
```

另一个例子，如果一个函数返回一个元组，而你不关心你可以用来`_`明确这一点的值之一。例如，

```
val, _ = funky_func() # "ignore" one of the return values 
```

* * *

***在旁边***

与 OP 问题中的使用无关`'_'`，但仍然整洁/有用。在 Python shell 中，`'_'`将包含最后一次操作的结果。例如，

```
>>> 55+4
59
>>> _
59
>>> 3 * _
177
>>> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-10T21:11:40.820

就像`doc`它是一个变量名。通常命名一个变量`_`表示它不会被使用。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-10T21:13:53.137

`_`是 python 中的有效变量名。但它主要用于[i18n](https://stackoverflow.com/questions/2964244/django-meaning-of-leading-underscore-in-list-of-tuples-used-to-define-choice-fi)，因此最好不要将其用于其他目的。