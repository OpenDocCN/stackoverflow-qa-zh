# StackOverflow 问答 000941000-000941999

# asp.net - 向 addhandler 发送参数？

> ID：941000
> 
> 赞同：1
> 
> 时间：2009-06-02T17:57:40.143
> 
> 标签：asp.net, vb.net, delegates, addhandler

我在以编程方式创建的网格中有一个按钮。该按钮使用该按钮所在的网格的隐藏列中的数据来编辑表中的一些数据。通常我使用按钮的 javascript onclientclick 将行数据发送到隐藏字段，然后使用该隐藏字段对数据库进行更改。但是必须有一种方法可以向按钮的 addhandler 发送参数。这是我必须澄清的代码....

```
Dim btnedit As New ImageButton
    AddHandler btnedit.Click, AddressOf btnedit_Click
    btnedit.ImageUrl = "\images\bttnEditMini.gif"

If e.Row.RowType <> DataControlRowType.Header And e.Row.RowType <> DataControlRowType.Footer Then
        e.Row.Cells(3).Controls.Add(btnedit)
End If 
```

这是我的 Addhandler 及其代表：

```
Public Delegate Sub ImageClickEventHandler(ByVal sender As Object, ByVal e As ImageClickEventArgs)
Sub btnedit_Click(ByVal sender As Object, ByVal e As ImageClickEventArgs)
//programming stuff
End Sub 
```

我如何向这个处理程序发送一个参数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T18:52:08.207

按照惯例，所有事件处理程序都接受两个参数：发送者和 EventArgs。如果您需要向侦听器发送自定义信息，请创建一个继承自 EventArgs 并包含您需要进行通信的信息的新类。

查看[CodeProject 上的这篇文章](http://www.codeproject.com/KB/vb/StepByStepEventsInVBNET.aspx)，向您展示如何执行此操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T18:09:16.740

简短的回答：没有。你会把它寄到哪里？你有两个参数。

更长的答案：*sender*是发送事件的控件。在这种情况下，它将是您的 btnEdit 控件。也许这会对你有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T21:17:42.017

因为它在网格中，所以我只使用了 row 命令。当使用 Row 命令时，您可以向其发送命令名和命令参数。我将我的参数作为参数传递。

```
 GridView1.Rows(i).Cells(3).Controls.Add(btndel)
            btndel.ImageUrl = "\images\bttnDelete.gif"
            btndel.ToolTip = "This will delete the Selected Assignment"
            btndel.CommandName = "destroy"
            btndel.CommandArgument = GridView1.Rows(i).Cells(0).Text
            btndel.Attributes.Add("onclick", "javascript: if(confirm('Are you sure you want to delete this Department Cost Days Assignment?')==false) return false;") 
```

这是行命令：

```
Protected Sub GridView1_RowCommand(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewCommandEventArgs) Handles GridView1.RowCommand
    If e.CommandName = "destroy" Then 'used destroy because Delete command was prohibited.
       Call Connection()
        Dbcmd.CommandText = "Delete from table where condition = '" & e.CommandArgument & "'"
        Dbcmd.ExecuteNonQuery()
        Dbconn.Close()
        Dbconn.Dispose()
    End If 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T18:15:46.357

如果您不想使用“默认”/已定义的参数，您可以创建自己的事件。

# c# - 如何从 AD DirectoryEntry 获取 DOMAIN\USER？

> ID：941002
> 
> 赞同：16
> 
> 时间：2009-06-02T17:57:52.407
> 
> 标签：c#, .net, active-directory

如何从 Active Directory DirectoryEntry (SchemaClassName="user") 对象中获取 Windows 用户和域？

用户名在 sAMAccountName 属性中，但我在哪里可以查找域名？

（我不能假设一个固定的域名，因为用户来自不同的子域。）

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-06-04T20:06:02.207

这假定它`results`是从 DirectorySearcher 获得的 SearchResultCollection，但您应该能够直接从 DirectoryEntry 获得 objectid。

```
SearchResult result = results[0];
var propertyValues = result.Properties["objectsid"];
var objectsid = (byte[])propertyValues[0];

var sid = new SecurityIdentifier(objectsid, 0);

var account = sid.Translate(typeof(NTAccount));
account.ToString(); // This give the DOMAIN\User format for the account 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-02T20:27:34.053

不幸的是，您不会在 DirectoryEntry 中找到您要查找的内容。

你有`sAMAccountName`which 通常类似于`myuser`（没有域）。你有`distinguishedName`类似的东西`LDAP://cn=joe myuser,cn=Users,dc=yourCompany,dc=com`。你也有一个`userPrincipalName`，但它通常是一个格式为`joeUser@mycompany.com`.

`domain\MyUser`但不幸的是，您找不到任何包含 的属性。您必须将有关域名的信息和 DirectoryEntry 的 sAMAccountName 放在一起。

有关 System.DirectoryServices 中所有 LDAP 和 WinNT 属性的更多信息和一些出色的 Excel 表，请查看 ADSI MVP Richard Mueller 的[Hilltop Lab](http://www.rlmueller.net)网站。

马克

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2010-02-23T14:36:21.203

要获取 DirectoryEntry 域名，您可以在 `directoryEntry.Parent`. 然后如果`directoryEntry.SchemaClassName == "domainDNS"` 你能得到这样的域名：

```
directoryEntry.Properties["Name"].Value 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-03T12:19:32.163

我在 CN=Partitions,CN=Configuration 中找到了一个包含所有域的分区容器。

当您将用户与分区匹配时，您可以从 nETBIOSName+"\"+sAMAccountName 属性中读取真实域名。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-03-22T11:15:17.327

```
public static string GetDomainNameUserNameFromUPN(string strUPN)
{

    try
    {
        WindowsIdentity wi = new WindowsIdentity(strUPN);
        WindowsPrincipal wp = new WindowsPrincipal(wi);

       return wp.Identity.Name;

    }
    catch (Exception ex)
    {

    }

    return "";
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-02T20:08:07.570

如果您使用[System.DirectoryServices](http://msdn.microsoft.com/en-us/library/system.directoryservices.aspx)库，您应该有一个来自 DirectorySearcher 的 SearchResultsCollection。

在每个 SearchResult 的 Properties 集合中，都有一个“distinguishedname”属性。这将包含构成您的目录条目所属域的所有 DC 部分。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-04-21T13:51:07.820

我正在扩展@laktak 先前的答案，以提供他的意思的详细信息。

有一个分区容器，`CN=Partitions,CN=Configuration`其中包含所有域，它为您提供`cn`Netbios 域名和包含用户在此域中时将拥有`nCName`的前缀的属性。`distinguishedName`

因此，首先在 ldap 中搜索`(objectClass=*)`in`CN=Partitions,CN=Configuration`并将每个结果的 ( `cn`, `nCName`) 对存储到地图中。

接下来，您使用 ldap 查询`(sAMAccountName=USERIDHERE)`并`distinguishedName`从用户那里获取。现在浏览 ( `cn`, `nCName`) 对并从用户那里找到`nCName`前缀`distinguishedName`, 对应`cn`的是您想要的域名。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-03-19T14:21:08.273

我为自己的使用编写了这段代码（在 VB.net 中，易于翻译）：

```
 <System.Runtime.CompilerServices.Extension()>
Public Function GetDomainFQDN(ByVal Entry As DirectoryServices.DirectoryEntry) As String

    Try

        While Entry.SchemaClassName <> "domainDNS"
            Entry = Entry.Parent
        End While

        Dim DN As String = Entry.Properties("DistinguishedName").Value
        Return DN.Replace("DC=", "").Replace(",", ".")

    Catch ex As Exception
        Debug.WriteLine(ex.ToString)
        Return String.Empty
    End Try

End Function

<System.Runtime.CompilerServices.Extension()>
Public Function GetDomainNetbiosName(ByVal Entry As DirectoryServices.DirectoryEntry) As String

    Try

        While Entry.SchemaClassName <> "domainDNS"
            Entry = Entry.Parent
        End While

        Return Entry.Properties("Name").Value

    Catch ex As Exception
        Debug.WriteLine(ex.ToString)
        Return String.Empty
    End Try

End Function 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-10-29T12:28:42.670

我觉得有义务添加我的答案，该答案的灵感来自[Nicholas DiPiazza 的答案](https://stackoverflow.com/a/43544510/4137016)。希望这个**PowerShell**代码对某人有所帮助！

```
$hash = @{} //this contains the map of CN and nCNAME
$Filter = '(nETBIOSName=*)'
$RootOU = "CN=Partitions,CN=Configuration,DC=DOMAIN,DC=LOCAL" //Change this to your org's domain
$Searcher = New-Object DirectoryServices.DirectorySearcher
$Searcher.SearchScope = "subtree"
$Searcher.Filter = $Filter
$Searcher.SearchRoot = New-Object System.DirectoryServices.DirectoryEntry("LDAP://$($RootOU)")
$Searcher.FindAll()|sort | foreach { $hash[($_.Properties.ncname).Trim()] = ($_.Properties.cn).Trim() }
$hash.GetEnumerator() | sort -Property Value 
```

如果用户详细信息在 中可用`$userDetails`，那么您可以通过以下方式获得正确的域：

```
$hash[[regex]::Match($userDetails.DistinguishedName, 'DC=.*').Value] 
```

最终的用户名如下所示：

```
$hash[[regex]::Match($userDetails.DistinguishedName, 'DC=.*').Value] + "\" + $userDetails.SamAccountName 
```

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2013-03-22T08:37:50.380

1) 您可以从 DirectoryEntry 中获取 userPrincipalName。

2) 然后，在用户名和域名之间拆分 UPN。

3) 然后调用 GetNetBIOSName() 就可以了。

```
 public static DirectoryEntry GetDirectoryObject(string strPath)
        {
            if (strPath == "")
            {
                strPath = ConfigurationManager.AppSettings["LDAPPath"]; //YOUR DEFAULT LDAP PATH ie. LDAP://YourDomainServer
            }

            string username = ConfigurationManager.AppSettings["LDAPAccount"];
            string password = ConfigurationManager.AppSettings["LDAPPassword"];
                //You can encrypt and decrypt your password settings in web.config, but for the sake of simplicity, I've excluded the encryption code from this listing.

}
            catch (Exception ex)
            {
                HttpContext.Current.Response.Write("user: " + username + ", LDAPAccount: "+ ConfigurationManager.AppSettings["LDAPAccount"] + ".<br /> "+ ex.Message +"<br />");

                if (HttpContext.Current.User.Identity != null)
                {

                    HttpContext.Current.Response.Write("HttpContext.Current.User.Identity: " + HttpContext.Current.User.Identity.Name + ", " + HttpContext.Current.User.Identity.IsAuthenticated.ToString() + "<br />");

                    HttpContext.Current.Response.Write("Windows Identity: " + WindowsIdentity.GetCurrent().Name + ", " + HttpContext.Current.User.Identity.IsAuthenticated.ToString());

                }
                else
                {
                    HttpContext.Current.Response.Write("User.Identity is null.");
                }

                HttpContext.Current.Response.End();

            }

            DirectoryEntry oDE = new DirectoryEntry(strPath, username, password, AuthenticationTypes.Secure);
            return oDE;
        }

 public static string GetNetBIOSName(string DomainName)
 {

     string netBIOSName = "";
     DirectoryEntry rootDSE =GetDirectoryObject(
         "LDAP://"+DomainName+"/rootDSE");

     string domain = (string)rootDSE.Properties[
         "defaultNamingContext"][0];

      //   netBIOSName += "Naming Context: " + domain + "<br />";

    if (!String.IsNullOrEmpty(domain))
     {

          //This code assumes you have a directory entry at the /CN=Partitions, CN=Configuration
          //It will not work if you do not have this entry.

         DirectoryEntry parts = GetDirectoryObject(
             "LDAP://"+DomainName+"/CN=Partitions, CN=Configuration," + domain);

            foreach (DirectoryEntry part in parts.Children)
         {

             if ((string)part.Properties[
                 "nCName"][0] == domain)
             {
                 netBIOSName +=  (string)part.Properties[
                     "NetBIOSName"][0];
                 break;
             }
         }

     } 
        return netBIOSName;
 }

    public static string GetDomainUsernameFromUPN(string strUPN)
{
string DomainName;
string UserName;
  if (strUPN.Contains("@"))
        {
            string[] ud = strUPN.Split('@');
            strUPN= ud[0];
            DomainName = ud[1];

            DomainName=LDAPToolKit.GetNetBIOSName(DomainName);

            UserName= DomainName + "\\" + strUPN;
        }
        else
        {
            UserName= strUPN;
        }

    return UserName;
} 
```

# apache - Apache URL 重写，

> ID：941010
> 
> 赞同：2
> 
> 时间：2009-06-02T17:58:42.937
> 
> 标签：apache, .htaccess, url-rewriting

我正在尝试让 URL 重写在我的网站上工作。这是我的 .htaccess 的内容：

```
RewriteEngine On
RewriteRule ^blog/?$ index.php?page=blog [L]
RewriteRule ^about/?$ index.php?page=about [L]
RewriteRule ^portfolio/?$ index.php?page=portfolio [L]
#RewriteRule ^.*$ index.php?page=blog [L] 
```

现在 3 个未注释的重写规则完美运行，如果我尝试[http://www.mysite.com/blog/](http://www.mysite.com/blog/)，我会被重定向到[http://www.mysite.com/index.php?page=blog](http://www.mysite.com/index.php?page=blog)，同样适用“关于”和“投资组合”。但是，如果我输入错误的博客，比如说我尝试[http://www.mysite.com/bloh/](http://www.mysite.com/bloh/)，那么显然我会收到 404 错误。评论中的最后一条规则是为了帮助防止这种情况发生。任何 URL 都应该被重定向到博客，但当然，即使我们成功使用了前一个规则，这条规则仍然会被解析，所以我使用了“last”标志 ([L])。如果我取消注释我的最后一条规则，任何内容，包括博客、关于和投资组合，都会重定向到博客。“最后一个”标志不应该在找到匹配规则后立即停止执行吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T18:05:57.260

是的，最后一个标志意味着它不会*在此请求中*应用遵循此规则的任何规则。

重写 URL 后，它使用新重写的 URL 发出一个内部请求，该 URL 将与您的最后一个匹配`RewriteRule`，因此您的重定向进入无限循环。

使用[RewriteCond](http://httpd.apache.org/docs/2.3/mod/mod_rewrite.html#rewritecond)指令将重写限制为不以 开头的 URL，`index.php`您应该没问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T18:39:00.887

您可以添加如下条件：

```
RewriteCond %{REQUEST_URI} !^index\.php 
```

我还要提到 using`RewriteRule ^.*$`也是一种破坏所有媒体请求（css、js、图像）的好方法。您可能需要添加一些条件，例如：

```
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f 
```

确保您没有尝试重写服务器上存在的*实际文件或目录。*否则它们将无法访问，除非 index.php 也提供这些服务！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T18:08:09.160

来自 apache 的[mod_rewrite 文档](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html#rewriterule)

> 'last|L'（最后一条规则）在此处停止重写过程，不再应用任何重写规则。这对应于 Perl 的 last 命令或 C 中的 break 命令。使用此标志来防止当前重写的 URL 被以下规则进一步重写。 *但是请记住，如果 RewriteRule 生成内部重定向（在每个目录上下文中重写时经常发生），这将重新注入请求并导致从第一个 RewriteRule 开始重复处理。*

你可以使用

```
 ErrorDocument 404 /index.php?page=blog 
```

但是您应该知道它不返回 404 错误代码，而是重定向一个这一事实，我不知道这是否是一个很好的做法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T05:52:06.047

在您停止处理请求后，整个处理过程会再次针对新的（重写的）URL 运行。**您可以通过在其他规则之前**使用它来摆脱该循环：

```
RewriteRule ^index.php - [L] 
```

这意味着“对于 index.php，不要重写并离开处理。”

# c# - What is REST?

> ID：941016
> 
> 赞同：14
> 
> 时间：2009-06-02T18:01:16.020
> 
> 标签：c#, .net, wcf, rest

> **Possible Duplicate:**
> [What am I not understanding about REST?](https://stackoverflow.com/questions/343288/what-am-i-not-understanding-about-rest)

What is REST? How does it relate to WCF? I have been asked to look into RESTful implementation of services. Can you please point me to links that would be helpful for beginners.

I am a .NET developer with a decent knowledge of ASP.NET

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-02T18:04:15.627

REpresentational State Transfer

It is basically the HTTP protocol, which was originally created to allow representational state transfer, not just transfer of web pages. HTTP is most commonly used to GET content and POST data. But it can also be used to PUT and DELETE data, as well as get HEADer information, etc.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-02T18:14:42.503

A resource lots of people are reffering to when talking about REST is "[How I explained REST to my wife](http://tomayko.com/writings/rest-to-my-wife)" altough it's some sort of general overview and not related to WCF.

There is also [Restful.NET](https://rads.stackoverflow.com/amzn/click/com/0596519206) by Jon Flanders which is quite good as far as I know (haven't read it myself :() and it's examples are based on WCF.

With best regards.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-02T18:03:09.807

Whole [section of MSDN](http://msdn.microsoft.com/en-us/netframework/cc950529.aspx) dedicated to just this.

This [blog post](http://weblogs.asp.net/shijuvarghese/archive/2008/04/04/rest-and-wcf-3-5.aspx) by Shiju Varghese also gives a pretty decent beginner overview.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-02T18:08:02.607

[Here](http://blogs.msdn.com/bags/archive/2008/08/05/rest-in-wcf-blog-series-index.aspx) is a link that I used to get up to speed on REST and WCF

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-02T18:23:13.877

我发现这篇文章有助于说明基础知识：
[如何喝杯咖啡 (InfoQ)](http://www.infoq.com/articles/webber-rest-workflow)

它提供了 HTTP 请求和响应的示例、它们的外观以及它们如何应用于以业务为中心的实际操作。下订单时 REST 消息是什么样的？更新订单？正在寻找订单？等等

它不基于任何编程语言或 API（我不认为 HTTP 是 API）。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-06-02T18:05:17.370

Maybe... [this](http://en.wikipedia.org/wiki/Representational_State_Transfer) ? (REST on Wikipedia)

# apache-flex - Flex HTTPService Resultformat

> ID：941026
> 
> 赞同：0
> 
> 时间：2009-06-02T18:04:02.100
> 
> 标签：apache-flex

What is the real difference between these resultformats for HTTPService in Flex :

```
text
object
xml
e4x 
```

Especially, the last three seem pretty close to each other by their description.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-11-07T05:03:45.103

来自 HTTPService 的手册：

[http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/mx/rpc/http/HTTPService.html#resultFormat](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/mx/rpc/http/HTTPService.html#resultFormat)

**object**：返回的值是 XML，并被解析为 ActionScript 对象树。这是默认设置。

**array**：返回的值是 XML 并被解析为 ActionScript 对象树，但是如果顶级对象不是 Array，则会创建一个新 Array 并将结果集作为第一项。如果 makeObjectsBindable 为 true，则 Array 将被包装在 ArrayCollection 中。

**xml**：返回的值是 XML，并在 ActionScript XMLnode 对象中作为文字 XML 返回。

**flashvars**：返回的值是包含由 & 号分隔的 name=value 对的文本，它被解析为 ActionScript 对象。

**text**：返回的值是文本，并且是原始的。

**e4x**：返回的值是 XML，并作为 ActionScript XML 对象中的文字 XML 返回，可以使用 ECMAScript for XML (E4X) 表达式访问该对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T18:09:53.603

The classtype of the returned object differs.

*   text => String
*   object => A generic object that you can use like a hash
*   e4x => an object of type XML
*   xml => I forget... a String?

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T18:39:57.780

我最近遇到了一些关于 "object" 和 "e4x" 的问题`resultFormat`。

我有一个用于发送请求和接收结果的基本 WebService 类。默认情况下，所有结果都作为“对象”返回。但是，有时 Flex 会查看数据并将其转换为适当的类型。例如，如果您有一个如下所示的 XML 结果，它将把它转换为一个数组对象（不知道为什么......但是......）：

```
<root>
    <child>text</child>
    <child>text text</child>
</root> 
```

现在，像这样的 Array Object 可以很容易地转换为 XML，因为作为字符串，它也是 XML。

但是，当是“对象”时，某些 XML 文档会以`ObjectProxy`无法转换为 XML的形式返回。`resultFormat`

我尝试使用“e4x”，正如这里所建议的那样，但后来我遇到了命名空间未正确保留的问题。

我终于尝试了“xml”，并且得到了预期的结果。有趣的是，当您使用 Flex 调试器检查事件结果属性时，它被认为是一个数组，即使您指定了 `resultFormat`“xml”的 a。我想这可以轻松转换为 ArrayCollection ...不确定....

# tfs - Team Foundation Server 2005 和 SQL Express 2005

> ID：941030
> 
> 赞同：0
> 
> 时间：2009-06-02T18:04:56.840
> 
> 标签：tfs, sql-server-2005-express

我没有看到任何说 SQL Express 2005 不支持与 Team Foundation Server 2005 一起使用。

但是，当我尝试安装时，会出现各种错误“未安装 SQL 代理服务”、“未安装 SQL Server 2005 Analysis Services 服务”等。

是否需要 SQL Server Standard 或更高版本？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T19:14:06.697

是的，当前版本的 TFS 需要 SQL Server Standard 或更高版本。当您购买 Team Foundation Server 的完整副本时，它会根据以下条款附带受限使用 SQL 标准版许可证：

*   您只能将 SQL Server 软件与 Visual Studio Team Foundation Server 一起使用；您不得将其用于任何其他目的。
*   每个 Visual Studio Team Foundation Server 许可证只能在一台物理设备上安装 SQL Server。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T18:07:57.477

试试 SQL Server Express 高级版...（我不记得它是否有分析服务）生成报告需要分析服务。另外安装2005后记得启动SQL Agent服务。

# c++ - 如何在执行期间停止 C++ 应用程序以调试到 dll？

> ID：941032
> 
> 赞同：4
> 
> 时间：2009-06-02T18:05:40.710
> 
> 标签：c++, visual-studio, debugging, dll

我有一个我没有代码的应用程序，还有一个我有代码的 dll。我需要能够调试到 dll，但缺少 exe 的源代码，我该怎么做？

dll代码为mfc c++；我相信主应用程序也是一样的。

我试过做一个“设置目标应用程序”交易，在那里我设置了将从中调用 dll 的应用程序，当以这种方式调用时，应用程序崩溃了一个可怕的、可怕的死亡。我不知道问题出在这个 dll 上还是该行为的可执行文件上，这只是我想解决的无数问题之一。

我认为应该有一些调用允许 dll 无限期地旋转，直到调试器附加到进程，此时我应该能够通过附加到进程来调试 dll。那有意义吗？有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T18:19:41.543

我曾经为此使用[DebugBreak](http://msdn.microsoft.com/en-us/library/ms679297(VS.85).aspx)函数。也许，您可以根据特定文件的存在有条件地调用它。

```
#ifdef DEBUG
if (... file exists...) {
    DebugBreak();
}
#endif 
```

这将暂停应用程序的执行，直到您附加调试器或终止应用程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T18:12:31.477

有一个名为的注册表设置`ImageFileExecutionOptions`可以设置为在加载 DLL 时启动调试器。我曾经用它来调试 ISAPI 扩展。这是一个[关于它的不错的博客条目](http://blogs.msdn.com/greggm/archive/2005/02/21/377663.aspx)的链接。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-02T18:13:45.983

如果应用程序链接到非调试 DLL 并且本身没有调试符号，那么这不太可能取得成果。如果您对 Windows DLL 中的内容感到好奇，您可能想在[此处](http://www.microsoft.com/whdc/DevTools/Debugging/debugstart.mspx)查找有关使用 Windows 符号包的信息来帮助您，但总的来说，一个没有调试信息且您无法编译的应用程序是'不能以任何有意义的方式调试。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T18:17:11.813

使用 DLL 项目，您应该能够告诉 Visual Studio 开始调试，它会要求您提供可执行文件名称。在那里输入你的exe。当我处理从另一个进程调用的 DLL 代码时，我做了很多这样的工作。适用于直接 DLL 以及 COM 组件。

如果您知道问题可能出在哪里，提前在代码中设置一些断点也可能会有所帮助。

**更新：**由于这对您不起作用，我能想到的唯一另一件事就是附加到正在运行的 exe，但如果您的代码在您有机会进入那里之前被加载，这可能会出现问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-02T18:25:32.190

```
__asm int {3}; 
```

在您的 DLL 主文件中。然后将调试器附加到进程？如果这会杀死进程，那么它可能有自己的 int3 陷阱并且正在退出。您是否正在尝试调试受版权保护的游戏或类似的东西？因为他们倾向于做那种狡猾的行为。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-02T18:35:05.870

等到调试器出现：

```
while(!IsDebuggerPresent())
{
  Sleep(0);  // yield
} 
```

MSDN 文档：[`IsDebuggerPresent()`](http://msdn.microsoft.com/en-us/library/ms680345(VS.85).aspx).

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-02T18:50:36.620

确保应用程序确实在使用您在调试模式下构建的 DLL 和符号。您可以使用诸如[Process Explorer](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)之类的程序来验证这一点（在此应用程序中，启用 View 菜单中的下部窗格并选择 DLLs）。

然后，在 Visual Studio 的“调试”菜单中，选择“附加到进程”，然后选择使用您的 DLL 的应用程序。如果加载 DLL，则应填写调试断点。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-15T15:44:22.197

我最近不得不使用此处列出的方法之一：http: [//blogs.msdn.com/greggm/archive/2004/07/08/177418.aspx](http://blogs.msdn.com/greggm/archive/2004/07/08/177418.aspx)

这有帮助吗？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-02T18:22:53.583

这是一个简单的解决方案：`Sleep(10000);`在 DllMain（或其他一些启动代码）中添加一个，然后`Tools / Attach to Process`在代码处于休眠状态时用于附加调试器。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-02T18:29:26.973

> 我认为应该有一些调用允许 dll 无限期地旋转，直到调试器附加到进程，此时我应该能够通过附加到进程来调试 dll。那有意义吗？有一个更好的方法吗？

为什么不按照你描述的方式做呢？只需启动您要调试的应用程序。通过 Visual Studio 或在任务管理器中右键单击应用程序并选择调试，将调试器附加到它。连接调试器后，在您的 dll 代码中的合适位置使用 F9 设置断点。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-06-04T07:51:24.750

> 我试过做一个“设置目标应用程序”交易，在那里我设置了将从中调用 dll 的应用程序，当以这种方式调用时，应用程序崩溃了一个可怕的、可怕的死亡。我不知道问题出在这个 dll 上还是该行为的可执行文件上，这只是我想解决的无数问题之一。

在调试器中启动一个进程会导致 Windows 启用[NT 调试堆](http://msdn.microsoft.com/en-us/library/cc266414.aspx)。听起来应用程序或 DLL 有堆损坏或依赖于未初始化的堆内存的值。

您可以通过将环境变量设置`_NO_DEBUG_HEAP`为 1 来禁用 NT 调试堆（在 XP 和更高版本上）。这可能使应用程序在从调试器启动时不会死于可怕的死亡。

在调试器之外启动应用程序也会导致 NT 调试堆被禁用，并且稍后附加调试器将不会启用它。

# java - 是否可以将 GROUP BY 与绑定变量一起使用？

> ID：941034
> 
> 赞同：8
> 
> 时间：2009-06-02T18:06:20.037
> 
> 标签：java, sql, oracle, jdbc, prepared-statement

我想发出如下查询

```
select max(col1), f(:1, col2) from t group by f(:1, col2) 
```

其中`:1`是绑定变量。使用`PreparedStatement`，如果我说

```
connection.prepareStatement
  ("select max(col1), f(?, col2) from t group by f(?, col2)") 
```

我从 DBMS 收到一个错误，抱怨`f(?, col2)`不是 GROUP BY 表达式。

通常如何在 JDBC 中解决这个问题？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-02T18:38:55.677

我建议重新编写语句，以便只有一个绑定参数。这种方法有点难看，但会返回结果集：

```
select max(col1) 
     , f_col2
  from (
         select col1
              , f(? ,col2) as f_col2 
           from t
       )
 group
    by f_col2 
```

这个重写的语句只引用了一个绑定参数，所以现在 DBMS 看到 GROUP BY 子句和 SELECT 列表中的表达式是相同的。

高温高压

[编辑]

（我希望有更漂亮的方式，这就是为什么我更喜欢 Oracle 使用的命名绑定参数方法。使用 Perl DBI 驱动程序，位置参数在实际发送到 Oracle 的语句中转换为命名参数。）

起初我没有看到问题，我不明白原来的问题。（显然，其他几个人也错过了它。）但是在运行了一些测试用例之后，我明白了问题是什么，问题是什么。

让我看看我是否可以说明问题：如何让两个单独的（位置）绑定参数被（由 DBMS）处理，就好像它是对相同（命名）绑定参数的两个引用一样。

DBMS 期望 GROUP BY 中的表达式与 SELECT 列表中的表达式匹配。但是即使表达式相同，这两个表达式也被认为是不同的，唯一的区别是每个表达式引用不同的绑定变量。（我们可以演示一些至少某些 DBMS 允许的测试用例，但还有更一般的情况会引发异常。）

在这一点上，简短的回答是，这让我很难过。我的建议（可能不是对原始问题的实际答案）是重组查询。

[/编辑]

如果这种方法不起作用，或者您在解决它时遇到其他问题，我可以提供更多详细信息。或者如果存在性能问题（我可以看到优化器为重新编写的查询选择不同的计划，即使它返回指定的结果集。为了进一步测试，我们真的需要知道什么 DBMS，什么驱动程序，统计等）

**编辑**（八年半后）

再次尝试重写查询。同样，我想出的唯一解决方案是带有一个绑定占位符的查询。这一次，我们将它放入一个返回单行的内联视图中，并将其连接到 t。我可以看到它在做什么；我不确定 Oracle 优化器将如何看到这一点。我们可能希望（或需要）进行显式转换，例如`TO_NUMBER(?) AS param`, `TO_DATE(?,'...') AS param`, `TO_CHAR(?) AS param`，具体取决于绑定参数的数据类型，以及我们希望从视图返回的数据类型。）

这就是我在 MySQL 中的做法。我的答案中的原始查询在内联视图（MySQL*派生表*）中执行连接操作。如果可以避免，我们希望避免实现一个hughjass 派生表。再说一次，只要`sql_mode`不包含`ONLY_FULL_GROUP_BY`. MySQL 也会让我们放弃`FROM DUAL`)

```
 SELECT MAX(t.col1)
       , f( v.param ,t.col2)
    FROM t
   CROSS
    JOIN ( SELECT ? AS param FROM DUAL) v
   GROUP
      BY f( v.param ,t.col2) 
```

根据 MadusankaD 的回答，在过去的八年里，Oracle 增加了对在 JDBC 驱动程序中重用相同命名的绑定参数的支持，并保留等效性。（我还没有测试过，但如果它现在有效，那就太好了。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-11-23T15:12:08.887

即使您已通过 JDBC 驱动程序（使用`PreparedStatement`）发出查询，如下所示：

```
select max(col1), f(:1, col2) from t group by f(:1, col2) 
```

最后 JDBC 驱动程序在解析到数据库之前替换了如下查询，即使您在两个地方都使用了相同的绑定变量名称。

```
select max(col1), f(*:1*, col2) from t group by f(*:2*, col2) 
```

但在 oracle 中，这不会被视为有效的 group by 子句。而且普通的 JDBC 驱动程序也不支持命名绑定变量。

为此，您可以使用`OraclePreparedStatement`类进行连接。这意味着它是 oracle JDBC。然后你可以使用命名绑定变量。它将解决您的问题。

从 Oracle 数据库 10g JDBC 驱动程序开始，使用这些`setXXXAtName`方法支持按名称绑定。

[http://docs.oracle.com/cd/E24693_01/java.11203/e16548/apxref.htm#autoId20](http://docs.oracle.com/cd/E24693_01/java.11203/e16548/apxref.htm#autoId20)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T18:24:51.347

您是否尝试使用`?`而不是命名绑定变量？另外，您使用的是哪个驱动程序？我使用瘦驱动程序尝试了这个简单的示例，它似乎工作正常：

```
PreparedStatement ps = con.prepareStatement("SELECT COUNT(*), TO_CHAR(SYSDATE, ?) FROM DUAL GROUP BY TO_CHAR(SYSDATE, ?)");
ps.setString(1, "YYYY");
ps.setString(2, "YYYY");
ps.executeQuery(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T18:30:29.997

在第二种情况下，实际上有两个变量 - 您需要将它们都发送为相同的值。

# php - array_filter 过滤掉整个数组

> ID：941035
> 
> 赞同：0
> 
> 时间：2009-06-02T18:06:21.317
> 
> 标签：php, arrays, filtering

我有一个数组数组，每个数组都包含医疗设备扫描的详细信息。我从每晚转储的文本日志中获取这些数据。其格式是这样的：

```
$this->scans = array(
  array(  
    'patientid' => (int),
    'patientname' => 'John Skeet',
    'reviewed' => 0 or 1
     //plus more irrelevant
  ),
  array(
    //same as above
  ), //etc
) 
```

这里重要的数组键是`reviewed`，因为如果每个扫描质量足够高，则可以对其进行审查。但是，文本日志会转储获取的每个扫描，然后返回并重新列出已查看的扫描。

现在为了防止重复，我想我可以只使用 an`array_filter`来过滤已获取和审查的扫描（保留审查的版本）。但是，过滤器功能会过滤掉整个数组（在极少数情况下除外）。如果有人可以看看并让我知道他们为什么认为它正在发生，那将不胜感激。

```
$this->scans = array_filter($this->scans, array($this, "scan_cleanup")); 
```

.

```
private function scan_cleanup($scan) {
        //only if the scan was not reviewed
    if ($scan['reviewed'] == 0) {
                //change reviewed status to see if there is a duplicate
        $scan['reviewed'] == 1;
                //return false to remove this copy (and keep reviewed)
        if (in_array($scan, $this->scans)) {
            return false;
        }
    }
    return true;

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T18:11:29.467

```
$scan['reviewed'] == 1; 
```

对比

```
$scan['reviewed'] = 1; 
```

一个是有条件的，在这种情况下什么都不做，另一个不存在。

你也不`return false`经常跑步。我会通过一点重构（提取条件检查）稍微改变逻辑以使其更清晰，更简单。

```
if ($scan['reviewed'] and hasDupe($scan)) {
   return false;  // filter out
}
return true; // it is passed back, and is output 
```

hasDupe() 对重复记录进行最好的检查并返回真/假。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T18:17:47.257

据我所知，“==”与“=”的简单案例。

```
$scan['reviewed'] = 1; 
```

这应该可以解决问题。有时最简单的问题是最难发现的;-)

# asp.net - How do I read a text file on the same server with ASP.NET?

> ID：941046
> 
> 赞同：0
> 
> 时间：2009-06-02T18:08:56.680
> 
> 标签：asp.net, sql-server, vb.net, file-io

# Solution:

It turns out I wasn't checking the path that it was looking up, quite silly of me. Once I tracked that problem down and corrected the offending path, the reading worked just fine. Still baffled at the MSSQL issue, since the articles average less than 10 000 bytes.

* * *

## Clarification:

I am unsure if some of you are under the impression that the file I am trying to read is on my local machine. It resides on the web, on the same server as the script that is accessing it. Just in a different directory.

* * *

I wrote an online help desk application that includes articles. One problem I have run into is some of the articles are too long, and get truncated when I put them into my MSSQL database. I tried using `TEXT` and `VARCHAR(MAX)` as the data type, but it would still get truncated.

So I decided that I would put the articles that are too long into a text file, and have my application read the text file from there. I got this code working in my development environment, but it does not work live:

```
Dim output As String = String.Empty
Try
    Dim theArticle As gsClassroom = classArticles(iterate)
    If theArticle.Body.StartsWith("/docs/") Then
        Dim oReader As IO.StreamReader = Nothing
        Try
            oReader = New IO.StreamReader(Server.MapPath(String.Format("/dev{0}", theArticle.Body)))

        Catch ex As Exception
            output = String.Format("{0}<br /><br />{1}", ex.Message, "internal")
        Finally
            oReader.Close()
            oReader.Dispose()
            oReader = Nothing
        End Try
    Else
        output = theArticle.Body
    End If
Catch ex As Exception
    output = String.Format("{0}<br /><br />{1}", ex.Message, "external")
End Try
Response.Output.WriteLine(output) 
```

At first, I thought it was because I did not change the `/dev` path prefix to `/hlpdsk`. But even after I changed it, it bombed out. What am I doing wrong?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T18:14:44.173

The first thing that enters my mind on these sorts of issues is permissions settings on your production environment won't allow you to access that directory.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T18:19:18.783

我知道您想解决读取此文本文件的问题，但我建议您返回使用 Varchar(MAX) 从 sql server 表中读取文本。

请注意，当文本大于几 KB 时，它会将其拆分为多个结果。因此，在阅读时，您必须从 datareader 读取并写入字符串生成器。完成后，您将在字符串生成器中获得全部内容。

至于文件读取不要这样做。在服务器环境中会有很多文件权限问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T18:19:44.103

什么样的帮助台文章长度超过 2^31-1 字节？（varchar(max) 的限制）

一篇如此长的文章需要很长时间才能加载，以至于人们会认为该网站已损坏并放弃。不会吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T18:46:54.943

正如马修所说，它失败的原因是权限。在 VS 中开发时，通常使用集成的 Visual Studio Web 服务器运行。运行此 Web 服务器时，它在您登录帐户的权限下运行，这意味着您可以访问本地 PC 上的几乎所有内容。

当您部署到生产环境时，您在 IIS 中运行，并且安全权限是您的应用恰好在其中运行的应用程序池的权限。默认情况下，AppPool 在 NetworkService 帐户下运行，这意味着它对PC 上的本地资源。

您可以提升 AppPool 的权限，但这是一种不好的做法和安全风险。如前所述，更好的方法是正确使用 SQL Server 中可用的数据类型来存储数据。

# java - 将休眠类从基于序列的整数主键迁移到 GUID 主键，同时保留旧键以实现向后兼容性？

> ID：941049
> 
> 赞同：1
> 
> 时间：2009-06-02T18:09:36.897
> 
> 标签：java, hibernate, guid

什么策略有利于将休眠类从基于序列的整数主键迁移到 GUID 主键，同时保留旧键以实现向后兼容性？

我们有一个广泛的类层次结构（使用连接子类模型），其中基类具有从数据库中的序列生成的 Long 主键。

我们正在努力过渡到 GUID 主键，但希望为旧版应用保留旧主键（在旧内容和新创建的内容中）。虽然实现看起来相当简单（将主键更改为 GUID，添加拦截器以填充新内容的内容 ID），但我需要注意哪些陷阱？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-26T14:42:23.893

你确定你要这么做吗？

我了解需要 GUID，但您真的希望它们成为您的数据库 PK。我所做的一些非正式测试表明，使用 GUID PK 进行连接/搜索与整数 PK 相比，命中率大约为 10-15%。我建议您在当前人群中尝试使用 GUID 进行一些测试，看看性能受到什么影响。将唯一索引的 GUID 列添加到表中并保留 PK 原样可能会更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T18:18:09.800

像“我们知道 PK 是 GUID 所以它的长度总是那么多”这样的愚蠢错误......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T18:34:29.867

我想不出一个漂亮的解决方案，但是，

我将创建另一个字段来保存 GUID，并为当前存在的任何记录自动生成 ID，并从那里开始。它会有点味道，但如果你问我，它比尝试在同一字段中存储不兼容的类型要好。

# iphone - 使用 Open GL ES 在 iPhone 上渲染启动画面

> ID：941066
> 
> 赞同：1
> 
> 时间：2009-06-02T18:14:36.700
> 
> 标签：iphone, opengl, render, splash-screen

我想在使用 Open GL 视图时在 iPhone 上呈现启动画面。我们知道的 iPhone 屏幕是 320x480，不是 2 的幂。

在我进入切割纹理和渲染子部分的世界之前，或者在另一个纹理页面上嵌入屏幕之前，我想知道是否还有其他方法？

是否可以覆盖另一个我可以使用 CoreGraphics 函数渲染的视图？或者是否可以使用 Core Graphics 函数渲染到 Open GL 表面。

你会推荐什么？

干杯丰富

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T18:47:10.403

完全可以编写一些代码，创建一个 512x512 纹理，将图像加载到其中，然后仅渲染该纹理的一部分（通过映射到多边形并更改纹理映射 UV 坐标）。

此方法仅适用于静态图像，您无法真正为此执行逐像素实时更新；通过 open GL ES 更新纹理目前太慢了。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-06-02T18:18:18.443

我建议您阅读 Apple 的 iPhone 人机界面指南，尤其是他们一遍又一遍地警告您不要制作闪屏的几个部分。

# xml - 用于搜索 XML 文档的表单

> ID：941086
> 
> 赞同：0
> 
> 时间：2009-06-02T18:19:20.280
> 
> 标签：xml, xpath, scripting

我从 W3Schools 获得了关于 XML 和 XSL 的教程，我有三个文件（请参阅下面的代码） XML - cdcatalog.xml XSL - cdcatalog.xsl HTML - search.htm

我试图做的是构建一个 HTML 搜索表单来搜索 XML 文档，我更改了 XML 文件中的一些艺术家姓名，例如，如果我搜索 Bob Dylan 这三个详细信息应该返回，因为搜索应该匹配 bob和艺术家节点中的 dylan：

```
<cd>
    <title>Empire Burlesque</title>
    <artist>Bob Dylan</artist>
    <country>USA</country>
    <company>Columbia</company>

    <price>10.90</price>
    <year>1985</year>
  </cd>
  <cd>
    <title>Hide your heart</title>
    <artist>Bonnie Dylan</artist>
    <country>UK</country>

    <company>CBS Records</company>
    <price>9.90</price>
    <year>1988</year>
  </cd>
  <cd>
    <title>Greatest Hits</title>
    <artist>Bob Parton</artist>

    <country>USA</country>
    <company>RCA</company>
    <price>9.90</price>
    <year>1982</year>
  </cd> 
```

我不确定这是否可能，任何示例代码都会有很大帮助。

XML - cdcatalog.xml

```
<?xml version="1.0" encoding="iso-8859-1"?>
<?xml-stylesheet type="text/xsl" href="cdcatalog.xsl"?>
<!-- Edited by XMLSpy® -->
<catalog>
  <cd>
    <title>Empire Burlesque</title>
    <artist>Bob Dylan</artist>
    <country>USA</country>
    <company>Columbia</company>

    <price>10.90</price>
    <year>1985</year>
  </cd>
  <cd>
    <title>Hide your heart</title>
    <artist>Bonnie Dylan</artist>
    <country>UK</country>

    <company>CBS Records</company>
    <price>9.90</price>
    <year>1988</year>
  </cd>
  <cd>
    <title>Greatest Hits</title>
    <artist>Bob Parton</artist>

    <country>USA</country>
    <company>RCA</company>
    <price>9.90</price>
    <year>1982</year>
  </cd>
  <cd>
    <title>Still got the blues</title>

    <artist>Gary Moore</artist>
    <country>UK</country>
    <company>Virgin records</company>
    <price>10.20</price>
    <year>1990</year>
  </cd>

  <cd>
    <title>Eros</title>
    <artist>Eros Ramazzotti</artist>
    <country>EU</country>
    <company>BMG</company>
    <price>9.90</price>

    <year>1997</year>
  </cd>
  <cd>
    <title>One night only</title>
    <artist>Bee Gees</artist>
    <country>UK</country>
    <company>Polydor</company>

    <price>10.90</price>
    <year>1998</year>
  </cd>
  <cd>
    <title>Sylvias Mother</title>
    <artist>Dr.Hook</artist>
    <country>UK</country>

    <company>CBS</company>
    <price>8.10</price>
    <year>1973</year>
  </cd>
  <cd>
    <title>Maggie May</title>
    <artist>Rod Stewart</artist>

    <country>UK</country>
    <company>Pickwick</company>
    <price>8.50</price>
    <year>1990</year>
  </cd>
  <cd>
    <title>Romanza</title>

    <artist>Andrea Bocelli</artist>
    <country>EU</country>
    <company>Polydor</company>
    <price>10.80</price>
    <year>1996</year>
  </cd>

  <cd>
    <title>When a man loves a woman</title>
    <artist>Percy Sledge</artist>
    <country>USA</country>
    <company>Atlantic</company>
    <price>8.70</price>

    <year>1987</year>
  </cd>
  <cd>
    <title>Black angel</title>
    <artist>Savage Rose</artist>
    <country>EU</country>
    <company>Mega</company>

    <price>10.90</price>
    <year>1995</year>
  </cd>
  <cd>
    <title>1999 Grammy Nominees</title>
    <artist>Many</artist>
    <country>USA</country>

    <company>Grammy</company>
    <price>10.20</price>
    <year>1999</year>
  </cd>
  <cd>
    <title>For the good times</title>
    <artist>Kenny Rogers</artist>

    <country>UK</country>
    <company>Mucik Master</company>
    <price>8.70</price>
    <year>1995</year>
  </cd>
  <cd>
    <title>Big Willie style</title>

    <artist>Will Smith</artist>
    <country>USA</country>
    <company>Columbia</company>
    <price>9.90</price>
    <year>1997</year>
  </cd>

  <cd>
    <title>Tupelo Honey</title>
    <artist>Van Morrison</artist>
    <country>UK</country>
    <company>Polydor</company>
    <price>8.20</price>

    <year>1971</year>
  </cd>
  <cd>
    <title>Soulsville</title>
    <artist>Jorn Hoel</artist>
    <country>Norway</country>
    <company>WEA</company>

    <price>7.90</price>
    <year>1996</year>
  </cd>
  <cd>
    <title>The very best of</title>
    <artist>Cat Stevens</artist>
    <country>UK</country>

    <company>Island</company>
    <price>8.90</price>
    <year>1990</year>
  </cd>
  <cd>
    <title>Stop</title>
    <artist>Sam Brown</artist>

    <country>UK</country>
    <company>A and M</company>
    <price>8.90</price>
    <year>1988</year>
  </cd>
  <cd>
    <title>Bridge of Spies</title>

    <artist>T`Pau</artist>
    <country>UK</country>
    <company>Siren</company>
    <price>7.90</price>
    <year>1987</year>
  </cd>

  <cd>
    <title>Private Dancer</title>
    <artist>Tina Turner</artist>
    <country>UK</country>
    <company>Capitol</company>
    <price>8.90</price>

    <year>1983</year>
  </cd>
  <cd>
    <title>Midt om natten</title>
    <artist>Kim Larsen</artist>
    <country>EU</country>
    <company>Medley</company>

    <price>7.80</price>
    <year>1983</year>
  </cd>
  <cd>
    <title>Pavarotti Gala Concert</title>
    <artist>Luciano Pavarotti</artist>
    <country>UK</country>

    <company>DECCA</company>
    <price>9.90</price>
    <year>1991</year>
  </cd>
  <cd>
    <title>The dock of the bay</title>
    <artist>Otis Redding</artist>

    <country>USA</country>
    <company>Atlantic</company>
    <price>7.90</price>
    <year>1987</year>
  </cd>
  <cd>
    <title>Picture book</title>

    <artist>Simply Red</artist>
    <country>EU</country>
    <company>Elektra</company>
    <price>7.20</price>
    <year>1985</year>
  </cd>

  <cd>
    <title>Red</title>
    <artist>The Communards</artist>
    <country>UK</country>
    <company>London</company>
    <price>7.80</price>

    <year>1987</year>
  </cd>
  <cd>
    <title>Unchain my heart</title>
    <artist>Joe Cocker</artist>
    <country>USA</country>
    <company>EMI</company>

    <price>8.20</price>
    <year>1987</year>
  </cd>
</catalog> 
```

XSL - cdcatalog.xsl

```
<?xml version="1.0" encoding="iso-8859-1"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

  <xsl:template match="/">
    <html>
      <body>
        <h2>My CD Collection</h2>
        <table border="1">
          <tr bgcolor="#9acd32">
            <th>Title</th>
            <th>Artist</th>
          </tr>
          <xsl:for-each select="catalog/cd[artist='Bob Dylan']">
            <tr>
              <td>
                <xsl:value-of select="title"/>
              </td>
              <td>
                <xsl:value-of select="artist"/>
              </td>
            </tr>
          </xsl:for-each>
        </table>
      </body>
    </html>
  </xsl:template>

</xsl:stylesheet> 
```

HTML - search.htm

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<head>
    <title>Untitled Page</title>
</head>
<body>
<html>
<head><title>Search</title></head>
<body>
    <form action="cdcatalog.xsl" method="post">
         Find <input type="text" name="q">
         <input type="submit" value="Go">
    </form>
</body>
</html>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T07:07:31.357

首先，您的 HTML 无效，提交到 XSL 不会产生您想要的结果。
第二 - XSL 中的表达式

```
<xsl:for-each select="catalog/cd[artist='Bob Dylan']"> 
```

**将仅匹配以 Bob Dylan**作为其值的艺术家节点。
如果你也想要部分匹配，你可以尝试使用

```
<xsl:for-each select="catalog/cd[contains(artist, 'Bob') or contains(artist, 'Dylan')]"> 
```

# delphi - 用于 TCP 连接的 Delphi 透明代理

> ID：941087
> 
> 赞同：5
> 
> 时间：2009-06-02T18:19:37.143
> 
> 标签：delphi, proxy, tcp, sockets

任何人都知道用 Delphi 编写的 TCP 套接字代理应用程序的任何示例吗？我正在构建一个小型代理应用程序，它需要侦听给定 TCP 端口上的套接字连接，读取通过该连接发送的 XML 数据包，通过 TCP 将请求提供给从可用后端服务器池中选择的服务器，然后交付将结果响应返回给原始 TCP 连接。

我对 TCP 和套接字级编程非常熟悉，但更愿意找到示例代码作为起点。如果有可用的东西，它将节省大量时间和精力，因为我不需要重新发明轮子。我记得在 2003/2004 年看到过一个用 Delphi 编写的小型 TCP 代理，但似乎忘记了链接。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-02T20:05:25.800

您在寻找 socks 代理实现吗？如果不是，那么就从服务器开始（http 很可能是一个好的开始），并在其中构建处理入站 XML 数据包的能力，并进行适当的调用。像[Synapse](http://synapse.ararat.cz/doku.php)框架之类的东西会使这个项目变得相当简单。如果您使用 Synapse，请从 SVN 获取最新版本。它支持所有最新版本的 Delphi。

有一个用于突触的[httpproxy](http://synapse.ararat.cz/files/contrib/httpproxydemo.zip)演示，如果您想实现更传统的东西，这可能会有所帮助。还提供了一个很好的启动 http 服务器[示例](http://synapse.ararat.cz/files/contrib/webcam.zip)。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-06-03T04:08:10.100

nSoftware 的 IPWorks 应被视为 Synapse 的商业替代品。他们也有一些可用的 Biztalk 适配器。

我用过 Synapse 和 IPWorks，它们都很好。我没有使用引用的 BizTalk 适配器。

[BizTalk 适配器](http://www.nsoftware.com/products/biztalk/)

[IPWorks](http://www.nsoftware.com/ipworks/)

# oracle - 在 Oracle 临时表上放置索引是否安全？

> ID：941094
> 
> 赞同：12
> 
> 时间：2009-06-02T18:20:00.967
> 
> 标签：oracle, indexing, temp-tables

我已经读过不应该分析临时表，因为它会破坏其他人的表统计信息。索引呢？如果我在我的程序期间在表上放置一个索引，使用该表的其他程序会受到该索引的影响吗？

**索引是否会影响我的进程以及使用该表的所有其他进程？或者它会单独影响我的流程吗？**

没有一个回应是权威的，所以我提供所说的贿赂。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-08T10:18:30.247

> 索引是否会影响我的进程以及使用该表的所有其他进程？或者它会单独影响我的过程吗？

我假设我们在谈论`GLOBAL TEMPORARY`桌子。

**将临时表想象成多个表，每个进程从存储在系统字典中的模板动态创建和删除这些表**。

在`Oracle`, `DML`of a`temporary table`影响所有进程，而表中包含的数据将仅影响使用它们的一个进程。

a 中的数据`temporary table`仅在会话范围内可见。它用于`TEMPORARY TABLESPACE`存储数据和可能的索引。

`DML`对于 a `temporary table`（即它的布局，包括列名和索引）对具有足够权限的每个人都是可见的。

这意味着索引的**存在**将影响您的进程以及使用该表的其他进程，因为任何修改数据的进程`temporary table`也必须修改索引。

**相反，包含在表中（以及索引中）的数据**只会影响创建它们的进程，甚至不会对其他进程可见。

如果您希望一个进程使用索引而另一个进程不使用它，请执行以下操作：

*   创建两个`temporary tables`具有相同列布局
*   其中之一的索引
*   根据进程使用索引表或非索引表

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-02T18:39:43.850

我假设您指的是真正的 Oracle 临时表，而不仅仅是临时创建然后删除的常规表。是的，在临时表上创建索引是安全的，它们将根据与常规表和索引相同的规则使用。

[编辑]我看到你已经完善了你的问题，这里有一个稍微精致的答案：

从：

```
Oracle® Database Administrator's Guide
10g Release 2 (10.2)
Part Number B14231-02 
```

“可以在临时表上创建索引。它们也是临时**的，索引中的数据与基础表中的数据具有相同的会话或事务范围**。”

如果您需要在事务范围内进行有效处理的索引，那么我想您必须在查询中明确提示它，因为统计信息不会显示表的行。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-03T04:08:00.180

你问的是两个不同的东西，索引和统计。对于索引，是的，您可以在临时表上创建索引，它们将照常维护。

对于统计信息，我建议您在查询时显式设置表的统计信息以表示表的平均大小。如果您只是让 oracle 自己收集统计信息，那么 stats 进程将不会在表中找到任何内容（因为根据定义，表中的数据对于您的事务来说是本地的），因此它将返回不准确的结果。

例如你可以这样做：

`exec dbms_stats.set_table_stats(user, 'my_temp_table', numrows=>10, numblks=>4)`

另一个提示是，如果临时表的大小变化很大，并且在您的事务中，您知道临时表中有多少行，您可以通过提供该信息来帮助优化器。如果您从临时表加入常规表，我发现这会很有帮助。

例如，如果您知道临时表中有大约 100 行，您可以：

`SELECT /*+ CARDINALITY(my_temp_table 100) */ * FROM my_temp_table`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-08T05:31:06.440

好吧，我试了一下，第二个会话可见并使用了索引。如果您确实需要索引，为您的数据创建一个新的全局临时表会更安全。

当任何其他会话正在访问该表时，您也无法创建索引。

这是我运行的测试用例：

```
--first session
create global temporary table index_test (val number(15))
on commit preserve rows;

create unique index idx_val on index_test(val);

--second session
insert into index_test select rownum from all_tables;
select * from index_test where val=1; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-09T09:42:50.063

您还可以使用动态采样提示（10g）：

select /*+ DYNAMIC_SAMPLING (3) */ val from index_test where val = 1;

见[问汤姆](http://www.oracle.com/technetwork/issue-archive/2009/09-jan/o19asktom-086775.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-12-03T15:51:40.737

当临时表被另一个会话使用时，您不能在临时表上创建索引，因此答案是：不，它不会影响任何其他进程，因为这是不可能的。

现有索引仅影响您当前的会话，因为对于任何其他会话，临时表显示为空，因此它无法访问任何索引值。

第 1 节：

```
SQL> create global temporary table index_test (val number(15)) on commit preserve rows;
Table created.
SQL> insert into index_test values (1);
1 row created.
SQL> commit;
Commit complete.
SQL> 
```

会话 2（会话 1 仍处于连接状态）：

```
SQL> create unique index idx_val on index_test(val);
create unique index idx_val on index_test(val)
                               *
ERROR at line 1:
ORA-14452: attempt to create, alter or drop an index on temporary table already in use
SQL> 
```

回到会话 1：

```
SQL> delete from index_test;
1 row deleted.
SQL> commit;
Commit complete.
SQL> 
```

第 2 节：

```
SQL> create unique index idx_val on index_test(val);
create unique index idx_val on index_test(val)
                               *
ERROR at line 1:
ORA-14452: attempt to create, alter or drop an index on temporary table already in use
SQL> 
```

仍然失败，您首先必须断开会话 1 或必须截断表。

第 1 节：

```
SQL> truncate table index_test;
Table truncated.
SQL> 
```

现在您可以在 Session 2 中创建索引：

```
SQL> create unique index idx_val on index_test(val);
Index created.
SQL> 
```

这个索引当然会被任何会话使用。

# c# - 使用整数访问表单成员？

> ID：941095
> 
> 赞同：0
> 
> 时间：2009-06-02T18:20:08.860
> 
> 标签：c#, .net, winforms

理论上，从面向对象的角度来看，我试图完成的整个事情都是愚蠢的，但我必须这样做。

它是我正在开发的在线游戏。客户有一个物品清单，你知道 - 虚拟物品。服务器发送物品及其在库存中的相应位置。

这是我的库存的样子：

我有 62 个面板（每个面板代表库存中的房间）。

我的问题：当我整理虚拟物品和它们应该放置的相应插槽时，我必须在表格上绘制它们。

理论上，如果我在位置 4 收到项目“C:\a.bmp”，如何将 panel4.image 设置为等于图像？

这就是我想要做的：

```
var data = new byte[6];
... //we receive a packet,data is our buffer
var position = data[4];
Form1.panel + position + .backgroundImage = "bla bla.jpg"; 
```

如何调用这样的面板？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T18:23:26.140

将它们变成一个数组，而不是有 62 个单独的变量。然后你可以使用：

```
Form1.panels[position].BackgroundImage = "..."; 
```

但是，没有任何设计器支持（我知道）-您是否在设计器中创建了所有这些面板？如果您可以改为以编程方式执行此操作，那么您的生活会变得更轻松（IMO）。

# html - 注释可以出现在 DOCTYPE 声明之前吗？

> ID：941100
> 
> 赞同：61
> 
> 时间：2009-06-02T18:21:19.310
> 
> 标签：html, comments, doctype

我想`<!-- this -->`在我的 HTML 代码的最顶部，在 DOCTYPE 声明之前放置一个注释（样式）。这符合标准吗？主流浏览器都支持吗？这样做有什么陷阱吗？

* * *

## 回答 #1

> 赞同：139
> 
> 时间：2011-02-04T12:15:47.210

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2009-06-02T18:23:01.210

写第**`<!DOCTYPE>`**一个当然是最佳实践。

我记得很久很久以前一些浏览器（可能是 IE6）忽略了一个奇怪的问题，**`<!DOCTYPE>`**因为在它之前有一些看似无辜的东西 - 我认为只是空格，但也许它是一个评论。无论如何，这是一个可怕的、可怕的错误，必须追查，而且肯定没有任何充分的理由在**`<!DOCTYPE>`**.

**`<!DOCTYPE>`**我想说，写第一个是有经验的 Web 开发人员为了避免可怕的、难以捉摸的错误而做的事情。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-06-02T18:23:01.290

虽然按照我认为的标准它是可以接受的，但你肯定想避免它，因为它会使 IE 进入怪癖模式。

（请参阅[触发不同的渲染模式](http://en.wikipedia.org/wiki/Quirks_mode)）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-02T18:23:23.737

[根据此页面](http://www.dojotoolkit.org/forum/dijit-dijit-0-9/dijit-support/comment-doctype-declaration-causes-datetextbox-render-funny-ie)，这可能会导致 IE7 以怪异模式呈现，就好像 doctype 根本不存在一样。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T21:01:15.967

doctype 之前的注释是允许的，但会导致**所有**IE 版本恢复到 quirks 模式。实际上，它们有时用于此目的。XML 声明 ( `<?xml version ...?>`)*在 IE6 及以下版本中*具有相同的效果。

# sql - SQL Server 中的连接组

> ID：941103
> 
> 赞同：10
> 
> 时间：2009-06-02T18:22:13.163
> 
> 标签：sql, sql-server, group-by, string-concatenation

如果我有这样的表：

```
+------------+
| Id | Value |
+------------+
| 1  | 'A'   |
|------------|
| 1  | 'B'   |
|------------|
| 2  | 'C'   |
+------------+ 
```

我怎样才能得到这样的结果集：

```
+------------+
| Id | Value |
+------------+
| 1  | 'AB'  |
|------------|
| 2  | 'C'   |
+------------+ 
```

我知道在 MySQL 中使用 GROUP_CONCAT 很容易做到这一点，但我需要能够在 MSSQL 2005 中做到这一点

谢谢

（复制[SQL Server 中如何使用 GROUP BY 连接字符串？](https://stackoverflow.com/questions/273238/how-to-use-group-by-to-concatenate-strings-in-mssql)）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-12-17T15:31:39.490

对于一个干净高效的解决方案，您可以创建[一个用户定义的聚合函数](http://msdn.microsoft.com/en-us/library/ms190678.aspx)，甚至还有[一个示例](http://msdn.microsoft.com/en-us/library/ms131056.aspx)可以满足您的需要。
然后，您可以像使用任何其他聚合函数一样使用它（使用标准查询计划）：

![查询计划](https://i.stack.imgur.com/y8gcJ.png)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-02T18:29:10.233

这将做：

```
SELECT mt.ID,
       SUBSTRING((SELECT mt2.Value
                  FROM   MyTable AS mt2
                  WHERE  mt2.ID = mt.ID
                  ORDER BY mt2.VALUE
                  FOR XML PATH('')), 3, 2000) AS JoinedValue
FROM   MyTable AS mt 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-02T18:27:07.990

看：

[http://blog.shlomoid.com/2008/11/emulating-mysqls-groupconcat-function.html](http://blog.shlomoid.com/2008/11/emulating-mysqls-groupconcat-function.html)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-02T18:28:32.513

经常[在这里问](https://stackoverflow.com/questions/6899/is-there-a-way-to-create-a-mssql-function-to-join-multiple-rows-from-a-subquery)。

最有效的方法是使用 FOR XML PATH 技巧。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-02T18:49:56.543

这只是作为一种可能的解决方案来找我。我对性能一无所知，但我认为这将是解决问题的一种有趣方式。我测试了它在一个简单的情况下工作（我没有编码来解释 NULL）。随意给它一个测试，看看它是否适合你。

我使用的表包含一个 id (my_id)。这实际上可以是组中唯一的任何列 (grp_id)，因此它可以是日期列或其他任何内容。

```
;WITH CTE AS (
    SELECT
        T1.my_id,
        T1.grp_id,
        CAST(T1.my_str AS VARCHAR) AS my_str
    FROM
        dbo.Test_Group_Concat T1
    WHERE NOT EXISTS (SELECT * FROM dbo.Test_Group_Concat T2 WHERE T2.grp_id = T1.grp_id AND T2.my_id < T1.my_id)
    UNION ALL
    SELECT
        T3.my_id,
        T3.grp_id,
        CAST(CTE.my_str + T3.my_str AS VARCHAR)
    FROM
        CTE
    INNER JOIN dbo.Test_Group_Concat T3 ON
        T3.grp_id = CTE.grp_id AND
        T3.my_id > CTE.my_id
    WHERE
        NOT EXISTS (SELECT * FROM dbo.Test_Group_Concat T4 WHERE
        T4.grp_id = CTE.grp_id AND
        T4.my_id > CTE.my_id AND
        T4.my_id < T3.my_id)
)
SELECT
    CTE.grp_id,
    CTE.my_str
FROM
    CTE
INNER JOIN (SELECT grp_id, MAX(my_id) AS my_id FROM CTE GROUP BY grp_id) SQ ON
    SQ.grp_id = CTE.grp_id AND
    SQ.my_id = CTE.my_id
ORDER BY
    CTE.grp_id 
```

# c# - 如何在 C# 中使属性受保护和内部？

> ID：941104
> 
> 赞同：31
> 
> 时间：2009-06-02T18:22:49.137
> 
> 标签：c#, access-modifiers

这是我缩短的抽象类：

```
abstract class Report {

    protected internal abstract string[] Headers { get; protected set; }
} 
```

这是一个派生类：

```
class OnlineStatusReport : Report {

    static string[] headers = new string[] {
        "Time",
        "Message"
    }

    protected internal override string[] Headers {
        get { return headers; }
        protected set { headers = value; }
    }

    internal OnlineStatusReport() {
        Headers = headers;
    }
} 
```

这个想法是，我希望能够`Report.Headers`从程序集中的任何地方调用，但只允许它由派生类设置。我试着`Headers`只做内部的，但受保护的并不比内部更具限制性。有没有办法让 Headers 成为内部的，并且它的 set 访问器受保护和内部的？

我觉得我严重滥用了访问修饰符，所以任何设计帮助都将不胜感激。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-06-02T18:26:27.943

这在 C# 中是不可能的。

只是为了完整起见，这在 IL（家族和程序集访问修饰符）中得到支持。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-06-02T20:01:24.417

公开吸气剂有什么问题？如果您将属性声明为

```
public string[] Headers { get; protected set; } 
```

它满足您想要的所有标准：程序集的所有成员都可以获取该属性，并且只有派生类可以设置它。当然，程序集之外的类也可以获得该属性。所以？

如果您确实需要在程序集中但不公开公开该属性，另一种方法是创建一个不同的属性：

```
protected string[] Headers { get; set; }
internal string[] I_Headers { get { return Headers; } } 
```

`I_`当然，用那个前缀装饰名字很难看。但这是一个奇怪的设计。对内部属性进行某种名称修饰是一种提醒自己（或其他开发人员）他们正在使用的属性是非正统的方式。此外，如果您后来决定像这样混合可访问性并不是解决问题的正确方法，您就会知道要修复哪些属性。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-02T18:30:31.527

我会将访问修饰符保持为受保护的状态并具有内部辅助方法。

```
protected override string[] Headers {
    get { return headers; } // Note that get is protected
    set { headers = value; }
}

internal SetHeadersInternal(string[] newHeaders)
{
    headers = newHeaders;
} 
```

但不知何故，这闻起来应该以某种方式重构。内部总是我会谨慎使用的东西，因为它会导致一个非常混乱的架构，其中所有东西都以某种方式使用程序集中的其他所有东西，但当然总是有例外。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2011-10-11T14:09:38.027

您可以使用内部显式实现的接口：

```
internal interface IReport
{
    string[] Headers { get; }
}

abstract class Report : IReport
{
    protected abstract string[] Headers { get; protected set; }

    string[] IReport.Headers
    {
        get { return Headers; }
    }
}

class OnlineStatusReport : Report
{
    static string[] headers = new string[] { "Time", "Message" };

    protected internal override string[] Headers
    {
        get { return headers; }
        protected set { headers = value; }
    }

    internal OnlineStatusReport()
    {
        Headers = headers;
    }
} 
```

现在您可以在定义 IReport 的程序集中获得内部访问权限，这应该正是您想要的。

显式实现接口并不是一个众所周知的策略，但它解决了很多问题。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2017-11-18T09:03:28.600

从 C# 7.2 开始，就有了构造`private protected`（[链接](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/private-protected)）。它不允许从现场读取（因此不完全符合 OP 的意图），但值得一试。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-12-06T22:22:35.633

CLR 支持受保护和内部的概念（称为家族和程序集可访问性），C# 应该实现/公开这个概念。C# 可能应该允许以下内容：

```
internal string[] Header { get; protected set; } 
```

这样做应该 INTERSECT/AND 属性设置器的可见性修饰符，并允许您从同一程序集中的任何位置读取标题，但只能从同一程序集中的派生类中设置它。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-07-13T15:54:01.977

人们普遍认为，您不能使某些成员既受保护又成为内部成员。

确实，你不能在一条线上这样做，包括我自己在内的许多人都希望这样做，但如果有一些聪明，它是 100% 可行的。

```
//Code below is 100% tested

/* FROM ProtectedAndInternal.dll */

namespace ProtectedAndInternal
{
    public class MyServiceImplementationBase
    {
        protected static class RelevantStrings
        {
            internal static string AppName = "Kickin' Code";
            internal static string AppAuthor = "Scott Youngblut";
        }
    }

    public class MyServiceImplementation : MyServiceImplementationBase
    {
        public void PrintProperties()
        {
            // WORKS PERFECTLY BECAUSE SAME ASSEMBLY!
            Console.WriteLine(RelevantStrings.AppAuthor);
        }
    }

    public class NotMyServiceImplementation
    {
        public void PrintProperties()
        {
            // FAILS - NOT THE CORRECT INHERITANCE CHAIN
            // Error CS0122: 'ProtectedAndInternal.MyServiceImplementationBase.Relevant' is inaccessible due to its protection level
            // Console.WriteLine(MyServiceImplementationBase.RelevantStrings.AppAuthor);
        }
    }
}

/* From AlternateAssemblyService.dll which references ProtectedAndInternal.dll */

namespace AlternateAssemblyService
{
    public class MyServiceImplementation : MyServiceImplementationBase
    {
        public void PrintProperties()
        {
            // FAILS - NOT THE CORRECT ASSEMBLY
            // Error CS0117: 'ProtectedAndInternal.MyServiceImplementationBase.RelevantStrings' does not contain a definition for 'AppAuthor'
            // Console.WriteLine(RelevantStrings.AppAuthor);
        }
    }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-11-12T11:01:14.633

不是非常优雅但可行的解决方案，请明确实施：

```
internal bool _allowSetHeader = false;

protected void SetHeader(string[] newValue)
{
   if (_allowSetHeader)
   {
     headers = newValue;
   }
} 
```

SetHeader 只能由派生类访问，除非 _allowSetHeader 设置为 true，否则它什么也不做，这只能由内部类完成...

# jquery - JQuery/Javascript/DOM 可见性事件

> ID：941113
> 
> 赞同：14
> 
> 时间：2009-06-02T18:24:15.903
> 
> 标签：jquery

在 JQuery、Javascript 或一般 DOM 中是否有我可以订阅的事件，当元素变为可见或不可见（显示：无）时会通知我？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-06-02T18:33:38.090

DOMAttrModified 和 onpropertychange (IE) 的事件可以跟踪 DOM 元素更改并触发事件。

用一个 jQuery 插件写了这个，它允许在此处监视对 CSS 样式的更改：

[http://www.west-wind.com/weblog/posts/478985.aspx](http://www.west-wind.com/weblog/posts/478985.aspx)

这可能正是您所需要的，因为您可以执行以下操作：

```
$("#myControl").watch("display,visibility", function() { showStatus("changed...") }); 
```

# c# - 如何在数据访问层管理 SqlDataReaders？

> ID：941126
> 
> 赞同：1
> 
> 时间：2009-06-02T18:27:51.453
> 
> 标签：c#, data-access-layer

我试图更好地处理我的代码解耦、代码重用等。

每次我想阅读一些行时，我都厌倦了输入以下内容：

```
using(SqlConnection conn = new SqlConnection(myConnString))
{
  using(SqlCommand cmd = new SqlCommand(cmdTxt, conn))
  {
    conn.Open();
    using(SqlDataReader rdr = cmd.ExecuteReader())
    {
       while(rdr.Read())
       {
          /* do something with rows */
       }
     }
   }
} 
```

我知道有 LINQ to SQL（我不喜欢它）和实体框架（还是个婴儿）。我不必输入我的查询没有问题，我只是不想每次都输入命令构造、行迭代器等。

我环顾四周，发现了一些我认为对我有用的东西，并尝试实施它以使事情对我来说更容易。正如您在评论中看到的，我收到 SqlDataReader 已关闭的错误。我猜这可能是因为 DataFactory.ExecuteReader() 方法中的 using 语句。当读取器返回时，对我的 SqlConnection 和 SqlCommand 变量调用 dispose 方法。我在吗？如果是这样，应该如何管理连接和命令变量？

**编辑：** 我更新了我的代码示例以更好地反映我在做什么。

```
public class DataFactory
{
    public DataFactory()
    {}

    public DataFactory(string connectionString)
    {
       _connectionString = connectionString;
    }

    protected _connectionString = "Data Source=Localhost, etc, etc";
    private string ConnectionString
    {
        get{return _connectionString;}
    }

    public SqlConnection GetSqlConnection()
    {
        return new SqlConnection(ConnectionString);
    }

    public SqlDataReader ExecuteReader(string cmdTxt)
    {
        using(SqlConnection conn = new SqlConnection(ConnectionString))
        {
           using(SqlCommand cmd = new SqlCommand(cmdTxt, conn))
           {
                conn.Open();
                return cmd.ExecuteReader();
           }
        }
    }
}

public IRepository<T>
{
    T GetById(int id);
}

public MyTypeRepository: IRepository<MyType>
{
   private static DataFactory _df = new DataFactory();

   public MyType GetById(int id)
   {
        string cmdTxt = String.Format("SELECT Name FROM MyTable WHERE ID = {0}", id);

        using(SqlDataReader rdr = _df.ExecuteReader(cmdTxt))
        {
            if(rdr.Read()) /* I get an error that the reader is already closed here */
            {
                return new MyType(
                    Convert.ToInt32(rdr["Id"]),
                    rdr["Name"]);
            }
            else
            {
                return null;
            }
        }        
    }
}

public class MyType
{
    public MyType(int id, string name)
    {
      _id = id;
      _name = name;
    }

    private string _name;
    public string Name
    {
       get{return _name;}
    }

    private int _id;
    public int Id
    {
        get{return _id;}
    }

    public override void ToString()
    {
        return string.Format("Name: {0}, Id: {1}", Name, Id);
    }
}

public class Program
{
    private static MyTypeRepository _mtRepo = new MyTypeRepository();

    static void Main()
    {
        MyType myType = _mtRepo.GetById(1);

        Console.WriteLine(myType.ToString());
    }
} 
```

我也想知道我在做什么是否有意义，或者，如果没有，如何实现类似的东西，这样我就不必经常输入连接创建等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T18:42:34.670

在使用数据阅读器后关闭和/或处置数据阅读器非常重要，然后每个想要使用 DataFactory 的人都应该记住这样做。我认为返回 DataTable 而不是 SqlDataReader 是一个好主意，这样你的 DataFactory 不依赖到 SqlDataReader。

我是说 ：

```
public DataTable ExecuteReader(string cmdTxt)
    {
        using(SqlConnection conn = new SqlConnection(ConnectionString))
        {
           using(SqlCommand cmd = new SqlCommand(cmdTxt, conn))
           {
                conn.Open();
                using(SqlDataReader reader=cmd.ExecuteReader())
                {
                    DataTable dt=new DataTable();
                    dt.Load(reader);
                    return dt;
                }

           }
        }
    } 
```

**编辑：** 好点。我也不喜欢数据表（我们使用 NHibernate，所以我实际上不在我们的应用程序中使用数据表）所以如果你想将数据阅读器映射到你自己的对象，也许你可以有一个将数据读取器映射到您自己的对象的数据映射器我的意思是：

```
public T[] ExecuteReader<T>(string cmdTxt)
    {
        using(SqlConnection conn = new SqlConnection(ConnectionString))
        {
           using(SqlCommand cmd = new SqlCommand(cmdTxt, conn))
           {
                conn.Open();
                using(SqlDataReader reader=cmd.ExecuteReader())
                {
                    var result=new List<T>();
                    while(reader.Read())
                         result.Add(ObjectMapper.MapReader<T>(reader));

                    return result.ToArray();
                }

       }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T19:16:16.100

您的方法 ExecuteReader 将在返回 Reader 之前关闭连接。相反，它应该实现如下：

```
public IDataReader ExecuteReader(string cmdTxt)    
{        
    SqlConnection conn = new SqlConnection(...);
    try
    {
        SqlCommand cmd = new SqlCommand(cmdTxt, conn);
        conn.Open();                
        return cmd.ExecuteReader(CommandBehavior.CloseConnection);           
    }
    catch
    {
        conn.Close();
        throw;
    }
} 
```

ExecuteReader 方法的调用者需要处理 IDataReader：

```
using(IDataReader reader = ExecuteReader(commandText))
{
    ...
} // reader will be disposed here and will close the connection. 
```

请注意，上面没有调用 SqlCommand 对象上的 Dispose。根据我的经验，从使用 Reflector 的 SqlCommand 来看，只要 SqlConnection 被处置，就没有必要。但我相信如果您确实想处理它，以下方法会起作用：

```
public IDataReader ExecuteReader(string cmdTxt)    
{        
    SqlConnection conn = new SqlConnection(...);
    SqlCommand cmd = null;
    try
    {
        cmd = new SqlCommand(cmdTxt, conn);
        conn.Open();                
        IDataReader reader = 
            cmd.ExecuteReader(CommandBehavior.CloseConnection);           
        cmd.Dispose();
        return reader;
    }
    catch
    {
        if (cmd != null) cmd.Dispose();
        conn.Close();
        throw;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T18:40:18.403

我所做的是使用我的查询创建一个 XML 文件，并使用 XSLT 转换来生成我的 DAL 代码 CS 文件。您可以随心所欲，在 XML 中声明参数并在 XSLT 等中生成具有适当签名的方法等。我有一个博客条目，其中涵盖了相关主题，如何[将 XSLT 转换集成到您的 Visual Studio 项目中](http://rusanu.com/2009/04/11/using-xslt-to-generate-performance-counters-code/). 现在有人可能会争辩说，使用类型化数据集是一回事，而且是免费午餐，但在我的例子中，我使用基于 BeginExecute/EndExecute 的异步 DAL。没有一个 VS 工具能正确使用这种方法，所以我基本上必须自己构建。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T18:33:44.390

我会说这还不够解耦 - 基本上，您使用“使用 System.Data.SqlClient”的任何模块都与您的数据库耦合。DAL 的全部意义在于应用程序与 DAL 耦合，而 DAL 与数据库耦合。

# c# - 创建一个新的.txt文件，前面有日期，C#

> ID：941132
> 
> 赞同：4
> 
> 时间：2009-06-02T18:28:29.330
> 
> 标签：c#, datetime, text-files

我正在尝试从以下代码中获取以下信息：[今天的日期]___[文本文件名].txt：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.IO;

namespace ConsoleApplication29
{
    class Program
    {
        static void Main(string[] args)
        {
            WriteToFile();

        }

        static void WriteToFile()
        {

            StreamWriter sw;
            sw = File.CreateText("c:\\testtext.txt");
            sw.WriteLine("this is just a test");
            sw.Close();
            Console.WriteLine("File created successfully");

        }
    }
} 
```

我尝试放入，`DateTime.Now.ToString()`但我无法合并字符串。

有谁能够帮助我？我想要我正在创建的新文本文件标题前面的日期。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-06-02T18:46:54.333

```
static void WriteToFile(string directory, string name)
{
    string filename = String.Format("{0:yyyy-MM-dd}__{1}", DateTime.Now, name);
    string path = Path.Combine(directory, filename);
    using (StreamWriter sw = File.CreateText(path))
    {
        sw.WriteLine("This is just a test");
    }
} 
```

致电：

```
WriteToFile(@"C:\mydirectory", "myfilename"); 
```

注意几点：

*   使用自定义格式字符串指定日期，并避免在 NTFS 中使用非法字符。
*   前缀包含带有“@”字符串文字标记的路径的字符串，因此您不必转义路径中的反斜杠。
*   使用 Path.Combine() 组合路径部分，并避免使用路径分隔符。
*   创建 StreamWriter 时使用 using 块；退出块将释放 StreamWriter，并自动为您关闭文件。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-06-02T18:31:41.557

您想在 DateTime.Now 上执行自定义字符串格式。您可以使用 String.Format() 将结果与您的基本文件名结合起来。

要附加到文件名的路径上，请使用 Path.Combine()。

最后，使用 using() 块在完成后正确关闭和处置您的 StreamWriter...

```
string myFileName = String.Format("{0}__{1}", DateTime.Now.ToString("yyyyMMddhhnnss"), "MyFileName");
strign myFullPath = Path.Combine("C:\\Documents and Settings\\bob.jones\\Desktop", myFileName)
using (StreamWriter sw = File.CreateText(myFullPath))
{
    sw.WriteLine("this is just a test");
}

Console.WriteLine("File created successfully"); 
```

编辑：修复了“C:\Documents and Settings\bob.jones\Desktop”路径的示例

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T18:33:32.333

试试这个：

```
string fileTitle = "testtext.txt";
string fileDirectory = "C:\\Documents and Settings\username\My Documents\";
File.CreateText(fileDirectory + DateTime.Now.ToString("ddMMYYYY") + fileTitle); 
```

?

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T18:59:03.997

要在您对[@Scott Ivey 的回答](https://stackoverflow.com/questions/941132/creating-a-new-txt-file-with-date-in-front-c/941151#941151)的评论中回答问题：要指定文件的写入位置，请在调用 CreateText() 之前或之前添加所需的文件名路径。

例如：

```
String path = new String (@"C:\Documents and Settings\bob.jones\Desktop\");
StreamWriter sw = File.CreateText(path + myFileName); 
```

或者

```
String fullFilePath = new String (@"C:\Documents and Settings\bob.jones\Desktop\");
fullFilePath += myFileName;
StreamWriter sw = File.CreateText(fullFilePath); 
```

# javascript - 带有 Ajax 的 QUnit，QUnit 通过了失败的测试

> ID：941133
> 
> 赞同：14
> 
> 时间：2009-06-02T18:28:31.967
> 
> 标签：javascript, jquery, ajax, unit-testing, qunit

我正在研究用于 JavaScript 单元测试的 QUnit。我处于一种奇怪的情况，我正在检查 Ajax 调用返回的值。

对于以下测试，我故意尝试使其失败。

```
// test to check if the persons are returned! 
test("getPersons", function() {
  getPersons(function(response) {
    // persons = $.evalJSON(response.d);
    equals("boo", "Foo", "The name is valid");
  });
}); 
```

但它最终总是通过。这是进行 Ajax 调用的 getPersons 方法。

```
function getPersons(callback) {
  var persons = null;

  $.ajax({
    type: "POST",
    dataType: "json",
    data: {},
    contentType: "application/json",
    url: "AjaxService.asmx/GetPersons",
    success: function(response) {
      callback(response);
    }
  });
} 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-06-02T18:46:34.273

开始和停止使用 QUnit 库似乎工作正常！

```
// test to check if the persons are returned!
test("getPersons", function() {
  stop();
  getPersons(function(response) {
    persons = $.evalJSON(response.d);
    equals(persons[0].FirstName, "Mohammad");
    start();
  });
}); 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2010-10-05T23:22:29.417

这里真正的问题是不需要调用 start() 和 stop() 方法——事实上，如果你在回调结束时不小心再次调用 stop()，你可能会遇到麻烦。额外的 .ajax() 方法。这意味着您会发现自己陷入了一些混乱，必须跟踪是否所有回调都已被触发以了解您是否仍需要再次调用 stop()。

问题的根源在于异步请求的默认行为——简单的解决方案是通过将**async**属性设置为 false 来使 .ajax() 请求同步发生：

```
test("synchronous test", function() {
  $.ajax({
    url:'Sample.asmx/Service',
    async:false,
    success: function(d,s,x) { ok(true, "Called synchronously"); }
  });
}); 
```

尽管如此，最好的方法是允许异步行为并使用正确的测试方法调用：**[asyncTest()](http://docs.jquery.com/QUnit/asyncTest)**。根据文档“*异步测试排队并一个接一个地运行。相当于调用正常的 test() 并立即调用 stop()。* ”

```
asyncTest("a test", function() {
  $.ajax({
    url: 'Sample.asmx/Service',
    success: function(d,s,x) {
      ok(true, "asynchronous PASS!");
      start();
    }
  });
}); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-15T12:49:39.757

我的项目中有很多 qunit 测试。像：

```
 module("comment");
    asyncTest("comment1", function() {
      expect(6);
      $.ajax({
        url: 'http://xxx.com/comment',
        dataType: "json",
        type: "GET",
        timeout: 1000
      }).done(function(data) {
        ok(true, "loaded");
        ok(data.data.length>1, "array size");
        ok(data.total, "attr total");
        var c = data.data[0];
        ok(c.id, "attr c.id");
        ok(c.user_id, "attr c.user_id");
        ok(c.type == 4, "attr c.type equal 4");
      }).fail(function(x, text, thrown) {
        ok(false, "ajax failed: " + text);
      }).always(function(){
        start();
      });
    }); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-02T18:44:14.590

我用 ajax 做了一些 qunit 测试。它不漂亮。我能想到的最好的事情是在触发 ajax 时停止测试，并在成功回调中再次启动它。（使用 start() 和 stop()）方法。这意味着一次只有一个 ajax 请求，但我可以忍受。祝你好运

# tree - 关于如何实现具有周期性限制的四叉树的任何参考资料？

> ID：941135
> 
> 赞同：0
> 
> 时间：2009-06-02T18:28:38.050
> 
> 标签：tree, spatial, neighbours

我有空间数据 - 平面上的 (x, y) 点 - 我正在使用四叉树对其进行分区。这个想法是找出哪些点是给定（a，b）点的邻居。如果两个点之间有一些（比如 L）距离，则这些点是邻居。问题是空间是周期性的，也就是说，如果一个点非常靠近边缘（< L），这个点应该是靠近对边的一个点的邻居。（在这种情况下，周期性是指飞机重复自身）

```
|=================== | ===================|
|(a, b)         (c,d)| (a, b)      (c,d)  |
|                    |                    |
|  (e,f)             |   (e, f)           |
|               (h,i)|               (h,i)|
|=================== | ===================|
|(a, b)         (c,d)| (a, b)      (c,d)  |
|                    |                    |
|  (e,f)             |   (e, f)           |
|               (h,i)|               (h,i)|
| ================== | ===================| 
```

即点 (a,b) 和 (c, d) 和 (h, i) 应该是邻居。(a,b) 的邻居是半径为 L 且中心为 (a,b) 的圆内的点。

论文，方法都是受欢迎的。

谢谢，

* * *

伙计们：

感谢您的回答，我有一段时间没有检查 stackoverflow 正忙于另一个项目将立即检查您的答案！非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T18:57:00.040

为什么不将您的“搜索圈”拆分为具有 pi/2 角度的饼图？让我们看看我是否可以通过文本和简单的图像来解决这个问题。

[替代文字 http://img168.imageshack.us/img168/8426/circleinquarters.gif](http://img168.imageshack.us/img168/8426/circleinquarters.gif)

这个想法是将“圆形搜索”视为四个“饼图”，因此当您使用 C(a, b, L) 进行搜索时，您需要考虑到在四叉树中向下传递时，圆形不会t 仅与四叉树的左上角相交，因此在这种情况下，您必须向下分支为四个分支（如果该区域不是周期性的，则不仅仅是一个）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T18:55:40.447

```
xdist = min( (x1-x2) % px, (x2-x1) % px ) 
```

其中 px 是 x 周期。

ydist，其余的留给读者练习:-)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T19:01:49.360

保持四叉树原样似乎更简单，因为只有根级别会定期复制。考虑到周期性，`(x+i*dx,y+j*dy,L)`对每个请求执行多个请求`(x,y,L)`。在 i,j 上循环，使得查询盘与树的根节点相交。

# asp.net - SSRS 2005 报告功能

> ID：941143
> 
> 赞同：0
> 
> 时间：2009-06-02T18:30:20.450
> 
> 标签：asp.net, reporting-services, reportingservices-2005, page-lifecycle

在 SSRS 2005（和我想象的 2008 年）中，您可以为报表提供功能，如果我没记错的话，还可以提供整个程序集，这允许您在呈现报表之前执行某种类型的工作。

有谁知道这个函数是在 ASP.NET 页面生命周期的哪个阶段编译和/或执行的？

我倾向于认为它是在 On_Render 上执行的，但这显然只是一个猜测。

有没有人有任何见解，并且 SSRS 2008 报告相同的功能，如果是，在什么时候执行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-07T20:44:24.067

自定义代码和报表程序集在报表的生命周期中编译，而不必在页面的生命周期中编译。

这意味着，在通常的异步和远程处理情况下，它发生在报表服务器上，在您的页面被呈现并发送到浏览器之后。

通过使用 Reflector，我猜想当不使用异步处理时，它发生在 PreRender 期间。

如果您的自定义报表程序集需要的不仅仅是执行权限，请确保在报表服务器上以适当的权限部署它们，或者如果在本地处理，请调用 AddTrustedCodeModuleInCurrentAppDomain 方法。

# c# - C# WinForm的DataGridView数据转html

> ID：941146
> 
> 赞同：0
> 
> 时间：2009-06-02T18:30:30.637
> 
> 标签：c#

一些数据显示在 datagridview (Winform) 中。我需要以类似的格式（行、列等）邮寄 datagridview 中表示的表格。最简单的是我能做到吗？如何将其转换为带有列标题的 html 表并保留列宽。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T18:32:59.633

我不知道是否可以进行任何框架级别的转换。但是遍历网格行和单元格并在 HTML 中重新创建它并使用 Width 应该是一件非常简单的事情。

*即兴写作，请原谅它的不完整和任何简单的错误，但我想你可以在这里得到基本的想法。*

```
StringBuilder sb = new SringBuilder();

sb.AppendLine("<table>");
sb.AppendLine("  <tr>");
foreach(DataGridViewColumn column in grid.Columns)
{
  sb.AppendLine("    <td>" + column.HeaderText + "</td>");
}
sb.AppendLine("  </tr>");    

foreach(DataGridViewRow row in grid.Rows)
{
  sb.AppendLine("  <tr>");
  foreach(DataGridViewCell cell in row.Cells)
  {
    sb.AppendLine("    <td width=\"" + cell.Width + "px\">" + cell.Value + "</td>");
  }
  sb.AppendLine("  </tr>");
}
sb.AppendLine("</table>"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T18:42:51.643

我想如果你搜索你会在网上找到这个

如果你不...

```
Do the following 
1\. Create a stringbuilder, wrap it with htmlTextWriter
2\. Create a htmltable, add a header row, 
3\. Iterate through the gridheaders and add cells, write the width in attributes, write other stuff like font, fontsize, forecolor, backcolor etc if you want
4\. Next iterate through the grid rows, add a row each time to table, add cells to row for each grid cells
5\. Call the render method passing the html writer
6\. Take the string builder out and you have a html table layout output. 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T18:44:10.407

快速谷歌搜索产生了这个：[如何通过电子邮件发送 DataGridView 内容](http://www.codeproject.com/KB/grid/Send_DataGridView_Mail.aspx)。它包括将 DGV 转换为 HTML 表格并邮寄。

# .net - 如何部署 SQL 和附加数据库：使用 ClickOnce？

> ID：941149
> 
> 赞同：0
> 
> 时间：2009-06-02T18:31:14.287
> 
> 标签：.net, winforms, sql-server-2005, deployment, clickonce

我需要部署一个使用多个数据库的 winform 应用程序。当它们在本地交互时，我需要将它们与我的应用程序一起部署。

我可以使用 ClickOnce 还是应该考虑不同的方法？我为 ClickOnce 找到了几个示例，但他们都假设数据库包含在解决方案中，但这里不是这种情况。

这个应用程序曾经是一个网络应用程序，数据库和 DAL 反映了这一点。我还在使用将这些本地数据库合并到中央数据库的合并复制。

我最好的方法是编写数据库创建脚本并在安装过程中以某种方式运行它们，然后启动合并复制以填充表？数据库还包含 100 多个存储过程，这些存储过程并不总是与 Merge Repl 配合得很好，因此我还需要能够在初始安装中包含这些存储过程。

否则，我想我可能会弄清楚如何在安装过程中附加数据库，其中包括存储过程，但我也不知道该怎么做。

我对所有关于如何使用它的 4 个单独的 SQL DB 部署此应用程序的建议持开放态度。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T19:05:31.380

如果您在本地使用 SQL Express，则可以将数据库作为连接字符串的一部分附加，但我不知道这对复制是否有好处。您可能会考虑将数据库附加到本地，并在其中放置一个包含数据库版本号的修订表。然后可以编写您的应用程序来检查数据库的版本并运行 SQL 脚本以将数据库升级到最新版本。这就是 DotNetNuke 执行滚动升级的方式。您只需为每个版本维护一个特定于版本的 .SQL 文件，并将它们包含在单击一次部署文件中。通过这种方式，您可以前滚任何错过的修订以到达数据库的最终修订。

* * *

在伪代码中，它将类似于：

```
 Check the database version in Revision Table
     If less than current version
        Load SQL file list from path
            Foreach file with revision > current Revision
               Execute TSQL Scripts 
```

每个 TSQL 脚本都会在应用时更新数据库中的修订号。当然，这需要花费大量时间来实施，但是当它滚动时，它可以很好地解决您的问题。

# javascript - 在图像的特定部分触发事件

> ID：941150
> 
> 赞同：1
> 
> 时间：2009-06-02T18:31:14.350
> 
> 标签：javascript, dom, animation

我想在用户悬停在图像的特定部分时触发事件处理程序，例如图像的中心或图像的右侧（例如，大约 100 个像素）。我没有使用任何框架，所以这是我正在使用的普通 javascript。我不确定使用图像映射是否可行。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T18:38:30.733

[关于鼠标位置的 Quirksmode](http://www.quirksmode.org/js/events_properties.html#position)

鉴于这里涉及的疯狂，我会：

1.  使用框架（我刚刚用 Mootools 做了类似的事情）
2.  将绝对定位的 div 放在图像上并在其上而不是图像上监听事件（最近也这样做了，左 50% 和右 50%，比跟踪鼠标位置更方便）。

或者去做吧，quirksmode 提供了一个不错的函数来获取鼠标位置，然后您需要计算图像的位置，然后进行数学运算以获取鼠标在图像上的位置，在鼠标悬停时进行数学运算图像事件，然后不断检查该位置是否符合您的标准，然后在满足时对其进行处理:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T18:38:29.420

您可以使用 MouseMove 事件找出光标的位置，然后实现您自己的逻辑来计算该位置相对于图像的位置。

有关获取鼠标坐标的信息，请参阅[此页面。](http://snippets.dzone.com/posts/show/5264)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T18:39:12.900

我不知道你需要多少区域，是否需要特别塑造或类似的东西....

一个简单的解决方案是将（CSS）空 div 元素“放在”将触发事件的图像上

afaik 无法使用图像映射触发 js 事件

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T18:46:59.000

我建议在图像`div`中要检查的地方放置一个不可见`mouse_over`的。（如果您想要的区域当然是矩形）。`mouse_over`然后为此触发`div`。

如果您想检查非矩形区域（不能是 a `div`），我建议您将`div`图像大小相同的 a 放在它上面。检查鼠标位置`div`，并使用它与蒙版图像进行比较。

### 例子：

```
MousePosOnGhostDiv_X = 76;
MousePosOnGhostDiv_Y = 145;

if(CheckColorOfMaskImage(MousePosOnGhostDiv_X,MousePosOnGhostDiv_Y)=="orange") do something. 
```

通过知道遮罩图像上的颜色，您可以设置多个事件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T18:58:55.993

与 jquery 相结合的图像映射是我以前使用过的一个很好的解决方案。我看到您没有使用框架，但值得一看。

这是我在图像映射和 mouseenter / mouseleave 事件中使用的一小段代码。

```
$(".map-areas area")
.mouseenter(function() {
    idx = $(".map-areas area").index(this);
    showMapArea(idx);
})
.mouseleave(function() {
    $(".map-hovers img").hide();
    $(".map-titles img").hide();
}); 
```

# c# - A类建模/设计查询

> ID：941153
> 
> 赞同：3
> 
> 时间：2009-06-02T18:32:07.357
> 
> 标签：c#, database-design, oop, class-design, cyclic-reference

我将如何模拟这种情况？数据库应该如何设计？我应该上什么课？

**问题陈述：**每个员工至少属于一个项目，每个项目有很多任务，每个任务至少分配给一个员工。

我应该能够生产出来

*   从事项目工作的员工。
*   属于项目的任务
*   给定员工正在执行的任务。

ETC...

循环/循环关系是一个糟糕的设计，可以消除吗？

数据库中的实体应该如何表示？应该如何使用类来表示实体？

提前致谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T19:42:26.250

您没有提及任何有关性能或使用要求的内容，因此我将以通用方式回答，如果您需要更具体的信息，我会更新我的答案。对于 DB 表，我建议按照这些思路采用一种通用的规范化方法。

```
tblProject
    ProjectID
    ProjectDescription etc.

tblTask
    TaskID
    TaskDescription etc.

tblEmployee
    EmployeeID
    Name etc.

tblProjectTasks
    ProjectTasksID
    ProjectID
    TaskID

tblTaskAssignments
    TaskAssignmentsID
    TaskID
    EmployeeID 
```

另一种有效的方法是创建一个定义项目的表和一个不同的表来定义项目列表。任务和员工也是如此。在现实世界的应用程序中，这些实体通常会在更通用的表中得到很好的定义，就像您可以设计一个包含其他明确定义的对象的类一样。例如，您没有提及员工以外的项目资源。这些资源可以在定义资源类型、资源属性等的模式中表示，然后将资源加入项目和/或任务。

您还可以创建一个表示项目员工的表，但其中的数据将是多余的，因为您可以通过连接其他表来找到分配给项目的员工。恕我直言，这种重复只有在表很大并且这种特殊类型的查询被非常频繁地使用的情况下才会被保证。但我仍然会首先考虑其他方法。

您还询问了课程。如果没有更好地了解您的目标，就很难过于具体。在典型的 OO 设计中，这些类应该清楚地表示项目、任务和员工。但是您需要对其进行定制以适应您的特定需求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T20:29:20.243

我将尝试以尽可能通用的方式回答您的问题，并避免像以前的回复中那样重复特定的表格结构。一般来说，实体之间的循环关系并不是一件坏事……相反，它们很常见：

```
There are many Projects
Projects have Employees
Projects have Tasks
Employees are assigned some Tasks 
```

虽然一个项目有员工......并且员工也有一个项目（或者，如果员工一次可以处理多个项目，则可能有多个项目）。从数据库的角度来看，当您创建外键时，无论您是否愿意，这种“循环”关系都存在。

更重要的问题是，从概念的角度来看，员工是否知道自己参与的项目是否重要？虽然项目知道员工在做什么可能非常重要......但员工知道其工作的项目可能并不重要。这就是所谓的“可导航性”，与我们的数据库结构不同，我们可以用我们的类来控制它。Project 对象将具有 Employee 对象的集合，但 Employee 对象不一定需要具有 Project 属性（或 Projects 的集合。）

关于可导航性，我无法给你一个固定的答案。这通常是主观的，取决于您的业务需求。如果您的建模业务具有员工知道他们正在从事哪些项目的概念，并且该知识对于完成您的业务逻辑将执行的流程很重要......那么您需要这种循环关系。员工与任务、项目与任务等之间的可导航性也是如此。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T19:08:35.540

从数据库开始，然后从那里开始工作。我需要更多信息来推荐一个类结构。您想要/需要为员工提供物品吗？或者它们会成为项目的财产吗？ETC..

数据库设计：

```
Projects
    ProjectID
    ProjectName...
    EmployeeID

Tasks
    TaskID
    ProjectID
    TaskName...
    EmployeeID

Employees
    EmployeeID
    EmployeeName... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T20:09:34.853

我会为数据库设计做这样的事情：

```
 Create Table Projects
(
    ProjectID int Identity(1,1),
    ProjectName varchar(50) Primary Key NonClustered,
    OtherStuff varchar(255)
)
CREATE CLUSTERED INDEX IX_PROJECTS_ID ON dbo.Projects(ProjectID)

Create Table Employees
(
    EmployeeID int Identity(1,1),
    EmployeeName varchar(50) Primary Key NonClustered,
)
CREATE CLUSTERED INDEX IX_EMPLOYEES_ID ON dbo.Employees(EmployeeID)

Create Table ProjectEmployees
(
    ProjectID int,
    EmployeeID int,
    Constraint pk_ProjectEmpoyees Primary Key (ProjectID, EmployeeID)
)

Create Table Tasks
(
    TaskID int Identity(1,1),
    TaskName varchar(50) Primary Key NonClustered,
    AssignedEmployeeID int, --NOTE: assumes only 1 employee per task
    OtherStuff varchar(255)
)
CREATE CLUSTERED INDEX IX_TASKS_ID ON dbo.Tasks(TaskID)

Create Table TaskPrecedents
(
    TaskID int,
    PrecedentTaskID int,
    PrecedentType Char(2)   --Codes, you'll have to work these out
    Constraint pk_TaskPrecedents Primary Key (TaskID, PrecedentTaskID)
) 
```

# php - Yii 框架在 PHP 世界中的表现如何？最近的任何好的或坏的经历

> ID：941164
> 
> 赞同：3
> 
> 时间：2009-06-02T18:34:44.483
> 
> 标签：php, frameworks

我个人喜欢它提供的许多功能。我已经看到了一些问题，但它们已经很老了，所以想从使用它或计划使用它的人那里收集一些回复。如果您打算使用，您是如何得出这个框架的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T18:44:10.860

就个人而言，我厌倦了看到这么多新框架。PHP 社区开发 YAF 的趋势达到了荒谬的程度——现在有多少——超过两打？

我知道人们可能想要在框架项目上工作的挑战，或者不喜欢当前可用的东西，所以他们开始创建一个新的。

但你知道吗？我认为现在是停止创建新框架的时候了——而是选择一个[成熟](http://www.symfony-project.org)[的](http://framework.zend.com/) [框架并](http://cakephp.org/)[成为](http://kohanaphp.com/)贡献者。

对不起，我知道这真的不能回答你的问题，但我会毫不掩饰地在你的问题中窃取空间来进行一次小型咆哮；）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-19T17:19:07.317

这一切都取决于。该项目的意义何在？

如果要对雇主更具吸引力，请弄清楚您所在地区的团队正在使用哪些团队，并使用该框架。Cake 和 Zend 似乎分别受到大小商店的欢迎。

如果要学习 PHP，最好从头开始编写自己的代码。这迫使你真正了解你在每一个转折点都在做什么。我建议先编写代码测试。

如果您只需要完成一些工作，请使用您最了解的工具，如果它们适合手头的问题。

IMO，如果我有兴趣尝试另一个框架，我会使用 Yii。浏览源代码一两分钟后，Yii 似乎有相当不错的测试和测试覆盖率，这让我更加信任代码，并提供了如何使用 API 的工作示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-02-22T13:04:46.830

Yii 很有趣，但我强烈建议，如果你想做一些重要的事情，或者它会花费你很多钱，首先阅读一些关于 Rails（以及 Groovy 等衍生产品）和 Django 的书籍。这些正在为今天的可能性和框架必须提供的内容设定标准 - 许多开发人员不花时间，这将是一项非常好的投资，以了解已经存在的问题和解决方案 - 有很多在这些事情上的智慧，你将有一个更好的基础来决定自己。

关于 yii：从我看到的内容中我了解到，现在你期望从一个框架中获得的许多功能都没有在 yii 中。它看起来更像是一个个人项目，我认为许多使用它的人甚至都不知道，缺少一些东西......

# emacs - 在 emacs 中，如何仅突出显示当前帧中的当前行？

> ID：941166
> 
> 赞同：4
> 
> 时间：2009-06-02T18:34:59.257
> 
> 标签：emacs, elisp

在 Emacs（Mac Leopard 上为 23）中，我发现了如何使用 hl-line-mode 突出显示当前行，但是当在所有缓冲区中全局使用它时，它会突出显示所有帧中所有缓冲区中的当前行。

我希望能够仅在当前活动的缓冲区中突出显示当前行（或至少有不同的面）。我确信这在某种程度上必须是可能的，因为光标的变化取决于缓冲区是否是当前缓冲区。

谢谢

单调

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T19:08:14.820

查看 的文档`hl-line-mode`，看来您可能已`hl-line-sticky-flag`打开该变量。尝试

```
C-h v hl-line-sticky-flag 
```

查看它是否为非零，如果是，则添加

```
(setq hl-line-sticky-flag nil) 
```

到你的 .emacs。

# jquery - 可以让 Excanvas 在 IE 8 中工作吗？

> ID：941170
> 
> 赞同：18
> 
> 时间：2009-06-02T18:35:29.193
> 
> 标签：jquery, internet-explorer-8, canvas, excanvas, beautytips

我曾经在一个名为“BeautyTips”的 jQuery 插件上工作，它工作得很好。但是，由于我安装了 IE 8，这个插件停止工作，因为它需要 Excanvas 来让 IE 绘制矢量、图像等。

我试图下载较新版本的 Excanvas，但它根本不工作......

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-02T18:56:20.400

IE8 的新“标准”模式关闭了一些非标准功能。其中VML，就是excanvas使用的。我刚刚设置为 IE7 的“标准”模式，所以它仍然有效。

```
<meta http-equiv="X-UA-Compatible" content="IE=7" /> 
```

令人沮丧，但我不知道 IE8 带来的任何优势。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-11-16T08:08:12.303

是的，我已经让 excanvas 在 IE8 标准模式下工作（仅针对我们需要的用途进行了测试）。在函数**CanvasRenderingContext2D_**我注释掉了这一行：

`//el.style.overflow = 'hidden';//fix IE8`

节点对象 el 的宽度和高度为 0px x 0px，因此不将溢出设置为隐藏会使渲染的项目可见。

我确实稍微更改了**canvasPieTimer**的创建顺序，以获得所需的结果。我希望这是有帮助的。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-12-03T19:02:31.477

在使用 excanvas 初始化之前尝试将 canvas 元素附加到文档：

```
var foo = document.getElementById("targetElementID");
var canvas = document.createElement('canvas');
canvas.setAttribute("width", 620);
canvas.setAttribute("height", 310);
canvas.setAttribute("class", "mapping");
foo.appendChild(canvas);
canvas = G_vmlCanvasManager.initElement(canvas); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-02T22:05:00.487

你确定你安装了最新版本的 excanvas.js 吗？（2009 年 3 月发布，托管在新的 Google 代码项目页面上）

我在 IE8 和 AFAIK 中使用了 Beauty Tips 插件，它在 IE8 本机模式下工作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-19T22:56:42.730

最新的 bt 插件版本为我解决了这个问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-07-20T18:38:25.570

使用 jquery 将 canvas 标记附加为 html 字符串不适用于新版本的 excanvas。您必须先使用 document.createElement('canvas') 。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-08-24T12:08:02.973

如果有人仍然有这个问题：Beauty Tips 0.9.5 版修复了这个问题。但是，如果您必须使用早期版本（就像我一样，因为新版本在我的页面中引入了提示被提前关闭的问题），您应该将第 530 行替换为以下行：

```
var canvas = document.createElement('canvas');  
$(canvas).attr('width', (numb($text.btOuterWidth(true)) + opts.strokeWidth*2)).attr('height', (numb($text.outerHeight(true)) + opts.strokeWidth*2)).appendTo($box).css({position: 'absolute', top: $text.btPosition().top, left: $text.btPosition().left, zIndex: opts.boxzIndex}); 
```

希望能帮助到你。

# java - 推荐用于 Java、Hibernate 和 Spring 的记录器

> ID：941172
> 
> 赞同：7
> 
> 时间：2009-06-02T18:36:13.060
> 
> 标签：java, hibernate, spring, logging, jpa

我的 Web 应用程序使用 Java、Hibernate 的 JPA 实现 (EntityManager) 和 Spring。我的记录器选择是什么，你会推荐什么。理想情况下，配置会很简单（Hibernate、Spring 和我的代码的一个配置文件）。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-02T18:44:21.750

在使用各种框架构建应用程序时，您通常需要包装现有的记录器，无论是 log4j 还是 JUL 或 JULI 等等。用于此的标准应用程序是[Java 的 Simple Logging Facade (SLF4J)](http://www.slf4j.org/)。即使您的应用程序现在不需要 SLF4J，您以后可能想要添加一个确实需要它的库，从长远来看，这是您对一个配置文件的最大希望。

考虑到这一点，您应该坚持使用 SLF4J 支持的日志记录包，但通常归结为 java.util.logging (JUL) 或 Apache 的 log4j。这一直是一个[争论的话题](http://java.sys-con.com/node/48541?page=0,0)，你可以在双方找到很多意见。

就个人而言，我认为 Java 日志记录在[这种情况下](https://stackoverflow.com/questions/354837/whats-up-with-logging-in-java)是不幸的，我将使用任何给我带来最小痛苦的情况。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-02T18:39:37.250

[log4j](http://logging.apache.org/log4j/1.2/index.html)是我使用的标准记录器。您可以按包配置日志记录级别和日志文件，以便 Hibernate、Spring 和您的代码可以各自转到自己的日志文件。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-02T18:44:41.017

没有人因为选择 log4j 而被解雇。

另请查看 slf4j。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-03T14:57:27.197

Hibernate 已经依赖于 SLF4J。除非我弄错了，当前版本的 Spring 依赖于 commons-logging，但下一个版本也将使用 SLF4J。无论如何，您可以[通过 SLF4J 整合所有日志记录](http://slf4j.org/legacy.html)（参见 jcl-over-slf4j.jar 部分）。完成后，您可以选择 java.util.logging、log4j 或 logback 中的任何一个作为您的底层日志记录框架。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-02T18:42:14.483

我使用带有 log4j 配置文件的[Apache Commons Logging](http://commons.apache.org/logging/) api（log4j 配置文件很简单，新手很容易理解，并且有许多示例可供参考。

我更喜欢使用公共日志记录 API，因为它不知道它的配置文件。它可以通过文件格式配置为任意数量的流行日志包。

这是一个简单的 log4j 设置，它将打印出您自己的包的调试信息、spring 和 hibernate 的 INFO 级别以及其他所有内容的 WARN：

```
# Global logging configuration
log4j.rootLogger=WARN, stdout
log4j.category.org.mydomain.org=DEBUG
log4j.category.org.hibernate=INFO
log4j.category.org.springframework=INFO

# CONSOLE appender not used by default
log4j.appender.stdout=org.apache.log4j.ConsoleAppender
log4j.appender.stdout.layout=org.apache.log4j.PatternLayout
log4j.appender.stdout.layout.ConversionPattern=%d %-5p [%t] %c - %m%n 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-03T18:53:16.890

一般来说，Commons Logging 对 Web 应用程序（和独立应用程序）来说是不必要的，也是一个糟糕的选择。关于原因的一些好文章：

[在采用 commons-logging API 之前请三思](http://www.qos.ch/logging/thinkAgain.jsp)

[Commons Logging 是我的错](http://radio.weblogs.com/0122027/2003/08/15.html)

# autosuggest - 如何获取智能建议列表的数据？

> ID：941173
> 
> 赞同：2
> 
> 时间：2009-06-02T18:36:13.093
> 
> 标签：autosuggest, inference

我想建立一个建议列表，当我输入“PHP”时它知道建议“Web 开发”，如果我输入“数据恢复”或“软件安装”，它会建议“信息技术”。

我确信我可以为此制定一个数据库模式，但是我从哪里获取数据呢？如示例所示，系统将如何学习将“PHP”链接到“Web 开发”以及将“数据恢复”链接到“信息技术”？我不想手动执行此操作。

我能以某种方式利用社区的意见吗？我通过 last.fm 收集到，该网站查看用户听过的给定艺术家（例如，他们听得最多的那个），当他们也有给定的艺术家时，发现他们的图书馆中最常见的其他艺术家用户在他们的图书馆里，并向我推荐了最高关联的艺术家。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T18:44:04.463

关键字链接。

当您搜索某些术语时，请记下所选结果并将任何其他关键字添加到建议中。（或者至少记下它们并增加它们与这些术语的相关性。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T18:42:39.087

就存储信息而言，关系数据库将为您提供所需内容的基础知识。至于确定关系本身，我会建议一些有助于填充数据库的跟踪和学习算法。我还会跟踪特定关系的点击次数，以便提供与关系的相关性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T18:44:07.583

我认为，您可以使用共现来生成建议信息。要检索信息，您可以使用 DBpedia 或 Faviki 的一些想法......

# iphone - 在 iPhone 上的键盘外观上上下滚动整个视图

> ID：941185
> 
> 赞同：0
> 
> 时间：2009-06-02T18:38:57.453
> 
> 标签：iphone

如何在 iPhone 上的键盘出现/消失时上下滚动整个视图？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T22:27:25.293

查看 UICatalog 示例项目。TextFieldController.m - 函数 - (void)keyboardWillShow:(NSNotification *)notif 它确实回答了你的问题。

# apache-flex - Flex 中两个不同的 HTTPService 类

> ID：941200
> 
> 赞同：5
> 
> 时间：2009-06-02T18:42:33.907
> 
> 标签：apache-flex, httpservice

为什么 Flex 中有两个不同的 HTTPService 类？ [这个](http://livedocs.adobe.com/flex/2/langref/mx/rpc/http/HTTPService.html) 和 [这个](http://livedocs.adobe.com/flex/2/langref/mx/rpc/http/mxml/HTTPService.html)

第二个继承了第一个。为什么不能有一个课程将两者结合起来？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T18:47:25.270

其中一个对象（您发布的第一个链接）是 HTTPService 对象本身。

第二个是包装 HTTPService 对象并为其提供 <mxml /> 标记的附加功能的对象。

这两者可能没有结合起来，因为您不一定每次需要 HTTService 对象时都需要实现 IMXMLObject 和 IMXMLSupport 接口。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T18:50:57.727

mx.rpc.http.mxml.HTTPService 也可以处理并发，而另一个不能。

编辑：

尽管在在线文档中我认为并发性是两者的属性，但有几个消息来源说那不是真的（当我第一次尝试使用它时，我的测试不起作用）。此外，并发包仅导入 mxml.HTTPService，而不是基础 rpc 类。

[文档页面上的](http://livedocs.adobe.com/flex/3/html/help.html?content=data_access_2.html)[错误评论调解人评论](https://bugs.adobe.com/jira/browse/FLEXDOCS-217)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-02-04T01:21:36.770

URLLoader 类中似乎有更多的错误处理功能。不过，使用 MXML 创建 HTTPService 并没有太大区别。

```
// ActionScript Style
private function myService():void {
   var service:HTTPService = new HTTPService();
...service.parameters = value;...
   service.send();
} 
```

或者

```
< !-- MXML Style -- >
< mx:HTTPService >
...< parameters >...
< /mx:HTTPService > 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-03T05:18:34.037

第一个是 mx.rpc.http 包的成员，用于 ActionScript 代码。HTTPService 类的另一个版本是第一个版本的子类，并且是 mx.rpc.http.mxml 包的成员。这是您在使用标记实例化对象时使用的版本。

这些版本几乎相同，但有两个显着差异：只有 MXML 版本实现了 showBusyCursor 属性，它会在 HTTPService 请求/响应周期期间显示动画光标顶部，以及并发属性，它确定多个并发请求如何处理相同的网络资源。

在 ActionScript 中通常使用的 HTTPService 类版本中没有实现 concurrency 属性，因为在使用 ActionScript 时，您通常会为每个新请求创建一个新的 HTTPService 对象。

*资料来源：Adobe Flex 3 圣经 - David Gassner*

# jquery - jQuery在div标签内添加图像

> ID：941206
> 
> 赞同：161
> 
> 时间：2009-06-02T18:43:47.600
> 
> 标签：jquery

我有一个 div 标签

```
<div id="theDiv">Where is the image?</div> 
```

我想在 div 中添加一个图像标签

最终结果：

```
<div id="theDiv"><img id="theImg"  src="theImg.png" />Where is the image?</div> 
```

* * *

## 回答 #1

> 赞同：321
> 
> 时间：2009-06-02T18:48:19.603

您是否尝试过以下方法：

```
$('#theDiv').prepend('<img id="theImg" src="theImg.png" />') 
```

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2014-03-30T20:56:59.397

我的 2 美分：

```
$('#theDiv').prepend($('<img>',{id:'theImg',src:'theImg.png'})) 
```

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2009-06-02T18:48:50.337

```
$("#theDiv").append("<img id='theImg' src='theImg.png'/>"); 
```

您需要阅读[此处](http://docs.jquery.com)的文档。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2014-09-19T07:08:58.550

如果我们想在调用`<div>`函数时更改标签的内容`image()`，我们必须这样做：

**Javascript**

```
function image() {
    var img = document.createElement("IMG");
    img.src = "/images/img1.gif";
    $('#image').html(img); 
} 
```

**HTML**

```
<div id="image"></div>
<div><a href="javascript:image();">First Image</a></div> 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2015-06-10T12:15:25.590

除了 Manjeet Kumar 的帖子（他没有声明）

```
var image = document.createElement("IMG");
image.alt = "Alt information for image";
image.setAttribute('class', 'photo');
image.src="/images/abc.jpg";
$("#TheDiv").html(image); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-07-28T10:15:22.333

```
var img;
for (var i = 0; i < jQuery('.MulImage').length; i++) {
                var imgsrc = jQuery('.MulImage')[i];
                var CurrentImgSrc = imgsrc.src;
                img = jQuery('<img class="dynamic" style="width:100%;">');
                img.attr('src', CurrentImgSrc);
                jQuery('.YourDivClass').append(img);

            } 
```

# php - 隐式转换为字符串而不是获取“对象 ID #..”

> ID：941214
> 
> 赞同：0
> 
> 时间：2009-06-02T18:44:13.747
> 
> 标签：php, string, object, casting, tostring

如果我们有 php 5.1 而不是我一直使用的 5.2，我已经搬到了一个新的虚拟主机上。我仍然没有弄清楚这是一个php版本还是配置问题。

现在大多数（或所有）具有 __toString 函数的类都转换为“Object ID #”（如 php4 中），但在它们都返回正确值之前。

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T18:51:57.443

显然，在 PHP 5.2 之前，该`__toString`方法只是在某些情况下“神奇地”调用（例如`echo()`和`print()`）。因此，如果您当前`__toString()`在直接输出功能之外以“神奇”的方式使用它，它将无法按预期工作。

[来源](http://framework.zend.com/issues/browse/ZF-5077)：

> 值得注意的是，在 PHP 5.2.0 之前，该方法仅在直接与or`__toString`结合时才被调用。自 PHP 5.2.0 起，它在任何字符串上下文中被调用（例如在with 修饰符中），但不在其他类型的上下文中（例如 with修饰符）。自 PHP 5.2.0 起，将没有方法的对象转换为字符串会导致.`echo()``print()``printf()``%s``%d``__toString``E_RECOVERABLE_ERROR`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T18:55:51.493

一些主机公司（如 1and1）同时运行 PHP 4.x 和 5.x，默认为 4.x。您可能需要一个 .htaccess 文件来确保您使用的是正确版本的 PHP。

此外，根据[文档](http://www.php.net/manual/en/language.oop5.magic.php)，魔术 __toString() 与 5.2+ 版本略有不同：

> 值得注意的是，在 PHP 5.2.0 之前，__toString 方法只有在直接与 echo() 或 print() 结合时才会被调用。自 PHP 5.2.0 起，它在任何字符串上下文中调用（例如在 printf() 中使用 %s 修饰符），但不在其他类型上下文中调用（例如使用 %d 修饰符）。自 PHP 5.2.0 起，将没有 __toString 方法的对象转换为字符串会导致 E_RECOVERABLE_ERROR。

因此，这可能取决于您如何调用输出。

# php - Zend 中的 Action View Helper - 解决方法？

> ID：941216
> 
> 赞同：10
> 
> 时间：2009-06-02T18:44:17.523
> 
> 标签：php, model-view-controller, zend-framework, zend-form

我正在构建一个界面，我想将其用作“选项卡式浏览”之类的功能。这些选项卡中的每一个都已编写为一个操作，并且选项卡式界面可以作为指向各个选项卡的链接正常工作。我决定尝试为这个控制器编写“索引”页面——将所有选项卡的内容放入隐藏的 div 中并使用 jQuery 在它们之间进行交换，但是一旦我开始使用动作视图助手——我遇到了很多人说这是不好的做法。（[见这篇文章](http://tinyurl.com/actionstack)）

其中一些操作会构建表单 - 从模型中获取一些数据等以显示。我希望每个动作都能继续独立运行（一些解析形式也是如此）。

浏览到 /item 应该会为您提供选项卡式菜单，以及隐藏标记中的所有 div 内容 - 其中 /item/tab2 是特定操作（例如表单提交）。

另一个并发症/警告 - 如果用户无权访问该“选项卡”，某些操作将引发访问异常。我不希望两次在系统中建立访问检查（因此显示一个内容为空的选项卡）。

我只是想弄清楚处理这类事情的最佳做法是什么，我认为动作助手可能就是它。如果我尝试使用 View Helpers - 我开始怀疑这是否是组装 Zend_Form 的正确位置。

有没有人对不使用的“正确”解决方法有任何建议`Zend_View_Helper_Action`？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-07-28T12:03:59.627

正如我在您引用的文章中所述，解决操作视图助手的正确方法是创建直接访问模型以获取所需数据的部分。这可以通过视图助手（您自己制作；））如果这会在您的视图中涉及很多逻辑。

action view helper 不仅受到性能问题的困扰，而且还制造了可怕的调试噩梦，如果你需要它，那么你的应用程序可能没有遵循 MVC，因此，你使用控制器来重用，而不是模型，这是模式意图。

You can render partials from within your layout or current actions view with the render or partial methods of the view object.

If you have multiple actions to deal with multiple possible posts from your tabs, then you should set all of these actions to render the same view script, which will then render all of the tabs with data direct from the model.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T21:07:58.333

如果您没有从现有标记生成选项卡/选项卡窗格，并且您正在按需加载内容，那么您只需在显示选项卡本身之前检查用户是否有权访问该选项卡，并在尝试加载选项卡的内容。

检查用户是否具有这些访问权限应该是一种可接受的操作模式，并且执行起来不应该很昂贵。

如果这些操作生成的内容除了选项卡之外，还可以在某些独立页面中使用，那么操作视图帮助程序是正确的继续方式。只需执行生成选项卡时在操作中执行的相同 ACL（或其他）检查。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-07T05:55:09.413

我不完全确定您的确切问题是什么，但是您可以禁用布局：

```
$this->_helper->layout->disableLayout(); 
```

然后请求的操作将只显示它的视图脚本，您可以将其加载到选项卡中。

您拥有的任何授权代码都将正常运行，您可以显示请求的操作视图脚本，或者不显示，这取决于他们是否有权访问。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-08T12:15:14.740

您可以使用 try/catch 块捕获任何访问异常：

```
try { // action throwing exceptions } catch (Exception $e) { // catch silently } 
```

# mysql - MySQL：找出一行添加到表中的日期？

> ID：941222
> 
> 赞同：13
> 
> 时间：2009-06-02T18:46:07.830
> 
> 标签：mysql

我在名为 price_request_date 的表中添加了一个新列，因为我现在需要跟踪每个列的制作日期。我这样做是为了让新人在插入新行时输入当前日期。我只是想知道是否有任何方法可以用输入的日期填写前几行？我不知道 MySQL 是否跟踪这类事情，但值得一问。谢谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-06-02T18:49:36.700

那没有。如果时间戳字段在创建时尚未设置，则无法使用原始创建日期自动回溯时间戳字段。

令人沮丧 - 我知道。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T18:50:38.663

不。最好总是在这样的表上包含 LastChgID 和 LastChgDate，下次从一开始就这样做......

# javascript - 从网络创建全屏幻灯片的最佳工具

> ID：941225
> 
> 赞同：1
> 
> 时间：2009-06-02T18:46:49.670
> 
> 标签：javascript, flash, image, slideshow

我需要创建一些可以全屏显示的图像的幻灯片，以便可以通过 S-Video 输出显示。

该软件是通过网络交付的，因此需要基于网络的选项。

图像列表是动态的，我想按顺序显示它们。照片列表可以在幻灯片运行时更改，我想将新照片添加到幻灯片中。

我看到两个选项：

1.  使用 JavaScript 构建它，然后使用浏览器插件来全屏显示。我有一个原型，但是它以随机顺序显示照片。

2.  使用 Flash 构建它。我对 Flash 一无所知，所以我正在寻找可以全屏显示的幻灯片。

什么是最好的？有没有好的、可定制的 Flash 幻灯片？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-30T21:18:18.833

对于那些感兴趣的人，我最终使用 HTML 和 JavaScript 制作了一个 Adob​​e AIR 应用程序。Adobe AIR 可以全屏显示，我能够利用我已经掌握的 HTML 和 JavaScript 知识。尽管对于原生 AIR 类以及如何使用它们有相当陡峭的学习曲线，但它的效果非常好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-30T21:20:29.373

如果您使用 Flash，[SlideShowPro](http://slideshowpro.net/)是一个不错的选择，您可能会从 ESPN 等网站认出。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T18:55:02.320

当您说“全屏”时，您的意思是占用整个屏幕吗？如果是这样，javascript 不是一个可以使用的工具，它必须存在于浏览器中，所以你总是可以从浏览器中看到一些 chrome。

另一方面，闪光灯可以做全屏。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T20:56:57.653

大多数浏览器允许您使用 F11 键（需要用户输入）全屏显示（甚至隐藏 chrome）。然后只需将javascript中的图像缩放到视口的大小即可。如果它不存在，它可以很容易地从一个预先存在的画廊脚本中编写出来。

另外，[这个答案可能会有所帮助](https://stackoverflow.com/questions/228377/could-a-website-force-the-browser-to-go-into-fullscreen-mode)

希望有帮助。

# variables - 在 SAS 中创建汇总变量的简单方法

> ID：941233
> 
> 赞同：1
> 
> 时间：2009-06-02T18:47:26.127
> 
> 标签：variables, sas, summary

我正在寻找一种在 SAS 中创建汇总变量的方法，该变量将自动添加每一行观察，直到满足条件。如有必要，我需要能够启动和停止并重置此变量。

非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T20:51:49.840

使用保留！

```
data test;
set test;
retain VarSummary;
VarSummary+YourVar;
if condition then VarSummary=SummatElse;
run; 
```

希望这是有道理的！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-04T15:39:33.253

如果您要使用类似的语句

```
VarSummary + 1  ; 
```

或者

```
VarSummary + <expression> ; 
```

那么您实际上不需要 RETAIN 语句。

此外，如果您在 DATA STEP 中使用 BY 语句，您可以访问变量 FIRST 和 LAST（数据必须按 BY 变量排序）。FIRST 和 LAST 的值为 1 或 0。当 BY 变量位于第一个值 FIRST 时。= 1 并且当它位于最后一个值 LAST 时。= 1。当只有1个byVariable记录时它们都可以等于1，当有2个以上的byVariable记录时它们都可以等于0（当在中间记录时）。

FIRST 和 LAST 可以帮助确定何时重置 RETAINed 变量。（FIRST 和 LAST 将在 PDV 中，但不会写入输出数据集，因此无需 DROP 删除它们）。

例子

（这个例子的结果可能会用一个 PROC 来完成，但我希望这能说明如何使用 FIRST 和 LAST）

```
proc sort data=sasuser.laguardia out=work.dest;
 by dest ;
run ;

data work.destination_summary (keep=dest dest_count total_count) ;
 set work.dest ;
 by dest ;

 total_count + 1 ;

 if first.dest then dest_count = 1 ;
 if not first.dest and not last.dest then dest_count + 1 ;
 if last.dest then do ;
  dest_count + 1 ;
  output ;
 end ;
run ;

proc print data=work.destination_summary label noobs ;
 var dest dest_count total_count;
 label Dest="Destination"
   dest_count="Count" 
   total_count= "Total Count";
run ; 
```

# sql - 使用 TSQL，我如何判断我的 CHAR 是否是序列中的最后一个？另外，如果字母序列从“z”“翻转”到“a”怎么办？

> ID：941234
> 
> 赞同：1
> 
> 时间：2009-06-02T18:47:30.260
> 
> 标签：sql, database, algorithm, tsql

假设我在 SQL Server 2005 中有下表：

```
id | Date | Letter
-----------------------------
01 | 5/1/2009 | W
02 | 5/1/2009 | X
03 | 5/1/2009 | Y
04 | 5/1/2009 | Z
05 | 5/1/2009 | A
06 | 5/1/2009 | B
07 | 5/1/2009 | D
08 | 5/1/2009 | E
09 | 5/2/2009 | W
10 | 5/2/2009 | X
11 | 5/2/2009 | Y
12 | 5/2/2009 | Z
13 | 5/2/2009 | A
14 | 5/2/2009 | B
15 | 5/2/2009 | C
16 | 5/2/2009 | D
17 | 5/3/2009 | W
18 | 5/3/2009 | X 
```

在我[之前的问题](https://stackoverflow.com/questions/938357/using-tsql-can-i-increment-a-char1-column-by-one-and-use-it-in-a-left-outer-jo/938371#938371)中，我询问了如何找出缺少哪个字母序列。在我的示例中，它会在第 6 行和第 7 行之间使用字母 C。我得到了以下答案，它在大多数情况下都有效：

```
SELECT * from TABLE1 t1 
LEFT OUTER JOIN TABLE2 t2 
  ON ASCII(t2.INTCol) - 1 = ASCII(t2.INTCol) 
  AND t1.date = t2.date
  WHERE t2.id IS NULL 
```

然而，这种解决方案确实存在两个问题。它会在两种情况下返回误报。

1.  字母序列每天从“W”开始。所以，我得到了每天最后一条记录的误报结果。在我的示例数据中，这将是第 8 行和第 16 行。

2.  由于序列每天从“W”开始，我得到了“Z”记录的误报，因为（“Z”+1）给了我一个“[”，而不是“A”。

对于#2，我相信我可以写一个“IF”声明，上面写着：“如果这是 Z，请寻找 A”，但我对任何“更清洁”的解决方案持开放态度。

我真的不知道如何做＃1，所以我真的在寻求帮助。 **编辑：**我遗漏的东西，做 MAX(t1.id) 是行不通的，因为行并不总是按顺序插入。事实上，查看我的数据，即使第一条记录是“w”，它也始终以 [az] 顺序插入。我知道这很糟糕，但我正在处理来自数千万美元电话交换机的日志文件。我对此无能为力。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T19:25:40.560

翻转：使用模组。

天数：添加一个排除每天最后一个条目的谓词。

```
create view missing_letter as 
SELECT *  from TABLE1 t1 
LEFT OUTER JOIN TABLE2 t2 
  ON t1.id = t2.id 
  AND t1.date = t2.date
  and mod( ascii(t1.letter) - ascii('A'), ascii('Z') + 1 ) 
  <> mod( ascii(t2.letter) - ascii('A'), ascii('Z') + 1 ) - 1 
  and t1.id < (select max(t3.id) from table t3 where t3.date = t1.date)
; 
```

一个更好的解决方案是提出一个有序允许字母的辅助表，并找到该辅助表中丢失的所有字母（“......其中不存在......”）其中任何这些字母出现在表中最高的字母。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T19:33:38.967

这个怎么样？

```
SELECT * FROM 
(
SELECT CASE
  WHEN t1.date = t2.date
    AND (ASCII(t2.IntCol) = 90 AND ASCII(t1.IntCol) <> 65)
     THEN 1
  WHEN t1.date = t2.date
    AND ASCII(t2.IntCol) <> ASCII(t1.IntCol) + 1
     THEN 1
  ELSE 0
END AS IsMissing, t1.*

from TABLE1 t1 
LEFT OUTER JOIN TABLE1 t2   
  ON t1.id +1 = t2.id
) as a WHERE a.IsMissing = 1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T19:26:49.293

查看数据，您可以对每一行的 ID 执行 MAX 以获取序列中的最后一个字符。

如果没有记录，可以插入 W
If Z 然后插入 A
Else 在当前字符后面添加字符

那是你要找的吗？

# javascript - 保存 html 页面 + 更改所有链接以指向正确的位置

> ID：941235
> 
> 赞同：0
> 
> 时间：2009-06-02T18:47:55.923
> 
> 标签：javascript, python, html, css, screen-scraping

你可能知道 IE 有一个可以保存网页的东西，它会自动下载 html 文件以及 html 文件使用的所有 image/css/js 文件。

现在有一个问题 - html 文件中的链接没有更改。因此，如果我下载 example.com 的 html 页面，它有一个 <a href=/hi.html> 我用 IE 下载的页面将有一个指向 C:\Documents and Settings...（文件夹路径html文件在）。

是否有一个 python 库可以为我下载一个 html 页面，以及它的所有内容（images/js/css）？如果是，是否有图书馆也可以为我更改链接？

谢谢！！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-02T19:22:33.077

由于您特别提到了 IE，我不确定这是否对您有用，但在 linux 上，完全镜像网站的最简单方法是使用 wget 命令。

```
wget --mirror --convert-links -w 1 http://www.example.com 
```

如果您需要更多选项，请运行 man wget。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-15T14:50:43.737

我编写了一个工具来将网页保存到一个独立的 html 文件中，并且链接指向应该指向的相同位置。

[https://github.com/zTrix/webpage2html](https://github.com/zTrix/webpage2html)

# sql - 是否可以在 PostgreSQL 中创建具有变量名的表？

> ID：941245
> 
> 赞同：6
> 
> 时间：2009-06-02T18:49:21.973
> 
> 标签：sql, postgresql, plpgsql

使用 PL/pgSQL 或（其他一些机制），是否可以创建具有变量名的表？

我想创建多个名为 table_1、table_2、table_3 等的表，如果我可以使用循环来创建它们，而不是显式地创建每个表，它会更简单。

我怀疑这个答案是否定的，但我想确认一下。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T18:57:26.777

如果您依赖这些技巧，我会质疑您的设计，但您的问题很笼统，您没有提供具体信息来判断任何一种方式。

实际上应该是可以的。只需以编程方式将表名构建为字符串，然后在循环中将 CREATE 语句作为动态查询执行。

请参阅 postgres 文档中的此页面：[http ://www.postgresql.org/docs/current/interactive/plpgsql-statements.html#PLPGSQL-STATEMENTS-EXECUTING-DYN](http://www.postgresql.org/docs/current/interactive/plpgsql-statements.html#PLPGSQL-STATEMENTS-EXECUTING-DYN)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T18:55:20.200

通过在循环中动态构建命令来生成脚本，然后运行生成的输出脚本。

# java - 后端模块需要来自表示层的 URL - 如何避免循环依赖？

> ID：941254
> 
> 赞同：0
> 
> 时间：2009-06-02T18:51:39.910
> 
> 标签：java, module, project, cyclic-dependency

我的网络应用程序中的 URL 生成负责表示层。现在考虑另一个模块发送包含 URL 的消息。（不一定从演示文稿中触发）。但是，表示层必须了解模块（因为它*可能*是触发器，并且用户可以使用前端配置模块）。

即模块相互依赖......有什么想法可以避免这种循环依赖？

在我的数据库中存储 URL 对我来说似乎不合适，合并两个模块也是如此。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T19:32:24.163

创建两个模块都知道但彼此不认识的第三个模块？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T22:26:02.067

不会在这里使用界面帮助吗？如何`UrlGenerator`在后端模块中指定和“使用”接口并在表示层中实现它？

结合某种依赖注入机制（用于构建`UrlGenerator`客户端的工厂模式、Spring 或 Guice 等框架、服务定位器模式），这将打破循环编译时依赖关系。

# html - 方格表的行和列？

> ID：941261
> 
> 赞同：4
> 
> 时间：2009-06-02T18:52:48.253
> 
> 标签：html, css

有没有办法让 HTML 表格中的行和列在 2 种不同颜色之间进行检查？

我制作了一个类似数据列表的电子表格，我认为如果行/列在白色和灰白色之间呈方格状，它会看起来更好，并且更容易让人眼前一亮。

谢谢！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-06-02T19:03:05.580

您有什么样的浏览器支持要求？您可以放弃对 IE7 及更早版本的支持吗？如果是这样，您可以使用第 n 个表达式纯粹使用 CSS 执行此操作：

```
tr td
{
    background-color: #fff;
}

tr:nth-child(even) td:nth-child(odd), 
tr:nth-child(odd) td:nth-child(even)
{
    background-color: #ccc;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T20:19:12.150

当然可以。这是一个简单的 JavaScript 函数来为您处理它：

```
function altRows() {
    var table = document.getElementById("tableToAlternateRowsIn");
    var tRows = table.getElementsByTagName("tr");
    var cssClassName;

    for(var i = 0; i < tRows.length; i++) {
        (i % 2 == 0) ? cssClassName = "odd" : cssClassName = "even";
        tRows[i].className = cssClassName;
    }
}

window.onload = altRows; 
```

那应该对你有用。未经测试，因此可能无法完全按计划工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-02T18:59:02.780

[请参阅Colorize - jQuery Table Plugin](http://plugins.jquery.com/project/Colorize)中的示例- 它涉及一些 Javascript，但您可以按原样使用它，或作为示例阅读。

> Colorize 是一个 jQuery 插件，用于为交替的表格行添加背景颜色，在鼠标悬停时突出显示行/列，并在单击鼠标按钮时为行/列着色。您可以根据需要为尽可能多的表格行着色。重复鼠标单击会将行恢复为原始背景颜色。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T19:13:17.917

要仅使用 HTML+CSS 并使其适用于所有主流浏览器，您必须手动为每个备用行添加一个类：

```
<tr>
   <td>col1</td>
   <td>col2</td>
</tr>
<tr class="highlight">
   <td>col1</td>
   <td>col2</td>
</tr>
<tr>
   <td>col1</td>
   <td>col2</td>
</tr>
<tr class="highlight">
   <td>col1</td>
   <td>col2</td>
</tr> 
```

ETC...

然后使用 CSS 更改行的颜色：

```
tr {
  background-color: #FFF;
}
tr.highlight {
  background-color: #CCC;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T18:54:22.370

当然。将它们全部设为相同的白色（即保持默认值），然后以编程方式将灰白色样式添加到每个其他 TD（或 span 或 div 或 li 或...）。

不要忘记，您需要从“列”0 或 1 开始，具体取决于您所在的行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-02T20:29:13.287

有几篇文章声称斑马条纹（更不用说棋盘格）无助于可读性。棋盘游戏虽然是 CSS 中的一项有趣的练习，但对我来说似乎更分散注意力而不是有用。参见[A List Apart：斑马条纹 - 它](http://www.alistapart.com/articles/zebrastripingdoesithelp "斑马条纹 - 有帮助吗？")在其他地方有帮助吗？

# iphone - 在 UIAlertView 中添加 UIActivityindicatorView

> ID：941264
> 
> 赞同：15
> 
> 时间：2009-06-02T18:53:19.673
> 
> 标签：iphone

我想创建一个 UIAlertView，它会说“......正在进行中”。它还会显示 UIActivityindicatorView 就可以了。你能让我知道我该怎么做吗？

谢谢。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-06-02T20:28:39.293

它很简单。只需创建一个 UIActivityIndi​​catorView 并将其作为子视图添加到 UIAlertView。

```
UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@" " message:@" " delegate:self cancelButtonTitle:nil otherButtonTitles:nil];
    UIActivityIndicatorView *progress= [[UIActivityIndicatorView alloc] initWithFrame:CGRectMake(125, 50, 30, 30)];
    progress.activityIndicatorViewStyle = UIActivityIndicatorViewStyleWhiteLarge;
    [alert addSubview:progress];
    [progress startAnimating];

    [alert show]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-23T10:27:48.383

就我而言，我发现使用硬编码的帧来源很糟糕。如果我的消息有更多行，指示器会显示我的消息顶部。

所以我创建带有布局指示器的函数，如果大小 UIAlertView

```
+(UIAlertView*) progressAlertWithTitle:(NSString*) title andMessage:(NSString*) message andDelegate:(id)delegate{
    UIAlertView *progressAlert = [[UIAlertView alloc] init];
    [progressAlert setTitle:title];
    [progressAlert setMessage:message];
    [progressAlert setDelegate:delegate];
    UIActivityIndicatorView *progress=nil;
    progress= [[UIActivityIndicatorView alloc] initWithActivityIndicatorStyle:UIActivityIndicatorViewStyleWhiteLarge];

    [progressAlert addSubview:progress];
    [progress startAnimating];

    [progressAlert show];

    progress.frame=CGRectMake(progressAlert.frame.size.width/2-progress.frame.size.width, progressAlert.frame.size.height-progress.frame.size.height*2, progress.frame.size.width, progress.frame.size.height);

    return progressAlert;
} 
```

在这种情况下，指标始终按中心

**一行留言：**

![在此处输入图像描述](https://i.stack.imgur.com/WhCMq.png)

**多一行留言：**

![在此处输入图像描述](https://i.stack.imgur.com/FNtVp.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-16T06:16:35.157

```
UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"" message:@"" delegate:self cancelButtonTitle:nil otherButtonTitles:nil];
UIActivityIndicatorView   *spinner = [[UIActivityIndicatorView alloc]initWithActivityIndicatorStyle:UIActivityIndicatorViewStyleGray];
spinner.center = CGRectMake(xcords, ycords, width, height);
[alert addSubview:spinner];
[spinner startanimating];
[alert show]; 
```

此微调器在关闭 AlertView 时被隐藏。

```
[alert dismissWithClickedButtonIndex:0 animated:YES]; 
```

# reporting-services - Reporting Services 在单独的应用程序库中针对 ObjectDataSource 报告

> ID：941268
> 
> 赞同：2
> 
> 时间：2009-06-02T18:54:14.927
> 
> 标签：reporting-services, domain-driven-design

我不想通过直接访问 SQL 数据库来生成我的 RS 报告，而是想利用我已经在另一个应用程序中编写的域对象，其中已经存在复杂的业务规则和计算，因此我不必复制它存储过程和其他代码中的逻辑。我想保持干燥。

将报告问题视为另一种视图会很好

Reporting Services 可以做到这一点吗？它应该是合乎逻辑的，但我没有找到太多信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T19:07:27.897

是的。您可以在本地处理模式下使用 ReportViewer 控件。在这种模式下，您可以只传递一个 DataSource 而不是直接访问数据库。

请记住，有些事情在 LocalMode 中是无法做到的，而在 ServerMode 中却可以做到。我记得的一个是导出到 PDF 或 Excel 以外的任何内容。

# python - 在 Django 中验证 slug

> ID：941270
> 
> 赞同：10
> 
> 时间：2009-06-02T18:54:25.303
> 
> 标签：python, django, validation, slug

我猜这将涉及正则表达式或其他东西，但我会试一试。此时，用户可以通过`£$(*£$(£@$&£($`在标题字段中键入类似的内容来破坏网站，使用 Django 将其转换为 slug `slugify`。

因为这些字符都不能转换，所以 Django 返回一个错误。`forms.ValidationError`我的问题是，当用户使用这样的标题时，我应该在表单验证方法中提出什么？

谢谢。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-06-02T18:59:15.293

这个问题已经有五年历史了，所以在更新我的问题时，我应该解释一下，我至少是在向过去点头，其中某些功能可能不存在。

如今，处理表单中的 slug 最简单的方法就是使用`django.models.SlugField`. 它将为您验证自身并暗示该字段是一个索引。

如果你没有在模型上使用它，你仍然可以挂钩 SlugField 使用的同一个验证器：

```
from django.core.validators import validate_slug

slug = forms.CharField(..., validators=[validate_slug]) 
```

如果您只想进行幕后检查或编写自己的验证器，您可以使用类似的技术来引入 Django 对有效 slug 的定义。它只是上面 validate_slug 使用的编译正则表达式：

```
from django.core.validators import slug_re

if slug_re.match(...):
    ... 
```

我无法想象它会改变，但是通过将自己锁定在 Django 的蛞蝓想法中，如果 Django 有一天真的改变了，你将确保一致性。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2011-06-24T10:03:14.997

```
SLUG_REGEX = re.compile('^[-\w]+$') 
```

# java - 如何从 Java 中的字符串修剪文件扩展名？

> ID：941272
> 
> 赞同：193
> 
> 时间：2009-06-02T18:55:02.897
> 
> 标签：java, string, process

在Java中修剪后缀的最有效方法是什么，如下所示：

```
title part1.txt
title part2.html
=>
title part1
title part2 
```

* * *

## 回答 #1

> 赞同：308
> 
> 时间：2009-06-13T09:39:56.743

这是我们不应该自己做的那种代码。为平凡的东西使用图书馆，为困难的东西节省你的大脑。

在这种情况下，我建议使用来自[Apache Commons IO的](http://commons.apache.org/io/)[FilenameUtils.removeExtension()](http://commons.apache.org/proper/commons-io/javadocs/api-2.5/org/apache/commons/io/FilenameUtils.html#removeExtension%28java.lang.String%29)

* * *

## 回答 #2

> 赞同：253
> 
> 时间：2009-06-02T18:57:08.510

```
str.substring(0, str.lastIndexOf('.')) 
```

* * *

## 回答 #3

> 赞同：92
> 
> 时间：2009-06-13T10:38:17.320

由于在单行中使用`String.substring`and很好，因此在处理某些文件路径方面存在一些问题。`String.lastIndex`

以以下路径为例：

```
a.b/c 
```

使用单线将导致：

```
a 
```

这是不正确的。

结果应该是`c`，但由于文件缺少扩展名，但路径中有一个`.`名称中带有 a 的目录，单线方法被欺骗，将路径的一部分作为文件名，这是不正确的。

**需要检查**

受[skaffman 的回答](https://stackoverflow.com/questions/941272/how-do-i-trim-a-file-extension-from-a-string-in-java/990408#990408)启发，我看了一下[Apache Commons IO](http://commons.apache.org/io/)[`FilenameUtils.removeExtension`](http://commons.apache.org/io/api-release/org/apache/commons/io/FilenameUtils.html#removeExtension(java.lang.String))的方法。

为了重现它的行为，我编写了一些新方法应该完成的测试，如下所示：

```
路径文件名
-------------- --------
a/b/cc
a/b/c.jpg c
a/b/c.jpg.jpg c.jpg

ab/cc
ab/c.jpg c
ab/c.jpg.jpg c.jpg

抄送
c.jpg c
c.jpg.jpg c.jpg

```

（这就是我检查的全部内容——可能还有其他一些我忽略的检查。）

**实施**

以下是我对该`removeExtension`方法的实现：

```
public static String removeExtension(String s) {

    String separator = System.getProperty("file.separator");
    String filename;

    // Remove the path upto the filename.
    int lastSeparatorIndex = s.lastIndexOf(separator);
    if (lastSeparatorIndex == -1) {
        filename = s;
    } else {
        filename = s.substring(lastSeparatorIndex + 1);
    }

    // Remove the extension.
    int extensionIndex = filename.lastIndexOf(".");
    if (extensionIndex == -1)
        return filename;

    return filename.substring(0, extensionIndex);
} 
```

`removeExtension`使用上述测试运行此方法会产生上面列出的结果。

该方法使用以下代码进行了测试。由于这是在 Windows 上运行的，因此路径分隔符是 a ，当用作文字的一部分时`\`必须使用 a 进行转义。`\``String`

```
System.out.println(removeExtension("a\\b\\c"));
System.out.println(removeExtension("a\\b\\c.jpg"));
System.out.println(removeExtension("a\\b\\c.jpg.jpg"));

System.out.println(removeExtension("a.b\\c"));
System.out.println(removeExtension("a.b\\c.jpg"));
System.out.println(removeExtension("a.b\\c.jpg.jpg"));

System.out.println(removeExtension("c"));
System.out.println(removeExtension("c.jpg"));
System.out.println(removeExtension("c.jpg.jpg")); 
```

结果是：

```
c
c
c.jpg
c
c
c.jpg
c
c
c.jpg 
```

结果是该方法应满足的测试中概述的期望结果。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2011-05-27T15:37:05.367

顺便说一句，就我而言，当我想要一个快速解决方案来删除特定扩展时，这大约是我所做的：

```
 if (filename.endsWith(ext))
    return filename.substring(0,filename.length() - ext.length());
  else
    return filename; 
```

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2009-06-02T18:57:47.900

```
String foo = "title part1.txt";
foo = foo.substring(0, foo.lastIndexOf('.')); 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2018-02-10T00:34:53.747

你可以试试这个功能，很基础

```
public String getWithoutExtension(String fileFullPath){
    return fileFullPath.substring(0, fileFullPath.lastIndexOf('.'));
} 
```

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2009-06-03T00:37:10.710

```
String fileName="foo.bar";
int dotIndex=fileName.lastIndexOf('.');
if(dotIndex>=0) { // to prevent exception if there is no dot
  fileName=fileName.substring(0,dotIndex);
} 
```

这是一个技巧问题吗？:p

我想不出更快的方式atm。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2018-01-08T17:41:23.953

`com.google.common.io.Files`如果您的项目已经依赖于 Google 核心库，请使用类中的方法。你需要的方法是`getNameWithoutExtension`。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2012-08-07T06:01:14.587

```
filename.substring(filename.lastIndexOf('.'), filename.length()).toLowerCase(); 
```

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2010-02-10T23:01:19.527

我发现[coolbird的回答](https://stackoverflow.com/questions/941272/how-do-i-trim-a-file-extension-from-a-string-in-java/990492#990492)特别有用。

但我将最后一个结果语句更改为：

```
if (extensionIndex == -1)
  return s;

return s.substring(0, lastSeparatorIndex+1) 
         + filename.substring(0, extensionIndex);
```

因为我希望返回完整的路径名。

```
所以“C:\Users\mroh004.COM\Documents\Test\Test.xml”变成
   "C:\Users\mroh004.COM\Documents\Test\Test" 而不是
   “测试”

```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2017-10-15T14:57:02.027

使用正则表达式。这个替换了最后一个点，以及它之后的所有内容。

```
String baseName = fileName.replaceAll("\\.[^.]*$", ""); 
```

如果要预编译正则表达式，还可以创建 Pattern 对象。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2021-01-15T02:32:16.650

如果你使用 Spring，你可以使用

```
org.springframework.util.StringUtils.stripFilenameExtension(String path) 
```

> 从给定的 Java 资源路径中去除文件扩展名，例如
> 
> “我的路径/myfile.txt”->“我的路径/我的文件”。
> 
> 参数：path - 文件路径
> 
> 返回： 去除文件扩展名的路径

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2016-04-07T20:18:10.620

```
 private String trimFileExtension(String fileName)
  {
     String[] splits = fileName.split( "\\." );
     return StringUtils.remove( fileName, "." + splits[splits.length - 1] );
  } 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2015-02-04T05:18:16.297

使用字符串图像路径创建一个新文件

```
String imagePath;
File test = new File(imagePath);
test.getName();
test.getPath();
getExtension(test.getName());

public static String getExtension(String uri) {
        if (uri == null) {
            return null;
        }

        int dot = uri.lastIndexOf(".");
        if (dot >= 0) {
            return uri.substring(dot);
        } else {
            // No extension.
            return "";
        }
    } 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2013-11-25T11:02:32.283

```
String[] splitted = fileName.split(".");
String fileNameWithoutExtension = fileName.replace("." + splitted[splitted.length - 1], ""); 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2015-12-25T11:26:33.617

org.apache.commons.io.FilenameUtils version 2.4 gives the following answer

```
public static String removeExtension(String filename) {
    if (filename == null) {
        return null;
    }
    int index = indexOfExtension(filename);
    if (index == -1) {
        return filename;
    } else {
        return filename.substring(0, index);
    }
}

public static int indexOfExtension(String filename) {
    if (filename == null) {
        return -1;
    }
    int extensionPos = filename.lastIndexOf(EXTENSION_SEPARATOR);
    int lastSeparator = indexOfLastSeparator(filename);
    return lastSeparator > extensionPos ? -1 : extensionPos;
}

public static int indexOfLastSeparator(String filename) {
    if (filename == null) {
        return -1;
    }
    int lastUnixPos = filename.lastIndexOf(UNIX_SEPARATOR);
    int lastWindowsPos = filename.lastIndexOf(WINDOWS_SEPARATOR);
    return Math.max(lastUnixPos, lastWindowsPos);
}

public static final char EXTENSION_SEPARATOR = '.';
private static final char UNIX_SEPARATOR = '/';
private static final char WINDOWS_SEPARATOR = '\\'; 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2021-02-07T23:35:17.453

我能写的最好的东西试图坚持 Path 类：

```
Path removeExtension(Path path) {
    return path.resolveSibling(path.getFileName().toString().replaceFirst("\\.[^.]*$", ""));
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-06-02T18:58:57.710

我会这样做：

```
String title_part = "title part1.txt";
int i;
for(i=title_part.length()-1 ; i>=0 && title_part.charAt(i)!='.' ; i--);
title_part = title_part.substring(0,i); 
```

开始到结束直到'。然后调用子字符串。

编辑：可能不是高尔夫球，但它很有效:)

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2017-11-29T16:55:00.037

请记住没有文件扩展名或有多个文件扩展名的情况

示例文件名：文件 | 文件.txt | 文件.tar.bz2

```
/**
 *
 * @param fileName
 * @return file extension
 * example file.fastq.gz => fastq.gz
 */
private String extractFileExtension(String fileName) {
    String type = "undefined";
    if (FilenameUtils.indexOfExtension(fileName) != -1) {
        String fileBaseName = FilenameUtils.getBaseName(fileName);
        int indexOfExtension = -1;
        while (fileBaseName.contains(".")) {
            indexOfExtension = FilenameUtils.indexOfExtension(fileBaseName);
            fileBaseName = FilenameUtils.getBaseName(fileBaseName);
        }
        type = fileName.substring(indexOfExtension + 1, fileName.length());
    }
    return type;
} 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2019-01-12T03:58:49.820

```
public static String removeExtension(String file) {
    if(file != null && file.length() > 0) {
        while(file.contains(".")) {
            file = file.substring(0, file.lastIndexOf('.'));
        }
    }
    return file;
} 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2018-06-07T07:09:08.137

```
String img = "example.jpg";
// String imgLink = "http://www.example.com/example.jpg";
URI uri = null;

try {
    uri = new URI(img);
    String[] segments = uri.getPath().split("/");
    System.out.println(segments[segments.length-1].split("\\.")[0]);
} catch (Exception e) {
    e.printStackTrace();
} 
```

这将输出**img**和**imgLink**的**示例**

 ***** * *

## 回答 #22

> 赞同：0
> 
> 时间：2021-08-08T12:56:01.287

```
private String trimFileName(String fileName)
    {
        String[] ext;
        ext = fileName.split("\\.");

        return fileName.replace(ext[ext.length - 1], "");

    } 
```

此代码会将文件名溢出到它曾经有“。”的部分，例如。如果文件名是*file-name.hello.txt*，那么它将被拆分为字符串数组，{ "file-name", "hello", "txt" }。所以无论如何，这个字符串数组中的最后一个元素将是那个特定文件的文件扩展名，所以我们可以简单地找到任何数组的最后一个元素`arrayname.length - 1`，所以在我们知道最后一个元素之后，我们可以将文件扩展名替换为该文件名中的空字符串。最后，这将返回 file-name.hello。，如果您还想删除最后一个句点，那么您可以将只有句点的字符串添加到返回行中字符串数组的最后一个元素。应该看起来像，

```
return fileName.replace("." +  ext[ext.length - 1], ""); 
```

# vb.net - 用于数据访问的 vb.net 模块 - 这有多糟糕？

> ID：941279
> 
> 赞同：1
> 
> 时间：2009-06-02T18:57:06.873
> 
> 标签：vb.net

我继承了一些具有公共模块用于数据访问的代码：

代码如下：

```
Public Module Foo
    Dim ds As New DataSet

    Public Function GetDataSet(ByVal sqlQuery As String) As DataSet
     ...
       Fill(ds)...
     ...
    return ds
    End Function
End Module 
```

并且所有页面都调用`GetDataSet(sql)`. 我是否正确假设这是一个坏主意？最坏的情况是并发调用者可以互相获取数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T19:00:05.663

很坏。使用这种架构，绝对没有办法使用参数化查询或存储过程来保护自己免受 SQL 注入的侵害……这只是一个开始。

您还将错过任何类型的强类型数据集（这使生活变得更加轻松）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T19:10:19.280

1.  您对并发呼叫者的担忧是有根据的。解决方案是将“Dim ds..”从模块中移到 GetDataSet 例程中。然后它是本地的，在堆栈上，并且没有机会踩到对方。

2.  A larger problem is that composing SQL queries as string in client code is not good application design, it can be OK for SQL utilities, but nothing else. This approach will keep you from using Linq to SQL, Linq to Entities, Stored Procedures, most of the more desirable DB-access security models and probably exposes you to SQL Injection attacks.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T19:08:14.307

我使用类似的东西，从来没有遇到过任何问题。使数据访问变得如此简单。我不介意编写 SQL，事实上它有助于我准确了解我得到的数据。只要数据访问明确分离（即，您始终从同一位置提取数据），并且您清理了 SQL 字符串中的所有数据，我看不出有什么问题。不过，我确实同意公共变量不好。

叹息......或者我可能是一个糟糕的程序员：\让downvoting开始......

# python - 在谷歌应用引擎模板中使用“范围” for - 循环

> ID：941282
> 
> 赞同：0
> 
> 时间：2009-06-02T18:57:17.760
> 
> 标签：python, django-templates

我有一个 appengine 项目，在我的模板中我想做类似的事情

```
{% for i in range(0, len(somelist)) %}
  {{ somelist[i] }} {{ otherlist[i] }}
{% endfor %} 
```

我也尝试过使用“forloop.counter”来访问列表项，但这也没有成功。有什么建议么？

问候，多路复用器

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-02T19:12:02.677

您可能想要做的是更改您传递给模板的数据，以便将 somelist 和 otherlist 压缩到一个列表中：

```
combined_list = zip(somelist, otherlist)
...
{% for item in combined_list %}
    {{ item.0 }} {{ item.1 }}
{% endfor %} 
```

# algorithm - Big-O 表示法何时失败？

> ID：941283
> 
> 赞同：25
> 
> 时间：2009-06-02T18:57:21.957
> 
> 标签：algorithm, language-agnostic, theory, big-o

有哪些 Big-O 表示法 [1] 在实践中失败的例子？

也就是说：算法的 Big-O 运行时间什么时候会预测算法 A 比算法 B 快，而实际运行时算法 B 会更快？

稍微宽泛一点：关于算法性能的理论预测何时与观察到的运行时间不匹配？非大 O 预测可能基于搜索树中的平均/预期旋转次数，或排序算法中的比较次数，表示为因子乘以元素数量。

**澄清**：

尽管有些答案说了什么，但 Big-O 表示法**旨在**预测算法性能。也就是说，它是一个**有缺陷**的工具：它只谈论渐近性能，它模糊了常数因素。它这样做是有原因的：它旨在预测算法性能，而与您在哪台计算机上执行算法无关。

*我想知道的是*：这个工具的缺陷什么时候表现出来？我发现 Big-O 表示法相当有用，但远非完美。有哪些陷阱、边缘情况和陷阱？

我正在寻找的一个例子：使用斐波那契堆而不是二进制堆运行 Dijkstra 的最短路径算法，你得到 O(m + n log n) 时间与 O((m+n) log n)，对于 n顶点和 m 条边。您预计斐波那契堆迟早会提高速度，但在我的实验中从未实现过速度提高。

（没有证据的实验证据表明，在均匀随机边权重上运行的二进制堆花费 O(1) 时间而不是 O(log n) 时间；这是实验的一个大问题。另一个难以计数的问题是预期的调用 DecreaseKey 的次数）。

[1] 实际上，失败的不是*符号*，而是符号所代表的*概念*，以及预测算法性能的理论方法。</反迂腐>

**关于接受的答案**：

我已经接受了一个答案，以突出我希望得到的答案。存在许多同样好的答案:) 我喜欢这个答案的地方在于，它提出了一个通用规则，用于何时 Big-O 表示法“失败”（当缓存未命中主导执行时间时），这也可能增加理解（在某种意义上我不确定如何最好地表达 ATM）。

* * *

## 回答 #1

> 赞同：105
> 
> 时间：2009-06-02T19:06:07.447

它仅在一种情况下失败：当人们试图将它用于它不适合的东西时。

它告诉您算法如何扩展。它不会告诉你它有多快。

Big-O 符号不会告诉您在任何特定情况下哪种算法会更快。它只告诉你，对于足够大的输入，一个会比另一个快。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-06-02T19:02:54.007

当 N 较小时，常数因子占主导地位。在包含五个项目的数组中查找一个项目可能比在哈希表中查找更快。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-06-02T19:03:21.463

简短的回答：当 n 小时。当您只有三个目的地时，旅行商问题很快就会得到解决（但是，在万亿元素的列表中找到最小的数字可能会持续一段时间，尽管这是 O(n)。）

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-06-02T19:04:11.927

典型的例子是快速排序，它的最坏时间是 O(n^2)，而堆排序是 O(n logn)。然而在实践中，快速排序通常比堆排序更快。为什么？两个原因：

*   Quicksort 中的每次迭代都比 Heapsort 简单得多。更重要的是，它很容易通过简单的缓存策略进行优化。

*   最坏的情况很难命中。

但是恕我直言，这并不意味着“大 O 失败”。第一个因素（迭代时间）很容易纳入您的估计中。毕竟，大 O 数应该乘以这个几乎恒定的因子。

如果你得到摊销数字而不是平均值，第二个因素就会消失。它们可能更难估计，但讲述了一个更完整的故事

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2009-06-02T19:06:50.473

Big O 失败的一个领域是内存访问模式。Big O 只计算需要执行的操作——如果算法导致更多的缓存未命中或需要从磁盘调入的数据，它无法跟踪。对于小的 N，这些影响通常会占主导地位。例如，由于内存访问，通过 100 个整数的数组进行线性搜索可能会击败通过 100 个整数的二叉树进行的搜索，尽管二叉树很可能需要更少的操作。每个树节点都会导致缓存未命中，而线性搜索大部分会在每次查找时命中缓存。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2009-06-02T19:03:39.137

1.  对于大多数算法，都有“平均情况”和“最坏情况”。如果您的数据经常落入“最坏情况”的场景，那么另一种算法（虽然理论上在平均情况下效率较低）可能会证明对您的数据更有效。

2.  一些算法还具有您的数据可以利用的最佳情况。例如，一些排序算法的理论效率很差，但如果数据已经排序（或接近排序），实际上速度非常快。另一种算法虽然在一般情况下理论上更快，但可能无法利用数据已经排序并且实际上性能更差的事实。

3.  对于非常小的数据集，有时具有更好理论效率的算法实际上可能由于“k”值较大而效率较低。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2009-06-02T19:07:08.833

Big-O 描述了算法的效率/复杂性，而不一定是给定代码块的实现的运行时间。这并不意味着 Big-O 失败了。这只是意味着它并不意味着预测运行时间。

查看[这个问题](https://stackoverflow.com/questions/487258/plain-english-explanation-of-big-o)的答案以获得 Big-O 的一个很好的定义。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2009-06-02T19:07:36.367

一个例子（我不是专家）是线性规划的单纯形算法在任意输入上具有指数最坏情况复杂性，即使它们在实践中表现良好。一个有趣的解决方案是考虑“平滑复杂度”，它通过查看任意输入的小随机扰动来混合最坏情况和平均情况的性能。

[Spielman 和 Teng (2004)](http://reference.kfupm.edu.sa/content/s/m/smoothed_analysis_of_algorithms__why_the_110204.pdf)能够证明阴影顶点单纯形算法具有多项式平滑复杂度。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-06-02T19:58:02.367

大 O 并*没有*说算法 A 比算法 B 运行得更快。它可以说当输入增长时，算法 A 使用的时间或空间以不同于算法 B 的速度增长。然而，对于任何特定的输入大小，大 O 表示法并没有说明一种算法相对于另一种算法的性能。

例如，A 每次操作可能较慢，但具有比 B 更好的 big-O。B 对于较小的输入具有更高的性能，但如果数据大小增加，将会有一些截止点 A 变得更快。Big-O 本身并没有说明截止点在哪里。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2009-06-02T20:17:40.000

一般的答案是，Big-O 通过隐藏常数因素让你变得非常草率。如问题中所述，斐波那契堆的使用就是一个例子。斐波那契堆*确实*有很好的渐近运行时间，但在实践中，常数因子太大而对现实生活中遇到的数据集的大小没有用处。

斐波那契堆通常用于证明图相关算法的渐近复杂度的良好下界。

另一个类似的例子是用于矩阵乘法的[Coppersmith-Winograd 算法。](http://en.wikipedia.org/wiki/Coppersmith%E2%80%93Winograd_algorithm)它是目前已知最快的矩阵乘法渐近运行时间 O(n ^(2.376) ) 的算法。然而，它的常数因子太大而无法在实践中使用。像斐波那契堆一样，它经常被用作其他算法的构建块来证明理论上的时间界限。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2009-06-02T19:01:47.377

这在一定程度上取决于 Big-O 正在测量的内容 - 在最坏的情况下，它通常会“失败”，因为运行时性能会比 Big-O 建议的要好得多。如果是平均情况，那么情况可能会更糟。

如果算法的输入数据有一些先验信息，Big-O 表示法通常会“失败”。通常，Big-O 表示法指的是最坏情况的复杂性——如果数据是完全随机的或完全非随机的，这通常会发生。

例如，如果您将数据提供给经过分析的算法，并且 big-o 基于随机数据，但您的数据具有非常明确的结构，那么您的结果时间可能比预期的要快得多。同样，如果您测量的是平均复杂度，并且您提供的数据非常随机化，那么该算法的性能可能比预期的要差得多。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2009-06-02T19:21:29.740

1.  小 N - 对于今天的计算机，100 可能太小而无需担心。
2.  隐藏乘数 - IE 合并与快速排序。
3.  病理病例 - 再次，合并与快速

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2009-06-02T19:38:36.057

Big-Oh 表示法失败的一个广泛领域是当数据量超过可用 RAM 量时。

以排序为例，排序所花费的时间不受比较或交换次数的支配（在最佳情况下，比较或交换的次数分别为 O(n log n) 和 O(n)）。时间量取决于磁盘操作的数量：块写入和块读取。

为了更好地分析处理超出可用 RAM 的数据的算法，I/O 模型诞生了，您可以在其中计算磁盘读取次数。在那里，您考虑三个参数：

*   元素个数，N；
*   内存量（RAM），M（可以在内存中的元素数量）；和
*   磁盘块的大小，B（每个块的元素数）。

值得注意的是磁盘空间量；这被视为无限。一个典型的额外假设是 M > B ²。

继续排序示例，您通常倾向于在 I/O 情况下进行合并排序：将元素分成大小为 θ(M) 的块并在内存中对它们进行排序（例如使用快速排序）。然后，通过将每个块中的第一个块读取到内存中来合并它们中的 θ(M/B)，将所有元素填充到一个堆中，并重复选择最小的元素，直到你选择了其中的 B 个。写出这个新的合并块并继续。如果您耗尽了读入内存的某个块，请从同一块中读取一个新块并将其放入堆中。

（所有表达式都应该被理解为大 θ）。您形成 N/M 个排序的块，然后合并。你合并N/M次日志（base M/B）；每次读取和写入所有 N/B 块时，都需要 N/B * (log base M/B of N/M) 时间。

您可以分析内存中的排序算法（经过适当修改以包括块读取和块写入）并发现它们比我介绍的合并排序效率低得多。

这些知识来自我的 I/O 算法课程，Arge 和 Brodal ( [http://daimi.au.dk/~large/ioS08/](http://daimi.au.dk/~large/ioS08/) )；我还进行了验证该理论的实验：一旦超出内存，堆排序就会花费“几乎无限”的时间。快速排序变得慢得难以忍受，合并排序慢得让人难以忍受，I/O 效率高的合并排序表现良好（最好的）。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-06-03T21:15:08.600

我见过一些案例，随着数据集的增长，算法复杂性变得不如内存访问模式重要。在某些情况下，使用智能算法导航大型数据结构可能会导致比使用更糟糕的 big-O 的算法更多的页面错误或缓存未命中。

对于较小的 n，两种算法可能具有可比性。随着 n 的增加，更智能的算法会表现得更好。但是，在某些时候，n 增长到足以使系统屈服于内存压力，在这种情况下，“更糟糕”的算法实际上可能会执行得更好，因为常量基本上被重置了。

不过，这并不是特别有趣。当你达到这个反转点时，这两种算法的性能通常都无法接受，你必须找到一种新的算法，它具有更友好的内存访问模式和更好的 big-O 复杂度。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-06-02T18:59:39.037

**当您的数据不适合模型**时，大 O 表示法仍然有效，但您会看到最佳和最坏情况的重叠。

此外，**一些操作针对线性数据访问与随机数据访问进行了调整**，因此一种算法虽然在周期方面更胜一筹，但如果调用它的方法从设计中改变，它可能会非常缓慢。同样，**如果算法由于访问内存的方式导致页面/缓存未命中**，Big-O 不会准确估计运行进程的成本。

显然，正如我忘记的那样，**当 N 很小时**:)

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-06-02T19:09:52.713

这个问题就像在问，“一个人的智商什么时候会在实践中失败？” 很明显，智商高并不意味着你会在生活中取得成功，智商低并不意味着你会灭亡。然而，我们衡量智商作为评估潜力的一种手段，即使它不是绝对的。

在算法中，Big-Oh 符号为您提供算法的 IQ。这并不一定意味着该算法将在您的特定情况下表现最佳，但有一些数学基础表明该算法具有一定的潜力。如果 Big-Oh 表示法足以衡量性能，您会看到更多的它和更少的运行时测试。

将 Big-Oh 视为一个范围，而不是衡量好坏的具体衡量标准。有最好的情况和最坏的情况，以及介于两者之间的大量情况。根据算法在 Big-Oh 范围内的适合程度来选择算法，但不要依赖符号作为衡量性能的绝对标准。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-07-02T15:14:34.453

简短的回答：当你开始使用大量内存时，总是在现代硬件上。教科书假设内存访问是统一的，但现在不再如此。您当然可以对非统一访问模型进行 Big O 分析，但这有点复杂。

小的 n 情况很明显但并不有趣：足够快就是足够快。

在实践中，我在使用 Delphi、Java、C# 和 Smalltalk 中包含几百万个对象的标准集合时遇到了问题。而对于较小的那些，主要因素被证明是哈希函数或比较

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2015-02-02T16:11:02.463

Robert Sedgewick 在他的 Coursera 算法分析课程中谈到了大 O 符号的缺点。他将特别令人震惊的例子称为*银河算法*，因为虽然它们可能比它们的前辈具有更好的复杂性等级，但它需要天文规模的输入才能在实践中显示出来。

[https://www.cs.princeton.edu/~rs/talks/AlgsMasses.pdf](https://www.cs.princeton.edu/~rs/talks/AlgsMasses.pdf)

# c# - Visual Studio 2005：调试来自不同项目的 C# 代码？

> ID：941287
> 
> 赞同：1
> 
> 时间：2009-06-02T18:57:58.307
> 
> 标签：c#, debugging, reflection, visual-studio-2005, projects

我有一个使用 Visual Studio 开发的桌面应用程序，我需要更频繁地更新应用程序的一小部分。为了避免每次部署新安装程序的不便，我将更新频率更高的支持功能拆分为一个单独的项目，并将其编译为 DLL。桌面应用程序现在在运行时通过反射加载此 DLL，然后基于具有接口定义的共享 DLL 实例化其中的对象，如下所示：

```
Assembly a = Assembly.LoadFrom(supportDLLPath);
ISupportModuleInterface obj = (ISupportModuleInterface)a.CreateInstance("SupportCode.SupportObject");
if (obj != null)
{
    obj.OnTransferProgress += new FileTransferProgressHandler(obj_OnTransferProgress);
    obj.OnTransferComplete += new EventHandler(uploader_OnTransferComplete);
    obj.DoWork(packagePath)
} 
```

它在大多数情况下都能正常工作，但我需要用它来调试问题，而且我无法可靠地让 Visual Studio 调试器进入它。有时候通过代码按F11，比如单步进入DoWork，它会自动定位我系统上DLL的源代码并显示出来。但是，当触发事件时，Visual Studio 只会在调用堆栈中显示 [External Code] 标记，我无法在支持项目的代码中导航。

是否有人对如何解决此问题有任何想法，以便我可以正确调试支持项目？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T19:37:14.873

程序集是否列在“模块”窗口（调试 -> Windows -> 模块，或按“Ctrl-D，M”）中，是否列为“已加载符号”，符号从您加载的位置预计？（您可以通过右键单击并选择“加载符号...”来强制它加载符号。如果找不到匹配的符号文件，它将通过“打开...”对话框提示您）。

还要检查此窗口以确保模块未加载两次，并且程序集的版本/时间戳/位置是您所期望的。

最后检查“工具->选项->调试”下是否选中了“仅我的代码”，并查看取消选中它是否有所不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T19:24:08.237

可以拆机吗？如果从我记得的情况来看是这样，它将为您提供创建 pdb 时源代码所在位置的路径。我必须这样做来调试 NHibernate，并且必须将源代码放在创建“pdb”文件时所在的确切路径上。之后，我可以毫无问题地进入源代码。

# python - 有可用的 python OpenID 服务器吗？

> ID：941296
> 
> 赞同：12
> 
> 时间：2009-06-02T18:59:07.930
> 
> 标签：python, openid

我想托管我自己的 OpenID 提供程序。Python中有什么可用的吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-10-03T07:57:29.673

[poit](http://yangman.ca/poit/)是一个独立的单用户 OpenID 服务器，使用 Python 实现，使用 python-openid。（这是我开始的一个项目）

# jquery - jQuery Thickbox 和 Google Maps Extinfowindow

> ID：941298
> 
> 赞同：0
> 
> 时间：2009-06-02T18:59:19.457
> 
> 标签：jquery, google-maps, thickbox

我正在尝试将链接放置到通过 Ajax 调用获取其内容的 Extinfowindow 中。所以，我点击一个图钉标记，弹出带有我的[ThickBox](http://jquery.com/demo/thickbox/) 链接的 Extinfowindow，当我检查整个页面的 DOM 时，我可以看到元素正确显示为“thickbox”类。链接看起来像这样

```
<A class="thickbox" title="" href="http://localhost:1293/Popup.aspx?
height=200&width=300&modal=true">Modal Popup</A> 
```

但是，当我单击它时，它会进行完全刷新，并且目标页面会在浏览器中加载，而不是在弹出窗口中。似乎当`<A>`为Thickbox控件在初始加载后注入DOM时，jQuery不再能够发挥它的魔力并拦截锚链接请求。有人对如何更好地做到这一点有想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T19:23:58.097

我有同样的问题，除了[Shadowbox](http://www.shadowbox-js.com/)。我最终做的是创建一个函数来在单击锚点时手动打开阴影框。

看起来[在这里](http://codylindley.com/thickboxforum/comments.php?DiscussionID=659&page=1)和[这里](http://codylindley.com/thickboxforum/comments.php?DiscussionID=95&page=1#Item_7)对于 ThickBox 可能有一些类似的修复，尽管它们有点旧。您也许可以利用这些来开发一个好的解决方案。

# file - 当我尝试编辑文件时，为什么我的 Perl 脚本会删除整个文件的内容？

> ID：941300
> 
> 赞同：0
> 
> 时间：2009-06-02T18:59:35.900
> 
> 标签：file, perl

我正在运行以下代码来打开文件（测试）并编辑（搜索和替换）它。程序似乎打开了文件，但没有替换它，而是删除了文件中的所有内容。我不确定为什么会这样。有谁可以帮我离开这里吗？

```
#!use/bin/perl
use strict;
use warnings;

my $line = $ARGV[0];
my $find = '\s{6}seqfile\s=\sinfile';
my $replace = '\s{6}seqfile\s=\sinfil2';

open (FILE, ">/home/shubhi/Desktop/pamlrun/test") || die "cant open file \n";
my @body = <FILE>;
foreach $line(@body)
{
(s/$find/$replace/g);
{
print FILE "$line";
}
}
close(FILE);
print "reached here\n";
exit; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-02T19:06:16.620

`open(FILE, ">filename")` opens the file in replace mode, writing over whatever there was previously.

Also, you cannot have a regexp in the substitution pattern `$replace`.

If I understood your intent correctly, this could be replaced with an one-liner

```
perl -pi -e 's/(\s{6}seqfile\s=\sinfil)e/${1}2/' /home/shubhi/Desktop/pamlrun/test 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-02T19:00:58.503

您的 open() 正在打开一个文件句柄以写入您的文件。代替

```
open (FILE, ">/home/shubhi/Desktop/pamlrun/test") || die "cant open file \n"; 
```

和

```
open (FILE, "/home/shubhi/Desktop/pamlrun/test") || die "cant open file \n"; 
```

在您发布的代码中，它会立即创建此文件以仅用于输出。您应该打开文件，读取/处理内容，然后将其写出。如果文件很大，则在读取旧文件时写入*新*文件，并在（成功）完成后替换旧文件。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-02T19:34:40.383

It looks like you want in-place editing magic. The easiest way to get this is to use `$^I` with the magic of `@ARGV` plus `<>` (look for null filehandle in the [I/O Operators section](http://perldoc.perl.org/perlop.html#I%2fO-Operators)):

```
#!/usr/bin/perl

use strict;
use warnings;

my $find = qr/\s{6}seqfile\s=\sinfile/;
my $replace = '      seqfile = infil2';

@ARGV = ("/home/shubhi/Desktop/pamlrun/test");

$^I = ".bak"; #safe the old files as file.bak

while (<>) {
    s/$find/$replace/g;
    print;
} 
```

Also, given the nature of your regex, it looks like you probably want `[ ]` (match a space) or `\t` (match a tab) not `\s`. `\s` will match tabs, spaces, and other whitespace characters.

You can also use [`Tie::File`](http://perldoc.perl.org/Tie/File.html), but it doesn't seem to provide a backup capability:

```
#!/usr/bin/perl

use strict;
use warnings;

use Tie::File;

my $find = qr/\s{6}seqfile\s=\sinfile/;
my $replace = '      seqfile = infil2';

tie my @lines, "Tie::File", "testdata"
    or die "could not open file: $!";

for my $line (@lines) {
    $line =~ s/$find/$replace/g;
} 
```

Of course, you could roll your own backups with [`File::Copy`](http://perldoc.perl.org/File/Copy.html):

```
#!/usr/bin/perl

use strict;
use warnings;

use Tie::File;
use File::Copy;

my $find = qr/\s{6}seqfile\s=\sinfile/;
my $replace = '      seqfile = infil2';

copy "testdata", "testdata.bak"
    or die "could not backup file: $!";

tie my @lines, "Tie::File", "testdata"
    or die "could not open file: $!";

for my $line (@lines) {
    $line =~ s/$find/$replace/g;
} 
```

* * *

I would also be remiss if I did not point out that this is basically a one-liner:

```
perl -pi.bak -e 's/\s{6}seqfile\s=\sinfile/      seqfile = infil2/' testdata 
```

This can be shortened further with Perl 5.10 by taking advantage of `\K` (zero-width positive look-behind):

```
perl -pi.bak -e 's/\s{6}seqfile\s=\s\Kinfile/infil2/' testdata 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T19:02:22.477

写打开 = '>' 读打开 = '<'

# c# - C# 面板作为 MDI 容器

> ID：941306
> 
> 赞同：4
> 
> 时间：2009-06-02T19:00:59.017
> 
> 标签：c#, forms, panel, mdi

在 C# 中，我想创建一个具有 MDI 容器属性的面板，即。isMdiContainer = 真。

我尝试过这样的事情

```
form.MDIParent = this.panel1; 
```

但这不起作用。有什么建议么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-07-30T07:38:58.923

可以创建一个 MDI 面板并在该面板中显示表单，类似于下面的代码将完成这项工作

Mdi-Panel 定义：

```
public class MdiClientPanel : Panel
{
    private Form mdiForm;
    private MdiClient ctlClient = new MdiClient();

    public MdiClientPanel()
    {
        base.Controls.Add(this.ctlClient);
    }

    public Form MdiForm
    {
        get
        {
            if (this.mdiForm == null)
            {
                this.mdiForm = new Form();
                /// set the hidden ctlClient field which is used to determine if the form is an MDI form
                System.Reflection.FieldInfo field = typeof(Form).GetField("ctlClient", System.Reflection.BindingFlags.NonPublic | System.Reflection.BindingFlags.Instance);
                field.SetValue(this.mdiForm, this.ctlClient);
            }
            return this.mdiForm;
        }
    }
} 
```

用法：

```
/// mdiChildForm is the form that should be showed in the panel
/// mdiClientPanel is an instance of the MdiClientPanel
myMdiChildForm.MdiParent = mdiClientPanel1.MdiForm; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T19:16:58.797

您可以创建自定义表单，删除所有边框和工具栏，使其看起来尽可能接近面板。然后使这个新的自定义表单成为 MdiContainer。

基本上，您只能在 Form 上设置 IsMDIContainer 属性。这意味着只有一个表单可以是一个 MdiContainer。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-02-02T13:19:52.263

我在上面使用了 Mathias 的答案，并且能够摆脱评论中提出的大部分问题。我也为子表单创建了一个辅助类，以防有人想使用它和/或让它变得更好。

```
 public class MdiClientPanel : Panel
{
    private MdiClient _ctlClient = new MdiClient();

    // Callback event when a child is activated
    public delegate void ActivateHandler(object sender, MdiClientForm child);
    public event ActivateHandler OnChildActivated;

    /// <summary>
    /// The current active child form
    /// </summary>
    public Form ActiveMDIWnd
    {
        get;
        set;
    }

    /// <summary>
    /// List of available forms
    /// </summary>
    public List<MdiClientForm> ChildForms = new List<MdiClientForm>();

    /// <summary>
    /// Std constructor
    /// </summary>
    public MdiClientPanel()
    {
        base.Controls.Add(_ctlClient);
    }

    private Form _mdiForm = null;
    public Form MdiForm
    {
        get
        {
            if (_mdiForm == null)
            {
                _mdiForm = new Form();
                // Set the hidden _ctlClient field which is used to determine if the form is an MDI form
                System.Reflection.FieldInfo field = typeof(Form).GetField("ctlClient", 
                    System.Reflection.BindingFlags.NonPublic | System.Reflection.BindingFlags.Instance);

                field.SetValue(_mdiForm, _ctlClient);
            }
            return _mdiForm;
        }
    }

    private void InitializeComponent()
    {
        SuspendLayout();
        ResumeLayout(false);
    }

    /// <summary>
    /// Add this Form to our list of children and set the MDI relationship up
    /// </summary>
    /// <param name="child">The new kid</param>
    /// <returns>The new kid</returns>
    public MdiClientForm AddChild(MdiClientForm child)
    {
        child.MyMdiContainer = this;
        child.MdiParent = MdiForm;
        ChildForms.Add(child);

        return child;
    }

    /// <summary>
    /// The user sent a "restore" command, so issue it to all children
    /// </summary>
    public void RestoreChildForms()
    {
        foreach (MdiClientForm child in ChildForms)
        {
            child.WindowState = FormWindowState.Normal;
            child.MaximizeBox = true;
            child.MinimizeBox = true;
        }
    }

    /// <summary>
    /// Send the Activated message to the owner of this panel (if they are listening)
    /// </summary>
    /// <param name="child">The child that was just activated</param>
    public void ChildActivated(MdiClientForm child)
    {
        ActiveMDIWnd = child;

        if (OnChildActivated != null)
            OnChildActivated(this, child);
    }

    /// <summary>
    /// The child closed so remove them from our available form list
    /// </summary>
    /// <param name="child">The child that closed</param>
    public void ChildClosed(MdiClientForm child)
    {
        ChildForms.Remove(child);
    }
}

/// <summary>
/// A wrapper class for any form wanting to be an MDI child of an MDI Panel
/// </summary>
public class MdiClientForm : Form
{
    /// <summary>
    /// My parent MDI container
    /// </summary>
    public MdiClientPanel MyMdiContainer { get; set; }

    /// <summary>
    /// Standard Constructor
    /// </summary>
    public MdiClientForm()
    {
        Activated += OnFormActivated;
        FormClosed += OnFormClosed;
    }

    /// <summary>
    /// Reports back to the container when we close
    /// </summary>
    void OnFormClosed(object sender, FormClosedEventArgs e)
    {
        MyMdiContainer.ChildClosed(this);
    }

    /// <summary>
    /// Reports back to the parent container when we are activated
    /// </summary>
    private void OnFormActivated(object sender, EventArgs e)
    {
        MyMdiContainer.ChildActivated(this);
    }
} 
```

# ruby-on-rails - 什么会导致 Rails 页面缓存停止工作？

> ID：941309
> 
> 赞同：2
> 
> 时间：2009-06-02T19:01:31.403
> 
> 标签：ruby-on-rails, ruby, .htaccess, caching

我有一个 Rails 应用程序在某处停止缓存，我不确定是哪个版本可能阻止它工作。

我的印象是页面缓存在正常工作时，如果找到缓存的文件，甚至不应该命中 Rails。但是，当加载我的页面并监控 production.log 时，它会同时影响 Rails 和 DB。

我设置了一个清扫器，可以清除 :create、:update 和 :destroy 上的缓存。它工作正常，因为 /public/cache/index.html 文件会在其中一个事件发生时更新。起初我以为可能是因为我使用的是 OutputCompression 插件，但删除它有相同的结果，所以我把它放回去了。 index.html 在那里，但是 .htaccess 和 Rails 忽略它并重建整个页面，包括重写缓存的 index.html。

以下是代码的相关部分（除非我遗漏了什么）：

控制器：

```
class SecretsController < ApplicationController
  caches_page :index
  cache_sweeper :secret_sweeper, :only => [:create, :update, :destroy]

  # snipped
end 
```

.ht 访问：

```
RewriteEngine On

# Rewrite index to check for cached
RewriteRule ^/$ /cache/index.html [QSA]
RewriteRule ^$ /cache/index.html [QSA]
RewriteRule ^([^.]+)$ $1.html [QSA]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.*)$ dispatch.fcgi [QSA,L] 
```

Firebug 响应标头

```
Date: Tue, 02 Jun 2009 18:50:36 GMT
Server: Apache/1.3.41 (Unix) mod_fastcgi/2.4.2 PHP/5.2.9 mod_log_bytes/1.2 mod_bwlimited/1.4 mod_auth_passthrough/1.8 FrontPage/5.0.2.2635 mod_ssl/2.8.31 OpenSSL/0.9.8b
Vary: Accept-Encoding
X-Runtime: 0.05637
Etag: "4f3497a74141d1e92ae7a1fe4d5dc1d2"
Cache-Control: private, max-age=0, must-revalidate
Content-Encoding: gzip
Content-Length: 22356
Connection: close
Content-Type: text/html; charset=utf-8
default-style: tms 
```

我希望能够使用 mod_gzip，但 ASmallOrange 不支持它，而 DreamHost 支持它（在他们将我的价格翻了三倍之前）。

无论如何，任何人都可以解释为什么 Rails 忽略了缓存的 index.html 吗？我假设它是 .htaccess 中的东西，因为如果它工作正常，它不应该接触 Rails。

**编辑**：缓存问题原来是 RewriteRules 上的第一个斜线。在我将它们都更改为“cache/index.html”之前，它没有找到缓存文件，现在缓存工作得很好。

但是，现在我必须删除 OutputCompression 调用，因为它返回的是内容类型设置为“text/html”的文件的 gzip 压缩版本。知道如何让它为该文件发送正确的内容类型吗？它是整个应用程序中唯一缓存的一个。

**再次编辑**：将 .htaccess 更改为此对 gzip 问题没有帮助：

```
RewriteRule ^/$ cache/index.html [QSA,T=application/x-gzip]
RewriteRule ^$ cache/index.html [QSA,T=application/x-gzip] 
```

它仍然显示为 zip 文件的文本表示（即乱码），除非压缩被禁用。不过，缓存效果很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-05T07:10:25.940

为什么要使用 OutputCompression 插件？Apache 可以为您做到这一点。查看[mod_deflate](http://httpd.apache.org/docs/2.2/mod/mod_deflate.html)。

这是我使用的规则：

```
# Deflate
AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css application/javascript application/x-java
script
BrowserMatch ^Mozilla/4 gzip-only-text/html
BrowserMatch ^Mozilla/4\.0[678] no-gzip
BrowserMatch \bMSIE !no-gzip !gzip-only-text/html 
```

这将压缩来自应用程序的所有文本输出，静态和动态。

只是一个猜测，但我想这也更快，因为它是一个用 C 编写的 Apache 模块。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T01:39:50.460

我会检查你的 ETag 配置。如果您使用多个 Web 服务器并且未将其配置为独立于提供文件的机器，这通常会阻止文件的正确缓存。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-20T16:10:24.123

终于找出问题所在，我的网站在停机 10 周后再次上线。一旦我得到它来加载缓存文件，我发现另一个问题是 OutputCompression 插件将文件压缩为 .gz 文件，但 Rails 将其保存为 .html，而 Apache 将其作为 text/html 提供，结果胡言乱语。

解决了我的问题的修复：

在 .htaccess 中：

```
AddEncoding x-gzip .gz
AddType text/html .gz

RewriteRule ^/$ cache/index.gz [QSA]
RewriteRule ^$ cache/index.gz [QSA] 
```

在 config/environments.rb 中：

```
ActionController::Base.page_cache_extension = ".gz" 
```

Ruby 代码使“caches”指令保存为“cache/index.gz”而不是“cache/index.html”。AddEncoding 告诉它不要将其作为 html 提供，但它本身只会显示页面源，因为它默认为“text/plain”的 Content-Type。AddType 改变了一些东西，以便 .gz 文件作为“文本/html”提供，从而导致正确显示。

这可能不适用于所有人，但由于我不在网站上的任何地方提供 .gz 文件，而且首页是唯一缓存的，所以这对我来说非常有效。

感谢大家的帮助。

# xml - XSLT 样式表的 IDE

> ID：941315
> 
> 赞同：12
> 
> 时间：2009-06-02T19:02:31.743
> 
> 标签：xml, xslt, ide

什么是创建和调试复杂 XSLT 样式表的最佳 IDE？

对于调试，设置断点和单步调试源代码的能力会很棒。

我对商业和免费的所有选项都感兴趣。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-02T19:08:55.257

值得一看的编辑：

*   视觉工作室
*   Altova 的[StyleVision/XMLSpy](http://www.altova.com/)
*   [氧](http://www.oxygenxml.com/)
*   [手写笔工作室](http://www.stylusstudio.com/xslt_editor.html)

都有其特定的优势，所以只需检查一下。如果你已经有 Visual Studio，我建议你刚开始使用这个。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-02T19:04:05.267

我使用 Visual Studio。它允许您设置断点（条件或其他方式）并在您可以提出的任何 XPath 表达式上建立监视。它还支持开箱即用的 XSLT，并且颜色与常规 XML 不同，因此在其中进行开发非常容易。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-02T19:05:39.880

我的建议是 XMLSpy，但不是免费的 - [http://www.altova.com/products/xmlspy/xmlspy.html](http://www.altova.com/products/xmlspy/xmlspy.html)

如果你正在寻找免费的，你可以试试 NetBeans - [http://www.netbeans.org/](http://www.netbeans.org/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T19:05:38.260

我从这里的某人那里得到了[Altova XMLSpy](http://www.altova.com/xml-editor/)的推荐，在我使用它的几天里，它非常好。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-16T23:23:20.327

我很高兴使用 XML Cooktop 进行轻型 XSL 开发。它是免费的，对我来说相当可靠。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T18:57:10.033

XML Spy 是我用过的最好的，毫无疑问。但它非常昂贵。

我认为 XSLT 调试和单步执行确实被高估了。诚然，当我开始使用 XSLT 时*没有*调试器，所以我可能只是认同我的折磨者。但是，让编写 XSLT 常常感觉就像穿着紧身衣开车一样困难的事情（例如，变量没有）也使得使用调试器并没有比插入-打印-语句范例更有用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-10-10T12:00:50.933

我推荐**[液体工作室](https://www.liquid-technologies.com/xml-studio)**。

对于 XSLT 转换，您甚至可以使用其功能强大的*Community Edition*。它缺少商业版中的许多功能，例如：

*   图表视图
*   图形视图
*   网络服务工具
*   XPath 工具
*   调试器
*   重构
*   XML Schema 文档和 XML 文档生成器
*   Visual Studio 扩展
*   XML 差异等。

但是*Community Edition作为***XML（WSDL、XSLT、XQuery、DTD、CSS、XDR、XML Schema、JSON）**的编辑器仍然足够酷：

*   自动完成（基于模式）
*   代码着色
*   可折叠部分
*   拼写检查器（语法和 XML 验证）

社区版也以 15 天试用期开始，因此您可以在决定版本之前评估这些付费功能。

如果您真的需要 XSLT 调试，那么您可以选择*XML Editor Edition*。尽管*Community Edition*仍然允许平滑转换，同时能够在同一个 IDE 中处理源文件、目标文件和样式文件。

您可以[在此处](https://www.liquid-technologies.com/xml-studio-editions)找到更多详细信息。

希望这可以帮助。

# c# - 后代可见的公共类成员

> ID：941322
> 
> 赞同：0
> 
> 时间：2009-06-02T19:03:45.923
> 
> 标签：c#, design-patterns, builder-pattern

作为另一个类的公共类成员，我从构建器模式中获得了很大的吸引力：

```
public class Part
{
    public class Builder
    {
        public string Name { get; set; }
        public int Type { get; set; }

        public Part Build()
        {
            return new Part(Name, Type);
        }
    }

    protected Part(string name, int type)
    {
        ...
    }
} 
```

注意受保护的构造函数 - 我喜欢我必须使用生成器来获取零件的方式。来电

```
Part p = new Part.Builder() { Name = "one", Type = 1 }.Build(); 
```

工作得很好。我想做的是使用这个构建器来提供基于类型的特殊部件（例如）：

```
public class SpecialPart : Part
{
    protected SpecialPart(string name, int type) : base(name, type) { }
} 
```

并对构建器进行了轻微更改：

```
public Part Build()
{
    if (Type == _some_number_)
        return new SpecialPart(Name, Type);
    return new Part(Name, Type);
} 
```

但这不起作用 - Part.Builder 看不到 SpecialPart 的受保护构造函数。如何让 Builder 使用 Part 的后代并获得相同的 must-have-a-builder 语义？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T19:14:05.857

给猫剥皮的方法有很多，但这里阻力最小的方法是让你的各种部件类型的构造函数公开或内部。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T19:14:22.110

您不能这样做，除非将它们放在自己的程序集中并使用内部访问说明符。

# java - .net 中的这个 java 技术栈？

> ID：941323
> 
> 赞同：5
> 
> 时间：2009-06-02T19:04:01.460
> 
> 标签：java, .net, frameworks

我为 Java 工作了 7 年，现在正在进入 .net 中的一个项目。我所在的团队最近在业务层及以下使用了一个我们相当满意的技术栈：

*   Spring 用于依赖注入、事务管理、安全性和添加拦截器，以及在单元测试中注入不同接口实现的可能性，而不是部署在服务器上。
*   JUnit 用于单元测试。
*   用于 ORM 的 JPA/休眠

你能在.net中使用这个堆栈吗？我听说过 nHibernate、spring.net 和 nUnit。

这些是.net的翻译吗？或者那些项目已经死了，实施不好还是什么？

还有其他更优秀的技术/框架吗？

欣赏你的想法！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-02T19:09:11.903

您成功了 - NHibernate、Spring.NET 和 NUnit 都是 .NET 方面广泛使用的框架，它们在 java 方面补充了它们的姊妹框架。

这些项目都没有濒临死亡。实际上，我认为 NUnit 上个月刚刚发布了一个新版本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T19:09:15.520

我会推荐 xUnit.net 而不是 nUnit。它有一种合理化的方法和一些非常好的特性，使其与其他框架区分开来。

`Assert.Throws()`真是太棒了（击败`[ExpectedException]`手），并且扩展程序集提供了`[Theory]`它，结合`[InlineData()]`，非常强大。有关更多信息，请参阅[项目主页](http://www.codeplex.com/xunit)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-02T19:12:20.273

您提到的框架（据我所知）仍然是当前和积极的开发。我可能会建议一些替代品来看看。

1.  Spring.NET 是我唯一知道的做你所说的事情。

2.  nUnit 是一个不错的选择。您可能想要查看不同版本的 Visual Studio。不同的版本具有不同的功能……有些内置了繁重的单元测试功能。

3.  nHibernate 是一个很好的 .NET ORM。随着 .NET 3.5 的发布，您可能想要查看实体框架或 LINQ to SQL 类。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T19:09:26.160

nHibernate 和 nUnit 非常活跃。最初它们是 java 对应的端口，但我相信从那时起已经发展了。

虽然无法与 spring.net 交谈..

# c# - 如果在 SqlDataReader 之前关闭 SqlConnection 会发生什么？

> ID：941326
> 
> 赞同：3
> 
> 时间：2009-06-02T19:04:37.433
> 
> 标签：c#, .net, sql, database, vb.net

如果在使用该连接调用 SqlDataReader 上的 Close() 之前调用 SqlConnection 对象上的 Close() 会发生什么？

实际上，我真正想知道的是关闭它们的顺序是否重要。调用 SqlConnection.Close() 是否完全关闭连接，或者如果您不使用该连接在 SqlDataReader 上调用 Close() ，它将保持打开状态？

很抱歉有多个问题，但我认为我并不真正了解连接关闭的工作原理。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-06-02T19:06:08.197

它将关闭连接（将其返回到池中）并`SqlDataReader`抛出异常 ( `System.InvalidOperationException`) 以防以后使用它。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-02T19:11:09.947

与其担心如何关闭它们的顺序，不如将它们包装在 using 语句中。

```
// the following code has parts left out for brevity...
using(var conn = new SqlConnection( ... ))
using(var cmd = new SqlCommand( ... ))
{
    conn.Open();

    using(var reader = cmd.ExecuteReader())
    {
        // do whatever with the reader here...
    }
} 
```

using 语句确保您的对象已关闭，并且如果您相应地嵌套它们，则以正确的顺序关闭它们。有关详细信息，请参阅[http://msdn.microsoft.com/en-us/library/yh598w02.aspx](http://msdn.microsoft.com/en-us/library/yh598w02.aspx)。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-02T19:25:29.077

当您关闭/处置`SqlConnection`对象时，实际的数据库连接将被关闭（返回到池中），因此数据库资源是安全的。

但是，您应该关闭/处置`SqlDataReader`也，否则它将保留对`SqlConnection`对象的引用，将它们都保存在内存中。`SqlDataReader`如果您不这样做，最终终结器将处置该对象，然后该`SqlConnection`对象也可以被收集，但您无法控制何时发生。

关闭连接后，它`SqlDataReader`可以部分使用，但没有什么是您真正可以依赖的。它的缓冲区中仍然有一些数据，因此某些操作可能会起作用，但是任何需要来自数据库的更多数据的操作都会导致异常。

# php - PHP：如何创建文件并将其 ftp 到另一台服务器？

> ID：941334
> 
> 赞同：2
> 
> 时间：2009-06-02T19:05:41.393
> 
> 标签：php, php4

我们正在与供应商建立直接发货协议，我们不必将他们的产品存入我们只需将其出售并运送出去的供应商。为了通知他们订单，他们希望我们通过 FTP 将带有订单信息的制表符分隔的 .txt 文件上传到他们的网站。我们想自动化这个。因此，鉴于 ftp 的用户/通行证，有没有办法创建 TSV.txt 文件并使用 PHP 将其上传到他们的站点？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T19:15:34.527

PHP5 中的 file_put_contents() 或 PHP4 中的 fopen()/fwrite()/fclose() 的组合应该可以完成这项工作。无论如何，您应该提供用户并在 FTP URL 内部传递，如下所示：

[ftp://user:password@example.com/pub/file.txt](ftp://user:password@example.com/pub/file.txt)

如果上述方法不起作用，[ftp_*](http://www.php.net/manual/en/book.ftp.php)函数应该可以解决您的问题。无论如何，请注意它们可用的 PHP 版本。某些功能仅适用于 PHP5 及更高版本。

这是详细介绍PHP 中[的 FTP 流包装器的页面。](http://www.php.net/manual/en/wrappers.ftp.php)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T19:15:08.833

[PHP FTP 示例](http://www.php.net/manual/en/ftp.examples-basic.php)

我当然不熟悉您的订单信息，但您可以创建一个订单信息数组并使用[fputcsv](http://www.php.net/manual/en/function.fputcsv.php)创建制表符分隔文件。

您是否还需要使用 $_POST 信息制作文件的详细信息？或者只是实现解决方案的通用函数调用？

编辑：另外，是否有可能找到另一种解决方案，然后通过 FTP 获取信息？比如说，与他们的服务器建立 HTTPS 连接或其他什么？如果您要发送任何收件人信息（地址、邮编、信用卡），这可能是一个安全问题。

# matlab - 如何在 MATLAB 中清除控制台？

> ID：941335
> 
> 赞同：32
> 
> 时间：2009-06-02T19:05:42.143
> 
> 标签：matlab, console

如何在 MATLAB 中清除控制台？

例如，我正在调试一个显示*大量*输出的脚本。我想在每次运行时清除控制台，所以我不必查看旧运行的输出。

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2009-06-02T19:07:46.493

简短的回答，[`clc`](https://www.mathworks.com/help/matlab/ref/clc.html)功能：

```
>> clc 
```

您也可以在 MATLAB 桌面（旧版本）中选择**Edit** > **Clear Command Window**或从 Command Window 下拉菜单中选择**Clear Command Window ：**

[![在此处输入图像描述](https://i.stack.imgur.com/RkUQY.png)](https://i.stack.imgur.com/RkUQY.png)

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-06-02T19:17:19.483

```
>> clc %clear command 
```

相关功能包括：

```
>> clf %clear figure
>> cla %clear axis
>> close all %close all windows
>> clear %clear workspace of variables 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-03T18:42:21.937

实现 clc 的另一种选择是右键单击命令窗口并选择“清除命令窗口”

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-02-17T10:42:16.303

还有一个用于清除命令窗口的默认快捷方式，即**CTRL+L**。这可能是清除输出的最快方法。

# shell - 如何将命令行参数传递给 shell 别名？

> ID：941338
> 
> 赞同：313
> 
> 时间：2009-06-02T19:06:09.100
> 
> 标签：shell, alias

如何将命令行参数传递给别名？这是一个示例：

```
别名 mkcd='mkdir $1; cd $1;'

```

但在这种情况下，$xx 在别名创建时而不是在运行时被翻译。但是，我已经使用 shell 函数（在谷歌搜索后）创建了一个解决方法，如下所示：

```
函数 mkcd(){
  mkdir $1
  1美元
}

```

只是想知道是否有办法制作接受 CL 参数的别名。
顺便说一句 - 我使用 'bash' 作为我的默认 shell。

* * *

## 回答 #1

> 赞同：320
> 
> 时间：2014-03-27T10:23:09.807

只是为了重申已为其他 shell 发布的内容，在**Bash**中进行以下工作：

```
alias blah='function _blah(){ echo "First: $1"; echo "Second: $2"; };_blah' 
```

运行以下：

```
blah one two 
```

给出以下输出：

```
First: one
Second: two 
```

* * *

## 回答 #2

> 赞同：183
> 
> 时间：2009-06-02T19:10:29.433

您找到了方法：创建一个函数而不是别名。C shell 有一个为别名做参数的机制，但是 bash 和 Korn shell 没有，因为函数机制更灵活并且提供了相同的功能。

* * *

## 回答 #3

> 赞同：59
> 
> 时间：2009-06-02T19:15:32.420

你不能在 ksh 中，但你可以在 csh 中。

```
alias mkcd 'mkdir \!^; cd \!^1' 
```

在 ksh 中，函数是要走的路。但是如果你真的很想使用别名：

```
alias mkcd='_(){ mkdir $1; cd $1; }; _' 
```

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2009-06-02T19:15:52.717

引用 bash 手册页：

> 没有在替换文本中使用参数的机制。如果需要参数，则应使用 shell 函数（请参阅下面的函数）。

所以看起来你已经回答了你自己的问题——使用函数而不是别名

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2014-03-14T19:58:23.530

您可能还会发现此命令很有用：

`mkdir dirname && cd $_`

其中 dirname 是您要创建的目录的名称

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2017-08-20T14:58:47.913

最简单的方法是使用函数而不是别名。您仍然可以随时从 cli 调用函数。在 bash 中，您只需添加 function name() { command } 它加载与别名相同。

```
function mkcd() { mkdir $1; cd $1 ;} 
```

不确定其他shell

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2013-06-18T19:45:59.337

我发现函数不能写在`~/.cshrc`文件中。这里在别名中接受参数

例如，传递给“查找”命令的参数

```
alias fl "find . -name '\!:1'"     
Ex: >fl abc 
```

其中 abc 是作为 !:1 传递的参数

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-06-02T19:14:14.717

你实际上不能用 Bash 别名做你想做的事，因为别名是静态的。相反，请使用您创建的函数。

在这里查看更多信息： http: [//www.mactips.org/archives/2008/01/01/increase-productivity-with-bash-aliases-and-functions/](http://www.mactips.org/archives/2008/01/01/increase-productivity-with-bash-aliases-and-functions/)。（是的，我知道它是 mactips.org，但它是关于 Bash 的，所以不用担心。）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-07-22T15:08:57.133

这适用于 ksh：

```
$ alias -x mkcd="mkdir \$dirname; cd \$dirname;"
$ alias mkcd
mkcd='mkdir $dirname; cd $dirname;'
$ dirname=aaa 
$ pwd
/tmp   
$ mkcd
$ pwd
/tmp/aaa 
```

“-x”选项使别名“导出” - 别名在子shell中可见。

请注意，在脚本中定义的别名在该脚本中不可见（因为在加载脚本时会扩展别名，而不是在解释行时）。这可以通过在同一个 shell 中执行另一个脚本文件（使用点）来解决。

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2013-07-15T23:51:50.783

> 这是一个使用 python 的简单示例函数。你可以坚持在〜/ .bashrc
> 你必须在第一个左花括号后有一个空格
> python命令需要用双引号引起变量替换
> 不要忘记最后的分号

function count(){ python -c "for num in xrange($1):print num";}

```
$ count 6
0
1
2
3
4
5
$ 
```

* * *

## 回答 #11

> 赞同：-5
> 
> 时间：2017-11-02T18:56:21.300

空别名将执行其 args：

```
alias DEBUG= 
```

# wpf - 我无法理解的 Viewbox 行为

> ID：941350
> 
> 赞同：1
> 
> 时间：2009-06-02T19:08:51.777
> 
> 标签：wpf, viewbox

我有一个 DataTemplate 用作描述 Version 对象的徽标。徽标只是一张图片和一些文字。

我必须在 2 个地方使用 DataTemplate： - 作为按钮的内容 - 作为 ListBox 的缩略图项

问题是，ListBox 中的徽标必须比 Button 中的小得多。这不会对自动缩放的徽标图像造成麻烦。但是字体大小不会自动缩放。

所以有人建议我使用 ViewBox 作为整个徽标的 XAML 描述的父级。

这是数据模板：

```
 <DataTemplate DataType="{x:Type l:Version}">
            <Viewbox>
                <Grid Width="175">
                    <Image Source="{StaticResource Crate}"/>
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition />
                            <RowDefinition />
                            <RowDefinition />
                            <RowDefinition />
                            <RowDefinition />
                            <RowDefinition />
                        </Grid.RowDefinitions>

                        <TextBlock Grid.Row="0" FontSize="18" Text="{Binding Type}" />
                        <TextBlock Grid.Row="1" FontSize="20" Text="{Binding Platform}" />
                        <TextBlock Grid.Row="2" FontSize="20" Text="{Binding ApprovedVersion}" />
                        <TextBlock Grid.Row="3" FontSize="16" Text="{Binding StringFormat=C\{0\}, Path=CodeChangeList}" />
                        <TextBlock Grid.Row="4" FontSize="16" Text="{Binding StringFormat=D\{0\}, Path=DataChangeList}" />
                        <TextBlock Grid.Row="5" FontSize="16" Text="{Binding StringFormat=S\{0\}, Path=SoundChangeList}" />
                    </Grid>
                </Grid>
            </Viewbox>
        </DataTemplate> 
```

然后，我只需将按钮的 DataContext 更改为 Version 对象即可使用此模板。然后会自动使用 DataTemplate。

```
 <Button 
                x:Name="buttonVersion"
                Width="300"
                Height="300"
                Click="SelectVersionButton_Click"
                Background="Transparent"
                Content="{Binding}">
             </Button> 
```

为什么我的标志没有填满整个按钮？显然有来自无处的利润，我无法解释这一点。

有趣的是，如果我从 Grid 子项（ViewBox 的子项）中删除 Width="175"，那么 ViewBox 将完全填充按钮。**但是**，我的徽标的字体大小不再正确缩放，因为这个网格宽度就像 ViewBox 应该用来适当缩放其余部分的“参考大小”......

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T18:14:24.503

好的，这是解决问题的方法：

1.  删除 DataTemplate 网格中的 Width=175
2.  再次调整字体大小

我的字体大小针对 175x175 的板条箱图像进行了调整。板条箱图像为 256x256。如果您没有在 Grid 元素中指定 Width=175，由于图像的原始大小 (256x256)，ViewBox 似乎会计算比率。此外，由于 ViewBox，按钮 300x300 现在完全被板条箱图像填充，并且字体大小也相应增加。

所以在第 2 步中，我必须为 256x256 图像而不是 175x175 图像调整字体大小。

# asp.net-mvc - Debugging ASP.NET MVC source?

> ID：941355
> 
> 赞同：6
> 
> 时间：2009-06-02T19:09:44.070
> 
> 标签：asp.net-mvc, debugging

Trying to debug into ASP.NET MVC 1.0 source, I followed instructions like [these](http://blog.codeville.net/2009/02/03/using-the-aspnet-mvc-source-code-to-debug-your-app/), basically remove reference to system.web.mvc from my web project and add the source project I downloaded instead.

Now, I have this problem,

> The type 'System.Web.Mvc.FormMethod' exists in both 'c:\Windows\assembly\GAC_MSIL\System.Web.Mvc\1.0.0.0__31bf3856ad364e35\System.Web.Mvc.dll' and in my AppData\Local\Temp\Temporary ASP.NET Files\root\dbcbb149\897fc019\assembly\dl3\796c00fb\f345f2d6_abe3c901\System.Web.Mvc.DLL'

I tried commenting out the following from web.config

```
<add assembly="System.Web.Mvc, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" /> 
```

but it'll give a difference error

> The type 'System.Web.Mvc.Controller' is defined in an assembly that is not referenced. You must add a reference to assembly 'System.Web.Mvc, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.

Could someone help on what's going wrong and how to fix it. Thank you very much!

Ray.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-02T20:05:05.877

**There is no need to uninstall ASP.NET MVC from GAC! (or any any `<assemblyBinding>`s)** Just follow "[Using the ASP.NET MVC source code to debug your app](http://blog.codeville.net/2009/02/03/using-the-aspnet-mvc-source-code-to-debug-your-app/)" article step by step.

There are a couple of questions similar to yours:

*   [How can you use ASP.NET MVC build from source rather than the GAC?](https://stackoverflow.com/questions/905550/how-can-you-use-asp-net-mvc-build-from-source-rather-than-the-gac/907010#907010)
*   [MVC. Strongly-typed view difference (MVC sources vs. assembly)](https://stackoverflow.com/questions/892332/mvc-strongly-typed-view-difference-mvc-sources-vs-assembly/894248#894248)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T19:12:34.250

Are the system.web.mvc assemblies in the GAC? you might need to remove them ... this of course could mess up future projects as the project templates will likely assume that they are in the gac.

You could also try using the `<assemblyBinding>` feature as [described here](http://msdn.microsoft.com/en-us/library/7wd6ex19(vs.71).aspx) to point the mvc stuff to the version that you are running.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T19:16:56.927

Assuming the fully qualified assembly name for the one you're linking to differs from the one in the GAC, use the [`<QualifyAssembly>` element](http://msdn.microsoft.com/en-us/library/cd71chf0.aspx) and specify which assembly you're actually linking to. If not, change your local source to change the MVC assembly you're building to 1.0.0.1 so it is different.

**Edit**: Double check the howto you linked. It worked for me.

1.  removed the system.web.mvc reference in my project.
2.  Added the System.Web.Mvc project from source.
3.  Comment out the System.Web.Mvc reference in my project's web.config.
4.  modified the System.we.b.mvc's /Views/Web.Config as stated in the howto.
5.  Ran flawlessly.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T19:30:28.397

for the qualify assembly section you want something like this (we do it for SQLite assembly):

```
 <runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <qualifyAssembly partialName="System.Data.SQLite" fullName="System.Data.SQLite, Version=1.0.60.0, Culture=neutral, PublicKeyToken=db937bc2d44ff139" />
    </assemblyBinding>
  </runtime> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T19:44:09.413

Have a look at this article for the complete guide on how to [setup MVC source](http://blog.codeville.net/2009/02/03/using-the-aspnet-mvc-source-code-to-debug-your-app/).

There are two web.config files you need to update. One is in the MVC project folder and one is in the Views folder. It's likely you forgot to update the latter. Otherwise following the aforementioned article should do it.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-01-18T11:16:20.363

A slightly more comprehensive version of Steve Sandersons instructions [can be found here](http://www.appetere.com/Blogs/SteveM/January-2010/How-to-debug-ASP-NET-MVC-using-source-code.aspx).

It explains how you can also include MVC Futures in your debugging.

# core-data - 核心数据：在谓词中查询 objectID？

> ID：941357
> 
> 赞同：41
> 
> 时间：2009-06-02T19:10:11.947
> 
> 标签：core-data, predicate, fetch

我正在使用获取请求和谓词从核心数据持久存储中获取一组对象。我当前的谓词只是检查一个属性是否 >= 某个值。这一切都很好，除了我想最终排除当前保存在数组中的任何对象。

我基本上需要能够排除一组对象，我认为我能做到这一点的唯一方法是能够`objectID`从我的托管对象数组中获取一个列表，并在我的谓词中创建另一个表达式以确保任何对象返回的不一样`objectID`。即`@"ANY records.objectID NOT IN %@", arrayOfObjectID`。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2009-06-02T19:14:07.057

像这样的谓词

```
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"NOT (self IN %@)", arrayOfExcludedObjects]; 
```

其中获取请求的实体是数组中对象的实体，应该做你想做的事。当然，这可以与获取请求的单个谓词中的其他子句结合使用。

一般来说，对象比较（例如`self == %@`or `self IN %@`）`objectID`在 Core Data 查询中进行比较。参数可以是 NSManagedObject 实例或*实例*`NSMangedObjectID`。所以上面的谓词格式可以采用`arrayOfExcludedObjects`or`[arrayOfExcludedObjects valueForKey:@"objectID"]`作为参数。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-08-25T21:47:23.983

虽然@BarryWark 的回答在处理获取请求时是正确的，但我想向那些将尝试将此规则应用于过滤核心数据对多关系的人写一个警告。

很快：如果在过滤多对关系时您使用谓词并且您的 IN 查询对象数组是一个 objectID 数组 - 那么您应该在查询字符串中使用**self.objectID ，例如**

```
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"(self.objectID IN %@)", arrayOfObjectIDs]; 
```

因为仅`(self IN %@)`在过滤多对关系的情况下使用会导致不正确的结果——它只是一个评估谓词的 NSArray，它对 Core Data 的 NSManagedObjectID 东西一无所知。

我制作了特殊的测试代码来展示这一点。对不起这么多台词，但值得。有两个实体：User 和 Post，并且 User 有一个名为“posts”的对多关系。

```
User *user = [NSEntityDescription insertNewObjectForEntityForName:NSStringFromClass([User class]) inManagedObjectContext:managedObjectContext()];

Post *post = [NSEntityDescription insertNewObjectForEntityForName:NSStringFromClass([Post class]) inManagedObjectContext:managedObjectContext()];

[user addPostsObject:post];

[managedObjectContext() save:nil];

// 1\. Both filtered relationship array and fetch result are correct!
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"(self IN %@)", @[ post ]];

NSSet *filteredRelationship = [user.posts filteredSetUsingPredicate:predicate];

NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] initWithEntityName:@"Post"];
NSArray *fetchResult = [managedObjectContext() executeFetchRequest:fetchRequest error:nil];

NSLog(@"\n\n\nPredicate: %@", predicate);
NSLog(@"filteredRelationship: %@", filteredRelationship);
NSLog(@"fetchResult: %@", fetchResult);

// 2\. Filtered relationship array is empty (wrong), fetch result is correct, !
predicate = [NSPredicate predicateWithFormat:@"(self IN %@)", @[ post.objectID ]];

filteredRelationship = [user.posts filteredSetUsingPredicate:predicate];

fetchRequest = [[NSFetchRequest alloc] initWithEntityName:@"Post"];
fetchResult = [managedObjectContext() executeFetchRequest:fetchRequest error:nil];

NSLog(@"\n\n\nPredicate: %@", predicate);
NSLog(@"filteredRelationship: %@", filteredRelationship);
NSLog(@"fetchResult: %@", fetchResult);

// 3\. Filtered relationship array is empty (wrong), fetch result is correct
predicate = [NSPredicate predicateWithFormat:@"(self.objectID IN %@)", @[ post ]];

filteredRelationship = [user.posts filteredSetUsingPredicate:predicate];

fetchRequest = [[NSFetchRequest alloc] initWithEntityName:@"Post"];
fetchResult = [managedObjectContext() executeFetchRequest:fetchRequest error:nil];

NSLog(@"\n\n\nPredicate: %@", predicate);
NSLog(@"filteredRelationship: %@", filteredRelationship);
NSLog(@"fetchResult: %@", fetchResult);

// 4\. Filtered relationship array is correct, fetch result is correct
predicate = [NSPredicate predicateWithFormat:@"(self.objectID IN %@)", @[ post.objectID ]];

filteredRelationship = [user.posts filteredSetUsingPredicate:predicate];

fetchRequest = [[NSFetchRequest alloc] initWithEntityName:@"Post"];
fetchResult = [managedObjectContext() executeFetchRequest:fetchRequest error:nil];

NSLog(@"\n\n\nPredicate: %@", predicate);
NSLog(@"filteredRelationship: %@", filteredRelationship);
NSLog(@"fetchResult: %@", fetchResult); 
```

* * *

**TLDR 输出**

```
<redacted> Predicate: SELF IN {<Post: 0x2a04f10> (entity: Post; id: 0x2a56c40 <x-coredata://9D07BF41-2DC0-42C1-9DD8-6082A00E7BEB/Post/p1> ; data: { content = nil; title = nil; user = "0x2af2a20 <x-coredata://9D07BF41-2DC0-42C1-9DD8-6082A00E7BEB/User/p1>"; })}

<redacted> filteredRelationship: {(<Post: 0x2a04f10> (entity: Post; id: 0x2a56c40 <x-coredata://9D07BF41-2DC0-42C1-9DD8-6082A00E7BEB/Post/p1> ; data: { content = nil; title = nil; user = "0x2af2a20 <x-coredata://9D07BF41-2DC0-42C1-9DD8-6082A00E7BEB/User/p1>"; }) )}

<redacted> fetchResult: ("<Post: 0x2a04f10> (entity: Post; id: 0x2a56c40 <x-coredata://9D07BF41-2DC0-42C1-9DD8-6082A00E7BEB/Post/p1> ; data: {\n    content = nil;\n    title = nil;\n    user = \"0x2af2a20 <x-coredata://9D07BF41-2DC0-42C1-9DD8-6082A00E7BEB/User/p1>\";\n})")

<redacted> Predicate: SELF IN {0x2a56c40 <x-coredata://9D07BF41-2DC0-42C1-9DD8-6082A00E7BEB/Post/p1>}

<redacted> filteredRelationship: {()}

<redacted> fetchResult: ("<Post: 0x2a04f10> (entity: Post; id: 0x2a56c40 <x-coredata://9D07BF41-2DC0-42C1-9DD8-6082A00E7BEB/Post/p1> ; data: {\n    content = nil;\n    title = nil;\n    user = \"0x2af2a20 <x-coredata://9D07BF41-2DC0-42C1-9DD8-6082A00E7BEB/User/p1>\";\n})")

<redacted> Predicate: objectID IN {<Post: 0x2a04f10> (entity: Post; id: 0x2a56c40 <x-coredata://9D07BF41-2DC0-42C1-9DD8-6082A00E7BEB/Post/p1> ; data: { content = nil; title = nil; user = "0x2af2a20 <x-coredata://9D07BF41-2DC0-42C1-9DD8-6082A00E7BEB/User/p1>";})}

<redacted> filteredRelationship: {()}

<redacted> fetchResult: ("<Post: 0x2a04f10> (entity: Post; id: 0x2a56c40 <x-coredata://9D07BF41-2DC0-42C1-9DD8-6082A00E7BEB/Post/p1> ; data: {\n    content = nil;\n    title = nil;\n    user = \"0x2af2a20 <x-coredata://9D07BF41-2DC0-42C1-9DD8-6082A00E7BEB/User/p1>\";\n})")

<redacted> Predicate: objectID IN {0x2a56c40 <x-coredata://9D07BF41-2DC0-42C1-9DD8-6082A00E7BEB/Post/p1>} 

<redacted> filteredRelationship: {(<Post: 0x2a04f10> (entity: Post; id: 0x2a56c40 <x-coredata://9D07BF41-2DC0-42C1-9DD8-6082A00E7BEB/Post/p1> ; data: { content = nil; title = nil; user = "0x2af2a20 <x-coredata://9D07BF41-2DC0-42C1-9DD8-6082A00E7BEB/User/p1>";}))}

<redacted> fetchResult: ("<Post: 0x2a04f10> (entity: Post; id: 0x2a56c40 <x-coredata://9D07BF41-2DC0-42C1-9DD8-6082A00E7BEB/Post/p1> ; data: {\n    content = nil;\n    title = nil;\n    user = \"0x2af2a20 <x-coredata://9D07BF41-2DC0-42C1-9DD8-6082A00E7BEB/User/p1>\";\n})") 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-07-26T10:20:26.967

斯威夫特 3 解决方案

我遇到了同样的情况，因此我在下面发布了一个 swift 3 解决方案

```
let predicate = NSPredicate(format:"NOT (self IN %@)",[arrayofNSManagedObjects]) 
```

# asp.net-mvc - 在 ASP.NET MVC 中动态添加 ViewUserControl

> ID：941361
> 
> 赞同：1
> 
> 时间：2009-06-02T19:11:00.930
> 
> 标签：asp.net-mvc

我想知道在运行时添加 ViewUserControl（到 ViewPage）是否存在任何已知问题。如果我以声明方式添加控件，但如果我以编程方式添加控件（在本例中的代码隐藏文件中），则效果很好。我没有收到错误，它只是不呈现控件，但单步调试器确实确认正在调用页面生命周期中的相关方法。

我确实意识到在 ASP.NET MVC 中使用代码隐藏文件并不完全符合规定，但我确实有理由想要这样做。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T19:17:18.547

发送要加载的控件列表并将其传递给视图模型。

控制器动作：

```
var controlsToLoad = new List<string>();
controlsToLoad.Add("foo");

return View(controlsToLoad); 
```

看法：

```
<% foreach (var control in Model as List<string>) { %>
    <% Html.RenderPartial(control); %>
<% } %> 
```

这将使您远离代码，仍然让您在控制器中动态指定要在视图中加载的控件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T19:20:27.637

或者，如果您需要其他功能，您可以更巧妙地将上述建议包装在 ViewPage 类的扩展方法中。

# unit-testing - 我创建了 NUnit 测试，现在如何运行它们？

> ID：941365
> 
> 赞同：6
> 
> 时间：2009-06-02T19:11:32.990
> 
> 标签：unit-testing, nunit, bdd

我正在开发 vs2008、c#、.net 3.5。

我下载了 NUnit 2.5 win/msi 版本。我创建了一个包含几个 [Test] 方法的 [TestFixture] 类。

如何运行测试？

当我从 Ed Ames 运行 NUnit 演示解决方案时，他的测试 .cs 文件在代码左侧的灰色列中有一个图标（断点、书签等出现的同一位置。）单击该图标会给我一个选项运行测试。

该图标没有出现在我的项目中。我需要设置一个属性吗？

此外，该文档还提到了可用于运行测试的 NUnit GUI。在 NUnit 的 msi 版本中似乎没有下载 GUI。Gui 有单独的下载吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-02T20:13:40.633

感谢您的所有帮助。

我正在使用resharper，忘记提及了。

实际上，测试没有运行（在文件中没有找到测试），因为我的 [TestFixture] 类不是公共的。将其更改为公开，我的所有测试都出现了。

另外，感谢您帮助寻找 Gui。我正在寻找文件名中带有 GUI 的 exe。但我将使用 Resharper 来运行测试。现在我找到了他们！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T19:13:23.097

您看到的演示很可能有一个 VS 插件（Resharper、TestDriven.NET 等），它不随 NUnit 提供。但是，NUnit 使用 GUI 安装。转到您安装 NUnit 的文件夹，您会在那里找到它。

该程序名为 nunit.exe，位于 bin 文件夹中。

启动它后，您需要转到 File -> Open Project 并找到您在 Visual Studio 中构建的 DLL

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T19:15:55.447

您可以使用我相信的 nUnit 附带的 nUnit 运行程序（GUI - bin 文件夹中的 nunit.exe，Console - nunit-console-x86.exe）。

或者，如果您安装了 resharper ( [http://www.jetbrains.com/resharper/](http://www.jetbrains.com/resharper/) )，它有一个测试运行器。

还有 TestDriven.Net ( [http://www.testdriven.net/](http://www.testdriven.net/) )

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T19:16:56.863

我还没有看过这个演示，但听起来很像他在使用[Resharper](http://www.jetbrains.com/resharper/)。

如果您运行 msi 安装程序，它将安装 NUnit GUI 运行程序。如果您浏览开始菜单，它可能位于 Programs -> Nunit 下。从 GUI 运行器中，您可以通过导航到项目的 bin 目录来加载测试程序集。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T19:13:55.137

您必须使用 1) Nunit 命令行或 2) Nunit GUI 打开 dll

# c# - 是否可以通过其 Web 服务将对象的数据提供给 Reporting Services 以用于生成报告

> ID：941377
> 
> 赞同：2
> 
> 时间：2009-06-02T19:13:31.503
> 
> 标签：c#, reporting-services

我希望能够为 Reporting Services 提供用于生成报告的数据（例如 XML 序列化对象，但它不是必须的）。这可能吗？如果是这样，我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T19:20:13.987

您可以将各种事物绑定到[报表查看器控件](http://www.gotreportviewer.com/)的数据源属性。

服务器始终使用报表本身中定义的数据源。因此，如果您必须使用报表服务器，则必须通过数据库汇集任何动态数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T18:58:59.453

刚刚实现了一个解决方案，我们通过 WCF 服务从数据库中提取数据，将其映射到复杂类型（具有多个属性的类，其中三个是 List），并将其用作对象数据源来显示报告在客户端的 ReportViewer 控件中。这根本不需要 Reporting Services。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-07T20:16:48.070

您可以使用“XML”数据提供者将您的数据嵌入到数据源查询或来自 Web 服务的查询中，使用~~XPath~~元素路径表达式来定义和提取您的数据集。

[MSDN http://msdn.microsoft.com/en-us/library/ms365158.aspx](http://msdn.microsoft.com/en-us/library/ms365158.aspx)上有一些文档，但并不全面。

有人应该发布一个例子。

# visual-studio-2008 - VS 单元测试框架中的单元测试模板在哪里？

> ID：941386
> 
> 赞同：2
> 
> 时间：2009-06-02T19:14:23.640
> 
> 标签：visual-studio-2008, unit-testing, t4, visual-studio-templates

当我在 Visual Studio 中创建一个新的单元测试（使用默认的、包含的单元测试框架）时，我对使用的不必要的冗长模板越来越恼火。代替

```
public ImportModelStateTest()
{
    //
    // TODO: Add constructor logic here
    //
}

private TestContext testContextInstance;

/// <summary>
///Gets or sets the test context which provides
///information about and functionality for the current test run.
///</summary>
public TestContext TestContext
{
    get
    {
        return testContextInstance;
    }
    set
    {
        testContextInstance = value;
    }
} 
```

我想简单地

```
/// <summary>
///Gets or sets the test context which provides
///information about and functionality for the current test run.
///</summary>
public TestContext TestContext { get; set; } 
```

如果我需要一个构造函数，我会添加一个，特殊的 getter 和 setter 也是如此。我还想删除包含的示例 TestMethod - 我仍然需要重命名它，所以我也可以从头开始编写自己的。

我一直在寻找用于创建这些测试文件的模板，但找不到它（我主要在用于控制器和视图的 T4 模板附近四处寻找）。我在哪里更改此模板？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T19:31:17.193

Visual Studio 的所有项目模板都从此目录运行：

> C:\Program Files\Microsoft Visual Studio 9.0\Common7\IDE\ItemTemplates

当然 c:\Program 文件可能会根据您的安装选项而改变。我认为测试模板位于此处：

> C:\Program Files\Microsoft Visual Studio 9.0\Common7\IDE\ItemTemplates\CSharp\1033

作为 UnitTestWizard.zip。

看起来好像 zip 中的文件是一个 xml 文件，当您打开它时，它指向一个事实，即它正在运行一个 dll 以在运行时生成测试文件，可能使用代码 dom。

您可以为此查看 T4 模板或编写一个 VS 插件来执行此最低设置，它不会花费很长时间来编写。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-27T16:45:11.473

您想要的书是 Keyvan Nayyeri 的“ [Professional Visual Studio Extensibility](https://rads.stackoverflow.com/amzn/click/com/0470230843) ”。这是一本很棒的书，涵盖了从宏到 VS 包的整个 Visual Studio 可扩展性 (VSX) 广度。

请务必查看 MSDN 上的[Visual Studio 可扩展性开发人员中心](http://msdn.microsoft.com/en-us/vsx/default.aspx)。另外，我建议您下载并安装[Visual Studio 2008 SDK](http://www.microsoft.com/downloads/details.aspx?FamilyId=59EC6EC3-4273-48A3-BA25-DC925A45584D&displaylang=en)。那里有一些非常好的例子，并附有源代码。

# java - 如何从 java.lang.Object getClientInfo() 获取 WTSClientAddress

> ID：941404
> 
> 赞同：1
> 
> 时间：2009-06-02T19:17:45.333
> 
> 标签：java, windows, terminal-services, oracleforms

在我们当前的一个 Web 应用程序中，我们使用Oracle Forms 应用程序中[java.lang.Object引用中的](http://www.oracle.com/technology/sample_code/products/forms/extracted/getclientinfo/doc/oracle.forms.demos.GetClientInfo.html)[getClientInfo](http://www.oracle.com/technology/sample_code/products/forms/extracted/getclientinfo/src/oracle/forms/demos/GetClientInfo.java) ()，它非常适合 egtting 系统的客户端 IP 地址。

但是，我们最近开始在我们的组织中使用 Windows 终端服务器，并且我们现在遇到了此代码返回终端服务器的 IP 地址而不是运行 TS 会话的系统的 IP 地址的问题。

我知道有本机windows函数可以使用[`WTSQuerySessionInformation`](http://msdn.microsoft.com/en-us/library/aa383838(VS.85).aspx)函数返回会话IP `user32.dll`，然后访问指针以[`WTSClientAddress`](http://msdn.microsoft.com/en-us/library/aa383857(VS.85).aspx)获取会话IP。

但是，我不知道如何在 Oracle Forms Java 开发环境中访问此类信息。

有谁知道我如何使用`WTSClientAddress`来自的参数来做到这一点`WTSQuerySessionInformation API`？

# open-source - 什么是最好的开源帮助票系统？

> ID：941405
> 
> 赞同：29
> 
> 时间：2009-06-02T19:18:20.823
> 
> 标签：open-source, ticket-system

我知道osTicket，还有其他更有吸引力的帮助票系统吗？
我的公司想要使用一个，我现在正在研究它们。

我忘了提，我需要将它安装在我们的服务器上……所以 SaaS（软件即服务）不起作用。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-02T19:31:15.837

在 Wikipedia 上有很好的信息

> [问题跟踪系统的比较](http://en.wikipedia.org/wiki/Comparison_of_issue_tracking_systems)

就个人而言，我喜欢**Trac**，它具有与 subversion 集成的能力，因此当您签入文件时，如果您说...

```
$ svn ci -m "automatically fix any broken dates in the input.  fixes #87" 
```

....然后 Trac 将自动添加此评论并为您关闭错误 #87。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-02T20:21:02.897

当然，“最佳”帮助台系统非常主观，但我推荐[Request Tracker](http://bestpractical.com/rt/)（又名 RT）。

它具有内置的默认工作流程，但可以使用“脚本”和模板轻松配置为替代工作流程。如果你愿意，非常可扩展。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-02T19:35:17.280

OTRS，地狱犬

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-02T19:44:55.373

我喜欢[eTicket Support](http://www.eticketsupport.com/)，使用和安装非常简单。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-03T07:18:19.073

这绝对取决于你的目标是什么。提到的 Bugzilla 和 Trac 系统很好，但面向错误跟踪，这与您希望在帮助台类型设置中使用的工具非常不同，最终用户会提出事件。

如果后者是您正在寻找的东西，我建议您看看**[OTRS](http://otrs.org)**，它是一个非常强大的故障票务系统。它还具有 ITSM 扩展，使其能够在需要时支持 ITIL 流程。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-04-18T10:49:51.653

我推荐 OTRS，它非常容易定制，我们也为数百名员工（大学）使用它。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-02T19:21:22.097

Bugzilla 怎么样。开源和 Mozilla 使用什么。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-02T19:23:10.110

这是一对看起来相当不错的夫妇：

[http://sourceforge.net/projects/smallhd/](http://sourceforge.net/projects/smallhd/)

[http://sourceforge.net/projects/helpdeskcsharp/](http://sourceforge.net/projects/helpdeskcsharp/)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-02T19:22:24.980

追踪。开源，基于 Python

# qt - KDE开发调试

> ID：941410
> 
> 赞同：1
> 
> 时间：2009-06-02T19:18:55.377
> 
> 标签：qt, debugging, gdb, kde

在名为 ksirtet（俄罗斯方块克隆）的 kde3 游戏中，与计算机对战时，人类玩家无法左右移动俄罗斯方块。我正在尝试修复它，但无法在 gdb 中调试。在“kapp->exec()”行 gdb 停止响应后，游戏运行，我无法输入任何命令 do gdb 以查看发生了什么。所以问题是关于调试 kde 事件循环，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T14:54:22.490

一般来说，除非必要，否则您不希望调试到事件循环中。也就是说，您可能希望在感兴趣的地方分散一些断点，尤其是在您认为代码应该在按键后运行的地方。如果您尝试从头开始逐步执​​行事件循环代码，您将在尝试与要调试的程序交互时遇到问题。

另外，如果我没记错的话，您可以在 gdb 中使用 control-c，它会在当前执行点中断程序，并恢复对您的控制。如果您真的想看看发生了什么，请尝试在游戏中排队一些事件（快速混合一堆键），然后中断 gdb 并逐步执行程序响应这些事件的操作。但是，您必须非常快，因为现代计算机上的事件循环处理非常快。

# iphone - 如何突出显示 iPhone 上的图像？

> ID：941419
> 
> 赞同：0
> 
> 时间：2009-06-02T19:20:56.513
> 
> 标签：iphone

我在 iPhone 上显示了一张照片。一开始我想降低照片的亮度，当用户触摸照片时，我想提高用户触摸附近矩形区域的亮度，如下所示：

[www.cottagearts.net/tut_images/tut_cropping_pse_06.jpg](http://www.cottagearts.net/tut_images/tut_cropping_pse_06.jpg)

谁能指出我这样做的简单方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T19:42:37.980

虽然您实际上无法调整屏幕的亮度，但您可以在屏幕上放置一个半透明的图像。我会在任何地方绘制，但用户触摸的颜色为黑色，但具有 X 透明度，这正是您链接到的图像所显示的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-23T19:00:28.157

我不是专家，但我一直在尝试做类似的事情。您可以使用图层来实现这一点。正如 Malfist 建议的那样，您可以制作一个具有一定不透明度的黑色图层，并且可以将其单击的部分完全透明或类似。另一种选择是进行一些图像处理。我在这里找到了一篇我认为可以解决我的突出显示问题的文章：

[http://arstechnica.com/apple/news/2009/03/iphone-dev-basic-image-processing-package.ars](http://arstechnica.com/apple/news/2009/03/iphone-dev-basic-image-processing-package.ars)

# c# - 如何禁用 Listview 自动查找您键入的内容

> ID：941422
> 
> 赞同：2
> 
> 时间：2009-06-02T19:22:11.813
> 
> 标签：c#, listview

我正在使用列表视图在我的应用程序中实现一些自动帮助。用户可以输入一个文件，我用它来滚动到列表视图中的适当位置。但是，如果用户将焦点转移到列表视图并在其中键入内容，则列表视图会开始自己处理用户的输入。我想启用列表视图并使其具有焦点（我从中获取键和鼠标事件），但我想关闭“我会在此处找到您输入的内容”功能。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T19:30:18.193

处理 KeyPress 事件：

```
private void listBox1_KeyPress(object sender, KeyPressEventArgs e)
{
    if (e.KeyChar >= 'a' && e.KeyChar <= 'z') // replace with desired conditional
    {
        e.Handled = true;
    }
} 
```

如果将 args 事件`Handled`属性设置为 true，则底层控件将不会处理击键。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T19:28:29.303

你可以做一个 OnKeyPress -> 清除选择

不确定这是否是最好的方法。

```
 MyListView.SelectedItems.Clear() 
```

# html - 新行字符的提交方式不同

> ID：941426
> 
> 赞同：2
> 
> 时间：2009-06-02T19:22:56.197
> 
> 标签：html, ajax, request

我想知道是否有人可以阐明这种浏览器行为：

我有一个带有 textarea 的表单，它通过 XHR（使用 jQuery，我也尝试使用纯 XMLHttpRequest 只是为了排除 jQuery 并且结果是相同的）或通过表单的“老式”方式提交到服务器提交。在这两种情况下都会使用 method="POST"。两种方式都提交到服务器上的同一个脚本。

现在有趣的部分：如果您通过 XHR 提交，换行符将被传输为“%0A”（或 \n，如果我没记错的话），如果您以常规方式提交，它们将被传输为“%0D%0A”（或\r\n)。当然，这会在服务器端引起一些问题，但这不是这里的问题。我只想知道为什么会有这种差异？不管你使用什么提交方法，新行不应该是一样的吗？还有哪些其他差异（如果有）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T19:27:52.567

在[RFC2616](http://www.ietf.org/rfc/rfc2616.txt) (HTTP1.1) 的 3.7.1 部分中，它允许 \r\n,\r,\n 表示换行符。

> HTTP 放宽了这一要求，并允许传输具有纯 CR 或 LF 的文本媒体，当它对整个实体主体一致完成时，它代表一个换行符。HTTP 应用程序必须接受 CRLF、裸 CR 和裸 LF 作为通过 HTTP 接收的文本媒体中的换行符的代表。

但这不适用于控制结构：

> 这种关于换行的灵活性仅适用于实体主体中的文本媒体；在任何 HTTP 控制结构（例如标头字段和多部分边界）中，不得用裸 CR 或 LF 替换 CRLF。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T19:32:05.053

XMLHttpRequest 将在发送 XML 时从流中去除 CR 字符。这与指示将 CRLF 规范化为简单 LF 的 XML 规范一致。

因此，如果您将内容打包为 XML 并通过 XHR 发送，您将丢失 CR。

# java - 为什么在这种情况下使用 BufferedReader？

> ID：941432
> 
> 赞同：6
> 
> 时间：2009-06-02T19:24:07.753
> 
> 标签：java, xml, bufferedreader

在以下代码中围绕 StringReader 使用 BufferedReader 与仅使用 StringReader 有什么区别？通过在两个示例的第 2 行加载 DOM，似乎不需要 BufferedReader？

```
 InputSource is = new InputSource(new StringReader(html));
    Document dom = XMLResource.load(is).getDocument(); 
```

VS

```
 InputSource is = new InputSource(new BufferedReader(new StringReader(html)));
    Document dom = XMLResource.load(is).getDocument(); 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-06-02T19:29:56.743

在这种特殊情况下，我看不到任何好处。一般来说有两个好处：

*   oh-so-handy[`readLine()`](http://java.sun.com/javase/6/docs/api/java/io/BufferedReader.html#readLine())方法只定义在`BufferedReader`而不是`Reader`（这里无关）
*   `BufferedReader`减少对底层读取器的单独调用可能很昂贵的 IO（即，更少的大块调用比许多小的调用更快） - 同样，与`StringReader`

剪切和粘贴失败？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-02T19:26:34.487

编辑：我的原始答案如下。在这种情况下，下面*的内容不*相关，因为缓冲的阅读器正在包装一个 StringReader，它包装了一个字符串。所以没有要执行的缓冲，而且 BufferedReader 似乎是多余的。您*可以*为使用最佳/一致的实践提出论据，但这将非常脆弱。

可能是复制/粘贴的结果，或者可能是 IDE 驱动的重构太过分了！

BufferedReader 将尝试以更优化的方式进行读取。

也就是说，它将一次性读取更大的数据块（以可配置的数量），然后根据需要提供。这将以牺牲一些内存使用为代价来减少从磁盘（等）读取的次数。

引用 Javadoc：

> 通常，由 Reader 发出的每个读取请求都会导致对底层字符或字节流发出相应的读取请求。因此，建议将 BufferedReader 包装在 read() 操作可能成本高昂的任何 Reader 周围，例如 FileReaders 和 InputStreamReaders

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T19:26:28.717

BufferedReader 版本是从一些用于从 FileReader 读取的代码中复制的？

# c# - c# p/invoke 编组指针的困难

> ID：941440
> 
> 赞同：4
> 
> 时间：2009-06-02T19:25:36.940
> 
> 标签：c#, pointers, interop, pinvoke

我正在尝试使用 p/invoke 从 c# 调用本机 .dll。我能够进行调用（没有崩溃，函数返回一个值），但返回代码指示“指针参数不指向可访问的内存”。为了解决这个问题，我采取了反复试验，但到目前为止我还没有取得任何进展。

这是我正在调用的本机函数的签名：

```
LONG extern WINAPI MyFunction ( LPSTR lpszLogicalName, //input
                                   HANDLE hApp,           //input  
                                   LPSTR lpszAppID,       //input 
                                   DWORD dwTraceLevel,    //input
                                   DWORD dwTimeOut,       //input
                                   DWORD dwSrvcVersionsRequired, //input
                                   LPWFSVERSION lpSrvcVersion, //WFSVERSION*, output
                                   LPWFSVERSION lpSPIVersion,  //WFSVERSION*, output
                                   LPHSERVICE lphService       //unsigned short*, output
                                 ); 
```

这是 C# 中导入的签名：

```
 [DllImport("my.dll")]
 public static extern int MyFunction( [MarshalAs(UnmanagedType.LPStr)] 
                                      string logicalName, 
                                      IntPtr hApp, 
                                      [MarshalAs(UnmanagedType.LPStr)] 
                                      string appID, 
                                      int traceLevel, 
                                      int timeout, 
                                      int srvcVersionsRequired, 
                                      [Out] WFSVersion srvcVersion, 
                                      [Out] WFSVersion spiVersion,
                                      [Out] UInt16 hService
                                    ); 
```

这是 WFSVERSION 的 C 定义：

```
typedef struct _wfsversion
{
    WORD            wVersion;
    WORD            wLowVersion;
    WORD            wHighVersion;
    CHAR            szDescription[257];
    CHAR            szSystemStatus[257];
} WFSVERSION, * LPWFSVERSION; 
```

这是 WFSVersion 的 C# 定义：

```
[StructLayout(LayoutKind.Sequential)]
public class WFSVersion
{
    public Int16 wVersion;
    public Int16 wLowVersion;
    public Int16 wHighVersion;
    [MarshalAs(UnmanagedType.ByValArray, SizeConst = 257)]
    public char[] szDescription;
    [MarshalAs(UnmanagedType.ByValArray, SizeConst = 257)]
    public char[] szSystemStatus;
} 
```

这是从 C# 对 MyFunction 的调用：

```
WFSVersion srvcVersionInfo = new WFSVersion();
WFSVersion spiVersionInfo = new WFSVersion();

 UInt16 hService = 0;
 IntPtr hApp = IntPtr.Zero;
 string logicalServiceName = tbServiceName.Text;
 int openResult = MyFunction(logicalServiceName, hApp, null, 0,  
                              XFSConstants.WFS_INDEFINITE_WAIT,
                              0x00000004, srvcVersionInfo, spiVersionInfo, 
                              hService); 
```

正如我所说，此调用返回，但返回值是一个错误代码，指示“指针参数未指向可访问的内存”。我一定是对参数 1、3、7、8 或 9 做错了什么。但是，我已经成功调用了这个 .dll 中需要 WFSVERSION* 作为参数的其他函数，所以我不认为参数 7 或8是这里的问题。

如果您对这个问题的原因有任何想法，或者对我的代码提出任何建设性的批评，我将不胜感激。这是我第一次使用 P/Invoke，所以我不知道从哪里开始。有什么方法可以缩小问题的范围，还是尝试错误是我唯一的选择？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T10:28:48.207

这里有两个明显的错误。在您的结构定义中，您应该对 szDescription 和 szSystemStatus 使用 byte[] 而不是 char[]。

pInvoke 调用中的最后一个参数也不是指针。当您调用 MyFunction 时，hService 为零，因此就函数而言，它是一个无效的指针。[Out] 是一个 Marshaling 指令，它告诉运行时何时何地复制数据，而不是指示参数是指针。您需要将 [Out] 更改为 out 或 ref 这告诉运行时 hService 是一个指针：

```
[DllImport("my.dll")]
public static extern int MyFunction( [MarshalAs(UnmanagedType.LPStr)] 
                                  string logicalName, 
                                  IntPtr hApp, 
                                  [MarshalAs(UnmanagedType.LPStr)] 
                                  string appID, 
                                  int traceLevel, 
                                  int timeout, 
                                  int srvcVersionsRequired, 
                                  [Out] WFSVersion srvcVersion, 
                                  [Out] WFSVersion spiVersion,
                                  out UInt16 hService); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T05:42:45.440

一些想法：

*   C# WFSVersion 类可能应该是一个`struct`. 我不知道 P/Invoke marshaller 是否关心，但我一直看到使用的结构。

*   字符大小可能是个问题。

    C 的 CHAR 是 8 位宽 (ANSI)，而 .Net 的 System.Char 是 16 位宽 (Unicode)。要为编组器提供尽可能多的信息以便它进行正确的转换，请尝试将“CharSet = CharSet.Ansi”添加到 DllImport 和 StructLayout 属性，并更改 WFSVersion 中的字符串声明：

    ```
    [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 257)]
    public string szDescription;
    [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 257)]
    public string szSystemStatus; 
    ```

*   另一个问题可能是结构中的数据对齐。如果在编译 C 结构时未指定对齐，则结构中的数据元素可能在一个或两个字节边界上对齐。尝试`Pack`在 WFSVersion 的 StructLayout 属性中使用：

    ```
    [StructLayout(LayoutKind.Sequential, Pack = 1, CharSet = CharSet.Ansi)]
    // Try pack values of 2, 4 and 8 if 1 doesn't work. 
    ```

还有一些问题：

*   MyFunction 是否打算从非 C 代码中调用？原作者可能编写的代码假定传入的数据是使用 C 运行时内存管理器分配的。

*   C DLL 中的代码是否使用传递给它的指针在 MyFunction 返回后进行后续处理？如果是这样 - 并假设在这种情况下继续前进是可能的/明智的/理智的 - 可能有必要使用`fixed`关键字“固定”传递给 MyFunction 的结构。另外，可能还有安全问题需要处理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T19:38:03.920

我不确定这个问题到底是什么，但希望这将是一个起点。

尝试查看 DllImport 属性的选项，这可能与字符串的编组有关。

```
 [DllImport("kernel32.dll", SetLastError = true, CharSet = CharSet.Auto)] 
```

CharSet 选项是我认为您可能需要的选项。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T20:13:52.007

我之前发现[AppVerifier](http://msdn.microsoft.com/en-us/library/ms220948(VS.80).aspx)对追踪 P/Invoke marshal 问题很有用。它是免费的，来自 Microsoft。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T20:19:56.627

我的猜测是您的指针之一（lpSrvcVersion、lpSPIVersion 或 lphService）无法从您的 .NET 应用程序访问。你可以尝试修改 DLL（如果它是你的），看看你是否可以让它在没有指针的情况下工作？（我知道您稍后必须将它们添加回来，但至少您可以缩小问题的位置。）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-02T20:59:55.643

你确定不是hApp？这看起来像一个输入参数，即请求应用程序的句柄。快速谷歌...是的，有一个创建应用程序句柄的功能，以及您可以使用的默认参数。

# algorithm - 具有 3 路分区的快速排序

> ID：941447
> 
> 赞同：41
> 
> 时间：2009-06-02T19:27:45.140
> 
> 标签：algorithm, quicksort

什么是具有 3 路分区的 QuickSort？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-06-02T19:36:15.343

画一个数组：

```
3, 5, 2, 7, 6, 4, 2, 8, 8, 9, 0 
```

两**分区快速排序**将选择一个值，例如 4，并将每个大于 4 的元素放在数组的一侧，将每个小于 4 的元素放在另一侧。像这样：

```
3, 2, 0, 2, 4, | 8, 7, 8, 9, 6, 5 
```

三**分区快速排序**将选择两个值进行分区并以这种方式拆分数组。让我们选择 4 和 7：

```
3, 2, 0, 2, | 4, 6, 5, 7, | 8, 8, 9 
```

这只是常规快速排序的一个微小变化。

您继续对每个分区进行分区，直到对数组进行排序。运行时在技术上是 nlog [3] (n)，与常规快速排序的 nlog [2] (n) 略有不同。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-06-02T19:30:27.193

[http://www.sorting-algorithms.com/static/QuicksortIsOptimal.pdf](http://www.sorting-algorithms.com/static/QuicksortIsOptimal.pdf)

也可以看看：

[http://www.sorting-algorithms.com/quick-sort-3-way](http://www.sorting-algorithms.com/quick-sort-3-way)

我认为面试问题版本也很有趣。它问，[是否有四个分区版本的快速排序](http://blogs.microsoft.co.il/blogs/eyal/archive/2009/02/15/interview-question-6-three-way-partition-generic-solution.aspx)...

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-06-02T21:16:18.930

如果您真的使用[Akra-Bazzi 公式](http://en.wikipedia.org/wiki/Akra-Bazzi_method)将分区数作为参数进行数学运算，然后对该参数进行优化，您会发现 e ( =2.718...) 分区提供了最快的性能。然而，在实践中，我们的语言结构、CPU 等都针对二进制操作进行了优化，因此标准划分为两组将是最快的。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2013-10-10T15:23:49.093

我认为 3 路分区是由 Djstrka 设计的。

考虑一个带有元素的数组`{ 3, 9, 4, 1, 2, 3, 15, 17, 25, 17 }`。

基本上，您设置了 3 个分区：小于、等于和大于某个枢轴。等于分区不需要进一步排序，因为它的所有元素都已经相等。

* * *

例如，如果我们选择第一个`3`作为枢轴，那么使用 Dijkstra 的 3 路分区将排列原始数组并返回两个索引`m1`，`m2`这样所有索引小于的元素`m1`都将低于`3`，所有索引大于的元素大于等于`m1`小于等于`m2`等于`3`，所有索引大于 的元素都`m2`大于`3`。

在这种特殊情况下，结果数组可能是`{ 1, 2, 3, 3, 9, 4, 15, 17, 25, 17 }`，而值`m1`和`m2`可能是`m1 = 2`和`m2 = 3`。

请注意，生成的数组可能会根据用于分区的策略而改变，但数字`m1`和`m2`将是相同的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-07-28T22:02:50.143

我认为这与 Dijkstra 分区方式有关，其中分区的元素小于、等于和大于枢轴。只有较小和较大的分区必须递归排序。[您可以在walnut](https://thewalnut.io/visualizer/visualize/3474/334/)看到一个交互式可视化并与它一起玩。我在那里使用的颜色是红色/白色/蓝色，因为分区方法通常被称为“荷兰国旗问题”

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-08-18T15:22:54.393

3 路快速排序基本上将数组划分为 3 个部分。第一部分小于枢轴，第二部分等于枢轴，第三部分大于枢轴。它是线性时间分区算法。这种划分类似于荷兰国旗问题。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2014-05-03T11:34:40.733

```
 //code to implement Dijkstra 3-way partitioning

  package Sorting;

  public class QuickSortUsing3WayPartitioning {

private int[]original;
private int length;
private int lt;
private int gt;

public QuickSortUsing3WayPartitioning(int len){
    length = len;
    //original = new int[length];

    original = {0,7,8,1,8,9,3,8,8,8,0,7,8,1,8,9,3,8,8,8};

}

public void swap(int a, int b){ //here indexes are passed
    int temp = original[a];
    original[a] = original[b];
    original[b] = temp;
}

public int random(int start,int end){
    return (start + (int)(Math.random()*(end-start+1)));
}

public void partition(int pivot, int start, int end){
    swap(pivot,start);  // swapping pivot and starting element in that subarray

    int pivot_value = original[start];
    lt = start;
    gt = end;

    int i = start;
    while(i <= gt) {

        if(original[i] < pivot_value) {
            swap(lt, i);
            lt++;
            i++;
        }

        if(original[i] > pivot_value) {
            swap(gt, i);
            gt--;
        }
        if(original[i] == pivot_value)
            i++;
    }
}

public void Sort(int start, int end){
    if(start < end) {

        int pivot = random(start,end); // choose the index for pivot randomly
        partition(pivot, start, end); // about index the array is partitioned

        Sort(start, lt-1);
        Sort(gt+1, end);

    }
}

public void Sort(){
    Sort(0,length-1);
}

public void disp(){
    for(int i=0; i<length;++i){
        System.out.print(original[i]+" ");
    }
    System.out.println();
}

public static void main(String[] args) {

    QuickSortUsing3WayPartitioning qs = new QuickSortUsing3WayPartitioning(20);
    qs.disp();

    qs.Sort();
    qs.disp();

}

} 
```

# asp.net - 将 Crystal Report 导出到 Word 文档的问题

> ID：941451
> 
> 赞同：1
> 
> 时间：2009-06-02T19:29:07.307
> 
> 标签：asp.net, asp.net-mvc, visual-studio-2008, crystal-reports, reporting

我在使用导出的 Crystal Report 时遇到了一个小问题，我可以在我们的网站上很好地生成报告，但是当我尝试将它们导出到 Word 文档时，我并没有得到一个我可以做很多事情的文档。

IE：

1.  我无法将生成的文本放置在文档中的任何位置，它几乎被“冻结”到位。我希望如果我将光标移到报告文本上方并按 Enter 多次，我可以将报告从页面中删除，但是它不会让步
2.  所有的文字似乎都在它自己的盒子里，我不能移动它或用它做任何事情。

有什么想法吗？我的期望是，一旦它被导出到 Word 中，我就可以像使用 Word 文档一样使用它，将文本向下移动到页面，编辑文档，用它做一些事情。

谢谢！

顺便说一句，这个问题与此处发布的问题相似，但是这个问题没有正确标记，我没有足够的业力来解决它：

[https://stackoverflow.com/questions/434381/word-formatting-not-intact-when-exported-from-crystal-reoport](https://stackoverflow.com/questions/434381/word-formatting-not-intact-when-exported-from-crystal-reoport)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T07:57:26.980

恐怕你对此无能为力。Crystal Reports 非常倾向于将数据放在页面上的固定位置，因此当它导出到 Word 时，它会将其数据放入文本框中，因为这与 Word 提供的类似。您可以使 Crystal Report 页面由一个巨大的文本字段组成，并使用空格和换行符将数据放入正确的位置，这可能会在 Word 中为您提供一个巨大的文本框。

# javascript - 只读输入字段不会在 IE6 中触发 OnKeyPress

> ID：941453
> 
> 赞同：1
> 
> 时间：2009-06-02T19:29:25.590
> 
> 标签：javascript, internet-explorer-6, readonly, onkeypress

我正在为 Enter 键实现一种特殊行为。问题是我的 ASP.net 库生成了一个只读字段；当用户进入该字段时（进入它是有意义的；所以我想要这种行为）并按 Enter 提交表单，它不会提交，因为它是一个只读字段。

我写了一个解决方法来连接你的普通 onkeypress=checkEnter，但是 IE6 仍然不会触发这个事件；火狐会。

我可以做些什么来检测 IE6 只读字段上的 Enter？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T20:53:40.473

由于某种原因，IE6 不会检测`ENTER`到按键事件的按下。然而，它确实检测`ENTER`到 keydown 和 keyup 事件。尝试使用`onkeyup=checkEnter`onkeypress 代替。我刚刚测试了它并且它有效。

**编辑：**根据这篇[quirksmode](http://www.quirksmode.org/dom/events/keys.html)文章，`Keypress`在插入实际字符时触发。`keyup`/`keydown`在所有键上开火。但是，这种行为在 FF 和 IE8 中有所不同。

# c# - 自动映射类型为接口的属性

> ID：941454
> 
> 赞同：2
> 
> 时间：2009-06-02T19:29:48.727
> 
> 标签：c#, nhibernate, fluent-nhibernate

我有以下课程

```
class MCustomer : DomanEntity
{
    public MCustomer()
    {       
    }

    public virtual iCustomerEntity CustomerDetials { get; set; }
    public virtual SolicitationPreferences SolicitationPreferences { get; set; }
}

public interface iCustomerEntity
{
    Contact Contact { get; set; }
}

public class PersonEntity: DomanEntity, iCustomerEntity
{
    public PersonEntity()
    {
        Intrests = new List<Intrest>();
        Children = new List<PersonEntity>();
    }

    public virtual Contact Contact { get; set; }
    public virtual DateTime BirthDate { get; set; }
    public virtual IList<Intrest> Intrests { get; set; }    
    public virtual PersonEntity Spouse { get; set; }    
    public virtual IList<PersonEntity> Children { get; set; }
} 
```

当我使用流利的 NHibernate AutoMapping 时，我收到此错误：

> NHibernate.MappingException：来自表 MCustomer 的关联引用了一个未映射的类：Calyx.Core.Domain.CRM.iCustomerEntity

如何在具有接口类型的域模型中设置属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-10T10:38:50.360

我不认为，你可以做到这一点。
当您尝试加载您的 MCustomer ( `session.Load<MCustomer>(id)`) 时，NHibernate 只会知道您想要获取具有 iCustomerEntity 的 MCustomer。它不知道要使用哪个实现（PersonEntity 或 CoderEntity？）。它如何知道使用哪个映射来检索 iCustomerEntity 的数据？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-21T10:35:25.573

对我来说，这看起来像是一个“任何”映射。你应该调查一下。据我所知，FNH 还不支持这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-14T17:55:32.173

[https://www.hibernate.org/hib_docs/nhibernate/html/inheritance.html](https://www.hibernate.org/hib_docs/nhibernate/html/inheritance.html)

它是标准的休眠模式。我正在尝试做同样的事情

# perl - 如何从 Perl 或命令行激活 Excel 加载项？

> ID：941456
> 
> 赞同：4
> 
> 时间：2009-06-02T19:30:03.967
> 
> 标签：perl, excel, command-line, add-in

（请原谅我对 Excel 加载项的无知，并随时在适当的地方更正我的术语。）

我有一个经常使用的 Excel 加载项。此加载项插入带有许多按钮的工具栏。我想自动执行在 Excel 中打开电子表格然后“单击”其中一个按钮的任务。换句话说，我想使用 Perl（或命令行）来激活此插件的特定功能。

我无法立即访问加载项的源代码，但如果需要，我应该能够请求特定信息，例如过程名称。

我不能使用 CPAN 模块来完成这项任务——只能使用我的 ActivePerl 版本安装的模块——但我确实有[Win32::OLE](http://search.cpan.org/dist/Win32-OLE)，它对其他 Office 自动化很有帮助。

任何指针？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-02T23:14:20.970

工具栏按钮是否有键绑定？

如果有，您可以使用 SendKeys 方法将该密钥发送到 Excel：http: [//msdn.microsoft.com/en-us/library/aa202943 (office.10).aspx](http://msdn.microsoft.com/en-us/library/aa202943(office.10).aspx)

或者，**CommandBars**集合可能很有用。请参阅[http://msdn.microsoft.com/en-us/library/aa171356(office.11](http://msdn.microsoft.com/en-us/library/aa171356(office.11).aspx) ​​).aspx以供参考。

下面的示例代码列出了“标准”工具栏中的可见命令栏和控件。当它找到标题为*Open*的控件时，它会调用该控件。这应该会显示“文件 -> 打开”对话框：

```
#!/usr/bin/perl

use strict;
use warnings;

use Win32::OLE qw(in with);
$Win32::OLE::Warn = 3;

my $app = get_excel();
$app->{Visible} = 1;

my $book = $app->Workbooks->Add;

for my $bar (in $app->CommandBars) {
    if ( $bar->{Visible} ) {
        print $bar->{Name}, "\n";
    }
}

print "Controls in the 'Standard' toolbar:\n";

my $bar = $app->CommandBars->{Standard};
for my $control (in $bar->{Controls}) {
    print "\t", $control->{Caption}, "\n";
    if ( $control->{Caption} =~ /^Open/ ) {
        print "opening ...\n";
        $control->Execute;
    }
}

sub get_excel {
    my $excel;
    eval {
        $excel = Win32::OLE->GetActiveObject('Excel.Application');
    };

    die "$@\n" if $@;

    unless(defined $excel) {
        $excel = Win32::OLE->new('Excel.Application', sub { $_[0]->Quit })
            or die "Oops, cannot start Excel: ",
                   Win32::OLE->LastError, "\n";
    }
    return $excel;
}

__END__ 
```

高温高压

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T19:43:20.523

我不知道您将如何单击其中一个按钮。
但我可能有一个解决方法。如果您可以在 excel 中创建一个宏来按下从 perl 调用该宏的按钮是可能的。

未经测试！

```
#!c:\perl\bin\
use strict;

use Win32::OLE qw(in with);
use Win32::OLE::Const 'Microsoft Excel';
use Win32::OLE::Variant;
use Win32::OLE::NLS qw(:LOCALE :DATE);

$Win32::OLE::Warn = 3; # Die on Errors.

my $excelfile = $path_to_exelfile_with_macro;

my $Excel = Win32::OLE->GetActiveObject('Excel.Application')
        || Win32::OLE->new('Excel.Application', 'Quit');

my $Book = $Excel->Workbooks->Open($excelfile);

$Excel->Run($MacroName); 
```

更多提示请访问[http://www.perlmonks.org/?node_id=153486](http://www.perlmonks.org/?node_id=153486)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T19:44:55.933

我认为你在 Win32::OLE 中走在正确的轨道上。过去我用它来自动化处理 Excel。我不相信 OLE 可以让您访问 GUI 元素（例如激活按钮按下），因此您可能需要了解工具栏是否支持 OLE 以及界面是什么。

我能想到的另一种选择是尝试以编程方式控制鼠标以实际单击按钮。这假设您正在运行 OLE 且 Excel 可见（不一定如此），并造成了弄清楚如何定位光标的困难情况。如果它是一个选项，OLE 会简单得多。

# git - 在 git 中，您可以查看文件移动后应用到文件的旧提交吗？

> ID：941466
> 
> 赞同：16
> 
> 时间：2009-06-02T19:32:30.733
> 
> 标签：git

在我在 git 中移动一个文件后（使用`git mv`），查看该文件的日志只显示包括移动和移动之后的提交。

有没有办法以旧名称查看应用于文件的提交？在下面的示例中，我希望在`git log`完成移动后看到提交 b04033bdc44f1 和 8ca40d563ce5d。

```
 $ git init
Initialized empty Git repository in /Users/ben/code/git_mv_example/.git/
 $ touch foo
 $ git add foo
 $ git commit -m "Initial commit"
Created initial commit 8ca40d5: Initial commit
 0 files changed, 0 insertions(+), 0 deletions(-)
 create mode 100644 foo
 [master*]$ echo "abcdefg" > foo
 [master*]$ git commit -a -m "edited foo"
Created commit b04033b: edited foo
 1 files changed, 1 insertions(+), 0 deletions(-)
 $ git log foo
commit b04033bdc44f1eb3477270b4b7ca727377d8c03a
Author: Ben Brinckerhoff <ben@devver.net>
Date:   Tue Jun 2 13:26:53 2009 -0600

    edited foo

commit 8ca40d563ce5d07d965bfb75a01b9c23378fd321
Author: Ben Brinckerhoff <ben@devver.net>
Date:   Tue Jun 2 13:26:15 2009 -0600

    Initial commit
 $ git mv foo bar
 [master+]$ git commit -a -m "renamed foo to bar"
Created commit 2bccdf6: renamed foo to bar
 1 files changed, 0 insertions(+), 0 deletions(-)
 rename foo => bar (100%)
 $ git log bar
commit 2bccdf6fc65b9da5b279d9f1117e436549dd3a7b
Author: Ben Brinckerhoff <ben@devver.net>
Date:   Tue Jun 2 13:27:14 2009 -0600

    renamed foo to bar
 $ git log foo
fatal: ambiguous argument 'foo': unknown revision or path not in the working tree.
Use '--' to separate paths from revisions 
```

这不可能吗？或者也许是`git log`错误的命令？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-02T19:48:55.020

' `git-log -M`' 将提供带有重命名信息的提交历史记录，如[GitFaq“为什么 git 不“跟踪”重命名？”中所述](https://git.wiki.kernel.org/index.php/GitFaq#Why_does_Git_not_.22track.22_renames.3F)

Git 中的`diff`机器支持自动检测重命名，这是通过 ' `-M`' 切换到`git-diff-*`命令系列来打开的。和
使用重命名检测机制。 Git 还支持有限形式的跨重命名合并。这两个用于分配责任的工具，都使用自动重命名检测代码来跟踪重命名。[`git-log`](http://git-scm.com/docs/git-log)[`git-whatchanged`](http://www.kernel.org/pub/software/scm/git/docs/git-whatchanged.html)
[`git-blame`](http://www.kernel.org/pub/software/scm/git/docs/git-blame.html)[`git-annotate`](http://www.kernel.org/pub/software/scm/git/docs/git-annotate.html)

作为一个非常特殊的情况，[' `git log`'](http://git-scm.com/docs/git-log)版本 1.5.3 及更高版本**具有' `--follow`'选项，允许您在给定单个路径时遵循重命名**。

* * *

在你的例子中：

```
F:\prog\git\test\rename>git log --follow bar
commit 81f52b91eb2fc7ad18051c93f3e4d583f27c15ca
Author: VonC <>
Date:   Tue Jun 2 21:54:43 2009 +0200

    renamed foo to bar

commit 71aff26ace6ab249ab2042d1e5d20377486ce478
Author: VonC <>
Date:   Tue Jun 2 21:54:19 2009 +0200

    edited foo

commit c893199da767eddac6a547b940557435ade4d18c
Author: VonC <>
Date:   Tue Jun 2 21:53:51 2009 +0200

    initial commit 
```

* * *

`foo`注意：所有这一切都是可能的，因为您在重命名为 bar 之前没有大幅修改内容。如果内容完全不同，`--follow`选项将无法获取所有历史记录。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-02T21:54:04.330

简短的回答：使用

```
$ git log -M --follow bar 
```

或者

```
$ git log -M -- foo bar 
```

指定旧名称和新名称。

顺便说一句，由于 git 使用基于启发式相似性的重命名检测，玩具示例可能无法按照您的意愿工作，而现实生活中的示例（或内容未更改的示例）将按预期工作。

*请注意，在 git path 作为 git-log 的参数不是路径过滤器，而是路径限制器（例如可以是目录）。*

# svn - 使用 Subversion 服务多个项目的最佳配置是什么？

> ID：941467
> 
> 赞同：1
> 
> 时间：2009-06-02T19:32:49.203
> 
> 标签：svn

首先，这里有一些关于我想要实现的内容。

我正在编写一个用于基本项目管理的小型 Django 应用程序，类似于简化的 Google 代码，我想要紧密的 SVN 集成，这意味着我希望能够管理用户访问权限。我还希望我的应用程序在创建项目时创建存储库，就像 Google Code 一样。

现在的问题：

我可以为单个存储库提供服务并将所有项目堆放在一个根文件夹中（就像我现在所做的那样），或者为每个存储库启动一个 svnserve 守护进程。

我不能使用单一服务器设置，因为所有项目都将被视为一个大项目，使得修订编号边界无用并且不可能进行每个项目的权限管理（嗯，我认为）。

我发现这篇文章主要描述了我将要做的事情：

[http://articles.slicehost.com/2007/9/6/multiple-repositories-and-subversion](http://articles.slicehost.com/2007/9/6/multiple-repositories-and-subversion)

但是我的同事认为这是一种矫枉过正的行为，我不应该这样做。

就我自己而言，我认为考虑到我几乎不会完成超过 100 个项目，这不是问题。即使我不切实际地拥有 500 个活动项目，服务器也可能很好地处理 500 个空闲进程。

谁是对的？

还是我应该选择其他东西，比如 Mercurial？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T19:36:44.140

使用多个存储库。这就是我所做的，这不是矫枉过正。我使用[VisualSVN Server Manager](http://www.visualsvn.com/server/)之类的东西来管理它们。它甚至可以为您设置 https 和简化的 Apache 服务器。（仅限 Windows）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T19:59:25.450

IIRC Apache 选择了一个大存储库而不是许多较小的存储库。如果您需要跨存储库共享代码，我相信推动方法选择的差异最为明显。有些工具和操作根本无法与单独的存储库一起使用。我记得，在 TortoiseSVN 和/或 Subversion 的最新版本的发行说明中有一些详细的评论，其中提到了其中的一些限制。我个人遇到了一些这样的地雷，特别是在使用第三方存储库时。

FWIW - 我使用单独的存储库，因为我为许多不同的客户工作。Malfist 也提到了 VisualSVN 服务器，它非常适合您在 Windows 上使用，并且可以轻松设置多个存储库。从头开始手动执行相同的操作需要更多的专业知识，特别是如果您使用 Apache HTTPD 作为前端。Apache 是首选方法，尤其是当您将 SNV 暴露于 Internet 或需要对访问进行更多控制时。

# c# - C# MVC：URL 中的尾随等号不会命中路由

> ID：941468
> 
> 赞同：2
> 
> 时间：2009-06-02T19:33:19.793
> 
> 标签：c#, asp.net-mvc

我有一个这样的 MVC 路由`www.example.com/Find?Key=`，其中​​ Key 是 Base64 字符串。问题是 Base64 字符串有时有一个尾随等号 (=)，例如：

> huhsdfjbsdf2394=

发生这种情况时，由于某种原因，我的路线不再受到打击。

我应该怎么做才能解决这个问题？

**我的路线：**

```
routes.MapRoute(
    "FindByKeyRoute", 
    "Find",
    new { controller = "Search", action = "FindByKey" }
); 
```

如果我有，`http://www.example.com/Find?Key=bla`那么它可以工作。

如果我有，`http://www.example.com/Find?Key=bla=`那么它不再起作用了。

**重要补充**：
我正在编写一个**不允许 % 或类似编码**的 IIS7 实例。这就是我一开始没有使用 UrlEncode 的原因。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T19:36:14.687

**编辑：显然不起作用的原始建议**

我确定原因是它认为它是一个*名为*Key 的查询参数。你能把它作为一个参数，那部分就是值，例如

```
www.example.com/Find?Route=Key= 
```

我*希望*这会起作用（因为解析器会寻找一个`&`来启动下一个参数），但它可能仍然会使事情变得混乱。

**我认为可行的建议**

或者，如果您明白我的意思，请在退出时将 base64 编码值中的“=”替换为其他内容，然后在返回时重新替换它。基本上使用不同的 base64 decodabet。

**应该工作的替代建议**

在将 base64 添加到 URL 之前：

```
private static readonly char[] Base64Padding = new char[] { '=' };
...
base64 = base64.TrimEnd(Base64Padding); 
```

然后在`Convert.FromBase64String()`入站请求调用（这是我假设你正在做的）之前：

```
// Round up to a multiple of 4 characters.
int paddingLength = (4 - (base64.Length % 4)) % 4; 
base64 = base64.PadRight(base64.Length + paddingLength, '='); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T19:42:41.943

如果您在 URL 中传递数据，您可能应该对其进行 URL 编码，这将处理尾随 =。

[http://www.albionresearch.com/misc/urlencode.php](http://www.albionresearch.com/misc/urlencode.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T19:40:43.197

UrlEncode 加密的（它是加密的，对吗？）参数。

如果它是加密字符串，请注意空格和 + 字符也会妨碍您。

* * *

好的，所以 IIS 7 不允许某些特殊字符作为路径的一部分。但是，如果它们是查询字符串的一部分，它将允许它们。

显然，有可能用 reg hack 来改变它，但我不建议这样做。

然后，我建议使用 Skeet 先生建议的替代令牌，或者干脆不在您的路径中使用它，将其用作查询字符串，您可以在其中对它进行 url 编码。

如果它是一个加密字符串，您还没有验证它是否是，在某些情况下您可能会得到其他“非法”字符。Querystring 真的是要走的路。

* * *

除了您的示例将其显示为查询字符串...那么给出了什么？您在哪里找到不允许将标准 uri 编码作为查询字符串的一部分的 IIS？

* * *

那好吧。感谢更新。

[请求过滤](http://learn.iis.net/page.aspx/143/how-to-use-request-filtering/)？我懂了。仍然提到它阻止的双重编码值。有人创建了一个 URL 序列来拒绝任何带有“%”字符的请求？此时，您可能根本不想使用加密字符串，而是生成一个 GUID 或其他保证不包含特殊字符但不容易猜测的东西。

# php - 是否可以从 Google 搜索中捕获搜索词？

> ID：941469
> 
> 赞同：17
> 
> 时间：2009-06-02T19:33:20.310
> 
> 标签：php, html, search, http-referer

这可能是一个愚蠢的问题，但是否有可能捕获用户在 Google 搜索框中输入的内容，然后可以将其用于在我的网站的登录页面上生成动态页面？

例如，假设有人在 Google 上搜索“热狗”，而我的网站作为搜索结果链接之一出现。如果用户单击将他们定向到我的网站的链接，我是否有可能以某种方式从 Google 搜索框中知道或捕获“热狗”文本，以便我可以调用一个脚本来搜索我的本地数据库的内容与热狗有关，然后展示呢？这对我来说似乎完全不可能，但我真的不知道。谢谢。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-06-02T19:43:24.110

我会这样做

```
$referringPage = parse_url( $_SERVER['HTTP_REFERER'] );
if ( stristr( $referringPage['host'], 'google.' ) )
{
  parse_str( $referringPage['query'], $queryVars );
  echo $queryVars['q']; // This is the search term used
} 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-04-06T23:07:58.860

这是一个古老的问题，自从提出并回答了原始问题以来，答案已经改变。自 2011 年 10 月起，Google 将为登录 Google 帐户的任何人加密此推荐信息：http: [//googleblog.blogspot.com/2011/10/making-search-more-secure.html](http://googleblog.blogspot.com/2011/10/making-search-more-secure.html)

对于未登录 Google 的用户，搜索关键字仍然可以在推荐 URL 中找到，并且上述答案仍然适用。但是，对于经过身份验证的 Google 用户，网站无法查看他们的搜索关键字。

但是，通过创建专门的登录页面，仍然可以做出明智的猜测。（“赫特人贾巴庄严的木炭素描”页面的访问者可能......嗯，疯了。）

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-06-02T19:37:06.230

对的，这是可能的。请参阅 HTTP 标头[Referer](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html)。Referer 标头将包含 Google 搜索结果页面的 URL。

当用户点击 Google 搜索结果页面上的链接时，浏览器将使用以下 HTTP 标头向您的站点发出请求：

```
Referer: http://www.google.fi/search?hl=en&q=http+header+referer&btnG=Google-search&meta=&aq=f&oq= 
```

只需从请求标头中解析 URL，用户使用的搜索词将在**q**参数中。上面示例中使用的搜索词是“ *http header referer* ”。

同一种方法通常也适用于其他搜索引擎，它们只是在 Referer 标头中有不同类型的 URL。

这个[答案](https://stackoverflow.com/questions/941469/is-it-possible-to-capture-search-term-from-google-search/941515#941515)显示了如何在 PHP 中实现它。

* * *

Referer 标头仅在 HTTP 1.1 中可用，但这几乎涵盖了任何现代浏览器。浏览器也可能会伪造Referer header，或者header可能完全丢失，所以不要根据Referer header做出太严重的决定。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-11-15T11:23:10.250

这是一个老问题，但我发现谷歌不再给出查询词，因为它默认将每个用户重定向到 https，这不会给你“q”参数。[除非有人使用 http ( http://google.com](http://google.com) )手动输入 google url然后搜索，否则目前无法获取“q”参数。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-02T19:37:17.697

是的，它来自网址：

[http://www.google.com/search?hl=es&q=hot+dog&lr=&aq=f&oq=](http://www.google.com/search?hl=es&q=hot+dog&lr=&aq=f&oq=)

这是一个例子：

谷歌向您的网站发送了许多访问者，如果您想获取他们曾经访问您网站的关键字，可能通过将其显示在页面上来给他们留下深刻印象，或者只是将关键字存储在数据库中，这是我的 PHP 代码利用 ：

```
// take the referer
$thereferer = strtolower($_SERVER['HTTP_REFERER']);
// see if it comes from google
if (strpos($thereferer,"google")) {
    // delete all before q=
    $a = substr($thereferer, strpos($thereferer,"q="));     
    // delete q=
    $a = substr($a,2);
    // delete all FROM the next & onwards
    if (strpos($a,"&")) {
        $a = substr($a, 0,strpos($a,"&"));
    }   
    // we have the results.
    $mygooglekeyword = urldecode($a);
}

and we can use <?= $mygooglekeywords ?> when we want to output the
keywords. 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-02T19:38:25.713

您可以获取引用 URL 并从查询字符串中获取搜索词。搜索将在查询中显示为“q=searchTerm”，其中 searchTerm 是您想要的文本。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-09-20T00:44:33.853

抱歉，再多一点
添加对 Bing、Yahoo 和 Altavista的支持

```
<?php
if (@$_SERVER['HTTP_REFERER']) {
    $referringPage = parse_url($_SERVER['HTTP_REFERER']);
    if (stristr($referringPage['host'], 'google.')
        || stristr($referringPage['host'], 'bing.')
        || stristr($referringPage['host'], 'yahoo.')) {
            parse_str( $referringPage['query'], $queryVars );
            if (stristr($referringPage['host'], 'google.')
                || stristr($referringPage['host'], 'bing.')) { $search = $queryVars['q']; }
                        else if (stristr($referringPage['host'], 'yahoo.')) { $search =     $queryVars['p']; }
                        else { $search = false; }
            if ($search) { $search = str_replace("+"," ",$search); }}
            else { $search = false; }}
else { $search = false; }
if ($search) { echo "You're in the right place for ".$search; }
?> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-09-20T00:23:15.260

同样的事情，但有一些错误处理

```
<?php
if (@$_SERVER['HTTP_REFERER']) {
    $referringPage = parse_url($_SERVER['HTTP_REFERER']);
    if (stristr($referringPage['host'], 'google.')) {
        parse_str( $referringPage['query'], $queryVars );
        $google = $queryVars['q'];
        $google = str_replace("+"," ",$google); }
    else { $google = false; }}
else { $google = false; }

if ($google) { echo "You searched for ".$google." at Google then came here!"; }
else { echo "You didn't come here from Google"; }
?> 
```

# python - wxPython 不会用作为窗口句柄的父级关闭 Frame

> ID：941470
> 
> 赞同：1
> 
> 时间：2009-06-02T19:33:30.107
> 
> 标签：python, windows, wxpython, handle

我有一个 Python 程序，它通过 COM 从另一个程序获取窗口句柄（将 Python 程序视为插件）我将此窗口设置为主要 Python 框架的父级，这样如果另一个程序最小化，python 框架也会. 问题是当我退出并尝试关闭或销毁主框架时，frame.close 永远不会完成它的执行（尽管它确实消失了）并且其他程序拒绝关闭，除非被 TaskManager 杀死。

以下是我们大致采取的步骤：

```
if we are started directly, launch other program
if not, we are called from the other program, do nothing

enter main function:
create new wx.App
set other program as frame parent:
  Get handle via COM
  create a parent using wx.Window_FromHWND
  create new frame with handle as parent
  show frame
enter main loop

App.onexit:
  close frame
  frame = None
  handle as parent = None
  handle = None 
```

有人对此有任何想法或经验吗？

我很感激这方面的任何帮助！

[编辑]只有当我使用句柄作为父级时才会出现这种情况，如果我只是获取句柄并关闭python程序，其他程序关闭正常

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T20:15:58.273

我想知道您的`Close`电话是否可能挂在近距离处理程序中。你试过打电话`Destroy`吗？如果这没有帮助，那么唯一的解决方案似乎是“重新设置”或“分离”你的框架 - 我没有看到这样做的方法`wx`，但也许你可以为那个下拉到 win32 API任务...？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-10T21:48:13.053

我对此的解决方案有点被破解了，并且诚然这不是我想出的最优雅的解决方案 - 但它非常有效......

基本上我的步骤是启动一个线程来轮询以查看窗口句柄是否存在。虽然它仍然存在，但什么也不做。如果它不再存在，则终止 python 应用程序，允许释放句柄（和主应用程序）。

```
class CheckingThread(threading.Thread):
    '''
    This class runs a check on Parent Window to see if it still is running
    If Parent Window closes, this class kills the Python Window application in memory
    '''
    def run(self):
        '''
        Checks Parent Window in 5 seconds intervals to make sure it is still alive.
        If not alive, exit application
        '''
        self.needKill = False

        while not self.needKill:
            if self.handle is not None:
                if not win32gui.IsWindow(self.handle):
                    os._exit(0)
                    break
            time.sleep(5)

    def Kill(self):
        '''
        Call from Python Window main application that causes application to exit
        '''
        self.needKill = True

    def SetHandle(self, handle):
        '''
        Sets Handle so thread can check if handle exists.
        This must be called before thread is started.
        '''
        self.handle = handle 
```

再一次，感觉有点骇人听闻，但我真的没有看到另一种解决方法。如果其他人有更好的解决方案，请发布。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-04T20:46:21.140

如果您只需要重新养育子女，您可以`frame.Reparent(None)`先尝试`frame.Close()`

# ios - 通过 iTunes 升级 iOS 应用程序时防止删除用户数据

> ID：941479
> 
> 赞同：3
> 
> 时间：2009-06-02T19:36:03.893
> 
> 标签：ios, iphone, itunes, updates

我想为 beta 测试组上传我的 iOS 应用程序的新 beta 版本。用户将他们的数据保存在 Documents 文件夹中。为了让用户在不丢失数据的情况下升级他们的应用程序，我需要做什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T19:47:11.513

更新应用程序时不会覆盖 Documents 目录，因此只要您的数据在版本之间兼容，您就不必做任何特别的事情。

或者，对于开发人员，Xcode 的 Organizer 允许您轻松提取应用程序 Documents 目录的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-07T07:06:18.333

将 iTunes 降级到 7.7 似乎解决了 Windows 上的问题

# database-design - 用于管理站点上的用户访问的结构

> ID：941483
> 
> 赞同：0
> 
> 时间：2009-06-02T19:36:16.090
> 
> 标签：database-design

我们有一个网站，左侧导航有很多链接。这些链接是根据用户的“功能”绘制的。管理员用户可以在屏幕上创建新功能并将其分配给某些用户。
问题是，一旦创建了新函数，我们的代码就必须更改，因为在我们的左侧导航页面中，我们有很多 if/else 子句，我们基于这些子句绘制链接。

以下是相关表的结构：

```
cmp_user_role [userid, role_id]
cmp_function [function_id, function_name, url]
cmp_function_role [role_id, function_id] 
```

样本数据：

```
cmp_user_role [userid, role_id]
 M23423    18
 H23414    21
 G23431    44

cmp_function [function_id, function_name, url]
0    SystemAdmin    Null
1    Debt Access    Null
8    Audit Reports  Null

cmp_function_role [role_id, function_id]
18    0
18    1
21    8
44    1 
```

带来与用户 ID 相关的函数列表的查询是：

```
SELECT f.function_id, f.function_name
FROM cmp_function f, cmp_function_role p 
WHERE p.role_id 
IN (SELECT DISTINCT role_id FROM cmp_user_role 
WHERE user_id = 'M23423' ) 
AND p.function_id=f.function_id 
```

在我们的代码中我们正在做（伪）

```
if (retrievedFunctionFromDB == "SystemAdmin")
  show links pertaining to system Admin
if (retrievedFunctionFromDB == "Debt Access")
  show links pertaining to Debt Access
... 
```

我认为除了用户决定创建一个新功能并将该功能分配给某个用户之外，一切都很好。在这种情况下，我们的代码没有该函数名称，因为我们正在对其进行硬编码。..

在不改变大部分表结构的情况下，使这种动态变化的最佳策略是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T20:05:59.650

我想你可以添加表

```
cmp_function_links [function_id, link_url, link_text] 
```

并且伪代码（用于打印链接）应该是

```
fetch all roles where user is
for each role
    print all links 
```

我想您的链接是静态的，而不是动态的（例如指向最新用户的链接等）。

# asp.net - WebMethod 与 ScriptMethod

> ID：941484
> 
> 赞同：45
> 
> 时间：2009-06-02T19:36:19.210
> 
> 标签：asp.net, web-services, pagemethods

我有一个 .NET 3.5 aspx 位置，其方法标记有该`[WebMethod]`属性。我用 jQuery 调用它，双向发送 JSON。这一切都很好。我的问题是，`[ScriptMethod]`应用于方法时会做什么？我已经尝试过了，它似乎产生了相同的结果。是`ScriptMethod`和`WebMethod`相同且可互换的，还是一个提供另一个不提供的功能和/或开销？总的来说，我发现自己对实现 Web 服务的所有可用选项感到困惑，我想知道每个选项的优缺点。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2010-02-11T18:55:51.073

您在以下 2 个场景中使用 ScriptMethod 属性。

1.  您正在使用 jquery 或任何其他 ajax 请求机制，但您希望请求是 GET 而不是 POST。
2.  您想在 javaScript 中接收 XML 格式的响应。

如果您没有上述要求之一；您只需要使用 ajax 请求的 JSON 响应，然后您就可以简单地使用 WebMethod。

这里还有一个更令人困惑的元素，你什么时候使用 ScriptService 属性？如果您使用的是 Microsoft Ajax 客户端脚本框架，则使用此属性，此属性告诉服务器在客户端上生成代理对象，以便您可以像调用普通对象一样调用函数。`var MyRemoteObject = new RemoteObject();` `MyRemoteObject.getMessage(....)` 甚至当您使用 ScriptService 属性时，您也不需要仅在上述场景中添加 ScriptMethod 属性。

一开始我很困惑，因为我认为 ScriptService 和 ScriptMethod 属性就像 WebService 和 WebMethod 属性一样一起工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T19:46:44.963

ScriptMethodAttribute 属性是可选的。（但是，可以从客户端脚本调用的方法必须应用 System.Web.Services..::.WebMethodAttribute 属性。）。如果一个方法没有使用 ScriptMethodAttribute 标记，则该方法将通过 HTTP POST 命令调用，并将响应序列化为 JSON。您不能从脚本覆盖此设置。

来自 - [http://msdn.microsoft.com/en-us/library/system.web.script.services.scriptmethodattribute.aspx](http://msdn.microsoft.com/en-us/library/system.web.script.services.scriptmethodattribute.aspx)

编辑： WebMethod 和 ScriptMethod 不是竞争属性。ScriptMethod 可能是一个附加注释，正如上面的段落所说。

# c# - 更改组框文本颜色？

> ID：941492
> 
> 赞同：6
> 
> 时间：2009-06-02T19:37:51.890
> 
> 标签：c#, groupbox, textcolor

如何在 C# 中更改组框的文本颜色？“文档”甚至没有提到这一点，谷歌搜索也没有找到答案。

谢谢！艾伦

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-02T19:40:26.583

使用该[`ForeColor`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.forecolor.aspx)物业。示例代码：

```
using System;
using System.Drawing;
using System.Windows.Forms;

class Test
{       
    [STAThread]
    static void Main(string[] args)
    {
        Form form = new Form();
        GroupBox group = new GroupBox();
        group.Text = "Text";
        group.ForeColor = Color.Red;
        form.Controls.Add(group);
        Application.Run(form);
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-09-21T02:25:12.717

实际上，此处发布的所有答案都会更改位于 groupbox 内的其他控件（如按钮、标签等）的前景色。要专门更改组框的文本颜色，有一个简单的解决方法。

```
 private void button1_Click(object sender, EventArgs e)
    {
        List<Color> lstColour = new List<Color>();
        foreach (Control c in groupBox1.Controls)
            lstColour.Add(c.ForeColor);

        groupBox1.ForeColor = Color.Red; //the colour you prefer for the text

        int index = 0;
        foreach (Control c in groupBox1.Controls)
        {
            c.ForeColor = lstColour[index];
            index++;
        }
    } 
```

当然，如果您稍后以编程方式将控件添加到组框，上述代码可能毫无意义，但好在您可以通过在代码中添加额外条件来处理所有这些情况。可以肯定的是，可以使用控制和前景色的键值对列表。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-02T19:45:45.103

如果您指的是组框文本本身，请使用 Jon Skeet 发布的内容。如果您指的是 groupbox 中的所有后续控件，则可以使用以下代码：

```
 foreach (Control c in this.groupBox1.Controls)
        {
            c.ForeColor = this.groupBox1.ForeColor; //or whatever color you want
        } 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-23T05:12:42.287

或者我已经稍微更改了您的代码，因此用户只能在 groupBox 的 2 种颜色之间进行选择：

```
 private void SettingGroupBoxColor(bool bSelected)
    {
        if (!bSelected)
            groupBox1.ForeColor = Color.Red;
        else
            groupBox1.ForeColor = Color.Green;
        foreach (Control c in this.groupBox1.Controls)
        {
            c.ForeColor = Color.Black;
        }
    } 
```

将“true”或“false”值传递给上部方法，将仅更改 groupBox ForeColor - 而所有其他控件的前景色将保持默认（黑色）。

我的一分钱。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-02T19:44:30.567

我假设您现在使用的是 winforms 而不是 WPF。

要更改组框的文本颜色，请使用 ForeColor 这会更改标题文本中的字体颜色。

# c# - 处理多视图/选项卡式 GUI 元素的最佳方法是什么

> ID：941498
> 
> 赞同：1
> 
> 时间：2009-06-02T19:38:43.137
> 
> 标签：c#, user-interface, user-controls, tabcontrol

我正在开发一个应用程序，该应用程序根据正在查看的对象向用户提供各种数据。这些对象都是相同的接口，只是具有超越一次区分的扩展属性。

我正在寻找向用户显示依赖于类型的控件的“最佳”方式。我想使用标签，但我被 .NET 2.0 困住了，从我能收集到的唯一方法来隐藏/显示标签是删除它们并重新添加它们。这可能是最好的方法，但会导致有关 GUI 组件闪烁、重新加载时保持活动选项卡上的选项卡等问题。

我可以为每个控件制作自定义控件，或者将它们全部加载并在必要时隐藏/显示（我过去在项目中做过），或者处理并重新实例化它们......

为了更好地澄清，我想说代码优雅和程序效率之间最接近的平衡。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T19:43:49.383

我已经使用并且在加载它们然后显示/隐藏所需的那些方面取得了最好的运气。

处理和重新实例化一切总是让事情变得非常混乱。

为了不让加载时间变得可怕，您可以在首次使用时实例化它们。就像是：

```
IView LoadView(Type dependantType)
{
  // get the view or create one
  IView view = GetView(dependantType);
  if (view == null)
  {
    view = InstantiateViewAndAddToForm(dependantType);
    AddView(view);
  }

  //
  // do some binding to your model or whatever here
  //

  // make the correct view visible
  foreach (IView v in Views)
    view.Visible = v == view;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T19:44:44.483

您可以为每个对象创建一个面板并让一个字典将对象类型和面板关联起来吗？

如果面板大小相同，您可以告诉面板放在前面，或者将所有 Panels.Visible 设置为 false，然后将您需要的设置为 true。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T19:47:01.437

我已将[DockPanel Suite](http://sourceforge.net/projects/dockpanelsuite)用于需要多个选项卡的应用程序。它是一个开源项目，因此您可以根据需要实际修改代码。

该套件有很多功能，但是，如果您可以只使用选项卡。

# c# - 如何在 C# 中将 DateTime 对象转换为 dd/mm/yyyy？

> ID：941502
> 
> 赞同：14
> 
> 时间：2009-06-02T19:40:33.430
> 
> 标签：c#

> **可能的重复：**
> [将字符串转换为 .net](https://stackoverflow.com/questions/123263/convert-a-string-to-a-date-in-net)
> [格式的日期 c#中的日期](https://stackoverflow.com/questions/501460/format-date-in-c)
> [什么标记用于格式化 StackOverflow 问题？](https://stackoverflow.com/questions/808057/what-markup-is-used-to-format-stackoverflow-questions)

如何在 C# 中将 DateTime 对象转换为 dd/mm/yyyy？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-06-02T19:49:44.193

除了其他答案之外，需要注意的一件事 - / 是格式字符本身，代表本地日期分隔符。如果您想确保它使用实际的*斜线*，请使用不变的文化（使用斜线）：

```
string s = dateTime.ToString("dd/MM/yyyy", CultureInfo.InvariantCulture); 
```

或转义斜线：

```
string s = dateTime.ToString("dd'/'MM'/'yyyy"); 
```

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2009-06-02T19:41:59.417

您是在谈论转换为用于打印的字符串还是什么？

```
String s = DateTime.ToString("dd/MM/yyyy"); 
```

为了完整起见，这里是有关[DateTime.ToString](http://msdn.microsoft.com/en-us/library/k494fzbf.aspx)和[DateTime 格式的](http://msdn.microsoft.com/en-us/library/system.globalization.datetimeformatinfo.aspx)更多信息。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-06-02T19:42:42.770

```
DateTime d = DateTime.Now;
string s = d.ToString("dd/MM/yyyy");
Console.WriteLine(s); 
```

# terminology - 错误跟踪和问题跟踪系统有什么区别？

> ID：941512
> 
> 赞同：41
> 
> 时间：2009-06-02T19:42:44.627
> 
> 标签：terminology, bug-tracking, issue-tracking

我正在寻找有关您使用每个系统的原因和时间*以及*哪些功能可以区分错误与问题跟踪应用程序的解释。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-06-02T19:48:43.413

**问题跟踪系统**通常更多地与客户和客户问题集成。问题可能是“帮我安装这个”或“我如何让 fubar 进入 flim flam”。它们甚至可以是“我需要您的软件的评估密钥”之类的东西。

**错误跟踪系统**可帮助您跟踪程序中错误或遗漏的内容。

在查看 Web 系统时，关注点通常存在很大差异，要么帮助客户，要么跟踪软件问题。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2009-06-02T20:10:39.127

从以下示例中可以更清楚地看出差异。

假设您今天遇到了一个影响 5 个客户的生产问题，但它是由一个软件缺陷引起的。

在您的**问题**跟踪系统中，您打开了 5 张工单并开始跟踪每个客户报告的内容、与他们沟通的内容、应用软件补丁的时间等。您可以为每个客户单独跟踪此类内容。

在您的**错误**跟踪系统中，您为软件缺陷创建了 1 个条目，开始跟踪诸如重现步骤、代码更改等内容。

只要客户的问题得到了客户满意的补救，就可以关闭客户问题，这可能涉及也可能不涉及修复软件。修复并重新测试后，可以关闭该错误。

两个系统，外向和内向，跟踪两种不同的事物，每种事物都有自己的生命周期。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-06-02T19:58:07.047

**像Trac**这样的错误跟踪系统旨在为**程序固有的**每个问题提供一张票，因此可以通过修改程序关闭一张票。

**像IssueTrackerProduct**这样的客户支持工单系统旨在为每个**遇到某种情况的客户提供**一张工单，因此通过为该客户解决情况（可能通过修改程序）来关闭工单。

有关每个示例，请参阅 Wikipedia 的[问题跟踪系统比较](http://en.wikipedia.org/wiki/Comparison_of_issue_tracking_systems)

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-06-02T20:46:40.647

**错误是问题的子类。所有错误都是问题，但并非所有问题都是错误。**

通常，错误是代码库中的缺陷。这不同于一个不完整/尚未实现的功能，或者更难确定的东西，比如开发人员开一张票来处理一项技术债务，或者对 UI 的关注。从语义上讲，所有这些都是“问题”。

一个通用问题，当不属于其他类别时，通常代表最终用户报告的某些内容。在大多数系统中，此报告的问题本身作为错误报告处理。我敢说这是一个错误。

棘手的部分是有时多个问题可能与其他问题有关。它可能与同一个错误、多个错误或实际上是一个功能请求有关。也就是说，问题之间可以存在多对多的关系。

为什么区分很重要？嗯，内部有一棵天然树——解决一个问题可以间接完成（或有助于完成）一百万个其他问题。它还对解决问题的方式产生了影响。缺陷本身可以通过修改代码来解决，或者使其无关紧要。如果是用户投诉，可以通过向他们发送解决方案来解决，然后在原始缺陷解决后留待跟进。

以有用的方式更好地表示和处理这些细微差别的功能确实是在票务跟踪系统中寻找的东西。

在某些时候，您谈论的过程和方法比实际的票务系统更多，事物的实际名称应该开始变得无关紧要。主流和面向企业的解决方案倾向于在 ITIL 等流行的系统上运行，但如果团队中的每个人都对客户服务需求有很好的了解，你就可以摆脱临时的东西。我个人将其视为[瀑布 (ITIL) 与敏捷 (DevOps)](http://www.slideshare.net/paulpeissner/waterfall-itil-vs-agiledev-ops)的情况。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-06-02T19:46:07.553

这只是语义。一个错误就是一个问题，一个问题就是要做的事情。它们在其他方面大致相同。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-06-02T19:47:12.573

它充其量是一条模糊的线。问题跟踪系统可能被认为是两者中更通用的。因为所有错误跟踪系统都是问题跟踪系统，但不一定相反。

来自我们的朋友[维基百科](http://en.wikipedia.org/wiki/Bug_tracking_system)

> 错误跟踪系统是一种软件应用程序，旨在帮助质量保证和程序员跟踪他们工作中报告的软件错误。它可以被视为一种问题跟踪系统。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-06-02T19:47:33.977

在代码中发现了一个错误

问题可以在任何地方、流程、硬件和人员中找到。

至于定义的含义，这取决于您采用的开发过程。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-06-02T19:46:05.290

我相信错误是可以在代码中修复的东西，而问题更多的是可用性问题。

例如，登录表单。登录表单中的错误将是登录完成后表单重定向错误。虽然一个问题是整个登录过程太慢，或者没有选择通过电子邮件发送忘记的密码。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-06-02T19:49:54.440

这并不是您问题的完整答案，但在与客户打交道时，我也遇到过类似的问题。我认为在最高级别上，错误跟踪系统似乎通常更侧重于开发人员。也就是说，开发人员正在尝试跟踪代码中的问题。一个函数没有返回正确的值，应该做更多的验证，等等。

与代码完美集成的系统的一个很好的例子是[Trac](http://trac.edgewall.org/)。

问题跟踪系统似乎更加以客户为中心。例如，能够让客户说“当我点击‘确定’时出现错误”。这可能是用户培训，可能是功能，或者实际上可能是错误。

因此，在我参与的许多项目中，我们保持这些不同。我们有一个高级问题跟踪系统，它可能会也可能不会导致在错误跟踪系统中创建实际错误。但是，许多错误是在内部跟踪的，而没有在问题跟踪系统中创建任何“问题”。

我在这两者之间看到的问题是，对于没有经验的用户来说，将工单输入到[Trac](http://trac.edgewall.org/)之类的东西确实不是很容易，因为他们被技术术语弄糊涂了。但是，高级问题跟踪系统并未与代码紧密集成，因此对开发人员来说毫无用处。

无论如何...我的 0.02 美元。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-06-02T20:35:28.843

***错误***：流程（应用程序、数据库、报告等）中任何地方的缺陷，这些缺陷将阻止 100% 的所需功能发生。也称为缺陷。

***问题***：可能由一个或多个错误引起，问题是系统中某种形式的与用户相关的功能丢失的报告。在某些组织中，这些也称为帮助台票。

* * *

**维基百科链接**
-[软件错误](http://en.wikipedia.org/wiki/Software_bug)
-[问题跟踪](http://en.wikipedia.org/wiki/Issue_tracking_system)

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2012-03-30T00:22:36.237

要回答这个问题，它需要上下文，从它的外观来看，艾伦的回答是针对您的上下文。

在软件测试的世界中，我们对问题和错误的区分之一是：**错误是威胁产品价值的**任何东西，而**问题是威胁测试价值（或项目价值和特别是测试的价值）。** [快速软件测试](http://www.developsense.com/blog/2011/01/youve-got-issues/)告诉我们这一点。

根据我的经验，跟踪系统允许您在两者之间做出任何您想要的区分。如何使用特定的跟踪系统取决于您。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-06-02T20:21:36.140

我不认为有一个明确的答案，但我通常只是认为问题跟踪只是一个更通用的术语，它不仅仅对应于“错误”。只使用“Bug Tracking”这个词有点像鸽子洞，它与软件中的缺陷有关。

问题跟踪器不必与软件绑定，甚至 BugZilla 也不仅仅跟踪*错误*，还跟踪新的增强/功能请求、投票等。这样，我认为“问题”只是一个某人想要“完成”的单个感兴趣的项目。

最近工作项跟踪也有所增加（例如在[Visual Studio](http://blogs.msdn.com/bharry/archive/2009/05/18/tfs-2010-work-item-tracking.aspx)和[IBM/Rational Jazz](https://jazz.net/projects/rational-team-concert/features/wi.jsp)中），它比“问题”级别更低——其中一个问题可以被视为需要 N 个较小的工作项来完全的。在更高的层次上，您可能还会看到类似于[BugZilla中的](http://www.bugzilla.org/)[里程碑](http://www.bugzilla.org/docs/3.4/en/html/milestones.html)的东西。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-06-02T20:06:21.443

错误是特定于软件开发人员的。问题更普遍，可以包括所有团队成员在项目上的进度，包括平面设计师、系统管理员、公司高管等。

问题跟踪器会根据要做的事情来说话，并且可以在需要时将项目归类为错误。

这大多只是愚蠢的词，但我使用“问题跟踪器”，因为我与许多不是程序员的人一起工作，我们需要通过一个通用的生产力工具说一种通用的语言，让我们知道彼此在做什么.

您可以使用错误跟踪器，但它只会让非开发人员感到困惑，尤其是当他们不得不将他们的任务视为错误时。

我想说，对于程序员来说，区分 bug 和问题也很好，因为 bug 通常是现有代码的问题，而问题可能是新功能请求。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-06-02T20:29:53.190

嗯......除了一个问题不仅仅是一个错误之外，没有什么区别。它可以是一项任务、一项新功能，或者仅仅是一项改进。错误通常被视为不正确的系统行为，而问题具有更广泛的定义。不仅仅是“它不起作用”......

# .net - Fluent NHibernate 和 migratordotnet 可以很好地配合使用吗？

> ID：941513
> 
> 赞同：16
> 
> 时间：2009-06-02T19:43:11.927
> 
> 标签：.net, fluent-nhibernate, migration, migratordotnet

我喜欢 Fluent NHibernate 来构建我的数据库，并且到目前为止还没有发现任何阻碍我前进的限制。

然而，在我目前的项目中，我希望在产品生命周期的早期发布到生产环境，因此预计随着我们的进展，db 模式会有许多小的变化。

我想使用[migratordotnet](http://code.google.com/p/migratordotnet/)之类的工具在“迁移”中跟踪这些 DDL 和 DML 更改。但我的问题是：是否有可能让这两个工具（或类似工具）一起工作？

本着 DRY 的精神，我如何从 Fluent Nhibernate 中的映射中导出架构更改？这可能吗？

或者是将模式生成留给诸如 migratordotnet 之类的工具并让 Fluent NHibernate 只负责映射的更好方法？嗯，这似乎是在工具级别更好地分离关注点。

干杯!

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-03T20:07:14.183

戈登，

我在以前的项目中也有同样的问题，我们已经决定将 migratordotnet 专门用于我们的数据库迁移，并且完全跳过 SchemaUpdate。

我仍然会使用 SchemaUpdate 来快速制作原型，但是一旦我认真开始这个项目，我只会使用 migratordotnet。

随着迁移设置作为我们 Nightly 构建的一部分运行，一旦我们有多个人在一个项目上工作，migratordotnet 就会很好地工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T15:00:17.190

我也遇到了同样的问题，我不想独立维护迁移（使用 migratordotnet）和我的映射文件。到目前为止，我发现的唯一有用的东西是 NHibernate 的 SchemaUpdate，但它不能处理删除列或表。对于这些类型的更改，您仍然需要手写迁移。现在我倾向于使用 migratordotnet 专门用于数据库更改，而不是混合使用 SchemaUpdate 生成 DDL 和迁移。不过，这似乎仍然容易出错，因为您可能会错误地将映射/域层更改转换为迁移。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-21T17:03:49.207

我面临同样的问题。这是我当前避免 SchemaUpdate 的工作流程：

*   从头开始构建数据库（如果进行了任何更改）
*   将所有参考数据保存在电子表格中
*   通过特殊命令行“dataloader”项目重新加载所有数据

此工作流程有利于开发，因为每次都从头开始重建和填充数据库可以解决数据库版本控制问题。它还为围绕您的数据库和您插入的实际数据进行测试提供了良好的基础。

显然，一旦运行的实时数据库无法删除并随意重建，这将无法在生产中工作。这就是我正在做的事情：

*   开发周期完成后，我会克隆生产数据库。Prod 数据库在升级期间设置为只读（对我的应用程序来说还可以……不确定更多时间关键的应用程序）
*   使用 SQL Compare 将更改和数据从 dev 迁移到 prod 数据库
*   推这个来测试。
*   如果测试通过，则推送到生产环境。

这并不理想，并且使用了商业 SQL 比较产品。它一直对我有用，但我想听听一些更好的想法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-08-30T12:34:32.700

是的——主要是。我成功地将 FNH 和 migratordotnet 用于厚桌面客户端，并且效果很好。我不得不为两件事修改它：

1.  允许将 sql 连接注入 TransformationProvider（或更准确地说是 SQLiteTransformationProvider）

2.  删除对其他非 sqlite TransformationProviders 的引用，因为当我尝试将它与我的应用程序打包时，它会引发各种关于无法找到 Oracle、Postgres 等的错误。

3.  这是特定于 sqlite 的 - 破解它以便更好地解析 sqlite create table 语句。不幸的是，它无法处理表单的创建表语句`CREATE TABLE FOO(id INT, ..., primary key(id))`（与`CREATE TABLE FOO(id INT PRIMARY KEY, ...)`它处理的相反）。结合它执行列删除的方式（创建新表无列，传输数据，删除原始并将新的重命名为原始），这意味着您可以获得非常讨厌的行为，例如在表上删除列，使您的主键列成为非主键列。

# java - 难以用 java 内容显示日文字符

> ID：941516
> 
> 赞同：0
> 
> 时间：2009-06-02T19:43:25.920
> 
> 标签：java, unicode, internationalization, look-and-feel

出于某种原因，当我在标题栏中以 java 内容为主题的日文字符时，我无法显示它们。相反，它显示为正方形。如果我没有实质主题，我可以在标题栏中看到日文字符。我已经找到了在我的程序的所有其他部分显示这些字符的方法，除了标题栏。我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-07T18:47:44.630

这只是在黑暗中拍摄，但在绘制第一个 JFrame 之前尝试设置此[属性：](http://java.sun.com/javase/6/docs/api/javax/swing/JFrame.html#setDefaultLookAndFeelDecorated(boolean))

JFrame.setDefaultLookAndFeelDecorated(false)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T19:51:49.273

标题栏需要使用支持日文字符的字体。这通常由窗口管理器控制，例如 MS Windows 内置的窗口管理器。

可以在其他程序的标题栏中显示日文字符吗？

# filesystems - 如何制作nutch爬取文件系统？

> ID：941519
> 
> 赞同：4
> 
> 时间：2009-06-02T19:44:23.843
> 
> 标签：filesystems, nutch, web-crawler

不基于http，

比如[http://localhost:81](http://localhost:81)等等，

而是直接爬取本地文件系统上的某个目录，

有什么出路吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-07-12T03:39:23.033

***来自 Nutch 维基：***

**如何索引我的本地文件系统？**

[http://wiki.apache.org/nutch/FAQ#head-c721b23b43b15885f5ea7d8da62c1c40a37878e6](http://wiki.apache.org/nutch/FAQ#head-c721b23b43b15885f5ea7d8da62c1c40a37878e6)

1） crawl-urlfilter.txt 需要更改以允许 file: URLs 而不是 http: 的，否则它不会索引任何内容，或者它会从你的磁盘跳到网站上。更改此行：

```
 -^(file|ftp|mailto|https):

  to this:

  -^(http|ftp|mailto|https): 
```

2) crawl-urlfilter.txt 的底部可能有规则来拒绝某些 URL。如果它有这个片段可能没问题：

```
 # accept anything else +.* 
```

3) 我更改了我的 nutch.xml 以包含以下内容：

```
<Parameter override="false" name="plugin.includes" value="protocol-file|protocol-http|urlfilter-regex|parse-(msword|pdf|text|html|js)|index-(basic|anchor)|query-(basic|site|url)|response-(json|xml)|summary-basic|scoring-opic|urlnormalizer-(pass|regex|basic)"/> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-12T18:25:53.213

nutch 具有可用的 Intranet 爬取功能。你可以在[这里阅读详细信息](http://wiki.apache.org/nutch/IntranetRecrawl)

# c# - 如何解决 silverlight 2/3 中缺少的加密类？

> ID：941528
> 
> 赞同：2
> 
> 时间：2009-06-02T19:46:39.487
> 
> 标签：c#, silverlight, cryptography

我正在使用我无法控制的服务器端服务做一些工作。以下在标准 C# 中工作正常，但在 Silverlight 2 和 3 中失败（由于缺少加密类）。

```
 static String DecryptString()
    {
        s = "<cipherTextHere>";

        byte[] toDecryptArray = Convert.FromBase64String(s);
        string key = "<key here>";

        byte[] keyArray = new byte[key.Length / 2];
        for (int i = 0; i < keyArray.Length; i++)
        {
            keyArray[i] = Convert.ToByte(Convert.ToInt32(key.Substring(i * 2, 2), 16));
        }

        using (var algo = new System.Security.Cryptography.AesManaged())
        {

            // The two lines below are the problem
            // as SL does not give me the option to select padding or ciphermode
            algo.Padding = PaddingMode.PKCS7;
            algo.Mode = CipherMode.ECB;

            algo.Key = keyArray;

            ICryptoTransform cTransform = algo.CreateDecryptor();
            byte[] resultArray = cTransform.TransformFinalBlock(
                                 toDecryptArray, 0, toDecryptArray.Length);

            return (UTF8Encoding.UTF8.GetString(resultArray, 0, resultArray.Length));

        }
    } 
```

我有哪些选择？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T19:50:50.447

您可以编写自己的加密提供程序，也可以搜索已经解决该问题的第三方组件。

我知道 xceed 已经为 Silverlight 实现了一个压缩提供程序，因此压缩和加密绝对是可能的。

尝试

[密码学教程](http://www.cryptography-tutorial.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T19:48:15.647

呼吁[充气城堡军团](http://www.bouncycastle.org/csharp/)帮助您摆脱这种束缚。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T21:08:27.950

Silverlight 2 确实实现了一些 System.Security.Cryptography 命名空间。[请参阅此处](http://msdn.microsoft.com/en-us/library/system.security.cryptography(VS.95).aspx)的文档。你缺少什么？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T22:08:04.303

[聪明人](http://www.netcrucible.com/blog/)的解决方案：“您不能在 Silverlight 中为 AesManaged 选择填充或密码模式，因此您必须使用默认值。默认填充是 PKCS7，就像在您的 C# 代码中一样，但密码模式是 CBC。”

这行得通，但现在我必须说服服务提供商切换:(

# image - .NET 按钮的图像

> ID：941534
> 
> 赞同：3
> 
> 时间：2009-06-02T19:47:34.307
> 
> 标签：image, button, standards

我有一个支持多种标准操作的应用程序

*   玩
*   停止
*   暂停
*   撤消

我想要这些按钮的图像。我一直在搜索 vs2005 图像库，但那里的图像不一致。例如，播放按钮 (playhs.bmp) 为绿色，而停止 (stophs.bmp) 为蓝色。

我还没有找到撤消图像

还有哪些其他常见的图像包？或者有没有类似 vs2005 图像库的插件？如果可能的话，我想要一些免费的东西

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T19:49:55.720

在 Joel of Software 论坛上查看此线程：

[http://discuss.joelonsoftware.com/default.asp?biz.5.755808.5](http://discuss.joelonsoftware.com/default.asp?biz.5.755808.5)

很多优秀的免费图标包！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T19:52:35.263

该网站应该可以帮助您：

[http://www.minervity.com/features/icons-features/18-search-engines-for-designers-creativity-boost/](http://www.minervity.com/features/icons-features/18-search-engines-for-designers-creativity-boost/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T19:52:37.727

我推荐为 16x16 小图标设置的免费[Silk图标。](http://www.famfamfam.com/lab/icons/silk/)

# communication - 为业务层和表示层之间的通信服务的对象

> ID：941536
> 
> 赞同：1
> 
> 时间：2009-06-02T19:47:44.197
> 
> 标签：communication, layer

这是一个关于设计的普遍问题。在您的业务层和表示层之间进行通信的最佳方式是什么？我们目前有一个对象传递到我们的业务层，服务从对象读取信息并将结果设置到对象中。服务完成后，我们将使用业务层的结果填充一个对象，然后 UI 可以根据对象的结果显示。

这是最好的方法吗？还有什么其他方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T19:57:35.330

领域驱动设计书籍（*快速*版本可[在此处](http://www.infoq.com/minibooks/domain-driven-design-quickly)免费获得）可以让您深入了解这一点。

简而言之，他们建议采用以下方法：模型对象从模型层无缝横向到视图层（如果您在 clinet/server 上使用静态类型语言或不同语言，这可能会很棘手，但在动态语言上却很简单）。此外，服务只能用于执行不属于模型对象本身的操作（或者当您的操作涉及大量模型对象时）。

此外，应将业务逻辑放入模型层（实体、服务、值对象），以防止著名的[贫血领域模型](http://martinfowler.com/bliki/AnemicDomainModel.html)反模式。

这是另一种方法。如果它适合你，它在很大程度上取决于团队，编写了多少代码，你有多少测试覆盖率，项目有多长，你的团队是否敏捷，等等。领域驱动设计很快就进一步讨论了它，如果你至少先略读它，任何决定的风险都会大大降低（如果你选择进一步深入研究，从 Eric Evans 那里获得原著会有所帮助）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T19:57:41.103

我们使用侦听器模式，并让业务层中的事件将信息发送到表示层。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T20:01:27.290

这取决于您的架构。

有些人在同一个 exe 或 dll 中构建他们的代码，并遵循标准的 n 层架构。

其他人可能会将其拆分，以便他们的服务都是 Web 服务，而不仅仅是标准类。这样做的好处是可重用的业务逻辑安装在您的物理基础设施的一个地方。因此，单个更改适用于所有应用程序。

软件即服务和云计算正在成为事物发展的平台。Amazon 的 Elastic Cloud、Microsoft 的 Azure 和其他云提供商都提供了大量服务，这些服务可能会影响您的架构决策。

我将要使用的一个是

Silverlight 用户界面

WCF 服务 - 这里的业务逻辑

NHibernate 数据访问

Sql 服务器数据库

我们将只允许应用程序的各个层通过接口进行通信，以便一旦 Azure 云服务变得更加成熟，我们就可以升级到它。

# php - 推荐用于 PHP 项目持续集成的服务器

> ID：941537
> 
> 赞同：18
> 
> 时间：2009-06-02T19:47:54.740
> 
> 标签：php, continuous-integration

我正在开发一个 PHP 项目，我想知道实施[持续集成](http://en.wikipedia.org/wiki/Continuous_integration)的建议。

我已经阅读了所有的理论，但我从未使用过持续集成。所以它应该很容易开始。

我已经阅读了有关[Xinc](http://code.google.com/p/xinc/)、[Hudson](http://en.wikipedia.org/wiki/Hudson_%28software%29)等的信息，但我想根据经验获得一些反馈。你在 PHP 项目中使用过持续集成吗？你有什么经验吗？你会推荐哪个服务器？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2011-02-23T13:59:28.903

现在还有 Jenkins，[甲骨文对 Hudson 大惊小怪](http://www.infoq.com/news/2011/01/jenkins)。它有一个配置模板，可以轻松地使用PHP CI 环境所需的所有[QA 工具进行设置：](http://phpqatools.org/)

*   [http://edorian.github.io/2011-02-01-setting-up-jenkins-for-php-projects](http://edorian.github.io/2011-02-01-setting-up-jenkins-for-php-projects)
*   [http://jenkins-php.org](http://jenkins-php.org)
*   [http://jenkins-ci.org](http://jenkins-ci.org)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-02T19:57:24.160

我对基于 CruiseControl的[phpUnderControl很幸运。](http://phpundercontrol.org/about.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-12-21T12:34:04.270

我已经尝试使用 phpUnderControl 和 Hudson 进行 CruiseControl。我也看过Xinc，但目前似乎太有限了。

最后我选择了 Hudson，因为它比 CruiseControl 更容易设置，并且适用于 ant 脚本或简单的 bash 脚本。

另一个看起来很有希望的选择是[arbit](http://arbitracker.org/)。它有点像 trac，但添加了 CI。Symfony 的人也有一些东西，但还处于非常早期的阶段。

# sql - 如何在此查询中修复此 SQL 错误

> ID：941547
> 
> 赞同：1
> 
> 时间：2009-06-02T19:49:48.497
> 
> 标签：sql, sql-server-2005

```
DECLARE @providerIdList varchar(400)
DECLARE @q varchar(400)

SELECT @q  =  ''

SELECT @providerIdList = '(1, 5, 15)'

SET @q = 'SELECT u.Id FROM [user] u
    LEFT JOIN Provider p ON u.Provider_FK = p.Id
    LEFT JOIN  Providers2Users pu ON pu.user_FK = u.Id 
    LEFT JOIN Provider ap ON ap.Id = pu.provider_fk
    WHERE p.Id  IN ' + @providerIdList

exec @q 
```

这是我尝试执行上面显示的查询时遇到的异常

* * *

```
Msg 203, Level 16, State 2, Line 18
The name 'SELECT u.Id FROM [user] u
    LEFT JOIN Provider p ON u.Provider_FK = p.Id
    LEFT JOIN  Providers2Users pu ON pu.user_FK = u.Id 
    LEFT JOIN Provider ap ON ap.Id = pu.provider_fk
    WHERE p.Id  IN (1, 5, 15)' is not a valid identifier. 
```

* * *

如果有人能指出这些错误的原因，我将不胜感激

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-02T19:51:21.863

您正在寻找[sp_executesql](http://msdn.microsoft.com/en-us/library/ms188001.aspx)。改为这样做：

```
DECLARE @providerIdList nvarchar(400)
DECLARE @q nvarchar(400)

SELECT @q  =  N''

SELECT @providerIdList = N'(1, 5, 15)'

SET @q = N'SELECT u.Id FROM [user] u
    LEFT JOIN Provider p ON u.Provider_FK = p.Id
    LEFT JOIN  Providers2Users pu ON pu.user_FK = u.Id 
    LEFT JOIN Provider ap ON ap.Id = pu.provider_fk
    WHERE p.Id  IN ' + @providerIdList

exec sp_executesql @q 
```

您现在正在做的是尝试将命令作为存储过程调用，但显然不是。sp_executesql 是一个系统存储过程，它允许您执行有效的 SQL 语句。系统存储过程在主数据库上，仅供参考。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-02T19:55:15.537

你也可以使用

```
exec(@q) 
```

这将执行文字字符串。

区别就在括号里！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T20:54:10.303

或者考虑到您作为代码显示的内容，我根本不会使用动态 SQL。如果可能，应避免使用动态 SQL。

```
SELECT u.Id FROM [user] u    
LEFT JOIN Provider p ON u.Provider_FK = p.Id    
LEFT JOIN  Providers2Users pu ON pu.user_FK = u.Id     
LEFT JOIN Provider ap ON ap.Id = pu.provider_fk    
WHERE p.Id  IN (1, 5, 15) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T19:56:49.263

您尝试执行无效的存储过程@q，请使用：

```
execute (@q) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T20:01:06.323

好的，请确保您使用 NVARCHAR 而不是 VARCHAR。就在那时你可能会使用`EXEC sp_executesql @q`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-02T20:06:50.100

声明@params NVARCHAR(4000)
声明@sql NVARCHAR(4000)

SET @providerIdList = '(1, 5, 15)'

SET @sql = 'SELECT u.Id FROM [user] u LEFT JOIN Provider p ON u.Provider_FK = p.Id LEFT JOIN Providers2Users pu ON pu.user_FK = u.Id LEFT JOIN Provider ap ON ap.Id = pu.provider_fk哪里 p.Id 在 ' + @providerIdList'

SELECT @params = N'@providerIdList VARCHAR OUTPUT'

exec sp_executesql @sql, @params,@providerIdList=@providerIdList

# java - 进行 O/R 映射时的命名约定

> ID：941550
> 
> 赞同：3
> 
> 时间：2009-06-02T19:50:15.377
> 
> 标签：java, database, jpa, orm

我正在将我的数据库表映射到我的 java 对象。通常我以复数形式命名我的表，因为保存书籍信息的表称为 BOOKS。然而，java 对象代表一本书，应该称为 Book。对于 AUTHORS/Author 等也是如此。

另一方面，对域对象和表赋予相同的属性是一种简单化。

人们是否遵循某种命名约定？我想这通常适用于应用程序，而不仅仅是在进行 O/R 映射时。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-02T19:55:20.233

你最初的想法是正确的。

对象应该是单一的，因为每个对象都是单独的。

表格应该是复数，因为表格包含所有内容。

查看 Ruby on Rails 中内置的命名约定，它们是相关的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-02T20:14:19.477

我们对表名和 OM 类使用单数。对我来说，这样说更有意义

> person.last_name

比

> people.last_name,

无论我是在编写 SQL 还是 Java（当然，它是 person.lastName，但你明白了）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T19:56:12.243

我在我的 ASP.NET 应用程序中使用 SubSonic，并且在命名 ActiveRecord 类时将其去掉复数。与其说是标准，不如说是风格问题。

我更喜欢使用`Invoice`而不是`Invoices`因为我*通常*一次处理 1 条记录。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T19:57:23.240

我通常只是确保我在任何地方都使用相同的标准，并且我使用逻辑名称来命名。

所以 Books 变成了 DbBooks，Authors 变成了 DbAuthors 等等。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T20:30:10.087

[CJ Date](https://rads.stackoverflow.com/amzn/click/com/159059746X)不使用复数名称，您也不应该使用。唯一的例外是“销售”一词。除此之外，使用单数名称。

比较

> 用户邮箱 = ? 和 account.value 在 (1,2,3)

到

> users.email = ? 和 account.value 在 (1,2,3)

或（最坏的选择）

> users.email = ? 和 account.values 在 (1,2,3)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-07-30T19:02:25.953

jOOQ 从您的数据库模式生成 Java 类。对表格建模的类将被称为与表格本身相同的名称，例如

*   `AUTHOR`>`Author`
*   `BOOKS`>`Books`

对对象（或记录）进行建模的类将以“ `Record`”为后缀：

*   `AUTHOR`>`AuthorRecord`
*   `BOOKS`>`BooksRecord`

无论您的表叫什么，这都是非常直观和通用的。看

[http://www.jooq.org](http://www.jooq.org)

# excel - 使用 VBA 将图像从一张纸的页眉/页脚复制到另一张纸

> ID：941559
> 
> 赞同：2
> 
> 时间：2009-06-02T19:53:23.140
> 
> 标签：excel, page-setup, vba

我需要编写一个 VBA 代码来将一个 Excel 工作表的页眉/页脚中的公司徽标复制到另一个工作簿中的另一个工作表中。有任何想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-02T19:57:31.010

Excel 有一个方便的记录宏功能。

您可以启动它，复制页脚，然后停止录制。

然后，查看代码，它应该会向您展示如何执行此操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T02:30:42.777

**一种解决方法是将原始**工作表复制到**新**工作簿：

```
 ' macro on the source workbook
    Sheets("Sheet1").Move After:=Workbooks("Book2").Sheets(3) 
```

执行此操作时，您会在目标工作簿中获得一个工作表，其中包含原始工作表的所有功能，包括页脚和页眉，然后您可以将所需的所有内容复制到新工作表中

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-02T23:02:01.403

如果您使用的是 Excel 2007 之前的版本，那么如果不使用原始图形文件（例如 JPG、GIF 等），这听起来是不可能的：

> 通常，您可以将页眉和页脚从一个工作表复制并粘贴到另一个工作表，方法是选择工作表，然后使用页眉或页脚对话框（单击页面设置对话框的页眉/页脚选项卡上的自定义页眉或自定义页脚）。但是，如果原始页眉和页脚包含图形，则图形不会传播到其他工作表。在多个工作表的页眉或页脚中处理图片的唯一方法是选择所有工作表，然后使用“插入图片”对话框（单击“插入图片”按钮）插入图形，或使用“设置图片格式”来设置图形的格式对话框（单击设置图片格式按钮）。此过程需要原始图形文件。
> 
> [资源](http://office.microsoft.com/en-us/excel/HA010346411033.aspx)

在 Excel 2007 中可能是可能的 - 请参见[此处](http://msdn.microsoft.com/en-us/library/dd627338.aspx)

# ruby - 在 Ruby Watir 中使用 XPath 进行健全性检查

> ID：941564
> 
> 赞同：1
> 
> 时间：2009-06-02T19:54:01.377
> 
> 标签：ruby, xpath, watir

我正在使用 Ruby Watir 库为客户端进行自动化测试，但我遇到了 XPath 选择器的问题。我想我只需要另一双眼睛让我知道我是否只是错过了什么。

这是我正在使用的选择器：

```
puts ie.cell(:xpath, "//img[@src='3.jpg']/../").text 
```

对于这组表格，它按预期工作并打印“第三张图像”：

```
<table>
  <tr>
    <td><img src="1.jpg">First Image</td>
  </tr>
</table>
<table>
  <tr>
    <td><img src="2.jpg">Second Image</td>
  </tr>
</table>
<table>
  <tr>
    <td><img src="3.jpg">Third Image</td>
  </tr>
</table> 
```

但是当我删除第二个表时它正在中断：

```
<table>
  <tr>
    <td><img src="1.jpg">First Image</td>
  </tr>
</table>
<table>
  <tr>
    <td><img src="3.jpg">Third Image</td>
  </tr>
</table> 
```

使用上面的 puts 代码，我在第二个示例中得到了这个错误：

```
Watir::Exception::UnknownObjectException: Unable to locate element, using :xpath, "//img[@src='3.jpg']/../" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T07:41:36.453

我重现了这个问题，并重新启动浏览器（IE6）为我修复了它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-12-19T20:05:45.313

对于当前版本的 Watir，更好的方法是

browser.img(:src => '3.jpg').parent.text

# actionscript-3 - 如何“强制下载”完全在 Flash 中生成的文件？

> ID：941569
> 
> 赞同：0
> 
> 时间：2009-06-02T19:55:29.780
> 
> 标签：actionscript-3, browser, flash

如果我在 Flash Player 中生成二进制文件，如何在不先将其发送到服务器的情况下为该文件弹出一个“保存”对话框？

我确定我听说这是 Flash 10 中的一项新功能。

干杯，
詹姆斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-05T18:57:51.893

这将有所帮助，并真正向您展示如何做到这一点，您需要记住的是，打开和保存文件只能通过用户启动来完成，它不能自动化，所以不确定您要做什么，但是这将有助于：

[http://www.mikechambers.com/blog/2008/08/20/reading-and-writing-local-files-in-flash-player-10/](http://www.mikechambers.com/blog/2008/08/20/reading-and-writing-local-files-in-flash-player-10/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T20:10:39.313

如果您在 Flash 播放器中，您可以执行以下操作：

```
import flash.net.FileReference;
import flash.utils.ByteArray;

var fileReference:FileReference = new FileReference();

var data:ByteArray; // load up your data into this ByteArray

fileReference.save(data, "outputfile.dat"); 
```

如果您在浏览器中运行，这将不起作用 - 至少据我所知，但如果您在 Flash 播放器中，这将起作用。

FileReference.save() 方法将弹出一个对话框供用户选择保存文件的位置，因此给出的文件名只是建议的文件名。

**编辑：**如果您遇到问题，请参阅下面的 Technomaag 评论

# c++ - 函数指针问题

> ID：941571
> 
> 赞同：3
> 
> 时间：2009-06-02T19:56:24.180
> 
> 标签：c++, function, pointers

我正在尝试使用函数指针，但下面的 3 行似乎不想合作......

我收到错误代码 C3867。

你能看出我做错了什么吗？

在 .h 文件中

```
void MyFunc(int, FILEINFO*(*)(FILEINFO*), FILEINFO*, int); 
```

.cpp 文件中的定义

```
void MyFunc(int number, FILEINFO*(*GetFiles)(FILEINFO*), FILEINFO* args, int type); 
```

然后这里是我实际调用函数的地方

```
MyFuncClass->MyFunc(GetNumber(), &BigClass::PassThis, GetArgs(), TheType); 
```

有什么问题跳出来吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-02T20:01:42.843

的定义是`BigClass::PassThis()`什么？它是静态类成员函数还是常规成员函数？如果它是一个普通的成员函数，你不能这样做，因为它有一个隐藏的`this`参数。请参阅C++ FAQ Lite 的[问题 33.4](http://www.parashift.com/c++-faq-lite/pointers-to-members.html#faq-33.4)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-02T20:04:35.707

您不能将类的非静态成员函数作为普通函数指针传递，因为成员函数隐式使用 this 指针。一个解决方案是定义一个静态成员函数，它将指向类的指针作为它的第一个参数，并将调用包装起来并将`BigClass::PassThis`指针传递给该成员函数。请参阅 [函数指针教程](http://www.newty.de/fpt/callback.html#member)了解更多信息。

一个更好的解决方案可能是考虑使用仿函数。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-02T20:01:44.743

我们需要查看 BigClass 的定义。除非 PassThis 是静态成员函数，否则您所做的将无法正常工作，因为常规成员函数不能以您正在执行的方式作为函数指针传递（除其他外，您没有“this”参数）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-02T20:02:34.213

我猜这`&BigClass::PassThis`是指向成员函数的指针，而不是指向普通函数的指针。

# c# - 如何在方法中向下转换 ref 变量

> ID：941572
> 
> 赞同：0
> 
> 时间：2009-06-02T19:56:25.503
> 
> 标签：c#, .net, casting, ref-parameters

我需要在 long 作为 ref 变量传递的方法中将 long 向下转换为 int：

```
public void Foo(ref long l)
{
    // need to consume l as an int
} 
```

我怎样才能轻松做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T20:02:41.233

你不能。但是，无论如何，您想放入 a 的任何值`ref int`都可以放入 a `ref long`- 您只需要担心初始值，以及如果它超出范围时您想要做什么`int`。

您需要在代码中写入 ref 参数或读取多少个地方？如果只是在一两个地方，你应该可以在正确的时间适当地施放。否则，您可能需要引入一种新方法：

```
public void Foo(ref int x)
{
    // Here's the body I *really* want
}

public void Foo(ref long x)
{
    // But I'm forced to use this signature for whatever
    // reasons. Oh well. This hack isn't an *exact* mimic
    // of ref behaviour, but it's close.

    // TODO: Decide an overflow policy
    int tmp = (int) x;
    Foo(ref tmp);
    x = tmp;
} 
```

我在评论中说它不是行为的精确模仿的原因是，通常即使在方法返回之前，对原始 ref 参数的更改也是可见的，但现在它们只会在最后才可见。此外，如果该方法引发异常，则该值不会被更改。后者*可以*用 try/finally 修复，但这有点笨拙。事实上，如果您想要 try/finally 行为，您可以轻松地在一个方法中完成所有操作：

```
public void Foo(ref long x)
{
    int y = (int) x;
    try
    {
        // Main body of code
    }
    finally
    {
        x = y;
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-02T19:58:01.163

你没有。你不能把你的参考指向不同的类型。调用您的方法的代码如何知道它已更改？

如果您只想将值用作`int`，那么您可以执行以下操作：

```
private void Process(ref long l)
{
    int i = (int)l;
    // do whatever
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T19:59:21.973

你对细节有点了解，但如果你在谈论这种情况：

```
public void Something(ref long something)
{
    // code
}

int foo;
Something(ref foo); 
```

试试这个：

```
long foo;
Something(ref foo);
int bar = (int) foo; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T20:01:20.097

无论它是否可以为空，您都不能安全地将 long 转换为 int，因为它有可能溢出。

试试这个

```
 if (!blah.HasValue)
            blah = long.MaxValue;

        int x = (int)blah.Value;

        Console.WriteLine(x); //Not What you expect 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T19:59:08.433

你不能直接施放这个。最好的选择是将其转换为本地，然后在方法结束时分配它。

```
void Method(ref long myValue)
{
   int tempValue = (int)myValue;
   // change tempValue
   myValue = tempValue;
} 
```

# c# - byte + byte = int ... 为什么？

> ID：941584
> 
> 赞同：390
> 
> 时间：2009-06-02T19:59:00.430
> 
> 标签：c#, type-conversion

查看此 C# 代码：

```
byte x = 1;
byte y = 2;
byte z = x + y; // ERROR: Cannot implicitly convert type 'int' to 'byte' 
```

`byte`对(or ) 类型执行的任何数学运算的结果`short`都会隐式转换回整数。解决方案是将结果显式转换回一个字节：

```
byte z = (byte)(x + y); // this works 
```

我想知道为什么？它是建筑的吗？哲学？

**我们有：**

*   `int`+ `int`=`int`
*   `long`+ `long`=`long`
*   `float`+ `float`=`float`
*   `double`+ `double`=`double`

**那么为什么不呢：**

*   `byte`+ `byte`=`byte`
*   `short`+ `short`= `short`?

一点背景知识：我正在对“小数”（即 < 8）执行一长串计算，并将中间结果存储在一个大数组中。使用*字节数组*（而不是 int 数组）*更快*（因为缓存命中）。但是通过代码传播的广泛的字节转换使它变得更加不可读。

* * *

## 回答 #1

> 赞同：241
> 
> 时间：2009-06-02T20:17:51.607

代码片段的第三行：

```
byte z = x + y; 
```

实际上意味着

```
byte z = (int) x + (int) y; 
```

因此，对字节没有 + 操作，字节首先转换为整数，两个整数相加的结果是一个（32 位）整数。

* * *

## 回答 #2

> 赞同：180
> 
> 时间：2009-06-02T20:08:45.387

正如其他人所说，就“为什么会发生”而言，这是因为 C# 没有为字节、sbyte、short 或 ushort 的算术定义任何运算符。这个答案是关于*为什么*没有定义这些运算符。

我相信这基本上是为了性能。处理器具有本机操作，可以非常快速地使用 32 位进行算术运算。*可以*自动将结果转换回字节，但在您实际上不想要这种行为的情况下会导致性能下降。

我*认为*这是在带注释的 C# 标准之一中提到的。看着...

编辑：烦人的是，我现在浏览了带注释的 ECMA C# 2 规范、带注释的 MS C# 3 规范和注释 CLI 规范，据我所知，它们*都没有*提到这一点。我*确定*我已经看到了上面给出的原因，但是如果我知道在哪里，我会感到震惊。道歉，参考粉丝:(

* * *

## 回答 #3

> 赞同：69
> 
> 时间：2009-06-02T20:04:18.157

我*以为*我以前在某个地方看到过这个。从[这篇文章中，旧的新事物](http://blogs.msdn.com/oldnewthing/archive/2004/03/10/87247.aspx)：

> 假设我们生活在一个幻想世界中，对“字节”的操作会产生“字节”。

```
byte b = 32;
byte c = 240;
int i = b + c; // what is i? 
```

> 在这个奇幻世界里，我的价值是16！为什么？因为 + 运算符的两个操作数都是字节，所以和“b+c”被计算为一个字节，由于整数溢出导致 16。（而且，正如我之前提到的，整数溢出是新的安全攻击向量。）

**编辑**：Raymond 本质上是在捍卫 C 和 C++ 最初采用的方法。在评论中，他为 C# 采用相同方法的事实辩护，理由是语言向后兼容。

* * *

## 回答 #4

> 赞同：60
> 
> 时间：2009-06-02T23:00:57.550

## C＃

ECMA-334 声明加法仅在 int+int、uint+uint、long+long 和 ulong+ulong 上被定义为合法（ECMA-334 14.7.4）。因此，这些是针对 14.4.2 考虑的候选操作。因为存在从 byte 到 int、uint、long 和 ulong 的隐式强制转换，所以所有加法函数成员都是 14.4.2.1 下适用的函数成员。我们必须找到 14.4.2.3 中规则的最佳隐式转换：

将(C1) 转换为 int(T1) 优于将(C2) 转换为 uint(T2) 或 ulong(T2)，因为：

*   如果 T1 是 int 而 T2 是 uint 或 ulong，则 C1 是更好的转换。

将(C1) 转换为 int(T1) 优于将(C2) 转换为 long(T2)，因为存在从 int 到 long 的隐式转换：

*   如果存在从 T1 到 T2 的隐式转换，并且不存在从 T2 到 T1 的隐式转换，则 C1 是更好的转换。

因此使用了 int+int 函数，它返回一个 int。

**可以说它深深地埋在 C# 规范中。**

## 命令行界面

CLI 仅在 6 种类型（int32、native int、int64、F、O 和 &）上运行。（ECMA-335 分区 3 第 1.5 节）

Byte (int8) 不是这些类型之一，在添加之前会自动强制转换为 int32。（ECMA-335 分区 3 第 1.6 节）

* * *

## 回答 #5

> 赞同：27
> 
> 时间：2009-06-02T21:30:24.067

表明添加字节并将结果截断回字节的某些低效率的答案是不正确的。x86 处理器具有专门为 8 位整数运算而设计的指令。

事实上，对于 x86/64 处理器，执行 32 位或 16 位操作的效率低于 64 位或 8 位操作，因为必须解码操作数前缀字节。在 32 位机器上，执行 16 位操作需要同样的惩罚，但仍然有 8 位操作的专用操作码。

许多 RISC 架构具有类似的本地字/字节高效指令。那些通常没有存储并转换为一些位长度的有符号值的。

换句话说，这个决定必须基于对字节类型的感知，而不是由于硬件的潜在低效率。

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2009-06-02T20:06:14.440

我记得有一次从 Jon Skeet 那里读到一些东西（现在找不到，我会继续寻找）关于 byte 实际上并没有使 + 运算符过载。事实上，当在您的示例中添加两个字节时，每个字节实际上都被隐式转换为一个 int。结果显然是一个int。现在至于为什么这样设计，我会等 Jon Skeet 自己发帖 :)

**编辑：**找到了！关于这个主题的重要信息[在这里](http://bytes.com/groups/net-c/463685-why-does-adding-2-bytes-together-result-int)。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2009-06-02T20:03:36.537

这是因为溢出和进位。

如果添加两个 8 位数字，它们可能会溢出到第 9 位。

例子：

```
 1111 1111
+ 0000 0001
-----------
1 0000 0000 
```

我不确定，但我认为`ints`,`longs`和`doubles`被给予更多空间，因为它们本来就相当大。此外，它们是 4 的倍数，由于内部数据总线的宽度为 4 字节或 32 位（现在 64 位越来越普遍），因此计算机处理效率更高。byte 和 short 效率稍低一些，但它们可以节省空间。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-06-02T20:13:28.030

从 C# 语言规范 1.6.7.5 7.2.6.2 Binary numeric Promotions 开始，如果它不能适合其他几个类别，它会将两个操作数都转换为 int。我的猜测是他们没有重载 + 运算符以将 byte 作为参数，而是希望它正常运行，因此他们只使用 int 数据类型。

[C# 语言规范](http://msdn.microsoft.com/en-us/vcsharp/aa336809.aspx)

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-06-02T20:05:52.350

我的怀疑是 C# 实际上调用了`operator+`定义的 on `int`（它返回 an`int`除非你在一个`checked`块中），并隐式地将你的`bytes`/`shorts`转换为`ints`. 这就是行为看起来不一致的原因。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-06-02T20:06:51.397

这可能是语言设计者的一个实际决定。毕竟，int 是一个 Int32，一个 32 位有符号整数。每当您对小于 int 的类型进行整数运算时，无论如何，大多数 32 位 CPU 都会将其转换为 32 位有符号 int。再加上溢出小整数的可能性，很可能达成了交易。它使您免于不断检查溢出/下溢的繁琐工作，并且当字节表达式的最终结果在范围内时，尽管在某些中间阶段它会超出范围，但您会得到正确的结果。

另一个想法：必须模拟这些类型的上溢/下溢，因为它不会在最有可能的目标 CPU 上自然发生。何必？

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-07-05T20:32:32.917

这在很大程度上是我与该主题相关的答案，首先提交到[此处](https://stackoverflow.com/questions/1084668)的类似问题。

默认情况下，所有小于 Int32 的整数运算在计算前都会四舍五入到 32 位。结果是 Int32 的原因只是在计算后保持原样。如果您检查 MSIL 算术操作码，它们操作的唯一整数类型是 Int32 和 Int64。这是“设计”。

如果您希望返回 Int16 格式的结果，则在代码中执行强制转换是无关紧要的，或者编译器（假设地）在“幕后”发出转换。

例如，做 Int16 算术：

```
short a = 2, b = 3;

short c = (short) (a + b); 
```

这两个数字将扩展为 32 位，相加，然后截断回 16 位，这就是 MS 的意图。

使用短（或字节）的优势主要是在您拥有大量数据（图形数据、流媒体等）的情况下进行存储。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-06-02T20:06:26.403

没有为字节定义加法。因此它们被强制转换为 int 以进行加法。大多数数学运算和字节都是如此。（请注意，这就是它过去在旧语言中的样子，我假设它今天仍然适用）。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2010-02-01T10:23:16.250

来自 .NET Framework 代码：

```
// bytes
private static object AddByte(byte Left, byte Right)
{
    short num = (short) (Left + Right);
    if (num > 0xff)
    {
        return num;
    }
    return (byte) num;
}

// shorts (int16)
private static object AddInt16(short Left, short Right)
{
    int num = Left + Right;
    if ((num <= 0x7fff) && (num >= -32768))
    {
        return (short) num;
    }
    return num;
} 
```

**使用 .NET 3.5 及更高版本进行**简化：****

 **```
public static class Extensions 
{
    public static byte Add(this byte a, byte b)
    {
        return (byte)(a + b);
    }
} 
```

现在你可以这样做：

 ****```
byte a = 1, b = 2, c;
c = a.Add(b); 
```**  *** * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-06-02T20:05:02.337

我认为这是关于哪种操作更常见的设计决定......如果 byte+byte = byte 可能更多的人会因为在需要 int 时必须强制转换为 int 而感到困扰。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2018-11-01T11:37:19.380

我已经测试了字节和整数之间的性能。
使用 int 值：

```
class Program
{
    private int a,b,c,d,e,f;

    public Program()
    {
        a = 1;
        b = 2;
        c = (a + b);
        d = (a - b);
        e = (b / a);
        f = (c * b);
    }

    static void Main(string[] args)
    {
        int max = 10000000;
        DateTime start = DateTime.Now;
        Program[] tab = new Program[max];

        for (int i = 0; i < max; i++)
        {
            tab[i] = new Program();
        }
        DateTime stop = DateTime.Now;

        Debug.WriteLine(stop.Subtract(start).TotalSeconds);
    }
} 
```

使用字节值：

```
class Program
{
    private byte a,b,c,d,e,f;

    public Program()
    {
        a = 1;
        b = 2;
        c = (byte)(a + b);
        d = (byte)(a - b);
        e = (byte)(b / a);
        f = (byte)(c * b);
    }

    static void Main(string[] args)
    {
        int max = 10000000;
        DateTime start = DateTime.Now;
        Program[] tab = new Program[max];

        for (int i = 0; i < max; i++)
        {
            tab[i] = new Program();
        }
        DateTime stop = DateTime.Now;

        Debug.WriteLine(stop.Subtract(start).TotalSeconds);
    }
} 
```

结果如下：
byte : 3.57s 157mo, 3.71s 171mo, 3.74s 168mo with CPU ~= 30%
int : 4.05s 298mo, 3.92s 278mo, 4.28 294mo with CPU ~= 27%
**结论 :**
byte 使用更多的 CPU 但它消耗更少的内存并且速度更快（可能是因为要分配的字节更少）

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2009-06-03T16:17:02.000

In addition to all the other great comments, I thought I would add one little tidbit. A lot of comments have wondered why int, long, and pretty much any other numeric type doesn't also follow this rule...return a "bigger" type in response to arithmatic.

A lot of answers have had to do with performance (well, 32bits is faster than 8bits). In reality, an 8bit number is still a 32bit number to a 32bit CPU....even if you add two bytes, the chunk of data the cpu operates on is going to be 32bits regardless...so adding ints is not going to be any "faster" than adding two bytes...its all the same to the cpu. NOW, adding two ints WILL be faster than adding two longs on a 32bit processor, because adding two longs requires more microops since you're working with numbers wider than the processors word.

I think the fundamental reason for causing byte arithmetic to result in ints is pretty clear and straight forward: 8bits just doesn't go very far! :D With 8 bits, you have an unsigned range of 0-255\. That's **not** a whole lot of room to work with...the likelyhood that you are going to run into a bytes limitations is VERY high when using them in arithmetic. However, the chance that you're going to run out of bits when working with ints, or longs, or doubles, etc. is significantly lower...low enough that we very rarely encounter the need for more.

Automatic conversion from byte to int is ***logical*** because the scale of a byte is so small. Automatic conversion from int to long, float to double, etc. is ***not logical*** because those numbers have significant scale.

# ruby-on-rails - 了解 Rails 真实性令牌

> ID：941594
> 
> 赞同：1030
> 
> 时间：2009-06-02T20:01:38.163
> 
> 标签：ruby-on-rails, ruby, authenticity-token

我遇到了一些关于 Rails 中的 Authenticity Token 的问题。

我真的很想了解 Authenticity 令牌。

您是否有关于此主题的完整信息来源，或者您会花时间在这里详细解释吗？

* * *

## 回答 #1

> 赞同：1514
> 
> 时间：2009-10-15T11:52:29.583

**发生什么了**

当用户查看表单以创建、更新或销毁资源时，Rails 应用程序会创建一个 random `authenticity_token`，将此令牌存储在会话中，并将其放置在表单的隐藏字段中。当用户提交表单时，Rails 会查找`authenticity_token`，并将其与存储在会话中的表单进行比较，如果匹配，则允许继续请求。

**为什么会发生**

由于真实性令牌存储在会话中，客户端无法知道其值。这可以防止人们在没有查看该应用程序本身的表单的情况下向 Rails 应用程序提交表单。想象一下，您正在使用服务 A，您已登录该服务并且一切正常。现在假设你去使用服务 B，你看到了一张你喜欢的图片，并按下图片查看它的更大尺寸。现在，如果服务 B 中有一些恶意代码，它可能会向服务 A（您已登录）发送请求，并通过向`http://serviceA.com/close_account`. 这就是所谓的[CSRF（跨站请求伪造）](http://en.wikipedia.org/wiki/Cross-site_request_forgery)。

如果服务 A 正在使用真实性令牌，则此攻击向量不再适用，因为来自服务 B 的请求将不包含正确的真实性令牌，并且不会被允许继续。

[API 文档](http://api.rubyonrails.org/classes/ActionController/RequestForgeryProtection.html)描述了有关元标记的详细信息：

> 使用该方法打开 CSRF 保护，该`protect_from_forgery`方法检查令牌并在它与预期不匹配时重置会话。默认情况下，会为新的 Rails 应用程序生成对该方法的调用。token 参数`authenticity_token`默认命名。必须将此标记的名称和值添加到通过包含`csrf_meta_tags`在 HTML 头部中来呈现表单的每个布局中。

**笔记**

请记住，Rails 仅验证非幂等方法（POST、PUT/PATCH 和 DELETE）。不检查 GET 请求的真实性令牌。为什么？因为 HTTP 规范规定 GET 请求是幂等的，不应**在**服务器上创建、更改或销毁资源，并且请求应该是幂等的（如果多次运行相同的命令，则每次都应该得到相同的结果）。

此外，真正的实现比一开始定义的要复杂一些，以确保更好的安全性。Rails 不会为每个表单颁发相同的存储令牌。它也不会每次都生成和存储不同的令牌。它在会话中生成并存储一个加密哈希，并在每次呈现页面时发布新的加密令牌，这些令牌可以与存储的令牌进行匹配。请参阅[request_forgery_protection.rb](https://github.com/rails/rails/blob/master/actionpack/lib/action_controller/metal/request_forgery_protection.rb#L329)。

**课程**

用于`authenticity_token`保护您的非幂等方法（POST、PUT/PATCH 和 DELETE）。还要确保不允许任何可能修改服务器上资源的 GET 请求。

* * *

**编辑：**检查[@erturne](https://stackoverflow.com/questions/941594/understand-rails-authenticity-token#comment16039314_1571900)关于 GET 请求是幂等的评论。他以比我在这里所做的更好的方式解释它。

* * *

## 回答 #2

> 赞同：144
> 
> 时间：2009-06-02T20:16:53.107

真实性令牌旨在让您知道您的表单是从您的网站提交的。它是从运行它的机器生成的，具有只有您的机器才能知道的唯一标识符，从而有助于防止跨站点请求伪造攻击。

如果您只是在拒绝您的 AJAX 脚本访问时遇到障碍，您可以使用

```
<%= form_authenticity_token %> 
```

在创建表单时生成正确的令牌。

[您可以在文档](http://api.rubyonrails.org/classes/ActionController/RequestForgeryProtection.html#M000491)中阅读有关它的更多信息。

* * *

## 回答 #3

> 赞同：94
> 
> 时间：2012-06-13T01:54:23.550

## 什么是 CSRF？

Authenticity Token 是针对跨站点请求伪造 (CSRF) 的对策。你问什么是 CSRF？

这是一种攻击者甚至可以在不知道会话令牌的情况下劫持会话的方式。

**场景**：

*   访问您的银行网站，登录。
*   然后访问攻击者的站点（例如来自不受信任的组织的赞助广告）。
*   攻击者的页面包括与银行的“转账”表单具有相同字段的表单。
*   攻击者知道您的帐户信息，并预先填写表单字段以将资金从您的帐户转移到攻击者的帐户。
*   攻击者的页面包含向您的银行提交表单的 Javascript。
*   提交表单后，浏览器会包含您的银行网站 cookie，包括会话令牌。
*   银行将钱转入攻击者的账户。
*   该表单可以位于不可见的 iframe 中，因此您永远不会知道攻击发生了。
*   这称为跨站点请求伪造 (CSRF)。

**CSRF 解决方案**：

*   服务器可以标记来自服务器本身的表单
*   每个表单都必须包含一个额外的身份验证令牌作为隐藏字段。
*   令牌必须是不可预测的（攻击者猜不到）。
*   服务器在其页面中的表单中提供有效令牌。
*   服务器在表单发布时检查令牌，拒绝没有适当令牌的表单。
*   示例令牌：使用服务器密钥加密的会话标识符。
*   Rails 会自动生成这样的令牌：查看每个表单中的authenticity_token 输入字段。

* * *

## 回答 #4

> 赞同：54
> 
> 时间：2017-04-14T04:33:11.560

真实性令牌用于防止跨站点请求伪造攻击 (CSRF)。要了解真实性令牌，首先要了解 CSRF 攻击。

# CSRF

假设您是`bank.com`. 您的网站上有一个表单，用于通过 GET 请求将资金转移到不同的帐户：

[![在此处输入图像描述](https://i.stack.imgur.com/QV7s3.png)](https://i.stack.imgur.com/QV7s3.png)

黑客可以直接向服务器发送一个 HTTP 请求`GET /transfer?amount=$1000000&account-to=999999`，对吧？

[![在此处输入图像描述](https://i.stack.imgur.com/acVPX.png)](https://i.stack.imgur.com/acVPX.png)

错误的。黑客攻击是行不通的。服务器基本上会怎么想？

> 嗯？这家伙是谁试图发起转移。这不是帐户的所有者，这是肯定的。

服务器怎么知道这个？因为没有`session_id`cookie 对请求者进行身份验证。

当您使用您的用户名和密码登录时，服务器会`session_id`在您的浏览器上设置一个 cookie。这样，您不必使用您的用户名和密码对每个请求进行身份验证。当您的浏览器发送`session_id`cookie 时，服务器知道：

> 哦，那是约翰·多伊。他在 2.5 分钟前成功登录。他可以走了。

黑客可能会想：

> 唔。一个普通的 HTTP 请求是行不通的，但如果我能拿到那个`session_id`cookie，我会很高兴的。

`bank.com`用户浏览器为域设置了一堆 cookie 。每次用户向`bank.com`域发出请求时，都会发送所有 cookie。包括`session_id`饼干。

因此，如果黑客可以让*您*发出 GET 请求，将资金转入他的帐户，他就会成功。他怎么能骗你这么做？使用跨站点请求伪造。

实际上，这很简单。黑客可以让你访问他的网站。在他的网站上，他可能有以下图片标签：

```
<img src="http://bank.com/transfer?amount=$1000000&account-to=999999"> 
```

当用户浏览器遇到该图像标签时，它将向该 url 发出 GET 请求。而且由于请求来自他的浏览器，它会连同它一起发送与`bank.com`. 如果用户最近登录`bank.com`... `session_id`cookie 将被设置，服务器会认为用户打算将 1,000,000 美元转移到帐户 999999！

[![在此处输入图像描述](https://i.stack.imgur.com/UGrgL.png)](https://i.stack.imgur.com/UGrgL.png)

> 好吧，只是不要访问危险的网站，你会没事的。

这还不够。如果有人将该图像发布到 Facebook 并出现在您的墙上怎么办？如果它被注入到您正在访问的站点中，会受到 XSS 攻击怎么办？

> 也不是那么坏。只有 GET 请求易受攻击。

不对。可以动态生成发送 POST 请求的表单。这是[Rails 安全指南中](http://guides.rubyonrails.org/security.html#cross-site-request-forgery-csrf)的示例：

```
<a href="http://www.harmless.com/" onclick="
  var f = document.createElement('form');
  f.style.display = 'none';
  this.parentNode.appendChild(f);
  f.method = 'POST';
  f.action = 'http://www.example.com/account/destroy';
  f.submit();
  return false;">To the harmless survey</a> 
```

# 真实性令牌

当你`ApplicationController`有这个：

```
protect_from_forgery with: :exception 
```

这：

```
<%= form_tag do %>
  Form contents
<% end %> 
```

编译成这样：

```
<form accept-charset="UTF-8" action="/" method="post">
  <input name="utf8" type="hidden" value="&#x2713;" />
  <input name="authenticity_token" type="hidden" value="J7CBxfHalt49OSHp27hblqK20c9PgwJ108nDHX/8Cts=" />
  Form contents
</form> 
```

具体来说，会生成以下内容：

```
<input name="authenticity_token" type="hidden" value="J7CBxfHalt49OSHp27hblqK20c9PgwJ108nDHX/8Cts=" /> 
```

为了防止 CSRF 攻击，如果 Rails 没有看到随请求一起发送的真实性令牌，它不会认为请求是安全的。

攻击者应该如何知道这个令牌是什么？每次生成表单时都会随机生成一个不同的值：

[![在此处输入图像描述](https://i.stack.imgur.com/4AJHB.gif)](https://i.stack.imgur.com/4AJHB.gif)

跨站点脚本 (XSS) 攻击 - 就是这样。但对于不同的日子，这是一个不同的漏洞。

* * *

## 回答 #5

> 赞同：47
> 
> 时间：2014-11-12T20:30:50.740

**可以防止的最小攻击示例：CSRF**

在我的网站上`evil.com`，我说服您提交以下表格：

```
<form action="http://bank.com/transfer" method="post">
  <p><input type="hidden" name="to"      value="ciro"></p>
  <p><input type="hidden" name="ammount" value="100"></p>
  <p><button type="submit">CLICK TO GET PRIZE!!!</button></p>
</form> 
```

如果您通过会话 cookie 登录您的银行，那么 cookie 将被发送，并且会在您不知情的情况下进行转账。

那就是 CSRF 令牌发挥作用：

*   使用返回表单的 GET 响应，Rails 发送一个很长的随机隐藏参数
*   当浏览器发出 POST 请求时，它会将参数一起发送，只有匹配时服务器才会接受

因此，真实浏览器上的表单如下所示：

```
<form action="http://bank.com/transfer" method="post">
  <p><input type="hidden" name="authenticity_token" value="j/DcoJ2VZvr7vdf8CHKsvjdlDbmiizaOb5B8DMALg6s=" ></p>
  <p><input type="hidden" name="to"                 value="ciro"></p>
  <p><input type="hidden" name="ammount"            value="100"></p>
  <p><button type="submit">Send 100$ to Ciro.</button></p>
</form> 
```

因此，我的攻击将失败，因为它没有发送`authenticity_token`参数，而且我无法猜到它，因为它是一个巨大的随机数。

这种预防技术称为**同步器令牌模式**。

**同源政策**

但是，如果攻击者使用 JavaScript 发出两个请求，一个读取令牌，第二个进行传输怎么办？

单独的同步器令牌模式不足以防止这种情况！

正如我在以下位置解释的那样，这就是同源策略的用武之地：[https ://security.stackexchange.com/questions/8264/why-is-the-same-origin-policy-so-important/72569# 72569](https://security.stackexchange.com/questions/8264/why-is-the-same-origin-policy-so-important/72569#72569)

**Rails 如何发送令牌**

涵盖于：[Rails：csrf_meta_tag 如何工作？](https://stackoverflow.com/questions/9996665/rails-how-does-csrf-meta-tag-work)

基本上：

*   `form_tag`如果不是 GET 表单，HTML 助手会为您添加一个隐藏字段到表单中

*   AJAX 由[jquery-ujs](https://github.com/rails/jquery-ujs)`meta`自动处理，它从添加到您的标头的元素中读取令牌`csrf_meta_tags`（存在于默认模板中），并将其添加到任何请求中。

    uJS 还尝试在过期的缓存片段中更新表单中的令牌。

**其他预防方法**

*   检查是否存在某些标题，例如`X-Requested-With`：
    *   [X-Requested-With 标头有什么意义？](https://stackoverflow.com/questions/17478731/whats-the-point-of-the-x-requested-with-header)
    *   [https://security.stackexchange.com/questions/23371/csrf-protection-with-custom-headers-and-without-validating-token](https://security.stackexchange.com/questions/23371/csrf-protection-with-custom-headers-and-without-validating-token)
    *   [X-Requested-With 标头服务器检查是否足以防止 ajax 驱动的应用程序的 CSRF？](https://stackoverflow.com/questions/3315914/is-an-x-requested-with-header-server-check-sufficient-to-protect-against-a-csrf)
*   检查`Origin`标头的值：[https ://security.stackexchange.com/questions/91165/why-is-the-synchronizer-token-pattern-preferred-over-the-origin-header-check-to](https://security.stackexchange.com/questions/91165/why-is-the-synchronizer-token-pattern-preferred-over-the-origin-header-check-to)
*   重新认证：再次询问用户密码。对于每个关键操作（银行登录和汇款、大多数网站中的密码更改）都应该这样做，以防您的网站被 XSSed。缺点是用户必须多次输入密码，这很烦人，并且增加了键盘记录/肩冲浪的机会。

* * *

## 回答 #6

> 赞同：38
> 
> 时间：2009-06-02T20:17:18.380

[防止](http://en.wikipedia.org/wiki/Cross-site_request_forgery#Prevention)[“跨站点请求伪造（CSRF 或 XSRF）攻击”](http://en.wikipedia.org/wiki/Cross-site_request_forgery#Example_and_characteristics)的`Authenticity Token`is rails 方法。

简而言之，它确保对您的 Web 应用程序的 PUT / POST / DELETE（可以修改内容的方法）请求来自客户端的浏览器，而不是来自有权访问创建的 cookie 的第三方（攻击者）在客户端。

* * *

## 回答 #7

> 赞同：34
> 
> 时间：2012-08-01T05:12:06.010

因为`Authenticity Token`是如此重要，在 Rails 3.0+ 中你可以使用

```
 <%= token_tag nil %> 
```

创造

```
<input name="authenticity_token" type="hidden" value="token_value"> 
```

任何地方

* * *

## 回答 #8

> 赞同：27
> 
> 时间：2011-08-30T23:52:45.210

请注意，如果您有来自同一客户端的多个并发请求，则 Authenticity Token 机制可能会导致竞争条件。在这种情况下，您的服务器可以在应该只有一个的情况下生成多个真实性令牌，并且在表单中接收较早令牌的客户端将在下一次请求时失败，因为会话 cookie 令牌已被覆盖。有一篇关于这个问题的文章和一个不完全微不足道的解决方案：http: [//www.paulbutcher.com/2007/05/race-conditions-in-rails-sessions-and-how-to-fix-them/](http://www.paulbutcher.com/2007/05/race-conditions-in-rails-sessions-and-how-to-fix-them/)

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2014-02-26T11:13:01.493

**方法`authenticity_token`需要的地方**

> `authenticity_token`在发布、放置和删除等幂等方法的情况下需要，因为幂等方法会影响数据。

**为什么需要它**

> 必须防止作恶。authentity_token 存储在会话中，每当在网页上创建用于创建或更新资源的表单时，就会将真实性令牌存储在隐藏字段中，并与服务器上的表单一起发送。在执行操作之前，用户发送的authentity_token 会与`authenticity_token`存储在会话中的进行交叉检查。如果`authenticity_token`相同，则继续处理，否则不执行操作。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2016-07-22T02:02:17.217

**什么是 authentication_token ？**

这是 rails 应用程序使用的随机字符串，用于确保用户从应用程序页面请求或执行操作，而不是从其他应用程序或站点。

**为什么需要 authentication_token ？**

保护您的应用程序或站点免受跨站点请求伪造。

**如何将 authentication_token 添加到表单中？**

如果您使用 form_for 标记生成表单，则会自动添加 authentication_token ，否则您可以使用`<%= csrf_meta_tag %>`.

# iphone - 在 UITableViewCell 图像上设置 UIImage 尺寸

> ID：941604
> 
> 赞同：7
> 
> 时间：2009-06-02T20:04:17.470
> 
> 标签：iphone, objective-c, cocoa-touch, uikit, favicon

我有一个标准`UITableViewCell`，我使用文本和图像属性来显示一个`favicon.ico`和一个标签。在大多数情况下，这非常有效，因为`UIImage`它支持 ICO 格式。然而，一些网站（比如[Amazon.com](http://www.amazon.com/favicon.ico)）有`favicon.ico`s，它们利用 ICO 格式在同一个文件中存储多种尺寸的能力。亚马逊存储四种不同的尺寸，一直到 48x48。

这导致大多数图像都是 16x16，除了少数 32x32 或 48x48 的图像，这会使一切看起来很糟糕。我在这里、官方论坛、文档和其他地方都搜索过，但没有成功。我已经尝试了所有我能想到的限制图像大小的方法。唯一有效的是一种未记录的方法，我不打算使用它。这是我的第一个应用程序，也是我第一次使用 Cocoa（来自 C#）。

如果我不清楚我在寻找什么，理想情况下，建议将围绕设置尺寸为中心，`UIImage`以便 48x48 版本缩小到 16x16 或告诉`UIImage`使用 ICO 中存在的 16x16 版本的方法文件。我不一定需要代码：只需提出一种方法的建议就可以了。

有没有人有什么建议？（我也在官方论坛上问过，[因为](https://devforums.apple.com/message/75874#75874)我已经沉迷了一天多。如果在那里发布了解决方案，我也会把它放在这里。）

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-06-02T21:15:42.350

以下是用户“bcd”在官方论坛上[发布](https://devforums.apple.com/message/75921#75921)的内容，最终解决了问题（我自己稍作修改，使其成为静态以包含在一组实用程序方法中）：

```
+ (UIImage *)scale:(UIImage *)image toSize:(CGSize)size
{
    UIGraphicsBeginImageContext(size);
    [image drawInRect:CGRectMake(0, 0, size.width, size.height)];
    UIImage *scaledImage = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();
    return scaledImage;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-02T20:55:40.643

我在我的应用程序中做类似的事情。

```
 UIImage* resizedImage(UIImage *inImage, CGRect thumbRect)
{
    CGImageRef          imageRef = [inImage CGImage];
    CGImageAlphaInfo    alphaInfo = CGImageGetAlphaInfo(imageRef);

    if (alphaInfo == kCGImageAlphaNone)
        alphaInfo = kCGImageAlphaNoneSkipLast;

    CGContextRef bitmap = CGBitmapContextCreate (NULL, thumbRect.size.width, thumbRect.size.height, 8, thumbRect.size.width*3, 
                                                                                 CGColorSpaceCreateDeviceRGB(), alphaInfo);

    CGContextDrawImage(bitmap, thumbRect, imageRef);

    CGImageRef  ref = CGBitmapContextCreateImage(bitmap);
    UIImage*    result = [UIImage imageWithCGImage:ref];

    CGContextRelease(bitmap);
    CGImageRelease(ref);

    return result;
} 
```

然后创建一个约束比例的新图像。用您从亚马逊获得的 ICO 文件替换“图像”。

```
CGRect sz = CGRectMake(0.0f, 0.0f, 16, 16);
UIImage *resized = resizedImage(image, sz); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-03-21T05:49:01.837

还没有足够的业力来评论答案，但我在上面的 bbrandons 代码上取得了很好的成功。

尽管关于每行字节数设置不够高，但我确实在控制台上收到了相当数量的警告 - 在阅读了这篇[文章的](https://stackoverflow.com/questions/2235210/image-resized-error-cgbitmapcontextcreate-unsupported-parameter/2235465#2235465)答案后，我最终将其设置为 0，这让系统可以确定正确的值。

例如：

```
CGContextRef bitmap = CGBitmapContextCreate(NULL, size.width, size.height, 8, 0, CGColorSpaceCreateDeviceRGB(), alphaInfo); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-04-21T06:17:13.380

我是这样做的。此技术负责将文本和详细信息文本标签适当地向左移动：

```
@interface SizableImageCell : UITableViewCell {}
@end
@implementation SizableImageCell
- (void)layoutSubviews {
    [super layoutSubviews];

    float desiredWidth = 80;
    float w=self.imageView.frame.size.width;
    if (w>desiredWidth) {
        float widthSub = w - desiredWidth;
        self.imageView.frame = CGRectMake(self.imageView.frame.origin.x,self.imageView.frame.origin.y,desiredWidth,self.imageView.frame.size.height);
        self.textLabel.frame = CGRectMake(self.textLabel.frame.origin.x-widthSub,self.textLabel.frame.origin.y,self.textLabel.frame.size.width+widthSub,self.textLabel.frame.size.height);
        self.detailTextLabel.frame = CGRectMake(self.detailTextLabel.frame.origin.x-widthSub,self.detailTextLabel.frame.origin.y,self.detailTextLabel.frame.size.width+widthSub,self.detailTextLabel.frame.size.height);
        self.imageView.contentMode = UIViewContentModeScaleAspectFit;
    }
}
@end

...

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    static NSString *CellIdentifier = @"Cell";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[[SizableImageCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:CellIdentifier] autorelease];
        cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;
    }

    cell.textLabel.text = ...
    cell.detailTextLabel.text = ...
    cell.imageView.image = ...
    return cell;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T20:43:20.510

我对 ico 文件的工作原理一无所知，所以也许可以轻松地提取 16x16 图像并使用它，但我不知道如何。

据我所知，不可能在通用的图像上设置任何有用的属性`UITableViewCell`。将所有内容缩小到 16x16 的最简单方法（仍然很混乱，尤其是如果您是新手）是 subclass `UITableViewCell`，给它一个`UIImageView`，始终将图像视图大小设置为 16x16，并将其 contentMode 设置为`UIViewContentModeAspectFit`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-27T18:28:26.773

我修改了其他人的类别，以使所有图像占据相同的宽度（可见宽度），不缩放：

```
-(UIImage*) centerImage:(UIImage *)inImage inRect:(CGRect) thumbRect
{

    CGSize size= thumbRect.size;
    UIGraphicsBeginImageContext(size);  
    //calculation
    [inImage drawInRect:CGRectMake((size.width-inImage.size.width)/2, (size.height-inImage.size.height)/2, inImage.size.width, inImage.size.height)];
    UIImage *newThumbnail = UIGraphicsGetImageFromCurrentImageContext();        
    // pop the context
    UIGraphicsEndImageContext();
    return newThumbnail;
} 
```

# .net - 自定义服务器控制导致 UpdatePanel 内的完整回发

> ID：941606
> 
> 赞同：6
> 
> 时间：2009-06-02T20:04:34.707
> 
> 标签：.net, asynchronous, updatepanel, postback, custom-server-controls

我有一个自定义服务器控件，它似乎可以正常工作，直到我将它放入 UpdatePanel 中。一旦进入 UpdatePanel，它会继续正常工作，但当我的自定义服务器控件执行回发时，UpdatePanel 现在会执行完整回发。

我是否需要做任何事情来让我的自定义服务器控件在 UpdatePanel 中执行异步回发？

这是导致完整回发的相关代码。ecs:Pager 控件是我的自定义控件，即使它在 UpdatePanel 中也会导致 OnCommand 事件的完整回发。

```
<asp:UpdatePanel ID="ClosedIssuesUpdatePanel" runat="server">
    <ContentTemplate>
        <ecs:Pager ID="ClosedIssuesPager" OnCommand="ClosedIssuesPager_Command" runat="server" />
        <asp:Repeater ID="ClosedIssuesRepeater" runat="server">
        ....
        </asp:Repeater>
    </ContentTemplate>
</asp:UpdatePanel> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-09-02T04:21:24.877

您没有指定自定义控件中使用的控件类型。它们是按钮还是下拉菜单或其他东西？如果它们是按钮，则需要确保它们的 UseSubmitBehavior 属性设置为 False。

此外，您还需要通过[ScriptManager.RegisterAsyncPostBackControl向页面的 ScriptManager 注册您的控件](http://msdn.microsoft.com/en-us/library/system.web.ui.scriptmanager.registerasyncpostbackcontrol.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-23T21:46:07.360

将更新面板的更新模式设置为有条件的。

```
<asp:UpdatePanel ID="ClosedIssuesUpdatePanel" runat="server" UpdateMode="Conditional">
    <ContentTemplate>
        <ecs:Pager ID="ClosedIssuesPager" OnCommand="ClosedIssuesPager_Command" runat="server" />
        <asp:Repeater ID="ClosedIssuesRepeater" runat="server">
        ....
        </asp:Repeater>
    </ContentTemplate>
</asp:UpdatePanel> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-12-08T13:54:43.810

我遇到了类似的问题，发现将属性 ClientIDMode="AutoID" 添加到我的用户控件标签可以解决问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-15T03:42:38.907

自定义控件是否实现 INamingContainer，回发是否来自该命名容器内的另一个控件？

我发现 UpdatePanel 和源代码管理之间的命名容器边界会导致这种行为。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T20:06:28.450

抱歉...看不到页面的其余部分。

您的页面上也有 ScriptManager 吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-08-18T20:20:19.383

一种选择可能是 AndreasKnudsen 建议将 AsyncPostBackTrigger 添加到您的面板

```
<asp:UpdatePanel ID="ClosedIssuesUpdatePanel" runat="server">
  <ContentTemplate>
    <ecs:Pager ID="ClosedIssuesPager" OnCommand="ClosedIssuesPager_Command" runat="server" />
    <asp:Repeater ID="ClosedIssuesRepeater" runat="server">
      ....
    </asp:Repeater>
  </ContentTemplate>
  <Triggers>
    <AsyncPostBackTrigger ControlID="ClosedIssuesPager" EventName="Command" />
  </Triggers>
</asp:UpdatePanel> 
```

另一种选择是尝试将 ChildrenAsTriggers 添加到您的 UpdatePanel 标记中

```
<asp:UpdatePanel ID="ClosedIssuesUpdatePanel" runat="server" ChildrenAsTriggers="true"> 
```

# resharper - 在 Visual Studio 之外运行 Resharper 代码分析

> ID：941608
> 
> 赞同：8
> 
> 时间：2009-06-02T20:04:59.060
> 
> 标签：resharper, teamcity

Resharper 包括各种分析规则，可以从 Visual Studio 内部在您的解决方案上运行，但是否可以从命令行或作为自动构建的一部分运行这些规则？Resharper 似乎专注于在 Visual Studio 中运行，但可以从 IDE 外部对解决方案或项目文件调用它吗？

更新：似乎 TeamCity 7.0 EAP 包含一种在构建时执行代码分析的方法 [（博客文章）](http://blogs.jetbrains.com/teamcity/2011/10/13/now-we-see-dead-code-too/)，因此至少它可以以某种方式被调用并作为 CI 流程的一部分使用。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-03T01:01:03.503

不，ReSharper 目前不提供此功能。JetBrains 网站上有一个与此问题相关的主题，可以在[此处](http://jetbrains.net/devnet/thread/265285?tstart=0)找到。

这是一个报价：

> 目前 ReSharper 没有在独立批处理应用程序中运行的接口。但是，可以使用 ReSharper OpenAPI 编写这样的应用程序来提供您正在寻找的功能。

所以显然你*可以*使用 ReSharper OpenAPI 来创建你想要的功能；不幸的是，我没有任何使用它的经验，所以我没有太多帮助。

一些感兴趣的链接...

[ReSharper OpenAPI 开发者社区](http://www.jetbrains.net/devnet/community/resharper/resharper_open_api)
[ReSharper 公共 API 和示例源代码（又名 ReSharper PowerToys）](http://www.jetbrains.net/confluence/display/ReSharper/ReSharper+Plugin+Development)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-02T20:09:34.450

我认为您想要[fxCop](http://www.microsoft.com/downloads/details.aspx?FamilyID=9aeaa970-f281-4fb0-aba1-d59d7ed09772&displaylang=en)提供的功能。我不知道 Resharper 在 Visual Studio 之外运行。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-28T10:39:00.167

好像在听啊！第一个版本现在提供 30 天演示：http: [//blogs.jetbrains.com/dotnet/2013/03/resharper-code-analysis-goes-beyond-visual-studio/](http://blogs.jetbrains.com/dotnet/2013/03/resharper-code-analysis-goes-beyond-visual-studio/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-12T09:52:21.497

如果您正在寻找代码是否符合标准，请查看[StyleCop](http://code.msdn.microsoft.com/sourceanalysis)。您可以将其绑定到 msbuild 并在 IDE 之外运行规则。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T20:12:47.547

不，它不能从命令行运行。我仍然希望他们添加此功能，因为我去年 10 月提出了要求 :)

# visual-studio-2005 - 在哪里可以找到 Visual Studio 宏示例？

> ID：941619
> 
> 赞同：4
> 
> 时间：2009-06-02T20:06:32.100
> 
> 标签：visual-studio-2005, macros

当我查找有关 Visual Studio 2005 宏的任何内容时，每个人都在引用它附带的示例。但是，为我（IT 部门）安装了 Visual Studio，但我没有这些示例宏。

还有其他地方可以找到（或下载）它们吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T20:22:15.420

请注意，您也可以使用宏记录器 (Ctrl+Shift+R) 创建自己的。录制一些动作后，停止录制（再次按 ctrl+shift+R），您可以使用宏 IDE（工具 | 宏 | 宏 IDE）查看宏源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T20:17:55.273

在 VC 6 中，它们曾经在我记得的普通文件中，但我不确定它们在 VS2005 和 VS2008 中的保存位置。我无法想象有一个安装选项*不*包括它们。

您是否查看了宏 IDE 或宏资源管理器？

[http://msdn.microsoft.com/en-us/library/s2shw615(VS.80).aspx](http://msdn.microsoft.com/en-us/library/s2shw615(VS.80).aspx)

> Macros IDE 包含一些示例宏供您学习和使用。它们位于名为 Samples 的节点中，可在 Macro Explorer 或 Macros IDE 中使用。以下是宏示例的列表及其作用的描述。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T20:18:17.177

在此处尝试示例和教程

[代码项目](http://www.codeproject.com/KB/macros/)

[行计数器加载项](http://www.codeproject.com/KB/macros/LineCounterAddin.aspx)

# visual-studio - VWD 2008 添加对公共类的引用

> ID：941623
> 
> 赞同：0
> 
> 时间：2009-06-02T20:07:36.793
> 
> 标签：visual-studio, visual-studio-2008, class, reference, visual-web-developer

从 VWD2005 升级到 VWD2008 后出现问题。在 VWD2008 中，App_Code 不再存在。

如何添加对 VWD2005 的 App_Code 目录中存在的类的引用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T13:46:12.613

这里出现了 Global 应用程序类，也称为 Global.asax

我所要做的就是将它添加到我的项目中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T12:14:13.250

VWD2008 支持 Web 应用程序以及网站。

Web 应用程序没有 app_code 文件夹。

检查您的项目类型，您可能有一个 Web 应用程序而不是一个网站。您可以将其重新创建为一个网站，或者只是添加一个名为 code 的文件夹或其他任何内容。

**编辑：**在网站中只有一个默认命名空间，并且 app_code 文件夹中的任何代码都可以在任何地方访问。在 Web 应用程序中，文件夹中的代码具有不同的命名空间，因此必须通过其命名空间或在文件顶部添加 using 来引用。

# lua - swig 包装变量的基本分配失败

> ID：941626
> 
> 赞同：2
> 
> 时间：2009-06-02T20:08:19.303
> 
> 标签：lua, variable-assignment, swig

我使用 swig 创建了一个包含大量包装 C++ 类的 lua 模块。包装器的生成和编译（使用 -Wall）没有任何问题。但是，在我发现的几个地方，我遇到了以下问题：成员数据的基本分配失败。

如果我运行：

```
Lua 5.1.4  Copyright (C) 1994-2008 Lua.org, PUC-Rio
> require('myModule')
> a = myModule.ClassA() 
```

然后我可以验证附加到“a”的元表是否包含其所有成员数据（在本例中，字段“b”和“c”分别属于类类型 ClassB 和 ClassC。）

我可以进一步做：

```
> a.b = myModule.ClassB() 
```

它成功地将 b 重新分配给 ClassB() 的新实例。但是，当我去做时：

```
> a.b.c = myModule.ClassC() 
```

我收到错误消息：

```
Error in ClassB_c_set (arg 2), expected 'ClassC *' got 'ClassB *' 
```

好像“=”右侧的表达式是与包含要重新分配的数据字段的元素具有相同类型的对象。我确定我一定错过了一些简单的东西，但是我已经把头撞在墙上几个小时了，但无济于事。

有人有什么想法吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T15:04:38.367

事实证明，这是 SWIG 中的一个错误。我已经提交[了一份错误报告，解释了问题的原因](https://sourceforge.net/tracker/?func=detail&atid=101645&aid=2800537&group_id=1645)。

这个问题实际上是由于嵌套命名空间问题以及我对 SWIG 如何工作的误解造成的。我曾假设我通过接口文件中的 %include 引入的每个项目都将按照 gcc 处理 #includes 的方式进行处理。但是，在 SWIG 文件中，必须按照其内容被引用的顺序 %include 。

有关说明，请参阅链接的错误报告。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-02-29T09:31:26.797

使用 SWIG进行***作业***时始终要非常小心！请注意，***operator=()***函数仅用于本机类型。每当您分配自己的对象时，只会复制地址。

阅读这篇文章的更多信息：[SWIG C++ 到 Python：警告（362）：运算符 = 被忽略](https://stackoverflow.com/questions/8102244/swig-c-to-python-warning362-operator-ignored)

# java - 非标准 HTTP 端口源的 URLConnection FileNotFoundException

> ID：941628
> 
> 赞同：23
> 
> 时间：2009-06-02T20:08:45.557
> 
> 标签：java, ant, urlconnection

我试图使用 Apache Ant[`Get`任务](http://ant.apache.org/manual/Tasks/get.html)来获取由我们公司的另一个团队生成的 WSDL 列表。他们将它们托管在[http://....com:7925/services/](http://....com:7925/services/)上的 weblogic 9.x 服务器上。我可以通过浏览器访问该页面，但是当尝试将页面复制到本地文件进行解析时，get 任务给了我一个 FileNotFoundException。我仍然能够（使用 ant 任务）获得一个没有用于 HTTP 的非标准端口 80 的 URL。

我查看了 Ant 源代码，并将错误缩小到 URLConnection。似乎 URLConnection 无法识别数据是 HTTP 流量，因为它不在标准端口上，即使协议被指定为 HTTP。我使用 WireShark 嗅探了流量，页面通过网络正确加载，但仍然收到 FileNotFoundException。

这是一个您将看到错误的示例（更改了 URL 以保护无辜者）。**在connection.getInputStream()**上抛出错误；

 **```
import java.io.File;
import java.io.InputStream;
import java.net.URL;
import java.net.URLConnection;

    public class TestGet {
    private static URL source; 
    public static void main(String[] args) {
        doGet();
    }
    public static void doGet() {
            try {
            source = new URL("http", "test.com", 7925,
                    "/services/index.html");
            URLConnection connection = source.openConnection();
            connection.connect();
            InputStream is = connection.getInputStream();
        } catch (Exception e) {
            System.err.println(e.toString());
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2010-11-09T18:07:37.080

对我的 HTTP 请求的响应返回了状态码 404，当我调用 getInputStream() 时，这导致了 FileNotFoundException。我仍然想阅读响应正文，所以我不得不使用不同的方法：**HttpURLConnection#getErrorStream()**。

这是 getErrorStream() 的 JavaDoc 片段：

> 如果连接失败但服务器仍然发送了有用的数据，则返回错误流。典型的例子是当 HTTP 服务器响应 404 时，这将导致在连接中抛出 FileNotFoundException，但服务器发送了一个 HTML 帮助页面，其中包含有关如何操作的建议。

使用示例：

```
public static String httpGet(String url) {
    HttpURLConnection con = null;
    InputStream is = null;
    try {
        con = (HttpURLConnection) new URL(url).openConnection();
        con.connect();

        //4xx: client error, 5xx: server error. See: http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html.
        boolean isError = con.getResponseCode() >= 400;
        //In HTTP error cases, HttpURLConnection only gives you the input stream via #getErrorStream().
        is = isError ? con.getErrorStream() : con.getInputStream();

        String contentEncoding = con.getContentEncoding() != null ? con.getContentEncoding() : "UTF-8";
        return IOUtils.toString(is, contentEncoding); //Apache Commons IO
    } catch (Exception e) {
        throw new IllegalStateException(e);
    } finally {
        //Note: Closing the InputStream manually may be unnecessary, depending on the implementation of HttpURLConnection#disconnect(). Sun/Oracle's implementation does close it for you in said method.
        if (is != null) {
            try {
                is.close();
            } catch (IOException e) {
                throw new IllegalStateException(e);
            }
        }
        if (con != null) {
            con.disconnect();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2010-02-16T16:42:42.757

这是一个旧线程，但我遇到了类似的问题，并找到了此处未列出的解决方案。

我在浏览器中正常接收页面，但是当我尝试通过 HttpURLConnection 访问它时得到 404。我试图访问的 URL 包含一个端口号。当我在没有端口号的情况下尝试它时，我通过 HttpURLConnection 成功获得了一个虚拟页面。所以似乎非标准端口是问题所在。

我开始认为访问受到限制，在某种意义上确实如此。我的解决方案是我需要告诉服务器用户代理，并且我还指定了我期望的文件类型。我正在尝试读取 .json 文件，所以我认为文件类型也可能是必要的规范。

我添加了这些行，它终于奏效了：

```
httpConnection.setRequestProperty("User-Agent","Mozilla/5.0 ( compatible ) ");
httpConnection.setRequestProperty("Accept","*/*"); 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-06-03T03:19:51.100

检查服务器返回的响应代码

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-10T12:17:41.140

我知道这是一个旧线程，但我找到了一个未在此处列出的解决方案。

我试图从端口 8080 上的 J2EE servlet 中提取 json 格式的数据，但收到未找到文件的错误。我能够从端口 80 上运行的 php 服务器中提取相同的 json 数据。

事实证明，在 servlet 中，我需要将 doGet 更改为 doPost。

希望这可以帮助某人。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-07-20T15:20:15.857

你可以使用[OkHttp](https://square.github.io/okhttp/)：

> ```
> OkHttpClient client = new OkHttpClient();
> 
> String run(String url) throws IOException {
>   Request request = new Request.Builder()
>       .url(url)
>       .build();
> 
>   Response response = client.newCall(request).execute();
>   return response.body().string();
> } 
> ```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T01:58:24.463

`FileNotFoundException`我已经在本地尝试过 - 使用提供的代码 -除非服务器返回状态 404 响应，否则我没有得到。

您确定要连接到要连接的网络服务器吗？您是否有机会连接到不同的网络服务器？（我注意到代码中的端口号与链接中的端口号不匹配）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-10-10T08:42:52.370

我知道这是一个旧线程，但只是注意到这个线程上的一些东西，所以我想我会把它放在那里。

就像杰西卡提到的那样，使用非标准端口时会引发此异常。

它似乎只在使用 DNS 时发生。如果我使用 IP 号，我可以指定端口号，一切正常。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-11-30T00:03:37.283

我遇到了类似的问题，但原因似乎不同，这是异常跟踪：

```
java.io.FileNotFoundException: http://myhost1:8081/test/api?wait=1
    at sun.reflect.GeneratedConstructorAccessor2.newInstance(Unknown Source)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)
    at java.lang.reflect.Constructor.newInstance(Constructor.java:513)
    at sun.net.www.protocol.http.HttpURLConnection$6.run(HttpURLConnection.java:1491)
    at java.security.AccessController.doPrivileged(Native Method)
    at sun.net.www.protocol.http.HttpURLConnection.getChainedException(HttpURLConnection.java:1485)
    at sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1139)
    at com.doitnext.loadmonger.HttpExecution.getBody(HttpExecution.java:85)
    at com.doitnext.loadmonger.HttpExecution.execute(HttpExecution.java:214)
    at com.doitnext.loadmonger.ClientWorker.run(ClientWorker.java:126)
    at java.lang.Thread.run(Thread.java:680)
Caused by: java.io.FileNotFoundException: http://myhost1:8081/test/api?wait=1
    at sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1434)
    at java.net.HttpURLConnection.getResponseCode(HttpURLConnection.java:379)
    at com.doitnext.loadmonger.HttpExecution.execute(HttpExecution.java:166)
    ... 2 more 
```

所以看起来只是获取响应代码会导致 URL 连接调用 GetInputStream。

# c# - C# Web 服务 - 为什么 http://localhost//testservice（两个斜杠）有效？

> ID：941632
> 
> 赞同：0
> 
> 时间：2009-06-02T20:09:39.923
> 
> 标签：c#, web-services

我正在编写一个测试网络服务，并注意到一个奇怪的角落案例。如果在端口后包含两个斜杠，则无论如何都会为 localhost、localhost:80、127.0.0.1 和 127.0.0.1:80 调用该方法。但是，如果我在我正在开发的 Web 服务器（端口 55731）上尝试它，它会失败。

```
localhost.Service1 s = new localhost.Service1();
string uri = "http://localhost//testService.asmx";
s.Url = uri;
double result = s.multiply(5,5); 
```

以下是具体案例：

```
uri = "http://localhost//testService.asmx"; // works
uri = "http://localhost:80//testService.asmx"; // works
uri = "http://127.0.0.1//testService.asmx"; // works
uri = "http://127.0.0.1:80//testService.asmx"; // works
uri = "http://localhost:55731//testService.asmx"; // fails - HTTP status 400 - bad request 
```

知道为什么会这样吗？我知道我应该在端口后只加一个斜线，只是好奇。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T20:24:32.140

它是特定于 Web 服务器的实现细节。一台服务器可能将斜杠合并为一个斜杠，另一台服务器可能会查找名称为空字符串的目录，或者对其进行模式检查。

我假设您在端口 80 上的网络服务器与 55731 上的网络服务器不同，IIS 与开发服务器有很多不同。

# .net - Exchange 服务器 - 全球访问

> ID：941633
> 
> 赞同：0
> 
> 时间：2009-06-02T20:09:47.240
> 
> 标签：.net, outlook, exchange-server, global

我正在尝试创建一个可以与全球 Exchange 服务器交互的基于 Web 的应用程序。意思是，我需要它能够查看、更改、删​​除和创建跨域的所有电子邮件、日历、约会、任务、笔记等。我正在使用.Net，并且一直在研究接收器，但不确定这是否是最好的选择。接收器会给我我需要的全部功能（它似乎只适用于电子邮件，尽管我还没有完全开始编码它，因为我正在等待服务器到达）？或者有没有人有更好的建议/想法？提前致谢！

*   安德鲁·惠廷顿

让我再详细一点，我想我给人的印象是错误的。这些解决方案允许客户通过网络邮件访问他们的电子邮件、日历等。

我需要网络应用程序能够访问每个人的电子邮件、日历等……而不是每个客户都可以访问他们自己的。最终解决方案将提供一种方法来跟踪公司内的团队。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T20:21:51.147

我认为exchange 已经有一个webmail 界面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T20:44:43.910

Exchange 已经有一个称为 Outlook Web Access 的网络邮件界面。

另一种选择是使用位于 .net 框架内 System.Web.Mail 命名空间中的简单 SMTP。

[System.Web.Mail 命名空间](http://msdn.microsoft.com/en-us/library/system.web.mail.aspx)

如果您正在使用特定的 API，那么希望您使用的是 Exchange 2007，如果您正在查看

[Microsoft 的 MSDN 站点上的 Exchange 开发](http://msdn.microsoft.com/en-us/exchange/default.aspx)

也看看这本书，它可能有一些非常有用的信息

[交换网络服务](http://www.amazon.ca/Inside-Microsoft-Exchange-Server-Services/dp/0735623929/ref=sr_1_1?ie=UTF8&s=books&qid=1244068432&sr=8-1)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-11T13:35:24.200

经过一番研发，托管接收器可以位于交换服务器上，并在指定文件夹中发生保存操作时触发。如果要将接收器注册到每个客户端的文件夹，它可以提供一种方法来收集所有数据，并在需要时进行更改/添加（例如，检测电子邮件和触发要创建的约会）。希望有类似问题的其他人可以从中受益！

干杯

# javascript - 如何构建一个网页文件浏览器？

> ID：941638
> 
> 赞同：2
> 
> 时间：2009-06-02T20:11:52.603
> 
> 标签：javascript, python, html, web-applications

目标：简单的浏览器应用程序，用于在网络服务器上以树形视图导航文件。

背景：使用 Apache、mod_python、Python 代码构建网站作为学习体验。（还没有 mod_wsgi。）

我应该学习哪些工具来编写浏览器树？我看到了 JavaScript、Ajax，我都不知道。学习它们？从网络上获取一个 JS 示例并返工？这样的东西可以用原始 HTML 构建吗？Python 我是高级初学者，但我意识到那是服务器端。

如果你要从头开始制作这样的玩具，你会用什么？什么是完全简单、俗气的方式、中间方式、完全专业的方式？

请不要使用 Django -- 这是一个学习 Web 编程细节的练习。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-02T20:14:50.380

首先，切换到 mod_wsgi。

其次，使用 mod_wsgi 在 Python 中编写一个 hello world。

第三，更改你的 hello world 以显示`os.listdir()`.

我想你差不多完成了。

当您对此感到困惑时，您会意识到将您拥有的内容（来自 的信息`os.listdir`）转换为 HTML 中的表示是一件令人头疼的事情。

您可以在其中添加[Jinja 模板](http://jinja.pocoo.org/2/)以将内容与演示文稿分开。

最后，您会注意到您已经开始艰难地构建 Django。停止。学习 Django。您会看到它仍然是“编程螺母和螺栓”。它并没有“隐藏”或“抽象”太多 Web 服务器开发经验。它只是使您免于重新发明轮子。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T20:17:50.813

如果你想制作交互式浏览器，你必须学习 JS 和 ajax。

如果您只想构建基于链接的浏览器，python 就足够了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T22:43:50.050

“完全俗气”的方式：

```
python -m SimpleHTTPServer 
```

这将在[http://localhost:8000/的当前目录中提供文件](http://localhost:8000/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T08:18:36.627

将“索引”选项设置为 apache 配置中的目录。

要了解如何在 python 中构建 webapps，请学习 django。

# c# - 数据库中介是好的系统设计吗？

> ID：941640
> 
> 赞同：2
> 
> 时间：2009-06-02T20:11:59.297
> 
> 标签：c#, database

背景：我们有许多完全在内部使用的服务器进程和客户端应用程序，在相当受控的环境中。我们每天都会捕获大量数据，这些数据会进入几台数据库机器。大部分都是 c#，带有一些 c++ 应用程序。

几乎每个应用程序都对数据库数据有一些基本的（如果不是广泛的）依赖，无论是历史数据、每日计算值还是各种参数。随着整个环境变得更加庞大，我一直想知道在所有客户端和服务器应用程序与数据库之间放置一个中介的意义，一种“数据库数据代理”。任何需要来自 db 的值的应用程序都会向数据代理发出请求，而不是调用存储过程的 dll 包装函数。

一个直接的缺点是数据将通过网络进行两次传输：从数据库到代理，以及从代理到调用应用程序。看起来很糟糕，但是每个请求中的数据量都足够小，就性能而言我可以接受。

一个（似乎）优点是设置测试环境很简单，因为它只需要设置一个测试数据代理，并且在其他任何地方都没有在本地维护数据库连接字符串。另外，我一直在考虑创建一种迷你请求语言，这样您就不必为您可能请求的每个数据集枚举函数（而不是 GetX() 和 GetY()，而是 Get("name = X")

我是否过度设计了这个，或者它可能是一个有价值的架构？

编辑：感谢迄今为止所有的精彩评论，值得深思。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T20:23:07.400

这取决于你想用它来完成什么。根据[Rocky Lhotka](http://www.lhotka.net/WeBlog/PermaLink.aspx?guid=efa88d0a-2388-4909-bee1-c9bddb6e9868)的说法，你应该只在被迫的情况下添加一个等级，一路踢和尖叫。

我同意他的观点：除非你需要，否则不要分层。我认为添加额外的层是有正当理由的，通常是出于安全性、可扩展性和可维护性的目的。问题变成了：你的理由是正当的吗？

看起来主要原因是可维护性。它是否超过了*没有*等级所获得的好处？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T20:21:02.820

只有你能回答这些：

*   这样做有什么好处？
*   这样做有什么问题/风险？
*   你需要这个来使测试更容易甚至成为可能吗？
*   如果您进行此更改，并且当它上线并崩溃时，您会被解雇吗？
*   如果您进行更改并上线，您会获得晋升吗？
*   ETC...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T20:48:21.327

作为还大量使用数据库作为“中心”的系统的前架构师，我可以说您应该注意几个缺点。我们的系统使用的数据库：

*   作为事务存储（典型的 OLTP 东西）
*   作为暂存队列（已提交但未处理的事务）
*   作为历史数据存储（处理事务的结果）
*   作为互操作层（从其他系统发出的未翻译的命令或事务）

主要缺点之一是拥有成本。当您的数据库成为如此多类型操作的单点故障时，有必要确保它们都托管在高可用性环境中。这不仅从硬件角度来看很昂贵，而且支持部署到 HA 环境也很昂贵，因为开发人员通常对内部的可见性非常有限。

第二个缺点是您必须认真设计所有表的完整性。在典型的 SOA 环境中，您可以完全控制数据的修改方式。当您通过数据库表公开它时，您必须考虑任何具有正确凭据的应用程序都可以修改数据。因此，您必须仔细考虑约束的实用性实现。如果您有一个管理持久性的服务，您可以对数据库的约束更加宽松，并在代码中强制执行它们。

第三，如果您想将数据库表当前允许您提供给外部各方的任何功能公开，那么无论如何您都必须编写服务代码，这样您可能会更好地从战略上执行此操作，而不是对请求做出反应。

第四，直接与数据层交互的 UI 会带来安全风险，尤其是在客户端是胖客户端的情况下。

最后，编写响应事件（服务调用）的代码比轮询代码容易得多。通常，每次新项目需要新的“监控服务”时，严重依赖数据库轮询的组织最终都会重新发明轮子。可以通过创建“框架”来避免这种情况，但这些都有自己的陷阱（主要是处方与采用）。

这只是我遇到的问题的清单。这并不一定是要劝阻您不要为这些功能使用数据库，但它有助于提前了解危险，以便您至少可以为它们做好计划，如果它们确实成为问题。

**编辑**

刚刚想到另一个让我们痛苦的场景。对更改进行版本控制可能很困难。例如，如果您需要更改表格的形状（规范化/非规范化），如果多个应用程序依赖它，则会产生级联效应。在 SOA 场景中，这要容易得多，因为您可以保留旧 API，更改内部交互以使其与更改的表一起使用，并允许消费者按照自己的计划迁移到新版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T22:22:44.210

“任何需要来自数据库的值的应用程序都会向数据代理发出请求”

当 40 多年前发明数据库技术时，进行这项发明的人的想法是“任何需要来自 db 的值的应用程序都会向 dbms 发出请求”。

你有没有想过你已经有一个“数据经纪人”，并且创建第二个你自己的可能没有什么附加价值？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T20:22:07.653

数据代理听起来是一种为您的应用程序抽象出多个数据源的好方法。如果将来需要，合并、更改存储库或以其他方式移动数据将很容易。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-02T20:23:19.943

我可能会误解某些东西，但在我看来，您应该考虑一些实体框架。这是一个框架，您可以使用它来将您与数据库的交互“映射”到某些域对象。这样，您就可以在本地处理从数据库填充的域对象，并且当需要将对象的状态持久保存到基础时，框架会来回处理所有连接。通过这种方式，您还可以轻松模拟这些域对象以进行单元测试，而无需数据库连接。

查看[NHibernate](https://www.hibernate.org/)以获得良好的实体框架替代方案。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-02T20:31:59.677

如果您已经拥有与数据库相关的专业知识，我认为这不是一个糟糕的决定。

我能想到的好东西：

*   如果数据模型是一致的，您可以轻松插入新工具，而无需对其他应用程序进行任何更改。
*   也许您可以比您的应用程序更可靠地运行数据库，因此如果其中一个发生故障，另一个仍然可以工作。
*   您可以使用数据库工具进行备份和回滚。
*   您可以使用 sql 或一些可视化工具直接操作数据进行紧急修复。

但是，如果您必须在此过程中学习新的框架，那么这些好处可能不值得付出额外的初始努力。

# mysql - 在 OpenOffice 上生成 MySQL 报告

> ID：941641
> 
> 赞同：0
> 
> 时间：2009-06-02T20:12:03.243
> 
> 标签：mysql, openoffice.org

我对此几乎一无所知，所以如果您有经验，请分享！

谢谢！！！

**抱歉，马特：**

*   开放式办公室 3.0
*   MySQL 5.0.75
*   Ubuntu 9.04

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T20:30:32.003

什么版本的 Open office/MySQL 以及什么 Open Office 应用程序？

看起来 Open Office base 附带 JDBC 支持 - [http://wiki.services.openoffice.org/wiki/Connect_MySQL_and_Base](http://wiki.services.openoffice.org/wiki/Connect_MySQL_and_Base)

我假设 writer/calc 等也具有此功能？

# wcf - MsmqIntegrationBinding 带有未知消息正文类型的序列化

> ID：941642
> 
> 赞同：0
> 
> 时间：2009-06-02T20:12:07.860
> 
> 标签：wcf, serialization, msmq

我希望使用 MsmqIntegrationBinding 与具有序列化对象作为消息正文的遗留队列集成。有没有人想出一种方法来获取消息正文的“元数据”并创建一个服务端类以在服务中使用？

例如，如果我从系统 A 中放入一个序列化的 Product 对象并且我的服务需要使用它，如果我身边没有 Product 类，我如何为 MsmqMessage 提供类型？我正在考虑在一个单独的程序中读取一条消息，反序列化，然后通过代码 dom 发出。想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T20:34:10.203

嗯...在 WCF 中，您可以定义采用（并可选择返回）无类型`Message`类型的服务方法。这似乎非常适合您的账单。

除了使用强类型消息之外，您还必须通过读取原始 XML 将所有消息放在客户端上并在服务器上进行拆分 - 但这似乎是您正在寻找的，正确的？

在此处查找更多信息和示例：

*   [WCF - 处理通用消息](http://dotnetslackers.com/WCF/re-78639_WCF_Handling_Generic_Messages.aspx)
*   [如何通过 WCF 传递通用对象](https://stackoverflow.com/questions/861041/how-to-pass-a-generic-object-through-wcf)
*   [WCF 上的非类型化消息](http://geekswithblogs.net/claeyskurt/archive/2008/09/24/125430.aspx)

未键入的消息有一些限制，例如您只能在服务器上阅读一次，但我认为您应该能够使用它来管理您的场景。

马克

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T20:36:33.677

我全心全意地建议*不要*尝试在运行时在消息目标中发出反序列化类型。要么在目的地使用 XML 来获取你想要的数据，要么构建源和目的地都可以遵守的数据契约。

# svn - 无论如何，您使用 svn tags 目录做什么？

> ID：941646
> 
> 赞同：12
> 
> 时间：2009-06-02T20:13:13.240
> 
> 标签：svn, version-control, organization

好的，所以我们都知道标准的 SVN 设置

```
trunk\
branches\
tags\ 
```

而且我意识到建议是标签中应该有“特殊”提交。然而，我从来没有真正使用过标签目录，我不明白我为什么会这样做。

我的理解是 tags\ 将包含诸如“Version1Release\、Version2Release\、ThatTimeWeUpgradedEverthing\”之类的内容。但事情就是这样，如果您要进入并需要对 Version1Release 进行更改，那么它应该是一个分支，如果标签应该是永远不会改变的，那么在源代码控制中制作副本有什么意义呢？请注意，修订版 712 是我们的第 1 版发布。

我想我的困惑是标签似乎是永远不应该改变的版本。但是源代码控制就是保留更改文件的历史记录。我知道这是一个次要的组织论点，但我很好奇人们的想法。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-02T20:20:13.943

> 请注意，修订版 712 是我们的第 1 版发布。

这对团队中的开发人员来说已经足够好了，也许（假设您有一个文档存储可以在其中做这样的笔记），但是要求任何不熟悉存储库的人“只记住”很快就会变得非常不合理。

例如，假设您的存储库可通过 'net. 用户可能会选择签出并为他们喜欢的但晦涩的 *nix 风格构建副本，并希望在您添加他们不喜欢的功能之前获取几个版本的版本。标签使这种事情变得容易。

标签也非常适合作为“触发点”。在我自己的存储库中，提交标签会自动启动（通过 post-commit 挂钩）构建、打包并将其发布到我们的网站的脚本。

最后，标签是廉价的副本。如果您想以一种表示快照永远不会更改的方式“快照”您的构建，请标记它。它不像它花费你很多。:-)

**编辑：**

为了解决“作为分支实现”的想法——它们不是。真的。事实上，Subversion 根本没有实现分支或标记。这些完全是用户创造的想法，两者碰巧使用相同的命令，`svn copy`. 但是，您*也可以*使用该命令在主干中复制文件；没什么特别的。分支或标签本身也没有什么特别之处。它们只是普通目录，我们决定对其进行特殊处理（甚至可以通过挂钩强制执行）以简化项目管理。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-02T20:25:22.887

> 请注意，修订版 712 是我们的第 1 版发布。

对我来说，制作标签*就是*记下 rev 712 是版本 1。

只需查看 Tags 文件夹，也很容易查看所有构建、里程碑、发布等。

如果您考虑标签在 VSS 中的工作方式，标签会更快、更容易使用，但完成同样的事情。只是不要过度分析它是使用复制命令制作的事实，就像分支一样。

**编辑：**如果您对某人提交对 Tag 文件夹的更改感到偏执，您可以使用预提交挂钩来防止用户这样做。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-02T20:21:12.397

> 请注意，修订版 712 是我们的第 1 版发布。

但在这种情况下，你必须做一个明确的笔记，将该笔记存储在每个人都可以看到并查找的地方的某个地方。

只需从修订版 712 创建一个名为“version 1 release”的标签（即，从 r712 复制到标签目录）要容易得多。并且每个人都立即知道这是版本，而无需首先查看版本 1 版本是哪个修订版。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-03T09:17:37.133

Subversion 存储库只是一棵文件和文件夹树，您可以在其中随时获取该树历史中任何版本的任何部分。

正如其他人所说，标签/分支/主干只是一个约定，颠覆允许您将树的一部分复制到其他地方（几乎）免费，但在它的核心，就是这样。

你是对的，你的版本需要一个维护分支。该标签充当您发送到外部某处的任何特定版本的名称 - 创建该标签时的提交评论让您有机会解释它的去向和原因（例如，“公开测试版”、“请求评论”）。

有几个钩子脚本可以防止你对标签进行修改，但默认情况下它们不会被实现，因为有些人以完全不同的方式使用 subversion（例如，配置文件备份等）。Subversion 是一个通用工具，没有“正确”的使用方式，只有针对常见情况的强大约定。

事实上，collabnet 开始考虑如何将版本控制用于[非开发](http://blogs.open.collab.net/svn/2009/05/subversion-is-not-just-for-developers.html) [项目](http://blogs.open.collab.net/svn/2009/05/subversion-is-not-just-for-developers-part-2.html)。标签树干和分支的整个想法可能与其中一些无关。

在考虑源代码存储库时，我的惯例是：

*   主干 - 可能发布的完整修订列表
*   任务 - 对一组修订进行分组的作业/错误的外部描述
*   开发分支 - 一组尚未准备好用于主干的修订
*   维护分支 - 从主干收集修订以进行发布的地方
*   标记 - 维护分支的命名快照

标签还可以为您提供可用的文档 url，例如：

“该版本可在[http://svnserver/myproject/tags/1.0 获得](http://svnserver/myproject/tags/1.0)”它可能是：“该版本可在[http://svnserver/myproject/trunk@4483](http://svnserver/myproject/trunk@4483)获得”

但是当您浏览存储库时，您永远不会遇到@4483 并且知道它有任何特别之处。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-02T20:15:38.600

标签应该引用一组文件的不可变“应用程序版本”。
（“应用程序的版本”而不是“VCS 使用的技术内部版本号”，例如 SVN 的修订版，或 Git 的 SHA-1，或 ClearCase 的 id，或者......）
它们应该作为*参考*在另一个工作区中查询和部署（用于测试或 UAT - 用户验收测试 -）

由于 SVN 实现了类似分支的标签：作为目录，因此修改标签中文件的动机可能很强烈，但会破坏标签的目的。其他 VCS 具有标签（或“基线”）的概念，一旦设置，就不能再移动了。

[George Mauer](https://stackoverflow.com/users/5056/george-mauer)对此评论说：

> 嗯，这就是我所说的。标签永远不应更改，因此将它们作为分支实现是非常...奇怪的。

“实施”？但是他们没有“实现”标签的概念。SVN 本身没有“标签”。他们只是重复使用他们的分支并说它也可以用作标签。

[SVN RedBook](http://svnbook.red-bean.com/en/1.6/svn.branchmerge.tags.html)明确指出：

> 但是等一下：这个标签创建过程不就是我们用来创建分支的过程吗？是的，事实上，它是。
> 在 Subversion 中，标签和分支之间没有区别。两者都只是通过复制创建的普通目录。
> 就像分支一样，复制的目录是“标签”的唯一原因是因为人类已经决定这样对待它：只要没有人提交到目录，它就永远是一个快照。如果人们开始致力于它，它就会变成一个分支。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-02T20:16:05.433

我们用它来标记有趣但不发布的特定构建，例如：“Investor Demo”等。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-02T20:18:45.770

标签不打算被修改，如果你想这样做，你应该做一个分支。

您可以从标签创建一个分支，这可能是您想要做的，然后将该分支的结果重新标记为不同的版本。

您不应该签出标签进行编辑。

在 SVN 中分支（复制）不会丢失任何历史记录。这一切都联系在一起。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-02T20:19:33.790

每次我将项目从开发服务器提升到生产服务器时，我都会创建一个标签。这让我了解了将哪些代码提升到生产环境的历史。如果有任何问题，我可以快速回滚到以前的生产版本。

您不想签出/更改/提交标签目录中的任何内容。它只是一个保存给定时间点的代码快照的地方。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-02T23:55:43.260

根据我的经验，标签用于发布标记，并且您不太可能进行修改。

如果您创建“release2-0”分支，然后需要进行更改（例如修复发布后发现的错误），则它不再代表您为 2.0 版发布的内容。

相反，如果您创建“release2-0”标签并发现需要修补该版本，则可以创建一个新分支，在那里进行修复，并将其标记为“release-2-0-1”。

这样您就可以轻松访问您的任何版本。

# iphone - 将 UINavigationBar 添加到 UITabBarController

> ID：941651
> 
> 赞同：0
> 
> 时间：2009-06-02T20:14:19.510
> 
> 标签：iphone, cocoa-touch

我的应用程序可以在 iPhone OS 2.2.1 上完美运行，但现在我正试图让它在 iPhone OS 3.0 上运行。

我的应用程序崩溃了，显然是因为在 UITabBarController 中有一个 UINavigationController。

我收到以下错误：

```
'NSInternalInconsistencyException', reason:
'Changing the delegate of a tab bar managed by a tab bar controller is not allowed.' 
```

而且我不知道为什么会发生以及如何解决它。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T06:45:26.097

在每个选项卡中都有一个 UINavigationController 非常好。您遇到的问题显然与错误使用代表有关。但是，如果没有涉及的源代码，很难告诉您问题出在哪里。

# .net - 打开文件 - 安全警告

> ID：941656
> 
> 赞同：1
> 
> 时间：2009-06-02T20:16:01.190
> 
> 标签：.net, windows, security

**操作系统：** Vista Business 64 位
**编码：** .NET 和第 3 方 EXE
**问题：** 安全性

我下载了 curl.exe 来帮助我从亚马逊加载产品信息。Curl.exe 已经预编译并且不是 .NET 应用程序，因此我对 curl 的构建进行任何更改感到不舒服。

关于问题。

当我执行 CURL 我得到这个对话框：

说： *打开文件 - 安全警告无法验证发布者。您确定要运行此软件吗？运行或取消*

无论我是手动还是以编程方式运行软件，我都会收到此错误。

当我手动使用这个软件时，我可以处理这个问题，但我试图自动化一个进程以编程方式运行它，所以我想禁止这个对话框。

在研究这个时，我得到了很多关于调整 IE 设置的信息......但我没有从我的浏览器运行任何东西，只是在 Windows 中启动 exe，所以这不是问题。

我还看到了很多关于将不同的域和服务器添加到我的允许列表的信息。这是在我自己的机器 (C:\curl.exe) 上本地运行的，所以这也不是问题。

我是我正在运行它的盒子的管理员。

所以关于这个的信息很少。

**编程注意事项：**

我正在运行这个文件，虽然 .NET 像这样：

```
string cmd = string.Empty;

cmd += @"--location --user username:userpass -C - ";
cmd += @"--digest -k https://assoc-datafeeds-na.amazon.com/datafeed/getFeed?filename=";
cmd += FeedName + ".gz ";
cmd += @"-o " + FeedFileFolder + FeedName + ".gz";

System.Diagnostics.Process proc; // Declare New Process
System.Diagnostics.ProcessStartInfo procInfo = new System.Diagnostics.ProcessStartInfo(); 

procInfo.UseShellExecute = true;  //If this is false, only .exe's can be run.
procInfo.WorkingDirectory = "C:"; //execute notepad from the C: Drive
procInfo.FileName = "curl.exe"; // Program or Command to Execute.
procInfo.Arguments = cmd; //Command line arguments. 
```

因此，如果我无法更改 Windows 中的设置以允许此未经验证的 EXE 没有数字签名，则另一种选择是调整我的 procInfo 以允许我禁止此对话框，但我还没有找到它...

有任何想法吗..？

谢谢，汤姆

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-11T14:59:41.627

我相信 IE 将一个名为 Zone.Identifier 的 NTFS 流附加到它下载的 exe 文件中。

您可以通过在命令提示符处键入以下内容来验证这一点：

```
more <exename.exe:Zone.Identifier 
```

它会输出类似

```
[ZoneTransfer]
ZoneId=3 
```

我不知道如何在不使用实用软件的情况下删除 NTFS 流，我不打算在这里推荐，因为我没有使用过。您可以尝试通过执行清除它

```
echo . >exename.exe:Zone.Identifier 
```

或者只是将文件复制到 FAT 驱动器上，然后再次关闭。（最后，用于 FAT 格式的拇指棒！）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T20:26:00.857

Windows 会跟踪二进制文件的来源，因此即使未从浏览器运行，下载的二进制文件仍被标记为不安全。

从 exe 的文件属性中，单击“取消阻止”。

# asp.net - 将 GridView 控件绑定到 DataTable

> ID：941658
> 
> 赞同：1
> 
> 时间：2009-06-02T20:16:24.123
> 
> 标签：asp.net, data-binding, datatable

在 ASP.NET 页面 (.aspx) 上显示数据表列的语法是什么？我知道它是这样的`Container.DataItem`，自从我使用`DataTable`对象以来已经有一段时间了

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T20:17:57.537

```
<%#Databinder.Eval(Container.DataItem, "Field") %> 
```

# xml - XSL: Counting Previous Unique Siblings

> ID：941662
> 
> 赞同：5
> 
> 时间：2009-06-02T20:17:31.890
> 
> 标签：xml, xslt, xpath

OK, I want to apply a XSL style sheet that counts the previous unique "ROLE" nodes and spits out the following output format of @name the number of unique ROLE nodes prior to the current nodes. I've wasted several hours on what should be an easy thing to implement. I have tried to implement this in several ways including the Muenchian Method, if/with variables (Can't increment a variable), applying templates to templates etc to no avail.

I have the following XML:

```
<ROLEACTIONINFO>
  <ROLE name="TESTER" /> 
  <ROLE name="PARENT1"/>
  <ROLE name="PARENT1"/>
  <ROLE name="PARENT1"/>
  <ROLE name="PARENT2"/>
  <ROLE name="PARENT2"/>
  <ROLE name="PARENT3"/>
  <ROLE name="PARENT4"/>
  <ROLE name="TESTROLE"/>
</ROLEACTIONINFO> 
```

OUTPUT EXAMPLE:

```
TESTER  1
PARENT1 2
PARENT1 2
PARENT1 2
PARENT2 3
PARENT2 3
PARENT3 4
PARENT4 5
TESTROLE  6 
```

Getting the count of the unique preceeding nodes is my problem. Any help would be appreciated

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T07:44:02.563

This can be solved pretty easily using XPath. Here's the expression you're looking for: `count((.|preceding-sibling::ROLE)[not(@name = preceding-sibling::ROLE/@name)])`

This can be broken down to make it more readable, as I've done in the following XSLT 1.0 stylesheet:

```
<xsl:stylesheet version="1.0"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

  <xsl:output method="text"/>

  <!-- don't copy whitespace -->
  <xsl:template match="text()"/>

  <xsl:template match="ROLE">
    <xsl:variable name="roles-so-far" select=". | preceding-sibling::ROLE"/>
    <!-- Only select the first instance of each ROLE name -->
    <xsl:variable name="roles-so-far-unique"
                  select="$roles-so-far[not(@name = preceding-sibling::ROLE/@name)]"/>
    <xsl:apply-templates select="@name"/>
    <xsl:text> </xsl:text>
    <xsl:value-of select="count($roles-so-far-unique)"/>
    <xsl:text>&#xA;</xsl:text> <!-- linefeed -->
  </xsl:template>

</xsl:stylesheet> 
```

Here's an alternative implementation, using the Muenchian method. First, declare a key:

```
<xsl:key name="roles" match="ROLE" use="@name"/> 
```

Then, replace the definition of $roles-so-far-unique with something like this:

```
<!-- Among all the ROLEs having one of the names so far,
     select only the first one for each name -->
<xsl:variable name="roles-so-far-unique"
              select="../ROLE[@name = $roles-so-far/@name]
                             [generate-id(.) = generate-id(key('roles',@name)[1])]"/> 
```

This code, of course, is more complicated. Unless you have a large data set requiring you to speed up processing using the Muenchian method (even then I would test to make sure it buys you anything), you might as well stick with the simpler version above.

Finally, in XSLT 2.0, it's much easier. Simple replace the $roles-so-far-unique definition with the following:

```
<!-- Return a list of distinct string values, with duplicates removed -->
<xsl:variable name="roles-so-far-unique"
              select="distinct-values($roles-so-far/@name)"/> 
```

I hope this has helped you identify where you went wrong in the various attempts that you mentioned.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-03T12:47:17.053

This is easily solved with an `<xsl:key>`:

```
<xsl:stylesheet
  version="1.0"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
>

  <xsl:output method="text" />

  <xsl:key name="kRole" match="ROLE" use="@name" />

  <xsl:template match="ROLE">
    <xsl:value-of select="concat(@name, ' ')" />
    <xsl:value-of select="count(
      (. | preceding-sibling::ROLE)[
        count(. | key('kRole', @name)[1]) = 1
      ])" />
  </xsl:template>

</xsl:stylesheet> 
```

Output is as desired:

```
TESTER 1
PARENT1 2
PARENT1 2
PARENT1 2
PARENT2 3
PARENT2 3
PARENT3 4
PARENT4 5
TESTROLE 6 
```

Explanation of the XPath expression in the `<xsl:value-of>`:

```
count(                          # count the nodes:
(. | preceding-sibling::ROLE)   # union of this node and its predecessors
[                               # where...
  count(                        # the count of the union of...
    . |                         #   this node and
    key('kRole', @name)[1]      #   the first node with the same @name
  ) = 1                         # is 1
]
) 
```

This is the Muenchian method. Based on the fact that a node set cannot contain the same node twice, a union of two nodes has a node count of 1 if they are the same node. This way we are selecting the unique nodes from `(. | preceding-sibling::ROLE)` only.

If there are more than one `<ROLEACTIONINFO>` elements in your document, there is a parent check missing. This is also easily achieved:

```
 <xsl:template match="ROLE">
    <xsl:variable name="parentId" select="generate-id(..)" />
    <xsl:value-of select="count(
      (. | preceding-sibling::ROLE)[
        count(. | key('kRole', @name)[generate-id(..) = $parentId][1]) = 1
      ])" />
  </xsl:template> 
```

Note that `[generate-id(..) = $parentId][1]` != `[1][generate-id(..) = $parentId]`.

Order is important when chaining predicates. The former checks for parent node equality first and then takes the first unique node from the reduced set. This is what we want.

The latter takes the first node from the set (all ROLE nodes with a given name throughout the document), takes the first one and then keeps or discards it based on parent equality. This is wrong.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T21:44:18.830

Recursion usually works pretty well with problems like this.

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output method="text" media-type="text/plain" />

    <xsl:template name="count-previous-but-not-with-my-name">
        <xsl:param name="nodes" />
        <xsl:param name="count" select="0" />
        <xsl:choose>
            <xsl:when test="count($nodes) = 0">
                <xsl:value-of select="$count" />
            </xsl:when>
            <xsl:otherwise>
                <xsl:variable name="last-name" select="$nodes[last()]/@name" />
                <xsl:variable name="nodes-before-me-without-my-name" select="$nodes[position() &lt; last() and @name != $last-name]" />
                <xsl:call-template name="count-previous-but-not-with-my-name">
                    <xsl:with-param name="nodes" select="$nodes-before-me-without-my-name" />
                    <xsl:with-param name="count" select="$count + 1" />
                </xsl:call-template>
            </xsl:otherwise>
        </xsl:choose>
    </xsl:template>

    <xsl:template match="/">
        <xsl:for-each select="//ROLEACTIONINFO/ROLE">
            <xsl:variable name="role" select="current()" />
            <xsl:variable name="my-pos" select="position()" />
            <xsl:value-of select="current()/@name" /><xsl:text> </xsl:text>
            <xsl:call-template name="count-previous-but-not-with-my-name">
                <xsl:with-param name="nodes" select="$role/../ROLE[position() &lt;= $my-pos]" />
            </xsl:call-template>
            <xsl:text>&#10;</xsl:text>
        </xsl:for-each>
    </xsl:template>

</xsl:stylesheet> 
```

# c++ - 可视化标记条件编译

> ID：941669
> 
> 赞同：3
> 
> 时间：2009-06-02T20:17:58.207
> 
> 标签：c++, cross-platform, c-preprocessor

我们有大量为多个目标编译的**C** /C++ 代码，由#ifdefs 分隔。其中一个目标与其他目标非常不同，了解您正在编辑的代码是否针对该目标编译通常很重要。不幸的是，#ifdefs 可能非常分散，因此为哪些目标编译哪些代码并不总是很明显。

Visual Studio 的#ifdef 突出显示有助于直观地识别为哪个目标编译了哪些代码，但更改突出显示显然需要修改项目文件。

我有兴趣找到一种工具或方法来帮助编码人员快速识别哪些目标正在使用每一行代码。即使它需要某种手动的源内注释，我认为它仍然会有所帮助。最好的情况是它是自动化的，不依赖于特定的编辑器或 IDE，并且可以配置为在某些情况下发出警告（例如，“您在 Target X 上修改了一些代码，请务必在该平台上测试您的代码！”）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T20:25:28.207

如果您的代码变得如此之大，以至于您无法分辨 #ifdef 是什么，那么是时候重构您的代码了。我建议您将其重构为每个平台的单独 cpp 文件。

当代码只有一两行长时，我通常只使用#idef，我通常将它的唯一函数或类重构到自己的cpp文件中。这使得弄清楚你在哪里变得很容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T20:45:05.797

查看[Visual SlickEdit](http://www.slickedit.com/)。“*选择性显示”*选项可能是您正在寻找的。我找不到任何关于它的在线文档，但它可以让您从本质上将一组宏定义应用于代码*。*所以你可以告诉它向你展示代码，因为编译器会看到它定义了一组宏。这比预处理器输出要多得多，因为它实际上隐藏了将根据宏定义排除的代码块。

但是，这并不能让您回答“在什么预处理器条件下，这行代码包含在编译中”的问题。好处是它将选择性显示过滤器应用于搜索和打印。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T21:41:30.957

我知道 eclipse cdt 可以做到这一点。它还有其他不错的功能和一些不太适合 IDE 的功能。现在，我用 vi 编码，所以我可能有偏见。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T20:31:32.173

我不知道是否已经有一个工具，但我想通过使用预编译器很容易推出你自己的工具。使用一组特定的#defines 预编译您的文件，输出就是编译器针对该平台看到的内容。我认为这与突出显示*当前*文件不同，但它可以自动化并集成到您的 IDE 中，按下按钮获取一个临时文件，其中包含当前在特定#define 下编辑的文件。自己没试过，只是一个想法。

PS。是的，我不得不阅读你的帖子几次来寻找“代码覆盖率”到底在哪里涉及大声笑。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T21:04:10.423

检查[XRefactory](http://www.xref.sk/)和[Cscout](http://www.spinellis.gr/cscout/)。

# jquery - 使用 jQuery 插件时禁用特定按钮的验证：验证

> ID：941670
> 
> 赞同：0
> 
> 时间：2009-06-02T20:18:14.493
> 
> 标签：jquery, asp.net-ajax

我在 asp.net 中使用[jquery 验证](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)。问题是，我有相同形式的搜索按钮和评论按钮。当用户想要写评论时，验证工作完美，但是当用户想要在页面中进行搜索时，评论的必填字段不允许他们。

所以问题是如何禁用特定按钮的验证。

谢谢 roncansan

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T20:21:52.100

将验证移至按钮的单击事件，如果验证失败，则使用[preventDefault ()。](http://docs.jquery.com/Events/jQuery.Event#event.preventDefault.28.29)

```
$("#yourButtonId").click( function(event){
  if (formIsInvalidForSubmission)
     event.preventDefault();      
}); 
```

# wpf - 对齐按钮内容

> ID：941672
> 
> 赞同：29
> 
> 时间：2009-06-02T20:18:30.110
> 
> 标签：wpf, controls, templates, wpf-controls

我希望 wpf 按钮的内容左对齐我尝试了以下操作，但文本仍然在按钮内居中。

```
 <Button >
        <StackPanel HorizontalAlignment="Stretch">
            <TextBlock HorizontalAlignment="Left" Text="Save"/>
        </StackPanel>
    </Button> 
```

我该怎么办？

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2009-06-02T20:20:11.930

[`HorizontalContentAlignment`](http://msdn.microsoft.com/en-us/library/system.windows.controls.control.horizontalcontentalignment.aspx)找到了，是

:)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-06-02T23:43:24.347

您不需要 StackPanel 或 TextBlock。所有你需要的是

```
<Button HorizontalContentAlignment="Left" Content="Save" /> 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-11-28T08:45:50.560

**您可以通过两种方式对齐，水平和垂直**

```
<Button Content="Export" VerticalContentAlignment="Bottom" name="MyBtn1"  /> 
```

**或者**

```
<Button Content="Export" HorizontalContentAlignment="Center" name="MyBtn2"  /> 
```

**请参阅下图以查看可能性设置：**

[![在此处输入图像描述](https://i.stack.imgur.com/TRGMc.png)](https://i.stack.imgur.com/TRGMc.png)

[![在此处输入图像描述](https://i.stack.imgur.com/Zjnxt.png)](https://i.stack.imgur.com/Zjnxt.png)

# matlab - 将几个小的刚度矩阵组合在一起

> ID：941683
> 
> 赞同：3
> 
> 时间：2009-06-02T20:20:37.750
> 
> 标签：matlab, matrix

这是一个微不足道的问题，但我只是从 matlab 开始，还没有习惯他们的思维方式（和语法）。

对于曾经使用 FEM 或类似技术做过任何事情的人来说，我所要问的都是显而易见的。

您如何将几个小的刚度矩阵组合在一起。比如说，对于（元素 1），你得到了一个 4x4 的局部刚度矩阵，对于（元素 2）也是一样的——当然，只是不同的矩阵，但仍然是 4x4。

最简单的方法是什么：

```
[|--------| 0  0 ]  
[|        | 0  0 ]  
[|     |--|-----|]  
[|-----|--|     |]  
[0  0  |        |]  
[0  0  |--------|]  

(a33+b11, a34+b12,
(a43+b12, a44+b22, ...) 
```

即做一个“大”？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-02T23:28:58.930

刚度矩阵希望是稀疏的。无奈如此。关键是这些大刚度矩阵最终会包含大量的零元素。因此，您需要牢记这一点来构建矩阵。好消息是，稀疏矩阵在 matlab 中得到了很好的支持。但是您需要正确地使用它们。

这个想法是将矩阵构建为行和列索引的列表，加上要插入矩阵的值。提前建立这个清单。只有在最后你才调用 sparse 来实际构建矩阵本身。Sparse 会自动总结有重叠的元素。

一旦构建了稀疏矩阵，所有操作，如矩阵乘法和反斜杠都得到完全支持，并且与完整矩阵上的相同操作相比可以非常快。当您的全局刚度矩阵可能为 1e5x1e5 或更大时，这一点尤其重要。

在某些情况下，对于大型矩阵，当矩阵的因式分解变得不可能时，您可能需要迁移到迭代求解器。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-02T20:31:06.887

我认为你的问题是这样的：

A = 4x4 B = 4x4

C = 最终矩阵，其中 A 和 B 重叠并且应该重叠相加。

做这个：

```
C = zeros(6);
C(1:4,1:4) = A;
C(3:6,3:6) = C(3:6,3:6) + B; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-02T23:30:57.663

只是为了好玩，这里有一个使用[BLKDIAG](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/blkdiag.html)的单线解决方案：

```
C = blkdiag(A,zeros(2)) + blkdiag(zeros(2),B); 
```

# xna - 何时在 XNA 中使用多个精灵批次？

> ID：941685
> 
> 赞同：10
> 
> 时间：2009-06-02T20:20:46.953
> 
> 标签：xna

在 XNA 中，什么时候适合使用多个 spritebatch 渲染您的游戏内容？到目前为止，我从未使用过多个，也从未注意到这种方法的任何缺点。

在什么情况下需要使用多个 spritebatch？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-02T20:39:46.417

在极少数情况下需要使用多个 SpriteBatch。我经常看到的一个例子是，您希望将不同的后处理/渲染状态应用于不同的精灵集，这需要为每组单独的 SpriteBatch。

如果可能的话，通常认为只使用一个批次是一种好的做法，因为在一个批次中绘制尽可能多的东西比将工作分散到多个批次中要高效得多。此外，由于您只能在单个 SpriteBatch 中控制排序顺序，因此可能难以（或不可能）控制来自不同批次的精灵之间的深度。

简而言之：在某些情况下您可能想要这样做，但这并不常见，通常您应该坚持使用一个 SpriteBatch，除非您*知道*不使用多个 SpriteBatch 就无法完成您想要的事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-08T10:44:41.880

[这](http://blogs.msdn.com/shawnhar/archive/2006/12/14/spritebatch-sorting-part-2.aspx)是何时使用超过 1 个 SpriteBatch 的一个很好的示例（Shawn 的博客——像往常一样——是权威来源）。

> 在调用 End 方法之前，SpriteBatch 实际上不会进行任何绘图。这意味着您可以使用不同的设置开始几个重叠的批次，使用批次实例的任何组合以任何顺序绘制精灵，并通过 End 调用的顺序控制每个批次的全部内容的绘制顺序。

请注意，此示例是关于优化具有 alpha 混合和按深度排序的精灵的场景的*性能*。当（或者更确切地说，*如果*）遇到性能问题时，使用多个 SpriteBatch 可能会有所收获。在那之前，你最好保持简单。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T01:05:25.770

在使用 DrawableGameComponents 的情况下，每个 DrawableGameComponent 都有一个 SpriteBatch 而不是尝试传递它也可能更容易。

# iphone - iPhone SMS 撰写视图是如何实现的？

> ID：941690
> 
> 赞同：0
> 
> 时间：2009-06-02T20:21:30.900
> 
> 标签：iphone, sms

关于 SMS 撰写视图如下图所示： [alt text http://www.kennethlund.dk/wordpress/wp-content/uploads/2008/08/iphone_sms.jpg](http://www.kennethlund.dk/wordpress/wp-content/uploads/2008/08/iphone_sms.jpg)

我有两个问题：

1）文本输入框是如何实现的？API 没有标准控件，并且当您按 Enter 或文本太长时，该框足够智能以调整大小。栏也随之调整大小。这是如何用最少的编码完成的？

2）如何编码，当键盘出现时，整个视图向上移动？通常，当键盘显示时，它会覆盖您当前的视图。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T21:48:46.463

在 stackoverflow 中搜索“uitextView size”会产生以下结果：

[如何根据内容调整 UITextView 的大小？](https://stackoverflow.com/questions/50467/how-do-i-size-a-uitextview-to-its-content)

[调整 UITextView 的大小](https://stackoverflow.com/questions/728704/resizing-uitextview)

* * *

在 stackoverflow 中搜索“keyboard iPhone”会产生以下结果：

[以编程方式对齐 iPhone 键盘顶部的工具栏](https://stackoverflow.com/questions/158574/programatically-align-a-toolbar-on-top-of-the-iphone-keyboard)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-05-23T21:23:37.990

[TTTextEditor](http://github.com/facebook/three20/blob/master/src/Three20UI/Headers/TTTextEditor.h)是一个自动调整大小的文本框，它是[three20](http://groups.google.com/group/three20/)框架的一部分

# c# - 设计器模式下的 ASP.NET 用户控件属性值选项

> ID：941696
> 
> 赞同：10
> 
> 时间：2009-06-02T20:22:00.663
> 
> 标签：c#, asp.net, .net-3.5, user-controls

我正在使用 Visual Studio 2008 | .NET 3.5 | C＃。我创建了一个具有以下属性的用户控件：DisplayMode。DisplayMode 旨在显示一系列文本框或单个文本框。

```
[Browsable(true),
Category("Appearance"),
DefaultValue(DISPLAY_MODE_FIELDS),
Description("Indicates whether to display the phone number as a single text box or separate fields.")]
public string DisplayMode
{
      get { return mDisplayMode; }
      set { mDisplayMode = value; }
    } 
```

因此，我希望该属性的选项为“字段”或“单个”。我在上面指定了我想在设计器中使其可浏览，但是我如何将这两个值设置为选项，而不是知道将来指定“字段”、“单个”等？是否有另一个属性可以用来装饰属性以列出这些选项，或者我是否需要创建一个枚举（哪个有效）？

提前致谢，如果您需要任何其他信息，请告诉我！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-02T20:37:37.200

枚举是要走的路。它将为 Visual Studio HTML 编辑器中的值提供 IntelliSense，并且它将更加类型安全且更易于在代码中使用。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-02-23T15:32:03.953

只需创建一个枚举

在您的用户控制中 -

```
 public enum OrientationOption
    { 
        Horizontal,
        Vertical
    }

    public OrientationOption Orientation { get; set; } 
```

就是这样 ！这就是它在 VS 自动完成中的样子
![代码视图中的自动完成选项](https://i.stack.imgur.com/3ib00.jpg)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-02T20:37:57.543

我会为您的用户控件`enum`的`DisplayMode`属性创建一个

# c# - Silverlight 切换按钮分组

> ID：941698
> 
> 赞同：11
> 
> 时间：2009-06-02T20:22:08.493
> 
> 标签：c#, silverlight, xaml

我正在开发一个 Silverlight 应用程序，并希望创建一组 5 个切换按钮（用于菜单选项），这些按钮在单击时会产生动画（尺寸变大），并且还会导致组中任何先前单击的按钮取消单击并动画回它们缩小的尺寸。

我知道我可以使用蛮力方法，应用程序直接知道每个按钮，但是如果我添加或更改菜单（添加/删除按钮），我必须记住修改代码（这很糟糕，因为我我健忘）。有没有办法更智能地对按钮进行分组，以便在单击一个按钮时可以告诉组中的所有其他按钮取消单击？

谢谢！托德

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-05T12:19:01.707

特别感谢 Michael S. Scherotter 指出我使用 RadioButton 和控件模板的正确方向！

这是我想出的基本控制模板。如果您愿意，请将其放在标签之间的 App.xaml 中。UX 人员会给它一次美化它，但现在，它作为一个单选按钮工作，看起来像一个切换按钮（或只是一个按钮），但有一个组名。

一个重要的说明：这个模板没有任何基本的按钮动画，所以它不会在点击时按下......这就是我上面提到的UX工作。

```
 <Style x:Key="MenuButton" TargetType="RadioButton">
        <Setter Property="Width" Value="100"/>
        <Setter Property="Height" Value="25"/>

        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="RadioButton">
                    <Border BorderBrush="DarkGray" BorderThickness="3" CornerRadius="3" Background="Gray">
                        <!-- The ContentPresenter tags are used to insert  on the button face for reuse -->
                        <ContentPresenter></ContentPresenter>
                    </Border>
                </ControlTemplate>

            </Setter.Value>
        </Setter>
    </Style> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-23T14:50:26.680

我试图做同样的事情，我发现了这个旧帖子。让我稍微更新一下...

Todd 似乎和许多其他懒惰的程序员一样，让 UX 人员完成所有工作。:) 所以这是托德的解决方案，其中实际的切换按钮作为组中的单选按钮：

```
<RadioButton GroupName="myGroup"
             Style="{StaticResource MenuButton}"
             Content="One" 
             IsChecked="True" />
<RadioButton GroupName="myGroup"
             Style="{StaticResource MenuButton}"
             Content="Two" />    
<RadioButton GroupName="myGroup"
             Style="{StaticResource MenuButton}"
             Content="Three" />

<Style x:Key="MenuButton" TargetType="RadioButton">
    <Setter Property="Width" Value="100"/>
    <Setter Property="Height" Value="25"/>
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="RadioButton">
                <Border BorderBrush="DarkGray" BorderThickness="3" CornerRadius="3" Background="Gray">
                    <ToggleButton IsChecked="{Binding IsChecked, RelativeSource={RelativeSource TemplatedParent}, Mode=TwoWay}">
                        <ToggleButton.Content>                  
                            <ContentPresenter></ContentPresenter>
                        </ToggleButton.Content>
                    </ToggleButton>                              
                </Border>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

现在您将拥有漂亮的按钮翻转效果以及所有这些效果，并且一次只能“检查”一个切换按钮。

单选按钮和切换按钮都可以是三种状态，您也可以绑定切换按钮的“IsThreeState”属性，就像我在这里绑定“IsChecked”一样。但默认情况下它们是两种状态。

此外，长格式绑定在这里很重要，因为快捷方式 {TemplateBinding IsChecked} 将默认为一种方式，我们需要它们在两种方式中保持同步。

当然，这个例子并没有为按钮的大小和 Todd 最初发布的所有内容设置动画，但它确实为您提供了常规按钮，您可以轻松地区分它们是否被选中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-02T20:32:46.243

为所有 RadioButton 对象提供相同的 GroupName。

# algorithm - 在 Haskell 中合并排序的输入？

> ID：941699
> 
> 赞同：8
> 
> 时间：2009-06-02T20:22:09.040
> 
> 标签：algorithm, haskell

我是 Haskell 的新手，我正在尝试编写一个优雅的函数来将任意数量的排序列表合并到一个排序列表中......任何人都可以提供一个优雅而高效的参考实现吗？

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-02T20:47:01.127

像这样的东西应该工作：

```
merge2 pred xs [] = xs
merge2 pred [] ys = ys
merge2 pred (x:xs) (y:ys) =
  case pred x y of
      True  -> x: merge2 pred xs (y:ys)
      False -> y: merge2 pred (x:xs) ys

merge pred [] = []
merge pred (x:[]) = x
merge pred (x:xs) = merge2 pred x (merge pred xs) 
```

在这里，函数**merge2**合并了 2 个列表。函数**merge**合并列表列表。**pred**是用于排序的谓词。

例子：

```
merge (<) [[1, 3, 9], [2, 3, 4], [7, 11, 15, 22]] 
```

应该返回

```
[1,2,3,3,4,7,9,11,15,22] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T22:10:06.187

因为我喜欢在有意义的地方利用中缀运算符和高阶函数，所以我会写

```
infixr 5 @@
(@@) :: (Ord a) => [a] -> [a] -> [a]
-- if one side is empty, the merges can only possibly go one way
[] @@ ys = ys
xs @@ [] = xs
-- otherwise, take the smaller of the two heads out, and continue with the rest
(x:xs) @@ (y:ys) = case x `compare` y of
    LT -> x : xs @@ (y:ys)
    EQ -> x : xs @@ ys
    GT -> y : (x:xs) @@ ys

-- a n-way merge can be implemented by a repeated 2-way merge
merge :: (Ord a) => [[a]] -> [a]
merge = foldr1 (@@) 
```

在这里，`xs @@ ys`按自然顺序合并两个列表（并删除重复项），同时`merge [xs, ys, zs..]`合并任意数量的列表。

这导致了[汉明数](http://en.wikipedia.org/wiki/Regular_number)的非常自然的定义：

```
hamming :: (Num a, Ord a) => [a]
hamming = 1 : map (2*) hamming @@ map (3*) hamming @@ map (5*) hamming
hamming = 1 : merge [map (n*) hamming | n <- [2, 3, 5]] -- alternative

-- this generates, in order, all numbers of the form 2^i * 3^j * 5^k
-- hamming = [1,2,3,4,5,6,8,9,10,12,15,16,18,20,24,25,27,30,32,36,40,45,48,50,..] 
```

* * *

窃取[yairchu](https://stackoverflow.com/users/40916)未实现的[想法](https://stackoverflow.com/questions/941699/958654#958654)：

```
{-# LANGUAGE ViewPatterns #-}

import qualified Data.Map as M
import Data.List (foldl', unfoldr)
import Data.Maybe (mapMaybe)

-- merge any number of ordered lists, dropping duplicate elements
merge :: (Ord a) => [[a]] -> [a]
-- create a map of {n: [tails of lists starting with n]}; then
-- repeatedly take the least n and re-insert the tails
merge = unfoldr ((=<<) step . M.minViewWithKey) . foldl' add M.empty where
    add m (x:xs) = M.insertWith' (++) x [xs] m; add m _ = m
    step ((x, xss), m) = Just (x, foldl' add m xss)

-- merge any number of ordered lists, preserving duplicate elements
mergeDup :: (Ord a) => [[a]] -> [a]
-- create a map of {(n, i): tail of list number i (which starts with n)}; then
-- repeatedly take the least n and re-insert the tail
-- the index i <- [0..] is used to prevent map from losing duplicates
mergeDup = unfoldr step . M.fromList . mapMaybe swap . zip [0..] where
    swap (n, (x:xs)) = Just ((x, n), xs); swap _ = Nothing
    step (M.minViewWithKey -> Just (((x, n), xs), m)) =
        Just (x, case xs of y:ys -> M.insert (y, n) ys m; _ -> m)
    step _ = Nothing 
```

where `merge`，就像我的原版一样，消除了重复项，同时`mergeDup`保留了它们（如[Igor](https://stackoverflow.com/users/110177)的[答案](https://stackoverflow.com/questions/941699/941828#941828)）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-06T00:21:01.880

如果效率不是问题，我会选择

```
merge = sort . concat 
```

否则：

```
merge :: Ord a => [[a]] -> [a]
merge [] = []
merge lists =
  minVal : merge nextLists
  where
    heads = map head lists
    (minVal, minIdx) = minimum $ zip heads [0..]
    (pre, ((_:nextOfMin):post)) = splitAt minIdx lists
    nextLists =
      if null nextOfMin
      then pre ++ post
      else pre ++ nextOfMin : post 
```

但是请注意，此实现始终线性搜索最小值（而对于大量列表，可能希望维护堆等）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-01-11T18:52:24.023

与其他帖子不同，我会`merge :: [a] -> [a] -> [a]`

```
type SortedList a = [a]

merge :: (Ord a) => SortedList a -> SortedList a -> SortedList a
merge []     ys     = ys
merge xs     []     = xs
merge (x:xs) (y:ys)
  | x < y     = x : merge xs (y : ys)
  | otherwise = y : merge (x : xs) ys

mergeAll :: (Ord a) => [SortedList a] -> SortedList a
mergeAll = foldr merge [] 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-07-25T14:44:17.490

简单说明一下：如果您想在合并多个列表时获得最佳的 log n 行为（例如您将获得优先级队列），您可以通过调整上述 Igor 的漂亮解决方案来轻松实现。（我会将此作为对他上面回答的评论，但我没有足够的声誉。）特别是，你这样做：

```
merge2 pred xs [] = xs
merge2 pred [] ys = ys
merge2 pred (x:xs) (y:ys) =
  case pred x y of
      True  -> x: merge2 pred xs (y:ys)
      False -> y: merge2 pred (x:xs) ys

everyother [] = []
everyother e0:[] = e0:[]
everyother (e0:e1:es) = e0:everyother es

merge pred [] = []
merge pred (x:[]) = x
merge pred xs = merge2 pred (merge pred . everyother $ xs) 
                (merge pred . everyother . tail $ xs) 
```

请注意，真正的优先级队列会更快/更节省空间，但是这个解决方案在渐近上也一样好，而且正如我所说，它的优势在于它是对上面 Igor 精美清晰的解决方案的一个非常小的调整。

注释？

# c# - 应用程序设计，分离逻辑，委托与否

> ID：941701
> 
> 赞同：0
> 
> 时间：2009-06-02T20:22:20.147
> 
> 标签：c#, user-controls, delegates

代表们，那些适用于这里吗？如果是这样，怎么做？代码示例，因为我是这个领域的新手。

逻辑分离是我打算实现的，我认为我下面的任务将是一个完美的候选人。我已经读过对象应该是相当独立的，而不是彼此硬连接。

**ASPX（页面）**

```
<uc1:Attachment ID="Attachment1" runat="server" />
<asp:Button ID="Button1" runat="server" Text="Button" onclick="Button1_Click" /> 
```

**ASPX.cs（代码隐藏）**

```
protected void Button1_Click(object sender, EventArgs e)
{
  // Check the files and upload
} 
```

**ASCX（用户控制）**

```
<MyControl:Upload ID="Upload1" runat="server" 
AllowedFileExtensions=".zip,.jpg,.jpeg,.doc,.gif,.png,.txt"
    MaxFileInputsCount="3"
    OverwriteExistingFiles="false"  
onfileexists="Upload1_FileExists" 
onvalidatingfile="Upload1_ValidatingFile" /> 
```

**ASCX.cs（代码隐藏）**

```
public Upload AttachmentControl
{
    get { return this.Upload1; }
} 
```

上面的任务是一个文件上传模块。进行上载的控件位于已被拖到 ASPX 页面上的 UserControl 中。

ASPX 页面上的提交按钮应该会启动文件上传过程。这应该是一个相当常见的场景，页面将其他信息保存到数据库并上传文件。

根据过去的经验，我的直觉是通过公共属性在 UserControl 中公开 Upload 控件。这会将 Attachment UserControl 绑定到页面。

我该如何解开这个，也许是使用代表？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T20:56:11.873

视图需要关于其附件控件的哪些信息？附件控件需要了解包含它的视图的哪些信息？

我想 a`delegate(Stream uploadContent)`可以让你进一步解耦，但如果你使用 System.Web.Page 模型……那么解耦的动机似乎很缺乏。

让视图接受回调会反转应用程序中适当的依赖路径，不是吗？

# cocoa - 从菜单中选择项目时，自定义 NSCell 内的 NSPopUpButtonCell 不会更改选择

> ID：941706
> 
> 赞同：2
> 
> 时间：2009-06-02T20:23:20.550
> 
> 标签：cocoa, macos, nspopupbuttoncell

我在自定义 NSCell 中有一个 NSPopUpButtonCell 并且我正在使用

```
- (BOOL)startTrackingAt:(NSPoint)startPoint inView:(NSView *)controlView 
```

单击时生成弹出菜单。

我还覆盖了 copyWithZone: 在我的自定义单元格中复制 popUpCell 实例变量，以便我的表格视图中的每一行都有自己的弹出单元格。

My problem is that although the menu pops up just fine, and you can select an item from the menu, when an item is selected the cell does not change its selected item to match the chosen one from the menu.

但是，如果我用复制单元格的区域注释掉副本中的行，那么它会在选择过程中正常运行（更改以匹配所选项目，尽管每一行都将具有相同的所选项目）。

有谁知道这是为什么，或者更重要的是，我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-12T22:38:19.767

我建议不要复制单元格，而是使用：

`- (void)tableView:(NSTableView *)aTableView willDisplayCell:(id)aCell forTableColumn:(NSTableColumn *)aTableColumn row:(NSInteger)rowIndex`

...在绘制每一行之前使用正确数据设置单元格的委托方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-12T19:26:25.923

您是否尝试过使用

```
–trackMouse:inRect:ofView:untilMouseUp: 
```

代替

```
startTrackingAt:inView: 
```

?

# php - SoapClient 将请求保存到文件而不是发送它

> ID：941709
> 
> 赞同：0
> 
> 时间：2009-06-02T20:24:22.920
> 
> 标签：php, zend-framework, soap, soap-client

有没有办法保存 SoapClient 在调用 __soapCall 到文件而不是将其发送到实际服务器时发送的肥皂请求？

我正在尝试将肥皂请求保存到队列中，然后在一段时间内发送它们（请求会非常不同）。

我正在使用 Zend_Soap。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T20:49:18.377

看看 Zend_Soap_Client_Local，尤其是 _doRequest() 方法，并用自己的逻辑构建自己的类。

如果您想看看他们如何使用 Zend_Soap_Client_Local，请查看 tests/Zend/Soap/ClientTest.php，方法 testGetFunctions()。

# visual-c++ - 是否可以在 MSVC++ 中编译汇编代码？

> ID：941710
> 
> 赞同：1
> 
> 时间：2009-06-02T20:24:27.990
> 
> 标签：visual-c++, assembly

是否可以在 MSVC++ 中创建、编辑、链接、编译（是编译这个词吗？）等汇编代码？

另外，如果不可能，我如何从纯文本创建.exe，即：将文本转换为使用汇编代码所需的任何格式，然后将汇编代码转换为.exe。（我会说编译，但我认为这不是正确的词）。

最后，有哪些好的地方可以开始学习汇编代码？以没有经验的人可以使用的方式编写。

我知道其中一些问题可能非常愚蠢，但我完全没有汇编代码方面的经验，也不确定从哪里开始。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-02T20:29:25.047

在 x86 上，是的。您可以使用[__asm](http://msdn.microsoft.com/en-us/library/45yd4tzz(VS.80,printer).aspx)关键字将程序集内联放入标准源文件中，并使用普通的 MS 编译/链接工具将所有内容编译在一起。

在 x64（或 x86）上，您可能需要使用[ML 和 ML64](http://msdn.microsoft.com/en-us/library/s0ksfwcf(VS.80,printer).aspx)命令行编译器进行汇编。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-02T20:32:27.803

Visual Studio 提供了[__asm](http://msdn.microsoft.com/en-us/library/45yd4tzz(VS.71).aspx)关键字，用于在 c 和 c++ 中编译内联程序集。这里也有关于使用[内联汇编](http://msdn.microsoft.com/en-us/library/4ks26t93(VS.71).aspx)的很好的讨论。但是，如果您只是在谈论自己编译程序集，我不确定 Visual C++ 是否是正确的工具，但是我很确定 Visual Studio 附带了[MASM](http://msdn.microsoft.com/en-us/library/afzk3475(VS.71).aspx)汇编程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T20:32:25.760

简而言之，是的。

根据[Wikipedia](http://en.wikipedia.org/wiki/MASM)的说法，MASM 已随 VC6 之后的所有 Visual C 版本一起提供，并且在 Windows 驱动程序开发工具包中也可用。支持 16 位实模式和保护模式、32 位和 64 位的版本均受支持。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T20:39:21.423

您可以使用[__asm](http://msdn.microsoft.com/en-us/library/45yd4tzz(VS.80).aspx)关键字来编写内联汇编。

[pcasm-book(pdf)](http://www.cs.princeton.edu/courses/archive/fall08/cos318/precepts/pcasm-book.pdf)是开始汇编代码编程的好教程。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-02T20:52:15.250

是的，有点。

```
C:\Program Files\Microsoft Visual Studio 9.0\vc\bin>ml
Microsoft (R) Macro Assembler Version 9.00.30729.01
Copyright (C) Microsoft Corporation.  All rights reserved.

usage: ML [ options ] filelist [ /link linkoptions]
Run "ML /help" or "ML /?" for more info 
```

您将使用宏汇编程序。不过，我不知道 Visual Studio 是否会自动使用 .asm 文件“做正确的事”，但您当然可以使用它编辑它们并使用 ml.exe 组装它们。

开始学习汇编语言的一个好地方实际上可能是学习逆向工程。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-02T20:29:30.290

查找有关 C++ 'asm' 关键字的信息。它可能是特定于编译器的，但我知道 VC++ 支持它。

# objective-c - 如何在命令行实用程序中使用动态加载库？

> ID：941711
> 
> 赞同：0
> 
> 时间：2009-06-02T20:24:31.267
> 
> 标签：objective-c, cocoa, xcode

> **可能重复：**
> [在命令行工具中使用框架](https://stackoverflow.com/questions/630911/using-frameworks-in-a-command-line-tool)

嘿，

我编写了一个广泛使用 RegexKit.framework 的命令行“基础工具”。在 Xcode 中运行时一切正常，但如果我编译发布版本并尝试在终端中运行它，我会收到以下错误：

```
dyld: Library not loaded: @executable_path/../Frameworks/RegexKit.framework/Versions/A/RegexKit 
```

仔细检查发现 RegexKit.framework 包与我的可执行文件位于同一目录中......我已经做了一些研究，我认为由于命令行工具不使用应用程序包，所以 Xcode 无处可去将框架复制到。所以我猜我需要将框架编译为静态库并将其包含在我的代码中......我是对的吗？如果是这样，我该怎么做？我可以在终端中做些什么来从外部指向框架吗？

任何帮助都会得到很大的帮助，几天来我一直在努力解决这个问题！

提前致谢，

汤姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-04T07:04:19.133

您不应该在捆绑包的 Executable 文件夹中安装框架。它应该在 Frameworks 文件夹中。您需要在项目中复制框架的复制文件阶段，并且您需要将目标设置为“框架”。“仅在安装时复制”应**取消选中**。

测试时，您应该确保执行干净的构建。我通常删除构建文件夹而不是使用 Xcode 的 Clean 菜单选项，因为它更快更全面。

另外：您不能静态链接到框架。如果你想静态链接到某个东西，它需要是一个静态库，所以在这种情况下，你需要使用 RegexKit 来破解。请记住，静态库不能包含资源，而作为捆绑包的框架可以。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T20:06:37.193

所以......我最后所做的是用不同的安装目录重新编译框架（在部署部分，在目标信息的构建选项卡下） - 我将它设置为 @executable_path。

然后我编译了框架并替换了我的 Utilitie 项目中的框架，我还更改了复制文件构建阶段以将框架复制到“可执行文件”而不是框架。

好消息是这解决了我原来的问题 - 但显然框架必须与可执行文件位于同一目录中。

所以这让我陷入困境，但我仍然很想知道如何静态编译 RegexKit.framework！

# javascript - 使用 jQuery 处理表单数据

> ID：941714
> 
> 赞同：1
> 
> 时间：2009-06-02T20:25:08.690
> 
> 标签：javascript, jquery, ajax, prototypejs

我目前正在使用 Prototype，但我想将此函数重写为 jQuery：

```
function post(div,url,formId) {
  new Ajax.Updater(div, url, {
    asynchronous:true, 
    parameters:Form.serialize(formId)
  });
}
```

随之而来的 HTML 示例：

```
<form method="post" action="" id="foo" 
  onsubmit="post('result','getdata.php','foo');return false;">
  <input type="text" name="data" />
</form>
<div id="result"></div>
```

我一直在查看 jQuery.load() 和 jQuery.post()，但我不确定要使用哪一个以及如何使用。

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-02T20:30:29.943

使用此 HTML：

```
<form method="post" action="getdata.php" id="foo">
  <input type="text" name="data" />
</form>
<div id="result"></div> 
```

你可以用 jQuery 做到这一点：

```
$(function() { // wait for the DOM to be ready
    $('#foo').submit(function() { // bind function to submit event of form
        $.ajax({
            type: $(this).attr('method'), // get type of request from 'method'
            url: $(this).attr('action'), // get url of request from 'action'
            data: $(this).serialize(), // serialize the form's data
            success: function(responseText) {
                // if everything goes well, update the div with the response
                $('#result').html(responseText);
            }
        });
        return false; // important: prevent the form from submitting
    });
}); 
```

我摆脱`onsubmit`代码的原因是因为这样的内联 JavaScript 被认为是不好的做法。你应该努力让你的表单没有 JavaScript，然后绑定所有的 JavaScript。这被称为不显眼的 JavaScript，它是一件好事。

**编辑**：

由于您在许多页面中都有该代码，因此该函数将使用您当前在 post 函数上拥有的相同签名来执行您想要的操作。我建议您花几个小时来更新您的所有表格，而不是保留它，但无论如何：

```
function post(div,url,formId) {
    $.post(url, $('#' + formId).serialize(), function(d) {
        $('#' + div).html(d);
    });
} 
```

至于您的问题，[livequery](http://docs.jquery.com/Plugins/livequery)插件可以帮助您。或者，它就像将绑定代码封装在一个函数中并在添加表单时调用它一样简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T20:28:56.140

使用它并去掉 HTML 中的 onsubmit 属性：

```
$(document).ready(function() {
    $("#foo").submit(function() {
        $.post($(this).attr("action"), $(this).serialize());
        return false; // prevent actual browser submit
    });
}); 
```

[jQuery 序列化方法文档](http://docs.jquery.com/Ajax/serialize)

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2010-07-18T15:07:43.500

由于安全问题，您不能使用 jquery 发送“multipart/form-data”表单。你必须用flash或iframe来做......

# c# - 以编程方式创建和执行合并复制

> ID：941720
> 
> 赞同：3
> 
> 时间：2009-06-02T20:26:08.503
> 
> 标签：c#, .net, winforms, refactoring, replication

让我先说我现在意识到我是多么愚蠢并且曾经是多么愚蠢。我已经开发了 1 年（直到今天），这是我写的第一件事。我现在又回到了它，我无法对它做出正面或反面。它曾经在一个非常简单的应用程序上工作，但那是不久前的事了。

具体来说，我遇到了`LocalDBConn`哪些用途的问题，`out`但对于我的一生，我不记得为什么了。

欢迎和赞赏指导、指针、重构、拍脑袋！

```
public class MergeRepl
{
            // Declare nessesary variables
    private string subscriberName;
    private string publisherName;
    private string publicationName;
    private string subscriptionDbName;
    private string publicationDbName;
    private MergePullSubscription mergeSubscription;
    private MergePublication mergePublication;
    private ServerConnection subscriberConn;
    private ServerConnection publisherConn;
    private Server theLocalSQLServer;
    private ReplicationDatabase localRepDB;

    public MergeRepl(string subscriber, string publisher, string publication, string subscriptionDB, string publicationDB)
    {
        subscriberName = subscriber;
        publisherName = publisher;
        publicationName = publication;
        subscriptionDbName = subscriptionDB;
        publicationDbName = publicationDB;

        //Create connections to the Publisher and Subscriber.
        subscriberConn = new ServerConnection(subscriberName);
        publisherConn = new ServerConnection(publisherName);

        // Define the pull mergeSubscription
        mergeSubscription = new MergePullSubscription
                                {
                                    ConnectionContext = subscriberConn,
                                    DatabaseName = subscriptionDbName,
                                    PublisherName = publisherName,
                                    PublicationDBName = publicationDbName,
                                    PublicationName = publicationName
                                };

        // Ensure that the publication exists and that it supports pull subscriptions.
        mergePublication = new MergePublication
                               {
                                   Name = publicationName,
                                   DatabaseName = publicationDbName,
                                   ConnectionContext = publisherConn
                               };

        // Create the local SQL Server instance
        theLocalSQLServer = new Server(subscriberConn);
        // Create a Replication DB Object to initiate Replication settings on local DB
        localRepDB = new ReplicationDatabase(subscriptionDbName, subscriberConn);

        // Check that the database exists locally
        CreateDatabase(subscriptionDbName);
    }

    public void RunDataSync()
    {
        // Keep program from appearing 'Not Responding'
        ///// Application.DoEvents();

        // Does the needed Databases exist on local SQLExpress Install
        /////CreateDatabase("ContactDB");

        try
        {
                 //  Connect to the Subscriber
                 subscriberConn.Connect();

            // if the Subscription exists, then start the sync
                 if (mergeSubscription.LoadProperties())
                 {
                     // Check that we have enough metadata to start the agent
                     if (mergeSubscription.PublisherSecurity != null || mergeSubscription.DistributorSecurity != null)
                     {
                         //  Synchronously start the merge Agent for the mergeSubscription
                         //  lblStatus.Text = "Data Sync Started - Please Be Patient!";
                         mergeSubscription.SynchronizationAgent.Synchronize();
                     }
                     else
                     {
                         throw new ApplicationException("There is insufficient metadata to synchronize the subscription." +
                             "Recreate the subscription with the agent job or supply the required agent properties at run time.");
                     }
                 }
                 else
                 {
                     // do something here if the pull mergeSubscription does not exist
                     // throw new ApplicationException(String.Format("A mergeSubscription to '{0}' does not exist on {1}", publicationName, subscriberName));
                     CreateMergeSubscription();
                 }
        }
        catch (Exception ex)
        {
            // Implement appropriaate error handling here
            throw new ApplicationException("The subscription could not be synchronized.  Verify that the subscription has been defined correctly.", ex);
            //CreateMergeSubscription();
        }
        finally
        {
            subscriberConn.Disconnect();
        }
    }

    public void CreateMergeSubscription()
    {
        // Keep program from appearing 'Not Responding'
        // Application.DoEvents();

        try
        {

            if (mergePublication.LoadProperties())
            {
                if ((mergePublication.Attributes & PublicationAttributes.AllowPull) == 0)
                {
                    mergePublication.Attributes |= PublicationAttributes.AllowPull;
                }

                // Make sure that the agent job for the mergeSubscription is created.
                mergeSubscription.CreateSyncAgentByDefault = true;

                // Create the pull mergeSubscription at the Subscriber.
                mergeSubscription.Create();

                Boolean registered = false;

                // Verify that the mergeSubscription is not already registered.
                foreach (MergeSubscription existing in mergePublication.EnumSubscriptions())
                {
                    if (existing.SubscriberName == subscriberName
                        && existing.SubscriptionDBName == subscriptionDbName
                        && existing.SubscriptionType == SubscriptionOption.Pull)
                    {
                        registered = true;
                    }
                }
                if (!registered)
                {
                    // Register the local mergeSubscription with the Publisher.
                    mergePublication.MakePullSubscriptionWellKnown(
                        subscriberName, subscriptionDbName,
                        SubscriptionSyncType.Automatic,
                        MergeSubscriberType.Local, 0);
                }
            }
            else
            {
                // Do something here if the publication does not exist.
                throw new ApplicationException(String.Format(
                    "The publication '{0}' does not exist on {1}.",
                    publicationName, publisherName));
            }
        }
        catch (Exception ex)
        {
            // Implement the appropriate error handling here.
            throw new ApplicationException(String.Format("The subscription to {0} could not be created.", publicationName), ex);

        }
        finally
        {
            publisherConn.Disconnect();
        }
    }

    /// <summary>
    /// This will make sure the needed DataBase exists locally before allowing any interaction with it.
    /// </summary>
    /// <param name="whichDataBase">The name of the DataBase to check for.</param>
    /// <returns>True if the specified DataBase exists, False if it doesn't.</returns>
     public void CreateDatabase(string whichDataBase)
    {
        Database db;
        LocalDBConn(whichDataBase, out theLocalSQLServer, out localRepDB, out db);

        if (!theLocalSQLServer.Databases.Contains(whichDataBase))
        {
            //Application.DoEvents();
            // Create the database on the instance of SQL Server.
            db = new Database(theLocalSQLServer, whichDataBase);
            db.Create();

        }

        localRepDB.Load();
        localRepDB.EnabledMergePublishing = false;
        localRepDB.CommitPropertyChanges();

        if (!mergeSubscription.LoadProperties())
        {
            CreateMergeSubscription();
        }

    }

    private void LocalDBConn(string databaseName, out Server server, out ReplicationDatabase replicationDatabase, out Database db)
    {
        db = server.Databases[replicationDatabase.Name];
    }

    /// <summary>
    /// Checks for the existince of the Publication.  If there is one it verify's Allow Pull is set
    /// </summary>
    /// <returns>True if Publication is present. False if not.</returns>
    public bool CheckForPublication()
    {
        // If LoadProperties() returns TRUE then the Publication exists and is reachable
        if (mergePublication.LoadProperties())
            return true;

        if ((mergePublication.Attributes & PublicationAttributes.AllowPull) == 0)
        {
            mergePublication.Attributes |= PublicationAttributes.AllowPull;
        }

        return false;
    } // end CheckForPublication()

    /// <summary>
    /// Checks for the existence of a Subscription.
    /// </summary>
    /// <returns>True if a Subscription is present.  False if not</returns>
    public bool CheckForSubscription()
    {
        // Check for the existence of the Subscription
        return mergeSubscription.IsExistingObject;
    } // end CheckForSubscription()
} 
```

## 编辑 1

哎呀，我忘记了具体的错误。打开`server`，`replicationDatabase`我得到一个*“在访问之前可能没有初始化输出参数”*

```
 private void LocalDBConn(string databaseName, out Server server, out ReplicationDatabase replicationDatabase, out Database db)
    {
        db = server.Databases[replicationDatabase.Name];
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T20:35:02.120

```
private void LocalDBConn(string databaseName, out Server server, out ReplicationDatabase replicationDatabase, out Database db)
{
    db = server.Databases[replicationDatabase.Name];
} 
```

此方法不会构建，因为在方法返回之前未初始化[out 参数。](http://msdn.microsoft.com/en-us/library/t3c3bfhx(VS.71).aspx)out 参数允许调用者将未实例化的对象传递给方法，然后该方法必须在返回之前通过所有路径对其进行初始化（不包括该方法抛出异常的情况）。基本上，out 参数是该方法的声明，即“我将在返回之前实例化此对象”。在 LocalDBConn 中，您没有这样做。

在 C# 3.0 语言规范中，这在第 5.1.6 节中有详细说明。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T20:37:22.537

看起来你可以安全地删除输出。

我不确定它是如何编译的，除非它可能是 VS2003 并且编译器没有检查这种类型的错误。

来自 MSDN：虽然作为输出参数传递的变量在传递之前不必初始化，但被调用的方法需要在方法返回之前分配一个值。

```
private void LocalDBConn(string databaseName, Server server, 
      ReplicationDatabase replicationDatabase, out Database db)
{
    db = server.Databases[replicationDatabase.Name];
} 
```

或者

```
private Database LocalDBConn(string databaseName, Server server, 
     ReplicationDatabase replicationDatabase)
{
    return server.Databases[replicationDatabase.Name];
} 
```

然后将 CreateDatabase 中的代码更新为：

```
Database db;
LocalDBConn(whichDataBase, theLocalSQLServer, localRepDB, out db); 
```

或者

```
Database db = LocalDBConn(whichDataBase, theLocalSQLServer, localRepDB); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T20:33:40.203

编译器告诉你的只是 Server 和 ReplicationDatabase 是输出参数，但在从 LocalDBConn 方法返回之前，你没有为它们分配任何东西。

使用 out 参数时，您应该对它们执行空检查，以确保它们已在方法之外初始化，如果没有初始化它们。

# apache - 带有 mod_rewrite 的页面锚？

> ID：941721
> 
> 赞同：1
> 
> 时间：2009-06-02T20:26:27.160
> 
> 标签：apache, mod-rewrite, url-rewriting, apache2, ubuntu-server

我正在尝试在使用 mod_rewrite（在 Ubuntu Server 9.04 上运行的 Apache2）的网站上设置页面锚点。

我的 htaccess 文件如下所示：

```
RewriteEngine On
RewriteRule ^information.php/([A-Za-z0-9-]+)/?$ information.php?display=$1  [NC,NE] 
```

如果我使用常规 URL，查询将如下所示：**[http://mydomain/information.php?display=faq#cost](http://mydomain/information.php?display=faq#cost)**

我希望得到这样的东西： **[http://mydomain/information/faq/cost](http://mydomain/information/faq/cost)**

这可能吗？我的理解是 modrewrite 会忽略页面锚点，而浏览器会处理它吗？我猜我可以以某种方式使用 mod_rewrite 将锚信息包含在请求中，但是我无法找到任何记录这一点的东西，并且我自己尝试编写它几个小时都没有成功。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T21:12:07.303

实际上，如果您希望**生成**的URL 有一个锚点，那么是的，这是可能的。只是不要忘记在 Apache 配置中，# 标记注释的开始。

如果你想要的是这样 - 用户输入

```
http://example.com/page/anchor
```

并被重定向到

```
http://example.com/?p=page#anchor
```

- 你需要使用 301 重定向，或者类似的东西，所以它对用户来说是不透明的。

结论：虽然可以编写这样的重定向规则，但不能完全在服务器端完成。所以我认为你可以指向`/information/faq`然后`/information.php?display=faq`使用 URL，例如：

```
http://example.com/information/faq#foo
```

这几乎是您想要的，而且它们不会弄乱缓存。

（哇，已经午夜了？）

# vbscript - MSXML2.ServerXMLHTTP.4.0 来源？

> ID：941725
> 
> 赞同：5
> 
> 时间：2009-06-02T20:28:28.140
> 
> 标签：vbscript, object, msxml

对象“MSXML2.ServerXMLHTTP.4.0”从何而来？哪个安装包？

我正在尝试执行以下操作：

```
Set oXMLHTTP = CreateObject("MSXML2.ServerXMLHTTP.4.0") 
```

此尝试在我的开发机器上失败（没有返回任何对象），但在我同事的开发机器上成功。显然，他安装了一些我没有安装的东西，反之亦然，但是这个对象、dll 等来自哪里？

我需要安装什么才能让这个电话正常工作？

作为记录，将对象更改为不同版本不是一种选择，因为这依赖的代码已针对此特定版本测试了几天。我们得回去再测试一次...

为了扩展这个问题，我如何知道当前安装了哪个版本的 MS XML？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T21:04:20.517

尝试使用此功能：-

```
Function ProgIDInstalled(progID)
    On Error Resume Next
    Dim o : Set o = CreateObject(progID)
    ProgIDInstalled = Err.Number = 0
End Function

If ProgIDInstalled("MSXML2.DOMDocument.3.0") Then
    ' MSXML3 is present   '
End If

If ProgIDInstalled("MSXML2.DOMDocument.4.0") Then
    ' MSXML4 is present   '
End If

If ProgIDInstalled("MSXML2.DOMDocument.5.0") Then
    ' MSXML5 is present   '
End If

If ProgIDInstalled("MSXML2.DOMDocument.6.0") Then
    ' MSXML6 is present   '
End If 
```

令我惊讶的是，即使是现在，针对 4.0 版本仍有新的发展。Microsoft 现在只修补 3.0 版和 6.0 版 MSXML 内核。

我知道现在为时已晚，但实际上您应该使用 3.0，它的优势在于它在当前支持的所有 Windows 平台上无处不在，因此您根本不需要考虑安装它。或者使用 6.0，因为您需要包含 MSXML 的分发，它也可能是 6，因为这是最新的，并且 4 和 5 都没有获得任何安全补丁。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-04-21T05:08:22.257

请注意，[MSXML 4.0 SP2 已终止支持](http://blogs.msdn.com/xmlteam/archive/2010/03/30/msxml4-0-sp2-is-going-out-of-support-in-april-2010.aspx)。您应该迁移到 MSXML 6.0 以获得最佳支持和增强功能，或者回退到旧系统的[MSXML 4.0 SP3](http://www.microsoft.com/downloads/details.aspx?FamilyID=7F6C0CB4-7A5E-4790-A7CF-9E139E6819C0&displaylang=en)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-06T17:45:39.977

它们都可以同时安装。在 Windows/system32/msxml(ver).dll 下查看。

如果您的意思是注册了哪个版本，请看这里：

[http://support.microsoft.com/kb/278674](http://support.microsoft.com/kb/278674)

当然，您可以像任何其他 dll 一样注册/取消注册。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T20:37:41.130

我安装了：[MSXML 4.0 SP2](http://www.microsoft.com/downloads/details.aspx?familyid=3144b72b-b4f2-46da-b4b6-c5d7485f2b42&displaylang=en)，它解决了我的问题。

虽然这只回答了我的部分问题：安装哪个版本。我仍然想知道如何识别系统上安装了哪个版本的 MS XML。

[http://www.microsoft.com/downloads/details.aspx?familyid=3144b72b-b4f2-46da-b4b6-c5d7485f2b42&displaylang=en](http://www.microsoft.com/downloads/details.aspx?familyid=3144b72b-b4f2-46da-b4b6-c5d7485f2b42&displaylang=en)

# asp.net-mvc - ASP.NET MVC 模型和业务对象

> ID：941731
> 
> 赞同：0
> 
> 时间：2009-06-02T20:28:51.430
> 
> 标签：asp.net-mvc, linq-to-sql, architecture, model

我正在寻找一些关于如何将业务规则合并到 asp.net mvc 应用程序以及它们如何与模型相关的指导。

首先有一点背景，所以我们知道什么样的解决方案是相对于这个问题的。在工作中，我们使用 WinForms、MVP、BusinessObjects、DataAccessObjects 和 DataTransferObjects。层的边界使用 DTO 将参数发送到方法并作为返回类型，或返回列表类型。

现在我们正在添加一个外观层来将 DTO 转换为域对象以供 UI 使用，因为架构师不喜欢在 PresentationLayer 中使用 DTO 目前的工作方式。除了实用与否之外，我在理论上对所有这些都感到满意。

我制作一个网站是为了好玩，但出于考虑，可以说它提供的流量与 SO 相同，就像我上次听说的每月 60,000 次点击一样。我对控制器和视图的机制以及模型如何与两者集成感到满意。

我使用 NerdDinner 作为构建站点的示例，并遵循示例中的存储库模式实现。我没有得到的是如何将业务对象合并到组合中。

我听说人们将 LINQ 称为 DataAccessLayer/DataAccessObjects。如果我像我习惯的那样通过业务对象强制我的所有请求，我已经引入了一些奇怪的依赖关系。我的 UI 和我的 BO 都必须了解我的 DAO。

有意义的是将 LINQ 类用作真正的 DAO 层，将其隐藏在 BO 后面，并在 POCO 和 LINQ 对象之间进行 BO 转换。

我唯一担心的是我可以很好地将我的 UI 绑定到 LINQ 类，并且真的不需要所有额外的工作，我对 NerdDinner 中的轻量级方法感到满意。

所以我本质上是在控制器中实例化的存储库，它接受和返回 LINQ 对象。我的业务对象有静态方法，它们只接受 LINQ 类并执行一些计算，比如应用某个州的税 % 或 w/e。

由于许多这些计算必须在存储库的结果中完成，我正在考虑将它们组合到一个中心区域，如外观层，但它只是对数据进行转换而不转换为其他对象集（DomainObjects <-> DTO）。

我应该这样做，还是应该说这些业务方法确实是我的模型的一部分，并且它们应该在返回对象的存储库方法中？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-02T20:41:56.707

从设计的角度来看，我会这样设计它。当然命名只是为了这篇文章的目的，你不必命名你的 DAL 和 BLL ..Repository 和 ..Service。

拥有应该进行数据访问/查询的存储库（或一个）。理想情况下，它应该只包含查询（编译或未编译）。我个人对每种数据类型都有一个存储库，以帮助保持查询分离。

下一层应该是你的业务层，我喜欢称之为服务。这些类负责所有关于验证、准备步骤和任何其他需要完成的逻辑，以使服务的使用者获得所需的信息。与 ASP.NET MVC 应用程序一样，我的服务返回视图模型，然后直接将其传递到强类型视图中。对于我的服务，我通常将它们逻辑地组合在一起，而不是为每种数据类型一个。

这是一个很棒的设计，因为它使您的数据访问代码和表示代码保持美观和精简，并且大多数可能出错的逻辑都在您的服务（或业务）层中。

# regex - 需要贪婪量词的帮助

> ID：941740
> 
> 赞同：0
> 
> 时间：2009-06-02T20:29:57.013
> 
> 标签：regex, perl, greedy

我正在 Perl 中进行简单的搜索和替换，但我需要一些帮助。这些是文件中的行：

```
1001(seperator could be "anything")john-1001(seperator could be "anything")mark
1001(seperator could be "anything")mark-1001(seperator could be "anything")john 
```

我想为 john 分配一个新的用户 ID，比如 2001。所以这就是我想要的结果：

```
2001($1)john-1001-mark
1001-mark-2001($1)john 
```

当 john 是第一个时，我的正则表达式工作正常，但是当 mark 是第一个时，它就搞砸了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T20:41:38.470

如果不知道分隔符可以是什么——哪些字符、多少个字符等，几乎不可能回答这个问题。非贪婪的任意分隔符如下所示：

```
s/\b1001\b(?=.*?\bjohn\b)/2001/ 
```

当匹配最小数量的中间字符时，这将替换“1001”后跟“john”。`.*?`是 的非贪婪版本`.*`。但是，如果可能，正则表达式总是匹配，所以它仍然匹配

```
1001-mark-1001-john 
```

换句话说，这不仅仅是一个贪婪问题。我们需要至少定义以下三件事之一：

*   分隔符可以包含的字符。
*   分隔符*不能*包含的字符。
*   分隔符中的字符数。

如果我们假设分隔符不能包含“单词”字符（az、0-9 和下划线），我们可以得到一些可行的东西：

```
s/\b1001\b(?=\W+?\bjohn\b)/2001/ 
```

已知部分（“1001”和“john”）是有界的，以防止它们将其他字符串与这些子字符串匹配。（感谢 Chas 注意到这种极端情况。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-02T20:43:12.900

尝试这个：

```
#!/usr/bin/perl

use strict;
use warnings;

while (<DATA>) {
    s/\b1001-john\b/2001-john/;
    print;
}

__DATA__
1001-john-1001-mark
1001-mark-1001-john
11001-john
1001-johnny 
```

阻止它`\b`匹配除`"1001-john"`. 有关详细信息，请参阅的“断言”部分[`perldoc perlre`](http://perldoc.perl.org/perlre.html)。

* * *

嗯，听起来你需要一个[sexeger](http://japhy.perlmonk.org/sexeger/sexeger.html)：

```
#!/usr/bin/perl

use strict;
use warnings;

while (<DATA>) {
    my $s = reverse;
    $s =~ s/\bnhoj(.*?)1001\b/nhoj${1}1002/;
    $s = reverse $s;
    print $s;
}

__DATA__
1001-john-1001-mark
1001-mark-1001-john
11001-john
1001-johnny 
```

sexeger 的基本思想是反转字符串，使用反转的正则表达式，然后反转结果。问题在于，它`.*?`为您提供了第一次匹配的最短字符串，而不是最短的可能字符串。当然这仍然会有问题`"1001-mark-2001-john"`as the `.*?`will match `"-mark-2001-"`。确定文件格式并对其进行解析可能比尝试使用正则表达式更好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T20:47:52.607

我从您的评论中猜测分隔符并不总是连字符，实际上可以是多个字符。

对于这种情况，请尝试：

```
s/\d+([^\d]*)john/2001$1john/ 
```

这将在替换过程中保持“1001”和“john”之间的分隔符完好无损。请注意，分隔符中不允许有数字，因此即使在“mark”之后出现“john”也可以使用（因为“-mark-1001-”不是有效的分隔符）。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-06-02T20:44:19.183

它可能是这样的

```
$s = '1001-mark-1001-john';
$s =~ s/(\d+)(-john)/2001$2/i;
print $s; 
```

# php - PHP中的键盘输入

> ID：941744
> 
> 赞同：2
> 
> 时间：2009-06-02T20:30:39.337
> 
> 标签：php, keyboard-events

我正在尝试通过键盘输入来控制 PHP 的内容。我目前检测击键的方式是：

```
 function read() {
    $fp1=fopen("/dev/stdin", "r");
    $input=fgets($fp1, 255);
    fclose($fp1);

    return $input;
}
print("What is your first name? ");
    $first_name = read(); 
```

问题是它没有“实时”读取击键。我不知道使用这种方法是否可行，我想这也不是最有效的方法。我的问题是 1）如果这是一种好方法，那么我怎样才能让它工作，以便当您在页面上键入时，它会捕获击键，以及 2）如果这是一种不好的方法，我怎样才能更好地实现它（也许使用ajax或其他东西）？

编辑：我使用 PHP 作为网页，而不是命令行。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T20:33:49.580

我假设您使用 PHP 作为 Web 脚本语言（而不是从命令行）...

从我所见，您将希望在客户端使用 Javascript 来读取关键输入。一旦服务器将页面交付给客户端，就没有 PHP 交互。因此，使用 AJAX 读取客户端密钥输入并调用回服务器是可行的方法。

[这里](http://www.javascriptkit.com/javatutors/javascriptkey.shtml)有一些关于 Javascript 和检测按键的更多信息，还有一些关于如何使用 AJAX[的信息](http://docs.jquery.com/Ajax/load#urldatacallback)。

jQuery 的一个很好的选择是使用延迟观察者之类的[东西](http://code.google.com/p/jquery-utils/wiki/DelayedObserver)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-02T20:52:52.927

如果您正在编写 CLI 应用程序（而不是 Web 应用程序），则可以使用[ncurses 的 getch()](http://www.php.net/manual/en/function.ncurses-getch.php)函数来获得单次击键。祝你好运！

如果您不是在编写 CLI 应用程序，我建议您遵循 Andrew 的回答。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2009-06-02T20:43:34.723

尝试阅读线：

[http://us3.php.net/manual/en/function.readline.php](http://us3.php.net/manual/en/function.readline.php)

# java - 如何获取 Java JAR 文件中资源的路径

> ID：941754
> 
> 赞同：181
> 
> 时间：2009-06-02T20:32:46.680
> 
> 标签：java, resources, path

我正在尝试获取资源的路径，但我没有运气。

这有效（在 IDE 和 JAR 中），但这样我无法获得文件的路径，只有文件内容：

```
ClassLoader classLoader = getClass().getClassLoader();
PrintInputStream(classLoader.getResourceAsStream("config/netclient.p")); 
```

如果我这样做：

```
ClassLoader classLoader = getClass().getClassLoader();
File file = new File(classLoader.getResource("config/netclient.p").getFile()); 
```

结果是： `java.io.FileNotFoundException: file:/path/to/jarfile/bot.jar!/config/netclient.p (No such file or directory)`

有没有办法获取资源文件的路径？

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2009-06-02T20:39:35.557

这是故意的。“文件”的内容可能无法作为文件使用。请记住，您正在处理可能是 JAR 文件或其他类型资源的一部分的类和资源。类加载器不必为资源提供文件句柄，例如 jar 文件可能尚未扩展为文件系统中的单个文件。

如果 java.io.File 是绝对必要的，则可以通过将流复制到临时文件中并执行相同操作来完成通过获取 java.io.File 所做的任何事情。

* * *

## 回答 #2

> 赞同：71
> 
> 时间：2013-01-30T19:58:03.593

加载资源时，请确保您注意到以下之间的区别：

```
getClass().getClassLoader().getResource("com/myorg/foo.jpg") //relative path 
```

和

```
getClass().getResource("/com/myorg/foo.jpg")); //note the slash at the beginning 
```

我想，这种混乱是加载资源时导致大多数问题的原因。

* * *

此外，当您加载图像时，它更易于使用`getResourceAsStream()`：

```
BufferedImage image = ImageIO.read(getClass().getResourceAsStream("/com/myorg/foo.jpg")); 
```

当您确实需要从 JAR 存档中加载（非图像）文件时，您可以尝试以下操作：

```
File file = null;
String resource = "/com/myorg/foo.xml";
URL res = getClass().getResource(resource);
if (res.getProtocol().equals("jar")) {
    try {
        InputStream input = getClass().getResourceAsStream(resource);
        file = File.createTempFile("tempfile", ".tmp");
        OutputStream out = new FileOutputStream(file);
        int read;
        byte[] bytes = new byte[1024];

        while ((read = input.read(bytes)) != -1) {
            out.write(bytes, 0, read);
        }
        out.close();
        file.deleteOnExit();
    } catch (IOException ex) {
        Exceptions.printStackTrace(ex);
    }
} else {
    //this will probably work in your IDE, but not from a JAR
    file = new File(res.getFile());
}

if (file != null && !file.exists()) {
    throw new RuntimeException("Error: File " + file + " not found!");
} 
```

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2014-11-26T12:29:37.563

单行答案是-

```
String path = this.getClass().getClassLoader().getResource(<resourceFileName>).toExternalForm() 
```

基本上[`getResource`](https://docs.oracle.com/javase/8/docs/api/java/lang/Class.html#getResource-java.lang.String-)方法给出了 URL。从此 URL 中，您可以通过调用来提取路径[`toExternalForm()`](https://docs.oracle.com/javase/8/docs/api/java/net/URL.html#toExternalForm--)。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2011-03-17T22:24:20.270

我花了一段时间来解决这个问题，因为我发现没有真正有效的解决方案，很奇怪！工作目录通常不是 JAR 的目录，特别是如果 JAR（或任何程序，就此而言）是从 Windows 下的开始菜单运行的。所以这就是我所做的，它适用于从 JAR 外部运行的 .class 文件，就像它适用于 JAR 一样。（我只在 Windows 7 下测试过。）

```
try {
    //Attempt to get the path of the actual JAR file, because the working directory is frequently not where the file is.
    //Example: file:/D:/all/Java/TitanWaterworks/TitanWaterworks-en.jar!/TitanWaterworks.class
    //Another example: /D:/all/Java/TitanWaterworks/TitanWaterworks.class
    PROGRAM_DIRECTORY = getClass().getClassLoader().getResource("TitanWaterworks.class").getPath(); // Gets the path of the class or jar.

    //Find the last ! and cut it off at that location. If this isn't being run from a jar, there is no !, so it'll cause an exception, which is fine.
    try {
        PROGRAM_DIRECTORY = PROGRAM_DIRECTORY.substring(0, PROGRAM_DIRECTORY.lastIndexOf('!'));
    } catch (Exception e) { }

    //Find the last / and cut it off at that location.
    PROGRAM_DIRECTORY = PROGRAM_DIRECTORY.substring(0, PROGRAM_DIRECTORY.lastIndexOf('/') + 1);
    //If it starts with /, cut it off.
    if (PROGRAM_DIRECTORY.startsWith("/")) PROGRAM_DIRECTORY = PROGRAM_DIRECTORY.substring(1, PROGRAM_DIRECTORY.length());
    //If it starts with file:/, cut that off, too.
    if (PROGRAM_DIRECTORY.startsWith("file:/")) PROGRAM_DIRECTORY = PROGRAM_DIRECTORY.substring(6, PROGRAM_DIRECTORY.length());
} catch (Exception e) {
    PROGRAM_DIRECTORY = ""; //Current working directory instead.
} 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-06-02T20:43:43.520

如果`netclient.p`在 JAR 文件中，则它没有路径，因为该文件位于其他文件中。在这种情况下，您可以拥有的最佳路径是真的`file:/path/to/jarfile/bot.jar!/config/netclient.p`.

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2015-02-25T18:31:22.237

这是来自用户 Tombart 的相同代码，带有流刷新和关闭，以避免从 jar 资源复制不完整的临时文件内容并具有唯一的临时文件名。

```
File file = null;
String resource = "/view/Trial_main.html" ;
URL res = getClass().getResource(resource);
if (res.toString().startsWith("jar:")) {
    try {
        InputStream input = getClass().getResourceAsStream(resource);
        file = File.createTempFile(new Date().getTime()+"", ".html");
        OutputStream out = new FileOutputStream(file);
        int read;
        byte[] bytes = new byte[1024];

        while ((read = input.read(bytes)) != -1) {
            out.write(bytes, 0, read);
        }
        out.flush();
        out.close();
        input.close();
        file.deleteOnExit();
    } catch (IOException ex) {
        ex.printStackTrace();
    }
} else {
    //this will probably work in your IDE, but not from a JAR
    file = new File(res.getFile());
} 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2010-12-29T17:09:28.837

您需要了解 jar 文件中的路径。
简单地引用它相对。因此，如果您有一个文件（myfile.txt），位于 foo.jar`\src\main\resources`目录下（maven 样式）。你会这样称呼它：

```
src/main/resources/myfile.txt 
```

如果您使用转储 jar，`jar -tvf myjar.jar` 您将看到 jar 文件中的输出和相对路径，并使用 FORWARD SLASHES。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2017-03-02T14:07:43.687

在我的例子中，我使用了 URL 对象而不是 Path。

**文件**

```
File file = new File("my_path");
URL url = file.toURI().toURL(); 
```

**使用类加载器的类路径中的资源**

```
URL url = MyClass.class.getClassLoader().getResource("resource_name") 
```

当我需要阅读内容时，可以使用以下代码：

```
InputStream stream = url.openStream(); 
```

您可以使用 InputStream 访问内容。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-06-02T20:44:28.903

文件是文件系统中文件的抽象，文件系统对 JAR 的内容一无所知。

尝试使用 URI，我认为有一个 jar:// 协议可能对您的目的有用。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2020-07-13T14:53:23.663

跟随代码！

# /src/main/资源/文件

```
streamToFile(getClass().getClassLoader().getResourceAsStream("file"))

public static File streamToFile(InputStream in) {
    if (in == null) {
        return null;
    }

    try {
        File f = File.createTempFile(String.valueOf(in.hashCode()), ".tmp");
        f.deleteOnExit();

        FileOutputStream out = new FileOutputStream(f);
        byte[] buffer = new byte[1024];

        int bytesRead;
        while ((bytesRead = in.read(buffer)) != -1) {
            out.write(buffer, 0, bytesRead);
        }

        return f;
    } catch (IOException e) {
        LOGGER.error(e.getMessage(), e);
        return null;
    }
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-07-21T16:24:26.507

以下路径对我有用：`classpath:/path/to/resource/in/jar`

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2014-04-14T04:42:51.807

```
private static final String FILE_LOCATION = "com/input/file/somefile.txt";

//Method Body

InputStream invalidCharacterInputStream = URLClassLoader.getSystemResourceAsStream(FILE_LOCATION); 
```

从中获得这个**`getSystemResourceAsStream`**是最好的选择。通过获取输入流而不是文件或 URL，可以在 JAR 文件中独立运行。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2018-11-16T23:25:20.133

可能有点晚了，但您可以使用我的库[KResourceLoader](https://github.com/lamba92/KResourceLoader)从您的 jar 中获取资源：

```
File resource = getResource("file.txt") 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-02-16T16:55:42.033

在`jar`文件中时，资源绝对位于包层次结构（而不​​是文件系统层次结构）中。因此，如果您有类`com.example.Sweet`加载名为`./default.conf`的资源，则资源的名称指定为`/com/example/default.conf`.

但如果它在一个罐子里，那么它就不是一个文件......

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2017-10-20T09:00:20.137

在你的 jar 的 ressources 文件夹（java/main/resources）中添加你的文件（我们假设你已经添加了一个名为***imports.xml***`ResourceLoader`的 xml 文件），然后如果你像下面这样使用 spring 则注入

```
@Autowired
private ResourceLoader resourceLoader; 
```

内部游览功能编写波纹管代码以加载文件：

```
 Resource resource = resourceLoader.getResource("classpath:imports.xml");
    try{
        File file;
        file = resource.getFile();//will load the file
...
    }catch(IOException e){e.printStackTrace();} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2019-01-11T08:41:13.567

也许这种方法可以用于快速解决。

```
public class TestUtility
{ 
    public static File getInternalResource(String relativePath)
    {
        File resourceFile = null;
        URL location = TestUtility.class.getProtectionDomain().getCodeSource().getLocation();
        String codeLocation = location.toString();
        try{
            if (codeLocation.endsWith(".jar"){
                //Call from jar
                Path path = Paths.get(location.toURI()).resolve("../classes/" + relativePath).normalize();
                resourceFile = path.toFile();
            }else{
                //Call from IDE
                resourceFile = new File(TestUtility.class.getClassLoader().getResource(relativePath).getPath());
            }
        }catch(URISyntaxException ex){
            ex.printStackTrace();
        }
        return resourceFile;
    }
} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-11-11T12:05:45.847

这个 Class 函数可以通过 .jar 文件中的相对文件路径获取绝对文件路径。

```
 public class Utility {

    public static void main(String[] args) throws Exception {
        Utility utility = new Utility();
        String absolutePath = utility.getAbsolutePath("./absolute/path/to/file");
    }

    public String getAbsolutePath(String relativeFilePath) throws IOException {
        URL url = this.getClass().getResource(relativeFilePath);
        return url.getPath();
    }
} 
```

如果目标文件与 相同的目录`Utility.java`，您的输入将是`./file.txt`.

当您仅`/`在 getAbsolutePath() 上输入时，它会返回`/Users/user/PROJECT_NAME/target/classes/`. 这意味着您可以像这样选择文件`/com/example/file.txt`。

# sql-server - 列出 SQL Server 上运行的查询

> ID：941763
> 
> 赞同：222
> 
> 时间：2009-06-02T20:35:31.650
> 
> 标签：sql-server

有没有办法列出当前在 MS SQL Server 上运行的查询（通过企业管理器或 SQL）和/或谁已连接？

我想我有一个运行很长时间的查询正在我的一个数据库服务器上执行，我想跟踪它并停止它（或继续启动它的人）。

* * *

## 回答 #1

> 赞同：226
> 
> 时间：2009-06-05T13:24:28.877

这将显示 SQL 2000 或 SQL 2005 服务器上运行时间最长的 SPID：

```
select
    P.spid
,   right(convert(varchar, 
            dateadd(ms, datediff(ms, P.last_batch, getdate()), '1900-01-01'), 
            121), 12) as 'batch_duration'
,   P.program_name
,   P.hostname
,   P.loginame
from master.dbo.sysprocesses P
where P.spid > 50
and      P.status not in ('background', 'sleeping')
and      P.cmd not in ('AWAITING COMMAND'
                    ,'MIRROR HANDLER'
                    ,'LAZY WRITER'
                    ,'CHECKPOINT SLEEP'
                    ,'RA MANAGER')
order by batch_duration desc 
```

如果您需要从结果中查看为给定 spid 运行的 SQL，请使用以下内容：

```
declare
    @spid int
,   @stmt_start int
,   @stmt_end int
,   @sql_handle binary(20)

set @spid = XXX -- Fill this in

select  top 1
    @sql_handle = sql_handle
,   @stmt_start = case stmt_start when 0 then 0 else stmt_start / 2 end
,   @stmt_end = case stmt_end when -1 then -1 else stmt_end / 2 end
from    sys.sysprocesses
where   spid = @spid
order by ecid

SELECT
    SUBSTRING(  text,
            COALESCE(NULLIF(@stmt_start, 0), 1),
            CASE @stmt_end
                WHEN -1
                    THEN DATALENGTH(text)
                ELSE
                    (@stmt_end - @stmt_start)
                END
        )
FROM ::fn_get_sql(@sql_handle) 
```

* * *

## 回答 #2

> 赞同：101
> 
> 时间：2009-06-02T20:48:06.943

如果您运行的是 SQL Server 2005 或 2008，则可以使用 DMV 来找到这个...

```
SELECT  *
FROM    sys.dm_exec_requests  
        CROSS APPLY sys.dm_exec_sql_text(sql_handle) 
```

*   更多关于[sys.dm_exec_requests](http://msdn.microsoft.com/en-us/library/ms177648.aspx)
*   更多关于[sys.dm_exec_sql_text](http://msdn.microsoft.com/en-us/library/ms181929.aspx)

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2009-06-02T20:37:49.150

您可以运行[sp_who](http://msdn.microsoft.com/en-us/library/ms174313.aspx)命令来获取所有当前用户、会话和进程的列表。然后，您可以在阻止其他人的任何 spid 上运行[KILL命令。](http://msdn.microsoft.com/en-us/library/ms173730.aspx)

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2012-06-18T22:10:09.273

我建议查询`sys`意见。类似于

```
SELECT * 
FROM 
   sys.dm_exec_sessions s
   LEFT  JOIN sys.dm_exec_connections c
        ON  s.session_id = c.session_id
   LEFT JOIN sys.dm_db_task_space_usage tsu
        ON  tsu.session_id = s.session_id
   LEFT JOIN sys.dm_os_tasks t
        ON  t.session_id = tsu.session_id
        AND t.request_id = tsu.request_id
   LEFT JOIN sys.dm_exec_requests r
        ON  r.session_id = tsu.session_id
        AND r.request_id = tsu.request_id
   OUTER APPLY sys.dm_exec_sql_text(r.sql_handle) TSQL 
```

通过这种方式，您可以获得一个`TotalPagesAllocated`可以帮助您确定`spid`占用所有服务器资源的内容。有很多时候我什至无法调出活动监视器并使用这些`sys`视图来查看发生了什么。

我建议您阅读以下文章。[我从这里得到了这个参考](http://tsqltips.blogspot.com/2012/06/monitor-current-sql-server-processes.html)。

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2009-06-02T20:43:42.930

产品中内置了各种管理视图。在 SQL 2000 上，您将使用[sysprocesses](http://msdn.microsoft.com/en-us/library/aa260456(SQL.80).aspx)。在 SQL 2K5 上有更多视图，如[sys.dm_exec_connections](http://msdn.microsoft.com/en-us/library/ms181509.aspx)、[sys.dm_exec_sessions](http://msdn.microsoft.com/en-us/library/ms176013.aspx)和[sys.dm_exec_requests](http://msdn.microsoft.com/en-us/library/ms177648.aspx)。

还有像[sp_who](http://msdn.microsoft.com/en-us/library/aa260384(SQL.80).aspx)这样的过程利用这些视图。在 2K5 [Management Studio](http://msdn.microsoft.com/en-us/library/ms175518.aspx)中，您还可以获得活动监视器。

最后但并非最不重要的还有社区贡献的脚本，例如[Adam Machanic 的 Who Is Active](http://sqlblog.com/blogs/adam_machanic/archive/2009/03/30/who-is-active-v8-40-now-with-delta-power.aspx)。

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2016-02-09T23:32:42.367

请注意，可以通过右键单击当前服务器并转到上下文菜单中的“活动监视器”来找到 SQL Server 2008 的 SQL Server 活动监视器。如果您使用的是 SQL Server Management Studio，我发现这是杀死进程的最简单方法。

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2009-06-02T20:43:40.213

实际上，`EXEC sp_who2`在 Query Analyzer / Management Studio 中运行提供的信息比`sp_who`.

除此之外，您可以设置 SQL Profiler 来监视服务器的所有进出流量。Profiler 还可以让您准确地缩小您正在观看的内容。

对于 SQL Server 2008：

```
START - All Programs - Microsoft SQL Server 2008 - Performance Tools - SQL Server Profiler 
```

请记住，分析器确实是一个日志记录和观察应用程序。只要它正在运行，它将继续记录和观察。它可能会填满文本文件或数据库或硬盘驱动器，因此请注意您观看的内容和观看时间。

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2014-01-28T20:47:05.647

```
SELECT
    p.spid, p.status, p.hostname, p.loginame, p.cpu, r.start_time, r.command,
    p.program_name, text 
FROM
    sys.dm_exec_requests AS r,
    master.dbo.sysprocesses AS p 
    CROSS APPLY sys.dm_exec_sql_text(p.sql_handle)
WHERE
    p.status NOT IN ('sleeping', 'background') 
AND r.session_id = p.spid 
```

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2009-06-02T20:51:41.510

在对象资源管理器中，向下钻取到：服务器 -> 管理 -> 活动监视器。这将允许您查看到当前服务器的所有连接。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2018-07-14T06:09:25.907

试试这个：

它将为您提供所有用户查询。直到 spid 50，都是 sql server 内部进程会话。但是，如果您愿意，可以删除 where 子句：

```
select
r.session_id,
r.start_time,
s.login_name,
c.client_net_address,
s.host_name,
s.program_name,
st.text
from sys.dm_exec_requests r
inner join sys.dm_exec_sessions s
on r.session_id = s.session_id
left join sys.dm_exec_connections c
on r.session_id = c.session_id
outer apply sys.dm_exec_sql_text(r.sql_handle) st where r.session_id  > 50 
```

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2009-06-02T20:41:49.330

这是一个查询，它将显示任何阻塞的查询。我不完全确定它是否只会显示缓慢的查询：

```
SELECT p.spid
,convert(char(12), d.name) db_name
, program_name
, convert(char(12), l.name) login_name
, convert(char(12), hostname) hostname
, cmd
, p.status
, p.blocked
, login_time
, last_batch
, p.spid
FROM      master..sysprocesses p
JOIN      master..sysdatabases d ON p.dbid =  d.dbid
JOIN      master..syslogins l ON p.sid = l.sid
WHERE     p.blocked = 0
AND       EXISTS (  SELECT 1
          FROM      master..sysprocesses p2
          WHERE     p2.blocked = p.spid ) 
```

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2015-02-12T20:20:26.993

正确的脚本应该是这样的：

```
select 
p.spid, p.status,p.hostname,p.loginame,p.cpu,r.start_time, t.text
    from sys.dm_exec_requests as r, sys.sysprocesses p 
    cross apply sys.dm_exec_sql_text(p.sql_handle) t
    where p.status not in ('sleeping', 'background')
    and r.session_id=p.spid 
```

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2015-07-27T11:22:52.580

您可以使用以下查询来查找运行的最后一个请求：

```
SELECT
    der.session_id
    ,est.TEXT AS QueryText
    ,der.status
    ,der.blocking_session_id
    ,der.cpu_time
    ,der.total_elapsed_time
FROM sys.dm_exec_requests AS der
CROSS APPLY sys.dm_exec_sql_text(sql_handle) AS est 
```

使用下面的脚本，您还可以找到每个数据库的连接数：

```
SELECT 
    DB_NAME(DBID) AS DataBaseName
    ,COUNT(DBID) AS NumberOfConnections
    ,LogiName 
FROM sys.sysprocesses
WHERE DBID > 0
GROUP BY DBID, LogiName 
```

更多详情请访问： [http ://www.dbrnd.com/2015/06/script-to-find-running-process-session-logged-user-in-sql-server/](http://www.dbrnd.com/2015/06/script-to-find-running-process-session-logged-user-in-sql-server/)

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2009-06-02T20:41:41.653

在 2005 年，您可以右键单击数据库，转到报告，并且有关于转换和锁定等的完整报告列表...

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2012-10-24T12:48:34.093

```
SELECT 
    p.spid, p.status, p.hostname, p.loginame, p.cpu, r.start_time, t.text
FROM
    sys.dm_exec_requests as r,
    master.dbo.sysprocesses as p
    CROSS APPLY sys.dm_exec_sql_text(p.sql_handle) t
WHERE
    p.status NOT IN ('sleeping', 'background')
AND r.session_id = p.spid 
```

和

```
KILL @spid 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2009-06-02T20:39:05.620

使用 Sql Server Profiler（工具菜单）来监控正在执行的查询，并使用 Management Studio 中的活动监视器来查看连接方式以及它们的连接是否阻塞了其他连接。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2017-03-28T13:58:55.653

您应该尝试非常有用的程序`sp_whoIsActive`，可以在这里找到：[http](http://whoisactive.com) ://whoisactive.com ，它是免费的。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2022-02-11T14:10:38.570

试图把东西放在一起（希望有帮助）：

```
SELECT
    p.spid,
    RIGHT(CONVERT(varchar, DATEADD(ms, DATEDIFF(ms, p.last_batch, GETDATE()), '1900-01-01'), 121), 12) AS [batch_duration],
    p.[program_name],
    p.hostname,
    MAX(p.loginame) AS loginame,
    (SELECT SUBSTRING(text, COALESCE(NULLIF(spid.stmt_start, 0), 1) + 1, CASE spid.stmt_end WHEN -1 THEN DATALENGTH(text) ELSE (spid.stmt_end - spid.stmt_start) END) FROM ::fn_get_sql(spid.[sql_handle])) AS [sql]
FROM
    master.dbo.sysprocesses p
    LEFT JOIN (
        SELECT
            ROW_NUMBER() OVER(PARTITION BY spid ORDER BY ecid) AS i,
            spid,
            [sql_handle],
            CASE stmt_start WHEN 0 THEN 0 ELSE stmt_start / 2 END AS stmt_start,
            CASE stmt_end WHEN -1 THEN -1 ELSE stmt_end / 2 END AS stmt_end
        FROM sys.sysprocesses
    ) spid ON p.spid = spid.spid AND spid.i = 1
WHERE
    p.spid > 50
    AND p.status NOT IN ('background', 'sleeping')
    AND p.cmd NOT IN ('AWAITING COMMAND', 'MIRROR HANDLER', 'LAZY WRITER', 'CHECKPOINT SLEEP', 'RA MANAGER')
GROUP BY
    p.spid,
    p.last_batch,
    p.[program_name],
    p.hostname,
    spid.stmt_start,
    spid.stmt_end,
    spid.[sql_handle]
ORDER BY
    batch_duration DESC,
    p.spid
; 
```

# php - 不显示解析错误

> ID：941766
> 
> 赞同：22
> 
> 时间：2009-06-02T20:36:37.450
> 
> 标签：php, iis-6, error-reporting

我希望 PHP 在屏幕上显示解析错误。我得到的是一个空白页。没有任何内容被写入服务器的错误日志文件。

我的设置：PHP5.2.9/ **IIS 6**（不是 Apache！）。

我的 PHP.INI：

```
error_reporting=E_STRICT
display_errors = On
display_startup_errors = On
log_errors = On
error_log = "C:\Program Files\Zend\ZendServer\logs\php_error.log" 
```

如何在屏幕上记录或显示解析或致命错误？

谢谢， Temuri

**更新**：使用不同的开关后，它看起来是一个 IIS 特定的问题。有什么想法吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-02T21:39:46.093

在 php 文件本身中设置错误级别并不能解决这里的问题，因为文件本身无法解析！

您需要更改 php.ini 中的 error_reporting 行，如下所示：

```
error_reporting = E_ALL 
```

顺便说一句：在 php.ini 文件中有一些关于如何显示哪种类型的错误消息的示例。

祝你好运，

麦克莫兹

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-02T20:40:37.007

Apache 也不总是喜欢报告解析错误。从命令行，运行

```
php -l <file> 
```

-l 开关告诉 PHP 检查文件语法。请参阅手册页。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-02T23:00:47.443

`E_STRICT`不包含在`E_ALL`（直到 PHP 6）。如果你想继续获得`E_STRICT`

在 php.ini 中：

```
error_reporting = E_ALL | E_STRICT 
```

在运行时：

```
error_reporting( E_ALL | E_STRICT ); 
```

您需要在 php.ini 中设置错误报告级别（和[display_errors](http://us3.php.net/manual/en/errorfunc.configuration.php#ini.display-errors)）以查看语法错误。如果 PHP 遇到语法错误，运行时不会被执行，因此在运行时设置将不起作用。（见`display_errors`链接。）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-01-02T07:51:25.980

您可以在终端中使用此命令验证脚本语法：

```
php -l path/to/file.php 
```

就个人而言，我将此行添加到我的`~/.bash_profile`文件中，以便我可以轻松地`php -l`在当前工作目录中的所有文件上运行：

```
phpl() { for i in *.php; do php -l $i; done } 
```

如果你真的是铁杆，你甚至可以从命令行运行你的应用程序。您将有更好的机会看到编译时错误，这有点酷。

您可以使用 $argv 变量来获取第一个参数 $argv[1]，然后将其用作请求。

```
<?php
// show those errors!
error_reporting(E_ALL | E_STRICT);
ini_set('display_errors', 1);

// simulate a web server request
$request = '/' . isset($argv[1]) ? ltrim($argv[1], '/') : '/';
$_SERVER['PATH_INFO'] = $_SERVER['REQUEST_URI'] = $request; 
```

然后你可以通过命令行运行你的脚本。这相当于访问： *your-webapp.com/request/uri/here*

```
php /path/to/script.php request/uri/here 
```

这是通过命令行运行 CodeIgniter 的更全面的示例。它也应该适用于许多其他框架： http: [//phpstarter.net/2008/12/run-codeigniter-from-the-command-line-ssh/](http://phpstarter.net/2008/12/run-codeigniter-from-the-command-line-ssh/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-20T11:45:36.960

正如 Rasmus Lerdorf 建议的那样，始终在开发服务器上使用 error_reporting(-1)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-08-08T13:43:39.293

如果您正在使用 Zend Framework (v1) 并且正在使用 Autoloader，则以下代码将防止显示解析错误：

`self::$Autoloader->suppressNotFoundWarnings(true);`

有关详细信息，请参阅以下答案：

[使用 Zend 框架时显示 php 错误](https://stackoverflow.com/questions/1201709/display-php-errors-when-using-zend-framework#1201752)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-06-04T04:29:01.453

Re: php死机黑屏死机，我发现那个设置

php_value error_reporting "E_ALL" 或 php_value error_reporting 8192

在我的 Windows 7 上的 .htaccess 中，带有 apache 2.2.4 和 php 5.3.13 的 Wampserver 是获得空白 php 错误屏幕的肯定方法——今天，2014 年 6 月 3 日。这些 htaccess 行确实在 phpinfo( )，但只有在 htaccess 中注释掉（未使用）该行时才会显示错误。

但是……下一分钟我发现

php_value error_reporting 8191

确实设置了 phpinfo() 值并且还允许向浏览器显示错误消息！哦！它必须是一个整数，而且显然也是一个特定或有效的整数，而不仅仅是一个足够大的整数！

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-06-02T20:39:20.583

尝试这个。

```
error_reporting(E_ALL);
ini_set("display_errors", 1); 
```

# internet-explorer - 重用 Internet Explorer COM 自动化对象

> ID：941767
> 
> 赞同：6
> 
> 时间：2009-06-02T20:36:38.357
> 
> 标签：internet-explorer, com, vbscript, automation

我正在使用 VBScript 宏来利用 InternetExplorer.Application COM 自动化对象，并且我正在努力重用该对象的现有实例。

根据我的阅读，我应该能够使用 vbscript 中的 GetObject() 方法来获取该对象的现有实例。

当我执行以下代码时，我收到“对象创建失败 - 名字对象语法错误”。

我的问题真的是语法吗？

我的问题是我如何尝试使用这个对象吗？

或者我想要完成的事情不能完成？

代码：

```
Dim IEObject as object

Sub Main  
  Set IEObject =  GetObject( "InternetExplorer.Application" )

  'Set the window visable
  IEObject.Visible = True

  'Navigate to www.google.com
  IEObject.Navigate( "www.google.com" )
End Sub 
```

此外，我运行 CreateObject() 没有问题，它会打开一个新的 Internet Explorer 窗口并导航到我想要的位置，但我不想让宏打开 Internet Explorer 的多个实例。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T20:51:53.067

尝试这个：

```
 Set IEObject =  GetObject( ,"InternetExplorer.Application" ) 
```

*注意“InternetExplorer.Application”之前的逗号

编辑：试试这个：

```
 Dim IE As SHDocVw.InternetExplorer

Set IE = GetObject(,"InternetExplorer.Application") 
```

你也可以试试这个：

```
 Dim ShellApp
Set ShellApp = CreateObject("Shell.Application")
Dim ShellWindows
Set ShellWindows = ShellApp.Windows()
Dim i
For i = 0 To ShellWindows.Count - 1
    If InStr(ShellWindows.Item(i).FullName, "iexplore.exe") <> 0 Then
        Set IEObject = ShellWindows.Item(i) 
    End If
Next
IEObject.Navigate2("http://www.google.com") 
```

编辑：
你正在尝试的可能是不可能的，看看这个。[http://support.microsoft.com/kb/239470](http://support.microsoft.com/kb/239470)

# nhibernate - 如何在 NHibernate 中映射枚举以在模式导出时正确创建数据库字段？

> ID：941771
> 
> 赞同：0
> 
> 时间：2009-06-02T20:37:20.383
> 
> 标签：nhibernate, nhibernate-mapping

我已经看到了几个与使用 NHibernate 正确映射枚举类型有关的问题。

[Jeff Palermo 的这篇文章](http://codebetter.com/blogs/jeffrey.palermo/archive/2006/03/14/140949.aspx)向我展示了如何通过创建自定义类型来正确地做到这一点。我在开发周期中使用 Schema Export 创建数据库，但这种方法破坏了我的导出语句。有没有办法在导出时指定列的类型？

这是我的枚举代码：

```
public enum OperatorCode
{
    CodeA,
    CodeB,
    CodeC,
    CodeD
} 
```

这是我的自定义类型：

```
public class OperatorCodeType:EnumStringType
{
    public OperatorCodeType():base(typeof(OperatorCode),20)
    {

    }
} 
```

这是我的映射文件中的属性：

```
<property name="OperatorCode" column="OperatorCode" type="OperatorCodeType"  /> 
```

最后，这是我对该属性的类声明：

```
public virtual OperatorCode OperatorCode { get; set; } 
```

甚至有可能做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T20:55:35.807

我还没有测试过，但是您可以使用属性中的 Column 声明来指定 sql 类型。文档中的示例：

```
<property name="Foo" type="String">
    <column name="foo" length="64" not-null="true" sql-type="text"/>
</property> 
```

当然，这是一个字符串，但您可能想尝试使用 OperatorCodeType 类型、作为文本或 nvarchar 的列 sql-type 或任何有效的类型。

如果你试试，告诉我？目前不在我的开发机器附近。

# firefox - 从 Firefox 调试 Netbeans 中的下一个 PHP 页面

> ID：941778
> 
> 赞同：0
> 
> 时间：2009-06-02T20:38:42.533
> 
> 标签：firefox, netbeans, xdebug

我最近切换到在 Mac 上使用 Netbeans (6.7 RC1)，使用 MAMP 作为堆栈。我已经安装并工作了 Xdebug。

以前我使用 Zend Studio 5.5 和 Firefox Zend 工具栏。这有一个很棒的功能，可以让您单击“调试下一页”。当您提交表单时，它将启动调试过程。

如何使用 Netbeans 做类似的事情？我希望能够从 Firefox 启动调试器，以便所有 GET 和 POST 变量都自动传递给调试器。

将要

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T21:02:49.613

还没试过，但 Netbeans 应该有 Firebug AddOn。不确定它是否满足您的需求。

# ascii - Ruby：替换从 MS Word 粘贴的项目符号

> ID：941789
> 
> 赞同：1
> 
> 时间：2009-06-02T20:40:09.347
> 
> 标签：ascii, special-characters

我需要从 MS Word 粘贴的文本中删除项目符号，但我不知道要匹配什么。

当打印到 STDOUT 时，符号显示为 â¢ 这些字符的 ascii 代码是 194 和 162。符号的 ascii 代码是 149

任何建议如何在 JavaScript 或 Ruby 代码中进行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-12-10T20:10:28.520

在 ruby​​ 中，你应该能够使用类似的东西：

`mystring.gsub(/[\xxx]/,'whatever')`

`xxx`您要查找的字符代码在哪里。您只需执行 in irb 即可查看该代码是什么，`puts mystring`它应该会显示给您

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-16T00:56:16.357

我对要点也有类似的问题，包括获取您描述的符号。我尝试了各种 regEx 过滤器，但无论是在项目符号点还是那些产生的 ¢ 字符上，都无法正常工作。

但是，我确实设法找到了一种使用自定义方法过滤项目符号点（或任何类似字符）的方法。它不漂亮或不理想，但它有效：

```
def strip_bullet_point(value) 
  first_char = 0
  value.each_char { |c| c =~ /[A-Za-z]/ ? break : first_char += 1 }

  value[first_char...value.length]
end 
```

这也将删除所有前面的空格和其他非字母字符，因为它们也为 =~ 检查返回 nil。

不要`/[[:alpha:]]/`用于表达式匹配，因为这会将 ¢ 字符视为字母。请注意，这`/[A-Za-z]/`会对非英文字符（例如“ñ”）产生误报。

# c++ - 重新学习现代 C++ 资源？

> ID：941809
> 
> 赞同：8
> 
> 时间：2009-06-02T20:44:22.147
> 
> 标签：c++, resources

我已经有 8 年没有接触过 C++ 了。我最近不得不修复一些 C++ 代码，虽然我仍然可以编码，但我觉得我不再属于 C++ 程序员的阵营。我不知道任何库，没有关注新的语言特性/改进/最佳实践。

Qt Creator 和 Qt 似乎是我现在需要的一个很好的工具集，因为我主要对跨平台开发感兴趣。

对于像我这样的人来说，在最短的时间内快速重新学习 C++ 和最佳实践有什么好的资源？

在此期间，我主要在做 java 和 common lisp，在 C、flex、Scala 和 Haskell 方面迈出了一小步。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-06-02T21:03:02.670

读 ：

*   [有效的 C++](https://rads.stackoverflow.com/amzn/click/com/0201924889)
*   [更有效的 C++](https://rads.stackoverflow.com/amzn/click/com/020163371X)
*   [有效的 STL](https://rads.stackoverflow.com/amzn/click/com/0201749629)
*   [卓越的 C++](https://rads.stackoverflow.com/amzn/click/com/0201615622)
*   [C++ 编码标准](https://rads.stackoverflow.com/amzn/click/com/0321113586)

这些是关于 C++ 的参考书，它们恢复了关于 C++ 的所有现代有效实践、哲学和知识（不涉及元编程的东西）。

然后，如果您想走得更远，请阅读：

*   [现代 C++ 设计](https://rads.stackoverflow.com/amzn/click/com/0201704315)- 众所周知，这个设计令人大吃一惊……
*   [C++ 模板元编程](https://rads.stackoverflow.com/amzn/click/com/0321227255)

关于库：首先了解 STL，并学习使用[Boost](http://boost.org)作为“标准”STL 扩展。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-02T20:50:23.523

了解标准模板图书馆。

如果您真的处于最前沿，请了解 boost。

阅读 scott meyers 的书籍“有效的 c++”和“有效的 STL”。

阅读“ [C++ faq lite](http://www.parashift.com/c++-faq-lite/) ”。

（不一定按这个顺序）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-02T21:02:32.813

如果您从事 GUI 开发，请使用 Qt。这是最好的，而且价格合适。它有点偏离硬标准；但并非没有原因，即便如此，它也会在适当的情况下努力使用类似的编码风格。

如果您更喜欢 CLI 或服务器进程，Qt 仍然可以提供帮助；但它没有那么大的优势。在那里使用 STL 和（特别是）Boost 会更有效率。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-03T09:15:02.113

看看 A.Koenig 和 B.Moo 的*[Accelerated C++](http://www.acceleratedcpp.com/)*。

引用的其他书籍都是好书，但它们需要您大量时间阅读。AC++ 教授现代 C++（与历史悠久的 C++ 不同——这与模板魔法无关）。

B.Stroustrup 的最新著作*[Programming --Principles and Practice Using C++](http://www.research.att.com/~bs/programming.html)*似乎（我还没有读过）也很有趣。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-02T21:01:29.570

首先再次熟悉指针、引用等。

然后我会坚持使用Qt。Qt 的文档规则和 IIRC，Qt 的容器甚至比 STL 更有效。Qt GUI 的代码更加优雅，这一事实也增加了 Qt 的吸引力。此外，Qt 的文档还包含许多简单的和一些相对高级的代码示例，您可以使用它们，并且您应该很快就会再次上手。

不过，知道/使用 STL/Boost 并没有什么坏处。但要远离 GTK。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-02T22:08:32.117

代码代码，然后代码更多！

尝试做一些项目，混合从书本中获得的技术。正如在其他帖子中提到的，有很多关于 C++ 编程的好书。将这些书中的设计模式和技术应用到实际的编码情况中会让你很快回到正轨。

此外，只要您为经验而编写代码，就不要害怕尝试大量不同的库。Multitude 很好，因为它可以帮助您了解不同库的构建方式，并帮助您找到以后要用于实际项目的库。

# java - 如何确定文件是否为 PDF 文件？

> ID：941813
> 
> 赞同：36
> 
> 时间：2009-06-02T20:44:33.223
> 
> 标签：java, validation, pdf, text

我在 Java 中使用 PdfBox 从 PDF 文件中提取文本。提供的某些输入文件无效，PDFTextStripper 在这些文件上停止。是否有一种干净的方法来检查提供的文件是否确实是有效的 PDF？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2010-02-09T11:10:05.450

这是我在 NUnit 测试中使用的内容，必须针对使用 Crystal Reports 生成的多个 PDF 版本进行验证：

```
public static void CheckIsPDF(byte[] data)
    {
        Assert.IsNotNull(data);
        Assert.Greater(data.Length,4);

        // header 
        Assert.AreEqual(data[0],0x25); // %
        Assert.AreEqual(data[1],0x50); // P
        Assert.AreEqual(data[2],0x44); // D
        Assert.AreEqual(data[3],0x46); // F
        Assert.AreEqual(data[4],0x2D); // -

        if(data[5]==0x31 && data[6]==0x2E && data[7]==0x33) // version is 1.3 ?
        {                  
            // file terminator
            Assert.AreEqual(data[data.Length-7],0x25); // %
            Assert.AreEqual(data[data.Length-6],0x25); // %
            Assert.AreEqual(data[data.Length-5],0x45); // E
            Assert.AreEqual(data[data.Length-4],0x4F); // O
            Assert.AreEqual(data[data.Length-3],0x46); // F
            Assert.AreEqual(data[data.Length-2],0x20); // SPACE
            Assert.AreEqual(data[data.Length-1],0x0A); // EOL
            return;
        }

        if(data[5]==0x31 && data[6]==0x2E && data[7]==0x34) // version is 1.4 ?
        {
            // file terminator
            Assert.AreEqual(data[data.Length-6],0x25); // %
            Assert.AreEqual(data[data.Length-5],0x25); // %
            Assert.AreEqual(data[data.Length-4],0x45); // E
            Assert.AreEqual(data[data.Length-3],0x4F); // O
            Assert.AreEqual(data[data.Length-2],0x46); // F
            Assert.AreEqual(data[data.Length-1],0x0A); // EOL
            return;
        }

        Assert.Fail("Unsupported file format");
    } 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-06-06T13:12:46.750

您可以找出文件（或字节数组）的 mime 类型，因此您不会愚蠢地依赖扩展名。我用光圈的 MimeExtractor ( [http://aperture.sourceforge.net/](http://aperture.sourceforge.net/) ) 来做，或者前几天我看到了一个专门的库 ( [http://sourceforge.net/projects/mime-util](http://sourceforge.net/projects/mime-util) )

我使用光圈从各种文件中提取文本，不仅是 pdf，而且还必须针对 pdf 进行调整（光圈使用 pdfbox，但是当 pdfbox 失败时，我添加了另一个库作为后备）

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2011-02-18T13:47:40.720

由于您使用 PDFBox，您可以简单地执行以下操作：

```
PDDocument.load(file); 
```

如果 PDF 已损坏等，它将失败并出现异常。

如果成功，您还可以检查 PDF 是否使用加密`.isEncrypted()`

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2016-02-19T23:47:35.230

这里是 NinjaCross 代码的改编 Java 版本。

```
/**
 * Test if the data in the given byte array represents a PDF file.
 */
public static boolean is_pdf(byte[] data) {
    if (data != null && data.length > 4 &&
            data[0] == 0x25 && // %
            data[1] == 0x50 && // P
            data[2] == 0x44 && // D
            data[3] == 0x46 && // F
            data[4] == 0x2D) { // -

        // version 1.3 file terminator
        if (data[5] == 0x31 && data[6] == 0x2E && data[7] == 0x33 &&
                data[data.length - 7] == 0x25 && // %
                data[data.length - 6] == 0x25 && // %
                data[data.length - 5] == 0x45 && // E
                data[data.length - 4] == 0x4F && // O
                data[data.length - 3] == 0x46 && // F
                data[data.length - 2] == 0x20 && // SPACE
                data[data.length - 1] == 0x0A) { // EOL
            return true;
        }

        // version 1.3 file terminator
        if (data[5] == 0x31 && data[6] == 0x2E && data[7] == 0x34 &&
                data[data.length - 6] == 0x25 && // %
                data[data.length - 5] == 0x25 && // %
                data[data.length - 4] == 0x45 && // E
                data[data.length - 3] == 0x4F && // O
                data[data.length - 2] == 0x46 && // F
                data[data.length - 1] == 0x0A) { // EOL
            return true;
        }
    }
    return false;
} 
```

还有一些简单的单元测试：

```
@Test
public void test_valid_pdf_1_3_data_is_pdf() {
    assertTrue(is_pdf("%PDF-1.3 CONTENT %%EOF \n".getBytes()));
}

@Test
public void test_valid_pdf_1_4_data_is_pdf() {
    assertTrue(is_pdf("%PDF-1.4 CONTENT %%EOF\n".getBytes()));
}

@Test
public void test_invalid_data_is_not_pdf() {
    assertFalse(is_pdf("Hello World".getBytes()));
} 
```

如果您提出任何失败的单元测试，请告诉我。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2017-05-17T15:40:15.487

我正在使用我在此处和其他网站/帖子上找到的一些建议来确定 pdf 是否有效。我故意损坏了一个 pdf 文件，不幸的是，许多解决方案都没有检测到该文件已损坏。

最终，在修改了 API 中的不同方法之后，我尝试了这个：

```
PDDocument.load(file).getPage(0).getContents().toString(); 
```

这没有抛出异常，但它确实输出了这个：

```
 WARN  [COSParser:1154] The end of the stream doesn't point to the correct offset, using workaround to read the stream, stream start position: 171, length: 1145844, expected end position: 1146015 
```

就个人而言，我希望在文件损坏时引发异常，以便我自己处理它，但似乎我正在实现的 API 已经以自己的方式处理它们。

为了解决这个问题，我决定尝试使用给出暖语句的类 (COSParser) 来解析文件。我发现有一个子类，叫做 PDFParser，它继承了一个叫做“setLenient”的方法，这是关键（[https://pdfbox.apache.org/docs/2.0.4/javadocs/org/apache/pdfbox/pdfparser /COSParser.html](https://pdfbox.apache.org/docs/2.0.4/javadocs/org/apache/pdfbox/pdfparser/COSParser.html) )。

然后我实现了以下内容：

```
 RandomAccessFile accessFile = new RandomAccessFile(file, "r");
        PDFParser parser = new PDFParser(accessFile); 
        parser.setLenient(false);
        parser.parse(); 
```

如我所愿，这为我损坏的文件抛出了异常。希望这可以帮助某人！

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-06-02T21:15:33.800

Pdf 文件以“%PDF”开头（在 TextPad 或类似工具中打开一个并查看）

有什么理由不能只用 StringReader 读取文件并检查吗？

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2014-02-23T17:21:57.810

你必须试试这个......

```
public boolean isPDF(File file){
    file = new File("Demo.pdf");
    Scanner input = new Scanner(new FileReader(file));
    while (input.hasNextLine()) {
        final String checkline = input.nextLine();
        if(checkline.contains("%PDF-")) { 
            // a match!
            return true;
        }  
    }
    return false;
} 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2016-04-13T20:13:33.850

也许我来不及回答。但是你应该看看 Tika。它在内部使用 PDFBox Parser 来解析 PDF

您只需要导入 tika-app-latest*.jar

```
 public String parseToStringExample() throws IOException, SAXException, TikaException 
 {

      Tika tika = new Tika();
      try (InputStream stream = ParsingExample.class.getResourceAsStream("test.pdf")) {
           return tika.parseToString(stream); // This should return you the pdf's text
      }
} 
```

这将是一个更清洁的解决方案。您可以在此处参考 Tika 用法的更多详细信息：[https ://tika.apache.org/1.12/api/](https://tika.apache.org/1.12/api/)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2017-05-29T09:28:05.163

Roger Keays 的答案是错误的！因为并非 1.3 版中的所有 PDF 文件都被 EOL 终止。以下答案适用于所有未损坏的 pdf 文件：

```
public static boolean is_pdf(byte[] data) {
    if (data != null && data.length > 4
            && data[0] == 0x25 && // %
            data[1] == 0x50 && // P
            data[2] == 0x44 && // D
            data[3] == 0x46 && // F
            data[4] == 0x2D) { // -

        // version 1.3 file terminator
        if (//data[5] == 0x31 && data[6] == 0x2E && data[7] == 0x33 &&
                data[data.length - 7] == 0x25 && // %
                data[data.length - 6] == 0x25 && // %
                data[data.length - 5] == 0x45 && // E
                data[data.length - 4] == 0x4F && // O
                data[data.length - 3] == 0x46 && // F
                data[data.length - 2] == 0x20 // SPACE
                //&& data[data.length - 1] == 0x0A// EOL
                ) {
            return true;
        }

        // version 1.3 file terminator
        if (//data[5] == 0x31 && data[6] == 0x2E && data[7] == 0x34 &&
                data[data.length - 6] == 0x25 && // %
                data[data.length - 5] == 0x25 && // %
                data[data.length - 4] == 0x45 && // E
                data[data.length - 3] == 0x4F && // O
                data[data.length - 2] == 0x46 // F
                //&& data[data.length - 1] == 0x0A // EOL
                ) {
            return true;
        }
    }
    return false;
} 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2018-01-12T07:41:27.143

一般来说，我们可以喜欢这样，任何以 %%EOF 结尾的 pdf 版本，所以我们可以像下面这样检查。

```
public static boolean is_pdf(byte[] data) {
        String s = new String(data);
        String d = s.substring(data.length - 7, data.length - 1);
        if (data != null && data.length > 4 &&
                data[0] == 0x25 && // %
                data[1] == 0x50 && // P
                data[2] == 0x44 && // D
                data[3] == 0x46 && // F
                data[4] == 0x2D) { // -

              if(d.contains("%%EOF")){
                 return true; 
              }         
        }
        return false;
    } 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2019-03-07T15:08:55.757

这是一种检查是否存在`%%EOF`空白字符的可选检查方法。您可以传入一个`File`或一个`byte[]`对象。在某些 PDF 版本中，对空白字符的限制较少。

```
public boolean isPdf(byte[] data) {
    if (data == null || data.length < 5) return false;
    // %PDF-
    if (data[0] == 0x25 && data[1] == 0x50 && data[2] == 0x44 && data[3] == 0x46 && data[4] == 0x2D) {
        int offset = data.length - 8, count = 0; // check last 8 bytes for %%EOF with optional white-space
        boolean hasSpace = false, hasCr = false, hasLf = false;
        while (offset < data.length) {
            if (count == 0 && data[offset] == 0x25) count++; // %
            if (count == 1 && data[offset] == 0x25) count++; // %
            if (count == 2 && data[offset] == 0x45) count++; // E
            if (count == 3 && data[offset] == 0x4F) count++; // O
            if (count == 4 && data[offset] == 0x46) count++; // F
            // Optional flags for meta info
            if (count == 5 && data[offset] == 0x20) hasSpace = true; // SPACE
            if (count == 5 && data[offset] == 0x0D) hasCr    = true; // CR
            if (count == 5 && data[offset] == 0x0A) hasLf    = true; // LF / EOL
            offset++;
        }

        if (count == 5) {
            String version = data.length > 13 ? String.format("%s%s%s", (char) data[5], (char) data[6], (char) data[7]) : "?";
            System.out.printf("Version : %s | Space : %b | CR : %b | LF : %b%n", version, hasSpace, hasCr, hasLf);
            return true;
        }
    }

    return false;
} 
```

```
public boolean isPdf(File file) throws IOException {
    return isPdf(file, false);
} 
```

```
// With version: 16 bytes, without version: 13 bytes.
public boolean isPdf(File file, boolean includeVersion) throws IOException {
    if (file == null) return false;
    int offsetStart = includeVersion ? 8 : 5, offsetEnd = 8;
    byte[] bytes = new byte[offsetStart + offsetEnd];
    InputStream is = new FileInputStream(file);
    try {
        is.read(bytes, 0, offsetStart); // %PDF-
        is.skip(file.length() - bytes.length); // Skip bytes
        is.read(bytes, offsetStart, offsetEnd); // %%EOF,SP?,CR?,LF?
    } finally {
        is.close();
    }
    return isPdf(bytes);
} 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2020-05-08T11:26:55.990

依靠幻数对我来说并没有真正的吸引力。我最终为此使用了 Apache 的预检库：

> 编译组：'org.apache.pdfbox'，名称：'preflight'，版本：'2.0.19'

```
private boolean isPdf(InputStream fileInputStream) {
    try {
        PreflightParser preflightParser = new PreflightParser(new ByteArrayDataSource(fileInputStream));
        preflightParser.parse();
        return true;
    } catch (Exception e) {
        return false;
    }
} 
```

PreflightParser 具有文件和其他数据源的构造函数。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-08-16T15:07:37.833

有一个非常方便简单的测试PDF内容的库： [https ://github.com/codeborne/pdf-test](https://github.com/codeborne/pdf-test)

API 非常简单：

```
import com.codeborne.pdftest.PDF;
import static com.codeborne.pdftest.PDF.*;
import static org.junit.Assert.assertThat;

public class PDFContainsTextTest {
  @Test
  public void canAssertThatPdfContainsText() {
    PDF pdf = new PDF(new File("src/test/resources/50quickideas.pdf"));
    assertThat(pdf, containsText("50 Quick Ideas to Improve your User Stories"));
  }
} 
```

# scheme - eq之间的区别？和 = 在方案中？

> ID：941817
> 
> 赞同：6
> 
> 时间：2009-06-02T20:44:58.637
> 
> 标签：scheme, racket

```
 > (eq? 1 1)
    #t
    > (eq? 1.1 1.1)
    #f
    > (= 1.1 1.1)
    #t 
```

这是 DrScheme 中的交互窗口。有人可以解释=和eq之间的区别吗？在计划？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-02T20:56:34.633

= 比较数字。情商？测试参数是否代表内存中的相同数据对象。当量？应该在第二种情况下工作，因为它测试与 eq 相同？但专门测试原语。 [更多关于方案中的等价谓词here](http://www.cs.hut.fi/Studies/T-93.210/schemetutorial/node11.html)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-02T20:56:35.820

我猜想自从

> 情商？计算结果为#f，除非其参数表示内存中的相同数据对象；

和

> Scheme 存储不精确数字 (1.1) 与精确数字 (1) 不同

两个 1.1 参数不在内存中的同一位置并返回 #f for eq?

[维基百科参考](http://en.wikipedia.org/wiki/Scheme_(programming_language))

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-12-05T22:00:09.447

*情商？*数字是不可预测的。是否嵌入数字文字以使相同的数字位于内存中的相同位置取决于实现与否。例如，Racket 语言最近选择在阅读过程中实习这些文字。 [http://www.mail-archive.com/dev@racket-lang.org/msg04893.html](http://www.mail-archive.com/dev@racket-lang.org/msg04893.html)

您不确定您的语言实现的运行时是否会唯一地表示每个数字。这会影响被装箱的值，例如浮点数和大数。这就是为什么*=*作为数字谓词存在的原因：它检查内容的相等性，而不是浅指针相等性。

这并不是像 Scheme 这样的语言所独有的：例如，Python 中出现了相等与相等（*is* vs. *==*）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T20:52:55.483

第一个区别：`eq?`适用于任何一对值，而`=`适用于任意数量的数字。

还有其他几个[等价谓词](http://www.r6rs.org/final/html/r6rs/r6rs-Z-H-14.html#node_sec_11.5)。他们中的大多数只接受两个参数。 `=`在[“数字”一章中定义](http://www.r6rs.org/final/html/r6rs/r6rs-Z-H-2.html#node_toc_node_sec_11.7.4.3)

# javascript - Jquery Multiselect - 手动触发事件？

> ID：941821
> 
> 赞同：1
> 
> 时间：2009-06-02T20:45:14.080
> 
> 标签：javascript, jquery, multi-select

我正在使用来自：[http ://abeautifulsite.net/notebook/62 的 jquery 多选控件](http://abeautifulsite.net/notebook/62)

我需要通过 javascript 在特定事件上手动检查其中一个选项。

每当我尝试更改选中的属性或触发单击、显式调用单击函数等时，我都会选中复选框，但 CSS 从未更改，并且文本框从未使用当前选定的元素刷新。

示例：如果我想使用 javascript 代码选择具有“TRA”值的复选框并确保其行为正常，我该如何实现？

```
<input class="multiSelect" type="text" style="cursor: default;" value="" readonly="readonly"/>

<div class="multiSelectOptions" style="position: absolute; z-index: 99999; display: none;">
    <label class="selectAll">
        <input class="selectAll" type="checkbox"/>
        (All)   
    </label>
    <label>
        <input type="checkbox" value="ADP" name="Attributes"/>
        Adaptation
    </label>
    <label>
        <input type="checkbox" value="TRA" name="Attributes"/>
        Translation
    </label>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T22:31:39.810

看来你需要在触发点击事件之前设置checked属性，然后再设置checked属性。我将进一步研究它，但与此同时，这是解决方案

**[工作示例](http://jsbin.com/iruti)**

相关的jQuery代码

```
$(function() {
    $('#sample').multiSelect();
    $('#check').click(function() {
        $('input[type="checkbox"][value="TRA"]')
            .attr('checked',true)
            .trigger('click')
            .attr('checked',true);
    });
    $('#uncheck').click(function() {
        $('input[type="checkbox"][value="TRA"]')
            .attr('checked',false)
            .trigger('click')
            .attr('checked',false);
    });
}); 
```

相关的 HTML

```
<select id="sample" multiple="multiple">
    <option value=""/>
    <option value="ADP">Adaptation</option>
    <option value="TRA">Translation</option>
</select>
<br/>
<input id="check" type="button" value="Check TRA" style="margin-left: 250px; width: 100px;" />
<br/>
<input id="uncheck" type="button" value="Uncheck TRA" style="margin-left: 250px; width: 100px;" /> 
```

# iphone - 如何加快 iPhone Simulator 中的应用程序启动速度？

> ID：941823
> 
> 赞同：2
> 
> 时间：2009-06-02T20:46:35.560
> 
> 标签：iphone, xcode, ios-simulator

问题是我的应用程序将数百兆字节保存到他们 iPhone 上的用户文档目录中。在测试期间，iPhone 模拟器需要很长时间才能在每次构建时启动应用程序，因为每次构建时它都会将所有这些数据复制到新的文档目录中。是否有任何解决方案可以每次将目录留在同一位置或以某种方式加速启动？例如，具有 HEX 值的导向器会更改 iPhone 模拟器上的每次重建/重新启动，这可能非常耗时：

./Library/Application Support/iPhone Simulator/User/Applications/B32A0BA1-5843-4FDE-B5FB-4E40460BD8CC/Documents/

谢谢，

马特

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-02T22:53:56.317

模拟器（与设备本身不同）不必保留在沙盒位置。

因此，从模拟器中保存文件时，您可以尝试：

```
#if TARGET_IPHONE_SIMULATOR

// save your files to a fixed location on your hard-disk
// (like /Users/yourusername/MyIPhoneAppDebugStorage)

#else

// Save files normally
// (to [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory,
//     NSUserDomainMask, YES) objectAtIndex:0])

#endif 
```

这样，当从模拟器运行时，您的大文件始终位于硬盘上的固定位置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-05-24T09:21:19.193

在第一次运行后让模拟器**保持打开状态。**只需在 XCode 中停止程序而不关闭模拟器。因此，在下一次测试启动中，它只需要加载应用程序而无需再次加载模拟器。

这对我来说真的加快了速度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T21:22:28.513

为了缩短构建时间，最简单的方法可能是创建一个包含合理数据子集的新 XCode 目标。假设这些数据文件是 XCode 项目中的“资源”文件，您可以复制您的应用程序目标，将其重命名为“app lite”或类似名称，然后编辑“复制资源”构建阶段以不包含所有文件（或单个较小的文件，或其他）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T21:26:04.183

XCode 不会在每次构建和运行时创建新目录，它只是重命名旧目录。

我有数据存储在文档目录中，并且每次启动时都存储在其中，除非我在运行我的应用程序之前明确删除它。

我很好奇启动模拟器时花费的时间。你可以通过应用程序调试吗？（是你的代码花时间吗？）

克里斯。

# cocoa - 如何取消选择 NSBrowser 中的所有单元格

> ID：941825
> 
> 赞同：0
> 
> 时间：2009-06-02T20:46:41.940
> 
> 标签：cocoa, macos, nsbrowser

如何取消选择/取消选择 NSBrowser 中的任何选定单元格？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T20:47:39.363

由[这里](http://homepage2.nifty.com/hoshi-takanori/cocoa-browser/prog-tips.html#browser-unselect)提供：

```
[browser loadColumnZero]; 
```

请注意，在这种情况下不会发送浏览器选择更改发送操作，因此如果您在 Interface Builder 中使用该操作，您可能必须手动触发该方法。

# entity-framework - 必须为实体框架中的所有关键属性指定映射？

> ID：941826
> 
> 赞同：4
> 
> 时间：2009-06-02T20:46:46.073
> 
> 标签：entity-framework

我正在尝试建立一个绑定到一堆视图的实体框架模型。当我添加一个视图时，它想把大部分字段变成一个实体键，没有明显的原因。

更糟糕的是，当我尝试在其中两个视图之间创建关联时，我收到一条错误消息，提示我必须为所有键属性指定映射……即使我已将它们全部更改为不再是实体键。我认为基础表模型仍然将它们标记为键，但我无法在设计器的 .store 对象中更改它。

所以

1) 如何防止 EF 将每个字段都设为主键？
2) 如何从 .store 对象中删除 EntityKey=true 值？
3）这到底为什么这么复杂？

编辑：好的，想出了＃1。我不得不手动编辑 xml 并从 SSDL 以及 CSDL 部分中删除密钥...

现在，如果有人可以回答 2 和 3，我可能会到达某个地方！;)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-12-17T03:13:37.787

请注意，在 Visual Studio 2010 的最终版本中，设计器将自动将实体中的键定义同步到视图的键定义——这意味着您不必去编辑 SSDL。

# sql-server - 拆分 SQL 脚本

> ID：941830
> 
> 赞同：4
> 
> 时间：2009-06-02T20:47:37.740
> 
> 标签：sql-server, sql-server-2005

我正在编写一个相当长的 SQL 脚本，该脚本运行接近 2000 行代码。由于理解长脚本变得非常困难，我想将其分解为逻辑单元并将它们分离到其他 SQL 文件中。

这样做的最佳方法是什么？每个逻辑单元都需要是一个存储过程吗？也许是UDF？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T20:51:04.333

利用存储过程和函数。如果您正在执行纯 SQL，那么没有比代码的逻辑单元更好的地方了。此外，它使维护/编辑代码变得更加容易。

话虽如此，如果您的脚本那么长，您可能想看看您在做什么，并考虑另一种脚本语言，甚至 C#/LINQ。有时将其全部保留在 SQL 中是有意义的，有时您将某些内容强制写入 SQL，但只有您才能做出决定。

此外，C# 或其他脚本语言很容易与源代码管理集成。只是要考虑的事情！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T21:21:37.797

将其分解为多个 sps，添加 try-catch 块和错误处理（请记住，除以 0 不是可捕获的错误），并设置一个作业以按顺序执行每个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T20:53:26.060

首先，在一个文件中包含 2000 行 SQL 并不算多（对于一个中等大小的数据库，DDL 通常会运行这么多或更多）。但是，在单个过程中拥有太多了！解决这个问题的方法确实是将逻辑组件分解为单独的过程。除非您有特定的瓶颈需要克服或在 SQL 中不容易完成的操作，否则您将不需要 UDF。

最后一点建议：考虑通过视图简化数据访问。

顺便说一句：你想用这么大的 proc 来完成什么？我使用 T-SQL 做了大量的工作，但我从来没有接近 2000 行代码！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T20:53:44.873

如果您使用 UDF，请确保您知道标量和内联的区别：

[http://sqlblog.com/blogs/alexander_kuznetsov/archive/2008/05/23/reuse-your-code-with-cross-apply.aspx](http://sqlblog.com/blogs/alexander_kuznetsov/archive/2008/05/23/reuse-your-code-with-cross-apply.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T20:54:25.090

你用来分解它的方法可能会因你在做什么而有所不同。

这类似于任何编程语言，广告脚本/函数太大，需要分解。

如果您的脚本由于相同或相似的查询而很大，则可以通过将这些查询添加为视图来减少脚本。

存储过程和用户​​定义的函数也是另一种好方法，具体取决于您的代码在做什么。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-02T20:54:57.197

一批似乎有很多代码。

将每个逻辑步骤/流程（即创建订单/发送订单/注册客户）分解为单独的存储过程。您可能会发现创建过程流程图并使用它来帮助确定在哪里分解 T-SQL 代码批处理很有用。

如果您尝试使用 T-SQL 执行计算逻辑，则将此类操作移至托管代码，例如 CLR 函数等。

# c++ - 删除空指针是否安全？

> ID：941832
> 
> 赞同：98
> 
> 时间：2009-06-02T20:47:47.100
> 
> 标签：c++, memory-management, casting, void-pointers

假设我有以下代码：

```
void* my_alloc (size_t size)
{
   return new char [size];
}

void my_free (void* ptr)
{
   delete [] ptr;
} 
```

这安全吗？还是必须在删除之前强制转换`ptr`？`char*`

* * *

## 回答 #1

> 赞同：149
> 
> 时间：2009-06-02T21:15:21.350

C++ 标准未定义通过 void 指针删除 - 请参阅第 5.3.5/3 节：

> 在第一种选择（删除对象）中，如果操作数的静态类型与其动态类型不同，则静态类型应为操作数动态类型的基类，并且静态类型应具有虚拟析构函数或行为未定义. 在第二种选择（删除数组）中，如果要删除的对象的动态类型与其静态类型不同，则行为未定义。

及其脚注：

> 这意味着不能使用 void* 类型的指针删除对象，因为没有 void 类型的对象

.

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-06-02T20:52:22.927

这不是一个好主意，也不是你会在 C++ 中做的事情。您无缘无故地丢失了类型信息。

当您为非原始类型调用析构函数时，不会在要删除的数组中的对象上调用析构函数。

**您应该改写新/删除。**

删除 void* 可能会偶然正确释放您的内存，但这是错误的，因为结果未定义。

如果出于某种我不知道的原因，您需要将指针存储在 void* 中然后释放它，您应该使用 malloc 和 free。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2009-06-02T21:14:17.780

这取决于“安全”。它通常会起作用，因为信息与分配本身的指针一起存储，因此释放器可以将其返回到正确的位置。从这个意义上说，只要您的分配器使用内部边界标签，它就是“安全的”。（很多人都这样做。）

但是，正如其他答案中提到的，删除 void 指针不会调用析构函数，这可能是一个问题。从这个意义上说，它并不“安全”。

没有充分的理由按照你正在做的事情做你正在做的事情。如果您想编写自己的释放函数，可以使用函数模板生成具有正确类型的函数。这样做的一个很好的理由是生成池分配器，这对于特定类型可能非常有效。

正如其他答案中提到的，这是C++ 中[未定义的行为](https://en.cppreference.com/w/cpp/language/ub)。一般来说，最好避免未定义的行为，尽管主题本身很复杂并且充满了相互矛盾的意见。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-06-02T21:05:14.913

删除 void 指针是危险的，因为不会在它实际指向的值上调用析构函数。这可能会导致应用程序中的内存/资源泄漏。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2013-09-08T12:35:14.440

这个问题没有意义。您的困惑可能部分是由于人们经常使用的草率语言`delete`：

您用于`delete`销毁动态分配的**对象**。这样做，您将形成一个带有*指向该对象的指针的**删除表达式*。您永远不会“删除指针”。您真正要做的是“删除由其地址标识的对象”。

 *现在我们明白为什么这个问题没有意义了：空指针不是“对象的地址”。它只是一个地址，没有任何语义。它*可能*来自一个实际对象的地址，但该信息丢失了，因为它是以原始指针的*类型编码的。*恢复对象指针的唯一方法是将 void 指针转换回对象指针（这需要作者知道指针的含义）。`void`本身是不完整的类型，因此永远不是对象的类型，并且永远不能使用 void 指针来标识对象。（对象由它们的类型和地址共同标识。）

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-06-04T07:34:10.523

如果你真的必须这样做，为什么不去掉中间人（`new`和`delete`运算符）并直接调用全局`operator new`和`operator delete`？（当然，如果您尝试使用`new`and`delete`运算符，您实际上应该重新实现`operator new`and `operator delete`。）

```
void* my_alloc (size_t size)
{
   return ::operator new(size);
}

void my_free (void* ptr)
{
   ::operator delete(ptr);
} 
```

请注意，不像`malloc()`,`operator new`会引发`std::bad_alloc`失败（或调用`new_handler`if 已注册）。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-06-02T21:14:11.433

很多人已经评论说不，删除空指针是不安全的。我同意这一点，但我还想补充一点，如果您正在使用 void 指针来分配连续数组或类似的东西，您可以这样做，`new`以便您可以`delete`安全地使用（用，啊哼，一点额外的工作）。这是通过为内存区域（称为“arena”）分配一个 void 指针，然后将指向该 arena 的指针提供给 new 来完成的。[请参阅C++ FAQ](https://isocpp.org/wiki/faq/dtors#memory-pools)中的此部分。这是在 C++ 中实现内存池的常用方法。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-06-02T21:07:57.873

因为 char 没有特殊的析构逻辑。这行不通。

```
class foo
{
   ~foo() { printf("huzza"); }
}

main()
{
   foo * myFoo = new foo();
   delete ((void*)foo);
} 
```

d'ctor 不会被叫到。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-06-02T21:33:07.620

如果你想使用 void*，为什么不只使用 malloc/free？new/delete 不仅仅是内存管理。基本上， new/delete 调用构造函数/析构函数，还有更多的事情发生。如果您只是使用内置类型（如 char*）并通过 void* 删除它们，它会起作用，但仍然不推荐。如果您想使用 void*，底线是使用 malloc/free。否则，为方便起见，您可以使用模板函数。

```
template<typename T>
T* my_alloc (size_t size)
{
   return new T [size];
}

template<typename T>
void my_free (T* ptr)
{
   delete [] ptr;
}

int main(void)
{
    char* pChar = my_alloc<char>(10);
    my_free(pChar);
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-03T13:32:56.803

如果您只想要一个缓冲区，请使用 malloc/free。如果您必须使用 new/delete，请考虑一个简单的包装类：

```
template<int size_ > struct size_buffer { 
  char data_[ size_]; 
  operator void*() { return (void*)&data_; }
};

typedef sized_buffer<100> OpaqueBuffer; // logical description of your sized buffer

OpaqueBuffer* ptr = new OpaqueBuffer();

delete ptr; 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-05-07T01:25:55.193

几乎没有理由这样做。

首先，如果您不知道数据的**类型**，而您只知道它是`void*`，那么您真的应该将该数据视为二进制数据的无类型**blob** ( `unsigned char*`)，并使用`malloc`/`free`来处理它. 有时对于波形数据等需要这样做，您需要将`void*`指针传递给 C api。没关系。

如果你**确实**知道数据的类型（即它有一个ctor/dtor），但由于某种原因你最终得到了一个`void*`指针（无论你有什么原因）**，那么你真的应该把它转换回你知道的类型be**，并呼吁`delete`它。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-01-04T23:17:05.937

我在我的框架中使用了 void*，（又名未知类型），同时在代码反射和其他歧义的壮举中，到目前为止，我没有遇到任何编译器的问题（内存泄漏、访问冲突等）。仅因操作不规范而发出警告。

删除一个未知数 (void*) 非常有意义。只需确保指针遵循这些准则，否则它可能不再有意义：

1) 未知指针不能指向具有平凡解构函数的类型，因此当转换为未知指针时，它永远不应该被删除。仅在将未知指针转换回 ORIGINAL 类型后删除它。

2) 实例是否在堆栈绑定或堆绑定内存中被引用为未知指针？如果未知指针引用堆栈上的一个实例，那么它永远不应该被删除！

3）你100%肯定未知指针是一个有效的内存区域吗？不，那么它永远不应该被删除！

总之，使用未知 (void*) 指针类型可以完成的直接工作非常少。然而，间接地，void* 是 C++ 开发人员在需要数据模糊性时依赖的重要资产。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-02-01T03:47:02.647

对于 char 的特殊情况。

char 是一种没有特殊析构函数的内在类型。因此，泄漏论点是一个没有实际意义的论点。

sizeof(char) 通常是一个，因此也没有对齐参数。在 sizeof(char) 不是 1 的稀有平台的情况下，它们分配的内存足够对齐到它们的 char。所以对齐论点也是一个没有实际意义的论点。

malloc/free 在这种情况下会更快。但是你放弃了 std::bad_alloc 并且必须检查 malloc 的结果。调用全局 new 和 delete 操作符可能会更好，因为它绕过了中间人。

# .net - 如何让 Mobilink 同步表，以便不覆盖最近更新的表？

> ID：941835
> 
> 赞同：2
> 
> 时间：2009-06-02T20:47:55.057
> 
> 标签：.net, windows-mobile, sqlanywhere, mobilink

这是场景。我有一个 Oracle 统一数据库。我正在使用 Mobilink 将 Oracle 与手持设备上使用的 SqlAnywere 数据库同步。如果 userA 将其手持设备上的远程 DB 中的记录更改为“首先更新”，然后 10 分钟后 userB 将其手持设备上的同一记录更新为“第二个更新”，我希望统一数据库在之后始终显示“第二个更新”两个设备是同步的。目前，如果 userB 在 userA 之前同步，则统一数据库将读取“首先更新”。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T14:24:00.307

现在，您在 MobiLink 服务器中使用默认的冲突解决方案，因此默认情况下最后一次同步获胜。您需要实施自己的冲突解决方案来处理此问题。

这将需要在远程数据库上发生两件事：

1) 远程数据库的表中需要有一列与统一数据库同步，用于跟踪远程站点上记录的更新时间。

2) 您必须信任远程站点的系统时钟。如果人们弄清楚冲突是如何解决的并且他们想确保他们的数据赢得冲突，那么没有什么可以阻止用户将远程设备上的系统时间更改为下周，更新他们的数据，将系统时间更改回然后同步。

在合并时，您需要实施冲突解决，这并不难。只要您的表不包含任何 blob，您就可以在表的 upload_update 事件中编写冲突解决方案。让我们假设远程数据库中的表如下所示：

```
create table Admin (
  admin_id           bigint default global autoincrement(1000000) primary key,
  data               varchar(64) not null,
  rem_last_modified  timestamp not null default timestamp
); 
```

我们还假设合并时的一个表看起来非常相似，但还有另一个最后修改的列来跟踪合并时行的更改时间。

```
create table Admin (
  admin_id           bigint default global autoincrement(1000000) primary key,
  data               varchar(64) not null ,
  rem_last_modified  timestamp not null default ‘1900-01-01’,
  cons_last_modified timestamp default timestamp
); 
```

通常，您的 upload_update 事件看起来像这样：

```
call ml_add_table_script( 'v1', 'Admin', 'upload_update',
'update Admin set data = {ml r.data}, 
              rem_last_modified = {ml r.rem_last_modified}  
 where admin_id = {ml r.admin_id}'
); 
```

相反，我们将重写您的 upload_update 事件以调用存储过程，并从远程数据库中传递旧行值。

```
call ml_add_table_script( 'v1', 'Admin', 'upload_update',
'call admin_upload_update( {ml r.admin_id}, 
    {ml r.data}, {ml r.rem_last_modified}, 
    {ml o.data}, {ml o.rem_last_modified}’
); 
```

您的存储过程的关键是我们要进行更新，但更新的 where 子句将包括主键值和远程数据库中的旧行值。如果有人更改了合并中的行，则此更新将更新零行，并且我们知道发生了冲突。如果它更新一行，则没有冲突。您的存储过程将如下所示（下面的伪 SQL）：

```
create procedure admin_upload_update ( 
    @admin_id bigint, 
    @new_data varchar(64), 
    @new_rem_lmod timestamp,
    @old_data varchar(64), 
    @old_rem_lmod timestamp 
)
begin
    declare @cur_rem_lmod timestamp;
    update admin set data = @new_data, rem_last_modified = @new_rem_lmod
     where admin_id = @admin_id 
       and data = @old_data 
       and rem_last_modified = @old_rem_lmod;
    if @@rowcount = 0 then
        // conflict !!
        select rem_last_modified into @cur_rem_lmod 
          from admin where admin_id = @admin_id;
        if @new_rem_lmod > @cur_rem_lmod then
            // update using new_data and new_rem_lmod
        else 
            // do nothing, current values in cons wins
        end if;
    end if;  
end; 
```

有关解决冲突的更多信息，请参阅 v10 文档的以下部分：

MobiLink - 服务器管理

同步技术

处理冲突

[http://dcx.sybase.com/index.php#http%3A%2F%2Fdcx.sybase.com%2Fhtml%2Fdbmlen10%2Fml-conflicts-synch.html](http://dcx.sybase.com/index.php#http%3A%2F%2Fdcx.sybase.com%2Fhtml%2Fdbmlen10%2Fml-conflicts-synch.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-04T14:10:09.960

假设您已经实现了基于时间戳的下载或快照下载，那么如果自上次同步以来整合由另一个远程更新，那么远程将被更新以匹配整合。

顺便说一句，如果您设置了同步模型（[http://dcx.sybase.com/index.php#http%3A%2F%2Fdcx.sybase.com%2Fhtml%2Fdbmgen10%2Fmg -mg-about-s-5060632a.html](http://dcx.sybase.com/index.php#http%3A%2F%2Fdcx.sybase.com%2Fhtml%2Fdbmgen10%2Fmg-mg-about-s-5060632a.html)），在版本 10 及更高版本中可用。无论是在 Create Synchronization Model 向导中，还是在模型创建后的 Mappings 页面中，您都可以选择是需要基于行还是基于列的冲突检测，以及不同类型的冲突解决。您想要的对应于“时间戳”冲突解决选项，您可以在其中选择现有的时间戳列。

仅供参考，向导解释的选项比映射页面更多，所以我建议先在向导中探索这些选项。请注意，如果“较新者获胜，使用您维护的时间戳列”选项为灰色，则表示同步表中没有时间戳列。

创建模型后，您可以在“事件”页面中预览生成的脚本。完成模型设置后，将其部署以创建 SQL 和批处理文件和/或将 SQL 直接应用于数据库。

# string - rijndael 加密

> ID：941837
> 
> 赞同：0
> 
> 时间：2009-06-02T20:48:13.030
> 
> 标签：string, encryption, character, delimited

这个加密库是否使用管道字符？我将密钥存储在具有相应 UserID 值的数组中，并用竖线字符分隔它们。如果库生成带有管道字符的键，那么当我稍后拆分字符串时，这些键将被损坏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T20:51:04.897

密钥应该是随机的，因此可以偶然包含管道字符。您应该在管道分隔的字符串中将其表示为十六进制或 base-64，以避免不可预测的结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T21:24:20.897

我不知道有一个名为 Rijndael的*图书馆。*我知道一个名为 Rijndael（现为 AES）的对称密码，但该密码会加密东西——它不会生成密钥。

如果您的意思是密码，则您的问题不适用。如果您指的是一段特定的代码（即库），那么链接将很有用，因此我们都可以看到您正在谈论的是哪个特定的 Rijndael 实现库。

话虽如此，您始终可以将任何数据重新编码为 base64、十六进制、二进制或您喜欢的任何不包含管道字符的数据。

# nhibernate - 使用 FluentNHibernate 在 SaveOrUpdate 上没有任何反应

> ID：941843
> 
> 赞同：0
> 
> 时间：2009-06-02T20:49:49.983
> 
> 标签：nhibernate, fluent-nhibernate

使用带有 FluentNHibernate 的 SaveOrUpdate 方法更新实体时没有任何反应。Flush 确实有效，但由于现有的存储库基础设施，我想使用 SaveOrUpdate。可能是什么问题呢？

配置：

```
sessionFactory = Fluently.Configure()
    .Database(MsSqlConfiguration
        .MsSql2005
            .ConnectionString(c => c.FromConnectionStringWithKey("repository")))
        .Mappings(m => m.FluentMappings
            .AddFromAssemblyOf<InvoiceMap>())
    .BuildSessionFactory(); 
```

映射：

```
public InvoiceMap()
{
    Id(x => x.InvoiceID, "InvoiceID");
    Map(x => x.InvoiceNumber);
    Map(x => x.InvoiceDate);
    Map(x => x.Company).CustomTypeIs<CompanyType>();
    Map(x => x.TransactionNumber).CustomTypeIs<TransactionNumberType>();
    Map(x => x.LongAddressBookNumber);
    Map(x => x.PurchaseOrderNumber);
    Map(x => x.ReceivedDateTime);
    Map(x => x.OCR);
    Map(x => x.DocumentNumber);
    Map(x => x.DocumentType);
    Map(x => x.PaymentStatus).CustomTypeIs<PaymentStatusType>();
    HasMany(x => x.Attestations)
        .KeyColumnNames.Add("InvoiceID")
        .Inverse()
        .Cascade.AllDeleteOrphan()
        .AsBag();
    HasMany(x => x.AttestationRequests)
        .KeyColumnNames.Add("InvoiceID")
        .Inverse()
        .Cascade.AllDeleteOrphan()
        .AsBag();
    HasMany(x => x.States)
        .KeyColumnNames.Add("InvoiceID")
        .Inverse()
        .Cascade.AllDeleteOrphan()
        .AsBag();
}

public AttestationMap()
{
    Id(x => x.ID, "AttestationID");
    Map(x => x.ReceivedAt);
    Map(x => x.IsInvalid, "Invalid");
    Map(x => x.InvalidationReason);
    Map(x => x.FileName);
    Map(x => x.FileData);
    References<EmployeeSnapshot>(x => x.Certifier, "Certifier")
        .Cascade.All()
        .FetchType.Join();
    References<Invoice>(x => x.Owner, "InvoiceID");
}

public AttestationReminderMap()
{
    Id(x => x.ID, "AttestationReminderID");
    Map(x => x.CC)
        .CustomTypeIs<RecipientType>();
    Map(x => x.Message);
    Map(x => x.SentAt);
    References<AttestationRequest>(x => x.Owner, "RequestID");
} 
```

有任何想法吗？

谢谢，克里斯托弗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T21:01:04.750

当您说什么都没有发生时，您的意思是没有刷新就没有数据库发生任何事情吗？

如果是这样，那是预期的行为。Flush 告诉 NHib 将它在内存中的更改写入数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T17:15:03.093

不知何故，我设法将会话的 FlushMode 设置为 Never。正如 Chad 向我描述的那样，这导致需要对 Flush 进行显式调用。当 FlushMode 保留其默认值并使用事务时，实体将按预期更新。

# javascript - prototype.js - Element.insert(Element) 在 IE 6 下被忽略？

> ID：941845
> 
> 赞同：3
> 
> 时间：2009-06-02T20:50:38.797
> 
> 标签：javascript, internet-explorer, internet-explorer-6, prototypejs

我在 XP 上使用 IE 6（企业强制版本）以及（主要）Firefox 3。在这些中，我正在使用原型 1.6.0.3 版制作 DHTML 表。

我有事件处理程序 javascript 代码来向表中添加一行，这在 Firefox 下工作正常，但在 Internet Explorer 下完全被忽略。我可以浏览 MS“脚本调试器”中的代码（是的，我知道它已经过时且已被弃用，但它是可用的），所以我知道该事件已被挂钩。

代码形式如下：

```
var xTable = $( 'x_list')  // id of x...
var aRow = new Element( 'tr')
aRow.setAttribute( 'id', id)
. . .
var xEl = new Element( 'td')
. . .
aRow.insert( xEl)
. . .
// alert( aRow.inspect() )
// alert( xTable.inspect() )
debugger  // check insert() implementation under IE
xTable.insert( aRow) 
```

有没有其他人遇到过 Element.insert() 和 Explorer 之间的冲突？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-02T20:54:40.537

您必须将新的 TR 元素插入 TBODY 而不是直接插入 TABLE。否则 IE 将不会显示/插入/无论如何。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T20:54:47.447

尝试在您正在使用的 中创建一个`<tbody>`元素`<table>`，然后附加到该元素而不是`<table>`.

这是我要尝试的第一件事。我隐约记得，如果没有`<tbody>`元素，对表格的 Javascript 操作会很奇怪。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-28T20:24:29.110

slosd完美地回答了它，只是一点点补充：IE7中也需要TBODY，但IE8中不需要。

# asp.net - RenderHint 和 ASP .Net 动态数据

> ID：941846
> 
> 赞同：1
> 
> 时间：2009-06-02T20:50:39.297
> 
> 标签：asp.net, dynamic-data

不久前，当 ASP .Net 动态数据刚进入测试版时，我们用它建立了一个测试站点，检查它的功能。它有点留在那里，没有引起太多关注。

我现在已经回到站点进行修改，你瞧，当我尝试加载站点时，我收到了这个错误：

> 找不到类型或命名空间名称“RenderHint”（您是否缺少 using 指令或程序集引用？）

有人经历过吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T04:53:56.220

我认为 RenderHint 是 UIHint？

您还需要包括以下命名空间：

```
using System.ComponentModel.DataAnnotations;
using System.ComponentModel; 
```

测试版后名称已更改。您应该能够通过查找和替换来修复它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T18:05:40.357

帮派！在进一步搜索时，我找到了 .Net 3.5 sp1 的自述文件，连同罗伯特哈维的回应，对我有好处！ [http://www.asp.net/downloads/3.5-sp1/Readme/#_Attributes](http://www.asp.net/downloads/3.5-sp1/Readme/#_Attributes)

# linq - 如何使用 Json Generic 反序列化对象搜索 List<>

> ID：941848
> 
> 赞同：0
> 
> 时间：2009-06-02T20:51:02.413
> 
> 标签：linq, json, .net-3.5

我需要使用来自 Json 对象的数据过滤通用列表。我在一个列表中有反序列化的对象`{name:'', value:''}`。我需要搜索一个数据合同（这也是一个列表），其中名称作为要搜索的字段，值作为字段的值。我如何完成这些，因为它们是通用的。这是方法：

```
public List<StaffingPositionsDataContract> GetStaffingPosition(string searchFilters)
{
    List<serializedForm> deserializedObject = JsonConvert.DeserializeObject<List<serializedForm>>(searchFilters);
    List<StaffingPositionsDataContract> staffingPositionResponse = new StaffingPositionsDataContract().LoadMockData();

    deserializedObject.ForEach(delegate(serializedForm filter) {

       });

    return staffingPositionResponse;
} 
```

我想尝试一些简单的事情：

```
var query = staffingPositionResponse .Where(filter.name + ".Contains(@0)", filter.value); 
```

但是，除了 2 个参数之外， Where 没有。提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T21:04:27.940

为什么不使用类似的东西

```
List<SerializedForm >.FindAll( delegate(SerializedForm filter)
{
   return filter.name.IndexOf(filter.value) != -1;
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T17:05:39.860

感谢一百万彼得！这是我最终满足我需求的内容：

```
 private bool DoesContractMeetFilter(List<SerializedForm> filters, StaffingPositionsDataContract position)
    {   
        return filters.FindAll(delegate(SerializedForm filter)
        {
            return string.Equals(position.PositionId.ToString(), filter.value) && 
                string.Equals(position.Series, filter.value) &&
                string.Equals(position.OrgLocation,filter.value) &&
                string.Equals(position.DutyStation, filter.value) &&
                string.Equals(position.BudgetStatus, filter.value)&&
                string.Equals(position.BudgetingEntity, filter.value) &&
                string.Equals(position.BFY, filter.value);
        }).Where(x => x.value != "" || x.value != null || x.value.ToUpper() != "ALL").Count() > 0;
    } 
```

这很好用，但如果我可以将它全球化，这样我的所有其他数据合约都可以使用它，我会印象深刻！

# ruby - 用 Ruby 编写二进制文件

> ID：941856
> 
> 赞同：33
> 
> 时间：2009-06-02T20:52:15.407
> 
> 标签：ruby

有没有像我们以前在 C/C++ 中那样将二进制数据写入二进制文件的简单方法？例如，如何在不使用花哨数学的情况下创建具有序列化 4 字节整数值的 4 字节文件？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-06-02T21:07:51.523

您可以使用[Array#pack](http://www.ruby-doc.org/core/classes/Array.html#method-i-pack)和[String#unpack](http://www.ruby-doc.org/core/classes/String.html#method-i-unpack)与二进制表示进行转换。将它们与[IO#write](http://www.ruby-doc.org/core/classes/IO.html#method-i-write)和[IO#read](http://www.ruby-doc.org/core/classes/IO.html#method-i-read)结合起来，你就可以走了。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2011-02-04T04:52:22.893

我最近在工作中遇到了类似的问题。我使用了[BinData](http://bindata.rubyforge.org) gem，它很有效。您只需执行以下操作：

```
File.open('test.bin', 'wb') {|file| BinData::Int32be.new(12345).write(file) } 
```

你不需要记住任何`Array#pack`代码。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-02T21:02:10.817

您可以使用多种方法`Marshal.dump`。`Marshal.load`

这是一个链接：[http](http://en.wikipedia.org/wiki/Serialization#Ruby) ://en.wikipedia.org/wiki/Serialization#Ruby 。

另一个将数据保存到文件中：[http](http://rubylearning.com/satishtalim/object_serialization.html) ://rubylearning.com/satishtalim/object_serialization.html 。

* * *

## 回答 #4

> 赞同：-12
> 
> 时间：2009-07-18T07:07:08.800

在我看来，红宝石不是为这样的任务而生的。如果您必须大量写入二进制文件，最简单的方法是为此编写一些 c 函数并从 ruby​​ 调用它们，使用 swig 很容易。我现在正在做同样的事情来编写一个突袭模拟器。

# algorithm - 关于：矩形旋转和拟合

> ID：941873
> 
> 赞同：3
> 
> 时间：2009-06-02T20:55:01.253
> 
> 标签：algorithm, math

努力工作后，我的大脑停止工作..（土耳其晚上 11 点 40 分）

我正在做轮换工作。：

变量：

```
_cx = horizontal center of rect
_cy = vertical center of rect
_cos = cos value of current angle
_sin = sin value of current angle

to rotating any point in this rect :

function getx(x, y)
{
      return _cx + _cos * (x - _cx) - _sin * (y - _cy);
}
function gety(x, y)
{
      return _cy + _sin * (x - _cx) + _cos * (y - _cy);
} 
```

我正在尝试在旋转过程之前将给定矩形的大小调整为适合原始边界的最大尺寸..我该怎么办？

谢谢你的提前

**编辑：Igor Krivokon 的解决方案**

该问题由 Igor Krivokon 解决，这是该解决方案的修改版本，适用于每个角度值

```
var h1:Number, h2:Number, hh:Number, ww:Number,
    degt:Number, d2r:Number, r2d:Number, deg:Number,
    sint:Number, cost:Number;
//@angle = given angle in radians
//@r is source/target rectangle
//@d2r is static PI / 180 constant for degree -> radian conversation
//@r2d is static 180 / PI constant for radian -> degree conversation
d2r = 0.017453292519943295769236907683141;
r2d = 57.295779513082320876798154814105;
deg = Math.abs(angle * r2d) % 360;
if(deg < 91)
{
    degt = angle;
}else if(deg < 181){
    degt = (180 - deg) * d2r;
}else if(deg < 271){
    degt = (deg - 180) * d2r;
}else{
    degt = (360 - deg) * d2r;
}

sint = Math.sin(degt);
cost = Math.cos(degt);

h1 = r.height * r.height / (r.width * sint + r.height * cost);
h2 = r.height * r.width / (r.width * cost + r.height * sint);
hh = Math.min(h1, h2);
ww = hh * r.width / r.height;
r.x = (r.width - ww) * .5;
r.y = (r.height - hh) * .5;
r.height = hh;
r.width = ww; 
```

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T21:30:02.743

如果您的原始尺寸为 h 和 w，并且您转动的是角度 phi，请尝试计算新高度

```
h1 = h*h / (w*sin(phi) + h*cos(phi)) 
```

和

```
h2 = h*w / (w*cos(phi) + h*sin(phi)) 
```

并选择 hew 高度 h' 作为 h1 和 h2 中的最小值。

然后，显然，新的宽度`w' = h' * w / h`。

请尝试一下 - 我没有时间测试我的数学 :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T21:13:38.203

将矩形分成 4 个较小的矩形。对角线将其切成两半（在旋转之前，从角到中心点），您将拥有 8 个三角形。您只需要其中的 4 个。旋转后，这些三角形的斜边伸出原始边界框。

确定斜边的公式（您有原始角度 45、-45、135、-135 和起点，即 mx+b），变换这些线（通过添加旋转来修改它们的斜率），将它们相交与边界墙的线（y = 0，y = w，x = 0，x = h，距离公式，测试无限情况）并找出哪个斜边最短（中心到墙，在拐角处）。由于所有的斜边一开始都是相同的长度，只需将它们全部调整到这个新值，你就有了新的矩形。

我做对了吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T21:14:58.543

```
function resize_factor()
{
    /* Find how far the upper-left corner sticks up beyond the top */
    overtop = gety(0, 0);
    /* Compute a vertical resize factor that would put that point at the top */
    /* (be sure to use floating point arithmetic) */
    vertical_resize = _cy / (_cy - overtop);

    /* Do the same for the lower-left corner sticking out beyond the left */
    /* (using 2*_cy for the height of the rectangle) */
    overleft = getx(0, 2*_cy);    
    horizontal_resize = _cx / (_cx - overleft);

    /* Return whichever resize constraint is stricter */
    return min(vertical_resize, horizontal_resize);
}

function resize_x(x)
{
    /* To get location of a point, after resize, before rotation... */
    /* ...multiply its resize factor by its distance from the center. */
    return resize_factor()*(x - _cx) + _cx;
}

function resize_y(y)
{
    return resize_factor()*(y - _cy) + _cy;
}

/* These resized coordinates can be used inside any other code you want: */
function getx_after_resize_and_rotate(x, y)
{
    return getx( resized_x(x), resized_y(y) );
} 
```

注意：此代码假定角度顺时针旋转小于 90 度（因为这就是您的图片所显示的）。如果你的角度是别的东西，你可能需要检查所有 4 个角，并确定哪些是最远的上方和左上方。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-10-06T03:00:36.207

```
 fitRect: function( rw,rh,radians ){
            var x1 = -rw/2,
                x2 = rw/2,
                x3 = rw/2,
                x4 = -rw/2,
                y1 = rh/2,
                y2 = rh/2,
                y3 = -rh/2,
                y4 = -rh/2;

            var x11 = x1 * Math.cos(radians) + y1 * Math.sin(radians),
                y11 = -x1 * Math.sin(radians) + y1 * Math.cos(radians),
                x21 = x2 * Math.cos(radians) + y2 * Math.sin(radians),
                y21 = -x2 * Math.sin(radians) + y2 * Math.cos(radians), 
                x31 = x3 * Math.cos(radians) + y3 * Math.sin(radians),
                y31 = -x3 * Math.sin(radians) + y3 * Math.cos(radians),
                x41 = x4 * Math.cos(radians) + y4 * Math.sin(radians),
                y41 = -x4 * Math.sin(radians) + y4 * Math.cos(radians);

            var x_min = Math.min(x11,x21,x31,x41),
                x_max = Math.max(x11,x21,x31,x41);

            var y_min = Math.min(y11,y21,y31,y41);
                y_max = Math.max(y11,y21,y31,y41);

            return [x_max-x_min,y_max-y_min];
        } 
```

# php - PHP：设置权限以便我可以写入文件？

> ID：941879
> 
> 赞同：1
> 
> 时间：2009-06-02T20:56:09.707
> 
> 标签：php, chmod

我正在尝试使用 PHP 创建一个文件，这是我的代码：

```
$file_to_send = 'ftp_test_from_created_file.txt';
chmod($file_to_send, 0777);
$fh = fopen($file_to_send,'w');
$tsv_line = 'Hey\tThese\tAre\tTab\tSeperated\tValues';
fwrite($fh, $tsv_line);
fwrite($fh, '\n');
$tsv_line = 'Hey\tThese\tAre\tToo';
fwrite($fh, $tsv_line);
fclose($fh); 
```

这显然给了我一个错误，因为我正在尝试对尚不存在的文件设置权限。虽然如果我跳过 chmod 调用，我会收到另一个错误，告诉我我没有设置权限。所以要么我处于生病的鸡与蛋的循环中，要么我需要设置包含目录的权限......但是如何？它尝试了所有以下内容：

```
chmod('../containingfolder/', 0777);
chmod('../', 0777);
chmod('', 0777); 
```

没有一个工作......我该怎么办？哦，顺便说一句，一旦我完成了，我需要改回权限吗？

谢谢！

**更新**我试过**chmod('.', 0777)**这是我得到的错误：

```
Warning: chmod(): Operation not permitted 
```

我试图制作这个文件的唯一原因是我可以将它通过 FTP 传输到其他地方，然后我计划 unlink() 它。那么是否有更好的方法呢？就像可能将文件存储在内存中以发送它（不知道这是否可能）？我也在使用PHP4。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T21:07:31.523

也可能是正在运行的 apache 服务器（如果它是 apache）无权更改该目录的权限。它可以将 root / root 作为用户 / 组，并且 apache 在 apache 组或 wwwuser 或其他东西上运行。

在父目录上执行 a`ls -l`并查看哪些用户和组有权访问此文件夹。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T21:04:21.593

要更改当前目录的权限，请使用

```
chmod('.', PERMISSION); 
```

你真的需要0777，即世界可读写吗？对我来说似乎很松懈！

**编辑**：您的建议 chmod('../ containsfolder/', 0777); 应该也有效。你能更详细地说明你得到的错误吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T21:09:50.707

在您的文档根目录之外创建一个目录，我们将调用该目录，`$tmpFolder`确保运行 Web 服务器的用户对其具有读/写权限。然后是以下内容：

```
$file_to_send = $tmpFolder . '/ftp_test_from_created_file.txt';
chmod($file_to_send, 0777);
$fh = fopen($file_to_send,'w');
$tsv_line = 'Hey\tThese\tAre\tTab\tSeperated\tValues';
fwrite($fh, $tsv_line);
fwrite($fh, '\n');
$tsv_line = 'Hey\tThese\tAre\tToo';
fwrite($fh, $tsv_line);
fclose($fh); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T22:19:22.923

如果运行 php 的用户无法修改条目，则无法设置条目的权限。查看 apache 的配置，搜索运行它的用户（默认为 www-data）。为了将来避免这些，请将自己设置为与默认组相同的组，并给文档 root chmod -R g+a

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T22:49:04.767

如果当前用户可以写入目录，您应该可以使用`file_put_contents()`.

```
<?php
$file = 'file_to_write.txt';
$data = "Tab\tseparated\tvalues\nMore\tseparated\tvalues";
file_put_contents($file); 
```

如果您没有写入当前目录（或任何目录）的权限，您将无法创建该文件，更不用说`chmod`它了。

如果您可以发布从`chmod()`命令中获得的错误，那将有所帮助。

```
chmod('.',0777); 
```

应该管用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T04:27:05.543

如果您想维护 chroot 监狱，但仍需要对当前目录进行 chmod 的权限，您将必须弄清楚如何使用带有 -S 选项的 sudo 并将 root 密码通过管道传输到 STDIN 以获得特权。

# c# - 自动登录谷歌并下载电子表格

> ID：941887
> 
> 赞同：2
> 
> 时间：2009-06-02T20:58:05.443
> 
> 标签：c#

我的 C# 应用程序读取和处理 Excel 文件。最近我把我的电子表格移到了谷歌文档。现在我需要登录 google 并访问特定链接（相当于导出）以获取我的应用程序读取的电子表格 (xls) 的导出形式。

我想知道是否有任何方法可以自动登录到谷歌并将 xls 文件保存到特定位置，这样我就可以避免登录和下载 excel 文件的麻烦。对此有什么想法吗？

（我正在考虑将 google 凭据和 xls 文件的链接保存在 xml 中）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T21:01:59.740

[Google Docs API](http://code.google.com/apis/spreadsheets/overview.html)可以选择以任何支持的格式[导出电子表格](http://code.google.com/apis/documents/docs/2.0/developers_guide_protocol.html#DownloadingSpreadsheets)。

```
GET /feeds/download/spreadsheets/Export?key=example_spreadsheet_id&fmcmd=4 
```

`fmcmd`“4”导出为 Microsoft Excel 格式 (xls)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-02T11:58:53.690

我使用此解决方案从 Google 电子表格简单地下载 CSV 数据。希望能帮助到你：

[https://gist.github.com/dhlavaty/6121814](https://gist.github.com/dhlavaty/6121814)

笔记：

1.  您的 Google 电子表格（Google Drive、Google Docs）文档必须设置为“**任何知道链接的人**”才能查看
2.  要获取 URL，请按 Google SpreeadSheet 上的 SHARE（右上角）并复制“ **Link to share** ”。
3.  现在将 &output=csv 参数添加到此链接

# attributes - 如何更改 Java 6 中的 MBeanAttributeInfo 描述字段？

> ID：941888
> 
> 赞同：8
> 
> 时间：2009-06-02T20:58:48.077
> 
> 标签：attributes, jmx

在我的标准 MBean 中，我想设置显示在 JConsole 中 MBeanAttributeInfo 标题下的描述字段。现在它的默认值是“为管理公开的属性”。当我在 MBean 中定义属性方法时，我似乎无法弄清楚如何设置它。我正在使用 Java 6 JVM。谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-05T22:02:01.130

Eamonn 曾经在[这里](http://weblogs.java.net/blog/emcmanus/archive/2005/07/adding_informat.html)有一篇关于它的非常好的帖子，我保留了链接，因为它可能会帮助其他人找出它的移动位置。当 Oracle 将 java.net 移入他们的社区页面时，它就丢失了。[此页面有类似的解决方案](http://udojava.com/2012/11/13/adding-descriptions-to-jmx-beans-using-an-annotation-wrapper/)

# javascript - 即使在调用 abort (jQuery) 之后，浏览器也会等待 ajax 调用完成

> ID：941889
> 
> 赞同：30
> 
> 时间：2009-06-02T20:59:02.103
> 
> 标签：javascript, jquery, xmlhttprequest, onbeforeunload, abort

如果用户导航到另一个页面，我想中止一些（可能）长时间运行的 ajax 调用。以下 jQuery 代码在离开页面时对所有挂起的 XMLHttpRequest 对象调用 abort：

```
$.ajaxSetup({
    beforeSend: function(xhr) {
        $(window).bind('beforeunload', function() {
            xhr.abort();
        });
    }
}); 
```

在一个测试用例中，我在调用服务器端操作时强制等待 10 秒。使用 Firebug，我确认当我单击页面上的任何链接时，上述代码确实会导致所有挂起的 ajax 调用立即停止。但是，浏览器仍会等待整整 10 秒，然后才能转到下一页。IE 似乎表现出相同的行为。这是已知的浏览器行为吗？在这种情况下，我能做些什么让用户立即离开页面？提前致谢。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-06-09T15:36:00.370

谢谢您的回复！事实证明，我完全错误地认为这是一个浏览器问题——问题出在服务器上。ASP.NET 对需要会话状态的同一会话的请求进行序列化，因此在这种情况下，直到这些 ajax 发起的请求完成后，下一页才会开始在服务器上处理。

不幸的是，在这种情况下，响应 ajax 调用的 http 处理程序需要会话状态。但是只读访问已经足够好了，因此通过使用 IReadOnlySessionState 而不是 IRequiresSessionState 标记处理程序，不会持有会话锁并且问题得到解决。

希望这些信息对其他人有用。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2010-07-19T18:36:10.640

关于托德自己对这个问题的回答......

我刚刚遇到了 PHP 的这个问题，同样的解决方案也可以。但是我需要会话中的信息。对于 PHP 开发人员，您可以调用[`session_write_close()`](http://php.net/session_write_close)以关闭并在请求中间写出您的会话。这将为其他请求释放会话。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-04T16:52:39.293

您可能想检查 abort() 的奇怪副作用

> 当使用 abort() 方法时，在 Explorer 和 Mozilla 中会触发 readystatechange 事件。更糟糕的是，readyState = 4，这意味着平均 xmlhttp 脚本假定数据已正确加载。这会产生非常奇怪的效果。

记录在这里：

[http://www.quirksmode.org/blog/archives/2005/09/xmlhttp_notes_a_1.html](http://www.quirksmode.org/blog/archives/2005/09/xmlhttp_notes_a_1.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-02T21:51:35.507

您确定您使用的是异步请求吗？如果浏览器在整个请求过程中阻塞，您使用的是同步请求（async 参数为 false）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-06-22T19:56:25.213

我正在使用的 Apache/Php 服务器也存在服务器问题。删除了不需要它的脚本上的 session_start (AJAX)，一切都按预期工作。感谢 Todd 指出了一个类似的问题！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-03-24T10:40:14.060

参考接受的答案：

[http://improve.dk/optimizing-performance-programmatically-setting-readonlysessionstate/](http://improve.dk/optimizing-performance-programmatically-setting-readonlysessionstate/)

关于`IRequiresSessionState`

> 这意味着，对于给定的会话，只有一个请求可以同时执行。来自同一会话的任何其他请求都将阻塞，等待会话被释放

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-09-26T14:30:35.403

对于 ASP.NET MVC，您可以使用以下`[SessionState(System.Web.SessionState.SessionStateBehavior.ReadOnly)]`.

更多信息可以在这里找到...... [http://johnculviner.com/asp-net-concurrent-ajax-requests-and-session-state-blocking/](http://johnculviner.com/asp-net-concurrent-ajax-requests-and-session-state-blocking/)

# c# - 为什么 ObjectDataSource 的匹配算法不如……灵活？

> ID：941890
> 
> 赞同：0
> 
> 时间：2009-06-02T20:59:35.173
> 
> 标签：c#, .net, asp.net, objectdatasource, sqldatasource

即使*UpdateNames*存储过程只接受一个名为*@First*的参数，我们仍然可以定义名为*Last*的附加参数，并且更新仍然会成功：

```
 <asp:SqlDataSource ... UpdateCommand="UpdateNames"
        UpdateCommandType="StoredProcedure">
        <UpdateParameters>
            <asp:Parameter Name="First" Type="String" />
            <asp:Parameter Name="Last" Type="String" />
        </UpdateParameters>
    </asp:SqlDataSource> 
```

但是在处理 ObjectDataSource 控件时，ObjectDataSource 中定义的参数个数必须与*UpdateNames()*方法中定义的参数个数完全匹配。因此，如果*UpdateNames()*只接受一个名为*First*的参数，以下将导致异常

```
 <asp:ObjectDataSource ... UpdateMethod="UpdateNames">
        <UpdateParameters>
            <asp:Parameter Name="First" Type="String" />
            <asp:Parameter Name="Last" Type="String" />
        </UpdateParameters>
    </asp:ObjectDataSource> 
```

A) 为什么 ObjectDataSource 的匹配算法不如 SqlDataSource 的匹配算法灵活，从而忽略任何额外的参数？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T21:03:53.653

ObjectDataSource 以一种灵活性换取另一种灵活性。

您的函数参数与列出的参数完全匹配是正确的，但这是有充分理由的。

ObjectDataSource 允许您定义多个函数来处理不同的参数，因此如果您想支持可以采用名字或名字和姓氏的 UpdateNames() 方法，您只需定义这两个函数并按照您认为合适的方式处理它们。

```
using System.ComponentModel;

[DataObject]
public class MyODS
{
    [DataObjectMethod(DataObjectMethodType.Update)]
    public void UpdateNames(string First)
    {
        UpdateNames(First, null)
    }

    [DataObjectMethod(DataObjectMethodType.Update)]
    public void UpdateNames(string First, string Last)
    {
        //Do the update
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T21:07:43.817

根据两者的经验，一个完整的猜测：

SQL 版本将只通过数组一个 SQL 脚本来执行存储过程，并在执行过程中附加变量。

ObjectDataSource 使用反射来查找与传递的参数匹配的更新方法。因此，如果在采用提供的参数的对象上不存在匹配的方法，它就会失败。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T21:08:03.347

你可以把它想象成你的 SqlDataSource 被“翻译”成 sql，这是完全有效的 sql：

```
DECLARE @First varchar(50)
DECLARE @Last varchar(50)
SELECT @First = 'some value', @Last = 'some other value'

SELECT * FROM [MyTable] WHERE FirstName= @First 
```

另一方面，您可以将 ObjectDataSource 视为使用反射函数（如`PropertyInfo.GetValue()`和）转换为调用`PropertyInfo.SetValue()`。如果您使用不存在的对象或字段调用其中一个，您将收到异常。

# javascript - 在使用 Javascript 添加订单项时，如何处理 HTML 元素 ID 和 Javascript 引用？

> ID：941891
> 
> 赞同：0
> 
> 时间：2009-06-02T20:59:37.217
> 
> 标签：javascript, html, dom, dhtml

首先，我阅读了所有听起来有点相关的建议问题，但没有找到任何解决我问题的东西。其次，如果这已经在某个地方得到解决，我没有很好地搜索它。最后，直奔问题。:D

我有一个页面上有一个“行项目”。就我们的目的而言，“行项目”只是水平行中的一堆 HTML 元素，它们形成一行 HTML 输入（例如，想象诸如 Pieces、Description、Weight、Unit Rate、Total Rate 等列）。我们订单项中的一个 HTML 控件实际上是一个自定义服务器控件，它发出一些 Javascript。除其他外，Javascript 更新了一个 X 类型的对象，如下所示：

`var whatever = new X(constructor values);`

现在，用户可以使用添加按钮添加行项目。目前，我只是克隆构成订单项的 HTML 的干净副本。这也克隆了 Javascript 代码，因此现在每个行项目都有`var whatever = new X(constructor values);`. 这带来了一个问题，因为有几行都引用了相同的 Javascript 变量（即`whatever`）。

当然，这会破坏所有 b/c 我需要将每个`whatever`'s 引用为单独的实例，而不是同一个实例。我想知道是否有处理这种情况的方法。如何使用自定义服务器控件但仍引用每行发出的 Javascript？或者如何以避免此问题的方式创建新订单项？

我是整个修改 DOM 使用 Javascript 领域的新手，我似乎找不到任何有用的最佳实践或示例，所以我有点不知所措。

这一切有意义吗？如果没有，请让我知道什么不是，我会尽力清理它。

**编辑：** 这是一个小代码示例。

这正是 JavaScript 对象声明的样子：

`var example = new SmartDropDown('uomSDD','75','1','7','','','','',2);`

第一个参数是呈现的元素之一的 HTML ID，因此我不能*只*使用数组（如其中一个答案中所述；很棒的答案，但是，直到我意识到我忘记提及那个细节）。我需要想出一种方法来更改 ID*并*使用数组。

SmartDropDown 对象上的一些方法是`ShowOptions`、`HideOptions`、`BindOptions`。

至于点击按钮时调用的代码，这里是：

```
function AddLineItem()
{
    var lineItemsParent = $("lineItems");
    var newRow = lineItemTemplateNode.cloneNode(true);
    lineItemsParent.appendChild(newRow);
} 
```

所以，总而言之，行项目 HTML 包含通常的东西：输入、选择、跨度等，然后是上面列出的 JS 声明。由于我添加新行项目的方式（使用上面的代码），JS 变量也被克隆。而且我需要一种方法来 1）更改元素的 ID 和 2）跟踪所有 JS 引用（已经建议使用数组）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T21:15:57.683

使用数组？

```
 var lineItems = [];
   ...
   // when the button is clicked
   lineItems[lineItems.length] = new X(constructor values); 
```

如果您需要同时生成一个新的 id，您可以在数组索引前添加一个字符串。

```
 var lineItems = [];
   ...
   // when the button is clicked
   var id = 'item_' + lineItems.length.toString()
   lineItems[lineItems.length] = new X(id, ...); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T21:15:29.043

这就是 JavaScript 框架真正派上用场的地方。许多人都有很好的构造函数，使这种类型的事情变得容易。例如，使用[Prototype](http://prototypejs.org)，我可以这样做：

```
function buildMe(counter) {
    var tempHTML = new Element('div',{'id':'bleh'+counter,className:'product'})
    tempHTML.insert(new Element('a',{className:'prodTitleLinkA',href:'/here'})

    $('someDiv').insert(tempHTML)
    Event.observe('bleh'+count, 'click', function(event) {
       alert(element.id)
    });
} 
```

这会创建一些元素，并将事件与它们联系起来。我可以尽可能多地向“someDiv”中推入，每个都有自己的 ID 和事件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T21:14:59.870

我想我需要更多的信息才能给你一个很好的答案。您能否展示一些示例代码如何调用您的此功能，分配给*var 的内容*以及您想要/可以提供的其他信息。越多越好！

如果可以的话，我很乐意提供帮助。

# captcha - 我该如何设计一个类似于 reCAPTCHA 的系统？

> ID：941894
> 
> 赞同：2
> 
> 时间：2009-06-02T21:00:01.493
> 
> 标签：captcha, recaptcha

我对 SO 上使用的 CAPTCHA 系统很着迷……我想更多地了解使 reCAPTCHA 起作用的“[许多因素”。](http://wiki.recaptcha.net/index.php/FAQ#reCAPTCHA_is_accepting_incorrect_words)可以理解的是，考虑到滥用的可能性，开发人员对他们系统的确切内部运作保持沉默......但是这种行为有据可查，所以也许我的好奇心仍然可以满足：

**如果我要设计一个 reCAPTCHA 的克隆，我该怎么做呢？**

* * *

reCAPTCHA 允许：

1.  打字错误
2.  在人们做它们的地方。*这表明我需要拥有有关错误的历史数据，然后基于此制定算法。*

打字错误的检测需要大量使用数据库：一个用于数字化书籍中的单词，另一个用于已知单词。

### 技术已知细节

1.  两个数据库：一个用于已知单词，另一个用于未知单词
2.  用于组合词的后续数据库

### 未知的技术细节

1.  如何快速分离单词，以便您看到来自不同数据库的单词组合？**这是关于信号处理的。**
2.  如何将两个数据库中的数据提供给用户？
3.  两个独立数据库中数据的初始形式是什么？PDF？
4.  当来自两个数据库的数据合并时，随后的数据形式是什么？.pdf？
5.  如何将数据从两个 pdf 文件合并为一个？
6.  如何有效地旋转图像？
7.  哪些算法用于将图像与书籍分开？

### 相关话题

1.  **信号处理**
2.  **微积分**：用于单词检测算法的系列，例如傅立叶和拉普拉斯。
3.  **概率论**：有一个“计算机-人”系数，仅当它通过时才通过，例如，具有 95 置信区间
4.  也许是**数论**：我们需要有效地存储和比较数据

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T21:01:47.790

[重新验证码](http://recaptcha.net/)

# asp.net - 覆盖单个页面的 ASP.NET 表单身份验证

> ID：941909
> 
> 赞同：5
> 
> 时间：2009-06-02T21:02:40.550
> 
> 标签：asp.net, asp.net-mvc, authentication, forms-authentication

在我们的 ASP.NET MVC 应用程序中，我们通过用户尝试访问仅授权页面时的`<authentication>`部分自动将用户重定向到登录页面。`<system.web>`问题是应用程序中间的一个操作，旨在供工具使用，需要在错误访问时返回直接的 HTTP 401 响应。如何在*没有*针对此特定操作的重定向的情况下返回真正的 HTTP 401 代码？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-02T21:33:54.637

以下解决方案有效，尽管我完全不确定它是最佳的：

```
public class HttpAuthenticationRequiredResult : ActionResult
{
    public override void ExecuteResult(ControllerContext context)
    {
        var response = context.HttpContext.Response;
        response.StatusCode = 401;
        response.AddHeader("WWW-Authenticate", "Basic realm=\"whatever\"");
        response.Flush();
        response.Close();
    }
} 
```

然后，您可以返回上述结果而不是 HttpUnauthorizedResult 以生成所需的 401 代码。然而，这对我来说感觉很糟糕。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-02T21:06:01.590

您可以`<system.web>`为单独的路径设置单独的部分。这是一个例子：

```
<configuration>
  <location path="Foo/Bar.aspx">
    <system.web>
      <authorization>
        <allow roles="GoodGuys" />
        <deny users="*"/>
      </authorization>
    </system.web>
  </location>
</configuration> 
```

在这种情况下，页面“Foo/Bar.aspx”被允许具有 GoodGuys 角色的人使用，但拒绝所有其他人使用。

在您的情况下，您可能希望在没有身份验证的情况下允许所有人：

```
<configuration>
  <location path="Foo/Bar.aspx">
    <system.web>
      <authentication mode="None" />
      <authorization>
        <allow users="*" />
      </authorization>
    </system.web>
  </location>
</configuration> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-21T15:51:51.103

有一个类似的情况，我需要返回一些触发不需要的重定向的东西（基本上是关于身份验证如何失败的消息，并且它正在重定向到登录屏幕而没有错误信息）。

这解决了问题：

```
Response.SuppressFormsAuthenticationRedirect = true; 
```

# c# - 我假设 SqlParameter.IsNullable 仅在……时才有意义？

> ID：941913
> 
> 赞同：2
> 
> 时间：2009-06-02T21:03:19.927
> 
> 标签：c#, .net, asp.net, gridview, objectdatasource

1) 当`SqlParameter.IsNullable`设置为 时`true`，接收到的`null`值被转换`DBNull.Value`并发送到数据库。因此，我假设设置`IsNullable`为仅在 GridView也设置为`true`时才有意义？`Parameter.ConvertEmptyStringToNull``true`

2) GridView 和 ObjectDataSource 的参数都有一个`ConvertEmptyStringToNull`属性。但是是否有过这种情况（尝试更新数据源时）：

• 我们应该将GridView 设置`Parameter.ConvertEmptyStringToNull`为`true`，然后将ObjectDataSource 设置`Parameter.ConvertEmptyStringToNull`为`false`？！

• 或者我们应该将 GridView 设置`Parameter.ConvertEmptyStringToNull`为`true`，而将 SqlDataSource设置`SqlParameter.IsNullable`为`false`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-01-29T20:24:42.640

Ans : 1: 当SqlParameter.IsNullable 设置为true 时，接收到的null 值转换为DBNull.Value 并发送到数据库。因此，我假设将 IsNullable 设置为 true 仅在 GridView 的 Parameter.ConvertEmptyStringToNull 也设置为 true 时才有意义？- 是的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-02-22T11:45:47.327

对所有问题的回答通常都是“否”，因为并非总是有 DataGrid，这不是显示数据和/或从用户那里获取输入的唯一方法。

如果您的用户界面以其他方式提供数据（例如 DetailView、FromView、手工制作的窗口或页面等），或者您根本没有 UI，并且您的数据来自其他来源，您可能有独立于不存在的 DataGrid处理`IsNullable`和/或属性！`ConvertEmptyStringToNull`

`IsNullable`特别是当你调用存储过程时，应该匹配sp的参数定义。

# asp.net - Asp.Net 模态“OK”正在触发验证......我该如何阻止它？

> ID：941918
> 
> 赞同：1
> 
> 时间：2009-06-02T21:04:18.020
> 
> 标签：asp.net, validation, modalpopupextender

我有一个弹出模式，只要有人访问页面（页面加载时）就会显示。模式是他们必须接受才能继续的协议。问题是，当他们单击接受时，它会触发所有客户端验证，显示所有错误消息。我显然不希望这种情况发生，因为用户甚至没有机会查看页面，更不用说填写表格了。如何阻止验证被触发？我已经将模态 ok/agree 按钮的 UseSubmitBehavior=false 设置为无济于事。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T21:06:36.067

CausesValidation 是否设置为 false？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T21:06:50.713

CausesValidaton="假"

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-06-16T18:38:35.297

由于某些奇怪的原因，当使用 UseSubmitBehavior=false 时，它​​提交了，但是当 UseSubmitBehavior 被禁止并且 CauseValidation 为 false 时，它​​没有提交......奇怪。

# sql-server - 共享读锁什么时候释放？

> ID：941928
> 
> 赞同：11
> 
> 时间：2009-06-02T21:07:33.037
> 
> 标签：sql-server, locking, isolation-level

当 SQL Server 联机丛书说“***读取操作完成后立即***释放资源上的共享 (S) 锁，除非事务隔离级别设置为可重复读取或更高，或者使用锁定提示来保留共享 ( S) 在事务期间锁定。”

假设我们谈论的是行级锁，没有显式事务，在默认隔离级别（读取已提交），“***读取操作***”指的是什么？

*   单行数据的读取？
*   单个 8k IO 页面的读取？
*   或者直到创建锁的完整 Select 语句完成执行，无论涉及多少其他行？

注意：我需要知道这一点的原因是我们有一个由数据层 Web 服务生成的几秒钟的只读选择语句，它创建页面级共享读锁，由于与行级独占更新锁冲突而产生死锁来自保持服务器更新的复制过程。select 语句相当大，有许多子选择，一位 DBA 建议我们重写它以将其分解为多个较小的语句（运行时间较短的部分），“以减少持有锁的时间”。因为这假设共享读取锁一直保持到完整的选择语句完成，如果这是错误的（如果在读取行或页面时释放锁），那么该方法将没有任何效果......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T21:15:27.577

实际上观看非常有趣，您可能想要启动分析器并跟踪一些简单查询的锁定获取/释放。我前一阵子这样做了，它类似于：获取第 1 页获取第 1 行获取第 2 行发布第 1 行获取第 3 行发布第 2 获取第 2 页发布第 1...

我可能不是 100% 正确，但这基本上是方法。因此，在读取行之后释放锁，或者更准确地说，它是在获取下一行锁之后。我怀疑这可能与保持一致的遍历状态有关。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-01-13T07:47:13.857

我不相信它会同时获得两个页面级锁。我认为它只以这种方式出现在分析器中，因为事件发生得如此之快。如果它像您怀疑的那样发生，总会有两个页面级锁，但是当运行一个带有共享锁的大型查询时，我有时会看到两个页面级锁，有时会通过这个查询看到一个：

```
SELECT *
FROM sys.dm_tran_locks
WHERE request_session_id = <SPID> 
```

所以，我认为正在发生的是：

1.  获取：db共享锁、表共享锁、页共享锁
2.  页面被读取...同时在页面上释放锁定并在下一页获取锁定

两者的结果是有时在 sys.dm_tran_lock 查询中。我看到两个 PAGE 锁，有时是一个和几次三个 .. 取决于同时操作期间发生的更快。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-01-07T17:09:58.270

关于具体文档，我发现了这一点：

> 如果 READ_COMMITTED_SNAPSHOT 设置为 OFF（SQL Server 上的默认设置），则数据库引擎使用共享锁来防止其他事务在当前事务正在运行读取操作时修改行。共享锁还阻止语句读取其他事务修改的行，直到其他事务完成。**共享锁类型决定何时释放。在处理下一行之前释放行锁。读取下一页时释放页锁，语句完成时释放表锁。**

来源：[https ://docs.microsoft.com/en-us/sql/t-sql/statements/set-transaction-isolation-level-transact-sql?view=sql-server-2017](https://docs.microsoft.com/en-us/sql/t-sql/statements/set-transaction-isolation-level-transact-sql?view=sql-server-2017)

# .net - 适用于旧版 VC++ 6.0 开发人员的 .NET

> ID：941930
> 
> 赞同：1
> 
> 时间：2009-06-02T21:07:46.453
> 
> 标签：.net, c++-cli

对于遗留 VC++ 6.0 开发人员来说，学习 .NET 的最佳书籍/方法是什么？由于各种原因，我对学习 C# 或 VB.NET 等新语言犹豫不决。我在 C++/Win32 编程方面经验丰富。我更倾向于学习 C++/CLI 以获得 .NET 开发经验。这是一个好方法吗？你做了什么让 .NET 暴跌？你必须学习 C# 还是 VB？我还计划购买以下书籍之一。有什么想法/想法吗？

1.  [http://www.amazon.com/reader/1430210532？*encoding=UTF8&ref* =sib_dp_bod_toc&page=5#reader](http://www.amazon.com/reader/1430210532?_encoding=UTF8&ref_=sib_dp_bod_toc&page=5#reader)
2.  [http://www.amazon.com/Foundations-CLI-Visual-Language-Experts/dp/1430210230/ref=pd_bxgy_b_text_b](https://rads.stackoverflow.com/amzn/click/com/1430210230)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T21:10:11.300

如果你想在你的程序中使用 .NET，你最好学习 C#。通过宏和自定义运算符定义，C++/CLI 确实是一种全新的语言。

C++/CLI 最适合 C#/pinvoke 无法处理的过于复杂的本机库互操作场景。

关于从 C++ 过渡到 C# 的一些有趣的事情：

1.  它是托管代码，因此您不必删除指针。
2.  在 C++ 中，您可以选择在堆栈或堆上实例化类型，具体取决于您声明类型的方式。在 C# 中，类型是在堆栈还是堆上实例化取决于类型本身，而不是您如何声明它：如果类型派生自 ValueType，则运行时会在堆栈上实例化该类型。如果该类型不是从 ValueType 派生的，则运行时会在堆上实例化该类型。
3.  在 C++ 中，结构和类是类似的，区别仅在于成员的默认可见性（结构默认为公共，类默认为私有）。在 C# 中，结构是 ValueType 并且具有特殊规则，例如没有继承。
4.  在 C++ 中，你有多重继承；在 C# 中，您具有单一继承和从接口继承的能力。C# 中的接口（本质上）是 C++ 中的纯抽象类型。

还有更多，但这些是一些常见的问题。这是一篇包含更多信息[的好文章。](http://msdn.microsoft.com/en-us/magazine/cc301520.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-02T21:14:46.440

不要害怕 C#。作为一名前 C++ 程序员（我想你会发现大多数人都是这种情况），我发现过渡到 C# 非常舒服。您的思维方式（如果您愿意的话）只需稍作修改即可很好地转化。该语言有一些怪癖，但随着我们从 C#1 到 C#3，事情变得更接近 C++ 开发人员看待世界的方式（例如泛型）。我会查看[C# 上的虚拟实验室](http://msdn.microsoft.com/en-us/aa740375.aspx)。它们相当不错，可以让您快速掌握该语言。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T22:58:01.287

使 c# 比使用 C++ 编程的 Win32 更容易学习的一个好处是类型检查非常强大 - 比 C++ 强得多。因此，一旦编译器对你调用带有一堆参数的东西没问题，你就知道它们是正确的类型。这对我来说是一场与 Win32 的斗争，很高兴不必重复这场斗争。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T23:09:44.023

我认为您正在考虑的书籍不是很好...它们试图涵盖太多，我认为没有太多用处。

有一本简短易懂的书“C# Text Manipulation Handbook”，它将让您习惯该语言的基本语法，并教您一些有用的字符串处理库，您将一遍又一遍地使用它们。然后你应该拿一本讲授最新语言特性的书，这些书通常包含在关于 LINQ 的书籍中（如 LINQ in Action）。这两本书都很短，但充满了好东西。

之后，您将想要获取特定于特定类型应用程序（WPF、WinForms、ASP.NET 等）的书籍。这应该包括使用 ADO.NET 从该应用程序类型访问数据库。

我每 5 年进行一次 C/C++ Win32 开发，此时我什至没有想过要回去。使用 .Net 平台，我可以完成更多工作。

# .net - .Net：类库项目中的参考 System.Web.UI

> ID：941937
> 
> 赞同：4
> 
> 时间：2009-06-02T21:09:04.967
> 
> 标签：.net

[设置焦点](http://ryanfarley.com/blog/archive/2004/12/21/1325.aspx)

我正在尝试在我拥有的类库中实现上述 Se Focus 代码。我要实现的类是调用 HtmlHelper 类，但我似乎无法在类库项目中引用 System.Web.UI 类。

您如何在类库项目中引用 System.Web.UI？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T21:12:18.910

您需要添加对 System.Web 程序集的引用（查看 .NET 选项卡）。也就是说，我查看了链接代码，您可以轻松地稍微翻转函数并返回一个字符串并释放对 System.Web.UI.Page 的依赖。从长远来看，这可能更有意义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T21:13:46.363

通常没有任何*技术*原因；也许如果您使用的是“新”东西……您是否检查过 dll 是否针对正确版本的框架？

但是，有很好的*架构*理由不这样做......抽象这些东西通常要干净得多，因此代码永远不会调用堆栈“向上”......只会向下调用。也许传入一个暴露这个的接口（UI 项目实现）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T21:16:14.127

添加对**System.Web**程序集的引用。

# ruby-on-rails - 在应用程序之间共享 Rails 会话

> ID：941939
> 
> 赞同：1
> 
> 时间：2009-06-02T21:09:52.533
> 
> 标签：ruby-on-rails, cookies

我有两个应用程序并希望他们分享他们的会话。这是微不足道的，至少到目前为止。现在我遇到了一些问题。

我在 environment.rb 中设置了相同的 session_key 和 secret，两个应用程序没有共享同一个会话。

验证 development.rb 是否有东西......什么都没有。

试图清理饼干等，没有。

然后我试图改变秘密，幸运的是我试图改变一些简短的东西（我的秘密）然后出现了一些尴尬的事情。运行应用程序 1 没问题，但运行应用程序 2 引发：

```
c:/ruby/lib/ruby/gems/1.8/gems/actionpack-2.3.2/lib/action_controller/session/cookie_store.rb:188:in `ensure_secret_secure': Secret should be something secure, like "f1e78444a4c3402165606a8314d29704".  The value you provided, "myownsecret", is shorter than the minimum length of 30 characters (ArgumentError)
    from c:/ruby/lib/ruby/gems/1.8/gems/actionpack-2.3.2/lib/action_c 
```

但是这两个应用程序都在 2.3.2 中运行。

然后我尝试了这两个应用程序的控制台并验证了秘密是非常相同的。

那么，这里有什么影响呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T16:36:03.377

可能跟域名有关？我很确定会话 cookie 是按域存储的。您可以尝试使用下面的代码来覆盖它 - 前提是您为每个应用程序使用具有不同子域的相同域（将其放入您的 config/environments/production.rb - 或 development.rb 如果您需要它工作开发模式）：

```
ActionController::CgiRequest::DEFAULT_SESSION_OPTIONS[:session_domain] =  '.yourdomain.com' 
```

**编辑：**在 Rails 2.3 中，语法是：

```
config.action_controller.session = { 
  :domain => ".yourdomain.com" 
} 
```

# flash - 用于在浏览器中进行 3D 可视化的 OpenGL 或 Flash

> ID：941944
> 
> 赞同：2
> 
> 时间：2009-06-02T21:12:18.377
> 
> 标签：flash, opengl, visualization, finance

我计划创建一个网站，让金融用户在 3d 中可视化外汇期权的价格。x = 标的物价格，y = 期权价格，z = 到期天数。换句话说，这不是一个简单的期权支付图，而是让您在 Z 轴上查看如果您在期权到期之前卖出的损益情况。

简而言之，我想要一个可视化工具。但考虑到损益表的表面可能相当“弯曲”，用户可以实时围绕空间旋转会很好。沿着与轴正交的任何平面向上切片表面并移动切片会很好。我希望它响应迅速。

如您所见，雄心勃勃（至少对我而言）。问题是，我希望所有这些都可以*在浏览器*中工作，理想情况下，我希望它看起来很棒，例如，可能通过照明使表面的“未来”部分变暗。

我搜查了亚马逊关于 Flash 的书籍（两本 Richard Shupe 书籍），并且我有 OpenGL 的红皮书和蓝皮书。它们是相当大的书籍，所以我想将自己应用于最佳解决方案。你有什么建议？？

对于 Google 为浏览器 3d 创建开放标准的愿望，我应该怎么看？蒸汽机？未来软件？

寻求和赞赏的建议。我有最后期限！！谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T21:13:31.323

您可能想要的是[O3D](http://code.google.com/apis/o3d/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T01:00:56.153

我可能会对此感到不满，但根本不需要任何插件就可以研究 HTML5 画布进行绘图。您可以使用[Processing.js](http://processingjs.org/)进行有限数量的 3D，但应该没问题。否则，我会寻找 3D 闪存引擎。O3D 目前是太多的蒸汽器皿。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T23:10:00.043

> 此答案可能包含过时的信息。请验证此答案并考虑提供包含最新信息的答案。

对于您今天要开始的项目，您很难击败 Flash，原因有以下几点：

*   有用。Flash 已经“企业级”10 多年了；您不会像使用更前沿的东西（或者更确切地说，流血的前沿）那样偶然发现一个引人注目的错误或大量未记录的调用。

*   它无处不在。Adobe 声称 97% 以上的浏览器都安装了 Flash 运行时。这是一个必须克服的巨大障碍——你可能拥有这个星球上最酷的小部件，但如果你的用户群必须下载一些古怪的 3rd 方插件，它们中的大多数都不会打扰。

*   它确实是跨平台的。我个人对 Flash 的感觉很复杂，但是伙计，它的跨平台支持真是太棒了。当然，Linux 支持参差不齐，而且它无法在我的 iPhone 上运行，但仅此而已。

在硬币的另一面，我不确定是否有一种方法可以在浏览器中使用 OpenGL 而无需大量胶水。将 OpenGL 用于浏览器工具开始听起来像 Java Applet，或者大量的原子驱动的 javascript，在那时，您或多或少地重新实现了 Flash。:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T21:24:19.103

我建议看一下用于 Flash 的[Coppercube](http://www.ambiera.com/coppercube/index.html) 3D 引擎，目前处于测试阶段。这可能是矫枉过正，或者它可能无法满足您的最后期限，但它非常酷。还有一个可用的[演示](http://www.irrlicht3d.org/pivot/entry.php?id=891)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T22:55:05.393

Flash 如此受欢迎的原因之一是它总是相同的实现。虽然基于更开放的标准，但您会遇到不同的人以不同的方式解释极端案例的问题。

对我来说，闪光灯的另一大优点是它的打印效果很好。如果从 Flash 触发打印，打印将呈现为矢量，因此它非常适合打印机缩放。我在我的齿轮模板生成器中使用它。（[http://woodgears.ca/gear_cutting/template.html](http://woodgears.ca/gear_cutting/template.html)）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T20:04:52.657

我要和Flash一起去。

由于性能和灵活性，OpenGL 在独立应用程序中很有吸引力。但是对于即时部署来说，Flash 为我提供了我所需要的基础知识，并且随着 Adob​​e 构建平台而具有增长潜力。

不过，我将密切关注开放标准，并尝试以可移植的方式编写代码；）

谢谢大家的回答。。

# memory - 将内存从 2GB 升级到 4GB 可以防止 Stack Overflow 异常吗？

> ID：941952
> 
> 赞同：8
> 
> 时间：2009-06-02T21:14:15.190
> 
> 标签：memory, stack-overflow

我的电脑有 2GB 的 RAM 内存。当我在 C# 2008 Express Edition 中形成一个包含 70.000 个项目的数组的 3D 网格对象时，我收到错误消息“堆栈溢出异常处理...”。如果我将 RAM 内存从 2GB 升级到 4GB，我可以克服这个错误消息吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-06-02T21:17:35.183

几乎可以肯定**不是**。堆栈溢出（而不是内存不足）意味着您已经消耗了分配的**堆栈**空间 - 但堆栈（相对而言）很小。**堆**是所有事情发生的地方......

选项：

*   修复你的无限递归错误......
*   将数据移动到数组/列表/一些基于堆的存储中（现在在哪里？）
*   避免深度递归
*   避免过大的结构......你有一些真正应该是类的大胖结构吗？（如果你对它们眨眼，结构就会自我复制）
*   **如果**您确信自己只是将其翻倒，则增加堆栈空间，并且不值得进行大的重构（我讨厌这个答案）-为此，您需要使用更大的堆栈生成自己的线程

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-06-02T21:16:41.630

不会。增加 RAM 不会增加堆栈大小。

您正在编写导致堆栈溢出的代码（可能是由于递归），您需要修复它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-02T21:30:13.443

物理内存只影响机器中运行的程序的性能，而与程序的任何内存相关问题无关（在标准操作系统上，嵌入系统遵循不同的规则）。

首先，因为这个错误我已经见过很多次了，我们来谈谈操作系统的内存模型。

几乎每个用户操作系统（我在这里考虑的是 linux、windows、bsd 等）都使用虚拟内存模型。虚拟内存模型意味着每个程序都可以完全访问私有虚拟内存，即不必具有相应物理内存的内存存储表示。

这个虚拟内存的大小等于单个机器寄存器可以寻址的范围。在 32 位操作系统上，这意味着大约 4GB。现在，不管你的系统有多少实际内存，你的程序总是认为他有 4GB。

现在，这 4GB 实际上是在您的程序和操作系统为在内核模式下处理数据以及维护程序所需结构而保留的空间之间共享的。根据您的配置（您的操作系统配置），您可以根据实际情况计算大约 2 或 3 GB。所有这些都与您拥有的物理内存量无关，您可以拥有 256 MB 的 RAM，但您的程序仍然会认为他有 2GB 可供使用。

当您分配内存时，系统通常不会准确地提供您要求的内存量。相反，它使用页面，这是分配给您的进程的保留内存块（例如 4KB）。当您这样做时，操作系统会将该“页面”注册为已分配，但这仍然在虚拟内存中。在内部，操作系统管理这些页面中的哪些保留在物理内存中，哪些在交换中（在 HDD 中）。这就是增加 RAM 可以提高性能的原因（更多页面可以同时在主内存中，并且您必须从 HDD 中读取更少）但无助于堆栈溢出（或内存不足异常）道路）。

这就是**为什么**增加 RAM 无济于事。

最后，关于 Stack Overflow 异常……好吧 不看实际代码很难说，已经给出了一些好的答案。

大多数堆栈溢出来自无限递归，无论是直接还是间接（A-->B-->C-->A），但在您的具体情况下，我会说您只是分配给堆栈中的大量数据。

你有一个 70000 大小的数组。我猜这个数组充满了值类型，它们被分配在堆栈中，如果我没记错的话（请不要把这当作事实）在.NET中是1MB，这可能是你得到的原因你的堆栈溢出。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-02T21:28:09.767

堆栈溢出可能意味着无限递归或非常深的嵌套。

顺便说一句，如果您有尾递归方法，x64 JITter 将优化它们，您根本不会遇到堆栈溢出（并且您的无限递归将是......无限）。

所以你可以升级到 64 位操作系统，或者修复你的代码以免遇到这个问题（这更可能是一个错误而不是太深的嵌套递归......）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-02T21:19:11.080

可能不是。您应该[增加堆栈大小](http://www.atalasoft.com/cs/blogs/rickm/archive/2008/04/22/increasing-the-size-of-your-stack-net-memory-management-part-3.aspx)，这就是错误消息所说的

编辑：或者修复代码中可能存在的无限递归。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-02T21:35:15.507

实际上，没有。但我有一个不同的原因：除非您在 boot.ini 中指定特定的引导选项，否则 Windows XP 最多只能处理 2 GB。（/3gb 参数。）在最好的情况下，Windows XP 和 Vista 将达到 3 GB 的 RAM，这基本上是 Windows 的限制。有关这些限制的更多信息，请参阅[此链接](http://msdn.microsoft.com/en-us/library/aa366778.aspx)。

增加 RAM 并修复应用程序以超过 2 GB 限制可能会修复堆栈溢出，因为它可能会增加堆栈的大小。它也可能只是延迟此堆栈溢出的时刻，因为正如已建议的那样，您的代码处于无限递归循环中，并且将继续运行直到资源不足。

如果您确实使用递归，请记住这一点：您使用递归所做的任何事情都可以在不使用递归的情况下重写。这条规则没有例外，尽管代码不会更容易阅读。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-21T23:56:04.863

我不知道 C#，但在 java 中，stackoverflow 错误意味着您正在创建已在您尝试实例化的类中实例化的类的实例

# asp.net - 涉及会话状态的可扩展 Web 应用程序的最佳实践设计是什么

> ID：941974
> 
> 赞同：0
> 
> 时间：2009-06-02T21:18:04.670
> 
> 标签：asp.net, linq, architecture, web-applications, session-state

我问这个的原因是最近设计了一个应用程序，最初想不使用会话状态来保持简单，但最终屈服于使用会话状态来存储状态的想法。我知道迁移到网络场解决方案将涉及配置会话状态以在 sql 中运行。但是，我从未遇到任何解释序列化是必要的信息。所以不，我需要重构代码来实现这一点。

此外，我使用 linq to sql 给我数据对象。理想情况下，这很容易序列化，但似乎不是直截了当。

我用谷歌搜索过，这样做应该没问题。问题不是如何序列化 linq 数据类，而是：

会话状态是前进的方向吗，特别是在网络场上设计可扩展应用程序时，我们是否应该使用其他方法，在使用 linq 进行数据访问时推荐什么，我们是否应该使用查询字符串等。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T21:26:16.977

**有很多（真的）方法可以做到这一点**

存储会话状态是许多网络农场/应用程序的基本要求。您可以使用 LINQ->SQL 将其存储在数据库中，也可以使用 SAN 上的平面文件。只要您有某种方法可以从存储格式序列化为本地语言格式，这真的没关系（除了从性能角度来看）。

在 PHP 中，会话处理程序以字符串的形式映射到会话表。在 Python 中，您*可能会将*一个对象编组为一个字符串并存储它。

我会推荐以任何形式访问的 SQL 后端，因为 RDBMS 是为并发访问而设计的，因此您无需担心锁定等问题。它的扩展性和**RDBMS 一样好**

**你可以使用像 SQL Alchemy 这样的东西**

```
Session = sqlalchemy.orm.sessionmaker() session = Session() 
```

来自 [http://www.darrellhawley.com/2009/01/sql-alchemy-orm-b​​asics.html](http://www.darrellhawley.com/2009/01/sql-alchemy-orm-basics.html)

**或者在这里**

[http://idunno.org/articles/277.aspx](http://idunno.org/articles/277.aspx)

**或者这个来自 Microsoft 的 HOWTO 称为“如何：配置 SQL Server 以存储 ASP.NET 会话状态”可能会有所帮助**

[http://support.microsoft.com/kb/317604](http://support.microsoft.com/kb/317604)

哪个提供

```
<sessionState 
    mode="SQLServer"
    sqlConnectionString="data source=127.0.0.1;user id=<username>;password=<strongpassword>"
    cookieless="false" 
        timeout="20" 
/> 
```

如果不查看您的应用程序需求，则无法确定是否需要会话状态。但归根结底，状态就是状态，访问该状态的要求（读取繁重、写入繁重、大、小等等）决定了您如何存储它以及以什么格式存储它。

我会推荐在类似 hashmap 的对象到 SQL 表之间的 ORM 映射或 hashmap 的序列化，这样

```
session = load_from_sql(session_id)
someval = session['var'] 
```

将值保存为字符串或原生对象取决于您选择的 ORM、您的语言是否容易等等。性能也是一个因素，以及数据库占用空间。您可能会发现存储简单变量字符串和按需解组更简单。您可以存储 JSON 类型，然后将它们转换为本机。

很多要考虑...

SQL 可能是最简单的，无论是 ORM->session_object 还是映射到哈希表的一组元组。

**祝你好运**

# vb6 - 在VB6中的线对象上绘制箭头

> ID：941976
> 
> 赞同：0
> 
> 时间：2009-06-02T21:19:06.727
> 
> 标签：vb6

使用 VB6，我有一个线对象，用户可以在其端点处拖动它，我只想在它的中间放一个箭头来显示线的方向。

有没有一种简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T04:21:52.017

德马蒂格，

这应该做你需要的。您可能需要稍微调整一下以将箭头放在行的中间而不是行尾：

在 Visual Basic 6 中的两个向量之间绘制箭头：
[http ://www.vb-helper.com/howto_draw_arrows.html](http://www.vb-helper.com/howto_draw_arrows.html)

# asp.net-mvc - 首次使用 ASP.NET MVC 时的主要风险

> ID：941978
> 
> 赞同：10
> 
> 时间：2009-06-02T21:19:41.077
> 
> 标签：asp.net-mvc

我们计划在一个相对重要的（对业务而言）项目上使用 ASP.NET MVC。开发团队由 4 名开发人员和 1 名技术主管组成。其中 2 位开发人员和技术主管曾在 ASP.NET WebForms 项目上合作过，并且对使用该技术充满信心。

当我们回顾在我们的第一个 WebForms 项目中使用的一些方法时，我们有点畏缩（示例包括过度使用 UpdatePanels、缺乏对 ListView 等控件的了解、臃肿的 ViewState 等）。

重要的是，我们不要在一年后回顾这个项目，并对我们的一些 ASP.NET MVC 方法感到畏缩！

根据经验，第一次使用 ASP.NET MVC 时，是否有人有任何可以引用的关键风险？

我在考虑陷阱，需要一段时间才能继续使用的灯泡，在你学会一个特定项目之前你觉得你正在战斗的部分框架，诸如此类的事情。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-02T21:25:28.507

**使用强类型视图并为每个视图创建一个新模型**

原因很简单：那是为了确保您的模型与视图分离。如果你需要进行重构，你只需要破坏一个部分。因此，如果您有一个名为“Latest News”的视图，则应该有一个“LatestNewsViewModel”。然后控制器的工作就是从实际的模型/数据库中获取数据并创建一个视图模型并将其传递到您的视图中。此外，如果您决定需要在视图中添加其他内容，则不必重构整个数据访问层，因为您只需更改 ViewModel 和填充它的控制器操作。

**表现**

我建议查看[此幻灯片](http://www.slideshare.net/rudib/aspnet-mvc-performance)，了解可能产生巨大影响的性能问题和优化。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T21:25:53.467

您可以从 Scotts Guthrie 的博客下载免费[电子书](http://weblogs.asp.net/scottgu/archive/2009/03/10/free-asp-net-mvc-ebook-tutorial.aspx)，它为您提供了有关如何从头开始构建 ASP.NET MVC 站点的完整深入指南。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-02T21:26:31.797

我见过的最大风险来自回归无国籍媒体。

回传不见了。大多数服务器控件都消失了。视图状态消失了。事件驱动模型消失了。

如果您的开发人员只使用 asp.net webforms 来构建站点，而从未使用其他 web 技术，那么他们需要大量学习。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T21:23:02.460

对我来说最重要的是理解模型绑定并且您可以拥有类型化的视图。

还可以正确保护您的路线。

# java - 如何通过网络发送课程

> ID：941983
> 
> 赞同：2
> 
> 时间：2009-06-02T21:22:22.337
> 
> 标签：java, serialization, classloader

我有以下问题：我想通过网络发送一个类型（java.lang.Class）并在另一端“定义”类。

我试过这样：

```
ByteArrayOutputStream bos = new ByteArrayOutputStream();
ObjectOutputStream oos = new ObjectOutputStream(bos);
oos.writeObject(MyClass.class); 
```

在接收端：

```
ByteArrayInputStream bis = new ByteArrayInputStream(request.getBytes());
ObjectInputStream ois = new ObjectInputStream(bis);
Class c = (Class) ois.readObject(); // ClassNotFoundException 
```

所以很明显我需要发送类的原始字节码并做一个

```
ClassLoader.defineClass(bytes, .. 
```

但不幸的是，我看不到如何检索已加载类的字节码。我正在寻找类似的东西：

```
byte[] byteCode = MyClass.class.toByteArray(); 
```

这甚至可以使用标准 JDK，还是有任何小的库可以做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T21:34:44.557

我不认为你想要的东西是可能的。从字节码定义类的行为是不可逆的。但是，您应该能够做的是直接读取字节码文件（假设它是一个`URLClassLoader`）：

```
MyClass.class.getResourceAsStream("Myclass.class") 
```

或者，您可以通过 HTTP 访问类文件并直接`URLClassLoader`在接收端使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T22:12:50.113

你不能凭记忆做到这一点。您必须有定义类的字节码，对于大多数类，可以通过询问 JVM 找到。[http://www.exampledepot.com/egs/java.lang/ClassOrigin.html](http://www.exampledepot.com/egs/java.lang/ClassOrigin.html)中的这段代码应该可以帮助您入门：

```
// Get the location of this class
Class cls = this.getClass();
ProtectionDomain pDomain = cls.getProtectionDomain();
CodeSource cSource = pDomain.getCodeSource();
URL loc = cSource.getLocation();  // file:/c:/almanac14/examples/ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T21:25:53.547

你应该检查[java序列化接口](http://java.sun.com/developer/technicalArticles/Programming/serialization/)

编辑 ：

我重新阅读了您的帖子，您正在谈论在另一边定义课程。这使我认为您要完成的是[通过网络分发对象](http://oreilly.com/catalog/javadc/chapter/ch03.html)。

此外，如果您的服务器和客户端共享相同的接口，您可以简单地通过[java 反射创建对象](http://java.sun.com/developer/technicalArticles/ALT/Reflection/)

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2009-06-02T21:25:54.670

您可以编写自己的序列化方法。

所以

```
public byte[] Serialize()
{

// serialize each field in turn here.

return data;
}

public void Deserialize(byte[] data)
{

// deserialize data in the same order it was serialized.

} 
```

这是我们在 .Net 中实现的用于序列化的方法。这种方法的关键是它让您完全负责序列化。如果您不打算拥有此类通信的任何版本，但随着产品的增长，对于多个版本，这是我们发现的为数不多的可靠方法之一。

我们通过实现iserializable接口（java中可能不存在，不过是自己实现的简单接口），使用内存流对象写出各个数据域，复杂对象的级联写入。

我们在企业服务器上使用与在客户端上相同的 dll。

无论您在哪个平台上，序列化都是一个问题。

# c# - 你如何命名你的 ViewModel 类？

> ID：941985
> 
> 赞同：19
> 
> 时间：2009-06-02T21:22:35.690
> 
> 标签：c#, asp.net-mvc, model-view-controller

什么样的命名约定适合 ViewModel 类？

示例：对于 HomeController，索引视图？HomeIndexViewModel 似乎不对。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-06-05T22:07:28.717

我使用以下模式，因为它清晰明确：

*   型号：Foo
*   视图：FooView
*   视图模型：FooViewModel

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-02T21:24:31.037

员工视图数据。

这就是我使用的，也是我在示例应用程序中看到的。

**关于您添加的示例：**恕我直言，该类的名称应指定其包含的数据类型。“....IndexViewData”相当没有意义。该页面上究竟显示了什么？尝试用 1 或 2 个单词对其进行总结，并在其后面添加“ViewData”。

或者只是取控制器的名称并删除“索引”。HomeViewData 对我来说听起来不错。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T03:19:59.807

我试图让我的演示模型名称与它们将呈现的演示类型无关。我最初可能将我的模型对象用于 ASP.NET 视图，但稍后我也可能在 WCF 或 WinForms 应用程序中使用它。我尝试给我的模型命名，使它们能在逻辑上描述它们包含的内容，而不会用“ViewData”、“ViewModel”、“Model”等混淆它们。

例子：

```
ProductsWithPageInfo
ProductWithAttributesAndTags
ClientAndBillingDetail
UserAccountWithAssociatedGroups 
```

等等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T03:15:11.140

我更喜欢 HomeViewModel，或者使用之前的员工示例 CreateEmployeeViewModel、EditEmployeeViewModel 等。这个想法是“ViewModel”强调我们正在处理表示问题的事实，并消除了 ViewModel 与您可能拥有的任何域模型对象的歧义.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-05T21:54:19.773

我一直使用信封这个术语作为我名字的一部分，我在阅读 Wrox 书的第 1 章并发现更普遍接受的术语是 ViewModel 之前不久就开始使用它。

但是，我创建的这些 ViewEnvelopes 仅用于非常简单的封装，当我有两个或多个（通常不相关的）强类型模型我想交给我的 View 时。它们*不*包含任何其他功能——在这个意义上，信封仅用作交付机制，而对我来说，术语 ViewModel 似乎不太能描述我如何使用它，而且对于它的含义也可能更加模棱两可真正的目的是。

例如，我可能会创建一个 CustomerUpdateEnvelope 类，该类的存在只是为了将一个 Customer 对象和一个不相关的 NewsTicker 对象传递给我的 Customer Update 视图。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-25T10:52:23.413

[对于这个特定的线程来说已经很晚了，但我已经在博客文章中写了一些关于ViewModel 命名约定](http://www.appetere.com/Blogs/SteveM/April-2012/MVC-Framework-ViewModel-naming-conventions)的更详细的建议，这可能对其他人有用。

# sql-server-2008 - SSMS 2008 任务列表

> ID：941986
> 
> 赞同：12
> 
> 时间：2009-06-02T21:22:43.630
> 
> 标签：sql-server-2008

在 SQL Server Management Studio 2008 中有一个与 Visual Studio 中的任务列表非常相似的任务列表，我似乎不知道如何使用它，也找不到除 Visual Studio 文档之外的任何文档不适用，因为注释语法是 TSQL 独有的... SSMS 2008 中的任务列表可从“其他窗口”下的“查看”菜单中的“任务列表”访问。使用带有查询的解决方案并添加注释，例如：

```
-- TODO: testing task list 
```

或者

```
/* TODO: testing task list */ 
```

什么也没做。这只是视觉工作室外壳的一些遗物吗？我能够找到关于 SSMS 2005[功能的反馈请求，](http://connect.microsoft.com/SQLServer/feedback/ViewFeedback.aspx?FeedbackID=126635)该请求与任务列表有关，他们希望将其放入下一个版本 (SSMS 2008) 的响应中

有没有人让这个功能工作？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-07-23T14:51:12.453

我在 SSMS 中找不到将任务添加到此列表的任何方法，就像我找不到任何方法来使用也存在的“输出”窗口一样。乍一看，它似乎是 Visual Studio 的保留，但您发现的功能请求似乎对此提出异议，并表明它确实有用。

即使打开了 SQL 项目，我仍然无法添加任务，所以我不知道它在 2008 年是否可以正常工作。

# c# - 动态定义类型化数据集？

> ID：941988
> 
> 赞同：2
> 
> 时间：2009-06-02T21:24:11.193
> 
> 标签：c#, asp.net, strongly-typed-dataset, activator, createinstance

我正在尝试在运行时在我的代码中动态创建类型化数据集的实例。我有可用的类型，但是当我尝试这样做时：

```
object obj = Activator.CreateInstance(Type.GetType("TYPED DATASET TYPE HERE")); 
```

问题是当我尝试运行它时，根据代码，该类型似乎无效。我在这里做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T21:27:42.637

类型在哪里定义？（哪个大会）。

除非您给它一个程序集限定名称，否则它只会查看*调用*程序集和其他一些关键程序集。选项：

*   使用程序集限定名称（“somen.amespace.sometype, someassembly, ...”）
*   获取`Assembly`实例（从该程序集中的已知类型），并`GetType(fullyQualifiedName)`在`Assembly`实例上使用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T21:29:09.263

假设您发出正确的数据集代码，您可能还需要加载程序集。

查看以下 .net 命名空间反射.emit 和反射。

您还可以查看诸如 windsor 之类的开源项目，它们使用反射来发出新类以创建拦截器。那里可能有你可以学习的代码。*************