# StackOverflow 问答 000661000-000661999

# .net - 适用于 VB6 和 .net 应用程序的最佳 IPC

> ID：661003
> 
> 赞同：1
> 
> 时间：2009-03-19T03:47:54.173
> 
> 标签：.net, vb6, ipc

在我们的应用程序（文档管理系统）中，我们应该被通知屏幕更改（或通知另一个程序屏幕更改），以保持两个应用程序查看相同的数据，一个是订单履行应用程序，另一个是原始传真的文档查看器。履行应用程序使用 vb6 编写，文档管理器使用 .net 3.5 (c#)。它在终端服务器上运行，因此它也必须是会话感知的。可以先打开文档查看器或履行应用程序，并且可以在没有另一个的情况下使用两者。IPC 的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T14:01:17.227

如果您希望能够在 Vista 或 Windows 7 上运行，最好的 IPC 形式将是 TCP（这很容易在 VB6 中使用 Winsock 控件完成）。

这样做的好处是两个应用程序可以通信，即使它们不是以同一用户身份运行，它们也可以通信（在 Vista+ 下使用 SendMessage 或命名管道无法做到这一点）。您唯一需要记住的就是在防火墙中设置一条规则，这样它就不会被阻止。这可以在您的安装程序中完成：

```
netsh.exe firewall set allowedprogram "{PROGRAM PATH}" "{PROGRAM NAME}" enable 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T13:23:34.223

命名管道和邮槽仍然是一些可用的最佳选择，它们可以跨用户和跨进程工作。当然，在 Vista+ 中，以不同完整性级别运行的进程存在问题，并且安全性也适用于早期的操作系统——就像文件安全性一样。

TCP 在同一台机器上总是慢得多，甚至可能比跨进程的 WM_COPYDATA 更​​差。

使用管道或邮槽，您可以通过将会话 ID 作为名称的一部分来处理终端服务。TCP 将始终受到其有限的端口号“命名空间”的挑战（想象一个硬盘驱动器只能包含名为 0 到 65535 的文件 - 每个连接都需要两个端口号）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-20T18:03:07.440

Kris 的答案可能仍然是最好的选择，但您可能需要一个杂凑来保持终端服务器的理智。

在您想充当“服务器”应用程序的任何应用程序上，您都可以打开一个未使用的端口，并将其显示为输入到“客户端”应用程序中。甚至可能利用环境变量。根据您的需要，这种方法可能都是错误的。

如果您只有两个应用程序，其中一个需要在另一个更改时通知（而不是通知实际更改的内容），您可以通过发送和挂钩 Windows 消息来做到这一点。

# java - JSTL 其中元素名称包含空格字符

> ID：661008
> 
> 赞同：5
> 
> 时间：2009-03-19T03:50:55.680
> 
> 标签：java, jsp, jstl

我有一个可用的值数组，但不幸的是，一些变量名包含一个空格。我无法弄清楚如何在页面中简单地输出这些。我知道我没有很好地解释这一点（我是 JSP 设计人员，而不是 Java 编码人员），所以希望这个示例能够说明我正在尝试做的事情：

```
<c:out value="${x}"/> 
```

输出到页面（人工包装）为：

```
{width=96.0, orderedheight=160.0, instructions=TEST ONLY. This is a test.,
 productId=10132, publication type=ns, name=John} 
```

我可以使用输出名称

```
<c:out value="${x.name}"/> 
```

没问题。问题是当我尝试获取“出版物类型”时......因为它有一个空间，我似乎无法`<c:out>`显示它。

我试过了：

```
<!-- error parsing custom action attribute: -->
<c:out value="${x.publication type}"/>
<!-- error occurred while evaluating custom action attribute: -->
<c:out value="${x.publication+type}"/>
<!-- error occurred while parsing custom action attribute: -->
<c:out value="${x.'publication type'}"/>
<!-- error occurred while parsing custom action attribute: -->
<c:out value="${x.publication%20type}"/> 
```

我知道真正的解决方案是正确格式化变量名（即：不带空格），但我有一段时间无法更新代码。这可以做到吗？非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-19T03:58:08.080

你有没有尝试过：

```
<c:out value="${x['publication type']}"/> 
```

我假设 a`Map`是这背后的 Java 类型。

# .net - ECMA-335 CLI 规范是否有 HTML 版本？

> ID：661010
> 
> 赞同：4
> 
> 时间：2009-03-19T03:51:55.117
> 
> 标签：.net, command-line-interface

我目前正在写一篇关于 CLI 内部的博文，并尝试引用一些内容。主要在 Partition III 文档中。

我目前正在链接到它的 ECMA 页面，那里有一堆 pdf 和 zip 文件，并在需要的地方制作部分参考；但我真的很想直接链接到文本中的部分。

有谁知道我在哪里可以找到规范的 HTML 版本？我一直在寻找 MSDN、Mono 和 Google，但到目前为止都是空的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-09T21:46:47.270

*编辑：正如评论中所指出的，这实际上是一个较旧的草案，我不确定它是否“足够接近”供您使用，但我没有运气在 HTML 中找到当前版本。*

它不会是一个漂亮的链接，但这可能会完成这项工作（Google 的 HTML 版本的 DOC 文件）：

[http://74.125.95.132/search?q=cache:OkolnRjRgFIJ:download.microsoft.com/download/D/C/1/DC1B219F-3B11-4A05-9DA3-2D0F98B20917/Partition%2520I%2520Architecture.doc](http://74.125.95.132/search?q=cache:OkolnRjRgFIJ:download.microsoft.com/download/D/C/1/DC1B219F-3B11-4A05-9DA3-2D0F98B20917/Partition%2520I%2520Architecture.doc)

您可以通过查看源代码并`<a name="____">`在该部分查找锚点来链接到特定部分，它们似乎都有它，例如：

[http://74.125.95.132/search?q=cache:OkolnRjRgFIJ:download.microsoft.com/download/D/C/1/DC1B219F-3B11-4A05-9DA3-2D0F98B20917/Partition%2520I%2520Architecture.doc#_Toc100635553](http://74.125.95.132/search?q=cache:OkolnRjRgFIJ:download.microsoft.com/download/D/C/1/DC1B219F-3B11-4A05-9DA3-2D0F98B20917/Partition%2520I%2520Architecture.doc#_Toc100635553)

当然，如果您不想看到看起来如此凌乱的链接，您可以随时将此 HTML 文件保存到您自己控制的服务器上。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-16T17:46:35.897

[该文档](http://www.adobe.com/devnet/acrobat/pdfs/pdf_open_parameters.pdf)意味着您可以链接到 pdf 文件。我可以按页面（例如[http://www.ecma-international.org/publications/files/ECMA-ST/Ecma-335.pdf#page=53](http://www.ecma-international.org/publications/files/ECMA-ST/Ecma-335.pdf#page=53)）来完成，这可能足以满足您的需求。请注意，链接到的页面是文件中的数字顺序，而不是页面底部的“页码”。

使用命名目的地（参见底部链接的 pdf）会更好，但您需要一个程序来告诉您 ECMA pdf 中存在哪些命名目的地。Adobe Reader 似乎没有这样做，所以我无法检查特定部分抱歉（显然尝试使用部分名称失败）。另请注意，在 url 中，名称部分仅限于 32 个字符。

即使您仅限于页码，这也可能比链接到 Word 文档更令人愉快。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-09T22:19:10.420

更糟的是，你可以用[pdftohtml](http://sourceforge.net/projects/pdftohtml/)自己翻译（更多在[Google](http://www.google.com/search?q=pdf2html)上）

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-03-19T04:03:08.990

我所知道的最接近的是这个[MSIL 指令列表](http://ozarate.utj.edu.mx/material/archer/archer2html/32ch27a.htm)。

# java - 是否有关于如何在我的应用程序中使用 JEditTextArea 的教程？

> ID：661013
> 
> 赞同：2
> 
> 时间：2009-03-19T03:57:09.613
> 
> 标签：java, jedit

我正在尝试将 JEditTextArea 嵌入到我的应用程序中，可在此处获得：[http ://syntax.jedit.org/](http://syntax.jedit.org/)

我想知道是否有明确的指南来执行此操作？我在让包工作时遇到问题，我不确定我应该如何将它们导入到我的项目中。如果有人让这个工作，或者有更好的解决方案来在我的应用程序中突出显示语法，任何帮助都非常感谢。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-24T22:36:41.750

这个额外的包似乎自 2002 年以来就已经死了。我什至不知道它作为单独的项目存在。如果要嵌入 JEditTextArea，则应使用最新版本。为此，您必须获取源代码分发并调用“ant build-textArea”，它应该生成独立的 TextArea 以嵌入到其他项目中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T06:44:04.673

如果您使用的是 Swing，那么也许[StyledDocument](http://java.sun.com/j2se/1.4.2/docs/api/javax/swing/text/StyledDocument.html)适合您？我已经将它用于应用程序中的语法高亮显示，而且相对来说比较轻松。

# c# - 如何将 .NET 位图传递给本机 DLL？

> ID：661016
> 
> 赞同：1
> 
> 时间：2009-03-19T03:59:31.540
> 
> 标签：c#, .net, pinvoke

这是我所拥有的：

*   一个外部 DLL，我用 C 编写。这个 DLL 链接到 opencv。我不想直接从 C# 调用 OpenCV - 已经有大量 C 代码访问 OpenCV，它们将在 DLL 中使用。有一个导出函数：**passbitmap(void *mem, size_t s);**

*   我要从中调用 DLL 的 AC# 项目。

*   一个 System.Drawing.Bitmap 对象，我想通过它以某种方式将像素/位图数据传递给我的 DLL。

我猜它是某种 P/Invoke，但我从来没有做过，也不知道在这种情况下我该如何正确地做到这一点。我应该如何进行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-19T04:13:04.893

您需要调用 Bitmap.GetHbitmap() 来获取位图的本机句柄。

然后你基本上想做一些本机互操作并调用[GetDIBits()](http://msdn.microsoft.com/en-us/library/dd144879(VS.85).aspx)。让您的目标 dll 实际调用 GetDIBits() 并传递 win32 句柄可能会更好，而不是执行互操作。

您需要在从 GetDC(NULL) 获得的桌面 DC 上调用 CreateCompatibleDC()，然后在刚刚制作的 DC 上调用 CreateCompatibleBitmap()。然后调用 GetDIBits()。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T04:23:49.453

C 函数原型只需要一个指向缓冲区的指针和缓冲区的大小，它期望在缓冲区内看到的是 $64K 的问题。我的假设/疯狂猜测是它是 ByteArray 形式的位图位。所以...

我想这需要分解成几个步骤......

**[未经测试，但我认为总体思路是合理的]**

* 从您的位图中获取数据，可能是一个字节数组
* 分配一个非托管缓冲区来存储数据
* 将字节数组复制到缓冲区。
* 将缓冲区指针传递给 C dll
* 完成后释放缓冲区

您可以使用分配非托管缓冲区

```
IntPtr pnt = Marshal.AllocHGlobal(size); 
```

你可以使用复制你的字节数组

```
Marshal.Copy(theByteArray, 0, pnt, theByteArray.Length); 
```

请注意，因为它的非托管数据，您将负责在完成后释放它。

```
Marshal.FreeHGlobal(ptr) 
```

请注意，正如@jeffamaphone 所说，如果您可以访问 c 代码，最好简单地传递位图句柄。

# python - 从 Python 访问 errno？

> ID：661017
> 
> 赞同：25
> 
> 时间：2009-03-19T04:00:33.690
> 
> 标签：python, linux, python-2.5, errno

我被一个相当复杂的 Python 模块困住了，它不返回有用的错误代码（它实际上默默地失败了）。但是，它调用的底层 C 库设置了 errno。

通常 errno 来自 OSError 属性，但由于我没有异常，我无法理解它。

使用 ctypes，libc.errno 不起作用，因为 errno 是 GNU libc 中的宏。Python 2.6 有一些功能，但 Debian 仍然使用 Python 2.5。将 C 模块插入到我的纯 Python 程序中只是为了读取 errno 让我感到厌恶。

有没有办法访问errno？仅限 Linux 的解决方案很好，因为被包装的库是仅限 Linux 的。我也不必担心线程，因为在这可能失败的时间内我只运行一个线程。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-19T07:20:16.067

这是允许访问的代码片段`errno`：

```
from ctypes import *

libc = CDLL("libc.so.6")

get_errno_loc = libc.__errno_location
get_errno_loc.restype = POINTER(c_int)

def errcheck(ret, func, args):
    if ret == -1:
        e = get_errno_loc()[0]
        raise OSError(e)
    return ret

copen = libc.open
copen.errcheck = errcheck

print copen("nosuchfile", 0) 
```

重要的是您`errno`在函数调用后尽快检查，否则它可能已经被覆盖。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-19T07:19:50.483

更新：在**Python 2.6+ 上**，使用[`ctypes.get_errno()`](https://docs.python.org/3/library/ctypes.html#ctypes.get_errno).

## 蟒蛇2.5

下面的代码不可靠（或全面，`errno`可以定义多种方法）但它应该让你开始（或重新考虑你在一个微小的扩展模块上的位置（毕竟在 Debian 上`python setup.py install`或者`easy_install`构建它应该没有问题）） . 来自 [http://codespeak.net/pypy/dist/pypy/rpython/lltypesystem/ll2ctypes.py](http://codespeak.net/pypy/dist/pypy/rpython/lltypesystem/ll2ctypes.py)

```
if not hasattr(ctypes, 'get_errno'):
    # Python 2.5 or older
    if sys.platform == 'win32':
        standard_c_lib._errno.restype = ctypes.POINTER(ctypes.c_int)
        def _where_is_errno():
            return standard_c_lib._errno()

    elif sys.platform in ('linux2', 'freebsd6'):
        standard_c_lib.__errno_location.restype = ctypes.POINTER(ctypes.c_int)
        def _where_is_errno():
            return standard_c_lib.__errno_location()

    elif sys.platform in ('darwin', 'freebsd7'):
        standard_c_lib.__error.restype = ctypes.POINTER(ctypes.c_int)
        def _where_is_errno():
            return standard_c_lib.__error()
    ctypes.get_errno = lambda: _where_is_errno().contents.value 
```

哪里`standard_c_lib`：

```
def get_libc_name():
    if sys.platform == 'win32':
        # Parses sys.version and deduces the version of the compiler
        import distutils.msvccompiler
        version = distutils.msvccompiler.get_build_version()
        if version is None:
            # This logic works with official builds of Python.
            if sys.version_info < (2, 4):
                clibname = 'msvcrt'
            else:
                clibname = 'msvcr71'
        else:
            if version <= 6:
                clibname = 'msvcrt'
            else:
                clibname = 'msvcr%d' % (version * 10)

        # If python was built with in debug mode
        import imp
        if imp.get_suffixes()[0][0] == '_d.pyd':
            clibname += 'd'

        return clibname+'.dll'
    else:
        return ctypes.util.find_library('c')

# Make sure the name is determined during import, not at runtime
libc_name = get_libc_name() 
standard_c_lib = ctypes.cdll.LoadLibrary(get_libc_name()) 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-19T04:10:16.990

看起来你可以使用这个补丁，它将为你提供`ctypes.get_errno/set_errno`

[http://bugs.python.org/issue1798](http://bugs.python.org/issue1798)

这是实际应用于存储库的补丁：

[http://svn.python.org/view?view=rev&revision=63977](http://svn.python.org/view?view=rev&revision=63977)

否则，添加一个新的 C 模块，它只会返回 errno /is/ disgusting，但您正在使用的库也是如此。我会这样做，而不是自己修补 python。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-03-19T07:18:23.450

放弃并通过 C 标头进行跟踪。

```
import ctypes
c = ctypes.CDLL("libc.so.6")
c.__errno_location.restype = ctypes.POINTER(ctypes.c_int)
c.write(5000, "foo", 4)
print c.__errno_location().contents # -> c_long(9) 
```

它在 python 命令提示符下不起作用，因为它将 errno 重置为从标准输入读取。

一旦你知道了[__errno_location 的魔力，](http://www.google.com/search?q=__errno_location+ctypes)这看起来就像一个常见的模式。但是只有[errno](http://www.google.com/search?q=errno+ctypes)我很迷茫。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-19T05:30:18.640

我不确定这是否是您和 Jerub 所指的，但是您可以编写一个非常短的 C 扩展，它只导出 errno，即使用[python 语言接口](http://www.python.org/doc/2.5.1/ext/simpleExample.html)。

否则，我同意你的观点，必须添加这一小段编译代码是一件很痛苦的事情。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-05-29T21:47:21.410

ctypes 实际上提供了一种访问 python 的 c 实现的标准方法，它使用 errno。除了我的（linux）系统之外，我还没有在其他任何东西上测试过这个，但这应该是非常便携的：

ctypes.c_int.in_dll(ctypes.pythonapi,"errno")

它返回一个包含当前值的 c_int。

# svn - 将现有 Git 存储库推送到 SVN

> ID：661018
> 
> 赞同：393
> 
> 时间：2009-03-19T04:01:39.697
> 
> 标签：svn, git, git-svn

我一直在 Git 中完成所有工作并推送到 GitHub。我对软件和网站都非常满意，目前我不想改变我的工作习惯。

我的博士导师要求所有学生将他们的工作保存在大学托管的 SVN 存储库中。我发现了大量关于将现有 SVN 存储库拉入 Git 的文档和教程，但没有将 Git 存储库推送到新的 SVN 存储库。我希望一定有某种方法可以结合 git-svn 和一个新的分支和 rebase 以及所有这些美妙的术语来做到这一点，但我是一个 Git 新手，对它们中的任何一个都没有信心。

然后，当我选择时，我只想运行几个命令将提交推送到该 SVN 存储库。我希望继续使用 Git，并让 SVN 存储库镜像 Git 中的内容。

如果这有什么不同的话，我将是唯一一个致力于 SVN 的人。

* * *

## 回答 #1

> 赞同：407
> 
> 时间：2009-04-21T14:36:06.000

I needed this as well, and with the help of Bombe's answer + some fiddling around, I got it working. Here's the recipe:

## Import Git -> Subversion

```
1\. cd /path/to/git/localrepo
2\. svn mkdir --parents protocol:///path/to/repo/PROJECT/trunk -m "Importing git repo"
3\. git svn init protocol:///path/to/repo/PROJECT -s
4\. git svn fetch
5\. git rebase origin/trunk
5.1\.  git status
5.2\.  git add (conflicted-files)
5.3\.  git rebase --continue
5.4\.  (repeat 5.1.)
6\. git svn dcommit 
```

After #3 you'll get a cryptic message like this:

> Using higher level of URL: `protocol:///path/to/repo/PROJECT => protocol:///path/to/repo`

Just ignore that.

When you run #5, you *might* get conflicts. Resolve these by adding files with state "unmerged" and resuming rebase. Eventually, you'll be done; then sync back to the SVN repository, using `dcommit`. That's all.

## Keeping repositories in sync

You can now synchronise from SVN to Git, using the following commands:

```
git svn fetch
git rebase trunk 
```

And to synchronise from Git to SVN, use:

```
git svn dcommit 
```

## Final note

You might want to try this out on a local copy, before applying to a live repository. You can make a copy of your Git repository to a temporary place; simply use `cp -r`, as all data is in the repository itself. You can then set up a file-based testing repository, using:

```
svnadmin create /home/name/tmp/test-repo 
```

And check a working copy out, using:

```
svn co file:///home/name/tmp/test-repo svn-working-copy 
```

That'll allow you to play around with things before making any lasting changes.

## Addendum: If you mess up `git svn init`

If you accidentally run `git svn init` with the wrong URL, and you weren't smart enough to take a backup of your work (don't ask ...), you can't just run the same command again. You can however undo the changes by issuing:

```
rm -rf .git/svn
edit .git/config 
```

And remove the section `[svn-remote "svn"]` section.

You can then run `git svn init` anew.

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2012-01-19T19:56:40.407

Here's how we made it work:

Clone your Git repository somewhere on your machine.

Open `.git/config` and add the following (from *[Maintaining a read-only SVN mirror of a Git repository](http://www.kerrybuckley.org/2009/10/06/maintaining-a-read-only-svn-mirror-of-a-git-repository/)*):

```
[svn-remote "svn"]
    url = https://your.svn.repo
    fetch = :refs/remotes/git-svn 
```

Now, from a console window, type these:

```
git svn fetch svn
git checkout -b svn git-svn
git merge master 
```

Now, if it breaks here for whatever reason, type these three lines:

```
git checkout --theirs .
git add .
git commit -m "some message" 
```

And finally, you can commit to SVN:

```
git svn dcommit 
```

Note: I always scrap that folder afterwards.

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2009-05-05T13:55:01.710

Using `git rebase` directly will lose the first commit. Git treats it different and can't rebase it.

There is a procedure that will preserve full history: [http://kerneltrap.org/mailarchive/git/2008/10/26/3815034](http://kerneltrap.org/mailarchive/git/2008/10/26/3815034)

I will transcribe the solution here, but credits are for Björn.

Initialize git-svn:

```
git svn init -s --prefix=svn/ https://svn/svn/SANDBOX/warren/test2 
```

The --prefix gives you remote tracking branches like "svn/trunk" which is nice because you don't get ambiguous names if you call your local branch just "trunk" then. And `-s` is a shortcut for the standard trunk/tags/branches layout.

Fetch the initial stuff from SVN:

```
git svn fetch 
```

Now look up the hash of your root commit (should show a single commit):

```
git rev-list --parents master | grep '^.\{40\}$' 
```

Then get the hash of the empty trunk commit:

```
git rev-parse svn/trunk 
```

Create the graft:

```
git replace --graft <root-commit-hash> <svn-trunk-commit-hash> 
```

Now, "gitk" should show `svn/trunk` as the first commit on which your master branch is based.

Make the graft permanent:

```
git filter-branch -- ^svn/trunk --all 
```

Drop the graft:

```
git replace -d <root-commit-hash> 
```

gitk should still show `svn/trunk` in the ancestry of master.

Linearize your history on top of trunk:

```
git svn rebase 
```

And now "git svn dcommit -n" should tell you that it is going to commit to trunk.

```
git svn dcommit 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-03-19T10:14:19.253

在 Subversion 存储库中为您的项目创建一个新目录。

```
# svn mkdir --parents svn://ip/path/project/trunk 
```

切换到你的 Git 管理的项目并初始化 git-svn。

```
# git svn init svn://ip/path/project -s
# git svn fetch 
```

这将创建一个提交，因为您的 SVN 项目目录仍然是空的。现在在该提交上重新设置所有内容，`git svn dcommit`您应该完成。但是，它会严重扰乱您的提交日期。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2016-03-03T12:34:38.593

**Git -> SVN with complete commit history**

I had a Git project and had to move it to SVN. This is how I made it, keeping the whole commit history. The only thing that gets lost is the original commit time since libSVN will set the local time when we do `git svn dcommit`.

**Howto:**

1.  Have a SVN repository where we want to import our stuff to and clone it with git-svn:

    ```
    git svn clone https://path.to/svn/repository repo.git-svn` 
    ```

2.  Go there:

    ```
    cd repo.git-svn 
    ```

3.  Add the remote of the Git repository (in this example I'm using *C:/Projects/repo.git*). You want to push to SVN and give it the name old-git:

    ```
    git remote add old-git file:///C/Projects/repo.git/ 
    ```

4.  Fetch the information from the master branch from the old-git repository to the current repository:

    ```
    git fetch old-git master 
    ```

5.  Checkout the master branch of the old-git remote into a new branch called old in the current repository:

    ```
    git checkout -b old old-git/master` 
    ```

6.  Rebase to put the HEAD on top of old-git/master. This will maintain all your commits. What this does basically is to take all of your work done in Git and put it on top of the work you are accessing from SVN.

    ```
    git rebase master 
    ```

7.  Now go back to your master branch:

    ```
    git checkout master 
    ```

    And you can see that you have a clean commit history. This is what you want to push to SVN.

8.  Push your work to SVN:

    ```
    git svn dcommit 
    ```

That's all. It is very clean, no hacking, and everything works perfectly out of the box. Enjoy.

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-05-13T00:45:40.067

I would propose a very short instruction in 4 commands using [SubGit](http://subgit.com). See this [post](https://stackoverflow.com/questions/10014054/git-2-svn-migration/10564836#10564836) for details.

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-05-09T09:36:01.283

I needed to commit my existing Git repository to an empty SVN repository.

This is how I managed to do this:

```
$ git checkout master
$ git branch svn
$ git svn init -s --prefix=svn/ --username <user> https://path.to.repo.com/svn/project/
$ git checkout svn
$ git svn fetch
$ git reset --hard remotes/svn/trunk
$ git merge master
$ git svn dcommit 
```

It worked without problems. I hope this helps someone.

Since I had to authorize myself with a different username to the SVN repository (my `origin` uses private/public key authentication), I had to use the `--username` property.

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-19T04:32:02.837

如果您想继续使用 Git 作为您的主存储库，并且只需要不时将修订“导出”到 SVN，您可以使用[Tailor](https://github.com/lelit/tailor)来保持 SVN 存储库同步。它可以在不同的源代码控制系统之间复制修订，并使用您在 Git 中所做的更改来更新 SVN。

我还没有尝试过 Git 到 SVN 的转换，但对于 SVN -> SVN 示例，请参阅[此答案](https://stackoverflow.com/questions/479361/can-i-move-an-existing-subversion-repository-into-a-new-parent-repository-and-re/479379#479379)。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2018-06-25T14:32:25.347

Yet another sequence that worked (with some comments on each step):

1.  Install `git-svn` and `subversion` toolkits:

    ```
    sudo apt-get install git-svn subversion 
    ```

2.  Switch inside the `PROJECT_FOLDER`

    ```
    cd PROJECT_FOLDER 
    ```

3.  Create the project path on the Subversion server (unfortunately the current `git-svn` plugin has a defect in comparison with TortoiseSVN). It is unable to store source code directly into the `PROJECT_FOLDER`. Instead, by default, it will upload all the code into `PROJECT_FOLDER/trunk`.

    svn mkdir --parents protocol:///path/to/repo/PROJECT_FOLDER/trunk -m "creating git repo placeholder"

This is the place where `trunk` at the end of the path is **mandatory**

4.  Initialize the `git-svn` plugin context inside the `.git` folder

    ```
    git svn init -s protocol:///path/to/repo/PROJECT_FOLDER 
    ```

    This is the place where `trunk` at the end of the path is **unnecessary**

5.  Fetch an empty `Subversion` repository information

    ```
    git svn fetch 
    ```

    This step is helping to synchronize the Subversion server with the `git-svn` plugin. This is the moment when `git-svn` plugin establishes `remotes/origin` path and associates it with the `trunk` subfolder on the server side.

6.  Rebase old Git commits happened before the `git-svn` plugin became involved in the process (this step is **optional**)

    ```
    git rebase origin/trunk 
    ```

7.  Add new/modified files to commit (this step is regular for Git activities and is **optional**)

    ```
    git add . 
    ```

8.  Commit freshly added files into the local Git repository (this step is **optional** and is only applicable if step 7 has been used):

    ```
    git commit -m "Importing Git repository" 
    ```

9.  Pushing all the project changes history into the Subversion server:

    ```
    git svn dcommit 
    ```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-19T04:12:13.727

您可以创建一个新的 SVN 存储库。导出您的 Git 项目（充实 .git 文件）。将它添加到 SVN 存储库（使用您目前在 Git 中的内容初始化存储库）。然后使用说明在新的 Git 项目中导入 SVN 存储库。

但这会丢失您之前的 Git 历史记录。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-02-19T20:46:01.910

If you don't have to use any specific SVN and you are using GitHub you can use their SVN connector.

More information is here: *[Collaborating on GitHub with Subversion](https://github.com/blog/1178-collaborating-on-github-with-subversion)*

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2017-05-07T17:38:45.183

I recently had to migrate several Git repositories to SVN, and after trying all solutions I could find, what finally worked for me was [Mercurial](https://www.mercurial-scm.org) (yes, using a *third* VCS). Using [this guide](http://davidvg.com/2011/12/07/converting-a-git-repo-to-svn), I came up with the following process (on Linux, but the basic idea should work on Windows as well).

1.  The necessary packages:

    ```
    $ sudo apt-get install git subversion mercurial python-subversion 
    ```

2.  Mercurial needs to be configured by adding the following to `~/.hgrc`:

    ```
    [extensions]
    hgext.convert= 
    ```

3.  Create some temporary working directories (I had several repositories to migrate so I created directories for the SVN and Git versions, to keep them separate):

    ```
    $ mkdir svn
    $ mkdir git 
    ```

4.  Make an empty local SVN repository:

    ```
    $ svnadmin create svn/project 
    ```

5.  Clone the existing Git repository:

    ```
    $ git clone server/path/project.git git/project 
    ```

6.  Let Mercurial do its thing:

    ```
    $ hg convert --dest-type svn git/project svn/project 
    ```

7.  Now the SVN repository should contain the full commit history, but not with original timestamps. If this is not an issue, skip over the next part to step 11.

8.  With a little work, [the date and time of each commit can be changed](https://stackoverflow.com/a/2105954/434012). Since my repositories are fairly small, it was feasible for me to do it manually. First, create a `pre-revprop-change` hook in the SVN repository with the following contents, to allow the necessary property to be modified:

    ```
    #!/bin/bash
    exit 0; 
    ```

    This script has to be made executable:

    ```
    $ chmod +x svn/project/hooks/pre-revprop-change 
    ```

9.  Mercurial created a working copy of the SVN repository, named *project*-wc, so switch to it and edit the commit times:

    ```
    $ cd project-wc
    $ svn propedit svn:date --revprop -r 1 
    ```

    Enter the correct date and time (pay attention to timezones!) and save. You should get a message saying "Set new value for property svn:date on revision 1".
    Now rinse and repeat for every other revision.

10.  Optionally check the commit history to make sure everything looks OK:

    ```
    $ svn log -r 1:HEAD 
    ```

    Then go back up one level:

    ```
    $ cd .. 
    ```

11.  Dump the repository:

    ```
    $ svnadmin dump svn/project > project.dump 
    ```

12.  And load the dump on your Subversion server. Done!

This process would probably also work directly between remote repositories, but I found it easier to work with local ones. Fixing the commit times was a lot of work, but overall the process was much more straightforward than any other method I found.

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2019-03-06T01:18:39.347

there are three methods：</p>

1.  rebase： as the other answers

2.  commit id: find svn first commit id and git first commit id , echo their into .git/info/grafts:`echo "git_id svn_id}" > .git/info/grafts` then `git svn dcommit`

3.  checkout every git commit,copy files into svn_repo, svn commit

bash demo： [github demo](https://github.com/zyw19871007/git2svn)

v1.x： use rebase and commit id

v2.x: use copy files,then svn commit

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-03-27T21:59:54.510

I would like to share a great tool being used in the WordPress community called Scatter

*[Git WordPress plugins and a bit of sanity scatter](http://evansolomon.me/notes/git-wordpress-plugins-and-a-bit-of-sanity-scatter/)*

This enables users to be able to send their Git repository to wordpress.org SVN automatically. In theory, this code can be applied to any SVN repository.

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2015-12-01T08:36:10.400

I just want to share some of my experience with the accepted answer. I did all steps and all was fine before I ran the last step:

```
git svn dcommit 
```

> $ git svn dcommit
> 
> Use of uninitialized value $u in substitution (s///) at /usr/lib/perl5/vendor_perl/5.22/Git/SVN.pm line 101.
> 
> Use of uninitialized value $u in concatenation (.) or string at /usr/lib/perl5/vendor_perl/5.22/Git/SVN.pm line 101. refs/remotes/origin/HEAD: '[https://192.168.2.101/svn/PROJECT_NAME](https://192.168.2.101/svn/PROJECT_NAME)' not found in ''

I found the thread [https://github.com/nirvdrum/svn2git/issues/50](https://github.com/nirvdrum/svn2git/issues/50) and finally the solution which I applied in the following file in line 101 **/usr/lib/perl5/vendor_perl/5.22/Git/SVN.pm**

I replaced

```
$u =~ s!^\Q$url\E(/|$)!! or die 
```

with

```
if (!$u) {
    $u = $pathname;
} 
else {
       $u =~ s!^\Q$url\E(/|$)!! or die
      "$refname: '$url' not found in '$u'\n";
} 
```

This fixed my issue.

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2015-12-02T20:25:31.553

In my case, I had to initiate a clean project from SVN

```
$ Project> git svn init protocol://path/to/repo -s
$ Project> git svn fetch 
```

add all your project sources...

```
$ Project> git add .
$ Project> git commit -m "Importing project sources"
$ Project> git svn dcommit 
```

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2014-06-09T05:51:23.713

What if you don't want to commit *every* commit that you make in Git, to the SVN repository? What if you just want to selectively send commits up the pipe? Well, I have a better solution.

I keep one local Git repository where all I ever do is fetch and merge from SVN. That way I can make sure I'm including all the same changes as SVN, but I keep my commit history separate from the SVN entirely.

Then I keep a separate SVN local working copy that is in a separate folder. That's the one I make commits back to SVN from, and I simply use the SVN command line utility for that.

When I'm ready to commit my local Git repository's state to SVN, I simply copy the whole mess of files over into the local SVN working copy and commit it from there using SVN rather than Git.

This way I never have to do any rebasing, because rebasing is like freebasing.

# grails - Grails Eclipse 插件

> ID：661020
> 
> 赞同：10
> 
> 时间：2009-03-19T04:01:57.447
> 
> 标签：grails, groovy, eclipse-plugin

我已经看到关于 SO 批评 Eclipse Grails 插件的各种帖子，我想知道是否有人找到了一种在 Eclipse 中有效地使用 Grails 的方法？

我查看了[Grails 插件页面](http://www.grails.org/Eclipse+IDE+Integration)，那里的信息看起来不太乐观，特别是关于“禁用 Groovy 编译器生成类文件”设置的相互矛盾的建议。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2010-01-07T17:00:08.160

STS 中可用的 Grails Eclipse 工具现在变得成熟。如果您仍在寻找在 Eclipse 中开发 Grails 应用程序的好方法，我建议您尝试一下。

[http://www.grails.org/STS+Integration](http://www.grails.org/STS+Integration)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-03-19T20:17:18.390

原始答案（左，所以人们的选票没有被歪曲）：

Grails 开发人员的当前 IDE 状态（截至 09 年 3 月）：

1.  IntelliJ Idea 仍然是最好的，但成本很高
2.  NetBeans 6.5 比 6.1 好得多，但在 v1.1 之前发布，不确定 1.1 的更改可能对此做了什么。
3.  Eclipse 仍然远远落后。然而，SpringSource 是 Eclipse 的主要参与者，他们现在拥有 Groovy/Grails 的主要开发者 GOne。这应该有加速Eclipse插件开发的效果，但目前还没有结果。

现在是 10 年 12 月，情况发生了变化（但变化不大）：

1.  IntelliJ Idea 仍然是最好的，但只是稍微好一点，而且价格昂贵。
2.  Eclipse 现在有了 STS（因为 Spring 是主要的开发者），与以前相比，Grails 集成要好得多，尤其是对于新项目。如果您使用的是 Mavenized Grails……您可能仍想坚持使用 IntelliJ。
3.  NetBeans 6.9.1 已经发布，但其对 Grails 的支持自 6.5 起就停滞不前。它现在是包的底部。

现在是 15 年 2 月，距离最初的问题将近 6 年。很多东西都变了，但很多东西还是一样的：

1.  IntelliJ 仍然是最好的，而且还在不断增长。Grails 3（下个月到期）实际上将允许使用 IntelliJ 的社区（免费）版进行开发
2.  GGTS（由 VMWare 创建的 Eclipse 包）从未真正赶上，而且现在只会更落后，因为 Pivotal 已经停止赞助 Groovy/Grails 团队，并且可能也不再推动 GGTS 的开发。
3.  说真的，还有人使用 NetBeans 吗？好的，我看到他们仍然支持 Grails，但我真的不知道这种支持有多好。我认识的每个人......每个人......都使用 IntelliJ。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-19T05:17:40.760

我曾经是 Eclipse 的铁杆粉丝（甚至无法想象我会在 Eclipse 以外的任何 IDE 上工作）。但是，在沮丧了几个月之后，我最终不得不退出 Eclipse，转而使用 vi 或 IntelliJ IDEA。

但那是将近一年前的事了。没有再尝试过。我对 SpringSource 对改进 Eclipse 工具寄予厚望。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-07-18T02:15:02.780

不喜欢使用 STS - 用于 Grails 的自定义 Eclipse IDE。看看是否还有适用于 Eclipse 的 Grails 插件。使用在 STS 中不加载的多个项目

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-28T04:14:58.400

在阅读了 Eclipse 文档后，我一直在尝试使用 NetBeans 6.7 候选版本。到目前为止，这是使用 Grails 的一种非常好的方式。您必须配置自己的热键等，以便可以在 2 次击键中完成运行测试。

我在使用一些声称的增强功能时遇到了麻烦。我的代码完成不适用于我自己的方法，这是迄今为止最烦人的事情（至少，这不仅仅是我习惯于静态类型 Java 的结果）。我需要弄清楚如何只执行一个测试等。

作为 7 年和 8 年前使用 NetBeans 的人，我更喜欢我现在看到的东西。早在 03 年，我就对 Eclipse 大喊大叫，但 Netbeans 似乎已经成熟了很多。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-09-29T21:37:53.540

我将 STS 作为插件安装到我的 Helios Java EE 安装中。在我学习 Grails 时，大部分时间都将它用于示例 Grails 项目，但似乎工作得相当好。毫无疑问，Eclipse 对 Groovy 的支持在去年有了显着改善。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-15T21:51:49.107

我建议使用 NetBeans 6.7 进行 Groovy/Grails 开发或 TextMate（仅限 Mac）。NetBeans 6.7 运行良好，应该能够让您渡过难关，直到 Eclipse 插件出现。谁知道呢，您甚至可能更喜欢 NetBeans。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-11-12T18:07:23.483

我目前使用的是 3.6.4 版 STS。它工作得很好。STS 3.7.1 版本已经发布，但我还没有尝试过。3.6.4 与 Grails 2.4.4 配合得很好。我已经下载并安装了 Grails 3.0.9，就我的目的而言，它运行良好。Eclipse 的长期粉丝，我将它用于 UML、PHP、c++ 和 Java。

# linux - 如何在 Linux 中使用 BCP 命令？

> ID：661027
> 
> 赞同：0
> 
> 时间：2009-03-19T04:07:24.393
> 
> 标签：linux, bcp

我想`bcp`在 Linux 中使用如下命令：

```
bcp "EasyCash.dbo.user" out "[EasyCash].[dbo].[user].dat" -q -c -t "<EOFD>"
         -r "<EORD>" -Usa -P123456 -S192.168.1.5 
```

Linux 中的消息显示如下：

```
-base bcp: command not found 
```

谁能解决我的问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-01-24T14:04:58.943

您可以使用 FreeTDS 及其 FreeBCP 实用程序。它与 MSSQL Server 的 bcp.exe [http://www.freetds.org/相当](http://www.freetds.org/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T04:29:42.483

假设您的计算机上有包含`bcp`可执行文件的任何包，请尝试键入

```
locate bcp | grep bin 
```

并查看输出以查看此可执行文件是否存在于您的计算机上但不在您的路径中。如果这没有返回任何内容，那么您缺少可执行文件。如果这出现了一些问题，那么您可以尝试使用整个路径运行它。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-19T04:35:43.060

该示例确实看起来像 MSSQL 的 BCP 命令）（-Usa ... 'sa' 用户）。MSSQL 是一个仅限 Windows 的产品。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-19T11:06:45.493

有关如何安装、部署和使用 bcp 命令的完整详细信息，请参见 Sybase ASE 文档。或询问您的 DBA。

# c# - 如何将两个整数相除以获得双精度？

> ID：661028
> 
> 赞同：332
> 
> 时间：2009-03-19T04:09:22.890
> 
> 标签：c#, math, int, double

如何将两个整数相除以获得双精度数？

* * *

## 回答 #1

> 赞同：523
> 
> 时间：2009-03-19T04:14:16.297

您要转换数字：

```
double num3 = (double)num1/(double)num2; 
```

注意：如果 C# 中的任何参数是 a `double`，`double`则使用一个除法，结果是 a `double`。因此，以下内容也可以使用：

```
double num3 = (double)num1/num2; 
```

有关更多信息，请参阅：

[点网 Perls](http://www.dotnetperls.com/numeric-casts)

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2014-12-12T18:24:12.200

补充@NoahD 的答案

要获得更高的精度，您可以转换为十进制：

```
(decimal)100/863
//0.1158748551564310544611819235 
```

或者：

```
Decimal.Divide(100, 863)
//0.1158748551564310544611819235 
```

双精度表示分配 64 位，而十进制使用 128

```
(double)100/863
//0.11587485515643106 
```

### 深入解读“精准”

有关二进制浮点表示及其精度的更多详细信息，请查看 Jon Skeet 的[这篇文章](http://csharpindepth.com/Articles/General/FloatingPoint.aspx)，他谈到了[这篇](http://csharpindepth.com/Articles/General/Decimal.aspx)`floats`文章，以及他谈到`doubles`的这篇文章。`decimals`

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-03-19T04:12:47.080

将整数转换为双精度数。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-19T04:12:02.620

首先将其中一个转换为双精度。此表格适用于多种语言：

```
 real_result = (int_numerator + 0.0) / int_denominator 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-05-10T10:01:33.533

```
var firstNumber=5000,
secondeNumber=37;

var decimalResult = decimal.Divide(firstNumber,secondeNumber);

Console.WriteLine(decimalResult ); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-12-17T13:49:25.413

```
var result = decimal.ToDouble(decimal.Divide(5, 2)); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-12-25T01:18:59.827

我已经完成了大多数答案，并且我很确定这是无法实现的。无论您尝试将两个 int 划分为 double 还是 float 都不会发生。但是您有很多方法可以进行计算，只需将它们转换为 float 或 double ，然后计算就可以了。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-12-29T21:49:33.807

最简单的方法是在整数中添加小数位。

前任。：

```
var v1 = 1 / 30 //the result is 0
var v2 = 1.00 / 30.00 //the result is 0.033333333333333333 
```

# iphone - 如何在我查看 UITableView 时重新加载它

> ID：661031
> 
> 赞同：30
> 
> 时间：2009-03-19T04:10:30.390
> 
> 标签：iphone, uitableview, reload

当我有一个 UITableView 作为可见视图控制器的一部分时，我如何重新加载它，以便我正在查看的数据更改为新数据。只是调用 reload 似乎不会刷新数据，直到我滚动它。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-03-19T04:17:44.820

[`reloadData`](https://developer.apple.com/library/ios/documentation/UIKit/Reference/UITableView_Class/index.html#//apple_ref/occ/instm/UITableView/reloadData)只要调用该方法，调用该方法就会刷新数据。它不会等待表格滚动。在调用`reloadData`.

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2010-08-06T08:30:14.263

您是否正在刷新主线程中的数据？如果是这样，您需要使用以下方法调用 reloadData 方法：

`- (void)performSelectorOnMainThread:(SEL)aSelector withObject:(id)arg waitUntilDone:(BOOL)wait`

所以对于 tableView 它将是：

`[tableView performSelectorOnMainThread:@selector(reloadData) withObject:nil waitUntilDone:NO];`

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2013-05-20T20:49:02.017

只是2013的更新，应该也可以重新加载数据，只要你用

```
dispatch_async(dispatch_get_main_queue(), ^{
    [self.tableView reloadData];
}); 
```

**GCD真棒！**

* * *

## 回答 #4

> 赞同：-5
> 
> 时间：2014-03-19T05:25:51.957

以下代码可帮助您在查看时重新加载表：

```
[self.tableView reloadData]; 
```

# python - 我可以让 pdb 立即开始调试吗？

> ID：661034
> 
> 赞同：5
> 
> 时间：2009-03-19T04:12:05.257
> 
> 标签：python, debugging, pdb

我想调试一个python项目

问题是，我不知道在哪里设置断点，

我想做的是能够调用一个方法

```
SomeClass( some_ctor_arguments ).some_method()` 
```

并立即触发调试器

我怎么做？

我试过`pdb.run( string_command )`了，但它似乎不能正常工作

```
>>> import pdb
>>> import <some-package>
>>> pdb.run( .... )
> <string>(1)<module>()
(Pdb) s
NameError: "name '<some-package>' is not defined" 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-19T04:15:06.217

找到了 ..

```
pdb.runcall( object.method ) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-19T07:27:40.917

```
pdb.set_trace() 
```

此时将启动调试器。

将它放在要调试的方法的开头。

# javascript - jQuery 是否有任何功能可以将客户端滚动到视口底部？

> ID：661041
> 
> 赞同：17
> 
> 时间：2009-03-19T04:13:55.920
> 
> 标签：javascript, jquery, viewport

我想用 jQuery 动画滚动到视口的底部。是否有可用的插件不是矫枉过正（即没有为这个小任务设置巨大的功能）；

是否有可用的插件或使用 jQuery 本地执行此操作的方法？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-03-19T06:54:21.480

jQuery 使这样的事情变得如此微不足道，以至于您不需要插件。例子：

```
var x = 250; //insert your own formula to calculate where you want to scroll to in px
var t = 500; //arbitrary time in ms
$("html,body").animate({ scrollTop: x }, t); 
```

而不是`html,body`你可以放置任何滚动的元素，比如 div。`t`是以毫秒为单位的动画将运行的时间，并且`x`是以 px 为单位滚动到的位置。请注意，这也适用于 scrollLeft，但不适用于 scrollRight 或 scrollBottom（不是 jQuery 的限制，而是 JavaScript）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-12T06:27:11.043

您始终可以执行以下操作将元素滚动到底部

```
$("body").attr({ scrollTop: $("body").attr("scrollHeight") }); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-19T04:16:42.450

检查[jQuery.ScrollTo](http://plugins.jquery.com/project/ScrollTo)插件，您可以使用选择器、DOM 元素等滚动到确定的位置（固定或绝对）...

看看[演示](http://demos.flesler.com/jquery/scrollTo/)...

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-10-15T15:47:00.057

为了详细说明 Darko Z 和 CMS 的答案，以下是我用来动画滚动到特定元素的内容：

```
var target = $('#elem');
$('html,body').animate({scrollTop: target.offset().top}, 500); 
```

# java - 如何将 java 类的目录添加到项目中？

> ID：661050
> 
> 赞同：0
> 
> 时间：2009-03-19T04:17:45.803
> 
> 标签：java, import, jedit

我有一个我正在处理的 Java 项目，并希望包含一个充满类的目录。这些是“JEdit 语法”类，包含在两个包中：

```
org.syntax.jedit
org.syntax.jedit.tokenmarker 
```

但是，无论我在哪里看到它都告诉我“导入整个 jar 文件”。我的问题是没有jar文件，只是一个带有子目录的目录，都充满了*.java文件，每个文件都包含一个类。

在 Netbeans 6.5 中，我通过“Jar/Folder”添加了一个库，它们都出现在我创建的新库中，但是当我导入上面列出的两个包时，我收到“org.syntax.jedit 不存在”的错误（找不到标志）”。

谁能告诉我我做错了什么？

万分感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-19T04:31:33.150

听起来您已经尝试将这两个包分别添加到您的类路径中 - 并且在错误的级别。如果你指向一个文件夹，你必须指向包层次结构的“根”文件夹——即在这种情况下是“org”的父文件夹然后从那里它会向下看包/文件夹层次结构 org /syntax/jedit 来找到你的类。

因此，如果您的文件位于目录“c:\mylib\src\main\java\org\syntax\jedit”中，那么您需要将编译器文件夹指向“c:\mylib\src\main\java”。然后应该找到所有类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T04:42:17.990

我同意 evnafets，您可能添加了 org 目录，但您应该添加了包含它们的目录。如果有 ant 文件 (build.xml)，您也可以轻松地从这些目录中构建一个 jar。

# visual-studio - Visual Studio 2005 项目中的可部署内容...如何？

> ID：661057
> 
> 赞同：3
> 
> 时间：2009-03-19T04:20:09.510
> 
> 标签：visual-studio, build-process

我有一个带有单个 C++ 项目的 vanilla Visual Studio 2005 解决方案，其中包含一些我想在构建过程中包含的非代码文件。

例如，我在相对于我的项目目录的路径中有一个“内容”设置为“真”的 .xml 文件。据我了解，这应该被复制到与项目相同的相对路径中的输出目录中。

[替代文字 http://img27.imageshack.us/img27/9876/deployablecontent.gif](http://img27.imageshack.us/img27/9876/deployablecontent.gif)

然而，没有任何东西被复制。是什么赋予了？

目录结构是这样的：

```
./           <- This is the project directory.
./content    <- This is where my "deployable" content is.
./include
./src
./build      <- This is the temp directory used when compiling.
./dist       <- This is the output directory. 
```

执行调试构建后，我希望我的输出是这样的：

```
./
./content
./include
./src
./build
./dist
./dist/debug             <- Compiled code is now here.
./dist/debug/content     <- My "deployable" files should be here. 
```

事实上，将“内容”设置为“真”（如提供的屏幕截图中所示）似乎没有做任何事情。我只是误解了这是如何工作的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-20T08:22:41.143

我通常使用 Post-Build 事件将其他文件复制到输出，但您的出色问题让我质疑我的方式。我发现如果您右键单击项目并选择属性，则会出现一个不同的对话框，它允许您指定在构建期间要执行的操作。但是，我无法使用标准 Windows 命令创建类似于您想要的行为。因此，您可能需要编写自己的程序来将文件复制到输出。

# php - 如何在 Objective-C 中读取 php 数组？

> ID：661062
> 
> 赞同：1
> 
> 时间：2009-03-19T04:23:11.453
> 
> 标签：php, objective-c, associative-array

在php中我有：

```
$result = mysql_query($query);
// if successful query, return the records
if ($result)
{
    // if not empty result, return array of records
    if (mysql_num_rows($result))
    {
        $records = array();
        while ($row = mysql_fetch_assoc($result))
        {
            $records[] = $row;
        }
        return $records;
    }
     } 
```

在 Objective-C 中 - 在 POST 之后我有以下代码......

```
NSURLResponse *newStr = [[NSURLResponse alloc] init];
NSData *returnData = [NSURLConnection sendSynchronousRequest:request returningResponse:&newStr error:nil]; 
```

returnData 等于文字“数组”，而不是 $records[] 的内容

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T04:27:06.233

您需要以某种可以在 Objective-C 中读取的格式来格式化您的数组。我建议使用[JSON](http://json.org)。

如果您有 PHP 5.2，则可以使用[内置函数](http://us3.php.net/json)对数据进行编码。例如：

```
echo json_encode($records); 
```

在 Objective-C 方面，您可以使用[TouchJSON](http://code.google.com/p/touchcode/wiki/TouchJSON)对 JSON 进行解码/编码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T04:44:50.607

如果可以，您应该将数据序列化为 XML 类型`plist`格式，然后它可以被 NSArray 和 NSDictionary 等 Cocoa 类本地解释。NSPropertyListSerializer 能够从文件或包含 plist 格式的序列化数据的 NSData 对象生成可变或不可变数组和字典。

NSDictionary 也可以读取这种格式的文件：

```
"key" = "value";
"key2" = "value2"; 
```

同样，NSArray 可以读取这种格式的文件：

```
(
     "value1",
     "value2",
     "value3",
     "30",
     "value5"
); 
```

事实上，我认为如果字符串不包含空格，引号是可选的（但我猜它们会强制字符串类型）。

查看[此 URL](http://developer.apple.com/documentation/Cocoa/Conceptual/PropertyLists/OldStylePlists/OldStylePLists.html)以获取有关 oldschool ASCII 属性列表的更多信息。它们是只读的，但是它们很容易手动或系统地生成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T04:26:46.157

在 PHP 方面，您需要将数组序列化为 JSON 或 XML 之类的格式，而不仅仅是`print`ing 它。然后在 iPhone 端`NSData`使用适当的库反序列化对象

# java - Java中的线程：如何锁定对象？

> ID：661068
> 
> 赞同：33
> 
> 时间：2009-03-19T04:29:39.300
> 
> 标签：java, multithreading, concurrency, locking

以下函数在其自己的线程中执行：

```
private void doSendData()
{
    try {

           //writeToFile(); // just a temporary location of a call
           InetAddress serverAddr = InetAddress.getByName(serverAddress);
           serverAddr.wait(60000);
           //Log.d("TCP", "C: Connecting...");
           Socket socket = new Socket(serverAddr, portNumber);
           socket.setSoTimeout(3000);

               try {
                //Log.d("TCP", "C: Sending: '" + message + "'");
                PrintWriter out = new PrintWriter( new BufferedWriter( new OutputStreamWriter(socket.getOutputStream())),true);
                String message = packData();
                out.println(message);
                Log.d("TCP", "C: Sent.");
                Log.d("TCP", "C: Done.");
                connectionAvailable = true;

             } catch(Exception e) {
                 Log.e("TCP", "S: Error", e);
                 connectionAvailable = false;

               } finally {
                  socket.close();
                  announceNetworkAvailability(connectionAvailable);
                }

         } catch (Exception e) {
              Log.e("TCP", "C: Error", e);
              announceNetworkAvailability(connectionAvailable);
         }
} 
```

当执行到达该行时`serverAddr.wait(60000)`，它会引发异常：

```
java.lang.IllegalMonitorStateException: object not locked by thread before wait() 
```

有谁知道如何锁定对象或函数以防止并发？我试图添加一个 Lock 对象：

```
private final Lock lock = new ReentrantLock(); 
```

和线

```
boolean locked = lock.tryLock(); 
```

在功能开始时，但它不起作用。

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2009-03-19T04:35:06.743

为了在一个对象上调用 wait() ，你必须持有那个对象上的同步锁（虽然锁实际上是在线程等待时释放的）：

```
synchronized (serverAddr) {
  serverAddr.wait();
} 
```

我不得不承认，在这种情况下，你*为什么*要这样做让我感到困惑......

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-03-22T04:33:06.560

也许您正在寻找的方法是[Thread.sleep(long)](https://docs.oracle.com/javase/8/docs/api/java/lang/Thread.html#sleep-long-)？此方法将在恢复之前*等待*（如停止线程的执行）指定的时间（以毫秒为单位）。

[object.wait(long)](https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#wait-long-)（这是你正在使用的）做一些完全不同的事情。它等待来自另一个线程的另一个对象通知它（即：向它发送一种唤醒消息），并且最多会等待指定的毫秒数。鉴于您发布的代码，我非常怀疑这是您真正想要的。

如果 Thread.sleep() 不是您想要的，那么您应该使用其他海报提到的同步块。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-03-19T05:18:04.550

当我看到这种代码时，我总是畏缩。帮自己一个忙，看看`java.util.concurrent`包装。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-19T04:33:36.343

为避免该错误消息，请使用 synchronized 关键字：

```
synchronized(serverAddr){
  serverAddr.wait(60000);
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-19T09:28:33.217

以上是正确的。您可以使用同步的代码块。或者您可以创建他们所谓的互斥锁。互斥体实际上可以是任何对象。很多人只是将 Object 本身用作互斥体。然后你可以锁定互斥锁。任何想要访问的线程都必须等待持有互斥锁的线程释放它。

Apocalisp 也提出了一个建议。我还建议您查看 java.util.concurrent 包。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-10-02T02:09:22.547

通常，当您在 Java 中使用多线程程序时，您需要使用同步（关键字）锁定共享变量，然后在任何时候只有一个线程可以访问共享内存。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-05-11T13:27:50.720

下面的代码应该可以工作。

```
 private final ReentrantLock lock = new ReentrantLock();

     lock.lock();  // block until condition holds
     try {
        serverAddr.wait(60000);
     } finally {
       lock.unlock()
     }
   } 
```

有关更多详细信息，请参阅此文档[页面](https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/locks/ReentrantLock.html)。

```
public void lock() 
```

> 获取锁。
> 
> 如果没有被另一个线程持有，则获取锁并立即返回，将锁持有计数设置为 1。

如果当前线程已经持有锁，则持有计数加一并且该方法立即返回。

如果锁被另一个线程持有，那么当前线程将被禁用以用于线程调度目的并处于休眠状态，直到获得锁为止，此时锁持有计数设置为 1

请参阅此 SE 问题以了解`lock`over的优点`synchronization`：

[同步与锁定](https://stackoverflow.com/questions/4201713/synchronization-vs-lock/)

# .net - 为非本地管理员 windows 用户使用模拟时，DLL 引用失败并显示“拒绝访问”

> ID：661081
> 
> 赞同：0
> 
> 时间：2009-03-19T04:36:15.837
> 
> 标签：.net, wcf, security, impersonation

我们有一项使用 WCF 和模拟的服务。

用户可以使用属于 Active Directory 系统的凭据登录到客户端应用程序。

用户登录是模拟服务端。

当登录的用户在其主机上设置为本地管理员时，这可以正常工作。

但是当他们是非特权（标准）用户时会出现问题。我们收到一个异常，指出“访问被拒绝”“我们的 DLL 之一”。（它发生在我们所有的 DLL 上）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-25T11:41:26.883

这实际上是一个简单的部署环境权限问题。

使用[代码访问安全策略工具 (Caspol.exe)](http://msdn.microsoft.com/en-us/library/cb6t8dtz%28VS.80%29.aspx)只需应用正确的权限即可。[msdn](http://msdn.microsoft.com/en-us/library/aa302361.aspx)上有一个使用指南。

实际的命令行字符串是

CasPol.exe -addgroup 1 -strong -file D:\deployment_location\WcfServiceHost.exe -noname -noversion FullTrust

这是在一组服务上执行的。由于我们的版本号经常更改，使用“更新”很有帮助，该服务还需要在我们的设置中使用 FullTrust。

要为各种机器重复使用该修复程序，请创建一个 PowerShell 脚本（或批处理文件）并使用“polchgprompt”参数关闭提示，以便脚本可以在无需干预的情况下执行。

polchgprompt - “启用或禁用在 Caspol.exe 使用会导致策略更改的选项运行时显示的提示。”

脚本结构：

```
CasPol.exe -polchgprompt off

--all the individual service calls--
CasPol.exe -addgroup 1 -strong -file D:\deployment_location\WcfServiceHost.exe -noname -noversion FullTrust
...

CasPol.exe -polchgprompt on 
```

# python - Python eval() 在不受信任的字符串上的安全性？

> ID：661084
> 
> 赞同：29
> 
> 时间：2009-03-19T04:39:50.180
> 
> 标签：python, security, eval

如果我正在使用 eval() 评估 Python 字符串，并且有一个类似的类：

```
class Foo(object):
    a = 3
    def bar(self, x): return x + a 
```

如果我不信任该字符串，会有哪些安全风险？尤其：

1.  `eval(string, {"f": Foo()}, {})`不安全吗？也就是说，您可以从 Foo 实例访问 os 或 sys 或不安全的东西吗？
2.  `eval(string, {}, {})`不安全吗？也就是说，我可以完全从 len 和 list 等内置函数访问 os 或 sys 吗？
3.  有没有办法让内置函数在 eval 上下文中根本不存在？

有一些不安全的字符串，例如“[0] * 100000000”我不在乎，因为在最坏的情况下它们会减慢/停止程序。我主要关心保护程序外部的用户数据。

显然，`eval(string)`在大多数情况下，没有自定义词典是不安全的。

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-03-19T05:13:44.763

`eval()`将允许恶意数据破坏您的整个系统，杀死您的猫，吃掉您的狗并与您的妻子做爱。

最近在 python-dev 列表上有一个关于如何安全地做这种事情的线程，结论是：

*   正确地做到这一点真的很难。
*   它需要python解释器的补丁来阻止许多类型的攻击。
*   除非你真的想要，否则不要这样做。

从这里开始阅读挑战：[http ://tav.espians.com/a-challenge-to-break-python-security.html](http://tav.espians.com/a-challenge-to-break-python-security.html)

你想在什么情况下使用 eval()？您是否希望用户能够执行任意表达式？或者您想以某种方式传输数据？也许可以以某种方式锁定输入。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-06-09T20:28:25.967

您无法使用这样的黑名单方法保护 eval。请参阅Eval对于会导致 CPython 解释器段错误、允许访问您喜欢的任何类等的输入示例[确实很危险。](http://nedbatchelder.com/blog/201206/eval_really_is_dangerous.html)

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-03-19T21:55:19.187

您可以开始`os`使用内置函数：`__import__('os')`.

对于 python 2.6+，[ast 模块](http://docs.python.org/library/ast.html#ast-helpers)可能会有所帮助；特别是`ast.literal_eval`，尽管这完全取决于您要评估的内容。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-03-19T20:36:24.740

请注意，即使您将空字典传递给 eval()，仍然可以使用一些语法技巧对 (C)Python 进行段错误。例如，在你的解释器上试试这个：`eval("()"*8**5)`

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-19T05:57:13.223

你最好把这个问题转过来：

1.  你想要评估什么样的表达式？
2.  你能确保只有匹配某些狭义语法的字符串是 eval()d 吗？
3.  然后考虑是否*安全*。

例如，如果您想让用户输入代数表达式进行评估，请考虑将它们限制为一个字母的变量名称、数字以及一组特定的运算符和函数。不要 eval() 包含其他任何内容的字符串。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-01-03T10:14:40.817

在 Mark Pilgrim 的[Dive into Python](http://www.diveintopython3.net/)教程中有一篇很好[的关于不安全的文章。`eval()`](http://www.diveintopython3.net/advanced-iterators.html#eval)

引用自这篇文章：

> 最后，可以安全地评估不受信任的 Python 表达式，因为某些“安全”的定义在现实生活中并不是非常有用。如果您只是在玩耍，那很好，如果您只通过它受信任的输入也很好。但其他任何事情都只是自找麻烦。

# c# - 从传递给 C# 的 F# 列表中检索项目

> ID：661095
> 
> 赞同：9
> 
> 时间：2009-03-19T04:49:06.540
> 
> 标签：c#, .net, f#

我在 C# 中有一个在 F# 中调用的函数，将其参数传递给`Microsoft.FSharp.Collections.List<object>`.

如何从 C# 函数的 F# 列表中获取项目？

**编辑**

我找到了一种“功能”风格的方式来循环它们，并且可以将它们传递给如下函数以返回 C# System.Collection.List：

```
private static List<object> GetParams(Microsoft.FSharp.Collections.List<object> inparams)
{
    List<object> parameters = new List<object>();
    while (inparams != null)
    {
        parameters.Add(inparams.Head);
        inparams = inparams.Tail;
     }
     return inparams;
 } 
```

**再次编辑**

正如下面所指出的，F# List 是 Enumerable，因此可以将上述函数替换为该行；

```
new List<LiteralType>(parameters); 
```

但是，有没有办法通过索引引用 F# 列表中的项目？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-19T05:09:08.487

通常，避免将 F# 特定类型（如 F# 'list' 类型）暴露给其他语言，因为体验并不是那么好（如您所见）。

F# 列表是一个 IEnumerable，因此您可以通过这种方式轻松地创建例如 System.Collections.Generic.List。

没有有效的索引，因为它是一个单链表，因此访问任意元素是 O(n)。如果您确实需要该索引，最好更改为另一种数据结构。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-07-27T13:26:23.860

在我的 C# 项目中，我制作了扩展方法来轻松地在 C# 和 F# 之间转换列表：

```
using System;
using System.Collections.Generic;
using Microsoft.FSharp.Collections;
public static class FSharpInteropExtensions {
   public static FSharpList<TItemType> ToFSharplist<TItemType>(this IEnumerable<TItemType> myList)
   {
       return Microsoft.FSharp.Collections.ListModule.of_seq<TItemType>(myList);
   }

   public static IEnumerable<TItemType> ToEnumerable<TItemType>(this FSharpList<TItemType> fList)
   {
       return Microsoft.FSharp.Collections.SeqModule.of_list<TItemType>(fList);
   }
} 
```

然后像这样使用：

```
var lst = new List<int> { 1, 2, 3 }.ToFSharplist(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-02-04T15:07:55.527

回答已编辑的问题：

> 但是，有没有办法通过索引引用 F# 列表中的项目？

我更喜欢 f# 而不是 c# 所以这里是答案：

```
let public GetListElementAt i = mylist.[i] 
```

返回一个元素（也适用于您的 C# 代码）。

# sharepoint - SharePoint CAML 查询中的上限函数

> ID：661099
> 
> 赞同：1
> 
> 时间：2009-03-19T04:51:43.770
> 
> 标签：sharepoint, moss, wss, caml

我正在尝试为共享点列表创建自定义视图，类似于此处解释的视图：

[http://msdn.microsoft.com/en-us/library/ms916812.aspx](http://msdn.microsoft.com/en-us/library/ms916812.aspx)

我有一列是一个数字字段，其值范围从 0 到 100。

我需要创建一个视图样式，它将根据列值在列中显示图像，而不是显示值。

如果值在 0 到 25 之间，我需要显示图像 25.gif 如果值在 25 到 50 之间，我需要显示图像 50.gif .....等等。

这里涉及到的计算是CEILING函数，CEILNG(NumberColumn,25)

问题是，我需要在 CAML 中的 VWSTYLES.XML 中指定这个

如何在 CAML 中指定 Ceilnig 函数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T07:31:57.660

[CEILING](http://office.microsoft.com/en-us/sharepointtechnology/HA011609661033.aspx)用于四舍五入十进制值。由于您只有几张图像，我将只使用嵌套的[IF](http://office.microsoft.com/en-us/sharepointtechnology/HA011610101033.aspx)函数：

```
=IF([NumberColumn]>76, "100.gif", IF([NumberColumn]>51, "75.gif",
 IF([NumberColumn]>26,  "50.gif", "25.gif"))) 
```

您还可以使用[MOD](http://office.microsoft.com/en-us/sharepointtechnology/HA011610311033.aspx)函数将 0-24 转换为 0、25-49 转换为 1 等，然后从那里计算您的图像。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T20:37:04.007

其他一些选项可能是：

由于 VWSTYLES.XML 只是呈现 html 的一种非常尴尬的方式，您可以在 VWSTYLES.XML 中编写一些 javascript 以使用正确的源呈现图像标签。

或者，开发 ascx 控件并获取 VWSTYLES.XML 以呈现控件而不是 HTML。只要你能正确注册页面上的控件即可。

# iphone - UIPickerView 如何处理 2+ 个旋转的表盘？

> ID：661101
> 
> 赞同：2
> 
> 时间：2009-03-19T04:52:05.457
> 
> 标签：iphone, cocoa-touch, uipickerview

如果我有一个带有三个组件（表盘）的 UIPickerView。拾取器如何处理同时旋转的两个表盘？例如，用户可能轻拂第一个转盘，该转盘自由旋转并立即缓慢点击第二个转盘上的选择。

我正在选择器中执行以下操作。如果一个表盘在旋转，我不会捕捉到它的价值。我只在表盘一次旋转一个时捕获值。

```
- (void)pickerView:(UIPickerView *)thePickerView didSelectRow:(NSInteger)row inComponent:(NSInteger)component{

if(component == 0){
    dateEndCenturyText = (NSString *)[dateCentury objectAtIndex:row];
}
else if(component == 1){
    dateEndDecadeText = (NSString *)[dateYear objectAtIndex:row];

}
else if(component == 2){
    dateEndYearText = (NSString *)[dateYear objectAtIndex:row];
} 
```

即使两个表盘在旋转，是否有更好的方法来确保捕获值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T19:25:33.243

对此最强大的解决方案可能是每次触发事件时更新所有三个值。您可以使用以下方法检索 UIPickerView 中任何组件的选定行：

> UIPickerView selectedRowInComponent：
> 
> 返回给定组件中选定行的索引
> 
> - (NSInteger)selectedRowInComponent:(NSInteger)组件

希望这可以帮助！

# c# - 线程中使用的委托？

> ID：661103
> 
> 赞同：1
> 
> 时间：2009-03-19T04:55:18.677
> 
> 标签：c#, delegates

当我们在委托类型的变量上调用 BeginInvoke 时，内部会发生什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T07:13:22.840

这取决于调用 BeginInvoke 的对象的类型。

[ISynchronizeInvoke](http://msdn.microsoft.com/en-us/library/system.componentmodel.isynchronizeinvoke.begininvoke(VS.71).aspx)是定义 BeginInvoke 的接口。它将委托传递给实现该接口的对象，并且该对象将（应该）安排线程在它自己的主线程上运行。

有几个对象实现了这个接口。WPF 中的 Dispatcher 执行此操作 - 当您在调度程序上调用 BeginInvoke 时，委托将添加到调度程序的队列中，并在适当的时候运行。

Windows 窗体中的 Control 基类也实现了 ISynchronizeInvoke （我相信这可能是您的问题所暗示的）。在 Windows 窗体中，事情要复杂得多。 [这是一篇很棒的文章](http://weblogs.asp.net/justin_rogers/articles/126345.aspx)，解释了细节。基本上，当您在 winforms 控件上调用 BeginInvoke 时发生的情况是，一个特殊的编组器创建了一个传递给程序的 Windows 消息，并且 UI 线程将要运行的委托排队。它比那更复杂（如那篇文章所述），但这是基本思想。然后委托在主 UI 线程上运行。

还有其他实现 ISynchronizeInvoke 的对象，但其中大多数是管理和运行自己的线程的对象。这些对象维护一个委托队列，并将您的委托添加到该队列中，以便它在其线程上运行。

# java - 如何使浏览器从 Java 小程序导航到给定的 URL？

> ID：661104
> 
> 赞同：4
> 
> 时间：2009-03-19T04:55:31.000
> 
> 标签：java, cross-platform, applet, cross-browser

我有一个 Java 小程序，它由一个类似向导的表单组成，包含三个步骤。在最后一步，用户可以单击“完成”按钮。我希望该按钮使 Web 浏览器导航到特定的 URL。

**问题：**有没有办法让浏览器导航到特定的 URL，以使其适用于所有现代浏览器？我的特定浏览器要求是 FF3+、IE7+、Safari 3+ 和 Opera 9+。我正在使用 Java 1.5。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-26T19:00:06.163

从小程序中，您可以简单地获取小程序上下文并调用[showDocument(url)](http://java.sun.com/javase/6/docs/api/java/applet/AppletContext.html#showDocument(java.net.URL))。

这将从当前页面导航到指定的 URL：

```
getAppletContext().showDocument(url); 
```

此外，您可以传递[目标](http://java.sun.com/javase/6/docs/api/java/applet/AppletContext.html#showDocument(java.net.URL,%20java.lang.String))参数。

要访问相对 URL，您可以使用：

```
URL url = new URL(getCodeBase().getProtocol(),
                          getCodeBase().getHost(),
                          getCodeBase().getPort(),
                          "/next.html");
getAppletContext().showDocument(url); 
```

自 Java 1.1 版以来，这些都适用于所有主流浏览器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T05:19:11.210

您可以从 JavaScript 中启动向导，并让小程序在单击“完成”按钮时将执行流程返回给 JavaScript 调用者。一旦你在 JavaScript 中，你就可以导航到一个新的位置，要么通过表单发布，要么通过更改 window.location 属性。

在最坏的情况下，您可以检查[LiveConnect](http://java.sun.com/products/plugin/1.3/docs/jsobject.html)的使用，但我会用一根 10 英尺长的杆子触摸它。

* * *

**LiveConnect 更新**

最初的 LiveConnect 似乎在本质上仅限于在 Windows 上运行的浏览器，并且可能仅适用于 NN 和 IE。[其中一些错误最近已修复](https://developer.mozilla.org/en/LiveConnect)，但浏览器兼容性仍将是一个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T11:42:16.030

如果您使用的是 Java 6 及更高版本，请参阅[桌面](http://java.sun.com/developer/technicalArticles/J2SE/Desktop/javase6/desktop_api/)API。这将驱动浏览器。但是我不知道小程序安全模型是否会干扰这一点。

除此之外，我成功地使用了[BrowserLauncher2](http://browserlaunch2.sourceforge.net/)。类似的警告也适用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-05-20T16:52:19.990

```
String googleURL = "https://www.google.com/";

try {
   java.awt.Desktop.getDesktop().browse(java.net.URI.create(googleURL));    
}
catch(IOException ex) {    
    Logger.getLogger(UI.class.getName()).log(Level.SEVERE,null, ex);    
} 
```

# c# - 铁杆 Java 家伙的 Windows 开发

> ID：661105
> 
> 赞同：4
> 
> 时间：2009-03-19T04:56:02.857
> 
> 标签：c#, java, visual-studio, winapi

问这个问题我有点惭愧，因为，你知道，我很长时间以来一直非常反对 MS。我很幸运能够在 Visual Studio 之外谋生。随着年龄的增长，我想尝试“一些”事情，老实说，这个问答网站启发了我，我意识到 VS 和 Windows 开发并没有那么糟糕。嘿，毕竟 C# 是在 Java 之后设计的，现在 Java 正在从子语言中复制一些功能。Windows Vista 是自 Windows 出现以来第一个体面的版本。

无论如何，对于观众中的任何 +3,000 用户，您可以删除以上所有废话并保留以下内容：

您是否有旨在学习来自强大 Java 背景的 Windows 开发的链接、资源、教程？

我对 Windows 操作（即实际窗口、框架、获取名称、获取最重要的应用程序等、以编程方式调整其大小等）和 Windows Search API 以及其他次要 API 非常感兴趣。毕竟我的兴趣是通过 JNI 或 JNA 将它们与我的 Java 应用程序集成。

我已经阅读了 MSDN 上的许多教程和链接，并且我实际上了解它本身的 API。我拿到了一份 C# 和 C++ Express 的副本，实际上运行了一些基本示例。

我的问题是我没有了解整个架构的全局（因为，嗯，它**很大**）。这些类有数百种方法，我不清楚是谁调用它们。（当我第一次看到 Java 的 Javadoc API 时，我也有同样的看法。）我不知道一些基本的通用对象，例如`HWCD`（或类似的东西）它原来是窗口处理程序，但每一个教程我认为这是理所当然的（好像`WHCD`它是一个非常具有描述性的名称）。

我不知道 Win32、COM、COM+、DCOM、Windows SDK ADO 和其他一些技术之间的确切区别。我的意思是，我在某种程度上和常识都知道它们，但是在阅读教程或 API 时我会感到困惑。我试图获取一些“初学者”教程，但它们是针对使用 Visual Basic 的绝对 0 程序员（yiak！，**这**是我多年来远离 MS 的主要原因。）

我确实了解 .NET 框架、托管代码、非托管代码、C# 基础知识、CLR 和相关内容，因为它们与 Java 平台非常相似，几乎是透明的。

所以，毕竟我对 MS 开发的咆哮和诚实的意见：

对于非绝对初学者（编程）但对 Windows API 本身绝对陌生，学习 Windows 开发的最佳方法是什么？什么是好的路径？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T05:11:19.887

[Petzold](http://www.charlespetzold.com/pw5/)是您最好的新朋友，而[MSDN](http://msdn.microsoft.com/)是您的新 Javadocs。不过，在深入研究 C 之前，请确保您对 C 有很好的理解。如果您有兴趣，Forger 也有一个很棒的[初学者教程。](http://winprog.org/tutorial/)学习时闲逛的好地方是 efnet irc 上的#WinProg，许多 win32 专家随时准备提供帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T05:53:24.763

我将建议一条替代路径（阻力较小）。你看过WPF了吗？它是新的 GUI 工具包，可让您创建性感的界面（如 Vista 中的界面）。

这可能足以让您保持兴趣，同时轻松进行更高级的开发。从那里您可以跳入 Win API 的丛林（如果您选择）。

只是一个想法，因为那条路对我来说会更有趣。当然，您的里程可能会有所不同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T05:55:55.630

我强烈建议自己获得一份“ [Win32 Programming](https://rads.stackoverflow.com/amzn/click/com/0201634929) ”的副本。它解释了 WINDOWS 的基本 DNA - 如果您正在使用旧的 C++ win32、新的 C# WinForms 以及未来的 Windows Presentation Foundation 进行编程，那么这是有效的。

简而言之，Windows 程序由 WinMain 组成。首次启动时，应用程序向系统注册其窗口类，初始化然后启动一个消息循环，该循环一直持续到遇到 WM_QUIT。系统 (OS) 不断向应用程序的消息 Q 发送诸如键盘或鼠标单击等消息。在 Windows 中，任何时候都只有一个活动窗口——因此操作系统知道将消息发送给谁。

*类似的事情在上面的书中有详细的描述。*

COM (COM+, DCOM) 与 Windows 没有真正的关系。当 Word、Excel 变得流行并且需要能够从 Word 访问 Excel（反之亦然）时，他们提出了 AcitveX 技术，这是 COM 等的根源。您可以开始使用 Don Box 的“Essential COM” .

一个警告：在 Microsoft 世界中，有两种编程方式 - 采用样板方式（自己编写所有内容）或使用框架（MFC、ATL-COM....）。建议做一些样板，以便您了解基础知识。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-19T20:15:56.350

在一年前进行了相同的转换后，我可以说有很多文献专门用于从 Java 背景中学习 c#。这是我第一次发现它对学习 C# 的重要差异/特性非常有用：

[从 Java 开发人员的角度来看 C#](http://www.25hoursaday.com/CsharpVsJava.html)

还有一些值得一看的书（谷歌'c# for java程序员'）。正如 JohnT 所说，MSDN 库相当于 JavaDocs API，但我发现使用它真的很令人沮丧。最好的学习方法是获取 Visual Studio express 的副本并开始玩。使用智能感知探索类和方法。找到一个你用 Java 编写的小程序，并尝试用 C# 重现它。从简单的问题开始，使用 google 解决它们。第一周你会觉得很难，但相信我，它会以惊人的速度出现在你身上！

# iphone - 如何在我的 iPhone 应用程序中使用动画 .gif？

> ID：661108
> 
> 赞同：20
> 
> 时间：2009-03-19T04:57:50.963
> 
> 标签：iphone, graphics

我有一个要在我的 iPhone 应用程序中使用的动画 gif 文件，但是动画不起作用。有人知道如何解决吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-03-25T02:53:16.727

如果你有一系列想要动画的图像，你可以使用 UIImageView 轻松完成：

```
UIImage *blur5 = [UIImage imageNamed:@"blur5.png"];
UIImage *blur6 = [UIImage imageNamed:@"blur6.png"];

self.imageView.animationImages = [[NSArray alloc] initWithObjects:blur5, blur6, nil];
self.imageView.animationRepeatCount = 5;
[self.imageView startAnimating]; 
```

我发现这比尝试使用 UIWebView 更容易。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-28T07:13:14.323

UIWebView 无法正确显示所有 GIF 内容。您需要使用 UIImageView，但 iPhone OS 不支持动画 GIFS，仅显示第一帧。

因此，您需要先提取所有其他帧。

此处的粗略示例代码：http: [//pliep.nl/blog/2009/04/iphone_developer_decoding_an_animated_gif_image_in_objc](http://pliep.nl/blog/2009/04/iphone_developer_decoding_an_animated_gif_image_in_objc)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-03-31T09:32:23.847

[您可以在http://blog.stijnspijker.nl/2009/07/animated-and-transparent-gifs-for-iphone-made-easy/](http://blog.stijnspijker.nl/2009/07/animated-and-transparent-gifs-for-iphone-made-easy/)使用源 它有一个 GIF 解码器，您可以直接使用它来获得解决方案。我成功地使用了它。但它在透明度方面存在一些问题。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-12-22T10:15:50.393

这可以通过这段代码来实现：

```
NSArray * imageArray  = [[NSArray alloc] initWithObjects:[UIImage imageNamed:@"1.png"], [UIImage imageNamed:@"2.png"], nil]; //this will be the frames of animation images in sequence.
 ringImage = [[UIImageView alloc]initWithFrame:CGRectMake(100,200,600,600)];
 ringImage.animationImages = imageArray;
 ringImage.animationDuration = 1.5;//this the animating speed which you can modify
 ringImage.contentMode = UIViewContentModeScaleAspectFill;
 [ringImage startAnimating];//this method actually does the work of animating your frames. 
```

我知道它是一个旧线程..但可能对某人有帮助..:)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-07-03T16:38:26.827

另一种选择是在您的应用程序中解码 gif，然后将其“帧服务”到 OpenGL 对象。这种方式不太可能耗尽大型 gif 的内存。

# java - 如何在 Eclipse 的项目中包含 .class 文件？（爪哇）

> ID：661110
> 
> 赞同：27
> 
> 时间：2009-03-19T04:58:32.507
> 
> 标签：java, eclipse, class

大家好。我正在为学校开发一个项目，在该项目中我们获得了 .class 文件，但没有包含在我们的代码中的源代码。我正在使用 Eclipse，我想在我的项目中包含该文件，以便我可以从中实例化对象并使用它。

该文件是 TokenizerImpl.class，我想这样使用它：

`TokenizerImpl tokenizer = new TokenizerImpl(foo);`

我将文件放在我的项目文件夹中，Eclipse 说“TokenizeImpl 无法解析为类型”，我认为这意味着它找不到类或源。我尝试将它放在项目的“bin”文件夹中并得到了同样的错误。谷歌搜索和 SO 搜索似乎没有回答这个问题，所以我会试一试。我该怎么做，哦，聪明的人？

编辑：哦，亲爱的，我发现问题完全是另外一回事。这些解决方案运行良好，但我只是忘记创建 TokenizerImpl 实现的 Tokenizer 接口。多哈。不过，感谢您的所有帮助，我确实学到了很多关于 Eclipse 的知识。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-03-19T05:28:28.410

您可以将包含类文件的目录添加到 Eclipse 项目中，前提是它位于您的 Eclipse 项目之一中，无论是在生成的目录中还是在您创建的目录中。

这可以通过将类文件夹添加到应用程序的 Java 构建路径来完成。您可以通过访问 Java Build Path -> Libraries -> Add Class Folder 在项目属性中进行设置。请记住，您必须在其包中指定包含类文件的根文件夹。

因此，如果您希望编译器访问项目 A 下的 classes 目录中的 com.stackoverflow.Example.class（但不在项目 A 的构建路径中），那么您应该将“classes”添加为类文件夹，并且不是 classes/com/stackoverflow 作为类文件夹。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-03-19T06:38:59.893

项目 -> 属性 -> Java 构建路径 -> 库 -> 添加外部类文件夹

该文件夹必须包含一个包层次结构，即如果您的类确实是 foo.bar.TokenizerImpl，它必须在子目录 foo/bar 中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T10:01:36.960

您还可以 JAR 想要添加的类文件并将 JAR 文件添加到构建依赖项。对我来说，这是最干净的解决方案。当然，JAR 文件在内部必须具有正确的目录结构。

右键单击您的项目并选择 Java Build Path 以添加新的依赖项。

将其复制到 bin 文件夹中不会很好，因为它旨在保存编译源的结果。一旦你清理任何东西，文件就会消失。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-19T05:01:58.117

其他人现在给出了更好的答案。这个“答案”主要是从 OP 那里获取信息，因为最初的问题并没有真正完全地告诉我们已经尝试过什么。现在有[两个](https://stackoverflow.com/questions/661110/how-do-i-include-class-files-in-my-project-in-eclipse-java/661143#661143) [答案](https://stackoverflow.com/questions/661110/how-do-i-include-class-files-in-my-project-in-eclipse-java/661247#661247)可以真正长期地回答这个问题。

我的原始答案留在下面以供参考。

您是否将它复制到 Eclipse 内或 Eclipse 外的 bin 文件夹？如果您在 Eclipse 之外执行此操作，那么您必须右键单击“bin”文件夹并选择“刷新”以便 Eclipse 看到新文件。

bin 目录下相应文件夹（取决于其包）中的 *.class 文件应该执行此操作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-19T10:14:54.853

或将所有内容放入 jar 文件并将其添加为外部 jar。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-03-23T00:06:43.530

压缩类文件夹。

突出显示项目名称，单击顶部工具栏中的“项目”，单击“属性”，单击“库”选项卡，单击“添加外部 jars”，添加压缩文件

# javascript - javascript regexp，验证日期问题

> ID：661117
> 
> 赞同：1
> 
> 时间：2009-03-19T05:04:52.600
> 
> 标签：javascript, regex, validation

我有一些用于验证以下日期的代码：

```
 function validateForm() {
var errFound = 0;       
//var patt_date = new RegExp("^((((19|20)(([02468][048])|([13579][26]))-02-29))|((20[0-9][0-9])|(19[0-9][0-9]))-((((0[1-9])|(1[0-2]))-((0[1-9])|(1\d)|(2[0-8])))|((((0[13578])|(1[02]))-31)|(((0[1,3-9])|(1[0-2]))-(29|30)))))$");
var patt_date = new RegExp("^[0-9]{4}-(((0[13578]|(10|12))-(0[1-9]|[1-2][0-9]|3[0-1]))|(02-(0[1-9]|[1-2][0-9]))|((0[469]|11)-(0[1-9]|[1-2][0-9]|30)))$");
if (patt_date.test(document.getElementById("datefrom").value) == false){errFound = errFound + 1;document.getElementById("datefrom").className = "error";}

if (errFound > 0)
    alert('Please correct red colored field!');
else
    return true;
return false;   
} 
```

以上代码应适用于 YYYY-MM-DD 格式，但无法验证日期，例如**“2009-02-29”**

注释的代码应该可以工作**(//var patt_date = new RegExp...)**，它可以捕获**"2009-02-29"**，
但是当我输入无效数据并尝试更正它时它会破坏验证，它一直在抱怨什么在我纠正它们后表单值出错（尤其是在具有多个输入的表单上）

也许有人可以修复当前的正则表达式？

* * *

**已编辑**，我只想简单地替换上面的正则表达式，意思是一个新的正则表达式模式而不是验证日期的全新方法
作为参考，我只是从以下网址获取正则表达式模式：
[http://www.regexlib.com/REDetails。 aspx?regexp_id=694](http://www.regexlib.com/REDetails.aspx?regexp_id=694)和
[http://www.regexlib.com/REDetails.aspx?regexp_id=933](http://www.regexlib.com/REDetails.aspx?regexp_id=933)

用**2009-02-29**测试，第一个链接有效，第二个无效。再次问题是只有第二个正则表达式没有检测到值**2009-02-29**无效，而第一个可以（但它破坏了我的代码？所以它一定有问题）。

谢谢，
德尔斯

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-19T05:29:43.150

不要使用正则表达式进行整个日期验证，这确实推动了正则表达式的设计极限。我建议改用这个程序：

1.  根据正则表达式检查日期`/^\d{4}-\d{2}-\d{2}$/`
2.  提取年、月、日`substr()`并转换为整数
3.  使用一些`if`语句来验证整数。像这样：

```
    如果（月 == 2）{
        如果（天 == 29）{
            如果（年 % 4 ！= 0 || 年 % 100 == 0 && 年 % 400 ！= 0）{
                // 失败
            }
        }
        否则如果（天> 28）{
            // 失败
        }
    }
    否则 if (月 == 4 || 月 == 6 || 月 == 9 || 月 == 11) {
        如果（天> 30）{
            // 失败
        }
    }
    别的 {
        如果（天> 31）{
            // 失败
    }

```

（这当然可以写得更简洁）或者，您可以使用 Javascript 的`Date`类执行此验证 - 您可能必须执行解析日期、将其转换回字符串以及检查两个字符串是否相等等操作。（我不是 Javascript 专家）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-19T05:59:49.567

在这点上我有点同意 David 的观点…… 正则表达式匹配不应该被用作决定通过的日期是否实际上有效的排他性标准。Javascript 验证中的通常过程涉及几个步骤：

一种。第一步是通过将其与正则表达式匹配来确保传递的字符串与*预期*的日期格式匹配。以下可能是更严格的 Regex 模式。

```
// Assuming that the only allowed separator is a forward slash.
// Expected format: yyyy-mm-dd
/^[12][90][\d][\d]-[0-3]?[\d]-[01]?[\d]$/ 
```

湾。第二步是将字符串解析为一个 Date 对象，该对象返回编号。自 1970 年以来的毫秒数。将此数字用作 Date 构造函数的参数。

C。由于 JS 自动将传递的日期翻转到最接近的有效值，因此您仍然无法确定创建的 Date 对象是否与传递的对象匹配。要确定是否发生这种情况，最好的方法是根据分隔符拆分传递的字符串并比较各个日期组件：

```
// d is the created Date object as explained above.
var arrDateParts = inputDate.split("-");
if ((d.getFullYear() == arrDateParts[0]) && (d.getMonth() == arrDateParts[1]) && (d.getDate() == arrDateParts[2]))
  return true;
else
  return false; 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2010-07-28T18:35:04.463

此 javascript 代码可准确验证日期。您可以复制它并在浏览器中进行测试。

```
 var regDate = '^(19[0-9]{2}|2[0-9]{3})-(0[1-9]{1}|1[0-2]{1}){1}-(0[1-9]|(1|2)[0-9]|3[0-1]){1}$';
 var txt='2010-01-31';
 if(txt.match(regDate))
 {
    alert('date match');
 } 
```

# javascript - 与 CruiseControl 结合的 JS 框架

> ID：661118
> 
> 赞同：0
> 
> 时间：2009-03-19T05:05:06.673
> 
> 标签：javascript, model-view-controller, entity-framework, cruisecontrol.net

有没有可以合并的 JS 框架`CruiseControl.NET`？或者具有密集单元测试功能的最佳 JS 框架是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-10-14T08:15:31.880

任何 .NET 项目最常见的 JavaScript 框架是 jQuery——因为微软现在将它包含在 ASP.NET MVC 框架中，我认为他们现在在其中占有一席之地。

# php - 如何从 PHP 进行传真实现？

> ID：661125
> 
> 赞同：0
> 
> 时间：2009-03-19T05:09:30.313
> 
> 标签：php, open-source, soap, fax

我正在使用 PHP，我需要从我的网站发送特定文件的传真。这需要适用于世界上的任何数字。到目前为止，我的搜索建议使用[SOAP](http://en.wikipedia.org/wiki/SOAP)。

不能像电子邮件一样发送传真吗？没有付费服务就不能发送传真吗？

我看过*[PHP4: How to Fax a character-based file, using NuSOAP](http://www.interfax.net/en/dev/webservice/samples/fax_php_sendcharfax_nusoa)*，它指的是`soapclient`.

网络服务位于[http://ws.interfax.net/dfs.asmx?wsdl](http://ws.interfax.net/dfs.asmx?wsdl)。如何在我的代码中使用此 Web 服务？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T05:56:41.383

可以通过电子邮件发送和接收传真。但是，最终您将不得不为服务付费。我不知道你上面提到的服务是否提供了这些东西。

什么语言和工具？任何，这就是 SOAP 的重点。这是两个程序相互交谈/发送数据的一种方式，独立于它们所编写的语言。SOAP 实际上只是它的一个特定名称。

只需按照您提供的网站上的代码...

```
require_once('nusoap.php');
$client = new soapclient("http://ws.interfax.net/dfs.asmx?wsdl", true);
$params[] = array('Username'      => '********',
                'Password'        => '********',
                'FaxNumber'       => '+44-870-730-1444',
                'Data'            => 'My text goes here',
                'FileType'        => 'TXT'
                );

$result = $client->call("SendCharFax", $params);

echo $result["SendCharFaxResult"]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T09:22:58.957

由于您需要一个网关来提供从互联网接收到的数据到电话网络的交易，因此无法将传真作为电子邮件发送或在没有付款服务的情况下发送。

“开发上述 SOAP 客户端”是什么意思？如果您想使用它，那么例如第一个链接中提供的代码就足够了。如果您不想使用[NuSOAP](http://www.codeproject.com/Articles/140189/PHP-NuSOAP-Tutorial)，那么在纯[PHP](http://en.wikipedia.org/wiki/PHP)中它应该接近：

```
$client = new SoapClient("http://ws.interfax.net/dfs.asmx?wsdl");
$params[] = array('Username'      => '********',
                'Password'        => '********',
                'FaxNumber'       => '+44-870-730-1444',
                'Data'            => 'My text goes here',
                'FileType'        => 'TXT'
                );

$result = $client->SendCharFax($params); 
```

如果你想开发一个 SOAP 服务器接口来提供这种服务，我建议你看看 NuSOAP 服务器。

# java - 如何设置“org.w3c.css.sac.parser”系统属性？

> ID：661131
> 
> 赞同：2
> 
> 时间：2009-03-19T05:16:04.993
> 
> 标签：java, eclipse, parsing, sac

在这个[ParserFactory.java](http://opensource.adobe.com/svn/opensource/flex/sdk/branches/gumbo_alpha/modules/thirdparty/batik/sources/org/w3c/css/sac/helpers/ParserFactory.java)

```
String className = System.getProperty("org.w3c.css.sac.parser");
if (className == null) {
    throw new NullPointerException("No value for sac.parser property");  //line 35
} else {
    return (Parser)(Class.forName(className).newInstance());
} 
```

当我在 Eclipse 中将此[DemoSAC.java](http://www.w3.org/TR/SAC/DemoSAC.java)文件作为 Java 应用程序运行时，我得到了

```
Exception in thread "main" java.lang.NullPointerException: No value for sac.parser property
at org.w3c.css.sac.helpers.ParserFactory.makeParser(ParserFactory.java:35) 
```

“org.w3c.css.sac.parser”属性到底是什么？Windows下如何设置？我应该把它设置成什么？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-20T19:39:35.040

如果您不想修改代码，也可以在 Eclipse 的 Java 启动配置对话框中设置 Java 属性。您在“参数”选项卡中指定“VM 选项”。要按照 javamonkey79 的建议将该属性设置为“org.w3c.flute.parser.Parser”，您可以指定：

-Dorg.w3c.css.sac.parser=org.w3c.flute.parser.Parser

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T06:35:30.137

看起来您需要提供一个接口实现。根据[此处](http://markmail.org/message/g4kx5po7gr2nzttg)的链接，这是一种方法：

*   [在这里](http://www.w3.org/2002/06/flutejava-1.3.zip)获取长笛解析器
*   将其添加到您的构建路径
*   将此添加到 DemoSAC 类（在 getProperty 调用之前）：

    System.setProperty("org.w3c.css.sac.parser", "org.w3c.flute.parser.Parser");

我不知道为什么它首先要进行这种基于反射的实例化，也许绕过 ParserFactory 并返回长笛解析器的新实例会更干净？

# ruby-on-rails - 如何使用acts_as_taggable_on_steroids 生成标签云

> ID：661136
> 
> 赞同：1
> 
> 时间：2009-03-19T05:17:57.810
> 
> 标签：ruby-on-rails

我的标签功能正常，但无法生成 tag_cloud

## 在我的控制器中：

```
def tag_cloud
  @tags = Article.tag_counts # returns all the tags used 
end 
```

## 在视图中：

```
<% tag_cloud Article.tag_counts.sort { |x, y| x.name <=> y.name }, %w(x-small small normal large x-large) do |tag, css_class| %>
  <%= link_to tag.name, tag_url( :tag => tag.name ), :class => css_class %>
<% end %> 
```

我总是得到一个未定义的方法错误`tag_cloud`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-19T05:31:10.807

您不能从视图中调用控制器方法。尝试将其放入模型中或将其从控制器传递给视图。

如果这还不够有用，请尝试编辑问题并包含更多详细信息，例如 的完整定义`tag_cloud`，解释为什么要设置 @tag 但不使用它等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-08T10:42:23.453

sergeykish.com is correct, you just need to include the helper in /app/helpers/application_helper.rb

```
module ApplicationHelper
  include TagsHelper
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T19:58:01.360

该代码看起来并不能满足您的所有需求，但是为了纠正未定义的方法错误，视图辅助方法的正确位置是在帮助程序中，因此请将方法移到`tag_cloud`那里。

您会在`app/helpers/controllername_helper.rb`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-02T21:12:20.370

`tag_cloud`在模块中定义`TagsHelper`。您需要将其包含在相应的帮助程序中：

```
module ApplicationHelper
  include TagsHelper
end 
```

也不需要控制器`tag_cloud`

# jquery - jQuery Simpletip 插件使用 title 属性

> ID：661140
> 
> 赞同：1
> 
> 时间：2009-03-19T05:25:37.560
> 
> 标签：jquery, simpletip

当您将 SimpleTip 插件应用到一组元素时，如何让[SimpleTip](http://craigsworks.com/projects/simpletip/)插件使用每个元素的属性作为工具提示文本？`title`

```
$('td[title]').simpletip({
    content : << this element's title attribute >>
}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-19T05:40:34.123

我认为这对你有用

```
$('td[title]').each(function() {
    $(this).simpletip({
        content : $(this).attr('title')
    });
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-19T05:41:12.670

```
$('td[title]').each(function() {
    $(this).simpletip({
        content : $(this).attr('title')
    });
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T05:36:23.867

我找到了一个技巧：

在 Simpletip 源代码中，大约第 25 行：

```
// change this line:
.html(conf.content)
// to this
.html(conf.content ? conf.content : elem.attr('title')) 
```

然后当你调用 simpletip 函数时：

```
$('td[title]').simpletip({
    content: false
}); 
```

是的，这有点hacky，但它有效。

# javascript - 处理异步调用

> ID：661145
> 
> 赞同：0
> 
> 时间：2009-03-19T05:28:45.210
> 
> 标签：javascript, asynchronous

如何处理异步调用以确保它们不重叠？

这是我的场景---

我有一个循环，在循环中我调用了一个谷歌 API 并指定了一个回调函数。我的回调函数处理结果并将输出写入表。

但是我注意到写入表的结果似乎重叠或混淆了，即说我在循环计数器 = 10 处调用 API，循环计数器 = 10 的结果可能会出现在循环计数器 = 值旁边的表中15.

如何确保我的回调函数不重叠？我的代码是用 javascript 编写的。

还有谁能给我指出一个关于异步调用的好且易于理解的文档？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T05:34:50.547

您的函数不会重叠，您只是不知道哪个函数首先获取结果。

您可以声明您的函数，以便它们接受循环计数器并在您调用它们时传递它，以便您知道在哪里写入函数的结果。

# iphone - 如何在 iPhone 上创建类似于 Excel 电子表格的界面？

> ID：661148
> 
> 赞同：3
> 
> 时间：2009-03-19T05:29:27.533
> 
> 标签：iphone, objective-c, user-interface, spreadsheet

我想开发一个iphone界面，使用objective-c，它的行为就像一个Excel工作表。

它将显示一个可以垂直和水平滚动的网格，但是在垂直滚动期间，第一行将冻结，而在水平滚动期间，第一列将冻结。

如何才能做到这一点？我是 iphone 开发的新手。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-19T06:15:18.517

我不熟悉 iPhone 的 UI 类，但从概念的角度来看，这是我要做的：

创建三个单独的滚动视图（rowLabels、colLabels 和网格），然后只要主网格视图向任何方向滚动，就简单地更新 rowLabels 的垂直滚动位置和 colLabels 的水平滚动位置。

# c# - 我怎样才能拥有一个实现接口并从抽象类继承的类？（C# .NET 3.5）

> ID：661152
> 
> 赞同：0
> 
> 时间：2009-03-19T05:31:44.160
> 
> 标签：c#, com, interface, abstract-class

我有一种情况，我认为我需要接口和抽象类提供的功能。

我正在创建要在模拟中使用的模型。每个模型都包含在一个 C# 类中，该类实现了一个 IModel 接口（我的设计，因此可以对其进行修改）。我还创建了一个 c++ 非托管 Win32 DLL，它充当我的 C# 模型类和仿真环境之间的桥梁。模型类通过 COM 调用，因此需要接口。

我刚刚收到一个新要求，即这些模型类应该可以通过独立于模拟环境的 Web 服务调用。现在这些模型相当敏感，客户端要求它们由客户端配置并在服务器上执行*。我认为如果我让模型类继承自抽象类，然后在服务器上创建一个 Web 服务方法，这将是可能的：

```
public AbstractModel executeModel(AbstractModel modelForExecution) 
```

它从客户端接收模型对象，执行它并用结果填充它。

但是 - 我不能使用抽象类，因为模型需要 COM 实现的接口。

我怎样才能调和这两个要求？有人告诉我，可以让一个类实现一个接口并让该类派生自一个抽象类，但我找不到任何例子。如果可能的话，语法是什么？如果不可能，我还能做什么？

*模型类实际上调用了一个古老的fortran可执行文件，因此类的模型配置不会泄露太多关于模型如何工作的信息。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-19T05:40:21.503

```
public abstract class Base{}
public interface IBase{}
public Something: Base, IBase{} 
// the interface needs to go after the base class 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T05:47:34.650

我会尝试让您的抽象类实现接口（并将方法作为抽象）。然后每个实现都只是抽象类的子类。我认为这应该有效。

```
public interface IModel {
  void doSomething();
}

public abstract class AbstractModel : IModel {
  public abstract void doSomething();
}

public class MyModel : AbstractModel {
  public void doSomething() {
    // code goes here
  }
} 
```

您可能必须在实现方法上使用“覆盖”关键字（编译器会告诉您）。

# php - 将 PHP 准备好的语句与 LIKE 结合起来

> ID：661160
> 
> 赞同：10
> 
> 时间：2009-03-19T05:35:24.993
> 
> 标签：php, sql-like

有人知道如何将 PHP 准备好的语句与 LIKE 结合起来吗？IE

`"SELECT * FROM table WHERE name LIKE %?%";`

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-03-19T05:55:29.470

% 符号需要放在您分配给参数的变量中，而不是在查询中。

我不知道您使用的是 mysqli 还是 PDO，但是使用 PDO 会是这样的：

```
$st = $db->prepare("SELECT * FROM table WHERE name LIKE ?");
$st->execute(array('%'.$test_string.'%')); 
```

对于`mysqli`用户如下。

```
$test_string = '%' . $test_string . '%';
$st->bind_param('s', $test_string);
$st->execute(); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-19T06:06:57.490

您可以使用各自 sql 数据库的连接运算符：

```
# oracle
SELECT * FROM table WHERE name LIKE '%' || :param || '%'
# mysql
SELECT * from table WHERE name LIKE CONCAT('%', :param, '%') 
```

我不熟悉其他数据库，但它们可能具有等效的功能/运算符。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-19T15:43:13.463

你可以尝试这样的事情：

```
"SELECT * FROM table WHERE name LIKE CONCAT(CONCAT('%',?),'%')" 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-01-30T22:11:57.000

在使用 MYSQLI 的 PHP 中，您需要定义一个新参数，该参数将被声明为：

```
$stmt = mysqli_prepare($con,"SELECT * FROM table WHERE name LIKE ?");
$newParameter='%'.$query.'%';
mysqli_stmt_bind_param($stmt, "s", $newParameter);
mysqli_stmt_execute($stmt); 
```

这对我有用..

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-12-15T15:16:31.840

对我来说工作得很好，我一直在寻找答案时间，谢谢。

```
 $dbPassword = "pass";
    $dbUserName = "dbusr";
    $dbServer = "localhost";
    $dbName = "mydb";

    $connection = new mysqli($dbServer, $dbUserName, $dbPassword, $dbName);

    if($connection->connect_errno)
    {
        exit("Database Connection Failed. Reason: ".$connection->connect_error);
    }
        $tempFirstName = "reuel";
    $sql = "SELECT first_name, last_name, pen_name FROM authors WHERE first_name LIKE CONCAT(CONCAT('%',?),'%')";
    //echo $sql;

    $stateObj = $connection->prepare($sql);
    $stateObj->bind_param("s",$tempFirstName);
    $stateObj->execute();
    $stateObj->bind_result($first,$last,$pen);
    $stateObj->store_result();

    if($stateObj->num_rows > 0) {
        while($stateObj->fetch()){
            echo "$first, $last \"$pen\"";
            echo '<br>';
        }
    }

    $stateObj->close();
    $connection->close(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-04-16T20:48:17.033

我将为像我这样习惯于使用`bindValue(...)`PDO 的人改编 Chad Birch 的答案：

```
$st = $db->prepare("SELECT * FROM table WHERE name LIKE :name");
$st->bindValue(':name','%'.$name.'%',PDO::PARAM_STR);
$st->execute(); 
```

# unix - 如何找到当前进程/可执行文件运行的路径？

> ID：661161
> 
> 赞同：5
> 
> 时间：2009-03-19T05:35:35.413
> 
> 标签：unix, path

我在连接到本地 unix 服务器时正在运行一些可执行文件。

说，我正在尝试运行一个可执行的“abc”。现在服务器可能已经为“abc”提供了一个别名。我如何知道这条路径？例如，如果我调用“abc”，它实际上可能会从 /opt/corp/xyz/abc 运行它。我如何才能知道我正在调用可执行文件的路径？

顺便说一句，我在 HP-UX 上运行：D

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-19T05:41:57.550

" `which abc`" 显示`abc`你要打电话给哪个

或“ `alias`”列出别名

也许从脚本内部“回显 $0”，或者以其他方式检索 argv[0]。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-19T05:47:02.220

如果您使用 PATH 环境变量运行，您可以尝试：

```
$哪个ABC
```

或者

```
$ 哪里是 abc
```

如果该命令有符号链接，并且您想知道*“真实”*目标，则可以使用以下内容：

```
$ readlink /opt/corp/xyz/abc

```

我现在无法访问我面前的 HPUX 系统，但这应该可以：

```
$ ls -l /opt/local/bin/wish
lrwxr-xr-x  1 root  admin  22 Feb  3 21:56 /opt/local/bin/wish@ -> /opt/local/bin/wish8.5
$ readlink /opt/local/bin/wish
/opt/local/bin/wish8.5 
```

如果命令基于别名，以下将显示别名定义。

```
$ 别名 abc

```

根据您的系统配置方式，上述命令应为您的问题的多种变体提供答案。

在 Perl 中：

```
$running_script = $0; 
```

来自 Python，请参阅[如何在 Python 中获取 __main__ 模块的文件名？](https://stackoverflow.com/questions/606561/how-to-get-filename-of-the-main-module-in-python)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-19T05:46:09.007

HP-UX 是否有“which”命令？跑：

```
which abc 
```

如果你有它，该`which`命令会告诉你哪个 abc 程序将从你的`$PATH`.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-19T05:54:36.973

谢谢大家！'which' 是我所追求的命令！因为我已经知道命令（在 Ubuntu 中），所以我现在正在面对自己。它确实像 HP-UX 中的魅力一样工作！

编辑：popcnt 建议的“whereis”更合适！非常感谢！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-19T05:47:35.917

从命令行终端：

$哪个ABC

/opt/corp/xyz/abc

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-19T09:03:30.267

在 Unix 上获取脚本路径的正确方法是：

```
dir=$(cd $(dirname "$0"); pwd) 
```

背景：$0 是脚本相对于当前目录的文件名+路径。它可以是绝对的 ( `/...`) 或相对的 ( `../`, `dir/...`)。所以`$(dirname "$0")`返回路径（没有文件名）。注意引号；"$0" 可以包含空格和其他奇怪的东西。

然后我们`cd`进入该目录`pwd`并将返回我们最终到达的绝对路径。

适用于`ksh`和`bash`。

在 C 程序中，您应该检查`argv[0]`. 我不确定外壳是否会将完整路径放在那里。如果您遇到问题，我建议将您的可执行文件包装在一个准备环境的小脚本中，然后使用以下命令调用您的可执行文件：

```
exec "$dir/"exe "$@" 
```

# asp.net - Visual Studio .net 2003 Web 组件问题上的 Asp.net

> ID：661165
> 
> 赞同：4
> 
> 时间：2009-03-19T05:38:30.697
> 
> 标签：asp.net, iis, frameworks, .net-1.1

我想在 VS 2003 上运行 ASP.NET，但它引发了一个错误，上面写着：

> “Visual Studio 检测到 Web 服务器正在运行 asp.net 1.0 版。您正在创建或打开的 Web 应用程序可以配置为与 asp.net 1.0 兼容。但是，该 Web 应用程序将无法使用新功能来自asp.net 1.1。”

当我选择“*使应用程序符合 asp.net 1.0* ”选项时，它无法设置合规性说

> “Visual Studio.NET 无法创建或打开应用程序。最可能的问题是本地 Web 服务器上未安装所需的组件。运行 Visual Studio.NET 安装程序并添加 Web 开发组件。”

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-19T06:11:04.830

您似乎**在 Vista 上运行 Visual Studio 2003**，这是不受支持的。

1.  **默认情况下，Vista 不包含 .NET Framework 1.1 SP1**。先安装它。确保安装了 SP1。如果您查看“ *c:\Windows\Microsoft.NET\Framework\v1.1.4322\mscorsvr.dll* ”的属性，您应该得到版本 1.1.4322.2032。
2.  **在控制面板 -> 程序和功能 -> 打开或关闭 Windows 功能中**启用 IIS 6 兼容性。**检查“ *Internet 信息服务*”下的“ *IIS 6 管理兼容性*”。**
****   **通过运行“ *c:\Windows\MIcrosoft.net\Framework\v1.1.4322\aspnet_regiis.exe -ir ”***向 IIS 注册 .NET 1.1**。它将在 IIS7 中使用经典管道创建针对 Framework 1.1 的应用程序池，并在 64 位操作系统上将 Enable32BitAppOnWin64 属性设置为 true。*****   **在 IIS7 中允许 ASP.NET 1.1。**打开 IIS 管理器并单击左侧树中的计算机名称。在主窗口中选择“ *ISAPI and CGI Restrictions* ”并确保启用了 ASP.NET v1.1.4322。如果没有，请选择它并单击右侧的允许链接。*   在运行 .NET 1.1 或更低版本的任何目录上创建应用程序时，请始终**选择面向 Framework 1.1 的应用程序池**。对于已配置的应用程序，您必须手动更改它。*****

 ****** * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T06:16:11.290

您可能需要在 IIS 中更新 ASP.NET 应用程序的脚本映射以使用*较新*版本的框架。我假设 .NET 1.1 框架和 VS 2003 已经安装，没有问题。

这是一篇[MSDN 文章](http://msdn.microsoft.com/en-us/library/1kdfe21k(VS.71).aspx)，应该解释如何使用 aspnet_regiis.exe 工具在 IIS 中注册 ASP.NET 应用程序以使用 .NET 1.1 版本。该工具的命令行参考可[在此处](http://msdn.microsoft.com/en-us/library/k6h9cz8h(vs.71).aspx)获得。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-09T02:06:43.473

> Visual Studio.NET 无法创建或打开应用程序。最可能的问题是本地 Web 服务器上未安装所需的组件。运行 Visual Studio.NET 安装程序并添加 Web 开发组件。

当我将项目文件夹从网络共享位置复制到本地系统时，我遇到了这个问题。

解决方案：在本地系统中创建一个空文件夹。将原始文件夹中的文件复制到新创建的空文件夹中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-04-21T22:13:57.900

除了接受的答案之外，您可能还需要添加包含在 Visual Studio 2003 安装文件中的实际“Web 开发”组件。

在菜单中，即使您安装了 ASP.NET v1.1 和相关的修补程序/安全更新，以及您的 IIS 版本的 FrontPage 扩展，您仍然可能在安装组件上看到一个红色的 X。

这可能看起来很hacky，但由于某种原因，安装程序似乎没有进行非常彻底的检查 - 只需单击“Red X”和“立即更新！” 图标变为可见，然后您可以安装该组件就好了。

**规格：** Windows 10、Visual Studio .NET 2003 企业版

**提示**：如果您正在运行更新版本的 IIS，您将无法“仅创建”一个 ASP.NET 1.1 应用程序池。您需要输入这些 appcmd.exe 命令：

```
appcmd create apppool /name:"YOURPOOLNAME"
appcmd set apppool /apppool.name:"YOURPOOLNAME" /enable32BitAppOnWin64:true
appcmd set apppool /apppool.name:"YOURPOOLNAME" /managedRuntimeVersion:"v1.1"
appcmd set apppool /apppool.name:"YOURPOOLNAME" /managedPipelineMode:"Classic"
appcmd set apppool /apppool.name:"YOURPOOLNAME" /autoStart:true 
```

# tomcat - 如何在tomcat中部署外部webapp？

> ID：661166
> 
> 赞同：17
> 
> 时间：2009-03-19T05:39:00.367
> 
> 标签：tomcat

请问有人可以回答我的问题吗？

我想部署一个 Web 应用程序文件夹

```
C:\app\myapp 
```

到Tomcat6.x而不是在下有一个副本

```
%TOMCAT_HOME%\webapps 
```

tomcat服务器需要什么配置？

谢谢

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-03-19T06:50:40.617

您应该为此应用程序创建一个`myapp.xml`文件并将其放在`%TOMCAT_HOME%\conf\Catalina\localhost`.

该文件看起来像这样：

```
<Context displayName="myapp" 
     docBase="C:/app/myapp"
     path="/myapp"
     reloadable="true" /> 
```

# directory - 安装程序不要求创建新目录？

> ID：661177
> 
> 赞同：0
> 
> 时间：2009-03-19T05:46:26.323
> 
> 标签：directory, installshield, exists

（对不起，不完全是一个编码问题）

假设我想在目录 C:\pony 中安装一些东西，但文件夹 'pony' 不存在，我怎样才能让 InstallShield 通知用户文件夹 'pony' 不存在并询问用户是否想要创建目录。

现在发生的是自动创建目录。

这仅仅是我正在使用的安装屏蔽（2008 Express）的限制吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T19:42:52.640

一些 InstallScript 代码会这样做：

```
if (ExistsDir(szPath) == NOTEXISTS) then
    if (AskYesNo("The directory does not exist. Would you like Setup to create it?", YES) == NO) then
        abort;
    else
        CreateDir(szPath);
    endif;
endif; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T16:27:30.953

我不知道这样做的内置方法。您可能需要编写一些自定义代码（InstallScript 或 MSI 自定义操作，具体取决于您使用的项目类型）来检查目录是否存在并提示用户。

# asp.net-mvc - ASP.NET MVC 与 Webforms

> ID：661181
> 
> 赞同：3
> 
> 时间：2009-03-19T05:48:41.450
> 
> 标签：asp.net-mvc

我有一个关于 MVC 的非常简单的问题。

它到底是什么，我为什么要注意它。我知道它不是 asp.net 的替代品，但在 ASP.NET 中有什么是我不能做的，因此需要 MVC 。

我知道 google.com 是找到一些答案的最佳方式，但我想如果这里非常了解这一点的人可以解释我，我将非常感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-19T05:56:45.783

我首先要说的是，MVC 旨在取代您所建议的 Webforms，这是一种常见的误解。ASP.NET MVC 只是[MVC 模式](http://en.wikipedia.org/wiki/Model-view-controller)的 ASP.NET 实现。我建议您查看[这篇文章](https://stackoverflow.com/questions/276211/asp-net-mvc-web-application-vs-asp-net-web-application)和[这篇文章](https://stackoverflow.com/questions/521388/from-webforms-to-asp-net-mvc/521426#521426)。就像你提到的，你不仅可以搜索谷歌，也可以在这里搜索。

您可以查看[ScottGu 的解释它的条目](http://weblogs.asp.net/scottgu/archive/2007/10/14/asp-net-mvc-framework.aspx)（发布于 2007 年）。
ASP.NET MVC 的 PM Phil Haack 在[他关于 MVC 的博客中也有信息](http://haacked.com/Tags/aspnetmvc/default.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-19T06:05:13.330

ASP.NET MVC 使用与 Web 表单不同的设计模式。MVC 旨在将不同的关注点分成不同的层。

ASP.NET MVC 为您提供了一些开箱即用的好东西，例如脚手架（基本上您为其提供数据源并为您生成基本表单）和 URL 重写。当然，您可以使用 webforms 执行此操作，但 MVC 为您开箱即用，这很好。

在 ASP.NET MVC 中，您可以更好地控制标记（或者至少可以更轻松地控制标记）。对于很多人来说，这是一个真正的好东西。也就是说，您也失去了一些使 ASP.NET 网络表单易于使用的东西，例如 ViewState。

另外，我想补充一点，您可以混合和匹配 webforms 和 MVC，所以这不是“全有或全无”的情况。

希望有帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-19T12:09:37.963

它将带您使用 MVC 进行简单的测试项目，以了解优缺点。阅读博客和文章虽然有用，但不会给您带来太多洞察力。自己看看吧，亲身体验一下。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-19T12:07:15.237

我想在之前的答案中添加的一件事是，如果您根本不想采用 MVC，则可以使用 MVP 模式使用 WebForms 来分离关注点。

这是 Phil Haack 的一篇不错的文章。

[http://haacked.com/archive/2006/08/09/ASP.NETSupervisingControllerModelViewPresenterFromSchematicToUnitTestsToCode.aspx](http://haacked.com/archive/2006/08/09/ASP.NETSupervisingControllerModelViewPresenterFromSchematicToUnitTestsToCode.aspx)

MVP 模式的好处在于，您可以将表示逻辑从 ASP.NET 切换到 Silverlight、WinForms 甚至 WPF。

# css - 如何过滤用户输入 css？

> ID：661185
> 
> 赞同：1
> 
> 时间：2009-03-19T05:51:23.910
> 
> 标签：css, security, filtering

在我的应用程序中，我允许用户上传他们的 css 样式表，以便他们可以应用于模板。css 写成内部样式表，因为此时我不想将 css 样式表暴露给其他用户。

这为用户在 css 文件中包含恶意代码创造了空间。最初我的计划是转换所有 '<' 和 '>'，但这在 css 语法中是必需的。我正在寻求白名单解决方案，因为彻底消除不需要的字符是不可行的。

对这种情况实施安全措施有什么建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-19T06:50:12.863

您绝对还应该至少过滤掉 IE 表达式和 FF -moz-binding 属性...两者都可用于使用 css 运行（可能是恶意的）javascript。

[这份备忘单](http://ha.ckers.org/xss.html)包含最明显的 XSS 策略，包括一些 CSS 策略。

最安全的解决方案可能是按照您的建议将其列入白名单（如果可以将用户限制为仅使用列入白名单的属性）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T06:35:55.317

我实现了一个过滤器，将所有`<`字符替换为`&lt;`. 原因是 CSS 不需要`<`字符；它唯一需要的字符`>`是用于子选择器的字符。

这样用户就无法打开标签来编写恶意代码。

我非常乐意考虑任何其他/更好的解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-20T00:50:52.163

不允许用户上传 CSS 文件，制作一个根据用户选择的选项动态生成 CSS 文件的界面。您允许的选项。然后你可以制作一个真实的 CSS 文件，或者你可以制作一个基于该配置编写 CSS 的动态应用程序，这样可以避免在服务器上有很多 CSS 文件……这是另一种方法，你不需要检查每一个可能的 XSS 漏洞，比解析 CSS 和拒绝一些危险代码更容易定义允许的内容。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-19T05:54:06.210

使用[CDATA](http://www.w3schools.com/XML/xml_cdata.asp)并转义终止序列 ( `]]>`)。不过，我不确定浏览器的兼容性。

示例（未经测试）：

```
<?PHP

function strReplaceAll($needle, $replacement, $haystack)
{
    // Check for infinite loop.  (NOT FOOL PROOF!)
    if(strpos($replacement, $needle) === FALSE)
        return;

    $numReplacements = 42;

    while($numReplacements)
    {
        $haystack = str_replace($needle, $replacement, $haystack, &$numReplacements);
    }

    return $haystack;
}

?>

<style type="text/css">
/*
<![CDATA[
*/

<?PHP echo sstrReplaceAll(']]>', '', $userCss); ?>

/*
]]>
*/
</style> 
```

# plugins - Adobe Acrobat 插件

> ID：661186
> 
> 赞同：0
> 
> 时间：2009-03-19T05:52:21.770
> 
> 标签：plugins, adobe, acrobat

我正在构建一个 Adob​​e Addin/plugin（.api 文件）并且面临两个问题 1）我有一个用图像注释 pdf 的 cusotm 工具。当您将鼠标悬停在该图像上时，我希望该图像显示带有该注释作者的工具提示。这是dobe吗

2）我正在设置书签。当您查看书签窗格中的书签时，如何控制书签标题的字体和颜色

非常感谢任何帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T20:51:34.990

1) 查看*Acrobat SDK*`AVDocSetSelection()`中的功能和*SelectionServer*示例插件

 *2) `/C`XX 中的键控制大纲（书签）项的颜色。它是一个由三个数字组成的数组 [范围 0.0 - 1.0]，表示用于大纲条目文本的 DeviceRGB 颜色。默认值：[0.0 0.0 0.0]

键控制项目`/F`是粗体还是普通样式。

您无法控制字体。

# java - Windows 上托管的 MySQL 和 Debian (Linux) 之间有什么区别？

> ID：661195
> 
> 赞同：0
> 
> 时间：2009-03-19T05:56:55.580
> 
> 标签：java, mysql, windows, database, linux

我正在将 MySQL 数据库从 Debian 迁移到 windows vista（使用 Apache 的本地主机 - 通过 EasyPHP 安装和运行）。

数据库本质上是一个副本，每个条目都是相同的，但是当我尝试访问数据库时，我得到了一些奇怪的错误（例如，在某些情况下，访问表的程序无法识别表中的前几个条目数据库）。

由于这两种情况下的数据库和代码是相同的（我正在使用 Java swing 应用程序来访问数据库），因此我得出结论，该问题可能与不同的操作系统环境有关。

两个各自操作系统之间的其他差异可能导致这些问题（甚至在数据库的复制过程中，我通过 NaviCat 中的“数据传输”功能完成）？

最后，我必须在 Java 代码中更改一个查询，该查询在表中输入了一个新条目，主键设置为“自动递增”，基本上在查询中，Java 应用程序发送它的主键为 NULL，并且MySQL 负责增量，在 Vista 托管数据库中，我收到一个错误，认为它是无效语法，所以我将 NULL 更改为 '0'，这与我的问题有什么关系吗？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T06:10:00.103

您可能需要查看数据库字符编码以确保它们匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-06T01:07:28.770

关于匹配数据库字符编码的观点很好理解。另请注意，默认情况下，Windows 安装使用 InnoDB 表，而 Ubuntu 安装使用 MyISAM 表。如果您尝试从一种切换到另一种，可能会出现各种问题，包括性能和设计问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-06T01:14:01.093

Windows 上的表名（至少使用 MyISAM）不区分大小写，而在 Unix/Linux 上则区分大小写

# java - 选择设计模式

> ID：661198
> 
> 赞同：0
> 
> 时间：2009-03-19T05:58:37.557
> 
> 标签：java, design-patterns

我需要设计一个类似于内部邮件系统的应用程序。然而，这只是一个课程项目。无需联网。教授只是让我们将讨论的数据结构付诸实践。但是，我一直无法决定如何设计应用程序。让我简要解释一下我必须做什么，然后我将分享我的想法。

如果让您知道这是一个基于命令行的应用程序，我认为这将是一个好主意。不涉及 GUI。

内部邮件系统由 5 种不同的可能状态组成。常规、管理员、用户、版主和撰写。一次可能只处于一种状态。应用程序启动时，默认进入General状态。在这种状态下唯一可能的命令是登录到其他帐户（用户、管理员、国防部）。用户具有基本命令，例如阅读他的消息、向其他用户发送（撰写）新消息、删除消息、注销、还有几个。用户可以更改为以下两种状态之一：撰写或常规。要进入 Compose 状态，用户必须使用命令`compose`。在这种状态下，您向其他用户撰写消息。完成编写消息后，您将返回用户状态。用户返回常规的唯一方法是注销。

Admin（继承了 User 的行为）和 Mod 几乎相同。他们也可以改变状态。

这是如何更改状态的摘要

```
General |----->Admin
        |   |---->User(limited)  
        |   |---->Compose
        |
        |----->Moderator  
        |  
        |----->User  
        |   |---->Compose 
```

我是设计模式的新手。我最近读了很多关于他们的书。但是，这将是我第一次实施它们。如果我的建议之一看起来很奇怪，请告诉我。

状态模式似乎是个好主意。我让我动态更改对象状态。但是，并非所有州都有相同的方法。管理员比用户有更多的方法。版主没有任何来自管理员或用户的方法。您只能使用 General 登录。我认为这将限制使用 State Pattern 的能力。你对其他模式有什么建议吗？

我的另一个想法是这样的。由于我可以上升和下降状态，我可以被视为一个堆栈。例如：处于撰写模式的用户。

```
\         /  
| Compose | <---- top (current state)  
|  User   |  
| General |  
----------- 
```

您对我如何实现它有任何想法吗？甚至可能吗？虽然我最喜欢 Java，但 C++ 或伪代码都很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T08:52:07.167

我认为您必须区分两个方面。

*User*、*Admin*和*Moderator*是**角色**，而*General*、*LogedIn*和*Compose*是**状态**。因此，我认为您应该将**状态**和**角色**设计模式结合在一起。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T07:46:42.073

这个很好的设计模式是[“角色对象模型”](http://hillside.net/plop/plop97/Proceedings/riehle.pdf)。它可以应用在以下环境中：

> *   您希望在不同的上下文中处理关键抽象，并且不想将生成的特定于上下文的接口放入同一个类接口中。
> *   您希望动态处理可用角色，以便可以在运行时按需附加和删除它们，而不是在编译时静态修复它们。
> *   您希望透明地处理扩展并需要保留生成的对象集团的逻辑对象身份。
> *   您希望保持角色/客户端对彼此独立，以便对角色的更改不会影响对该角色不感兴趣的客户端。

该模式使用了三个元素： 一个*组件*（这里：您的用户），它由一个*组件核心组成*，它本质上管理角色和提供角色特定能力的*组件角色。**Admin*、*User*、*Moderator*等是您上下文中的角色。

# delphi - 如何在 Delphi 中使用复选框？

> ID：661201
> 
> 赞同：5
> 
> 时间：2009-03-19T05:59:37.773
> 
> 标签：delphi, tcheckbox

现在，我有代码：

```
begin
If odd(GetAsyncKeyState(VK_snapshot)) then
If CheckBox1.Checked then
begin 
```

然后继续执行其余的代码。这是正确的做法，还是我做错了？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-19T06:14:02.497

您建议的是确定是否选中复选框的完全合法的方法。这样做的代码可能看起来像

```
if checkBox.Checked then begin
    //do whatever needed for checked checkbox
end 
```

或者像这样

```
if checkBox.Checked then begin
    //do whatever needed for checked checkbox
end else begin
    //do whatever needed for unchecked checkbox
end 
```

请记住，您从 Checked 属性获得的值对应于您获得该值时复选框的状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-30T15:54:37.303

```
if DT.FieldByName('name_of_checkbox').AsBoolean=True then begin ..... end;
// In this case dt is TADOquery that you had used in your program. 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-19T11:25:20.657

由于您使用的是 2 个 if 语句，因此您也可以将它们合并为一个：

```
if odd(GetAsyncKeyState(VK_snapshot)) and CheckBox1.Checked then
begin
  ...
  ...
end; 
```

if 语句的第二部分 (checkbox1.Checked) 仅在第一个评估为 True 时才被评估。（因为 Delphi 使用[短路评估](http://en.wikipedia.org/wiki/Short-circuit_evaluation)）

# javascript - 更好地使用 Javascript 重定向或表单提交？

> ID：661211
> 
> 赞同：1
> 
> 时间：2009-03-19T06:12:09.833
> 
> 标签：javascript, html, redirect, submit

我正在做一个选择框导航器，想知道是否最好进行 javascript 重定向或提交表单并从那里重定向。各有优劣？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T06:22:50.557

如果您的意思是通过选择列表项目进行导航，您可以同时执行以下操作：

*   使用 GET 配置表单，直接指向目标页面。
*   如果支持js，则在选择值时调用“提交”。如果不支持 js，应该显示一个选择/开始/打开按钮，允许用户仍然使用应用程序

**注意：**上面的方法直接进入目标页面。这与从服务器发送重定向不同，后者会导致处理额外的请求，增加操作的额外延迟和服务器处理的更多请求。这是一个导航场景，不需要为此进入服务器端（至少在没有其他特定要求的情况下不需要）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-19T12:54:21.163

HTTP 重定向：

*   优点：您可以记录用户的活动。
*   缺点：一个额外的周转周期，直到用户被有效重定向。

JavaScript 重定向：

*   优点：用户立即被重定向
*   缺点：您无法记录用户的活动，除非您使用 AJAX；如果用户禁用了 JavaScript，他将不会被重定向。

在这种情况下，我倾向于使用[Unobtrusive JavaScript](http://en.wikipedia.org/wiki/Unobtrusive_JavaScript)来解决这个问题：代码好像没有启用 JavaScript（即发布表单的“Go”按钮）；然后，在页面加载后，Javascript 将隐藏该按钮，将更改功能添加到选择框并发送 AJAX 请求以记录活动。

这样你就可以两全其美了:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T17:28:04.350

做这样的事情时要小心：

```
<select id="test" onchange="doAction();">
  <option value='http://...'>...</option>
  <option value='http://...'>...</option>
  <option value='http://...'>...</option>
  <option value='http://...'>...</option>
</select>

<script type="text/javascript">
function doACtion() {
    window.location = document.getElementById('test');
}
</script> 
```

这具有非常差的可访问性，因为 IE 用户尝试使用键盘导航选择会无意中触发该操作。这对于残障用户来说尤其麻烦，就像您尝试重定向他们一样，他们根本无法访问除第一个选项之外的任何内容。

# javascript - 为什么不推荐浏览器嗅探？

> ID：661213
> 
> 赞同：16
> 
> 时间：2009-03-19T06:13:27.287
> 
> 标签：javascript, browser, sniffing

你到处都能听到：使用 javascript 来嗅探用户代理字符串以检测浏览器版本是一件非常糟糕的事情。最新版本的 jQuery 现在已经弃用了它的`$.browser`对象来代替`$.support`. 但是，如果存在只影响 IE 而不会影响其他浏览器的错误或问题，我该怎么办，我不知道为什么？

在我的例子中，一些 jQuery 代码使工具提示出现和消失，并在鼠标悬停和鼠标移出时出现动画。在 Internet Explorer 中，它看起来很糟糕，而且很紧张，工具提示 div 在隐藏之前会变成一个非常大的尺寸，如果你用鼠标在一堆带有提示的项目上运行鼠标，它真的会杀死浏览器。我不知道 IE 不“支持”我应该测试的特定功能，因此只嗅探 IE 并使用不同的方法要容易得多。我可以/应该做什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-19T06:33:21.047

因为仅仅嗅探用户代理（这是 jquery 填充 $.browser 对象所做的）并不能告诉您全部真相。

*用户代理字符串可以在许多浏览器中轻松更改，因此，例如，如果您对似乎*正在使用 IE的每个人禁用某些在 IE 中不起作用的功能，您可能会意外禁用某些未来浏览器或刚刚使用 IE 的用户的这些功能，出于某种原因（例如，为了绕过基于浏览器嗅探的限制），*假装*使用 IE。

这似乎不是什么大问题，但它仍然是**不好的做法**。

是的，我也是一个 IE 嗅探器。我用

```
$.browser.msie && document.all 
```

只是要确定。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-19T07:30:11.910

首先要注意的是，用户代理嗅探不仅仅意味着查看`navigator.userAgent`，它是一个通用术语，用于描述人们用来根据他们认为浏览器是什么来改变行为的大量方法。

所以问题*不*在于查看用户代理字符串，问题在于根据您对浏览器的看法来决定您的站点应该做什么。这意味着您将来可能不可避免地限制或破坏您的网站；例如，我看过多个阻止 IE 的画布演示。他们没有检查是否支持画布，而是明确地寻找 IE，如果他们看到它，他们说 IE 坏了，这意味着即使 IE 最终支持画布，这些网站仍然无法工作。

而不是浏览器嗅探，您应该始终尝试检测您感兴趣的功能或错误。这些测试的最常见示例是“对象检测”，例如。`document.createElement("canvas").getContext`是应该如何检测画布的存在，并且将在任何浏览器中正确拾取画布，即使当前版本不支持它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-19T07:16:50.240

除了浏览器嗅探不如能力嗅探的问题外，将 navigator.userAgent 作为字符串处理本身就是一种非常不可靠的浏览器嗅探方式。

如果每个浏览器都坚持使用“名称/版本”来识别自己的方案，它可能会更好地工作，但事实并非如此。大多数浏览器都声称是“Mozilla/some.version”，不管它们是什么。开头的那一点是字符串中唯一易于解析的部分；其余的完全不标准化。因此脚本开始在整个字符串中搜索诸如“MSIE”之类的特征子字符串。这是一场灾难。

*   一些浏览器故意互相欺骗，包括诸如“MSIE”、“Gecko”和“Safari”之类的子字符串在它们的用户代理字符串中而不是那些浏览器，主要是为了击败考虑不周的字符串嗅探器。

*   一些浏览器允许在用户控制下欺骗整个用户代理字符串。

*   某些浏览器变体不是。例如，IE Mobile 与常规 IE 完全不同，但“MSIE”仍会匹配它。

*   一些浏览器允许附加组件向用户代理字符串写入额外的标记，包括任意文本。恶意插件只需更改一次注册表即可使 MSIE 看起来像 Firefox。

*   字符串匹配本质上是不可靠的。例如，一个名为“CLUMSIERbrowser”的新浏览器将匹配 MSIE。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-08-14T14:36:18.033

不建议这样做，因为浏览器会谎报自己的身份。见[http://farukat.es/journal/2011/02/499-lest-we-forget-or-how-i-learned-whats-so-bad-about-browser-sniffing](http://farukat.es/journal/2011/02/499-lest-we-forget-or-how-i-learned-whats-so-bad-about-browser-sniffing)（作者的一篇文章现代图书馆）。

此外，它本质上不是面向未来的。来自文章：

> 浏览器嗅探是一种技术，您可以在其中对一段代码将来如何工作做出假设。通常，这意味着假设特定的浏览器错误将始终存在 - 当浏览器进行更改和修复错误时，这经常导致代码中断。

推荐使用特征检测，因为它更简单，代码中的意图更清晰，并且完全避免了浏览器谎报身份的问题。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-01-19T14:26:14.010

我结合了从 HTML5 样板和 jquery 中学到的东西，因此使用 IE 条件注释来确定 IE 版本，然后测试这些类的存在。因此 HTML 会在顶部有这个：

```
<!--[if lt IE 7 ]> <html class="no-js ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]>    <html class="no-js ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]>    <html class="no-js ie8" lang="en"> <![endif]-->
<!--[if IE 9 ]>    <html class="no-js ie9" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--> <html class="no-js" lang="en"> <!--<![endif]--> 
```

然后我会继续在 jquery 中测试 .ie6、.ie7 等的存在，如下所示：

```
if($('.ie6, .ie7').length > 0){
    // your conditional stuff here
} 
```

对我来说效果很好。

注意：显然这仅测试 IE 版本，但大多数其他浏览器不会导致 IE 现在总是出现的问题，而且它比测试用户代理更安全！

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-19T06:19:16.090

因为如果你弄错了，你可能会不小心切断未来支持它们的浏览器的功能。

我经常觉得它很有用。我*知道*IE6 不支持 alpha 透明度，所以我使用浏览器嗅探来检测 IE6 并隐藏/更改使用它们的元素。

此外，为了多次快速运行鼠标，请尝试[HoverIntent](http://cherne.net/brian/resources/jquery.hoverIntent.html)。它用户 setTimeout() 我相信只有当鼠标在一个元素上短暂停留时才会触发事件，从而节省周期并避免事件排队并可能冻结浏览器。

就个人而言，我更喜欢带有浏览器版本/类型方法的 jQuery。它可用于显示基于浏览器的友好问候消息。也许 jQuery 弃用它是因为“浏览器嗅探是邪恶的”的压力。

## 更新

这就是 John Resig（jQuery 的创建者）所说的：

> 在可预见的未来，我们会保留 jQuery.browser，但我们希望开发人员不再使用它——让开发人员这样做的最好方法是成为正确开发模式的好例子。
> 
> 需要明确的是：$.support 中包含的要点主要是特定于浏览器的错误（无法使用普通对象检测进行测试的 IE 错误）-它们并不包含所有可能的错误（大约只有十几个）。预计其他开发人员将来会添加自己的测试点。
> 
> 此外，在那次提交中，我忘记登陆实际的 support.js 文件 - 它可以在这里找到： [http ://dev.jquery.com/browser/trunk/jquery/src/support.js?rev=5986](http://dev.jquery.com/browser/trunk/jquery/src/support.js?rev=5986)

来源：[http ://www.reddit.com/r/programming/comments/7l2mr/jquery_removes_all_browser_sniffing/](http://www.reddit.com/r/programming/comments/7l2mr/jquery_removes_all_browser_sniffing/)

另见：[http ://dev.jquery.com/changeset/5985](http://dev.jquery.com/changeset/5985)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-11-12T20:12:46.293

嗅探功能，而不是用户代理。伪代码：

```
if (browser.supports('feature')){
    //execute feature
}

else{
    //fallback
} 
```

# accessibility - 为有特殊需要的人发展

> ID：661214
> 
> 赞同：4
> 
> 时间：2009-03-19T06:13:43.403
> 
> 标签：accessibility

这是我在这里的第一篇文章。

我必须为一群有特殊需要的人开发一个应用程序。该功能确实微不足道，但是，我不知道如何为他们提供界面才能使用它。

他们的智力是完美的，他们实际上是在读高中，但是其中一种用鼻子打字，不用说，非常困难，另一种只能用一根手指慢慢地打字，也不能使用鼠标。

我想知道我是否可以使用 javascript 来开发一个可用的界面，基于巨大的网格或类似的东西，或者也许你们有更好的主意。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T06:37:11.427

除了政治不正确，你为什么不问他们？您在这里谈论的是**[可访问性](http://en.wikipedia.org/wiki/Accessibility#Telecommunications_and_IT_access)**，如果他们使用计算机，他们必须能够告诉您他们喜欢或不喜欢他们遇到的用户界面。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-01-07T23:19:54.333

我将把我的答案分成两部分——设计和实现。

从设计的角度来看，重要的是不要被用户以不同方式使用计算机的事实吓倒。像对待任何其他项目一样对待它。观察他们目前如何使用其他应用程序，并询问他们认为有帮助或有困难的事情。如果他们声称没有什么是困难的，请询问老师或助手，他们会熟悉他们所遇到的事情。

开始实施后，尝试一个想法并获得初步反馈。如果你只是问他们是如何找到原型的，他们可能会说没关系。相反，试着观察他们使用它而不说什么或提供指导。如果他们遇到困难，让他们自己找到解决问题的方法。如果合适，您可以要求用户大声说出他们的想法（例如“我需要保存此表单，所以我滚动到底部，然后单击保存”）。

在开发方面，尝试使用 Web 标准（有效的 HTML、CSS 和 Javascript）。人们经常提到“Web Content Accessibility Guidelines 2.0”（WCAG2），但这非常冗长且难以理解；还有很多关于“Web Accessibility”的友好文章。

身体残疾的人可能会使用替代输入设备，例如“开关”、屏幕键盘、头部跟踪设备、键盘上的按键设备或语音识别。其中许多方法都涉及模拟键盘，因此到目前为止，最重要的是考虑您的网站在不使用鼠标的情况下的可访问性。例如，尝试在页面中切换，看看您是否可以在合理的时间内访问所有元素。考虑使用 acesskey 属性来提供一种简单的方法来跳转到页面的不同部分（通常建议使用 0 到 9，这样您就不会干扰浏览器快捷方式）。

还要确保您网站的任何部分都不是时间依赖的，因为不同的用户可能需要不同的时间来执行任务。例如，不要使用 onchange Javascript 事件来更新基于列表框选择的页面。确保您有图像的替代文本，以便语音识别可以访问。使页面足够短，这样就不需要过度滚动，但又不要短到需要跟踪大量链接。

这些只是让您的思想朝着正确方向发展的一些想法 - 但互联网上有许多可访问性资源 - 自由窃取，不要重新发明轮子。

我意识到我没有解决你关于 Javascript 的问题——那是因为我认为这可能是不太重要的考虑因素之一。如果可能，使用渐进增强技术使网站在使用和不使用 Javascript 的情况下都能正常工作。您还可以查看 WAI-Aria 标准，为您的 Javascript 提供语义。

最后，重申我最初的观点——做一些简单的事情，向用户展示，tweek，然后再次展示。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T06:36:03.787

你使用什么技术并不重要。使用适合您的套件。

但是，确保你的 UI 组件尺寸大（更大的按钮、更大的字体、粗体字体、彩色字体（有色盲吗？）。这是为了方便人们使用（你说有人用鼻子打字） .

此外，每当对应用程序执行某些错误操作时，最好将音频作为信息源以及通常的屏幕显示。这样视障人士将得到更多帮助。

做得好，你正在做一项神圣的工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-19T06:42:43.507

您应该阅读的第一件事是W3C 编写的[Web 内容可访问性指南。](http://www.w3.org/TR/WAI-WEBCONTENT/)

简而言之，本文档描述了一般残疾人的基本原则。

对于有特殊需要的人，您可能需要查看[Jakob Nielsen 关于儿童网站可用性的文章](http://www.useit.com/alertbox/children.html)，其中概述了针对幼儿或认知能力有限的人的网页设计原则。

# mediawiki - 更改 mediawiki 命名空间？

> ID：661216
> 
> 赞同：2
> 
> 时间：2009-03-19T06:14:20.640
> 
> 标签：mediawiki

有没有办法重新分配或更改 mediawiki 的核心命名空间？例如，我在链接到我想称为“模板”的页面时遇到困难，因为 mediawiki 已经有一个用于模板的命名空间。我想将 mediawiki“模板”命名空间重新分配给其他东西。

有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-10-30T02:55:42.540

您可以部分更改名称，在localsettings.php下，使用模板的代码号添加额外的命名空间，例如将main添加为0，main：Main Page将重定向到Main Page

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-19T13:21:15.560

基本上，没有。

您可以在 Special:AllMessages 中更改命名空间的显示名称，并且可以使用[$wgNamespaceAliases](http://www.mediawiki.org/wiki/Manual:$wgNamespaceAliases)为命名空间创建别名，但我认为您实际上无法更改底层名称。

例如，要转到德语维基百科上 Stack Overflow 的讨论页，您可以使用[http://de.wikipedia.org/wiki/Talk:Stack_Overflow](http://de.wikipedia.org/wiki/Talk:Stack_Overflow)或[http://de.wikipedia.org/wiki/Diskussion:Stack_Overflow](http://de.wikipedia.org/wiki/Diskussion:Stack_Overflow)他们都带你到同一个地方。

但是：英文维基百科有一个名为[Template](http://en.wikipedia.org/wiki/Template)的页面，我刚刚通过在我的 wiki 上创建一个名为 Template 的页面进行测试，没有任何问题。所以也许它不是模板命名空间干扰。当我在我的[维基百科用户页面](http://en.wikipedia.org/w/index.php?title=User:AdrianArcher&oldid=278322890)上使用 [[Template]] 链接到模板时，它链接到文章模板，而不是名称空间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-05-07T15:38:28.533

我强烈建议不要更改任何标准命名空间的名称。像“模板”这样的名称非常通用，您肯定可以找到其他名称。例如，如果您想存储 C++ 模板的代码，请调用命名空间“Cpp_template”或“template_code”。

mediawiki 中没有任何内容可以阻止您在名称中仅使用冒号作为前缀，从而为您提供与“支持”命名空间完全相同的语法。我经常这样用。如果区分这些命名空间变得有帮助，例如搜索，那么是的，您可以通过编辑 LocalSettings.php 来支持它们（获得正确的大写字母，这在英语、Linux shell 和 mediawiki 中很重要）。

例如，如果我想将一个术语标记为可能存在问题或有偏见，我会使用“术语：”前缀，例如“术语：Make_America_Great_Again”或“术语：MAGA”，这意味着与其支持者声称的完全相反。如果我想标记用户界面中使用的动词短语，它是“verb:delete”等。对于其中的大多数，实际上不需要“支持”命名空间。

您应该为您的任务和目的无情地自定义名称空间和（甚至更多）类别。如果您从其他 wiki 复制类别，您可能做错了。如果您至少没有以我建议的非正式方式创建任何自定义命名空间，那么您可能又做错了。

但是重命名标准命名空间或页面是个坏主意。您可以将重定向用于某些相同目的。例如，一些“特殊”页面具有不符合维基百科或英语语言约定的令人困惑且语义不恰当的名称。所以我总是用一个像“open_links_in_this_wiki”这样的新名称重定向诸如“Special:Wantedpages”之类的东西，这在语义上是准确的，并且不会告诉人们只是去创建带有垃圾的“想要”页面，而不是等待弄清楚名称是否是适当的或收敛的。

作为一般规则，如果您不能在英语句子中轻松使用该名称并且 [[只需将括号括起来]]，则需要重定向或重命名。

# delphi - Delphi 2009 SOAP 请求不使用 Windows Vista 传输用户名

> ID：661223
> 
> 赞同：2
> 
> 时间：2009-03-19T06:18:04.953
> 
> 标签：delphi, soap, windows-vista, delphi-2009, vista64

[我们实现了一个使用 Mantis Bugtracker ( http://mantisbt.sf.net/](http://mantisbt.sf.net/) )的 SOAP 接口的小应用程序。Mantis 安装在需要 HTTP 身份验证的 SSL 网络服务器上。

它在 Windows XP 中完美运行，但在 64 位 Vista 上却无法正常运行，因为“访问被拒绝”而失败。查看服务器的访问日志，我可以看到它得到错误 401 未经授权，并且似乎没有用户名被传输到网络服务器。

换句话说，SOAP 请求似乎不包括用户名，如果它在 Windows Vista 64 位上运行，而在 Windows XP 上，一切正常。

有人知道这可能是什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T12:37:59.983

这里的信息太少，无法说明任何事情，但我会冒险进行有根据的猜测——这是一个许可问题。获取本地用户名时，您正在执行需要管理员访问权限的操作 - 在 Vista 下，您默认以受限用户身份运行。

尝试通过右键单击该应用程序并选择以管理员身份运行来运行该应用程序。如果它有效，那么你已经证实了这种怀疑。

您究竟如何查询要通过网络发送的凭据？

编辑：没关系，这完全是一个不同的问题:)

# flash - Flash 透明背景在 Mac 上不起作用

> ID：661230
> 
> 赞同：1
> 
> 时间：2009-03-19T06:24:12.987
> 
> 标签：flash, macos, firefox, safari, transparency

嗨，我似乎无法在 Mac 上让背景透明，请参见此处：[http ://www.digiflipconcepts.com/smokinhot/templates/smokinhot/](http://www.digiflipconcepts.com/smokinhot/templates/smokinhot/)

我正在使用 wmode=transparent。我一直在搜索谷歌，发现 wmode 不是很稳定，如果我使用“嵌入”标签，它会起作用，但它不再是有效代码。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T13:07:53.110

看到您的背景位置是静态的，您可以跳过透明背景，只需在 Flash 中添加图像的那部分。您需要使用一些其他技巧才能在浏览器中准确定位，但它会更好地工作并提高性能。

# objective-c - objective-c 类变量：何时调用 dealloc？

> ID：661233
> 
> 赞同：7
> 
> 时间：2009-03-19T06:28:05.083
> 
> 标签：objective-c, class, variables, static

如果我在Objective-C中声明类变量，内存什么时候释放？

如果我的界面是：

```
@interface TestClass : NSObject
{
}

+ (NSString)instanceCount;

@end 
```

在实施中，我声明：

```
static NSString instanceCount; 
```

如何释放这个类级别变量？即何时在Objective-C 中为类变量调用dealloc？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-19T06:52:31.423

您的问题的简短回答是：“程序退出时”。

静态变量是在程序的最开始，`main()`函数开始之前分配的。同样，它们将在您的程序结束时，即`main()`退出后不久发布。此内存管理由 Objective-C 运行时处理，这一切都发生在幕后。

如果您试图监控这种行为，您可能不会有太多运气。例如，如果您在自定义类中执行以下操作，然后将该类用作另一个类的静态成员：

```
- (void)dealloc
{
    NSLog(@"I am being deallocated");
    [super dealloc];
} 
```

您永远不会在日志中看到此消息。这有几个原因。一，`NSLog()`需要的变量可能已经作为正常关闭过程的一部分被释放。第二，因为运行时系统可以简单地一次性释放所有剩余内存，而无需费心调用`dealloc`方法。

如果您的自定义类在其`dealloc`方法中做了一些重要的事情，这可能会出现问题。如果是这种情况，请考虑编写一个自定义`cleanup`方法，在程序退出之前为这些对象调用该方法。

# c# - 使用 DSL 生成 C# 代码

> ID：661237
> 
> 赞同：6
> 
> 时间：2009-03-19T06:32:42.670
> 
> 标签：c#, .net, code-generation, dsl

目前我正在使用的项目没有完全固定的模型（由于外部影响），因此我希望在编写它们时有一些灵活性。目前，它们在应用程序的三个不同层（db、web api 和客户端）中复制，并且每个层都有相似的逻辑（即验证）。

我想知道是否有一种方法可以让我编写模型文件（比如在 ruby​​ 中），然后让它将该模型转换为必要的 c# 文件。目前，我似乎只是在编写许多可能在任何阶段发生变化的样板代码，而这种生成的方法将使我能够专注于更重要的事情。

有没有人推荐这样的东西，我可以用的 dsl/语言，有没有人有这样的经验？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-19T07:20:06.987

我见过一个使用部分类和部分方法来允许重新生成代码而不影响自定义代码的系统。如果您愿意，“规则引擎”完全是从 Visio 状态图生成的。这基本上是糟糕的工作流程，但很容易修改。Viso 图表导出为 XML，使用 powershell 和 T4 读取 XML 以生成类。

上面的例子是一个外部 DSL。IE 在运行应用程序的编程语言之外。另一方面，您可以创建一个内部 DSL，该 DSL 在编程语言中实现和使用。

这篇和 Code-Magazine 上[一篇关于 DSLS](http://code-magazine.com/Article.aspx?quickid=0903061)的文章都非常好。

在上面的链接中，Neal Ford 向您展示了如何使用流利的接口在 C# 中创建内部 DSL。

他还没有提到的一件事是你可以把这个属性 [EditorBrowsable(EditorBrowsableState.Never)] 放在你的方法上，这样它们就不会被智能感知。这意味着您可以对 DSL 的用户隐藏类上的非 DSL（如果您愿意的话）方法，从而使 fluent API 更容易被发现。

[您可以在Daniel Cazzulino](http://www.viddler.com/explore/dcazzulino/)编写的关于使用 TDD 编写 IoC 容器的视频系列中看到流畅的界面正在实时编写

关于外部 DSL，您还可以选择[Oslo（目前是 CTP）](http://www.microsoft.com/downloadS/details.aspx?familyid=F2F4544C-626C-44A3-8866-B2A9FE078956&displaylang=en)，它非常强大，可以让您创建可以直接执行的外部 DSL，而不是使用想到的代码生成它根本不是一个 DSL。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-20T22:04:28.110

这可以通过[ANTLR](http://antlr.org/)轻松完成。如果输出足够相似，您可以简单地使用文本模板机制——否则它可以生成一个抽象语法树供您遍历。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-20T21:51:55.363

我认为你在正确的轨道上。

在这种情况下，我通常做的是设计一种简单的语言来满足我的需求，并为它编写一个 LL1（递归下降）解析器。

如果该语言必须包含非平凡的 C# 语法，我可以引用它，或者将其包裹在我可以识别的括号中，然后将其传递给输出代码。

我可以让它生成一个解析树结构，然后从中生成 3 种不同类型的代码，或者我可以让它动态生成代码，或者使用具有 3 个值的模式变量，或者只是同时将代码写入 3不同的输出文件。

有不止一种方法可以做到这一点。如果您害怕编写解析器（就像某些程序员一样），那么在 SO 的其他地方有很多帮助。

# c# - 函数的“静态新”修饰符有什么意义？

> ID：661246
> 
> 赞同：32
> 
> 时间：2009-03-19T06:38:26.120
> 
> 标签：c#, static, new-operator, modifier

今天，我在遗留代码中发现了一些东西。它具有一项功能的“静态新”。它看起来像这样。

```
class Foo
{
    public static void Do()
    {
        Console.WriteLine("Foo.Do");
    }
}

class Bar: Foo
{
    public static new void Do()
    {
        Console.WriteLine("Bar.Do");
    }
} 
```

我不理解类**Bar中****Do方法的*****静态 new***修饰符。在 C# 中，静态方法只能使用类名而不是对象名来调用。所以，我认为拥有“新”和没有“新”之间没有任何区别。

 ****通常，如果某些语法是不必要的，C# 只是将其视为错误。有人知道为什么 C# 允许这样的语法吗？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-03-19T06:51:05.233

如果你从你的代码中删除**新的，你会得到：**

> 警告 CS0108：“Bar.Do()”隐藏了继承的成员“Foo.Do()”。如果打算隐藏，请使用 new 关键字。

C# 编译器只是警告您您可能正在做一些您不打算做的事情，并要求您插入**新**关键字以确认您知道自己在做什么。除了抑制警告之外，它没有其他效果。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-19T06:57:22.330

这仅适用于外部呼叫者。请记住，您可以调用基类的静态方法，所以这样的事情是有效的：

```
class Foo
{
    public static void Do() { Console.WriteLine("Foo.Do"); }
}
class Bar : Foo // :Foo added
{
    public static void Something()
    {
        Do();
    }
} 
```

这就是警告告诉您放置新的原因，您希望在执行此操作时避免任何混淆：

```
class Foo
{
    public static void Do() { Console.WriteLine("Foo.Do"); }
}
class Bar : Foo // :Foo added
{
    public static void Something()
    {
        Do();
    }
    public static new void Do() { Console.WriteLine("Bar.Do"); }
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-19T06:43:53.830

看看[这个](http://msdn.microsoft.com/en-us/library/435f1dw2.aspx)

> ```
> public class BaseC
> {
>     public static int x = 55;
>     public static int y = 22;
> }
> 
> public class DerivedC : BaseC
> {
>     // Hide field 'x'.
>     new public static int x = 100;
> 
>     static void Main()
>     {
>         // Display the new value of x:
>         Console.WriteLine(x);
> 
>         // Display the hidden value of x:
>         Console.WriteLine(BaseC.x);
> 
>         // Display the unhidden member y:
>         Console.WriteLine(y);
>     }
> }
> /*
> Output:
> 100
> 55
> 22
> */ 
> ```

为了清楚起见，您的示例应该是

```
public class Foo
{
    public static void Do() {}
}
public class Bar :Foo
{
    public new static void Do() {}
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-19T06:54:42.417

在您的示例中，第二个类 Bar 似乎没有从 Foo 继承。这似乎是一个错字，因为否则它没有意义。

假设它是一个错字，“new”修饰符显式隐藏了函数的基类版本`Do()`。这意味着该`Do()`方法的派生版本有效地替换了基类版本。

此处使用“new”记录了继承方法旨在替代`Do()`.

有关详细信息，请参阅[新修饰符 (C#)](http://msdn.microsoft.com/en-us/library/435f1dw2(VS.80).aspx)

# xna - 什么是最好的 XNA 博客？

> ID：661249
> 
> 赞同：6
> 
> 时间：2009-03-19T06:40:38.033
> 
> 标签：xna, blogs

我知道很好的通用编程博客（比如编码恐怖；））。但我想要非常好的特定 XNA 博客。建议？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-26T22:13:20.147

[Shawn Hargreaves](http://blogs.msdn.com/shawnhar/)和[Nick Gravelyn](http://nickgravelyn.com/)是我在寻找有关 XNA 的信息时经常遇到的两个名字。

它不像一个博客，但[Ziggyware](http://www.ziggyware.com/news.php)也有很多很棒的信息。

您还可以在[XNA 论坛](http://forums.xna.com/forums/)和[GameDev.net 论坛](http://www.gamedev.net/community/forums/forum.asp?forum_id=10)上找到有用的信息。

哦，另外，我喜欢阅读[Gamasutra](http://www.gamasutra.com/)，其中有来自 XNA 开发人员的文章。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-19T13:50:46.893

我真的很喜欢[Shawn Hargreaves](http://blogs.msdn.com/shawnhar)的博客。他有很多代码示例，并展示了很多帮助开发的最佳实践和技巧。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-19T13:41:57.273

您可以从 www.creatorsclubonline.com 开始，他们有大量指向 XNA 特定博客的链接列表。（不确定您是在看初级博客还是高级博客）

同时这里有一些...

[http://blogs.msdn.com/etayrien/](http://blogs.msdn.com/etayrien/)

[http://www.xnatutorial.com/](http://www.xnatutorial.com/)

[http://www.xnadevelopment.com/tutorials.shtml](http://www.xnadevelopment.com/tutorials.shtml)

[http://www.xnatutorial.com/](http://www.xnatutorial.com/)

[http://www.phstudios.com/?q=node/16](http://www.phstudios.com/?q=node/16)

最好的

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-17T14:12:34.350

这取决于您对博客的期望。如果您正在寻找知识和技术，您会很高兴不花一些时间在[Riemer 的](http://www.riemers.net/)教程上！

# delphi - 如何在 Delphi 中截取活动窗口的屏幕截图？

> ID：661250
> 
> 赞同：11
> 
> 时间：2009-03-19T06:42:14.193
> 
> 标签：delphi, window, screenshot

对于完整的屏幕截图，我使用以下代码：

```
form1.Hide;
sleep(500);
bmp := TBitmap.Create;
bmp.Height := Screen.Height;
bmp.Width := Screen.Width;
DCDesk := GetWindowDC(GetDesktopWindow);
BitBlt(bmp.Canvas.Handle, 0, 0, Screen.Width, Screen.Height, DCDesk, 0, 0, SRCCOPY);
form1.Show ;
FileName := 'Screenshot_'+FormatDateTime('mm-dd-yyyy-hhnnss',now());
bmp.SaveToFile(Format('C:\Screenshots\%s.bmp', [FileName]));
ReleaseDC(GetDesktopWindow, DCDesk);
bmp.Free; 
```

如何将其转换为仅截取活动窗口的屏幕截图。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-19T07:27:22.073

1.  首先，您必须获得正确的窗口。正如尖牙已经指出的那样，您应该使用`GetForegroundWindow`而不是`GetDesktopWindow`. 你已经在你的[改进版本](http://pastebin.com/m2e334a4a)中做到了。
2.  但是您必须将位图的大小调整为 DC/Window 的实际大小。你还没有这样做。
3.  然后确保你没有捕获一些全屏窗口！

当我执行你的代码时，我的 Delphi IDE 被捕获，并且默认情况下它是全屏的，它产生了全屏截图的错觉。（即使您的代码大部分是正确的）

考虑到上述步骤，我成功地使用您的代码创建了单窗口屏幕截图。

只是一个提示：如果你只对客户区感兴趣，你可以`GetDC`代替。`GetWindowDC`（无窗口边框）

**编辑：**这是我用你的代码所做的：

**你不应该使用这个代码！看看下面的改进版本。**

```
procedure TForm1.Button1Click(Sender: TObject);
const
  FullWindow = True; // Set to false if you only want the client area.
var
  hWin: HWND;
  dc: HDC;
  bmp: TBitmap;
  FileName: string;
  r: TRect;
  w: Integer;
  h: Integer;
begin
  form1.Hide;
  sleep(500);
  hWin := GetForegroundWindow;

  if FullWindow then
  begin
    GetWindowRect(hWin,r);
    dc := GetWindowDC(hWin) ;
  end else
  begin
    Windows.GetClientRect(hWin, r);
    dc := GetDC(hWin) ;
  end;

  w := r.Right - r.Left;
  h := r.Bottom - r.Top;

  bmp := TBitmap.Create;
  bmp.Height := h;
  bmp.Width := w;
  BitBlt(bmp.Canvas.Handle, 0, 0, w, h, DC, 0, 0, SRCCOPY);
  form1.Show ;
  FileName := 'Screenshot_'+FormatDateTime('mm-dd-yyyy-hhnnss',now());
  bmp.SaveToFile(Format('C:\Screenshots\%s.bmp', [FileName]));
  ReleaseDC(hwin, DC);
  bmp.Free;
end; 
```

**编辑 2：**根据要求，我正在添加更好的代码版本，但我保留旧版本作为参考。您应该认真考虑使用它而不是您的原始代码。如果出现错误，它会表现得更好。（资源已清理，您的表单将再次可见，...）

```
procedure TForm1.Button1Click(Sender: TObject);
const
  FullWindow = True; // Set to false if you only want the client area.
var
  Win: HWND;
  DC: HDC;
  Bmp: TBitmap;
  FileName: string;
  WinRect: TRect;
  Width: Integer;
  Height: Integer;
begin
  Form1.Hide;
  try
    Application.ProcessMessages; // Was Sleep(500);
    Win := GetForegroundWindow;

    if FullWindow then
    begin
      GetWindowRect(Win, WinRect);
      DC := GetWindowDC(Win);
    end else
    begin
      Windows.GetClientRect(Win, WinRect);
      DC := GetDC(Win);
    end;
    try
      Width := WinRect.Right - WinRect.Left;
      Height := WinRect.Bottom - WinRect.Top;

      Bmp := TBitmap.Create;
      try
        Bmp.Height := Height;
        Bmp.Width := Width;
        BitBlt(Bmp.Canvas.Handle, 0, 0, Width, Height, DC, 0, 0, SRCCOPY);
        FileName := 'Screenshot_' + 
          FormatDateTime('mm-dd-yyyy-hhnnss', Now());
        Bmp.SaveToFile(Format('C:\Screenshots\%s.bmp', [FileName]));
      finally
        Bmp.Free;
      end;
    finally
      ReleaseDC(Win, DC);
    end;
  finally
    Form1.Show;
  end;
end; 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-03-19T08:41:08.370

您的代码可能会简单得多。当您决定要保存哪种表单时，请尝试我使用的代码：

```
procedure SaveFormBitmapToBMPFile( AForm : TCustomForm; AFileName : string = '' );
// Copies this form's bitmap to the specified file
var
  Bitmap: TBitMap;
begin
  Bitmap := AForm.GetFormImage;
  try
    Bitmap.SaveToFile( AFileName );
  finally
    Bitmap.Free;
  end;
end; 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-31T19:01:41.173

这结合了迄今为止描述的所有方法。它还处理多显示器场景。

传入您想要的屏幕截图类型和 TJpegImage，它会将您请求的屏幕截图分配给该图像。

```
///////////
uses
  Jpeg;

type  //define an ENUM to describe the possible screenshot types.
  TScreenShotType = (sstActiveWindow, sstActiveClientArea,
    sstPrimaryMonitor, sstDesktop);
///////////

procedure TfrmMain.GetScreenShot(shotType: TScreenShotType;
  var img: TJpegImage);
var
  w,h: integer;
  DC: HDC;
  hWin: Cardinal;
  r: TRect;
  tmpBmp: TBitmap;
begin
  hWin := 0;
  case shotType of
    sstActiveWindow:
      begin
        //only the active window
        hWin := GetForegroundWindow;
        dc := GetWindowDC(hWin);
        GetWindowRect(hWin,r);
        w := r.Right - r.Left;
        h := r.Bottom - r.Top;
      end;  //sstActiveWindow
    sstActiveClientArea:
      begin
        //only the active client area (active window minus title bars)
        hWin := GetForegroundWindow;
        dc := GetDC(hWin);
        GetWindowRect(hWin,r);
        w := r.Right - r.Left;
        h := r.Bottom - r.Top;
      end;  //sstActiveClientArea
    sstPrimaryMonitor:
      begin
        //only the primary monitor.  If 1 monitor, same as sstDesktop.
        hWin := GetDesktopWindow;
        dc := GetDC(hWin);
        w := GetDeviceCaps(DC,HORZRES);
        h := GetDeviceCaps(DC,VERTRES);
      end;  //sstPrimaryMonitor
    sstDesktop:
      begin
        //ENTIRE desktop (all monitors)
        dc := GetDC(GetDesktopWindow);
        w := Screen.DesktopWidth;
        h := Screen.DesktopHeight;
      end;  //sstDesktop
    else begin
      Exit;
    end;  //case else
  end;  //case

  //convert to jpg
  tmpBmp := TBitmap.Create;
  try
    tmpBmp.Width := w;
    tmpBmp.Height := h;
    BitBlt(tmpBmp.Canvas.Handle,0,0,tmpBmp.Width,
      tmpBmp.Height,DC,0,0,SRCCOPY);
    img.Assign(tmpBmp);
  finally
    ReleaseDC(hWin,DC);
    FreeAndNil(tmpBmp);
  end;  //try-finally
end; 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-19T20:30:03.523

[JCL](http://sourceforge.net/projects/jcl/)再次出手相救。。

```
 hwnd := GetForegroundWindow;
    Windows.GetClientRect(hwnd, r);
    JclGraphics.ScreenShot(theBitmap, 0, 0, r.Right - r.Left, r.Bottom - r.Top, hwnd);

    // use theBitmap... 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-31T18:43:41.513

这里没有人发布一个好的答案。迄今为止提出的解决方案是在目标窗口的位置进行“裁剪”的屏幕截图。如果那个窗口在另一个窗口后面并且当前没有被操作系统渲染怎么办？这就是为什么您需要使用Windows XP 中引入的[这个功能。](http://msdn.microsoft.com/en-us/library/dd162869.aspx "这")

在快速谷歌之后，这里有一些示例代码：[http ://delphi.about.com/od/delphitips2008/qt/print_window.htm](http://delphi.about.com/od/delphitips2008/qt/print_window.htm)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-05-04T13:40:31.423

感谢您提交这个有用的提交，我想我可以将提供的代码整合到一个单元中，以便在我的应用程序中使用，这是我在 DX10.2 Tokyo 上运行的代码。请注意示例，注意内存泄漏。

```
unit ScreenCapture;
interface

uses Windows, Vcl.Controls, Vcl.StdCtrls, VCL.Graphics,VCL.Imaging.JPEG, VCL.Forms;

function getScreenCapture(  FullWindow: Boolean = True ) : TBitmap;

implementation

function getScreenCapture( FullWindow: Boolean ) : TBitmap;
var
  Win: HWND;
  DC: HDC;

  WinRect: TRect;
  Width: Integer;
  Height: Integer;

begin
  Result := TBitmap.Create;

  //Application.ProcessMessages; // Was Sleep(500);
  Win := GetForegroundWindow;

  if FullWindow then
  begin
    GetWindowRect(Win, WinRect);
    DC := GetWindowDC(Win);
  end
    else
  begin
    Windows.GetClientRect(Win, WinRect);
    DC := GetDC(Win);
  end;
  try
    Width := WinRect.Right - WinRect.Left;
    Height := WinRect.Bottom - WinRect.Top;

    Result.Height := Height;
    Result.Width := Width;
    BitBlt(Result.Canvas.Handle, 0, 0, Width, Height, DC, 0, 0, SRCCOPY);
  finally
    ReleaseDC(Win, DC);
  end;
end;
end. 
```

例子 ：

```
//Any event or button click, screenCapture is a TBitmap
screenCapture := getScreenCapture();
try
  //Do some things with screen capture
  Image1.Picture.Graphic := screenCapture; 
finally 
  screenCapture.Free;
end; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-19T06:51:19.630

使用 GetForegroundWindow() 而不是 GetDesktopWindow()。

您必须保存 GetForegroundWindow() 返回的句柄并将保存的值传递给 ReleaseDC() - 以确保为同一窗口调用 GetWindowDC() 和 ReleaseDC() 以防活动窗口在调用之间发生变化。

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2012-06-03T15:39:09.757

Brian Frost 代码的最短版本：

`Screen.ActiveForm.GetFormImage.SaveToFile(Screen.ActiveForm.Caption+'.bmp');`

只需一行代码（MDI 应用程序中活动窗口的屏幕截图）。

# algorithm - 就地最小-最大树失效问题

> ID：661254
> 
> 赞同：4
> 
> 时间：2009-03-19T06:44:31.097
> 
> 标签：algorithm, data-structures

我正在尝试构建[min-max search](http://en.wikipedia.org/wiki/Minimax)的并行实现。我目前的方法是将树具体化到一个小的深度，然后从每个节点做正常的事情。

执行此操作的简单方法是计算每个叶子的启发式值，然后向上扫描并计算最小值/最大值。问题在于，它忽略了上层的[alpha/beta 修剪，并对性能造成重大影响。](http://en.wikipedia.org/wiki/Alpha-beta_pruning)

我的第一个“解决方案”是在计算每个叶子后将最小值/最大值推高。这提供了更新值，因此我可以向上扫描树并检查是否应该修剪叶子。

**问题是它完全坏了。**（2天的调试发现，该死的我觉得很愚蠢）

现在的问题：

*有没有办法构建一个最小-最大树，允许以随机顺序评估叶子并允许 alpha/beta 修剪？*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T16:38:49.273

查看*并行博弈树搜索*，例如[这篇论文](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.53.177)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T16:21:54.633

我想我已经找到了一个解决方案，但我在几个方面不喜欢它：

1.  用未完成的孩子的数量注释树。
2.  评估叶子后，更新它的父级，减少父级的计数
3.  如果该计数刚刚达到零，则更新它的父级，减少该计数
4.  起泡、起泡、重复

Alpha/Beta 修剪按预期工作。

这样做的问题是，通过随机顺序评估，在开始修剪之前会评估更多节点。另一方面，这可能会通过更好的叶子排序来缓解。

# html - 使用 Yahoo YQL 查询 html

> ID：661256
> 
> 赞同：10
> 
> 时间：2009-03-19T06:47:22.357
> 
> 标签：html, parsing, xpath, yql

在尝试使用 YQL 提供的 Yahoo Query Language 和 xpath 功能解析 html 时，我遇到了无法提取“text()”或属性值的问题。
例如
*[永久链接](http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20html%20where%20url%3D%22http%3A%2F%2Fstackoverflow.com%22%20and%0A%20%20%20%20%20%20xpath%3D'%2F%2Fdiv%2Fh3%2Fa'%0A%20%20%20%20&format=xml)*

```
select * from html where url="http://stackoverflow.com" 
and xpath='//div/h3/a' 
```

以 xml 形式给出锚点列表

```
<results>
    <a class="question-hyperlink" href="/questions/661184/filling-the-text-area-with-the-text-when-a-button-is-clicked" title="In ASP.net, I need the code to fill the text area (in the form) when a button is clicked. Can you help me through by showing a simple .aspx code containing the script tag? ">Filling the text area with the text when a button is clicked</a>...
</results> 
```

现在，当我尝试使用提取节点值时

```
select * from html where url="http://stackoverflow.com" 
and xpath='//div/h3/a/text()' 
```

我得到连接的结果而不是节点列表，例如

```
<results>Xcode: attaching to a remote process for debuggingWhy is b
…… </results> 
```

如何**将其分成节点列表**以及如何**选择属性值**？

像这样的查询

```
select * from html where url="http://stackoverflow.com"
and xpath='//div/h3/a[@href]' 
```

给了我相同的查询结果`div/h3/a`

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-19T20:48:45.490

YQL 要求 xpath 表达式计算为 itemPath 而不是节点文本。但是一旦有了 itemPath，就可以从树中投影各种值

换句话说，ItemPath 应该指向生成的 HTML 中的节点，而不是文本内容/属性。当您从数据中选择 * 时，YQL 会返回所有匹配的节点及其子节点。

例子

```
select * from html where url="http://stackoverflow.com" and xpath='//div/h3/a' 
```

这将返回与 xpath 匹配的所有 a。现在要投影文本内容，您可以使用

```
select content from html where url="http://stackoverflow.com" and xpath='//div/h3/a' 
```

“content”返回节点中保存的文本内容。

为了突出属性，您可以相对于 xpath 表达式指定它。在这种情况下，因为您需要相对于 a 的 href。

```
select href from html where url="http://stackoverflow.com" and xpath='//div/h3/a' 
```

这返回 `<results> <a href="/questions/663973/putting-a-background-pictures-with-leds"/> <a href="/questions/663013/advantages-and-disadvantages-of-popular-high-level-languages"/> .... </results>`

如果您需要属性“href”和 textContent，则可以执行以下 YQL 查询：

```
select href, content from html where url="http://stackoverflow.com" and xpath='//div/h3/a' 
```

返回：

```
<results> <a href="/questions/663950/double-pointer-const-issue-issue">double pointer const issue issue</a>... </results> 
```

希望有帮助。如果您对 YQL 有更多问题，请告诉我。

# php - JavaScript 和堆栈

> ID：661257
> 
> 赞同：0
> 
> 时间：2009-03-19T06:47:35.507
> 
> 标签：php, javascript, arrays

我正在使用 JavaScript 将值存储在堆栈中。问题是堆栈值保持活动状态，直到页面被刷新。刷新页面时，堆栈值中的值设置为“未定义”。实现一个永久存储堆栈值的地方会更好吗？

那么即使页面被刷新，旧的堆栈值也应该能够被检索到。

如何在 PHP 脚本中实现以下堆栈片段？

```
 var arr = new Array();
   var pushed = arr.push(id);  // For pushing into the stack
   arr.splice(0,arr.length); // For deleting the stack 
```

如何在 JavaScript 中引用 PHP 存储的值？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-19T07:07:47.703

如果我正确解释了您的问题，您是在问 JavaScript 对象是否可以在页面刷新之后持续存在？

不幸的是，当加载新页面时，所有 JavaScript 对象都丢失了。它们无法在页面刷新后存活。

我建议使用 cookie。我现在还不够专注于为您编写代码，但通常：

当您从堆栈中推送/弹出时，将堆栈持久保存到保存在客户端计算机上的 cookie 中。当页面第一次加载（或在您的示例中刷新）时，查找该 cookie 并将持久堆栈写入您的 JavaScript 对象。

查看这些页面以帮助从 JavaScript 持久化到 cookie：

1.  [David Winterbottom 的链接](http://codeinthehole.com/archives/6-Active-record-javascript-objects-using-cookies.html)
2.  *[饼干](http://www.quirksmode.org/js/cookies.html)*
3.  *[JavaScript Cookie](http://www.w3schools.com/JS/js_cookies.asp)*

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-31T01:25:50.663

解决此问题的另一种方法是不刷新页面，而是使用 Ajax 重新加载其主体、表单或 div 元素。jQuery 让这变得*特别*简单：

```
$('body').load(url); 
```

这样，您可以在更新之间保持脚本值的持久性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T07:14:25.987

假设您希望 JavaScript 变量中的某些值在页面加载之间保持不变，您可以执行 Damovisa 建议的操作，也可以简单地使用隐藏字段以某种形式存储堆栈值。也许是逗号分隔的字符串或类似的东西。

优势很明显。您的程序将不依赖于客户端的浏览器来启用 cookie。

作为替代方案，如果可能的话，您可以在某个服务器端变量中维护您的堆栈，然后在呈现页面时将该值动态插入到 JavaScript 代码中。

如果您可以向我们提供有关您的计划的更多详细信息，这将非常有帮助。

如果您希望 PHP 变量中的值反映在您的 JavaScript 代码中，请在您的 JavaScript 代码中嵌入 PHP 标记。

例如：

```
<script>
    var str = "<?php echo $my_str; ?>";
    //Do something with str
</script> 
```

请务必包含引号 (")，否则字符串中的值将被 JavaScript 视为标记并可能引发错误。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-19T07:19:24.633

您可以序列化该对象，并在 URL 中使用 JavaScript 将其发布到下一页，然后在页面上从 URL 解析它。这可能不是最好的方法，但既然你问了，我假设你不能使用任何后端技术来永久存储数据。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-19T07:03:07.823

不完全确定你在问什么
如果你想使用一个对象来实现这个片段，试试这样的事情：

```
var obj = {};
obj[key] = id; // to add
obj = {};      // to remove all items
del obj[key];  // to remove 1 item 
```

# ruby-on-rails - 如何使用以前版本的 Rspec 运行我的 Specs？

> ID：661261
> 
> 赞同：2
> 
> 时间：2009-03-19T06:51:17.587
> 
> 标签：ruby-on-rails, ruby, rspec, bdd

我一直在我的一台机器上学习 RSpec 教程，希望能更多地了解 BDD 和 TDD。我的设置是使用 Rails 2.2.2 和 Rspec 1.1.12

今晚我决定继续使用我的主要机器并将我的代码从我的便携式计算机移动到我的桌面。没有 RSpec，我安装了 gem 。. .

```
sudo gem install rspec
sudo gem install rspec-rails 
```

冲突和诽谤！新版Rspec安装！1.2.0！现在我的测试到处都失败了！虽然我完全打算跟进并学习最新版本，但我真的很想完成本教程的剩余内容，而无需重新开始。我想知道。有没有办法安装并指定我想针对以前的 Rspec 1.2.12 运行我的代码？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-19T09:33:34.280

您可以使用指定的 VERSION 卸载并重新安装。[在这里](http://rubygems.org/read/chapter/4#page71)解释。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-19T22:53:01.700

如果你想在你的电脑上安装多个版本，如果你应该有一个 2.2 rails 应用程序和一个 2.3 rails 应用程序，那么在你的 environment.rb 文件中指定：

```
config.gem, 'rspec', :lib => 'spec', :version => '1.1.12' 
```

并且您的应用程序将使用该 gem 规范和随附的 rspec-rails gem。这将使您能够为每个应用程序使用适当的 gem。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-08-16T15:58:41.703

除了在我的环境/test.rb 文件中指定 rspec 和 rspec-rails 版本之外，我`script/`还在 . 前面添加了`spec`，例如：

```
script/spec spec/controllers/treasury_accounts_controller.rb 
```

克服这个错误：

```
/opt/ror/ruby-ee-1.8.7-2011-03/lib/ruby/site_ruby/1.8/rubygems.rb:335:in `bin_path': can't find executable spec for rspec-2.1.0 (Gem::Exception)
    from /opt/ror/ruby/bin/spec:19 
```

# .net - 我可以在 Word 或 Excel 中创建撤消事务吗？(VSTO)

> ID：661269
> 
> 赞同：6
> 
> 时间：2009-03-19T06:55:29.480
> 
> 标签：.net, excel, vba, ms-word, vsto

我注意到 Project 2007 具有允许将可以撤消的操作放置在单个堆栈项或“撤消事务”中的功能。[例如：](http://msdn.microsoft.com/en-us/library/ms477952.aspx)

```
Application.OpenUndoTransaction "Create 6 tasks"
Dim i As Integer
For i = 1 To 6
    ActiveProject.Tasks.Add "UndoMe " & i
Next
Application.CloseUndoTransaction 
```

这意味着用户可以在单个撤消操作中撤消所有操作，而不是 6 次。

这在 Word 和/或 Excel 中实现会很棒，因为我在 VSTO 中做一些事情会一次进行多项更改，如果用户必须多次单击撤消，这对用户来说会有点烦人他们犯了一个错误。尽管这些特定功能似乎不存在，但有谁知道是否/如何以某种方式完成？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-19T07:23:49.333

您可以通过覆盖 VBA 中的撤消和重做命令例程来模拟 Word 中的事务行为（不过，我认为仅使用 VSTO 覆盖内置的 Word 命令是不可能的）。通过添加书签来标记事务的开始，通过删除书签来标记事务的结束。

调用 undo 时，我们检查事务标记书签是否存在并重复 undo 直到标记消失。重做的工作方式相同。此机制支持对文档内容所做的所有修改的事务性撤消/重做。但是，为了允许撤消/重做对文档属性的修改，需要使用 SetCustomProp 宏实现特殊机制。不应直接设置文档属性，而应仅通过此宏设置。

更新：我忘了明确提到这种方法只适用于键盘快捷键和菜单命令，单击工具栏按钮仍然可以单步撤消。因此，我们决定将工具栏按钮替换为自定义按钮。该代码已经在 Word 2003 中使用了很长一段时间（它没有在 Word 2007 中测试过，所以要做好惊喜的准备；）

```
Option Explicit

' string constants for Undo mechanism
Public Const BM_IN_MACRO As String = "_InMacro_"

Public Const BM_DOC_PROP_CHANGE As String = "_DocPropChange_"
Public Const BM_DOC_PROP_NAME As String = "_DocPropName_"
Public Const BM_DOC_PROP_OLD_VALUE As String = "_DocPropOldValue_"
Public Const BM_DOC_PROP_NEW_VALUE As String = "_DocPropNewValue_"

'-----------------------------------------------------------------------------------
' Procedure : EditUndo
' Purpose   : Atomic undo of macros
'             Note: This macro only catches the menu command and the keyboard shortcut,
'                   not the toolbar command
'-----------------------------------------------------------------------------------
Public Sub EditUndo() ' Catches Ctrl-Z

    'On Error Resume Next
    Dim bRefresh As Boolean
    bRefresh = Application.ScreenUpdating
    Application.ScreenUpdating = False

    Do
        If ActiveDocument.Bookmarks.Exists(BM_DOC_PROP_CHANGE) Then
            Dim strPropName As String
            Dim strOldValue As String

            strPropName = ActiveDocument.Bookmarks(BM_DOC_PROP_NAME).Range.Text
            strOldValue = ActiveDocument.Bookmarks(BM_DOC_PROP_OLD_VALUE).Range.Text
            ActiveDocument.CustomDocumentProperties(strPropName).Value = strOldValue
        End If

    Loop While (ActiveDocument.Undo = True) _
       And ActiveDocument.Bookmarks.Exists(BM_IN_MACRO)

    Application.ScreenUpdating = bRefresh
End Sub

'-----------------------------------------------------------------------------------
' Procedure : EditRedo
' Purpose   : Atomic redo of macros
'             Note: This macro only catches the menu command and the keyboard shortcut,
'                   not the toolbar command
'-----------------------------------------------------------------------------------
Public Sub EditRedo() ' Catches Ctrl-Y

    Dim bRefresh As Boolean
    bRefresh = Application.ScreenUpdating
    Application.ScreenUpdating = False

    Do
        If ActiveDocument.Bookmarks.Exists(BM_DOC_PROP_CHANGE) Then
            Dim strPropName As String
            Dim strNewValue As String

            strPropName = ActiveDocument.Bookmarks(BM_DOC_PROP_NAME).Range.Text
            strNewValue = ActiveDocument.Bookmarks(BM_DOC_PROP_NEW_VALUE).Range.Text
            ActiveDocument.CustomDocumentProperties(strPropName).Value = strNewValue
        End If

    Loop While (ActiveDocument.Redo = True) _
       And ActiveDocument.Bookmarks.Exists(BM_IN_MACRO)

    Application.ScreenUpdating = bRefresh

End Sub

'-----------------------------------------------------------------------------------
' Procedure : SetCustomProp
' Purpose   : Sets a custom document property
'-----------------------------------------------------------------------------------
Public Function SetCustomProp(oDoc As Document, strName As String, strValue As String)

    Dim strOldValue As String

    On Error GoTo existsAlready
    strOldValue = ""
    oDoc.CustomDocumentProperties.Add _
        Name:=strName, LinkToContent:=False, Value:=Trim(strValue), _
        Type:=msoPropertyTypeString
    GoTo exitHere

existsAlready:
    strOldValue = oDoc.CustomDocumentProperties(strName).Value
    oDoc.CustomDocumentProperties(strName).Value = strValue

exitHere:
    ' support undo / redo of changes to the document properties
    'On Error Resume Next
    Dim bCalledWithoutUndoSupport  As Boolean

    If Not ActiveDocument.Bookmarks.Exists(BM_IN_MACRO) Then
        ActiveDocument.Range.Bookmarks.Add BM_IN_MACRO, ActiveDocument.Range
        bCalledWithoutUndoSupport = True
    End If

    Dim oRange As Range
    Set oRange = ActiveDocument.Range

    oRange.Collapse wdCollapseEnd
    oRange.Text = " "
    oRange.Bookmarks.Add "DocPropDummy_", oRange

    oRange.Collapse wdCollapseEnd
    oRange.Text = strName
    oRange.Bookmarks.Add BM_DOC_PROP_NAME, oRange

    oRange.Collapse wdCollapseEnd
    oRange.Text = strOldValue
    oRange.Bookmarks.Add BM_DOC_PROP_OLD_VALUE, oRange

    oRange.Collapse wdCollapseEnd
    oRange.Text = strValue
    oRange.Bookmarks.Add BM_DOC_PROP_NEW_VALUE, oRange

    oRange.Bookmarks.Add BM_DOC_PROP_CHANGE
    ActiveDocument.Bookmarks(BM_DOC_PROP_CHANGE).Delete

    Set oRange = ActiveDocument.Bookmarks(BM_DOC_PROP_NEW_VALUE).Range
    ActiveDocument.Bookmarks(BM_DOC_PROP_NEW_VALUE).Delete
    If Len(oRange.Text) > 0 Then oRange.Delete

    Set oRange = ActiveDocument.Bookmarks(BM_DOC_PROP_OLD_VALUE).Range
    ActiveDocument.Bookmarks(BM_DOC_PROP_OLD_VALUE).Delete
    If Len(oRange.Text) > 0 Then oRange.Delete

    Set oRange = ActiveDocument.Bookmarks(BM_DOC_PROP_NAME).Range
    ActiveDocument.Bookmarks(BM_DOC_PROP_NAME).Delete
    If Len(oRange.Text) > 0 Then oRange.Delete

    Set oRange = ActiveDocument.Bookmarks("DocPropDummy_").Range
    ActiveDocument.Bookmarks("DocPropDummy_").Delete
    If Len(oRange.Text) > 0 Then oRange.Delete

    If bCalledWithoutUndoSupport And ActiveDocument.Bookmarks.Exists(BM_IN_MACRO) Then
        ActiveDocument.Bookmarks(BM_IN_MACRO).Delete
    End If

End Function

'-----------------------------------------------------------------------------------
' Procedure : SampleUsage
' Purpose   : Demonstrates a transaction
'-----------------------------------------------------------------------------------
Private Sub SampleUsage()

    On Error Resume Next

    ' mark begin of transaction
    ActiveDocument.Range.Bookmarks.Add BM_IN_MACRO

    Selection.Text = "Hello World"
    ' do other stuff

    ' mark end of transaction
    ActiveDocument.Bookmarks(BM_IN_MACRO).Delete

End Sub 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-02-07T22:06:10.417

[Word 2010 提供了通过Application.UndoRecord](http://msdn.microsoft.com/en-us/library/ff838675.aspx)对象执行此操作的能力。请参阅[http://msdn.microsoft.com/en-us/library/hh128816.aspx](http://msdn.microsoft.com/en-us/library/hh128816.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-07-21T05:59:20.587

我一直在咀嚼这个有一段时间了。这是我尝试使用隐藏文档，然后从隐藏文档中获取 WordOpenXML 并在需要时将其放置在真实文档中，以使任何数量的 VSTO 操作都成为单个撤消。

```
//Usage from ThisDocument VSTO Document level project
public partial class ThisDocument
{   
    //Used to buffer writing text & formatting to document (to save undo stack)
    public static DocBuffer buffer;

    //Attached Template
    public static Word.Template template;

    private void ThisDocument_Startup(object sender, System.EventArgs e)
    {           
        //Ignore changes to template (removes prompt to save changes to template)
        template = (Word.Template)this.Application.ActiveDocument.get_AttachedTemplate();
        template.Saved = true;            

        //Document buffer
        buffer = new DocBuffer();

        //Start buffer
        ThisDocument.buffer.Start();

        //This becomes one "undo"
        Word.Selection curSel = Globals.ThisDocument.Application.Selection;
        curSel.TypeText(" ");
        curSel.TypeBackspace();
        curSel.Font.Bold = 1;
        curSel.TypeText("Hello, world!");
        curSel.Font.Bold = 0;
        curSel.TypeText(" ");

        //end buffer, print out text
        ThisDocument.buffer.End();
    }

    void Application_DocumentBeforeClose(Microsoft.Office.Interop.Word.Document Doc, ref bool Cancel)
    {
        buffer.Close();
    }

    private void ThisDocument_Shutdown(object sender, System.EventArgs e)
    {
        buffer.Close();         
    }
} 
```

这是 DocBuffer 类：

```
public class DocBuffer
{
    //Word API Objects
    Word._Document HiddenDoc;
    Word.Selection curSel;
    Word.Template template;

    //ref parameters
    object missing = System.Type.Missing;
    object FalseObj = false; //flip this for docbuffer troubleshooting
    object templateObj;

    //Is docbuffer running?
    public Boolean started{ get; private set; }

    //Open document on new object
    public DocBuffer()
    {
        //Clear out unused buffer bookmarks
        Word.Bookmarks bookmarks = Globals.ThisDocument.Application.ActiveDocument.Bookmarks;
        bookmarks.ShowHidden = true;

        foreach (Word.Bookmark mark in bookmarks)
        {
            if (mark.Name.Contains("_buf"))
            {
                mark.Delete();
            }
        }

        //Remove trail of undo's for clearing out the bookmarks
        Globals.ThisDocument.UndoClear();

        //Set up template
        template = ThisDocument.template;
        templateObj = template;

        //Open Blank document, then attach styles *and update
        HiddenDoc = Globals.ThisDocument.Application.Documents.Add(ref missing, ref missing, ref missing, ref FalseObj);
        HiddenDoc.set_AttachedTemplate(ref templateObj);
        HiddenDoc.UpdateStyles();

        //Tell hidden document it has been saved to remove rare prompt to save document
        HiddenDoc.Saved = true;

        //Make primary document active
        Globals.ThisDocument.Activate();

    }

    ~DocBuffer()
    {
        try
        {
            HiddenDoc.Close(ref FalseObj, ref missing, ref missing);
        }
        catch { }
    }

    public void Close()
    {
        try
        {
            HiddenDoc.Close(ref FalseObj, ref missing, ref missing);
        }
        catch { }
    }

    public void Start()
    {
        try
        {
            //Make hidden document active to receive selection
            HiddenDoc.Activate(); //results in a slight application focus loss
        }
        catch (System.Runtime.InteropServices.COMException ex)
        {
            if (ex.Message == "Object has been deleted.")
            {
                //Open Blank document, then attach styles *and update
                HiddenDoc = Globals.ThisDocument.Application.Documents.Add(ref missing, ref missing, ref missing, ref FalseObj);
                HiddenDoc.set_AttachedTemplate(ref templateObj);
                HiddenDoc.UpdateStyles();
                HiddenDoc.Activate();
            }
            else
                throw;
        }

        //Remove Continue Bookmark, if exists
        Word.Bookmarks hiddenDocBookmarks = Globals.ThisDocument.Application.ActiveDocument.Bookmarks;
        if (hiddenDocBookmarks.Exists("Continue"))
        {
            object deleteMarkObj = "Continue";
            Word.Bookmark deleteMark = hiddenDocBookmarks.get_Item(ref deleteMarkObj);
            deleteMark.Select();
            deleteMark.Delete();
        }

        //Tell hidden document it has been saved to remove rare prompt to save document
        HiddenDoc.Saved = true;

        //Keep track when started
        started = true;
    }

    //Used for non-modal dialogs to bring active document back up between text insertion
    public void Continue()
    {
        //Exit quietly if buffer hasn't started
        if (!started) return;

        //Verify hidden document is active
        if ((HiddenDoc as Word.Document) != Globals.ThisDocument.Application.ActiveDocument)
        {
            HiddenDoc.Activate();
        }

        //Hidden doc selection
        curSel = Globals.ThisDocument.Application.Selection;

        //Hidden doc range
        Word.Range bufDocRange;

        //Select entire doc, save range
        curSel.WholeStory();
        bufDocRange = curSel.Range;

        //Find end, put a bookmark there
        bufDocRange.SetRange(curSel.End, curSel.End);
        object bookmarkObj = bufDocRange;

        //Generate "Continue" hidden bookmark
        Word.Bookmark mark = Globals.ThisDocument.Application.ActiveDocument.Bookmarks.Add("Continue", ref bookmarkObj);
        mark.Select();

        //Tell hidden document it has been saved to remove rare prompt to save document
        HiddenDoc.Saved = true;

        //Make primary document active
        Globals.ThisDocument.Activate();
    }

    public void End()
    {
        //Exit quietly if buffer hasn't started
        if (!started) return;

        //Turn off buffer started flag
        started = false;

        //Verify hidden document is active
        if ((HiddenDoc as Word.Document) != Globals.ThisDocument.Application.ActiveDocument)
        {
            HiddenDoc.Activate();
        }

        //Remove Continue Bookmark, if exists
        Word.Bookmarks hiddenDocBookmarks = Globals.ThisDocument.Application.ActiveDocument.Bookmarks;
        hiddenDocBookmarks.ShowHidden = true;
        if (hiddenDocBookmarks.Exists("Continue"))
        {
            object deleteMarkObj = "Continue";
            Word.Bookmark deleteMark = hiddenDocBookmarks.get_Item(ref deleteMarkObj);
            deleteMark.Delete();
        }

        //Hidden doc selection
        curSel = Globals.ThisDocument.Application.Selection;

        //Hidden doc range
        Word.Range hiddenDocRange;
        Word.Range bufDocRange;

        //Select entire doc, save range
        curSel.WholeStory();
        bufDocRange = curSel.Range;

        //If cursor bookmark placed in, move there, else find end of text, put a bookmark there
        Boolean cursorFound = false;
        if (hiddenDocBookmarks.Exists("_cursor"))
        {
            object cursorBookmarkObj = "_cursor";
            Word.Bookmark cursorBookmark = hiddenDocBookmarks.get_Item(ref cursorBookmarkObj);
            bufDocRange.SetRange(cursorBookmark.Range.End, cursorBookmark.Range.End);
            cursorBookmark.Delete();
            cursorFound = true;
        }
        else
        {
            //The -2 is done because [range object].WordOpenXML likes to drop bookmarks at the end of the range
            bufDocRange.SetRange(curSel.End - 2, curSel.End - 2);
        }

        object bookmarkObj = bufDocRange;

        //Generate GUID for hidden bookmark
        System.Guid guid = System.Guid.NewGuid();
        String id = "_buf" + guid.ToString().Replace("-", string.Empty);
        Word.Bookmark mark = Globals.ThisDocument.Application.ActiveDocument.Bookmarks.Add(id, ref bookmarkObj);

        //Get OpenXML Text (Text with formatting)
        curSel.WholeStory();
        hiddenDocRange = curSel.Range;
        string XMLText = hiddenDocRange.WordOpenXML;

        //Clear out contents of buffer
        hiddenDocRange.Delete(ref missing, ref missing); //comment this for docbuffer troubleshooting

        //Tell hidden document it has been saved to remove rare prompt to save document
        HiddenDoc.Saved = true;

        //Make primary document active
        Globals.ThisDocument.Activate();

        //Get selection from new active document
        curSel = Globals.ThisDocument.Application.Selection;

        //insert buffered formatted text into main document
        curSel.InsertXML(XMLText, ref missing);

        //Place cursor at bookmark+1 (this is done due to WordOpenXML ignoring bookmarks at the end of the selection)
        Word.Bookmarks bookmarks = Globals.ThisDocument.Application.ActiveDocument.Bookmarks;
        bookmarks.ShowHidden = true;

        object stringObj = id;
        Word.Bookmark get_mark = bookmarks.get_Item(ref stringObj);
        bufDocRange = get_mark.Range;

        if (cursorFound) //Canned language actively placed cursor
            bufDocRange.SetRange(get_mark.Range.End, get_mark.Range.End);
        else //default cursor at the end of text
            bufDocRange.SetRange(get_mark.Range.End + 1, get_mark.Range.End + 1);
        bufDocRange.Select();
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-19T07:20:14.913

作为其 VBA 体系结构的一部分，Excel 具有一些（有限的）对撤消和重做的内置支持。

我不熟悉 vsto，所以我不知道这是否会对您有所帮助，但您可以查看[这个 SO question](https://stackoverflow.com/questions/339228/building-undo-into-an-excel-vba-macro)了解更多详细信息。

# c++ - 在 C++ 中传递对文字的引用时会发生什么？

> ID：661273
> 
> 赞同：7
> 
> 时间：2009-03-19T07:00:22.527
> 
> 标签：c++

这里会发生什么：

```
double foo( const double& x ) {
   // do stuff with x
}

foo( 5.0 ); 
```

1.  编译器是否创建了一个匿名变量并将其值设置为 5.0？
2.  x 是否引用只读内存中的内存位置？这是一个奇怪的措辞，我知道...

**编辑**：我忘记了 const 关键字...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-19T07:12:21.500

为此目的创建了一个临时变量，它通常在堆栈上创建。

您可以尝试使用 const_cast，但无论如何它都没有 pontless，因为一旦函数返回，您将无法再访问变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T07:06:40.513

1.  什么编译器可能会创建 const 文字，但这不是变量。
2.  非常量引用不能指向文字。

    $ g++ test.cpp test.cpp: In function `int main()': test.cpp:10: error: invalid initialization of non-const reference of type 'double&' from a temporary of type 'double' test.cpp:5: error: in passing argument 1 of`double foo(double&)'

测试.cpp：

```
#include <iostream>

using namespace std;

double foo(double & x) {
    x = 1;
}

int main () {
    foo(5.0);

    cout << "hello, world" << endl;
    return 0;
} 
```

另一方面，您可以将文字传递给 const 引用，如下所示。测试2.cpp：

```
#include <iostream>

using namespace std;

double foo(const double & x) {
    cout << x << endl;
}

int main () {
    foo(5.0);

    cout << "hello, world" << endl;
    return 0;
} 
```

# android - 如何在 Android WebView 中保存当前 URL 状态？

> ID：661277
> 
> 赞同：0
> 
> 时间：2009-03-19T07:02:37.373
> 
> 标签：android, view, webview, savestate, android-configchanges

在安卓自带的浏览器中，当你旋转手机时，`WebView`不会重新加载。我想知道如何做到这一点。我可以保存 的当前 URL`Webview`并将其传递给我自己的下一个版本，但是我该如何处理整个`WebView`?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-21T20:48:04.277

我最终只使用了 onConfigurationChange 并保持了相同的 WebView。谢谢，
艾萨克·沃勒

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T12:36:34.563

不要忘记在 Manifest 中注册 configChange。

```
<activity android:name=".WebContent" android:configChanges="orientation"> 
```

# iphone - 如何在 iPhone 应用程序中实现大网格单元格？

> ID：661278
> 
> 赞同：1
> 
> 时间：2009-03-19T07:02:51.507
> 
> 标签：iphone, objective-c, user-interface, spreadsheet

关于[我之前的问题](https://stackoverflow.com/questions/661148/how-can-i-create-an-interface-similar-to-an-excel-spreadsheet-on-the-iphone)，我想知道如何在 iPhone 应用程序中实现大量单元格。

我正在开发一个类似于 Excel 电子表格的界面，具有许多行和列。我必须分别处理每个单元格吗？如何处理每个单元格中的用户交互？

是否有创建此类控件的标准方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T10:38:46.713

没有真正的标准机制。

如果给定行中的所有单元格将始终适合屏幕的宽度，则一种方法是创建一个 UITableViewCell ，其中包含多个 UILabel 和它们之间的垂直分隔符。如果所有这些行都有相同宽度的“列”，您将获得网格的外观。

如果这不可能，那么考虑一下表格视图控件的真正含义可能会有所帮助。表格视图只是一个滚动视图，它会自动添加、删除和回收其子视图，以便只有在给定时间可见的子视图才在内存中。没有理由不能编写一个 GridView 控件来做同样的事情，但是是二维的。当然，它不会像使用内置表格视图那么简单，但如果表格视图不能满足您的需求，那么，这就是 Apple 不编写所有应用程序的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-28T01:18:50.240

看看我对这个问题的回答： [MS Excel type spreadsheet creation using objective-c for iOS app](https://stackoverflow.com/questions/14892174/ms-excel-type-spreadsheet-creation-using-objective-c-for-ios-app)。

基本上没有标准的方法来做到这一点。您将需要手工制作所有东西，并且有 3 种方法：

1.  使用**UIWebView**并使用 html/js 布局所有内容。
2.  修改**UICollectionView**。
3.  **使用Core Data**手工制作一切。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-25T02:29:49.727

听起来就像 UICollectionView 的确切用途！

[http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UICollectionView_class/Reference/Reference.html](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UICollectionView_class/Reference/Reference.html)

# castle-activerecord - 如何在中等信任托管中运行城堡 activerecord？

> ID：661287
> 
> 赞同：0
> 
> 时间：2009-03-19T07:13:59.030
> 
> 标签：castle-activerecord

我已按照[指南](http://nhforge.org/wikis/howtonh/pre-generate-lazy-loading-proxies.aspx)生成代理，但出现以下安全异常

```
[SecurityException: That assembly does not allow partially trusted callers.]
Castle.ActiveRecord.Framework.Internal.ActiveRecordModelBuilder..cctor() +0 
```

我该如何纠正这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T11:02:08.500

您需要一个定义了 AllowPartiallyTrustedCallers 属性的 ActiveRecord 的构建，请参阅[以中等信任运行](http://nhforge.org/wikis/howtonh/run-in-medium-trust.aspx)

# c# - 监视目录更改的并发 Windows 服务

> ID：661288
> 
> 赞同：0
> 
> 时间：2009-03-19T07:13:59.653
> 
> 标签：c#

是否有任何监视目录更改的 .Net Windows 服务库？我正在做一个文件传输应用程序，所以只要将新的文件/文件夹添加到受监控的目录中，我就会执行我的 c# 代码来执行其他一些其他操作。

一旦添加了新的文件夹/文件，监控应该立即启动我的服务，这意味着我的服务的一个多个实例可以同时运行。处理这些场景的最佳/成熟技术是什么？我很确定有一个标准术语，但我不知道。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-19T07:24:16.510

看：[System.IO.FileSystemWatcher](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx)

# c# - C#中的字符串操作

> ID：661289
> 
> 赞同：0
> 
> 时间：2009-03-19T07:14:10.637
> 
> 标签：c#

假设我有一个字符串`"011100011"`。现在我需要通过添加这个字符串的相邻数字来找到另一个字符串，就像输出字符串应该是`"123210122"`.

如何拆分字符串中的每个字符并对其进行操作？

我认为的方法是使用 Parsing 将字符串转换为整数，并使用模数或其他东西拆分每个字符并对它们执行操作。

但是你能推荐一些更简单的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T07:19:05.727

尝试将字符串转换为字符数组，然后`'0'`从`char`值中减去以检索整数值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T07:23:04.657

```
string input = "011100011";
int current;

for (int i = 0; i < input.Length; i ++)
{
  current = int.Parse(input[i]);

  // do something with current...
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T07:55:12.207

这是一个使用一些 LINQ 加上 dahlbyk 的想法的解决方案：

```
string input = "011100011";

// add a 0 at the start and end to make the loop simpler
input = "0" + input + "0"; 

var integers = (from c in input.ToCharArray() select (int)(c-'0'));
string output = "";
for (int i = 0; i < input.Length-2; i++)
{
    output += integers.Skip(i).Take(3).Sum();
}

// output is now "123210122" 
```

请注意：

*   代码没有优化。例如，您可能想在 for 循环中使用 StringBuilder。
*   如果输入字符串中有“9”会发生什么 -> 这可能会导致输出字符串中有两位数。

# oracle - 如何将 .dmp 文件导入 Oracle？

> ID：661297
> 
> 赞同：17
> 
> 时间：2009-03-19T07:18:55.570
> 
> 标签：oracle, import

我有一个`.dmp`要导入 Oracle 9i 的文件。我怎么做？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-03-19T08:29:33.250

假设您有一个由 oracle exp 创建的 .dmp 文件，那么

```
imp help=y 
```

会是你的朋友。它会引导你

```
imp file=<file>.dmp show=y 
```

查看转储的内容，然后类似

```
imp scott/tiger@example file=<file>.dmp fromuser=<source> touser=<dest> 
```

从一个用户导入到另一个用户。如果它是一个复杂的模式，请做好长期准备，因为您需要预先创建所有引用的模式用户和表空间以使 imp 正常工作

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2016-08-04T10:39:35.447

我正在使用 Oracle Database Express Edition 11g 第 2 版。

按照步骤：

**打开运行 SQL 命令行**

第一步：以系统用户身份登录

```
 SQL> connect system/tiger 
```

第2步 ：`SQL> CREATE USER UserName IDENTIFIED BY Password;`

第 3 步：`SQL> grant dba to UserName ;`

第4步 ：`SQL> GRANT UNLIMITED TABLESPACE TO UserName;`

第 5 步：

```
 SQL> CREATE BIGFILE TABLESPACE TSD_UserName
             DATAFILE 'tbs_perm_03.dat'
             SIZE 8G
             AUTOEXTEND ON; 
```

**在 Windows 中打开命令提示符或在 Ubuntu 中打开终端。然后键入：**

**注意：如果您使用 Ubuntu，则将路径中的“\”替换为“/”。**

第 6 步：`C:\> imp UserName/password@localhost file=D:\abc\xyz.dmp log=D:\abc\abc_1.log full=y;`

完毕....

我希望你在这里找到正确的解决方案。

谢谢。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-02-23T06:56:42.337

我得到了解决方案，因为`imp help=y`提到 imp 仅`TRANSPORT_TABLESPACE`在以下情况下有效：

```
Keyword  Description (Default)       Keyword      Description (Default)
--------------------------------------------------------------------------
USERID   username/password           FULL         import entire file (N)
BUFFER   size of data buffer         FROMUSER     list of owner usernames
FILE     input files (EXPDAT.DMP)    TOUSER       list of usernames
SHOW     just list file contents (N) TABLES       list of table names
IGNORE   ignore create errors (N)    RECORDLENGTH length of IO record
GRANTS   import grants (Y)           INCTYPE      incremental import type
INDEXES  import indexes (Y)          COMMIT       commit array insert (N)
ROWS     import data rows (Y)        PARFILE      parameter filename
LOG      log file of screen output   CONSTRAINTS  import constraints (Y)
DESTROY                overwrite tablespace data file (N)
INDEXFILE              write table/index info to specified file
SKIP_UNUSABLE_INDEXES  skip maintenance of unusable indexes (N)
FEEDBACK               display progress every x rows(0)
TOID_NOVALIDATE        skip validation of specified type ids
FILESIZE               maximum size of each dump file
STATISTICS             import precomputed statistics (always)
RESUMABLE              suspend when a space related error is encountered(N)
RESUMABLE_NAME         text string used to identify resumable statement
RESUMABLE_TIMEOUT      wait time for RESUMABLE
COMPILE                compile procedures, packages, and functions (Y)
STREAMS_CONFIGURATION  import streams general metadata (Y)
STREAMS_INSTANTIATION  import streams instantiation metadata (N)
DATA_ONLY              import only data (N)

The following keywords only apply to transportable tablespaces
TRANSPORT_TABLESPACE import transportable tablespace metadata (N)
TABLESPACES tablespaces to be transported into database
DATAFILES datafiles to be transported into database
TTS_OWNERS users that own data in the transportable tablespace set 
```

因此，请为您的用户创建表空间：

```
CREATE TABLESPACE <tablespace name> DATAFILE <path to save, example: 'C:\ORACLEXE\APP\ORACLE\ORADATA\XE\ABC.dbf'> SIZE 100M AUTOEXTEND ON NEXT 100M MAXSIZE 10G EXTENT MANAGEMENT LOCAL UNIFORM SIZE 1M; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-03-01T04:30:33.670

```
imp system/system-password@SID file=directory-you-selected\FILE.dmp log=log-dir\oracle_load.log fromuser=infodba touser=infodba commit=Y 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-03-19T08:34:14.033

.dmp 文件是使用“exp”命令创建的 oracle 数据库的转储。您可以使用“imp”命令导入它们。

如果您的机器上安装了 oracle 客户端，则可以执行命令

小鬼帮助=y

了解它是如何工作的。肯定会有所帮助的是从 wich 模式中了解数据被导出以及 oracle 版本是什么。

# javascript - 如何在javascript中修剪前导和尾随逗号？

> ID：661305
> 
> 赞同：70
> 
> 时间：2009-03-19T07:20:43.647
> 
> 标签：javascript

我有一个如下所示的字符串。

```
,liger, unicorn, snipe, 
```

如何在javascript中修剪前导和尾随逗号？

* * *

## 回答 #1

> 赞同：169
> 
> 时间：2009-03-19T07:25:31.890

因为我相信一切都可以用正则表达式解决：

```
var str = ",liger, unicorn, snipe,"
var trim = str.replace(/(^,)|(,$)/g, "")
// trim now equals 'liger, unicorn, snipe' 
```

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2009-03-19T08:14:42.333

虽然 cobbal 的答案是“最好的”，但在我看来，我想补充一点：根据字符串的格式以及去除前导和尾随逗号的目的，您可能还需要注意空格。

```
var str = ',liger, unicorn, snipe,';
var trim = str.replace(/(^\s*,)|(,\s*$)/g, ''); 
```

当然，在这个应用程序中，使用正则表达式而不是基本字符串方法的价值更加明显。

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2014-07-28T14:35:11.560

如果您想确保没有任何尾随逗号或空格，您可能需要使用此正则表达式。

```
var str = ' , , , foo, bar,    ';
str = str.replace(/(^[,\s]+)|([,\s]+$)/g, ''); 
```

返回

```
"foo, bar" 
```

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2009-03-19T07:27:52.117

试试这个，因为不是*所有事情都*可以通过 RE 解决，甚至有些事情可以，不应该：-)

```
<script type="text/javascript">
    var str = ",liger, unicorn, snipe,";
    if (str.substr(0,1) == ",") {
        str = str.substring(1);
    }
    var len = str.length;
    if (str.substr(len-1,1) == ",") {
        str = str.substring(0,len-1);
    }
    alert (str);
</script> 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2020-09-04T21:34:08.593

在 ECMAScript 5 及更高版本中，您现在可以执行单行

```
',liger, unicorn, snipe,'.split(',').map(e => e.trim()).filter(e => e).join(', ') 
```

# c - 我应该如何用 C 构建复杂的项目？

> ID：661307
> 
> 赞同：81
> 
> 时间：2009-03-19T07:22:57.277
> 
> 标签：c, project-management

我只有初级 C 技能，想知道是否有任何事实上的“标准”来用 C 构建一个有点复杂的应用程序。甚至是基于 GUI 的应用程序。

我一直在 Java 和 PHP 中使用 OO 范例，现在我想学习 C，我担心我可能会以错误的方式构建我的应用程序。我不知道要遵循哪些指南来使用程序语言来实现模块化、解耦和枯燥。

你有什么读物要推荐吗？即使我不使用框架，我也找不到任何适用于 C 的应用程序框架，但我总是通过浏览它们的代码找到好主意。

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-03-19T07:37:46.027

关键是模块化。这更容易设计、实现、编译和维护。

*   识别应用程序中的模块，例如 OO 应用程序中的类。
*   将每个模块的接口和实现分开，只在接口中放入其他模块需要的东西。请记住，C 中没有名称空间，因此您必须使接口中的所有内容都是唯一的（例如，带有前缀）。
*   在实现中隐藏全局变量并使用访问器函数进行读/写。
*   不要考虑继承，而是考虑组合。作为一般规则，不要试图在 C 中模仿 C++，这将很难阅读和维护。

如果您有时间学习，请查看 Ada 应用程序的结构，以及它的强制性`package`（模块接口）和`package body`（模块实现）。

这是为了编码。

为了维护（记住你编码一次，但你维护了几次）我建议记录你的代码；[Doxygen](http://www.doxygen.org/)对我来说是一个不错的选择。我还建议构建一个强大的回归测试套件，它允许您进行重构。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-03-19T07:47:44.347

一种常见的误解是，OO 技术不能在 C 中应用。大多数都可以——只是它们比具有专用于该工作的语法的语言更笨拙。

稳健系统设计的基础之一是将实现封装在接口后面。 `FILE*`与它一起工作的函数（`fopen()`等`fread()`）是一个很好的例子，说明了如何在 C 中应用封装来建立接口。（当然，由于 C 缺少访问说明符，你不能强制没有人在里面偷看 a `struct FILE`，但只有受虐狂才会这样做。）

如有必要，可以使用函数指针表在 C 中实现多态行为。是的，语法很丑但是效果和虚函数一样：

```
struct IAnimal {
    int (*eat)(int food);
    int (*sleep)(int secs);
};

/* "Subclass"/"implement" IAnimal, relying on C's guaranteed equivalence
 * of memory layouts */
struct Cat {
    struct IAnimal _base;
    int (*meow)(void);
};

int cat_eat(int food) { ... }
int cat_sleep(int secs) { ... }
int cat_meow(void) { ... }

/* "Constructor" */
struct Cat* CreateACat(void) {
    struct Cat* x = (struct Cat*) malloc(sizeof (struct Cat));
    x->_base.eat = cat_eat;
    x->_base.sleep = cat_sleep;
    x->meow = cat_meow;
    return x;
}

struct IAnimal* pa = CreateACat();
pa->eat(42);                       /* Calls cat_eat() */

((struct Cat*) pa)->meow();        /* "Downcast" */ 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-03-19T13:16:51.747

所有好的答案。

我只会添加“最小化数据结构”。这在 C 中甚至可能更容易，因为如果 C++ 是“带类的 C”，那么 OOP 会试图鼓励您将每个名词/动词都放在脑海中，并将其转变为类/方法。这可能非常浪费。

例如，假设您有一组时间点的温度读数，并且您希望在 Windows 中将它们显示为折线图。Windows 有一条 PAINT 消息，当您收到它时，您可以循环执行 LineTo 函数的数组，并在将数据转换为像素坐标时缩放数据。

我完全见过太多次了，由于图表是由点和线组成的，人们会建立一个由点对象和线对象组成的数据结构，每个对象都可以进行 DrawMyself，然后使其持久化，理论上是以某种方式“更有效”，或者他们可能，只是可能，必须能够将鼠标悬停在图表的某些部分上并以数字方式显示数据，因此他们将方法构建到对象中来处理这个问题，当然，涉及创建和删除更多对象。

因此，您最终会得到大量可读性极强的代码，并且仅将 90% 的时间用于管理对象。

所有这些都是以“良好的编程实践”和“效率”的名义完成的。

至少在 C 语言中，简单、有效的方法会更加明显，而建造金字塔的诱惑力会不那么强烈。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-03-19T07:45:00.860

[GNU 编码标准](http://www.gnu.org/prep/standards/)已经发展了几十年。阅读它们是一个好主意，即使你没有完全按照它们来做。思考其中提出的要点可以为您构建自己的代码提供更坚实的基础。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-19T12:46:11.137

无论开发语言如何，封装始终是成功开发的关键。

我用来帮助在 C 中封装“私有”方法的一个技巧是不在“.h”文件中包含它们的原型。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-19T07:47:57.280

如果您知道如何用 Java 或 C++ 构建代码，那么您可以遵循与 C 代码相同的原则。唯一的区别是您身边没有编译器，您需要手动完成所有工作。

由于没有包和类，因此您需要从仔细设计模块开始。最常见的方法是为每个模块创建一个单独的源文件夹。您需要依靠命名约定来区分不同模块之间的代码。例如，在所有函数前面加上模块的名称。

您不能使用 C 来创建类，但您可以轻松实现“抽象数据类型”。您为每种抽象数据类型创建一个 .C 和 .H 文件。如果您愿意，可以有两个头文件，一个是公共的，一个是私有的。这个想法是所有需要导出的结构、常量和函数都转到公共头文件。

你的工具也很重要。C 语言的一个有用工具是[lint](http://en.wikipedia.org/wiki/Lint_programming_tool)，它可以帮助您发现代码中的异味。您可以使用的另一个工具是 Doxygen，它可以帮助您生成[文档](http://www.doxygen.org/)。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-19T07:27:42.307

我建议您查看任何流行的开源 C 项目的代码，例如……嗯……Linux 内核或 Git；看看他们是如何组织的。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-03-19T07:28:59.183

复杂应用的数字规则：它应该易于阅读。

为了使复杂的应用程序更简单，我采用[了分而治之](http://en.wikipedia.org/wiki/Divide_and_conquer_algorithm)。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2011-09-13T06:53:18.897

我建议首先阅读 C/C++ 教科书。例如，C Primer Plus 是一个很好的参考。浏览这些示例将为您提供有关如何将您的 java OO 映射到更程序化的语言（如 C）的想法。

# asp.net - 配置错误

> ID：661309
> 
> 赞同：1
> 
> 时间：2009-03-19T07:23:11.503
> 
> 标签：asp.net, configuration, web-config

运行我的 asp.net 应用程序时出现以下错误。

## “/ASPMassShop”应用程序中的服务器错误。

> “配置错误描述：处理此请求所需的配置文件时发生错误。请查看下面的具体错误详细信息并适当修改您的配置文件。
> 
> 解析器错误消息：不允许子节点。

源错误：

```
Line 126:       <compilers>
Line 127:           <compiler language="c#;cs;csharp" extension=".cs" warningLevel="4" type="Microsoft.CSharp.CSharpCodeProvider, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
Line 128:               <providerOption name="CompilerVersion" value="v3.5"/>
Line 129:               <providerOption name="WarnAsError" value="false"/>
Line 130:           </compiler> 
```

源文件：D:\ASPMass_Source.0.1\ASPMassShop\web.config 行：128

* * *

版本信息：Microsoft .NET Framework 版本：2.0.50727.42；ASP.NET 版本：2.0.50727.42"

以下是我的 web.config

```
<?xml version="1.0"?>
<configuration>
    <configSections>
        <section name="RewriterConfig" type="URLRewriter.Config.RewriterConfigSerializerSectionHandler, URLRewriter"/>
        <sectionGroup name="system.web.extensions" type="System.Web.Configuration.SystemWebExtensionsSectionGroup, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
            <sectionGroup name="scripting" type="System.Web.Configuration.ScriptingSectionGroup, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
                <section name="scriptResourceHandler" type="System.Web.Configuration.ScriptingScriptResourceHandlerSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="MachineToApplication"/>
                <sectionGroup name="webServices" type="System.Web.Configuration.ScriptingWebServicesSectionGroup, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
                    <section name="jsonSerialization" type="System.Web.Configuration.ScriptingJsonSerializationSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="Everywhere"/>
                    <section name="profileService" type="System.Web.Configuration.ScriptingProfileServiceSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="MachineToApplication"/>
                    <section name="authenticationService" type="System.Web.Configuration.ScriptingAuthenticationServiceSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="MachineToApplication"/>
                    <section name="roleService" type="System.Web.Configuration.ScriptingRoleServiceSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="MachineToApplication"/>
                </sectionGroup>
            </sectionGroup>
        </sectionGroup>
    </configSections>
    <RewriterConfig>
        <Rules>
            <RewriterRule>
                <LookFor>^/default\.aspx$</LookFor>
                <SendTo>/default.aspx</SendTo>
            </RewriterRule>
            <RewriterRule>
                <LookFor>^/([a-zA-Z0-9-]+)\.aspx$</LookFor>
                <SendTo>/Categories/Category.aspx?Category=$1</SendTo>
            </RewriterRule>
            <RewriterRule>
                <LookFor>^/([a-zA-Z0-9-]+)/([0-9]+)\.aspx$</LookFor>
                <SendTo>/Categories/Category.aspx?Category=$1&amp;PageID=2</SendTo>
            </RewriterRule>
            <RewriterRule>
                <LookFor>^/([a-zA-Z0-9-]+)/([0-9]+)/(NameDown|NameUp|PriceDown|PriceUp)\.aspx$</LookFor>
                <SendTo>/Categories/Category.aspx?Category=$1&amp;PageID=$2&amp;Sort=$3</SendTo>
            </RewriterRule>
            <RewriterRule>
                <LookFor>^/([a-zA-Z0-9-]+)/([a-zA-Z0-9-]+)\.aspx$</LookFor>
                <SendTo>/Products/Product.aspx?Category=$1&amp;Item=$2</SendTo>
            </RewriterRule>
        </Rules>
    </RewriterConfig>
    <appSettings>
        <add key="SiteName" value="ASPMass Shopping Cart"/>
        <add key="SiteUrl" value="http://localhost:3156"/>
        <add key="SiteDir" value="E:\work\ASPMass\ASPMassShop"/>
        <add key="Currency" value="USD"/>
        <add key="ProductsPerPage" value="10"/>
        <add key="PayPal_Email" value="yourpaypalemail@youremail.com"/>
        <add key="PayPal_Return" value="http://localhost:2324/Orders/OrderStep4.aspx"/>
        <add key="PayPal_Cancel" value="http://localhost:3156/Orders/Payment/Payment.aspx?Payment=PayPal"/>
        <add key="PayPal_Currency" value="USD"/>
        <add key="PayPal_URL" value="https://www.sandbox.paypal.com/cgi-bin/webscr"/>
        <add key="MaxTopProducts" value="100"/>
        <add key="Version" value="0.2"/>
        <add key="ActivateNewUsers" value="True"/>
        <add key="SearchExpiration" value="1440"/>
        <add key="CatImgWidth" value="40"/>
        <add key="CatImgHeight" value="40"/>
        <add key="ManufImgWidth" value="70"/>
        <add key="ManufimgHeight" value="30"/>
        <add key="SMTPServer" value="localhost"/>
        <add key="SMTPPort" value="25"/>
        <add key="SMTPUser" value="admin"/>
        <add key="SMTPPass" value="admin"/>
        <add key="NewsletterEmail" value="no_reply@aspmass.com"/>
    </appSettings>
    <connectionStrings>
        <!--<add name="CartDBConnection" connectionString="Data Source=HAMBUGADA\SQLEXPRESS;Initial Catalog=ASPMass;Integrated Security=True" providerName="System.Data.SqlClient"/>-->
        <add name="ConnStr" connectionString="Data Source=GRAPHIX\SQLEXPRESS;Initial Catalog=GltzCartData;Integrated Security=True " providerName="System.Data.SqlClient"/>
    </connectionStrings>
    <system.web>
        <siteMap>
            <providers>
                <add name="AdminSiteMap" type="System.Web.XmlSiteMapProvider" siteMapFile="~/Admin/Admin.sitemap"/>
            </providers>
        </siteMap>
        <!-- 
            Set compilation debug="true" to insert debugging 
            symbols into the compiled page. Because this 
            affects performance, set this value to true only 
            during development.
        -->
        <compilation debug="true">
            <assemblies>
                <add assembly="System.Core, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
                <add assembly="System.Data.DataSetExtensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
                <add assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
                <add assembly="System.Xml.Linq, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
            </assemblies>
        </compilation>
        <!--
            The <authentication> section enables configuration 
            of the security authentication mode used by 
            ASP.NET to identify an incoming user. 
        -->
        <authentication mode="Windows"/>
        <!--
            The <customErrors> section enables configuration 
            of what to do if/when an unhandled error occurs 
            during the execution of a request. Specifically, 
            it enables developers to configure html error pages 
            to be displayed in place of a error stack trace.

        <customErrors mode="RemoteOnly" defaultRedirect="GenericErrorPage.htm">
            <error statusCode="403" redirect="NoAccess.htm" />
            <error statusCode="404" redirect="FileNotFound.htm" />
        </customErrors>
        -->
        <pages theme="Front_BlueTheme">
            <controls>
                <add tagPrefix="asp" namespace="System.Web.UI" assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
                <add tagPrefix="asp" namespace="System.Web.UI.WebControls" assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
            </controls>
        </pages>
        <httpHandlers>
            <remove verb="*" path="*.asmx"/>
            <add verb="*" path="*.asmx" validate="false" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
            <add verb="*" path="*_AppService.axd" validate="false" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
            <add verb="GET,HEAD" path="ScriptResource.axd" type="System.Web.Handlers.ScriptResourceHandler, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" validate="false"/>
        </httpHandlers>
        <httpModules>
            <add name="ScriptModule" type="System.Web.Handlers.ScriptModule, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
            <add type="URLRewriter.ModuleRewriter, URLRewriter" name="ModuleRewriter"/>
        </httpModules>
    </system.web>
    <system.codedom>
        <compilers>
            <compiler language="c#;cs;csharp" extension=".cs" warningLevel="4" type="Microsoft.CSharp.CSharpCodeProvider, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
                <providerOption name="CompilerVersion" value="v3.5"/>
                <providerOption name="WarnAsError" value="false"/>
            </compiler>
        </compilers>
    </system.codedom>
    <!-- 
        The system.webServer section is required for running ASP.NET AJAX under Internet
        Information Services 7.0\.  It is not necessary for previous version of IIS.
    -->
    <system.webServer>
        <validation validateIntegratedModeConfiguration="false"/>
        <modules>
            <remove name="ScriptModule"/>
            <add name="ScriptModule" preCondition="managedHandler" type="System.Web.Handlers.ScriptModule, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
        </modules>
        <handlers>
            <remove name="WebServiceHandlerFactory-Integrated"/>
            <remove name="ScriptHandlerFactory"/>
            <remove name="ScriptHandlerFactoryAppServices"/>
            <remove name="ScriptResource"/>
            <add name="ScriptHandlerFactory" verb="*" path="*.asmx" preCondition="integratedMode" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
            <add name="ScriptHandlerFactoryAppServices" verb="*" path="*_AppService.axd" preCondition="integratedMode" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
            <add name="ScriptResource" preCondition="integratedMode" verb="GET,HEAD" path="ScriptResource.axd" type="System.Web.Handlers.ScriptResourceHandler, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
        </handlers>
    </system.webServer>
    <runtime>
        <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
            <dependentAssembly>
                <assemblyIdentity name="System.Web.Extensions" publicKeyToken="31bf3856ad364e35"/>
                <bindingRedirect oldVersion="1.0.0.0-1.1.0.0" newVersion="3.5.0.0"/>
            </dependentAssembly>
            <dependentAssembly>
                <assemblyIdentity name="System.Web.Extensions.Design" publicKeyToken="31bf3856ad364e35"/>
                <bindingRedirect oldVersion="1.0.0.0-1.1.0.0" newVersion="3.5.0.0"/>
            </dependentAssembly>
        </assemblyBinding>
    </runtime>
</configuration> 
```

我必须在哪里进行更改才能使我的应用程序运行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-19T07:30:09.727

`providerOption`不允许在 web.config 的编译器标记中作为子节点。

```
<system.codedom>
    <compilers>
            <compiler language="c#;cs;csharp" extension=".cs" warningLevel="4" type="Microsoft.CSharp.CSharpCodeProvider, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
                    <providerOption name="CompilerVersion" value="v3.5"/>
                    <providerOption name="WarnAsError" value="false"/>
            </compiler>
    </compilers>
</system.codedom> 
```

请参阅此处的 .NET 3.5 框架[的 MSDN 文档。](http://msdn.microsoft.com/en-us/library/a15ebt6c(VS.80).aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-19T07:32:19.673

错误页面几乎可以告诉您错误所在的位置以及导致错误的原因。

我认为这不是框架 2.0 版中`providerOption`元素的有效子元素。`compiler`从您发布的信息中可以明显看出您的应用程序已映射到 2.0 版。如果这是一个问题，您应该考虑将脚本映射重新映射到 v. 3.x。

AFAIK，此元素仅在 .NET v3.x 及更高版本中可用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-02T18:57:02.367

我刚刚发布了这个问题，然后，在我咬紧牙关之后，[我的解决方案](https://stackoverflow.com/questions/12680320/publishing-asp-net-3-5-site-leaves-web-config-empty-due-to-provideroptions-eleme/12696437#12696437)。简而言之，3.5 站点需要将提供程序选项元素标记为三五，服务器模式文件由于某种原因没有有效，将您自己的文件放在它旁边，它似乎正在工作。

# asp.net - Asp.net 网格视图

> ID：661311
> 
> 赞同：1
> 
> 时间：2009-03-19T07:23:34.453
> 
> 标签：asp.net, vb.net

在我的网格视图中，当单击一个按钮时，我想将该行插入到数据库中，同时使该行在网格视图中不可见。我可以插入数据库，但不能使插入的行不可见。

```
 Dim PayID As Integer = (e.CommandArgument)
        Dim EmpID As Integer = (e.CommandArgument)
        Dim EID As Integer = CType(Dg1.DataKeys(EmpID).Values("EmpID"), Integer)
        Dim PID As Integer = CType(Dg1.DataKeys(PayID).Values("PayID"), Integer)

        cmd.CommandText = "Insert into EmployDetails(EmpID,PayID,PayDate) 
        Values(" & EID & " ," & PID & ",GetDate())"
        cmd.ExecuteNonQuery() 
```

谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T07:28:28.327

您可能需要将 GridView 绑定到[DataView](http://msdn.microsoft.com/en-us/library/system.data.dataview.aspx)而不是 DataSet。然后，当您添加一行时，更新 DataView 以排除新行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T07:39:59.873

将行插入数据库后，您应该从数据源（数据表、数据视图）中删除相关记录并重新绑定您的网格视图。

**编辑 ：**

插入操作后：

**1.**从数据源中删除相关行：

```
Dim insertedRows As DataRow() = myDataTable.Select("ID = " & id)

For Each dr As DataRow In insertedRows

    myDataTable.Rows.Remove(dr)

Next 
```

**2.**然后重新绑定你的gridview：

```
gridView.DataSource = myDataTable
gridView.DataBind() 
```

注意：我使用转换器将代码 C# 转换为 VB。希望没事。

# database-design - 如何最好地避免多次插入？

> ID：661314
> 
> 赞同：0
> 
> 时间：2009-03-19T07:24:48.600
> 
> 标签：database-design, windows-services

我有一个监视目录更改的服务应用程序。

服务应用程序将密切监视目录。这是它的工作方式：

1.  睡眠 X 分钟
2.  扫一扫目录，看看有没有新增
3.  每次添加启动一个线程
4.  重复 1-3

它所做的一件事是将记录插入数据库。现在，由于多个线程可以同时运行，完全有可能两个线程同时插入记录。

我想避免这种同时插入；相反，我希望这些插入排队，这意味着只有 1 个线程可以在单个时间点访问数据库。当区域已经有1个线程访问数据库时，其他服务无法访问数据库。

***我想要这个的原因是因为在电力激增的情况下，我只丢失了一笔交易，而不是很多。***

**我正在考虑使用锁定数据库事务的锁定语句。这是最好的方法吗？**

P/S：我正在编写一个与 MySQL 数据库对话的 .Net 服务。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T08:47:24.127

数据库旨在允许多个进程同时插入数据，所以我看不到您的问题。你有错误吗？

[编辑] 你害怕电涌。在哪里？在服务器还是客户端？以下是您的选择：

1.  服务器崩溃。只需让客户端检查“连接丢失”的错误代码并让他们重试插入，直到成功。要找出此错误代码，请在插入过程中关闭服务器或拔出客户端的网络电缆（或两者兼而有之；有时，由于意外的网络问题，您会收到不同的错误）。

2.  客户端崩溃（更有可能，因为客户端通常是便宜的 PC。如果用户可以访问它，它最终会感染病毒或文件系统将损坏，它会耗尽 RAM，有人会安装一些“很酷”的东西“这会破坏一个重要的 DLL，或者诸如此类的东西）。在这种情况下，您必须再次启动客户端，检查已插入的内容（使用应用程序密钥）并从那里继续。

应用程序键是与您的业务流程相关的行的 ID。例如，如果您销售卡片，则应用密钥可以是汽车名称和客户名称加上时间戳。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T07:35:03.643

我会先看看你为什么要这样做。通常应用程序是这样运行的，2 个客户端同时进行插入没有问题（好吧，除了代码中的错误方法）。

此外，解决方案会因场景而异。一种选择是拥有一个 microsoft 消息队列 (MSMQ)，并将插入从这些服务中移出，因此插入的负载由从队列中读取的进程控制。

**更新 1：**我仍然不明白为什么要避免插入并行运行（以及从我认为其他人所做的其他回复中读到的内容）。我将引用您对此的两条评论：

> 我想要这个的原因是因为在电力激增的情况下，我只丢失了一笔交易，而不是很多。

蚂蚁另一个：

> 这是因为在插入之前，还有其他需要并行性的冗长作业。只有在插入期间，才需要顺序访问。

如果我单独阅读第一个，我实际上会认为这是希望它们并行的原因。您希望尽快完成它们。顺序执行实际上会增加插入的时间，因此会有更多的时间发生电涌。

阅读第二个，它让我认为您可能更关心这些进程并行运行以及插入未进入数据库的影响。这再次意味着您希望尽快完成插入操作，因此不是按顺序执行插入操作的理由。

对于内置支持，您可能有一个分布式事务的案例，其中还包括文件系统（ms 正在查看文件系统的东西，但我不记得他们是否曾经在较新的操作系统上做过什么）。但是，分布式事务的设置有点痛苦（msdtc 和对其使用的端口的访问）。

我遵循的一条好路径是向流程添加更多信息，以便能够判断失败的位置。您甚至可能还没有编写自动恢复过程的代码，但至少您知道您将获得肯定知道出现问题的信息。

最简单的方法是在进程开始时插入，并在完成时有一个标志来表示。如果这是一个长时间运行的过程，您可能希望拥有更像是您不断更新的状态的东西，以便能够判断它在哪一步失败。另一种方法是将状态写入文件系统。

无论如何，它只会告诉您最后一步成功完成，而不是当前步骤是否能够完成。这就是使重试逻辑更加复杂的原因，因为您不能只在它停止的地方继续，您必须检查最后一步是否完成，这取决于每个步骤。

附言。如果是上述情况，很难从问题中分辨出来。您可能想就长时间运行的进程和/或自动重试提出不同的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T14:54:31.030

我认为这里最好的选择是遵循 Aaron 的建议，并在处理每个文件后让线程报告；然后从单线程“管理器”类更新数据库。

如果这不是一个选项，您可以在更新数据库的代码周围使用锁定/同步锁定。

但是，您的一条评论说有多个服务正在运行。真的吗？多个 Windows 服务监视同一个目录和多线程处理？为什么？我认为，您必须更好地捍卫该架构才能获得更好的响应。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-20T09:01:49.597

正如许多人之前所说：这是一件坏事。它会人为地制造瓶颈。

但如果你真的想这样做，这里有你的选择：

a) 在表上创建一个主键。无论如何，您都应该这样做以获得干净的数据库设计。为了检查 PK 的有效性，数据库必须使用锁定，这将强制您插入到序列中。

b) 如果 a) 不足以满足您的目的，您应该使用单独的锁。根据您的环境，可能会有一个特殊的 api（例如 java 并发 api）。

c) 如果这不可用或者您不喜欢它，您可以使用数据库的锁定机制：创建一个只有一行的表。在每次插入时执行以下操作： - 阅读特殊表“更新”。这将（在大多数数据库设置中）阻止任何其他会话执行相同操作。- 做插入。- 犯罪。这将释放锁定并允许下一个会话继续。

提醒一下：这与人们试图正常实现的目标完全相反：允许尽可能多的线程在不受干扰的情况下工作

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-19T14:00:05.560

为什么要为每个插入创建一个新线程？为什么不简单地循环插入？只有在需要并行性时才需要线程；在您的情况下，这似乎与您想要的完全相反。

[编辑]

> 这是因为在插入之前，还有其他需要并行性的冗长作业。只有在插入期间，才需要顺序访问。

然后让这些线程报告给收集结果并将它们插入循环的主线程。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-19T07:35:13.537

如果您安装了多个 Windows 服务来监视同一个文件夹，或者如果您有一个多线程的 Windows 服务，那么您将获得多个同时插入。否则你不必担心。

# jquery - 页面刷新时的 jQuery 弹出菜单

> ID：661319
> 
> 赞同：0
> 
> 时间：2009-03-19T07:26:19.687
> 
> 标签：jquery, popup, refresh

我使用 jQuery 插件开发了一个 PopupMenu。

单击 HTML 按钮时，应出现 PopupMenu。

页面刷新时是否可以这样做？
我将如何在 jQuery 中执行此操作？

```
$(document).ready(function() {
    $('area').bind("click",function(e){
        //popupcode
    });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T07:30:14.500

那不行吗？

```
$(document).ready(function() {
              $('area').bind("click",function(e){

                      //popupcode
                });
              //popupcode
       }); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-19T07:35:10.883

添加

```
$('area').click(); 
```

在绑定后触发事件:)

# java - 如何使用 Eclipse 启动将本机库添加到“java.library.path”（而不是覆盖它）

> ID：661320
> 
> 赞同：96
> 
> 时间：2009-03-19T07:26:48.297
> 
> 标签：java, eclipse, path, java.library.path

我有一个需要添加到*java.library.path*的本机库。使用 JVM 参数*-Djava.library.path=path...*我可以根据需要设置路径。

我的问题是我的其他库（pentaho 报告）根据默认的 java.library.path（包括系统目录等）搜索字体，并且手动设置会覆盖默认路径。

所以：我怎样才能**将**路径条目添加到默认的 java.library.path 而不是覆盖它（这似乎是用 -Djava.library.path 完成的）？（我不想手动添加默认路径，这对部署不利）

编辑：抱歉缺少细节；我正在使用 Eclipse。（部署是用 JNLP 完成的，我可以 在*资源下使用**nativelib*）

 ** * *

## 回答 #1

> 赞同：49
> 
> 时间：2010-02-22T08:44:35.357

忘记了这个问题......我实际上是在向 Eclipse 询问，很抱歉最初没有说明这一点。答案似乎太简单了（至少在 3.5 中；也可能在旧版本中）：

Java 运行配置的参数：VM 参数：

```
-Djava.library.path="${workspace_loc:project}\lib;${env_var:PATH}" 
```

一定不要忘记引号，否则PATH中的空格有问题。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2010-01-24T18:48:42.010

如果您想在不干扰`java.library.path`Eclipse 的开发时添加本机库（以避免包含绝对路径和必须向启动配置添加参数），您可以在*Java Build中为每个 Jar 提供本机库位置的路径本**机库位置下的**路径*对话框。请注意，本机库文件名必须与 Jar 文件名相对应。另请参阅此[详细说明](http://www.eclipsezone.com/eclipse/forums/t49342.html)。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-19T08:45:18.797

SWT 将必要的本地 DLL 放入 JAR。搜索“org.eclipse.swt.win32.win32.x86_3.4.1.v3449c.jar”作为示例。

DLL 必须位于 JAR 的根目录中，必须对 JAR 进行签名，并且 DLL 必须与 META-INF/MANIFEST.MF 中的校验和一起出现，以便 VM 获取它们。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-24T09:54:40.397

在 Windows 中，像这样：

-Djava.library.path="C:/MyLibPath;%PATH%"

%PATH% 是你的旧 -Djava.library.path

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-19T08:36:20.423

您可以通过以编程方式调用[System.load()](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/System.html#load(java.lang.String))来加载您的本机库来解决这个问题吗？此方法（与[System.loadLibrary()](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/System.html#loadLibrary(java.lang.String))不同）允许您指定绝对路径。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-09-09T01:01:48.653

在 UNIX 系统中，您可以附加到 LD_LIBRARY_PATH 环境变量。在 Windows 上，JVM 自动将系统属性 java.library.path 设置为 PATH；所以如果 dll 在你的 PATH 上，那么你就设置好了。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-02-21T14:17:22.033

[https://bugs.eclipse.org/bugs/show_bug.cgi?id=102239](https://bugs.eclipse.org/bugs/show_bug.cgi?id=102239)声明在 Eclipse 的启动器中没有实现替代机制，至少在发布 Juno 之前没有实现。

因此，在没有事先了解默认设置的情况下启动 Eclipse 时，（几乎）不可能将另一个库文件夹附加或预先添加到 java.library.path。

我写的差不多，因为应该可以让 Eclipse 启动，转储 java.library.path 的内容，并在一个命令中停止 Eclipse。转储将被解析，然后作为启动 Eclipse 的输入，即

```
#!/bin/bash
# get default value of java.library.path (somehow)
default_lib_path=$( start_dump_stop_eclipse_somehow )  

# now launch Eclipse
eclipse --launcher.appendVmargs \
         -vmargs \
         -Djava.library.path="/my/native/lib/folder:${default_lib_path}" 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-11-26T08:20:10.550

窗口->首选项->Java->已安装的 JRE。然后选择您当前的 JRE(JDK) 并单击编辑。填充默认 VM 参数：-Djava.library.path=/usr/local/xuggler/lib。完毕！

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-07-15T11:44:04.627

Rob Elsner 在上述评论之一中提供的解决方案完美运行（OSX 10.9，Eclipse Kepler）。必须将它们的附加路径附加到以“：”分隔的路径。

> 您也可以使用 ${system_property:java.library.path} – Rob Elsner 2010 年 11 月 22 日 23:01

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-05-19T22:05:52.283

1.  在 Windows 上：将库的路径添加到 PATH 环境变量。
2.  在 Linux 上：将库的路径添加到 LD_LIBRARY_PATH 环境变量。
3.  在 Mac 上：将库的路径添加到 DYLD_LIBRARY_PATH 环境变量。

`java.library.path`在其相应平台上使用上述变量的值进行初始化。

这应该适用于任何 IDE。

您可以通过调用来测试该值是否是您所期望的`java -XshowSettings:properties`

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-07-09T07:25:24.660

本机库文件名必须与 Jar 文件名相对应。这是非常非常重要的。请确保 jar 名称和 dll 名称相同。另外，请参阅 Fabian Steeg 的帖子 我下载的下巴包含不同的 dll 和 jar 名称。它是jawin.jar 和jawin **d** .dll，请注意dll 文件名中的额外“d”。我只是将它重命名为jawin.dll，并将其设置为 Eclipse 中的本机库，如帖子“ [http://www.eclipsezone.com/eclipse/forums/t49342.html](http://www.eclipsezone.com/eclipse/forums/t49342.html) ”中所述

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-12-09T16:06:28.930

出于某种原因，我无法让多个文件夹工作（它确实有一段时间，但只要我需要更多 dll 并添加更多文件夹，路径中没有空格）。然后我将所有需要的 dll 复制到一个文件夹中，并将其作为我的*java.library.path*并且它有效。我没有解释-如果有人这样做，那就太好了。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-03-26T22:28:06.407

许多现有答案假设您想为特定项目设置它，但我需要为 Eclipse*本身*设置它以支持 SQL Server JDBC 驱动程序的集成身份验证。

为此，我按照[这些说明](http://wiki.eclipse.org/Starting_Eclipse_Commandline_With_Equinox_Launcher)从 Java 命令行而不是其普通启动器启动 Eclipse。然后我只是修改了该脚本以将我的 -Djava.library.path 参数添加到 Java 命令行。

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2013-08-08T19:46:26.080

在 Windows 上，我发现重要的是**从命令行**而不是从“开始”菜单或快捷方式启动 Eclipse，前提是本机 DLL 位于 PATH 中的目录中。显然，这确保了正确的目录位于路径上。

# c++ - 适用于 GNU C++ 的 SSE SSE2 和 SSE3

> ID：661338
> 
> 赞同：56
> 
> 时间：2009-03-19T07:32:22.857
> 
> 标签：c++, optimization, simd, sse, sse2

是否有一个简单的教程让我在 GNU C++ 中快速掌握 SSE、SSE2 和 SSE3？如何在 SSE 中进行代码优化？

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2009-03-19T13:43:18.267

抱歉不知道教程。

您最好的选择（恕我直言）是通过英特尔提供的“内在”功能使用 SSE 来包装（通常）单个 SSE 指令。这些是通过一组名为 *mmintrin.h 的包含文件提供的，例如 xmmintrin.h 是原始 SSE 指令集。

开始熟悉 Intel 优化[参考手册](https://www.intel.com/content/dam/www/public/us/en/documents/manuals/64-ia-32-architectures-optimization-manual.pdf)的内容是一个好主意（参见第 4.3.1.2 节的内在函数示例），SIMD 部分是必不可少的阅读材料。指令集参考手册也很有帮助，因为每条指令的文档都包含它对应的“内在”功能。

*一定要花一些时间检查编译器从内在函数生成的汇编程序（你*会学到很多东西）和分析/性能测量（你会避免浪费时间 SSE-ing 代码而几乎没有回报）。

**2011 年 5 月 31 日更新： Agner Fog 的**[优化 PDF](http://agner.org/optimize/)中有一些非常好的内在函数和矢量化覆盖（[谢谢](https://stackoverflow.com/questions/695222/code-optimization-bibles/695293#695293)），尽管它有点分散（例如第一个的第 12[节和](http://agner.org/optimize/optimizing_cpp.pdf)[第二个](http://agner.org/optimize/optimizing_assembly.pdf)的第 5 节）。这些并不完全是教程材料（实际上有“这些手册不适合初学者”警告），但它们确实正确地将 SIMD（无论是通过 asm、内在函数还是编译器矢量化使用）视为更大优化工具箱的一部分。

**2012-10-04 更新：**一篇关于 gcc 向量内在函数的[Linux Journal 小文章](http://www.linuxjournal.com/content/introduction-gcc-compiler-intrinsics-vector-processing)值得一提。比 SSE 更通用（也包括 PPC 和 ARM 扩展）。[最后一页](http://www.linuxjournal.com/content/introduction-gcc-compiler-intrinsics-vector-processing?page=0,4)有很多参考资料，这让我注意到英特尔的[“内在指南”](https://www.intel.com/content/www/us/en/docs/intrinsics-guide/index.html)。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-03-24T15:00:54.397

最简单的优化是允许 gcc 发出 SSE 代码。

标志：`-msse`, `-msse2`, `-msse3`, `-march=`,`-mfpmath=sse`

有关 386 个选项的更简洁列表，请参阅[http://gcc.gnu.org/onlinedocs/gcc-4.3.3/gcc/i386-and-x86_002d64-Options.html#i386-and-x86_002d64-Options](http://gcc.gnu.org/onlinedocs/gcc-4.3.3/gcc/i386-and-x86_002d64-Options.html#i386-and-x86_002d64-Options)，更准确您的特定编译器版本的文档在那里： http: [//gcc.gnu.org/onlinedocs/](http://gcc.gnu.org/onlinedocs/)。

对于优化，请始终查看 Agner Fog 的：[http](http://agner.org/optimize/) ://agner.org/optimize/ 。我认为他没有内在函数的 SSE 教程，但他有一些非常巧妙的 std-c++ 技巧，并且还提供了很多关于编码 SSE 程序集的信息（通常可以转录为内在函数）。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-19T07:37:07.773

查看`-mtune`和`-march`选项，`-msse*`当然`-mfpmath`还有。所有这些都使 GCC 能够进行特定于 SSE 的优化。

恐怕任何超出此范围的都是汇编程序的领域。

[GCC 在线手册 - i386 和 x86_64 选项](http://gcc.gnu.org/onlinedocs/gcc-4.3.3/gcc/i386-and-x86_002d64-Options.html#i386-and-x86_002d64-Options)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-08-18T22:23:19.433

MSDN 对 SSE 编译器内置插件有很好的描述（这些内置插件是事实上的标准，它们甚至可以在 clang/XCode 中工作）。

*   [https://docs.microsoft.com/en-us/cpp/intrinsics/compiler-intrinsics](https://docs.microsoft.com/en-us/cpp/intrinsics/compiler-intrinsics)
*   [https://docs.microsoft.com/en-us/previous-versions/visualstudio/visual-studio-2010/kcwz153a(v=vs.100)](https://docs.microsoft.com/en-us/previous-versions/visualstudio/visual-studio-2010/kcwz153a(v=vs.100))

该引用的好处是它显示了等效的伪代码，因此您可以了解到[ADDPD](http://msdn.microsoft.com/en-us/library/7xzea3d6.aspx)指令是：

```
r0 := a0 + b0
r1 := a1 + b1 
```

这里有一个神秘的洗牌指令的很好的描述：http: [//www.songho.ca/misc/sse/sse.html](http://www.songho.ca/misc/sse/sse.html)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-19T07:37:52.843

一个简单的教程？从来没听说过。

但是任何关于使用 MMX 或任何版本的 SSE 的信息都将有助于学习，无论是 GCC 还是 ICC 或 VC。

要了解 GCC 的向量扩展，请输入“info gcc”并转到节点：向量扩展。

# c++ - 将工程应用程序从独立移动到内部到 CAD

> ID：661346
> 
> 赞同：4
> 
> 时间：2009-03-19T07:35:31.600
> 
> 标签：c++, mfc, cad

我有一个大型 MFC C++ 应用程序，我很想将它移植到 AutoCAD 和 IntelliCAD 中。AutoDesk 为此提供了 Object ARX，它取代了较旧且速度较慢的 ADS 技术。IntelliCAD，afaik 仅支持 ADS。有没有人做过这个，如果有的话，你使用了哪些工具，你遇到了什么陷阱？

我对能够简化过渡的资源特别感兴趣，并允许我在未来保持单独的基于 CAD 的版本和独立版本。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T03:02:07.300

看看我对之前几个 AutoCAD 问题的回答

[C# 中的开源 cad 绘图 (dwg) 库](https://stackoverflow.com/questions/169390/open-source-cad-drawing-dwg-library-in-c/206456#206456)

[.Net CAD 组件，可以读取/写入 dxf/dwg 文件](https://stackoverflow.com/questions/298622/-net-cad-component-that-can-read-write-dxf-dwg-files/300824#300824)

如果您正在寻找在 AutoCAD 内部和外部工作的相同代码库，那么 RealDWG 方法可能对您有用，因为代码是相同的 - RealDWG 不需要 AutoCAD 作为主机应用程序。开放的设计联盟库用于制作独立的应用程序。两者都支持 C++ 多年并且可以被认为是稳定的——嗯，和 CAD 一样稳定。

这个博客 ( [http://through-the-interface.typepad.com/](http://through-the-interface.typepad.com/) ) 是 RealDWG 的好博客

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-08-19T15:04:12.477

要考虑的一种选择是针对 AutoCAD 和 Bricscad。支持 AutoCAD 和 IntelliCAD 基本上需要两个版本的代码。Bricscad 的目标是与 ObjectARX 完全兼容，根据我的经验，它们非常接近。

这至少将问题从支持三个实例（您的独立版本、AutoCAD 和 IntelliCAD）简化为支持两个实例（您的独立版本和 AutoCAD/Bricscad）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-26T13:38:36.357

“DWGdirect 不仅仅是一个用于读取和写入 DWG 文件的 SDK。它实际上提供了一个完整的框架，可用于开发专业的 CAD 应用程序，包括插件架构等。” [报价来源](http://www.deelip.com/2009/03/opencad-my-first-book.html)

# visual-studio - Visual Studio/C++：如何关闭某些第一次机会异常调试消息？

> ID：661356
> 
> 赞同：11
> 
> 时间：2009-03-19T07:39:53.570
> 
> 标签：visual-studio, exception, visual-c++, debugging, cgal

当我在调试模式下执行我的 C++ 代码（使用`CGAL`库）时，我在窗口中看到很多`Output`关于第一次机会异常的调试消息`CGAL::Uncertain_conversion_exception`。我知道什么是[第一次机会例外](http://support.microsoft.com/kb/105675)。

现在，我如何关闭这种异常 ( ) 的调试消息*的*显示`CGAL::Uncertain_conversion_exception`？

我喜欢尽可能详细的调试消息，但是一旦我知道某个异常是关于什么并且我已经处理了它，我希望它消失。例如，在这种情况下，CGAL 异常被[认为是幼稚](http://www.cgal.org/FAQ.html#uncertain_exception)的（并且信息丰富），而不是引起关注的原因。我想把它关掉，**但**仍然能够睁大眼睛留意任何其他（新的）第一次机会例外。这在 Visual Studio 2008 中可行吗？我要求太多了吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-11-03T07:59:54.570

我不认为有办法。

您可以右键单击输出窗口并禁用*所有*异常消息，但它不再具有过滤功能。

也就是说，如果您不顾一切，您可以保存输出，过滤它，然后使用添加到“工具”菜单的简单工具，将其转储回输出窗口（它出现在您的工具标题下方，而不是“调试” ）。我以前做过，但通常这太麻烦了，收益太少了。

* * *

## 回答 #2

> 赞同：-4
> 
> 时间：2009-03-19T08:29:13.437

我认为使用 VS2008 不可能做到这一点。但是，您可以使用[DbgView.exe](http://technet.microsoft.com/en-us/sysinternals/bb896647.aspx)并将过滤器设置为包含/排除要显示的字符串。

# caching - iBATIS 缓存不会在给定语句上刷新

> ID：661361
> 
> 赞同：0
> 
> 时间：2009-03-19T07:42:35.513
> 
> 标签：caching, ibatis

我正在使用 iBatis 进行数据库交互。最近我试图通过配置缓存来提高一些静态数据获取的性能。chache 已配置并正常工作，但是问题在于每当对该数据进行任何插入/更新/删除时都会刷新缓存数据。我为类别表做了以下配置，

```
<cacheModel  type="LRU" id="categoryCache"  readOnly="true" serialize="false">
    <flushOnExecute statement="insertCategory"/>
    <flushOnExecute statement="updateCategory"/>
    <flushOnExecute statement="deleteCategory"/>
    <property name="size" value="1000"/>
</cacheModel>

<insert id="insertCategory"
    parameterClass="com.uniplas.entity.master.beans.CategoryVO">
    insert into categories (code, description)
    values(#code:VARCHAR#,#description:VARCHAR#)
</insert>

<update id="updateCategory"
    parameterClass="com.uniplas.entity.master.beans.CategoryVO">
    update categories set description=#description:VARCHAR# where code=#code:VARCHAR#
</update>

<delete id="deleteCategory"
    parameterClass="com.uniplas.entity.master.beans.CategoryVO">
    delete from categories where code=#code:VARCHAR#
</delete>

<select id="selectCategory" resultMap="categoryResult"
    parameterClass="java.util.Map" cacheModel="categoryCache">
    select * from categories where 1=1
    <dynamic>
        <isNotEmpty property="categoryVO.code">
            and code like #categoryVO.code:VARCHAR#
        </isNotEmpty>
        <isNotEmpty property="categoryVO.description">
            and description like
            #categoryVO.description:VARCHAR#
        </isNotEmpty>
        <isNotEmpty property="orderBy">
            order by $orderBy$
        </isNotEmpty>

    </dynamic>
</select> 
```

现在的问题是，即使执行了任何 insertCategory / updateCategory / deleteCategory 语句，缓存也不会被刷新。它维护在插入/更新/删除之前选择的数据！

请让我知道我哪里出错了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-11-19T22:25:09.370

尝试将缓存设置为 readOnly="false" - 从文档中：

> 该框架支持只读和读/写缓存。只读缓存在所有用户之间共享，因此可以提供更大的性能优势。但是，不应修改从只读缓存读取的对象。相反，应该从数据库（或读/写缓存）中读取一个新对象以进行更新。另一方面，如果打算使用对象进行检索和修改，则建议使用读/写缓存（即必需）。要使用只读缓存，请在缓存模型元素上设置 readOnly=”true”。要使用读/写缓存，请设置 readOnly=”false”。默认值为只读 (true)。

# javascript - 正则表达式查找一段代码中的所有方法

> ID：661365
> 
> 赞同：1
> 
> 时间：2009-03-19T07:43:43.763
> 
> 标签：javascript, regex, parsing

我正在尝试编写一个正则表达式来匹配构造函数字符串中的所有 JavaScript 方法定义。

```
//These two should match
this.myMethod_1 = function(test){ return "foo" }; //Standard
this.myMethod_2 = function(test, test2){ return "foo" }; //Spaces before

//All of these should not
//this.myMethod_3 = function(test){ return "foo" }; //Comment shouldn't match
/**
 *this.myMethod_4 = function(test){ return "foo" }; //Block comment shouldn't match
 */

//       this.myMethod_5 = function(test){ return "foo" }; //Comment them spaces shouldn't match

/*
 *        this.myMethod_6 = function(test){ return "foo" }; //Block comment + spaces shouldn't match
 */

this.closure = (function(){ alert("test") })(); //closures shouldn't match 
```

正则表达式应匹配 ['myMethod_1', 'myMethod_2']。正则表达式不应匹配 ['myMethod_3', 'myMethod_5', 'myMethod_6', 'closure']。

这是我到目前为止所拥有的，但我对评论中出现的问题有疑问：

```
/(?<=this\.)\w*(?=\s*=\s*function\()/g 
```

我一直在使用这个很酷的[网站](http://gskinner.com/RegExr/)来测试它。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-19T07:50:02.500

正确地做到这一点听起来很复杂。您需要为此创建一个解析器，一个简单的正则表达式很可能不会成功。

[Narcissus 是一个很好的起点](http://mxr.mozilla.org/mozilla/source/js/narcissus/jsparse.js)，它是一个用 ... JavaScript 编写的 JavaScript 解析器。

它只有 1000 行代码。应该可以只提取其中的方法匹配部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T07:50:57.693

在开头添加一个`^\s*`可能会有所帮助。它并不完美，但它适用于您的测试用例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T08:11:49.827

一种正则表达式可能难以编写和调试。考虑编写几个正则表达式，每一行一个应该匹配以确认或拒绝一段代码。

例如，

```
/(?<=this.)\w*(?=\s*=\s*function()/g  // Matches a simple constructor.
/^\/\// // If it matches then this line starts with a comment. 
```

等等。

# iphone - 错误消息：MPMoviePlayerController 实例已在播放

> ID：661369
> 
> 赞同：2
> 
> 时间：2009-03-19T07:45:30.563
> 
> 标签：iphone, cocoa-touch

在我的应用程序中，我正在使用标准 MPMoviePlayerController 类播放应用程序中的视频。

第一次解决这个问题很好，但是在观看 1 个视频后，如果您尝试观看其他内容，则应用程序在 MPMoviePlayerController 的播放方法上崩溃并出现错误：

*** 由于未捕获的异常“MPMoviePlayerControllerPlaybackException”而终止应用程序，原因：“MPMoviePlayerController 实例已在播放”

我不知道为什么会这样。

我在另一个应用程序中有非常相似的代码，但我没有收到此错误。

我正在为设备编译 - 2.0 并在固件 2.2.1 的 iPhone 上运行它。

这是我的代码：

```
@synthesize movieURL;

- (void) setMovieAndPlay
{
    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    moviePath = [[[paths lastObject] stringByAppendingPathComponent:movieURL] retain];

    [self playVideoWithURL:[NSURL fileURLWithPath:moviePath]];
}

-(void)playMovieAtURL:(NSURL*)theURL
{
     MPMoviePlayerController *mMoviePlayer = [[MPMoviePlayerController alloc] initWithContentURL:theURL];
    mMoviePlayer.scalingMode = MPMovieScalingModeAspectFill;

     if ([defaults boolForKey:@"disableControls"])
     {
          mMoviePlayer.movieControlMode = MPMovieControlModeHidden;
     }

    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(moviePlayBackDidFinish:) name:MPMoviePlayerPlaybackDidFinishNotification object:mMoviePlayer];

    [mMoviePlayer play];
}

- (void) moviePlayBackDidFinish:(NSNotification*)notification
{
     MPMoviePlayerController *theMovie = [notification object];

     [[NSNotificationCenter defaultCenter] removeObserver:self name:MPMoviePlayerPlaybackDidFinishNotification object:theMovie];

     [theMovie release];
     theMovie = nil;

     NSDictionary *notiUserInfo = [notification userInfo];

     if (notiUserInfo != nil)
     {
          NSError *errorInfo = [notiUserInfo objectForKey:@"error"];

          if ([[errorInfo domain] isEqualToString:@"MediaPlayerErrorDomain"])
          {
               UIAlertView *notice = [[UIAlertView alloc] initWithTitle:@"Error" message:[errorInfo localizedDescription] delegate:self cancelButtonTitle:@"OK" otherButtonTitles:nil];
               [notice show];
               [notice release];

               return;
          }
     }

     if ([defaults boolForKey:@"autoRepeat"])
     {
          [self playMovieAtURL:[NSURL fileURLWithPath:moviePath]];
     }
     else
     {
          KFAppDelegate *appDelegate = (KFAppDelegate *)[[UIApplication sharedApplication] delegate];
          [appDelegate endMovie];
     }
}

- (void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex
{
    KFAppDelegate *appDelegate = (KFAppDelegate *)[[UIApplication sharedApplication] delegate];
    [appDelegate endMovie];
} 
```

更奇怪的是，如果你看代码，电影结束后我会检查用户是否启用了自动重复。

如果他们有，我只是重新开始这部电影，这很有效。

但是，如果他们没有启用自动重复并离开该课程，然后尝试观看另一部电影（或同一部电影），则会导致崩溃。

有谁知道为什么会发生这种情况？

难道我做错了什么？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T07:56:21.540

这是我的解决方案。我不得不使用 NSTimer 让下一次播放等待 1 秒，否则我会遇到每个人都在谈论的相同的纯音频问题。这是针对 2.2.1 的。

```
- (void) moviePlayBackDidFinish:(NSNotification*)notification
{
    [NSTimer scheduledTimerWithTimeInterval:1.0 target:self selector:@selector(playTrack) userInfo:nil repeats:NO];
}

- (void) playTrack {

[moviePlayer stop];
[[NSNotificationCenter defaultCenter] removeObserver:self name:MPMoviePlayerPlaybackDidFinishNotification object:moviePlayer];
[moviePlayer release];

    NSURL *nsUrl = [NSURL URLWithString:track.url];
    moviePlayer = [[MPMoviePlayerController alloc] initWithContentURL:nsUrl];

    // Register to receive a notification when the movie has finished playing. 
    [[NSNotificationCenter defaultCenter] addObserver:self 
                                             selector:@selector(moviePlayBackDidFinish:) 
                                                 name:MPMoviePlayerPlaybackDidFinishNotification 
                                               object:moviePlayer];
    [moviePlayer play];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T00:24:07.583

我认为在

```
- (void) moviePlayBackDidFinish:(NSNotification*)notification
{
    // you should add this:
    if (mMoviePlayer != nil) {
        // free the old movie player
        NSLog(@"releasing!");
        [mMoviePlayer release];
        [[NSNotificationCenter defaultCenter] removeObserver:self];
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-21T10:19:33.863

仅当您的 MPMoviePlayerController 对象尚未释放并且您正在尝试播放另一部电影时，您才会收到此错误。

创建 MPMoviePlayerController 的实例变量并在您的代码中使用它。所以而不是

```
theMovie = [notification object];
[theMovie release];
theMovie = nil; 
```

使用实例变量并在 playMovieAtURL 和playbackDidFinish 方法中使用它。我的问题是电影播放器​​对象没有被释放，所以我看不到下一个视频，只能听到音频播放。

希望这会有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-01-06T18:00:30.877

这似乎已在较新的 iOS 版本中得到修复。

# ruby - ruby-aaws 获取特定专辑

> ID：661380
> 
> 赞同：0
> 
> 时间：2009-03-19T07:51:09.457
> 
> 标签：ruby, amazon-web-services

我正在尝试使用 ruby​​-aaws 从亚马逊获取特定的音乐 cd。

```
il = ItemSearch.new( 'Music', { 'Artist' => artist_title,
                                'Title' => album_name } )
rg = ResponseGroup.new( 'Large' )

req = Request.new(AMAZON_KEY_ID, AMAZON_ASSOCIATES_ID, 'de')
resp = req.search( il, rg, 5) 
```

但这失败了。它似乎只在我搜索艺术家*或*标题时才有效，而不是同时搜索两者。我做错了什么？如果我手动构建 url，它可以完美地工作，但我真的不想自己手动解析 xml。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-19T09:54:52.280

我已经看了一下`ruby-aaws`. 看起来您应该能够在调用任何方法/类之前设置`$DEBUG`为并查看正在请求的 URL。如果您的手工制作的 URL 与由 生成的 URL 之间存在任何差异，这可能会给您一些线索。`true``ruby-aaws``ruby-aaws`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-20T07:17:46.667

我刚刚用最新版本的 ruby​​-aaws 尝试了这个用例，它工作得很好。

我对 ItemSearch 使用了以下内容（使用您最初发布的相同代码）：

```
il = ItemSearch.new( 'Music', { 'Artist'=>'The Smiths', 'Title'=>'Hatful' }) 
```

并得到了我所期望的好结果。请再试一次，看看最新的 ruby​​-aaws 是否已经消除了阻碍你的皱纹。

# jquery - 需要从 Flash 电影中打开一个 jquery modal

> ID：661382
> 
> 赞同：1
> 
> 时间：2009-03-19T07:54:14.940
> 
> 标签：jquery, flash

我有一个带有产品的闪存轮播。产品是从 xml 文件加载的。当您单击轮播中的产品时，需要弹出对话框模式。

我在 flash geturl 函数中使用。但是我应该在这里放什么？必须是这样的 `javascript:openFunction()` ，但这不起作用，有人有什么想法吗？

我应该为我的 jquery 文件中的 openFunction() 写什么？

我不需要完整的脚本，只要朝着正确的方向迈出一步就可以了:)

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-19T08:41:38.697

最常见的是使用**ExternalInterface**调用 javascript 函数：

动作脚本：

```
ExternalInterface.call('popupMessage','hello'); 
```

Javascript：

```
function popupMessage(msg)
{
    alert(msg);
} 
```

**文档： http:** [//livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/external/ExternalInterface.html](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/external/ExternalInterface.html)

如果这不起作用，您至少可以比 getUrl 更容易地捕获错误并调试它（您在 as2 中工作，对吗？）。

# codeplex - CodePlex 上最接近 CodeProject 许可证的 OSS 许可证是什么？

> ID：661383
> 
> 赞同：0
> 
> 时间：2009-03-19T07:54:35.970
> 
> 标签：codeplex

CodeProject 上有一些代码在[CodeProject 许可](http://www.codeproject.com/info/cpol10.aspx)下已经是 OSS 了。

我已经在他的博客上多次联系过作者，但他没有回应任何将代码放在 CodePlex（或任何电子邮件）上的请求。

因为无论如何它都是 OSS，我想我会在没有他允许的情况下这样做（当然要给他所有的功劳）。

我认为这在道德上是可以的，只要我选择最接近 codeproject 许可证的许可证。

有谁知道我应该使用的最接近[CodeProject的许可证？](http://www.codeproject.com/info/cpol10.aspx)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T08:06:18.220

未经作者许可，您不能更改一段代码的许可证。故事结尾、句号等。

如果您将其嵌入到另一个项目中（因为我相信 CodeProject 许可证允许），那么请确保在您的 COPYING 文件（或等效文件）中放置一个通知，并附上 codeproject 许可证的副本、受影响的文件 [s] 和作者合法名称。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-19T08:07:54.987

在 CodePlex 上，您可以使用自定义许可证。只需复制 CodeProject 许可证即可。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T07:55:53.517

这听起来像是一个律师的问题。比较某种“等效”的许可证非常困难。

# .net - TFS 与 SVN

> ID：661389
> 
> 赞同：60
> 
> 时间：2009-03-19T07:57:10.783
> 
> 标签：.net, svn, version-control, tfs, configuration-management

我即将开始一个项目（.NET），需要在 TFS 和 SVN 之间做出决定。

我更习惯于 SVN（带乌龟客户端）、CVS 和 VSS。TFS 是否具有 SVN 中可用的所有功能

你们中有人从 SVN 切换到 TFS 并发现它值得吗？
如果我们需要使用 TFS，看起来我们可能需要 Visual Studio。

**[编辑]**
金钱不是考虑因素，因为我们已经拥有 TFS 的许可证。而且我对 TFS vs SVN 的源代码控制功能更感兴趣，当然也欢迎其他功能列表。

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2009-03-19T08:48:04.640

“ **TFS 和 SVN 无法比较**”

**SVN** : 源代码版本控制系统
**TFS** : 成熟的软件开发管理系统，包含版本控制、发布管理、需求跟踪、文档发布等。

两者都很好地使用了可用于 VS2005 的 IDE 集成插件（例如 AnkhSVN，Collabnet 的插件），所以这不是要考虑的重点。

**选择标准**：
- 如果您有无预算或小预算项目，请选择**SVN**
- 如果您只寻找版本控制系统，请选择**SVN**，如果您正在寻找完整的开发管理，请选择**TFS**
- 如果您有耐心处理不同的问题集成工具（CruiseControl.Net、NUnit、NCover、FIT）以实现适当的开发环境选择**SVN**，或者如果您正在寻找所有这些开箱即用的实现，请选择**TFS**

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-03-19T08:06:04.210

18 个月前使用过 TFS，我发现它有问题、缓慢、烦人、非常有限的搜索条件，并且感觉产品被一群不感兴趣、报酬过低、工作过度的技术人员被迫使用 Sharepoint 和其他MS 技术，因为那是营销人员想要的。说真的，它是一只狗，我宁愿使用 SourceSafe！

另一方面，SVN 有点技术含量，IDE 集成很痛苦，有时会感到困惑，但用户群很大，大多数问题都可以通过快速的 SO 问题得到解决。

你考虑过[保险柜](http://www.vault.com)吗？效果很好，价格也不贵。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2012-05-10T01:42:45.400

如果您使用 2013 版本并使用基于 Git 的存储库，我只会推荐 TFS。我在以前的版本中遇到了太多问题，认为它们是稳定的。

*   一次将多个文件发送到您的差异工具是不可能的。当您想在合并之前查看更改并且不可用时，这非常有用。
*   功能的可用性不一致。某些功能只能在 IDE 中使用，而其他功能只能从 Windows 资源管理器中使用，而还有一些功能只能在命令行中使用。
*   IDE 无法将文件添加到版本控制，只能通过 Windows 资源管理器集成进行。
*   只能在 IDE 中访问货架集，而不能通过 Windows 资源管理器集成访问。
*   缺乏一个统一的安装程序。仅安装 TFS 是不够的，您还必须安装团队工具和电动工具才能获得基本功能。
*   货架集功能不合并。建立私有分支可能是一种很酷的方式，基本上可以保证您的代码会过时并停止工作。
*   如果需要使用 Visual Studio 以外的编辑器，则必须在编辑文本文件之前手动解锁它们。
*   有时 Visual Studio 会忘记解锁它自己正在管理的文件并引发错误。
*   签入和搁置 UI 基于已添加到 TFS 的可用文件提交，而不是文件系统中实际存在的文件。这使得丢失文件变得非常容易。（这实际上是 Visual Studio 处理项目文件的方式的问题，但这本身就是另一个抱怨）。
*   由于前面提到的问题，使用非 Microsoft 工具编辑您的源是不必要的困难。
*   TFS 配置与您的源一起提交。这意味着如果您更改 TFS 服务器，所有历史记录的配置现在都不正确。您可以使用一个默认配置来覆盖此行为，但这并不明显。
*   除了基本级别，不支持忽略过滤器。
*   无法处理超过 249 个字符的路径。
*   已解锁但未编辑的文件显示为已更改，即使它们尚未更改。区分更改和解锁将使差异更容易，或者更好的是完全消除整个损坏的解锁系统。
*   Windows 资源管理器图标覆盖不能清楚地显示文件是否已被编辑。TFS 中的所有文件都有一个绿色角落，而修改后的文件在图标底部添加了一支铅笔。切换到红色角落进行修改会更容易看到或使用乌龟系统的图标。
*   旧版本的 Visual Studio 在新版本的 TFS 中集成时存在问题。这意味着我们现在在源代码控制中有一个 IDE 版本依赖项。
*   默认情况下包括不需要的用户解​​决方案文件。当然，我承认这可能是一个偏好问题。
*   糟糕的缓存可能无法准确反映本地副本和服务器之间的差异。获取最新信息并发现您实际上没有最新信息是非常令人沮丧的。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-03-19T09:33:25.950

我在各种项目中使用 SVN 已经 1.5 年了。到目前为止我使用的设置：

*   [Visual Studio 的AnkhSVN](http://ankhsvn.open.collab.net/)客户端。自版本 2 以来，它很好地集成为源代码控制提供程序。
*   服务器要么是Windows 上的[CollabNet Subversion](http://www.open.collab.net/downloads/subversion/) ，要么是带有 SSL + SVN 的 Apache 2.2 通过 Linux 上的 DAV。

这些设置都没有任何问题，我强烈推荐使用 SVN，因为它免费且易于使用。还有许多项目管理/错误跟踪包与 SVN 集成（例如[trac](http://trac.edgewall.org/)）。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-03-19T15:17:00.217

我会选择SVN。我以前从开发人员的角度使用过 SVN，而我目前使用的是 TFS，让我告诉你 TFS 很痛苦。虽然 TFS 功能齐全并且不仅仅是版本控制，但它的版本控制充其量只是草率。合并是可怕的，我们中的许多人现在转向手动合并或合并工具，因为我们不能依赖 TFS。文件丢失，有时没有下载到本地系统，而且它的行为有些奇怪，让你想把头撞在桌子上。

话虽如此，如果您想要 TFS 的所有荣耀，愿意解决其痛点，它是设置自动构建和发布的绝佳工具。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2009-03-19T08:00:59.307

在你决定之前看看这篇文章：[开源项目的 TFS 与 Subversion 的比较](http://haacked.com/archive/2007/03/02/A_Comparison_of_TFS_vs_Subversion_for_Open_Source_Projects.aspx)

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2009-03-19T08:04:52.107

我都使用过——但实际上，我已经将我的主要项目从 TFS 切换到了 SVN。我发现离线和匿名访问在我的项目中非常有价值。

总的来说，我认为它们具有可比性。我只会选择你最了解的一个，你是最快乐的维护者。我没有发现一个系统中的特定功能明显超过另一个系统中的功能。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2009-03-19T09:56:28.127

如果您熟悉 svn，我会坚持使用它。Tfs 不是免费的，也不简单。它不仅仅是源代码控制。如果您是像我们这样的 .net 商店，并且您正在决定在整个开发周期中使用什么产品，那么它是一个竞争者，但对于简单的源代码控制来说，它是矫枉过正的。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-03-19T08:23:51.703

好吧，对我来说，选择显然是 TFS ：

*   SVN 与 Visual Studio 的集成至少可以说是不完整的（IDE 中没有很多功能），而且有一点问题（AnkhSVN 肯定是），而 TFS 是完美的（这是有道理的......）。我使用 SVN（在一个月内）多次损坏了我的整个工作区，从未使用过 TFS（大约 2 年）

*   虽然这两个系统的源代码控制相关功能可能相当相似，但它们可以直接从带有 TFS 的 IDE 访问，而如果您使用 SVN，则必须依赖[TortoiseSVN](http://tortoisesvn.tigris.org/)或其他外部工具。**在解决方案资源管理器选项卡上单击几下即可访问几乎所有 TFS 任务。**

*   使用 TFS 进行合并要容易得多，即使是复杂的合并（例如，[SVN 会将 <<<<<<'s 和 >>>>>>>>>'s 添加到您的 .csproj 文件](http://discuss.joelonsoftware.com/default.asp?dotnet.12.288423.10)中，因此您需要手动编辑它们以从 VS 再次打开它们。）

虽然我认为这些原因足以让我更喜欢 TFS 而不是 SVN，但我必须补充一点：

*   TFS 不仅仅是一个源代码控制工具（想想工作项、项目门户等）

    我过去曾在一个中型项目（12 名编码员、3 名测试员、3 名业务分析师）中使用它，并且我们已经能够成功地将所有任务集中在 TFS 中（错误报告、项目文档、构建过程、 ETC。）

    我并不是说使用 SVN 和其他第三方工具做同样的事情是不可能的，但是将所有东西很好地集成到一个产品中绝对是件好事。

* * *

为了公平起见，以下是 TFS 的两个明显缺点：

*   它的价格

*   安装 TFS 相当痛苦，而安装 SVN 只需几分钟。

    在 SqlServer 2008 上安装 TFS 2008 非常复杂，您无法在 PDC 等上安装 TFS。对我来说，这绝对是我使用 Microsoft 产品时遇到的最糟糕的安装体验。

    话虽如此，一旦安装，TFS 就非常易于使用（尤其是对于不熟悉源代码控制系统的编码人员）

* * *

**在我目前的项目中，我从 SVN 开始，并迅速切换到 TFS。我很高兴我做到了。**

我决定切换的主要原因显然是 SVN 的整体错误行为（我使用[VisualSVN](http://www.visualsvn.com/)作为服务器，[AnkhSVN](http://ankhsvn.open.collab.net/)作为客户端）。至少每周一次，我发现自己花费数小时处理神秘的 AnkhSVN 错误消息。

迄今为止，我还没有找到一个后悔改用 TFS 的理由。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-03-19T09:48:45.757

我想说 TFS 不仅仅是源代码控制。如果你负担得起，我肯定会建议使用它。例如，当您开始使用 Team Builds 或使用 Work Items 之类的东西时，您会发现 TFS 可以真正管理您的整个开发生命周期，提供丰富的环境，其中报告、易用性、流畅的 VS 集成和可靠的源控制全部合二为一。

它确实需要服务器端的一些铁。但是我不觉得它很慢，它在 VPN 上运行良好，并且支持离线工作。

一个主要缺点是安装过程（在服务器端），它是乏味的、不灵活的，在我看来（我来自打包应用程序和部署非常重要的领域）是 SQL Server、报告的一个坏例子可以安装服务、Sharepoint 和 web 服务。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-03-19T16:43:13.567

TFS 可以从 SVN 导入，但是 SVN 不能从 TFS 导入。因此，如果您没有找到好的理由，请使用 SVN，因为以后更容易改变主意。

SVN 最好的一点是我所知道的每个源代码控制系统都可以从中导入，因此选择 SVN 是一个风险非常低的选择。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2013-08-22T04:09:10.903

以我的经验，SVN 总体上更快、更轻松。我已经将它与 XCOPY 部署脚本一起使用，与 TFS 相比，这些脚本使您可以更快地工作和部署。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-03-19T08:02:09.180

我没有使用 TFS 的经验，但 IDE 集成是您应该考虑的事情。TFS 显然与 Visual Studio集成*得非常好。*AnkhSVN 是 VS 唯一可用的免费插件，即使在新版本中也经常出现问题。不过，我还没有尝试过 VisualSVN。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2010-02-12T10:11:19.730

考虑到 TFS 2010 也可以安装在 Windows Vista / 7 客户端操作系统上，并且它支持快速、三单击安装。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2011-09-14T13:36:49.610

**优点：**

*   **与 Visual Studio 集成**。如果您使用的是完整的 Microsoft 技术，那将是一个真正的优势。堆栈进行开发。
*   **自动化构建**（尽管可以通过其他产品实现）确实做得很好。持续集成和门控签入构建是很棒的 IMO。

**缺点：**

*   **Windows 工作流基础**。出于某种原因，选择了 Windows Workflow Foundation 作为自定义 TFS 的许多方面的方法。总之，你需要一本关于Windows Workflow的书来理解它，而我根本没有时间。非常令人失望的国际海事组织。
*   **项目管理**。我猜工作项的概念很简单，但它有很多奇怪的地方让我感到困惑。IMO 太复杂了。来自 Trac + SVN 背景，我更喜欢 Trac。再说一次，只是我的看法。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2012-01-10T19:45:57.700

不了解这些工具的功能及其局限性，将意味着您最终得到的工具无法满足您的需求。了解您的要求，并稍微阅读产品手册 - 大量信息可用于确定适用性。

虽然我完全同意 SVN 的支持者，因为它是一个出色的工具（我在大学里用过很多次），但我发现当您使用带有 Studio 的 SP1 版本时，TFS 通常在 OOTB 情况下更加合作2010 年。

**此外，还有一些不错的小插件可以让 TFS 对我们这些习惯并且通常也更喜欢 SVN 类型解决方案的人来说更可口，其中许多都提供了出色的支持：**

用于代码审查的 TeamReview 就是一个示例：[http](http://teamreview.codeplex.com/) ://teamreview.codeplex.com/ 用于 TFS 的多平台使用的 MS 路径：http: [//www.microsoft.com/pathways/teamprise/FAQ.htm](http://www.microsoft.com/pathways/teamprise/FAQ.htm)

**这个 SO 问题是 TFS 插件的一个很好的资源：** [哪些插件/实用程序可用于 TFS？](https://stackoverflow.com/questions/1525928/what-add-ons-utilities-are-available-for-tfs)

智者的话，如上所述，安装 TFS 可能会很痛苦，因此应谨慎行事。按照下面的路线，我遇到了最小的问题：

*Studio 2008 -> 修补 -> Studio 2010 -> 修补 -> .NET -> SQL Server 2008RD/2012 -> 修补 -> TFS -> 修补*

# ruby-on-rails - 在 Rails 应用程序中放置全局 Hash 变量的位置

> ID：661404
> 
> 赞同：2
> 
> 时间：2009-03-19T08:06:37.907
> 
> 标签：ruby-on-rails

我需要一个地方来保存用户的最后请求时间，并且不想为此使用数据库

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T10:47:36.693

您可以为此使用内存缓存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T14:33:36.150

如果您想在用户方面执行此操作，并且不介意在会话之间丢失它，那么存储它的地方就是像 session[:last_request] 这样的会话

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-22T18:04:22.630

有一个简单的解决方案 - 你可以把它作为一个常量放在 config/environment.rb

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-10-30T23:43:35.840

有一个简单的方法（虽然不是那么优雅）

```
if Thread.main[:uuid] == nil 
  Thread.main[:uuid]=0
end
uid = Thread.main[:uuid] += 1 
```

# java - 当 JSP 完成执行时会发生什么？

> ID：661415
> 
> 赞同：3
> 
> 时间：2009-03-19T08:17:21.280
> 
> 标签：java, jsp, memory, garbage-collection

当一个 JSP 完成执行时，JSP 页面中声明的所有变量都会被放入垃圾回收器中吗？如果我在 JSP 中声明了许多内存密集型 Hashtable，并且我让 JSP 完成执行而不事先将变量设置为 null，那么即使在 JSP 完成执行之后，对象还会留在内存中吗？

（我没有将它们存储在持久变量中，例如会话。只是在局部变量中。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-19T08:21:52.050

如果变量在请求或页面范围内声明，是的，它们有资格进行垃圾收集。

即使您将对象引用设置为 null 它仍然在消耗内存，只是引用计数减少 1。如果引用计数为 0，垃圾收集器将释放内存。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T08:22:30.863

好吧，一旦执行完成（如果范围未设置为会话），JSP 引擎就会从内存中删除 JSP 页面。然而，为了避免内存泄漏，您应该使用 jspDestroy() 方法来释放内存。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T11:34:12.727

如果您想确切了解 JSP 翻译成的 Java 逻辑代码，可以使用[Jasper](http://en.wikipedia.org/wiki/Tomcat_Jasper#Jasper)生成代码。（不同的 JSP 引擎可能会产生不同的输出，但变量的范围等应符合规范。）您将需要[Tomcat](http://tomcat.apache.org/)和[Ant](http://ant.apache.org/)。

此示例批处理脚本在*输出*目录中为*test.jsp*生成 Java 代码：

 *```
@ECHO OFF
SETLOCAL EnableDelayedExpansion
SET ANT_HOME=C:\dev\apache-ant-1.7.1
SET TOMCAT_HOME=C:\Program Files\Apache Software Foundation\Tomcat 6.0
SET CLASSPATH="
FOR /r "%TOMCAT_HOME%\bin\" %%a IN (*.jar) DO SET CLASSPATH=!CLASSPATH!;%%a
FOR /r "%TOMCAT_HOME%\lib\" %%a IN (*.jar) DO SET CLASSPATH=!CLASSPATH!;%%a
SET CLASSPATH=!CLASSPATH!;%ANT_HOME%\lib\ant.jar"
MKDIR output
java org.apache.jasper.JspC -d .\output -webapp .\WebContent test.jsp 
```

*WebContent* is the root directory of the web application. The generated code is a servlet and will follow the servlet lifecycle as defined in the spec.

# visual-studio - 远程运行 Visual Studio 有什么缺点吗？

> ID：661421
> 
> 赞同：1
> 
> 时间：2009-03-19T08:22:58.413
> 
> 标签：visual-studio

假设您有一台无法处理 Visual Studio 的慢速笔记本电脑，但有一台速度极快的台式机可以。假设你想在你家的几个房间里开发。在桌面上运行 Visual Studio 并简单地使用笔记本电脑作为远程访问它有什么缺点吗？我猜你唯一担心的是网络延迟，但如果两台计算机在同一个网络上，那应该是最小的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-19T08:24:36.507

去做吧。

由于您在自己的本地网络中运行 Visual Studio，因此不存在主要缺点（安全性和延迟）。此外，您还可以获得台式机的速度和笔记本电脑的移动性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T08:30:17.413

即使在宽带上我也经常这样做，我从来没有发现速度是一个问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T08:38:40.980

这是我在工作中的标准工作习惯。有时您会遇到问题，例如打开 TFS 文档附件可能会失败，但总体而言体验还不错。

这也是一个额外的好处，您可以让它持续运行（即过夜/周末），并且您可以在晚上离开之前开始构建并返回打包的安装程序（或错误:)）。

我期待（在一两年内）能够通过 Hyper-V 做到这一点——然后应用程序将像在我的笔记本电脑上一样运行，无需远程桌面。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-19T08:26:34.613

没有大的缺点。我一直在 400 英里外的服务器上远程运行 VS 2008，在我的笔记本电脑上使用 GNU/Linux 和 rdesktop，而服务器（当然）运行 Windows。我遇到的唯一问题是在两者之间移动文件是一团糟——但如果你有桌面并且可以安装你喜欢的任何东西（例如 ftp 程序），我看不出有任何缺点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-19T09:23:05.490

在我尝试过的公司工作环境中，我从未感到特别快乐。尝试使用 MSTSC 和 VNC。

拥有一个带有多个显示器的桌面并试图通过一个较小的笔记本电脑显示器来查看它通常是非常痛苦的，而且空间永远不够。

即使是PC在同一个开关上，鼠标移动或打字似乎总是会有一些延迟，我相信你可以调整，我只是觉得它有点烦人。

我们还没有尝试从 CITRIX 服务器提供 DevStudio，这可能值得一试。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-19T09:30:27.423

我在宽带上使用 Visual Studio 进行了很多工作，这没关系。如果您在笔记本电脑上运行 linux，rdesktop 是您的朋友。有许多选项可以提高速度，例如使用 8 位颜色而不是 16 位或更多。我不知道 mstsc 是否提供这样的选项。Visual Studio 2008 有很多关于速度的选项，如果连接太慢，可以启用这些选项：禁用精美菜单等。

问候

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-19T09:38:19.260

我认为，在使用连接到远程桌面的笔记本电脑时，设置双（或更多）显示器确实比移动方便。我每周至少在家工作两天，使用我的笔记本电脑（这是一个 17 英寸、1900x1200 的屏幕，基本上他们称之为“桌面替代品”），使用 VPN 连接到 VS 和 TFS，我发现这种体验少于我有 17" 笔记本电脑屏幕和 24" TFT（也是 1900x1200）的工作情况。

我还经历过在 RDP 会话上运行 VS（或 SQL Server Management Studio 等）与真实情况不同。它确实完成了工作，但是“感觉”不一样。

# asp.net - 保护文件夹免受外部请求

> ID：661426
> 
> 赞同：2
> 
> 时间：2009-03-19T08:26:20.247
> 
> 标签：asp.net, security, directory, protection

我正在使用 asp.net 2.0，并且在我的应用程序路径 ~/Data/ 中有一个文件夹，其中包含一些 .mdb 文件。

我想保护这个文件夹免受外部请求的影响，比如[http://www.whatever.com/Data/whatever.mdb](http://www.whatever.com/Data/whatever.mdb)

但是我需要对我的应用程序授予任何权限，因为我使用 OleDBConnections 对 ~/Data/ 路径。

保护此文件夹的最佳方法是什么？

亲切的问候。何塞马。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-19T08:38:37.283

在 IIS 管理器中，如果不是全部访问，则至少删除匿名访问。您的应用程序代码可以继续使用其内容，但 HTTP 请求无法访问它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-19T08:41:23.627

如果可能的话，另一种选择是将 mdb 文件放在网站之外。例如，类似这样的目录结构：

> / 我的项目
> 
> ```
>  / Data
>        - whatever.mdb
>   / www
>        - Default.aspx 
> ```

其中 www 是您网站的实际根目录。这样，用户将永远无法从浏览器访问 mdb 文件，而您仍然可以对 mdb 文件使用 OleDBConnections。据我所知，这是非常安全的，这样您就不会意外忘记在 IIS 中禁止访问。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-19T09:03:56.927

你检查它是否真的有问题？

我在这里使用 ASP.NET 3.5，但默认的 App_Data 文件夹**被**屏蔽以供下载。也许您应该遵循指南并进行验证。

至于将数据移到 Web 文件夹之外的其他答案，当您使用托管服务提供商时，这通常不起作用。

# connection - jdbc连接池中可共享和不可共享连接的区别？

> ID：661429
> 
> 赞同：2
> 
> 时间：2009-03-19T08:26:53.240
> 
> 标签：connection, connection-pooling

我们注意到托管在 sun app server 企业版 8.1 上的 struts Web 应用程序中有一些奇怪的地方。

即使用户活动相对非常少，用于监控 JDBC 资源的 NumConnUsed 保持在 100 的连接数。

我尝试做一些研究，发现以下链接 [http://j2ee-performance.blogspot.com/](http://j2ee-performance.blogspot.com/) [http://www.ibm.com/developerworks/websphere/library/techarticles/0506_johnsen/0506_johnsen.html](http://www.ibm.com/developerworks/websphere/library/techarticles/0506_johnsen/0506_johnsen.html)

“当应用程序关闭一个可共享的连接时，该连接并没有真正关闭，也没有返回到空闲池中。相反，它保留在共享连接池中，准备好在同一 LTC 中为连接到同一资源的另一个请求做好准备。”

根据上面的评论，如果我的 web.xml 资源引用范围设置为可共享，当应用程序端关闭连接时，它确实保留在共享连接池中，因此 numconnused 总是这么高？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-19T08:43:57.177

如果我以自己的特殊方式 (;)) 解释链接，则共享连接与非共享连接基于同一页面中的不同连接。

```
java.sql.Connection connectionOne = DriverManager.getConnection(...);
...
java.sql.Connection connectionTwo = DriverManager.getConnection(...); 
```

乍一看，这两个似乎是独立的 - 但如果您的 AS 设置为可共享连接，则将使用指向第一个连接的指针创建第二个连接，而不是返回新连接。当页面完成时，连接应该被发送回池。

AS 可能会保持池中充满连接以提高性能。

这不是事实，只是我自己对链接的解释。

# sql - 经典 ASP SQL 查询返回十列中的两列

> ID：661437
> 
> 赞同：2
> 
> 时间：2009-03-19T08:29:55.230
> 
> 标签：sql, asp-classic

我希望有人可以帮助解决问题......我不从事与编程相关的任何工作，但我们非常需要一些资产跟踪，所以在我的业余时间（不是很多，我们平均 10 小时）和手头的工具（运行 winXP 的 600mhz 堆） 我建立了一个小的经典 ASP 站点来处理所有的跟踪和订单。

一切都很好，直到我决定我有更多的空闲时间并决定升级一点。整个事情非常混乱，但最糟糕的是它的上帝太慢了。所以我决定放弃我的访问数据库和 JET 驱动程序并使用 MS SQL Server 2000 Express（不要忘记，600mhz 和不多的 RAM）。我开始重建，一切似乎都运行良好（而且速度更快），直到我开始出现错误。我发现对于某些查询，只有几个列会返回任何数据。

**例如**：我有一个 shopitems 表，带有 gID(uniqueID)、iDesc(description)、iLength、iQty、colID（交叉引用）。我进行查询以获取某个类别中的所有内容：`Select * from shopitems where catID=22 order by gID asc`. 然后我开始逐步显示并显示所有内容。

问题是，只有 gID 和 colID 字段有数据，其他什么都没有。我打开了 Web Data Administrator 应用程序并在其中运行查询，它返回的一切都很好。所以然后我决定某处有一个错误，所以我写了一个快速测试页面和同样的问题（除了这次它的 gID 和 iLength 返回数据）。它都是数据类型的混合，iDesc 是 nText 而 iLength 是 int。我已经完成了我能找到的所有事情，但我认为这是我在 SQL 中缺少的东西......有人有什么想法吗？
此外，我在家里扔掉的电脑上复制了这个，它实际上有一个现代处理器和相当数量的 RAM，所以它根本不是机器。

感谢您的帮助...我收听播客，现在似乎已经有一段时间是 server/sql 周了，我想我会在这里问某人...

----编辑----
更改了代码...此代码的一个版本工作了很长时间，现在不是那么多...如果我注释掉

```
gID=rs1("gID") 
```

然后我得到 iDesc 的值，但不是其他的。

```
<%@ Language=vbscript %> 
```

该死的

```
Set db1 = Server.CreateObject("ADODB.Connection")
'db1.Open "Provider=MSDASQL;Driver={SQL Server};Server=Phsion;Database=master;"
db1.Open "Provider=MSDASQL;DSN=SHOPWEB;"
'sqltxt="select gID, iLength, iDesc from shopitems where catID=45 order by CAST(idesc as varchar)"

sqltxt="select iDesc, gID from ShopItems order by gID asc"
set rs1=db1.execute(sqltxt)
rs1.movefirst
do until rs1.eof
  gID=rs1("gID")
  'iLength=rs1("iLength")

  iDesc=rs1("iDesc")

  response.write("<br>gID: " & gid & "<br>")

  response.write("<br>iLength: " & iLength & "<br>")

  response.write("<br>iDesc: " & iDesc & "<br>")
  rs1.movenext
loop
rs1.close
set rs1=nothing
db1.close
set db1=nothing 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-19T08:46:49.917

添加`Option Explicit`在顶部（在 <% 和 %> 内）以使变量声明成为必需，然后使用`Dim variable-name-goes-here`所有变量声明变量，瞧，您将立即看到问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-19T08:35:19.803

如果您没有选择所有内容 (*)，而是选择了所需的列 - 您还有同样的问题吗？IE：

```
SELECT gID, iDesc, iLength, iQty 
FROM shopitems
WHERE catID = 22 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T18:42:31.973

这是一个令人困惑的问题。如前所述，请务必打开选项显式以帮助查找任何变量名称问题。如果您使用了**On Error Resume Next**那么您可以使用**On Error Goto 0**来确保您没有抑制错误

这是我的看法。如果可以进行调试，请将其分解为自己的文件。如果我的循环产生输出，我们可以追踪事情。

```
<%
Option Explicit
On Error Goto 0

Dim db1, sqltxt, rs1
Dim gID, iLength, iDesc, arrRS

Set db1 = Server.CreateObject("ADODB.Connection")
'db1.Open "Provider=MSDASQL;Driver={SQL Server};Server=Phsion;Database=master;"
db1.Open "Provider=MSDASQL;DSN=SHOPWEB;"
'sqltxt="select gID, iLength, iDesc from shopitems where catID=45 order by CAST(idesc as varchar)"

'   sqltxt="select iDesc, gID from ShopItems order by gID asc"
'   set rs1=db1.execute(sqltxt)
'   rs1.movefirst
'   do until rs1.eof
'       gID = rs1("gID")
'       'iLength=rs1("iLength")
'       iDesc = rs1("iDesc")
'       response.write("gID: " & gid & "")
'       response.write("iLength: " & iLength & "")
'       response.write("iDesc: " & iDesc & "")
'       rs1.movenext
'   loop
'   rs1.close : set rs1=nothing

sqltxt="select iDesc, gID from ShopItems order by gID asc"
set rs1=db1.execute(sqltxt)
'//Dump the recordset into an array
arrRS = rs1.GetRows()
'//We can close the rs now since we don't need it anymore
rs1.close : set rs1=nothing

'//We are going to basically dump a HTML table that should look like you SQL viewer
Response.Write("<table>")
'//Loop through all the rows
For i = 0 To UBound(arrRS,2)
    Response.Write("<tr>")
    '//Loop through all the columns
    For j = 0 To UBound(arrRS,1)
            '//write out each column in the row
            Response.Write("<td>" & arrRS(j,i) & "</td>")
            '//Look I will be honest, I can't test this so your might have to swap the i and the j to get a full output
    Next
    Response.Write("</tr>")
Next
Response.Write("</table>")

db1.close : set db1=nothing
%> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-31T16:02:49.090

我不知道您是否已解决此问题，但如果没有，那么您应该尝试更改选择列的顺序，以便 nText 字段位于末尾。对此有一个技术解释（与记录的最大字节长度有关，iirc）。

# c++ - 这在内部是如何工作的 int const iVal = 5; (int&)iVal = 10;

> ID：661464
> 
> 赞同：0
> 
> 时间：2009-03-19T08:47:24.157
> 
> 标签：c++, c, compiler-construction

我想知道以下如何在编译器级别工作。

```
int const iVal = 5; 
(int&)iVal = 10; 
```

一点 m/c 或编译器级别的答案会很完整。

提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-19T08:52:38.560

这是[未定义的行为](http://en.wikipedia.org/wiki/Undefined_behavior)。

在第一行中，您定义了一个常量整数。此后，在您的程序中，编译器只允许将 iVal 替换为值 5。它可能会改为从内存中加载它，但可能不会，因为这不会带来任何好处。

第二行写入您的编译器告诉您包含数字 5 的内存位置。但是，这不能保证有任何效果，因为您已经告诉编译器该值不会改变。

例如，下面将定义一个由**5 个**元素组成的数组，并打印一个未定义的值（或者它可以做任何它想做的事情！它是未定义的）

```
int const iVal = 5;
(int&)iVal = 10;
char arr[iVal];
cout << iVal; 
```

生成的程序集可能类似于：

```
sub ESP, 9      ; allocate mem for arr and iVal. hardcoded 5+sizeof(int) bytes
                ; (iVal isn't _required_ to have space allocated to it)
mov $iVal, 10   ; the compiler might do this, assuming that you know what
                ; you're doing. But then again, it might not.
push $cout
push 5
call $operator_ltlt__ostream_int
add ESP, 9 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-19T08:52:50.073

C 风格的转换充当 const_cast。就像你写过

```
const_cast<int&>( iVal ) = 10; 
```

如果您碰巧这样做并且编译器决定不为 iVal 分配实际内存，则会遇到未定义的行为。

比如VC7编译就可以了。它甚至可以在调试模式下运行。在 Release 模式下，iVal 值在分配后不会改变 - 它仍然是 5。

所以你不应该这样做。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-19T08:50:47.643

为什么不通过你的牛编译器运行它并查看汇编输出？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-19T08:56:37.037

这是可能的，因为“const-ness”的想法只存在于语言/编译器中。在实际的计算机内存中，一切都是可变的。编译代码后，您的`iVal`变量只是 RAM 中的一个位置。

**编辑**：上面假设常量实际上是放在内存中的。见[尖牙的回答](https://stackoverflow.com/questions/661464/how-internally-this-works-int-const-ival-5-intival-10/661478#661478)。

使用 c 风格的转换告诉编译器将此内存位置视为一个简单的整数变量，并将该值设置为 10。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-19T09:14:18.633

未定义的行为。

在发布版本中，大多数编译器将直接替换 const 值 - 但您**可能会**遇到一个执行内存加载的编译器。此外，第二个分配可能会也可能不会产生访问冲突，具体取决于平台和编译器。Iirc Intel 的编译器将 const 数据放入只读内存中，因此会在运行时产生访问冲突。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-19T23:53:14.050

如果这是一个嵌入式系统，iVal 很可能会存储在闪存中，因此写入它不会有任何影响。

但是，编译器可能不会将此视为错误，因为嵌入式编译器通常不会跟踪特定的内存区域是否可读。

我怀疑它也可能通过链接器，因为链接器通常会确定 iVal 是一个常数，所以会进入闪存 - 但确定 iVal 的使用方式不是链接器的工作。

顺便说一句，这个问题被标记为“C”，但“（int＆）”语法不是（AFAIK）有效的C。但是，同样可以通过以下方式实现：

```
int *Ptr = (int *) &iVal;
*Ptr = 10; 
```

# silverlight - Silverlight 现场音频流

> ID：661469
> 
> 赞同：1
> 
> 时间：2009-03-19T08:50:03.013
> 
> 标签：silverlight

如何使用 Silverlight 2.0 将现场音频从该位置流式传输到 Internet？我需要什么设备、软件等？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-12-03T16:33:17.110

我已经将 MP3 解码器编写/移植到 Silverlight 3。为了解决可搜索流和 MediaStreamSource 的问题，我编写了一个自定义流 SeekableStream，它环绕任何其他流并通过使用内部内存流使其看起来可搜索.

您可以在[此处](http://prefix.teddywino.com/post/SilverlightMediaKitLiveDemo.aspx)查看它的运行情况，它可以播放位于您的机器本地或网络上的 MP3 文件。库和演示的源代码现已在[CodePlex上发布](http://salusemediakit.codeplex.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T18:59:15.300

这取决于您要流式传输的内容。如果您只想通过网络流式传输 Mp3，Silverlight 2 MediaElement 将为您完成。只需将 Source 属性指向 mp3 的 Uri 即可。同样的技术也适用于视频。如果您想流式传输实时内容（即网络摄像头），那么您应该使用其他评论者链接到的流式传输服务。

# common-lisp - 可以让 CUSP 使用自己的 SBCL 吗？

> ID：661473
> 
> 赞同：1
> 
> 时间：2009-03-19T08:50:58.627
> 
> 标签：common-lisp, sbcl, cusp

我已经在我的 Windows XP 机器上运行了 slime+emacs+sbcl (SBCL 1.0.23)。CUSP 与 SBCL 1.0.6 一起安装。

有没有办法让 CUSP 使用*现有的*SBCL 安装而不是它自己的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T07:50:22.413

你可以，我没有在这台电脑上安装它；但是在选项（可能是首选项）部分（其中列出了左侧的 Java、Lisp 和其他选项卡式面板）中，Lisp 下有一个子部分，称为 implementation。

在该部分中，您可以选择要使用的 SBCL 二进制文件以及要加载的图像文件。它不适用于最新的 SBCL 实现（至少据我所知）。

# wcf - 为什么 Silverlight 2 只支持 WCF basicHTTP 绑定？

> ID：661479
> 
> 赞同：3
> 
> 时间：2009-03-19T08:53:10.307
> 
> 标签：wcf, silverlight

我很困惑...... MS 如何在没有适当支持 WCF 绑定的情况下发布两个版本的 Silverlight？他们至少不应该支持 wsHTTP 绑定吗？那么服务可以具有适当的消息级安全性吗？（即证书等...）

使用 basicHTTP 绑定，看起来保护服务的唯一两个选项是......

1.  HTTPS（但不包括身份验证）
2.  在 basicHTTP 绑定之上自定义实现的 WS-Security

我错过了什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-23T13:52:01.840

Silverlight 是一种 UI 技术，Silverlight 页面与包含所有中间层逻辑的单个服务器对话是正常的。因此，我认为 WCF 仅限于基于 HTTPS 的基本 HTTP 绑定是合理的。据我了解，更复杂的 WCF 绑定旨在用于数据中心的服务器之间。

通常，我希望 Silverlight 页面的后端和前端一起设计和编码。我希望通过中间层逻辑而不是 Silverlight 页面直接访问 3rd 方系统。毕竟，Silverlight 确实是从“比 HTML 更好的 HTML”开始的。

如今，Silverlight 应用程序开始看起来更像胖客户端应用程序，因此 WCF 绑定的限制可能不再像过去那样合理。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-11T04:16:21.293

好的，微软的一位研究人员在这里回答了这个问题。对我来说，这就像“与手交谈”

[http://silverlight.net/forums/p/20844/78325.aspx#78325](http://silverlight.net/forums/p/20844/78325.aspx#78325)

> 对于 Silverlight V2.0 最终版本，答案是否定的。我们只支持 BasicHttpBinding 和 PollingDuplexHttpBinding。

（如果这篇文章回答了您的问题，请“标记为答案”。谢谢！）

杰夫曹

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T08:55:36.773

我认为 BasicHttpBinding 是唯一为 Partial Trust ( [APTCA](http://msdn.microsoft.com/en-us/library/system.security.allowpartiallytrustedcallersattribute.aspx) ) 启用的绑定。

# c++ - 带有std :: map :: const_iterator的模板类中的嵌套结构？

> ID：661481
> 
> 赞同：3
> 
> 时间：2009-03-19T08:54:23.937
> 
> 标签：c++, templates, nested, stdmap

以下代码在声明迭代器的行生成语法错误：

```
template <typename T>
class A
{
  public:

    struct B
    {
       int x, y, z;
    };

    void a()
    {
        std::map<int, B>::const_iterator itr; // error: ; expected before itr
    }

    std::vector<T> v;
    std::map<int, B> m;
}; 
```

这仅在 A 是模板类时发生。这段代码有什么问题？如果我将 B 从 A 中移出，则代码编译得很好。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-19T09:03:12.997

你需要一个类型名：

```
 typename std::map<int, B>::const_iterator itr; 
```

迭代器是一个依赖类型（依赖于 B），当你遇到这种情况时，编译器会要求你用类型名来澄清它。

[这里](http://womble.decadentplace.org.uk/c++/template-faq.html#dependent)对这个问题进行了合理的讨论。

# .net - .NET HttpRequests 使用 Windows 系统缓存

> ID：661482
> 
> 赞同：1
> 
> 时间：2009-03-19T08:54:50.053
> 
> 标签：.net, windows, http, caching

我正在使用 WebClient 或 HttpRequest/REsponse 对图像进行 http 调用。

我不确定缓存是如何专门为浏览器工作的，但是有没有办法让 WebClient 或 WebHttpRequest 使用浏览器使用的系统“临时 Internet 文件”缓存？

或者，我是否必须编写自己的磁盘缓存器？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-09-14T17:25:38.770

您可以通过设置 CachePolicy 属性来指示 WebRequest 使用系统缓存。

以下代码（取自[MSDN](http://msdn.microsoft.com/en-us/library/e1z2a7xh.aspx)）将请求缓存一天。缓存存储在当前用户的临时 Internet 文件夹中（至少在 Windows XP 上）。

```
// Create a policy that allows items in the cache
// to be used if they have been cached one day or less.
HttpRequestCachePolicy requestPolicy = 
  new HttpRequestCachePolicy (HttpCacheAgeControl.MaxAge,
  TimeSpan.FromDays(1));

WebRequest request = WebRequest.Create (resource);

// Set the policy for this request only.
request.CachePolicy = requestPolicy;
HttpWebResponse response = (HttpWebResponse)request.GetResponse();

// Determine whether the response was retrieved from the cache.
Console.WriteLine ("The response was retrieved from the cache : {0}.",
 response.IsFromCache);

Stream s = response.GetResponseStream ();
// do something with the response stream
s.Close();
response.Close(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T08:59:53.207

如果您正在发出 HTTP 请求，并且您希望您的请求在请求的资源已被请求的情况下访问本地缓存，则您必须编写自己的缓存。

有许多潜在的实现。这实际上取决于您期望请求多少不同的资源以及频率。

# lisp - elisp 函数作为参数和返回值

> ID：661490
> 
> 赞同：10
> 
> 时间：2009-03-19T09:00:07.870
> 
> 标签：lisp, elisp

我有以下代码

```
(defun avg-damp(f) 
    #'(lambda(x) (/ (+ (funcall f x) x) 2.0))) 
```

一个电话

```
(funcall (avg-damp #'(lambda(v) (* v v))) 10) 
```

在 SBCL 中返回 55.0（正确值），但在 emacs lisp 中因以下堆栈而崩溃

```
Debugger entered--Lisp error: (void-variable f)
  (funcall f x)
  (+ (funcall f x) x)
  (/ (+ (funcall f x) x) 2.0)
  (lambda (x) (/ (+ ... x) 2.0))(10)
  funcall((lambda (x) (/ (+ ... x) 2.0)) 10)
  eval((funcall (avg-damp (function ...)) 10))
  eval-last-sexp-1(nil)
  eval-last-sexp(nil)
  call-interactively(eval-last-sexp) 
```

我怎样才能让它在 Emacs lisp 中工作？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-19T09:39:48.057

这种编程风格不适用于普通的 Emacs Lisp。Emacs Lisp 使用动态绑定，Scheme 和 Common Lisp 等语言使用词法绑定。您的代码暴露了差异。请参阅：[Emacs Lisp 中的范围](http://www.gnu.org/software/emacs/elisp/html_node/Extent.html)

另请参阅此问题：[如何在 Emacs Lisp 中进行闭包？](https://stackoverflow.com/questions/593383/how-do-i-do-closures-in-emacs-lisp)以及 lexical-let 的“解决方案”。lexical-let 是“cl”包中 Emacs Lisp 的扩展。

另请参阅：从 Emacs 24.1 开始，有可选的[词法绑定](http://www.gnu.org/software/emacs/manual/html_node/elisp/Lexical-Binding.html)。学习如何使用它：[使用词法绑定](http://www.gnu.org/software/emacs/manual/html_node/elisp/Using-Lexical-Binding.html#Using-Lexical-Binding)。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-19T09:20:20.037

一个棘手的问题，但最终解决了这个问题。问题在于，在 avg-damp 的定义中，编译器在编译*avg-damp 本身时*`#'`编译了 lambda 函数，在f 的实际值已知之前。您需要将此函数的编译延迟到稍后的时间点，*即调用 avg-damp 时*，如下所示：

 **```
(defun avg-damp (f)
   `(lambda(x) (/ (+ (funcall ,f x) x) 2.0)))

(funcall (avg-damp #'(lambda(v) (* v v))) 10) 
```

反引号可以解决问题。

**编辑**：当然，如果您以非咖喱形式定义 avg-damp，整个问题就会消失，例如：

```
(defun avg-damp (f x)
   (/ (+ (funcall f x) x) 2.0))

(funcall 'avg-damp #'(lambda(v) (* v v)) 10) 
```

但我想你有理由不这样做。

# financial - 与 Sage 财务软件集成

> ID：661491
> 
> 赞同：30
> 
> 时间：2009-03-19T09:02:06.383
> 
> 标签：financial, sage-line-50

我最近被要求开发一个必须与 Sage Line 50 财务软件集成的应用程序。
我做了一些谷歌搜索，我对缺乏与 Java 或 .Net 连接 Sage 的信息感到惊讶。Sage 是一个黑匣子，您需要在获得任何信息之前注册 Sage 开发人员计划吗？
是否有任何开源选项可以让应用程序与 Sage 对话？

任何信息表示赞赏。

干杯

保罗

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2011-12-17T10:44:09.333

Sage 正在转向一种新的方法，称为 SData。我认为您可以在[http://sdata.sage.com/上阅读有关此内容的信息](http://sdata.sage.com/)

长期的愿望是 SData 将提供完整的 CRUD 设施并简化不同 Sage 程序（其中有很多！）之间的集成，因此提供一致的 Web 服务，也可以与 3rd 方应用程序集成。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-03-31T18:59:36.357

在 Sage UK 网站上，我发现了以下[Developer SDK](https://www.sage.co.uk/developers/sage_developers_programme/membership_at_a_glance/software_development_kit_sdk.aspx)。

结果是，如果你想使用 SDK，你需要使用 .Net。

问题是 SDK 仅适用于起价为 1500 英镑的开发者计划：[这是宣传册](https://www.sage.co.uk/PDF/sage_developers_programme_brochure.pdf)。

但是，开发人员计划确实为您提供了 Sage 软件的免费副本以用于开发目的，因此如果您的业务是 Sage 集成，我可以看到好处。

另一种选择是 Sage 的插件，Sage 以 299 英镑的价格出售

[http://shop.sage.co.uk/pdf/connect_for_Sage_50.pdf](http://shop.sage.co.uk/pdf/connect_for_Sage_50.pdf)

这提供了一个 XML 导入/导出工具，这对于我的目的可能已经足够了。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-19T09:19:39.540

我已经用 Sage Line 50 V9 做了很多（我知道有几个旧版本）。Sage 提供了一个 ODBC 驱动程序，您可以愉快地与 ADO 和 ADO.NET 交谈。但是，驱动程序是只读的，这对您来说可能是也可能不是问题。不过，SQL 查询似乎确实存在一些限制 - 特别是，双连接不起作用（a JOIN b JOIN c）并且需要展平。此外，似乎无法识别 DISTINCT 关键字。希望这有点用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-27T12:31:58.023

回溯到几年前，Sage 还提供了一个读写 API（不是基于 ODBC）来访问他们产品中的数据。

我对您需要加入开发人员计划并不感到惊讶 - Sage 是一个传统的闭源商业应用程序 - 不太可能有可用的开源选项。

Sage 客户过去加入开发计划是免费的，而您为之工作的人应该是……？

编辑 - 哎呀，不再免费

# wpf - 如何设置 WPF 扩展器标题的样式？

> ID：661503
> 
> 赞同：55
> 
> 时间：2009-03-19T09:09:54.447
> 
> 标签：wpf, header, styles, expander

我想在 WPF Expander Header 上应用样式。在下面的 XAML 中，我有一个 Expander，但样式适用于所有内容，而不仅仅是标题。

谢谢。

```
<Page
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
Width="640"
>
    <StackPanel>
        <StackPanel.Resources>
            <Style TargetType="Expander">
                <Style.Resources>
                    <LinearGradientBrush x:Key="BackBrush" StartPoint="0.5,0" EndPoint="0.5,1">
                        <GradientStop Color="#EF3132" Offset="0.1" />
                        <GradientStop Color="#D62B2B" Offset="0.9" />
                    </LinearGradientBrush>
                </Style.Resources>
                <Setter Property="Background" Value="{StaticResource BackBrush}"/>
            </Style>
        </StackPanel.Resources>
        <Expander>
            <StackPanel>
                <TextBlock>Bike</TextBlock>
                <TextBlock>Car</TextBlock>
                <TextBlock>Truck</TextBlock>
            </StackPanel>
        </Expander>
    </StackPanel>
</Page> 
```

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2009-03-19T11:06:47.007

我结合了来自[Josh Smith](http://joshsmithonwpf.wordpress.com/2007/02/24/stretching-content-in-an-expander-header/)和[MSDN](http://msdn.microsoft.com/en-us/library/system.windows.controls.headeredcontentcontrol.headertemplate.aspx)的一些 XAML，并提出了一个解决方案。实际上，必须重新设计控件（至少是标题）。

```
<Page
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
Width="400">
    <StackPanel>
        <StackPanel.Resources>

            <Style TargetType="Border" x:Key="RacePitBorderStyle" >
                <Style.Resources>
                    <LinearGradientBrush x:Key="BackBrush" StartPoint="0.5,0" EndPoint="0.5,1">
                        <GradientStop Color="#EF3132" Offset="0.1" />
                        <GradientStop Color="#D62B2B" Offset="0.9" />
                    </LinearGradientBrush>
                </Style.Resources>
                <Setter Property="Background" Value="{StaticResource BackBrush}"/>
            </Style>

            <DataTemplate x:Key="titleText">
                <Border Style="{StaticResource RacePitBorderStyle}" Height="24">
                    <TextBlock Text="{Binding}" 
                        Margin="4 0"
                        VerticalAlignment="Center"
                        Foreground="White"
                        FontSize="11" 
                        FontWeight="Normal"
                        Width="{Binding
                        RelativeSource={RelativeSource
                        Mode=FindAncestor,
                        AncestorType={x:Type Expander}},
                        Path=ActualWidth}"
                        TextWrapping="Wrap"/>
                </Border>
            </DataTemplate>

            <Style TargetType="{x:Type Expander}">
                <Setter Property="HeaderTemplate" Value="{StaticResource titleText}"/>
            </Style>

        </StackPanel.Resources>

        <Expander Name="hcontCtrl" Header="This is the header.">
            <StackPanel>
                <TextBox>This is a textbox</TextBox>
                <Button>A button</Button>
            </StackPanel>
        </Expander>

    </StackPanel>
</Page> 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2014-05-16T14:09:51.677

我认为 Vasile 的答案是正确的，但它似乎比原始海报所需的要多得多。最初的问题要求做的就是改变标题的背景。虽然所呈现的更改确实做到了这一点，但它也做了其他事情。

其中之一是用 TextBlock 替换默认实现，我相信 ContentPresenter。那么，当我们稍后更改 Expander 以使标头更复杂时会发生什么？也许是这样的：

```
<Expander>
    <Expander.Header>
        <StackPanel>
            <Border height="5" width="5" Foreground="Blue"/>
            <TextBlock>Ha!</TextBlock>
        </StackPanel>
    </Expander.Header>
</Expander> 
```

我不知道，但这并不好。相反，我认为我们希望保持简单。

```
<DataTemplate x:Key="expanderHeader">
    <ContentPresenter
        Content={Binding}
        TextBlock.Background={StaticResource myBrush}/>
</DataTemplate>

<Style TargetType="Expander">
    <Setter Property="HeaderTemplate" Value="{StaticResource expanderHeader}"/>
</Style> 
```

这样，当有人在我们的样式扩展器中放入不只是文本的内容时，我们就不会中断。如果您想确保将他们在此背景下所做的所有事情都包装起来，这可能是需要的，这看起来像：

```
<DataTemplate x:Key="expanderHeader">
    <Border Background={StaticResource myBrush}>
        <ContentPresenter Content={Binding}/>
    </Border>
</DataTemplate> 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-19T09:58:05.797

取决于你想要设计的风格——你可以设计它的任何部分。如果要更改标题中的内容，只需将所有 UI 放在 Expander.Header 属性中，它就会显示在标题区域中。

如果这不能满足您的需求，您可能需要重新模板化控件。[在此处查看](http://msdn.microsoft.com/en-us/library/aa972144(VS.85).aspx)WPF 中附带的控件模板

# flash - 将文件夹中的图像加载到幻灯片中

> ID：661505
> 
> 赞同：0
> 
> 时间：2009-03-19T09:10:37.550
> 
> 标签：flash, actionscript-3, slideshow

我有这个 AS3 幻灯片代码，它加载带有图像列表的 XML。我正在寻找的是一种跳过 XML 部分的方法，只需加载文件夹“图像”中的所有图像？

如何添加一个常量布尔值来决定它是否应该随机播放图像？常量随机：布尔=真；...

```
// import tweener
import caurina.transitions.Tweener;

// delay between slides
const TIMER_DELAY:int = 2000;
// fade time between slides
const FADE_TIME:Number = 1;

// flag for knowing if slideshow is playing
var bolPlaying:Boolean = true;
// reference to the current slider container
var currentContainer:Sprite;
// index of the current slide
var intCurrentSlide:int = -1;
// total slides
var intSlideCount:int;
// timer for switching slides
var slideTimer:Timer;
// slides holder
var sprContainer1:Sprite;
var sprContainer2:Sprite;
// slides loader
var slideLoader:Loader;
// url to slideshow xml
var strXMLPath:String = "slideshow.xml";
// slideshow xml loader
var xmlLoader:URLLoader;
// slideshow xml
var xmlSlideshow:XML;

function initSlideshow():void { 
    // create new urlloader for xml file
    xmlLoader = new URLLoader();
    // add listener for complete event
    xmlLoader.addEventListener(Event.COMPLETE, onXMLLoadComplete);
    // load xml file
    xmlLoader.load(new URLRequest(strXMLPath));

    // create new timer with delay from constant
    slideTimer = new Timer(TIMER_DELAY);
    // add event listener for timer event
    slideTimer.addEventListener(TimerEvent.TIMER, nextSlide);

    // create 2 container sprite which will hold the slides and
    // add them to the masked movieclip
    sprContainer1 = new Sprite();
    sprContainer2 = new Sprite();
    mcSlideHolder.addChild(sprContainer1);
    mcSlideHolder.addChild(sprContainer2);

    // keep a reference of the container which is currently
    // in the front
    currentContainer = sprContainer2;
}

function onXMLLoadComplete(e:Event):void {
    // create new xml with the received data
    xmlSlideshow = new XML(e.target.data);
    // get total slide count
    intSlideCount = xmlSlideshow..image.length();
    // switch the first slide without a delay
    switchSlide(0);
}

function fadeSlideIn(e:Event):void {
    // add loaded slide from slide loader to the
    // current container
    addSlideContent();

    // check if the slideshow is currently playing
    // if so, show time to the next slide. If not, show
    // a status message
    if(bolPlaying) {
    } else {
    }
    // fade the current container in and start the slide timer
    // when the tween is finished
    Tweener.addTween(currentContainer, {alpha:1, time:FADE_TIME, onComplete:onSlideFadeIn});
}

function onSlideFadeIn():void {
    // check, if the slideshow is currently playing
    // if so, start the timer again
    if(bolPlaying && !slideTimer.running)
        slideTimer.start();
}

function switchSlide(intSlide:int):void {
    // check if the last slide is still fading in
    if(!Tweener.isTweening(currentContainer)) {
        // check, if the timer is running (needed for the
        // very first switch of the slide)
        if(slideTimer.running)
            slideTimer.stop();
        // change slide index
        intCurrentSlide = intSlide;
        // check which container is currently in the front and
        // assign currentContainer to the one that's in the back with
        // the old slide
        if(currentContainer == sprContainer2)
            currentContainer = sprContainer1;
        else
            currentContainer = sprContainer2;
        // hide the old slide
        currentContainer.alpha = 0;
        // bring the old slide to the front
        mcSlideHolder.swapChildren(sprContainer2, sprContainer1);
        // delete loaded content
        clearLoader();
        // create a new loader for the slide
        slideLoader = new Loader();
        // add event listener when slide is loaded
        slideLoader.contentLoaderInfo.addEventListener(Event.COMPLETE, fadeSlideIn);
        // load the next slide
        slideLoader.load(new URLRequest(xmlSlideshow..image[intCurrentSlide].@src));
    }
}

function nextSlide(e:Event = null):void {
    // check, if there are any slides left, if so, increment slide
    // index
    if(intCurrentSlide + 1 < intSlideCount)
        switchSlide(intCurrentSlide + 1);
    // if not, start slideshow from beginning
    else
        switchSlide(0);
}

function previousSlide(e:Event = null):void {
    // check, if there are any slides left, if so, decrement slide
    // index
    if(intCurrentSlide - 1 >= 0)
        switchSlide(intCurrentSlide - 1);
    // if not, start slideshow from the last slide
    else
        switchSlide(intSlideCount - 1);
}

function clearLoader():void {
    try {
        // get loader info object
        var li:LoaderInfo = slideLoader.contentLoaderInfo;
        // check if content is bitmap and delete it
        if(li.childAllowsParent && li.content is Bitmap){
            (li.content as Bitmap).bitmapData.dispose();
        }
    } catch(e:*) {}
}

function addSlideContent():void {
    // empty current slide and delete previous bitmap
    while(currentContainer.numChildren){Bitmap(currentContainer.getChildAt(0)).bitmapData.dispose(); currentContainer.removeChildAt(0);}

    // create a new bitmap with the slider content, clone it and add it to the slider container
    var bitMp:Bitmap =  new Bitmap(Bitmap(slideLoader.contentLoaderInfo.content).bitmapData.clone());
    currentContainer.addChild(bitMp);
}

// init slideshow
initSlideshow(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-12T12:21:42.107

如果您在服务器上使用 PHP，例如

```
header('Content-type: applicaiton/xml;charset=utf-8');
$dir = dir('images');
echo '<images>', "\n";
foreach ($dir as $file) {
    if ($file == '.' || $file == '..') {
        continue;
    }
    echo '<image>', $file, '</image>', "\n";
}
echo '</images>'; 
```

应该做的伎俩。

只需将您的幻灯片应用程序指向 PHP 脚本，它就会动态创建列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T21:18:14.780

如果你想跳过加载，你可以简单地将 XML 集成到 actionscript 中：

```
var xmlSlideshow:XML = <images><image /><image /></ images>; 
```

如果您也想跳过它，您可以以某种方式命名图像，以便您可以盲目地加载它们（*image0.jpg、image1.jpg*等），直到您的加载序列引发错误（您当然会捕获）因为*imageN*不存在（虽然这很脏！）。

在这种情况下，最好的方法是拥有一个小型服务器端脚本，列出给定文件夹中的所有文件，并将它们的引用输出到可以从 SWF 中检索的 XML 中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-07T15:42:52.630

除非您通过 AIR 部署 Flash 应用程序，否则您无权访问系统，因此您无法读取文件夹的所有内容。

您可以使用 PHP 或您选择的服务器端语言来读取文件夹的内容并构建您将加载的 xml。

只需更改`strXMLPath`为[http://example.com/yourphpfile.php](http://example.com/yourphpfile.php)，它将作为 xml 文档加载。您应该将 mimetype 更改为`mimetype="application/xml"`.

# asp.net-mvc - 我想使用 ASP.Net MVC。我的服务器是 Win 2003，它使用 IIS 6，所有这些都可以一起工作吗？

> ID：661506
> 
> 赞同：2
> 
> 时间：2009-03-19T09:11:43.913
> 
> 标签：asp.net-mvc, windows, iis, iis-7, iis-6

ASP.Net MVC 终于可以作为第 1 版使用了。在我尝试开始使用它之前，我一直在等待正式发布。目前我有一个专用的网络服务器，我可以通过远程桌面完全访问它。它正在运行带有 IIS6 的 Win 2003 Server（我认为是 IIS6，他们不会在 Help -> About 中打印版本，但一些研究表明 IIS6 是 Win 2003 Server 上的标准）和 .Net 2.0。

显然我需要将框架升级到 .Net 3.0。但在那之后，其他一切都应该工作吗？我以为我在某处看到.Net 3.0 坚持使用 IIS7。如果这是真的，IIS7 是否与 Windows 2003 Server 兼容？

还有您可以指出我的任何文献或有关进行升级/过渡的任何提示吗？

**编辑：** 对不起，太激动了。是的，我的意思是 .Net 3.5。:D

编辑：最后一个问题：有人提到路由问题。我记得在某处读过，但不太记得了。我的项目在很大程度上依赖于良好的谷歌排名，我不想因为路由问题而牺牲页面排名。我仍然可以使用 IIS6 解决它吗？再次感谢。:D

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-19T09:12:57.170

您需要 .NET Framework 3.5，而不是 3.0。最好是SP1。这种设置不会有任何问题。确保您阅读[http://haacked.com/archive/2008/11/26/asp.net-mvc-on-iis-6-walkthrough.aspx](http://haacked.com/archive/2008/11/26/asp.net-mvc-on-iis-6-walkthrough.aspx)

顺便说一句，IIS7 不能安装在 Windows Server 2003 上。ASP.NET MVC 和 .NET Framework 3.5 SP1 不依赖于任何 IIS7 特定功能。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-19T09:56:29.857

根据 Andrew（上面）提到的链接，您有两种使用 IIS6 的选择：

1.  将 mvc 前缀添加到路由（例如 {controller}.mvc/{action}/{id} ）
2.  使用通配符映射（仅限 IIS6/Win2k3 而不是 win XP/iis 5.1）

数字 2 的缺点是，如果您有大量流量，它可能会导致性能问题。但是，有一个解决方法是为静态文件（如 gifs/jpegs/scripts 等）创建一个单独的子目录。有关详细信息，请参阅[Steve Sanderson 的博客文章](http://blog.codeville.net/2008/07/07/overriding-iis6-wildcard-maps-on-individual-directories/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T09:17:49.327

是的，可以在运行 IIS 6.0 的 Windows 2003 服务器上运行 ASP.Net MVC 站点，尽管由于路由的原因，在 IIS 6.0 中需要进行更多配置。哦，你需要.Net Framework 3.5 SP1。

您需要采取的文档和步骤位于[ASP.Net MVC 部署页面上](http://www.asp.net/learn/mvc/tutorial-08-cs.aspx) :o)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-04-29T05:59:43.890

在 Windows 2003/XP 上，我们使用 IIS7 Express 来托管我们的 ASP.NET 4 MVC 3 Web 应用程序。

# c# - 相同的 TableAdapter，不同的 DB

> ID：661511
> 
> 赞同：0
> 
> 时间：2009-03-19T09:13:29.757
> 
> 标签：c#, .net, database, vb.net, tableadapter

必须在开发和生产两个并行环境中工作，我想使用相同的 TableAdapter 以相同的结构连接到不同的数据库（在不同服务器上运行的两个 Oracle 数据库）。这怎么可能？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T16:15:34.587

您是否尝试过更改应用程序数据库连接的连接字符串值？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T16:30:12.163

我以前没有使用过 TableAdapter，我总是在创建 DataSet 时删除它们。相反，我使用 DataAdapters。

这可能有助于更改 TableAdapter 的连接字符串，但我没有尝试过：

[从代码更改数据库连接字符串](http://codebetter.com/blogs/peter.van.ooijen/archive/2006/08/11/Change-a-database-connection-string-from-code.aspx)

# mysql - 如何合并两个具有相同架构的 mysql 数据库？

> ID：661512
> 
> 赞同：0
> 
> 时间：2009-03-19T09:13:31.817
> 
> 标签：mysql, database, merge, foreign-key-relationship

我需要合并两个具有相同架构的两个 mysql 数据库。我正在寻找一些可以读取数据库元数据（PK、FK）并自动生成新 PK、自动更新所有 FK 的工具。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-19T09:22:19.550

查看 SqlYog - [http://www.webyog.com/en/](http://www.webyog.com/en/)。企业版有 30 天的试用期，其中包括一个在数据库之间同步数据的工具（以及许多其他有用的工具）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-05-13T13:58:45.557

对于每张桌子：

```
insert into `target db`.`table`
(`all`,`clumns`,`except`,`pk`) 

select (`all`,`clumns`,`except`,`pk`) form `source db`.`table`; 
```

您可以使用 php 甚至在 sql 中生成它，不要忘记`information_schema`。`columns`

```
select TABLE_NAME,COLUMN_NAME from `information_schema`.`COLUMNS` WHERE `COLUMN_KEY` <> 'PRI' AND TABLE_SCHEMA='source db' 
```

现在你有了所有没有 pk 的列名

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-04-03T14:39:02.803

不确定你的意思，但如果你有两个数据库并想让它们相同，试试这个工具 -[数据库比较](http://nobhillsoft.com/NHDBCompare.aspx)

# git - 如何在公司中设置分布式版本控制

> ID：661515
> 
> 赞同：5
> 
> 时间：2009-03-19T09:15:16.260
> 
> 标签：git, mercurial, dvcs

根据我在开源项目中使用 git 和 mercurial 等分布式版本控制系统 (DVCS) 的经验，大多数设置模型对其项目使用集中设置（想想 GitHub）。

在将分布式 VCS 引入公司时，**您是否有集中设置模型**？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-19T09:42:02.060

拥有某种中央存储库是个好主意，因为它允许您共享代码，但也有一个分支，您可以直接从中生成构建/导出快照。该服务器可能有多个分支，其中一个被认为是“主干”分支。任何以前的版本都会有自己的分支，并且取决于您的团队的层次结构（即，如果您被分成多个组，每个组都致力于应用程序的一个方面），那么可能会有基于团队或功能的分支，但如果您不这样做不要那样工作，这是不必要的。

当然，因为它是分布式的，所以每个开发人员也将拥有自己的本地存储库，以使事情变得又好又快。或者他们每个人都可以有多个存储库，甚至。例如，喜欢在通勤时工作的开发人员可能在他的工作站上有一个存储库，而在他的笔记本电脑上有另一个存储库，他的笔记本电脑上的分支是从他的工作站上的分支中“签出”的。这取决于他。我想“分布式”部分让这种事情变得容易多了，因为你可以在远离网络时提交甚至分支。

如果您从非分布式 VCS 过渡，那么您可以直接滑入与以前相同的模型，因为 DVCS 足够灵活，可以以相同的方式工作。否则，您可以从具有几个分支的单个中央存储库开始，以后创建更多存储库和分支总是很容易的。

最后一件事是您仍然需要备份。各个开发人员都拥有相同事物的副本这一事实增加了冗余，但它并不能*代替*备份。

我经常使用的 DVCS 是 Bazaar。我也尝试过 Mercurial。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-19T19:55:19.037

是的，但你有很多选择。我见过的解释其中一些的最佳图表位于[http://whygitisbetterthanx.com/#any-workflow](http://whygitisbetterthanx.com/#any-workflow)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-01T16:04:48.063

Yes, I think for a company, or at least one product in the company, it is best or at least easiest to have a centralized setup model. You *are* trying to make a single coherent product, after all.

However, DVCS instills a different working spirit and mode which you may or may not want to encourage in your team. In particular, it increases experimentation (just use a local copy, and you're not bothering anyone). It is easier for maintenance of old versions, or if you do a lot of client-specific changes that need to be kept track of without putting them in the actual product.

It is invaluable when you have a team that works offsite a lot. In my company engineers often make last minute changes on site, where for security reasons they don't have internet access. Central VCS simply do not work for this scenario.

So there is a central repository, but the fact that you *can* work in a decentralized manner is invaluable. DVCS is a superset of centralized VCS in terms of workflows. Of course, you can still choose to use a centralized VCS if you don't think you'll need (or want!) the additional options.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-19T09:52:38.417

这并不是将它们与称为中央化 VCS 的其他类型的 VCS 区分开来的功能。

因此，如果公司有 svn 方面的经验。使用存储库和备份模型的专用服务器，您可以为 DVCS 应用几乎相同的东西。

# django - 保存 modelForm 以更新现有记录

> ID：661521
> 
> 赞同：2
> 
> 时间：2009-03-19T09:16:58.953
> 
> 标签：django, save, modelform

我创建了一个带有现有模型（书）实例的模型表单。我无法更新图书记录。添加新记录很好，但是当我尝试更新时，它似乎无法找到发布者（这是一个外键）。错误是“没有发布者与给定的查询匹配。”

# 模型.py

类发布者（模型。模型）：

```
name = models.CharField(max_length=30)

address = models.CharField(max_length=50)

city = models.CharField(max_length=60)

state_province = models.CharField(max_length=30)

country = models.CharField(max_length=50)

website = models.URLField()

def __unicode__(self):
    return self.name

class Meta:

    ordering = ["name"] 
```

类作者（models.Model）：

```
first_name = models.CharField(max_length=30)

last_name = models.CharField(max_length=40)

email = models.EmailField(blank=True, verbose_name='e-mail')

objects = models.Manager()

sel_objects=AuthorManager()

def __unicode__(self):

return self.first_name+' '+ self.last_name 
```

类书（模型。模型）：

```
title = models.CharField(max_length=100)

authors = models.ManyToManyField(Author)

publisher = models.ForeignKey(Publisher)

publication_date = models.DateField(blank=True, null=True)

num_pages = models.IntegerField(blank=True, null=True) 
```

类BookForm（ModelForm）：

```
class Meta:

    model = Book 
```

# 视图.py

def authorcontactupd(request,id):

```
if request.method == 'POST':

    a=Author.objects.get(pk=int(id))

    form = AuthorForm(request.POST, instance=a)

    if form.is_valid():

        form.save()

        return HttpResponseRedirect('/contact/created')

else:

    a=Author.objects.get(pk=int(id))

    form = AuthorForm(instance=a)

return render_to_response('author_form.html', {'form': form}) 
```

# 错误信息

找不到页面 (404) 请求方法：POST 请求 URL：http: [//127.0.0.1 :8000/books/bookupd/](http://127.0.0.1:8000/books/bookupd/)

没有发布者与给定的查询匹配。

您看到此错误是因为您的 Django 设置文件中有 DEBUG = True 。将其更改为 False，Django 将显示标准 404 页面。

# 网址.py

从 django.conf.urls.defaults 导入 *

从 django.views.generic.simple 导入 direct_to_template

从 mysite10.books.views 导入 about_pages、books_by_publisher、authorcontact、bookcontact、booklisting、authorcontactupd

从 django.views.generic 导入 list_detail

从 mysite10.books.models 导入出版商，书籍

从 django.contrib 导入管理员

admin.autodiscover()

def get_books():

```
return Book.objects.all() 
```

出版商信息 = {

```
'queryset': Publisher.objects.all(),

'template_name':'books/publisher_publisher_list_page.html',

'template_object_name': 'publisher',

'extra_context': {'book_list': Book.objects.all}, 
```

}

book_info = {

```
'queryset': Book.objects.order_by('-publication_date'),

'template_name':'books/publisher_publisher_list_page.html',

'template_object_name': 'book',

'extra_context': {'publisher_list': Publisher.objects.all}, 
```

}

oreilly_books = {

```
'queryset': Book.objects.filter(publisher__name="O'Reilly"),

'template_name':'books/publisher_publisher_list_page.html',

'template_object_name': 'book',

'extra_context': {'publisher_list': Publisher.objects.all}, 
```

}

urlpatterns = 模式（''，

```
(r'^admin/(.*)', admin.site.root),

(r'^polls/', include('mysite10.polls.urls')),

(r'^search-form/$', 'mysite10.views.search_form'),

(r'^search/$', 'mysite10.views.search'),

(r'^contact/$', 'mysite10.contact.views.contact'),

(r'^contact/thanks2/(\d+)$', 'mysite10.contact.views.thanks2'),

(r'^contact/thanks/$', 'mysite10.contact.views.thanks'),

(r'^publishers/$', list_detail.object_list, publisher_info),

(r'^books/$', list_detail.object_list, book_info),

(r'^books/oreilly/$', list_detail.object_list, oreilly_books),

(r'^books/(\w+)/$', books_by_publisher),

(r'^author/$', authorcontact),

(r'^authorupd/(\d+)/$', authorcontactupd),

(r'^contact/created/$', 'mysite10.books.views.created'),

(r'^bookform/$', bookcontact),

(r'^contact/bookscreated/$', 'mysite10.books.views.books_created'),

(r'^booklist/$', 'mysite10.books.views.booklisting'),

(r'^books/bookupd/(\d+)$', 'mysite10.books.views.book_upd'), 
```

)

# -------------------------------------------------

我终于让它使用下面的代码。urls.py 中的错误，因为 $ 之前缺少正斜杠。修改为 (r'^books/bookupd/(\d+)/$'

# 视图.py

def book_upd(request,id):

```
if request.method == 'POST':

    a=Book.objects.get(pk=int(id))

    form = BookForm(request.POST, instance=a)

    if form.is_valid():

        form.save()

        return HttpResponseRedirect('/contact/bookscreated')
else:

    a=Book.objects.get(pk=int(id))

    form = BookForm(instance=a)

return render_to_response('book_form.html', {'form': form}) 
```

# 网址.py

(r'^books/bookupd/(\d+)/$', 'mysite10.books.views.book_upd'),

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-19T09:53:41.440

缺少一些信息，例如您的 urls.py 中的内容。你也可以发一下吗？您是否在数据库中检查了记录实际上没有更新？（错误可能是处理重定向的结果）

* * *

您的编辑不够：-您是否检查了数据库以查看记录是否已更新？- 请粘贴整个 urls.py，例如有趣的是看看 /contact/created 映射到什么，以防它成功，或者你是否有一些 publisher.get() 方法

此外，回溯还可以提供很多有用的信息来确定问题的根源。

* * *

即使您收到错误，您是否检查过数据库中的对象是否已更新？

您可以尝试删除“oreilly_books”部分（或至少是查询集部分）并尝试在没有它的情况下做同样的事情吗？

# javascript - Javascript 警报/消息框中的欧元符号或其他实体

> ID：661524
> 
> 赞同：35
> 
> 时间：2009-03-19T09:17:44.380
> 
> 标签：javascript, html-entities

有人知道我如何在 javascript 警报窗口中显示欧元或其他 html 实体吗？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-03-19T09:22:47.287

```
alert('\u20AC'); 
```

[HTML 实体字符查找](http://leftlogic.com/lounge/articles/entity-lookup/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-19T09:24:07.877

```
<script>alert("\u20ac");</script> 
```

（20AC 是欧元符号的 Unicode 字符。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T09:22:40.237

警告框可以显示当前登录会话的代码页中的任何字符。因此，例如，如果机器使用 1252 代码页，您可以显示 eurosign。

不清楚您的麻烦是什么，您的javascript字符串不应该将字符编码为实体吗？

**编辑**：

如果您在 HTML 中指定 UTF-8 或作为 Response.CharSet 但实际上并未将 ASP 文件保存为 UTF-8 格式，那么您将遇到 ASCII 以外的字符问题。

ASP 假定 ASP 文件的静态部分已经在所需的代码页中，并逐字节逐字发送，不会发生编码。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-04-14T17:06:34.140

例如，`U+1234`像这样使用：`alert('\u1234')`.

如需完整列表，您可以查看**所有实体列表**：
1) [http://en.wikipedia.org/wiki/List_of_XML_and_HTML_character_entity_references](http://en.wikipedia.org/wiki/List_of_XML_and_HTML_character_entity_references)
2) [http://www.utf8-chartable.de/](http://www.utf8-chartable.de/)
3) [http://rishida.net/工具/转换/](http://rishida.net/tools/conversion/)（转换器）

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2021-10-03T08:40:28.217

您可以使用字符 €、£、$ 或 ¥，它们是标准 ASCII，并且可以直接在键盘上生成。

# c# - 以正确的方式分层 WCF 服务

> ID：661530
> 
> 赞同：2
> 
> 时间：2009-03-19T09:19:45.327
> 
> 标签：c#, wcf, architecture, n-tier-architecture

我的问题更多的是架构性质，较少涉及实际实现。

我已经构建了一个基于 WCF 的 API，但无法真正决定如何将 PL 与 BL 分开。我已经使我的服务变薄了，因此它只包含最少的实现，例如：

```
public TagItemResponse TagItem(TagItemRequest request)
{
   return (new ItemTagRequestProcessor()).GetResponse(request);
} 
```

当然，第一个问题出现了，RequestProcessors 属于哪一层？我认为称它们为门面是错误的，但同时，它们与演示无关。至于现在，我决定他们仍然属于 PL。处理器方法将我的 DTO（DataContracts）作为输入，验证请求消息（基类），验证（基类）并最终返回单个 DTO 响应，如下所示：

```
protected override void Process(TagItemRequest request, TagItemResponse response, Host host)
{
    var profile = ProfileFacade.GetProfile(host, request.Profile);
    var item = ItemFacade.GetItemId(host, request.Item);
    var tags = new List<Tag>();

    foreach (var name in request.Tags)
    {
        var tag = TagFacade.GetTag(profile, name);
        ItemFacade.TagItem(item, tag);
        tags.Add(tag);
    }

    ItemFacade.UntagItem(item, tags);
} 
```

现在我问自己，为什么我需要 1:1 与我的业务对象相关的外观类。例如，我有一个 HostFacade，它充当 hostDAO 和处理器之间的层。然而，它包含的逻辑很少，它只处理 DAO 调用。

```
public static Host GetHost(HostDTO dto)
{
   return HostDAO.GetHostByCredentials(dto.Username, dto.Password);
} 
```

问题：我还不如合并处理器和外观，对吗？

我已经阅读了许多关于该主题的文章/书籍，但我仍然无法确定“正确”的方式，并且每次遇到问题时都倾向于选择不同的方法。我想知道是否存在正确的方法。

我找到了 f.ex。doFactory 示例，他们直接从服务实现中与 DAO 类进行对话。我不太喜欢这样，因为大多数 ServiceContract 方法共享一些逻辑，因此很适合与共享基类一起使用。

我还发现了其他示例，其中仅从服务中调用外观，但这似乎仅适用于非常细粒度的消息。我的消息是“胖”和复合的，以尽可能减少对服务的调用次数。我的额外处理层似乎是我真正的问题。

关于如何正确分层 WCF 服务可能没有单一的答案，但希望你们中的一些人的意见可以符合我的直觉，或者为我在这个主题上提供一些新的见解。

谢谢！

杰弗里

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-19T15:00:06.523

首先，我假设您所说的 PL 是指表示层，而不是持久层？

在实现分层应用程序设计时，主要问题应该始终是：我能否在不影响上层实现的情况下替换较低层的实现。

持久层通常最好地说明这一点。例如，如果您从 SQL Server 2008 切换到 MySQL，持久层会发生变化（当然）。但是业务层的变化也有必要吗？例如，业务层是否捕获了仅由 SqlClient 抛出的 SqlException 实例？在一个好的设计中，业务层根本不需要改变。

同样的原则也适用于业务层和表示层的分离。

在您的示例中，我会说`ItemTagRequestProcessor`不应该在表示层中。首先，它与表示无关，其次，处理请求的实现与表示层无关。将其与 Web 应用程序相比，向`TagItemResponse`客户端呈现一个是 Web（呈现）层的关注点。检索一个实例`TagItemResponse`是表示层之下的一个层的关注点。

决定是否在业务层和持久层之间有一个门面是很困难的。我通常不实现外观，因为它增加了一个额外的（通常是不必要的）间接层。此外，我认为直接从业务层方法调用持久层方法没有问题。只要你考虑到同样的原则：你能不能改变持久层的实现而不影响业务层的实现。

亲切的问候，

罗纳德·维尔登伯格

# asp.net - SharePoint 2007 远程文件访问被拒绝 CAS

> ID：661534
> 
> 赞同：1
> 
> 时间：2009-03-19T09:20:26.043
> 
> 标签：asp.net, security, sharepoint, moss, code-access-security

我有代码在 SharePoint 2007 的 PageLayout 内的 ascx 中运行，它访问远程服务器上的文件，即 File.Create("\servername\sharename\folder\file.txt")。代码在 web.config 中将 CAS 信任设置为 Full 的 SharePoint Web 应用程序中运行。File.Create 引发以下异常：-

System.UnauthorizedAccessException

拒绝访问路径 '\\servername\sharename\folder\file.txt'。

共享共享给具有完全控制权的所有人，并且 NTFS 权限设置为具有完全控制权的所有人。Web 应用程序池在域帐户下运行，也具有访问该资源的明确权限（不是应该需要的）。

我在远程机器上运行了 Process Monitor，并且服务器上没有记录任何点击。这让我相信这是 SharePoint 代码访问安全设置的问题。就像我上面所说的，对 web.config 的信任设置为 Full。

CAS是否可能仍在阻止远程访问？谁能想到其他要审查的领域？

* * *

**更新**

多一点信息...

我已尝试将应用程序池设置为域管理员，但问题仍然存在。当使用相同的方法访问本地计算机上的驱动器时，它工作正常。使用应用程序池帐户在共享点之外的 SnippetCompiler 中运行相同的代码可以正常工作。

希望这会有所帮助，如果您能想到我可以尝试的更多调查或测试途径，请告诉我。

* * *

**更新**

我不确定这是否会影响问题，但本地服务器正在运行 Windows Server 2003，而远程服务器正在运行 Windows 2000。

* * *

**更新**

我刚刚尝试通过 Web 部件运行代码，它工作正常。我在失败的项目中使用的文件结构如下：-

```
wss
 - VirtualDirectories
   - SharePointWebApp
     - ...sp web app files
     - .
     - .
   - PageLayoutControls
     - control.ascx
     - .
     - . 
```

然后在 IIS 中，我具有以下结构：-

```
IIS
 - Websites
   - SharePointWebApp (pointing to \wss\VirtualDirectories\SharePointWebApp)
     - PageLayoutControls (virtual directory pointing to \wss\VirtualDirectories\PageLayoutControls) 
```

然后在 PageLayouts 中，我使用以下内容引用控件：-

```
<%@ Register TagPrefix="TEST" TagName="MyControl" Src="~/PageLayoutControls/control.ascx" %>
<asp:Content ContentPlaceholderID="PlaceHolderMain" runat="server">
  <TEST:MyControl id="myControl" runat="server"/>
</asp:Content>Let me know if you need more info. 
```

* * *

**更新**

谜团越来越深……

当我从 SharePoint Web 前端服务器上的 Internet Explorer（6 或 7）访问 sharepoint 站点时，我没有收到异常。

当我从 SP Web 前端服务器从 Mozilla Firefox 访问共享点站点时，我确实遇到了异常。

当我从任何浏览器远程访问共享点站点时，我得到了异常。

此外，只要他们有权访问共享点站点，我使用什么用户登录该站点也没有区别。

有什么想法吗？

* * *

**更新**

嗯，我现在发现，如果我远程访问共享点站点并且共享点站点尝试在本地执行 File.Create()（即 File.Create("C:\temp\abc.txt")），那么它可以工作. 如果我从共享点框访问共享点站点并远程执行 File.Create()（即 File.Create("\ServerName\ShareName\FolderName\file.txt")），那么它可以工作。

只有当我远程访问共享点站点并让共享点站点尝试远程执行 File.Create() 时，它才会失败。有点像双跳问题。这让我认为这可能是一个 NTLM / Kerberos 问题。

目前，我们正在使用 NTLM 身份验证运行。

有没有其他人遇到过这种问题？

* * *

**更新**

是的，我很确定这是一个不允许双跳的 NTLM 问题。我刚刚将共享点站点上的身份验证更改为使用基本身份验证并且它有效。将其改回集成身份验证，但失败了。

现在决定是移动服务器场以使用 Kerberos 还是找到解决此问题的其他方法。：-/

* * *

**更新**

现在只是给 SPSecurity.RunWithElevatedPrivileges 一个机会。但有一件事，RunWithElevatedPrivileges 是否意味着在这种情况下使用？以前，我只使用它来访问 SharePoint 中的列表和库，而不是访问网络中的文件。

有什么想法吗？

* * *

**更新**

是的，SPSecurity.RunWithElevatedPrivileges 解决了这个问题。:-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T16:46:06.073

我想知道这是否是双跳问题，并且您的代码正试图以模拟用户的身份访问资源，但这失败了，因为 NTLM 不会模拟到另一台服务器（Kerberos 会）。

您是否尝试过 SPSecurity.RunWithElevatedPrivileges？这将删除模拟（RevertToSelf），然后也许应用程序池所有者可以充当他自己（她自己？），而以前可能不能。

只是一个想法，应该很容易尝试。

# java - 从php发送消息到java

> ID：661546
> 
> 赞同：0
> 
> 时间：2009-03-19T09:26:58.273
> 
> 标签：java, php, ipc

我的应用程序是一个提要聚合器。前端是用 php 编写的，但我有一个 Java 程序会定期运行以更新提要数据库。在当前方案下，如果用户添加要聚合的提要，他必须等到聚合器运行并更新数据库才能看到来自他订阅的提要的新闻。我想要做的是安全地从 php 脚本向聚合器发送一条消息，以发布异常的提要更新。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T09:30:08.767

在 Java 应用程序中打开服务器套接字。然后通过它发送数据。您可以使用 SSL 来保护通信。

[PHP中的套接字通信](http://www.php.net/sockets)

[Java中的套接字通信](http://java.sun.com/docs/books/tutorial/networking/sockets/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-19T10:01:58.580

您可以使用一些成熟的与语言无关的远程通信协议，如 SOAP 或 REST（均由 java 和 php 支持）或开发您自己的基于套接字的解决方案。

附加选项可能是[php-java 桥接](http://php-java-bridge.sourceforge.net/pjb/)器，它有望在性能方面有效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T09:34:30.830

如果 java 程序在 PHP 服务器上，你不能简单地从 php 打开一个 shell 来运行带有参数的 java 程序来触发更新吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-19T09:30:44.973

让 java 应用程序等待套接字上的命令是一个可接受的选择吗？

# java - DynaValidatorForm 的用途

> ID：661547
> 
> 赞同：2
> 
> 时间：2009-03-19T09:27:44.013
> 
> 标签：java, jsp, web-applications, jakarta-ee, struts

struts中DynaValidationForm有什么用？我读过一篇文章，它减少了代码行数和复杂性。谁能告诉它是怎么回事。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-10T21:07:01.347

DynaValidatorForm 实际上是 DynaActionForm 的子类。它实现 validate() 方法很像 ValidatorForm 并调用 Commons Validator。DynaValidatorForm 也带来了为动态表单编写基于 XML 的验证规则的能力。

DynaAcionForm 和 DynaValidatorForm 是页面作者编写简单表单或原型化 Struts 应用程序的好工具，无需在 Java 中编写代码（如操作、表单等）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T09:42:08.270

DynaValidatorForm 根据 XML 中的规则验证表单属性，如果您有很多“简单”规则，则效果最好，这就是它可以减少您自己的代码的原因。

看[http://www.laliluna.de/struts-dynavalidator-form.html](http://www.laliluna.de/struts-dynavalidator-form.html)有关 DynaValidatorForm 的教程。

# php - 谷歌地图 getDistance 不加载页面

> ID：661551
> 
> 赞同：0
> 
> 时间：2009-03-19T09:30:14.773
> 
> 标签：php, google-maps, distance

谷歌地图有一个函数可以让你检索两点之间的距离：GDirections 类的 getDistance()。

现在，这是 Javascript，所以它只能在页面加载后才能计算。

但是，我的搜索表单能够指示您希望自己与他人之间的最大距离是多少，并且基于此，必须提供搜索结果列表。

由于我不能在 PHP 中使用这个函数，有没有另一种方法可以让我计算地球上 2 点之间的距离？通过放弃街道、邮政编码和城市名称，就像谷歌地图需要的一样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T17:20:11.000

Looks like you want to calculate a [Great Circle Distance](http://en.wikipedia.org/wiki/Great_circle_distance)

Formulas have been discussed [here on stackoverflow](https://stackoverflow.com/questions/574691/mysql-great-circle-distance-haversine-formula/) before.

A point on earth is defined by it's latitude and longitude. If you want to calculate the distance between 2 points on earth by giving up the street, postal code and city name, you will need geo-referene data.

This data is available for free on the internet, but the accuracy and availability differ greatly from region to region. (USA data is of good quality, data for Kenia for example will be harder to come by)

**So to answer your question:**
Yes, there are other ways to calculate what you want. But they require more work/are more complex than just querying the google API.
You might want tot read: [Creating a Store Locator with PHP, MySQL & Google Maps](http://code.google.com/support/bin/answer.py?answer=87134&topic=11364)

Hope this points you into the right direction.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T09:44:37.157

此[页面](http://mapki.com/index.php?title=Google_Map_Parameters)包含用于 http 连接的谷歌地图参数列表。通过指定输出参数，您可以选择返回 kml 文件或类似文件，并且可以在任何可以建立 http 连接的语言中使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-03-01T08:43:10.850

您可以使用 kml 文件。它是 xml 格式的文件，您可以通过链接接收，就像`http://maps.google.com/maps?f=d&hl=en&saddr=<src latitude>,<src longitude>&daddr=<dist latitude>,<dist longitude>&ie=UTF8&0&om=0&output=kml` 在接收的文件中一样，您可以解析和总结距离

# c# - 如何从另一个线程更新 GUI？

> ID：661561
> 
> 赞同：1526
> 
> 时间：2009-03-19T09:37:40.090
> 
> 标签：c#, .net, multithreading, winforms, user-interface

哪个是`Label`从另一个更新 a 的最简单方法`Thread`？

*   我有一个`Form`正在运行的`thread1`，然后我开始另一个线程（`thread2`）。

*   在`thread2`处理一些文件时，我想`Label`用`Form`当前`thread2`工作状态更新 a 。

我怎么能那样做？

* * *

## 回答 #1

> 赞同：1165
> 
> 时间：2009-03-19T10:17:51.583

最**简单**的方法是传入匿名方法[`Label.Invoke`](https://msdn.microsoft.com/en-us/library/zyzhdc6b(v=vs.110).aspx)：

```
// Running on the worker thread
string newText = "abc";
form.Label.Invoke((MethodInvoker)delegate {
    // Running on the UI thread
    form.Label.Text = newText;
});
// Back on the worker thread 
```

请注意，`Invoke`在完成之前会阻塞执行——这是同步代码。该问题没有询问异步代码，但是当您想了解异步代码时[，Stack Overflow 上有很多关于编写异步代码的内容。](https://stackoverflow.com/search?q=c%23+await+async+pattern)

* * *

## 回答 #2

> 赞同：808
> 
> 时间：2009-03-19T10:37:59.307

对于 .NET 2.0，这是我编写的一段很好的代码，它完全符合您的要求，并且适用于 a 上的任何属性`Control`：

```
private delegate void SetControlPropertyThreadSafeDelegate(
    Control control, 
    string propertyName, 
    object propertyValue);

public static void SetControlPropertyThreadSafe(
    Control control, 
    string propertyName, 
    object propertyValue)
{
  if (control.InvokeRequired)
  {
    control.Invoke(new SetControlPropertyThreadSafeDelegate               
    (SetControlPropertyThreadSafe), 
    new object[] { control, propertyName, propertyValue });
  }
  else
  {
    control.GetType().InvokeMember(
        propertyName, 
        BindingFlags.SetProperty, 
        null, 
        control, 
        new object[] { propertyValue });
  }
} 
```

像这样称呼它：

```
// thread-safe equivalent of
// myLabel.Text = status;
SetControlPropertyThreadSafe(myLabel, "Text", status); 
```

如果您使用的是 .NET 3.0 或更高版本，则可以将上述方法重写为`Control`该类的扩展方法，这样可以简化对以下的调用：

```
myLabel.SetPropertyThreadSafe("Text", status); 
```

**2010 年 5 月 10 日更新：**

对于 .NET 3.0，您应该使用以下代码：

```
private delegate void SetPropertyThreadSafeDelegate<TResult>(
    Control @this, 
    Expression<Func<TResult>> property, 
    TResult value);

public static void SetPropertyThreadSafe<TResult>(
    this Control @this, 
    Expression<Func<TResult>> property, 
    TResult value)
{
  var propertyInfo = (property.Body as MemberExpression).Member 
      as PropertyInfo;

  if (propertyInfo == null ||
      !@this.GetType().IsSubclassOf(propertyInfo.ReflectedType) ||
      @this.GetType().GetProperty(
          propertyInfo.Name, 
          propertyInfo.PropertyType) == null)
  {
    throw new ArgumentException("The lambda expression 'property' must reference a valid property on this Control.");
  }

  if (@this.InvokeRequired)
  {
      @this.Invoke(new SetPropertyThreadSafeDelegate<TResult> 
      (SetPropertyThreadSafe), 
      new object[] { @this, property, value });
  }
  else
  {
      @this.GetType().InvokeMember(
          propertyInfo.Name, 
          BindingFlags.SetProperty, 
          null, 
          @this, 
          new object[] { value });
  }
} 
```

它使用 LINQ 和 lambda 表达式来允许更简洁、更简单和更安全的语法：

```
myLabel.SetPropertyThreadSafe(() => myLabel.Text, status); // status has to be a string or this will fail to compile 
```

现在不仅在编译时检查属性名称，而且属性的类型也是如此，因此不可能（例如）将字符串值分配给布尔属性，从而导致运行时异常。

不幸的是，这并不能阻止任何人做一些愚蠢的事情，比如传入另一个`Control`的属性和值，所以下面的代码会很高兴地编译：

```
myLabel.SetPropertyThreadSafe(() => aForm.ShowIcon, false); 
```

因此，我添加了运行时检查以确保传入的属性确实属于`Control`被调用的方法。不完美，但仍然比 .NET 2.0 版本好很多。

如果有人对如何改进此代码以提高编译时安全性有任何进一步的建议，请发表评论！

* * *

## 回答 #3

> 赞同：439
> 
> 时间：2013-08-03T13:09:59.713

### 处理长时间的工作

从[.NET 4.5 和 C# 5.0](https://en.wikipedia.org/wiki/C_Sharp_%28programming_language%29#Versions)开始，您应该[***在所有区域***](http://msdn.microsoft.com/en-us/library/hh873175.aspx)（包括 GUI）中使用[**基于任务的异步模式 (TAP)**](http://msdn.microsoft.com/en-us/library/hh873175.aspx)以及[**async**](http://msdn.microsoft.com/en-us/library/vstudio/hh156513.aspx) - [**await**](http://msdn.microsoft.com/en-us/library/vstudio/hh156528.aspx)关键字：[](http://msdn.microsoft.com/en-us/library/hh873175.aspx)

 *> TAP 是推荐用于新开发的异步设计模式

而不是[异步编程模型 (APM)](http://msdn.microsoft.com/en-us/library/ms228963.aspx)和[基于事件的异步模式 (EAP)](http://msdn.microsoft.com/en-us/library/wewwczdw.aspx)（后者包括[BackgroundWorker 类](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker%28v=vs.95%29.aspx)）。

那么，新开发的推荐解决方案是：

1.  事件处理程序的异步实现（是的，仅此而已）：

    ```
    private async void Button_Clicked(object sender, EventArgs e)
    {
        var progress = new Progress<string>(s => label.Text = s);
        await Task.Factory.StartNew(() => SecondThreadConcern.LongWork(progress),
                                    TaskCreationOptions.LongRunning);
        label.Text = "completed";
    } 
    ```

2.  通知 UI 线程的第二个线程的实现：

    ```
    class SecondThreadConcern
    {
        public static void LongWork(IProgress<string> progress)
        {
            // Perform a long running work...
            for (var i = 0; i < 10; i++)
            {
                Task.Delay(500).Wait();
                progress.Report(i.ToString());
            }
        }
    } 
    ```

请注意以下事项：

1.  以顺序方式编写的简短而干净的代码，没有回调和显式线程。
2.  [任务](http://msdn.microsoft.com/en-us/library/system.threading.tasks.task.aspx)而不是[线程](http://msdn.microsoft.com/en-us/library/system.threading.thread.aspx)。
3.  [async](http://msdn.microsoft.com/en-us/library/vstudio/hh156513.aspx)关键字，它允许使用[await](http://msdn.microsoft.com/en-us/library/vstudio/hh156528.aspx)，它反过来阻止事件处理程序在任务完成之前达到完成状态，同时不会阻塞 UI 线程。
4.  支持[关注点分离 (SoC)](http://en.wikipedia.org/wiki/Separation_of_concerns)设计原则且不需要显式调度程序和调用的进度类（请参阅[IProgress 接口）。](http://msdn.microsoft.com/en-us/library/hh138298.aspx)它使用其创建位置（此处为 UI 线程）中的当前[SynchronizationContext](http://msdn.microsoft.com/en-us/library/system.threading.synchronizationcontext.aspx)。
5.  [TaskCreationOptions.LongRunning](http://msdn.microsoft.com/en-us/library/system.threading.tasks.taskcreationoptions.aspx)提示不要将任务排队到[ThreadPool](http://msdn.microsoft.com/en-us/library/system.threading.threadpool.aspx)中。

有关更详细的示例，请参阅： C# 的未来： [Joseph Albahari](http://www.linkedin.com/in/albahari)[的“等待”](http://channel9.msdn.com/Events/TechEd/Australia/Tech-Ed-Australia-2011/DEV411)的人会得到好事。

另请参阅[UI 线程模型](https://stackoverflow.com/a/19023209/2042090)概念。

### 处理异常

下面的代码片段是如何处理异常和切换按钮`Enabled`属性以防止在后台执行期间多次单击的示例。

```
private async void Button_Click(object sender, EventArgs e)
{
    button.Enabled = false;

    try
    {
        var progress = new Progress<string>(s => button.Text = s);
        await Task.Run(() => SecondThreadConcern.FailingWork(progress));
        button.Text = "Completed";
    }
    catch(Exception exception)
    {
        button.Text = "Failed: " + exception.Message;
    }

    button.Enabled = true;
}

class SecondThreadConcern
{
    public static void FailingWork(IProgress<string> progress)
    {
        progress.Report("I will fail in...");
        Task.Delay(500).Wait();

        for (var i = 0; i < 3; i++)
        {
            progress.Report((3 - i).ToString());
            Task.Delay(500).Wait();
        }

        throw new Exception("Oops...");
    }
} 
```

* * *

## 回答 #4

> 赞同：269
> 
> 时间：2012-05-29T18:51:40.457

[Marc Gravell 的](https://stackoverflow.com/questions/661561/how-to-update-the-gui-from-another-thread-in-c/661662#661662)**.NET 4[**最简单**](https://stackoverflow.com/questions/661561/how-to-update-the-gui-from-another-thread-in-c/661662#661662)[解决方案](https://stackoverflow.com/questions/661561/how-to-update-the-gui-from-another-thread-in-c/661662#661662)的变体：**

 **```
control.Invoke((MethodInvoker) (() => control.Text = "new text")); 
```

或者改用 Action 委托：

```
control.Invoke(new Action(() => control.Text = "new text")); 
```

有关两者的比较，请参见此处：[MethodInvoker vs Action for Control.BeginInvoke](https://stackoverflow.com/questions/1167771/methodinvoker-vs-action-for-control-begininvoke)

* * *

## 回答 #5

> 赞同：145
> 
> 时间：2010-08-27T21:10:32.160

.NET 3.5+ 的 Fire and forget 扩展方法

```
using System;
using System.Windows.Forms;

public static class ControlExtensions
{
    /// <summary>
    /// Executes the Action asynchronously on the UI thread, does not block execution on the calling thread.
    /// </summary>
    /// <param name="control"></param>
    /// <param name="code"></param>
    public static void UIThread(this Control @this, Action code)
    {
        if (@this.InvokeRequired)
        {
            @this.BeginInvoke(code);
        }
        else
        {
            code.Invoke();
        }
    }
} 
```

这可以使用以下代码行调用：

```
this.UIThread(() => this.myLabel.Text = "Text Goes Here"); 
```

* * *

## 回答 #6

> 赞同：70
> 
> 时间：2009-03-19T10:31:21.943

这是您应该执行此操作的经典方式：

```
using System;
using System.Windows.Forms;
using System.Threading;

namespace Test
{
    public partial class UIThread : Form
    {
        Worker worker;

        Thread workerThread;

        public UIThread()
        {
            InitializeComponent();

            worker = new Worker();
            worker.ProgressChanged += new EventHandler<ProgressChangedArgs>(OnWorkerProgressChanged);
            workerThread = new Thread(new ThreadStart(worker.StartWork));
            workerThread.Start();
        }

        private void OnWorkerProgressChanged(object sender, ProgressChangedArgs e)
        {
            // Cross thread - so you don't get the cross-threading exception
            if (this.InvokeRequired)
            {
                this.BeginInvoke((MethodInvoker)delegate
                {
                    OnWorkerProgressChanged(sender, e);
                });
                return;
            }

            // Change control
            this.label1.Text = e.Progress;
        }
    }

    public class Worker
    {
        public event EventHandler<ProgressChangedArgs> ProgressChanged;

        protected void OnProgressChanged(ProgressChangedArgs e)
        {
            if(ProgressChanged!=null)
            {
                ProgressChanged(this,e);
            }
        }

        public void StartWork()
        {
            Thread.Sleep(100);
            OnProgressChanged(new ProgressChangedArgs("Progress Changed"));
            Thread.Sleep(100);
        }
    }

    public class ProgressChangedArgs : EventArgs
    {
        public string Progress {get;private set;}
        public ProgressChangedArgs(string progress)
        {
            Progress = progress;
        }
    }
} 
```

您的工作线程有一个事件。您的 UI 线程启动另一个线程来完成工作并连接该工作线程，以便您可以显示工作线程的状态。

然后在 UI 中，你需要跨线程来改变实际的控制……比如标签或进度条。

* * *

## 回答 #7

> 赞同：66
> 
> 时间：2009-03-19T09:46:24.267

简单的解决方案是使用`Control.Invoke`.

```
void DoSomething()
{
    if (InvokeRequired) {
        Invoke(new MethodInvoker(updateGUI));
    } else {
        // Do Something
        updateGUI();
    }
}

void updateGUI() {
    // update gui here
} 
```

* * *

## 回答 #8

> 赞同：50
> 
> 时间：2010-08-27T20:42:50.467

线程代码通常是错误的并且总是难以测试。您无需编写线程代码即可从后台任务更新用户界面。只需使用[BackgroundWorker](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)类来运行任务及其[ReportProgress](http://msdn.microsoft.com/en-us/library/a3zbdb1t.aspx)方法来更新用户界面。通常，您只报告一个完成百分比，但还有另一个包含状态对象的重载。这是一个仅报告字符串对象的示例：

```
 private void button1_Click(object sender, EventArgs e)
    {
        backgroundWorker1.WorkerReportsProgress = true;
        backgroundWorker1.RunWorkerAsync();
    }

    private void backgroundWorker1_DoWork(object sender, DoWorkEventArgs e)
    {
        Thread.Sleep(5000);
        backgroundWorker1.ReportProgress(0, "A");
        Thread.Sleep(5000);
        backgroundWorker1.ReportProgress(0, "B");
        Thread.Sleep(5000);
        backgroundWorker1.ReportProgress(0, "C");
    }

    private void backgroundWorker1_ProgressChanged(
        object sender, 
        ProgressChangedEventArgs e)
    {
        label1.Text = e.UserState.ToString();
    } 
```

如果您总是想更新同一个字段，那很好。如果要进行更复杂的更新，可以定义一个类来表示 UI 状态并将其传递给 ReportProgress 方法。

最后一件事，一定要设置`WorkerReportsProgress`标志，否则该`ReportProgress`方法将被完全忽略。

* * *

## 回答 #9

> 赞同：47
> 
> 时间：2014-05-24T08:45:36.023

绝大多数答案使用[等待发生](https://stackoverflow.com/a/7480544/67824)`Control.Invoke`的竞争条件。例如，考虑接受的答案：

```
string newText = "abc"; // running on worker thread
this.Invoke((MethodInvoker)delegate { 
    someLabel.Text = newText; // runs on UI thread
}); 
```

如果用户在被调用之前关闭了表单`this.Invoke`（记住，`this`是`Form`对象），`ObjectDisposedException`很可能会被解雇。

解决方案是使用`SynchronizationContext`，特别`SynchronizationContext.Current`是如[hamilton.danielb](https://stackoverflow.com/a/21888091/67824)建议的那样（其他答案依赖于`SynchronizationContext`完全没有必要的特定实现）。我会稍微修改他的代码以使用`SynchronizationContext.Post`而不是`SynchronizationContext.Send`虽然（因为通常不需要工作线程等待）：

```
public partial class MyForm : Form
{
    private readonly SynchronizationContext _context;
    public MyForm()
    {
        _context = SynchronizationContext.Current
        ...
    }

    private MethodOnOtherThread()
    {
         ...
         _context.Post(status => someLabel.Text = newText,null);
    }
} 
```

请注意，在 .NET 4.0 及更高版本上，您确实应该将任务用于异步操作。有关等效的基于任务的方法（使用） ，请参阅[n-san 的答案。](https://stackoverflow.com/a/23596503/67824)`TaskScheduler.FromCurrentSynchronizationContext`

最后，在 .NET 4.5 及更高版本上，您还可以使用`Progress<T>`（基本上`SynchronizationContext.Current`在其创建时捕获），如[Ryszard Dżegan 所展示的](https://stackoverflow.com/a/18033198/67824)，用于长时间运行的操作需要在运行 UI 代码的同时仍然工作的情况。

* * *

## 回答 #10

> 赞同：41
> 
> 时间：2009-03-19T09:45:44.313

您必须确保更新发生在正确的线程上；用户界面线程。

为此，您必须调用事件处理程序而不是直接调用它。

您可以通过像这样引发您的事件来做到这一点：

（代码是在这里输入的，所以我没有检查正确的语法等，但它应该能让你继续前进。）

```
if( MyEvent != null )
{
   Delegate[] eventHandlers = MyEvent.GetInvocationList();

   foreach( Delegate d in eventHandlers )
   {
      // Check whether the target of the delegate implements 
      // ISynchronizeInvoke (Winforms controls do), and see
      // if a context-switch is required.
      ISynchronizeInvoke target = d.Target as ISynchronizeInvoke;

      if( target != null && target.InvokeRequired )
      {
         target.Invoke (d, ... );
      }
      else
      {
          d.DynamicInvoke ( ... );
      }
   }
} 
```

请注意，上面的代码不适用于 WPF 项目，因为 WPF 控件不实现`ISynchronizeInvoke`接口。

为了确保上面的代码适用于 Windows 窗体和 WPF 以及所有其他平台，您可以查看`AsyncOperation`,`AsyncOperationManager`和`SynchronizationContext`类。

为了以这种方式轻松引发事件，我创建了一个扩展方法，它允许我通过调用来简化引发事件：

```
MyEvent.Raise(this, EventArgs.Empty); 
```

当然，你也可以使用 BackGroundWorker 类，它会为你抽象出这件事。

* * *

## 回答 #11

> 赞同：33
> 
> 时间：2010-08-24T13:45:22.937

由于场景的琐碎性，我实际上会让 UI 线程轮询状态。我想你会发现它可以很优雅。

```
public class MyForm : Form
{
  private volatile string m_Text = "";
  private System.Timers.Timer m_Timer;

  private MyForm()
  {
    m_Timer = new System.Timers.Timer();
    m_Timer.SynchronizingObject = this;
    m_Timer.Interval = 1000;
    m_Timer.Elapsed += (s, a) => { MyProgressLabel.Text = m_Text; };
    m_Timer.Start();
    var thread = new Thread(WorkerThread);
    thread.Start();
  }

  private void WorkerThread()
  {
    while (...)
    {
      // Periodically publish progress information.
      m_Text = "Still working...";
    }
  }
} 
```

该方法避免了使用`ISynchronizeInvoke.Invoke`and`ISynchronizeInvoke.BeginInvoke`方法时所需的编组操作。使用编组技术没有任何问题，但是您需要注意一些注意事项。

*   确保您不要`BeginInvoke`太频繁地调用，否则它可能会超出消息泵。
*   `Invoke`对工作线程的调用是阻塞调用。它将暂时停止该线程中正在完成的工作。

我在这个答案中提出的策略颠倒了线程的通信角色。UI 线程轮询数据，而不是工作线程推送数据。这是在许多场景中使用的常见模式。由于您想要做的只是显示来自工作线程的进度信息，那么我认为您会发现此解决方案是编组解决方案的绝佳替代方案。它具有以下优点。

*   UI 和工作线程保持松散耦合，而不是紧密耦合它们的`Control.Invoke`or方法。`Control.BeginInvoke`
*   UI 线程不会阻碍工作线程的进程。
*   工作线程不能支配 UI 线程花费在更新上的时间。
*   UI 和工作线程执行操作的时间间隔可以保持独立。
*   工作线程不能超出 UI 线程的消息泵。
*   UI 线程可以决定 UI 更新的时间和频率。

* * *

## 回答 #12

> 赞同：31
> 
> 时间：2009-03-19T09:47:27.460

您需要在 GUI 线程上调用该方法。您可以通过调用 Control.Invoke 来做到这一点。

例如：

```
delegate void UpdateLabelDelegate (string message);

void UpdateLabel (string message)
{
    if (InvokeRequired)
    {
         Invoke (new UpdateLabelDelegate (UpdateLabel), message);
         return;
    }

    MyLabelControl.Text = message;
} 
```

* * *

## 回答 #13

> 赞同：30
> 
> 时间：2013-05-31T11:12:53.190

前面的答案中的 Invoke 东西都不是必需的。

您需要查看 WindowsFormsSynchronizationContext：

```
// In the main thread
WindowsFormsSynchronizationContext mUiContext = new WindowsFormsSynchronizationContext();

...

// In some non-UI Thread

// Causes an update in the GUI thread.
mUiContext.Post(UpdateGUI, userData);

...

void UpdateGUI(object userData)
{
    // Update your GUI controls here
} 
```

* * *

## 回答 #14

> 赞同：25
> 
> 时间：2011-03-02T06:59:59.410

这与上面使用 .NET Framework 3.0 的解决方案类似，但它解决了**编译时安全支持**的问题。

```
public  static class ControlExtension
{
    delegate void SetPropertyValueHandler<TResult>(Control souce, Expression<Func<Control, TResult>> selector, TResult value);

    public static void SetPropertyValue<TResult>(this Control source, Expression<Func<Control, TResult>> selector, TResult value)
    {
        if (source.InvokeRequired)
        {
            var del = new SetPropertyValueHandler<TResult>(SetPropertyValue);
            source.Invoke(del, new object[]{ source, selector, value});
        }
        else
        {
            var propInfo = ((MemberExpression)selector.Body).Member as PropertyInfo;
            propInfo.SetValue(source, value, null);
        }
    }
} 
```

要使用：

```
this.lblTimeDisplay.SetPropertyValue(a => a.Text, "some string");
this.lblTimeDisplay.SetPropertyValue(a => a.Visible, false); 
```

如果用户传递了错误的数据类型，编译器将失败。

```
this.lblTimeDisplay.SetPropertyValue(a => a.Visible, "sometext"); 
```

* * *

## 回答 #15

> 赞同：25
> 
> 时间：2011-12-17T19:51:54.570

救命！在搜索了这个问题后，我发现*FrankG*和*Oregon Ghost*的答案对我来说是最简单最有用的。现在，我在 Visual Basic 中编写代码并通过转换器运行此代码段；所以我不太确定结果如何。

我有一个名为的对话框表单`form_Diagnostics,`，它有一个富文本框，`updateDiagWindow,`我将其用作一种日志显示。我需要能够从所有线程更新其文本。额外的行允许窗口自动滚动到最新的行。

因此，我现在可以从整个程序中的任何位置以您认为无需任何线程即可工作的方式用一行更新显示：

```
 form_Diagnostics.updateDiagWindow(whatmessage); 
```

**主代码（将其放在表单的类代码中）：**

```
#region "---------Update Diag Window Text------------------------------------"
// This sub allows the diag window to be updated by all threads
public void updateDiagWindow(string whatmessage)
{
    var _with1 = diagwindow;
    if (_with1.InvokeRequired) {
        _with1.Invoke(new UpdateDiagDelegate(UpdateDiag), whatmessage);
    } else {
        UpdateDiag(whatmessage);
    }
}
// This next line makes the private UpdateDiagWindow available to all threads
private delegate void UpdateDiagDelegate(string whatmessage);
private void UpdateDiag(string whatmessage)
{
    var _with2 = diagwindow;
    _with2.appendtext(whatmessage);
    _with2.SelectionStart = _with2.Text.Length;
    _with2.ScrollToCaret();
}
#endregion 
```

* * *

## 回答 #16

> 赞同：23
> 
> 时间：2012-05-28T00:23:38.567

```
Label lblText; //initialized elsewhere

void AssignLabel(string text)
{
   if (InvokeRequired)
   {
      BeginInvoke((Action<string>)AssignLabel, text);
      return;
   }

   lblText.Text = text;           
} 
```

请注意，这`BeginInvoke()`是首选，`Invoke()`因为它不太可能导致死锁（但是，仅将文本分配给标签时，这不是问题）：

使用时，`Invoke()`您正在等待方法返回。现在，可能是您在调用的代码中做了一些需要等待线程的事情，如果它隐藏在您正在调用的某些函数中，这可能不会立即显而易见，这本身可能通过事件处理程序间接发生。因此，您将等待线程，线程将等待您，而您陷入僵局。

这实际上导致我们发布的一些软件挂起。`Invoke()`用替换它很容易修复`BeginInvoke()`。除非您需要同步操作，如果您需要返回值，则可能是这种情况，请使用`BeginInvoke()`.

* * *

## 回答 #17

> 赞同：22
> 
> 时间：2010-08-23T23:13:21.160

出于许多目的，它就像这样简单：

```
public delegate void serviceGUIDelegate();
private void updateGUI()
{
  this.Invoke(new serviceGUIDelegate(serviceGUI));
} 
```

“serviceGUI()”是表单 (this) 中的一种 GUI 级方法，可以根据需要更改任意数量的控件。从另一个线程调用“updateGUI()”。可以添加参数来传递值，或者（可能更快）使用类范围变量并根据需要对它们进行锁定，如果访问它们的线程之间存在任何可能导致不稳定的冲突的话。如果非 GUI 线程时间紧迫（记住 Brian Gideon 的警告），请使用 BeginInvoke 而不是 Invoke。

* * *

## 回答 #18

> 赞同：22
> 
> 时间：2012-10-24T06:38:45.820

当我遇到同样的问题时，我向谷歌寻求帮助，但它没有给我一个简单的解决方案，而是通过举一些例子让我更加困惑`MethodInvoker`。所以我决定自己解决。这是我的解决方案：

像这样做一个代表：

```
Public delegate void LabelDelegate(string s);

void Updatelabel(string text)
{
   if (label.InvokeRequired)
   {
       LabelDelegate LDEL = new LabelDelegate(Updatelabel);
       label.Invoke(LDEL, text);
   }
   else
       label.Text = text
} 
```

您可以像这样在新线程中调用此函数

```
Thread th = new Thread(() => Updatelabel("Hello World"));
th.start(); 
```

不要与`Thread(() => .....)`. 我在处理线程时使用匿名函数或 lambda 表达式。为了减少代码行数，您也可以使用`ThreadStart(..)`我不应该在这里解释的方法。

* * *

## 回答 #19

> 赞同：21
> 
> 时间：2011-09-15T20:40:57.570

这在我的 Ian Kemp 解决方案的 C# 3.0 变体中：

```
public static void SetPropertyInGuiThread<C,V>(this C control, Expression<Func<C, V>> property, V value) where C : Control
{
    var memberExpression = property.Body as MemberExpression;
    if (memberExpression == null)
        throw new ArgumentException("The 'property' expression must specify a property on the control.");

    var propertyInfo = memberExpression.Member as PropertyInfo;
    if (propertyInfo == null)
        throw new ArgumentException("The 'property' expression must specify a property on the control.");

    if (control.InvokeRequired)
        control.Invoke(
            (Action<C, Expression<Func<C, V>>, V>)SetPropertyInGuiThread,
            new object[] { control, property, value }
        );
    else
        propertyInfo.SetValue(control, value, null);
} 
```

你这样称呼它：

```
myButton.SetPropertyInGuiThread(b => b.Text, "Click Me!") 
```

1.  它为“as MemberExpression”的结果添加了空值检查。
2.  它提高了静态类型安全性。

否则，原版是一个非常好的解决方案。

* * *

## 回答 #20

> 赞同：18
> 
> 时间：2016-01-11T19:47:30.690

只需使用这样的东西：

```
 this.Invoke((MethodInvoker)delegate
            {
                progressBar1.Value = e.ProgressPercentage; // runs on UI thread
            }); 
```

* * *

## 回答 #21

> 赞同：17
> 
> 时间：2016-11-17T23:26:19.153

在这个问题上，大多数其他答案对我来说有点复杂（我是 C# 新手），所以我正在写我的：

我有一个**WPF**应用程序并定义了一个工作人员，如下所示：

问题：

```
BackgroundWorker workerAllocator;
workerAllocator.DoWork += delegate (object sender1, DoWorkEventArgs e1) {
    // This is my DoWork function.
    // It is given as an anonymous function, instead of a separate DoWork function

    // I need to update a message to textbox (txtLog) from this thread function

    // Want to write below line, to update UI
    txt.Text = "my message"

    // But it fails with:
    //  'System.InvalidOperationException':
    //  "The calling thread cannot access this object because a different thread owns it"
} 
```

解决方案：

```
workerAllocator.DoWork += delegate (object sender1, DoWorkEventArgs e1)
{
    // The below single line works
    txtLog.Dispatcher.BeginInvoke((Action)(() => txtLog.Text = "my message"));
} 
```

我还没有弄清楚上面那行是什么意思，但它确实有效。

对于**WinForms**：

解决方案：

```
txtLog.Invoke((MethodInvoker)delegate
{
    txtLog.Text = "my message";
}); 
```

* * *

## 回答 #22

> 赞同：16
> 
> 时间：2012-02-22T13:01:42.927

我的版本是插入**一行**递归“咒语”：

对于没有参数：

```
 void Aaaaaaa()
    {
        if (InvokeRequired) { Invoke(new Action(Aaaaaaa)); return; } //1 line of mantra

        // Your code!
    } 
```

对于有参数的函数：

```
 void Bbb(int x, string text)
    {
        if (InvokeRequired) { Invoke(new Action<int, string>(Bbb), new[] { x, text }); return; }
        // Your code!
    } 
```

**就是这样**。

* * *

**一些争论**`if ()`：通常将 {} 放在一行中的语句之后是不利于代码可读性的。但在这种情况下，它是例行公事的“口头禅”。如果此方法在项目中保持一致，则不会破坏代码的可读性。并且它可以防止您的代码乱扔垃圾（一行代码而不是五行代码）。

如您所见`if(InvokeRequired) {something long}`，您只知道“从另一个线程调用此函数是安全的”。

* * *

## 回答 #23

> 赞同：16
> 
> 时间：2012-07-27T23:08:45.533

您可以使用已经存在的委托`Action`：

```
private void UpdateMethod()
{
    if (InvokeRequired)
    {
        Invoke(new Action(UpdateMethod));
    }
} 
```

* * *

## 回答 #24

> 赞同：14
> 
> 时间：2014-02-19T17:36:56.037

创建一个类变量：

```
SynchronizationContext _context; 
```

在创建 UI 的构造函数中设置它：

```
var _context = SynchronizationContext.Current; 
```

当您要更新标签时：

```
_context.Send(status =>{
    // UPDATE LABEL
}, null); 
```

* * *

## 回答 #25

> 赞同：13
> 
> 时间：2013-06-17T07:06:06.303

尝试使用此刷新标签

```
public static class ExtensionMethods
{
    private static Action EmptyDelegate = delegate() { };

    public static void Refresh(this UIElement uiElement)
    {
        uiElement.Dispatcher.Invoke(DispatcherPriority.Render, EmptyDelegate);
    }
} 
```

* * *

## 回答 #26

> 赞同：13
> 
> 时间：2013-09-10T13:55:34.647

您必须使用调用和委托

```
private delegate void MyLabelDelegate();
label1.Invoke( new MyLabelDelegate(){ label1.Text += 1; }); 
```

* * *

## 回答 #27

> 赞同：12
> 
> 时间：2018-11-17T21:40:04.957

**还有另一种通用的*控制*扩展方法..**

*首先为Control*类型的对象添加一个扩展方法

 *```
public static void InvokeIfRequired<T>(this T c, Action<T> action) where T : Control
{
    if (c.InvokeRequired)
    {
        c.Invoke(new Action(() => action(c)));
    }
    else
    {
        action(c);
    }
} 
```

并像这样从另一个线程调用以访问 UI 线程中名为 object1 的控件：

```
object1.InvokeIfRequired(c => { c.Visible = true; });
object1.InvokeIfRequired(c => { c.Text = "ABC"; }); 
```

..或者像这样

```
object1.InvokeIfRequired(c => 
  { 
      c.Text = "ABC";
      c.Visible = true; 
  }
); 
```

* * *

## 回答 #28

> 赞同：11
> 
> 时间：2016-06-27T11:31:35.197

WPF 应用程序中最简单的方法是：

```
this.Dispatcher.Invoke((Action)(() =>
{
    // This refers to a form in a WPF application 
    val1 = textBox.Text; // Access the UI 
})); 
```

* * *

## 回答 #29

> 赞同：10
> 
> 时间：2014-05-11T18:43:31.803

当您在 UI 线程中时，您可以向它询问其同步上下文任务调度程序。它会给你一个[TaskScheduler](http://msdn.microsoft.com/en-us/library/dd997402%28v=vs.110%29.aspx)来安排 UI 线程上的一切。

然后，您可以链接您的任务，以便当结果准备好时，另一个任务（在 UI 线程上安排）选择它并将其分配给一个标签。

```
public partial class MyForm : Form
{
  private readonly TaskScheduler _uiTaskScheduler;
  public MyForm()
  {
    InitializeComponent();
    _uiTaskScheduler = TaskScheduler.FromCurrentSynchronizationContext();
  }

  private void buttonRunAsyncOperation_Click(object sender, EventArgs e)
  {
    RunAsyncOperation();
  }

  private void RunAsyncOperation()
  {
    var task = new Task<string>(LengthyComputation);
    task.ContinueWith(antecedent =>
                         UpdateResultLabel(antecedent.Result), _uiTaskScheduler);
    task.Start();
  }

  private string LengthyComputation()
  {
    Thread.Sleep(3000);
    return "47";
  }

  private void UpdateResultLabel(string text)
  {
    labelResult.Text = text;
  }
} 
```

这适用于[现在是编写并发代码的首选方式的](http://msdn.microsoft.com/en-us/library/dd460717.aspx)任务（不是线程） 。

* * *

## 回答 #30

> 赞同：9
> 
> 时间：2014-03-19T06:27:14.267

例如，访问当前线程以外的控件：

```
Speed_Threshold = 30;
textOutput.Invoke(new EventHandler(delegate
{
    lblThreshold.Text = Speed_Threshold.ToString();
})); 
```

有`lblThreshold`一个标签并且`Speed_Threshold`是一个全局变量。

* * *

## 回答 #31

> 赞同：8
> 
> 时间：2014-02-18T04:41:41.113

我认为最简单的方法：

```
 void Update()
   {
       BeginInvoke((Action)delegate()
       {
           //do your update
       });
   } 
```

* * *

## 回答 #32

> 赞同：8
> 
> 时间：2014-11-06T15:39:59.477

我刚刚阅读了答案，这似乎是一个非常热门的话题。我目前正在使用 .NET 3.5 SP1 和 Windows 窗体。

在前面的答案中详细描述的使用**InvokeRequired**属性的众所周知的公式涵盖了大多数情况，但不是整个池。

如果**Handle**还没有创建呢？

InvokeRequired属性，如此处所述**（**[Control.InvokeRequired Property reference to MSDN）](http://msdn.microsoft.com/it-it/library/system.windows.forms.control.invokerequired(v=vs.90).aspx)如果调用是从不是 GUI 线程的线程进行的，则返回 true，如果调用是从 GUI 线程进行的，或者**Handle**是尚未创建。

如果您想让另一个线程显示和更新模态表单，您可能会遇到异常。因为您希望以模态方式显示该表单，您可以执行以下操作：

```
private MyForm _gui;

public void StartToDoThings()
{
    _gui = new MyForm();
    Thread thread = new Thread(SomeDelegate);
    thread.Start();
    _gui.ShowDialog();
} 
```

并且代理可以更新 GUI 上的标签：

```
private void SomeDelegate()
{
    // Operations that can take a variable amount of time, even no time
    //... then you update the GUI
    if(_gui.InvokeRequired)
        _gui.Invoke((Action)delegate { _gui.Label1.Text = "Done!"; });
    else
        _gui.Label1.Text = "Done!";
} 
```

如果标签更新之前的操作“花费更少的时间”（阅读它并将其解释为简化）比 GUI 线程创建**Form**的**Handle**所需的时间，这可能会导致**InvalidOperationException**。这发生在**ShowDialog()**方法中。

 ******您还应该像这样检查**句柄**：

```
private void SomeDelegate()
{
    // Operations that can take a variable amount of time, even no time
    //... then you update the GUI
    if(_gui.IsHandleCreated)  //  <---- ADDED
        if(_gui.InvokeRequired)
            _gui.Invoke((Action)delegate { _gui.Label1.Text = "Done!"; });
        else
            _gui.Label1.Text = "Done!";
} 
```

如果**Handle**尚未创建，您可以处理要执行的操作：您可以忽略 GUI 更新（如上面的代码所示），或者您可以等待（风险更大）。这应该回答这个问题。

可选的东西：我个人想出了以下代码：

```
public class ThreadSafeGuiCommand
{
  private const int SLEEPING_STEP = 100;
  private readonly int _totalTimeout;
  private int _timeout;

  public ThreadSafeGuiCommand(int totalTimeout)
  {
    _totalTimeout = totalTimeout;
  }

  public void Execute(Form form, Action guiCommand)
  {
    _timeout = _totalTimeout;
    while (!form.IsHandleCreated)
    {
      if (_timeout <= 0) return;

      Thread.Sleep(SLEEPING_STEP);
      _timeout -= SLEEPING_STEP;
    }

    if (form.InvokeRequired)
      form.Invoke(guiCommand);
    else
      guiCommand();
  }
} 
```

我用这个**ThreadSafeGuiCommand**的实例提供由另一个线程更新的表单，并且我定义了更新 GUI（在我的表单中）的方法，如下所示：

```
public void SetLabeTextTo(string value)
{
  _threadSafeGuiCommand.Execute(this, delegate { Label1.Text = value; });
} 
```

通过这种方式，我很确定我将更新我的 GUI，无论线程将进行调用，可选地等待明确定义的时间量（超时）。

* * *

## 回答 #33

> 赞同：8
> 
> 时间：2015-10-31T16:51:46.147

即使操作很耗时（在我的示例中为 thread.sleep） - 此代码不会锁定您的 UI：

```
 private void button1_Click(object sender, EventArgs e)
 {

      Thread t = new Thread(new ThreadStart(ThreadJob));
      t.IsBackground = true;
      t.Start();         
 }

 private void ThreadJob()
 {
     string newValue= "Hi";
     Thread.Sleep(2000); 

     this.Invoke((MethodInvoker)delegate
     {
         label1.Text = newValue; 
     });
 } 
```

* * *

## 回答 #34

> 赞同：7
> 
> 时间：2015-12-19T09:27:10.117

我无法理解这个丑陋实现背后的微软逻辑，但你必须有两个功能：

```
void setEnableLoginButton()
{
  if (InvokeRequired)
  {
    // btn_login can be any conroller, (label, button textbox ..etc.)

    btn_login.Invoke(new MethodInvoker(setEnable));

    // OR
    //Invoke(new MethodInvoker(setEnable));
  }
  else {
    setEnable();
  }
}

void setEnable()
{
  btn_login.Enabled = isLoginBtnEnabled;
} 
```

这些片段对我有用，所以我可以在另一个线程上做一些事情，然后我更新 GUI：

```
Task.Factory.StartNew(()=>
{
    // THIS IS NOT GUI
    Thread.Sleep(5000);
    // HERE IS INVOKING GUI
    btn_login.Invoke(new Action(() => DoSomethingOnGUI()));
});

private void DoSomethingOnGUI()
{
   // GUI
   MessageBox.Show("message", "title", MessageBoxButtons.OK, MessageBoxIcon.Exclamation);
} 
```

更简单：

```
btn_login.Invoke(new Action(()=>{ /* HERE YOU ARE ON GUI */ })); 
```

* * *

## 回答 #35

> 赞同：7
> 
> 时间：2019-04-11T13:17:06.967

只需使用 ui 的同步上下文

```
using System.Threading;

// ...

public partial class MyForm : Form
{
    private readonly SynchronizationContext uiContext;

    public MyForm()
    {
        InitializeComponent();
        uiContext = SynchronizationContext.Current; // get ui thread context
    }

    private void button1_Click(object sender, EventArgs e)
    {
        Thread t = new Thread(() =>
            {// set ui thread context to new thread context                            
             // for operations with ui elements to be performed in proper thread
             SynchronizationContext
                 .SetSynchronizationContext(uiContext);
             label1.Text = "some text";
            });
        t.Start();
    }
} 
```

* * *

## 回答 #36

> 赞同：6
> 
> 时间：2014-02-06T09:46:30.237

我想添加一个警告，因为我注意到一些简单的解决方案省略了`InvokeRequired`检查。

我注意到，如果您的代码**在创建控件的窗口句柄之前**执行（例如，在显示窗体之前），`Invoke`则会引发异常。`InvokeRequired`所以我建议在打电话`Invoke`或之前总是检查一下`BeginInvoke`。

* * *

## 回答 #37

> 赞同：6
> 
> 时间：2014-05-01T11:29:36.190

也许有点过量，但这是我通常解决这个问题的一种方式：

由于同步，此处不需要调用。BasicClassThreadExample 对我来说只是一种布局，因此请根据您的实际需要进行更改。

这很简单，因为您不需要在 UI 线程中处理这些东西！

```
public partial class Form1 : Form
{
    BasicClassThreadExample _example;

    public Form1()
    {
        InitializeComponent();
        _example = new BasicClassThreadExample();
        _example.MessageReceivedEvent += _example_MessageReceivedEvent;
    }

    void _example_MessageReceivedEvent(string command)
    {
        listBox1.Items.Add(command);
    }

    private void button1_Click(object sender, EventArgs e)
    {
        listBox1.Items.Clear();
        _example.Start();
    }
}

public class BasicClassThreadExample : IDisposable
{
    public delegate void MessageReceivedHandler(string msg);

    public event MessageReceivedHandler MessageReceivedEvent;

    protected virtual void OnMessageReceivedEvent(string msg)
    {
        MessageReceivedHandler handler = MessageReceivedEvent;
        if (handler != null)
        {
            handler(msg);
        }
    }

    private System.Threading.SynchronizationContext _SynchronizationContext;
    private System.Threading.Thread _doWorkThread;
    private bool disposed = false;

    public BasicClassThreadExample()
    {
        _SynchronizationContext = System.ComponentModel.AsyncOperationManager.SynchronizationContext;
    }

    public void Start()
    {
        _doWorkThread = _doWorkThread ?? new System.Threading.Thread(dowork);

        if (!(_doWorkThread.IsAlive))
        {
            _doWorkThread = new System.Threading.Thread(dowork);
            _doWorkThread.IsBackground = true;
            _doWorkThread.Start();
        }
    }

    public void dowork()
    {
        string[] retval = System.IO.Directory.GetFiles(@"C:\Windows\System32", "*.*", System.IO.SearchOption.TopDirectoryOnly);
        foreach (var item in retval)
        {
            System.Threading.Thread.Sleep(25);
            _SynchronizationContext.Post(new System.Threading.SendOrPostCallback(delegate(object obj)
            {
                OnMessageReceivedEvent(item);
            }), null);
        }
    }

    protected virtual void Dispose(bool disposing)
    {
        if (!disposed)
        {
            if (disposing)
            {
                _doWorkThread.Abort();
            }
            disposed = true;
        }
    }

    public void Dispose()
    {
        Dispose(true);
        GC.SuppressFinalize(this);
    }

    ~BasicClassThreadExample() { Dispose(false); }

} 
```

* * *

## 回答 #38

> 赞同：6
> 
> 时间：2015-01-31T13:33:05.163

基本上，无论框架版本或 GUI 底层库类型如何，解决此问题的方法是保存为工作线程创建线程的同步上下文的控件，该工作线程会将控件的相关交互从工作线程编组到 GUI 的线程消息队列。

例子：

```
SynchronizationContext ctx = SynchronizationContext.Current; // From control
ctx.Send\Post... // From worker thread 
```

* * *

## 回答 #39

> 赞同：6
> 
> 时间：2016-05-16T01:50:41.380

这是一个使用更实用的风格的古老问题的新面貌。如果您在所有项目中都保留 TaskXM 类，那么您只需一行代码就不必再担心跨线程更新。

```
public class Example
{
    /// <summary>
    /// No more delegates, background workers, etc. Just one line of code as shown below.
    /// Note it is dependent on the Task Extension method shown next.
    /// </summary>
    public async void Method1()
    {
        // Still on the GUI thread here if the method was called from the GUI thread
        // This code below calls the extension method which spins up a new task and calls back.
        await TaskXM.RunCodeAsync(() =>
        {
            // Running an asynchronous task here
            // Cannot update the GUI thread here, but can do lots of work
        });
        // Can update GUI on this line
    }
}

/// <summary>
/// A class containing extension methods for the Task class
/// </summary>
public static class TaskXM
{
    /// <summary>
    /// RunCodeAsyc is an extension method that encapsulates the Task.run using a callback
    /// </summary>
    /// <param name="Code">The caller is called back on the new Task (on a different thread)</param>
    /// <returns></returns>
    public async static Task RunCodeAsync(Action Code)
    {
        await Task.Run(() =>
        {
            Code();
        });
        return;
    }
} 
```

* * *

## 回答 #40

> 赞同：6
> 
> 时间：2017-03-05T07:42:26.713

关于这个主题的另一个例子：我做了一个抽象类，UiSynchronizeModel，它包含一个公共方法实现：

```
public abstract class UiSynchronizeModel
{
    private readonly TaskScheduler uiSyncContext;
    private readonly SynchronizationContext winformsOrDefaultContext;

    protected UiSynchronizeModel()
    {
        this.winformsOrDefaultContext = SynchronizationContext.Current ?? new SynchronizationContext();
        this.uiSyncContext = TaskScheduler.FromCurrentSynchronizationContext();
    }

    protected void RunOnGuiThread(Action action)
    {
        this.winformsOrDefaultContext.Post(o => action(), null);
    }

    protected void CompleteTask(Task task, TaskContinuationOptions options, Action<Task> action)
    {
        task.ContinueWith(delegate
        {
            action(task);
            task.Dispose();
        }, CancellationToken.None, options, this.uiSyncContext);
    }
} 
```

您的模型或控制器类应该派生自这个抽象类。您可以使用任何模式（任务或手动管理的后台线程）并使用这些方法，如下所示：

```
public void MethodThatCalledFromBackroundThread()
{
   this.RunOnGuiThread(() => {
       // Do something over UI controls
   });
} 
```

任务示例：

```
var task = Task.Factory.StartNew(delegate
{
    // Background code
    this.RunOnGuiThread(() => {
        // Do something over UI controls
    });
});

this.CompleteTask(task, TaskContinuationOptions.OnlyOnRanToCompletion, delegate
{
    // Code that can safely use UI controls
}); 
```

* * *

## 回答 #41

> 赞同：5
> 
> 时间：2017-01-18T13:01:31.950

首先获取表单的实例（在本例中为 mainForm），然后在另一个线程中使用此代码。

```
mainForm.Invoke(new MethodInvoker(delegate () 
{
    // Update things in my mainForm here
    mainForm.UpdateView();
})); 
```

* * *

## 回答 #42

> 赞同：4
> 
> 时间：2017-03-25T04:40:40.107

将一些公共变量放在一个单独的类中以保存该值。

例子：

```
public  class data_holder_for_controls
{
    // It will hold the value for your label
    public string status = string.Empty;
}

class Demo
{
    public static  data_holder_for_controls d1 = new data_holder_for_controls();

    static void Main(string[] args)
    {
        ThreadStart ts = new ThreadStart(perform_logic);
        Thread t1 = new Thread(ts);
        t1.Start();
        t1.Join();
        //your_label.Text=d1.status; --- can access it from any thread
    }

    public static void perform_logic()
    {
        // Put some code here in this function
        for (int i = 0; i < 10; i++)
        {
            // Statements here
        }
        // Set the result in the status variable
        d1.status = "Task done";
    }
} 
```

* * *

## 回答 #43

> 赞同：3
> 
> 时间：2014-01-27T13:39:27.423

我更喜欢这个：

```
private void UpdateNowProcessing(string nowProcessing)
{
    if (this.InvokeRequired)
    {
        Action<string> d = UpdateNowProcessing;
        Invoke(d, nowProcessing);
    }
    else
    {
        this.progressDialog.Next(nowProcessing);
    }            
} 
```

* * *

## 回答 #44

> 赞同：3
> 
> 时间：2019-04-11T12:00:11.080

一般的做法是这样的：

```
using System;
using System.Threading;
using System.Windows.Forms;

namespace WindowsFormsApp1
{
    public partial class Form1 : Form
    {
        int clickCount = 0;

        public Form1()
        {
            InitializeComponent();
            label1.SetText("0");
        }

        private void button1_Click(object sender, EventArgs e)
        {
            new Thread(() => label1.SetText((++clickCount).ToString())).Start();
        }
    }

    public static class ControlExtensions
    {
        public static void SetText(this Control control, string text)
        {
            if (control.InvokeRequired)
                control.Invoke(setText, control, text);
            else
                control.Text = text;
        }

        private static readonly Action<Control, string> setText =
            (control, text) => control.Text = text;
    }
} 
```

**说明**：

答案很像[这个](https://stackoverflow.com/a/661706/10958092)。但使用更整洁（对我而言）和更新的语法。点是 的`InvokeRequired`属性`control`。它获取一个值，该值指示调用者在对控件进行方法调用时是否必须调用调用方法，因为调用者位于与创建控件的线程不同的线程上。因此，如果我们调用创建`control.SetText("some text")`的同一线程`control`，只需设置`Text`为 this即可`control.Text = text`。但是在任何其他线程上它会导致`System.InvalidOperationException`因此必须调用一个方法`control.Invoke(...)`来设置创建`Text`的线程`control`。

* * *

## 回答 #45

> 赞同：2
> 
> 时间：2015-08-08T07:49:16.220

就我而言（WPF），解决方案很简单：

```
private void updateUI()
{
    if (!Dispatcher.CheckAccess())
    {
        Dispatcher.BeginInvoke(updateUI);
        return;
    }

    // Update any number of controls here
} 
```

* * *

## 回答 #46

> 赞同：2
> 
> 时间：2018-02-28T10:22:53.213

最简单的方法是调用如下：

```
 Application.Current.Dispatcher.Invoke(new Action(() =>
             {
                    try
                    {
                        ///
                    }
                    catch (Exception)
                    {
                      //
                    }

                    }
     )); 
```

* * *

## 回答 #47

> 赞同：0
> 
> 时间：2014-07-02T07:28:31.050

为了在 WPF 中实现这一点，我采用以下方式。

```
 new Thread(() => 
 {
     while (...)
     {
         SomeLabel.Dispatcher.BeginInvoke((Action)(() => SomeLabel.Text = ...));
     }
 }).Start(); 
```

# javascript - 如何在javascript中格式化浮点数？

> ID：661562
> 
> 赞同：467
> 
> 时间：2009-03-19T09:38:00.993
> 
> 标签：javascript, floating-point

在 JavaScript 中，当从浮点数转换为字符串时，我怎样才能得到小数点后的 2 位数字？例如，0.34 而不是 0.3445434。

* * *

## 回答 #1

> 赞同：912
> 
> 时间：2009-03-19T09:42:16.477

有四舍五入的功能。例如：

```
var x = 5.0364342423;
print(x.toFixed(2)); 
```

将打印 5.04。

**编辑：** [小提琴](http://jsfiddle.net/TM7DQ/)

* * *

## 回答 #2

> 赞同：247
> 
> 时间：2009-03-19T09:39:50.350

```
var result = Math.round(original*100)/100; 
```

[详细信息](http://www.javascriptkit.com/javatutors/round.shtml)，以防代码不言自明。

编辑：...或者只是使用`[toFixed](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/toFixed)`，正如[Tim Büthe](https://stackoverflow.com/questions/661562/comma-format-in-javascript/661579#661579)所提议的那样。忘了那个，谢谢（和赞成）提醒:)

* * *

## 回答 #3

> 赞同：190
> 
> 时间：2009-03-19T10:56:07.937

使用时要小心`toFixed()`：

首先，使用数字的二进制表示对数字进行四舍五入，这可能会导致意外行为。例如

```
(0.595).toFixed(2) === '0.59' 
```

而不是`'0.6'`.

其次，有一个 IE 错误`toFixed()`。在 IE（至少到版本 7，没有检查 IE8）中，以下情况成立：

```
(0.9).toFixed(0) === '0' 
```

遵循 kkyy 的建议或使用自定义`toFixed()`函数可能是个好主意，例如

```
function toFixed(value, precision) {
    var power = Math.pow(10, precision || 0);
    return String(Math.round(value * power) / power);
} 
```

* * *

## 回答 #4

> 赞同：41
> 
> 时间：2015-03-25T06:55:03.493

另一个需要注意的问题是，它`toFixed()`会在数字末尾产生不必要的零。例如：

```
var x=(23-7.37)
x
15.629999999999999
x.toFixed(6)
"15.630000" 
```

这个想法是使用 a 清理输出`RegExp`：

```
function humanize(x){
  return x.toFixed(6).replace(/\.?0*$/,'');
} 
```

匹配尾随零（以及可选的`RegExp`小数点）以确保它也适合整数。

```
humanize(23-7.37)
"15.63"
humanize(1200)
"1200"
humanize(1200.03)
"1200.03"
humanize(3/4)
"0.75"
humanize(4/3)
"1.333333" 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-03-19T09:40:54.933

```
var x = 0.3445434
x = Math.round (x*100) / 100 // this will make nice rounding 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2014-02-05T16:16:31.120

所有这些使用乘法器浮动的解决方案都存在问题。不幸的是，kyyy 和 Christoph 的解决方案都是错误的。

请测试您的代码**551.175**的 2 位小数 - 它将四舍五入为**551.17**而它应该是**551.18**！但如果你测试前。451.175 没问题 - 451.18。所以乍一看很难发现这个错误。

问题在于乘法：尝试 551.175 * 100 = 55117.49999999999 （ups！）

所以我的想法是在使用 Math.round() 之前用 toFixed() 处理它；

```
function roundFix(number, precision)
{
    var multi = Math.pow(10, precision);
    return Math.round( (number * multi).toFixed(precision + 1) ) / multi;
} 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2018-04-16T16:50:14.193

我猜这里的关键是先正确四舍五入，然后你可以将它转换为字符串。

```
function roundOf(n, p) {
    const n1 = n * Math.pow(10, p + 1);
    const n2 = Math.floor(n1 / 10);
    if (n1 >= (n2 * 10 + 5)) {
        return (n2 + 1) / Math.pow(10, p);
    }
    return n2 / Math.pow(10, p);
}

// All edge cases listed in this thread
roundOf(95.345, 2); // 95.35
roundOf(95.344, 2); // 95.34
roundOf(5.0364342423, 2); // 5.04
roundOf(0.595, 2); // 0.60
roundOf(0.335, 2); // 0.34
roundOf(0.345, 2); // 0.35
roundOf(551.175, 2); // 551.18
roundOf(0.3445434, 2); // 0.34 
```

现在您可以使用 toFixed(p) 安全地格式化该值。因此，对于您的具体情况：

```
roundOf(0.3445434, 2).toFixed(2); // 0.34 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2019-06-23T23:31:33.833

如果你想要没有圆形的字符串，你可以使用这个正则表达式（也许不是最有效的方法......但真的很容易）

```
(2.34567778).toString().match(/\d+\.\d{2}/)[0]
// '2.34' 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2017-06-25T06:15:42.240

```
function trimNumber(num, len) {
  const modulu_one = 1;
  const start_numbers_float=2;
  var int_part = Math.trunc(num);
  var float_part = String(num % modulu_one);
      float_part = float_part.slice(start_numbers_float, start_numbers_float+len);
  return int_part+'.'+float_part;
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-12-11T08:07:46.953

也许您还需要小数分隔符？这是我刚刚制作的一个函数：

```
function formatFloat(num,casasDec,sepDecimal,sepMilhar) {
    if (num < 0)
    {
        num = -num;
        sinal = -1;
    } else
        sinal = 1;
    var resposta = "";
    var part = "";
    if (num != Math.floor(num)) // decimal values present
    {
        part = Math.round((num-Math.floor(num))*Math.pow(10,casasDec)).toString(); // transforms decimal part into integer (rounded)
        while (part.length < casasDec)
            part = '0'+part;
        if (casasDec > 0)
        {
            resposta = sepDecimal+part;
            num = Math.floor(num);
        } else
            num = Math.round(num);
    } // end of decimal part
    while (num > 0) // integer part
    {
        part = (num - Math.floor(num/1000)*1000).toString(); // part = three less significant digits
        num = Math.floor(num/1000);
        if (num > 0)
            while (part.length < 3) // 123.023.123  if sepMilhar = '.'
                part = '0'+part; // 023
        resposta = part+resposta;
        if (num > 0)
            resposta = sepMilhar+resposta;
    }
    if (sinal < 0)
        resposta = '-'+resposta;
    return resposta;
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-07-18T17:02:20.540

使用乘法或除法无法避免以 x.xx5 作为实际值的价格舍入不一致。如果您需要在客户端计算正确的价格，您应该将所有金额保留为美分。这是由于 JavaScript 中数值的内部表示的性质。请注意，Excel 也存在同样的问题，因此大多数人不会注意到由这种现象引起的小错误。但是，当您将大量计算值相加时，误差可能会累积，围绕这一点有一个完整的理论，涉及计算顺序和其他方法以最小化最终结果中的误差。为了强调十进制值的问题，请注意 0.1 + 0.2 在 JavaScript 中并不完全等于 0.3，而 1 + 2 等于 3。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-11-06T18:49:02.213

```
/** don't spend 5 minutes, use my code **/
function prettyFloat(x,nbDec) { 
    if (!nbDec) nbDec = 100;
    var a = Math.abs(x);
    var e = Math.floor(a);
    var d = Math.round((a-e)*nbDec); if (d == nbDec) { d=0; e++; }
    var signStr = (x<0) ? "-" : " ";
    var decStr = d.toString(); var tmp = 10; while(tmp<nbDec && d*tmp < nbDec) {decStr = "0"+decStr; tmp*=10;}
    var eStr = e.toString();
    return signStr+eStr+"."+decStr;
}

prettyFloat(0);      //  "0.00"
prettyFloat(-1);     // "-1.00"
prettyFloat(-0.999); // "-1.00"
prettyFloat(0.5);    //  "0.50" 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-03-05T19:12:08.510

我使用此代码来格式化浮点数。它基于`toPrecision()`但去除了不必要的零。我欢迎有关如何简化正则表达式的建议。

```
function round(x, n) {
    var exp = Math.pow(10, n);
    return Math.floor(x*exp + 0.5)/exp;
} 
```

使用示例：

```
function test(x, n, d) {
    var rounded = rnd(x, d);
    var result = rounded.toPrecision(n);
    result = result.replace(/\.?0*$/, '');
    result = result.replace(/\.?0*e/, 'e');
    result = result.replace('e+', 'e');
    return result;  
}

document.write(test(1.2000e45, 3, 2) + '=' + '1.2e45' + '<br>');
document.write(test(1.2000e+45, 3, 2) + '=' + '1.2e45' + '<br>');
document.write(test(1.2340e45, 3, 2) + '=' + '1.23e45' + '<br>');
document.write(test(1.2350e45, 3, 2) + '=' + '1.24e45' + '<br>');
document.write(test(1.0000, 3, 2) + '=' + '1' + '<br>');
document.write(test(1.0100, 3, 2) + '=' + '1.01' + '<br>');
document.write(test(1.2340, 4, 2) + '=' + '1.23' + '<br>');
document.write(test(1.2350, 4, 2) + '=' + '1.24' + '<br>'); 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-07-29T04:13:26.193

```
countDecimals = value => {
    if (Math.floor(value) === value) return 0;
    let stringValue = value.toString().split(".")[1];
    if (stringValue) {
      return value.toString().split(".")[1].length
        ? value.toString().split(".")[1].length
        : 0;
    } else {
      return 0;
    }
  };

formatNumber=(ans)=>{
    let decimalPlaces = this.countDecimals(ans);
    ans = 1 * ans;
    if (decimalPlaces !== 0) {
      let onePlusAns = ans + 1;
      let decimalOnePlus = this.countDecimals(onePlusAns);
      if (decimalOnePlus < decimalPlaces) {
        ans = ans.toFixed(decimalPlaces - 1).replace(/\.?0*$/, "");
      } else {
        let tenMulAns = ans * 10;
        let decimalTenMul = this.countDecimals(tenMulAns);
        if (decimalTenMul + 1 < decimalPlaces) {
          ans = ans.toFixed(decimalPlaces - 1).replace(/\.?0*$/, "");
        }
      }
    }
}
```

我只是将值加 1 并计算原始值和附加值中存在的十进制数字。如果在添加比原始十进制数字少一位后找到十进制数字，我只需使用（原始小数 - 1）调用 toFixed()。我还通过将原始值乘以 10 进行检查，并遵循相同的逻辑，以防加一不会减少多余的小数位。在 JS 中处理浮点数舍入的简单解决方法。在我尝试过的大多数情况下都有效。

# jquery - 搜索事件的 Jquery 选择器

> ID：661564
> 
> 赞同：1
> 
> 时间：2009-03-19T09:38:28.950
> 
> 标签：jquery, events

我需要选择所有绑定了“点击”事件的元素？是否存在这样的选择器？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-19T11:09:32.647

jQuery 本身不支持它，但您可以使用[hasEvent 插件](http://plugins.jquery.com/project/hasevent)编写自己的自定义选择器：

```
jQuery.expr[":"].click = "jQuery(a).hasEvent('click');";

$("a:click").doStuff(); 
```

编辑 ：

还有一个[事件绑定选择器插件](http://plugins.jquery.com/project/eventbound)，它更完整，开箱即用，但也更大。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T09:44:04.740

不，您可以遍历所有元素并检查它们是否具有事件绑定。但这不会很有效，除非您知道什么样的元素会具有该事件绑定，以便您可以缩小搜索范围。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-05-19T08:25:24.787

搜索职位：

```
 button: function(elem){
        return "button" === elem.type || elem.nodeName.toLowerCase() === "button";
    },
    input: function(elem){
        return /input|select|textarea|button/i.test(elem.nodeName);
    },
    //init custom
    ev: function(elem,i,match){
        var what    = $(elem).hasEvent(match[3]);
        var type    = (typeof what);
        return  what !== null && type !== undefined;
    }
    //End custom
},
setFilters: {
    first: function(elem, i){
        return i === 0;
    },
    last: function(elem, i, match, array){
        return i === array.length - 1;
    },
    even: function(elem, i){
        return i % 2 === 0;
    }, 
```

......

相同的用途`has()`

前任：

```
$('form:ev(submit)');
$('input:ev(click)');
$('a:ev(click)'); 
```

# arrays - 如何使用在第二类中的一个类中创建的数组？

> ID：661574
> 
> 赞同：0
> 
> 时间：2009-03-19T09:41:29.097
> 
> 标签：arrays, import, connection

我在类 loginController 的实现中创建了一个数组。现在我想在我项目的另一个类中使用这个数组（及其对象）。导入它的正确方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-19T14:42:22.417

一般的答案是：将其**声明为公开**

这不是一件好事，但作为初学者，你可以从它开始。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T09:47:09.910

您确实需要指定语言。

一般来说，如果数组是一个类中的成员变量，那么直接从另一个类中使用它被认为是不好的形式。这违反了面向对象编程中的“[封装”思想。](http://en.wikipedia.org/wiki/Encapsulation_%28computer_science%29)

首选的做法通常是向拥有数组的类添加称为“getter”和“setter”的方法，或者通过其他更结构化的方式使其可用，这取决于数组的确切语义和用法。例如，可能不需要外部用户甚至知道它是一个数组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T09:55:57.643

鉴于此信息，没有正确的方法。什么位于数组中，只有整数或字符串/对象等。您是否存储指向对象的指针对象？

传递数组与将任何其他对象传递给函数的方式相同

# asp.net - 如何从 ASP .NET MVC 中的动态生成控件中获取数据？

> ID：661575
> 
> 赞同：0
> 
> 时间：2009-03-19T09:41:43.637
> 
> 标签：asp.net, asp.net-mvc, dynamic, controls

我想在 ASP .NET MVC 页面上生成几个复选框。发布页面后如何在控制器中检索他们的数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T09:43:50.980

使用`Request.Form`集合：

```
Request.Form["control-id"] 
```

或在您的操作方法中声明一个`FormsCollection`参数并使用它来检索值。

# python - 是否有一种解析器/方式可用于使用 Python 解析维基百科转储文件？

> ID：661584
> 
> 赞同：6
> 
> 时间：2009-03-19T09:44:26.313
> 
> 标签：python, xml, parsing, wiki, wikipedia

我有一个项目，我收集属于特定类别的所有维基百科文章，从维基百科中提取转储，并将其放入我们的数据库。

所以我应该解析维基百科转储文件来完成这些工作。我们是否有一个高效的解析器来完成这项工作？我是一名 Python 开发人员。所以我更喜欢python中的任何解析器。如果没有建议，我会尝试在 python 中编写它的一个端口并将其贡献给网络，以便其他人使用它或至少尝试一下。

所以我想要的只是一个 python 解析器来解析维基百科转储文件。我开始编写一个手动解析器来解析每个节点并完成工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-19T10:00:28.710

[在http://jjinux.blogspot.com/2009/01/python-parsing-wikipedia-dumps-using.html](http://jjinux.blogspot.com/2009/01/python-parsing-wikipedia-dumps-using.html)有相同的示例代码

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T20:23:25.670

另一个不错的模块是*mwlib*从[这里](http://code.pediapress.com/wiki/wiki/mwlib)安装 - 安装所有依赖项（至少在 Windows 上）很痛苦，但它运行良好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T10:00:45.323

我不知道许可，但这[是](http://linux.softpedia.com/get/Education/Wikipedia-Dump-Reader-30091.shtml)在 python 中实现的，并且包括源代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-07T13:57:46.683

我强烈推荐[mwxml](https://github.com/mediawiki-utilities/python-mwxml)。它是一个用于解析由维基媒体基金会的研究科学家[Aaron Halfaker编写的维基媒体转储的实用程序。](https://github.com/halfak)它可以安装

```
pip install mwxml 
```

用法非常直观，如[文档](http://pythonhosted.org/mwxml/)中的此示例所示：

```
>>> import mwxml

>>> dump = mwxml.Dump.from_file(open("dump.xml"))

>>> print(dump.site_info.name, dump.site_info.dbname)
Wikipedia enwiki

>>> for page in dump:
...     for revision in page:
...        print(revision.id)
...
1
2
3 
```

它是维基媒体基金会及其社区推出的一组更大的[数据分析实用程序的一部分。](https://github.com/mediawiki-utilities)

# objective-c - 我使用 NSUserDefaults 错了吗？

> ID：661587
> 
> 赞同：4
> 
> 时间：2009-03-19T09:45:06.327
> 
> 标签：objective-c, iphone

我为我的 iPhone 应用程序创建了一个“设置”模型。它只包含两个属性和一个用于加载的类方法和一个用于保存的实例方法。

我加载它如下

```
+ (UserSettings *)getCurrent {
    NSUserDefaults *userPrefs = [NSUserDefaults standardUserDefaults];
    UserSettings *settings = [UserSettings new];
    settings.username = [userPrefs stringForKey:kUserNameKey];
    settings.password = [userPrefs stringForKey:kPasswordKey];
    [userPrefs release];
    return settings;
} 
```

NSUserDefault 处理抛出异常的问题；

> -[NSCFArray objectForKey:]：无法识别的选择器发送到实例 0x50b220

我已经使用定义如下的常量导入了我的标题；

```
#define kUserNameKey    @"Username"
#define kPasswordKey    @"Password" 
```

（我知道钥匙串，并计划稍后更改，但想解决用户默认设置）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-19T09:51:15.690

尝试删除，`[userPrefs release]`因为您从未保留或分配它

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T22:55:57.283

您的 UserSettings 属性是如何为用户名/密码定义的？对于字符串，它们应该设置为“复制”。

# php - PHP中的数组操作

> ID：661596
> 
> 赞同：0
> 
> 时间：2009-03-19T09:48:50.280
> 
> 标签：php, arrays

我正在使用 PHP。我需要实现以下逻辑：

我`$List`有以下数据：

```
array('id' =>'1','flag'=>'1','place1' =>'val2' ,'place2'=>'val3')
array('id'=> '1','flag'=>'0','place1' =>'val3' ,'place2'=>'val7')
array('id'=> '1','flag'=>'0','place1' =>'val4' ,'place2'=>'val8')
array('id'=> '1','flag'=>'0','place1' =>'val5' ,'place2'=>'val9')
array('id'=> '2','flag'=>'1','place1' =>'val10','place2'=>'val11')
array('id'=> '3','flag'=>'1','place1' =>'val11','place2'=>'val14') 
```

我的逻辑：

```
 if (flag == 0){

        Store the values of place1 ,Place2 
        in the Index of id

       /*example

        $store[1]= {place1}+{place2}
        hence output:

        store[1]= {val3+val4+val5}+{val7+val8+val9}

similarly
        store[2]= empty
        store[3]= empty
         */

    }
   else{
       Print the Values of place1,place2 of its index

       /*    example

    print place1[1]="val2" ,place2[1]='val3'
    place1[2]="val10",place2[2]='val11'
    place1[3]="val11",place2[3]='val14'      
        */
     } 
```

我的部分片段有：

```
foreach ($List as $key => $val)
{
  if($val['flag']!==0){

   //how to implementation

  }
 else{
     echo '$val['place1']'.'$val['place2']';

  }
} 
```

最好的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T10:29:48.000

假设您实际上在 place1 和 place2 中有数值，因此允许交换加法。如果您确实有文本并且需要大括号，那么稍后我会将这两个部分与另一个 pass over store 连接起来（但是我不会理解 {0}+{0}）。我试图将您的引号保留在其他部分。根本没有测试。

```
$store = array();
foreach ($List as $key => $val)
{
  $id = $val['id'];
  if (!array_key_exists($id, $store)) {
    $store[$id] = 0;
  }
  if ($val['flag'] == 0) {
    $store[$id] += $val['place1'];
    $store[$id] += $val['place2'];
  } else {
     printf("place1[%d]=\"%s\",place2[%d]='%s'\n", $id, $val['place1'], $id, $val['place2']);
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T10:41:20.560

## 代码新手友好：

```
$store = array(); // Don't forget to initialize your vars

foreach ($List as $key => $val)
{

  if ($val['flag']==0)
  {
    // we check if $store[$val['id']] contains any value first and set it to zero
    if (isset($store[$val['id']]))
    {
        // we add the previous value with the new one
        $store[$val['id'] = $store[$val['id']] + $val['place1'] + $val['place2'];
    }
    else
    {
       // first time seeing this id, we set the value to 0
       $store[$val['id']] = 0;
    }

  }
  else
  {
     echo '$val['place1']'.'$val['place2']'."\n"; // adding line break (use </ br> if in a web browser)
  }
} 
```

我不知道“标志”是否应该为 0，所以请调整它。

## 版本 2：

如果“标志”仅用于布尔逻辑，您可以将上面的代码替换为：

```
if (!$val['flag']) 
```

然后可以使用 PHP 快捷键来总结：

```
$store[$val['id'] += $val['place1'] + $val['place2']; 
```

单线操作不需要手镯：

```
if (isset($store[$val['id']]))
    $store[$val['id'] = $store[$val['id']] + $val['place1'] + $val['place2'];
else
   $store[$val['id']] = 0; 
```

而且您也不需要“$key” var。

所以代码变成：

```
$store = array(); 

foreach ($List as $val)

  if (!$val['flag'])
    if (isset($store[$val['id']]))
        $store[$val['id'] += $val['place1'] + $val['place2'];
    else
       $store[$val['id']] = 0;

  else
     echo '$val['place1']'.'$val['place2']'."\n"; 
```

## 第 3 版：

if / else/ set 操作可以使用三元运算符来缩短（注意它的可读性较差且速度较慢）：

```
$store[$val['id'] = isset($store[$val['id']]) ? 0 : $store[$val['id']] + $val['place1'] + $val['place2']; 
```

所以代码变成：

```
$store = array(); 

foreach ($List as $val)
  if (!$val['flag'])
    $store[$val['id'] = isset($store[$val['id']]) ? 0 : $store[$val['id']] + $val['place1'] + $val['place2'];
  else
     echo '$val['place1']'.'$val['place2']'."\n"; 
```

## 专业版

一旦你得到这个，检查soulmerge的代码。尽可能使用函数式编程确实更聪明，因为它更小，并且结果可以相互传送，因此代码更具可重用性。更重要的是，使用生成器通常会消耗更少的内存。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T10:29:23.443

有一个很好的函数可以从数组中过滤数据：array [___filter](http://de.php.net/manual/en/function.array-filter.php)。该函数需要一个回调函数，该函数将决定一个元素是否应该留在数组中。[我们使用create_function](http://de.php.net/manual/en/function.create-function.php)创建一个过滤器函数并提取数组中有趣的部分。

```
$reducingFunction = create_function('$value', 'return $value["flag"] == 0;');
$reduced = array_filter($list, $reducingFunction); 
```

下一个简洁的函数 ( [array_walk](http://de.php.net/manual/en/function.array-walk.php) ) 是转换数组元素的函数（即 $value = $value['param1']），因此我们创建另一个回调函数：

```
$extractingFunction = create_function('&$value, $key, $index', '$value = $value[$index];');
$valuesParam1 = $reduced;
$valuesParam2 = $reduced;
array_walk($valuesParam1, $extractingFunction, 'param1');
array_walk($valuesParam2, $extractingFunction, 'param1'); 
```

现在我们有两个数组，其中包含我们需要的所有数据：

```
$store = array(1 => implode('', $valuesParam1).implode('', $valuesParam2)); 
```

我似乎不明白您希望数组 $store 包含什么。或者 else-branch 应该做什么，所以这需要进一步解释。

# ajax - 登录/会话 cookie、Ajax 和安全性

> ID：661599
> 
> 赞同：43
> 
> 时间：2009-03-19T09:50:49.903
> 
> 标签：ajax, cookies, security

我正在尝试为基于 ajax 的登录表单确定最安全的方法来验证和设置客户端 cookie。我见过有关 XSS 攻击的事情，例如：

[HttpOnly cookie 如何处理 AJAX 请求？](https://stackoverflow.com/questions/27972/are-httponly-cookies-a-viable-option-for-an-ajax-website)

和

[http://www.codinghorror.com/blog/archives/001167.html](http://www.codinghorror.com/blog/archives/001167.html)

所以，我想我的核心问题是......

1）是否使用纯ajax设置cookie安全，如果是，最安全的方法是什么（httpOnly + SSL +加密值等）？

2）纯ajax方法是否涉及设置cookie客户端？这完全安全吗？

3) 在所有主要浏览器/操作系统中以这种方式设置 cookie 是否可靠？

4) 使用隐藏的 IFrame 会更安全吗（调用网页来设置 cookie）？

5）如果可能的话，有没有人有这方面的代码（PHP 是我的后端）？

我的目标是设置 cookie 并使它们可用于下一次调用服务器而不离开页面。

我真的很想达成共识，最安全的方式来做到这一点。最终，此代码计划成为开源代码，因此请不要使用商业代码（或任何经不起公众审查的代码）

谢谢，-托德

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2009-03-19T10:13:42.077

1.  cookie 需要在服务器端生成，因为会话将客户端绑定到服务器，因此令牌交换必须在某个阶段从服务器到客户端。在客户端生成 cookie 并没有真正的用处，因为客户端*是*不受信任的远程机器。

    可以在 AJAX 调用期间设置 cookie。对于服务器（和网络）来说，AJAX 调用只是一个 HTTP 调用，服务器的任何 HTTP 响应都可以设置一个 cookie。所以是的，可以启动会话以响应 AJAX 调用，并且 cookie 将由客户端正常存储。

    因此，您可以使用 AJAX 进行登录过程，就像您可以依赖页面上的表单中的 POST 一样。服务器将以相同的方式查看它们，如果服务器设置了 cookie，浏览器将存储它。

    基本上，客户端 Javascript 永远不需要知道 cookie 的值（如果不知道，则安全性会更好，这可以使用最近浏览器支持的“httponly”cookie 扩展来实现）。请注意，从客户端到服务器的进一步 HTTP 调用，无论是普通页面请求还是 AJAX 请求，都将自动包含该 cookie，即使它被标记为 httponly 并且浏览器支持该扩展名。您的脚本不需要知道 cookie。

    您提到使用 HTTPS（基于 SSL 的 HTTP）——它可以防止其他人读取传输中的信息或冒充服务器，因此对于防止密码或其他重要信息的纯文本传输非常方便。它还可以帮助防范基于网络的攻击，尽管它不能让你对 CSRF 可能给你带来的一切免疫，而且它根本不能保护你免受会话固定或 XSS 之类的攻击。因此，如果您使用 HTTPS，我会避免将其视为万能的：您*仍然*需要对跨站点脚本和跨站点请求伪造保持警惕。

2.  （见1。我把它们组合起来了）

3.  鉴于 cookie 是由服务器在其 HTTP 响应标头中设置的，是的，它是可靠的。但是，为了使其跨浏览器兼容，您仍然需要确保在 AJAX 不可用时可以登录。这可能需要实现仅在没有 Javascript 或 AJAX 不可用时才能看到的替代方案。（*注：现在是 2014 年，您无需再担心浏览器对 AJAX 的支持*）。

4.  它不会改变安全性。不需要它，除了我之前曾见过隐藏的 iframe 用于“模拟”AJAX - 即对服务器进行异步调用。基本上，不管你怎么做都没关系，这是服务器设置cookie，客户端将接受并返回cookie，无论它是否通过AJAX。

在大多数情况下，无论您是否使用 AJAX 都不会影响安全性，因为所有真正的安全性都发生在服务器端，并且对服务器而言，AJAX 调用就像非 AJAX 调用：不可信. 因此，您需要注意诸如[会话固定](http://en.wikipedia.org/wiki/Session_fixation)和[登录 CSRF](http://simonwillison.net/2008/Sep/24/hublog/)之类的问题，以及影响整个会话的问题（例如[CSRF](http://en.wikipedia.org/wiki/Cross-site_request_forgery)和[XSS](http://en.wikipedia.org/wiki/Cross-site_scripting)），就像您不使用 AJAX 时一样。使用 AJAX 时这些问题并没有真正改变，除了我猜，如果您不太熟悉某项技术或者它更复杂，您可能会在使用该技术时犯更多错误。

*答案于 2014 年 9 月更新*

# python - 我如何知道生成器是否从一开始就为空？

> ID：661603
> 
> 赞同：196
> 
> 时间：2009-03-19T09:51:24.130
> 
> 标签：python, generator

有没有一种简单的方法来测试生成器是否没有项目，比如`peek`, `hasNext`, `isEmpty`, 类似的东西？

* * *

## 回答 #1

> 赞同：130
> 
> 时间：2009-03-19T22:01:31.527

建议：

```
def peek(iterable):
    try:
        first = next(iterable)
    except StopIteration:
        return None
    return first, itertools.chain([first], iterable) 
```

用法：

```
res = peek(mysequence)
if res is None:
    # sequence is empty.  Do stuff.
else:
    first, mysequence = res
    # Do something with first, maybe?
    # Then iterate over the sequence:
    for element in mysequence:
        # etc. 
```

* * *

## 回答 #2

> 赞同：65
> 
> 时间：2009-03-19T16:25:12.830

您的问题的简单答案：不，没有简单的方法。有很多解决方法。

真的不应该有一个简单的方法，因为生成器是：一种输出一系列值*而不将序列保存在内存中的*方法。所以没有反向遍历。

你可以编写一个 has_next 函数，或者如果你愿意的话，甚至可以将它作为一个带有精美装饰器的方法放在生成器上。

* * *

## 回答 #3

> 赞同：42
> 
> 时间：2014-02-03T10:41:42.023

一种简单的方法是使用[next()](http://docs.python.org/3/library/functions.html#next)的可选参数，如果生成器耗尽（或为空），则使用该参数。例如：

```
_exhausted  = object()

if next(some_generator, _exhausted) is _exhausted:
    print('generator is empty') 
```

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2016-05-22T14:58:54.963

`next(generator, None) is not None`

或者替换`None`但是你知道它*不在*你的生成器中的任何值。

**编辑**：是的，这将跳过生成器中的 1 个项目。然而，我经常检查生成器是否为空只是出于验证目的，然后并没有真正使用它。否则我会做类似的事情：

```
def foo(self):
    if next(self.my_generator(), None) is None:
        raise Exception("Not initiated")

    for x in self.my_generator():
        ... 
```

也就是说，如果您的*生成器*来自一个**函数**，这将有效，如`generator()`.

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2009-03-19T12:08:48.183

恕我直言，最好的方法是避免特殊测试。大多数时候，使用生成器*是*一种测试：

```
thing_generated = False

# Nothing is lost here. if nothing is generated, 
# the for block is not executed. Often, that's the only check
# you need to do. This can be done in the course of doing
# the work you wanted to do anyway on the generated output.
for thing in my_generator():
    thing_generated = True
    do_work(thing) 
```

如果这还不够好，您仍然可以执行显式测试。此时，`thing`将包含最后生成的值。如果没有生成任何内容，它将是未定义的 - 除非您已经定义了变量。您可以检查 的值`thing`，但这有点不可靠。相反，只需在块中设置一个标志，然后检查它：

```
if not thing_generated:
    print "Avast, ye scurvy dog!" 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-03-19T10:23:37.500

我讨厌提供第二种解决方案，尤其是我自己不会使用的解决方案，但是，如果您绝对*必须*这样做并且不消耗生成器，就像其他答案一样：

```
def do_something_with_item(item):
    print item

empty_marker = object()

try:
     first_item = my_generator.next()     
except StopIteration:
     print 'The generator was empty'
     first_item = empty_marker

if first_item is not empty_marker:
    do_something_with_item(first_item)
    for item in my_generator:
        do_something_with_item(item) 
```

现在我真的不喜欢这个解决方案，因为我相信这不是生成器的使用方式。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2019-03-20T10:52:07.067

刚刚落在这个线程上，并意识到缺少一个非常简单易读的答案：

```
def is_empty(generator):
    for item in generator:
        return False
    return True 
```

如果我们不打算消耗任何项目，那么我们需要将第一个项目重新注入生成器：

```
def is_empty_no_side_effects(generator):
    try:
        item = next(generator)
        def my_generator():
            yield item
            yield from generator
        return my_generator(), False
    except StopIteration:
        return (_ for _ in []), True 
```

例子：

```
>>> g=(i for i in [])
>>> g,empty=is_empty_no_side_effects(g)
>>> empty
True
>>> g=(i for i in range(10))
>>> g,empty=is_empty_no_side_effects(g)
>>> empty
False
>>> list(g)
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9] 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2018-06-25T22:46:49.073

在 Mark Ransom 的提示下，这是一个可用于包装任何迭代器的类，以便您可以提前查看、将值推回流中并检查是否为空。这是一个简单的想法和一个简单的实现，我在过去发现它非常方便。

```
class Pushable:

    def __init__(self, iter):
        self.source = iter
        self.stored = []

    def __iter__(self):
        return self

    def __bool__(self):
        if self.stored:
            return True
        try:
            self.stored.append(next(self.source))
        except StopIteration:
            return False
        return True

    def push(self, value):
        self.stored.append(value)

    def peek(self):
        if self.stored:
            return self.stored[-1]
        value = next(self.source)
        self.stored.append(value)
        return value

    def __next__(self):
        if self.stored:
            return self.stored.pop()
        return next(self.source) 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2014-06-13T06:30:58.543

要查看生成器是否为空，您需要做的就是尝试获取下一个结果。当然，如果您还没有*准备好*使用该结果，那么您必须存储它以便稍后再次返回它。

这是一个可以添加到现有迭代器以添加`__nonzero__`测试的包装器类，因此您可以使用简单的`if`. 它可能也可以变成装饰器。

```
class GenWrapper:
    def __init__(self, iter):
        self.source = iter
        self.stored = False

    def __iter__(self):
        return self

    def __nonzero__(self):
        if self.stored:
            return True
        try:
            self.value = next(self.source)
            self.stored = True
        except StopIteration:
            return False
        return True

    def __next__(self):  # use "next" (without underscores) for Python 2.x
        if self.stored:
            self.stored = False
            return self.value
        return next(self.source) 
```

下面是你如何使用它：

```
with open(filename, 'r') as f:
    f = GenWrapper(f)
    if f:
        print 'Not empty'
    else:
        print 'Empty' 
```

请注意，您可以随时检查是否为空，而不仅仅是在迭代开始时。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2014-03-23T17:02:20.177

我意识到此时这篇文章已有 5 年历史，但我在寻找一种惯用的方法时发现了它，但没有看到我的解决方案已发布。所以为了后代：

```
import itertools

def get_generator():
    """
    Returns (bool, generator) where bool is true iff the generator is not empty.
    """
    gen = (i for i in [0, 1, 2, 3, 4])
    a, b = itertools.tee(gen)
    try:
        a.next()
    except StopIteration:
        return (False, b)
    return (True, b) 
```

当然，我相信许多评论员会指出，这很hacky，并且仅在某些有限的情况下才有效（例如，生成器没有副作用）。YMMV。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-03-19T10:00:23.140

```
>>> gen = (i for i in [])
>>> next(gen)
Traceback (most recent call last):
  File "<pyshell#43>", line 1, in <module>
    next(gen)
StopIteration 
```

在生成器结束时`StopIteration`引发，因为在你的情况下立即到达结束，引发异常。**但通常你不应该检查下一个值的存在。**

您可以做的另一件事是：

```
>>> gen = (i for i in [])
>>> if not list(gen):
    print('empty generator') 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2020-02-04T17:28:29.537

我发现只有这个解决方案也适用于空迭代。

```
def is_generator_empty(generator):
    a, b = itertools.tee(generator)
    try:
        next(a)
    except StopIteration:
        return True, b
    return False, b

is_empty, generator = is_generator_empty(generator) 
```

或者，如果您不想为此使用异常，请尝试使用

```
def is_generator_empty(generator):
    a, b = itertools.tee(generator)
    for item in a:
        return False, b
    return True, b

is_empty, generator = is_generator_empty(generator) 
```

在[标记的解决方案中](https://stackoverflow.com/a/664239/1683626)，您无法将其用于空生成器，例如

```
def get_empty_generator():
    while False:
        yield None 

generator = get_empty_generator() 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-03-19T10:14:14.853

很抱歉这种明显的方法，但最好的方法是：

```
for item in my_generator:
     print item 
```

现在您已经检测到生成器在使用时是空的。当然，如果生成器为空，则永远不会显示 item。

这可能不完全适合您的代码，但这就是生成器的习惯用法：迭代，所以也许您可能会稍微改变您的方法，或者根本不使用生成器。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2011-11-01T19:47:29.997

*如果您在使用生成器之前*需要知道，那么不，没有简单的方法。如果您可以等到使用生成器*之后*，有一个简单的方法：

```
was_empty = True

for some_item in some_generator:
    was_empty = False
    do_something_with(some_item)

if was_empty:
    handle_already_empty_generator_case() 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2016-06-28T22:14:12.573

只需用[itertools.chain](https://docs.python.org/2.7/library/itertools.html#itertools.chain)包装生成器，将代表迭代结束的东西作为第二个迭代，然后简单地检查它。

前任：

```
import itertools

g = some_iterable
eog = object()
wrap_g = itertools.chain(g, [eog]) 
```

现在剩下的就是检查我们附加到可迭代末尾的那个值，当你阅读它时，这将意味着结束

```
for value in wrap_g:
    if value == eog: # DING DING! We just found the last element of the iterable
        pass # Do something 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2017-03-16T17:25:17.560

在我的情况下，我需要知道是否填充了许多生成器，然后再将其传递给一个函数，该函数合并了项目，即`zip(...)`. 该解决方案与公认的答案相似，但又足够不同：

定义：

```
def has_items(iterable):
    try:
        return True, itertools.chain([next(iterable)], iterable)
    except StopIteration:
        return False, [] 
```

用法：

```
def filter_empty(iterables):
    for iterable in iterables:
        itr_has_items, iterable = has_items(iterable)
        if itr_has_items:
            yield iterable

def merge_iterables(iterables):
    populated_iterables = filter_empty(iterables)
    for items in zip(*populated_iterables):
        # Use items for each "slice" 
```

我的特殊问题具有可迭代对象为空或具有完全相同数量的条目的属性。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2018-04-11T18:25:15.450

使用 cytoolz 中的[peek](http://toolz.readthedocs.io/en/latest/api.html#toolz.itertoolz.peek)功能。

```
from cytoolz import peek
from typing import Tuple, Iterable

def is_empty_iterator(g: Iterable) -> Tuple[Iterable, bool]:
    try:
        _, g = peek(g)
        return g, False
    except StopIteration:
        return g, True 
```

此函数返回的迭代器将等同于作为参数传入的原始迭代器。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2021-12-24T09:11:58.967

bool(generator) 将返回正确的结果

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2016-07-29T03:43:42.677

这是一个包装生成器的简单装饰器，因此如果为空，则返回 None 。如果您的代码需要在循环*之前*知道生成器是否会生成任何内容，这将很有用。

```
def generator_or_none(func):
    """Wrap a generator function, returning None if it's empty. """

    def inner(*args, **kwargs):
        # peek at the first item; return None if it doesn't exist
        try:
            next(func(*args, **kwargs))
        except StopIteration:
            return None

        # return original generator otherwise first item will be missing
        return func(*args, **kwargs)

    return inner 
```

用法：

```
import random

@generator_or_none
def random_length_generator():
    for i in range(random.randint(0, 10)):
        yield i

gen = random_length_generator()
if gen is None:
    print('Generator is empty') 
```

一个有用的例子是在模板代码中 - 即 jinja2

```
{% if content_generator %}
  <section>
    <h4>Section title</h4>
    {% for item in content_generator %}
      {{ item }}
    {% endfor %
  </section>
{% endif %} 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2020-02-21T10:53:04.850

这是一个古老且已回答的问题，但正如以前没有人展示过的那样，这里是：

```
for _ in generator:
    break
else:
    print('Empty') 
```

[你可以在这里阅读更多](https://book.pythontips.com/en/latest/for_-_else.html#else-clause)

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2020-10-01T20:39:25.520

有一个非常简单的解决方案：`if next(generator,-1) == -1`然后生成器是空的！

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2021-02-23T12:07:44.193

只是为了帮助我的“2美分”，我将描述我的经历：

我有一个发电机，我需要将它`itertools.islice`切成小发电机。然后检查我的子生成器是否为空，我只需将它们转换/使用为一个小列表，然后检查列表是否为空。

例如：

```
from itertools import islice

def generator(max_yield=10):
    a = 0

    while True:
        a += 1

        if a > max_yield:
            raise StopIteration()

        yield a

tg = generator()

label = 1

while True:
    itg = list(islice(tg, 3))

    if not itg:  # <-- I check if the list is empty or not
        break

    for i in itg:
        print(f'#{label} - {i}')

    label += 1 
```

输出：

```
#1 - 1
#1 - 2
#1 - 3
#2 - 4
#2 - 5
#2 - 6
#3 - 7
#3 - 8
#3 - 9
#4 - 10 
```

也许这不是最好的方法，主要是因为它消耗了生成器，但是它对我有用。

* * *

## 回答 #23

> 赞同：-2
> 
> 时间：2016-06-14T20:09:31.373

我通过使用 sum 函数解决了它。下面是我与 glob.iglob 一起使用的示例（它返回一个生成器）。

```
def isEmpty():
    files = glob.iglob(search)
    if sum(1 for _ in files):
        return True
    return False 
```

*这可能不适用于 HUGE 生成器，但对于较小的列表应该可以很好地执行

# visual-studio - Visual C++：如何禁用特定的链接器警告？

> ID：661606
> 
> 赞同：133
> 
> 时间：2009-03-19T09:53:24.343
> 
> 标签：visual-studio, visual-c++, linker, warnings, cgal

我正在使用来自 CGAL 的库，它在我的代码编译的链接阶段会产生很多这种形式的链接警告：

```
warning LNK4099: PDB 'vc80.pdb' was not found with 'gmp-vc80-mt-sgd.lib' or at 'vc80.pdb'; linking object as if no debug info 
```

如何在 Visual C++/Studio 2008 下关闭此特定链接器警告？

请注意，我对正在使用的外部（CGAL）库没有任何控制权。我不能/不想重新编译外部库。因此，需要在我的最后修复这些消息。

* * *

## 回答 #1

> 赞同：113
> 
> 时间：2009-03-19T13:43:11.530

添加以下内容作为附加链接器选项：

```
 /ignore:4099 
```

这是在属性-> 链接器-> 命令行

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2009-09-25T18:33:00.357

**2018-10-16 更新**

据报道，从 VS 2013 开始，可以禁用此警告。请参阅@Mark Ransom 的评论。

**原始答案**

您不能禁用该特定警告。

根据[Geoff Chappell](http://www.geoffchappell.com/studies/msvc/link/link/options/ignore.htm)的说法，即使与 /wx 结合使用，4099 警告也会被视为太重要而无法忽略（这会将警告视为错误并在其他情况下忽略指定的警告）

以下是链接中的相关文本：

> **并非完全不可忽视的警告**
> 
> 对于某些警告编号，接受 /ignore 选项中的规范，但不一定要采取行动。如果在 /wx 选项未激活时出现警告，则仍会显示警告消息，但如果 /wx 选项处于活动状态，则忽略该警告。就好像警告被认为足够重要，可以覆盖忽略它的尝试，但如果用户对未忽略的警告定价过高，则不会。
> 
> 以下警告编号受到影响：
> 
> ```
> 4200, 4203, 4204, 4205, 4206, 4207, 4208, 4209, 4219, 4231 and 4237 
> ```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-06-24T09:01:29.313

（作为记录，在帖子在 msdn 论坛上消失之前）您不能禁用警告（至少在 VS2010 下），因为它在无法禁用的警告列表中（因此 /wd4099 将不起作用） ，但是您可以做的是修补 link.exe（通常是 C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\bin\link.exe）以将其从所述列表中删除。听起来像手提钻，我知道。它虽然有效。

例如，如果您想删除 4099 的警告，请使用十六进制编辑器打开 link.exe，转到显示 03 10（4099 的小端序）的第 15A0 行并将其替换为 FF 00（不存在）。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2014-08-08T23:59:21.593

为了他人的利益，我虽然会包括我所做的。

由于您无法让 Visual Studio（在我的情况下为 2010）忽略 LNK4204 警告，因此我的方法是给它想要的东西：pdb 文件。由于我使用的是开源库，因此我已经有了构建 pdb 文件的代码。

但是，默认情况下将所有 PDF 文件命名为相同的名称：在我的情况下为 vc100.pdb。由于每个 .lib 都需要一个 .pdb，这会产生问题，尤其是在使用 ImageMagik 之类的东西时，它会创建大约 20 个静态 .lib 文件。您不能在一个目录中拥有 20 个 lib 文件（应用程序的链接器引用这些文件来链接库中的链接）并且将所有 20 个 .pdb 文件称为相同的东西。

我的解决方案是去重建我的静态库文件，并配置 VS2010 以根据项目命名 .pdb 文件。这样，每个 .lib 都会获得一个类似命名的 .pdb，您可以将所有 LIB 和 PDB 放在一个目录中供您的项目使用。

所以对于“调试”配置，我编辑了：

*属性 -> 配置属性 -> C/C++ -> 输出文件 -> 程序数据库文件名*来自

$(IntDir)vc$(PlatformToolsetVersion).pdb

为以下值：

**$(OutDir)vc$(PlatformToolsetVersion)D$(ProjectName).pdb**

现在而不是在中间目录的某个地方，.pdb 文件被写入输出目录，.lib 文件也被写入，最重要的是，它们以 D+*项目名称*的后缀命名。这意味着每个库*项目*都会生成一个项目 .lib 和一个特定于项目的 .pdb。

我现在可以将我的所有发布 .lib 文件、调试 .lib 文件和调试 .pdb 文件复制到我的开发系统上的一个位置，并且在调试模式下使用该第 3 方库的项目具有 pdb它在调试模式下需要的文件。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-04T07:49:55.060

我怀疑 /ignore 是一个 VC6 link.exe 选项。对于 VS2005 和 VS2008 的链接器，没有记录的 /ignore 选项可用，但链接器看起来只是忽略了“/ignore:XXX”选项，没有错误也没有效果。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-19T10:37:58.353

PDB 文件通常用于存储调试信息。此警告可能是因为`vc80.pdb`链接目标对象文件时未找到该文件。[在此处](http://msdn.microsoft.com/en-us/library/b7whw3f3(VS.80).aspx)阅读 LNK4099 上的 MSDN 条目。

或者，您可以从 Project Properties > Linker > Debugging > Generate Debug Info 字段关闭调试信息生成。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-19T10:39:46.307

编辑：不要使用 vc80 / Visual Studio 2005，而是使用 CGAL 库的 Visual Studio 2008 / vc90 版本（可能[来自](http://pulse.mat.ucsb.edu/projects/luaAV/browser/auxiliary/cgal/windows/gmp/lib) [这里](http://pulse.mat.ucsb.edu/projects/luaAV/browser/auxiliary/cgal/windows)）。

[链接器工具警告 LNK4099](http://msdn.microsoft.com/en-us/library/b7whw3f3.aspx)：

> 您也可以使用 /Z7 进行编译，因此不需要使用 pdb，或者如果您没有链接对象的 .pdb 文件，则删除 /DEBUG 链接器选项。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-07-06T13:59:21.940

正如@John Weldon 所说，您不能禁用链接器警告 4099。

您应该通过一些项目配置更改来重建库。你有几个选择：

*   保存带有调试信息的 PDB 文件与保存 .lib 文件的文件夹相同。将值“$(OutDir)$(TargetName).pdb”设置为 Properties->C/C++->Output Files-Program Database File Name
*   将调试信息保存在 .lib 文件中。将值“C7 compatible (/Z7)”设置为 Properties->C/C++->General->Debug Information Format
*   禁用此库的生成调试信息。从 Properties->C/C++->General->Debug Information Format 中删除值

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-08-12T17:21:55.377

如果有人希望将 /ignore 添加到属性表而不是单独修改许多项目，您可以按如下方式添加它：

```
<ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Debug|x64'">
<Link>
   <AdditionalOptions>/ignore:4099 %(AdditionalOptions)</AdditionalOptions>
</Link> 
```

# jsf - 如何使用 JSF/Richfaces 渲染带有地图的图像？

> ID：661611
> 
> 赞同：1
> 
> 时间：2009-03-19T09:56:16.677
> 
> 标签：jsf, map, richfaces

我想使用 JSF / Richfaces 执行以下任务

单击链接时-我想生成带有地图的PNG图像（图像的一部分应该是可点击的）并在面板下呈现。

当我生成图像时，我知道需要可点击的图像坐标。所以我可以生成地图。但我想在一个 XHTML 文件下完成。可以丰富：paint2d 标签接受地图，如 -

```
<map name="mapGraph">
    <area coords="754,378 20" href="http://google.com" shape="Circle" alt="Drill Down">
    <area coords="33,439 20" href="http://google.com" shape="Circle" alt="Drill Down">
    <area coords="393,425 20" href="http://google.com" shape="Circle" alt="Drill Down">
    <area coords="573,378 20" href="http://google.com" shape="Circle" alt="Drill Down">
    <area coords="213,407 20" href="http://yahoo.com" shape="Circle" alt="Drill Down">
</map> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-11T15:40:20.113

没有默认的方法来实现这一点。唯一的方法是开发自己的 JSF 自定义组件。我开发了自己的 JSF 标签，例如`<custom:image id = "im1" width="800px" height="400px" useMap="dwMap"/>`. JSF 引擎在找到此标签时 - 呈现一个带有类似地图的 html 标签“img”

```
<img  width="800" border="0" height="400" useMap="#dwMap" src="/imageB94DFA031CA999EE65ED586627F630BE.png"/>
<map name="dwMap"><area coords="735,225 20" shape="Circle" onMouseOver="call('735,225 20')" title="Start Time : 2009-02-16 15:32:48
End Time : 2009-02-16 15:34:59" /><area coords="570,225 20" shape="Circle" onMouseOver="call('570,225 20')" title="Start Time : 2009-02-16 15:32:27
End Time : 2009-02-16 15:32:39" /><area coords="405,237 20" shape="Circle" onMouseOver="call('405,237 20')" title="Start Time : 2009-02-16 15:14:41
End Time : 2009-02-16 15:16:58" /><area coords="241,215 20" shape="Circle" onMouseOver="call('241,215 20')" title="Start Time : 2009-02-16 15:13:50
End Time : 2009-02-16 15:14:00" /><area coords="76,181 20" shape="Circle" onMouseOver="call('76,181 20')" title="Start Time : 2009-02-13 17:57:31
End Time : 2009-02-13 17:58:18" /></map> 
```

虽然在 JSF 中开发一个自定义组件听起来很复杂，但它确实很容易。可以按照 Richard Hightower 的文章“[非信徒的 JSF](http://www.ibm.com/developerworks/library/j-jsf4/#download) ”，开发自定义组件变得尽可能简单。

# c++ - 有没有更好的方法来设计这个消息传递代码？

> ID：661617
> 
> 赞同：0
> 
> 时间：2009-03-19T09:57:29.230
> 
> 标签：c++

A 类使用以下两个函数来构建和发送消息 1 和 2

```
builder::prepareAndDeliverMsg1(msg1_arg1,msg1_arg2)
{
}

builder::prepareAndDeliverMsg2(msg2_arg1,msg2_arg2)
{
} 
```

现在，引入了一个新的 B 类，它想分两个阶段做 A 正在做的事情

阶段1->准备阶段2->交付

我正在考虑扩展构建器类，如下所示：

```
///----

builder::prepareMsg1(msg1_arg1,msg1_arg2)
{
}

builder::prepareMsg2(msg2_arg1,msg2_arg2)
{
}

builder::deliverMsg1(msg1_arg1)
{
    This function, inserts re-calculated msg1_arg1 into the prepared message in stage1
}

builder::deliverMsg2(msg2_arg1)
{
   This function, inserts re-calculated msg2_arg1 into the prepared message in stage1
}

// These two functions are still retained for the usage of class A
builder::prepareAndDeliverMsg1(msg1_arg1,msg1_arg2)
{
}

builder::prepareAndDeliverMsg2(msg2_arg1,msg2_arg2)
{
}

//--- 
```

我想知道，是否有更好的设计方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-19T10:17:05.907

也许对于每条消息，创建自己的类并从基本消息类继承？

```
class TBaseMsg
{
public:
   virtual void prepare() = 0;
   virtual void deliver() = 0;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-19T10:34:31.013

你可以看看装饰器设计模式。

[http://en.wikipedia.org/wiki/Decorator_pattern](http://en.wikipedia.org/wiki/Decorator_pattern)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T10:00:57.647

你的解决方案对我来说看起来不错。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-19T10:48:50.107

为了扩展 Darks 的想法，您可以拥有一个基类，它根据单独的函数实现组合的准备和交付，并允许派生类根据需要覆盖那些：

```
class base {
    virtual bool prepareMsg1() = 0;
    virtual bool prepareMsg2() = 0;
    virtual bool deliverMsg1() = 0;
    virtual bool deliverMsg2() = 0;
    bool prepareAndDeliverMsg1(){
        prepareMsg1();
        deliverMsg1();
    }
    bool prepareAndDeliverMsg2(msg2_arg1,msg2_arg2){
        prepareMsg2();
        deliverMsg2();
    }
}; 
```

您可能会发现两个派生类的许多功能是相同的，在这种情况下您不想在基类中使用纯虚拟：

```
class base {
    virtual bool prepareMsg1(args) {//not pure virtual
        //do the common stuff
    }
};

class derived {
    bool prepareMsg1( args ) {
        base::prepareMsg1(args);
        //code to specailise the message
    }
}; 
```

甚至可能是基类实现了您的原始类，但允许派生您的第二个类，而无需重复公共代码。

# wpf - WPF - 用户控件默认内容属性

> ID：661620
> 
> 赞同：17
> 
> 时间：2009-03-19T09:58:07.810
> 
> 标签：wpf, user-controls, itemscontrol, custom-controls

我正在创建一个 UserControl，我只是不记得你用来装饰你想作为默认内容属性的属性的属性的名称。

举一个具体的例子，假设我有一个名为“Title”的属性，我可以使用这样的属性语法来设置它 -

```
<local:myControl Title="the title"/> 
```

但是控件的使用者可能希望使用这样的元素语法 -

```
<local:myControl> the Title </local:myControl> 
```

我知道有一个属性需要添加到 Title 属性以启用此支持，但我忘记了它是什么并且在任何地方都找不到它。

谁能帮我刷新我的记忆？另外，我正在寻找一个类似的属性来作用于从 ItemsControl 继承的 CustomControls。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-19T10:21:46.613

[内容属性属性](http://msdn.microsoft.com/en-us/library/system.windows.markup.contentpropertyattribute.aspx)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-19T10:33:29.457

我还在 MSDN 上找到了支持集合作为内容属性的代码。 [TOM_C](http://msdn.microsoft.com/en-us/library/user-53526.aspx)对此表示感谢。

```
[ContentProperty("SomeObjects")]
public class SomeContainer
{
    private List<SomeObject> _someObjects;
    public List<SomeObject> SomeObjects
    {
        get
        {
            if (null == _someObjects)
                _someObjects = new List<SomeObject>();
            return _someObjects;
        }
    }
} 
```

XAML：

```
<SomeContainer>
    <SomeObject/>
    <SomeObject/>
    <SomeObject/>
</SomeContainer> 
```

# seo - 静态页面的301重定向

> ID：661622
> 
> 赞同：3
> 
> 时间：2009-03-19T09:58:54.890
> 
> 标签：seo

如果我想从旧的静态页面 301 重定向（需要 SEO）到新的静态页面，我应该怎么做？

我在 Google 中搜索，发现似乎无法在静态页面（元标记）内设置 301 重定向。

我的服务器是 Netscape Enterprise。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T10:24:51.070

这是如何在几种不同环境中执行此操作的列表，[how-to-redirect-a-webpage](http://www.webconfs.com/how-to-redirect-a-webpage.php)。不幸的是不是 Netscape Enterprise，但也许它可以给你一个线索。它确实介绍了如何重定向 html 文件。

这个链接也可能有帮助，[搜索引擎和 301 永久重定向](http://blogs.oracle.com/elving/entry/301_permanent_redirects)它提到了 Netscape Enterprise Server，但只是说它不可能进行 301 重定向。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T10:05:29.167

您是正确的，因为您不能让静态页面响应 301 永久重定向。

您需要使用一些服务器端技术来设置响应标头，例如 JSP：

```
<%
response.setStatus(301);
response.setHeader( "Location", "http://www.newpage.com" );
response.setHeader( "Connection", "close" );
%> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T10:22:46.097

我不确定 Netscape Enterprise，但在大多数网络服务器（至少在 IIS 中）上，您可以为网络服务器管理区域内的静态文件设置重定向（301 和 302），即不在文件本身内。我想 Netscape Enterprise 会提供类似的功能。

# apache-flex - 在 Actionscript 3 中将字符串转换为 GUID

> ID：661623
> 
> 赞同：0
> 
> 时间：2009-03-19T09:59:50.927
> 
> 标签：apache-flex, actionscript-3, soap, guid

我正在使用 Flex 从 Web 服务中检索 GUID。使用此 GUID，我必须从 Web 服务中检索用户名。

输出给我一个“提供的密钥无效。它必须是 System.Guid 类型。”

我到处寻找解决方案，但找不到正确的答案。

任何人？

谢谢！

编辑：有没有办法在 AS3 中将字符串转换为 GUID？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T18:47:33.660

我认为您不需要在客户端上执行此操作。问题是您正在向服务器发送一个字符串，并且它需要一个 System.Guid 实例而不是字符串。您可以将字符串传递给 System.Guid 的构造函数，以从给定的字符串创建有效的 guid。

# wpf - 更改源时未刷新 CollectionViewSource 过滤器

> ID：661630
> 
> 赞同：12
> 
> 时间：2009-03-19T10:02:33.617
> 
> 标签：wpf, filter, collections

我有一个绑定到 CollectionViewSource 的 WPF ListView。它的来源绑定到一个属性，如果用户选择一个选项，它可以改变。

当列表视图源由于属性更改事件而更新时，所有内容都会正确更新，但不会刷新视图以考虑 CollectionViewSource 过滤器中的任何更改。

如果我将处理程序附加到 Source 属性绑定到的 Changed 事件，我可以刷新视图，但这仍然是旧视图，因为绑定尚未更新列表。

当源更改时，是否有一种不错的方法可以使视图刷新并重新评估过滤器？

干杯

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2011-04-01T15:06:13.593

框架不支持基于 PropertyChanged 事件更新 CollectionView.Filter。有很多解决方案。

1) 在你的集合内的对象上实现IEditableObject接口，并在改变过滤器所基于的属性时调用BeginEdit和EndEdit。您可以在 Dr.WPF 的优秀博客上阅读更多相关信息：Dr.WPF 的[可编辑集合](http://drwpf.com/blog/2008/10/20/itemscontrol-e-is-for-editable-collection/)

2）创建以下类并在更改的对象上使用 RefreshFilter 函数。

```
public class FilteredObservableCollection<T> : ObservableCollection<T>
{
    public void RefreshFilter(T changedobject)
    {
        OnCollectionChanged(new NotifyCollectionChangedEventArgs(NotifyCollectionChangedAction.Replace, changedobject, changedobject));
    }        
} 
```

例子：

```
public class TestClass : INotifyPropertyChanged
{
    private string _TestProp;
    public string TestProp
    {
        get{ return _TestProp; }
        set
        { 
            _TestProp = value;
            RaisePropertyChanged("TestProp");
        }
    }

    public event PropertyChangedEventHandler PropertyChanged;

    protected void RaisePropertyChanged(string propertyName)
    {
        var handler = this.PropertyChanged;
        if (handler != null)
            handler(this, new PropertyChangedEventArgs(propertyName));
    }
}

FilteredObservableCollection<TestClass> TestCollection = new FilteredObservableCollection<TestClass>();

void TestClass_PropertyChanged(object sender, PropertyChangedEventArgs e)
{
    switch (e.PropertyName)
    {
        case "TestProp":
            TestCollection.RefreshFilter(sender as TestClass);
            break;
    }
} 
```

在创建TestClass对象的时候订阅它的PropertyChanged事件，但是不要忘记在对象被移除的时候解开事件处理函数，否则可能会导致内存泄漏

或者

将 TestCollection 注入 TestClass 并在 TestProp 设置器中使用 RefreshFilter 函数。无论如何，这里的魔法是由 NotifyCollectionChangedAction.Replace 完成的，它完全更新了项目。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-19T17:53:19.657

您是在更改分配给 的实际集合实例`CollectionViewSource.Source`，还是只是`PropertyChanged`在它绑定的属性上触发？

如果设置了该`Source`属性，则应该为新源集合中的每个项目调用过滤器，所以我认为正在发生其他事情。您是否尝试过`Source`手动设置而不是使用绑定并查看您是否仍然得到您的行为？

**编辑：**

您使用的是[`CollectionViewSource.View.Filter`](http://msdn.microsoft.com/en-us/library/system.windows.data.collectionview.filter.aspx)属性还是[`CollectionViewSource.Filter`](http://msdn.microsoft.com/en-us/library/system.windows.data.collectionviewsource.filter.aspx)事件？当`CollectionView`你设置一个新的时，它会被吹走`Source`，所以如果你有一个`Filter`设置，`CollectionView`它将不再存在。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-02-17T07:28:46.033

我找到了一个特定的解决方案，用于将 ObservableCollection 类扩展为监视它包含的对象的属性变化的[类](https://stackoverflow.com/questions/269073/observablecollection-that-also-monitors-changes-on-the-elements-in-collection)。

这是我对代码进行了一些修改：

```
namespace Solution
{
public class ObservableCollectionEx<T> : ObservableCollection<T> where T : INotifyPropertyChanged
    {
        protected override void OnCollectionChanged(NotifyCollectionChangedEventArgs e)
        {
            if (e != null)  // There's been an addition or removal of items from the Collection
            {
                Unsubscribe(e.OldItems);
                Subscribe(e.NewItems);
                base.OnCollectionChanged(e);
            }
            else
            {
                // Just a property has changed, so reset the Collection.
                base.OnCollectionChanged(new NotifyCollectionChangedEventArgs(NotifyCollectionChangedAction.Reset));

            }

        }

        protected override void ClearItems()
        {
            foreach (T element in this)
                element.PropertyChanged -= ContainedElementChanged;

            base.ClearItems();
        }

        private void Subscribe(IList iList)
        {
            if (iList != null)
            {
                foreach (T element in iList)
                    element.PropertyChanged += ContainedElementChanged;
            }
        }

        private void Unsubscribe(IList iList)
        {
            if (iList != null)
            {
                foreach (T element in iList)
                    element.PropertyChanged -= ContainedElementChanged;
            }
        }

        private void ContainedElementChanged(object sender, PropertyChangedEventArgs e)
        {
            OnPropertyChanged(e);
            // Tell the Collection that the property has changed
            this.OnCollectionChanged(null);

        }
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-07-08T12:41:53.933

聚会可能有点晚了，但以防万一

你也可以使用 我通过[这篇](https://wpf.2000things.com/2014/01/16/988-enabling-live-sorting-in-a-collectionviewsource/)博文找到的[CollectionViewSource.LiveSortingProperties 。](https://docs.microsoft.com/en-us/dotnet/api/system.windows.data.collectionviewsource.livesortingproperties?view=net-5.0#system-windows-data-collectionviewsource-livesortingproperties)

```
public class Message : INotifyPropertyChanged
{
    public string Text { get; set; }
    public bool Read { get; set; }

    /* for simplicity left out implementation of INotifyPropertyChanged */
} 
```

```
public ObservableCollection<Message> Messages {get; set} 
```

```
ListCollectionView listColectionView = (ListCollectionView)CollectionViewSource.GetDefaultView(Messages);
listColectionView.IsLiveSorting = true;
listColectionView.LiveSortingProperties.Add(nameof(Message.Read));
listColectionView.SortDescriptions.Add(new SortDescription(nameof(Message.Read), ListSortDirection.Ascending)); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-10-13T02:49:59.133

我找到了一个相对简单的方法来做到这一点。我将只读的 ICollectionView 属性更改为获取/设置并添加了引发的属性事件：

```
 Property TypeFilteredCollection As ICollectionView
        Get
            Dim returnVal As ICollectionView = Me.TypeCollection.View
            returnVal.SortDescriptions.Add(New SortDescription("KeyName", ListSortDirection.Ascending))
            Return returnVal
        End Get
        Set(value As ICollectionView)

            RaisePropertyChanged(NameOf(TypeFilteredCollection))
        End Set
    End Property 
```

然后更新，我刚刚使用：

```
 Me.TypeFilteredCollection = Me.TypeFilteredCollection 
```

如果您没有地方触发该更新，这显然是行不通的。

# php - player opening more than one time?

> ID：661631
> 
> 赞同：1
> 
> 时间：2009-03-19T10:02:53.947
> 
> 标签：php, html, xml

[This is my site.](http://www.musicking.in) When i will select songs for playing player.php file will open and it will play the songs selected.

Everything working fine,but the problem is when o will go back and select another songs it is opening one more player window. please help me.

I want only one player window has to be opened even i select other songs also. to check the problem go to [this url](http://musicking.in/ilayaraja-hitstelugu.html) and play the songs once

player.php

```
createElement("playlist");
$dom->appendChild($root);
$root->setAttribute('version', "1");
$root->setAttribute('xmlns', "http://xspf.org/ns/0/");
$rootnext = $dom->createElement("trackList");
$root->appendChild($rootnext);
foreach ($song as $counter) {
    $tokens = ",";
    $tokenized = strtok($counter, $tokens);
// create child element

$song = $dom->createElement("track");
$rootnext->appendChild($song);
$song1 = $dom->createElement("creator");
$song->appendChild($song1);
$text = $dom->createTextNode("www.musicking.in");
$song1->appendChild($text); 
$song1 = $dom->createElement("title");
$song->appendChild($song1);
// create text node
$text = $dom->createTextNode($tokenized);
$song1->appendChild($text); 
$tokenized = strtok($tokens);
$song1 = $dom->createElement("location");
$song->appendChild($song1);
$text = $dom->createTextNode($tokenized);
$song1->appendChild($text); 

}
// save 
$dom->save("playlist.xml");
?>

```

playlist.xml

```
www.musicking.inDuryodhana's dialouge1/Ntr dialouges/duryodhana's dialouge.mp3www.musicking.inDuryodhana's dialouge2/Ntr dialouges/dvsk_dialogues-10.mp3www.musicking.inDuryodhana's dialouge3/Ntr dialouges/dvsk_dialogues-3.mp3www.musicking.inDuryodhana's dialouge4/Ntr dialouges/dvsk_dialogues-4.mp3www.musicking.inDuryodhana's dialouge5/Ntr dialouges/dvsk_dialogues-5.mp3www.musicking.inDuryodhana's dialouge6/Ntr dialouges/dvsk_dialogues-6.mp3www.musicking.inDuryodhana's dialouge7/Ntr dialouges/dvsk_dialogues-7.mp3www.musicking.inDuryodhana's dialouge8/Ntr dialouges/dvsk_dialogues-8.mp3www.musicking.inDuryodhana's dialouge9/Ntr dialouges/dvsk_dialogues-9.mp3www.musicking.inDuryodhana's dialouge10/Ntr dialouges/dvsk_dialogues-11.mp3www.musicking.inDuryodhana's dialouge11/Ntr dialouges/karna's dialouge.mp3

```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-19T10:40:57.597

I think that it opens a new window because you have specified target='_blank' in the form. Try to use different target (i.e. target="player").

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T10:58:39.130

if i will put a player in the same window player will stop playing songs when user go to other page for othe songs . so my player should be open in other window.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T15:28:36.803

Alekc has it right.

Your form code is this:

```
<form method="post" action="/player.php" target="_blank"> 
```

You should change the target to something like `player`. This change will still cause the player to open in a new window, but that window will be uniquely named.

```
<form method="post" action="/player.php" target="player"> 
```

Then, when a user clicks on "Play Selected," instead of opening another window, it will load into the old player.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-19T10:48:16.940

I Agree with Alekc.

For a better user experience you should also not open a new window but put the player div inside the page in iframe and then simple change the src of the iframe (easy with javascript or jquery) to your new playlist. Most of web users have popup blocking scripts, so the player may even not display.

Putting the player inside the page improves your design and usability.

# .net - 您认为什么是结构良好的 n 层 .Net 应用程序的示例？

> ID：661633
> 
> 赞同：3
> 
> 时间：2009-03-19T10:04:18.403
> 
> 标签：.net, n-tier-architecture

在寻找资源以成为更好的开发人员时，我正在寻找如何在 n 层应用程序中构建代码的好例子。

比如......业务对象做什么和看什么，它如何与数据访问层接口等。UI 如何与业务层接口，它是否直接与 DAL 接口。

您是否知道值得研究的可免费获得的好例子？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T22:19:45.133

看看这个例子： http: [//www.codeplex.com/TheBeerHouse](http://www.codeplex.com/TheBeerHouse)，它是作为本书的例子开发的：http: [//www.amazon.com/gp/product/0764584642](https://rads.stackoverflow.com/amzn/click/com/0764584642)

它是 .net 2.0，并不完美，但它是很好地利用提供者模型的 n 层应用程序的一个很好的例子。我们已经调整了模式并将 if 用于我们 90% 的内部开发。确保不要将此模式与 MVC 模式混淆，因为它们完全不同。

查看关于 n 层架构的维基百科文章：[http](http://en.wikipedia.org/wiki/Multitier_architecture) ://en.wikipedia.org/wiki/Multitier_architecture 。在我给出的示例中，表示层实现为页面和用户控件，逻辑层（通常称为 BLL 或业务逻辑层）是定义特定行为的具体 C# 类，而数据层（通常称为 DAL 或数据访问层）是定义存储机制的抽象 C# 类，具有使用 Sql Server 作为存储介质的具体 C# 类。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T08:33:13.550

Microsoft Patterns & Practices 制作了应用程序架构指南： http: [//www.codeplex.com/AppArch](http://www.codeplex.com/AppArch)

他们甚至制作了视频来解释您在寻找什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T10:06:41.720

我建议查看Billy McCafferty 等人一直在开发的[S#arp Architecture项目。](http://code.google.com/p/sharp-architecture/)

除了作为构建您所描述类型的 n 层 .net 应用程序的出色基础架构之外，它还包括一个示例 Northwind 应用程序，您可以随意使用它。

玩得开心！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-19T10:53:35.633

此外，Martin Fowler 的《企业应用程序架构》一书是必读的。谷歌它或使用提供的亚马逊链接。[亚马逊上的企业应用架构](https://rads.stackoverflow.com/amzn/click/com/0321127420)。

# windows - 处于阻塞模式时的套接字行为

> ID：661636
> 
> 赞同：1
> 
> 时间：2009-03-19T10:06:05.293
> 
> 标签：windows, linux, unix, sockets

我对使用**阻塞**套接字时发送函数的行为感兴趣。

该手册**没有**明确说明这种情况。

从我的测试（和文档）来看，当在阻塞套接字上使用 send 时，我有两种情况：

*   所有数据都已发送
*   返回一个错误并且没有发送任何内容

在代码行中（例如在 C 中），它的翻译如下：

```
 // everything is allocated and initilized
    int socket_fd;
    char *buffer; 
    size_t buffer_len;
    ssize_t nret;

    nret = send(socket_fd, buffer, buffer_len, 0);
    if(nret < 0)
    {
          // error - nothing was sent (at least we cannot assume anything)
    }
    else
    {
          // in case of blocking socket everything is sent (buffer_len == nret)
    } 
```

我对吗？

我对所有平台（Windows、Linux、*nix）上的这种行为感兴趣。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T10:13:11.033

从手册页。( [http://linux.die.net/man/2/send](http://linux.die.net/man/2/send) )

“成功时，这些调用返回发送的字符数。出错时，返回-1，并适当设置errno。”

你有三个条件。

*   -1 是套接字中的本地错误或其绑定。

*   某个数字 < 长度：并非所有字节都已发送。这通常是套接字被标记为非阻塞并且请求的操作会阻塞的情况；errno 值为 EAGAIN。

    您可能不会看到这一点，因为您正在阻塞 I/O。

    但是，套接字的另一端可能会过早关闭连接，这可能会导致这种情况。errno 值可能是 EPIPE。

*   某个数字 == 长度：所有字节都已发送。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T08:14:05.577

我的理解是阻塞发送不必是原子的，例如参见 Solaris[发送手册页](http://docs.oracle.com/cd/E23824_01/html/821-1466/send-3socket.html#scrolltoc "send(3socket) - Solaris 11 手册页第 3 节：网络库函数")：

```
对于 SOCK_DGRAM 和 SOCK_RAW 等需要原子消息的套接字类型，
返回错误 EMSGSIZE 并且消息在发送时不传输
太长而无法原子地通过底层协议。相同
限制不适用于 SOCK_STREAM 套接字。

```

并查看那里的 EINTR 错误代码：

```
在任何数据可以之前，操作被信号的传递中断
被缓冲发送。

```

这表明在一些数据被缓冲发送后可以中断发送 - 但在这种情况下，发送将返回已经缓冲发送的字节数（而不是 EINTR 错误代码）。

在实践中，我只希望在 SOCK_STREAM 套接字上看到大消息（操作系统无法以原子方式处理）的这种行为。

# java - 用于 Web 应用程序的 Java 图形库？

> ID：661639
> 
> 赞同：1
> 
> 时间：2009-03-19T10:09:07.707
> 
> 标签：java, jsp, charts, jfreechart

我被要求使用（并且我引用）“Some Sexy Graphs”来增强 JSP 应用程序，我在 SO 上进行了快速搜索并提出了[这个问题](https://stackoverflow.com/questions/555804/real-time-java-graph-chart-library)，其中提到了几个图形解决方案，但是鉴于这是一个 Web 应用程序，我是想知道是否有任何好的图形库可以使用 JQuery 或类似的东西呈现图形客户端？

否则，是否有任何使用 JFreeChart 为 Web 生成图表的人得到任何指示。

这是我第一次完成任何 JSP（我已经完成了一些 Java 并且已经完成了一些 ASP.Net），所以任何指针都将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T10:15:28.517

您在寻找图表还是图表库？JFreeChart 非常适合图表。Touchgraph 非常适合图表。

触控图： [www.touchgraph.com](http://www.touchgraph.com)

看这个例子： [http ://www.touchgraph.com/TGGoogleBrowser.html](http://www.touchgraph.com/TGGoogleBrowser.html)

你也可以使用谷歌的图表引擎：

[http://code.google.com/apis/chart/](http://code.google.com/apis/chart/)

# windows - 将文件从网站发送到 Windows 应用程序

> ID：661641
> 
> 赞同：0
> 
> 时间：2009-03-19T10:10:26.003
> 
> 标签：windows

我在网站上有一个文件，我尝试使用 Response.BinaryWrite (getContent) 将此文件发送到 Windows 应用程序（其中 getContent 是具有我需要发送的文件的字节数组）仅针对 HTTP post 方法。我还在响应中添加了一个 Header 和 Content-Type 作为 application/octet-stream。

现在，在客户端（Windows 应用程序）的流中读取（httpWebResponse）响应时，所有的东西（标题+内容类型+文件+一些额外的字节）都被添加了。因此，当我尝试读取流中的文件时，由于内容已更改，因此无法加载它有没有办法将文件与响应对象中存在的其余内容分开。我如何将此文件保存在目录中

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T10:11:42.707

改用`System.Net.WebClient.DownloadData`or`DownloadFile`方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T10:13:02.500

您使用什么语言/版本？

如果您使用的是最新版本的 C#，则可以使用 WebClient 类及其[DownloadFile](http://msdn.microsoft.com/en-us/library/ez801hhe.aspx)方法

# antialiasing - HTML页面中的抗锯齿字体

> ID：661658
> 
> 赞同：6
> 
> 时间：2009-03-19T10:15:29.967
> 
> 标签：antialiasing, browser-detection

有没有一种在网页中创建清晰、清晰、大字体的好方法？我需要在我的主页上使用不同的字体大小和颜色创建标签云效果。

我已经在 HTML/CSS 中设置了它，但是在默认不支持抗锯齿的旧浏览器或操作系统上，它看起来有点……糟糕。

我玩过[sIFR](http://en.wikipedia.org/wiki/Scalable_Inman_Flash_Replacement)，效果很好，但给了我一些可怕的负载效果，但我现在想知道是否有办法：

a) 进行浏览器/操作系统检测，通过我知道支持抗锯齿的浏览器/操作系统组合（他们得到原始 HTML）和获得图像标签的“其他人”来分割用户。

b) 某种 JavaScript 来添加抗锯齿？

c) 在 div 中加载 BG 图像并隐藏 HTML 文本的永久解决方案。（我知道，我知道，谷歌关于去索引的恐怖故事......但这可能吗？）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-19T10:47:33.917

+1 汉克的评论。这样做你几乎没有什么收获。一些桌面浏览器（包括 IE7+ 和 Safari）默认打开抗锯齿，即使它在操作系统级别关闭，现代（后 XP）操作系统倾向于默认打开它。通过在其余部分强制 AA，您将：

(+) 为不知不觉没有 AA 的 IE6 和 XP+Firefox 用户改善显示效果

(-) 让每个人的加载速度变慢（尤其是移动设备有限的用户）

(-) 击败首选字体大小

(-) 不必要地惹恼那些故意禁用抗锯齿功能的 luddites，因为它“完全模糊”(*)

（*：在有限的情况下，这甚至是有意义的，特别是对于旧的、模糊的 CRT 显示器。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-19T10:36:01.073

a) 当然你可以使用浏览器检测。最简单的方法可能是使用[jQuery](http://jquery.com)的[浏览器](http://docs.jquery.com/Utilities/jQuery.browser)方法。（jQuery 是一个很棒的 JavaScript 库，如果你没有听说过，它可以让很多 JS 开发变得更容易）

根据您获得的浏览器（或操作系统）结果，您可以为用户提供不同的解决方案，从普通文本到 Flash 解决方案。

但是，我建议不要这样做。新机器上的东西看起来比旧机器好。就是这样，这就是为什么我建议不要将宝贵的时间花在旧浏览器中的小故障上。-- 当然，除非使用旧版浏览器的用户是您的主要受众。在这种情况下，您是否完全在 Flash 中完成？如果一个总是有效的，那么编写两个解决方案就没有用了，对吧？

b) 实际上，您可以通过 JavaScript 创建抗锯齿文本。以我的项目[Die Stimme Gottes](http://diestimmegottes.de/DieStimmeGottes/250/)（“上帝之声”——不适合宗教娇气）为例。在这个项目中，我为此使用了出色的[typeface.js](http://typeface.neocracy.org/)。

c) 只使用 CSS，也许？

```
h1.welcome {
    background: url('the-welcome-image.png') no-repeat;
    color: transparent; 
```

}

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T17:19:55.240

从外观上看，最好的方法（没有实际顺序）是：

1）使用图像。如果您依赖网站的 SEO，那么请务必[使用这些方法之一添加 html 并使用 css 隐藏它](http://stopdesign.com/archive/2003/03/07/replace-text.html)

2) [typeface.js](http://typeface.neocracy.org/) - 适用于大多数现代浏览器的 JS。有一些错误和小故障，但效果很好。如果您要对您的用户强制使用抗锯齿，那么这是可行的。谨慎使用。虽然作者致力于 Opera 和 IE8 的兼容性...

2) [sIFR](http://www.mikeindustries.com/sifr) - 出色的脚本，可以用 Flash 电影动态替换您选择的文本区域。再次出现一些错误和故障，但如果您只是对看起来很棒的字体感兴趣，那么这是完美的。但是会增加您的页面负载，因此越少越好，请谨慎使用。

我倾向于不使用 JS 繁重的解决方案，因为我喜欢闪电般的快速页面加载，但如果你必须有一些好看的字体，那么这些似乎是最优雅和最简单的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-20T14:55:07.923

强制背景颜色，为具有相同背景颜色的类或元素重新定义它。有用。

```
span.your_class {
    writing-mode: tb-rl;
    filter: flipv fliph;
    background-color: #006cb8 !important;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-07-09T11:48:29.643

```
-webkit-font-smoothing:antialiased; 
```

* * *

## 回答 #6

> 赞同：-5
> 
> 时间：2009-03-19T10:21:27.910

Flash 或 Silverlight 是您获得漂亮字体渲染的最佳选择

# apache-flex - 有人可以解释这个位操作代码吗？

> ID：661661
> 
> 赞同：0
> 
> 时间：2009-03-19T10:17:06.143
> 
> 标签：apache-flex, actionscript-3, actionscript, bit-manipulation

我有一个树控件，每个节点旁边都有复选框，允许节点上的选中、未选中和中间选中状态。单击节点时，将更新父节点和子节点。我发现的代码使用位移，我试图了解到底发生了什么。

有人可以解释以下代码吗？或者更好的是，重写这段代码以便更容易理解？

```
// click event handler
private function eventMessageTree_itemCheckHandler(event:TreeEvent):void {
  var node:ITreeNode = ITreeNode(event.item);
  var checkState:uint = TreecheckboxItemRenderer(event.itemRenderer).checkBox.checkState;
  updateParents(node, checkState);
  updateChilds(node, checkState);
}

private function updateChilds(item:ITreeNode, value:uint):void {
  var middle:Boolean = (value & 2 << 1) == (2 << 1);
  var selected:Boolean = (value & 1 << 1) == (1 << 1);

  if (item.children.length > 0 && !middle) {
    for each (var childNode:ITreeNode in item.children)     {
      childNode.checked = value == (1 << 1 | 2 << 1) ? "2" : value == (1 << 1) ? "1" : "0";
      updateChilds(childNode, value);
    }
  }
}

private function updateParents(item:ITreeNode, value:uint): void {
  var checkValue:String = (value == (1 << 1 | 2 << 1) ? "2" : value == (1 << 1) ? "1" : "0");
  var parentNode:ITreeNode = item.parent;
  if (parentNode) {
    for each (var childNode:ITreeNode in parentNode.children) {
      if (childNode.checked != checkValue) {
        checkValue = "2";
      }
    }
    parentNode.checked = checkValue;
    updateParents(parentNode, value);
  }    
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T16:11:42.410

看起来控件中的 checkState 值可以是 1、2 或 4（或者可能是 0、2 和 4？）：

```
public static const CONTROL_UNCHECKED:uint = 1; // not checked, and some descendants are
public static const CONTROL_CHECKED:uint = 2; // checked, and all descendants are
public static const CONTROL_MIDDLE:uint = 4; // not checked, but some descendants are 
```

而节点中的检查值可以是 0、1 或 2：

```
public static const UNCHECKED:uint = 0; // not checked, and some descendants are
public static const CHECKED:uint = 1; // checked, and all descendants are
public static const MIDDLE:uint = 2; // not checked, but some descendants are 
```

这真是令人困惑。理想情况下，这些将是同一组常量。

更新：

```
private function controlStateToNodeState(value:uint):uint {
   return value / 2;
}
   ...
   updateParents(node, controlStateToNodeState(checkState));
   updateChilds(node, controlStateToNodeState(checkState));
   ...

/** Updates the descendants of the node based on state:
 *  If value is CHECKED, all children are CHECKED
 *  If value is UNCHECKED, all children are UNCHECKED
 *  If value is MIDDLE, children are left alone
 */
private function updateChilds(item:ITreeNode, value:uint):void {
   if (value == MIDDLE) {
      return;  // if value is MIDDLE, children are left alone
   }

   // not middle, so update all children to my state
   for each (var childNode:ITreeNode in item.children)     {
      childNode.checked = value;
      updateChilds(childNode, value);
    }
  }
}

/**
 * Updates the ancestor nodes based on state:
 * If value is CHECKED, ancestors are made MIDDLE if not already checked
 * If value is MIDDLE, ancestors are made middle (they should not already be CHECKED)
 */
private function updateParents(item:ITreeNode, value:uint): void {
    ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T10:26:34.387

基本上，像这样的表达式：

```
var middle:Boolean = (value & 2 << 1) == (2 << 1); 
```

是反直觉的。您通常通过将常量 1 向左移动来测试位，因为这样可以使移动的位数与位的索引相同，将 LSB（最右边）位计算为位号 0。

此外，使用 == 比较来测试结果是没有意义的，因为它总是为 0 或非零，因此如果您的语言需要，您至少可以测试一些更简单的东西。

在默认情况下将非零整数解释为“真”的 C 和 C++ 中，比较完全没有必要，只会引入混乱、重复并增加错误的风险。

我会这样写：

```
var middle:Boolean = (value & (1 << 2)) != 0; 
```

额外的括号应该有助于更清楚地说明事物是如何分组的。注意“2 << 1”是如何被改写为“1 << 2”的。这不仅仅是一个“开关”，您需要计算正确的移位以获得相同的位值，在这种情况下为 4。

当然你可以把位测试放到子程序中并调用它们，以使代码更具可读性。

# .net - 匿名类型集合？

> ID：661663
> 
> 赞同：8
> 
> 时间：2009-03-19T10:20:26.790
> 
> 标签：.net, collections, anonymous-types

我正在寻找创建由匿名类型组成的集合的最佳实践。

有几种方法 -[这个线程上的](http://www.eggheadcafe.com/software/aspnet/31356077/using-anonymous-types-in.aspx)[这个](http://blog.sb2.fr/post/2008/11/25/Anonymous-Type-Collection-with-C-35.aspx)和大多数答案都假设整个匿名集合可以在一个语句中构建。

由于匿名类型通常用于替换用于存储临时的类（如[this SO answer](https://stackoverflow.com/questions/48668/how-should-anonymous-types-be-used-in-c/48705#48705)中提出的），因此我想避免为匿名集合创建和使用类，正如[这篇文章](http://blogs.msdn.com/timng/archive/2007/04/07/making-collections-of-anonymous-types.aspx)所建议的那样。

就我而言，我正在迭代一个集合 - 对于集合中的每个项目，我想以匿名类型（充当元组）收集相关对象。我需要将这些匿名类型放入一个集合中，然后对它们进行排序以供进一步工作。

我考虑过的其他方法：

1.  使用 object[] 或 ArrayList （失去匿名类型的好处）
2.  为所需项目创建包装类（消除对匿名类型的需求）

这是我的代码中唯一需要这样一个集合的地方——最好的方法是什么？

**附加信息：**

我正在使用旧版 .Net 1.1 对象，因此我正在使用的集合是实现 IEnumerable 的强类型集合，因此大多数 Linq 扩展方法（例如 .Select）都不起作用：

**代码示例**

```
foreach (Item item in myItems)
{
    foreach (Confirmation confirmation in item.GetConfirmations(true))
    {
        if (lastParentId != item.ParentId)
        {
            lastParentId = item.ParentId;
            parentObject = new ParentItem(lastParentId);
        }

        itemHolder = new ArrayList { item, confirmation };
        if (parentObject!= null)
        {
            itemHolder.Add(parentObject.Rate);
        }

        sortConfirmations.Add(confirmation.Date, itemHolder);
    }
}

// Use sortConfirmations 
```

**解析度**

我最终使用通用字典将相关项目收集在一起并使用 .OrderBy() 对它们进行排序 - 丑陋，但它有效......并且比现有代码更好。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-03-19T10:29:09.607

如果您对数组感到满意，则可以使用数组初始化程序：

```
var items = new[] {
    new { Foo = "def" },
    new { Foo = "ghi" },
    new { Foo = "jkl" }
}; 
```

`ToList()`如果你想`List<T>`出去，你可以打电话。`ToList()`由于不需要额外的复制，Marc 的解决方案将比调用更有效，但我*认为*在大多数情况下我可能会使用“array and then ToList()”解决方案，因为这样会减少混乱。当然，如果性能对于那段代码至关重要，它会改变一些事情。

编辑：当您迭代集合时，只需使用`Select`：

```
var anonymousItems = items.Select (item => new { Foo=item.Foo, 
                                                 Bar=item.Other })
                          .ToList(); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-19T10:35:39.140

对于一个非常不同的答案...... LINQ？

> 就我而言，我正在迭代一个集合 - 对于集合中的每个项目，我想以匿名类型（充当元组）收集相关对象。我需要将这些匿名类型放入一个集合中，然后对它们进行排序以供进一步工作。

这听起来像：

```
var list = (from item in collection
          from related in item.Relationship
          order by ...something...
          select new {item,related}).ToList() 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-19T10:22:56.317

一种选择是使用示例项通过泛型类型推断来创建集合，例如：

```
 static List<T> CreateEmptyList<T>(T template) {
        return new List<T>();
    }
    void Foo() {
        var list = CreateEmptyList(new { Foo = "abc" });
        list.Add(new { Foo = "def" });
        //...
    } 
```

您也可以在*不*创建实例的情况下执行此操作（但使用永远不会获取调用者的匿名方法），但我认为它不会真正节省任何东西......我们可能不会创建对象的实例，但我们确实创建了一个实例一个代表，所以没有多少节省......

您还提到对数据进行排序；请参阅[此处的回复](https://stackoverflow.com/questions/532015/how-to-sort-generic-list-asc-or-desc/532025#532025)以了解与 lambda一起使用的方法`List<T>.Sort`，因此与匿名类型一起使用 - 即

```
list.Sort(x=>x.Foo); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-19T10:47:04.697

LINQ是要走的路。假设您要获取集合 items 中每个项目的相关对象 A、B 和 C 并按相关对象 A 排序，您将执行以下操作。

```
var relatedObjects = items.
       Select(item => new { A = item.A, B = item.B, C = item.C } ).
       OrderBy(item => item.A); 
```

您将获得一组匿名类型的项目，其中三个属性 A、B 和 C 设置为由相关对象 A 排序的相关对象。

我没有验证这一点，但您应该可以稍后扩展 relatedObject 集合。只需执行以下操作即可添加一个新项目。这应该可行，因为如果每个属性的名称和类型匹配，我认为每个程序集只有一个匿名类型。

```
relatedObjects = relatedObjects.Union(
   Enumerable.Repeat(new { A = someA, B = someB, C = someC }, 1)) 
```

由于 Enumerable.Repeat() 非常丑陋，但如果您与新项目的集合而不是单个新项目联合，则会变得非常好。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-06-16T14:57:01.280

我在寻找一种方法来创建临时对象的临时列表时偶然发现了这个问题。我为什么要创造这样的东西？我正在寻找一种快速的方法来返回 JSON 以获取由另一个对象的某些值组成的对象列表。这就是我的意思。

假设我在服务器端有一个 Employee 类，它在 C# 中如下所示：

```
public class Employee
{
          public int Id;
       public int businessGroupId;
       public string title;
       public int positionId;

       public string firstName;
       public string lastName;
       ...
} 
```

此外，我有一个可以轻松迭代的对象的集合，如下所示：

```
List<Employee> allEmployees  = new List<Employee>(); 
```

*现在，我想将整个Employees集合*返回到我的调用网页，但我**只想要每个的firstName、lastName**。我希望它们以 JSON 形式返回。

**这是重点**

我不想返回 Employee 对象中的所有属性。

我知道我可以通过遍历 allEmployees 集合并每次构建一个新对象来轻松创建一个匿名类型。

它看起来像下面这样：

```
foreach (Employee e in allEmployees)
{
    var tempObj = new {F_Name=e.firstName, L_Name=e.lastName};
} 
```

**匿名类型的类型是什么？:)**

现在的诀窍是我想要这些匿名对象的整个集合 (List<>)。但是，我无法为 List 提供我将使用的类型。我无法创建 `List<unknown> allTempObjects = new List<unknown>();`

或者我可以吗？

**有了动态，就有可能**

我可以执行以下操作，并且效果很好：

```
List<dynamic> allEmployees  = new List<dynamic>();

foreach (Employee e in allEmployees)
{
           var tempObj = new {F_Name=e.firstName, L_Name=e.lastName};
        allEmployees.Add(tempObj);
}

// use the JavaScript Serializer to serialize the dynamic collection
JavaScriptSerializer jss = new JavaScriptSerializer();
// write the result out to the HTTP Stream (HtmlTextWriter in overridden Render method)

 writer.Write(jss.Serialize(allEmployees)); 
```

您将在客户端看到 JSON，如下所示：

```
[
    {
      F_Name: "Seth",
      L_Name: "Godin"
    },
    {
       F_Name: "Charles",
       L_Name: "Petzold"
    },
    {
       F_Name: "Jeff",
       L_Name: "Prosise"
    }
] 
```

最后，你可能会质疑我为什么要这样做。简单的答案是我想要新的类型，它只用于序列化发送给我的客户。匿名类型和匿名类型的匿名集合的重要原因，你不觉得吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-19T10:47:58.050

> 这个线程上的这个和大多数答案都假设整个匿名集合可以在一个语句中构建。

是的，您通常在单个语句中创建匿名类型的集合。如果你需要更多的语句，你最终可能会得到一个非常无用的不同匿名类型的集合。

当您在单个语句中创建匿名类型并立即使用它们时，它们很有用。如果集合的创建或进一步处理有点复杂，匿名类型就会失去一些有用性。例如，您不能有效地将匿名类型传递给方法进行处理，因为该方法不知道对象的类型，因此必须使用反射来从中获取任何内容。

如果您要在此匿名类型集合中重复查找项目，您可能需要创建一个命名类型，以便您可以将它们放入字典中以更快地查找。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2019-12-19T08:06:10.377

您可以像这样创建集合

private IList<(string Name, bool listenToQueue)> _listeners;

# visual-studio - 为 Windows 应用程序配置构建目录结构的最佳方法

> ID：661669
> 
> 赞同：2
> 
> 时间：2009-03-19T10:22:05.037
> 
> 标签：visual-studio, visual-studio-2008, msbuild, build-process, nant

我目前正在编写一个小型应用程序，并试图组织我的构建输出以更接近成品。该应用程序由许多不同的项目组成。有一个包含大部分功能的核心库，一个 GUI 应用程序和一个命令行应用程序都引用了 Core Dll，以及许多在运行时加载并实现不同数据源的插件 Dll，这些都引用 core.dll ，这些也可能包括其他一些第三方 dll。还有一些外围文件，例如自述文件。最后对 core.dll 和数据源插件进行单元测试。

我想配置我的构建，以便在安装时将所有内容输出到目录中。我希望将调试和发布版本构建到不同的目录中，但在其他方面具有相同的目录结构。我只希望为调试构建构建测试，并希望它们可以运行，但是是分开的（我猜所有的测试 dll 都会输出到一个单独的目录中）。这是我想象的结构。

```
Code/
    solutions etc here
Debug/

    Project.Core.dll
    Project.Gui.exe
    Project.Cli.exe
    readme.txt
    lib/
        ThirdParty1.dll
        ThirdParty2.dll
    DataSource/
        DataSource1.dll
        DataSource2.dll
    Tests/
        Project.Core.Tests.dll
        DataSource1.Tests.dll
Release/
    same as Debug but without tests. 
```

有没有办法得到这样的解决方案？我开始认为从一个解决方案构建插件和应用程序将很困难，甚至可能不明智，但由于它们都将一起分发，所以会很好。我愿意使用 Nant 或其他构建工具，如果这会使它更简单的话。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T11:36:37.183

有可能的。只需在 Debug 和 Release 文件中的每个 .csproj 中手动修改 OutputPath 标记即可

```
<OutputPath>..\$(Configuration)\any_subdirs</OutputPath> 
```

您可以使用配置管理器禁用为发布构建测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-06-09T04:55:52.090

每次创建新项目时都修改每个项目很烦人。

这是解决方案：

1.  找到真正的 vs 项目，它会在 ("%programfiles(x86)%\Microsoft Visual Studio 10.0\Common7\IDE\ProjectTemplates*")

2.  将其复制到本地某处。

3.  提取它。

4.  编辑内容，进行更适合您的项目布局样式的更改。确保更新项目名称，该名称是您在新项目对话框中查找项目时看到的名称。它的 xml 标签是`Name`，您可以在 {something}.vstemplate 文件中找到它。

5.  再次压缩内容。（注意：内容不能在子文件夹中，所以 /* 和 NOT /{somefolder}/*）。

6.  将您的自定义项目放在 ("%USERPROFILE%\Documents\Visual Studio 2010\Templates\ProjectTemplates*") 下。

7.  添加一个新项目是 Visual Studio，选择您的自定义项目，尽情享受吧！

# c# - 如何在 GridView 中实现条件格式

> ID：661670
> 
> 赞同：5
> 
> 时间：2009-03-19T10:22:07.813
> 
> 标签：c#, .net, gridview, asp.net-2.0

我的 aspx 页面上有一个 GridView，它显示由以下类定义的对象集合

```
public class Item
{
    public string ItemName{get; set;}
    public object ItemValue{get; set;}
} 
```

然后在我的 aspx 标记中我有这样的东西

```
<asp:GridView ID="MyTable" runat="server">
    <Columns>
        <asp:BoundField DataField="ItemName" />
        <asp:BoundField DataField="ItemValue" />
    </Columns>
</asp:GridView> 
```

我想知道的是：
*有没有办法在 ItemValue 字段上使用条件格式，这样如果对象持有一个字符串，它将返回未更改的字符串，或者如果它持有一个 DateTime，它将显示为 DateTime.ToShortDateString( ）。*

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-19T10:39:16.727

不确定是否可以使用 BoundField，但如果将其更改为 TemplateField，则可以使用[此链接](http://www.vbforums.com/showthread.php?t=545143)中的格式化函数。

即类似的东西

```
<%# FormatDataValue(DataBinder.Eval(Container.DataItem,"ItemValue")) %> 
```

然后在你的代码隐藏中，你可以添加一个受保护的函数

```
Protected Function FormatDataValue(val as object) As String
    'custom enter code hereformatting goes here
End Function 
```

或者您可以在 gridview 的 OnRowCreated 事件中执行某些操作，例如在[此链接中](http://www.netomatix.com/development/gridviewformatcolumn.aspx)

```
<asp:GridView ID="ctlGridView" runat="server" OnRowCreated="OnRowCreated" /> 
```

此函数是基于数据值是否为空/是否为双精度的条件格式

```
protected void OnRowCreated(object sender, GridViewRowEventArgs e)
{
    if (e.Row.RowType == DataControlRowType.DataRow)
    {
        DataRowView drv = e.Row.DataItem as DataRowView;
        Object ob = drv["ItemValue"];

        if (!Convert.IsDBNull(ob) )
        {
            double dVal = 0f;
             if (Double.TryParse(ob.ToString(), out dVal))
             {
                 if (dVal > 3f)
                 {
                     TableCell cell = e.Row.Cells[1];
                     cell.CssClass = "heavyrow";
                     cell.BackColor = System.Drawing.Color.Orange;
                 }
             }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-19T10:51:50.787

使用 BoundField 你应该修改你的 Item 类。

如果你不想修改你的 CodeBehind 有一种技巧，你可以使用 TemplateField：

```
 <asp:GridView ID="MyTable" runat="server" AutoGenerateColumns="False">
        <Columns>
            <asp:BoundField DataField="ItemName" HeaderText="Name" />
            <asp:TemplateField HeaderText="Value">
                <ItemTemplate>
                    <asp:Label ID="Label1" runat="server" Text='<%# ((Eval("ItemValue") is DateTime) ? ((DateTime)Eval("ItemValue")).ToShortDateString() : Eval("ItemValue")) %>'></asp:Label>
                </ItemTemplate>
            </asp:TemplateField>
        </Columns>
    </asp:GridView> 
```

显然你可以为任何类型的对象做到这一点，但也许你的“文本”字段会变得......复杂......

顺便说一句..我在这个例子中的 CodeBehind 就是你的 Item 类和这个 Page_Load()：

```
 protected void Page_Load(object sender, EventArgs e)
    {
        Item i1 = new Item();
        i1.ItemName = "name1";
        i1.ItemValue = "foo";
        Item i2 = new Item();
        i2.ItemName = "name2";
        i2.ItemValue = DateTime.Now;
        List<Item> list1 = new List<Item>();
        list1.Add(i1);
        list1.Add(i2);
        MyTable.DataSource = list1;
        MyTable.DataBind();
    } 
```

结果是正确的；）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-02-10T22:22:20.353

我决定使用[Paul Rowland](https://stackoverflow.com/users/6268/paul-rowland)解决方案和更多“如果（e.Item.DataItem 是 DataRowView）”：

```
 if ((e.Item.ItemType == ListItemType.Item) || (e.Item.ItemType ==                 ListItemType.AlternatingItem))
     {
       if (e.Item.DataItem is DataRowView)
       {
         DataRowView rowView = (DataRowView)e.Item.DataItem;
         String state = rowView[PutYourColumnHere].ToString();
         if (state.Equals("PutYourConditionHere"))
         {
           //your formating, in my case....
           e.Item.CssClass = "someClass";
         }
       }
     } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-12-15T11:03:03.577

在 .NET 2.0 中更容易：

将此方法添加到代码后面：（此示例将双精度值格式化为 1 位数的百万）

```
public string EvalAmount(string expression)
{
    double? dbl = this.Eval(expression) as double?;
    return dbl.HasValue ? string.Format("{0:0.0}", (dbl.Value / 1000000D)) : string.Empty;
} 
```

在 aspx 代码中，使用这个：

```
<asp:TemplateField ItemStyle-Width="100px">
    <ItemTemplate>
        <asp:Label runat="server" Text='<%# EvalAmount("MyAmount") %>'></asp:
    </ItemTemplate>
</asp:TemplateField> 
```

# iphone - TabBarController 中视图控制器的 RetainCount -（又名释放 tabBarController）

> ID：661678
> 
> 赞同：0
> 
> 时间：2009-03-19T10:26:51.593
> 
> 标签：iphone

我创建了一个 iPhone 应用程序，您从 NavController 开始，经过几个级别后，您从表中选择一个选项，然后会弹出一个动画视图，其根部有一个 tabbarcontroller。

这是一个完全独立的视图，取代了导航控制器。您使用选项卡，当您想要返回选项屏幕时，您按下返回，另一个动画过渡播放交换导航控制器，移除选项卡栏控制器并释放它。

问题来自于释放 UITabBarController。如果您按下选项卡按钮在选项卡之间切换，您似乎会不断增加视图控制器的引用计数。然后，当您在 tabBarController 引用上调用 release 时，它​​只会释放所选选项卡的视图控制器或您尚未查看的任何选项卡，并且它会占用其他选项卡视图控制器上的保留计数之一。这意味着您从未选择的每个其他选项卡中泄漏了所有模型对象、自定义单元对象等。

作为我所看到的示例，如果您在 xcode 中创建一个新的模板 TabBarController 项目并将 viewWillAppear 方法添加到第一个打印出自身保留计数的视图控制器。启动应用程序并在第一个和第二个选项卡按钮上来回按，然后观察日志，保留计数不断增加。

所以我想知道是否有办法释放标签栏控制器并让它同时释放所有视图控制器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-19T10:33:10.127

如果这是真的，这是一个错误，您应该在 Apple Radar 上提交报告。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T19:57:45.073

为了完整起见，我确实在苹果开发论坛上发布了这个问题，以寻求一些确认，但从未收到任何回复。

在 OS3.0 上查看我的应用程序表明此行为现已修复。引用计数永远不会增加，并且释放 UITabBarController 似乎有效。

可悲的是，我做了一个讨厌的 hack 来解决这个问题，它在 OS 3.0 上不能很好地运行，所以现在是条件编译时间。

# testing - 在 Dogfood 和 QA 之间取得平衡的技巧？

> ID：661679
> 
> 赞同：5
> 
> 时间：2009-03-19T10:26:53.730
> 
> 标签：testing, qa

大多数开发人员都知道吃自己的狗粮的想法，但同时从数学上证明，让 QA 人员（或测试人员）进行 QA 比让开发人员进行 QA 更便宜。

现在当然在任何一个方向上都没有必要成为极端主义者，但我注意到，取决于项目和开发人员（或 QA 人员或经理），平衡会以一种或另一种方式摇摆，但我很好奇在确定每个营地应该进行多少质量检查时，有哪些好的经验法则可以应用。

**更新：**虽然不是在每种情况下都在数学上，但乔尔[关于 QA 的文章应该](http://www.joelonsoftware.com/articles/fog0000000067.html)足够清楚，他实际上也有[一个 dogfood](http://www.joelonsoftware.com/articles/fog0000000012.html) :)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-19T10:33:32.937

我*几乎*同意 Garry 的回答——除了他声称这与提高代码质量无关。我认为这绝对*与*此有关，以及他在第一段中提到的可用性。

如果你能吃到广泛的狗粮，你会得到：

*   比 QA 可能使用的更真实的数据（假设它是*真实*数据！）
*   纯粹的数字力量比 QA 可能使用的数据*范围*更广

我当然已经修复了很多次在 dogfooding 中发现的错误，而这种情况还没有经过 QA 测试。在许多情况下，您确实*无法*测试所有可能性，但 dogfooding 有助于测试*更多*。

让尽可能多的人接受狗粮（当然，对潜在问题设定适当的期望）。它当然不应该是“仅限开发人员”的事情（当然，除非您正在构建仅限开发人员的产品）。这并没有带走 QA 的宝贵工作——它增加了它。

*不过，这在很大程度上*取决于您正在开发的内容。我曾在一家公司工作，那里的员工永远不会有任何理由在日常生活中使用该产品，所以 dogfooding 并不可行。在另一家公司，我们正在构建一个 Web 代理，因此让公司的大部分人通过代理进行浏览是有意义的。我最近一直在研究针对消费者的同步产品，所以再次广泛地进行 dogfood 测试是有意义的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-19T10:30:40.570

Dogfooding 根本与 QA 无关。这是关于使用您自己开发的产品，以便您可以看到工作流程中可以改进的地方，并总体上感受到使用软件的痛点。

它不是为了提高代码的质量，而是为了让您的软件更易于使用并指导您选择功能开发。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-19T11:55:57.153

**正式与非正式**

使用你自己的产品（“吃你的狗粮”）是质量保证的一部分，我会将其归为非正式测试类别，而不是通常由单独的 QA 部门进行的更正式的测试。

**深度与广度**

“吃你的狗粮”旨在为直接负责其设计和开发的人员提供使用产品或服务的第一手体验。对于功能丰富的应用程序，它可能会比正式测试更深入，同时考虑到特定的用户视角，当正式测试通常涵盖软件用例的广度并尝试以更客观和可衡量的术语运行时。

**带来改变的小烦恼**

还有一类非常特定于环境的缺点，只能在“现场”诊断（就像这种非常烦人的嘎嘎声，每当你以 72.52 英里/小时的速度巡航时，它似乎无处不在，让你绝对发疯，然而，当汽车停在车库时，没有一个机械师能够，也不愿意深入了解原因）。

**裸软件与应用程序 + 实践集**

使用自己的产品远远超出了软件本身；它不可避免地包含了整个“用户旅程”。“吃你的狗粮”让我们开发和更好地理解在一个领域内使用软件的技术。可以公平地说，某些软件在许多不同的环境中使用。正式测试可能无法深入涵盖这些上下文中的每一个，这仅仅是因为可能难以正式定义一旦发生变化后您需要执行哪些特定测试。或者，每次软件发生轻微变化时，在内部模拟这些上下文或遍历所有已知的测试用例可能太昂贵了。

**内部变化与外部**

正式测试确实擅长检查对软件所做的更改是否有效，但是正式测试正在努力的另一个重要进化领域是当您需要检测来自外部世界的软件环境或使用模式的变化时。使用您自己的产品将有助于更快地检测到这些变化，可能在用户告诉您之前（取决于用户反馈渠道的质量）。

**“平衡”有什么问题？**

因此，在使用你自己的产品和正式测试它之间没有平衡（尽可能多地做这两者，即你得到的回报是值得的）。一个是赞美另一个，而不是作为替代品。

**谁应该做测试：区别**

除非没有专门的资源来进行正式测试（单独的开发人员，开发人员进行所有测试），并且您必须选择可以将多少时间用于这两项活动中的任何一项。好吧，不要。这里的重要区别是，正式测试最好由独立的权威机构完成，即不向开发和设计团队报告的人。另一方面，每个人（设计师、开发人员、营销人员甚至 CEO）都应该尽可能多地使用公司的产品或服务，因为“dogfooding”背后的核心理念是让每个参与其中的人都能获得第一手的服务或产品体验他们在现实生活中做出了贡献。

**你不能对所有东西都进行狗粮！或者你可以吗？**

至于“你不能 dogfood 某些类型的软件”的论点，好吧，让我们不要专注于 dogfooding 的样子：吃你的狗粮，而是想想它的含义：获得第一手经验和“对齐”与这些实际用户的兴趣”。

自己吃食物的下一个最好的事情是在狗吃食物的同时观察它，而不是依靠别人告诉你你的狗喜欢或不喜欢什么。

虽然开发团队成员可能无法亲自将污水控制软件用于他们的日常工作，但没有什么能阻止他们花一些时间定期观察使用该应用程序的污水工程师，这不符合“dogfooding”的字母，但是当然抓住了它的精神。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-17T19:51:01.970

我完全同意 Jon 的回答，补充说 dogfood 测试即使对于 QA 也很重要，而且通常没有完成。我不止一次开始使用一个产品，QA 的其他部分（有时甚至是我自己——哎呀）据说已经完成了测试，并且在正常使用中发现了不合理的错误。有时，正如 Joel on Software 文章所指出的，这只是糟糕的测试；教程中的第一个示例失败（例如 Deja Gnu）非常常见。但更多时候是因为 dogfooding 与系统测试是一个非常不同的过程：你不是在做你被告知要做的事情，而是在你*不*试图寻找错误时做你实际做的事情。

A very, very good test plan might cover some of those cases, but in the most embarrassing example in my own company, the test plan was part of the problem: A conspicuous option, which most hard-core developers would be certain to need, was officially unsupported, and hence untested, but necessary nonetheless. I suppose a more reasonable functional requirements definition wouldn’t have made that mistake; if you know of any company whose FRD’s are always entirely reasonable and which is hiring, do let me know :-)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-19T10:31:47.590

有两个角色通常被描述为“QA”。

*   质量保证——保证质量计划正在执行的人。

*   测试人员——不编码的开发人员。

如果您的问题集中在“确保质量计划正在执行”上，那么这很容易：开发人员*进行*符合质量计划的工作，并且 QA 审核质量计划是否得到遵循。

由于您的问题集中在“不编码的开发人员”上，那么您首先没有太多的质量计划。在这种情况下，开发人员需要 (1) 将测试人员整合到他们的队伍中，(2) 创建质量计划，以及 (3) 根据该计划工作。

该计划可能涉及一些独立的测试。这可以通过让开发人员 A 为开发人员 B 编写测试来完成。也可以通过让开发人员 A 编写测试并在开始编码之前对这些测试进行同行评审来完成。

这个想法是开发人员编写、检查和测试他们自己的代码。一个开发组织。每个人都在编码——有些人比其他人多。

QA 确保开发人员确实始终如一且完全地做到这一点。

我不认为“不编码的开发人员”是一项可行的工作。这些是真正的初级开发人员。您可以利用它们来增加一些额外的技术技能；或者将他们浪费在他们花费大量时间被用户殴打并与开发人员争论的位置上。

利用“不编码的开发人员”的一种方法是让他们开始编写测试；然后使用它们来修复损坏的代码；然后从别人的设计中编码；然后自己做设计工作。

有很多方法可以阻止这些“不会编码的开发人员”。一是让他们猜测用户的意思。通过将他们对流程的知识缩小到他们在业务分析文档中找到的内容来做到这一点。另一个是让他们不得不与开发人员就业务分析文档的解释进行争论。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-19T16:46:07.697

我相信你可以想出一个节省成本的方程式，但这只是时间点。开发人员应该在实际情况下始终“吃自己的狗粮”（为什么开发人员要为其他人创建 IDE 而自己不使用它？？？） - 但他们应该始终在某种程度上参与基础 QA 活动。我去过许多公司，那里的开发人员将代码扔到墙上（“我废话黄金综合症”） - 导致一个又一个循环的错误代码被测试，没有完全修复并再次测试。

经理应确定每个小组所做的测试水平，并随着时间的推移和每个相关人员的具体情况进行调整/调整。交付的代码越糟糕，测试 (TDD) 的时间就越多，应该花在改进开发人员上。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-19T10:34:31.357

一般来说，DogFooding 没有那么有用，除非您碰巧正在开发作为开发人员也需要使用的开发人员工具。

在我工作的地方，我们确实使用我们自己的产品，但不像我们的客户那样广泛使用。由于我们的客户不从事软件开发业务。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-19T12:26:04.617

如果您要构建员工每天都可以使用的东西，Dogfooding 是一个很好的解决方案，但不幸的是，我认为这对每个应用程序都是可行的。如果您正在编写即时消息客户端，那么 dogfooding 很容易。如果您为污水处理厂编写控制系统，那么可能不会。

QA 是关于软件的专业质量控制。我认为是否需要它的决定完全取决于被测系统的复杂性和故障成本。与制造业有一个（可能过于简单化）的类比。我可能会买一支没有通过质量控制部门的铅笔，但我绝对不会买没有通过质量控制部门的机票。

# ruby - 如何确保一次只运行一个 Ruby 脚本实例？

> ID：661684
> 
> 赞同：9
> 
> 时间：2009-03-19T10:30:34.517
> 
> 标签：ruby, linux

我有一个每五分钟在 cron 上运行的进程。通常，运行只需几秒钟，但有时需要几分钟。我想确保一次只运行一个版本。

我尝试了一个明显的方法......

```
File.open("/tmp/indexer_lock.tmp",'w') do |f|
  exit unless f.flock(File::LOCK_EX)
end 
```

...但它不是测试它是否可以获得锁，它会阻塞直到锁被释放。

知道我错过了什么吗？我宁愿不使用 ps 破解某些东西，但这是另一种选择。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2010-12-01T18:07:27.810

我知道这已经过时了，但是对于任何感兴趣的人来说，有一个非阻塞常量可以传递给flock，以便它返回而不是阻塞。

```
File.new("/tmp/foo.lock").flock( File::LOCK_NB | File::LOCK_EX ) 
```

### 更新[slhck](https://stackoverflow.com/users/435093/slhck)

`flock`如果**此**进程收到锁，则返回 true，否则返回 false。因此，为了确保一次只运行一个进程，您只想尝试获得锁，如果无法获得则退出。`exit unless`就像在我上面的代码行前面放一个一样简单：

```
exit unless File.new("/tmp/foo.lock").flock( File::LOCK_NB | File::LOCK_EX ) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-02-02T16:23:04.247

根据您的需要，这应该可以正常工作，并且不需要在任何地方创建另一个文件。

```
exit unless DATA.flock(File::LOCK_NB | File::LOCK_EX)

# your script here

__END__
DO NOT REMOVE: required for the DATA object above. 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-19T10:33:09.677

您可以创建和删除一个临时文件并检查该文件是否存在。请检查这个问题的答案： [一个实例 shell 脚本](https://stackoverflow.com/questions/185451/quick-and-dirty-way-to-ensure-only-one-instance-of-a-shell-script-is-running-at-a)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-19T11:37:13.530

尽管这不能直接回答您的问题，但如果我是您，我可能会编写一个守护程序脚本（您可以使用[http://daemons.rubyforge.org/](http://daemons.rubyforge.org/)）

您可以让您的索引器（假设它的 indexer.rb）通过名为 script/index 的包装脚本运行，例如：

```
require 'rubygems'
require 'daemons'

Daemons.run('indexer.rb') 
```

你的索引器几乎可以做同样的事情，除了你指定一个睡眠间隔

```
loop do
   # code executing your indexing 

   sleep INDEXING_INTERVAL
end 
```

这就是作业处理器与队列服务器协同工作的通常方式。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-19T16:36:24.053

对于这种情况，有一个[lockfile gem](http://rubyforge.org/projects/codeforpeople/)。我以前用过它，它很简单。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-19T12:44:17.257

如果您使用 cron，那么在 cron 调用的 shell 脚本中执行以下操作可能会更容易：

```
#!/usr/local/bin/bash
#

if ps -C $PROGRAM_NAME &> /dev/null ; then
   : #Program is already running.. appropriate action can be performed here (kill it?)
else
   #Program is not running.. launch it.
   $PROGRAM_NAME
fi 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2020-06-10T00:39:48.813

这是一个应该在任何 Ruby 脚本的顶部工作的单行代码：

```
exit unless File.new(__FILE__)).tap {|f| f.autoclose = false}.flock(File::LOCK_NB | File::LOCK_EX) 
```

* * *

原始代码有两个问题。

**首先**，它阻塞的原因[`#flock`](https://ruby-doc.org/core/File.html#method-i-flock)是缺少调用[`File::LOCK_NB`](https://ruby-doc.org/core/File/Constants.html#LOCK_NB)：

> 锁定时不要阻塞。可以使用逻辑或与其他锁定选项结合使用。

**其次**，如果 File 对象被关闭（无论是在上面代码中的块末尾[`#open`](https://ruby-doc.org/core/File.html#method-c-open)，通过显式[`#close`](https://ruby-doc.org/core/IO.html#method-i-close)，还是在 File 被垃圾回收时隐式自动关闭），则关闭底层文件描述符并释放锁. 为了防止这种情况，您可以设置.[`#autoclose =`](https://ruby-doc.org/core/IO.html#method-i-autoclose-3D)`false`

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-19T10:51:30.553

好的，根据@shodanex 的指针处理笔记，这就是我所拥有的。我稍微改进了一下（虽然我不知道 Ruby 中有触摸模拟）。

```
tmp_file = File.expand_path(File.dirname(__FILE__)) +  "/indexer.lock"
if File.exists?(tmp_file)
  puts "quitting"
  exit
else
  `touch #{tmp_file}`
end

.. do stuff ..

File.delete(tmp_file) 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-19T13:30:20.453

您能否不将 File::LOCK_NB 添加到您的锁中，以使其成为非阻塞（即如果无法获得锁则失败）

这适用于 C、Perl 等。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-03-17T01:51:06.577

在更高的层次上，您可能会发现[lock_method](https://github.com/seamusabshere/lock_method) gem 很有用：

```
def the_method_my_cron_job_calls
  # something really expensive
end
lock_method :the_method_my_cron_job_calls 
```

它默认使用存储在本地文件系统上的锁文件（上面已经讨论过），但您也可以配置远程锁存储：

```
LockMethod.config.storage = Redis.new([...]) # a remote RedisToGo instance, perhaps? 
```

还...

```
def the_method_my_cron_job_calls
  # something really expensive
end
lock_method :the_method_my_cron_job_calls, (60*60) # automatically expire lock after an hour 
```

# wpf - WPF ListBox 问题的解决方法

> ID：661688
> 
> 赞同：1
> 
> 时间：2009-03-19T10:32:05.560
> 
> 标签：wpf, listbox

我有一个 WPF ListBox 控件。它可以有很长的项目列表。

当我使用正常的屏幕分辨率（即 1024 * 768）时，如果我提到列表框的 MinHeight 和 MaxHeight，它会正确显示带有滚动条的列表框。

当我切换到另一个分辨率时，即 1280 * 1024，理想情况下，列表框应该适合屏幕分辨率。但是，它没有发生。由于我提到的高度，它保持不变，留下很多空白空间，这显然不好看。

我需要一个正常 1024*768 分辨率的滚动条，所以我必须输入 MinHeight 和 MaxHeight。

是否有任何解决方案来查看扩展的 ListBox 正确占用空间以获得更高分辨率？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T10:40:49.313

使用面板来布置控件 - 不要使用明确的宽度和高度。例如：

```
<Grid>
    <Grid.RowDefinitions>
        <Row Height="*"/>
        <Row Height="Auto"/>
    </Grid.RowDefinitions>

    <!-- ListBox will take up all remaining space after the Button -->
    <ListBox/>
    <!-- Button will take up only the space it needs -->
    <Button Grid.Row="1"/>
</Grid> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T10:56:40.993

```
 <StackPanel Orientation="Horizontal"  Margin="0,0,0,5" VerticalAlignment="Top" HorizontalAlignment="Left" Grid.Row="0">
                    <Label  FontWeight="Bold" FontSize="11" HorizontalAlignment="Left" Margin="0,0,5,5">Term:</Label>
                    <ComboBox x:Name="Term" Margin="0,5,5,0">
                    </ComboBox>                        
                </StackPanel>
                <CheckBox Grid.Row="1" HorizontalAlignment="Left" VerticalAlignment="Top" x:Name="displaySummaryCheckBox" Margin="2,2,0,5"  FontSize="11" Content="Display Summary" IsChecked="True" FontWeight="Normal"></CheckBox>

            </Grid>                
            <Grid DockPanel.Dock="Bottom">

                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <Label Grid.Row="0" VerticalAlignment="Top" Margin="0,0,0,4" HorizontalAlignment="Left" FontWeight="Bold" FontSize="11">Display Columns</Label>
                    <ListBox Grid.Row="1" VerticalAlignment="Top" Margin="5,0,5,4" HorizontalAlignment="Left" x:Name="columnsList" Width="197"  FontSize="11">

                    </ListBox>
                    <Button Grid.Row="2"  Margin="5,0,5,2" HorizontalAlignment="Left" VerticalAlignment="Top" x:Name="selectAll" Width="75" Content="Select All" FontWeight="Normal"  FontSize="11" Height="23" Click="selectAll_Click"/>
                </Grid>

            </Grid>

        </DockPanel> 
```

# cocoa - 将 NSMutableArray 传递给其他类

> ID：661694
> 
> 赞同：0
> 
> 时间：2009-03-19T10:34:27.253
> 
> 标签：cocoa, arrays, import, mutable

我在类 loginController 的实现中创建了一个 NSMutableArray。可变数组包含一组字符串。我想将可变数组及其对象传递给我的可可项目中的其他类。传递数组的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T11:38:15.853

最基本的情况是您的登录控制器只是将阵列的快照交给另一个控制器。在这种情况下，您的登录控制器将需要引用其他类的实例，并将这些实例的某些属性设置为数组。请记住使用属性声明`copy`属性，以便接收者不会保留您的私有可变数组。

如果您希望其他控制器能够修改数组，*请不要*让他们拥有您的可变数组——这会导致难以发现的错误。

相反，您需要在登录控制器上实现一个属性，而不是在每个其他控制器上实现一个属性。登录控制器的属性应该至少有一个 getter 和 setter（你可以`@synthesize`），但你可以实现[更具体的访问器方法](http://boredzo.org/blog/archives/2007-08-07/a-complete-raw-list-of-kvc-accessor-selector-formats)以提高效率。

拥有此属性后，其他控制器应以符合 KVO 的方式访问该属性。如果您实现特定的访问器，他们就可以使用它们。否则，他们需要发送`mutableArrayValueForKey:`到登录控制器。当他们访问代理数组的内容时，他们真正访问了登录控制器的数组；当他们改变代理数组时，他们依次改变登录控制器的数组。

接下来是实际的 KVO 部分。您希望其他控制器知道其中一个（或登录控制器）何时更改属性。让每个控制器（除了登录控制器）将自己添加为登录控制器属性的观察者。请记住让他们在他们的`-dealloc`（或`-finalize`）方法中删除自己。

为了发布正确的通知，一切都需要使用访问器或`mutableArrayValueForKey:`. 登录控制器本身也是如此——它应该在改变数组时使用自己的访问器，而不是直接向数组发送消息。唯一的例外是 in`init`和`dealloc`（因为访问器消息将是发送到 half `init`-ed/ `dealloc`ked 对象的消息，如果你让访问器变得花哨*，这将是一个问题）。

顺便说一句，听起来你可能有太多控制器。看看您是否不能将一些逻辑移到模型对象中。这极大地简化了您的代码，因为 Cocoa 旨在与模型层一起使用。重控制器是在与框架作斗争，这会让你做更多的工作。

*“花式”是指在给定访问器方法的正常行为之外或之外做的事情。例如，`insertObject:in<Foo>AtIndex:`通常只是尾调用`[<foo> insertObject:atIndex:]`；如果您将对象插入或存储在实例变量中的数组以外的地方，或者如果您在同一方法中执行其他操作（例如告诉视图需要显示），那么您的访问器方法很漂亮。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T11:41:24.397

可能不是最佳实践的简短回答：

```
[otherObject giveArray:[NSArray arrayWithArray:theMutableArray]]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T11:55:09.510

这个问题很好，但并不完整……您只需要传递一个字符串数组还是要传递的类是否需要修改数组？

一般来说，简单地传递一个 NSMutableArray* 不是问题，但是你需要小心，因为你只是传递一个指针（所以如果你将它保留在某个地方，你需要知道所有者或其他一些类可能修改数组）。一般来说，您会希望使用 NSMutableArray 动态构建一个对象数组，当您需要共享它们时，然后制作一个非可变副本并将其传递。

```
 NSMutableArray* myArr = [NSMutableArray arrayWithObjects:@"1",@"2",@"3",@"four",nil];
 // maybe modify the array here...
 NSArray* nonMut = [[myArr copy] autorelease];
 [someObject doWork:nonMut]; 
```

|K<

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-19T15:14:50.030

我认为最适合您的情况的模式是委托。您`LoginController`不必知道它将这些数据发送到哪个类。相反，您将实现一个`LoginControllerDelegate`协议

```
@protocol LoginControllerDelegate <NSObject>

@optional
- (void)loginController:(LoginController *)loginController didReceiveLoginIDs:(NSArray *)ids;

@end 
```

然后，在您的`LoginController`课程中，您将实现`delegate`如下属性：

```
@property (nonatomic, assign) id <LoginControllerDelegate> delegate; 
```

然后，当你实际上有一些东西要与代表交流时，你会这样写：

```
if ([self.delegate respondsToSelector:@selector(loginController:didReceiveLoginIDs:])
    [self.delegate loginController:self didReceiveLoginIDs:[NSArray arrayWithArray:loginIDs]]; 
```

应该接收登录 ID 的对象将包含如下`LoginControllerDelegate`协议：

```
@interface SomeOtherClass : NSObject <LoginControllerDelegate> 
```

您将`loginController:didReceiveIDs:`在`SomeOtherClass`.

这样，您`LoginController`无需深入了解项目中的其他类，只需建立一种机制，在数据可用时将该数据发送到任何对它感兴趣的对象。如果您稍后更改应接收登录 ID 的对象，则只需选择不同的委托。

# silverlight - Silverlight 3 - 我可以在另一个应用程序中运行 Out-of-browser

> ID：661715
> 
> 赞同：7
> 
> 时间：2009-03-19T10:42:04.897
> 
> 标签：silverlight, silverlight-3.0, out-of-browser

新的 Silverlight 3 测试版包括运行浏览器外应用程序的能力。到目前为止的演示只在一个特殊的框架内显示了这一点。有谁知道我如何在（WPF）应用程序中运行 Siverlight 3 控件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-22T21:53:23.923

我猜（是的，真丢脸！）但您可能可以在窗口上放置一个 WPF Web 浏览器并导航到其中的 Silverlight 应用程序。

这是受支持的方案；最近的一篇 MSDN 文章指出，这种情况是受支持的，这样的情况迫使 CLR 团队允许将多个 CLR 加载到单个进程中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T23:23:49.657

不，您不能将浏览器外的 silverlight 嵌入 WPF。sllauncher.exe 独立框架有一个特殊的处理程序，用于为它提供的离线：//（主机名）。（修订）/ url，以允许应用程序具有浏览器外模式的所有功能（如额外的键盘访问） . 除非你能找到一种方法将这个应用程序嵌入到你的应用程序中，否则你将无法脱离浏览器；如果你知道一些方法来做到这一点，这个应用程序的地址是：

C:\Program Files\Microsoft Silverlight\3.0.40307.0\sllauncher.exe

然而，正如其他人所说，您可以在 html 页面中嵌入 silverlight 控件，也可以在 WebBrowser 元素中嵌入silverlight 控件。但是，请谨慎使用此方法，因为目前没有对 Silverlight 的 x64 支持，如果您绝对必须这样做，请确保专门为 x86 编译。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T16:37:03.440

似乎 SLOOB 应用程序在主机进程 (C:\Program Files\Microsoft Silverlight\3.0.40307.0\sllauncher.exe) 内运行。这托管和沙盒应用程序。

我怀疑自己无法托管它 - 抱歉，如果这有点接近猜测，但没有在您的 WPF 应用程序中运行托管 Web 浏览器，我想不出解决沙盒要求的方法。

高温高压

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T13:39:13.000

您可以在 Windows 应用程序中托管浏览器控件，并在浏览器控件中加载 silverlight。这就是实时网格将如何做到的。

# c# - C#：循环编码

> ID：661717
> 
> 赞同：6
> 
> 时间：2009-03-19T10:43:06.157
> 
> 标签：c#, utf-8, character-encoding

我正在阅读各种格式和语言的文件，我目前正在使用一个小型编码库来尝试检测正确的编码（[http://www.codeproject.com/KB/recipes/DetectEncoding.aspx](http://www.codeproject.com/KB/recipes/DetectEncoding.aspx)）。

挺好看的，就是偶尔会漏掉。（多语言文件）

我的大多数潜在用户对编码知之甚少（我最希望的是“它与字符有关”）并且不太可能能够在列表中选择正确的编码，所以我想让他们循环使用不同的编码，直到通过单击按钮找到正确的编码。

显示问题？单击此处尝试不同的编码！（反正就是这个概念）

实现这样的事情的最佳方法是什么？

* * *

编辑：看起来我表达得不够清楚。通过“循环编码”，我的意思不是“如何循环编码？”

我的意思是“如何让用户在不重新加载文件的情况下依次尝试不同的编码？”

这个想法更像是这样：假设文件加载了错误的编码。显示一些奇怪的字符。用户将单击“下一个编码”或“上一个编码”按钮，字符串将被转换为不同的编码。用户只需要继续点击，直到找到正确的编码。（任何对用户来说看起来不错的编码都可以）。只要用户可以点击“下一步”，他就有合理的机会解决他的问题。

到目前为止我发现涉及使用当前编码将字符串转换为字节，然后将字节转换为下一个编码，将这些字节转换为字符，然后将字符转换为字符串......可行，但我想知道是否有这不是更简单的方法。

例如，如果有一个方法可以读取字符串并使用不同的编码返回它，比如“render(string, encoding)”。

* * *

非常感谢您的回答！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-23T13:09:57.463

Read the file as bytes and use then the Encoding.GetString Method.

```
 byte[] data = System.IO.File.ReadAllBytes(path);

        Console.WriteLine(Encoding.UTF8.GetString(data));
        Console.WriteLine(Encoding.UTF7.GetString(data));
        Console.WriteLine(Encoding.ASCII.GetString(data)); 
```

So you have to load the file only one time. You can use every encoding based on the original bytes of the file. The user can select the correct one und you can use the result of Encoding.GetEncoding(...).GetString(data) for further processing.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-23T13:38:18.737

(removed original answer following question update)

> For instance, if there was a method that would read a string and return it using a different encoding, something like "render(string, encoding)".

I don't think you can re-use the string data. The fact is: if the encoding was wrong, this string can be considered corrupt. It may very easily contain gibberish among the likely looking characters. In particular, many encodings may forgive the presence/absence of a BOM/preamble, but would you re-encode with it? without it?

If you are happy to risk it (I wouldn't be), you could just re-encode your local string with the last encoding:

```
// I DON'T RECOMMEND THIS!!!!
byte[] preamble = lastEncoding.GetPreamble(),
    content = lastEncoding.GetBytes(text);
byte[] raw = new byte[preamble.Length + content.Length];
Buffer.BlockCopy(preamble, 0, raw, 0, preamble.Length);
Buffer.BlockCopy(content, 0, raw, preamble.Length, content.Length);
text = nextEncoding.GetString(raw); 
```

In reality, I believe the best you can do is to keep the original `byte[]` - keep offering different renderings (via different encodings) until they like one. Something like:

```
using System;
using System.IO;
using System.Text;
using System.Windows.Forms;
class MyForm : Form {
    [STAThread]
    static void Main() {
        Application.EnableVisualStyles();
        Application.Run(new MyForm());
    }
    ComboBox encodings;
    TextBox view;
    Button load, next;
    byte[] data = null;

    void ShowData() {
        if (data != null && encodings.SelectedIndex >= 0) {
            try {
                Encoding enc = Encoding.GetEncoding(
                    (string)encodings.SelectedValue);
                view.Text = enc.GetString(data);
            } catch (Exception ex) {
                view.Text = ex.ToString();
            }
        }
    }
    public MyForm() {
        load = new Button();
        load.Text = "Open...";
        load.Dock = DockStyle.Bottom;
        Controls.Add(load);

        next = new Button();
        next.Text = "Next...";
        next.Dock = DockStyle.Bottom;
        Controls.Add(next);

        view = new TextBox();
        view.ReadOnly = true;
        view.Dock = DockStyle.Fill;
        view.Multiline = true;
        Controls.Add(view);

        encodings = new ComboBox();
        encodings.Dock = DockStyle.Bottom;
        encodings.DropDownStyle = ComboBoxStyle.DropDown;
        encodings.DataSource = Encoding.GetEncodings();
        encodings.DisplayMember = "DisplayName";
        encodings.ValueMember = "Name";
        Controls.Add(encodings);

        next.Click += delegate { encodings.SelectedIndex++; };

        encodings.SelectedValueChanged += delegate { ShowData(); };

        load.Click += delegate {
            using (OpenFileDialog dlg = new OpenFileDialog()) {
                if (dlg.ShowDialog(this)==DialogResult.OK) {
                    data = File.ReadAllBytes(dlg.FileName);
                    Text = dlg.FileName;
                    ShowData();
                }
            }
        };
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T10:53:12.123

你能让用户输入一些应该出现在文件中的单词（带有“特殊”字符）吗？

您可以自己搜索所有编码以查看这些单词是否存在。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-19T12:24:39.127

Beware of the infamous '[Notepad bug](http://www.wincustomize.com/articles.aspx?aid=117870&c=1)'. It's going to bite you whatever you try, though... You can find some [good discussions](http://blogs.msdn.com/oldnewthing/archive/2007/04/17/2158334.aspx) about encodings and their challenges on MSDN (and other places).

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T12:58:09.257

You have to keep the original data as a byte array or MemoryStream you can then translate to the new encoding, once you already converted your data to a string you can't reliably return to the original representation.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-23T13:14:30.823

How about something like this:

```
public string LoadFile(string path)
{
    stream = GetMemoryStream(path);     
    string output = TryEncoding(Encoding.UTF8);
}

public string TryEncoding(Encoding e)
{
    stream.Seek(0, SeekOrigin.Begin) 
    StreamReader reader = new StreamReader(stream, e);
    return reader.ReadToEnd();
}

private MemoryStream stream = null;

private MemorySteam GetMemoryStream(string path)
{
    byte[] buffer = System.IO.File.ReadAllBytes(path);
    return new MemoryStream(buffer);
} 
```

Use LoadFile on your first try; then use TryEncoding subsequently.

# c# - 如何在 C# 项目中使用 C 代码？包装类？

> ID：661718
> 
> 赞同：3
> 
> 时间：2009-03-19T10:43:06.750
> 
> 标签：c#, c, interop, wrapper

我有一个 C 代码，我想在 C# 中使用它。

除了重写此代码之外，还有可能吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-19T10:45:19.240

将 C 代码构建为 DLL，然后使用“P/Invoke”调用它。您需要了解一些有关互操作的知识，这是一个我不太了解的领域，恐怕 - 但这里有一些链接：

*   [一篇比较老的文章](http://msdn.microsoft.com/en-us/magazine/cc164123.aspx)，不过看起来还不错
*   [BCL 团队博客](http://blogs.msdn.com/bclteam/archive/2008/06/23/p-invoke-interop-assistant-justin-van-patten.aspx)谈论 P/Invoke 互操作助手
*   最近的[MSDN 杂志文章](http://msdn.microsoft.com/en-us/magazine/cc164193.aspx)
*   [MSDN 互操作](http://msdn.microsoft.com/en-us/library/sd10k43k.aspx)指南

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T07:22:29.267

在这里，我有一个很棒的工具[SWIG](http://www.swig.org/)，可以做到这一点。它支持很多不同的语言，包括 C# 和 java。

# xml - 松散类型与严格类型的优缺点是什么

> ID：661721
> 
> 赞同：1
> 
> 时间：2009-03-19T10:44:35.263
> 
> 标签：xml, web-services, xsd, wsdl

在我们公司，我们正在讨论是否允许包含松散类型部分的 xml/xsd 结构（用于 Web 服务），以便更轻松地对其进行更改。

你认为做一个（松散类型）或另一个（严格类型）的利弊是什么？参数可以在类别中，例如易于更改、开发工作量、版本控制等。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-20T06:41:02.930

严格类型化 XML 的优点是你的代码不需要包含一堆形式的东西

1.  如果 A 和 B，并且它们没有包含 C，则错误并终止
2.  如果 B 或 C，并且 E 中的 D 部分与 foobar 不匹配，则出错并终止

等等。您的逻辑所依赖的东西的严格 XML。对于您仅作为数据持有的内容的松散 XML。

缺点是您必须管理 xsds 并对其进行版本控制，但这并没有比其他方式更多的工作，除非您更早地发现问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-21T20:58:20.023

我没有专业人士的松散类型。您只会在开发时间上遇到麻烦，当他们必须编写大量代码来检测实际返回的类型并对其进行验证时，它会增加。

我不认为您在易于更改方面获得了太多收益，因为消费者仍然必须适应新类型，如果他们需要它们或者无论如何他们都会得到它们。

我的建议是遵循 xsd 并改用版本。

我不知道您使用的是什么平台，但是使用 WCF，您可以通过在同一服务的新端点上制定新合同来让您的服务发展。

# c# - 从窗口中提取键盘布局

> ID：661722
> 
> 赞同：11
> 
> 时间：2009-03-19T10:44:40.007
> 
> 标签：c#, winforms, keyboard-layout

好的，这是一个有点奇怪的问题。

我们有一个触摸屏应用程序（即没有键盘）。当用户需要输入文本时，应用程序会显示虚拟键盘 - WinForms 中手动内置。

为每种新语言手工制作这些东西是猴子的工作。我认为 Windows 必须将此键盘布局信息隐藏在某个 dll 中的某个位置。无论如何可以从窗口中获取这些信息吗？

欢迎其他想法（我认为至少从 xml 文件生成东西必须比在 VS 中手动生成要好）。

（注意：说了这么多，我注意到有一个日文键盘、状态机等等……，所以 XML 可能还不够）

**更新**：关于这个主题的很好的系列（我相信）[在这里](http://www.siao2.com/2006/04/22/581107.aspx)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-08T01:17:21.537

[Microsoft Keyboard Layout Creator](http://msdn.microsoft.com/en-us/goglobal/bb964665.aspx)可以加载系统键盘并将它们导出为[.klc 文件](http://www.siao2.com/2006/11/02/928185.aspx)。由于它是用 .NET 编写的，因此您可以使用[Reflector](http://www.reflector.net/)来查看它是如何做到的，并使用反射来驱动它。这是使用以下 C# 代码创建的[Windows 8 中 187 个键盘的 .klc 文件的 zip 文件。](https://bitbucket.org/andrewdotn/stackexchange/downloads/sx-661722.zip)请注意，我最初是为 Windows XP 编写的，现在使用 Windows 8 和屏幕键盘，它真的很慢并且似乎使任务栏崩溃：/ 但是，它确实有效 :)

```
using System;
using System.Collections;
using System.IO;
using System.Reflection;

class KeyboardExtractor {

    static Object InvokeNonPublicStaticMethod(Type t, String name,
            Object[] args)
    {
        return t.GetMethod(name, BindingFlags.Static | BindingFlags.NonPublic)
            .Invoke(null, args);
    }

    static void InvokeNonPublicInstanceMethod(Object o, String name,
            Object[] args)
    {
        o.GetType().GetMethod(name, BindingFlags.Instance |
                BindingFlags.NonPublic) .Invoke(o, args);
    }

    static Object GetNonPublicProperty(Object o, String propertyName) {
        return o.GetType().GetField(propertyName,
                BindingFlags.Instance | BindingFlags.NonPublic)
            .GetValue(o);
    }

    static void SetNonPublicField(Object o, String propertyName, Object v) {
        o.GetType().GetField(propertyName,
                BindingFlags.Instance | BindingFlags.NonPublic)
            .SetValue(o, v);
    }

    [STAThread] public static void Main() {
        System.Console.WriteLine("Keyboard Extractor...");

        KeyboardExtractor ke = new KeyboardExtractor();
        ke.extractAll();

        System.Console.WriteLine("Done.");
    }

    Assembly msklcAssembly;
    Type utilitiesType;
    Type keyboardType;
    String baseDirectory;

    public KeyboardExtractor() {
        msklcAssembly = Assembly.LoadFile("C:\\Program Files\\Microsoft Keyboard Layout Creator 1.4\\MSKLC.exe");
        utilitiesType = msklcAssembly.GetType("Microsoft.Globalization.Tools.KeyboardLayoutCreator.Utilities");
        keyboardType = msklcAssembly.GetType("Microsoft.Globalization.Tools.KeyboardLayoutCreator.Keyboard");

        baseDirectory = Directory.GetCurrentDirectory();
    }

    public void extractAll() {

        DateTime startTime = DateTime.UtcNow;

        SortedList keyboards = (SortedList)InvokeNonPublicStaticMethod(
                utilitiesType, "KeyboardsOnMachine", new Object[] {false});

        DateTime loopStartTime = DateTime.UtcNow;

        int i = 0;
        foreach (DictionaryEntry e in keyboards) {
            i += 1;
            Object k = e.Value;

            String name = (String)GetNonPublicProperty(k, "m_stLayoutName");
            String layoutHexString = ((UInt32)GetNonPublicProperty(k, "m_hkl"))
                .ToString("X");

            TimeSpan elapsed = DateTime.UtcNow - loopStartTime;
            Double ticksRemaining = ((Double)elapsed.Ticks * keyboards.Count)
                        / i - elapsed.Ticks;
            TimeSpan remaining = new TimeSpan((Int64)ticksRemaining);
            String msgTimeRemaining = "";
            if (i > 1) {
                // Trim milliseconds
                remaining = new TimeSpan(remaining.Hours, remaining.Minutes,
                        remaining.Seconds);
                msgTimeRemaining = String.Format(", about {0} remaining",
                        remaining);
            }
            System.Console.WriteLine(
                    "Saving {0} {1}, keyboard {2} of {3}{4}",
                    layoutHexString, name, i, keyboards.Count,
                    msgTimeRemaining);

            SaveKeyboard(name, layoutHexString);

        }

        System.Console.WriteLine("{0} elapsed", DateTime.UtcNow - startTime);

    }

    private void SaveKeyboard(String name, String layoutHexString) {
        Object k = keyboardType.GetConstructors(
                BindingFlags.Instance | BindingFlags.NonPublic)[0]
            .Invoke(new Object[] {
                        new String[] {"", layoutHexString},
                    false});

        SetNonPublicField(k, "m_fSeenOrHeardAboutPropertiesDialog", true);
        SetNonPublicField(k, "m_stKeyboardTextFileName",
                String.Format("{0}\\{1} {2}.klc",
                    baseDirectory, layoutHexString, name));
        InvokeNonPublicInstanceMethod(k, "mnuFileSave_Click",
                new Object[] {new Object(), new EventArgs()});

        ((IDisposable)k).Dispose();
    }

} 
```

基本上，它获取系统上所有键盘的列表，然后对于每个键盘，将其加载到 MSKLC 中，设置“另存为”文件名，确定是否已经配置了自定义键盘属性，然后模拟单击文件 -> 保存菜单项。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-19T13:48:47.710

为什么不使用屏幕键盘（osk.exe）？看起来你重新发明了轮子。而且不是最简单的！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-06-06T14:03:41.673

我知道这些 DLL 文件的路径在哪里：

在您的注册表中，您会看到：

```
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Keyboard Layouts 
```

其中每个分支都有一些价值，例如`"Layout File"="KBDSP.dll"`. 根目录是

```
C:\Windows\System32 
```

和

```
C:\Windows\SystemWOW64 
```

这些是所有键盘布局文件所在的位置。例如，`KBDUS.dll`表示“美国键盘”。

我试图用MSKLC制作的自定义DLL替换DLL文件，我发现它会在“语言”-“输入法”-“预览”中自动加载布局映射图像：

[![在此处输入图像描述](https://i.stack.imgur.com/PN4DC.png)](https://i.stack.imgur.com/PN4DC.png)

所以我们知道映射存在于 DLL 中。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-04-29T02:21:42.090

众所周知，MSKLC 无法忠实地导入和重现 Windows 提供的所有 .DLL 文件的键盘布局，尤其是 Windows 8 及更高版本中的那些。如果您无法从中提取任何有意义或有用的信息，那么知道这些文件在哪里也没有任何好处。Michael Kaplan 在他的博客（他是 MSKLC 的开发人员）上记录了这一点，我看到你已经链接到上面。

当 MSKLC 遇到任何它不理解的内容时，该部分将被删除。使用 MSKLC 提取布局适用于大多数键盘，但也有少数——即 Cherokee 键盘和日韩键盘（仅举几例，我不确定还有多少）——提取的布局不会准确或完全反映键盘的实际使用和功能。Cherokee 键盘具有 MSKLC 不支持的链接死键。远东键盘具有 MSKLC 不知道的修饰键——这意味着缺少整个层/移位状态！

Michael Kaplan 提供了一些代码并解开了 MSLKC 的一些秘密以及可用于绕过其中一些限制的随附软件，但它需要大量的手工操作——这正是您要避免的！此外，Michael 的目标是创建具有 MSKLC 无法创建或理解的功能的键盘，但这些功能可以在 Windows 中工作（这与 OP 试图完成的功能相反）。

我确信我的解决方案来得太晚，无法用于 OP，但也许它在未来对处于类似情况的人会有所帮助。这就是我发布这个的希望和原因。

到目前为止，我所做的只是解释其他答案是不够的。即使是最好的键盘也不会也不可能完全准确地再现所有 Windows 的本机键盘并将它们呈现为 KLC 源文件。这真的很不幸，这当然不是作者的错，因为那是一段非常聪明的代码/脚本！值得庆幸的是，脚本和源文件（其链接可能有效也可能无效）对于大多数 Windows 键盘以及 MSKLC 创建的任何自定义键盘都是有用且有效的。

具有 MSKLC 不支持的高级功能的键盘是由 Windows DDK 创建的，但这些功能没有正式记录。虽然人们可以通过研究 MSKLC 提供的源文件来了解它们的潜力。

[遗憾的是，我能提供的唯一解决方案是名为KbdEdit](http://kbdedit.com/)的第 3 方付费软件。我相信它是目前唯一真正能够忠实地解码和重新创建任何 Windows 提供的键盘的可用解决方案——尽管有一些高级功能甚至无法重现（例如执行特殊母语的组合键/热键）功能；例如：Ctrl+CapsLock 激活 KanaLock（日本修改器层）。KbdEdit 确实忠实地再现了 MSKLC 剥离的修改器层，如果您不支持，它只是不支持激活该转换状态的这种替代方法有一个带有假名锁定键的日文键盘。虽然，它允许您将键盘上的键转换为假名键（也许是 Scroll Lock？）。

幸运的是，这些不受支持的功能甚至都不适用于屏幕键盘。

KbdEdit 是一个非常强大且令人惊叹的工具，我为此付出的每一分钱都物有所值！（对于几乎任何其他付费软件，我不会这么说……）尽管 KbdEdit 是第 3 方软件，但它只需要创建键盘，而不是使用它们。它创建的所有键盘都可以在没有安装 KbdEdit 的任何 Windows 系统上本地工作。它支持多达 15 种修饰状态和三个附加修饰键，其中一个是可切换的，类似于 CapsLock。它还支持链接死键，并重新映射大多数键盘上的任何键。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-19T10:48:27.487

请检查以下 Windows API

```
 [DllImport("user32.dll")]
 private static extern long LoadKeyboardLayout(string pwszKLID, uint Flags); 
```

在此处查看[MSDN](http://msdn.microsoft.com/en-us/library/ms646305(VS.85).aspx)

# c# - 为什么 .net 的 MailMessage 类的 To 属性是只读的？

> ID：661724
> 
> 赞同：11
> 
> 时间：2009-03-19T10:46:30.783
> 
> 标签：c#, email

我有一个 MailAddressCollection ，其中包含我想向其发送电子邮件的所有地址，但不能简单地拥有：

```
myMessage.To = myMailAddressCollection; 
```

我要做：

```
foreach (MailAddress address in myMailAddressCollection)  
{  
    myMessage.To.Add(address);  
} 
```

任何人都可以解释为什么类是这样配置的吗？我是否错过了能够分配给 To、CC 或 Bcc 属性的其他方式？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-19T11:34:27.547

MailMessage 类想要保护它的属性，这是正确的封装。

如果它支持 AddRange 方法，您的任务会更容易一些，但就目前而言，您的代码将尽可能简单。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-06-19T14:00:36.037

我知道这是旧的，但以防其他人偶然发现它：

MailAddressCollection.Add 可以接受以逗号分隔的电子邮件地址字符串。MailAddressCollection.ToString 方法返回包含的电子邮件地址的逗号分隔字符串。

所以OP可以做到这一点：

```
myMessage.To.Add(myMailAddressCollection.ToString()); 
```

AddRange 方法仍然是首选。

# javascript - 如何获取单元格的位置

> ID：661726
> 
> 赞同：2
> 
> 时间：2009-03-19T10:46:52.637
> 
> 标签：javascript, jquery

我正在编写一个管理一个非常大的表的脚本。当用户单击表格单元格时，我想知道他们单击了哪个单元格。例如

```
--------------
|     |      |
|     | Click|
-------------- 
```

应该给我一个 (1, 1) 的单元格引用。

任何方式我都可以用javascript做到这一点。它运行的页面将 jquery 用于其他目的，因此任何基于 jquery 的解决方案也很好。

编辑：为了澄清，左上角的单元格是 (0, 0)。出于性能原因，事件需要绑定到*表*，而不是 tds。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-19T10:53:48.613

`target`使用对象的属性很容易做到这一点`event`：

```
$('#mytable').click(function(e) {
    var tr = $(e.target).parent('tr');
    var x = $('tr', this).index(tr);
    var y = tr.children('td').index($(e.target));
    alert(x + ',' + y);
}); 
```

这种方法只允许您将 1 个事件处理程序绑定到整个表格，然后确定单击了哪个表格单元格。这称为事件委托，在适当的情况下效率更高，这符合要求。使用它可以避免将事件绑定到 each `<td>`，并且它不需要硬编码坐标。因此，如果您的表格如下所示：

```
<table id='mytable'>
    <tr>
      <td>hi</td>
      <td>heya</td>
    </tr>
    <tr>
      <td>boo</td>
      <td>weee</td>
    </tr>
</table> 
```

它会在点击时提醒坐标。你可以用它做任何事情。:)

如果您发现性能太慢（取决于您的表有多大），那么您将不得不诉诸硬编码或两者的组合，也许只对`<tr>`索引进行硬编码，因为这将是最慢的，并且然后`<td>`动态获取索引。最后，如果所有这些坐标业务完全没有必要，而您真正想要的是对 clicked 的引用`<td>`，那么您只需这样做：

```
$('#mytable').click(function(e) {
    var td = $(e.target);
    // go crazy
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-19T10:56:37.247

```
$('td').click(function(event) {
  var row = $(this).parent('tr');
  var horizontal = $(this).siblings().andSelf().index(this);
  var vertical = row.siblings().andSelf().index(row);
  alert(horizontal+','+vertical);
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T10:53:09.270

## 遍历 DOM 层次结构...

您应该能够通过获取对单击的 TD 的 DOM 节点的引用来执行此操作，然后向后走[previousSibling](https://developer.mozilla.org/En/DOM/Node.previousSibling)链直到到达第一列，边走边计算。

如果您处于该兄弟链的开头（即行中的第一个 TD），则[parentNode](https://developer.mozilla.org/En/DOM/Node.parentNode)应该是 TR 节点，并且您可以执行类似的遍历[previousSibling](https://developer.mozilla.org/En/DOM/Node.previousSibling) TR 以计算行数。

## ..或用附加属性标记每个单元格

或者，当您创建表时，添加一些假的*rowidx="??"* 和*colidx="??"* [每个单元格的属性并使用getAttribute](https://developer.mozilla.org/en/DOM/element.getAttribute)检索这些属性。如果你想使用一个合法的属性，你可以把行和列索引放在一个[轴=“？？，？？”](http://www.w3.org/TR/html401/struct/tables.html#h-11.2.6) 属性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-19T11:08:28.170

您提到了一个非常大的表 - 将点击绑定到每个 td 是不明智的。更好的方法是使用 .live 方法，如果您仍在使用 jquery 1.2.6，您可以将点击事件绑定到表并使用事件委托。如果您需要此问题的代码。

```
$("#tableId td").live('click', function () {
     var $this = $(this);
     var x = $this.prevAll().length;
     var y = $this.parent().prevAll.length;
     console.log(x + ", " + y);
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-19T11:55:08.777

假设你的第一行第一列是 0,0

```
var row = 0;
    $('#tblImages > tbody > tr').each( function(){
               var col = 0;

               $(this).children('td').each( function(){

                   $(this).attr("currentRow", row).attr("currentCol", col);
                   col++;
               });
               row++;
        }
        );
    $('#tblImages > tbody > tr > td').click(function(){
        alert( $(this).attr("currentRow") + "   " + $(this).attr("currentCol")); 
```

这当然可以改进更多..但它的工作

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-11-02T15:08:30.570

```
window.onload = function () {
  document.getElementsByTagName('table')[0].addEventListener('click', function(element) {
    var rowIndex = element.target.parentElement.rowIndex;
    var cellIndex = element.target.cellIndex;

    document.getElementById('alert').innerHTML = ('Row index = ' + rowIndex + ', Column index = ' + cellIndex);
 }, false);
}
```

```
tr, th, td {
  padding: 0.6rem;
  border: 1px solid black
}

table:hover {
  cursor: pointer;
}
```

```
<table>
    <tbody>
        <tr>
            <td>1</td>
            <td>2</td>
            <td>3</td>
        </tr>

        <tr>
            <td>4</td>
            <td>5</td>
            <td>6</td>
        </tr>
    </tbody>
</table>
<p id="alert"></p>
```

# deployment - Web 应用程序开发流程 - 版本控制、错误跟踪、单元测试、部署

> ID：661731
> 
> 赞同：5
> 
> 时间：2009-03-19T10:47:53.587
> 
> 标签：deployment, web-applications, process, bug-tracking

描述你用来开发 Web 应用程序的过程，重点是 VC、错误跟踪、QA、单元测试、部署和其他类似的东西（减去计划/​​客户沟通方面的事情）。

我是这个领域的新手，所以我的粗略例子（阅读：没有使用过这个过程）无疑有点过时了，可以这么说 - 指出它的缺陷，以便我可以学习。

例如。

1.  在本地 SVN 服务器上创建项目存储库。
2.  为 DNS 映射创建批处理/shell 脚本。
3.  签出项目，开始处理本地工作副本。
4.  将功能开发为分支。
5.  使用 Mantis 跟踪错误（通过其 SVN 集成链接提交错误（不知道是否存在））。
6.  随手记录。
7.  在分支上进行质量检查。
8.  稳定时合并到主干。
9.  单元测试？
10.  当功能实现且稳定时提交到存储库。
11.  将发布复制到存储库中的标签。例如。/项目/标签/rel-123/
12.  使用 Phing 上传到登台服务器。（有人可以澄清一下登台服务器在“测试”之外的用途吗？）
13.  使用 Phing 准备实时站点以进行更新、设置数据库/部署等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-20T04:32:03.227

1.  创建/签出 HEAD 版本（“主分支”）
2.  至少每天开发代码并与主分支同步
3.  开发完成后，编写并运行单元测试
4.  通过代码审查并将代码/更改提交到主分支
5.  让持续构建器在主分支上运行所有单元测试和系统/集成测试
6.  准备就绪后，挑选修订版并将它们集成到 QA 分支
7.  运行系统和集成测试，修复报告的错误，或根据需要回滚；这重复步骤 4-7
8.  在 QA 签核后，将 QA 更改集成到发布分支
9.  在发布分支上运行单元测试、系统/集成测试
10.  部署到生产环境并运行健全性测试。

登台服务器是您的生产环境的副本，它尽可能是最新的。在我当前的项目中，我们能够使每个版本彼此独立，因此我们的“登台服务器”是我们的生产服务器，只是从不同的 url 访问。

注释和差异：

根据项目的大小，所有步骤都有一些变化。你的项目越大，樱桃采摘和环境分离的好处就越大。在较小的项目中，这些可能只是时间汇，并且经常被忽略或绕过。

澄清一下，有一个开发堆栈、QA 堆栈和暂存堆栈。根据您的项目规模，QA 可能是临时的，生产可能是临时的，或者它们的某种组合。Dev 和 QA 堆栈的分离是最重要的一个。

在上述步骤中，我假设代码和相关数据都被版本化或跟踪。拥有一个将控制数据考虑在内的发布和构建过程使发布变得非常非常容易。

在中小型项目中，可能有也可能没有发布分支；这取决于代码更改的频率。此外，根据代码更改的频率和项目的大小，您可以将完整的 QA 分支集成到发布分支，或者挑选特定的修订版以集成到发布分支。

FWIW，我发现“迁移脚本”没有什么价值。它们总是一次性的脚本，几乎没有重复使用，并且让回滚变得很痛苦。我认为更好的是，让应用程序向后兼容要容易得多。在几个版本之后（当回滚是可笑的时候），如有必要，应该进行数据清理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T11:12:57.630

非常粗略：

1.  在 SVN 中创建存储库
2.  将本地工作副本检查到开发人员环境
3.  经常更新/提交更改
4.  使用自定义部署脚本从 SVN 主干部署到阶段
5.  舞台上的 QA 测试，报告 Mantis 中的错误
6.  开发人员修复错误，标记为已解决
7.  重新部署到阶段
8.  QA 测试错误，如果修复则关闭
9.  QA 完成，做回归测试
10.  使用自定义部署脚本部署到生产环境
11.  跳一段小舞

我们还为未来的版本或功能创建分支。这些最终被合并到主干中。

我们使我们的数据库结构与在部署期间执行的自定义数据库比较工具保持同步。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-02-28T15:34:29.703

老帖子，但有趣的问题！

现在在我公司：

1.  创建一个新的 Github 存储库
2.  配置詹金斯
3.  本地克隆
4.  开始一个分支
5.  开发和添加测试（服务器、客户端和 e2e）
6.  提交每一步，并 fetch + rebase 以保持分支同步
7.  准备好后，将分支推送到服务器：预提交检查 lint 和测试，如果不正常则阻塞
8.  为分支创建拉取请求
9.  在这里，jenkins 自动在分支上运行测试，并直接在拉取请求中将其标记为“绿色”或“损坏的测试”
10.  让最后 2 位同事审查拉取请求并修复他们的发现（返回第 5 步）
11.  当一切都绿色和 2 位同事都同意后，最后一位合并拉取请求
12.  删除服务器上的分支
13.  准备好后，推送新版本
14.  最新版本立即部署在测试平台上
15.  QA 验证引入的更正和功能（如果有问题返回 5）
16.  （TODO）部署到具有与生产相同参数的预生产
17.  部署到生产
18.  为引入的错误向用户道歉；）并在问题管理器中报告它们
19.  获取功能请求并在问题管理器中报告它们
20.  在第 2 步重新启动循环

# java - Java并发递归网站下载

> ID：661736
> 
> 赞同：0
> 
> 时间：2009-03-19T10:48:31.060
> 
> 标签：java, concurrency

我需要做一个程序来下载网页，也就是说，我给软件一个网页，它会下载网站上的所有文件。

我还会通过一个深度级别，即软件下载网站每个文件的级别。

我将用 Java 开发这个软件，我也需要使用并发。

请告诉我您对如何执行此操作的意见。

谢谢您的帮助。

* * *

感谢大家的帮助。

我还需要问一件事。如何从网站下载文件？

多谢一次。=D

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T11:59:56.393

一个非常有用的蜘蛛和机器人库：[htmlunit](http://htmlunit.sourceforge.net/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T10:57:20.367

好吧，如果不知道您需要多么详细的指导，这有点难以回答，但这里有一个概述。:)

实际上，Java 使此类应用程序变得非常容易，因为 HTTP 请求和线程都是现成的。我的解决方案可能会涉及一个包含新 url 的全局堆栈，以及从堆栈中弹出 url 的恒定数量的线程场。我会将网址存储为自定义对象，以便跟踪深度。

我认为您的主要问题是网站不响应或不遵循 HTTP 标准。我在类似的应用程序中多次注意到，有时这些应用程序不会正确超时，最终它们最终会阻塞所有线程。不幸的是，我在这里没有任何好的解决方案。

一些有用的类作为起点： http:
[//java.sun.com/javase/6/docs/api/java/lang/Thread.html](http://java.sun.com/javase/6/docs/api/java/lang/Thread.html)
[http://java.sun.com/javase/6/docs/ api/java/lang/ThreadGroup.html](http://java.sun.com/javase/6/docs/api/java/lang/ThreadGroup.html)
[http://java.sun.com/javase/6/docs/api/java/net/URL.html](http://java.sun.com/javase/6/docs/api/java/net/URL.html)
[http://java.sun.com/javase/6/docs/ api/java/net/HttpURLConnection.html](http://java.sun.com/javase/6/docs/api/java/net/HttpURLConnection.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T10:59:59.907

我会看看这个资源：

[http://hc.apache.org/httpclient-3.x/](http://hc.apache.org/httpclient-3.x/)

[http://java.sun.com/javase/6/docs/api/java/util/concurrent/package-summary.html](http://java.sun.com/javase/6/docs/api/java/util/concurrent/package-summary.html)

[http://java.sun.com/javase/6/docs/api/java/util/concurrent/locks/package-summary.html](http://java.sun.com/javase/6/docs/api/java/util/concurrent/locks/package-summary.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-19T11:33:41.887

我会看看[Java Executors](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/Executors.html)包。您创建一组任务（[Runnable](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Runnable.html)）并将它们传递给合适的选择执行器。你得到一个[Future](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/Future.html)返回，然后你可以查询它的结果。

Executor 将在执行此 Runnable 时进行协调。存在单线程执行器、具有线程池的执行器等的实现。所以你不需要担心（太多）wrt。线程的复杂性。并发实用程序将为您处理此问题。

[Apache HTTP 客户端](http://hc.apache.org/httpclient-3.x/)将为您处理 HTTP 查询。

# ms-access - MS Access 对组的总和，但不是对细节的总和

> ID：661745
> 
> 赞同：2
> 
> 时间：2009-03-19T10:52:28.787
> 
> 标签：ms-access, report

我正在尝试通过以下方式在 MS Access 报告中计算 SUM：

*   Group1header - 标签

    *   Group2header - 值
        *   细节 - 示例
        *   细节 - 示例
    *   Group2header - 值
        *   细节 - 示例
*   Group1footer [Group2header 值的总和]

不知何故，当出现更多详细信息行时，group1footer 中的总和计算不正确（为每个详细信息添加值）。

我无法计算查询中的总和，因为“值”已经是在查询中计算出来的（子查询会返回很多行）：

```
(
    (
        (sl_ticketdetail.weight,0) * sl_ticketdetail.amount 
        - (
            SELECT SUM(sl_invoicedetail.amount)
            FROM sl_invoicedetail 
            WHERE ticketdetailid = sl_ticketdetail.ticketdetailid
        )
        / 1000
    )
    * sl_ticketdetail.cost
)
/ 1000 
```

知道可能出了什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-20T19:05:54.887

你是说你得到这样的结果：

```
Group 1a
    Group 2a
        Foo1         1
        Foo2         1
        foo3         2
    Group 2a Sum   4
    Group 2b
        Foo1         3
        Foo2         3
    Group 2a Sum   6
Group 1a Sum    10
Group 1b
    Group 2a
        Foo1         4
        Foo2         1
        foo3         2
    Group 2a Sum   7
    Group 2b
        Foo1         4
        Foo2         3
    Group 2a Sum   14
Group 1b Sum    21 
```

这是我所期望的行为。我可以通过`=Sum([value])`在每个组页脚（甚至在报告页脚）中放置一个未绑定的字段来做到这一点。

我知道“为我工作”不是很有帮助。

您是否使用与数据源相同的名称标记了详细信息的值字段（或汇总字段）？如果您的字段与其绑定的数据源具有相同的名称，MS Access 有时会出现奇怪的行为（我倾向于稍微重命名它们，所以我确定我在代码中指的是什么）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T19:23:45.797

由于您已经在查询中预先计算了 Group2 总和，因此它们将针对每行结果重复，因此不能用于（如您发现的那样）计算 Group 1 总和。

你有两个解决方案

1）在您的查询中预先计算 Group1 总计，并简单地报告它们，因为您执行 Group2 总计

2) 使用 Group2 页脚格式/打印事件中的代码来捕获值并手动增加正在运行的 Group1 总数

我会说 1) 是最简单的 - 2) 有点毛茸茸，如果用户来回翻页，有时会导致总数不准确

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T15:23:55.873

您必须拥有主报表的记录源才能包含第 2 组的总计。然后您将需要一个具有不同记录源的子报表，该记录源位于详细级别。

我认为您最好的选择是在查询中省略总计，而让报告对详细信息进行总计。稍后，用户可能想要同一日期的总计但不同的分组（是的，您可以创建另一个记录源）。这也应该解决用户是否在分组以外的字段上对报告应用过滤器（您可能已经或可能没有给他们这个选项。）。

# javascript - 在表单提交上禁用提交按钮的问题

> ID：661752
> 
> 赞同：3
> 
> 时间：2009-03-19T10:54:39.220
> 
> 标签：javascript, jquery, html, forms, javascript-events

问候

我在提交插件上使用 jquery 禁用，但我有一个问题。如果我禁用提交按钮，它们不会被传递回服务器，所以我无法判断按下了哪个按钮。这是正常的吗？我能做些什么吗？

我真的不想改造我的网站，所以我必须在表单提交时设置一个变量来判断按下了哪个按钮。

有任何想法吗 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-19T12:17:02.280

[如何禁用 Web 表单的提交按钮](http://blog.josh420.com/archives/2008/02/how-to-disable-the-submit-button-ofweb-form.aspx)

此方法隐藏按钮而不是禁用它，并以编程方式插入禁用的 <button> 标记，使其*看起来*就像提交按钮被禁用一样。效果很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T11:54:31.867

您可以通过 jquery 进行提交，然后禁用该按钮：

```
<input type="submit" value="do it!" onclick="$('#mainform').submit(); $(this).attr('disabled','disabled' ); $('#pleasewait').show();" /> 
```

编辑：我忘记了 form.submit() 不是异步的。您可以改为执行 ajax 请求：

```
$.ajax({
url: "someurl",
type:"POST",
cache: false,
dataType: "json",
success:gotIt,
async:true,
timeout:240000,
error:ajaxError,
data:$("#mainform").serialize()
}); 
```

或者您可以 .hide() 按钮，或者在单击它​​后设置一个非功能性的 onClick() 处理程序并将其样式设置为禁用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T08:19:30.913

这是我刚刚在[jQuery 论坛](http://groups.google.com/group/jquery-en/browse_thread/thread/428f1d3c5f459506?pli=1)中找到的解决方法：

```
<script type="text/javascript">
    $(document).ready(function() {
        $("#sendSearch").click(function() {
            $('#loadingDiv').show();
            $('#sendSearch').attr("disabled", "disabled");

            // these two lines are the workaround
            this.form.submit();
            return true;
        });
    });
</script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-04-13T14:13:58.643

更简单:)

```
var formid="#id-form-if-exists"; //Put here the id if exists
$("form"+formid).submit(function(){$("form"+formid+" input").attr("disabled",false);}); 
```

是的

# production-environment - 如何将文件从 svn 文件夹移动到生产服务器

> ID：661753
> 
> 赞同：5
> 
> 时间：2009-03-19T10:55:30.823
> 
> 标签：production-environment

我有一个在源代码控制 (SVN) 下用 PHP 编写的网站。我想立即将所有文件从网站目录移动到生产服务器。

问题是在这个文件夹中有SVN（.svn）的文件夹。第二个问题是我不想只将文件放在源代码控制下的服务器上，还要放在这个文件夹中的其他文件（图像、css 等）。

你能告诉我怎么做吗？如果它是可重复的，那就太好了——这样我就只有一个命令可以执行。

如果有可能优化上传（不上传未更改的文件）以使整个生产过程更快，那也很好。

编辑：

我的开发环境是 Eclipse PDT 和最喜欢的 FTP filezilla。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-19T11:00:15.790

您可以使用 subversion 的导出功能，这将允许您导出所有受版本控制的文件，也可以导出所有不受控制的文件。这两种方法都将跳过 .svn 文件夹。

您没有提及您的客户，但 Tortoise 有“也导出未版本控制的文件”选项。

有关命令行语法，请参见[此处](http://svnbook.red-bean.com/en/1.0/re10.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T10:59:29.567

如果支持过滤器（排除 .svn 文件夹，即 FlashFXP），您可以使用 ftp 客户端。

目前我正在使用 Nusphere PhpEd IDE 的内置功能，称为“智能上传”，因此它只更新更改的文件（修改时间更改）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T11:10:30.040

我使用[rsync](http://samba.org/rsync/)这是一个快速命令行工具，它只发送文件的更改部分。您可以将其设置为排除 .svn 目录，如下[所述](http://blog.gungfu.de/archives/2005/09/25/using-rsync-together-with-subversion/)：

如果您希望继续使用 fileZilla 执行此操作，您可以转到 View->Filename Filters 并选择忽略 SVN 和 CVS 目录。您也只能使用 FileZilla 上传更改的文件，但我发现 rsync 快得多。由于 rsync 是基于命令行的，您可以轻松地将其与 Eclipse 作为外部工具连接起来，以实现一键传输

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-05-09T03:24:52.500

您可以使用 springloops，它们涵盖 SVN 提交和签出，但最重要的是只需单击鼠标即可部署到 FTP 服务器...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-02T23:42:08.600

我最近在运行 Ubuntu 9 时遇到了同样的问题。在 FileZilla 中，您可以选择忽略过滤器，其中甚至包含预设，以防止复制 .svn 文件夹和 windows .thumb 文件！您可以在“**文件名过滤器”下的“****查看”**菜单中找到它...... 就像一个魅力！

 **为 FileZilla 的人们点赞！

# c++ - C++ 转换器脚本

> ID：661760
> 
> 赞同：1
> 
> 时间：2009-03-19T10:56:39.697
> 
> 标签：c++

我想看看是否有任何预先存在的项目可以做到这一点。

通常，我需要一些可以加载到 c++ 文件中并对其进行解析的内容，然后根据脚本中的一组规则对其进行转换，例如添加标题、重新格式化或删除编码怪癖，例如将函数中的 const int 参数转换为int 参数等或者可能会根据输入的 c++ 文件生成某种 dom 的东西，可以再次对其进行操作和写出。

那里有免费或商业的此类项目/产品吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-07T03:01:35.863

来自 Eclipse CDT 的 Parser 现在似乎已经很完整了，因为一些重构方法已经为 CDT 做出了贡献。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T11:02:34.503

[Mozilla 的Taras Glek](http://blog.mozilla.com/tglek/)一直致力于[dehydra 工具](https://developer.mozilla.org/en/Dehydra)，它基于[Elkhound](http://www.eecs.berkeley.edu/~smcpeak/elkhound/)并使用 JavaScript 编写脚本来转换 Mozilla 代码库以适应 XPCOM 和垃圾收集器的变化。

# iphone - 如何在 iPhone 中获取已配置的电子邮件

> ID：661763
> 
> 赞同：0
> 
> 时间：2009-03-19T10:57:56.683
> 
> 标签：iphone, cocoa-touch

我需要使用 Cocoa touch 获取在 iPhone 中配置的用户电子邮件。我怎样才能做到这一点 。

谢谢你的回答。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T15:35:40.000

此代码将获取地址簿中的所有联系人并输出与他们关联的电子邮件地址：

```
// get a list of all contacts in the address book db
ABAddressBookRef ab = ABAddressBookCreate();
CFArrayRef contacts = ABAddressBookCopyArrayOfAllPeople(ab);
CFIndex nPeople = ABAddressBookGetPersonCount(ab);

for( int i = 0; i < nPeople; ++i ) {
    ABRecordRef ref = CFArrayGetValueAtIndex(contacts,i);

    // output the contact's name
    CFStringRef firstName = ABRecordCopyValue(ref, kABPersonFirstNameProperty);
    CFStringRef lastName = ABRecordCopyValue(ref, kABPersonLastNameProperty);
    NSString *contactFirstLast = [NSString stringWithFormat:@"%@,%@:",
                                    firstName, lastName];
    NSLog(@"%@", contactFirstLast);

    // output all email addresses stored for the contact
    ABMultiValueRef emailRef = ABRecordCopyValue(ref, kABPersonEmailProperty);
    CFIndex nEmails = ABMultiValueGetCount(emailRef);
    CFArrayRef emails = ABMultiValueCopyArrayOfAllValues(emailRef);
    for( int j = 0; j < nEmails; ++j ) {
        CFStringRef email = CFArrayGetValueAtIndex(emails, j);
        NSLog(@"\t%@", email);
    };

    // clean up
    CFRelease(emailRef);
    CFRelease(firstName);
    CFRelease(lastName);
}

CFRelease(contacts); 
```

# .net - 我可以使用 dotNetOpenId 请求 MyOpenId 角色的头像吗？

> ID：661776
> 
> 赞同：1
> 
> 时间：2009-03-19T11:01:34.757
> 
> 标签：.net, dotnetopenauth, avatar

我的一些 MyOpenId 角色有头像。有什么方法可以使用 dotNetOpenId 以编程方式*请求*它们，比如我可以请求电子邮件等？

我假设它无法完成，因为我猜它们不是标准 openid 模式的一部分？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-21T18:51:31.263

有一种方法可以使用 AX 扩展来检索头像。具体属性可能是其中之一，您可以查看[http://www.axschema.org/types/](http://www.axschema.org/types/)

*   [http://axschema.org/media/image/default](http://axschema.org/media/image/default)
*   [http://axschema.org/media/image/favicon](http://axschema.org/media/image/favicon)

但是，我只是对 myopenid.com 进行了尝试（使用其专有的 AX 属性格式[http://schema.openid.net/media/image/default](http://schema.openid.net/media/image/default)），但它似乎不起作用，所以我的猜测是 myopenid.com不支持它。

# silverlight - 为什么 Silverlight 不支持编译的正则表达式？

> ID：661778
> 
> 赞同：3
> 
> 时间：2009-03-19T11:01:59.683
> 
> 标签：silverlight, silverlight-3.0

[Silverlight 2](http://msdn.microsoft.com/en-us/library/hs600312(VS.95).aspx)和[Silverlight 3 Beta](http://msdn.microsoft.com/en-us/library/hs600312(VS.96).aspx)框架不支持*编译*的正则表达式，即：

```
RegexOptions.Compiled 
```

如果可能的话，我很想听听为什么会这样的原因。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-18T22:55:24.593

由于 silverlight 是跨平台的，因此无法保证应用程序能够在执行机器上创建单独的程序集，无论是权限还是功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T22:36:49.663

我刚刚浏览了新的 Silverlight 3.0 帮助文件，它们仍然有相同的信息：

> Silverlight 的 .NET Framework 中正则表达式引擎的实现与 .NET Framework 中的实现相同。唯一的例外是用于 Silverlight 的 .NET Framework**不支持已编译的正则表达式**，它们是存储在独立程序集中的预定义正则表达式模式以及使用这些正则表达式模式处理文本的专用正则表达式引擎。

我想他们可能忘记更新帮助文件了，但我没有在博客中听到任何其他建议。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-20T01:37:28.510

我想这归结为 Silverlight 中许多设计决策的相同原因 - 它是一个框架功能，无法通过成本/收益分析；拥有该功能的好处是否值得增加核心下载的大小。

# batch-file - 在 Windows Server 上备份事件日志的简单方法

> ID：661782
> 
> 赞同：8
> 
> 时间：2009-03-19T11:02:33.023
> 
> 标签：batch-file, backup, event-log

是否可以创建一种简单的方法来备份事件日志，例如批处理文件或简单的应用程序？我需要让它在客户的网站上工作，其中的参考是非专家用户。谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-19T11:32:06.570

如果您使用的是 Windows 2008，请使用内置的 wevtutil 命令。例子：

wevtutil epl 应用程序 c:\temp\foo.evtx

否则，请从资源工具包中获取 dumpel.exe，或从[http://technet.microsoft.com/en-us/sysinternals/bb897544.aspx获取 psloglist](http://technet.microsoft.com/en-us/sysinternals/bb897544.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-10-13T10:27:17.097

使用 powershell`export-clixml`及其 oneliner。

```
 get-eventlog -list | %{ get-eventlog $_.Log | export-clixml -path ($_.Log + ".xml") } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T10:06:51.530

Microsoft 脚本中心有一些使用 VBScript 和 WMI[备份和清除事件日志](http://www.microsoft.com/technet/scriptcenter/guide/sas_log_pcna.mspx?mfr=true)的示例代码。

Frank-Peter Schultze 的脚本站点有一些代码可以清除事件日志 ( [http://www.fpschultze.de/uploads/clrevt.vbs.txt](http://www.fpschultze.de/uploads/clrevt.vbs.txt) )，您可以将其修改为备份或备份然后清除。

如果您有权访问服务器，则可以通过右键单击日志并使用“将日志文件另存为...”命令从事件查看器进行备份。您可以保存到二进制、制表符分隔或逗号分隔的文件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T14:32:27.203

最后我用网上找到的这个方法做了一个小winapp：

```
public void DoBackup(string sLogName)
{
    string sBackup = sLogName;  // could be for example "Application"
    EventLog log = new EventLog();
    log.Source = sBackup;

    var query = from EventLogEntry entry in log.Entries
                orderby entry.TimeGenerated descending
                select entry;

    string sBackupName = sBackup+"Log";
    var xml = new XDocument(
        new XElement(sBackupName,
            from EventLogEntry entry in log.Entries
            orderby entry.TimeGenerated descending
            select new XElement("Log",
              new XElement("Message", entry.Message),
              new XElement("TimeGenerated", entry.TimeGenerated),
              new XElement("Source", entry.Source),
              new XElement("EntryType", entry.EntryType.ToString())
            )
          )
        );

    DateTime oggi = DateTime.Now;
    string sToday = DateTime.Now.ToString("yyyyMMdd_hhmmss");
    string path = String.Format("{0}_{1}.xml", sBackupName, sToday);
    xml.Save(Path.Combine(Environment.CurrentDirectory, path));
} 
```

这是源[链接](http://www.linqitalia.com/script/65/Accedere-Registry-File-ASP-3.aspx)：

它简直**太棒了**！

# c++ - 如何在 C 中实现用户模式计时器？

> ID：661784
> 
> 赞同：2
> 
> 时间：2009-03-19T11:02:36.063
> 
> 标签：c++, c, timer

我们如何在不使用库函数的情况下在 Windows 中实现自己的计时器函数？我们应该处理汇编语言指令吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-19T11:06:55.210

这取决于您需要的精度和分辨率。

假设您需要超过秒精度，包装/使用`[RDTSC](http://en.wikipedia.org/wiki/Time_Stamp_Counter)`指令很流行。但是你也可以只使用 Win32 API，它`[QueryPerformanceCounter()](http://msdn.microsoft.com/en-us/library/ms644904.aspx)`被广泛用于此。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T13:22:23.280

从互联网时间服务获取原子钟时间。

否则，您将始终处理可以与 BIOS 对话的某种库函数，这是使 Quartz 的滴答声对操作系统可见的部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T11:17:14.063

许多 API，如英特尔的线程构建块 ( [http://threadingbuildingblocks.org](http://threadingbuildingblocks.org) )、OpenMP ( [http://openmp.org](http://openmp.org) )、SDL ( [http://libsdl.org](http://libsdl.org) ) 或 SFML ( [http://sfml-dev.org](http://sfml-dev.org) ) ），我认为OpenGL（[http://opengl.org](http://opengl.org)）也实现了一个定时器或定时器的包装器。

说“不使用库函数”有点含糊：你具体指的是哪个库？最后，您必须使用一些库函数或内联汇编，因为 C++ 在核心语言中没有计时功能。如果没有任何计时器处理器或其他任何形式的计时硬件 (*)，就无法告诉时间，不是模糊的，不是准确的。

(*) 这包括互联网时间提供商。

# sql-server - SQL Server - 单个过程与单个过程

> ID：661793
> 
> 赞同：4
> 
> 时间：2009-03-19T11:05:36.867
> 
> 标签：sql-server, performance, stored-procedures

在我正在开发的系统中，我可以选择使用单个存储过程来执行三个相关的作业并且不返回任何结果，或者返回相同的结果集，但来自两个不同的表。

我昨天读了一篇文章，建议存储过程应该只有一个执行计划，并且任何根据参数差异更改其执行计划的过程都应该写成多个过程。

将程序编写为三个不同的程序会改变执行程序的系统的操作方式，但不会以任何显着的方式。

我想知道的是，根据输入与单个过程没有不同执行计划的过程所获得的性能是否值得付出努力，即调用数据库的开销是调用数据库的开销的三倍视情况重新编制绩效计划？

谢谢

格雷格

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T11:08:52.507

您可能会考虑编写三个单独的存储过程，然后从单个存储过程中调用它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-19T11:51:24.463

Chris Simpson 正确地认识到我留给他命名的设计模式的适用性。应用这种模式最直接的好处是简单，它易于验证（测试）和易于维护。

*可能*会有性能提升，但这是不可预测的。有时复杂性会使查询计划优化器感到困惑。将您的 über 方法分解为几个更简单的特定于案例的策略（克里斯提示）*可能会*减少由于对非常大的决策树进行积极修剪而导致的错误，并且它还可能允许*按案例*进行优化。当“特殊”情况实际上非常典型时，这可能非常有益。

然而，提高可验证性和可维护性本身就是值得称赞的目标。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T11:35:56.623

除非某些功能段有可能被系统的其他区域重用，否则我实际上建议坚持使用 1 个存储过程。

根据经验，您拥有的 SP 越多，需要维护的就越多（我觉得每个 SP 的开销很小，除了 SP 中包含的内容之外）。

# jquery - 使用 Html.ValidationMessage 的 jQuery 的 ASP.NET MVC 客户端验证？

> ID：661798
> 
> 赞同：5
> 
> 时间：2009-03-19T11:07:23.477
> 
> 标签：jquery, asp.net-mvc, validation, client-side

我正在尝试利用 HTML.ValidationMessage() 元素来使用 jQuery 编写非常自定义的客户端验证。这甚至可能吗？我的服务器端验证使用 HTML.ValidationMessage() 显示，我想知道如何在表单提交之前访问该元素以使用 jQuery 显示自定义消息。

我知道有一些插件可以做这些事情，但我真的很想完全控制我的验证。

这是我目前拥有的一些 Javascript 代码。基本上它在提交时将验证“类”添加到输入元素，但不确定如何访问 Html.ValidationMessage 以输出“需要电子邮件”之类的内容。

```
 <script type="text/javascript">
    $(document).ready(function() {
        $("input[type=submit]").click(function() {

            var valid = true;

            // email blank
            if ($("input[name='email']").val().length < 1) {
                $("input[name='email']").addClass("input-validation-error");
                valid = false;
            }

            return valid;
        })
    });

</script> 
```

和视图中的代码：

```
 <p>
            <label for="email">
                Email:</label>
            <%= Html.TextBox("email") %>
            <%= Html.ValidationMessage("email") %>
        </p> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-19T14:02:15.243

您可以编写大量代码来执行此操作。或者您可以只使用[xVal](http://www.codeplex.com/xval)，它是免费的，并且可以做到这一点，还有更多。在您的 .NET 类型上添加值注释，向您的 aspx 添加一些简单的东西，然后您就可以免费获得 jQuery 验证。此外，它还附带流行框架的提供程序，并且它非常可定制，以防您需要更复杂的验证。

我认为没有必要在这里重新发明轮子。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-19T15:00:33.527

[将 jquery 表单验证插件](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)用于客户端是否是一个想法？在视图代码中很容易实现。您在输入框中添加一些标签并在标题中添加几行 javascript，您就完成了。当然，您仍然必须编写任何“非常自定义”的代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T13:48:16.447

如果您将消息静态放在页面中并将其显示设置为“无”，则可以在更改输入字段的类的同时显示该消息。

```
 <p>
        <label for="email">
            Email:</label>
        <%= Html.TextBox("email") %><span style="display:none" class="email-error">Email required</span>
        <%= Html.ValidationMessage("email") %>
    </p> 
```

然后在你的 JS 中添加这行下面的部分改变这个：

```
 if ($("input[name='email']").val().length < 1) {
            $("input[name='email']").addClass("input-validation-error");
            valid = false;
        } 
```

对此：

```
 if ($("input[name='email']").val().length < 1) {
            $("input[name='email']").addClass("input-validation-error");
            $("span.email-error").show();
            valid = false;
        } 
```

您可能需要一些 CSS 来相应地定位这些内容，但从功能上讲，它应该可以满足您的需求。

编辑：

为避免额外的标记替换：

```
$("span.email-error").show(); 
```

和：

```
$("input[name='email']").after('<span style="display:none" class="email-error">Email required</span>'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-19T13:52:37.543

创建一个 HtmlHelper，它是一个 ValidatedTextBox。我已经在我的模型上使用反射完成了这项工作，创建了一个带有验证的完全动态的 jQuery 集成，但是一个更简单的版本会像这样工作（这可能会工作，但目前还没有经过测试）。一个很好的起点：

```
public static MvcForm BeginClientValidatedForm(this HtmlHelper helper, string formId)
{
    HttpResponseBase response = helper.ViewContext.HttpContext.Response;
    if (helper.ViewData.ModelState.IsValid)
    {
        response.Write("<ul class=\"validation-summary-errors\"></ul>\n\n");
    }

    response.Write(ClientValidationHelper.GetFormValidationScript(formId));
    response.Write("\n");

    // Inject the standard form into the httpResponse.
    var builder = new TagBuilder("form");
    builder.Attributes["id"] = formId;
    builder.Attributes["name"] = formId;
    builder.Attributes["action"] = helper.ViewContext.HttpContext.Request.Url.ToString();
    builder.Attributes["method"] = HtmlHelper.GetFormMethodString(FormMethod.Post);
    response.Write(builder.ToString(TagRenderMode.StartTag));

    return new MvcForm(response);
} 
```

以及相应的“GetFormValidationScript”：

```
public static string GetFormValidationScript(string formId)
  {
    string scriptBlock =
    @"<script type=""text/javascript"">
    $(document).ready(function() {{
      $(""#{0}"").validate({{
        meta:""rules"",
        onkeyup:false,
        onfocusout:false,
        onclick:false,
        errorClass:""input-validation-error"",
        errorElement:""li"",
        errorLabelContainer:""ul.validation-summary-errors"",
        showErrors: function(errorMap, errorList) {{
            $(""ul.validation-summary-errors"").html("""");
            this.defaultShowErrors();
      }}";

      // etc...this is the standard jQuery.validate code.

      return string.Format(scriptBlock, formId);

  }

public static string ClientValidatedTextbox(this HtmlHelper htmlHelper, string propertyName, IDictionary<string, object> htmlAttributes, string validationType)
{
    var cssClassBuilder = new StringBuilder();
    cssClassBuilder.Append("text ");
    if (htmlAttributes == null)
    {
        htmlAttributes = new Dictionary<string, object>();
    }
    else if(htmlAttributes.ContainsKey("class"))
    {
        cssClassBuilder.Append(htmlAttributes["class"]);
    }

    switch validationType
    {
      case "email":
        cssClassBuilder.Append(" {rules: {email: true, messages: {email: 'A valid email is required.'}} } ");
        break;
    }

    htmlAttributes["class"] = cssClassBuilder.ToString();

    return htmlHelper.TextBox(propertyName, htmlAttributes);
} 
```

# .net - Visual Studio 2008 - 使用示例应用程序分发库 - 确保无法访问库的源代码

> ID：661801
> 
> 赞同：0
> 
> 时间：2009-03-19T11:08:25.987
> 
> 标签：.net, visual-studio

我想这是一个非常愚蠢的问题，知道可以使用 Reflector 等工具查看 .net 代码，但它来了。

我在 VS2008 (vb.net) 中编写了一个库，我将其分发给一些人进行测试。通过分发，我还附加了一个使用我的库的示例项目（应用程序）。我以为我会分发示例应用程序的整个项目文件夹，但后来令我震惊的是，通过调试模式的测试人员也许可以“进入”库的代码，因为 pdb 文件（nameofmylibrary.pdb）是展示。

我不知道这一切是如何工作的，但我只想确保万一我的库中有错误，测试人员无法在调试模式下访问我的库代码（我可以获得图书馆）。如何继续分发示例应用程序？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T11:11:15.810

只是不要给他们 PDB。事实上，我建议在分发之前清理构建 - 不要包含`bin`and`obj`目录。他们只是让事情变得非常臃肿。

包括：

*   示例项目的来源
*   库的 DLL
*   库的 XML 文档（连同 DLL）（如果您正在生成它）

请注意，Reflector*实际上并不*呈现原始源代码。它提供了一个没有注释的版本，除非 PDB 在那里，否则没有局部变量，并且通常基于编译器所做的事情的代码更加晦涩难懂。如果你真的很担心，你可以使用混淆器，但我个人认为库的大部分价值*通常*在于它的设计（几乎*必须*是可见的）而不是实现。当然，也有例外。

# c# - 您如何防止 IDisposable 传播到您的所有班级？

> ID：661815
> 
> 赞同：139
> 
> 时间：2009-03-19T11:13:23.790
> 
> 标签：c#, .net, garbage-collection, dispose, idisposable

## 从这些简单的类开始......

假设我有一组简单的类，如下所示：

```
class Bus
{
    Driver busDriver = new Driver();
}

class Driver
{
    Shoe[] shoes = { new Shoe(), new Shoe() };
}

class Shoe
{
    Shoelace lace = new Shoelace();
}

class Shoelace
{
    bool tied = false;
} 
```

A`Bus`有 a `Driver`， the`Driver`有两个`Shoe`s，每个`Shoe`都有 a `Shoelace`。都非常傻。

## 将 IDisposable 对象添加到 Shoelace

后来我决定一些操作`Shoelace`可以是多线程的，所以我添加了一个`EventWaitHandle`用于线程通信的线程。所以`Shoelace`现在看起来像这样：

```
class Shoelace
{
    private AutoResetEvent waitHandle = new AutoResetEvent(false);
    bool tied = false;
    // ... other stuff ..
} 
```

## 在鞋带上实现 IDisposable

但现在[微软的 FxCop](https://en.wikipedia.org/wiki/FxCop)会抱怨：*“在 'Shoelace' 上实现 IDisposable，因为它会创建以下 IDisposable 类型的成员：'EventWaitHandle'。”*

好的，我实现`IDisposable`了`Shoelace`，我整洁的小班变成了可怕的一团糟：

```
class Shoelace : IDisposable
{
    private AutoResetEvent waitHandle = new AutoResetEvent(false);
    bool tied = false;
    private bool disposed = false;

    public void Dispose()
    {
        Dispose(true);
        GC.SuppressFinalize(this);
    }

    ~Shoelace()
    {
        Dispose(false);
    }

    protected virtual void Dispose(bool disposing)
    {
        if (!this.disposed)
        {
            if (disposing)
            {
                if (waitHandle != null)
                {
                    waitHandle.Close();
                    waitHandle = null;
                }
            }
            // No unmanaged resources to release otherwise they'd go here.
        }
        disposed = true;
    }
} 
```

或者（正如评论者所指出的）因为`Shoelace`它本身没有非托管资源，我可以使用更简单的 dispose 实现而不需要`Dispose(bool)`and 析构函数：

```
class Shoelace : IDisposable
{
    private AutoResetEvent waitHandle = new AutoResetEvent(false);
    bool tied = false;

    public void Dispose()
    {
        if (waitHandle != null)
        {
            waitHandle.Close();
            waitHandle = null;
        }
        GC.SuppressFinalize(this);
    }
} 
```

## 惊恐地看着 IDisposable 传播

没错，就是这么固定的。但是现在 FxCop 会抱怨`Shoe`创建了一个`Shoelace`，所以也`Shoe`必须`IDisposable`如此。

并且`Driver`创造必须`Shoe`如此。并创造必须如此等等。`Driver``IDisposable``Bus``Driver``Bus``IDisposable`

突然间`Shoelace`，我`Bus`对`Shoelace`.

## 问题

您如何防止`IDisposable`.

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-03-19T11:21:54.270

你不能真正“阻止” IDisposable 传播。有些类需要被释放，比如`AutoResetEvent`，最有效的方法是在`Dispose()`方法中进行，以避免终结器的开销。但是这个方法必须以某种方式调用，所以就像在你的例子中一样，封装或包含 IDisposable 的类必须处理这些，所以它们也必须是一次性的，等等。避免它的唯一方法是：

*   尽可能避免使用 IDisposable 类，在单个位置锁定或等待事件，将昂贵的资源保存在单个位置等
*   仅在您需要它们时创建它们并在（`using`模式）之后处理它们

在某些情况下，可以忽略 IDisposable，因为它支持可选情况。例如，WaitHandle 实现 IDisposable 以支持命名的 Mutex。如果未使用名称，则 Dispose 方法不执行任何操作。MemoryStream 是另一个例子，它不使用系统资源，而且它的 Dispose 实现也不做任何事情。仔细考虑是否正在使用非托管资源可能具有指导意义。因此可以检查 .net 库的可用源或使用反编译器。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-03-19T12:23:28.023

就正确性而言，如果父对象创建并基本上拥有一个现在必须是一次性的子对象，则您无法阻止 IDisposable 通过对象关系传播。FxCop 在这种情况下是正确的，并且父级必须是 IDisposable。

您可以做的是避免将 IDisposable 添加到对象层次结构中的叶类。这并不总是一件容易的事，但它是一个有趣的练习。从逻辑的角度来看，鞋带没有理由必须是一次性的。除了在此处添加 WaitHandle 之外，是否还可以在 ShoeLace 和 WaitHandle 的使用点之间添加关联。最简单的方法是通过 Dictionary 实例。

如果您可以在实际使用 WaitHandle 的点通过映射将 WaitHandle 移动到松散关联中，那么您可以断开此链。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2010-06-09T12:48:27.343

为了防止`IDisposable`传播，您应该尝试将一次性对象的使用封装在单个方法中。尝试`Shoelace`不同的设计：

```
class Shoelace { 
  bool tied = false; 

  public void Tie() {

    using (var waitHandle = new AutoResetEvent(false)) {

      // you can even pass the disposable to other methods
      OtherMethod(waitHandle);

      // or hold it in a field (but FxCop will complain that your class is not disposable),
      // as long as you take control of its lifecycle
      _waitHandle = waitHandle;
      OtherMethodThatUsesTheWaitHandleFromTheField();

    } 

  }
} 
```

等待句柄的范围仅限于`Tie`方法，并且类不需要具有可丢弃字段，因此本身也不需要是可丢弃的。

由于等待句柄是 内部的实现细节`Shoelace`，因此不应以任何方式更改其公共接口，例如在其声明中添加新接口。当您不再需要一次性字段时会发生什么，您会删除`IDisposable`声明吗？如果你考虑`Shoelace` *抽象*，你很快就会意识到它不应该被基础设施依赖所污染，比如`IDisposable`. `IDisposable`应该保留给其抽象封装了需要确定性清理的资源的类；即，对于可处置性是*抽象*一部分的类。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-19T11:55:54.593

这基本上是当您将组合或聚合与一次性类混合时发生的情况。如前所述，第一个出路是用鞋带重构waitHandle。

话虽如此，当您没有非托管资源时，您可以大大减少 Disposable 模式。（我仍在为此寻找官方参考。）

但是你可以省略析构函数和 GC.SuppressFinalize(this); 并且可能稍微清理一下虚拟 void Dispose(bool disposing)。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-19T13:39:52.830

有趣的是，如果`Driver`定义如上：

```
class Driver
{
    Shoe[] shoes = { new Shoe(), new Shoe() };
} 
```

那么在`Shoe`制作时`IDisposable`，FxCop (v1.36) 不抱怨`Driver`应该也是`IDisposable`。

但是，如果它是这样定义的：

```
class Driver
{
    Shoe leftShoe = new Shoe();
    Shoe rightShoe = new Shoe();
} 
```

然后它会抱怨。

我怀疑这只是 FxCop 的一个限制，而不是一个解决方案，因为在第一个版本中，`Shoe`实例仍然由 the 创建，`Driver`并且仍然需要以某种方式处理。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-01-06T10:39:29.957

如果您的设计保持如此紧密的耦合，我认为没有一种技术方法可以防止 IDisposable 传播。然后人们应该怀疑设计是否正确。

在您的示例中，我认为让鞋子拥有鞋带是有意义的，也许司机应该拥有他/她的鞋子。但是，公共汽车不应该拥有司机。通常，公共汽车司机不会跟随公共汽车去废品场:) 对于司机和鞋子，司机很少自己制作鞋子，这意味着他们并不真正“拥有”它们。

另一种设计可能是：

```
class Bus
{
   IDriver busDriver = null;
   public void SetDriver(IDriver d) { busDriver = d; }
}

class Driver : IDriver
{
   IShoePair shoes = null;
   public void PutShoesOn(IShoePair p) { shoes = p; }
}

class ShoePairWithDisposableLaces : IShoePair, IDisposable
{
   Shoelace lace = new Shoelace();
}

class Shoelace : IDisposable
{
   ...
} 
```

不幸的是，新设计更加复杂，因为它需要额外的类来实例化和处理鞋子和驱动程序的具体实例，但这种复杂性是要解决的问题所固有的。好消息是，公交车不再需要仅仅为了处理鞋带而被丢弃。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-07-02T11:34:55.960

如何使用控制反转？

```
class Bus
{
    private Driver busDriver;

    public Bus(Driver busDriver)
    {
        this.busDriver = busDriver;
    }
}

class Driver
{
    private Shoe[] shoes;

    public Driver(Shoe[] shoes)
    {
        this.shoes = shoes;
    }
}

class Shoe
{
    private Shoelace lace;

    public Shoe(Shoelace lace)
    {
        this.lace = lace;
    }
}

class Shoelace
{
    bool tied;
    private AutoResetEvent waitHandle;

    public Shoelace(bool tied, AutoResetEvent waitHandle)
    {
        this.tied = tied;
        this.waitHandle = waitHandle;
    }
}

class Program
{
    static void Main(string[] args)
    {
        using (var leftShoeWaitHandle = new AutoResetEvent(false))
        using (var rightShoeWaitHandle = new AutoResetEvent(false))
        {
            var bus = new Bus(new Driver(new[] {new Shoe(new Shoelace(false, leftShoeWaitHandle)),new Shoe(new Shoelace(false, rightShoeWaitHandle))}));
        }
    }
} 
```

# c - 如何使用 SendInput() 指定 kbd 修饰符？

> ID：661817
> 
> 赞同：2
> 
> 时间：2009-03-19T11:13:33.540
> 
> 标签：c, winapi, keyboard-events

我正在使用 Windows API SendInput() 调用来模拟键盘事件。以下片段（省略了无关细节）非常适合发送一系列字符：

```
wchar_t txt = ...;
INPUT *input = ...;
size_t nInput = 0;

for (unsigned int j = 0; j < length; j++) {
    input[nInput].ki.wVk = 0;
    input[nInput].ki.wScan = txt[j];
    input[nInput].ki.dwFlags = KEYEVENTF_UNICODE;
    nInput++;
    input[nInput].ki.wVk = 0;
    input[nInput].ki.wScan = txt[j];
    input[nInput].ki.dwFlags = KEYEVENTF_UNICODE | KEYEVENTF_KEYUP;
    nInput++;
}
SendInput(nInput, input, sizeoF(INPUT)); 
```

现在我正在尝试发送带有修饰符的单个按键。我尝试了以下代码：

```
bool control, alt shift;
wchar_t chr;

if (control) {
    input[nInput].ki.wVk = VK_CONTROL;
    input[nInput].ki.dwFlags = 0;
    nInput++;
}
if (alt) {
    input[nInput].ki.wVk = VK_MENU;
    input[nInput].ki.dwFlags = 0;
    nInput++;
}
if (shift) {
    input[nInput].ki.wVk = VK_SHIFT;
    input[nInput].ki.dwFlags = 0;
    nInput++;
}

input[nInput].ki.wVk = 0;
input[nInput].ki.wScan = chr;
input[nInput].ki.dwFlags = KEYEVENTF_UNICODE;
nInput++;
input[nInput].ki.wVk = 0;
input[nInput].ki.wScan = chr;
input[nInput].ki.dwFlags = KEYEVENTF_UNICODE | KEYEVENTF_KEYUP;
nInput++;

if (shift) {
    input[nInput].ki.wVk = VK_SHIFT;
    input[nInput].ki.dwFlags = KEYEVENTF_KEYUP;
    nInput++;
}
if (alt) {
    input[nInput].ki.wVk = VK_MENU;
    input[nInput].ki.dwFlags = KEYEVENTF_KEYUP;
    nInput++;
}
if (control) {
    input[nInput].ki.wVk = VK_CONTROL;
    input[nInput].ki.dwFlags = KEYEVENTF_KEYUP;
    nInput++;
}
SendInput(nInput, input, sizeof(INPUT)); 
```

但是，修饰符似乎没有通过，即，即使说`control`设置为 true，事件序列也会作为普通按键接收。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-19T12:28:59.383

[Pax 的回答](https://stackoverflow.com/questions/661817/how-to-specify-kbd-modifiers-with-sendinput/661919#661919)没有奏效，但它引导我找到了正确的解决方案。简而言之：不要`KEYEVENTF_UNICODE`用于单个按键，而是将字符转换为虚拟键码，然后以这种方式发送。以下是相关代码：

```
SHORT virtKey = VkKeyScan((TCHAR) chr);
input[nInput].ki.wVk = LOBYTE(virtKey);
input[nInput].ki.dwFlags = 0;
nInput++;
input[nInput].ki.wVk = LOBYTE(virtKey);
input[nInput].ki.dwFlags = KEYEVENTF_KEYUP;
nInput++; 
```

我还没有测试这对于映射到非英语键盘布局的非 ASCII unicode 字符是如何工作的，以及当我的应用程序的布局集与前面的应用程序的布局集不同时会发生什么。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-19T11:50:40.287

我发现的唯一一段代码可能表明您的问题也在`ki`结构中设置了扫描代码。

尝试将修饰符部分更改为：

```
if (control) {
    input[nInput].ki.wVk = VK_CONTROL;
    input[nInput].ki.dwFlags = 0;
    input[nInput].ki.wScan = MapVirtualKey(VK_CONTROL, 0); 
    nInput++;
}
if (alt) {
    input[nInput].ki.wVk = VK_MENU;
    input[nInput].ki.dwFlags = 0;
    input[nInput].ki.wScan = MapVirtualKey(VK_MENU, 0); 
    nInput++;
}
if (shift) {
    input[nInput].ki.wVk = VK_SHIFT;
    input[nInput].ki.dwFlags = 0;
    input[nInput].ki.wScan = MapVirtualKey(VK_SHIFT, 0); 
    nInput++;
} 
```

看看是否有帮助。

如果这仍然不起作用，请尝试设置`dwFlags`to`KEYEVENTF_SCANCODE`而不是`0`（仅适用于修饰键）。

也为按键事件执行此操作，我假设您设置`input[nInput].type`为`INPUT_KEYBOARD`，是吗？您的代码没有表明这一点。

作为参考，它是在[这个页面](http://www.tech-archive.net/Archive/Development/microsoft.public.win32.programmer.ui/2004-03/0053.html)上找到的。

# c++ - FastCGI 清理代码在 windows 下不起作用

> ID：661818
> 
> 赞同：1
> 
> 时间：2009-03-19T11:14:28.343
> 
> 标签：c++, c, windows, apache, fastcgi

在带有 mod_fastcgi 的 windows 服务器上使用 apache，C 代码如下所示：

```
void main() {
    init();
    while (FCGI_Accept() >= 0)
        work();
    cleanup();
} 
```

当服务被关闭时（即：net stop apache2），进程终止而没有进入清理代码。

我在这里想念什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-24T20:10:27.860

看来，从阅读`FCGI_Accept`手册页和[这个 FAQ 条目](http://www.fastcgi.com/drupal/node/6?q=node/18#signals)来看`FCGI_Accept`，实际上在 Apache 关闭的情况下不会返回 -1。尝试为 SIGUSR1 和 SIGTERM 设置信号处理程序。有一个示例（不是特定于 Windows 的，但值得一试）不久前[在邮件列表上发布，here。](http://article.gmane.org/gmane.comp.web.fastcgi.devel/590)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-22T22:42:32.993

过早退出的唯一方法是在 work()（或 FCGI_Accept()...）中的某处调用“exit()”

**编辑：**

如果您认为它可能是 FCGI_Accept()，请尝试使用 onexit() 设置要从“exit()”调用的回调。至少这将确认“exit()”被过早调用。

# wcf - 通过多个“商店”对 WCF 端点请求进行身份验证

> ID：661819
> 
> 赞同：0
> 
> 时间：2009-03-19T11:15:50.837
> 
> 标签：wcf, security, authentication

是否可以设置单个 WCF 服务端点来针对多个身份验证存储进行身份验证？即如果提供的用户名和密码检查自定义数据库，否则尝试 Windows 身份验证。

背景：

我有 WCF 服务 A，它被注入到 WCF 服务 B 的客户端代理。服务 B 可能依赖于服务 C 等。

对服务 A 的用户请求进入并使用 custom 进行身份验证`UserNamePasswordValidator`，并且 a`ClaimSet`使用自定义实现构建`IAuthorizationPolicy.`

认证成功，调用 A 上的服务操作。此操作通过注入的代理调用服务 B。

然后，服务 B 请求通过 Auth/Authz 堆栈，但由于未设置凭据而失败。由于称为服务 BI 的服务 A 信任它，因此希望授权成功，而无需传递原始调用者的用户名和密码。

然而，服务 B 可以由用户使用用户名和密码直接调用，因此它必须支持两种身份验证方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-20T15:31:52.127

我设法从微软的一位联系人那里得到了这个回复：

您不能在单个端点上拥有不同的安全机制，您必须为您需要的每个安全协议公开一个单独的端点，因为每个安全协议都需要单独的绑定配置，因为身份验证机制是端点定义的一部分。

单个端点上的多种安全模式应该是 .NET 4.0 附带的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T12:14:42.940

我很确定在一个端点上支持多种凭证类型确实存在。它可能已添加到日内瓦框架中，所以我会调查一下。[本文](http://msdn.microsoft.com/en-us/magazine/dd278426.aspx)提到让 STS 对多种凭证类型进行身份验证，因此我认为也有一种方法可以在没有 STS 的情况下使用普通服务进行验证。

当我需要使用多个“密钥”进行身份验证时，我创建了一个自定义 ClientCredential 类。

很抱歉简短的回答，但我需要离开家去上班......工作是这样一个时间的障碍:)

# sandcastle - 这个 SandCastle 帮助文件生成器错误是什么意思？

> ID：661825
> 
> 赞同：0
> 
> 时间：2009-03-19T11:20:16.457
> 
> 标签：sandcastle

我正在尝试使用 msbuild 中的 SandCastle 帮助文件生成器生成帮助文件，但出现以下错误：

SandcastleBuilder.Utils.BuilderException：SchemaVersion 无效或缺失

这是什么意思？我该如何解决这个错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T11:26:13.013

这有[什么](http://www.ewoodruff.us/shfbdocs/html/f6258ea1-df3f-4397-81e4-3e0a39abcdc2.htm)帮助吗？

# python - 我可以使用单个文件作为缓冲区吗？即同时写入和读取

> ID：661826
> 
> 赞同：2
> 
> 时间：2009-03-19T11:20:44.210
> 
> 标签：python, file-io

我想让一个应用程序在监视器读取信息的同时写出信息。该应用程序是“嵌入式的”（在 Win32 XP 上），因此内存和 I/O 功能受到限制。

我能想到的最简单的方法是将数据从应用程序写入缓冲区文件，然后使用监视器应用程序读取同一个文件。编写器应用程序是 C++，阅读器目前是 Win32 XP 上的 Python。

有图书馆可以做到这一点吗？有没有人见过这样的例子？

我不想使用数据库，因为我不想链接到应用程序中的数据库库。即没有空间，嵌入式平台可能不支持。

另一种方法是通过网络连接，但我认为文件是最简单的解决方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-19T11:26:55.710

大多数系统都有多种解决方案来满足您的需求，例如管道和 unix 套接字。与常规文件不同，这些是为此而设计的。然而，有一些程序可以在常规文件上执行此操作，我认为最明显的例子是 unix-utility tail，它可以“跟随”文件。

看看
[http://msdn.microsoft.com/en-us/library/aa365590(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa365590(VS.85).aspx)

Python 有一个很好的 win32 包装库，所以你看到的任何东西都可以从 python 访问。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-21T13:48:06.953

您可以使用内存映射文件，称为 mmap 的标准 Python 模块。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T12:17:51.250

您所说的称为“进程间通信”。有很多方法可以做到这一点。

使用 Unix 管道。

[https://docs.python.org/library/pipes.html](https://docs.python.org/library/pipes.html)

使用套接字。

[https://docs.python.org/library/socket.html](https://docs.python.org/library/socket.html)

使用队列。

[https://docs.python.org/library/queue.html](https://docs.python.org/library/queue.html)

这些中的任何一个都比文件 I/O 更好。

# java - 比较 JSF 实现

> ID：661827
> 
> 赞同：16
> 
> 时间：2009-03-19T11:20:59.157
> 
> 标签：java, jsf

我很高兴在比较已知的 JSF 实现方面获得参考资源和人们的经验：MyFaces 和 IceFaces 在组件的丰富性、易于开发、流行度、稳定性、社区支持等方面。

更新：正如指出的那样，最初的问题不够准确。很少有 JSF 实现（Apache MyFaces、Sun 参考实现）和一些 JSF 组件库（IceFaces、RichFaces、Woodstock 等）。但无论如何，我的问题是关于核心 JSF 和 JSF 组件库的实现。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-19T12:06:58.703

当心！

JSF 是一种规范。因此，您必须使用一种实现，例如 Sun 提供的实现，或者 Apache (MyFaces) 提供的实现。

IceFaces*不是*一个实现，而是一个组件库。还存在其他库，例如 RichFaces、MyFaces Tomahawk 等。

您可以在[这里](http://www.jsfmatrix.net/)查看组件库之间的差异。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2011-01-08T19:04:49.563

我意识到这是一篇迟到的帖子，但由于我正在寻找扩展但没有看到它：我真的建议您也查看 Primefaces。我对 JSF 还比较陌生（1 年的开发时间），但我一直在尝试使用不同的套件在我们的研究阶段完成每个新的子集。

这是我的经验：Icefaces 处理 AJAX 无需您做太多工作。当您尝试做一些相对简单的事情时，Icefaces 在小的 DOM 更新和响应式 UI 方面做得非常好。我强烈建议新人从这里开始，因为您将能够快速开始工作并学习 JSF 的所有细节而不会感到痛苦。（它也有不错的 Eclipse 工具）

Richfaces 是一个很好的套件，它以更精细的方式处理 ajax（更接近 JSF2.0 的工作方式）在我看来，这些组件有点缺乏，但如果您正在自定义外观，Richfaces 是一个更好的起点，因为它通常感觉更容易皮肤。（再一次，普通的 JSF2.0 适用于此）。

最近我试用了 Primefaces (http://www.primefaces.org)。该套件涉及更多工作，可以看出它在组件的数量和外观方面具有显着优势。其中，我喜欢在 Primefaces 中处理复杂的事情，而这在 Icefaces 中完全令人沮丧。

我希望这对其他读者有所帮助，我认为所有这些套件都很棒。如果你正在做一些疯狂的 Javascript 并且你需要细粒度的控制，那就选择 Primefaces。

另一个小提示：如果它是一个新应用程序，请使用 JSF2.0——它具有显着的优势，我还没有发现任何令人沮丧的地方。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-19T12:26:02.493

[RichFaces](http://www.jboss.org/jbossrichfaces/)由 Redhat 下的 Jboss 开发。

**丰富的组件：**许多不错的 ajax 功能和 UI 组件。

**易于开发：**主观的，但我说是的。

**人气：** v3.3.0 下载量约 13,000

**稳定性：**仍在积极开发中，正在添加新功能。[错误跟踪](https://jira.jboss.org/jira/browse/RF)系统到位。

**社区支持：**有一个很好的带有代码示例的在线[演示](http://livedemo.exadel.com/richfaces-demo/richfaces/tabPanel.jsf)（在 Jboss 网站上，您必须登录才能访问）。Jboss 网站上有一个[论坛](http://www.jboss.org/index.html?module=bb&op=main&c=27)和[维基。](http://www.jboss.org/community/docs/DOC-11846)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-09T20:20:57.027

如果您使用 Sun RI 或 MyFaces 并没有真正的区别。两者都实现了 JSF 标准定义的内容。

对于组件库，您必须查看：

*   ICEfaces（我们更喜欢这个）
*   RichFaces（您必须检查这与 JBoss 世界的紧密程度）
*   战斧（经典；有传言说发展有点停滞）
*   Trinidad（Oracle ADF Faces 开源内核）

这些很重要。Woodstock 已经死了，ICEfaces 的人正在提供迁移路径。如果您已经在使用 Oracle 工具（例如 JDeveloper），那么 Trinidad 是一个不错的起点。如果您已经使用 JBoss 工具，RichFaces 是一个不错的入门选择。

如需更独立的使用，请查看 Tomahawk 和 ICEfaces。ICEfaces 允许集成 Tomahawk 组件，尽管皮肤并不真正兼容。集成是 ICEfaces 的关键特性之一。IDE、应用程序服务器和其他开源框架的支持非常出色。Facelets 集成是您能得到的最好的。AJAX 推送技术是目前最好的推送实现。JSF 2.0 的很多东西已经是 ICEfaces 1.8 的一部分。

以下是我们更喜欢 ICEfaces 的更多原因：

[http://blog.rainer.eschen.name/2008/09/22/icy-faces-for-more-than-a-year/](http://blog.rainer.eschen.name/2008/09/22/icy-faces-for-more-than-a-year/)

有关 JSF 的介绍，请看这里：

[http://blog.rainer.eschen.name/2008/03/10/how-to-start-the-jsf-dance/](http://blog.rainer.eschen.name/2008/03/10/how-to-start-the-jsf-dance/)

提示：Packt Publishing 在 2008 年底要求我写一本关于 ICEfaces 的书。它将在 2009 年 10 月末上市。知道了这一点，答案可能有点偏颇。但是，这是长期测试和 1.5 年以上 ICEfaces 经验的结果。这是你能在技术上获得的最好的。在我们的项目最终选择 ICEfaces 之前，我测试了所有重要的开源 JSF 实现。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-20T12:21:39.367

I second RichFaces. Lots of good documentation on the exadel pages (which Mark linked too) and also a very nice Developer guide on every component. Thumbs up for core JSF + Richfaces (which also have alot of nice Ajax support).

# wpf - WPF - ItemTemplate 未按预期运行

> ID：661831
> 
> 赞同：4
> 
> 时间：2009-03-19T11:23:43.050
> 
> 标签：wpf, user-controls, datatemplate, itemtemplate, itemspanel

我有一个`UserControl`用来显示`UIElement`s 列表的。该控件由一个单独的控件组成，`ItemsControl`它被`ItemPanelTemplate`切换为水平`StackPanel`，它`ItemsSource`绑定到由`DependencyProperty`暴露的`UserControl`和它`ItemTemplate`在 中的集合`UserControl.Resources`。

一切正常，除了`ItemTemplate`从未得到应用，我不明白为什么。完整来源如下。

UserControl.xaml -

```
<UserControl x:Name="UC" x:FieldModifier="private" x:Class="ContentSliderControl.ContentSlider"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
<UserControl.Resources>

    <DataTemplate x:Key="pageTemplate">
        <Border CornerRadius="10" Padding="5" Height="200" Width="200" Background="#333">
            <ContentControl Content="{Binding}"/>
        </Border>
    </DataTemplate>

    <ItemsPanelTemplate x:Key="template">
        <StackPanel IsItemsHost="True"
            Orientation="Horizontal"
            ScrollViewer.HorizontalScrollBarVisibility="Disabled"
            ScrollViewer.VerticalScrollBarVisibility="Disabled"/>
    </ItemsPanelTemplate>
</UserControl.Resources>

<ItemsControl ItemsPanel="{StaticResource template}" 
              ItemTemplate="{StaticResource pageTemplate}" 
              ItemsSource="{Binding ElementName=UC,Path=Pages}"/> 
```

UserControl.xaml.cs -

```
[ContentProperty("Pages")]
public partial class ContentSlider : UserControl
{

    public List<UIElement> Pages
    {
        get { return (List<UIElement>)GetValue(PagesProperty); }
        //set { SetValue(PagesProperty, value); }
    }

    // Using a DependencyProperty as the backing store for Pages.  This enables animation, styling, binding, etc...
    public static readonly DependencyProperty PagesProperty =
        DependencyProperty.Register("Pages", typeof(List<UIElement>), typeof(ContentSlider), new UIPropertyMetadata(null));

    public ContentSlider()
    {
        InitializeComponent();
    }
} 
```

}

我像这样在主窗口中使用控件-

```
 <slider:ContentSlider >
    <slider:ContentSlider.Pages>
        <Button>1</Button>
        <Button>2</Button>
        <Button>3</Button>
        <Button>4</Button>
    </slider:ContentSlider.Pages>
</slider:ContentSlider> 
```

按钮看起来不错，但不在 200px 方形边框内。

任何帮助将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-19T18:24:13.840

Nir 是正确的，如果它们是 UIElements ，`ItemsControl`将直接向其添加项目。`Panel`我在 MSDN 中找不到任何关于这种行为的提及，但 WPF 博士在[他关于项目容器的文章中](http://drwpf.com/blog/Home/tabid/36/EntryID/32/Default.aspx)提到了它：

> 如果将 UIElement 添加到显式 ItemsControl 实例的 Items 集合（与 ListBox 等派生类的实例相反），它将成为项目面板的直接子项。如果添加了非 UIElement，它将被包装在 ContentPresenter 中。

您的解决方案可能是改用 a `ListBox`，并将其设置`ItemContainerStyle`为新`Style`的 for `ListBoxItem`，并在该样式中将 a`ControlTemplate`与您`Border`一起使用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-19T11:41:42.927

因为是 UIElement 的列表，只有在 item 不能直接显示的情况下才会应用 item 模板。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-08-11T03:37:00.933

Nir 是对的，这个自定义 ItemsControl 实现将解决问题并让您使用自己的 ItemTemplate：

```
public class ItemsControlForUIElement : ItemsControl
{
   protected override DependencyObject GetContainerForItemOverride()
   {
       return new ContentPresenter();
   }
   protected override bool IsItemItsOwnContainerOverride(object item)
   {
       return false;
   }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-05-28T22:46:38.037

罗伯特·麦克尼（Robert Macnee）将原因钉在了头上。他的解决方案涉及使用控制模板，这对于给定的场景可能是多余的。或者，使用`ListBox`- 将 设置`ItemContainerStyle`为 的新样式`ListBoxItem`，并在该样式中，将 设置为`ContentTemplate`要在`DataTemplate`中使用的`ListBox` `ItemTemplate`。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-03-20T17:51:34.893

如果您在 上设置`DataType`属性，`DataTemplate`它将开始工作。

# php - PHP 多字节字符串函数

> ID：661832
> 
> 赞同：4
> 
> 时间：2009-03-19T11:24:42.733
> 
> 标签：php, utf-8, multibyte

今天我遇到了一个php函数的问题，`strpos()`因为即使正确的结果显然是0，它也会返回FALSE。这是因为一个参数是用UTF-8编码的，而另一个（起源是HTTP GET参数）显然不是。

现在我注意到使用该`mb_strpos`功能解决了我的问题。

我现在的问题是：通常使用 PHP 多字节字符串函数来避免将来出现这些问题是否明智？我应该完全避免传统的`strpos`, `strlen`, `ereg`, 等等等等功能吗？

注意：我不想`mbstring.func_overload`在 php.ini 中设置 global，因为这会导致使用 PEAR 库时出现其他问题。我正在使用 PHP4。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-19T11:33:46.613

5.2 之前的 PHP 版本中的 mb_ * 函数存在一些问题。因此，如果您的代码使用不同版本的 PHP 在多个平台上运行，则可能会出现奇怪的行为。此外，mb_strpos 函数相当慢，它必须跳过 offset 参数指定的字符数才能获得内部使用的实际字节位置。在取决于 strpos/mb_strpos 功能的循环中，这可能成为主要瓶颈。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-19T11:37:54.433

这取决于您使用的字符编码。在单字节字符编码或 UTF-8 中（字符内的单个字节永远不会被误认为另一个字符），那么只要您正在搜索的字符串和您用来搜索的字符串相同编码然后您可以继续使用常规字符串搜索功能。

如果您使用的是 UTF-8 以外的多字节编码，它不会阻止字符中的单个字节像其他字符一样出现，那么使用常规字符串搜索函数进行字符串搜索是绝对不安全的。您可能会发现误报。这是因为 PHP 在 strpos 等函数中的字符串比较是按字节进行的，除了专门为防止这个问题而设计的 UTF-8 之外，多字节编码会遇到一个问题，即字符中的任何后续字节由多个字节可能匹配不同字符的一部分。

如果您正在搜索的字符串和您正在搜索*的*字符串具有不同的字符编码，则始终需要进行转换。否则，您会发现对于在其他编码中以不同方式表示的任何字符串，它将始终返回 false。您应该对输入进行此类转换：决定您的应用程序将使用的字符编码，并在应用程序中保持一致。每当您收到不同编码的输入时，请在输入的过程中进行转换。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-19T11:36:37.590

如果您在任何地方都使用相同的编码，通常不会有问题。我的所有页面都使用 UTF-8，但实际上从未遇到过这个问题。最后，它实际上归结为为页面和数据库指定相同的编码。

例如：

```
header('Content-type: text/html;charset=utf-8');
mysql_query('SET NAMES utf8'); 
```

在大多数情况下，这意味着应用程序的所有数据源将以相同的编码传递数据，因此您将避免此类问题。

顺便说一句，随着 PHP 6 的出现，这一切都会变得更好，因为它将包括完整的 unicode 支持。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-19T11:35:25.597

您不一定必须使用 mb_strpos，但您确实需要确保应用程序中的所有数据都是相同的：要么是 mb_string，要么是一种特定编码的纯字符串。（通常是 UTF-8。）

如果您确保您的页面是 UTF-8，并且您的表单提交被解释为 UTF-8，并且您的数据库存储 UTF-8，那么您通常会没事的。索引字符串操作（特别是截断）可能会破坏 UTF-8 序列，这很烦人，但通常不是灾难性的。如果您确实需要这种级别的支持，mb_strings 是您唯一的选择（但当然，您必须确保应用程序和库的所有部分以及 PHP 版本都可以正确处理它们）。

用 PHP 开发正确处理 Unicode 的网站现在并不太有趣：与 Python 和 .NET 等语言相比，它的 Unicode 支持非常差。希望 PHP6 能改善问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-19T22:18:35.977

我建议使用以下 PHP UTF-8 库：

[http://sourceforge.net/projects/phputf8](http://sourceforge.net/projects/phputf8)

将它与您的应用程序捆绑在一起通过不需要 mbstring 扩展来放松您的应用程序的要求，但您仍然可以获得 UTF-8 字符串函数。

# c# - 遍历一个结构？

> ID：661834
> 
> 赞同：3
> 
> 时间：2009-03-19T11:25:45.510
> 
> 标签：c#, .net

我希望能够遍历 C#（.Net 2.0）中结构的值。这是在运行时完成的，不知道结构中的可能值。

我正在考虑使用反射将结构值添加到列表中，或者将结构转换为实现 IEnumerable 接口的数据结构。任何人都可以提供任何指示吗？

在此先感谢您的帮助。

问候，安迪。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-19T11:29:50.803

你到底是什么意思 - 结构中的各个字段？或者可能是属性？如果是这样，`Type.GetFields()`或者`Type.GetProperties()`是要走的路。

顺便说一句，您绝对确定需要使用结构吗？这很少是 C# 中的最佳设计决策，尤其是在结构包含多个值的情况下。

编辑：是的，似乎出于遗留原因正在使用结构。

我之前没有提到的一件事：如果结构的字段不是公开的，则需要指定适当的 BindingFlags（例如`BindingFlags.Instance | BindingFlags.NonPublic`）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-19T11:34:21.917

在最简单的级别上，假设您要迭代属性：

```
PropertyInfo[] properties = myStructInstance.GetType().GetProperties();
foreach (var property in properties) {
    Console.WriteLine(property.GetValue(myStructInstance, null).ToString());
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-01-13T10:24:33.367

我使用如下内容：

```
[StructLayout(LayoutKind.Sequential)]
public struct MY_STRUCT
{
   public uint aa;
   public uint ab;
   public uint ac;
}

MY_STRUCT pMS = new MY_STRUCT();

FieldInfo[] fields = pMS.GetType().GetFields();
foreach (var xInfo in fields)
   Console.WriteLine(xInfo.GetValue(pMS).ToString()); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-19T11:29:36.793

要使其适用于每个结构，您必须使用反射。如果你想声明一组具有这种能力的结构，你可以让它们实现`IEnumerable<KeyValuePair<string, object>>`并定义`GetEnumerator()`为：

```
yield return new KeyValuePair<string, object>("Field1", Field1);
yield return new KeyValuePair<string, object>("Field2", Field2);
// ... and so forth 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-19T11:44:11.563

[`system.reflection.propertyinfo`](http://msdn.microsoft.com/en-us/library/system.reflection.propertyinfo.aspx)有关使用反射的示例，请参阅文档。

# c# - 如何在异常堆栈中定位特定异常

> ID：661838
> 
> 赞同：2
> 
> 时间：2009-03-19T11:29:05.470
> 
> 标签：c#, api, exception, logic

让我们假设一个特定的异常“ `SomeException`”是异常堆栈的一部分，

所以让我们假设`ex.InnerException.InnerException.InnerException`它的类型是“ `SomeException`”

C# 中是否有任何内置 API 会尝试在异常堆栈中定位给定的异常类型？

例子：

```
SomeException someExp = exp.LocateExceptionInStack(typeof(SomeException)); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-19T11:33:08.627

不，我不相信有任何内置的方法可以做到这一点。不过不难写：

```
public static T LocateException<T>(Exception outer) where T : Exception
{
    while (outer != null)
    {
        T candidate = outer as T;
        if (candidate != null)
        {
            return candidate;
        }
        outer = outer.InnerException;
    }
    return null;
} 
```

如果您使用的是 C# 3，则可以将其设为扩展方法（只需将参数设为“this Exception outer”），使用起来会更好：

```
SomeException nested = originalException.Locate<SomeException>(); 
```

（请注意名称的缩写 - 根据您自己的口味调整：）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T11:34:08.500

它只有 4 行代码：

```
 public static bool Contains<T>(Exception exception)
        where T : Exception
    {
        if(exception is T)
            return true;

        return 
            exception.InnerException != null && 
            LocateExceptionInStack<T>(exception.InnerException);
    } 
```

# javascript - 在 javascript 中使用 appendChild 的问题

> ID：661844
> 
> 赞同：0
> 
> 时间：2009-03-19T11:30:37.680
> 
> 标签：javascript

我在 javascript 中有两个函数：`createtext`和`createtextarea`. 如果我第一次单击按钮`createtext()`，则会显示文本框并且其他元素也会正确创建。

但是，如果我单击`createtextarea()`textarea 的按钮，直到单击`createtext()`.

我认为textarea只有在它获得一个文本框后才会显示出来......

```
<!-- File: /app/views/posts/index.ctp -->

<?php echo $javascript->link('prototype');
echo $javascript->link('scriptaculous'); ?>

<!--script starts here -->

<script type="text/javascript">
var myForm;var fieldidctr=0;var labelidctr=0;
window.onload=function()
{
        // Create a form
    myForm = document.createElement('FORM');
    myForm.method = 'post';

    myForm.id = 'myForm';
        fieldidctr=1;
        labelidctr=1;

}

        function createtext()
        {

                txt1=document.createElement('input'); // Create an input element [textbox]
        label1=document.createElement('label');//create a label
            var tnode=document.createTextNode("click to edit label ");
        label1.appendChild(tnode);
        label1.onclick=function(){createLabel(tnode);}
        txt1.setAttribute('type','text'); // Set the element as textbox
        var txtid="field"+fieldidctr;
        fieldidctr++;

var link = document.createElement("A");
//link.href = "http://localhost/cake_1.2.1.8004/index.php/posts";
var atext = document.createTextNode("Remove");
link.appendChild(atext);

link.onclick=function(){$(txtid).parentNode.removeChild($(txtid));
                   $(labelid).parentNode.removeChild($(labelid));
myForm.removeChild(link);
               }

var labelid="labelid"+labelidctr;
labelidctr++;

        txt1.setAttribute('id',txtid);
label1.setAttribute('id',labelid);
        txt1.onchange=function(){var userInput = txt1.value;
            txt1.setAttribute('value',userInput);}
        myForm.appendChild(label1);
        myForm.appendChild(txt1);//add the textbox to the MyForm

myForm.appendChild(link);
        var e=$('hold');
        e.appendChild(myForm);
                myForm.onSubmit="save_field(this.txt1)";
        }
    function createLabel(myForm)
    {
        myForm.data=prompt("Enter the label name ");
    }
    function createtextarea()
        {
        txt2=document.createElement('textarea'); // Create an input element [textbox]
        label2=document.createElement('label');//create a label
        var tnode=document.createTextNode("click to edit label ");
        label2.appendChild(tnode);
        label2.onclick=function(){createLabel(tnode);}
        txt2.rows='10';
        txt2.cols='3';
        var txtid="field"+fieldidctr;
        fieldidctr++;

var labelid="labelid"+labelidctr;
labelidctr++;

var link = document.createElement("A");

var atext = document.createTextNode("Remove");
link.appendChild(atext);

link.onclick=function(){$(txtid).parentNode.removeChild($(txtid));
                   $(labelid).parentNode.removeChild($(labelid));
myForm.removeChild(link);
}

        txt2.setAttribute('id',txtid);
label2.setAttribute('id',labelid);
        txt2.onchange=function(){var userInput = txt2.value;
        var txtnode=document.createTextNode(userInput);
            txt2.appendChild(txtnode);
            }
        myForm.appendChild(label2);
        myForm.appendChild(txt2);//add the textarea to the MyForm

myForm.appendChild(link);
        var e1=$('hold');
        e.appendChild(myForm);
        myForm.onSubmit="save_field(this.txt2)";
    }

</script>

</div>

<table border=0><tr>

<td width="10%">

 <button style="width:10" onclick="javascript: setformname()">Set the FormName</button><br><br><br>
<button style="width:10" onclick="createtext();">TextBox</button><br><br><br>

<button style="width:10" onclick="createtextarea();">TxtArea</button><br><br><br>

</td>
<td width="75%">

<div id="hold">

<label id="myForm">My  Form </label>
</div></td>
</table> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T11:46:48.017

用于迭代改进代码的社区 wiki：

```
function createtext()
{
    var txt1=document.createElement('input'); // Create an input element [textbox]
    var label1=document.createElement('label');//create a label
    var tnode=document.createTextNode("click to edit label ");
    label1.appendChild(tnode);
    label1.onclick=function(){createLabel(tnode);}
    txt1.setAttribute('type','text'); // Set the element as textbox
    var txtid="field"+fieldidctr;
    fieldidctr++;

    var link = document.createElement("A");
    //link.href = "http://localhost/cake_1.2.1.8004/index.php/posts";
    var atext = document.createTextNode("Remove");
    link.appendChild(atext);

    link.onclick=function()
    {
        $(txtid).parentNode.removeChild($(txtid));
        $(labelid).parentNode.removeChild($(labelid));
        myForm.removeChild(link);
    }

    var labelid="labelid"+labelidctr;
    labelidctr++;

    ////////

    txt1.setAttribute('id',txtid);
    label1.setAttribute('id',labelid);
    txt1.onchange=function(){var userInput = txt1.value;
    txt1.setAttribute('value',userInput);}
    myForm.appendChild(label1);
    myForm.appendChild(txt1);//add the textbox to the MyForm

    myForm.appendChild(link);
    var e=$('hold');
    e.appendChild(myForm);
    myForm.onSubmit="save_field(this.txt1)";
}

function createLabel(myForm)
{
    myForm.data=prompt("Enter the label name ");
}

function createtextarea()
{
    var txt2=document.createElement('textarea'); // Create an input element [textbox]
    var label2=document.createElement('label');//create a label
    var tnode=document.createTextNode("click to edit label ");
    label2.appendChild(tnode);
    label2.onclick=function(){createLabel(tnode);}
    txt2.rows='10';
    txt2.cols='3';
    var txtid="field"+fieldidctr;
    fieldidctr++;

    var labelid="labelid"+labelidctr;
    labelidctr++;

    var link = document.createElement("A");
    var atext = document.createTextNode("Remove");
    link.appendChild(atext);

    link.onclick=function()
    {
        $(txtid).parentNode.removeChild($(txtid));
        $(labelid).parentNode.removeChild($(labelid));
        myForm.removeChild(link);
    }

    ////////////////

    txt2.setAttribute('id',txtid);
    label2.setAttribute('id',labelid);
    txt2.onchange=function()
    {
        var userInput = txt2.value;
        var txtnode=document.createTextNode(userInput);
        txt2.appendChild(txtnode);
    }

    myForm.appendChild(label2);
    myForm.appendChild(txt2);//add the textarea to the MyForm

    myForm.appendChild(link);
    var e1=$('hold');
    e.appendChild(myForm);
    myForm.onSubmit="save_field(this.txt2)";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T12:03:14.577

粗略检查您的代码并没有发现任何明显的错误，尽管您似乎使用了许多具有全局范围的变量，因此您总是可能遇到一些我们看不到的冲突。一个潜在的问题可能是您正在重用 id，因为您依赖同一个变量来为两者生成 id。您可以通过将文本框命名`textNNN`为`fieldNNN`.

除此之外，我的建议是在 Firefox 中使用 Firebug 并在代码中设置一些断点以查看分配了哪些值。除此之外，您可能想考虑如何通过使用参数提供属性值来重构更小的、可重用的函数（例如创建标签、创建字段）来简化代码。由于看起来您正在使用某种框架—— $('hold') 是几种框架的惯用语——你可能还想看看你的框架是否有办法以更优雅的方式处理创建 DOM 元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-29T06:38:32.377

有些元素没有`appendChild()`标签和按钮之类的方法。而当我们使用这些元素时，IE 会生成错误消息

> 对方法或属性访问的意外调用

在其他浏览器中，它们比 IE 更智能。他们渲染内容。这就是为什么`appendChild()`IE 的标签、按钮等工作正常的原因。

简单的解决方案是使用支持`appendChild()`方法的对象，如 div、body 和 head，而不是 label 等。

# .net - 无论如何我可以将“澳大利亚/墨尔本”时区转换为一些.net基类库对象吗？

> ID：661848
> 
> 赞同：2
> 
> 时间：2009-03-19T11:32:28.130
> 
> 标签：.net, zoneinfo

我有一些来自第 3 方的数据，其中包括一些`string Language`属性数据。检索到的一些示例数据如下所示：

> “澳大利亚/墨尔本”

当我调查属性数据类型基于什么时，它是**Zone Info (tz database / Olson database)**。是吗？我用谷歌搜索，这是信息....

*   [区域信息数据库](http://www.twinsun.com/tz/tz-link.htm)
*   [区域信息@维基百科](http://en.wikipedia.org/wiki/Zoneinfo)
*   [ZoneInfo .NET API](http://zoneinfo.codeplex.com/)

听起来它被许多主要平台使用......但不是 .NET。

那么，在我重新发明轮子之前（或者，更确切地说，从那个 codeplex 站点更新代码以将 db 列表嵌入到 dll 中），这是否已经存在于 .NET 基类库中？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-19T11:47:29.653

> 这是一个区域信息（tz 数据库 / Olson 数据库）。是吗？

这是表示时区的可移植的、非常*标准*的方式。IMO，.NET 不能正确支持它，这是一种耻辱。

您使用的是 .NET 3.5 吗？如果是这样，`TimeZoneInfo`该类是我们得到的最好的支持，但是从 Olson 名称转换为 Windows 名称可能会很棘手。理想情况下，您希望将 Olson ID 转换为 Windows 使用的 ID……但我不知道是否有可用的 ID。

编辑：经过一点点挖掘，几个链接：

*   [Chronos 项目具有 Win32 ID 和 Olson ID（](http://www.chronos-st.org/) [HTML](http://www.chronos-st.org/Windows-to-Olson.html)、[文本](http://www.chronos-st.org/Windows-to-Olson.txt)）之间的映射文件
*   Unicode 网站有一个[类似的映射文件](http://unicode.org/cldr/data/diff/supplemental/windows_tzid.html)

我不知道它们多久更新一次，但它们很可能是你最好的选择。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-05-28T02:22:41.317

Code Project 上有一个很棒的小 .Net 库，它完全符合您的需要：

[http://www.codeproject.com/KB/locale/zoneinfo_dotnet_api.aspx](http://www.codeproject.com/KB/locale/zoneinfo_dotnet_api.aspx)

[http://zoneinfo.codeplex.com/](http://zoneinfo.codeplex.com/)

我在几个与 Google API 对话的项目中使用它，因为它们的所有时区都是 ZoneInfo/Olsen 数据库格式。

我还写了一篇关于设置的博客文章：[http ://www.diaryofaninja.com/blog/2011/05/27/how-to-use-zoneinfotz-time-zones-in-net-applications](http://www.diaryofaninja.com/blog/2011/05/27/how-to-use-zoneinfotz-time-zones-in-net-applications)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T11:34:41.290

将其转换为格林威治标准时间？查找 +x hrs 或 -x hrs，然后从您存储的日期/时间中减去偏移量。例如。在您的示例中减去 10，因为墨尔本是 +10 GMT？

# eclipse - Eclipse 正在重命名我的 svn 存储库中的文件

> ID：661859
> 
> 赞同：3
> 
> 时间：2009-03-19T11:34:37.470
> 
> 标签：eclipse, svn, tortoisesvn

我在 svn 服务器上有一些存储库，其中包括一个 Eclipse 项目。在那些存储库中，它被放置在 bin 文件夹中，因为我有一些属性文件，如果不将它们放在那个文件夹中，我就无法运行程序。

现在，当我签出项目时，在 Eclipse 中导入项目并构建它，文件夹 bin 的 svn 条目被弄乱了。例如，在构建项目之前的“条目”文件中，我有“svn://address/project/bin”，但是在我构建该文件中的项目之后，出现了“svn://address/project/src”。

那么有人可以告诉我如何防止 Eclipse 弄乱我的 svn 文件吗？

编辑：我没有使用 Eclipse 插件。我使用 Tortoise SVN 获取文件。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-20T00:01:31.597

您能否在项目设置-> 构建路径下的源文件夹中设置排除项？

然后它不应该将 .svn 文件从 src 复制到 bin。

抱歉，目前无法测试以提供更准确的答案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T21:46:21.783

我无法编辑或评论 pmac72 的答案，所以这里有两种对我有用的排除模式：

1.  `.svn`
2.  `**/.svn/**`

在 Project->Properties->Java Build Path->[Source]->src->Excluded->Exclusion Patterns 下输入它们

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T11:39:51.670

如果您在 Eclipse 中安装了 SVN 集成插件（如 subclipse），并且您在包资源管理器中移动文件，那么它们将为您执行 SVN 移动操作。尽管据我所知，subclipse 在执行此类操作后不会自动提交。您可能进行了顶级提交并意外提交了所有动作。

# php - 使用 Smarty 将元素排列到列中

> ID：661861
> 
> 赞同：0
> 
> 时间：2009-03-19T11:34:52.273
> 
> 标签：php, smarty, template-engine

我有一个生成元素数组的 php 页面。为简单起见，假设它包含按数字顺序排列的数字 1-5。这些数字需要相等（或尽可能接近相等）分成两列（使用 html 表），如下所示：

```
1   4
2   5
3 
```

列数将来可能会发生变化。由于这是表示级别的更改，我认为它应该是可以通过仅在模板文件中进行更改来实现的。这向我表明，应该由 Smarty 将元素划分为列。

有没有办法通过 Smarty（以及如何）实现这一点，或者我应该让 php 文件完成所有工作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-19T12:10:35.760

可以在 smarty 中做到这一点，但由于 HTML 和 CSS 并不真正支持列，所以这样做很痛苦。它涉及计算数组中有多少项目，并首先使用 {section} 标签来获取项目的前半部分（向上取整），并将它们显示在一个列中，然后使用单独的 {section} 来获取第二个一半（四舍五入）的项目并将它们放在第二列。

对于 {section}，您可以指定从哪个数组索引开始以及需要多少项。如果将数组中的项目数设置为另一个变量，则只需计算即可。

您可以尝试这样的代码 - 但恐怕我还没有测试过这些计算，所以它可能是错误的......

```
<td>
  {section name=myitem loop=$items max=(($itemcount/2)+0.499)}
    {$items[myitem]}
  {/section}
</td>
<td>
  {section name=myitem loop=$items start=(($itemcount/2)+0.499)}
    {$items[myitem]}
  {/section}
</td> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-25T18:12:07.463

这是我使用 foreach 和迭代的解决方案：

```
<ul>
{foreach from=$items item=item name=firstFE}
            {if $smarty.foreach.firstFE.index lt ($items|@count / 2)}
               <li>{$item->title}</li>
            {/if}
{/foreach}
</ul><ul>
{foreach from=$items item=item name=secFE}
            {if $smarty.foreach.secFE.index gte ($items|@count / 2)}
               <li>{$item->title}</li>
            {/if}
{/foreach}
</ul> 
```

# c++ - 视频游戏中纹理流的 C++ 内存管理

> ID：661862
> 
> 赞同：21
> 
> 时间：2009-03-19T11:35:07.187
> 
> 标签：c++, memory-management, defragmentation

这是一个“难”的问题。我在网上没有发现任何有趣的东西。

我正在为我的公司开发一个内存管理模块。我们为下一代游戏机（Xbox 360、PS3 和 PC……我们将 PC 视为游戏机！）开发游戏。

未来，对于我们的下一款游戏，我们需要处理无法全部加载到主机内存中的大型游戏世界的纹理流传输（暂时不讨论 PC）。

我们将在开始时流式传输纹理的高分辨率 mipmap（大约是世界数据大小的 70%）。也许将来我们还必须流式传输几何、较小的 mipmap、音频等。

我正在为这个问题开发一个内存管理器，专注于 X360（因为在 PS3 上我们可以使用主机内存和相关的自动碎片整理 GMM 分配器）。

我面临的问题如下：我们决定为纹理流式传输保留一个特定的内存区域（例如 64 兆字节），并且我们希望处理该区域中的所有分配和解除分配。我们在应用程序开始时分配了该区域，并且该区域在物理上保证是连续的（不仅仅是虚拟的，因为我们需要在那里存储纹理）。

我实现了一个自动碎片整理分配器，使用句柄而不是指针。时间不是问题，问题是内存碎片。在游戏中，我们不断地加载和卸载流目标，因此我们希望使用我们的缓冲区的最大数量（64 兆字节）。

有了这个分配器，我们可以使用所有分配的空间，但是碎片整理程序在一个不可接受的时间内工作（有时 60 毫秒，超过一帧！）而算法还不错......有太多不可避免的 memcpy！

我正在寻找解决此问题的解决方案。我想至少找到一篇好论文，或验尸报告，或遇到与我相同问题的人。

现在我在两种策略之间进行选择：1）在专用线程上移动碎片整理例程（对于具有 6 个硬件线程的 X360 来说很好，对于只有一个硬件线程的 PS3 来说很糟糕......而且不要告诉我使用 SPU！）锁定区域的所有多线程问题，访问正在移动的区域，... 2）找到碎片整理问题的“增量”解决方案：我们可以给每个帧一个时间预算（例如最多 1 毫秒）进行碎片整理并且内存管理器将在每一帧的预算中做它可以做的事情。

有人能告诉我他的经历吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-19T12:14:12.227

我最近做了很多关于内存管理的研究，这是我在网上找到的最有用和最有用的文章。

[http://www.ibm.com/developerworks/linux/library/l-memory/](http://www.ibm.com/developerworks/linux/library/l-memory/)

根据那篇论文，您将获得的最佳和最快结果是将 64 MB 分成大小相等的块。块的大小将取决于您的对象大小。并一次分配或释放一个完整的块。它是

1.  比增量垃圾收集更快。
2.  更简单。
3.  并在一定程度上解决了“过多的碎片化”问题。

阅读它，您会发现关于每一种可能的解决方案以及每种解决方案的优缺点的优秀信息。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-20T19:47:02.230

为什么不按纹理大小为流纹理和池使用多个内存区域？

Insomniac 有一篇关于他们在 PS3 上实现纹理流的论文。我想它可能会有所帮助：[链接](http://www.insomniacgames.com/tech/articles/1107/texture_streaming.php)。

对于尽量减少碎片的一般分配策略，[Doug Lea](http://g.oswego.edu/dl/html/malloc.html)可能会有所帮助。

但是从我对您问题的阅读来看，听起来您想多了，我强烈建议您采用汇总方法。（此外，在写入组合内存上运行碎片整理过程听起来也不是特别安全或有趣。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-19T17:02:01.340

由于您使用的是句柄，因此您可以自由地移动内存。我认为使用单独的线程可能不是最好的（最安全或最快的）方式——我猜你最好使用一种增量复制分配器，在每个`malloc()`或`free()`你压缩的地方（在内存中向前或向后复制) 一些已分配块的数量，您复制的字节数会耗尽定期重置为其初始值的“预算”（例如，在每次屏幕刷新时）。（当然只复制整个块。）

这个想法是复制给定数量的字节需要相当可预测的时间，因此您可以估计每次屏幕刷新可以安全地执行多少字节的复制，并将自己限制在这个范围内。如果预算有足够的时间，调用`malloc()`或`free()`将完全整理内存，否则将在给定的时间限制内尽可能多地整理碎片。

这里有一些问题没有解决——例如，究竟如何压缩内存。标准的非增量复制分配器可以从前面开始分配，然后在内存用完时将所有内容复制到后面（释放前面的内存），但是您在这里没有这种自由。您可能需要一些启发式方法来决定是向前还是向后移动块。`malloc()`重要的是要避免振荡（相同的块在连续调用or时向前移动然后向后移动`free()`）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-07-12T14:13:09.710

我们几乎拥有您描述的系统，除了我们在固定大小的插槽中分配 - 256x256、512x512、1024x1024 和 2048x2048 纹理，每种格式有两种（DXT1 和 DXT5） - 正是为了避免内存管理。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-20T19:28:20.217

我会推荐一种增量方法。每个帧都找到一个连续的正在使用的内存块，该块两侧都有空闲空间，并将其移动到任何可以容纳的方向。或者您可以将所有块向一个方向移动，找到一个间隙和一个最适合它的正在使用的块并移动它。在 360 上，您可能应该使用线程来进行移动，而在 PS3 上，最好使用 GPU 来为您移动数据。

# embedded - 如何调试看门狗超时

> ID：661864
> 
> 赞同：11
> 
> 时间：2009-03-19T11:35:42.850
> 
> 标签：embedded, debugging, watchdog

我的微控制器中有一个看门狗，如果它没有被踢，将重置处理器。我的应用程序在一段时间内运行良好，但最终会重置，因为看门狗没有被踢。如果我逐步执行该程序，它可以正常工作。

有什么方法可以调试这个？

编辑：结论：我发现我的错误的方式是看门狗面包屑。

我正在使用具有高 ISR 向量和低 ISR 向量的 PIC。高向量用于处理 LED 矩阵，而低向量用于处理计时器滴答声。但是我将两个 ISR 处理程序都放在了高向量中。因此，当我禁用 LED 矩阵 ISR 并且计时器滴答 ISR 需要服务时，处理器将卡在低 ISR 以处理计时器滴答，但计时器滴答处理程序不存在。

面包屑将我的搜索限制在处理 LED 矩阵并专门禁用 LED 矩阵中断的函数上。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-19T11:46:42.807

添加一个未初始化的全局变量，该变量在整个代码中设置为不同的值。具体来说，在主要函数调用之前和之后设置它。

在 main 的开头放置一个断点。

当处理器重置时，全局变量仍将具有上次设置的值。继续添加这些“面包屑”以缩小问题功能。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-19T11:50:16.230

当您附加调试器时，许多软件看门狗会自动禁用（以防止在调试器暂停应用程序时重新启动）。

也就是说，这里有一些基础知识：

这是一个多线程应用程序吗？您使用的是 RT 调度程序吗？如果是这样，你的看门狗任务饿死了吗？

确保您的看门狗任务不会卡在任何事情上（挂起的信号量、等待消息等）。有时，函数会以您意想不到的方式阻塞；例如，我现在正在开发一个 Linux 平台，可以很容易地阻止 printf。

如果它是单线程的，分析器可以帮助您识别时序问题。

如果这是一个新系统，请确保看门狗工作正常；测试刚刚碰到 WD 然后进入无限循环的简单代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-19T13:22:41.797

我使用基于状态的编程，而我一直想使用的一个技巧是为二进制的当前状态保留一个输出端口。然后连接逻辑分析仪并查看状态变化的时间。你可以在这里做类似的事情：按照罗伯特所说的做，创建一个全局变量并在关键点更改它的值 - 最好使用一个立即将端口值设置为当前状态的函数（即 changeState(nextState); ）进入踢狗的函数时的状态，然后在离开函数之前将其更改回之前的状态。您应该能够从哪些功能中看到它没有被踢，然后您可以处理这些功能。

祝你好运，这听起来像是一个时间问题，而且很难解决。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-19T13:40:14.717

通常看门狗任务/线程以低优先级运行。所以如果看门狗没有被踢，这应该是因为处理器正忙于做其他事情——可能是它不应该做的事情。

在处理器重置之前为每个任务/线程转储执行上下文（本地堆栈、调度状态等）非常有用。如果有一点运气和工作，您将能够确定是什么阻止了看门狗任务启动计时器。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-23T01:17:17.600

我会使用一个额外的输出引脚，在代码中的适当点设置高然后低，以限制我正在寻找的范围。然后我会在数字示波器或逻辑分析仪上对其进行跟踪。这相当于另一张海报提到的面包屑方法，但您将能够更好地与复位脉冲进行时间相关。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-09-06T12:35:29.530

您可以在代码中插入一个 while 循环，并在 while 循环内切换一个 LED。这是检查板子是否正在复位的有效方法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-19T11:41:16.033

质疑你所做的每一个假设，两次：

*   确保看门狗*被*踢（我不知道处理器上的日志记录工具）。
*   确保看门狗在被踢时不会重置处理器。

并想知道“步入”和独自跑步之间有什么区别；时间限制肯定很重要。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-04-13T13:14:16.000

您可以将`strace`(option `-p`) 附加到正在运行的进程，观察它何时停止写入打开的文件描述符`/dev/watchdog`。您可以使用选项过滤`strace`输出`-e`。有关详细信息，请参阅手册页。

# msbuild - 将 Sandcastle 帮助文件生成器与 MSBuild 结合使用

> ID：661875
> 
> 赞同：3
> 
> 时间：2009-03-19T11:38:19.097
> 
> 标签：msbuild, sandcastle

如何让 Sandcastle Help File Builder 从使用 MSBuild 构建的项目中创建帮助文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-19T12:57:38.393

我有一个 MSBuild 目标，可以在我的构建脚本中构建我的文档。

该目标使用 Sandcastle Helpfile Builder。

它是这样完成的：

```
<Target name="builddoc" DependsOnTargets="buildall">

   <ItemGroup>
      <Assemblies Include="-assembly=$(outputdir)\myassembly.dll" />
      <Assemblies Include="-assembly=$(outputdir)\anotherassembly.dll" />
   </ItemGroup>

   <Exec Command="$(double_quote)$(SandcastleHFBCmd)$(double_quote) sandcastleproj.shfb$(double_quote) @(assemblies, ' ') outputpath=$(outdir)
</Target> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T20:23:01.630

查看[docproject](http://www.codeplex.com/DocProject) ，它是我们用来从 TFS 构建脚本中构建帮助文件的工具。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T12:49:58.693

查看 Sandcastle Help File Builder 使用的命令并将它们复制到您的构建过程中。

# c# - 字符串 '3/18/09 10:16 PM' 不是有效的 AllXsd 值

> ID：661881
> 
> 赞同：56
> 
> 时间：2009-03-19T11:41:13.850
> 
> 标签：c#, xml, parsing

显然，读者不喜欢这种从响应 XML 传入的格式。

想知道我是否可以重新格式化。尝试将`DateTime`以下代码转换为与我一起使用`XmlReader`：

```
reader.ReadContentAsDateTime(); 
```

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2009-03-19T11:48:58.823

根据 XML[模式](http://www.w3.org/TR/xmlschema-2/#dateTime)规范，日期时间值应采用 ISO8601 格式，例如，类似

```
2009-03-13T22:16:00 
```

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2009-03-19T11:46:36.737

Xml 阅读器通常期望日期/时间采用非常特定的格式；您可以自己使用`XmlConvert`：

```
string s = XmlConvert.ToString(DateTime.Now);
DateTime when = XmlConvert.ToDateTime(s); 
```

如果您正在使用其他内容，则必须将其作为字符串读取并使用`DateTime.TryParseExact`（或类似方法）指定实际的格式字符串：

```
string s = reader.ReadContentAsString();
DateTime when = DateTime.ParseExact(s, "M/d/yy hh:mm tt",
     CultureInfo.InvariantCulture); 
```

如果您正在使用`XmlSerializer`，您可以使用 shim 属性进行转换 - 如果您正在这样做，请告诉我...

# jsp - 如何使用 include 指令根据请求属性包含文件

> ID：661882
> 
> 赞同：1
> 
> 时间：2009-03-19T11:41:15.190
> 
> 标签：jsp, jstl, directive

我想根据请求属性值包含一个文件。

```
${theme} -> themeA 
```

总结一下。我想要这样的东西：

```
<%@ include file="../themes/${theme}/jsp/content/welcome.jsp"%> 
```

任何简单的解决方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T18:35:28.650

```
<c:import url="../themes/${theme}/jsp/content/welcome.jsp"/> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-19T22:22:21.383

不适用于 <%@ include%> 因为那是静态/编译时包含。您可以改为使用 <jsp:include> 标记，该标记在运行时进行评估，并包含执行该页面的*结果*，而不是在编译时包含页面本身。

要比较 include 指令和 <jsp:include> 之间的所有差异，请查看[JSP2.0 参考](http://java.sun.com/products/jsp/syntax/2.0/syntaxref20.html)

```
<jsp:include page="../themes/${theme}/jsp/content/welcome.jsp"> 
```

如果您使用 JSTL，<c:import> 标记也可以使用。

# asp.net - 生成临时文件的 ASPX 解析器/预编译器

> ID：661885
> 
> 赞同：4
> 
> 时间：2009-03-19T11:41:28.233
> 
> 标签：asp.net

有没有办法在将 ASPX 文件预编译为临时文件之前对其进行更改。

即删除空格和新行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-20T01:40:15.883

是的，有，但这并不容易，可能不值得你费心。

一种方法是创建自己的 BuildProvider 并在配置文件中用它替换默认的 System.Web.Compilation.PageBuildProvider：

```
<compilation debug="true">
    <buildProviders>
        <add extension=".aspx" type="MyProject.MyPageBuildProvider" />
    </buildProviders>
</compilation> 
```

您还将创建自己的 PageParser，很可能继承自 TemplateParser。BuildProvider 负责提供 PageParser。在最原始的情况下，您可以覆盖 ParseFile 方法、读取 ASPX 文件、处理它、创建副本并将其传递给基本方法。

不幸的是，所有 ASPX 解析代码都是密封的，并且在 MS 库内部，因此您无法继承。重写它意味着构建整个编译引擎。

另一种方法是创建您自己的页面构建器并将其放入属性中。缺点是您只能轻松访问第一级（页面）的文字（所有空格等）。要获得内部控件及其文字，您必须使用反射破解解析器或（适当地）操纵代码域。这样，您将获得正确构建的 .cs 文件和临时程序集。

这是一个简化的示例：

```
namespace MyProject
{
    [FileLevelControlBuilder(typeof(MyPageBuilder))]
    public partial class _Default : System.Web.UI.Page
    {
        //this is Default.aspx
    }

    //The builder of the page
    public class MyPageBuilder : FileLevelPageControlBuilder
    {
        //This is where you'd strip white space, but only of top level,
        //such as between the head and form, or form and the end of file
        public override void AppendLiteralString(string text)
        {
            //let's replace some white spaces with garbage
            base.AppendLiteralString(text.Replace(" ", "#").Replace("\t", "@").Replace("\r", "$").Replace("\n", "%"));
        }

        //Here you can manipulate the entire generated code using CodeDom
        public override void ProcessGeneratedCode(System.CodeDom.CodeCompileUnit codeCompileUnit, System.CodeDom.CodeTypeDeclaration baseType, System.CodeDom.CodeTypeDeclaration derivedType, System.CodeDom.CodeMemberMethod buildMethod, System.CodeDom.CodeMemberMethod dataBindingMethod)
        {
            base.ProcessGeneratedCode(codeCompileUnit, baseType, derivedType, buildMethod, dataBindingMethod);
        }

        //Alternatively, you can "hack" the PageParser here using reflection
        //However, the _text field at this point is irrelevant, so it can't be used
        public override void Init(TemplateParser parser, ControlBuilder parentBuilder, Type type, string tagName, string ID, System.Collections.IDictionary attribs)
        {
            FieldInfo fi = parser.GetType().BaseType.BaseType.BaseType.GetField("_text", System.Reflection.BindingFlags.FlattenHierarchy | System.Reflection.BindingFlags.Instance | System.Reflection.BindingFlags.NonPublic);
            string s = (string) fi.GetValue(parser);
            fi.SetValue(parser, s.Replace("\t", "*"));

            base.Init(parser, parentBuilder, type, tagName, ID, attribs);
        }
    }
} 
```

在我看来，这不值得努力。

**编辑**错字

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T14:02:05.023

我建议不要在构建时执行此操作，而是在运行时执行此操作。您可能有足够的处理器速度来处理 HTML 的生成。我的目标是节省带宽。

我肯定会将您的网络服务器设置为将页面作为压缩文件 (GZip) 发送出去

在应用程序方面，您可以构建过滤器，这些过滤器将获取最终呈现的 HTML 页面并执行您所说的过程，删除空格等。

您可以构建一个 ISAPI 过滤器，这是较旧的更难的方法。

或者您可以创建 Stream 过滤器并覆盖 write 方法。将[HttpResponse.Filter 属性](http://msdn.microsoft.com/en-us/library/system.web.httpresponse.filter.aspx)设置为您的流过滤器。这是一个简单的[例子](http://aspnet.4guysfromrolla.com/articles/120308-1.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T11:58:47.753

如果您提供一些背景来说明您*为什么*要这样做，这可能会有所帮助。

如果，正如我所怀疑的那样，当用户查看源代码时，html 的布局很好，你可以让 Visual Studio 使用和弦 ctrl+k、ctrl+d 来整理你的 html。

希望这可以帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-19T12:11:07.833

ASPX 文件**不会**被“编译”成 HTML。ASPX 页面是声明性代码。所有内容均以 .NET 可执行代码编译。

如果您想节省带宽，删除空格等，请考虑使用**IIS 压缩**（GZIP 等）。这是[Jeff Atwood 撰写的关于 IIS 6.0 中压缩的博客文章，](http://www.codinghorror.com/blog/archives/000059.html)其中解释了详细信息。一个更困难的选择是编写一个 HTTPModule。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-19T12:13:28.203

根据您对 thedorko 帖子的评论，您可能希望查看 GZIP / deflate 以压缩呈现的 html。

看看[这个例子](http://www.stardeveloper.com/articles/display.html?article=2007110401&page=1)

# c# - 以下情况下有关线程注意事项+设计的任何提示

> ID：661904
> 
> 赞同：2
> 
> 时间：2009-03-19T11:47:24.660
> 
> 标签：c#, multithreading, assemblies

我正在编写一个将提供一些异步处理的类库，并希望尝试避免以后遇到线程问题。因此，我寻求人们可以提出的任何建议以避免以后遇到问题，而是从一个好的设计开始。

我可以看到的一些情况可能会导致问题，并且不一定确定最佳解决方法：

1) 我有一个接受 IEnumerable 并使用 ToList 构造 IList 的类。T 是在我的程序集中声明为公共的类。在启动异步进程时，此 IList 用于创建新集合，但是此时调用程序集可能正在修改用于生成我的新内部集合的原始 T。

2) 我有一个布尔属性，我希望用户在轮询循环中使用它。我相当确定在我的程序集中设置属性不会有问题？

3）我经常使用需要在两个单独的线程上使用的内部集合。我目前正计划使用同步集合并在需要副本时克隆它......虽然我希望这不会太慢。

4）在我的异步方法中，我希望在进度或状态发生变化时触发事件。从处理线程触发事件时，我需要注意什么吗？再次使用其中的一些，我需要传递一个变量，该变量将被视为处理线程内部使用的东西的克隆，以尝试避免用户更改它时出现任何问题。

提前感谢您的任何帮助！

伊恩

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T11:55:11.600

1）如果可能的话，尽量让你的类型不可变。如果这不可能，您需要进行适当的锁定。

2）制作底层变量`volatile`，以便在所有线程中看到更新

3) 我们需要更多信息才能做出明智的评论。

4) 事件处理程序需要知道它们可以在多个线程上调用。如果您需要能够订阅和取消订阅来自不同线程的事件，您还应该查看完全[线程安全的事件模式。](http://www.yoda.arachsys.com/csharp/threads/lockchoice.shtml)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T11:56:53.173

2：当心`volatile`（例如为什么[看这里）；](https://stackoverflow.com/questions/458173/can-a-c-thread-really-cache-a-value-and-ignore-changes-to-that-value-on-other-th/458193#458193)并且不要做一个“紧密”的循环。信号（例如 Monitor.Pulse 或 ManualResetEvent 等）通常是首选

4：如果这是出于显示目的，您需要将它们编组回 UI 线程

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T12:31:25.663

多谢你们，

1) 不幸的是，我认为让我的类型不可变是行不通的，所以我可能不得不锁定它们。幸运的是，它只是在异步方法的初始设置期间，因为我出于各种原因创建了大多数类实例的简化内部副本，此时我不在乎用户对原始文件做了什么。

2) volatile 关键字看起来像是我绝对需要的东西，所以将其放入。

3) 我将运行两个线程，它们都需要访问 Collection<U>。一旦他们获得了这个集合，他们就会广泛使用它，并且还会修改每个 U 实例的各种属性。完成后，他们将保存一些简单的属性（例如 Guid），将集合扔掉并需要重新开始。因此，我认为应该首先创建一个 ReadOnlyCollection< U>，然后在处理开始时为每个线程运行某种形式的 Clone 方法，并将输出转换为新的 IList< U>他们正在做的例子。

4）这很有用 Jon，事件处理可以从多个线程调用，所以我肯定会使用这些方面的东西。

# c++ - VC++：如何防止 esc 关闭对话框（不是 mfc）

> ID：661907
> 
> 赞同：1
> 
> 时间：2009-03-19T11:48:31.337
> 
> 标签：c++, windows, visual-c++, dialog

如何防止 esc 关闭对话框？

我搜索了这个主题，但我发现的只是 MFC（您可以覆盖 MFC 中的 PreTranslateMessage 函数）。但我的程序是用 Windows API 编写的，**而不是 MFC**。

我试图在 Dialog 过程中捕获所有键盘消息，但它们都不起作用。我也尝试在对话框中使用子类化，但也没有用。

我怎么能那样做？谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-19T11:50:03.173

处理 WM_COMMAND 并检查 IDCANCEL。然后不要将控件传递给默认窗口过程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T04:19:32.913

您可以很容易地确定它是否来自系统菜单——查看[此 MSDN 页面](http://msdn.microsoft.com/en-us/library/ms647591(VS.85).aspx)的“返回值”部分以了解如何。

如果您无法确定它是来自 ESCAPE 键还是按钮，您总是可以通过为 Cancel 按钮使用不同的标识符来解决这个问题。

# sql-server - 选择/更新或多选之间的 SQL Server 死锁

> ID：661908
> 
> 赞同：41
> 
> 时间：2009-03-19T11:48:37.437
> 
> 标签：sql-server, sql-server-2005, deadlock

所有关于 SQL Server 死锁的文档都讨论了操作 1 锁定资源 A 然后尝试访问资源 B 并且操作 2 锁定资源 B 并尝试访问资源 A 的场景。

然而，在我们的一些繁忙的应用程序中，我经常看到选择和更新之间甚至是多个选择之间的死锁。我发现死锁跟踪输出的一些更好的点非常难以理解，但我真的很想了解什么会导致两个单一操作之间的死锁。当然，如果选择具有读锁，则更新应该在获得排他锁之前等待，反之亦然？

这发生在 SQL Server 2005 上，我认为这并不重要。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-25T14:08:40.910

发生这种情况是因为选择锁定了两个不同的索引，同时更新以相反的顺序锁定了相同的索引。select 需要两个索引，因为第一个索引没有覆盖它需要访问的所有列；更新需要两个索引，因为如果您更新索引的键列，您需要锁定它。

[http://blogs.msdn.com/bartd/archive/2006/09/25/770928.aspx](http://blogs.msdn.com/bartd/archive/2006/09/25/770928.aspx)有一个很棒的解释。建议的修复包括添加一个涵盖选择需要的所有列的索引、切换到快照隔离或显式强制选择获取它通常不需要的更新锁。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2010-06-07T22:57:53.330

我很惊讶没有人提到`WITH (UPDLOCK)`锁定提示。如果您遇到涉及例如两个并行运行的选择插入对的死锁，这将非常有用。

在 SQL Server 中，如果您使用 发出选择`WITH (UPDLOCK)`，则第二个选择将等到第一个选择完成。否则它们会获得共享锁，并且当它们同时尝试升级到独占锁时，它们会死锁。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-06-18T12:00:02.093

我的猜测是 select-statement aquires a read-lock，当您使用 update-statement 时，它需要升级到 write-lock。

升级到写锁需要删除所有其他读锁（它们的选择事务完成）。但是，如果另一个进程已经有了升级到写锁的绝妙主意，那么你突然有两个进程在等待对方释放读锁，因此它们可以获得写锁。

如果使用 select-for-update (UPDLOCK)，那么它将从一开始就获得一个写锁，然后您就不会遇到死锁问题。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-19T12:29:35.027

单个查询之间的锁定可能发生在它们锁定单个行而不是整个表时：

更新查询在表中的几行上获得更新锁，而选择查询在表中的其他一些行上获得读锁。然后，更新查询尝试在读锁定的行上获取更新锁，而选择查询尝试在更新锁定的行上获取读锁。

升级锁可能会变得更加复杂，即数据库决定有太多单行被事务锁定，因此应该升级为锁定表的一部分或整个表。这意味着锁可能会影响查询中不直接涉及的行。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-19T12:16:00.413

正确阅读事务和隔离级别：对于一些密集但相当彻底和技术中立的工作，请参阅[事务处理原理](https://rads.stackoverflow.com/amzn/click/com/1558604154)。它震撼了我的世界（让我头疼不已！）。

我不确定您遇到了什么问题，或者您使用的是什么隔离级别。但是考虑一下：数据库引擎都知道，如果您在一个事务中进行读取，它如何判断您以后是否要进行写入？每当读取完成时，高隔离级别都需要锁定，可能在整个表上以防止幻读，因为数据可能会影响以后的写入。

您是否希望数据库等待任意长的时间才能对您的数据进行独占锁定？看看你的隔离级别，以及你是否不必要地将一系列读取作为隔离事务运行。但是，要确定您可以忍受的肮脏阅读并不总是那么容易，但是...

# ruby - 复制文件时Ruby显示进度

> ID：661909
> 
> 赞同：9
> 
> 时间：2009-03-19T11:48:58.213
> 
> 标签：ruby, file, file-io, copy, progress

我希望能够在使用 Ruby 复制文件时显示文件复制操作的进度（当前使用 FileUtils.cp）我尝试将`verbose`选项设置为，`true`但这似乎只是向我显示了发出的复制命令。

我目前正在从命令行运行这个脚本，所以理想情况下我希望能够呈现像 SCP 在复制文件时所做的那样，但只要我能看到进度，我就不会太在意演示文稿.

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-19T14:09:50.670

由于我没有足够的代表来编辑答案，但这里是我基于 pisswillis 答案的版本，我发现了一个[进度条 gem](http://0xcc.net/ruby-progressbar/index.html.en "进度条宝石")，我也在我的示例中使用它。我已经对此进行了测试，到目前为止它运行良好，但它可以做一些清理工作：

```
require 'rubygems'
require 'progressbar'

in_name     = "src_file.txt"
out_name    = "dest_file.txt"

in_file     = File.new(in_name, "r")
out_file    = File.new(out_name, "w")

in_size     = File.size(in_name)
# Edit: float division.
batch_bytes = ( in_size / 100.0 ).ceil
total       = 0
p_bar       = ProgressBar.new('Copying', 100)

buffer      = in_file.sysread(batch_bytes)
while total < in_size do
 out_file.syswrite(buffer)
 p_bar.inc
 total += batch_bytes
 if (in_size - total) < batch_bytes
   batch_bytes = (in_size - total)
 end
 buffer = in_file.sysread(batch_bytes)
end
p_bar.finish 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-19T12:34:56.653

使用 IO.syswrite、IO.sysread 自行开发。

首先，确定进度条的长度（以字符为单位）.. 然后这个伪代码应该这样做（未测试）：

```
infile = File.new("source", "r")
outfile = File.new("target", "w")

no_of_bytes = infile.length / PROGRESS_BAR_LENGTH

buffer = infile.sysread(no_of_bytes)
while buffer do
 outfile = syswrite(buffer)
 update_progress_bar()
 buffer = infile.sysread(no_of_bytes)
end 
```

其中 update_progress_bar() 是将进度条增加一个字符的方法。以上内容未经测试，可能会使 ruby​​ 纯粹主义者生病。特别是 EOFException 可能会打乱循环。如果 no_of_bytes 不是整数，您还需要某种方法来确保写入所有字节。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-19T13:49:08.707

或者你可以直接破解它来使用 scp，如果这是你喜欢的进度条：

```
def copy(source, dest)
  `scp #{source} localhost:#{dest}`
end 
```

您必须确保源名称和目标名称已正确转义以进行系统调用。该`localhost:`标签使 scp 像在计算机之间一样复制文件，因此它将显示一个进度条。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-25T12:12:45.583

在 Windows 下不要忘记为二进制文件添加 'b'，所以对于二进制文件，'w' 和 'r' 应该是 'wb' 和 'rb'。

```
in_file     = File.new(in_name, "rb")
out_file    = File.new(out_name, "wb") 
```

# listview - 将 SharePoint 列表表单自定义为部分/选项卡/页面

> ID：661913
> 
> 赞同：4
> 
> 时间：2009-03-19T11:49:12.457
> 
> 标签：listview, sharepoint, sharepoint-designer

我有一个 SharePoint 解决方案，它使用包含大约 20 条不同数据的列表。我希望能够将它们分解为部分/页面/选项卡，以便用户在填充和编辑这些时的体验不会那么差。

我知道如何使用 SPD（SharePoint Designer）自定义列表表单，并且想知道是否有人知道实现此目的的技术。

我看过使用 MultiView 控件，但这似乎会破坏表单中的渲染。

欢迎提出想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T20:52:55.777

您*可以*创建一些 Javascript 以在必要时隐藏字段，但要做到正确将是一个艰难的过程。为数据创建自定义 .NET 表单并使用对象模型存储列表数据可能更容易。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-07T07:11:57.883

尝试使用表单设计器工具：[http](http://spform.com) ://spform.com 。它允许您使用基于 jquery-ui 选项卡的选项卡创建丰富的动态表单。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-21T19:38:10.853

我可能会修改当前表单并添加显示或隐藏的 div 标签，通过 javascript，基于某处的点击。这将完全避免额外的 .NET 代码，因此可能会避免您看到的多视图问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T19:47:14.420

jQuery UI 有一个不错的[选项卡控件](http://docs.jquery.com/UI/Tabs)，您可以利用它与一些验证相结合，以确保如果用户尚未填写所有页面，则不会提交表单。在附加 jQuery 之前，您需要将现有表单拆分为单独的`div`-wrapped 表。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-03-12T00:25:32.180

您可以尝试使用[PowerForms](http://www.bpc.gr/default.aspx?page=products-and-solutions/sharepoint/bpc-power-forms/en)。它支持标签和自由控制定位（使用silverlight）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-23T08:14:31.833

我遇到了[这种](http://www.nothingbutsharepoint.com/2011/01/18/tabs-for-sharepoint-forms-aspx/)将表单拆分为选项卡的 javascript 方式。可能对你有用吗？点击[图片](http://i.stack.imgur.com/oQmQI.png)（因为我还不允许发布图片......）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-10T18:33:39.217

信息路径表单支持这一点，但您必须将它们部署在表单库而不是列表中。您可以根据表单中的其他字段过滤重复部分，并仅显示基于您之前选择的字段。这是最简单的方法，不确定您是否已将 InfoPath 和服务器/许可设置为使用 infopath 表单？

# visual-studio - 模仿eclipse环境的Visual Studio插件

> ID：661918
> 
> 赞同：3
> 
> 时间：2009-03-19T11:50:25.527
> 
> 标签：visual-studio, eclipse

我使用 eclipse 开发环境已经快 3 年了。现在我即将转向 C# 和 Visual Studio IDE。

有谁知道模仿 Eclipse 环境的 Visual Studio 的免费/开源插件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T11:57:12.907

ReSharper (jetbrains) 是一个很好的插件，可以增强 VisualStudio。但是它不是免费/开源的。尽管如此，它确实物有所值！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-07T03:56:33.017

我同意lewap。如果您在 Visual Studio 上使用 C# 进行编码，Resharper 几乎是必不可少的。Resharper 添加了许多 Visual Studio 所没有的内置重构和快捷方式。虽然它不是免费的，但从长远来看可以为您节省大量时间的东西，价格也不算太差（商业 349 美元，个人 199 美元）。

# svn - Mac 上的 Subversion - 拒绝从钥匙串中获取密码

> ID：661923
> 
> 赞同：9
> 
> 时间：2009-03-19T11:52:35.570
> 
> 标签：svn, macos, keychain

在 Mac OS X Leopard 上 - 当我尝试从终端访问远程存储库时，它总是要求：1\. 密码 2\. 用户名 3\. 密码（再次）

带有消息：“身份验证领域：[http](http://svn.myserver.com:80) ://svn.myserver.com:80 Subversion”

我已经检查过了，我的凭据存储在钥匙串中，SVN 可以访问它们。为什么不使用它们？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2011-10-19T00:59:14.090

我通过递归更改颠覆身份验证目录的所有者解决了这个问题：

`sudo chown -R myuser:staff ~/.subversion/auth/`

（以前的*用户：组*对设置为`root:staff`）

您还需要设置`password-stores = keychain`颠覆配置文件：

`~/.subversion/config`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-19T16:32:15.747

默认情况下，`svn`（和大多数 Unix 应用程序）将您的本地用户名作为远程登录的用户名。我怀疑您在 Subversion 服务器上的帐户名与您的本地帐户名不同。因此，当您第一次输入 Subversion 密码时，身份验证会失败，并且`svn`像大多数 Unix 应用程序一样，然后会询问远程用户名和密码并尝试重新进行身份验证。您可以使用以下`--username`选项传递远程用户名`svn`：

```
svn --username [remote_username] ... 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-03T12:39:52.937

从 ssh 窗口运行 svn 命令时，我遇到了同样的问题。根据上面的一些评论，我删除了 ~/.subversion/auth/svn.simple 下的关联文件，然后直接在 OSX 框上从终端会话运行我的 svn 命令，这会弹出一个窗口，询问我是否要授予权限svn 来读取我的钥匙串。我永远授予它权限，现在我的 ssh 窗口中的 svn 命令可以正常工作，而不会提示我输入密码。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-06-07T09:49:19.707

我通过删除相应的身份验证文件解决了这个问题`~/.subversion/auth/svn.simple`（使用 grep 找到正确的身份验证文件，因为它们被命名为 fun）。然后在该存储库中的下一个 svn up 之后（svn 询问用户名和密码）它现在可以正常工作。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-06-22T13:45:58.933

从线程中尝试了很多东西，这对我有用：

*   取消`password-stores = keychain`评论`~/.subversion/config`
*   结帐/更新您的回购，输入凭据。
*   打开钥匙串应用程序，在登录钥匙串中找到带有存储库地址的行，双击它（或每个），选择访问控制选项卡并选中“允许所有应用程序访问此项目”

在那次颠覆之后，终于记住了我的凭据。

顺便说一句，当我从默认终端切换到 iTerm2 + zsh + oh my zsh 时，这个问题就开始了

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-19T23:48:08.900

你能提供更多信息吗？直到 Subversion 1.4.x 才添加密码的钥匙串缓存。你有什么错误吗？我们需要更多信息来提供帮助。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-01-19T19:38:30.533

我在 OS X 上遇到了类似的问题，其中 SVN 只是拒绝使用我存储的凭据，尽管它们在钥匙串中明确注册并授予 svn 访问权限。

原来我的`~/.subversion/auth`目录有奇怪的权限。

`sudo chmod 777 ~/.subversion/auth`解决了我的问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-03-15T05:30:41.730

I don't have the answer, but I notice that if I'm logged into my machine locally, then subversion will read the keychain password, but if I ssh into the mac from a remove machine, then subversion will not read the keychain password.

Seems that the ssh login puts the svn command in an environment which does not have access to the keychain...

Could that be your issue?

# jquery - 如何访问放入可排序的可拖动元素的ID

> ID：661927
> 
> 赞同：17
> 
> 时间：2009-03-19T11:54:46.423
> 
> 标签：jquery, jquery-ui, jquery-ui-draggable, jquery-ui-sortable

我正在使用 JQuery 库来实现拖放。

当它被放入可排序列表时，如何获取正在拖动的元素？

我想获取被拖动的 div 的 id。拖动以下元素：

```
<div class="control" id="control[1]" >
  <img src="img/controls/textfield.png" />
</div> 
```

我有他们示例中的标准拖动功能

```
$(".control").draggable({
  connectToSortable: '#sortable',
  helper: 'clone'
}); 
```

功能在拖动部分停止，下一个代码返回正确的值

```
stop: function(event, ui) {
  alert(ui.helper.attr('id'));
} 
```

这是可排序的元素：

```
<ul id="sortable"><li>test</li></ul> 
```

和他的功能：

```
$("#sortable").sortable({
  revert: true,
  accept: '.control',
  receive: function(event, ui) { 
    // here i need to get draggable element id
  }
}); 
```

我尝试了各种似乎不起作用的 ui.id 等。

```
receive: function(event, ui) { 
  $(ui.draggable).attr("id")
} 
```

抛出`undefined`。

* * *

**更新**：

抱歉，我的错 :) 正如我妈妈常说的那样——“在编码之前阅读 API”。`ui.item.attr('id')`工作正常。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-03-19T12:11:53.370

尝试

```
receive: function(event, ui) { 
  $(ui.item).attr("id")
} 
```

根据文档，接收（实际上是*所有*可排序的回调）有两个参数。第二个参数应包含：

*   ui.helper - 当前的帮助元素（通常是项目的克隆）
*   ui.position - 助手的当前位置
*   ui.offset - 助手的当前绝对位置
*   ui.item - 当前拖动的元素
*   ui.placeholder - 占位符（如果您定义了一个）
*   ui.sender - 项目来自的可排序对象（仅当您从一个连接列表移动到另一个列表时才存在）

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2010-08-18T15:49:16.320

似乎`context`ui.item 在`beforeStop`事件和`receive`事件之间发生了变化。

在我的情况下，我试图将项目的 id 设置为生成的值和

```
receive: function (event, ui) { ui.item.attr("id", "control" + currentControlId++);} 
```

不适合我

所以你可以解决这个问题：

```
beforeStop: function (event, ui) { itemContext = ui.item.context;},
receive: function (event, ui) { $(itemContext).attr("id", "control" + currentControlId++);} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-01T15:18:45.163

我遇到了类似的问题，并且在访问启动事件中的帮助器元素时遇到了麻烦。我最终做的是将 helper 属性设置为返回一些自定义 HTML 的函数。我能够在开始事件中访问该 HTML 而没有任何问题。

```
helper: function() {
    return '<div id="myHelper">This is my custom helper.</div>';
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-19T12:13:32.587

来自 jQuery UI 可拖动文档：

> 如果您不仅想拖动，还想拖放，请参阅 jQuery UI Droppable 插件，它为可拖动对象提供了放置目标。

请参阅[http://docs.jquery.com/UI/API/1.7/Droppable](http://docs.jquery.com/UI/API/1.7/Droppable)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-19T05:19:49.887

我成功使用了可排序的**beforeStop**事件。

从[这里](http://jqueryui.com/demos/sortable/#event-beforeStop)

> **beforeStop**：当排序停止时触发此事件，但当占位符/助手仍然可用时。

```
$( "#something" ).sortable({
  beforeStop: function(event, ui) {
     //you should check if ui.item is indeed the one you want!
     item_id = $(ui.item).attr('id');
     $(ui.item).html('I'm changing the dropped element in the sortable!');
  }
}); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-04-08T00:28:50.560

是的，当你混合 sortables draggables droppables 等时，这是一个问题。将可排序容器也设为 droppable：

```
$("#sortable").sortable({
  revert: true,
  accept: '.control',
  receive: function(event, ui) { 
    // here i need to get draggable element id
  }
});

$('#sortable').droppable({
    accept: '.control',
    drop: function(e, ui){
        var your_draggable_element = $(ui.draggable);
        var your_helper = $(ui.helper);
    }
}); 
```

那应该工作

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-01-20T16:24:43.423

Seems a bit hacky - but worked it out! I have to use $('.dragrow1 li:last')

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-09-13T08:35:52.193

您可以使用自定义数据属性来存储拖动项目的 id。该属性仍然存在于掉落的物品上。源代码如下：

```
<div class="..." data-id="item_id">
    ...
</div> 
```

在 sortable 中使用`$('dropped item").data('id')`来获取 id，如：

```
$("#sortable").sortable({
  ...,
  receive: function(e, ui) { 
      var id = ui.item.data('id');
  }
}); 
```

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2014-05-14T02:34:11.953

```
$( "#sortable1" ).sortable({
  connectWith: ".connectedSortable",
  cancel: ".disabledItem",
  items: "li:not(.disabledItem)",
  receive: function(event,ui){

  **var page = ui.item.attr('value');**

  var user = $("#select_users").val(); 
```

# macos - 如何从 shell 检测 Mac OS X 中的当前语言环境

> ID：661935
> 
> 赞同：10
> 
> 时间：2009-03-19T11:56:13.207
> 
> 标签：macos, locale

我需要从命令行检测 OS X 中的当前语言环境。在 Linux/Unix 上，我可以依赖 LANG，但并不总是设置：

[http://henrik.nyh.se/2007/10/displaying-utf-8-correctly-in-leopard-terminal](http://henrik.nyh.se/2007/10/displaying-utf-8-correctly-in-leopard-terminal)

我正在寻找可以让我找到该信息的命令行实用程序或 AppleScript 代码。理想情况下，它们将从 10.2 开始工作

到目前为止我发现的最接近的是

```
defaults read -g AppleLocale 
```

从 10.3 开始工作

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-19T12:00:18.280

apropos 发出命令`locale`

10.4 及更高版本

编辑：

```
defaults read .GlobalPreferences AppleLanguages | tr -d [:space:] | cut -c2-3 
```

[这里](http://macscripter.net/viewtopic.php?id=24915)提到。虽然我无法访问 10.2 系统，所以我不知道它是否有效。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-19T12:03:16.167

```
locale 
```

或者如果那不负责任

```
env | grep LC_ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-24T14:13:54.357

```
export LANG=$(defaults read -g AppleLanguages | \
  sed '/"/!d;s/["[:space:]]//g;s/-/_/').UTF-8 
```

# spring - 如何在spring/jsf中枚举和初始化bean

> ID：661938
> 
> 赞同：2
> 
> 时间：2009-03-19T11:57:35.307
> 
> 标签：spring, jsf, javabeans

在我的用户登录后，我想枚举所有 bean faces-config 并选择性地初始化一些 bean，这样做的最佳方法是什么？bean 在应用程序会话开始时由 spring 初始化，但不仅仅是在登录过程（通过 JAAS）完成之后。我想我在问如何枚举你的 faces-config 文件中列出的 bean。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T12:27:23.147

你能否改写你的问题，我真的不明白你想要做什么......

Spring 通常负责为您初始化 bean。您可以像这样定义初始化方法：

```
<bean name="myBean" class="foo.bar.MyBean" init-method="initialize" scope="..."/> 
```

和 ：

```
public class MyBean {
    ...
    public void initialize() {
        // This method will be executed once the bean is created by Spring.
    }
} 
```

# download - 我在哪里可以下载 Cygwin 的离线安装程序？

> ID：661939
> 
> 赞同：77
> 
> 时间：2009-03-19T11:58:05.370
> 
> 标签：download, cygwin, offline

我需要一个带有大多数常用实用程序的离线安装程序。不知何故，默认安装程序让我对它的所有包选择感到困惑。我安装了 Cygwin，但安装后找不到该`diff`实用程序。

* * *

## 回答 #1

> 赞同：144
> 
> 时间：2009-03-19T14:27:26.523

以下是假设您想在没有 Internet 连接的计算机上安装 Cygwin 的说明。我假设您可以通过 Internet 连接访问另一台*计算机*。在连接的计算机上启动：

*   获取 Cygwin 安装程序（“setup.exe”）。直接下载网址：[x86](http://www.cygwin.com/setup-x86.exe)或[x86_64](http://www.cygwin.com/setup-x86_64.exe)。

*   当安装程序询问“选择下载源”时，选择**下载而不安装**

*   完成其余设置（选择下载目录、镜像、所需的软件包等）

*   现在您的硬盘上有一个 Cygwin 存储库。将此目录与“setup.exe”程序一起复制到您的目标计算机（它不需要在网络上）。

*   在目标计算机上，运行“setup.exe”

*   当安装程序询问“选择下载源”时，选择**从本地目录安装**

*   像往常一样完成设置。无需访问 Internet。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2013-09-16T13:24:06.803

1.  **[从http://cygwin.com/mirrors.html](http://cygwin.com/mirrors.html)**选择离您最近的镜像服务器

*选择任何 FTP 或 HTTP 镜像。*

2.  下载整个镜像，维护镜像中 cygwin 目录的精确文件树结构。

    **编辑：**如何下载整个镜像？

    ```
    wget -m <ftp-mirror-url> 
    ```

3.  执行 setup.exe 并选择源作为本地目录并浏览到发布目录。

现在您有了**离线 Cygwin 安装程序**。

**更新：**使用 Babun。它基于 cygwin 并且更加用户友好。 [得到巴本](https://babun.github.io/)

**更新 2：**将[cmder](https://cmder.net/)与[git 一起用于 windows](https://gitforwindows.org/)。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2009-03-19T12:01:31.647

如果你想要的只是 UNIX 命令行工具，我建议不要安装 Cygwin。Cygwin 想要将您的 Windows PC 变成一个 UNIX 工作站，这就是它喜欢安装所有软件包的原因。

看看[GnuWin32 吧](http://gnuwin32.sourceforge.net/)。它是命令行工具的 Windows 端口，仅此而已。这是[GnuWin32 的安装程序`diff.exe`](http://gnuwin32.sourceforge.net/packages/diffutils.htm)。[所有常用工具](http://gnuwin32.sourceforge.net/packages.html)都有离线安装程序。

（您要求离线安装程序，但如果您以后想要一个，有[一个工具可以为您下载和安装所有内容](http://sourceforge.net/project/downloading.php?group_id=163416&use_mirror=heanet&filename=GetGnuWin32-0.6.21.exe&a=24828549)。）

方法2：为cygwin制作一个离线安装zip文件。

不要乱保存包，因为 cygwin 的安装目录可以保存在一个 zip 文件中，并在您需要时在任何计算机上进行扩展。

1.  下载 Cygwin 安装程序

2.  从 gui 中选择要安装的软件包。

3.  点击安装并等待很长时间才能下载所有内容。

4.  压缩 C:\Cygwin 文件夹。现在您有了离线 zip 文件，可以在任何机器上安装 cygwin。

5.  在您喜欢的任何计算机上解压缩此文件。适当设置 cmd.exe 路径以指向 Windows 控制面板下的 cygwin bin 目录。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-19T12:04:04.373

[不是对您问题的直接回答，但您可以从http://www.mingw.org/](http://www.mingw.org/)获得最常用的实用程序， 而无需使用那个可怕的 Cygwin 安装程序。

这是一个信息量稍大的链接[http://sourceforge.net/apps/mediawiki/cobcurses/index.php?title=Install-MSYS](http://sourceforge.net/apps/mediawiki/cobcurses/index.php?title=Install-MSYS)。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-19T12:02:28.900

也许这个描述可以帮助您完成任务。

[http://www.cygwin.com/ml/cygwin/2003-09/msg00041.html](http://www.cygwin.com/ml/cygwin/2003-09/msg00041.html)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-07-02T20:21:17.040

还有另一种创建离线 Cygwin 安装程序的解决方案，它使用“pmcyg”（[http://www.sourceforge.net/projects/pmcyg](http://www.sourceforge.net/projects/pmcyg)）。如果您向 pmcyg 提供您希望可用的 Cygwin 软件包列表，它会自动将所有这些、它们的依赖项和 setup.exe 下载到一个文件夹中，然后您可以将其刻录到 cdrom 上。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-07-02T07:06:01.130

改为安装 Babun -> [https://babun.github.io/index.html](https://babun.github.io/index.html)它包含 Cygwin ;)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-09-24T12:04:43.210

您可以从以下链接下载。 [ftp://ftp.comtrol.com/dev_mstr/sdk/other/1800136.tar.gz 下载](ftp://ftp.comtrol.com/dev_mstr/sdk/other/1800136.tar.gz) 后解压镜像并安装。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-05-28T15:06:30.053

这篇文章可以解决你的问题吗

请参阅**完整安装答案**： [Cygwin 当前的完整安装大小是多少？](https://stackoverflow.com/questions/21230657/what-is-the-current-full-install-size-of-cygwin)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-12-28T20:46:14.970

我过去维护`rsync`了存储库的副本。

它没有那么大。为了减少同步大小，我使用了`rsync`选项`--exclude`（比如我不需要 texlive 或 ruby​​，它们对于基本系统不是必需的）。

查看：

*   [https://cygwin.com/mirrors.html](https://cygwin.com/mirrors.html)（大多数支持 HTTP/FTP，但有些包括`rsync`）

比您通过 HTTP/FTP 托管此镜像以进行本地或组织安装：

```
setup.exe -p emacs --site http://localhost/cygwin 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2009-03-19T14:10:57.687

我不是 Cygwin 的忠实粉丝。我想，如果你有一些需要完整[POSIX](http://en.wikipedia.org/wiki/POSIX)系统的 Unix 代码，那就太好了。即使这样，使用它也会使您的程序呈现[GPL](http://en.wikipedia.org/wiki/GNU_General_Public_License)（由于 GPL 的 DLL），除非您向[Red Hat](http://en.wikipedia.org/wiki/Red_Hat)支付不同的许可证。

大多数人应该改用[MinGW（和 MSYS）](http://www.mingw.org/)。这为您提供了 Unix shell 和实用程序（甚至是编译器，如果您想要的话），而没有故意传染的 DLL。大多数在 Windows 上使用 GNU 编译器的人都在使用 MinGW（尽管有些人没有意识到）。

对于您的目的同样重要的是，您可以单独下载这些部件，而不是使用重新下载的安装程序。

[SourceForge](http://en.wikipedia.org/wiki/SourceForge)下载页面在[这里](http://sourceforge.net/project/showfiles.php?group_id=2435)。我建议从 MSYS Base System 包开始，它会给你[coreutils](http://en.wikipedia.org/wiki/GNU_Core_Utilities)、[Bash](http://en.wikipedia.org/wiki/Bash)、[make](http://en.wikipedia.org/wiki/Make_%28software%29)、[tar](http://en.wikipedia.org/wiki/Tar_%28file_format%29)等。如果你需要其他东西，你可以从包列表中挑选。

# c++ - “POR”在嵌入式开发中是什么意思？

> ID：661948
> 
> 赞同：4
> 
> 时间：2009-03-19T12:00:04.663
> 
> 标签：c++, c, embedded, arm

我们有一个第三方设备正在尝试集成到我们的系统中，我们的代码应该做的一件事是通过断言一个复位引脚来启动硬件复位。其中一份文件提到了在 POR 结束之前释放的 pin。我有点谷歌给了我[这个](http://encyclopedia.thefreedictionary.com/Power+on+Reset)，但我只是想确认并了解我是否在正确的页面上。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-19T12:03:02.003

上电复位

# javascript - Ajax 拨号控制？

> ID：661949
> 
> 赞同：1
> 
> 时间：2009-03-19T12:00:09.950
> 
> 标签：javascript, ajax, controls, charts

有人知道免费的 Ajax 拨号控件吗？

我正在寻找一个速度计，百分比等控制。

我希望能找到大量这些，因为它们目前在 UI 设计中似乎很流行，但我还没有找到任何好看的免费的，而我发现的唯一一个商业的，整个图书馆的成本为 800 美元大部分我不需要的控件。

**更新**

上下文是显示实时（或尽可能实时）的性能度量，我正在为各种应用程序寻找它，例如显示团队与目标的接近程度等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-23T16:18:31.977

Dojo 有一个非常棒的小部件，请参阅[AnalogGauge](http://docs.dojocampus.org/dojox/widget/AnalogGauge)的使用示例。它们也可以即时更新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-24T11:21:48.130

有来自 Google Charts 集的仪表，您可以制作动画：

[http://code.google.com/apis/ajax/playground/#gauge_interaction](http://code.google.com/apis/ajax/playground/#gauge_interaction)

您必须使用自己的 Ajax 特性来检索数据 - 我相信 Google Web Toolkit 可以进行集成（从未尝试过，只是猜测）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-23T18:49:18.130

不是 ajax，但几乎免费 [http://www.maani.us/xml_charts/](http://www.maani.us/xml_charts/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-11T22:14:21.783

可以在此处找到一组非常文字的 javascript guages： [http ://www.ejschart.com/examples/other/advancedAnalogGauge.html](http://www.ejschart.com/examples/other/advancedAnalogGauge.html)

如果你愿意在你的标记中使用一些 Silverlight，这看起来很漂亮：www.codeplex.com/SilverlightGaugeDemo

# java - 如何在 JAVA Swing 中有下载文件选项？

> ID：661962
> 
> 赞同：3
> 
> 时间：2009-03-19T12:05:09.347
> 
> 标签：java, swing

我是 Swing 新手，希望在我的 Swing 代码中实现下载文件功能，这将允许用户保存或打开特定文件。

我确实看过 JFileChooser.showOpenDialog 和 showSaveDialog，但我不想使用它，因为它让我可以从文件系统中选择任何文件。

希望我的问题很清楚。请帮我解决一下这个。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-19T12:16:41.393

你想使用它们，并添加一个过滤器。例如：

```
 JFileChooser chooser = new JFileChooser();
    // Note: source for ExampleFileFilter can be found in FileChooserDemo,
    // under the demo/jfc directory in the Java 2 SDK, Standard Edition.
    ExampleFileFilter filter = new ExampleFileFilter();
    filter.addExtension("jpg");
    filter.setDescription("JPG & GIF Images");
    chooser.setFileFilter(filter);
    int returnVal = chooser.showSaveDialog(parent);
    if(returnVal == JFileChooser.APPROVE_OPTION) {
       System.out.println("You chose to open this file: " +
            chooser.getSelectedFile().getName());
    } 
```

这只会显示 JPG 和 GIF 文件。[从这里](http://java.sun.com/j2se/1.4.2/docs/api/javax/swing/JFileChooser.html)偷来的例子

编辑：让您知道 ExampleFileFilter 实现了抽象类[FileFilter](http://java.sun.com/j2se/1.4.2/docs/api/javax/swing/filechooser/FileFilter.html)

编辑：由于您知道文件的名称，因此您可以只使用一个按钮，显示打开并使用[Runtime](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Runtime.html) .getRuntime.exec('the file to be opening.doc") 并且应该在适当的应用程序中打开它。

为了保存，您仍然需要提示他们找出他们想要保存它的位置，因此您仍然需要 JFileChooser。我仍然会使用过滤器，并在必要时动态确定文件扩展名，然后执行以下操作：

```
 JFileChooser chooser = new JFileChooser();
    // Note: source for ExampleFileFilter can be found in FileChooserDemo,
    // under the demo/jfc directory in the Java 2 SDK, Standard Edition.

    String selectedFile = "The suggested save name.";
    chooser.setSelectedFile(selectedFile);

    ExampleFileFilter filter = new ExampleFileFilter();
    String extension = "Do something to find your extension";
    filter.addExtension(extension);
    filter.setDescription("JPG & GIF Images");
    chooser.setFileFilter(filter);
    int returnVal = chooser.showSaveDialog(parent);
    if(returnVal == JFileChooser.APPROVE_OPTION) {
       System.out.println("You chose to open this file: " +
            chooser.getSelectedFile().getName());
       //then write your code to write to disk
    } 
```

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T12:37:07.117

您可以将过滤器添加到文件选择器。很容易实现你自己的，它只接受你允许的文件。

选择文件后，您需要自己实现文件的保存/读取。桌面应用程序中没有下载/上传之类的东西。

# telephony - 我们如何从 PBX 捕获 SMDR\CDR？

> ID：661963
> 
> 赞同：3
> 
> 时间：2009-03-19T12:06:23.460
> 
> 标签：telephony, pabx

我只是尝试构建呼叫监视器系统，通过串行端口或 IP 从我的 PABX 读取 SMDR\CDR。这样我就可以从这些数据中生成一些报告。我知道每个制造商的数据输出格式都不一样，那么我们该如何处理这个问题呢？是否有任何易于上手的库或示例项目？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-13T01:35:05.413

有一个免费工具可以为您捕获 SMDR 信息，如果这是您希望采取的路线。

[简单的 SMDR](http://sourceforge.net/projects/simplesmdr/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T10:05:57.590

我已经为来自许多不同供应商的几种输出格式编写了解析器，实际上通常很容易读取和“解析”数据，因为它是定义明确的 ASCII 数据（大多数情况下，有时是二进制格式，但仍然非常明确），我还没有找到任何库来简化获取数据的任务，但困难的部分一直是弄清楚如何解释不同的供应商价值观。如果您能告诉我您的目标是什么 pabx，我可以尝试提供一些资源。

# formatting - 抑制 Fortran 95 写入语句中的换行符

> ID：661975
> 
> 赞同：10
> 
> 时间：2009-03-19T12:12:06.693
> 
> 标签：formatting, fortran

我想在 fortran 中写入标准输出而不添加换行符。也就是说，我想做这样的事情：

```
a='some string and '
b='some other string'
write(*,101) a
...
write(*,102) b
...
101 format(a,...)
102 format(a) 
```

是否可以使用某种格式语句来抑制 101 中的换行符，以便代码在同一输出行上输出“一些字符串和一些其他字符串”？

请注意，将两个 write 语句分开很重要，因为中间的代码实际上用于生成第二个字符串。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-19T12:28:58.367

您可以使用以下`advance='no'`选项：

```
a='some string and '
b='some other string'
write(*,101,advance='no') a
...
write(*,102) b
...
101 format(a)
102 format(a) 
```

这将抑制换行符。

# iphone - iPhone 上的 AlertView 中的错误？

> ID：661976
> 
> 赞同：0
> 
> 时间：2009-03-19T12:12:14.010
> 
> 标签：iphone, objective-c, alert

我写了一段代码来“做某事->显示警报1->做某事->显示警报2”。

```
 //do something
    UIAlertView *alert = [[UIAlertView alloc] 
                          initWithTitle:@"Alert 1" 
                          message:nil 
                          delegate:nil 
                          cancelButtonTitle:@"OK" 
                          otherButtonTitles:nil];
    [alert show];
    [alert release];
    //do something  
    UIAlertView *alert2 = [[UIAlertView alloc] 
                           initWithTitle:@"Alert 2" 
                           message:nil 
                           delegate:nil 
                           cancelButtonTitle:@"OK" 
                           otherButtonTitles:nil];
    [alert2 show];
    [alert2 release]; 
```

突然，多个AlertViews发生了一件奇怪的事情：它显示“Alert 1”->“Alert 2”（按'OK'）->“Alert 1”。为什么“警报 1”又出现了？我还没有写任何委托方法。也许是一个错误？（感谢 cobbal，当 alert2 出现时，alert1 仍然存在。）

我发现 -(void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex 效果很好。委托方法是显示多个警报视图的常用方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T12:17:39.737

我猜想显示警报 1，然后被警报 2 覆盖，因为显示不是模态的。当警报 2 关闭时，警报 1 仍处于打开状态。

对于你的第二个问题，`alertView:didDismissWithButtonIndex:`可能会更好，但我还没有实际测试过。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T12:57:52.697

委托是为了在解除警报时通知您，以及使用哪个按钮解除警报。它不会影响警报是否被完全解除。

警报将保持可见，直到您通过点击按钮（如果有 - 它们不是必需的）或您调用警报实例的任何一个`[UIAlertView dismissWithClickedButtonIndex:animated]`或（未记录的）方法将其关闭。`dismiss`

看起来（正如 Cobbal 建议的那样），警报 2 弹出警报 1，您解除警报 2，警报 1 仍然存在（直到它本身被解除）。

您是否有特殊原因要在另一个警报仍在显示时显示新警报？也许更多的上下文可以帮助我们找到问题的根源，我怀疑这可能是一个设计问题。

[编辑] 回到这里并再次阅读，我想知道您是否使用委托方法询问的是您是否应该从那里显示警报 2？在这种情况下，这可能就是您想要的——无论是直接的还是间接的。间接我的意思是你可能在其他地方设置了一些状态来确定是否应该显示警报 2（或导致它的情况）。当您显示第一个警报时，可以设置该状态（也许是一个标志），并在解除警报时清除（从委托方法）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T18:58:18.737

发生这种情况的原因是 UIAlertView 在显示时不会阻塞。在显示警报视图后编写的任何代码都将在显示警报后直接运行。

你应该有两种不同的方法。一个做某事然后显示警报，然后另一个做某事并显示另一个警报。

启动第一个方法来做某事并显示警报，然后挂钩到警报的委托方法，当您从警报视图中获取回调时，运行另一个方法。

这样，在用户在流程第一部分的警报上按 OK 之前，流程的第二部分不会发生。

# windows - 为什么 Windows 将新创建文件的“创建时间”属性设置为旧时间？

> ID：661977
> 
> 赞同：9
> 
> 时间：2009-03-19T12:12:28.953
> 
> 标签：windows, filesystems

尝试这个我发现了一个奇怪的问题：

1.  删除旧文件。
2.  创建一个新文件并将其命名为与旧文件相同。

然后将新文件的“创建时间”属性设置为旧文件的“创建时间”。为什么会这样？如何？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-03-19T12:24:52.590

这是由于[文件系统隧道](https://devblogs.microsoft.com/oldnewthing/20050715-14/?p=34923)，正如 Raymond Chen 所解释的：

“为什么隧道存在呢？

当您使用程序编辑现有文件然后保存它时，您希望保留原始创建时间戳，因为您正在编辑文件，而不是创建新文件。但在内部，许多程序通过执行保存、删除和重命名操作的组合来保存文件（例如链接文章中列出的那些），并且如果没有隧道，文件的创建时间似乎会发生变化，即使从最终用户的观点，没有文件被创建。

作为隧道重要性的另一个示例，考虑文件“长名称的文件.txt”，其短名称为“FILEWI~1.TXT”。您将此文件加载到不支持长文件名的程序中并保存。它删除旧的“FILEWI~1.TXT”并创建一个具有相同名称的新文件。如果没有隧道，文件的相关长名称将会丢失。文件名不是一个友好的长名称，而是用波浪形的标记损坏了这个东西。不好。”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T12:21:29.290

NT 文件系统不会在您认为删除文件时删除文件。当您删除 NT 文件系统上的文件时，操作系统只会将该文件占用的磁盘空间标记为可用。在将另一个文件写入磁盘上的该位置之前，该文件不会被真正删除。

至于为什么 Windows 会认为它是同一个文件，我相信这是因为当你删除它时文件是空的，所以在相同的位置创建一个具有相同名称和相同（空）内容的新文件使得Windows 认为它​​实际上是同一个文件。我认为这是一个错误。

附带说明一下，Windows 以这种方式处理文件删除的事实正是您能够使用文件恢复实用程序来恢复已删除文件的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-10-08T23:55:08.210

您可以使用此命令手动更新创建时间：

```
powershell (ls YourFile.txt).CreationTime = Get-Date 
```

...在批处理文件中也是如此：

```
call powershell "(ls YourFile.txt).CreationTime = Get-Date" 
```

# session - Tomcat 中的 crossContext 属性有什么作用？它是否启用会话共享？

> ID：661978
> 
> 赞同：12
> 
> 时间：2009-03-19T12:12:29.860
> 
> 标签：session, jakarta-ee, tomcat, cross-context

我可以在[Tomcat 5.5 文档](http://tomcat.apache.org/tomcat-5.5-doc/config/context.html)中找到的是：

> 如果您希望在此应用程序中调用 ServletContext.getContext() 以成功地为在此虚拟主机上运行的其他 Web 应用程序返回请求调度程序，则设置为 true。在有安全意识的环境中设置为 false（默认值），以使 getContext() 始终返回 null。

我发现一些论坛帖子评论该设置`crossContext=true`还允许在不同的 Web 应用程序之间共享会话对象，但我找不到任何官方文档说明这一点。

Servlet.getContext() 与在不同 Web 应用程序之间共享会话状态的能力之间是否存在关系？

该`crossContext`属性在 Tomcat 中的**真正**作用是什么？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-20T07:23:52.097

您可以使用[Single Sign-On Valve](http://tomcat.apache.org/tomcat-5.5-doc/config/host.html#Single%20Sign%20On)在 Web 应用程序之间共享会话。

`crossContext=true`如果您想在同一虚拟主机中的不同 Web 应用程序之间共享某些信息，您将进行设置。

例如 app1 会调用：

```
setAttribute("name", object); 
```

另一个应用程序可以调用

```
getContext("/app1").getAttribute("name"); 
```

阅读信息。如果 crossContext 未设置为 true，则 getContext("/app1") 将返回 null。

然而，crossContext 的使用既罕见又可能不安全。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-19T12:29:56.947

从 javadoc `ServletContext.getContext()`：

> 此方法允许 servlet 访问服务器各个部分的上下文，并根据需要从上下文中获取 RequestDispatcher 对象。给定的路径必须以“/”开头，相对于服务器的文档根进行解释，并与托管在此容器上的其他 Web 应用程序的上下文根匹配。

因此，例如，如果您想包含来自不同 web 应用程序的页面，您需要将 crossContext 设置为 true。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T12:37:18.473

我自己试过了，我找不到*神奇的会话共享副作用*，所以 crossContext 属性只做文档所说的。

我发布了[另一个问题](https://stackoverflow.com/questions/665941/any-way-to-share-session-state-between-different-applications-in-tomcat)，看看是否有办法共享会话状态。

# database - 确定要获取的项目数

> ID：661986
> 
> 赞同：0
> 
> 时间：2009-03-19T12:16:22.830
> 
> 标签：database, collections, lazy-loading

我正在编写一个惰性列表，以从具有给定条件和给定分页（起始索引和所需项目数）的数据库中检索项目。

在列表的实例化时，我计算映射表中的项目总数，这样我就有了列表的初始大小（*initial*，因为列表允许添加和删除项目）。

它几乎可以工作，但是在确定要获取的具体项目数量时我遇到了一些麻烦：实际上，我让用户指定给定的*获取大小*（例如**10**，在这个例子中）。

为了确定要获取的项目的确切数量，目前，我将*获取大小*因子添加到集合中项目的*当前索引*（从数据库表中检索的最后一个）：如果结果小于或等于总计数，我没有做任何动作（并且提取工作非常清楚），但如果它大于总数，我计算剩余的要提取的项目失败。

实际上，为了计算剩余项目数，我从集合中的项目总数中减去*当前索引*+ 1（索引从零开始），这在所有情况下都不起作用。

你知道如何计算正确的因子吗？非常感谢各位！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-19T12:44:40.593

我相信你应该这样做：

```
items_to_fetch = min( current_index + fetch_size, total_count ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T12:58:07.783

怎么样：

```
items_to_fetch = max(0, min(fetch_size, total_count - current_index + 1)) 
```

还要确保在执行时获得当前的总计数，而不是某个缓存值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T16:22:53.430

感谢您的回答，但我找到了解决方案，这不是那么明显也不是那么简单：

```
index -> destination index (within the collection)
diff_to_index -> index - current_index
items_to_fetch -> (current_index + 1) + items_to_fetch >= total_count ? total_count - (current_index + 1) : max(diff_to_index, fetch_size) 
```

干杯! :)

# jquery - jFeed - 未执行成功功能（jQuery 插件）

> ID：661990
> 
> 赞同：2
> 
> 时间：2009-03-19T12:17:35.837
> 
> 标签：jquery, jquery-plugins, jfeed

我有以下 Javascript 代码，其中 feed 是 rss feed 的有效 url。

```
jQuery(function() {

        jQuery.getFeed({
            url:feed,
            success: function(feed){
                      alert(feed);
                      }
        });
    });} 
```

当我运行这个警报永远不会出现。使用萤火虫我可以看到正在建立的连接和来自提要的响应。

***注意：我知道这是一个安全问题，并且某些浏览器会阻止它，目前情况并非如此，因为我已经解决了该问题并且浏览器不再阻止连接***

编辑：由于某种原因，我无法在此处显示评论：

该调用目前没有被脚本代理，因为这是一个测试，我只是覆盖了浏览器安全设置：

```
netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead"); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-19T13:23:34.617

根据您提供的信息，我们可以看到您的呼叫是正确的。问题可能出在其他地方。建议您挖掘 jFeed 源代码并在 $.ajax 成功方法中禁用提要解析：

```
 $.ajax({
        type: 'GET',
        url: options.url,
        data: options.data,
        dataType: 'xml',
        success: function(xml) {
            var feed = xml; // <== was "var feed = new JFeed(xml);"
            if(jQuery.isFunction(options.success)) options.success(feed);
        }
    }); 
```

如果您的警报弹出，这是一个提要解析问题。在这种情况下，您可以检查 xml 是否正确并在此处提交以供进一步调查。

* * *

我已经运行了一些测试并检查了 jQuery 代码。您说您解决了浏览器安全问题：我猜您在服务器上安装了一个代理脚本，该脚本将从远程服务器下载 rss 文件，然后将其传输到您的 ajax 请求（因为浏览器会阻止 ajax 调用服务器与您的页面所在的服务器不同）。当使用 dataType : 'xml' 进行 ajax 调用时，jQuery 期望响应的内容类型包含字符串“xml”：

```
var ct = xhr.getResponseHeader("content-type"),
  xml = type == "xml" || !type && ct && ct.indexOf("xml") >= 0,
  data = xml ? xhr.responseXML : xhr.responseText; 
```

以下是我的问题：

*   您是否像我想的那样使用脚本作为代理脚本？
*   此脚本是否将内容类型设置为包含 xml 的内容？

这是 jFeed 附带的一个简约的 php 示例：

```
<?php
header('Content-type: application/xml');
$handle = fopen($_REQUEST['url'], "r");

if ($handle) {
    while (!feof($handle)) {
        $buffer = fgets($handle, 4096);
        echo $buffer;
    }
    fclose($handle);
}
?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-08-09T18:34:12.833

只是为那些需要使用自定义名称空间从提要中获取内容的人添加它，使用 jFeed，您可以执行类似的操作

```
<dc:creator>SomeBody Name</dc:creator>
<media:thumbnail url="someimage.jpg" /> 
```

将您自己的项目添加到 JFeed Prototype

```
JFeedItem.prototype = {
        title: '',
        link: '',
        description: '',
        updated: '',
        id: '',
        mcontent:'',
        mdescr:'',
        mcredit: '',
        dcreator:'',
        mthumbnail:''
    }; 
```

然后在您使用的 JRss 和 JAtom 的原型中，添加以下项目循环

```
item.dcreator = $(this).find("dc\\:creator").eq(0).text();
item.mcontent = $(this).find("media\\:content").eq(0);
item.mdescr = $(this).find("media\\:description").eq(0).text();
item.mcredit = $(this).find("media\\:creator").eq(0).text();
item.mthumbnail = $( $(this).find("media\\:thumbnail").eq(0) ).attr("url"); 
```

希望这一天能帮助那些在使用 jQuery 处理 xml 中的命名空间时遇到困难的人。我正在使用 NYT 的 RSSfeeds，需要让媒体缩略图显示在视频内容的链接中，并且不得不花一些时间来弄清楚如何通过命名空间工作

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T12:24:17.507

我有一个类似的问题。尝试将 URL 硬编码到 url: 中，看看是否可行，而不是设置提要变量。

您在段的末尾有一个额外的 }，这只是代码的额外部分吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-03-09T10:12:52.767

如果您想从自定义命名空间中读取内容，还有一件事：

上面的（'转义冒号'）方法在 Chrome 中无法正常工作，但这种（'nodeName'）方法将在所有浏览器中工作：

item.mediaThumbnail = $($(this).find("[nodeName=media:thumbnail]").eq(0)).attr("url");

# php - 如何对 sphinx 组搜索中的属性求和？

> ID：661997
> 
> 赞同：2
> 
> 时间：2009-03-19T12:19:07.907
> 
> 标签：php, mysql, sorting, grouping, sphinx

我需要 sphinx 按属性的总和对结果进行排序。我需要：

*   按 ID 对结果进行分组（完成）
*   按一个属性的 SUM 对结果进行排序

我找不到对这个属性求和的方法。我怎么能这样做？

（我使用狮身人面像 PHP API）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T19:29:41.153

Sphinx 从 0.9.9-rc2 版本开始支持聚合函数（sum、avg、min、max）。检查来自[www.sphinxsearch.com/docs/current.html的文档](http://www.sphinxsearch.com/docs/current.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T01:40:15.603

与前面的答案相呼应，在 Sphinx 查询中是不可能的。虽然[表达式语法](http://sphinxsearch.com/docs/manual-0.9.8.html#sorting-modes)允许在排序中进行某种级别的计算，但它没有任何聚合函数。除非您将该总和值存储为一个属性（这可能是一个选项 - 在索引期间计算它），否则它必须是每条记录的单独 SQL 查询。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T13:49:54.977

据我所知，这在当前的 Sphinx 版本中是不可能的。group by 函数旨在返回 group by 属性（即项目组的不同属性）、该组中的计数以及该组中的“顶部”项目。

最好的选择是在 Sphinx 之外进行求和。您可以按属性按组执行 Sphinx 搜索排序，然后在 PHP 中遍历这些项目，并在进行时求和。这种方法可能效率不高，因此可能需要定期缓存以减少服务器负载。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-03T05:26:57.070

你的意思是分面搜索？^_^ [http://sphinxsearch.com/blog/2013/06/21/faceted-search-with-sphinx/](http://sphinxsearch.com/blog/2013/06/21/faceted-search-with-sphinx/)

# sql-server - Oracle 序列，但随后在 MS SQL Server 中

> ID：661998
> 
> 赞同：14
> 
> 时间：2009-03-19T12:19:36.923
> 
> 标签：sql-server, oracle, sequence

在 Oracle 中有一种生成序列号的机制，例如；

```
CREATE SEQUENCE supplier_seq

    MINVALUE 1
    MAXVALUE 999999999999999999999999999
    START WITH 1
    INCREMENT BY 1
    CACHE 20; 
```

然后执行语句

```
supplier_seq.nextval 
```

检索下一个序列号。

您将如何在 MS SQL Server 中创建相同的功能？

编辑：我不是在寻找自动为表记录生成键的方法。我需要生成一个唯一值，我可以将其用作进程的（逻辑）ID。所以我需要 Oracle 提供的确切功能。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-19T12:24:31.593

没有完全匹配。

等效的是 IDENTITY，您可以在创建表时将其设置为数据类型。SQLSERVER 将在插入期间自动创建一个正在运行的序列号。最后插入的值可以通过调用 SCOPE_IDENTITY() 或通过查询系统变量@@IDENTITY 获得（正如 Frans 所指出的）

如果您需要精确的等价物，则需要创建一个表，然后编写一个过程来重新调整下一个值和其他操作。请参阅 Marks 对此问题的回应。

编辑：
SQL Server 已经实现了类似于 Oracle 的序列。有关详细信息，请参阅此问题。

[您将如何在 Microsoft SQL Server 中实现序列？](https://stackoverflow.com/questions/282943/how-would-you-implement-sequences-in-microsoft-sql-server)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-07-29T04:34:00.050

标识是最好和最可扩展的解决方案，但是，如果您需要一个不是递增 int 的序列，如 00A、00B、00C 或某些特殊序列，则有一种次优方法。如果实施正确，它可以扩展，但如果实施不当，它的扩展性很差。我毫不犹豫地推荐它，但你要做的是：

1.  您必须将“下一个值”存储在表中。该表可以是仅具有该值的简单的一行一列的表。如果您有多个序列，它们可以共享表，但是通过为每个序列设置单独的表，您可能会减少争用。
2.  您需要编写一个更新语句，将该值增加 1 个间隔。您可以将更新放在存储过程中，以使其易于使用并防止在不同位置的代码中重复更新。
3.  正确使用序列，以便它可以合理地扩展（不，不如 Identitiy :-) 需要两件事：update 语句具有针对这个确切问题的特殊语法，它将在单个语句中增加和返回值；湾。您必须在事务开始之前和事务范围之外从自定义序列中获取值。这就是 Identity 可扩展的原因之一——无论事务范围如何，对于任何*尝试*的插入，它都会返回一个新值，但不会在失败时回滚。这意味着它不会阻塞，也意味着您将有失败交易的空白。

特殊的更新语法因版本而异，但要点是您对变量进行赋值并在同一语句中进行更新。对于 2008 年，Itzik Ben-Gan 有这个巧妙的解决方案：[http ://www.sqlmag.com/Articles/ArticleID/101339/101339.html?Ad=1](http://www.sqlmag.com/Articles/ArticleID/101339/101339.html?Ad=1)

老式 2000 及更高版本的方法如下所示：

UPDATE SequenceTable SET @localVar = value = value + 5 -- 将尾部更改为您的增量逻辑

这将增加并返回下一个值。

如果您绝对不能有间隙（抵制该要求:-)，那么从技术上讲，可以将该更新或 proc 放在您的其余部分中，但是您会受到很大的并发打击，因为每个插入都等待前一个提交。

我不能相信这一点；我从Itzik那里学到了这一切。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-19T12:25:17.970

使该字段成为身份字段。该字段将自动获取其值。您可以通过调用 SCOPE_IDENTITY() 或通过查询系统变量@@IDENTITY 来获取最后插入的值

SCOPE_IDENTITY() 函数是首选。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-19T15:28:20.957

正如 DHeer 所说，绝对没有完全匹配。如果您尝试构建自己的过程来执行此操作，您总是会阻止您的应用程序扩展。

Oracle 的序列具有高度可扩展性。

好的，我稍微收回一下。如果您真的愿意专注于并发，并且愿意尽可能使用序列将数字弄乱，那么您就有机会。但是由于您一开始似乎对 t-sql 很不熟悉，所以我会开始寻找其他一些选项（将 Oracle 应用程序移植到 MSSS - 这就是您正在做的事情）

例如，只需在“nextval”函数中生成一个 GUID。这将扩大规模。

哦，不要为所有值使用一个表，只是为了将你的最大值保存在缓存中。您必须锁定它以确保您提供唯一值，这就是您停止缩放的地方。您必须弄清楚是否有办法在内存中缓存值并以编程方式访问某种轻量级锁——内存锁，而不是表锁。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-20T16:39:25.287

我希望 SQL Server 有这个功能。它会让很多事情变得更容易。

这是我解决这个问题的方法。

创建一个名为 tblIdentities 的表。在此表中放置一行，其中包含您的最小值和最大值以及应重置序列号的频率。还要输入一个新表的名称（称为 tblMySeqNum）。这样做使得以后添加更多的序列号生成器变得相当容易。

tblMySeqNum 有两列。ID（它是一个 int 标识）和 InsertDate（它是一个默认值为 GetDate() 的日期时间列）。

当你需要一个新的 seq num 时，调用一个插入到这个表中的 sproc 并使用 SCOPE_IDENTITY() 来获取创建的身份。确保您没有超过 tblIdentities 中的最大值。如果你有然后返回一个错误。如果没有返回您的序列号。

现在，要重置和清理。有一项根据需要定期运行的作业，它检查 tblIdentites 中列出的所有表（目前只有一个）以查看它们是否需要重置。如果它们已达到重置值或时间，则在行中列出的表的名称上调用 DBCC IDENT RESEED（此示例中为 tblMySeqNum）。这也是清除该表中您并不真正需要的额外行的好时机。

不要在获得身份的存储过程中进行清理或重新播种。如果这样做，那么您的序列号生成器将根本无法很好地扩展。

正如我所说，SQL Server 中的这个特性会让很多事情变得更容易，但我发现这个工作在功能上相当好。

瓦卡诺

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-17T14:26:04.270

这可能很久以前就已经回答了......但从 SQL 2005 开始，您可以使用该`ROW_NUMBER`函数......一个例子是：

```
select ROW_NUMBER() OVER (ORDER BY productID) as DynamicRowNumber, xxxxxx,xxxxx 
```

在我的情况下，该`OVER`语句使用`ORDER BY`唯一主键...

希望这会有所帮助......不再有临时表或奇怪的连接！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-03-25T03:11:39.610

如果您能够更新到 SQL Server 2012，则可以使用 SEQUENCE 对象。甚至 SQL Server 2012 Express 也支持序列。

```
CREATE SEQUENCE supplier_seq
    AS DECIMAL(38)
    MINVALUE 1
    MAXVALUE 999999999999999999999999999
    START WITH 1
    INCREMENT BY 1
    CACHE 20;

SELECT NEXT VALUE FOR supplier_seq
SELECT NEXT VALUE FOR supplier_seq
SELECT NEXT VALUE FOR supplier_seq
SELECT NEXT VALUE FOR supplier_seq
SELECT NEXT VALUE FOR supplier_seq 
```

结果是：

```
---------------------------------------
1

(1 row(s) affected)

---------------------------------------
2

(1 row(s) affected)

---------------------------------------
3

(1 row(s) affected)

---------------------------------------
4

(1 row(s) affected)

---------------------------------------
5

(1 row(s) affected) 
```

只需注意指定正确的数据类型。如果我没有指定它，您提供的 MAXVALUE 将不会被接受，这就是我使用 DECIMAL 以尽可能高的精度的原因。

更多关于序列的信息：http: [//msdn.microsoft.com/en-us/library/ff878091.aspx](http://msdn.microsoft.com/en-us/library/ff878091.aspx)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-02-10T14:08:50.457

不是一个真正的答案，但看起来序列将在 2012 年出现在 SQLServer 中。

[http://www.sql-server-performance.com/2011/sequence-sql-server-2011/](http://www.sql-server-performance.com/2011/sequence-sql-server-2011/)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-04-26T12:35:51.980

不是一个确切的答案，而是一些现有答案的补充

[SCOPE_IDENTITY (Transact-SQL)](http://msdn.microsoft.com/en-us/library/ms190315.aspx)

> SCOPE_IDENTITY、IDENT_CURRENT 和@@IDENTITY 是相似的函数，因为它们返回插入到标识列中的值。
> 
> IDENT_CURRENT 不受范围和会话限制；它仅限于指定的表。IDENT_CURRENT 返回为任何会话和任何范围内的特定表生成的值。有关详细信息，请参阅 IDENT_CURRENT (Transact-SQL)。

这意味着两个不同的会话可以具有相同的标识值或序列号，因此要避免这种情况并获得所有会话使用的唯一编号`IDENT_CURRENT`

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-11-29T12:43:21.707

正是因为这个 IDENT_CURRENT 不受范围和会话限制；它仅限于指定的表。我们需要使用 SCOPE_IDENTITY() 因为范围身份会给我们会话中生成的唯一编号，唯一性由身份本身提供。**************************