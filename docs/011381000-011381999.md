# StackOverflow 问答 11381000-11381999

# java - JPanel 时钟和按钮合并

> ID：11381001
> 
> 赞同：0
> 
> 时间：2012-07-08T05:52:54.520
> 
> 标签：java, swing, button, jpanel, clock

我在将时间和按钮合并在一起时遇到问题...

我无法在`JPanel`.

这是我的代码：

```
import java.awt.Color;
import java.awt.Font;
import java.text.DateFormat;
import java.text.SimpleDateFormat;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;

public final class Date_Time extends JFrame{
    private static final long serialVersionUID = 1L;
    private JPanel show_date_time = new JPanel();
    private JLabel time = new JLabel("Time:");
    private JLabel show_time = new JLabel("Show Time");

    DateFormat dateFormat2 = new SimpleDateFormat("h:mm:ss a");
    java.util.Date date2;
    private JLabel label;
    private JPanel panel;

     public Date_Time(){
        this.setSize(300, 300);
        this.setResizable(false);
        getContentPane().add(Show_Time_date());
     }
     private JButton button1 = new JButton();
     private JFrame frame1 = new JFrame();
    public JPanel Show_Time_date(){
        frame1.add(show_date_time);
        show_date_time.setBackground(Color.ORANGE);
        frame1.add(button1);
        getShow_date_time().setLayout(null);
        Font f;
        f = new Font("SansSerif", Font.PLAIN, 15);
        getTime().setBounds(0,250,400,30);
        getTime().setFont(f);
        getShow_date_time().add(getTime());
        setShow_time(new JLabel(""));
        updateDateTime();
        getShow_time().setBounds(37,250,400,30);
        getShow_time().setFont(f);
        getShow_date_time().add(getShow_time());
        return getShow_date_time();

    }

    public static void main(String[] args) {
        Date_Time Main_win=new Date_Time();
        Main_win.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        Main_win.setVisible(true);
    }

    public void updateDateTime()
    {
    Thread th = new Thread(new Runnable()
        {
            @Override
        public void run()
            {
            while(true)
                {
                date2 = new java.util.Date();
                String dateTime = dateFormat2.format(date2);
                    getShow_time().setText(dateTime);
                    getShow_time().updateUI();

                }
            }
        });
    th.start();
    }

    /**
     * @return the show_time
     */
    public JLabel getShow_time() {

        return show_time;
    }

    /**
     * @param show_time the show_time to set
     */
    public void setShow_time(JLabel show_time) {
        this.show_time = show_time;
    }

    /**
     * @return the time
     */
    public JLabel getTime() {
        return time;
    }

    /**
     * @param time the time to set
     */
    public void setTime(JLabel time) {
        this.time = time;
    }

    /**
     * @return the show_date_time
     */
    public JPanel getShow_date_time() {
        return show_date_time;
    }

    /**
     * @param show_date_time the show_date_time to set
     */
    public void setShow_date_time(JPanel show_date_time) {
        this.show_date_time = show_date_time;
    }

    /**
     * @return the label1
     */

    /**
     * @param label1 the label1 to set
     */

    /**
     * @return the label
     */
    public JLabel getLabel() {

        return label;
    }

    /**
     * @param label the label to set
     */
    public void setLabel(JLabel label) {
        this.label = label;
    }

    /**
     * @return the panel
     */
    public JPanel getPanel() {
        return panel;
    }

    /**
     * @param panel the panel to set
     */
    public void setPanel(JPanel panel) {
        this.panel = panel;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T09:09:08.527

这里看看这个修改后的代码：

```
import java.awt.Color;
import java.awt.FlowLayout;
import java.awt.Font;
import java.text.DateFormat;
import java.text.SimpleDateFormat;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.SwingUtilities;

public final class Date_Time extends JFrame{

    private static final long serialVersionUID = 1L;
    private JPanel show_date_time = new JPanel();
    private JLabel time = new JLabel("Time:");
    private JLabel show_time = new JLabel("Show Time");

    private DateFormat dateFormat2 = 
                new SimpleDateFormat("h:mm:ss a");
    private JButton button1 = new JButton("USELESS");           
    private java.util.Date date2;
    private JLabel label;
    private JPanel panel;

    public Date_Time(){        

        //this.setResizable(false);
        getContentPane().add(show_Time_date());
    }    

    public JPanel show_Time_date(){

        getShow_date_time().setLayout(new FlowLayout(FlowLayout.LEFT, 5, 5));
        /*
         * Always set this Opaque property of the 
         * said JComponent to true, before
         * you change the Background Colour
         * of the said component in question.
         * In some Look And Feels it's set to
         * false by default, so you won't
         * see any colour, in such situations.
         */
        getShow_date_time().setOpaque(true);
        getShow_date_time().setBackground(Color.ORANGE);        

        Font f;
        f = new Font("SansSerif", Font.PLAIN, 15);

        getTime().setFont(f);
        getShow_date_time().add(getTime());
        setShow_time(new JLabel(""));

        updateDateTime();

        getShow_time().setFont(f);
        getShow_date_time().add(getShow_time());
        getShow_date_time().add(button1);

        return getShow_date_time();
    }

    public static void main(String[] args) {

        /*
         * Calls like pack()/setSize()/setVisible()
         * must be done from inside the Event Dispatch Thread
         * or the EDT in short. And not from your
         * Main Thread. Please read Concurrency in Swing
         * in detail from this link : 
         * http://docs.oracle.com/javase/tutorial/uiswing/concurrency/index.html
         */
        SwingUtilities.invokeLater(new Runnable()
        {
            public void run()
            {
                Date_Time main_win=new Date_Time();
                main_win.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                main_win.setSize(250, 75);
                main_win.setVisible(true);
            }
        });        
    }

    public void updateDateTime()
    {
        Thread th = new Thread(new Runnable()
        {
            @Override
            public void run()
            {
                while(true)
                {
                    date2 = new java.util.Date();
                    final String dateTime = dateFormat2.format(date2);
                    /*
                     * Any updates to the GUI, must also be done
                     * on the EDT - Event Dispatch Thread.
                     */
                    SwingUtilities.invokeLater(new Runnable()
                    {
                        public void run()
                        {
                            getShow_time().setText(dateTime);
                        }
                    });                    
                }
            }
        });
        th.start();
    }

    /**
     * @return the show_time
     */
    public JLabel getShow_time() {

        return show_time;
    }

    /**
     * @param show_time the show_time to set
     */
    public void setShow_time(JLabel show_time) {
        this.show_time = show_time;
    }

    /**
     * @return the time
     */
    public JLabel getTime() {
        return time;
    }

    /**
     * @param time the time to set
     */
    public void setTime(JLabel time) {
        this.time = time;
    }

    /**
     * @return the show_date_time
     */
    public JPanel getShow_date_time() {
        return show_date_time;
    }

    /**
     * @param show_date_time the show_date_time to set
     */
    public void setShow_date_time(JPanel show_date_time) {
        this.show_date_time = show_date_time;
    }

    /**
     * @return the label1
     */

    /**
     * @param label1 the label1 to set
     */

    /**
     * @return the label
     */
    public JLabel getLabel() {

        return label;
    }

    /**
     * @param label the label to set
     */
    public void setLabel(JLabel label) {
        this.label = label;
    }

    /**
     * @return the panel
     */
    public JPanel getPanel() {
        return panel;
    }

    /**
     * @param panel the panel to set
     */
    public void setPanel(JPanel panel) {
        this.panel = panel;
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-08T15:12:16.810

正如@nIcE cOw 所指出的，您的线程未正确同步，并且`invokeLater()`是正确的解决方案。不幸的是，您的线程也会连续运行，从而影响性能。您应该考虑以下替代方案：

*   差：让处理器在循环中：

    ```
    Thread.yield(); // prevent thread from starving 
    ```

*   `invokeLater()`更好：在catch之后添加适当的延迟`InterruptedException`：

    ```
    try {
        Thread.sleep(500);
    } catch (InterruptedException ex) {
        Logger.getLogger(Date_Time.class.getName()).log(Level.SEVERE, null, ex);
    } 
    ```

*   最佳：使用，如此[处](https://stackoverflow.com/a/2166500/230513)`javax.swing.Timer`所示。

# php - 在 wordpress 网站加载之前播放 Flash

> ID：11381017
> 
> 赞同：0
> 
> 时间：2012-07-08T05:55:41.070
> 
> 标签：php, flash, wordpress

我是一名 asp.net 开发人员，但对 wordpress 很陌生。我想要关于在加载 wordpress 网站的主页/索引页面之前播放 flash 文件的意见或专家建议，例如在加载 www.formula1.com 时播放有声音的 flash 文件，我怎样才能完成此功能。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T09:52:39.917

我认为这不是 WordPress 特定的问题。首先在一个普通的 html 构建上做它，一旦你在那里工作，让它在 WordPress 构建上以相同的方式工作。

在 WordPress 中，您的主题控制着您网站的前端，因此它将位于您的主题文件夹中。

如果你是 WordPress 新手，我能给你的最好建议是，首先让它以最基本的形式工作，一旦你有了，看看找到正确的 WordPress 方法。

如果您不确定如何在网站加载时或之前将 Flash 文件作为网站介绍播放，请在 WordPress 上下文之外询问该问题以获得您正在寻找的答案。

# expression-blend - Sketchflow 中的下拉菜单在哪里

> ID：11381019
> 
> 赞同：0
> 
> 时间：2012-07-08T05:55:42.360
> 
> 标签：expression-blend, expression-sketchflow

好吧，我简直不敢相信这一点。我在 Sketchflow - Expression Blend 4 中找不到下拉菜单。我需要快速轻松地创建一个模型，令人惊讶的是，我找不到一个简单的下拉菜单来拖动到我在这里创建的项目网页模型。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T06:11:27.343

在 WPF/SL 中，下拉菜单被称为`ComboBox`

您可以搜索`sketch`控件并从 Assets 窗口中选择 ComboBox，也可以通过右键单击工具栏上的 Buttons 图标来选择它：

![在此处输入图像描述](../Images/169cf4994f7c894f3f7d8e3657d1a717.png)

# ruby-on-rails - 是否可以使用 rake 在 Rails 中模拟页面请求？

> ID：11381022
> 
> 赞同：3
> 
> 时间：2012-07-08T05:55:50.507
> 
> 标签：ruby-on-rails, performance, mongodb, heroku, redis

我一直在从事一个对我来说不寻常的 Rails 项目，从某种意义上说，它不会使用 MySQL 数据库，而是会使用 mongoDB + Redis。

该应用程序非常简单 - 从 mongoDB 到 Redis 的“启动”数据，之后 rails 将准备好接受来自用户的请求，这些请求主要包括从 redis 中提取数据，（我被告知它会非常快这）进行快速计算并将一些数据发送回给用户。运气好的话，这将每秒发生约 1500-4500 次。

在用户军队的力量降到服务器上之前，我想知道是否有一种方法可以在内部以某种方式“模拟”页面请求 - 比如运行一个 rake 任务来简单地每秒执行该页面 N 次或类似的东西?

如果没有，有没有办法测试该负载，然后对请求进行计时以大致了解大多数用户将看到的延迟？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-08T06:45:31.787

# 警告

性能测试是一个非常广泛的主题，正确的工具通常取决于您需要的结果的类型和质量。作为您必须处理的问题的一个示例，请考虑如果您为特定控制器操作编写基准规范并连续调用该方法 1000 次会发生什么。这可能会很好地了解该控制器方法的性能，但它可能会进行 1000 次相同的 redis 或 mongo 查询，其结果可能会被数据库驱动程序缓存。这也忽略了您的 Web 服务器响应和提供作为请求的一部分的静态资产所花费的时间（这可能没问题，特别是如果您对此进行了其他测试）。

# 基本工具

*   **`ab`或 ApacheBench**是一个简单的命令行工具，可用于测试应用程序的吞吐量和速度。当我想在 Web 服务器上发送一千个请求或测试我的应用程序可以同时处理多少个请求时（例如比较 mongrel、unicorn、thin 和 goliath 时），我通常会首先进行此操作。因为所有请求都来自同一台服务器，所以这对于少量请求是有利的，但是随着请求数量的增长，您将受到测试机器上的资源（网络堆栈、cpu 和内存）的限制。
*   [**Benchmark**是一个标准的 ruby​​ 类](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/benchmark/rdoc/index.html)，非常适合快速输出一些分析信息。它也可以与[Test::Unit](http://guides.rubyonrails.org/performance_testing.html)和[RSpec](https://github.com/michaeledgar/rspec-benchmark)一起使用。如果你想要一个 rake 任务来做一些快速的基准测试，这可能是开始的地方
*   **`mechanize`**- 我喜欢使用[mechanize](http://mechanize.rubyforge.org/)快速编写与页面交互的脚本。它处理 cookie 和表单，但默认情况下不会去抓取图像等资产。如果您要进行自己的测试，它可能是一个很好的工具，但不应该是第一个使用的工具。
*   还有一些工具可以模拟与站点交互的实际用户（他们将像浏览器一样下载资产，并且可以配置为模拟几个不同的用户）。最值得注意的是[The Grinder](http://grinder.sourceforge.net/)和[Tsung](http://tsung.erlang-projects.org/)。虽然仍处于开发阶段，但我目前正在研究[tsung-rails](https://github.com/btaitelb/tsung-rails)，以便更轻松地使用 tsung 自动化 Rails 负载测试，如果您选择朝这个方向发展，我会很乐意帮助您:)

# Rails 分析链接

*   [编写性能测试的良好概述](http://guides.rubyonrails.org/performance_testing.html)
*   [很棒的幻灯片，涵盖了用于在各个级别进行分析的大多数最新工具](https://speakerdeck.com/u/tmm1/p/debugging-ruby-performance)

# algorithm - 边上有预算的最大简单路径

> ID：11381025
> 
> 赞同：4
> 
> 时间：2012-07-08T05:56:47.577
> 
> 标签：algorithm, graph, graph-theory, graph-algorithm

这是一个自我制定的问题的一部分，因此我无法“谷歌”它，我自己的尝试到目前为止都是徒劳的。

给你一个图**G(V,E)** **V**的每个**节点**都有利润**wi**， **E**的每个**边**都有成本**ci**。我们现在给定一个预算**C**，需要找到一条路径，使得成本总和小于**C**，其中**wi**的总和最大。路径在这里具有正常定义，即路径不包含重复顶点（简单路径）。

 ******很明显，哈密顿路径是这种情况的一个特例（设置成本 = |N-1| 并且每个边的成本 = 1），因此这是一个 NP Hard 问题，所以我正在寻找近似解决方案和启发式方法.

数学上

给定图**G(V,E)**

**对于每条边**e ，** **ci >=0****

 ******对于每个顶点**v ，** **wi >=0****

 ****找到一条简单的路径**P**使得

在**P** <= **C**中的所有边**e**上求和**ci**

 ******最大化**P**中所有**v**的**总和 wi**

 ***** * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T19:28:37.950

这被称为选择性旅行推销员问题，或有利润的旅行推销员。谷歌学术应该可以给你一些参考。经常使用诸如遗传编程或禁忌搜索之类的元启发式方法。如果您想以最佳方式解决问题，线性编程技术可能会起作用（不幸的是，您没有说明您正在处理的实例的大小）。如果路径的长度很短（比如 15 个顶点），[颜色编码](http://en.wikipedia.org/wiki/Color-coding)也可能有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T08:48:59.790

想到的一个简单启发式方法是随机[爬山](http://en.wikipedia.org/wiki/Hill_climbing)算法和[贪心算法](http://en.wikipedia.org/wiki/Best-first_search)的变体。

定义权重增加并随着成本减少的价值函数。例如：

```
value(u,v) = w(v) / [c(u,v) + epsilon]
(+ epsilon for the case of c(u,v) = 0) 
```

现在，这个想法是：
从一个 vertex ，以概率`u`继续到 vertex ：`v`

```
P(v|u) = value(u,v) / sum(u,x) [ for all feasible moves (u,x) ] 
```

重复直到无法继续。

此解决方案将为您提供一个解决方案 - 快速，但它可能不是最佳的。然而——它是随机的——你总是可以在你有时间的时候一次又一次地重新运行它。
这将为您提供解决此问题的**[任何时间](http://en.wikipedia.org/wiki/Anytime_algorithm)**算法，这意味着-您拥有的时间越多-您的解决方案就越好。

一些优化：

*   您可以尝试学习宏来加速每次搜索，这将导致每次搜索次数更多，并且可能 - 更好的解决方案。
*   通常，第一次搜索不是随机的，纯粹是贪婪的，遵循`max{value(u,v)}`************************

# asp-classic - 如何使用 ASP 经典重定向

> ID：11381026
> 
> 赞同：7
> 
> 时间：2012-07-08T05:56:51.783
> 
> 标签：asp-classic, url-redirection

我想从一个 URL 重定向到另一个：

```
http://female.deals.com/

http://male.deals.com/ 
```

如何通过在浏览器中将 URL 更改为新 URL 并且页面直接转到新 URL 而无需转到旧 URL 并进行刷新来实现这一点？

我在网上浏览了一些脚本，它们都不起作用，我也不知道 ASP 经典。所以我正在努力使重定向工作。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-07-08T06:08:12.807

```
<%
    Response.Redirect "http://www.sitename.com"
%> 
```

再加上“所有”的查询字符串浏览器网址：

```
<%
    Response.Redirect "http://www.sitename.com/?" & Request.QueryString
%> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-08T06:08:21.713

在 IIS 中作为启动页面列出的 default.asp 页面中，注释掉所有 HTML 并放入此 ASP 经典代码：

```
<%
Response.Redirect "http://male.deals.com/"
%> 
```

要保留查询字符串参数，您将使用以下代码：

```
<% response.redirect("http://male.deals.com/newpage.asp" & "?id=" & request.querystring("id")) %> 
```

另一种方法是 ISAPI 过滤器，[Helicon ISAPI rewrite](http://www.isapirewrite.com/)。

# ruby-on-rails - RAILS：如何在回调中创建新的 collection.build？

> ID：11381027
> 
> 赞同：0
> 
> 时间：2012-07-08T05:57:08.583
> 
> 标签：ruby-on-rails, ruby-on-rails-3, model, callback

如何使用其他模型在 after_save 中创建新记录？

我尝试了这条线，结果是“nil:NilClass 的未定义方法‘journals’”

例如

```
resources :users do
  resource :profile
  resources :journals
end

class User < ActiveRecord::Base
  has_one  :profile
  has_many :journals
end

class Profile < ActiveRecord::Base
  belongs_to :user

  after_save :create_new_journal_if_none

  private
    def create_new_journal_if_none
      if user.journals.empty? ????
        user.journals.build() ????
      end
    end
end

class Journals < ActiveRecord::Base
  belong_to :user
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T06:14:05.203

一旦父级保存，嵌套模型也将被保存，因此很容易使用 before_create 块并在这里构建嵌套资源。

```
class Profile < ActiveRecord::Base
  belongs_to :user

  before_create do 
    user.journals.build unless user.journals.any?
  end
end 
```

这行代码将创建一个配置文件和一个分配给用户的日志

```
User.find(1).create_profile(name :test) 
```

# python - 如何将 R 变量传递给 python 函数的系统调用？

> ID：11381030
> 
> 赞同：2
> 
> 时间：2012-07-08T05:57:30.863
> 
> 标签：python, r

我在 python 中编写了一个函数，它接受两个参数，其中一个是文件路径名。我已经在 R 中的一个循环中包装了对这个 python 函数的调用。我希望能够更新这个 R for 循环中的一个变量，并将这个变量的值作为文件路径名传递给 python 函数。我怎样才能做到这一点？

代码：

```
for (file in filenames) {
     file <- paste("/home/yyy/xx", file, sep="/")
     system('python pylib/filefunction.py <TODO: file> divide') # divide is the 2nd argument
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-08T08:04:59.693

我相信你可以`paste`再次使用：

```
for (file in filenames) {
  file <- paste('/home/yyy/xx', file, sep='/')
  system(paste('python', 'pylib/filefunction.py', file, 'divide'))
} 
```

或者，更好的是`sprintf`：

```
for (file in filenames) {
  system(sprintf('python pylib/filefunction.py /home/yyy/xx/%s divide', file))
} 
```

# mysql - MySQL UPDATE 键的重复条目

> ID：11381034
> 
> 赞同：5
> 
> 时间：2012-07-08T05:58:10.707
> 
> 标签：mysql, unique-key

我`unique`在名为 的列上有一个索引`label`，但出于某种奇怪的原因，我尝试进行如下更新：

```
UPDATE books SET label = 'foo bar', title = 'something new', modified = UTC_TIMESTAMP(); 
```

并且已经存在一行 label = 'foo bar' 这个错误：

```
 #1062 - Duplicate entry 'foo bar' for key 'label' 
```

如何让 MySQL 进行更新？这不应该被打破，因为从技术上讲，仍然只有一行 key `foo bar`。

谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-08T06:03:04.590

此 SQL 查询尝试使用这些值更新 books 表中的每条记录，因为您没有 WHERE 子句。它失败了，因为您只能拥有一个具有该标签值的记录，但查询想要将它们全部设置为它。

我认为您可能没有执行您想要的查询。也许您打算使用该标签更新记录的标题和时间。检查你的语法。

# ios - 连续关闭 2 个 ViewController

> ID：11381037
> 
> 赞同：4
> 
> 时间：2012-07-08T05:58:23.640
> 
> 标签：ios, viewcontroller

我尝试了 2 种方法来连续解散 2 个视图控制器，但只有其中一个被解散，而不是第二个

方法1

```
-(void) LoginDone:(NSNotification *)notif 
 {
 [self dismissViewControllerAnimated:YES completion:NULL];   //previous viewcontroller
 [self dismissViewControllerAnimated:YES completion:NULL];   //current viewcontroller
  } 
```

方法2

```
-(void) LoginDone:(NSNotification *)notif 
{
[self dismissViewControllerAnimated:YES completion:NULL];
 [[NSNotificationCenter defaultCenter] postNotificationName:@"LoginDone2" object:nil];

 }

-(void) LoginDone2:(NSNotification *)notif 
{
     [self dismissViewControllerAnimated:YES completion:NULL];

 } 
```

我需要找到一种方法来连续关闭以前的视图控制器和当前的视图控制器。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-03-12T02:21:09.513

这是一个老问题，但它似乎正是我目前遇到的问题。这是我所做的：

```
 [self.presentingViewController.presentingViewController
     dismissViewControllerAnimated:YES completion:nil]; 
```

它对我有用。我希望它对某人有用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-08T06:33:57.653

通过调用

```
 [self dismissViewControllerAnimated:YES completion:NULL]; 
```

您是在告诉您`self`要忽略它所呈现的视图。告诉同一个`self`对象两次关闭它呈现的视图，不会改变结果。换句话说`self`，根据您对代码的评论，不能同时表示“当前视图”和“上一个视图”。`self`只是代表单个视图的单个控制器，无论是当前视图还是前一个视图。

要解决这个问题，您应该发送`dismissViewControllerAnimated`到`self`（我假设呈现最顶层的视图）*和*呈现前一个视图的*另一个*视图控制器对象。

换句话说，我会期待这样的事情：

```
-(void) LoginDone:(NSNotification *)notif 
{
   [self dismissViewControllerAnimated:YES completion:NULL];
   [self.previousController dismissViewControllerAnimated:YES completion:NULL];
} 
```

实际上，您可以只向第二个视图控制器发送一条消息，并且两个视图都将被关闭（[source](http://developer.apple.com/library/ios/documentation/uikit/reference/UIViewController_Class/Reference/Reference.html#//apple_ref/occ/instm/UIViewController/dismissViewControllerAnimated:completion:)）：

> 如果您连续呈现多个视图控制器，从而构建一个呈现的视图控制器堆栈，则在堆栈中较低的视图控制器上调用此方法会解除其直接子视图控制器以及堆栈上该子视图控制器上方的所有视图控制器。发生这种情况时，只有最顶层的视图会以动画方式消失；任何中间视图控制器都简单地从堆栈中删除。最顶层的视图使用其模态转换样式被解除，这可能与堆栈中其他视图控制器使用的样式不同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-10-23T12:29:23.633

我知道这是一个老问题，但也许有人会在这个问题上寻找解决方案，所以这里是：

```
-(void) closeModalViews 
{
    [previousVC dismissViewControllerAnimated:YES completion:^(void) {
        [self dismissViewControllerAnimated:YES];
    }];
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-02-23T22:37:20.237

我喜欢 JPetric 的想法，但首先您必须关闭当前视图控制器的视图，然后才能关闭当前视图控制器的视图。

```
 [self dismissViewControllerAnimated:NO completion:^(void) {
        [self.presentingViewController dismissViewControllerAnimated:NO completion:nil];
    }]; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-08T06:07:59.090

据我所知，您正在尝试以下操作：

> 1.  有 2 个视图控制器。
> 2.  你希望他们两个都消失。
> 3.  另一个控制器进来了。

但事实是只显示了一个控制器，为什么你需要关闭 2 呢？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-04-11T12:54:10.580

您可以使用 self.view.hidden=true; 在跳转的视图控制器上，同时动画回到第一个视图控制器。使用 [self.presentingViewControllerdismiss...] 不隐藏对我不起作用。

# html - 为什么 IFRAME 不像表格单元格那样将自身调整为内容？

> ID：11381042
> 
> 赞同：1
> 
> 时间：2012-07-08T05:59:47.810
> 
> 标签：html, css

我正在尝试显示几个 iframe，使它们都占据屏幕的宽度，但左侧的第一个 iframe 仅足够宽以显示其所有内容。我见过几个使用 javascript 的解决方案，但我不明白为什么这是必要的，我真的很想只使用 CSS3 来完成它。

我一直在阅读一些 CSS3 规范（[http://www.w3.org/TR/css3-box/#Calculating](http://www.w3.org/TR/css3-box/#Calculating)），虽然有点难以理解，但似乎应该使用“缩小以适应" 如果我​​指定一个自动宽度。但是，它不这样做。例如，在下面的代码中，frame1.html 包含与第二个表中的第一个 td 相同的内容，而 frame2.html 包含与第二个表中的第二个 td 相同的内容：

```
<!doctype html>
<html>
<head>
<title>Frame Test</title>
</head>
<body>
<table>
<tr>
<td><iframe src="frame1.html"></iframe></td>
<td><iframe src="frame2.html"></iframe></td>
</tr>
</table>
<table>
<tr>
<td>Hello</td>
<td>Goodbye ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZ</td>
</tr>
</table>
</body>
</html> 
```

但是，左侧 iframe 中有一堆额外的空间。为什么？我最好的猜测是，iframe 以某种方式在外部标签（例如 html 或 body 标签）中插入了额外的空间，这似乎不太可能，因为萤火虫说大部分空间都在实际文本中，或者自动宽度计算不知何故与 iframe 不同，与 td 不同。（对所涉及的算法进行清晰、易于理解的解释会很好！）我已经尝试了各种宽度和高度设置，一直传播到 html 标记，但我似乎无法得到任何工作。

为什么它不缩小以适应，所以它只使用其元素实际占用的空间？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T06:27:19.747

我想这是因为 an`iframe`实际上并不*包含*HTML/CSS 意义上的“内容”。

It's easy to style things on the actual DOM, and that's what CSS is for. But an `iframe` is a window to a completely different DOM, independent of the parent. The parent page has no knowledge of the "contents" of the `iframe` and therefore can't style the dimensions of the `iframe` to match those contents.

As many, many people will suggest... You should really try to avoid frames. In my experience they're more trouble than they're worth. It's considerably easier to maintain the styles and behaviors within a single DOM.

# c++ - cin/cout 与 char[]

> ID：11381043
> 
> 赞同：1
> 
> 时间：2012-07-08T06:00:20.493
> 
> 标签：c++, char, cin

我正在尝试从 VBA 中建立我在 C++ 方面的整体专业知识，所以请原谅我的代码有任何明显的问题......使用下面这个简单的程序，我得到了意想不到的输出。

```
#include <iostream>

int main() {
char f[]="", c[]="";
std::cin >> f;
std::cout << f << std::endl;
std::cin >> c;
std::cout << f << std::endl;
return 0;
} 
```

运行时，这是我的结果：

> ABC（输入）
> f - ABC（输出）
> DEF（输入）
> f - EF（输出）

还尝试如下：

> ABC DEF（输入）
> f - ABC（输出）
> f - EF（输出）

我希望这两行的输出是相同的，因为我*认为*我只读了`f`一次。此外，如果我`cin`将其应用于`f`，为什么第一次尝试读取整个字符串 ( `ABC`) 而第二次尝试缺少`D`？

我也尝试使用此代码打印结果，但发生了同样的问题，所以我在这里假设这是`cin`and not的问题`cout`。

```
for (j=0;j<3;j++) {
    std::cout << f[j];
}
std::cout << std::endl; 
```

做了一些研究，我发现[了这个问题](https://stackoverflow.com/q/6930859/698590)，看起来很有希望，但是当我将声明从 更改`char f[]`为 时`char *f`，我最终在 上出现了 SEGFAULT `cin`，而`const char *f`甚至无法编译。

我在这里盲目地摸索，希望能得到一些关于如何正确使用`cin`和/或`char`数组的指导。

重申我的问题：**为什么 output`std::cout << f << std::endl;`虽然没有明确地重新分配值，但会以这种方式变化？**

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-08T06:06:48.640

```
char f[]="", c[]=""; 
```

相当于

```
char f[1]="", c[1]=""; 
```

即，它将`f`和声明`c`为一个字符的数组（即`NUL`or `\0`，空终止符）。

换句话说，您正在读取两个数组的末尾，这可以完美地工作，可以做非常奇怪的事情（就像您所看到的那样），可能会崩溃，或者可能让紫色大象在下周二从您的显示器中喷出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T06:15:21.473

看起来您应该使用该`getline`功能。它有两个版本...

一个在 C++ 标准库中，以这种方式使用：

```
std::string s;
// the following returns the stream that you give
// (the cast is non-functional, it's there to show the type)
(istream&)getline(cin, s); 
```

该`string`对象对此很好，因为它会动态调整自身大小以容纳您收到的任何内容。

另一个`getline`在标准 C 库中，至少在 Mac OS X 上（运行`man 3 getline`更多），它使用`FILE*`而不是流。如果您愿意，该版本能够动态重新分配`char`数组，但您不必那样使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-30T18:56:39.437

```
#include < iostream >

int main() {
    char f[]="";
    char c[]=""; 
```

试试这些，它为我解决了问题;D

# silverlight - Silverlight：限制应用程序使用浏览器缩放来调整大小

> ID：11381044
> 
> 赞同：1
> 
> 时间：2012-07-08T06:00:22.757
> 
> 标签：silverlight, browser, zooming

假设我有一个 Silverlight 应用程序。一旦在浏览器中运行，如果我按下`CTRL +`应用程序就会放大并`CTRL -`缩小。简单而常见的行为；问题是一旦用户将应用程序放大到 100% 以上（`ZoomFactor 1`），我的一些控件会被剪裁，而一些控件会消失。这背后的原因可能是视图放置层次结构，这根本不是我头疼的问题。我想要的是限制应用程序的**放大**`ZoomFactor`功能，以便用户在大于 1后无法对其进行缩放。如何做到这一点？我正在尝试以下代码来获取`ZoomFactor`：

```
 App.Current.Host.Content.Zoomed += (s, e) =>
                {
                    double factor=App.Current.Host.Content.ZoomFactor;
                    if(factor>1)
                    {
                        //restricting the app zooming when browser zoom is greater than 1.
                    }
}; 
```

我进行了很多搜索，但找不到可能有帮助的合适答案。有人请帮帮我。提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T17:18:52.957

将此添加到创建 silverlight 对象的 HTML 中：

```
 <param name="enableautozoom" value="false"> 
```

这应该允许 silverlight 对象均匀地放大，而不是剪裁任何对象

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-08T10:48:36.760

我认为最好的办法就是完全禁用缩放：

```
 App.Current.Host.Settings.EnableAutoZoom = false; 
```

但是，老实说，禁用缩放会使视力不佳的用户难以使用您的应用程序。放大的全部目的是让视力不佳的用户更容易看到。如果放大会破坏您的应用程序，则您的应用程序存在可访问性问题。

可以禁用/限制浏览器中的缩放，例如，参见[这个问题](https://superuser.com/questions/40168/how-can-you-disable-zooming-in-internet-explorer-and-firefox)，但这是用户必须在自己的浏览器中执行的操作，而不是 Silverlight 应用程序可以实现的操作。

# android - 可以用字符串调用字符串资源吗？

> ID：11381045
> 
> 赞同：1
> 
> 时间：2012-07-08T06:01:17.653
> 
> 标签：android, android-xml, android-resources

我有一个方法可以从 EditText 中返回大约 20 个可能的字符串之一。这些字符串中的每一个都有一个相应的响应，要从 strings.xml 打印到 TextView 中。有没有办法使用类似的方法从 strings.xml 调用字符串`context.getResources().getString(R.strings."stringFromMethod")`？有没有另一种方法可以从这样的大列表中调用字符串？

我能想到的唯一方法是将每个字符串转换为 int，并使用它在字符串数组或 switch 语句中查找字符串。这两者都涉及大量的 if-else if 语句来将字符串转换为 int，并且如果添加或删除任何字符串，我会采取足够的步骤来更改我更有可能错过一个并有有趣的错误打猎。有什么想法可以干净地做到这一点吗？

编辑：忘记添加，我尝试使用的另一种方法是从

```
int ID = context.getResources().getIdentifier("stringFromMethod", "String", context.getPackageName()) 
```

并取该整数并将其放入

```
context.getResources().getString(ID) 
```

这似乎也不起作用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-08T06:09:35.813

不，你不能。getString() 需要整数格式的资源 id，因此您不能将字符串附加到它。

但是，您可以尝试以下操作：

```
String packageName = context.getPackageName();
int resId = context.getResources().getIdentifier("stringFromMethod", "string", packageName);
if (resId == 0) {
    throw new IllegalException("Unknown string resource!"; // can't find the string resource!
}
string stringVal = context.getString(resId); 
```

上述语句将返回资源 R.string.stringFromMethod 的字符串值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T06:05:05.103

您需要使用反射（非常丑陋但唯一的解决方案）加载 R 类，并通过您的字符串获取相关字段并获取它的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T06:08:19.153

这是我以前在这种情况下做的，我会做一个像

```
int[] stringIds = { R.string.firstCase,
        R.string.secondCase, R.string.thridCase,
        R.string.fourthCase,... };

int caseFromServer=getCaseofServerResponse();
here caseFromServer varies from 0 to wahtever 
```

然后简单地

```
context.getResources().getString(stringIds[caseFromServer]); 
```

# c# - Devexpress 网格详细信息网格与条形图

> ID：11381047
> 
> 赞同：0
> 
> 时间：2012-07-08T06:01:48.163
> 
> 标签：c#, gridview, devexpress

我试图弄清楚如何在 2 个表之间实现主从关系，以便拥有一个带有网格详细信息的网格，就像这个[例子一样](http://documentation.devexpress.com/#WindowsForms/CustomDocument2163)

现在我得到了与上面链接所示相同的结果，但现在我想添加一个“添加”按钮以添加新记录，但这似乎并不容易。我试图创建一个包含一个网格和一个带有“添加”和“编辑”按钮的栏的控件，并在它和主网格之间创建一个关系，但这也不起作用..

谁能给我一个提示如何做到这一点？任何帮助表示赞赏:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T06:29:12.553

您是否尝试过使用[数据导航器](http://documentation.devexpress.com/#WindowsForms/CustomDocument522)？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T15:51:13.243

如果我的理解正确，您希望有一个主详细信息网格，在其上方，一个包含添加和编辑项目的按钮的栏。如果是这样，您可以执行以下操作：

*   如果您希望将您的栏放在表单的顶部，请使用**栏管理器**。

*   否则：尝试使用 Panel 控件，并在其中放置**StandAloneBarDockControl**（使您可以将栏放在表单顶部以外的其他位置），然后使用**栏管理器**和**xtragrid**控件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T14:17:38.683

您是否尝试过使用嵌入式导航器？或者这对你没有解决方案？此外，您可以构建 ContextMenuStrip。这不完全是您要搜索的内容，但也许会有所帮助。

# c# - 将视觉对象添加到自定义 UI 对象

> ID：11381048
> 
> 赞同：0
> 
> 时间：2012-07-08T06:02:07.330
> 
> 标签：c#, wpf, custom-controls

我有一个我在下面创建的自定义 UIElement。

```
class ClickItem : UIElement
{
    public ClickItem()
    {

    }

    public ClickItem(Color color)
    {
        this.Color = color;
        Ellipse _e = new Ellipse();
        _e.Fill = new SolidColorBrush(this.Color);
        _e.StrokeThickness = 1;
        _e.Stroke = Brushes.Black;
        _e.Width = 10;
        _e.Height = 10;
        this.Plotter = _e;
    }

    public Point CenterPoint { get; set; }
    public Ellipse Plotter { get; set; }
    public Color Color { get; set; }
} 
```

如何使`Plotter`Ellipse 成为 UIElement 的视觉对象，因此当我将 a 添加`ClickItem`到画布时，会显示“绘图仪”。

```
Canvas canvas = new Canvas();
ClickItem clickItem = new ClickItem(Colors.Red);
canvas.Add(clickItem); 
```

`ClickItem`我可以做到这一点，但如果我单击它，我不知道如何从中获取。

```
canvas.Add(clickItem.Plotter); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T06:07:32.870

我认为您应该从用户控件或其他一些相关的较低类继承，并将椭​​圆添加为 ClickItem 的子项。

# nlp - Smalltalk 和 tf-idf 算法

> ID：11381050
> 
> 赞同：3
> 
> 时间：2012-07-08T06:03:12.170
> 
> 标签：nlp, smalltalk, ranking, tf-idf

任何人都可以在 Smalltalk 中展示用于自然语言处理的 tf-idf 算法的简单实现或使用示例吗？我在一个名为[NaturalSmalltalk](http://www.squeaksource.com/NaturalSmalltalk.html)的包中找到了一个实现，但它似乎对我的需要来说太复杂了。Python 中的一个简单实现就是[这样](http://code.google.com/p/tfidf/)。

我注意到[Hapax](http://scg.unibe.ch/staff/adriankuhn/hapax)中还有另一个 tf-idf ，但它似乎与软件系统词汇分析有关，我没有找到如何使用它的示例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T07:39:14.133

[TextLint](http://scg.unibe.ch/research/textlint)是一个基于[PetitParser](http://scg.unibe.ch/research/helvetia/petitparser)的系统，用于解析和匹配自然语言中的模式。它没有提供您所要求的内容，但扩展模型以计算词频应该不会太难。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T19:20:18.567

我是 Visualworks 的原始 Hapax 包的作者。Hapax 是一个通用的信息检索包，它应该能够处理*任何*类型的文本文件。我只是碰巧用它来分析源代码文件。

您正在寻找的类是`TermDocumentMatrix`，应该有两种方法`globalWeighting:`，您可以根据需要`localWeighting:`向其中传递和的实例。通常，当提到 tfidf 时，人们的意思是它包括对数项频率。`InverseDocumentFrequency``LogTermFrequency``TermFrequency`

应该有使用小型示例语料库演示 TDM 类的最佳测试。如果测试尚未移植到 Squeak，请告诉我，以便我为您提供示例。

# jquery - + 在 ajax 查询字符串中

> ID：11381058
> 
> 赞同：1
> 
> 时间：2012-07-08T06:04:53.383
> 
> 标签：jquery, ajax, urlencode

如果我在评论变量记录中有 + 符号，则未提交。有什么办法可以在 jquery 中编码查询字符串？我尝试了一些方法，但没有奏效

```
$.ajax({
     type: 'post',
     url: rootURL + 'services/service.php?method=insertcomment',
     data: 'comment=' + comment+'&storyid='+storyid,
     dataType: 'json',
     success: function (data) {
           if(data.code == 200)
                 $('#success-message')..show();
           else
                alert('failure');
     }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T06:08:19.157

您需要将数据编码为 URL。

查看相关帖子：[在 JavaScript 中编码 URL？](https://stackoverflow.com/questions/332872/how-to-encode-a-url-in-javascript)

或将您的数据作为 JSON 对象传递：

```
$.ajax({
     type: 'post',
     url: rootURL + 'services/service.php?method=insertcomment',
     data: {comment : comment, storyid : storyid},
     dataType: 'json',
     success: function (data) {
           if(data.code == 200)
                 $('#success-message').show();
           else
                alert('failure');
     }
}); 
```

# objective-c - UIInterfaceOrientation 对象的返回值是否等于布尔变量？

> ID：11381062
> 
> 赞同：0
> 
> 时间：2012-07-08T06:05:24.773
> 
> 标签：objective-c, ios, uiinterfaceorientation

这是一个关于简单 UIInterfaceOrientation 对象的返回值的相当基本的问题，我尝试以下代码：

```
- (BOOL)shouldAutorotateToInterfaceOrientation: (UIInterfaceOrientation)interfaceOrientation
{
BOOL orientacion = interfaceOrientation;
return orientacion;
} 
```

并且转换做到了，所以我认为 UIInterfaceOrientation 对象等于布尔变量？是隐式错字还是真正的 UIInterfaceOrientation 等于布尔值..

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-08T06:23:34.400

`UIInterfaceOrientation`是一个`enum`，这本质上意味着它是一个整数。整数可以分配给布尔值。许多事情可以——布尔值简单地等同于真或假。如果布尔值设置为等于`0`或`nil`，则为假。如果它被设置为*除*`0`or `nil`（或其他一些d 等价物）之外的任何东西`#define`，那将是真的。由于 UIInterfaceOrientation 是一个枚举（整数），如果它等于 0，则布尔值将为假。如果它不是 0，那将是真的。

的值`UIInterfaceOrientation`：

```
typedef enum {
    UIDeviceOrientationUnknown,
    UIDeviceOrientationPortrait,            // Device oriented vertically, home button on the bottom
    UIDeviceOrientationPortraitUpsideDown,  // Device oriented vertically, home button on the top
    UIDeviceOrientationLandscapeLeft,       // Device oriented horizontally, home button on the right
    UIDeviceOrientationLandscapeRight,      // Device oriented horizontally, home button on the left
    UIDeviceOrientationFaceUp,              // Device oriented flat, face up
    UIDeviceOrientationFaceDown             // Device oriented flat, face down
} UIDeviceOrientation; 
```

此列表中的第一个将等于`0`。下一个`1`，下一个`2`等。所以`UIDeviceOrientationUnknown`将布尔值设置为假；其他任何东西都会将其设置为true。

* * *

无论如何，您都没有正确使用此功能。该函数内部的代码需要阅读：

```
if((interfaceOrientation == someOrientationYouWantToWork) || (interfaceOrientation == someOtherOrientationYouWantToWork)
{
    return YES;
}
else
{
    return NO;
} 
```

将`someOrientationYouWantToWork`etc 设置为我在上面发布的枚举中的值。无论您想工作哪个方向，都可以返回`YES`。否则它将返回`NO`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T06:22:51.123

它不是布尔值，而是枚举值——如果它不是 0，则默认为布尔值“YES”，否则为“NO”。

# android - 如何将小部件添加到 ListView 以滚动项目，但在 ListView 的适配器为空时也可见

> ID：11381064
> 
> 赞同：0
> 
> 时间：2012-07-08T06:05:27.613
> 
> 标签：android, android-layout, android-listview, android-ui

我有一个`ListView`和一个小部件。我希望小部件始终位于顶部`ListView`，并且它应该能够随着项目滚动，但是当适配器中没有项目时它应该仍然可见。这是它不滚动的方式：

![在此处输入图像描述](../Images/62dbea2c5e84975df3783654701c27fd.png)

![在此处输入图像描述](../Images/b6f4520b9ed50ee350fe437b87e931b1.png)

布局文件：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
              android:layout_width="fill_parent"
              android:layout_height="fill_parent"
              android:orientation="vertical">
    <Button
            android:id="@+id/btn_togle_empty"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:text="toggle empty"
            />

    <FrameLayout
            android:layout_width="fill_parent"
            android:layout_height="0dp"
            android:layout_weight="1">
        <ListView
                android:id="@+id/list_test"
                android:layout_width="fill_parent"
                android:layout_height="fill_parent"

                />
        <ViewStub
                android:id="@+id/empty_layout"
                android:layout="@layout/empty"
                android:layout_width="fill_parent"
                android:layout_height="fill_parent"/>
    </FrameLayout>

</LinearLayout> 
```

活动代码：

```
public class MyActivity extends Activity {
    private MyAdapter adapter;
    private ListView v;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_test);
         v = (ListView) findViewById(R.id.list_test);
        View empty = findViewById(R.id.empty_layout);
        v.setEmptyView(empty);
        final MyAdapter adapter = new MyAdapter();
        v.setAdapter(adapter);
        Button btn = (Button) findViewById(R.id.btn_togle_empty);
        btn.setOnClickListener(new View.OnClickListener(){
            @Override
            public void onClick(View view) {
                adapter.togleEmpty();
            }
        });
    }

    private  class MyAdapter extends BaseAdapter {
       boolean empty = false;
        @Override
        public int getCount() {
            return empty ? 0 : 50;
        }

        @Override
        public Object getItem(int i) {
            return new Object();
        }

        @Override
        public long getItemId(int i) {
            return i;
        }

        @Override
        public View getView(int i, View view, ViewGroup viewGroup) {
            TextView v =  new TextView(MyActivity.this);
            v.setText("STRING");
            return v;
        }

        public void togleEmpty() {
            empty = !empty;
            notifyDataSetChanged();
        }
    }
} 
```

我还有一个想法，将小部件添加为标题，但是当它`ListView`为空时它会消失。我怎样才能达到我想要的结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T08:46:24.120

```
 @Override
        public View getView(int i, View view, ViewGroup viewGroup) {
            if (i == 0) { return custom_widget_view; }
        } 
```

# java - 运行 JUnit 测试时找不到类异常

> ID：11381068
> 
> 赞同：129
> 
> 时间：2012-07-08T06:06:00.110
> 
> 标签：java, eclipse, junit

在 Eclipse 中运行 JUnit 测试时出现此错误：

```
Class not found com.myproject.server.MyTest
java.lang.ClassNotFoundException: com.myproject.server.MyTest
    at java.net.URLClassLoader$1.run(URLClassLoader.java:366)
    at java.net.URLClassLoader$1.run(URLClassLoader.java:355)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:354)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:423)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:308)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:356)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.loadClass(RemoteTestRunner.java:693)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.loadClasses(RemoteTestRunner.java:429)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:452)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390) 
```

`JUnit`尽管我使用的是 maven，但我尝试在类路径中添加库，并且 JUnit 库位于 POM 依赖项中。

我已经尝试清理项目并使用适用于 Eclipse 的 JUnit 插件创建了一个新的 JUnit 测试用例，但仍然遇到相同的错误。

* * *

## 回答 #1

> 赞同：137
> 
> 时间：2013-07-21T02:58:13.880

这似乎是因为在您使用时只有源代码在编译`mvn clean compile`（我使用的是 maven 3.1.0，所以我不确定它是否总是这样）。

如果你运行`mvn test`，测试代码也会编译，但是它会运行测试（如果你试图通过 Eclipse 运行它们，这可能不是立即需要的。）解决这个问题的方法是添加`test-compile`到你的 Maven 命令序列中你做一个`mvn clean`。例如，您将运行`mvn clean compile test-compile`.

* * *

## 回答 #2

> 赞同：116
> 
> 时间：2012-11-14T09:05:33.277

我的测试遇到了类似的问题，并且在 Web 的某个地方发现，您必须转到项目属性中的*Build Path并将**Maven Dependencies移到**JRE System Library*之上。这似乎对我有用。

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2014-11-21T13:34:45.020

我遇到了同样的问题，我能够使用@slomek 的[答案](https://stackoverflow.com/a/13375775/209008)解决它，但之后问题又出现了。

我最终通过将我的项目的输出文件夹添加到 JUnit 测试的运行配置来修复它。步骤是：

*   从中找到项目的输出文件夹`Project properties -> Java Build Path -> Default output folder`
    *   通常这是`<project-folder>/bin`
*   去`Run -> Run Configurations...`
*   点击单元测试的运行配置，点击`Classpath`选项卡
*   将项目的输出文件夹显式添加到`User Entries`- 即使项目已经包含在其中
    *   点击`Advanced -> Add folder`添加输出文件夹

这个问题可能是由于 Eclipse 中奇怪的项目设置造成的 - 例如，源文件夹中包含作为单个项目/文件夹导入的嵌套 maven 项目（至少我的项目是这样设置的）。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2016-03-04T06:57:47.937

如果此问题仅在 Eclipse 中发生，则在选定项目上执行命令 Project -> Clean... 可能会有所帮助。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2015-09-28T07:40:22.207

在没有任何改进的情况下在这里尝试了一切之后，我通过重新启动 Eclipse 解决了我的问题

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2019-09-30T19:47:42.023

我通过运行 Maven 更新解决了我的问题。右键单击项目您的项目 > Maven > 更新项目

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2015-10-06T15:47:43.310

就我而言，我有一个错误的 Maven 目录结构。

应该是这样的：

**/src/test/java/com.myproject.server.MyTest **_****

 **在我修好之后 - 一切都像魅力一样。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-06-01T13:37:19.613

就我而言，只有接下来的步骤才能帮助我解决此问题：

1.  项目-> 属性-> 运行/调试设置。
2.  在“为'.....'启动配置”中选择类/项目
3.  编辑->类路径->“恢复默认条目”

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-04-08T08:20:45.533

早些时候，在这种情况下，我总是做 mvn`eclipse:eclipse`并重新启动我的 Eclipse 并且它工作。迁移到 GIT 后，它不再为我工作，这有点奇怪。

这里的基本问题是 Eclipse 先生没有找到已编译的类。然后，我将输出文件夹设置为 Project/target/test-classes，默认情况下它是通过`mvn clean install`不跳过测试生成的，并继续执行以下解决方法：

选项 1：为每个测试用例设置类路径

Eclipse->运行->运行配置->在JUnit下->选择mytest->在类路径选项卡下->选择用户条目->高级->添加文件夹->选择->应用->运行

选项 2：创建类路径变量并将其包含在所有测试用例的类路径中

Eclipse ->Windows ->类路径变量 ->New->[名称：Junit_test_cases_cp | path : ]->ok 然后去 Eclipse->Run ->Run Configurations ->JUnit->select mytest ->under classpath tab ->Select User Entries->Advanced->Add classpath variables->Select Junit_test_cases_cp->ok- >应用->运行

在在线尝试所有建议后，这是目前唯一对我有用的东西。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-07-31T07:11:02.800

我在调试 Junits 的 Eclipse Helios 上遇到了类似的问题。我的问题有点不同，因为我能够成功运行 Junits，但是当我在调试相同的 JUNIT 时遇到 ClassNotFoundException 时。

我已经尝试过 Stackoverflow.com 和其他地方的论坛中提供的各种不同的解决方案，但似乎没有任何效果。在用这些问题敲了近两天之后，我终于找到了解决方案。

如果这些解决方案似乎都不起作用，只需删除在您的工作区中创建的 .metadata 文件夹。这会增加导入项目和您所做的各种配置的额外开销，但这些肯定会解决这些问题。

希望这些有所帮助。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2020-09-22T04:02:34.577

就我而言，从构建路径配置更改 Maven 依赖项的顺序对我不起作用。我从运行配置更改了它的顺序。
遵循这些步骤：
• 转到 Run -> Run Configurations...
• 单击单元测试的运行配置，然后单击 Classpath 选项卡。
• 选中使用临时JAR 来指定类路径（以避免类路径长度限制）。
可能就足够了，您的测试有效。你应该试试，所以按下运行按钮。如果它不起作用。再次执行所有先前的步骤，并且不按“运行”按钮，转到下一步。
• 在用户条目的子分支中，将 Maven 依赖项移动到您的项目或测试类之上。
• 单击运行按钮。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-03-03T10:10:45.190

这些步骤对我有用。

*   删除本地 Maven 存储库的内容。
*   在命令行中运行*mvn clean install 。*（cd 到 pom 目录）。
*   在 Eclipse 中构建项目。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-04-09T11:56:50.733

1- mvn 日食：日食

2-项目清理所有项目

3-重新启动

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-05-04T14:32:27.313

值得一提的另一个答案是，如果您使用的是 eGit，并且您的类路径会因为诸如 Clover 之类的测试覆盖工具而更新，有时会出现清理打嗝并没有完全删除`/path/to/git/repository/<project name>/bin/`

本质上，我使用了 Eclipse 的错误日志视图，确定了在清理工作期间导致问题的原因，导航到源目录，然后手动删除了该`<project name>/bin`目录。完成后，我回到 Eclipse 并刷新（`F5`）我的项目，错误就消失了。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2017-09-18T21:15:46.987

这也可能是由于“[错误] 此环境中未提供编译器。也许您在 JRE 而不是 JDK 上运行？”

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2018-05-18T09:50:26.117

我在一个带有两个资源目录的测试 SourceSet 的 Gradle 项目中遇到了同样的问题。

此片段来自 main-module.gradle，并将资源目录添加到测试 SourceSet：

```
sourceSets {
    test {
        resources {
            srcDir('../other-module/src/test/resources')
        }
    }
} 
```

这样做我有两个与项目主模块的测试 SourceSet 相关的资源目录：

../other-module/src/test/resources src/test/resources （相对于主模块文件夹，由java插件自动添加）

我发现如果我在两个源目录中都有两个同名的文件，那么在进程资源阶段出现了问题。结果，没有开始编译，因此没有将 .class 复制到 JUnit 正在查找类的 bin 目录中。ClassNotFoundException 仅重命名两个文件之一就消失了。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2019-01-11T20:09:14.650

NoClassDefFoundError 真的意味着它不能初始化类。这与寻找课程*无关。*在空字符串上调用 trim() 时出现此错误。

JUnit 不会显示 NullPointerException。正常运行时字符串不为空，因为我从不可用于测试的属性文件中获取字符串。

**我的建议是在你的测试开始通过之前从课堂上删除部分。**然后你可以确定哪一行给出了错误。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2019-08-12T22:10:16.117

似乎是编译问题。将项目作为 Maven 测试运行，然后作为 JUnit 测试运行。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2019-10-11T18:57:31.900

对于不使用 maven 的项目：这对我有用[https://ihategeek.wordpress.com/2012/04/18/eclipse-junit-test-class-not-found/](https://ihategeek.wordpress.com/2012/04/18/eclipse-junit-test-class-not-found/)

在 Order 底部添加 jre 和 project src 并在构建路径中导出

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2019-12-23T11:59:32.627

请检查您是否已将 junit4 添加为依赖项。

例如

```
<dependency>
    <groupId>junit</groupId>
    <artifactId>junit</artifactId>
    <version>4.11</version>
    <scope>test</scope>
</dependency> 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2020-11-26T13:57:15.490

For me I had to put the project x/src/test/java/ at the bottom of the "order and export" in the "java build path"

[![enter image description here](../Images/cbfdafb145d8739d405d40e166b3cd29.png)](https://i.stack.imgur.com/oYv4y.png)

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2017-07-07T10:07:29.833

检查您的项目是否作为 Maven 项目打开，而不仅仅是常规 Java 项目。实际上很简单，但这正是您可能会错过它的原因。

* * *

## 回答 #23

> 赞同：-1
> 
> 时间：2019-04-16T10:48:22.000

我也遇到过同样的问题。我通过删除外部 JUnit jar 依赖项解决了这个问题，该依赖项是通过从 Internet 外部下载添加的。但是后来我去了项目->属性->构建路径->添加库->junit->选择了版本（ex junit4）->应用。

它自动添加了依赖项。它解决了我的问题。

* * *

## 回答 #24

> 赞同：-1
> 
> 时间：2019-06-27T06:51:56.253

进行一些虚拟更改并保存测试类可以解决问题。它将自动构建 .class

* * *

## 回答 #25

> 赞同：-6
> 
> 时间：2014-08-22T09:42:00.477

可能是您忘记将**Main 类**和**Test Case 类**放在 /src/test/java 中。检查一次。**

# android - Javah 找不到 jni/android-ndk 的指定库

> ID：11381072
> 
> 赞同：0
> 
> 时间：2012-07-08T06:07:24.093
> 
> 标签：android, android-ndk, java-native-interface

所以，我已经尝试了我所知道的一切可能。我跑了一个`export CLASSPATH=/path/to/bin/classes`，它仍然无法找到输出。我已经尝试从`$PWD/bin/classes`项目的根目录运行命令，但仍然无法使其正常工作。我有最新版本的 ndk（撰写本文时为 r8-1）和 sdk。通过命令行等生成头文件

到目前为止，我[在使用 Jni 时看到了 Javah 错误](https://stackoverflow.com/questions/986262/javah-error-while-using-it-in-jni)，以及另一个指定相同问题并收到相同答案的问题。

我在 x86_64 中运行 Arch Linux（特别是 Archbang）。

这是我的调用和输出（从 执行`$PROJECT_ROOT/bin/classes`）：

`javah -d ../../jni com.example.fibonnacinative.libfib`

`Error: Could not find class file for 'com.example.fibonnacinative.libfib'`

我已经尝试使用`-classpath`,`-verbose`等标志，但似乎都没有帮助。`-classpath`只是吐出同样的错误，`-verbose`除了我发布的输出之外没有给我任何信息。

哈普？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T03:49:22.313

是的！这是基于我的愚蠢。

我应该`LibFib`通过键入`com.example.fibonnacinative.LibFib`而不是`libfib`.

注意：类本身通常是驼峰式大小写，而 package 指令的其余部分是小写的。请注意，这些只是约定。

对不起各位。

# c# - 如何将 Flash 内容获取到 C# 应用程序？

> ID：11381084
> 
> 赞同：0
> 
> 时间：2012-07-08T06:09:39.010
> 
> 标签：c#, html, flash

好的，这就是我想要做的：

我的网站上有一个 Flash 程序，可以与人聊天。人可以加入，大厅里有显示人的列表，可以做私人聊天室，也可以视频聊天，还有公共聊天室。

任何人都可以加入并开始聊天。现在我想用 C# 开发一个桌面应用程序，它做同样的事情，但我想将此桌面应用程序与我网站上的 flash 进行交互。

我应该能够让 Flash 程序中的人访问 C# 应用程序，与 C# 应用程序中的人与 Flash 应用程序中的人进行视频聊天，反之亦然。

这也允许与我网站上的人聊天。闪聊程序不是我自己开发的，是从别人那里买的。这意味着我不知道它的代码，我仍然不知道从哪里开始。如果你能告诉我一些真的很有帮助的方法！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T06:21:16.867

您可以使用 ActiveX control Object for .net，这是一个很好的入门教程（在[c# 和嵌入式 Flash 应用程序之间进行通信](http://blog.another-d-mention.ro/programming/communicate-betwen-c-and-an-embeded-flash-application/)）

# forms - 覆盖表单模板 Symfony2，树枝元素？

> ID：11381087
> 
> 赞同：2
> 
> 时间：2012-07-08T06:10:40.513
> 
> 标签：forms, symfony, widget, overriding, twig

我正在尝试覆盖某些表单的模板。

这个就是其中之一

```
 public function buildForm(FormBuilder $builder, array $options)
    {
        $builder
            ->add('nombreBD','text', array( 'required' => true, 'label' => 'Nombre Base de Datos: '))
            ->add('Servidor','choice', array(
                            'choices'   => array('1' => 'Si', '0' => 'No'),
                            'required'  => true,
                            'multiple'  => false,
                            'expanded'  => true,
                            'label' => 'Servidor Existente?',

                  ))
            ->add('ServidorBD','entity',
                  array ('class' => 'MonseWebBundle:ServidoresBD',
                        'multiple' => true, 
                        'required' => true, 
                        'label' => 'Servidor de Base de Datos: ',
                         'query_builder' => function(EntityRepository $er) {
                         return $er->createQueryBuilder('u')
                         ->orderBy('u.url', 'ASC');
                                                                           },
                         ))
            ;
    } 
```

这是模板

```
{% block text_widget %}
<div class="round full-width-input" id="full-width-input">
    <input type="text" {{ block('attributes') }} value="{{ value }}" >
</div>
{% endblock %} 
```

我想我在文本输入中取得了成功，但我不知道如何设置实体的输入和单选按钮（选择）的输入，因为我不知道信息的存储位置。例如，我不太清楚块 ('attributes') 和 {{value}] 返回什么。就像我不知道如何选择单选按钮一样。

我想用这个：

```
<label for="dropdown-actions">Dropdown</label>

                                    <select id="dropdown-actions">
                                        <option value="option1">Select your action here</option>
                                    </select> 
```

对于实体“ServidoresBD”和这个：

```
<label for="selected-radio" class="alt-label"><input type="radio" id="selected-radio" checked="checked" />A selected radio</label>
                                        <label for="unselected-radio" class="alt-label"><input type="radio" id="unselected-radio" />An uselected radio</label> 
```

对于单选按钮。

此外，出于一个奇怪的原因，所有项目中的所有标签都显示为大写，无论我放置什么样式。总是，这真的很烦人。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-08T10:15:01.010

默认的表单主题存储在 Twig 桥下。[在这里](https://github.com/symfony/symfony/blob/master/src/Symfony/Bridge/Twig/Resources/views/Form/form_div_layout.html.twig)，您可以找到在表单主题中定义的所有块。

只要看看这个文件和 IMO，你就会明白你需要做什么。:)

希望有帮助。

# php - 上传后，ARRAY 在重命名文件名之前 - PHP

> ID：11381088
> 
> 赞同：0
> 
> 时间：2012-07-08T06:11:08.543
> 
> 标签：php, arrays, renaming

我正在运行一个 PHP 脚本来从 HTML 表单上传文件，重命名它们并将它们放在我的服务器上。它正在上传和重命名，但是现在每个文件名都以“Array”一词开头，
即：`ArrayTest Document v1.0.pdf`
我相当确信它不是我的`$newfn`变量，因为我在表格中显示它并且它没有显示出来。

```
//This gets all the other information from the form
$name=$_POST['docname'];
$version=$_POST['docver'];
$date=$_POST['docdate'];
$type=$_POST['doctype'];
$author=$_POST['docauth'];
$file=$_FILES['uploaded']['name'];

//target directory is assigned
$target = $directory;
$target = $target . basename($file) ;

//grab file extension
$filetypes = array(
'image/png' => '.png',
'image/gif' => '.gif',
'image/jpeg' => '.jpg',
'image/bmp' => '.bmp',
'application/pdf' => '.pdf');
$ext = $filetypes[$_FILES['uploaded']['type']];

//generate new filename variable "name v??.xxx"
$newfn = $name . ' ' . 'v' . $version . $ext;

//Check to see if file exists
if (file_exists($directory . $file))
{
echo $_FILES["uploaded"]["name"] . " already exists. ";
}
else
{
//if its a new file, change name and upload
    if (move_uploaded_file($_FILES["uploaded"]["tmp_name"],
        $directory . $_FILES["uploaded"] . $newfn))
        {
        echo "The file ". basename($file). " has been uploaded";
        }
        else
        {
        echo "Sorry, there was a problem uploading your file.";
        }
} 
```

我觉得它与命令`$FILES['uploaded']`中的我的部分有关`move_uploaded_file`。我试过谷歌搜索，但只要我提到“数组”，我的谷歌搜索结果就完全不同了。

**好的，多亏了下面我解决了它。对于将来的任何人，我删除了整个`$_FILES`数组，因此代码读取为**

```
//if its a new file, change name and upload
if (move_uploaded_file($_FILES["uploaded"]["tmp_name"],
    $directory . $newfn)) 
```

现在所有内容都以正确的名称结构上传。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T06:49:31.070

应该

```
move_uploaded_file($_FILES["uploaded"]["tmp_name"],$directory . $_FILES["uploaded"]["name"] . $newfn) 
```

您忘记在 $_FILES["uploaded"] 之后包含 ["name"]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T06:50:01.967

在您的 move_uploaded_file 中，您使用整个`$_FILE['uploaded']`数组作为名称，而不仅仅是文件名。一个小调整：

```
if (move_uploaded_file($_FILES["uploaded"]["tmp_name"],
        $directory . $_FILES["uploaded"]["name"] . $newfn))
        { 
```

你应该一切都好。

# html - 图像 (.png) 未在 Chrome、firefox 和 mobile-safari 中显示

> ID：11381091
> 
> 赞同：2
> 
> 时间：2012-07-08T06:11:39.683
> 
> 标签：html, image, firefox, google-chrome, mobile-safari

我有这张图片：

```
<a href="home.php" id="logo"><img src="images/myimages.png" alt=""></a> 
```

它仅适用于 Safari。它不会在 Chrome、firefox 或 Safari 'Mobile'（iPad、iPhone）中显示。

任何原因？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-08T06:26:03.477

您的文件似乎是已重命名为 .png 的 PSD (Adobe Photoshop) 文件。

将其存储为适当的 PNG。

# ruby-on-rails - if/else 在 erb 执行代码中不应该

> ID：11381094
> 
> 赞同：2
> 
> 时间：2012-07-08T06:12:34.560
> 
> 标签：ruby-on-rails, ruby, erb

**感谢**大家为我提供信息！有一些非常迅速的反应。我的解决方案是在 if 中使用更清晰的测试。语法胜利！

“你没想到有一个 nil 对象！评估 nil.name 时出错”

此错误指向下面带有“file.name”的行。

我明白为什么它评估为 nil.name 并且是空的（应该是）但我不明白为什么该代码甚至被执行。

它通过更改 if to 的测试来工作。

```
if file[0] != nil 
```

我觉得我缺少一个重要的细节，所以我很感激能帮助我理解这一点。

在我看来，我有：

```
<table>
  <tr>
    <th>File</th>
    <th>Description</th>
  </tr>

  <% if !@files.empty? %>
    <% @files.each do |file| %>
    <tr>
      <td><%= file.name %></td>
      <td><%= file.description %></td>
      <td><%= link_to "Download", :controller => "files", :action => "download", :id => file.id %></td>
      <td><%= button_to "Delete", { :controller => "files", :action => "destroy", :id => file.id }, :method => "delete" %></td>
    </tr>
    <% end %>

  <% else %>

  <tr>
    <td><b>No files</b></td>
  </tr>

  <% end %>
</table> 
```

在控制器中，我创建了一个名为 @files 的空数组，然后在创建它们时将值推入。

Ruby 1.8.7-p72 Rails 2.2.2

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T10:15:18.340

您在`@files`实例 var 中想要的是一个空数组

```
@files = [] 
```

或实际`File`物体

```
@files = File.all 
```

但是您似乎以某种方式生成了一个包含`nil`元素的数组，例如

```
@files = [nil, <#File>, <#File>] 
```

所以@files 本身不是零，而它的第一个元素是。因此，以下代码返回`true`

```
@files.any? 
```

这相当于

```
!@files.empty? 
```

因为`@files.is_a? Array`和`not @files.nil?`。您的问题必须在相应的控制器中，您似乎在其中添加了一个`nil`元素到您的`@files`.

# css - 如何使用 CSS 反转标题和正文的浮动顺序？

> ID：11381095
> 
> 赞同：0
> 
> 时间：2012-07-08T06:12:43.247
> 
> 标签：css, layout, css-float

在不改变 HTML 结构的情况下：

```
<div id="container">
  <header>
    <h1>This is the Heading Which May be Long and Span Lines</h1>
  </header>
  <section>
    <div class="thumb">
        <img></img>
    </div>
    <div class="content">
      <p>Content</p>
      <p>continues</p>
      <p>and wraps around the thumb</p>
    </div>
  </section>
</div>​ 
```

我需要对其进行样式设置，以便`img.thumb`浮动左侧，`header h1`右侧悬挂，并且可以换行。`h1`应该左对齐：

```
+------------+   Heading Text which May Be Long and
|            |   Thus would Span Lines
|   thumb    |
|            |   Content
+------------+   continues
and wraps around the thumb. 
```

布局（即标题和内容的宽度）应该流畅地适应容器的宽度。（拇指是固定宽度。）

有什么方法可以在不改变元素顺序的情况下使用 CSS3 实现这一点？我可以通过固定右列的宽度来做到这一点，但是有没有办法指定“使用浮动右侧的剩余空间作为宽度”？（没有javascript，更少等）

在这里摆弄：http: [//jsfiddle.net/agRx3/1/](http://jsfiddle.net/agRx3/1/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T06:28:43.247

由于拇指具有固定的宽度，您可以使用它`position: absolute`来固定图像的位置。然后标题和内容可以具有`margin-left`略大于拇指宽度

小提琴：http: [//jsfiddle.net/SJvav/](http://jsfiddle.net/SJvav/)

编辑：要让内容围绕边距，让图像和文本为图像和文本并给图像一个负边距，因此它就在[http://jsfiddle.net/SJvav/2/](http://jsfiddle.net/SJvav/2/)`float:left`旁边`h1`

# javascript - Firefox 扩展应用 RESTClient 如何避免 CORS？

> ID：11381099
> 
> 赞同：2
> 
> 时间：2012-07-08T06:13:27.943
> 
> 标签：javascript, jquery, xmlhttprequest, google-closure

我正在尝试发出一个简单的 POST 请求，但仍然没有成功。

标题从

> 编码：UTF-8 Http 方法：POST 内容类型：application/x-www-form-urlencoded;charset=UTF-8

到

> Http 方法：选项内容类型：

我了解当我尝试使用 Google Closure XhrIo 访问我的服务器时，它会导致预检并导致我的 POST 请求失败。

但是[Firefox 扩展应用程序 RESTClient](http://code.google.com/p/restclient/source/browse/extension/chrome/content/restclient.js)和一个类似的 Chrome 应用程序可以使用 XMLHttpRequest 访问，它们不会导致预检。如何以及为什么？

PS：我不是 JS 专业人士，我无法理解这段代码[http://code.google.com/p/restclient/source/browse/extension/chrome/content/restclient.js](http://code.google.com/p/restclient/source/browse/extension/chrome/content/restclient.js)的复杂性。

任何帮助表示赞赏

埃迪。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T16:23:01.653

[在HTML5Rocks.com](http://www.html5rocks.com/en/tutorials/cors/)上找到了这条有价值的信息

来自 Chrome 扩展的跨域

Chrome 扩展以两种不同的方式支持跨域请求：

*在 manifest.json 中包含域 -如果*域包含在 manifest.json 文件的“权限”部分中，Chrome 扩展程序可以向任何域发出跨域请求：“permissions”：[“http://*.html5rocks. com"] 服务器不需要包含任何额外的 CORS 标头或做任何其他工作以使请求成功。

CORS request - If the domain is not in the manifest.json file, then the Chrome extension makes a standard CORS request. The value of the Origin header is "chrome-extension://[CHROME EXTENSION ID]". This means requests from Chrome extensions are subject to the same CORS rules described in this article.

# iphone - 从异步运行 Disptach 同步块

> ID：11381104
> 
> 赞同：0
> 
> 时间：2012-07-08T06:14:18.293
> 
> 标签：iphone, ios, multithreading, queue, dispatch

我是调度队列的新手，现在正试图通过这个调度队列调用后台操作。

在这里我有一个疑问，请帮助我。在下面的示例中，

whatQueue:- 应该是 mainQueue、queueA 还是我应该创建一个新队列？

dispatch_queue_t queueA = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);

```
dispatch_async(queueA, ^{
     NSMutableArray * items = listofItems;
    for(NSString * str in items)
    {
         //Run a sync block to send str to server
        dispatch_sync(***whatQueue***, ^{

        });
    }
}); 
```

谢谢， 帕尼

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T06:36:59.710

用于`dispatch_get_main_queue`嵌套调度（毕竟，我假设您希望在主线程上进行同步调度以进行 UI 更新）。否则，您已经在后台运行，不需要进一步调度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T06:55:09.297

对于希望以同步方式执行内部块的原因，您并没有解释太多。我假设你想要：

1.  序列化将字符串发送到服务器；

2.  在继续之前等待所有字符串发送。

在这种情况下，您可以：

1.  在同一个 queueA 上执行网络任务（不需要新的调度）；

2.  确保您的底层网络层（NSURLConnection/AFNetworking/ASIHTTP/...）正在执行同步网络操作（否则，网络请求将立即返回并在其自己的线程中在后台完成）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T06:58:57.890

感谢您的回复，

我不想在 UI 上更新任何东西，只想在不影响用户界面的情况下将离线数据推送到服务器。

所以主调​​度队列迭代所有记录，并且应该使用嵌套队列发送记录同步模式，并且每个请求的响应也应该处理。

# java - Java中如何从整个数据库中导出数据？

> ID：11381107
> 
> 赞同：3
> 
> 时间：2012-07-08T06:14:38.760
> 
> 标签：java, sql, xml, database

有一个代码可以从 xml 中的数据库中导出数据。

```
 public class DataExtractor{

   private final String login, passwd, host;

   public DataExtractor(String login, String passwd, String host){
       this.login = login;
       this.passwd = passwd;
       this.host = host;
   }

   public String getTableData(String tableName) throws SQLException, ClassNotFoundException {
       Connection con = null;
       Statement st = null;
       ResultSet rs = null;
       try {
           Class.forName("com.mysql.jdbc.Driver");
           con = DriverManager.getConnection("jdbc:mysql:///" + host, login, passwd);

           st = con.createStatement();
           rs = st.executeQuery("select * from " + tableName);

           ResultSetMetaData rsmd = rs.getMetaData();
           int colCount = rsmd.getColumnCount();

           StringBuilder b = new StringBuilder("<table>\n");

           int num = 1;
           while (rs.next()) {
               b.append("<row>");
               b.append("<num>").append(num++).append("</num>");
               for (int i = 1; i <= colCount; i++) {
                   String columnName = rsmd.getColumnName(i);
                   b.append('<').append(columnName).append('>');
                   b.append(rs.getObject(i));
                   b.append("</").append(columnName).append('>');
               }
               b.append("</row>\n");
           }
           b.append("</table>");
           return b.toString();
       } catch (SQLException e) {
           throw e;
       } catch (ClassNotFoundException e) {
           throw e;
       } finally {
           if (rs != null)
               try {
                   rs.close();
               } catch (SQLException e) {
               }
           if (st != null)
               try {
                   st.close();
               } catch (SQLException e) {
               }
           if (con != null)
               try {
                   con.close();
               } catch (SQLException e) {
               }
       }
   }
} 
```

但是这个类只导出给定表的数据，如何保证数据是从整个数据库（即所有表）导出的，而不是从特定表导出的。也就是说，应该得到输出的 XML 文件类型：

```
 <database>
      <table1>
             <id> </ id>
             <Name> </ Name>
                           ...
       </ table1>

        <table2>
               ...
       </ table2>

</ database> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T06:18:49.900

采用：

```
show tables 
```

然后遍历表格并调用您的方法`getTableData()`

您可能还需要考虑获取列名称：
`SHOW columns FROM table`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T06:28:02.087

您可以使用它：[dbsql2xml](http://dbsql2xml.sourceforge.net/)是用于将关系数据库转换（导出、转换）为分层 XML 的 Java 工具（类）。它需要 JRE 5.0、JDBC 和 SQL DBMS。“dbsql2xml”使用 XML 文档将数据库表和列映射到树 XML 的元素

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T08:14:35.047

[Dbunit](http://www.dbunit.org/faq.html#extract)是一个成熟的工具，用于将数据库数据作为 XML 进行操作。

另一个用于从数据库中提取相关数据子集的工具是[jailer](http://jailer.sourceforge.net/)。它还支持 dbunit XML 格式。

# php - 发布旧令牌的反 CSRF 实现

> ID：11381108
> 
> 赞同：0
> 
> 时间：2012-07-08T06:14:55.877
> 
> 标签：php, http-post, csrf

我在登录表单上实施 CSRF 保护时遇到了一些麻烦。这是登录的一般流程：

这包含在登录页面的顶部：

```
// Create CSRF token
$token = $auth->random(64); // 64 psuedorandom characters from /dev/urandom
$_SESSION['token'] = $token; 
```

登录表格：

```
<form action="<?php echo $_SERVER['PHP_SELF']; ?>" method="post">
<input type="text" name="username" />
<input type="password" name="password" />
<input type="hidden" name="token" value="<?php echo $token; ?>" />
<input type="submit" name="login" value="Login" />
</form> 
```

最后，当表单在页面下方提交时：

```
if (isset($_POST['login'])) {

    // Bind input to variables
    $username = isset($_POST['username']) ? $_POST['username'] : '';
    $password = isset($_POST['password']) ? $_POST['password'] : '';
    $posttoken = isset($_POST['token']) ? $_POST['token'] : '';

    // Attempt to login
    $auth->login($username, $password, $posttoken);

} 
```

当 $auth->login 收到输入时，问题就开始了。$_SESSION 令牌等于生成的令牌，但 $_POST 令牌等于 $_SESSION 令牌在上次提交期间的值。

来自 $auth->login 的示例 var_dumps：

首先提交 var_dump：

```
$_SESSION Array
[token] => 00a28586a1a89b30149ef130ca6f3c01a25435ad1b0ad1a19326205c75b80d79

$_POST Array
[username] => 
[password] => 
[token] => 2200bb8663f19d66639a7f4791ddb53c9d510802d0ed76c42ac8b3f6d9e1589a
[login] => Login 
```

第二次提交var_dump：

```
$_SESSION Array
[token] => e093e312b379d766d46083d616fa8655f1565dc19ed6b1f73108546cb5f43fce

$_POST Array
[username] => 
[password] => 
[token] => 00a28586a1a89b30149ef130ca6f3c01a25435ad1b0ad1a19326205c75b80d79
[login] => Login 
```

第三次提交var_dump：

```
$_SESSION Array
[token] => 8be7ecbdae6274d1ba5ce9e8ace0af7c76e3e7d181c507d3da9b8c35652865cc

$_POST Array
[username] => 
[password] => 
[token] => e093e312b379d766d46083d616fa8655f1565dc19ed6b1f73108546cb5f43fce
[login] => Login 
```

如果您仔细观察，您会发现 $_POST 令牌只是向下移动——变成了上次提交期间的 $_SESSION。

这让我很困惑，因为`$token`并且`$_SESSION['token']`只在页面顶部设置了一次——当用户点击提交时它们不应该不同。

总而言之，$_SESSION 包含当前生成的令牌，而 $_POST 包含先前生成的令牌。

有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T07:08:45.973

问题是会话令牌在登录处理代码之前被更改，您需要将令牌生成位移动到登录处理代码之后。

# android - MediaStore.Images.Media.getBitmap 和内存不足错误

> ID：11381113
> 
> 赞同：16
> 
> 时间：2012-07-08T06:16:07.840
> 
> 标签：android, bitmap, imageview, out-of-memory

我的代码是：

```
public Bitmap loadPhoto(Uri uri) {
    Bitmap scaled = null;
    try {
    scalled = Bitmap.createBitmap(
      MediaStore.Images.Media.getBitmap(getContentResolver(), uri),
      0,0,90, 90);

    if (scaled == null) { return null; }
    } catch(Exception e) { }
    return scaled;
} 
```

在这之后。我在 ImageView 中显示缩放。每个图像都来自设备相机。

每次，我都会收到错误消息：显示相机中的三张照片后**内存不足。**如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2019-08-20T10:02:57.387

Praveen Katha 的答案将始终返回 null。这是更新的答案。

这是诀窍，每次使用后关闭输入流。输入流意味着使用一次。有关更多信息，请按照此[答案](https://stackoverflow.com/questions/2503628/bitmapfactory-decodestream-returning-null-when-options-are-set#answer-2528718)

```
private static int calculateInSampleSize(
            BitmapFactory.Options options, int reqWidth, int reqHeight) {
        // Raw height and width of image
        final int height = options.outHeight;
        final int width = options.outWidth;
        int inSampleSize = 1;

        if (height > reqHeight || width > reqWidth) {

            final int halfHeight = height / 2;
            final int halfWidth = width / 2;

            // Calculate the largest inSampleSize value that is a power of 2 and keeps both
            // height and width larger than the requested height and width.
            while ((halfHeight / inSampleSize) >= reqHeight
                    && (halfWidth / inSampleSize) >= reqWidth) {
                inSampleSize *= 2;
            }
        }

        return inSampleSize;
    }

    public static Bitmap decodeSampledBitmapFromUri(Context context, Uri imageUri, int reqWidth, int reqHeight) throws FileNotFoundException {
        Bitmap bitmap = null;
        try {
            // Get input stream of the image
            final BitmapFactory.Options options = new BitmapFactory.Options();
            InputStream iStream = context.getContentResolver().openInputStream(imageUri);

            // First decode with inJustDecodeBounds=true to check dimensions
            options.inJustDecodeBounds = true;
            BitmapFactory.decodeStream(iStream, null, options);
            if (iStream != null) {
                iStream.close();
            }
            iStream = context.getContentResolver().openInputStream(imageUri);

            // Calculate inSampleSize
            options.inSampleSize = calculateInSampleSize(options, reqWidth, reqHeight);

            // Decode bitmap with inSampleSize set
            options.inJustDecodeBounds = false;
            bitmap = BitmapFactory.decodeStream(iStream, null, options);
            if (iStream != null) {
                iStream.close();
            }
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
        return bitmap;
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-03-03T00:25:49.753

尝试使用 BitmapFactory 解决问题[http://developer.android.com/reference/android/graphics/BitmapFactory.html](http://developer.android.com/reference/android/graphics/BitmapFactory.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-08-22T14:15:52.453

对于那些正在寻找代码示例的人：

```
private static int calculateInSampleSize(
        BitmapFactory.Options options, int reqWidth, int reqHeight) {
    // Raw height and width of image
    final int height = options.outHeight;
    final int width = options.outWidth;
    int inSampleSize = 1;

    if (height > reqHeight || width > reqWidth) {

        final int halfHeight = height / 2;
        final int halfWidth = width / 2;

        // Calculate the largest inSampleSize value that is a power of 2 and keeps both
        // height and width larger than the requested height and width.
        while ((halfHeight / inSampleSize) >= reqHeight
                && (halfWidth / inSampleSize) >= reqWidth) {
            inSampleSize *= 2;
        }
    }

    return inSampleSize;
}

public static Bitmap decodeSampledBitmapFromUri(Context context, Uri imageUri, int reqWidth, int reqHeight) throws FileNotFoundException {

    // Get input stream of the image
    final BitmapFactory.Options options = new BitmapFactory.Options();
    InputStream iStream = context.getContentResolver().openInputStream(imageUri);

    // First decode with inJustDecodeBounds=true to check dimensions
    options.inJustDecodeBounds = true;
    BitmapFactory.decodeStream(iStream, null, options);

    // Calculate inSampleSize
    options.inSampleSize = calculateInSampleSize(options, reqWidth, reqHeight);

    // Decode bitmap with inSampleSize set
    options.inJustDecodeBounds = false;
    return BitmapFactory.decodeStream(iStream, null, options);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-03-07T15:53:29.587

MediaStore.getBitmap 方法是一种方便的方法，在获取位图时不指定样本大小。如果您正在使用 getBitmap(ContentResolver, Uri)，并且想要使用样本大小，只需使用 ContentResolver 获取输入流，然后像往常一样解码位图（先计算样本大小，然后使用适当的加载样本量）。

# android - 尝试（和失败）实现 ActionBarSherlock

> ID：11381120
> 
> 赞同：0
> 
> 时间：2012-07-08T06:19:39.930
> 
> 标签：android, android-actionbar, actionbarsherlock

我正在尝试在我现有的应用程序中实现 ActionBarSherlock，但我遇到了一些麻烦，所以我决定创建一个新应用程序，看看我是否可以让它在那里工作。

我创建了一个新的 android 项目，导入了 ABS 库，然后将我的新 Android 项目设置为使用该库。为了测试它是否有效，我转到我的清单并将我的应用程序的主题设置为`@style/Theme.Sherlock`. 我在我的手机（4.1）上运行它，我得到了全息主题，但是当我在我的模拟器（2.2）上运行它时，我得到了中间的文本（Hello World）但没有操作栏。想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T06:25:33.713

确保您是从带有`Sherlock`-prefixed 的活动类扩展而来的。（例如，`SherlockActivity`，`SherlockFragmentActivity`）

# graphics - Ocaml Graphics.open_graph 在脚本模式下不起作用

> ID：11381121
> 
> 赞同：1
> 
> 时间：2012-07-08T06:20:21.923
> 
> 标签：graphics, ocaml, x11

我正在尝试使用 ocaml 图形模块。该行：

```
#Graphics.open_graph "";; 
```

在交互模块中工作正常，即在 X11 中弹出一个白色背景的小窗口。但是，当我尝试使用脚本模式时——将这一行放在一个文件中然后编译它：

```
ocamlc -o a.out graphics.cma code.ml 
```

只有 X11 启动但没有弹出窗口。我正在使用Mac。有谁知道为什么？谢谢。

* * *

跟进：

似乎在脚本模式下，弹出窗口将在代码执行后立即关闭。因为如果我使用 XTerminal 进行编译，我可以看到一个小窗口弹出但随后关闭。

我设法通过在底部添加一个无限循环来保持窗口打开：

```
while true do () done;; 
```

但仍然不明白事情是如何运作的。请帮忙。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T07:06:13.190

当脚本终止时，所有资源都被释放：内存、文件描述符，包括 X 窗口。

如果添加无限循环，脚本不会终止，并且窗口保持打开状态。

同样，在顶层下，只要您不关闭顶层，窗口就会保持打开状态。

我建议添加两行添加脚本的末尾：

*   print "按回车退出"
*   从键盘输入中读取一行

这样脚本在用户按下回车之前不会终止。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T07:17:06.897

事实上，正如 jrouquie 解释的那样，您需要延迟程序的终止。我个人这样做的方式是等待用户输入。在交互式程序（或正在研究的打开图形模式的功能）结束时，我输入：

```
ignore (Graphics.read_key ()) 
```

这将等到键盘上的键被击中，并在返回之前忽略键值。

# scala - javap编译时有/没有断言的区别

> ID：11381122
> 
> 赞同：4
> 
> 时间：2012-07-08T06:20:23.247
> 
> 标签：scala, javap

*不耐烦的 Scala*第 15 章练习 10：添加`assert(n >= 0`到`factorial`方法。在启用断言的情况下编译并验证是否`factorial(-1)`引发异常。编译没有断言。发生什么了？用于`javap`检查断言调用发生了什么。

我的代码：

```
object Test {
  def factorial(x: Int): Int = {
    assert(x >= 0, "Call to factorial must be >= 0!")
    x match {
      case 0 => 1
      case x: Int => x * factorial(x - 1)
    }
  }

  def main(args: Array[String]): Unit = {
    factorial(-1)
  }
} 
```

我`scalac`首先编译，使用检查`javap Test`，然后再次编译`scalac -Xelide-below MAXIMUM`并使用相同的命令检查 - 我似乎无法找到两者之间的区别。

我知道当我尝试执行程序时使用断言编译会抛出异常，而没有断言编译会导致堆栈溢出错误，但我找不到`javap`...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-08T14:23:52.833

当我尝试这个时，`javap -v`我在启用断言的版本中发现以下行，但在其他版本中没有：

```
 20:  invokevirtual   #27; //Method scala/Predef$.assert:(ZLscala/Function0;)V
   ...
   27:  if_icmpne       34
   30:  iconst_1
   31:  goto    55 
```

所以这看起来肯定没问题。

问题可能是您没有查看字节码（这需要`-c`or`-v`标志`javap`），或者 - 更有可能 - 您正在查看类的输出`javap`，`Test`而不是`Test$`. 有关更多详细信息，请参见示例*[Scala 中的编程：](http://www.artima.com/pins1ed/combining-scala-and-java.html)*

> 对于每个 Scala 单例对象，编译器将为该对象创建一个 Java 类，并在末尾添加一个美元符号。对于名为 的单例对象`App`，编译器会生成一个名为 的 Java 类 `App$`。此类具有 Scala 单例对象的所有方法和字段。

如果您列出已编译的目录的内容，您将看到`Test.class`和`Test$.class`。Using`javap -v Test$`会告诉你后者，这就是你会发现不同之处的地方。

# gnupg - 如何使用 gpg 命令行检查密码是否正确

> ID：11381123
> 
> 赞同：117
> 
> 时间：2012-07-08T06:20:40.363
> 
> 标签：gnupg

我正在尝试使用 自动备份`duplicity`，但是当我测试结果时，我得到了

> gpg：公钥解密失败：密码错误

我想检查我正在使用的密码是否实际上是与相应 gpg 密钥关联的密码，但我在 gpg 命令行选项中看不到“不要加密或解密任何东西。只需确认我使用了正确的密码。”

这表明我可能（再次）误解了 Gnu Privacy Guard。*（它喜欢嘲弄我直到我哭。）*

要求 gpg 验证密码是否有意义？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：122
> 
> 时间：2012-07-14T14:04:57.147

没有内置的方法可以做到这一点，但它很简单，可以创建一个不修改任何内容并允许您检查密码的测试。

您没有指定，所以我假设您使用的 GnuPG 版本低于 v2，并且在 Linux 上使用 Bash 作为命令行解释器。

我将在这里和下面给出命令我将解释每个部分的作用 - （注意：以下是 GnuPG 系列版本 1，GnuPG 系列 v2 见下文）

`echo "1234" | gpg --no-use-agent -o /dev/null --local-user <KEYID> -as - && echo "The correct passphrase was entered for this key"`

首先，将一些文本通过管道传递给 GnuPG，`echo "1234" |`因为我们真的不想签署任何东西，这只是一个测试，所以我们将签署一些无用的文本。

接下来，我们告诉 gpg 不要将密钥代理与`--no-use-agent`;一起使用。这在以后很重要，因为根据您的密钥代理，它可能不会在成功时返回“0”，这就是我们想要做的 - 验证您的密码是否成功。

接下来，我们告诉 gpg 将签名数据直接放入`/dev/null`文件中，这意味着我们将其丢弃而不将结果写入终端——注意：如果您使用的不是 Linux/Unix 的某些变体，则该文件可能不存在。`-o /dev/null`在 Windows 上，您可能只需要通过省略该部分来允许其将签名数据写入屏幕。

接下来，我们使用 指定我们想要进行测试的密钥`--local-user 012345`。您可以使用 KeyID 以获得最大的特异性，或者使用最适合您需要的用户名。

接下来我们指定`-as`，它启用 ascii 输出模式，并设置签名的上下文模式。之后只是告诉 GnuPG 从标准输入`-`中获取要签名的数据，这是我们给出的命令的第一部分`echo "1234" |`。

最后，我们有`&& echo "A message that indicates success"`-- “&&” 表示，如果上一个命令成功，则打印此消息。这只是为了清楚起见而添加的，因为上面命令的成功将不会由根本没有输出来指示。

我希望这足以让您了解正在发生的事情，以及如何使用它进行您想做的测试。如果任何部分不清楚或您不理解，我很乐意澄清。祝你好运！

[编辑] - 如果您使用的是 GnuPG v2，则需要稍微修改上述命令，如下所示：

`echo "1234" | gpg2 --batch --passphrase-fd 1 -o /dev/null --local-user <KEYID> -as - && echo "The correct passphrase was entered for this key"`

原因是，GnuPG v2 期望通过代理检索密码短语，因此我们无法禁用代理的使用`--no-use-agent`并获得预期的效果；相反，我们需要告诉 GnuPG v2 我们要运行“批处理”进程，并使用选项从 STDIN（标准输入）检索密码`--passphrase-fd 1`。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2019-04-17T21:17:47.900

这是一个较短的命令行，用于检查密码是否正确：

```
gpg --export-secret-keys -a <KEYID> > /dev/null && echo OK 
```

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2020-05-14T17:11:09.503

对我来说，检查密码的简单方法是使用`gpg --passwd`速记。它会尝试更改密码，步骤是确认旧密码，然后您可以在新密码提示上单击“取消”，这样可以保持密码完整。

```
gpg --passwd <your-user-id> 
```

* * *

正如[ford04 所说](https://stackoverflow.com/users/5669456/ford04)，对于较新版本的 GPG，现在可以将上述命令改进为

```
gpg --dry-run --passwd <your-user-id> 
```

这是更好的。查看[提交](https://dev.gnupg.org/rG165bc38cefbc03515403b60b704cabf4dc0b71f4)。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2020-08-23T05:05:23.060

警告不要使用`gpg -o /dev/null`此处最佳答案所建议的回声。这将导致 /dev/null 拥有无效权限并损坏`/dev/null`文件。您可以在运行此命令时验证 /dev/null 文件的权限以证明这一点。

你可以使用这个：

```
echo "1234" | gpg -q --batch --status-fd 1 --sign --local-user $KEY_ID --passphrase-fd 0 > /dev/null 
```

我还为此创建了 bash 脚本（这个脚本正在使用 Centos 8）。这个脚本会要求输入密码，如果它无效，它会一直要求输入有效的密码。此外，如果您输入错误或不存在的 KEY_ID 作为参数，它也可以验证：

```
#!/bin/bash
# usage ./gpgcron KEYID   | ./gpgcron 2B705B8B6FA943B1
script_path=$(dirname $(realpath -s $0))
script_name=$(basename -- "$0")
GPG_CACHE_BIN="/usr/libexec/gpg-preset-passphrase"
KEY_ID=$1
KEY_GRIP=$(gpg --with-keygrip --list-secret-keys $KEY_ID | grep -Pom1 '^ *Keygrip += +\K.*')
RETVAL=$?
if [[ $RETVAL -ne 0 || -z $KEY_ID ]]; then
    echo "Please provide correct KEY_ID. Example ./$script_name KEY_ID"
    exit 1
fi

export GPG_TTY=$(tty)

function set_gpg_cachepass {
    read -s -p "[$script_name | input]: Enter passphrase to cache into gpg-agent: " PASSPHRASE; echo
    $GPG_CACHE_BIN -c $KEY_GRIP <<< $PASSPHRASE
    RETVAL=$?
    echo "[$script_name | info ]: gpg-preset-passphrase return code: [$RETVAL]"
    if [ $RETVAL = 0 ]; then
        echo "[$script_name | info ]: A passphrase has been set and cached in gpg-agent"
        echo "[$script_name | info ]: Paraphrase set return code: [$RETVAL]"
        gpg_validatepass
    else
        echo "[$script_name | info ]: Unsuccessful error occured: [$RETVAL]"
        set_gpg_cachepass
    fi
}

function gpg_validatepass {
    echo "[$script_name | info ]: Validating passphrase cached in gpg-agent ..."
    echo "1234" | gpg -q --batch --status-fd 1 --sign --local-user $KEY_ID --passphrase-fd 0 > /dev/null
    RETVAL=$?
    if [ $RETVAL = 0 ]; then
        echo "[$script_name | info ]: OK, valid passphrase has been cached in gpg-agent"
    else
        echo "[$script_name | info ]: Warning, invalid passphrase or no passphrase is cached in gpg-agent"
        set_gpg_cachepass
    fi
}

RES=$(echo "KEYINFO --no-ask $KEY_GRIP Err Pmt Des" | gpg-connect-agent | awk '{ print $7 }')
if [ "$RES" == "1" ]; then
    echo "[$script_name | info ]: OK, passphrase is already cached in gpg agent for KEY_ID of [$KEY_ID]"
    gpg_validatepass
else
    echo "[$script_name | info ]: Warning, no passphrase is cached in gpg agent for KEY_ID of [$KEY_ID]"
    set_gpg_cachepass
fi 
```

如果 gpg-agent 中没有缓存密码，则输出示例：

```
[root@earth gpg]# ./gpgcron 2B705B8B6FA943B2
[gpgcron | info ]: Warning, no passphrase is cached in gpg agent for KEY_ID of [2B705B8B6FA943B2]
[gpgcron | input]: Enter passphrase to cache into gpg-agent: 
```

输入无效密码时的示例输出（它会一直询问）：

```
[root@earth gpg]# ./gpgcron 2B705B8B6FA943B2
[gpgcron | info ]: OK, passphrase is already cached in gpg agent for KEY_ID of [2B705B8B6FA943B2]
[gpgcron | info ]: Validating passphrase cached in gpg-agent ...
gpg: signing failed: Bad passphrase
gpg: signing failed: Bad passphrase
[gpgcron | info ]: Warning, invalid passphrase or no passphrase is cached in gpg-agent
[gpgcron | input]: Enter passphrase to cache into gpg-agent: 
```

输入有效密码时的示例输出：

```
[gpgcron | input]: Enter passphrase to cache into gpg-agent:
[gpgcron | info ]: gpg-preset-passphrase return code: [0]
[gpgcron | info ]: A passphrase has been set and cached in gpg-agent
[gpgcron | info ]: Paraphrase set return code: [0]
[gpgcron | info ]: Validating passphrase cached in gpg-agent ...
[gpgcron | info ]: OK, valid passphrase has been cached in gpg-agent 
```

当有效密码被缓存时，下次你运行这个脚本时，它不会要求你输入密码。所以这个脚本可以解决你的问题；“只需确认我使用了正确的密码”

# aptana - 保存每个项目打开的文件

> ID：11381124
> 
> 赞同：0
> 
> 时间：2012-07-08T06:20:58.730
> 
> 标签：aptana

我一直在使用 Aptana，它是一个很棒的 Web 开发工具。我不知道我是否可以求助于自己回到记事本++

无论如何，我在 Aptana 上有多个项目......我认为它存储在一个工作区中。但是我会根据自己的心情切换到其他项目。在每个项目中，我打开了多个文件，这有点破坏了我必须关闭以前项目的窗口并打开我想要处理的项目上的文件的势头。

我的问题：有没有办法保存每个项目打开的文件。就像我切换到项目 A 时，我在项目 A 中打开的所有文件都会打开。当我切换到项目B时，我在项目B中打开的所有文件都打开了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T20:51:37.223

我决定玩弄“工作区”，虽然目前还没有一种非常面向 GUI 的方式来处理这些集合，但我想出了一个可行的解决方案！

在您的主目录中创建一个新文件夹，将其命名为“workspaces”，然后打开 Aptana，选择 File -> Switch Workspace -> Other 然后输入新“workspaces”文件夹的路径，然后输入名称的工作区。我有一个名为“通用”的工作区，我几乎已经加载了每个项目。然后我有一堆以他们提交的项目命名的工作区。不再不愿意在 Aptana 中切换任务！不再需要在 Notepad++ 或 Sublime 中打开零碎的项目！一切都好起来了！

现在，Aptana 真正需要做的就是制作一个菜单，您可以在其中单击以选择在 aptana 加载时要使用的工作区，而不必记住您的确切项目名称并通过查看您拥有的所有工作区来刷新您的记忆。理想情况下，他们会在您开始输入项目名称后隐含一种搜索/过滤器栏，然后显示“按回车键自动完成”的悬停，因为没有关于选项卡或回车是否应该自动完成的标准做法，有时会制作它进入可能很烦人，因为您只想创建一个名为“ant”的新项目，而不是加载名为“antennas”的工程项目。

无论如何，对不起格式。希望这可以帮助。

# mysql - MySQL Group BY、Having、Order By Query

> ID：11381125
> 
> 赞同：1
> 
> 时间：2012-07-08T06:21:15.633
> 
> 标签：mysql, group-by, sql-order-by, having

好的，所以假设我有以下表格：

**食谱**

```
id (pk)
name
added
modified 
```

**食谱版本**

```
id (pk)
recipe_id (fk to recipes.id)
version
content
added 
```

我想要的是一个获取最新`recipe_versions.added`数据然后与基础`recipe`数据连接的查询。然后对所有结果进行排序，`recipes.added ASC`我有以下内容，但是 group by 没有选择最新的 recipe_versions 行，似乎选择了第一个。

```
SELECT r.`id`,
      r.name,
      rv.version,
      rv.content,
      r.added,
      r.modified,
 FROM recipes r,
      recipe_versions rv
WHERE r.`id` = rv.recipe
GROUP BY rv.recipe
HAVING max(rv.added) 
ORDER BY r.added ASC 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T06:25:57.980

使用此解决方案：

```
SELECT
    c.*, b.*
FROM
    (
        SELECT recipe_id, MAX(added) AS mostrecent
        FROM recipe_versions
        GROUP BY recipe_id
    ) a
INNER JOIN
    recipe_versions b ON 
        a.recipe_id = b.recipe_id AND
        a.mostrecent = b.added
INNER JOIN
    recipes c ON a.recipe_id = c.id
ORDER BY
    c.added 
```

# jquery - Jquery 绘图不在 IE 中绘图；适用于 FF/Chrome

> ID：11381131
> 
> 赞同：0
> 
> 时间：2012-07-08T06:22:26.933
> 
> 标签：jquery, internet-explorer, firefox

有一些问题让它在 IE 中工作。我基本上从 MySQL 数据库中提取一些列来为此 jscript 代码生成动态值。它似乎在 Firefox 等中运行良好，但在 IE 中不行。检查语法，寻找额外的逗号或 IE 可能不喜欢的不友好的额外内容，在这里旋转我的轮子......这是代码，提前谢谢：

```
<script src="jquery-1.7.2.min.js"></script>
        <script>
            var graph;
            var xPadding = 45;
            var yPadding = 45;

            var data = { values:[

            <?php 

            include("mysqlconn.php"); 

            $result = mysql_query("SELECT DISTINCT kioskName FROM tbllogs ORDER BY kioskName ASC"); 

            while($row = mysql_fetch_array($result)) {

            $kioskname = $row['kioskName']; 

            $result1 = mysql_query("SELECT kioskName FROM tbllogs WHERE kioskName = '$kioskname'"); 

            $numrows1 = mysql_num_rows($result1); 

            if($numrows1!=0) { ?>

                { X: "<?php echo $kioskname; ?>", Y: <?php echo $numrows1; ?> },

            <?php } else { ?>

                { X: "<?php echo $kioskname; ?>", Y: 0 },

            <?php } 

            }
            ?>

            ]};

            // Returns the max Y value in our data list
            function getMaxY() {
                var max = 0;
                for(var i = 0; i < data.values.length; i ++) {
                    if(data.values[i].Y > max) {
                        max = data.values[i].Y;
                    }
                }
                max += 10 - max % 10;
                return max;
            }

            // Return the x pixel for a graph point
            function getXPixel(val) {
                return ((graph.width() - xPadding) / data.values.length) * val + (xPadding * 1.5);
            }

            // Return the y pixel for a graph point
            function getYPixel(val) {
                return graph.height() - (((graph.height() - yPadding) / getMaxY()) * val) - yPadding;
            }

            $(document).ready(function() {
                graph = $('#graph');
                var c = graph[0].getContext('2d');            

                c.lineWidth = 2;
                c.strokeStyle = '#333';
                c.font = 'italic 8pt sans-serif';
                c.textAlign = "center";

                // Draw the axises
                c.beginPath();
                c.moveTo(xPadding, 0);
                c.lineTo(xPadding, graph.height() - yPadding);
                c.lineTo(graph.width(), graph.height() - yPadding);
                c.stroke();

                // Draw the X value texts
                for(var i = 0; i < data.values.length; i ++) {
                    c.fillText(data.values[i].X, getXPixel(i), graph.height() - yPadding + 20);
                }

                // Draw the Y value texts
                c.textAlign = "right";
                c.textBaseline = "middle";

                for(var i = 0; i < getMaxY(); i += 10) {
                    c.fillText(i, xPadding - 10, getYPixel(i));
                }

                c.strokeStyle = '#f00';

                // Draw the line graph
                c.beginPath();
                c.moveTo(getXPixel(0), getYPixel(data.values[0].Y));
                for(var i = 1; i < data.values.length; i ++) {
                    c.lineTo(getXPixel(i), getYPixel(data.values[i].Y));
                }
                c.stroke();

                // Draw the dots
                c.fillStyle = '#333';

                for(var i = 0; i < data.values.length; i ++) {  
                    c.beginPath();
                    c.arc(getXPixel(i), getYPixel(data.values[i].Y), 4, 0, Math.PI * 2, true);
                    c.fill();
                }
            });
        </script> 
```

有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T07:57:49.290

好吧，`canvas`并且`getContext`仅在 IE9+ 中受支持；如果是这样的话，也许改用[拉斐尔](http://raphaeljs.com/)？

# php - PHP在拉入mysql表时更改单元格颜色

> ID：11381132
> 
> 赞同：1
> 
> 时间：2012-07-08T06:22:30.780
> 
> 标签：php, mysql, colors

我一直在寻找这个答案，但要么我不完全理解它（可能因为我是 php 新手），要么我无法得到正确的答案。

我有一个 php 页面，它从我的 sql 表中提取信息，该表有许多不同的列。这是代码......

```
$sql = "SELECT * FROM 2012_TNAfigures ORDER BY id DESC"; 
$query = mysql_query($sql) or die(mysql_error());
echo "<table class='tableDressing' id='2012table'><tbody>";
while ($row = mysql_fetch_array($query)){ 
$render2012 =  "<tr><td class='cellDressing'>".$row['weekday']."</td>
   <td class='cellDressing'>".$row['month']."</td>
   <td class='cellDressing'>".$row['day']."</td>
   <td class='cellDressing'>".$row['price']."</td>
   <td class='cellDressing'>".$row['month']."</td>
   <td class='cellDressing'>".$row['month']."</td>
   <td class='cellDressing'>".$row['month']."</td>
   <td class='cellDressing'>".$row['month']."</td>
   <td class='cellDressing'>".$row['month']."</td>
   <td class='cellDressing'>".$row['month']."</td>
   <td style=\"color: $openColor\">".$row['open']."</td>
   <td class='cellDressing'>".$row['close']."</td>
   <td class='cellDressing'>".$row['high']."</td>
   <td class='cellDressing'>".$row['low']."</td>
   <td class='cellDressing'>".$row['changePercentage']."</td>
   <td class='cellDressing'>".$row['volume']."</td></tr>";
echo $render2012;   
} 
```

当这将数字拉入时，各列将具有不同的数字，我需要根据该单元格中的值应用颜色更改。这是我为进行颜色更改而创建的内容......

```
if (($row >= 1) && ($row <= 46))
$openColor = $red;
else if (($row >= 46.01) && ($row <= 60))
$openColor = $green; 
```

如您所见， $row 不起作用。我不知道该怎么做是拉入一列，说“打开”，在我的函数中验证该列的值，然后确定使用哪种颜色。每列也会抛出许多行，并且值会发生变化。我假设我需要将该列分配给一个变量，然后通过函数解析该变量，但我似乎无法弄清楚。

提前感谢大家。让我知道我是否应该提供更多信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T06:32:15.150

`$row`其中 self 是一个数组。您不能用数字测试数组。

```
if (($row['your_number'] >= 1) && ($row['your_number'] <= 46)) {
    // Do your action
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-04T15:40:52.257

```
if (($row >= 1) && ($row <= 46))
$openColor = 'Red';
else if (($row >= 46.01) && ($row <= 60))
$openColor = 'Green'; 
```

像这样添加到您的 td 类名

```
<td class="td<?php echo $openColor; ?>" >table cell data</td> 
```

在您的 css 样式表文件中分配您想要的颜色值。我在这里使用了描述性名称，但将它们更改为您想要的十六进制颜色代码。

```
.tdGreen{
   background-color: green;
}

.tdRed {
   background-color: red;
} 
```

# java - 为什么类变量引用对象的优势？而不是存储对象本身

> ID：11381134
> 
> 赞同：3
> 
> 时间：2012-07-08T06:22:53.977
> 
> 标签：java, object, reference, class-variables

我想知道类变量存储对对象的引用而不是将对象直接存储在其内存位置有什么好处？

它与内存问题有关还是安全问题。

我试着环顾四周，我找不到这个问题。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-08T06:31:28.927

Java 将 Object 存储在堆内存中，但是从代码中我们需要使用一些句柄来访问该 Object，引用也是

此外，当不再需要没有活动引用对象时的 GC 并且将准备好 GC

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-08T06:41:19.103

它更多地与内存有关，因为在将对象复制或传递给函数时，您无需创建/复制只需复制引用的对象。

例如：

```
Class1 a = new Class1();
Class1 b = a; 
```

如果您不存储引用，那么在这种情况下，您将需要为 b 创建另一个对象，从而导致重复。

第二 ，

```
public void(Class1 obj){
  //Some operation to Object
} 
```

如果您传递整个 Object 而不是引用，您将再次需要内存来保存复制的 Object。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-08T07:00:45.273

如果您没有引用，则不可能实现大多数数据结构。考虑双向链表，或节点包含父链接的树。

# jquery - 我的“按类别查看”jquery 代码可以缩短或改进吗？

> ID：11381137
> 
> 赞同：2
> 
> 时间：2012-07-08T06:24:42.517
> 
> 标签：jquery, hide, show, categories

我正在尝试更新我的摄影网站并使用 jquery 来显示或隐藏我的投资组合的“类别”。我到处搜索，终于在这里找到了这个解决方案：

[http://jsfiddle.net/EwNRJ/145/](http://jsfiddle.net/EwNRJ/145/)

它工作正常。当您单击某个类别的按钮时，它会隐藏其余部分并显示该类别。但是，代码是不是太乱了，还是可以缩短？你们中的任何编码忍者都知道它是否合法或可以瘦身吗？

我主要关心隐藏其他类别的方式。对于每个功能，我会一一列出所有其他类别，并“显示”您单击的类别。因此，如果用户单击“肖像”，我首先显示肖像类，然后一一隐藏所有其他类（风景、个人等）。如果我在路上添加一个类别，我将不得不更新每个功能。没什么大不了的，只是想确保没有更好的方法，并且我的代码看起来不错，并且不会因为我在 jquery 上是绝对新手而导致任何内存问题。

提前致谢，祝您有美好的一天。

PS 如果有任何真正的绝地武士想要看另一件稍微让我烦恼的事情；现在，每个 div 几乎一个接一个地消失。有没有办法暂停或让它们更加一致地消失？我希望这是有道理的。我只是希望（如果可能的话）让它们一起动画化，而不是像多米诺骨牌一样快速地一个接一个地倒塌。好的，再次感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T06:35:54.077

尝试这个：

```
$('button').click(function() {
    $(this).siblings('.post').hide() // or $('.post').hide()
    $('.' + this.id).show(500);
});

$('#showall').click(function() {
    $('.post').show(500);
}); 
```

[演示](http://jsfiddle.net/EwNRJ/148/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T06:33:57.960

您应该缓存类别，而不是每次都尝试找到它们。

```
document.ready(function() {
     var Wedding = $('.wedding');
}); 
```

对于第二个问题，您需要使用回调函数作为参数。回调函数仅在主函数完成后执行。

例子：

```
 $('div').click(function() {
      $(this).animate({'top': '50px'}, 500, function() {
           //callback - start
           $(this).text('a');
           //callback-end
     });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T06:43:46.607

这样做 [http://jsfiddle.net/fedmich/M4G4r/](http://jsfiddle.net/fedmich/M4G4r/)

将按钮放在切换开关内。将元素放入 .posts 确保“肖像”映射到正确的“s”

**快乐编码:)**

```
$('.toggles button').click(function(){
    var d_id = this.id;
    var obj_cur = $('.posts .' + d_id);

    $('.post').not( obj_cur ).hide(500);
    obj_cur.show(500);
}); 
```

# android - 如何刷新表格的行？

> ID：11381138
> 
> 赞同：-1
> 
> 时间：2012-07-08T06:24:58.320
> 
> 标签：android

我的简单问题是在 android 应用程序中插入新行后我们可以刷新我们的表吗？
请帮我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T06:27:10.730

如果您使用`ListView`的方法是调用该`notifyDataSetChanged`函数。

如果你不使用 ListView，现在是时候改变你的实现了……

# c++ - 简单继承后调用复制构造函数

> ID：11381141
> 
> 赞同：1
> 
> 时间：2012-07-08T06:25:33.767
> 
> 标签：c++, inheritance, copy-constructor

我对继承的一些概念有疑问，我在陈述我所知道的，如果我错了，请纠正我。

基类的私有成员由派生类继承，但派生类不能以任何方式访问它们。

基类的受保护成员由派生类继承，但派生类不能直接访问它，而是借助它的一些成员函数。

现在在以下代码中：

```
class A
    {
        protected:
        A(const A&){}
        A operator=(const A &){}
        int t;
        public:
        A(int r)   {t=r;}
        A(){t=0;}
     };

class B : public A
      {
       A a;
      public:
      void make(void)
      {
         //A b(a);      //LINE 1 -------COPY CONSTRUCTOR BEING CALLED ---protected member of base class 
         cout<<t;   //LINE 2 -------protected member of base class 
      }
      };

   int main()
   {
        B b;
        b.make();
        return 0;
   } 
```

为什么 LINE 1 出现错误？

为什么我们不能为 A 的对象调用复制构造函数？

很多很多提前谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-08T06:27:55.160

受保护的成员只能由同一完整对象的其他成员在构造、销毁期间或通过`this`指针^((*))访问。

在您的示例类层次结构中，一个`B`对象有两个类型的子对象`A`：

*   基类子对象，它通过从`A`和
*   名为 的数据成员子对象`a`，它通过声明`a`.

的成员`B`只能从第一`A`个子对象访问受保护的成员，而不能从第二个子对象访问，因为只有第一个直接使用`this`指针（请注意，您的表达式`cout << t`在语义上等同于`cout << this->t`）。

访问数据成员的成员不直接使用`this`指针：如果尝试从 访问`this->a.t`，`B::make`则不直接使用指针`this`访问`t`。在您的声明`A b(a);`中，复制构造函数的调用不是针对`this`，而是针对您正在构造的新`A`对象，名为 的局部变量`b`。

* * *

^((*) 或者，当然，通过声明它的类中的任何成员：任何成员函数都`B`可以调用任何其他成员函数`B`)

# c++ - 在 Linux 等上对 Samba 共享文件的透明访问。使用 C++ IO 流

> ID：11381143
> 
> 赞同：1
> 
> 时间：2012-07-08T06:25:59.390
> 
> 标签：c++, linux, iostream, samba, cifs

是否可以像在 Windows 上使用 UNC 路径（或类似路径）一样透明地在 Linux 中使用 C++ IO 流打开 Samba 共享上的文件，还是我总是需要某种第 3 方库？

如果 3rd 方库是唯一的解决方案，那么 Samba 共享访问有哪些 3rd 方库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T20:00:44.587

It looks like you just want to mount the remote server using cifsfs (see "man mount.cifs"), and then access the files from the mount point you specified.

There is no way that you can explicitly specify a UNC path or anything like that directly to standard file system API (on top of which std::fstream operates).

# gwt - GWT - 为 com.google.gwt.visualization.client.visualizations.corechart 制作动画

> ID：11381145
> 
> 赞同：0
> 
> 时间：2012-07-08T06:26:36.863
> 
> 标签：gwt

我正在尝试在 ColumnChart 上设置动画，但 com.google.gwt.visualization.client.visualizations.corechart.Options 中没有这样做的方法。

显然调用以下函数也不起作用： options.set("animation.duration", new Double(1000));

有没有人设法通过 GWT 为核心图表制作动画？

谢谢你的帮助 ！

雨果

==> 刚刚自己找到了答案。如果有人感兴趣，代码如下。这个想法是扩展类 com.google.gwt.visualization.client.visualizations.corechart.Options

```
import com.google.gwt.core.client.JavaScriptObject;

public class MyOptions extends com.google.gwt.visualization.client.visualizations.corechart.Options {

 protected MyOptions() {
  }
 public final native void setAnimationDuration(double animationDuration) /*-{
    this.animation={
    duration: animationDuration,
    easing: 'out',
  }
 }-*/;

     public static MyOptions create() {
            return JavaScriptObject.createObject().cast();
          } 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T04:12:13.213

那是不正确的形式。你需要像这样使用smthing：

```
 private Options createOptions() 
    {
        Options option = Options.create();     

        Properties animation = Properties.create();
        animation.set("duration", 1000.0);
        animation.set("easing", "out");
        option.set("animation", animation);

        //return options;       
        return option;       
    } 
```

这是未来的答案。您可以从[acra-reporter](http://code.google.com/p/acra-reporter/source/browse/trunk/src/nz/org/winters/appspot/acrareporter/client/ui/Overview.java?spec=svn24&r=24.)看到更多详细信息 不幸的是，目前它不适用于饼图，我正在努力解决这个问题

# jpa - JPA继承：将派生实体映射到不同的表

> ID：11381151
> 
> 赞同：0
> 
> 时间：2012-07-08T06:27:32.183
> 
> 标签：jpa, eclipselink, single-table-inheritance

我使用 SINGLE_TABLE 继承 startegy 来映射我的 usres（参见下面的代码示例）。

有没有办法将**UnActiveRegularUser**和**UnActiveBusinessUser**从**“ACTIVE_USERS”**表映射到另一个表，例如**“UNACTIVE_USERS”**并保持继承启动？

***笔记：***

- 这里的重点是避免 ex 之间的代码重复。RegularUser 与 UnActiveRegularUser（因为它们使用相同的属性）但仍将它们映射到 2 个不同的表：“ACTIVE_USERS”和“UNACTIVE_USERS”。

-strategy = InheritanceType.SINGLE_TABLE 不应更改。

- 添加另一个抽象层可以解决这个问题吗？

```
@Entity
@Inheritance(strategy = InheritanceType.SINGLE_TABLE)
@Table(name = "ACTIVE_USERS")
public class User {
    @Id @GeneratedValue
    protected Long id;

    @Column(nullable = false)
    protected String name;
}

@Entity
public class RegularUser extends User{
//more getters and settres
}

@Entity
public class UnActiveRegularUser extends User{
//same getters and setters as in RegularUser
}

@Entity
public class BusinessUser extends User {
//more getters and settres
}

@Entity
public class UnActiveBusinessUser extends User {
//same getters and setters as in BusinessUser
} 
```

谢谢，内森

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T08:04:36.670

将字段持久化到另一个表不会防止代码重复。我认为你应该只做`UnActiveBusinessUser`extend`BusinessUser`和`UnactiveRegularUser`extend `RegularUser`。

请注意，如果用户可以变为非活动用户（即它是一个 RegularUser 并变为一个 UnactiveRegularUser），继承不是正确的解决方案：一个对象不能从一种类型转到另一种类型。由于 UnactiveRegularUser 似乎除了 RegularUser 之外没有其他任何东西，我不确定这个子类是否有用。

# c++ - 使用 STL 内部实现的红黑树

> ID：11381157
> 
> 赞同：15
> 
> 时间：2012-07-08T06:28:30.347
> 
> 标签：c++, stl, tree, red-black-tree

我知道我的 STL（g++ 4.xx 附带）使用红黑树来实现地图等容器。是否可以直接使用STL内部的红黑树。如果是这样，怎么做？如果不是，为什么不——为什么 STL 不暴露红黑树？

令人惊讶的是，我无法使用谷歌找到答案。

编辑：我正在研究使用红黑树作为插入时额外分配器构造函数调用的解决方案。看到[这个问题](https://stackoverflow.com/questions/11373796/custom-memory-allocator-for-stl-map)。我的 STL 使用红黑树来实现地图。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-08T08:02:41.077

实际上 - 答案很简单，并且与您的 gcc 版本无关。[您可以从sgi 的网站](http://www.sgi.com/tech/stl/download.html)下载 stl 源代码，自己查看实现和使用。

例如，在3.2版本中，您可以在stl_tree.h文件中看到红黑树的实现，以及在stl_set.h中的使用示例。

请注意，由于 stl 类是模板类，因此实现实际上在头文件中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-08T06:32:22.380

我相信大多数 STL 实现`set`和`map`都是红黑树，尽管没有什么能阻止人们使用不同的数据结构来实现它们——如果我没记错的话，C++ 标准不需要 RB 树实现。

STL 不会公开它，因为这会违反 OOP 原则。如果其他人要使用您的库，公开底层数据结构可能会导致一些不良行为。也就是说，特别是对于`set`and `map`，您应该只被允许访问符合`set`and`map`数据结构的方法。暴露底层表示可能会导致用户在内部有重复`set`，这很糟糕。

话虽这么说，（据我所知）没有办法直接使用底层的红黑树。这在很大程度上取决于你想如何使用它。实现你自己的红黑树很可能是你最好的选择，或者查看我们的 3rd 方库（也许是 Boost？）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-08T06:33:41.733

您甚至无法保证所使用的数据结构将*是*一棵红黑树（例如，它至少作为 AVL 树被实现过一次，并且像 B-、B* 或 B+ 树这样的东西可能就可以了好）。

因此，了解内部结构的唯一方法是查看特定的实现，并利用它不（至少尝试）公开公开的东西。

至于为什么：我认为主要是因为它是一种抽象的尝试，而不是暴露所有的实现细节。

# php - htaccess 将动态 url 重定向到静态 url

> ID：11381165
> 
> 赞同：0
> 
> 时间：2012-07-08T06:30:06.283
> 
> 标签：php, apache, .htaccess, redirect

我有一些 url 重写了类似的东西：

```
RewriteRule ^futbol-video/([^/]*)-([^-]*)\.html$ /html/video.php?text=$1&id=$2 [L]

RewriteRule ^futbol-takimi/([^/]*)-([^-]*)\.html$ /html/takim.php?text=$1&id=$2 [L] 
```

我正在尝试将动态查询重定向到静态页面。我在下面尝试了一些方法，但每次都出现内部服务器错误。我应该如何编写规则表单 301 重定向？

首先我试过：

```
RewriteRule ^futbol-video/([^/]*)-([^-]*)\.html$ /html/video.php?text=$1&id=$2 [R=301,L]

RewriteRule ^futbol-takimi/([^/]*)-([^-]*)\.html$ /html/takim.php?text=$1&id=$2 [R=301,L] 
```

但是得到内部服务器错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T06:37:21.507

我相信您正在错误地处理查询字符串。

有关使用 RewriteCond 处理查询字符串的一些示例，请参阅以下博客文章。

1.  [http://www.simonecarletti.com/blog/2009/01/apache-query-string-redirects](http://www.simonecarletti.com/blog/2009/01/apache-query-string-redirects)
2.  [http://www.simonecarletti.com/blog/2009/01/apache-rewriterule-and-query-string/](http://www.simonecarletti.com/blog/2009/01/apache-rewriterule-and-query-string/)

来自博客的示例：

```
#Keep original query (default behavior)
RewriteRule ^page\.php$ /target.php [L]
# from http://example.com/page.php?foo=bar
# to   http://example.com/target.php?foo=bar

#Discard original query
RewriteRule ^page\.php$ /target.php? [L]
# from http://example.com/page.php?foo=bar
# to   http://example.com/target.php

#Replace original query
RewriteRule ^page\.php$ /target.php?bar=baz [L]
# from http://example.com/page.php?foo=bar
# to   http://example.com/target.php?bar=baz

#Append new query to original query
RewriteRule ^page\.php$ /target.php?bar=baz [QSA,L]
# from http://example.com/page.php?foo=bar
# to   http://example.com/target.php?foo=bar&bar=baz 
```

**编辑** 此外，如果您尝试从带有查询字符串的 url 重定向到静态页面，则带有查询字符串的 url 必须在重写规则中排在第一位（或置于重写条件中），而不是像您拥有的那样排在第二位。

# php - 如何使用 Javascript 或 Jquery 处理 HTML 中的图像？

> ID：11381168
> 
> 赞同：0
> 
> 时间：2012-07-08T06:32:03.950
> 
> 标签：php, javascript, html, image

我的朋友要我为他开发一个面饼面包店的网站。我应该为用户提供一个表格，以便他们可以订购蛋糕并提交要打印在蛋糕上的照片。现在我需要制作一个动态成像系统，用用户提交的图像显示蛋糕的外观预览..如果您能建议一些图书馆这样做，那将非常有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T14:41:35.920

听起来您正在尝试做两件事：

1.  在客户端显示用户选择的照片（在它进入服务器之前）。
2.  转换该图像，使其出现在蛋糕上的正确位置。

这两个功能传统上属于后端处理领域，但由于 HTML5 和 CSS3 草案标准，它们至少在 Chrome 和 Firefox 中可用。以下解决方案并不通用，对于不支持的浏览器，您**将**不得不退回到基于服务器的解决方案，但值得一提的是：

**显示用户选择的图像**

当用户从中选择一个文件时`<input type=file>`，它会调度一个`change`事件。发生这种情况时，DOM 对象有一个`FileList`名为的属性，`files`允许您读取这些文件的内容。 `URL.createObjectURL`允许您将文件转换为可用于图像源的 URL：

```
input.addEventListener('change', function () {
    preview.src = URL.createObjectURL(this.files[0]);
});

preview.addEventListener('load', function () {
    URL.revokeObjectURL(this.src);
}); 
```

有关演示，请参见[http://jsfiddle.net/bnickel/yP7Bb/ 。](http://jsfiddle.net/bnickel/yP7Bb/)

**转变为看起来像蛋糕上衣**

CSS3 3d 变换可以将表面变换为 3D。我进行了实验，发现以下内容非常有说服力。0.7 垂直压缩它，-0.008 是旋转以添加透视。

```
-webkit-transform: matrix3d(1,     0,     0,     0,
                            0,     0.7,   0,    -0.008,
                            0,     0,     1,     0,
                            0,     0,     0,     1);

        transform: matrix3d(1,     0,     0,     0,
                            0,     0.7,   0,    -0.008,
                            0,     0,     1,     0,
                            0,     0,     0,     1);

        transform: matrix3d(1,     0,     0,     0,
                            0,     0.7,   0,    -0.008,
                            0,     0,     1,     0,
                            0,     0,     0,     1); 
```

你可以在这里玩值：http: [//jsfiddle.net/bnickel/v9Jat/](http://jsfiddle.net/bnickel/v9Jat/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T07:06:47.463

您可以使用绝对定位和 3d 变换 css、带有溢出隐藏且背景无的边界半径圆和图像作为带有圆形蛋糕的子元素。

就是这样。

# ajax - MVC3 ASP.NET Ajax BeginForm 有时在由其他 Ajax 注入时不起作用

> ID：11381174
> 
> 赞同：3
> 
> 时间：2012-07-08T06:33:01.177
> 
> 标签：ajax, asp.net-mvc-3, ajax.beginform

我试图在页面中有一些根本不起作用的 Ajax 表单，它不会在提交时发送任何请求，在 firebug 中注意到，表单正在通过 ajax 加载到页面，但我有其他表单被加载通过 ajax 形成一个 jquery UI 对话框，它们工作正常，这是我的整个部分视图代码，（带有动作“SeacrhTasksTable”的部分不起作用）我会附上渲染的整个 HTML，但它太大了。

```
@model APS.HelpDesk.UI.MyModel<APS.HelpDesk.Data.App_ProjectTask>
<h2>
    پروژه
    @ViewBag.ProjectTitle
</h2>
<div class="wrapperTask">
    <div class="firstTask">
   @* <input type="hidden" value="@(ViewBag.ProjectId)" />*@
        @Ajax.ActionLink("تعریف کار جدید", "AddProjectTaskDialog", new
   {
       Id = ViewBag.ProjectId,
       area = "ProjectAdmin"
   }, new AjaxOptions()
   {
       HttpMethod = "GET",
       LoadingElementId = "AddProjectTaskLoadingGif",
       UpdateTargetId = "AddProjectTaskDialog",
       InsertionMode = InsertionMode.Replace,
       OnBegin = "clearDialogs();",
       OnSuccess = " $('#AddProjectTaskDialog').dialog('open');"
   }, new { id = "AddProjecTaskLink" })
        <a href="javascript:void(0);" id="resetbutton">بارگذاری مجدد جدول </a>
    </div>
    <div class="secondTask">
        <div id="AddProjectTaskLoadingGif" style="display: none;">
            <img src="@Url.Content("~/Content/Images/ajax-loader/253L.gif")" alt="" />
        </div>
    </div>
</div>
<div id="test">
    <table>
        <tr>
            <th>
                #
            </th>
            <th>
                کد کار
            </th>
            <th>
                عنوان کار
            </th>
            <th style="min-width: 300px;">
                مختصری از توضيحات
            </th>
            <th>
                تاريخ ايجاد کار
            </th>
            <th>
                مهلت انجام
            </th>
            <th>
                وضعيت
            </th>
            <th>
                وابستگی های کار
            </th>
            <th colspan="2">
                ويرايش و حذف
            </th>
        </tr>
         @using (Ajax.BeginForm("SeacrhTasksTable", new { area = "ProjectAdmin" }, new AjaxOptions
    {
        HttpMethod = "POST",
        InsertionMode = InsertionMode.Replace,
        UpdateTargetId = "test" 
    }))
        {
            <tr>
                <td>
                </td>
                <td>
                    <input type="text" id="IdTask"  style = "width:40px"  name = "Id" />
                </td>
                <td>
                    <input type="text" id="TitleTask"  style = "width:80%;" placeholder = "جست و جو" name = "Title" />
                </td>
                <td style="min-width: 250px;">
                    <input type="text" id="DescriptionTask"  style = "width:80%;" placeholder = "جست و جو" name = "Description" />
                </td>

                 <td>
                     <input type="text" id="DeliverDateTask"  style = "width:80%;" placeholder = "جست و جو" name = "DeliverDate" />
                 </td>
                 <td>
                     <input type="text" id="DeadlineDateTask"  style = "width:80%;" placeholder = "جست و جو" name = "DeadlineDate" />
                 </td>
                 <td>
                   <select name="Status">
                       <option value="0"> همه</option>
                       <option value="1">شروع نشده</option>
                       <option value="2">در حال انجام</option>
                       <option value="3">تمام شده</option>
                       <option value="4">بی مسئول</option>
                    </select>
                </td>
                <td colspan="4">

                    <input type="submit" value="submit" style="" />
                    <input type="hidden" value="@(ViewBag.ProjectId)" name="ProjectId" id ="ProjectIdTask"/>

                </td>
            </tr>
        }
        <tbody id="TaskList">
            @Html.Partial("_ProjectTaskList", Model.MyList)
        </tbody>
        <tfoot>
            <tr>
                <td colspan="3">
                    صفحه
                    @(Model.PageIndex + 1)
                    از
                    @Model.TotalPages
                    [ تعداد کل : @Model.TotalCount ]
                </td>
                <td id="pagesizeTaskTd" style="text-align: center;">
                    سايز صفحه
                    <select id="pagesizeTask">
                        <option value="5">5</option>
                        <option value="10" selected="selected">10</option>
                        <option value="25">25</option>
                        <option value="50">50</option>
                    </select>
                </td>
                <td colspan="6" align="left" class="tfoot-padding" id="morepagesTask">
                    @{
                        int start = Model.PageIndex;
                        if (start > 0)
                        {
                            int c = 0;
                            while (start > 0 && c < 4)
                            {
                                c++;
                                start--;
                            }
                        }
                        for (int j = start; j < Model.TotalPages && j < start + 10; j++)
                        {
                            if (Model.PageIndex != j)
                            {

                        <span>
                            @Ajax.ActionLink((j + 1).ToString(), "TaskListTablePage", "Project", new
                       {
                           Id = ViewBag.ProjectId,
                           PageIndex = j,
                           PageSize = Model.PageSize,
                           area = "ProjectAdmin"
                       }, new AjaxOptions
                       {
                           HttpMethod = "GET",
                           UpdateTargetId = "test",
                           InsertionMode = InsertionMode.Replace
                       }, new { mode = "mode" })
                        </span>
                            }
                            else
                            { 
                        <span><b style="text-decoration: underline;">@(j + 1)</b></span>
                        <input type="hidden" id="PIndexAll" value="@(j)" />
                            }
                        }
                        if (Model.PageIndex + 10 < Model.TotalPages)
                        { 
                        <span>. . . </span>
                        }
                    }
                </td>
            </tr>
        </tfoot>
    </table>
</div>
<div id="AddProjectTaskDialog" title="تعریف کار جدید" style="text-align: right;">
</div>
<div id="EditProjectTaskDialog" title="ويرايش کار" style="text-align: right;">
</div>
<div id="ReportProjectTaskDialog" title="گزارش کل کار" style="text-align: right;">
</div>
<div id="DescriptionProjectTaskDialog" title="توضيح کار" style="text-align: right;">
</div>
<div id="EditProjectDepenDialog" style="text-align: right;">
</div>
<div id="Taskresult">
</div>
<script type="text/javascript">

    $("#AddProjectTaskDialog").dialog({
        autoOpen: false,
        width: 720,
        modal: true,
        draggable: true,
        position: "top"
    });

    $("#EditProjectTaskDialog").dialog({
        autoOpen: false,
        width: 720,
        modal: true,
        draggable: true,
        position: "top"
    });

    $("#EditProjectDepenDialog").dialog({
        autoOpen: false,
        width: 720,
        modal: true,
        draggable: true,
        position: "top",
        buttons: {
            "OK": function () {
                $(this).dialog("close");
            }
        }
    });

    $("#AddProjecTaskLink").button();
    $("#resetbutton").button();

    $("#pagesizeTask").live( 'change' ,  function (){

        var val = $(this).find(":selected").val();
        $("#morepagesTask").find('*[mode]').each(function(index){

            var n=$(this).attr("href").lastIndexOf("=");
            var t= $(this).attr("href").substring(0,n+1);
            $(this).attr("href" ,t+val );
        });

          var url = '@Url.Action("TaskListTablePage", new { area = "ProjectAdmin" })';
          url += '?Id=' + @(ViewBag.ProjectId);         
          url += '&PageIndex=' + $("#PIndexAll").val();
          url += '&PageSize=' +val;         
          $.ajax({
              url: url, type: 'get',
              success: function (data, status) {
                $("#test").html('');
                $("#test").html(data);
              }
          });         

    });

     $(".firstTask").delegate( '#resetbutton','click',function(){

        var url = '@Url.Action("TaskListTablePage", new { area = "ProjectAdmin" })';
          url += '?Id=' + @(ViewBag.ProjectId);         
          url += '&PageIndex=0' ;
          url += '&PageSize=10';          

          $.ajax({
              url: url, type: 'get',
              success: function (data, status) {
                $("#test").html('');
                $("#test" ).html(data);
              }
          }); 

        });
</script> 
```

表单的 HTML

```
<form action="/ProjectAdmin/Project/SeacrhTasksTable" data-ajax="true" data-ajax-method="POST" data-ajax-mode="replace" data-ajax-update="#test" id="form0" method="post">            <tr>
                <td>
                </td>
                <td>
                    <input type="text" id="IdTask"  style = "width:40px"  name = "Id" />
                </td>
                <td>
                    <input type="text" id="TitleTask"  style = "width:80%;" placeholder = "جست و جو" name = "Title" />
                </td>
                <td style="min-width: 250px;">
                    <input type="text" id="DescriptionTask"  style = "width:80%;" placeholder = "جست و جو" name = "Description" />
                </td>

                 <td>
                     <input type="text" id="DeliverDateTask"  style = "width:80%;" placeholder = "جست و جو" name = "DeliverDate" />
                 </td>
                 <td>
                     <input type="text" id="DeadlineDateTask"  style = "width:80%;" placeholder = "جست و جو" name = "DeadlineDate" />
                 </td>
                 <td>
                   <select name="Status">
                       <option value="0"> همه</option>
                       <option value="1">شروع نشده</option>
                       <option value="2">در حال انجام</option>
                       <option value="3">تمام شده</option>
                       <option value="4">بی مسئول</option>
                    </select>
                </td>
                <td colspan="4">

                    <input type="submit" value="submit" style="" />
                    <input type="hidden" value="38" name="ProjectId" id ="ProjectIdTask"/>

                </td>
            </tr>
</form> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-08T06:42:08.590

您的代码不起作用，因为您的标记无效。通过无效标记，我的意思是您有一个`<form>`直接嵌套`<tr>`在规范禁止的 a 中。你不能有`<form>`一个`<table>`,`<tbody>`或`<tr>`。

为了以简化的方式说明问题，以下是您当前无效的内容：

```
<table>
    <tr>
        <form>
            <td>Foo</td>
            <td>Bar</td>
            <td><input type="submit" /></td>
        </form>
    </tr>
</table> 
```

只需使用 FireBug 检查 DOM，您就会看到您的 DOM`<form>`是如何单独浮动（立即打开和关闭）而内部没有任何元素的。

这是无效的标记，它会导致未定义的行为，在您的情况下，浏览器会简单地不提交表单。发生这种情况的原因是因为`unobtrusive-ajax`您使用的库使用以下方式订阅所有 ajax 表单的提交事件`.live`：

```
$("form[data-ajax=true]").live("submit", function (evt) {
    ...
}); 
```

问题是在这种情况下永远不会引发提交事件。昨天有人问了一个[类似的问题，同样的问题。](https://stackoverflow.com/q/11372421/29407)

要解决此问题，您可以使用嵌套表：

```
<table>
    <tr>
        <td>
            <form>
                <table>
                    <tr>
                        <td>Foo</td>
                        <td>Bar</td>
                        <td><input type="submit" /></td>
                    </tr>
                </table>
            </form>
        </td>
    </tr>
</table> 
```

所以只需把你`Ajax.BeginForm`放在一个里面`<td>`，然后使用一个嵌套表来放置元素。

# html - 有没有办法使用同一标签内的 onchange 事件实时更新 textarea 标签的 value 属性？

> ID：11381175
> 
> 赞同：-3
> 
> 时间：2012-07-08T06:33:06.217
> 
> 标签：html, onchange

当我在 textarea 标签内输入时，我希望更新该值。

```
<textarea onchange="some code" value=''></textarea> 
```

这样的事情可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T06:46:51.510

是的，例如`onchange="this.setAttribute('value', 42);"`。但我不明白这会有什么用，我想知道你想用这种方式解决什么问题。

根据 HTML 语法，一个`textarea`元素不能有一个`value`属性。根据 HTML5 草案，在浏览器实践中，`value`一个元素对应的 DOM 节点的属性`textarea`反映了该元素的内容。

# iphone - 在 xcode 4 中将 ipad xib 转换为 iphone xib

> ID：11381184
> 
> 赞同：0
> 
> 时间：2012-07-08T06:34:45.077
> 
> 标签：iphone, ipad, ios5, xcode4, xib

我正在尝试找出如何将 iPad xib 转换为 iPhone xib。我在其中一个答案中发现[了这个问题：](https://stackoverflow.com/questions/10900427/convert-ipad-xib-to-iphone-xib)

```
 "Now you must change the code of nib name and switch iPhone - iPad" 
```

我不明白该怎么做。而且我认为这可能很重要，因为在我的 UIView、模拟矩阵、大小中，我有“iPad 全屏”选项，我想使用“iPhone 全屏”

谢谢，谢菲

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T08:40:41.430

我不确定您要做什么，但您可以删除 xib 的基本视图并添加具有所需大小的新 UIView 将其添加为 xib 的基本视图

# iphone - 自定义 UIButton 图像 iOS

> ID：11381189
> 
> 赞同：5
> 
> 时间：2012-07-08T06:35:56.903
> 
> 标签：iphone, ios, image, ipad, button

是否可以有一个自定义 UIButton 的图像只覆盖它的一半？我想它会是这样的：

```
UIButton *someButton = [UIButton buttonWithType:UIButtonTypeCustom];
[someButton setBackgroundImage:[UIImage imageNamed:@"buttonPicture"]];

/* Then there must be some property I can set that prevents the button from stretching the image?? */

.
.
. 
```

我想要一个 50x100px 的按钮，它的上半部分只有一个 50x50px 的图像，而下半部分是透明的。

我知道如何创建自定义按钮和一切。我只是想知道控制背景图像拉伸的属性是什么。

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-08T06:42:26.557

采用

```
[someButton setImage:[UIImage imageNamed:@"buttonPicture"] forState: UIControlStateNormal];
 someButton.imageEdgeInsets = UIEdgeInsetsMake(-50, 0, 0, 0); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T06:47:00.737

我认为你可以：

1.  将按钮图像创建为 50x100px 图像（与按钮大小相同）；

2.  使此图像半透明（带 alpha 的 PNG），

而不是试图为按钮分配一个较小的图像，只覆盖它的一半并防止拉伸。

# c# - 语言无法恢复到原始语言

> ID：11381190
> 
> 赞同：0
> 
> 时间：2012-07-08T06:36:14.797
> 
> 标签：c#, asp.net

我想拥有一个使用**Resource.resx**的双语网站（英语和德语）我可以成功地将页面的语言更改为德语，但我无法回到英语。这是我的代码：

```
protected void Page_Load(object sender, EventArgs e)
        {

                Session["Lan"] = DropDownList1.SelectedItem.Value.ToString();

                if (Session["Lan"].ToString() == "de-DE")
                {
                    Thread.CurrentThread.CurrentCulture = CultureInfo.CreateSpecificCulture("de-DE");
                    Thread.CurrentThread.CurrentUICulture = new CultureInfo("de-DE");
                    Label2.Text = Resources.Resource.Here;
                    HyperLink1.Text = Resources.Resource.Signup;
                } 
```

我怎么解决这个问题？

**编辑：** 我已将 Dropdownbox 的 Autopost 属性设置为 true，并将我的代码块放入**ispostback**，如下所示：

```
Session["Lan"] = DropDownList1.SelectedItem.Value.ToString();
            if (Page.IsPostBack)
            {
                if (Session["Lan"].ToString() == "de-DE")
                {
                    Thread.CurrentThread.CurrentCulture = CultureInfo.CreateSpecificCulture("de-DE");
                    Thread.CurrentThread.CurrentUICulture = new CultureInfo("de-DE");

                    Label1.Text = Resources.Resource.Quick_routes_offers_the_opportunity_to_manage_and_analyze_the_recorded_routes_The_format_of_your_route_must_be_GPX_format_;
                    Label2.Text = Resources.Resource.Here;
                    HyperLink1.Text = Resources.Resource.Signup;
                }

            } 
```

但我认为如果语言不是“de”我的标签的原文应该出现，为什么这个想法行不通？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T08:33:16.980

试试这个，`else`如果在下面放一个。

```
 else 
            {
                Thread.CurrentThread.CurrentCulture = CultureInfo.CreateSpecificCulture("en-US");
                Thread.CurrentThread.CurrentUICulture = new CultureInfo("en-US");

                Label1.Text = Resources.Resource.Quick_routes_offers_the_opportunity_to_manage_and_analyze_the_recorded_routes_The_format_of_your_route_must_be_GPX_format_;
                Label2.Text = Resources.Resource.Here;
                HyperLink1.Text = Resources.Resource.Signup;
            } 
```

# average - 在不使用 ISQL 中的变量的情况下，通过同一列的平均值减去列中的值

> ID：11381195
> 
> 赞同：2
> 
> 时间：2012-07-08T06:37:11.987
> 
> 标签：average, isql

我有 2 个表： Marks (studentnum,marks) Student (SNum, SName)

如果我做

选择 SName，marks-avg(marks) from Marks join Student on SNum = studentnum

然后我只返回 1 行。

有没有办法在不为平均值分配变量的情况下返回所有学生姓名列表以及学生分数与平均值的差异（学生分数 - 平均值）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T06:51:31.803

您想要混合聚合值和非聚合值。这使用子查询，但可能还有其他选项，具体取决于您的服务器。

```
SELECT
    SName,
    marks - (SELECT avg(marks) FROM Marks as m2 WHERE m2.studentnum = m.studentnum)
FROM
    Marks as m INNER JOIN
    Student as s
        ON s.SNum = m.studentnum 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T06:48:03.440

尝试这个：

```
Select s.sname, (m.mark - temp.avg)
From marks m
Inner join (select studentnum, avg(mark) as avg from marks group by studentnum) temp 
On temp.studentnum = m.studentnum
Inner Join students s
On s.snum = m.studentnum 
```

# scala - Scala 继承和对象创建

> ID：11381202
> 
> 赞同：-1
> 
> 时间：2012-07-08T06:39:09.243
> 
> 标签：scala, inheritance

我正在尝试在 Scala 中执行此操作，但由于某种原因它不起作用

```
abstract class Room {
 ...
}

class RoomA1 extends Room { //"not found: type Room" 
//but they're in the same package!!!
//and if I import it as Eclipse suggests the import declaration will give 
//"Room is not a member of rooms(rooms.type)"
 ...
} 
```

并且...

```
var room = new Array[Room](2)
room(0) = new RoomA1 //gives a type mismatch 
//how can I accomplish this? 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T07:34:05.550

您的代码没有任何问题。这是 REPL 的输出，它证明：

```
scala> abstract class Room
defined class Room

scala> class RoomA1 extends Room
defined class RoomA1

scala> val room = new Array[Room](2)
room: Array[Room] = Array(null, null)

scala> room(0) = new RoomA1

scala> room
res3: Array[Room] = Array(RoomA1@71c0ef03, null)

scala> 
```

问题一定在于你如何将它放在一个包中，哪个包，哪个目录下的哪个文件。您应该使用此信息扩大您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T07:27:51.683

对于任何有同样问题的人：Room.scala 可能驻留在包 Room 中，但不要忘记在 Room.scala 的标头中声明它。在 Java 中，您永远不会遇到此错误，因为 Java 会强制您保持严格的目录结构

# c# - 如何在错误报告中使用签名？

> ID：11381204
> 
> 赞同：16
> 
> 时间：2012-07-08T06:40:38.910
> 
> 标签：c#, exception

我刚刚发送了一个用于 beta 测试的程序，一个用户用这个错误报告回复了我：

```
Problem signature:
Problem Event Name: CLR20r3
Problem Signature 01:   myprogram.exe (not the actual name of the file)
Problem Signature 02:   1.4.0.0
Problem Signature 03:   4ff759ce
Problem Signature 04:   System.Windows.Forms
Problem Signature 05:   4.0.0.0
Problem Signature 06:   4ee9b94f
Problem Signature 07:   14e0
Problem Signature 08:   23
Problem Signature 09:   System.ObjectDisposedException 
```

我当然可以在 MSDN上找到有关[System.ObjectDisposedException的信息。](http://msdn.microsoft.com/en-us/library/1aayk129.aspx)所以我可能有一些问题，我要求一个已经被处理的对象（可能是一个文件流）。

所以 Signature 09: 告诉我它抛出了什么样的异常——但是其他签名会给我任何关于是什么导致这个异常的信息吗？

对我来说，问题签名 06-08 似乎包含有趣的数据，但我不知道这意味着什么。

如何阅读这些错误报告之一应该是相当普遍的兴趣。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-15T07:59:42.803

关于问题签名的信息基本上是中间语言级别的错误 dll 的内存位置。

[这篇博](https://web.archive.org/web/20160316200009/http://blogs.msdn.com/b/oanapl/archive/2009/01/30/windows-error-reporting-wer-and-clr-integration.aspx)文解释了每个可用的字段。您可以使用[MSIL Disassembler检查 dll](http://msdn.microsoft.com/en-us/library/f7dy01k1%28v=vs.80%29.aspx)

希望这就是你要找的，

问候，

编辑：作为附加说明，为了研究中间级代码，我发现在 MSIL 反汇编程序中更容易执行文件->转储。然后根据 Signature 07 参数搜索方法。例如.method /。*590.* /

# java - 读取非文本内容并将其写回文件

> ID：11381215
> 
> 赞同：0
> 
> 时间：2012-07-08T06:43:07.220
> 
> 标签：java, character-encoding

我需要 `<row>⠁⠇⠕⠝⠛⠀⠺⠊⠞⠓⠀⠍⠁⠞⠓⠑⠍⠁⠞⠊⠉⠁⠇⠀⠉⠕⠝⠞⠑⠝⠞&lt;/row>`从文件中读取该行，然后写回。但是当我在文件中写回内容时

```
<row>â ?â ƒâ •â §â ‘â €â ™â ‘â ?â •â žâ ‘â €â ?â €â Šâ ?â žâ ‘â —â ›â —â ?â žâ Šâ •â ?</row> 
```

你能帮我修一下吗？我需要在java中做到这一点

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T08:52:38.010

这显然是一个文本编码问题。问题可能在阅读或写作时发生，或者在再次阅读所写内容时发生。您的输出看起来像是被误解的 little-endian UTF-16（除了看起来像普通 ASCII 的标签）。

顺便说一句，您的“非文本”评论只是误导-任何字符数据都是文本的，这些都是同义词。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T06:46:35.660

您需要使用二进制流而不是字符流。

换句话说，您正在这样做：[http ://docs.oracle.com/javase/tutorial/essential/io/charstreams.html](http://docs.oracle.com/javase/tutorial/essential/io/charstreams.html)

但你**应该**这样做：[http ://docs.oracle.com/javase/tutorial/essential/io/bytestreams.html](http://docs.oracle.com/javase/tutorial/essential/io/bytestreams.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T06:46:59.683

编辑：现在我们得到了`<row>`部分，看起来它*毕竟*是文本数据。但是，您没有向我们提供有关生成此文件的内容或`<row>`标签之间的数据的含义的信息。*它是*文本，还是二进制数据，并且不知何故你打算从阅读文本`<row>`转向阅读二进制数据？你怎么知道`<row>`终点在哪里？

*您必须*了解数据的含义和格式——我们无法为您做到这一点。如果您能解释含义和格式，我们可以帮助您将其转化为代码……但如果没有这些信息，我们将无能为力。

* * *

您谈论阅读“行” - 但随后您提供非文本数据。二进制数据中没有“线”这样的概念。

如果您当前正在使用`Reader`某种描述（例如`FileReader`） -**不要**。它们是为文本数据设计的。试图将二进制数据视为文本几乎肯定会丢失信息。

用 an 读取，用 an`InputStream`写入`OutputStream`，一切都应该很好（当然，假设你正确使用它们 - 特别是`InputStream.read`适当地使用返回值）。

# php - Opendir 仅适用于绝对路径

> ID：11381218
> 
> 赞同：0
> 
> 时间：2012-07-08T06:43:56.980
> 
> 标签：php, path, warnings, opendir

使用以下代码时：

```
if ($handle = opendir('../flat')) {

} 
```

我收到此错误：

```
Warning: opendir(../flat) [function.opendir]: failed to open dir: No such file or directory in D:\Inetpub\webs\mysite\newSite\lib\flat.php on line 1 
```

使用

```
dirname(__FILE__); 
```

我可以看到我的 PHP 脚本的正确路径：

```
D:\Inetpub\webs\mysite\newSite\lib 
```

使用绝对路径`opendir`效果很好：

```
if ($handle = opendir('D:\Inetpub\webs\mysite\newSite\flat')) {

} 
```

可能是什么问题呢？有人能帮我吗？

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-07-08T06:53:16.287

PHP 的 open dir 函数不适用于 URL，除非它们是完整的和绝对的。您的相对路径不适用于 open dir，除非它是文件目录或绝对路径，例如[http://www.example.com/blah/blah](http://www.example.com/blah/blah) ..

根据 PHP[手册](http://php.net/manual/en/function.opendir.php)：

a) 路径支持 ftp:// URL 包装器。

b) 路径也可以是任何支持目录列表的 URL，但是在 PHP 4 中只有 file:// URL 包装器支持这个

# c# - 大数据的数据类型和插入参数

> ID：11381219
> 
> 赞同：0
> 
> 时间：2012-07-08T06:44:26.073
> 
> 标签：c#, sql-server, sql-server-ce, dataadapter

这里我的数据记录中的一个字段可以通过 nvarchar 的 8000 个字符的限制，并寻找一个更大的数据类型，例如大约 9000 个字符，有什么想法吗？起初我在使用`NvarChar(8000)`，在发现一些可以通过这个边界之后，我曾经`NText` 看看接下来会发生什么，使用 Entity Framework 似乎它可以完成预期的工作而无需定义任何`Insert statement`和`Data Adapter`，在编程过程中，系统更改为数据适配器，我应该使用插入命令来完成这项工作，现在定义的参数如下所示：

```
cmdIns.Parameters.Add("@story", SqlDbType.NText, 16, "Story") 
```

似乎在使用时会自动增加**16**`EF`的限制，但不会与`Data Adapter`（*而且它只是插入数据的 16 个字符*），真的不知道（不记得）是否通过 EF 的测试甚至大于**8000**的物品？如果是这样，我很好奇原因。

情况是决定**正确的数据类型和它的等效工作参数**，用于这个大数据字段的插入点。

**注意：**这里使用 SQL Server CE

* * *

**编辑 ：**

对不起，我当时不得不去，应该使用的数据类型`NTEXT`在这里别无选择，但定义`**insertion Statement and parameter**`有点麻烦，不幸的是，没有一个建议的方法可以完成与我给出的相似的工作。

*   如果不定义长度，它将给出错误（运行时）！
*   并且使用**AddWithValue**不能使用 DataAdapter 并进行批量插入。也许我必须把它放在另一个问题中，但这是这个问题的一部分，这里的工作答案可能是完整的。有任何想法吗 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T07:13:59.673

每当您想通过指定参数的名称和值来添加参数时，请使用 AddWithValue。像这个 command.Parameters.AddWithValue("@story", story);

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T07:32:01.947

如果我正确理解了你的问题，你应该可以做这样的事情，省略大小，因为它不是必需的：

```
cmdIns.Parameters.Add( new SqlParameter( "story", SqlDbType.NText )
{
    Value = yourVariable;
} ); 
```

# android - android，用于横向和纵向的不同代码

> ID：11381221
> 
> 赞同：1
> 
> 时间：2012-07-08T06:45:22.930
> 
> 标签：android, layout

如何编写读取屏幕大小的代码。我有 4 种不同的布局，“layout”、“layout-land”、“layout-large”和“layout-large-land”

我需要为每个布局编写不同的代码，例如在“布局”中，我有此代码`imagebutton1.setVisibility(View.VISIBLE);`，但在横向屏幕上，我删除了 imagebutton1。所以我打算if else语句，但我不知道如何使用android java来确定屏幕的大小，这里需要一些指导。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T08:49:11.393

从技术上讲，你可以这样做：

```
ImageButton imageButton = findViewById(R.id.image_button);

if (imageButton1 != null) {
    // if the imagebutton isn't found in the view hierarchy,
    // then don't attempt to manipulate it.
    imagebutton1.setVisibility(View.VISIBLE);
} 
```

否则，您可以使用：

```
Configuration conf = getResources().getConfiguration();

boolean isLarge = (conf.screenLayout & Configuration.SCREENLAYOUT_SIZE_LARGE) == 
                      Configuration.SCREENLAYOUT_SIZE_LARGE;

boolean isLandscape = (conf.orientation == Configuration.ORIENTATION_LANDSCAPE);

boolean isLargeLand = isLarge && isLandscape; 
```

# javascript - javascript 和 php 不能一起工作

> ID：11381226
> 
> 赞同：0
> 
> 时间：2012-07-08T06:46:33.193
> 
> 标签：javascript, validation

我正在为我的网站编写注册页面。这是我的注册页面。谁能告诉我为什么它不检查用户名是否已被使用。我不知道 PHP 和 javascript 是否可以一起工作.

html页面如下：

```
<html>
<head>
    <title>Register</title>

</head>

<body>
<script language="javascript">
  function checkInput()
  {
   if(document.register.username.value=="")
   {
      alert("Fill in username");
      document.register.username.focus();
      return false;
    }else if(document.register.password.value==""){
      alert("Fill in your password");
      document.register.password.focus();
      return false;
}else {
<?php
if(isset($_POST['submit'])){
include "connect.php";
$username=$_POST['username'];
$query="SELECT username FROM user";
$result=mysql_query($query);
while($row=mysql_fetch_array($result)){
    $arr[]=$row['username'];    
}
if(in_array($username,$arr)){
    ?>
    alert("Username is already in use");// this part does not work!
    document.register.username.focus();
    return false;
<?php
}
}
?>
}
    }
  </script>

<form name="register" method="post" action="dangki.php" onsubmit="return checkInput();">
  <table width="289" height="185" border="1">
    <tr>
      <td colspan="2">register</td>
    </tr>
    <tr>
      <td width="83">Username</td>
      <td width="190"><input type="text" name="username" id="textfield" ></td>
    </tr>
    <tr>
      <td>Password</td>
      <td><input type="text" name="password" id="textfield2"></td>
    </tr>
    <tr>
      <td>Re-type Password</td>
      <td><input type="text" name="repassword" id="textfield3"></td>
    </tr>
    <tr>
      <td colspan="2"><input type="submit" name="submit" id="button" value="Submit">    </td>
    </tr>
    </table> 
    </form>

    </body>
    </html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T06:54:16.437

不是，Javascript 和 PHP 不会以这种方式“一起工作”。Javascript 在您的浏览器中运行，PHP 在此之前在服务器上运行。因此，您不能使用 PHP 进行客户端验证，只能使用服务器端。对于这方面的第一次演示，只需“查看源代码”就可以查看您的页面在浏览器中的外观。

您必须分别考虑它们。您必须让 PHP 只检查表单提交的内容，并返回一个新页面，指示它是否是有效/新用户名，并允许用户在需要时重试。

您可以使用 ajax 来伪造它，但即使这样也只是向服务器发送一个请求，该服务器单独运行，并将结果返回到页面，由不同的函数处理。你的尝试会变得更加复杂。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T07:09:34.853

PHP 在服务器端进行评估。JavaScript 在客户端进行评估。也就是说：当用户向服务器发出请求时，在服务器上对php进行求值，将结果输出发送给用户，如果涉及到javascript，则在客户端求值，待php求值后.

这意味着PHP可以给javascript发送消息，但是javascript不能给php发送消息。在您的代码中，您似乎希望 php 评估 javascript 正在使用的用户输入。这无法完成，因为当 javascript 运行时，php 已经完成。

您可以提供所需功能的一种方法是编写 php 代码来编写包含所有用户名的 javascript 数组的代码。然后，javascript 可以通过这个数组来告诉用户是否使用了用户名。但是，这有一些缺陷，如果您有很多用户，您将向新用户传输大量文本。这也可能是一个安全问题，因为每个人都可以知道所有在该站点注册的人的所有用户名，也有可能有人加载页面，输入他们的用户名，等待很长时间，让其他人创建一个同名的帐户，然后第一个人回来，提交页面，然后您将拥有两个用户名相同的用户。

首先用 php 编写整个站点可能更容易，但没那么有趣，在一切正常之后，添加 javascript 来美化功能。

# jquery - jQuery Slider - 缓动效果/反转动画

> ID：11381233
> 
> 赞同：0
> 
> 时间：2012-07-08T06:47:01.237
> 
> 标签：jquery, slider, easing

我想让我的滑块有几个元素飞入然后飞出。

我的问题是飞出效果很好，但无论我做什么，我都无法让下一张幻灯片正常工作。

这是动画/幻灯片更改的 jquery：

```
 $active.children('h3, .slide-desc').animate({ 
                        right: 970, 
                        easing: 'easeInOutExpo'
                    }, 1800);
                    $active.children('.slider-button').delay(100).animate({ 
                        right: 970, 
                        easing: 'easeInOutExpo'
                    }, 1800);
                    $active.children('.slide-bg').delay(200).animate({ 
                        left: 970, 
                        easing: 'easeInOutExpo'
                    }, 1200);

                    $next.delay(1400).fadeIn(settings.animationDuration, function () {
                        $active.children('.slide-bg, h3, .slide-desc, .slider-button').css({"left":"","right":""});
                        $active.hide();
                        current = next;
                        $active = $next;
                        animating = false;
                    }); 
```

我尝试复制活动和反转动画（同时使包含的 LI 可见并将元素推到屏幕左侧），但这些动画似乎发生在动画不应该发生的时期。

有人对我应该做什么（jQuery noob）有任何示例或想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T19:58:40.423

Figured it out..

```
$next = slides.eq(next);

                    $active.children('h3, .slide-desc').animate({ 
                        left: "-970px", 
                        easing: 'easeOutExpo'
                    }, 1700);
                    $active.children('.slider-button').delay(300).animate({ 
                        left: "-970px", 
                        easing: 'easeOutExpo'
                    }, 1700);
                    $active.children('.slide-bg').delay(200).animate({ 
                        right: "-970px", 
                        easing: 'easeOutExpo'
                    }, 1000);

                    $next.children('h3, .slide-desc').delay(500).animate({ 
                        left: 0, 
                        easing: 'easeInOutExpo'
                    }, 1700);
                    $next.children('.slider-button').delay(10).animate({ 
                        left: 0, 
                        easing: 'easeInOutExpo'
                    }, 1700);
                    $next.children('.slide-bg').delay(1300).animate({ 
                        right: 0,
                        easing: 'easeInOutExpo'
                    }, 800, function () {

                        current = next;
                        $active = $next;
                        animating = false;
                    }); 
```

For the first slide, I use:

```
slides.eq(current).children('h3, .slide-desc, .slider-button').css({"left":"","right":""});
slides.eq(current).children('.slide-bg, .slide-img').css({"left":"","right":""}); 
```

And to set defaults:

```
slides.children('h3, .slide-desc, .slider-button').css({"left":"-970px","right":""});
slides.children('.slide-bg, .slide-img').css({"right":"-970px","left":""}); 
```

It's a crap solution, and I haven't adjusted the timing, but it will work until I have someone else do it right.

I think I will stick with not working with jQuery. I'm sure this will kill someone's browser who is running 1-2gigs of ram.

# ruby-on-rails - 如何删除嵌套记录

> ID：11381236
> 
> 赞同：0
> 
> 时间：2012-07-08T06:48:09.900
> 
> 标签：ruby-on-rails, ruby-on-rails-3, view, controller, parameter-passing

我的女孩模特对使用 gem 'acts_as_commentable' 有评论

当我访问 example.com/girls/show/1
它显示 ID#1 女孩的个人资料。所有发布的评论都显示在此页面的底部。

对于每个评论行，我想添加删除按钮来删除评论。

如果它应该将参数传递给girls_controller.rb 的comment_destroy 动作。动作部分和视图应该如何？

它使用以下代码保留**未定义的局部变量或方法“女孩”** 错误。

“girls/show.html.erb” 视图应该是这样的。只是一部分。

```
<table>
  <tr>
    <th>ID</th>
    <th>Title</th>
    <th>Body</th>
    <th>Subject</th>
    <th>Delete</th>
  </tr>

<% @all_comments.each do |comment| %>
  <tr>
    <td><%= comment.id %></td>
    <td><%= comment.title %></td>
    <td><%= comment.body %></td>
    <td><%= comment.subject %></td>
    <td><%= button_to 'comment_destroy', girls, confirm: 'Are you sure?', :disable_with => 'deleting...', method: :delete %></td>
   </tr>
<% end %>
</table> 
```

Girls_controller.rb 的 comment_destroy 动作应该是这样的

```
 def comment_destroy
    @comment = comment.find(params[:id])
    @comment.destroy

    respond_to do |format|
      format.html { redirect_to girls_url }
      format.json { head :ok }
    end
    redirect_to :controller => 'girls', :action => 'show', :id => params[:girls][:id]
    flash[:notice] = "comment deleted!"
  end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T13:15:29.700

您似乎有评论嵌套在某个女孩的下方，并且您想删除该评论。

路线

```
resources :girls do
  resources :comments, only: [:create, :destroy]
end 
```

然后，您有一个评论控制器来处理您的创建和销毁。

```
<%= button_to 'comment_destroy', [@girl, comment], confirm: 'Are you sure?', :disable_with => 'deleting...', method: :delete %> 
```

您的评论控制器中的销毁方法：

```
def destroy
  @girl = Girl.find(params[:girl_id])
  @comment = @girl.comments.find(params[:id])
  if @comment.destroy
    redirect_to @girl, notice: "Comment Removed"
  else
    redirect_to @girl, error: "We could not remove the comment"
  end
end 
```

结尾

更新——基于用户使用非宁静解决方案的请求

路线：

```
resources :girls do
  member do
    delete :delete_comment, to: "girls#delete_comment", as: "delete_comment"
  end
end 
```

控制器

```
def delete_comment
  @girl = Girl.find(params[:id])
  @comment = @girl.comments.find(params[:comment_id])
  if @comment.destroy
    redirect_to @girl, notice: "Comment Removed"
  else
    redirect_to @girl, error: "We could not remove the comment"
  end
end 
```

查看链接

```
<%= button_to 'comment_destroy', delete_comment_path(@girl, comment_id: comment.id), confirm: 'Are you sure?', :disable_with => 'deleting...', method: :delete %> 
```

最后一点：我真的不喜欢这个解决方案。您应该有一个 Comments 控制器并使用我的第一个解决方案。

# crontab - pdf2swf 不能与 crontab 一起使用

> ID：11381237
> 
> 赞同：0
> 
> 时间：2012-07-08T06:48:40.587
> 
> 标签：crontab, pdf2swf

我有一个将 PDF 文件转换为 SWF 文件的 python 程序 (queue.py)。它使用 pdf2swf 工具来实现这一点。现在我的问题是当我通过“python queue.py”手动启动这个程序时，它工作正常。但是当我开始使用 crontab 时，同样的程序。

结果显示

pdf2swf -o "/var/www/code_repository/younus/staff/../staffdocs/AIK/doc/248515566214636_IMPROVEMENT_IN_ELECTRIC_LIGHTS.swf" "/var/www/code_repository/younus/staff/../staffdocs/AIK/doc/248515566214636_IMPROVEMENT_IN .pdf">/dev/零

## “sh：pdf2swf：未找到”

内部 crontab -e

## * * * * * python /home/francis/myjobs/queue.py

任何帮助将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T07:52:27.097

您需要在 中包含二进制文件`PATH`，或者指定一个明确的路径名。您可能还需要设置 Python 库路径等以匹配交互式 shell 的环境。

# php - 选择与其他两个实体关联的实体，在 Doctrine2 中连接三个表

> ID：11381242
> 
> 赞同：1
> 
> 时间：2012-07-08T06:49:34.067
> 
> 标签：php, doctrine-orm, doctrine-query

我有三种类型的实体，

1.  用户
2.  团体
3.  网站

用户可以有网站，他们也可以属于组这些实体中的每一个也有一个名称。

这是我的 Doctrine2 定义：

```
<?php
/** @Entity */
class User
{
    // ...

    /**
     * @Column(type="string",length=255,nullable=false)
     * @var string
     */
    protected $name;

    /**
     * @ManyToMany(targetEntity="Group", inversedBy="users")
     * @JoinTable(name="users_groups")
     */
    private $groups;

    /**
     * @ManyToMany(targetEntity="Website", inversedBy="users")
     * @JoinTable(name="users_websites")
     */
    private $websites;

    // ...
}

/** @Entity */
class Group
{
    // ...

    /**
     * @Column(type="string",length=255,nullable=false)
     * @var string
     */
    protected $name;

    /**
     * @ManyToMany(targetEntity="User", mappedBy="groups")
     */
    private $users;

    // ...
}

/** @Entity */
class Website
{
    // ...

    /**
     * @Column(type="string",length=255,nullable=false)
     * @var string
     */
    protected $name;

    /**
     * @ManyToMany(targetEntity="User", mappedBy="websites")
     */
    private $users;

    // ...
} 
```

所以现在如果我想在一个名为“Admins”的组中找到所有用户，我可以这样做：

```
$group = $em->getRepository("Group")->findOneByName("Admins");
$users = $group->users; 
```

我还可以通过以下方式获取与网站“Google.com”相关联的所有用户：

```
$websites = $em->getRepository("Website")->findOneByName("Google.com");
$users = $websites->users; 
```

现在，如果我想获取“Admins”中的所有用户，并且还与“Google”网站相关联，我该怎么办？

如果我使用 TSQL，我会加入这三个表，我该如何在 Doctrine 中做到这一点？

我必须使用 DQL 吗？DQL 会是什么样子？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T11:08:03.453

您应该为此使用 DQL。

```
SELECT u
FROM User u
JOIN u.groups g
JOIN u.websites w
WHERE
    g.name = :group_name
    AND w.name = :website_name 
```

以及这样做的php代码：

```
$dql = '...'; // What i've written above
$query = $em->createQuery($dql);
$query->setParameter('group_name', 'Admins');
$query->setParameter('website_name', 'Google');

$users = $query->getResult(); 
```

我鼓励您阅读 ORM DQL 教义文档：[http ://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/dql-doctrine-query-language.html](http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/dql-doctrine-query-language.html)

PS：您编写的 2 行代码应该返回组和网站，而不是用户

# java - 将鼠标光标更改为我在 java 中单击的多边形

> ID：11381243
> 
> 赞同：1
> 
> 时间：2012-07-08T06:49:46.537
> 
> 标签：java, swing, cursor

在我的java程序中，我在我的JFrame中绘制了这些多边形，我希望我的鼠标光标变成我点击它的那个，所以再次点击，多边形将在我点击的地方绘制。我不知道该怎么做，因为我不知道如何将光标更改为多边形？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T08:26:33.070

您想创建一个自定义光标。创建和注册该光标的方法是 toolkit.createCustomCursor。基本上，创建一个适当大小的图像，安装它并根据需要使用。这是一个代码片段：

```
 Toolkit kit = Toolkit.getDefaultToolkit();
    Dimension dim = kit.getBestCursorSize(48, 48);
    BufferedImage buffered = GraphicsUtilities.createCompatibleTranslucentImage(dim.width, dim.height);
    Shape circle = new Ellipse2D.Float(0, 0, dim.width - 1, dim.height - 1);
    Graphics2D g = buffered.createGraphics();
    g.setColor(Color.BLUE);
    g.draw(circle);
    g.setColor(Color.RED);
    int centerX = (dim.width - 1) /2;
    int centerY = (dim.height - 1) / 2;
    g.drawLine(centerX, 0, centerX, dim.height - 1);
    g.drawLine(0, centerY, dim.height - 1, centerY);
    g.dispose();
    Cursor cursor = kit.createCustomCursor(buffered, new Point(centerX, centerY), "myCursor"); 
```

# iphone - 在 Objective-C 中实现消息链接机制？

> ID：11381246
> 
> 赞同：1
> 
> 时间：2012-07-08T06:50:37.503
> 
> 标签：iphone, objective-c, ios, block

我正在编写一个应用程序，它需要在另一个方法完成后运行一个方法。（常见的情况，对吧？）

我正在尝试实现链式方法。我想出的最好办法是打电话`performSelector:withObject:afterDelay:`。我只是不确定这是否是最好的方法。我研究了 Cocos2d 游戏引擎是如何实现它的`CCSequence`类的，但我不确定我是否理解它。

我怀疑块在这里会做得很好，除了我不确定如何将它们用作回调对象或其他什么。

我将如何实现一种运行方法的机制，一个接一个？（我愿意使用计时器或块，但我不知道在这种情况下我将如何使用块。）

**编辑：**

澄清一下，我正在尝试实现一个像 cocos2d 的`CCSequence`类这样的系统，它采用一些方法并按顺序“分派”它们。诸如动​​画之类的东西，运行需要的时间远不止一个时钟周期。

我不想阻塞主线程，也不想将方法硬编码给彼此。Cocos2d 有一个排序系统，我可以在其中将方法传递给队列并按顺序运行它们。

**编辑2：**

另外，我希望能够取消我的预定队列，所以我不确定 GCD 是否适合此。GCD 串行队列可以取消吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-08T08:52:24.520

您可以使用**[线程迁移技术](http://developer.apple.com/library/ios/#documentation/General/Conceptual/ConcurrencyProgrammingGuide/ThreadMigration/ThreadMigration.html#//apple_ref/doc/uid/TP40008091-CH105-SW1)**

然后是一个有趣的任务，叫做**GCD-Grand Central Dispatch**

> Grand Central Dispatch (GCD) 是 Apple Inc. 开发的一项技术，用于优化对具有多核处理器的系统和其他对称多处理系统的应用程序支持。它是基于线程池模式的任务并行实现。
> 
> GCD 的工作原理是允许程序中可以并行运行的特定任务排队等待执行，并根据处理资源的可用性，安排它们在任何可用的处理器内核上执行
> 
> **调度队列**是维护任务队列的对象，可以是匿名代码块或函数，并轮流执行这些任务。该库自动创建多个具有不同优先级的队列，这些队列同时执行多个任务，并根据操作环境选择要运行的最佳任务数量。库的客户端也可以创建任意数量的串行队列，它们按照提交的顺序执行任务，一次一个。因为串行队列一次只能运行一个任务，所以提交给队列的每个任务对于队列中的其他任务都是至关重要的，因此可以使用串行队列来代替对竞争资源的锁定。
> 
> 调度队列相对于其他调度队列同时执行它们的任务。任务的序列化仅限于单个调度队列中的任务。
> 
> **在您的情况下，您可以使用串行调度队列**
> 
> 当您希望任务以特定顺序执行时，串行队列很有用。串行队列一次只执行一个任务，并且总是从队列的头部拉取任务。您可以使用串行队列而不是锁来保护共享资源或可变数据结构。与锁不同，串行队列确保任务以可预测的顺序执行。只要您将任务异步提交到串行队列，队列就永远不会死锁。
> 
> 与为您创建的并发队列不同，您必须显式创建和管理要使用的任何串行队列。您可以为您的应用程序创建任意数量的串行队列，但应避免仅将创建大量串行队列作为同时执行尽可能多的任务的手段。如果要同时执行大量任务，请将它们提交到全局并发队列之一。创建串行队列时，请尝试确定每个队列的用途，例如保护资源或同步应用程序的某些关键行为。
> 
> ```
> dispatch_queue_t queue;
> 
> queue = dispatch_queue_create("com.example.MyQueue", NULL); 
> ```
> 
> 此代码显示了创建自定义串行队列所需的步骤。dispatch_queue_create 函数有两个参数：队列名称和一组队列属性。调试器和性能工具显示队列名称以帮助您跟踪任务的执行方式。队列属性保留供将来使用，并且应该为 NULL。
> 
> Grand Central Dispatch 提供了一些功能，让您可以从应用程序访问几个常见的调度队列：
> 
> 使用**dispatch_get_current_queue**函数进行调试或测试当前队列的身份。从块对象内部调用此函数会返回块被提交到的队列（并且它现在可能正在运行）。从块外部调用此函数会返回应用程序的默认并发队列。
> 
> 使用**dispatch_get_main_queue**函数获取与应用程序主线程关联的串行调度队列。此队列是为 Cocoa 应用程序和调用 dispatch_main 函数或在主线程上配置运行循环（使用 CFRunLoopRef 类型或 NSRunLoop 对象）的应用程序自动创建的。
> 
> 使用**dispatch_get_global_queue**函数来获取任何共享并发队列。
> 
> 注意：您不需要保留或释放任何全局调度队列，包括并发调度队列或主调度队列。任何保留或释放队列的尝试都将被忽略。

**来源：[并发编程指南](http://developer.apple.com/library/ios/#documentation/General/Conceptual/ConcurrencyProgrammingGuide/OperationQueues/OperationQueues.html)**

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-08T06:58:43.340

使用串行 GCD 队列怎么样？

> 私有调度队列
> 
> 串行队列（也称为私有调度队列）按添加到队列的顺序一次执行一项任务。当前正在执行的任务在由调度队列管理的不同线程上运行（可能因任务而异）。串行队列通常用于同步对特定资源的访问。您可以根据需要创建任意数量的串行队列，并且每个队列相对于所有其他队列同时运行。换句话说，如果您创建四个串行队列，每个队列一次只执行一个任务，但最多仍可以同时执行四个任务，每个队列一个。有关如何创建串行队列的信息，请参阅“创建串行调度队列”。</p>

（[来源](http://developer.apple.com/library/ios/#documentation/General/Conceptual/ConcurrencyProgrammingGuide/OperationQueues/OperationQueues.html)）

如果您希望在后台线程中处理所有消息，这将很有用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-08T06:57:29.143

有两个 performSelector 方法可以等待完成，无需猜测时间。

```
[self performSelector:<#(SEL)#> onThread:<#(NSThread *)#> withObject:<#(id)#> waitUntilDone:<#(BOOL)#>];

[self performSelectorOnMainThread:<#(SEL)#> withObject:<#(id)#> waitUntilDone:<#(BOOL)#>]; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-27T11:42:39.780

我终于找到了我要找的东西。完成块。简单地说，我会写一个这样的方法：

```
- (void) performSomeActionWithCompletion:(void (^)()) completion{

     [self someAction];

     if(completion()){
       completion(); 
     }

} 
```

现在我可以这样调用我的方法：

```
[self performSomeActionWithCompletion:^{
  NSLog(@"All done! (Well, not the async stuff, but at any rate...)");
}]; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-08T15:26:49.917

听起来您想签出`NSOperationQueue`,`NSOperation`和`NSBlockOperation`或`NSInvocationOperation`。与 GCD 队列不同，an`NSOperationQueue`支持取消作业。

您可以创建自己的队列并将其最大并发操作计数设置为 1 以强制其串行执行操作。或者您可以设置操作之间的依赖关系以强制这些操作连续运行。

[从并发编程指南](https://developer.apple.com/library/mac/ipad/#documentation/General/Conceptual/ConcurrencyProgrammingGuide/OperationObjects/OperationObjects.html#//apple_ref/doc/uid/TP40008091-CH101-SW1)中的操作队列一章开始。

# php - 用空间获取变量？

> ID：11381249
> 
> 赞同：0
> 
> 时间：2012-07-08T06:51:25.523
> 
> 标签：php, sql, get

我想在 get 变量中传递名称。该名称包含空格。所以不能在 php 中工作。

```
$facid=$row['Facultyname'];
echo "<a href=tutorials.php?$facid>" . $row['Facultyname']. "</a><p>"; 
```

请帮助我，如果教员名称 =AK Sharma 那么它只发送 AK

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T06:53:23.470

[对 URL 进行编码](http://php.net/manual/en/function.urlencode.php)：

```
echo '<a href="tutorials.php?variable_name='.urlencode($row['Facultyname']).'">' 
     . $row['Facultyname']. '</a>'; 
```

编辑：为 GET 设置一个变量名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T07:03:01.543

看起来您实际上并没有在 之后设置变量`?`，您只是在粘贴值。尝试：

```
$facid = $row['Facultyname'];
echo "<a href='tutorials.php?facid=". urlencode($facid) ."'>". $facid ."</a>"; 
```

# php - codeigniter 分页 create_links()

> ID：11381250
> 
> 赞同：0
> 
> 时间：2012-07-08T06:51:27.013
> 
> 标签：php, codeigniter, pagination

问题是在分页中，我还没有显示数据库的东西，但问题不在于那个。

问题是我已经显示了页面链接，但是当我单击第 2 页的链接时，它转到

```
http://127.0.0.1:8887/codeigniter-tests/index.php/pagination/index/127.0.0.1:8887/codeigniter-tests/index.php/pagination/index/5
```

.

如您所见，该链接基本上重复了两次，现在如果我在第 2 页上单击 1，它将带我到

```
http://127.0.0.1:8887/codeigniter-tests/index.php/pagination/index/127.0.0.1:8887/codeigniter-tests/index.php/pagination/index/127.0.0.1:8887/codeigniter-tests/ index.php/分页/索引/
```

如您所见，现在它已经写了三次，如果我在此页面上单击 2，它会再次附加 url 并将我带到那里：/

现在我想问为什么会这样？？？

代码如下：_

控制器（分页.php）

类分页扩展 CI_Controller {

```
function index() {
    $this->load->library('pagination');

    $config['base_url'] = '127.0.0.1:8887/codeigniter-tests/index.php/pagination/index/';
    $config['total_rows'] = $this->db->get('data')->num_rows;
    $config['per_page'] = 5;
    $config['num_links'] = 10;
    $config['uri_segment'] = 3;

    $this->pagination->initialize($config);

    $data['records'] = $this->db->get('data', $config['per_page'], $config['uri_segment']);
    $this->load->view('pagination_view', $data);

}

} 
```

这是视图（pagination_view.php）：_

```
<html>  
<head>  
    <title>CI Pagination</title>  
</head>  
<body>  
    <h1>Pagination With CI</h1> 
    <?php
        echo $this->pagination->create_links();
    ?>
</body>  
</html> 
```

只是一些额外的信息，如果我将 $config['base_url'] 设置为空，它会链接到

```
127.0.0.1:8887/5
```

任何帮助将不胜感激，这是一个错误吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T06:56:55.450

尝试使用这个：

```
$config['base_url'] = '/codeigniter-tests/index.php/pagination/index/'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T07:02:22.473

我认为这`$config['base_url']`不支持不完整的 URL。尝试添加协议位或仅保留路径：

```
$config['base_url'] = 'http://127.0.0.1:8887/codeigniter-tests/index.php/pagination/index/';
$config['base_url'] = '/codeigniter-tests/index.php/pagination/index/'; 
```

# matlab - 我如何在 matlab 中制作的独立应用程序之外运行脚本？

> ID：11381255
> 
> 赞同：0
> 
> 时间：2012-07-08T06:51:44.390
> 
> 标签：matlab

我在 matlab 中有一个独立的应用程序。它获取一个文件名作为输入并且需要运行这个文件。该文件与独立应用程序位于同一路径。

谢谢，迈克。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T17:54:07.617

听起来您正在寻找[SYSTEM](http://www.mathworks.com/help/techdoc/ref/system.html)功能。您可以将任何变量作为字符串传递给它：

```
s = 'ls';  % use 'ls' for Mac/Unix, 'dir' for Windows
[status, result] = system(s); 
```

这`status`是操作系统状态码（0 表示程序没有错误退出），`result`是程序的输出：

```
>> status

status =

     0

>> result

result =

total 928
-rw-r--r--   1 stew  stew       0 Jul 24  2009 PROJECT_BASE
drwxr-xr-x  48 stew  stew    1632 Mar 17  2011 analysis
-rw-r--r--   1 stew  stew    1944 Oct  4  2010 diff1
drwxr-xr-x  29 stew  stew     986 Sep 24  2011 matlab
drwxr-xr-x  11 stew  stew     374 Aug  5  2009 matlab_old
-rw-r--r--   1 stew  stew   62525 Jul  6  2010 nms.mat
-rw-r--r--   1 stew  stew  111423 Jul  7  2010 nms1.mat
drwxr-xr-x  52 stew  stew    1768 Mar  2  2010 p60_analysis
drwxr-xr-x   4 stew  stew     136 Mar 26 23:08 sims
-rw-r--r--   1 stew  stew    2212 Jan 29  2010 startup.m
-rw-r--r--   1 stew  stew  264635 Jun 13 18:22 test.bundle
-rw-r--r--   1 stew  stew     128 Sep 24  2010 testlatt.m
-rw-r--r--   1 stew  stew    4618 Jun 15  2011 tt-conn-ERRSTATE.mat
-rw-r--r--   1 stew  stew    6221 Jun 13 17:50
update_2012_June_13.bundle
drwxr-xr-x   4 stew  stew     136 Jun 13 18:28 videos 
```

注意：如果程序不在您的可执行路径上，您可能需要指定其绝对路径：

```
s = '/usr/bin/ls';
[status, result] = system(s); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T18:20:17.327

我想我问了一个完全相同的问题，但无法得到答案。

[是否可以在 MATLAB 环境内部和外部执行编译代码？](https://stackoverflow.com/questions/10566991/is-it-possible-to-execute-compiled-code-both-within-and-out-of-matlab-environmen)

我相信这是不可能的，因为 Mathworks 不希望您分发免费的 Matlab 解释器。我想知道是否可以分别编译两组 M 文件并从第一个文件中运行第二个文件作为解决方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T10:04:32.900

您可以使用该`-a`选项编译其他文件。

例如，使用此命令，您将能够从独立应用程序调用当前目录中的任何 .m 文件：

```
mcc -m myscript.m -a *.m 
```

# android - 如何使用我的应用程序中的代码从 Google Play 商店中选择应用程序？

> ID：11381256
> 
> 赞同：0
> 
> 时间：2012-07-08T06:51:55.797
> 
> 标签：android, google-play

我正在开发一个应用程序，其中有一个画廊。当我点击一个画廊项目时，我应该去 Google Play 并选择一个应用程序（比如愤怒的小鸟），然后如果我想要下载它。如何使用代码做到这一点？准确地说，我想通过单击图库中的一个项目来访问 Google Play。我已经搜索了很多，但我没有得到它。（如何通过单击按钮或其他任何内容进入 Google Play 商店）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T06:55:36.627

```
String desiredAppId = "com.rovio.angrybirds";
Intent i = new Intent(Intent.ACTION_VIEW,Uri.parse("market://details?id="+desiredAppId));
startActivity(i); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T07:13:29.303

您应该使用`Intent`正确的 URI 格式。代码可能看起来像这样

```
String packageName = "com.example.someapp";
startActivity(new Intent(Intent.ACTION_VIEW, Uri.parse("market://details?id="+packageNAme))); 
```

更多详细信息：[链接到 Google Play 上的应用程序](http://developer.android.com/distribute/googleplay/promote/linking.html)。

# jquery - jQuery - 删除数组中的类

> ID：11381260
> 
> 赞同：6
> 
> 时间：2012-07-08T06:53:41.727
> 
> 标签：jquery, arrays, removeclass

我有一个 div 对象

```
<div class="class1 classA classB class2"> content </div> 
```

和一些按钮

```
<button id="numbers">clickme N </button>

<button id="alphas">clickme A </button> 
```

代码应该执行此功能：

```
<script>
    var classesN = [class1, class2, class3];
    var classesAlpha = [classA, classB, classC];

    $('#alphas').click(function() {
       $('div').removeClass(all classes that are in the classesAlpha array);
    });
    $('#numbers').click(function() {
       $('div').removeClass(all classes that are in the classesN array);
    })
</script> 
```

感谢您的任何建议，我希望您喜欢这个问题:)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-08T06:57:56.727

[.removeClass( [className] )](http://api.jquery.com/removeClass/) :className要从每个匹配元素的类属性中删除一个或多个**空格分隔的类。**

因此，将您要删除的所有类加入一个空格分隔的列表中。

```
var classesN = [class1, class2, class3];
var classesAlpha = [classA, classB, classC];

$('#alphas').click(function() {
   $('div').removeClass(classesAlpha.join(' '));
});
$('#numbers').click(function() {
   $('div').removeClass(classesN.join(' '));
}); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-08T07:00:24.207

```
var classesN = ["class1", "class2", "class3"];
var classesAlpha = ["classA", "classB", "classC"];

$('#alphas').click(function() {
    var $div = $('div');
    $.each(classesAlpha, function(i, v){
       $div.removeClass(v);
    });
}); 
```

[演示](http://jsfiddle.net/3JyRR/4/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-08-31T17:55:17.577

或者可以不使用数组和 join() 函数。只需将类分配给变量

```
var classesN = "class1 class2 class3";
var classesAlpha = "classA classB classC";

$('#alphas').click(function() {
   $('div').removeClass(classesAlpha);
});
$('#numbers').click(function() {
   $('div').removeClass(classesN);
}); 
```

# asp.net - 保留用户对自动回发 asp.net 的控制

> ID：11381263
> 
> 赞同：0
> 
> 时间：2012-07-08T06:54:32.683
> 
> 标签：asp.net, user-controls, autopostback

我有两个用户控件：aspx 页面中的 dsucTopLeft 和 dsucTopRight。每个用户控件都有一个下拉列表来从中选择值。

aspx 页面有一个“保存”按钮。

在按钮的 OnClickEvent 中，我从那些用户控件（返回下拉列表中的值）中获取数据。我需要将这些值插入数据库。但是，单击按钮后这些值设置为 0。

我将如何保留这些价值观？

代码：

父模板.aspx

```
<div class="leftDashboard">
    <uc:dsuc ID="dsucTopLeft" runat="server" />
</div>

<div id="rightDashboard">
    <uc:dsuc ID="dsucTopRight" runat="server" />
</div> 
```

它还有一个按钮：

```
<asp:Button ID="SaveButton" runat="server" OnClick="SaveButton_Click" Text="Save Dashboard" /> 
```

这是按钮的代码隐藏：

```
protected void SaveButton_Click(object sender, EventArgs e)
    {
        //If the mode is "CREATE", then it needs to insert the information about     dashboard and the charts it contains
        for (int i = 0; i < dsuc.Length; i++)
        {
            dsuc[i].dashboardId = dashboardId;
            if (dsuc[i].chartId != 0) //Here, the chartId remains 0
                dsuc[i].insert();
        }
    } 
```

dsuc 是一个数组。它以下列方式填充：

```
protected void Page_Load(object sender, EventArgs e)
    {
        if (!Page.IsPostBack)
        {
            dsuc[0]=dsucTopLeft;
            dsuc[1]=dsucTopRight;
        }
    } 
```

用户控制：

```
protected void Page_Load(object sender, EventArgs e)
    {
        if (!Page.IsPostBack)
        {
            initializeDropDownList();//It initializes the drop down list
        }
    }

public void insert()
{
    //It inserts into database
}

protected void chartDDLSelectedIndexChanged(object sender, EventArgs e)
    {
        oldChartId = chartId;
        String chartTitle = chartDropDownList.SelectedItem.Text;
        if (chartTitle != dropDownMessage)
        {
            chartId = int.Parse(chartDropDownList.SelectedItem.Value);
            //Chart user control should be retrieved from the database and drawn.
            chartTitleLabel.Text += "chart id : " + chartId.ToString() + " title: " + chartTitle;
            //chartUserControl.Visible = true;
        }
    } 
```

用户控件，即 dsuc[] 类在其下拉列表中的项目被选中时更改其 chartId。我打印了值，它有效。但是当单击按钮时，相同的值变为 0。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T07:28:04.483

`if (!Page.IsPostBack)`从_

```
 if (!Page.IsPostBack)
    {
        dsuc[0]=dsucTopLeft;
        dsuc[1]=dsucTopRight;
    } 
```

如果没有，它只会在不回发时填充它。当单击产生回发时，您将希望执行该代码:)

此外，可能是您`clickp event is being called before`selectedindexchanged 。在这种情况下，设置 chartId 的代码在触发 click 事件时（尚未）执行。你可以解决这个问题：

```
public int ChartId { get { return int.Parse(chartDropDownList.SelectedItem.Value); }} 
```

并改为调用该属性。此外，您可以在 selectedindexchanged 事件处理程序中使用该属性

# android - onClick 错误地启动 Activity（在 2.3.6 中）

> ID：11381264
> 
> 赞同：3
> 
> 时间：2012-07-08T06:54:38.610
> 
> 标签：android, android-activity

我正在开发一个提供一组多个`Button`对象的接口，每个对象都附加了相同的`OnClickListener`. 当单击所述`Button`s 时，它们应该启动一个`Activity`，如`onClick`.

这是我的参考代码：

```
public class Calcs extends SherlockFragment {
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
        // ...

        CalcLoader buttonListener = new CalcLoader(getActivity());
        LinearLayout buttons = (LinearLayout) v.findViewById(R.id.calculatorlist); // v is the inflated View
        for (int i = 0; i < buttons.getChildCount(); i++) {
            View b = buttons.getChildAt(i);
            if (b instanceof Button) {
                ((Button) b).setOnClickListener(buttonListener);
            }
        }

        // Test Code: Location 1
        Intent i = new Intent(getActivity(), MyCalcActivity.class);
        getActivity().startActivity(i);

        // ...
    }

    private class CalcLoader implements OnClickListener {
        private Activity mOwner;

        public CalcLoader(Activity owner) {
            mOwner = owner;

            // Test Code: Location 2
            Intent i = new Intent(mOwner, MyCalcActivity.class);
            mOwner.startActivity(i);
        }

        public void onClick(View v) {
            if (v instanceof Button) {
                // Actual Code: Location 3
                Intent i = new Intent(mOwner, MyCalcActivity.class);
                mOwner.startActivity(i);
            }
        }
    }
} 
```

尽管如此，我还是有一些奇怪的行为。在上面的代码中，我放置了一些`startActivity`测试，标记为位置 1 和 2。在这两种情况下，`Activity`启动都正确，一切都很好！

但是，在应该执行工作代码的位置 3，我从 launch 中得到了一些奇怪的行为`Activity`：

*   起初，`Activity`它启动得很好。它显示一个单一的文本字段并且它被聚焦，软键盘出现了。这是对的。
*   现在，当我单击后退按钮时，键盘会关闭。这是对的。
*   再次单击返回，该字段将失去焦点。这不应该发生。相反，`Activity`应该关闭并返回前一个。
*   再次单击返回，整个应用程序将关闭（而不是返回到上一个`Activity`）。显然，这不应该发生。

重申一下，当`Activity`从位置 1 或 2 开始时，一切正常；后堆栈是正确的并正确返回初始值`Activity`。

这里出了什么问题？为什么，当我`Activity`从 from开始时`onClick`，它会失败，而它在任何其他位置都可以工作？

**更新：**在构造函数中保存`Intent`并在`onClick`方法中重用它会产生相同的故障结果，就像`Activity`从 UI 线程启动一样。

**第二次更新：**使文本字段无法聚焦对故障没有影响；后退按钮仍然关闭应用程序。此外，在 2.3.3 模拟器中运行也有相同的结果。但奇怪的是，在第二次按下后退按钮（文本字段失去焦点）后，如果您等待约 3 秒，则`Activity`关闭并返回主按钮。

**第三次更新：**从文本字段获取焦点的后退按钮不会触发任何键事件（`onKeyDown`或）。`onBackPressed`此外，如果您在文本字段失去焦点后进行交互`Activity`，它会显示加载`Activity`相同类型的新内容的动画，但此处也存在故障。

这似乎是操作系统级别的问题，在 Android 2.2 (API 8)、2.3.1 (API 9) 和 2.3.3 (API 10) 中发现。Eclair (API 7) 和 API 11+ 没有这个问题。在这一点上，我相信我正在寻找某种解决方法......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T21:53:10.350

Turns out my issue was not caused by something I detailed in my original post, so I apologize for that.

The issue was caused by a `SurfaceView` item on a tab unrelated to the tab I was testing on. After rebuilding the tabs and layouts from the ground up (and building each time), I discovered the lag-back-glitch was only caused when a `SurfaceView` was present in a non-focused tab.

I finally found that [I was not the only one with this issue](https://stackoverflow.com/questions/11356085/android-viewpager-surfaceview-long-delay-when-navigating-back-to-activity).

To solve:

*   Created an `onPause` method in the main `Activity`. In here, I destroy the `SurfaceView` using `container.removeView(..);`.
*   Created an `onResume` method in the main `Activity`. In here, I inflate the `SurfaceView` from a new XML file containing ONLY the `SurfaceView` item, and add it to the original `container`.
*   Lastly, implemented a `android.view.SurfaceHolder.Callback` in the `SurfaceView` to erase the contents of the surface before it is removed.

It stumps me that this happens only on APIs 8-10, but I'm glad it's solved now. Kudos to everyone that offered their assistance!

# jquery - 未捕获的异常对象# 没有方法'html'

> ID：11381265
> 
> 赞同：0
> 
> 时间：2012-07-08T06:54:48.970
> 
> 标签：jquery, html, javascript-events

我收到这条消息

> 未捕获的异常对象#displayusersearch2 没有方法“html”

代码是

```
<script src="../../javascript/jqueryfunctions.js" type="text/javascript"></script>
<script src="../../jquery.min.js" type="text/javascript"></script>
<script type="text/javascript">
function uid_id_search_change()
{
    var search=document.getElementById('uid_id_search').value;
    $.get('userdisplaypopup.php?id='+search,userset);
 }

 function userset(res)
 {
     ('#displayusersearch2').html(res);
     Uncaught TypeError: Object #displayusersearch2 has no method 'html'
 }
 </script>

 <table width="600" border="0">
     <tr>
         <th scope="row"><font size="-1">Book Id</font></th>
         <td><input type="text" value="1" id="bid_popup" /></td>
     </tr>
     <tr>
         <th scope="row"><font size="-1">Book Name</font></th>
         <td><input type="text" value="1" /></td>
      </tr>
      <tr>
          <th scope="row"><font size="-1">Author</font></th>
          <td><input type="text" value="1" /></td>
      </tr>
      <tr>
          <th scope="row"><font size="-1">Publisher</font></th>
          <td><input type="text" value="1" /></td>
      </tr>
      <tr>
          <th scope="row">Search User</th>
          <td><input type="text" id="uid_id_search" name="uid_id_search" onkeyup="uid_id_search_change();" />
          <div id="displayusersearch2"></div></td>
      </tr>
</table> 
```

div 的 id 是 displayusersearch2。请求发送正确。我试图让响应显示在 div displayusersearch2

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-08T06:57:13.297

```
('#displayusersearch2') 
```

您省略`$`了 jQuery 包装器调用。没有它，这只不过是一个字符串文字。该字符串`'#displayusersearch2'`没有`html()`方法。

```
$('#displayusersearch2').html(res); 
```

还，

```
$.get('userdisplaypopup.php?id='+search,userset); 
```

`search`对于其中包含 URL 特殊字符的任何术语都将失败。建议使用`encodeURIComponent()`，或者让 jQuery 为你做：

```
$.get('userdisplaypopup.php', {id: search}, userset); 
```

# .htaccess - Htaccess 阻止访问特定的 Mediawiki 页面？

> ID：11381266
> 
> 赞同：1
> 
> 时间：2012-07-08T06:54:55.740
> 
> 标签：.htaccess, mediawiki

在 Mediawiki 中，我试图找到一种方法来阻止访问我们的某些模板页面。我不希望我们的某些竞争对手查看我们复杂的代码并为他们的 wiki 窃取它（不幸的是，这在我来自的同人圈中很常见）。因此，当人们尝试查看特定模板页面时，我试图通过将人们重定向到主 wiki 页面来使用 htaccess 来完成此操作。然而，什么都没有发生。这是我使用的：

重定向 /wiki/index.php?title=Template:Box /wiki/index.php

不过，我不确定我正在尝试做的事情是否可行，或者是否应该使用 htaccess！

先感谢您！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T17:51:01.213

简而言之：**不要那样做！**

让我引用 MediaWiki 文档的相关部分：[MediaWiki 不是为 CMS 设计的，也不是为了保护敏感数据。相反，它被设计为尽可能开放。因此，它本身并不支持对私有内容的全功能、密封保护。](https://www.mediawiki.org/wiki/Security_issues_with_authorization_extensions)

MediaWiki 无法保证部分读取权限：人们要么可以看到每一页，要么一个都看不到。否则，将有漏洞读取您的宝贵数据。例如，TerryE 的重写规则技巧绝对不会增加任何安全性：在其他一百种方式中，可以简单地更改`Template:Box`为`Template_:_Box`，而后者将在内部规范化为前者。MW 有时 HTTP 重定向到规范化的标题，但这很容易克服。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T09:38:46.647

MW中有很多获取模板内容的方法，并且MW有自己的访问控制扩展，所以我认为您正在尝试治愈泄漏的筛子，但直接回答您的Q：

```
RewriteEngine On
RewriteBase   /

RewriteCond  %{QUERY_STRING} \bTemplate:Box\b
RewriteRule  wiki/index.php  $0?             [L] 
```

`/wiki/index.php`如果 URI 是 for并且查询字符串包含**Template:Box**，这将删除查询参数。

# android - JQM Click 事件在 Android Webview 中不起作用

> ID：11381268
> 
> 赞同：0
> 
> 时间：2012-07-08T06:55:31.760
> 
> 标签：android, jquery-mobile, android-webview

我有一个包含三个元素的锚。每个元素都必须响应点击事件。我有这个和 Android 网络视图应用程序。

令人惊讶的是，单击事件在 android 浏览器中有效，但是当我尝试使用该 android webview 应用程序时，什么也没有发生。请参考下面的代码。

我不知道我错过了什么，所以点击事件在 android webview 应用程序中不起作用。

```
$("#cont2 li a").live('click', function (e) {
                //e.preventDefault();
                this.blur();

                var name = $(this).attr("name");
                var staffid = $(this).attr("staffid");
                var recordid = $(this).attr("recordid");
                var primary = $(this).attr("primary");

                if (name == "deletestaff") {
                    // delete sales staff
                    var dretVal = confirm("Delete contact staff " + $(this).attr("staffname") + "?");
                    if (dretVal == false) {
                        return false;
                    } else {

                        var txtprimaryrecordid = $("#txtprimaryrecordid").val();
                        var txtprimarystaffid = $("#txtprimarystaffid").val();

                        if (txtprimaryrecordid == 'undefined') {
                            txtprimaryrecordid = "";
                        }

                        if (txtprimarystaffid == 'undefined') {
                            txtprimarystaffid = "";
                        }

                        if (txtprimaryrecordid == recordid) {
                            $("#txtprimaryrecordid").val("");
                        }
                        if (txtprimarystaffid == staffid) {
                            $("#txtprimarystaffid").val("");
                        }

                        $(this).parents('li').remove();

                        // show deleted item
                        $('#staffs input[type=checkbox]').each(function () {
                            var delstaffid = $(this).attr("staffid");

                            if (staffid == delstaffid) {
                                $(this).attr("checked", false).checkboxradio("refresh");
                            }
                        });
                    }
                } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T12:59:38.297

知道了。只需要实现 WebChromeClient ...

```
private class WebChromeClient extends WebChromeClient{
        @Override
        public boolean onJsAlert(WebView view, String url, String message,JsResult result) 
        {
            Log.e("alert triggered", message);
            return false;         
        }
    } 
```

# facebook - FB.Event.subscribe

> ID：11381270
> 
> 赞同：1
> 
> 时间：2012-07-08T06:55:54.653
> 
> 标签：facebook, facebook-javascript-sdk

如何使用[FB.Event.subscribe](http://FB.Event.subscribe)[订阅订阅按钮](http://developers.facebook.com/docs/reference/plugins/subscribe/)事件？

我生成了订阅按钮：

```
<div class="fb-subscribe" data-href="https://www.facebook.com/zuck" data-show-faces="true"
        data-width="450"> 
```

我有办法知道用户是“订阅”还是“取消订阅”？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T03:01:56.367

根据 Facebook 当前的文档，您不能订阅它。您可以将该方法应用于 11 个事件，但按下订阅按钮不是其中之一。

# postgresql - 使用开发数据库而不是 ENV ['DATABASE_URL'] 在 Heroku 上的 DataMapper 连接？

> ID：11381271
> 
> 赞同：0
> 
> 时间：2012-07-08T06:56:16.287
> 
> 标签：postgresql, heroku, ruby-datamapper

`'postgres://postgres:myohmysosecret@localhost/recall'`我的问题是，当部署到 Heroku DataMapper时，当我拥有`DataMapper.setup(:default, ENV['DATABASE_URL'] || 'postgres://postgres:myohmysosecret@localhost/recall')`完整的数据库连接时，它会尝试使用这部分数据库连接信息。

这是我的 Heroku 日志文件：

```
2012-07-08T06:49:40+00:00 heroku[web.1]: Starting process with command `bundle exec rackup config.ru -p 26035`
2012-07-08T06:49:48+00:00 app[web.1]:   Is the server running on host "localhost" and accepting
2012-07-08T06:49:48+00:00 app[web.1]:   from <internal:prelude>:10:in `synchronize'
2012-07-08T06:49:48+00:00 app[web.1]: /app/vendor/bundle/ruby/1.9.1/gems/data_objects-0.10.8/lib/data_objects/connection.rb:79:in `initialize': could not connect to server: Connection refused (DataObjects::ConnectionError)
2012-07-08T06:49:48+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/data_objects-0.10.8/lib/data_objects/pooling.rb:177:in `block in new'
2012-07-08T06:49:48+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/data_objects-0.10.8/lib/data_objects/pooling.rb:172:in `new'
2012-07-08T06:49:48+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/data_objects-0.10.8/lib/data_objects/connection.rb:79:in `new'
2012-07-08T06:49:48+00:00 app[web.1]:   TCP/IP connections on port 5432?
2012-07-08T06:49:48+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/dm-do-adapter-1.2.0/lib/dm-do-adapter/adapter.rb:251:in `open_connection'
2012-07-08T06:49:48+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/data_objects-0.10.8/lib/data_objects/connection.rb:68:in `new'
2012-07-08T06:49:48+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/data_objects-0.10.8/lib/data_objects/pooling.rb:119:in `new'
2012-07-08T06:49:48+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/dm-transactions-1.2.0/lib/dm-transactions/adapters/dm-do-adapter.rb:69:in `open_connection'
2012-07-08T06:49:48+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/dm-do-adapter-1.2.0/lib/dm-do-adapter/adapter.rb:276:in `with_connection'
2012-07-08T06:49:48+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/dm-do-adapter-1.2.0/lib/dm-do-adapter/adapter.rb:61:in `execute'
2012-07-08T06:49:48+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/dm-migrations-1.2.0/lib/dm-migrations/adapters/dm-postgres-adapter.rb:60:in `ensure in without_notices'
2012-07-08T06:49:48+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/dm-migrations-1.2.0/lib/dm-migrations/adapters/dm-postgres-adapter.rb:60:in `without_notices'
2012-07-08T06:49:48+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/dm-migrations-1.2.0/lib/dm-migrations/adapters/dm-postgres-adapter.rb:18:in `upgrade_model_storage'
2012-07-08T06:49:48+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/dm-migrations-1.2.0/lib/dm-migrations/auto_migration.rb:73:in `upgrade_model_storage'
2012-07-08T06:49:48+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/dm-migrations-1.2.0/lib/dm-migrations/auto_migration.rb:47:in `block in repository_execute'
2012-07-08T06:49:48+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/dm-migrations-1.2.0/lib/dm-migrations/auto_migration.rb:145:in `auto_upgrade!'
2012-07-08T06:49:48+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/dm-core-1.2.0/lib/dm-core/support/descendant_set.rb:64:in `block in each'
2012-07-08T06:49:48+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/dm-core-1.2.0/lib/dm-core/support/ordered_set.rb:319:in `each'
2012-07-08T06:49:48+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/dm-core-1.2.0/lib/dm-core/support/ordered_set.rb:319:in `block in each'
2012-07-08T06:49:48+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/dm-core-1.2.0/lib/dm-core/support/subject_set.rb:210:in `block in each'
2012-07-08T06:49:48+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/dm-core-1.2.0/lib/dm-core/support/ordered_set.rb:319:in `each'
2012-07-08T06:49:48+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/dm-core-1.2.0/lib/dm-core/support/subject_set.rb:210:in `each'
2012-07-08T06:49:48+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/dm-core-1.2.0/lib/dm-core/support/descendant_set.rb:63:in `each'
2012-07-08T06:49:48+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/dm-migrations-1.2.0/lib/dm-migrations/auto_migration.rb:46:in `repository_execute'
2012-07-08T06:49:48+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/dm-migrations-1.2.0/lib/dm-migrations/auto_migration.rb:27:in `auto_upgrade!'
2012-07-08T06:49:48+00:00 app[web.1]:   from /app/recall.rb:25:in `<top (required)>'
2012-07-08T06:49:48+00:00 app[web.1]:   from /app/config.ru:2:in `require'
2012-07-08T06:49:48+00:00 app[web.1]:   from /app/config.ru:2:in `block in <main>'
2012-07-08T06:49:48+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:51:in `instance_eval'
2012-07-08T06:49:48+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:51:in `initialize'
2012-07-08T06:49:48+00:00 app[web.1]:   from /app/config.ru:1:in `new'
2012-07-08T06:49:48+00:00 app[web.1]:   from /app/config.ru:1:in `<main>'
2012-07-08T06:49:48+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:40:in `parse_file'
2012-07-08T06:49:48+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:40:in `eval'
2012-07-08
T06:49:48+00:00 app[web.1]:     from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:200:in `app'
2012-07-08T06:49:48+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:301:in `wrapped_app'
2012-07-08T06:49:48+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:252:in `start'
2012-07-08T06:49:48+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/bin/rackup:4:in `<top (required)>'
2012-07-08T06:49:48+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:137:in `start'
2012-07-08T06:49:48+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/bin/rackup:19:in `load'
2012-07-08T06:49:48+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/bin/rackup:19:in `<main>' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T20:40:21.043

我遇到了这个问题，最后它似乎与以下有关，这是在[Heroku 教程](https://devcenter.heroku.com/articles/rack)中，但似乎是错误的：

```
ENV['DATABASE_URL'] 
```

基本上，您可能没有数据库。运行`heroku config`显示了这一点。您可以运行以下行来为您创建一个数据库，详见[此处](https://devcenter.heroku.com/articles/heroku-postgresql#connecting-in-ruby)：

```
heroku addons:add heroku-postgresql:dev 
```

然后`heroku config`再次运行以获取数据库字符串，或者您可以只在 DataMapper.setup 中使用以下行：

```
ENV['HEROKU_POSTGRESQL_CYAN_URL'] 
```

希望这可以帮助！我已将此添加到我自己的 Heroku 支持票中，看看他们怎么说！

# jquery - 如何在页面中心对齐 Lightbox 2？

> ID：11381272
> 
> 赞同：0
> 
> 时间：2012-07-08T06:56:18.843
> 
> 标签：jquery, asp.net, css, webforms, lightbox2

我在画廊工作。一切都很好，除了灯箱库比屏幕中央稍微多一点。

灯箱来源： http: [//lokeshdhakar.com/projects/lightbox2/](http://lokeshdhakar.com/projects/lightbox2/)

它应该动态地将叠加层放置在屏幕的中心，但由于某种原因，在我的情况下它没有这样做。当我调试代码时，它将主要的灯箱容器属性显示为：

```
<div id="lightbox" style="display: block; top: 189.4px; left: 0px;"> 
```

第二个问题：我怎样才能将照片的描述添加到灯箱中，因为现在它只显示照片的标题。我实际上需要添加照片的描述和日期。

为了更清楚，我添加了屏幕截图以显示它在我的屏幕上的外观：

![在此处输入图像描述][1]

从这个屏幕截图可以清楚地看出，Lightbox 从顶部：75 像素开始，这不会使图像垂直对齐在屏幕中间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-05T06:46:24.757

我遇到了同样的问题。垂直对齐由屏幕高度决定，但不考虑图像大小。我的问题是在纵向模式下拍摄的照片会溢出页面，所以我决定修改灯箱代码以将所有图像向上移动。如果您提前知道所有图像的大小相同，那么理论上您可以将此值更改为您需要的任何值（您必须自己进行计算。在灯箱中查找这部分代码js并进行相应的修改。

```
o=f.scrollTop()+f.height()/10;n=f.scrollLeft();this.$lightbox.css({top:o+'px',left:n+'px'} 
```

或者，在灯箱 css 文件中，查找`.lightbox`并添加以下内容：

```
 top: 0px !important; 
```

将 0px 值修改为您计算的任何值。

要向灯箱添加说明，请设置`<img>`标签的`alt`属性。

# c# - Asp.net mvc3, C#, Datetime.Parse()

> ID：11381275
> 
> 赞同：2
> 
> 时间：2012-07-08T06:57:14.120
> 
> 标签：c#, asp.net, asp.net-mvc

这很奇怪。我有来自 Http GET 的日期格式数据，并使用模型类包装日期。是这样的，

```
// Model

public class wrapModel
{
  public DateTime mydate{get; set;}
} 
```

和，

```
// controller
[HttpGet]
public void myController(wrapModel data){
   Response.Write(searchModel.mydate.ToString());
} 
```

并使用浏览器调用控制器，*myhost/home/myController/mydate=05/05/2012*

然后它打印**“5/5/2012 12:00:00 AM”**，我预计只在 2012 年 5 月 5 日。

我不需要时间。所以我试图解析日期。

```
data.mydata = DateTime.parse(data.mydata.ToString("MM/dd/yyyy")); 
```

但它仍然打印“5/5/2012 12:00:00 AM”

如何将格式更改为“2012 年 5 月 5 日”？

有知道的请指教~

谢谢！

我想解析来自 Http GET 的日期时间格式数据。

但我没有改变，也

[编辑]

感谢您的所有回答和您宝贵的时间！但我仍然有问题。请帮我多一点:)

首先，我需要 DateTime 格式的数据，而不是字符串类型，因为我将使用 Linq 中的日期来检索数据库日期。

我试过，

1)

```
[DisplayFormat(DataFormatString="{0:MM/dd/yyyy}", ApplyFormatInEditMode=true)]
public DateTime mydate { get; set; }

[HttpGet]
public ActionResult myController(wrapModel data){
   return Content(searchModel.mydate.ToString());
} 
```

仍然打印“5/5/2012 12:00:00 AM”

2)

```
[HttpGet]
public ActionResult myController(wrapModel data){
   return Content(searchModel.mydate.ToString("MM/dd/yyyy"));
} 
```

它也改变了格式，但我需要 DateTime 格式，所以我再次转换为 DateTime。

```
[HttpGet]
public ActionResult myController(wrapModel data){
   searchModel.mydate = DateTime.Parse(searchModel.mydate.ToString("MM/dd/yyyy"));
   return Content(searchModel.mydate.ToString());
} 
```

然后它再次打印“5/5/2012 12:00:00 AM”。

3)

```
searchModel.etaDate.ToString("d") 
```

与上面相同，转换为 DateTime 然后打印“5/5/2012 12:00:00 AM”

和

我使用 Response.Write() 进行简单的返回值测试，但是我不能使用 Response.Write() 方法有什么重要原因吗？我想学习 ：）

非常感谢！

[编辑]

**我需要为此输入 DateTime 类型的数据，**

```
Repository myRespository = new Respository();

var data = (from x in myRepository.myContext
            where x.thedate == mydate  // thedate is datetime type, so I need datetime type for compare
            select x.no).SingleOrDefault() 
```

我试过，

```
string test = mydate.ToShortDateString();

(...
where x.thedate.ToString() == test
...) 
```

但它不起作用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-08T06:58:26.760

> 如何将格式更改为“2012 年 5 月 5 日”？

您首先必须使用正确的格式传递参数，该格式**始终** `yyyy-MM-dd`适用于 GET 请求：

```
http://myhost/home/myController/mydate=2012-05-05 
```

我一直强调这个词**，**因为理解这一点非常重要。原因是默认模型绑定器在解析来自 GET 请求的日期时**总是**使用 InvariantCulture，而在解析来自 POST 请求的日期时它使用当前文化。有一篇[很好的文章](http://weblogs.asp.net/melvynharbour/archive/2008/11/21/mvc-modelbinder-and-localization.aspx)解释了这一点以及这个设计决定背后的原因。

进而：

```
Response.Write(searchModel.mydate.ToString("MM/dd/yyyy")); 
```

好吧，实际上，并不是`Response.Write`因为您从未在 ASP.NET MVC 应用程序中这样做，您宁愿从控制器操作返回一个 ActionResult：

```
[HttpGet]
public ActionResult MyAction(wrapModel data)
{
    return Content(data.mydate.ToString("MM/dd/yyyy"));
} 
```

或者您将使用以下`DisplayFormat`属性装饰您的视图模型：

```
public class wrapModel
{
    [DisplayFormat(DataFormatString = "{0:MM/dd/yyyy}", ApplyFormatInEditMode = true)]
    public DateTime mydate { get; set; }
} 
```

或者如果您想考虑当前的文化短日期格式：

```
public class wrapModel
{
    [DisplayFormat(DataFormatString = "{0:d}", ApplyFormatInEditMode = true)]
    public DateTime mydate { get; set; }
} 
```

然后让您的控制器操作将此模型传递给视图：

```
public ActionResult MyAction(wrapModel data)
{
    return View(data);
} 
```

当然，在相应的强类型视图中，使用`DisplayFor`/`EditorFor`帮助器以所需格式实现所需的输出：

```
@model wrapModel
<span>
    @Html.DisplayFor(x => x.mydate)
</span> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T07:02:11.407

采用

```
datevar.ToShortDateString(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T07:09:04.257

（注意：Darin 的回答非常适合 MVC。我已经发布了这个以获得更多一般信息。）

> 但它仍然打印“5/5/2012 12:00:00 AM”

是的，它会的。仅仅因为您*解析*了一个只有日期的值，所以该`DateTime`值不知道。那*只是*一个日期和时间。如果您调用`ToString`它，它将*始终*使用当前文化的默认格式。

我强烈建议您*避免*对字符串进行比您绝对必须做的更多的转换。尽可能早地解析该值，然后将其保留为`DateTime`内部，直到您绝对必须将其转换回字符串 - 用于无法本`DateTime`机使用的系统（例如保存到文件）或写入它返回给用户。

如果您*要将*其写回给用户，则应确保为该用户使用适当的文化，并使用适当的格式字符串 - 例如`d`“短日期”。虽然您*可以*使用`ToShortDateString`，但这不允许您指定文化，而`ToString`可以：

```
string text = date.ToString("d", culture); 
```

在*不*向用户显示信息的任何地方，我强烈建议使用标准格式：“yyyy-MM-dd”用于日期，“yyyy-MM-dd'T'HH:mm:ss.fffffffK”用于日期/时间值。（后者由`o`标准格式字符串表示。）

请注意，格式对于日期*非常*重要。如果你给我看一个显示“08/07/2012”的网页，我不知道是 8 月 7 日还是 7 月 8 日。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-08T07:25:28.407

解析后请使用 .ToShortDateString()

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-08-17T21:39:49.227

您应该在视图中使用该代码：

```
item.mydate.Value.ToShortDateString() 
```

# c++ - 如何加快系列生成？

> ID：11381277
> 
> 赞同：17
> 
> 时间：2012-07-08T06:57:23.693
> 
> 标签：c++, algorithm, optimization, numbers

该问题需要生成`n-th`类似于斐波那契数列的数列元素。但是，它有点棘手，因为`n`它非常大（1 <= n <= 10^9）。答案然后模1000000007。序列定义如下：
![在此处输入图像描述](../Images/1b27d32549d65ac5d04b37f944cd532c.png)

使用生成函数，我得到以下公式： ![在此处输入图像描述](../Images/6d35b8dedee8e94115c8226e63c481b3.png)

如果我使用序列方法，那么答案可以是模数，但运行速度非常慢。事实上，我得到了`time limit exceed`很多次。我还尝试使用表来预生成一些初始值（缓存），但速度仍然不够快。此外，`array/vector`与 10^9 相比，我可以在 (C++) 中存储的最大元素数量太少，所以我猜这种方法也行不通。
如果我使用直接公式，那么它运行得非常快，但只是因为`n`它很小。对于`n`大的，双精度数将被截断，而且我将无法用该数字修改我的答案，因为模数仅适用于整数。
我没有想法，我认为必须有一个非常好的技巧来解决这个问题，不幸的是我想不出一个。任何想法将不胜感激。

这是我的初步方法：

```
#include <iostream>
#include <vector>
#include <string>
#include <algorithm>
#include <cmath>
#include <cassert>
#include <bitset>
#include <fstream>
#include <iomanip>
#include <set>
#include <stack>
#include <sstream>
#include <cstdio>
#include <map>
#include <cmath>

using namespace std;

typedef unsigned long long ull;

ull count_fair_coins_by_generating_function(ull n) {
    n--;
    return 
        (sqrt(3.0) + 1)/((sqrt(3.0) - 1) * 2 * sqrt(3.0)) * pow(2 / (sqrt(3.0) - 1), n * 1.0) 
        +
        (1 - sqrt(3.0))/((sqrt(3.0) + 1) * 2 * sqrt(3.0)) * pow(-2 / (sqrt(3.0) + 1), n * 1.0);
}

ull count_fair_coins(ull n) {
    if (n == 1) {
        return 1;
    }
    else if (n == 2) {
        return 3;
    }
    else {
        ull a1 = 1;
        ull a2 = 3;
        ull result;
        for (ull i = 3; i <= n; ++i) {
            result = (2*a2 + 2*a1) % 1000000007;
            a1 = a2;
            a2 = result;
        }

        return result;
    }
}

void inout_my_fair_coins() {
    int test_cases;
    cin >> test_cases;

    map<ull, ull> cache;
    ull n;
    while (test_cases--) {
        cin >> n;
        cout << count_fair_coins_by_generating_function(n) << endl;
        cout << count_fair_coins(n) << endl;
    }
}

int main() {
    inout_my_fair_coins();
    return 0;
} 
```

**更新** 由于比赛结束了，我根据`tskuzzy`想法为有兴趣的人发布了我的解决方案。再次感谢`tskuzzy`。您可以在此处查看原始问题陈述：http: [//www.codechef.com/problems/CSUMD](http://www.codechef.com/problems/CSUMD)
首先，您需要计算出这些`1 coin`和的概率`2 coin`，然后获取一些初始值以获得序列。完整的解决方案在这里：

```
#include <iostream>
#include <vector>
#include <string>
#include <algorithm>
#include <cmath>
#include <cassert>
#include <bitset>
#include <fstream>
#include <iomanip>
#include <set>
#include <stack>
#include <sstream>
#include <cstdio>
#include <map>
#include <cmath>

using namespace std;

typedef unsigned long long ull;

const ull special_prime = 1000000007;

/*
    Using generating function for the recurrence:
           | 1                     if n = 1
    a_n =  | 3                     if n = 2
           | 2a_{n-1} + 2a_{n-2}     if n > 2

    This method is probably the fastest one but it won't work 
    because when n is large, double just can't afford it. Plus,
    using this formula, we can't apply mod for floating point number.
    1 <= n <= 21
*/
ull count_fair_coins_by_generating_function(ull n) {
    n--;
    return 
        (sqrt(3.0) + 1)/((sqrt(3.0) - 1) * 2 * sqrt(3.0)) * pow(2 / (sqrt(3.0) - 1), n * 1.0) 
        +
        (1 - sqrt(3.0))/((sqrt(3.0) + 1) * 2 * sqrt(3.0)) * pow(-2 / (sqrt(3.0) + 1), n * 1.0);
}

/*
    Naive approach, it works but very slow. 
    Useful for testing.
*/
ull count_fair_coins(ull n) {
    if (n == 1) {
        return 1;
    }
    else if (n == 2) {
        return 3;
    }
    else {
        ull a1 = 1;
        ull a2 = 3;
        ull result;
        for (ull i = 3; i <= n; ++i) {
            result = (2*a2 + 2*a1) % 1000000007;
            a1 = a2;
            a2 = result;
        }

        return result;
    }
}

struct matrix_2_by_2 {
    ull m[2][2];
    ull a[2][2];
    ull b[2][2];

    explicit matrix_2_by_2(ull a00, ull a01, ull a10, ull a11) {
        m[0][0] = a00;
        m[0][1] = a01;
        m[1][0] = a10;
        m[1][1] = a11;
    }

    matrix_2_by_2 operator *(const matrix_2_by_2& rhs) const {
        matrix_2_by_2 result(0, 0, 0, 0);
        result.m[0][0] = (m[0][0] * rhs.m[0][0]) + (m[0][1] * rhs.m[1][0]);
        result.m[0][1] = (m[0][0] * rhs.m[0][1]) + (m[0][1] * rhs.m[1][1]);
        result.m[1][0] = (m[1][0] * rhs.m[0][0]) + (m[1][1] * rhs.m[1][0]);
        result.m[1][1] = (m[1][0] * rhs.m[0][1]) + (m[1][1] * rhs.m[1][1]);
        return result;
    }

    void square() {
        a[0][0] = b[0][0] = m[0][0];
        a[0][1] = b[0][1] = m[0][1];
        a[1][0] = b[1][0] = m[1][0];
        a[1][1] = b[1][1] = m[1][1];

        m[0][0] = (a[0][0] * b[0][0]) + (a[0][1] * b[1][0]);
        m[0][1] = (a[0][0] * b[0][1]) + (a[0][1] * b[1][1]);
        m[1][0] = (a[1][0] * b[0][0]) + (a[1][1] * b[1][0]);
        m[1][1] = (a[1][0] * b[0][1]) + (a[1][1] * b[1][1]);
    }

    void mod(ull n) {
        m[0][0] %= n;
        m[0][1] %= n;
        m[1][0] %= n;
        m[1][1] %= n;
    }

    /*
        exponentiation by squaring algorithm
                | 1                    if n = 0 
                | (1/x)^n              if n < 0 
        x^n =   | x.x^({(n-1)/2})^2    if n is odd
                | (x^{n/2})^2          if n is even

        The following algorithm calculate a^p % m
        int modulo(int a, int p, int m){
            long long x = 1;
            long long y = a; 

            while (p > 0) {
                if (p % 2 == 1){
                    x = (x * y) % m;
                }

                // squaring the base
                y = (y * y) % m; 
                p /= 2;
            }

            return x % c;
        }

        To apply for matrix, we need an identity which is
        equivalent to 1, then perform multiplication for matrix 
        in similar manner. Thus the algorithm is defined 
        as follows:
    */
    void operator ^=(ull p) {
        matrix_2_by_2 identity(1, 0, 0, 1);

        while (p > 0) {
            if (p % 2) {
                identity = operator*(identity);
                identity.mod(special_prime);
            }

            this->square();
            this->mod(special_prime);
            p /= 2;
        }

        m[0][0] = identity.m[0][0];
        m[0][1] = identity.m[0][1];
        m[1][0] = identity.m[1][0];
        m[1][1] = identity.m[1][1];
    }

    friend
    ostream& operator <<(ostream& out, const matrix_2_by_2& rhs) {
        out << rhs.m[0][0] << ' ' << rhs.m[0][1] << '\n';
        out << rhs.m[1][0] << ' ' << rhs.m[1][1] << '\n';
        return out;
    }
};

/*
    |a_{n+2}| = |2 2|^n  x |3| 
    |a_{n+1}|   |1 0|      |1|
*/
ull count_fair_coins_by_matrix(ull n) {
    if (n == 1) {
        return 1;
    } else {
        matrix_2_by_2 m(2, 2, 1, 0);
        m ^= (n - 1);
        return (m.m[1][0] * 3 + m.m[1][1]) % 1000000007;
    }
}

void inout_my_fair_coins() {
    int test_cases;
    scanf("%d", &test_cases);

    ull n;
    while (test_cases--) {
        scanf("%llu", &n);
        printf("%d\n", count_fair_coins_by_matrix(n));
    }
}

int main() {
    inout_my_fair_coins();
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-07-08T07:52:25.417

您可以根据矩阵指数编写序列的项：

![在此处输入图像描述](../Images/091421785ea1cbd9c8a05a55a90661c6.png)

可以[通过平方使用取幂](http://en.wikipedia.org/wiki/Exponentiation_by_squaring)来快速评估。这导致了一个`O(log n)`解决方案，该解决方案应该在时间限制内很好地解决问题。

仅供将来参考，如果您需要与大数相乘（在这种情况下不适用，因为答案取模 1000000007），您应该查看[Karatsuba algorithm](http://en.wikipedia.org/wiki/Karatsuba_algorithm)。这为您提供了二次时间乘法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T07:18:25.227

只是在这里思考，但看看 Duff 的 count_fair_coins 函数设备，因为它会自动展开循环以加速该函数。

在生成函数中预先计算 sqrt 似乎是加快速度的最简单方法。这将减少到只有一个 pow 调用和常量乘法。除了预先计算 sqrt 的另一种加速它的方法是删除除法并使用逆乘法，尽管非常轻微的优化它可能有助于在 n 非常大时加快速度。

# java - JNI将字符串从C传递给java

> ID：11381287
> 
> 赞同：0
> 
> 时间：2012-07-08T06:59:55.233
> 
> 标签：java, c, java-native-interface, type-conversion

我正在尝试将字符串从 C 传递到 java，并且我正在通过以下跟踪重新启动，有人可以帮助我了解如何解决这个问题吗？

```
PC: 2cf57c7c (__GI_strlen+0xc glibc-2.4/string/strlen.c:42) RA: 2cf202a0 (vfprintf+0x42c0 glibc-2.4/stdio-common/vfprintf.c:1549) 
```

我的 JNI 代码如下所示：

```
JNIEXPORT jstring JNICALL xxx_nativeGetParentName
  (JNIEnv *env, jobject obj, jstring childName)
{
    log("nativeGetParentName entered\n");
    char *name; 
    Node* parentName = NULL;
    jstring jstr = NULL;

    name = (char *)(*env)->GetStringUTFChars(env, childName, NULL);
    if (name == NULL)
        return NULL;
    log("about to call mpe_hnGetParentName\n");
    int retCode = mpe_GetParentName(name,&parentName);  // Call to the C function which holds the implementation 
    (*env)->ReleaseStringUTFChars(env,childName,name);

    if (retCode != 0 ) {
       log("mpe_GetParentName called with return code=%d\n", retCode);
       return NULL;
    }

    if(parentName[0] != NULL) {
        jstr= (*env)->NewStringUTF(env, parentName[0]); // Hitting the reboot exactly here!
        log("getting ParentName Succeded=%s\n", jstr);
        free(parentUuid);
    }

    return jstr;
} 
```

C 函数调用的原型如下所示：

```
i32 GetParentName(Node childName, Node **parentName); 
```

该节点本质上是一个字符数组：

```
typedef char[] Node; 
```

我成功地从 C 方法中获取了 parentName，但是当我尝试映射到 JString 时，我正在重新启动。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T07:24:29.560

您的第二条日志消息很可能是问题所在：

```
log("getting ParentName Succeded=%s\n", jstr); 
```

`jstr`是 type `jstring`，它是一个指向结构的指针。它不是可以作为`%s`格式表达式的有效参数传递的字符串。

# jquery - jQuery 获取 ahref 的值并将其放入按钮

> ID：11381288
> 
> 赞同：-1
> 
> 时间：2012-07-08T07:00:11.323
> 
> 标签：jquery, button, href

我有这个问题，我需要获取 href 的值并将其传递给按钮。

这是 jQuery 的正确格式吗？

```
$(function() {
    var getValue = $('#theLink').getAttributeNode('onclick').value;
    $('.yt_holder').live('click', '.videoThumb4', function(){ 
    $(".videoThumb4").ytplaylist({
        holderId: 'ytvideo4',
        html5: true,
        playerWidth: '520',
        autoPlay: false,
        sliding: false,
        listsliding: true,
        social: true,
        autoHide: false,
        playfirst: 0,
        playOnLoad: false,
        modestbranding: true,
        showInfo: false
    });
    });
}); 
```

该按钮正在工作，但它只播放他列表中的第一个视频。该网站的链接在这里[http://cocopop12.site11.com/search/index.php](http://cocopop12.site11.com/search/)

现在按钮是这个。

```
<input class="videoThumb4" onClick="http://www.youtube.com/watch?v=' . $yValue['videoid'] . '" type="button" name="previewSel" value="Preview" id="previewbut" /> 
```

那是对的吗？我需要做一个 onclick `http://www....`blabla 吗？

`<a href>`我喜欢做一个按钮就是这个。

```
<?php
echo '
<a class="videoThumb4" href="http://www.youtube.com/watch?v=' . $yValue['videoid'] . '" id="link">
' . $yValue['description'] . '
</a>
';
?> 
```

我如何将 .each 用于按钮 {Preview}？我怎样才能将值放在按钮中，就像 - 当我单击此 href 时它会自动播放视频？但它只播放第一个视频而不是第二个视频的按钮。我想让它像一个按钮。

感谢您的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T07:37:03.147

我已经检查了您链接到的页面。您所要做的就是获取第三个兄弟（事物是 0-indexed 所以我们使用 2），然后在其上执行 click 事件：

```
$('.videoThumb4').click(function(){ 
    $(this).siblings()[2].click();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T09:11:33.393

因此，如果我正确理解了您的问题，您希望在单击嵌套锚链接时让“预览”按钮跟随嵌套的锚链接。您不能只通过设置`onclick`属性来执行此操作，因为这指定了在引发事件时要运行的脚本——而不是要遵循的链接。

如果`a`链接仍然存在，您可以让按钮在单击`a`链接时触发对链接的单击（您已经有`a`链接单击的处理程序）。

首先，去掉`onClick="..."`按钮中的。

然后，添加以下 javascript 代码来触发链接点击。

```
$('.yt_holder').on('click', '.videoThumb4', function(e){
    e.preventDefault();
    if($(e.target).is('input[type="button"]')){
        $(this).siblings("a.videoThumb4").first().click();
    }
} 
```

这将绑定到所有`.videoThumb4`元素的 'click' 事件（当前在文档中或将来加载），检查它们是否是 html 按钮，然后触发点击下面相应的锚链接（由您的代码处理问题）。注意`.live()`已弃用，您应该使用`.on()`所示的类似功能。

* * *

**更新**：您的新代码应如下所示

```
$(function() {
    $('.yt_holder').on('click', 'a.videoThumb4', function(e){
        $('.videoThumb4').ytplaylist({
            holderId: 'ytvideo4',
            html5: true,
            playerWidth: '520',
            autoPlay: false,
            sliding: false,
            listsliding: true,
            social: true,
            autoHide: false,
            playfirst: 0,
            playOnLoad: false,
            modestbranding: true,
            showInfo: false
        });
    });
    $('.yt_holder').on('click', 'input.videoThumb4', function(e){
        e.preventDefault();
        $(this).siblings("a.videoThumb4").first().click();
    });
​});​ 
```

# jquery - node.js - DatePicker jquery UI 不工作

> ID：11381289
> 
> 赞同：0
> 
> 时间：2012-07-08T07:00:15.897
> 
> 标签：jquery, jquery-ui, node.js

我正在尝试在我的 node.js 项目中使用 JQuery UI datepicker，但它不起作用。

我的 layout.ejs 和 index.ejs 文件的简化版本。

布局.ejs

```
<head>
<script type="text/javascript" src="../1.4.2/jquery.min.js"></script>
<script type="text/javascript" src="../1.8.11/jquery-ui.min.js"></script>
<link rel="stylesheet" href="../jquery-ui.css" type="text/css" media="all" />
</head>
<body>
      <script>
         $(function() {
            $( "#datepick" ).datepicker();
        });
     </script>
</body>
</html> 
```

索引.ejs

```
<aside class="widget">
    <p>Date: <input type="text" id="datepick"></p>
</aside> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T07:09:02.250

**工作演示** [http://jsfiddle.net/MfkAE/](http://jsfiddle.net/MfkAE/)

再次检查您的脚本源，*最好*将其更改为谷歌链接，如下所示；休息一下，您可以在具有正确源的演示中看到一切正常。

希望能帮助到你！`:)`

**脚本**

```
 <link rel="stylesheet" type="text/css" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/themes/smoothness/jquery-ui.css" media="all">

  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.min.js"></script> 
```

**代码**

```
$(document).ready(function() {
    $("#datepick").datepicker();
});​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-03T19:30:36.020

下面的代码可以在带有 nodejs/express Layout.ejs 的 EJS 模板引擎中运行

```
 <!DOCTYPE html>
    <html lang="en">
    <head>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/themes/smoothness/jquery-ui.css" media="all">
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.min.js"></script>
    <script>
    $(function() {
        $('#datepick').datepicker();
    });
    </script>

</head>  
<body>
</body>
</html> 
```

索引.ejs

```
<aside class="widget">
<p>Date: <input type="text" id="datepick"></p> 
```

# openxml - 流式传输 OpenXML 结果

> ID：11381295
> 
> 赞同：1
> 
> 时间：2012-07-08T07:02:20.467
> 
> 标签：openxml

通过使用*OpenXML*操作*Word*文档（作为模板），服务器应用程序将新内容保存为临时文件，然后将其发送给用户下载。

问题是如何使这些内容准备好下载而不将其作为临时文件保存在服务器上？是否可以将*OpenXML*结果保存为文件，`byte[]`或者`Stream`将其保存为文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T01:13:54.583

您可以创建 WordprocessingDocument，然后使用该`Save()`方法将其保存到`Stream`.

[http://msdn.microsoft.com/en-us/library/cc882497](http://msdn.microsoft.com/en-us/library/cc882497)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-09T13:16:26.790

使用此页面： [没有临时文件的 OpenXML 文件下载](https://stackoverflow.com/questions/5710290/openxml-file-download-without-temporary-file)

我将代码更改为以下代码：

```
byte[] result = null;
byte[] templateBytes = System.IO.File.ReadAllBytes(wordTemplate);
using (MemoryStream templateStream = new MemoryStream())
{
    templateStream.Write(templateBytes, 0, (int)templateBytes.Length);
    using (WordprocessingDocument doc = WordprocessingDocument.Open(templateStream, true))
    {
        MainDocumentPart mainPart = doc.MainDocumentPart;           
        ...         
        mainPart.Document.Save();
        templateStream.Position = 0;
        using (MemoryStream memoryStream = new MemoryStream())
        {
            templateStream.CopyTo(memoryStream);
            result = memoryStream.ToArray();
        }
    }
} 
```

# wxpython - 如何制作覆盖所有内容的静态位图？

> ID：11381298
> 
> 赞同：0
> 
> 时间：2012-07-08T07:02:40.570
> 
> 标签：wxpython

我需要一个 wx.StaticBitmap() ，它位于某个框架中包含的任何小部件之上。我已经尝试过使用 wx.STAY_ON_TOP 样式，但我相信它只适用于位于同一个直接容器中的那些小部件。

假设我有一个框架，框架有一个静态图像作为背景，面板位于其上，它本身包含几个其他小部件。现在我怎么能制作一个静态图像，或者任何其他可以显示图像的东西，它以主框架或背景图像为父级，但如果位于面板顶部，它总是会覆盖它。

使面板本身成为覆盖图像的父级不是一种选择

我还必须提到一个事实，即面板是在进入窗口事件之后生成的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T13:33:09.910

使用 wx.Dialog 并使用它的 ShowModal() 方法在其他所有内容之上显示您的位图。您也可以只隐藏带有其他小部件的面板并显示带有位图的面板。有这个有趣的[教程](http://www.blog.pythonlibrary.org/2010/06/16/wxpython-how-to-switch-between-panels/)关于如何做到这一点。

# asp.net-mvc - 将 MVSiteMapProvider 与 Windows Azure 一起使用

> ID：11381301
> 
> 赞同：0
> 
> 时间：2012-07-08T07:03:25.910
> 
> 标签：asp.net-mvc, azure, asp.net-mvc-sitemap

我正在使用 MVC4 RC 编写一个 .NET Azure Web 角色。为了生成站点地图，我使用 MVC SiteMap，它在 localhost 上运行良好。但是一旦部署在 Azure 上，我就会收到此错误：找不到站点地图文件。验证 Web.config 中提供的路径是否正确。

我在 web.config 中的 MVC SiteMap 配置是默认配置。文件 ~/Mvc.sitemap 位于项目的根目录

任何想法 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T18:55:25.487

如果您收到“找不到站点地图文件。验证 Web.config 中提供的路径是否正确”的错误。这意味着站点地图文件在您部署到它时不包含在您的 Windows Azure 项目中。您是否在项目中包含了 ~/Mvc.sitemap 文件？

要正确包含 ~/Mvc.sitemap，您需要将其属性设置为“内容”并将本地复制为 true，以便此文件在部署到 Windows Azure 时是 CSPKG 的一部分。

# javascript - 通过 lat 和 lng 值设置标记

> ID：11381305
> 
> 赞同：-3
> 
> 时间：2012-07-08T07:04:27.583
> 
> 标签：javascript, google-maps

我有个问题。我正在发送带有 lat 和 lng 值的 JavaScript 字符串。然后，在 JavaScript 中，我使用该`split()`方法，并获取包含此值的数组。如何绘制所有标记？此功能无法正常工作 - 未在地图上创建标记。怎么了？

```
 var lngstring = <%=lngstring %>
                var latstring = <%=latstring %>
                alert(latstring);
                alert(lngstring);
                var arraylat = latstring.split("#");
                var arraylng = lngstring.split("#");
                alert(arraylat.length) // 200
                for (var i = 0; i < arraylat.length; i++) {
                        var marker = new google.maps.Marker({
                        position: new google.maps.LatLng(arraylat[i],arraylng[i]),
                        map: map
                        });
                        //alert(arraylat[i],arraylng[i]);
                 }
                 alert("ready!");
                 alert(arraylat[2]); // 37.789879
                 alert(arraylng[2]); // -122.39044200000001 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T14:23:50.333

您需要引用`<%=lngstring %>`并将`<%=latstring %>`它们标记为`string`：

```
var lngstring = "<%=lngstring %>";   
var latstring = "<%=latstring %>"; 
```

否则你会有这样的东西：

```
var lngstring = 18.69872650000002#14.971600200000012#15.58599490000006#16.077066699999932; 
```

这是无效的javascript，浏览器无法解析它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T07:41:06.207

在您的代码中，您没有设置地图对象，可以如下设置，在添加标记之前使用它。

```
var mapOptions = {
  zoom: 12
};
var map =  new google.maps.Map(document.getElementById("map_canvas"), mapOptions); 
```

在 HTML 中

```
<div id="map_canvas"></div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T14:14:20.340

纬度和经度值必须是数字。在传递给 LatLng 构造函数的字符串上调用 parseFloat()：

改变：

```
position: new google.maps.LatLng(arraylat[i],arraylng[i]) 
```

到：

```
position: new google.maps.LatLng(parseFloat(arraylat[i]),parseFloat(arraylng[i])) 
```

# ios - NSNumber 算术

> ID：11381310
> 
> 赞同：6
> 
> 时间：2012-07-08T07:05:58.867
> 
> 标签：ios, types, nsnumber

我想对 NSNumbers 执行一些简单的算术并保留类型。这可能吗？

例如：

```
- (NSNumber *)add:(NSNumber *)firstNumber to:(NSNumber *)secondNumber; 
```

是我的方法定义，并且 firstNumber 和 secondNumber 是整数，那么我想返回一个整数，它是它们两者的整数加法。同样，如果两者都是双精度数，则将结果作为双精度数返回。

看起来我可以使用`[NSNumber objCType]`在这个问题中找到的类型（布尔值除外）：[get type of NSNumber](https://stackoverflow.com/questions/2518761/get-type-of-nsnumber)但我似乎无法提取这些类型并在没有大量代码的情况下进行计算来提取值进行计算和返回每种可能类型的结果。

有没有一种简洁的方法来做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-08T08:31:28.207

如果您想执行算术，最好的选择是使用[NSDecimalNumber](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSDecimalNumber_Class/Reference/Reference.html)。

NSDecimalNumber 具有执行算术运算的方法，例如：

```
– decimalNumberByAdding:
– decimalNumberBySubtracting:
– decimalNumberByMultiplyingBy:
– decimalNumberByDividingBy:
– decimalNumberByRaisingToPower:
– decimalNumberByMultiplyingByPowerOf10:
– decimalNumberByAdding:withBehavior:
– decimalNumberBySubtracting:withBehavior:
– decimalNumberByMultiplyingBy:withBehavior:
– decimalNumberByDividingBy:withBehavior:
– decimalNumberByRaisingToPower:withBehavior:
– decimalNumberByMultiplyingByPowerOf10:withBehavior: 
```

而且由于 NSDecimalNumber 扩展了 NSNumber，它还具有 NSNumber 的所有方法，所以我认为你可以在你的情况下使用它而没有任何问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-08T07:25:01.887

对于几乎所有应用程序，使用and转换`double`和返回都可以。这将允许您使用标准 C 符号（+、-、...）和函数（、、）。遇到麻烦的唯一方法是使用接近全精度的 64 位整数值。`-doubleValue``–initWithDouble:``exp()``sin()`

如果你想坚持使用 Objective-C 类操作，你可以使用它[`NSDecimalNumber`](http://developer.apple.com/library/ios/#DOCUMENTATION/Cocoa/Reference/Foundation/Classes/NSDecimalNumber_Class/Reference/Reference.html)。

另请参阅：[如何添加两个 NSNumber 对象？](https://stackoverflow.com/questions/494002/how-to-add-two-nsnumber-objects)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-08T07:28:34.960

如何将表达式值计算为双精度值（所有输入均为双精度值），然后检查结果是否为整数？然后你只需使用`NSNumber numberWithInt:`or`NSNumber numberWithDouble:`返回结果。

当您检查结果值是否为整数时，请务必考虑舍入误差（例如，当 1 表示为 0.99999999 等时）。

**编辑**：刚刚在 NSNumber 的文档中注意到这句话：

> 请注意，数字对象不一定保留创建它们的类型。

我认为这意味着你不能可靠地做你想做的事情。

# php - Zend 货币验证

> ID：11381314
> 
> 赞同：1
> 
> 时间：2012-07-08T07:07:09.993
> 
> 标签：php, zend-framework, zend-form, zend-validate

如何在 Zend 框架中验证货币价值？Zend 框架中是否存在默认验证器，或者我应该自己编写一个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T15:16:37.920

如果您不关心当前的语言环境，您可以使用 Regex Validator

```
$costByCompletion = new Zend_Form_Element_Text('cost');

$costByCompletion->setLabel('Cost')
         ->setRequired(true)
         ->setValue("1.00")
         ->addValidator('Regex',false, array('pattern' =>'/^\$?[0-9]+(,[0-9]{3})*(.[0-9]{2})?$/')); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T08:05:28.290

最接近的标准验证器是[Zend_Validate_Float](http://framework.zend.com/manual/en/zend.validate.set.html#zend.validate.set.float)，它将验证数字。[但是，您可能会在Zend_Currency](http://framework.zend.com/manual/en/zend.currency.html)组件中找到一些您需要的功能。至少您应该能够使用 Zend_Currency 来构建验证器。

# python - 如何结束while循环并跳过for循环？

> ID：11381315
> 
> 赞同：0
> 
> 时间：2012-07-08T07:07:31.670
> 
> 标签：python, loops

如果用户输入“否”，我怎么做，程序也不会通过 for 循环。如果用户输入“否”，我不希望它为 tmpfile.write(line)。

```
def remove():
    coname = raw_input('What company do you want to remove? ') # company name
    f = open('codilist.txt')
    tmpfile = open('codilist.tmp', 'w')
    for line in f:
        if coname.upper() in line:
            while True:
                answer = raw_input('Are you sure you want to remove ' + line.upper() + '?')
                if answer == 'yes':
                    print line.upper() + '...has been removed.'               
                elif answer == 'no':
                    break  # HERE IS WHERE I NEED HELP
                else:
                    print 'Please choose yes or no.'                   
        else:
            tmpfile.write(line)
    else:
        print 'Company name is not listed.'
    f.close()
    tmpfile.close()
    os.rename('codilist.tmp', 'codilist.txt') 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T07:12:48.487

设置一个标志变量，然后跳出 while 循环。然后在for循环中，检查flag是否被设置，然后break。

PS：如果**不是**循环

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-08T07:35:05.570

最简单的方法是创建一个获取用户输入的函数：

```
def get_yes_or_no(message):
    while True:
        user_in = raw_input(message).lower()
        if user_in in ("yes", "no"):
            return user_in 
```

并像这样修改您的原始功能：

```
def remove():
    coname = raw_input('What company do you want to remove? ') # company name
    f = open('codilist.txt')
    tmpfile = open('codilist.tmp', 'w')
    for line in f:
        if coname.upper() in line:
            answer = get_yes_or_no('Are you sure you want to remove ' + line.upper() + '?')
            #answer logic goes here              
        else:
            tmpfile.write(line)
    else:
        print 'Company name is not listed.'
    f.close()
    tmpfile.close()
    os.rename('codilist.tmp', 'codilist.txt') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-08T07:37:53.537

Python 有例外，您可以使用它来代替 GOTO 类型的构造。

```
class Breakout(Exception):
    pass

def remove():
    coname = raw_input('What company do you want to remove? ') # company name
    f = open('codilist.txt')
    tmpfile = open('codilist.tmp', 'w')
    try:
        for line in f:
            if coname.upper() in line:
                while True:
                    answer = raw_input('Are you sure you want to remove ' + line.upper() + '?')
                    if answer == 'yes':
                        print line.upper() + '...has been removed.'
                    elif answer == 'no':
                        raise Breakout()
                    else:
                        print 'Please choose yes or no.'
            else:
                tmpfile.write(line)
        else:
            print 'Company name is not listed.'
    except Breakout:
        pass

    f.close()
    tmpfile.close()
    os.rename('codilist.tmp', 'codilist.txt') 
```

请注意在中间出现异常的位置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-08T07:37:50.040

当您跳过一行时，不要使用无限循环和`break`ing，而是使用循环条件中的标志来区分三种情况（跳过、删除和无效答案）。您设置标志以在跳过情况下退出循环，在删除情况下中断，并在无效答案情况下保持标志原样。这使您可以使用 的`else`子句`while`（如果由于条件变为假而退出，则会触发该子句`while`）来检测跳过案例。从那里，您可以`for`使用跳到循环的下一次迭代`continue`（或使用跳过所有其余行`break`- 从您想要的问题中不太清楚，但不同之处在于关键字的变化）：

```
for line in f:
    if coname.upper() in line:
        answered = False
        while not answered:
            answer = raw_input('Are you sure you want to remove ' + line.upper() + '?')
            if answer == 'yes':
                print line.upper() + '...has been removed.'
                break
            elif answer == 'no':
                answered = True  # HERE IS WHERE I NEED HELP
            else:
                print 'Please choose yes or no.'
        else:
            continue
    else:
        tmpfile.write(line)
else:
    print 'Company name is not listed.' 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-08T07:29:58.177

您必须将整个`for`循环放在一个函数中并使用`return`它来摆脱它：

```
def find_and_remove(f,coname,tmpfile):
    for line in f:
        if coname.upper() in line:
            while True:
                answer = raw_input('Are you sure you want to remove ' + line.upper() + '?')
                if answer == 'yes':
                    print line.upper() + '...has been removed.'               
                elif answer == 'no':
                    return  # HERE IS WHERE I NEED HELP
                else:
                    print 'Please choose yes or no.'                   
        else:
            tmpfile.write(line)
    else:
        print 'Company name is not listed.'

def remove():
    coname = raw_input('What company do you want to remove? ') # company name
    f = open('codilist.txt')
    tmpfile = open('codilist.tmp', 'w')
    find_and_remove(f,coname,tmpfile)
    f.close()
    tmpfile.close()
    os.rename('codilist.tmp', 'codilist.txt') 
```

# java - 制作 JPanel 缩放以适应宽度但保持固定高度

> ID：11381317
> 
> 赞同：4
> 
> 时间：2012-07-08T07:07:47.443
> 
> 标签：java, swing, jpanel, jscrollpane, layout-manager

我有一个`JPanel`放在里面的`JScrollPane`. 我使用 手动绘制它`paintComponent()`，因为它被用作画布，并且我希望面板自动适应滚动窗格的宽度。然后我可以`getWidth()`在绘画代码中使用自动缩放以适应容器。但是，我希望能够手动设置首选高度，以便我利用滚动窗格的垂直滚动功能。

最好的方法是什么？如果我能够在绘画代码中获得滚动窗格的宽度，这显然仍然有效，但我不想用`getParent()`.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-08T08:03:32.063

让您的面板实现 Scrollable：getScrollableTracksViewportWidth/Height 分别控制视口如何处理水平/垂直尺寸的大小。true 值表示组件被强制为与视口相同的大小（即，在该方向上没有滚动），因此 getWidth() 可以始终用于缩放。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T07:47:33.090

我会让你的绘画代码使用自身的水平宽度作为绘画的基础。
然后设置滚动窗格，使其永远不会水平滚动，只会垂直滚动。
这够好吗？现在似乎太简单了，我已经输入了！

# php - 全局变量与配置变量

> ID：11381320
> 
> 赞同：0
> 
> 时间：2012-07-08T07:08:52.017
> 
> 标签：php, codeigniter

我在 application/config/config.php 中有自定义配置项。

我的自定义配置项示例：

```
$config['website_title'] = 'ABC Website'; //Assume website title is fixed
.
.
.
etc 
```

现在我可以在我的应用程序中调用`$this->config->item('website_title')`任何位置。但是，我觉得它不够高效，因为我可能在项目中有多个 $this->config->item('website_title') 。我想出了以下解决方案：

1.在帮助器中创建一个函数，该函数返回配置项，如下所示：

```
public function website_title() {

  return $this->config->item('website_title');

} 
```

2.现在我可以根据需要调用 website_title()。

**这是一个好的解决方案吗？你有什么缺点吗？**

> 注意：我尽量避免使用全局变量，因为我试过了，我遇到了很多不必要的问题，比如未定义的变量，很惊讶！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T07:10:22.003

我曾经问过程序员这样的问题。我得到了一个很好的答案，只需使用常量。

IE`WEBSITE_TITLE`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T15:26:53.483

“高效”是什么意思？运行时效率？编码效率？明晰？

就运行时效率而言，[Truth](https://stackoverflow.com/users/871050/truth)的使用建议可能是最简单和最好的。但是，我更喜欢使用严格的类/对象实现进行编码，实际上定义只是全局常量。

如果您对绝大多数脚本进行分析，您会发现无论您如何编写配置引用对运行时的影响都不大，因此我建议每次都尽量简单明了地编写代码。

一种方法是使用单例类（有很多关于这样做的教程）并使用魔术方法`__get()`来允许您动态重载参数访问。这是我觉得您必须使用单个类的一种情况，因为这些属性方法仅适用于对象（非静态）参数引用。因此，您可以简单地使用：

```
$cfg = Configuration::get();
...
...   $cfg->someConfigParam ...    // to refer to a config parameter
...
...   /* or even */ ... Configuration::get()->someOtherParameter ... 
```

请注意，`$cfg`在上面的示例中，本质上存储了一个对象句柄，因此这样做没有实质性的运行时成本，如果您不想，可以将此语句放在引用配置项的每个函数或类构造函数的顶部用`Configuration::get()->someOtherParameter`类型调用乱扔你的代码。

`Configuration::__get()`访问函数加上类构造函数可以处理缓存和访问单个参数的所有复杂性。这也意味着你 con 也封装了配置的来源：一些特定于应用程序的 D/B 配置表；一个或多个配置文件，...；甚至 cookie 或 URI 参数（只要您包含适当的验证）。

我个人不建议使用`__set()`魔术方法过度加载，因为 IMO，覆盖或设置配置参数应该是一个显式操作，例如`$cfg->setConfigItem( 'someValue', TRUE );`

如果您想要一些想法，[这里是我的配置类文档的链接。](http://blog.ellisons.org.uk/docs/html/Economy.html#econcxt)

# ado.net - 从存储过程中获取返回值

> ID：11381326
> 
> 赞同：-1
> 
> 时间：2012-07-08T07:09:11.217
> 
> 标签：ado.net

我写了一个程序如下：

```
ALTER PROC ReturnProc
AS
BEGIN
  RETURN 5
END 
```

我正在尝试通过以下方式从过程中获取返回值：

```
com.CommandText = "ReturnProc";
com.CommandType = CommandType.StoredProcedure;

SqlParameter parameterReturnValue = new SqlParameter();
parameterReturnValue.Direction = ParameterDirection.ReturnValue;
com.Parameters.Add(parameterReturnValue);

con.Open();
tran = con.BeginTransaction();
com.Transaction = tran;
com.ExecuteNonQuery();
tran.Commit();

//Get the return value
iReturn = Convert.ToInt64(parameterReturnValue.Value); 
```

执行后我没有得到返回值。在实际场景中，我将参数与过程连接起来，而不是将它们添加到`SqlParameter`列表中。

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T07:12:55.847

我认为您必须从 Parameters 集合中检索值。请参阅[如何在 C# 中获取存储过程返回值？](https://stackoverflow.com/questions/3123187/how-can-i-get-stored-procedure-return-value-in-c)

# c++ - C++ 未定义的引用错误

> ID：11381331
> 
> 赞同：1
> 
> 时间：2012-07-08T07:10:20.363
> 
> 标签：c++, namespaces, extern, undefined-reference

首先，一个更抽象的问题。当您不需要构造函数/析构函数或所述对象的多个副本时，就速度而言，使用命名空间而不是类是一种好习惯吗？

其次，在尝试包含和使用命名空间时，我得到“ ccEaV3B0.o:main.cc:(.text+0x10): undefined reference to `board::arbi' ”。我在 Windows 7 上使用 Mingw32，使用 make 命令：g++ -Wall main.cc board.cc

当我单独编译时也会发生这种情况，使用： g++ -c board.cc g++ -Wall main.cc board.o

以下是（最小）文件：

**主.cc：**

```
#include <iostream>
using namespace std;

#include "board.h"

int main(){
    cout << board::give() << endl;
    return 0;
} 
```

**板.h：**

```
#ifndef BOARD_H
#define BOARD_H

namespace board {
    extern int arbi;
    extern int give();
}

#endif 
```

**板.cc：**

```
#include "board.h"

int board::give(){
    return arbi;
} 
```

通过初始化“int board::arbi = 5;”来解决 在board.cc

问题仍然是当某物显然是一个对象时为什么要使用一个类，即使您知道该对象总会有一个实例。在我看来，您会想要全局变量，但为了避免名称冲突，您会将它们放在命名空间中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T07:18:12.557

你还没有定义`board::arbi`。这可能是您未定义的参考。

至于`namespace`vs `class`，它们有不同的用途。A`class`为一组实例化或派生它的对象提供一组属性。A`namespace`是一种提供具有公共前缀的符号集合的方法。它不是一个作用域（尽管命名空间解析有点像作用域），并且没有继承或派生自`namespace`.

范围有能力限制其内部名称的可见性。A`namespace`不提供任何可见性隐藏超出常规变量（例如文件静态变量）可用的内容。哪里`class`可以创建`private`或`protected`数据成员和方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-08T07:25:36.180

您需要在 board.cc 文件中定义 board::arbi 。

```
 int board::arbi = <whatever initial value>; 
```

使用 extern 声明，您只是安慰编译器稍后将提供定义，但您没有提供定义。

关于抽象问题，类和命名空间的概念有很大不同。类定义了“真实”对象的结构。即，它们占用内存。命名空间就像限制全局变量范围的栅栏。它们不占用内存......因此，如果您在程序中看到逻辑对象，请将它们定义为类。但是，如果您只看到一组以某种方式相关的全局函数，但您无法将它们想象为一个连贯的对象，请使用命名空间。

# vb6 - 无论我的表单上的什么控件是目标，我如何捕捉关键的起伏？

> ID：11381335
> 
> 赞同：4
> 
> 时间：2012-07-08T07:10:37.393
> 
> 标签：vb6, hook, keypress

我想捕获 ctrl/alt/etc 键的起伏，无论我的表单上的哪个控件获得 keyup 或 keydown 事件。由于我的表单上有大约 100 个控件，如果我要向每个单独的控件添加代码，那将是非常难看的。我怎样才能做到这一点而不必这样做？

`SetWindowsHook`PS:和有什么区别`SetWindowsHookEx`？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-08T14:28:10.933

您需要将每个 Form的**KeyPreview属性设置为****True**。随后，除了单个控件级别之外，您还可以在表单级别捕获键盘事件：

```
Private Sub Form_KeyDown(KeyCode As Integer, Shift As Integer)
    Debug.Print "Form_KeyDown"
End Sub

Private Sub Form_KeyPress(KeyAscii As Integer)
    Debug.Print "Form_KeyPress"
End Sub

Private Sub Form_KeyUp(KeyCode As Integer, Shift As Integer)
    Debug.Print "Form_KeyUp"
End Sub 
```

本质上，表单在控件之前获取每个键盘事件的“预览”，例如

```
Form_KeyDown
Control_KeyDown
Form_KeyUp
Control_KeyUp 
```

至于SetWindowsHook & SetWindowsHookEx，前者是原来的Win16 API调用，后者是Win32和Win64 API调用。据我所知，SetWindowsHook 已被弃用，并且不在当前的 MSDN 库中。

# ajax - 如何自动更新 JSP 页面

> ID：11381336
> 
> 赞同：0
> 
> 时间：2012-07-08T07:10:56.293
> 
> 标签：ajax, jsp, page-refresh

我需要自动刷新 JSP（调用数据库）中的 div。

我的数据库每秒更新一次（GPS 数据）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T11:22:01.550

您可以刷新整个页面（请参阅[使用 javascript 或 html 刷新页面](https://stackoverflow.com/questions/5294842/how-to-refresh-a-page-using-javascript)），或者更好的是，使用 Ajax 调用服务器并更新所需的 div。

# perl - 在 PERL 中将 SHA1 十六进制转换为 base64 编码（对于 Apache htpasswd）

> ID：11381337
> 
> 赞同：4
> 
> 时间：2012-07-08T07:10:56.770
> 
> 标签：perl, sha1

我有一个 PHP 应用程序，它的密码存储在数据库中作为 sha1($password) 的输出，这显然是二进制 SHA1 哈希的十六进制表示。（据我了解）

我想将其转换为与 Apache .htpassword 文件兼容的格式，它需要是 base64 编码的二进制值或 base64_encode(sha1($password, true)) 的输出。

我发现了这个线程：[Convert base64'd SHA1 hashes to Hex hashes](https://stackoverflow.com/questions/2914504/convert-base64d-sha1-hashes-to-hex-hashes) ...这与我需要做的相反，而且效果很好。我尝试更改命令的顺序并使用 hex2bin 而不是 bin2hex，但这不起作用：

致命错误：在第 1 行的 php shell 代码中调用未定义函数 hex2bin()

显然，直到 PHP 5.4 才可用，并且该服务器仍在 5.3.x [http://php.net/manual/en/function.hex2bin.php](http://php.net/manual/en/function.hex2bin.php)

这是*真正的*问题。我*实际上*需要它在 PERL 中进行转换，最好只使用*标准*的内置模块来保持一切简单。我不确定他们为什么在这一步中使用 perl，但我正在尝试编辑一个较大的应用程序的一小部分，并且不想改变整个事情:)

需要明确的是，我**并不是**想将十六进制数转换为二进制数。这是二进制值的十六进制表示，存储在 perl“字符串”中:)

在此先感谢，汤米

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-08T08:01:26.440

你解释了这么多，但仍然让我不确定你想要什么：/

如果您想要的是将十六进制字符串转换为 blob 再到 base64 字符串，这就是您在问题的开头段中所说的，

```
use MIME::Base64;
my $bin = pack "H*", $hex_str;
my $encoded = encode_base64($bin); 
```

与您想要的完全匹配： base64_encode(sha1($password, true))

忽略我以前的答案和编辑。

# xml - 标准 Muenchian 分组 - XSLT

> ID：11381339
> 
> 赞同：0
> 
> 时间：2012-07-08T07:11:05.107
> 
> 标签：xml, xslt, xml-serialization, xml-parsing

我正在开发一个 xsl，它使用 XSLT 将输入 xml 转换为其他 xml，如下所述。

逻辑：在输入的xml中，我提到了“Vehicle”中的四个子元素“vehicle_No、vehicle_Model、Description、color”。我想得到一个结果“如果“vehicle_No，vehicle_Model”与下一个“车辆”匹配，那么“描述”中的值应该成为元素，然后输出应该看起来像......，“描述”的 Muenchian 分组时"vehicle_No, vehicle_Model" 匹配，

样品 O/P：如果匹配

```
<vehicle>
     <car>
          <color>BLACK</color>
          <hood>RED</hood>
     </car>
</vehicle> 
```

如果不匹配

```
<vehicle>
     <car>
          <color>BLACK</color>
          <hood>RED</hood>
     </car>
     <cycle>
          <color>violet</color>
     </cycle>
</vehicle> 
```

如果万一我在输入 xml 中提到的“描述”和“vehicle_No,vehicle_Model”不匹配。然后 o/p 应该看起来像

```
<vehicle>
     <car>
          <color>BLACK</color>
          <hood>RED</hood>
     </car>
     <cycle>
          <color>violet</color>
     </cycle>
</vehicle>
<vehicle>
     <car>
          <color>RED</color>
     </car>
</vehicle> 
```

我的输入 XML 文件：

```
<t>
<Vehicle>
    <vehicle_No>123</vehicle_No>
    <vehicle_Model>Audi</vehicle_Model>
    <Description>car.color</Description>
    <colour>BLACK</colour>
</Vehicle>
<Vehicle>
    <vehicle_No>123</vehicle_No>
    <vehicle_Model>Audi</vehicle_Model>
    <Description>car.hood</Description>
    <colour>RED</colour>
</Vehicle>
<Vehicle>
    <vehicle_No>123</vehicle_No>
    <vehicle_Model>BMW</vehicle_Model>
    <Description>Bus.Brakes</Description>
    <colour>steel</colour>
</Vehicle>
<Vehicle>
    <vehicle_No>123</vehicle_No>
    <vehicle_Model>BMW</vehicle_Model>
    <Description>Bus.steering</Description>
    <colour>black</colour>
</Vehicle>
<Vehicle>
    <vehicle_No>234</vehicle_No>
    <vehicle_Model>benz</vehicle_Model>
    <Description>cycle.color</Description>
    <colour>violet</colour>
</Vehicle>
<Vehicle>
    <vehicle_No>345</vehicle_No>
    <vehicle_Model>nissan</vehicle_Model>
    <Description>car.color</Description>
    <colour>RED</colour>
</Vehicle>
</t> 
```

XML 中的预期输出：

```
<t>
<Vehicle>
    <car>
        <color>BLACK</color>
        <hood>RED</hood>
    </car>
    <Bus>
        <Brakes>steel</Brakes>
        <Steering>black</Steering>
    </Bus>
    <cycle>
        <color>violet</color>
    </cycle>
</Vehicle>
<vehicle>
    <car>
        <color>RED</color>
    </car>
</vehicle>
</t> 
```

如果问题不清楚，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T13:58:12.197

这个 XSLT 1.0 样式表...

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output method="xml" indent="yes"/>

<xsl:key name="vehicle-by-number" match="Vehicle" use="vehicle_No" /> 
<xsl:key name="vehicle-by-form"   match="Vehicle" use="
  concat( vehicle_No, '-', substring-before(Description,'.'))" /> 

<xsl:template match="/*">
 <xsl:copy>
  <xsl:apply-templates select="Vehicle[
   generate-id(.) = generate-id(key('vehicle-by-number',vehicle_No)[1])]"
   mode="vehicle-group" />
 </xsl:copy>
</xsl:template>

<xsl:template match="Vehicle" mode="vehicle-group">
 <xsl:copy>
   <xsl:apply-templates select="key('vehicle-by-number',vehicle_No)
    [generate-id(.) = generate-id(key('vehicle-by-form',
      concat( vehicle_No, '-', substring-before(Description,'.')))[1])]"
    mode="form-group" />
 </xsl:copy>
</xsl:template>

<xsl:template match="Vehicle" mode="form-group">
 <xsl:element name="{substring-before(Description,'.')}">
   <xsl:for-each select="key('vehicle-by-form',concat( vehicle_No, '-', substring-before(Description,'.')))">
    <xsl:element name="{substring-after(Description,'.')}">
      <xsl:value-of select="colour" /> 
    </xsl:element>   
   </xsl:for-each>   
 </xsl:element>
</xsl:template>

</xsl:stylesheet> 
```

...当应用于您的样本输入时，将产生...

```
<?xml version="1.0" encoding="utf-8"?>
<t>
  <Vehicle>
    <car>
      <color>BLACK</color>
      <hood>RED</hood>
    </car>
    <Bus>
      <Brakes>steel</Brakes>
      <steering>black</steering>
    </Bus>
  </Vehicle>
  <Vehicle>
    <cycle>
      <color>violet</color>
    </cycle>
  </Vehicle>
  <Vehicle>
    <car>
      <color>RED</color>
    </car>
  </Vehicle>
</t> 
```

虽然这与您列出的预期输出不完全匹配，但我相信差异是由于您列出的预期输出中的错误造成的。我特别指的是值为“紫罗兰色”的节点的位置。

## 解释

此样式表使用 2 个级别的 muenchian 分组。第一级足够直截了当。它将所有车辆组合在一起，在一个具有相同车辆编号的输出车辆元素下。在 muenchian 的 SO 中的大多数示例中，for-each 用于遍历组成员，而我使用了 apply-templates。这相当于同一件事。

我有第二个密钥（车辆形式），用于第二级分组。通过“形式”，我的意思是汽车、公共汽车、自行车等。这对车辆编号和形式的关键组。车辆在以表单命名的输出节点下分组。在这个内部组中，我们发出像钢一样的节点，它们是该组的成员。

# ruby-on-rails - heroku Pusher 附加组件上的“连接数”意味着多少

> ID：11381340
> 
> 赞同：3
> 
> 时间：2012-07-08T07:11:10.943
> 
> 标签：ruby-on-rails, heroku, socket.io, comet, pusher

在沙盒配置中，20 个连接意味着只有 20 个连接到一个频道的用户会收到推送通知？如果是，当更多客户端尝试连接时会发生什么？如果用户打开多个选项卡（相同的 IP），它会与连接数相加吗？

来源：[https ://addons.heroku.com/pusher](https://addons.heroku.com/pusher)

![在此处输入图像描述](../Images/fa7b1825cd2d1d7a46e6f636b3ada133.png)

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-09T11:05:28.743

以下是有关如何计算连接的常见问题解答：https: [//support.pusher.com/hc/en-us/articles/202092346-How-are-connections-counted-](https://support.pusher.com/hc/en-us/articles/202092346-How-are-connections-counted-)

对于消息： https: [//support.pusher.com/hc/en-us/articles/200842913-How-is-my-message-count-calculated-](https://support.pusher.com/hc/en-us/articles/200842913-How-is-my-message-count-calculated-)

# spring-mvc - 使用类多级 @RequestMapping url 时发现不明确的映射

> ID：11381342
> 
> 赞同：5
> 
> 时间：2012-07-08T07:11:24.267
> 
> 标签：spring-mvc

如果我在类中使用多级 url，我会收到以下异常`@RequestMapping("/api/v0.1")`：

```
java.lang.IllegalStateException: Ambiguous mapping found. Cannot map 'userController'
bean method getUsers()|to {[/api/v0.1]}: There is already 'userController' bean
method getUser(java.lang.String) mapped. 
```

就像根本没有考虑方法级别的映射一样。但是，如果我把即删除部分
也没关系。`@RequestMapping("/api")``/v0.1`

这是剥离到最小情况的配置：

```
@Controller
@RequestMapping("/api/v0.1")
public class UserController {   

    @RequestMapping(value = "/users")
    @ResponseBody
    public List<User> getUsers() {
        return null;
    }

    @RequestMapping(value = "/users/{username}")
    @ResponseBody
    public User getUser(@PathVariable String username) {
        return null;
    }
} 
```

web.xml

```
<servlet-mapping>
    <servlet-name>Spring MVC Dispatcher Servlet</servlet-name>
    <url-pattern>/</url-pattern>
</servlet-mapping> 
```

servlet-context.xml：

```
<!-- Configures the @Controller programming model -->
<mvc:annotation-driven />

<!-- Forwards requests to the "/" resource to the "welcome" view -->
<mvc:view-controller path="/" view-name="home"/>    

<!-- Handles HTTP GET requests for /assets/** by efficiently serving up static resources in the ${webappRoot}/resources/ directory -->
<mvc:resources mapping="/assets/**" location="/assets/" /> 
```

我正在使用弹簧 3.1。我还尝试将bean`alwaysUseFullPath`的属性设置为 true，`RequestMappingHandlerMapping`但并没有改变这种情况。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T12:33:41.477

非常有趣的问题 - 我检查了可能发生的事情，你说得对，“v0.1”真的抛弃了`org.springframework.util.AntPathMatcher`它，它通过结合来自控制器的路径和来自映射方法的路径来创建完整的 URI 路径。如果它在控制器中看到“file.extension”类型的模式，那么它会完全忽略该方法的路径映射——这就是你`@PathVariable`被忽略的原因。

我不确定这是否是 Spring MVC 中的错误或预期行为，临时修复将与您已经提到的一致 -

1.从Controller的RequestMapping中删除“v0.1”并使其不带扩展名`v0_1`

2.将此映射放在映射方法中：

```
@Controller
@RequestMapping("/api")
public class UserController {   

    @RequestMapping(value = "/v0.1/users")
    @ResponseBody
    public List<User> getUsers() {
        return null;
    }

    @RequestMapping(value = "/v0.1/users/{username}")
    @ResponseBody
    public User getUser(@PathVariable String username) {
        return null;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-09T20:12:19.357

您应该使用`@RequestMapping(value = "/{version:.*}/users")`来包含点 '.' 在路径变量中

# php - 使用javascript从AJAX返回打开动态链接

> ID：11381343
> 
> 赞同：0
> 
> 时间：2012-07-08T07:11:28.030
> 
> 标签：php, javascript, ajax

我正在尝试将我的查询从 PHP 转换为 Ajax。

我目前正在使用它从 PHP 返回歌曲 ID 结果。

```
<a href="javascript:songinfo(<?php echo $currentSong->ID; ?>)" title="Lyrics and song info"></a><?php echo $currentSong->title; ?> 
```

使用这个我得到这样的东西

[http://chennaichristianradio.com/PHP/web/songinfo.php?songID=5506](http://chennaichristianradio.com/PHP/web/songinfo.php?songID=5506)

如何从 Ajax 中得到相同的结果，并得到与上面相同的返回地址？最后的歌曲 ID 是从我的数据库中提取的信息。这将用于某人单击此链接以打开一个新页面，该页面显示歌曲 ID 5506 的内容。

你可以在这里看到我正在尝试使用我当前的 PHP 做的事情。只需点击“歌曲信息”按钮之一。

[http://chennaichristianradio.com/PHP/web/history.php](http://chennaichristianradio.com/PHP/web/history.php)

我尝试使用 AJAX 进行以下操作但没有成功。不要对我的代码大笑，因为我只是在学习 AJAX 和 PHP。

脚本

```
document.getElementById('ID').innerHTML =  aj_ID "<a href="songinfo.php?songID=+ aj_results[7] + >" 
```

并在 HTML

```
<a href="javascript:songinfo(<div id="id"></div>)" title="Lyrics and song info"><img src="../../images/info.png" alt="Track information" width="70" height="22" border="none" title="Song Info and Lyrics" /></a> 
```

谢谢您的帮助

编辑：这是我的 ajax 脚本

```
<?php
//Sam Broadcaster - AJAX Module - Send Artist/Title/Duration and Seconds remaining to getXMLHTTPRequest
//Written, cobbled together by wilksy101\. This code contain code sourced from the support forums and stuff written myself

    // Change to your database user name
    $username="************"; 

    //Change to your database password
    $password="************"; 

    // Change to your database name
    $database="************"; 

    // Connect to the database  
    mysql_connect('ccronline.dyndns.info',$username,$password);

    // Handle an error
    @mysql_select_db($database) or die( "Unable to select database");

        // Build Sql that returns the data needed - change this as required.    
        $sql = "SELECT songlist.*, historylist.listeners as listeners, historylist.requestID as requestID, historylist.date_played as starttime FROM historylist,songlist WHERE (historylist.songID = songlist.ID) AND (songlist.songtype='S' OR songlist.songtype='C' OR songlist.songtype='N') ORDER BY historylist.date_played DESC LIMIT 1";

        // Store results in result object
        $result = mysql_query($sql);

         //store values in vars for calculation for array creation
        $curPlay = mysql_query("SELECT * FROM historylist ORDER BY date_played DESC LIMIT 1");
        $curPlayRow = mysql_fetch_assoc($curPlay);
        if (!$curPlay) { echo( mysql_error()); }
        $dt_duration = mysql_result($result,$i,'duration');
        $title= mysql_result($result,$i,'title');
        $artist= mysql_result($result,$i,'artist');
        $album= mysql_result($result,$i,'album');
        $picture= rawurlencode(mysql_result($result,$i,'picture'));
        $lyrics= mysql_result($result,$i,'lyrics');
        $ID= mysql_result($result,$i,'ID');
        $curtime = time();
        $timeleft = $starttime+round($dt_duration/1000)-$curtime;
        $secsRemain = (round($dt_duration / 1000)-($curtime-$starttime));

        //build array to return via getXMLHTTPRequest object - you can include more vars but remeber to handle them
        //correcty in the useHttpResponse function      
        $Aj_array = $dt_duration . '|' . $secsRemain . '|' . $title . '|' . $artist .'|' . $album .'|' . $picture .'|' . $lyrics .'|' . $ID;

        //we are using the text response object  - which i think is easier for small data return
        //just echo the array                 - not so much AJAX rather AJA ??
        echo $Aj_array

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T20:33:11.010

因此，您基本上是在尝试使用 AJAX 让当前在[http://chennaichristianradio.com/PHP/web/history.php](http://chennaichristianradio.com/PHP/web/history.php)的弹出窗口中显示的内容出现在同一页面中？

我认为您在这里遇到的主要问题是您尚未在歌曲与其列表 html 元素之间建立关系。

尝试将所有“填充”div 更改为包含歌曲编号 EG：“fill5669”的 id，然后您可以使用它来确定页面中的哪个位置从您的 ajax 调用中加载内容，如下例所示：

```
功能歌曲信息（歌曲ID）{
    变量 xmlhttp;

    如果（窗口。XMLHttpRequest）{
        xmlhttp=新的 XMLHttpRequest();
    }else{// 支持旧版本的 IE。
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
    }
    xmlhttp.onreadystatechange=函数（）{
        如果（xmlhttp.readyState==4 && xmlhttp.status==200）{
                document.getElementById('fill'+songID).innerHTML=xmlhttp.responseText;
            }
    }
    xmlhttp.open("GET","http://chennaichristianradio.com/PHP/web/songinfo.php?songID="+songID,true);
    xmlhttp.send();
    返回假；
}
```

# objective-c - 随机图像的清洁屏幕

> ID：11381344
> 
> 赞同：0
> 
> 时间：2012-07-08T07:11:41.293
> 
> 标签：objective-c, image, random

这是我第一次发帖，首先你要知道两件事，我在objective-c上很菜鸟，而且英语不是我的母语，所以如果你不明白请问:)

好的，我正在为我的孩子制作一个 iPad 应用程序，所以它包含随机声音和每次点击时的随机图像。但是在点击几次后，屏幕上满是图像，所以我想知道在 X 次点击后如何“清理”屏幕。

这里有一些代码：

```
- (void)oneFingerOneTap{

int randomNumber = arc4random() % 9 + 1;
int randX = arc4random() % 768 + 1;
int randY = arc4random() % 1004 + 1;

NSString *fileName = @"Sound";
NSString *ext = @".caf";
NSString *randString = [NSString stringWithFormat:@"%d", randomNumber];
NSString *completeSound = [NSString stringWithFormat:@"/%@%@%@", fileName, randString, ext];

NSString *path = [NSString stringWithFormat:@"%@%@", [[NSBundle mainBundle] resourcePath], completeSound];

SystemSoundID soundID;
NSURL *filePath = [NSURL fileURLWithPath:path isDirectory:NO];

AudioServicesCreateSystemSoundID((__bridge CFURLRef)filePath, &soundID);

AudioServicesPlaySystemSound(soundID);

self.imgView = [[UIImageView alloc] initWithFrame:CGRectMake(randX, randY, 60, 60)];
self.imgView.image = [UIImage imageNamed:@"background.jpg"];
[self.view addSubview:self.imgView];

NSLog(@" %d", randX);

count++;
} 
```

所以我做了一个全局int（计数）来知道已经完成了多少次点击。

附言。我知道当时图像不是随机的，现在没关系。

同样，我怎样才能删除之前完成的所有图像？

我试过了，`self.imgView.hidden = TRUE;`但它只隐藏了最后一张图片。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T07:25:14.380

试试这个代码

```
 for (UIView *subVw in self.view.subviews) {
    if ([subVw isKindOfClass:[UIImageView class]]) {
        [subVw removeFromSuperview];
    }
} 
```

# bash - 如何将 bash 命令的输出作为参数传递给另一个？

> ID：11381346
> 
> 赞同：3
> 
> 时间：2012-07-08T07:11:48.913
> 
> 标签：bash

我有一个程序可以返回一个文件名列表。我需要将这些文件的内容传递给另一个程序。

我知道如何使用`cat`来传递内容：

```
cat file1 file2 file3 | some_program 
```

我想做的是：

```
list=`get_file_list`
cat ${list} | some_program 
```

尽管执行上述操作只会传递列表变量的内容，而不是文件的内容。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-08T07:25:09.763

要将一个程序的输出传递给另一个程序，您可以使用 xargs，例如

```
 find . -name "myfile*" -print | xargs grep "myword" $1 
```

这个搜索名为 myfile* 的文件并在其中查找密钥。

# xslt - 上一个节点并查看父节点是否等同于 XSLT 中的特定节点

> ID：11381352
> 
> 赞同：2
> 
> 时间：2012-07-08T07:13:24.817
> 
> 标签：xslt, xpath, xslt-1.0, xslt-2.0, xpath-2.0

我想查看我所指的当前节点的父节点是否等于特定值。我做了如下但没有用。

例如。

```
<v:name>
<v:age> 
```

当我在“年龄”时尝试过`<xsl:if test='.. = v:name'>`。但这是不正确的。正确的方法是什么？有人可以帮忙吗？

我在一个对 v:name 和 v:age 都适用的模板中。有 v:age 不是 v:name 的子级。我想确保我所指的 v:age 是 av:name 的孩子。这就是我想要的 test 属性。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-08T14:40:30.693

来自 OP 的评论：

> 我在一个模板中，这对`v:name`和都是正确的`v:age`。有些`v:age`'s 不是`v:name`. 我想确保`v:age`我指的是 a 的孩子`v:name`。这就是我在 test 属性中想要的

**使用**：

```
parent::v:name 
```

这`xsl:if`变成了：

```
<xsl:if test="parent::v:name">
  <!-- Whatever processing is necessary. -->
</xsl:if> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-08T07:41:59.187

使用`<xsl:if test="../v:name = 'somevalue'></xsl:if>`或`<xsl:if test="parent::v:name = 'somevalue'></xsl:if>`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-08T22:53:28.230

我怀疑当您说您想知道父节点是否“等于”特定值时，您的真正意思是您想知道它的名称是否等于特定值（如果您给出示例，这将立即清楚您的输入和输出）。

如果我的猜想是正确的，请使用`<xsl:if test="parent::xyz">`

# php - 使用 Session、HTTP Post 或其他方式传递变量

> ID：11381355
> 
> 赞同：-1
> 
> 时间：2012-07-08T07:13:51.543
> 
> 标签：php, html

我知道有几种方法可以将变量传递到表单的另一个页面。但是有什么安全的方法可以将变量传递到另一个页面吗？

**邮政**

```
First form in the page
$firstName= 'Sarah';
$lastName = 'Lim';
$name = $firstName.' '.$lastName;
<form id="Staff" name="Staff" method="post" action="nextpage.php" enctype="multipart/form-data">
<input name="name" type="text" id="name" value="<?php echo $name?>"/>
<input type="submit" name="submit" value="Submit">
</form>

Passing variable to nextpage.php
$StudName = $_POST['name'];
$split = preg_split('/[ \.]/', $StudName);
echo $split[0].$split[1]; 
```

在这种情况下，我必须使用 session 将变量传递给 nextpage.php。还有其他更安全或更整洁的方式吗？好像我的表单中有很多字段，我的第二页中会有很多“$_POST['...']”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T07:19:07.757

我能想到的唯一安全方法是使用 https，如果您正在寻找更简洁的代码，您可以执行类似 $p = $_POST; 之类的操作。这会让你做 echo $p['blah']; 例如。

# amazon-web-services - Amazon RDS 自动备份

> ID：11381356
> 
> 赞同：14
> 
> 时间：2012-07-08T07:13:55.413
> 
> 标签：amazon-web-services, backup, amazon-rds, database-backups

我可以从 AWS 控制台看到我的 RDS 实例每天备份一次。从常见问题解答中，我了解到它正在 S3 上进行备份。但是当我使用控制台查看我的 S3 存储桶时，我看不到 RDS 备份。

所以：

1.  如何获得我的 RDS 备份？
2.  一旦我有了它，我如何使用它来恢复我的数据库，即它是一个常规的 mysqldump 文件还是其他文件？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-08T07:40:32.853

好的 - 我在数据库快照下看到它，自动快照（如果它选择手动快照，因此看不到它）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-08-15T12:02:10.093

RDS 快照和 EBS 快照存储在 S3 中，但无法通过 S3 接口访问。您可以通过从 AWS 管理控制台单击“恢复快照”来恢复整个数据库。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-05-24T08:53:38.247

如果您想手动进行 .sql 备份，也可以使用我一直在开发的脚本：

[https://github.com/Ardakilic/backmeup](https://github.com/Ardakilic/backmeup)

此脚本将您的 SQL 数据库与您的虚拟主机根目录一起备份到您的 S3 或 Dropbox。所以这意味着，您可以从任何主机（RDS 或任何其他提供商）转储任何 SQL 并将它们上传到 S3。它使用 aws-cli 作为后端。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-03T11:02:05.933

我遇到了同样的问题，我所做的是我编写了一个简单的 bash 脚本来为我执行此操作，但我在单个区域中工作正常，它不适用于多个区域，这里是脚本[http://geekospace.com/在两个aws-ec2-instances/之间备份和恢复数据库](http://geekospace.com/back-up-and-restore-the-database-between-two-aws-ec2-instances/)

# ios - UILocalNotification 在启动或 viewdidload 时显示倒数计时器

> ID：11381359
> 
> 赞同：0
> 
> 时间：2012-07-08T07:14:25.960
> 
> 标签：ios, uilocalnotification, viewdidload, countdowntimer

我正在开发设置 UILocalNotification 的应用程序。这是我第一次使用它，我想有一些解释，以便以最好的方式有效地使用它。倒计时通知到期时间的最糟糕的方法是什么？我想向用户显示一个缺少时间的 UILabel，这个 UILabel 每秒更新一次，当我重新打开我的应用程序时，它必须显示计时器。我已经这样做了：当我重新打开我的应用程序或调用必须显示计时器的视图时，我检查是否有 UILocalNotification 与我之前设置的 userInfo 然后我减去它的 NSDate 当前时间所以我明白了，并更新了 UILabel。我知道它以秒为单位显示时间，但如果这个程序很好，我会将其转换为时间。

有没有最好的方法来做到这一点？

这是我的代码：

UILocalNotification *countDownNotificationSetted;

```
NSArray *scheduledNotificationArray = [[UIApplication sharedApplication] scheduledLocalNotifications];

for (int i = 0; i<[scheduledNotificationArray count]; i++)

    if ([[[[scheduledNotificationArray objectAtIndex:i] userInfo] objectForKey:@"ID"] isEqualToString:@"ParkNotification"]) {

        countDownNotificationSetted = [scheduledNotificationArray objectAtIndex:i];
        break;
    }

NSDate *expringDate = [countDownNotificationSetted fireDate];

NSTimeInterval timeLeftToNotification = [expringDate timeIntervalSinceNow];

if(timeLeftToNotification == 0){

    [countDownTimer invalidate];
}

datePicker.countDownDuration = timeLeftToNotification;

_countDownLabel.text = [NSString stringWithFormat:@"%.0f", timeLeftToNotification];

NSLog(@"%.0f", timeLeftToNotification); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T10:01:33.883

我认为如果您像已经这样做的那样使用计时器更新标签会更好，当您关闭应用程序时，将该时间存储在本地文件或用户默认值中，并且当应用程序再次启动时从该文件中读取时间。或者，如果您想要从第一次打开应用程序以来经过的时间，只需将时间写入`appDidFinishLaunching`并每次都从那里获取。我在这里看不到本地通知的好处。

希望这可以帮助。干杯!

# regex - 修复 URL 输入中不正确的服务器方案

> ID：11381361
> 
> 赞同：0
> 
> 时间：2012-07-08T07:14:57.530
> 
> 标签：regex, url

我正在接受来自表单的网址输入，但是某些 URL 的格式不正确，如下所示（不要问）：

```
http:/www.foo.com
ftp:/ftp.bar.com
scp:/meh.foobar.com 
```

我想要做的是检测是否只有一个正斜杠存在并添加第二个。

我从来不擅长正则表达式，所以我尝试结合 substr 和 parse_url 来挑选方案，然后剥离它。但这有点混乱，并且剥夺了有效 URL 在方案中添加三元组 /// 并在某些情况下从主机名中取出字母。

请帮忙 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T07:28:23.743

使用这个正则表达式：`'.*:/[a-zA-Z].*'`

它将匹配：

```
http:/www.foo.com
ftp:/ftp.bar.com
scp:/meh.foobar.com 
```

并且不匹配：

```
http://www.foo.com
ftp://ftp.bar.com
scp://meh.foobar.com 
```

然后使用替换替换您的无效字符（我不知道您使用的是什么语言）：

```
url = myUrl.replace(url,':/','://') 
```

# ios - 我需要将哪个远程通知证书与 Ad-hoc 一起使用

> ID：11381362
> 
> 赞同：0
> 
> 时间：2012-07-08T07:15:00.823
> 
> 标签：ios

我想知道在 Ad-hoc、开发或生产中需要使用哪种远程通知 (APN) 证书？

我原以为我需要使用生产版本，但令人惊讶的是它可以与开发一起使用。

现在，这个问题是我将如何确保我是否正确生成了生产 APN 证书，如果除了应用程序上线之外没有办法进行测试。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T09:01:23.290

来自 Apple 的文档

> “通过 ad-hoc 分发的应用程序使用苹果生产推送网关 (gateway.push.apple.com)，而不是苹果开发推送网关”

对于临时构建，使用 SSL 证书进行生产而不是开发。

# java - 如何向使用该程序的人隐藏 MySQL 数据库的密码

> ID：11381366
> 
> 赞同：5
> 
> 时间：2012-07-08T07:16:05.333
> 
> 标签：java, mysql, sql, sql-server, jdbc

我用 JDBC 创建了一个 java 程序，它成功地连接到我的计算机服务器的 MySQL 数据库，如下所示：

```
 try
    {
        // The newInstance() call is a work around for some
        // broken Java implementations

        Class.forName("com.mysql.jdbc.Driver").newInstance();
    }
    catch (Exception ex)
    {
        // handle the error
    }

    try
    {
        conn = DriverManager.getConnection(("jdbc:mysql://191.168.1.15:3306/databasename"), "username", "password");

        // Do something with the Connection
    }
    catch (SQLException ex)
    {
        // handle any errors
        System.out.println("SQLException: " + ex.getMessage());
        System.out.println("SQLState: " + ex.getSQLState());
        System.out.println("VendorError: " + ex.getErrorCode());
    } 
```

但是，如果有人想找出密码，使用任何 java 反编译器都会非常简单。就此而言，我如何能够阻止他们找到密码或用户名？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-08T07:19:26.557

当您让您的用户直接访问您的数据库时，您必须记住*您已经让他们直接访问您的数据库*。你无法改变这一点。再多的加密或混淆都无法消除他们对您数据库的访问权限。

所以你需要考虑，你*真的*希望他们能够访问你的数据库吗？

*   如果您确实想授予数据库访问权限，请确保正确设置了权限。例如，如果他们只需要读取权限，请确保您授予他们的用户只有读取权限。

*   如果您实际上不希望他们直接访问数据库，但希望他们能够访问*数据* ，那么根本不要将数据库密码放入您的程序*中*。例如，您可能希望在数据库前面设置一个 Web 服务并让您的用户查询该 Web 服务。Web 服务将具有数据库密码，但您的用户没有。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T07:23:43.300

你没有。这就是为什么静态密码不好的原因。

通常，您在企业环境中所做的是使用外部身份验证方法（例如，LDAP、Active Directory）对数据库进行身份验证，然后使用您确定用户所需访问级别的组。

MySQL 确实支持[外部身份验证方法](http://dev.mysql.com/doc/refman/5.6/en/pluggable-authentication.html)。MS SQL Server 也是如此。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T07:19:36.163

将 jdbc 字符串移动到与编译的类和/或 jar 文件分开的配置文件中。这样，如果您分发代码，那么他们也需要您的配置文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-08T07:20:59.713

这取决于您的应用程序。如果您想隐藏这些信息，您可以构建一个 Web 服务或 Web 应用程序。这些数据是安全的。否则，您通常不希望他们访问您的数据库，他们应该配置自己的数据库。

否则，您授予他们访问您的数据库的权限，并且该用户应该具有其所需的相应权限，并且您应该检查数据库中的每个操作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-08T07:32:44.707

我建议使用代理，在查询后返回 json 或 xml。这样，您可以从服务器端构建安全性，设置蜜罐陷阱，为查询构建自己的编码器解码器，通过 https 发送内容以阻止侦听器。

您还可以尝试将用户名和密码存储在字符串中并将它们作为变量传递。然后构建一个由相似事物组成的复杂矩阵，并用它做看似复杂的事情，以削弱黑客，让他在尝试找到您的代码两小时后失去兴趣。

您还可以考虑将密码放入本机库 dll 或 .so 中，具体取决于您的平台...

问题仍然存在，黑客只需要实现你的一段代码并且他拥有完整的访问权限，所以我强烈推荐代理。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-08T07:29:51.663

唯一的方法是使用加密密码并将其存储在单独的文件中。要反编译它，请使用 webservice。

或者更好的方法，如果你不想让用户知道你的代码，通过webservice创建完整的应用程序，这样客户端就可以访问外部api，你不需要把你的业务逻辑jar放在客户端机器上。我认为这是实现此案的最佳方法。

# jquery - 需要 html5 和 jQuery submit()

> ID：11381369
> 
> 赞同：39
> 
> 时间：2012-07-08T07:17:01.640
> 
> 标签：jquery, html

我正在尝试将 html5 实现到表单中，但是当我通过 jquery 提交表单并尝试使用 html5“必需”属性时遇到了问题。

这是我的表格，很简单：

```
<form action="index.php" id="loginform">
      <input name="username" required placeholder="username" type="text">    
      <a href="javascript:$('#loginform').submit();">Login</a>
</form> 
```

问题是当表单通过 jquery 提交时，它只是绕过了所需的属性。我知道 required 应该只在表单由用户而不是脚本提交的情况下才有效，因此当我将锚点更改为提交输入时，它可以完美运行。

我的观点是，是否有办法强制 jquery .submit() 使用 html5 所需的属性。

提前感谢您的答案

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2013-02-28T08:20:00.803

我做了以下

```
<form>
    ...
    <button type="submit" class="hide"></button>
</form>

<script>
    ...
    $(...).find('[type="submit"]').trigger('click');
    ...
</script> 
```

有用！

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2012-07-08T10:12:30.703

你可以

*   `click`提交时触发事件
*   手动检查验证`$("form")[0].checkValidity()`
*   使用手动查找无效元素`$("form :invalid")`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-08T07:34:45.800

你说的对。HTML5 验证仅在用户触发提交时有效。就是这样。:(

您需要在提交时编写自己的自定义方法。或者有一个很好的插件，您可以使用它根据 html5 属性验证字段。

[这是插件链接](http://ericleads.com/h5validate/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-03-10T19:17:21.913

我有完全相同的问题。我有一个按钮，我故意将其设置为不提交，因为它在第一次单击时会显示表单。第二次点击同一个按钮 $('form[name=xxx]').submit(); 正在触发，我还发现 HTML5 验证不起作用。

我的诀窍是添加一行代码，以便在我第一次单击此按钮后，我将其类型更改为动态提交。

```
$("#btn").attr("type","submit"); 
```

这就像一个魅力！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-04-16T13:21:04.813

[来自https://stackoverflow.com/a/30124479/7915308](https://stackoverflow.com/a/30124479/7915308)的回答

```
<!DOCTYPE html>
<html>
<body>

<form name="testform" action="action_page.php">
E-mail: <input type="email" name="email" required><br/>
<a href="#" onclick="javascript:console.log(document.testform.reportValidity());return false;">Report validity</a><br/>
<a href="#" onclick="javascript:console.log(document.testform.checkValidity());return false;">Check validity</a><br/>
<a href="#" onclick="javascript:if(document.testform.reportValidity()){document.testform.submit();}return false;">Submit</a>
</form>

</body>
</html>
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-02-12T05:34:32.343

这是我个人解决方案的一个例子：

```
var form = $('#loginform');

// Trigger HTML5 validity.
var reportValidity = form[0].reportValidity();

// Then submit if form is OK.
if(reportValidity){
    form.submit();
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-08T10:16:45.927

以下是一些示例，如何验证 html5：

```
function validateForm(form) {
  if (form.username.value=='') {
    alert('Username missing');
    return false;
  }
  return true;
} 
```

```
<form action="index.php" name="loginform" method="post" onsubmit="if (!validateForm(this)) event.preventDefault();">
  <input name="username" placeholder="username" required="required" type="text" />
  <a href="" onclick="event.preventDefault(); $(document.forms.loginform).submit();">Login1</a>
  <a style="cursor:pointer;" onclick="$(document.forms.loginform).submit();">Login2</a>
  <input name="send" type="submit" value="Login3" />
  <input name="send" type="button" value="Login4" onclick="$(document.forms.loginform).submit();" />
</form> 
```

完整代码[在这里](http://pastebin.com/4EuVaviR)。这里有一件事很奇怪： $(document.forms.loginform).submit(); 工作正常，但 document.forms.loginform.submit(); 失败。有人可以解释为什么吗？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-07-08T07:23:11.787

您可以改为调用一个函数并使用该函数来检查是否所有具有所需属性的节点都有一个值。

有一些插件可以做到这一点： http: [//thechangelog.com/post/1536000767/h5validate-html5-form-validation-for-jquery](http://thechangelog.com/post/1536000767/h5validate-html5-form-validation-for-jquery)

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2012-07-08T07:34:33.273

**工作演示** [http://jsfiddle.net/3gFmC/](http://jsfiddle.net/3gFmC/)

希望这会有所帮助`:)`

**代码**

```
$('#btn_submit').bind('click', function() {

        $('input:text[required]').parent().show();
        // do whatever;
 }); 
```

​</p>

# c# - 我在客户端上的应用程序如何与服务器上的数据库通信

> ID：11381373
> 
> 赞同：1
> 
> 时间：2012-07-08T07:17:42.450
> 
> 标签：c#, .net, sql-server

我正在使用 c#.net 开发 Windows 窗体应用程序。我开发了一个使用 sql 数据库作为后端的应用程序（3 层）。我需要在服务器和我的应用程序上部署数据库。在客户端机器上。但是我的应用程序如何与服务器上的数据库通信。请指导我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T07:29:04.753

您需要一个在开发过程中可以正常工作的连接字符串。在您的开发机器上，如果应用程序可以很好地连接到数据库服务器，那么在您的客户端机器上，它也可以正常工作。有时，您使用的凭据会出现问题，该凭据可能在开发计算机上有效，但在客户端上由于缺乏访问权限而无法连接。因此您需要确保提供正确的凭据以连接到 SQL 服务器

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T07:23:09.610

你不需要为此做任何火箭科学。您需要做的就是在客户端使用可以连接到远程安装的 SQL Server 的正确连接字符串。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-10T04:01:10.613

使用 EntityFramework 为您的 sql server 连接进行更新、插入和删除。将存储过程用于插入/更新/删除功能。

# actionscript-3 - AS3 未定义属性的 case 语句值访问

> ID：11381381
> 
> 赞同：0
> 
> 时间：2012-07-08T07:19:07.583
> 
> 标签：actionscript-3

我有一门课，可以从一个集中的位置控制我的所有按钮。这些按钮在加载时被推入一个数组，并且 for 循环将 MouseEvent.CLICK 事件侦听器添加到数组中的所有按钮。

现在我的问题来自与此事件侦听器相关的函数。我创建了一个 switch 语句

```
function btnclick(e:MouseEvent):void
    {
        switch (e.currentTarget)
        {
            case Profile_btn_63 :
                removearrayreference(this);
                e.currentTarget.parent.gotoAndStop("profile");
                break;

        }
    } 
```

但问题是当我测试游戏时它指出 Profile_btn_63 未定义。这实际上在一开始（第一帧）是正确的，因为按钮尚未添加到按钮数组中，也没有在其上放置事件侦听器。因此，为了达到这一点，我需要帮助让 flash 忽略 Profile_btn_63 是未定义的，直到它最终被定义。

最后，这可能有点跑题了，但有谁知道为什么 _63 在 Profile_btn 被推入我的按钮数组时被添加到它的末尾？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T07:45:51.733

如果您将有一个“神奇的 switch 语句”来完成程序中的所有事情——这在不止一个方面是一个可怕的想法，但那是另一回事——那么你应该`case`根据实例名称做出决定：`switch( e.currentTarget.name )`

虽然按钮实例可能是`null`or `undefined`，但常量 String 绝不是。

# spring - 应该调用 HandlerInterceptorAdaptor 什么？

> ID：11381384
> 
> 赞同：0
> 
> 时间：2012-07-08T07:19:13.713
> 
> 标签：spring, design-patterns, naming-conventions, naming

在 Spring MVC 中，可以定义拦截器，这些拦截器可以在调用特定控制器之前和之后执行工作。例如，这可以用于进行日志记录、身份验证等。

希望编写自定义拦截器的程序员应该实现[HandlerInterceptor](https://github.com/SpringSource/spring-framework/blob/3.2.0.M1/spring-webmvc/src/main/java/org/springframework/web/servlet/HandlerInterceptor.java)接口。为了帮助完成这项任务，提供了[HandlerInterceptorAdaptor](https://github.com/SpringSource/spring-framework/blob/3.2.0.M1/spring-webmvc/src/main/java/org/springframework/web/servlet/handler/HandlerInterceptorAdapter.java)抽象基类，它提供接口中指定的所有方法的默认实现。所以，如果只是想做一些预处理，可以`extend HandlerInterceptorAdaptor`和`@Override public boolean preHandle(...)`，而不用担心实现`postHandle`功能。

我的疑问与名称有关。根据我对适配器模式的理解，它适应接口之间的句法阻抗不匹配。

1.  是这样吗？如果是，那么提供样板实现的类是否应该称为 HandlerInterceptorDefaultImpl，或者类似的名称？

2.  这里发生的事情是否有不同的命名法/模式？

3.  我们需要样板类的事实是否是代码异味，并且可以通过将 HandlerInterceptor 接口重构为两个：HandlerPreInterceptor 和 HandlerPostInterceptor 来消除？还是那是矫枉过正？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T08:07:16.957

来自 GOF 关于适配器模式的书：

*适配器为使 Adaptee 适应目标接口所做的工作量各不相同。有一系列可能的工作，从简单的接口转换（例如，更改操作的名称）到支持完全不同的操作集。Adapter 所做的工作量取决于 Target 接口与 Adaptee 的相似程度。*

您所指的样板类称为骨架实现类。Joshua Bloch 在 Effective Java 中提到了这一点。从书中：

*您可以通过提供一个抽象骨架实现类与您导出的每个重要接口一起使用，从而结合接口和抽象类的优点。接口仍然定义了类型，但是骨架实现完成了实现它的所有工作。*

*按照惯例，骨架实现称为 AbstractInterface，其中 Interface 是它们实现的接口的名称。例如，Collections Framework 提供了一个与每个主要集合接口一起使用的框架实现：AbstractCollection、AbstractSet、AbstractList 和 AbstractMap。可以说，将它们称为 SkeletalCollection、SkeletalSet、SkeletalList 和 SkeletalMap 是有道理的，但抽象约定现在已经牢固确立。*

# coffeescript - IcedCoffeeScript 或 jQuery 延迟

> ID：11381393
> 
> 赞同：14
> 
> 时间：2012-07-08T07:20:46.410
> 
> 标签：coffeescript, jquery-deferred, iced-coffeescript

最近在处理 Backbone.JS/jQuery/CoffeeScript 项目时，我发现自己陷入了一堆回调和时间问题。在继续之前，我需要等待某些事情完成，然后发现自己陷入了一堆嵌套的回调中……这令人困惑且难以调试。然后我找到了 2 个可能的解决方案[jQuery deferred](http://api.jquery.com/category/deferred-object/)或[IcedCoffeeScript](http://maxtaco.github.com/coffee-script/)

`IcedCoffeeScript`看起来很简单，只需添加`await`& `defer`。但是，我想知道它是否会留下来？StackOverflow 上只有 2 个问题？与 CoffeeScript 相比，没有太多谈论它

另一件事是这两种方法之间有什么区别，它们似乎做的大部分事情都是一样的？除了在 IcedCoffeeScript 中，它看起来更像程序代码，而在 jQuery deferred 中，它并没有解决我的回调问题

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-07-08T14:55:30.220

这些是非常不同的技术：

*   **IcedCoffeeScript**是一个预编译器，它使用`await`和`defer`关键字扩展 CoffeeScript，为您转换代码，以便您可以以同步风格编写代码。在生成的 JavaScript 中，`await`生成`defer`嵌套函数。

*   **jQuery Deferred**（又名**Promises**）是一种完全回避回调的方式：异步函数可以返回 Promise，而不是回调。然后将回调附加到 Promise。这是一种简单但功能强大的技术。我在我的书*[Async JavaScript](http://leanpub.com/asyncjs)*中专门用了一章来介绍它。

这些技术中的每一种都最适用于某种 API。`await`并`defer`期望一个函数将单个回调作为其最后一个参数。当您的应用程序中有许多其他 Promise 时，Promise 效果最好。

处理 JavaScript 中的异步行为没有灵丹妙药。您需要了解回调、Promises 和 PubSub (aka `EventEmitter`s)，并为每项工作选择最佳工具。即使您使用 IcedCoffeeScript（这很酷），Promise 仍然会为您节省大量工作。

我希望这会有所帮助。查看我的书*[Async JavaScript](http://leanpub.com/asyncjs)*了解更多信息。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-01-15T15:58:22.283

我认为**IcedCoffeeScript**将继续存在。

我计划无限期地支持它，并且经常针对主线修补它。我几乎在我所有的个人项目中都使用它，并且网站 Combosaurus.com，一个即将发布的*OkCupid Labs*项目，是用*IcedCoffeeScript 编写的。*

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-02T09:05:43.557

我写了一篇关于标准事件回调、pub sub 和 deferreds 之间差异的博客文章，这可能会对您有所帮助：

[Event Emitter、Pub Sub 或 Deferred Promises……你应该选择哪一个？](http://otaqui.com/blog/1374/event-emitter-pub-sub-or-deferred-promises-which-should-you-choose/)

简介如下：

> 对于“你应该选择事件发射器、发布订阅还是延迟/承诺”这个问题的明显答案是，这取决于你在做什么。
> 
> 在这篇文章中，我将探讨一下每种模式如何与（非常）基本的实现一起工作，然后我会看看为什么你可能会选择一种模式而不是另一种模式。

总结是：

> Event Emitter 是一个真正的经典，它允许良好的实践和对发生的事情的控制；Pub Sub 对于跨组件事件更灵活；Deferred 和 Promises 提供了一种处理回调的强大方法。

将摘要应用于您的问题 - 我建议 Deferred's 和 Promises 可能会对您有很大帮助。

我不了解你，但我发现了解如何实现 Deferred 确实帮助我理解了使用它的复杂性。我在帖子中也包含了一些示例代码，它们（非常）简单，在查看其他人更强大的尝试时可能会帮助您。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-09-30T14:20:23.700

哦，我肯定会依赖 IcedCoffeeScript。如果你喜欢并使用 CoffeeScript 语法，你会发现它只是自然地“融合”了它......

关于项目的未来，我前段时间也遇到了同样的困境，但看起来 Maxwell Krohn 正在积极维护它，并且围绕它的社区和意识也在不断增长（好吧，也许还没有在 stackoverflow 上）。

我去年开始使用它，现在我真的无法想象没有`await`and的情况下编写“现实生活”应用程序`defer`。

[您可以在此处](https://coderwall.com/p/lmbzpg)找到有关使用 ICS 的优雅异步控制流的简短“提示” ，我还写了一篇由 5 部分组成的[具有讽刺意味的文章，关于在此处](https://coderwall.com/p/diokxg)提到 ICS 使用 Node.js 进行通用 Web 项目。

# c# - 小摩？使用 if exists drop then create 和 no sp_executesql 编写所有 SQL 存储过程的脚本

> ID：11381397
> 
> 赞同：3
> 
> 时间：2012-07-08T07:21:33.260
> 
> 标签：c#, .net, sql, stored-procedures, smo

我有一个看似简单的要求。我需要按照这个标准编写数据库中的所有存储过程。

1.  如果 proc 存在，则脚本需要包括删除，如下所示...

    ```
    IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[myproc]') AND type in (N'P', N'PC')) 
    ```

2.  该脚本不能有 sp_executesql 所以没有这样的......

    ```
    EXEC dbo.sp_executesql @statement = '....' 
    ```

3.  我需要为每个存储过程创建一个单独的脚本文件。所以它将是 [存储过程名称].sql

我注意到当我尝试内置的 sql 生成脚本时，我可以通过用于在单独文件中编写对象的复选框将 procs 放在一个单独的文件中，并且我还可以获得 if exists 删除。但是，它使用了他们不想要的 sp_executesql。

所以我花了一些时间尝试 SMO 并发现了类似的问题......

A. 遗憾的是，以下仅编写 drop 语句的脚本。我看不到将它与创建结合起来。所以我可以获得单独的文件并且没有 sp_executesql 但我仍然缺少上面的#1

```
 Scripter scripter = new Scripter();
    scripter.Options.ScriptDrops = true; 
```

B. 其次，以下选项将输出更改为使用 sp_executesql

```
 scripter.Options.IncludeIfNotExists = true; 
```

C. 最后，我可以手动添加文本。它已成功设置在 TextHeader 中。但是，scripter.Script() 抛出异常“{”StoredProcedure 'dbo.myproc' 的脚本失败。"}

```
 storedProcedure.TextHeader = string.Format("IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'{0}') AND type in (N'P', N'PC')) \r\nDROP PROCEDURE {0} \r\nGO\r\n{1}", storedProcedure.Name, storedProcedure.TextHeader);
    scripter.Options.FileName = Path.Combine(storedProceduresPath, storedProcedure.Name + ".sql");
    scripter.Script(new Urn[] { storedProcedure.Urn });  //Exception! - Script failed for StoredProcedure 
```

我无法想象这是一件多么奇怪的事情，所以我想知道人们是如何做到这一点的？？？如果需要使用 sql - 任务 - 生成脚本创建单独的文件，然后使用应用程序清除不需要的“EXEC dbo.sp_executesql @statement = N'”，这很遗憾

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T10:20:58.510

以下代码示例在 PowerShell 中，但使用 SMO，因此您可以轻松地将其转换为 c#。

Scripter 感觉有点慢，所以我使用了一种稍微不正统的方法，但这对我来说已经工作了数百次。

`$sp`是你的数据库中的一个存储过程，只是foreaching所有的SP：

```
foreach($sp in $db.StoredProcedures) 
```

### 脚本删除：只需使用 String.Format :)

```
$sbHead.AppendLine( [string]::Format(@"
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[{0}].[{1}]') AND type in (N'P', N'PC'))
GO
"@, $sp.Schema, $sp.Name)) 
```

### 脚本正文

```
$sbBody.AppendLine( [string]::Format(@"
print 'creating "{1}"...'
--   *  *  *  *  #{0}:{1}; CreateDate:{2}, DateLastModified:{3}   *  *  *  *
GO
{4}
{5}
GO
"@, $cnt, $sp.Name, $sp.CreateDate, $sp.DateLastModified, $sp.TextHeader, $sp.TextBody)) 
```

这会打印出一些额外的信息：

*   `print 'creating "{1}"...'`把它放在那里，因为有一次创作只是挂了几分钟。知道当前的 SP 名称会导致我们找到问题的根源：与链接服务器的连接已断开......
*   SP 创建和最后修改日期，但这并不是真正需要的。

此方法不考虑脚本依赖性，因此您将在控制台中收到一条警告消息，例如“当前的 SP xy 依赖于 SP dsa，但无论如何都要创建它”。但是由于没有解决这些依赖关系，所以运行得更快。一直为我工作...

上传了完整的脚本，以及一个示例输出到 GitHub：[SqlScriptExport.ps1](https://gist.github.com/3073102)

这个做了一些额外的事情：

*   仅脚本以给定前缀开头的 SP（或全部，如果前缀为空）
*   脚本视图也是如此，对前缀进行相同的过滤。

# c# - OpenXML SDK - 将 excel 分页符设置为一定数量的列

> ID：11381398
> 
> 赞同：3
> 
> 时间：2012-07-08T07:22:12.077
> 
> 标签：c#, excel-2007, openxml-sdk

有谁知道如何使用 C# 和 OpenXML SDK 设置 excel 分页符以包含一定数量的列？我想要做的是让 x 列出现在一页上。我原本以为设置打印区域会这样做，但事实并非如此。我找不到任何参考来做到这一点。

这是在 Excel 电子表格的“分页视图”中手动完成的，您可以在其中拖动垂直虚线以包含更多列。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T18:43:58.463

OpenXML SDK 区分手动水平分页符和手动垂直分页符。

*   手动水平分页符允许您在给定行 ID（索引）之上指定一个分页符。
*   垂直分页符允许您在指定列 ID（索引）的左侧指定一个分页符。

要以编程方式插入水平分页符，请使用`RowBreaks`and`Break`类。该类`RowBreaks`表示工作表中所有水平分页符的集合。

`ColumnBreaks`and类`Break`允许您插入垂直分页符。该类 `ColumnBreaks`包含工作表的所有垂直分页符。

以下示例演示了垂直分页符的插入。该函数`InsertVerticalPageBreak()`采用 columnIndex（应在其中插入分页符）和 WorksheetPart。此函数首先检查工作表是否已包含 `ColumnBreaks`集合。如果没有，将创建一个。然后该函数创建`Break`该类的一个实例并将该`Id`属性设置为列索引。我还将该`Max`属性设置为 Excel 能够处理的最大行数，以获得连续的垂直分页符。通过将属性设置`ManualPageBreak`为`true`我们指定手动分页符。

我还在`InsertHorizontalPageBreak()`示例中添加了一个函数来展示如何添加水平分页符。

```
private void InsertPageBreaks()
{
  uint columnIndex = 17U;
  uint rowIndex = 51U;

  using (SpreadsheetDocument sd = SpreadsheetDocument.Open("c:\\temp\\spreadsheet.xlsx", true))
  {
    WorkbookPart workbookPart = sd.WorkbookPart;
    WorksheetPart worksheetPart = workbookPart.WorksheetParts.Last();

    // Uncomment the following line to insert row page breaks.
    // InsertHorizontalPageBreak(rowIndex, worksheetPart);
    InsertColumnVerticalBreak(columnIndex, worksheetPart);       
  }
}

private void InsertHorizontalPageBreak(uint rowIndex, WorksheetPart worksheetPart)
{
  Break rowBreak =
      new Break() { Id = (UInt32Value)rowIndex, Max = (UInt32Value)16383U, ManualPageBreak = true };

  RowBreaks rb = worksheetPart.Worksheet.GetFirstChild<RowBreaks>();

  if (rb == null)
  {
    rb = new RowBreaks();
    rb.ManualBreakCount = (UInt32Value)0;
    rb.Count = (UInt32Value)0;

    worksheetPart.Worksheet.Append(rb);
  }

  rb.Append(rowBreak);
  rb.ManualBreakCount++;
  rb.Count++;
}

private void InsertVerticalPageBreak(uint columnIndex, WorksheetPart worksheetPart)
{
  ColumnBreaks cb = worksheetPart.Worksheet.GetFirstChild<ColumnBreaks>();

  if (cb == null)
  {
    cb = new ColumnBreaks();

    cb.ManualBreakCount = (UInt32Value)0;
    cb.Count = (UInt32Value)0;    

    worksheetPart.Worksheet.Append(cb);
  }

  Break br = 
    new Break() { Id = (UInt32Value)columnIndex, Max = (UInt32Value)1048575U, ManualPageBreak = true };

  cb.Append(br);

  cb.ManualBreakCount++;
  cb.Count++;
} 
```

# asp.net-mvc-3 - 在 MVC3 RAZOR 视图引擎中显示异常消息

> ID：11381400
> 
> 赞同：1
> 
> 时间：2012-07-08T07:22:17.237
> 
> 标签：asp.net-mvc-3

我有一个模型喜欢：

```
public class Post
    {
        public int PostId { get; set; }
        public int ParentId { get; set; }
        public string PostTitle { get; set; }
        public IEnumerable<Post> ChildPosts { get; set; }
    } 
```

我的控制器中还有一个添加操作，它将上面的模型返回到 add.cshtml 视图。现在来点我的应用程序运行模式我得到一个异常（如数据库连接异常）。现在我想在 add.cshtml 页面中显示我的异常消息。

可能吗？如果是。我怎样才能完成这项工作。请用示例代码解释。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-08T07:24:58.047

如果要在同一视图上显示错误消息：

```
[HttpPost]
public ActionResult Add(Post post)
{
    try
    {
        // do your database stuff ...
        return RedirectToAction("Success");
    }
    catch (SomeExceptionouNeedToHandle ex)
    {
        ModelState.AddModelError("", ex);
        return View(post);
    }
} 
```

在您的`Add.cshtml`视图中，您可以使用`ValidationSummary`帮助器来显示错误消息：

```
@Html.ValidationSummary() 
```

另一种可能性是有一个通用错误页面，当发生一些意外异常时将显示该页面。通常你应该只捕获你想要处理的异常。在控制器操作中捕获一般异常是不好的做法。

这是异常处理的[示例](https://stackoverflow.com/a/5229581/29407)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T07:28:24.980

我建议您使用 Elmah 异常处理，您可以查看我给您的这两个链接。

[链接 1](https://stackoverflow.com/questions/7885744/elmah-ignores-exceptions-in-mvc-3-site)

[链接2](https://stackoverflow.com/questions/7885744/elmah-ignores-exceptions-in-mvc-3-site)

# python - 设置 Gtk3 MenuItem 的悬停背景颜色

> ID：11381401
> 
> 赞同：5
> 
> 时间：2012-07-08T07:22:19.517
> 
> 标签：python, css, gtk3

我有一个带有弹出菜单的托盘图标。我正在尝试在此弹出窗口中设置菜单项的背景颜色。我可以设置文本颜色，但不能设置菜单项的背景颜色。

![在此处输入图像描述](../Images/64f6355c15834bf1abf2c533115d2f5e.png)

出现的背景是默认的 Ubuntu 橙色，我无法覆盖它。

我创建了一个示例应用程序来演示这个问题。只需将其复制粘贴到 .py 文件中即可运行。

```
from gi.repository import Gtk, Gdk
import sys

class TrayIcon:

    def __init__(self):
        self.statusicon = Gtk.StatusIcon()
        self.statusicon.set_from_stock(Gtk.STOCK_MEDIA_PLAY)
        self.statusicon.connect("popup-menu", self.OnShowPopupMenu)
        window = Gtk.Window()

    def OnShowPopupMenu(self, icon, button, time):
       menu = Gtk.Menu()
       first = self.GetMenuItem("First")
       second = self.GetMenuItem("Second")
       menu.append(first)
       menu.append(second)
       menu.show_all()
       menu.popup(None, None, lambda w,x: self.statusicon.position_menu(menu, self.statusicon), self.statusicon, 3, time)

    def GetMenuItem(self, txt):
    menuItem = Gtk.MenuItem(txt)

    screen = Gdk.Screen.get_default()
    css_provider = Gtk.CssProvider()
    #css_provider.load_from_data("GtkWidget { color:white; background-color: green; } GtkWidget:hover,GtkWidget:selected { color:white; background-color:pink;}")
    css_provider.load_from_data("GtkMenuItem { color:#0f0; background-color: #f00; } GtkMenuItem:hover,GtkMenuItem:selected { color:#00f; background-color:#f00; font-weight:bold;}")
    context = Gtk.StyleContext()
    context.add_provider_for_screen(screen, css_provider, Gtk.STYLE_PROVIDER_PRIORITY_APPLICATION)

    menuItem.connect("button_press_event", self.exit)

    return menuItem

    def exit(self, a,b):
    sys.exit()

TrayIcon()
Gtk.main() 
```

对于 GtkMenuItem，普通背景和 :hover 背景被忽略。对于 GtkWidget :hover 背景被忽略。我的目标是在不禁用菜单项的情况下防止 Ubuntu 橙色出现。

**有没有办法设置 GtkMenuItem 的背景和悬停/鼠标悬停颜色？（不使用'import gtk'）**

我使用的是 Ubuntu 12.04，默认主题。

**Edit1**：为了增加一点清晰度，这就是我想要做的，但没有'import gtk'。

```
 #Prevent background color when mouse hovers
    style = menuItem.get_style().copy()
    style.bg[gtk.STATE_SELECTED] = style.bg[gtk.STATE_NORMAL]
    menuItem.set_style(style) 
```

**Edit2**：我也尝试过 override_background_color() 和 modify_bg，再次，橙色仍然出现在悬停时。以下是我尝试过的变体。

```
 menuItem.override_background_color(Gtk.StateFlags.NORMAL,Gdk.RGBA(1.0,0.0,0.0,1))
    menuItem.modify_bg(Gtk.StateFlags.NORMAL,Gdk.color_parse("red"))
    menuItem.override_background_color(Gtk.StateFlags.NORMAL, Gdk.RGBA(1.0, 1.0, 1.0, 1.0))
    menuItem.override_background_color(Gtk.StateFlags.SELECTED, Gdk.RGBA(1.0, 1.0, 1.0, 1.0))
    menuItem.override_background_color(Gtk.StateFlags.FOCUSED, Gdk.RGBA(1.0, 1.0, 1.0, 1.0)) 
```

**Edit3**：已提供答案，请参阅[此帖子](https://stackoverflow.com/a/11491392/974369)。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-15T11:13:35.640

经过大量挖掘，答案变得有些晦涩难懂。

*   `background-color`不起作用。我不得不使用`background`
*   我也不得不使用`-unico-inner-stroke-width`

我最终在 Ubuntu 主题本身的 GTK3 CSS 文件中查看发生了什么，位于此处：

```
/usr/share/themes/Ambiance/gtk-3.0/gtk-widgets.css 
```

我`-unico-inner-stroke-width`从上面的 CSS 文件中获得了属性。我无法确定为什么`background-color`在我的脚本中被忽略，但至少在 Ubuntu 12.04 上是这样。

我还被迫“重新设置”我正在更改的元素的背景和边框颜色，否则它们会显得很奇怪。这是我必须使用的最低 CSS

```
 GtkMenuItem 
                    {
                        border:@bg_color;
                        background:@bg_color;
                    }

                    GtkMenuItem:hover
                    {
                        background:@selected_bg_color;
                    }

                    GtkWidget
                    {
                        border: @bg_color;
                    }

                    #mymenu:hover
                    {
                        color:@fg_color;
                        background: @bg_color;
                        -unico-inner-stroke-width: 0;
                    } 
```

在此示例中，我将单个 GtkMenuItem 的悬停颜色设置为与背景颜色相同，但如果要将颜色设置为其他颜色，则必须根据`background`需要更改属性。

结果，没有悬停颜色的工作 MenuItem

![在此处输入图像描述](../Images/835592fc19ccdc38118012aeeb393012.png)

这是完整的 Python 代码：

```
from gi.repository import Gtk, Gdk
import sys

class TrayIcon:

    def __init__(self):
        self.statusicon = Gtk.StatusIcon()
        self.statusicon.set_from_stock(Gtk.STOCK_MEDIA_PLAY)
        self.statusicon.connect("popup-menu", self.OnShowPopupMenu)
        self.statusicon.set_tooltip_text("HELLO")
        window = Gtk.Window()

    def OnShowPopupMenu(self, icon, button, time):

        display = Gdk.Display.get_default()
        screen = display.get_default_screen()

        css_provider = Gtk.CssProvider()

        gtk3Css = """GtkMenuItem {
                        border:@bg_color;
                        background:@bg_color;
                    }

                    GtkMenuItem:hover
                    {
                        background:@selected_bg_color;
                    }

                    GtkWidget
                    {
                        border: @bg_color;
                    }

                    #mymenu:hover
                    {
                        color:@fg_color;
                        background: @bg_color;
                        -unico-inner-stroke-width: 0;
                    }"""
        css_provider.load_from_data(gtk3Css)
        context = Gtk.StyleContext()
        context.add_provider_for_screen(screen, css_provider, Gtk.STYLE_PROVIDER_PRIORITY_APPLICATION)

        menu = Gtk.Menu()
        #menu.set_name('mymenu')
        first = self.GetMenuItem("First")
        first.set_name('mymenu')
        second = self.GetMenuItem("Second")
        menu.append(first)
        menu.append(second)
        menu.show_all()
        menu.popup(None, None, lambda w,x: self.statusicon.position_menu(menu, self.statusicon), self.statusicon, 3, time)

    def GetMenuItem(self, txt):
    menuItem = Gtk.MenuItem()
    menuItem.set_label(txt)

    menuItem.connect("button_press_event", self.exit)

    return menuItem

    def exit(self, a,b):
    sys.exit()

TrayIcon()
Gtk.main() 
```

如果你想设置另一种背景颜色，你可以在上面的 CSS 中做到这一点

```
 GtkMenuItem:hover
                    {
                        background:purple;
                        -unico-inner-stroke-width: 0;
                    } 
```

（或在#mymenu:hover 中执行）

![在此处输入图像描述](../Images/0211e0e500930e578106e659063037a7.png)

总之，我认为这可能是我通过运行确定的仅限于 Ubuntu 12.04 或 GTK 3.4.2 的问题，

```
pkg-config --modversion gtk+-3.0 
```

但我没有专业知识来确定这个问题的根源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T20:15:35.913

好吧，它是 C 而不是 python，但这对我有用。我将菜单命名为“mymenu”，这样您就可以在不使用 GtkLabel 的情况下为其设置样式，这会影响应用程序中的任何其他标签。

```
/* COMPILE WITH: gcc -Wall -o icon3 `pkg-config --cflags --libs gtk+-3.0` icon3.c */

#include <gtk/gtk.h>
#include <string.h>  /* for CSS */

static void cb_left_click(GtkStatusIcon *icon, gpointer data)
{
 static GtkWidget *window = NULL;

if (window == NULL) {
    window = gtk_window_new(GTK_WINDOW_TOPLEVEL);
    gtk_window_set_title(GTK_WINDOW(window), "Status Icon");

    g_signal_connect( window, "delete-event", G_CALLBACK(gtk_main_quit), NULL );
    gtk_widget_show(window);
}
}

static void cb_right_click(GtkStatusIcon *icon, int button, int time, gpointer data)
{
    GtkWidget *menu;

menu = gtk_menu_new ();
gtk_widget_set_name(GTK_WIDGET(menu),"mymenu");
GtkWidget *item1 = gtk_menu_item_new_with_label("First");

GtkWidget *item2 = gtk_menu_item_new_with_label("Second");

gtk_menu_shell_append(GTK_MENU_SHELL(menu), item1);
gtk_menu_shell_append(GTK_MENU_SHELL(menu), item2);

    gtk_widget_show_all(menu);
    gtk_menu_popup(GTK_MENU(menu),
                        NULL,
                        NULL,
                        gtk_status_icon_position_menu,
                        icon,
                        button,
                        time);
}

int main(int argc, char *argv[])
{
GtkStatusIcon *icon;
/*-- CSS ------------------*/
  GtkCssProvider *provider;
  GdkDisplay *display;
  GdkScreen *screen;
/*---------------------------*/

gtk_init(&argc, &argv);

icon = gtk_status_icon_new_from_stock (GTK_STOCK_MEDIA_PLAY);

g_signal_connect (G_OBJECT(icon), "activate", G_CALLBACK(cb_left_click), NULL);
g_signal_connect (G_OBJECT(icon), "popup-menu", G_CALLBACK(cb_right_click), NULL);

/*---------------- CSS ----------------------------------------------------------------------------------------------------*/
  provider = gtk_css_provider_new ();
  display = gdk_display_get_default ();
  screen = gdk_display_get_default_screen (display);
  gtk_style_context_add_provider_for_screen (screen, GTK_STYLE_PROVIDER (provider),     GTK_STYLE_PROVIDER_PRIORITY_APPLICATION);

  gsize bytes_written, bytes_read;

 const gchar* home = "/home/mike/icon3.css";     

  GError *error = 0;

  gtk_css_provider_load_from_path (provider,
                               g_filename_to_utf8(home, strlen(home),
                               &bytes_read, &bytes_written, &error),
                               NULL);
  g_object_unref (provider);
/*-------------------------------------------------------------------------------------------------------------------------*/

    gtk_main();
    return 0;
} 
```

Css 文件：

```
#mymenu {       
    background-color: white;
    color: green;
    font-weight:bold;
}

#mymenu :hover {
    background-color: red;
    color: blue;
    font-weight:bold;
} 
```

# sql - 如何显示列表 sqlite 数据库表，除了表 sqlite_sequence？

> ID：11381403
> 
> 赞同：1
> 
> 时间：2012-07-08T07:22:39.413
> 
> 标签：sql, sqlite

这样做

```
select name from sqlite_master where type='table' 
```

但我需要显示除 sqlite_sequence 之外的所有表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T07:30:32.567

下面的 SQL 有什么问题？

```
select name from sqlite_master where type = 'table' and name <> 'sqlite_sequence' 
```

# javascript - 试图弄清楚为什么 Firefox 会发送未经请求的 FIN ACK 数据包

> ID：11381405
> 
> 赞同：2
> 
> 时间：2012-07-08T07:22:51.230
> 
> 标签：javascript, firefox, networking, tcp

我使用 OpenLaszlo 在 DHTML 中编写了一个应用程序。该应用程序在 Chrome 中运行良好，但在 Firefox 中出现问题。javascript 客户端向 Struts2 中间层发出 HTTP POST 请求，该中间层通过 Hibernate 查询数据库，然后返回 XML 响应。该应用程序正在生产中，因此客户端代码、中间层和数据库都托管在我的台式机上。

我可以在 Chrome 和 Firefox 中并行运行该应用程序，虽然在 Chrome 中一切正常，但一些 HTTP 请求（每次都相同）在 Firefox 上会失败。那些在发起 POST 请求后立即失败，没有给出 HTTP 响应或错误代码（我使用 Firebug 来观察 POST 请求和响应）。

在使用 Wireshark 观察流量后，我确定，由于某种原因，Firefox 在发出 POST 请求并从服务器接收到标准 ACK 后立即（不到一秒）发送 FIN ACK 数据包。

网络流量如下所示：

在 Chrome 中：客户端发送 POST -> 服务器发送 ACK -> 服务器发送 XML 数据 -> 客户端发送 ACK -> 服务器发送 HTTP/XML 200 响应 -> 客户端发送 ACK

在 Firefox 中：客户端发送 POST -> 服务器发送 ACK -> 客户端发送 FIN，ACK -> 服务器发送 ACK -> 服务器发送 XML 数据 -> 客户端发送重置

我想知道是否有人以前目睹过这种行为，并且可能知道我能做些什么来解决它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-02-04T10:23:45.647

我也遇到了这个问题。Firefox 发送与其新的网络更改功能相关的 FIN、ACK。见：[https ://hg.mozilla.org/mozilla-central/rev/0a066b7ffa46](https://hg.mozilla.org/mozilla-central/rev/0a066b7ffa46)

我们花费大量时间来检查这一点。我在stackoverflow上也有一个帖子：[当firefox 38在服务器确认从firefox获取http后发送FIN，ACK时？](https://stackoverflow.com/questions/35086868/when-firefox-38-sent-fin-ack-after-server-ack-an-http-get-from-firefox)

对于对此感兴趣的任何人，请跟踪：bugzilla.mozilla.org/show_bug.cgi?id=1245059 解决方法是将“network.http.network-changed.timeout”设置得更大。查看我们报告的 Firefox 错误以获取更多详细信息。

# ruby - 红宝石符号作为键，但无法从哈希中获取值

> ID：11381408
> 
> 赞同：4
> 
> 时间：2012-07-08T07:23:13.220
> 
> 标签：ruby, hash, symbols

我正在对其他人的代码进行一些更新，现在我有一个哈希，就像：

```
{"instance_id"=>"74563c459c457b2288568ec0a7779f62", "mem_quota"=>536870912, "disk_quota"=>2147483648, "mem_usage"=>59164.0, "cpu_usage"=>0.1, "disk_usage"=>6336512} 
```

我想通过符号作为键来获取值，例如：：mem_quota，但失败了。

代码如下：

```
instance[:mem_usage].to_f 
```

但它什么也不返回。有什么原因会导致这个问题吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-08T07:25:17.430

改为使用`instance["mem_usage"]`，因为哈希不使用符号。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-08T15:45:23.507

其他解释是正确的，但要给出更广泛的背景：

您可能习惯于在 Rails 中工作，其中一个非常特殊的 Hash 变体，称为 HashWithIndifferentAccess，用于参数之类的东西。这个特殊的类就像一个标准的 ruby​​ 哈希，除了当你访问键时，你可以使用符号或字符串。标准的 Ruby Hash，一般来说，其他语言中的 Hash 实现，期望访问一个元素，用于以后访问的键应该是与用于存储对象的键具有相同类和值的对象。HashWithIndifferentAccess 是通过 Active Support 库提供的 Rails 便利类。您可以自己自由使用它们，但首先需要它们才能引入它们。

HashWithIndifferentAccess 只是在访问时为您进行从字符串到符号的转换。

因此，对于您的情况， instance["mem_usage"].to_f 应该可以工作。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-07-08T08:31:15.493

您需要 HashWithIndifferentAccess。

```
require 'active_support/core_ext'

h1 = {"instance_id"=>"74563c459c457b2288568ec0a7779f62", "mem_quota"=>536870912, 
  "disk_quota"=>2147483648, "mem_usage"=>59164.0, "cpu_usage"=>0.1, 
  "disk_usage"=>6336512}

h2 = h1.with_indifferent_access

h1[:mem_usage] # => nil
h1["mem_usage"] # => 59164.0

h2[:mem_usage] # => 59164.0
h2["mem_usage"] # => 59164.0 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-12-21T08:21:11.493

此外，还有[`symbolize_keys`](https://apidock.com/rails/v4.2.7/Hash/symbolize_keys)和[`stringify_keys`](https://apidock.com/rails/v4.2.7/Hash/stringify_keys)选项可能会有所帮助。我相信，方法名称足够自我描述。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-08T07:25:13.713

显然，哈希的键是字符串，因为它们周围有双引号。因此，您将需要访问密钥，`instance["mem_usage"]`或者您需要首先构建一个以符号作为密钥的新哈希。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-01-24T02:19:22.700

如果您将 Rails 与 ActiveSupport 一起使用，请务必使用`HashWithIndifferentAccess`字符串或符号访问散列的灵活性。

```
hash = HashWithIndifferentAccess.new({
  "instance_id"=>"74563c459c457b2288568ec0a7779f62", 
  "mem_quota"=>536870912, "disk_quota"=>2147483648, 
  "mem_usage"=>59164.0, 
  "cpu_usage"=>0.1, 
  "disk_usage"=>6336512
})

hash[:mem_usage] # => 59164.0
hash["mem_usage"] # => 59164.0 
```

# java - 是否可以仅使用纯 Java 编写类似于 bash 的 shell？

> ID：11381417
> 
> 赞同：3
> 
> 时间：2012-07-08T07:24:33.647
> 
> 标签：java, bash, shell

我知道 C（或者为什么不是 C++）是这样做的自然选择，但出于个人原因，我想在 Java 中尝试它。

我想要实现的：

*   `|`
*   `>`
*   `>>`
*   一些内置插件，如`echo`和`if`

我正在考虑使用 ProcessBuilder、PipedInputStream、PipedOutputStream 等来实现我的目标。

你认为这在不依赖 JNI 的情况下是可能的吗？

我应该使用像 antlr 这样的工具来帮助我学习语法，还是你认为它对于我需要的东西来说是多余的？

还有什么建议、材料吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T07:55:04.927

对的，这是可能的。事实上，它已经在 J​​Node 中完成了。JNode 包含一个名为“bjorne”的外壳，它或多或少是完整的，或多或少是 POSIX 兼容的。

问题在于，当前形式的“bjorne”运行在 JNode 操作系统上/下执行的命令，而不是在 Linux 或 Windows 平台上。因此，用于启动命令的“接口”不依赖于 fork/exec 或`Process`，就像经典 JVM 上的实现所需要的那样。但这就是练习的重点……

* * *

如果你自己实现这个，Antlr 不会有太大帮助，因为基本的 shell 语法是上下文相关的。此外，实现 POSIX 的“难点”在于获得正确的引用和扩展，以及处理子shell、重定向等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T08:01:03.183

[http://www.beanshell.org/](http://www.beanshell.org/)已经存在多年，并在许多 IDE 的调试器中用于评估表达式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-10T05:52:35.603

`| > >>`这是可能的，尤其是对于像和之类的简单要求`for`。但是，如果没有本机代码，您将无法实现某些功能，例如 exec。您可以使用[JShell](http://www.geophile.com/jshell/)作为起点。不过，要使其与当前的 JDK 和库一起编译，还有一些工作要做。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-08T07:28:44.810

这将是一个重复的练习，但如果你只是为了这样做而这样做，如果你想复制一个控制台，你应该从控制台处理部分的[jline开始。](http://jline.sourceforge.net/)[jline](http://jline.sourceforge.net/)处理所有本*机*内容，因此您无需处理任何 JNI。[jline](http://jline.sourceforge.net/)与 OSX、Linux 和 Windows 同等地工作。

ANTLR 不会对做这么简单的事情有任何好处，但是像[JSAP](http://www.martiansoftware.com/jsap/)这样的命令行解析器会很有用。

jline 和 JSAP 将为您提供构建功能 shell 和命令行解析shell 支持的“*命令”所需的一切。*

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-08T07:28:54.943

唯一真正的挑战是输入的实际解析，特别是如果你想模拟例如 bash，因为我肯定会使用 Antlr 来构建语法和相关代码。我认为使用 Antlr 并不过分，因为它有助于提供正确的解析并让您更轻松地实现实际的 shell 函数，因为它会删除您必须编写的大部分代码。有些领域可能需要JNI，但我认为除了一些特殊情况外，它不会是非常重要的代码部分。

我会看看其他的 shell 实现，我也知道有一些大学课程涵盖了操作系统，它们的任务与此类似。

# javascript - Twipsy 不在 Twitter 引导程序 2.0 中？

> ID：11381428
> 
> 赞同：0
> 
> 时间：2012-07-08T07:25:57.287
> 
> 标签：javascript, twitter-bootstrap

过去，twitter bootstrap 有一个 Javascript 插件，“twipsy”。现在，在 Bootstrap 2.0 中，插件不会出现。

有人知道为什么吗？有什么方法可以再次获得该功能？

谢谢！对不起我的英语不好......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T07:37:30.490

它有[工具提示](http://twitter.github.com/bootstrap/javascript.html#tooltips)插件。这应该和 Twipsy 做同样的事情。

# css - 如何修复 100% 高度的布局底部（jQuery Mobile 和 Google Map）？

> ID：11381430
> 
> 赞同：2
> 
> 时间：2012-07-08T07:26:02.007
> 
> 标签：css, html, google-maps, layout

我有一个布局，我希望主要内容区域是剩余空间的 100% 高度。所以我快到了，但底部被截断（这会影响缩放和居中）。从底部有 41px 被截断，这是标题区域的测量值：http: [//jsfiddle.net/GTscW/](http://jsfiddle.net/GTscW/)

我知道它是否被切断的原因是因为我没有看到谷歌地图的版权信息。这是未截断的，但截断了顶部（我刚刚从#content .inner-content 中删除了顶部：41px）：http: [//jsfiddle.net/GTscW/1/](http://jsfiddle.net/GTscW/1/)

如何从第一个样本的底部减去 41px 以获得剩余区域的 100% 内容？

**编辑：**

我能够添加这个：$('#content .inner-content').height($(this).height() - $('#header').height())，但实际上没有 CSS 解决方案？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T08:34:53.963

一个问题是混合百分比和像素测量并不容易，因为不同的屏幕尺寸会表现不同。但是可以使用 API 功能让地图在任何尺寸的屏幕上按照您想要的方式运行。

将地图设为屏幕大小的 100%，因此标题会遮挡地图的一部分。抑制默认地图控件，使其不会出现部分遮挡。创建一个与标题相同大小的空自定义控件，并将其放置在地图的顶部。当重新添加地图控件时，自定义控件会将它们从通常的位置推出，以便它们在可见地图上看起来正确。

```
var posn=google.maps.ControlPosition; // shorten the reference

// Add empty custom control
var controlDiv = document.createElement('div');
controlDiv.style.width='100%';
controlDiv.style.height='41px';
map.controls[posn.TOP_LEFT].push(controlDiv);
map.controls[posn.TOP_RIGHT].push(controlDiv);

// Add map controls
map.setOptions({
    mapTypeControlOptions:{position:posn.RIGHT_TOP},
    mapTypeControl:true,
    panControlOptions:{position:posn.LEFT_TOP},
    panControl:true,
    streetViewControlOptions:{position:posn.LEFT_TOP},
    streetViewControl:true,
    zoomControlOptions:{position:posn.LEFT_TOP},
    zoomControl:true
}) 
```

[http://jsfiddle.net/GTscW/4/](http://jsfiddle.net/GTscW/4/)

注意 1：因为地图实际上比看起来大 41px（在您的情况下），所以中心点将比可查看地图的中心高 20px。这可能不值得担心。如果是，那么处理一个明显的中心点是[关于 SO 的另一个问题](https://stackoverflow.com/questions/10656743/how-to-offset-the-center-point-in-google-maps-api-v3/10666030#10666030)的主题。

注意 2：此方法无法获得固定*页脚，*因为 Google 徽标和条款链接始终位于地图底部，并且 [当前] 不会移动以避免控制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T12:35:50.143

我用一个解决方案编辑了你的小提琴：http: [//jsfiddle.net/T2Nkk/](http://jsfiddle.net/T2Nkk/)

基本上，创建一个看起来像这样的函数：

```
function remainder() {
    $("*[height=\"remainder\"]").each(function(index, element) {
        var offsetParent;
        var target = $(element);
        if (element==$("body")[0]) {
            offsetParent = $("html");
        }
        else {
            offsetParent = target.offsetParent();
        }
        var position = target.position();
        var heightParent = offsetParent.height();
        var extras = target.outerHeight(true)-target.height();
        var remainderHeight = heightParent-position.top;
        target.height(remainderHeight-extras);
    });
} 
```

对于要占据页面其余部分的元素，请执行以下操作：

```
<div id="content" data-role="content" height="remainder"> 
```

最后，当您的文档准备就绪时：

```
$(document).ready(function() {
    remainder();
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-06T12:15:15.783

只有在 css 中你可以尝试使用一个技巧：像我在你的小提琴上一样使用属性`top`和`bottom`属性：http: [//jsfiddle.net/GTscW/23/](http://jsfiddle.net/GTscW/23/)`position: absolute`

不知道它是否在任何地方都有效。

# android - Android 4.1 java.lang.VerifyError：

> ID：11381432
> 
> 赞同：0
> 
> 时间：2012-07-08T07:26:30.267
> 
> 标签：android, android-4.2-jelly-bean

刚刚将我的 SDK 更新到 r20，并想在 Ice Cream Sandwich 4.1 模拟器上测试我的应用程序。当我试图创建一个新数据库时崩溃时，我的应用程序只有 6 行：

```
 gradeBookDbAdapter mDbHelper = new gradeBookDbAdapter(this);  <--- fails here

 private static class DatabaseHelper extends SQLiteOpenHelper {

    DatabaseHelper(Context context) {
        super(context, DATABASE_NAME, null, DATABASE_VERSION);
    }

    public gradeBookDbAdapter(Context ctx) {                <-- but it never gets here
    this.mCtx = ctx;
    }
  <snip...</snip> 
```

在“java.lang.VerifyError:”崩溃之前，我什至无法使用构造函数处理任何可执行代码

我正在使用外部库 Jexecelapi 来读取/写入 Excel 文件。自从我在 3 次主要修订前首次包含它以来，它一直在完美运行。但现在我的 LogCat 说：

```
07-08 18:21:38.185: I/dalvikvm(861): Could not find method jxl.Workbook.getWorkbook,     referenced from method com.ulsanonline.gradebook2.gradeBookDbAdapter.readExcel
07-08 18:21:38.185: W/dalvikvm(861): VFY: unable to resolve static method 1084: Ljxl/Workbook;.getWorkbook (Ljava/io/File;)Ljxl/Workbook;
07-08 18:21:38.185: D/dalvikvm(861): VFY: replacing opcode 0x71 at 0x001b
07-08 18:21:38.185: W/dalvikvm(861): VFY: unable to resolve exception class 290 (Ljxl/read/biff/BiffException;)
07-08 18:21:38.185: W/dalvikvm(861): VFY: unable to find exception handler at addr 0x5c
07-08 18:21:38.185: W/dalvikvm(861): VFY:  rejected Lcom/ulsanonline/gradebook2/gradeBookDbAdapter;.readExcel (Ljava/lang/String;)V
07-08 18:21:38.185: W/dalvikvm(861): VFY:  rejecting opcode 0x0d at 0x005c
07-08 18:21:38.185: W/dalvikvm(861): VFY:  rejected Lcom/ulsanonline/gradebook2/gradeBookDbAdapter;.readExcel (Ljava/lang/String;)V
07-08 18:21:38.185: W/dalvikvm(861): Verifier rejected class Lcom/ulsanonline/gradebook2/gradeBookDbAdapter;
07-08 18:21:38.195: D/AndroidRuntime(861): Shutting down VM
07-08 18:21:38.195: W/dalvikvm(861): threadid=1: thread exiting with uncaught exception (group=0x409c01f8)
07-08 18:21:38.205: E/AndroidRuntime(861): FATAL EXCEPTION: main
07-08 18:21:38.205: E/AndroidRuntime(861): java.lang.VerifyError: com/ulsanonline/gradebook2/gradeBookDbAdapter 
```

所以我在第一篇文章中没有注意到崩溃上方的 logcat 文本，只是从主要错误向南走。我的图书馆现在失败的任何原因？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T11:23:51.713

事实证明，使用新的 SDK 我必须将我引用的库放在 /libs 文件夹中。这似乎已经解决了问题。——</p>

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-12T08:26:26.660

1.在您的项目目录中打开您的**.classpath文件。**

2.将**exported="true"**添加到**classpathentry**标签中。如 ：

旧：classpathentry kind="lib" path="libs/httpmime-4.0.1.jar"

新：classpathentry**导出="true"** kind="lib" path="libs/httpmime-4.0.1.jar"

3.保存并重试。

# google-bigquery - 在 Google BigQuery 中限制存储使用量

> ID：11381433
> 
> 赞同：0
> 
> 时间：2012-07-08T07:26:32.213
> 
> 标签：google-bigquery

是否有任何保护措施可以限制您自己在 BigQuery 上的**存储大小？**或者如果达到某个大小阈值时发出警报的方法？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T15:50:57.650

没有办法限制大小或在达到大小时发出警报。但是，您可以查看 api 控制台中使用了多少...。转到[https://code.google.com/apis/console/](https://code.google.com/apis/console/)并单击 BigQuery，它将显示您的使用情况。

# javascript - 扩展原型函数而不覆盖它

> ID：11381437
> 
> 赞同：10
> 
> 时间：2012-07-08T07:27:35.930
> 
> 标签：javascript, prototype, parse-platform

我需要修复`save`Parse.Object 库的功能中的错误。但是，当我尝试`save`在覆盖的原型中调用原始函数时，它会递归循环直到堆栈溢出！

```
Parse.Object.prototype.save = function (arg1, arg2, arg3) {
    fixIncludedParseObjects(this);

    Parse.Object.prototype.save.call(this, arg1, arg2, arg3); // endless loop
}; 
```

如何更改无限循环线以调用解析生成的原始函数？

谢谢！

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-07-08T07:35:28.937

试试这个：

```
(function(save) {
  Parse.Object.prototype.save = function (arg1, arg2, arg3) {
    fixIncludedParseObjects(this);
    save.call(this, arg1, arg2, arg3);
  };
}(Parse.Object.prototype.save)); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2018-01-19T13:51:31.960

类似于接受的答案，但可能更容易理解

```
var originalSaveFn = Parse.Object.prototype.save;
Parse.Object.prototype.save = function(arg1, arg2, arg3) {
    fixIncludedParseObjects(this);
    originalSaveFn.call(this, arg1, arg2, arg3);
}; 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-07-08T07:48:44.170

```
Parse.Object.prototype.save = function (save) {
    return function () {
        fixIncludedParseObjects(this);
        //Remember to return and .apply arguments when proxying
        return save.apply(this, arguments);
    };
}(Parse.Object.prototype.save); 
```

# asp.net-membership - 将 Asp.net Forms Authentication 表与我自己的域表集成的最佳实践？

> ID：11381443
> 
> 赞同：0
> 
> 时间：2012-07-08T07:28:07.507
> 
> 标签：asp.net-membership

我正在创建一个将接受用户注册/登录的 Asp.Net 站点。Asp.Net MVC 自动在数据库中生成以下表格，其名称为`aspnet-MyProjectName-20120705215524`.

是否可以让 Asp.Net Mvc 在我自己的数据库中生成表？（我有其他表格将引用该`Users`表格）。我需要表格中的更多列`Users`。我可以手动添加列吗？*而且我还希望在注册页面中显示额外的列。*

* * *

**更新** 集成系统生成的用户表的最佳实践是什么？

1.  会员资格
2.  简介
3.  角色
4.  用户
5.  用户角色

```
CREATE TABLE [dbo].[Users] (
    [ApplicationId]    UNIQUEIDENTIFIER NOT NULL,
    [UserId]           UNIQUEIDENTIFIER NOT NULL,
    [UserName]         NVARCHAR (50)    NOT NULL,
    [IsAnonymous]      BIT              NOT NULL,
    [LastActivityDate] DATETIME         NOT NULL,
    PRIMARY KEY CLUSTERED ([UserId] ASC),
    CONSTRAINT [UserApplication] FOREIGN KEY ([ApplicationId]) REFERENCES [dbo].[Applications] ([ApplicationId])
); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T07:35:15.363

尝试使用 aspnet_regsql.exe 工具，这将为您生成应用程序服务数据库

[http://msdn.microsoft.com/en-us/library/ms229862(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/ms229862(v=vs.80).aspx)

您可以将列添加到默认数据库，但我不知道这样做的影响，大多数应用程序服务都使用存储过程，因此您可以扩展它们

# java - 文件和插入排序。线程“主”java.lang.ArrayIndexOutOfBoundsException 中的异常：0

> ID：11381450
> 
> 赞同：0
> 
> 时间：2012-07-08T07:28:57.923
> 
> 标签：java, file, file-io, insertion-sort

该程序**使用插入排序对文件中的前 n 个单词进行排序**。

**这不是我做的。**我们被要求使用老师提供的这个程序来实施其他分类技术。我导入了源代码，并在我运行它时。它说：

> 线程“main”中的异常 java.lang.ArrayIndexOutOfBoundsException: 0 在 SortingAnalysis.main(SortingAnalysis.java:26)

但是当我们的老师在我们的课堂上演示它时，它没有错误。

我也想知道**它是如何在不说明文件名的情况下对文件中的单词进行排序的**（例如 tobesorted.txt）。也许只要它在 JRE 系统库中，它就可以工作，不是吗？

```
import java.io.*;
import java.util.*;

/**
 * Compares the running times of sorting algorithms
 * @author bryann
 *
 */
public class SortingAnalysis {

    public static void insertionSort(String[] a) {
        int n = a.length;
        for(int i = 1; i < n; i++) {
            String cur = a[i];
            int j = i - 1;
            while((j >= 0) && (a[j].compareTo(cur) > 0)) {
                a[j + 1] = a[j--];
            } // end while
            a[j + 1] = cur;
        } // end for
    } // end insertionSort

    public static void main(String[] args) {
        final int NO_OF_WORDS = 5000;
        try {
            Scanner file = new Scanner(new File(args[0]));
            String[] words = new String[NO_OF_WORDS];

            int i = 0;
            while(file.hasNext() && i < NO_OF_WORDS) {
                words[i] = file.next();
                i++;
            } // end while
            long start = System.currentTimeMillis();
            insertionSort(words);
            long end = System.currentTimeMillis();
            System.out.println("Sorted Words: ");
            for(int j = 0; j < words.length; j++) {
                System.out.println(words[j]);
            } // end for        
            System.out.print("Running time of insertion sort: " + (end - start) + "ms");

        } // end try
        catch(SecurityException securityException) {
            System.err.println("You do not have proper privilege to access the files.");
            System.exit(1);
        } // end catch
        catch(FileNotFoundException fileNotFoundException) {
            System.err.println("Error accessing file");
            System.exit(1);
        } // end catch
    } // end main
} // end class SortingAnalysis 
```

**错误是因为导入吗？**使用 Eclipse，我只需单击
**文件 > 导入 > 常规 > 文件系统 > 从目录**（他发送给我们的整个文件夹）**> 进入文件夹**（我创建了一个新项目，并且在那里我“导入”了代码）**> 完成**

请帮我。我无法从分配开始（即在同一源文件中尝试其他排序技术），因为我无法运行它。非常感谢你！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T07:40:08.797

程序的主要功能接受参数：

```
public static void main(String[] args) { 
```

这些参数是在命令行上传递给程序的参数：

```
java SortingAnalysis /home/somebody/tobesorted.txt 
```

在这种情况下，`args[0]`将是`"/home/somebody/tobesorted.txt"`

这使程序能够知道要打开什么文件：

```
Scanner file = new Scanner(new File(args[0])); 
```

但是，当您在不提供文件路径的情况下启动程序时，args 太短了，您就拥有了这个`java.lang.ArrayIndexOutOfBoundsException: 0 as args[0] doesn't exist`。

因此，给出要排序的文件的路径以消除此错误。例如 ：

```
java SortingAnalysis C:\somepath\tobesorted.txt 
```

**编辑：**

如果你想硬编码路径，你可以这样做：

```
Scanner file = new Scanner(new File("C:\\somepath\\tobesorted.txt")); 
```

（注意双`\\`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T07:40:29.370

```
public static void main(String[] args) {
    ...
        Scanner file = new Scanner(new File(args[0])); 
```

它正在寻找运行它时传入的第一个参数，即单词文件。您需要将其运行为：

```
java SortingAnalysis wordsfile.txt 
```

# java - Hibernate Table_Per_Class 继承查询

> ID：11381453
> 
> 赞同：0
> 
> 时间：2012-07-08T07:29:18.190
> 
> 标签：java, hibernate

说1有这个简单的结构

```
@Entity
@Inheritance(strategy = Table_Per_Class)
class A {
@Id
private a;
private b;
}

@Entity
class B extends A{
private c;
}

@Entity
class C extends A{
private d;
} 
```

现在 ：

A 类成员变量是私有的，这意味着它们不会被 B 类和 C 类继承。换句话说，B 和 C 类不会有单独的 a 和 b 副本。即使这样，我们也可以看到 Hibernate 在数据库的 B 和 C 表中为 a 和 b 创建单独的列（和值）。我无法理解这部分。请帮帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T07:58:12.337

B 扩展了 A。所以 B 是 A。由于 A 具有`a`和`b`字段，因此 B 也具有它们。

一个对象的状态是由它拥有的一组字段，加上它的超类拥有的一组字段，再加上超类的超类的一组字段等等组成的。这与Hibernate无关。

如果水果有颜色，如果香蕉是水果，香蕉就有颜色。由于 Hibernate 保持香蕉的状态，它必须保持它的颜色。在 Fruit 中颜色字段是私有的这一事实没有任何区别。

# php - 我的第一个 SOAP 客户端中的异常

> ID：11381457
> 
> 赞同：0
> 
> 时间：2012-07-08T07:30:03.133
> 
> 标签：php, exception, soap

我正在尝试为 [https://webservice.kareo.com/services/soap/2.1/KareoServices.svc?wsdl上的服务编写一个 SOAP 客户端](https://webservice.kareo.com/services/soap/2.1/KareoServices.svc?wsdl)

我查询了服务提供的类型（*_getTypes）和函数（* _getFunctions）。下面是我尝试执行的“GetPatients”操作的类型结构：

```
struct GetPatients {
 GetPatientsReq request;
}

struct GetPatientsReq {
 PatientFieldsToReturn Fields;
 PatientFilter Filter;
}

struct PatientFieldsToReturn {
 boolean AddressLine1;
 boolean AddressLine2;
 boolean Age;
.
.
.
}

struct PatientFilter {
 string CollectionCategoryName;
 string DefaultCasePayerScenario;
 string FirstName;
.
.
.
}

struct GetPatientsResponse {
 GetPatientsResp GetPatientsResult;
}

struct GetPatientsResp {
 ArrayOfPatientData Patients;
}

struct ArrayOfPatientData {
 PatientData PatientData;
}

struct PatientData {
 string AddressLine1;
 string AddressLine2;
 string Adjustments;
 string Age;
.
.
.
} 
```

函数定义为：

GetPatientsResponse GetPatients(GetPatients $parameters)

下面是我尝试使用 Web 服务的“GetPatients”操作的 php 代码：

```
 <?php

     $url="https://webservice.kareo.com/services/soap/2.1/KareoServices.svc?wsdl";

     $client=new SoapClient($url);

    /* fake user, password, key */

     $CustomerKey='xxx';

     $User='rmg15';

     $Password='pass77';

     $PatientID='1234';

    $authheader=array("CustomerKey"=>$CustomerKey,"User"=>$User,"Password"=>$Password);

    $header =  new SoapHeader("https://webservice.kareo.com/services/soap/2.1/","AuthHeader",  $authheader,false);

    $client->__setSoapHeaders(array($header));

    /* it works till this point because I was able to successfully perform the __getTypes, __getFunctions operations. */

   $filter= array("FirstName"=>"rmg15");

   $fields=array("age"=>"true");

   $request=array("PatientFieldsToReturn"=>$fields,"PatientFilter"=>$filter);

   $getpatientreq=array("GetPatientsReq"=>$request);

   try
  {
   $presponse=$client->GetPatients($getpatientreq);

  }

  catch (Exception $ex) {
   var_dump($ex->faultcode, $ex->faultstring, $ex->faultactor, $ex->detail, $ex->_name, $ex->headerfault);

   }

   ?> 
```

这是我从服务中得到的例外：

“你调用的对象是空的。”

在这一行抛出异常：

$presponse=$client->GetPatients($getpatientreq)

这是整个异常消息：

```
object(stdClass)#7 (1) {
  ["ExceptionDetail"]=>
  object(stdClass)#8 (5) {
    ["HelpLink"]=>
    NULL
    ["InnerException"]=>
    NULL
    ["Message"]=>
    string(53) "Object reference not set to an instance of an object."
    ["StackTrace"]=>
    string(755) "   at KareoServicesWCF.KareoServices.GetPatients(GetPatientsReq request) in c:\BuildAgent\work\309fd08b06e24475\Superbill\Software\Application\KareoServicesWCF\2.1\KareoServicesWCF\KareoServices.cs:line 497
   at SyncInvokeGetPatients(Object , Object[] , Object[] )
   at System.ServiceModel.Dispatcher.SyncMethodInvoker.Invoke(Object instance, Object[] inputs, Object[]& outputs)
   at System.ServiceModel.Dispatcher.DispatchOperationRuntime.InvokeBegin(MessageRpc& rpc)
   at System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage5(MessageRpc& rpc)
   at System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage31(MessageRpc& rpc)
   at System.ServiceModel.Dispatcher.MessageRpc.Process(Boolean isOperationContextSet)"
    ["Type"]=>
    string(29) "System.NullReferenceException" 
```

这是我正在编写的第一个 SOAP 客户端。解决此问题的任何帮助都会很有用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T16:40:52.643

找到了解决方案。感谢 Ankit Jain 在[https://github.com/geersch/WcfServicesWithPhp5的回复](https://github.com/geersch/WcfServicesWithPhp5)

```
$wsdl = 'https://webservice.kareo.com/services/soap/2.1/KareoServices.svc?wsdl';

$client = new SoapClient($wsdl, array('trace' => 1, 'exceptions' => 1));

// Store data in the object of stdClass`enter code here`
$requestHeader = new stdClass;
$requestHeader->CustomerKey = 'xxx';
$requestHeader->User = 'yyy';
$requestHeader->Password = 'int123';

$filter = new stdClass;
$filter->PracticeName = "American Surgery Associates";

$fields = new stdClass;
$fields->ID = true;
$fields->PracticeName = true;
$fields->PatientFullName = true;

$request = new stdClass;
$request->RequestHeader = $requestHeader;
$request->Filter = $filter;
$request->Fields = $fields;

// Call a SOAP function
$response = $client->GetPatients(array('request' => $request));

    print_r($response); 
```

# c - 使用 libxml 的 XML 解析器

> ID：11381460
> 
> 赞同：1
> 
> 时间：2012-07-08T07:32:36.297
> 
> 标签：c, xml, linux

我刚开始使用 libxml 来解析 xml。我只需要知道根节点“beatles”是否存在，然后获取子子节点“lastname”。我的代码如下

```
#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include <libxml/xmlmemory.h>
#include <libxml/parser.h>

void parseStory ( xmlDocPtr doc, xmlNodePtr cur )
{

        xmlChar *key;
        cur = cur -> xmlChildrenNode;
        printf ( "Here\n" );
        while ( cur != NULL )
        {   
                if ( ( !xmlStrcmp ( cur -> name, ( const xmlChar * ) "lastname" ) ) ) 
                {   
                        key = xmlNodeListGetString ( doc, cur -> xmlChildrenNode,1);
                        printf ( "keyword: %s\n", key );
                        xmlFree ( key );
                }   
                cur = cur -> next;
        }   
        return ;
}

static void parseDoc ( char *docname )
{
        xmlDocPtr doc;
        xmlNodePtr cur;
        doc = xmlParseFile ( docname );

        if ( doc == NULL )
        {   
                fprintf ( stderr, "Document not parsed successfully. \n" );
                return;
        }   
        printf ( "Parsing Successful\n" );
        cur = xmlDocGetRootElement ( doc );

        if ( cur == NULL )
        {   
                fprintf ( stderr, "empty document \n" );
                xmlFreeDoc ( doc );
                return;
        }   

        printf ( "Got the root Node\n" );
        if ( xmlStrcmp ( cur->name, ( const xmlChar * ) "beatles" ) )
        {
                fprintf ( stderr, "Document of the wrong type root node != ");
                xmlFreeDoc(doc);
                return;

        }
        printf ( "Got the root \n" );
        cur = cur -> xmlChildrenNode;
        while ( cur != NULL )
        {
                if ( !(xmlStrcmp ( cur->name, ( const xmlChar * ) "name" ) ) )
                {
                        parseStory ( doc, cur );
                }
                cur = cur -> next;
        }
        xmlFreeDoc ( doc );
        return;
}

int main ( int argc, char **argv )
{
        char *docname;

        if ( argc <= 1 )
        {
                printf ( "Usage: %s docname\n", argv[0] );
                return ( 0 );
        }
        docname = argv [1];
        parseDoc ( docname );

        return ( 1 );
} 
```

xml文件是

```
<?xml version="1.0"?>
<beatles>
 <beatle link="http://www.paulmccartney.com">
  <name>
   <firstname>Paul</firstname>
   <lastname>McCartney</lastname>
  </name>
 </beatle> 
```

我能够获得根节点“披头士”，但找不到“名称”和“姓氏”。请帮我解决一下这个。

如果还有其他 libxml 函数可以使用，请告诉我。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T10:33:08.640

您需要在 while 循环中进行一些小改动。

```
printf ( "Got the root \n" );
cur = cur -> xmlChildrenNode;
while ( cur != NULL )
{
    if (cur->type == XML_ELEMENT_NODE) {

        if ( !(xmlStrcmp ( cur->name, ( const xmlChar * ) "name" ) ) )
        {
                parseStory ( doc, cur );
        }
        cur = cur -> xmlChildrenNode;
        continue;
    }
    cur = cur -> next;
} 
```

# c++ - MakeFile.am：混合 c 和 c++，新错误

> ID：11381465
> 
> 赞同：1
> 
> 时间：2012-07-08T07:33:37.173
> 
> 标签：c++, c, makefile, autotools

我们在“c”中有很好的代码库。现在，我们正在为所有新模块迁移到 c++。我有一个案例在旧的 c 代码库中使用几个 c++ 类。单独地，两者都有效，即 c++ 模块和 c 模块单独工作并提供所需的 o\p。

当我混合它们时，即在 Ac 中调用 c++ 类时，它会引发大量与旧代码相关的错误。

在我们的 makefile.am 中，我们之前有一个选项 cc=gcc，现在我们将它更改为 cc=g++，因为它抛出了一些错误。最后带有 make 的 makefile.am 创建了一个库，我们说 libx.a。makefile.am 包含各种早期的源文件，即 Ac,xc,yc...

我最初在 Ac,xc 下修复了错误，假设它们使用新的 g++ 编译器。现在，它开始在 xc 下抛出错误，像这样我们有各种源文件。

修复所有这些非常繁琐。我相信我缺少一些与这些错误相关的编译器标志选项。现在，这些错误中的大多数是类型转换错误，我使用 static_cast 等对其进行了转换。除此之外，很少有其他错误。但是，该代码是 c 中的工作代码，它只是混合和更改 makefile 会引发这些错误。

Q: 1\. 如何摆脱这些错误？2\. 是否有任何编译器标志我需要使用以最小的努力继续工作？3\. 在这些过程中我做错了什么吗？4\. 有人建议对makefile.am 进行任何更改吗？

对此的任何帮助表示赞赏。如果 Q 不清楚，请告诉我。

注意：我们使用 autoreconf、configure 和 make 运行我们的应用程序。

问候， 桑托什

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T07:40:17.190

make 将使用一个`$CC`或`$(CXX)`取决于文件的扩展名，并且可以同时使用两者。例如，以 结尾的文件用`*.cpp`编译，以.`$(CXX)`结尾的文件编译。因此，除非您的代码经过适当修改以编译为 C++ ，否则您不必设置或全局设置为。`*.c``$(CC)``cc``CC``g++``C`

# python - 将 QuerySet 传递给上下文处理器时，Django 执行相同的查询 5 次

> ID：11381467
> 
> 赞同：1
> 
> 时间：2012-07-08T07:33:51.260
> 
> 标签：python, django, optimization, django-queryset

我有这个查询集：

```
brand = get_object_or_404(Brand, shortcut=shortcut)
ads = Ad.objects.filter(mod__submodel__model__brand = brand).values('id') 
```

但由于某种原因，django 执行相同的查询 5 次（查询数不取决于行数）。就这个：

```
SELECT ••• FROM "catalog_ad" INNER JOIN "catalog_mod" ON ("catalog_ad"."mod_id" = "catalog_mod"."id") INNER JOIN "catalog_submodel" ON ("catalog_mod"."submodel_id" = "catalog_submodel"."id") INNER JOIN "catalog_model" ON ("catalog_submodel"."model_id" = "catalog_model"."id") WHERE "catalog_model"."brand_id" = 1 LIMIT 21 
```

那么为什么 django 会执行 5 次相同的查询呢？

**更新：**这只发生在我`ads`像这样传递给上下文处理器时：

```
return render(request, 'cat.html', {ads:ads}) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T07:55:34.513

这是一个非常愚蠢的问题。这只发生在 django 找不到所需的模板并`DEBUG`设置为`true`.

# hibernate - 将实体映射到动态表名

> ID：11381468
> 
> 赞同：0
> 
> 时间：2012-07-08T07:34:00.463
> 
> 标签：hibernate, mapping

我想使用动态表名创建到数据源的休眠映射。这些表反映了旧工具从另一个来源提取的数据集，并且表名本身包含有关表中数据的元信息。每个请求的表名都会改变。

是否可以在休眠中映射它？我正在考虑一些临时拦截器来更改表​​名，但不能真正围绕最好的方法来做这件事。

* * *

2012 年 12 月 7 日编辑

..我可能应该提到只读访问是我所需要的。表格代表“报告”数据，因此不应更改。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T06:02:31.067

由于 sessionfactory 是不可变的，因此使用 hibernate 动态表名并不容易。您每次都需要建立一个新的会话工厂。根据用例，我看到几个选项：

*   **只读：**使用具有固定列别名的 sqlquery 并使用 AliasToBean
*   r* *ead write:* * 使用 xml 映射模板并在每个请求上建立一个新的 sessionfactory（可能很慢）
*   **如果可能的表名在启动时已知：**为每个表名生成一个映射并使用实体名来区分在运行时使用哪个表名

# android - 解组时出现 ClassNotFoundException：android.support.v4.view.ViewPager$SavedState

> ID：11381470
> 
> 赞同：34
> 
> 时间：2012-07-08T07:34:14.223
> 
> 标签：android, android-viewpager, parcelable

我在我的 Android 崩溃报告中看到以下错误：

```
android.os.BadParcelableException: ClassNotFoundException when unmarshalling: android.support.v4.view.ViewPager$SavedState
at android.os.Parcel.readParcelable(Parcel.java:1971)
at android.os.Parcel.readValue(Parcel.java:1859)
at android.os.Parcel.readSparseArrayInternal(Parcel.java:2128)
at android.os.Parcel.readSparseArray(Parcel.java:1581)
at android.os.Parcel.readValue(Parcel.java:1916)
at android.os.Parcel.readMapInternal(Parcel.java:2099)
at android.os.Bundle.unparcel(Bundle.java:223)
at android.os.Bundle.getSparseParcelableArray(Bundle.java:1225)
at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:806)
at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:1083)
at android.support.v4.app.BackStackRecord.run(BackStackRecord.java:635)
at android.support.v4.app.FragmentManagerImpl.execPendingActions(FragmentManager.java:1431)
at android.support.v4.app.FragmentManagerImpl.executePendingTransactions(FragmentManager.java:431)
at android.support.v4.app.FragmentStatePagerAdapter.finishUpdate(FragmentStatePagerAdapter.java:160)
at android.support.v4.view.ViewPager.populate(ViewPager.java:895)
at android.support.v4.view.ViewPager.populate(ViewPager.java:772)
at android.support.v4.view.ViewPager.completeScroll(ViewPager.java:1539)
at android.support.v4.view.ViewPager.computeScroll(ViewPager.java:1422)
at android.view.ViewGroup.drawChild(ViewGroup.java:3028)
at android.view.ViewGroup.dispatchDraw(ViewGroup.java:2788)
at android.view.ViewGroup.drawChild(ViewGroup.java:3184)
at android.view.ViewGroup.dispatchDraw(ViewGroup.java:2788)
at android.view.ViewGroup.drawChild(ViewGroup.java:3184)
at android.view.ViewGroup.dispatchDraw(ViewGroup.java:2788)
at android.view.ViewGroup.drawChild(ViewGroup.java:3184)
at android.view.ViewGroup.dispatchDraw(ViewGroup.java:2788)
at android.view.View.draw(View.java:11017)
at android.widget.FrameLayout.draw(FrameLayout.java:450)
at com.android.internal.policy.impl.PhoneWindow$DecorView.draw(PhoneWindow.java:2175)
at android.view.ViewRootImpl.draw(ViewRootImpl.java:2234)
at android.view.ViewRootImpl.performTraversals(ViewRootImpl.java:1810)
at android.view.ViewRootImpl.handleMessage(ViewRootImpl.java:2695)
at android.os.Handler.dispatchMessage(Handler.java:99)
at android.os.Looper.loop(Looper.java:154)
at android.app.ActivityThread.main(ActivityThread.java:4977)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:511)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
at dalvik.system.NativeStart.main(Native Method) 
```

恢复活动时，它似乎间歇性地发生。我不会在任何代码中直接访问 SavedState 类。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-09-17T20:45:11.943

我有同样的错误，这就是我所做的。

我的问题来自将 ViewPager 与 FragmentStatePagerAdapter 一起使用。ViewPager 中的一个片段内部有另一个 ViewPager。拥有第二个视图寻呼机导致了这个罕见的错误。即使有或没有适配器。

解决方案是简单地设置 setSaveEnabled(false); 在第二个 ViewPager 上。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-12-20T16:34:46.407

以下解决方案对我有用：

```
package android.support.v4.app;

import android.os.Bundle;
import android.view.ViewGroup;

public abstract class FixedFragmentStatePagerAdapter extends FragmentStatePagerAdapter {

  public FixedFragmentStatePagerAdapter(FragmentManager fm) {
    super(fm);
  }

  @Override
  public Object instantiateItem(ViewGroup container, int position) {
    Fragment f = (Fragment)super.instantiateItem(container, position);
    Bundle savedFragmentState = f.mSavedFragmentState;
    if (savedFragmentState != null) {
      savedFragmentState.setClassLoader(f.getClass().getClassLoader());
    }
    return f;
  }

} 
```

来自[http://code.google.com/p/android/issues/detail?id=37484#c1](http://code.google.com/p/android/issues/detail?id=37484#c1)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-12-25T14:54:17.160

如果您不想在 v4 包中包含源代码，您可以直接在适配器中声明“修复”

```
 @Override
    public Object instantiateItem(ViewGroup container, int position) {
        final Object fragment = super.instantiateItem(container, position);
        try {
            final Field saveFragmentStateField = Fragment.class.getDeclaredField("mSavedFragmentState");
            saveFragmentStateField.setAccessible(true);
            final Bundle savedFragmentState = (Bundle) saveFragmentStateField.get(fragment);
            if (savedFragmentState != null) {
                savedFragmentState.setClassLoader(Fragment.class.getClassLoader());
            }
        } catch (Exception e) {
            Log.w("CustomFragmentStatePagerAdapter", "Could not get mSavedFragmentState field", e);
        }
        return fragment;
    } 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2016-09-16T06:34:53.973

在您的活动/片段中，执行以下操作：

```
public void onSaveInstanceState(Bundle outState){
     //This MUST be done before saving any of your own or your base class's     variables
    final Bundle mapViewSaveState = new Bundle(outState);
    mapView.onSaveInstanceState(mapViewSaveState);
    outState.putBundle("mapViewSaveState", mapViewSaveState);
   //Add any other variables here.
   super.onSaveInstanceState(outState);
}

public void onCreate(Bundle savedInstanceState){
   super.onCreate(savedInstanceState);
   final Bundle mapViewSavedInstanceState = savedInstanceState != null ?      savedInstance.getBundle("mapViewSaveState") : null;
 mapView.onCreate(mapViewSavedInstanceState);
 //....
} 
```

来源：[https ://code.google.com/p/gmaps-api-issues/issues/detail?id=6237](https://code.google.com/p/gmaps-api-issues/issues/detail?id=6237)

**或另一种解决方案是：**

map.onCreate(savedInstanceState);

对此：

map.onCreate(null);

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-10-16T21:24:38.113

答案可能会迟到。我使用`FragmentPagerAdapter`而不是使用`FragmentStatePagerAdapter`。像魅力一样为我工作！

# node.js - 我不知道如何使用 nodejs 原生驱动打印 mongodb 查询结果

> ID：11381475
> 
> 赞同：4
> 
> 时间：2012-07-08T07:34:59.653
> 
> 标签：node.js, mongodb

我使用以下命令在数据库中存储一个单词：

```
collection.update({},{$set:{word:newWord}},{upsert:true},function(){
    collection.find().nextObject(function(err, results) {
        oldWord = results;
        console.log("New Word: " + results);
    });
}); 
```

这是我的数据库的一个例子

```
{ "_id" : ObjectId("4ff92def446ce41df5692385"), "word" : "asdf" } 
```

每次到达 console.log 行时，它看起来像：

```
New Word: [object Object] 
```

我试图从上述记录中分离出“asdf”（无引号）。我已经尝试了从 toArray、nextObject 等的所有内容。

我错过了什么？我已经尝试了几个小时！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-08T07:42:59.040

如果您对某个领域感兴趣，您应该打印它，而不是整个对象（主要是因为 Javascript 中对象的字符串表示不是很有帮助）。

```
 console.log("New Word: " + results.word); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-10-21T02:48:20.283

在节点中，您可以只使用：（`console.log("New Word: ", results);`注意逗号）。

另外一个选项：`console.log( JSON.stringify(results) );`

它将打印如下内容：`{ "_id" : "4ff92def446ce41df5692385", "word" : "asdf" }`

我真的不同意“Javascript 中对象的字符串表示不是很有帮助”。至少我觉得很有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T07:45:26.497

您可以覆盖结果对象的 toString 方法，如下所述：http: [//blog.anselmbradford.com/2009/04/05/object-oriented-javascript-tip-overriding-tostring-for-readable-object-imprints /](http://blog.anselmbradford.com/2009/04/05/object-oriented-javascript-tip-overriding-tostring-for-readable-object-imprints/)或 simpy 只需通过指定它来打印要显示的属性`object.propertyname`。

# mysql - Ruby on Rails ActiveRecord::ConnectionNotEstablished

> ID：11381482
> 
> 赞同：0
> 
> 时间：2012-07-08T07:36:10.070
> 
> 标签：mysql, ruby-on-rails

我正在建立一个基本的 RoR 应用程序。我所有的数据库都是 MySQL 和本地的，包括我的数据库，yml 文件。我正在尝试访问基本视图，但仍然收到 ActiveRecord::ConnectionNotEstablished 错误。我究竟做错了什么？

```
# database.yml
development:
  adapter: mysql2
  encoding: utf8
  database: *****_dev
  username: ****
  password: *****
  host: 127.0.0.1
  port: 3306

# Warning: The database defined as "test" will be erased and
# re-generated from your development database when you run "rake".
# Do not set this db to the same as development or production.
test:
  adapter: mysql2
  encoding: utf8
  database: *****_test
  username: ****
  password: *****
  host: 127.0.0.1
  port: 3306

production:
  adapter: mysql2
  encoding: utf8
  database: *****_prod
  username: ****
  password: *****
  host: 127.0.0.1
  port: 3306 
```

gem文件中的MySQL2：

```
gem 'mysql2', '~>0.3.10' 
```

所以当输入：`http://localhost:3000/controller/view`我得到：ActiveRecord::ConnectionNotEstablished

我还可以包括哪些有用的信息？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T14:21:36.440

看看你的`/etc/mysql/my.cnf`并检查 mysql 守护进程的绑定地址。它可能不绑定到任何ip。然后它将使用比 ip 连接更快的 unix 套接字，...

绑定地址的选项名称是，`bind-address`如果没有匹配，它不会绑定到任何地址。还可以查看`socket`which 指定了 unix 套接字的路径。你可以在你的`database.yml`

```
development:
  adapter: mysql2
  encoding: utf8
  database: *****_dev
  username: ****
  password: *****
  socket: /path/to/the/socket/mysql.sock 
```

那应该为你做，...

# ruby-on-rails - “技术”的未定义方法“销毁”：字符串

> ID：11381483
> 
> 赞同：1
> 
> 时间：2012-07-08T07:36:20.453
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, tags

当我去删除一个帖子时，我不断收到一个错误，上面写着

> “技术”的未定义方法“销毁”：字符串

帖子的“技术”部分因我要删除的帖子的标签而异。我不确定问题是什么。`acts_as_taggable_on`如果这与它有任何关系，我正在使用。

这是我的帖子控制器中的销毁方法：

```
 def destroy
     @post = Post.find(params[:id])
     @post.destroy

     respond_to do |format|
       format.html { redirect_to(root_path) }
       format.xml  { head :ok }
       format.json { head :ok }
     end
   end 
```

我帖子中的删除按钮显示：

```
 <%= button_to 'Delete', @post, :method => :delete, :confirm => "Are you sure?" %> 
```

标签以字符串形式保存在数据库中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T08:03:40.387

不可能给你一个答案来解决你的问题，因为你没有给出代码，也没有给出例子。

尽管如此，该错误意味着您正在对字符串调用destroy方法，而Ruby中的字符串没有定义destroy方法。

检查您在哪里调用destroy，因为您似乎是在某个返回字符串（在您的情况下为标签名称）的函数中执行此操作。您必须在作为 Tag 类的实例的对象上执行此操作。

# spring - 如何从 Hibernate 缓存中删除实体

> ID：11381484
> 
> 赞同：0
> 
> 时间：2012-07-08T07:36:29.917
> 
> 标签：spring, hibernate, jpa

我正在使用休眠、弹簧、jpa。在工作流程中，我更新了一个实体；但这些更新在其他工作流程中不可用。当我重新启动服务器时，它工作正常。

有没有办法让我更新实体时；我要求休眠将它从它拥有的任何缓存中删除。这样当任何其他工作流需要该对象时，就会进行新的查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T09:04:58.190

这听起来像您为同一个应用程序有两个单独的会话，因此有两个一级缓存。第一级缓存是 Hibernate 在会话上下文中为自己使用的缓存。因此，如果您不关闭/清除会话，这将继续增长，可能与其他 1 级缓存（在其他线程或其他 VM 中）发生冲突。很难说是不是这样，因为你没有指定你的环境，但是你不能改变另一个会话的一级缓存。

避免这种情况的最佳解决方案是使用托管 EntityManager（来自您的应用程序服务器）来处理实体。然后是服务器的角色来处理这种情况。但似乎您正在以“弹簧方式”进行操作，因此，您必须手动操作：在使用会话后清除会话，或者在读取/更新数据之前进行刷新。然后，您将需要某种锁定（悲观/乐观），以免丢失可能已从另一个线程更改的信息。

# c++ - C++ STL 算法 upper_bound() 严格来说不是更大

> ID：11381487
> 
> 赞同：1
> 
> 时间：2012-07-08T07:37:36.253
> 
> 标签：c++, binary-search, upperbound

与 lower_bound 不同，upper_bound 不返回迭代器到元素，如果它比较等于 value，但只有当它比较严格更大。

如果我想要一个大于或等于的上界算法，是否有替代方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T07:43:53.197

您可以将迭代器减少 1。

```
auto begin = ...;
auto end = ...;
auto it = std::upper_bound(begin, end, target);
if (it == begin)
  return it;
-- it;
if (*it < target)
  return ++it;
else
  return it; 
```

迭代器的位置将是这样的，假设您正在搜索 2：

```
1 1 1 2 2 2 2 3 3 3 3
      ^     ^ ^
      lb    | ub
            this function

1 1 1 1 3 3 3 3
        ^
        lb & ub & this function 
```

# xpath - RapidMiner xpath 文本提取

> ID：11381491
> 
> 赞同：0
> 
> 时间：2012-07-08T07:37:58.437
> 
> 标签：xpath, rapidminer

在 RapidMiner 中，我试图从 div 类“描述”中提取数据。当我使用 Google XPath 导入 XML 测试语法时，它会返回适当的数据。当我在 RapidMiner 中尝试以下操作时，我得到空白结果：

```
//h:div[@id='description']/text() 
```

这有效：

```
//h:div[@id='description'] 
```

但我得到了所有的 HTML 标记数据。

我需要添加或删除什么？

在同一个文档上，我能够得到这个来返回预期的结果：

```
//h:label[@id='desc']/text() 
```

XML:

```
div id="description" class="longdesc" style=" padding-top: 0px; display: block;" xmlns:IDB="urn:ItemDataBinding">Description Text Here./div 
```

# android - Android Google Map API：强制关闭错误

> ID：11381494
> 
> 赞同：2
> 
> 时间：2012-07-08T07:39:09.827
> 
> 标签：android, google-maps

我在运行[Google API 的示例代码时](https://developers.google.com/maps/documentation/android/hello-mapview)收到强制关闭错误消息。更新项目是否是此类项目的解决方案？如果是这样，那么如何更新窗口上的项目。[这里](https://stackoverflow.com/questions/8559336/how-to-update-old-android-project-for-the-updates-in-new-android-sdk-tools)给出的方法不适用于我的情况。

这是代码

文件名：HelloGoogleMaps.java

```
 package com.hellogooglemaps.practices;

    import com.google.android.maps.MapActivity;
    import com.google.android.maps.MapView;
    import android.os.Bundle;

    public class HelloGoogleMaps extends MapActivity {
     /** Called when the activity is first created. */
  @Override
   protected boolean isRouteDisplayed(){
    return false;
}

@Override 
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    MapView mapView = (MapView)findViewById(R.id.mapview);
    mapView.setBuiltInZoomControls(true);

}
@Override
protected boolean isLocationDisplayed(){
    return true;
}
} 
```

HelloGoogleMaps 清单

```
<uses-sdk android:minSdkVersion="8" />
<uses-permission android:name="android.permission.INTERNET"/>
<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name" >
    <activity
        android:label="@string/app_name"
        android:name=".HelloGoogleMapsActivity" >
        <intent-filter >
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>        
    </activity>
    <activity android:name=".HelloGoogleMaps" android:label="@string/app_name"
          android:theme="@android:style/Theme.NoTitleBar" />
    <uses-library android:name="com.google.android.maps"/>
</application> 
```

主要的.xml

```
 <?xml version="1.0" encoding="utf-8"?>
    <com.google.android.maps.MapView
     xmlns:android="http://schemas.android.com/apk/res/android"
            android:id="@+id/mapview"
             android:layout_width="fill_parent"
             android:layout_height="fill_parent"
             android:clickable="true"
             android:apiKey="0_hYeORLgQUROOOr_RXN2TWG2u2pCDoBYfLCV_w"
             /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T08:06:20.700

正如您在代码中提到的那样，您只有一个 Activity 被调用`HelloGoogleMaps`，并且`AndroidManifest`您已经声明了两个 Activity！你`HelloGoogleMapsActivity`的没用。您收到错误是因为您将 HelloGoogleMapsActivity 设置为 Launcher 活动，而此活动甚至不存在！

**解决方案：** 改变你的`AndroidManifest.xml`方式，如果你成功地为你的地图正确获取了 apikey，你将让你的应用程序正常工作：

```
<uses-sdk android:minSdkVersion="8" />
<uses-permission android:name="android.permission.INTERNET"/>
<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name" >
    <activity
        android:label="@string/app_name"
        android:theme="@android:style/Theme.NoTitleBar"
        android:name=".HelloGoogleMaps" >
        <intent-filter >
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>        
    </activity>
    <uses-library android:name="com.google.android.maps"/>
</application> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T04:11:56.763

在面对`Force close Error`很多次之后，我发现这些类型的错误非常普遍，并且是由于`undefined behavioral`.Like 当我们声明 Button 而没有为其分配视图时，我们在另一个函数上使用它。由于未正确处理异常，也会出现这种情况。或由于资源不可用，您正尝试在模拟器中访问，例如联系电话。解决此类问题的最佳方法是使用日志并在我们感到困惑的地方打印一些消息并使用 logcat。

*在上述情况下，由于HelloGoogleMapsActivity*类中的未定义行为，我收到了强制关闭错误

# uitableview - 如何将数据从 DetailViewController 的子视图传递到 MasterViewController？

> ID：11381496
> 
> 赞同：1
> 
> 时间：2012-07-08T07:39:15.810
> 
> 标签：uitableview, nsfetchedresultscontroller, uistoryboard, ipad

我有一个 iPad 故事板驱动的应用程序，它使用拆分视图来显示主视图和详细视图。

DetailViewController 有一个子 UITableViewController，它在 DetailViewController 中填充原型 UITableView。UITableViewController 使用 NSFetchedResultsController 来管理数据检索，以方便将数据与 UITableView 一起使用。

MasterViewController 包含另一个 UITableView，其中填充了 UITableViewController 中包含的数据子集。

我遇到的问题是我需要 MasterViewController 能够从 NSFetchedResultsController 记录集中更新它的内容，但发现我不能为此目的使用委托，因为 UITableViewController 是 DetailViewController 的子项，即MasterViewController 的一个孩子。

虽然我知道我可以使用 NSNotificationCenter 来执行此操作，但我希望我可以通过视图层次结构将相关数据传递回 MasterViewController。我曾考虑将 FRC 中的数据加载到实例变量中，并使用 KVO 触发 DetailViewController 上的委托方法，但这似乎很复杂。 这是目前设置的概述：

`MasterViewController --> DetailViewController --> UITableViewController.NSFetchedResultsController`

谁能建议实现这一目标的最佳方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T09:08:05.827

`NSNotification`我通过使用和 方法解决了这个问题`postNotificationName:object:userInfo:`，将值的 NSDictionary 作为 userInfo 传递。然后我将我的 MasterViewController 设置为侦听通知并处理 NSDictionary 以更新自身。

这符合 Apple 制定的编程指南，还允许我在我的应用程序的任何地方传递相同的信息。

更多细节在这里：[通知编程主题](http://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/Notifications/ "通知编程主题")

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T08:05:08.660

我将使用 NSFetchedResultsController 的另一个实例将数据提供给 MasterViewController 中的表视图。

# c - 将一个字符串分配给另一个字符串

> ID：11381497
> 
> 赞同：0
> 
> 时间：2012-07-08T07:39:34.723
> 
> 标签：c

为什么这段代码没有运行？为什么 str1 没有分配给 str2 ？我知道我可以选择使用 strcpy 但我想知道这不起作用的原因？

```
#include<stdio.h>
int main()
{
char str1[]="hello";
char str2[10];
str2=str1;
printf("%s",str2);
return 0;
} 
```

而如果我使用指针而不是像这里一样工作..

```
#include<stdio.h>
int main()
(
char *s="good morning";
char *q;
q=s;
while(*q!='\0')
{
printf("%c",*q);
q++;
}
return 0;
} 
```

这行得通。现在字符串已经通过指针复制了，为什么会有这样的差异呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T07:43:06.117

`str2`是一个静态数组。您不能像指针一样重新分配它。

至于您的指针示例，`q=s`重新分配`q`以指向指向的相同空间`s`。但是，指针重新分配不会**复制**该值。

对于静态数组，用于`strcpy()`复制值。对于指针，使用`strdup()`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T07:41:33.740

你需要做

`strcpy (str2, str1)`

您需要逐个字符地复制`str1` to的每个元素。`str2`

您正在做的是尝试将分配中的字符串地址分配给不允许`str1`的数组 var 。`str2`静态数组不能用于赋值。

即使你有`char *str2;`然后`str2 = str1`虽然你的代码可以工作，但在这种情况下，字符串不会被复制，而是字符串的地址`str1`被复制，`str2`所以现在取消引用`str2`将指向字符串

另请注意，当您将字符串复制到a 时，`char *str2`总是在复制之前分配足够的内存。一种可能性是：

```
str2 = malloc (sizeof (char) * (strlen (str1) + 1));
strcpy (str2, str1); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T07:44:50.143

`str2`并`str1`引用它们的第一个元素的地址，因此数组的分配不是以这种方式完成的，要么使用`str[]`按字符分配字符，要么使用内置`strcpy`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-08T07:45:59.227

您还可以使用 strdup() 来分配存储副本所需的确切空间量。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-08T09:02:31.190

在 C 中，您只能分配具有*类型*的对象；在 C 中，字符串不是数据类型。相反，它是一个约定——约定是字符串由以空字符结尾的字符数组表示；并且因为数组不被视为类型，字符串也不是。

在您的第二个代码片段中，您只需`q`指出`s`; 这不是字符串 at的*副本*`s`，而仅仅是指针 's' 的副本。它们都引用内存中的相同数据。因此，例如，如果您更改了 's' 处的字符串，然后打印了 'q' 处的字符串，您将看到 'q' 处的数据也发生了变化。如果你这样做了`printf( "s:%p, q:%p" (void*)s, (void*)q ) ;` ，你会更直接地看到它们都持有相同的指针值。

# c# - 使用 Visual Studio 2010 在 Windows 窗体中创建线条？

> ID：11381498
> 
> 赞同：4
> 
> 时间：2012-07-08T07:39:46.637
> 
> 标签：c#, visual-studio-2010

我想知道是否可以在 windows 窗体的设计中添加一行？我在工具箱中找不到任何工具？或者在视觉工作室或代码中是否有其他方法可以做到这一点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-08T07:58:57.670

WinForms 没有内置控件来执行此操作。您可以使用该`GroupBox`控件，将`Text`属性设置为空字符串，并将其高度设置为`2`. 这将模仿压纹线。否则，您需要创建自定义控件并自己绘制线条。

对于自定义控件，这是一个示例。

```
using System.ComponentModel;
using System.Drawing;
using System.Windows.Forms;

namespace WindowsFormsApplication12
{
    public partial class Line : Control
    {
        public Line() {
            InitializeComponent();
        }        

        private Color m_LineColor = Color.Black;
        /// <summary>
        /// Gets or sets the color of the divider line
        /// </summary>
        [Category("Appearance")]
        [Description("Gets or sets the color of the divider line")]
        public Color LineColor {
            get {
                return m_LineColor;
            }
            set {
                m_LineColor = value;
                Invalidate();
            }
        }

        protected override void OnPaint(PaintEventArgs pe) {
            using (SolidBrush brush = new SolidBrush(LineColor)) {
                pe.Graphics.FillRectangle(brush, pe.ClipRectangle);
            }
        }
    }
} 
```

它只是`ClientRectangle`用指定的填充`LineColor`，所以线条的高度和宽度就是控件本身的高度和宽度。相应调整。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T08:18:23.520

```
public void DrawLShapeLine(System.Drawing.Graphics g, int intMarginLeft, int intMarginTop, int intWidth, int intHeight) 
    { 
        Pen myPen = new Pen(Color.Black); 
        myPen.Width = 2; 
        // Create array of points that define lines to draw. 
        int marginleft = intMarginLeft; 
        int marginTop = intMarginTop; 
        int width = intWidth; 
        int height = intHeight; 
        int arrowSize = 3; 
        Point[] points = 
         { 
            new Point(marginleft, marginTop), 
            new Point(marginleft, height + marginTop), 
            new Point(marginleft + width, marginTop + height), 
            // Arrow 
            new Point(marginleft + width - arrowSize, marginTop + height - arrowSize), 
            new Point(marginleft + width - arrowSize, marginTop + height + arrowSize), 
            new Point(marginleft + width, marginTop + height) 
         }; 

        g.DrawLines(myPen, points); 
    } 
private void Form1_Paint(object sender, PaintEventArgs e) 
{ 
   DrawLShapeLine(e.Graphics, 10, 10, 20, 40); 
} 
```

[有关在 Winforms 中绘制线条](https://stackoverflow.com/questions/1078137/drawing-a-line-in-winforms)的更多信息，请参阅以下链接

# font-face - Windows 中的剪切字体（字体松鼠）

> ID：11381505
> 
> 赞同：1
> 
> 时间：2012-07-08T07:40:38.017
> 
> 标签：font-face

我正在使用字体松鼠。MacOSX 或 ipad 上一切正常。但是我的Windows机器有问题。

字体只是被剪掉了。

它是图片底部的原始字体（DinCond）。 [http://postimage.org/image/b3apbrwtd/](http://postimage.org/image/b3apbrwtd/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T08:52:57.930

据此，较细的和紧凑的字体通常有这个问题。 [http://www.fontsquirrel.com/blog/2009/11/what-to-expect-from-our-font-face-generator](http://www.fontsquirrel.com/blog/2009/11/what-to-expect-from-our-font-face-generator)

这可能会引发一些尝试： [http](http://www.fontsquirrel.com/forum/discussion/74/webkit-font-rendering-on-windows-xp/p1) ://www.fontsquirrel.com/forum/discussion/74/webkit-font-rendering-on-windows-xp/p1 可能想要使用 CSS 别名设置

您可以随时尝试 Cufon 并在 TypeKit 上花一点钱

# c++ - 指针传递指针不起作用

> ID：11381506
> 
> 赞同：0
> 
> 时间：2012-07-08T07:40:38.563
> 
> 标签：c++, parameter-passing

```
//binary_tree.h file
typedef struct node node;

struct node
{   node():left(0), right(0), value(-1){};
    ~node(){if(left) delete left; if(right) delete right;};
    node *left;
    node *right;
    int value;
};

inline void insert_node(node **root, node *new_node)
{
    assert(new_node != NULL);
    if(*root == NULL)
    {
        *root = new_node;
    }
    else
    {
        node *itr = *root;
        while(1)
        {
            if(itr->value > new_node->value)
                itr = itr->left;
            else
                itr = itr->right;
            if(!itr)
            {
                itr = new_node;
                break;
            }
        }
    }
}

inline void inorder_print(node *root)
{
    if(!root) return;
    inorder_print(root->left);
    printf("%d\n", root->value);
    inorder_print(root->right);
}

//main.cpp file
#include "binary_tree.h"

int main()
{
    node *node1 = new node();
    node *node2 = new node();
    node *node3 = new node();
    node *node4 = new node();
    node *node5 = new node();

    node1->value = 5;
    node2->value = 10;
    node3->value = 3;
    node4->value = 1;
    node5->value = 4;   

    node *binary_tree = NULL;

    insert_node(&binary_tree, node1);
    insert_node(&binary_tree, node2);
    insert_node(&binary_tree, node3);
    insert_node(&binary_tree, node4);
    insert_node(&binary_tree, node5);

    assert(binary_tree != NULL);
    inorder_print(binary_tree);

    return 0;
} 
```

我有一个非常简单的程序，我想创建一个二叉树并打印它。然而，下面显示的代码段不会改变树结构。

```
 node *itr = *root;
        while(1)
        {
            if(itr->value > new_node->value)
                itr = itr->left;
            else
                itr = itr->right;
            if(!itr)
            {
                itr = new_node;
                break;
            }
        } 
```

inorder_print 函数总是打印 '5'

问题是使用“itr”变量。我真的不明白如何在不使用局部变量或更改指向根的指针的情况下做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T07:43:46.410

您的插入例程只会将一个节点插入根。

```
 if(!itr)
        {
            itr = new_node;
            break;
        } 
```

由于`itr`是局部变量，`new_node`实际上并没有被插入。`itr`您可以通过创建一个指向像根这样的指针的指针来纠正这个问题。

```
 node **itr = root;
    while(1)
    {
        if((*itr)->value > new_node->value)
            itr = &(*itr)->left;
        else
            itr = &(*itr)->right;
        if(!*itr)
        {
            *itr = new_node;
            break;
        }
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T11:09:51.640

使用 std::set。您的代码似乎是旧的 C 代码。成为 C++：

```
#include <set>
#include <iostream>

int main()
{
    std::set<int> binary_tree;
    binary_tree.insert(5);
    binary_tree.insert(10);
    binary_tree.insert(3);
    binary_tree.insert(1);
    binary_tree.insert(4);   

    //inorder_print(binary_tree);
    for (std::set<int> i = binary_tree.begin(); i != binary_tree.end(); ++i)
        std::cout << *i  << std::endl;
} 
```

# java - 对 appengine cuota 详细信息的无法解释的请求

> ID：11381509
> 
> 赞同：0
> 
> 时间：2012-07-08T07:41:23.743
> 
> 标签：java, google-app-engine

我有一个页面，我将它用作 facebook 上的应用程序。它没有用户没有访问，但配额详细信息显示我在一天结束时有 22% 的前端。在日志中没有请求。为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T16:34:15.297

请阅读对这篇文章的评论了解“ ['前端实例小时'](https://groups.google.com/forum/?fromgroups#!topic/google-appengine/GZmR7CcFhwM) ”，同时阅读[计费文档](https://developers.google.com/appengine/kb/billing#idle_instances) 和[性能设置文档](https://developers.google.com/appengine/docs/adminconsole/performancesettings#Setting_the_Number_of_Idle_Instances)中的信息。

# java - Java - 创建文件和目录

> ID：11381513
> 
> 赞同：0
> 
> 时间：2012-07-08T07:41:41.700
> 
> 标签：java

假设`final String fname = "/dir1/dir2/fname.ext"`。如果目录不存在，我不希望递归地解析字符串以创建目录，然后才写入文件。`fname`如果每个目录和文件都不存在，我希望使用给定的字符串 ,来创建目录和文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T07:45:38.567

这是您正在寻找的代码：

```
File myFile = new File("/dir1/dir2/fname.ext");
myFile.getParentFile().mkdirs();
// do your writing being sure the parent directories exist. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T07:45:40.513

您可以使用 mkdirs 创建路径。

```
File f = new File("/dir1/dir2/fname.ext");
f.getParentFile().mkdirs(); 
```

然后处理文件本身。

# gcc - 编译 OpenSSL 时未定义的引用

> ID：11381514
> 
> 赞同：5
> 
> 时间：2012-07-08T07:41:52.120
> 
> 标签：gcc, makefile, openssl

我不知道在这里做什么，我跑了`make`，得到了这个：

```
make[2]: Entering directory `/tmp/openssl-1.0.1/test'
( :; LIBDEPS="${LIBDEPS:--L.. -lssl -L.. -lcrypto  -ldl}"; LDCMD="${LDCMD:-gcc}"; LDFLAGS="${LDFLAGS:--DOPENSSL_THREADS -D_REENTRANT -DDSO_DLFCN -DHAVE_DLFCN_H -fno-exceptions -Wa,--noexecstack -m64 -DL_ENDIAN -DTERMIO -O3 -Wall -DOPENSSL_IA32_SSE2 -DOPENSSL_BN_ASM_MONT -DOPENSSL_BN_ASM_MONT5 -DOPENSSL_BN_ASM_GF2m -DSHA1_ASM -DSHA256_ASM -DSHA512_ASM -DMD5_ASM -DAES_ASM -DVPAES_ASM -DBSAES_ASM -DWHIRLPOOL_ASM -DGHASH_ASM}"; LIBPATH=`for x in $LIBDEPS; do echo $x; done | sed -e 's/^ *-L//;t' -e d | uniq`; LIBPATH=`echo $LIBPATH | sed -e 's/ /:/g'`; LD_LIBRARY_PATH=$LIBPATH:$LD_LIBRARY_PATH ${LDCMD} ${LDFLAGS} -o ${APPNAME:=rc4test} rc4test.o ${LIBDEPS} )
rc4test.o: In function `main':
rc4test.c:(.text+0x30): undefined reference to `OPENSSL_cpuid_setup'
collect2: ld returned 1 exit status
make[2]: *** [link_app.] Error 1
make[2]: Leaving directory `/tmp/openssl-1.0.1/test'
make[1]: *** [rc4test] Error 2
make[1]: Leaving directory `/tmp/openssl-1.0.1/test'
make: *** [build_tests] Error 1 
```

我认为这是 gcc 的事情，但我不知道如何处理这个问题。我应该手动编译吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-08-13T18:54:16.403

我遇到了同样的问题，并且能够通过添加`-DOPENSSL_PIC`到配置调用来解决它：

```
./config -fPIC -DOPENSSL_PIC 
```

# bash - 比较两个文件中最接近匹配的字段

> ID：11381516
> 
> 赞同：0
> 
> 时间：2012-07-08T07:42:15.573
> 
> 标签：bash, sed, awk, computational-geometry

我正在尝试将一个文件中的经纬度位置解析为另一个文件中的几个命名字段。

我有一个文件是这样的..

```
 f1--f2--f3--------f4--------                f5---
 R               20175155 41273951N078593973W                18012              
 R               20175156 41274168N078593975W                18000              
 R               20175157 41274387N078593976W                17999              
 R               20175158 41274603N078593977W                18024              
 R               20175159 41274823N078593978W                18087 
```

每个字符都在一个特定的位置，所以我需要根据字符定义字段。

f1 字符 18-21; f2 字符 22 - 25; f3 字符 26-35；f4 字符 36-45；f5 字符 62-66。

我有另一个更大的 csv 文件，其中包含对应于 f3、f4、f5 的字段 11、12 和 13。

```
awk -F',' '{print $11, $12, $13}'
41.46703821 -078.98476926 519.21
41.46763555 -078.98477791 524.13
41.46824123 -078.98479015 526.67
41.46884129 -078.98480615 528.66
41.46943371 -078.98478482 530.50 
```

我需要在文件 2 字段 11 && 12 中找到与文件 1 字段 1 && 2 最接近的匹配项；

当找到最接近的匹配项时，我需要将文件 1 中的字段 1、2、3、4、5 插入文件 2 字段 16、17、18、19、20。

如您所见，格式略有不同。文件1像这样分解..

文件 1

```
f3-------f4--------

DDMMSSdd DDDMMSSdd 

41273951N078593973W 
```

文件 2

```
f11-------- f12---------

DD dddddddd  DDD dddddddd

41.46703821 -078.98476926 
```

N 表示 f3 为正数，W 表示 f4 为负数。

我用 sed 更改了文件 1，可笑的一个衬里效果很好.. **（更好的方法？？？）**

```
cat $file1 |sed 's/.\{17\}//' |sed 's/\(.\{4\}\)\(.\{4\}\)\(.\{9\}\)\(.\)\(.\{9\}\)\(.\)\(.\{16\}\)\(.\{5\}\)/\1,\2,\3,\4,\5,\6,\8/'|sed 's/\(.\{10\}\)\(.\{3\}\)\(.\{2\}\)\(.\{2\}\)\(.\{2\}\)\(.\{3\}\)\(.\{3\}\)\(.\{2\}\)\(.*\)/\1\2,\3,\4.\5\6\7,\8\9/'|sed 's/\(.\{31\}\)\(.\{2\}\)\(.*\)/\1,\2.\3/' 
```

2017,5155, 41,27,39.51,N,078,59,39.73,W,18012
2017,5156, 41,27,41.68,N,078,59,39.75,W,18000
2017,5157, 41,27, 43.87,N,078,59,39.76,W,17999
2017,5158, 41,27,46.03,N,078,59,39.77,W,18024
2017,5159, 41,27,48.23,N,078,59, 39.78,W,18087

现在我必须转换格式.. **（解决了这个（见下文）--问题--数字四舍五入太远了。我需要至少有六个小数位。）**

```
awk -F',' '{for (i=1;i<=NF;i++) {if (i <= 2) printf ($i","); else if (i == 3&&$6 == "S") printf("-"$3+($4/60)+($5/3600)","); else if (i == 3&&$6 == "N") printf($3+($4/60)+($5/3600)","); else if (i == 7&&$10 == "W") printf("-"$7+($8/60)+($9/3600)","); else if (i == 7&&$10 == "E") printf($7+($8/60)+($9/3600)","); if (i == 11) printf ($i"\n")}}' 
```

2017,5155,41.461， -78.9944,18012 2017,5156,41.4616
， -78.9944,18000

这就是我所在的地方。

**解决了这个** **我需要从这个公式中得到至少有 6 个小数位的数字格式。**

**printf($3+($4/60)+($5/3600))** 添加了“%.8f”

**printf("%.8f", $3+($4/60)+($5/3600))**

下一个问题是将**字段文件 1 f3 和 f4 与文件 2 f11 和 f12 中最接近的匹配项进行匹配。**

有任何想法吗？

然后我需要计算字段之间的距离。

在 Excel 中，公式将是这样的..

```
=ATAN2(COS(lat1)*SIN(lat2)-SIN(lat1)*COS(lat2)*COS(lon2-lon1), SIN(lon2-lon1)*COS(lat2)) 
```

**我可以用什么来计算？**

****更新---我正在寻找匹配位置的短距离。我正在考虑将诸如毕达哥拉斯定理之类的简单方法应用于最接近的匹配。甚至可能使用更少的小数位。它必须快很多倍。也许是这样的..* ***

```
x = (lon2-lon1) * Math.cos((lat1+lat2)/2);

y = (lat2-lat1);

d = Math.sqrt(x*x + y*y) * R; 
```

然后我可以在最终文件更新后进行更准确的大量计算。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T09:34:52.733

执行最接近匹配后无法进行距离计算：最接近是通过比较距离值定义的。awk 可以评估您想要的公式（看起来像大圆距离？）。看看[这一章](http://polymer.bu.edu/~fding/sedawk/ch09_01.htm)，看看你需要什么。

最大的问题是找到最近的匹配。编写一个 awk 脚本，该脚本采用文件 1 的单行并输出文件 2 中的行和一个额外的列。该列是根据您的距离公式计算一对点之间的距离。如果您按数字 ( `sort -n`) 对该文件进行排序，那么最接近的匹配项位于顶部。然后你需要一个循环遍历文件 1 中每一行的脚本，调用你的 awk 脚本，用来`head -n1`提取最接近的匹配，然后以你想要的格式输出。

这在 bash 和 awk 中都是可能的，但在 Python 中它会是一个更简单的脚本。取决于你喜欢哪个。

# jquery - jQuery：如何在文本节点之后添加元素？

> ID：11381518
> 
> 赞同：1
> 
> 时间：2012-07-08T07:42:32.387
> 
> 标签：jquery

假设我有以下标记：

```
<h1>Hello</h1> 
```

现在，我想在`<span id="foo" class="bar">world</span>`之后添加，`Hello`这样我就有了结果标记：

```
<h1>Hello<span id="foo" class="bar">world</span></h1> 
```

我如何在 jQuery 中做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-08T07:44:48.883

```
$("h1").append( '<span id="foo" class="bar">world</span>' ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T07:50:13.157

**演示** [http://jsfiddle.net/3zc3N/3/](http://jsfiddle.net/3zc3N/3/)几种方法可以实现这个**或** [http://jsfiddle.net/3zc3N/6/](http://jsfiddle.net/3zc3N/6/)

**代码**

```
$("h1").html($('h1').text() + ' <span id="foo" class="bar">world</span>'); 
```

或者

上一个：http: [//jsfiddle.net/3zc3N/](http://jsfiddle.net/3zc3N/)

```
$("h1").append(' <span id="foo" class="bar">world</span>'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T09:19:09.997

嗨，你可以简单地使用 .append 语句来做到这一点，即

```
 $('#heading').append($('<span />').text(' World')); 
```

如此处所示[http://jsfiddle.net/R5CpP/1/](http://jsfiddle.net/R5CpP/1/)

# sqlite - 将变量更新到 sqlite

> ID：11381527
> 
> 赞同：0
> 
> 时间：2012-07-08T07:44:12.937
> 
> 标签：sqlite

我正在尝试将变量更新到 sqlite3 数据库中。该查询在 sqlite 浏览器中运行，但是当我想通过我的网络进行更新时，它给了我“致命错误：调用非对象上的成员函数 execute()”。

```
Code:
$DB = new PDO('sqlite:database/Sample.sqlite3');
$No = 1;
$Name = 'John';
$RecordNo = 2;
$statement ="update Sample set No =".$No.", Name='".Name."', Date='2012-05-14' where RecordNo=".$RecordNo;
$update = $DB->prepare($statement);
$update->execute(); 
```

致命错误出现在 '$update->execute();' 的语句中 它应该在哪里执行，因为没有语法错误或代码。好心提醒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T08:24:07.980

替代...

```
<?php
$DB = new PDO('sqlite:database/Sample.sqlite3');
/* Execute a prepared statement by passing an array of insert values */
$No = 1;
$Name = 'John';
$RecordNo = 2;
$sth = $dbh->prepare('update sample set No=? Name=? Date='2012-05-14' where Recordno =?');
$sth->execute(array($No, $Name,$RecordNo));
?> 
```

# php - 将类对象作为参数传递给函数

> ID：11381532
> 
> 赞同：1
> 
> 时间：2012-07-08T07:45:30.180
> 
> 标签：php

```
include_once 'showData.php'; 
class dbInsertion { 
function db_insertShow($showData_obj)
{} 
```

$showData 是一个类对象我如何在这个 db_insertShow 函数中获取它的数据成员

这是类showdata

```
class ShowData {
  var $show_id;
  var $type_id;
  var $priority;
  var $name;
  var $sDescription;
  var $lDescription;
  var $bookinguntil;
  var $runtime;
  var $matinee;
  var $evening;
  var $pricefrom;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T08:10:28.857

在您的班级中，您可以像这样检索成员：

```
class dbInsertion { 
    function db_insertShow($showData_obj)
    {
        $show_id = $showData_obj->show_id;
        ...
    } 
} 
```

此外，您可能想看看 getter 和 setter 的概念。本质上，它们只是用于检索和设置成员的方法。使用 getter 和 setter 的好处是，您可以做一些额外的事情，这些事情在检索成员时可能需要。为此，您应该将您的成员定义为私有的。

```
class ShowData {
    private $show_id;

    public function setShow_id($show_id) {
        $this->show_id = $show_id;
    }

    public function getShow_id() {
        return $this->show_id;
    }
} 
```

然后，您可以像这样访问成员，而不是上面的示例：

```
class dbInsertion { 
    function db_insertShow($showData_obj)
    {
        $show_id = $showData_obj->getShow_id();
        ...
    } 
} 
```

# sql - 自动生成层次结构值

> ID：11381537
> 
> 赞同：9
> 
> 时间：2012-07-08T07:45:50.230
> 
> 标签：sql, sql-server, sql-server-2008, sql-server-2008-r2

我有一个带有列的树表`ID`，`ParentID`并且`Hierarchy`想要生成`Hierarchy`依赖于的列值`ParentID`。为此，我使用触发器。是否存在更好的方法来生成层次列值？

```
ALTER TRIGGER [TR_MyTable_BeforInsert] ON [MyTable]
INSTEAD OF INSERT
AS BEGIN
SET NOCOUNT ON;
Declare @Name NVarChar(100),
        @ParentID Int

Declare DACategory Cursor For
Select  A.Name, A.ParentID
From    Inserted A
OPEN    DACategory
FETCH NEXT FROM DACategory INTO @Name, @ParentID
While @@FETCH_STATUS=0 Begin

    Insert Into MyTable (Name, ParentID, Hierarchy)
    Values (@Name, @ParentID, dbo.F_MyTableGetHID(NULL, @ParentID))

    FETCH NEXT FROM DACategory INTO @Name, @ParentID
End
Close   DACategory
Deallocate DACategory
END 
```

功能 ：

```
ALTER FUNCTION [F_MyTableGetHID]
(
    @ID int,
    @ParentID int
)
RETURNS HierarchyID

AS BEGIN
    Declare @RootHID HierarchyID, 
            @LastHID HierarchyID

    IF (@ParentID IS NULL)Begin
        Set @RootHID = HierarchyID::GetRoot()
        Select @LastHID = Max(Hierarchy) From MyTable Where ParentID IS NULL
    End Else Begin
        Select @RootHID = Hierarchy From MyTable Where ID = @ParentID
        select @LastHID = Max(Hierarchy) From MyTable where ParentID = @ParentID
    End
    return @RootHID.GetDescendant(@LastHID, NULL)
END 
```

`ParentID`对于更新此表也有触发器在更改时再次设置层次结构列。

**这个问题的最佳实践是什么？**

**编辑 1**：如果可能，我查找不使用触发器的解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-04T08:20:23.570

我有不同的方法来回答这两个问题。我通常避免使用触发器，直到它是最后的选择，因为它会在数据库上增加不必要的开销。

触发器和存储过程的比较

*   在数据库中查看表关系、约束、索引、存储过程很容易，但很难查看触发器。
*   触发器执行对客户端应用程序不可见。它们不可见或可以在调试代码中跟踪。
*   很容易忘记触发器，如果​​没有文档，新开发人员将很难弄清楚它们的存在。
*   每次更新数据库字段时都会运行触发器，这会增加系统开销。它使系统运行更慢。

说得够多了，这就是为什么我更喜欢存储过程。您可以通过代理创建一个作业文件（例如 ex ：它每 30 分钟或任何其他时间执行一次）。您可以使用该逻辑插入该作业文件。这样，您的数据`tree table`将接近实时。

现在参考创建代理： http:
[//msdn.microsoft.com/en-us/library/ms191128 (v=sql.90).aspx](http://msdn.microsoft.com/en-us/library/ms191128(v=sql.90).aspx)
[http://msdn.microsoft.com/en-us/library/ms181153 (v=sql.105).aspx](http://msdn.microsoft.com/en-us/library/ms181153(v=sql.105).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-03T10:15:07.047

您要求最佳实践。

最佳实践是不使用邻接列表模型（这是您所拥有的），而是切换到嵌套集模型。

它更难编码和理解，这就是它不那么受欢迎的原因，但它更灵活。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-04T18:50:41.793

## 在这种情况下，您应该使用不带游标的触发器

```
ALTER TRIGGER [TR_MyTable_BeforInsert] ON [MyTable]
INSTEAD OF INSERT
AS 
BEGIN
    SET NOCOUNT ON;
    Insert Into MyTable (Name, ParentID, Hierarchy)
    Select Name, ParentID, dbo.F_MyTableGetHID(NULL, ParentID)
    From inserted
END 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-06T05:12:11.313

给定父级的外键，您可以创建一个计算 hierarchyid 值的函数。然后你可以调用这个函数作为列的默认值计算器。如果您阻止用户插入此列，则将始终应用默认值。

仅当父子关系不可更新时，此解决方案才有效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-05T22:16:26.647

不需要光标

只需使用

```
Insert Into MyTable (Name, ParentID, Hierarchy) 
 select Name, ParentID, dbo.F_MyTableGetHID(NULL, ParentID)   
  from inserted 
```

你能解释一下功能吗？不知道它在做什么。但看起来它可以变成一个查询，因此可以与上面结合起来——最佳实践总是在关系数据库上做集合论

# javascript - IE9 和 Iframe 加载事件

> ID：11381541
> 
> 赞同：1
> 
> 时间：2012-07-08T07:46:32.013
> 
> 标签：javascript, internet-explorer, iframe, onload

在我的网站中，我有一个表单，允许用户将图像或视频发布到 Facebook。因为我需要将文件直接发布到 Facebook，所以我使用的是发布到 iframe 的表单（为了防止在发送帖子后将用户重定向到 Facebook 帖子网址）。

在发送帖子时（请注意，帖子是发送到 Facebook 域而不是我自己的域），我向用户显示一条等待消息，当帖子完成时，我使用 iframe`onload`事件隐藏信息。

这是代码：

**内嵌框架：**

```
<iframe name="uploader" width=2px height=2px style="visibility: hidden" onLoad="locationChange(this)"></iframe> 
```

**加载 iframe 时隐藏消息的 JavaScript：**

```
function locationChange(ifrm) 
{
    alert("Iframe Change");
    document.getElementById("loadingOff").style.visibility = "hidden";
} 
```

这适用于除 IE9 之外的所有浏览器。第一次进入页面时，我可以在 IE9 上看到“Iframe Change”消息。但是在发送帖子后我看不到它（在 Chrome 和 FireFox 上，我看到两次消息，当我进入页面时和发送帖子后）。

我也试过用这个：

```
<script type='text/javascript'>
 var iframe = document.getElementsByName("uploader");

 alert(iframe.toString());

 iframe.onload = iframe.onreadystatechange = function(){
     if( this.readyState && this.readyState !== "complete" && this.readyState !== "loaded" )
     {
           alert("Not loaded");
     }
    alert("Local iframe is now loaded");
 }         
</script> 
```

还有这个：

```
if (iframe.attachEvent){
    iframe.attachEvent("onload", function(){
        alert("Local iframe is now loaded.");
    });
} else {
    iframe.onload = function(){
        alert("Local iframe is now loaded.");
    };
} 
```

但是最后两个在任何浏览器上都不起作用。如何将`onload`事件附加到 IE9 ？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T07:59:49.980

`getElementsByName` 返回元素数组。

所以写

```
var iframe = document.getElementsByName("uploader")[0]; 
```

代替

```
var iframe = document.getElementsByName("uploader"); 
```

# c# - 为所有可能的数字生成一个随机 Int32

> ID：11381542
> 
> 赞同：1
> 
> 时间：2012-07-08T07:46:58.970
> 
> 标签：c#, random

如果我想为 Int32 可以包含的所有可能的数字生成一个随机数，那么下面的代码是一种合理的方法吗？有什么理由说明它可能不是一个好主意吗？（即均匀分布至少与 Random.Next() 本身一样好）

```
 public static int NextInt(Random Rnd) //-2,147,483,648 to 2,147,483,647
    {
         int AnInt;
         AnInt = Rnd.Next(System.Int32.MinValue, System.Int32.MaxValue);
         AnInt += Rnd.Next(2);
         return AnInt;
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T08:16:54.683

您可以使用[`Random.NextBytes`](http://msdn.microsoft.com/en-us/library/system.random.nextbytes)获取 4 个字节，然后使用[`BitConverter.ToInt32`](http://msdn.microsoft.com/en-us/library/system.bitconverter.toint32)将它们转换为`int`.

就像是：

```
byte[] buf = new byte[4];
Rnd.NextBytes(buf);
int i = BitConverter.ToInt32(buf,0); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-08T08:26:53.053

您提出的解决方案会稍微扭曲分布。minValue 和 maxValue 的出现频率将低于内部值。例如，假设 int 的 MinValue 为 -2，MaxValue 为 1。以下是可能的初始值，每个初始值后跟 Random(2) 之后的结果值：

```
-2: -2 -1
-1: -1  0
 0:  0  1 
```

负值 -2 的一半将被修改为 -1，只有一半的 0 将被修改为 1。因此值 -2 和 1 的出现频率低于 -1 和 0。

Damien的解决方案很好。另一种选择是：

```
if (Random(2) == 0) {
    return Random(int.MinValue, 0);
} else {
    return 1 + Random(-1, int.MaxValue);
} 
```

另一种解决方案，类似于 Damiens 方法，比以前的方法更快

```
 int i = r.Next(ushort.MinValue, ushort.MaxValue + 1) << 16;
 i |= r.Next(ushort.MinValue, ushort.MaxValue + 1); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T08:10:44.780

[均匀分布](http://en.wikipedia.org/wiki/Uniform_distribution_%28discrete%29)并不意味着每个数字都只得到一次。为此，您需要一个[排列](http://en.wikipedia.org/wiki/Permutation)

*现在，如果你需要对所有*40 亿个数字进行随机排列，你就有点卡住了。.NET 不允许对象大于 2GB。你可以解决这个问题，但我认为这并不是你真正需要的。

如果你在没有重复的情况下减少数字（比如 100 或 500 万，少于几十亿），你应该这样做：

维护一组整数，从空开始。选择一个随机数。如果它已经在集合中，请选择另一个随机数。如果它不在集合中，请将其添加并返回。

这样你就保证每个数字只会返回一次。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-08T08:22:11.673

我有一个类，我将随机字节放入一个 8KB 缓冲区并通过将它们从随机字节转换来分配数字。这为您提供了完整的 int 分布。8KB 缓冲区用于您不需要为每个新的随机字节 [] 调用 NextBytes。

```
 // Get 4 bytes from the random buffer and cast to int (all numbers equally this way 
    public int GetRandomInt()
    {
        CheckBuf(sizeof(int));
        return BitConverter.ToInt32(_buf, _idx);
    }

    // Get bytes for your buffer. Both random class and cryptoAPI support this
    protected override void GetNewBuf(byte[] buf)
    {
        _rnd.NextBytes(buf);
    }

    // cyrptoAPI does better random numbers but is slower
    public StrongRandomNumberGenerator()
    {
        _rnd = new RNGCryptoServiceProvider();
    } 
```

# android - 恒定 FPS Android OpenGLES

> ID：11381543
> 
> 赞同：3
> 
> 时间：2012-07-08T07:47:15.130
> 
> 标签：android, opengl-es, constants, frame, frame-rate

你好安卓开发者，

我正在使用 OpenGLES 1.0 在 Eclipse 中为 Android 开发一个简单的游戏。我正在使用三星 Galaxy S2 Android(2.3) 作为开发设备。

我有一个关于双核和使帧速率恒定的问题。

所以我已经设法创建 GLSurfaceView 并覆盖 onDrawFrame() 函数，我在其中调用 LogicUpdate(deltatime) 函数和 Render() 函数。

是的，现在全部在单线程中。

我遇到的问题是双核。如果我通过转到设置->省电并检查系统省电来禁用双核，我意识到渲染自动锁定在 30 FPS。但是，如果我通过取消选中系统省电来启用双核，我会看到渲染锁定在 60 FPS，但是手机会变热并且会很快耗尽电池电量。

所以这个想法是让我的游戏以 30 FPS 运行以节省一些电池。

所以要做到这一点，我使用下面的代码。

在我进行逻辑更新之前，我称之为代码和平，记住所有这些都是在 onDrawFrame() 中完成的。

```
if( CONST_FPS > 0 && StartTime > 0 )
{           
    /////////////////////////////////////////////////////////////////
    // Get frame time
    ////////////////////////////////////////////////////////////////
    long endTime  = System.currentTimeMillis(); 
    long time     = endTime - StartTime;
    //              
    long wantedtime = 1000 / CONST_FPS;
    //
    long wait = 0;
    if( time < wantedtime )
    {
        wait = wantedtime - time;
        //                  
        Thread.sleep(wait);
    }
    else
    {
        //Time to big game will slow down
    }                           
} 
```

其中 CONST_FPS = 30

接着

```
StartTime = System.currentTimeMillis(); //

UpdateLogic(1.0 / CONST_FPS);
Render(); 
```

30 FPS 的游戏非常流畅，主要是因为它不需要锁定 FPS。但是，当试图将 60FPS 锁定到 30 FPS 时，我会卡住。我做了一些研究，发现 Thread.Sleep() 并不精确。这是真的？锁定 60FPS 到 30FPS 时，我还能做些什么让游戏更流畅。

感谢你的回答 ...

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-11T04:20:25.603

您应该使用经过的时间来缩放所有运动，以使运动在不同的 FPS 速率下保持平滑。您可以像这样获得经过的时间：

```
long currentTime = System.currentTimeMillis();
float elapsed = (System.currentTimeMillis() - lastFrameTime) * .001f;//convert ms to seconds
lastFrameTime = currentTime; 
```

然后以每秒单位表示你的速度，并像这样更新位置：

```
sprite.x += (sprite.xspeed * elapsed); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-03T05:38:11.397

```
public void onSurfaceCreated(GL10 gl, EGLConfig config) {
    GLES20.glClearColor(0.1f, 0.1f, 0.1f, 1);
    GLES20.glEnable(GLES20.GL_DEPTH_TEST);
    GLES20.glDepthFunc(GLES20.GL_LEQUAL);
    GLES20Renderer.programLight = GLES20.glCreateProgram();
    int vertexShaderLight       = GLES20Renderer.loadShader(GLES20.GL_VERTEX_SHADER, GLES20Renderer.vertexShaderCodeLight);
    int fragmentShaderLight     = GLES20Renderer.loadShader(GLES20.GL_FRAGMENT_SHADER, GLES20Renderer.fragmentShaderCodeLight);
    GLES20.glAttachShader(GLES20Renderer.programLight, vertexShaderLight);
    GLES20.glAttachShader(GLES20Renderer.programLight, fragmentShaderLight);
    GLES20.glLinkProgram(GLES20Renderer.programLight);
    System.gc();
}

public void onSurfaceChanged(GL10 gl, int width, int height) {
    gl.glViewport(0, 0, width, height);
    float ratio = (float) width / height;
    Matrix.setLookAtM(GLES20Renderer.ViewMatrix, 0, 0, 0, 5f, 0, 0, 0, 0, 1, 0);
    Matrix.frustumM(GLES20Renderer.ProjectionMatrix, 0, -ratio, ratio, -1, 1, 2, 8);
    Matrix.setIdentityM(LightModelMatrix, 0);
    Matrix.translateM(LightModelMatrix, 0, -1.0f, 0.0f, 3f);
    Matrix.multiplyMV(LightPosInWorldSpace, 0, LightModelMatrix, 0, LightPosInModelSpace, 0);
    Matrix.multiplyMV(LightPosInEyeSpace, 0, ViewMatrix, 0, LightPosInWorldSpace, 0);

    System.gc();
}

public void onDrawFrame(GL10 gl) {
    long deltaTime,startTime,endTime;
    startTime   = SystemClock.uptimeMillis() % 1000;
    gl.glClear(GLES20.GL_COLOR_BUFFER_BIT | GLES20.GL_DEPTH_BUFFER_BIT);
    synchronized (this) {
        updateModel(GLES20Renderer._xAngle, GLES20Renderer._yAngle, GLES20Renderer._zAngle);            
    }
    renderModel(gl);
    endTime     = SystemClock.uptimeMillis() % 1000;
    deltaTime   = endTime - startTime;
    if (deltaTime < 30) {
        try {
            Thread.sleep(30 - deltaTime);
        } catch (InterruptedException e) {
            //e.printStackTrace();
        }
    }

    System.gc();
} 
```

**注意力：**

1.  永远不要在 UI 线程中使用 sleep；非常非常非常糟糕
2.  使用静态：虽然这是不好的 OOP 实践，但在这里很有用
3.  使用顶点缓冲区对象
4.  在 onsurfacechanged 中初始化并在此处获取位置 (glget__location)
5.  这不是你的错，因为 Froyo 垃圾收集器很糟糕，然后在 Gingerbread 上，触摸驱动程序触发了太多事件（谷歌这个）所以逐渐切换到你的应用程序/游戏的其他输入法，不使用像 Android 传感器这样的触摸
6.  升级到姜饼

# c# - datetime 检查特定时间

> ID：11381544
> 
> 赞同：0
> 
> 时间：2012-07-08T07:47:17.890
> 
> 标签：c#

我有一个 Windows 服务，我想插入一个计时器。如何检查当前时间是否为`9:00 AM`？我希望我的服务人员每天都检查一下。十分感谢

我的尝试：

```
Datetime dt=Datetime.parse("09:00:00 everyday");
if(datetime.now -dt ==0)
{
   //fire event
} 
```

不过这对我来说有点傻。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T07:55:09.193

您需要制作一个计时器并将其间隔设置为从现在到明天上午 9:00 之间的时间跨度。下次计时器滴答时，以相同方式再次设置间隔。您应该使用这个 Timer 类：http: [//msdn.microsoft.com/en-us/library/system.timers.timer.aspx](http://msdn.microsoft.com/en-us/library/system.timers.timer.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T07:56:44.230

请使用 DateTime.UtcNow.Hour 检查当前时间

通过使用 UtcNow，您将获得一个 DateTime 对象，该对象设置为计算机上的当前日期和时间，表示为协调世界时 (UTC)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T07:58:55.067

```
var now = DateTime.Now;
var today = now.Date;
var nineAm = today.AddHours(9);

TimeSpan ts = nineAm - now;

var timeInMillisecondsTill9Am = ts.Milliseconds;

If(timeInMillisecondsTill9Am==0)
{
 //your code goes here
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-08T08:09:27.810

由于您不知道何时有人可能会关闭或重新启动您的计算机或服务，因此您需要确保使用一种足够强大的方法来处理这些类型的中断。

我建议您的服务每 5 分钟左右检查一次，如果时间在**上午**9 点之后**并且****最后运行日期是昨天**。如果是这样，您将上次运行日期更新为当天（可能在一个简单的文本文件中），然后运行“9:00am”任务。通过这种方式，您的任务每天只运行一次，非常接近上午 9 点，并且对重新启动非常有效。

您需要使用标准的 .NET 计时器来触发检查 - 如果您足够聪明，您可以让它在上午 9 点后触发几秒钟。

让我知道这是否是一个好的解决方案。

# c# - Windows 7 64 位上的 emgucv

> ID：11381546
> 
> 赞同：0
> 
> 时间：2012-07-08T07:47:23.403
> 
> 标签：c#, asp.net, emgucv

当我在 Visual Studio 开发服务器上运行 emgu 时，出现此错误：

```
An attempt was made to load a program with an incorrect format. (Exception from HRESULT:0x8007000B) 
```

但是当我在本地 iis web 服务器上运行调试时，它工作正常。它发生在我使用的 emgu 的第一行代码上：

```
Image<Bgr, Byte> image = new Image<Bgr, byte>(imagePath); 
```

此行将文件绑定在 emgu dll 中

我已经尝试在 86 和 64 目标上编译 emgu 并将这些 dll 移到我的项目中，但它并没有产生任何差异，我仍然无法在开发服务器上运行我的项目

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T10:16:28.193

尝试编译到x86并在服务器iis中启用32位：应用程序池->高级设置->启用32位应用程序

# c++ - (C++/win32) 隐藏一个窗口，使用户无法使用 alt-tab 或切换到它

> ID：11381548
> 
> 赞同：2
> 
> 时间：2012-07-08T07:47:48.487
> 
> 标签：c++, winapi, user-interface, window, alt-tab

我目前正在使用`ShowWindow( hwnd, SW_HIDE )`，但`Alt``Tab`隐藏后似乎仍然可以切换到它。

有没有办法完全隐藏窗口而不破坏它？

编辑：我应该补充一点，使用`WS_EX_TOOLBOX`样式没有帮助。有了足够的`Alt``Tab`and `ShowWindow(SW_SHOW)`，就会发生一些奇怪的事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T07:59:14.380

试试这个代码来隐藏窗口我试过这个代码，当你 按下+时
隐藏窗口不会出现`Alt``Tab`
`Tab``Esc`

```
HWND hwnd_win = GetForegroundWindow();
ShowWindow(hwnd_win,SW_HIDE);
while(1)
{
    Sleep(1000);
    if(GetAsyncKeyState(VK_ESCAPE|VK_TAB ))
        break;
}   
ShowWindow(hwnd_win,SW_SHOW); 
```

# python - 使用 gdata.contacts.client 和 oauth2 检索联系人

> ID：11381550
> 
> 赞同：1
> 
> 时间：2012-07-08T07:48:01.027
> 
> 标签：python, oauth-2.0, gdata-api

我正在使用 oAuth2WebServerFlow 获取 oAuth 访问令牌，然后检索用户联系人列表。我使用 web2py 作为 web 框架。

```
 flow = oauth2client.client.OAuth2WebServerFlow(client_id=CLIENT_ID,
                                                   client_secret=CLIENT_SECRET,
                                                  scope='https://www.google.com/m8/feeds', 
                                                   user_agent=USER_AGENT)
    callback = 'http://127.0.0.1:8000/Test/searcher/oauth2callback'
    authorise_url = flow.step1_get_authorize_url(callback)
    session.flow = pickle.dumps(flow)
    redirect(authorise_url) 
```

然后按如下方式处理重定向

```
flow = pickle.loads(session.flow)
credentials = flow.step2_exchange(request.vars) 
```

我的问题是如何将上面返回的 OAuth2Credentials 对象更改为 OAuth2AccessToken 对象，然后我可以使用它来授权对联系人库的请求，例如：

```
gc = gdata.contacts.client.ContactsClient(source="")
token.authorize(gc)
gc.GetContacts 
```

我尝试了各种方法都没有成功，通常会收到“无效授权”的 oAuth2AccessTokenError 消息。我在想这样的事情可能会奏效，但也认为必须有一种更简单的方法！

```
token = gdata.gauth.OAuth2Token(client_id=CLIENT_ID, client_secret=CLIENT_SECRET, scope='https://www.google.com/m8/feeds', user_agent=USER_AGENT)

    token.redirect_uri = 'http://127.0.0.1:8000/Test/searcher/oauth2callback'
    token.get_access_token(<<code to pass the access_token out of the Credentials object??>>) 
```

有人能帮忙吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-08T18:31:02.490

我设法让这个工作。实际上这很简单，我只是停止使用 OAuth2WebServerFlow，无论如何它似乎并没有增加太多价值。所以新代码如下所示：

```
token = gdata.gauth.OAuth2Token(client_id, client_secret, scope, ua)
session.token = pickle.dumps(token)                   
redirect(token.generate_authorize_url(redirect_uri='http://127.0.0.1:8000/Test/default/oauth2callback')) 
```

其次是

```
def oauth2callback():
    token = pickle.loads(session.token)
    token.redirect_uri='http://127.0.0.1:8000/Test/default/oauth2callback'
    token.get_access_token(request.vars.code)
    gc = gdata.contacts.client.ContactsClient(source='')
    gc = token.authorize(gc)
    feed = gc.GetContacts() 
```

希望这对某人有帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-17T08:02:33.560

假设您正确设置了较新的 OAuth2.0 API 的代码，您可以通过创建一个 Token 类来修改转换 Credentials -> Token 类的标头来实现此功能。

```
OAUTH_LABEL='OAuth '

#Transforms OAuth2 credentials to OAuth2 token.
class OAuthCred2Token(object):

    def __init__(self, token_string):
        self.token_string = token_string

    def modify_request(self, http_request):
        http_request.headers['Authorization'] = '%s%s' % (OAUTH_LABEL,
                                                          self.token_string)

    ModifyRequest = modify_request 
```

您可以按如下方式对其进行测试：

```
gc = gdata.contacts.client.ContactsClient(source='')
token = OAuthCred2Token(creds.access_token)
gc.auth_token = token
print gc.GetContacts() 
```

请注意，此代码将不处理令牌刷新，该代码使用凭据处理。在我自己的应用程序中，可以使用服务进行简单调用以在调用获取联系人之前刷新凭据。

# java - 从字符串转换计算做双

> ID：11381554
> 
> 赞同：1
> 
> 时间：2012-07-08T07:48:44.883
> 
> 标签：java, android

我在安卓工作，我需要你的帮助。在**值的****字符串**中我有这个

 **```
<item>(1 / 1024)</item> 
```

我需要解析这个字符串以加倍这种方式

```
outputDouble = Double.parseDouble(unitsValues[outputPosition]); 
```

所以这意味着

```
outputDouble = Double.parseDouble((1 / 1024)); 
```

第二个代码的意思是，我通过索引找到了我需要的行，它试图将它从字符串转换为双精度，但这是不可能的，因为它可以将此字符串 (1 / 1024) 识别为双精度。你有什么想法？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T08:16:44.017

没有内置方法可以做到这一点......但是你可以使用像[BeanShell](http://www.beanshell.org/)这样的外部库来做到这一点：

```
Interpreter interpreter = new Interpreter();
interpreter.eval("(1 / 1024)"); 
```

要将 Beanshell 与 Android 一起使用，请下载 bsh-core.jar 文件，将其放在项目的 /lib 文件夹中，然后调整 Eclipse 设置或 Ant 脚本以在编译和打包期间引用该 JAR。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T07:58:00.487

也许这将向您说明如何使用`String#split`. 没有直接的方法来进行转换。

```
String representation = getString(R.string.my_repr);
String [] splits  = representation.split("/");
Double num = Double.valueOf(splits[0].trim()) / Double.valueOf(splits[1].trim()); 
```

**编辑**我还添加了对字符串的修剪，因为存在虚假间隔符号的危险。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T07:59:00.637

使用`regex`parse`(1 / 1024)`分成两个`Double`值`1f`，`1024f`然后将它们分开得到一个`Double`值。**

# c# - C#: 'System.StackOverflowException' occurred in mscorlib.dll

> ID：11381555
> 
> 赞同：5
> 
> 时间：2012-07-08T07:48:45.603
> 
> 标签：c#, winforms, visual-studio-2010, stack-overflow

![enter image description here](../Images/678710c1339f413c6c9feb9bbf6ec486.png) Today in the morning I was testing my code suddenly I got this error. I don't know what to do here because it was working file till yesterday night.

I check Stackoverflow website for solution, but the solutions are based on the original code and it's local.

I hope someone can tell me what is the problem here?? Is there any solution for this problem??

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T08:57:40.067

Your data is probably not valid XML anymore possibly due to a circular reference. Either drill down and check if subsets have the problem. Or try a few tools to se if they can more quickly pinpoint the problem. With tools I mean apps like xmlspy (or even an online check like [http://www.w3schools.com/dom/dom_validate.asp](http://www.w3schools.com/dom/dom_validate.asp))

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-26T17:11:03.003

in my C# Windows form application code the circular reference (not in XML file) which thrown the "System.StackOverFlowException" looked like this, The approach I took was breaking step by step as per @zmbq's comment:

```
class A
{
//Class A code

class B
{
    //Class B code
}
}

class C
{
    A a = new A();
    B b = new B();
    C c = new C(); /*CALLING THE SAME CONSTRUCTOR IN CIRCULAR FASHION*/
} 
```

I removed the constructor call to class C (which was actually necessary), now it works fine!!

# html - 为什么我的 HTML5 画布在短暂的停顿期间没有清除？

> ID：11381556
> 
> 赞同：0
> 
> 时间：2012-07-08T07:49:11.873
> 
> 标签：html, canvas

我在这里有一个游戏循环，它在 draw() 中呈现以下内容。期望的目标是让游戏清除画布，说“游戏结束”，然后暂停 3 秒，然后重置并继续新游戏。但是，看起来它只是将现有游戏暂停 3 秒，而不是清除和绘制“游戏结束”。它有什么问题？

```
 // check for game over - failed
    if (ball_y + ball_dy + ball_radius> HEIGHT-20)
    {
        game_end_start_time = new Date().getTime();

         while (new Date().getTime() - game_end_start_time < 3000)
         {

            clear();  // calls  ctx.clearRect(0, 0, WIDTH, HEIGHT);

            fillColorValue(COLOR_GREEN);
            drawFont("G A M E   O V E R", WIDTH/2-80, HEIGHT/2);

         }

        resetGame();  
        return;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T07:59:18.040

您的 JavaScript 代码在 UI 线程上运行。所以基本上浏览器在你的代码执行完成之前无法绘制。因为你只是循环了 3 秒，所以你所做的就是阻止浏览器做任何事情。

尝试在屏幕上绘制游戏并使用`setTimeout(function(){resetGame();}, 3000);`3 秒后重新开始新游戏。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T10:08:30.170

如何在 Javascript 中编写渲染循环（动画循环）：

[http://hacks.mozilla.org/2011/08/animating-with-javascript-from-setinterval-to-requestanimationframe/](http://hacks.mozilla.org/2011/08/animating-with-javascript-from-setinterval-to-requestanimationframe/)

# regex - 编写验证此字符串的模式的更好方法是什么？

> ID：11381557
> 
> 赞同：2
> 
> 时间：2012-07-08T07:49:50.173
> 
> 标签：regex

我想编写一个正则表达式模式，它以类名开头，类名之间有一个点，每个类名都以一个类名结尾，以一个字母开头。它就像java中的类导入，

我写了这个模式，但它太复杂而且验证速度太慢，我认为它不能正常工作

```
^([a-zA-Z]([0-9]|_|[a-zA-Z])*)(([a-zA-Z]([0-9]|_|[a-zA-Z])*)|\\.)*([a-zA-Z]([0-9]|_|[a-zA-Z])*)$ 
```

例如我的输入字符串应该是这样的：“com.casp.common.StringUtils”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T07:55:02.233

仅以下内容有什么问题：

```
^([a-zA-Z][a-zA-Z0-9_]*\.?)+$ 
```

只要有一个，它就会将类名与其中任意数量的包匹配。如果您至少需要两个实例，则以下内容也可以正常工作：

```
^([a-zA-Z]+)\.([a-zA-Z][a-zA-Z0-9_]*\.?){1,}$ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-08T08:00:02.000

首先，简化：

```
[0-9]|_|[a-zA-Z] 
```

可以组合为

```
[0-9_a-zA-Z] 
```

实际上它有一个速记表示

```
\w 
```

所以您的正则表达式可以首先简化为这种等效形式：

```
^([a-zA-Z](\w)*)(([a-zA-Z](\w)*)|\.)*([a-zA-Z](\w)*)$ 
```

现在，我们可以通过删除一些冗余的捕获组来进一步简化，并**打开不区分大小写的匹配**：

```
^[a-z]\w*([a-z]\w*|\.)*[a-z]\w*$ 
```

当然，这个正则表达式是不正确的，`a....b`例如它匹配。

问题是因为这`\.`是一个“替代品”，不应该是，因为每个组件之间都*需要一个点。*所以它可能应该转换为：

```
^[a-z]\w*([a-z]\w*\.)*[a-z]\w*$ 
```

但它仍然不正确，因为它不会匹配`a.b`，因为前导部分。我们需要删除它：

```
^([a-z]\w*\.)*[a-z]\w*$ 
```

并且可能重新排列它，使重复部分位于末尾，而不是开头：

```
^[a-z]\w*(\.[a-z]\w*)*$ 
```

# azure - Microsoft Azure 节点-sqlserver 问题

> ID：11381561
> 
> 赞同：0
> 
> 时间：2012-07-08T07:50:24.230
> 
> 标签：azure, azure-sql-database

计划使用 node.js 在 Windows Azure 网站上构建新项目时，我遇到了 SQL Server 模块的问题，我无法解决：

我正在使用下载的模块二进制文件，以及示例中的简单代码，连接到 Azure 托管的 SQL Server：

```
var sql = require('node-sqlserver');
var http = require('http');

var conn_str = "Driver={SQL Server Native Client 10.0};Server=tcp:server.database.windows.net,1433;Database=database;Uid=user@server;Pwd=mypass;Encrypt=yes;Connection Timeout=30;";

var port = process.env.port||3000;
http.createServer(function (req, res) {

sql.query(conn_str, "SELECT * FROM testdb.testtable", function (err, results) {
    if (err) {
        res.writeHead(500, { 'Content-Type': 'text/plain' });
        res.write("Got error :-( " + err);
        res.end("");
        return;
    }
    res.writeHead(200, { 'Content-Type': 'text/plain' });
    res.end(JSON.stringify(results));
});

}).listen(port); 
```

该示例在我的 PC 上本地运行，它能够连接到 Azure SQL 并检索行，尽管我必须将节点降级到 0.6.19 才能使其工作，但是当我将它部署到 Azure 时它失败了。当我尝试访问网站时，经过长时间的等待，我收到：

```
iisnode encountered an error when processing the request.

HRESULT: 0x6d
HTTP status: 500
HTTP reason: Internal Server Error
You are receiving this HTTP 200 response because system.webServer/iisnode/@devErrorsEnabled configuration setting is 'true'.

In addition to the log of stdout and stderr of the node.exe process, consider using debugging and ETW     traces to further diagnose the problem.

The node.exe process has not written any information to the stdout or stderr. 
```

我尝试从源代码编译 node-sqlserver 模块，它再次在我的 PC 上运行，在 Azure 上具有相同的结果。我还验证了模块二进制文件已部署（我正在使用 git 进行部署）。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T10:38:54.773

好的，结果是，SQL 数据库和网站位于不同的地理区域，尽管“可用于 Azure 服务”设置，但 Azure 无法连接到不同区域的 SQL 服务器。不得不移动数据库并且它工作。

# c - 链表未在 C 中正确打印/添加

> ID：11381562
> 
> 赞同：1
> 
> 时间：2012-07-08T07:51:04.443
> 
> 标签：c, linked-list

这只是一个粗略的代码，所以那里还没有免费的。我只是想弄清楚它在哪里弄乱了我的链接列表。

以下函数的目的是接受类似的内容：

```
add 1 2 
```

或者

```
add 1 "some quote" maybe more stuff 
```

并用元素制作一个链表..在第一种情况下：

```
[add]->[1]->[2] 
```

在第二种情况下：

```
[add]->[1]->["some quote" maybe more stuff] 
```

我知道它实际上正在执行这些步骤，因为“计数/总数”就在输出中。但是，当我尝试遍历链表时，它只打印第一个元素。

```
typedef struct command{
    char* args;
    struct command *next;
}command;
typedef struct commands_list{
    command *head;  /*Start of the queue*/
    int total;  /*Total commands passed*/
}commands_list;

commands_list* process_command(char *command){
    char curr_char;                 /*Keeps track of current character*/
    int start_pos;
    int i;
    int len;    

    /*Length of user input*/
    int quote=0;
    int empty =1;
    commands_list *commands;
    struct command *conductor;

    len = strlen(command);              /*Calculate length*/    
    /*Initialize the List*/
    commands=malloc(sizeof(commands_list));         /*Allocate memory for the linked list*/
    commands->head = malloc(sizeof(struct command));
    conductor = commands->head;

    for(i=0,start_pos=0;i<strlen(command);i++){
        curr_char = command[i];
        if (empty==0){
            conductor = malloc(sizeof(struct command));
        }
        if (curr_char == ' '){      /*If there was a space found copy the stuff before the space*/
            if ( i>0 && command[i-1]==' ') {
                start_pos++;
                continue;
            }
            conductor->args = malloc(i-start_pos+1*(sizeof(char))); /*Allocate memory for the word to be copied*/
            strncpy(conductor->args,command+start_pos,i-start_pos); /*Copy the word/command to the memory allocated*/
            conductor->args[i-start_pos+1]='\0';            /*Add null terminator at end*/
            commands->total++;              /*Increase total # of commands*/
            conductor=conductor->next;          /*Conductor points to the first element now*/
            start_pos =i+1;
            if (empty==1){
                empty=0;
            }
        }
        else if (curr_char == '\"'){        /*If a quote was found, copy the rest of the string and exit loop*/
            conductor->args = malloc(len-i+1*(sizeof(char)));
            strncpy(conductor->args,command+i,len-i);
            conductor->args[len-i+1]='\0';
            conductor->next=NULL;
            commands->total++;
            quote=1;
            //empty_queue = 0;
            conductor = conductor->next;
            if (empty==1){
                empty=0;
            }
            break;
        }
    }
    if (quote==0){                  /*If there was no quote in the string, get the last element*/
        if (empty==0){
            conductor = malloc(sizeof(struct command));
        }
        conductor->args = malloc(len-start_pos+1*(sizeof (char)));
        strncpy(conductor->args,command+start_pos,len-start_pos);
        conductor->args[len-start_pos+1]='\0';
        conductor->next=NULL;
        commands->total++;
    }   /*Finish find quote*/
    printf("%d commands found\n",commands->total);
    //free(conductor);
    return commands;    
} 
```

还有一个我用来打印链表的临时方法：

```
int print_list(commands_list **headNode){
    commands_list *top = *headNode;
    struct command *temp = top->head;           /*Temporary variable for command*/
    while(temp!=NULL){
        printf("I was here to print: [%s]\n",temp->args);
        temp = temp->next;
    }
    printf("It was all null\n");

    free(temp);
} 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T08:21:35.500

如果它只打印第一个元素，则必须断定第`next`一个元素的成员为 NULL；`conductor`已分配`conductor->next`，但`conductor->next`它本身从未分配除 NULL 以外的任何内容。

添加到端时，`next`必须为当前端的成员分配新项目的地址。这似乎不是正在发生的事情。

我强烈建议您使用符号调试器来分析此代码。它将允许您在监视变量状态的同时单步执行每一行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T08:38:58.767

代码中存在许多问题，使其难以调试。

主要问题是如何将结构命令 * 添加到列表末尾。线

```
 conductor=conductor->next; 
```

只会将导体分配给 NULL （或任何 malloc 所做的）。您永远不会将导体-> 分配到任何东西旁边。

当你 malloc 一个新的结构命令 * 时，你需要更新旧的导体->在新分配的元素旁边。所以而不是：

```
 conductor = malloc(sizeof(struct command)); 
```

你需要类似的东西：

```
 struct command *tmp = malloc(sizeof(struct command));
        conductor->next = tmp;
        conductor = tmp; 
```

此外，如果您添加线路导体-> args =“*尚未分配#1* ”，它可能有助于您的调试；在上面的最后一行之后。这很严重，不应出现在生产代码中，但会帮助您调试问题。

# arraylist - 在java中的arraylist中迭代类对象

> ID：11381570
> 
> 赞同：0
> 
> 时间：2012-07-08T07:53:22.517
> 
> 标签：arraylist, iteration

我正在将类对象添加到我的数组列表中，现在我必须循环迭代对象并保存到数据库中

我的豆类

```
 public class SchemeBean {

 private String code;
 private String name;
 private String value;

 public String getCode(){

 return code;

}

 public String getName(){

 return name;

 }

 public String getValue(){

 return value;

 }

  public SchemeBean(String code,String name,String value){

 this.code=code;
 this.name=name;
 this.value=value;

} 
```

}

在数组中添加类对象

```
 ArrayList items= null ;
  String hd1 = jsonLineItem.getString("hd1");
  String hd2 = jsonLineItem.getString("hd2");
  String code = jsonLineItem.getString("code");
  items.add(new SchemeBean(code,hd1,hd2)); 
```

现在我有这个arraylist items，它已经将SchemeBean的对象添加到它作为它的元素

现在我的要求是我必须迭代它并将其添加到数据库中，我不明白如何迭代它。请任何提示对我有很大帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T08:05:02.133

```
for(SchemeBean item: items){
    System.out.println("item: "+item);
} 
```

尽管您需要 Override`toString`方法以获得正确的输出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T08:05:14.737

```
for(int i=0; i<items.lenth-1; i++)
{
  Save(item[i]);
} 
```

或者...

```
for (SchemeBean s : arrayList)
{
  Save(item[i]);
} 
```

你的保存功能骨架...

```
public void Save(SchemeBean s) 
{
  //Save the values to the db
} 
```

# c# - 如何将图像添加到我的 .resx 文件中？

> ID：11381574
> 
> 赞同：4
> 
> 时间：2012-07-08T07:53:47.320
> 
> 标签：c#, asp.net-mvc-3, image, resources

当然，除了使用 Visual Studio 的 AddResource 按钮之外。

我提交了一个表格，以及一个带有它的图像文件。在我的控制器操作中，我`HttpPostedFileBase`使用`Path.GetFileName()`. 如果我只是使用`SaveAs()`函数将图像文件保存在我的应用程序中，我以后无法访问它进行测试，因为它给了我“不允许加载本地资源”错误。

所以我想将图像添加到 .resx 文件中，稍后使用`ResourceManager`或其他方式检索它。我的问题是，如何将控制器操作中的图像添加到 .resx 文件中？

我还应该问这是否是在我的应用程序中添加和检索图像文件的好方法。

编辑：好的，使用 .resx 存储图像不是一个好主意。我最初的问题是我可以保存图像文件，但是当我试图在我的视图中显示它时，它给出了“不允许加载本地资源”错误。

这是控制器代码：

```
public ActionResult UrunEkle(Urun urun, HttpPostedFileBase image)
{
    Directory.CreateDirectory(Server.MapPath("~/App_Data/Images"));
    var path = Path.Combine(Server.MapPath("~/App_Data/Images"), fileName);
    image.SaveAs(path);  

    urun.ArtUrl = path;

    // other stuff....
} 
```

在我看来，我尝试像这样检索图像：

```
<img alt="@urun.name" src="@Url.Content(urun.ArtUrl)" /> 
```

但是使用谷歌浏览器，我得到这个**“不允许加载本地资源”**。我怎样才能避免这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T08:05:56.620

忘记尝试将图像添加到 RESX 文件；它不是为在运行时修改而设计的。

请发布一些代码。最有可能的是您为稍后使用图像而提供的 URL 不正确。可能是因为您返回的是服务器上文件的路径，而不是网站上下文中图像的 URL。

Chrome 的错误消息告诉您它正在尝试从客户端上的本地文件系统加载资源。

Url.Content 将**相对虚拟**路径转换为**绝对虚拟**路径，需要一个以~开头的URL。您当前正在传递图像文件的**绝对物理**路径，并且 Url.Content 正在返回它，保持不变。您需要 urun.ArtUrl 中的相对虚拟路径 (~/App_Data/Images/Untitled.png)。这是您传递给 Server.MapPath 的值。

# java - 添加鼠标侦听器以放置目标

> ID：11381575
> 
> 赞同：2
> 
> 时间：2012-07-08T07:53:58.343
> 
> 标签：java, swing, jtable, drag-and-drop

```
DefaultTableModel modeltable = new DefaultTableModel(8,8);

table = new JTable(modeltable);
table.setBorder(BorderFactory.createLineBorder (Color.blue, 2));

int height = table.getRowHeight();
table.setRowHeight(height=50);

table.setColumnSelectionAllowed(true);
table.setDragEnabled(true);

le1.setFillsViewportHeight(true);

panel.add(table);
panel.setSize(400,400);

    DnDListener dndListener = new DnDListener();
    DragSource dragSource = new DragSource();
    DropTarget dropTarget1 = new DropTarget(table, dndListener);

   DragGestureRecognizer dragRecognizer2 = dragSource.
            createDefaultDragGestureRecognizer(option1, 
          DnDConstants.ACTION_COPY, dndListener);
   DragGestureRecognizer dragRecognizer3 = dragSource.
            createDefaultDragGestureRecognizer(option2, 
            DnDConstants.ACTION_COPY, dndListener);

}
} 
```

我在将鼠标侦听器添加到作为放置目标的“表”时遇到问题，无论它从鼠标中落下的任何地方都接受放置组件。在此代码中，当组件放入放置目标时，它始终会转到默认位置。我无法自定义放置目标的位置。请有人帮我解决这个问题。提前致谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-08T08:46:31.033

那些听众太低级了。实现 dnd 的适当方法是实现自定义 TransferHandler 并将该自定义处理程序设置为您的表。

```
 public class MyTransferHandler extends TransferHandler {

    public boolean canImport(TransferHandler.TransferSupport info) {
        // we only import Strings
        if (!info.isDataFlavorSupported(DataFlavor.stringFlavor)) {
            return false;
        }

        JTable.DropLocation dl = (JTable.DropLocation)info.getDropLocation();
        // ... your code to decide whether the data can be dropped based on location 
    }

    public boolean importData(TransferHandler.TransferSupport info) {
        if (!info.isDrop()) {
            return false;
        }

        // Check for String flavor
        if (!info.isDataFlavorSupported(DataFlavor.stringFlavor)) {
            displayDropLocation("Table doesn't accept a drop of this type.");
            return false;
        }

        JTable.DropLocation dl = (JTable.DropLocation)info.getDropLocation();
        // ... your code to handle the drop
   }

}

// usage
myTable.setTransferHandler(new MyTransferHandler()); 
```

有关详细信息，请参阅 Swing 标签描述中链接到的在线教程中的示例，即[拖放一章](http://docs.oracle.com/javase/tutorial/uiswing/dnd/index.html)。上面的代码片段是从 BasicDnD 示例中复制的。

# javascript - 动画帧调整大小

> ID：11381576
> 
> 赞同：1
> 
> 时间：2012-07-08T07:54:06.533
> 
> 标签：javascript, jquery, html, css

是否可以在 html 中动画调整框架的大小？

我有一个网页，其中有两个水平堆叠的框架（比如 500 像素，剩余）。单击“最小化”图像后，左侧的框架会缩小到 100 像素左右。是否可以通过 jquery/javascript/css 为这种收缩设置动画？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T08:28:51.577

如果您正在寻求为内部框架设置动画，那么我会选择 Molle 博士的回答。但是，如果您要为框架集设置动画，则必须手动进行。下面的例子说明了。要检查它，您最好使用本地 Web 服务器来避免跨域限制的问题（至少在 Chrome 中，尚未在其他任何地方测试过......）。

### 框架1.html

```
<html>
    <body>
        frame 1
        <br />
        <a href='#' class='minimize'>Minimize</a>

        <script type="text/javascript" 
            src="http://code.jquery.com/jquery-latest.min.js"></script>
        <script type='text/javascript'>
            $(function () { 
                $('.minimize').click(function (evt) {
                    evt.preventDefault();
                    window.parent.minimize();
                    return false;
                });
            });
        </script>
    </body>
</html> 
```

### 框架2.html

```
<html><body>frame 2</body></html> 
```

### 框架集.html

```
<html>
    <head>
        <script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"></script>
        <script type='text/javascript'>
            $(function () { 
                var minimizeInterval = null;
                var current = 500;
                var pace = 15;
                var stop = 100;

                window.minimize = function () {
                    minimizeInterval = setInterval(function () {
                    console.log('minimizing...');
                        $('frameset').attr('cols', current + ',*');
                        current -= pace;
                        if (current < stop) 
                            clearInterval(minimizeInterval);
                    }, 10);
                };
            });
        </script>
    </head>

    <frameset cols="500,*">
        <frame id='frame1' src="frame1.html"></frame>
        <frame id='frame2' src="frame2.html"></frame>
    </frameset>
</html> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-08T07:58:53.360

使用 jQuery 的[动画](http://api.jquery.com/animate/)：

```
$('#frameselector').animate({width:100}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-08T08:00:32.787

是的，您可以为大多数 CSS 属性设置动画。

这是[一个示例](http://jsfiddle.net/dystroy/Vaz98/)：当您单击左侧框架时，右侧框架会变为动画并缩小尺寸。

这是使用：

```
$('#a').click(function(){
    $('#b').animate({
        height: '50px'
    }, 5000);
});​ 
```

# facebook - FACEBOOK 按钮和元标记 'og:site_name' 未正确显示

> ID：11381578
> 
> 赞同：0
> 
> 时间：2012-07-08T07:54:15.237
> 
> 标签：facebook, meta-tags

我已经成功插入了一个类似 FACEBOOK 的按钮，除了元标记 'og:site_name' 不起作用...：

在我的 facebook 页面上，它显示了主域的名称 (http://www.domain.com)，而不是元标记 'og:site_name' (FAN CLUB) 的内容

我已经研究了所有要研究但没有成功的东西......这么简单的事情（？）我错过了什么吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T08:02:56.533

通过[Facebook 调试器](https://developers.facebook.com/tools/debug)输入您的 URL应该会清除 Facebook 对您的 URL 的缓存并刷新您所做的任何更改。尝试将您的 URL 传递给调试器，它应该被刷新为正确的值。

调试器还将引导您解决在将您的 URL 集成到开放图形协议时可能遇到的任何其他问题......

# c++ - C++ 派生类型必须定义静态 constexpr

> ID：11381579
> 
> 赞同：2
> 
> 时间：2012-07-08T07:54:17.303
> 
> 标签：c++, templates, inheritance

有没有办法强制派生类型`static constexpr`在 C++ 中定义 a？我有一个基类，我想强制每个派生类定义一个`static const bool has_property`.

我尝试使用 CRTP 执行此操作（以便每个派生类都有自己的`static const`）：

```
template <typename T, class MyClass>
struct Base {
    T data;
    static constexpr bool has_property;
};

template <typename T>
struct Derived : public Base<T, Derived<T> > {
    static constexpr bool has_property = false;
}; 
```

但是编译器抱怨`Base::has_property`没有初始化。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-08T08:24:27.437

我们可以将 a 插入`static_assert`到 的构造函数中`Base`：

```
template <typename T, class MyClass>
struct Base {
    T data;

    Base() {
        static_assert(std::is_same<
                        typename std::decay<
                          decltype(MyClass::has_property)
                        >::type, bool
                      >::value, 
                      "Must be a bool");
        static_assert(MyClass::has_property || true, 
                      "Must be constexpr");
    }
}; 
```

此检查仅在派生类被实例化*并*使用默认构造函数时起作用`Base`。该`constexpr`检查目前在 g++ 4.7 中不起作用。

* * *

或者，您可以使用类型特征而不是`constexpr`静态成员，例如

```
template <typename T>
struct has_property;

template <typename T>
struct has_property<Derived<T>> : std::true_type {};

// use as: has_property<X>::value. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-08T10:55:23.663

也许将 has_property 值添加到您的基本模板参数对您有用：

```
template <typename T, class MyClass, bool hasPropertyValue>
struct Base {
    T data;
    static constexpr bool has_property = hasPropertyValue;
};

template <typename T>
struct Derived : public Base<T, Derived<T>, false > {
}; 
```

[更新1] 对于数组 - 而不是传递单个布尔值 - 传递包含值的结构：

```
template <typename T, class MyClass, class MyClassPropertyValues>
struct Base {
    T data;
    static constexpr bool has_property[MyClassPropertyValues::length];
};
template <typename T, class MyClass, class MyClassPropertyValues>
constexpr bool Base<T, MyClass, MyClassPropertyValues>::
 has_property[MyClassPropertyValues::length] = MyClassPropertyValues::initValues;

struct DerivedPropertyValues {
   static constexpr size_t length = 3;
   static constexpr bool initValues[length];
};    
constexpr bool DerivedPropertyValues::initValues[length] = { true, false, true };

template <typename T>
struct Derived : public Base<T, Derived<T>, DerivedPropertyValues > {
}; 
```

# c++ - 打印地图中包含的集合的内容

> ID：11381586
> 
> 赞同：1
> 
> 时间：2012-07-08T07:57:31.260
> 
> 标签：c++, maps, set

我正在编写一个程序，它从文件中读取团队名称并将它们分组。每组 4 号。我使用的是：

```
map<int, set<string> > groups 
```

假设团队名称是国家名称。现在在将所有团队名称输入resp之后。组我想打印每个组的内容，这就是我卡住的地方。

这是我迄今为止编写的完整工作代码。

```
#include<iostream>
#include<vector>
#include<ctime>
#include<cstdlib>
#include<algorithm>
#include<map>
#include<set>
using namespace std;
void form_groups(vector<string>);
int main(){
        srand(unsigned(time(NULL)));
        string team_name;
        vector<string> teams;
        while (cin >> team_name)
        {
                teams.push_back(team_name);
        }
        random_shuffle(teams.begin(), teams.end());
        form_groups(teams);
}
void form_groups(vector<string> teams)
{
        map<int, set<string> > groups;
        map<int, set<string> >::iterator it;
        string curr_item;
        int curr_group = 1;
        int count = 0;
        for(int i = 0; i < teams.size(); i++)
        {
                curr_item = teams.at(i);
                count++;
                if(count == 4)
                {
                        curr_group += 1;
                        count = 0;
                }
                groups[curr_group].insert(curr_item);
        }
        cout << curr_group << endl;
        for(it = groups.begin(); it != groups.end(); ++it)
        {
        }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T09:21:32.120

你的方法很好。通过使用，您可以使用和`map<int, set<string> >::iterator it`访问给定的`<key,value>`对。由于它本身是一个标准容器，因此您可以使用 an来遍历元素：`it->first``it->second``set<string>``set<string>::iterator`

```
map<int, set<string> >::iterator map_it;
set<string>::iterator set_it

for(map_it = groups.begin(); map_it != groups.end(); ++map_it){
    cout << "Group " << it->first << ": ";

    for(set_it = map_it->second.begin(); set_it != map_it->second.end(); ++set_it)
         cout << *set_it << " ";

    cout << endl;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T09:21:39.643

在迭代 a`std::map<..>`时，`it->first`将为您提供密钥，并`it->second`为您提供相应的值。

你需要这样的东西来迭代地图：

```
for(it = groups.begin(); it != groups.end(); ++it)
{
    cout<<"For group: "<<it->first<<": {"; //it->first gives you the key of the map.

    //it->second is the value -- the set. Iterate over it.
    for (set<string>::iterator it2=it->second.begin(); it2!=it->second.end(); it2++)
        cout<<*it2<<endl;
    cout<<"}\n";
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-08T09:21:39.927

我*认为*`groups` `map`这是你的困难的迭代。迭代 a 的示例`map`：

```
for (it = groups.begin(); it != groups.end(); it++)
{
    // 'it->first' is the 'int' of the map entry (the key)
    //
    cout << "Group " << it->first << "\n";

    // 'it->second' is the 'set<string>' of the map entry (the value)
    //
    for (set<string>::iterator name_it = it->second.begin();
         name_it != it->second.end();
         name_it++)
    {
        cout << "  " << *name_it << "\n";
    }
} 
```

# android - 在Android中动态添加TextView

> ID：11381592
> 
> 赞同：0
> 
> 时间：2012-07-08T07:58:35.533
> 
> 标签：android, android-layout, textview

我的活动 xml 中有一个 EditText 和一个 Button。我想做的是在单击按钮时，EditText 中的文本应该显示在 EditText 上方的 TextView 中。

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:gravity="bottom"
android:orientation="vertical" >

<EditText 
    android:id="@+id/edit_message"
    android:hint="@string/hint_message"
    android:layout_height="wrap_content"
    android:layout_width="wrap_content"/>

<Button 
    android:id="@+id/button_send"
    android:text="@string/button_text"
    android:layout_height="wrap_content"
    android:layout_width="wrap_content"
    android:onClick="sendMessage"/> 
```

这是我的 sendMessage()

```
public void sendMessage(View view){
    EditText editText=(EditText)findViewById(R.id.edit_message);
    String message=editText.getText().toString();       
    LinearLayout layout=(LinearLayout)findViewById(R.id.layout01);
    TextView text=new TextView(this);
    text.setText(message);
    layout.addView(text);
} 
```

当我单击按钮时，没有任何反应。什么都没有。知道为什么这不起作用吗？我对Android开发很陌生。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T08:08:22.913

将此行添加到您的 LinearLayout 标记。

```
android:id="@+id/linear" 
```

并将您的 sendMessage 方法更改为以下

```
public void sendMessage(View view){
EditText editText=(EditText)findViewById(R.id.edit_message);
String message=editText.getText().toString();       
LinearLayout layout=(LinearLayout)findViewById(R.id.linear);
TextView text=new TextView(this);
text.setText(message);
text.setLayoutParams(new LayoutParams(LayoutParams.WRAP_CONTENT,LayoutParams.WRAP_CONTENT));
layout.addView(text); 
```

}

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T08:03:31.177

你必须有一个`TextView`高于你的`EditText`并设置它的属性`android:visibility="gone"`。

现在，当你想`TextView`在那个时候显示你的文本时。do`getText()`从中获取文本`EditText`并设置该文本，`setText()`用于您`TextView`的，同时为您的`TextView`，做`setVisibility(View.VISIBLE)`。

喜欢，

```
String text = editText.getText();
textView.setText(text);
textView.setVisibility(View.VISIBLE); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-08T08:18:04.283

将您的 XML 更改为以下。

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:gravity="bottom"
android:id="@+id/linear"
android:orientation="vertical" >

<TextView
android:id="@+id/tv" 
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:text=""
/>

<EditText 
android:id="@+id/edit_message"
android:hint="@string/hint_message"
android:layout_height="wrap_content"
android:layout_width="wrap_content"/>

<Button 
android:id="@+id/button_send"
android:text="@string/button_text"
android:layout_height="wrap_content"
android:layout_width="wrap_content"
android:onClick="sendMessage"/> 
```

现在你的 sendMessage() 应该看起来像这样。

```
public void sendMessage(View view){
EditText editText=(EditText)findViewById(R.id.edit_message);
String message=editText.getText().toString();       
LinearLayout layout=(LinearLayout)findViewById(R.id.linear);
TextView text=(TextView)findViewById(R.id.tv);
text.setText(message); 
```

}

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-08T08:04:50.127

您必须`LayoutParams`为新 View 设置 (wrap_content/match_parent) ：

```
TextView text = new TextView(this);

text.setLayoutParams(new LinearLayout.LayoutParams(
        LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));    

text.setText(message);
layout.addView(text); 
```

# ruby-on-rails - 使用 rails 中的回形针将已上传的文件上传到 S3 服务器，而无需下载该文件

> ID：11381609
> 
> 赞同：0
> 
> 时间：2012-07-08T08:01:28.153
> 
> 标签：ruby-on-rails, amazon-s3, paperclip

我正在尝试找出将“已上传的文件”上传到 S3 服务器的方法，而无需使用回形针从 S3 服务器下载该文件。

直接的方法是将该文件从 S3 下载到本地系统并使用回形针将其重新上传到 S3，但是，我试图避免从 S3 下载文件。

请帮助我，如果我们可以使用 S3 URL 直接上传该文件。

提前致谢。

*   尼瓦斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T09:20:25.207

这是一个简单的方法：

```
require "open-uri"

class User < ActiveRecord::Base
  has_attached_file :picture

  def picture_from_url(url)
    self.picture = open(url)
  end
end 
```

然后简单地说：

```
user.picture_from_url "http://media-cache-ec5.pinterest.com/upload/262827328223677179_oN7ufeP3_f.jpg" 
```

# python - SqlAlchemy ORM - 在查询时限制列（选择） - column_property

> ID：11381610
> 
> 赞同：2
> 
> 时间：2012-07-08T08:01:33.267
> 
> 标签：python, sqlalchemy

我知道我可以从表中延迟加载列：

```
session.query(MyTable).options(defer(colname) 
      for colname in ['col4', 'col5', ..,  'colN']) 
```

我只想要前 3 列，因此可以将其缩短为以下内容：

```
session.query(MyTable).options(defer(col.name) 
      for col.name in MyTable.__table__.columns
      if col.name not in ['col1', 'col2', 'col3']) 
```

因为`MyTable`有一些`column_property`未在 中列出的额外 s，所以`MyTable.__table__.columns`即使我不想要它们，它们也会包含在查询中。

那么有没有一种结构可以直接表达我想要的限制？例如类似的东西

```
session.query(MyTable).options(XXselect('col1', 'col2', 'col3')) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-09T16:42:55.230

如果您只想要这些值，您可以调用：

```
session.query(Mytable.col1, MyTable.col2, MyTable.col3). 
```

如果您想要具有延迟列的完整对象，`MyTable.__table__.columns`则应该为您提供所有列，而不管 mixins 是什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-11-15T20:16:14.803

[load_only()](http://docs.sqlalchemy.org/en/latest/orm/loading_columns.html#load-only-cols)函数可用于此

> 可以选择任意一组列作为“仅加载”列，这些列将在延迟给定实体上的所有其他列的同时加载，使用 orm.load_only()：

```
from sqlalchemy.orm import load_only

session.query(Book).options(load_only("summary", "excerpt")) 
```

# shell - 用于删除旧文件的 Shell 命令

> ID：11381613
> 
> 赞同：0
> 
> 时间：2012-07-08T08:02:01.237
> 
> 标签：shell, cron, centos, cpanel

我正在远程 FTP 位置备份客户的网站。我有一个脚本（在 cPanel 上无需 root 访问即可使用），它在给定的 cron 上进行备份并将其传输到远程 ftp 位置。现在真正的问题开始了；因为我们不能在任何服务器上拥有无限 GB 的磁盘空间，所以我们必须限制备份。我正在寻找 shell 命令（可以直接添加到 cronjob 或通过创建 bash 脚本并从 cron 调用该脚本。我想保留 1 周的每日备份。我想从该目录中删除任何超过 1 周的备份. 我发现以下命令看起来很有希望

```
find /path/to/files -mtime +30 -exec rm  {}\; 
```

但是当我运行这个命令时（为了测试我用'ls -l'替换了'rm'）我得到了以下错误

```
find: missing argument to `-exec' 
```

有人可以帮忙解决这个小问题吗？

我正在运行 CentOS + cPanel

谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T08:14:41.450

可能你只需要在右括号后放置空格：

```
find /path/to/files -mtime +30 -exec rm  {} \; 
```

我无法在 CentOS 上进行测试，但在我的系统上，如果我不在括号周围加上空格，它就不起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T09:27:46.580

分号必须是一个单独的参数（一周是 7 天）：

```
find /path/to/files -mtime +7 -exec rm {} ';' 
```

实际上，您可能会更好地使用符号`+`代替，`;`因为它将尽可能多的文件名组合成一个命令执行，而不是像`xargs`这样但不调用`xargs`. 因此：

```
find /path/to/files -mtime +7 -exec rm {} + 
```

这样做的另一个优点是没有必须保护外壳的字符。

# .htaccess - 通过 htaccess 在重写的 url 上强制 HTTPS

> ID：11381616
> 
> 赞同：1
> 
> 时间：2012-07-08T08:02:33.630
> 
> 标签：.htaccess, ssl, https

我有一个网站`www.domain.com`，这里是根（也是唯一的）`.htaccess file`

```
RewriteEngine on

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} !(.*)\.(css|js|htc|pdf|jpg|jpeg|gif|png|ico)$ [NC]
RewriteRule ^(.*)$ index.php?path=$1 [QSA,L]

RewriteCond %{HTTP_HOST} !^www\.
RewriteRule ^(.*)$ http://www.%{HTTP_HOST}/$1 [R=301,L] 
```

我基本上是在重写我的 URL，所以一切都在通过`index.php`页面。

如何强制开启**HTTPS (SSL**`www.domain.com/login` )`/register`和`/settings`？所以当我尝试访问时，`http://www.domain.com/login`我应该立即被重定向到`https://www.domain.com/login`？

我搜索了 SO 并找到了文件夹，所以如果我有文件夹，它会起作用，但在这种**已经重写**URL`/login`的情况下不适用于我。

 *** * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T08:06:29.140

使用 mod_rewrite 你应该能够做这样的事情

```
 RewriteCond     %{SERVER_PORT} !443
    RewriteCond     %{REQUEST_URI} ^/register
    RewriteRule     (.*) https://www.domain.com/register [R] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T08:18:47.950

尝试：

```
RewriteEngine On
RewriteCond %{SERVER_PORT} !^443$
RewriteRule ^login$ https://www.domain.com/login     [R=301,L]
RewriteRule ^register$ https://www.domain.com/register [R=301,L]
RewriteRule ^settings$ https://www.domain.com/settings [R=301,L] 
```**

# json - JSON 结果为变量并存储在隐藏的输入字段中

> ID：11381620
> 
> 赞同：0
> 
> 时间：2012-07-08T08:03:17.317
> 
> 标签：json, hidden-field

我在下面编写的代码非常适合将我的销售税计算结果显示到跨度标签中。但是，我不明白如何将“总”值更改为我可以使用的变量。

```
<script type="text/javascript">
    function doStateTax(){
        var grandtotalX = $('#GRANDtotalprice').val();
        var statetaxX = $('#ddl').val();

        $.post('statetax.php',
        {statetaxX:statetaxX, grandtotalX:grandtotalX}, 
        function(data) {
        data = $.parseJSON(data);
        $('.products-placeholder').html(data.products);     
        $('.statetax-placeholder').html(data.statetax);     
        $('.total-placeholder').html(data.total);                               
        // ...
        });
        return false;
    };
</script> 
```

目前，$('.total-placeholder').html(data.total); 已成功将总数放入此处：

```
<span class="total-placeholder"></span> 
```

但是我如何使 (data.total) 部分成为变量？在弄清楚这一点的帮助下，我可以将该变量作为“值”传递到隐藏的输入字段中，并成功地为 Authorize.net 提供适当的总数

我试过了，但 id 没有用（请参阅 testtotal 部分以了解我要完成的工作）..

```
function(data) {
    data = $.parseJSON(data);
    $('.products-placeholder').html(data.products);     
    $('.statetax-placeholder').html(data.statetax);     
    $('.total-placeholder').html(data.total);       
    $testtotal = (data.total);                      
    // ... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T08:36:31.057

如果您在表单中使用隐藏字段，您可以执行以下操作：

```
//inside $.post -> success handler.
$('.total-placeholder').html(data.total);
$('input[name=yourHiddenFieldName]', yourForm).val(data.total); 
```

现在将与通常的提交一起提交。或者，如果您想在其他地方访问数据：

```
var dataValue = $('input[name=yourHiddenFieldName]', yourForm).val(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T08:08:48.743

如果你想让'testotal'在函数范围之外被识别，你需要在函数之外定义它，然后你可以在其他地方使用它：

```
 var $testtotal;
 function(data) {
                data = $.parseJSON(data);
                $('.products-placeholder').html(data.products);     
                $('.statetax-placeholder').html(data.statetax);     
                $('.total-placeholder').html(data.total); 
                $testtotal = (data.total); 
```

**编辑**：

评论变得太长了，所以我会在这里尝试解释：

PHP 无法访问在 javascript 中定义的变量，反之亦然，PHP 知道您的 javascript 变量的唯一方法是您在 HTTP 请求（常规或 ajax）中传递该变量。

因此，如果要将`$testtotal`变量传递给 php，则需要发出 ajax 请求（或普通的旧 HTTP 请求）并将变量发送到 php 脚本，然后用于`$_GET/$_POST` 检索它。

希望能回答您的问题，如果没有，请编辑您的问题，以便更清楚。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T08:13:05.953

成功调用后，您正在调用的“数据”对象可以在范围内的任何地方使用。像这样：

```
$.post('statetax.php',
{statetaxX:statetaxX, grandtotalX:grandtotalX}, 
function(data) {
    data = $.parseJSON(data);

    var total = data.total;
    var tax = data.total * 0.19;
});

return false;
}; 
```

每当您取回一个对象时，总是尝试使用 alert() 或 console.log() 查看它是什么。

```
alert(data); // This would return <object> or <undefined> or <a_value> etc. 
```

之后尝试深入研究（当不是“未定义”时）。

```
alert(data.total); // <a_value>? 
```

# google-app-engine - Restlet 是否真的适用于 GWT 2.4

> ID：11381626
> 
> 赞同：0
> 
> 时间：2012-07-08T08:03:48.377
> 
> 标签：google-app-engine, gwt, restlet

我有一个使用 Objectify 在 Google App Engine 上运行的后端，并已开始尝试向其添加 REST Web 服务。我只读过关于 Restlet 的好东西，所以我决定从那里开始——我查看了第一个应用程序示例并完成了它——设置了所有内容，最后我在客户端遇到了以下问题：

```
private final UserResourceProxy userResourceProxy = GWT.create(UserResourceProxy.class); 
```

其中 UserResourceProxy 如下

```
import org.restlet.client.resource.ClientProxy;
import org.restlet.client.resource.Delete;
import org.restlet.client.resource.Get;
import org.restlet.client.resource.Put;
import org.restlet.client.resource.Result;

import com.exposure101.lifelogger.shared.entity.User;

public interface UserResourceProxy extends ClientProxy {

  @Get
  public void find(String emailAddress, Result<User> callback);

  @Put
  public void persist(User user, Result<User> callback);

  @Delete
  public void delete(Result<Void> callback);
} 
```

这是我得到的堆栈跟踪 - 似乎它不知道如何在 GWT 2.4 中创建 ClientProxy

```
java.lang.RuntimeException: Deferred binding failed for 'com.exposure101.lifelogger.client.rest.proxy.UserResourceProxy' (did you forget to inherit a required module?)
  at com.google.gwt.dev.shell.GWTBridgeImpl.create(GWTBridgeImpl.java:53)
  at com.google.gwt.core.client.GWT.create(GWT.java:97)
  at com.exposure101.lifelogger.client.App.<init>(App.java:20)
  at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
  at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)
  at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)
  at java.lang.reflect.Constructor.newInstance(Constructor.java:513)
  at com.google.gwt.dev.shell.ModuleSpace.rebindAndCreate(ModuleSpace.java:465)
  at com.google.gwt.dev.shell.ModuleSpace.onLoad(ModuleSpace.java:375)
  at com.google.gwt.dev.shell.OophmSessionHandler.loadModule(OophmSessionHandler.java:200)
  at com.google.gwt.dev.shell.BrowserChannelServer.processConnection(BrowserChannelServer.java:525)
  at com.google.gwt.dev.shell.BrowserChannelServer.run(BrowserChannelServer.java:363)
  at java.lang.Thread.run(Thread.java:662)
Caused by: java.lang.IncompatibleClassChangeError: Found interface com.google.gwt.core.ext.typeinfo.JClassType, but class was expected
  at org.restlet.rebind.ClientProxyGenerator.generate(ClientProxyGenerator.java:239)
  at com.google.gwt.core.ext.GeneratorExtWrapper.generate(GeneratorExtWrapper.java:48)
  at com.google.gwt.core.ext.GeneratorExtWrapper.generateIncrementally(GeneratorExtWrapper.java:60)
  at com.google.gwt.dev.javac.StandardGeneratorContext.runGeneratorIncrementally(StandardGeneratorContext.java:647)
  at com.google.gwt.dev.cfg.RuleGenerateWith.realize(RuleGenerateWith.java:41)
  at com.google.gwt.dev.shell.StandardRebindOracle$Rebinder.rebind(StandardRebindOracle.java:78)
  at com.google.gwt.dev.shell.StandardRebindOracle.rebind(StandardRebindOracle.java:268)
  at com.google.gwt.dev.shell.ShellModuleSpaceHost.rebind(ShellModuleSpaceHost.java:141)
  at com.google.gwt.dev.shell.ModuleSpace.rebind(ModuleSpace.java:585)
  at com.google.gwt.dev.shell.ModuleSpace.rebindAndCreate(ModuleSpace.java:455)
  at com.google.gwt.dev.shell.GWTBridgeImpl.create(GWTBridgeImpl.java:49)
  at com.google.gwt.core.client.GWT.create(GWT.java:97)
  at com.exposure101.lifelogger.client.App.<init>(App.java:20)
  at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
  at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)
  at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)
  at java.lang.reflect.Constructor.newInstance(Constructor.java:513)
  at com.google.gwt.dev.shell.ModuleSpace.rebindAndCreate(ModuleSpace.java:465)
  at com.google.gwt.dev.shell.ModuleSpace.onLoad(ModuleSpace.java:375)
  at com.google.gwt.dev.shell.OophmSessionHandler.loadModule(OophmSessionHandler.java:200)
  at com.google.gwt.dev.shell.BrowserChannelServer.processConnection(BrowserChannelServer.java:525)
  at com.google.gwt.dev.shell.BrowserChannelServer.run(BrowserChannelServer.java:363)
  at java.lang.Thread.run(Thread.java:662) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T11:05:45.947

此错误通常意味着您正在使用针对 GWT 2.1 或更早版本和 GWT 2.2 或更高版本编译的库：GWT 2.2 引入了二进制不兼容性。不过，没有源级别的重大更改，因此针对 GWT 2.2 重新编译第三方库足以使其与 GWT 2.2 或更高版本一起使用。

In other words: try using a more recent version of Restlet; one that has been compiled against a recent version of GWT.

# php - 使用 PHP 命令行或 SSH 运行多个 PHP 文件

> ID：11381638
> 
> 赞同：2
> 
> 时间：2012-07-08T08:05:46.823
> 
> 标签：php, file, command

我有 137 个 php 文件，我想在一个命令中（并行）而不是按顺序运行它们。但问题是每个文件需要 2-5 秒。所以我试图制作一个（.sh）文件并将每一行作为：

```
/usr/bin/php /files/file1.php
/usr/bin/php /files/file2.php
/usr/bin/php /files/file3.php 
```

它将完成 file1，然后按顺序运行 file2 和 file3。那么请什么是php或sh命令一键运行137个php文件（并行）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-08T08:09:48.547

你把它们放在后台。

```
for ($i=1; $i<=137; $i++) {
    exec("/usr/bin/php /files/file$i.php > /dev/null 2>&1 &");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T08:11:25.813

通过添加“nohup”和“&”在后台运行脚本

```
nohup /usr/bin/php /files/file1.php &
nohup /usr/bin/php /files/file2.php &
nohup /usr/bin/php /files/file3.php & 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T08:11:27.417

您可以使用 pcntl lib ，它在 php 中启用线程，您可以使用它并创建一个将调用 other 的 php-master 文件，然后您可以从命令文件中主控文件

# bash - 查找字符串中每个单词的第一个字母

> ID：11381641
> 
> 赞同：0
> 
> 时间：2012-07-08T08:06:13.940
> 
> 标签：bash, sed, grep

如何使用 bash 找到字符串中包含的单词的第一个字母。

例如

代码：

```
str="my-custom-string' 
```

我想找到m，c，s。我知道如何找到第一个字母，但这稍微复杂一些。非常感谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T08:10:27.887

```
$ echo 'my-custom-string' | egrep -o '\b\w'
m
c
s 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-08T09:50:13.073

使用参数替换的纯 Bash。去掉减号，选择每个单词的第一个字符：

```
str="my-custom-string"

for word in ${str//-/ }; do
    echo "${word:0:1}"
done 
```

结果

```
m
c
s 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-08T11:00:23.023

这是一个`sed`版本：

```
echo 'my-custom-string' | sed 's/\(^\|-\)\(.\)[^-]*/\2\n/g' 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-08T13:40:10.820

这可能对你有用（GNU sed）；

```
echo 'my-custom-string' | sed 's/\B.//g;y/-/,/'
m,c,s 
```

或者：

```
echo 'my-custom-string' | sed 's/\B.//g;y/-/\n/'
m
c
s 
```

# android - Android：在各种活动之间共享 facebook 会话对象

> ID：11381646
> 
> 赞同：1
> 
> 时间：2012-07-08T08:07:48.547
> 
> 标签：android, facebook, session, android-activity, sharedpreferences

我需要在我的 android 应用程序中实现 facebook 的分享功能。我的情况是我必须能够在所有其他活动中使用在启动屏幕中创建的 facebook 对象。我已经检查了 SO 中的相关问题并找到了下面提到的链接。现在我在猜测，其中哪一种是理想的实现方式。请让我知道您对这些方法的看法，或者如果您有自己的方法，请告诉我。

[跨 Android 活动共享一个全局 facebook 对象](https://stackoverflow.com/questions/5276354/sharing-a-global-facebook-object-across-android-activities)

[Facebook android：在活动之间传递 facebook 对象](https://stackoverflow.com/questions/10419499/facebook-android-passing-facebook-object-between-activities)

[Android：跨活动传递 Facebook 会话](https://stackoverflow.com/questions/10558973/android-passing-a-facebook-session-across-activities?rq=1)

[来自多个活动的 Facebook 墙贴](https://stackoverflow.com/questions/7361288/not-able-to-call-facebook-feature-on-other-activitys) 在上面提到的答案中

**第一个解决方案**处理在应用程序上下文中创建 facebook 对象并在应用程序之间共享：

```
public class GlobalVars extends Application {

public static final String APP_ID = "123456789";    
public Facebook facebook = new Facebook(APP_ID); 
```

}

**第二个解决方案**说明了共享首选项的使用。创建有效的 facebook 会话后，它会存储在 sharedpreferences 中，并在需要时在每个活动中恢复。

```
SharedPreferences prefs = getApplicationContext().getSharedPreferences("facebook",MODE_PRIVATE);
String access_token = prefs.getString("access_token", null);
long expires = prefs.getLong("access_expires", 0);
if(access_token != null) {
facebook.setAccessToken(access_token);
}
if(expires != 0) {
facebook.setAccessExpires(expires);
} 
```

**第三个解决方案**说明了使用 parcelable 实现。

```
public void writeToParcel(Parcel out, int flags) {
out.writeInt(mData); 
```

}

**第四种解决方案**是尝试创建一个包含静态 Facebook 对象的类，并尝试在所有活动中使用相同的对象。

```
Class Utiltiy {
public static Facebook mFacebook;

public static void initialize() {
   mFacebook = new Facebook(app_id);
}
}

Utility.mFacebook.request(....). 
```

感谢您浏览整个帖子。请提出合适的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T08:37:07.347

[在Android Account Manager](http://developer.android.com/reference/android/accounts/AccountManager.html)中存储 facebook 凭据还有另一种方法。如果用户安装了 facebook 应用程序并且已经登录，您可以从客户经理那里获得他的凭据。此方法为用户提供了一个中心点（设置 -> 帐户）来定义其凭据。从那里您可以自定义它们甚至删除它们。

# java - 输入字符串之间的模式

> ID：11381647
> 
> 赞同：1
> 
> 时间：2012-07-08T08:07:55.023
> 
> 标签：java, pattern-matching

我如何在java中从一系列3-4个字符串（每个字符串大约10个字符）中找到一个模式。

即在 A8VMEV​​6F、N4VSEH5C、A3VEEJ8V、K5VTEH2M 等用户输入字符串中查找模式（这里的字符串是 8 个字符）。

请指点..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T08:52:21.593

您可以使用[Levenshtein-Distance](http://en.wikipedia.org/wiki/Levenshtein_distance)算法的变体来查找公共子字符串。维基百科页面很有启发性，并且包含代码示例。

但也许你应该先解释一下，你的样本中的模式是什么。

# jquery - 在 ASP .NET 中使用 jQuery 和母版页更改菜单样式

> ID：11381658
> 
> 赞同：0
> 
> 时间：2012-07-08T08:09:44.853
> 
> 标签：jquery, asp.net, css, master-pages

我使用 jQuery 在 ASP.NET 母版页上创建了一个垂直菜单。以下是一些需要考虑的事项：

*   菜单结构基于有序列表。列表项具有包含子菜单选项的嵌套项 (UL)。
*   加载页面时，所有子菜单必须显示为折叠状态。这很容易通过 display: none 子菜单样式规则来完成。但是，即使禁用 Java 脚本，该网站也应该运行。所以我想我会设置子菜单规则样式来显示：在 $(document).ready(function ()) 期间阻止并将显示更改回“none”。因此，如果 JavaScript 被禁用，菜单将显示所有已展开的子菜单项。

问题：当前启用 JavaScript 时，加载页面时所有子菜单选项都展开，然后在运行 jQuery 就绪方法后，子菜单使用以下命令折叠：

```
$('.menu li > .sub-menu').hide(); 
```

我想显示所有子菜单项已经折叠的页面，并避免在页面加载后折叠子菜单项。我怎样才能做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T08:22:01.610

也许您可以有 2 个版本的菜单，也许您可​​以使用**noscript**标记并将您的非 JavaScript 菜单版本放在那里

或者另一个选择是你可以在菜单之后添加一个**脚本标签**

```
$('.menu li > .sub-menu').hide(); 
```

没有 $(document).ready

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T08:23:26.180

我想，我刚刚找到了答案。您想要的是将这些子菜单的 CSS 设置为`display: none;`，然后在 noscript 标记中创建一个重复的子菜单。如果启用了js，noscript版本是不显示的，其他的也是css的原因。如果 JS 被禁用，CSS 将作用于 JS 版本，但 noscript 标签会生效。

# api - 使用 api 添加的 Foursquare 场地未显示在无用户搜索中

> ID：11381660
> 
> 赞同：1
> 
> 时间：2012-07-08T08:10:03.097
> 
> 标签：api, foursquare

我通过附加到我的访问令牌的 api 添加了一个四方场地。`ll`我已经包含了所有正确的字段、名称、城市、ll 等，并且当我使用经过身份验证的 api 时根据参数搜索场地时，它显示为第一个结果。但是，如果我使用附加到另一个访问令牌的 api 进行搜索，或者进行无用户搜索，则它不会显示在该结果集中。如果我添加一个`query`参数并搜索名称，它会显示出来。

我是否遗漏了一些关于我应该如何创建场地的信息，比如某种 make_public 标志？我希望能够创建一个带有 an 标记的场所`ll`，然后在将相同`ll`的参数传递到任何类型的 api（经过身份验证而不是未经身份验证）时显示它。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T16:16:07.627

这个场地是“家”场地吗？如果是这样，请参阅[http://blog.foursquare.com/2011/09/29/making-your-house-into-a-home/](http://blog.foursquare.com/2011/09/29/making-your-house-into-a-home/)它谈到了一些混淆foursquare在家庭场所周围的行为，这可以解释你观察到的行为

**更新：** 由于您添加的场地有 0 次签到，因此它被视为低质量场地，并被绕过以支持附近更高质量的结果。为创作用户返回它的原因是因为我们认为它与该用户高度相关。所有其他用户可能需要专门搜索该场所才能看到它（由于该场所获得签到/活动，它可能会自然地开始出现以进行无查询搜索）。例如，如果我在该位置搜索“图书馆”，我会返回您的结果：[https ://developer.foursquare.com/docs/explore#req=venues/search%3Fll%3D37.7754738,-122.39986550000003%26query %3图书馆](https://developer.foursquare.com/docs/explore#req=venues/search%3Fll%3D37.7754738,-122.39986550000003%26query%3Dlibrary)

# php - 通过 PHP 切换到 css 的链接

> ID：11381667
> 
> 赞同：-2
> 
> 时间：2012-07-08T08:11:26.357
> 
> 标签：php, html, css, if-statement

如果检测到特殊 URL，我的想法是切换到 CSS 文件的多个链接。但我有一个麻烦：我的代码在第一个 if..else 语句中只包含 css。它不依赖于 URL。

这是我的代码。 [http://pastebin.com/Jm3QFDmH](http://pastebin.com/Jm3QFDmH)

**从 pastebin 移植**

```
<?php
// get first folder in URL
$f_folder = substr(substr($_SERVER["REQUEST_URI"],1), 0, strpos(substr($_SERVER["REQUEST_URI"],1), "/"));
//get full directory structure from URL for current page
$full_path = rtrim(dirname($_SERVER['PHP_SELF']), '/\\');
//css for account
if ($f_folder='account') {
?>
    <link rel="stylesheet" href="/mainstyle/common.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="/mainstyle/account.css" type="text/css" charset="utf-8" />
<?php 
} elseif ($f_folder='signin'||$f_folder='signup'||$full_path='/account/resetPassword'||$full_path='/account/logout') {
?>
    <link rel="stylesheet" href="/mainstyle/login-signup.css" type="text/css" charset="utf-8" />
<?php
} else {
?>
    <link rel="stylesheet" href="/mainstyle/common.css" type="text/css" charset="utf-8" />
<?php
}
?> 
```

错在哪里？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-08T08:24:08.993

if 和 elseif，应该有 == 比较运算符，而不是 = 赋值

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-08T08:21:46.810

第 7 行应该是

```
if ($f_folder=='account') { 
```

# javascript - 为什么javascript说没有定义addcallback函数？

> ID：11381669
> 
> 赞同：0
> 
> 时间：2012-07-08T08:11:27.623
> 
> 标签：javascript, actionscript-3, flash, html, swfobject

我第一次来这里。

我的问题在于 AS3、Javascript 以及可能的浏览器 Firefox 和 IE。

我已经做了很多寻找答案的工作，所以我将打印我的代码：

我正在使用这一行来调用 flash 应用程序，并且在所有浏览器中它的可战斗性和实际跟踪在 firebug 中保存一个 OBJECT->FLASH_ID，所以这不是问题。

```
var obj = document.getElementById('test'); 
```

然后我使用addcallback：

```
obj.sendStatus(loggedIn); 
```

现在奇怪的是我用铬追踪所有单独的元素

1.  -obj = 闪存对象
2.  -sendStatus = flash->函数
3.  -loggedIn = false 或 true；

一切都很好，但是当我在 Firefox 上时，或者它的追踪方式不同

1.  -obj = 闪存对象
2.  -sendStatus = 未定义
3.  -loggedIn = true 或 false；

现在我错过了什么？？？？？？？？？

1.  我尝试嵌入而不是对象插入
2.  我确保 id 都是唯一的
3.  我检查以确保我使用 getElementById 选择了正确的 Flash 对象

我很困惑..感觉很简单。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T08:32:12.463

我知道一些与浏览器相关的计时问题，使 Flash 对象的接口可用......

计时器可能会有所帮助，试试这个：

```
var obj = document.getElementById('test');
setTimeout(function(){obj.sendStatus(loggedIn);}, 500); 
```

500 有点长，但可以肯定的是。如果有效，您可以尝试将其降低到 200 - 300。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T08:40:04.997

问题是使用`ExternalInterface`需要双方（`browser`和`flash`）都准备好。

您可以让 flash 轮询页面中的一个方法，该方法只返回 true，以便您知道它已准备好接收来自 flash 的调用。

另一方面，如果页面被缓存，有时可能会发生页面想在闪存准备好之前发送到闪存，所以我使用一个回调页面告诉它闪存准备好，所以它就像一个握手，一旦双方准备好了，那么我们就可以开始来回发送数据了。

这是我自 Firefox 3 以来的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T15:41:11.560

1.  确保您在嵌入标签和对象标签中都声明了 allowScriptAccess = sameDomain 以防您不使用 swfObject

2.  也许你获得对 swf 的引用的方式是错误的，试试这个

    ```
    function thisMovie(movieName) {
         if (navigator.appName.indexOf("Microsoft") != -1) {
             return window[movieName];
         } else {
             return document[movieName];
         }
     } 
    ```

[http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/external/ExternalInterface.html](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/external/ExternalInterface.html)

# android - 如何在安装过程中将文件从资产复制到 SD 卡

> ID：11381670
> 
> 赞同：1
> 
> 时间：2012-07-08T08:12:01.507
> 
> 标签：android, android-sdcard

我无法将文件从资产文件夹复制到 SD 卡。我怎样才能做到这一点？**或者有没有办法在安装应用程序期间**将文件从资产或任何其他文件夹复制到 sd 卡？这是我的代码：

```
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;

import android.os.Bundle;
import android.app.Activity;
import android.content.res.AssetManager;
import android.util.Log;
import android.view.Menu;
import android.view.MenuItem;
import android.support.v4.app.NavUtils;

public class MainActivity extends Activity {

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    CopyAssets();
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}

private void CopyAssets() { 
    AssetManager assetManager = getAssets(); 
    String[] files = null; 
    try { 
        files = assetManager.list(""); 
    } catch (IOException e) { 
        Log.e("tag", e.getMessage()); 
    } 
    for(String filename : files) { 
        InputStream in = null; 
        OutputStream out = null; 
        try { 
          in = assetManager.open(filename); 
          out = new FileOutputStream("/sdcard/" + filename); 
          copyFile(in, out); 
          in.close(); 
          in = null; 
          out.flush(); 
          out.close(); 
          out = null; 
        } catch(Exception e) { 
            Log.e("tag", e.getMessage()); 
        }        
    } 
} 
private void copyFile(InputStream in, OutputStream out) throws IOException { 
    byte[] buffer = new byte[1024]; 
    int read; 
    while((read = in.read(buffer)) != -1){ 
      out.write(buffer, 0, read); 
    } 
}

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T08:30:34.360

你不应该硬编码存储目录。使用**Environment.getExternalStorageDirectory()**

```
String destFile = Environment.getExternalStorageDirectory().toString().concat("/ans");
try {

        File f2 = new File(destFile);
        InputStream in = getAssets().open("try.xml");
        OutputStream out = new FileOutputStream(f2);

        byte[] buf = new byte[1024];
        int len;
        while ((len = in.read(buf)) > 0) {
            out.write(buf, 0, len);
        }
        in.close();
        out.close();
        System.out.println("File copied.");
    } catch (FileNotFoundException ex) {
        System.out
                .println(ex.getMessage() + " in the specified directory.");

    } catch (IOException e) {
        System.out.println(e.getMessage());
    } 
```

在清单中添加权限

```
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" /> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-08T08:24:32.430

要在 sdcard 中写入文件，您必须授予清单上的权限

```
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" /> 
```

你是否？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-16T13:32:52.960

将此代码添加到您的 onCreate。因此，您的应用程序在安装后第一次启动时，将资产复制到 SD 卡的功能，然后在您再次进入应用程序时不再调用它。

```
 SharedPreferences score = PreferenceManager.getDefaultSharedPreferences(getApplicationContext());
    Editor score_inc = score.edit();
    int counter = score.getInt("counter",0);
    float font_size = score.getFloat("font_size",20.0f);
    if(counter==0)
    {
        //Put your function to copy files here
        score_inc.putInt("counter", ++counter);
        score_inc.commit();
        Toast.makeText(getApplicationContext(), "Success", Toast.LENGTH_SHORT).show();
    } 
```

# java - 在 iMac 中创建文件会引发 IOException

> ID：11381671
> 
> 赞同：0
> 
> 时间：2012-07-08T08:12:05.857
> 
> 标签：java, macos, ioexception

我没有 iMac，但是 2 位用户在启动我的应用程序时在他们的 iMac 上遇到了同样的问题。应用程序首先通过以下代码在用户主文件夹中创建一个文件夹 + 一个文件（如果在其中找不到它们）：

```
final String FILE_SEPARATOR = System.getProperty( "file.separator" );
File homeFolder = new File( System.getProperty( "user.home" ) + FILE_SEPARATOR + ".testAPP" + FILE_SEPARATOR + "database" );
String dataFilePath = homeFolder.getCanonicalFile() + FILE_SEPARATOR + "data.xml";
if( !homeFolder.exists() ) homeFolder.mkdirs();
File dataFile = new File( dataFilePath );               
dataFile.createNewFile();  // Throws IOException 
```

这段代码在最后一行为他们俩抛出了这个异常：

```
java.io.IOException: No such file or directory
at java.io.UnixFileSystem.createFileExclusively(Native Method)
at java.io.File.createNewFile(File.java:883) 
```

**导致这种情况的 iMac 是否有特定限制？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T09:16:35.453

通过 String concat 和 FILE_SEPARATOR 创建路径是一种不可靠的方式。mkdirs() 执行也可能失败，因此检查返回值很重要。试试这种方式：

```
File homeFolder = new File(System.getProperty("user.home"));
File testAppDir = new File(homeFolder, ".testAPP");
File databaseDir = new File(testAppDir, "database");
File dataFile = new File(databaseDir, "data.xml");
if (!databaseDir.isDirectory())
    if (!databaseDir.mkdirs())
        throw new IOException("Failed to create directory");
dataFile.createNewFile(); 
```

# javascript - 检测移动浏览器

> ID：11381673
> 
> 赞同：1123
> 
> 时间：2012-07-08T08:13:21.883
> 
> 标签：javascript, browser-detection, mobile-browser, platform-detection

如果用户有移动浏览器，我正在寻找一个返回布尔值的函数。

我知道我可以`navigator.userAgent`通过使用正则表达式来使用和编写该函数，但是对于不同的平台，用户代理的种类太多了。我怀疑匹配所有可能的设备会很容易，而且我认为这个问题已经解决了很多次，所以应该有某种完整的解决方案来完成这样的任务。

我在看[这个网站](http://detectmobilebrowsers.com)，但遗憾的是这个脚本太神秘了，我不知道如何将它用于我的目的，即创建一个返回真/假的函数。

* * *

## 回答 #1

> 赞同：1596
> 
> 时间：2012-07-08T08:24:22.633

## 使用正则表达式（来自[detectmobilebrowsers.com](http://detectmobilebrowsers.com)）：

这是一个使用非常长而全面的正则表达式的函数，它根据用户是否正在使用移动设备浏览返回一个`true`或值。`false`

```
window.mobileCheck = function() {
  let check = false;
  (function(a){if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4))) check = true;})(navigator.userAgent||navigator.vendor||window.opera);
  return check;
}; 
```

对于那些希望在此测试中包含平板电脑的人（尽管可以说您不应该），您可以使用以下功能：

```
window.mobileAndTabletCheck = function() {
  let check = false;
  (function(a){if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4))) check = true;})(navigator.userAgent||navigator.vendor||window.opera);
  return check;
}; 
```

* * *

## 使用 navigator.userAgentData

您也可以使用`navigator.userAgentData.mobile`，但`userAgentData`仍处于试验阶段，因此不建议在生产中使用。

```
const isMobile = navigator.userAgentData.mobile; //resolves true/false 
```

[userAgentData 的兼容性图表](https://caniuse.com/mdn-api_navigator_useragentdata)

* * *

## 原始答案

您可以通过简单地运行设备列表并检查是否`useragent`匹配如下来做到这一点：

```
 function detectMob() {
    const toMatch = [
        /Android/i,
        /webOS/i,
        /iPhone/i,
        /iPad/i,
        /iPod/i,
        /BlackBerry/i,
        /Windows Phone/i
    ];

    return toMatch.some((toMatchItem) => {
        return navigator.userAgent.match(toMatchItem);
    });
} 
```

但是，由于您认为这种方法不可靠，您可以假设任何分辨率为*800x600*或更低的设备也是移动设备，从而进一步缩小您的目标（尽管如今许多移动设备的分辨率远高于此）

IE

```
 function detectMob() {
    return ( ( window.innerWidth <= 800 ) && ( window.innerHeight <= 600 ) );
  } 
```

**参考：**

*   [使用 javascript 检测浏览器和设备](http://www.quirksmode.org/js/detect.html)

* * *

## 回答 #2

> 赞同：359
> 
> 时间：2013-01-13T08:24:28.340

怎么样：

```
if (typeof screen.orientation !== 'undefined') { ... } 
```

...因为智能手机通常支持此属性而桌面浏览器不支持。参见[MDN](https://developer.mozilla.org/en-US/docs/Web/API/Window/orientation)。

**编辑1：**正如@Gajus 指出的那样，`window.orientation`现在**已弃用**，不应使用。

**编辑 2：**您可以使用实验性`screen.orientation`而不是弃用的`window.orientation`. 参见[MDN](https://developer.mozilla.org/en-US/docs/Web/API/Screen/orientation)。

**编辑 3：**从 window.orientation 更改为 screen.orientation

* * *

## 回答 #3

> 赞同：143
> 
> 时间：2012-12-11T11:20:17.240

```
var isMobile = {
    Android: function() {
        return navigator.userAgent.match(/Android/i);
    },
    BlackBerry: function() {
        return navigator.userAgent.match(/BlackBerry/i);
    },
    iOS: function() {
        return navigator.userAgent.match(/iPhone|iPad|iPod/i);
    },
    Opera: function() {
        return navigator.userAgent.match(/Opera Mini/i);
    },
    Windows: function() {
        return navigator.userAgent.match(/IEMobile/i) || navigator.userAgent.match(/WPDesktop/i);
    },
    any: function() {
        return (isMobile.Android() || isMobile.BlackBerry() || isMobile.iOS() || isMobile.Opera() || isMobile.Windows());
    }
}; 
```

如何使用

```
if( isMobile.any() ) alert('Mobile'); 
```

要检查用户是否在特定的移动设备上：

```
if( isMobile.iOS() ) alert('iOS'); 
```

参考：[http ://www.abeautifulsite.net/blog/2011/11/detecting-mobile-devices-with-javascript](http://www.abeautifulsite.net/blog/2011/11/detecting-mobile-devices-with-javascript)

github 上的增强版：[https ://github.com/smali-kazmi/detect-mobile-browser](https://github.com/smali-kazmi/detect-mobile-browser)

* * *

## 回答 #4

> 赞同：118
> 
> 时间：2015-04-08T08:11:31.107

[这是来自facebook弹弓](https://www.facebook.com/slingshot)来源的简单解决方案

```
var isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
if (isMobile) {
  /* your code here */
} 
```

* * *

## 回答 #5

> 赞同：48
> 
> 时间：2016-04-17T05:58:09.640

来到这里寻找一种简单、干净的方法来检测“触摸屏设备”，我将其归类为移动设备和平板电脑。在当前答案中没有找到干净的选择，但确实制定了以下内容，这也可能对某人有所帮助。

```
var touchDevice = ('ontouchstart' in document.documentElement); 
```

**编辑**：要同时支持带有触摸屏的桌面和手机，您可以使用以下内容：

```
var touchDevice = (navigator.maxTouchPoints || 'ontouchstart' in document.documentElement); 
```

* * *

## 回答 #6

> 赞同：40
> 
> 时间：2017-08-14T01:53:21.980

根据**[MDN 关于使用用户代理进行浏览器检测的文章](https://developer.mozilla.org/en-US/docs/Web/HTTP/Browser_detection_using_the_user_agent)**，鼓励尽可能避免这种方法，并建议其他途径，例如特征检测。

但是，如果必须使用用户代理来检测设备是否是移动的，他们建议：

> 总之，我们建议在用户代理中的任意位置查找字符串“Mobi”来检测移动设备。

因此，这个单行就足够了：

`const isMobileDevice = window.navigator.userAgent.toLowerCase().includes("mobi");`

**[更新]：**

正如@zenw0lf 在评论中建议的那样，使用正则表达式会更好：

`const isMobileDevice = /Mobi/i.test(window.navigator.userAgent)`

* * *

## 回答 #7

> 赞同：31
> 
> 时间：2018-08-09T18:57:26.003

正如许多人所说，依赖用户代理数据的移动目标是有问题的。计算屏幕尺寸也是如此。

我的方法是借用**CSS 技术**来确定界面是否是触摸的：

仅使用 javascript（所有现代浏览器都支持），[媒体查询](https://developer.mozilla.org/en-US/docs/Web/CSS/Media_Queries/Using_media_queries#Media_features)匹配可以轻松推断设备是否是*移动*设备。

```
function isMobile() {
    var match = window.matchMedia || window.msMatchMedia;
    if(match) {
        var mq = match("(pointer:coarse)");
        return mq.matches;
    }
    return false;
} 
```

* * *

## 回答 #8

> 赞同：15
> 
> 时间：2012-12-04T16:19:51.147

这是一个比匹配更有效的 userAgent 解决方案...

```
function _isMobile(){
    // if we want a more complete list use this: http://detectmobilebrowsers.com/
    // str.test() is more efficent than str.match()
    // remember str.test is case sensitive
    var isMobile = (/iphone|ipod|android|ie|blackberry|fennec/).test
         (navigator.userAgent.toLowerCase());
    return isMobile;
} 
```

* * *

## 回答 #9

> 赞同：15
> 
> 时间：2016-03-12T02:31:23.930

检测 JS 代码是否在移动浏览器上执行没有完美的解决方案，但以下两个选项在大多数情况下应该可以工作。

### 选项 1：浏览器嗅探

```
!function(a){var b=/iPhone/i,c=/iPod/i,d=/iPad/i,e=/(?=.*\bAndroid\b)(?=.*\bMobile\b)/i,f=/Android/i,g=/(?=.*\bAndroid\b)(?=.*\bSD4930UR\b)/i,h=/(?=.*\bAndroid\b)(?=.*\b(?:KFOT|KFTT|KFJWI|KFJWA|KFSOWI|KFTHWI|KFTHWA|KFAPWI|KFAPWA|KFARWI|KFASWI|KFSAWI|KFSAWA)\b)/i,i=/IEMobile/i,j=/(?=.*\bWindows\b)(?=.*\bARM\b)/i,k=/BlackBerry/i,l=/BB10/i,m=/Opera Mini/i,n=/(CriOS|Chrome)(?=.*\bMobile\b)/i,o=/(?=.*\bFirefox\b)(?=.*\bMobile\b)/i,p=new RegExp("(?:Nexus 7|BNTV250|Kindle Fire|Silk|GT-P1000)","i"),q=function(a,b){return a.test(b)},r=function(a){var r=a||navigator.userAgent,s=r.split("[FBAN");return"undefined"!=typeof s[1]&&(r=s[0]),s=r.split("Twitter"),"undefined"!=typeof s[1]&&(r=s[0]),this.apple={phone:q(b,r),ipod:q(c,r),tablet:!q(b,r)&&q(d,r),device:q(b,r)||q(c,r)||q(d,r)},this.amazon={phone:q(g,r),tablet:!q(g,r)&&q(h,r),device:q(g,r)||q(h,r)},this.android={phone:q(g,r)||q(e,r),tablet:!q(g,r)&&!q(e,r)&&(q(h,r)||q(f,r)),device:q(g,r)||q(h,r)||q(e,r)||q(f,r)},this.windows={phone:q(i,r),tablet:q(j,r),device:q(i,r)||q(j,r)},this.other={blackberry:q(k,r),blackberry10:q(l,r),opera:q(m,r),firefox:q(o,r),chrome:q(n,r),device:q(k,r)||q(l,r)||q(m,r)||q(o,r)||q(n,r)},this.seven_inch=q(p,r),this.any=this.apple.device||this.android.device||this.windows.device||this.other.device||this.seven_inch,this.phone=this.apple.phone||this.android.phone||this.windows.phone,this.tablet=this.apple.tablet||this.android.tablet||this.windows.tablet,"undefined"==typeof window?this:void 0},s=function(){var a=new r;return a.Class=r,a};"undefined"!=typeof module&&module.exports&&"undefined"==typeof window?module.exports=r:"undefined"!=typeof module&&module.exports&&"undefined"!=typeof window?module.exports=s():"function"==typeof define&&define.amd?define("isMobile",[],a.isMobile=s()):a.isMobile=s()}(this);

alert(isMobile.any ? 'Mobile' : 'Not mobile');
```

这个特定的浏览器嗅探代码是[**一个名为 isMobile 的库**](https://github.com/kaimallea/isMobile)的代码。

* * *

### 选项 2：window.orientation

测试是否`window.orientation`定义：

```
var isMobile = window.orientation > -1;
alert(isMobile ? 'Mobile' : 'Not mobile');
```

* * *

### 笔记

并非所有触摸屏设备都是移动设备，反之亦然。所以，如果你想实现一些专门针对触摸屏的东西，你不应该测试你的浏览器是否在移动设备上运行，而是测试设备是否支持触摸屏：

```
var hasTouchscreen = 'ontouchstart' in window;
alert(hasTouchscreen ? 'has touchscreen' : 'doesn\'t have touchscreen');
```

* * *

## 回答 #10

> 赞同：14
> 
> 时间：2013-04-05T00:48:46.893

功能检测比试图找出您正在使用的设备要好得多，而且很难跟上一直出现的新设备，像[Modernizr](http://modernizr.com/)这样的库可以让您知道特定功能是否可用。

* * *

## 回答 #11

> 赞同：12
> 
> 时间：2013-04-18T10:17:11.537

为了添加额外的控制层，我使用 HTML5 存储来检测它是使用移动存储还是桌面存储。如果浏览器不支持存储，我有一个移动浏览器名称数组，我将用户代理与数组中的浏览器进行比较。

这很简单。这是功能：

```
// Used to detect whether the users browser is an mobile browser
function isMobile() {
    ///<summary>Detecting whether the browser is a mobile browser or desktop browser</summary>
    ///<returns>A boolean value indicating whether the browser is a mobile browser or not</returns>

    if (sessionStorage.desktop) // desktop storage 
        return false;
    else if (localStorage.mobile) // mobile storage
        return true;

    // alternative
    var mobile = ['iphone','ipad','android','blackberry','nokia','opera mini','windows mobile','windows phone','iemobile']; 
    for (var i in mobile) if (navigator.userAgent.toLowerCase().indexOf(mobile[i].toLowerCase()) > 0) return true;

    // nothing found.. assume desktop
    return false;
} 
```

* * *

## 回答 #12

> 赞同：10
> 
> 时间：2015-04-24T02:34:47.177

这样的事情怎么样？

```
if(
    (screen.width <= 640) || 
    (window.matchMedia && 
     window.matchMedia('only screen and (max-width: 640px)').matches
    )
  ){
   // Do the mobile thing
} 
```

* * *

## 回答 #13

> 赞同：9
> 
> 时间：2018-03-22T10:12:17.617

检测移动设备或平板设备的一个非常好的方法是查看浏览器是否可以创建触摸事件。

纯 JavaScript 代码：

```
function isMobile() {
   try{ document.createEvent("TouchEvent"); return true; }
   catch(e){ return false; }
}

if (isMobile()) {
   # do whatever you wanna do!
} 
```

这对我来说非常有效，但包括触摸屏显示器的笔记本电脑设备可能存在问题。

我不确定触摸屏笔记本电脑是否会被检测为移动设备，因为我尚未对其进行测试。

* * *

## 回答 #14

> 赞同：7
> 
> 时间：2017-07-15T00:37:15.433

一旦元素获得焦点，您会立即对其进行模糊处理。Bootstrap-datepicker 是一个非常流行且维护良好的组件，在 GitHub 中拥有近 10,000 颗星，它使用这种方法：

```
if (window.navigator.maxTouchPoints || 'ontouchstart' in document) {
    this.input.blur();
} 
```

[https://github.com/uxsolutions/bootstrap-datepicker](https://github.com/uxsolutions/bootstrap-datepicker)

感谢[跳跳虎](https://stackoverflow.com/a/36673184)的帮助。

* * *

## 回答 #15

> 赞同：7
> 
> 时间：2018-05-01T21:40:26.377

不要使用此方法，因为 window.orientation 现在已弃用！！！

```
function isMobile() {
  return (typeof window.orientation !== "undefined") || (navigator.userAgent.indexOf('IEMobile') !== -1);
}; 
```

* * *

## 回答 #16

> 赞同：6
> 
> 时间：2015-08-06T19:21:13.657

这是我重新考虑的问题解决方案。仍然不完美。唯一真正的解决方案是设备制造商开始认真对待“Mobile”和“Tablet”用户代理字符串。

```
window.onload = userAgentDetect;
function userAgentDetect() {
  if(window.navigator.userAgent.match(/Mobile/i)
  || window.navigator.userAgent.match(/iPhone/i)
  || window.navigator.userAgent.match(/iPod/i)
  || window.navigator.userAgent.match(/IEMobile/i)
  || window.navigator.userAgent.match(/Windows Phone/i)
  || window.navigator.userAgent.match(/Android/i)
  || window.navigator.userAgent.match(/BlackBerry/i)
  || window.navigator.userAgent.match(/webOS/i)) {
    document.body.className += ' mobile';
    alert('True - Mobile - ' + navigator.userAgent);
  } else {
    alert('False - Mobile - ' + navigator.userAgent);
  }
  if(window.navigator.userAgent.match(/Tablet/i)
  || window.navigator.userAgent.match(/iPad/i)
  || window.navigator.userAgent.match(/Nexus 7/i)
  || window.navigator.userAgent.match(/Nexus 10/i)
  || window.navigator.userAgent.match(/KFAPWI/i)) {
    document.body.className -= ' mobile';
    document.body.className += ' tablet';
    alert('True - Tablet - ' + navigator.userAgent);
  } else {
    alert('False - Tablet - ' + navigator.userAgent);
  }
} 
```

当 Nexus 7 平板电脑只有 Android UA 字符串时会发生什么？首先，Mobile 变为 true，之后 Tablet 也变为 true，但 Tablet 会从 body 标签中删除 Mobile UA 字符串。

CSS：

```
body.tablet { background-color: green; }
body.mobile { background-color: red; } 
```

`alert`为开发添加的行。Chrome 控制台可以模拟许多手持设备。在那里测试。

**编辑：**

**只是不要使用它，而是使用特征检测。有这么多的设备和品牌，以品牌为目标永远不会是正确的解决方案。**

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2018-11-22T12:22:57.983

取决于用例。所有*移动*设备都需要电池。如果您追求的是计算能力而不耗尽电池，请使用[Battery Status API](https://www.w3.org/TR/battery-status/)：

```
navigator.getBattery().then(battery => {
  battery.charging ? 'charging' : 'not charging';
}); 
```

如果您正在寻找的是presentational use [`matchMedia`](https://devdocs.io/dom/window/matchmedia)，它返回一个布尔值：

```
if (window.matchMedia("(min-width: 400px)").matches) {
  /* the viewport is at least 400 pixels wide */
} else {
  /* the viewport is less than 400 pixels wide */
} 
```

或者将它们结合起来，在平板设备上获得更好的用户体验。

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2016-05-05T02:34:39.053

我建议你看看[http://wurfl.io/](http://wurfl.io/)

简而言之，如果你导入一个很小的 ​​JS 文件：

```
<script type='text/javascript' src="//wurfl.io/wurfl.js"></script> 
```

您将得到一个 JSON 对象，如下所示：

```
{
 "complete_device_name":"Google Nexus 7",
 "is_mobile":true,
 "form_factor":"Tablet"
} 
```

（当然，这是假设您使用的是 Nexus 7）并且您将能够执行以下操作：

```
if(WURFL.form_factor == "Tablet"){
    //dostuff();
} 
```

这就是你要找的。

免责声明：我为提供这项免费服务的公司工作。谢谢。

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2018-01-04T16:27:28.583

这只是我在项目中使用的已[接受答案的 es6 端口。](https://stackoverflow.com/a/11381730)请注意，这也包括平板电脑。

```
export const isMobile = () => {
  const vendor = navigator.userAgent || navigator.vendor || window.opera;

  return !!(
    /(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(
      vendor
    ) ||
    /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(
      vendor.substr(0, 4)
    )
  );
}; 
```

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2021-06-22T18:19:35.130

[仅使用matchMedia 的](https://developer.mozilla.org/en-US/docs/Web/API/Window/matchMedia)IE10+ 解决方案：

```
const isMobile = () => window.matchMedia('(max-width: 700px)').matches 
```

`isMobile()`返回一个布尔值

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2013-05-30T12:34:34.703

最好的必须是：

```
var isMobile = (/Mobile/i.test(navigator.userAgent)); 
```

但就像 Yoav Barnea 说的那样……

```
// Seem legit
var isMobile = ('DeviceOrientationEvent' in window || 'orientation' in window);
// But with my Chrome on windows, DeviceOrientationEvent == fct()
if (/Windows NT|Macintosh|Mac OS X|Linux/i.test(navigator.userAgent)) isMobile = false;
// My android have "linux" too
if (/Mobile/i.test(navigator.userAgent)) isMobile = true; 
```

在这 3 次测试之后，我希望 var isMobile 是......好的

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2013-06-01T00:25:49.890

这是他的全部功能

```
function isMobile(){
    return (/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i.test(navigator.userAgent||navigator.vendor||window.opera)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test((navigator.userAgent||navigator.vendor||window.opera).substr(0,4)))
}

jQuery.noConflict();
jQuery(document).ready(function(){
    if(isMobile()) alert("Mobile"); else alert("Not Mobile");
}); 
```

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2016-05-25T07:18:09.397

使用“window.screen.width”怎么样？

```
if (window.screen.width < 800) {
// do something
} 
```

或者

```
if($(window).width() < 800) {
//do something
} 
```

我想这是最好的方式，因为每天都有新的移动设备！

*（虽然我认为旧浏览器不支持它，但试一试:)）*

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2017-02-23T08:18:39.680

这是一个 ECMAScript 6 解决方案（TypeScript 就绪）

```
public isMobile(): boolean {
  let check = false;
  ((a => {
      if (/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0, 4))) check = true;
      }))(navigator.userAgent || navigator.vendor);
  return check;
 } 
```

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2017-05-11T19:56:38.373

请注意，大多数较新的移动设备现在的分辨率都大于 600x400。即，iPhone 6....

测试证明：在这里运行最受好评和最新的帖子，运行一次可选检查，如下所示：

```
(function(a){
    window.isMobile = (/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4)))
})(navigator.userAgent||navigator.vendor||window.opera);

alert("This browser was found to be a % browser.", window.isMobile ? 'mobile' : 'desktop'); 
```

不知何故，以下浏览器应用程序返回了以下结果。规格：iPhone 6S，iOS 10.3.1。

Safari（最新）：将其检测为移动设备。

Chrome（最新）：未将其检测为移动设备。

所以，然后我测试了[Lanti](https://stackoverflow.com/users/1442219/lanti)的建议（[https://stackoverflow.com/a/31864119/7183483](https://stackoverflow.com/a/31864119/7183483)），它确实返回了正确的结果（适用于所有 iOS 设备的移动设备，适用于我的 Mac 的桌面设备）。因此，我继续对其进行了一些编辑，因为它会触发两次（对于移动设备和平板电脑）。然后我注意到在 iPad 上进行测试时，它也作为移动设备返回，这是有道理的，因为[Lanti的参数](https://stackoverflow.com/users/1442219/lanti)使用检查操作系统比什么都重要。因此，我只是将平板电脑的 IF 语句移到了移动检查中，如果平板检查为负，则返回移动，否则返回平板。然后我为移动检查添加了 else 子句以返回为台式机/笔记本电脑，因为两者都符合条件，但随后注意到浏览器检测到 CPU 和操作系统品牌。所以我添加了那里返回的内容作为 else if 语句的一部分。为了限制它，我添加了一个警告 else 声明，以防没有检测到。见下文，将很快在 Windows 10 PC 上进行测试更新。

哦，我还添加了一个“debugMode”变量，以便在调试和正常编译之间轻松切换。

免责声明：完全归功于[Lanti](https://stackoverflow.com/users/1442219/lanti)，而且这还没有在 Windows 平板电脑上进行测试......这可能会返回桌面/笔记本电脑，因为操作系统是纯 Windows。一旦我找到一个使用它的朋友就会检查。

```
function userAgentDetect() {
    let debugMode = true;
    if(window.navigator.userAgent.match(/Mobile/i)
        || window.navigator.userAgent.match(/iPhone/i)
        || window.navigator.userAgent.match(/iPod/i)
        || window.navigator.userAgent.match(/IEMobile/i)
        || window.navigator.userAgent.match(/Windows Phone/i)
        || window.navigator.userAgent.match(/Android/i)
        || window.navigator.userAgent.match(/BlackBerry/i)
        || window.navigator.userAgent.match(/webOS/i)) {
        if (window.navigator.userAgent.match(/Tablet/i)
            || window.navigator.userAgent.match(/iPad/i)
            || window.navigator.userAgent.match(/Nexus 7/i)
            || window.navigator.userAgent.match(/Nexus 10/i)
            || window.navigator.userAgent.match(/KFAPWI/i)) {
            window.deviceTypeVar = 'tablet';
            if (debugMode === true) {
                alert('Device is a tablet - ' + navigator.userAgent);
            }
        } else {
            if (debugMode === true) {
                alert('Device is a smartphone - ' + navigator.userAgent);
            };
            window.deviceTypeVar = 'smartphone';
        }
    } else if (window.navigator.userAgent.match(/Intel Mac/i)) {
        if (debugMode === true) {
            alert('Device is a desktop or laptop- ' + navigator.userAgent);
        }
        window.deviceTypeVar = 'desktop_or_laptop';
    } else if (window.navigator.userAgent.match(/Nexus 7/i)
        || window.navigator.userAgent.match(/Nexus 10/i)
        || window.navigator.userAgent.match(/KFAPWI/i)) {
        window.deviceTypeVar = 'tablet';
        if (debugMode === true) {
            alert('Device is a tablet - ' + navigator.userAgent);
        }
    } else {
        if (debugMode === true) {
            alert('Device is unknown- ' + navigator.userAgent);
        }
        window.deviceTypeVar = 'Unknown';
    }
} 
```

* * *

## 回答 #26

> 赞同：2
> 
> 时间：2020-05-07T13:03:17.570

这就是我使用的。我知道 userAgent 嗅探是不受欢迎的，但我的需要恰好是排除之一！

```
<script>
var brow = navigator.userAgent;
    if (/mobi/i.test(brow)) {
        alert('Mobile Browser');
        // Do something for mobile
    } else {
        alert('Not on Mobile');
        // Do something for non mobile
    }
</script> 
```

* * *

## 回答 #27

> 赞同：2
> 
> 时间：2021-03-21T03:38:09.587

这是 Michael Zaporozhets 答案的模糊版本。它还使用检查仅在第一次调用时构建正则表达式。有关用于从正则表达式数组构建字符串的技术，请参[见此答案。](https://stackoverflow.com/a/34755045/384670)

```
var gRE = null;
var gRE4 = null;

function PlatformIsMobile()
{
    var e;

    if ( gRE == null )
    {
        e =
            [
                /(android|bb\d+|meego).+mobile|avantgo/,
                /bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile/,
                /ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox/,
                /netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker/,
                /pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone/,
                /wap|windows ce|xda|xiino|android|ipad|playbook|silk/
            ];

        gRE = new RegExp(
            e.map( function( r ) { return r.source } ).join( "|" ), "i"
        );
    }

    if ( gRE4 == null )
    {
        e =
            [
                /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa/,
                /abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)/,
                /aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan/,
                /be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)/,
                /c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw/,
                /da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)/,
                /el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)/,
                /g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)/,
                /haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)/,
                /i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris/,
                /ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)/,
                /le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx/,
                /m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)/,
                /mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]/,
                /n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph/,
                /o2im|op(ti|wv)|oran|owg1/,
                /p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g/,
                /qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek/,
                /r380|r600|raks|rim9|ro(ve|zo)/,
                /s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)/,
                /sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)/,
                /t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo/,
                /to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst/,
                /v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)/,
                /w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/
            ];

        gRE4 = new RegExp(
            e.map( function( r ) { return r.source } ).join( "|" ), "i"
        );
    }

    var key = navigator.userAgent || navigator.vendor || window.opera;

    return gRE.test( key ) ||
           gRE4.test( key.substr( 0, 4 ) );
} 
```

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2016-04-29T08:33:29.460

```
//true / false
function isMobile()
{
   return (/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent) ); 
} 
```

您也可以按照本教程检测特定的手机。点击[这里](http://www.sitepoint.com/detect-mobile-devices-jquery/)。

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2018-01-25T10:20:57.107

有一个简单的技巧可以检测它是否是移动设备。只需检查**ontouchstart**事件是否存在：

```
function isMobile()
{
    return "ontouchstart" in window;
} 
```

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2018-04-30T23:20:59.140

```
return 'ontouchstart' in window && window.screen.availWidth < 768
```

这个怎么样，它扩展了上面的答案，但也检查了屏幕大小

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2019-06-25T06:27:28.130

我遇到了一些情况，上面的答案对我有用。所以我想出了这个。可能对某人有帮助。

```
if(/iPhone|iPad|iPod|Android|webOS|BlackBerry|Windows Phone/i.test(navigator.userAgent)
 || screen.availWidth < 480){
//code for mobile
} 
```

这取决于您的用例。如果您专注于屏幕使用`screen.availWidth`，或者`document.body.clientWidth`如果您想基于文档进行渲染，您可以使用。

* * *

## 回答 #32

> 赞同：1
> 
> 时间：2019-10-04T12:17:57.593

使用正则表达式（来自[detectmobilebrowsers.com](http://detectmobilebrowsers.com)）：

```
/* eslint-disable */
export const IS_MOBILE = (function (a) {
  return (
    /(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i
      .test(
        a.substr(0,4)
      )
  )
  // @ts-ignore
})(navigator.userAgent || navigator.vendor || window.opera)
/* eslint-enable */ 
```

* * *

## 回答 #33

> 赞同：1
> 
> 时间：2022-02-08T07:38:27.200

# 特征检测

```
const isMobile = localStorage.mobile || window.navigator.maxTouchPoints > 1; 
```

> 自 2022-02-07 起在 Chrome + SAFARI 中工作 :: 结合特征检测并尝试此线程和其他站点中的所有内容。Chrome手机中的`localStorage.mobile`作品；后者适用于 Safari 移动版。不会在打开或不打开开发工具和/或在移动模拟器上触发桌面浏览器。在撰写本文时，它会触发真正的移动浏览器，但不会触发桌面。

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2016-03-18T11:45:22.303

这也可能是一个解决方案。

```
var isMobile = false; //initiate as false

  // device detection
  if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent) 
  || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4))) isMobile = true;

  console.log('Mobile device:'+isMobile);

  var doc_h = $(document).height(); // returns height of HTML document
  var doc_w = $(document).width(); // returns width of HTML document
  console.log('Height: '+doc_h);
  console.log('width: '+doc_w);

  var iPadVertical = window.matchMedia("(width: 768px) and (height: 1024px) and (orientation: portrait)");
  var iPadHoricontal = window.matchMedia("(width: 1024px) and (height: 767px) and (orientation: landscape)");

  console.log('Height: '+doc_h);
  console.log('width: '+doc_w);

  if (iPadVertical.matches) {
      console.log('Ipad vertical detected');
  }else if (iPadHoricontal.matches){
      console.log('Ipad horicontal detected');
  }else {
      console.log('No Ipad');
  } 
```

如果您同时使用这两种方法，您将获得检测不同设备的完美方法。

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2017-03-18T14:28:46.773

在任何情况下，必须只调用一次来检查设备类型：您的手机不会在一瞬间停留在桌面上 :)

因此，前段时间在此处建议的 userAgent 检查代码必须如下所示：

```
(function(a){window.isMobile = (/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4)))})(navigator.userAgent||navigator.vendor||window.opera);

console.info('This is %s device', window.isMoblie ? 'mobile' : 'desktop');
```

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2020-06-09T17:35:52.457

```
 // Function returns true if current device is phone
function isMobile() {

    // regex from http://detectmobilebrowsers.com/mobile
    return /(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(navigator.userAgent) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent)
}

console.log({
    isMobile: isMobile()
}); 
```

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2021-03-18T18:02:05.577

啊，是的，古老的问题......

这真的取决于你想对知识做出什么反应。

**1\. 你想改变 UI 让它很好地适应不同的屏幕尺寸吗？**

使用媒体查询。

**2\. 你想显示/隐藏东西或改变基于鼠标和触摸的功能吗？**

[上面的这个答案可以，](https://stackoverflow.com/a/36673184/4793643)但是可能存在用户同时拥有并切换的情况。在这种情况下，您可以在检测到鼠标或触摸事件时切换一些 JS 变量和/或向文档正文添加一个类

```
 window.addEventListener("mousemove", function () {
    isTouch = false;
    document.body.classList.add("canHover");
  });
  window.addEventListener("touchstart", function () {
    isTouch = true;
    document.body.classList.remove("canHover");
  }); 
```

```
body.canHover #aButtonOrSomething:hover {
  //css attributes
} 
```

```
 document
    .getElementById("aButtonOrSomething")
    .addEventListener("mouseover", showTooltip);
  document
    .getElementById("aButtonOrSomething")
    .addEventListener("click", function () {
      if (isTouch) showTooltip();
    }); 
```

**3\. 你想做一些具体的事情，知道他们有什么设备吗？**

[使用接受的答案。](https://stackoverflow.com/a/11381730/4793643)

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2022-02-04T16:25:04.047

没看到有人推荐：

```
window.navigator.connection 
```

这仅存在于移动设备上，而不存在于桌面浏览器上。只检查该属性的存在更简单，即`if(window && window.navigator && window.navigator.connection) => then it is mobile`

* * *

## 回答 #39

> 赞同：-1
> 
> 时间：2021-05-15T19:08:50.387

触摸屏和方向解决方案不适用于某些 PC。

一些笔记本电脑有触摸屏，希望将来更多。此外，虽然我自己无法测试，但一些用作屏幕的图形平板电脑具有触摸屏功能。

检测方向也不起作用。一些像 Microsoft Surface Books 这样的 PC 有一个可拆卸的屏幕，使它像平板电脑一样工作，包括方向支持。然而，它仍然是一台真正的 PC。

如果您必须检测和区分 PC 和移动设备，只需阅读用户代理。
我也不喜欢它，但它仍然是最好的方法。

* * *

## 回答 #40

> 赞同：-5
> 
> 时间：2017-10-12T12:01:41.813

我通常发现检查仅在移动视图上可见的特定元素（例如汉堡图标）的可见性的更简单方法效果很好，并且比依赖非常复杂的正则表达式更安全。这将很难 100% 地测试作品。

```
function isHidden(el) {
   return (el.offsetParent === null);
} 
```

# mysql - SQL - 选择具有最大值的所有行

> ID：11381674
> 
> 赞同：7
> 
> 时间：2012-07-08T08:13:28.137
> 
> 标签：mysql, sql, greatest-n-per-group

我有这个 SQL 查询：

```
SELECT id, COUNT(*) AS price
FROM (SELECT * FROM rt WHERE somecondition) AS st
      JOIN tt
      ON st.id = tt.id
GROUP BY id; 
```

现在，我想选择所有表中价格最高的行。我已经尝试过了，不幸的是它根本没有返回任何行：

```
SELECT id, COUNT(*) AS price
FROM (SELECT * FROM rt WHERE somecondition) AS st
      JOIN tt
      ON st.id = tt.id
GROUP BY id
HAVING price = MAX(price); 
```

我有点迷茫，有人有任何指示吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-02T13:18:00.473

这对我来说看起来相当简单：

```
select * from <table> 
where <column name> in(
   SELECT MAX(column name) FROM table
) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T08:37:55.313

试试这个解决方案：

```
SELECT a.id, a.price
FROM
(
    SELECT aa.id, COUNT(1) AS price
    FROM rt aa
    INNER JOIN tt bb ON aa.id = bb.id
    WHERE aa.somecondition
    GROUP BY aa.id
) a
INNER JOIN
(
    SELECT MAX(aa.price) AS maxprice
    FROM
    (
        SELECT COUNT(1) AS price
        FROM rt aaa
        INNER JOIN tt bbb ON aaa.id = bbb.id
        WHERE aaa.somecondition
        GROUP BY aaa.id
    ) aa
) b ON a.price = b.maxprice 
```

**编辑**：虽然我想不出任何方法来重写它以便不必冗余地编写基本查询，但您***可能***可以这样做：

```
SELECT GROUP_CONCAT(a.id) AS ids, a.price
FROM
(
    SELECT aa.id, COUNT(1) AS price
    FROM rt aa
    INNER JOIN tt bb ON aa.id = bb.id
    WHERE aa.somecondition
    GROUP BY aa.id
) a
GROUP BY a.price
ORDER BY a.price DESC
LIMIT 1 
```

这会生成共享相同最大值的 id 的逗号分隔列表。这可能不是您正在寻找的格式，但它***是***避免必须编写两次基本查询的一种方法。只是把它放在那里。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T17:26:50.707

您要求一种不需要多次说明内部查询的冗余方法。这当然是 cte 的好处。这是为使用该策略而重写的另外两个解决方案。

```
WITH basequery as (
    SELECT aa.id, COUNT(1) AS price
    FROM rt aa INNER JOIN tt bb ON aa.id = bb.id
    WHERE [aa.somecondition]
    GROUP BY aa.id
)
SELECT a.id, a.price
FROM
    basequery as a INNER JOIN
    (SELECT MAX(price) AS maxprice FROM basequery) as b
        ON a.price = b.maxprice
-- or
WITH basequery as (
    SELECT aa.id, COUNT(1) AS price
    FROM rt aa INNER JOIN tt bb ON aa.id = bb.id
    WHERE [aa.somecondition]
    GROUP BY aa.id
)
SELECT a.id, a.price
FROM
    basequery as a
WHERE
    a.price >= ALL (SELECT price FROM basequery) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-08T08:49:39.260

假设@Zane 的答案是您想要的，这里是他的查询的可移植版本，它也避免了 LIMIT/TOP 操作。我对mysql方言不是很熟悉，但我想这会毫无问题地工作。

```
SELECT a.id, a.price
FROM (
    SELECT aa.id, COUNT(1) AS price
    FROM rt aa
    INNER JOIN tt bb ON aa.id = bb.id
    WHERE [somecondition]
    GROUP BY aa.id
) a
WHERE
    a.price >= ALL (
        SELECT COUNT(1) AS maxprice
        FROM rt aa
        INNER JOIN tt bb ON aa.id = bb.id
        WHERE [somecondition]
        GROUP BY aa.id
    ) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-08T08:17:20.660

`HAVING`用于在聚合发生后检查条件。

`WHERE`在聚合发生之前使用。

```
SELECT id, COUNT(*) AS price
FROM (SELECT * FROM rt WHERE somecondition) AS st
  JOIN tt
  ON st.id = tt.id
WHERE price = (SELECT MAX(price) FROM ...table)
GROUP BY id 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-08T08:21:50.817

试试这个，把MAX放在select里，这应该是正确的方法

```
SELECT id, COUNT(*) AS price, MAX(price) AS max_price
FROM (SELECT some_table_name FROM rt WHERE somecondition LIMIT 1) AS st
      JOIN thenextTable as tt
      ON st.id = tt.id
GROUP BY id; 
```

# c++ - 在direct3d11中映射资源和分配数据

> ID：11381675
> 
> 赞同：0
> 
> 时间：2012-07-08T08:14:04.940
> 
> 标签：c++, directx-11

嗨，我正在使用着色器，我有一个关于我是否可以在这里做某事的快速问题。当将数据映射到缓冲区时，我通常会看到它是这样完成的。定义类或结构来表示缓冲区中的内容。

```
class MatrixBuffer
{
public:
    D3DXMATRIX worldMatrix;
    D3DXMATRIX viewMatrix;
    D3DXMATRIX projectionMatrix;
} 
```

然后在创建输入布局时设置输入元素描述，我得到了所有这些。现在，当我看到人们在渲染之前更新缓冲区时，我看到它大多是这样完成的：

```
MatrixBuffer * dataPtr;
if(FAILED(deviceContext->Map(m_matrixBuffer, 0, D3D11_MAP_WRITE_DISCARD, 0, &mappedResource)))
        return false;

dataPtr = (MatrixBuffer *) mappedResource.pData;
dataPtr->world = worldMatrix;
dataPtr->view = viewMatrix;
dataPtr->projection = projectionMatrix;

deviceContext->Unmap(m_matrixBuffer, 0); 
```

其中分配的值实际上是有效的 D3DXMATRIX。看来没关系，如果我这样做会不会有什么问题？

```
MatrixBuffer* dataPtr;
if(FAILED(deviceContext->Map(m_matrixBuffer, 0, D3D11_MAP_WRITE_DISCARD, 0, &mappedResource)))
            return false;

dataPtr = (MatrixBuffer *) mappedResource.pData;
*dataPtr = matrices;

deviceContext->Unmap(m_matrixBuffer, 0); 
```

矩阵是一个有效填写的 MatrixBuffer 对象？由于某些特殊的直接 X 处理此问题，以后会不会产生可怕的后果，还是可以？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T09:17:02.140

从技术角度来看，我认为您的版本没有任何问题。

掌握实际复制到那里的内容可能会稍微困难一些，从理论上讲，生成的代码应该几乎相同——我希望任何体面的优化器都会注意到“长”版本只是复制了几个连续的项目，并将它们全部合并到一个更大的副本中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T17:02:12.187

尝试避免使用映射，因为它会停止管道。对于每帧更新一次的内容，最好使用 D3D11_USAGE_DEFAULT 缓冲区，然后使用 UpdateSubresource 方法将新数据推入。更多信息请参见：http: [//blogs.msdn.com/b/shawnhar/archive/2008/04/ 14/停止管道.aspx](http://blogs.msdn.com/b/shawnhar/archive/2008/04/14/stalling-the-pipeline.aspx)

# jquery - 不使用ajax向服务器发送数据

> ID：11381677
> 
> 赞同：-1
> 
> 时间：2012-07-08T08:14:17.077
> 
> 标签：jquery, jquery-ui, jquery-mobile

嗨，我想以 post 方法将数据发送到服务器。我知道这是一个简单的问题，但我没有得到很好的文件。我有将数据发送到服务器的方法，但它使用的是 ajax。我想在没有ajax的情况下发送数据怎么做？这是我的代码。

```
 $.ajax({
                type: "POST",
                contentType:"application/x-www-form-urlencoded; charset=UTF-8",
                url: clientDetailURL,
                data: finalclientDetailParam
                }).done(function( msg1 )
                {
                         var clientDetailResponse = msg1;
                         console.log("Client detail response is:"+clientDetailResponse);
                 }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T09:09:53.047

好的，现在我发布这样的数据：

```
function post_to_url(path, params, method) {

console.log ("Inside post_to_url>>>>>>>>");
method = method || "post"; // Set method to post by default, if not specified.

// The rest of this code assumes you are not using a library.
// It can be made less wordy if you use one.
var form = document.createElement("form");
form.setAttribute("method", method);
form.setAttribute("action", path);

for(var key in params) {
    if(params.hasOwnProperty(key)) {
        var hiddenField = document.createElement("input");
        hiddenField.setAttribute("type", "hidden");
        hiddenField.setAttribute("name", key);
        hiddenField.setAttribute("value", params[key]);

        form.appendChild(hiddenField);
     }
}

document.body.appendChild(form);
form.submit(); 
```

}

并将此方法称为：

```
function handleLogin()
{

var form = $("#loginForm");    
 var u = $("#username", form).val();
var p = $("#password", form).val();
var d = $("#dob", form).val();

if(u != '' && p!= '')
{
    var finalStr = u+encodeURIComponent("|^")+p+encodeURIComponent("|^")+encodeURIComponent("|^")+"X"+encodeURIComponent("|^")+d+encodeURIComponent("|^")+"1.0"+encodeURIComponent("|^|$");

    var encodedURL = encodeURI(intranetUrl+"customer/Ri_logon.asp?requestString=");
    var parameters =  decodeURIComponent(finalStr);
    console.log("before calling post_to_url method");
    post_to_url(encodedURL,parameters,'post');

}

else
{

    alert("You must enter a username and password", function() {});
    $("#submitButton").removeAttr("disabled");
}

} 
```

但现在我从服务器获取输出为：“不是对象”。当参数暂停或特殊字符未完美编码时，它来自服务器。但是我已经像上面的原始问题一样对参数进行了编码。那为什么会这样呢？

# java - 在谷歌应用引擎上使用 mysql 运行 java 网站

> ID：11381678
> 
> 赞同：0
> 
> 时间：2012-07-08T08:14:18.557
> 
> 标签：java, google-app-engine

我在本地电脑上使用 Mysql 数据库测试我的网站，并使用 tomcat 作为服务器。现在我想将它上传到谷歌应用引擎让其他人查看网站，可以这样做，或者我需要更改一些配置文件？或者 GAE 使用其他存储解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T08:16:32.490

您不能在 AppEngine 上运行本地 MySQL 实例，您需要使用[Google Cloud SQL](https://developers.google.com/cloud-sql/) /

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T08:25:33.723

你不能上传它。也许您必须进行一些更改，而不仅仅是更改配置文件。appengine 有一些限制，你需要阅读[appengine](https://developers.google.com/) 使用 eclipse 插件来检查

# linux - 如何在 Linux 中恢复被另一个文件覆盖的文件？

> ID：11381683
> 
> 赞同：4
> 
> 时间：2012-07-08T08:14:36.347
> 
> 标签：linux, ubuntu, recovery

我在命令行上做了这个（Ubuntu 12.04）

mv some_arbit_file required_file

有什么办法可以恢复 required_file. 我为此付出了很多努力。我通常备份文件。但是，这次我忘记了。将不胜感激任何帮助。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T08:43:54.690

你不能“撤销”你的命令。也许您可以找到一些可以帮助您的恢复工具...

顺便说一句，为了避免这种麻烦，我建议你使用该[`-i`](http://unixhelp.ed.ac.uk/CGI/man-cgi?mv)选项。它会告诉您是否要覆盖文件。

您可以在以下位置创建别名`~/.bashrc`：

```
alias mv="mv -i"
#you can also add aliases to cp and rm
alias cp="cp -i"
alias rm="rm -i" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-08T09:10:30.540

为了防止将来出现此类问题，您需要有一个备份系统。如果此备份系统执行某种形式的版本控制并且不需要您进行任何维护，那就更好了。您不想考虑需要备份哪些文件，应该是“所有文件，是的，甚至 /tmp 的内容，至少每小时一次”

使用 git/svn 或其他文件版本控制系统不是一个坏主意，但是如果您忘记将新文件添加到 repo 会发生什么？如果 repo 本身被删除会怎样？当您尝试将整个音乐收藏放入其中，或者想要存储特殊的 unix 文件（如管道和符号链接）时会发生什么？我还发现 git repos 非常容易损坏，尤其是当我手动删除或移动它们时。

一个更强大的系统是首先购买一个大小合适的新硬盘——一到两 TB 就足够了。将此指定为您的备份驱动器。然后得到类似[Rsnapshot](http://Rsnapshot.org)的东西并让它工作。然后，您将拥有可以使用标准文件工具从从 CD 引导的半损坏机器中恢复的版本化备份，其中在您的引导驱动器发生灾难性故障后网络未启动（是的，我是从这里的经验说的）。

在 Rsnapshot 和 Apple 的 TimeMachine（以非常相似的方式工作）之间，我已经从几次 SSD 故障、硬盘崩溃和断电中恢复过来，这些故障默默地破坏了我的一半音乐收藏，直到一周后我才发现。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-08T08:29:16.383

您可以尝试`photorec`从`testdisk`包装中使用。它在您删除文件时起作用，但我实际上不知道覆盖它是否算作删除。

对于未来，我建议您使用 Dropbox 之类的服务来处理所有重要文件。它允许您恢复每个文件的任何版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-08T08:23:45.013

看看这个[ext3 恢复](http://carlo17.home.xs4all.nl/howto/undelete_ext3.html "取消删除 ext3")页面。

因为它很难，所以我尽量主动并在每个目录中使用 git。这样，当我出错时，我可以`git checkout`取回旧文件。

# c - 一旦定义，字符串不能初始化为其他字符？

> ID：11381688
> 
> 赞同：0
> 
> 时间：2012-07-08T08:15:33.977
> 
> 标签：c

使用指针可以将字符串初始化为其他字符，但是一旦定义了字符串，就无法将其初始化为其他字符。这背后的原因是什么？

```
int main()
{
char str1[]="hello";
char *p="hello";
str1="bye";/*error*/
p="bye";/*works*/
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T08:19:01.050

您已定义`str1`为数组，并且数组不可分配。

但是，您可以将其他数据复制到数组中，例如：

```
char str1[] = "hello";

strcpy(str1, "bye"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T08:19:06.667

要更改数组中的字符，例如您正在做的事情，您必须使用一个函数，`strcpy`或者按索引进行索引。

```
str1[0] = 'p'; 
```

将打印出来`pello`

C 语言不支持您尝试执行的操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T08:23:25.540

数组是数组，指针是指针。定义数组给出了指向分配数组的指针，这是一个指向数组空间已被保留的位置的常量指针。这是 lifo 堆栈中的具体地址。所以，str1 是一个常量指针值，你不能改变它。您不能设置不同常量字符串的地址值。

将指针定义为 char*p，可为您提供地址的变量值。因此，您可以更改变量 p 的值。

# jquery - jQuery mobile：插入新元素的样式不正确

> ID：11381692
> 
> 赞同：1
> 
> 时间：2012-07-08T08:16:58.650
> 
> 标签：jquery, jquery-mobile, cordova

将新的 jQuery 移动元素插入页面时，它们的样式不正确，即使在`.trigger("create");`包含元素上使用也是如此。这确实可以，但是在某种程度上设置了正确的样式，但还不够。

例如，当像这样附加时：

```
for (var i=0; i<len; i++){
            ...
            $('#results').append("<a href='#' data-role='button'>"+content+"</a>");
        }
        $('#results').trigger("create"); 
```

显示是这样的：

![在此处输入图像描述](../Images/e384a87ed10fc68547e15e1b8c8dc5c5.png)

注意额外的圆角。而如果我只是在页面上包含代码，它会正确显示，如下所示：

![在此处输入图像描述](../Images/d973af3c9a59c83e4b31db2f7095613f.png)

每当我在页面加载后将任何内容加载到页面中时，都会发生同样的问题。除了强制自定义样式表中的样式之外，有没有人知道解决这个问题的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T19:06:07.573

“创建”事件增强了触发元素中的子标记（例如 $('#results')...）。

所以，你可以通过更换来解决

```
$('#results').trigger("create"); 
```

和

```
$('#results').parent().trigger("create"); 
```

**[演示：jsfiddle](http://jsfiddle.net/quzYB/)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T08:25:59.217

Jquery mobile 使用 html 属性来设置页面样式，其中一些样式还涉及向页面添加某些元素（span、div 等）。

Jquery mobile 还附带了一个可容纳这些样式的 CSS。因此，即使您有一个非常简单的 HTML 页面，如果您使用 firebug 或其他检查工具查看它，您也会看到许多其他元素被动态添加到页面中。

如果你去添加另一个元素，你需要确保它符合 jquery 移动 css 设计。如果没有，您需要找到影响您新添加的元素的类（同样，使用 firebug）并在 jquery 移动 css 中编辑样式，或者用您的样式表覆盖它。

# c - 使用像 FILE* 这样的 C 字符串

> ID：11381694
> 
> 赞同：21
> 
> 时间：2012-07-08T08:17:09.567
> 
> 标签：c, file-pointer

我有一个 C 函数，它从`FILE*`.

在这种情况下，我如何`FILE*`从字符串创建一个？

编辑：

我认为我的原始帖子可能具有误导性。我想`FILE*`从一个文字字符串值创建一个，这样结果`FILE*`就好像在某个地方确实有一个包含该字符串的文件，而没有实际创建一个文件。

以下是我想做的事情：

```
void parse(FILE* f, Element* result);

int main(int argc, char** argv){
    FILE* f = mysteryFunc("hello world!");
    Element result;
    parse(f,&result);
} 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-07-08T08:29:40.700

标准 C 没有提供这样的功能，但 POSIX 定义了[`fmemopen()`](http://manpages.sgvulcan.com/fmemopen.3.php)完全符合您要求的功能。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-08T08:27:00.737

不幸的是，C 的标准库不提供这个功能。但有几种方法可以绕过它：

*   创建一个临时文件，将您的字符串写入其中，然后打开它进行阅读。如果您有 POSIX，`gettempnam`将为您选择一个唯一的名称

*   另一个选项（同样仅适用于 POSIX）是`fork`一个新进程，其工作是将`write`字符串连接到管道，而`fdopen`另一端则为您的函数获取一个`FILE*`。

*   正如@KeithThompson 指出的那样，`fmemopen`完全符合您的要求，因此如果您有 POSIX，请使用它。在任何其他平台上，（除非您可以找到等效平台），您将需要一个临时文件。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-08T08:24:12.427

上次我遇到这种问题时，我实际上创建了一个管道，启动了一个线程，并使用该线程将数据写入管道……不过，您必须查看操作系统调用。

可能还有其他方法，例如创建内存映射文件，但我一直在寻找无需大量工作和研究即可工作的东西。

编辑：当然，您可以将问题更改为“我如何找到一个不错的临时文件名”。然后您可以将数据写入文件，然后将其读回:-)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-08T08:44:27.683

```
pid_t pid;
int pipeIDs[2];

if (pipe (pipeIDs)) {
   fprintf (stderr, "ERROR, cannot create pipe.\n");
   return EXIT_FAILURE;
} 

pid = fork ();
if (pid == (pid_t) 0) {
   /* Write to PIPE in this THREAD  */

   FILE * file = fdopen( pipe[1], 'w');

   fprintf( file, "Hello world");
   return EXIT_SUCCESS;

} else if (pid < (pid_t) 0) {
  fprintf (stderr, "ERROR, cannot create thread.\n");
  return EXIT_FAILURE;
}

FILE* myFile = fdopen(pipe[0], 'r');

// DONE! You can read the string from myFile

....  ..... 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-07-08T13:02:27.660

也许您可以稍微更改代码以接收自定义句柄。

```
void parse(my_handle *h, Element *result)
{
  // read from handle and process
  // call h->read instead of fread
} 
```

并像这样定义句柄：

```
struct my_handle
{
    // wrapper for fread or something
    int (*read)(struct my_handle *h, char *buffer, int readsize);
    // maybe some more methods you need
}; 
```

实现你的 FILE* 包装器

```
struct my_file_handle
{
    struct my_handle base;
    FILE *fp;
};

int read_from_file(struct my_handle *h, char *buffer, int readsize)
{
    return fread(buffer, 1, readsize, ((my_file_handle*)h)->fp);
}

// function to init the FILE* wrapper
void init_my_file_handle(struct my_file_handle *h, FILE *fp)
{
    h->base.read = read_from_file;
    h->fp = fp;
} 
```

现在，实现你的字符串阅读器

```
struct my_string_handle
{
    struct my_handle base;
    // string buffer, size, and current position
    const char *buffer;
    int size;
    int position;
};

// string reader
int read_from_string(struct my_handle *h, char *buffer, int readsize)
{
    // implement it yourself. It's easy.
}

// create string reader handle
void init_my_string_handle(struct my_string_handle *h, const char *str, int strsize)
{
    // i think you know how to init it now.
} 
```

/////////////////////////////////////////

现在，您可以简单地向您的解析函数发送一个句柄。该函数不关心数据来自哪里，它甚至可以从网络中读取数据！

# css - 我可以根据计数器值设置 content:counter 样式吗？

> ID：11381703
> 
> 赞同：1
> 
> 时间：2012-07-08T08:18:52.750
> 
> 标签：css

我正在使用 CSS2.1 计数器在棋盘游戏的实现中将数字应用于棋盘上的人，该棋盘游戏的棋盘图使用 HTML 和 CSS，方法如下：

```
.ply  {counter-increment:main;}
.move:before {content:counter(main);} 
```

使用 HTML 结构为

```
<ply>
  <move...>
  <ply>
    <move...>
  </ply>
</ply> 
```

**所有这些都可以正常工作，但是如果计数器值**的长度为两位数，我想有条件地设置不同的样式（例如，将两位数与负数一起挤压`letter-spacing`）。关于如何执行此操作或解决方法的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T12:51:40.467

事实证明，我们可以`getComputedStyle`使用第二个参数来检索相关计数器的值，第二个参数指定将计数器指定为内容的伪元素：

```
value = window.getComputedStyle(elt, ':before').content; 
```

然后我们可以应用一种样式，例如

```
if (value>=100) { elt.style.letterSpacing = "-2px"; } 
```

这正是我们想要的，尽管它需要使用 JS 遍历所有可能发生变化的可能受影响的元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T08:27:56.687

您不能仅使用 CSS 来执行此操作，因为[CSS 选择器](http://www.w3.org/TR/CSS2/selector.html)中没有关于内容大小的任何内容。

这可能是一个答案，但如果你想要一个解决方法，可以使用 javascript。

这是一个示例（使用 jquery），当文本长度超过 2 个字符时，我更改了文本的颜色：

```
$('.move').each(function(){
    if ($(this).text().length>2) $(this).css({color:'red'});
});​ 
```

演示：http: [//jsfiddle.net/dystroy/nKVvG/](http://jsfiddle.net/dystroy/nKVvG/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T09:45:30.953

我知道这不是你真正想要的，但我做了一些研究，找不到任何 CSS 唯一方法来做到这一点，主要是因为正如@dystroy 所述

> “你不能只使用 CSS 来做到这一点，因为 CSS 选择器中没有关于内容大小的任何内容。”

因此，css 无法知道 :before 部分中的内容有多长。

所以我想你真的应该稍微使用一下jQuery。试试[这个 jsfiddle](http://jsfiddle.net/nKVvG/1/)。

基本上，您可以做的是使用 css 计数器遍历要索引的元素，然后使用 .index() 属性查看它们的计数器是两位数还是三位数。请记住 .index() 当计数器从 1 开始时从 0 开始，所以在两位数条件检查中你应该输入

```
if($(this).index() > 8) ... 
```

因为 counter = index + 1 -> if(counter > 9) = if(index > 8)

如果计数器是两位数，那么您将一个类添加到您的电影元素，以便您可以在您的 css 中自由地设置它的样式。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-08T08:25:38.923

我认为您正在寻找的内容在这篇文章中进行了讨论：[使用 jQuery 选择和操作 CSS 伪元素，例如 ::before 和 ::after](https://stackoverflow.com/questions/5041494/manipulating-css-before-and-after-pseudo-elements-using-jquery)。我不认为你可以通过普通的 CSS 来做到这一点，但我可能弄错了。

# firefox-addon - 从页面代码访问特定的扩展对象数据

> ID：11381705
> 
> 赞同：1
> 
> 时间：2012-07-08T08:19:01.983
> 
> 标签：firefox-addon, firefox-addon-sdk

我正在尝试构建一个插件，该插件将观察和收集页面上收到的 XHR 和图像响应，并使它们可用于页面脚本（在该页面上）以供进一步检查。

在我的“http-on-examine-response”观察者代码中，我将感兴趣的 URL 推送到它们关联窗口的数组中，推送到对象中，如下所示 -

`myWindowId = resp.outerWindowID+'-'+resp.currentInnerWindowID; storedResponses[myWindowId].push(subject.URI.spec);`

（我认为这种方法可能比使用标签引用来识别唯一的源窗口更好）

当任何页面发出请求时，相关数组会自动更新。

我希望能够随时从页面脚本或书签中查询相关数组。

我应该在页面/书签、内容脚本和扩展之间设置 port.on... 或 postMessage() 通信，还是使用 pageMod 将适当的数组直接写入相关页面上的 unsafeWindow 全局对象？

一旦观察到新的响应，我就无法弄清楚如何让 pageMod 将特定数组写入特定页面。

完整源代码在这里 - [https://builder.addons.mozilla.org/addon/1064905/latest/](https://builder.addons.mozilla.org/addon/1064905/latest/)

我认为这一切正常，除了将数据返回到页面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T00:24:13.920

在 Wladimir Palant 的帮助下，我发现它`XPCNativeWrapper.unwrap()`已被定义，并且可以从 SDK 模块上下文中完成我需要的工作。它允许我直接在插件的窗口中设置变量。

有关包装器的更多信息 - [https://developer.mozilla.org/en/XPCNativeWrapper](https://developer.mozilla.org/en/XPCNativeWrapper)

# windows - 如何在 Qt 中按进程名称杀死进程

> ID：11381709
> 
> 赞同：5
> 
> 时间：2012-07-08T08:20:29.770
> 
> 标签：windows, qt, process

我正在为 Qt 中的 Windows 编写桌面应用程序。
我有 3 个进程的名称，如果它们正在运行，我想在我的应用程序开始时杀死它们。
最好的方法是什么？（通过使用进程名称获取进程的状态，如果它是打开的，则将其杀死）。

代码示例可以帮助我很多。谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-09T03:23:20.670

您可以为此目的使用 Qpr​​ocess。在你的应用程序开始时，做

```
Qprocess p;
p.start("pkill processname1");
p.waitForFinished();
p.start("pkill processname2");
p.waitForFinished();
p.start("pkill processname2");
p.waitForFinished(); 
```

或者你可以直接使用系统调用..

```
system("pkill processname1");
system("pkill processname2");
system("pkill processname3"); 
```

在 Windows 环境下，可以使用以下命令来杀死进程

```
process -k “Process ID”
process -k “Process Name” 
```

您可以[在此处](http://www.tech-recipes.com/rx/446/xp_kill_windows_process_command_line_taskkill/)阅读更多内容。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-06-23T06:17:21.947

在 Windows 下使用 taskkill 命令你可以调用它使用

```
QProcess::execute("taskkill /im <processname> /f"); 
```

或者

```
system("taskkill /im <processname> /f"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-08-18T13:00:54.407

QT 不提供任何 API 来杀死不是由您的 QT 项目创建的进程。如果您在 Windows 上，您可以尝试以下代码，如此[处所述](https://stackoverflow.com/questions/7956519/how-to-kill-processes-by-name-win32-api)

```
#include <windows.h>
#include <process.h>
#include <Tlhelp32.h>
#include <winbase.h>
#include <string.h>
void killProcessByName(const char *filename)
{
    HANDLE hSnapShot = CreateToolhelp32Snapshot(TH32CS_SNAPALL, NULL);
    PROCESSENTRY32 pEntry;
    pEntry.dwSize = sizeof (pEntry);
    BOOL hRes = Process32First(hSnapShot, &pEntry);
    while (hRes)
    {
        if (strcmp(pEntry.szExeFile, filename) == 0)
        {
            HANDLE hProcess = OpenProcess(PROCESS_TERMINATE, 0,
                                          (DWORD) pEntry.th32ProcessID);
            if (hProcess != NULL)
            {
                TerminateProcess(hProcess, 9);
                CloseHandle(hProcess);
            }
        }
        hRes = Process32Next(hSnapShot, &pEntry);
    }
    CloseHandle(hSnapShot);
}
int main()
{
    killProcessByName("notepad++.exe");
    return 0;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-01-06T07:53:12.203

如何运行应用程序

```
bool ok = QProcess::startDetached("C:\\TTEC\\CozxyLogger\\CozxyLogger.exe");
qDebug() <<  "Run = " << ok; 
```

如何杀死应用程序

```
 system("taskkill /im CozxyLogger.exe /f");
 qDebug() << "Close";[enter image description here][1] 
```

更多链接::

[http://sittikron-big-rmutt.blogspot.com/2018/01/qt-start-and-kill.html](http://sittikron-big-rmutt.blogspot.com/2018/01/qt-start-and-kill.html)

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2020-01-29T10:02:46.507

在 Windows 中右键单击任务栏，选择任务管理器，在进程选项卡上，按名称找到进程。结束任务。

# java - 如果 List 中不存在新列表，如何更好地测试和创建新列表 > 结构？

> ID：11381711
> 
> 赞同：0
> 
> 时间：2012-07-08T08:21:13.860
> 
> 标签：java, list, guava

如果它不存在，如何更好地测试和创建一个新列表？

我只找到了这个解决方案：

```
private List<List<Action>> actionList = Lists.newArrayList();

...

f(int index){
    Optional<List<Action>> optionalActionList = Optional.fromNullable(actionList.get(index));
    if (!optionalActionList.isPresent()) {
        actionList.add(new ArrayList<Action>());
    }
    actionList.get(index).add(index, new Action());
} 
```

也许我应该改变存储结构？（添加顺序。能够同时添加列表的开头和结尾。在两个列表中都很重要）。如果需要，可以使用 Google Guava。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-08T08:27:58.920

目前还不清楚`Optional`这里真正给你买的是什么。我认为`Optional`在方法之间或在存储中进行通信的价值。

此外，我认为代码并没有按照您的想法进行操作-您要的*是特定索引处*的列表，但是如果该索引处的值为空，则您将*在末尾*添加一个新列表. 听起来你想要：

```
f(int index){
    List<Action> list = actionList.get(index);
    if (list == null) {
        list = new ArrayList<Action>();
        actionList.set(index, list);
    }
    // Note: no need to use index at all here... potentially
    list.add(new Action());
} 
```

请注意，我最后*没有*使用`add(index, new Action())`- 非常不清楚您为什么要这样做。您已经使用正确的列表`index`- 为什么要`index` *再次*使用？

上面假设“外部”列表已经是正确的大小，但是为“不存在”列表填充了空值。如果不是这种情况，您需要检测何时`index`超出当前外部列表的范围。

基本上，如果上述方法没有帮助，请提供更多信息，因为您的问题目前尚不清楚。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T08:44:37.413

如果您不在 Java 7 上而不是

```
list = new ArrayList<Action>(); 
```

您可以使用

```
list = Lists.newArrayList(); 
```

如果您为此添加静态导入，则可以将其缩短为

```
list = newArrayList(); 
```

# c# - 在 SQL Server 2008 中使用 SqlBulkCopy 向具有“xml”类型列的表中插入行引发异常

> ID：11381719
> 
> 赞同：0
> 
> 时间：2012-07-08T08:23:13.617
> 
> 标签：c#, sql-server, sqlbulkcopy

我在 SQL Server 中有两列的简单表`Id (BIGINT), PublishData (XML)`。

我有兴趣使用`SqlBulkCopy`，但是当我尝试使用时`SqlBulkCopy.WriteToServer(DataTable)`，它给了我以下异常。当我`SqlXml`创建数据表并为`PublishData`. 我认为它与`xml`SQL Server 中的列类型不匹配。我需要知道在为`xml`列创建数据表时需要使用的正确数据类型是什么，然后将其与`SqlBulkCopy`.

任何帮助，将不胜感激？

> 未处理的异常：System.InvalidCastException：指定的转换无效。
> 在 System.Data.SqlClient.TdsParser.WriteBulkCopyValue（对象值，SqlMetaData taPriv 元数据，TdsParserStateObject stateObj）
> 在 System.Data.SqlClient.SqlBulkCopy.WriteToServerInternal()
> 在 System.Data.SqlClient.SqlBulkCopy.WriteRowSourceToServer(Int32 columnCount )
> 在 System.
> System.Data.SqlClient.SqlBulkCopy.WriteToServer（DataTable 表）处的Data.SqlClient.SqlBulkCopy.WriteToServer（DataTable 表，DataRowState ate rowState ）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T08:51:15.060

> 需要知道在为 xml 列创建数据表时需要使用的正确数据类型，然后将其与 SqlBulkCopy 一起使用

把它绑起来而不是在这里问怎么样？我的意思是，说真的，有多少数据类型？

我建议您在 .NET 中尝试 STRING ;) 很明显，不是吗 - 您几乎无法将 XML 存储为 Bool 或 Integer 数据类型，所以我能看到的 SqlXml 的唯一替代品是字符串。

# android - AppWidgets - 动态更新 Intent 附加内容

> ID：11381722
> 
> 赞同：0
> 
> 时间：2012-07-08T08:23:28.597
> 
> 标签：android, android-intent, android-appwidget, android-pendingintent

我有一个`AppWidget`与两个交互的`Activities`. 首先`Activity`要求用户输入一些文本。这是`Activity`从以下开始的代码`AppWidget`：

```
Intent promptIntent = new Intent(context,
        TransparentPromptActivity.class);
promptIntent.putExtra("appwidget_id", appWidgetId);
promptIntent.putExtra("message", incomingMessage);
PendingIntent promptPendingIntent = PendingIntent.getActivity(
        context, 0, promptIntent, 0);
views.setOnClickPendingIntent(R.id.app_widget_tv,
        promptPendingIntent); 
```

这`Activity`会将输入的消息发送回`AppWidge`显示它的 t。然后有一个`Activity`分享消息的，这里是开始这个​​的代码`Activity`：

```
Intent shareIntent = new Intent(context, MainActivity.class);
shareIntent.putExtra("message", incomingMessage);
PendingIntent sharePendingIntent = PendingIntent.getActivity(
        context, 0, shareIntent, 0);
views.setOnClickPendingIntent(R.id.app_widget_btn_share,
        sharePendingIntent); 
```

如您所见，消息存储在局部`incomingMessage`变量中。但是，当第二个`Activity`启动时，`incomingMessage`为空，意味着`Intent`当变量值改变时内容不更新。怎样才能达到这种效果？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T12:01:03.177

> 怎样才能达到这种效果？

在您的调用中使用适当的标志`getActivity()`，例如[`FLAG_UPDATE_CURRENT`](http://developer.android.com/reference/android/app/PendingIntent.html#FLAG_UPDATE_CURRENT)，如果您`PendingIntent`在同一个核心上创建一个`Intent`（例如，为同一个活动）并且正在更改额外内容。

话虽这么说，因为`TransparentPromptActivity`和`MainActivity`不是同一个活动，`FLAG_UPDATE_CURRENT`将无济于事。也许你的问题是`incomingMessage`你`null`的第二种情况。

# php - 如何从 blob 文件 oracle 播放视频 HTML5？

> ID：11381725
> 
> 赞同：-1
> 
> 时间：2012-07-08T08:24:02.520
> 
> 标签：php, html

这是我从数据库 oracle（Blob 文件）播放视频文件的 HTML5 代码：

```
 <video width="320" height="240" controls="controls">
    <source src="getVideo.php" type="video/mp4" />
    </video> 
```

我上传的视频是 mp4，所以我在我的代码中输入 mp4 类型。
这是我的 PHP (getVideo.php) 代码，用于从数据库中获取视频文件：

```
<?php
$conn = ocilogon('user', 'pass', '//localhost/XE');

$sql = "SELECT VIDEO FROM TFILE";
$stid = ociparse($conn,$sql);
$rowResult = ocifetch($stid);
settype($arrayResult,"array");
if($rowResult != null){
    echo (OCIResult($stid,'VIDEO')->load());
}
?> 
```

但是，它不起作用，视频无法播放..有人可以帮助我吗？

谢谢之前..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T09:37:24.493

在浏览器中打开getVideo.php，看看二进制数据是否真的打印出来了。如果是这样，请尝试发送正确的 MIME 类型：`header('Content-type: video/mp4')`在开头调用。我还会在 blob 之后调用以确保以后不会打印（空白）字符`exit`。`echo`

# oracle - 无法安装 wls1034_linux32.bin

> ID：11381733
> 
> 赞同：0
> 
> 时间：2012-07-08T08:24:43.113
> 
> 标签：oracle, ubuntu, installation, soa

我开始在我的 ubuntu 系统中安装 soa Suite 和 oracle 10g express edition。为此，我指的是 quickstartsoasuite11g... .pdf 指南。按照本指南中给出的步骤，我安装了 oracle，但是当我尝试安装 wls1034_linux32.bin 文件时，我在终端上收到以下错误：

```
 [/root/stageFMW/wls1034_linux32.bin]
  End-of-central-directory signature not found.
** Error during init, error code = 2. 
```

我哪里错了？我该如何解决这个错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T10:55:26.733

Oracle 在其支持的 Linux 版本列表中不包括 Ubuntu。基本上，它只针对“企业级”发行版进行认证，例如 RHEL、Suse 和不可避免的 Oracle Enterprise Linux。

几乎可以肯定 SOA 套件和 Oracle XE*将*在 Ubuntu 上运行，但您需要调整一些东西和/或下载其他库。对于不熟悉 Oracle 产品集的人来说，这不是一项任务。

如果你有一个相当强大的系统，你应该考虑运行一个虚拟化环境。Oracle 提供[了可以在 Ubuntu 上运行的 VirtualBox 安装](https://www.virtualbox.org/wiki/Linux_Downloads "Linux 上 Virtualbox 的下载页面")。然后，您可以运行[预构建的 SOA Suite 设备](http://www.oracle.com/technetwork/middleware/soasuite/learnmore/vmsoa-172279.html "SOA Suite vm 的 OTN 下载页面")。

（如果您没有强大的系统，您将无法使用 SOA 套件：运行 Web 服务器、数据库和 JDeveloper 会消耗大量计算能力。）

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-07-10T14:30:51.887

当我尝试使用 root（超级用户）安装 Jdevloper 时，我遇到了同样的错误。我通过与其他用户一起安装来纠正它。

# php - PHP 联系表单发送空数据

> ID：11381735
> 
> 赞同：-4
> 
> 时间：2012-07-08T08:25:10.863
> 
> 标签：php, forms, html

我正在尝试创建一个与计算机和移动设备兼容的 HTML5 联系表单，当我单击发送消息时，它会跳转到一个空白的白色屏幕。我确实收到了一封电子邮件，但它不包含任何信息。我对 PHP 很陌生。

对于 www.rare1.ca/test：

```
<!DOCTYPE html>
<html>
<head>
<title>Responsive HTML5/CSS3 template</title>
<meta charset="utf-8" />
<meta name = "viewport" content = "width=device-width, maximum-scale = 1, minimum-    scale=1" />
<link rel="stylesheet" type="text/css" href="css/default.css" media="all" />
<link rel="stylesheet" href="css/flexslider.css" type="text/css" />
<link href='http://fonts.googleapis.com/css?family=PT+Sans' rel='stylesheet' type='text/css' />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js">    </script>
<script src="js/jquery.flexslider.js"></script>
<script src="js/default.js"></script>
<!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <script src="js/respond.min.js"></script>
<![endif]-->
</head>
<body>
<div id="pagewidth">
    <header id="header">
        <div class="center">
            <nav id="mainNav">
                <ul>
                    <li class="active"><a href="#pagewidth"><span>gallery</span></a></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li><a href="#contactUs"><span>contact us</span></a></li>
                </ul>
            </nav>
        </div>
    </header>
    <div id="content">
        <section class="row">
            <div class="center">
              <h1><img src="img/logo.gif" width="142" height="78"></h1>
                <strong class="subHeading">Coming soon</strong>
                <div class="gallery">
                    <ul class="slides">
                        <li><img src="img/img-gallery.jpg" alt="image" /></li>
                        <li><img src="img/img-gallery2.jpg" alt="image" /></li>
                        <li><img src="img/img-gallery3.jpg" alt="image" /></li>
                    </ul>
              </div>
                <div class="buttons"></div>
          </div>
        </section>
        <section id="contactUs" class="row grey">
            <div class="center">
                <h1>Contact Us</h1>
                <strong class="subHeading">lorem ipsum dolor sit amet, consectetur adipiscing elit</strong>
                <div class="columns">
                    <div class="half">
                        <form action="sendemail.php" class="form">
                            <fieldset>
                                <h2>Feedback form</h2>
                                <div class="formRow">
                                    <div class="textField"><input type="text" name="Name" id="name" placeholder="Your name ..." /></div>    
                                </div>
                                <div class="formRow">
                                    <div class="textField"><input type="text" name="Email" id="email" placeholder="Your Email ..." /></div>
                                </div>
                                <div class="formRow">
                                    <div class="textField"><textarea name="Message" cols="20" rows="4" placeholder="Your message ..."></textarea> </div>
                                </div>
                                <div class="formRow">
                                    <button class="btnSmall btn submit right">
                                                <span>Send Message</span>
                                    </button>
                                </div>
                            </fieldset>
                        </form>
                    </div>
                    <div class="half">
                        <h2>How to find us</h2>
                        <div id="map">
                            <div class="imgHolder"><img src="img/map.jpg" alt="google map" /></div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>
    <footer id="footer">
        <div class="center">

        </div>
    </footer>
</div>
</body>
</html> 
```

* * *

```
<?php

// This is the script for sending email.

// change the email address below to your own email address.
$mailTo = 'info@rare1.ca';

$name = htmlspecialchars($_POST['Name']);
$mailFrom = htmlspecialchars($_POST['Email']);
$message_text = htmlspecialchars($_POST['Message']);

$headers  = "From: $name <$mailFrom>\n";
$headers .= "Reply-To: $name <$mailFrom>\n";

$message = $message_text;

mail($mailTo, $subject, $message, $headers );

?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T08:27:32.787

当您单击提交时，您将被重定向到`sendemail.php`. 您可以从代码中轻松看到该页面没有内容。这就是为什么您在点击提交后登陆的页面是空白的。

希望这有帮助:)

更新：

你可以这样做：

```
if(mail($mailTo, $subject, $message, $headers )) 
   echo 'Mail successfully sent!';
else
   echo 'Sorry! Something went wrong...'; 
```

有了这个，您的页面将有一些内容，并且看起来不再像什么都没发生一样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T08:29:30.403

在您的 php 脚本中，您正在发送邮件，但之后您什么也不做！，没有回声。

发送邮件后在末尾添加：

```
echo "Mail sent"; 
```

您会看到该消息出现。

**编辑**：

为了向主页传递消息，您需要将消息放入会话中，然后重定向到主页：

```
$_SESSION['myMsg'] = "some message";
header("location: /hompage.php"); 
```

现在，在主页上，在脚本中添加要添加消息的位置：

```
if (isset($_SESSION['myMsg'])){
    $message = $_SESSION['myMsg'];
    //do something with message
} 
```

完成后清理会话也是一个好主意，您可以使用：

```
session_unset(); // clears all session varaibles

unset($_SESSION['myVar']); // clear specific variable 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T09:41:42.730

根据我的评论，您正在使用带有`get`方法的表单，因此它将在您的 URL 的查询字符串中创建变量。这些可以通过 而`$_GET`不是访问`$_POST`。

虽然您可以将您的`$_POST`引用切换到`$_GET`- 它会起作用 - 这不是一个好主意。该`post`操作适用于不应因页面刷新而重复的事件，例如发送电子邮件或修改数据库。因此，解决方案是修改您的表单。

为此，请修改您的表单：

```
<form action="sendemail.php" class="form" method="post"> 
```

# clojure - 如何将 clojure.contrib.monads 转换为与 clojurescript 一起使用？

> ID：11381742
> 
> 赞同：8
> 
> 时间：2012-07-08T08:26:38.787
> 
> 标签：clojure, monads, clojurescript

我想在 ClojureScript 中使用 Clojure Monad 库 clojure.contrib.monads。是否有一个已经过测试的实现可以与 ClojureScript 一起使用，因为它没有出现在标准的 ClojureScript 发行版中？

（我假设我可能只需要将代码从 clj 复制并粘贴到 cljs 中。虽然宏呢，因为它们需要在 clj 文件中）

## 更新：（我是否认为这是我需要的两个文件？）

文件

*   [monads.clj](https://github.com/richhickey/clojure-contrib/blob/master/src/main/clojure/clojure/contrib/monads.clj)
*   [monadic_io_streams.clj](https://github.com/richhickey/clojure-contrib/blob/master/src/main/clojure/clojure/contrib/monadic_io_streams.clj)

好的，看起来这不存在。我将不得不首先通过 Clojure 中的实现，以确保不使用 eval 和类似的东西，因为 Clojurescript 不支持 Clojure 的所有功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T13:23:10.703

您可能想查看 Jim Duey 的[protocol-monads](https://github.com/jduey/protocol-monads)，最近添加了 cljs 支持 - 请参阅[此提交](https://github.com/jduey/protocol-monads/commit/224a15135bd721fb81f22afca53dc6ae92754416)了解详细信息。

# asp.net-mvc-3 - 属性“Id”是对象的关键信息的一部分，不能修改

> ID：11381744
> 
> 赞同：0
> 
> 时间：2012-07-08T08:26:55.837
> 
> 标签：asp.net-mvc-3, entity-framework

我正在开发一个 asp.net mvc 3.0 应用程序，并将 EF 4.1 用于我的数据访问层和工作单元模式。

这是我的模型：

```
 public class UpdateUserViewModel
    {
        public User User { get; set; }
    }

public partial class Role
    {
        public int Id { get; set; }

     }

    public partial class User
    {
        public Guid Id { get; set; }

        public virtual Role Role { get; set; }
    } 
```

我将 UpdateUserViewModel 传递给视图，然后将视图中的表单发布到以下操作：

```
public ActionResult UpdateUser(User user)
        {
            var userObj = unitofwork.UserRepository.GetByID(user.Id);

            TryUpdateModel(userObj, "User");

            userObj.Role = unitofwork.RoleRepository.GetByID(user.Role.Id);

            unitofwork.UserRepository.Update(userObj);

            unitofwork.Save();
        } 
```

当我在视图中更新用户角色（它是一个下拉列表）并尝试更新它时会出现问题。它给了我以下错误：

```
The property 'Id' is part of the object's key information and cannot be modified. 
```

但如果我不更新用户角色，它工作正常。

你能帮帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T18:03:33.240

您可以使用“排除”属性列表调用 TryUpdateModel - 如果适合您的方案，则只需排除 ID 属性。

例如

```
TryUpdateModel(user, null, null, new [] { "Id"} ) 
```

# .net - 从 .net 运行 T-SQL 命令

> ID：11381746
> 
> 赞同：1
> 
> 时间：2012-07-08T08:27:22.807
> 
> 标签：.net, sql, sql-server-2008, tsql, c#-2.0

我有一个应用程序可以向 sql server 添加新登录名，然后将其映射到所有数据库并使其成为“db_owner”（这些是要求......）。当我构建应用程序时，我使用了 SMO，一切都很完美。现在要求已经改变，我不能再使用 SMO 了没有添加登录名，也没有映射到所有数据库......但是当我在 SQL Server 管理工作室中执行这些行时，它工作得很好......

这些是命令-

```
create login dbUser WITH PASSWORD = 'passsword';

use DB_MyLog;
create user dbUser for login dbUser;
use DB_MyLog
EXEC sp_addrolemember 'db_owner','dbUser' 
```

在我的应用程序中，我像这样运行它们 -

```
string connString = "Data Source=" + ConfigurationManager.AppSettings.Get("localhost_SQLEXPRESS")
                                    + ";Initial Catalog=" + "master" + ";User ID=" + ConfigurationManager.AppSettings.Get("user")
                                    + ";Password=" + ConfigurationManager.AppSettings.Get("password");

        SqlConnectionStringBuilder builder = new SqlConnectionStringBuilder(connString);

        builder.AsynchronousProcessing = true;

        using (SqlConnection sqlConnection1 = new SqlConnection(builder.ConnectionString))
        {

            using (SqlCommand cmd = new SqlCommand("CREATE LOGIN " + ConfigurationManager.AppSettings.Get("dbUser") +
                                                    " WITH PASSWORD=N'" + ConfigurationManager.AppSettings.Get("dbUserPass") + "' "
                                                     , sqlConnection1))
            {

                sqlConnection1.Open();

                cmd.BeginExecuteNonQuery();

             }
        } 
```

在另一种方法中我运行 -

```
 string connString = "Data Source=" + ConfigurationManager.AppSettings.Get("localhost_SQLEXPRESS")
                + ";Initial Catalog=" + "master" + ";User ID=" + ConfigurationManager.AppSettings.Get("user")
                + ";Password=" + ConfigurationManager.AppSettings.Get("password");

        SqlConnectionStringBuilder builder = new SqlConnectionStringBuilder(connString);

        builder.AsynchronousProcessing = true;

        using (SqlConnection sqlConnection1 = new SqlConnection(builder.ConnectionString))
        {
            //get all databases
            using (SqlCommand cmd = new SqlCommand("SELECT * FROM sys.sysdatabases", sqlConnection1))
            {

                sqlConnection1.Open();
                SqlDataReader reader = cmd.ExecuteReader();

                // Call Read before accessing data.
                while (reader.Read())
                {
                    using (SqlConnection sqlConnection2 = new SqlConnection(builder.ConnectionString))
                    {
                        sqlConnection2.Open();
                        using (SqlCommand cmd1 = new SqlCommand("use " + reader[0].ToString() + ";" +
                                                                "create user " + ConfigurationManager.AppSettings.Get("dbUser") + " for login " + ConfigurationManager.AppSettings.Get("dbUser") + ";" +
                                                                "use " + reader[0].ToString() +
                                                                " EXEC sp_addrolemember 'db_owner','" + ConfigurationManager.AppSettings.Get("dbUSer") + "'"
                                                                , sqlConnection2))
                        {
                            cmd1.BeginExecuteNonQuery();

                        }

                    }
                }

                // Call Close when done reading.
                reader.Close();

            }
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T09:01:30.937

如果您为 sqlConnection2 设置 ";Initial Catalog=" + reader[0].ToString() ，而不是重新使用 SqlConnectionStringBuilder 构建器，它是否有效？然后，您可以省略 USE 语句，发出两个单独的 SqlCommand（CREATE USER、EXEC）。

将这些步骤分开可能会帮助您确定哪个语句失败以及在哪个数据库上使用 while() 循环中的 try/catch。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T09:23:19.350

如果您使用`BeginExecuteNonQuery`并发生错误，则它仅在回调处理程序中可见。也许调用`ExecuteNonQuery`而不是`BeginExecuteNonQuery`.

# objective-c - Objective C iOS 预加载视图

> ID：11381747
> 
> 赞同：7
> 
> 时间：2012-07-08T08:27:24.643
> 
> 标签：objective-c, ios, xcode, uiwebview, uitabbarcontroller

我有一个基于标签栏的应用程序，带有 3 个标签（视图）。在应用程序委托或加载的第一个选项卡中，我将如何在后台加载其他 2 个视图的全部内容？

现在我在每个有问题的视图中都有一个 webView。我的部分问题是它们被加载到 viewDidLoad 但导致等待空白屏幕

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-08T13:25:16.323

答案对我来说不是那么清楚.. 所以我有 3 个`UIViewController`（或它们的子类）包含在一个`UITabBarViewController`中，强制它们加载视图的方法是`-view`在添加到之前调用 AppDelegate 中每个丰富的属性UITabbarViewController 实例。像这样的东西：

```
UIViewController * myViewController = [[UIViewController alloc] initWithNibName:@"mynib" bundle:nil];
[myViewController view];//<--here you are forcing the view to be loaded before it will be called from the tabbatviewcontroller 
```

这是一种避免（根本不是）您正在经历的行为的方法......在后台加载的概念要复杂得多。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-08T09:21:40.003

尝试：

```
viewController.view.hidden = NO; 
```

对于您想要预加载的任何 viewController，它已经分配并初始化了 beeb。也就是说，在 alloc 和 initWithNibName:... 完成之后。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-11-06T01:58:40.297

我通常使用这样的东西：

```
if (vc.view == nil)      // force load of view
{
    NSLog(@"%s ***** ERROR: view == nil: %@", __PRETTY_FUNCTION__, vc);
} 
```

**注意：**在调用 vc.view 之后，视图*永远不*应该为零——这是一个非常严重的分配错误。

# android - 应用程序启动时模拟器中的 Android 初始错误

> ID：11381749
> 
> 赞同：1
> 
> 时间：2012-07-08T08:27:52.947
> 
> 标签：android, android-emulator

我面临着这个奇怪的错误。每当我在我的模拟器上启动我的应用程序时，我都会在模拟器中收到一条消息，说“**不幸的是，搜索已停止”**。

我的 LogCat 也显示了一些错误，但几秒钟后，应用程序运行正常，没有任何麻烦。

但是，每次我在模拟器上上传并安装应用程序时，都会出现此错误。

我意识到它不会对应用程序造成任何麻烦，因为在最初的错误之后，一切都运行良好，但我仍然非常想知道这种错误的原因。

这是我的 LogCat 显示的内容。

```
07-08 13:47:38.262: E/AndroidRuntime(1931): FATAL EXCEPTION: main
07-08 13:47:38.262: E/AndroidRuntime(1931): java.lang.RuntimeException: Unable to instantiate application android.app.Application: java.lang.NullPointerException
07-08 13:47:38.262: E/AndroidRuntime(1931):     at   android.app.LoadedApk.makeApplication(LoadedApk.java:482)
07-08 13:47:38.262: E/AndroidRuntime(1931):     at   android.app.ActivityThread.handleBindApplication(ActivityThread.java:3938)
07-08 13:47:38.262: E/AndroidRuntime(1931):     at android.app.ActivityThread.access$1300(ActivityThread.java:123)
07-08 13:47:38.262: E/AndroidRuntime(1931):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1185)
07-08 13:47:38.262: E/AndroidRuntime(1931):     at android.os.Handler.dispatchMessage(Handler.java:99)
07-08 13:47:38.262: E/AndroidRuntime(1931):     at android.os.Looper.loop(Looper.java:137)
07-08 13:47:38.262: E/AndroidRuntime(1931):     at android.app.ActivityThread.main(ActivityThread.java:4424)
07-08 13:47:38.262: E/AndroidRuntime(1931):     at java.lang.reflect.Method.invokeNative(Native Method)
07-08 13:47:38.262: E/AndroidRuntime(1931):     at java.lang.reflect.Method.invoke(Method.java:511)
07-08 13:47:38.262: E/AndroidRuntime(1931):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
07-08 13:47:38.262: E/AndroidRuntime(1931):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
07-08 13:47:38.262: E/AndroidRuntime(1931):     at dalvik.system.NativeStart.main(Native Method)
07-08 13:47:38.262: E/AndroidRuntime(1931): Caused by: java.lang.NullPointerException
07-08 13:47:38.262: E/AndroidRuntime(1931):     at android.app.LoadedApk.initializeJavaContextClassLoader(LoadedApk.java:362)
07-08 13:47:38.262: E/AndroidRuntime(1931):     at android.app.LoadedApk.getClassLoader(LoadedApk.java:305)
07-08 13:47:38.262: E/AndroidRuntime(1931):     at android.app.LoadedApk.makeApplication(LoadedApk.java:474)
07-08 13:47:38.262: E/AndroidRuntime(1931):     ... 11 more 
```

知道可能是什么原因吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T08:38:36.537

1.  确保您在文件中正确声明了`android:name`应用程序标记的属性`AndroidManifest.xml`。

2.  有关logcat 错误的说明，请参见[**此处的答案。**](https://stackoverflow.com/q/10150899/844882)`Unable to instantiate application android.app.Application`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T08:48:26.593

使用应用程序名称在 androidManifest.xml 中创建一个条目

```
<application
        android:name=<name of the class that extends Application>
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" > 
```

# tsql - 如何将循环（WHILE 语句）用于“WITH”子句结果（tsql）？

> ID：11381752
> 
> 赞同：1
> 
> 时间：2012-07-08T08:28:22.733
> 
> 标签：tsql

在我的 T-SQL 代码中，我`WITH`用于从表中读取数据。阅读后，我想使用`WHILE`从结果中获取项目（第一项，第二项，...）`WITH`并从中删除项目。

请看我的代码：

```
With Rep(SubjectId) As
(
    SELECT [SubjectID] FROM [BookSubjects]
        WHERE [BookID] = @BookID
)   
WHILE EXISTS(SELECT [SubjectID] FROM Rep)
BEGIN
        SELECT @SubjectID = SubjectID FROM Rep          
        SELECT @Result = @Result + CAST(@SubjectID AS varchar(10))
        DELETE FROM Rep WHERE SubjectID = @SubjectID
END 
```

我想我无法删除来自`WITH`! 但我的另一个问题是如何将`identity(1,1)`列设置为`WITH`参数？

在声明临时表中，我使用这个：

```
 @ID Int Identity(1,1) 
```

如何定义`WITH`参数的身份？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T09:01:27.933

公用表表达式 ( ... `WITH`) 只能位于单个`SELECT`、`UPDATE`、`INSERT`或语句之前。但是，您的代码似乎非常复杂。`DELETE``MERGE`

这应该与您的代码相同，但效率更高：

```
DECLARE @delSubjects TABLE (
  id int NOT NULL
);
DELETE BookSubjects
  OUTPUT DELETED.SubjectID INTO @delSubjects 
  WHERE BookID=@BookID;
SET @result = (
  SELECT id+' ' 
  FROM @delSubjects 
  FOR XML PATH('')
); 
```

（[链接到小提琴](http://sqlfiddle.com/#!3/51ec5/2/0)）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T13:23:54.613

我认为您正在寻找这样的东西：

```
create table BookSubjects(SubjectID int,BookID int)
insert into BookSubjects(SubjectID ,BookID ) values(1,10)
insert into BookSubjects(SubjectID ,BookID ) values(2,20)
insert into BookSubjects(SubjectID ,BookID ) values(3,30)
insert into BookSubjects(SubjectID ,BookID ) values(4,40)
insert into BookSubjects(SubjectID ,BookID ) values(5,50)
insert into BookSubjects(SubjectID ,BookID ) values(6,60)
insert into BookSubjects(SubjectID ,BookID ) values(2,10)
insert into BookSubjects(SubjectID ,BookID ) values(2,10)
insert into BookSubjects(SubjectID ,BookID ) values(3,10)
insert into BookSubjects(SubjectID ,BookID ) values(4,10)
insert into BookSubjects(SubjectID ,BookID ) values(5,10)
insert into BookSubjects(SubjectID ,BookID ) values(6,10)

select * from BookSubjects

       ;With Rep As
        (
            SELECT [SubjectID],[BookID] FROM [BookSubjects]
            WHERE [BookID] = 10
        )
        , Rep1 As
        (
        select
        [BookID],
        stuff((
            select ',' + cast(t.[SubjectID]  as varchar(100))
            from Rep t
            where Rep.[BookID]  = t.[BookID] 
            order by t.[SubjectID] 
            for xml path('')
        ),1,1,'') as name_csv
        from Rep
        group by [BookID]

        )  
        select * from rep1 
```

我在第二个 With(Named Rep1) 中的第一个 With 之后使用另一个 With 子句我转换行返回两个逗号分隔的列。你可以改变你的需要。

# doctrine - 如何分析 Doctrine MongoDB ODM？

> ID：11381755
> 
> 赞同：1
> 
> 时间：2012-07-08T08:28:34.130
> 
> 标签：doctrine, doctrine-odm

我如何分析 Doctrine MongoDB ODM？

我想查看针对数据库的所有查询和执行时间。有没有办法配置分析器？我想构建一个插件，我会在 ZFDebug 工具栏中使用它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T21:19:58.767

[ZF2](https://github.com/doctrine/DoctrineMongoODMModule/tree/0.7.0/src/DoctrineMongoODMModule/Logging)的MongoDBODMModule 可能有一些类可以在 ZF1 中重用来处理这个问题。如果您已经在使用 ZF2，那么只需安装模块和[ZendDeveloperTools](https://github.com/zendframework/ZendDeveloperTools)即可拥有工具栏。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T09:50:40.300

MongoDB 有自己的分析器，请查看[http://docs.mongodb.org/manual/tutorial/manage-the-database-profiler/](http://docs.mongodb.org/manual/tutorial/manage-the-database-profiler/)

# php - 使用反射来获取具有相同名称的不同类的方法？

> ID：11381756
> 
> 赞同：0
> 
> 时间：2012-07-08T08:28:46.813
> 
> 标签：php, class, reflection, methods

我有 2 个同名的类位于不同的模块中。当使用反射获取类的方法时，它只找到第一个及其方法。如何指定是否查找类以反映在另一个模块（另一个文件夹）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T08:46:12.650

考虑使用命名空间来避免名称冲突。

`/application/moduleA/myclassname`

`/application/moduleB/myclassname`

或为您的类名附加前缀。

`moduleA_myclassname`

`moduleB_myclassname`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T08:39:41.040

只需指定完整的限定名称。

# c - ARM cortex-M3 uint_fast32_t 与 uint32_t

> ID：11381764
> 
> 赞同：5
> 
> 时间：2012-07-08T08:29:43.793
> 
> 标签：c, types, sizeof, primitive-types, cortex-m3

我正在为 STM32Fx cortex-M3 系列处理器开发程序。在 stdint.h 中定义了以下内容：

```
typedef unsigned int uint_fast32_t;
typedef uint32_t  uint_least32_t;
typedef unsigned long uint32_t; 
```

据我了解。

```
[u]int_fast[n]_t will give you the fastest data type of at least n bits.
[u]int_least[n]_t will give you the smallest data type of at least n bits.
[u]int[n]_t will give you the data type of exactly n bits. 
```

另外据我所知 sizeof(unsigned int) <= sizeof(unsigned long) 和 UINT_MAX <= ULONG_MAX - 总是。

因此，我希望 uint_fast32_t 是一种大小等于或大于 uint32_t 大小的数据类型。

在 cortex-M3 的情况下，sizeof(unsigned int) == sizeof(unsigned long) == 4。所以上述定义在大小方面是“正确的”。

但是为什么它们没有以与底层数据类型的名称和逻辑大小一致的方式定义，即

```
typedef unsigned long uint_fast32_t;
typedef unsigned int  uint_least32_t;
typedef uint_fast32_t uint32_t; 
```

有人可以澄清基础类型的选择吗？

鉴于 'long' 和 'int' 的大小相同，为什么不对所有三个定义使用相同的数据类型呢？

```
typedef unsigned int uint_fast32_t;
typedef unsigned int uint_least32_t;
typedef unsigned int uint32_t; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T08:35:04.350

情况是，只能保证

```
sizeof(long) >= sizeof(int) 
```

并且不能保证它实际上不再是。在很多系统上，int 通常和 long 一样大。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-29T02:00:07.203

请参阅我对[您其他问题的回答](https://stackoverflow.com/q/11518212/827263)。

基本上，使用哪种类型并不重要。鉴于`int`和`long`具有相同的大小并具有相同的表示形式和其他特征，实现者可以为`int32_t`、`int_fast32_t`和选择任何一种类型，`int_least32_t`对于相应的无符号版本也是如此。

（特定选择可能会受到感知需要的影响，即对于`int`and具有不同大小的实现使用相同的标头`long`，但我不知道您引用的特定定义将如何实现这一点。）

只要类型大小合适并满足标准规定的所有其他要求，并且只要您不编写依赖于例如`int32_t`与 兼容`int`或与兼容的代码`long`，就没有关系。

做出的特定选择可能是实施者的任意心血来潮——这是完全可以接受的。或者，这个头文件可能是由两个或多个对哪种类型最好有不同想法的开发人员修改的。

# javascript - 刽子手 jQuery 函数

> ID：11381766
> 
> 赞同：0
> 
> 时间：2012-07-08T08:30:01.350
> 
> 标签：javascript, jquery, html, function

我根据在网上找到的 jQuery 代码创建了一个刽子手。我了解代码是如何工作的，如果我只想使用一个词，它就可以完美地工作。我想使用多个单词的游戏，所以我创建了一个函数来做到这一点。不幸的是，它不适用于该功能。

这是我创建的功能：

```
 function hangman(var word)
        {
            var alpha = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            $.each(alpha.split(''), function(i, val){
            $('#alpha').append($('<span class="guess">' + val + '</span>'));
            });
            $.each(word.split(''), function(i, val){
            $('#word').append($('<span class="letter" letter="' + val +'">_</span>'));
            });
            $('.guess').click(function(){
            var count = $('#word [letter='+$(this).text()+']').each(function(){ $(this).text($(this).attr('letter'));}).length;
            $(this).removeClass('guess').css('color' , (count > 0 ? 'green' : 'red')).unbind('click');
            });
        }

        $(document).ready(function() {
        $('#BUT').click(function() {
            hangman('DOG');
                });
            }); 
```

这是我的 HTML：

```
<div id="hangman-jquery">
    <div id="word"></div>
    <div id="alpha"></div>
</div>
<button id= "BUT" ></button> 
```

正如我所说，它不起作用。你知道解决办法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T08:37:54.677

```
function hangman(var word)
//                ^try removing 'var' 
```

似乎以某种方式工作：http: [//jsfiddle.net/BdkTC/](http://jsfiddle.net/BdkTC/)

# html - 在 JSF 页面中缓存图片

> ID：11381767
> 
> 赞同：1
> 
> 时间：2012-07-08T08:30:13.293
> 
> 标签：html, caching, jsf-2

从事一些 JSF 2.0 项目。有为新/现有用户添加图片的表格。不刷新页面（*.xhtml）就看不到新添加的图片。我试着把常规：

```
<meta http-equiv="pragma" content="no-cache"> 
<meta http-equiv="cache-control" content="no-cache"> 
<meta http-equiv="expires" content="0"> 
```

但这没有帮助。

如何禁用页面缓存？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T15:01:04.627

当通过 HTTP 提供页面时，将**忽略**HTML`<meta http-equiv>`标记。只有当最终用户将页面保存到本地磁盘文件系统，然后通过URL从它打开时，才会解释这些标签。**`<meta http-equiv>``file://`**

 **您需要在*真实的*HTTP 响应上设置这些标头。最简单的方法是使用基本上可以的[servlet 过滤器](https://stackoverflow.com/tags/servlet-filters/info)

```
response.setHeader("Cache-Control", "no-cache, no-store, must-revalidate"); // HTTP 1.1.
response.setHeader("Pragma", "no-cache"); // HTTP 1.0.
response.setDateHeader("Expires", 0); // Proxies.
chain.doFilter(request, response); 
```

*（注意你原来的`Cache-Control`标题是不完整的，上面的例子是正确的用法）*

您可以将其映射到特定页面的 URL 模式上，但您也可以考虑将其映射到 JSF 生成的所有动态页面上。**

# c# - Thread.sleep vs Monitor.Wait vs RegisteredWaitHandle？

> ID：11381771
> 
> 赞同：11
> 
> 时间：2012-07-08T08:31:30.403
> 
> 标签：c#, .net, multithreading, .net-4.0, clr

*（以下项目有不同的目标，但我很有趣知道它们是如何“暂停”的）*

问题

`Thread.sleep`- 它会影响系统的性能吗？它是否会在等待时占用线程？

怎么样 `Monitor.Wait` ？他们“等待”的方式有什么不同？他们是否在等待时占用了线程？

怎么样`RegisteredWaitHandle`？此方法接受在发出等待句柄信号时执行的委托。在等待时，**它不会**占用线程。

所以一些线程被暂停并且可以被委托唤醒，而其他线程只是等待？旋转 ？

有人可以让事情更清楚吗？

编辑

[http://www.albahari.com/threading/part2.aspx](http://www.albahari.com/threading/part2.aspx)

![在此处输入图像描述](../Images/9c0ccfcb985e0066ec4331c44d0628f8.png)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-08T08:41:50.360

两者都`Thread.Sleep`将`Monitor.Wait`线程[置于`WaitSleepJoin`状态](http://msdn.microsoft.com/en-us/library/system.threading.threadstate.aspx)：

> WaitSleepJoin：线程被阻塞。这可能是调用 Thread::Sleep 或 Thread::Join、请求锁（例如，通过调用 Monitor::Enter 或 Monitor::Wait）或等待线程同步对象（如 ManualResetEvent）的结果。

`RegisteredWaitHandle`通过调用[RegisterWaitForSingleObject](http://msdn.microsoft.com/en-us/library/system.threading.threadpool.registerwaitforsingleobject.aspx)并传递一个`WaitHandle`. 通常此类的所有后代都使用阻塞机制，因此调用`Wait`将再次将线程放入`WaitSleepJoin`（例如`AutoResetEvent`）。

这是 MSDN 的另一句话：

> RegisterWaitForSingleObject 方法检查指定对象的 WaitHandle 的当前状态。如果对象的状态是未发出信号的，则该方法注册一个等待操作。等待操作由线程池中的一个线程执行。当对象的状态变为信号或超时间隔过去时，工作线程将执行委托。

所以池中的一个线程**确实在等待**信号。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-09T01:15:26.477

关于`ThreadPool.RegisterWaitForSingleObject`，这不会**占用**每个注册的线程（池化或其他）。您可以轻松地对此进行测试：在 LINQPad 中运行以下脚本，该脚本调用该方法 20,000 次：

```
static ManualResetEvent _starter = new ManualResetEvent (false);

void Main()
{
    var regs = Enumerable.Range (0, 20000)
        .Select (_ => ThreadPool.RegisterWaitForSingleObject (_starter, Go, "Some Data", -1, true))
        .ToArray();

    Thread.Sleep (5000);
    Console.WriteLine ("Signaling worker...");
    _starter.Set();
    Console.ReadLine();

    foreach (var reg in regs) reg.Unregister (_starter);
}

public static void Go (object data, bool timedOut)
{
    Console.WriteLine ("Started - " + data);
    // Perform task...
} 
```

如果该代码在 5 秒的“等待”期间占用了 20,000 个线程，它就不可能工作。

**编辑**- 回应：

> “这是一个证明。但是否还有一个线程只检查信号？在线程池中？”

这是一个实现细节。是的，它*可以*通过将回调卸载到托管线程池的单个线程来实现，尽管不能保证这一点。等待句柄最终由操作系统管理，这很可能也会触发回调。它可能在其内部实现中使用一个线程（或少量线程）。或者使用中断，它可能不会阻塞单个线程。它甚至可能因操作系统版本而异。这是一个与我们没有真正关系的实现细节。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-07-09T06:46:05.643

虽然确实`RegisterWaitForSingleObject`会创建等待线程，但并非每个调用都会创建一个。

来自[MSDN](http://msdn.microsoft.com/en-us/library/windows/desktop/ms685061)：

> 需要时自动创建新的等待线程

来自 Raymond Chen 的[博客](http://blogs.msdn.com/b/oldnewthing/archive/2008/11/17/9105009.aspx)：

> ...而不是花费整个线程，它花费更接近（但不完全是）线程的 1/64

因此，使用`RegisterWaitForSingleObject`通常比创建自己的等待线程更可取。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-07-08T09:27:52.590

ThreadPool.g RegisterWaitForSingleObject 最终会在其本机实现中调用 [QueueUserAPC](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684954%28v=vs.85%29.aspx)。请参阅转子源 (sscli20\clr\src\vm\win32threadpool.cpp(1981))。与 Wait Thread.Sleep 不同，当您使用 RegisterWaitForSingleObject 时，您的线程不会停止。

而是为这个线程注册了一个带有用户模式回调的 FIFO 队列，当线程处于警报状态时将调用该队列。这意味着您可以继续工作，当您的线程被阻塞时，操作系统将处理注册的回调，让您的线程有机会在等待时做一些有意义的事情。

**编辑1：**

完成分析。在调用 RegisterWaitForSingleObject 的线程上，当线程处于警报状态时，会在线程上调用回调。一旦发生这种情况，调用 RegisterWaitForSingleObject 的线程将执行一个 CLR 回调，该回调会注册另一个由线程池回调等待线程处理的回调，该线程池回调等待线程仅用于等待信号回调。然后，此线程池回调等待线程将定期检查信号回调。

这个等待线程最终会调用 QueueUserWorkItem 以在线程池线程上执行信号回调。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-07-08T11:39:26.760

`Thread.Sleep`并`RegisteredWaitHandle`在不同层次上工作。让我尝试清除它：

进程有多个线程，它们同时执行（取决于操作系统调度程序）。如果一个线程调用`Thread.Sleep`or `Monitor.Wait`，它不会旋转 - 它被置于 WaitSleepJoin 状态，并将 CPU 分配给其他线程。

现在，当您有许多同时工作的项目时，您可以使用线程池——一种创建多个线程的机制，并使用它自己对工作项目的理解将调用分派给它的线程。在此模型中，工作线程从线程池调度程序中调用以完成一些工作，然后返回池中。如果一个工作线程调用一个阻塞操作——比如`Thread.Sleep`或`Monitor.Wait`——这个线程被“捆绑”了，因为线程池调度程序不能将它用于额外的工作项。

我不熟悉实际的 API，但我认为`RegisteredWaitHandle`会告诉线程池调度程序在需要时调用工作线程——并且您自己的线程不会“被捆绑”，并且可以继续其工作或返回线程池。

# abstract-class - 使用访客模式检测两个形状之间的交集

> ID：11381774
> 
> 赞同：1
> 
> 时间：2012-07-08T08:32:27.283
> 
> 标签：abstract-class, intersection, derived-class, visitor-pattern

我意识到这是一个非常具体的问题，因此如果人们给出的答案包括有关如何执行此操作的明确代码，那将会很有帮助。谢谢。

我有一个抽象基类 Shape：

```
class Shape
{
    .....
    virtual bool GetIntersection(Shape* _shape) = 0;
}

class Circle : public Shape  {...}
class Triangle : public Shape {...} 
```

这两个派生类都覆盖了 GetIntersection；

我有：

```
//main.cpp
....
Shape* shape;
Shape* circle = new Circle;

if(input == 0) shape = new Circle;
else shape = new Triangle;

circle->GetIntersection(shape); 
```

这给出了一个错误。

我阅读了一些有关访问者模式的内容，并认为这可能是解决我的问题的方法，因为我基本上需要确定 GetIntersection 的参数正在使用哪个派生类。有人可以解释我将如何为这种情况实施访问者模式吗？或者如果这个问题有另一个更简单的解决方案。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T20:29:30.710

我现在面临着不同形状之间碰撞的同样问题。

我认为我们不能“按原样”使用访问者模式，因为它要求层次 A（访问者）的类访问另一个层次 B（访问的元素）的类，其中 B 的类只知道 A 的抽象（例如**IVisitor**）而 B 的类知道 A 的子类（**VisitedElement1**，**VisitedElement2** ... VisitedElement 的子类）。

在我们的例子中，我们尝试使用 Shapes 访问 Shapes，同时保持 Shape 类与子类分离，因此访问者模式不适用。

我能想到的最佳解决方案是 Shape 类直接或通过另一个接口为所有子类型声明“GetSpecificIntersection”方法：

```
class Shape
{
    .....
public:
    virtual bool GetIntersection(Shape* _shape) = 0;    
protected:
    virtual bool GetSpecificIntersection(Circle* _circle) = 0;
    virtual bool GetSpecificIntersection(Triangle* _triangle) = 0;
}

class Circle
{
    .....
public:
    virtual bool GetIntersection(Shape* _shape);
    {
        return _shape->GetSpecificIntersection(this);
    }
protected:
    virtual bool GetSpecificIntersection(Circle* _circle) { ... }
    virtual bool GetSpecificIntersection(Triangle* _triangle) { ... }
}

class Triangle { /* analog to Circle */ } 
```

因此，您必须为每种形状与任何其他类型的形状实现这些特定的交集方法，并且 Shape 类与所有可能的形状耦合。如果我没记错的话，这违反了[OCP](http://en.wikipedia.org/wiki/Open/closed_principle)但保留了[LSP](http://en.wikipedia.org/wiki/Liskov_substitution_principle)。

我刚刚提出的另一个选择是“优先组合而不是继承”并制作如下内容：

```
class Shape
{
    .....
public:
    virtual bool GetIntersection(Shape* _shape)
    {
        return _shape->figure->GetIntersection(this->figure);
    }

private:
    Figure* figure;
}

class Figure
{
    .....
public:
    virtual bool GetIntersection(Figure* _figure) = 0;
protected:
    virtual bool GetSpecificIntersection(Circle* _circle) = 0;
    virtual bool GetSpecificIntersection(Triangle* _triangle) = 0;
}

class Circle
{
    .....
public:
    virtual bool GetIntersection(Figure* _figure)
    {
        return _figure->GetSpecificIntersection(this);
    }
protected:
    virtual bool GetSpecificIntersection(Circle* _circle) { ... }
    virtual bool GetSpecificIntersection(Triangle* _triangle) { ... }
}

class Triangle { /* analog to Circle */ } 
```

它和以前一样，但是通过这样做，你将你的 Shape 类（这是你的游戏类使用的接口）与不同的“Figures”（我没有想出更好的名字）解耦，所以添加新的图形甚至不应该导致重新编译您的客户端类。这仅在“图形”层次结构中违反[OCP](http://en.wikipedia.org/wiki/Open/closed_principle) ，并为“形状”和“图形”保留[LSP 。](http://en.wikipedia.org/wiki/Liskov_substitution_principle)

如果有人可以提出更好的方法来避免*沮丧*，我将非常感激：D

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-09T20:25:38.173

这个问题似乎与这个问题重叠： [用于检查形状之间碰撞的设计模式](https://stackoverflow.com/questions/6163457/design-pattern-for-checking-collision-between-shapes)

其中使用了访问者模式，看起来很清晰。诀窍是让每个形状（圆形、方形等）成为其他形状的访问者。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-08T08:45:35.030

你的解决方案是正确的。

您首先可以获得一个边界框并检查边界框之间的碰撞。请记住，在任何情况下，您都无法将苹果与橙子进行比较。所以开始比较两个边界框。

然后，如果发生碰撞，您可能需要查找各个点。每个形状都可以返回其轮廓的点或向量，您可以轻松找出是否存在碰撞。可能有一些方法可以加快速度，比如知道一个点是否在正方形内很容易，或者知道一个点是否在一个圆内只是检查从一个点到中心的长度是否大于半径。

然后你可以做类似 Shape { bool isPointInside(Point p) = 0; }

这比检查每个单独的点要快得多。

您还可以覆盖 getIntersection for circle 以不同方式检查正方形等。而不仅仅是 Shape。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-09T11:18:11.093

您可以使用 fx`dynamic_cast<Circle *>(shape)`查看形状是否为圆形。如果 shape 不是 Circle，则返回 null，否则返回指向 Circle 实例的有效指针。

如果您的 GetInserection 方法之一知道如何与特定的其他 Shape 子类型相交，请使用此方法。

除此之外，请遵循[Loïc Faure-Lacroix 的回答](https://stackoverflow.com/a/11381836/1472628)指南。

# javascript - Facebook Feed 对话框：即使我收到回复 ID，帖子也没有显示在朋友的墙上

> ID：11381776
> 
> 赞同：0
> 
> 时间：2012-07-08T08:32:36.050
> 
> 标签：javascript, facebook

我正在 facebook 上创建一个应用程序，我正在尝试发布到朋友的墙上。我正在使用 facebook javascript SDK 和 FB.ui 方法来执行此操作。简而言之，这是我的代码：

```
function test() {

var obj = {
      method: 'feed',
      to: '######'
    };

function callback(response) {
      alert(response['post_id']);
    }

FB.ui(obj, callback);
} 
```

请注意，出于测试目的，我使此代码非常简单。

当我运行它时，一个 facebook 提要对话框正确打开，并在顶部显示“将故事发布到 friendsname 的墙”。我输入一条消息，然后按分享。我的警报弹出一个 response['post_id'] 号码。因为有一个响应['post_id']，故事应该已经成功发布了对吧？但是，当我导航到朋友的墙时，没有故事。我以略有不同的方式尝试了多次，但无法使其正常工作。如果我删除“to”参数并简单地将其发布到我自己的墙上，它确实可以工作。所以出于某种原因，在朋友的墙上发帖会破坏它？

我知道这是一个相当广泛的问题，但我想知道是否有人知道为什么这不起作用。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T08:45:25.187

我怀疑问题可能是因为您的应用程序处于沙盒模式 - [https://developers.facebook.com/docs/ApplicationSecurity/](https://developers.facebook.com/docs/ApplicationSecurity/)

> 测试您的应用程序时，将它们置于沙盒模式。**这会完全隐藏您的应用程序，让所有您未在开发者应用程序中授权查看该应用程序的用户查看该应用程序，**角色如下所述。请注意，当您的应用处于沙盒模式时，您不能代表看不到您的应用的用户调用任何 API 调用。

基本上，如果您的应用程序处于沙盒模式，则未授权您的应用程序的用户**或未**在您的应用程序设置中的“角色”中明确列出的用户将看不到您的应用程序所做的任何事情。

将您的应用程序从沙盒模式中移除，或将一些用户添加到您的应用程序中的特定“角色”。

# asp.net - ASP.NET Session_End 事件和获取用户 IP 地址

> ID：11381777
> 
> 赞同：2
> 
> 时间：2012-07-08T08:32:46.140
> 
> 标签：asp.net, session

在我的 ASP.NET Web 应用程序中，我在 Global.asax 中有我的 Session_End 事件。我想要的是能够获得用户的IP地址。我试过的是

```
void Session_End(object sender, EventArgs e)
{
    string ip1 = HttpContext.Current.Request.UserHostAddress;
    string ip2 = Request.UserHostAddress;
} 
```

但是 Request 在这两种情况下都是空的。如何获取用户的 IP 地址？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-08T09:02:43.060

可以使用以下方法检索用户的 IP 地址：

```
HttpContext.Current.Request.UserHostAddress 
```

但如您所见，IP 地址是从“Current.Request”中检索的，而 Session_End 事件并非如此，因为它不是请求。如果您特别需要 Session_End 的 IP 地址，您可以尝试将 IP 地址保存到 Session_Start 的会话变量中，然后在 Session_End 调用它。

# testing - 合并来自多个项目 Gradle 构建的单元测试报告

> ID：11381782
> 
> 赞同：6
> 
> 时间：2012-07-08T08:33:41.340
> 
> 标签：testing, gradle

我有一个包含 3 个模块的多模块 Gradle 脚本`common`：`services`和`web`.

如果我运行`gradle check`所有测试套件都正确执行，但我没有一个测试报告，而是找到了每个子项目的测试报告。如何合并测试结果？

如果有用，这是我正在使用的脚本[https://github.com/CarloMicieli/trenako/blob/master/build.gradle](https://github.com/CarloMicieli/trenako/blob/master/build.gradle)

谢谢卡洛

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-15T01:20:05.733

Gradle 源代码包含一个用于完成此任务的任务类，遗憾的是公共 API 中不提供该类。基本上它所做的只是将来自不同项目的所有测试报告复制到一个目录中，然后运行标准测试报告任务以获取汇总。[在https://github.com/gradle/gradle/blob/master/buildSrc/src/main/groovy/org/gradle/build/TestReportAggregator.groovy](https://github.com/gradle/gradle/blob/master/buildSrc/src/main/groovy/org/gradle/build/TestReportAggregator.groovy)查看源代码

# php - 通过帖子显示视图页面的jquery响应

> ID：11381783
> 
> 赞同：0
> 
> 时间：2012-07-08T08:34:22.743
> 
> 标签：php, jquery, codeigniter

jQuery

```
var js={"employer":$employer,"district":$district,"state":$state};

     $.post(url+"/beneficarydetailsdisp",js,function(data){
                                        $("#noofbeneficiaryplacedtable").html(data.result);
            },"json"); 
```

我可以加载视图页面，但它显示在萤火虫而不是浏览器页面上？

萤火虫响应

```
{"result":"<!DOCTYPE html PUBLIC \"-\/\/W3C\/\/DTD XHTML 1.0 Transitional\/\/EN\" \"http:\/\/www.w3.org\/TR\/xhtml1\/DTD\/xhtml1-transitional.dtd\">\r\n<html crossriderapp3491=\"true\" xmlns=\"http:\/\/www.w3.org\/1999\/xhtml\"><head id=\"ctl00_Head1\">\r\n<meta http-equiv=\"content-type\" content=\"text\/html; charset=UTF-8\"><title>\r\n\tJob Placement\r\n<\/title>\r\n<!-- Page layout -->\r\n<link href=\"http:\/\/localhost\/******\/\/css\/StyleSheet.css\" rel=\"stylesheet\" type=\"text\/css\ .....contd" 
```

控制器

```
$employer ="Hass Enterprises";
    $district ="ADILABAD";
    $state ="ANDHRA PRADESH";
    $data['noofbeneficiaryplaceddetails']=$this->homemodel->getnoofbeneficiaryplaceddetails($employer,$district,$state);    

     $str=$this->load->view('noofbeneficiaryplaced',$data,true);
     $value=array(
            'result'=>$str

        );
        echo json_encode($value);} 
```

我无法加载视图？代码有什么问题

# python - Pyramid：如何在运行时在 view.py 中获取当前渲染器名称

> ID：11381784
> 
> 赞同：1
> 
> 时间：2012-07-08T08:34:53.267
> 
> 标签：python, pyramid, renderer

Pyramid 提供了一个 beforeRenderer

```
 from repoze.events import subscriber
    from pyramid.events import BeforeRender

    @subscriber(BeforeRender)
    def add_global(event):
        print event['renderer_name']      #this is the renderer name
        print event['renderer_info'].name #same with event['renderer_name'] 
```

但没有用。如果我更改或删除 event['renderer_name'] 和 event['renderer_info'].name，它还可以在 config.xml 中找到渲染器（模板文件）。

```
 config.add_view('mywork.views.index.index',
                     route_name='/index',
                     renderer='mywork:templates/index.pt') 
```

我想在 view.py 或 root_factory 中使用渲染器的名称来更改渲染器值，因此它可以更改所有模板。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T08:54:58.447

在渲染之前调用 BeforeRender。换句话说，它是`view.py`在我假设您放置视图的位置之后调用的。`root_factory`在此之前也被称为很多。`root_factory`用于创建根节点进行遍历。这将返回一个上下文。没有上下文，您的视图不会被调用，并且金字塔会引发上下文未找到错误。

在您的视图返回一些参数之后或可能在调用`renderToResponse`返回渲染器响应之前调用 BeforeRender。您可以在视图中传递渲染器。

[http://docs.pylonsproject.org/projects/pyramid/en/1.3-branch/narr/templates.html#using-templates-directly](http://docs.pylonsproject.org/projects/pyramid/en/1.3-branch/narr/templates.html#using-templates-directly)

并且您必须在设置视图时删除渲染器参数。

# data-binding - 如何最好地创建一个将返回动态构建的 ImageSource 的属性？

> ID：11381786
> 
> 赞同：1
> 
> 时间：2012-07-08T08:34:56.390
> 
> 标签：data-binding, asynchronous, properties, microsoft-metro, imagesource

在 Windows Metro 应用程序（发布预览版）中，我从数据点动态创建图像并使用数据绑定来显示图像。

由于图像创建是相当繁重的处理，我希望它在一个任务中完成。所以我的财产目前编码如下：

```
public ImageSource Diagram
{
    get
    {
        if (this.diagram == null)
        {
             DiagramGenerator.GetDiagram(this.DataPoints, this.Width, this.Height).ContinueWith((t) =>
             {
                 this.Diagram = t.Result;
             }
        }
        return this.diagram;
    }
    set
    {
        this.SetProperty(ref this.diagram, value);
    }
} 
```

DiagramGenerator 看起来像：

```
public static async Task<ImageSource> DiagramGenerator.GetDiagram(List<DataPoint> dataPoints, int width, int height)
{
    WriteableBitmap bmp = BitmapFactory.New(width, height);

    // Build the image...

    return bmp;
} 
```

在 Xaml 中，我的绑定非常简单

```
<Image Source="{Binding Diagram}" Stretch="UniformToFill"/> 
```

不幸的是，使用上面的代码不起作用。

我在 OnPropertyChanged 方法中出现异常（例如，在上面的 this.Diagram = t.Result 之后）：“应用程序调用了一个为不同线程编组的接口。”

然后我尝试使用以下方法编组到 UI 线程：

Window.Current.Dispatcher.RunAsync(Windows.UI.Core.CoreDispatcherPriority.Norma, () => { this.Diagram = t.Result; });

但这也不起作用，因为 Window.Current 为空！

怎么能解决这个问题？

非常感谢您的建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T01:37:16.523

您可以在 UI 线程上获取 Window.Current.Dispatcher 并将其存储以供以后使用，例如在创建 Diagram 对象时。或者，Dispatcher 存储在 DependencyObject 中，因此您可以从那里获取它（即它在任何 UIElement 对象中）。

# knockout.js - ko.mapping，如何监听改变对象的属性？

> ID：11381788
> 
> 赞同：1
> 
> 时间：2012-07-08T08:35:17.470
> 
> 标签：knockout.js, knockout-mapping-plugin

如何获取下一个对象的更改事件？

```
 $(function () {
    var Data = {
        id: ko.observable(15),
        name: ko.observable('my name'),
        status: ko.observable('status')
    }

    var ClickCounterViewModel = function () {
        var me = this;
        me.Model = ko.observable(Data);

        me.change = ko.computed(function () {
            var m = me.Model();
            console.log(m.status());
        });
    };

    ko.applyBindings(new ClickCounterViewModel());
}); 
```

我从以下位置获取对象数据：

```
ko.mapping(AnyInitData, {}, Data); 
```

模型的所有属性都是可观察的，但如果有任何值被改变，我想知道这一点。它可以通过 ko.computed 来完成，但我有很多属性，并且不会这样做。

如果状态已更改，则控制台的此示例输出仅“状态”，但如果属性“名称”已更改，则不执行任何操作。

对不起我的英语不好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T13:47:11.890

可能我的解决方案不是最合适或最优雅的方式，但是，如果您在计算变量中评估可观察对象，则每次变量更改时都会调用它。例如：

```
me.change = ko.computed(function () {
        var m = me.Model();
        alert('something changed');
        m.id(),m.name(),m.status();
    }); 
```

如果你有很多属性，你可以遍历模型：

```
me.change = ko.computed(function () {
        var m = me.Model();
        alert('something changed');

        for (var key in me.Model()) {
            var obj = me.Model()[key]; 
             if( ko.isObservable(obj)){
                obj();                 
             }             
        }
    }); 
```

您也可以考虑 1\. 在模型 2 中递归循环。防止循环多次。（每次变量更改时它都会循环。您可以放置​​一个计数器来执行一次。）

# ios - 同时使用 Sockets 和 GameKit。插座速度急剧下降

> ID：11381789
> 
> 赞同：1
> 
> 时间：2012-07-08T08:35:21.467
> 
> 标签：ios, sockets, xamarin.ios, gamekit

我遇到了一个相当大的问题，并且一直试图找到解决方案 2 个月，但没有运气。我已将其作为错误提交（[https://bugzilla.xamarin.com/show_bug.cgi?id=4910](https://bugzilla.xamarin.com/show_bug.cgi?id=4910)），但希望这里有人可以阐明问题的原因，或提出工作建议-大约。

简而言之，遇到错误：

1.  在两个设备之间创建基本的 .Net 套接字连接
2.  在至少一个设备上创建并初始化 GameKit.GKSession 对象。

发生的情况是 .NET 套接字上的数据传输变得不稳定且太慢而无法使用。我在不同的设备上进行了许多测试（见下面的链接），它影响了所有设备（iPad 3 影响最小）。我已经在 iPhone 和 Windows PC 之间进行了测试，它仍然会发生。MonoTouch 的 GameKit 代码在某种程度上影响了 Socket 代码。正如您从电子表格中看到的那样，速度从发送 1 MB 的几毫秒下降到几分钟到永远。一旦 GameKit.GKSession 设置为 null，套接字上的任何 backedlogged 数据都会再次自由流动，并且套接字会再次正常运行。

演示问题的示例 Windows 和 iOS/MonoTouch 应用程序：[https ://dl.dropbox.com/u/8617393/SocketBug/SocketBug.zip](https://dl.dropbox.com/u/8617393/SocketBug/SocketBug.zip)

跨不同设备的测试结果（PDF 电子表格）： [https ://dl.dropbox.com/u/8617393/SocketBug/SocketBugTestResults.pdf](https://dl.dropbox.com/u/8617393/SocketBug/SocketBugTestResults.pdf)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T14:16:23.337

这个问题似乎很难，即使苹果决定绕过它：http: [//developer.apple.com/library/ios/#qa/qa1753/_index.html#//apple_ref/doc/uid/DTS40011315](http://developer.apple.com/library/ios/#qa/qa1753/_index.html#//apple_ref/doc/uid/DTS40011315)

启示性的句子是这样的：“这个改变是为了减少对 Wi-Fi 的干扰。”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T11:24:44.320

为了帮助遇到此问题的任何人，该问题仅在 GKSession.Available 设置为 true 时才会出现。这是设备可发现所必需的，但不是保持连接所必需的。考虑到这一点，可以使用临时解决方法，其中 GKSession.Available 仅在需要时设置为 true，并在建立连接后立即设置为 false。

在我的场景中，我在两个设备上都有到服务器的套接字连接。我使用此连接从设备 A 向设备 B 发送消息，要求它在接下来的 10 秒内通过蓝牙变得可发现。消息一经发送，设备 A 就开始寻找设备 B，并在找到后立即连接。一旦建立连接（或 10 秒后没有连接），设备 B 将关闭可发现性，并且套接字正常运行。

在我的情况下，这是一个可以接受的（等待没有真正解决）问题的解决方法。

# java - Eclipse 找不到主类

> ID：11381793
> 
> 赞同：1
> 
> 时间：2012-07-08T08:36:09.073
> 
> 标签：java, eclipse, openjdk

我在安装了 OpenJDK 7 的 Ubuntu 12.04 上使用 Eclipse 3.7.2

java -version 给出

```
java version "1.6.0_24"
OpenJDK Runtime Environment (IcedTea6 1.11.1) (6b24-1.11.1-4ubuntu3)
OpenJDK 64-Bit Server VM (build 20.0-b12, mixed mode) 
```

每当我尝试运行一个项目时，我都会收到以下错误。

```
Exception in thread "main" java.lang.NoClassDefFoundError: test/Example
Caused by: java.lang.ClassNotFoundException: test.Example
    at java.net.URLClassLoader$1.run(URLClassLoader.java:217)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:205)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:321)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:294)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:266)
Could not find the main class: test.Example. Program will exit. 
```

我在 Windows 系统上成功编译的所有项目都会发生这种情况。而且，当直接从终端使用 javac 和 java 时，它可以工作。有简单的解决方案吗？这是因为 OpenJDK 吗？

类代码是：

```
package test;
import javax.swing.JFrame;
import javax.swing.SwingUtilities;

public class Example extends JFrame {

    /**
     * 
     */
    private static final long serialVersionUID = 1L;

    public Example() {
       setTitle("Simple example");
       setSize(300, 200);
       setLocationRelativeTo(null);
       setDefaultCloseOperation(EXIT_ON_CLOSE);
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                Example ex = new Example();
                ex.setVisible(true);
            }
        });
    }
} 
```

更新：我的源代码位于名为 swingtest 的文件夹中。在调试时，我发现 Eclipse 使用源的类路径作为 swingtest/swingtest/src/test/ 而不是 swingtest/src/test/ 。这可以纠正吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-07-15T19:57:28.427

由于以下原因，可能会发生此错误

1.  可能缺少依赖项/必需的 jar。要查找 jar 是否丢失，请单击顶部的 project->Java Build Path->source，您会看到一条错误消息 xyz.jar is missing。因此，通过单击添加外部 jars 选项添加特定的 jar

2.  可能是java类路径没有设置。因此，在 Eclipse 和环境设置中配置 JDK 类路径

3.  尝试清理项目并查看其是否已纠正

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-09T08:53:09.453

右键单击您的项目并选择构建路径 > 配置构建路径。单击源选项卡并选择添加文件夹。然后将其指向您的 swingtest 文件夹。您可以删除 Eclipse 正在使用的当前默认值

# eclipse - Eclipse 无法工作

> ID：11381799
> 
> 赞同：0
> 
> 时间：2012-07-08T08:37:42.737
> 
> 标签：eclipse, exit-code

> **可能重复：**
> [无法运行 Eclipse；JVM 终止。退出代码=13](https://stackoverflow.com/questions/4945178/cannot-run-eclipse-jvm-terminated-exit-code-13)

我刚刚下载了“面向 Java 开发人员的 Eclipse IDE”。解压缩和编辑 eclipse.ini 后，程序终止（退出代码 13）并向我显示以下错误消息：

![在此处输入图像描述](../Images/f98acda4688de1ac6b7ce8037321acef.png)

更多细节：

1.  我使用的是 Windows 7 64 位。
2.  下载 Eclipse IDE for Java Developers 64 bit for windows。
3.  安装java jdk 7.0.4（提前）
4.  为安卓安装了sdk。（提前）
5.  我按照有关编辑 eclipse.ini 并将路径添加到 javaw.exe 的说明进行操作
6.  这是我的eclipse.ini：

    ```
    -startup 
    plugins\org.eclipse.equinox.launcher_1.3.0.v20120522-1813.jar
    --launcher.library
    plugins\org.eclipse.equinox.launcher.win32.win32.x86_64_1.1.200.v20120522-1813
    -product
    org.eclipse.epp.package.java.product
    --launcher.defaultAction
    openFile
    --launcher.XXMaxPermSize
    256M
    -showsplash
    org.eclipse.platform
    --launcher.XXMaxPermSize
    256m
    --launcher.defaultAction
    openFile
    -vm
    C:\Program Files (x86)\Java\jdk1.7.0_04\bin\javaw.exe
    -vmargs 
    -Dosgi.requiredJavaVersion=1.5
    -Dhelp.lucene.tokenizer=standard
    -Xms40m
    -Xmx384m 
    ```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T10:44:08.857

如果您下载了 64 位的 Eclipse 包，那么您的 Java VM 必须是 64 位的（这与您的 Windows 位大小无关）。`Program Files (x86)`但是您使用该路径指向 32 位 JVM 。

请下载并安装 64 位 Java，然后在 eclipse.ini 中指向该位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T09:33:48.330

您是否尝试将 VM 路径包含在双引号中，例如：

```
-vm "C:\Program Files (x86)\Java\jdk1.7.0_04\bin\javaw.exe" 
```

然后你应该尝试用斜杠交换反斜杠：

```
-vm "C:/Program Files (x86)/Java/jdk1.7.0_04/bin/javaw.exe" 
```

`eclipse.ini`您可以为它定义一个启动快捷方式或批处理文件，而不是操作您的文件。内容可以是：

```
<path to eclipse>\eclipse.exe -vm "c:\Program Files (x86)\Java\jdk1.7.0_04\bin\javaw.exe" 
```

是的，您的 ini 文件是 64 位 eclipse 发行版之一...

# ruby-on-rails - 使用 Rspec 和 Capybara 建立一个新的 RoR 项目

> ID：11381801
> 
> 赞同：4
> 
> 时间：2012-07-08T08:37:55.270
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, rspec, capybara

我正在尝试按照[本教程](http://ruby.railstutorial.org/ruby-on-rails-tutorial-book)学习 RoR ，目前我在第 3 章。如果我逐行遵循，本教程可以正常工作。但是，本教程中使用的命令会抑制默认测试的生成。当我试图保留它们并可能在我的项目中使用它们时，我总是在某个地方碰壁。

你能告诉我我做错了什么吗？

```
$ rails new myproject
$ cd myproject/
$ echo "gem 'rspec'" >> Gemfile
$ echo "gem 'rspec-rails'" >> Gemfile
$ echo "gem 'capybara'" >> Gemfile
$ bundle install
$ bundle --binstubs
$ rails generate rspec:install
$ rails generate controller StaticPages home help about 
```

然后我编辑`spec/views/static_pages/home.html.erb_spec.rb`文件，以测试 capybara 是否有效：

```
require 'spec_helper'
#require 'capybara'
#require 'capybara/rails'
#require 'capybara/rspec'

describe "static_pages/home.html.erb" do
  it 'should have a right title' do
    visit '/static_pages/home'
    page.should have_selector('title', :text => 'Home')
  end
end 
```

显然，在这一点上运行`bin/rspec`以失败告终。好吧，失败是可以预料的。但是，其中一个失败的*原因*更令人担忧：

```
 1) static_pages/home.html.erb should have a right title
     Failure/Error: visit '/static_pages/home'
     NoMethodError:
       undefined method `visit' for #<RSpec::Core::ExampleGroup::Nested_5:0x00000003dfd268>
     # ./spec/views/static_pages/home.html.erb_spec.rb:7:in `block (2 levels) in <top (required)>' 
```

AFAIK 是 Capybara 的一部分的`visit`方法尚未被发现。取消注释三个额外的要求`home.html.erb_spec.rb`不会改变结果中的任何内容。

任何想法我做错了什么？还是我应该做的更好？

导轨版本：3.2.6

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T09:32:15.277

将您的测试放在`requests`目录而不是`views`.

# c++ - C++ Singleton 模板类继承

> ID：11381805
> 
> 赞同：5
> 
> 时间：2012-07-08T08:38:33.487
> 
> 标签：c++, templates, inheritance, singleton, friend

我有一个抽象的单例类。我的目标是任何子类只需要实现 init() 函数就可以了。这是我所做的：

```
template <typename T>
class Singleton
{
    public: 

        Singleton()
        {
            init();
        }

        static T& instance()
        {
            static T instance;
            return instance;
        }

    protected:
        virtual void init() = 0;   
};

class SubSingleton : public Singleton<SubSingleton>
{
    protected: 
        void init()
        {
            cout << "Init SubSingleton" << endl;
        }
}; 
```

这不会编译，因为 init() 受保护并且不能从公共静态函数调用。这个问题有2个解决方案。首先我们可以公开 init() 函数，但我不想公开这个函数。所以这只剩下第二种解决方案，改变子类如下：

```
class SubSingleton : public Singleton<SubSingleton>
{
    friend class Singleton<SubSingleton>;

    protected:

        void init()
        {
            cout << "Init SubSingleton" << endl;
        }
}; 
```

这完美地工作，但我不想要朋友声明，因为其他程序员可能会扩展我的代码并且可能不知道应该添加它。

如果没有朋友声明，还有其他方法可以实现吗？也许安德烈亚历山德雷斯库的任何东西？

**编辑：现在在构造函数中调用 init 函数而不是 instance() 函数。**

**EDIT2：出于技术原因和兼容性，我需要一个 init() 函数，不能只在构造函数中进行初始化。**

**转换的解决方案有效，但如果我从构造函数调用 init() ，则转换不再起作用。有什么建议么？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-08T10:49:03.147

你根本不需要这个 init() 东西。它只会在这里制造问题。

```
template <typename T>
class Singleton
{
    public: 
        static T& instance()
        {
            static T instance;
            return instance;
        }
};

class SubSingleton : public Singleton<SubSingleton>
{
    public: 
        SubSingleton()
        {
            cout << "Init SubSingleton" << endl;
        }
}; 
```

通过这种方式，您不仅可以删除不必要的东西 - 而且您还可以防止每次有人调用 instanse() 时调用 init()...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-08T09:37:43.463

问题是您没有使用您打算使用的虚拟功能。i,e 现在没有多态性在起作用。为什么？因为您在直接派生对象上调用 init() 。当您在基类引用或基类指针上调用 init() 时，init() 函数的使用是虚拟的，如下所示。然后调用发生在基类范围内，并且由于 instance() 方法是基类方法，因此调用受保护的方法非常好。

```
 static T& instance()
    {
        static T myInstance;
        Singleton<T>& t = myInstance;  // Just define a dummy reference here.
        t.init();
        return myInstance;
    } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-08T08:58:42.333

您似乎混合了两种类型的多态性：

1）如果你想`SubSingleton::init()`“静态”调用，即使用CRTP，你不需要在基类中定义它——但是你真的必须让它可以被基类访问。

2）但是如果你定义 init() 为 virtual，你使用动态多态，并且不需要`init()`公开：

```
static T& instance() 
{ 
  static T instance; 
  static_cast<Singleton<T> &>(instance).init(); 
  return instance; 
} 
```

# objective-c - 具有上下文的确定性随机数生成器？

> ID：11381807
> 
> 赞同：6
> 
> 时间：2012-07-08T08:38:43.400
> 
> 标签：objective-c, c, random, seed

我正在寻找一个种子随机数生成器，它创建一个数字池作为上下文。它不必太好。它用于游戏，但重要的是，游戏引擎的每个实例都有自己的数字池，因此不同的游戏实例甚至游戏的其他部分使用随机数不会破坏生成的数字。

目前我正在使用 rand() ，它显然没有这个功能。

是否有任何 c 或 Objective-c 生成器能够执行我想要的操作？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-08T08:46:24.887

用于[`srand`](http://linux.die.net/man/3/srand)设置种子，然后使用`rand()`：

```
unsigned int seed = 10;  /* Choose an arbitrary value for the seed */
int r;

srand(seed);             /* Set the seed                           */
r = rand();              /* Generate a random number               */ 
```

手册页明确指出伪随机数序列可以重复（因此它是确定性的）：

> *该*`srand()`*函数将其参数设置为要返回的新伪随机整数序列的种子*`rand()`*。**通过使用相同的种子值**调用这些序列是可重复的。*`srand()`

 ***编辑（澄清）：**
请注意，手册页声明`srand()`既不是可重入的，也不是线程安全的。
我假设*“不同的游戏实例*”是指*不同的进程*，在这种情况下可以使用它。
但是，如果您计划在同一过程中更改种子，您将无法获得所需的功能。在这种情况下，我建议`rand_r()`改用。看看[这个问题](https://stackoverflow.com/questions/3973665/how-do-i-use-rand-r-and-how-do-i-use-it-in-a-thread-safe-way)以供参考。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-08T08:51:37.573

看来您不需要“上下文”（无论这意味着什么）；相反，您正在寻找可以保存和恢复当前状态的 PRNG 实现。对于您自己实现的任何 PRNG 实现，这实际上是可能的（因为您始终可以保存状态），而库函数可能会或可能不会让您访问状态。

对于 Linux 和 MacOS，他们实际上在 rand 之外添加了一个 rand_r——这被记录为 rand 的线程安全、可重入版本，但其背后的“魔力”只是它需要一个指向当前状态的指针而不是保持它在一个静态变量中。像 drand48 系列这样的其他随机数函数似乎也有带有附加参数的版本，尽管我需要做更多的阅读来了解它是否可以用来存储状态。

无论哪种方式，如果您使用“google”或“wikipedia”来实现自己的随机数生成器，那么将“当前状态”设为显式参数将是微不足道的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-08T08:46:16.553

您也许可以使用`random()`和`setstate()`。我自己没用过`setstate()`，但手册页似乎表明它可能会做你想做的事……</p>

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-08T09:11:51.027

要使用的“明显”PRNG 是[`drand48()`](http://pubs.opengroup.org/onlinepubs/9699919799/functions/drand48.html)函数族。这些允许您提供 48 位状态，甚至允许您设置计算中使用的乘数和常数。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-07-08T09:29:49.770

任何好的[PRNG](http://en.wikipedia.org/wiki/PRNG)库都应该能够做到这一点。 [GNU 科学库](http://www.gnu.org/software/gsl/manual/html_node/Random-Number-Generation.html)支持通过许多不同的算法和从许多概率分布生成随机数。每次调用都会`gsl_rng_alloc`设置一个具有自己状态的独立随机数生成器，您可以使用`gsl_rng_set`. 您可能希望对程序的不同部分使用不同的种子，并且根据您使用的 PRNG 算法，某些特定的种子可能无法很好地工作。[从random.org](http://random.org)复制和粘贴一些数字可能是获取种子的好方法。*

# asp.net - 如何在前面显示文本并在后台使用图像？

> ID：11381809
> 
> 赞同：1
> 
> 时间：2012-07-08T08:39:09.820
> 
> 标签：asp.net, css, text, background-image

我想创建一个具有背景图像的 div 并希望在其上显示一些文本。我已经尝试过自己，但我不知道为什么它不适合我。我的代码如下：

```
<div style="background-image: image/test.jpg">
<asp:label id="test" runat="server" text="hello" />
</div> 
```

请让我知道我错在哪里。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T08:43:03.610

请参阅[https://developer.mozilla.org/en/CSS/background-image](https://developer.mozilla.org/en/CSS/background-image)。地址应包含在`url()`：

```
style="background-image: url(image/test.jpg)" 
```

同样令人感兴趣的可能是允许对放置、重复和填充颜色进行更多控制[的`background`属性。](https://developer.mozilla.org/en/CSS/background)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T08:44:42.207

样式有点不对，应该是：

```
style="background-image: url('image/test.jpg');" 
```

# haskell - Eta减少的理解

> ID：11381812
> 
> 赞同：4
> 
> 时间：2012-07-08T08:39:55.780
> 
> 标签：haskell, types, ghc, pointfree

在`weightDelta`函数上运行 hlint 时，会不断提示 Eta reduce。我阅读了另一个相关的 Eta reduce [question](https://stackoverflow.com/q/5793843/1403990)，但我似乎无法将理解转移到这个案例中。

```
module StackQuestion where

import qualified Data.Vector as V

type Weights = V.Vector Double
type LearningRate = Double

weightDelta :: LearningRate -> Double -> Double -> Weights -> Weights
weightDelta n r y ws = V.map update  ws
        where update w = diff * n * w
              diff = r - y 
```

我试图“减少”它以指向自由语法的每一次更改都会破坏它。要在哪里进行更改，是否有任何直觉或技巧可以避免将来出现 eta reduce 建议？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-08T08:56:00.863

你不会轻易得到*无*点语法，但你可以立即做的只是 η-reduce the `ws`away。

```
weightDelta :: LearningRate -> Double -> Double -> Weights -> Weights
weightDelta n r y = V.map update
        where update w = diff * n * w
              diff = r - y 
```

你也可以做类似的事情

```
 where update = (δ *)
              δ = n * (r - y) 
```

但这是相当有争议的。

# ios4 - ios4中的svg - 图像模式

> ID：11381815
> 
> 赞同：1
> 
> 时间：2012-07-08T08:40:55.337
> 
> 标签：ios4, svg

我正在生成一个 SVG 文件，应该在 iPhone 上查看。由于 iOS4 不正确支持 <SVG> 标签，我将整个 SVG 代码编码为 base64，并将其用作 <IMG> 标签的数据 URI。

在大多数情况下，这可以正常工作。

但是，在其中一个 SVG 中，我有一个图像模式：

```
<pattern id="noise" height="20" width="135"  patternTransform="translate(0, 0) scale(1, 1) rotate(0)" patternUnits="userSpaceOnUse">
    <image x="0" y="0" opacity="1" height="20" width="135" xlink:href=(image uri) />
</pattern> 
```

当包含它的 SVG 代码在 iOS4 上转换并显示为图像时，该图像被视为具有断开的链接。但是，在 iOS5 上，它可以正常工作。

为什么会这样？我该如何纠正？

# html - 在 WP7 中显示 HTML

> ID：11381817
> 
> 赞同：2
> 
> 时间：2012-07-08T08:41:35.250
> 
> 标签：html, silverlight, windows-phone-7, xaml

所以我一直在寻找一种在 WP7 中显示 HTML 的方法（将其绑定到 datacontext），这里的一个慷慨的家伙建议我使用 MPS Toolkit，它为 WP7 提供 HTMLViewer 和 HTMLTextBox 组件。所以我做到了，一开始它看起来很棒。html 完全按照我想要的方式显示，但对于某些页面，它会引发以下异常：在“段落”类型中找不到属性“边距”我已经坐了 2 天试图解决这个问题，但没有运气！我虽然是因为 xaml 中的某些属性，但我错了，这是该库不喜欢的 html 中的某些内容。有谁知道这个解决方案？或者可能是在 wp7（不是 webbrowser）中显示 html 的另一个建议。任何事情都会非常感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T21:41:03.010

使用 WebBrowser 有什么问题？您所需要的只是一个附加属性，该属性将能够使用您传递给它的内容调用 HTML 呈现方法 ( [NavigateToString )。](http://msdn.microsoft.com/en-us/library/system.windows.controls.webbrowser.navigatetostring%28v=vs.95%29.aspx)

# java - Java - 对定期清除的本地值存储的多线程访问

> ID：11381822
> 
> 赞同：2
> 
> 时间：2012-07-08T08:43:00.167
> 
> 标签：java, multithreading, datastore

我希望就如何最好地处理对价值存储的多线程访问提供一些建议或建议。

我的本地值存储旨在保存当前正在使用的对象。如果对象未在使用中，则将其从商店中移除。

一个值通过 thread1 泵入我的存储区，它进入存储区会向侦听器宣布，然后存储该值。进入 thread1 的值要么是全新的值，要么是对现有值的更新。

计时器用于定期从存储中删除当前未使用的任何值，因此该值的所有剩余部分都是由中介在本地保存的 ID。

现在，thread2 上的活动元素可能会唤醒并尝试通过传递它知道的一组值 ID 来访问一组值。有些值已经存储（很好），有些可能不会（悲伤）。那些尚未存储的值将从外部源检索。

我的主要问题是尚未存储且当前正在查询的项目可能会在查询完成之前到达 thread1。

我想尝试避免在进行查询时锁定对商店的访问，因为这可能需要一些时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T09:12:40.260

您似乎正在寻找某种缓存。您是否尝试调查现有的缓存实现，也许其中一些会这样做？

例如，Guava 缓存实现似乎满足了您的很多要求 - [http://code.google.com/p/guava-libraries/wiki/CachesExplained](http://code.google.com/p/guava-libraries/wiki/CachesExplained)。

# php - 使用 PDO::prepare() 和 PDOStatement::execute() 是单个查询的正确选项吗？

> ID：11381823
> 
> 赞同：1
> 
> 时间：2012-07-08T08:43:00.453
> 
> 标签：php, pdo

PHP手册指出以下内容：

> 调用 PDO::prepare() 和 PDOStatement::execute() 为将使用不同参数值多次发出的语句通过允许驱动程序协商查询计划的客户端和/或服务器端缓存来优化应用程序的性能和元信息，并通过消除手动引用参数的需要来帮助防止 SQL 注入攻击。

[PHP PDO::准备](http://www.php.net/manual/en/pdo.prepare.php)

对于单个页面查询 - 说：

```
$query = "SELECT id, content FROM pages WHERE id = :id LIMIT 1"; 
```

正在使用准备和执行，如：

```
$statement = $connection->prepare( $query );
$statement->execute( array( ":id" => 5 ) ); 
```

最好的方法是什么？我从手册中得到一种感觉，我应该只将 prepare() 用于将被绑定多次的查询。如果是这种情况，还有哪些其他选择？（手动调用报价，然后可能是 PDO::query()？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T11:23:26.747

我不能说仅对单个查询使用准备好的语句时是否有任何性能影响。

每个查询都经过解析、分析和优化。这也适用于`PDO:query()`(and `mysql_*`, `mysqli_*`, ...)。准备好的语句 - 简单地说 - 将解析、分析、优化和查询计划与执行查询分开。我的（可能是幼稚的）假设是，对于单个查询来说，唯一的开销准备好的 statmenets 是准备好的结果的缓存。

不过，使用一个 API 执行查询应该会超过轻微的性能损失。如果您要使用`PDO::query()`而不是`PDO::prepare()`单个查询，您将错过开箱即用的参数绑定和自动转义`prepare()`优惠。如果您忘记了`PDO::quote()`您的数据，这可能会打开一个新的蠕虫罐。

我只`PDO::query()`用于无法以合理方式准备的东西（例如“静态”查询，例如`SELECT foo FROM bar ORDER BY bla DESC LIMIT 1`和大量使用`IN()`等的查询）。

# php - html表单的javascript检查功能

> ID：11381832
> 
> 赞同：0
> 
> 时间：2012-07-08T08:44:58.753
> 
> 标签：php, jquery, html, forms, validation

我的 HTML 表单（姓名、电子邮件、主题、消息）有问题，我无法验证表单是否正确填写。我想在提交表单时调用 javascript 函数，并在字段未正确完成时发出警报。

我的问题是提交按钮，因为我的老板说我必须使用他自己的 php 函数来插入提交按钮。php函数看起来像：

```
function normal_button($text, $width, $param = '', $class = 'button-blue')
{
    $content = '<div class="'.$class.'" style="width:'.$width.'px;" '.$param.'>'.$text.'</div>';

    return $content;
} 
```

以及我如何调用该函数：

```
echo normal_button('Send it', '100', 'onclick="document.getElementById(\'emailForm\').submit();" '); 
```

我试图调用`onSubmit="return checkForm(this)"`在`<form action='email.php' method='post'>`HTML 表单中声明的​​ js 函数，但我无法“捕获”提交。我也试图用 jquery 来捕捉它，`$(document).ready(function() { $('.normal_button').click(function() { }); );`但如果一个字段没有正确完成，我就不能返回 false。

我必须使用他的 PHP 函数来插入提交按钮，但是我怎样才能“捕捉”这些字段，我怎样才能验证它们呢？有什么建议么？谢谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T09:10:35.843

首先，为该表单和 sbmit DIV 按钮设置 ID。

```
<form action='email.php' method='post' id='mailForm'> 
```

和

```
echo normal_button('Send it', '100', 'id="mailFormSubmit"'); 
```

然后用 jQuery 检查：

```
$('#mailFormSubmit').click(function(){
    // fields check code goes here

....

    // if all fields are OK, then submit form
    $('#mailForm').submit();
}); 
```

# asp.net-mvc - 学习在MVC中实现DIC

> ID：11381835
> 
> 赞同：0
> 
> 时间：2012-07-08T08:45:29.400
> 
> 标签：asp.net-mvc, model-view-controller, dependency-injection

我正在学习将 DIC 应用于 MVC 项目。所以，我已经根据我的最佳理解勾勒了这个 DDD-ish DIC-ready-ish 布局。在过去的几天里，我阅读了许多博客文章 wiki。但是，我对正确实施它没有信心。您能否向我演示如何以正确的方式将它们放入 DIC 中？在阅读完所有资料后，我更喜欢 Ninject 或 Windsor，但只要我能正确理解如何操作，anyDIC 就可以。

网页控制器...

```
public class AccountBriefingController {
    //create
    private IAccountServices accountServices { get; set; }
    public AccountBriefingController(IAccountServices accsrv)
        accountServices = accsrv;
    }   
    //do work
    public ActionResult AccountBriefing(string userid, int days) {
        //get days of transaction records for this user
        BriefingViewModel model = AccountServices.GetBriefing(userid, days);
        return View(model);
    }
} 
```

查看模型...

```
public class BriefingViewModel {
    //from user repository
    public string UserId { get; set; }
    public string AccountNumber {get; set;}
    public string FirstName { get; set; }
    public string LastName { get; set; } 
    //from account repository
    public string Credits { get; set; } 
    public List<string> Transactions { get; set; }
} 
```

服务层...

```
public interface IAccountServices {
    BriefingViewModel GetBriefing();
}

public class AccountServices {
    //create
    private IUserRepository userRepo {get; set;}
    private IAccountRepository accRepo {get; set;}
    public AccountServices(UserRepository ur, AccountRepository ar) {
        userRepo = ur;
        accRepo = ar;
    }
    //do work
    public BriefingViewModel GetBriefing(string userid, int days) {
        var model = new BriefingViewModel(); //<---is that okay to new a model here??
        var user = userRepo.GetUser(userid);
        if(user != null) {
            model.UserId = userid;
            model.AccountNumber = user.AccountNumber;
            model.FirstName = user.FirstName;
            model.LastName = user.LastName;
            //account records
            model.Credits = accRepo.GetUserCredits(userid); 
            model.Transactions = accRepo.GetUserTransactions(userid, days);
        }
        return model;
    }
} 
```

领域层和数据模型...

```
public interface IUserRepository {
    UserDataModel GetUser(userid);
}
public interface IAccountRepository {
    List<string> GetUserTransactions(userid, days);
    int GetUserCredits(userid);
}
// Entity Framework DBContext goes under here 
```

请指出我的实现是否错误，例如我可以在 AccountServices->GetBriefing -> new BriefingViewModel() 中感觉到对我来说似乎是错误的，但我不知道如何将螺柱放入 DIC？

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T21:31:38.487

我想这里有2个问题。首先，如何使用 Ninject 或 Windsor 设置客户依赖关系解析器。其次，依赖关系是否被正确建模。

我将向您指出第一个问题的几个链接，因为它在 SO 和博客文章中得到了很好的回答：

[忍者](https://stackoverflow.com/questions/4140860/castle-windsor-dependency-resolver-for-mvc-3)

[温莎](https://gist.github.com/2044349)

关于第二个问题，恕我直言，我认为没有`IAccountServices`必要了解视图模型。我喜欢将我的依赖*项保持*在一个方向上。因此，`AccountBriefingController`将 a `User`（或名为 的新模型对象`Briefing`）转换为`BriefingViewModel`. 这解决了是否更新 a 的问题`BriefingViewModel`。但是，您必须将 a 映射`User`到`BriefingViewModel`控制器中的 a （这将需要您创建一个新实例）。否则，对我来说，依赖项看起来不错。

所以我会改变`GetBriefing`这个：

```
public User GetBriefing(string userid, int days) {
        var user = userRepo.GetUser(userid);
        if(user != null) {
            return user;
        }
        throw new CustomException();  //if this makes sense
    } 
```

然后，您将在控制器中进行映射。

# java - 使用子字符串向后显示字符串

> ID：11381838
> 
> 赞同：0
> 
> 时间：2012-07-08T08:45:44.283
> 
> 标签：java, substring

我这里有一个向后显示字符串的方法。

```
public static String ReverseStr(String backward) {
       String newString = "";
       for (int i=0; i<backward.length(); i++) {
          newString = backward.charAt(i) + newString;
       }
       return newString;
} 
```

它可以正常工作，但我想以另一种方式进行，即使用 `for` 循环，使用带有两个参数的方法获取字符串中的每个字符 `substring` ，从最后一个字符开始，然后将该单字符子字符串与新字符串连接起来每次通过循环。

我试过这个：

```
public static String ReverseStr(String backward) {
       String newString = "";
       for (int i=0; i>backward.length(); i--) {
          String subChar = backward.substring(backward.length()-1);
          newString += subChar;
       }
       return newString;
} 
```

但是当我运行程序时，它什么也没有显示。请帮我修复代码。非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T08:48:21.390

如果这不是作业，请使用 StringBuilder 类和 reverse() 方法。

[http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/StringBuilder.html#reverse](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/StringBuilder.html#reverse) ()

如果这是一个家庭作业，请自己做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-08T08:48:46.477

由于错误的控制条件，循环永远不会执行：

```
for (int i=0; i>backward.length(); i--) 
```

它从大于开始`0`并一直持续到`i`大于`length`（这永远不会像`length`至少一样`0`）。你*可能*的意思是：

```
for (int i=backward.length(); i>=0; i--) 
```

一旦你设法修复你的代码，考虑使用`StringBuilder`而不是连接到`String`. 一旦你设法使用[`StringBuilder`](http://docs.oracle.com/javase/7/docs/api/java/lang/StringBuilder.html)，你会发现方便的[`reverse()`](http://docs.oracle.com/javase/7/docs/api/java/lang/StringBuilder.html#reverse%28%29)方法：

```
return new StringBuilder(backward).reverse().toString(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-09-09T03:51:39.380

```
class Test
{
    public static void main(String[] args)
    {
        String strtorev = "Test Code";
        String newString = "";
        int len = strtorev.length();
        System.out.println(len);
        for(int i =0;i<len;i++)
        {
            String subChar = strtorev.substring(strtorev.length()-1-i,strtorev.length()-i);
            newString += subChar;
            System.out.println(newString);
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-08T08:50:04.497

你的 for 循环搞砸了，它永远不会运行，因为你有错误的条件，将其更改为：

```
 for (int i=backward.length(); i>=0; i--) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-08T09:07:36.527

你应该`StringBuilder`。以下代码应该可以按预期工作。

```
public static String ReverseStr(String backward)
{
   String newString = "";
   StringBuilder sb=new StringBuilder(backward);
   for (int i=0; i>backward.length(); i--) //backward.length() may be replaced with sb.length()
   {
      String subChar = sb.charAt(i); //Replace `substring()` with `charAt()`
      newString += subChar;
   }
   return newString;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-06-08T22:10:27.500

```
public static String ReverseStr(String backward) {

       String newString = "";

       for (int i=backward.length()-1; i>=0; i--) 
          newString+ = backward.charAt(i);

       return newString;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-09-13T11:04:03.703

我们可以使用递归来反转字符串

```
public class ReverseStringTest {
    public static String reverseString(String str) {
        if (str.isEmpty()) {
            return str;
        } 
        //Calling Function Recursively
        return reverseString(str.substring(1)) + str.charAt(0);
    }

    public static void main(String[] args) {
        System.out.println(reverseString("java"));
    }
} 
```

# android - 我可以让应用程序始终在 Android 上打开吗？

> ID：11381839
> 
> 赞同：0
> 
> 时间：2012-07-08T08:45:50.163
> 
> 标签：android

我对 Android 多任务处理了解不多，但我想我会在尝试我的项目之前问这个问题。

有没有一种方法可以让 Android 应用程序（仅针对 Android 4.0+）始终在后台打开并保持所有网络连接处于活动状态并“绘制”UI，这样当我打开它时，它总是会立即打开并且即使平板电脑正在做其他事情，我也可以立即使用它？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T08:52:14.777

最有可能的是，您想创建一个[前台服务](http://developer.android.com/guide/components/services.html#Foreground)。前台服务是用户知道的服务，如果 Android 内存不足，则不会将其视为终止的候选者。它与持久通知栏相关联，用户可以点击该通知栏以将活动置于前台。为确保网络连接未关闭，您的服务应获取[唤醒锁](http://developer.android.com/reference/android/os/PowerManager.WakeLock.html)。

但是，请记住，可能会耗尽电池的长时间运行过程被认为是一种不好的做法，除非您有非常充分的理由这样做，否则您应该避免这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T08:52:29.597

不，Android 不是那样构建的。当操作系统需要更多资源时，它总是可以在后台终止服务/活动。

您可以使始终运行的服务（粘性服务）在由于资源问题而被终止时重新启动，当有资源再次可用时。使用 Activies，您无法做到这一点。但是您的活动可能会“暂停”并仍在后台，因此可以很快“恢复”。但同样，Android 可以很容易地杀死它以获取资源。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T08:52:37.293

除非您在固件级别修改 Android 并构建自己的版本，否则您无法让应用程序*始终在后台运行。*当 Android 需要更多资源来运行当前在前台的应用程序时，它会杀死其他应用程序。

[但是，可以通过在onPause()中保存数据及其当前状态并在](http://developer.android.com/reference/android/app/Activity.html#onPause%28%29)[onResume()](http://developer.android.com/reference/android/app/Activity.html#onResume%28%29)中恢复相同状态来使您的应用程序更好地处理此问题。

# php - 如何使用 PHP 从 blob oracle 下载 PDF 文件？

> ID：11381846
> 
> 赞同：0
> 
> 时间：2012-07-08T08:47:55.793
> 
> 标签：php, oracle

我想从 oracle 下载 blob 文件，即 PDF 文件，这是我获取和下载文件的代码：

```
<?php
$conn = ocilogon('user', 'pass', '//localhost/XE');
$sql = "SELECT PDFFILE FROM TFILE";
    $stid = ociparse($conn,$sql);
    ociexecute($stid);
    $rowResult = ocifetch($stid);
    settype($arrayResult,"array");
if($rowResult != null){
            header("Content-Type: application/octet-stream");
            header('Content-Disposition: attachment; filename="' . OCIResult($stid,'PDFFILE') . '"');    
            header("Content-Length: " . filesize(OCIResult($stid,'PDFFILE')->load()));
            header('Content-Disposition: attachment; header("Content-Transfer-Encoding: binary\n");
    }
    ?> 
```

但是当我运行这段代码时，我没有得到 pdf 文件。我的代码有问题吗？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T10:37:38.347

```
header("Content-Type: application/octet-stream");
header('Content-Disposition: attachment; filename="' . OCIResult($stid,'PDFFILE') . '"');    
header("Content-Length: " . filesize(OCIResult($stid,'PDFFILE')->load()));
header('Content-Disposition: attachment; header("Content-Transfer-Encoding: binary\n"); 
```

您要发送`Content-Disposition`标头两次。您甚至可能不需要第二个，客户端应该知道它需要知道的关于来自`Content-Type`标头的流的所有信息。省略第二个`Content-Disposition`，这样您就不会覆盖具有文件名的标题。

# html - 浏览器地理位置：确定以前的权限

> ID：11381855
> 
> 赞同：0
> 
> 时间：2012-07-08T08:49:27.763
> 
> 标签：html, browser, geolocation, w3c-geolocation

好的，所以我有如下代码：

```
navigator.geolocation.getCurrentPosition (
    function (e) {
        alert('ok');
    }, function (e) {
        alert('denied');
    } 
); 
```

我可以在页面加载时调用它，如果权限被拒绝，我将隐藏依赖于 geoloc 信息的按钮和功能。

但是，我不想在页面加载时请求权限，而只是在用户选择单击 geoloc 按钮之一时按需请求。

因此，在这种情况下，假设用户到达我的页面，之前决定拒绝访问地理定位 API，是否可以判断权限之前已被拒绝，以便我可以隐藏按钮而不必等到他们再次单击其中一个按钮？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T08:54:14.500

您的意思是拒绝访问另一个网站，还是以前访问您的网站？

如果是前者，为什么要假设您受制于该决定？也就是说，不要担心，无论如何再问一次。

如果是后者，您可能应该在您的站点上存储用户会话期间的决定。如果您使用服务器会话或使用简单的 cookie，则可以在服务器端执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T09:03:11.963

您可以将结果存储在浏览器中，例如使用 LocalStorage 或 cookie。但是，如果用户第一次拒绝访问并不意味着他下次会这样做。但是，如果您隐藏或禁用按钮，即使他愿意，他也无法使用该功能。现在，如果他连续否认 10 次，或者类似的次数，那就更有意义了。

# qt4 - 如何像这样在 QLineEdit 中制作一个额外的图标？

> ID：11381865
> 
> 赞同：2
> 
> 时间：2012-07-08T08:51:37.600
> 
> 标签：qt4

我想在 Qt Creator 中实现一个“干净”按钮，如下图所示，该按钮位于 QLineEdit 中，而不是单个小部件

![在此处输入图像描述](../Images/3b17d8743514b67a6755423afbd660e1.png)

我应该从哪里开始？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-09T08:41:18.930

请参阅此博客条目以获取建议的解决方案： [Lineedit with a clear button](https://web.archive.org/web/20130730091726/http://blog.qt.digia.com:80/blog/2007/06/06/lineedit-with-a-clear-button/)。

* * *

主要思想是添加 a`QToolButton`并`QLineEdit`正确定位它。

```
LineEdit::LineEdit(QWidget *parent)
    : QLineEdit(parent)
{
    int height = sizeHint().height();
    int btnSize = sizeHint().height() - 5;

    clearButton = new QToolButton(this);
    QPixmap pixmap(":clear.png");
    clearButton->setIcon(QIcon(pixmap));
    clearButton->setCursor(Qt::ArrowCursor);
    clearButton->setStyleSheet("QToolButton { border: none; padding: 2px}");
    clearButton->setFixedSize(btnSize, btnSize);
    clearButton->hide();

    int frameWidth = style()->pixelMetric(QStyle::PM_DefaultFrameWidth);
    setStyleSheet(QString("QLineEdit { padding-right: %1px }")
                                                .arg(btnSize - frameWidth));
    setMinimumHeight(height);

    connect(clearButton, SIGNAL(clicked()), this, SLOT(clear()));
    connect(this, SIGNAL(textChanged(const QString&)), 
            this, SLOT(updateCloseButton(const QString&)));
}

void LineEdit::resizeEvent(QResizeEvent *)
{
    int frameWidth = style()->pixelMetric(QStyle::PM_DefaultFrameWidth);
    clearButton->move(width() - clearButton->width() - frameWidth, 0);
}

void LineEdit::updateCloseButton(const QString& text)
{
    clearButton->setVisible(!text.isEmpty());
} 
```

此外，从 Qt 5.2 开始，可以使用`QLineEdit`内置方法[`setClearButtonEnabled`](https://doc.qt.io/qt-5/qlineedit.html#clearButtonEnabled-prop)。

# opengl - VBO 不使用 UV 坐标

> ID：11381867
> 
> 赞同：0
> 
> 时间：2012-07-08T08:51:42.000
> 
> 标签：opengl, opengl-es-2.0

我的渲染方法目前看起来像这样：

```
void Renderer::render() {
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
    checkGlError("glClear");

    EntityCamera* camera = (EntityCamera*) resourceManager_->getResource(GHOST_CAMERA);

    mat4 proj;
    Matrix::projection3D(proj, 45.0f,
            (float) nScreenWidth_ / nScreenHeight_, GHOST_NEAR_DISTANCE, GHOST_FAR_DISTANCE);

    mat4 view;
    Matrix::multiply(proj, camera_->getMatrix(), view);
    camera->extractPlanes(view);

    for (vector<Node*>::const_iterator it = renderArray_.begin(); it != renderArray_.end();
            it++) {
        Node* node = *it;
        if (!node->isRenderable()) {
            continue;
        }
        if (node->hasBV() && node->getBV()->isInFrustum(camera, node) == BoundingVolume::OUTSIDE) {
            LOGI("Node %s is outside :O", node->getName().c_str());
            continue;
        }
        EntityModel* entity =
                static_cast<EntityModel*>(resourceManager_->getResource(
                        (*it)->getEntity()));
        if (entity == 0 || entity->getVertices() == 0 || entity->getVertices()->size() == 0) {
            LOGI("Empty entity %s.", node->getName().c_str());
            continue;
        }
        Resource* resource = resourceManager_->getResource(node->getShader());
        Shader* shader = static_cast<Shader*>(resource);
        Resource* resource2 = resourceManager_->getResource(entity->getTexture());
        Image* image = static_cast<Image*>(resource2);
        mat4 res;
        Matrix::multiply(view, node->getMatrix(), res);

        // Select shader program to use.
        glUseProgram(shader->getId());
        checkGlError("glUseProgram");

        int matrix = glGetUniformLocation(shader->getId(), "uWVP");
        int texture = glGetUniformLocation(shader->getId(), "texture_0");
        checkGlError("glGetUniformLocation");
        int textureCoords = glGetAttribLocation(shader->getId(), "attrTexCoords");
        int vertices = glGetAttribLocation(shader->getId(), "attrPos");
        checkGlError("glGetAttribLocation");

        // Specify WVP matrix.
        glUniformMatrix4fv(matrix, 1, false, res);
        checkGlError("glUniformMatrix4fv");

        // Load vertex positions.
        if (!entity->isCompiled()) {
            //LOGI("Entity %s, not compiled.", entity->getName().c_str());
            continue;
        }
        glEnableVertexAttribArray(vertices);
        checkGlError("glEnableVertexAttribArray");
        //glVertexAttribPointer(vertices, 3, GL_FLOAT, GL_FALSE, 0,
        //      &(*entity->getVertices())[0]);
        //LOGI("%s vbo id: %d", node->getName().c_str(), entity->getVBO());
        glBindBuffer(GL_ARRAY_BUFFER, entity->getVBO());
        checkGlError("glBindBuffer");
        glVertexAttribPointer(vertices, 3, GL_FLOAT, GL_FALSE, 0, 0);
        checkGlError("glVertexAttribPointer");
        // Load UV coordinates.
        glEnableVertexAttribArray(textureCoords);
        checkGlError("glEnableVertexAttribArray");
        glVertexAttribPointer(textureCoords, 2, GL_FLOAT, GL_FALSE, 0,
                &(*entity->getTextureCoords())[0]);
        checkGlError("glVertexAttribPointer");

        // Bind the texture.
        glActiveTexture(GL_TEXTURE0);
        checkGlError("glActiveTexture");
        glBindTexture(GL_TEXTURE_2D, image->getId());
        checkGlError("glBindTexture");
        glUniform1i(texture, 0);
        checkGlError("glUniform1i");

        if (entity->hasIndices()) {
            vector<vector<GLushort>*>* indices = entity->getIndices();
            for (unsigned int i = 0; i < indices->size(); i++) {
                if (entity->hasBoundingVolumes()) {
                    BoundingVolume* volume = (*entity->getBoundingVolumes())[i];
                    if (volume->isInFrustum(camera, node) == BoundingVolume::OUTSIDE) {
                        continue;
                    }
                }
                vector<GLushort>* ind = (*indices)[i];
                glDrawElements(GL_TRIANGLES, ind->size(), GL_UNSIGNED_SHORT, &(*ind)[0]);
                checkGlError("glDrawElements");
            }
        }
        else {
            glDrawArrays(GL_TRIANGLES, 0, entity->getVertices()->size() / 3);
            checkGlError("glDrawArrays");
        }
        glBindBuffer(GL_ARRAY_BUFFER, 0);
        checkGlError("glBindBuffer");
    }
} 
```

* * *

我最近刚尝试使用 VBO，在我直接发送顶点数据并且一切正常之前，纹理被正确映射。现在我用 VBO 更改了顶点数组，即使它有效，也没有应用纹理，我只能看到黑色物体。

* * *

1.  我的纹理可能有什么问题？
2.  为什么当我更改 glVertexAttribPointer(vertices, 3, GL_FLOAT, GL_FALSE, 0, 0); glBindBuffer(GL_ARRAY_BUFFER, entity->getVBO()) 的行序；我得到毁容的物体？这是我使用的正确呼叫顺序吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T10:06:42.010

您正在从普通内存发送您的 UV 坐标，而您似乎从 VBO 发送您的顶点坐标。这可能效率不高，您应该在 VBO 中拥有两个数据集以利用 VBO 的优势。

话虽如此，我认为您的问题是您在发送 UV 坐标之前没有取消绑定 VBO。您的代码应该是：

```
glBindBuffer(GL_ARRAY_BUFFER, 0);
glVertexAttribPointer(textureCoords, 2, GL_FLOAT, GL_FALSE, 0,
            &(*entity->getTextureCoords())[0]); 
```

因为我想你`getTextureCoords()`不会在你的 VBO 中返回偏移量。

# spring - 我写的 TestNG 测试不是最新的

> ID：11381868
> 
> 赞同：0
> 
> 时间：2012-07-08T08:51:55.887
> 
> 标签：spring, hibernate, maven, testng

我在我的网络项目中使用 Spring、Hibernate 和 Maven。我使用 TestNG 来测试我们的项目。有一个问题：当我想测试一个测试文件时，我在编辑面板中右键单击，然后运行 ​​as->testng 测试，然后 TestNG 自动在当前编辑面板中运行这个测试类。但是我发现这不是我写的最新代码。

如何和为什么？

其他人以前遇到过这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T06:20:50.933

看这里：[我做项目时没有编译TestNG测试用例->清理](https://stackoverflow.com/questions/7399404/testng-test-cases-are-not-compiling-when-i-do-project-clean?rq=1)

有同样的问题，它是测试类的输出文件夹。默认情况下它是测试类，但我将其更改为类，因为 Jetty 似乎有问题并且在启动时排除了那些但我正在启动它来测试应用程序。

无论如何，将其更改回测试类并再次运行 As works，要解决 Jetty 问题，您必须取消选中测试类路径，运行 jetty（取决于您的场景会失败），停止 Jetty，检查测试类路径，现在一切应该按预期工作。

# ruby-on-rails - 一个类似 Ruby On Rails 的迁移工具

> ID：11381871
> 
> 赞同：0
> 
> 时间：2012-07-08T08:52:17.837
> 
> 标签：ruby-on-rails, database-migration

我喜欢 Ruby On Rails 允许您编写一个简单的模式，您可以在其中创建和更新数据库。有没有像 Ruby On Rails 的迁移这样的工具，因为我想在不使用 Ruby On Rails 的情况下使用该方法进行网站开发？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T09:04:03.997

没有理由不能在 Rails 应用程序之外使用[ActiveRecord::Migration 。](http://api.rubyonrails.org/classes/ActiveRecord/Migration.html)事实上，你会发现很多人这样做的例子，如[http://exposinggotchas.blogspot.com/2011/02/activerecord-migrations-without-rails.html](http://exposinggotchas.blogspot.com/2011/02/activerecord-migrations-without-rails.html)

如果您使用 mongo 作为持久存储，请查看[mongrations](https://github.com/terrbear/mongrations)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-08T09:19:32.923

本周我在一个小型会议上听到了一个关于名为[Liquibase](http://www.liquibase.org/)的工具的讨论，这是一种数据库更改管理工具。它基于 Java（我认为），但在 XML 文件中管理数据库迁移。您必须编写的更改集类似于您可以使用 Rails 编写的迁移。如果您在 Eclipse 等 IDE 中使用 Liquibase，您将完成更改集的所有相关部分。它支持很多开箱即用的数据库，因此它可能是一种替代方案，尤其是现在 Java 无处不在。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-11T08:01:13.707

我推荐 Python [Alembic](http://alembic.readthedocs.org/en/latest/)。虽然它不是红宝石。

# url - 是否有任何被广泛接受的语法用于在 url 中写入帖子数据？

> ID：11381880
> 
> 赞同：0
> 
> 时间：2012-07-08T08:53:19.570
> 
> 标签：url, post

您可以使用 get 给某人一个 url：

```
http://myserver.com/?var=val 
```

但是 POST 方法怎么办？我知道我放入 url 的程序必须支持这一点，我不知道任何浏览器可以（可能有插件），但是有被广泛接受的语法来做到这一点，例如我想出了这个：

```
http://myserver.com/<var=val> 
```

或许：

```
http://myserver.com/??var=val
http://myserver.com/?!var=val
http://myserver.com/!!var=val
http://myserver.com/!var=val 
```

等等......我正在编写一个工具来做这件事，我想知道我是否必须像第一个创建电子邮件的人一样独立思考，然后凭空构思`@`角色，因为那时它很少使用......

这个想法是一些服务使用发布数据，并且没有办法向某人发送链接到那里的资源。是的，我知道，当有发布数据时，该资源并不意味着对人们来说如此容易通过……但是请等一下，因为网站的作者必须对我可以使用他的服务做什么和不可以做什么拥有权力。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T08:57:46.617

您最好引入一个单独的参数来将 POST 数据传递给您的工具。将它与 URL 混合在一起只会引起用户的混淆。请记住，POST 数据非常大，因此您最终会引入诸如从文件加载 POST 数据（或单个变量的值）之类的功能。

# xcode - Xcode 无法识别我从另一个项目中添加的文件夹

> ID：11381881
> 
> 赞同：1
> 
> 时间：2012-07-08T08:53:38.740
> 
> 标签：xcode, file-management

当我从另一个项目中添加一个新文件夹到我的 Xcode 项目（其中有许多子文件夹和类）时，它会创建一个**灰色**的文件夹，而不是**黄色**的文件夹作为我项目的其余文件夹。

然后，当我尝试从项目中的另一个类`#import class.h`到此文件夹中的类时，我收到一条错误消息，提示 Xcode 在项目中看不到它。

> 找不到类名文件

我已经使用“将文件添加到项目名称”添加了该文件夹。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T20:52:55.170

灰色文件夹是对磁盘上文件夹的引用，而黄色文件夹是代表项目中文件集合的组。对于大多数源代码，您需要使用黄色的那种。为此，当您将文件添加到项目时，请确保您使用`Create groups for any added folders`的是`Create folder references for any added folders`.

# android - 从另一个布局访问视图

> ID：11381885
> 
> 赞同：1
> 
> 时间：2012-07-08T08:54:22.720
> 
> 标签：android, xml, layout

我正在使用带有自定义列表项（包括按钮）的 ListView。我有一个自定义适配器，在其中我将按钮的 OnClickListener 设置为内部类（在适配器类中定义）。

我想访问显示列表视图的类中的按钮（在与 ListAcitivty 类不同的 xml 文件中定义）。我想在这个类中设置它的 onClickListener 方法。这样做的最佳方法是什么？

编辑：这是我的 list_item.xml （我用于我的 ListView 行）。

```
 <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content" >

<ImageView
    android:id="@+id/imageView"
    android:layout_width="22dp"
    android:layout_height="wrap_content"
    android:layout_marginLeft="4dp"
    android:layout_marginRight="10dp"
    android:layout_marginTop="4dp"
    android:contentDescription="Color"
    android:src="@drawable/ic_launcher" >
</ImageView>

<EditText
    android:id="@+id/nameEdit"
    android:layout_width="250dp"
    android:layout_height="wrap_content"
    android:textSize="20dp" 
    android:inputType="textPersonName"
    >
</EditText>

<Button
    android:id="@+id/deleleButton"
    android:layout_width="wrap_content"
    android:layout_height="match_parent"
    android:background="@drawable/delete_button" >

</Button>

</LinearLayout> 
```

如何访问扩展 ListActivity 的类中的按钮 (id:deleteButton)？扩展 listactivity 的类有一个单独的布局（比如说 main.xml）。如果我在扩展 listactivity 的类中执行 setContentView(main)，findViewById(R.id.deleteButton) 将返回 null。

编辑 2：这是我扩展 ListActivity 的类。如果我将 findViewById(R.id.deleteButton) 放在 setContentView 之后，它会返回 null。

```
public class PlayerSelection extends ListActivity {
    ListView list;
    ArrayList<PlayerField> textviews = null;
    PlayerFieldsAdapter adapter = null;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.player_selection_page);
        list = getListView();

        textviews = new ArrayList<PlayerField>();
        for (int i = 0; i< GlobalVariables.getPlayers(); i++) {
            textviews.add(i, new PlayerField());
        }
        adapter = new PlayerFieldsAdapter(this, R.layout.list_item, textviews); 

    ViewGroup header = (ViewGroup) getLayoutInflater().inflate(R.layout.list_header, null);
    Button backButton = null;
    for (int i = 0; i < header.getChildCount(); i++) {
        View v = header.getChildAt(i);
        if (v instanceof Button) {
            backButton = (Button) v;
            break;
        }
    }
    backButton.setOnClickListener(new OnClickListener() {
            public void onClick(View v) {
                Intent optionsIntent = new Intent(PlayerSelection.this, OptionsScreen.class);
                startActivity(optionsIntent);
            }
        });
    list.addHeaderView(header);
        list.setAdapter(adapter);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T09:36:38.720

实现这一点的简单方法是在您的`CustomAdapter`类中创建一个字段：

```
private OnClickListener listener; 
```

然后为这个字段指定一个 setter 方法。下一步将是在您的`Activity`类中指定此侦听器，如下所示：

```
CustomAdapter adapter = (CustomAdapter) getListView().getAdapter();
adapter.setListener(<your implementation of the listener>); 
```

然后在您`CustomAdapter`的`getView()`方法中，将此侦听器设置为您的按钮：

```
Button btn = (Button) convertView.findViewById(R.id.btn);
btn.setOnClickListener(listener); 
```

希望这可以帮助。

# javascript - identity.loginName 打印在 pdf 文件上

> ID：11381886
> 
> 赞同：0
> 
> 时间：2012-07-08T08:54:41.133
> 
> 标签：javascript, pdf

大家好，我有adobe acrobat 8​​.0 v。我试图通过使用javascript代码在页面上显示“用户名和登录名”打印的行我正在尝试这个代码

```
name = identity.name;    userName = identity.loginName;
name.value = util.printd();
userName.value = util.printd(); 
```

我该怎么做才能在 pdf 文件上显示详细信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T09:24:23.030

`printd`格式化日期，它不会向页面写入任何内容。

我不相信您实际上可以使用 Acrobat 脚本将文本输出到文档中。您可以通过向文档添加表单字段并向其写入值来做您想做的事情：

```
getField('someField').value= 'Printed by '+identity.name+' ('+identity.loginName+')'; 
```

# facebook - 如何将 ms 中的时间转换为 yyyy-MM-dd'T'HH:mm:ss.SSS'Z' 格式？

> ID：11381887
> 
> 赞同：2
> 
> 时间：2012-07-08T08:54:52.267
> 
> 标签：facebook, lua, saas, coronasdk

我使用与 Facebook 交互的 Corona SDK 编写移动应用程序。

在用户的 Facebook 登录时，我在 ms 中从 Facebook 收到“访问令牌过期”。我想以 yyyy-MM-dd'T'HH:mm:ss.SSS'Z' 日期格式将其发送到 Parse.com (SAAS)。

我该怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-08T18:15:19.527

```
date = os.date("!%Y-%m-%dT%H:%m:%S.000Z") 
```

您必须将毫秒数保留为 0，因为您无法从`os.date`. 还需要`!`at start 来获取 UTC 时间（而不是本地时间），这就是`Z`at 结尾的含义。

[更多信息。](http://www.lua.org/pil/22.1.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T10:54:06.610

适合日期操作的 LuaDate 库 [http://luaforge.net/projects/date/](http://luaforge.net/projects/date/)

它非常易于使用，并且有很好的文档记录！你可以从这里下载它 [http://files.luaforge.net/releases/date/date](http://files.luaforge.net/releases/date/date)

可能还有其他更简单的方法。

# sqlite - SQLite比较2列并修改同一行？

> ID：11381889
> 
> 赞同：0
> 
> 时间：2012-07-08T08:55:03.583
> 
> 标签：sqlite, if-statement, row

我有带有电话列和地址列的地址簿表的 sqlite db。我想搜索以 abc 结尾的任何地址，然后查看同一行的电话长度是否为 = 数字，然后在数字的开头插入另一个数字：

给出 IDEA 的示例代码：

```
SELECT * FROM addressbook
WHERE address like '%abc' AND phone.lengh=5
THEN replace phone by 43.phone(i mean here the old value phone use to have.) 
```

在这种情况下，我想像这样修改这一行：与第二个示例无关，因为我要查找的字符更多。

电话 4322174 安南 abc

请帮助...亲切的问候...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T09:08:03.493

那应该做的伎俩

```
UPDATE addressbook SET phone = '43'+phone WHERE address like '%abc' AND length(phone)=5 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T09:08:34.193

你最有可能在寻找这样的东西：

```
UPDATE addressbook SET phone = '43' + phone WHERE address LIKE '%abc' AND length(phone) = 5; 
```

# github - 如何在 GitHub 的 Issues 2.0 Tracker 中模拟投票

> ID：11381893
> 
> 赞同：19
> 
> 时间：2012-07-08T08:55:51.703
> 
> 标签：github, issue-tracking

我正在考虑将我的开源项目[Flyway](http://flywaydb.org)从 Google Code 转移到 GitHub。

我真正喜欢 Google Code 的问题跟踪器的功能之一是**能够按投票数对问题进行投票**和**排序**。这让我能够很好地了解当前的痛点在哪里以及社区认为需要关注或进一步工作的地方。

如何在 GitHub 上实现类似的目标？有没有办法保持问题跟踪的民主方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-08T11:01:49.060

没有内置的功能可以这样做。从技术上讲，您只能通过以下方式管理问题

*   受让人
*   标签（在 github 上称为标签）
*   里程碑

虽然您可以为许多区分标准定义标签系统，例如

*   错误/功能请求/...
*   优先高/低/...
*   状态已验证/未验证

根本不可能有可以积累选票的东西。因此，通常您会在旧邮件列表中看到“+1”帖子。我见过有人在 github 上使用外部投票系统（如 Google 版主）来解决问题，但这也不能带来良好的用户体验。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-12-12T05:00:10.400

如果你愿意使用与 GitHub 集成的第三方系统，可以试试[GitPoll](http://poll.gitrun.com/)。

# java - 在第一个周期避免 NullPointerException

> ID：11381902
> 
> 赞同：-1
> 
> 时间：2012-07-08T08:57:47.433
> 
> 标签：java, nullpointerexception

我有这段代码：

```
EventSnapshot snapshotEvent = new EventSnapshot();

EventSnapshot currentEvent = new EventSnapshot();

do
{
   ...              
currentEvent.setContent(in_stats); 
   ...              
if(!snapshotEvent.equals(currentEvent))
    snapshotEvent.setContent(in_stats);
}
while(true); 
```

在第一个周期我得到一个`NullPointerException`，因为显然对象 snapshotEvent 是空的。在第二个周期这不会发生。如何避免这个问题？

**编辑**

这是错误，它发生在这里：

```
java.lang.NullPointerException
    at org.w3c.jigmonitor.EventSnapshot.equals(EventSnapshot.java:40)

public class EventSnapshot 
{
    private Statistics content;

    public EventSnapshot()
    {
        super();
    }

    /**
     * @return the content
     */
    public Statistics getContent() 
    {
        return content;
    }

    /**
     * @param content the content to set
     */
    public void setContent(Statistics content) 
    {
        this.content = content;
    }

    public boolean equals(EventSnapshot es)
    {
        return this.content.equals(es.getContent()); // here...
    }

    /* (non-Javadoc)
     * @see java.lang.Object#toString()
     */
    @Override
    public String toString() {
        return "EventSnapshot [content=" + content + "]";
    }   
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T09:15:34.113

更改 if 语句：

```
if(snapshotEvent!= null && !snapshotEvent.equals(currentEvent))
    snapshotEvent.setContent(in_stats);
} 
```

**编辑**：

编辑后，错误发生在 equals 方法中：

```
public boolean equals(EventSnapshot es)
    {
        return this.content.equals(es.getContent()); // here...
    } 
```

它可能是由两个因素引起的：

1.  `this.content`一片空白
2.  `es`一片空白

只需记录或调试它，看看哪个是真的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T09:28:33.337

它不是那个`snapshotEvent`，`null`而是它的内容：`snapshotEvent.content`. 您可以将`equals`方法更改为：

```
public boolean equals(EventSnapshot es)
{
   if(es == null) return false;
   if(content == null) return false;
   if(es.content == null) return false;
   return this.content.equals(es.getContent()); // here...
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T09:30:47.540

您的方法已损坏-如果为 null `EventSnapshot.equals`，它将引发异常。`content`

*确保快照永远不会有空内容，*或者**更改*为`equals`如下所示：*

 *```
public boolean equals(EventSnapshot es) {
    // TODO: Decide how to handle the situation where es itself is null
    if (content == es.getContent()) {
        return true;
    }
    if (content == null || es.getContent() == null) {
        return false;
    }
    return content.equals(es.getContent());
} 
```

请注意，在不覆盖and的情况下*提供*`equals()`新的重载有点奇怪。*`Object.equals()``Object.hashCode()`*

 ** * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-08T09:09:35.313

您需要检查，如果 shapshotEvent != null 或用空块捕获 NullPointerException。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-07-08T09:23:34.747

从您提供的代码中，很难说出导致 NullpointerException 的原因。但是你总是可以抓住它，让你的代码进入下一次迭代；也许可以解决它：

```
EventSnapshot snapshotEvent = new EventSnapshot();
EventSnapshot currentEvent = new EventSnapshot();
do {
    try {
        ...              
        currentEvent.setContent(in_stats); 
        ...              
        if(!snapshotEvent.equals(currentEvent))
            snapshotEvent.setContent(in_stats);
    } catch (Exception e) {
        e.printStacktrace();
    }
} while(true); 
```**

# c - 将两个浮点数相乘并不能给出准确的结果

> ID：11381905
> 
> 赞同：1
> 
> 时间：2012-07-08T09:00:47.243
> 
> 标签：c, floating-point

我正在尝试将两个`float`s 相乘，如下所示：

```
float number1 = 321.12;
float number2 = 345.34;
float rexsult = number1 * number2; 
```

我想看到的结果是 110895.582，但是当我运行代码时它只给我 110896。大多数时候我都遇到这个问题。任何计算器都能为我提供所有小数的确切结果。我怎样才能达到这个结果？

编辑：这是C代码。我正在使用 XCode iOS 模拟器。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-08T09:15:56.533

有很多四舍五入。

```
float a = 321.12; // this number will be rounded
float b = 345.34; // this number will also be rounded
float r = a * b;  // and this number will be rounded too
printf("%.15f\n", r); 
```

在三个单独的四舍五入后，我得到 110895.578125000000000 。

1.  如果您想要超过 6 个十进制数字的精度，则*必须*使用`double`and not `float`。（注意我说的是“十进制数字的价值”，因为你没有得到十进制数字，你得到的是二进制。）就目前而言，1/2 ULP 的错误（*完美*舍入结果的最坏情况界限）约为0.004。

2.  如果您想要精确四舍五入的十进制数，则必须使用专门的十进制库来完成此类任务。对于科学家来说， A`double`具有足够的精度，但如果你用钱工作，一切都必须 100% 准确。没有浮点数的钱。

与整数不同，浮点数需要一些实际的工作才能习惯它们的陷阱。请参阅“ [What Every Computer Scientist Should Know About Floating-Point Arithmetic](http://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html) ”，这是对该主题的经典介绍。

**编辑：**实际上，我不确定代码是否会循环三遍。它可能会四舍五入*五次*，因为`a`and的常量在`b`存储时可能先四舍五入为双精度，然后再四舍五入为单精度。但是我对C这部分的规则不是很了解。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-08T09:25:33.150

这样你永远不会得到确切的结果。

首先，number1 ≠ 321.12，因为该值无法在 base-2 系统中精确表示。您将需要无限数量的位。

number2 ≠ 345.34 也是如此。

因此，您从不精确的值开始。

然后乘积将被四舍五入，因为乘法使有效位数增加一倍，但`float`如果乘以浮点数，则必须再次存储乘积。

您可能希望对数字使用基于 10 的系统。或者，如果您的数字只有 2 个小数位，您可以使用整数（在这种情况下 32 位整数就足够了，但您最终可能需要 64 位）：

32112 * 34534 = 1108955808。

这表示 321.12 * 345.34 = 110895.5808。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-08T09:15:43.537

由于您使用的是 C，因此您可以使用 "%.xf" 轻松设置精度，其中 x 是所需的精度。

例如：

```
float n1 = 321.12;
float n2 = 345.34;
float result = n1 * n2;

printf("%.20f", result); 
```

输出：

```
110895.57812500000000000000 
```

但是，请注意，`float`它只给出了六位数的精度。为了更好的精度使用`double`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-08T09:20:08.257

*   浮点变量只是近似表示，而不是精确表示。并非每个数字都可以“适合”浮点变量。例如，无法将 1/10 (0.1) 放入二进制变量中，就像无法将 1/3 放入十进制 1 一样（只能用无穷大的 0.33333 来近似）
*   输出此类变量时，通常会应用许多舍入选项。除非您全部设置，否则您永远无法确定应用了哪些。对于 << 运算符尤其如此，因为可以告诉流如何在 << 之前进行舍入。

Printf 也做了一些舍入。考虑[http://codepad.org/LLweoeHp](http://codepad.org/LLweoeHp)：

```
float t = 0.1f;
printf("result: %f\n", t);
--
result: 0.100000 
```

嗯，看起来不错。为什么？因为 printf 默认为某些精度并四舍五入输出。让我们拨入小数点后 50 位：http: [//codepad.org/frUPOvcI](http://codepad.org/frUPOvcI)

```
float t = 0.1f;
printf("result: %.50f\n", t);
--
result: 0.10000000149011611938476562500000000000000000000000 
```

那是不一样的，不是吗？在 625 之后，浮点数耗尽了容纳更多数据的容量，这就是我们看到零的原因。double 可以容纳更多数字，但二进制中的 0.1 不是有限的。Double不得不放弃，最终：[http ://codepad.org/RAd7Yu2r](http://codepad.org/RAd7Yu2r)

```
double t = 0.1;
printf("result: %.70f\n", t);
--
result: 0.1000000000000000055511151231257827021181583404541015625000000000000000 
```

在您的示例中，仅 321.12 就足以引起麻烦：[http ://codepad.org/cgw3vUKn](http://codepad.org/cgw3vUKn)

```
float t = 321.12f;
printf("and the result is: %.50f\n", t);
result: 321.11999511718750000000000000000000000000000000000000 
```

这就是为什么在将浮点值呈现给人类之前必须对其进行四舍五入的原因。

计算器程序根本不使用浮点数或双精度数。他们实现十进制数字格式。例如：

```
struct decimal
{
     int mantissa; //meaningfull digits
     int exponent; //number of decimal zeroes
}; 
```

Ofc 需要重新发明所有运算：加法、减法、乘法和除法。或者只是寻找一个十进制库。

# python - 图像像素颜色列表，从 RGBA 转换为 BGRA？

> ID：11381907
> 
> 赞同：0
> 
> 时间：2012-07-08T09:00:52.947
> 
> 标签：python, list, blender

我有一个浮点列表，它是一个图像像素数据。每 4 个浮点数构成一个 RGBA 像素。将该列表转换为 BGRA 格式（顺序）的最有效方法是什么？

我有的：

```
[R, G, B, A, R, G, B, A] 
```

我需要的：

```
[B, G, R, A, B, G, R, A] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T09:52:06.993

```
>>> v = [1,2,3,4,5,6,7,8]
>>> [v[a if a & 1 else a ^ 2] for a in range(len(v))]
[3, 2, 1, 4, 7, 6, 5, 8] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T09:07:15.160

[使用来自itertools](http://docs.python.org/library/itertools.html#recipes)的石斑鱼配方

```
>>> from itertools import chain, izip_longest
>>> def grouper(n, iterable, fillvalue=None):
        "Collect data into fixed-length chunks or blocks"
        # grouper(3, 'ABCDEFG', 'x') --> ABC DEF Gxx
        args = [iter(iterable)] * n
        return izip_longest(fillvalue=fillvalue, *args)

>>> pixels = [70, 140, 210, 0.5, 60, 100, 200, 0.7]
>>> list(chain.from_iterable((b,g,r,a) for r,g,b,a in grouper(4, pixels)))
[210, 140, 70, 0.5, 200, 100, 60, 0.7] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T09:14:18.733

不是很 Pythonic，但~~可能很有效~~：

```
final = []
for i in range(len(data)/4):
    final.extend(data[4*i:4*i+3][::-1])
    final.append(data[4*i+3]) 
```

编辑：如果您可以就地修改列表，那将是完美的恕我直言：

```
for i in range(0, len(data), 4):
    data[i:i+3] = data[i:i+3][::-1] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-08T09:20:02.527

```
from itertools import chain,izip
L = [1,2,3,4,1,2,3,4]
print list(chain(*((C,B,A,D) for A,B,C,D in izip(*[iter(L)]*4)))) 
```

# regex - Postgres 9.1 上的更新查询太慢

> ID：11381908
> 
> 赞同：1
> 
> 时间：2012-07-08T09:01:17.350
> 
> 标签：regex, performance, postgresql

我的问题是我对一个有 1400 万行的表的更新查询非常慢。我尝试了不同的方法来调整我的服务器，这带来了良好的性能，但不适用于更新查询。

我有两张桌子：

*   T1 上有 4 列和 3 个索引（530 行）
*   T2 上有 15 列和 3 个索引（1400 万行）
*   我想通过在文本字段 stxt 上连接两个表，将 T2 中的字段 vid（整数类型）更新为 T1 中相同的 vid 值。

这是我的查询及其输出：

```
explain analyse 
update T2 
  set vid=T1.vid 
from T1 
where stxt2 ~ stxt1 and T2.vid = 0; 
```

```
T2 更新（成本=0.00..9037530.59 行=2814247 宽度=131）（实际时间=25141785.741..25141785.741 行=0 循环=1）
 -> 嵌套循环（成本=0.00..9037530.59 行=2814247 宽度=131）（实际时间=32.636..25035782.995 行=679354 循环=1）
             加入过滤器：((T2.stxt2)::text ~ (T1.stxt1)::text)
             -> T2 上的 Seq Scan（成本=0.00..594772.96 行=1061980 宽度=121）（实际时间=0.067..5402.614 行=1037809 循环=1）
                         过滤器：（视频= 1）
             -> 实现（成本=0.00..17.95 行=530 宽度=34）（实际时间=0.000..0.069 行=530 循环=1037809）
                         -> T1 上的 Seq Scan（成本=0.00..15.30 行=530 宽度=34）（实际时间=0.019..0.397 行=530 循环=1）
总运行时间：25141785.904 毫秒

```

如您所见，查询大约花费了 25141 秒（约 7 小时）。f 我理解得很好，planner 估计执行时间为 9037 秒（~ 2.5 小时）。我在这里错过了什么吗？

以下是有关我的服务器配置的信息：

*   CentOS 5.8，20GB 内存
*   共享缓冲区 = 12GB
*   工作内存 = 64MB
*   维护工作内存 = 64MB
*   bgwriter_lru_maxpages = 500
*   checkpoint_segments = 64
*   checkpoint_completion_target = 0.9
*   有效缓存大小 = 10GB

我已经在 T2 表上运行了 vacuum full 并分析了几次，但这仍然没有改善这种情况。

PS：如果我将 full_page_writes 设置为关闭，这会大大改善更新查询，但我不想冒数据丢失的风险。请问您有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T14:50:52.937

这不是解决方案，而是数据建模解决方法

*   将 url 分解为 {protocol,hostname,pathname} 组件。
*   现在您可以使用完全匹配来加入主机名部分，避免正则表达式匹配中的前导 %。
*   该视图旨在证明可以在需要时重建 full_url。

更新可能需要几分钟时间。

```
SET search_path='tmp';

DROP TABLE urls CASCADE;
CREATE TABLE urls
        ( id SERIAL NOT NULL PRIMARY KEY
        , full_url varchar
        , proto varchar
        , hostname varchar
        , pathname varchar
        );

INSERT INTO urls(full_url) VALUES
 ( 'ftp://www.myhost.com/secret.tgz' )
,( 'http://www.myhost.com/robots.txt' )
,( 'http://www.myhost.com/index.php' )
,( 'https://www.myhost.com/index.php' )
,( 'http://www.myhost.com/subdir/index.php' )
,( 'https://www.myhost.com/subdir/index.php' )
,( 'http://www.hishost.com/index.php' )
,( 'https://www.hishost.com/index.php' )
,( 'http://www.herhost.com/index.php' )
,( 'https://www.herhost.com/index.php' )
        ;

UPDATE urls
SET proto = split_part(full_url, '://' , 1)
        , hostname = split_part(full_url, '://' , 2)
        ;

UPDATE urls
SET pathname = substr(hostname, 1+strpos(hostname, '/' ))
        , hostname = split_part(hostname, '/' , 1)
        ;

        -- the full_url field is now redundant: we can drop it
ALTER TABLE urls
        DROP column full_url
        ;
        -- and we could always reconstruct the full_url from its components.
CREATE VIEW vurls AS (
        SELECT id
        , proto || '://' || hostname || '/' || pathname AS full_url
        , proto
        , hostname
        , pathname
        FROM urls
        );

SELECT * FROM urls;
        ;
SELECT * FROM vurls;
        ; 
```

输出：

```
INSERT 0 10
UPDATE 10
UPDATE 10
ALTER TABLE
CREATE VIEW
 id | proto |    hostname     |     pathname     
----+-------+-----------------+------------------
  1 | ftp   | www.myhost.com  | secret.tgz
  2 | http  | www.myhost.com  | robots.txt
  3 | http  | www.myhost.com  | index.php
  4 | https | www.myhost.com  | index.php
  5 | http  | www.myhost.com  | subdir/index.php
  6 | https | www.myhost.com  | subdir/index.php
  7 | http  | www.hishost.com | index.php
  8 | https | www.hishost.com | index.php
  9 | http  | www.herhost.com | index.php
 10 | https | www.herhost.com | index.php
(10 rows)

 id |                full_url                 | proto |    hostname     |     pathname     
----+-----------------------------------------+-------+-----------------+------------------
  1 | ftp://www.myhost.com/secret.tgz         | ftp   | www.myhost.com  | secret.tgz
  2 | http://www.myhost.com/robots.txt        | http  | www.myhost.com  | robots.txt
  3 | http://www.myhost.com/index.php         | http  | www.myhost.com  | index.php
  4 | https://www.myhost.com/index.php        | https | www.myhost.com  | index.php
  5 | http://www.myhost.com/subdir/index.php  | http  | www.myhost.com  | subdir/index.php
  6 | https://www.myhost.com/subdir/index.php | https | www.myhost.com  | subdir/index.php
  7 | http://www.hishost.com/index.php        | http  | www.hishost.com | index.php
  8 | https://www.hishost.com/index.php       | https | www.hishost.com | index.php
  9 | http://www.herhost.com/index.php        | http  | www.herhost.com | index.php
 10 | https://www.herhost.com/index.php       | https | www.herhost.com | index.php
(10 rows) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T21:01:42.973

这是我之前对功能索引的评论的扩展示例。如果您使用 postgresql 并且不知道函数索引是什么，那么您可能会因此而受苦。

让我们创建一个测试表，将一些数据放入其中：

```
smarlowe=# create table test (a text, b text, c int);
smarlowe=# insert into test select 'abc','z',0 from generate_series(1,1000000); -- 1 million rows that don't match
smarlowe=# insert into test select 'abc','a',0 from generate_series(1,10); -- 10 rows that do match
smarlowe=# insert into test select 'abc','z',1 from generate_series(1,1000000); -- another million rows that won't match. 
```

现在我们要对其运行一些查询来测试：

```
\timing
select * from test where a ~ b and c=0; -- ignore how long this takes
select * from test where a ~ b and c=0; -- run it twice to get a read with cached data. 
```

在我的笔记本电脑上，这需要大约 750 毫秒。这个关于 c 的经典索引：

```
smarlowe=# create index test_c on test(c);
smarlowe=# select * from test where a ~ b and c=0; 
```

在我的笔记本电脑上大约需要 400 毫秒。

这个功能指标tho：

```
smarlowe=# drop index test_c ;
smarlowe=# create index test_regex on test (c) where (a~b);
smarlowe=# select * from test where a ~ b and c=0; 
```

**现在运行时间为 1.3 毫秒。**

当然，没有免费的午餐，您将在更新/插入期间为此索引付费。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T17:02:20.787

谢谢，这带来了一些帮助。所以这就是我所做的：

*   如您所述，我创建了表格网址
*   我添加了一个整数类型的 vid 列
*   我在 T2 的 full_url 列中插入了 1000000 行
*   我启用了计时，并使用不包含“http”和“www”的 full_url 更新了主机名列 `update urls set hostname=full_url where full_url not like '%/%' and full_url not like 'www\.%';`

`Time: 112435.192 ms`

然后我运行这个查询：

```
 mydb=> explain analyse update urls set vid=vid from T1 where hostname=stxt1; 
             QUERY PLAN                                                          
            -----------------------------------------------------------------------------------------------------------------------------
             Update on urls  (cost=21.93..37758.76 rows=864449 width=124) (actual time=767.793..767.793 rows=0 loops=1)
                 ->  Hash Join  (cost=21.93..37758.76 rows=864449 width=124) (actual time=102.324..430.448 rows=94934 loops=1)
                             Hash Cond: ((urls.hostname)::text = (T1.stxt1)::text)
                             ->  Seq Scan on urls  (cost=0.00..25612.52 rows=927952 width=114) (actual time=0.009..265.962 rows=927952 loops=1)
                             ->  Hash  (cost=15.30..15.30 rows=530 width=34) (actual time=0.444..0.444 rows=530 loops=1)
                                         Buckets: 1024  Batches: 1  Memory Usage: 35kB
                                         ->  Seq Scan on T1  (cost=0.00..15.30 rows=530 width=34) (actual time=0.002..0.181 rows=530 loops=1)
             Total runtime: 767.860 ms 
```

我对总运行时间感到非常惊讶！不到 1 秒，这证实了您所说的完全匹配的更新。现在我以这种方式搜索 xtxt1 和 stxt2 之间的完全匹配：

```
mydb=> select count(*) from T2 where vid is null and exists(select null from T1 where stxt1=stxt2);
 count  
--------
 308486
(1 row) 
```

因此我在 T2 表上尝试了更新，得到了这个：

```
mydb=> explain analyse update T2 set vid = T1.vid from T1 where T2.vid is null and stxt2=stxt1;
                                                                                                                            QUERY PLAN                                                               
---------------------------------------------------------------------------------------------------------------------------------------
 Update on T2  (cost=21.93..492023.13 rows=2106020 width=131) (actual time=252395.118..252395.118 rows=0 loops=1)
     ->  Hash Join  (cost=21.93..492023.13 rows=2106020 width=131) (actual time=1207.897..4739.515 rows=308486 loops=1)
                 Hash Cond: ((T2.stxt2)::text = (T1.stxt1)::text)
                 ->  Seq Scan on T2  (cost=0.00..455452.09 rows=4130377 width=121) (actual time=158.773..3915.379 rows=4103865 loops=1)
                             Filter: (vid IS NULL)
                 ->  Hash  (cost=15.30..15.30 rows=530 width=34) (actual time=0.293..0.293 rows=530 loops=1)
                             Buckets: 1024  Batches: 1  Memory Usage: 35kB
                             ->  Seq Scan on T1  (cost=0.00..15.30 rows=530 width=34) (actual time=0.005..0.121 rows=530 loops=1)
 Total runtime: 252395.204 ms
(9 rows)

Time: 255389.704 ms 
```

实际上 255 秒似乎是这样一个查询的好时机。我将尝试从所有 url 中提取主机名部分并进行更新。我仍然应该确保快速更新完全匹配的内容，因为我对它的体验很差。

谢谢您的支持。

# javascript - google+ hangouts 将值存储在状态 gapi.hangouts.data

> ID：11381914
> 
> 赞同：1
> 
> 时间：2012-07-08T09:02:17.853
> 
> 标签：javascript, asynchronous, google-plus, hangout

我现在遇到了一段时间的小问题：需要在状态中存储一个随机数，这将持续存在于所有参与者中。

```
alert(delta[random]); 
```

返回值，因此到目前为止一切正常，但这就是神秘开始的地方：

我已经试过了

```
$.each(gapi.hangout.data.getKeys(),function(i,o){
alert(o);
}); 
```

但它永远不会进入循环。但是，如果我放置

```
alert('dfsdasd'); 
```

在 submitDelta 之后它可以工作。最后两行

```
 alert(gapi.hangout.data.getValue(random));
    $("#randomNumber").val(gapi.hangout.data.getValue(random)); 
```

已经死了，没有“未定义”或[对象]的警报。

```
function setRandom()
    {
        var rand = Math.floor(Math.random()*100);
        var random = "randomNumber";
        var delta = {};
        delta[random] = JSON.stringify(rand);
        alert(delta[random]);

        gapi.hangout.data.submitDelta(delta);

        alert(gapi.hangout.data.getValue(random));
        $("#randomNumber").val(gapi.hangout.data.getValue(random));
    } 
```

我已经包含了两个库 src="//talkgadget.google.com/hangouts/_/api/hangout.js?v=1.1" 和 src="http://code.jquery.com/jquery-1.7.2。 js"

onStateChanged 上没有处理程序

我在这里做错了什么？每当我触摸 gapi.hangouts.data 时，它都会失败。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T14:34:33.410

我看到这里有两个问题。

第一个是[submitDelta](https://developers.google.com/+/hangouts/api/gapi.hangout.data#gapi.hangout.data.submitDelta)被定义为采用两个参数，而您只提供一个。

另一个问题是 submitDelta() 是异步的，因此您不应期望 getValue() 或 getState() 在调用后立即工作。在这种情况下处理事情的最佳方法是使用 onStateChanged.add() 注册 StateChangedEvent。

因此，例如，您可能会执行以下操作：

```
function init(){
    gapi.hangout.data.onStateChanged.add( handleChange );
    submitRandom();
}

function handleChange( stateChangedEvent ){
    var random = "randomNumber";
    var val = gapi.hangout.data.getValue(random);
    alert(val);
    $("#randomNumber").val(val);
}

function submitRandom(){
    var rand = Math.floor(Math.random()*100);
    var random = "randomNumber";
    var delta = {};
    delta[random] = JSON.stringify(rand);
    alert(delta[random]);

    gapi.hangout.data.submitDelta(delta, []);
} 
```

# azure - Windows Azure 和第三方 Windows 服务

> ID：11381919
> 
> 赞同：0
> 
> 时间：2012-07-08T09:03:41.620
> 
> 标签：azure, azure-web-roles

我正在开发一个网站，我打算使用单个 Web 角色在 Windows Azure 中运行。该站点将使用需要作为 Windows 服务运行的 Sphinx 搜索引擎。所以，我的问题是……是否可以在 Web 角色中安装 Sphinx Search Windows 服务。

从我对 Azure 的初步研究来看，我认为“是”，因为 Web 角色是运行 IIS 的 VM。因此，我应该能够远程安装该服务，并且它应该可以工作。:)

这听起来对吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T13:14:53.773

对于 Web/Worker 角色实例，通过 RDP 安装软件不是一个可行的解决方案，因为这些更改不会持续存在。您需要从启动脚本或从`OnStart()`. 由于您想作为服务安装，这意味着启动脚本，因为它需要提升的权限。注意：安装程序必须支持无人值守模式，其中所有参数都通过命令行指定，无需人工干预。

可扩展性如何？如果您的 Web 角色有多个实例在运行，那么 sphinx 可以跨两个实例运行吗？根据我的阅读，它支持兼容 ODBC 的数据库，并且您可以将它用于 Windows Azure SQL 数据库。如果是这种情况，两个 sphinx 引擎可以在访问同一数据存储的两台不同机器上运行吗？如果是这样，这听起来像是一个可行的解决方案。

如果安装无法自动化，或者您需要一些额外的东西，例如 MySQL，您可能需要考虑将 sphinx 搜索引擎放在虚拟机中（2012 年 6 月新增）。现在您可以启动 Windows 2008 Server，将 RDP 放入其中，按照您的需要进行配置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T09:24:00.060

严格来说是的，你*可以*这样做。但是，这假设您将在一个 VM 实例上运行，并且该实例永远不需要重新启动。

您应该考虑查看 Azure 辅助角色以了解通常作为 Windows 服务存在的任何功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T14:19:34.870

在阅读了您的答案并进行了更多思考之后，我认为放弃安装服务的想法将是最好的行动方案。我一直在研究 Lucene.NET 的 API（这可能与 Sphinx 相同），并且可以在代码中封装索引的编写/管理等，因此不需要服务。

对于 Azure，有一个库可以使用本地和 Azure 存储来管理索引文件，这可能是有用的。我读过的场景表明，可以有一个 Web 角色来处理 HTTP 请求并执行搜索，还有一个 Worker 角色来通过队列接受数据库更改并将它们写入索引。

# javascript - 我需要关于 jCarousel 画廊的帮助

> ID：11381926
> 
> 赞同：0
> 
> 时间：2012-07-08T09:06:38.460
> 
> 标签：javascript, jquery, jcarousel

大家！

我对 jCarousel 有一点问题，所以我真的需要你的帮助。

这是画廊： [http ://tranzit.dir.bg/load.php?id=TdVijCkhJSrC7CkA1273310](http://tranzit.dir.bg/load.php?id=TdVijCkhJSrC7CkA1273310)

我的问题是如何制作脚本，以便当您单击箭头（黑色小方块）时，大图像（向前和向后）的选择器（小图片上的红色边框）再次向前和向后移动。现在只有小图像在移动......我想问题不是那么大，但我做不到。

示例：themeforest.s3.amazonaws.com/86_jquery/gallery.html

我的代码：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
    <head>
        <meta http-equiv="content-type" content="text/html; charset=windows-1250">
        <link rel="stylesheet" type="text/css" href="jcarousel_tango.css" />
        <link rel="stylesheet" type="text/css" href="jcarousel_showcase.css" />

        <script type="text/javascript" src="jquery.min.js"></script>          
        <script type="text/javascript" src="jquery.jcarousel.min.js"></script>   

  <script type="text/javascript">  

function mycarousel_initCallback(carousel) {     
    jQuery('.jcarousel-next').click(function() {
        jQuery('.jcarousel-item').removeClass('highliht');
        jQuery(this).addClass('highliht');

        jQuery('.jcarousel-control a').removeClass('active');
        jQuery('.jcarousel-control a#cnt-'+jQuery(this).attr('jcarouselindex')).addClass('active');
        carousel.scroll(jQuery.jcarousel.intval(jQuery(this).attr('jcarouselindex')));

        return false;
    }); 

function mycarousel_initCallbackanother(carousel) {
  jQuery('.jcarousel-skin-showcase div.jcarousel-next').click(function(){
          jQuery('.jcarousel-control a#cnt-1').addClass('active');
jQuery('#mycarousel li:first').addClass('highliht');
  //chage position on mycarousel
     });
 }

}

jQuery(document).ready(function() {
    jQuery('.tabcontent a#cnt-1').addClass('active');
    jQuery('#mycarousel li:first').addClass('highliht');

    jQuery('#mycarousel').jcarousel({ 
        btnNext: ".next",
        btnPrev: ".prev",
        visible: 7, 
        scroll: 6, 
        initCallback: mycarousel_initCallback 
    });

        jQuery('#showcasecarousel').jcarousel({ 
        scroll: 1,
        animation: 1,
        initCallback: mycarousel_initCallback,
        itemLoadCallback: trigger   
    });  

    function trigger(carousel, state)
    {
    $("#currentImg").html(carousel.first);  
    }

});  
</script>

    </head>
   <body>
        <div id="wrap">
            <div id="postcolumn">
                <!-- post zone -->
                <div class="photobox">
                    <div id="post-213" class="photopost">
                     <div id="mycarousel" class="jcarousel-skin-tango">
                        <ul class="photos" id="photos">  
                            <li><a class="" rel="1" href="#"><img title="" alt="" src="img/1t.jpg"></a></li>
                            <li><a class="" rel="2" href="#"><img title="" alt="" src="img/2t.jpg"></a></li>
                            <li><a class="" rel="3" href="#"><img title="" alt="" src="img/3t.jpg"></a></li>
                            <li><a class="" rel="4" href="#"><img title="" alt="" src="img/4t.jpg"></a></li>
                            <li><a class="" rel="5" href="#"><img title="" alt="" src="img/5t.jpg"></a></li>
                            <li><a class="" rel="6" href="#"><img title="" alt="" src="img/6t.jpg"></a></li>
                            <li><a class="" rel="7" href="#"><img title="" alt="" src="img/7t.jpg"></a></li>
                            <li><a class="" rel="8" href="#"><img title="" alt="" src="img/8t.jpg"></a></li>
                            <li><a class="" rel="9" href="#"><img title="" alt="" src="img/9t.jpg"></a></li>
                            <li><a class="" rel="10" href="#"><img title="" alt="" src="img/10t.jpg"></a></li>
                            <div class="clear">
                            </div> 
                        </ul>
                        </div> 
                        <div class="clear">
                        </div>

                        <ul id="showcasecarousel" class="jcarousel-skin-showcase">
                            <li><img title="" alt="" src="img/1.jpg"></a></li>
                            <li><img title="" alt="" src="img/2.jpg"></a></li>
                            <li><img title="" alt="" src="img/3.jpg"></a></li>
                            <li><img title="" alt="" src="img/4.jpg"></a></li>
                            <li><img title="" alt="" src="img/5.jpg"></a></li>
                            <li><img title="" alt="" src="img/6.jpg"></a></li>
                            <li><img title="" alt="" src="img/7.jpg"></a></li>
                            <li><img title="" alt="" src="img/8.jpg"></a></li>
                            <li><img title="" alt="" src="img/9.jpg"></a></li>
                            <li><img title="" alt="" src="img/10.jpg"></a></li>
                        </ul> 
                        Current Photo <span id="currentImg">1</span>

                    </div>
                </div>
            </div>
        </div>
    </body>
</html> 
```

非常感谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T10:06:50.963

首先，您的两个轮播都调用相同的初始化回调方法，我猜这并不是您真正想要的。所以而不是：

```
 jQuery('#showcasecarousel').jcarousel({ 
    scroll: 1,
    animation: 1,
    initCallback: mycarousel_initCallback,
    itemLoadCallback: trigger 
```

你可能想要：

```
 jQuery('#showcasecarousel').jcarousel({ 
    scroll: 1,
    animation: 1,
    initCallback: showcasecarousel_initCallback,
    itemLoadCallback: trigger 
```

然后你需要创建函数showcasecarousel_initCallback。以下将完成您想要的工作：

```
function showcasecarousel_initCallback(carousel) {
      jQuery('.jcarousel-skin-showcase div.jcarousel-next').click(function () {
          if (carousel.first < 10) {
              jQuery('#mycarousel li.jcarousel-item').removeClass('highliht');
              jQuery('#mycarousel .jcarousel-item-' + (carousel.first + 1)).addClass('highliht');
          }
          return false;
      });

      jQuery('.jcarousel-skin-showcase div.jcarousel-prev').click(function () {
          if (carousel.first > 1) {
              jQuery('#mycarousel li.jcarousel-item').removeClass('highliht');
              jQuery('#mycarousel .jcarousel-item-' + (carousel.first - 1)).addClass('highliht');
          }
          return false;
      });
} 
```

...尽管如果我是您，我会进行大量重构，因为您的代码中存在大量不一致之处，并且不容易遵循。您还需要处理加载到下部轮播中的图像当前未显示在顶部轮播中的情况，您需要向前或向后移动顶部轮播。

# java - 无法在模拟器/虚拟机上运行 GCM (C2DM)：API 级别 14

> ID：11381928
> 
> 赞同：2
> 
> 时间：2012-07-08T09:07:04.790
> 
> 标签：java, android, google-app-engine, android-c2dm, google-cloud-messaging

启动时应用程序崩溃抛出异常：

java.lang.UnsupportedOperationException：设备没有包 com.google.android.gsf

模拟器和虚拟机的配置应该是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-13T15:29:34.227

这个问题的解决方案。

您应该使用 Google Api 创建一个新的模拟器。然后，在这个新的 android 模拟器中重新部署您的应用程序。

结果：

```
08-06 19:18:55.590: V/GCMBroadcastReceiver(841): onReceive: com.google.android.c2dm.intent.REGISTRATION
08-06 19:18:55.590: V/GCMBroadcastReceiver(841): GCM IntentService class: org.gdglima.taller.labuno.GCMIntentService
08-06 19:18:55.600: V/GCMBaseIntentService(841): Acquiring wakelock
08-06 19:18:55.630: V/GCMBaseIntentService(841): Intent service name: GCMIntentService-DynamicSenderIds-1
08-06 19:18:55.710: D/GCMBaseIntentService(841): handleRegistration: registrationId = APA91bHoqz3F7X-QByP8pvOuyZQHthpQB6vrL_3REPOtO8GrCsD_aXrfNzvW4zxbtfkoXMAAjnf0wuARu12h9O4HP-4IHJI6peFRlDkdZC0MqzJhdw47_8VspjsiwDysmEp9_W4RdoPaIzK0bxiTIeGaEMkkK8oq-Q, error = null, unregistered = null
08-06 19:18:55.710: D/GCMRegistrar(841): resetting backoff for org.gdglima.taller.labuno
08-06 19:18:55.730: V/GCMRegistrar(841): Saving regId on app version 1
08-06 19:18:55.870: D/GCMTest(841): REGISTRATION: onRegistered OK.
08-06 19:18:55.930: V/GCMBaseIntentService(841): Releasing wakelock 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T05:14:20.147

如果您在 AVD 中收到“收到的错误：PHONE_REGISTRATION_ERROR”。你应该重启你的APP，然后你会得到正确的信息。

# java - 添加导致未找到异常的文本侦听器

> ID：11381930
> 
> 赞同：2
> 
> 时间：2012-07-08T09:07:26.563
> 
> 标签：java, android, eclipse, layout

在 NewTweetActivity.java 中，我有：

```
@Override
public void onCreate(Bundle savedInstanceState){
    super.onCreate(savedInstanceState);
    setContentView(R.layout.newtweet);
    listenToChange();
}

public void listenToChange(){
    TextView cEditText = (TextView) findViewById(R.id.tweetCountTextView);
    EditText tView = (EditText) findViewById(R.id.tweetComposerEditText);
    tView.addTextChangedListener(new TextWatcher() {

        public void afterTextChanged(Editable s) {
            int len = (140 - s.length());
            cEditText.setText(len);
        }

        public void beforeTextChanged(CharSequence arg0, int arg1,
                int arg2, int arg3) {
            // TODO Auto-generated method stub

        }

        public void onTextChanged(CharSequence arg0, int arg1, int arg2,
                int arg3) {
            // TODO Auto-generated method stub

        }
    });
} 
```

但是，它要求我将**cEditText**声明为 final，但是当我这样做时，它无法加载 newtweet 布局。

如果我把**cEditText**声明放在里面`afterTextChanged`，它会加载布局，但是当我触发`afterTextChanged`（通过输入 EditText）时，它会导致：

```
07-08 20:44:27.054: E/AndroidRuntime(4417): FATAL EXCEPTION: main
07-08 20:44:27.054: E/AndroidRuntime(4417): android.content.res.Resources$NotFoundException: String resource ID #0x8b
07-08 20:44:27.054: E/AndroidRuntime(4417):     at android.content.res.Resources.getText(Resources.java:201)
07-08 20:44:27.054: E/AndroidRuntime(4417):     at android.widget.TextView.setText(TextView.java:2911)
07-08 20:44:27.054: E/AndroidRuntime(4417):     at com.jgnzapps.quark.NewTweetActivity$1.afterTextChanged(NewTweetActivity.java:31)
07-08 20:44:27.054: E/AndroidRuntime(4417):     at android.widget.TextView.sendAfterTextChanged(TextView.java:6532)
07-08 20:44:27.054: E/AndroidRuntime(4417):     at android.widget.TextView$ChangeWatcher.afterTextChanged(TextView.java:6720)
07-08 20:44:27.054: E/AndroidRuntime(4417):     at android.text.SpannableStringBuilder.sendTextHasChanged(SpannableStringBuilder.java:897)
07-08 20:44:27.054: E/AndroidRuntime(4417):     at android.text.SpannableStringBuilder.change(SpannableStringBuilder.java:353)
07-08 20:44:27.054: E/AndroidRuntime(4417):     at android.text.SpannableStringBuilder.change(SpannableStringBuilder.java:269)
07-08 20:44:27.054: E/AndroidRuntime(4417):     at android.text.SpannableStringBuilder.replace(SpannableStringBuilder.java:432)
07-08 20:44:27.054: E/AndroidRuntime(4417):     at android.text.SpannableStringBuilder.replace(SpannableStringBuilder.java:409)
07-08 20:44:27.054: E/AndroidRuntime(4417):     at android.text.SpannableStringBuilder.replace(SpannableStringBuilder.java:28)
07-08 20:44:27.054: E/AndroidRuntime(4417):     at android.view.inputmethod.BaseInputConnection.replaceText(BaseInputConnection.java:654)
07-08 20:44:27.054: E/AndroidRuntime(4417):     at android.view.inputmethod.BaseInputConnection.setComposingText(BaseInputConnection.java:415)
07-08 20:44:27.054: E/AndroidRuntime(4417):     at com.android.internal.view.IInputConnectionWrapper.executeMessage(IInputConnectionWrapper.java:318)
07-08 20:44:27.054: E/AndroidRuntime(4417):     at com.android.internal.view.IInputConnectionWrapper$MyHandler.handleMessage(IInputConnectionWrapper.java:75)
07-08 20:44:27.054: E/AndroidRuntime(4417):     at android.os.Handler.dispatchMessage(Handler.java:99)
07-08 20:44:27.054: E/AndroidRuntime(4417):     at android.os.Looper.loop(Looper.java:130)
07-08 20:44:27.054: E/AndroidRuntime(4417):     at android.app.ActivityThread.main(ActivityThread.java:3694)
07-08 20:44:27.054: E/AndroidRuntime(4417):     at java.lang.reflect.Method.invokeNative(Native Method)
07-08 20:44:27.054: E/AndroidRuntime(4417):     at java.lang.reflect.Method.invoke(Method.java:507)
07-08 20:44:27.054: E/AndroidRuntime(4417):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:860)
07-08 20:44:27.054: E/AndroidRuntime(4417):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:618)
07-08 20:44:27.054: E/AndroidRuntime(4417):     at dalvik.system.NativeStart.main(Native Method) 
```

如果我用一个字符串（例如“cats”）调用**cEditText**`setText`的方法，它就可以工作。

 **有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-08T09:17:16.743

问题很简单：您试图将 int 设置为 Text 而不是 String。因此，android 执行此方法：[http://developer.android.com/reference/android/widget/TextView.html#setText(int)](http://developer.android.com/reference/android/widget/TextView.html#setText(int)) 这意味着，它搜索具有给定 id 的字符串资源，这不会不存在。

您应该这样设置文本：

```
int len = (140 - s.length());
cEditText.setText(String.valueOf(len)); 
```**

# javascript - 如何从 aspx 文件中提取表数据？

> ID：11381937
> 
> 赞同：1
> 
> 时间：2012-07-08T09:08:36.360
> 
> 标签：javascript, jquery, asp.net

我在一个呼叫中心工作，有一个 aspx 页面，可以生成公司所有其他呼叫中心当前统计信息的 html 表格。

我在这里举了一个[JSFiddle](http://jsfiddle.net/UqZjt/)上生成的示例。恐怕我只是一个热心的初学者，所以如果我没有正确地问这个等，我深表歉意。

我正在寻找只提取我需要的数据，其中包括所有行和标记的列：

```
 --- C6 C7 C13 C14 
```

所以我需要看到的是上面的列。

这需要在客户端，所以我假设是 JS，因为我们无法在服务器上访问或编辑，因此我们无法拥有自己的 aspx 文件。

我很高兴使用 jQuery，我知道可以使用 jQuery 提取数据，但我似乎无法理解它:(

[如果有人愿意使用http://fiddle.jshell.net/UqZjt/show/](http://fiddle.jshell.net/UqZjt/show/)作为源文件来组合一个 JSFiddle ，那将不胜感激。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T11:06:36.140

如果您对 jQuery 没问题，请在您的页面中包含 jQuery 库，将此行添加到您的页面中`<head>`：

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script> 
```

这是基于硬编码的标题数组隐藏不需要的列的代码：

```
$(document).ready(function() {

    //define which column headers to keep
    var headersToKeep = ['---', 'C6', 'C7', 'C13', 'C14'],
        colsToKeep = [],
        table = $('#gvRealtime'),
        ths = table.find('th');

    //iterates over headersToKeep retrieving their indexes
    $.each(headersToKeep, function(i, v) {
        //finds each header and adds its index to the colsToKeep
        colsToKeep.push(ths.filter(function() {
            return $(this).text() == v;
        }).index());
    });

    //makes a new jQuery object containing only the headers/cells not present in the colsToKeep
    $('th, td', '#gvRealtime, #gvTotal').filter(function() {
        return $.inArray($(this).index(), colsToKeep) == -1;
    }).hide(); //and hides them
}); 
```

即使您对 JS/jQuery 没有太多经验，也会对代码进行注释，以防您对每个部分的作用有任何疑问。将它添加到 jQuery 库之后的`<script></script>`标签内。`<head>`

这是[**JSFiddle**](http://jsfiddle.net/ult_combo/UqZjt/14/)。

当然，稍后您可以根据复选框或其他切换方法获取/制作数组。由于您没有要求任何特定接口，因此我将数组保留为硬编码。

**编辑：**显然，假设您已经知道列号而不是通过标题文本获取它们，您可以使用这个更简单的代码段：

```
$(document).ready(function() {
    var colsToKeep = [0, 6, 7, 13, 14];
    $('th, td', '#gvRealtime, #gvTotal').filter(function() {
        return $.inArray($(this).index(), colsToKeep) == -1;
    }).hide();
}); 
```

**[JSFiddle](http://jsfiddle.net/ult_combo/UqZjt/15/)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T09:24:42.703

一个简单的谷歌搜索把我带到了[这个答案](https://stackoverflow.com/a/4350046/785241)，这把我带到了[这个小提琴](http://jsbin.com/oveva3/edit#javascript,html,live)。

我已尝试[使代码适应您的要求](http://jsfiddle.net/Daedalus/UqZjt/7/)。

希望您可以使用该功能（它位于最底部）达到某种效果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T09:25:01.023

您可以通过这种方式轻松访问表格的元素：

```
var table = document.getElementsByTagName("table")[0],
    tabArray = [];
for (var i = 0; i < table.tBodies[0].rows.length; i++) {
    var rowArray = [];
    for (var j = 0; j < table.tBodies[0].rows[i].cells.length; j++)
        rowArray.push(table.tBodies[0].rows[i].cells[j].innerHTML);
    tabArray.push(rowArray);
} 
```

现在，`tabArray`是一个包含表格单元格内容的二维数组。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-08T09:27:36.270

您可以通过 jquery 来实现这一点

```
$(document).ready(function() {
$('tr td').each(function() {
    $('#Result').append($(this).text());
});
}); 
```

在我的示例中，我为单元格数据添加了一个带有 id 结果的 div

```
<div id="Result" ></div> 
```

# android - 模拟器未显示 XML 内容

> ID：11381938
> 
> 赞同：0
> 
> 时间：2012-07-08T09:08:51.553
> 
> 标签：android, xml, eclipse

我一直在阅读[Google 的 android 教程](http://developer.android.com/training/basics/firstapp/building-ui.html)，但遇到了一个问题……
在教程中，他们解释了 XML 元素（EditText 和 Button），最后他们说如何调整程序以查看按钮 + 文本字段。
问题是，模拟器没有显示它们..只是一个黑屏。
我什至尝试将此行添加到 onCreate 函数 -

```
System.out.println("Hello World!"); 
```

但模拟器仍然只显示黑屏。这是.java主文件 - [http://pastebin.com/G5J9YjNe](http://pastebin.com/G5J9YjNe)

以及 XML 文件（我提到了什么代码是什么文件） - [http://pastebin.com/VnRwAfMW](http://pastebin.com/VnRwAfMW)

我该怎么办？

**非常**感谢所有愿意提供帮助的人！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T09:14:04.840

```
System.out.println("Hello World!"); 
```

不会在屏幕上打印任何东西。它可以在Consol上看到。我尝试了下面的代码并且对我来说工作正常。

// 主活动 public class MainActivity extends Activity {

```
 @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.kuchbhi);
        System.out.println("Hello World!");
    } 
```

布局/.xml

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
   xmlns:tools="http://schemas.android.com/tools"
   android:layout_width="match_parent"
   android:layout_height="match_parent"
   android:orientation="horizontal" >

    <EditText android:id="@+id/text_message"
    android:layout_weight="1"
    android:layout_width="0dp"
    android:layout_height="wrap_content"
    android:hint="enter text" />

    <Button android:layout_height="wrap_content"
    android:layout_width="wrap_content"
    android:text="Send" />

    </LinearLayout> 
```

清单文件..

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.test"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk android:minSdkVersion="8" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >
        <activity
            android:name="MainActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>

    </application>

</manifest> 
```

试试这段代码，让我知道你看到了什么。

我试过你的源代码，它对我来说很好。看屏幕

![你的应用屏幕](../Images/bd33980d672e9a2b3fd77e5389096ee1.png)

# c# - 带有 Html 和 C# 的 Metro 风格应用程序

> ID：11381940
> 
> 赞同：9
> 
> 时间：2012-07-08T09:09:05.997
> 
> 标签：c#, xaml, windows-8, microsoft-metro

根据这张幻灯片

[http://media.infragistics.com/community/general/windows8-platform-tools.jpg](http://media.infragistics.com/community/general/windows8-platform-tools.jpg)

这是否意味着如果我想开发 Metro 风格的应用程序，我必须在 C# 中使用 XAML 视图？

我可以使用 HTML/JS/CSS - C# 与事件处理程序的组合吗？像 ASP.NET Webforms/MVC 这样的东西。我知道它不是相同的客户端服务器架构，但由于 Metro 风格的应用程序支持 HTML/JS，我想知道。

我可以使用 Win-JS。但是我可以写 C# 而不是 Javascript，使用 HTML 而不是 XAML 吗？（我不知道 XAML，我喜欢 C#）

我在网上找到的所有 C# 示例都使用 XAML。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-08T09:55:40.503

也许您可以在 C# 中编写部分程序逻辑并将其打包为库，然后创建一个引用 C# 库的 HTML5/JS 应用程序。这样，您应该只需要对与 UI 功能直接相关的部分使用 JS，其余部分使用 C#。

我会指出我还没有尝试过，但是比尔在[这个线程](http://social.msdn.microsoft.com/Forums/en-US/winappswithhtml5/thread/e890e461-a6fc-4396-8a27-57ed090998a5)中说他让它工作了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-08T09:15:45.510

不，您只能将 XAML 与 C# 或 HTML+CSS+JS 一起使用。但是 XAML 是很好的标记语言，所以我认为你可以使用它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-08T15:10:28.747

您可以在 c#（或 c++）中创建一个可以从 JavaScript 调用的“WinMD”库。WinMD 库相对于普通的 .net 库有很多限制，使用模型与 ASP.NET MVC 完全一样。坦率地说，除非您已经在 c# 中有很多业务逻辑，或者如果您想在跨越 HTML 和 XAML 的 Win8 Metro 应用程序中重用一堆代码，否则这个 WinMD 的事情比它的价值更麻烦。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-08T09:31:05.717

根据[MSDN - Dev Center - Metro 风格的应用程序](http://msdn.microsoft.com/en-us/library/windows/apps/)，您可以使用`C#/VB/C++ and XAML`并`JavaScript and HTML5`开发 Metro 风格的应用程序（适用于 Windows8/WindowsPhone）。

# ruby-on-rails - Heroku 上的 H12 超时错误

> ID：11381946
> 
> 赞同：2
> 
> 时间：2012-07-08T09:10:43.327
> 
> 标签：ruby-on-rails, heroku, timeout

任何人都可以了解导致 Heroku 出现此超时错误的原因（2012-07-08T08:58:33+00:00）吗？文档说这是因为一些长期运行的过程。我已经`config.assets.initialize_on_precompile = false`在 config/application.rb 中设置了。

具体错误：

> 2012-07-08T08:58:33+00:00 heroku [路由器]：错误 H12（请求超时）-> GET codicology.co.uk/dyno=web.1 queue=wait= service=30000ms status=503 bytes= 0

完整日志：

```
EmBP-2:bc Emma$ heroku restart
Restarting processes... done
EmBP-2:bc Emma$ heroku logs --tail
2012-07-08T08:47:21+00:00 heroku[nginx]: 82.69.50.215 - - [08/Jul/2012:08:47:21 +0000] "GET /assets/application.js HTTP/1.1" 200 311723 "https://codicology.co.uk/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_6_8) AppleWebKit/534.52.7 (KHTML, like Gecko) Version/5.1.2 Safari/534.52.7" codicology.co.uk
2012-07-08T08:47:21+00:00 heroku[nginx]: 127.0.0.1 - - [08/Jul/2012:08:47:21 +0000] "GET /assets/application.js HTTP/1.0" 200 1311615 "https://codicology.co.uk/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_6_8) AppleWebKit/534.52.7 (KHTML, like Gecko) Version/5.1.2 Safari/534.52.7" codicology.co.uk
2012-07-08T08:51:32+00:00 heroku[slugc]: Slug compilation started
2012-07-08T08:54:05+00:00 heroku[api]: Release v145 created by emma@snowbooks.com
2012-07-08T08:54:05+00:00 heroku[api]: Deploy 8814b2f by emma@snowbooks.com
2012-07-08T08:54:05+00:00 heroku[web.1]: State changed from up to starting
2012-07-08T08:54:06+00:00 heroku[slugc]: Slug compilation finished
2012-07-08T08:54:09+00:00 heroku[web.1]: Stopping all processes with SIGTERM
2012-07-08T08:54:09+00:00 heroku[worker.1]: Stopping all processes with SIGTERM
2012-07-08T08:54:09+00:00 heroku[web.1]: Starting process with command `bundle exec unicorn -p 22429 -c ./config/unicorn.rb`
2012-07-08T08:54:10+00:00 app[worker.1]: [Worker(host:2046e0bf-e109-40f2-abdb-10f69d224483 pid:1)] Exiting...
2012-07-08T08:54:11+00:00 app[web.1]: I, [2012-07-08T08:54:11.320616 #1]  INFO -- : reaped #<Process::Status: pid 8 exit 0> worker=1
2012-07-08T08:54:11+00:00 app[web.1]: I, [2012-07-08T08:54:11.376765 #1]  INFO -- : master complete
2012-07-08T08:54:11+00:00 app[web.1]: I, [2012-07-08T08:54:11.376272 #1]  INFO -- : reaped #<Process::Status: pid 5 exit 0> worker=0
2012-07-08T08:54:12+00:00 app[web.1]: I, [2012-07-08T08:54:12.011695 #1]  INFO -- : worker=0 spawning...
2012-07-08T08:54:12+00:00 app[web.1]: I, [2012-07-08T08:54:12.011386 #1]  INFO -- : listening on addr=0.0.0.0:22429 fd=3
2012-07-08T08:54:12+00:00 app[web.1]: I, [2012-07-08T08:54:12.017917 #5]  INFO -- : worker=0 spawned pid=5
2012-07-08T08:54:12+00:00 app[web.1]: I, [2012-07-08T08:54:12.019309 #1]  INFO -- : master process ready
2012-07-08T08:54:12+00:00 app[web.1]: I, [2012-07-08T08:54:12.018250 #5]  INFO -- : Refreshing Gem list
2012-07-08T08:54:12+00:00 app[web.1]: I, [2012-07-08T08:54:12.016768 #1]  INFO -- : worker=1 spawning...
2012-07-08T08:54:12+00:00 app[web.1]: I, [2012-07-08T08:54:12.020863 #8]  INFO -- : Refreshing Gem list
2012-07-08T08:54:12+00:00 app[web.1]: I, [2012-07-08T08:54:12.020617 #8]  INFO -- : worker=1 spawned pid=8
2012-07-08T08:54:12+00:00 app[worker.1]:   SQL (2.9ms)  UPDATE "delayed_jobs" SET locked_by = null, locked_at = null WHERE (locked_by = 'host:2046e0bf-e109-40f2-abdb-10f69d224483 pid:1')
2012-07-08T08:54:12+00:00 heroku[web.1]: Process exited with status 0
2012-07-08T08:54:13+00:00 heroku[web.1]: State changed from starting to up
2012-07-08T08:54:14+00:00 heroku[worker.1]: Process exited with status 0
2012-07-08T08:54:14+00:00 heroku[worker.1]: State changed from up to down
2012-07-08T08:54:14+00:00 heroku[worker.1]: State changed from down to starting
2012-07-08T08:54:20+00:00 heroku[worker.1]: Starting process with command `bundle exec rake jobs:work`
2012-07-08T08:54:20+00:00 heroku[worker.1]: State changed from starting to up
2012-07-08T08:54:28+00:00 app[web.1]: DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0\. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from <top (required)> at /app/config/environment.rb:6)
2012-07-08T08:54:28+00:00 app[web.1]: DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0\. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from <top (required)> at /app/config/environment.rb:6)
2012-07-08T08:54:28+00:00 app[web.1]: DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0\. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from <top (required)> at /app/config/environment.rb:6)
2012-07-08T08:54:28+00:00 app[web.1]: DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0\. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from <top (required)> at /app/config/environment.rb:6)
2012-07-08T08:54:33+00:00 app[web.1]: Starting the New Relic Agent.
2012-07-08T08:54:33+00:00 app[web.1]: Starting the New Relic Agent.
2012-07-08T08:54:33+00:00 app[web.1]: Installed New Relic Browser Monitoring middleware
2012-07-08T08:54:33+00:00 app[web.1]: Installed New Relic Browser Monitoring middleware
2012-07-08T08:54:34+00:00 app[web.1]: 
2012-07-08T08:54:34+00:00 app[web.1]: 
2012-07-08T08:54:34+00:00 app[web.1]: [DEVISE] Devise.use_salt_as_remember_token is deprecated and has no effect. Please remove it.
2012-07-08T08:54:34+00:00 app[web.1]: 
2012-07-08T08:54:34+00:00 app[web.1]: [DEVISE] Devise.use_salt_as_remember_token is deprecated and has no effect. Please remove it.
2012-07-08T08:54:34+00:00 app[web.1]: 
2012-07-08T08:54:34+00:00 app[web.1]: /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.3/lib/action_dispatch/http/mime_type.rb:102: warning: already initialized constant XLSX
2012-07-08T08:54:34+00:00 app[web.1]: /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.3/lib/action_dispatch/http/mime_type.rb:102: warning: already initialized constant PDF
2012-07-08T08:54:34+00:00 app[web.1]: /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.3/lib/action_dispatch/http/mime_type.rb:102: warning: already initialized constant PDF
2012-07-08T08:54:34+00:00 app[web.1]: /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.3/lib/action_dispatch/http/mime_type.rb:102: warning: already initialized constant XLSX
2012-07-08T08:54:34+00:00 app[web.1]: /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.3/lib/action_dispatch/http/mime_type.rb:102: warning: already initialized constant PDF
2012-07-08T08:54:34+00:00 app[web.1]: /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.3/lib/action_dispatch/http/mime_type.rb:102: warning: already initialized constant PDF
2012-07-08T08:54:41+00:00 app[worker.1]: DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0\. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from <top (required)> at /app/Rakefile:10)
2012-07-08T08:54:41+00:00 app[worker.1]: DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0\. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from <top (required)> at /app/Rakefile:10)
2012-07-08T08:54:45+00:00 app[web.1]: [paperclip] Duplicate URL for csv with :s3_eu_url. This will clash with attachment defined in Importadvancecsv class
2012-07-08T08:54:45+00:00 app[web.1]: [paperclip] Duplicate URL for csv with :s3_eu_url. This will clash with attachment defined in Importpaymentcsv class
2012-07-08T08:54:45+00:00 app[web.1]: [paperclip] Duplicate URL for csv with :s3_eu_url. This will clash with attachment defined in Importpurchasecsv class
2012-07-08T08:54:45+00:00 app[web.1]: [paperclip] Duplicate URL for csv with :s3_eu_url. This will clash with attachment defined in Importadvancecsv class
2012-07-08T08:54:45+00:00 app[web.1]: [paperclip] Duplicate URL for csv with :s3_eu_url. This will clash with attachment defined in Importpaymentcsv class
2012-07-08T08:54:45+00:00 app[web.1]: [paperclip] Duplicate URL for csv with :s3_eu_url. This will clash with attachment defined in Importpurchasecsv class
2012-07-08T08:54:45+00:00 app[web.1]: [paperclip] Duplicate URL for csv with :s3_eu_url. This will clash with attachment defined in Importsalecsv class
2012-07-08T08:54:46+00:00 app[web.1]: [paperclip] Duplicate URL for csv with :s3_eu_url. This will clash with attachment defined in Profitarchive class
2012-07-08T08:54:46+00:00 app[web.1]: [paperclip] Duplicate URL for csv with :s3_eu_url. This will 
clash with attachment defined in Importsalecsv class
2012-07-08T08:54:46+00:00 app[web.1]: [paperclip] Duplicate URL for csv with :s3_eu_url. This will clash with attachment defined in Profitarchive class
2012-07-08T08:54:46+00:00 app[web.1]: [paperclip] Duplicate URL for xml with :s3_eu_url. This will clash with attachment defined in Onixarchive class
2012-07-08T08:54:47+00:00 app[web.1]: [paperclip] Duplicate URL for xml with :s3_eu_url. This will clash with attachment defined in Onixarchive class
2012-07-08T08:54:48+00:00 app[web.1]: I, [2012-07-08T08:54:48.467693 #8]  INFO -- : worker=1 ready
2012-07-08T08:54:48+00:00 app[web.1]: I, [2012-07-08T08:54:48.823800 #5]  INFO -- : worker=0 ready
2012-07-08T08:54:48+00:00 app[worker.1]: Starting the New Relic Agent.
2012-07-08T08:54:48+00:00 app[worker.1]: New Relic Agent not running.
2012-07-08T08:54:48+00:00 app[worker.1]: [Worker(host:1eabe514-7ec9-43b0-835b-ff3bd23bc266 pid:1)] New Relic Ruby Agent Monitoring DJ worker host:1eabe514-7ec9-43b0-835b-ff3bd23bc266 pid:1
2012-07-08T08:54:48+00:00 app[worker.1]: Installed New Relic Browser Monitoring middleware
2012-07-08T08:54:49+00:00 app[worker.1]: [Worker(host:1eabe514-7ec9-43b0-835b-ff3bd23bc266 pid:1)] Starting job worker
2012-07-08T08:57:54+00:00 heroku[web.1]: State changed from up to starting
2012-07-08T08:57:56+00:00 heroku[web.1]: Stopping all processes with SIGTERM
2012-07-08T08:57:57+00:00 app[web.1]: I, [2012-07-08T08:57:57.047386 #1]  INFO -- : reaped #<Process::Status: pid 5 exit 0> worker=0
2012-07-08T08:57:57+00:00 app[web.1]: I, [2012-07-08T08:57:57.047753 #1]  INFO -- : reaped #<Process::Status: pid 8 exit 0> worker=1
2012-07-08T08:57:57+00:00 app[web.1]: I, [2012-07-08T08:57:57.047999 #1]  INFO -- : master complete
2012-07-08T08:57:57+00:00 heroku[worker.1]: Stopping all processes with SIGTERM
2012-07-08T08:57:58+00:00 heroku[web.1]: Process exited with status 0
2012-07-08T08:57:58+00:00 app[worker.1]: [Worker(host:1eabe514-7ec9-43b0-835b-ff3bd23bc266 pid:1)] Exiting...
2012-07-08T08:57:59+00:00 heroku[web.1]: Starting process with command `bundle exec unicorn -p 29766 -c ./config/unicorn.rb`
2012-07-08T08:58:01+00:00 app[worker.1]:   SQL (27.9ms)  UPDATE "delayed_jobs" SET locked_by = null, locked_at = null WHERE (locked_by = 'host:1eabe514-7ec9-43b0-835b-ff3bd23bc266 pid:1')
2012-07-08T08:58:02+00:00 app[web.1]: I, [2012-07-08T08:58:02.070527 #1]  INFO -- : listening on addr=0.0.0.0:29766 fd=3
2012-07-08T08:58:02+00:00 app[web.1]: I, [2012-07-08T08:58:02.070782 #1]  INFO -- : worker=0 spawning...
2012-07-08T08:58:02+00:00 app[web.1]: I, [2012-07-08T08:58:02.074498 #1]  INFO -- : worker=1 spawning...
2012-07-08T08:58:02+00:00 app[web.1]: I, [2012-07-08T08:58:02.075702 #1]  INFO -- : master process ready
2012-07-08T08:58:02+00:00 app[web.1]: I, [2012-07-08T08:58:02.076732 #5]  INFO -- : worker=0 spawned pid=5
2012-07-08T08:58:02+00:00 app[web.1]: I, [2012-07-08T08:58:02.076957 #5]  INFO -- : Refreshing Gem list
2012-07-08T08:58:02+00:00 app[web.1]: I, [2012-07-08T08:58:02.089022 #8]  INFO -- : worker=1 spawned pid=8
2012-07-08T08:58:02+00:00 app[web.1]: I, [2012-07-08T08:58:02.089299 #8]  INFO -- : Refreshing Gem list
2012-07-08T08:58:02+00:00 heroku[worker.1]: Process exited with status 0
2012-07-08T08:58:02+00:00 heroku[worker.1]: State changed from up to down
2012-07-08T08:58:02+00:00 heroku[worker.1]: State changed from down to starting
2012-07-08T08:58:02+00:00 heroku[web.1]: State changed from starting to up
2012-07-08T08:58:10+00:00 heroku[worker.1]: Starting process with command `bundle exec rake jobs:work`
2012-07-08T08:58:11+00:00 heroku[worker.1]: State changed from starting to up
2012-07-08T08:58:28+00:00 app[worker.1]: DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0\. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from <top (required)> at /app/Rakefile:10)
2012-07-08T08:58:28+00:00 app[worker.1]: DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0\. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from <top (required)> at /app/Rakefile:10)
2012-07-08T08:58:33+00:00 heroku[router]: Error H12 (Request timeout) -> GET codicology.co.uk/ dyno=web.1 queue= wait= service=30000ms status=503 bytes=0
2012-07-08T08:58:33+00:00 heroku[nginx]: 127.0.0.1 - - [08/Jul/2012:08:58:33 +0000] "GET / HTTP/1.0" 503 601 "-" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_6_8) AppleWebKit/534.52.7 (KHTML, like Gecko) Version/5.1.2 Safari/534.52.7" codicology.co.uk
2012-07-08T08:58:33+00:00 heroku[nginx]: 82.69.50.215 - - [08/Jul/2012:08:58:33 +0000] "GET / HTTP/1.1" 503 601 "-" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_6_8) AppleWebKit/534.52.7 (KHTML, like Gecko) Version/5.1.2 Safari/534.52.7" codicology.co.uk
2012-07-08T08:58:42+00:00 app[worker.1]: New Relic Agent not running.
2012-07-08T08:58:42+00:00 app[worker.1]: [Worker(host:b5fa9243-6f9b-4de4-8f64-adab767fe4b0 pid:1)] New Relic Ruby Agent Monitoring DJ worker host:b5fa9243-6f9b-4de4-8f64-adab767fe4b0 pid:1
2012-07-08T08:58:42+00:00 app[worker.1]: Starting the New Relic Agent.
2012-07-08T08:58:42+00:00 app[worker.1]: Installed New Relic Browser Monitoring middleware
2012-07-08T08:58:43+00:00 app[worker.1]: [Worker(host:b5fa9243-6f9b-4de4-8f64-adab767fe4b0 pid:1)] Starting job worker
2012-07-08T08:58:56+00:00 app[web.1]: DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0\. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from <top (required)> at /app/config/environment.rb:6)
2012-07-08T08:58:56+00:00 app[web.1]: DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0\. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from <top (required)> at /app/config/environment.rb:6)
2012-07-08T08:58:56+00:00 app[web.1]: DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0\. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from <top (required)> at /app/config/environment.rb:6)
2012-07-08T08:58:56+00:00 app[web.1]: DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0\. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from <top (required)> at /app/config/environment.rb:6)
2012-07-08T08:59:02+00:00 app[web.1]: Starting the New Relic Agent.
2012-07-08T08:59:02+00:00 app[web.1]: Installed New Relic Browser Monitoring middleware
2012-07-08T08:59:02+00:00 app[web.1]: Starting the New Relic Agent.
2012-07-08T08:59:02+00:00 app[web.1]: Installed New Relic Browser Monitoring middleware
2012-07-08T08:59:03+00:00 app[web.1]: 
2012-07-08T08:59:03+00:00 app[web.1]: [DEVISE] Devise.use_salt_as_remember_token is deprecated and has no effect. Please remove it.
2012-07-08T08:59:03+00:00 app[web.1]: 
2012-07-08T08:59:03+00:00 app[web.1]: 
2012-07-08T08:59:03+00:00 app[web.1]: [DEVISE] Devise.use_salt_as_remember_token is deprecated and has no effect. Please remove it.
2012-07-08T08:59:03+00:00 app[web.1]: 
2012-07-08T08:59:04+00:00 app[web.1]: /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.3/lib/action_dispatch/http/mime_type.rb:102: warning: already initialized constant XLSX
2012-07-08T08:59:04+00:00 app[web.1]: /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.3/lib/action_dispatch/http/mime_type.rb:102: warning: already initialized constant PDF
2012-07-08T08:59:04+00:00 app[web.1]: /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.3/lib/action_dispatch/http/mime_type.rb:102: warning: already initialized constant PDF
2012-07-08T08:59:04+00:00 app[web.1]: /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.3/lib/action_dispatch/http/mime_type.rb:102: warning: already initialized constant XLSX
2012-07-08T08:59:04+00:00 app[web.1]: /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.3/lib/action_dispatch/http/mime_type.rb:102: warning: already initialized constant PDF
2012-07-08T08:59:04+00:00 app[web.1]: /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.3/lib/action_dispatch/http/mime_type.rb:102: warning: already initialized constant PDF
2012-07-08T08:59:22+00:00 app[web.1]: [paperclip] Duplicate URL for csv with :s3_eu_url. This will clash with attachment defined in Importadvancecsv class
2012-07-08T08:59:22+00:00 app[web.1]: [paperclip] Duplicate URL for csv with :s3_eu_url. This will clash with attachment defined in Importpaymentcsv class
2012-07-08T08:59:22+00:00 app[web.1]: [paperclip] Duplicate URL for csv with :s3_eu_url. This will clash with attachment defined in Importpurchasecsv class
2012-07-08T08:59:22+00:00 app[web.1]: [paperclip] Duplicate URL for csv with :s3_eu_url. This will clash with attachment defined in Importsalecsv class
2012-07-08T08:59:22+00:00 app[web.1]: [paperclip] Duplicate URL for csv with :s3_eu_url. This will clash with attachment defined in Profitarchive class
2012-07-08T08:59:23+00:00 app[web.1]: [paperclip] Duplicate URL for csv with :s3_eu_url. This will clash with attachment defined in Importadvancecsv class
2012-07-08T08:59:23+00:00 app[web.1]: [paperclip] Duplicate URL for csv with :s3_eu_url. This will clash with attachment defined in Importpaymentcsv class
2012-07-08T08:59:23+00:00 app[web.1]: [paperclip] Duplicate URL for csv with :s3_eu_url. This will clash with attachment defined in Importpurchasecsv class
2012-07-08T08:59:23+00:00 app[web.1]: [paperclip] Duplicate URL for csv with :s3_eu_url. This will clash with attachment defined in Importsalecsv class
2012-07-08T08:59:23+00:00 app[web.1]: [paperclip] Duplicate URL for csv with :s3_eu_url. This will clash with attachment defined in Profitarchive class
2012-07-08T08:59:23+00:00 app[web.1]: [paperclip] Duplicate URL for xml with :s3_eu_url. This will clash with attachment defined in Onixarchive class
2012-07-08T08:59:24+00:00 app[web.1]: [paperclip] Duplicate URL for xml with :s3_eu_url. This will clash with attachment defined in Onixarchive class
2012-07-08T08:59:25+00:00 app[web.1]: I, [2012-07-08T08:59:25.555052 #5]  INFO -- : worker=0 ready
2012-07-08T08:59:25+00:00 app[web.1]: 
2012-07-08T08:59:25+00:00 app[web.1]: 
2012-07-08T08:59:25+00:00 app[web.1]: Started GET "/" for 82.69.50.215 at 2012-07-08 08:59:25 +0000
2012-07-08T08:59:26+00:00 app[web.1]: Processing by PagesController#home as HTML
2012-07-08T08:59:26+00:00 app[web.1]: I, [2012-07-08T08:59:26.043501 #8]  INFO -- : worker=1 ready
2012-07-08T08:59:26+00:00 app[web.1]:   Rendered pages/home.html.haml within layouts/application (5.7ms)
2012-07-08T08:59:26+00:00 app[web.1]:    (1.1ms)  SELECT COUNT(*) FROM "delayed_jobs" 
2012-07-08T08:59:26+00:00 app[web.1]:   Rendered layouts/_header.html.erb (4.2ms)
2012-07-08T08:59:26+00:00 app[web.1]:   Rendered layouts/_footer.html.haml (1.4ms)
2012-07-08T08:59:26+00:00 app[web.1]: Completed 200 OK in 326ms (Views: 258.4ms | ActiveRecord: 65.2ms) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T03:40:19.577

> heroku[路由器]：错误 H12（请求超时）-> GET codicology.co.uk/dyno=web.1 queue=wait= service=30000ms status=503 bytes=0

`codicology.co.uk`您是否在应用程序部署期间加载了某些内容？例如加载一个托管在那里的自定义构建包？

如果我访问 codicology.co.uk，我会收到证书错误。也许您从 Heroku 运行的任何进程或请求都会收到证书错误，这也会阻止它正确连接，或者它可能因为错误而决定断开连接。

如果您可以向我们提供有关您正在尝试做什么或 codicology.co.uk 用于什么的更多信息（您拥有它吗？）也许我们可以提供更多帮助。

# java - 将 JSON 字符串序列化为对象

> ID：11381947
> 
> 赞同：0
> 
> 时间：2012-07-08T09:10:46.697
> 
> 标签：java, json, gson, pojo

我正在尝试解析 JSON 字符串并将其转换为以下 POJO：

```
package apicall;
//POJO representation of OAuthAccessToken
public class OAuthAccessToken {
    private String tokenType;
    private String tokenValue;
    public OAuthAccessToken(String tokenType,String tokenValue) {
        this.tokenType=tokenType;
        this.tokenValue=tokenValue;
    }

    public String toString() {
        return "tokenType="+tokenType+"\ntokenValue="+tokenValue;

    }

    public String getTokenValue() {
        return tokenValue;
    }

    public String getTokenType() {
        return tokenType;
    }

} 
```

为此，我编写了以下代码：

```
Gson gson=new Gson();
String responseJSONString="{\"access_token\" : \"2YotnFZFEjr1zCsicMWpAA\",\"token_type\" : \"bearer\"}";
OAuthAccessToken token=gson.fromJson(responseJSONString, OAuthAccessToken.class);
System.out.println(token); 
```

当我运行代码时，我得到以下输出：

```
tokenType=null
tokenValue=null

Instead of 
tokenType=bearer
tokenValue=2YotnFZFEjr1zCsicMWpAA 
```

我不明白我是否做错了什么。请帮忙。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T09:24:31.237

您可以通过注释您的字段来获得预期的结果，例如：

```
@SerializedName("token_type")
private final String tokenType;
@SerializedName("access_token")
private final String tokenValue; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T09:20:10.893

Gson 应该如何知道如何填充您的对象？您没有无参数构造函数，并且对象的字段与 JSON 对象中的字段不匹配。

使您的对象如下：

```
public class OAuthAccessToken {
    private String accessToken;
    private String tokenType;

    OAuthAccessToken() {
    }

    ...
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T09:22:17.797

该类应具有与 json 完全相同的字段名称，因此如果您的 json 有 2 个键：“access_token”和“token_type”，则该类应具有 2 个字段：

```
private String access_token;
private String token_type; 
```

而且，当然，您需要相应地更改 getter/setter。

# coronasdk - 在 Corona SDK 中，背景图像总是覆盖其他图像

> ID：11381949
> 
> 赞同：2
> 
> 时间：2012-07-08T09:11:03.030
> 
> 标签：coronasdk

我目前正在使用 Corona SDK 制作塔防游戏。然而，当我制作游戏场景时，背景场景总是覆盖怪物产卵，我试过`background:toBack()`了，但它不起作用。这是我的代码：

```
module(..., package.seeall)

function new()
    local localGroup = display.newGroup();

    local level=require(data.levelSelected);

    local currentDes = 1;

    monsters_list = display.newGroup()

    --The background
    local bg = display.newImage ("image/levels/1/bg.png");
    bg.x = _W/2;bg.y = _H/2;
    bg:toBack();

    --generate the monsters
    function spawn_monster(kind)
        local monster=require("monsters."..kind);
        newMonster=monster.new()
        --read the spawn(starting point) in level, and spawn the monster there
        newMonster.x=level.route[1][1];newMonster.y=level.route[1][2];
        monsters_list:insert(newMonster);
        localGroup:insert(monsters_list);
        return monsters_list;
    end

    function move(monster,x,y)
        -- Using pythagoras to calauate the moving distace, Hence calauate the time consumed according to speed
        transition.to(monster,{time=math.sqrt(math.abs(monster.x-x)^2+math.abs(monster.y-y)^2)/(monster.speed/30),x=x, y=y, onComplete=newDes})
    end

    function newDes()
        currentDes=currentDes+1;
    end

    --moake monster move according to the route
    function move_monster()
        for i=1,monsters_list.numChildren do
            move(monsters_list[i],200,200);
            print (currentDes);
        end 

    end

    function agent()
        spawn_monster("basic");
    end

    --Excute function above.
    timer2 = timer.performWithDelay(1000,agent,10);
    timer.performWithDelay(100,move_monster,-1);
        timer.performWithDelay(10,update,-1);
    move_monster();

    return localGroup;
end 
```

怪物只是停留在生成点并停留在那里。 ![在此处输入图像描述](../Images/fc1578e6d633693a7c6d53fac929e421.png)

但是，当我评论这 3 行代码时：

```
--local bg = display.newImage ("image/levels/1/bg.png");
--bg.x = _W/2;bg.y = _H/2;
--bg:toBack(); 
```

问题消失 ![在此处输入图像描述](../Images/9e99fe9556e0c0b7b1c17fc6cf44fac1.png)

有什么想法吗？谢谢你的帮助

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-08T10:45:56.193

由于您使用的是director，您应该将所有显示对象插入localGroup。您尚未将 bg 插入 localGroup。

SO director 类在插入 localGroup 后最后插入 bg。

将您的代码修改为

```
 --The background

    local bg = display.newImage (localGroup,"image/levels/1/bg.png");
    bg.x = _W/2;bg.y = _H/2;
    bg:toBack(); 
```

或添加代码

```
 localGroup:insert(bg) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-23T12:39:01.957

在最新版本的 Corona SDK 中：

> Composer 是 Corona SDK 中的官方场景（屏幕）创建和管理库...... Composer 库中的主要对象是`scene`对象......它包含一个独特的`self.view`......这`self.view`是您应该插入相关视觉元素的地方到现场。

所以现在在你的`scene:create()`方法中，你应该将所有 DisplayObjects 插入到`self.view`. 它看起来像这样：

```
local composer = require( "composer" )
local scene = composer.newScene()

function scene:create()

    local sceneGroup = self.view

    local bg = display.newImage( ...
    bg.x, bg.y = ...

    local dude = display.newImage( ...
    dude.x, dude.y = ....

    sceneGroup:insert(bg)
    sceneGroup:insert(dude)

end 
```

其中 DisplayObject 的分层`sceneGroup`取决于它们添加到组中的顺序，最后添加的对象在顶部。`toBack()`您可以使用和`toFront()`方法控制此排序。

# java - 在netty库中，我想知道如何根据cpu编号创建多个线程？

> ID：11381951
> 
> 赞同：0
> 
> 时间：2012-07-08T09:11:41.550
> 
> 标签：java, multithreading, netty

在netty库中，我想知道如何根据cpu编号创建多个线程？你能给我举个例子吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T08:08:22.563

假设您使用的是 nio，那么您可以在`NioServerSocketChannelFactory`or的构造函数中传递要使用的工作线程数`NioClientSocketChannelFactory`。如果您不指定值，则 Netty 默认为`(Runtime.getRuntime().availableProcessors() * 2)`工作线程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T09:23:14.120

我不知道netty中是否有关于多线程的具体内容。在 Java 中，您可以使用以下命令找到处理器的数量：

```
final int NUM_PROCESSORS = Runtime.getRuntime().availableProcessors(); 
```

然后，您可以使用执行程序创建该大小的线程池，例如：

```
final ExecutorService pool = Executors.newFixedThreadPool(NUM_PROCESSORS); 
```

# backbone.js - 如何通过 RequireJs 在 Backbone 中使用命名空间

> ID：11381955
> 
> 赞同：5
> 
> 时间：2012-07-08T09:12:25.827
> 
> 标签：backbone.js, namespaces, requirejs

我不确定如何在模块化（RequireJs）主干环境中使用命名空间。

我已经想过它会是什么样子，但我完全不确定这是否是正确的方法**。**

**app.js**（由 main.js 执行）

```
define('App', ['underscore', 'backbone', 'Router'], function( _, Backbone, Router){
    function initialize(){
        var app = {}; // app is the global namespace variable, every module exists in app

        app.router = new Router(); // router gets registered

        Backbone.history.start();
    }

    return { initialize: initialize }
}); 
```

**消息.js**

```
define('MessageModel', ['underscore', 'backbone', 'App'], function(_, Backbone, App){
    App.Message.Model; // registering the Message namespace with the Model class

    App.Message.Model = Backbone.Model.extend({
        // the backbone stuff
    });

    return App;
}); 
```

这是正确的方法还是我完全走错了路（如果是，请纠正我！）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-08T09:16:48.787

查看 TODO Backbone + requireJs 示例：

[https://github.com/addyosmani/todomvc](https://github.com/addyosmani/todomvc)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T12:35:55.010

使用开头文章中提到的命名空间找到了一个真实的示例应用程序：[https ://github.com/nrabinowitz/gapvis](https://github.com/nrabinowitz/gapvis)

只需要在接下来的几天里测试它

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-14T22:18:16.327

我是骨干新手，但只是从 requirejs 文档中阅读了一个片段。

> 模块与传统脚本文件的不同之处在于它定义了一个范围良好的对象，以避免污染全局命名空间。它可以显式列出其依赖项并获取这些依赖项的句柄，而无需引用全局对象，而是将依赖项作为定义模块的函数的参数接收。RequireJS 中的模块是模块模式的扩展，其好处是不需要全局变量来引用其他模块。

对我来说，这听起来好像在使用 requirejs 时，你可以忘记所有关于命名空间的事情，因为 requirejs 会处理它。您将只能以不同的方式访问它。当您想从另一个模块访问它时，您可以将文件的路径放在依赖项数组中，并将相应的变量提供给以下函数。

```
define(["folder/a-script", "folder/another-script"], function(AScript, AnotherScript) {
        // In here the scripts are loaded and can be used, but are called by
        // their relative name in the anonymous function.
    }
); 
```

无论如何，也许在某些情况下仍然需要命名某些东西，但我认为总的来说，值得[阅读文档](http://requirejs.org/docs/api.html)以查看是否需要。

# c# - 依赖 AppDomain.IsDefaultAppDomain()

> ID：11381957
> 
> 赞同：1
> 
> 时间：2012-07-08T09:12:45.497
> 
> 标签：c#, .net, nunit, appdomain

*我有一个组件，它应该只*在主 AppDomain 上以某种方式初始化。

在其他 AppDomain 上，它被初始化为位于主 appdomain 中的对象的代理。

该组件使用 AppDomain.Current.IsDefaultAppDomain() 来确定它是否在主 appdomain 上。

我的问题是，在运行单元测试 (NUnit) 时，此方法返回 false，因为测试运行程序在不同的应用程序域中初始化我的测试类，导致测试行为不正确。

如何解决？

# python - 操作数应包含 1 列关于插入和选择

> ID：11381958
> 
> 赞同：2
> 
> 时间：2012-07-08T09:12:53.800
> 
> 标签：python, mysql

```
"insert into NodeProfileSections (profile_no, tpl_section_no) 
select (np.profile_no, tps.tpl_section_no)
from NodeProfile np, TemplateProfileSection tps, TemplateProfile tp 
where np.hostname = '%s' AND np.role = '%s' AND tp.tpl_profile_no = tps.tpl_profile_no 
AND tp.tpl_name = '%s' AND tp.role = '%s' AND tps.tpl_section_name = '%s';" 
%(hostname, role, template_name, role, section_name) 
```

`error_message = 'Operand should contain 1 column(s)'`

如何解决这个问题呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-08T09:21:37.883

从您的内部选择中删除括号。

```
q = """INSERT INTO 
             NodeProfileSections (profile_no,tpl_section_no)
       SELECT
             np.profile_no
             ,tps.tpl_section_no
       FROM
             NodeProfile np
             ,TemplateProfileSection tps
             ,TemplateProfile tp
       WHERE
             np.hostname = '%s'
             AND np.role = '%s'
             AND tp.tpl_profile_no = tps.tpl_profile_no
             AND tpl.tpl_name = '%s'
             AND tp.role = '%s'
             AND tps.tpl_section_name = '%s'
""" 
```

# php - empty() 不适用于 codeigniter 输入类

> ID：11381959
> 
> 赞同：0
> 
> 时间：2012-07-08T09:13:10.633
> 
> 标签：php, codeigniter, post

这真的很奇怪。每当我打电话给像

```
if(empty($this->input->post("foo")){//blabla} 
```

整个 PHP 都“关闭”了，我从网站上得到一个空白页面（即使我没有通过这个空（输入）行）。

我知道这不是正确的方法而且很愚蠢，我将代码更改为

```
if(!$this->input->post("foo")){//blabla} 
```

我猜更好？

说真的，empty(input) 怎么会破坏整个 PHP 页面？（我无法得到任何回声“某物”）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T09:18:19.190

从[手册](http://php.net/manual/en/function.empty.php)：

> ***注意***：
> 
> empty() 仅检查**变量**，因为其他任何内容都会导致解析错误。换句话说，以下内容将不起作用：empty(trim($name))。

更新：从 php 5.5 开始，empty() 也支持表达式。

> 变更日志：
> 
> 5.5.0 empty() 现在支持表达式，而不仅仅是变量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-08T09:16:04.503

您不能使用`empty`with 函数，也不需要使用。`empty`是一个特殊的结构，只对变量起作用，否则会触发致命错误。请参阅[isset 和 empty 的权威指南](http://kunststube.net/isset/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-08T10:40:26.633

您不需要在输入类中使用空，因为如果 post 变量不存在或包含空值输入类返回 false，这会自动使 if 条件失败，并且您的 else 块将起作用...

# android - Android全局变量在服务中不起作用

> ID：11381966
> 
> 赞同：7
> 
> 时间：2012-07-08T09:14:35.250
> 
> 标签：android, global-variables

我很困惑为什么我不能从我的服务访问我的全局变量。我可以从其他活动中访问它们就好了....

全局变量类：

```
public class Global extends Application {
private static final String TAG = "Global Class";

int test;     

public int getTest()
{
    return test;
} 
```

主要活动我使用这个测试代码：

```
Global appState = ((Global)getApplication()); //Context());
appState.setTest(555);
Log.e("SETTEST",new Integer(appState.getTest()).toString()); 
```

结果是 555

我使用相同代码的另一项活动：

```
Global appState = ((Global)getApplication()); //Context());
Log.e("SETTEST",new Integer(appState.getTest()).toString()); 
```

结果是 555

最后在我的服务中，我使用与上面相同的代码：

```
Global appState = ((Global)getApplication()); //Context());
Log.e("SETTEST",new Integer(appState.getTest()).toString()); 
```

我变大了，胖0回来了。

请帮忙。到目前为止，我已经在这上面花了 3 个小时。我试过使用 getApplication 和 getApplicationContext

此外，清单看起来像这样：

```
...
<application android:icon="@drawable/signal" android:label="@string/app_ name" android:name="<absolute path>.util.Global">

<service
    android:name=".util.MyService"
    android:process=":MyService" 
    android:icon="@drawable/airplane"
    android:label="@string/service_name"
    >
</service> 
```

**根据这篇文章，我也尝试过使用单例类。与上述相同的麻烦：

[Android - 全局变量？](https://stackoverflow.com/questions/8658980/android-global-variables?rq=1)

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-07-08T09:35:44.587

您的服务正在远程运行，因为您有这个：

```
android:process=":MyService" 
```

在服务的清单定义中。

这意味着它正在运行一个完全独立的进程。您不能以这种方式使用静态变量共享全局变量。

如果您不需要您的服务在单独的进程中运行，那么只需删除“android:process”行就可以了。

# python - Python 中的单元测试对象 - 设置中不会覆盖对象

> ID：11381968
> 
> 赞同：5
> 
> 时间：2012-07-08T09:15:09.137
> 
> 标签：python, unit-testing, unittest2

我正在使用 Python 对类进行单元测试`unittest`。据我了解，在每次测试之前`unittest`调用该`setUp`函数，以便单元测试对象的状态相同并且执行测试的顺序无关紧要。

现在我有这门课我正在测试......

```
#! usr/bin/python2

class SpamTest(object):

    def __init__(self, numlist = []):
        self.__numlist = numlist

    @property
    def numlist(self):
        return self.__numlist

    @numlist.setter
    def numlist(self, numlist):
        self.__numlist = numlist

    def add_num(self, num):
        self.__numlist.append(num)

    def incr(self, delta):
        self.numlist = map(lambda x: x + 1, self.numlist)

    def __eq__(self, st2):
        i = 0
        limit = len(self.numlist)

        if limit != len(st2.numlist):
            return False

        while i < limit:
            if self.numlist[i] != st2.numlist[i]:
                return False

            i += 1

        return True 
```

通过以下单元测试...

```
#! usr/bin/python2

from test import SpamTest

import unittest

class Spammer(unittest.TestCase):

    def setUp(self):
        self.st = SpamTest()
        #self.st.numlist = [] <--TAKE NOTE OF ME!
        self.st.add_num(1)
        self.st.add_num(2)
        self.st.add_num(3)
        self.st.add_num(4)

    def test_translate(self):
        eggs = SpamTest([2, 3, 4, 5])
        self.st.incr(1)
        self.assertTrue(self.st.__eq__(eggs))

    def test_set(self):
        nl = [1, 4, 1, 5, 9]
        self.st.numlist = nl
        self.assertEqual(self.st.numlist, nl)

if __name__ == "__main__":
    tests = unittest.TestLoader().loadTestsFromTestCase(Spammer)
    unittest.TextTestRunner(verbosity = 2).run(tests) 
```

此测试对 test_translate 失败。

我可以做两件事来使测试成功：

(1) 取消setUp函数第二行的注释。或者，

(2) 更改`translate`首先发生的测试的名称。我注意到`unittest`按字母顺序执行测试。`translate`例如，更改为`atranslate`使其首先执行会使所有测试成功。

对于 (1)，我无法想象这会如何影响测试，因为在 的第一行`setUp`，我们为 self.st 创建了一个新对象。至于（2），我的抱怨是相似的，因为，嘿，`setUp`我分配了一个新对象，`self.st`所以无论我做什么都不应该影响`self.st`.`test_set``test_translate`

那么，我在这里缺少什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-08T09:41:47.717

在不研究解决方案的细节的情况下，您应该阅读Fredrik Lundh[的 Python 中的默认参数值。](http://effbot.org/zone/default-values.htm)

它很可能解释了您将*空列表*作为默认参数的问题。原因是列表仅在第一次为空，除非您稍后明确将其设为空。初始为空的默认列表是列表类型的单个实例，在没有传递显式参数时会被重用。

阅读上述文章以解决您对默认参数的想法是个好主意。原因是合乎逻辑的，但可能出乎意料。

一般推荐的修复方法是使用`None`默认值，`__init__`如果没有传递参数，则在正文中设置空列表，如下所示：

```
class SpamTest(object):

    def __init__(self, numlist=None):
        if numlist is None:
            numlist = []         # this is the new instance -- the empty list
        self.__numlist = numlist 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-08T09:38:19.937

这是由于使用可变对象（如列表）时默认参数在 Python 中的行为方式：[Python 中的默认参数值](http://effbot.org/zone/default-values.htm)。

在行中：

```
def __init__(self, numlist = []): 
```

numlist 的默认参数仅评估一次，因此您只有一个列表实例，该实例在`SpamTest`类的所有实例中共享。

因此，即使`setUp`每次测试都调用该测试，它也不会创建一个新的空列表，并且您在该列表实例上工作的测试最终会相互踩踏。

解决方法是使用像这样的非可变对象，例如`None`：

```
def __init__(self, numlist = None):
    if numlist is None:
        numlist = []
    self.__numlist = numlist 
```

* * *

设置属性时它起作用的原因是您在那里提供了一个全新的空列表，替换了在构造函数中创建的列表。

# php - 如果输入的数据是键或值，则检查并从关联数组返回键

> ID：11381976
> 
> 赞同：0
> 
> 时间：2012-07-08T09:16:34.363
> 
> 标签：php, arrays, key-value

我从一个我无法控制的数据库中获取信息。“状态”的值是用户输入（并正确清理）的值，但可能是写出的州名称或两个字母的邮政缩写。我可以轻松构建状态和缩写的关联数组。但我想知道是否有一种方法，PHP，可以确定一个值是否在 states/abbrev 数组中作为**key** OR a **value**。因此，如果您输入“CA”，它会看到它是一个有效的两个字母**密钥**并返回它。如果它看到“XY”不是一个有效的**键**，那么它会返回一个默认的“OTHER”键（ZZ），但是如果用户输入的输入是“New York”，它会看到它是一个有效的**值**并返回相关的键，“纽约”？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T09:37:24.250

```
$userInput; // Your user's input, processed using regex for capitals, etc to match DB values for the strings of the states.
// Otherwise, do your comparisons in the conditions within the loop to control for mismatching capitals, etc.

$output = false;

foreach ($stateArray as $abbreviation => $full) // Variable $stateArray is your list of Abbreviation => State Name pairs.
{
    if ($userInput == $abbreviation || $userInput == $full) // Use (strtolower($userInput) == strtolower($abbreviation) || strtolower($userInput) == strtolower($full)) to change all the comparison values to lowercase.
    // This is one example of processing the strings in a way to ensure some flexibility in the user input.
    // However, whatever processing you need to do is determined by your needs.
    {
        $output = array($abbreviation => $full); // If you want a key => value pair, use this.
        $output = $abbreviation; // If you only want the key, use this instead.
        break;
    }
}

if ($output === false)
{
    $output = array("ZZ" => "OTHER"); // If you want a key => value pair, use this.
    $output = "ZZ"; // If you only want the key, use this instead.
} 
```

编辑：我已经更改了循环，以便它在一个条件下检查用户输入与缩写和完整状态名称，而不是将它们分开。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T09:29:49.720

用状态和缩写创建一个数组：

```
$array = array("new york" => "ny", "california" => "ca", "florida" => "fl", "illinois" => "il"); 
```

检查输入：

```
$input = "nY";
if(strlen($input) == 2) // it's an abbreviation
{
    $input = strtolower($input); // turns "nY" into "ny"
    $state = array_search($input, $array);
    echo $state; // prints "new york"
    echo ucwords($state); // prints "New York"
}

// ----------------------------------------------------//

$input = "nEw YoRk";
if(strlen($input) > 2) // it's a full state name
{
    $input = strtolower($input); // turns "nEw YoRk" into "new york"
    $abbreviation = $array[$input];
    echo $abbreviation; // prints "ny";
    echo strtoupper($abbreviation); // prints "NY"
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-08T09:37:53.183

```
$array = array("New York" => "NY", 
"California" => "CA", 
"Florida" => "FL", 
"Illinois" => "IL");

$incoming = "New York";

if(  in_array($incoming, $array) || array_key_exists($incoming, $array)){

echo "$incoming is valid";

} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-08T09:37:29.143

```
if (!isset($array[$input]))
{
  // swap it
  $temp = array_flip($array);

  if (isset($temp[$input]))
  {
    echo 'Got it as abbreviation!';
  }
  else
  {
    echo 'NO Match';
  }
}
else
{
    echo 'Got it as state!';
} 
```

# visual-studio - CMake项目包括更多文件？

> ID：11381978
> 
> 赞同：0
> 
> 时间：2012-07-08T09:16:35.650
> 
> 标签：visual-studio, opencv, cmake

基本上我有一个文件夹`/myOpenCVProject/`

我在哪里：

```
header.hpp
main.cpp
helper.cpp 
```

和 CMakeLists.txt

```
SET( PROJECT_NAME myOpenCVProject )
PROJECT( ${PROJECT_NAME} )
CMAKE_MINIMUM_REQUIRED(VERSION 2.8)
FIND_PACKAGE( OpenCV REQUIRED )
ADD_EXECUTABLE( ${PROJECT_NAME} main.cpp )
TARGET_LINK_LIBRARIES( ${PROJECT_NAME} ${OpenCV_LIBS} ) 
```

我如何告诉 CMake 也包含`header`和`helper`文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T11:06:36.943

您只需将它们包含在`ADD_EXECUTABLE`命令中：

```
ADD_EXECUTABLE( ${PROJECT_NAME} main.cpp helper.cpp header.hpp) 
```

有关完整的详细信息`ADD_EXECUTABLE`，请运行

```
cmake --help-command add_executable 
```

# php - PHP 猜字游戏（高亮字母在正确和错误的位置 - 像策划者）

> ID：11381981
> 
> 赞同：9
> 
> 时间：2012-07-08T09:17:10.427
> 
> 标签：php

抱歉标题太长了。
希望它尽可能具有描述性。

*免责声明：可以在 Stackoverflow 上和其他地方找到一些“查找差异”代码，但不是我正在寻找的功能。*

**稍后我将使用这些术语：**
**'userguess'**：用户将输入的单词
**'solution'**：需要猜测的秘密单词。

# 我需要创建什么

一个猜词游戏，其中：

*   用户输入一个单词（我将通过 Javascript/jQuery 确保输入的单词包含与要猜测的单词相同数量的字母）。

*   然后，一个 PHP 函数检查“用户猜测”并突出显示（绿色）该单词中位于正确位置的字母，并突出显示（红色）尚未在正确位置但确实出现在其他地方的字母在这个词中。
    未出现在“解决方案”中的字母将保持黑色。

**陷阱场景**：-假设“解决方案”是 **“aabbc”**，而用户猜测**“abaac”**
在上述场景中，这将导致：（绿色）**a**（/green）（red）**b**（/red）（red）**a** (/red)(black) **a** (/black)(green) **c** (/green)
注意最后一个“ **a** ”是黑色的，因为“userguess”有 3 个**a**，而“solution”只有 2 个

# 到目前为止我所拥有的

代码或多或少都在工作，但我感觉它可以精简 10 倍。
*我正在填充 2 个新数组（一个用于解决方案，一个用于用户猜测），以防止陷阱（见上文）搞砸。*

```
 function checkWord($toCheck) {
        global $solution;      // $solution word is defined outside the scope of this function
        $goodpos = array();    // array that saves the indexes of all the right letters in the RIGHT position
        $badpos  = array();    // array that saves the indexes of all the right letters in the WRONG position
        $newToCheck = array(); // array that changes overtime to help us with the Pitfall (see above)
        $newSolution = array();// array that changes overtime to help us with the Pitfall (see above)

        // check for all the right letters in the RIGHT position in entire string first
        for ($i = 0, $j = strlen($toCheck); $i < $j; $i++) {
           if ($toCheck[$i] == $solution[$i]) {
               $goodpos[] = $i;
               $newSolution[$i] = "*"; // RIGHT letters in RIGHT position are 'deleted' from solution
           } else {
               $newToCheck[] = $toCheck[$i]; 
               $newSolution[$i] = $solution[$i];
           }
        }

        // go over the NEW word to check for letters that are not in the right position but show up elsewhere in the word
        for ($i = 0, $j = count($newSolution); $i <= $j; $i++) {
           if (!(in_array($newToCheck[$i], $newSolution))) {
               $badpos[] = $i;
               $newSolution[$i] = "*";
           } 
        }

        // use the two helper arrays above 'goodpos' and 'badpos' to color the characters
        for ($i = 0, $j = strlen($toCheck), $k = 0; $i < $j; $i++) {
            if (in_array($i,$goodpos)) {
                $colored .= "<span class='green'>";
                $colored .= $toCheck[$i];
                $colored .= "</span>";
            } else if (in_array($i,$badpos)) {
                $colored .= "<span class='red'>";
                $colored .= $toCheck[$i];
                $colored .= "</span>";
            } else {
                $colored .= $toCheck[$i];   
            }
        }

        // output to user
        $output  = '<div id="feedbackHash">';
        $output .= '<h2>Solution was : &nbsp;' . $solution . '</h2>';
        $output .= '<h2>Color corrected: ' . $colored . '</h2>';
        $output .= 'Correct letters in the right position : ' . count($goodpos) . '<br>';
        $output .= 'Correct letters in the wrong position : ' . count($badpos)  . '<br>';
        $output .= '</div>';

        return $output;
    } // checkWord 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T09:59:46.097

好问题。我可能会对你做些不同的事情:)（我想这就是你所希望的！）

您可以在这里找到我的完整解决方案功能[http://ideone.com/8ojAG](http://ideone.com/8ojAG) - 但我也将逐步分解它。

首先，请尽量避免使用`global`. 没有理由不能将函数定义为：

`function checkWord($toCheck, $solution) {`

您可以将解决方案传递给以后避免潜在的麻烦。

我首先将用户猜测和解决方案拆分为数组，并使用另一个数组来存储我的输出。

```
$toCheck = str_split($toCheck, 1);
$solution = str_split($solution, 1);
$out = array(); 
```

在该过程的每个阶段，我都会从用户猜测或解决方案中删除已被识别为正确或不正确的字符，因此我不需要以任何方式标记它们，并且函数的其余阶段运行更有效率。

所以要检查匹配。

```
foreach ($toCheck as $pos => $char) {
    if ($char == $solution[$pos]) {
        $out[$pos] = "<span class=\"green\">$char</span>";
        unset($toCheck[$pos], $solution[$pos]);
    }
} 
```

因此，对于您的示例猜测/解决方案，`$out`现在在位置 0 处包含绿色“a”，在位置 4 处包含绿色 c。猜测和解决方案都不再具有这些索引，并且不会再次检查。

检查存在但位置错误的字母的类似过程。

```
foreach ($toCheck as $pos => $char) {
    if (false !== $solPos = array_search($char, $solution)) {
        $out[$pos] = "<span class=\"red\">$char</span>";
        unset($toCheck[$pos], $solution[$solPos]);
    }
} 
```

在这种情况下，我们在解决方案中搜索猜测的字母，如果找到则将其删除。我们不需要计算出现的次数，因为我们会删除字母。

最后，用户猜测中剩下的唯一字母是解决方案中根本不存在的字母，并且由于我们始终保持编号索引，我们可以简单地将剩余的字母合并回去。

`$out += $toCheck;`

差不多好了。`$out`有我们需要的一切，但顺序不正确。即使索引是数字的，它们也没有排序。我们完成了：

```
ksort($out);
return implode($out); 
```

结果是：

`"<span class="green">a</span><span class="red">b</span><span class="red">a</span>a<span class="green">c</span>"`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T10:33:19.390

来试试这个`**[See In Action](http://codepad.org/Yv5SW0RB)**`

示例输出：![在此处输入图像描述](../Images/b1706fdbcf09aa477a1438b5092e00d8.png)

```
<?php 
echo checkWord('aabbc','abaac').PHP_EOL;
echo checkWord('funday','sunday').PHP_EOL;
echo checkWord('flipper','ripple').PHP_EOL;
echo checkWord('monkey','kenney').PHP_EOL;

function checkWord($guess, $solution){
    $arr1 = str_split($solution);
    $arr2 = str_split($guess);
    $arr1_c = array_count_values($arr1);
    $arr2_c = array_count_values($arr2);
    $out = '';
    foreach($arr2 as $key=>$value){
        $arr1_c[$value]=(isset($arr1_c[$value])?$arr1_c[$value]-1:0);
        $arr2_c[$value]=(isset($arr2_c[$value])?$arr2_c[$value]-1:0);

        if(isset($arr2[$key]) && isset($arr1[$key]) && $arr1[$key] == $arr2[$key]){
            $out .='<span style="color:green;">'.$arr2[$key].'</span>';
        }elseif(in_array($value,$arr1) && $arr2_c[$value] >= 0 && $arr1_c[$value] >= 0){
            $out .='<span style="color:red;">'.$arr2[$key].'</span>';
        }else{
            $out .='<span style="color:black;">'.$arr2[$key].'</span>';
        }
    }
    return $out;
}
?> 
```

# android - 如何在 TimePicker 中设置 AM/PM？

> ID：11381985
> 
> 赞同：26
> 
> 时间：2012-07-08T09:18:19.023
> 
> 标签：android, android-timepicker

我在我的应用程序中使用 TimePicker。每当用户使用 TimePicker 打开屏幕时，我都会使用当前时间对其进行初始化。当我这样做时，TimePicker 显示 AM 而不是 PM。为什么会这样？有什么我必须在我的代码中添加的吗？

```
Date initDate = m_NoteManageObject.getDateTimeArray(position);
Calendar myCal = Calendar.getInstance();

myCal.setTime(initDate);
TimePicker timePicker  = (TimePicker)layout.findViewById(R.id.time_picker);

// Initialise Time Picker

timePicker.setCurrentHour(myCal.get(Calendar.HOUR));
timePicker.setCurrentMinute(myCal.get(Calendar.MINUTE)); 
```

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-07-08T10:38:48.247

您必须使用`Calendar.HOUR_OF_DAY`而不是`Calendar.HOUR`.

即，`timePicker.setCurrentHour()`始终需要 24 小时格式的参数。不幸的是，API 文档中没有正确记录这一事实。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-06-28T07:31:37.393

```
public void onTimeSet(TimePickerDialog view, int hourOfDay, int minute) {
    if(hourOfDay>=0 && hourOfDay<12){
        time = hourOfDay + " : " + minute + " AM";
    } else {
        if(hourOfDay == 12){
            time = hourOfDay + " : " + minute + "PM";
        } else{
            hourOfDay = hourOfDay -12;
            time = hourOfDay + " : " + minute + "PM";
        }
    }

    deliveryTime.setText(time);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-08T09:23:39.857

我认为您必须覆盖 Timepicker 的 onTimeSet() 方法。检查此链接

[TimePickerDialog 和 AM 或 PM](https://stackoverflow.com/questions/2659954/timepickerdialog-and-am-or-pm)

可以帮到你..

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-09-01T06:56:00.817

首先，获取`Calendar`类的实例，然后使用`HOUR_OF_DAY`获取小时。`HOUR_OF_DAY`将采用 24 小时格式，因此只需将其分配给一个变量，然后检查该 int 是否大于`0`和小于`12`。如果此条件为真，则 append `AM`or else `PM`。因为`HOUR_OF_DAY`是 24 小时格式，PM 小时数将显示为`13,14`这样来处理这个问题，只需减去`HOUR_OF_DAY`by `12`。这是代码：

```
Calendar calendar = Calendar.getInstance();
int hour = calendar.get(Calendar.HOUR_OF_DAY);
if (hour < 12 && hour >= 0) {
    tv.setText(hour + " AM");
} else {
    hour -= 12;
    if(hour == 0) {
        hour = 12;
    }
    tv.setText(hour + " PM");
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-09-01T06:34:59.927

试试这个 ：

```
 Calendar calendar = Calendar.getInstance();
            calendar.set(0, 0, 0, hourOfDay, minute, 0);
            long timeInMillis = calendar.getTimeInMillis();
            java.text.DateFormat dateFormatter = new SimpleDateFormat("hh:mm a");
            Date date = new Date();
            date.setTime(timeInMillis);
            time.setText(dateFormatter.format(date)); 
```

# django - 将 Django 应用程序部署到 Heroku 时出现 pip 问题

> ID：11381989
> 
> 赞同：2
> 
> 时间：2012-07-08T09:18:36.713
> 
> 标签：django, deployment, heroku

我在尝试将我的 Django 应用程序部署到 Heroku 时遇到问题。

它抱怨安装 facebook-sdk 库的问题，但实际上`requirements.txt`文件中没有这样的东西。

我已经尝试用`-f`标志推送，我注释掉了 requirements.txt 中的行。我什至推送了一个空的需求文件，但问题仍然存在。

我不知道除了创建一个新的应用程序或heroku的repo之外是否有任何方法可以重置？有什么我可以尝试的想法吗？

**控制台日志：**

```
$ git push prod master
Counting objects: 52282, done.
Delta compression using up to 8 threads.
Compressing objects: 100% (17957/17957), done.
Writing objects: 100% (52282/52282), 138.01 MiB | 137 KiB/s, done.
Total 52282 (delta 33410), reused 48501 (delta 30768)

-----> Heroku receiving push
-----> Python/Django app detected
-----> Preparing Python interpreter (2.7.2)
-----> Creating Virtualenv version 1.7
       New python executable in .heroku/venv/bin/python2.7
       Also creating executable in .heroku/venv/bin/python
       Installing distribute.............................................................................................................................................................................................done.
       Installing pip...............done.
       Running virtualenv with interpreter /usr/local/bin/python2.7
-----> Activating virtualenv
-----> Installing dependencies using pip version 1.0.2
error: The requested URL returned error: 401 while accessing http://github.com/facebook/python-sdk.git/info/refs

fatal: HTTP request failed
       Downloading/unpacking paramiko (from -r requirements.txt (line 17))
       Creating supposed download cache at /app/tmp/repo.git/.cache/pip_downloads
         Storing download in cache at /app/tmp/repo.git/.cache/pip_downloads/http%3A%2F%2Fpypi.python.org%2Fpackages%2Fsource%2Fp%2Fparamiko%2Fparamiko-1.7.7.2.zip
         Running setup.py egg_info for package paramiko

       Obtaining facebook-sdk from git+http://github.com/facebook/python-sdk.git#egg=facebook-sdk (from -r requirements.txt (line 23))
         Cloning http://github.com/facebook/python-sdk.git to ./.heroku/src/facebook-sdk
         Complete output from command /usr/bin/git clone -q http://github.com/facebook/python-sdk.git /tmp/build_1bn5oykhrmms7/.heroku/src/facebook-sdk:

       ----------------------------------------
       Command /usr/bin/git clone -q http://github.com/facebook/python-sdk.git /tmp/build_1bn5oykhrmms7/.heroku/src/facebook-sdk failed with error code 128
       Storing complete log in /app/.pip/pip.log
 !     Heroku push rejected, failed to compile Python/django app 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-09T21:22:40.600

正确的解决方案是“Maxime R.”关于[如何在 heroku cedar 堆栈上使用 virtualenv 进行 pip 卸载的解决方案？](https://stackoverflow.com/questions/8937905/how-to-pip-uninstall-with-virtualenv-on-heroku-cedar-stack/11055852#comment14662980_11055852)

> heroku 实验室：启用 user_env_compile heroku 配置：添加 CLEAN_VIRTUALENV=true
> 
> 目前这不起作用，因为有一个错误。在上游修复之前，您需要使用我的 buildpack 分支：
> 
> heroku 配置：添加 BUILDPACK_URL=git@github.com:blaze33/heroku-buildpack-python.git
> 
> 现在推送你的新代码，你会注意到整个 virtualenv 都被重新安装了。
> 
> 自 2012 年 3 月 23 日以来，Andrey 的回答不再有效。新风格的 virtualenv 提交将虚拟 env 从 /app 移动到 /app/.heroku/venv 但 purge 分支没有更新以赶上，所以你最终得到一个 virtualenv 不是在 PYTHONHOME 中。

经过几次尝试使用 heroku run 命令后，我终于成功应用了 Maxime R. 解决方案。此外，我已打开 Heroku 票证，并且已向我确认 Heroku 支持是解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-08T10:29:17.797

发生这种情况是因为您为 python-SDK 的库（[http://github.com/facebook/python-sdk.git](http://github.com/facebook/python-sdk.git)）使用了一个空存储库，请尝试使用另一个存储库：[https ://github.com/pythonforfacebook/facebook- sdk](https://github.com/pythonforfacebook/facebook-sdk)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-15T17:22:34.543

我已经从虚拟 env 和 requirements.txt 中删除了两个包，并且暂时更改 Python 运行时（如此[处](https://stackoverflow.com/questions/8937905/how-to-pip-uninstall-with-virtualenv-on-heroku-cedar-stack/15087542#15087542)建议）是我发现的唯一允许我从 heroku 卸载这些包的方法。

# database - 为定价系统创建数据库的更好方法

> ID：11381990
> 
> 赞同：1
> 
> 时间：2012-07-08T09:18:53.037
> 
> 标签：database, asp.net-mvc-3, database-design

我需要创建一个价格表系统，所以我将在我的数据库中创建这三个表。

*   定价表`(ID, Name, ServiceID, Style)`
*   定价表套餐`(ID, PricingTable_ID, Title, Price, PricePerTime, Info, Flag, Link)`
*   定价表包功能`(ID, PricingTablePackages_ID, Feature, Value, MoreInfo)`

在这里，一个`PriceTable`可以容纳多于一个`PricingTablePackages`，一个`PricingTablePackage`可以容纳多个多于一个`PricingTablePackagesFeature`。

有什么方法可以设计出更好的模型吗？在单个数据库表中？

我将为这些表创建一个 MVC3 模型，那么在 MVC3 模型中执行这种数据库表的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T17:44:31.267

当您使用实体框架需要它们时，我会使用公共虚拟变量来“延迟加载”值：

（变量类型可能会关闭，具体取决于您对每个变量的确切要求）

```
public class PricingTablePackages
{
    public int ID { get; set; }

    public int PricingTableID { get; set; }

    public virtual PricingTable PricingTable { get; set; }

    public string Title { get; set; }

    public decimal Price { get; set; }

    public decimal PricePerTime { get; set; }

    public string Info { get; set; }

    public bool Flag { get; set; }

    public string Link { get; set; }
}

public class PricingTablePackagesFeatures
{
    public int ID { get; set; }

    public int PricingTableID { get; set; }

    public virtual PricingTable PricingTable { get; set; }

    public string Feature { get; set; }

    public string Value { get; set; }

    public string MoreInfo { get; set; }
}

public class PricingTable
{
    public int ID { get; set; }

    public string Name { get; set; }

    public int ServiceID { get; set; }

    public virtual Service Service { get; set; } // if there is a Service class

    public string Style { get; set; }
} 
```

# mysql - 将空字符附加到mysql中的每个条目

> ID：11381993
> 
> 赞同：0
> 
> 时间：2012-07-08T09:19:11.103
> 
> 标签：mysql

我有一个国家表，其中有一个由国家名称组成的 countryName 列，其中每个国家名称都有不同的名称长度。我需要使列中的所有名称具有相同的长度。我曾经`UPDATE country SET countryName = Concat(name,' ');`在每个条目中添加空字符，但是如何使所有名称的长度相同？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T09:24:28.197

您应该使用 MySQL [RPAD](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_rpad)和[LPAD](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_lpad)函数

```
UPDATE country SET countryName = RPAD(name,60,' '); 
```

这种方式 ' ' 将被追加，直到达到大小 60。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T09:26:45.260

这会将`countryName`用空格填充的字段右侧更新为表中最长的长度`countryName`：

```
UPDATE country a
CROSS JOIN
(
    SELECT MAX(CHAR_LENGTH(countryName)) AS maxlen
    FROM country
) b
SET a.countryName = RPAD(a.countryName, b.maxlen, ' ') 
```

# javascript - jquery ui datepicker不更新值

> ID：11381994
> 
> 赞同：3
> 
> 时间：2012-07-08T09:19:25.863
> 
> 标签：javascript, jquery, jquery-ui

使用 jquery datepicker ui，相关 html 字段的值属性不会立即更新。

> 示例：http: [//jsfiddle.net/4tXP4/](http://jsfiddle.net/4tXP4/)
> 
> 从马嘴里：http: [//jqueryui.com/demos/datepicker/alt-field.html](http://jqueryui.com/demos/datepicker/alt-field.html)

如果您检查元素，您将看到两个值属性都没有更新。

这些缺少什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-06-29T20:29:43.723

如果您不想要另一个输入字段，则使用`onSelect`但该`.val`函数不会更新`value`属性，因此您需要更加原始

```
$("#datepicker_start").datepicker({
    onSelect: function(dateText, datePicker) {
       $(this).attr('value', dateText);
    }
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-08T09:26:07.727

**工作演示** [http://jsfiddle.net/UBMXq/](http://jsfiddle.net/UBMXq/) **或** [http://jsfiddle.net/3BLwK/9/](http://jsfiddle.net/3BLwK/9/) **或** [http://jsfiddle.net/wrCv7/](http://jsfiddle.net/wrCv7/)

1件事：

*   缺少`#` “altField”：“#startDate”
*   （可选）即 DateFormat 可能需要一些注意 - 我认为不要`value`在您的隐藏输入中使用

希望这可以帮助！`:)`

**代码**

```
$(document).ready(function() {
    $("#startDate_picker").datepicker({
        "altField":"#startDate",
        "dateFormat":"d M y",
        "altFormat":"Y-m-d",
        "changeMonth":true,
        "changeYear":true
    });
}); 
```