# StackOverflow 问答 11141000-11141999

# google-bigquery - 将本地创建的表上传到 BigQuery？

> ID：11141000
> 
> 赞同：0
> 
> 时间：2012-06-21T15:01:14.260
> 
> 标签：google-bigquery

我正在尝试将一些数据从本地服务器上传到 BigQuery。由于我是使用 BigQuery 的新手，因此我一直在尝试仅上传几行示例数据，但在所有可用的 API 和文档之间，我设法让自己感到困惑。如果我尝试上传通过 Java 而**不是 CSV 文件**加载的数据，我将如何加载它？我应该只编写一个 POST 请求并通过 HTTP 发送它，还是通过 Java API 创建 TableRows 并从那里上传？我打算为所有这些使用 OAuth 密钥。如果这已经在某个地方得到回答，我很抱歉，但我是使用数据库的新手，可以使用澄清！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T16:16:53.573

您可以使用多部分 http 请求进行导入。如果您按照此处的说明进行操作：[https](https://developers.google.com/bigquery/docs/developers_guide#importingatable) ://developers.google.com/bigquery/docs/developers_guide#importingatable ，并按照说明“从本地文件导入”的位置进行操作。标题有点误导——它显示了 HTTP POST 数据格式，并且数据实际来自哪里并不重要（即它不必来自文件）。

# c# - BadImageFormatException in a service

> ID：11141004
> 
> 赞同：1
> 
> 时间：2012-06-21T15:01:28.387
> 
> 标签：c#, exception, appdomain, badimageformatexception

I have an application that is a long running service, I recently re-wrote it to use plugins and appdomains to solve a memory issue which turned out not to be mine but a leak in Microsoft's DirectoryServices namespace not properly disposing stuff. After my re-write I can no tlonger run the application as a service though it runs fine in console mode. When attempting to start the application I get the following exception in the windows event log:

```
Application: ADImport.exe
Framework Version: v4.0.30319
Description: The process was terminated due to an unhandled exception.
Exception Info: System.BadImageFormatException
Stack:
   at System.Reflection.RuntimeAssembly._nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity, RuntimeAssembly locationHint, StackCrawlMark& stackMark, Boolean throwOnFileNotFound, Boolean forIntrospection, Boolean suppressSecurityChecks)
   at System.Reflection.RuntimeAssembly.nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity, RuntimeAssembly locationHint, StackCrawlMark& stackMark, Boolean throwOnFileNotFound, Boolean forIntrospection, Boolean suppressSecurityChecks)
   at System.Reflection.RuntimeAssembly.InternalLoadAssemblyName(AssemblyName assemblyRef, Evidence assemblySecurity, StackCrawlMark& stackMark, Boolean forIntrospection, Boolean suppressSecurityChecks)
   at System.Reflection.RuntimeAssembly.InternalLoadFrom(String assemblyFile, Evidence securityEvidence, Byte[] hashValue, AssemblyHashAlgorithm hashAlgorithm, Boolean forIntrospection, Boolean suppressSecurityChecks, StackCrawlMark& stackMark)
   at System.Reflection.Assembly.LoadFrom(String assemblyFile)
   at ADImportPlugIn.LoadAssemblyAttributesProxy.LoadAssemblyAttributes(String assFile)
   at ADImportPlugIn.LoadAssemblyAttributesProxy.LoadAssemblyAttributes(System.String)
   at ADImportPlugIn.PlugInLoader.GetAssemblyNames()
   at ADImportPlugIn.PlugInLoader.LoadAllPlugIns()
   at ADImport.Program.WorkerMethod()
   at System.Threading.ThreadHelper.ThreadStart_Context(System.Object)
   at System.Threading.ExecutionContext.Run(System.Threading.ExecutionContext, System.Threading.ContextCallback, System.Object, Boolean)
   at System.Threading.ExecutionContext.Run(System.Threading.ExecutionContext, System.Threading.ContextCallback, System.Object)
   at System.Threading.ThreadHelper.ThreadStart() 
```

I have searched on here and seen many threads about the bit-ness of the application and possible mis-matches between the application and associated DLLs/assemblies. I have checked everything, tried targeting specific platforms etc, nothing seems to work. My dev platform is 64bit Windows 7, target is Windows 2008 64bit. My application is set to x86, my assemplies are anycpu though I have tried setting them too x86, x64 etc. I am using log4net in one of my DLL's but don't think that's the issue.

Any help would be appreciated!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T16:33:51.813

如上所述，我正在过滤，但做错了。我有一个正在使用的程序集

```
string[] fileNames = Directory.GetFiles(Environment.CurrentDirectory, "*.dll"); 
```

我需要将其更改为：

```
string[] fileNames = Directory.GetFiles(AppDomain.CurrentDomain.BaseDirectory, "*.dll"); 
```

忘记因为这是一个 Windows 服务，当前目录不是安装应用程序的位置，而是 Windows\System32。多哈。

# silverlight - 如何创建文本样式的平铺按钮，如下所示？在 Windows 电话 7 中

> ID：11141010
> 
> 赞同：0
> 
> 时间：2012-06-21T15:01:38.590
> 
> 标签：silverlight, windows-phone-7, windows-phone

我正在尝试创建一个翻转按钮，以显示每次交替翻转时更改的内容。UI 看起来像这样：

![在此处输入图像描述](../Images/501b69d996e9a651d05f26f8298d88f5.png)

在每次交替翻转时，文本将更改以代替示例文本 1、2、3 和 4

我正在尝试使用 Windows Phone 控制工具包中提供的 Hub 磁贴，但面临的问题是如何以给定格式显示文本并在翻转时更改它。

我将从网络服务获取的文本。

我怎样才能做到这一点，或者有什么解决方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T15:10:06.440

对于开始屏幕磁贴，在应用程序执行之间，磁贴只能有一个正面和一个背面。

唯一的例外是它们可以在后台代理运行时更改，但这仅在每半小时左右发生一次（取决于您的手机决定运行它们的频率），并且可以具有后台的应用程序数量存在硬性限制一次启用的代理。

对于应用内磁贴，最好的办法是根据计时器更新磁贴。

您将需要以编程方式构建图像，将其保存到独立存储并将其分配`BackBackgroundImage`给以在磁贴背面进行任何特殊格式化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T19:27:24.590

您可以做的基本上是检查它被点击/单击的次数，然后相应地调整文本。例如，在每个刻度上，您将一个值增加 1。然后，您使用图像数组的索引限定该数字，并使该图像的背景等于数组中指向的任何图像。

希望这是有道理的。

# sharepoint - 如何在库中查找文件（我是初学者）

> ID：11141015
> 
> 赞同：1
> 
> 时间：2012-06-21T15:01:50.487
> 
> 标签：sharepoint, powershell, powershell-2.0

我想使用 powershell 来获取共享点库“EM_DOC_LIBRARY”中的所有文件及其文件名。但是我完全不知道如何做到这一点，有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T15:03:50.403

将来，我们希望您至少检查一下 Google 并尝试自己编写脚本。但我今天感觉有点无私。这是一些应该为您指明正确方向的代码...

另外，一定要查看[**Hey Scripting Guy 的博客**](http://blogs.technet.com/b/heyscriptingguy/)，了解更多 PowerShell / SharePoint 功夫。

**按 ID 获取特定列表项**

```
## this is how you load the native SharePoint DLL to Powershell (On Server)
[void][System.Reflection.Assembly]::LoadWithPartialName("Microsoft.SharePoint") 

$url = “http://mysite.myurl.com”
$listName = "EM_DOC_LIBRARY"
$site = New-Object Microsoft.SharePoint.SPSite($url)
$web = $site.OpenWeb()
$list = $web.Lists[$listName]
$listitem = $web.Lists[$listName].Items.GetItemByID($litem) 
```

**更多示例代码 | 在 SharePoint Farm 上获取大文件**

```
function Get-DocInventory() {
    [void][System.Reflection.Assembly]::LoadWithPartialName("Microsoft.SharePoint")
    $farm = [Microsoft.SharePoint.Administration.SPFarm]::Local
    foreach ($spService in $farm.Services) {
        if (!($spService -is [Microsoft.SharePoint.Administration.SPWebService])) {
            continue;
        }

        foreach ($webApp in $spService.WebApplications) {
            if ($webApp -is [Microsoft.SharePoint.Administration.SPAdministrationWebApplication]) { continue }

            foreach ($site in $webApp.Sites) {
                foreach ($web in $site.AllWebs) {
                    foreach ($list in $web.Lists) {
                        if ($list.BaseType -ne "DocumentLibrary") {
                            continue
                        }
                        foreach ($item in $list.Items) {
                            $data = @{
                                "Web Application" = $webApp.ToString()
                                "Site" = $site.Url
                                "Web" = $web.Url
                                "list" = $list.Title
                                "Item ID" = $item.ID
                                "Item URL" = $item.Url
                                "Item Title" = $item.Title
                                "Item Created" = $item["Created"]
                                "Item Modified" = $item["Modified"]
                                "Size (kb)" = $item.File.Length/1KB
                                "Size (gb)" = $item.File.Length/1GB

                            }

                            Write-Host $item.Url -ForegroundColor DarkGray

                            # Only add files larger than 100 MB
                            if($item.File.Length -gt 100MB){
                                Write-Host $site.Url + $item.Url -ForegroundColor Red
                                New-Object PSObject -Property $data
                            }
                        }
                    }
                    $web.Dispose();
                }
                $site.Dispose()
            }
        }
    }
}
#Get-DocInventory | Out-GridView
Get-DocInventory | Export-Csv -NoTypeInformation -Path D:\Logs\inventory.csv 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T15:09:35.683

这是您想要的轻量级脚本：

```
Add-PSSnapin Microsoft.Sharepoint.Powershell
$web = Get-SPWeb http://servername/subweb
$l = $web.Lists["EM_DOC_LIBRARY"]
$l.Items | ? { $_.Name -eq "yourfilename.txt" } | %{ $item = $l.GetItemByID($_.ID); $item.Delete(); } 
```

# javascript - Issue creating a div using Ruby and Javascript

> ID：11141018
> 
> 赞同：0
> 
> 时间：2012-06-21T15:02:03.870
> 
> 标签：javascript, ruby-on-rails-3

I am trying to create a div, that is being appended to another div. Seems to be working but, the ruby code is not recognized and the image tag does not load:

```
function add_event(event)
{
    var div=document.createElement('div');
    div.innerHTML='<%= image_tag("events_pics/band.png", :class=> "event_pic_small") %><h6 class="event_info">Event_1: Frame: 974</h6><a class="btn btn-mini btn-danger pull-right " href="#"><i class="icon-remove"></i></a>';
    div.className='user_event my_background';
    $("#event_list").append(div);

} 
```

Plus I would like to assign a function on the `<i class="icon-remove"></i>` so, is there a more elegant way to create that div?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T15:06:20.827

您意识到 Javascript 在服务器代码（Rails）产生响应之后执行。

这就是无法识别 image_tag 的原因。

基本上，您不能在 javascirpt 文件中使用 <%= xxx %> 因为这些标记被 rails 服务器端识别并在响应发送回浏览器之前进行处理。然后你的javascript代码开始。

# parsing - 在 CMD 中用引号解析行

> ID：11141020
> 
> 赞同：0
> 
> 时间：2012-06-21T15:02:18.443
> 
> 标签：parsing, batch-file, for-loop, cmd

如何修复此错误？

```
@echo off 
Setlocal EnableDelayedExpansion

REM LINES FOR TEST:
REM         <td><span><span>41</span><span style="display: none;">111</span><div
REM style="display: none;">190</div><span class="" style="">.</span><span>197</span><span
REM style="display: none;">24</span><span></span>.<span style="display: 
REM inline;">132</span><span style="display: none;">39</span>.<span 
REM style="display: inline;">186</span></span></td> 

SET line=inline;">132</span><span style="display: none;">39</span>.<span 

FOR /F "tokens=1-20 delims=<>" %%A IN (%line%) DO (
echo A:%%A + B:%%B + C:%%C + D:%%D + E:%%E + F:%%F + G:%%G + H:%%H + I:%%I + J:%%J + K:%%K + L:%%L
FOR %%? in ( "%%A", "%%B", "%%C", "%%D", "%%E", "%%F", "%%G", "%%H", "%%I", "%%J") DO (
SET $=%%?
echo $:!$!
)
pause
) 
```

我想用标签分隔行。但我得到了错误：> 不是预期的

**编辑：**

```
I tried this:
SET line=inline;">132</span><span style="display: none;">39</span>.<span 
FOR /F usebackq^ tokens^=1-20^ delims^=^>^< %%A IN (^"%line%^") DO (
echo A:%%A + B:%%B + C:%%C + D:%%D + E:%%E + F:%%F + G:%%G + H:%%H + I:%%I + J:%%J + K:%%K + L:%%L
FOR %%? in ( "%%A", "%%B", "%%C", "%%D", "%%E", "%%F", "%%G", "%%H", "%%I", "%%J") DO (
SET $=%%?
echo $:!$!
)
pause
) 
```

错误：系统找不到内联文件 ">132

**另一个测试**- 我将这些行移到文件中并且没有错误

`FOR /F "delims= " %%? IN (html_2.txt) DO ( echo %%? FOR /F "tokens=1-20 delims=><" %%A IN ("%%?") DO ( echo A:%%A + B:%%B + C:%%C + D:%%D + E:%%E + F:%%F + G:%%G + H:%%H + I:%%I + J:%%J + K:%%K + L:%%L FOR %%? in ( "%%A", "%%B", "%%C", "%%D", "%%E", "%%F", "%%G", "%%H", "%%I", "%%J") DO ( SET $=%%~? echo $:!$! ) pause ) )`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T16:27:10.570

`<`并且`>`是重定向运算符，您需要转义它们：`^>`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T21:01:34.207

试试这个：

```
FOR /F "tokens=1 delims=" %%A IN (html_2.txt) DO (
    set a=%%A 
    set a=!a:"=\q!
    echo a=!a!
    FOR /F "tokens=1-26 delims=<>" %%a in ( "!a!" ) DO ( 
        set a=%%a& echo $:!a:\q="!
        set b=%%b& echo $:!b:\q="!
        set c=%%c& echo $:!c:\q="!
        set d=%%d& echo $:!d:\q="!
        set e=%%e& echo $:!e:\q="!
        set f=%%f& echo $:!f:\q="!
        set g=%%g& echo $:!g:\q="!
        set h=%%h& echo $:!h:\q="!
        rem repeat thru to z
        )
    pause
    ) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-22T07:09:12.697

这是 Skip R 代码的缩短版本：

```
@echo off 
Setlocal EnableDelayedExpansion

FOR /F "tokens=1 delims=" %%A IN (html_2.txt) DO (
    set a=%%A 
    set a=!a:"=\q!
    echo a=!a!
    FOR /F "tokens=1-26 delims=<>" %%A in ( "!a!" ) DO ( 
        FOR %%Z in ( %%A, %%B, %%C, %%D, %%E, %%F, %%G, %%H, %%I, %%J) DO (
        set z=%%Z
        echo !z:\q="!
        )
    )
    pause
) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-26T07:43:22.333

问题不在您的`FOR/F`循环中。这是您的变量`line`在`FOR/F ... in (^"%line%^")`.
在此处使用延迟扩展或更好地从文件中读取内容。

这可以在不考虑感叹号或插入符号的情况下处理您的问题。

```
@echo off 
setlocal EnableDelayedExpansion

FOR /F "tokens=1-26 delims=<>" %%A IN (html_2.txt) DO (
   echo a=%%A
   echo b=%%B
   echo c=%%C
   echo d=%%D
   echo e=%%E
   rem ...
   echo z=%%Z
) 
```

通过保留感叹号和插入符号，您需要切换延迟扩展模式并将值保存在临时变量中。
要禁用 EOL 字符，我将其设置为分隔符之外的字符。

```
@echo off 
setlocal DisableDelayedExpansion

FOR /F "tokens=1-26 EOL=< delims=<>" %%A IN (html_2.txt) DO (
    set "paramA=%%A"
    set "paramB=%%B"
    set "paramC=%%C"
    rem ...
    set "paramZ=%%Z"

   setlocal EnableDelayedExpansion
   echo a=!paramA!
   echo b=!paramB!
   echo c=!paramC!
   rem ...
   echo z=!paramZ!
   endlocal
) 
```

用 html_2.txt 测试：

```
<td><span><span>41</span><span style="display: none;">111</span><div
style="display: none;">190</div><span class="" style="">.</span><span>197</span><span
style="display: none;">24</span><span></span>.<span style="display: 
inline;">132</span><span style="display: none;">39</span>.<span 
style="display: inline;">186</span></span></td> 
```

# svg - 在 Adob e Illustrator 画布大小问题中导出为 SVG

> ID：11141023
> 
> 赞同：20
> 
> 时间：2012-06-21T15:02:23.060
> 
> 标签：svg, adobe-illustrator

我在 Adob​​e Illustrator 中保存一个简单的 SVG 时遇到了麻烦。

Illustrator 不断将自己的画布尺寸强加在导出文件上。

这就是我正在做的...

1）在图像周围画一个画板

![在此处输入图像描述](../Images/401ef4cefe77c07b7a8d0674e34acfef.png)

2) 文件 > 另存为

3) 将类型更改为 SVG

当我查看结果时，Illustrator 似乎已经任意调整了画布的大小![在此处输入图像描述](../Images/81e16b480cc7f84f007eeb70c97bc564.png)

我怎样才能控制它，这样我才能得到自己的尺寸？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2013-03-31T21:05:06.127

您的问题是您的 SVG 正在与设置为默认文档大小的画板一起保存。

在保存之前尝试使用“对象 > 画板 > 适合图稿边界”。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-07T06:01:26.617

Mac Finder（我假设您正在使用它来查看 SVG）倾向于忽略 SVG 边界。在生产中应该没关系，尽管当您在文件夹中查看它们时有点烦人。

在文本编辑器中打开 SVG 文件，特别注意开始标记。确保“viewbox”属性中的笛卡尔坐标与您的想法相匹配。

代码含义的深入解释：http: [//commons.oreilly.com/wiki/index.php/SVG_Essentials/Coordinates](http://commons.oreilly.com/wiki/index.php/SVG_Essentials/Coordinates)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-01-09T13:07:25.413

Illustrator 的画板存在问题，即 .svg 格式的“viewBox”。试试这个：首先在 Illustrator 中为您的图形调整画板/画布，然后将文件保存为 .ai 格式。

现在，您可以从 .ai 格式将文件另存为 .svg，您的画板将与您调整后的一样。下次您在 Illustrator 中打开 .svg 时，画板将再次被弄乱，因此您必须从 .ai 文件开始工作，而只需在网络上使用 .svg。

这意味着每次您需要调整.svg 时，您需要先将其保存为.ai 格式，调整画板，将其保存为.ai，然后将其保存为.svg。

如果您有 Adob​​e 人员的联系地址，请告诉他们...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-17T20:52:26.087

有时，您可能会无意中在插图中加入小物品，从而增加尺寸。尝试按 Crtl + A 突出显示文档中的所有内容。然后，删除插图之外的任何额外项目。这应该调整画布的大小。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-02-18T16:13:23.127

解决方案是使用像[https://petercollingridge.appspot.com/svg-editor这样的优化器](https://petercollingridge.appspot.com/svg-editor)

这会去除空白并优化文件。

# objective-c - 如何知道快速枚举中下一个对象是否为空？

> ID：11141026
> 
> 赞同：0
> 
> 时间：2012-06-21T15:02:39.003
> 
> 标签：objective-c, methods, enumeration

我想反转一个句子，但我不知道如何在快速枚举中正确获取下一个对象而没有任何问题：/

```
- (NSString *) reverseWords
{
    NSString    *result = [[NSString alloc] init];
    NSArray     *tab_words = [self componentsSeparatedByCharactersInSet:[NSCharacterSet whitespaceCharacterSet]];
    NSEnumerator    *reversed = [tab_words reverseObjectEnumerator];
    for (NSString *word in reversed)
    {
        result = [result stringByAppendingString:word];
        // Bug here
        if ([reversed nextObject])
            result = [result stringByAppendingString:@" "];
    }
    return (result);
} 
```

谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T15:13:32.880

有一种更简单的方法来反转句子而不是枚举它。您可以获取反转数组，然后将其与空格连接在一起（使用该`componentsJoinedByString:`方法）以生成另一个 NSString

```
- (NSString *) reverseWords
{
    NSArray *tab_words  = [self componentsSeparatedByCharactersInSet:[NSCharacterSet whitespaceCharacterSet]];
    NSArray *reversed   = [[tab_words reverseObjectEnumerator] allObjects];
    NSString *result    = [reversed componentsJoinedByString:@" "];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T15:14:40.650

我建议反转数组，然后使用 NSArray 的`componentsJoinedByString:`方法。有关反转数组的快速参考，[这个 SO question](https://stackoverflow.com/questions/586370/how-can-i-reverse-a-nsarray-in-objective-c)

这与您现有的代码非常相似，只是添加了使用现有循环构建中间数组的简单步骤。然后添加最终`componentsJoinedByString`调用以获取返回字符串。

# facebook-ads-api - 如何在 facebook ads api 中检查广告素材的审核状态

> ID：11141027
> 
> 赞同：0
> 
> 时间：2012-06-21T15:02:41.433
> 
> 标签：facebook-ads-api

我想创建新的广告素材并在 facebook ads api 中检查其审核状态。我想知道该广告素材是被批准还是被拒绝。我还有一个问题，广告组有什么用。在文档中，他们具有广告组的审核状态，但没有创意。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T11:58:46.597

它是一个整体经过审核的广告，而不仅仅是创意。Adgroup 基本上是一个广告，是创意和定位的组合。因此，审核会在您创建广告组时进行。

# oracle10g - 需要获取用户仪表板 OBIEE 10g 的 BI 报告列表

> ID：11141030
> 
> 赞同：0
> 
> 时间：2012-06-21T15:02:47.830
> 
> 标签：oracle10g, reporting, obiee

我了解为某人设置 URL 以从 BI 获取报告并传递参数的过程 - 我如何查询存储库以查明用户是否事先拥有对某个文件夹/报告的权限？（是的……我们仍然是 10 克）。澄清一点 - 我们使用 SSO 并将仪表板页面嵌入 iframe 效果很好 - 他们现在想看看我们是否可以将用户可用的报告列表放在页面上的“小部件”样式项目中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T13:33:05.907

恐怕你是在重新发明轮子。[Oracle 的 BIComposer](http://docs.oracle.com/cd/E21764_01/bi.1111/e10544/bicomposer.htm)有一个任务流，可以为使用 ADF 实现的任何自定义 Web 应用程序提供开箱即用的功能，但您可能需要升级。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T17:44:27.453

第一个想法，OBIEE 提供了从仪表板目录中添加报告列表的可能性。然后可能是您可以创建一个简单的仪表板页面并使用仪表板 URL 调用它。我认为用户权限是自动应用的。

第二个想法，Presentation Services（仪表板和答案）提供了一个 Web 服务 API： [http](http://docs.oracle.com/cd/E10415_01/doc/bi.1013/b31769.pdf) ://docs.oracle.com/cd/E10415_01/doc/bi.1013/b31769.pdf 您可以查询您想要的内容并查看所有权限。

干杯尼科

# sql - SQL动态日期但固定时间查询

> ID：11141035
> 
> 赞同：2
> 
> 时间：2012-06-21T15:03:06.820
> 
> 标签：sql, sql-server, sql-server-2008, tsql

我正在尝试编写如下例所示的 sql 查询，但是，我需要它始终在当天的上午 8:00 日期和下午 4:00 的当天日期之间选择 DateEntered 字段。不知道该怎么做。有人可以帮忙吗？

```
SELECT     OrderNumber
    , OrderRelease
    , HeatNumber
    , HeatSuffix
    , Operation
    , COUNT(Operation) AS [Pieces Out of Tolerance]
FROM         Alerts
WHERE     (Mill = 3) 
    AND (DateEntered BETWEEN GetDate '08:00' AND GetDate '16:00')
GROUP BY OrderNumber, OrderRelease, HeatNumber, HeatSuffix, Operation 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T15:15:57.243

```
DECLARE @TodayODBC varchar(30), @DateFrom datetime, @DateTo datetime
SET @TodayODBC = CONVERT(varchar(10), GETDATE(), 120)
SET @DateFrom = CONVERT(datetime, @TodayODBC + ' 08:00:00', 120)
SET @DateTo   = CONVERT(datetime, @TodayODBC + ' 16:00:00', 120)

SELECT OrderNumber, OrderRelease, HeatNumber, HeatSuffix, Operation,
    COUNT(Operation) AS [Pieces Out of Tolerance]
FROM Alerts
WHERE (Mill = 3) 
AND (DateEntered BETWEEN @DateFrom AND @DateTo)
GROUP BY OrderNumber, OrderRelease, HeatNumber, HeatSuffix, Operation 
```

指定 ODBC 日期时间格式，无论语言环境如何，该`, 120`格式都是恒定的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-21T15:16:48.350

```
SELECT     OrderNumber
    , OrderRelease
    , HeatNumber
    , HeatSuffix
    , Operation
    , COUNT(Operation) AS [Pieces Out of Tolerance]
FROM         Alerts
WHERE     (Mill = 3) 
    AND (datediff(dd,DateEntered,getdate()) = 0 AND Datepart(hh,DateEntered) BETWEEN '08' AND '16')
GROUP BY OrderNumber, OrderRelease, HeatNumber, HeatSuffix, Operation 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T15:16:10.673

由于您使用的是 SQL Server 2008，因此您可以 CAST 为日期或时间。要在 08:00 获取当前日期，您将使用：

```
(CAST(CAST(getdate() AS DATE) AS DATETIME) + CAST('08:00' AS TIME)) 
```

要获取 16:00 的当前日期：

```
(CAST(CAST(getdate() AS DATE) AS DATETIME) + CAST('16:00' AS TIME))) 
```

将其放入您的查询中：

```
SELECT OrderNumber
    , OrderRelease
    , HeatNumber
    , HeatSuffix
    , Operation
    , COUNT(Operation) AS [Pieces Out of Tolerance]
FROM         Alerts
WHERE     (Mill = 3) 
    AND (DateEntered 
        BETWEEN (CAST(CAST(getdate() AS DATE) AS DATETIME) + CAST('08:00' AS TIME)) 
        AND (CAST(CAST(getdate() AS DATE) AS DATETIME) + CAST('16:00' AS TIME)))
GROUP BY OrderNumber, OrderRelease, HeatNumber, HeatSuffix, Operation 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-21T15:16:19.463

```
SELECT     OrderNumber
    , OrderRelease
    , HeatNumber
    , HeatSuffix
    , Operation
    , COUNT(Operation) AS [Pieces Out of Tolerance]
FROM         Alerts
WHERE     (Mill = 3) 
    AND (DateEntered BETWEEN DATEADD(hour, 8, CONVERT(datetime,CONVERT(date,getdate()))) AND DATEADD(hour, 18, CONVERT(datetime,CONVERT(date,getdate()))))
GROUP BY OrderNumber, OrderRelease, HeatNumber, HeatSuffix, Operation 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-21T15:27:43.290

这可能对你有用

```
 DateEntered BETWEEN dateadd(hour, 8, cast(cast(getdate() as date) as datetime)) AND 
                     dateadd(hour, 16, cast(cast(getdate() as date) as datetime)) 
```

但这将（正如您的查询所做的那样）包括时间所在的行，`16:00:00.000'`但不包括时间所在的行`16:00:00.003'`。

如果您打算**在 17:00 之前**包含所有行，请改用它。

```
 DateEntered >= dateadd(hour, 8, cast(cast(getdate() as date) as datetime)) AND
 DateEntered <  dateadd(hour, 17, cast(cast(getdate() as date) as datetime)) 
```

# java - 在java中解析文本文件，如何删除“”

> ID：11141041
> 
> 赞同：1
> 
> 时间：2012-06-21T15:03:29.083
> 
> 标签：java, regex, parsing

我有一个简单的 java 代码，它读取包含带双引号的句子的文本 csv 文件：“sentence1”、“sentence2”、“sentence3”。我想阅读其中的一些句子（例如，句子 1 和 3）。我创建了一个缓冲区阅读器，`readLine()`然后使用：`tokens = fileLine.split(",");`其中令牌是一个字符串数组。

我使用数组索引访问了我感兴趣的句子：`tokens[0]`, `tokens[3]`. 问题是，我只想要没有双引号的句子。但是我的程序用“”保存了句子。如何改进解析技术，以便我可以保存没有“”的句子？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T15:05:59.810

怎么样[`String#replaceAll`](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#replaceAll%28java.lang.String,%20java.lang.String%29)：

```
theSentence = theSentence.replaceAll("\"", ""); 
```

在较新的 Java 版本中，我认为从 Java 5 开始，您也可以使用[`String#replace(CharSequence,CharSequence)`](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#replace%28java.lang.CharSequence,%20java.lang.CharSequence%29)：

```
theSentence = theSentence.replace("\"", ""); 
```

并避免正则表达式的开销

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T15:08:20.280

请参阅 [http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/String.html#replaceAll%28java.lang.String,%20java.lang.String%29](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/String.html#replaceAll%28java.lang.String,%20java.lang.String%29) 和相关问题[Java 等效项Perl 的 s/// 运算符？](https://stackoverflow.com/questions/2254921/java-equivalent-of-perls-s-operator)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T15:08:26.383

您可以执行以下操作：

```
s = s.substring(1, s.length()-1);
tokens = s.split("\",\""); 
```

请注意，您的实现将输入行解析 `"Hello, world","second sentence"` 为数组

```
"Hello
world"
"second sentence" 
```

仅当您的行本身不包含（转义）引号时，上述代码才有效。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-21T15:09:29.000

你可以使用方法`String.replaceAll(regex, replacement)`。

例如：

```
String s = "hello world";
s = s.replaceAll("o","X");
//s now equals "hellX wXrld" 
```

在您的情况下，您希望您的正则表达式为："\"" 而您的替换为：""

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-21T15:10:50.747

如果您只想`"`从字符串的开头和结尾删除，您也可以这样做：

```
String sentence="\"my sentence\"";
System.out.println(sentence);//out->"my sentence"

sentence = sentence.substring(1,sentence.length()-1);   
System.out.println(sentence);//out->my sentence 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-21T15:13:40.773

作为一个比任何东西都更有趣的解决方案，而不是立即拆分，为什么不这样做呢？

```
String inputFromCSV; // This would have the value of what you read from the CSV.
inputFromCSV=inputFromCSV.substring(1,sentence.length()-1); 
String[] tokens = inputFromCSV.split("\",\""); // Essentially "," 
```

实际上看着它，它并没有那么糟糕，只要你的文件保持相同的格式就可以工作。

# offset - 创建的图像没有由 visualtreehelper.getchild 找到的偏移量

> ID：11141045
> 
> 赞同：0
> 
> 时间：2012-06-21T15:03:40.663
> 
> 标签：offset

当我在画布上创建动态图像，然后尝试使用 visualtreehelper.getchild 找到它时，它会找到图像，但偏移量为 0。

如果我使用 xaml 制作图像，它可以工作，但如果我动态创建它，它就不行。如果您动态创建图像而不是在 xaml 中创建图像以使 visualtreehelper.getchild 找到偏移量，您是否需要做一些额外的事情？

```
 Dim iCount As Int16 = 0

    'Put Tables on Canvas
    For iCount = 0 To 5
        Dim tbl As New Image

        tbl.Source = New BitmapImage(New Uri("C:/Images/woodtable4.jpg", UriKind.Absolute))

        tbl.Width = 50
        tbl.Height = 50

        tbl.Name = "Tbl" & iCount.ToString
        Can1.Children.Add(tbl)

        Canvas.SetTop(tbl, 50)
        Canvas.SetLeft(tbl, (100 * iCount))
        'Can1.RegisterName(tbl.Name, tbl)
    Next

    'Get Child Objects

    Dim x As Int16
    Dim y As Int16
    For i As Integer = 0 To VisualTreeHelper.GetChildrenCount(Can1) - 1
        ' Retrieve child visual at specified index value.
        Dim childVisual As Visual = CType(VisualTreeHelper.GetChild(Can1, i), Visual)

        ' Return the offset vector for the TextBlock object.
        Dim vector As Vector = VisualTreeHelper.GetOffset(childVisual)
        ' Convert the vector to a point value.
        Dim currentPoint As New Point(VisualOffset.X, VisualOffset.Y)

        x = currentPoint.X
        y = currentPoint.Y
    Next i 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T16:03:46.830

好的，经过数小时的研究，我找到了答案。在画布上动态创建图像时，完成后，您需要调用：

```
<object>.UpdateLayout() 
```

就我而言，它是：Can1.UpdateLayout()

现在我得到了正确返回给我的偏移量。

# ruby-on-rails - Rails - 从模型中获取值到应用程序布局中

> ID：11141047
> 
> 赞同：1
> 
> 时间：2012-06-21T15:03:47.187
> 
> 标签：ruby-on-rails, view, model

我想从模型中获取“current_item.quantity”以在视图中使用 - 即我希望能够将“当前在您的购物车中的 (x) 个项目”放在应用程序布局视图中。我该怎么做呢？尝试了我能想到的“@total_current_items”等的每一种组合。谢谢！！

如果有帮助，这是模型代码：

```
class Cart < ActiveRecord::Base

has_many :line_items, dependent: :destroy

def add_product(product_id)
  current_item = line_items.find_by_product_id(product_id)
  if current_item
    current_item.quantity += 1
  else
    current_item = line_items.build(:product_id => product_id)
    current_item.price = current_item.product.price
  end
  current_item
end

def total_price
  line_items.to_a.sum { |item| item.total_price }
end

def decrease(line_item_id)
  current_item = line_items.find(line_item_id)
  if current_item.quantity > 1
    current_item.quantity -= 1
  else
    current_item.destroy
  end
  current_item
end

def increase(line_item_id)
  current_item = line_items.find(line_item_id)
  current_item.quantity += 1
  current_item
end
end 
```

根据要求，这是视图代码（相关部分）：

```
<% if @cart %>
<%= hidden_div_if(@cart.line_items.empty?, id:'cart') do %>
<div class="row-fluid">
        <a class="btn btn-success menu" id="menubutton" href="<%= cart_path(session[:cart_id]) %>">View Cart</a>
                </div>
                <div class="row-fluid"> 
                You have <%= pluralize(@total_current_items, "item") %>in your cart.    
                </div>

                <% end %>           
            <% end %>
</div> 
```

编辑：

我尝试将以下内容放入应用程序帮助程序中，但它不起作用。它要么出现未定义的方法/变量错误消息，要么显示“您的购物车中有 0 件商品”，即使那里有商品也是如此。我已经尝试将@total_items、total_items 等放在视图中引用它，但我是 Rails 新手，不知道该怎么做才能让它工作！

```
 def total_items
   @line_items = LineItem.find(params[:id])
   @total_items = @line_items.to_a.sum { |item| item.total_quantity}
 end 
```

我哪里错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T05:50:53.470

正如 Nils 指出的那样，您必须分配`@total_current_items`（在您的控制器中）以便您可以访问它。现在查看您的视图代码，我猜您在`@cart`.

成员变量`@cart`（成员变量，因为它有一个`@`）在您的控制器中分配。您也可以在视图中访问控制器中分配的成员变量。

您想了解有多少 line_items 附加到购物车。您已经在检查购物车中是否有任何 line_items（否则您将不会显示您想要实现的目标）。因此，不要检查您的数组是否为空。尝试获取数组的长度，即当前存在于您的购物车中的 line_items 的数量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T11:33:54.443

这是部分答案，但注释不能真正有代码块：

您应该将代码分配`@code`和`total_current_items`in`ApplicationController`作为受保护的方法。然后将其用作 before_filter，以便该方法将在*每个*控制器（页面）之前运行

```
class ApplicationController < ActionController::Base
  before_filter :get_cart    

  protected
  def get_cart
    @cart = SOMETHING
    @total_current_items = SOMETHING
  end
end 
```

before_filter - [http://guides.rubyonrails.org/action_controller_overview.html#filters](http://guides.rubyonrails.org/action_controller_overview.html#filters)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T16:58:39.033

您需要`total_current_items`在您的控制器中分配它才能在您的视图中使用。

`cart`如果也没有设置，也一样。

# jsf-2 - ManagedProperty 的序列化

> ID：11141052
> 
> 赞同：2
> 
> 时间：2012-06-21T15:04:00.967
> 
> 标签：jsf-2, deserialization, managed-bean, view-scope

`@ViewScoped`JSF和存在以下问题`@ManagedProperty`：我们的`ManagedBean`s 基本上如下所示：

```
@ManagedBean
@SessionScope
public class SessionConfig implements Serializable
{
    // ...
} 
```

和

```
@ManagedBean
@ViewScope
public class SomeController implements Serializable
{
    @ManagedProperty( value="#{sessionConfig}" )
    private SessionConfig sessionConfig;
    // public getter and setter

    // ...
} 
```

正如预期的那样，在处理请求后，控制器将被序列化。我希望`@ManagedProperty` `sessionConfig`在序列化中特别处理它，特别是在反序列化后它将被“重新链接”。然而，事实证明，反序列化后`sessionConfig`只是实际 SessionConfig-Bean 的过时克隆。

### 问题：

1.  这是预期的行为吗？
2.  我们可以做些什么来让 JSF 重新评估`@ManagedProperty`反序列化后的结果？

目前，我们在反序列化后“手动”重新评估所有托管属性。它有效，但显然似乎不正确。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T10:30:51.163

A solution is to avoid @ManagedProperty in @ViewScoped beans and evaluate the EL expression on demand. @ViewScoped beans will be stored in Session (and thus serialized) at the end of every request.

```
FacesContext ctx = FacesContext.getCurrentInstance();
ctx.getApplication().evaluateExpressionGet(ctx, "#{sessionConfig}", SessionConfig.class) 
```

Note that this may seriously affect perfromance if the expression has to be evaluated frequently.

A better aproach might be to provide custom serialization methods as described here: [http://www.oracle.com/technetwork/articles/java/javaserial-1536170.html](http://www.oracle.com/technetwork/articles/java/javaserial-1536170.html) This way the expression could be resolved automatically every time the bean is deserialized.

# sql - SQL Binary Microsoft Access - 如果特定字段值相等，则合并两个表

> ID：11141055
> 
> 赞同：1
> 
> 时间：2012-06-21T15:04:08.037
> 
> 标签：sql, ms-access, binary

我是 Microsoft Access 和 SQL 的新手，但有良好的编程背景，我相信这个问题应该相对简单。

我有两个表已导入 Access。我会给你一点背景。一张表很大，包含通用的全局数据。另一个表仍然很大，但包含特定的区域数据。两个表之间只有一个公共字段（或列）。我们称这个公共字段为 CF。两个表中的其他字段不同。

我将带你完成我需要做的一个迭代。我需要在区域较小的表中获取每个 CF 值，并在较大的全局表中找到共同的 CF 值。找到匹配项后，我需要从全局数据中取出整个“记录”或“行”并将其复制到较小区域表中的相应记录（这应该涉及创建新字段）。

我需要为区域较小的表中的所有 CF 值执行此操作。有人建议我使用 SQL 和二进制搜索，但我不熟悉。如果您有任何问题，请告诉我。感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T15:12:34.783

不确定 MS Access 特定的方言，但在 T-SQL 中，它会是这样的：

```
Update Regional SET Regional.A = Global.A ...
FROM Global WHERE Regional.CF = Global.CF 
```

只要CF在全球范围内是独一无二的，你就应该在那里。

# c# - 在单个数据集中加载数据库的所有表

> ID：11141062
> 
> 赞同：2
> 
> 时间：2012-06-21T15:04:31.710
> 
> 标签：c#, ado.net, dataset

我正在学习 ADO.Net [C#] 并希望使用 DataGridView.DataSource = DataSet.tables[] 命令填充不同的 DataGridView。但我只知道如何将 1 个表填充到 1 个数据适配器，是否可以查询整个数据库并将所有表放在一个数据集中，这样我就可以使用 dataset.tables[table index] 选项填充直到 datagridview？

例子：

```
 OleDbConnection con = new OleDbConnection();
        con.ConnectionString = @"Provider=Microsoft.ACE.OLEDB.12.0;data source =.accdb";

        ds = new DataSet();
        da = new OleDbDataAdapter("SELECT * ", con);
        da.Fill(ds);
        dgv.DataSource = ds.Tables[0]; (i want to have all the tables as an index so that i can put this as the datasource of the datagridview). 
```

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T15:13:07.887

我相信你可以告诉 DataAdapter 返回多个结果集，方法是给它多个 SELECT 查询，用分号分隔，如下所示：

```
da = new OleDbDataAdapter("SELECT * FROM Table1; SELECT * FROM Table2", con); 
```

此外，您可以使用多个 DataAdapter 填充 DataSet，如下所示：

```
daTable1 = new OleDbDataAdapter("SELECT * FROM Table1", con);
daTable2 = new OleDbDataAdapter("SELECT * FROM Table2", con);
daTable1.Fill(ds, "Table1");
daTable2.Fill(ds, "Table2"); 
```

然后，您应该能够通过索引器访问 DataSet 中的表。特别[是 ds.Tables[int index]](http://msdn.microsoft.com/en-us/library/cfsd7dz4.aspx)和[ds.Tables[String name]](http://msdn.microsoft.com/en-us/library/58st33fb.aspx)，如下所示：

`dgv.DataSource = ds.Tables[0];`或者`dgv.DataSource = ds.Tables["Table1"];`

有关详细信息，请参阅[MSDN - 从 DataAdapter (ADO.NET)](http://msdn.microsoft.com/en-us/library/bh8kx08z.aspx) 填充数据集（特别是*多个结果集*和*从多个数据适配器填充数据*集）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-30T17:20:58.233

或者您可以使用这种简单的方法。通过这种方式，您可以添加任意数量的表格。

```
string str = @"SELECT INV_ID,INV_CLIENTNAME,INV_ADD1,INV_CITY,INV_TEL,INV_CIF,INV_DATE,INV_DISCOUNT,
                           ITEM_DES,ITEM_QTY,ITEM_PRICE,INV_TAX_PERCENT,ITEM_QTY*ITEM_PRICE as gtotal
                          FROM (tbl_client INNER JOIN tbl_item ON tbl_client.INV_ID = tbl_item.FK_INV_ID)
                          WHERE (tbl_client.INV_ID = 'abc123')";

 OleDbDataAdapter adp = new OleDbDataAdapter(str, cn.db_cn);
 DataSet dset = new DataSet();
 adp.Fill(dset,"DataTable1");

str = @"SELECT company_name, company_address, company_city, company_tel, company_cif, Id FROM tbl_info";

adp = new OleDbDataAdapter(str, cn.db_cn);

adp.Fill(dset, "tbl_info"); 
```

# java - Web服务不返回泛型

> ID：11141064
> 
> 赞同：0
> 
> 时间：2012-06-21T15:04:32.553
> 
> 标签：java, generics, jboss

```
 Response profile(@WebParam(name = "key") String key,
        @WebParam(name = "data") HashMap<String, Object>[] dataList); 
```

在 web 服务中，我已将其声明为上述内容，但它不采用泛型 hashmap 及其拾取 List 而不是 HashMap [] dataList。

```
 public Response profile(
    @WebParam(name = "key", targetNamespace = "")
    String key,
    @WebParam(name = "data", targetNamespace = "")
    List<HashMap> data); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T04:03:31.620

Web 服务由 WSDL 描述，因此仅限于 WSDL 可以描述的内容。WSDL 是跨语言、跨平台的，它根本不做泛型。它处理数组、映射、原始类型。WSDL 背后的理念是服务可以用 Java 或 COBOL 编写——这无关紧要。

哦：除非它真的很重要，否则永远不要用实现类声明参数和返回类型。使用`Map`而不是`HashMap`.

# perl - 如何重新加载 mojolicious 内置的网络服务器守护进程？

> ID：11141068
> 
> 赞同：4
> 
> 时间：2012-06-21T15:04:42.327
> 
> 标签：perl, mojolicious, systemd

我从 复制了这个`systemd` `service`文件`lighttpd-package`并对其进行了调整以`systemd`启动 mojolicious 内置服务器守护程序。我可以保留mojolicious 守护进程`ExecReload`的设置吗？`KillSignal`

```
[Unit]
Description=Start mojolicious.pl daemon
After=syslog.target network.target

[Service]
ExecStart=/path/to/mojolicious.pl daemon --listen "http://*:3001"
ExecReload=/bin/kill -HUP $MAINPID
KillSignal=SIGINT

[Install]
WantedBy=multi-user.target 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-04T11:26:23.157

我认为亚历克斯`morbo`在说它自动重新加载时正在考虑。对于生产，您最好使用`hypnotoad`. 如果您确实切换到，`hypnotoad`那么会有各种有用的信号。例如`/bin/kill -USR2 $MAINPID`，将进行优雅的重新加载，避免对任何当前连接造成干扰。有关更多信号（对于 hypnotoad），请参阅[http://mojolicio.us/perldoc/Mojo/Server/Hypnotoad#SIGNALS](http://mojolicio.us/perldoc/Mojo/Server/Hypnotoad#SIGNALS)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T17:12:50.220

我不知道您为什么需要“重新加载”，Mojolicious 在应用程序代码更改时执行内部重新加载。您可以将其替换为

```
/bin/kill -0 $MAINPID 
```

如果该行应该在那里，HUP 将是正常应用程序的终端（除非您以不同方式处理它）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-09-06T17:06:48.703

**systemd reload 和 hypnotoad reload 需要一个包装脚本才能正常工作**

***注意：此解决方法适用于 Mojolicious 6.x。SystemD 兼容性已在 Mojolicious 7.x 中修复***

如果您想在 systemd 下重新加载，那么标准的 hypnotoad 重新加载（即`hypnotoad myapp.pl`）或者`kill -USR $MAINPID`是不可取的。SystemD 假设一旦重新加载 hypnotoad 服务器的命令返回，重新加载就完成了。但是，相反，这两个选项都会立即退出，并且不要等待重新加载完成。

当我尝试了这些标准的重新加载选项时，systemd 完成了重新加载命令的执行，然后，当 hypnotoad 执行“开始零停机时间软件升级 > 升级成功”时，监视 pid 文件被删除和替换。

如果您已将 systemd 配置为始终运行 hypnotoad 应用程序，则 systemd 将在 hypnotoad 正常运行之后再次重新启动（停止并启动）应用程序。

这是发生的事情：

*   systemd 重新加载 hypnotoad-app (ExecReload=hypnotoad myapp.pl)
*   hypnotoad-app 在被告知重新加载后退出
*   hypnotoad 使用最新的 myapp.pl 启动一个新进程
*   systemd 认为 reload 刚刚完成，并且看到 PIDFile 中的 pid 没有改变
*   hypnotoad 看到旧进程没有负载，杀死它们，并在“升级[is]成功”时删除并使用新进程的 PID 创建一个新的 PIDFile（这是 hypnotoad 的“零停机时间”重新加载过程）
*   systemd 看到 pid 文件被删除（它忽略了它被重新创建，可能是因为在设计上，systemd 想要控制分叉）
*   systemd 等待 HOLDOFF ( `RestartSec=<seconds>`) 如果已配置
*   systemd 对 hypnotoad-app 进行完整的单元启动

systemd 文档特别指出，当`ExecReload=`命令返回时，systemd 期望进程已经完成重新加载，并且 pid 文件具有重新加载进程的新 PID。但是 Hypnotoad 不能像那样同步工作。所以 systemd 和 hypnotoad 不能很好地协同工作。

[https://www.freedesktop.org/software/systemd/man/systemd.service.html](https://www.freedesktop.org/software/systemd/man/systemd.service.html)

> 但是请注意，通过发送信号（如上面的示例行）来重新加载守护程序通常不是一个好的选择，因为这是一个异步操作，因此不适合命令多个服务相互重新加载。强烈建议将 ExecReload= 设置为不仅会触发守护程序的配置重新加载，而且还会同步等待它完成的命令。

解决方案是围绕重新加载过程编写一个包装器。

```
#!/bin/bash

SERVER="/path/to/myapp.pl"
HYPNOTOAD="/usr/bin/hypnotoad"
PIDFILE="/var/run/myapp.pid"

# Timeout == LOOPSAFE x SLEEPTIME
SLEEPTIME="0.5"
LOOPSAFE=20
LOOPCOUNT=0
#

if [ ! -f "${PIDFILE}" ]; then
  # The PID files does not exist, maybe $SERVER is not running
  exit 1
fi

OLDPID=$(cat ${PIDFILE})
NEWPID=$OLDPID

# Reload the application
${HYPNOTOAD} ${SERVER}

while (( $LOOPCOUNT <= $LOOPSAFE )); do
  let LOOPCOUNT++
  if [ -f ${PIDFILE} ]; then
    NEWPID=$(cat ${PIDFILE})
    if (( $NEWPID > 1 )) && (( $NEWPID != $OLDPID )); then
      exit 0
    fi
  fi
  sleep ${SLEEPTIME}
done

exit 1 
```

这是 Hypnotoad 所需的 systemd 单元文件

```
[Unit]
Description=Hypnotoad-app
Requires=network.target
After=network.target

[Service]
Type=simple
SyslogIdentifier=hypnotoad-app
PIDFile=/var/run/myapp.pid
EnvironmentFile=-/etc/sysconfig/myapp
ExecStart=/usr/bin/hypnotoad --foreground /path/to/myapp.pl
ExecStop=/usr/bin/hypnotoad --stop /path/to/myapp.pl
ExecReload=/path/to/reload-myapp.sh
KillMode=process
Restart=always
RestartSec=5
User=myuser
Group=mygroup

[Install]
WantedBy=multi-user.target 
```

这是重新加载过程现在的工作方式

*   systemd 重新加载 hypnotoad-app
*   systemd 执行重载脚本
*   reload 脚本会重新加载 hypnotoad-app，并等待“成功升级”——本质上是休眠，直到 PID 文件具有新重新加载的 myapp.pl 进程的 PID
*   systemd 现在使用新的 PID 监视 pid 文件，该 PID 不再更改 - 所以现在 systemd 不会尝试重新启动它

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-01-24T17:07:16.853

另一种选择是`hypnotoad`在前台运行`-f`& 使用服务监督[`runit`](http://smarden.org/runit/)& 一个简单的`/etc/sv/myapp/run`脚本：

```
#!/bin/sh

app=/path/to/my/app
daemon=/path/to/hypnotoad

exec 2>&1
exec $daemon -f $app 
```

然后你可以`hypnotoad`重新阅读它的配置`sv hup myapp`

Red Hat 不`runit`提供，但`rpm`可以[从这里构建](https://github.com/imeyer/runit-rpm)最新版本。

不要忘记使用`ln -s /etc/sv/myapp /etc/service/myapp`启用服务`runit`。

# database-design - 多日预约数据库设计

> ID：11141069
> 
> 赞同：0
> 
> 时间：2012-06-21T15:04:42.037
> 
> 标签：database-design, database-schema

我正在为多日约会计划设计数据库。这就是我正在做的事情。我有 40 个“位置”，客户可以预订 x 天。我在决定存储此信息的最佳方式时遇到了麻烦。我正在考虑，如果在特定日期没有为“点”创建一行，那么我会知道这个“点”是免费的。相对于每天为每个“点”创建一行可能一年，然后如果“点”是空闲的，则有一个布尔列。我的下一个问题是我将如何在多日内进行特定的预约商店。我正在考虑有一个列来存储前一天的主键。如果此栏为空，我会知道此约会是针对许多人的第一天还是仅是一天的约会。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T15:35:21.933

由于必须始终预订一整天的位置，因此我将采用第一种方法，类似于：

![在此处输入图像描述](../Images/60a3ee42f466e06c30dc3d63766739db.png)

BOOKING.DAY 是没有时间的日期。

要检查给定地点是否在给定日期预订，只需在 BOOKING 中搜索相应行的存在。要预约多天，请在 APPOINTMENT 中插入一行，在 BOOKING 中插入几行相应的行。

注意：此模型不会强制同一约会天数的连续性。如果这很重要，您将不得不通过非声明性方式（例如触发器或在应用程序级别）强制执行它。

注意：如果您没有与除客户以外的约会相关的任何信息，您可以完全删除 APPOINTMENT 表并将 CLIENT 直接连接到 BOOKING。

* * *

也可以使用替代设计，其中 BOOKING 包含一个时期（而不仅仅是一天），但这会使避免重叠时期变得复杂（它可能需要结合触发器和仔细锁定）。

# symfony - Symfony2 搜索引擎策略

> ID：11141075
> 
> 赞同：3
> 
> 时间：2012-06-21T15:04:53.393
> 
> 标签：symfony, search-engine

我真的被困在寻找一种为汽车创建 symfony2 搜索引擎的策略上。

该应用程序有一个带有“快速搜索”表单的首页。

第二个页面是搜索页面本身，由一个快速搜索表单和来自汽车属性的链接组成（如部分 carmake，您单击 BMW，它与表单参数一起被重新查询）。尝试使用表单发布和表单构建的 symfony2 机制时，我遇到了以下限制：

*   主页上的表单不能发送到其他控制器（例如 SearchController），它必须与呈现表单的控制器相同。
*   我没有成功让网址具有像 www.mysite.com/search/2010/2012/.. 这样的参数和表单提交
*   从主页重定向到搜索页面不允许发送搜索对象
*   在搜索页面重新提交快速表单并使用搜索对象后，表单与请求的绑定成功，但 url 保持不变（例如 www.mysite.com/0/0/0）

是否有 symfony2 的示例或特殊策略并创建基于搜索的站点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T15:21:27.963

您应该真正研究一下 Solr，因为它的效率、速度和高度自定义选项。

# google-apps-script - 为所有者/创建者查询 Google Doc

> ID：11141079
> 
> 赞同：1
> 
> 时间：2012-06-21T15:05:04.447
> 
> 标签：google-apps-script, google-docs

我一直在查看 Google Apps Script API 文档，但找不到可以返回查看文档（不是电子表格）的用户是所有者/创建者、查看者还是协作者的类或方法。鉴于此 API，这可能吗？如果是这样，这个功能可以在哪个类中找到？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T15:25:07.693

[File](https://developers.google.com/apps-script/class_file)类有`getOwner`方法。[可以通过使用DocList](https://developers.google.com/apps-script/class_docslist)服务遍历文件来找到所需的文件。该类还有其他方法`getViewers`和`getEditors`.

# ssh - SSH 多跳

> ID：11141082
> 
> 赞同：0
> 
> 时间：2012-06-21T15:05:08.823
> 
> 标签：ssh, tunneling

我有 3 个工作站

*   ortro（我的客户）
*   idrauser@idra（中间）
*   cerberouser@cerbero（目的地）

在伊德拉：

```
ssh -L 9999:idra:22 cerberouser@cerbero 
```

在奥特罗：

```
ssh idrauser@idra -p 9999
ssh: connect to host idra port 9999: Connection refused 
```

我无法在 ortro 中修改 sshd_config。我需要在 idra 和 cerbero 之间建立一条隧道，然后从 ortro 使用它

非常感谢里卡多

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T22:20:25.213

`-L`默认绑定到 localhost。

利用

```
ssh -L '*':9999:idra:22 cerberouser@cerbero 
```

或者

```
ssh -o GatewayPorts=yes -L 9999:idra:22 cerberouser@cerbero 
```

反而。

* * *

更安全的解决方案不会代理端口，而是代理连接。尝试将此添加到您的`~/.ssh/config`on ortro：

```
Host cerbero
User cerberouser
ProxyCommand /usr/bin/ssh idrauser@idra /bin/nc -w 3700 %h %p 
```

然后通过运行单个命令从 ortro 连接到 cerbero

```
ssh cerbero 
```

# c++ - 无线键盘/鼠标应用程序：模拟击键

> ID：11141083
> 
> 赞同：0
> 
> 时间：2012-06-21T15:05:13.290
> 
> 标签：c++, sockets, keystrokes

我目前正在学习套接字编程，我正在创建一个应用程序以将我的手机用作无线键盘/鼠标。我目前的方法是让手机应用程序通过 wi-fi 向计算机上的应用程序发送消息，该应用程序会将这些消息转换为击键、鼠标移动和鼠标点击。

通信部分不是问题，问题是一旦消息到达计算机上的应用程序，我不知道如何将它们变成键盘输入/鼠标输入。我做了一些研究，找到了一些示例，但其中大多数要求我选择一个应用程序来发送输入。有没有办法将输入发送到当前应用程序的任何内容？此外，我看到的大多数示例仅适用于 windows，并且我希望我的应用程序能够在 linux、macOS 和 windows 中运行。

你们对我可以使用什么有什么建议吗？或者你能指出我正确的方向来更好地研究这个。

我目前正在为应用程序使用 C++

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T15:18:41.567

对于 Linux，我建议您将事件注入内核事件子系统。看这里：[http](http://thiemonge.org/getting-started-with-uinput) ://thiemonge.org/getting-started-with-uinput ，特别是在“在输入子系统中注入事件”部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T15:30:10.387

做这样的事情需要与操作系统进行通信。每个操作系统都有不同的 API。

在许多情况下，您可以使用一个运行时库/框架，它会为此提供一个通用接口。该框架为您提供了一个通用接口，但该接口的核心实际上是为每个操作系统重新实现的。

但是，我不确定是否有任何框架会为您提供此功能。您很可能必须为每个目标操作系统重新实现此功能。

# android - Android 的 SSL 问题

> ID：11141086
> 
> 赞同：7
> 
> 时间：2012-06-21T15:05:19.783
> 
> 标签：android, ssl, openssl

我的 Android 上有一个非常具体的 SSL 问题。如果我尝试通过代码访问特定网站，则会收到以下错误：

```
SSL handshake failure: Failure in SSL library, usually a protocol error
error:140773F2:SSL routines:SSL23_GET_SERVER_HELLO: sslv3 alert unexpected message (external/openssl/ssl/s23_cInt.c:500 0xaf076228:0x00000000) 
```

无论构建如何，我都会得到这个......我已经在 API 级别 1.5、1.6、2.2 和 4.0 上尝试过，并且每次都得到相同的结果。

经过一些故障排除后，我尝试通过浏览器访问该网站，但出现以下错误：

```
Data connectivity problem
A secure connection could not be established. 
```

事情是这样的……该网站在 Windows 浏览器上打开得很好（在 Firefox、IE 和 Chrome 上测试）。它在使用与 Android 相同的 webkit 的 iOS 设备上也可以正常打开，这很奇怪。该网站也可以在 Opera Mini 浏览器上正常运行。

[这是网站。](https://csc.ntta.org/olcsc/AccountLogin.do)

我尝试通过将客户端证书添加到密钥库并忽略无效的客户端证书来解决问题，但没有结果。但是，证书本身似乎不是问题。

我陷入了僵局。任何人都可以就我如何让它发挥作用提供任何指导吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-25T17:26:07.017

我找到了解决方案（感谢 Nikolay 为我指明了正确的方向）。

问题有两个……第一，它返回了一个 Android 不喜欢的站点证书，第二，它只启用了 SSLv3（而不是 TLS）。

这是我的解决方案。首先，我必须创建一个自定义套接字工厂类：

```
public class MySSLSocketFactory extends SSLSocketFactory {
SSLContext sslContext = SSLContext.getInstance("SSLv3");

public MySSLSocketFactory(KeyStore truststore) throws NoSuchAlgorithmException, KeyManagementException, KeyStoreException, UnrecoverableKeyException {
    super(truststore);

    TrustManager tm = new X509TrustManager() {
        public void checkClientTrusted(X509Certificate[] chain, String authType) throws CertificateException {}
        public void checkServerTrusted(X509Certificate[] chain, String authType) throws CertificateException {}
        public X509Certificate[] getAcceptedIssuers() {
            return null;
        }
    };

    sslContext.init(null, new TrustManager[] { tm }, null);
}

@Override
public Socket createSocket(Socket socket, String host, int port, boolean autoClose) throws IOException, UnknownHostException {
    SSLSocket S = (SSLSocket) sslContext.getSocketFactory().createSocket(socket, host, port, autoClose);
    S.setEnabledProtocols(new String[] {"SSLv3"});
    return S;
}

@Override
public Socket createSocket() throws IOException {
    SSLSocket S = (SSLSocket) sslContext.getSocketFactory().createSocket();
    S.setEnabledProtocols(new String[] {"SSLv3"});
    return S;
} 
```

}

其次，我在我的代码中定义了这个自定义的 HttpClient：

```
public HttpClient getNewHttpClient() {
    try {
        KeyStore trustStore = KeyStore.getInstance(KeyStore.getDefaultType());
        trustStore.load(null, null);

        MySSLSocketFactory sf = new MySSLSocketFactory(trustStore);
        sf.setHostnameVerifier(MySSLSocketFactory.ALLOW_ALL_HOSTNAME_VERIFIER);

        HttpParams params = new BasicHttpParams();
        HttpProtocolParams.setVersion(params, HttpVersion.HTTP_1_1);
        HttpProtocolParams.setContentCharset(params, HTTP.UTF_8);

        SchemeRegistry registry = new SchemeRegistry();
        registry.register(new Scheme("http", PlainSocketFactory.getSocketFactory(), 80));
        registry.register(new Scheme("https", sf, 443));

        ClientConnectionManager ccm = new ThreadSafeClientConnManager(params, registry);

        return new DefaultHttpClient(ccm, params);
    } catch (Exception e) {
        return new DefaultHttpClient();
    }
} 
```

第三，我调用了自定义的HttpClient并解析了结果：

```
public String test(String URIString) {
    HttpClient httpClient = getNewHttpClient();
    String result = "";
    URI uri;
    try {
        uri = new URI(URIString);
    } catch (URISyntaxException e1) {
        return "ERROR";
    }
    HttpHost host = new HttpHost(uri.getHost(), 443, uri.getScheme());
    HttpPost httppost = new HttpPost(uri.getPath());
    try {
        HttpResponse response = httpClient.execute(host, httppost);
        BufferedReader reader = new BufferedReader(
                new InputStreamReader(
                    response.getEntity().getContent()
                )
            );
            String line = null;
            while ((line = reader.readLine()) != null){
              result += line + "\n";
            }

            return result;
    } catch (ClientProtocolException e) {
        return "ERROR";
    } catch (IOException e) {
        return "ERROR";
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-22T03:18:01.407

你是如何访问这个网站的？通过安卓浏览器？网络视图？还是 HttpClient/HTTPSURLConnection？它似乎只响应 SSL3，您必须强制您的客户端使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-03-17T10:20:56.470

经过两天的努力，这个最终解决方案对我有用-

```
 private OkHttpClient.Builder getUnsafeOkHttpClient() {
    try {
        // Create a trust manager that does not validate certificate chains
        final TrustManager[] trustAllCerts = new X509TrustManager[]{new X509TrustManager() {
            public void checkClientTrusted(X509Certificate[] chain, String authType) throws CertificateException {
            }

            public void checkServerTrusted(X509Certificate[] chain, String authType) throws CertificateException {
            }
            public X509Certificate[] getAcceptedIssuers() {
                return new java.security.cert.X509Certificate[]{};
            }
        }};

        // Install the all-trusting trust manager
        final SSLContext sslContext = SSLContext.getInstance("SSL");
        KeyManagerFactory kmf = KeyManagerFactory.getInstance("X509");
        KeyStore keyStore = KeyStore.getInstance(KeyStore.getDefaultType());
        kmf.init(keyStore, "password".toCharArray());
        sslContext.init(kmf.getKeyManagers(), trustAllCerts, new java.security.SecureRandom());
        final SSLSocketFactory sslSocketFactory = sslContext.getSocketFactory();
        OkHttpClient.Builder builder = new OkHttpClient.Builder();
        builder.sslSocketFactory(sslSocketFactory, (X509TrustManager) trustAllCerts[0]);
        builder.hostnameVerifier(new HostnameVerifier() {
            @Override
            public boolean verify(String hostname, SSLSession session) {
                return true;
            }
        });
        ConnectionSpec spec = new ConnectionSpec.Builder(ConnectionSpec.COMPATIBLE_TLS)
                .allEnabledTlsVersions()
                .allEnabledCipherSuites()
                .build();
        ConnectionSpec spec1 = new ConnectionSpec.Builder(ConnectionSpec.CLEARTEXT)
                .build();

        builder.connectionSpecs(Arrays.asList(spec,spec1));

        return builder;
    } catch (Exception e) {
        Logger.e("[DownloadService][getUnsafeOkHttpClient] :", false);
       return new OkHttpClient.Builder();

    }
} 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2016-03-11T11:14:40.213

使用它并调用此方法 HttpsTrustManager.allowAllSSL()

它将解决问题并且对我来说工作正常。

公共类 HttpsTrustManager 实现 X509TrustManager {

```
private static TrustManager[] trustManagers;
private static final X509Certificate[] _AcceptedIssuers = new X509Certificate[]{};

@Override 
public void checkClientTrusted( 
        java.security.cert.X509Certificate[] x509Certificates, String s)
        throws java.security.cert.CertificateException {

} 

@Override 
public void checkServerTrusted( 
        java.security.cert.X509Certificate[] x509Certificates, String s)
        throws java.security.cert.CertificateException {

} 

public boolean isClientTrusted(X509Certificate[] chain) {
    return true; 
} 

public boolean isServerTrusted(X509Certificate[] chain) { 
    return true; 
} 

@Override 
public X509Certificate[] getAcceptedIssuers() {
    return _AcceptedIssuers; 
} 

public static void allowAllSSL() { 
    HttpsURLConnection.setDefaultHostnameVerifier(new HostnameVerifier() {

        @Override 
        public boolean verify(String arg0, SSLSession arg1) {
            return true; 
        } 

    }); 

    SSLContext context = null;
    if (trustManagers == null) {
        trustManagers = new TrustManager[]{new HttpsTrustManager()};
    } 

    try { 
        context = SSLContext.getInstance("TLS");
        context.init(null, trustManagers, new SecureRandom());
    } catch (NoSuchAlgorithmException e) {
        e.printStackTrace();
    } catch (KeyManagementException e) {
        e.printStackTrace();
    } 

    HttpsURLConnection.setDefaultSSLSocketFactory(context
            .getSocketFactory());
} 
```

}

# java - JSF/ICEFaces 自定义组件设计模式和阅读

> ID：11141090
> 
> 赞同：0
> 
> 时间：2012-06-21T15:05:25.030
> 
> 标签：java, jsf, icefaces

我需要创建一个自定义组件，它由一个下拉框、树和一个显示面板组成，用于显示节点的选定项目的详细信息。

这个 UI 组件将是一个弹出窗口，供用户选择一些项目并添加到支持 bean。（可用于选择衬衫、汽车或任何适合关卡和树数据的东西）

我想知道在创建用于多种用途的自定义组件时是否有任何好的阅读最佳实践。

经过头脑风暴，我发现了以下问题。

1）如何将选择传递回backingbean？可能的解决方案：为自定义组件实现观察者模式，因此当用户单击 [OK] 时，它将在关闭自定义组件之前将值传回支持 bean

2) 显示所选节点的详细信息。（不同类型的项目可以显示不同）可能的解决方案：我可能会考虑使用 UI:Include 但我正在考虑一个更优雅的解决方案

还有什么问题？？？

有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T05:06:53.800

我将忽略问题中的 ICEfaces 部分，因为我不使用它。

> *1）如何将选择传递回backingbean？*

提供一个`value`属性，您可以在其中指定 bean 属性。最简单的方法是让您的自定义组件扩展[`UIInput`](http://docs.oracle.com/javaee/6/api/javax/faces/component/UIInput.html)已经提供此属性的组件。

* * *

> *2) 显示所选节点的详细信息。（不同类型的项目可以显示不同）可能的解决方案：我可能会考虑使用 UI:Include 但我正在考虑一个更优雅的解决方案*

You could provide support for specific `<f:facet>`s. In the `encodeChildren()` of the component or its renderer you can get them by [`UIComponent#getFacet()`](http://docs.oracle.com/javaee/6/api/javax/faces/component/UIComponent.html#getFacet%28java.lang.String%29).

# r - 来自“lmList”的广义线性模型的置信区间

> ID：11141091
> 
> 赞同：4
> 
> 时间：2012-06-21T15:05:26.060
> 
> 标签：r, lme4

`lmList`我正在尝试使用包中的通用模型计算组的置信区间`lme4`。它适用于正常的线性模型，但当因变量是二分法时会失败。例如，这很好用：

```
d <- data.frame(
  g = sample(c("A","B","C","D","E"), 250, replace=TRUE),
  y1 = runif(250, max=100),
  y2 = sample(c(0,1), 250, replace=TRUE)
)

library(lme4)

fm1 <- lmList(y1 ~ 1 | g, data=d) 
```

我可以使用 提取系数，`coef(fm1)`并使用 提取系数的置信区间`confint(fm1)`。然后我运行一个具有二分结果的模型：

```
fm2 <- lmList(y2 ~ 1 | g, data=d, family=binomial) 
```

我仍然可以使用 获取系数`coef(fm2)`，但是当我尝试获取置信区间时，出现错误：

```
> confint(fm2)
Waiting for profiling to be done...
Waiting for profiling to be done...
Error in val[, , i] <- eval(mCall) : incorrect number of subscripts 
```

我最初打算将此发布到 stats.stackexchange 因为我认为这可能是我不了解 GLM 的置信区间的东西，但后来我发现我仍然可以使用

```
by(d, d$g, function(x) confint(glm(y2 ~ 1, data=x, family=binomial))) 
```

有什么方法可以做到这一点`lmList`吗？

```
> sessionInfo()
R version 2.15.0 (2012-03-30)
Platform: x86_64-pc-mingw32/x64 (64-bit)

locale:
[1] LC_COLLATE=German_Germany.1252  LC_CTYPE=German_Germany.1252  
[3] LC_MONETARY=German_Germany.1252 LC_NUMERIC=C                  
[5] LC_TIME=German_Germany.1252   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base    

other attached packages:
[1] lme4_0.999375-42 Matrix_1.0-6     lattice_0.20-6 

loaded via a namespace (and not attached):
[1] grid_2.15.0   MASS_7.3-17   nlme_3.1-103  stats4_2.15.0 tools_2.15.0 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T10:00:19.583

这确实是一个错误，我正在努力修复。事实证明它相当简单：基本问题是`confint.lm`返回一个矩阵，同时`confint.glm`返回一个数据框。

一般来说，我**强烈建议在**[http://r-forge.r-project.org/tracker/?atid=298&group_id=60&func=browse](http://r-forge.r-project.org/tracker/?atid=298&group_id=60&func=browse)上将除最琐碎的错误修复之外的所有错误修复发布到错误跟踪器（我抱怨 R-core 的态度对错误报告，所以为了保持一致性，我必须遵循我自己的规则......）谢谢你的报告！

# javascript - 选择的选项在 IE9 中不起作用

> ID：11141096
> 
> 赞同：0
> 
> 时间：2012-06-21T15:05:42.747
> 
> 标签：javascript, jquery, html

简单代码：

```
<span>
<label for="cmp_sort">Sort by</label>
   <select id="cmp_sort">
        <option value="original" selected="selected">original</option>
        <option value="name">name</option>
   </select>&nbsp; 
```

在包括 ie7-8 在内的所有浏览器中，加载后组合框中的页面默认值为“原始”。但是 IE9 什么也没显示（空行）。当我按下那条线时，我会根据需要收到“原始/名称”。我尝试 `$("cmp_sort").val("original")`在 document.load 上做，但它没有帮助。但是，当我在控制台中执行此代码时，一切正常。我应该怎么办？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T15:07:29.990

您需要提供哈希标签：

`$("#cmp_sort").val("original")`

`$("cmp_sort")``cmp_sort`将查找任何不存在的名为 的 html 标记。

# javascript - page.all 的 Capybara JS 测试失败

> ID：11141099
> 
> 赞同：1
> 
> 时间：2012-06-21T15:05:57.113
> 
> 标签：javascript, ruby-on-rails, ajax, rspec, capybara

我正在尝试使用 Capybara、RSpec 和 JS（使用 Webkit）来实现请求规范。我有一个发送 JS 请求（jQuery.load）的测试，该请求将返回一个页面，该页面将嵌入到现有页面中。

当我用 pry 调试测试时，它会运行。当它自己运行时，它会失败。我想这是由于使用 pry 时增加了时间。有没有办法可以强制 Cabypara 重试一段时间？

我的测试代码如下所示：

```
 describe "load list for given period", js:true do
      it "loads the last entry" do
        page.fill_in "period_value", with: "1"
        page.select "Entries", from: "period_unit"
        page.click_link "update_list_section"

        page.all(:xpath, "//div[@id='list_section_wrapper']/table/tbody/tr").count.should == 2
      end
    end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T04:32:46.703

因为该元素在请求时已经存在，所以`Capybara.default_wait_time`它不起作用，即水豚不等待/重试。我不得不努力`sleep(0.5)`让它工作。

[在这篇博](http://codetunes.com/2011/08/20/testing-ajax-reloaded-elements-with-capybara)文中得到了很好的解释（只要我在 googlez 中输入了正确的关键字）。

# sql - 如何从 TSQL 中的日期获取日历季度

> ID：11141100
> 
> 赞同：51
> 
> 时间：2012-06-21T15:05:57.507
> 
> 标签：sql, sql-server, tsql, sql-server-2005

我在一列中有不同的日期。例如：

```
20080102
20070821 
```

我想将这些日期转换为年份和日历季度。例如，

```
Year      Quarter
2008      2008-Q1
2007      2007-Q3 
```

我可以得到第一列：

```
select left(date,4) as year from table 
```

我怎样才能产生第二列？

* * *

## 回答 #1

> 赞同：116
> 
> 时间：2013-08-15T17:19:41.503

```
SELECT DATEPART(QUARTER, @date) 
```

这将返回 的四分之一`@date`，假设`@date`是`DATETIME`。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-06-21T15:07:42.287

```
SELECT DATENAME(Quarter, CAST(CONVERT(VARCHAR(8), datecolumn) AS DATETIME)) 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-07-10T15:53:18.263

这是我的做法。非常简短，不依赖临时表。

```
CAST(year(TheDate) AS char(4)) + '-Q' + 
CAST(CEILING(CAST(month(TheDate) AS decimal(9,2)) / 3) AS char(1)) 
```

举个例子：

```
SELECT convert(char(10), getdate(), 101) AS TheDate, 
CAST(year(getdate()) AS char(4)) + '-Q' + 
    CAST(CEILING(CAST(month(getdate()) AS decimal(4,2)) / 3) AS char(1)) AS SelectQuarter 
```

这将返回：

```
TheDate    SelectQuarter
---------- -------------
07/10/2013 2013-Q3 
```

显然，字符串本身可以更改以适合您自己的格式。希望这会有所帮助。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-07-17T17:44:56.907

这是另一种选择。使用 CTE 定义季度的月份，然后加入它以确定季度：

```
WITH Quarters AS (
   SELECT Q = 'Q1', MonthBegin = 1, MonthEnd = 3 UNION
   SELECT Q = 'Q2', MonthBegin = 4, MonthEnd = 6 UNION
   SELECT Q = 'Q3', MonthBegin = 7, MonthEnd = 9 UNION
   SELECT Q = 'Q4', MonthBegin = 10, MonthEnd = 12
)
SELECT
   [Year] = DATEPART(yyyy, CONVERT(DATETIME, Dates.[date])),
   [Quarter] = CONVERT(VARCHAR(4), DATEPART(yyyy, CONVERT(DATETIME, Dates.[date]))) + '-' + q.Q
FROM
   (VALUES
       ('20080102'),
       ('20070821')
   ) AS Dates ([date])
   INNER JOIN Quarters q ON
      DATEPART(m, CONVERT(DATETIME, Dates.[date])) >= q.MonthBegin AND
      DATEPART(m, CONVERT(DATETIME, Dates.[date])) <= q.MonthEnd; 
```

回报：

```
Year  Quarter
----- ----------
2008  2008-Q1
2007  2007-Q3 
```

[SQL小提琴](http://sqlfiddle.com/#!6/d41d8/5660/0)

处理 int 的列类型（04/23/2014）：

```
WITH Quarters AS (
    SELECT Q = 'Q1', MonthBegin = 1, MonthEnd = 3 UNION
    SELECT Q = 'Q2', MonthBegin = 4, MonthEnd = 6 UNION
    SELECT Q = 'Q3', MonthBegin = 7, MonthEnd = 9 UNION
    SELECT Q = 'Q4', MonthBegin = 10, MonthEnd = 12
)
SELECT
    [Year] = DATEPART(yyyy, CONVERT(DATETIME, CONVERT(VARCHAR(8), Dates.[date]))),
    [Quarter] = CONVERT(VARCHAR(4), DATEPART(yyyy, CONVERT(DATETIME, CONVERT(VARCHAR(8), Dates.[date])))) + '-' + q.Q
FROM
    (VALUES
        (20080102),
        (20070821)
    ) AS Dates ([date])
    INNER JOIN Quarters q ON
        DATEPART(m, CONVERT(DATETIME, CONVERT(VARCHAR(8), Dates.[date]))) >= q.MonthBegin AND
        DATEPART(m, CONVERT(DATETIME, CONVERT(VARCHAR(8), Dates.[date]))) <= q.MonthEnd; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-06-21T16:20:32.380

由于您的日期字段数据在`int`您需要将其转换为日期时间：

```
declare @date int
set @date = 20080102

SELECT Datename(quarter, Cast(left(@date, 4) + '-' 
    + substring(cast(@date as char(8)), 5, 2) + '-' 
    + substring(cast(@date as char(8)), 7, 2) as datetime)) as Quarter 
```

或者

```
SELECT Datename(quarter, Cast(left(@date, 4) + '-' 
    + substring(cast(@date as char(8)), 5, 2) + '-' 
    + right(@date, 2) as datetime)) as quarter 
```

然后，如果您想`Q1`添加：

```
SELECT left(@date, 4) + '-Q' + Convert(varchar(1), Datename(quarter, Cast(left(@date, 4) + '-' 
    + substring(cast(@date as char(8)), 5, 2) + '-' 
    + right(@date, 2) as datetime))) as quarter 
```

我的建议是将您的`date`数据存储为`datetime`这样，这样您就不需要执行这些转换。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-02-07T20:46:08.893

我是这样做的（我正在使用 SQL Server）：

```
SELECT 'Q' + cast(DATEPART(QUARTER, GETDATE()) as varchar(1)) + ' - ' + cast(DATEPART(YEAR, GETDATE()) as varchar(4)) AS 'Date Quarter' 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-08-20T11:25:50.767

假设字段数据类型为 INT 和字段名称“mydate”。在 OP 问题中，转换为字符串时的 INT 日期值是 ISO 日期文字。

```
select DatePart(QUARTER, cast(cast(mydate as char(8)) as date)) 
```

如果使用较旧的服务器版本，您可以使用日期时间。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-06-22T07:23:05.483

用 CONVERT 捣乱的好借口。可能更漂亮的方法：

[在这里对 SQLfiddle 进行实时测试](http://sqlfiddle.com/#!3/dcf64/1)

```
create table the_table 
(
  [DateKey] INT,
)

insert into the_table
values
(20120101),
(20120102),
(20120201),
(20130601)

WITH myDateCTE(DateKey, Date) as
  (
    SELECT 
      DateKey
      ,[Date] = CONVERT(DATETIME, CONVERT(CHAR(8),DateKey),112) 
    FROM the_table
   )

SELECT 
  t.[DateKey]
  , m.[Date]
  , [QuarterNumber] = CONVERT(VARCHAR(20),Datepart(qq,Date))
  , [QuarterString] = 'Q' + CONVERT(VARCHAR(20),Datepart(qq,Date))
  , [Year] = Datepart(yyyy,Date) 
  , [Q-Yr] = CONVERT(VARCHAR(2),'Q' + CONVERT(VARCHAR(20),Datepart(qq,Date))) + '-' + CONVERT(VARCHAR(4),Datepart(yyyy,Date))  
FROM 
  the_table t
  inner join myDateCTE m
    on 
    t.DateKey = m.DateKey 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-07-09T04:15:59.160

```
SELECT
   Q.DateInQuarter,
   D.[Year],
   Quarter = D.Year + '-Q'
      + Convert(varchar(1), ((Q.DateInQuarter % 10000 - 100) / 300 + 1))
FROM
   dbo.QuarterDates Q
   CROSS APPLY (
      VALUES (Convert(varchar(4), Q.DateInQuarter / 10000))
   ) D ([Year])
; 
```

## [在 SQL Fiddle 上查看现场演示](http://sqlfiddle.com/#!3/ca50a/1)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-05-30T23:24:30.760

要获得您请求的确切输出，您可以使用以下命令：

```
CAST(DATEPART(YEAR, @Date) AS NVARCHAR(10)) + ' - Q' + CAST(DATEPART(QUARTER, @Date) AS NVARCHAR(10)) 
```

这将为您提供如下输出：“2015 - Q1”、“2013 - Q3”等。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-07-09T03:46:44.043

试试这个

```
SELECT  CONCAT (TO_CHAR(sysdate,'YYYY-'),concat ('Q',TO_CHAR(sysdate,'Q') ))from dual 
```

`sysdate`用您自己的列名替换为日期类型格式和`dual`您的表名

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-12-23T10:43:19.007

在这里，您可以看到更多选择之一：

```
SELECT CASE
         WHEN @TODAY BETWEEN @FY_START AND DATEADD(M, 3, @FY_START) THEN 'Q1'
         WHEN @TODAY BETWEEN DATEADD(M, 3, @FY_START) AND DATEADD(M, 6, @FY_START) THEN 'Q2'
         WHEN @TODAY BETWEEN DATEADD(M, 6, @FY_START) AND DATEADD(M, 9, @FY_START) THEN 'Q3'
         WHEN @TODAY BETWEEN DATEADD(M, 9, @FY_START) AND DATEADD(M, 12, @FY_START) THEN 'Q4'
       END 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-05-18T19:01:29.953

```
select 
  your_date, 
  CONCAT (TO_CHAR(your_date, 'YYYY-'),concat ('Q', date_part(quarter, your_date) ))
from table; 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-12-24T11:33:07.317

使用以`MONTH`数字形式返回月份的函数，我们可以轻松计算季度。

```
select date, CEILING((MONTH(date) * 4) / 12) quarter from dual 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-09-16T13:22:59.733

```
declare @TempTable table([Date] datetime)

insert into @TempTable([Date])
values('2008-01-02'),('2007-08-21')

select datepart(year, [Date]) as [year]
,convert(varchar(10),datepart(year, [Date])) + '-Q' + convert(varchar(3),datename(quarter, [Date])) as quarter_with_year
,datefromparts(datepart(year, [Date]),(convert(varchar(3),datename(quarter, [Date])) * 3)-2,1) as quarter_startdate
,eomonth(datefromparts(datepart(year, [Date]),convert(varchar(3),datename(quarter, [Date])) * 3,1)) as quarter_enddate
FROM @TempTable 
```

> 这将返回年份、季度和季度的开始结束日期。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2016-10-12T09:05:50.460

您必须将整数转换为 char(8)，然后转换为日期时间。然后将其包装在 SELECT DATEPART(QUARTER, [date])

然后，您必须将上述内容转换为字符并添加“-”+年份（也转换为字符）

上面的算术溢出是由于省略了初始转换为字符类型造成的。

我倾向于在可能的情况下使用视图将转换抽象为日期时间，然后在需要时使用四分之一函数和字符转换。

* * *

## 回答 #17

> 赞同：-2
> 
> 时间：2020-03-05T15:57:27.100

尝试以下操作：

```
CONCAT(datepart(yyyy,DATE),'-', DATEPART(qq,DATE)) 
```

它返回：

```
yyyy-q 
```

示例：`2017-3`对于`2017-07-11`

# java - 向我的表示层调用服务层方法

> ID：11141105
> 
> 赞同：-3
> 
> 时间：2012-06-21T15:06:08.333
> 
> 标签：java

好的，我觉得问这个真的很愚蠢，但我似乎在这里遗漏了一些非常简单的东西。我的服务层的一个类中有以下代码 -

```
public Items getItems(String category, float amount, String color,
            String type) 
```

代码从数据库中读取并返回结果——我计划将它放在 jframe 中。很好很简单。但无论我如何从 jframe 中调用它，我都会在 eclipse 中得到错误，即代码错误——它们是非法修饰符等。所以很明显我把它称为完全错误的，所以我愚蠢的问题是你如何将该方法调用到 jframe 中？

例如 - 如果我尝试这样称呼它：

```
public Items getItems(); 
```

我被告知 getItems 是一个非法参数。如果我称之为.. Items getItems(); 有人告诉我它未定义

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T15:14:26.797

由于您在那里放置了一些代码，因此您调用了错误的方法；你所拥有的不是有效的 Java。

首先，您需要获取服务的实例。

`MyService service = new MyServiceImpl();`

我假设您的服务被定义为一个接口 ( `MyService`)，并带有一个实现接口 ( `MyServiceImpl`) 的类。

然后你调用实例上的方法

`Items items = service.getItems(stuff);`

你有什么

`public Items getItems();`

是方法定义和方法调用之间的某种混合。

# web-services - Salesforce.com 从身份验证令牌中查找用户 ID

> ID：11141107
> 
> 赞同：0
> 
> 时间：2012-06-21T15:06:16.983
> 
> 标签：web-services, salesforce, apex-code

我正在实现一种从用户接收身份验证令牌的方法。基于该令牌，我如何获取拥有该令牌的用户的 ID？iPhone 应用程序正在调用该方法。这是方法声明：

```
global static void getItems(String authToken) 
```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-23T00:04:42.357

如果您能够调用 REST api 的发现服务 @superfell 提供了一个很好的答案，应该可以让您解决您的问题：

[如何判断实例特定的 Salesforce URL 是来自沙盒还是生产？](https://stackoverflow.com/questions/11146286/how-to-tell-if-instance-specfic-salesforce-url-is-from-sandbox-or-production)

# iphone - 检测触摸 Cocos2d-x

> ID：11141112
> 
> 赞同：6
> 
> 时间：2012-06-21T15:06:27.130
> 
> 标签：iphone, c++, objective-c, cocos2d-iphone, cocos2d-x

我正在使用 Cocos2d-x 并尝试在我的 HelloWorld 项目中检测触摸。虽然我没有运气。

。H

```
class HelloWorld : public CCLayer{

private:
    CCSpriteBatchNode * _batchNode;
    CCSprite *_turkey;
    virtual void ccTouchesBegan(cocos2d::CCSet* touches, cocos2d::CCEvent* event); 
```

.ccp

```
void HelloWorld::ccTouchesBegan(cocos2d::CCSet* touches, cocos2d::CCEvent* event){
    CCLog("this");
} 
```

但问题是，当我点击屏幕时，“this”永远不会出现在日志中。我在这里想念什么？

谢谢！

编辑，

我正在使用本教程。 [http://www.raywenderlich.com/11338/cocos2d-x-for-ios-and-android-space-game](http://www.raywenderlich.com/11338/cocos2d-x-for-ios-and-android-space-game)

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-06-21T15:11:58.030

您必须注册 CCTouchDispatcher 才能接收触摸：

将其写入您的`init()`方法中以接收触摸：

```
CCTouchDispatcher::sharedDispatcher()->addStandardDelegate(this, 0); 
```

我还建议您通过有针对性的触摸委托方法接收触摸事件：

```
virtual bool ccTouchBegan(CCTouch *pTouch, CCEvent *pEvent);
virtual void ccTouchMoved(CCTouch *pTouch, CCEvent *pEvent);
virtual void ccTouchEnded(CCTouch *pTouch, CCEvent *pEvent);
virtual void ccTouchCancelled(CCTouch *pTouch, CCEvent *pEvent); 
```

为了调用这些方法，您必须向触摸调度程序注册一些不同的内容：

```
CCTouchDispatcher::sharedDispatcher()->addTargetedDelegate(this, 0, true); 
```

**编辑**

在新的 cocos 版本`CCTouchDispatcher`中位于`CCDirector`：

它应该看起来像这样：

```
CCDirector::sharedDirector()->getTouchDispatcher()->addTargetedDelegate(this, 0, true); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-21T16:38:06.483

所以一些超级简单的东西，刚刚添加

`this->setIsTouchEnabled(true);`

到我的 init(); 功能。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-27T00:04:11.387

```
'this' never shows up in the log 
```

*提示*您可能正在使用不同版本的 Cocos2D 库。请转到`cocos2d.h`您的项目并确认。（样本写在 1.0.1 上）。如果您使用的是不同的版本，（*猜测*）您可能必须使用不同的`ccTouchesBegan`签名和/或修复更多内容，而不仅仅是`setIsTouchEnabled`使其工作。我刚刚下载了示例，`ccTouchesBegan`通话效果很好 - 没有任何更改。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-17T14:53:10.147

`this->setTouchEnabled(true);`比`CCTouchDispatcher::sharedDispatcher()->addTargetedDelegate(this, 0, true);`不幸的是我的 ccTouchMoved 没有捡起任何东西更好...... :(

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-06-19T13:39:30.563

cocos2d-x v3.0..

把它写在你的“.h”文件中

```
{bool onTouchBegan (cocos2d::Touch * touch, cocos2d::Event * event);} 
```

把这个写在你的' `init()' function`..

```
{
auto listner = EventListenerTouchOneByOne::create();

listner->setSwallowTouches(true);    

listner->onTouchBegan = CC_CALLBACK_2(Gameplay::onTouchBegan, this);

_eventDispatcher->addEventListenerWithSceneGraphPriority(listner, this);
} 
```

并将其写入“.cpp”文件中..

```
bool "YOURCLASSNAME"::onTouchBegan(cocos2d::Touch* touch, cocos2dEvent* event)
{   
        CCLOG("this");
             return true;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-06-05T01:22:49.470

在下面的方法中，我在 Sprite 上应用触摸，如果你想在 TextField 、 Node 、 Background 或任何组件上应用触摸事件，只需将该 ComponentType 传递到此方法中，它将起作用....

好的，让我们开始吧！！！！

```
void YourClassName::YourListnerMethodName(cocos2d::Sprite* object)
{
   auto listener = cocos2d::EventListenerTouchOneByOne::create();
   listener->setSwallowTouches(false);

    listener->onTouchBegan = [=](cocos2d::Touch* touch, cocos2d::Event* event)
    {
       auto target = event->getCurrentTarget();
       Point locationInNode = target->convertToNodeSpace(touch->getLocation());

       // Suppose your sprite or any component is inside in any parent object then use this line instead of above line ... 
       //just uncomment below line and it will work fine in this case   
       //Point locationInNode = target->getParent()->convertToNodeSpace(touch->getLocation());

        if (target->getBoundingBox().containsPoint(locationInNode)) {

           // CODE FOR RESPONSE AFTER TOUCH

            return true;
        }
        return false;
    };

    _eventDispatcher->addEventListenerWithSceneGraphPriority(listener, object);
} 
```

这里的目标是你的组件，你想在它上面应用触摸

只是不要忘记根据您的要求从 ctor 或任何地方调用此方法

# c# - 从任务中更新一个 int 变量？

> ID：11141113
> 
> 赞同：3
> 
> 时间：2012-06-21T15:06:27.183
> 
> 标签：c#, winforms, .net-4.0, locking, task

我目前有一个函数，它将根据数据量创建函数的 X 个任务，我想用每个线程执行了多少数据来更新一个 int 变量以显示一个进度条。

目前我所有的 UI 都是从计时器更新的，所以我不会从线程委派来更新 UI（我相信在这种情况下会更麻烦），我将使用稍后将由计时器选取的计数来更新变量并更新用户界面。

我想知道的是，锁是更新变量的好方法还是有更好的方法？

如果非常频繁地使用该变量，计时器是否能够读取该变量，或者即使在更新时它的值较旧，它仍然能够读取它？

这是一个粗略的例子：

```
private static readonly object counterLock = new object();
int myCounter = 0;

private void FunctionExecutedByAllRunnningThreads()
{
    int executed = 0;
    foreach (some data)
    {
        //do something with this data
        executed++;
    }
    lock (counterLock)
        myCounter += executed;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-21T15:08:22.720

> 我想知道的是，锁是更新变量的好方法还是有更好的方法？

如果您只是增加值，则可以使用[Interlocked.Increment](http://msdn.microsoft.com/en-us/library/dd78zt0c.aspx)安全地增加它而无需`lock`.

如果您想批量处理，[Interlocked.Add](http://msdn.microsoft.com/en-us/library/system.threading.interlocked.add)将让您一次性将您的线程本地总值添加到计数器，再次无需锁定。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T15:08:54.243

用于`Interlocked.Add()`此。（您不能使用`Interlocked.Increment()`，因为您似乎向计数器添加了超过 1）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-21T15:08:54.893

.NET 包含一种为您安全地执行此操作的方法。[`Interlocked.Increment`](http://msdn.microsoft.com/en-us/library/dd78zt0c.aspx)

你也可以使用[`Interlocked.Add`](http://msdn.microsoft.com/en-us/library/33821kfh), 还有很多其他有用的方法[`Interlocked`](http://msdn.microsoft.com/en-us/library/5kczs5b5)

```
int myCounter = 0;

private void FunctionExecutedByAllRunnningThreads()
{
    int executed = 0;
    foreach (some data)
    {
        //do something with this data
        executed++;
    }
    Interlocked.Add(ref myCounter, executed);
} 
```

# c# - 带有自定义标头的 HTTP Post 请求

> ID：11141116
> 
> 赞同：5
> 
> 时间：2012-06-21T15:06:37.443
> 
> 标签：c#, http-headers

我想从 C# 发出 HTTP Post 请求。此请求具有自定义标头。当我尝试启动我的程序时，我收到了这个异常：

意大利语：

> Questa intestazione deve essere modificata utilizzando la proprietà o il metodo appropriato。名称参数：名称

英语：

> 必须使用适当的属性或方法修改此标头。

在线的：`request.Headers.Add("Content-Type", "text/x-gwt-rpc; charset=utf-8");`

这是我的代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Net;
using System.Collections.Specialized;
using System.IO;
using System.Text.RegularExpressions;
using System.Dynamic;
using System.Collections;
using System.Collections.ObjectModel;
using System.Net.Security;
using System.Web;

namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {
            WebRequest request = WebRequest.Create("http://www.androidlost.com/androidlost/greet");
            request.Method = "POST";
            request.Headers.Add("Content-Type", "text/x-gwt-rpc; charset=utf-8");
            string postData = "Test";
            byte[] byteArray = Encoding.UTF8.GetBytes(postData);
            request.ContentLength = byteArray.Length;
            Stream dataStream = request.GetRequestStream();
            dataStream.Write(byteArray, 0, byteArray.Length);
            dataStream.Close();
         }
    }
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-21T15:13:54.910

使用 WebRequest.ContentType 属性。某些标头只能使用 API 属性进行设置。

编辑：

```
HttpWebRequest request = (HttpWebRequest)WebRequest.Create("http://www.androidlost.com/androidlost/greet");
request.ContentType = "text/x-gwt-rpc; charset=utf-8"; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-21T15:11:33.787

根据 MSDN 文档，[HttpWebRequest.Header 属性](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.headers.aspx)。

Content-Type 使用该`ContentType`属性进行修改。这要求您`WebRequest`将`HttpWebRequest`

```
HttpWebRequest request = (HttpWebRequest)WebRequest.Create("http://www.androidlost.com/androidlost/greet"); 
```

# java - GWT RequestFactory - 1 EntityProxy 的不同视图

> ID：11141118
> 
> 赞同：0
> 
> 时间：2012-06-21T15:06:43.200
> 
> 标签：java, requestfactory

我有一个具有以下方法的 DocumentEntityProxy：

```
String getAttribute1();
void setAttribute1(String s);
String getAttribute2();
void setAttribute2(String s);
String getAttribute3();
void setAttribute3(String s); 
```

我想要实现的是，如果您是标准用户，则只能使用 getAttribute1() 和 setAttribute1() 如果您是管理员用户，则可以使用所有方法。在这个例子中，我只有三个属性和 2 个不同类型的用户，但在实际项目中当然还有更多。

实现这一目标的最佳方法是什么？

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T08:16:53.280

您可以使用继承：

```
class UserEntity {
  String getAttribute1() { }
  void setAttribute1(String s) { }
}

class AdminEntity extends UserEntity {
  String getAttribute2() { }
  void setAttribute2(String s) { }
} 
```

和代理：

```
@ProxyFor(UserEntity.class)
interface UserEntityProxy extends EntityProxy {
  String getAttribute1();
  void setAttribute1(String s);
}

@ProxyFor(AdminEntity.class)
interface AdminEntityProxy extends UserEntityProxy {
  String getAttribute2();
  void setAttribute2(String s);
} 
```

为了保护对实体类型的访问，您可以使用两个查找器方法（返回 userEntity 或 adminEntity）并限制对后端方法的访问，例如使用 SpringSecurity 的 @Secured 注释。

# php - Chrome 拒绝加载 MooTools

> ID：11141119
> 
> 赞同：0
> 
> 时间：2012-06-21T15:06:43.010
> 
> 标签：php, javascript, google-chrome, mootools

Chrome 只是拒绝运行任何 Javascript。它`Failed to load resource`在调试面板中显示了一个，并突出显示了这一行：

```
<script src="js/mootools/core-1.4.5-full-nocompat.js" type="text/javascript"></script> 
```

Internet Explorer、Firefox 和 Opera 都可以适当地运行 Javascript。我正在使用一个 PHP 页面，其中内容被捕获到一个字符串，然后在对其执行函数后返回。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T13:48:19.617

问题是页面`Content-Length`在返回 HTML 之前没有正确报告标题（这是我不应该做的事情，因为我从未接触过它）。使用字符串 $html 中捕获的 HTML：

```
header('Content-Length: '.strlen($html)); 
```

# bash - 退出函数堆栈而不退出 shell

> ID：11141120
> 
> 赞同：39
> 
> 时间：2012-06-21T15:06:46.567
> 
> 标签：bash, function, shell, exit

我正在写一个脚本，然后遇到了一个奇怪的问题。如果我要获取一个包含一堆函数的脚本，这些函数可能会调用一个错误函数，该函数输出一个字符串然后退出，它将退出我的 shell。我知道它为什么这样做。这是因为函数调用与调用者在同一个进程空间中（至少它在 bash 中），所以函数内的退出使用提供的退出代码终止当前进程。例子：

```
error()
{
  echo $1
  exit 1
}

fn()
{
  if [ $# == 0 ]; then
    error "Insufficient parameters."
  fi
  # do stuff
}

$ fn
Insufficient parameters.
[shell terminates] 
```

所以我的问题是，我可以退出函数堆栈中的所有函数而不终止当前 shell 并且不产生新的子 shell 吗？

谢谢

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2013-06-17T17:50:03.767

要在不退出 shell 的情况下退出函数堆栈，可以使用以下命令：

```
kill -INT $$ 
```

正如[比萨](https://stackoverflow.com/users/1276280/pizza)所说，这就像按 Ctrl-C 一样，它将停止当前脚本的运行并将您带到命令提示符。

* * *

注意：我没有选择[Pizza](https://stackoverflow.com/users/1276280/pizza)的答案的唯一原因是因为这被埋在他/她的答案中而没有直接回答。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-06-21T23:15:38.720

你可以做一个

```
exit() { return $1;} 
```

然后

```
source ./your_script 
```

作为对怀疑论者的回答，这只会影响当前的 shell，不会影响你生成的 shell。

信息量更大的表格可以是

```
exit() {
    local ans
    local line
    read -p "You really want to exit this? " line
    ans=$(echo $line)
    case "$ans" in
            Y);;
            y);;
            *)kill -INT $$;;
    esac
    unset -f exit
    exit $1
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-06-21T15:30:59.110

您需要向`return`每个函数添加语句，以检查它们依次调用的任何函数的返回值。获取文件就像将代码剪切并粘贴到当前上下文中，除了`$BASH_SOURCE`.

或者，您可以定义`fn`为一个 shell 脚本，这样就可以满足`exit`您的需求（除非 fork 太贵）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-21T15:21:08.347

using`return`语句，但调用错误后需要添加return

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-06-21T15:22:37.270

shell 并没有真正的异常机制来一次回退许多函数调用。您只需检查返回值并一直手动返回。

# python - lamson：邮件地址格式

> ID：11141122
> 
> 赞同：0
> 
> 时间：2012-06-21T15:07:02.083
> 
> 标签：python, encoding, character-encoding, lamson

我正在为一个项目使用带有队列接收器的 Lamson SMTP 服务器。它工作正常，但有时我会在默认测试环境下使用 mutt 发送的电子邮件中的“to”和“cc”标头中收到奇怪的地址电子邮件。

前任。一封电子邮件发送到

```
test@test.com 
```

with mutt 将被发送到 SMTPReceiver，放入 maildir 并使用 QueueReceiver 进行处理。我最终得到的是

```
test@xn--est-o0a.com 
```

我猜它与编码有关，但由于 Lamson 应该提供干净的 unicode 字符串……我不知道。

任何想法？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T15:17:48.260

根据[这个工具](http://mct.verisign-grs.com/conversiontool/convertServlet?input=xn--est-o0a&type=PUNYCODE)，xn--est-o0a 表示 ŧest，而不是测试。

# android - 创建现有android eclipse项目的继承图/uml图

> ID：11141125
> 
> 赞同：2
> 
> 时间：2012-06-21T15:07:10.930
> 
> 标签：android, uml

我想创建一个大型现有 android 应用程序的继承图（UML 视图中的类图）。我正在研究的应用程序包含很多继承、抽象类、接口。因此，跟踪整个项目变得非常困难。

因此，如果 Eclipse 存在任何可以帮助我做到这一点的插件，请与我分享。

提前致谢..

# java - 我们如何发送在 html 中使用的图像作为 JAVA 中电子邮件的附件？

> ID：11141132
> 
> 赞同：2
> 
> 时间：2012-06-21T15:07:41.117
> 
> 标签：java, jakarta-mail, ireport, email-attachments

我正在尝试发送通过 java 代码生成的报告。我正在使用 jasper 报告来生成各种报告。在我的报告中，我在标题中有图像。这适用于除 HTML 之外的所有报告格式（PDF、XLS、RTF）。它不会在 HTML 报告中显示图像，因为它无法找到图像。

如何通过电子邮件发送图像并使用 Java Mail 与 HTML 报告一起使用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T15:12:27.923

当我做我的JavaMail客户端时，下面有你发送附件等所需的一切：[发送电子邮件的Java](http://www.tutorialspoint.com/java/java_sending_email.htm)和这里：[Java在JavaMail中发送嵌入式图像](http://www.jroller.com/eyallupu/entry/javamail_sending_embedded_image_in)和这里[发送带有图像的HTML电子邮件](http://javaeenotes.blogspot.com/2010/04/sending-html-email-with-images-with.html)似乎更指向你的方向。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T15:19:32.643

您可以使用绝对 URL（例如[http://servername.com/images/xyz.jpg](http://servername.com/images/xyz.jpg)）而不是相对 URL。JasperReport 可以配置为使用绝对 URL。

或者

我不知道这是否适用于嵌入式电子邮件。但是您可以尝试使用**内联图像**，您必须将图像转换为 base64 字符串。如果图像太大并且在图像更改时难以维护，这将增加 HTML 的大小。

```
<img src="data:image/gif;base64,R0lGODlhEAAOALMAAOazToeHh0tLS/7LZv/0jvb29t/f3//Ub/    /ge8WSLf/rhf/3kdbW1mxsbP//mf///yH5BAAAAAAALAAAAAAQAA4AAARe8L1Ekyky67QZ1hLnjM5UUde0ECwLJoExKcppV0aCcGCmTIHEIUEqjgaORCMxIC6e0CcguWw6aFjsVMkkIr7g77ZKPJjPZqIyd7sJAgVGoEGv2xsBxqNgYPj/gAwXEQA7" width="16" height="14" alt="embedded folder icon"> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T15:18:52.803

它适用于 PDF、XLS 和 RTF，因为 img 存储在文档中！

使用 HTML，您不能这样做，您必须参考。带有 src 属性的 img 并将 img 作为附件包含在您的邮件中，以便可以阅读。

或者

使您的图像可以通过 http 从 Web 服务器访问并指向 src=http://myimgserver.com/myimg.jpg

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-07T11:42:29.313

使用带有嵌入式图像和附件的 JavaMail 发送 html 电子邮件。（我的上一篇文章被删除了，因为它是一个链接（[https://github.com/QuickrWorld/email-sender.git](https://github.com/QuickrWorld/email-sender.git)）。我认为这一点是有效的——如果 git 存储库被删除或修改得如此之多以至于它不再是一个有效的答案？）。所以我直接在下面的响应中添加了代码。不过，我仍然想知道为什么我的答案被挑出来删除。这篇文章中的其他答案也只是链接。还是我错过了什么？）

```
// EmailSender.java
package com.quickrworld.mail;
import java.net.MalformedURLException;
import java.net.URL;
import java.util.List;
import java.util.Properties;

import javax.activation.DataHandler;
import javax.activation.DataSource;
import javax.activation.FileDataSource;
import javax.activation.URLDataSource;
import javax.mail.BodyPart;
import javax.mail.Message;
import javax.mail.MessagingException;
import javax.mail.Multipart;
import javax.mail.Session;
import javax.mail.Transport;
import javax.mail.internet.InternetAddress;
import javax.mail.internet.MimeBodyPart;
import javax.mail.internet.MimeMessage;
import javax.mail.internet.MimeMultipart;

public class EmailSender {
  static Properties p = null;
  static Properties getDefaultProperties() {
    if (p == null) {
      p = new Properties();
      String mailSmtpHost = "smtp.gmail.com";
      String mailSmtpAuth = "true";
      String mailSmtpPort = "465";
      String mailSmtpSocketFactoryPort = "465";
      String mailSmtpSocketFactoryClass = "javax.net.ssl.SSLSocketFactory";
      String mailSmtpSocketFactoryFallback = "false";
      String mailDebug = "false";
      p.put("mail.smtp.host", mailSmtpHost);
      p.put("mail.smtp.auth", mailSmtpAuth);
      p.put("mail.smtp.port", mailSmtpPort);
      p.put("mail.smtp.socketFactory.port", mailSmtpSocketFactoryPort);
      p.put("mail.smtp.socketFactory.class", mailSmtpSocketFactoryClass);
      p.put("mail.smtp.socketFactory.fallback",
          mailSmtpSocketFactoryFallback);
      // p.put("mail.smtp.starttls.enable","true");
      // p.put("mail.smtp.EnableSSL.enable","true");
      p.put("mail.debug", mailDebug);
    }
    return p;
  }

  public void sendMessage(
      String mailSubject, 
      String mailFrom,
      List<String> mailTos, 
      List<String> mailCcs, 
      List<String> mailBccs,
      String html, 
      List<ImageResource> images, 
      List<Resource> attachments,
      Properties p, 
      String user, 
      String password) throws MessagingException, MalformedURLException {
    Session s = Session.getInstance(p);
    Message m = new MimeMessage(s);
    m.setSubject(mailSubject);
    InternetAddress from = new InternetAddress(mailFrom);
    for (String mailTo : mailTos) {
      InternetAddress to = new InternetAddress(mailTo);
      m.addRecipient(Message.RecipientType.TO, to);
    }
    for (String mailCc : mailCcs) {
      InternetAddress cc = new InternetAddress(mailCc);
      m.addRecipient(Message.RecipientType.CC, cc);
    }
    for (String mailBcc : mailBccs) {
      InternetAddress bcc = new InternetAddress(mailBcc);
      m.addRecipient(Message.RecipientType.BCC, bcc);
    }
    m.setFrom(from);
    Multipart multipart = new MimeMultipart("related");
    // html
    BodyPart htmlPart = new MimeBodyPart();
    htmlPart.setContent(html, "text/html");
    multipart.addBodyPart(htmlPart);
    // images
    for (ImageResource imageResource : images) {
      String path = imageResource.getPath();
      String fileName = imageResource.getName();
      String cid = imageResource.getCid();
      boolean isURL = imageResource.isURL();
      addImageWithCid(multipart, path, fileName, cid, isURL);
    }
    // attachments
    for (Resource attachment : attachments) {
      addAttachment(multipart, attachment);
    }
    // message
    m.setContent(multipart);
    // send
    Transport transport = s.getTransport("smtp");
    transport.connect(user, password);
    transport.sendMessage(m, m.getAllRecipients()); // Actually this can be any valid address set
    transport.close();
  }

  private void addAttachment(Multipart multipart, 
      Resource attachment) throws MessagingException, MalformedURLException {
    String attachmentPath = attachment.getPath();
    String attachmentName = attachment.getName();
    boolean isURL = attachment.isURL();
    if(isURL) {
      BodyPart attachmentBodyPart = new MimeBodyPart();
      URL attachmentURL = new URL(attachmentPath);
      URLDataSource source = new URLDataSource(attachmentURL);
      attachmentBodyPart.setDataHandler(new DataHandler(source));
      attachmentBodyPart.setFileName(attachmentName);
      multipart.addBodyPart(attachmentBodyPart);      
    } else {
      BodyPart attachmentBodyPart = new MimeBodyPart();
      DataSource source = new FileDataSource(attachmentPath);
      attachmentBodyPart.setDataHandler(new DataHandler(source));
      attachmentBodyPart.setFileName(attachmentName);
      multipart.addBodyPart(attachmentBodyPart);
    }
  }

  private void addImageWithCid(
      Multipart multipart, 
      String imageFilePath,
      String imageFileName,
      String imageFileCid, 
      boolean isURL) throws MessagingException, MalformedURLException {    
    if(isURL) {
      BodyPart imgPart = new MimeBodyPart();
      URL imageFileURL = new URL(imageFilePath);
      URLDataSource ds = new URLDataSource(imageFileURL);
      imgPart.setDataHandler(new DataHandler(ds));
      imgPart.setHeader("Content-ID", imageFileCid);
      imgPart.setFileName(imageFileName);
      multipart.addBodyPart(imgPart);
    } else {
      BodyPart imgPart = new MimeBodyPart();
      DataSource ds = new FileDataSource(imageFilePath);
      imgPart.setDataHandler(new DataHandler(ds));
      imgPart.setHeader("Content-ID", imageFileCid);
      imgPart.setFileName(imageFileName);
      multipart.addBodyPart(imgPart);
    }
  }
}
// Resource.java
package com.quickrworld.mail;

public class Resource {
  private String path;
  private String name;
  private boolean isURL;
  public Resource() {

  }
  public Resource(String path, boolean isURL) {
    this(path, path, isURL);
  }
  public Resource(String path, String name, boolean isURL) {
    this.path = path;
    this.name = name;
    this.isURL = isURL;
  }
  public String getPath() {
    return path;
  }
  public void setPath(String path) {
    this.path = path;
  }
  public String getName() {
    return name;
  }
  public void setName(String name) {
    this.name = name;
  }
  public boolean isURL() {
    return isURL;
  }
  public void setURL(boolean isURL) {
    this.isURL = isURL;
  }
}
// ImageResource.java
package com.quickrworld.mail;

public class ImageResource extends Resource {
  private String cid;
  public ImageResource() {
    super();
  }
  public ImageResource(String path, String name, String cid, boolean isURL) {
    super(path, name, isURL);
    this.cid = cid;
  }
  public String getCid() {
    return cid;
  }
  public void setCid(String cid) {
    this.cid = cid;
  }
}
// EmailMain.java
package com.quickrworld.mail;
import java.net.MalformedURLException;
import java.util.ArrayList;
import java.util.List;
import java.util.Properties;

import javax.mail.MessagingException;

public class EmailMain {
  // Please ensure you have a tomcat running on port 8080 on localhost (for tomcat.png and favicon.ico)
  // please ensure you have files file1.txt and file2.txt in the working directory (for attachments)
  public static void main(String[] args) {
    EmailSender emailSender = new EmailSender();
    String mailSubject = "My Mail Subject (Named)";
    String mailFrom = "from@mailfrom.com";
    List<String> mailTos = new ArrayList<String>();
    mailTos.add("mailto@maito.com");
    List<String> mailCcs = new ArrayList<String>();
    mailCcs.add("mailcccs@mailccs.com");
    List<String> mailBccs = new ArrayList<String>();
    mailBccs.add("mailbccs.mailbccs@mailbccs.com");
    String html = "<html><body><h2>Heading</h2>Our logo:<br/>"
        + "<img src=\"cid:img-cid-1\"/><br/>See images in the email - and two attachments<br/>"
        + "<div><img src=\"cid:img-cid-2\"/></div></body></html>";
    // remove the values for user and password before posting to git
    String user = "x@y.com";
    String password = "password";
    Properties p = EmailSender.getDefaultProperties();
    p.put("mail.debug", "true");
    List<ImageResource> imageResources = new ArrayList<ImageResource>();
    imageResources.add(new ImageResource("logo.png","logo.png","<img-cid-1>",false));
    imageResources.add(new ImageResource("http://localhost:8080/favicon.ico","favicon.ico","<img-cid-2>",true));    
    List<Resource> attachmentResources = new ArrayList<Resource>();
    attachmentResources.add(new Resource("file1.txt", "attached-file1.txt", false));
    attachmentResources.add(new Resource("file2.txt", "attached-file2.txt", false));
    attachmentResources.add(new Resource("http://localhost:8080/tomcat.gif","attached-tomcat.gif",true));    
    try {
      emailSender.sendMessage(mailSubject, mailFrom, mailTos, mailCcs,
          mailBccs, html, imageResources,
          attachmentResources, p, user, password);
    } catch (MessagingException e) {
      e.printStackTrace();
    } catch (MalformedURLException e) {
      e.printStackTrace();
    }
  }
} 
```

# android - 使用 BroadcastReceiver 在 Tabactivity 中更新 childActivity 的 UI

> ID：11141135
> 
> 赞同：0
> 
> 时间：2012-06-21T15:07:46.013
> 
> 标签：android, broadcastreceiver

我有一个广播接收器，在名为**childActivity**的活动中如下所示。

```
 registerReceiver(new BroadcastReceiver(){
    @Override
    public void onReceive(Context arg0, Intent arg1) {
    switch (getResultCode()){
.
.
.
.
.
.
}
     }, new IntentFilter(XYZ)); 
```

现在我想从这个广播接收器更新 childActivity 中的主 UI 线程（一个简单的**textView ）。**我通常会做类似的事情

```
Intent intent = new Intent(context, childActivity.class); 
intent.setFlags( Intent.FLAG_ACTIVITY_NEW_TASK); 
intent.putExtra("parameter",str);
context.startActivity(intent); 
```

但是，**childActivity**加载到**tabActivity**的选项卡之一中。我现在如何更新 childActivity 的 UI？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T06:55:56.580

似乎没有一种简单的方法可以做到这一点。因此，我在 childActivity 调用的 tabActivity 父级中创建了一个方法。

这样，意图可以传递给父级，从而修改加载的选项卡的状态。似乎没有办法直接访问子活动。

# javascript - 默认的 JavaScript 字符编码是什么？

> ID：11141136
> 
> 赞同：41
> 
> 时间：2012-06-21T15:07:48.400
> 
> 标签：javascript, html, character-encoding

在用 JavaScript 编写加密方法时，我开始想知道我的字符串使用的是什么字符编码，以及为什么。

什么决定了 JavaScript 中的字符编码？是标准吗？通过浏览器？由 HTTP 请求的标头决定？在`<META>`包含它的 HTML 标记中？提供页面的服务器？

通过我的经验测试（更改不同的设置，然后使用`charCodeAt`一个足够奇怪的字符并查看该值与哪个编码匹配），它似乎总是 UTF-8 或 UTF-16，但我不确定*为什么*。

[经过一番疯狂的谷歌搜索后，我似乎无法为这个简单的问题找到一个确凿的答案。]

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-06-21T15:17:47.927

E262 第 8.4 节：

> String 类型是零个或多个 16 位无符号整数值（“元素”）的所有有限有序序列的集合。String 类型通常用于表示正在运行的 ECMAScript 程序中的文本数据，在这种情况下，String 中的每个元素都被视为一个代码单元值（参见第 6 条）。每个元素都被视为在序列中占据一个位置。这些位置用非负整数索引。第一个元素（如果有）在位置 0，下一个元素（如果有）在位置 1，依此类推。字符串的长度是其中元素的数量（即 16 位值）。空字符串的长度为零，因此不包含任何元素。
> 
> 当一个字符串包含实际的文本数据时，每个元素都被认为是一个 UTF-16 代码单元。无论这是否是字符串的实际存储格式，字符串中的字符都按其初始代码单元元素位置编号，就好像它们使用 UTF-16 表示一样。对字符串的所有操作（除非另有说明）都将它们视为未区分的 16 位无符号整数序列；他们不确保生成的字符串是规范化的形式，也不确保语言敏感的结果。

这个措辞有点狡猾。这似乎意味着所有重要的东西都将字符串视为每个字符都是 UTF-16 字符，但同时没有任何东西可以确保它都是有效的。

需要明确的是，其*意图*是字符串由 UTF-16 代码点组成。在[ES2015](https://en.wikipedia.org/wiki/ECMAScript#6th_Edition_%E2%80%93_ECMAScript_2015)中，“字符串值”的定义包括以下注释：

> String 值是 String 类型的成员。序列中的每个整数值通常代表一个 16 位的 UTF-16 文本单元。但是，ECMAScript 对这些值没有任何限制或要求，只是它们必须是 16 位无符号整数。

因此，即使字符串包含不能用作正确 Unicode 字符的值，它仍然是字符串。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-06-21T16:39:17.060

JavaScript 本身没有默认的字符编码。就规范而言，JavaScript 程序是一系列抽象字符。当通过网络传输或仅存储在计算机中时，抽象字符必须以某种方式进行编码，但其机制不受 ECMAScript 标准的控制。

[ECMAScript](http://www.ecma-international.org/publications/standards/Ecma-262.htm)标准的第 6 节使用 UTF-16 作为参考编码，但没有将其指定为默认编码。使用 UTF-16 作为参考在逻辑上是不必要的（参考 Unicode 数字就足够了），但它可能被认为可以帮助人们。

不应将此问题与字符串文字或一般字符串的解释相混淆。像“Φ”这样的文字需要与程序的其余部分一起进行某种编码；这可以是任何编码，但在解析编码后，文字将根据字符的 Unicode 编号解释为整数。

当通过 Internet 传输 JavaScript 程序（如“外部 JavaScript 文件”）时，适用[RFC 4329](https://www.rfc-editor.org/rfc/rfc4329)，脚本媒体类型。第 4 条定义了机制：主要检查诸如 HTTP 标头之类的标头，并且`charset`那里的参数将被信任。（实际上，Web 服务器通常不会为 JavaScript 程序指定这样的参数。）其次，应用 BOM 检测。否则，将隐含 UTF-8。

该机制的第一部分有些模棱两可。它可能被解释为`charset`仅与实际 HTTP 标头中的参数相关，或者可能被扩展到元素中的`charset`参数。`script`

如果 JavaScript 程序嵌入在 HTML 中，无论是通过`script`元素还是某个事件属性，那么它的字符编码当然与 HTML 文档的字符编码相同。[指定 HTML 4.01 规范的字符编码](http://www.w3.org/TR/REC-html40/charset.html#h-5.2.2)部分定义了解析机制，按以下顺序：`charset`在 HTTP 标头中，`charset`在 中`meta`，`charset`在访问文档所遵循的链接中，最后是启发式（猜测），这可能涉及很多事情；参看。[HTML5 草案中](http://www.whatwg.org/specs/web-apps/current-work/multipage/parsing.html#determining-the-character-encoding)复杂的解析机制。

# 3d - 顶点“磁畸变”的 3d 算法

> ID：11141139
> 
> 赞同：2
> 
> 时间：2012-06-21T15:07:58.217
> 
> 标签：3d, three.js

给定一个由三角形顶点组成的实体、无纹理的 3D 形状，并使用所有 x、y、z 点访问其顶点数组，如何实现多个“磁场”来扭曲该形状？比如说，每个磁场都是一个随机的物体内部或外部位置 x、y、z 的点，以及一个强度；如果它靠近这种形状的顶点，它会将它“拉”向它，越靠近越强（也通过它的强度值进行调整）......导致平滑的颠簸和移动。

我目前正在使用 ThreeJS (JavaScript/WebGL)，所以对 JavaScript、ThreeJS 或伪代码的帮助可能是完美的，但任何东西都可以！谢谢！

![在此处输入图像描述](../Images/86416846a26b66240e915e84bc94e318.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T19:22:56.610

如果您不想转换为隐式曲面（如@ananthonline 所述），您可以根据“磁铁”强度和位置调整所有顶点。请注意，以下不会创建任何新顶点，只会吸引现有顶点；这可能是优点或缺点，具体取决于您的应用程序。

给定一个磁铁位置`M`，您可以将每个顶点调整`V`到一个新位置`V'`，如下所示：

```
point V =     [incoming vertex]
point M =     [magnet location]
float range = [chosen nominal range for the magnetic effect]

float range2 = range * range  [range squared, for comparison with squared distance]
vector MV = V - M             [vector from M to V]
float alpha = range2 / (range2 + dot(MV, MV))  [weighting factor]
point V' =  alpha * M + (1-alpha) * V          [new, "magnetized" position] 
```

`range`距离数倍的顶点`M`只会受到最小的影响。内部的顶点`range`会被强烈吸引，但不会发疯。每个磁化顶点将位于其原始位置之间的线上`M`，这将产生“褶皱”效应：磁化位置在磁铁附近会更密集，但会牺牲它们被吸引的区域。

如果您不喜欢磁效应的确切形状（例如，如果您想确保超出一定距离的顶点根本不移动），您可以调整`alpha`. 只要确保`alpha`不超过`1`，并`0`随着`dot(MV, MV)`变大而接近。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T15:45:32.830

您想要的是隐式曲面或类似元球的行为。[在这里](http://www.gamedev.net/page/resources/_/technical/graphics-programming-and-theory/exploring-metaballs-and-isosurfaces-in-2d-r2556)寻找（IMO）对隐式表面背后基础知识的非常好的解释。一旦理解了这个概念，就很容易将其扩展到 3D。另请注意，您不必自己构建三角剖分（因为您已经有一个网格）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T16:02:16.503

我对three.js一无所知，但我确实了解抛物线。这似乎是你可以使用的东西。

这似乎不是一个答案，但请看这个视频：[http](http://www.youtube.com/watch?v=8HvZHo-LSvQ) ://www.youtube.com/watch?v=8HvZHo-LSvQ 。该视频向您展示了如何绘制抛物线。在您的情况下，焦点是对象内部的一个点（`strength of magnet = depth of focus point`），轴的原点是磁铁，y 轴将是顶点的法线。

不幸的是，执行这种方法会给你带来切边，你肯定需要某种正弦曲线，但我希望这能给你一个如何继续前进的提示。我会进一步寻找你，但这是我的第一个直觉。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-21T19:46:34.933

我让下面的 ThreeJS 工作了一些，尽管它在某些部分可能会关闭，而且效果可能看起来还不太令人信服，我不确定。distortViaMagnets 函数是问题的核心（此处为完整运行的[HTML 和源代码](http://outer-court.com/3d/magnetic.zip)；此处运行[演示](http://outer-court.com/3d/magnetic/)）：

```
'use strict';
var app = null;

window.onload = function() {
    app = new App();
    app.init();
}

App.prototype.init = function() {
    this.scene = new THREE.Scene();
    this.addCamera();
    this.addLights();
    this.addSphere();
    this.addRenderer();
    this.render();
    app.animate();
};

App.prototype.distortViaMagnets = function() {
    var maxMagnets = this.magnets.length, maxVertices = this.sphere.geometry.vertices.length;
    var magneticMaxValue = this.getDistance3d( {x: 0, y: 0, z: 0}, {x: 1000, y: 1000, z: 1000} );
    var strength = 1000, factor = 3;
    for (var i = 0; i < maxMagnets; i++) {
        for (var vertexI = 0; vertexI < maxVertices; vertexI++) {
            var magnet = this.magnets[i];
            var vertex = this.sphere.geometry.vertices[vertexI];

            var distance = this.getDistance3d(magnet, vertex);
            var power = magneticMaxValue / distance / strength;

            vertex.x += ( (magnet.x - vertex.x) * power ) * factor;
            vertex.y += ( (magnet.y - vertex.y) * power ) * factor;
            vertex.z += ( (magnet.z - vertex.z) * power ) * factor;
        }
    }
}

App.prototype.animate = function() {
    app.mainGroup.rotation.y -= .003;

    requestAnimationFrame(app.animate);
    app.renderer.render(app.scene, app.camera);
};

App.prototype.addCamera = function() {
    this.camera = new THREE.CombinedCamera(this.width, this.height, 45, 1, 10000);
    this.camera.position.set(0, 0, 400 - 200);
    this.camera.lookAt( new THREE.Vector3(0, 0, 0) );
    this.scene.add(this.camera);
}

App.prototype.addSphere = function() {
    this.mainGroup = new THREE.Object3D();

    var radius = 50, segments = 30 * 3, rings = 30 * 3;
    var geometry = new THREE.SphereGeometry(radius, segments, rings);
    geometry.dynamic = true;

    var material = new THREE.MeshPhongMaterial( {color: 0xffffff, opacity: 1} );
    this.sphere = new THREE.Mesh(geometry, material);
    this.sphere.dynamic = true;
    this.sphere.position.set(0, 0, 0);
    this.sphere.doubleSided = true;

    this.addMagnets();
    this.distortViaMagnets();

    this.mainGroup.add(this.sphere);

    this.scene.add(this.mainGroup);
}

App.prototype.addMagnets = function(vertex) {
    var max = this.sphere.geometry.vertices.length, maxMagnets = 1;
    for (var i = 1; i <= 2; i++) {
        var index = Misc.getRandomInt(0, max - 1);
        var vertex = app.sphere.geometry.vertices[index];
        var magnetI = this.magnets.length;
        this.magnets[magnetI] = this.distortVertex( {x: vertex.x, y: vertex.y, z: vertex.z}, 10 );
        this.showMagnet(this.magnets[magnetI]);
    }

    var magnetI = 0;
    this.magnets[magnetI] = {x: 58, y: 0, z: 0};
    this.showMagnet(this.magnets[magnetI]);
}

App.prototype.getDistance3d = function(vertex1, vertex2) {
    var xfactor = vertex2.x - vertex1.x;
    var yfactor = vertex2.y - vertex1.y;
    var zfactor = vertex2.z - vertex1.z;
    return Math.sqrt( (xfactor*xfactor) + (yfactor*yfactor) + (zfactor*zfactor) );
}

App.prototype.showMagnet = function(vertex) {
    var radius = 1.5, segments = 10, rings = 10;
    var geometry = new THREE.SphereGeometry(radius, segments, rings);

    var material = new THREE.MeshPhongMaterial( {color: 0x11ee33, opacity: .6} );
    var sphere = new THREE.Mesh(geometry, material);
    sphere.position.set(vertex.x, vertex.y, vertex.z);

    this.mainGroup.add(sphere);
}

App.prototype.distortVertex = function(vertex, distortion) {
    vertex.x = Misc.distort(vertex.x, distortion);
    vertex.y = Misc.distort(vertex.y, distortion);
    vertex.z = Misc.distort(vertex.z, distortion);
    return vertex;
}

App.prototype.addRenderer = function() {
    this.renderer = new THREE.WebGLRenderer( {antialias: true} );
    this.renderer.setSize(this.width, this.height);
    var elmMain = document.getElementById('main');
    elmMain.appendChild(this.renderer.domElement);
}

App.prototype.render = function() {
    this.renderer.render(this.scene, this.camera);
};

App.prototype.addLights = function() {
    var light = new THREE.DirectionalLight(0xffffff, 1);
    light.position.set(-50, 250, 250);
    this.scene.add(light);
};

function App() {
    this.width = window.innerWidth;
    this.height = window.innerHeight;
    this.camera = null;
    this.sphere = null;
    this.controls = null;
    this.mainGroup = null;
    this.renderer = null;
    this.scene = null;
    this.magnets = [];
    this.debugElm = null;
} 
```

# git - 从现有的本地存储库（在 Windows 中）在 Git 中创建中央存储库

> ID：11141142
> 
> 赞同：7
> 
> 时间：2012-06-21T15:08:01.077
> 
> 标签：git, repository

我查看了 StackOverflow 和其他地方（包括 Git 文档），但无法使其正常工作。这是我所做的：

设置中央存储库（在 //SomeUNC 上）；

```
git init --bare Central.git 
```

这将创建一个 //SomeUNC/Central.git 文件夹。

现在，在本地存储库中，我尝试：

```
git remote add Central //SomeUNC/Central.git (this is ok)
git push -all Central 
```

这给出了错误：

致命：“中央”似乎不是 git 存储库
致命：远程端意外挂断

我确定我错过了一些简单的东西。感谢您的帮助！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-21T15:24:02.563

听起来您的路径无效。删除裸存储库并从本地存储库工作文件夹中尝试此操作：

```
git init --bare //UNC/Path/to/Central.git
git remote add Central //UNC/Path/to/Central.git
git push --all Central 
```

# exe - opa 1.0：服务器未启动

> ID：11141143
> 
> 赞同：1
> 
> 时间：2012-06-21T15:08:04.940
> 
> 标签：exe, opa

我刚刚将 opa 更新到 1.0。当我编译我的 opa 文件时，我现在得到一个 .js 文件而不是 .exe 文件。

当我尝试运行此 .js 文件（可执行文件）时，我收到错误“Killed”。

穿什么？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T13:58:57.653

当机器没有足够的内存时，似乎会引发“Killed”消息。

cf：[什么会导致 node.js 打印 Killed 并退出？](https://stackoverflow.com/questions/10876136/what-can-cause-node-js-to-print-killed-and-exit)

# hadoop - Amazon EMR：为每个 EMR 实例设置唯一数量的映射器和缩减器

> ID：11141152
> 
> 赞同：2
> 
> 时间：2012-06-21T15:08:23.863
> 
> 标签：hadoop, configuration, mapreduce, amazon-emr

我正在运行一个包含 M 个核心实例和 N 个任务实例的 Amazon EMR 集群。

我的作业每天运行多次并且对时间很敏感，因此我保持 M 核心实例 24/7 不间断运行，这样我就没有与 S3 之间的数据传输开销。

N 个任务节点正在根据需要动态启动和终止。

M 个核心节点是 c1.mediums，N 个任务节点是 m2.xlarge。

有没有办法为每个实例配置 mapred.tasktracker.map.tasks.maximum 和 mapred.tasktracker.reduce.tasks.maximum ？

对于我想要的核心节点： mapred.tasktracker.map.tasks.maximum=2 mapred.tasktracker.reduce.tasks.maximum=1

对于我至少想要的任务节点： mapred.tasktracker.map.tasks.maximum=2 mapred.tasktracker.reduce.tasks.maximum=2

请注意，任务跟踪器也在核心节点上运行，因此我认为此配置需要基于每个实例，具体取决于实例大小。

这可能吗？如果是这样，我该如何设置这种类型的配置？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-10-03T11:21:25.820

这里有一个很棒的博客——它给了你答案。 [http://blog.earlh.com/index.php/2013/05/modifying-the-number-of-mappers-or-reducers-on-a-running-emr-cluster/](http://blog.earlh.com/index.php/2013/05/modifying-the-number-of-mappers-or-reducers-on-a-running-emr-cluster/)

请注意，您可能需要在任务节点中使用 ssh 进行一些操作。它不会像那样工作。

我会将我的 pem 文件放到本地目录中。

chmod 400 在那个 pem 文件上

然后做“scp -l hadoop -i .pem 然后剩下的”

正如博客中提到的，请注意，我还没有尝试过，但我相信它会起作用。另外 - .versions... 的东西可能不需要。你可能只需要conf。

谢谢

# python - 找出对象的可能属性

> ID：11141157
> 
> 赞同：1
> 
> 时间：2012-06-21T15:08:40.250
> 
> 标签：python, gdata

[关于来自python-blogger](https://github.com/codeape2/python-blogger/blob/master/blogger.py#L36)的这段代码

```
def listposts(service, blogid):
    feed = service.Get('/feeds/' + blogid + '/posts/default')
    for post in feed.entry:
        print post.GetEditLink().href.split('/')[-1], post.title.text, "[DRAFT]" if is_draft(post) else "" 
```

我想知道存在哪些字段，`feed.entry` 但我不确定在[这些文档](http://gdata-python-client.googlecode.com/hg/pydocs/gdata.html)中查找的位置。

所以我不只是想要一个答案。我想知道我应该如何浏览文档以自己找出答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T15:43:42.837

试试 dir(field.entry) 它可能对你的情况有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T15:17:36.497

这是一个逐步完成的案例。

我做的第一件事是点击您发送的链接上的服务......基于`service = feed.Get(...)`

这导致这里： http: [//gdata-python-client.googlecode.com/hg/pydocs/gdata.service.html](http://gdata-python-client.googlecode.com/hg/pydocs/gdata.service.html)

然后看着 .Get() 它说

```
Returns:
  If there is no ResultsTransformer specified in the call, a GDataFeed 
  or GDataEntry depending on which is sent from the server. If the 
  response is niether a feed or entry and there is no ResultsTransformer,
  return a string. If there is a ResultsTransformer, the returned value 
  will be that of the ResultsTransformer function. 
```

所以猜测你有一个 GDataFeed - 当你迭代它时：，并且快速搜索“google GDataFeed”会导致：[https ://developers.google.com/gdata/jsdoc/1.10/google/gdata/喂养](https://developers.google.com/gdata/jsdoc/1.10/google/gdata/Feed)

# reporting-services - 如何格式化 RDLC 报告中的数字单元格

> ID：11141160
> 
> 赞同：0
> 
> 时间：2012-06-21T15:08:46.903
> 
> 标签：reporting-services, rdlc, rdl

我想删除单元格中数字的小数部分，但是当我将小数分隔符设置为“0”时，它也会对数字进行四舍五入。我想要的是，如果我的号码是 3.99，我希望看到 3，但它会将其四舍五入为 4。有没有办法做到这一点？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T15:32:11.787

你想要的不是格式化数字，你真正想要的是四舍五入：

```
Math.Floor( 3.99 ) ' That gives 3 
```

Format 总是将数字四舍五入到最接近的值，这意味着带有“#”格式的 3.99 将给出 4。

# python - 在生产中保护 django

> ID：11141162
> 
> 赞同：-1
> 
> 时间：2012-06-21T15:08:52.680
> 
> 标签：python, django, encryption, security

在生产中保护 django 应用程序实例的常见步骤是什么。我正在使用 sqlite，所以加密数据库也会很好。

由于数据库是加密的，因此应用程序代码也应该加密或仅编译。简单地删除所有 *py 文件并保留 *pyc 文件是否安全？

另外，是否可以在生产服务器中禁用 django shell（./manage.py shell）？一旦外壳可以访问，所有数据也可以访问。

我正在使用的堆栈是：Nginx + Gunicorn + Django + SQLite 都托管在带有专用防火墙的机架空间专用服务器上。

**基本上，目标是任何具有 root 访问权限的人都不能访问数据库内容。**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T15:17:09.710

保护 django 是一个重要的问题，但我认为你很困惑。

首先，即使您可以使您的代码不那么容易检查，它也不会使它更安全。其次，可以从 pyc 文件中恢复除注释之外的所有内容。

最后，django shell 可以方便地在命令行与您的应用程序交互。如果任何未经授权的人能够运行它，那么您是否禁用它也没关系 - 您的安全性已经完全受到威胁。

我强烈建议您不要以您当前的知识水平来管理自己的生产服务器。使用共享主机，并遵循您的托管服务的安全准则。专注于应用程序的实际 Web 安全方面。

还有一件事：您不是在生产中使用内置服务器吗？

**更新**：您无法保护自己免受 root 的侵害，即使您可以，他们也可以说，只是将硬盘放在另一台计算机上。

# visual-studio-2010 - VS 2010 项目参考寻找不正确的版本

> ID：11141167
> 
> 赞同：2
> 
> 时间：2012-06-21T15:09:16.153
> 
> 标签：visual-studio-2010, unit-testing, .net-4.0, moles

我们最近从一家外包公司接手了一个项目。这个项目使用 Moles 和 Pex 进行单元测试，但是由于我们很久没有这个项目，我对框架不是很熟悉。

话虽如此，我们正忙着升级这个项目以在 .Net 4 中运行。我已经解决了大部分跳出的问题，但有一个我无法处理。由于错误，一些单元测试无法编译：

> 无法加载文件或程序集“Example.Assembly，Version=0.0.0.0，Culture=neutral，PublicKeyToken=null”或其依赖项之一。该系统找不到指定的文件。

令我困惑的部分是它是一个项目引用，并且程序集正在被复制到单元测试的输出目录中。找到了大多数其他项目参考资料，我无法发现有效的和无效的之间有任何区别。我不确定这个问题是否与 pex/moles 框架有关，但我想我会提到它。

我已经尝试过删除和添加所有引用以及重新生成 moles 程序集的常规方法。

有没有其他人遇到过这个问题？任何帮助将不胜感激。

**EDIT1：**好的，在对构建输出进行更多调查之后，它看起来好像不是痣，而是未正确生成的 .accessor 文件。[我遇到了与Unit test project cannot find assembly under test (or dependencies)](https://stackoverflow.com/q/7993469/1228513)中所问的完全相同的问题，但与他的问题不同，我的问题在删除访问器后并没有消失。

**EDIT2：**原来是一个名为 Publicize.exe 的程序，它因该错误而崩溃。仍然不知道为什么。查看 Fusion 日志似乎没有在工作目录下搜索它试图为其生成访问器的 dll。在我们解决方案中的一堆程序集上手动运行它，我发现它适用于某些，但不适用于其他。但是，我无法确定有效和无效之间的区别。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T20:45:34.860

是的。我读过这个故事很多遍了，我有这件 T 恤。遇到任何问题（包括这个问题）时，我都会使用我常用的 Moles 急救箱。

也许，这个问题会提供一些帮助：[我是唯一一个得到“当前目标框架中不可用的程序集”的人吗？](https://stackoverflow.com/questions/7096814/am-i-the-only-one-getting-assembly-not-available-in-the-currently-targeted-fram)

*   确保 Moles 框架正确安装在工作站和/或构建服务器上
*   确保正在构建 Moles 组件（请参阅排除的“Moles 组件”目录）
*   检查您的构建配置文件——它可能需要设置为完整的框架配置文件
*   三重检查您的输出目的地和构建后命令——我似乎有一些将输出复制到另一个位置的解决方案
*   如果您还没有这样做，请尝试使用 Visual Studio Pex/Moles 扩展

侵入式修复过程是简单地创建一个全新的解决方案、项目和测试项目，然后将现有代码文件复制到其中。令人惊讶的是，有多少问题可以解决各种与项目相关的错误。基本上，整个解决方案的硬重启。

由于您正在更新到 .NET 4，您不妨转到 4.5，并使用 Moles 的产品化版本，称为“Fakes”。您会在 Visual Studio 2012 候选版本中找到 Fakes。这一重要功能并未受到太多关注。

# python - Psycopg2 - Eventlet 连接挂起

> ID：11141175
> 
> 赞同：1
> 
> 时间：2012-06-21T15:09:40.403
> 
> 标签：python, psycopg2, eventlet

我有一个程序可以保持与 postgresql 服务器的持久连接。假设由于网络问题导致连接被阻塞（可以通过关闭网络接口来模拟），使用 eventlet 调用查询的进程卡住了。这也阻止了其他小事件的执行。附加 gdb 表明进程在 psycopg2 C 代码中被阻止。我试过postgresql TCP keepalives。但是，如果在连接丢失后立即调用查询，这也会失败。

有什么办法可以防止 eventlet 进入这种状态？有什么办法可以让 eventlet 脱离这种状态。

**广发银行**

```
#0  0x00002b4e7836be46 in poll () from /lib64/libc.so.6
#1  0x00002b4e835dec4f in ?? () from /usr/pgsql-9.0/lib/libpq.so.5
#2  0x00002b4e835ded50 in ?? () from /usr/pgsql-9.0/lib/libpq.so.5
#3  0x00002b4e835dd28e in PQgetResult () from /usr/pgsql-9.0/lib/libpq.so.5
#4  0x00002b4e833a4284 in psyco_exec_green (conn=0x21f42510, command=<value optimized out>) at psycopg/green.c:195
#5  0x00002b4e833a5387 in pq_execute_command_locked (conn=0x21f42510, 
    query=0x2b4e833b5de8 "BEGIN; SET TRANSACTION ISOLATION LEVEL READ COMMITTED", pgres=0x7fff84c38448, error=0x7fff84c38440, 
    tstate=0x7fff84c38438) at psycopg/pqpath.c:342
#6  0x00002b4e833a58f7 in pq_begin_locked (conn=0x21f42510, pgres=0xffffffffffffffff, error=0xffffffffffffffff, tstate=0x0)
    at psycopg/pqpath.c:424
#7  0x00002b4e833a59a0 in pq_execute (curs=0x1f487528, query=0x2248c894 "SELECT 1", async=0) at psycopg/pqpath.c:764
#8  0x00002b4e833ab15b in _psyco_curs_execute (self=0x1f487528, operation=0x0, vars=0x21ec9a80, async=0)
    at psycopg/cursor_type.c:419
#9  0x00002b4e833ab7b1 in psyco_curs_execute (self=0x1f487528, args=<value optimized out>, kwargs=<value optimized out>)
    at psycopg/cursor_type.c:475 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T21:36:10.123

抱歉回复晚了。

您是否使用了完整的猴子补丁？

如果错误仍然存​​在，请通过以下任何一种方式报告：

*   [https://bitbucket.org/which_linden/eventlet/issues/new](https://bitbucket.org/which_linden/eventlet/issues/new)
*   [https://github.com/eventlet/eventlet/issues/new](https://github.com/eventlet/eventlet/issues/new)
*   发送电子邮件至 eventletdev@lists.secondlife.com

请包括操作系统、Python、Eventlet 和 psycopg2 的版本。

# c++ - 如何有效地读取 COleSafeArray

> ID：11141180
> 
> 赞同：1
> 
> 时间：2012-06-21T15:10:06.640
> 
> 标签：c++, com

我发现很难找到清楚的例子来解释如何阅读`COleSafeArray`...

所以我有一个通过成员函数 a 返回的对象，`_variant_t`它实际上是 a `COleSafeArray`。我想读取它的元素并确保我没有泄漏内存......

这是一种示例代码。我只是想读取我认为很长的数组的第一个元素。数组中有更多数据。

```
class ExampleObject
{
  _variant_t GetArray();
};

//...
long Read(ExmapleObject* ptr)
{
  COleSafeArray the_array = ptr->GetArray();

  VARIANT value_temp;
  VariantInit(&value_temp);

  long index = 0;
  the_array.GetElement(&index, &value_temp);
  long my_result = value_temp.lVal;

  return my_result;
} 
```

这段代码有什么问题会导致内存泄漏吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T16:01:12.803

内容的有效阅读`COleSafeArray`关乎可靠性和性能。

为了可靠地读取，避免垃圾和泄漏，您应该检查数组本身和元素的类型。该`.vt`字段告诉您数组的类型，它可能是特定 [固定] 类型的数组，或者是 的数组`VARIANT`，它又可能嵌入子数组。

您可以选择使用 获取单个元素`GetElement`，在这种情况下，[如果数据元素是字符串、对象或变体，则该函数会以正确的方式复制元素](http://msdn.microsoft.com/en-us/library/windows/desktop/ms221255%28v=vs.85%29.aspx)，因此您负责清除副本。要通过包装类为您完成它，请将您的元素放入`CComVariant`类变量中，而不是`VARIANT`struct （`~CComVariant`将为您清理东西）。

或者，如果检查了类型，您可以锁定/解锁数组并获得对数组管理的元素的直接访问。您可能更喜欢这种性能方法，因为您锁定一次并在需要时复制，而不是在以前的访问选项中为每个元素锁定和复制。

`~COleSafeArray`析构函数清除数组的元素，因此您不必显式销毁/释放它们。

# python - 如何创建函数 py 并调用这些函数？

> ID：11141182
> 
> 赞同：-4
> 
> 时间：2012-06-21T15:10:27.370
> 
> 标签：python, python-2.7, pyramid

我正在使用 Pyramid 框架练习 Python。

我在我的主包文件夹中创建了一个 py, `myfuncs.py`, 里面还有一个 Views 文件夹`views.py`和 Models 文件夹（里面的模型）以及其他用于静态文件和模板的文件夹（由 Pyramid 脚手架创建）。

我想在位于 myproject 包根目录的 myfuncs.py 中定义函数和类，然后从位于其各自视图和模型文件夹中的任何视图和模型中访问它们。

我怎样才能做到这一点？我尝试导入，但它不会工作。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-21T15:30:02.687

想象一下这种文件夹和文件的结构：

```
MyFuncs (folder)
    __init__.py (can be completely empty)
    utilFunctions.py
    genericFunctions.py
    uselessFunctions.py
    Views (folder)
        __init__.py (again!!)
        views.py 
```

现在您可以“导入”文件夹（实际上，您可以使用文件夹名称导入 __ init __.py，但这只是一个细节）确保正确设置 PYTHONPATH。

例如：

```
import MyFuncs.utilFunctions
from MyFuncs.Views import views
import MyFuncs.uselessFunctions as nonsenseFunctions 
```

等等等等

__ init __.py 必须在您要导入的任何文件夹中

在 views.py 中，您只需执行以下操作：

```
from MyFuncs import utilFunctions

utilFunctions.aFunctionYouCode() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T15:14:01.217

您需要`__init__.py`在根文件夹中有一个，并使用以下命令导入它：

```
import functions 
```

然后你应该能够调用函数`functions.<functionname>()`

# java - Google App Engine 中实体的非主键字段的唯一整数 ID

> ID：11141183
> 
> 赞同：0
> 
> 时间：2012-06-21T15:10:30.730
> 
> 标签：java, google-app-engine, unique

我有一个实体类型说 URLInfo ，它保存有关 URL 的信息。该实体的主键是 URL 本身（确保我在数据存储中始终拥有唯一的 URL）。我还希望每个 url 都有唯一的整数 id，以便共享 id 变得更容易。虽然，我可以使用 GUID，但这对我来说不是首选。我怎样才能达到这个要求？整数 ID 不必是连续的（如果是，则首选）。实体可以以更快的速度生成（这意味着我无法在每次生成新的 URL 记录时保持一个通用计数器进行更新）。这是我迄今为止尝试过的 - 在 URLInfo 类中，我定义了一个字段 - Long Id 并使用 @Persistent(valueStrategy = IdGeneratorStrategy.IDENTITY) 对其进行注释，希望它会自动生成唯一值。但是当我保存新实体（id设置为null）时，

我正在本地机器上尝试所有这些。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T17:16:03.010

尝试这个

```
@GeneratedValue(strategy=GenerationType.IDENTITY) 
```

# sql-server - 如何忽略 SQL Server 2005 中特定列的 noiseXXX.txt 文件？

> ID：11141186
> 
> 赞同：3
> 
> 时间：2012-06-21T15:10:32.003
> 
> 标签：sql-server, sql-server-2005, full-text-search, full-text-indexing

我有一个产品表，其中描述列是全文索引的。

问题是，用户经常搜索一个单词，而这个单词恰好在 noiseXXX.txt 文件中。

我们希望保持启用干扰词功能，但是否有仅针对这一列将其关闭？

我认为您可以在[2008 年使用 SET STOPLIST=OFF](http://msdn.microsoft.com/en-us/library/ms188359.aspx)执行此操作，但我似乎无法在[SQL Server 2005](http://msdn.microsoft.com/en-us/library/ms188359%28v=sql.90%29.aspx)中找到类似的功能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T01:46:02.257

在 SQL Server 2005 中，干扰词列表应用于整个服务器。您可以通过删除相应的干扰词文件然后重新构建全文索引来禁用整个服务器的干扰词。但我不相信在 SQL Server 2005 中可以选择性地禁用单个表的干扰词。例如，请参见[此处](http://arcanecode.com/2008/06/02/creating-and-customizing-noise-words-stopwords-in-sql-server-2008-full-text-search/)、[此处](http://www.lemoon.se/how-to-disable-noise-words-on-fulltext-search)和[此处](http://arcanecode.com/2008/05/29/creating-and-customizing-noise-words-in-sql-server-2005-full-text-search)。

在 SQL Server 2008 中，FTS 从使用干扰词文件转变为停止列表。停止列表是包含不包含在全文索引中的停用词集合的容器，并替换了干扰词文件的功能。

在 SQL Server 2008（仅兼容级别 100）中，您可以为给定语言创建多个停止列表，并且可以为各个表指定停止列表。也就是说，一个表可以使用给定的非索引字表，第二个表可以使用不同的非索引字表，第三个表可以完全不使用非索引字表。停止列表设置适用于整个表，因此如果您在单个表中索引了多个列，则它们都必须使用相同的停止列表。

因此，要回答您的问题，我认为在 SQL Server 2005 中不可能有选择地禁用单个表的干扰词，而将它们保留用于其他表。如果这对您来说是个大问题，这可能是将您的服务器升级到 SQL Server 2008 或 2012 的好机会。

# java - Java 中的快速测试驱动开发

> ID：11141188
> 
> 赞同：6
> 
> 时间：2012-06-21T15:10:40.337
> 
> 标签：java, junit, tdd, automated-tests

我一直在安静地使用rails中的[防护](https://github.com/guard/guard)框架，我刚刚爱上了它。我也经常使用 Java 工作，我发现这样的工具不能用于快速测试驱动的开发，这让我感到惊讶。这是警卫为您所做的（形成原始网站）-

> *   由我们很棒的 Listen gem 处理的文件系统更改。
> *   支持视觉系统通知。
> *   庞大的（超过 120 个）守卫扩展生态系统。
> *   针对 Ruby 1.8.7、1.9.2、1.9.3、REE 和最新版本的 JRuby & Rubinius 进行了测试。

从本质上讲，它可以帮助我在进行更改或向代码库添加内容时密切关注测试用例。以下是这种方法的好处-

*   不显眼的测试用例驱动开发
*   即时确认代码更改的影响
*   高质量代码
*   最小化回归涟漪

有谁知道如何在 Java 中实现类似的目标？注意——像 Hudson 这样的自动化测试工具不是我想要的答案。我需要一些可以在本地开发机器/环境上使用的东西，以便对代码更改有即时的测试用例反馈。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T17:04:59.803

不确定您在寻找什么......但是如果您在开发期间搜索在后台运行单元测试的工具，请查看[Infinitest](http://infinitest.github.com/)或[JUnit Max](http://junitmax.com/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T17:06:46.600

如果您使用 eclipse，并且您将 JUnit 视图停靠在一个方便的位置，只需单击***一个按钮***即可重新运行您的测试，并立即在同一视图中查看报告。

这是执行测试驱动开发的一种非常有效的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-13T17:58:54.257

您可以使用[Sonar](http://www.sonarsource.org/)和 Hudson 为您执行此操作。在我工作的公司中，我们使用这种组合来解决您的问题。还有一个适用于 Eclipse 的 Sonar 插件。但是，如果您正在寻找类似基于 IDE 的解决方案，我无法帮助您。

# php - PHPExcel在读取十进制数值时出错

> ID：11141190
> 
> 赞同：0
> 
> 时间：2012-06-21T15:10:53.740
> 
> 标签：php, mysql, phpexcel

我正在使用 PHPExcel 更新 eshop 的商品价格和库存，将数据传递给 mysql 查询并更新数据库。我遇到了一些包含格式为 123,45 的数字的单元格（使用逗号作为小数分隔符）的问题。尽管所有单元格都包含相同的格式，但只有一些单元格被正确读取。请自己看看，让我知道我错过了什么。

*   Excel 示例数据：[http ://dl.dropbox.com/u/25322282/data.xlsx](http://dl.dropbox.com/u/25322282/data.xlsx)
*   从循环数据中记录并打印出它正在读取的内容，您可以在其中看到价格仅在第 66 行之后读取。http [://dl.dropbox.com/u/25322282/log.htm](http://dl.dropbox.com/u/25322282/log.htm)

最后，我的代码：

```
 $objPHPExcel = PHPExcel_IOFactory::load($path);
$objWorksheet = $objPHPExcel->setActiveSheetIndex(0);

    $highestRow = $objWorksheet->getHighestRow();
    $highestColumn = $objWorksheet->getHighestColumn();
    $highestColumnIndex = PHPExcel_Cell::columnIndexFromString($highestColumn);
    $nrColumns = ord($highestColumn) - 64;

    $rowsadded=0;
    $begin_row=2; // 1st line of data in excel file
    for ($row = $begin_row; $row <= $highestRow; ++ $row) {
        $val=array();
        for ($col=0; $col < $highestColumnIndex; $col++) {
            $cell = $objWorksheet->getCellByColumnAndRow($col, $row);
            $val[] = $cell->getCalculatedValue();
        }

        if (($val[0]<>'') && ($val[6]>0)) { //check that row contains data before inserting
            $rowsadded++;
            $sql = sprintf("update productsizes set price=%s, stock=%s where auxcode=%s",
                   GetSQLValueString($val[6], "float"),
                   GetSQLValueString($val[4], "int"),
                   GetSQLValueString($val[0], "text"));
            $result = mysql_query($sql) or die(mysql_error());
        } //end of checking that row contains data before inserting

    } echo '<h2>'.$rowsadded. ' rows updated successfully</h2>'; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T15:16:49.790

我没有使用 PHPExcel，但你为什么不改变它`$val[] = $cell->getCalculatedValue();`来获取字符串值，然后`,`用`.`& 替换变量作为整数并将其存储在另一个变量/数组中？我敢打赌这会奏效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T16:20:03.193

```
$rowsadded=0;
$begin_row=2; // 1st line of data in excel file
for ($row = $begin_row; $row <= $highestRow; ++ $row) {
    $val = $objWorksheet->rangeToArray('A'.$row.':'.$highestColumn.$row,NULL,TRUE,FALSE,TRUE);
    var_dump($val);
    $val = $val[$row];

    if (($val['A']<>'') && ($val['G']>0)) { //check that row contains data before inserting
        $rowsadded++;
        // other code goes in here
    } //end of checking that row contains data before inserting

} echo '<h2>'.$rowsadded. ' rows updated successfully</h2>'; 
```

var_dump() 将在您加载时向您显示每行的值和数据类型。将此用于调试目的

# python - pip 安装的软件包不在 sys.path 中

> ID：11141191
> 
> 赞同：5
> 
> 时间：2012-06-21T15:10:55.543
> 
> 标签：python, virtualenv, pip

我是蟒蛇菜鸟。已经安装了 virtualenv 和 pip，在我看来一切正常，但是当尝试导入通过 pip 安装的包时，python 找不到它们。我在 OS X 上并且有系统 python 2.6 in ，所以通过包安装程序`/usr/bin`安装了 2.7 。在安装 pip 和 virtualenv 时，我通过将 PATH 设置为first`/usr/local/bin`来确保正在使用 2.7 python 。`/usr/local/bin`

```
(pysite)sbeam@pris ~/Sites]$ pip freeze
Django==1.4
Markdown==2.1.1
psycopg2==2.4.5
wsgiref==0.1.2

(pysite)sbeam@pris ~/Sites]$ echo $PYTHONPATH

(pysite)sbeam@pris ~/Sites]$ which python
/Users/sbeam/.virtualenvs/pysite/bin/python

(pysite)sbeam@pris ~/Sites]$ env | grep VIRTUAL
VIRTUALENVWRAPPER_PROJECT_FILENAME=.project
VIRTUAL_ENV=/Users/sbeam/.virtualenvs/pysite
VIRTUALENVWRAPPER_PYTHON=/usr/local/bin/python
VIRTUALENVWRAPPER_HOOK_DIR=/Users/sbeam/.virtualenvs
VIRTUALENVWRAPPER_LOG_DIR=/Users/sbeam/.virtualenvs

(pysite)sbeam@pris ~/Sites]$ python
Python 2.7.3 (v2.7.3:70274d53c1dd, Apr  9 2012, 20:52:43) 
[GCC 4.2.1 (Apple Inc. build 5666) (dot 3)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> import sys
>>> from pprint import pprint as pp
>>> pp(sys.path)
['',
 '/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/distribute-0.6.27-py2.7.egg',
 '/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/pip-0.7.2-py2.7.egg',
 '/Library/Frameworks/Python.framework/Versions/2.7/lib/python27.zip',
 '/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7',
 '/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-darwin',
 '/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-mac',
 '/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-mac/lib-scriptpackages',
 '/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-tk',
 '/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-old',
 '/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-dynload',
 '/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages']
>>> import markdown
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ImportError: No module named markdown 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T15:35:38.423

请注意，默认情况下，系统默认`virtualenv`不包括设计和请求的新版本（1.7+）。`site-packages`

[http://www.virtualenv.org/en/latest/news.html](http://www.virtualenv.org/en/latest/news.html)

您可以`--system-site-packages`在 virtualenv 创建上显式使用，请参阅：

[http://www.virtualenv.org/en/latest/index.html#the-system-site-packages-option](http://www.virtualenv.org/en/latest/index.html#the-system-site-packages-option)

或者您可以只获取 freeze 的输出并在 virtualenv 中执行`pip install -r requirements.txt`

# java - Spring - 使用属性占位符加载位于war文件或类路径之外但在文件系统中的属性文件

> ID：11141193
> 
> 赞同：2
> 
> 时间：2012-06-21T15:10:57.343
> 
> 标签：java, spring, spring-mvc, properties, autowired

我已经配置了属性文件的加载，如下所示（Spring 3.1）

我的弹簧 XML

```
<context:component-scan base-package="com.mypackage"/>
<context:property-placeholder location="file:///C:/temp/application.properties"/> 
```

web.xml

```
<context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>       
        /WEB-INF/my-spring-xml
        </param-value>
    </context-param> 
```

应用程序属性

```
expirationOffset = 777 
```

在我的 java 类中，我声明了如下属性：

```
private @Value("${expirationOffset}") String propertyValue; 
```

由于某种原因，该值没有被初始化。当我运行以下语句时：

```
System.out.println("VALUE - " + propertyValue); 
```

输出总是

```
16:03:02,355 INFO  [stdout] (http--127.0.0.1-8080-1) VALUE - ${expirationOffset} 
```

我试图将属性文件移动到war文件中以尝试在它位于类路径中时访问它，但仍然是同样的问题。这是我从类路径访问它的方式。

```
<context:property-placeholder location="classpath:/conf/application.properties"/> 
```

理想情况下，我希望将属性文件保留在 war 文件之外，因为我不想因为简单的属性更改而不得不重建 war 文件。

我错过了什么吗？

## 编辑

我从这个上下文中删除了 msm-spring.xml 初始化参数：

```
<context-param>
            <param-name>contextConfigLocation</param-name>
            <param-value>       
            /WEB-INF/my-spring-xml
            </param-value>
        </context-param> 
```

并将其移至 servlet 上下文，如下所示。

```
<listener>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener>

    <servlet>
        <servlet-name>myservice</servlet-name>
        <servlet-class>org.springframework.ws.transport.http.MessageDispatcherServlet</servlet-class>
        <init-param>
            <param-name>contextConfigLocation</param-name>
            <param-value>
            /WEB-INF/my-spring-xml
            </param-value>          
        </init-param>
    </servlet> 
```

上述更改似乎已经修复，因为我现在得到了正确的值。我认为我最初的方式是将它放在应用程序上下文中，这意味着它将在整个应用程序/webapp 中可用。

在上面列出的 3 个中使用 msm-spring 有什么区别？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T16:50:49.170

根据您提供的信息，这是一些猜测：

您可能没有`<context:property-placeholder..`在您的根 Web 应用程序上下文中 - 由 ContextLoaderListener 加载的那个，相反，您可能在 Web 上下文中拥有它（由 Dispatcher servlet 加载）。你能确认一下吗？

*更新：*根据评论，问题似乎`<context:propert-placeholder..`是在根 Web 应用程序上下文中定义，但在 Web 上下文的组件中被引用。

在这种情况下，修复方法是将属性占位符移动到 Web 上下文（通过 MessageDispatcherServlet 定义的上下文）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T16:07:13.487

编辑 ：

您是否尝试过使用 setter 方法`#{expirationOffset}` ？

IE ：

```
private String propertyValue;
@Value("#{expirationOffset}")
    public void setPropertyValue(String property) {
        propertyValue = property;
    } 
```

**另外一个选项 ：**

添加 Properties bean 而不是 PropertyPlaceConfigurer 像这样：

```
<util:properties id="myProps" location="file:///C:/temp/application.properties" /> 
```

或者

```
<util:properties id="myProps" location="classpath:application.properties" /> 
```

并将 Setter 稍作修改替换为

```
private String propertyValue;
@Value("#{myProps.expirationOffset}")
    public void setPropertyValue(String property) {
        propertyValue = property;
    } 
```

您必须在上下文配置 xml 中添加decalrations 和`xmlns:util="http://www.springframework.org/schema/util"`相应`xmlns`的内容。`http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-3.0.xsd``xsi:schemalocation`

这绝对应该有效。！

希望能帮助到你。:)

# nlp - 实体情绪分析（Entity-level Sentiment Analysis）

> ID：11141194
> 
> 赞同：14
> 
> 时间：2012-06-21T15:11:02.210
> 
> 标签：nlp, sentiment-analysis, named-entity-recognition

自过去 1 年以来，我一直在从事文档级别的情绪分析。*文档级情感分析*提供完整文档的情感。例如 - 文本“*诺基亚很好，但沃达丰很糟糕*”将具有与之相关的负面极性，因为它与诺基亚和沃达丰实体无关。*怎么可能获得实体层面的情绪，比如对诺基亚有利但对沃达丰不利*？有没有研究论文可以解决这些问题？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2015-09-20T06:41:45.687

您可以尝试**方面级别**或**实体级别的**情感分析。已经做出了很好的努力来找到一个句子中关于各个方面的意见。[你可以在这里](https://scholar.google.com/scholar?hl=en&q=aspect%20based%20sentiment%20analysis&btnG=&as_sdt=1%2C5&as_sdtp=)找到一些作品。你还可以更深入更深入地复习那些与**特征（方面）提取**相关的论文。这是什么意思？让我给你举个例子：

*“屏幕质量很好，但是电池寿命很短。”*

文档级别的情感分析在这里可能无法给我们这个文档的真正意义，因为我们在文档中有一个肯定句和一个否定句。但是，通过基于方面（**aspect-level**）的意见挖掘，我们可以分别找出文档中不同实体的感觉/极性。通过进行特征提取，在第一步中，您尝试在不同的句子中找到**特征（方面） （这里***是“屏幕质量*”或简称为“*质量*”和“*电池寿命*”）。之后，当您有这些方面时，您尝试提取与这些方面相关的意见（“质量”为“好”，“电池寿命”为“短”）。**目标词**（用户评论的那些词或实体），以及作为**意见词**的意见，关于*目标词*的评论。

通过搜索我刚才提到的关键字，您可以更加熟悉这些概念。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-25T17:01:58.237

您可以查找实体及其相关对象，并具有简单的启发式方法，例如从最接近的情感项中给出每个实体的情感，可能在依赖分析树中按距离最近，而不是线性地。这些步骤中的每一个似乎都是一个开放的研究课题。

[http://scholar.google.com/scholar?q=entity+identification](http://scholar.google.com/scholar?q=entity+identification)

[http://scholar.google.com/scholar?q=coreference+resolution](http://scholar.google.com/scholar?q=coreference+resolution)

[http://scholar.google.com/scholar?q=sentiment+phrase](http://scholar.google.com/scholar?q=sentiment+phrase)

[http://scholar.google.com/scholar?q=dependency+parsing](http://scholar.google.com/scholar?q=dependency+parsing)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-03-28T18:49:56.940

这可以使用 Google Cloud Natural Language API 来实现。

[![诺基亚的实体情绪分析很好，但沃达丰很糟糕](../Images/6b5515e3a8a653cb21b2df5273def88a.png)](https://i.stack.imgur.com/FQ5BM.png)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-06-18T21:32:28.517

我也尝试获取有关这方面的研究文章，但没有找到任何内容。我建议您尝试使用基于方面的情感分析算法。我发现的相似之处在于我们识别句子中单个实体的方面，然后找到每个方面的情感。类似地，我们可以使用相同的算法来训练我们的模型，该算法可以像检测方面一样检测实体并找到情感此类实体。我没有尝试过，但我会尝试。让我知道这是否有效。还有多种方法可以做到这一点。以下是几篇文章的链接。

[http://arxiv.org/pdf/1605.08900v1.pdf](http://arxiv.org/pdf/1605.08900v1.pdf) [https://cs224d.stanford.edu/reports/MarxElliot.pdf](https://cs224d.stanford.edu/reports/MarxElliot.pdf)

# erlang - 何时使用 erlang application:start 或 included_applications 和主管？

> ID：11141198
> 
> 赞同：6
> 
> 时间：2012-06-21T15:11:12.697
> 
> 标签：erlang, erlang-otp, rebar

我有一个 Erlang 应用程序，它在其 deps 目录中依赖于另一个应用程序。

据我了解，我可以；

a) 通过调用 application:start(some_other_app) 从我的包含应用程序启动我的依赖应用程序，该应用程序启动应用程序并显示它在 Observer 中独立运行。

b) 使用 {included_applications, [some_other_app]} 将我的依赖应用程序包含在我的 .app 文件中，以便加载应用程序而不启动，然后从我自己的顶级主管启动包含的应用程序。这再次启动了包含的应用程序，并显示它在 Observer 中我自己的监督层次结构下运行。

我的问题是我什么时候应该使用这两种方法？如果我使用选项“a”并且我的依赖应用程序退出，它将重新启动还是应该使用方法“b”以便相应地监视我的任何依赖关系？

在旁注中，我使用 Rebar 来打包和管理我的依赖项。

谢谢，

安迪。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T18:17:25.117

您可能不应该这样做 a) 或 b)

从[Learn You Some Erlang](http://learnyousomeerlang.com)

查看章节：[包含的应用程序](http://learnyousomeerlang.com/the-count-of-applications#included-applications)

> 越来越多的建议不要使用包含的应用程序，原因很简单：它们严重限制了代码重用。这样想吧。我们花了很多时间研究 ppool 的架构，以便任何人都可以使用它，拥有自己的池，并可以自由地用它做任何他们想做的事情。如果我们将它推送到一个包含的应用程序中，那么它就不能再包含在这个 VM 上的任何其他应用程序中，如果 erlcount 死了，那么 ppool 将被删除，破坏任何想要的第三方应用程序的工作使用 ppool。
> 
> 由于这些原因，包含的应用程序通常被排除在许多 Erlang 程序员的工具箱之外。正如我们将在下一章中看到的，发布基本上可以帮助我们以更通用的方式做同样的事情（甚至更多）。

在[Release is the Word](http://learnyousomeerlang.com/release-is-the-word)一章中，您可以了解如何将多个应用程序捆绑到一个版本中以及如何启动它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T15:36:41.700

在您的应用程序描述符中声明您的依赖项是可行的方法，因此您应该在大多数情况下使用选项 B。

应用程序控制器将确保您的所有依赖项都存在并在启动应用程序之前（按顺序）启动，并且如果这些依赖项因错误而终止，也会使您的应用程序失败。此外，应用程序控制器将在需要时关闭所有内容。

除此之外，如果您选择选项 A，当使用 application:start/1 启动应用程序时，默认情况下会获得一个临时应用程序，因此您应该使用 application:start/2，将永久原子作为第二个参数传递。

编辑：在应用程序描述符中包含依赖项也有助于可见性，无需扫描源代码即可轻松了解您的部门。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-16T02:48:42.503

我有一个类似的问题，如何在 erlang 项目中包含依赖项，然后如何发布它们？

我得到了各种朋友的帮助，以及 erlang 邮件列表……在重新阅读了一些文档和更多的试验和错误之后……我想出了一些东西。它很长，所以请查看要点：

[https://gist.github.com/3728780](https://gist.github.com/3728780)

-托德

# mod-wsgi - CGIXMLRPCRequestHandler 的 WSGI 替代品？

> ID：11141199
> 
> 赞同：1
> 
> 时间：2012-06-21T15:11:14.937
> 
> 标签：mod-wsgi, xml-rpc

众所周知，像 CGI 那样分叉一个运行 Python 的进程比像 WSGI 那样嵌入 Python 要慢。我想使用标准 Python 库中包含的 SimpleXMLRPCServer 来实现 XML-RPC 接口，并且我已经有了一个可以通过 CGI 工作的实现。我相信应该有更快的方法。我想尝试 WSGI，但首先我需要一个 WSGI 的请求处理程序，而 SimpleXMLRPCServer 中似乎还没有一个请求处理程序。我是湿透了还是在 Python 2.6、2.7、3.x 下的标准库中没有类似的东西？

这是我对 CGIXMLRPCRequestHandler 的 WSGI 替代的初始实现：

```
from xmlrpclib import SimpleXMLRPCDispatcher

class WSGIXMLRPCRequestHandler(SimpleXMLRPCDispatcher):
  """Simple handler for XML-RPC data passed through WSGI."""

  def __init__(self, allow_none = False, encoding = None):
    SimpleXMLRPCDispatcher.__init__(self, allow_none, encoding)

  def __call__(self, environ, start_response):
    """Parse and handle a single XML-RPC request"""
    result  = []
    method  = environ['REQUEST_METHOD']
    headers = [('Content-type', 'text/html')]

    if method != 'POST':
      # Default implementation indicates an error because XML-RPC uses the POST method.
      code             = 400
      message, explain = BaseHTTPServer.BaseHTTPRequestHandler.responses[code]

      status = '%d %s' % (code, message)

      if method == 'HEAD':
        response = ''
      else:
        response = BaseHTTPServer.DEFAULT_ERROR_MESSAGE % {'code' : code, 'message' : message, 'explain' : explain}
    else:
      # Dispatch XML-RPC to implementation
      status   = '200 OK'
      request  = environ['wsgi.input'].read(int(environ['CONTENT_LENGTH']))
      response = self._marshaled_dispatch(request)

    length = len(response)

    if length > 0:
      result = [response]

    headers.append(('Content-length', str(length)))
    start_response(status, headers)

    return result 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T03:36:09.587

看看 [这个](http://code.google.com/p/wsgi-xmlrpc/source/browse/trunk/wsgi_xmlrpc/__init__.py)希望它会有所帮助。

# database - 数据库关系问题

> ID：11141205
> 
> 赞同：1
> 
> 时间：2012-06-21T15:11:36.370
> 
> 标签：database, database-design

我有一个关于我的数据库设计及其实现的问题，我希望有人能帮助我吗？

我有一个产品 -> 零售商场景，其中适用以下规则：

**产品**- 许多零售商 产品 - 1 个品牌

**零售商**- 许多产品

每个零售商的价格可能会有所变化

所以我有 4 张桌子

```
product - (Product_ID), product name, brand_ID(FK), details
brand - (Brand_ID), brand name
retailer - (Retailer_ID), retailer_Name, Retailer_Telephone
Retailer_Product - (Product_ID, Retailer_ID), cost, 
```

这很好用，因为您可以将产品与零售商相关联，并且并非所有零售商都提供所有产品等。每种产品都有一个固定的品牌。

我的问题来自品牌：

零售商可以提供 1 个或多个品牌，但不一定提供所有品牌？我在执行此操作时遇到问题？

所以我创建了一个 Retailer_Brand 表

```
retailer_brand - (retailer_Id, Brand_ID) 
```

即使您已指定零售商到品牌链接，我仍然可以在零售商产品表中输入与零售商无关的品牌的产品。我错过了检查约束之类的东西还是我的架构错误？

谢谢

抢

**编辑更多细节 **

我仍然不确定它是否能满足我的要求。

也许如果我添加以下示例，它将澄清。

我有一个我们可以提供的产品设置列表

例如名称 描述 品牌电视 32 英寸索尼电视 64 英寸索尼电视 20 英寸索尼电视 64 英寸三星电视 32 英寸三星电视 32 英寸松下

零售商 Uberhardware - 可以销售所有品牌的电视 SonyRetailer - 只允许销售 Sony 产品（所有产品） PanasonicRetailer - 仅限 Panasonic 产品

然后出现了一个我需要设置的新零售商：Phoenix Retail - 不允许销售索尼产品

我希望能够轻松地限制/启用每个零售商的不同品牌？

**编辑 2**

我已经实施了建议的备用密钥设计，但我仍然能够输入不正确的日期，请参阅下面的数据设置和预期结果，但是当我预计有些失败时，零售商产品表中的所有输入都会成功？

**产品**
*ProductID BrandID*
1 1
2 2

**品牌**
*BrandID*
1
2

**零售商**
1
2

**零售商**
*品牌 零售商 ID 品牌 ID*
1 1
2 1
2 2
3 1

**RetailerProduct**
*RetaileID Brand ProductID 预期* 1 1 1 OK 1 2 2 FAIL 2 1 1 OK 2 2 2 OK 3 2 2 FAIL

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T15:27:08.863

让我看看我是否做对了。

**产品**

```
product_id
name
description
etc 
```

**品牌**

```
brand_id
name
etc 
```

**零售商**

```
retailer_id
name
etc 
```

关系表 **brand_prod_ret**

```
retailer_id
product_id
brand_id
price
etc 
```

例如，Uber 硬件零售商销售电视：LG、索尼、三星等。

**优步硬件**进入**零售商**表

**电视**进入**产品**表

您的**product_id**与**brand_prod_ret**表中的**retailer_id**和**brand_id**相匹配。

 **进入**品牌**有 LG、索尼、三星等。

并进入 brand_prod_ret 你有

```
TVs' ID - Sony's id -Uberhardware id
TVs' ID - Samsung's id - Uberhardware id
TVs' ID - LG's id - Uberhardware id 
```

当然还有每个价格。

![在此处输入图像描述](../Images/a5265e95de986d2934d073a75fe9d05c.png)

现在您可以确切地知道零售商目前正在销售的品牌

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T16:35:03.730

*   备用键 (AK) --`Product`允许作为 FK`(ProductID, BrandID)`引用的唯一约束（带索引）。`RetailerProduct`

![在此处输入图像描述](../Images/76efcf90192e7f8857b2eb00e0dbd42a.png)

```
create table Product (
  ProductID integer not null
, BrandID   integer not null
);
alter table Product add constraint pk_product primary key (ProductID);
alter table Product add constraint un_product unique (ProductID, BrandID);

create table Brand (
  BrandID integer not null
);
alter table Brand add constraint pk_brand primary key (BrandID);

create table Retailer (
  RetailerID integer not null
);
alter table Retailer add constraint pk_retailer primary key (RetailerID);

create table RetailerBrand (
  RetailerID integer not null
, BrandID    integer not null
);
alter table RetailerBrand add constraint pk_retbra primary key (RetailerID, BrandID);

create table RetailerProduct (
  RetailerID integer not null
, ProductID  integer not null
, BrandID    integer not null
);
alter table RetailerProduct add constraint pk_retprd  primary key (RetailerID, ProductID, BrandID);

alter table RetailerProduct add constraint fk1_retprd
      foreign key (ProductID, BrandID) references Product (ProductID, BrandID);

alter table RetailerProduct add constraint fk2_retprd
      foreign key (RetailerID, BrandID) references RetailerBrand (RetailerID, BrandID); 
```

**编辑**

插入一些数据

```
insert into Brand    (BrandID)                   values (1)  , (2);
insert into Product  (ProductID, BrandID)        values (1,1), (2,2);
insert into Retailer (RetailerID)                values (1)  , (2);
insert into RetailerBrand (RetailerID, BrandID)  values (1,1), (2,1), (2,2), (3,1); 
```

测试

```
insert into RetailerProduct (RetailerID, BrandID, ProductID) values (1,1,1); -- OK

insert into RetailerProduct (RetailerID, BrandID, ProductID) values (1,2,2); -- FAIL

insert into RetailerProduct (RetailerID, BrandID, ProductID) values (2,1,1); -- OK

insert into RetailerProduct (RetailerID, BrandID, ProductID) values (2,2,2); -- OK

insert into RetailerProduct (RetailerID, BrandID, ProductID) values (3,2,2); -- FAIL 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T15:38:55.770

这种能力需要品牌表有什么理由吗？

我们与产品有多对多的关系 - 品牌零售商 - 零售商_产品品牌 - 零售商品牌

似乎您可以将品牌信息保留在retailer_product 表中。然后每一个输入的新品牌都可以进行pk链接。或者只能输入一个零售商到品牌的查找表来强制执行零售商协会 b/fa 的约束，新的retailer_product 可以输入

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-21T15:45:22.487

IMO 在您当前的结构中，表retailer_brand 不是绝对必要的，因为您始终可以通过浏览retailer_product => product => 品牌关系来确定零售商全部或部分库存的品牌。

我可以要求对您的业务领域进行一些澄清，这可能会影响您的数据建模吗？（我在零售商有一些经验），例如

品牌通常是特定于零售商的（例如，供应商生产的一系列产品纯粹是为一个零售商打上商标的）。您可能会考虑将供应商表添加到您的模型中。

零售商连锁店内的商店通常不会储存所有产品。您可能需要在模型中考虑这一点。

我不确定您是面向消费者还是面向供应商的业务，但您可能需要对成本价格和销售价格进行建模。

价格应包括日期从/日期到

等等**

# android - 从 res/drawable 中检索字符串

> ID：11141207
> 
> 赞同：2
> 
> 时间：2012-06-21T15:11:44.533
> 
> 标签：android, string, drawable

我采取了以下数组；填充画廊：

```
private Integer[] mImageIds = { R.drawable.one, R.drawable.two,
            R.drawable.three, R.drawable.four, R.drawable.five,
            R.drawable.six, R.drawable.seven, R.drawable.eight,
            R.drawable.nine, R.drawable.ten, R.drawable.elevan,
            R.drawable.twelve, R.drawable.thirteen, R.drawable.fouteen,
            R.drawable.fifteen, R.drawable.sixteen
    }; 
```

然后我正在使用画廊的点击事件：

```
coverFlow.setOnItemClickListener(new OnItemClickListener() {

         @Override
         public void onItemClick(AdapterView arg0, View v, int position,
         long rowID) {
             String s = mImageIds[position].toString();
             Toast.makeText(v.getContext(), s , 1000).show();
         }
         }); 
```

但是这里 Toast 给了我整数**2130837507**；

如果我只在 Toast 中使用**mImageIds[position]**

然后它显示路径**res/drawable-mdpi/image_name.jpg**，但实际上它不是字符串。我想从中检索字符串（图像名称）。谁能帮我？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T15:15:41.547

不要对您返回的号码执行 toString 。如果您想要问题标题所暗示的资源 ID 中的字符串，请执行以下操作：

```
getResources().getString(mImageIds[position]); 
```

但是，您似乎想要图像名称，尽管这不是您问题的标题。如果是这种情况，这应该有效：

```
getResources().getResourceEntryName(mImageIds[position]); 
```

# typo3 - TypoScript：{field:uid} 替换不起作用 | 每个菜单项不同的 CSS 类

> ID：11141213
> 
> 赞同：2
> 
> 时间：2012-06-21T15:12:06.777
> 
> 标签：typo3, typoscript

我有一个标题菜单并尝试为每个项目定义不同的 CSS 类。

这就是我所拥有的：

```
20 = HMENU
  20 {
    special = directory
    special.value = 107
    1 = TMENU
    1 {
      wrap = <ul class="foo" id="mymenu">|</ul>
      expAll = 1
      NO = 1
      NO.allWrap = <li class="first menu_{field:uid}">|</li> || <li class="menu_{field:uid}">|</li> || <li class="last menu_{field:uid}">|</li>
    }
  } 
```

但在 HTML 输出中，我只是简单地得到了`class="first menu_{field:uid}"`，没有任何东西被替换。

顺便说一句：菜单中的页面条目是指向外部页面的链接。

编辑：

正如我们的设计师抱怨我们现在滥用 body-class 属性的非说话类 ID 一样：

```
 NO.allWrap = <li class="first {field:bodyclass_wrap_class}">|</li> || <li class="{field:bodyclass_wrap_class}">|</li> || <li class="last {field:bodyclass_wrap_class}">|</li> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-21T15:22:45.327

您必须添加`NO.allWrap.insertData = 1`，然后将插入数据。`allWrap`只是一个 normal `stdWrap`，因此[默认功能](http://wiki.typo3.org/TSref/stdWrap#insertData)适用于那里。

顺便说一句：我认为您的[选项拆分](http://wiki.typo3.org/De%3aTSref/optionSplit)仍然是错误的。我猜你想要这样：

```
NO.allWrap = <li class="first menu_{field:uid}">|</li> |*| <li class="menu_{field:uid}">|</li> |*| <li class="last menu_{field:uid}">|</li> 
```

# android - Android Google Analytics 调度间隔

> ID：11141215
> 
> 赞同：2
> 
> 时间：2012-06-21T15:12:13.527
> 
> 标签：android, google-analytics

在文档中，它提到我们可以有一个调度间隔，这样页面视图将在 x 秒后自动调度。

我有如下代码

```
tracker.startNewSession("UA-YOUR-ACCOUNT-HERE", 20, this); 
```

我确定**trackPageView()**被调用，因为我可以看到这些页面浏览量存储在“google_analytics.db”中，这是 google analyitcs 用于存储非调度页面浏览量的数据库。但是，它不会在 20 秒后发送到 Google Analytics

在日志中，当我调用**trackPageView()时，它会不断报告****调度下一次调度**。

# android - Android 3.2 HTTP 流式传输

> ID：11141217
> 
> 赞同：1
> 
> 时间：2012-06-21T15:12:20.057
> 
> 标签：android, streaming, video-streaming

我正在尝试创建一个应用程序来流式传输直播电视。目前我面临的问题是，在播放 10 分钟后，视频会冻结，但音频会继续。这是在 1.3mbps 流上。我也有较低的流，例如 384kbps 的流，可能会持续一个小时左右，但仍会如此。我用本地视频对此进行了测试，质量很高（文件大小为 2.3gb），没有延迟，根本不会冻结，所以它一定与 HLS 流式传输到 android 的方式有关。

有谁知道如何解决这个问题？

谢谢

# php - 一个子域作为另一个域的 cname，我可以有不同的自定义 404 页面吗

> ID：11141224
> 
> 赞同：0
> 
> 时间：2012-06-21T15:12:42.897
> 
> 标签：php, apache, .htaccess, symlink, cname

实际上我有一个域 - domainone.com

我创建了另一个域的子域 cname 为

abc.domaintwo.com - CNAME as - domainone.com

这样我就可以使用 js 和 css 文件，例如 domainone.com/js/jquery.js 文件作为 abc.domaintwo.com/js/jquery.js

到目前为止，一切都很好，完全没有问题。

问题：

我有一个 domainone.com 的自定义 404 页面，现在当 abc.domaintwo.com 进入 404 时，出现了我不想要的相同页面。任何帮助表示赞赏。

domainone.com 的 Htaccess：

错误文档 404 /404/

**我想要的只是两者都有不同的404.....**

注意：我在共享主机上时无权访问符号链接或别名的外壳。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T15:25:06.363

对于您要执行的操作，您将需要使用 PHP。它不能在您的 .htaccess 中完成。理想的地方是虚拟主机文件，但听起来你没有访问权限。

您应该将 web 根彼此分开，然后 mod 重写：

```
RewriteEngine On
RewriteBase /
RewriteCond %{HTTP_HOST} abc.domaintwo.com$ [NC]
RewriteRule ^(js|css)/(.*) http://www.domain.com/$1/$2 [L,PT] 
```

这应该将[http://abc.domaintwo.com/js/](http://abc.domaintwo.com/js/) * 和 css/* 重定向到 www.domain.com/js 和 css/

注意：它未经测试，但如果我的记忆正确，它应该可以工作。

# c# - 在 WP7 WebClient 中添加标题

> ID：11141225
> 
> 赞同：1
> 
> 时间：2012-06-21T15:12:49.683
> 
> 标签：c#, windows-phone-7, webclient

我正在使用来自其他 c# 应用程序的代码，我可以看到在 WP7 中不支持标头。如何更改该代码以在 WP7 中工作

```
client.Headers.Add(HttpRequestHeader.Authorization, header_auth); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-21T15:17:09.067

您可以像这样在 WP7 中添加标题，

```
client.Headers[HttpRequestHeader.Authorization] = header_auth; 
```

# c# - 在 URL 中传递额外的参数

> ID：11141226
> 
> 赞同：0
> 
> 时间：2012-06-21T15:12:53.773
> 
> 标签：c#, asp.net

我的表中有下面的列，在页面加载时绑定了什么，那里的参数工作正常，但我需要添加一个额外的参数，它是下一列的全名，但我无法确定我们的语法，

这是我的 ASP

 `````
<asp:TemplateField HeaderText="ID">
    <ItemTemplate>
        <asp:HyperLink ID="hyperLeadID" runat="server" NavigateUrl='<%#Eval("ID","/documents/Q-Sheet.aspx?LeadID={0}&isHappyCallReferral=yes&isHappyName={1}") %>'
            Text='<%#Eval("ID")%>'></asp:HyperLink>
    </ItemTemplate>
</asp:TemplateField>
<asp:TemplateField HeaderText="Referral Name">
    <ItemTemplate>
        <asp:Label ID="lblRefName" CssClass="gvItem" runat="server" Text='<%# DataBinder.Eval(Container, "DataItem.Name") %>'></asp:Label>
    </ItemTemplate>
</asp:TemplateField> 
````  `正如您在 ID 列末尾看到的那样，我添加了 isHappyName={1}，我假设它会选择下一列，因为它从 0 开始，但它不断抛出错误，即“索引（从零开始）必须更大大于或等于零且小于参数列表的大小。”

有人可以帮我通过 URL 传递用户名吗

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T15:16:38.650

像这样重写超链接：

```
NavigateUrl='<%# string.Format("/documents/Q-Sheet.aspx?LeadID={0}&isHappyCallReferral=yes&isHappyName={1}", Eval("ID"), Eval("HappyName"))%>' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T15:15:29.990

问题在于对 String.Format 的调用（大概`<asp:HyperLink>`是在内部执行此操作）。它仅提供一个参数，而`{1}`指的是第二个未提供的参数。

尝试使用`<a href="#">`而不使用 asp:HyperLink （和 ASP.NET 的内置数据绑定）并手动设置 URI - 由于这个原因，我根本不是 System.Web.UI.WebControls 的粉丝（我强烈建议您查看有机会时使用 ASP.NET MVC）。``

# php - PHP MySQL - 加入具有相同内容的表？

> ID：11141227
> 
> 赞同：0
> 
> 时间：2012-06-21T15:12:54.253
> 
> 标签：php, mysql, join

好的，所以我知道我们可以将 MySQL 中的表“交叉”连接到使用 id 列的表中。

我有两个数据库，我需要加入两个几乎相同的表。

我需要加入这些“向下”，例如，类似于将整个表插入另一个表。不是普通的交叉连接。

MySQL允许我这样做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T15:15:24.397

`UNION`是实现这一目标的好方法。

```
SELECT * FROM table1
UNION
SELECT * FROM table2 
```

只需确保返回的列数相同，并且数据类型匹配。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T15:16:32.893

是的，您可以使用`UNION`- 唯一的条件是从两个选择查询（两个表）中选择相同数量的列：

```
SELECT a, b, c, d FROM table1

UNION

SELECT d, e, f, g FROM table2 
```

常见问题是从 订购结果`UNION`，所以这里是解决方案：

```
SELECT a AS order_by, b, c, d FROM table1
UNION
SELECT d, e, f AS order_by, g FROM table2
ORDER BY order_by DESC 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T15:15:40.087

尝试这个 ：

```
INSERT INTO database1.table1 
    SELECT * FROM database2.table2 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-21T15:18:18.137

是的，您可以这样做，只需在表前使用完整的数据库名称，确保您的用户对两个数据库都具有权限。

```
 SELECT ...
 FROM database1.table t1
 JOIN database2.table2 t2 ON t2.column = t1.col 
```

# ruby-on-rails - 如何在 Heroku 上为 Resque 设置 SSL 证书？

> ID：11141229
> 
> 赞同：0
> 
> 时间：2012-06-21T15:12:55.363
> 
> 标签：ruby-on-rails, heroku, resque

我正在尝试在 Resque 的生产环境版本上调试失败的作业，因为这是我可以使用的所有 Web 界面：

```
Worker:      9c9fe9d3-8ee0-43fe-afcd-c6806fc75f0d:2 on sentiment_pull at just now
Class:       SentimentJob
Arguments:   [16, 17, 18]13
Exception:   OpenSSL::SSL::SSLError
Error:       SSL_connect returned=1 errno=0 state=SSLv3 read server certificate B: certificate verify failed 
```

这在开发中有效，我不确定为什么我会在 Heroku 上收到 OpenSSL 错误。我也在使用 Omniauth，所以在我已经设置的初始化程序中：

```
Rails.application.config.middleware.use OmniAuth::Builder do  
  provider #...
  :client_options => {:ssl => {:ca_path => "/etc/ssl/certs"}}
end 
```

我没有在 Heroku 上找到任何需要 SSL 证书的 Resque 示例，所以我有点难过，因为该作业设置为在 HTTPS URL 上执行请求。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T06:53:53.303

我最近遇到了这个问题，尽管有很多关于如何解决它的答案，但这是唯一对我有用的问题（我不在 Heroku 上，而是在 Debian VPS 上）。大多数时候这是一个坏主意，但对于我需要接受自签名 SSL 记录的用例来说很好。

```
OpenSSL::SSL::VERIFY_PEER = OpenSSL::SSL::VERIFY_NONE 
```

这将导致 OpenSSL 不验证 SSL 记录并抑制错误。

# matlab - 运算符可以存储在变量中吗？

> ID：11141231
> 
> 赞同：3
> 
> 时间：2012-06-21T15:12:56.010
> 
> 标签：matlab, variables, while-loop, operators, eval

这是我正在考虑的一个思想示例：

```
test = 'x > 0';

while str2func(test)
   Do your thing
   x=x-1;
end 
```

是否可以将整个逻辑操作存储在这样的变量中？

当然`str2func`会在这里打破。如果可能*的*话，这个功能可能是别的东西。而且我只在`test`变量内容中添加了撇号，因为我想不出还有什么存储方法。

在向函数等发送参数时，我可以看到它很有用。但大多数时候我只是想知道，因为我以前从未见过用任何编程语言完成它。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-21T15:19:29.020

例如，您*可以*将函数的文本表示形式存储在变量中并对其进行评估

```
test = 'x > 0';
eval(test) 
```

应根据 x 的值产生 1 或 0。

但是你*不应该*使用`eval`SO 上经常提到的原因，让我懒得重复。相反，您应该熟悉函数和函数句柄。例如

```
test =  @(x)x>0 
```

为一个函数创建`test`一个句柄，该函数测试其参数是否大于 0。

与编译语言相反，许多在运行时解释的语言具有类似的功能。

# c# - 由 Word Automation Services 转换的文件丢失其表头

> ID：11141235
> 
> 赞同：0
> 
> 时间：2012-06-21T15:13:05.207
> 
> 标签：c#, sharepoint, ms-word, openxml, word-automation

我正在使用 OpenXml SDK 2.0 生成一个 Word 文档，这方面的一切都很好。该文档有很多带有多行表格标题的表格，并且一切看起来都完全符合其应有的方式。

我通过 Sharepoint 2010 Enterprise 中的自动化服务一词传递此文档，该服务返回一个转换后的文件。有时文件格式与输入格式（Docx->Docx）相同，因为我使用该服务刷新目录，但大多数转换为 PDF。

我的问题是返回的文档不包含与源文档相同的标题。如果我查看文档的 OpenXml，行没有 TableHeader 属性，但它们在源中。

有谁之前经历过这个吗？我能做些什么来解决这个问题，因为我对 WAS 及其工作原理知之甚少。我们已经投入了相当多的时间来开发它，并且不想求助于第三方组件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-05T13:40:55.953

这实际上是 Word Automation Services 以及它如何处理多行标题的一个缺陷。我通过显式设置标题行中的颜色来解决这个问题，使它们看起来像标题，但不是。

这意味着如果表格跨越多个页面，那么标题将不会重复，但它是两个弊端中的较小者。

# javascript - 根据时间更改网站内容

> ID：11141238
> 
> 赞同：-4
> 
> 时间：2012-06-21T15:13:07.403
> 
> 标签：javascript, jquery

想每周在午夜更改一次我的网站内容，如何使用 javascript/jquery 安排？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T15:14:43.270

您不能仅使用客户端脚本。你应该看看[cron](http://www.unixgeeks.org/security/newbie/unix/cron-1.html)。它可以让您运行一个脚本，该脚本可以执行您需要执行的任何操作，以按设定的时间间隔更新您的内容。

# struts2 - 在 DisplayTags 中使用 Struts2 属性标记

> ID：11141240
> 
> 赞同：1
> 
> 时间：2012-06-21T15:13:13.297
> 
> 标签：struts2, displaytag

我正在尝试使用 DisplayTag 呈现表格。当我以通常的方式呈现列时，一切正常：

```
<display:column property="id_material" title="ID" /> 
```

现在，我想要一列显示连接的 2 个属性。所以我尝试使用 < s:property > 标签：

```
<display:column title="UNIDAD"><s:property value="property1"/> <s:property value="property2"/></display:column> 
```

但该列中没有显示任何值。有没有其他方法可以做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T15:42:51.940

您可以使用装饰器，获取行对象属性并返回两者的连接。

一个简单的例子：

```
 public class ExampleDecorator extends TableDecorator{

    public String getConcatenatedProperties(){

    Object object = getCurrentRowObject();
    return object.getProperty1() + " " + getProperty2();

}} 
```

然后在显示表中添加一列：

```
<display:column property="concatenatedProperties" title="Properties" /> 
```

在 displaytag 中使用装饰器：

```
<display:table [..]  decorator="org.example.ExampleDecorator" [...] > 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-16T16:17:38.850

尝试在table标签中添加uid属性，然后您可以通过请求属性访问Struts2中的当前行。请参见以下代码：

```
<display:table name="list" uid="row">
    <display:column title="UNIDAD"><s:property value="#attr.row.property1"/>    <s:property value="#attr.row.property2"/>
    </display:column>
</display:table> 
```

# html - Appcelerator Titanium 的社交分享功能

> ID：11141242
> 
> 赞同：0
> 
> 时间：2012-06-21T15:13:27.390
> 
> 标签：html

我不知道如何在 Appcelerator Titanium 上为我的移动应用程序添加 Facebook、Twitter、电子邮件的社交共享图标按钮。我正在寻找图标和逻辑。任何帮助将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T21:05:02.890

appcelerator 没有内置的 twitter 支持，twitter 有一个非常简单的 API，您可以使用 Ajax 调用来使用它，只需放置一个带有背景图像的按钮。这是 Facebook 东西的 API 链接，有一个按钮示例，登录/注销，在此页面上发布/查询

[http://developer.appcelerator.com/apidoc/mobile/1.8.2/Titanium.Facebook-module](http://developer.appcelerator.com/apidoc/mobile/1.8.2/Titanium.Facebook-module)

# maps - 在 Matlab GUI 中设置地图轴的父级

> ID：11141243
> 
> 赞同：3
> 
> 时间：2012-06-21T15:13:31.250
> 
> 标签：maps, matlab, matlab-guide

我正在使用映射工具箱的 MATLAB 中编写一个基本的 GUI。GUI 将显示灰度图像，然后在数据上绘制离散点，所有这些都在必要的地图投影上。重要的是我绘制地图轴（由axsm 命令创建的轴）而不是原版笛卡尔空间。我从命令行执行所有这些都没有问题，但是我找不到实现 GUI 版本的方法，这让我发疯了。

问题是我需要将地图轴指定为父图形的子级。法线轴有一个可以设置的属性，例如：

```
axesHandle = axes('Parent', parentHandle, ...); 
```

或者

```
set(axesHandle, 'Parent', parentHandle); 
```

但是，axesm 函数创建的地图轴没有等效的父属性，因此我无法操作图中的轴。我怎样才能做到这一点？

* * *

更新：如果我在空图中的地图轴内创建绘图，get(figureHandle, 'Children') 返回轴对象的句柄（感谢@slayton！），因此必须将地图轴对象隐式添加到孩子由 MATLAB 绘制的图。

我是否应该担心地图轴不参考父图形，还是应该顺其自然？我想知道这是否是 MATLAB 强迫我不遵守手册告诉我实施的标准的经典案例。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T15:35:59.827

通过阅读您的问题，我认为您正在尝试做的是抓住轴对象的句柄。这可以在使用轴或子图创建轴时完成

```
a = axes();
a = subplot(x,y,z);
% both return an handle to the newly created axes object 
```

此外，如果轴是通过函数调用自动创建的，`plot`或者`image`您也可以获取轴句柄：

```
p = plot(1:10); %returns a handle to a line object
a = get(p,'Parent');

i = image(); %returns a handle to an image object
a = get(i, 'Parent'); 
```

最后，这两个选项都不可用，您始终可以从其包含的图形中获取轴句柄：

```
a = get(figureHandle, 'Children'); 
```

请记住，如果您的图形包含多个轴，这将返回一个轴句柄向量。

最后，当需要将点绘制到包含地图图像的轴时，您只需调用：

```
line(xPoints, yPoints, 'linestyle', 'none', 'marker', '.', 'color', 'r', 'size', 15) 
```

*这将使用大红点绘制线的顶点。*

我不确定这是否回答了您的问题，因为您提供的代码与您提出的问题不符。

您提供的代码看起来像是在尝试将轴从一个图形移动到另一个图形。你完全可以做到这一点！

```
f = figure('Position', [100 100 100 100]);
a = axes('Parent', f);
pause
f2 = figure('Position', [250 100 100 100]);
set(a,'Parent', f2); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T21:18:58.813

经过反复试验和阅读文档，我发现没有办法明确指定地图轴的父级。相反，它们被隐式添加到当前轴的顶部。在当前图形中不存在坐标区的情况下，调用`axesm`会创建一个坐标区对象，然后将坐标轴对象放入其中。当你走这条路时，你必须通过调用来获取轴对象句柄`gca`：

```
mapAxesHandle = axesm(...);
axesHandle = gca(...); 
```

这使得在从头开始编写 GUI 时使用映射工具箱令人沮丧，但这就是 Mathworks 实现它的方式。感谢@slayton 提供有用的信息。我会投票，但我的声誉是 <15 :(

# php - 为什么我的代码没有在我的数据库中插入值？

> ID：11141247
> 
> 赞同：0
> 
> 时间：2012-06-21T15:13:41.117
> 
> 标签：php, insert-into

我正忙于分配一门课程，但我无法找出问题所在。我唯一知道的是它在插入部分。连接正确。正如我将展示变量一样，您可以看到输入字段中放置的单词。但是它们仍然不在数据库中。

我以前使用过这段代码并且它有效，但我不明白为什么它现在不起作用。谁能帮帮我吗？下面是我的代码。

谢谢你试图帮助我！！

```
<?php

// Open connectie naar de database
$link =  mysql_connect('localhost', 'root', 'root'); // maakt de connectie met de databases (mamp/wamp)
if (!$link) {
    die('Geen connectie ' . mysql_error()); // verbreekt de verbinding en laat de error zien
}

$db_selected = mysql_select_db('voorbeeld', $link); // maakt connectie het database "voorbeeld"
if (!$db_selected) {
    die ('Kan database niet selecteren : ' . mysql_error());// verbreekt de verbinding en laat de error zien
}

if ($_POST['submit'] == 'Verzenden') {

  $naam = $_POST['naam'];
  $boodschap = $_POST['boodschap'];

  $datum = date("y-m-d");  

  // Bericht opslaan
  $query2 = "INSERT INTO gastenboek (ID, naam, boodschap, datum) 
        VALUES(NULL, '$naam', '$boodschap', '$datum')";
  $result = mysql_query($query2);

  if (mysql_affected_rows() == 1) {
     $success_msg = '<P>Uw bericht is geplaatst.</P>';

  } else {
    error_log(mysql_error());
    $success_msg = '<P>Helaas, er ging iets mis.</P>';
  }

}

$thispage = $_SERVER['PHP_SELF'];
?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<?php
$form_page = <<< EOFORMPAGE
</head>

<body>

<H1>Uw bericht</H1>

$datum
$boodschap
$success_msg

<form method="POST" action="$thispage">

Uw naam:<br/>
<input type="text" SIZE="40" name="naam" value="$naam"><br/><br/>
Uw bericht:<br/>
<textarea name="boodschap" rows=10 cols=50>$boodschap</textarea><br/><br/>
<input type="submit" name="submit" value="Verzenden">
</form>

<a href="gastenboek.php"><input type="button" name="gastenboek" value="Gastenboek"></a>

</body>
</html>

EOFORMPAGE;
echo $form_page;
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T15:35:24.290

*（来自我的评论）*

看起来您正在尝试将*NULL*插入 ID 字段。如果该列使用默认值或种子/递增值，则可以省略它：

```
$query2 = "INSERT INTO gastenboek (naam, boodschap, datum) 
           VALUES('$naam', '$boodschap', '$datum')"; 
```

**此外**，即使这只是一项家庭作业，熟悉由于不[清理用户输入](http://xkcd.com/327/)而暴露的**安全漏洞**也是一个好主意。我会熟悉这个：

[http://php.net/manual/en/security.database.sql-injection.php](http://php.net/manual/en/security.database.sql-injection.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T15:38:09.960

从 ID 中删除 NULL 因为它可能是您的主键，或者您可能已经对其应用了自动增量。

# java - WebServiceTemplate - 拦截器和回调之间的区别？

> ID：11141248
> 
> 赞同：2
> 
> 时间：2012-06-21T15:13:49.060
> 
> 标签：java, callback, interceptor, spring-ws, webservicetemplate

我正在尝试使用 Spring-WS 编写我的第一个客户端，并且对一些基础知识感到有些困惑。我需要在标头中插入一个 SAML 令牌，并且我注意到 WebServiceTemplate 类允许拦截器和 WebServiceMessageCallbacks。

有人可以帮我理解为什么我应该使用一个与另一个吗？

其次，我注意到 WST 类允许一个拦截器列表，但只有一个回调。有谁知道这个设计决策背后的逻辑是什么？为什么无法传递回调数组或列表？

谢谢，

埃里克

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T13:54:07.903

I was wondering the same after reading your question (-:

On [this link](http://forum.springsource.org/showthread.php?60153-Difference-between-an-Interceptor-and-a-WebServiceMessageCallback) there's a brief explanation and that's exactly how I use both. For instance, for a specific request I need to set the SOAP action:

```
JAXBElement<Response> response = (JAXBElement<Response>) webserviceTemplate.marshalSendAndReceive(
    request, 
    new SoapActionCallback("PutOrganisationUnitRequest")
); 
```

This is indeed a simple, anonymous class as mentioned in the link. An interceptor on the other hand is defined and used for all requests. Take a look at [XwsSecurityInterceptor](http://static.springsource.org/spring-ws/site/apidocs/org/springframework/ws/soap/security/xwss/XwsSecurityInterceptor.html) for instance, I use that to set the authentication on ALL requests.

# android - 创建自定义复合视图

> ID：11141254
> 
> 赞同：0
> 
> 时间：2012-06-21T15:14:07.070
> 
> 标签：android, android-layout

我正在尝试创建一个顶部`ImageView`带有 a的视图。`TextView`

我一直在努力寻找任何好的例子，所以我希望有人能告诉我我做错了什么或在哪里寻找例子。我看过[http://developer.android.com/guide/topics/ui/custom-components.html#compound](http://developer.android.com/guide/topics/ui/custom-components.html#compound)但只真正描述了最低要求。

我发现了一些东西，比如[使用自定义 XML 属性创建复合控件](https://stackoverflow.com/questions/5014679/creating-compound-controls-with-custom-xml-attributes)，但我的设置有点不同。

我的代码在下面，它扩展`LinearLayout`了，我不确定这是否是可行的方法。布局中不显示任何内容。

**ImageWithOverlay**

```
public class ImageWithOverlay extends LinearLayout {
    ImageView image;
    TextView text;

    public ImageWithOverlay(Context context) {
        super(context);
        setupDisplay(context);
    }

    public ImageWithOverlay(Context context, AttributeSet attrs) {
        super(context, attrs);
        setupDisplay(context);
    }

    public ImageWithOverlay(Context context, AttributeSet attrs, int defStyle) {
        super(context, attrs, defStyle);
        setupDisplay(context);
    }

    @Override
    public void onDraw(Canvas canvas) {
        super.onDraw(canvas);
        image.draw(canvas);
        text.draw(canvas);
    }

    @Override
    protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {     
        super.onMeasure(widthMeasureSpec, heightMeasureSpec);      
    }

    private void setupDisplay(Context context) {
        image = new ImageView(context);
        image.setImageResource(R.drawable.flowers);
        LayoutParams lp = new LayoutParams(LayoutParams.MATCH_PARENT, LayoutParams.WRAP_CONTENT);
        image.setLayoutParams(lp);

        text = new TextView(context);
        text.setText("testing");
        lp = new LayoutParams(LayoutParams.MATCH_PARENT, LayoutParams.WRAP_CONTENT);
        text.setLayoutParams(lp);
    }
} 
```

**状态.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

    <com.package.blah.ImageWithOverlay
        android:id="@+id/imageWithOverlay1"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true" >
    </com.package.blah.ImageWithOverlay>

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T15:31:15.737

使用 RelativeLayout 而不是 LinearLayout，这将允许您将文本放置在图像上。

它们没有出现的原因是它们没有使用 addView 添加，所以在你设置好每个的 LayoutParams 之后调用它。

删除 onDraw() 调用，除非您明确要求，否则它不会用于 ViewGroups。一旦添加了视图，它们就会自动绘制出来。

# unix - 通过 sigaction 处理信号

> ID：11141258
> 
> 赞同：1
> 
> 时间：2012-06-21T15:14:15.390
> 
> 标签：unix, event-handling, signals, signal-handling

当我遇到此代码和注释时，我正在阅读有关 pselect 系统调用的使用...

```
static void handler(int sig) { /* do nothing */  }

int main(int argc, char *argv[])
{
    fd_set readfds;
    struct sigaction sa;
    int nfds, ready;

    sa.sa_handler = handler;     /* Establish signal handler */
    sigemptyset(&sa.sa_mask);
    sa.sa_flags = 0;
    sigaction(SIGINT, &sa, NULL);
/* ... */    
    ready = select(nfds, &readfds, NULL, NULL, NULL);
/* ... */
} 
```

* * *

```
this solution suffers from a race condition: if the SIGINT signal is delivered after
the call to sigaction(), but before the call to select(), it will fail to interrupt 
that select() call and will thus be lost. 
```

现在我不确定**sigaction 系统调用**...最初我认为它有点**保存**与信号相对应的处理程序，就是这样...当信号到达时，它会查找它的处理程序并执行处理程序...但是如果那样的话是正确的，那么对应于信号的处理程序将为整个程序保存，并且每当信号到达时都会执行它......所以**无论sigaction和select之间的持续时间多么短，都会处理信号**......

**但是这段代码**看起来好像**只有当它与 sigaction 的调用/执行一致时才处理信号**......在调用完成后，信号将不会由 sigaction 为程序的其余部分设置的处理程序处理（我知道，听起来很荒谬）

请解释！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T19:14:29.660

您需要在文章的上下文中查看该代码 - 该代码试图安排信号中断`select()`。提到的竞争条件不会导致`sigaction()`或信号处理程序以任何方式失败 - 它只是注意到信号有可能在`sigaction()`调用和`select()`调用之间传递，这使得该模式对于实现预期结果是不可接受的。`sigaction()`您是对的，无论是 before 、 during 还是 after ，任何时间到达的信号都将被处理`signal()`。但是，这不能用于可靠地为 提供早期中断路径`select()`，这就是本文的上下文。

# facebook - Facebook Open Graph 多张图片不显示在 Feed 中

> ID：11141260
> 
> 赞同：3
> 
> 时间：2012-06-21T15:14:32.957
> 
> 标签：facebook, facebook-opengraph

我很想知道提要中是否真的出现了多张图片。我知道它们是受支持的，但在没有一个测试案例中，我看到提要上显示了多张图像。那么在打开的图形对象中有多个图像有什么意义呢？二次、三次图像去哪里了？

> 应在图表中代表您的对象的图像 URL。图片必须至少为 50 像素 x 50 像素，并且最大宽高比为 3:1。我们支持 PNG、JPEG 和 GIF 格式。**您可以包含多个 og:image 标签以将多个图像与您的页面相关联。**

使用对象调试器进行测试清楚地表明它们在那里正确（没有图像类型属性​​）：

[https://developers.facebook.com/tools/debug/og/object?q=http%3A%2F%2Fpluggin.it%2Fs%2FTI4o%2F](https://developers.facebook.com/tools/debug/og/object?q=http%3A%2F%2Fpluggin.it%2Fs%2FTI4o%2F)

（http://pluggin.it/s/TI4o/ - 请注意 OG 标签仅针对 Facebook 用户代理显示）

> 您可以使用此标记指定多个图像。第一个图像匹配的最低要求是默认选择。创作状态更新的 Facebook 用户可能会根据您明确定义的图像选择不同的缩略图。酒店可能包含多张酒店照片作为 Open Graph 协议图像，允许分享故事的人分享泳池景观或餐厅景观。

基本上我知道如何将图像放入图表中，但我似乎无法找到它们在新提要中的显示位置/方式。Instagram 之类的应用程序是否将图像放入照片库而不是使用开放图形？他们就是这样显示多张图片的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T15:23:25.000

这些提要帖子中始终只有一张图片。

> “创作状态更新的 Facebook 用户可能会根据您明确定义的图像选择不同的缩略图。”</p>

当您在 OG 标签中提供多张图片时，发布帖子的用户可以在发布帖子时在它们之间进行选择。他选择，他发布 - 选择的图像将*保留*该帖子的*一个*图像。

# javascript - Firefox 和 Opera 中的事件委托要快得多，这是怎么回事？[jQuery]

> ID：11141269
> 
> 赞同：2
> 
> 时间：2012-06-21T15:14:52.380
> 
> 标签：javascript, jquery, browser, event-delegation

我有一个巨大的表（比如几千行），当我点击一行时，我会做一些简单的事情，比如改变行的颜色。问题是，当我单击一行时，更改颜色需要很长时间（1 秒）。我在 Chrome 和 Safari 中看到了这一点。但是当我在 Firefox 或 Opera 中尝试时，它是超级活泼的。

我认为事件委托（而不是将事件侦听器绑定到每一行，父 div 负责处理所有事件）会修复它，但不，它保持不变。

有什么帮助吗？

# haskell - Haskell案例陈述中的“可能不正确的缩进”

> ID：11141272
> 
> 赞同：2
> 
> 时间：2012-06-21T15:15:13.037
> 
> 标签：haskell

我一直在玩弄这个缩进有一段时间了，但它看起来对我来说是正确的。谁能看到我哪里出错了？

```
deposit :: NodeType -> NodeType -> Amount -> Node
deposit (Income income) (Account bal grow) amount =
  Account (bal + transfer) grow where transfer = case amount of
    AbsoluteAmount amount  -> min income amount -- This is line 34
    RelativeAmount percent -> (min 1.0 percent) * income 
```

我收到的错误消息是：

```
Prelude> :load BudgetFlow.hs 
[1 of 1] Compiling Main             ( BudgetFlow.hs, interpreted )

BudgetFlow.hs:34:5: parse error (possibly incorrect indentation)
Failed, modules loaded: none. 
```

第 34 行（出现解析错误的行）是开始的行`AbsoluteAmount`（我在上面用注释标记了它）。我尝试将`case`语句放在单独的行上，并将这两种情况完全缩进到`of`关键字的右侧，但我仍然收到相同的错误消息。非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T15:18:21.973

将`where`子句放在自己的行上。

```
deposit :: NodeType -> NodeType -> Amount -> Node
deposit (Income income) (Account bal grow) amount = Account (bal + transfer) grow
    where
        transfer = case amount of
            AbsoluteAmount amount  -> min income amount -- This is line 34
            RelativeAmount percent -> (min 1.0 percent) * income 
```

# ios - 我可以在 iOS 中创建一个启动语音听写模式的按钮吗？

> ID：11141274
> 
> 赞同：6
> 
> 时间：2012-06-21T15:15:18.010
> 
> 标签：ios

我知道这是一个坏主意（当它可用时，它已经在键盘上时在应用程序中显示语音听写按钮）。但我有一个客户，他真的很想在文本字段中有一个麦克风图标，按下时会进入语音听写模式。

请注意，我说的是标准操作系统语音听写模式（键盘控制）。

所以基本问题是：

我可以告诉键盘进入语音听写模式吗？

（我的猜测是这是不允许的，但我会喜欢比我的直觉更“官方”的东西）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-02-12T14:14:40.720

除非您越狱您的设备，否则这是不可能的。Apple 几乎没有理由提供公共 API 来执行此操作，因为任何时候您都可以调用它，因为键盘无论如何都会显示，其中包含用于激活它的按钮。

# mysqldump - 是否可以让 mysqldump 跳过特定表的插入？

> ID：11141282
> 
> 赞同：8
> 
> 时间：2012-06-21T15:15:45.467
> 
> 标签：mysqldump

我经常`mysqldump`针对 Drupal 数据库运行，这些缓存表可能会变得很大。考虑到我在重新加载数据后要做的第一件事就是清除缓存，如果我可以完全跳过转储所有这些行，我会很高兴。我不想跳过表创建（使用--ignore-tables），我只想跳过所有这些缓存数据行。

是否可以告诉`mysqldump`转储`CREATE TABLE`语句跳过`INSERT`特定表集的语句？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-21T15:20:10.890

有一个`--no-data`选项可以执行此操作，但它会影响所有表 AFAIK。所以，你必须跑`mysqldump`两次。

```
# Dump all but your_special_tbl
mysqldump --ignore-table=db_name.your_special_tbl db_name > dump.sql

# Dump your_special_tbl without INSERT statements.
mysqldump --no-data db_name your_special_tbl >> dump.sql 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-17T12:15:17.717

你必须打`mysqldump`两次电话。

[mysql-stripped-dump 脚本](https://github.com/amenk/SelfScripts/blob/master/mysql-stripped-dump)正是这样做的。

# javascript - 正则表达式在 JS 文件中查找第一条评论

> ID：11141283
> 
> 赞同：2
> 
> 时间：2012-06-21T15:15:51.397
> 
> 标签：javascript, regex

我正在尝试编写一个正则表达式（在 JavaScript 中），它将匹配 JS 文件开头的多行注释。

到目前为止，我想出了这个：`/^(\/\*[^\*\/]*\*\/)/g`

它适用于单行注释：[http](http://refiddle.com/24o)
://refiddle.com/24o 但我的问题是它不适用于多行注释：[http ://refiddle.com/24m](http://refiddle.com/24m)

您有任何解决方法的想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T15:51:32.833

像[HTML](https://stackoverflow.com/a/1732454/201952)一样，JavaScript***不能***被正则表达式解析。试图*正确地*这样做是徒劳的。

相反，您必须使用将 JavaScript 源代码正确转换为[AST](http://en.wikipedia.org/wiki/Abstract_syntax_tree)的解析器，您可以通过编程方式对其进行检查。幸运的是，有一些库可以[为您进行解析](https://github.com/mishoo/UglifyJS)。

[这是一个输出此代码的 AST 的工作示例：](http://jsfiddle.net/josh3736/UqsE7/)

```
/* this is a
multi-line
comment */

var test = "this is a string, /* and this is not a comment! */";

// ..but this is 
```

这让我们：

```
[
  "toplevel",
  [
    [
      {
        "name": "var",
        "start": {
          "type": "keyword",
          "value": "var",
          "line": 5,
          "col": 4,
          "pos": 57,
          "endpos": 60,
          "nlb": true,
          "comments_before": [
            {
              "type": "comment2",
              "value": " this is a\n    multi-line\n    comment ",
              "line": 1,
              "col": 4,
              "pos": 5,
              "endpos": 47,
              "nlb": true
            }
          ]
        },
        "end": {
          "type": "punc",
          "value": ";",
          "line": 5,
          "col": 67,
          "pos": 120,
          "endpos": 121,
          "nlb": false,
          "comments_before": []
        }
      },
      [
        [
          "test",
          [
            {
              "name": "string",
              "start": {
                "type": "string",
                "value": "this is a string, /* and this is not a comment! */",
                "line": 5,
                "col": 15,
                "pos": 68,
                "endpos": 120,
                "nlb": false,
                "comments_before": []
              },
              "end": {
                "type": "string",
                "value": "this is a string, /* and this is not a comment! */",
                "line": 5,
                "col": 15,
                "pos": 68,
                "endpos": 120,
                "nlb": false,
                "comments_before": []
              }
            },
            "this is a string, /* and this is not a comment! */"
          ]
        ]
      ]
    ]
  ]
] 
```

现在只需遍历 AST 并提取您需要的内容即可。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T15:19:39.970

您建议的正则表达式不起作用，因为`*`评论中有 a 。此外，它只会查找文件开头的注释。

尝试改用这个：

```
/\/\*[\s\S]*?\*\// 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-21T15:23:18.970

[在这个链接](http://ostermiller.org/findcomment.html)上有一个很好的讨论这个问题。这对你有帮助吗？

他的解决方案是：

`/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*+/`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-21T15:21:31.013

尝试

```
/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*+/ 
```

[本页](http://ostermiller.org/findcomment.html)详细介绍了如何查找多行注释。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-21T15:21:38.987

这是一个匹配任何多行或单行注释的注释：

```
/(\/\*.*?\*\/|\/\/[^\n]+)/ 
```

如果您只想要多行匹配，请放弃后半部分：

```
/\/\*.*?\*\// 
```

对于这两个，请确保您`s`设置了标志，以便`.`匹配新行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-21T22:50:14.140

我不是 javascript 专家，但似乎必须考虑 C/C++ 注释。
正确完成意味着必须在过程中考虑报价（转义和所有这些）。

以下是两种有效的正则表达式方法。Regex 1 直接找到第一个C风格的注释，一匹配就找到了。正则表达式 2 是一般情况。它查找 C 样式、C++ 样式或非注释，是全局的，并允许您在找到所需内容时中断。

在这里测试[http://ideone.com/i1UWr](http://ideone.com/i1UWr)

代码

```
var js = '\
// /* C++ comment  */      \\\n\
   /* C++ comment (cont) */  \n\
/* t "h /* is"               \n\
 is first C-style /*         \n\
//  comment */               \n\
and /*second C-style*/       \n\
then /*last C-style*/        \n\
';

var cmtrx1 = /^(?:\/\/(?:[^\\]|\\\n?)*?\n|(?:"(?:\\[\S\s]|[^"\\])*"|'(?:\\[\S\s]|[^'\\])*'|[^\/"'\\]*))+(\/\*[^*]*\*+(?:[^\/*][^*]*\*+)*\/)/;

var cmtrx2 = /(\/\*[^*]*\*+(?:[^\/*][^*]*\*+)*\/)|(\/\/(?:[^\\]|\\\n?)*?)\n|(?:"(?:\\[\S\s]|[^"\\])*"|'(?:\\[\S\s]|[^'\\])*'|[\S\s][^\/"'\\]*)/g;

//
print ('Script\n===========\n'+js+'\n===========\n\n');

var match;
//
print ("Using Regex 1\n---------------\n");
if ((match=cmtrx1.exec( js )) != null)
    print ("Found C style comment:\n'" + match[1] + "'\n\n");
//
print ("Using Regex 2\n---------------\n");
while ((match=cmtrx2.exec( js )) != null)
{
   if (match[1] != undefined)
   {
        print ("- C style :\n'" + match[1] + "'\n");
        // break;     // uncomment to stop after first c-style match
   }
   // comment this to not print it
   if (match[2] != undefined)
   {
        print ("- C++ style :\n'" + match[2] + "'\n");
   }
} 
```

输出

```
Script
===========
// /* C++ comment  */      \
   /* C++ comment (cont) */  
/* t "h /* is"               
 is first C-style /*         
//  comment */               
and /*second C-style*/       
then /*last C-style*/        

===========

Using Regex 1
---------------

Found C style comment:
'/* t "h /* is"               
 is first C-style /*         
//  comment */'

Using Regex 2
---------------

- C++ style :
'// /* C++ comment  */      \
   /* C++ comment (cont) */  '

- C style :
'/* t "h /* is"               
 is first C-style /*         
//  comment */'

- C style :
'/*second C-style*/'

- C style :
'/*last C-style*/' 
```

扩展正则表达式

```
Regex 1:

/^(?:\/\/(?:[^\\]|\\\n?)*?\n|(?:"(?:\\[\S\s]|[^"\\])*"|'(?:\\[\S\s]|[^'\\])*'|[^\/"'\\]*))+(\/\*[^*]*\*+(?:[^\/*][^*]*\*+)*\/)/

     /^
     (?:
          \/\/
          (?: [^\\] | \\\n? )*?
          \n
       |
          (?:
               "
               (?: \\[\S\s] | [^"\\] )*
               "
            |  '
               (?: \\[\S\s] | [^'\\] )*
               '
            |  [^\/"'\\]*
          )
     )+
1    (
          \/\* [^*]* \*+
          (?: [^\/*] [^*]* \*+ )*
          \/
1    )
     /

Regex 2:

/(\/\*[^*]*\*+(?:[^\/*][^*]*\*+)*\/)|(\/\/(?:[^\\]|\\\n?)*?)\n|(?:"(?:\\[\S\s]|[^"\\])*"|'(?:\\[\S\s]|[^'\\])*'|[\S\s][^\/"'\\]*)/g

     /
1    (
          \/\* [^*]* \*+
          (?: [^\/*] [^*]* \*+ )*
          \/
1    )
  |
2    (
          \/\/
          (?: [^\\] | \\\n? )*?
2    )
     \n
  |
     (?:
          "
          (?: \\[\S\s] | [^"\\] )*
          "
       |  '
          (?: \\[\S\s] | [^'\\] )*
          '
       |  [\S\s][^\/"'\\]*
     )
     /g 
```

# c# - ManagedThreadId 不断增加

> ID：11141285
> 
> 赞同：2
> 
> 时间：2012-06-21T15:15:56.460
> 
> 标签：c#, multithreading

我注意到在我的许多服务（使用多个线程）中，线程 ID 不断增加它们的值。这是麻烦的征兆吗？我是否以某种方式没有将它们返回到池中，或者这个值是否会增加正常行为？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T15:17:59.060

只要您的线程正在返回（而不是阻塞、等待、睡眠或无限循环），那么您就可以了。ManagedThreadId 只是一个唯一标识符，它根本不是“线程数”（[http://msdn.microsoft.com/en-us/library/system.threading.thread.managedthreadid.aspx](http://msdn.microsoft.com/en-us/library/system.threading.thread.managedthreadid.aspx)）

> Thread.ManagedThreadId
> 
> 一个整数，表示此托管线程的唯一标识符。

为确保您的线程正在返回，请在 VS 调试器中暂停您的进程并告诉它冻结所有线程并查看“线程”调试窗口。在运行时环境中，我会修改线程代码以增加锁定整数并在线程返回时减少相同的锁定整数（使用 try/finally 块来确保抛出的异常不会导致整数减量丢失） .

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T22:16:33.343

“正确”的答案是否定的，这不正常。不像CLR坏了。您的应用程序应该（大多数情况下，除非您有一些非常好的理由，我什至无法想象它可能是什么）谨慎使用 Thread 线程。如果您正在创建其他 100 个线程，那么您 99% 做错了。

您要么在应该重新使用它们的地方杀死线程，要么在使用线程线程的地方使用线程池线程。

**编辑**好。你可能不相信我。但 MSDN 也是这么说的：

> ManagedThreadId 属性的值不会随时间变化，即使托管公共语言运行时的非托管代码将线程实现为纤程也是如此。

所以只是再次强调它（我在第一次尝试时没有说清楚）......你没有看到现有线程中的线程 ID 发生变化。你会看到不同的线程弹出（用你自己的话来说有数百个）......新线程得到新的 ID。**旧线程不会更改其 ID。**

# php - Paypal 结帐提供的错误运输选项

> ID：11141290
> 
> 赞同：3
> 
> 时间：2012-06-21T15:16:01.820
> 
> 标签：php, magento, paypal

我在 Magento 中的 paypal express checkout 集成遇到问题。在我们的购物车中单击“使用贝宝结帐”的客户将被带到贝宝登录页面。在他们登录到 paypal 后，paypal 会向 magento 发送一个回调，并附上他们的地址以获取运输选项。

出于某种原因，除了常规方法外，paypal 还收到了来自 magento 的奇怪运输选项。它们具有“无费率”之类的名称，并被列为成本 0.00 美元。

我找不到任何关于贝宝从哪里获得运输方式或如何限制它们的信息。我正在使用贝宝支持，但问题似乎出在 magento 上。

有谁知道这些运输方式可能来自哪里和/或如何限制贝宝提供的运输方式？

*更新* Paypal 支持已确认这是一个 magento 问题。Magento 将以下错误选项传递给他们：

```
shippingoptionamount "0.00" "8.95" "23.32" "35.28" "73.91" "0.00"
shippingoptionname "customshippingrate_customshippingrate" "flatrate_flatrate" "fedex_GROUND_HOME_DELIVERY" "fedex_FEDEX_2_DAY" "fedex_PRIORITY_OVERNIGHT" "no_rate" 
```

我一直在试图确定 Magento 从哪里提取其运输方式列表，但到目前为止它仍然让我难以理解。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-06T13:33:33.083

我打算将此添加为评论，但为了确保它保持不变（并引起注意），我已经在 Magento Stack 上回答了这个问题，并使用了一个模块来修复它；

[https://magento.stackexchange.com/questions/6945/paypal-express-shipping-methods/50290#50290](https://magento.stackexchange.com/questions/6945/paypal-express-shipping-methods/50290#50290)

# perl - 为什么这会在 perl 中打印两次？

> ID：11141293
> 
> 赞同：1
> 
> 时间：2012-06-21T15:16:05.233
> 
> 标签：perl, printing

所以我希望有人可以向我解释为什么当我运行以下代码时，它会在行首和行尾打印“.link/output”。我试图让它只在行尾打印。有什么想法吗？

```
#!/usr/local/bin/perl

use warnings;
use strict;
my $logfiles = $ARGV[0]; #file containing the list of all the log file names

my @logf = ();
my $i;

open (F2, "<", $logfiles);

while(<F2>){
    @logf = $_;
    foreach $i(@logf){
        print $_.".link/output";

    }
}
close F2; 
```

例如，如果我正在读取的文件是：

```
cat
dog 
```

我想看看：

```
cat.link/output
dog.link/output 
```

但是我得到的是：

```
.link/outputcat.link/output
.link/outputdog.link/output 
```

有人可以向我解释为什么会发生这种情况和/或如何解决吗？谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-21T15:18:45.980

您的列表开头有一个空元素。简单地`shift @logf`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-21T15:47:05.240

我看不出有什么`@logf`作用。你不能这样做：

```
#!/usr/bin/env perl

use warnings;
use strict;
my $logfiles = $ARGV[0]; #file containing the list of all the log file names

#open(my $f2, "<", $logfiles);

# FOR TESTING, use above in your code
my $f2 = \*DATA;
# ===========

while(<$f2>){
        chomp;
        print "$_.link/output\n";
}
__DATA__
cat
dog 
```

# objective-c - Objective c 综合属性 ivar

> ID：11141295
> 
> 赞同：0
> 
> 时间：2012-06-21T15:16:08.083
> 
> 标签：objective-c

> **可能重复：**
> [可可objective-c 类中变量前面的下划线如何工作？](https://stackoverflow.com/questions/822487/how-does-an-underscore-in-front-of-a-variable-in-a-cocoa-objective-c-class-work)
> [在Objective C中用下划线前缀属性名称](https://stackoverflow.com/questions/3521254/prefixing-property-names-with-an-underscore-in-objective-c)

当我们声明一个属性然后像这样合成它时：@synthesize name = _name; 因此，_name 是我们将在以下实现中使用的 name 属性的实例变量。我的问题是为什么我们需要这个 ivar，如果我没有创建 _name ivar 会发生什么？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T15:19:00.643

我的理解是有一个默认的ivar名称，和属性名是一样的。使用下划线指定自己的原因之一是为了消除 setter 中的歧义：

```
-(void) setFoo:(id) foo {
  // here, foo should ONLY refer to the passed-in var
  // If your ivar is the same, it is ambiguous.
  // If your ivar is _foo, then there is clarity.
} 
```

# jquery - Colorbox onload 有效，但压倒了其他 colorbox 调用

> ID：11141296
> 
> 赞同：0
> 
> 时间：2012-06-21T15:16:10.257
> 
> 标签：jquery, colorbox, onload

我试图让颜色框在页面加载时加载内联 HTML (inline_content_1)。我在用：

```
$(document).ready(function(){
   $(".inline").colorbox({inline:true, width:"440px"});
   $(".inline").colorbox({href:"#inline_content_1", open:true, width:"330px", height:"640px"});
}); 
```

但是，我在页面上还有 4 个其他内联颜色框调用，它们不需要在加载时工作：

```
<div id='inline_content-2'>...html...</div>
<div id='inline_content-3'>...html...</div>
<div id='inline_content-4'>...html...</div>
<div id='inline_content-5'>...html...</div> 
```

正确的内联 HTML (inline_content_1) 会在加载时弹出，但随后页面上的每个颜色框链接 (inline_content_2,3,4,5) 都会加载“inline_content_1”。

请帮忙？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T16:16:36.160

现在，您正在使用选择器“#inline_content-1”告诉所有具有“内联”类的元素。

试试这个：

```
$(document).ready(function(){
   $(".inline").colorbox({inline:true, width:"440px"});
   $.colorbox({inline:true, href:"#inline_content_1", open:true, width:"330px", height:"640px"});
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T15:24:21.457

更改您的选择器以使用您想要出现的 div 的 id`onload`吗？

```
$(document).ready(function(){
    $(".inline #inline_content-1").colorbox({inline:true, width:"440px"});
    $(".inline #inline_content-1").colorbox({href:"#inline_content_1", open:true, width:"330px", height:"640px"});
}); 
```

感谢您花时间思考这个问题！我目前正在使用：

```
<link rel="stylesheet" href="/colorbox/colorbox.css" />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script src="/colorbox/jquery.colorbox.js"></script>
<script>
    $(document).ready(function(){
        $(".inline").colorbox({inline:true, width:"440px"});
        $(".inline #inline_content_onload").colorbox({href:"#inline_content_onload", open:true, width:"330px", height:"640px"});
    });
</script>
<div style='display:none'>
    <div id='inline_content-1'> HTML here</div>
</div>
<div style='display:none'>
    <div id='inline_content-2'> HTML here</div>
</div>
<div style='display:none'>
    <div id='inline_content-3'> HTML here</div>
</div>
<div style='display:none'>
    <div id='inline_content-4'> HTML here</div>
</div>

<div style='display:none'>
    <div id='inline_content_onload'> HTML onload here</div>
</div> 
```

# performance - NYTProf 显示 DBI::st::fetch 在 if 语句中被调用？

> ID：11141299
> 
> 赞同：1
> 
> 时间：2012-06-21T15:16:14.563
> 
> 标签：performance, perl, dbi

我有一个奇怪的问题。在用 NYTProf 对我的代码进行了多次分析之后。我有一段缓慢的代码，看起来应该非常快？

```
if($my_var){
# spent 112s making 25764253 calls to DBI::st::fetch, avg 4µs/call 
```

线路需要 187 秒才能运行？if 语句中的代码确实使用了绑定变量，但 $my_var 不是其中之一。即使是为什么？

pro-filer 只是有问题并捡起其他东西吗？这个语句在一个

```
while($sth->fetch) 
```

循环，但是在 2 个语句之间有一些代码，并且该代码很好。事实上，代码中的所有 if 语句似乎都慢得不合理？

只是寻找我能得到的任何帮助。我不能发布整个代码。但下面有一些伪代码：

```
use DBI;
my $dbh = <new mysql connection>;
my $sth = $dbh->prepare('SELECT A, B, C FROM D');
$sth->execute();
$sth->bind_columns(\my($a,$b,$c));
while($sth->fetch){
    #do some fun stuff here.
    my $d = $hash_lookup{$c} // 0;
    if($d){
       #do some more fun stuff here. This is where DBI::st::fetch is apparently being called?
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T15:38:08.413

已知错误：

评估 while 条件所花费的时间可能被错误地归因于 while 循环的最后一条语句。

# .net - 如何用 RhinoMocks 替换方法的执行

> ID：11141302
> 
> 赞同：0
> 
> 时间：2012-06-21T15:16:22.170
> 
> 标签：.net, c#-4.0, mocking, rhino-mocks

谁能解释一下为什么在 RhinoMocks 中这段代码仍然执行 native `SomeVirtualMethod`？

```
var repository = MockRepository.GenerateStub<MyRepository>(null, null);
repository.Stub(x => x.SomeVirtualMethod()).Return(new List<SomeObject>()); 
```

当第二行运行时，原来的`SomeVirtualMethod`运行并崩溃，因为它脱离了上下文。我也试过：

```
var repository = MockRepository.GenerateStub<MyRepository>(null, null);
repository.Stub(x => x.SomeVirtualMethod()).Do(new Func<List<SomeObject>>(() => new List<SomeObject>())); 
```

如何确保只调用替代方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T15:43:04.030

我尝试了您的代码段，它对我返回预期的空集合很有效。我能想象你为什么`SomeVirtualMethod`仍然被执行的唯一原因，因为它实际上不是虚拟的！请再次检查。

这是我试过的代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using Rhino.Mocks;

namespace TestProject1
{
    [TestClass]
    public class UnitTest1
    {
        [TestMethod]
        public void TestMethod1()
        {
            var stub = MockRepository.GenerateStub<MyRepository>(null,null);
            stub.Stub(x => x.SomeVirtualMethod()).Return(new List<SomeObject>());
            Assert.AreEqual(0, stub.SomeVirtualMethod().Count());
        }
    }

    public class MyRepository {

        public MyRepository(object a1, object a2) { }
        public virtual IEnumerable<SomeObject> SomeVirtualMethod()
        {
            throw new NotImplementedException();
        }
    }

    public class SomeObject {}
} 
```

# c# - Devexpress ASPXUploader UploadedFiles.Count 始终为 1

> ID：11141307
> 
> 赞同：0
> 
> 时间：2012-06-21T15:16:39.863
> 
> 标签：c#, asp.net, file-upload, devexpress

```
void SaveFiles(out XElement Attachments)
    {
        Attachments = null;
        if (Uploader1.UploadedFiles.Count() > 0)
        {
            Attachments = new XElement("files");
            foreach (var file in Uploader1.UploadedFiles)
            {
                string ext = System.IO.Path.GetExtension(file.FileName).ToLower();
                string FileName = System.IO.Path.GetFileNameWithoutExtension(file.FileName) + "_" + Guid.NewGuid().ToString().Substring(0, 4) + ext;
                Attachments.Add(new XElement("file", FileName));
                file.SaveAs(AppDomain.CurrentDomain.BaseDirectory + "upload\\support\\" + FileName);
            }
        }
    } 
```

和标记

```
<dx:ASPxUploadControl ID="Uploader1" runat="server" Width="280px">
    <AdvancedModeSettings EnableMultiSelect="True" />
</dx:ASPxUploadControl> 
```

无论我选择多个文件，甚至这里什么都没有，计数总是 1。 **通过 UploadedFiles 获取文件是否正确？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-24T13:06:12.370

有必要处理**ASPxUploadControl.FileUploadComplete**事件并通过事件的参数检索发布的文件。

查看[此](http://demos.devexpress.com/ASPxperienceDemos/UploadControl/MultiFileSelection.aspx)演示以了解此功能的实际应用。

# scala - Akka Actors 应用程序在高音量下挂起

> ID：11141311
> 
> 赞同：1
> 
> 时间：2012-06-21T15:16:53.637
> 
> 标签：scala, actor, akka

我正在使用 akka 演员开发负载生成器应用程序。该应用程序在处理几百万个请求时运行良好，但是当将负载增加到超过 1000 万个请求或使用无限循环运行负载一段时间（而不是请求数）时，应用程序会挂起。下面是一个简化的实现，它只打印正在测试的命令。我还注意到没有记录统计数据，或者时间结束后应用程序不会关闭。我使用调度程序每 30 秒转储一次统计信息，并在 2 小时后关闭应用程序。以小间隔测试，看不到“统计”和“关机”消息的处理。

知道什么可能导致应用程序挂起吗？

```
import akka.actor._
import akka.util.duration._
import akka.routing.RoundRobinRouter
import com.test.redload.util.CommandGenerator
import org.apache.log4j.Logger
import akka.util.Duration

class LoadWorker extends Actor {
  val log = Logger.getLogger(this.getClass().getName())
  def receive = {
    case "PUT" => sender ! PUT
    case "GET" => sender ! GET
    case "DELETE" => sender ! DELETE
    case "POST" => sender ! POST
    case "HEAD" => sender ! HEAD
  } 
  def PUT():Boolean = {println("PUT");return true}
  def GET():Boolean = {println("GET");return true}
  def DELETE():Boolean = {println("DELETE");return true}
  def POST():Boolean = {println("POST");return true}
  def HEAD():Boolean = {println("HEAD");return true}
}

class LoadGenerator(nrOfWorkers:Int, noOfMessages:Int) extends Actor {

  val log = Logger.getLogger(this.getClass().getName())
  val start:Long = System.currentTimeMillis
  var noOfMessageRcvd:Int = 0
  val r = new CommandGenerator// <- is basically are list implementation that iterates and returns the next command
  r.addCommand("PUT",5) r.addCommand("GET",2) r.addCommand("DELETE",2)
  r.addCommand("POST",2) r.addCommand("HEAD",1) r.addCommand("LBRPOP",1)

  val loadRouter = context.actorOf(Props[LoadWorker].withRouter(RoundRobinRouter(nrOfWorkers)),name ="loadRouter")

  def receive = {
    case "start" => {
      if(noOfMessages > 1) {
        for( i <- 0 until noOfMessages) loadRouter ! r.getRandomCommand()
      } else {
        log.info("Time bound Load run..")
        //for( i <- 0 until 10000000) { //<- For any number greater than few millions that app hangs after few messages
        while(true){loadRouter ! r.getRandomCommand() //<- with while loop the app hangs as soon as it begins
        }
      }
    }
    case true => {
          noOfMessageRcvd +=1
          if(noOfMessages == noOfMessageRcvd){
             self ! "shutdown"
          }
    }
    case "stats" => {
          logStats()
    }
    case "shutdown" => {
          logStats()
          log.info("Shutting Down!")
          context.system.shutdown()
    }
  }
  def logStats(){
    var duration = (System.currentTimeMillis - start)/1000
    if( duration > 0) {
        log.info(noOfMessageRcvd+" messages processed in "+duration +" seconds "
         + "at "+ noOfMessageRcvd/duration +" TPS" )
    } else {
        log.info(noOfMessageRcvd+" messages processed in less than a second ")
    }
  }
}

object RedLoad extends App{
    val log = Logger.getLogger(this.getClass().getName())
    val system = ActorSystem("LoadGeneratorApp");
    // -1 is if we want to run for a period of time and > 1 the run will end after the messages are procesed
    val lg = system.actorOf(Props(new LoadGenerator(100,-1)),"LG")
    //Log the stats every 30 seconds
    system.scheduler.schedule(0 seconds,30 seconds,lg,"stats")
    //Shutdown the load run after 2 hours, if no of message is  > -1 then it will shutdown after
    //all messages are processed
    system.scheduler.scheduleOnce(2 hours,lg,"shutdown")
    lg ! "start"
    log.info("Started..")
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T13:44:39.640

好吧，您的演员一次不能处理超过一条消息，您只需将其设置为永远忙于发送消息。按设计工作。移除无限循环并向 loadRouter 发送批量消息，然后向自己发送 continuation-messages 以继续发送更多消息。

```
case SendBatch =>
  (1 to batchSize) foreach { router ! message }
  self ! SendBatch 
```

# c++ - 如何从 SuperBible 获取 GLTools 库以在 Ubuntu 中工作？或替代方案？

> ID：11141312
> 
> 赞同：3
> 
> 时间：2012-06-21T15:16:54.373
> 
> 标签：c++, linux, opengl, ubuntu, codeblocks

我最近买了 SuperBible 第 5 版书。我使用 Ubuntu 12.04 LTS。我使用代码::块。我对 C++ 库和设置不是很精通。我想要一本能从头开始指导我的书。当我看到这本书没有帮助我们在 Linux 中建立项目时，我感到很失望。

他们使用 2 个库，freeglut 和 GLTools。我读[了这篇](http://www.codeproject.com/Articles/182109/Setting-up-an-OpenGL-development-environment-in-Ub)精彩的教程，解释了 linux 的 freeglut 部分。

现在我对GLTools一无所知。我在 debian.org 中搜索了一个包含 GLTools.h 的包，但没有。所以，我根本找不到包裹。 [在这里](http://www.starstonesoftware.com/OpenGL/)，他们确实提供了库，但仅适用于 Windows 和 Mac。在 Ubuntu 中包含一个库是小菜一碟（只是终端中的一个命令），但我不知道如何为此使用 Windows 库。

有没有其他书可以帮助Linux？

编辑：在完成 HaloWebMaster 所说的第 2 步之后，我做了一张 cd 并进入了 gltools 文件夹（那里有一个 makefile）。我做到了`make all`。但这就是发生的事情：

```
Package OpenEXR was not found in the pkg-config search path.
Perhaps you should add the directory containing `OpenEXR.pc'
to the PKG_CONFIG_PATH environment variable
No package 'OpenEXR' found
make[1]: sdl-config: Command not found
make[1]: Entering directory `/home/user/gltools/framework'
make[1]: freetype-config: Command not found
Package OpenEXR was not found in the pkg-config search path.
Perhaps you should add the directory containing `OpenEXR.pc'
to the PKG_CONFIG_PATH environment variable
No package 'OpenEXR' found
make[1]: sdl-config: Command not found
make[1]: freetype-config: Command not found
Compiling camera.cpp
Package OpenEXR was not found in the pkg-config search path.
Perhaps you should add the directory containing `OpenEXR.pc'
to the PKG_CONFIG_PATH environment variable
No package 'OpenEXR' found
make[1]: sdl-config: Command not found
make[1]: freetype-config: Command not found
Package OpenEXR was not found in the pkg-config search path.
Perhaps you should add the directory containing `OpenEXR.pc'
to the PKG_CONFIG_PATH environment variable
No package 'OpenEXR' found
make[1]: sdl-config: Command not found
make[1]: freetype-config: Command not found
Compiling fs.cpp
Package OpenEXR was not found in the pkg-config search path.
Perhaps you should add the directory containing `OpenEXR.pc'
to the PKG_CONFIG_PATH environment variable
No package 'OpenEXR' found
make[1]: sdl-config: Command not found
make[1]: freetype-config: Command not found
Package OpenEXR was not found in the pkg-config search path.
Perhaps you should add the directory containing `OpenEXR.pc'
to the PKG_CONFIG_PATH environment variable
No package 'OpenEXR' found
make[1]: sdl-config: Command not found
make[1]: freetype-config: Command not found
Compiling image/image-convert.cpp
image/image-convert.cpp:7:18: fatal error: half.h: No such file or directory
compilation terminated.
Compilation failed for libgltools_a_image-convert.o: 
make[1]: *** [libgltools_a_image-convert.o] Error 1
make[1]: Leaving directory `/home/user/gltools/framework'
make: *** [framework] Error 2 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T15:22:16.010

```
wget http://gltools.svn.sourceforge.net/viewvc/gltools/?view=tar
tar xzvf gltools.tar.gz
make all 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T12:55:08.060

找到了更好的方法：`svn checkout http://oglsuperbible5.googlecode.c./Src/GLTools/include/om/svn/trunk/ oglsuperbible5-read-only`，然后将文件从 ./Src/GLTools/include/ 复制到 $INCLUDE 中的某个位置

# c# - 使用 FileStream 模拟使用

> ID：11141314
> 
> 赞同：16
> 
> 时间：2012-06-21T15:16:57.820
> 
> 标签：c#, rhino-mocks

我一直在尝试使用文件流来模拟使用，但无法完成此操作并且不确定如何操作，我正在使用 rhino mock。

```
private Connection LoadConnectionDetailsFromDisk(string bodyFile)
{     
   //logic before
   using (FileStream fs = File.Open(bodyFile, FileMode.Open, FileAccess.Read, FileShare.ReadWrite))
   {
     return this.serverConfiguration.LoadConfiguration(fs, flowProcess);
   }
    //more logic
} 
```

谁能告诉我如何模拟 using(FileStream....) 以便我能够访问代码的这个分支？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-21T15:23:10.110

您必须通过接口方法进行抽象`File.Open()`，然后才能模拟对它的调用。

所以

1）创建接口：

```
public interface IFileDataSource
{
   FileStream Open(string path,
                   FileMode mode,
                   FileAccess access,
                   FileShare share);
} 
```

2) 更改`LoadConnectionDetailsFromDisk()`如下：

```
private Connection LoadConnectionDetailsFromDisk(string path, IFileDataSource fileSource)
{     
   using (FileStream fs = fileSource.Open(bodyFile, FileMode.Open, FileAccess.Read, FileShare.ReadWrite))
   {
      return this.serverConfiguration.LoadConfiguration(fs, flowProcess);
   }

   //more logic
} 
```

3）在测试模拟接口并注入模拟

```
// create a mock instance
var sourceMock = MockRepository.GenerateMock<IFileDataSource>();

// setup expectation
sourceMock.Expect(m => m.Open("path", FileMode.Open, FileAccess.Read, FileShare.ReadWrite)
         .CallBack(
 delegate (string path, FileMode mode, FileAccess access, FileShare share)
 {
      // handle a call

     return true;
 }).Repeat.Any();

// TODO: depends on how you are triggering LoadConnectionDetailsFromDisk method call
// inject a mock 
```

考虑到`LoadConnectionDetailsFromDisk()`您不能从测试中直接将模拟注入此方法调用，因此请说明如何调用此方法。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-10-22T18:25:10.923

[System.IO.Abstractions 项目](https://github.com/System-IO-Abstractions/System.IO.Abstractions)和[NuGet 包](https://www.nuget.org/packages/System.IO.Abstractions/)还允许模拟`FileStreams`.

要使用它，您必须首先稍微更改获取 FileStream 的方式，例如：

```
private readonly IFileSystem _fileSystem; // this is from the third-party System.IO.Abstractions package

// This is assuming dependency injection to insert the mock file system during testing, 
// or the real one in production
public YourConstructor(IFileSystem fileSystem)
{
   _fileSystem = fileSystem;
}

private Connection LoadConnectionDetailsFromDisk(string bodyFile)
{     
   using (Stream fs = _fileSystem.FileStream.Create(bodyFile, FileMode.Open))
   {
       return this.serverConfiguration.LoadConfiguration(fs, flowProcess);
   }

   //more logic
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-07-24T07:59:14.940

您可以为此目的使用[SystemWrapper库。](http://systemwrapper.codeplex.com/wikipage?title=FileInfo%20Tutorial&referringTitle=Home)它包含包装系统类的接口和类，并使您能够使用这些类对方法进行单元测试。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-11-01T13:56:29.440

也许您可以使用下面的代码片段来模拟 FileStream

```
Mock<FileStream> mockFileStream = new Mock<FileStream>(new IntPtr(1), FileAccess.Read); 
```

这样，您创建了一个新的 FileStream 实例，您可以像下面这样使用它

```
mockObject.Setup(s => s.GetFileStream(It.IsAny<string>())).Returns(mockFileStream.Object); 
```

mockObject 是您返回 FileStream 的任何接口

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-21T15:22:47.637

我会重构该方法，以便将 FileStream 传递给该方法，以便您可以创建文件流的模拟

```
private Connection LoadConnectionDetailsFromDisk(FileStream bodyFile)
{ 
  ....
} 
```

如果你真的想变得花哨，你总是可以接受一个 IStream 然后模拟那个 IStream 但 Rhino 支持创建 concreate 类的模拟

```
 MockRepository mocks = new MockRepository();
 FileStream basket = mocks.CreateMock<FileStream>(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-09-10T14:29:01.997

我通过创建一个`FileStream`子类来处理它。基本构造函数*确实*要求我们打开一个实际文件，因此我包含一个设置为“内容”和“如果较新则包含”的简单文本文件，我们以只读和可共享的方式打开它。

然后我覆盖我实际需要的方法。就我而言，我需要 write 方法，并且我需要对写入的内容做一些事情，所以我注入了一个回调来调用。

```
private class CustomFileStream : FileStream
{
    private Action<string> WriteAction { get; }
    public CustomFileStream(Action<string> writeAction)
        // FileStream is notoriously hard to mock, so we inherit from it and we are a lightweight, real (but unused) FileStream underneath
        : base(Path.Combine(new ExecutionDirectory().Path /* Handle the execution directory in your own way */, "Content/DummyTextFile.txt"), FileMode.Open, FileAccess.Read, FileShare.ReadWrite)
    {
        this.WriteAction = writeAction;
    }

    public override bool CanWrite => true;
    public override void Write(ReadOnlySpan<byte> buffer)
    {
        this.WriteAction(Encoding.UTF8.GetString(buffer));
    }
} 
```

# delphi - 如何在一个表单上创建多个单选按钮组？

> ID：11141319
> 
> 赞同：8
> 
> 时间：2012-06-21T15:17:10.673
> 
> 标签：delphi, radio-button, delphi-xe2, firemonkey, radio-group

使用 VCL，我们有一个`TRadioGroup`类，其中包含`Items`您可以在设计时修改的属性。使用 Firemonkey，我们只有`TRadioButton`类。

据我了解，如果您将类型对象`TRadioButton`作为子对象添加到其他容器对象（例如`TPanel`, `TGroupBox`），这些容器将有效地充当 VCL`TRadioGroup`对象。

然而，这些单独的单选按钮似乎表现得好像它们都是同一个父级的子级。如果选择 A 组中的单选按钮，然后选择 B 组中的单选按钮，则取消选择 A 组中的单选按钮。

如何在一个容器对象中获取单选按钮而不取消选择其他容器对象中的单选按钮？

这是我的表单设计示例： ![在此处输入图像描述](../Images/d65865741e4950c59fbe7bf8432be382.png)

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-21T16:34:44.513

设置[`GroupName`](http://docwiki.embarcadero.com/Libraries/en/FMX.Controls.TRadioButton.GroupName)按钮的属性。具有相同组名的单选按钮将作为一个单独的组。

# java - 如何使用 Java 解压缩由 Linux 创建的受密码保护的存档

> ID：11141321
> 
> 赞同：3
> 
> 时间：2012-06-21T15:17:14.283
> 
> 标签：java, android, passwords, unzip

我最近在做一个 Android 项目，遇到了一个问题。我向 webservice 发送了一个请求，并获得了一个带有密码保护的 zip 文件。使用 Linux 命令创建 zip 文件

```
zip -P 123123123123123123 test.zip test.txt 
```

我想用Java解压。因为没有标准的 API 支持所以我需要第三个库。

1.  我试过`winzipaes`了，但它提示我的zip文件不是AES-256格式。
2.  不能用`sevenzipjbinding`，太大了

你对此有什么建议吗？你知道 Linux 使用什么算法来加密 zip 文件吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-10T06:34:14.063

最后，我完成了 zip4j。

1.  下载 zip4j-1.3.1 并将其导入项目。

2.  示例代码：

    ```
    ZipFile zipFile = new ZipFile(YourZipFile);
    if(zipFile.isEncrypted()){
       zipFile.setPassword(Password);
    }
    zipFile.extractAll(Destination); 
    ```

# c# - 在我的 MVC 视图中获取 ViewModel 数据

> ID：11141330
> 
> 赞同：2
> 
> 时间：2012-06-21T15:17:44.323
> 
> 标签：c#, asp.net-mvc, viewmodel

我相信这相对简单，我只是不断地碰到砖墙。我有两个像这样设置的实体类：

```
public class Post
{
    public int Id { get; set; }
    public string Title { get; set; }
    public DateTime CreatedDate { get; set; }
    public string Content { get; set; }
    public string Tags { get; set; }
    public ICollection<Comment> Comments { get; set; }
}

public class Comment
{
    public int Id { get; set; }
    public string DisplayName { get; set; }
    public string Email { get; set; }
    public DateTime DateCreated { get; set; }
    public string Content { get; set; }
    public int PostId { get; set; }
    public Post Post { get; set; }
} 
```

我像这样设置我的 ViewModel：

```
public class PostCommentViewModel
{
    public Post Post { get; set; }
    public IQueryable<Comment> Comment { get; set; }

    public PostCommentViewModel(int postId)
    {
        var db = new BlogContext();

        Post = db.Posts.First(x => x.Id == postId);
        Comment = db.Comments;
    }
} 
```

我让我的控制器这样做：

```
public ActionResult Details(int id = 0)
    {
        var viewModel = new PostCommentViewModel(id);
        return View(viewModel);
    } 
```

然后视图如下所示：

```
@model CodeFirstBlog.ViewModels.PostCommentViewModel

<fieldset>
<legend>PostCommentViewModel</legend>
@Html.DisplayFor(x => x.Post.Title)
<br />
@Html.DisplayFor(x => x.Post.Content)
<br />
@Html.DisplayFor(x => x.Post.CreatedDate)
<hr />    
@Html.DisplayFor(x => x.Comment)
</fieldset> 
```

结果是显示数据，但不是我想要的评论。

![在此处输入图像描述](../Images/39cb74b316a9d4ecd62a304b525e8b95.png)

您会看到评论（其中有两个）并且仅在每个“12”上显示 id 属性

我怎样才能让它进入并显示特定于该特定帖子的评论详细信息？我想一个 foreach 循环是有序的，但我不知道如何正确钻入 Model.Comment 属性。

我试过这个：

```
@foreach(var item in Model.Comment)
{
@Html.DisplayFor(item.DisplayName)
@Html.DisplayFor(item.Content)
@Html.DisplayFor(item.DateCreated)
} 
```

但我得到的错误是“方法'System.Web.Mvc.Html.DisplayExtensions.DisplayFor(System.Web.Mvc.HtmlHelper, System.Linq.Expressions.Expression>)'的类型参数不能从用法中推断出来。尝试明确指定类型参数。”

不知道我应该在这里做什么..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T15:20:58.003

循环评论模型：

```
@model CodeFirstBlog.ViewModels.PostCommentViewModel

<fieldset>
<legend>PostCommentViewModel</legend>
@Html.DisplayFor(x => x.Post.Title)
<br />
@Html.DisplayFor(x => x.Post.Content)
<br />
@Html.DisplayFor(x => x.Post.CreatedDate)
<hr />    
@foreach(var comment in Model.Comment) {
    @Html.DisplayFor(x => comment)
}
</fieldset> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T15:31:24.560

为您的类创建一个[DisplayTemplate](http://bradwilson.typepad.com/blog/2009/10/aspnet-mvc-2-templates-part-1-introduction.html)`Comment`并且它应该可以工作，无需遍历视图引擎为您执行的集合。

`Comment`根据我的评论，这就是为您的班级创建显示模板所需要做的一切：

在您的视图文件夹中创建一个`DisplayTemplates`子文件夹，并在其中创建一个名为`Comment.cshtml`. 您的模板可能如下所示：

```
@model CodeFirstBlog.ViewModels.Comment

<div class="comment">
    @Html.DisplayFor(m => m.DisplayName)
    ....
</div> 
```

就是这样！如果您需要更多地控制评论的显示方式，那么您可以简单地调整模板以适应。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T15:33:02.880

```
public class PostCommentViewModel 
{ 
    public Post Post { get; set; } 
    public IQueryable<Comment> Comment { get; set; } 

    public PostCommentViewModel(int postId) 
    { 
        var db = new BlogContext(); 

        Post = db.Posts.First(x => x.Id == postId); 
        Comment = Post.Comments; 
    } 
} 
```

您是否为 Comment 类创建了 Html 辅助方法？

# windows - 通过客户端应用程序使用来自 facebook graph api 的实时更新

> ID：11141333
> 
> 赞同：0
> 
> 时间：2012-06-21T15:17:53.310
> 
> 标签：windows, facebook, facebook-graph-api

我想在我的应用中使用 Facebook 的[实时更新](https://developers.facebook.com/docs/reference/api/realtime/)功能。

我的应用程序是客户端应用程序，但据我所知，我需要向`/APP_ID/subscriptions`包含`callback_url`参数的端点发出 HTTP POST 请求。

这个回调 url 有必要吗？

当我使用 Windows 8 Metro 风格应用程序时，我无法为应用程序定义回调 url，因为这是客户端代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T15:32:16.433

如果没有回调 URL，Facebook 将如何联系您告诉您有新的更新？

简短的回答，不，没有回调 URL 就无法接收实时更新

# c++ - 将 c++ 链接到游戏软件

> ID：11141335
> 
> 赞同：0
> 
> 时间：2012-06-21T15:17:59.060
> 
> 标签：c++, gams-math

我想使用 createprocess() 函数将 c++ 链接到 GAMS 软件。我使用了这段代码，但它只是打开了 GAMS 软件。我希望程序在打开 GAMS 软件后自动运行 file.gms：

```
STARTUPINFO si;    
PROCESS_INFORMATION pi;   
ZeroMemory(&si, sizeof(si));  
si.cb = sizeof(si);  
ZeroMemory(&pi, sizeof(pi));  
if(CreateProcessW(L"C:\\PROGRA~1\\gams23.3\\gamside.exe",NULL,NULL,NULL,false,0,NULL,NULL,&si,&pi))   
 {      
    WaitForSingleObject(pi.hProcess, 10000 );   
           CloseHandle( pi.hProcess );   
           CloseHandle( pi.hThread );   
 } 
```

请帮我。非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T16:52:39.300

您应该在第二个参数 ( `LPTSTR lpCommandLine`) 中填写您希望看到 gamside.exe 的命令行（例如，将您的文件作为第一个参数传递）。您需要在那里指定的内容取决于 gamside 程序的规范（这是 WETF）。

顺便说一句：在您的问题标题中使用“链接”一词对该主题有点误导，因为 C++ 上下文中的“链接”通常意味着将库链接到您的可执行文件，而不是从中调用另一个可执行文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T18:02:49.597

从其他编程环境调用 GAMS 模型求解器的一般问题在 GAMS 帮助页面和讨论列表中得到了很好的处理。见，例如

[http://interfaces.gams-software.com/doku.php?id=env:executing_gams_from_other_environments](http://interfaces.gams-software.com/doku.php?id=env:executing_gams_from_other_environments) 或 [http://interfaces.gams-software.com/doku.php?id=env:spawning_gams_from_visual_c](http://interfaces.gams-software.com/doku.php?id=env:spawning_gams_from_visual_c)

您可能需要调用 gams.exe 而不是 gamside.exe，因为您不需要 IDE。从命令行调用 gams.exe 的语法有据可查。

# c++ - OpenCV Python API 的 FileStorage

> ID：11141336
> 
> 赞同：21
> 
> 时间：2012-06-21T15:18:00.257
> 
> 标签：c++, python, image-processing, opencv

我目前正在使用**FileStorage**类来使用 OpenCV **C++** API存储矩阵**XML/YAML 。**

 **但是，我必须编写一个 Python 脚本来读取这些**XML/YAML**文件。

我正在寻找可以读取**OpenCV C++ API生成的****XML/YAML**文件的现有 OpenCV **Python API**

 ***** * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-04-11T06:52:34.133

您可以使用[PyYAML](http://pyyaml.org/)来解析 YAML 文件。

由于 PyYAML 不理解 OpenCV 数据类型，因此您需要为尝试加载的每个 OpenCV 数据类型指定一个构造函数。例如：

```
import yaml
def opencv_matrix(loader, node):
    mapping = loader.construct_mapping(node, deep=True)
    mat = np.array(mapping["data"])
    mat.resize(mapping["rows"], mapping["cols"])
    return mat
yaml.add_constructor(u"tag:yaml.org,2002:opencv-matrix", opencv_matrix) 
```

完成后，加载 yaml 文件很简单：

```
with open(file_name) as fin:
    result = yaml.load(fin.read()) 
```

结果将是一个字典，其中的键是您保存在 YAML 中的任何内容的名称。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2016-02-23T09:07:09.053

除了@misha 的回复，OpenCV YAML 与 Python 有点不兼容。

不兼容的几个原因是：

1.  OpenCV 创建的 Yaml 在“:”之后没有空格。而 Python 需要它。[例如：应该是`a: 2`，而不是`a:2`Python ]
2.  OpenCV 创建的 YAML 文件的第一行是错误的。将“%YAML:1.0”转换为“%YAML 1.0”。或者在阅读时跳过第一行。

以下函数负责提供：

```
import yaml
import re
def readYAMLFile(fileName):
    ret = {}
    skip_lines=1    # Skip the first line which says "%YAML:1.0". Or replace it with "%YAML 1.0"
    with open(scoreFileName) as fin:
        for i in range(skip_lines):
            fin.readline()
        yamlFileOut = fin.read()
        myRe = re.compile(r":([^ ])")   # Add space after ":", if it doesn't exist. Python yaml requirement
        yamlFileOut = myRe.sub(r': \1', yamlFileOut)
        ret = yaml.load(yamlFileOut)
    return ret

outDict = readYAMLFile("file.yaml") 
```

注意：以上响应仅适用于 yaml。XML 有自己的问题，我还没有完全探索过。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2017-07-28T14:12:46.707

使用 OpenCV 3.2 中可用的 FileStorage 函数，我成功地使用了它：

```
import cv2
fs = cv2.FileStorage("calibration.xml", cv2.FILE_STORAGE_READ)
fn = fs.getNode("Camera_Matrix")
print (fn.mat()) 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-03-02T21:53:16.397

我写了一个小片段来用 Python 读写 FileStorage 兼容的 YAML：

```
# A yaml constructor is for loading from a yaml node.
# This is taken from @misha 's answer: http://stackoverflow.com/a/15942429
def opencv_matrix_constructor(loader, node):
    mapping = loader.construct_mapping(node, deep=True)
    mat = np.array(mapping["data"])
    mat.resize(mapping["rows"], mapping["cols"])
    return mat
yaml.add_constructor(u"tag:yaml.org,2002:opencv-matrix", opencv_matrix_constructor)

# A yaml representer is for dumping structs into a yaml node.
# So for an opencv_matrix type (to be compatible with c++'s FileStorage) we save the rows, cols, type and flattened-data
def opencv_matrix_representer(dumper, mat):
    mapping = {'rows': mat.shape[0], 'cols': mat.shape[1], 'dt': 'd', 'data': mat.reshape(-1).tolist()}
    return dumper.represent_mapping(u"tag:yaml.org,2002:opencv-matrix", mapping)
yaml.add_representer(np.ndarray, opencv_matrix_representer)

#examples 

with open('output.yaml', 'w') as f:
    yaml.dump({"a matrix": np.zeros((10,10)), "another_one": np.zeros((2,4))}, f)

with open('output.yaml', 'r') as f:
    print yaml.load(f) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-09-15T15:01:47.590

为了改进@Roy_Shilkrot 先前的答案，我添加了对 numpy 向量和矩阵的支持：

```
# A yaml constructor is for loading from a yaml node.
# This is taken from @misha 's answer: http://stackoverflow.com/a/15942429
def opencv_matrix_constructor(loader, node):
    mapping = loader.construct_mapping(node, deep=True)
    mat = np.array(mapping["data"])
    if mapping["cols"] > 1:
        mat.resize(mapping["rows"], mapping["cols"])
    else:
        mat.resize(mapping["rows"], )
    return mat
yaml.add_constructor(u"tag:yaml.org,2002:opencv-matrix", opencv_matrix_constructor)

# A yaml representer is for dumping structs into a yaml node.
# So for an opencv_matrix type (to be compatible with c++'s FileStorage) we save the rows, cols, type and flattened-data
def opencv_matrix_representer(dumper, mat):
    if mat.ndim > 1:
        mapping = {'rows': mat.shape[0], 'cols': mat.shape[1], 'dt': 'd', 'data': mat.reshape(-1).tolist()}
    else:
        mapping = {'rows': mat.shape[0], 'cols': 1, 'dt': 'd', 'data': mat.tolist()}
    return dumper.represent_mapping(u"tag:yaml.org,2002:opencv-matrix", mapping)
yaml.add_representer(np.ndarray, opencv_matrix_representer) 
```

例子：

```
with open('output.yaml', 'w') as f:
    yaml.dump({"a matrix": np.zeros((10,10)), "another_one": np.zeros((5,))}, f)

with open('output.yaml', 'r') as f:
    print yaml.load(f) 
```

输出：

```
a matrix: !!opencv-matrix
  cols: 10
  data: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    0.0, 0.0, 0.0, 0.0, 0.0]
  dt: d
  rows: 10
another_one: !!opencv-matrix
  cols: 1
  data: [0.0, 0.0, 0.0, 0.0, 0.0]
  dt: d
  rows: 5 
```

虽然我无法控制行、列、dt、数据的顺序。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-03-27T02:56:51.757

pip install opencv-contrib-python 用于视频支持安装特定版本使用 pip install opencv-contrib-python******

# batch-file - 如何使用 Windows 批处理提取特定 XML 标记属性的所有实例

> ID：11141337
> 
> 赞同：0
> 
> 时间：2012-06-21T15:18:00.877
> 
> 标签：batch-file

我有一个 XML 文件，我需要提取

```
testname 
```

从所有的实例

```
<con:testSuite name="testname" 
```

在 XML 文件中。

我不太确定如何解决这个问题，或者这是否可以批量处理。

这是我到目前为止的想法：

1）使用 FINDSTR 并存储每一行

```
<con:testSuite name= 
```

在变量或临时文件中，如下所示：

```
FINDSTR /C:"<con:testSuite name=" file.xml > tests.txt 
```

2）以某种方式使用该文件或变量来提取字符串

请注意，同一行中可能有多个匹配字符串的实例。

我是批处理的新手，不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T16:33:42.507

使用批处理解析 XML 非常痛苦。Batch 并不是一个好的文本处理器。但是，通过一些努力，您通常可以从给定的 XML 文件中提取所需的数据。但是输入文件可以很容易地重新排列成等效的有效 XML 格式，这会破坏您的解析器。

有了这个免责声明......

这是本机批处理解决方案

```
@echo off
setlocal disableDelayedExpansion
set input="test.xml"
set output="names.txt"

if exist %output% del %output%
for /f "delims=" %%A in ('findstr /n /c:"<con:testSuite name=" %input%') do (
  set "ln=%%A"
  setlocal enableDelayedExpansion
  call :parseLine
  endlocal
)
type %output%
exit /b

:parseLine
set "ln2=!ln:*<con:testSuite name=!"
if "!ln2!"=="!ln!" exit /b
for /f tokens^=2^ delims^=^" %%B in ("!ln2!") do (
  setlocal disableDelayedExpansion
  >>%output% echo(%%B
  endlocal
)
set "ln=!ln2!"
goto :parseLine 
```

FINDSTR`/N`选项只是为了保证没有行以 a 开头，`;`这样我们就不必担心讨厌的默认 FOR "EOL" 选项。

打开和关闭延迟扩展的切换是为了保护`!`输入文件中可能存在的任何字符。如果您知道`!`从未出现在输入中，那么您可以简单地`setlocal enableDelayedExpansion`在顶部删除所有其他`setlocal`和`endlocal`命令。

最后一个 FOR /F 使用特殊的转义序列来启用将双引号指定为 DELIM 字符。

**回答评论中的其他问题**

您不能简单地将附加约束放在现有的 FINDSTR 命令中，因为它将返回具有匹配项的整行。请记住您自己说过，*“同一行中可能有多个匹配字符串的实例”*。第一个名称可能以正确的前缀开头，而同一行中的第二个名称可能不是。您只想保留正确启动的那个。

一种解决方案是简单地更改该`echo(%%B >>%output%`行，如下所示：

```
echo(%%B|findstr "^lp_" >>%output% 
```

FINDSTR 使用正则表达式元字符`^`来指定字符串必须以 . 开头`lp_`。此时引号已被删除，因此我们不必担心它们。

但是，您将来可能会遇到必须包含`"`在搜索字符串中的情况。另外，将屏幕包含在初始 FINDSTR 中可能会稍微快`lp_`一些，这样`:parseLine`就不会不必要地调用它。

FINDSTR 要求使用反斜杠对搜索字符串双引号进行转义。但是 Windows CMD 处理器也有自己的转义规则。`>`需要引用或转义之类的特殊字符。原始代码使用引号，但您想在字符串中包含引号，这会在您的命令中创建不平衡的引号。Windows 批处理通常喜欢成对引用。对于 CMD，至少有一个引号必须转义为`^"`. 如果 CMD 和 FINDSTR 都需要对引号进行转义，则它看起来像`\^"`.

但是，字符串中不再从 CMD 角度进行功能引用的任何特殊字符也必须使用转义`^`。

这是一种转义所有特殊字符的解决方案。它看起来很糟糕而且非常混乱。

```
for /f "delims=" %%A in ('findstr /n /c:^"^<con:testSuite^ name^=\^"lp_^" %input%') do ( 
```

这是另一种看起来更好的解决方案，但是跟踪 CMD 转义的内容和 FINDSTR 转义的内容仍然令人困惑。

```
for /f "delims=" %%A in ('findstr /n /c:"<con:testSuite name=\"lp_^" %input%') do ( 
```

让事情变得更简单的一种方法是将搜索转换为正则表达式。可以使用 搜索单个双引号`[\"\"]`。这是一个匹配引号或引号的字符类表达式 - 我知道这很傻。但它保持引号配对，以便 CMD 很高兴。现在您不必担心为 CMD 转义任何字符，您可以专注于正则表达式搜索字符串。

```
for /f "delims=" %%A in ('findstr /nr /c:"<con:testSuite name=[\"\"]lp_" %input%') do ( 
```

# ms-access - 访问查询需要绕过“输入参数值”错误，消息框显示未找到字段

> ID：11141338
> 
> 赞同：1
> 
> 时间：2012-06-21T15:18:05.087
> 
> 标签：ms-access, vba

我有一个与命令按钮相关的简单查询，该按钮显示特定字段中值的摘要。它在每次使用数据库时都会更改的表上运行，因此有时该表将包含此字段，有时则不会。当字段（称为语言）不在文件中时，用户单击命令按钮并获得“输入参数值”消息框。如果他们点击取消，他们就会得到我的消息框，解释该字段在文件中不存在。如果找不到该字段，我想绕过“输入参数值”并直接转到消息。这是我的代码：

```
Private Sub LangCount_Click()
DoCmd.SetWarnings False

On Error GoTo Err_LangCount_Click

    Dim stDocName As String

    stDocName = "LanguageCount"
    DoCmd.OpenQuery stDocName, acNormal, acEdit

Err_LangCount_Click:
    MsgBox "No Language field found in Scrubbed file"
Exit_LangCount_Click:
    Exit Sub

     DoCmd.SetWarnings True
End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T15:37:55.880

在运行查询之前，您可以尝试根据查询打开记录集：

```
Set rs = CurrentDb.QueryDefs("query1").OpenRecordset 
```

如果查询有任何问题，这将直接进入错误编码。

或者，如果它始终是语言字段并且始终在同一个表中，您可以：

```
sSQL = "select language from table1 where 1=2"
CurrentDb.OpenRecordset sSQL 
```

这也将失败并转到您的错误编码，但如果它没有失败，您将拥有一个小得多的记录集，一个零记录。

您可以使用 ADO 模式轻松获取表中的字段列表：

```
Dim cn As Object ''ADODB.Connection
Dim i As Integer, msg As String

    Set cn = CurrentProject.Connection
    Set rs = cn.OpenSchema(adSchemaColumns, Array(Null, Null, "Scrubbed"))

    While Not rs.EOF
        i = i + 1
        msg = msg & rs!COLUMN_NAME & vbCrLf
        rs.MoveNext
    Wend

    msg = "Fields: " & i & vbCrLf & msg

    MsgBox msg 
```

更多信息： http: [//support.microsoft.com/kb/186246](http://support.microsoft.com/kb/186246)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T16:34:33.997

您有一个名为 的命令按钮`LangCount`。它的点击事件必须处理一个名为的字段在您的表`Language`中不存在的可能性。`Scrubbed`

`Language`因此，请考虑为什么当该字段不存在时用户应该能够单击该命令按钮。当该字段不存在时，您知道它`OpenQuery`不起作用（对吗？）......所以只需禁用命令按钮。

看看以下方法是否为您指出了一些有用的东西。

```
Private Sub Form_Load()
    Me.LangCount.Enabled = FieldExists("Language", "Scrubbed")
End Sub 
```

如果在打开表单后 Scrubbed 的结构没有改变，这可能会起作用。如果表单还包括修改`Scrubbed`结构的选项，`LangCount.Enabled`则从该操作进行更新。

这是一个快速且肮脏（经过最少测试，无错误处理）`FieldExists()`的功能，可帮助您入门。

```
Public Function FieldExists(ByVal pField As String, _
        ByVal pTable As String) As Boolean
    Dim blnReturn As Boolean
    Dim db As DAO.Database
    Dim fld As DAO.Field
    Dim tdf As DAO.TableDef
    Set db = CurrentDb
    ' next line will throw error #3265 (Item not found in this collection) '
    ' if table named by pTable does not exist in current database '
    Set tdf = db.TableDefs(pTable)
    'next line is not actually needed '
    blnReturn = False
    For Each fld In tdf.Fields
        If fld.Name = pField Then
            blnReturn = True
            Exit For
        End If
    Next fld
    Set fld = Nothing
    Set tdf = Nothing
    Set db = Nothing
    FieldExists = blnReturn
End Function 
```

# events - 如何使用 WebDAV 将事件复制到 Plone？

> ID：11141339
> 
> 赞同：1
> 
> 时间：2012-06-21T15:18:05.370
> 
> 标签：events, plone, webdav

有没有办法使用 WebDAV 将文件复制到 Plone 并让 Plone 将其注册为事件文件（而不是简单的页面）？

我非常想将 Plone 用于它的标准 CMS 属性（非常棒），但我不能花时间在 Plone 中编写应用程序 - 它太复杂了。“计划”是在另一个系统中生成信息并使用脚本将其导出到 Plone - 因此，如果这些生成的文件可以被识别为事件，则通过 WebDAV 复制将是一个完美的解决方案。如果不是替代方案，仍然使用 WebDAV，将生成和复制一个 python 脚本，该脚本使用 API 调用来创建事件。虽然我不确定在哪里复制以及要进行哪些 API 调用。或者有没有办法导入 iCal 文件？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T17:20:12.913

您可以自定义代码以完成任何目的——但默认情况下，开箱即用，您需要：

1.  上传带有文件扩展名的文本文件`.event`——您可以在 Plone 站点根目录的内容类型注册表工具中进行编辑。这告诉文件夹要创建什么类型的项目（事件）。

2.  在您通过 WebDAV 上传的文本文件中，使用 RFC822 样式的键值格式（如邮件标头或 HTTP 标头已格式化）格式化您的文本文件。您必须对所有日期/时间字段值使用 IS0 8601 格式 (YYYY-MM-DDThh:ss:mmTZD) 时间戳。

3.  如果对最后一点的细节有疑问，请参阅 Products.Archetypes.Marshall.RFC822Marshaller 和 DateTime.DateTime (zope2) 中的源代码。

4.  如果您希望自定义正在使用的编组器，您可以编写自己的编组器，并使用猴子补丁 ATEvent 来使用它。如果您为此编写代码，这将允许您支持 vcs/ics 的上传/下载。这不是阻力最小的路径。YMMV，这是记录不足的，需要一些严肃的 Plone 开发经验。

# postgis - PostGIS st_centroid 但返回为 kml

> ID：11141343
> 
> 赞同：1
> 
> 时间：2012-06-21T15:18:23.533
> 
> 标签：postgis

SELECT st_centroid(the_geom), road."id" FROM "public".roads

我将如何处理质心但将其作为 kml 返回？基本上我想要线绳的中心和道路的名称。有没有办法将道路质心的纬度返回为 x & y

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T20:42:25.493

SELECT ST_AsKML(ST_Centroid(the_geom)),id FROM 道路

# google-apps-script - 在 Google Apps 脚本 GUI 中使用 ClientHandler 检测空值

> ID：11141344
> 
> 赞同：2
> 
> 时间：2012-06-21T15:18:25.687
> 
> 标签：google-apps-script

我正在使用 Google Apps 脚本编写 GUI。我有一个文本框，例如 txtLastName，我想添加一个客户端处理程序来检测空值。本质上，我想让它成为必填字段。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T15:58:30.643

我想有几种可能性，其中之一是使用长度验证器

```
var clientHandler = app.createClientHandler().validateLength(widget, min, max) 
```

并将其用于`setVisible`警告消息并最终禁用“提交按钮”...

[clientHandlers 上](https://developers.google.com/apps-script/class_clienthandler)的文档非常明确

这是一个简单形式的示例，用于检查`question 1`并显示警告消息：

```
function BuildForm() {
  var text= new Array();
  text =['question 1','question 2','question 3','question 4','question 5','question 6']; 
  var textBox = new Array();    
  var app=UiApp.createApplication().setTitle('Form');
  var panel = app.createVerticalPanel().setId('panel');
  var btn = app.createButton('process');
  var warning = app.createLabel('You forgot to fill in question 1').setVisible(false)
  for (nn=0;nn<text.length;++nn){
    var label = app.createLabel(text[nn]);
    textBox[nn] = app.createTextBox().setName(text[nn].replace(' ',''));
    panel.add(label).add(textBox[nn])
  }
    var cliH1 = app.createClientHandler().validateLength(textBox[0], 0, 1)
        .forTargets(btn).setEnabled(false)
        .forTargets(warning).setVisible(true)
    var cliH2 = app.createClientHandler()
        .forTargets(btn).setEnabled(true)
        .forTargets(warning).setVisible(false)

  var servH = app.createServerHandler('process').addCallbackElement(panel).validateLength(textBox[0], 1, 40)
  btn.addClickHandler(cliH1)
  textBox[0].addClickHandler(cliH2)
  btn.addClickHandler(servH)  
  panel.add(btn).add(warning)
  app.add(panel)
  var doc = SpreadsheetApp.getActive();
  doc.show(app)
}

function process(e){
  var app = UiApp.getActiveApplication()
      Browser.msgBox(e.parameter.question1+'  '+e.parameter.question2+'  '+e.parameter.question3+'  '+e.parameter.question4+'  '+e.parameter.question5+'  '+e.parameter.question6)
      app.close()
      return app
          } 
```

编辑：这是另一个使用另一个验证（validateMatches）并检查所有答案的版本

```
function BuildForm2() {
  var text= new Array();
  text =['question 1','question 2','question 3','question 4','question 5','question 6']; 
  var textBox = new Array();    
  var app=UiApp.createApplication().setTitle('Form');
  var panel = app.createVerticalPanel().setId('panel');
  var btn = app.createButton('process').setWidth('240');
  var warning = app.createLabel('You forgot to fill at least one question').setVisible(false)
  for (nn=0;nn<text.length;++nn){
    var label = app.createLabel(text[nn]);
    textBox[nn] = app.createTextBox().setName(text[nn].replace(/ /g,''));
    panel.add(label).add(textBox[nn])
  }
  var servH = app.createServerHandler('process').addCallbackElement(panel).validateLength(textBox[0], 1, 40).validateLength(textBox[1], 1, 40).validateLength(textBox[2], 1, 40)
      .validateLength(textBox[3], 1, 40).validateLength(textBox[4], 1, 40).validateLength(textBox[5], 1, 40);
  var cliH = app.createClientHandler().validateMatches(textBox[0],'').validateMatches(textBox[1],'').validateMatches(textBox[2],'').validateMatches(textBox[3],'')
      .validateMatches(textBox[4],'').validateMatches(textBox[5],'')
        .forTargets(warning).setVisible(true)
  btn.addClickHandler(servH).addClickHandler(cliH)  
  panel.add(btn).add(warning)
  app.add(panel)
  var doc = SpreadsheetApp.getActive();
  doc.show(app)
} 
```

# entity-framework - 提高 EF 查询性能

> ID：11141355
> 
> 赞同：0
> 
> 时间：2012-06-21T15:18:53.963
> 
> 标签：entity-framework

我目前在我的项目中有以下代码

```
 public List<PermissionValue> GetUnderlyingPermissionsForUser(string userName, int guiPermissionTypeId, int productTypeId)
    {
        using (CliVeEntities db = new CliVeEntities())
        {             
            var listUnderlyings = (from gui in db.GuiPermissionUnderlying
                                join bue in db.BranchUsersExternal on gui.BranchUsersId equals bue.BranchUsersID     
                                join bu in db.BranchUsers on bue.BranchUsersID equals bu.BranchUsersId
                                where bu.UserName == userName && gui.ViewTypeId == guiPermissionTypeId
                                && gui.UnderlyingId.HasValue
                                && !gui.SectorId.HasValue
                                && gui.ProductTypeId == null
                                && gui.ProductGroupId == null
                                select new PermissionValue { Id = gui.UnderlyingId.Value, Visible = gui.value}).ToList<PermissionValue>();

            var listUnderlyingsProductGroup = (from gui in db.GuiPermissionUnderlying
                                                join bue in db.BranchUsersExternal on gui.BranchUsersId equals bue.BranchUsersID
                                               join bu in db.BranchUsers on bue.BranchUsersID equals bu.BranchUsersId
                                               join pg in db.ProductGroup on gui.ProductGroupId equals pg.ProductGroupId
                                               join pt in db.ProductType on pg.ProductGroupId equals pt.ProductGroupId
                                               where bu.UserName == userName && gui.ViewTypeId == guiPermissionTypeId
                                               && gui.UnderlyingId.HasValue
                                               && !gui.SectorId.HasValue
                                               && pt.ProductTypeId == productTypeId
                                               select new PermissionValue { Id = gui.UnderlyingId.Value, Visible = gui.value }).ToList<PermissionValue>();

            var listUnderlyingsProductType = (from gui in db.GuiPermissionUnderlying
                                                join bue in db.BranchUsersExternal on gui.BranchUsersId equals bue.BranchUsersID
                                              join bu in db.BranchUsers on bue.BranchUsersID equals bu.BranchUsersId
                                              where bu.UserName == userName && gui.ViewTypeId == guiPermissionTypeId
                                              && gui.UnderlyingId.HasValue
                                              && !gui.SectorId.HasValue
                                              && gui.ProductTypeId == productTypeId
                                              select new PermissionValue { Id = gui.UnderlyingId.Value, Visible = gui.value }).ToList<PermissionValue>();

            var listUnderlyingsForSectors = (from gui in db.GuiPermissionUnderlying
                                             join bue in db.BranchUsersExternal on gui.BranchUsersId equals bue.BranchUsersID
                                             join bu in db.BranchUsers on bue.BranchUsersID equals bu.BranchUsersId
                                             join u in db.Underlying on gui.SectorId equals u.SectorId
                                             where bu.UserName == userName && gui.ViewTypeId == guiPermissionTypeId
                                             && !gui.UnderlyingId.HasValue
                                             && gui.ProductTypeId == null
                                             && gui.ProductGroupId == null
                                             select new PermissionValue { Id = u.UnderlyingId, Visible = gui.value }).ToList<PermissionValue>();

            var listUnderlyingsForSectorsProductGroup = (from gui in db.GuiPermissionUnderlying
                                                        join bue in db.BranchUsersExternal on gui.BranchUsersId equals bue.BranchUsersID
                                                         join bu in db.BranchUsers on bue.BranchUsersID equals bu.BranchUsersId
                                                         join u in db.Underlying on gui.SectorId equals u.SectorId
                                                         join pg in db.ProductGroup on gui.ProductGroupId equals pg.ProductGroupId
                                                         join pt in db.ProductType on pg.ProductGroupId equals pt.ProductGroupId
                                                         where bu.UserName == userName && gui.ViewTypeId == guiPermissionTypeId
                                                         && !gui.UnderlyingId.HasValue
                                                         && pt.ProductTypeId == productTypeId
                                                         select new PermissionValue { Id = u.UnderlyingId, Visible = gui.value }).ToList<PermissionValue>();

            var listUnderlyingsForSectorsProductType = (
                                                        from gui in db.GuiPermissionUnderlying
                                                        join bue in db.BranchUsersExternal on gui.BranchUsersId equals bue.BranchUsersID
                                                        join bu in db.BranchUsers on bue.BranchUsersID equals bu.BranchUsersId
                                                        where bu.UserName == userName && gui.ViewTypeId == guiPermissionTypeId
                                                        && !gui.UnderlyingId.HasValue
                                                        && gui.SectorId.HasValue
                                                        && gui.ProductTypeId == productTypeId
                                                        select new PermissionValue { Id = gui.UnderlyingId.Value, Visible = gui.value }).ToList<PermissionValue>();

            var mergeList1 = MergeAndDistinctList(listUnderlyings, listUnderlyingsProductType);
            var mergeList2 = MergeAndDistinctList(mergeList1, listUnderlyingsProductGroup);
            var mergeList3 = MergeAndDistinctList(mergeList2, listUnderlyingsForSectors);
            var mergeList4 = MergeAndDistinctList(mergeList3, listUnderlyingsForSectorsProductType);
            var resultMergeList = MergeAndDistinctList(mergeList4, listUnderlyingsForSectorsProductGroup);

            return resultMergeList; 
```

这是我的 MergeAndDistinctList 函数的代码

```
 protected List<PermissionValue> MergeAndDistinctList(List<PermissionValue> listPrimary, List<PermissionValue> listSecondry)
    {
        List<PermissionValue> listMergedAndDistinct = new List<PermissionValue>();

        listMergedAndDistinct.AddRange(listPrimary);

        var filter = listPrimary.Select<PermissionValue, int>(p => p.Id);
        listMergedAndDistinct.AddRange(listSecondry.Where<PermissionValue>(p => !filter.Contains(p.Id)).Select(p => p));
        return listMergedAndDistinct;
    } 
```

我的 GetUnderlyingsForClient() 代码的问题是它多次访问数据库。如果此方法受到很多打击，那么这可能会转化为对数据库的多次调用。

有谁知道有什么方法可以使这段代码更高效并减少我必须进行的数据库调用量。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-24T18:46:31.927

您可以`Union`按照以下简化模式进行查询：

```
(from a in As where a.Id > 0 select a)
.Union(
from a in As where a.Name == "a" select a)
.Union(
...
)
.Select(a => new { a.x, a.y })
.Distinct() 
```

The`Union`是 MergeAndDistinctList 的合并部分，而`Distinct`ehh 是不同的部分。好消息是： Distinct 是在投影上执行的（在您的情况下是 Id 和 Visible ）。

现在一切都应该在一个（怪物）查询中执行，而不需要由`AddRange`MergeAndDistinctList 引起的中间强制执行。

看着您的查询，我觉得您可以通过结合一些条件来处理较少数量的查询，但这取决于您。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T15:39:53.173

似乎您在同一张表上进行了很多查询（在您的情况下是 a）

要限制数据库查询，您可以在本地列表中获取所需的所有数据，并将此列表用于您的多个查询，如下所示：

```
var MyBaseList = db.A.ToList();

var listUnderlyings = (from a MyBaseList [...]
var listUnderlyingsProductGroup = (from a MyBaseList [...] 
```

为了限制数据检索，过滤 MyBaseList 以仅获取以下查询使用的行。

# jquery - 横幅动画

> ID：11141359
> 
> 赞同：0
> 
> 时间：2012-06-21T15:19:10.873
> 
> 标签：jquery, css-animations

请查看此 IBM 站点 - [http://www.ibm.com/us/en/](http://www.ibm.com/us/en/)

如果您看到网站横幅，则每个横幅中都内置了一个动画，其中文本和图像以不同的速度滑出，并提供了非常好的效果。这不是使用 Flash，可能使用的是 CSS 动画。

我想用我的网站达到类似的效果，需要一些指导。如果您熟悉这方面的一些文档或片段，那将非常有帮助。

如果可能的话，我会尝试使用 jQuery 来实现这一点

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T19:27:49.713

我用它来创建我需要的动画[sequencejs.com/themes/sliding-horizo ​​ntal-parallax](http://sequencejs.com/themes/sliding-horizontal-parallax)

# windows - 窗口化 npapi-plugin 示例

> ID：11141368
> 
> 赞同：0
> 
> 时间：2012-06-21T15:19:34.300
> 
> 标签：windows, plugins, npapi, windowed

在哪里可以找到窗口化 npapi-plugin 的示例或详细文档（适用于 Windows）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T19:22:16.907

[Seamonkey 源](http://mxr.mozilla.org/seamonkey/source/modules/plugin/samples/npruntime/)代码中有一些较旧的代码可以进行简单的绘图。
Mozilla 的[测试插件](http://mxr.mozilla.org/mozilla-central/source/dom/plugins/test/testplugin/)不是那么直接，但绝对是最新的。

请记住，由于大多数浏览器在进程外运行插件以及更好地集成到它们的分层/绘图机制中，因此最好 使用[无窗口插件。](https://developer.mozilla.org/en/Gecko_Plugin_API_Reference/Plug-in_Basics#Windowed%20and%20Windowless%20Plug-ins)

另外，看看[FireBreath](http://www.firebreath.org/)是否适合您的项目 - 它是一个插件框架，已经为您完成了大部分工作。

# eclipse - 比较 Eclipse 的 CVS 插件中的两个不同标签

> ID：11141369
> 
> 赞同：0
> 
> 时间：2012-06-21T15:19:37.340
> 
> 标签：eclipse, cvs

让 Eclipse 将源树的当前本地状态与某些特定标记进行比较非常容易，但我找不到使用 Eclipse 的差异功能来比较两个不同标记的选项。

假设我有标签 TAG1 和 TAG2，而 TAG2 是最新的。我只能将我当前的状态与 TAG1 或 TAG2 进行比较，而不能将 TAG1 与 TAG2 进行比较。

是否有可能在 Eclipse 中实现这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T15:33:46.547

您必须从 CVS 存储库视图中的相关版本节点中选择两个标签，然后使用上下文菜单启动比较。

# html - 在字段集中定位复选框的标签

> ID：11141374
> 
> 赞同：0
> 
> 时间：2012-06-21T15:19:44.243
> 
> 标签：html, css, forms, checkbox, fieldset

我有一个注册表单，用于`fieldset`将`input`字段排序为两行。

现在我需要在它们下面添加一个复选框。当然，我可以`div`使用`fieldset`.

[这是一个示例小提琴。](http://jsfiddle.net/7hMCN/)

我需要在最后一个列表项（带有 class 的那个`fd`）下添加一个复选框，**除此之外**，它的标签。

最后，它应该如下所示：

```
 label 1                         label 2
    _______________                 _______________ 
   (_______________)               (_______________)

    label 3                        label 4
    _______________                 _______________ 
   (_______________)               (_______________)

   (_) label 5 
```

此时我有以下代码：

```
...
<li class="fd">
<label class ="tandc">label 5</label>
  <input class="tac"type="checkbox" id="tandc" name="tandc" tabindex="30" autocomplete="off" />
</li>

</ul>
</fieldset>
</form> 
```

至于CSS：

```
.tc  {
    float: right;
}
.tac {
    width: 20px;
    margin-bottom: 20px;
}

.tandc {
    font-family: Arial, Helvetica, sans-serif;
    font-size: 12px;
    font-weight: bolder;
    color: #ECECEC;
    text-decoration: none;
    width: 450px;
    float:right;
    margin-right: 25px;
    padding-top: 3px;

} 
```

我的问题是我只能在复选框上方而不是旁边获得标签。谁能告诉我如何将标签放在复选框旁边？可以更改我的 HTML，但请避免使用表格。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T15:54:13.957

不确定使用 .tc 类设置了哪些元素的样式，但我只是将标签移到了复选框之后，并删除了`float:right`你的类`.tandc`，看起来就像你要解释的那样。

可能这就是你要找的东西？

**编辑**

**更新的 CSS**

```
.tandc {
font-family: Arial, Helvetica, sans-serif;
font-size: 12px;
font-weight: bolder;
color: #ECECEC;
text-decoration: none;
width: 450px;
height: 30px;
display:inline-block;
} 
```

**html**

```
....
<li class="fd">
<input class="tac"type="checkbox" id="tandc" name="tandc" tabindex="30" autocomplete="off" />
<label class ="tandc">label 5</label>
</li>
</ul>
</fieldset>
</form> 
```

由于您有此`<li>`元素的特定类和 id，因此您应该能够根据需要独立定位它。

**编辑**

在看到完整的 css 后，我注意到您已指定每个输入字段都显示为块。这意味着没有其他元素可以与输入字段位于同一行，例如 div 元素（您的复选框是这些输入字段之一）。您需要做的是指定这个特定的输入框可以包含其他元素。您可以添加到类 .tandc 或 id #tandc `display:inline-block`。

# django - django - 我可以添加一个方法来在模型上调用“get”或“filter”时总是被调用吗？

> ID：11141378
> 
> 赞同：0
> 
> 时间：2012-06-21T15:20:03.907
> 
> 标签：django

如果不创建自己的模板方法，就不可能在模板中调用模型的方法。因此，要显示评论的赞成票数：

```
comment.rating_set.filter(vote=1).count() 
```

每个评论在发送到模板之前，都会添加一个 rating_set 成员，如下所示：

```
comment.rating_set = comment.rating_set.filter(vote=1).count() 
```

很简单，但是有几种方法可以检索评论（即，根据情况，有几种方法用于获取评论）。模板经常被使用。

对于每种方法，都可以更改它，而不是：

```
return commentList 
```

它读到

```
return addInVotes(commentList) 
```

where`addInVotes`只是一个简单的函数，它遍历列表中的每条评论，然后运行上面的代码来添加 rating_count 值。

那么这里的问题是——不是在所有方法中添加它，是否可以将代码“附加”到model.get和model.filter？我知道我可以为评论扩展模型以具有新定义的过滤器并获取，但是还有其他方法吗？dJango 似乎会隐藏在某个地方。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T22:19:24.230

看一下[Manager](https://docs.djangoproject.com/en/dev/topics/db/managers/)对象。您可以使用其他方法创建默认管理器的子类，这些方法可以在一个地方而不是在每个视图中进行通用过滤。

# algorithm - 课程安排

> ID：11141379
> 
> 赞同：1
> 
> 时间：2012-06-21T15:20:07.020
> 
> 标签：algorithm, search

问题是这样的：

一所学校有不同的班级。每节课都有每周安排（8 小时英语、6 小时数学、2 小时美术等）。每位教师在一部分课程中都有一定的小时数。（我猜学校几乎到处都是这样）。

可以添加一些额外的约束，例如：

1.  X老师星期一不上班
2.  Y老师在某个班级需要连续两个小时，以此类推。

目标是找到一个优化约束成本函数的时间表。

最后，我猜这是一个经典的 NP 问题。它可以使用空间状态搜索来解决（我们尝试所有可能的组合，使用一些智能的搜索方式，我们选择可能的最佳解决方案）。

*   这可行吗？（组合是巨大的，对于 10 节课和每节课 30 小时和 7 门科目来说，即使可以进行一些实质性的修剪，它也大约是 10^253：我猜 SAT 求解器可以处理类似的事情）。

*   是否有任何替代方法可以完成搜索，即使是近似的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T15:55:04.217

这是一个[约束满足问题](http://en.wikipedia.org/wiki/Constraint_satisfaction_problem)。如链接中所述，解决这些问题的方法之一是使用本地搜索方法，例如[min-conflicts](http://en.wikipedia.org/wiki/Min-conflicts_algorithm)或[forward checks](http://en.wikipedia.org/wiki/Forward_checking#Look_ahead_techniques)。不能保证您获得最佳解决方案，但您通常会在相对较短的时间内获得“好的”解决方案。

如果您碰巧在使用 Prolog，那么 clpfd 库（有限域上的约束逻辑编程）非常强大。

# vim - MacVim/YADR 自动完成问题

> ID：11141380
> 
> 赞同：0
> 
> 时间：2012-06-21T15:20:09.003
> 
> 标签：vim, autocomplete, zsh, macvim

我已经安装了 MacVim 和[https://github.com/skwp/dotfiles](https://github.com/skwp/dotfiles)（包括所有依赖项，例如 zsh 等）。而且我无法自动完成工作。

当我打字时

`<tit``<title>Index</title>`根据[https://github.com/skwp/dotfiles](https://github.com/skwp/dotfiles)文档显示一个粉红色的框，按下`tab`将使其自动完成。有时可行，有时它只是增加了两个空格，但这不是我的问题。

当它自动完成时，它会变成

`<<title>Index</title>>`注意这两个`<`和`>`

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T16:19:41.083

哇... 79 个插件？真的吗？

在低层次上，您的问题是您赋予其他人过多的权力来控制*您的**配置*、工具集和*工作*流程。

在更高的层次上，您可能误用了配置的自动完成功能。我*认为*`neocomplcache`您在,`delimitmate`和插件之间存在冲突`snipmate`：第一个处理自动完成，第二个自动关闭字符对（`<>`, `""`, `()`...），而第三个对`tit`关键字进行“制表符扩展”。

基本上，我相信你应该输入`tit<Tab>`而不是`<tit<Tab>`避免触发`delimitmate`.

# java - 春季计划任务未在 Windows 7 上执行

> ID：11141381
> 
> 赞同：4
> 
> 时间：2012-06-21T15:20:10.363
> 
> 标签：java, spring, scheduled-tasks

我对计划任务有一个奇怪的行为。我有以下设置

```
<task:scheduled-tasks>
      <task:scheduled ref="servicioEjecucionReportes" method="ejecutar" cron="0 0 * * * *" />
      <task:scheduled ref="servicioEjecucionReportes" method="ejecutarReintentos" cron="0 30 * * * *" />
      <task:scheduled ref="servicioEjecucionReportes" method="enviarReporteDiario" cron="0 15 0 * * *" />
</task:scheduled-tasks> 
```

执行器是这样配置的：

```
<task:annotation-driven executor="asyncExecutor" scheduler="taskScheduler" />
<task:executor id="asyncExecutor" rejection-policy="CALLER_RUNS" pool-size="16" />
<task:scheduler id="taskScheduler" pool-size="8" /> 
```

问题是，我们正在使用 linux 和 mac os 进行开发，并且这三个任务都可以正确执行，但是在 Windows 7 Server 的部署服务器上，前两个可以正确执行，而第三个则不能。

我需要在每天 00:15 执行第三个任务。

我尝试过更改配置，但行为始终相同，在开发和测试环境中一切正常，但在生产环境中却不行。

我有点迷失在哪里看或这有什么问题。

bean 是这样声明的：

```
<bean id="servicioEjecucionReportes" class="com.mycompany.beans.ServicioEjecucionReportesImpl" /> 
```

界面是：

```
public interface ServicioEjecucionReportes {

   public void ejecutar();

   public void ejecutarReintentos();

   public void enviarReporteDiario();
} 
```

编辑：额外信息，在服务器日志上，我们甚至看不到尝试运行的任务，春季版本是 3.1.0。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T15:05:24.983

Windows 中计划的异步方法似乎存在问题。这与 JVM 如何在 Windows 上创建线程有关

尝试删除 @Async 并检查它是否有效

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T15:34:53.497

推测：您的任何任务是否有机会在生产环境中*运行很长时间*`ejecutar`-或`ejecutarReintentos`. 我想知道的是您的 asyncExecutor 线程池可能已耗尽，这会触发您的调度程序上的 Caller_RUNS，并且可能根本没有更多的调度程序池可用？

# python - 有没有办法在python字典中保留重复键

> ID：11141383
> 
> 赞同：2
> 
> 时间：2012-06-21T15:20:12.190
> 
> 标签：python

有没有办法在字典中存储重复的键？

我有一个特定的要求来形成一对请求和响应。

从特定节点到另一个特定节点的请求形成相同的密钥。我需要存储这两个。

但是，如果我尝试将它们添加到字典中，则第一个将被第二个替换。有什么办法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-21T15:29:55.767

假设您想继续使用字典，我可以想到两个简单的选项。

1.  您可以将键映射到项目列表。`defaultdict`来自模块的 A`collections`使这很容易。

    ```
    >>> import collections
    >>> data = collections.defaultdict(list)
    >>> for k, v in (('a', 'b'), ('a', 'c'), ('b', 'c')):
    ...     data[k].append(v)
    ... 
    >>> data
    defaultdict(<type 'list'>, {'a': ['b', 'c'], 'b': ['c']}) 
    ```

2.  您可以使用其他数据来消除键的歧义。这可以是时间戳、唯一 ID 号或其他内容。这具有保留键和值之间的一对一关系的优点，以及使查找更复杂的缺点，因为您总是必须指定一个`id`. 下面的例子展示了它是如何工作的；是否对您有好处取决于问题域：

    ```
    >>> for k, v in (('a', 'b'), ('a', 'c'), ('b', 'c')):
    ...     i = 0
    ...     while (k, i) in data:
    ...         i += 1
    ...     data[(k, i)] = v
    ... 
    >>> data
    {('a', 1): 'c', ('b', 0): 'c', ('a', 0): 'b'} 
    ```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-06-21T15:24:14.010

虽然我不是 100% 确定，但我很确定答案是否定的。这种违反了python中字典的目的。您如何将值更改为列表而不是

```
{Key:value} 
```

你有

```
{Key:[Value1,value2]} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-06-21T15:28:11.433

`defaultdict`可能的替代方案是

```
d = {}
d.setdefault(newkey, []).append(newvalue) 
```

这也是一样的：追加`newvalue`到一个列表，该列表要么已经在给定的字典中`newkey`，否则将被放在那里。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-06-21T15:22:59.253

没有办法做到这一点，不。字典依赖于唯一的键 - 否则，当您请求或设置键时，将返回或覆盖什么值？

但是，您可以做的是将列表存储为字典的值，然后将您的值添加到该列表中，而不是替换现有值。

您可能希望使用 a[`collections.defaultdict`](http://docs.python.org/library/collections.html#collections.defaultdict)来执行此操作，以避免每次引入新密钥时手动制作列表。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-06-21T15:24:33.543

使用列表存储相等键的所有值：

```
{a:b, a:c}  # foolish, won't work
{a: [ b, c ]}  # works like a charm! 
```

您可能还想使用

```
from collections import defaultdict
d = defaultdict(list)
d[a].append(b) 
```

以一种简单的方式填写您的字典。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-21T16:52:56.383

我喜欢使用`collections.defaultdict`. 这就是我可能会走的路。

但这假设一个 dict 或类似 dict 的结构和一对多映射是正确的解决方案。重新阅读这个问题，“形成请求和响应对”的要求可能会导致更简单的元组列表（或列表列表）方法。例如：

```
pairs = []
pairs.append( (request, response) ) 
```

这可能会创建一个列表，例如：

```
[ ('GET /', 200), ('GET /index.html', 200), ('GET /x', 403), ('GET /', 200), ] 
```

它只是结构简单，但取决于你想用它做什么，可能没问题。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-11-17T10:31:54.993

更优雅的解决方案：

```
def add_to_dict(towhat, key, value):
    info = towhat.get(key, [])
    info.append(value)
    towhat[key] = info

alternate = {}

add_to_dict(alternate,"Andrew","Cambridge")
add_to_dict(alternate,"Barbara","Bloomsbury")
add_to_dict(alternate,"Andrew","Corsica")

print alternate 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-06-21T15:26:54.013

根据定义，字典要求键是唯一标识符。您可以：

1.  使用不同的数据结构，例如允许重复条目的列表或元组。
2.  为您的字典键使用唯一标识符，这与数据库可能使用自动递增字段作为其键 id 的方式非常相似。

如果您要存储大量请求/响应对，则无论如何最好使用数据库。这当然是要考虑的事情。

# c# - 如何使用 SMO 备份 SQL Server 2012 数据库

> ID：11141385
> 
> 赞同：1
> 
> 时间：2012-06-21T15:20:25.553
> 
> 标签：c#, sql, smo, sql-server-2012

我有一些代码使用 SQL Server 2005 SMO 对象来备份和恢复 SQL Server 数据库，这工作正常，但我的任务是更新代码以使用 SQL Server 2012 数据库。

我知道我需要使用最新的 SQL Server 2012 SDK 来执行此操作，备份和还原方法不再存在。

这些方法是否已被弃用，我是否应该只编写 SQL 脚本来做同样的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T15:49:22.460

据我所知，他们还在那里。你确定你有正确的下载？他们还对 dll 中的内容和命名空间进行了处理。

我们刚刚摆脱了 DMO，而只是发出备份和恢复命令。不得不写更多的代码，但不是那么多。我们使用 DMO 的唯一目的是为进度条提供反馈，只是将其换成动画。PS你试过你的SMO代码吗？具有向后兼容包的 DMO 仍然适用于 2012，尽管它并不意味着。

# sql-server - SQL 十进制字段转换为二进制

> ID：11141386
> 
> 赞同：0
> 
> 时间：2012-06-21T15:20:27.823
> 
> 标签：sql-server, decimal

我有一个问题：在 SQL Server 中有一种`decimal`数据类型。

我可以将此数据类型转换为二进制，因此我可以将查询编写为

```
declare @deci decimal(18,2)
set @deci = 2.33
print cast(@deci as varbinary) 
```

这个查询的结果是——

```
0x12020001E9000000 
```

我的问题是这种从十进制到二进制的转换的转换规则是什么……有人可以向我解释吗？

# python - 给定一个 python .pyc 文件，是否有一个工具可以让我查看字节码？

> ID：11141387
> 
> 赞同：13
> 
> 时间：2012-06-21T15:20:28.210
> 
> 标签：python, bytecode, pyc

Python 模块由 CPython 解释器自动编译成 .pyc 文件。包含字节码的 .pyc 文件是二进制格式（编组代码？）。是否有可以让我查看字节码的 GUI（或命令行）工具？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2017-03-10T14:17:53.957

每个 *.pyc 文件都是一个包含以下内容的二进制文件：

*   一个四字节的幻数 - 它只是随着编组代码的每次更改而更改的字节；
*   一个四字节的修改时间戳 - 是生成 .pyc 的源文件的 Unix 修改时间戳，以便在源更改时可以重新编译；
*   由于 Python3.3+ 版本接下来的四个字节是将源文件的大小编码为 long 的字段；
*   编组的代码对象。

为什么不直接使用 CPython 的内置功能来完成这项任务呢？

* * *

一份文件`view_pyc_file.py`

```
import platform
import time
import sys
import binascii
import marshal
import dis
import struct

def view_pyc_file(path):
    """Read and display a content of the Python`s bytecode in a pyc-file."""

    file = open(path, 'rb')

    magic = file.read(4)
    timestamp = file.read(4)
    size = None

    if sys.version_info.major == 3 and sys.version_info.minor >= 3:
        size = file.read(4)
        size = struct.unpack('I', size)[0]

    code = marshal.load(file)

    magic = binascii.hexlify(magic).decode('utf-8')
    timestamp = time.asctime(time.localtime(struct.unpack('I', b'D\xa5\xc2X')[0]))

    dis.disassemble(code)

    print('-' * 80)
    print(
        'Python version: {}\nMagic code: {}\nTimestamp: {}\nSize: {}'
        .format(platform.python_version(), magic, timestamp, size)
    )

    file.close()

if __name__ == '__main__':
    view_pyc_file(sys.argv[1]) 
```

**用下一个 CPython 的版本测试：**

*   2.7.9
*   3.4.2
*   3.5.2

* * *

## 示范

文件内容`main.py`

```
$ cat main.py
print("Never give up") 
```

python2.7创建和读取pyc文件

```
setivolkylany$~/Downloads/temp/temp$ python2.7 -m py_compile main.py 
setivolkylany$~/Downloads/temp/temp$ python2.7 view_pyc_file.py ./main.pyc
  1           0 LOAD_CONST               0 ('Never give up')
              3 PRINT_ITEM          
              4 PRINT_NEWLINE       
              5 LOAD_CONST               1 (None)
              8 RETURN_VALUE        
--------------------------------------------------------------------------------
Python version: 2.7.9
Magic code: 03f30d0a
Timestamp: Fri Mar 10 15:08:20 2017
Size: None 
```

通过python3.4创建和读取pyc文件

```
setivolkylany$~/Downloads/temp/temp$ python3.4 -m py_compile main.py 
setivolkylany$~/Downloads/temp/temp$ python3.4 view_pyc_file.py __pycache__/main.cpython-34.pyc 
  1           0 LOAD_NAME                0 (print)
              3 LOAD_CONST               0 ('Never give up')
              6 CALL_FUNCTION            1 (1 positional, 0 keyword pair)
              9 POP_TOP
             10 LOAD_CONST               1 (None)
             13 RETURN_VALUE
--------------------------------------------------------------------------------
Python version: 3.4.2
Magic code: ee0c0d0a
Timestamp: Fri Mar 10 15:08:20 2017
Size: 23 
```

python3.5创建和读取pyc文件

```
setivolkylany$~/Downloads/temp/temp$ python3.5 -m py_compile main.py 
setivolkylany$~/Downloads/temp/temp$ python3.5 view_pyc_file.py __pycache__/main.cpython-35.pyc 
  1           0 LOAD_NAME                0 (print)
              3 LOAD_CONST               0 ('Never give up')
              6 CALL_FUNCTION            1 (1 positional, 0 keyword pair)
              9 POP_TOP
             10 LOAD_CONST               1 (None)
             13 RETURN_VALUE
--------------------------------------------------------------------------------
Python version: 3.5.2
Magic code: 160d0d0a
Timestamp: Fri Mar 10 15:08:20 2017
Size: 23 
```

* * *

**基于：**

*   [我如何理解 .pyc 文件内容](https://stackoverflow.com/questions/32562163/how-can-i-understand-a-pyc-file-content)
*   [https://gist.github.com/anonymous/35c08092a6eb70cdd723](https://gist.github.com/anonymous/35c08092a6eb70cdd723)
*   [https://nedbatchelder.com/blog/200804/the_structure_of_pyc_files.html](https://nedbatchelder.com/blog/200804/the_structure_of_pyc_files.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T15:49:30.167

[有一个名为PyChrisanthemum](http://code.google.com/p/pychrysanthemum/)的可视化 python 反汇编程序。

`dis`要做到这一点，您可以使用模块（[python 2.7.3](http://docs.python.org/library/dis.html)，[python 3.2.3](http://docs.python.org/py3k/library/dis.html?highlight=dis#dis) ）的命令行方式，正如 OP 已经发现的那样。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2021-05-07T03:29:21.140

根据 @Apteryx 关于 PEP 的注释扩展代码形式 @PADYMKO：

```
def view_pyc_file(path):
    """Read and display a content of the Python`s bytecode in a pyc-file."""

    file = open(path, 'rb')

    magic = file.read(4)
    bit_field = None
    timestamp = None
    hashstr = None
    size = None

    if sys.version_info.major == 3 and sys.version_info.minor >=7:
        bit_field = int.from_bytes(file.read(4), byteorder=sys.byteorder)
        if 1 & bit_field == 1:
            hashstr = file.read(8)
        else:
            timestamp = file.read(4)
            size = file.read(4)
            size = struct.unpack('I', size)[0]
    elif sys.version_info.major == 3 and sys.version_info.minor >= 3:
        timestamp = file.read(4)
        size = file.read(4)
        size = struct.unpack('I', size)[0]
    else:
        timestamp = file.read(4)

    code = marshal.load(file)

    magic = binascii.hexlify(magic).decode('utf-8')
    timestamp = time.asctime(time.localtime(struct.unpack('I', b'D\xa5\xc2X')[0]))

    dis.disassemble(code)

    print('-' * 80)
    print(
        'Python version: {}\nMagic code: {}\nTimestamp: {}\nSize: {}\nHash: {}\nBitfield: {}'
        .format(platform.python_version(), magic, timestamp, size, hashstr, bit_field)
    )

    file.close() 
```

# google-apps-script - createMenuBar 参数处理程序

> ID：11141390
> 
> 赞同：-2
> 
> 时间：2012-06-21T15:20:35.480
> 
> 标签：google-apps-script

哪些步骤将重现该问题？

1.  创建一个 MenuBar 对象 (createMenuBar)
2.  创建一个指向menuHandler函数的Server Handler（createServerHandler）
3.  向 MenuBar 对象添加一个项目，参数为：Name 和 Handler 对象；

什么是预期的输出？你看到了什么呢？在处理程序函数中，该参数应返回被单击的源对象的名称。现在我看到一个空值。

在哪个浏览器和操作系统上？铬 19.0.1084.56 m Windows 7 SP1 x64

请在下面提供任何附加信息。

```
function buildMenu() {
    var app = UiApp.createApplication();

    var myRootMenu = app.createMenuBar(false);
    var txtTest = app.createTextBox().setText("test").setId("txtTest");
    var myHandler = app.createServerHandler("menuHandler").addCallbackElement(txtTest);

    myRootMenu.addItem("File", myHandler );

    app.add(myRootMenu);

    return app;

}

function menuHandler(e) {
    Logger.log(e);
} 
```

* * *

日志输出为：{parameter=null}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T15:34:12.893

首先：这不是问题跟踪器，请将您认为[应该出现的问题发布在哪里](http://code.google.com/p/google-apps-script-issues/issues/list)

第二：如果您不向服务器处理程序添加任何 callBackElement ，则它不能返回任何值。请仔细阅读[文档](https://developers.google.com/apps-script/guide_user_interfaces?hl=fr-FR#ViewUIElements)。

编辑：按照您的评论：

CallBackElement 返回的值与其**名称**相关联，因此您的代码应如下所示：

```
app.createTextBox().setName('test').setText("test").setId("txtTest"); 
```

这是一个工作示例：

```
function buildMenu() {
    var app = UiApp.createApplication();
    var myRootMenu = app.createMenuBar(false);
    var txtTest = app.createTextBox().setText("Got it !").setName('test');
    var myHandler = app.createServerHandler("menuHandler").addCallbackElement(txtTest);
    myRootMenu.addItem("File", myHandler );
    app.add(myRootMenu);
  var doc = SpreadsheetApp.getActive();
  doc.show(app);
}
function menuHandler(e) {
    Logger.log(e);
} 
```

# c++ - 从 hash_map 内的列表中擦除元素

> ID：11141391
> 
> 赞同：1
> 
> 时间：2012-06-21T15:20:36.040
> 
> 标签：c++, list, iterator, hashmap

我使用以下结构：

```
hash_map<string, list<time_t>> 
```

当我最初用从文本文件中读取的信息填充哈希映射时，将元素插入到那些 time_t 列表中没有问题。

```
hash_t::iterator it = hash.find(origen);

if (it != hash.end())
{
    (*it).second.push_front(fecha);         
}
else
{ 
    list<time_t> lista(1, fecha);
    hash.insert(make_pair(origen, lista));          
} 
```

如您所见，如果键字符串不在表中，我将创建一个具有一个 time_t 值的列表，并将该对插入表中。在同一键的以下出现时，我只需将新的 time_t 元素推送到已经存在的列表中并且工作正常。

我现在想做相反的事情：删除这些列表的元素。

```
hash_t::iterator it = hash.find(origen);            

if (it != hash.end())
{
    list<time_t> lista = (*it).second;  
    list<time_t>::iterator it2 = lista.begin();
    bool found = false;

    while(it2 != lista.end() && !found)
    {
        time_t fecha2 = *it2;           
        if (abs((int) difftime(fecha, fecha2)) <= 2) 
        {
            found = true;   
            lista.erase(it2);
        }
        else ++it2;
    }
} 
```

此代码不会从这些列表中删除元素。

我想问题从这一行开始：

```
list<time_t> lista = (*it).second; 
```

变量 lista 是否具有我可以从 hash_map 或它的副本中获得的相同列表？如果它是副本，我不明白它不起作用的原因。但是，我仍然不明白为什么它确实可以插入元素。

```
(*it).second.push_front(fecha); 
```

有没有一种方法可以使用类似于我正在做的方法从列表中删除元素，或者我是否必须将 hash_map 的整个结构更改为类似

```
hash_map<string, list<time_t>*> 
```

非常感谢您提前

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T15:24:48.200

该`erase()`代码在列表的副本上运行，而不是在`hashmap`. 这将创建一个副本：

```
list<time_t> lista = (*it).second; 
```

请改用参考：

```
list<time_t>& lista = (*it).second; 
```

由于没有复制，因此`push_front()`运行正常，代码`hashmap`直接访问列表：

```
(*it).second.push_front(fecha); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T15:27:22.643

> 变量 lista 是否具有我可以从 hash_map 或它的副本中获得的相同列表？

是`lista`的，是副本，您正在执行任务。

> 但是，我仍然不明白为什么它确实可以插入元素。

使用此代码，您不使用副本，`(*it).second`而是直接使用引用。

# php - 在 PHP 中转义 Javascript

> ID：11141392
> 
> 赞同：0
> 
> 时间：2012-06-21T15:20:41.440
> 
> 标签：php, javascript

我正在寻找在 PHP 中转义一些 Javascript 文本的最佳方法，并且`json_encode`是错误的工作工具。

问题来自这一行：

```
`echo " onclick=\"SwitchDiv('" . $option . "')\"";` 
```

`如果 中有一个撇号`$option`，这是客户端失败的多汁球。但是做一个直线`json_encode`（在其他情况下效果很好）并没有帮助： ````
echo " onclick=\"SwitchDiv(" . json_encode($option) . ")\"";

```` 这会创建一个输出字符串`onclick="SwitchDiv("athlete's foot")"`，导致`onclick`值过早终止。`onclick`（如果我将值括在单引号中，也会发生这种情况。）

有没有一种优雅的方式来解决这个问题？我是否应该`json_encode`通过正则表达式将输出汇集到将转义单引号的正则表达式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T15:27:25.857

`json_encode`是工作的正确工具。您的问题源于您还在*HTML 属性*中包含该 Javascript ，因此它也需要进行`htmlspecialchars`编码。

```
echo " onclick=\"SwitchDiv(" . htmlspecialchars(json_encode($option)) . ")\""; 
````

# c# - 如何在 C# 或 VB.NET 中格式化变量？

> ID：11141396
> 
> 赞同：3
> 
> 时间：2012-06-21T15:21:03.047
> 
> 标签：c#, vb.net, string, formatting, hex

> **可能重复：**
> [如何在 C# 中转换十六进制和十进制之间的数字？](https://stackoverflow.com/questions/74148/how-to-convert-numbers-between-hexadecimal-and-decimal-in-c)

在 C 中，您可以执行类似的操作

```
int x = 255;
printf("x is: %d and in HEX, x is: %x", x, x); 
```

如何在[C#](http://en.wikipedia.org/wiki/C_Sharp_%28programming_language%29)或[VB.NET](http://en.wikipedia.org/wiki/Visual_Basic_.NET)中做到这一点？打印变量的十六进制等效项？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T15:24:10.687

```
int x = 255;
Console.WriteLine("x is: {0} and in HEX, x is: {0:X}", x); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T15:25:10.373

像这样

```
Console.WriteLine("x is: {0} and in HEX, x is: {0:X}", x); 
```

如果您只需要字符串

```
string formatted = String.Format("x is: {0} and in HEX, x is: {0:X}", x); 
```

这称为[复合格式](http://msdn.microsoft.com/en-us/library/txafckwd.aspx)。`{n}`充当后面参数的占位符，其中`n`是参数的从零开始的数字。`:`您可以在占位符之后指定可选格式。

您可以通过指定格式将 int 转换为字符串

```
string hex = x.ToString("X"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-21T15:23:56.087

您可以使用`String.Format("{0:X}", number)` 十六进制格式。

```
Console.Write(String.Format("x is: {0} and in HEX, x is : {0:X}", x)); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-21T15:24:31.390

```
 int x = 500;
 Console.WriteLine("x is: {0} and in HEX, x is: {1:X}", x, x); 
```

会输出

> x 是：500，在十六进制中，x 是：1F4

来源：http: [//msdn.microsoft.com/en-us/library/bb311038.aspx](http://msdn.microsoft.com/en-us/library/bb311038.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-21T15:24:14.070

printf 等价物是[`String.Format`](http://msdn.microsoft.com/en-us/library/system.string.format.aspx)：

```
String.Format("{0:x}", 0xBEEF); 
```

或仅使用以下[`int.ToString`](http://msdn.microsoft.com/en-us/library/8wch342y)方法：

```
int MyInt = 0xBEEF;
MyInt.ToString("x"); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-21T15:24:40.897

您使用[String.Format](http://msdn.microsoft.com/en-us/library/system.string.format.aspx)

`string.Format("x is: {0} and in HEX, x is: {1:X}", x, x);`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-21T15:26:37.860

利用[`ToString("X")`](http://msdn.microsoft.com/en-us/library/29dxe1x2%28v=vs.110%29.aspx)

```
Console.WriteLine("{0} hex equivalent =  {1}", 456, 456.ToString("X")); 
```

[转换为十六进制，然后转换回来](http://www.geekpedia.com/KB8_How-do-I-convert-from-decimal-to-hex-and-hex-to-decimal.html)

# mysql - 如何为订单号生成随机值，仅当该订单号在数据库中出现多次时

> ID：11141398
> 
> 赞同：0
> 
> 时间：2012-06-21T15:21:09.807
> 
> 标签：mysql, amazon-mws

我一直在研究保存订单号和订单信息的数据库。以前，我使用的报告为每个订购的商品提供了订单 ID 和唯一的商品 ID。项目 ID 是主键，因为它是唯一分配的值。

这意味着一个订单# 中可能有多个项目，每个项目由一个唯一的项目 ID 标识。

现在我们的要求已更改为更加实时，这意味着提供唯一项目 ID 的报告尚未运行。因此，我需要生成我自己的唯一项目 ID，但只能在同一个订单内 #。

对于使用亚马逊 MWS 的用户的其他信息：

以前我使用报告 API 生成 _GET_AMAZON_FULFILLED_SHIPMENTS_DATA_ 来提供我们的履行数据，而第 3 方集成公司提取 _GET_FLAT_FILE_ORDER_REPORT_DATA_ 报告来处理我们的商家履行的订单。我们现在希望使用 Orders API 让我们的商家实时完成订单，遗憾的是它不提供 _GET_FLAT_FILE_ORDER_REPORT_DATA_ 文件提供的 orderItemId。我需要解决的问题与缺少该字段有关。

一些要使用的示例数据是：

```
Order-ID        Item-ID        Item
222-2212            1         redShirt
222-2216            1         redShirt
222-2212            2         blueShirt
222-2212            3         greenShirt
222-2218            1         noShirt 
```

我希望能够做到：

```
SELECT * from order_data WHERE Order-ID like '222-2212'; 
```

并退回所有 3 件物品。我遇到的问题是我不知道如何根据 Order-ID 的计数提供一个唯一的自动递增数字。我还想避免在所有数据中使用标准的自动递增值，因为我最终可能会得到重复的订单，并且需要尝试使用 DISTINCT 进行过滤。

有没有人对我如何做到这一点有任何想法、指示或建议？我确实有幸从头开始重新设计整个数据库，所以我愿意接受建议。

- 编辑 -

我目前正在跟进亚马逊，以确定订单 API 返回的 orderItemId 是否是随机生成的。当我发现时，我会在这里发布更多细节。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T20:59:58.447

原来 orderItemId 实际上是一个唯一值。我能够在亚马逊网站上使用 Feed 确认多个货件下找到文档。声明指出：

order-item-id Amazon.com 订单中商品的唯一标识号。此编号在您的订单报告中提供。注意：这与产品 ASIN 不同。order-item-id 将因订单而异。

我将使用它作为我的主键，所以我不需要像今天早上预期的那样生成随机值。

# android - 如何克隆/复制现有的 Android AVD？

> ID：11141400
> 
> 赞同：3
> 
> 时间：2012-06-21T15:21:11.847
> 
> 标签：android, android-emulator

我需要克隆/复制现有的 Android 虚拟设备。可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T15:32:00.500

很简单，在 AVD Manager 中编辑要克隆的 AVD。更改名称，“创建 AVD”中的“编辑 AVD”按钮神奇地改变了！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-12-29T07:41:59.023

编辑 AVD 不会克隆，而是创建一个新的 AVD，而不会将数据安装在原始设备上。

我找到了另一种方法：

1.  转到`~/.android/avd`并复制`avd`要克隆的 AVD 文件夹
2.  同时复制此 AVD 的 .ini 文件，打开 .ini 文件并将所有路径更改为您创建的新文件夹
3.  转到新文件夹；打开 .ini 文件并更改其路径

它现在应该可以工作了；当您重新打开 Android Studio 时，会克隆新的 AVD。

# ruby-on-rails - Heroku Sans 上的“没有配置 Heroku 应用程序错误”

> ID：11141401
> 
> 赞同：0
> 
> 时间：2012-06-21T15:21:12.343
> 
> 标签：ruby-on-rails, heroku, heroku-san

我正在配置[heroku_san](https://github.com/fastestforward/heroku_san)以将 Rails 部署到 Heroku。当我运行它创建的任何 rake 任务时，我不断收到此错误：

rake 生产部署

没有配置 heroku 应用程序。运行：rails generate heroku:config

我知道有 Heroku 应用程序，因为我可以在运行时看到它们`heroku list`。可能会发生什么？为什么这个 gem 找不到 Heroku 应用程序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T16:23:59.787

看起来 gem 正在寻找一个名为`~/.heroku/credentials`. 我没有。所以我创建了它并添加了我的用户电子邮件和密码，并用换行符分隔：

> myemail@gmail.com
> 
> heroku密码

像魅力一样工作。

# sharepoint - SharePoint 2010 列出 tp_fields - 不是 XML？

> ID：11141404
> 
> 赞同：2
> 
> 时间：2012-06-21T15:21:22.800
> 
> 标签：sharepoint, sharepoint-2010, sharepoint-2007

我需要直接报告 SharePoint 数据，我希望使用 Lists 表中的 tp_fields 数据来获取 SQL 列名称（nvarchar1、nvarchar2、ntext1、int1 等）和 SharePoint 列表列名称之间的映射。然后，我将创建一些 SQL 视图，以更易于理解的格式（反映 SharePoint 列表）表示我的数据。

这应该是 tp_fields 中的 XML 格式，但是我只得到以下内容：

0xA8A930310C000000B4260000789CD55A896EDB4812FD152E77334880698B47F38A6D011E1F13617D04B193 （...但是更长，更长！）

任何想法如何将其转换为 XML？或者是什么问题？根据我的研究，tp_fields 应该包含 nvarchar1 和 SharePoint 列表字段名称之间的直接映射。但是我能找到的所有例子都在 SP 2007 左右——两者之间有什么变化吗？还有其他地方我可以找到这个映射吗？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T20:46:35.880

SharePoint 2010`tp_Fields`现在压缩该列。其他地方有显示如何解压缩它的答案。例如：

[如何从 SharePoint 2010 的数据库中找到 SharePoint 列表的字段？](https://stackoverflow.com/questions/8988098/how-could-i-find-the-fields-of-a-sharepoint-list-from-database-in-sharepoint-201)

或者

[SharePoint 2010 内容数据库](http://social.technet.microsoft.com/Forums/en-CA/sharepoint2010programming/thread/27e47732-9528-446c-9c09-7ab968e11e42)

# r - 将数组重塑为 data.frame

> ID：11141406
> 
> 赞同：28
> 
> 时间：2012-06-21T15:21:26.857
> 
> 标签：r, transform, dataframe, reshape

`daply`我有以下来自in 的数据结构（“原子向量？”）输出`plyr`，其中我让函数为每个主题、条件和项目返回三个不同的度量。

```
x = structure(c(-0.93, 0.39, 0.88, 0.63, 0.86, -0.69, 1.02, 0.29, 0.94, 
0.93, -0.01, 0.79, 0.32, 0.14, 0.13, -0.07, -0.63, 0.26, 0.07, 0.87,
-0.36, 1.043, 0.33, -0.12, -0.055, 0.07, 0.67, 0.48, 0.002, 0.008, 
-0.19, -1.39, 0.98, 0.43, -0.02, -0.15,-0.08, 0.74, 0.96, 0.44, -0.005,
1.09, 0.36, 0.04, 0.09, 0.17, 0.68, 0.51, 0.09, 0.12, -0.05, 0.11,
0.99, 0.62, 0.13, 0.06, 0.27, 0.74, 0.96, 0.45), .Dim = c(5L, 
2L, 2L, 3L), .Dimnames = structure(list(Subject = c("s1", "s2", 
"s3", "s4", "s5"), Cond = c("A", "B"), Item = c("1", "2"), c("Measure1", 
"Measure2", "Measure3")), .Names = c("Subject", "Cond", 
"Item", ""))) 
```

我想将其更改为：

```
Subject Cond Item Measure1 Measure2 Measure3
     s1    A    1    -0.93   -0.360   -0.005
     s1    A    2    -0.01    -0.19    -0.05 
     s1    B    1    -0.69    0.070     0.17
     s1    B    2    -0.07    -0.15     0.06
     s2    A    1     0.39    1.043    1.090
     s2    A    2     0.79    -1.39     0.11
     s2    B    1     1.02    0.670     0.68
     s2    B    2    -0.63    -0.08     0.27 
```

等等

是否有捷径可寻？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2015-11-19T04:25:08.867

使用`as.data.frame.table()`.

```
d0 <- as.data.frame.table(x)
head(d0)

#   Subject Cond Item     Var4  Freq
# 1      s1    A    1 Measure1 -0.93
# 2      s2    A    1 Measure1  0.39
# 3      s3    A    1 Measure1  0.88
# 4      s4    A    1 Measure1  0.63
# 5      s5    A    1 Measure1  0.86
# 6      s1    B    1 Measure1 -0.69

library(tidyr)
d1 <- pivot_wider(data = d0, names_from = "Var4", values_from = "Freq")
head(d1)

#   Subject Cond Item Measure1 Measure2 Measure3
# 1      s1    A    1    -0.93   -0.360   -0.005
# 2      s1    A    2    -0.01   -0.190   -0.050
# 3      s1    B    1    -0.69    0.070    0.170
# 4      s1    B    2    -0.07   -0.150    0.060
# 5      s2    A    1     0.39    1.043    1.090
# 6      s2    A    2     0.79   -1.390    0.110 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-06-21T15:40:26.237

是的，使用`adply()`：

```
adply(x, c(1,2,3))
   Subject Cond Item Measure1 Measure2 Measure3
1       s1    A    1    -0.93   -0.360   -0.005
2       s2    A    1     0.39    1.043    1.090
3       s3    A    1     0.88    0.330    0.360
4       s4    A    1     0.63   -0.120    0.040
5       s5    A    1     0.86   -0.055    0.090
6       s1    B    1    -0.69    0.070    0.170
7       s2    B    1     1.02    0.670    0.680
8       s3    B    1     0.29    0.480    0.510
9       s4    B    1     0.94    0.002    0.090
10      s5    B    1     0.93    0.008    0.120
11      s1    A    2    -0.01   -0.190   -0.050
12      s2    A    2     0.79   -1.390    0.110
13      s3    A    2     0.32    0.980    0.990
14      s4    A    2     0.14    0.430    0.620
15      s5    A    2     0.13   -0.020    0.130
16      s1    B    2    -0.07   -0.150    0.060
17      s2    B    2    -0.63   -0.080    0.270
18      s3    B    2     0.26    0.740    0.740
19      s4    B    2     0.07    0.960    0.960
20      s5    B    2     0.87    0.440    0.450 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-21T15:41:15.980

`df = melt(x)`为您提供与您想要的非常相似的东西。然后，您可以从不同的测量级别计算各种测量变量。

使用“reshape2”包，尝试：

```
dcast(melt(x), Subject + Cond + Item ~ Var4) 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-06-21T17:00:57.600

`ftable`几乎可以让您到达您需要的地方：

```
y <- ftable(x)
y
#
#                    Measure1 Measure2 Measure3
# Subject Cond Item                            
# s1      A    1       -0.930   -0.360   -0.005
#              2       -0.010   -0.190   -0.050
#         B    1       -0.690    0.070    0.170
#              2       -0.070   -0.150    0.060
# s2      A    1        0.390    1.043    1.090
#              2        0.790   -1.390    0.110
#         B    1        1.020    0.670    0.680
#              2       -0.630   -0.080    0.270
# s3      A    1        0.880    0.330    0.360
#              2        0.320    0.980    0.990
#         B    1        0.290    0.480    0.510
#              2        0.260    0.740    0.740
# s4      A    1        0.630   -0.120    0.040
#              2        0.140    0.430    0.620
#         B    1        0.940    0.002    0.090
#              2        0.070    0.960    0.960
# s5      A    1        0.860   -0.055    0.090
#              2        0.130   -0.020    0.130
#         B    1        0.930    0.008    0.120
#              2        0.870    0.440    0.450 
```

* * *

但是，大多数人可能更喜欢`data.frame`. Using`as.data.frame.matrix`提取值，但不提取行名和列名。`ftable`将该信息存储在`row.vars`和`col.vars`属性中。

```
attributes(y)$row.vars
# $Subject
# [1] "s1" "s2" "s3" "s4" "s5"
# 
# $Cond
# [1] "A" "B"
# 
# $Item
# [1] "1" "2"

attributes(y)$col.vars
# [[1]]
# [1] "Measure1" "Measure2" "Measure3" 
```

`ftable`我们可以使用这些信息来编写一个将 a 转换为 a的函数`data.frame`：

```
ftable2df <- function(mydata) {
  ifelse(class(mydata) == "ftable", 
         mydata <- mydata, mydata <- ftable(mydata))
  dfrows <- rev(expand.grid(rev(attr(mydata, "row.vars"))))
  dfcols <- as.data.frame.matrix(mydata)
  names(dfcols) <- do.call(
    paste, c(rev(expand.grid(rev(attr(mydata, "col.vars")))), sep = "_"))
  cbind(dfrows, dfcols)
} 
```

在这里，它直接在您的原始“x”上使用：

```
ftable2df(x)
#    Subject Cond Item Measure1 Measure2 Measure3
# 1       s1    A    1    -0.93   -0.360   -0.005
# 2       s1    A    2    -0.01   -0.190   -0.050
# 3       s1    B    1    -0.69    0.070    0.170
# 4       s1    B    2    -0.07   -0.150    0.060
# 5       s2    A    1     0.39    1.043    1.090
# 6       s2    A    2     0.79   -1.390    0.110
# 7       s2    B    1     1.02    0.670    0.680
# 8       s2    B    2    -0.63   -0.080    0.270
# 9       s3    A    1     0.88    0.330    0.360
# 10      s3    A    2     0.32    0.980    0.990
# 11      s3    B    1     0.29    0.480    0.510
# 12      s3    B    2     0.26    0.740    0.740
# 13      s4    A    1     0.63   -0.120    0.040
# 14      s4    A    2     0.14    0.430    0.620
# 15      s4    B    1     0.94    0.002    0.090
# 16      s4    B    2     0.07    0.960    0.960
# 17      s5    A    1     0.86   -0.055    0.090
# 18      s5    A    2     0.13   -0.020    0.130
# 19      s5    B    1     0.93    0.008    0.120
# 20      s5    B    2     0.87    0.440    0.450 
```

# shell - 在 Shell 脚本中搜索字符串

> ID：11141413
> 
> 赞同：1
> 
> 时间：2012-06-21T15:21:55.180
> 
> 标签：shell, dojo

使用 shell 脚本，我试图在文件中搜索字符串，然后在变量中返回该值，以便我可以在 shell 脚本中操作它。

我正在使用一个dojo 构建脚本，这个脚本需要为dojo 定义一个版本号。默认情况下，构建脚本将版本号定义为 0.0.0.dev。我想要做的是在我的原始 dojo 文件中搜索 dojo.version 的定义，然后使用该值手动将我编译的构建的版本号设置为该值。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T18:47:38.287

既然你标记为`shell`，那就让它成为 bash ；这是要查找的关键正则表达式：`dojo\.version[\ \t]*=[\ \t]*{`

简而言之; 以下是我测试的两个版本的解决方案：

```
# grep -A20 includes comments, excluding these by following
flattenedlines=$(line=$(grep -nRe "dojo\.version[\ \t]*=[\ \t]*{" *); head -n `echo 20+$(echo $line|cut -d ":" -f2)|bc` $(echo $line|cut -d ":" -f1) | tail -n 21| grep -v "\/\/")
echo $flattenedlines | sed "s/'/\"/" | sed 's/.*major[\ \t]*:[\ \t]*\([0-9]*\).*minor[\ \t]*:[\ \t]*\([0-9]*\).*patch[\ \t]*:[\ \t]*\([0-9]*\).*flag[\ \t]*:[^"]*"\([^"]*\).*/\1 - \2 - \3 - \4/'
## result ## :"nMajor - nMinor - nPatch - szFlag" 
```

有两个不同的版本，我个人已经看过了。版本 1.4.0 和 1.7.2 使用了两个不同的文件（我相信至少从 1.2 开始这是相当一致的，1.6 未成年人是转折点）

使用这个命令遍历 dojo/_base/ 目录，它应该给你一个文件和行号，以及找到的表达式之后的行子集。这是基于使用*非压缩 sdk*的事实。

```
dojobase="/var/www/dojotoolkit/dojo"

#command will return similar to following
# for 1.4.2 : "_loader/bootstrap.js:208:    dojo.version = {"
# for 1.7.2 : "kernel.js:97:    dojo.version = {"
pushd $dojobase/dojo/_base
lines=$(grep -A20 -Re "dojo\.version[\ \t]*=[\ \t]*{" *) 
```

知道，这是要解析的文本

```
 dojo.version = {
            // undefined
            // number of lines
            // with comments
            major: 1, minor: 7, patch: 2, flag: "",
            revision: rev ? +rev[0] : NaN,
            toString: function(){
                    var v = dojo.version;
                    return v.major + "." + v.minor + "." + v.patch + v.flag + " (" + v.revision + ")";      // String
            }
    }; 
```

使`$lines`缓冲区看起来像这样：

```
dojo.version = { _loader/bootstrap.js- // summary: _loader/bootstrap.js- // version number of dojo _loader/bootstrap.js- // major: Integer _loader/bootstrap.js- // Major version. If total version is "1.2.0beta1", will be 1 _loader/bootstrap.js- // minor: Integer _loader/bootstrap.js- // Minor version. If total version is "1.2.0beta1", will be 2 _loader/bootstrap.js- // patch: Integer _loader/bootstrap.js- // Patch version. If total version is "1.2.0beta1", will be 0 _loader/bootstrap.js- // flag: String _loader/bootstrap.js- // Descriptor flag. If total version is "1.2.0beta1", will be "beta1" _loader/bootstrap.js- // revision: Number _loader/bootstrap.js- // The SVN rev from which dojo was pulled _loader/bootstrap.js- major: 1, minor: 4, patch: 0, flag: "dev", _loader/bootstrap.js- revision: rev ? +rev[0] : NaN, _loader/bootstrap.js- toString: function(){ _loader/bootstrap.js- with(d.version){ _loader/bootstrap.js- return major + "." + minor + "." + patch + flag + " (" + revision + ")"; // String _loader/bootstrap.js- } _loader/bootstrap.js- } _loader/bootstrap.js- } 
```

使用 sed，这是一行一行的，如下所示：

```
 major=$(echo $lines | sed 's/.*major[\ ]*:[^0-9]*\([0-9]\)*,.*/\1/')
  minor=$(echo $lines | sed 's/.*minor[\ ]*:[^0-9]*\([0-9]\)*,.*/\1/')
  patch=$(echo $lines | sed 's/.*patch[\ ]*:[^0-9]*\([0-9]\)*,.*/\1/') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T15:38:18.937

您可以通过将版本作为参数传递给构建脚本来覆盖该版本。

这是一个使用 bat 文件的 windows 示例

```
build.bat profileFile=my.profile.js action=release releaseDir=../../../release/
 releaseName=rel copyTests=false optimize=comments 
 cssOptimize=comments version=THE_VERSION_YOU_WANT 
```

我对这个[问题](https://stackoverflow.com/questions/11092237/integrate-dojo-build-into-grails-build)的回答显示了一个覆盖版本的 ANT 构建。

# oracle - 如何从 Oracle 函数中锁定并返回多行？

> ID：11141414
> 
> 赞同：2
> 
> 时间：2012-06-21T15:21:55.203
> 
> 标签：oracle, jdbc, plsql, sys-refcursor, oracle-cursor

我一直在尝试解决 Oracle 如何处理`ROWNUM`以及`SELECT ... FOR UPDATE SKIP LOCKED`尝试返回几行未锁定的问题。我尝试了以下一些解决方案：[Force Oracle to return TOP N rows with SKIP LOCKED](https://stackoverflow.com/questions/6117254/force-oracle-to-return-top-n-rows-with-skip-locked)，以及其他几个看起来与该问题非常相似的示例。我知道 Oracle AQ 可能是最好的解决方案，但我们对数据库几乎没有控制权，而且我遇到了相当大的反对意见。

我遇到的问题是尝试使用 JDBC 将结果返回给 Java。我已经尝试过`setFetchSize(20)`，但我遇到了只将前 20 行分发给客户端的问题。我通常会看到一个处理代理获得所有 20 行或几个处理器获得一些行，所有这些行加起来为 20。这非常类似于`ROWNUM`与`SELECT ... FOR UPDATE SKIP LOCKED`.

我尝试过的最有希望的解决方案是以下功能：

```
create type IND_ID as object
(
   ID varchar2(200)
);

create type IND_ID_TABLE as table of IND_ID;

create or replace function SELECTIDS return IND_ID_TABLE
   pipelined is

   ST_CURSOR SYS_REFCURSOR;
   ID_REC IND_ID := IND_ID(null);

begin
   open ST_CURSOR for
      select ID
        from TABLE
    /* where clause */
         for update SKIP LOCKED;   
   loop
      fetch ST_CURSOR
         into ID_REC.ID;
      exit when ST_CURSOR%rowcount > 20 or ST_CURSOR%notfound;
      pipe row(ID_REC);
   end loop;
   close ST_CURSOR;
   return;
end; 
```

但是，当我尝试像这样调用它时：

```
select * from table(SELECTIDS) 
```

我收到一个`ORA-14551: cannot perform a DML operation inside a query`错误，我现在明白这是事务的问题。移除锁会导致函数返回行。

如何在保留锁的同时将此函数中的多行放入 JDBC？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-06-22T00:41:24.617

这行不通。您调用 pl/sql 函数作为 select 语句的一部分，并尝试在该函数中启动事务。我认为错误很明显。

# nhibernate - NHibernate：并发问题是否会导致 log4net 中的错误？

> ID：11141416
> 
> 赞同：0
> 
> 时间：2012-06-21T15:22:11.123
> 
> 标签：nhibernate, exception, concurrency, log4net

我正在处理 nhibernate 中的并发问题，我不确定我是否做得对。我使用版本字段，当事务被提交时，如果版本字段被另一个进程更改，我认为会抛出 StaleObjectStateException。我抓住了这个异常并处理了这种情况，它似乎有效。

但我想知道的是，每次抛出异常时，NHibernate 都会在我的 log4net-Logfile 中产生一个错误。我已将 NHibernate 的日志级别设置为 ERROR，因为我认为如果发生错误，我应该会感兴趣。但是我对所有关于一些并发冲突的消息不感兴趣，因为我不认为这是一个错误。

所以可能是我做错了什么？通过捕获异常来处理并发是正确的方法吗？

更新：这是 nhibernate 在我的日志文件中放入的内容：

```
2012-06-21 16:47:30,546 错误 NHibernate.Event.Default.AbstractFlushingEventListener：无法将数据库状态与会话同步
NHibernate.StaleObjectStateException：行已被另一个事务更新或删除（或未保存的值映射不正确）：[Delta.FollowUp.Model.CFollowUp#60003]
   bei NHibernate.Persister.Entity.AbstractEntityPersister.Update(Object id, Object[] fields, Object[] oldFields, Object rowId, Boolean[] includeProperty, Int32 j, Object oldVersion, Object obj, SqlCommandInfo sql, ISessionImplementor session) in d: \CSharp\NH\NH\nhibernate\src\NHibernate\Persister\Entity\AbstractEntityPersister.cs:Zeile 2780。
   bei NHibernate.Persister.Entity.AbstractEntityPersister.UpdateOrInsert(Object id, Object[] fields, Object[] oldFields, Object rowId, Boolean[] includeProperty, Int32 j, Object oldVersion, Object obj, SqlCommandInfo sql, ISessionImplementor session) in d: \CSharp\NH\NH\nhibernate\src\NHibernate\Persister\Entity\AbstractEntityPersister.cs:Zeile 2692。
   在 d:\CSharp\ 中北 NHibernate.Persister.Entity.AbstractEntityPersister.Update(Object id, Object[] fields, Int32[] dirtyFields, Boolean hasDirtyCollection, Object[] oldFields, Object oldVersion, Object obj, Object rowId, ISessionImplementor session) NH\NH\nhibernate\src\NHibernate\Persister\Entity\AbstractEntityPersister.cs:Zeile 3000。
   d:\CSharp\NH\NH\nhibernate\src\NHibernate\Action\EntityUpdateAction.cs:Zeile 中的北 NHibernate.Action.EntityUpdateAction.Execute() 79。
   在 d:\CSharp\NH\NH\nhibernate\src\NHibernate\Engine\ActionQueue.cs:Zeile 136 中的北 NHibernate.Engine.ActionQueue.Execute（IExecutable 可执行文件）。
   d:\CSharp\NH\NH\nhibernate\src\NHibernate\Engine\ActionQueue.cs:Zeile 126 中的北 NHibernate.Engine.ActionQueue.ExecuteActions(IList 列表)。
   d:\CSharp\NH\NH\nhibernate\src\NHibernate\Engine\ActionQueue.cs:Zeile 170 中的北 NHibernate.Engine.ActionQueue.ExecuteActions()。
   在 d:\CSharp\NH\NH\nhibernate\src\NHibernate\Event\Default\AbstractFlushingEventListener.cs:Zeile 241 中的北 NHibernate.Event.Default.AbstractFlushingEventListener.PerformExecutions（IEventSource 会话）。

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T17:19:20.963

当出现并发问题时你会做什么取决于应用程序。在很多情况下，捕获异常并重试工作单元就足够了——但是定义工作单元是很棘手的地方。根据您的情况，再次加载实体并再次进行更改然后保存它可能就足够了，但这实际上取决于您的应用程序。

基本上，该异常意味着另一个线程/进程已更改数据库中的实体，因此您现在需要做出相应的反应。NHibernate 将其记录为错误，因为版本字段的使用意味着乐观并发，您假设没有其他内容会更改您正在更改的行，因此如果某些内容确实更改了其中一个行，那么您需要来处理它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T00:02:04.877

如果您**不想**记录 NHibernate 错误，只需删除 NHibernate 的记录器，将其设置为 FATAL 级别，或以某种方式过滤异常。

您仍然可以捕获异常、处理它、重新抛出它、记录它，等等。

# sharepoint - SharePoint Designer 数据视图 - XSLT 计数

> ID：11141421
> 
> 赞同：2
> 
> 时间：2012-06-21T15:22:17.847
> 
> 标签：sharepoint, xslt, sharepoint-2010, dataviewwebpart

我正在使用 SPD 2010 中的数据视图 Web 部件。我的 xml 结构如下：

```
<ProjectGroups>
    <ProjectGroup>
        <GroupID>1</GroupID>
        <ProjectName>Project 1</ProjectName>
    </ProjectGroup>
    <ProjectGroup>
        <GroupID>2</GroupID>
        <ProjectName>Project 2</ProjectName>
    </ProjectGroup>
    <ProjectGroup>
        <GroupID>2</GroupID>
        <ProjectName>Project 3</ProjectName>
    </ProjectGroup>
    </ProjectGroups> 
```

这是一个汇总 Web 部件，所以我要做的是计算每个项目组下的项目数。对于我上面的示例，组 ID 1 有 1 个项目，组 ID 2 有 2。我确信有办法做到这一点，但我正在学习 xslt，所以我不确定该怎么做. 任何帮助表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T16:00:28.580

这个样式表...

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output method="xml" indent="yes"/>

<xsl:key name="groups" match="ProjectGroup" use="GroupID" />

<xsl:template match="@*|node()">
 <xsl:copy> 
   <xsl:apply-templates select="@*|node()" />
 </xsl:copy> 
</xsl:template>

<xsl:template match="ProjectGroup[generate-id()=generate-id(key('groups',GroupID)[1])]">
 <xsl:copy> 
   <xsl:apply-templates select="@*" />
   <xsl:attribute name="count-of-projects">
     <xsl:value-of select="count(key('groups',GroupID))" />
   </xsl:attribute>
   <xsl:apply-templates select="node()" />
 </xsl:copy> 
</xsl:template>

</xsl:stylesheet> 
```

...当应用于您的输入时，将产生...

```
<?xml version="1.0" encoding="utf-8"?>
<ProjectGroups>
    <ProjectGroup count-of-projects="1">
        <GroupID>1</GroupID>
        <ProjectName>Project 1</ProjectName>
    </ProjectGroup>
    <ProjectGroup count-of-projects="2">
        <GroupID>2</GroupID>
        <ProjectName>Project 2</ProjectName>
    </ProjectGroup>
    <ProjectGroup>
        <GroupID>2</GroupID>
        <ProjectName>Project 3</ProjectName>
    </ProjectGroup>
</ProjectGroups> 
```

# c - 当输出可以是非ASCII时，为什么要使用fopen（）模式'b'（stdio.h）？

> ID：11141422
> 
> 赞同：4
> 
> 时间：2012-06-21T15:22:18.417
> 
> 标签：c, stdio

使用 C 标准库`stdio.h`，我读到输出 ASCII/文本数据，一个应该使用模式`"w"`和输出二进制数据，一个应该使用`"wb"`. 但为什么会有差异？

无论哪种情况，我都只是输出一个字节（char）数组，对吗？如果我在 ASCII 模式下输出一个非 ASCII 字节，程序仍然会输出正确的字节。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-21T16:46:11.403

一些操作系统——主要命名为“windows”——不保证它们会完全按照你传入的方式读写ascii文件。所以在windows上它们实际上将\r\n映射到\n。这在读取和写入 ascii 时很好且透明。但它会破坏二进制数据流。基本上，如果您希望它按照您传入的方式忠实地读取和写入数据到文件，则只需始终为 Windows 提供“b”标志。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T15:29:53.007

以 ASCII 输出时会发生某些转换（例如，当输出字符为换行符时输出 neline+carriage-return）——取决于您的平台。使用二进制格式时不会发生此类转换

# excel-2007 - 用于复杂查找的更好的 Excel 公式

> ID：11141423
> 
> 赞同：4
> 
> 时间：2012-06-21T15:22:20.753
> 
> 标签：excel-2007, excel-formula

我正在尝试改进我继承的复杂查找过程。查找是通过几个 UDF 结合一些标准工作表函数生成的。但是，问题是当用户更新源表中的一些数据时，重新计算的时间是不可接受的。

所以，我看了看，并认为我可以编写一个更好的 Excel 公式解决方案。好吧，我确实找到了解决方案，但是 Excel 无法处理大型数据集，并且当我的 VBA 针对数据集运行公式时，它会崩溃（可以理解！）。

现在，我可以在 VBA 中完全实现这一点，但是用户必须在每次更改后按下按钮或其他东西来更新。我想要的是一种更简单的方法，如果有的话，使用一些高级 Excel 2007 公式。由于我对这些公式不太熟悉，因此我正在寻求帮助！

好的，这是我必须处理的。

**源表**

如下列中的 Tid、结算日期和月末价格（由 1、2、3 等标识的层期）

```
Tid   SettleDate   1   2   3   4   5   6   7   8   9   10  ...   n 
```

**公式表**

在其他专栏中，我有以下专栏

```
InitLayer   LiqdLayer   InstrClass   Tid   SettleDate   InitPrice   LiqdPrice   Position 
```

我在整个数据集右侧的列中也有层号，如下所示：

```
1   2   3   4   5   ...   n 
```

我需要做的是通过查找源表上的价格，根据数据集中的一些逻辑在这些列中填写适当的价格变化。

在伪公式中，这是我需要为 FormulaSheet 中的每一层列发生的事情

```
If Layer < InitLayer OR Layer > LiqdLayer Then Return "-"

ElseIf Layer = InitLayer Then (Layered Price - InitPrice) * Position

     where Layered Price is obtained by finding the Intersect of the LayerNumber 
     Column and Tid Row in the SourceSheet

ElseIf Layer = LiqdLayer Then Previous Layered Price * Position

     where Previous Layered Price is obtained by finding the Intersect of the Previous   
     LayerNumber Column and Tid Row in the SourceSheet

Else (LayeredPrice - Previous Layered Price) * 6

     where Layered Price and Previous Layered Price are defined as above

End If 
```

我确实提出了这个公式，它在小数据集上效果很好，但是对于大数据集来说它**太大**了太糟糕了，或者只是太大太糟糕了！

```
=IF(OR(CH$3<$AT6,CH$3>$AU6),"-",IF($AT6=CH$3,(HLOOKUP(CH$3,layered_prices,RIGHT(ADDRESS(MATCH(IF($AX6="CUR",$T6 & " " & $G6,$T6),IF($AX6="CUR",layered_curtid,layered_tid),1),1,4),LEN(ADDRESS(MATCH(IF($AX6="CUR",$T6 & " " & $G6,$T6),IF($AX6="CUR",layered_curtid,layered_tid),1),1,4))-1)-1,FALSE)-$AV6)*$C6,IF($AU6=CH$3,($AW6-HLOOKUP(CG$3,layered_prices,RIGHT(ADDRESS(MATCH(IF($AX6="CUR",$T6 & " " & $G6,$T6),IF($AX6="CUR",layered_curtid,layered_tid),1),1,4),LEN(ADDRESS(MATCH(IF($AX6="CUR",$T6 & " " & $G6,$T6),IF($AX6="CUR",layered_curtid,layered_tid),1),1,4))-1)-1,FALSE))*$C6,(HLOOKUP(CH$3,layered_prices,RIGHT(ADDRESS(MATCH(IF($AX6="CUR",$T6 & " " & $G6,$T6),IF($AX6="CUR",layered_curtid,layered_tid),1),1,4),LEN(ADDRESS(MATCH(IF($AX6="CUR",$T6 & " " & $G6,$T6),IF($AX6="CUR",layered_curtid,layered_tid),1),1,4))-1)-1,FALSE)-HLOOKUP(CG$3,layered_prices,RIGHT(ADDRESS(MATCH(IF($AX6="CUR",$T6 & " " & $G6,$T6),IF($AX6="CUR",layered_curtid,layered_tid),1),1,4),LEN(ADDRESS(MATCH(IF($AX6="CUR",$T6 & " " & $G6,$T6),IF($AX6="CUR",layered_curtid,layered_tid),1),1,4))-1)-1,FALSE))*$C6))) 
```

**公式键**

```
CH = Layer Number
CG = Previous Layer Number
AT = InitLayer
AU = LiqdLayer
AX = InstrClass (used to find a separate lookup for Currencies)
T = Tid
G = SettleDate (used to find a separate lookup for Currencies)
AV = InitPrice
AW = LiqPrice
C = Position
layered_prices = named range for the range of prices under the layer columns in SourceSheet
layered_tid = named range for tid rows in SourceSheet
layered_curtid = named range for currency tid rows in Source Sheet (just a separte lookup if InstrType = Currency, formula the same 
```

是否有任何其他公式或公式组合可以让我以比我创造的怪物更有效的方式获得我正在寻找的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-05-22T14:22:38.530

我同意Kharoof 的评论。您应该将此公式分成几列。据我计算，您还需要 4 列。好处是双重的：1）您的公式变得更短，因为您不会一遍又一遍地重复相同的函数；2）您可以节省内存，因为 Excel 将计算一次而不是多次。

例如，您调用了`ADDRESS`四次完全相同的函数。Excel 不会“记住”计算公式时的内容，因此每次都会重新计算。如果你把它放在它自己的单元格中，那么 Excel 将在任何依赖它的单元格之前评估该单元格，并将其存储为一个值而不是公式。当其他单元格引用它时，Excel 将提供预先评估的结果。

* * *

首先，你的最终公式应该是这样的：（[括号]中的名称表示辅助列适合那里。这将是一些单元格引用，`CI$3`但我不确定你想把它放在哪里。你必须根据添加这些列的位置更新这些引用。）

```
=IF(OR(CH$3<$AT6,CH$3>$AU6),"-",IF($AT6=CH$3,([LayerNumber]-$AV6)*$C6,IF($AU6=CH$3,($AW6-[PreviousLayerNumber])*$C6,([LayerNumber]-[PreviousLayerNumber])*$C6))) 
```

以下是四个辅助列：

```
[ADDRESS] = ADDRESS(MATCH(IF($AX6="CUR",$T6 & " " & $G6,$T6),IF($AX6="CUR",layered_curtid,layered_tid),1),1,4)
[RIGHT] = RIGHT([ADDRESS],LEN([ADDRESS])-1)
[LayerNumber] = HLOOKUP(CH$3,layered_prices,[RIGHT]-1,FALSE)
[PreviousLayerNumber] = HLOOKUP(CG$3,layered_prices,[RIGHT]-1,FALSE) 
```

通过拆分它，公式的每个步骤都更容易遵循/调试，并且在 Excel 中处理起来也更快。如果你想要一些定量的改进，五个公式的组合将比你现在拥有的单个公式短 70% 左右。

# python - Django Tastypie：带有“空格”的反向 url。如何？

> ID：11141424
> 
> 赞同：2
> 
> 时间：2012-06-21T15:22:22.883
> 
> 标签：python, django, url, reverse, tastypie

这让我疯狂：

*   我有一个 Tastypie 自定义资源（不是 ModelResource）。
*   我需要为“主键”允许“空格”（%20 代码）。例如：

    `localhost:8000/api/v1/collections/i%20am%20a%20space/`

*   添加带有“\s”的正则表达式适用于`GET (obj_get)`,`PUT (obj_update)` 和`DELETE (obj_delete)`

    ```
    def override_urls(self):
    return [url(r"^(?P<resource_name>%s)/(?P<name>[\w\d\s_.-]+)/$" % self._meta.resource_name, self.wrap_view('dispatch_detail'), name="api_dispatch_detail")] 
    ```

*   问题在于`obj_get_list`：返回对象列表时，`resource_uri`如果存在空格，则参数为空。代码在函数`reverse`(django.core.urlresolvers) 中失败并出现 `NoReverseMatch`异常。

我什至试图覆盖来自tastepie的base_urls，但它没有用，我现在真的迷路了。也许这是一个菜鸟问题，但考虑到我大约 1 个月前开始使用 django 和 python：我是菜鸟 :-P

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T09:05:20.150

刚刚更改了正则表达式中“pk”的“名称”：

```
^(?P<resource_name>%s)/(?P<name>[\w\d\s_.-]+)/$ 
```

# java - 谁能帮我识别第 65 行的线程“AWT-EventQueue-0”java.lang.NullPointerException 中的异常？

> ID：11141425
> 
> 赞同：0
> 
> 时间：2012-06-21T15:22:26.053
> 
> 标签：java, nullpointerexception, awt, actionlistener, awt-eventqueue

我不断收到一个运行时错误，说我在线程“AWT-EventQueue-0”java.lang.NullPointerException 中有一个异常，它说的是 [第 65 行]，但对我来说，它看起来就像一个基本的 if 语句。我可以提供一些背景。该帧是从一系列帧中调用的，一旦选择了状态，就会将其发送到包含州 AC 城市的新帧。此当前框架仅在阿拉巴马州不是所选州时才有效。（我没有为其他状态创建其他框架，因此为什么它们被注释掉了）我可以将代码放到另一个框架，如果有人需要它应该调用它，但我认为这是很多代码开始和。提前感谢大家的帮助。

```
import javax.swing.*;
import java.awt.*;
import java.awt.event.ActionListener;
import java.awt.event.*;
import java.io.*;
import java.util.*;

public class WetBulbByLocationFrameStates3 extends JFrame
{
  public JLabel stateLabel;
  public JPanel statePanel = new JPanel();
  public JComboBox stateBox;
  public String [] unitedStates = {"Alabama", "Alaska", "Arizona", "Arkansas", "California", "Colorado", "Connecticut", "Delaware", "District of Columbia", "Florida", "Georgia", "Hawaii", "Idaho", "Illinois", "Indiana", "Iowa", "Kansas", "Kentucky", "Louisiana", "Maine", "Maryland", "Massachusetts", "Michigan", "Minnesota", "Mississippi", "Missouri", "Montana", "Nebraska", "Nevada", "New Hampshire", "New Jersey", "New Mexico", "New York", "North Carolina", "North Dakota", "Ohio", "Oklahoma", "Oregon", "Pennsylvania", "Rhode Island", "South Carolina", "South Dakota", "South Pacific Islands", "Tennessee", "Texas", "Utah", "Vermont", "Virginia", "Washington", "West Virginia", "Wisconsin", "Wyoming"};
  public String [] canadianProvinces = {"Alberta", "British Columbia", "Manitoba", "New Brunswick", "Newfoundland and Labrador", "Northwest Territories", "Nova Scotia", "Nunavut", "Ontario", "Prince Edward Island", "Quebec", "Saskatchewan", "Yukon Territory"};
  public JButton nextButton = new JButton("Next");
  public JPanel buttonPanel = new JPanel();
  public String state;
  public String countryGIVEN;

  public WetBulbByLocationFrameStates3(String country)
  {
    Toolkit toolkit = Toolkit.getDefaultToolkit();
    Dimension dimensions = toolkit.getScreenSize();
    int x = (dimensions.width - 315)/2; 
    int y = (dimensions.height - 250)/2;
    setBounds(x, y, 315, 250); 
    setVisible(true);
    setResizable(false);
    setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
    countryGIVEN = country;

    nextButton.addActionListener(new ButtonListener3());

    if (country.equals("United States of America"))
    {
      stateBox = new JComboBox(unitedStates);
      setTitle("Select State");
      stateLabel = new JLabel("State");
    }
    else if (country.equals("Canada"))
    {
      stateBox = new JComboBox(canadianProvinces);
      setTitle("Select Province");
      stateLabel = new JLabel("Province");
    }

    stateBox.addActionListener(new ComboBoxListener2());

    statePanel.add(stateLabel);
    statePanel.add(stateBox);

    add(statePanel, BorderLayout.CENTER);

    buttonPanel.add(nextButton);

    add(buttonPanel, BorderLayout.SOUTH);
  }
  private class ButtonListener3 implements ActionListener
  {
    @Override
    public void actionPerformed(ActionEvent e)
    {
      if (countryGIVEN.equals("United States of America"))
      {
        if (state.equals("Alabama"))
        {
          JFrame wbfs1 = new WetBulbByLocationFrameStateGroupA_C(state);
        }
        else if (state.equals("Alaska"))
        {
          JFrame wbfs2 = new WetBulbByLocationFrameStateGroupA_C(state);
        }
        else if (state.equals("Arizona"))
        {
          JFrame wbfs3 = new WetBulbByLocationFrameStateGroupA_C(state);
        }
        else if (state.equals("Arkansas"))
        {
          JFrame wbfs4 = new WetBulbByLocationFrameStateGroupA_C(state);
        }
        else if (state.equals("California"))
        {
          JFrame wbfs5 = new WetBulbByLocationFrameStateGroupA_C(state);
        }
        else if (state.equals("Colorado"))
        {
          JFrame wbfs6 = new WetBulbByLocationFrameStateGroupA_C(state);
        }
        else if (state.equals("Connecticut"))
        {
          JFrame wbfs7 = new WetBulbByLocationFrameStateGroupA_C(state);
        }
      }
    }
  }
  private class ComboBoxListener2 implements ActionListener
  {
    @Override
    public void actionPerformed(ActionEvent e)
    {
      state = (String)stateBox.getSelectedItem();
    }
  }
} 
```

**PS这里是选择阿拉巴马州时的错误。**

```
Exception in thread "AWT-EventQueue-0" java.lang.NullPointerException
    at WetBulbByLocationFrameStates3$ButtonListener3.actionPerformed(WetBulbByLocationFrameStates3.java:65)
    at javax.swing.AbstractButton.fireActionPerformed(Unknown Source)
    at javax.swing.AbstractButton$Handler.actionPerformed(Unknown Source)
    at javax.swing.DefaultButtonModel.fireActionPerformed(Unknown Source)
    at javax.swing.DefaultButtonModel.setPressed(Unknown Source)
    at javax.swing.plaf.basic.BasicButtonListener.mouseReleased(Unknown Source)
    at java.awt.Component.processMouseEvent(Unknown Source)
    at javax.swing.JComponent.processMouseEvent(Unknown Source)
    at java.awt.Component.processEvent(Unknown Source)
    at java.awt.Container.processEvent(Unknown Source)
    at java.awt.Component.dispatchEventImpl(Unknown Source)
    at java.awt.Container.dispatchEventImpl(Unknown Source)
    at java.awt.Component.dispatchEvent(Unknown Source)
    at java.awt.LightweightDispatcher.retargetMouseEvent(Unknown Source)
    at java.awt.LightweightDispatcher.processMouseEvent(Unknown Source)
    at java.awt.LightweightDispatcher.dispatchEvent(Unknown Source)
    at java.awt.Container.dispatchEventImpl(Unknown Source)
    at java.awt.Window.dispatchEventImpl(Unknown Source)
    at java.awt.Component.dispatchEvent(Unknown Source)
    at java.awt.EventQueue.dispatchEventImpl(Unknown Source)
    at java.awt.EventQueue.access$000(Unknown Source)
    at java.awt.EventQueue$3.run(Unknown Source)
    at java.awt.EventQueue$3.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
    at java.awt.EventQueue$4.run(Unknown Source)
    at java.awt.EventQueue$4.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
    at java.awt.EventQueue.dispatchEvent(Unknown Source)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForFilter(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.run(Unknown Source) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T15:29:12.103

第 65 行是这一行：

```
if (state.equals("Alabama")) 
```

如果您查看前面的代码，没有任何东西初始化`state`，所以它的值将是`null`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T15:33:25.893

当`state`您尝试调用`equals`它时，它是空的。

# emacs - 自定义 emacs nxml 缩进

> ID：11141426
> 
> 赞同：1
> 
> 时间：2012-06-21T15:22:26.863
> 
> 标签：emacs, indentation

在过去的 3 年中，我的工作需要编写和编辑 xml 格式的配置文件。xml 标签中的内容已经发展得如此之多，以至于现在它已经变得有点像一种编程语言。不幸的是，emacs 将标签内的所有内容都缩进到同一级别。像这样的东西：

![当前在 nxml 模式下的 emacs 缩进](../Images/4ac249c36639384bcedd09be7b1a14a5.png)

但是，如果我可以将内容缩进如下，那就太糟糕了：

![我多么希望emacs能识别它](../Images/aa2e1e34fa7e0045e43acfb418862155.png)

我已经阅读了几个与自定义缩进相关的线程，但我仍然不知道如何去做。

我试图创建一个自定义的主模式，但这样做会杀死所有的语法颜色和缩进规则。理想情况下，我想做的只是修改 nxml 市长模式缩进规则？不过，我不知道这个规则在哪里。

如果我可以为一些关键词着色，例如“if”或“set”，那将是一个奖励。

我知道我要问的是一项艰巨的工作，所以我不在这里要求一个明确的答案。我只是在寻找一些帮助来指出我正确的方向。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T15:37:20.710

可能最好的方法是为标签内的语言编写一个新的主要模式，然后使用[多个主要模式包](http://www.emacswiki.org/emacs/MultipleModes)，它允许多个主要模式在同一个文件中处于活动状态，因此包含的语言可以有自己的主要模式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-23T19:34:31.857

你可能想看看这个例子。

```
(defun nxml-extra-space-indent ()
  (nxml-indent-line)
  (when (zerop (current-indentation))
    (indent-line-to 4)))
(setq indent-line-function 'nxml-extra-space-indent) 
```

我根据现有的主要模式缩进，然后如果行符合某些条件则自定义缩进。
我认为这是自定义缩进最简单的方法，因为您是从现有的东西开始，并且您不需要知道特定模式的缩进逻辑是如何实现的。

# .net - 创建简单的 asp.net 服务器监视器（使用 ping）的最佳方法？

> ID：11141428
> 
> 赞同：1
> 
> 时间：2012-06-21T15:22:33.153
> 
> 标签：.net

我想监视服务器是启动还是关闭，我认为，ping 它是解决我的问题的最佳方法。我如何“安排”对函数**TestServer**的 asp.net 循环调用，该函数ping 到服务器列表（取自数据库）？也许，最好将我的软件分成两部分？

1.  从数据库加载数据的 ASP.NET 视图（服务器、状态（向上向下））

2.  A.. 每 ..1 分钟运行一次 ping 的命令行 .net 应用程序？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T15:40:32.990

为什么不使用 Nagios 来监控您的服务器？你可以在这里找到它：http: [//www.nagios.com/](http://www.nagios.com/)。该软件旨在监控任何类型的服务器、服务器上的软件、网络连接、数据库、路由器等。安装后，它具有一整套开箱即用的插件。如果默认插件对您来说不够强大，您也可以编写自己的插件。

Nagios 能够监控 Linux 或 Windows 上的环境。只要符合要求，插件可以用任何语言编写。我们有这个工具在我的公司运行，并让它监控我们拥有的每个系统。它提供了一个不错的仪表板，您可以在其中将系统分配给特定用户，以便每个团队都可以监控自己的系统。老实说，这就是我要走的路。

编辑：因为听起来 Nagios 是不可能的，所以最好的办法是编写一个控制台应用程序来提取服务器列表并 ping 它们。不要为此使用数据库，而是创建一个包含服务器列表的配置文件。要运行应用程序，请使用 Windows 调度程序安排此应用程序以 X 分钟的时间间隔运行，然后将结果写入日志文件，或对它们执行其他操作。调度程序将是您最好的选择，而不是让应用程序在后台使用计时器全时运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T15:29:03.937

我可能会创建一个控制台应用程序来完成这项工作（查询数据库、运行 ping 测试、记录结果），并使用 Windows 任务计划程序以特定时间间隔执行该程序。

[http://windows.microsoft.com/en-us/windows7/Schedule-a-task](http://windows.microsoft.com/en-us/windows7/Schedule-a-task)

在您的控制台应用程序中，使用 HttpWebRequest 类进行 ping - [http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.aspx](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.aspx)

# asp.net-mvc-3 - 具有正确行数的空白 MVC 网格

> ID：11141429
> 
> 赞同：0
> 
> 时间：2012-06-21T15:22:35.260
> 
> 标签：asp.net-mvc-3, visual-studio-2010, entity-framework, razor, devexpress

我有一个使用以下 .BindToLINQ 的 DevExpress MVC 网格：

```
.BindToLINQ(typeof(MyContext),
    "Results",
    ((s, e) =>
    {
        e.KeyExpression = "ResultId";
        MyContext db = new MyContext();
        e.QueryableSource = from r in db.Results
            where r.SearchId == @Model.SearchId
            select r;
    }) 
```

通常，对于其他网格，SQL Profiler 显示前 128 行的初始选择（因为我的页面大小为 100），然后在每个 ID 上单独选择以填充所需的数据。在第一次加载此网格时，它执行前 128 个查询，但从不执行单个选择，从而生成具有正确行数的空白网格。我已经打开了 VS2010 设置以在抛出所有异常时中断它们，但我没有遇到任何异常。

如果我对空白网格进行排序，则行会按预期显示。

我该如何调试呢？有没有人见过这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T16:35:50.387

无论您是否打开了 VS2010 设置以中断所有异常，如果异常未在您的代码中引发，调试器仍然可能不会停止。您还需要关闭“[仅我的代码](http://msdn.microsoft.com/en-us/library/h5e30exc.aspx)”选项。

# jquery - 使用 jqPlot 绘制 JSON 数据

> ID：11141434
> 
> 赞同：2
> 
> 时间：2012-06-21T15:22:54.183
> 
> 标签：jquery, json, jqplot

我正在尝试使用由 jqMobile 提供支持的 HTML 5 应用程序`JSON`中的库来绘制一些数据。`jqPlot`我将以下代码放在 html 页面的“正文”中。我在这里缺少什么吗？

```
<script>    
$(document).ready(function() {
    // get the JSON data from server
    $.getJSON("myspecialurl", function(data) {
        success: function(data) {
            plotData(data);
        }
    });
    // plot the data
    function plotData(data) {
        ds = [];
        $(data).find('latitude').each(function() {
            ds.push([$(this).attr('answer'), parseInt($(this).attr('count'))]);
        });
        $.jqplot('chart1', [ds], {
            seriesDefaults: {
                renderer: $.jqplot.DonutRenderer
            },
            legend: {
                show: true
            }
        });
    }
}    
</script> 
```

**编辑：**新的绘图方法

```
function plotData( data ) {
 // ds = [];
 // $(data).find('latitude').each( function() {
 //   ds.push( [ $(this).attr('answer'), parseInt( $(this).attr('count') ) ] );
 // } );
var array = data.contacts;

$.jqplot('chart1', array[0].latitude, {
seriesDefaults:{
   renderer:$.jqplot.DonutRenderer
},
legend: {show:true}
 });
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T15:49:25.563

粗略的有一个问题，计算机又是对的。这就是您的代码的外观。您正在定义成功，就好像您正在使用`ajax`方法一样，`getJSON`成功作为第二个参数传递。

```
$.getJSON("myspecialurl", function(data) {
    plotData(data);
}); 
```

**编辑** 我还发现您没有`ready`正确关闭该功能。它应该`});`不仅仅是`}`.

# mysql - 将图像路径插入数据库在远程服务器上不起作用

> ID：11141435
> 
> 赞同：1
> 
> 时间：2012-06-21T15:22:55.943
> 
> 标签：mysql, database, codeigniter

我正在开发 CI 中的应用程序，我有一个模型，可以将上传表单中的图像路径插入数据库。

此代码在我的本地主机环境中 100% 正确，但是在远程服务器上运行它时失败

```
Error Number: 1062

Duplicate entry '89-ci/flatfee/uploads/37' for key 'PRIMARY' 
```

这个想法是使用一个将listingid映射到image_path的image_map_table，因此listingid必须在每个图像路径的表中重复多次，因此存在重复条目。下面是模型中的函数：

```
function insert_paths($params, $transID){

    $lid = $this->getListingID($transID);

    if($lid != false) {
        $i = 0;
        foreach ($params['image_paths'] as $value) {
            $sql = "INSERT INTO listing_image_map(idlisting, image_path) VALUES(".$lid.", '".$value."')";
            $q = $this->db->query($sql);    
            $i++;
        }
        if(sizeof($params['image_paths']) == $i ){
            return true;
        }
    } else {
        return false;
    }
} 
```

$params 是一个数组，从控制器传入，包含上传表单中的所有图像路径。我理解这个错误，以及它为什么在基本层面上发生，但是更详细的解释为什么它在本地主机上而不是在远程服务器上会很好，以及可能的解决方案。

谢谢。

编辑：感谢 Ashwini Dhekane，我发现了问题。文件路径是从数组创建的，因此服务器上的默认文件路径在其结构中比在我的本地环境中更长，因此用于创建文件夹结构的索引必须为远程服务器增加并在本地减少环境（所以现在我有两组代码，我根据我正在使用的服务器不断评论和取消评论，有点麻烦，但我只需要在这部分工作几天。）

谢谢 Ashwini，你的帖子让我找到了正确的区域，所以我会把它标记为正确的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T15:59:05.083

`'89-ci/flatfee/uploads/37'`似乎是上传文件的路径，错误显示路径是`primary key`列。主键列中不能有任何两行具有相同值。

如果您尝试上传 SQL 转储，则无法执行；键总是会碰撞。在这种情况下，您将不得不编写自定义脚本。

# javascript - 如何在使用 javascript 粘贴时不会丢失光标位置

> ID：11141439
> 
> 赞同：2
> 
> 时间：2012-06-21T15:23:02.330
> 
> 标签：javascript, copy-paste, contenteditable, epiceditor

我有一个可编辑的编辑器，我正试图弄清楚如何让粘贴正常工作。我尝试了简单的：

```
self.editorIframeDocument.addEventListener('paste', function () {
  setTimeout(function () {
    _setText(self.editor, _getText(self.editor));
  }, 1);
}); 
```

`editorIframeDocument`== 内容可编辑`document`。

`_setText`是一个内部函数，用于清理整个代码中使用的输入。

`_getText`只是`innerText`当它可以时，或者当它不能时（Firefox）。

所以，问题是，在粘贴光标移动时。例如：

```
+==========+
+ |
+ WORD
+
+=========== 
```

如果我粘贴`WORD`到那里（假装它是编辑器），光标会出现在您看到它上方的管道的位置。

我怎样才能始终将光标放在用户粘贴的*末尾*，或者准确地说是前一个光标位置。我看到我可以在 中使用`extendOffset`属性`Selection`，但我不确定如何。我也尝试过这样做`collapseToEnd`，但这会将光标放在整个编辑器的末尾。

有任何想法吗？如果您想要完整的源代码：[https ://github.com/OscarGodson/EpicEditor/blob/feature/ticket-100/src/editor.js](https://github.com/OscarGodson/EpicEditor/blob/feature/ticket-100/src/editor.js)

它在分行`feature/ticket-100`

# xml - 如何创建将分层 XML 转换为平面文件的 Biztalk 映射

> ID：11141444
> 
> 赞同：3
> 
> 时间：2012-06-21T15:23:16.270
> 
> 标签：xml, biztalk, flat-file, biztalk-2010, biztalk-mapper

我尝试使用 Biztalk 2010 将分层 XML 文件转换为平面文件架构。

它工作正常。每个文件都被映射。但是等级制度被破坏了。

我的输入 xml 结构如下所示：

```
<root>
    <node>
        <element1></element1>
        <element2></element2>
        <subnode1>
            <element1></element1>
            <element2></element2>
        </subnode1>
        <subnode2>
            <element1></element1>
            <element2></element2>
        </subnode2>
    </node>
</root> 
```

平面文件架构如下所示：

```
<root>
    <node>
        <element1></element1>
        <element2></element2>
    </node>
    <subnode1>
        <element1></element1>
        <element2></element2>
    </subnode1>
    <subnode2>
        <element1></element1>
        <element2></element2>
    </subnode2>
</root> 
```

我的输入是这样的：

```
<root>
    <node>
        <element1>Test1</element1>
        <element2>Test2</element2>
        <subnode1>
            <element1>Sub11</element1>
            <element2>Sub12</element2>
        </subnode1>
        <subnode2>
            <element1>Sub21</element1>
            <element2>Sub22</element2>
        </subnode2>
    </node>
    <node>
        <element1>Test3</element1>
        <element2>Test4</element2>
        <subnode1>
            <element1>Sub31</element1>
            <element2>Sub32</element2>
        </subnode1>
        <subnode2>
            <element1>Sub41</element1>
            <element2>Sub42</element2>
        </subnode2>
    </node>
</root> 
```

我期望的输出是：

```
Test1;Test2
Sub11;Sub12
Sub21;Sub22
Test3;Test4
Sub31;Sub32
Sub41;Sub42 
```

但我得到的是：

```
Test1;Test2
Test3;Test4
Sub11;Sub12
Sub21;Sub22
Sub31;Sub32
Sub41;Sub42 
```

有什么想法可以让 Biztalk 保持层次结构吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-25T07:47:52.573

我现在手头没有 BizTalk Mapper，所以我只能提供 Xslt 解决方案，但基本上它会说明您需要您的地图迭代您的`node`元素以保留结构。

如果您想使用纯 BizTalk 映射实现此目的，您需要在平面输出结构中使用一个分组节点来连接您的源`node`元素，这将强制映射创建`for-each`循环，如下面的 Xslt：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
    <xsl:output method="text" indent="no" />

    <xsl:template match="/">
        <xsl:for-each select="root/node">
            <xsl:value-of select="element1" />
            <xsl:text>;</xsl:text>
            <xsl:value-of select="element2" />
            <xsl:text>&#xA;</xsl:text>
            <xsl:value-of select="subnode1/element1" />
            <xsl:text>;</xsl:text>
            <xsl:value-of select="subnode1/element2" />
            <xsl:text>&#xA;</xsl:text>
            <xsl:value-of select="subnode2/element1" />
            <xsl:text>;</xsl:text>
            <xsl:value-of select="subnode2/element2" />
            <xsl:text>&#xA;</xsl:text>
        </xsl:for-each>
    </xsl:template>

</xsl:stylesheet> 
```

*`&#xA;`您可能需要根据输出模式的需要调整换行符 ( )。*

# jquery - JQuery fadeIn/fadeOut 在第一次加载时有效，但在重新加载时无效

> ID：11141445
> 
> 赞同：0
> 
> 时间：2012-06-21T15:23:16.777
> 
> 标签：jquery, ios, fadein, fadeout

我正在处理的页面是[http://technimedinc.com/index_fb.html](http://technimedinc.com/index_fb.html)

相关的jQuery代码如下：

```
<script>
$('<img src="images/learn_more_on.png"/>');

$(document).ready(function() {
    $("#hb1_off").delay(3000).fadeOut(1000).delay(2000).fadeIn(1000);
    $("#hb2_off").delay(6000).fadeOut(1000).delay(2000).fadeIn(1000);
    $("#hb3_off").delay(9000).fadeOut(1000).delay(2000).fadeIn(1000);
});

$("#hb1").hover(function(){
    $("#hb1_off").fadeOut("fast");
}, function() {
    $("#hb1_off").fadeIn("fast");
});

$("#hb2").hover(function(){
    $("#hb2_off").fadeOut("fast");
}, function() {
    $("#hb2_off").fadeIn("fast");
});

$("#hb3").hover(function(){
    $("#hb3_off").fadeOut("fast");
}, function() {
    $("#hb3_off").fadeIn("fast");
});
</script> 
```

我遇到的问题是，如果我重新加载页面（以刷新 CSS 和其他链接文件），一切似乎都正常。定时的fadeOut 和fadeIns 和悬停一样工作。但是，如果我重新加载页面，一切都会停止工作。

页面上有一个 Facebook 框，这可能是一个因素。我切换到在本地加载 jQuery，但这对问题没有帮助。

最后，document ready 上的 fadeIn 和 fadeOut 在 iOS 上根本不起作用。（显然，我知道悬停不起作用）。

如果有人能指出我正确的方向，我将不胜感激。我花了两天的大部分时间来搜索这些问题和答案，但我自己无法解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T15:34:00.157

如果您将代码更改为此，它会起作用吗？通过将右括号移动到代码片段的末尾，我已将您的处理程序包含`hover`在您的处理程序中。`(document).ready()`

```
<script>
$('<img src="images/learn_more_on.png"/>');

$(document).ready(function() {
$("#hb1_off").delay(3000).fadeOut(1000).delay(2000).fadeIn(1000);
$("#hb2_off").delay(6000).fadeOut(1000).delay(2000).fadeIn(1000);
$("#hb3_off").delay(9000).fadeOut(1000).delay(2000).fadeIn(1000);

$("#hb1").hover(function(){
$("#hb1_off").fadeOut("fast");
}, function() {
$("#hb1_off").fadeIn("fast");
});

$("#hb2").hover(function(){
$("#hb2_off").fadeOut("fast");
}, function() {
$("#hb2_off").fadeIn("fast");
});

$("#hb3").hover(function(){
$("#hb3_off").fadeOut("fast");
}, function() {
$("#hb3_off").fadeIn("fast");
});

});

</script> 
```

或者，尝试将您的动画绑定到 $('#homecontent').load(function(){//animations here//})

# java - MySql 数据在第 1 行截断列“值”

> ID：11141450
> 
> 赞同：4
> 
> 时间：2012-06-21T15:23:32.260
> 
> 标签：java, mysql, database, exception

在我的 java web 应用程序中，我将一些记录插入到 MySql 数据库中。我有一个字段类型为浮点的列名“值”。当我将以下值 76.8653846153846 插入数据库时​​，它会在第 1 行为列“值”截断数据异常。我将字段类型更改为 Double，但消息相同。任何的想法？

字段说明：

![在此处输入图像描述](../Images/8f2bbd13ca1bfed18123351f6c55e77d.png)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-21T15:28:20.067

根据[文档](http://dev.mysql.com/doc/refman/5.0/en/numeric-types.html)，您必须以所需的精度级别定义您的数字类型。

为您的号码 76.8653846153846 使用

```
FLOAT(10,13) 
```

大`13`到足以处理你的`.8653846153846`

**[编辑]**

要更改现有表，请执行此命令，分别将表名和列名替换为*mytable*和*mycolumn*

```
ALTER TABLE mytable MODIFY mycolumn FLOAT(10,13) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T15:29:37.817

这来自数据库引擎，其中表中声明的字段描述不足以插入完整数据

# ruby-on-rails - 无法启动 Rails 服务器

> ID：11141454
> 
> 赞同：0
> 
> 时间：2012-06-21T15:23:48.830
> 
> 标签：ruby-on-rails

我试图在我的地方启动我的服务器（command rails s）但它不工作。上学的时候用的很好，现在不行了

这是显示的错误：

```
C:/Ruby192/lib/ruby/1.9.1/net/ftp.rb:273:in `getresp': 530 Login authentication
failed (Net::FTPPermError)
        from C:/Ruby192/lib/ruby/1.9.1/net/ftp.rb:294:in `block in sendcmd'
        from C:/Ruby192/lib/ruby/1.9.1/monitor.rb:201:in `mon_synchronize'
        from C:/Ruby192/lib/ruby/1.9.1/net/ftp.rb:292:in `sendcmd'
        from C:/Ruby192/lib/ruby/1.9.1/net/ftp.rb:396:in `block in login'
        from C:/Ruby192/lib/ruby/1.9.1/monitor.rb:201:in `mon_synchronize'
        from C:/Ruby192/lib/ruby/1.9.1/net/ftp.rb:392:in `login'
        from c:/rails/aroundthetable/config/application.rb:8:in `<top (required)
>'
        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.2.3/lib/rails/comman
ds.rb:53:in `require'
        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.2.3/lib/rails/comman
ds.rb:53:in `block in <top (required)>'
        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.2.3/lib/rails/comman
ds.rb:50:in `tap'
        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.2.3/lib/rails/comman
ds.rb:50:in `<top (required)>'
        from script/rails:6:in `require'
        from script/rails:6:in `<main>' 
```

你们能帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T15:26:32.200

看起来您正在代码中的某处连接到 FTP 服务器，并且身份验证失败。

# php - 在 Windows 服务器上透视 iMagick Distort

> ID：11141458
> 
> 赞同：0
> 
> 时间：2012-06-21T15:24:06.013
> 
> 标签：php, windows, imagick

我正在尝试通过 imagick php 扩展来扭曲透视图像，并且我有以下代码可以执行此操作：

```
 $controlPoints = array(
                    0,0, 0,0, 
                    0,$height, 0,$height, 
                    $width,0, $width,$perspective_wrap, 
                    $width,$height, $width,$hps
                    );
$im1->setImageMatte(true);
//Distort the image -- In perspective with the matrix given above
$im1->distortImage(Imagick::DISTORTION_PERSPECTIVE, $controlPoints, true); 
```

图像在 linux 服务器上的透视图失真，但是当我在 Windows 主机上移动脚本时，似乎发生以下错误：
**致命错误**：未捕获的异常 'ImagickException' 并带有消息 'Can't read argument array'

其中行是**$ im1->distortImage(Imagick::DISTORTION_PERSPECTIVE, $controlPoints, true);**

有没有办法让它在两个平台上都可以工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T17:50:39.827

似乎在我的 linux 服务器上我有以下 Imagick 版本：
ImageMagick 版本：ImageMagick 6.7.6-8 2012-05-02 Q16

和 Windows 服务器上：

ImageMagick 版本 ImageMagick 6.4.1 05/16/08 Q16

所以，在Windows 服务器 $controlPoints 数组必须将所有元素作为**INT**值。**在 linux 服务器和该图像魔法版本上，如果某些值是字符串**，则没有问题，因此问题的解决方案是将**$controlPoints**数组值转换为**int**值。

如果有人像我一样解决这个问题，希望它会有所帮助。

# c++ - C++ 预期的主表达式编译错误

> ID：11141466
> 
> 赞同：0
> 
> 时间：2012-06-21T15:24:20.340
> 
> 标签：c++, templates, boost, compilation, compiler-errors

```
#include <boost/format.hpp>
#include <boost/scoped_ptr.hpp>
#include <stdexcept>
#include <unordered_map>
#include <functional>
#define DECLARE_OBJECT(classname) namespace {core::declare_object<classname> __declarartion_#classname;}

namespace core {
  class dungeon;
  class object;
  typedef  std::function<object* (dungeon *)> object_creator;
  namespace  library_type {
    enum type {
      landscape = 0, walker, foe, bonus,object = 42
    };
  };
  struct library_error : public std::logic_error 
  {
    explicit library_error(const std::string &what) : std::logic_error(what) {};
  };
  template <enum  library_type::type type>
  class library {
  public:
    static library<type> *instance() {
      if (!m_instance)
        m_instance = new library<type>();
      return m_instance;
    }
    template<typename T>
    void add_object() {
      boost::scoped_ptr<T> obj(T::create(nullptr));
      m_library.insert(obj->name(), T::create);
    }
    const object_creator& get_object(const std::string &key) {
      auto lookup_iterator = m_library.find(key);
      if (lookup_iterator == m_library.end())
        throw library_error(boost::format("Object creator for key `%1%' not found\n") % key);
      return *lookup_iterator;
    }
  private:
    library () {};
    static library<type> *m_instance;
    std::unordered_map<std::string, object_creator> m_library;
  };
  template <enum library_type::type type>
  library<type>*  library<type>::m_instance;
  template <enum  library_type::type type, typename T>
  struct declare_object
  {
    declare_object() {
      auto instance = library<type>::instance();
      auto method = instance->add_object<T>;
      method();
    }
  };
};
int main()
{

} 
```

你好。这个简单的 C++0x 代码在`declare_object`构造函数中给了我错误

```
example.cpp: In constructor ‘core::declare_object<type, T>::declare_object()’:
example.cpp:52:43: error: expected primary-expression before ‘&gt;’ token
example.cpp:52:44: error: expected primary-expression before ‘;’ token 
```

我真的不知道我错在哪里。也许有清晰的观点和建议？很抱歉长时间列出。编辑：答案是`auto method = instance -> template add_object<T>;`。为什么你删除了你的答案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T15:42:32.877

```
 struct declare_object
  {
    declare_object() {
      auto instance = library<type>::instance();
      auto method = &library<type>::template add_object<T>;
      (instance->*method)();
    }
  }; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T16:07:47.450

要获得指向成员函数的指针，您需要遵循另一个答案中的语法。

由于成员函数也是一个模板，因此您需要指出这一点，因为它是一个从属名称：

```
auto method = &library_type<type>::template add_object<T>; 
```

否则，C++ 会将尖括号解析`add_object<T>`为小于和大于运算符。

# asp.net - 无法更改仅在 css asp.net 中具有图像 html 的 div 的背景颜色

> ID：11141471
> 
> 赞同：0
> 
> 时间：2012-06-21T15:24:27.503
> 
> 标签：asp.net, css, html, background-color

嗨
（我不是css专家的小问题）
我有一个div，如果我改变背景颜色它会成功改变它但是如果我添加图像那么它不会改变div的背景颜色这是我的代码

```
 <div class="Cartoon">
 <img src="App_Themes/White/Images/male.png" class="imgMale" />                 
 <div  class="male"><p>In a Nutshell|</p>
 <span>this is some text</span>
 </div>
 </div>

 <style type="text/css">
 .Cartoon
 {
 background-color: yellow;           
 }
 </style> 
```

（仅在 css 中没有 jQuery 和没有 Javascript）您可以查看此处的网址 parkticketpal.com/HowItWorks.aspx

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T12:34:31.937

尝试这个

`

```
<style type="text/css">

{
background-image:url('gradient2.png');
background-repeat:repeat-x;
}
</style> 
```

`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T15:30:27.977

您需要清除您的`.Cartoon div`，因为它包含浮动元素。

[我可以使用哪些“clearfix”方法？](https://stackoverflow.com/questions/211383/which-method-of-clearfix-is-best)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T15:31:27.320

您将看不到背景颜色，因为图像已经在背景上。尝试

```
.cartoon{
   background: yellow;
   z-index: 9999
} 
```

然后 div 在图像上方，以便您可以看到背景。

提示：尝试使 div 比图像大。

# android - 通话期间播放音乐

> ID：11141472
> 
> 赞同：0
> 
> 时间：2012-06-21T15:24:29.440
> 
> 标签：android

是否可以在通话期间在我的安卓手机上播放歌曲，而只有我正在与之交谈的人才能听到音乐？

# .net - 映射如何通过 .NET 中的 DataReader 通过 Load() 将数据读取到 DataTable？

> ID：11141473
> 
> 赞同：0
> 
> 时间：2012-06-21T15:24:30.890
> 
> 标签：.net, datatable, datareader

我正在使用 firebird .NET 提供程序，当我执行以下操作时：

```
DataTable.Load(FbCommand.ExecuteReader()); 
```

我会在调试输出中得到一些（可能是映射）查询到服务器。是真的，以这种方式使用这个工具会产生这个映射查询到 sql 服务器吗？调试输出[片段在这里](http://pastebin.com/QDrDkqGa)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T07:58:14.483

所以，我做了一些分析，发现了这个：

*   在 SQL Server 上，这只会产生一个查询
*   在 Firebird 上，这会产生 FbCommand 查询，然后根据列数产生其他额外的命令

# asp.net-mvc-3 - MVC3/4 Partial View 强制加载延迟加载的关系

> ID：11141478
> 
> 赞同：0
> 
> 时间：2012-06-21T15:24:37.573
> 
> 标签：asp.net-mvc-3, lazy-loading, partial-views

我创建了一个显示资产名称、水体名称和县名称的局部视图。局部视图基于 Asset 模型。如果我在**Assets/Detail**中，Detail 视图（与 Asset 模型一起使用）会像这样加载部分：
`@Html.Partial("Summary", Model)`

一切都很好，所有三个字段都加载了。

如果我在使用 AccessInspection 模型的**AccessInspections/Edit**中，则部分加载如下：
`@Html.Partial("Summary", Model.Asset)`

但是，不会加载 AccessInspection.Asset.Waterbody.Name 和 AccessInspection.Asset.County.Name。（我确实得到了 Asset.Name 值。）

这些模型的相关性如下：

资产
.AssetType (Single)
.LandLocation (Single)
..Waterbody (Single)
...ID
...名称
..County
...ID
...County
.AccessInspections (Collection)

我猜这与延迟加载有关。如何强制相关数据通过？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T15:50:03.020

在整理了一些东西之后，这就是我必须做的。
在 Assets 中，我可以按原样使用 Summary（移回 Views\Assets 文件夹），像这样传递模型：
`@Html.Partial("Summary", Model)`

在 Views\AccessInspections 中，我必须为部分调用 @Html.Action，但控制器必须指定 return PartialView(asset) 才能将其正确解析为部分。我可以这样称呼它：
`@Html.Action("Summary", "Assets", new { id = Model.Asset.Id })`

控制器代码如下所示：

```
public ActionResult Summary(int id = 0)
{  
    Asset asset = db.Assets.Find(id);  
    if (asset == null)  
    {  
        return HttpNotFound();  
    }  
    return PartialView(asset);  
} 
```

# java - 具有依赖关系的可执行 Jar 的安装程序包装器

> ID：11141479
> 
> 赞同：2
> 
> 时间：2012-06-21T15:24:37.520
> 
> 标签：java, installation, executable-jar

我用 Java（可执行 JAR）编写了一个程序，需要为它创建一个安装程序。安装人员需要具备以下素质：

1.  必须在 Windows 和 Mac 环境中工作。
2.  允许通常的“下一步 -> 下一步 -> 安装”安装程序提示。（方便客户使用）
3.  必须允许精确放置外部依赖项。

注意（#3）：许多外部依赖项需要放在与可执行 jar 相同的目录中，程序才能正常工作。

如果它易于配置，那就太好了。它不一定是免费的，如果它花费几美元并且非常简单，请包含它。

谢谢。

编辑：请不要“那很愚蠢，重新设计”评论/答案。我没有选择使用外部依赖项来制作程序，它是我的雇主出于某些原因指定的。我按照他们的方式去做，否则他们会找到其他愿意的人。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T15:28:19.273

使用[IzPack](http://izpack.org/)。它是免费的，并且允许为 Windows 和 MacOS 构建安装程序。不确定#3 的要求，但它是一个安装程序，因此您应该能够只向它提供文件，并为它们指定安装路径。

# file - 泽西文件上传

> ID：11141481
> 
> 赞同：1
> 
> 时间：2012-06-21T15:24:40.093
> 
> 标签：file, file-upload, jersey, inputstream

我尝试将文件上传到我的球衣服务器，但出现错误。

```
 Writer output = null;
    File file = null;
    try {
      String text = "Rajesh Kumar";
      file = new File("write.txt");
      output = new BufferedWriter(new FileWriter(file));
        output.write(text);
        output.close();
    } catch (IOException e) {
        e.printStackTrace();
    }

    InputStream is = null;

    try {
        is = new FileInputStream(file);
        is.close(); 
    } catch (FileNotFoundException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }

    FormDataMultiPart part = new FormDataMultiPart().field("file", is, MediaType.TEXT_PLAIN_TYPE);
    System.out.println(is);
    System.out.println(tenant1.getTenantId());
    System.out.println(part);
    String response = service.path("rest").path("file").type(MediaType.MULTIPART_FORM_DATA_TYPE).post(String.class, part); 
```

Syso 不为空。所以文件被写入输入流。

错误：

```
ClientHandlerException: java.io.IOException: ReadError , when I send it to the server. 
```

服务器端：

```
@POST
@Path("/file")
@Consumes(MediaType.MULTIPART_FORM_DATA)
public Response postFileTenant(@FormDataParam("file") InputStream stream) throws IOException {

    // save it

    return Response.ok(IOUtils.toString(stream)).build();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T15:28:02.743

您正在传递一个已关闭的 InputStream，因此显然 Jersey 运行时无法从中读取。从代码中删除`is.close();`行。

# java - PrimeFaces 脸书、推特请求

> ID：11141483
> 
> 赞同：1
> 
> 时间：2012-06-21T15:24:41.390
> 
> 标签：java, jsf, primefaces

我将我的项目从 2.2 版迁移到最新的 Primefaces 3.3.1。

成功迁移后，在每个 http 请求中，我都看到浏览器向 facebook、twitter 发送请求并从公司网站下载图片？

我在我的项目中没有关于这些网站的任何参考，并且我在旧版本的 Primeface 中没有这些请求。另外，我注意到我有与我的项目创建的那些网站相关的 cookie。

如何禁用此选项？

# visual-studio-2010 - 如何在 VS2010 RDLC 报告中添加组页脚

> ID：11141489
> 
> 赞同：3
> 
> 时间：2012-06-21T15:24:52.313
> 
> 标签：visual-studio-2010, rdlc

如何向我在 VS2010 RLDC 中创建的组添加“组页脚”摘要行。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-21T15:25:40.517

在设计器的底部有行组和列组单击行组旁边的箭头，然后单击“添加总计”。这会添加一个页脚行...

但请注意...

如果您在最外面的组上执行此操作，它会添加一个“报告页脚”，显示所有组的总数，而不是每个组。如果您在内部组上执行此操作，它会添加一个“组页脚”，为您提供每个子组的小计。

您也可以右键单击详细信息行（有 3 条水平线的最左边的框），然后转到插入行-> 下方...如果您有一个内部组和一个外部组，则会添加一个“组页脚”（我还没有在没有外部组的情况下对其进行测试）。

![如何添加页脚方法 2](../Images/103e2674c1d970665682c5c7a16900af.png)

这是一个快速而肮脏的图表（对质量感到抱歉），一旦设置好它们就会显示所有部件，这样会更有意义）

![全部零件图](../Images/a8fd9165a761ed8559cc83fc193757ee.png)

# opencv - 使用 OpenCV 进行并行 GPU 计算

> ID：11141492
> 
> 赞同：13
> 
> 时间：2012-06-21T15:25:10.220
> 
> 标签：opencv, parallel-processing, cuda, gpgpu

我有一个应用程序需要并行处理多个图像以保持实时速度。

据我了解，我不能在单个 CUDA 设备上以多线程方式调用 OpenCV 的 GPU 函数。我尝试了一个 OpenMP 代码结构，如下所示：

```
#pragma omp parallel for
for(int i=0; i<numImages; i++){
    for(int j=0; j<numChannels; j++){
        for(int k=0; k<pyramidDepth; k++){
            cv::gpu::multiply(pyramid[i][j][k], weightmap[i][k], pyramid[i][j][k]);
        }
    }
} 
```

这似乎可以正确编译和执行，但不幸的是，它似乎是在同一个 CUDA 设备上串行执行 numImages 线程。

如果我有多个 CUDA 设备，我应该能够并行执行多个线程，对吗？为了获得多个 CUDA 设备，我需要多个视频卡吗？

有谁知道 nVidia GTX 690 双芯片卡是否可以作为两个独立的 CUDA 设备使用 OpenCV 2.4 或更高版本？我发现确认它可以与 OpenCL 一起工作，但没有关于 OpenCV 的确认。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-22T14:45:46.910

只需将整个图像传递给`cv::gpu::multiply()`函数。

OpenCV 和 CUDA 将处理拆分它并以最佳方式划分任务。通常，GPU 中的每个计算机单元（即核心）可以运行多个线程（在 CUDA 中通常 >=16）。这是除了拥有可以显示为多个 GPU 的卡或将多个链接的卡放在一台机器中之外的。

的全部意义`cv::gpu`在于使您不必了解内部结构的工作原理。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-26T00:18:23.953

马丁的回答对我有用。如果您的 CUDA 设备被列为计算能力 2 或更高，则关键是要使用 gpu::Stream 类。我将在这里重述它，因为我无法在评论迷你编辑器中正确发布代码剪辑。

```
cv::gpu::Stream stream[3];

for(int i=0; i<numImages; i++){
    for(int j=0; j<numChannels; j++){
        for(int k=0; k<pyramidDepth; k++){
            cv::gpu::multiply(pyramid[i][j][k], weightmap[i][k], pyramid[i][j][k], stream[i]);
        }
    }
} 
```

上面的代码似乎并行执行乘法（我的应用程序为 numImages = 3）。还有一些 Stream 方法可以帮助从 GPU 内存上传/下载图像，以及检查流状态以帮助与其他代码同步的方法。

所以......它显然不需要多个 CUDA 设备（即 GPU 卡）来并行执行 OpenCV GPU 代码！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T19:20:10.753

我对 OpenCV 的 GPU 函数一无所知，但如果它们是完全自包含的（即创建 GPU 上下文、将数据传输到 GPU、计算结果、将结果传输回 CPU），那么这些函数出现序列化也就不足为奇了使用单个 GPU 时。

如果您有多个 GPU，那么应该有一些方法可以告诉 OpenCV 函数以特定 GPU 为目标。如果您有多个 GPU 并且可以有效地定位它们，那么我认为没有理由不并行化 GPU 函数调用。根据 OpenCV wiki，GPU 功能仅针对单个 GPU，但您可以自己手动拆分工作：http: [//opencv.willowgarage.com/wiki/OpenCV%20GPU%20FAQ#Can_I_use_two_or_more_GPUs.3F](http://opencv.willowgarage.com/wiki/OpenCV%20GPU%20FAQ#Can_I_use_two_or_more_GPUs.3F)

就您的 GPU 程序而言，像 GTX 690 这样的双 GPU 将显示为两个具有自己内存的不同设备。见这里： http: [//forums.nvidia.com/index.php?showtopic=231726](http://forums.nvidia.com/index.php?showtopic=231726)

此外，如果您要为计算应用程序采用双 GPU 路线，我建议您不要使用 GTX 690，因为与 GTX 590 相比，它的计算性能有所削弱。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-22T14:06:49.980

无论您使用哪个 OpenCV 版本，GTX 290 都充当 2 个独立的 CUDA 设备。您不需要多个 GPU 卡来获得多个 GPU，例如在 GTX 290 中，一张卡上有 2 个。但是，从 CUDA 编程的角度来看，在 290 上使用两个 GPU 和使用2 个 GPU 在单独连接的 GPU 卡上。许多 OpenCV 用户使用 ArrayFire CUDA 库来补充更多的图像处理功能和简单的多 GPU 缩放。当然，我的免责声明是我在 ArrayFire 上工作，但我确实认为在这种情况下它会对你有所帮助。

# python - 如何通过 Elementtree 检查属性是否存在？

> ID：11141494
> 
> 赞同：12
> 
> 时间：2012-06-21T15:25:14.370
> 
> 标签：python, xml, elementtree

我需要检查某些属性是否存在。喜欢：

```
if "blah-blah-blah" is None:
    print "there is no such attribute"
else:
    print "The attribute exists" 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-06-21T15:30:00.230

`Element`[`attrib`](http://docs.python.org/library/xml.etree.elementtree.html#xml.etree.ElementTree.Element.attrib)对象具有字典中的所有属性。

```
if 'blah' not in elem.attrib:
   print "there is no such attribute" 
```

# python - 如何在 FUSE Python 中实现近距离通话

> ID：11141495
> 
> 赞同：3
> 
> 时间：2012-06-21T15:25:19.210
> 
> 标签：python, fuse

我基于 FUSE 的文件系统是由 SQLite 数据库支持的。我无法关闭“文件”。

mymachine@ubuntu:~/Desktop/FUSE/dedup/myfs$ cat gump batman 返回cat：gump：输入/输出错误 cat：gump：输入/输出错误

strace 给出以下输出：

```
open("gump", O_RDONLY|O_LARGEFILE)      = 3
fstat64(3, {st_mode=S_IFREG|0777, st_size=15, ...}) = 0
read(3, "batman returns", 32768)        = 14
write(1, "batman returns", 14batman returns)          = 14
read(3, 0x9e41000, 32768)               = -1 EIO (Input/output error)
write(2, "cat: ", 5cat: )                    = 5
write(2, "gump", 4gump)                     = 4
open("/usr/share/locale/locale.alias", O_RDONLY) = 4
fstat64(4, {st_mode=S_IFREG|0644, st_size=2570, ...}) = 0
mmap2(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0xb773e000
read(4, "# Locale name alias data base.\n#"..., 4096) = 2570
read(4, "", 4096)                       = 0
close(4)                                = 0
munmap(0xb773e000, 4096)                = 0
open("/usr/share/locale/en_US/LC_MESSAGES/libc.mo", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/usr/share/locale/en/LC_MESSAGES/libc.mo", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/usr/share/locale-langpack/en_US/LC_MESSAGES/libc.mo", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/usr/share/locale-langpack/en/LC_MESSAGES/libc.mo", O_RDONLY) = -1 ENOENT (No such file or directory)
write(2, ": Input/output error", 20: Input/output error)    = 20
write(2, "\n", 1
)                       = 1
close(3)                                = -1 EIO (Input/output error)
write(2, "cat: ", 5cat: )                    = 5
write(2, "gump", 4gump)                     = 4
write(2, ": Input/output error", 20: Input/output error)    = 20
write(2, "\n", 1
)                       = 1
close(1)                                = 0
close(2)                                = 0
exit_group(1)                           = ? 
```

以下是主要 FUSE API 实现的 Python 代码：

```
def open(self, path, flags):
    print "open: trying to open %s"  %path
    sefs = seFS()
    ret = sefs.search(path)
    print ret
    if ret is True:
        return 0
    return -errno.ENOENT

def create(self, path, flags=None, mode=None):
    print "trying to create %s", path
    print path
    print flags

    sefs = seFS()
    ret = self.open(path, flags)
    print ret

    if ret == -errno.ENOENT:
        # Create the file in database
        ret = sefs.open(path)
        print ret
        print "Creating the file %s" %path
        t = int(time.time())
        mytime = (t, t, t)
        ret = sefs.utime(path, mytime)
        print ret
        self.fd = len(sefs.ls())
        print "In create:fd = %d" %(self.fd)
        sefs.setinode(path, self.fd)
        print sefs.ls()
    else:
        print "The file %s exists!!" %path
    return 0

def write(self, path, data, offset):
    print "In write path=%s" %path
    length = len(data)
    print "The data is %s len=%d offset=%d" %(str(data), length, offset)
    sefs = seFS()
    out_stream = StringIO();

    old_data = sefs.read(path)

    if old_data is not None:
        offset = len(old_data)
        out_stream.write(old_data)
    else:
        offset = 0

    out_stream.seek(offset)
    out_stream.write(data)

    print "Seeking and getting string"
    out_stream.seek(0)
    mydata = out_stream.read()

    ret = sefs.write(path, mydata)
    return length

def release(self, path, fh=None):
    print "In release %s" %(path)
    return 0

def read(self, path, length, offset, fh=None):
    print "In read %s %d %d" %(path, length, offset)
    sefs = seFS()
    ret = sefs.read(path)
    print "read(): sefs:%s" %(str(ret))
    if ret is not None:
        fbuf = StringIO()
        fbuf.write(str(ret).strip())
        fbuf.seek(offset)
        val = fbuf.read()
        fbuf.close()
        del fbuf
        return val
    else:
        return ""

def flush(path, fh=None):
    print "in flush"
    return 0 
```

# php - 我如何使用 php 跟踪热链接器的 ip 地址

> ID：11141496
> 
> 赞同：4
> 
> 时间：2012-06-21T15:25:23.670
> 
> 标签：php, .htaccess

在我的服务器中有一张名为 /images/pic.jpg 的图片。我想跟踪尝试通过 url 直接访问该图片的用户的 IP 地址，例如 www.domain.com/images/pic.jpg。我可以通过以下方式跟踪手动用户的 IP 地址：

```
<?php $ipAddress = $_SERVER['REMOTE_ADDR']; ?> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-21T15:39:07.463

您可以创建一个拦截 PHP 脚本，该脚本将负责处理对存储在特定文件夹中的图像的所有请求。假设您的所有图像都位于`images/`文件夹内。您只需要创建一个重写规则，它将对该文件夹内文件的所有请求重定向到 PHP 脚本。

```
RewriteRule images/(.+)\.(jpg|gif|png) images.php?image=$1.$2 
```

这样，您仍然可以像以前一样在标记中使用图像。

```
<img src="images/logo.png" /> 
```

请考虑到这种方法可能会对您的系统性能产生重大影响，因为由于每次都调用 PHP，所有对图像资源的请求现在都会产生处理开销。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-21T15:28:03.290

如果他们直接访问图像，那么除了解析您的 access_logs 并查看谁在请求文件之外，您无法使用 PHP 进行任何操作来跟踪它们。

您最好的选择是使用 PHP 来提供图像本身。这样您就可以通过 PHP 跟踪谁在请求它。

例子：

```
<img src="image.php?imagename.jpg"> 
```

# r - 让自定义类在添加插槽时进行验证

> ID：11141498
> 
> 赞同：2
> 
> 时间：2012-06-21T15:25:29.080
> 
> 标签：r

假设我想创建一个带有两个插槽 A 和 B 的类“myClass”。

现在我想要一个validObject函数来确保A和B的长度相同

```
same_length <- function(object){
    if(length(object@A)!=length(object@B)) {
        "vectors are not the same length"
     } else TRUE
}

setClass("myClass", representation(A="numeric", B="numeric"),
          validity=same_length) 
```

我在某处看到了一个函数，可以确保类在初始化时有效：

```
setMethod("initialize", "myClass", function(.Object, ...){
    value <- callNextMethod()
    validObject(value)
    value
}) 
```

如果我尝试会发送错误

> newObj <- new("myClass", A=c(1,2,3), B=c(1,2))

但如果我这样做

```
newObj <- new("myClass")
newObj@A <- c(1,2,3)
newObj@B <- c(1,2) 
```

没有错误被抛出。一旦新的插槽分配未验证，我如何让它抛出错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T16:05:55.083

编写一个进行检查的“替换方法”。为此，我们需要创建一个通用函数（因为不存在具有适当名称和签名的函数）

```
setGeneric("slotA<-", function(x, ..., value) standardGeneric("slotA<-")) 
```

然后，我们需要为我们想要处理的特定类型的对象实现替换方法——第一个参数属于“myClass”类，第二个参数 ( `value`) 属于“numeric”类：

```
setReplaceMethod("slotA", c("myClass", "numeric"), function(x, ..., value) {
    x@A = value
    validObject(x)
    x
}) 
```

我们还可以编写一个“getter”泛型和方法

```
setGeneric("slotA", function(x, ...) standardGeneric("slotA"))
setMethod("slotA", "myClass", function(x, ...) x@A) 
```

进而

```
> a=new("myClass", A=1:10, B=10:1)
> slotA(a)
 [1]  1  2  3  4  5  6  7  8  9 10
> slotA(a) = 1:5
Error in validObject(x) : 
  invalid class "myClass" object: vectors are not the same length 
```

请注意，默认`initialize`方法调用`checkValidity`，因此如果您将`callNextMethod`其用作构造函数的最后一行，则无需显式检查有效性。

# python - 在 bash 脚本中运行 Python 脚本

> ID：11141502
> 
> 赞同：0
> 
> 时间：2012-06-21T15:25:42.850
> 
> 标签：python, bash

当我尝试在 bash 中运行脚本时，我遇到了一个小问题。首先，当我在终端中运行时，我的脚本运行良好，但是当我尝试在 Ubuntu 中通过启动器运行时，出现此错误

" `python: can't open file 'teste.py': [Errno 2] No such file or directory`"

我的脚本类似于：

```
 #! /bin/bash
 # This script use sample.py
 python sample.py games.txt
 sleep 15 
```

其他信息：

```
Ubuntu 11.04
Python 2.7 
```

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T15:27:32.030

从错误消息看来，您必须在启动器中指定脚本的完整路径。

尝试在 bash 脚本中添加命令的完整路径，即类似于：

```
 python /home/glc/sample.py /home/glc/games.txt 
```

顺便问一下，这个文件是什么`teste.py`？在您的帖子中，您提到了脚本`sample.py`- 这是一个不同的文件吗？它是如何连接的？您是否可能在启动器中指定了错误的文件名？

# c - 函数的隐式声明？

> ID：11141504
> 
> 赞同：0
> 
> 时间：2012-06-21T15:25:54.257
> 
> 标签：c, declaration, implicit

我仍在学习 C，并且我知道要摆脱大多数隐式声明警告，您可以在开头添加原型标头。但是当您在代码中使用外部方法时，我对您会做什么感到困惑。

这是我使用外部方法时的代码

```
 #include <stdio.h>
    #include <string.h>
    int main(void)
    {
      int arrayCapacity = 10;
      int maxCmdLength = 20;

      int A[arrayCapacity];
      int count = 0; /* how many ints stored in array A */
      char command[maxCmdLength + 1]; 
      int n;

      while (scanf("%s", command) != EOF)
      {

         if (strcmp(command, "insert") == 0)
         {  
             scanf("%d", &n);                   
             insert (n, A, arrayCapacity, &count);
             printArray(A, arrayCapacity, count);
         }
         else if (strcmp(command, "delete") == 0)
         {

             scanf("%d", &n);
             delete(n,A,&count);
             printArray(A, arrayCapacity, count);

        }       
        else
        {
             scanf("%d", &n);
             printArray(A, arrayCapacity, count);
        }
     }
     return 0;
    } 
```

方法`printArray`，插入和删除都采用以下形式：`printArray.o, insert.o, delete.o`

这就是我编译程序的方式：`gcc -Wall insert.o delete.o printArray.o q1.c` 我收到以下警告：

```
q1.c: In function âmainâ:
q1.c:20: warning: implicit declaration of function `insert'
q1.c:21: warning: implicit declaration of function `printArray'
q1.c:30: warning: implicit declaration of function `delete' 
```

我已经尝试将它包含在标题中，但我收到错误提示找不到文件或目录。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T15:31:44.510

将它们放在头文件中`foo.h`，如下所示：

```
 extern void printArray(int *A, int capacity, int count);
 ... 
```

然后将该文件包含在您的源代码中

```
 #include "foo.h" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T15:42:27.427

您应该能够像在同一文件中的其他函数一样，将函数原型放在文件顶部。链接器应该负责其余的工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T15:28:13.947

您需要包含正确的标题才能消除此类警告。

如果您收到“找不到文件”错误，请尝试将它们包含为

```
#include "myheader.h" 
```

并将您的头文件放在与源代码相同的目录中。

一般来说，`#include "file"`is 用于程序员定义的标头，而`#include <file>`is 或标准标头。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-21T16:05:08.670

你从哪里得到这些`.o`文件的？如果您自己编写了它们，那么您应该创建相应的`.h`文件。如果您从其他地方获得这些文件，那么您应该在同一个地方搜索标题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-03-04T14:32:17.650

如果所有被调用的函数都写在 **main()**函数之前，编译器将知道它们的名称、返回类型和参数签名，并且可以将所有这三个属性与每个后续函数调用匹配。

有些程序员喜欢先写一个函数签名，然后再实现。

唯一需要函数声明的情况是在使用协同例程时：functionA 调用 functionB，而后者又调用 functionA。

完成如下：

```
type a(...signatureOfA...)

/* compiler now knows about a() */

type b(...signatureOfB...)
{…
// implementation of b
a(…arguments for a…);

/* compiler knows about above */
 …}

type a(...signatureOfA...)i
{…
// implementation of a
b(…arguments for b…);

/* compiler knows about above */
 …}

int main()
{
a(… arguments for a…);
/* compiler knows */
return(code);
} 
```

# php - 如何绕过twilio中的应答机

> ID：11141506
> 
> 赞同：0
> 
> 时间：2012-06-21T15:25:55.350
> 
> 标签：php, xml, twilio, twilio-twiml

我想从我的 Twilio 号码向客户发起呼叫，并使用[<Say>](http://twilio.com/docs/api/twiml/say)动词说些什么。

它对我来说很好，但是有些客户有应答机，他们无法接听电话并听动词。

如何让 Twilio 绕过应答机？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T15:54:06.537

有一个参数，但它不是很可靠。

参数是[IfMachine](http://www.twilio.com/docs/api/rest/making-calls#handling-outcomes-answering-machines)。像这样将它添加到 HTTP POST：

```
POST https://api.twilio.com/2010-04-01/Accounts/AC123/Calls
IfMachine=true&From=+1XXX&To=+1XXX&Url=http://example.com/twiml 
```

# sql - 如何在 SQL Server 中生成日期范围

> ID：11141507
> 
> 赞同：12
> 
> 时间：2012-06-21T15:25:57.363
> 
> 标签：sql, sql-server, tsql

标题并没有完全表达我的意思，这可能是重复的。

这是长版本：给定客人的姓名、他们的注册日期和他们的结帐日期，我如何为他们作为客人的每一天生成一行？

例如：Bob 于 7/14 入住并于 7/17 离开。我想

```
('Bob', 7/14), ('Bob', 7/15), ('Bob', 7/16), ('Bob', 7/17) 
```

作为我的结果。

谢谢！

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-06-21T15:35:08.143

我会争辩说，对于这个特定目的，下面的查询与使用专用查找表一样有效。

```
DECLARE @start DATE, @end DATE;
SELECT @start = '20110714', @end = '20110717';

;WITH n AS 
(
  SELECT TOP (DATEDIFF(DAY, @start, @end) + 1) 
    n = ROW_NUMBER() OVER (ORDER BY [object_id])
  FROM sys.all_objects
)
SELECT 'Bob', DATEADD(DAY, n-1, @start)
FROM n; 
```

结果：

```
Bob     2011-07-14
Bob     2011-07-15
Bob     2011-07-16
Bob     2011-07-17 
```

* * *

大概你需要这个作为一个集合，而不是单个成员，所以这里有一种适应这种技术的方法：

```
DECLARE @t TABLE
(
    Member NVARCHAR(32), 
    RegistrationDate DATE, 
    CheckoutDate DATE
);

INSERT @t SELECT N'Bob', '20110714', '20110717'
UNION ALL SELECT N'Sam', '20110712', '20110715'
UNION ALL SELECT N'Jim', '20110716', '20110719';

;WITH [range](d,s) AS 
(
  SELECT DATEDIFF(DAY, MIN(RegistrationDate), MAX(CheckoutDate))+1,
    MIN(RegistrationDate)
    FROM @t -- WHERE ?
),
n(d) AS
(
  SELECT DATEADD(DAY, n-1, (SELECT MIN(s) FROM [range]))
  FROM (SELECT ROW_NUMBER() OVER (ORDER BY [object_id])
  FROM sys.all_objects) AS s(n)
  WHERE n <= (SELECT MAX(d) FROM [range])
)
SELECT t.Member, n.d
FROM n CROSS JOIN @t AS t
WHERE n.d BETWEEN t.RegistrationDate AND t.CheckoutDate;
----------^^^^^^^ not many cases where I'd advocate between! 
```

结果：

```
Member    d
--------  ----------
Bob       2011-07-14
Bob       2011-07-15
Bob       2011-07-16
Bob       2011-07-17
Sam       2011-07-12
Sam       2011-07-13
Sam       2011-07-14
Sam       2011-07-15
Jim       2011-07-16
Jim       2011-07-17
Jim       2011-07-18
Jim       2011-07-19 
```

正如@Dems 指出的那样，这可以简化为：

```
;WITH natural AS 
(
  SELECT ROW_NUMBER() OVER (ORDER BY [object_id]) - 1 AS val 
  FROM sys.all_objects
) 
SELECT t.Member, d = DATEADD(DAY, natural.val, t.RegistrationDate) 
  FROM @t AS t INNER JOIN natural 
  ON natural.val <= DATEDIFF(DAY, t.RegistrationDate, t.CheckoutDate); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-21T15:37:10.927

我通常通过在某个表上使用 row_number() 的技巧来做到这一点。所以：

```
select t.name, dateadd(d, seq.seqnum, t.start_date)
from t left outer join
     (select row_number() over (order by (select NULL)) as seqnum
      from t
     ) seq
     on seqnum <= datediff(d, t.start_date, t.end_date) 
```

seq 的计算非常快，因为不需要计算或排序。但是，您需要确保表对于所有时间跨度都足够大。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-25T04:54:16.423

如果您有一个“Tally”或“Numbers”表，那么对于这样的事情来说，生活会变得非常简单。

```
 SELECT Member, DatePresent = DATEADD(dd,t.N,RegistrationDate)
   FROM @t 
  CROSS JOIN dbo.Tally t
  WHERE t.N BETWEEN 0 AND DATEDIFF(dd,RegistrationDate,CheckoutDate)
; 
```

这是构建“Tally”表的方法。

```
--===================================================================
--      Create a Tally table from 0 to 11000
--===================================================================
--===== Create and populate the Tally table on the fly.
 SELECT TOP 11001
        IDENTITY(INT,0,1) AS N
   INTO dbo.Tally
   FROM Master.sys.ALL_Columns ac1
  CROSS JOIN Master.sys.ALL_Columns ac2
;
--===== Add a CLUSTERED Primary Key to maximize performance
  ALTER TABLE dbo.Tally
    ADD CONSTRAINT PK_Tally_N 
        PRIMARY KEY CLUSTERED (N) WITH FILLFACTOR = 100
;
--===== Allow the general public to use it
  GRANT SELECT ON dbo.Tally TO PUBLIC
;
GO 
```

有关什么是 SQL 中的“Tally”表以及如何使用它来替换 While 循环和重要的递归 CTE 的“隐藏 RBAR”的更多信息，请参阅以下文章。

[http://www.sqlservercentral.com/articles/T-SQL/62867/](http://www.sqlservercentral.com/articles/T-SQL/62867/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-21T15:30:42.390

这可能对你有用：

```
with mycte as
 (
     select cast('2000-01-01' as datetime) DateValue, 'Bob' as Name
     union all
     select DateValue + 1 ,'Bob' as Name
     from    mycte   
     where   DateValue + 1 < '2000-12-31'
 )
 select *
from    mycte
OPTION (MAXRECURSION 0) 
```

* * *

## 回答 #5

> 赞同：-5
> 
> 时间：2012-06-21T15:31:47.820

我会创建一个触发器来创建额外的记录并在结帐时运行它。或者，您可以每天午夜做同样的工作（如果您需要数据库中的最新信息）。

# jquery - onchange 显示/更改部分

> ID：11141509
> 
> 赞同：4
> 
> 时间：2012-06-21T15:26:11.473
> 
> 标签：jquery, ruby-on-rails, selectionchanged

有一个使用选择的下拉菜单

```
<%= select("array", "folder", @rows.keys, {}, :onchange =>"?" )%> 
```

有一种局部叫“形”

```
<%= render "form"%> 
```

I need to render the partial whenever there is a change in the selection. 请让我知道是否有办法做到这一点。我发现`remote_function`Rails 3.0 已弃用。我在这里看到了所有带有 onchange 和 select 标签的可能链接，但找不到正确的答案。我是 Rails、jQuery 和 Ajax 的新手。请帮忙

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-21T16:16:17.897

肯定有一种方法可以做到这一点，而且需要一些工作，但是一旦掌握了它就很容易了。

首先，您需要将一个 jQuery 函数附加到`change`您的选择框的事件中。这可以通过在`application.js`文件中添加一些 javascript 来完成。我们想在这里这样做，所以我们的 javscript 保持[**不引人注目**](http://railscasts.com/episodes/205-unobtrusive-javascript)。你可以在你的`application.js`文件中尝试这样的事情：

```
$(document).ready(function(){
  $("#select_field_id").change(function(){
    var id = $(this).children(":selected").val();
    var params = 'some_id=' + id;
    $.ajax({
      url: "/some_controller/change_folder",
      data: params
    })
}); 
```

这样做是将匿名函数附加到`change`具有 id 的选择字段的事件`select_field_id`。当该字段更改时，`id`所选选项的 var 存储在 var`id`中，然后我们为将要发送的请求创建一个参数 do `var params = 'some_id=' + id;`。`some_id`将是您正在更改的任何内容的 id （`folder_id`如果这是您在示例中使用的内容）。

现在我们需要在控制器中创建将处理此请求的方法。因此，使用文件夹示例，将其添加到文件夹控制器：

```
def change_folder
  @folder = Folder.find(params[:some_id])
  respond_to do |format|
    format.js
  end
end 
```

这只是根据您的 ajax 请求发送到的 id 找到一个文件夹`change_folder`。它还将寻找相应的`change_folder.js.erb`或`change_folder.js`文件来渲染。

现在我们需要编写一个`change_folder.js.erb`文件。我们需要用我们获得的新文件夹替换页面某些部分的 HTML，因此您应该有某种`div`或其他具有唯一 ID 的部分。

在里面`change_folder.js.erb`，我们可以这样写：

```
$('#your_div').html("<%= escape_javascript(render(partial: "folder", 
locals: { :folder => @folder })).html_safe %>") 
```

`_folder.html.erb`这将呈现与文件位于同一目录中的部分调用`change_folder.js.erb`。部分将需要使用 @folder 变量来显示字段，因此您需要以下内容：

```
<%= @folder.name %>
<%= @folder.last_updated %> 
```

在你的`_folder.html.erb`偏里面。当然只是由文件夹模型的属性组成`.name`。`.last_updated`您将不得不使用您为文件夹模型提供的任何属性。

这应该让你去你需要去的地方。如果您需要任何澄清，请告诉我。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T16:06:57.617

为什么不在同一页面中呈现表单并在**更改****选择标签**时隐藏和显示它

 **```
<html> 
  <body>

  <!-- Your Select tag -->
  <select id="select_id"> 
    <option value="one" selected> One </option>
    <option value="two"> Two </option>
  </select>

  <!-- Here your a div inside with your form is placed -->
  <div id="myform" style="display:none">
    <form action="/someurl">
      .. ..
    </form> 

   <!-- JQuery code to  show the form -->
  <script type="text/javascript">
    $(document).ready(function() {
       $("select#select_id").bind("change",function() {
         if ($(this).val() == "one") 
          $("div#myform").show(); 
         else
          $("div#myform").hide(); 
       })
   })

  </script>

</html> 
```

我你还想提出一个ajax请求我也很简单

```
$(document).ready(function() {
  $("select#select_id").bind("change",function() {
    if ($(this).val() == "one") {
     $.ajax({
        url : "/form_url",
        data : "html", 
        type: "GET",
        success : function(data) {
          $("div#myform").html(data)
        }
     }) 

  })
}) 
```

`format.js`在服务器端，您需要使用 render 命令来响应 ajax 请求并渲染模板，或者只定义一个`.js.erb`文件**

# django - Selenium 如何查看我无法从调试器中找到的记录？

> ID：11141510
> 
> 赞同：1
> 
> 时间：2012-06-21T15:26:12.173
> 
> 标签：django, unit-testing, selenium

我正在为我的应用程序创建 Selenium 测试。我可以创建一个新用户，但我似乎无法弄清楚如何将其从数据库中删除。

第一次成功运行测试后，后续测试失败，因为用户名已经存在。

**为什么我可以在页面上看到新记录，却无法在调试器中查询新创建的记录？**

**如何在测试中从数据库中删除记录？**

这就是我一直在做的事情：

```
from selenium import webdriver  
from django.utils import unittest  
from forum.models import Question, Answer, User  

class TestOSQAAuthentication(unittest.TestCase):  
    scheme = 'http'  
    host = 'localhost'  
    port = '4444'  

    def setUp(self):  
        self._driver = webdriver.Firefox()  
        self._driver.implicitly_wait(25)  

    def test_anon_can_create_new_account_manually(self):  
        self._driver.get('http://localhost:8000/account/local/register/')  
        self._driver.find_element_by_id('id_username').send_keys('MrManual')  
        self._driver.find_element_by_id('id_email').send_keys('test@gmail.com')  
        self._driver.find_element_by_id('id_password1').send_keys('test')  
        self._driver.find_element_by_id('id_password2').send_keys('test')  
        self._driver.find_element_by_id('bnewaccount').click()   
        # verify MrManual was created  
        self._driver.get('http://localhost:8000/users/')  
        self._driver.find_element_by_link_text('MrManual')  
        # MrManual seems to be created, but I don't see MrManual in the database during debugging with:  
        # import ipdb; ipdb.set_trace()  
        #ipdb> User.objects.all()  
        #[<User: Bryan>, <User: Kallie>, <User: Stalin>]  
        # here I am trying to delete the user from the database directly.
        User.objects.filter(username="MrManual").delete()  
        """For some reason I can't delete the record from the database from the test.  
        Selenium can find the new user in the browser, but I can't query the database to find it.""" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T20:43:41.637

如果您使用 Selenium，`django.utils.unittest.TestCase`请不要使用`django.test.TransactionalTestCase`，甚至更好，`LiveServerTestCase`.

# graphics - 如何将 3 个浮点数（空间向量）打包成 4 个字节（像素）？

> ID：11141515
> 
> 赞同：0
> 
> 时间：2012-06-21T15:26:17.990
> 
> 标签：graphics, packing

我已经成功地将浮点数与 [0,1] 中的值打包在一起，而不会使用以下方法丢失太多精度：

```
byte packedVal = floatVal * 255.0f ; // [0,1] -> [0,255] 
```

然后，当我想将packedVal 解压成一个浮点数时，我只需要做

```
float unpacked = packedVal / 255.0f ; // [0,255] -> [0,1] 
```

只要浮点数介于 0 和 1 之间，它就可以正常工作。

现在这是真正的交易。我正在尝试将 3d 空间向量（包含 3 个`float`组件）转换为 4 个字节。我这样做的原因是因为我使用纹理来存储这些向量，每个向量有 1 个像素。它应该*类似于*“法线贴图”，（但不完全是这个，你会在跳转后看到为什么）

![法线贴图](../Images/604dd69c321b6e9e8ee5ee0d1e5da112.png)

因此，每个像素代表一个 3d 空间向量。在值非常红的地方，法线向量的方向主要是 +x（向右）。

所以当然，法线是标准化的。因此它们不需要幅度（缩放）向量。但我试图存储一个具有*任意*大小的向量，每个像素 1 个向量。

因为纹理有**4 个**分量（rgba），所以我正在考虑在 w 分量中存储一个缩放向量。

将任意大小的 3 空间向量（比如 x、y、z 的大小上限为 200 左右）打包成 4 字节像素颜色值的任何其他建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-15T18:57:48.740

这种方法用于存储高动态范围的图像 - RGBM 编码（M 代表幅度）。它的缺点之一是插值结果错误，因此您不能对纹理使用双线性过滤。

您可以从 HDR 编码中寻找其他选项：[这里是一些最受欢迎的小列表](http://lousodrome.net/blog/light/2013/05/26/gamma-correct-and-hdr-rendering-in-a-32-bits-buffer/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T13:13:35.057

Storing the magnitude in the 4th component sounds very reasonable. As long as the magnitude is bounded to something reasonable and not completely arbitrary.

If you want a more flexible range of magnitudes you can pre-multiply the normalized direction vector by (0.5, 1.0] when you store it, and when you unpack it multiply it by pow(2, w).

# javascript - jquery .focus 不适用于输入：首先

> ID：11141525
> 
> 赞同：5
> 
> 时间：2012-06-21T15:26:42.140
> 
> 标签：javascript, jquery

我们遇到了一个问题，当我们打开一个模态窗口时，我们试图将焦点设置到模态中不是隐藏类型的第一个输入元素。这是我们正在尝试的：

```
$("#test-overlay input[type!=hidden]:first").focus(); 
```

但是，此调用有效：

```
$("#test-overlay #loginInput").focus(); 
```

输入字段的 id 为 loginInput。

有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T15:31:38.163

问题是由于 jQuery 解释选择器的优先顺序。尝试以下操作：

```
$('#test-overlay input').not('[type=hidden]').first().focus(); 
```

这有一个额外的好处，即不使用`:first`and 属性不等于选择器，因为它们是 jQuery 特定的，并且使用它们的查询不能利用本机 DOM querySelectorAll() 方法提供的性能提升。

# d3.js - AngularJS 应用程序中的 D3

> ID：11141528
> 
> 赞同：42
> 
> 时间：2012-06-21T15:26:46.927
> 
> 标签：d3.js, angularjs

我正在尝试使用 AngularJS 创建我的第一个应用程序。它看起来很整洁，但是有很多抽象，我很好奇是否有人对使用 Angular 方法来更新使用 d3js 创建的视觉效果的最惯用方式提出建议。

谢谢，bp

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-06-21T18:26:44.057

为了使 Angular 和其他框架运行良好，是使用指令包装“其他”框架。

[http://docs.angularjs.org/guide/directive](http://docs.angularjs.org/guide/directive)

您想要做的事情是在“其他”框架更新数据时告诉角度。如果 angular 不需要知道，那么你的任务就更简单了。

这是一个适用于 SVG 的示例，它很棒

[http://sullerandras.github.com/SVG-Sequence-Diagram/](http://sullerandras.github.com/SVG-Sequence-Diagram/)

这是一个包装 TinyMCE 的示例

[http://jsfiddle.net/programmieraffe/kjsEV/](http://jsfiddle.net/programmieraffe/kjsEV/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-30T21:51:45.057

也可以将 AngularJS 句柄栏语法直接插入到 d3 生成的元素中：

```
var containerDiv = d3.select(targetCSSSelectorForADiv);
var svgG = containerDiv
                                .append("svg")
                                .attr("width", width + margin.left + margin.right)
                                .attr("height", height + margin.top + margin.bottom)
                                .append("g")
                                .attr("transform", "translate(" + margin.left + "," + margin.top + ")")

 svgG.selectAll(".tempclass").data(scope.circles).enter()
                                .append("circle")
                                .attr("class", "tempclass")
                                .attr("cx", function (d, i) { return "{{circles[" + i + "].cx}}" })
                                .attr("cy", function (d, i) { return "{{circles[" + i + "].cy}}" })
                                .attr("r", function (d, i) { return "{{circles[" + i + "].radius}}" })
                                .attr("ng-style", function (d, i)
                                {
                                    return "{fill: circles[" + i + "].circolor"
                                        + ", opacity: circles[" + i + "].opa"
                                        + ", 'stroke-width': 4*circles[" + i + "].opa"
                                        + ", stroke: 'red' }";
                                }); 
```

请注意以下几点：范围实际上是从指令传递给渲染函数的角度范围对象。将元素的样式设置为“{{...}}”表达式将不起作用，因此我在这里使用“ng-style”属性。

但是还有一个技巧：您需要告诉 Angular 查看动态生成的 DOM 元素并连接数据绑定，我现在知道两种方法：

```
//the target div is the one with the angular ng-controller attribute 
//this you can call at the end of the d3 rendering call from within the render function
angular.bootstrap(document.getElementById("d3ContainerDivID"), ['d3App']); 
```

另一种方法是：

```
//and this could be called from the directive that triggered the rendering or
//some other place that could have the angular $compile service injected
$compile(document.getElementById("d3ContainerDivID"))(scope); 
```

现在您可以更改您的范围成员，它们将直接更新为您的 d3 元素，在本例中为 svg 圆圈。在角度控制器中（在绘制 d3 对象的指令触发之前实例化）。

```
 $scope.circles = [];
    for (var i = 0; i < 50; i++)
    {
        $scope.circles.push(new Circle());
    }
    setInterval(function ()
    {
        $scope.circles.forEach(function (d, i) { $scope.circles[i] = new Circle(); });
        $scope.$digest();
    }, 2000); 
```

请注意 $digest 调用，它告诉 Angular 消化更改的范围；这将改变 svg 圆形元素的值。对于动画之类的东西，d3 现在不再负责，必须手动实现或使用不同的模式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-07T14:41:25.423

您还可以按照本教程/截屏来了解如何将 D3 与 angular 一起使用。它有点不同，因为它使用了一个围绕 d3 的包装库，称为 rickshaw，它提供了一些特定于图形的东西，但方法完全相同：

[http://tagtree.tv/d3-with-rickshaw-and-angular](http://tagtree.tv/d3-with-rickshaw-and-angular)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-16T06:44:32.523

如果我们在指令中使用 d3 来生成具有其他 Angular 指令的元素（我认为您会发现这是一个相当普遍的要求），您可以`$compile`使用该方法在渲染过程的 UPDATE 阶段结束时调用`call()`。像这样（假设我们正在渲染一堆圆圈）：

```
mySvg.selectAll("circle")
                .data(scope.nodes)
                .enter()
                .append("circle")
                .attr("someDirective")
                .call(function(){
                    $compile(this[0].parentNode)(scope);
                }); 
```

# maven - maven-compiler-plugin 如何更改类目标目录

> ID：11141529
> 
> 赞同：9
> 
> 时间：2012-06-21T15:26:52.093
> 
> 标签：maven

默认情况下，maven 编译器插件将编译后的类放入`${project.build.directory}/classes`. 我想把它们放进`${project.build.directory}/myclasses`. 该参数`-d`更改已编译类的目标。我配置了插件，但出现错误：`javac: directory not found: C:\home\target/myclasses`.

```
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-compiler-plugin</artifactId>
    <version>2.3.2</version>
    <configuration>
        <source>1.5</source>
        <target>1.5</target>
        <showDeprecation>true</showDeprecation>
        <compilerArguments>
            <d>${project.build.directory}/myclasses</d>
        </compilerArguments>
    </configuration>
</plugin> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-21T15:59:04.703

你应该可以这样做：

```
<build>
    <outputDirectory>${project.build.directory}/myclasses</outputDirectory>
</build> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-21T16:01:49.883

目标文件夹必须存在。您可以使用 ant 任务创建它：

```
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-antrun-plugin</artifactId>
    <executions>
        <execution>
            <id>createClassesDir</id>
            <phase>process-resources</phase>
            <configuration>
                <tasks>
                    <mkdir dir="${project.build.directory}/myclasses" />
                </tasks>
            </configuration>
            <goals>
                <goal>run</goal>
            </goals>
        </execution>
    </executions>
</plugin> 
```

# sql - 从按查询分组的查询中选择最大值

> ID：11141537
> 
> 赞同：1
> 
> 时间：2012-06-21T15:27:16.627
> 
> 标签：sql, google-bigquery

我有一个查询：

```
select substr(name,7,50) as location, points,sum(if (p1=r1,10,-10))as total from
dq.data 
group by points,location order by location,total desc 
```

产生此数据：

```
FRANCE  |0|2|0|0|0|0|1  110.0    
FRANCE  |0|2|1|0|1|2|1  100.0    
FRANCE  |0|2|0|0|0|1|1  100.0    
FRANCE  |0|2|1|0|0|1|1  100.0    
FRANCE  |0|2|0|1|1|2|1  100.0    
FRANCE  |0|2|0|0|1|1|1  100.0
GERMANY |1|0|2|2|2|1|0  120.0    
GERMANY |1|0|2|2|2|0|0  110.0    
GERMANY |1|0|2|2|2|2|0  110.0    
GERMANY |1|0|2|2|2|0|2  110.0    
GERMANY |1|0|2|2|2|1|1  110.0 
```

我想达到最高`total`和`points`每个相关的`location`。

我应该最终得到：

```
FRANCE  |0|2|0|0|0|0|1  110.0
GERMANY |1|0|2|2|2|1|0  120.0 
```

我相信我需要使用子查询和`MAX(total)`，但我不能让它工作。在子查询中，我想选择`points`，但我不想按它分组，这显然是不允许的。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T15:33:15.750

你的直觉是正确的。您可以通过计算最大总数然后将其连接回原始数据来做到这一点：

```
select t.*
from (select substr(name,7,50) as location, points,sum(if (p1=r1,10,-10))as total
      from dq.data 
      group by points,location
     ) t join
     (select location, max(total) as maxtotal
      from (select substr(name,7,50) as location, points,sum(if (p1=r1,10,-10))as total
            from dq.data 
            group by points,location
           ) t
      group by location
     ) tsum
     on t.location = tsum.location and t.total = tsum.maxtotal 
```

请注意，如果顶部有联系，此版本将返回重复项。

我对 google-biggquery 并不十分熟悉。如果它支持“with”语句，那么您可以通过执行以下操作来简化查询：

```
with t as (select substr(name,7,50) as location, points,sum(if (p1=r1,10,-10))as total
           from dq.data 
           group by points,location
          )
select t.*
from t join
     (select location, max(total) as maxtotal
      from t
      group by location
     ) tsum
     on t.location = tsum.location and t.total = tsum.maxtotal 
```

如果它支持 windows 函数（例如 row_number()），那么您可以完全消除显式连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T15:39:02.323

我最近遇到了类似的问题，解决了类似的问题：

```
SELECT substr(name,7,50) as location, points,sum(if (p1=r1,10,-10))as total
FROM ( 
   SELECT * FROM dq.data ORDER BY location,sum(if (p1=r1,10,-10)) desc 
) tmp
GROUP BY points,location; 
```

不确定它是否会工作，因为我的数据库是 MySQL，但它是一个很好的直观解决方案。按照您希望汇总行退出的方式对子查询进行排序。

# java - 在Java中通过名称作为字符串访问变量的值

> ID：11141542
> 
> 赞同：6
> 
> 时间：2012-06-21T15:27:27.677
> 
> 标签：java

我有一个包含变量名的字符串。我想得到那个变量的值。

```
int temp = 10;
String temp_name = "temp"; 
```

`10`是否可以通过使用来访问该值`temp_name`？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-21T15:30:14.133

我建议您使用 a`Map<String, Integer>`代替：

通过执行创建地图

```
Map<String, Integer> values = new HashMap<String, Integer>(); 
```

然后改变

```
int temp = 10; 
```

到

```
values.put("temp", 10); 
```

并使用访问值

```
int tempVal = values.get(temp_name); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-06-21T15:28:32.483

**使变量成为成员变量并使用反射。**

除非它是类的成员变量，否则不能通过变量名获取值。然后您可以使用该`java.lang.reflect`包来检索该值。

# php - 给用户的好邮件

> ID：11141543
> 
> 赞同：-3
> 
> 时间：2012-06-21T15:27:30.047
> 
> 标签：php, css

当它到我的网站时，向用户发送电子邮件，所以发送一些这样平淡无奇的污垢，这就是我想要的方式/在页面上获得一些颜色，这是一种有点风格。

我与一位朋友交谈，他说可以对您发送给在该网站上注册的用户发送的电子邮件进行样式设置。因此，使用 get 不仅仅是如此无聊的电子邮件。

希望你理解否则你很欢迎问我

我希望你能帮帮我

你能给我一个链接或告诉我应该怎么做，这样我就可以给我的用户发一封很好的电子邮件。

```
if ($stmt = $mysqli->prepare('SELECT NULL FROM `brugere` WHERE `email` = ?')) { 
    $stmt->bind_param('s', $email);
    $email = $_POST['email'];
    $stmt->execute();
    $stmt->store_result();
    $count = $stmt->num_rows;
    $stmt->close();
    if ($count > 0)
    {
        $user_found = 1;
    }
    }
    if(!isset($user_found))
    {
    if($_POST["password"] != $_POST["gentag"])
    {
        $errors = 1;
        echo "<li id=\"check_not\">Skrive ens password p&#229; siden..</li>";
    }
    if (empty($_POST['password']) && empty($_POST['gentag']))
    {
        $errors = 1;
        echo "<li id=\"check_not\">Skrive et password p&#229; siden..</li>";
    }

    if(!isset($errors))
    {
    $pb = null;
    include "class.upload.php";
    $handle = new Upload($_FILES['file']);

    if($handle->uploaded)
    {
    //lidt mere store billeder
    $handle->image_resize = true;
    $handle->image_ratio_y = true;
    $handle->image_x = 220;
    $handle->Process("profil/store");

    //til profil billede lign..
    $handle->image_resize = true;
    $handle->image_ratio_crop = true;
    $handle->image_y = 75;
    $handle->image_x = 75;
    $handle->Process("profil");
    $pb = $handle->file_dst_name;

        echo "<h2>Tak for du opret dig hos xx.dk</h2>";
    ?>
    <img src="http://xx.dk/ (...) echo $pb;?>" alt="profilbillede" height="75" width="75"><br />
    <?php
    echo "<li id=\"check_ok\">Dit billede blev upload</li>";
    }
    else
    {
    ?>
    <img src="http://xx.dk/ (...) alt="profilbillede" height="128" width="128"><br />
    <?php
    echo "<li id=\"check_not\">Du upload intet billede. Vi har dog valgt et profil billede for dig.</li>";
    $pb = 'bruger_intet.png';
    }
    if ($stmt = $mysqli->prepare('INSERT INTO `brugere` (`email`, `katogori`, `djnavn`, `profilbillede`, `profiltekst`, `facebook`, `booking`, `password`, `code`) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)')) {

    $stmt->bind_param('sissssssi', $email, $katogori, $djnavn, $profilbillede, $profiltekst, $facebook, $booking, $password, $code);

    $email = $_POST['email'];
    $katogori = $_POST["kategori"];
    $djnavn = $_POST["djnavn"];
    $profilbillede = $pb;
    $profiltekst = $_POST["tekst"];
    $facebook = $_POST["facebook"];
    $booking = $_POST["booking"];
    $password = sha1($_POST['password']);
    $code = rand(111111111,999999999);

    $stmt->execute();
    $stmt->close();

    $to      = $email; // den som skal modtage mailen!
    $subject = "Hej xx.dk - Godkendt brugere konto"; // sende fra
    $msg    = "Tak for du vil opret dig på xx.dk!. \n \n For at kun activate din konto skal du bare klikke på dette link her: \n \n http://xx.dk/ (...) \n \n Du kan ikke besvar den her email!!";
    $header = "from:xx.dk - Godkendt Profil!! <support@xx.dk>";                

    if(mail($to, $subject, $msg, $header))
    {
        echo "<li id=\"check_ok\">Tilsendt e-mail til; $to - Tjek email</li>";
    }
        } 
            else
            {
                echo 'Der opstod en fejl i erklæringen: ' . $mysqli->error;
            }
        }
    }
    else {
        echo "<li id=\"check_not\">Der findes allerede en bruger med denne mail - G&#248;r et fors&#248;g mere <a href=\"http://xxx.dk/ (...) igen...</a></li>";
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T15:31:56.647

如果您提供正确的标题，您可以只使用 HTML。

例子：

```
$header .= "MIME-Version: 1.0\r\n";
$header .= "Content-Type: text/html; charset=ISO-8859-1\r\n"; 
```

# html - Flash 对象上的图像

> ID：11141545
> 
> 赞同：1
> 
> 时间：2012-06-21T15:27:34.313
> 
> 标签：html, flash, html-table

基本上，我只想将**new.gif**放在桌子上该行的左上角，但我想坐在我的 flash 对象（**loaditem.swf**）上。

这是我目前拥有的代码：

```
 <td>
    <img src="new.gif">
<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" 
codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0" 
height="100" width="100">
<param name="quality" value="high" />
<param name="wmode"/><param name="movie" value="loadItem.swf" />
<embed height="100" pluginspage="http://www.macromedia.com/go/getflashplayer" 
quality="high" src="loadItem.swf" type="application/x-shockwave-flash" 
menu="false" FlashVars="id=50000" wmode="transparent" width="100"></embed></object>
        </td>
        <td>Polar Teddy Bear</td> 
```

还有一些图片可以帮助查看我需要帮助的内容：

![目前的外观](../Images/8dd0230d528b1d57b22210158a064a64.png)

我想要达到的目标：

![实现外观](../Images/5d245e4e75dac208bceab8498507dc86.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T20:28:04.007

```
td {
  position: relative;
}
img {
  position: absolute;
  top: 0; left: 0;
} 
```

# c++ - 如何调试解决方案中包含的非托管 C++ 代码

> ID：11141548
> 
> 赞同：2
> 
> 时间：2012-06-21T15:27:50.387
> 
> 标签：c++, debugging, .net-4.0, pinvoke, swig

我正在使用第三方专有 DLL，我无法获得其源代码。但是，我可以使用似乎是使用 SWIG 1.3.39 自动生成的包装器代码。包装器代码包含一个 C++ 文件（使用一些描述 DLL 的头文件）编译为 DLL 和一个 C# 项目，该项目对 C++ 包装器 DLL 进行 PInvoke 调用。

我的项目解决方案中包含的那些 C++ 项目，但是当我在 C++ 代码中设置断点时，我永远不会到达那里。当我尝试在 C# 中按 F11 进入 C++ 函数时，我得到的是“显示程序集”。

我尝试了**解决方案 > 比例 > 配置比例**，但没有找到任何带有调试非托管/本机代码的选项。

**编辑**

包装器 C++ 代码可供我使用，我需要查看我从 C# 传递的值实际上正在传递给 C# 代码。

```
// In one file of the C# wrapper:
public string GetKey()
{
    // swigCPtr is a HandleRef to an object already created
    string ret = csWrapperPINVOKE.mdMUHybrid_GetKey(swigCPtr);
    return ret;
}

// In the csWrapperPINVOKE class in another file in the C# wrapper:
[DllImport("csWrapper.dll", EntryPoint="CSharp_mdMUHybrid_GetKey")]
public static extern StringBuilder mdMUHybrid_GetKey(HandleRef jarg1); 
```

以及来自 C++ 包装器的 C++ 代码。

```
SWIGEXPORT char * SWIGSTDCALL CSharp_mdMUHybrid_GetKey(void * jarg1) {
  char * jresult ;
  mdMUHybrid *arg1 = (mdMUHybrid *) 0 ;
  char *result = 0 ;

  arg1 = (mdMUHybrid *)jarg1; 
  result = (char *)(arg1)->GetKey();
  jresult = SWIG_csharp_string_callback((const char *)result); 
  return jresult;
} 
```

现在当我试图通过`swigCPtr`使用从 C# 包装器中传递`csWrapperPINVOKE.mdMUHybrid_GetKey(swigCPtr);`

现在我想看看 jarg1 是否从 swigCPtr 获取值；

```
SWIGEXPORT char * SWIGSTDCALL CSharp_mdMUHybrid_GetKey(void * jarg1) {
  char * jresult ;
  mdMUHybrid *arg1 = (mdMUHybrid *) 0 ;
  char *result = 0 ;

  arg1 = (mdMUHybrid *)jarg1; 
  result = (char *)(arg1)->GetKey();
  jresult = SWIG_csharp_string_callback((const char *)result); 
  return jresult;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T05:10:52.083

当你有一个托管的 exe 并想要调试它使用的本机 DLL 时，你需要告诉调试器。不要使用调试器类型**Auto**，默认值是什么。使用**混合**。

自动将识别托管 exe 并允许托管调试。这不是调试本机 C++ 代码所需要的。

*您可以在项目属性的调试*部分中找到*调试器类型*设置。

# c++ - 富编辑控件：rcPage 和 FORMATRANGE 结构的 rc 成员的区别

> ID：11141549
> 
> 赞同：1
> 
> 时间：2012-06-21T15:27:53.163
> 
> 标签：c++, c, windows, winapi, richtextbox

Win32 [Rich Edit 控件](http://msdn.microsoft.com/en-us/library/windows/desktop/bb787605%28v=vs.85%29.aspx)有一个名为的消息[`EM_FORMATRANGE`](http://msdn.microsoft.com/en-us/library/windows/desktop/bb788020%28v=vs.85%29.aspx)，它可以将控件的内容呈现给任意设备上下文。这通常用于打印或打印预览，但可以用于任何设备上下文。该消息接受一个名为 的结构[`FORMATRANGE`](http://msdn.microsoft.com/en-us/library/windows/desktop/bb787911%28v=vs.85%29.aspx)，其定义如下：

```
typedef struct _formatrange {
  HDC       hdc;
  HDC       hdcTarget;
  RECT      rc;
  RECT      rcPage;
  CHARRANGE chrg;
} FORMATRANGE; 
```

`rc`和的唯一文档`rcPage`如下：

> **`rc`**：要渲染到的区域。单位以缇为单位。
> 
> **`rcPage`**：渲染设备上页面的整个区域。单位以缇为单位。
> 
> `rc`和的值`rcPage`可以通过使用 获得[`GetDeviceCaps`](http://msdn.microsoft.com/en-us/library/windows/desktop/dd144877%28v=vs.85%29.aspx)。

我并不完全清楚 rcPage 和 rc 之间的区别是什么。我在网上看到的代码示例似乎将这两个设置为同一个矩形。Microsoft 自己的示例[How to Print the Contents of Rich Edit Controls](http://msdn.microsoft.com/en-us/library/windows/desktop/bb787875%28v=vs.85%29.aspx)完全无法初始化`rcPage`，实际上将未定义的数据传递给 Rich Edit 控件。

甚至被`rcPage`富编辑控件使用？我不明白为什么第二个矩形可能对影响这个命令的行为有用，那么它有什么用呢？`rc`有人可以提供一个例子来说明和之间的区别`rcPage`吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T03:43:22.430

您链接到的示例实际上将 rcPage 部分设置为打印机的最大尺寸，例如文档所说的内容，而 rc 设置为页面的实际可打印部分，通常打印机有页面周围无法实际打印的边框。有两个的原因可能是当某些东西绝对定位在页面上但您只是部分渲染它的一部分时，它需要该信息来正确偏移元素。

# ruby-on-rails - 从Ruby中的实例方法调用受保护的类方法

> ID：11141553
> 
> 赞同：0
> 
> 时间：2012-06-21T15:28:05.380
> 
> 标签：ruby-on-rails, ruby, visibility

我一直有这个令人烦恼的反复出现的主题；比方说，我有一个类，它定义了一个实例方法和一个受保护的类方法。实例方法必须调用类方法。为了做到这一点，我不得不打破可见性规则并使用危险的“发送”功能。像这样的东西：

```
class Bang
    def instance_bang
      self.class.send(:class_band)
    end

    protected
    def self.class_bang
      puts "bang"
    end
end 
```

我觉得这很糟糕，因为类方法应该在类范围内使用，因此应该在其中保持可见和可调用，对吗？是否有另一种方法可以在实例方法中使用类方法，需要依赖“发送”函数，因此不会破坏可见性？

更新：

在 Sergio Tulentsev 的回复之后（感谢更正），我将使用代码片段更新我的担忧，该代码片段总结了我对仍在定义范围内时考虑方法可见性的担忧。

```
class Bang
  def instance_bang
    private_bang = 1
    self.private_bang(private_bang)
  end
  private
  def private_bang(p)
    puts "bang"
    p
  end
end 
```

调用 Bang.new.instance_bang 将引发异常，除非您在该 private_bang 调用上使用 send（这次我检查了它:)）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T17:48:49.737

## 编辑：回答更新的问题

禁止使用显式接收者调用私有方法。您要么必须使用隐式接收器（`private_bang`，无`self`）或使用`send`. 请参阅[我的另一个答案](https://stackoverflow.com/a/11461333/125816)以获取更多信息。

顺便说一句，最初的问题是关于从实例方法调用类实例方法。您的澄清不包括这一点。但如果这仍然是真的，您必须使用`self.class.send`或公开该方法（以便您可以使用显式接收器）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-04-07T18:57:52.463

让我们考虑一个私有类方法（因为受保护的类方法[没有意义](http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/245072)）。

我们知道一个实例可以调用自己的私有方法，只要它不使用显式接收器（`self.call_something_private`）。**您似乎还希望实例可以在其自己的类上调用私有类方法，但事实并非如此。**

让我们看看一种不使用`send`.

`private`and`protected`宏只影响当前作用域的实例方法，不影响类方法。以下是重写原始代码的三种方法：

```
class Bang
  def instance_bang
    self.class.class_bang
  end

  # declare method visibility after
  def self.class_bang
    puts "bang"
  end
  private_class_method :class_bang

  # inline
  private_class_method def self.class_bang
    puts "bang"
  end

  # class scope
  class << self
    # the private macro works here because we're inside the class scope
    private

    def class_bang
      puts "bang"
    end
  end
end 
```

所以现在我们要在类上公开一个接口来调用`class_bang`，但前提是它被 的实例调用`Bang`。

```
class Bang
  def instance_bang
    self.class.invoke_class_bang(self)
  end

  class << self
    private

    def class_bang
      puts "bang"
    end

    public

    # we ask the receiver to pass itself as an argument ...
    def invoke_class_bang(receiver)
      # ... so that we can check whether it's
      class_bang if receiver.is_a?(Bang)
    end
  end
end 
```

不过，这不是一个很好看的解决方案。这是一个更狡猾的方法：

```
class Bang
  def initialize
    def self.instance_bang() self.class.method(:class_bang).call end
  end

  class << self
    private
    def class_bang
      puts "bang"
    end
  end
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T15:40:55.030

“类方法应该在类范围内使用，因此应该在其中保持可见和可调用，对吧？” 是的，这是正确的，这就是 Ruby 表现出来的行为。（作为澄清点，实例范围不在“类范围内”。它们适当地是分开的。）

非`send`解决方案是子类化或重新打开类以添加公共类方法来访问受保护的类方法。

# xamarin.android - MonoDroid 的 TeeChart

> ID：11141560
> 
> 赞同：0
> 
> 时间：2012-06-21T15:28:36.773
> 
> 标签：xamarin.android, teechart

我下载了用于 monodroid 的 TeeChart 测试版并尝试运行演示，但无法让它们中的任何一个工作，总是得到关于无效字符串或其他东西的异常。我确实下载了他们更新的 dll 文件……有人可以成功运行他们的演示吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T13:31:36.167

那是一个错误。[此处](http://tinyurl.com/c8ey5zk)提供了带有此修复程序的程序集。您能否尝试用这个替换您当前的 TeeChart.Monodroid.dll 并重试？

# bash - 从大文件中打印样本

> ID：11141568
> 
> 赞同：1
> 
> 时间：2012-06-21T15:29:46.050
> 
> 标签：bash, powershell

我有一个相当大的文本语料库，我想检查几行以查看格式是否正确（并且通常只是对其内容有所了解）。有没有一个简单的单行线可以用来打印一个巨大的文本文件的前几行？

就我个人而言，我使用的是 PowerShell，但对于 bash 和其他几个 shell 的答案是值得赞赏的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T15:36:29.917

在PowerShell中

```
get-content c:\filename.txt -TotalCount 3 #here just the first 3 line. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T15:32:31.243

第 n 行

```
head -n filename 
```

第 n 个字节

```
dd if=filename bs=1 count=n 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-21T15:32:36.330

```
$ head yourfile.txt 
```

我确定在 PowerShell 中有一个等价物。我的意思是，必须有，对吧？

**编辑：**是的。[Windows 等效于“tail”命令](https://stackoverflow.com/questions/1295068/windows-equiv-of-the-head-command)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-21T15:44:38.120

您可以使用[`less`](http://www.greenwoodsoftware.com/less/). 它对大文件非常有效。而且，如果您需要查看更多*，您可以继续翻阅文件。

[*“少即是多”]

# algorithm - 找出两个数组共有的最大元素？

> ID：11141571
> 
> 赞同：13
> 
> 时间：2012-06-21T15:29:57.390
> 
> 标签：algorithm

给定两个数组，如何找到两个数组共有的最大元素？

我正在考虑对两个数组进行排序（n log n），然后对另一个数组中的一个排序数组（从较大的数组开始）中的每个元素执行二进制搜索，直到找到匹配项。

例如：

```
a = [1,2,5,4,3]
b = [9,8,3]

Maximum common element in these array is 3 
```

我们能比 n log n 做得更好吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-21T15:36:41.410

使用一些额外的空间，您可以在 1 个数组中散列，然后对另一个数组的每个元素执行包含，以跟踪返回 true 的最大值。将是 O(n)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-21T15:38:58.230

您可以使用`O(N)`空间。
只需遍历第一个数组并将所有元素放在一个`HashTable`. 然后`O(N)`
通过第二个数组跟踪当前最大值并检查元素是否在`HashTable`. 这也是`O(N)`。所以总运行时间是`O(N)`和`O(N)`额外的空间`HashTable`

Java 中的示例：

```
public static int getMaxCommon(int[] a, int[] b){  
  Set<Integer> firstArray = new HashSet<Integer>(Arrays.asList(a));  
  int currentMax = Integer.MIN_VALUE;  
  for(Integer n:b){  
     if(firstArray.contains(n)){  
         if(currentMax < n){  
              currentMax = n  
         }
     }   
  }   
  return currentMax;  
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-21T15:42:48.460

虽然这取决于特定语言中各种操作的时间复杂度，但如何从数组创建集合并在两个集合的交集处找到最大值呢？根据 Python 中操作的时间复杂度，平均而言，集合分配为 O(n)，交叉点为 O(n)，找到最大值为 O(n)。所以平均情况是O(n)。

然而！最坏情况是 O(len(a) * len(b)) -> O(n^2)，因为集合交点的最坏情况时间复杂度。

更多信息在这里，如果你有兴趣：[http ://wiki.python.org/moin/TimeComplexity](http://wiki.python.org/moin/TimeComplexity)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-21T15:43:17.050

如果您已经知道数组中的数字范围，则可以执行计数排序，然后执行所需的二进制搜索。这将产生 O(n) 运行时。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-21T15:49:48.950

伪代码：

```
sort list1 in descending order
sort list2 in descending order
item *p1 = list1
item *p2 = list2
while ((*p1 != *p2) && (haven't hit the end of either list))
  if (*p1 > *p2)
    ++p1;
  else
    ++p2;
// here, either we have *p1 == *p2, or we hit the end of one of the lists
if (*p1 == *p2)
  return *p1;
return NOT_FOUND; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-12-11T11:00:40.887

不是一个完美的，而是一个简单的解决方案，O(len(array1) + len(array2))

```
import sys

def find_max_in_common(array1, array2):
    array1 = set(array1)
    array2 = set(array2)

    item_lookup = {}

    for item in array1:
        item_lookup[item] = True

    max_item = -sys.maxsize

    intersection = False

    for item in array2:
        if not item_lookup.get(item, None):
            continue
        else:
            intersection = True
            if item > max_item:
                max_item = item

    return None if not intersection else max_item 
```

# hibernate - 休眠死锁

> ID：11141576
> 
> 赞同：0
> 
> 时间：2012-06-21T15:30:07.400
> 
> 标签：hibernate, deadlock

在 webservice + hibernate 中陷入僵局......不知道为什么。

我有以下webservice代码（函数的核心代码）

```
public String createImageRecipe(...)
{
    Session session = ICDBHibernateUtil.getSessionFactory().getCurrentSession();
    try 
    {
        session.beginTransaction();

        User user = (User) session.load(User.class, userid);

        // Create the recipe
        Recipe recipe = new Recipe();
        ...
        ...
        ...

        session.save(recipe);
        session.save(user);

        ...
        ...
        ...

        session.update( recipe );

        // Add new entry to activity log
        Activitylog activityLog = new Activitylog(  user, 
                                                    (byte) ActivityTypeEnum.USER_SHARED_RECIPE.ordinal(), 
                                                    new Date() );
        activityLog.setRecipe(recipe);
        TimelineProcessor.saveTimeline( activityLog, null, true );

        session.getTransaction().commit();

        endMeasurement();

        return recipe.getRecipeid() + "," + recipe.getImageRecipeUrl();
    } 
    catch (RuntimeException e) 
    {
        ICDBHibernateUtil.getSessionFactory().getCurrentSession().getTransaction().rollback();
        throw e;
    }
} 
```

现在时间线线程 (TimelineProcessor) 执行以下操作（在收到消息后）：

```
 Session session = ICDBHibernateUtil.getTimelineSessionFactory().openSession();
    try {
        session.getTransaction().begin();

        ...
        ...
        ...

        TimelineId tlId = new TimelineId();
        tlId.setUserId(userId);

        User u = new User();
        u.setUserid(userId);

        Timeline tl = new Timeline(tlId, timelineData.getActivitylog(), u);
        session.save(tl);

        session.getTransaction().commit();
        session.close();
    } catch (Exception e) {
        logger.error("Error while processing timeline :: ", e);
        session.getTransaction().rollback();
    }
} 
```

日志中的异常：原因：com.mysql.jdbc.exceptions.jdbc4.MySQLTransactionRollbackException：尝试获取锁时发现死锁；尝试在 sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) 处重新启动事务

org.hibernate.HibernateException：非法尝试将集合与 org.hibernate.collection.AbstractPersistentCollection.setCurrentSession(AbstractPersistentCollection.java:435) 处的两个打开会话相关联

ERROR com.icdb.TimelineProcessor - processTimeline - Error while processing timeline :: org.hibernate.exception.LockAcquisitionException: could not insert: [com.icdb.data.Activitylog]

Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLTransactionRollbackException: Deadlock found when trying to get lock; try restarting transaction at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)

ERROR com.icdb.TimelineProcessor - processTimeline - Error while processing timeline :: org.hibernate.HibernateException: Illegal attempt to associate a collection with two open sessions

Will really appriciate help... Thanks a lot

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T16:21:20.773

Well Hibernate is telling you what it doesn't like:

```
Illegal attempt to associate a collection with two open sessions 
```

You are opening two sessions, and have a transaction in each, and when you save the new timeline in the second session, it has an activityLog, and that activityLog has a user and a recipe that stem from the first session. That's where Hibernate croaks.

I'm not sure i see what you are trying to accomplish. Is there a reason you need two separate sessions? Is the timeline something that's semantically associated with the recipe/user entities or is it more like a timestamp collection? In the former case you probably want to store user, recipe and timeline in one and the same collection, or else you'll end up with corrupt data if one transaction succeeds and the other one fails. In the latter case the Timestamp service should take value objects as arguments rather than entities, because you're probably going to want to access it from different parts of your application.

# nhibernate - NHibernate 存储过程命名

> ID：11141578
> 
> 赞同：0
> 
> 时间：2012-06-21T15:30:13.343
> 
> 标签：nhibernate, stored-procedures, naming-conventions

我正在将遗留系统的数据层转换为使用 NHibernate。旧数据库加载了我想要映射的存储过程。我被事物的命名所撕裂。这些 proc 不会返回简单的实体，它们会返回一团糟。一个例子是这样的：

```
USE [MYDB]
GO
/****** Object:  StoredProcedure [dbo].[GetInvoiceRenewals]    Script Date: 06/21/2012    10:24:05 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:      <Author,,Name>
-- Create date: <Create Date,,>
-- Description: <Description,,>
-- =============================================
ALTER PROCEDURE [dbo].[GetInvoiceRenewals]
@ClientId int,
@UserId int
AS
BEGIN
-- SET NOCOUNT ON added to prevent extra result sets from
-- interfering with SELECT statements.
SET NOCOUNT ON;

IF (@ClientId IN (SELECT ClientId FROM dbo.UserClientIds(@UserId)))
BEGIN

    SELECT I.InvoiceId, I.ClientId, I.InvoiceTypeId, I.InvoiceNumber, I.QuoteNumber, I.PONumber,
        I.TotalListPrice, I.EstimatedFee, I.ActualFee, I.DateCreated, u.firstname + ' ' + u.lastname as 'UserCreated',i.billingAddressID,i.shippingAddressID,
        I.ActualClientPrice,
        (select InvoiceStatus from InvoiceStatus where invoiceStatusID = (Select Case When Not Exists (Select * from InvoiceStatusHistory where InvoiceId=I.InvoiceID) Then 1
Else (Select top 1 InvoiceStatusID from InvoiceStatusHistory where InvoiceId=I.InvoiceID Order By ActionDate Desc) End)) as Status
    FROM Invoice I, [user] u
    WHERE I.ClientId = @ClientId AND I.IsActive = 1 AND I.InvoiceTypeId = 3 and u.userID = i.userCreated

END
END

--Select Case When Not Exists (Select * from InvoiceStatusHistory where    InvoiceId=I.InvoiceID) Then 1
--  Else (Select InvoiceStatusID from InvoiceStatusHistory where InvoiceId=I.InvoiceID)    End
--
--InvoiceStatusID is NULL then 1 else InvoiceStatusID END from InvoiceStatusHistory 
--                          where InvoiceId=1860 Order By    ActionDate Desc 
```

现在想象数百个。我显然要编写一个脚本来将所有这些生成到 hbm 文件中并创建实体。我正在寻找的是这些 proc 实体的良好命名结构？有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T17:24:16.717

我不认为 N​​Hibernate 真的很适合这个。如果您将其转换为 NHibernate，那么您应该真正将您的实体映射到表（大致），而不是存储的过程。

同样在此示例中，您的存储过程中有逻辑，imo 可以更好地用代码表示，这需要将您的实体映射到表并从这些实体中工作。

由于您想迁移到 NHibernate，我建议将您的实体映射到表，然后逐步迁移应用程序以使用实体，并使用存储过程保持原样（如果需要，您始终可以使用 session.procs 调用存储过程。 CreateSQLQuery("..."))

# ebay-api - eBay API - 如何在 GetItem 调用的 ViewItemURL 参数中包含会员跟踪信息

> ID：11141581
> 
> 赞同：0
> 
> 时间：2012-06-21T15:30:15.050
> 
> 标签：ebay-api, affiliate

据我所知，一些 eBay API 调用如下：

1.  [findItemsAdvanced](http://developer.ebay.com/devzone/finding/callref/findItemsAdvanced.html#Request)
2.  [获取相似项](http://developer.ebay.com/devzone/merchandising/docs/callref/getSimilarItems.html#Request)

有一个输入参数来指定 Affiliate `trackingId`，`networkId`以及允许我识别我的会员然后返回`ViewItemURL`包含会员跟踪信息的其他信息。

如何将我的会员数据传递给 API 调用[GetItem](http://developer.ebay.com/devzone/xml/docs/Reference/eBay/GetItem.html#Response.Item.ListingDetails.ViewItemURL)，使其响应字段`ViewItemURL`包含我的会员跟踪信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T16:08:32.180

为什么不在`GetSingleItem`Shopping API 中而不是`GetItem`在 Trading API 中使用调用？

> GetSingleItem
> [http://developer.ebay.com/DevZone/shopping/docs/CallRef/GetSingleItem.html](http://developer.ebay.com/DevZone/shopping/docs/CallRef/GetSingleItem.html)

它执行完全相同的工作，它允许调用中的 URL 参数用于“关联”返回的 URL。

> [http://developer.ebay.com/DevZone/shopping/docs/Concepts/ShoppingAPI_FormatOverview.html#AffiliateURLParameters](http://developer.ebay.com/DevZone/shopping/docs/Concepts/ShoppingAPI_FormatOverview.html#AffiliateURLParameters)

# excel - 如何通过 Qt 设置 excel 列格式？

> ID：11141582
> 
> 赞同：1
> 
> 时间：2012-06-21T15:30:20.217
> 
> 标签：excel, qt

我想将一些电话号码写入 excel 文件，其中一些以 0 开头（如 02167820096）。我尝试将该列的 NumberFormatLocal 属性设置为字符串类型：

```
 QAxObject* col=worksheet->querySubObject("Columns(int)",1);
        if (!col)
        {
            qDebug()<<"col is NULL";
        }
        qDebug()<<"col 1 NumberFormatLocal:"<<col->property("NumberFormatLocal").toString();
        col->setProperty("NumberFormatLocal","@");
        qDebug()<<"col 1 NumberFormatLocal:"<<col->property("NumberFormatLocal").toString(); 
```

输出是

```
col 1 NumberFormatLocal: "G/通用格式" 
col 1 NumberFormatLocal: "@" 
```

我可以看到第一列中的单元格确实设置为字符串类型（“@”）。

```
 QAxObject * range = worksheet->querySubObject("Cells(int,int)", 1, 1);
            if (!range)
            {
                qDebug()<<"range does not exist";
            }
            QVariant tel=QString("%1").arg(record["tel"].toString()); //tel is 02167820096
            //qDebug()<<tel;
            //range->dynamicCall("SetValue(const QVariant&)", tel);
            qDebug()<<"NumberFormatLocal:"<<range->property("NumberFormatLocal").toString();
            qDebug()<<"NumberFormat:"<<range->property("NumberFormat").toString();
            range->setProperty("Value", tel.toString());
            range->clear(); 
```

输出是

```
NumberFormatLocal: "@" 
NumberFormat: "@" 
```

但是当我打开保存的excel文件时，其中的所有单元格都被标记为通用类型，代码根本不起作用！

帮助！谢谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T04:15:51.740

好的，我解决了这个问题。因为我安装的是Office2007，“保存”功能会将文件保存为2007格式，但我保存为“*.xls”，有些格式无法正确识别。

所以解决方案是，使用“SaveAs”将excel保存为2003格式。

```
 QList<QVariant> lstParam;  
        qDebug()<<QDir::toNativeSeparators(file_path);
        lstParam.append(QDir::toNativeSeparators(file_path));  
        lstParam.append(-4143);   
        lstParam.append("");   
        lstParam.append("");   
        lstParam.append(false);   
        lstParam.append(false);   
        lstParam.append(1);  
        lstParam.append(2);  
        lstParam.append(false);   
        lstParam.append(false);   
        lstParam.append(false);   
        lstParam.append(false);   
        QVariant res = workbook->dynamicCall("SaveAs(QVariant, QVariant, QVariant, QVariant, QVariant, QVariant, QVariant, QVariant, QVariant, QVariant, QVariant, QVariant)", lstParam);  
        if(res.toBool())  
        {   
            qDebug()<<"SaveAs successful";
        } 
```

# iphone - iphone：后台应用同步网络服务

> ID：11141591
> 
> 赞同：0
> 
> 时间：2012-06-21T15:31:10.263
> 
> 标签：iphone, ios5, asynchronous, background, in-house-distribution

我知道这个问题可能有点常见而且问得太多，但我找不到任何准确的信息......所以：

当应用程序处于后台时是否可以运行某种线程，以便我可以与我的 web 服务执行基本同步？

应用程序在后台：我的意思是用户单击主页按钮，或切换到另一个应用程序基本同步：使用 AFNetworking 上传和下载照片。我知道它有在应用程序处于后台时继续 HTTPRequest 的方法，但这不是我的意思。

我的目标是制作某种同步管理器，读取用户在应用程序上创建的要更新的照片列表，并执行这些更改。

我知道管理器可能会被操作系统杀死，但是由于我的服务器使用原子传输，所以这不是问题。我只需要一种重新启动它的方法...推？

我认为谷歌纵横或邮件等应用程序使用我正在寻找的应用程序，但我找不到任何相关细节。并且使用iOS5 不是问题，但等待iOS6 不会是一个解决方案。

谢谢您的回复 ！

PS：好吧，我差点忘了。该应用程序是为企业程序设计的，所以规则可能不同？我不认为对内部部署进行任何检查，因此它可能会带来新的可能性......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T15:55:40.290

Apple 的 Mail 客户端有一个后台守护程序，可以让它保持运行，但你不能在你自己的应用程序中拥有它。一旦应用程序进入后台状态，它必须停止其操作。您可以在后台请求更多时间以完成任何传输或写入磁盘（请参阅[Apple's Multitasking Guide](http://developer.apple.com/library/ios/#DOCUMENTATION/iPhone/Conceptual/iPhoneOSProgrammingGuide/ManagingYourApplicationsFlow/ManagingYourApplicationsFlow.html)的后台部分中的执行有限长度任务）

谷歌纵横具有基于位置生成的事件。这是 Apple 为某些类型的应用程序引入的一种特殊类型的后台（请参阅[Apple 的多任务指南](http://developer.apple.com/library/ios/#DOCUMENTATION/iPhone/Conceptual/iPhoneOSProgrammingGuide/ManagingYourApplicationsFlow/ManagingYourApplicationsFlow.html)中的实现长时间运行的后台任务部分），但这不能用于 HTTP 同步。它只能用于音频、位置、voip、报摊内容、蓝牙和外部硬件附件。

Push 似乎不是一个解决方案，因为它只会生成警报。在用户触发打开通知之前，它不会触发任何操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T16:00:31.670

您需要阅读[技术说明 2277 网络和多任务处理](https://developer.apple.com/library/ios/#technotes/tn2277/_index.html#//apple_ref/doc/uid/DTS40010841)。

基本上你有几个选择：

如果您可以说服 Apple 您的应用程序是 VoIP 应用程序，那么您可以注册一个 VoIP 套接字，只要该套接字上有活动，操作系统就会恢复您的后台应用程序。

不过，您的主要选择是为您的应用程序置于后台时必须执行的任何未完成的活动注册一个后台任务。你通常有 10 分钟的时间来完成这项工作。

邮件是一个特殊的应用程序，具有您无法获得的特权。

像纬度这样的应用程序通常会为自己注册位置更新，特别是在发生重大地理位置变化时被唤醒。记录 GPS 轨迹的应用程序会做类似的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T12:36:54.067

找到了 ！

[使用Apple's Multitasking Guide 上的](http://developer.apple.com/library/ios/DOCUMENTATION/iPhone/Conceptual/iPhoneOSProgrammingGuide/ManagingYourApplicationsFlow/ManagingYourApplicationsFlow.html#//apple_ref/doc/uid/TP40007072-CH4-SW24 "Apple 的多任务处理指南")Suhail Patel链接，我将`voip`标签添加到`UIBackgroundModes`Info.plist 中，并使用[setKeepAliveTimeout:handler:](http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UIApplication_Class/Reference/Reference.html#//apple_ref/occ/instm/UIApplication/setKeepAliveTimeout%3ahandler%3a "setKeepAliveTimeout：处理程序：")方法`UIApplication`在应用程序进入睡眠状态后重新启动它。

我希望这对你们有很大帮助！

当然，这个应用程序不会被允许出现在 App Store 上，但对于内部开发，我认为这是最好的方式。

感谢大家为我指明了正确的方向！

# iphone - 获得 iPhone 版 Facebook 的热门帖子

> ID：11141592
> 
> 赞同：0
> 
> 时间：2012-06-21T15:31:13.123
> 
> 标签：iphone, facebook

我的应用程序有一个非常不同的要求。使用该应用程序，我需要从 facebook 获得前 25 个最喜欢和最多评论的帖子。首先让我问专家，直到今天这似乎是可能的吗？据我对此的思考和研究，我能够获得一个页面（使用图形 api 的组织或名人的）的喜欢和评论。我的方法是创建一个管理面板并订阅大多数名人、组织、产品等，但这无济于事。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T15:57:36.590

恐怕做不到。根据您的要求，您想在整个 facebook 上找到最受欢迎的帖子吗？这很可能来自页面，因为这些页面是公开的，并且可能有数百万人喜欢/评论帖子。

无论哪种方式，这将是一项复杂且数据密集型的任务。您必须从所有热门 Facebook 页面中抓取帖子，然后查看哪些页面的链接/评论最多。很多工作，却很少得到回报。

# php - 上传的 php 文件获得权限 600（无法执行）

> ID：11141598
> 
> 赞同：0
> 
> 时间：2012-06-21T15:31:32.283
> 
> 标签：php, apache, permissions

当我将 php 文件上传到服务器时，它会获得 600 权限（不可执行，不可读）。直到两天前一切正常。

请帮我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T16:14:55.717

您应该查看 FTP 服务器配置中的 UMASK。听起来它设置为 177 或其他东西。

您是否对配置进行了任何升级/更新？

另外，您使用的是什么 FTP 客户端和服务器？

如果您对盒子有外壳访问权限，请切换到 SFTP。它更安全，消除了很多麻烦。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T16:47:26.867

快速解决方法：您可以直接通过 php 更改权限：

```
chmod("myfile.pdf", 0755); 
```

另请参阅[http://php.net/manual/en/function.chmod.php](http://php.net/manual/en/function.chmod.php)

# haskell - 隐式参数和函数

> ID：11141600
> 
> 赞同：11
> 
> 时间：2012-06-21T15:31:44.277
> 
> 标签：haskell, parameters, ghc, implicit, wordnet

我在考虑 Haskell (GHC) 中的隐式参数时遇到问题。我有一个函数*f*，它假定隐式参数*x*，并希望通过将*f*应用于*g将其封装在上下文中*

```
f :: (?x :: Int) => Int -> Int
f n = n + ?x

g :: (Int -> Int) -> (Int -> Int)
g t = let ?x = 5 in t 
```

但是当我尝试评估

```
g f 10 
```

我收到*x*未绑定的错误，例如：

```
Unbound implicit parameter (?x::Int)
  arising from a use of `f'
In the first argument of `g', namely `f'
In the second argument of `($)', namely `g f 10' 
```

谁能告诉我，我做错了什么？

（我正在尝试让 Haskell 的 WordNet 接口工作 - [http://www.umiacs.umd.edu/~hal/HWordNet/](http://www.umiacs.umd.edu/~hal/HWordNet/) - 它以上述方式使用隐式参数，并且我不断收到错误作为当我尝试编译时上面的一个）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-08-28T12:06:11.743

The first parameter of `g` must be of type `((?x::Int) => Int -> Int)` to clarify that ?x should be passed to `f`. This can be dony be enabling Rank2Types (or RankNTypes). Unfortunately, GHC cannot infer this type.

```
{-# LANGUAGE ImplicitParams #-}
{-# LANGUAGE Rank2Types #-}

f :: (?x::Int) => Int -> Int
f n = n + ?x

g :: ((?x::Int) => Int -> Int) -> (Int -> Int)
g f = let ?x = 5 in f` 
```

Now `g f 10` works.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-05-01T06:45:32.710

这里的问题是它`?x`在它被引用的地方没有被绑定。你和我可以看到`?x`它将被绑定在 内`g`，但编译器不能。一个（令人困惑的）解决方案是改变

```
g f 10 
```

至

```
g (let ?x = 5 in f) 10 
```

# java - 为我们的应用程序的 DSL 提供一个简单的界面/控制台

> ID：11141604
> 
> 赞同：0
> 
> 时间：2012-06-21T15:31:49.470
> 
> 标签：java, user-interface, integration-testing, dsl, fluent-interface

我们有一个应用程序用作分布式系统中某种代理的模拟器。它的预期用途是用于集成测试，因此它必须非常灵活。我们有一个流畅的接口，它可能会演变成一个内部 DSL，用于定义代理的行为：测试场景。

我们还为用户（测试人员）提供了一个向导来创建测试场景，但我们发现这非常低效：用户自己将有足够的领域和技术知识来使用流畅的界面编写场景，而我们却在浪费时间对执行此操作的向导进行编程。

因此，我们想知道是否有任何轻量级的“控制台”允许用户在运行时借助自动完成和验证写入链式方法（或 DSL），就像我们在编码时所做的那样。如果可能，无需启动 Eclipse 实例。

考虑一个轻量级、可嵌入的“xText 控制台”或“带有建议的 groovy 控制台”，用于动态调用流利的接口方法或编写 DSL。

有任何想法吗？用户使用 DSL 的最简单方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T23:22:20.220

一种方法是使用 Scala 控制台：

```
$ scala -classpath <your-class-files> 
```

它具有方法的点完成功能。您甚至可以利用流利的语法，省略点和括号，这对 DSL 来说非常有用。代替：

```
scala> "howdy".contains("how")
res0: Boolean = true 
```

...你可以写：

```
scala> "howdy" contains "how"
res1: Boolean = true 
```

当然，“包含”可能是您的 DSL/fluent 接口的一种方法。

[是的，我在回答自己，呜呜呜呜]。

# jquery - 将图像添加到 jquery 按钮

> ID：11141607
> 
> 赞同：2
> 
> 时间：2012-06-21T15:32:00.487
> 
> 标签：jquery, jquery-ui, jquery-ui-button

我想知道如何将图像添加到 jquery 按钮。到目前为止，我在我的项目中使用 jquery ui 按钮，并且我从图形团队获得了自定义图像，所以我想实现它们。

```
submit.button({ icons: {primary:'ui-icon-trash'}, text: false }) 
```

如何将自定义图像添加到此 jquery 按钮？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-21T15:54:21.440

我只想为按钮分配一个类...

```
$("#buttonId").button({

    icons: {primary: null},
    text: false

}).addClass("ButtonClass"); 
```

然后你的 CSS 类可能看起来像这样......

```
.ButtonClass
{
    background-image: url(../images/Button.png);   
    background-repeat: no-repeat; 
    border: none;    
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-21T15:45:33.337

```
<button>Trash</button>
<style>
    .ui-button ​.ui-button-icon-primary {
        background: url('/my-custom-trash-image.png');
    }​
</style>
<script>
    $(function() {
        $('button').button({
            icons: {
                primary: 'ui-icon-trash'
            },
            text: false
        });
    });
</script> 
```

`primary`不幸的是，即使不会使用该图标，您也必须为该图标传递一个有效值。

**现场示例**- [http://jsfiddle.net/aMVrz/](http://jsfiddle.net/aMVrz/)

# c# - 如何从 Active Directory 中获取超过 20000 条记录

> ID：11141610
> 
> 赞同：1
> 
> 时间：2012-06-21T15:32:06.917
> 
> 标签：c#, active-directory, ldap

我正在使用以下代码从活动目录中获取用户详细信息

```
DirectoryEntry Entry = new DirectoryEntry("LDAP://dc=" + Domainname + ",dc=directoryname,dc=com", username, password, AuthenticationTypes.Secure);

DirectorySearcher DS = new DirectorySearcher(Entry);
List<string> lstPath = new List<string>();
DS.Filter = "(sAMAccountName=*)";
//DS.Filter = "(sAMAccountName=umbarglp)";
//DS.Filter = "(sAMAccountName=Adminumbarglp)";

SearchResultCollection ResultsCollection = DS.FindAll(); 
```

在这段代码中，我只返回了 20000 条记录，不超过这个。我需要使用什么来获取 AD 的所有条目。

提前致谢。埃什维尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T15:49:07.203

问题是最大返回记录永远不会大于服务器上配置的最大值（请参阅[SizeLimit](http://msdn.microsoft.com/en-us/library/system.directoryservices.directorysearcher.sizelimit.aspx)文档）。如果有可能进一步增加该数量，那将是最快的解决方案，（尽管在其他程序也能够获得更多记录并导致过载的情况下可能是不可取的）

**编辑** 出于好奇，我想通过分块阅读来测试如何做到这一点，这似乎可行：

```
 DS.SizeLimit = 10; //set small for testing, change before production ;)            
        DS.Filter = "(sAMAccountName=*)";            
        var list = new List<SearchResult>();

        SearchResultCollection res;
        while ((res = DS.FindAll()).Count > 0)
        {
            list.AddRange(res.Cast<SearchResult>());       
            var last = list[list.Count - 1].GetDirectoryEntry().InvokeGet("sAMAccountName").ToString()
                + "0"; // <- small cheat to prevent doubles because the search does not support > , but does support >=
            DS.Filter = "(sAMAccountName>=" + last + ")";
        } 
```

# c# - ASP.NET MVC 中的模型绑定：如何将 QueryString 值转换为视图模型？

> ID：11141613
> 
> 赞同：0
> 
> 时间：2012-06-21T15:32:11.153
> 
> 标签：c#, asp.net-mvc, model-binding, request.querystring, value-provider

我有一个没有参数的操作方法。

该`QueryString`系列包含我所有的价值观。`QueryString`匹配我的视图模型属性的键。

```
var queryStringValueProvider = new QueryStringValueProvider(ControllerContext);
var providerResult = queryStringValueProvider.GetValue(ValidationKeys.Id); // ?!

var viewModelTypeName = queryString[ValidationKeys.ViewModelType];

var viewModelType = Type.GetType(viewModelTypeName);
var viewModelInstance = providerResult.ConvertTo(viewModelType); // throws an InvalidOperationException 
```

如何将`QueryString`集合转换为视图模型？当您将视图模型传递给操作方法参数时，ASP.NET MVC 已经这样做了。所以我需要的是使用 ASP.NET MVC 机制的**事后模型绑定。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T08:56:13.700

**我的控制器动作**

```
var viewModelTypeName = queryString[ValidationKeys.ViewModelType];
var viewModelType = Type.GetType(viewModelTypeName);
var instance = Activator.CreateInstance(viewModelType);
UpdateModelUsingQueryString(instance); 
```

**更新模型**

```
protected internal void UpdateModelUsingQueryString<TModel>(TModel model) where TModel : class
{
    if (model == null) throw new ArgumentNullException("model");

    Predicate<string> propertyFilter = propertyName => new BindAttribute().IsPropertyAllowed(propertyName);
    var binder = Binders.GetBinder(typeof(TModel));

    var bindingContext = new ModelBindingContext()
    {
        ModelMetadata = ModelMetadataProviders.Current.GetMetadataForType(() => model, model.GetType()),
        ModelState = ModelState,
        PropertyFilter = propertyFilter,
        ValueProvider = new QueryStringValueProvider(ControllerContext)
    };
    binder.BindModel(ControllerContext, bindingContext);
} 
```

问题是，`UpdateModel`或者`TryUpdateModel`不`object`按设计工作。两种方法都使用`typeof(TModel)`. 但是你必须使用`model.GetType()`.

看看：[模型绑定 - 输入外部程序集](https://stackoverflow.com/questions/9378690/model-binding-type-in-external-assembly)

Darin Dimitrov 给出了正确的答案:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T15:36:56.547

要手动执行自定义模型绑定，请创建自定义模型绑定器（实现`IModelBinder`）并将其注册到您的 IoC 容器。

或者您可以`this.UpdateModel`在您的操作方法中调用。这应该将您的 ValueProvider（RouteData、Request.Form 集合和 QueryString）中的值绑定到您的模型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T15:37:46.390

你要求的是序列化。为了简单地做到这一点，您可以放置​​一个接受 QueryStringValueProvider 作为参数的构造函数重载，并且该构造函数负责根据提供者初始化模型的所有属性。如果你坚持使用字符串，你可以很容易地将这样的构造函数放入一个模型基类中，该基类可以被你的所有模型继承。

这也可以内置到扩展方法中，因此可以称为“按需”而不是在构造时。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-21T17:24:01.643

你可以使用`TryUpdateModel`

```
public ContentResult TestAction()
{
   var model = new MyModel();

   if(TryUpdateModel(model, new QueryStringValueProvider(ControllerContext)))
   {
      return Content("success");
   }

   return Content("failed");
} 
```

# python - python中的简单彗星客户端

> ID：11141618
> 
> 赞同：2
> 
> 时间：2012-06-21T15:32:21.453
> 
> 标签：python, comet, tornado

我正在测试 tornado（作为彗星服务器）、web2py 和 jquery 的集成，如[本视频中所述](https://vimeo.com/38972256)

所有组件都很好地结合在一起，除了 jQuery 彗星连接没有发生。我想对此进行调试，为此我想手动测试与龙卷风/彗星服务器的连接。为此，我想使用命令行工具，最好是 python 脚本。我找到[了这个](https://gist.github.com/1672967)。正如您在我的评论中看到的那样，我没有成功。我尝试了不同的模式，但没有成功：

```
python simplecometclient.py localhost:8888/realtime/mygroup
requests.exceptions.InvalidSchema: Invalid scheme 'localhost'

python simplecometclient.py http://localhost:8888/realtime/mygroup
Can "Upgrade" only to "WebSocket".

python simplecometclient.py ws://localhost:8888/realtime/mygroup
requests.exceptions.InvalidSchema: Invalid scheme 'ws' 
```

所以这里有三个问题：

1.  龙卷风是在做 websockets 还是彗星？
2.  你知道一个简单的命令行comet客户端（最好是python）吗？
3.  您会尝试使用链接脚本的其他模式吗？

# android - 文件处理很慢

> ID：11141619
> 
> 赞同：0
> 
> 时间：2012-06-21T15:32:23.980
> 
> 标签：android, file-io

我正在尝试读取我的 sdcard 上的一个文件并填充一些额外的信息（虽然非常小，比如 20 个字节）并将总信息再次写入我的 sdcard。我正在使用 FileInputStream 和 FileOutputStream 来读取和写入数据。但是，完成该操作需要很长时间。例如，读取和写入一个 100MB 的文件需要大约 30 秒。

```
 File file = new File(globalSelectFile);
    byte[] b = new byte[20971520];       /Around 20MB

    FileInputStream fin = new FileInputStream(file);
    FileOutputStream fout = new FileOutputStream(new File(directory + "/"
            + actualFileName)); 
```

有没有办法提高性能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T15:42:19.893

SD卡很慢。除了使用更快的 sd 卡（即 2 类卡）之外，没有什么可以做的

除此之外，我知道的唯一其他选择是您尝试向用户隐藏这种延迟。现在许多 Android 设备都是双核的，所以我建议你 1，尽量减少读写操作，只在必要时进行，2，当用户正在做某事时，在单独的线程中执行它们别的。即从用户那里获取一些输入，在你接受更多输入的同时将其写入磁盘。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T15:41:02.097

100MB 对于手持设备来说是巨大的。并期待您使用资源有限的设备（如 Android 手机）所获得的响应时间。

虽然从代码片段中不太清楚您是如何使用 20MB 字节数组的，但`OutOfMemoryError`如果您使用的是该大小的字节数组，它可能会导致错误。如果您将其用作复制文件的缓冲区，请尝试将大小减小到更小的值。

# java - 反序列化在 Android 应用程序中在 PC 上创建的数组列表

> ID：11141624
> 
> 赞同：0
> 
> 时间：2012-06-21T15:32:39.733
> 
> 标签：java, android, serialization

我在我的 PC 上编写了一个 java 程序，它将 ArrayList 序列化为文件。数组列表包含自定义类的对象。我想在 Android 应用程序中反序列化该 ArrayList。但是，当我尝试这样做时，会返回系统错误：

```
java.lang.ClassNotFoundException: (package name on pc)$(class name) 
```

PC 和 Android 上的类名称、实现及其 serialVersionUID 相同，但两者的包名称不同。有没有办法让 pc 生成的文件加载？我可以根据需要更改序列化代码。

# javascript - 在 Javascript 中启用/禁用按钮单击处理程序

> ID：11141625
> 
> 赞同：3
> 
> 时间：2012-06-21T15:32:45.133
> 
> 标签：javascript, jquery

好的，假设我有一个按钮，我想启用/禁用它的点击处理程序。

我想创建这样的功能：

```
var bar = [];
function storeHandlers(buttonID) {
    //I would like to store the click handlers in bar[buttonID]
}

function preventHandlers(buttonID) {
    storeHandlers(buttonID);
    //I would like to disable all the click handlers for button
}

function loadHandlers(buttonID) {
    //I would like to enable all the handlers loaded from bar[buttonID]
} 
```

这可能吗？我怎样才能做到这一点？

先感谢您

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T15:39:21.197

据我所知，您不能仅从元素的 ID 存储/检索事件处理程序，您必须在创建处理程序时手动存储这些事件处理程序。但是你可以`on/off`像下面这样处理

```
function preventHandlers(buttonID) {
    $('#'+buttonID).off('click',bar[buttonID]);
}

function loadHandlers(buttonID) {
   $('#'+buttonID).on('click',bar[buttonID]);
} 
```

你可以像这样存储它们

```
bar[buttonID] = function(event){

}; 
```

**更新：**

尽管此处的答案[如何使用 Firebug（或类似工具）调试 JavaScript/jQuery 事件绑定](https://stackoverflow.com/questions/570960/how-to-debug-javascript-jquery-event-bindings-with-firebug-or-similar-tool)和此处[如何在调试时或从 JavaScript 代码中查找 DOM 节点上的事件侦听器？](https://stackoverflow.com/questions/446892/how-to-find-event-listeners-on-a-dom-node/447106#447106)和其他人说`.date('events')`返回所有事件处理程序，我无法让它工作。

我已经用上述方式建立了一个例子。检查以下链接

[工作小提琴](http://jsfiddle.net/joycse06/cec6z/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T15:50:18.957

试试这个：

```
function preventClick(buttonID) {
    $('#'+buttonID).data('events').saved_click = $('#'+buttonID).data('events').click;
    $('#'+buttonID).data('events').click = null;
}

function allowClick(buttonID) {
    $('#'+buttonID).data('events').click = $('#'+buttonID).data('events').saved_click;
} 
```

就是这样！

jsFiddle 示例：http: [//jsfiddle.net/cec6z/9/](http://jsfiddle.net/cec6z/9/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T15:44:59.210

也许我错了，但我认为您不能从 jquery 对象中检索所有事件回调，例如

```
var handlers = $('#buttonId').unbind('click') 
```

# objective-c - 什么时候在 iOS 的 ARC 中发布强大的属性？

> ID：11141627
> 
> 赞同：5
> 
> 时间：2012-06-21T15:32:53.783
> 
> 标签：objective-c, ios, automatic-ref-counting

我有一个关于 iOS 中 ARC 的快速问题。（对不起，我问了很多这类问题，但我对内存管理感到很困惑。）。需要注意的是，我从未使用过旧的内存维护系统（`retain`、`release`、`assign`...等），所以我真的不知道这些术语是什么意思。

现在我很困惑我必须做些什么才能确保正确释放强大的属性。例如，假设我正在制作一个学校应用程序，并且我的对象包含对 5 个不同对象（不在数组中）的`School`强属性引用。`Child`每个`Child`对象都有一个指向对象的强指针（属性）`Book`。

如果我`Child`从学校中移除其中一个对象（例如通过使其属性 = nil，或将我的属性更改为指向一个新对象），它`Book`会被正确释放吗？我该怎么做才能确保是这种情况？我需要写`self.myBook = nil`一个`dealloc`方法吗？如果`Child`是视图控制器，我需要`self.myBook = nil`在 viewDidUnload 方法中编写吗？

我只针对 iOS 5（及更高版本），所以旧的内存管理方式对我来说并不重要。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-21T15:39:30.747

> 如果我`Child`从学校中移除其中一个对象（例如通过制作它`property = nil`，或者通过更改我的属性以指向一个新对象），它`Book`会被正确释放吗？

是的，只要没有其他强引用它就会被释放。

> 我该怎么做才能确保是这种情况？

没有什么特别的：当您将对该对象的引用设置为 时，ARC 将减少对象的*引用计数*`nil`，看到该对象不再被引用，然后继续删除它。递归地处理从被删除对象中引用的项目是足够聪明的，因此您不会泄漏任何内存。

您必须担心的一件事是循环引用：如果您`Book`对 有很强的反向引用，请`Child`进行该引用，或者在将引用设置为to`weak`的同时将其清除（第二个选项容易出错，因此不推荐）。`Book``nil`

# ios - iPad横向单导航栏

> ID：11141631
> 
> 赞同：0
> 
> 时间：2012-06-21T15:33:21.930
> 
> 标签：ios, ipad, uinavigationbar, uisplitview

我的 iPad 模式和横向应用程序需要单个导航栏，这很麻烦。

这个想法是，在景观中，Master 和 Detail 不会有 2 个单独的导航栏：见下文（图片取自 Google Images 并经过修改，不是我的项目）

![在此处输入图像描述](../Images/6ed966803732add74633832bd6bc6b12.png)

但取而代之的是一个导航栏，如下所示：

![在此处输入图像描述](../Images/9cb03116439bd1af7e3521db7b19e5ba.png)

我试图避免使用非常骇人听闻的方法，因为我的导航使用了很多自定义样式，但目前我能想到的唯一方法是调整 SplitView 超类中的视图大小并覆盖导航栏，但想看看是否还有其他人在任何想法之前有任何成功吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T15:36:43.980

拆分视图控制器的工作方式是显示两个单独的视图控制器。如果你想拥有统一的导航栏，不要使用拆分视图控制器，只需使用常规视图控制器，并将表格视图嵌入到您的普通视图中，并实现相应的协议来控制表格

# android - 方向切换后，TextView 不再更新

> ID：11141633
> 
> 赞同：1
> 
> 时间：2012-06-21T15:33:26.490
> 
> 标签：android

我有一个`Activity`with a `TextView`，使用我的 xml 布局文件中的定义以通常的`findViewById`方法创建。

我正在使用`onCreate()`方法中创建的处理程序更新 TextView 中的文本。

当我切换方向时，`TextView`不再从同一个`Handler`.

如果我的 xml 定义声明了 的值`android:text="blabla"`，那么我`"blabla"`会在视图中看到，但无法再更新它。

发生了什么？！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T16:25:23.363

当你切换方向时，android会创建新视图。我建议使 mHandler 易变。如果你决定只使用一个方向，对于横向添加`android:screenOrientation`android 清单中的活动标签

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-07T07:57:35.000

您无法再更新的原因是因为 Activity 引用不同。

您创建的第一个活动“A”具有处理程序“a”。

现在处理程序“a”只能更新属于活动“A”的视图。

因此，当方向发生时，活动“A”被销毁，活动“B”和处理程序“b”被创建。

所以'a'不能更新'B'在屏幕前的视图。

为了快速解决，我建议您在移动方向旋转时禁用重新创建活动。

AndroidManifest.xml

```
<activityandroid:name=".MyActivity"
          android:configChanges="orientation|keyboardHidden|screenSize"
          android:label="@string/app_name"> 
```

活动

```
@Override
public void onConfigurationChanged(Configuration newConfig){
    super.onConfigurationChanged(newConfig);

    // Checks the orientation of the screen
    if(newConfig.orientation ==Configuration.ORIENTATION_LANDSCAPE){
        Toast.makeText(this,"landscape",Toast.LENGTH_SHORT).show();
    }elseif(newConfig.orientation ==Configuration.ORIENTATION_PORTRAIT){
        Toast.makeText(this,"portrait",Toast.LENGTH_SHORT).show();
    }
} 
```

现在 onCreate 将不会在定向时被调用。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-21T15:37:44.063

尝试使用，

```
@Override
public void onConfigurationChanged(Configuration newConfig) {

  super.onConfigurationChanged(newConfig);

  if (newConfig.orientation == Configuration.ORIENTATION_PORTRAIT) {
      //your code
  } else if (newConfig.orientation == Configuration.ORIENTATION_LANDSCAPE) {
     //your code
  }
} 
```

# facebook - Facebook API 使用签到作为抽奖的入口

> ID：11141635
> 
> 赞同：0
> 
> 时间：2012-06-21T15:33:31.803
> 
> 标签：facebook, facebook-graph-api

我一直在探索可能促进我朋友的业务的方法。其中一种方法是鼓励用户检查他的业务，这样做的动机是他们参加抽奖以赢得某种奖品。

我一直在尝试查找此代码是否已经存在，但我可能在错误的地方寻找。如果不是，那么使用图形 API 的最佳方法是什么。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T15:54:59.290

您必须自己编写代码，但它基本上会像这样工作：

1.  让用户允许访问“抽奖”应用程序并获得他们的电子邮件地址和查看他们签到的权限。需要电子邮件联系获胜者。
2.  使用预定脚本 (cronjob) 定期检查用户是否在任何地方（特别是您要推广的业务）签到。
3.  在 24 小时内为每个独特的签到奖励一张抽奖券。
4.  在当天或当周签到的所有用户之间进行抽奖，并将奖品随机奖励给某人。

非常简单的流程，但复杂的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T16:00:02.190

您可以使用 Facebook 应用程序签入您的页面/业务。

所有页面签到都可以通过您的代码
[https://graph.facebook.com/PAGE_ID/checkins?access_token=PAGE_ACCESS_TOKEN使用以下请求获取](https://graph.facebook.com/PAGE_ID/checkins?access_token=PAGE_ACCESS_TOKEN)

如果您只想获取特定时间段的签到，请在查询中使用`since`和`until`参数。

您必须解析 json 响应并存储在数组中并随机选择获胜者。

您可以使用他们的 facebook id 联系获胜者并向他们发送消息。

# android - Adobe Air 相机问题

> ID：11141641
> 
> 赞同：1
> 
> 时间：2012-06-21T15:34:02.957
> 
> 标签：android, apache-flex, air, camera

不知道是否有人遇到过这个问题，但我正在为移动设备创建一个应用程序，它在我的运行 ics 4.0.4 的 Galaxy s2 上运行良好，但是当我在运行 2.3.3 的 Galaxy 选项卡上运行它时，它一直抛出错误。

我所做的只是获取设备摄像头并将其连接到 flash.media.Video。我怀疑由这个问题引起的错误数量会严重影响性能。

我附上了一个 fxp 文件（[https://www.box.com/s/77a9460edcf8a7ce95ee](https://www.box.com/s/77a9460edcf8a7ce95ee)），这样你就可以看到我没有做任何不寻常的事情。

感谢您的帮助！

附言

这是 logcat 的示例片段-

D/TvOut-Engine（79）：（isHdmiCableConnected）：mHdmiCableConnected 0

D/CameraHardwareSec(75): MemoryHeapBase(fd(26), size(5760128), width(800), height(600))

W/AudioFlinger（75）：RecordThread：缓冲区溢出

D/dalvikvm(12597)：GC_FOR_MALLOC 释放 1206K，48% 释放 4217K/8007K，外部 4034K/4493K，暂停 91ms

V/AudioHardwareALSA(75)：重采样器读取错误 -32

D/AudioHardwareALSA(75): AudioStreamInALSA::读取错误 -32

D/AudioHardwareALSA(75): AudioStreamInALSA::snd_pcm_recover 错误 0

E/v4l2_utils(75): 错误 = 来自 qbuf 的参数无效

E/CameraHardwareSec(75): ERR(int android::CameraHardwareSec::previewThread()):overlay queueBuffer 失败

I/dalvikvm-heap(12597)：将堆（碎片情况）增加到 16.060MB，分配 5760016 字节

D/dalvikvm(12597)：GC_FOR_MALLOC 释放 203K，30% 释放 9638K/13639K，外部 3975K/4493K，暂停 26ms

E/v4l2_utils(75): 错误 = 来自 qbuf 的参数无效

E/CameraHardwareSec(75): ERR(int android::CameraHardwareSec::previewThread()):overlay queueBuffer 失败

D/dalvikvm(12597)：GC_CONCURRENT freed 91K, 31% free 9547K/13639K, external 3975K/4493K, paused 2ms+13ms

D/dalvikvm(12597)：GC_FOR_MALLOC 释放 76K，31% 释放 9471K/13639K，外部 3975K/4493K，暂停 43ms

E/v4l2_utils(75): 错误 = 来自 qbuf 的参数无效

E/CameraHardwareSec(75): ERR(int android::CameraHardwareSec::previewThread()):overlay queueBuffer 失败

I/dalvikvm-heap(12597)：将堆（碎片情况）增加到 21.133MB 以分配 5760016 字节

E/v4l2_utils(75): 错误 = 来自 qbuf 的参数无效

E/CameraHardwareSec(75): ERR(int android::CameraHardwareSec::previewThread()):overlay queueBuffer 失败

# python - 如何在python中比较2个json

> ID：11141644
> 
> 赞同：14
> 
> 时间：2012-06-21T15:34:10.743
> 
> 标签：python

下面如何在 python 中比较 2 个 json 对象是示例 json。

```
sample_json1={
    {
       "globalControlId": 72,
       "value": 0,
       "controlId": 2
   },
   {
       "globalControlId": 77,
       "value": 3,
       "controlId": 7
   }
}

sample_json2={
    {
       "globalControlId": 72,
       "value": 0,
       "controlId": 2
   },
   {
       "globalControlId": 77,
       "value": 3,
       "controlId": 7
   }
} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-21T15:43:54.993

似乎通常的比较工作正常

```
import json
x = json.loads("""[
    {
       "globalControlId": 72,
       "value": 0,
       "controlId": 2
   },
   {
       "globalControlId": 77,
       "value": 3,
       "controlId": 7
   }
]""")

y = json.loads("""[{"value": 0, "globalControlId": 72,"controlId": 2}, {"globalControlId": 77, "value": 3, "controlId": 7 }]""")

x == y # result: True 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-21T15:40:39.507

这些不是有效的 JSON / Python 对象，因为数组 / 列表文字在里面`[]`而不是`{}`：

**更新**：比较字典列表（序列化的 JSON 对象数组），同时忽略列表项的顺序，列表需要**排序或转换为集合**：

```
sample_json1=[{"globalControlId": 72, "value": 0, "controlId": 2},
              {"globalControlId": 77, "value": 3, "controlId": 7}]
sample_json2=[{"globalControlId": 77, "value": 3, "controlId": 7},
              {"globalControlId": 77, "value": 3, "controlId": 7}, # duplicity
              {"globalControlId": 72, "value": 0, "controlId": 2}]

# dictionaries are unhashable, let's convert to strings for sorting
sorted_1 = sorted([repr(x) for x in sample_json1])
sorted_2 = sorted([repr(x) for x in sample_json2])
print(sorted_1 == sorted_2)

# in case the dictionaries are all unique or you don't care about duplicities,
# sets should be faster than sorting
set_1 = set(repr(x) for x in sample_json1)
set_2 = set(repr(x) for x in sample_json2)
print(set_1 == set_2) 
```

# forms - jsp上的spring mvc多种形式

> ID：11141648
> 
> 赞同：2
> 
> 时间：2012-06-21T15:34:13.857
> 
> 标签：forms, jsp, model-view-controller

大家好，是否可以在单个 jsp 上使用多个表单，也可以使用单个按钮？

这是我的jsp页面，我有两个表单，我知道是这样，它只保存第二个表单。

```
<html>
<head>
<title>Update General Info</title>
<script type="text/javascript">
function validateForm()
{
var name=document.getElementById("name").value;
 var surname=document.getElementById("surname").value;
var email=document.getElementById("email").value;
var amka=document.getElementById("amka").value;
if (name.length == 0)   
  {
  alert("Name must be filled out");
  return false;
 } else if(surname.length == 0){
      alert("Surname must be filled out");
      return false;
  }else if(email.length == 0){
      alert("Email must be filled out");
      return false;
  }else if(amka.length == 0){
      alert("Amka must be filled out");
      return false;
  }
}
</script>
</head>
<body>
<h1>Update General Info</h1>

<c:if test="${!empty user}">
<c:url var="saveArticleUrl" value="/articles/updateGeneralSave.html" />
<form:form onsubmit="return validateForm()" modelAttribute="user" method="POST" >
<table bgcolor="DBEADC" border=1>
<tr>
<th>Id</th>
<th>Team</th>
<th>Name</th>
<th>Surname</th>
<th>Username</th>
<th>Password</th>
<th>Email</th>
<th>AMKA</th>
<th>Status</th>
<th>Department</th>
</tr>

<tr>
<td><form:input readonly="true" path="id" value="${user.id}"></form:input></td>
<td><form:input readonly="true" path="team" value="${user.team}"></form:input></td>
<td><form:input id="name" path="name" value="${user.name}"></form:input></td>
<td><form:input id="surname" path="surname" value="${user.surname}"></form:input></td>
<td><form:input readonly="true" path="username" value="${user.username}"></form:input></td>
<td><form:input type="password" readonly="true" path="password" value="${user.password}"></form:input></td>
<td><form:input id="email" path="email" value="${user.email}"></form:input></td>
<td><form:input id="amka" path="amka" value="${user.amka}"></form:input></td>
<td><form:input id="status" path="status" value="${user.status}"></form:input></td>

<td><form:select  path="department">
<c:forEach items="${departments}" var="dep">
<c:if test="${dep.dep_name==user.department }">
<OPTION selected VALUE="${dep.dep_name}"><c:out value="${dep.dep_name}"/></OPTION>
</c:if>
<c:if test="${dep.dep_name!=user.department }">
<OPTION VALUE="${dep.dep_name}"><c:out value="${dep.dep_name}"/></OPTION>
</c:if>

</c:forEach>
</form:select></td>
</tr>
</table>

</form:form>
</c:if>
<c:if test="${!empty phones}">
<c:url var="saveArticleUrl" value="/articles/updatePhoneSave.html" />
<form:form onsubmit="return validateForm()" modelAttribute="updatePh" method="POST" action="${saveArticleUrl}">
<table bgcolor="DBEADC" border=1>
<tr>
<th>Id</th>
<th>Phone</th>
<th>Mobile</th>
<th>Fax</th>
</tr>

<tr>
<td><form:input readonly="true" path="id" value="${phones.id}"></form:input></td>
<td><form:input id="phone" path="phone" value="${phones.phone}"></form:input></td>
<td><form:input id="mobile" path="mobile" value="${phones.mobile}"></form:input></td>
<td><form:input path="fax" value="${phones.fax}"></form:input></td>
</tr>

</table>

<input type="submit" value="Update" />
</form:form>

</c:if>
</body>
</html> 
```

和控制器

```
RequestMapping(value = "updateGeneral" , method = RequestMethod.GET)
        public ModelAndView updateGeneral(@ModelAttribute("user") Users user ,@ModelAttribute("updatePh") Phone updatePh, @RequestParam("id")Integer id){
         Map<String, Object> model = new HashMap<String, Object>();
            model.put("user",  articleService.getUser(id));
            model.put("departments", articleService.listDepartments());
            //twra mpike
            model.put("phones",  articleService.getPhones(id));
        return new ModelAndView("updategeneral",model);
     }
     //evala akoma ena modelattri
     @RequestMapping(value = "updateGeneralSave" , method = RequestMethod.POST)
        public ModelAndView updateGeneralSave(@ModelAttribute("user") Users user){

         articleService.updateUser(user);

        return new ModelAndView("redirect:/articles/listusers.html");
     }

 @RequestMapping(value = "updatePhoneSave" , method = RequestMethod.POST)
        public ModelAndView updatePhonesave(@ModelAttribute("updatePh") Phone updatePh){

         articleService.updatePhone(updatePh);  
        return new ModelAndView("redirect:/articles/listusers.html");
     } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-22T11:51:05.803

一个 JSP 中可以有多个表单，但不能同时发送两个表单。

您应该混合两种形式和两种操作，检索操作/控制器中的所有信息并保存电话和用户信息。另一种选择是使用 Ajax 发送一个表单并像往常一样发送另一个。

顺便说一句，您的问题与Spring无关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-30T09:21:30.137

您唯一的选择是为 ajax 做，您必须意识到，如果您的 Controller 方法将在第一次提交后呈现页面，那么您通过 HTTP 进行的第二次提交将永远不会生效。

```
 function submitForm(form, index){
       $.ajax({
        dataType: "json",
        method: "POST",
        url: "your controller url",
        data:$('#form').serialize(),
        success: function (data) {
           if(index > 0){
              submitForm(form+=1, index--)
           }
        }
    }); 
```

}

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T17:08:37.587

是的，当然，你可以让你的按钮来提交你的表格。但是你已经用 ajax 做到了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-02T13:16:07.640

您需要使用 document.forms[i] 遍历网页上的表单，并使用每个表单单独调用提交

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-06-22T11:38:39.237

您可以执行以下技巧，例如 而不是 sumbit 按钮只有普通按钮

```
<input type="button" value="Update" onClick="submit2forms();"/> 
```

并单击此按钮调用下面的javascript方法

```
 <script language="javascript">
            function submit2forms() {
                document.getElementById("form1").submit();
                document.getElementById("form2").submit();
            }
        </script> 
```

# ios - IOS：带有特殊字符的nsxmlparser

> ID：11141649
> 
> 赞同：0
> 
> 时间：2012-06-21T15:34:19.810
> 
> 标签：ios, utf-8, nsxmlparser

在我的应用程序中，我做了一个 xmlparser，但在解析器过程中遇到了问题，因为在标签中我有一个特殊的字母“è”，它读作“\U00e8”；并且它关闭了我的 xml 的标签……我的解析出错了……

我以这种方式在 utf-8 中设置了我的路径

```
NSString *path = @"emaple.com";

NSError *error;
NSURL *url      = [NSURL URLWithString:path];
NSString * dataString = [[NSString alloc] initWithContentsOfURL:url encoding:NSUTF8StringEncoding error:&error];
NSData *data = [dataString dataUsingEncoding:NSUTF8StringEncoding];

affayfeed = [[NSMutableArray alloc]init];
parser = [[NSXMLParser alloc] initWithData:data]; 
```

但我有同样的问题......为什么？

# mysql - 更改带有编号结果集（带间隙）的查询以返回没有间隙的结果，包含每个数字。

> ID：11141650
> 
> 赞同：2
> 
> 时间：2012-06-21T15:34:19.767
> 
> 标签：mysql, sql

我有一个 select 语句：`select a, b, [...];`它返回结果：

```
a|b
---------
1|8688798
2|355744
4|457437
7|27834 
```

我希望它返回：

```
a|b
---------
1|8688798
2|355744
3|0
4|457437
5|0
6|0
7|27834 
```

一个示例查询不符合我的要求，因为它没有间隙编号：

```
select
    sub.num_of_ratings,
    count(sub.rater)
from
(
    select 
        r.rater_id as rater,
        count(r.id) as num_of_ratings
    from ratings r
    group by rater
) as sub
group by num_of_ratings; 
```

查询说明：如果一个用户对另一个用户进行评分，评分列在 rating 表中，评分用户的 id 保存在字段 rater_id 中。实际上，我检查了评分中提到的所有用户，并计算了我为该用户找到了多少评分记录，即`rater / num_of_ratings`，然后我使用此结果来查找有多少用户对给定次数进行评分。

最后我知道有多少用户评价过一次，有多少用户评价过两次，等等。我的问题是 count(sub.rater) 的数字从 1,2,3,4,5 开始很好......但是，对于更大的数字有差距。这是因为可能有一位用户评分 1028 次 - 但没有用户评分 1027 次。

我不想应用存储过程循环结果或类似的东西。是否可以在不使用存储过程、循环或创建临时表的情况下填补结果中的这些空白？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T15:45:50.150

如果您有一个数字序列，那么您可以对该表执行 JOIN 并正确填充空白。

您可以查看有关如何获取序列的问题： [在 MySQL 中生成整数序列](https://stackoverflow.com/questions/304461/generate-an-integer-sequence-in-mysql)

这是发布的答案之一，可能很容易使用生成从 1 到 10,000 的数字的限制：

```
SELECT @row := @row + 1 as row FROM 
(select 0 union all select 1 union all select 3 union all select 4 union all select 5 union all select 6 union all select 6 union all select 7 union all select 8 union all select 9) t,
(select 0 union all select 1 union all select 3 union all select 4 union all select 5 union all select 6 union all select 6 union all select 7 union all select 8 union all select 9) t2, 
(select 0 union all select 1 union all select 3 union all select 4 union all select 5 union all select 6 union all select 6 union all select 7 union all select 8 union all select 9) t3, 
(select 0 union all select 1 union all select 3 union all select 4 union all select 5 union all select 6 union all select 6 union all select 7 union all select 8 union all select 9) t4, 
(SELECT @row:=0) t5 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T17:20:17.203

使用一系列数字，您可以加入您的结果集。例如，假设您的号码列表位于名为 numbersList 的表中，列号为：

```
Select number, Count 
from
  numbersList left outer join
  (select
      sub.num_of_ratings,
      count(sub.rater) as Count
  from
  (
      select 
          r.rater_id as rater,
          count(r.id) as num_of_ratings
      from ratings r
      group by rater
  ) as sub
  group by num_of_ratings) as num

on num.num_of_ratings=numbersList.number
where numbersList.number<max(num.num_of_ratings) 
```

显然，您的数字列表必须大于您的最大值，并且该限制将允许它没有所有数字都达到最大值。（如果 MySQL 不允许这种类型的 where 子句，您可以不使用 where 子句以列出所有数字直到最大值，或者以各种方式修改查询以获得相同的结果。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-03T10:00:02.507

@mazzucci：查询太神奇了，您实际上并没有解释查询。

@David：我不能为此目的创建一个表（如问题中所述）

基本上我需要的是一个返回无间隙数字列表的选择。然后我可以在该结果集上留下连接并将 NULL 视为 0。

我需要的是一个任意表，它保存的记录多于最终列表的长度。我在以下示例中使用表用户：

```
select @row := @row + 1 as index
    from (select @row := -1) r, users u
limit 101; 
```

此查询返回一组从 0 到 100 的数字。将其用作左连接中的子查询最终填补了空白。

users 只是保持关系引擎运行并因此逐步生成数字的假人。

```
select t1.index as a, ifnull(t2.b, 0) as b
from (
    select @row := @row + 1 as index
        from (select @row := 0) r, users u
    limit 7
) as t1
left join (
    select a, b [...]
) as t2
on t1.index = t2.a; 
```

我没有现场尝试这个查询，所以如果有一点缺陷，请与我一起感谢。但从技术上讲它有效。你明白我的意思。

**编辑：**

只是使用这个概念来获得一个无缝的日期列表，以便在其上留下连接度量：

```
select @date := date_add(@date, interval 1 day) as date
    from (select @date := '2010-10-14') d, users u
limit 700 
```

从 2010/10/15 开始，再迭代 699 天。

# c++ - 为什么我不能使用 std::remove_if 从 std::set 中删除字符串？

> ID：11141651
> 
> 赞同：11
> 
> 时间：2012-06-21T15:34:19.750
> 
> 标签：c++, algorithm, set, remove-if

> **可能重复：**
> [remove_if 等效于 std::map](https://stackoverflow.com/questions/800955/remove-if-equivalent-for-stdmap)

我有一组字符串：

```
set <wstring> strings;
// ... 
```

我希望根据谓词删除字符串，例如：

```
std::remove_if ( strings.begin(), strings.end(), []( const wstring &s ) -> bool { return s == L"matching"; }); 
```

当我尝试这样做时，我收到以下编译器错误：

```
c:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\include\algorithm(1840): error C2678: binary '=' : no operator found which takes a left-hand operand of type 'const std::basic_string<_Elem,_Traits,_Ax>' 
```

该错误似乎表明`std::string`没有按值复制构造函数（这将是非法的）。`std::remove_if`使用with 有什么不好的地方`std::set`吗？我应该做其他事情，例如几次迭代，`set::find()`然后是`set::erase()`？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-06-21T15:37:34.397

`std::remove_if`（或`std::erase`）通过重新分配范围成员的值来工作。它不了解如何`std::set`组织数据，或者如何从其内部树数据结构中删除节点。事实上，如果没有`set`对象本身，只使用对节点的引用是不可能的。

标准算法旨在具有透明（或至少始终易于记忆）的计算复杂性。由于需要重新平衡树，因此有选择地从 a 中删除元素的函数`set`将是 O(N log N)，这并不比循环调用更好`my_set.remove()`。所以，标准没有提供它，这就是你需要写的。

另一方面，一个简单的手动编码循环来逐个删除项目`vector`将是 O(N^2)，而`std::remove_if`O(N)。因此，在这种情况下，图书馆确实提供了切实的好处。

一个典型的循环（C++03 风格）：

```
for ( set_t::iterator i = my_set.begin(); i != my_set.end(); ) {
    if ( condition ) {
        my_set.erase( i ++ ); // strict C++03
        // i = my_set.erase( i ); // more modern, typically accepted as C++03
    } else {
        ++ i; // do not include ++ i inside for ( )
    }
} 
```

编辑（4 年后！）：`i ++`在那里看起来很可疑。如果在后增量运算符可以更新之前`erase`失效怎么办？`i`不过，这很好，因为它是重载`operator++`而不是内置运算符。该函数安全地`i`就地更新，*然后*返回其原始值的副本。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-06-21T16:02:08.733

错误消息说

> **未找到采用“ const** std::basic_string<_Elem,_Traits,_Ax>”类型的左操作数的运算符

注意常量。编译器是正确的，`std::wstring`它没有`operator=`可以在 const 对象上调用的。

为什么字符串是常量？答案是 a 中的值`std::set`是不可变的，因为 set 中的值是有序的，并且更改值可能会更改其在 set 中的顺序，从而使 set 无效。

为什么编译器试图复制集合的值？

`std::remove_if`(and `std::remove`) 实际上并没有擦除任何东西（它们也不能，因为它们没有容器，只有迭代器）。*他们所做的是将范围内与条件不*匹配的所有值复制到范围的开头，并将迭代器返回到匹配元素之后的下一个元素。然后，您应该从返回的迭代器手动擦除到范围的末尾。由于集合保持其元素有序，因此移动任何元素都是错误的，因此`remove_if`不能在集合（或任何其他关联容器）上使用。

简而言之，您必须使用 and 的循环`std::find_if`，`set::erase`如下所示：

```
template<class V, class P>
void erase_if(std::set<V>& s, P p)
{
  std::set<V>::iterator e = s.begin();
  for (;;)
  {
    e = std::find_if(e, s.end(), p);
    if (e == s.end())
      break;
    e = s.erase(e);
  }
} 
```

# dynamics-crm - javascript从相交实体中获取

> ID：11141652
> 
> 赞同：0
> 
> 时间：2012-06-21T15:34:21.953
> 
> 标签：dynamics-crm, dynamics-crm-2011

我正在尝试为相交实体（由 2 个实体之间的 N:N 关系创建）编写 javascript 获取。我到处都能看到 C# 示例，但对于 javascript 却一无所获。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T17:54:15.037

Fetch 在 C# 和 JavaScript 之间非常通用，因此相同的查询应该在两者中都可以工作。

[http://blog.customereffective.com/blog/2011/05/execute-fetch-from-javascript-in-crm-2011.html](http://blog.customereffective.com/blog/2011/05/execute-fetch-from-javascript-in-crm-2011.html)

# c# - 以编程方式更新 ClickOnce 应用程序的部署清单会导致丢失 元素，在 4.0 中需要

> ID：11141655
> 
> 赞同：7
> 
> 时间：2012-06-21T15:34:46.427
> 
> 标签：c#, .net-4.0, installation, clickonce

我正在为 .NET 4.0 ClickOnce WPF 应用程序自动化安装程序，该应用程序需要在*app.config*文件中设置一些项目。我已经经历了寻找使用[Mage.exe](http://msdn.microsoft.com/en-us/library/acz3y3te.aspx)必须遵循的特定步骤的棘手过程（即更新和重新签署应用程序和部署清单），现在正尝试将其自动化以进行安装。

我选择使用*.deploy*扩展来最大程度地减少[IIS](http://en.wikipedia.org/wiki/Internet_Information_Services) / Internet Explorer 安全机制的问题，所以基本上算法如下（基于*[ClickOnce 中的签名和重新签名清单（Saurabh Bhatia）](http://blogs.msdn.com/b/vsto/archive/2009/04/29/signing-and-re-signing-manifests-in-clickonce.aspx)*和*[使用 Mage 更新 ClickOnce WPF 应用程序的配置或 MageUI](http://www.eggheadcafe.com/tutorials/xaml/a8788ed5-c1b5-41d5-b49c-ea4760c3b820/update-configuration-of-a-clickonce-wpf-application-using-mage-or-mageui.aspx)*，作为主要来源）：

1.  转到`\Application Files\App_%HighestVersion%\`文件夹
2.  删除具有它的文件的*.deploy扩展名*
3.  跑  `mage -u %app%.exe.manifest -cf cert.pfx`
4.  恢复*.deploy*扩展
5.  跑  `mage -u %app%.application -appm %app%.exe.manifest -cf cert.pfx`
6.  向上复制`%app%.application`2 个级别（到`..\..`- 部署根目录）

如果手动完成，那效果很好。我可以运行一个*.cmd*文件，针对环境细节（路径等）进行定制，但随后我需要将其包含`mage.exe`在部署中，微软是否允许我们这样做对我来说是一个悬而未决的问题。因此，我试图在`Installer`课堂上执行类似的操作：

```
X509Certificate2 ct = new X509Certificate2(sPathCert);

//  .. Remove .deploy extension (for files in the sPathApp folder).

sPathMft = Directory.GetFiles(sPathApp, "*.exe.manifest")[0];
ApplicationManifest am = ManifestReader.ReadManifest( "ApplicationManifest", sPathMft, false ) as ApplicationManifest;
if (am == null)
    throw new ArgumentNullException("AppManifest");
am.ResolveFiles();
am.UpdateFileInfo( );
ManifestWriter.WriteManifest(am, sPathMft);
SecurityUtilities.SignFile(ct, null, sPathMft);

//    .. Restore .deploy extensions to files touched above.

sPathMft = Directory.GetFiles(sPathApp, "*.application")[0];
DeployManifest dm = ManifestReader.ReadManifest("DeployManifest", sPathMft, false) as DeployManifest;
if (dm == null)
    throw new ArgumentNullException( "DplManifest" );
dm.ResolveFiles();
dm.UpdateFileInfo();
ManifestWriter.WriteManifest(dm, sPathMft);
SecurityUtilities.SignFile(ct, null, sPathMft);

File.Copy(sPathMft, sPathBin + "\\" + dm.AssemblyIdentity.Name, true); 
```

**现在，这是踢球者**。除第 5 步外，一切正常。当应用程序下载到用户计算机时，部署清单出现问题：

*   部署清单在语义上无效。
*   部署清单缺少 <compatibleFrameworks>。

实际上，这部分不再存在（*但是，它在原始的 %app%.application 中*！）。ClickOnce - .NET 4.0 错误中描述了类似的结果*[：“部署清单在语义上无效”和“部署清单缺少 <compatibleFrameworks>”](http://blogs.msdn.com/b/msiclickonce/archive/2010/08/03/clickonce-net-4-0-errors-quot-deployment-manifest-is-not-semantically-valid-quot-and-quot-deployment-manifest-is-missing-lt-compatibleframeworks-gt-quot.aspx)*，但它是不同过程 (msbuild) 的结果。这部分是 4.0 清单的新部分（并且是必需的），所以我唯一的猜测是，当 ManifestWriter 以某种方式将更改持久保存到磁盘时，它会以 3.5 的方式进行吗？我三次检查是否使用了正确的库（C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework.NETFramework\v4.0\Microsoft.Build.Tasks.v4.0.dll）。 **是什么赋予了？**

到目前为止，我尝试手动添加缺少的部分来代替答案：

```
dm.CompatibleFrameworks.Clear(); // Unnecessary as dm.CompatibleFrameworks.Count == 0 indeed!
CompatibleFramework cf = new CompatibleFramework();
cf.Version= "4.0";
cf.SupportedRuntime = "4.0.30319";
cf.Profile= "Client";
dm.CompatibleFrameworks.Add(cf);
cf = new CompatibleFramework();
cf.Version = "4.0";
cf.SupportedRuntime = "4.0.30319";
cf.Profile = "Full";
dm.CompatibleFrameworks.Add(cf); 
```

但这没有任何效果，无论我将这段代码*放在 dm.ResolveFiles( )*、*dm.UpdateFileInfo( )*还是*ManifestWriter.WriteManifest(..)*之前的位置！

我的结果类似于堆栈溢出问题*[MageUI.exe 删除 compatibleFrameworks 元素](https://stackoverflow.com/questions/6186282/)*或*[为什么 Mage.exe 不生成 compatibleFrameworks 属性？](https://stackoverflow.com/questions/2654320/)*或*[MageUI.exe 不包含 compatibleFrameworks 元素](https://stackoverflow.com/questions/3471194/)*，但我没有使用 `mageui`，`mage`甚至根本没有使用`msbuild`！

这是怎么回事？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-21T19:29:17.367

我自己想通了。罪魁祸首是*ManifestReader.ReadManifest("DeployManifest", sPathMft, **true** )*。

[MSDN](http://msdn.microsoft.com/en-us/library/ms125928)说，[preserveStream 参数] *“指定是否在结果清单对象的 InputStream 属性中保留输入流。ManifestWriter 使用它来重构未在对象表示中表示的输入。”*

话说回来，单独设置**true**是不够的： `dm.CompatibleFrameworks.Count`还是0，但是现在添加`CompatibleFramework`item会有效果！

对于同一条船上的其他人，我以前这样做过`dm.ResolveFiles( )`：

```
if(  dm.CompatibleFrameworks.Count <= 0  )
{
    CompatibleFramework cf= new CompatibleFramework( );
    cf.Profile= "Client";       cf.Version= "4.0";      cf.SupportedRuntime=    "4.0.30319";
    dm.CompatibleFrameworks.Add( cf );              //  cf= new CompatibleFramework( );
    cf.Profile= "Full";     //  cf.Version= "4.0";      cf.SupportedRuntime=    "4.0.30319";
    dm.CompatibleFrameworks.Add( cf );              /// no need for separate object
} 
```

@davidair，感谢您的建议！同意，尽管我更喜欢使用 API 对象（与 XML 相比）。
另一种选择是调用`mage`（直接调用或从 .cmd 文件调用），因为我们似乎[可以](http://msdn.microsoft.com/en-us/library/ff699301.aspx)重新分发它。

* * *

我还添加了以下部分，这对问题本身没有影响，但对于遵循相同路径的任何人来说可能非常重要（*/client*是部署根，并且可以自定义）：

```
dm.DeploymentUrl=   string.Format( "http://{0}/{1}/client/{1}.application",
                        Dns.GetHostName( ), Context.Parameters[ scTokVirtDir ] );
dm.UpdateMode=      UpdateMode.Background;
dm.UpdateUnit=      UpdateUnit.Weeks;
dm.UpdateInterval=  1;
dm.UpdateEnabled=   true; 
```

* * *

2019 年 10 月 8 日
刚刚偶然发现一个问题`app.manifest`：在部署期间删除了
`compatibility`带有元素的部分。`supportedOS`

相同的根本原因；读取它的行应设置`preserveStream`为**true**：

```
ApplicationManifest am = ManifestReader.ReadManifest( "ApplicationManifest", sPathMft, true ) as ApplicationManifest; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-03-23T14:07:50.340

我还需要添加 CompatibleFrameworks。我也尝试过像这样添加 CompatibleFrameworks（这不起作用）

```
dm.CompatibleFrameworks.Add(...); 
```

我的解决方案是设置：

```
dm.TargetFrameworkMoniker = ".NETFramework,Version=v4.0"; 
```

在此之后，Manifest 生成是正确的。

小心 如果您在 WriteManifest 之前设置 TargetFrameworkMoniker，您有两次 <compatibleFrameworks> 并且您的应用程序文件已损坏。这是我的解决方案：

```
DeployManifest dm = ManifestReader.ReadManifest("DeployManifest", applicationFileName, false) as DeployManifest;
dm.ResolveFiles();
//doing stuff..
dm.UpdateFileInfo();
ManifestWriter.WriteManifest(dm, applicationFileName);
dm.TargetFrameworkMoniker = ".NETFramework,Version=v4.0";
ManifestWriter.WriteManifest(dm, applicationFileName); 
```

# wpf - 无法在设计时指定 DataTrigger 值属性，有什么替代方法

> ID：11141657
> 
> 赞同：0
> 
> 时间：2012-06-21T15:34:55.710
> 
> 标签：wpf, treeview, datatrigger

我有一个树视图并单击每个树节点，树节点的详细信息将显示在树视图的右侧。每个树节点都有自己的视图模型。下面的代码显示了我如何显示细节：

当 Value="can be specified at design time" （我有 11 个）时，一切都很好。但是我有一个树节点的子节点具有不同的名称（请参见下面的代码值 =“无法在设计时指定”），因为它们是从数据库中表的两列动态检索的，并且在此处列出 4000 个或更多不现实。

名称 = "J" + 表名.标签 + "." + 表名。子标签；

```
<ContentControl Name="DetailContentControl" 
Content="{Binding ElementName=myTreeview, Path=SelectedItem, Mode=OneWay}">
   <ContentControl.ContentTemplate>
<DataTemplate>
    <ContentControl Name="CC" Content="{Binding }" />
        <DataTemplate.Triggers>
            <DataTrigger Binding="{Binding Path=Name}" Value="DXHeader">
          <Setter TargetName="CC" Property="ContentTemplate" Value="{StaticResource  DXHeaderDetailsTemplate }"/>
      </DataTrigger>
        <DataTrigger Binding="{Binding Path=Name}"  Value="Don't know at designed time">
    <Setter TargetName="CC" Property="ContentTemplate" Value="{StaticResource MyDetailsTemplate }"/>
        </DataTrigger>                      
     .....
       </DataTemplate.Triggers>
</DataTemplate>
    </ContentControl.ContentTemplate>
</ContentControl> 
```

如果我能做这样的事情，就不会有问题：

但是，DataTrigger.Value 属性不支持 Binding 表达式。

先感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T16:07:15.440

当您的触发器基于多个动态值时，请使用[MultiValueConverter](http://msdn.microsoft.com/en-us/library/system.windows.data.imultivalueconverter.aspx)

在这种情况下，您将使用绑定将您的名称和运行时值传递给转换器，并返回类似 true/false 值的内容

```
<DataTrigger Value="True">
    <DataTrigger.Binding>
        <MultiBinding Converter="{StaticResource IsNameEqualValueConverter}">
            <Binding Path="Name" />
            <Binding Path="PathToRuntimeValue" />
        </MultiBinding>
    </DataTrigger.Binding>
</DataTrigger> 
```

# facebook - Symfony2 FOSFacebookBundle 使用：

> ID：11141658
> 
> 赞同：0
> 
> 时间：2012-06-21T15:34:57.363
> 
> 标签：facebook, symfony, integration, bundle

我已经尝试了很多将 FOSFacebookBundle 集成到我的应用程序中，但无法对其进行配置。可能是 gitHub 指令有点混乱或其他任何东西：

在哪里学习和了解在 symfony 2.0 中轻松集成 FOSFacebookBundle 以方便从 facebook 登录。

**致命错误：在第 25 行调用 D:.....\projectName\vendor\bundles\FOS\FacebookBundle\FOSFacebookBundle.php 中的未定义方法 Symfony\Bundle\SecurityBundle\DependencyInjection\SecurityExtension::addSecurityListenerFactory()**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T12:18:32.723

`master`FOSFacebookBundle 的分支跟踪`master`Symfony 的分支，该分支当前用于 2.1 版本。由于您使用的是 Symfony 2.0，因此您需要使用`2.0`bundle 的分支。在您的`deps`文件中，按如下方式调整版本行：

```
[FOSFacebookBundle]
    git=git://github.com/FriendsOfSymfony/FOSFacebookBundle.git
    target=/bundles/FOS/FacebookBundle
    version=origin/2.0 
```

[有关存储库](https://github.com/FriendsOfSymfony/FOSFacebookBundle/tree/2.0)的更多详细信息，请参阅 2.0 分支的 README - 按照此处给出的详细安装步骤进行操作。

# java - 使用系统范围时的 NoClassDefFoundError

> ID：11141659
> 
> 赞同：5
> 
> 时间：2012-06-21T15:35:05.850
> 
> 标签：java, maven

我目前在将 Maven 与 NetBeans 7.1 一起使用时遇到问题 - 我包含了一个无法放入系统范围内的 Maven 存储库的库。它看起来像下面这样：

```
 <dependency>
    <groupId>org.company</groupId>
    <artifactId>FBTM</artifactId>
    <version>1.0-SNAPSHOT</version>
    <scope>system</scope>
    <systemPath>${project.basedir}/lib/FBTM-1.0-SNAPSHOT.jar</systemPath>
</dependency> 
```

IDE 似乎很好地选择了这个依赖项，因为它显示在 Dependencies 文件夹（项目视图）中，我能够查看 jar 内容。我也可以毫无问题地从 jar 中导入类。

但是，当我尝试运行我的项目（并且运行时有任何正在使用的类）时，我会得到一个有`NoClassDefFoundError`问题的类。它可以是任何类。

堆栈跟踪：

`Exception in thread "main" java.lang.NoClassDefFoundError: com/company/otaupdate/sim/commands/Select at com.company.fbtranslationlibrary.mc.scripts.UserData$1.<init>(UserData.java:30) at com.company.fbtranslationlibrary.mc.scripts.UserData.<init>(UserData.java:28) at com.company.fbtranslationlibrary.mc.MS.get_profile_script(MuscadeScript.java:80) at com.company.fbtranslationlibrary.mc.MS.access$300(MS.java:16)`

任何帮助或指示将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T15:46:19.640

对于系统范围：

[Maven 文档](http://maven.apache.org/guides/introduction/introduction-to-dependency-mechanism.html)说：

> 系统
> 
> 此范围类似于提供的范围，只是您必须提供明确包含它的 JAR。工件始终可用，不会在存储库中查找。

您的 IDE 以某种方式提供了 jar。但是在运行时*你*需要提供它。

尝试使用默认范围（根本没有范围标记）。

编辑：如果您希望 Maven 保持系统范围，则需要通过类路径提供 jar 运行时。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T15:11:23.880

我通过为项目创建以下 build.xml 解决了这个问题：

```
 <!-- make the repo dir -->
    <mkdir dir="${m2.home}" />

    <!-- copy libs -->
    <copy  todir="${m2.home}">
        <fileset dir="dist"/>
    </copy>

    <!-- copy pom -->
    <copy  todir="${m2.home}">
        <fileset dir="pom"/>
         <mapper>
            <mapper type="regexp" 
                from="pom.xml" to="${m2.app.name}-${m2.app.ver}.pom" />
        </mapper>
    </copy>

    <!-- use naming policy -->
    <copy  todir="${m2.home}">
        <fileset dir="dist"/>
        <mapper>
            <mapper type="regexp" 
                from="${m2.app.name}.jar" to="${m2.app.name}-${m2.app.ver}.jar" />
        </mapper>
    </copy>

    <!-- remove unnecessiary files -->
    <delete>
    <fileset dir="${m2.home}">
        <include name="${m2.app.name}.jar"/>
        <include name="README.TXT"/>
    </fileset>
    </delete>
</target> 
```

我还必须为项目手动创建一个 pom.xml 文件，然后使用相同的命名约定将其复制到本地存储库中。这不是可能的最佳解决方案，但效果很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T15:47:26.727

NetBeans 应用程序运行程序似乎不够聪明，无法将此 JAR 文件放在执行类路径中。

为什么不将此依赖项的 JAR 和 POM 文件添加到**本地**存储库？然后，您可以使用常规依赖项。

或者，看看是否有一种方法可以调整此应用程序的 NetBeans 应用程序启动器的运行时类路径。（我不确定我在这里使用了正确的术语……我是 Eclipse 人。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-17T15:59:24.330

尽量避免系统范围并使用中提到的解决方法

[http://eureka.ykyuen.info/2014/06/10/maven-include-system-scope-dependency-in-maven-assembly-plugin/](http://eureka.ykyuen.info/2014/06/10/maven-include-system-scope-dependency-in-maven-assembly-plugin/)

# magento - Magento - 更新订单和客户通知

> ID：11141666
> 
> 赞同：0
> 
> 时间：2012-06-21T15:35:25.523
> 
> 标签：magento, magento-1.6

在 Magento 订单中，可以选择向客户发送通知以更新他们的状态

我有一些订单`Processing`，但我似乎无法将它们更新为任何其他状态。

我想添加自定义状态，以便向客户发送通知。

在下拉列表中我可以选择`Warehouse`，这将通知客户他们的订单在仓库中

我该怎么做？

我正在使用 v1.6.2

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T08:10:09.513

可以在后端的系统 > 订单状态下创建自定义订单状态。

1.  创建新状态
2.  将其分配给一个州

![订单状态屏幕截图](../Images/f1d6f4effbbe163e84ee6875d2a28cef.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T15:52:22.057

您永远不应该使用 magento 的“状态”概念，因为“状态”概念已被编写为允许细节和详细状态。

要创建和链接（到现有的和本机 magento 状态）您的状态，您应该在模块的“config.xml”文件中添加一部分代码，如下所示：

```
<?xml version="1.0" encoding="UTF-8"?>
<config>

    [...]

    <global>

        [...]

        <sales>

            [...]

            <order>

                [...]

                <!-- Statuses declaration -->
                <statuses>
                    <avaiblable_in_warehouse translate="label">
                        <label>Avaiblable in Warehouse</label>
                    </avaiblable_in_warehouse>
                </statuses>
                <!-- Linking Status to a state -->
                <states>
                    <processing>
                        <statuses>
                            <avaiblable_in_warehouse />
                        </statuses>
                    </processing>
                </states>
            </order>
        </sales>
    </global>
</config> 
```

# c# - 使用 javascript/jquery 的部分页面回发

> ID：11141674
> 
> 赞同：0
> 
> 时间：2012-06-21T15:36:09.443
> 
> 标签：c#, asp.net

我的页面上有两个 asp.net 更新面板。其中一个有一个复选框，另一个有一些标签。我想在选中/取消选中复选框时更新第二个更新面板的内容。我正在使用以下代码：

```
 var prm = Sys.WebForms.PageRequestManager.getInstance();
 prm._doPostBack('UpdatePanel2', ''); 
```

但它正在整页回发。

请提出解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T15:49:48.223

您可以将复选框的 AutoPostback 设置为 True 并使其成为第二个 UpdatePanel 的触发器：

```
<asp:UpdatePanel ID="UpdatePanel1" runat="server">
    <ContentTemplate>
        <asp:CheckBox ID="CheckBox1" runat="server" AutoPostBack="True" />
    </ContentTemplate>
</asp:UpdatePanel>

<asp:UpdatePanel ID="UpdatePanel2" runat="server">
    <ContentTemplate>
        <asp:Label ID="Label2" runat="server" Text="Label"></asp:Label>
    </ContentTemplate>
    <Triggers>
        <asp:AsyncPostBackTrigger ControlID="CheckBox1" EventName="CheckedChanged" />
    </Triggers>
</asp:UpdatePanel> 
```

然后您可以在复选框的“CheckedChanged”事件处理程序中添加标签更改代码，例如

```
protected void CheckBox1_CheckedChanged(object sender, EventArgs e)
{
    Label2.Text = DateAndTime.Now;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T15:47:46.807

看来您正在寻找更新面板触发器，您不需要通过 javascript 来触发它...

# php - 如何捕获点击的网址？

> ID：11141678
> 
> 赞同：-1
> 
> 时间：2012-06-21T15:36:25.673
> 
> 标签：php, javascript, html

我有一个服务器，它通过将函数 *file_get_contents* 的结果回显到 URL 来加载 html 页面。我想在此之后获取用户单击的 URL。我试过了：

```
$result = file_get_contents('http://www.google.com/');

header('Content-Type: text/html; charset=iso-8859-1');

echo $result;

echo '<script type="text/javascript">',
  "Event.observe(document.body, 'click', function(event) {",
  'alert("hi");',
  '});</script>'; 
```

但我不知道为什么它不起作用！

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-21T15:46:43.533

你想要一个看起来像这样的脚本：

```
(function() {
  function onclick(event) {
    event = event || window.event;
    var target = event.target || event.srcElement;
    if (target.tagName && target.tagName.toLowerCase() === 'a') {
      alert(target.href);
    }
  }

  if (document.body.addEventListener) {
    document.body.addEventListener('click', onclick, false);
  } else if (document.body.attachEvent) {
    document.body.attachEvent('onclick', onclick);
  }
})(); 
```

这将在 IE 和其他浏览器中运行，而无需使用任何 JS 库。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-21T15:53:27.173

使用事件委托的建议：

```
(function()
{
    function callback(e)//IE doesn't pass event object, but we'll fix that
    {
        var target;
        e = e || window.event;//get IE event
        target = e.target || e.srcElement;//IE again
        if (target.tagName !== 'A')
        {
            return true;
        }
        //a link has been clicked, target holds a reference to that link, e is the click event
        alert(target.href);
        //to prevent the link to be followed:
        if (e.preventDefault)
        {// all major browsers, except for ie
            e.preventDefault();
            e.stopPropagation();
            return false;
        }//now IE again:
        e.returnValue = false;
        e.cancelBubble = true;
        return false;//not required to return here
    }

    if (document.body.addEventListener)
    {
        document.body.addEventListener('click',callback,false);
    }
    else
    {
        document.body.attachEvent('onclick',callback);//for IE > 9
    }
})(); 
```

这样，您只需将 1 个事件侦听器绑定到 1 个处理程序，它会处理在页面上任何位置单击的所有链接。如果您只想阻止/处理某些链接，您可以给它们一个不同的类，并像这样编辑回调函数：

```
if(target.tagName !== 'A')
//add extra check:
if (target.tagName !== 'A' && target.className !== 'handleThisLinkClass') 
```

google JavaScript 事件委托，这是一个非常有用的功能，尤其是在处理需要事件处理程序的大量元素时

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-21T15:46:08.093

更容易理解，但是这个方法使用的是JQuery，很多框架或者cmses中经常包含这个方法。

```
$(function(){
    $('a').click(function(){
        alert(this.href);
    });
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-21T15:45:53.147

您应该取消绑定单击事件，以便您的事件开始工作。

```
<?php
        $result = file_get_contents('http://www.google.com/');
        header('Content-Type: text/html; charset=iso-8859-1');
        echo $result;

        echo '<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.2.6/jquery.min.js"></script>';
        echo '
        <script type="text/javascript">
        $(document).ready(function(){
            $(document).unbind("click").click(function(){ alert("Hi!"); });
            // similarly
            $("a").unbind("click").click(function(){ alert($(this).attr("href")); return false; });
        });
        </script>';
?> 
```

# c# - C# - 如何测试扩展方法？

> ID：11141679
> 
> 赞同：9
> 
> 时间：2012-06-21T15:36:28.527
> 
> 标签：c#, mstest

我为一个`Person`类创建了这个 C# 扩展方法：

```
public static class PersonExtensions {
    public static void Rename(this Person person, String newName) {
        person.Name = newName;
    }
} 
```

我将如何对这种方法进行单元测试？我已经尝试过了，但该`Rename`方法不适用于`PersonAccessor`对象。

错误是“未找到重命名的私有访问器”

当我尝试 PersonExtensions_Accessor.Rename(somePerson, newName) 时，它说“有一些无效参数”

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-21T15:40:25.280

扩展方法只是引用静态方法的不同方式的语法糖。只需调用`PersonExtensions.Rename(...)`您的单元测试。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-03-07T00:37:01.933

我认为一个好的方法可以是直接在`Person`.

考虑到您已实现的方法，示例代码将是这样的：

```
using System;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using PersonExtension; // Don't forget about reference it

namespace UnitTest {
    [TestClass]
    public class UnitTest {
        Person person;
        [TestInitialize]
        public void Init() {
            person = new Person("Person name");
        }

        [TestMethod]
        public void TestRename() {
            Assert.AreEqual("Person name", person.Name);
            person.Rename("New name");
            Assert.AreEqual("New name", person.Name);
        }
    }
} 
```

请记住同时引用`Person`和`PersonExtension`类，并在实用程序类中具有正确的隐藏级别，以便可以访问其方法

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-21T15:39:03.560

这是我的生产代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace ClassLibrary1
{
   public class Person
   {
      public string Name { get; set; }
   }

   public static class PersonExtensions
   {
      public static void Rename(this Person person, String newName)
      {
         person.Name = newName;
      }
   }
} 
```

这是生成的测试的编辑版本：

```
using ClassLibrary1;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using System;

namespace TestProject1
{

    /// <summary>
    ///This is a test class for PersonExtensionsTest and is intended
    ///to contain all PersonExtensionsTest Unit Tests
    ///</summary>
   [TestClass()]
   public class PersonExtensionsTest
   {

      private TestContext testContextInstance;

      /// <summary>
      ///Gets or sets the test context which provides
      ///information about and functionality for the current test run.
      ///</summary>
      public TestContext TestContext
      {
         get
         {
            return testContextInstance;
         }
         set
         {
            testContextInstance = value;
         }
      }

      #region Additional test attributes
  // 
  //You can use the following additional attributes as you write your tests:
  //
  //Use ClassInitialize to run code before running the first test in the class
  //[ClassInitialize()]
  //public static void MyClassInitialize(TestContext testContext)
  //{
  //}
  //
  //Use ClassCleanup to run code after all tests in a class have run
  //[ClassCleanup()]
  //public static void MyClassCleanup()
  //{
  //}
  //
  //Use TestInitialize to run code before running each test
  //[TestInitialize()]
  //public void MyTestInitialize()
  //{
  //}
  //
  //Use TestCleanup to run code after each test has run
  //[TestCleanup()]
  //public void MyTestCleanup()
  //{
  //}
  //
  #endregion

      /// <summary>
      ///A test for Rename
      ///</summary>
      [TestMethod()]
      public void RenameTest()
      {
         Person person = new Person(); // TODO: Initialize to an appropriate value
         string newName = string.Empty; // TODO: Initialize to an appropriate value
         PersonExtensions.Rename(person, newName); // this could also be written as person.Rename(newName);
         Assert.AreEqual(person.Name, string.Empty);
      }
   }
} 
```

测试通过。

# entity-framework - EF 4.3.1 中的子集合急切加载失败

> ID：11141681
> 
> 赞同：0
> 
> 时间：2012-06-21T15:36:31.327
> 
> 标签：entity-framework, entity-framework-4, entity-framework-4.1, eager-loading

我有以下课程：

```
public class Configuration
{
    public long Id {get;set;}
    public string Name {get;set;}
    public Expression Criteria {get;set;}
}

public class Expression
{
    public long Id {get;set;}
    public string Value {get;set;}
    public ICollection<Parameter> Parameters {get;set;}
}

public class Parameter
{
    public long Id {get;set;}
    public MyType Type {get;set;}
}

public class MyType
{
    public long Id {get;set;}
    public string Name {get;set;}
} 
```

我正在尝试使用以下方法急切地加载整个配置对象：

```
dbContext.Configurations.Select(i => i.Criteria).Include(i => i.Parameters.Select(j => j.Type)).ToList() 
```

但是，我的 Parameters 属性为 null，并且没有被获取。

我究竟做错了什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T22:30:21.787

尝试这个：

```
dbContext.Configurations.Select(i => i.Criteria).Include("Parameters").Include("Parameters.Type").ToList() 
```

# usb - 使用 Arduino 将 Android 平板电脑连接到 USB 附件

> ID：11141682
> 
> 赞同：0
> 
> 时间：2012-06-21T15:36:35.850
> 
> 标签：usb, arduino, accessory

我有一个带有 USB Host Shield 的 Arduino 兼容板。它连接到运行带有内核 2.6.39.4 的“Ice Cream Sandwich”（Android 4.0.3）的 Acer A100 Android 平板电脑。（平板电脑有一个 USB 微型连接器，不支持 USB HOST 模式，因此无法直接连接到 USB 附件设备。）

这张照片显示了我能够成功完成的事情（但用我的平板电脑代替了手机）。 [http://www.seeedstudio.com/wiki/File:SeeeduinoADK_Setup.jpg](http://www.seeedstudio.com/wiki/File:SeeeduinoADK_Setup.jpg)

我想找到一个使用通过 Arduino 连接到 USB 附件（如键盘或闪存驱动器）的 Android 平板电脑的示例。

将 USB 附件连接到 Arduino 的 USB 微型连接器（使用外部电源）不起作用。

谁能给我提供这样的例子？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-23T05:46:33.753

理论上它应该可以工作，但我还没有尝试过。

Arduino 应该充当中间人，并且应该中继来自平板电脑和配件的信号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T06:08:43.580

你用什么代码？这是：**adk_release_20120606**？

你用的是什么板**SeeeduinoADK**？

我使用 Board Seeeduino ADK，但不幸的是我无法让它在**USB 附件模式下**工作。我的电路板仅在 ADB（**MicroBridge 模式**）下工作。查看我的[工作示例](http://english.cxem.net/arduino/arduino3.php)

我的平板电脑是 Ainol Aurora，Android 版本 4.0.4 (CyanogenMod 9)

# android - FrameLayout 的子项在某些设备上不可点击

> ID：11141683
> 
> 赞同：3
> 
> 时间：2012-06-21T15:36:38.543
> 
> 标签：android, onclick, android-framelayout, xml-layout

我设计了一个菜单，其中包含几个不同 LinearLayouts 中的几个按钮，所有这些按钮都放置在 FrameLayout 内的动画 GLSurfaceView 上。当用户点击界面中的一个按钮时，我`GONE`在进行下一个布局之前将当前布局的可见性设置为`VISIBLE`当用户选择一个关卡时，游戏开始并且所有布局都是`GONE`（除了屏幕右侧的控制栏，但这不包含在 FrameLayout 中）

在大多数手机上，菜单就像一个魅力，但我在 Xperia Ray 上做了一个快速测试，却发现我无法去任何地方，因为按钮不会点击。我`Log.d`在大多数 onClick 侦听器中都设置了标签，在这种情况下，它们没有显示在 Logcat 中，因此侦听器似乎根本没有触发。我还注意到 GLSurfaceView 没有从它自己的 TouchEventListener 中返回任何内容。即使在顶部菜单中通过点击 GLSurfaceView 触发的功能被禁用，我通常仍然会在 Logcat 中收到一条消息。

我认为这可能与我使用 FrameLayout 的方式有关。[文档](http://developer.android.com/reference/android/widget/FrameLayout.html)说它应该只有一个孩子，但我在 android 开发人员上阅读的另一篇文章通过在 FrameLayout 内的 ImageViews 上显示文本来演示字幕图像。

最后一点，我还要说我已经在模拟器中进行了测试，我发现 android v2.3 和 android v4 都显示了与 ray 相同的行为。目前，除了可以完美运行我的应用程序的 android v2.2 之外，这些是我唯一确定的。我对是否相信模拟器上的测试结果犹豫不决。

我个人很难过，因为没有错误消息可以继续，但是有人可以提出解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-23T22:16:20.247

我找到了解决方案。

原来，我的布局中有一个流浪者`ScrollView`，它在 z 顺序中位于我的根布局之上，并且默认情况下可见。我没有切换这个视图的可见性，而是为了它的子布局。哎呀。

在我测试过的大多数设备上，流浪`ScrollView`并没有影响我的应用程序的功能，可能是因为空布局允许点击它后面的按钮。然而事实证明，某些设备，例如 Xperia Ray，对点击是否可以通过布局传递（可能是性能决定）更加严格。

The `ScrollView` was a required part of the layout so I couldn't just remove it. Instead I gave the the `android:visibilty` attribute to the ScrollView so that it would be `GONE` until it is needed by the interface and it won't block the user from clicking buttons.

# c# - View 如何知道在 WPF 中使用什么 ViewModel？

> ID：11141692
> 
> 赞同：25
> 
> 时间：2012-06-21T15:37:06.773
> 
> 标签：c#, wpf, mvvm

有人可以解释 View 和 ViewModel 是如何连接的吗？我在任何地方都找不到引用 ViewModel 的 View 的 xaml 或 xaml.cs，也找不到引用 View 的 ViewModel.cs 文件中的任何内容，但它们以某种方式连接，并且将 ViewModel 中的成员绑定到 View 工作.

此外，在每个的构造函数中，只有 View 的 InitializeComponent 和 ViewModel 的基本构造函数（没有 View 的声明/定义）。

谢谢！

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-06-21T15:40:33.720

这里有多种选择。

*必须将视图设置为*ViewModel*`DataContext`的实例。这里有很多选择：*

 **   这可以直接在 xaml 中完成（视图只是直接实例化 ViewModel）。
*   这可以在 View 的构造函数 ( `this.DataContext = new MyViewModel();`)中完成
*   这可以通过一个`DataTemplate`
*   “协调”类可以将它们连接在一起（即：单独的“演示者”类可以构造两者并`DataContext`适当地设置）

最常见的是让 View 在 xaml 中定义 VM（View-first），或者让所有内容都基于以 ViewModel 为中心的观点，并让 WPF 基于绑定的 VM 自动创建 View（ViewModel-第一的）。

前一种方法是许多工具包使用的方法，例如[MVVM Light](http://mvvmlight.codeplex.com/)。后一种方法是我在我的[MVVM 博客系列](http://reedcopsey.com/series/windows-forms-to-mvvm/)中使用的，并被其他一些工具包使用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-21T16:00:52.997

将视图连接到视图模型的“干净”方式是......

创建视图时，对于每个视图，将其 DataSource 设置为其视图模型：

例如

```
public class App
{
    private void OnAppStart()
    {
        var model = new MainModel();
        var vm = new MainVM();
        var view = new MainWindow();

        vm.Model = model;
        view.DataSource = vm;

        view.Show();
    }
} 
```

当您查看的模型发生变化时，更新 V​​M：

```
public class MainVM
{
    private void OnSelectedModelItemChanged()
    {
        this.SelectedItem = new ItemVM();
        this.SelectedItem.Model = this.SelectedModelItem;
    }
} 
```

并使用数据模板使视图为每个 VM 选择正确的子视图。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-21T15:39:48.080

视图包含 xaml 中视图模型类的对象。

InitializeComponent 函数创建页面上的所有控件、设置样式等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-08-05T17:09:12.687

正如其他人已经表明的那样，有多种选择。当然，每当您听到多种选择时，您都必须想知道每种选择的优点和缺点是什么。好吧，事实证明，除了一个之外，它们都有主要的缺点。

以下方法不涉及外部库，没有额外的管理类和接口，几乎没有魔法，并且非常灵活，因为您可以拥有包含其他视图模型的视图模型，并且您可以实例化它们中的每一个，因此您可以将构造函数参数传递给他们。

## 对于主窗口的视图模型：

```
using Wpf = System.Windows;

public partial class TestApp : Wpf.Application
{
    protected override void OnStartup( Wpf.StartupEventArgs e )
    {
        base.OnStartup( e );
        MainWindow = new MainView();
        MainWindow.DataContext = new MainViewModel( e.Args );
        MainWindow.Show();
    }
} 
```

## 对于所有其他视图模型：

这是在 MainViewModel.cs 中：

```
using Collections = System.Collections.Generic;

public class MainViewModel
{
    public SomeViewModel SomeViewModel { get; }
    public OtherViewModel OtherViewModel { get; }
    public Collections.IReadOnlyList<string> Arguments { get; }

    public MainViewModel( Collections.IReadOnlyList<string> arguments )
    {
        Arguments = arguments;
        SomeViewModel = new SomeViewModel( this );
        OtherViewModel = new OtherViewModel( this );
    }
} 
```

这在 MainView.xaml 中：

```
[...]
xmlns:local="clr-namespace:the-namespace-of-my-wpf-stuff"
[...]
    <local:SomeView DataContext="{Binding SomeViewModel}" />
    <local:OtherView DataContext="{Binding OtherViewModel}" />
[...] 
```

如您所见，视图模型可以简单地成为另一个视图模型的成员（子）；在这种情况下，SomeViewModel 和 OtherViewModel 是 MainViewModel 的子项。然后，在 MainView 的 XAML 文件中，您可以只实例化每个子视图并将其指定`DataContext`给`Binding`相应的子视图模型。*

# javascript - Google Maps 检测到 event.addlistener 内的标记点击

> ID：11141696
> 
> 赞同：1
> 
> 时间：2012-06-21T15:37:32.560
> 
> 标签：javascript, google-maps, google-maps-api-3, google-maps-markers

目前我有一个`bounds_changed`监听器正在清除标记覆盖，然后在地图边界内重新创建标记。

但是，每当单击标记并且地图移动时，信息窗口都不会显示。既然灭了。如何将 if 语句添加到以下内容，该语句将检测是否完成了对标记的点击，如果是，则不执行任何其他操作`clearOverlays`，并且`createMarkers`.

```
google.maps.event.addListener(map, 'bounds_changed', function() { 
        //alert(map.getBounds()); 
        clearOverlays();
        createMarkers(map, mgr);          
    }); 
```

例如

```
if(marker.click) {
} else {
    clearOverlays();
    createMarkers(map, mgr);      
} 
```

最终工作代码。

```
google.maps.event.addListener(map, 'bounds_changed', function() { 
        if(checkevent == false)
        {
            //alert(checkevent);
            clearOverlays();
            createMarkers(map, mgr);          
        }
    }); 
```

并在标记的侦听器中单击

```
google.maps.event.addListener(marker5, 'click', function() { checkevent = true;  infowindow5.open(map,marker5); setTimeout('checkevent = false', 3000); }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T17:00:32.073

假设您有一个标记单击事件的侦听器，请将一个状态变量设置为事件侦听器的外部范围。在您的 bounds_changed 侦听器中，检查状态变量。始终在 bound_changed 侦听器结束时重置状态变量。

# objective-c - XCode如何在按下另一个按钮时更改按钮的文本

> ID：11141697
> 
> 赞同：-1
> 
> 时间：2012-06-21T15:37:32.947
> 
> 标签：objective-c, xcode, uibutton

> **可能重复：**
> [按下 UIbutton 后如何更改 UIbutton 标题？](https://stackoverflow.com/questions/8966769/how-to-change-uibutton-title-once-a-uibutton-is-pressed)

我想在按下另一个 UIButton 时更改 UIButton 的文本有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T16:35:00.130

这个问题已经在[这里](https://stackoverflow.com/questions/8966769/how-to-change-uibutton-title-once-a-uibutton-is-pressed)回答了。这并没有花太多时间找到，有些人可能会因为没有对你的问题做太多研究而感到有点奇怪，所以要准备好收到很多重复的问题，而人们会因此而给你不好的名声。

请阅读[常见](https://stackoverflow.com/faq)问题解答以获得有关提出好问题的帮助。

# python - Flask：在一个应用程序中使用多个包

> ID：11141710
> 
> 赞同：6
> 
> 时间：2012-06-21T15:37:52.550
> 
> 标签：python, routing, blogs, packages, flask

我刚刚开始使用烧瓶，但遇到了一个障碍。我正在尝试写一个小博客来习惯这个框架，所以我做了两个包，一个“auth”和“posts”。我通读了[Flask 文档](http://flask.pocoo.org/docs/patterns/packages/)中的大型应用程序部分。

我的目录看起来像这样。

```
>/root
>>run.py 

>>/posts

>>>____init____.py  
>>>views.py  
>>>/templates
>>>/static  

>>/auth  
>>>____init____.py  
>>>views.py  
>>>/templates
>>>/static 
```

run.py 看起来像这样：

```
from flask import Flask
from auth import auth_app
from posts import posts_app

auth_app.run()
posts_app.run() 
```

`/posts/__init__.py``/auth/__init__.py`看起来像这样：

```
from flask import Flask

auth_app = Flask(__name__)

import auth.views 
```

view.py 看起来像这样：

```
from auth import auth_app

@auth_app.route('/auth/')
def index():
    return "hello auth!" 
```

但是每当我运行服务器时，只有 localhost/auth/ 可用，其他所有内容都会给出 404，所以我假设帖子应用程序没有运行。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-21T15:55:17.370

您的 auth_app.run() 方法会阻止您的程序继续运行。这就是 posts_apps 应用程序无法运行的原因。提供页面的整个过程发生在 Flask 的 run() 方法中。因此，您可以得出结论，您不能在同一进程中运行两个 Flask 应用程序。

如果您希望像这样将应用程序分成两部分，推荐的方法是使用[blueprints](http://flask.pocoo.org/docs/blueprints/#blueprints)。您无需创建两个应用程序（身份验证和帖子），而是创建两个蓝图。然后你像这样创建一个应用程序......

```
from flask import Flask
from auth import auth_blueprint
from posts import post_blueprint

app = Flask(__name__)
app.register_blueprint(auth_blueprint)
app.register_blueprint(post_blueprint)
app.run() 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-12-29T22:37:22.307

尽管 Mark 使用蓝图的方法似乎很适合您的项目，但如果您想为每个包使用单独的应用程序，您应该研究[`werkzeug.wsgi.DispatcherMiddleware`](http://flask.pocoo.org/docs/0.10/patterns/appdispatch/).

运行第一个应用程序后，单个进程无法运行第二个应用程序（就像您的问题一样），但这不是 DispatcherMiddleware 的问题。您可以使用它来定义主应用程序以及基于 URL 前缀的其他应用程序。

文档上的示例区分了两个应用程序——前端和后端——它们的运行取决于用户请求的 URL。

如果您想了解更多信息，请阅读 Matt Wright 的[“我如何构建我的 Flask 应用程序”](http://mattupstate.com/blog/how-i-structure-my-flask-applications/)并查看他的示例项目[Overholt](https://github.com/mattupstate/overholt/blob/master/wsgi.py)。他决定使用两个应用程序：一个用于主网站（前端），另一个用于 API，他根据 URL 前缀创建了两者之间的区别。从他的代码*：

```
    从 werkzeug.serving 导入 run_simple
    从 werkzeug.wsgi 导入 DispatcherMiddleware
    从overholt导入api，前端

    应用程序 = DispatcherMiddleware(frontend.create_app(), {
        '/api': api.create_app()
    })

    如果 __name__ == "__main__":
        run_simple('0.0.0.0', 5000, 应用程序, use_reloader=True, use_debugger=True)

```

这样，他创建了两个应用程序，其中每个应用程序都有其定义的视图、配置等集合，并且能够从同一个 Python 解释器进程运行它们。

*请注意，这`run_simple()`仅用于开发——而非生产。

# c# - AuthCookie 已设置，仍被重定向到 login.aspx

> ID：11141716
> 
> 赞同：3
> 
> 时间：2012-06-21T15:38:13.790
> 
> 标签：c#, asp.net, authentication, forms-authentication, mixed-authentication

我正在 C# Web 应用程序中设置混合模式身份验证。我在 WindowsAuthentication 网站中设置了 AuthCookie，然后尝试重定向到 FormsAuthentication 网站。我认为 cookie 位于正确的路径中，因为 Context.Request.IsAuthenticated 是正确的。不幸的是，我一直被重定向到 FormsAuthentication 网站的登录页面，就好像我没有设置 AuthCookie 一样。到底是怎么回事？

我不熟悉 ASP.NET 中的身份验证是如何工作的，所以请像我 5 岁一样向我解释一下。谢谢，:)

编辑：这是制作 cookie 的 WindowsAuth 站点的 Global.asax 中的事件。此站点当前位于 FormsAuth 站点“下”的路径 /authentication 中。

> ```
> void Application_PostAuthenticateRequest(Object sender, EventArgs e)
> {
>     WindowsIdentity ident = WindowsIdentity.GetCurrent();
>     WindowsPrincipal p = new WindowsPrincipal(ident);
>     if (p.Identity.IsAuthenticated)
>     {
>         HttpCookie cookie = FormsAuthentication.GetAuthCookie(p.Identity.Name, false);
>         FormsAuthenticationTicket ticket = FormsAuthentication.Decrypt(cookie.Value);
>         // Store roles inside the Forms cookie.
>         FormsAuthenticationTicket newTicket = new FormsAuthenticationTicket(
>             ticket.Version, ticket.Name, ticket.IssueDate, ticket.Expiration,
>             ticket.IsPersistent, "", ticket.CookiePath);
>         string encTicket = FormsAuthentication.Encrypt(newTicket);
>         Context.Response.Cookies.Add(new HttpCookie(".GWBTroubleTickets", encTicket));
>     }
>     Response.Redirect("/employee/home.aspx");
> } 
> ```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T12:23:53.313

每个页面可能会多次调用该事件。- [https://stackoverflow.com/a/5947309/57883](https://stackoverflow.com/a/5947309/57883) 你没有`if/else`周围的`Response.Redirect("/employee/home.aspx");`

尝试使用自定义属性而不是此事件

# java - Java解析部分日期

> ID：11141717
> 
> 赞同：2
> 
> 时间：2012-06-21T15:38:16.037
> 
> 标签：java, date, locale

使用`SimpleDateFormat.parse(String)`要求格式中指定的所有字段都存在于输入字符串中。我想要的是某种针对相同格式验证部分输入字符串的方法。

例如，`Format="yyyy/MM/dd HH:mm:ss"`and`Input="2012/01/01"`应该匹配，并且一天中的时间应该设置为零。

有没有办法做到这一点？当前，`SimpleDateFormat`引发异常。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-21T15:58:05.637

试试[`DateUtils#parseDate(String, String[])`](http://commons.apache.org/lang/api-2.5/org/apache/commons/lang/time/DateUtils.html#parseDate%28java.lang.String,%20java.lang.String%5b%5d%29)Apache Utils 的。它将允许您传递一系列允许的格式，并尝试每种格式，直到合适为止。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T15:41:53.593

使用 2 个不同的`SimpleDateFormat`对象，每个对象都有不同的日期格式，然后使用第一个。如果抛出解析异常，则使用另一个。

最好的解决方案恕我直言，您首先使用正则表达式检查字符串，以便知道要使用哪种解析格式。也可能您想在正则表达式中使用分组并自己形成日期（例如使用`Calendar`），而不是至少两次解析字符串（一次通过正则表达式，第二次通过`DateFormat`）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T15:59:52.050

这是实现m0skit0提出的解决方案的一种方法，使用多个`SimpleDateFormat`您可以使用try catch级联解析，例如：

```
SimpleDateFormat fullFormat = new SimpleDateFormat("yyyy/MM/dd HH:mm:ss");
SimpleDateFormat shortFormat = new SimpleDateFormat("yyyy/MM/dd");

String input="2012/01/01";
Date res;
try {
    res = fullFormat.parse(input);
} catch (ParseException e) {
    res = shortFormat.parse(input);
} 
```

# return - 我正在尝试在 Python 中使用“return”语句，但它不起作用。

> ID：11141722
> 
> 赞同：1
> 
> 时间：2012-06-21T15:38:24.633
> 
> 标签：return, python-2.7

我正在尝试使用 return 语句。如果 y 为负数，则程序将终止。但它显示“ValueError：数学域错误”

```
import math
y=-5
def df(y):
if y<=0:
        print y, "is negative"
        return
result = math.log(y)
print "The log of y is",result 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T15:51:38.517

我有这种感觉，你想将你的日志调用包含在 df() 函数中，然后先检查它是否为负。

```
import math
y=-5
def df(y):
    if y<=0:
        print y, "is negative"
        return
    result = math.log(y)
    return result

print "The log of y is", df(y) 
```

要让你的函数返回一个值，你必须指定它应该返回什么。否则返回无

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T15:45:53.877

Return 将控制权交还给调用者。在这种情况下，如果您想获取函数的值，则需要调用它，并且需要该函数实际返回一些内容。也许是这样的：

```
import math

def df(v):
    if v <= 0:
        print v, "is negative"
        return

y = -5
df(y)
result = math.log(y)
print "The log of y is",result 
```

尽管我不确定您要做什么。如果你想让你的函数返回一些东西，你可以使用下面的语法：

```
return [something] 
```

... 将 [something] 替换为要返回其值的值或变量。math.log 返回其参数的对数。您已经知道如何保存函数的返回值：

您希望这会导致程序退出。如果从 main 方法使用，即在任何函数之外，返回只会退出程序。Return 将控制权交还给调用例程（如果没有调用例程，则程序退出）。您可能想改用 exit 调用：

```
import sys
...
sys.exit(0) 
```

`sys.exit`将立即终止程序，将提供的值传递回调用程序。如果您不知道这是什么，您可以使用值 0。

```
result = math.log(y) 
```

至于您的错误消息，您不能取负数的对数，而是尝试正数。（也不是 0）

我想你想要这样的东西：

```
import math

def df(v):
    if v <= 0:
        print v, "is negative"
        return True # returns true if the value is negative or zero
    return False    # otherwise returns false

y = -5
if df(y):           # test if negative or positive, branch on return value
    return          # if value was negative or zero, return (exit program)
result = math.log(y)
print "The log of y is",result 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T15:47:30.917

你的回报是空的......在“回报”的同一行上没有变量名或值。例如，如果您想返回值 5，您可以输入

```
return 5 
```

如果你想返回一个变量 foo，你会放

```
return foo 
```

现在你什么都没有返回。

也许你想要这个？

```
import math
y=-5
def df(y):
    if y<=0:
        print y, "is negative"
        return "impossible to calculate"
    result = math.log(y)
    return result

print "The log of y is", df(y) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-21T15:53:38.430

正如我在编程中学到的那样，任何功能都需要 3 个部分：

（1）输入，当你“定义”一个函数时，你需要知道你想把什么放入函数中。

例如：

```
def function (input1, input2): 
```

我们还将这些输入称为**参数**。

**(2) 你需要显示输出：**

例如，在您提供的代码中，如果您想返回变量“result”持有的数字，您可以执行以下操作：

```
return result 
```

或者，如果您不想返回或输出任何内容，您可以执行以下操作：

```
return None 
```

在 python 中，None 没有任何意义，至少你现在可以这么想。

(3)功能就是为你做事，所以之间的事

```
def function(inputs): 
```

到

```
return None 
```

是您必须将变量从输入修改为返回（或输出）。

希望它有所帮助，并且总是在提出任何问题之前工作。祝你在 Python 上好运

# jquery - jQuery UI：可排序和可拖动 + 可排序和可放置

> ID：11141723
> 
> 赞同：1
> 
> 时间：2012-06-21T15:38:25.490
> 
> 标签：jquery, jquery-ui, jquery-ui-draggable, jquery-ui-sortable, jquery-ui-droppable

我有两个清单。它们是可排序但未连接的（列表“一”的元素不能与列表“二”的元素混合）

我希望列表“一”的元素是可放置的，而列表“二”的元素是可拖动的，因为我想将列表“二”的元素拖放到列表“一”中。

我应该怎么做？

**编辑：**

我试图使问题尽可能笼统，但也许我应该更清楚......对不起。列表一的元素是“类别”，它们应该是可排序的。列表二的元素是“链接”，应该是可排序的。一个链接只属于一个类别。我想将链接从一个类别移动到另一个类别，我很想使用 JQuery Ui。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T16:16:10.897

如果我正确理解您的问题，您不必在您的情况下使用`draggable`和`droppable`结合`sortable`。

可排序连接本质上是单向的，因此您只需将第二个列表连接到第一个，并避免将第一个连接到第二个：

```
<ul id="first">
    <!-- ... -->
</ul>

<ul id="second">
    <!-- ... -->
</ul> 
```

* * *

```
$("#first").sortable();
$("#second").sortable({
    connectWith: "#first"
}); 
```

# jquery - 我在哪里可以找到学习 jQuery 的教育游戏？（类似于再生）

> ID：11141737
> 
> 赞同：1
> 
> 时间：2012-06-21T15:39:34.263
> 
> 标签：jquery

我正在尝试通过玩教育游戏（用于学习 jQuery）来提高我的 jQuery 技能。但是，我似乎找不到一个，因为每次我用“jQuery”和“game”搜索一些东西时，我都会得到 jQuery 游戏开发的结果。我真的很想通过玩类似于 regenemies ( [http://darevay.com/regenemies/](http://darevay.com/regenemies/) ) 的游戏来学习 jQuery，我曾经用它来学习正则表达式。

有谁知道那里有任何应用程序/游戏可以在 jQuery 选择器等方面对您进行测验？我可以看到一堆 jQuery 测验，但这并不是我真正想要的......

我希望我能找到一个汇集大量编程教育游戏的网站。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T15:45:17.737

*   [http://learnjquery.tutsplus.com/](http://learnjquery.tutsplus.com/)
*   [http://www.codecademy.com/tracks/jquery](http://www.codecademy.com/tracks/jquery)

不是免费的

*   [https://learnable.com/courses/jquery-fundamentals-1132](https://learnable.com/courses/jquery-fundamentals-1132)
*   [http://www.lynda.com/jQuery-tutorials/essential-training/48370-2.html](http://www.lynda.com/jQuery-tutorials/essential-training/48370-2.html)
*   [http://www.jquery4u.com/news/50-awesome-online-jquery-course/#.T-NBnfV5dIY](http://www.jquery4u.com/news/50-awesome-online-jquery-course/#.T-NBnfV5dIY)
*   [http://jquery-online-training.eventbrite.com/](http://jquery-online-training.eventbrite.com/)
*   [http://appendto.com/training](http://appendto.com/training)
*   [http://teamtreehouse.com/library/websites/build-an-interactive-website](http://teamtreehouse.com/library/websites/build-an-interactive-website)

也在这里：[https ://stackoverflow.com/questions/4442348/can-anyone-recommend-a-good-jquery-training-course](https://stackoverflow.com/questions/4442348/can-anyone-recommend-a-good-jquery-training-course)

# python - 如何从 mimerender 返回 406 错误代码？

> ID：11141740
> 
> 赞同：-2
> 
> 时间：2012-06-21T15:39:48.067
> 
> 标签：python, rest

我正在开发一个 REST API，我真的很喜欢使用内容协商来确定要发送哪些表示的想法。我的应用程序基于 Flask 框架，因此我自然而然地使用 mimerender 包。我有适用于 HTML、JSON 和 XML 的资源变体选择。但后来我尝试了一个虚假的 mimetype，比如 application/foobar。我希望看到 406 错误代码，但我得到了 200 响应代码和 XML 表示。

查看源代码，似乎 mimerender 默认为其 mimetypes 列表中的第一个 mimetype，目前是 XML。

我的问题是两部分：

1.  编写 mimerender 的人（我希望他能阅读这个问题）知道他在做什么，并且出于某种充分的理由，他一定是故意选择提供默认表示而不是 406 错误代码。发送一些（有点随机的）表示而不是告诉客户您只是没有他们要求的东西的原因是什么？

2.  假设我固执地不想发送默认表示，而我更喜欢发送 406 错误，我该如何在 Flask 和 mimerender 的范围内做到这一点？我能想到的一种可能性是注册一个虚假的 mimetype，将其设置为默认值，然后在其处理程序中调用 abort(406)。但这似乎很老套。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T16:29:45.297

我想我没有对这个案子给予足够的思考。根据[规范](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.4.7)，返回不可接受的响应仍然可以：

> HTTP/1.1 服务器允许根据请求中发送的接受头返回不可接受的响应。在某些情况下，这甚至可能比发送 406 响应更可取。鼓励用户代理检查传入响应的标头以确定它是否可以接受。

我[刚刚添加](https://github.com/martinblech/mimerender/commit/61a38a01dbe139db502ad375c8b281e440727aeb)了一个可选的布尔标志，它使[mimerender](https://github.com/martinblech/mimerender)以 406 失败。希望这也能涵盖您的用例。

# java - 使用 JPQL 从实体的 ElementCollections 中删除

> ID：11141744
> 
> 赞同：4
> 
> 时间：2012-06-21T15:40:08.993
> 
> 标签：java, hibernate, jpql

我的实体`User`有一个基本集合：

```
@ElementCollection
private Set<String> completedQuests = Sets.newHashSet(); 
```

如何从该集中*为所有/多个用户*删除一些值？这个伪查询的正确 JPQL 是什么？

```
DELETE FROM User.completeQuests
WHERE value IN (:collectionOfValues) 
```

（也欢迎仅使用 Hibernate 的替代方案，虽然不是首选。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T16:05:33.630

如果一切都失败了，原生 SQL。

```
em
    .createNativeQuery(
        "DELETE FROM user_completedquests " +
        "WHERE completedquests IN (:daily)"
    )
    .setParameter("daily", dailyQuests)
    .executeUpdate(); 
```

（还没有测试过）

# regex - 为什么这个正则表达式不匹配

> ID：11141751
> 
> 赞同：1
> 
> 时间：2012-06-21T15:40:32.627
> 
> 标签：regex, tcl

我对以下正则表达式有疑问：

我想匹配以下字符串：`employee Type="entry" id="mmop" location="somewhere"` 使用 RE 如下：

```
if {[regexp {id=(".*")} $data -> Id]} {
          #do something here
    } 
```

但我得到的结果是`"entry" id="mmop" location="somewhere"`，如何解决？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T15:43:31.020

`?`在 之后添加`*`，或替换`.`为`[^"]`。问题是由`.*`贪婪引起的，在仍然匹配模式的同时抓住一切。

# hql - @ManyToMany 在删除时违反参照完整性约束

> ID：11141754
> 
> 赞同：0
> 
> 时间：2012-06-21T15:40:34.477
> 
> 标签：hql

## @ManyToMany 在删除时违反参照完整性约束

* * *

我有这种多对多关系

```
 @ManyToMany(cascade = CascadeType.REMOVE, fetch = FetchType.EAGER)
    @JoinTable(
            name="tbl_settings_employees",
            joinColumns = @JoinColumn(name = "id"),
            inverseJoinColumns = @JoinColumn( name = "employee_id")
    )
    private Set<Employee> employeeSet; 
```

这不允许我删除主要对象。换句话说，就我而言，我无法从数据库中删除员工。

对于这个示例，我有 4 个表，一个用户表、一个设置表、一个 settings_edit_employee_set 表和一个员工表。

这些是表格和关系：

```
|---------|  |----------------------------|
| tbl_user|  | tbl_settings               | 
| --------|  | ---------------------------|
| Id (PK) |  | Id (PK)| user_id (PK ref tbl_user) 
|---------|  |----------------------------|
| 1       |  | 1      | 1                 |
| 2       |  | 2      | 2                 |
| 3       |  | 1      | 2                 |
| 4       |  | 2      | 1                 |
| etc     |  |etc     |etc                |
|---------|  |----------------------------|

|-------------------------------|
| tbl_settings_employees (pk=composite) 
| ------------------------------|
| Id (PK ref tbl_settings)      |
|        | Employee_ID(PK ref tbl_employee) 
|-------------------------------|
| 1      | 150                  |
| 1      | 149                  |
| 2      | 150                  |
| 2      | 151                  |
| etc    | etc                  |
|-------------------------------|

|-------------|
| tbl_employee| 
| ------------|
| Id PK       |
|-------------|
| 149         |
| 150         |
| 151         | 
| etc         | 
|-------------| 
```

**简而言之：**
我想从我的数据库中删除一个对象，但我现在不能；因为它给出了参照完整性约束违反异常：

```
org.h2.jdbc.JdbcSQLException: Referential integrity constraint violation: 
"FKE5EF0384FB556B15: PUBLIC.TBL_SETTINGS FOREIGN KEY(EMPLOYEE_EMPLOYEE_ID) REFERENCES 
PUBLIC.TBL_EMPLOYEE(EMPLOYEE_ID) (2)"; SQL statement:
delete from tbl_employee where bsn='234234234' [23503-166] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T12:54:09.737

有类似的问题

```
@ManyToMany(targetEntity = DdoMaster.class)
    @Cascade(value = {CascadeType.DELETE, CascadeType.SAVE_UPDATE})
    @JoinTable(name = "acct_account_ddo_mapping", joinColumns = @JoinColumn(name = "fk_accountid", referencedColumnName = "pk_accountname"), inverseJoinColumns = @JoinColumn(name = "fk_ddoid", referencedColumnName = "pk_ddoid"))
    @RemoteProperty
    public Set<DdoMaster> getDdoMaster() {
        return ddoMaster;
    }

    public void setDdoMaster(Set<DdoMaster> ddoMaster) {
        this.ddoMaster = ddoMaster;
    } 
```

现在，从表中删除行时，它抛出了 Dataintegrity 异常，只需先清除集合，然后再删除该行....

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T15:48:05.233

尝试： cascade = CascadeType.DETACH

# ios - iOS - 这是生成 APNS 生产证书的正确过程吗？

> ID：11141757
> 
> 赞同：4
> 
> 时间：2012-06-21T15:40:41.067
> 
> 标签：ios, certificate, push-notification, apple-push-notifications, production

这是生成 PRODUCTION 证书的正确过程吗？

```
openssl x509 -in aps_development.cer -inform der -out myCert.pem

openssl pkcs12 -nocerts -out myKey.pem -in myCert.p12

cat myCert.pem myKey.pem > my.pem 
```

.. 进而：

```
$ctx = stream_context_create();
stream_context_set_option($ctx, 'ssl', 'local_cert', 'certificati/my.pem');
stream_context_set_option($ctx, 'ssl', 'passphrase', $passphrase);

// Open a connection to the APNS server
$fp = stream_socket_client(
    'ssl://gateway.push.apple.com:2195', $err,
    $errstr, 60, STREAM_CLIENT_CONNECT|STREAM_CLIENT_PERSISTENT, $ctx); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-21T15:54:19.423

是的，在我看来一切都很好。

您可以根据以下优秀教程检查您的生产命令：

[http://www.raywenderlich.com/3443/apple-push-notification-services-tutorial-part-12](http://www.raywenderlich.com/3443/apple-push-notification-services-tutorial-part-12)

您连接到实时 APNS 服务器的 PHP 代码似乎同样有效。您可以在此处将其与一些好的答案进行比较：

[https://stackoverflow.com/a/8249772/766441](https://stackoverflow.com/a/8249772/766441)

[https://stackoverflow.com/a/9536457/766441](https://stackoverflow.com/a/9536457/766441)

您也可以考虑将服务器地址切换到沙盒 APNS 服务器，测试所有代码，然后在准备提交应用程序时将 URL 切换到实时服务器。

希望这可以帮助。

# php - 如何在 Txt 文件中搜索和查找。然后使用找到的变量

> ID：11141758
> 
> 赞同：0
> 
> 时间：2012-06-21T15:40:51.760
> 
> 标签：php, search, text, find

好的，这是我正在开展的另一个项目。

它是一个聊天客户端。并将其用于员工

我希望服务器上有一个 staff.txt。

我希望 php 文件执行此操作。

执行 php。

如果在 staff.txt 中找到提交的用户名，则

用户名更改为 [员工]“此处的用户名”

我得到了搜索并找到了。

我似乎无法保留提交的用户名，只是向其中添加人员。

我现在添加我的来源。

```
<?php
// Parameters (Leave this Alone)
 $Message = $_GET["message"];
 $Username = htmlspecialchars($_GET["username"]);
 $time = ($_GET["time"]);
 // User Banning
 $data = file_get_contents('Banned.txt');
 if(strpos($data, $Username) !== FALSE)
{
   die();
 }
 else
{

 // File Writing (Leave this Alone) 
 $File = "Chat.txt"; 
 $Handle = fopen($File, "a"); 
 fwrite($Handle, $Username);
 fwrite($Handle, ": ");
 fwrite($Handle, $Message);
  fwrite($Handle, " -:-:- ");
  fwrite($Handle, $time);
  fwrite($Handle, "\r\n");
  print "Message Sent"; 
  fclose($Handle); 
 }
?> 
```

我有用户禁止工作，我希望员工以同样的方式工作。

任何帮助，将不胜感激

尝试不同的方式

```
If ($Username=="!divider!StaffMember1")  $Username="!divider![Staff] StaffMember1"; 
If ($Username=="!divider!StaffMember2")  $Username="!divider![Staff] StaffMember2"; 
```

这似乎在运行 php 和其他所有东西的 php 文件中工作正常。

有没有办法将该列表放在单独的文件中？.txt 文件或 .php 无关紧要。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T15:49:23.427

你可以像禁令列表那样做：

```
<?php
 // Parameters (Leave this Alone)
 $Message = $_GET["message"];
 $Username = htmlspecialchars($_GET["username"]);
 $time = ($_GET["time"]);

// check staff
 $data = file_get_contents('staff.txt');
 if(strpos($data, $Username) !== FALSE)
     $Username = '[STAFF]' . $Username;

// User Banning
 $data = file_get_contents('Banned.txt');
 if(strpos($data, $Username) !== FALSE)
{
   die();
 }
 else
{

 // File Writing (Leave this Alone) 
 $File = "Chat.txt"; 
 $Handle = fopen($File, "a"); 
 fwrite($Handle, $Username);
 fwrite($Handle, ": ");
 fwrite($Handle, $Message);
  fwrite($Handle, " -:-:- ");
  fwrite($Handle, $time);
  fwrite($Handle, "\r\n");
  print "Message Sent"; 
  fclose($Handle); 
 }
?> 
```

# java - 如何在java中用*替换控制台输入值？

> ID：11141759
> 
> 赞同：2
> 
> 时间：2012-06-21T15:40:52.673
> 
> 标签：java, console

如何`*`在从键盘输入的输入字符处打印？

例子：

如果我在控制台中输入：`mouli`，那么它应该替换`m`为`*`，然后`o`替换为`*`等等。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T15:43:13.470

使用标准 API 无法解决此问题。如果这确实是一个明确的要求，您将不得不使用一些与底层终端交互的系统特定库。

但是，如果打算让用户输入密码，我建议您使用[`Console.readPassword`](http://docs.oracle.com/javase/6/docs/api/java/io/Console.html#readPassword%28%29).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T15:43:01.520

控制台不是 Java 的“一部分”。它只是向程序输入信息的众多方式之一。我认为你的问题更像是：

“我正在从键盘读取一个字符串，我想用星号替换每个字符”。

但我不确定这是否真的是你想要的。

或者，如果您尝试在控制台中创建“密码”输入字段，其中键入的字符显示为星号，您可能需要查看 Console 类，参见[此处](http://docs.oracle.com/javase/6/docs/api/java/io/Console.html)。但是，我倾向于假设您的目的更适合实际的 GUI。该`readPassword`方法仅阻止字母出现在屏幕上，但不会替换它们。

# python - 在 sklearn 中持久化数据

> ID：11141761
> 
> 赞同：5
> 
> 时间：2012-06-21T15:41:00.807
> 
> 标签：python, machine-learning, data-mining, scikit-learn

我正在使用 scikit-learn 来聚类文本文档。我正在使用 CountVectorizer、TfidfTransformer 和 MiniBatchKMeans 类来帮助我做到这一点。新的文本文档一直添加到系统中，这意味着我需要使用上面的类来转换文本并预测一个聚类。我的问题是：我应该如何将数据存储在磁盘上？我应该简单地腌制矢量化器、转换器和 kmeans 对象吗？我应该只保存数据吗？如果是这样，我如何将它添加回矢量化器、转换器和 kmeans 对象？

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-22T14:31:16.147

这取决于你想做什么。

如果您想在训练集上找到一些固定的集群中心，然后稍后重新使用它们来计算新数据的集群分配，然后对模型进行酸洗（或者只是保存矢量化器的词汇表和其他模型构造函数参数和集群中心职位）是好的。

如果您想要使用新数据进行聚类，您可能希望使用新数据 + 旧数据的联合重新训练整个管道，以使矢量化器的词汇可以为新数据构建新特征（维度）词，并让聚类算法找到与完整数据集结构更好匹配的聚类中心。

请注意，将来我们将提供散列矢量化器（例如，请参阅[关于散列转换器的拉取请求](https://github.com/scikit-learn/scikit-learn/pull/909)作为第一个构建块），因此不再需要存储词汇表（但您将失去自省“含义”的能力”的特征尺寸）。

至于腌制模型与使用您自己的参数表示，我已经在您之前的问题中回答了这部分： [Persist Tf-Idf data](https://stackoverflow.com/questions/11102429/persist-tf-idf-data/11121388)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-21T19:21:07.160

是的，我认为 sk-learn 的一般答案是[腌制](http://scikit-learn.org/0.10/tutorial.html#model-persistence)和祈祷。

在我看来，与具有不依赖于实现细节的文档化序列化格式相比，这非常脆弱。但也许他们知道这一点，并且不会对他们的类进行向后不兼容的更改？

# android - 是否有 API 可以在 Google Play 上获取销售报告？

> ID：11141764
> 
> 赞同：6
> 
> 时间：2012-06-21T15:41:10.943
> 
> 标签：android, statistics, google-play

我们在 Google Play 上有一个 Androïd 应用程序，我想以编程方式检索销售报告。Apple 提供了 Autoingestion 工具，它允许 Java 应用程序检索它们，甚至还有一个 Ruby 端口： [https ://github.com/siuying/itunes-auto-ingestion](https://github.com/siuying/itunes-auto-ingestion)

有人知道 Androïd 是否有类似的东西，或者至少有一个 API 吗？我找不到。

提前谢谢了，

杰弗里

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-22T03:10:42.793

Google Checkout（Play 用于计费）有一个 API，但您需要一个商家密钥才能使用它，而且它并非在所有国家/地区都可用。

[https://developers.google.com/checkout/samplecode](https://developers.google.com/checkout/samplecode)

正如下面有人指出的那样，Google Checkout 已经停产。新的 Google Wallet 网站不提供真正的 API，但您可以使用 Google Drive API 或命令行工具下载存储在 Google Drive 上的报告。报告采用 CSV 格式，因此易于解析。

此外，Google Play 开发者控制台现在显示销售数据。查看 Andlytics 应用程序，它可以获取和显示销售数字（在 alpha 版本中可用）。它也是开源的。

[https://play.google.com/store/apps/details?id=com.github.andlyticsproject](https://play.google.com/store/apps/details?id=com.github.andlyticsproject)

编辑 2014/02/18

[维基百科](http://en.wikipedia.org/wiki/Google_Checkout)

> Google Checkout 于 2013 年 11 月 20 日停产。该公司为某些付款提供了一种称为[Google Wallet的新解决方案](https://developers.google.com/wallet/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-21T17:53:46.283

我只见过显示开发者控制台 web 视图的应用程序。我注意到统计数据的 URL 总是相同的，年 + 月，所以你可以试着读一下。遗憾的是它只显示销售而不是下载。 [https://play.google.com/apps/publish/salesreport/download?report_date=2012_05&report_type=sales_report&dev_acc=%%YOUR_ACC_NUMBER%%](https://play.google.com/apps/publish/salesreport/download?report_date=2012_05&report_type=sales_report&dev_acc=%%YOUR_ACC_NUMBER%%)

但是，当您在开发者控制台中查看 ajax-requests 时，似乎有某种 api：https: [//play.google.com/apps/publish/statistics?](https://play.google.com/apps/publish/statistics?dev_acc=%%YOUR_ACC_NUMBER%%) dev_acc= %%YOUR_ACC_NUMBER%% POST: method -> “getCombinedStats”

# wpf - WPF - XAML - 帮我修复 TabControl 模板

> ID：11141768
> 
> 赞同：1
> 
> 时间：2012-06-21T15:41:22.577
> 
> 标签：wpf, xaml

我正在尝试使用 MSDN 中的 TabControl 模板。 [http://msdn.microsoft.com/en-us/library/ms754137.aspx](http://msdn.microsoft.com/en-us/library/ms754137.aspx)

一切正常，直到 TabStripPlacement 进入游戏。将 TabStripPlacement 设置为“Left”不起作用。我得到了这个结果。

![在此处输入图像描述](../Images/c53a5298d52962e0570170ee89a109b8.png)

虽然我需要此模板，但它适用于水平和垂直选项卡放置。我对样式和模板不太熟悉，请帮我解决这个问题。

**编辑：**

当 TabStripPlacement 设置为“Top”时，我希望得到这个结果</p>

![在此处输入图像描述](../Images/6af173aa82904fa42f2fba234a941959.png)

而当 TabStripPlacement 设置为“Left”时</p>

![在此处输入图像描述](../Images/56e180ea2b7cffd0286e0ca79f9b6478.png)

就像一个普通的 TabControl

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T17:15:02.423

您链接的那个`TabControl`模板是一个示例，而不是默认模板。

您需要将`Grid`模板中的 展开为 2x2 而不是 1x2，然后创建一系列`Triggers`该集合的`Grid.Row`和命名`Grid.Column`的，以及包含基于内容的对象`TabPanel``HeaderPanel``Border``TabStripPlacement`

`TabControl.Template`您可以通过使用 Expression Blend 提取模板或使用[Show Me The Template](http://www.sellsbrothers.com/Posts/Details/2091)之类的工具来查看实际默认值。它包含您想要的触发器。

# java - Eclipse RCP - 以编程方式更改 plugin.xml？重新加载？

> ID：11141772
> 
> 赞同：3
> 
> 时间：2012-06-21T15:41:34.937
> 
> 标签：java, eclipse-plugin, eclipse-rcp, reload

**编辑：**
我想做的是以编程方式将首选项页面添加到 Rclipse-RCP 3.7 应用程序的首选项菜单中。不幸的是，如 本文所述[，](https://stackoverflow.com/questions/4017001/eclipse-create-preference-page-programmatically)这似乎无法以编程方式工作。

作为一种解决方案，我考虑创建一个特殊的插件，它将保持偏好。此插件应在其 plugin.xml 中声明所有首选项页面并自行卸载/安装以应用首选项菜单中的更改。

**问题：**

有没有可能

1.  以编程方式更改插件自己的plugin.xml？
2.  是否有可能以编程方式更新插件，从 plugin.xml 重新加载新设置？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T13:26:36.027

It would be helpful to understand the problem you are trying to solve, instead of what you are doing.

In general, there's no easy way to do what you want.

You can force a reload of your plugin.xml by using OSGi to uninstall and re-install your bundle. See `org.osgi.framework.Bundle.uninstall()`. But depending on the extensions contributed by the plugin.xml, not extension point consumers are written to be dynamic aware.

The other option for an RCP app is to contribute extensions using `org.eclipse.core.runtime.IExtensionRegistry.addContribution(InputStream, IContributor, boolean, String, ResourceBundle, Object)`. This is great for dynamic additions, it's less reliable for removing extensions, and the same caveat applies (how dynamic-aware is the consumer of the extension point). You use it in RCP apps by setting the user token to null.

# javascript - css缩放/-webkit-transform后jquery点击位置

> ID：11141773
> 
> 赞同：2
> 
> 时间：2012-06-21T15:41:37.973
> 
> 标签：javascript, jquery, css, hover, zooming

我有一个使用固定 CSS 宽度的 Web 应用程序。（1280 像素）。

使用 jquery，我添加了类似的内容

```
$("html").css("zoom",window["zoomRatio"], "important"); 
```

以及`-webkit-transform`用于 Mozilla 的。

一切正常，除了我意识到我的一个带有 jquery flot 插件的图表不起作用（工具提示仍然在缩放之前的原始位置触发）

调查它，我意识到是 jquery.bind() 导致了问题。无论如何我可以改变鼠标悬停的位置吗？

基本上我正在寻找一种方法来假装鼠标处于不同的位置。我在网上查找了这些信息，但找不到太多有用的信息。

谢谢

编辑（我的工具提示代码）

```
 function showTooltip(x, y, contents) {
    $('<div id="tooltip">' + contents + '</div>').css( {
        position: 'absolute',
        display: 'none',
        top: y + 5,
        left: x + 5,
        border: '1px solid #fdd',
        padding: '2px',
        'background-color': '#fee',
        opacity: 0.80
    }).appendTo("body").fadeIn(200);
}

var previousPoint = null;
$("#placeholder").bind("plothover", function (event, pos, item) {
    $("#x").text(pos.x.toFixed(2));
    $("#y").text(pos.y.toFixed(2));

    if ($("#enableTooltip:checked").length > 0) {
        if (item) {
            if (previousPoint != item.dataIndex) {
                previousPoint = item.dataIndex;

                $("#tooltip").remove();
                var x = item.datapoint[0].toFixed(2),
                    y = item.datapoint[1].toFixed(2);

                showTooltip(item.pageX, item.pageY,
                            item.series.label + " of " + x + " = " + y);
            }
        }
        else {
            $("#tooltip").remove();
            previousPoint = null;            
        }
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T22:23:12.303

由于您的**工具提示**具有为该函数提供的传入`x`和值，因此您需要测试缩放条件当前是否为.`y``true`

**编辑：**这是通过创建一个`if statement`具有两个新变量的新变量来完成的，`zoomActivated`并`zoomOnset`与您现有的标记一起使用。只要缩放条件为真，就会调用此 if 语句。

**片段代码示例：**

```
function showTooltip(x, y, contents) {

    if(zoomActivated){

        x = x + zoomOnset;
        y = y + zoomOnset;

    }

    $('<div id="tooltip">' + contents + '</div>').css( { .... 
```

上面将检查是否`zoomActivated`为布尔值`true`，如果是，则调整两者`x`并`y`补偿受**缩放方法**影响的对象位置。该变量`true`在您调用 jQuery 缩放方法时设置，并在该缩放方法完成/返回到原始状态时重置为 false。

全局变量`zoomOnset`基于当前缩放幅度，假设缩放适用于`x`和`y`。实际值是反映固定缩放值的固定值。

# android - Android为linearLayout设置id参数

> ID：11141774
> 
> 赞同：0
> 
> 时间：2012-06-21T15:41:38.710
> 
> 标签：android, android-layout

我正在尝试以编程方式将一些视图添加到已在 xml 文件中定义的线性布局中。

这是我定义 LinearLayout 的代码

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical"> 
```

但是，如您所见，它没有 id 元素。如何添加一个以便我可以从我的活动中调用方法 findViewById 来检索布局？我尝试手动添加它，但它不是在 R.java 中生成的。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T15:46:05.257

嗯，这样吗？

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android" 
android:id="@+id/linearlayout1"
android:layout_width="fill_parent" 
android:layout_height="fill_parent" 
android:orientation="vertical"> 
```

如果您添加它并遇到问题，请尝试 Project -> Clean。

如果一切都失败了，在你的 gen -> package 目录中找到并核对 R.java 文件以强制重建它。

# php - 友好的 URL 并允许用户控制它们

> ID：11141775
> 
> 赞同：0
> 
> 时间：2012-06-21T15:41:41.333
> 
> 标签：php, codeigniter, friendly-url

我有一个带有 CMS 的 CI 应用程序，我一直想知道如何让用户控制他们将发布的博客文章的 url。我了解 routes.php 文件，但我只是想知道如何允许用户将 url 更改为他们想要的东西？我以前没有这样做过，所以我不确定如何在 CI 中做到这一点。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T17:00:49.070

我怀疑您的意思是诸如 wordpress 的帖子标题之类的东西，因此标题成为 URL 的一部分？

您需要在 application/config/routes.php 中为控制器设置自定义路由，例如

```
$route['posts/(:any)'] = "posts/posts_method/$1"; 
```

Posts_method 是指使用给定变量搜索帖子的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T16:57:57.340

我认为最好的方法是使用 URL Slug 来引用文章。您可以插入文章的标题，然后为其设置 slug，这样当用户单击 slug 时，您应该使用 slug 在数据库中运行查询来搜索文章。

表格示例：

```
id_article
title
body
slug 
```

示例表格：

```
Title: <input type="text" name="title">
Body: <textarea name="body"></textarea>
Slug: <input type="text" name="slug"> 
```

让我们假设这篇文章的条目：

```
Title: Hi, this is my first post!
Body: Wow i'm so happy
slug: my-awsome-post 
```

当您创建指向帖子的链接时，您应该使用 slug 作为 id，例如：

```
<a href="http://www.example.com/blog/show/my-awsome-post">Read more</a> 
```

当您在模型中运行查询时，您可以使用 where clausole slug：

```
$this->db->get_where('table', array('slug'=>$slug)); 
```

# c++ - 在 C++ 程序中跟踪 Win32 API 调用

> ID：11141776
> 
> 赞同：2
> 
> 时间：2012-06-21T15:41:45.787
> 
> 标签：c++, winapi, visual-c++

我知道有一些程序可以跟踪实时进程中的 Win32 调用。但是我需要将一些代码放入 C++ 代码中，以便我可以将 Win32 调用与我当前的程序跟踪并排转储。以前有人做过吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T11:11:57.177

您可以尝试学习 Microsoft Detours 库来挂钩 Windows API 调用：[http](http://research.microsoft.com/en-us/projects/detours/) ://research.microsoft.com/en-us/projects/detours/ 。

# mediaelement.js - Flash 在 mediaelement.js HTML5 视频播放器中不起作用

> ID：11141777
> 
> 赞同：1
> 
> 时间：2012-06-21T15:41:52.657
> 
> 标签：mediaelement.js

我将一些 HTML5 视频放在 MVC3 站点中。HTML5 工作正常，但由于某种原因 Flash 在 IE 中没有响应，它甚至不会显示图像。

这是我的代码：

```
<video width="530px" height="445px" id="player1" poster="@Url.Content("~/Content/images/races/circuits/" + Model.Race.shortCode + ".png")" controls="controls" preload="none">
<source src="@Url.Content("~/Content/video/races/" + Model.Race.shortCode + ".mp4")" type="video/mp4" />
<source src="@Url.Content("~/Content/video/races/" + Model.Race.shortCode + ".webm")" type="video/webm" />
<object width="530" height="445" type="application/x-shockwave-flash" data="@Url.Content("~/Content/flash/flashmediaelement.swf")">
    <param name="movie" value="@Url.Content("~/Content/flash/flashmediaelement.swf")" />
    <param name="flashvars" value="controls=true&file=@Url.Content("~/Content/video/races/" + Model.Race.shortCode + ".mp4")" />
    <!-- Image as a last resort -->
    <img src="@Url.Content("~/Content/images/races/circuits/" + Model.Race.shortCode + ".png")" width="530px" height="445px"/>
</object> 
```

```
<script type="text/javascript">
$('audio,video').mediaelementplayer({
    success: function (player, node) {
        $('#' + node.id + '-mode').html('mode: ' + player.pluginType);
    }
});
</script> 
```

有谁知道问题可能是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T00:23:24.350

我不确定您要对该`data=`字段做什么，但我知道 mediaelement 播放器确实更喜欢直接链接。当我尝试相对链接时，我的没有显示。这似乎不会给每个人带来问题，但值得一试。

# vb.net - VS 2010 中缺少命名空间

> ID：11141788
> 
> 赞同：0
> 
> 时间：2012-06-21T15:42:31.990
> 
> 标签：vb.net, visual-studio-2010, namespaces

我已经安装了 VB.NET express 2010 版本，我正在尝试创建一个新的 dll 文件以在我的 SSIS 包中使用。当我尝试编写代码时，VS 环境告诉我我没有 Microsoft.SqlServer.Dts.Runtime 命名空间。我能做些什么来使这成为可能？

我在互联网上环顾四周，但找不到任何实质性的东西。我也有用于创建包的 BIDS 2008。我无法卸载它，因为我每天都有一些工作要做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T15:44:34.297

在“添加引用”对话框窗口中，单击浏览选项卡。然后导航到：

```
C:\Program Files\Microsoft SQL Server\90\SDK\Assemblies 
```

在那里你会找到`Microsoft.SQLServer.ManagedDTS.dll`，选择它并点击 OK...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T15:44:41.987

您需要将项目引用添加到`Microsoft.SqlServer.ManagedDTS.dll`.

# iphone - GLSL ES 1.1 中卷积的高效邻域纹理访问

> ID：11141791
> 
> 赞同：6
> 
> 时间：2012-06-21T15:42:38.803
> 
> 标签：iphone, opengl-es, glsl

我在 iPhone 着色器 GLSL ES 1.1 中使用 3x3 内核执行卷积。目前我只是在做 9 次纹理查找。有更快的方法吗？一些想法：

*   将输入图像作为缓冲区而不是纹理传递，以避免调用纹理插值。

*   从顶点着色器传递 9 个不同的 vec2 坐标（而不是像我目前所做的那样），以鼓励处理器有效地预取纹理。

*   研究可能适用于此的各种 Apple 扩展。

*   （已添加）调查 GLSL shaderOffset 调用的 ES 等效项（在 ES 下不可用，但可能有等效项）

在硬件方面，我特别关注 iPhone 4S。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-23T01:25:02.737

你确定你不是指 OpenGL ES 2.0 吗？您不能使用 OpenGL ES 1.1 进行任何类型的着色器。我假设前者。

根据我的经验，我发现最快的方法是您列出的第二个项目。我在我的[GPUImage](https://github.com/BradLarson/GPUImage)框架中进行了几种类型的 3x3 卷积（您可以使用它而不是尝试自己滚动），对于那些我输入水平和垂直方向的纹理偏移量并计算顶点内所需的九个纹理坐标的那些着色器。从那里，我将这些作为变量传递给片段着色器。

这（在大多数情况下）避免了片段着色器中的依赖纹理读取，这在 iOS PowerVR GPU 上非常昂贵。我说“大部分情况下”是因为在 iPhone 4 等较旧的设备上，只有 8 个变量用于避免依赖纹理读取。正如我上周了解到的那样，第九个触发了在旧设备上读取的相关纹理，因此会减慢速度。但是，iPhone 4S 没有这个问题，因为它支持以这种方式使用的更多变量。

我将以下内容用于我的顶点着色器：

```
 attribute vec4 position;
 attribute vec4 inputTextureCoordinate;

 uniform highp float texelWidth; 
 uniform highp float texelHeight; 

 varying vec2 textureCoordinate;
 varying vec2 leftTextureCoordinate;
 varying vec2 rightTextureCoordinate;

 varying vec2 topTextureCoordinate;
 varying vec2 topLeftTextureCoordinate;
 varying vec2 topRightTextureCoordinate;

 varying vec2 bottomTextureCoordinate;
 varying vec2 bottomLeftTextureCoordinate;
 varying vec2 bottomRightTextureCoordinate;

 void main()
 {
     gl_Position = position;

     vec2 widthStep = vec2(texelWidth, 0.0);
     vec2 heightStep = vec2(0.0, texelHeight);
     vec2 widthHeightStep = vec2(texelWidth, texelHeight);
     vec2 widthNegativeHeightStep = vec2(texelWidth, -texelHeight);

     textureCoordinate = inputTextureCoordinate.xy;
     leftTextureCoordinate = inputTextureCoordinate.xy - widthStep;
     rightTextureCoordinate = inputTextureCoordinate.xy + widthStep;

     topTextureCoordinate = inputTextureCoordinate.xy - heightStep;
     topLeftTextureCoordinate = inputTextureCoordinate.xy - widthHeightStep;
     topRightTextureCoordinate = inputTextureCoordinate.xy + widthNegativeHeightStep;

     bottomTextureCoordinate = inputTextureCoordinate.xy + heightStep;
     bottomLeftTextureCoordinate = inputTextureCoordinate.xy - widthNegativeHeightStep;
     bottomRightTextureCoordinate = inputTextureCoordinate.xy + widthHeightStep;
 } 
```

和片段着色器：

```
 precision highp float;

 uniform sampler2D inputImageTexture;

 uniform mediump mat3 convolutionMatrix;

 varying vec2 textureCoordinate;
 varying vec2 leftTextureCoordinate;
 varying vec2 rightTextureCoordinate;

 varying vec2 topTextureCoordinate;
 varying vec2 topLeftTextureCoordinate;
 varying vec2 topRightTextureCoordinate;

 varying vec2 bottomTextureCoordinate;
 varying vec2 bottomLeftTextureCoordinate;
 varying vec2 bottomRightTextureCoordinate;

 void main()
 {
     mediump vec4 bottomColor = texture2D(inputImageTexture, bottomTextureCoordinate);
     mediump vec4 bottomLeftColor = texture2D(inputImageTexture, bottomLeftTextureCoordinate);
     mediump vec4 bottomRightColor = texture2D(inputImageTexture, bottomRightTextureCoordinate);
     mediump vec4 centerColor = texture2D(inputImageTexture, textureCoordinate);
     mediump vec4 leftColor = texture2D(inputImageTexture, leftTextureCoordinate);
     mediump vec4 rightColor = texture2D(inputImageTexture, rightTextureCoordinate);
     mediump vec4 topColor = texture2D(inputImageTexture, topTextureCoordinate);
     mediump vec4 topRightColor = texture2D(inputImageTexture, topRightTextureCoordinate);
     mediump vec4 topLeftColor = texture2D(inputImageTexture, topLeftTextureCoordinate);

     mediump vec4 resultColor = topLeftColor * convolutionMatrix[0][0] + topColor * convolutionMatrix[0][1] + topRightColor * convolutionMatrix[0][2];
     resultColor += leftColor * convolutionMatrix[1][0] + centerColor * convolutionMatrix[1][1] + rightColor * convolutionMatrix[1][2];
     resultColor += bottomLeftColor * convolutionMatrix[2][0] + bottomColor * convolutionMatrix[2][1] + bottomRightColor * convolutionMatrix[2][2];

     gl_FragColor = resultColor;
 } 
```

即使有上述注意事项，这个着色器在 iPhone 4 上运行 640x480 帧视频的时间约为 2 毫秒，而 4S 可以使用这样的着色器轻松处理 30 FPS 的 1080p 视频。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T08:00:56.487

您为什么不使用分离的高斯风格模糊运行两次通道？在第一遍中垂直敲击 3 次，然后在第二遍中敲击水平 3 次。

# java - java - 为游戏“大厅”重新安排 TimerTask

> ID：11141792
> 
> 赞同：4
> 
> 时间：2012-06-21T15:42:40.833
> 
> 标签：java, timer, scheduling, timertask

**场景**：
我正在复制一款流行的纸牌游戏。需要有一段时间人们可以加入游戏。有时，周期太短。因此，我想让人们延长等待期。对于示例号码，默认的“大厅时间”为 45 秒，每个分机为 15 秒。

**问题**：
我决定使用 Java 的计时器。当“大厅”开始时，一个 TimerTask 计划在 45 秒后执行：

```
UnoStartTimer.schedule(new UnoStartTask(), 45000); 
```

当有人想延长延迟时，这是我要运行的伪代码：

```
UnoStartTimer.reschedule(UnoStartTimer.getNextScheduledTime() + 15000); 
```

快速浏览一下[javadoc](http://docs.oracle.com/javase/6/docs/api/java/util/Timer.html)表明不存在这样一个使用 Timer 类的简单解决方案。

这是我想出的可能性：

*   我应该使用不同的调度类（我想我在另一个问题的答案中看到了一个叫做 ScheduledExecutorService 的东西，但它并没有立即看起来像是我的问题的解决方案）
*   有一种方法可以用 Timer 做到这一点，我公然忽略了它
*   没有简单的方法可以做到这一点

那么是哪一个呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T15:50:24.910

看看[java.util.Timer](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Timer.html)。除其他外，我看到了一个 cancel() 方法。我还看到了一个 schedule() 方法，它采用 Date 对象而不是毫秒数。

您可以创建一个从现在开始 45 秒的 Date 对象，使用该时间安排计时器，如果发生扩展，取消它，将 15 秒添加到原始 Date 对象并使用该新时间安排任务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-14T20:59:50.993

根据 Timer 文档，从 Java 1.5 开始，您应该更喜欢 ScheduledThreadPoolExecutor。（您可能希望使用 Executors.newSingleThreadScheduledExecutor() 创建这个执行器以方便使用；它创建的东西很像 Timer。）

请参考这篇文章 ->[可重置 Java 计时器](https://stackoverflow.com/questions/32001/resettable-java-timer)

# javascript - Jquery 每个 Json 值问题

> ID：11141799
> 
> 赞同：0
> 
> 时间：2012-06-21T15:43:11.763
> 
> 标签：javascript, jquery, json, javascript-objects

```
<html>
<head>
    <title>testjson</title>
    <script type="text/javascript" src="jquery-1.7.2.min.js"></script>
    <script type="text/javascript">

var incidentReport1 = {
    "text1": "n/a",
    "text2": "n/a",
    "text3": "n/a",
    }

function readHtmlForInputs() {
    var count = 0; //Setting count to 0
    $('input').each(function(){
        var input = $(this);
        var temp = (input.attr('id'));

    if(input.attr('type') == 'button'){alert('button');}
    else{
            incidentReport1.temp = input.val();
            count++; //Incrementing counter     
        }
    });

    console.log("Input Types Found:" + count);

}

function saveChanges()
{
readHtmlForInputs();
console.dir(incidentReport1);
}
    </script>

</head>
<body>
<input type="button" value="save" onclick="saveChanges();"/>
<input type="text" name="Surname" id="text1" class="InputText" /><br>
<input type="text" name="Surname" id="text2" class="InputText"/><br>
<input type="text" name="Surname" id="text3" class="InputText"/><br>

</body>
</html> 
```

得到了上面的代码块，我希望能够动态获取输入 ID，并使用 ID 在 incdientReport1 json 中分配一个值。当我做这个问题时似乎是这条线......

```
var temp = (input.attr('id')); 
```

分配 ID 并在控制台中显示它时工作正常

但是当这行代码

```
 incidentReport1.temp = input.val(); 
```

运行它会将其保存到一个名为 temp 的新字段，而不是 temp.. 的字符串值。

这么困惑的家伙我哪里错了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T15:44:23.187

你要：

```
incidentReport1[temp] = input.val(); 
```

当您需要使用计算属性名称时，请使用`[ ]`运算符。那是，

```
object.propertyName 
```

是相同的

```
object[ "propertyName" ] 
```

# sql-server - SQL Server TOP 约束

> ID：11141801
> 
> 赞同：0
> 
> 时间：2012-06-21T15:43:13.623
> 
> 标签：sql-server, sql-server-2008

我想知道如果执行的查询中没有 top 子句，是否有约束或方法来限制表返回的总行数。我们不能轻易修改正在执行的 SQL，因此解决方案需要在 db 级别。

我们的系统盲目地构建了很多查询，例如

```
select * from table where email = 'john' 
```

当我们有小表时，这工作得很好，但现在我们的表有 +10000 行，这变得效率低下。

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T20:43:51.363

答案是“是”。一种方法是使用“设置行数”。另一种方法是为此目的使用查询连接中内置的任何工具。

例如：

```
SET ROWCOUNT 10
select * from INFORMATION_SCHEMA.COLUMNS 
```

这会将任何后续查询返回的最大行数设置为 10。但是，为了将其融入您的应用程序，我们需要更多信息，例如该应用程序如何访问数据库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T20:55:57.497

这有点令人费解：

```
CREATE TABLE temp
(
y  char(9) PRIMARY KEY,
x  char(9)
);

insert into temp (x, y) values ('j', 'hello');
insert into temp (x, y) values ('j', 'world');
insert into temp (x, y) values ('q', 'foo');
insert into temp (x, y) values ('q', 'bar');

with myCTE(x,y,r) as
(
select 
  x
  ,y
  , r = ROW_NUMBER() OVER (ORDER BY (SELECT NULL))
from temp
)
select * from myCTE where r <= 3; 
```

# java - 启动清单中的类时出现 ActivityNotFoundException

> ID：11141803
> 
> 赞同：0
> 
> 时间：2012-06-21T15:43:17.687
> 
> 标签：java, android, android-intent, android-manifest

我有一个应用程序，主类启动（或者至少这是我想要发生的）另外两个类。主类`WhenIGetToActivity`启动第一个类`CreateLoc`没有错误，但在尝试启动第二个时抛出一个 ActivityNotFoundException `Menu`。

这是来自的相关代码`WhenIGetToActivity`

```
@Override
public boolean onCreateOptionsMenu(Menu menu) {
    Intent myIntent = new Intent(getApplicationContext(), Menu.class);
    startActivity(myIntent);
    return true;
}
...

public boolean onTap(final GeoPoint p, final MapView mapView) {
        boolean tapped = super.onTap(p, mapView);
        if (tapped) {
            Intent myIntent = new Intent(getApplicationContext(), CreateLoc.class);
            startActivity(myIntent);
        } else { 
```

两个次要类都在正确（且相同）的包中，两者都是`extends Activity`.

这是我的清单文件

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="SandS.Geo.Cal"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk android:minSdkVersion="10" />

<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_MOCK_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />

<application>
   android:icon="@drawable/ic_launcher"
    android:label="@string/app_name" >

    <uses-library android:name="com.google.android.maps" />

    <activity
        android:name=".WhenIGetToActivity"
        android:label="@string/app_name"
        android:theme="@android:style/Theme.NoTitleBar" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity android:name="CreateLoc" >
    </activity>
    <activity android:name="Menu" >
    </activity>
</application> 
```

这是Logcat

```
06-21 17:30:21.479: I/ApplicationPackageManager(3891): cscCountry is not German : XEU
06-21 17:30:22.289: W/TAG(3891): Location unknown
06-21 17:30:22.329: I/MapActivity(3891): Handling network change notification:CONNECTED
06-21 17:30:22.329: E/MapActivity(3891): Couldn't get connection factory client
06-21 17:30:27.189: W/KeyCharacterMap(3891): No keyboard for id 0
06-21 17:30:27.189: W/KeyCharacterMap(3891): Using default keymap: /system/usr/keychars/qwerty.kcm.bin
06-21 17:30:27.229: D/AndroidRuntime(3891): Shutting down VM
06-21 17:30:27.229: W/dalvikvm(3891): threadid=1: thread exiting with uncaught exception (group=0x40018578)
06-21 17:30:27.239: E/AndroidRuntime(3891): FATAL EXCEPTION: main
06-21 17:30:27.239: E/AndroidRuntime(3891): android.content.ActivityNotFoundException: Unable to find explicit activity class {SandS.Geo.Cal/android.view.Menu}; have you declared this activity in your AndroidManifest.xml?
06-21 17:30:27.239: E/AndroidRuntime(3891):     at android.app.Instrumentation.checkStartActivityResult(Instrumentation.java:1405)
06-21 17:30:27.239: E/AndroidRuntime(3891):     at android.app.Instrumentation.execStartActivity(Instrumentation.java:1379)
06-21 17:30:27.239: E/AndroidRuntime(3891):     at android.app.Activity.startActivityForResult(Activity.java:2827)
06-21 17:30:27.239: E/AndroidRuntime(3891):     at android.app.Activity.startActivity(Activity.java:2933)
06-21 17:30:27.239: E/AndroidRuntime(3891):     at SandS.Geo.Cal.WhenIGetToActivity.onCreateOptionsMenu(WhenIGetToActivity.java:62)
06-21 17:30:27.239: E/AndroidRuntime(3891):     at android.app.Activity.onCreatePanelMenu(Activity.java:2158)
06-21 17:30:27.239: E/AndroidRuntime(3891):     at com.android.internal.policy.impl.PhoneWindow.preparePanel(PhoneWindow.java:325)
06-21 17:30:27.239: E/AndroidRuntime(3891):     at com.android.internal.policy.impl.PhoneWindow.onKeyDownPanel(PhoneWindow.java:570)
06-21 17:30:27.239: E/AndroidRuntime(3891):     at com.android.internal.policy.impl.PhoneWindow.onKeyDown(PhoneWindow.java:1220)
06-21 17:30:27.239: E/AndroidRuntime(3891):     at com.android.internal.policy.impl.PhoneWindow$DecorView.dispatchKeyEvent(PhoneWindow.java:1727)
06-21 17:30:27.239: E/AndroidRuntime(3891):     at android.view.ViewRoot.deliverKeyEventToViewHierarchy(ViewRoot.java:2627)
06-21 17:30:27.239: E/AndroidRuntime(3891):     at android.view.ViewRoot.handleFinishedEvent(ViewRoot.java:2602)
06-21 17:30:27.239: E/AndroidRuntime(3891):     at android.view.ViewRoot.handleMessage(ViewRoot.java:1874)
06-21 17:30:27.239: E/AndroidRuntime(3891):     at android.os.Handler.dispatchMessage(Handler.java:99)
06-21 17:30:27.239: E/AndroidRuntime(3891):     at android.os.Looper.loop(Looper.java:130)
06-21 17:30:27.239: E/AndroidRuntime(3891):     at android.app.ActivityThread.main(ActivityThread.java:3687)
06-21 17:30:27.239: E/AndroidRuntime(3891):     at java.lang.reflect.Method.invokeNative(Native Method)
06-21 17:30:27.239: E/AndroidRuntime(3891):     at java.lang.reflect.Method.invoke(Method.java:507)
06-21 17:30:27.239: E/AndroidRuntime(3891):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:867)
06-21 17:30:27.239: E/AndroidRuntime(3891):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:625)
06-21 17:30:27.239: E/AndroidRuntime(3891):     at dalvik.system.NativeStart.main(Native Method) 
```

我试过清理项目。

有任何想法吗。

根据 4 个答案的建议，我更改了班级的名称，我已经这样做了，现在称为`StevesToolsMenu.class`

新的`onCreateOptionsMenu`现在有一行：

```
Intent myIntent = new Intent(getApplicationContext(), StevesToolsMenu.class); 
```

清单文件的相关部分现在是：

```
<application>
   android:icon="@drawable/ic_launcher"
    android:label="@string/app_name" >

    <uses-library android:name="com.google.android.maps" />

    <activity
        android:name=".WhenIGetToActivity"
        android:label="@string/app_name"
        android:theme="@android:style/Theme.NoTitleBar" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity android:name=".CreateLoc" >
    </activity>
    <activity android:name=".StevesToolsMenu" >
    </activity>
</application> 
```

新的 Logcat 是：

```
06-23 15:14:22.989: I/ApplicationPackageManager(4088): cscCountry is not German : XEU
06-23 15:14:23.789: W/TAG(4088): Location unknown
06-23 15:14:23.849: I/MapActivity(4088): Handling network change notification:CONNECTED
06-23 15:14:23.849: E/MapActivity(4088): Couldn't get connection factory client
06-23 15:14:30.219: W/KeyCharacterMap(4088): No keyboard for id 0
06-23 15:14:30.219: W/KeyCharacterMap(4088): Using default keymap: /system/usr/keychars/qwerty.kcm.bin
06-23 15:14:30.289: I/ApplicationPackageManager(4088): cscCountry is not German : XEU
06-23 15:14:30.319: D/AndroidRuntime(4088): Shutting down VM
06-23 15:14:30.319: W/dalvikvm(4088): threadid=1: thread exiting with uncaught exception (group=0x40018578)
06-23 15:14:30.329: E/AndroidRuntime(4088): FATAL EXCEPTION: main
06-23 15:14:30.329: E/AndroidRuntime(4088): java.lang.RuntimeException: Unable to start activity ComponentInfo{SandS.Geo.Cal/SandS.Geo.Cal.StevesToolsMenu}: android.view.InflateException: Binary XML file line #7: Error inflating class <unknown>
06-23 15:14:30.329: E/AndroidRuntime(4088):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1651)
06-23 15:14:30.329: E/AndroidRuntime(4088):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1667)
06-23 15:14:30.329: E/AndroidRuntime(4088):     at android.app.ActivityThread.access$1500(ActivityThread.java:117)
06-23 15:14:30.329: E/AndroidRuntime(4088):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:935)
06-23 15:14:30.329: E/AndroidRuntime(4088):     at android.os.Handler.dispatchMessage(Handler.java:99)
06-23 15:14:30.329: E/AndroidRuntime(4088):     at android.os.Looper.loop(Looper.java:130)
06-23 15:14:30.329: E/AndroidRuntime(4088):     at android.app.ActivityThread.main(ActivityThread.java:3687)
06-23 15:14:30.329: E/AndroidRuntime(4088):     at java.lang.reflect.Method.invokeNative(Native Method)
06-23 15:14:30.329: E/AndroidRuntime(4088):     at java.lang.reflect.Method.invoke(Method.java:507)
06-23 15:14:30.329: E/AndroidRuntime(4088):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:867)
06-23 15:14:30.329: E/AndroidRuntime(4088):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:625)
06-23 15:14:30.329: E/AndroidRuntime(4088):     at dalvik.system.NativeStart.main(Native Method)
06-23 15:14:30.329: E/AndroidRuntime(4088): Caused by: android.view.InflateException: Binary XML file line #7: Error inflating class <unknown>
06-23 15:14:30.329: E/AndroidRuntime(4088):     at android.view.LayoutInflater.createView(LayoutInflater.java:518)
06-23 15:14:30.329: E/AndroidRuntime(4088):     at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:570)
06-23 15:14:30.329: E/AndroidRuntime(4088):     at android.view.LayoutInflater.rInflate(LayoutInflater.java:623)
06-23 15:14:30.329: E/AndroidRuntime(4088):     at android.view.LayoutInflater.inflate(LayoutInflater.java:408)
06-23 15:14:30.329: E/AndroidRuntime(4088):     at android.view.LayoutInflater.inflate(LayoutInflater.java:320)
06-23 15:14:30.329: E/AndroidRuntime(4088):     at android.view.LayoutInflater.inflate(LayoutInflater.java:276)
06-23 15:14:30.329: E/AndroidRuntime(4088):     at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:209)
06-23 15:14:30.329: E/AndroidRuntime(4088):     at android.app.Activity.setContentView(Activity.java:1657)
06-23 15:14:30.329: E/AndroidRuntime(4088):     at SandS.Geo.Cal.StevesToolsMenu.onCreate(StevesToolsMenu.java:20)
06-23 15:14:30.329: E/AndroidRuntime(4088):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
06-23 15:14:30.329: E/AndroidRuntime(4088):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1615)
06-23 15:14:30.329: E/AndroidRuntime(4088):     ... 11 more
06-23 15:14:30.329: E/AndroidRuntime(4088): Caused by: java.lang.reflect.InvocationTargetException
06-23 15:14:30.329: E/AndroidRuntime(4088):     at java.lang.reflect.Constructor.constructNative(Native Method)
06-23 15:14:30.329: E/AndroidRuntime(4088):     at java.lang.reflect.Constructor.newInstance(Constructor.java:415)
06-23 15:14:30.329: E/AndroidRuntime(4088):     at android.view.LayoutInflater.createView(LayoutInflater.java:505)
06-23 15:14:30.329: E/AndroidRuntime(4088):     ... 21 more
06-23 15:14:30.329: E/AndroidRuntime(4088): Caused by: java.lang.IllegalArgumentException: MapViews can only be created inside instances of MapActivity.
06-23 15:14:30.329: E/AndroidRuntime(4088):     at com.google.android.maps.MapView.<init>(MapView.java:291)
06-23 15:14:30.329: E/AndroidRuntime(4088):     at com.google.android.maps.MapView.<init>(MapView.java:264)
06-23 15:14:30.329: E/AndroidRuntime(4088):     at com.google.android.maps.MapView.<init>(MapView.java:247)
06-23 15:14:30.329: E/AndroidRuntime(4088):     ... 24 more 
```

我们似乎用另一个问题代替了一个问题（或者更确切地说，发现了第二个问题）。

无论您以哪种方式看待它，我仍然很难理解为什么一个类应该工作而另一个（以看似相同的方式设置）类不工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T15:47:37.093

如何在 AndroidManifest.xml 中更改您的活动

旧的

```
<activity android:name="CreateLoc" ></activity>
<activity android:name="Menu" ></activity> 
```

到

```
<activity android:name=".CreateLoc" ></activity>
<activity android:name=".Menu" ></activity> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T15:46:33.357

我认为问题在于`Menu`Android 库中已经定义了一个类。如果您尝试打开选项菜单，则不会将其作为另一个带有`Intent`. 您可以通过 XML 文件以编程方式创建`Menu`或扩展 a `Menu`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T15:49:29.653

您正在尝试启动名为 的活动`android.view.Menu`。您没有名为 的活动`android.view.Menu`。您有一个活动，由于某种原因，它被命名为`SandS.Geo.Cal.Menu`。

> 意图 myIntent = new Intent(getApplicationContext(), Menu.class);

如果您将`Intent`构造函数的第二个参数更改`Class`为您的活动的对象，那可能会更好。最好不要有一个名为 的活动`Menu`，而是使用更独特的东西，以帮助防止将来发生这种碰撞。

# opencv - Findcontours 检索未排序的轮廓

> ID：11141805
> 
> 赞同：4
> 
> 时间：2012-06-21T15:43:27.003
> 
> 标签：opencv, ocr

我们正在使用opencv for android实现OCR，一切都很好，直到使用Imgproc.findcontours（）查找轮廓的部分它返回的轮廓与输入图像中的顺序不同，即：输入图像MNOP第一个轮廓得到从 findcontours() 是 P 输入图像 EFGH 从 findcontours() 获得的第一个轮廓是 E（这里是正确的）输入图像 IJKL 从 findcontours() 获得的第一个轮廓是 J 所以它似乎随机提取轮廓我们如何修复这个？因为我们想把字写在图像中

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-21T19:02:31.223

OpenCV 在寻找轮廓时似乎没有任何顺序。如果我们需要对其进行排序，我们应该手动进行，这是一项额外的任务。

但是出于 OCR 的目的，我也遇到了这个问题。所以我所做的是找到检测到的轮廓的质心。可以使用矩来找出它。

[使用 Moments 寻找质心](http://opencvpython.blogspot.com/2012/06/contours-3-extraction.html)

或者您可以找到轮廓的边界框，然后找到该边界框的中心。后来在 ocr 之后将数据放在同一个质心上。

这是我自己准备 OCR 时使用的方法。您可以在这个 SOF 问题中找到完整的详细信息：[OpenCV-Python 中的简单数字识别 OCR](https://stackoverflow.com/questions/9413216/simple-digit-recognition-ocr-in-opencv-python/9620295#9620295)

**编辑：** FindContours 的顺序，（来自 vasile 的评论后）

原图：

![在此处输入图像描述](../Images/b5d9dcc60a8bbc6cbd89d2f658822e55.png)

找到轮廓的顺序：

![在此处输入图像描述](../Images/afe7cd0cc9eac263fa5bc2aa85f32391.png)

# excel - 我如何计算一个月中的某一天是否在给定日期和该日期起 14 天之间？

> ID：11141809
> 
> 赞同：1
> 
> 时间：2012-06-21T15:43:37.003
> 
> 标签：excel, excel-formula

我正在尝试制定一份`IF`声明并迷路。我确定我现在已经起床太久了，但我就是看不到它。

这是场景：

```
I have a given date in E1, say June 21st (my payday).
I have a day of the month in C22 say the 11th of the month (the day a bill is due).
I have a $value in D22 (the value of the bill). 
```

如果账单在 E1 中的日期或之后并且在 E1 + 14 天（我的下一个发薪日）之前到期，我需要一个 if 语句。

这是我尝试过的（注意它有点因实验而受损）：

```
=IF(AND(DATE(YEAR(E$1),MONTH(E$1),DAY($C22))>=E$1,DATE(YEAR(E$1),MONTH(E$1),DAY(E$1)+14))>DATE(YEAR(E$1),MONTH(E$1),DAY($C22)),$D22,"") 
```

谁能帮我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T15:50:11.973

也许：

```
=IF(AND(DATE(YEAR(E$1),MONTH(E$1),DAY($C22))>=E$1,DATE(YEAR(E$1),MONTH(E$1),DAY($C22))<E$1+14)),$D22,"") 
```

（如果 11-Jun >= 21-Jun AND 11-Jun < 21-Jun + 14 天，将以您的示例显示 D22）

现在，如果您想在 11- **Jul** >= 21-Jun AND 11- **Jul** < 21-Jun + 14 天时显示 D22，则更复杂，因为您需要检查 11 是在 21 之前还是之后，如果这是以前。你可以这样做：

```
=IF(AND(DATE(YEAR(E$1),MONTH(E$1)+IF($C22<DAY(E$1),1,0),DAY($C22))>=E$1,DATE(YEAR(E$1),MONTH(E$1)+IF($C22<DAY(E$1),1,0),DAY($C22))<E$1+14),$D22,"") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T15:51:26.323

您可以尝试[MEDIAN](http://office.microsoft.com/en-us/excel-help/median-HP005209174.aspx)公式来计算日期是否在其他两个日期之间。

在您的情况下，您必须设法为 MEDIAN 提供适当的日期。例如，将当前日期 -14 存储在 C100 中，将其替换为获取当前日期的功能。

```
IF(E$1=MEDIAN(C100:C22),"Yes","No") 
```

您会发现此[链接](http://chandoo.org/wp/2010/06/24/between-formula-excel/)很有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T15:55:55.810

我总是用加法来获得更多的日子。也就是说，我认为`E1 + 14`应该是你下一个发薪日的日期。那么公式可以很简单

```
=IF(AND(DATE(YEAR(E1);MONTH(E1);C22)>=E1;DATE(YEAR(E1);MONTH(E1);C22)<(E1+14));D22;0) 
```

（注意：如果我正确理解了您的问题，它可以在 Excel 2010 中使用）

# asp.net - Visual Studio 2010，用于调试和发布的 asp.net mvc3 web.config

> ID：11141810
> 
> 赞同：1
> 
> 时间：2012-06-21T15:43:38.200
> 
> 标签：asp.net, asp.net-mvc-3, visual-studio-2010, web-config

我想分别使用 Web.Debug.config 和 Web.Release.config 。

但它在 Visual Studio 2010 中不起作用，并且在部署后它可以在实际服务器上运行。

**Web.Release.config**

```
<appSettings>
    <add key="GOOGLE_MERCHANT_ID" value="LIVE_GOOGLE_MERCHANT_ID" xdt:Transform="Insert" xdt:Locator="Match(key)" />
</appSettings> 
```

**Web.Debug.config**

```
<appSettings>
    <add key="GOOGLE_MERCHANT_ID" value="DEBUG_GOOGLE_MERCHANT_ID" xdt:Transform="Insert" xdt:Locator="Match(key)" />
</appSettings> 
```

我喜欢上面的配置文件，我尝试在屏幕上回显配置值。

```
string t = WebConfigurationManager.AppSettings["GOOGLE_MERCHANT_ID"]; Response.Write(t); 
```

在视觉工作室，

![在此处输入图像描述](../Images/f77e8dfbb4f6ae0d02bc2da43a148c4c.png)

设置为发布模式和 F5（我也尝试过构建解决方案（F6）），但它不打印任何内容。

所以我尝试部署包并安装在服务器上并运行然后它打印正确的值。

我如何在 Visual Studio 中做到这一点？我想在部署包之前确保一切正常。

请多多指教~

谢谢！

[编辑]

现在我明白了，谢谢所有给我好的答案的人！

我可以再问一个问题吗？

那这是为了什么？

![在此处输入图像描述](../Images/7b4085702a9f6db3a12c1387cc6ae6ee.png)

如果我更改为 Release 或 Debug 那么对我的项目有什么影响？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T15:56:48.023

看到这篇文章[https://stackoverflow.com/a/5734829/611288](https://stackoverflow.com/a/5734829/611288)

正如 Jimmy 所说，web.config 转换仅在 Web Publish Pipeline 期间应用

Jimmy 还为黑客提供了以下链接：http: [//sedodream.com/2010/10/21/ASPNETWebProjectsWebdebugconfigWebreleaseconfig.aspx](http://sedodream.com/2010/10/21/ASPNETWebProjectsWebdebugconfigWebreleaseconfig.aspx)

或者，创建一个在本地部署的测试部署并在那里测试配置设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T15:46:47.293

据我所知，在构建解决方案时无法构建 web.config。您可以通过根据您选择的构建配置将 xml 合并工具作为构建后事件执行来解决此问题。类似的东西[`XmlConfigMerge`](http://www.codeproject.com/Articles/7406/XmlConfigMerge-Merge-config-file-settings)可能会帮助你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T15:52:52.880

我认为你不能这样做是视觉工作室。如果您想在服务器上测试您的项目，请尝试在本地 iis 而不是实际服务器上测试它。

# sql - 使用 SQL Server 的 GOTO 进行错误处理的坏习惯？

> ID：11141814
> 
> 赞同：10
> 
> 时间：2012-06-21T15:44:03.440
> 
> 标签：sql, sql-server, error-handling, goto

[我在这篇文章](http://www.codeproject.com/Articles/4451/SQL-Server-Transactions-and-Error-Handling)中阅读了关于 SQL Server 中的错误处理，他们建议在某些情况下使用 SQL Server 的 GOTO 来回滚事务。例子：

```
BEGIN TRAN
    UPDATE Authors
    SET Phone = '415 354-9866'
    WHERE au_id = '724-80-9391'

    SELECT @intErrorCode = @@ERROR
    IF (@intErrorCode <> 0) GOTO PROBLEM

    UPDATE Publishers
    SET city = 'Calcutta', country = 'India'
    WHERE pub_id = '9999'

    SELECT @intErrorCode = @@ERROR
    IF (@intErrorCode <> 0) GOTO PROBLEM
COMMIT TRAN

PROBLEM:
IF (@intErrorCode <> 0) BEGIN
PRINT 'Unexpected error occurred!'
    ROLLBACK TRAN
END 
```

这篇文章写于近 10 年前，我听说使用 GOTO 通常是个坏主意。以上是 SQL Server 中错误处理的好方法吗？如果没有，任何人都可以提出更好的选择吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-06-21T15:45:23.093

您应该在 SQL 2005+中使用[Try/Catch](http://msdn.microsoft.com/en-us/library/ms175976.aspx)

```
BEGIN TRY
    BEGIN TRAN

    UPDATE Authors
    SET Phone = '415 354-9866'
    WHERE au_id = '724-80-9391'

    UPDATE Publishers
    SET city = 'Calcutta', country = 'India'
    WHERE pub_id = '9999'

    COMMIT TRAN        
END TRY
BEGIN CATCH
    PRINT 'Unexpected error occurred!'
    IF XACT_STATE() <> 0
        ROLLBACK TRAN    
END CATCH 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-22T08:52:41.713

您必须`SET XACT_ABORT ON`加入`Exception handling`

```
Begin Try
SET XACT_ABORT ON

BEGIN TRAN
    UPDATE Authors
    SET Phone = '415 354-9866'
    WHERE au_id = '724-80-9391'

    UPDATE Publishers
    SET city = 'Calcutta', country = 'India'
    WHERE pub_id = '9999'
COMMIT TRAN

End Try

Begin Catch
    Rollback Tran
End Catch 
```

# ios - 应用程序的文档存储

> ID：11141821
> 
> 赞同：0
> 
> 时间：2012-06-21T15:44:23.813
> 
> 标签：ios, icloud, file-management

我的应用程序将从服务器下载一些带有图片的项目。每个项目都将作为文档保存在设备中。现在，所有文件都保存在应用程序的“文档”文件中。

我忘记了从哪个文档中阅读到存储在“文档”文件中的文件将应用于 iCloud 存储。那么如果我不需要 iCloud 服务，我是否有必要将这些文件放在 Caches 文件或其他文件中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T00:59:28.760

没有所谓的应用程序的“文档”文件。我猜你的意思可能是`Documents`文件夹。`Documents`文件夹存在于设备的本地沙箱和 iCloud 上。

根据用户偏好，您的应用可能需要相对于`Documents`子文件夹在本地沙箱和 iCloud 之间移动文档。

您需要在[此处](http://developer.apple.com/library/ios/#DOCUMENTATION/DataManagement/Conceptual/DocumentBasedAppPGiOS/Introduction/Introduction.html)遵循 Apple 针对 IOS 中基于文档的应用程序的指南。

# java - 从 OpenGL 中的单个 VBO 渲染任意大小的实例

> ID：11141822
> 
> 赞同：1
> 
> 时间：2012-06-21T15:44:24.710
> 
> 标签：java, opengl, gpu, lwjgl, vbo

考虑一个由多个对象填充的单个 VBO（或者可能是多个 VBO），每个对象都具有**任意**顶点数。出于演示目的，假设有一个苹果，有 500 个顶点，一个橙子，有 650 个顶点存储在 VBO 中。

通常，如果我想绘制橙色，我只需调用 glDrawRangeElements 并指出我想绘制元素 500-1150。如果我想在空间中的特定位置绘制橙色，我会使用模型转换。

但是，如果我想绘制可能有数千个对象怎么办？此外，如果 VBO 包含数百个甚至数千个对象作为一种“对象库”呢？我不希望使用即时模式（即，为每个对象手动调用*glDrawRangeElements* ）将我想要绘制的内容传输到我的 GPU 。这将增加与 GPU 通信的大量开销。

我正在寻找的是一种使用 OpenGL 一次性上传某种数组的方法。该数组将包含我要绘制的每个对象的某种标识符，并且可能包含每个对象的转换（位置、旋转）。因此，如果我想在任意位置绘制不同水果的海洋，我只需计算一次索引并上传即可。阵列可以交错。例如，数组可能如下所示：[object id *1* ]、[ position *1* ]、[rotation *1* ] ... [object id *n* ]。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T17:04:57.620

最终，您尝试做的事情（绘制许多完全不同的对象）不适用于任何“实例化”。

实例化适用于*相同*的对象。即在不同位置绘制的重复对象。您所做的只是绘制许多不同的对象。为此，您将不得不发出多个绘图调用。这是无法避免的。

你能做的最好的就是最小化你的状态变化。使用相同的着色器来渲染对象。使用纹理图集，可能在数组纹理中，这样您就不必更改对象之间的纹理。不要*使用*`glVertexAttribPointer`（超过初始设置）或更改元素缓冲区。

最后一部分的关键是[`glDrawElementsBaseVertex`](http://www.opengl.org/wiki/GLAPI/glDrawElementsBaseVertex). 只要缓冲区对象中的所有对象都使用相同的顶点格式，就可以将它们全部粘贴在同一个缓冲区中，就像一个巨型数组一样。然后使用索引列表将它们分开。基本顶点部分允许您保持索引相对较小。

最终，您想要的*只是*在对象之间更改对象的模型空间位置。你有很多选择来处理它。

最简单的方法是像往常一样只使用`glUniform`更改每个对象的模型到相机矩阵。你现在应该知道如何做到这一点了。

稍微复杂一点的是[使用一个统一的缓冲区](http://www.opengl.org/wiki/Uniform_Buffer_Object)来存储你想要绘制的所有对象的所有模型到相机矩阵。在对象之间，您使用`glBindBufferRange`绑定该对象的特定矩阵。没有关于这是否会比以前的方法更快或更慢的信息。[请注意，对于统一缓冲区的范围](http://www.opengl.org/wiki/Uniform_Buffer_Object#Data_storage)，实现具有与实现相关的对齐方式。

现在*从技术上讲*，GL 4.x 硬件允许您在表示渲染命令的缓冲区对象中创建一些数据，然后使用它进行渲染。这是 4.0 的核心，[称为间接渲染](http://www.opengl.org/registry/specs/ARB/draw_indirect.txt)。这样做的一般想法是 OpenCL 或一些专门的 GL 着色器进程将数据写入缓冲区对象，客户端代码只需说“渲染他所说的内容”，而不必读回数据并手动发出`glDrawElements`呼叫。

这对您没有帮助，因为每个呼叫都必须单独发出。即使使用[AMD 的多重间接绘图功能](http://www.opengl.org/registry/specs/AMD/multi_draw_indirect.txt)，它仍然对您没有帮助，因为您想为每个对象提供不同的变换。并且多重绘制不允许对象之间的不同变换。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T15:58:33.907

听起来你想要[实例化](http://en.wikipedia.org/wiki/Geometry_instancing)。

[查看](http://www.opengl.org/wiki/Vertex_Specification#Instancing)[`ARB_instanced_arrays`](http://www.opengl.org/registry/specs/ARB/instanced_arrays.txt)/ [`ARB_draw_instanced`](http://www.opengl.org/registry/specs/ARB/draw_instanced.txt)。_

[这是各种技术的比较](http://sol.gfxile.net/instancing.html)。

如果您使用的是固定功能管道，那么您就是 SOL :(

# java - 将参数传递给我的 login.jsp

> ID：11141823
> 
> 赞同：3
> 
> 时间：2012-06-21T15:44:27.500
> 
> 标签：java, security, servlets, login, parameters

我的简单 Servlet 应用程序有一个安全部分，我需要将参数传递给我的应用程序的安全部分。

流动：

1.  第 3 方需要使用我的登录机制（简单的安全 servlet）
2.  用户尝试访问：mycompany.com/loginApp/login?pref=1
3.  “/login” url 是安全的，所以应用服务器告诉浏览器重定向到我的 login.jsp，但此时 URL 更新为：mycompany.com/loginApp/login/login.jsp（注意“？ pref=1" 消失了）

我的 web.xml 的安全性如下所示：

```
 <security-constraint>
    <web-resource-collection>
        <web-resource-name>Secured</web-resource-name>
        <description></description>
        <url-pattern>/home</url-pattern>
        <url-pattern>/login</url-pattern>
        <url-pattern>/jsp/apps/*</url-pattern>
        <http-method>GET</http-method>
        <http-method>POST</http-method>
    </web-resource-collection>

    <auth-constraint>
        <description>protectedlinks</description>
        <role-name>protected</role-name>
    </auth-constraint>
</security-constraint>

<login-config>
    <auth-method>FORM</auth-method>
    <realm-name>mycompany.com</realm-name>
    <form-login-config>
        <form-login-page>/login.jsp</form-login-page>
        <form-error-page>/error.jsp</form-error-page>
    </form-login-config>
</login-config>

<security-role>
    <description>
    Protected portion of site</description>
    <role-name>protected</role-name>
</security-role> 
```

通过网络查看，似乎 AppServer 在尝试访问安全内容时确实会重定向到 login.jsp：http: [//docs.oracle.com/javaee/5/tutorial/doc/bncbe.html#bncbq](http://docs.oracle.com/javaee/5/tutorial/doc/bncbe.html#bncbq)

我想要发生的是“pref = 1”以某种方式保存到 login.jsp，然后提交给身份验证 servlet（验证数据库中的用户）。

关于如何做到这一点的任何建议？

**更新** 隐藏参数将不起作用。浏览器完成了一个完整的重定向，它清除了所有请求（包括 URL 中的“pref=1”参数）。因此，我不能将它作为隐藏参数包含在我的 login.jsp 表单中。

**更新 2** “pref”变量是动态的，所以它不会总是 1。

谢谢，肖恩

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T15:49:32.787

在 login.jsp`<input type="hidden" name="pref" value="1"/>`的标签内添加`<form/>`

虽然它将成为一个 POST 参数，因此在查询字符串中不完全可用，但它会在请求中存在。

以上涵盖了一个静态参数。*要在自动重定向上通过*login.jsp传递变量，您需要使用过滤器。这已在此处进行了介绍：[How to pass an additional parameter with spring security login page](https://stackoverflow.com/questions/10074308/how-to-pass-an-additional-parameter-with-spring-security-login-page)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T21:08:29.013

我不确定这是否可以按照您想要的方式完成。我会做的有点 hacki 方法如下：

设置一个将接受初始请求的 servlet。此 servlet 将传递的参数（pref）存储在会话变量中。然后这个 servlet 将重定向到受保护的资源。并且自动应用服务器将用户引导到登录页面。在那里，您的会话中有 pref 参数，您可以随心所欲地使用它。

我希望这有帮助

# iphone - iOS 在 iPad 上绘图很慢，但 iPhone 完美

> ID：11141827
> 
> 赞同：1
> 
> 时间：2012-06-21T15:44:36.707
> 
> 标签：iphone, ios, ipad, drawing, paint

任何人都可以在这段代码中看到一些东西，让它在 iPhone 上运行得非常柔和，但在 iPad 上的视网膜和非视网膜上却又慢又不稳定/笨拙？关于如何加快 iPad 速度的任何想法？我只想让它基本上用手指绘画，控制画笔大小、不透明度和边缘（这就是为什么我有渐变，用于软边缘）

谢谢

```
-(void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event
{

    UITouch *touch = [touches anyObject];
    CGPoint currentPointTemp = [touch locationInView:parentView.view];
    CGPoint currentPoint = CGPointMake((currentPointTemp.x /imageScale)+ (posOffset.x/imageScale), (currentPointTemp.y /imageScale) + (posOffset.y/imageScale));
    currentPoint.y -= 10;

    UIGraphicsBeginImageContextWithOptions(CGSizeMake(drawImage.frame.size.width, drawImage.frame.size.height), NO, 0); 

    [drawImage.image drawInRect:CGRectMake(0, 0, drawImage.frame.size.width, drawImage.frame.size.height)];

    CGContextSetLineCap(UIGraphicsGetCurrentContext(), kCGLineCapRound);
    CGContextSetAlpha(UIGraphicsGetCurrentContext(), opacity);
    CGContextBeginPath (UIGraphicsGetCurrentContext());
    CGContextAddArc(UIGraphicsGetCurrentContext(), lastPoint.x, lastPoint.y, glamzyDelegate.brushSize, 0, 6.28318531, 0);
    CGContextClosePath (UIGraphicsGetCurrentContext()); 
    CGContextClip(UIGraphicsGetCurrentContext());

    CGPoint myStartPoint, myEndPoint;
    CGFloat myStartRadius, myEndRadius;
    myStartPoint.x = lastPoint.x;
    myStartPoint.y =  lastPoint.y;
    myEndPoint.x = lastPoint.x;
    myEndPoint.y =  lastPoint.y;
    myStartRadius = 0;
    myEndRadius = glamzyDelegate.brushSize;

    CGContextDrawRadialGradient(UIGraphicsGetCurrentContext(), gradient, myStartPoint, myStartRadius, myEndPoint, myEndRadius, kCGGradientDrawsAfterEndLocation);

    drawImage.image = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();
    lastPoint = currentPoint;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T16:30:26.493

永远不要在触摸事件中调用任何绘图例程。

1.  您应该覆盖视图的drawrect方法
2.  在触摸事件中调用 setneedsdisplay

# css - 上 div 从下 div 的边距开始

> ID：11141830
> 
> 赞同：0
> 
> 时间：2012-06-21T15:44:45.970
> 
> 标签：css, margin, css-position

正如主题所说，我的上 div 从下 div 的边缘开始......
[链接到 jsfiddle](http://jsfiddle.net/5L6aa/3/)

不知道为什么会发生或如何解决，需要帮助

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T15:47:41.583

添加`top:0;`到上层 div。

[http://jsfiddle.net/5L6aa/8/](http://jsfiddle.net/5L6aa/8/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T15:52:49.430

您在#bases-container 中的边距设置为 10px，因此它看起来像是在第二个 div 之后开始的，但由于您的边距，它实际上只低了 10px。

# drupal - 如何输出 drupal 图像字段？

> ID：11141831
> 
> 赞同：20
> 
> 时间：2012-06-21T15:44:53.093
> 
> 标签：drupal, drupal-7, drupal-theming, drupal-themes

很有可能我只是在寻求帮助来查找 drupal (7) 中已经存在的函数的名称，但有时文档有点难以浏览。希望有人可以帮助我。

我有一个具有自定义字段的节点。

我在模板中工作`field--mycustomcontenttype.tpl.php`，因此试图找到输出的 PHP 函数的名称和带有图像样式的图像字段。

`mycustomcontenttype`是具有以下附加字段的节点：

```
[field_image] => Array
(
    [und] => Array
    (
        [0] => Array
        (
            [fid] => 51
            [alt] => ImageAltText
            [title] => 
            [width] => 150
            [height] => 150
            [uid] => 29
            [filename] => myimagename.jpg
            [uri] => public://myimagename.jpg
            [filemime] => image/jpeg
            [filesize] => 8812
            [status] => 1
            [timestamp] => 1339445372
            [uuid] => a088ea8f-ddf9-47d1-b013-19c8f8cada07
            [metatags] => Array
        (
    )
) 
```

所以我*可以*使用一个（丑陋的）手工滚动函数来显示图像，该函数采用在中找到的值`$item['#options']['entity']->field_image`并替换`public://`实际的服务器路径，然后我也可能想要加载正确的图像drupal 图像样式（缩略图、自定义样式等）

可悲的是，我只是不知道像这样工作的函数的名称是什么`unknown_function_name_drupal_image_print($item['#options']['entity']->field_image, 'thumnail');`。

有没有人可以帮我找到这个？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-06-21T15:49:20.400

你正在寻找[`image_style_url(style_name, image_url);`](https://api.drupal.org/api/drupal/modules!image!image.module/function/image_style_url/7)

例如：

```
<?='<img src="'.image_style_url('fullwidth', $node->field_page_image['und'][0]['filename']).'" />'?> 
```

**编辑**

正如所指出的，您还可以在“管理显示”页面中为内容类型设置图像样式，然后使用渲染输出。

```
<?php print render($content['field_image']); ?> 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-04-01T13:48:15.950

我会结合使用[field_get_items](http://api.drupal.org/api/drupal/modules!field!field.module/function/field_get_items/7)和 [field_view_value](http://api.drupal.org/api/drupal/modules!field!field.module/function/field_view_value/7)来做到这一点。

例如：

```
 <?php

    // In some preprocessor...
    $images = field_get_items('node', $node, 'field_image');
    if(!empty($images)) {
      $image = field_view_value('node', $node, 'field_image', $images[0], array(
        'type' => 'image',
        'settings' => array(
          'image_style' => 'custom_image_style' // could be 'thumbnail'
        )
      )
     );
    }
    $variables['image'] = $image;

    // Now, in your .tpl.php
    <?php print render($image); ?> 
```

我在这里写了一篇关于字段访问和这件事的[文章](http://drupal.mrvanmeter.com/node/2)。

祝你好运。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-06-21T16:37:50.627

SpaceBeers 的回答是正确的——你可以用这种方式打印图像。但在 Drupal 方面，这很糟糕。您的语言未定义，如果它是多值字段，则仅直接使用第一个字段。此外，您正在对 Drupal 的一些好东西进行硬编码，例如使用 UI 更改图像样式。

```
<?php print render($content['field_image']); ?> 
```

这将以适当的尺寸（在 img 标签中）、alt 标签打印图像，并始终尊重您在 mycustomcontenttype 节点类型的“管理显示”选项卡中设置的内容。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-06-22T01:14:57.653

我用这个：

```
print theme('image_style', array('path' => [image uri from field], 'style_name' => [image style])); 
```

您还可以包含一个“属性”数组变量，其中包含（例如）类、alt 和标题的元素。我认为这是允许您选择图像样式的更好选择，同时仍使用 Drupal（或您的主题）的默认图像渲染。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-10-07T17:02:15.007

你应该使用

```
<?='<img src="'.image_style_url('fullwidth', $node->field_page_image['und'][0]['uri']).'" />'?> 
```

代替

```
<?='<img src="'.image_style_url('fullwidth', $node->field_page_image['und'][0]['filename']).'" />'?> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-21T17:22:07.193

我认为 Ayesh K 的答案是将字段打印到页面的首选 Drupal 方式。更容易阅读，并保留您对 UI 中的图像所做的任何操作/预设。

您可以将其分解，但似乎只适用于狭窄的用例。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-04-19T07:06:08.013

```
<?php
global $base_url;
$nid=6;//node id
$node=node_load($nid);
echo '<div style="margin-right:350px;">';
echo "<marquee>";
foreach($node->field_image_gallery['und'] as $v){
$image=$v['uri'];
$image_path=explode("public://",$image);
$url_path=$base_url.'/sites/default/files/'.$image_path[1];
echo '<img src="'.$url_path.'" width="100" height="100">&nbsp;';
 }

echo "</marquee>";
echo "</div>";
?> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-10-05T13:53:55.447

这可以这样做：

```
 $style='full_width';
   $path=$node->my_img_field['und']['0']['uri'];
   $style_url = image_style_url($style, $path);
   print "<img src=".file_create_url($style_url)." >"; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-06-08T08:13:15.720

```
 $field_image = field_view_field('node', $promoNode, 'field_image');
 $variables['promo_image'] = render($field_image); 
```

渲染：

```
<div class="field field--name-field-image field--type-image field--label-above">
  <div class="field__label">Image:&nbsp;</div>
  <div class="field__items">
      <div class="field__item even">
        <img typeof="foaf:Image" 
             src="http://domain/sites/domain/files/promo1.png"
             width="360" 
             height="301"
             alt="Promotional Image"
             title="Promotional Image Title">
      </div>
  </div>
</div>
```

注意：可以使用字段的内容类型管理显示设置删除 label-above 类，方法是将 Label 设置为 ，但这对我现在不起作用，所以我只是使用 CSS 来隐藏 . field__label 类。

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2014-05-23T19:07:21.267

这对我将图像添加到我的搜索结果页面很有用：

```
<?php if ($result['node']-> field_image): ?>
  <?php
  $search_image_uri = $result['node']-> field_image['und'][0]['uri'];
  // assuming that the uri starts with "public://"
  $search_image_locate = explode('//', $search_image_uri);
  $search_image_filepath = '/sites/actual/path/to/public/' . $search_image_locate[1];
  ?>
  <div class="search-image">
    <img src="<?php print $search_image_filepath; ?>" />
  </div>
<?php endif; ?> 
```

# node.js - 使用 nodejs 将 v8 选项传递给永远

> ID：11141836
> 
> 赞同：19
> 
> 时间：2012-06-21T15:45:21.160
> 
> 标签：node.js, forever

所以我永远使用 nodejs 来保持我的服务器正常运行。我需要传递一些 v8 选项。我可以通过 nodejs 命令行做到这一点，但我怎么能永远做到这一点？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2013-11-28T23:23:59.780

```
forever start -c "node --harmony" app.js 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T16:14:06.967

而是指定一个 shell 脚本。让脚本**callnode.sh**包含该行

```
node --debug $1 $2 $3 
```

你可以永远这样称呼它：

```
var forever = require('forever-monitor');
forever.start(['./callnode.sh', 'your_process.js', {}); 
```

或使用永久 cli 选项 -c

# python - 在 Python 中具有单项组的应用程序布局

> ID：11141840
> 
> 赞同：2
> 
> 时间：2012-06-21T15:45:23.617
> 
> 标签：python, model-view-controller, web-applications, sqlalchemy

我来自 PHP 世界，在 Joomla 上工作了很多。现在我正在构建一个 Python Web 应用程序，当我面临一个非常基本的问题时，我的第一步是创建一个用户管理：当你的模型只代表一个数据库行时，你如何管理一个类中的所有用户。

一个例子将使这一点更清楚。这是 Joomla 所做的：

```
JUser::getInstance($userid) 
```

这样做是有一个类`JUser`，它有一个静态方法`getInstance()`，该方法对一个在所有实例中都有效的静态变量进行操作。通过这种方式，`JUser`管理所有用户，同时仅将*一个*用户表示为类的实例。

现在在 Python 上，我使用 SQLAlchemy 并有一个像这样的类：

```
class User(Base): 
```

... 等等。在我现在开始从一个糟糕的 PHP 世界做一些糟糕的事情之前，我想知道：这里正确和干净的方法是什么？构建一个`Users`包含所有用户的新类？或者这种静态方法方法是一个好概念吗？

我已经在谷歌上搜索了一段时间，但似乎找不到关于这个主题的内容：使用 MV(C) 模型在 Python 中构建更大的应用程序。任何人都可以阅读我可以阅读的任何好的链接？

以更具体的方式：我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T17:56:10.517

您应该创建一个模型类，就像 Joomla 所做的那样：

```
class User(Base):
    ... 
```

然后您可以使用 SQLAlchemy 的通用功能，并查询您需要的用户，

使用主键：

```
user = session.query(User).get(user_id) 
```

或使用唯一的用户名/电子邮件：

```
user = session.query(User).filter(User.username==my_username).first() 
```

说到为当前 HTTP 请求登录的用户，Web 框架通常会自动为您提供一个实例，将其传递给您正在实现的 HTTP 请求处理程序。例如，Django 框架从它自己的 ORM 开箱即用地为您提供用户实例，因为它具有所有身份验证和会话功能。我还将 Flask 微框架与 Flask-login 模块和 SQLAlchemy 一起使用，并且您需要实现一个回调，它通过用户 ID 加载用户实例，就像我之前说的：

```
@login_manager.user_loader
def load_user(userid):
    # just query for user
    return User.query.get(userid) # User.query is Flask-SQLAlchemy extension, it's same to session.query(User).get(userid) 
```

然后您可以从线程局部变量中获取您的用户实例：

```
from flask.ext.login import login_required, current_user

@app.route('/hello/')
@login_required
def my_request_handler():
    return "<html><body>Current user is %s</body></html>" % current_user.username 
```

当然，如果您需要通过 Id 获取用户实例的快捷方式，您可以实现静态方法：

```
class User(Base):
    ...

    @classmethod
    def by_id(cls, id):
        return session.query(cls).get(id) 
```

（其中 SQLAlchemy 的会话以某种方式全局定义）

对于 Python/Web 应用程序架构，您可以查看[Django——](https://djangoproject.com)它非常流行且易于使用的一体式框架，并且它具有类似 MVC 的架构。只需[阅读教程](https://docs.djangoproject.com/en/1.4/intro/tutorial01/)。

（但请注意，如果您希望使用 Django，Django 自己的 ORM 的功能与 SQLAlchemy 相比非常有限）。

# javascript - 从特定字符的数组中的字符串中获取值？

> ID：11141846
> 
> 赞同：0
> 
> 时间：2012-06-21T15:45:40.270
> 
> 标签：javascript, jquery

我有一个值数组，我需要解析这些值并将这些值提取到基于某个字符的新数组中

例如值：`2012-04-19T19:21:07-08:00`

我想遍历一个填充了上述值的数组，并从数组中每个位置的“T”之后的值中提取所有内容，并用这些结果填充一个新数组。

谁能指出我正确的方向？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T15:46:43.117

使用[`substr()`](http://www.w3schools.com/jsref/jsref_substr.asp)和[`indexOf()`](http://www.w3schools.com/jsref/jsref_indexof.asp)字符串方法可以实现。前任：

```
var x = '2012-04-19T19:21:07-08:00'
x.substr( x.indexOf('T') + 1 ); // output: "19:21:07-08:00" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T15:52:48.183

```
var d        = new Date('2012-04-19T19:21:07-08:00');

var hour     = d.getHours();
var minutes  = d.getMinutes();
var seconds  = d.getSeconds(); 
```

[日期对象](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Date#Methods)中还有很多功能......

# linux - 在linux中，要在内核中实现一些东西，为什么还要改变用户空间头文件呢？

> ID：11141848
> 
> 赞同：2
> 
> 时间：2012-06-21T15:45:45.233
> 
> 标签：linux, kernel, space

我正在尝试实现某种新的 Linux 任务调度程序，所以我发现这篇文章[http://www.eetimes.com/design/embedded/4204929/Real-Time-Linux-Scheduling-Part-1](http://www.eetimes.com/design/embedded/4204929/Real-Time-Linux-Scheduling-Part-1) 真的很有帮助。但是，它说我们不仅需要在 /kernel-source-code/include/linux/sched.h 中定义新的调度宏，还需要在 /usr/include/bits/sched.h 中定义相同的东西。

那么既然调度程序工作在内核中，为什么我们需要更改用户空间头文件。我不知道为什么我们有用户空间的头文件？无论如何，用户空间程序不能直接使用内核中定义的函数（除非通过系统调用），对吧？如果我们还需要更改用户空间文件来实现一个新的调度器，那么调度器如何能够移植，因为用户不仅需要使用新的内核映像，还需要更改他们的用户空间文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T16:10:55.780

这篇文章讨论了添加新的调度*类*或新的*调度策略*，而不是大规模替换内核调度算法。您需要用户空间进程能够选择策略[`sched_setscheduler(2)`](http://www.kernel.org/doc/man-pages/online/pages/man2/sched_setscheduler.2.html)，因此需要用户空间可见的头文件。

在[这里](http://oreilly.com/catalog/linuxkernel/chapter/ch10.html)查看更多详细信息。

# javascript - 根据条件jquery启用按钮/输入区域

> ID：11141859
> 
> 赞同：0
> 
> 时间：2012-06-21T15:46:05.800
> 
> 标签：javascript, jquery, button

我正在努力弄清楚如何在特定条件下启用文本框。因此，在下面的示例中，我希望禁用输入框“name”，直到单击“enterName”按钮。然后，当在输入框“名称”中输入某些内容时，我希望启用“useName”按钮（或者只是弹出一个提示框，上面写着“输入名称”）

```
<button id="enterName"> Enter a Name </button>
Name: <input type="text" id="name" disabled="disabled"/>
<button id="useName" disabled="disabled"> Use this name </button> 
```

现在，我有这个：

```
$(document).ready(function(){
   $("button:#enterName").click(function(){

       /* ??? */

     });
    });

$(document).ready(function(){
  $("button:#useName").click(function(){

    $("div.nameUsing").append($('input#name').val());
    $('input#name').val("");   //reset input field

 });
}); 
```

我不知道如何启用“enterName”按钮的文本框，或者在按下“useName”按钮时如何检查输入。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T15:48:03.643

尝试使用[`removeAttr`](http://api.jquery.com/removeAttr/). 例如：

```
$("#enterName").click(function() {
    $('#name').removeAttr('disabled');
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T15:54:18.387

您想使用[`.prop()`jQuery API](http://api.jquery.com/prop/)来启用或禁用控件。

测试和[工作](http://jsfiddle.net/GjdwN/1/)：

```
$(document).ready(function () {
    $("button#enterName").click(function () {
        $('input#name').prop('disabled', false);
    });
    $('input#name').change(function () {
        $("button#useName").prop('disabled', $(this).val().length === 0); //enable if length > 0, disable otherwise
    });
    $("button#useName").click(function () {
        $("div.nameUsing").append($('input#name').val());
        $('input#name').val("");   //reset input field
    });
});​ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-21T15:54:22.837

试试这个

```
$("#enterName").click(function() {
   $('#name').prop('disabled', false);
})

$('#name').keyup(function(){
    $('#useName').prop('disabled', $(this).val().length == 0);
});​ 
```

[jsFiddle 演示](http://jsfiddle.net/vbBzj/)

# r - 在 R 中解释 glmnet 中的系数名称

> ID：11141861
> 
> 赞同：6
> 
> 时间：2012-06-21T15:46:10.857
> 
> 标签：r, machine-learning, glm, glmnet

我正在使用 glmnet 使用以下代码根据一组 5 个功能预测概率。我需要实际的公式，因为我需要在不同的（非 R）程序中使用它。

```
deg = 3

glmnet.fit <- cv.glmnet(poly(train.matrix,degree=deg),train.result,alpha=0.05,family='binomial') 
```

结果系数的名称有五个位置（我假设这是每个特征之一），每个位置都是 0 到 3 之间的数字（我假设这是多项式的次数）。但是我仍然对如何准确地重构公式感到困惑。

以这些为例：

```
> coef(glmnet.fit,s= best.lambda)  
(Intercept) -2.25e-01  
...
0.1.0.0.1    3.72e+02
1.1.0.0.1    9.22e+04
0.2.0.0.1    6.17e+02
... 
```

我们将特征称为 A、B、C、D、E。这应该如何解释公式？

```
Y =
-2.25e-01 +
...
(3.72e+02 * (B * E) +
(9.22e+04 * (A * B * E) +
(6.17e+02 * (B^2 + E)
... 
```

如果这不正确，我应该如何解释它？

我看到了以下[问题和答案](https://stackoverflow.com/questions/4281000/converting-coefficient-names-to-a-formula-in-r)，但它没有解决这些类型的系数名称。

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-21T17:23:44.603

通常，我们使用预测功能。在您的情况下，您需要在另一个程序中使用这些系数。我们可以检查使用预测与将数据乘以系数的结果之间的一致性。

```
# example data

library(ElemStatLearn) 
library(glmnet) 
data(prostate) 

# training data 

data.train <- prostate[prostate$train,] 
y <- data.train$lpsa 

# isolate predictors

data.train <- as.matrix(data.train[,-c(9,10)]) 

# test data

data.test <- prostate[!prostate$train,] 
data.test <-  as.matrix(data.test[,-c(9,10)]) 

# fit training model 

myglmnet =cv.glmnet(data.train,y) 

# predictions by using predict function 

yhat_enet <- predict(myglmnet,newx=data.test, s="lambda.min") 

#  get predictions by using coefficients 

beta  <- as.vector( t(coef(myglmnet,s="lambda.min"))) 

# Coefficients are returned on the scale of the original data. 
# note we need to add column  of 1s for intercept

testX <- cbind(1,data.test) 
yhat2  <- testX %*% beta 

# check by plotting predictions  

plot(yhat2,yhat_enet) 
```

因此，每个系数对应于训练数据中的一列。第一个对应于截距。总之，您可以提取系数并乘以测试数据以获得您感兴趣的结果。

# silverlight - 绑定到自定义属性

> ID：11141863
> 
> 赞同：0
> 
> 时间：2012-06-21T15:46:12.617
> 
> 标签：silverlight, pagedcollectionview

几个小时前，我发布了一个问题（http://stackoverflow.com/questions/11134264/c-sharp-add-properties-at-runtime）。我询问了如何使用新属性扩展现有类。而且，没关系。我设法添加了新的属性，但现在我需要根据动态添加的属性将 GroupDescription 添加到 PagedCollectionView。这意味着我有课

```
MyClass
{
    string _name;
    string _phone;
} 
```

现在，我想动态地添加具有生成值的新属性（JobTitle、Position），并为 JobTitle 和 Position 定义 GroupDescriptions。通过提到的实施，我有

```
Dictionary<string, string> Attributes; 
```

但是，如果我说

```
collection.AddGroupDescription(key); 
```

它将根据 Key - JobTitle 对数据进行分组，而不是按值。

谢谢你，约克西莫维奇

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T19:38:54.697

所以实现这一点的标准方法如下

```
MyClass
{
    string _name;
    string _phone;
    string _jobTitle;
    string _position;
}

private ObservableCollection<MyClass> collection = //fetch from web service or something
PagedCollectionView pcv = new PagedCollectionView(collection);
pcv.GroupDescriptions.Add(new PropertyGroupDescription("JobTitle"));
DataGrid.ItemsSource = pcv; 
```

# javascript - 切换隐藏/显示谷歌地图标记

> ID：11141865
> 
> 赞同：2
> 
> 时间：2012-06-21T15:46:22.093
> 
> 标签：javascript, google-maps, google-maps-api-3, google-maps-markers

我有一个带有艺术家位置标记的自定义谷歌地图。我想制作 8 种不同类别的标记。我读到必须制作标记数组并分配类别，但老实说，我不知道从哪里开始..

我认为这个问题接近我想要的： [Toggle on/off Google map markers by category](https://stackoverflow.com/questions/5827964/toggle-on-off-google-map-markers-by-category)。试图让它发挥作用，但无济于事，我的知识太少了。

这是我的 HTML。我准备好了地图和几个复选框，这些复选框还没有使用。

```
<body onload="initialize()">

<div id="map_container">
    <div id="map_canvas" style="width:700px; height:350px">
    </div>
</div>

<div id="map_filter">
    <form action="#">
      <input type="checkbox" id="beeldend" onclick="displayMarkers(1)" /><label>Beeldende kunst</label><br />
      <input type="checkbox" id="film" onclick="displayMarkers(2)" /><label>Film/fotografie</label><br />
      <input type="checkbox" id="dans" onclick="displayMarkers(3)" /><label>Dans</label>
    </form> 
</div>

</body> 
```

这是我的 JS。我有一个 cat1 阴影和 cat1 图标，应该是 8 种不同的类型，但这可能不是这样做的方法，所以为了便于阅读，我只保留了一只猫。然后我有一个标记（art1），它有自己的位置、阴影等。

```
function initialize() {
var latlng = new google.maps.LatLng(52.0840356, 5.1546501);
var settings = {
    zoom: 13,
    center: latlng,
    mapTypeControl: true,
    mapTypeControlOptions: {style: google.maps.MapTypeControlStyle.DROPDOWN_MENU},
    navigationControl: true,
    navigationControlOptions: {style: google.maps.NavigationControlStyle.SMALL},
    mapTypeId: google.maps.MapTypeId.ROADMAP
};

var map = new google.maps.Map(document.getElementById("map_canvas"), settings);

var contentString = '<div id="content">'+
    '<div id="siteNotice">'+
    '</div>'+
    '<h1 id="firstHeading" class="firstHeading">Høgenhaug</h1>'+
    '<div id="bodyContent">'+
    '<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>'+
    '</div>'+
    '</div>';
var infowindow = new google.maps.InfoWindow({
    content: contentString
});

var cat1Shadow = new google.maps.MarkerImage('images/shadow.png',
    new google.maps.Size(130,50),
    new google.maps.Point(0,0),
    new google.maps.Point(65, 50)
);

var cat1Icon = new google.maps.MarkerImage('images/beeldend.png',
    new google.maps.Size(100,50),
    new google.maps.Point(0,0),
    new google.maps.Point(50,50)
);

var art1Pos = new google.maps.LatLng(52.0840356, 5.1546501);
var art1Marker = new google.maps.Marker({
    position: art1Pos,
    map: map,
    icon: cat1Icon,
    shadow: cat1Shadow,
    title:"Beeldende kunst",
    zIndex: 4
});

google.maps.event.addListener(art1Marker, 'click', function() {
  infowindow.open(map,art1Marker);
});

} 
```

那么.. 创建不同的标记数组并使用复选框切换其可见性的最佳方法是什么？

另外，我希望能够为标记分配地址，而不是查找坐标。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-21T16:22:18.637

创建不同的标记数组的最好方法是做这样的事情。你说你有 8 类标记，所以这样做 8 次。

```
var locations = [

                 ['Shanghai', 31.232, 121.47, 5885],
                 ['Beijing', 39.88, 116.40, 6426],
                 ['Guangzhou', 23.129, 113.264, 4067],
                 ['Shenzhen', 22.54, 114.05, 3089],
                 ['Hangzhou', 30.27, 120.15, 954],
                 ['Hong Kong', 22.39, 114.10, 1885]
               ];

function getMarkers() {
    for (i = 0; i < locations.length; i++) { 
            marker[i] = new MarkerWithLabel({
                position: new google.maps.LatLng(locations[i][1], locations[i][2]),
                draggable: false,
                map: map,
                    labelContent: locationsCA[i][3],
                icon: new google.maps.MarkerImage(iconArray[i]),
                labelAnchor: new google.maps.Point(30, 0),
                labelClass: "labels", // the CSS class for the label
                 labelStyle: {opacity: 0.75}
            }); 
```

至于您关于使用复选框切换可见性的第二个问题，我不知道如何制作复选框，但切换功能可以通过事件触发器轻松实现。无论是标记单击或缩放，还是任何其他事件（查看事件文档），您都会在该事件之后设置一个操作。这是一个例子。

```
google.maps.event.addListener(map,'zoom_changed',function () {
         if (map.getZoom() >= 4) {
            hideMarkers();          
         }
} 
```

并且您的 hideMarkers() 函数使用此命令使其不可见

```
marker.setVisible(false); 
```

希望有帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-01-14T16:48:32.683

您可以将它们存储在一个数组中，并使用 marker.setMap(null) 为不可见和 marker.setMap(map) 为可见切换可见性。

查看文档中的示例： [https ://developers.google.com/maps/documentation/javascript/examples/marker-remove](https://developers.google.com/maps/documentation/javascript/examples/marker-remove)

# mongodb - 使用 mongoimport 与 mongo shell 加载 1970 年之前的日期值

> ID：11141870
> 
> 赞同：1
> 
> 时间：2012-06-21T15:46:35.100
> 
> 标签：mongodb, mongoimport, mongo-shell

我有一些我们将其转换为 json 的数据，因此可以将其导入 mongodb。

对于某些文档，我们需要有一个 1970 年之前的日期字段。所以我们基本上通过以下方式测试文档：

```
[nbasjes@localhost ~]$ echo 'db.datetest.save({"date": new Date(1)});' | mongo nielsbasjes
MongoDB shell version: 2.0.6
connecting to: nielsbasjes
bye
[nbasjes@localhost ~]$ echo 'db.datetest.save({"date": new Date(-1)});' | mongo nielsbasjes
MongoDB shell version: 2.0.6
connecting to: nielsbasjes
bye 
```

并插入了两个文件。

但是，当我们尝试使用 mongoimport 加载相同的文档时，我们会得到：

```
[nbasjes@localhost ~]$ echo '{"date": new Date(1)}' | mongoimport -vv -d nielsbasjes -c datetest
Thu Jun 21 17:43:19 creating new connection to:127.0.0.1
Thu Jun 21 17:43:19 BackgroundJob starting: ConnectBG
Thu Jun 21 17:43:19 connected connection!
connected to: 127.0.0.1
Thu Jun 21 17:43:19 ns: nielsbasjes.datetest
Thu Jun 21 17:43:19 filesize: 0
Thu Jun 21 17:43:19 got line:{"date": new Date(1)}
Thu Jun 21 17:43:19 got line:
imported 1 objects 
```

到现在为止还挺好 ...

```
[nbasjes@localhost ~]$ echo '{"date": new Date(-1)}' | mongoimport -vv -d nielsbasjes -c datetest
Thu Jun 21 17:43:24 creating new connection to:127.0.0.1
Thu Jun 21 17:43:24 BackgroundJob starting: ConnectBG
Thu Jun 21 17:43:24 connected connection!
connected to: 127.0.0.1
Thu Jun 21 17:43:24 ns: nielsbasjes.datetest
Thu Jun 21 17:43:24 filesize: 0
Thu Jun 21 17:43:24 got line:{"date": new Date(-1)}
Thu Jun 21 17:43:24 Assertion: 10340:Failure parsing JSON string near: "date": ne
0x581a82 0x528610 0xaa3ff3 0xaa5e63 0xa9cccd 0xaa0932 0x3bbb81ecdd 0x4fed69
 mongoimport(_ZN5mongo11msgassertedEiPKc+0x112) [0x581a82]
 mongoimport(_ZN5mongo8fromjsonEPKcPi+0x3d0) [0x528610]
 mongoimport(_ZN6Import8parseRowEPSiRN5mongo7BSONObjERi+0x8b3) [0xaa3ff3]
 mongoimport(_ZN6Import3runEv+0x16e3) [0xaa5e63]
 mongoimport(_ZN5mongo4Tool4mainEiPPc+0x169d) [0xa9cccd]
 mongoimport(main+0x32) [0xaa0932]
 /lib64/libc.so.6(__libc_start_main+0xfd) [0x3bbb81ecdd]
 mongoimport(__gxx_personality_v0+0x3c9) [0x4fed69]
exception:Failure parsing JSON string near: "date": ne

Thu Jun 21 17:43:24 got line:
imported 0 objects
encountered 1 error 
```

我们已经为同一日期尝试了几种语法，并且所有这些形式都获得了相同的效果：

*   {“日期”：新日期（-2174520376）}
*   {“日期”：新日期（1901,2,3,22,33,44,000）}
*   {"date": new Date("1901 年 2 月 3 日 22:33:44")

测试系统运行 CentOS 64 位，带有来自 10gen RPM 存储库的 mongo-10gen-2.0.6-mongodb_1.x86_64 和 mongo-10gen-server-2.0.6-mongodb_1.x86_64。

我们如何解决这个问题？或者这是应该报告的 mongoimport 中的错误吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-15T20:33:03.107

我将此作为 MongoDB 错误跟踪器中的错误提交。 [https://jira.mongodb.org/browse/SERVER-6170](https://jira.mongodb.org/browse/SERVER-6170)

# mysql - Mysql 字符串/数字顺序

> ID：11141871
> 
> 赞同：0
> 
> 时间：2012-06-21T15:46:39.747
> 
> 标签：mysql

您好，我有一个可以包含字符串或数字的索引字符串字段。我想得到这个索引的最大值和最小值，但我希望一个只有数字的索引是整数，否则是字符串。例如我想要：

```
 ( "1", "5", "10" )       MIN=1 MAX=10 // mind MAX=10 not 5 as string order!
   ( "A", "D", "Z" )        MIN=A MAX=Z 
```

我试过这个：

```
MAX(IF(CAST(idxfield as UNSIGNED)=0,CAST(idxfield as UNSIGNED),idxfield)) as maxField 
```

但不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T17:39:45.300

尝试这个 ：：

```
Select 
idxfield REGEXP '[0-9] as field1,
CASE field1
 WHEN 1 THEN SELECT idxfield from table order by idxfield+0 desc
 WHEN 0 THEN SELECT idxfield from table order by idxfield desc
END as max_value,
CASE field1
 WHEN 1 THEN SELECT idxfield from table order by idxfield+0
 WHEN 0 THEN SELECT idxfield from table order by idxfield
END as min_value
from table 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T15:55:12.343

您可以`REGEXP`用来测试该字段是否为数字。

例如：

```
select '1'  REGEXP '^[0-9]+$'; // returns 1
select 'A'  REGEXP '^[0-9]+$'; // returns 0 
```

# c# - 在 DataGridViewComboBoxColumn SelectedIndexChanged 期间触发的事件

> ID：11141872
> 
> 赞同：27
> 
> 时间：2012-06-21T15:46:41.480
> 
> 标签：c#, .net, winforms, datagridview, datagridviewcomboboxcell

我有`DataGridView`两列。第一列是`TextBoxCol(DataGridViewTextBoxColumn)`，第二列是`ComboBoxCol(DataGridViewComboBoxColumn)`。

如何更改`TextBoxCol`when`ComboBoxCol`更改其选定索引值的值？（这应该在所选索引更改时发生`ComboBoxCol`。而不是在离开列之后，例如`dataGridView_CellValueChanged`）

我已经阅读了一个与我遇到的问题几乎相同的主题，但我不明白答案（根据复选标记应该是正确的）。这是链接。[-几乎相同的主题](https://stackoverflow.com/questions/4154713/how-to-create-event-handler-for-datagridviewcomboboxcolumn-in-a-data-grid-view-i)

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2014-01-23T23:52:58.293

这个答案在几个地方浮动。

使用 DataGridViewEditingControlShowingEventHandler 将触发比您预期更多的事件。在我的测试中，它多次触发了该事件。

同样使用 combo.SelectedIndexChanged -= 事件并不会真正删除该事件，它们只是继续堆叠。

无论如何，我找到了一个似乎可行的解决方案。我在下面包含一个代码示例：

```
// Add the events to listen for
dataGridView1.CellValueChanged += new DataGridViewCellEventHandler(dataGridView1_CellValueChanged);
dataGridView1.CurrentCellDirtyStateChanged += new EventHandler(dataGridView1_CurrentCellDirtyStateChanged);

// This event handler manually raises the CellValueChanged event 
// by calling the CommitEdit method. 
void dataGridView1_CurrentCellDirtyStateChanged(object sender, EventArgs e)
{
    if (dataGridView1.IsCurrentCellDirty)
    {
        // This fires the cell value changed handler below
        dataGridView1.CommitEdit(DataGridViewDataErrorContexts.Commit);
    }
}

private void dataGridView1_CellValueChanged(object sender, DataGridViewCellEventArgs e)
{
    // My combobox column is the second one so I hard coded a 1, flavor to taste
    DataGridViewComboBoxCell cb = (DataGridViewComboBoxCell)dataGridView1.Rows[e.RowIndex].Cells[1];
    if (cb.Value != null)
    {
         // do stuff
         dataGridView1.Invalidate();
    }
} 
```

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2012-06-21T18:17:47.227

试试这两个简单的方法（顶部方法中的 '1' 是组合框列的索引）

您要修改的行将是 setter line `cel.Value =`，因为您可以将其更改为您喜欢的任何内容。

* * *

```
 private void dataGridView1_EditingControlShowing(object sender, DataGridViewEditingControlShowingEventArgs e)
    {
        if (dataGridView1.CurrentCell.ColumnIndex == 1 && e.Control is ComboBox)
        {
            ComboBox comboBox = e.Control as ComboBox;
            comboBox.SelectedIndexChanged -= LastColumnComboSelectionChanged;
            comboBox.SelectedIndexChanged += LastColumnComboSelectionChanged;
        }
    }

    private void LastColumnComboSelectionChanged(object sender, EventArgs e)
    {
        var currentcell = dataGridView1.CurrentCellAddress;
        var sendingCB = sender as DataGridViewComboBoxEditingControl;
        DataGridViewTextBoxCell cel = (DataGridViewTextBoxCell)dataGridView1.Rows[currentcell.Y].Cells[0];
        cel.Value = sendingCB.EditingControlFormattedValue.ToString();
    } 
```

* * *

![在此处输入图像描述](../Images/368ebf96c95992571045cd6002b2eb41.png)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-21T16:36:47.493

该链接是正确的。处理`EditingControlShowing event`DataGridView。在此事件处理程序中，检查当前列是否是您感兴趣的。然后，创建一个临时组合框对象：-

`ComboBox comboBox = e.Control as ComboBox;`

MSDN 有一个示例：请参阅[此处](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridviewcomboboxeditingcontrol.aspx)的示例部分。 **注意** msdn 链接中的`Inheritance Hierarchy`& ： -`Class Syntax`

> 公共类 DataGridViewComboBoxEditingControl : **ComboBox** , IDataGridViewEditingControl

```
private DataGridView dataGridView1 = new DataGridView();

private void AddColorColumn()
{
    DataGridViewComboBoxColumn comboBoxColumn =
        new DataGridViewComboBoxColumn();
    comboBoxColumn.Items.AddRange(
        Color.Red, Color.Yellow, Color.Green, Color.Blue);
    comboBoxColumn.ValueType = typeof(Color);
    dataGridView1.Columns.Add(comboBoxColumn);
    dataGridView1.EditingControlShowing +=
        new DataGridViewEditingControlShowingEventHandler(
        dataGridView1_EditingControlShowing);
}

private void dataGridView1_EditingControlShowing(object sender,
    DataGridViewEditingControlShowingEventArgs e)
{
    ComboBox combo = e.Control as ComboBox;
    if (combo != null)
    {
        // Remove an existing event-handler, if present, to avoid 
        // adding multiple handlers when the editing control is reused.
        combo.SelectedIndexChanged -=
            new EventHandler(ComboBox_SelectedIndexChanged);

        // Add the event handler. 
        combo.SelectedIndexChanged +=
            new EventHandler(ComboBox_SelectedIndexChanged);
    }
}

private void ComboBox_SelectedIndexChanged(object sender, EventArgs e)
{
    ((ComboBox)sender).BackColor = (Color)((ComboBox)sender).SelectedItem;
} 
```

# java - java 瞬态变量类型必须知道序列化吗？

> ID：11141886
> 
> 赞同：3
> 
> 时间：2012-06-21T15:47:39.430
> 
> 标签：java, types, serializable, transient

我注意到在 Java 中，您可以使用一个类，该类具有您不可用的类型成员。例如，假设您有`.class`以下`Person`类的预编译文件；但不是 for `Address`，它使用：

```
public class Person implements Serializable {
    private static final long serialVersionUID = 1L;
    private String sex;
    private String name;
    private transient Address address;

    public Person(String sex, String name) {
        this.sex = sex; this.name = name; 
    }
    public void setAddress(Address address) {
        this.address = address
    }
} 
```

`Person person = Person("Male", "Andrew");`即使该类型`Address`对您的 Java 项目不可用，您也可以实例化此类。

现在的问题是，如果你想序列化一个`Person`对象，你不能这样做，除非`Address`类型可用（即可以由类加载器加载），即使该`Address`字段**是瞬态**的。

出于某种原因，Java 需要知道类型`Address`，即使它不需要序列化它......

关于如何`Person`在不必重新定义`Person`没有地址的类的情况下进行序列化的任何帮助？以及为什么 Java 需要知道地址类型尽管它不需要序列化它的任何解释？

非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T16:48:53.737

*我在假设您有.`.class`文件`Person`但没有`.class`. `Address`（也许`Person`是来自不同项目的依赖？）*

您无法序列化`Person`（即使该`Address`字段是瞬态的）的原因是序列化 API 使用 Java 反射 API。尽管 JVM 将加载一个类而不加载其所有依赖项，但反射 API 并不那么宽容。

第一次使用反射 API 检索特定类的字段信息时，它会检索并缓存该类中*所有*字段的信息。为此，它必须解析类中每个字段的类型，因此将尝试为每个字段加载类文件。（您可以在 Java 源代码中看到这一点：`ObjectOutputStream`使用[`ObjectStreamClass`](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/java/io/ObjectStreamClass.java#ObjectStreamClass.getDeclaredSUID%28java.lang.Class%29)、调用[`Class.getDeclaredField`](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/java/lang/Class.java#Class.getDeclaredField%28java.lang.String%29)、调用私有方法[`privateGetDeclaredFields`](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/java/lang/Class.java#Class.privateGetDeclaredFields%28boolean%29)，该方法解析并缓存类的所有字段定义。）

**作为一种解决方法**，如果您的代码实际上*从未*使用任何类型的对象`Address`，您可以简单地在正确的包中创建一个空`Address`类，编译它，并将其添加到您的类路径中：

```
public class Address { } 
```

* * *

对于那些认为`Person`没有类定义就无法在运行时使用的人`Address`，以下三个类演示了 OP 的含义：

**人.java**

```
import java.io.Serializable;
public class Person implements Serializable {
    private String name;
    private transient Address address;
    public Person(String name)  { this.name = name; }
    public Address getAddress() { return address; }
    public String getName()     { return name; }
} 
```

**地址.java**

```
public class Address {
    private String address;
    public String getAddress()  { return address; }
} 
```

**测试.java**

```
import java.io.FileOutputStream;
import java.io.ObjectOuputStream;
public class Test {
    public static void main(String...args) throws Exception {
        Person person = new Person("John Doe");
        System.out.println("Person successfully instantiated with name " + person.getName());

        // now attempt to serialize
        ObjectOutputStream out = new ObjectOutputStream(new FileOutputStream("person.out"));
        out.writeObject(person); // NoClassDefFoundError thrown here if Address.class doesn't exist
        out.close();
    }
} 
```

现在编译`Test.java`、删除`Address.class`和运行`Test`：

```
$ javac Test.java
$ rm Address.class
$ java Test
Person successfully instantiated with name John Doe
Exception in thread "main" java.lang.NoClassDefFoundError: LAddress;
        at java.lang.Class.getDeclaredFields0(Native Method)
        at java.lang.Class.privateGetDeclaredFields(Class.java:2308)
        at java.lang.Class.getDeclaredField(Class.java:1897)
        at java.io.ObjectStreamClass.getDeclaredSUID(ObjectStreamClass.java:1624)
        at java.io.ObjectStreamClass.access$700(ObjectStreamClass.java:69)
        at java.io.ObjectStreamClass$2.run(ObjectStreamClass.java:442)
        at java.security.AccessController.doPrivileged(Native Method)
        at java.io.ObjectStreamClass.<init>(ObjectStreamClass.java:430)
        at java.io.ObjectStreamClass.lookup(ObjectStreamClass.java:327)
        at java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1130)
        at java.io.ObjectOutputStream.writeObject(ObjectOutputStream.java:346)
        at Test.main(Test.java:10)
Caused by: java.lang.ClassNotFoundException: Address
        at java.net.URLClassLoader$1.run(URLClassLoader.java:217)
        at java.security.AccessController.doPrivileged(Native Method)
        at java.net.URLClassLoader.findClass(URLClassLoader.java:205)
        at java.lang.ClassLoader.loadClass(ClassLoader.java:321)
        at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:294)
        at java.lang.ClassLoader.loadClass(ClassLoader.java:266)
        ... 12 more 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T15:55:51.497

问题是要加载一个对象，它必须首先加载类。要加载类，它必须解析所有字段的类，如果没有类`Address`，则无法加载类或示例字段以确定它是瞬态的。

您可以通过提供一个`Address`位于类路径末尾的虚拟类来解决此问题。ie 仅在未定义时使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T15:58:25.223

对于要序列化的类，必须满足两个条件：

*   该类必须实现 java.io.Serializable 接口。
*   类中的所有字段都必须是可序列化的。如果字段不可序列化，则必须将其标记为瞬态。

您需要知道 Address 类才能构建项目。这与对象的序列化无关。地址类必须在编译时可用...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-17T02:32:09.933

我希望它会帮助你

**人.java**

```
 public class Person implements Serializable {
        private static final long serialVersionUID = 1L;
        private String sex;
        private String name;
        private transient Address address;

        public Person(String sex, String name) {
            this.sex = sex; this.name = name; 
        }
        public void setAddress(Address address) {
            this.address = address
        }

        private void writeObject(ObjectOutputStream os) {
            try {
                os.defaultWriteObject();
                os.writeUTF(this.address.getAddress());
            } catch (IOException e) {
                e.printStackTrace();
            }
        }

        private void readObject(ObjectInputStream is) {
            try {
                is.defaultReadObject();
                this.address = new Address(is.readUTF());
            } catch (IOException e) {
                e.printStackTrace();
            } catch (ClassNotFoundException e) {
                e.printStackTrace();
            }
        }

    } 
```

**地址.java**

```
 public class Address {
        private String address;
        public String getAddress()  { return address; }
        public void setAddress() { this address = address}
    } 
```

**测试.java**

```
 public class Test {
    public static void main(String...args) throws Exception {
        Person person = new Person("John Doe");
        person.setAddress("test address");

        try {
            FileOutputStream fis = new FileOutputStream("simple.txt");
            ObjectOutputStream os = new ObjectOutputStream(fis);
            os.writeObject(person);
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }

        try {
            FileInputStream fis = new FileInputStream("simple.txt");
            ObjectInputStream os = new ObjectInputStream(fis);
            person = (Person) os.readObject();           

        } catch (FileNotFoundException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        } catch (ClassNotFoundException e) {
            e.printStackTrace();
        }
    }
} 
```

# html - 如何以 300px x 300px div 居中图像？（图像尺寸未知）

> ID：11141887
> 
> 赞同：3
> 
> 时间：2012-06-21T15:47:40.367
> 
> 标签：html, css, layout

我有一个绝对位于浏览器左上角 300 像素 x 300 像素的 div。我计划在 div 中显示一个图像，但不幸的是我不知道图像的大小，尽管我知道图像将是 300 像素乘 300 像素或更小。

如何创建一个设置宽度和高度为 300px 的 div 以水平和垂直居中相同大小或更小的图像？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-21T15:54:39.567

```
#container { width: 300px; height: 300px; line-height: 300px; text-align: center; }
#container img { vertical-align: middle; display: inline-block; } 
```

​jsFiddle [演示](http://jsfiddle.net/bazmegakapa/R2GzA/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-21T15:49:49.817

在 div 上使用以下 CSS：

CSS

```
div {
    width: 300px;
    height: 300px;
    position: absolute;
    top: 0;
    left: 0;
    background: #fff center center no-repeat;
} 
```

HTML / PHP

```
<div style="background-image: url('<?php echo $image_url; ?>');"></div> 
```

# sparql - Jena Fuseki 服务器命令未找到

> ID：11141889
> 
> 赞同：2
> 
> 时间：2012-06-21T15:47:43.430
> 
> 标签：sparql, semantics, jena, fuseki

我是 Jena Fuseki 服务器的新手。根据链接[http://jena.apache.org/documentation/serving_data/index.html](http://jena.apache.org/documentation/serving_data/index.html)，在我的 Fedora 机器上下载并解压后，我尝试使用命令行启动服务器。

在 Fuseki 目录下，命令应该是这样的：**fuseki-server --update --mem /ds**，但它给出了错误：**fuseki-server command not found**。

有没有人知道问题是什么？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T16:10:47.917

这个对我有用。也许你可以通读下面的序列，看看你做了什么不同的事情：

```
[~] 
ian@ian-desktop $ cd /tmp
[/tmp] 
ian@ian-desktop $ mkdir fuseki-test
[/tmp] 
ian@ian-desktop $ cd fuseki-test
[/tmp/fuseki-test] 
ian@ian-desktop $ wget http://www.apache.org/dist/jena/binaries/jena-fuseki-0.2.2-distribution.tar.gz
--2012-06-21 17:04:46--  http://www.apache.org/dist/jena/binaries/jena-fuseki-0.2.2-distribution.tar.gz
Resolving www.apache.org (www.apache.org)... 192.87.106.229, 140.211.11.131, 2001:610:1:80bc:192:87:106:229
Connecting to www.apache.org (www.apache.org)|192.87.106.229|:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 9183962 (8.8M) [application/x-gzip]
Saving to: `jena-fuseki-0.2.2-distribution.tar.gz'

100%[==========================================================>] 9,183,962    783K/s   in 11s     

2012-06-21 17:04:58 (780 KB/s) - `jena-fuseki-0.2.2-distribution.tar.gz' saved [9183962/9183962]

[/tmp/fuseki-test] 
ian@ian-desktop $ tar -xvzf jena-fuseki-0.2.2-distribution.tar.gz
jena-fuseki-0.2.2/fuseki-server.jar
jena-fuseki-0.2.2/LICENSE
jena-fuseki-0.2.2/NOTICE
jena-fuseki-0.2.2/ReleaseNotes.txt
jena-fuseki-0.2.2/DEPENDENCIES
jena-fuseki-0.2.2/s-update
... more ....
jena-fuseki-0.2.2/fuseki-server
[/tmp/fuseki-test] 
ian@ian-desktop $ cd jena-fuseki-0.2.2/
[/tmp/fuseki-test/jena-fuseki-0.2.2] 
ian@ian-desktop $ ./fuseki-server --update --mem /ds
17:05:55 INFO  Server               :: Dataset: in-memory
17:05:55 INFO  Server               :: Dataset path = /ds
17:05:55 INFO  Server               :: Fuseki 0.2.2 2012-06-13T14:59:26+0100
17:05:55 INFO  Server               :: Jetty 7.x.y-SNAPSHOT
17:05:55 INFO  Server               :: Started 2012/06/21 17:05:55 BST on port 3030
^C[/tmp/fuseki-test/jena-fuseki-0.2.2] 
ian@ian-desktop $ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-18T12:55:58.917

> *这是作为[问题的编辑发布的](https://stackoverflow.com/revisions/11141889/2)，但实际上是一个答案。*

一些同事帮我解决了这个问题。这是 Linux 的问题，而不是 Fuseki 的问题。该错误意味着系统不知道在哪里可以找到**fuseki-server**，因此您必须将其放在 PATH 上，或者指定命令所在的位置，例如：

```
/opt/jena-fuseki-0.2.2/fuseki-server --update --mem /ds 
```

# terminal - 在 4GL Informix 中关闭“Wy-60”？

> ID：11141894
> 
> 赞同：2
> 
> 时间：2012-06-21T15:48:05.323
> 
> 标签：terminal, informix, telnet, 4gl

我们的数据库有一个 Informix 4GL 表单接口，可以使用在 WY-60 或“Wyse-60”终端仿真模式下运行的终端仿真器进行访问。

根据我正在阅读的内容，我之前将“终端”理解为文本流（例如 Hyperterm）的显示，“WY-60”模式意味着该软件正在模拟 1980 年代的计算机，即根据在文本流中发送的数据执行显示操作，从而产生高度的图形能力（在时间上），而数据流量的支出非常少。

我想知道的是，在 4GL Informix 中我有什么替代方案？

4GL 表单的菜单驱动界面可能需要比纯文本流终端更好的东西……但是要从我们当前的专有（需要昂贵的终端仿真软件）WY-60 型显示器改变多少工作例如，可以与免费的 PuTTY 终端软件一起使用的其他东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T16:46:44.953

这里有各种各样的事情要讨论，但基本的答案是：

*   `TERM`将环境变量的设置更改为与`wy-60`.

有哪些问题：

1.  您需要知道您使用的是`termcap`还是`terminfo`. 这由`INFORMIXTERM`环境变量控制，可以设置为`termcap`或`terminfo`取消设置，在这种情况下默认为`termcap`.
2.  您需要知道替代终端描述的来源。
    *   如果您使用`termcap`，则需要确保`TERMCAP`变量设置正确，无论是文件名（默认为`/etc/termcap`；Informix 在 中提供文件`$INFORMIXDIR/etc/termcap`）或终端条目的文本。
    *   如果您使用`terminfo`，您可以指定终端条目在`TERMINFO`环境变量中的存储位置。这将是一个目录名称；在它下面将是一系列目录，每个目录都有一个字符名称（终端名称的第一个字符），文件中包含实际的终端描述。因此，如果`TERMINFO=$HOME/terminfo`和`TERM=wy-60`，`terminfo`代码将查找文件`$HOME/terminfo/w/wy-60`。
3.  您需要确保您的新终端的相关描述可用。您可以使用由`termcap`或描述的任何终端类型`terminfo`。但是，Informix 确实使用了一些额外的功能（记录在 I4GL 参考手册的附录中）`termcap`。
4.  您需要检查 I4GL 程序在您的新终端类型上看起来是否干净。

您可能会查看大量其他终端类型中的`xterm`任何`xterm-color`一个`ansi`。`vt100`继续使用 Wyse 60 的唯一原因是它可以工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T17:11:44.900

WY-60（又名 Altos 2 终端）效果最好。您还可以选择使用 IBM Informix Genero（与 I4GL 兼容）将基于字符的 I4GL 表单转换为基于 GUI 的表单。我注意到您撤回了有关通过 Visual Studio 连接到 Informix 的问题。您解决了吗？

# dynamics-ax-2009 - 刷新 int64edit 并获取选定元素

> ID：11141896
> 
> 赞同：0
> 
> 时间：2012-06-21T15:48:14.657
> 
> 标签：dynamics-ax-2009, x++, axapta, ax, dynamics-ax-2012

刷新 int64edit 并获取选定元素。

我有一个 int64edit，当我选择一个值时，我想取回这个值。

我应该使用或覆盖哪种方法？我试图覆盖我使用 ValueStr 获取值的方法“ validate ”，但它没有像我希望的那样工作。一些建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T21:54:47.740

您可以将 int64edit 属性**AutoDeclaration**设置为**Yes**，然后您可以在需要时在“元素”（表单）范围内访问 valueStr()。

否则 validate() 方法应该没问题，但是，除非您在 super() 之后调用它，否则该值将不正确。

# python - 我正在尝试使用 fastcgi 运行网站，但我遇到了模板未呈现的问题

> ID：11141897
> 
> 赞同：0
> 
> 时间：2012-06-21T15:48:26.890
> 
> 标签：python, django, nginx, fastcgi

开始：

我正在使用 fastcgi/nginx 和 django 运行我的网站。我已经成功启动服务器，没有错误。我运行了 manage.py runserver 并访问了该网站，它有一个在 manage.py 下工作的菜单，但是当我使用 manage.py runfcgi 启动它时：

```
python manage.py runfcgi method=prefork maxchildren=30 host=127.0.0.1 port=4300 pidfile=pid workdir="$PWD" daemonize=false outlog="$LOGFILE" errlog="$LOGFILE" 
```

该应用程序只为我提供网站的第一页。

例如：

```
 If I go to mywebsite.com this being the home page I get the right 
   template home.html.
   If I visit mywebsite.com/get-started ,the server tries to render the same home.html. 
```

使用 manage.py runserver 有效，但使用 runfcgi 则无效。

PS：该网站使用了一些cookies并且它有一个自定义渲染功能，它是来自github的indextank服务，店面应用：[https](https://github.com/linkedin/indextank-service) ://github.com/linkedin/indextank-service 你可以通过manage.py运行它。

当我尝试导航顶部菜单时，通过 runfcgi 运行它并不会更改页面，它会发出请求，但它会使用相同的模板，即“home.html”

任何想法都非常感谢。

另外：服务器 fastcgi 配置非常标准：

```
fastcgi_param  SCRIPT_FILENAME    $document_root$fastcgi_script_name;
fastcgi_param  QUERY_STRING       $query_string;
fastcgi_param  REQUEST_METHOD     $request_method;
fastcgi_param  CONTENT_TYPE       $content_type;
fastcgi_param  CONTENT_LENGTH     $content_length;

#fastcgi_param  SCRIPT_NAME        $fastcgi_script_name;
fastcgi_param  REQUEST_URI        $request_uri;
fastcgi_param  DOCUMENT_URI       $document_uri;
fastcgi_param  DOCUMENT_ROOT      $document_root;
fastcgi_param  SERVER_PROTOCOL    $server_protocol;
fastcgi_param  HTTPS              $https if_not_empty;

fastcgi_param  GATEWAY_INTERFACE  CGI/1.1;
fastcgi_param  SERVER_SOFTWARE    nginx/$nginx_version;

fastcgi_param  REMOTE_ADDR        $remote_addr;
fastcgi_param  REMOTE_PORT        $remote_port;
fastcgi_param  SERVER_ADDR        $server_addr;
fastcgi_param  SERVER_PORT        $server_port;
fastcgi_param  SERVER_NAME        $server_name;

# PHP only, required if PHP was built with --enable-force-cgi-redirect
fastcgi_param  REDIRECT_STATUS    200; 
```

和应用程序 fastcgi 配置：

```
server {
        listen 80;
    server_name  search.spid.me www.search.spid.me;
        client_max_body_size 1m;

        location / {
            #fastcgi_param  SCRIPT_FILENAME    $document_root$fastcgi_script_name;
        fastcgi_pass  127.0.0.1:4300;
            include     fastcgi_params;
        #fastcgi_param  QUERY_STRING       $query_string;
            #fastcgi_param  REQUEST_METHOD     $request_method;
            #fastcgi_param  CONTENT_TYPE       $content_type;
            #fastcgi_param  CONTENT_LENGTH     $content_length;
        #fastcgi_param  PATH_INFO          $fastcgi_script_name;
        #fastcgi_pass 127.0.0.1:4300;
            #fastcgi_param PATH_INFO $fastcgi_script_name;
            #fastcgi_param REQUEST_METHOD $request_method;
            #fastcgi_param QUERY_STRING $query_string;
            #fastcgi_param SERVER_NAME $server_name;
            #fastcgi_param SERVER_PORT $server_port;
            #fastcgi_param SERVER_PROTOCOL $server_protocol;
            #fastcgi_param CONTENT_TYPE $content_type;
            #fastcgi_param CONTENT_LENGTH $content_length;
            #fastcgi_pass_header Authorization;
            #fastcgi_intercept_errors off;
        }

        location /_static {
            expires 24h;
            autoindex on;
            alias /home/indextank/storefront/static/;
        }

        location /nginx_status {
            stub_status on;
            access_log off;
            deny all;
            allow 127.0.0.1;
        }

        error_page   500 502 503 504  /50x.html;
        location = /50x.html {
            root   html;
        }
    }

 server {
    server_name  spid.search.me www.spid.search.me;
        listen 443;
        ssl on;
    #ssl_certificate /etc/nginx/conf.d/server.crt;
        #ssl_certificate_key /etc/nginx/conf.d/server.key;
        server_name  search.spid.me www.search.spid.me;
        client_max_body_size 1m;

        location / {
            fastcgi_pass  127.0.0.1:4300;
            include     fastcgi_params;
            fastcgi_param HTTPS on;
        }

        error_page   500 502 503 504  /50x.html;
        location = /50x.html {
            root   html;
        }
    } 
```

我做了更多调试，结果发现请求的路径和 path_info 没有设置...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T00:17:05.277

发现了问题。我在 fastcgi 参数文件中丢失了一些 fastcgi_params。我添加了这些，它似乎已经解决了这个问题。

# c# - 使用 XPath 进行 XML 解析。C＃

> ID：11141899
> 
> 赞同：-2
> 
> 时间：2012-06-21T15:48:55.927
> 
> 标签：c#, .net, xml, xpath

我有一些问题，也许是愚蠢的问题。

我有这个网址： [http://flibusta.net/opds/opensearch?searchTerm =Тол&searchType=books](http://flibusta.net/opds/opensearch?searchTerm=%D0%A2%D0%BE%D0%BB&searchType=books)

我想像这样解析响应：

```
string search_link = "http://flibusta.net/opds/opensearch?searchTerm=Тол&searchType=books";

_document = new XPathDocument(search_link);

XPathNavigator navigator = _document.CreateNavigator();
XmlNamespaceManager ns = new XmlNamespaceManager(navigator.NameTable);
XPathNodeIterator nodes = navigator.Select("/feed/title");

while (nodes.MoveNext())
{
        XPathNavigator currentNavigator = nodes.Current;
        string title = currentNavigator.Value;
        Trace.WriteLine(title);
} 
```

但是节点返回零结果。无法理解我做错了什么。

谢谢，

帕维尔。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-21T16:03:07.700

忘记没有名称空间的 XML。试试下面的例子，它对我来说很好：

```
var document = new XPathDocument("http://flibusta.net/opds/opensearch?searchTerm=%D0%A2%D0%BE%D0%BB&searchType=books");
XPathNavigator navigator = document.CreateNavigator();
var ns = new XmlNamespaceManager(navigator.NameTable);
ns.AddNamespace("atom", "http://www.w3.org/2005/Atom");

XPathNodeIterator nodes = navigator.Select("/atom:feed/atom:title", ns);

while (nodes.MoveNext())
{
        XPathNavigator currentNavigator = nodes.Current;
        string title = currentNavigator.Value;
        Trace.WriteLine(title);
} 
```

# c++ - 输出后程序崩溃

> ID：11141902
> 
> 赞同：0
> 
> 时间：2012-06-21T15:49:00.373
> 
> 标签：c++, sigabrt

我正在尝试运行一个程序，有时我在尝试编译时遇到此错误

ld 返回 1 个退出状态

虽然，当它编译（就像我说的，并非总是如此）并尝试输入某些输入时，程序会输出答案......然后崩溃。有没有办法做到这一点？

这是我的代码：

```
#include <iostream>
#include <vector>
#include <cmath>
#include <algorithm>
using namespace std;

int main() {
  bool flag;
  int n,x[] = {1,-1};
  long long int A,cont,mul,acum;
  while(cin >> n >> A) {
    acum = 0;
    vector<long long int> nums(n),nums2;
    for(int i=0;i<n;i++) cin >> nums[i];

    sort(nums.begin(),nums.end());

    for(int i=n-1;i>=0;i--) {
      flag = 1;
      for(int j=0;j<i and flag;j++) if(nums[i]%nums[j] == 0) flag = 0;
      if(flag) nums2.push_back(nums[i]);
    }

    n = nums2.size();

    vector<long long int> mult(n,0);

    const long long int num = (1<<n);
    for(int i=0;i<num;i++) {
      cont = 0, mul = 1;
      for(int j=n-1;j>=0;j--) if(i & (1<<j)) cont++, mul *= nums2[j];
      mult[cont-1] += A/mul;
    }

    for(int i=0;i<n;i++) acum += (x[i%2]*mult[i]);

    cout << acum << endl;
  }
  return 0;
} 
```

这是我在程序崩溃时输入的内容：

```
17 1000
2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T15:59:51.380

如果你在调试器中运行你的程序，你会看到问题出现在一行

```
mult[cont-1] += A/mul; 
```

当 cont 为 0 时，这意味着您正在尝试修改向量的元素 -1。

我不知道算法试图做什么，所以我不知道为什么 cont 可能最终为零。

总体建议：学习使用调试器。是你的朋友。:)

# javascript - 循环遍历数组以检查复选框

> ID：11141909
> 
> 赞同：0
> 
> 时间：2012-06-21T15:49:18.247
> 
> 标签：javascript, jquery, asp.net, html

我在正确的轨道上吗？我正在改变这样做的方式，因为这样效果最好。

我正在做的是取一系列数字

```
var n = "1,3,8,12,2,19"; 
```

我有以下检查复选框：

```
$('#chk1').attr('checked', true) 
```

有没有办法将 chk1 中的 1 替换为 n 中的数字？我想遍历数字数组并检查所有带有该数字的框。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T15:50:56.907

尝试如下，

```
$.each (n.split(','), function (index, value) {
   $('#chk' + value).attr('checked', true);
}); 
```

如果您有`n`以下内容，那就更容易了，

```
var n = [1, 3, 8, 12, 2, 9];//array
$.each (n, function (index, value) {
   $('#chk' + value).attr('checked', true);
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T15:57:28.333

```
var n = "1,3,8,12,2,19", // not an Array but a String
    arr = n.split(',');  // now it turns to Array like [1, 3, 8, 12, 2, 9]

// loop over array
for(var i = 0 ; i < arr.length; i++) {
   $('#chk' + arr[i]).attr('checked', true);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T15:52:08.167

```
var nums = n.split(',');

$(nums).each(function(){
    $('#chk' + this).attr('checked', true);
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-21T16:25:40.773

var nums = [1,3,8,12,2,19];

$(nums).each(function() { $('#chk' + this).prop('checked', true); });

# mongodb - 如何通过 mongodb c# 驱动程序以编程方式执行更新？

> ID：11141916
> 
> 赞同：0
> 
> 时间：2012-06-21T15:49:29.667
> 
> 标签：mongodb, nosql

我正在尝试对不为空的对象字段上的对象执行更新。我知道我可以简单地要求对象在它到达我的更新函数之前完全填充，但我宁愿我的函数的使用者只传递已更改的值（并将所有其他值保持为空）。所以问题是我如何告诉 mongodb 只为我的对象的非空字段做类似于 Update.Set() 的事情？谢谢您的帮助！

# facebook - Facebook Connect 与 Facebook 注册

> ID：11141925
> 
> 赞同：0
> 
> 时间：2012-06-21T15:49:54.323
> 
> 标签：facebook, facebook-graph-api, facebook-fql, facebook-social-plugins

Facebook Connect 和 Facebook 注册之间有什么区别？以及如何通过 facebook connect 获取用户 ID？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T17:12:59.743

注册插件提供了登录按钮不具备的两个关键功能：支持没有 Facebook 帐户的用户，以及请求 Facebook 可能没有或不提供的其他用户信息的能力。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T15:51:49.587

Facebook 注册通过使用他们的 Facebook 数据为您的网站填写注册表，帮助用户注册到您的网站。Facebook 连接用于将用户登录到您的网站，因此他们无需注册单独的帐户。

# opencv - 图像阵列，子弹时间校准

> ID：11141930
> 
> 赞同：0
> 
> 时间：2012-06-21T15:50:05.017
> 
> 标签：opencv, openframeworks

我对 OpenCV 和 C 语言或任何语言的编程非常陌生。

截至目前，在一个项目的边界上，我正在为多个图像编写校准，最终将用于子弹时间效果。

为了校准图像，我正在检测标记（颜色检测），然后计算从我的 desImg 到我的 srcImg 的转换矩阵，最后应用 PerpectiveTransform。

这个作品找到 2 张图片，我单独加载；但是，我怎样才能用图像填充和排列。IPImage * img[] 不起作用。

我需要这个来为每个单独的图像获取一个转换矩阵，这样我就可以在 OpenFrameworks 中使用 OpenGL 来可视化经过校准的图像序列。在一个循环中，我会在 Image 之后读出 Image 并将其与我的 desImage 进行比较以计算正确的矩阵。

如果不需要的话，我真的不想加载大量的 IPImage。

谢谢您的帮助

PS：也试过这个......没有运气：

CvMat* 图像；图像 = cvCreateMat(1, 8, IplImage);

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T16:04:14.507

首先，我建议您使用 opencv 查看 python

新的 python 绑定 (import cv2) 使在 python 中工作变得更加容易，并且您避免了 C 的所有复杂性。实际的图像函数调用仍然在 C 中，因此它同样快，但更容易学习和试验。

至于您的具体问题，您需要将转换与某些东西相关。根据您的设置，您应该决定将每个图像与前一个图像进行比较，并让所有的位移都相对 - 或者选择一些中心框架并将其用作每对图像之一并计算与之相关的所有位移。

# ios5 - 如何将工具栏与 iOS 5 中的每次旋转对齐？

> ID：11141931
> 
> 赞同：1
> 
> 时间：2012-06-21T15:50:11.757
> 
> 标签：ios5, toolbar, xcode4.3, uitoolbar

XCODE 4.3.2 用户

大家好，

有谁知道如何将他们的工具栏与每次旋转正确对齐？在视图控制器中，我在顶部有一个导航栏，在底部有一个工具栏。目前，它们的尺寸相同，但是当我进行水平旋转时，导航栏已经适应了尺寸并使其自身变小，而底部的工具栏与垂直位置相同。有人可以告诉我如何解决这个问题吗？我从“对象”窗格中拉出一个工具栏，然后将其拖到视图控制器中，以防该信息有帮助。

谢谢， ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T15:58:36.197

确保您为新的“ `UIToolbar`”对象正确设置了自动调整大小。在 Xcode 中应该是这样的：

![在此处输入图像描述](../Images/4f539f36fcda68cb98fd8ffbf50e1726.png)

# c# - 为什么我在 PNG 文件中看不到列表框？

> ID：11141938
> 
> 赞同：1
> 
> 时间：2012-06-21T15:50:27.900
> 
> 标签：c#, silverlight, windows-phone-7, listbox, live-tile

**我想要什么我想**
在 WP7.5 中显示一个自定义动态磁贴、一个文本块和一个带有 4 个字符串的列表框作为其列表项。所以我用所有的东西创建了一个图像，并将其显示为动态磁贴的背景。

**我编码的内容**

```
 //prepare the background
        WriteableBitmap bmp = new WriteableBitmap(173, 173);
        BitmapImage logo = new BitmapImage(new Uri("/images/tile/SecondaryTile.png", UriKind.Relative));            
        Image img = new Image { Source = logo };

        // Force the bitmapimage to load it's properties so the transform will work
        logo.CreateOptions = BitmapCreateOptions.None;

        //create a textblock
        TextBlock taskNumberShow = new TextBlock();
        taskNumberShow.Foreground = new SolidColorBrush(Colors.White);
        taskNumberShow.FontSize = 35;
        taskNumberShow.HorizontalAlignment = HorizontalAlignment.Center;
        taskNumberShow.FontFamily = (FontFamily)Application.Current.Resources["PhoneFontFamilySemiBold"];
        taskNumberShow.Text = "35";

        //define the position
        TranslateTransform tt1 = new TranslateTransform();
        tt1.X = 45;
        tt1.Y = 7;
        bmp.Render(taskNumberShow, tt1);

        //create a listbox
        ListBox listBox1 = new ListBox();
        listBox1.Height = 100;
        listBox1.Width = 173;
        listBox1.HorizontalAlignment = HorizontalAlignment.Center;
        //listBox1.VerticalAlignment = VerticalAlignment.Bottom;
        //listBox1.Margin = new Thickness(50, 150, 0, 0);

        //put a string array in the listbox, the length of this array is 4
        for (int i=0; i < TaskList.Length; i++)
        {
            //先生成一堆textBlock
            TextBlock txtBlk = new TextBlock();
            txtBlk.Name = "txtBlk" + i.ToString();
            txtBlk.Text = TaskList[i];
            txtBlk.FontSize = 17;
            txtBlk.Width = 173;
            txtBlk.TextWrapping = TextWrapping.NoWrap;
            txtBlk.Foreground = new SolidColorBrush(Colors.White);
            listBox1.Items.Add(txtBlk);
        }

        //define the position
        tt1.X = 0;
        tt1.Y = 40;
        bmp.Render(listBox1, tt1);

        //add the backgroundpic
        tt1.X = 0;
        tt1.Y = 0;
        bmp.Render(img, tt1);
        bmp.Invalidate();

        ExtendedImage extendImage = bmp.ToImage(); 
```

**什么是 END**
我可以看到文本块，但我看不到列表框。我尝试使用下面的代码将字符串数组（TaskList[]）的项目直接分配给列表框

```
for (int i=0, i<TaskList.Length, i++)
{
 Listbox1.Items.Add(TaskList[i]);
} 
```

但结果是我也看不到。

**我该如何解决这个问题？为什么我看不到图片中的列表框？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T17:51:08.840

这可能与 ListBox 的虚拟特性有关。一种选择是将 ItemsPanel 设置为 StackPanel。另一种可能更简单的方法是只使用 StackPanel

```
//create a StackPanel
    StackPanel stackPanel1 = new StackPanel();
    stackPanel1.Height = 100;
    stackPanel1.Width = 173;
    stackPanel1.HorizontalAlignment = HorizontalAlignment.Center;

    //put a string array in the listbox, the length of this array is 4
    for (int i=0; i < TaskList.Length; i++)
    {
        //先生成一堆textBlock
        TextBlock txtBlk = new TextBlock();
        txtBlk.Name = "txtBlk" + i.ToString();
        txtBlk.Text = TaskList[i];
        txtBlk.FontSize = 17;
        txtBlk.Width = 173;
        txtBlk.TextWrapping = TextWrapping.NoWrap;
        txtBlk.Foreground = new SolidColorBrush(Colors.White);
        stackPanel1.Children.Add.Add(txtBlk);
    } 
```

我还建议将所有控件放入像 Grid 这样的父容器中，并将 Grid 呈现为一个整体。

# python - AttributeError：“nt.stat_result”对象没有属性“S_IWRITE”

> ID：11141940
> 
> 赞同：2
> 
> 时间：2012-06-21T15:50:34.113
> 
> 标签：python, import, attributeerror

我正在尝试删除文件。我检查日期并删除它是否比我想要的旧。我注意到一个 .zip 文件没有被删除。它是只读的，所以在一些测试代码中，我使用了 os.chmod(path, stat.S_IWRITE) 然后 os.remove(path) 并且它起作用了。我将此代码放入我的主代码并得到错误。我在两者中都导入了 os 和 stat 模块。

下面是有效的测试代码，但是当我把它放到更大的代码中时，我得到了错误，完整的代码也只是一个 def：

AttributeError：“nt.stat_result”对象没有属性“S_IWRITE”

我检查了 dpath 和 dayscount 是否通过了路径和天数。

```
import os, stat

def del_file(dpath, dayscount):
    if dayscount > 10:
        if dpath[-4:]== ".zip":
            os.chmod(dpath,stat.S_IWRITE)
            os.remove(dpath)
        else:
            os.remove(dpath)
    else:
        print "File is Good"

dpath = "C:\Workspace\Test_Data.zip"
dayscount = 15
del_file(dpath, dayscount) 
```

阅读此处后，我找到了一个链接：[此页面上](https://stackoverflow.com/questions/1250103/attributeerror-module-object-has-no-attribute)的代码，其中显示了一些导入模块的示例。答案说要在函数中导入模块。我在我的主要代码上尝试了这个并且它有效。

主要代码在代码顶部导入os和stat，但是这个函数好像没有看到。我不确定为什么。当我将它导入模块时，它会看到它。因此，当放入主代码时，我必须将导入添加到模块中，见下文。

```
import os, stat

def test_date():
Code for this function

def get_month():
Code for this function

def del_file(dpath, dayscount):
    import os, stat
    print dpath
    print dayscount
    if dayscount > 10:
        if dpath[-4:]== ".zip":
            os.chmod(dpath,stat.S_IWRITE)
            #os.remove(dpath)
        else:
            os.remove(dpath)
    else:
        print "File is Good"

dpath = "C:\Workspace\Test_Data.zip"
dayscount = 13
del_file(dpath, dayscount) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T16:02:16.800

`stat`您正在代码中的某处设置一个具有名称的变量（`os.stat`调用的结果）。这个变量使统计模块黯然失色。

搜索`stat =`变量并将其重命名为另一个名称，例如`stat_result`.

# javascript - KnockoutJS observable 没有观察到 jQuery 的 empty() 事件

> ID：11141941
> 
> 赞同：0
> 
> 时间：2012-06-21T15:50:37.217
> 
> 标签：javascript, jquery, knockout.js

我有几个文本框：本地和外国电话号码以及一个用于切换它们的复选框，如下所示：

```
 TogglePhoneFields = function(isForeign) {
    if (isForeign) {
      $('#Phone_LocalNumber').attr('disabled', 'disabled');
      $('#Phone_LocalNumber').val('');
      $('#Phone_ForeignPhoneNumber').removeAttr('disabled');
      return $('#Phone_ForeignPhoneNumber').focus();
    } else {
      $('#Phone_LocalNumber').removeAttr('disabled');
      $('#Phone_ForeignPhoneNumber').attr('disabled', 'disabled');
      return $('#Phone_ForeignPhoneNumber').val('');
    }
  }; 
```

加价：

```
<input data-bind="value: localnumber" 
    id="Phone_LocalNumber" type="text" value='' />

<input data-bind="checked: isForeignPhoneNumber" 
    id="Phone_IsForeignPhoneNumber" type="checkbox" value="true" />

<input data-bind="value: foreignphonenumber" 
    id="Phone_ForeignPhoneNumber" type="text" value="" /> 
```

而且我对这些电话号码进行了验证，很明显，在您在本地电话号码中输入一个值后，勾选“IsForeign”复选框（它调用 TogglePhoneFields(true) ）并取消勾选它，可观察值**不会被清除**。

我正在努力解释这一点，如果根本不清楚，我可以写一个 jsFiddler。问题基本上是**当它的值被javascript代码操作时如何更新可观察项目？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T15:56:45.000

Knockout 值绑定订阅它们绑定到的输入上的更改事件。如果使用 val 更新 jquery 中的输入，则需要触发更改事件，否则不会触发值绑定。

所以例如

```
$('#Phone_LocalNumber').val('').change(); 
```

希望这可以帮助。

# wpf - 使用 Caliburn.Micro 进行验证

> ID：11141942
> 
> 赞同：7
> 
> 时间：2012-06-21T15:50:37.733
> 
> 标签：wpf, caliburn.micro

有没有办法使用 Caliburn.Micro 在 wpf 应用程序中验证文本框输入（使用正则表达式）？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-01-28T21:06:37.073

我为 CM 编写了一个小插件来启用流畅的构建器样式验证。随意使用它：[https ://github.com/AIexandr/Caliburn.Micro.Validation](https://github.com/AIexandr/Caliburn.Micro.Validation)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-22T10:27:50.400

我建议使用基于属性的方法。看看这篇文章：

[WPF 中的验证](http://www.codeproject.com/Articles/97564/Attributes-based-Validation-in-a-WPF-MVVM-Applicat)

这里的方法基本上是：

从验证视图模型基类继承。反过来，这可以非常愉快地从 Caliburn Screen/Conductor/etc 基类继承

完成此操作后，您所需要做的就是将要验证的属性赋予属性。这非常适合 CM 方法。

# javascript - 将一条线动画化到多个点

> ID：11141944
> 
> 赞同：0
> 
> 时间：2012-06-21T15:50:52.567
> 
> 标签：javascript, html, canvas

使用画布，我试图为一条从一个点连续移动到另一个点的单行设置动画。（就像印第安纳琼斯电影中他从一个地方飞到另一个地方时的地图）。

我无法理解如何使这项工作。我当前的代码制作了一个实心三角形。整洁，但我想看到 vee 形状自己绘制。有什么建议么？

谢谢

[这是我的代码](http://jsfiddle.net/rbot/ERkCA/9/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T16:06:53.770

## [工作演示](http://jsfiddle.net/ERkCA/12/)

这是我整理的一个快速方法。它无论如何都不完美。它使用矩形而不是线条，但如果您想加快绘制速度（或者只是更改超时方法的更新时间），可以轻松地将其更改为线条。只需将起始 x/y 更改为您希望它开始的位置，然后将一个点数组传递给函数，它会在每个点上画线，直到用完为止。

```
var canvas = document.getElementById("canvasWindow");
var c = canvas.getContext("2d");

var curPoint = {
    x : 0,
    y : 0,
    index : 0   
}

var points = [{x:10, y:20}, {x:100, y:100}, {x:50, y:150}, {x:0,y:0}];

function toPoints(points){
    var targetPoint = points[curPoint.index];
    var tx = targetPoint.x - curPoint.x,
        ty = targetPoint.y - curPoint.y,
        dist = Math.sqrt(tx*tx+ty*ty),
        rad = Math.atan2(ty,tx),
        angle = rad/Math.PI * 180;;

        velX = (tx/dist)*1;
        velY = (ty/dist)*1;

    curPoint.x += velX;
    curPoint.y += velY;

    if(dist < 2){
        curPoint.index++;
    }

    c.fillRect(curPoint.x, curPoint.y, 1, 1);
    if(curPoint.index < points.length){
        setTimeout(function(){toPoints(points)}, 10);
    }
}

toPoints(points); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T15:59:09.847

我不确定确切的目标，但`c.beginPath();`如果你只想画线而不是填充三角形，你可能会错过一两个。

（对不起，我不知道这部电影……）

# binary-search-tree - 这个序列在 BST 中插入多少个

> ID：11141946
> 
> 赞同：0
> 
> 时间：2012-06-21T15:50:54.940
> 
> 标签：binary-search-tree

4节点二叉搜索树：2143。有3种方法插入并得到相同的结果。

这3种可能的方法是什么？

```
 1<-2->4 and then 3 would branch left of 4\. 
```

我没有看到任何其他可能的插入排列。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T16:07:57.230

不同的插入顺序会导致不同的布局：

```
1  ->   2 ->   2   ->   2
       /      / \      / \
      1      1   3    1   3
                           \
                            4 
```

与：

```
1  ->   2 ->   2   ->   2
       /      / \      / \
      1      1   4    1   4
                         /
                        3 
```

如果您想知道如何获得与通过插入序列 2->1->4->3 获得的布局相同的布局

```
 2
 / \
1   4
   /
  3 
```

你得到：1->2->4->3、2->1->4->3、2->4->3->1

# ios - 如何在左侧对 UITableViewCell 进行重新排序控制？

> ID：11141947
> 
> 赞同：20
> 
> 时间：2012-06-21T15:50:55.200
> 
> 标签：ios, uitableview, custom-controls

我正在做一个新闻阅读器应用程序，我想让它让用户可以选择显示/隐藏新闻类别（如热门新闻、商业、技术、体育等）并像 Android 中的 BBC 新闻应用程序一样重新排序它们。

见下图：

![在此处输入图像描述](../Images/9ee6e8d33e64efed4af1354b7fb30d18.png)

我的问题是：

*   如何在单元格左侧进行重新排序控制？（其默认位置在编辑模式下单元格的右侧）
*   我有一个复选框自定义控件。如何将它放在单元格的右侧？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-06-22T22:14:40.387

## 回答 [如果您没有使用任何配件（细节披露，&c）]

(0) 我假设你已经设置好了表格，&c。

(1) 此解决方案仅在您的表格单元格始终可拖动时才有效。将此添加到您的 viewDidLoad 到您的 Table View Controller .m 文件中。

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    [self setEditing:YES];
} 
```

(2) 为了使您可以重新排序单元格，请添加`cell.showsReorderControl = YES;`到您的 tableView:cellForRowAtIndexPath:。

(3) 确保您有 tableView:canMoveRowAtIndexPath: 和 tableView:moveRowAtIndexPath:toIndexPath: 方法。

```
- (BOOL)tableView:(UITableView *)tableview canMoveRowAtIndexPath:(NSIndexPath *)indexPath
{
    return YES; 
}

- (void)tableView:(UITableView *)tableView moveRowAtIndexPath:(NSIndexPath *)fromIndexPath toIndexPath:(NSIndexPath *)toIndexPath
{
} 
```

(4) 因为您想要左侧的重新排序控件，所以我们必须删除通常在那里的 Delete 圆圈，而 tableView:editingStyleForRowAtIndexPath: 方法可以做到这一点。

```
- (UITableViewCellEditingStyle)tableView:(UITableView *)tableView editingStyleForRowAtIndexPath:(NSIndexPath *)indexPath
{
    return UITableViewCellEditingStyleNone;
} 
```

(5) 最后一步，魔法发生的地方——添加 tableView:willDisplayCell:forRowAtIndexPath: 方法，搜索单元格的子视图，将其缩小到私有 UITableViewCellReorderControl，最后覆盖它。

```
- (void) tableView:(UITableView *)tableView willDisplayCell:(UITableViewCell *)cell forRowAtIndexPath:(NSIndexPath *)indexPath
{
    for(UIView* view in cell.subviews)
    {
        if([[[view class] description] isEqualToString:@"UITableViewCellReorderControl"])
        {
            // Creates a new subview the size of the entire cell
            UIView *movedReorderControl = [[UIView alloc] initWithFrame:CGRectMake(0, 0, CGRectGetMaxX(view.frame), CGRectGetMaxY(view.frame))];
            // Adds the reorder control view to our new subview
            [movedReorderControl addSubview:view];
            // Adds our new subview to the cell
            [cell addSubview:movedReorderControl];
            // CGStuff to move it to the left
            CGSize moveLeft = CGSizeMake(movedReorderControl.frame.size.width - view.frame.size.width, movedReorderControl.frame.size.height - view.frame.size.height);
            CGAffineTransform transform = CGAffineTransformIdentity;
            transform = CGAffineTransformTranslate(transform, -moveLeft.width, -moveLeft.height);
            // Performs the transform
            [movedReorderControl setTransform:transform];
        }
    }
} 
```

我花了将近十个小时试图找出一个解决方案，什么时候配件我做不到。我首先需要更多的经验和知识。简单地对公开按钮上的重新排序控件做同样的事情是行不通的。所以我希望这暂时有效；如果我将来弄清楚，我一定会更新它。

> 嗨 Hoang Van Ha，这是我的第一个答案，我一个月前才开始学习 Objective-C，所以我还是个菜鸟。
> 
> 我一直在尝试对我的应用程序做同样的事情，并且一直在寻找如何做到这一点。在这方面，Apple 的文档并没有太大帮助。当人们只是链接到文档时，我发现它非常令人沮丧。我想对他们大喊大叫。希望我的回答对你有所帮助。
> 
> 对[b2Cloud 赞不绝口](http://b2cloud.com.au/about)，因为我使用了[本文](http://b2cloud.com.au/how-to-guides/reordering-a-uitableviewcell-from-any-touch-point)中他们的一些代码并将其改编为我的答案。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2014-01-22T10:46:22.063

与其寻找**非公共 API 并且将来可能会更改**`UITableViewCellReorderControl`，我建议使用over the并实现您自己的重新排序逻辑。**`UILongPressGestureRecognizer``UITableView`**

 **我解决了一般情况（响应长按单元格的任何部分）中[`HPReorderTableView`](https://github.com/hpique/HPReorderTableView)，UITableView 的直接替换。它可以很容易地修改以响应对单元格特定部分的触摸，例如通过实现`gestureRecognizer:shouldReceiveTouch:`委托`reorderGestureRecognizer`。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2017-05-30T05:50:41.703

现在有一个更简单的 iOS 9 及更高版本的解决方案

```
tableView.semanticContentAttribute = .forceRightToLeft 
```

* * *

**编辑**：

正如[Roland](https://stackoverflow.com/users/793916/roland)提到的，您应该注意到“如果您通过`leading`and`trailing`锚点而不是`left`and来对齐单元格的子视图`right`，则此设置将翻转所有内容。”

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-12-17T07:56:06.333

Luke Dubert，对 iOS 7 有很酷的答案，应该稍微改一下：

```
UIView *cellSubview = cell.subviews[0];
    for(UIView* view in cellSubview.subviews)
    {
        if([[[view class] description] isEqualToString:@"UITableViewCellReorderControl"])
        { 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2019-04-09T02:56:11.747

我使用 swift 4.2 在 iOS 12 上进行了测试，而不是使用`view.self.description == "UITableViewCellReorderControl"`，使用`view.self.description.contains("UITableViewCellReorderControl")`

```
func tableView(_ tableView: UITableView, willDisplay cell: UITableViewCell, forRowAt indexPath: IndexPath) {
    for view in cell.subviews {
        if view.self.description.contains("UITableViewCellReorderControl") {
            let movedReorderControl = UIView(frame: CGRect(x: 0, y: 0, width: view.frame.maxX, height: view.frame.maxY))
            movedReorderControl.addSubview(view)
            cell.addSubview(movedReorderControl)
            let moveLeft = CGSize(width: movedReorderControl.frame.size.width - view.frame.size.width, height: movedReorderControl.frame.size.height - view.frame.size.height)
            var transform: CGAffineTransform = .identity
            transform = transform.translatedBy(x: -moveLeft.width, y: -moveLeft.height)
            movedReorderControl.transform = transform
        }
    }
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-12-06T19:56:38.340

受卢克解决方案的启发，我找到了一种可靠且直接的方法来实现这一点：

```
@implementation CustomTableViewCell

-(void) layoutSubviews {
    [super layoutSubviews];

    // set the frames of the other subviews here if necessary, for example: 
    // self.textLabel.frame = CGRectMake(80, 0, self.textLabel.frame.size.width, self.textLabel.frame.size.height);

    for (UIView* view in self.subviews) {
        if ([[[view class] description] containsString:@"UITableViewCellReorderControl"]) {
            [view setFrame:CGRectMake(20, 0, view.frame.size.width, view.frame.size.height)];
        }
    }
}

@end 
```

只需创建一个自定义 UITableViewCell，覆盖其子视图并修改每个视图的位置，即可在所有已知场景中正常工作。

在 willDisplayCellAtIndexPath 下执行 UITableViewReorderControl 自定义不能 100% 工作，第一个重新排序按钮偶尔不会正确定位。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-10-21T09:49:24.167

这个解决方案在 iOS7 中对我不起作用，所以我为两者创建了一个版本，我希望它有用：

```
- (void)moveReorderControl:(UITableViewCell *)cell subviewCell:(UIView *)subviewCell
{
    if([[[subviewCell class] description] isEqualToString:@"UITableViewCellReorderControl"]) {
    static int TRANSLATION_REORDER_CONTROL_Y = -20;

        //Code to move the reorder control, you change change it for your code, this works for me
        UIView* resizedGripView = [[UIView alloc] initWithFrame:CGRectMake(0, 0,    CGRectGetMaxX(subviewCell.frame), CGRectGetMaxY(subviewCell.frame))];
        [resizedGripView addSubview:subviewCell];
        [cell addSubview:resizedGripView];

        //  Original transform
        const CGAffineTransform transform = CGAffineTransformMakeTranslation(subviewCell.frame.size.width - cell.frame.size.width, TRANSLATION_REORDER_CONTROL_Y);
        //  Move custom view so the grip's top left aligns with the cell's top left

        [resizedGripView setTransform:transform];
   }
}

//This method is due to the move cells icons is on right by default, we need to move it.
- (void) tableView:(UITableView *)tableView willDisplayCell:(UITableViewCell *)cell forRowAtIndexPath:(NSIndexPath *)indexPath
{
    if (tableView.tag == MEETING_BLOCK_TABLE_TAG) {
        for(UIView* subviewCell in cell.subviews)
        {
            if ([ROCFunctions isIOS7]) {
                if([[[subviewCell class] description] isEqualToString:@"UITableViewCellScrollView"]) {
                    for(UIView* subSubviewCell in subviewCell.subviews) {
                        [self moveReorderControl:cell subviewCell:subSubviewCell];
                    }
                }
            }
            else{
                [self moveReorderControl:cell subviewCell:subviewCell];
            }
        }
    }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-11-13T06:32:07.083

谢谢上面的所有人。这是我的解决方案。已在 iOS7 和 iOS9 上测试过

```
@implementation StoryPreviewCell
-(void)layoutSubviews{
    [super layoutSubviews];

    //subviews contains first level and second level views. 
    NSMutableArray *subviews = [NSMutableArray array];
    [subviews addObjectsFromArray:self.subviews];
    for (NSInteger i=0; i<self.subviews.count; i++) {
        UIView *firstLevelView = self.subviews[i];
        if(firstLevelView.subviews.count) [subviews addObjectsFromArray:firstLevelView.subviews];
    }

    for(UIView* view in subviews) {
        if([[[view class] description] isEqualToString:@"UITableViewCellReorderControl"]) {
            UIView *reorderControl = view;
            CGFloat leftMoveDistance = 100;//can customize
            CGAffineTransform transform = CGAffineTransformTranslate(CGAffineTransformIdentity, -leftMoveDistance, 0);
            reorderControl.transform = transform;
        }
    }
}
@end 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-02-02T18:31:25.660

对于那些使用 Xamarin 的人，这是我基于 @luke-dubert 答案的解决方案，但在重用时要注意删除额外添加的视图：

在 TableViewSource 上：

```
public override void WillDisplay(UITableView tableView, UITableViewCell cell, NSIndexPath indexPath)
{
    (cell as GraphBarLineCell)?.SetEditionMode(tableView.Editing);
} 
```

在单元格上：

```
private UIView _reorderControlContainer;

public void SetEditionMode(bool editing)
    {
        _title.Frame = editing ? TitleFrameForEditing : TitleFrame;

        if (editing)
        {
            var reorderControl = Subviews.FirstOrDefault(x => x.Class.Name.Equals("UITableViewCellReorderControl"));

            if (reorderControl != null)
            {
                _reorderControlContainer?.RemoveFromSuperview();

                // Creates a new subview the size of the entire cell
                _reorderControlContainer = new UIView(new CGRect(0, 0, reorderControl.Frame.GetMaxX(), reorderControl.Frame.GetMaxY()));

                // Adds the reorder control view to our new subview
                _reorderControlContainer.AddSubview(reorderControl);

                // Adds our new subview to the cell
                AddSubview(_reorderControlContainer);

                // CGStuff to move it to the left
                var moveLeft = new CGSize(_reorderControlContainer.Frame.Size.Width - reorderControl.Frame.Size.Width,
                    _reorderControlContainer.Frame.Size.Height - reorderControl.Frame.Size.Height);

                var transform = CGAffineTransform.MakeIdentity();
                transform = CGAffineTransform.Translate(transform, -moveLeft.Width, -moveLeft.Height);
                _reorderControlContainer.Transform = transform;

                // Align the icon with the title
                var icon = reorderControl.Subviews[0];
                icon.Frame = new CGRect(10, 25, icon.Frame.Width, icon.Frame.Height);
            }
        }
    } 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2014-01-21T13:43:47.367

我找到了一个更简单的解决方案，它不需要对任何东西进行绝对手动定位，甚至可以使用从/到编辑模式的动画过渡。应该适用于 iOS6 和 7。

在某处的 UIView 上定义这个类别：

```
@interface UIView (ClassSearch)

- (instancetype)subviewOfClassMatching:(NSString*)partialName;

@end

@implementation UIView (ClassSearch)

-(instancetype)subviewOfClassMatching:(NSString *)partialName
{
    if ([[[self class] description] rangeOfString:partialName options:NSCaseInsensitiveSearch].location != NSNotFound) {
        return self;
    }

    for (UIView* v in self.subviews) {
        id match = [v subviewOfClassMatching:partialName];
        if (match) {
            return match;
        }
    }

    return nil;
}

@end 
```

然后，在您的 UITableViewCell 子类中，像这样覆盖 willTransitionToState：

```
-(void)willTransitionToState:(UITableViewCellStateMask)state
{
    [super willTransitionToState:state];

    if (state == UITableViewCellStateShowingEditControlMask) {
        UIView* reorderControl = [self subviewOfClassMatching:@"ReorderControl"];
        UIView* reorderContainer = [[UIView alloc] initWithFrame:self.bounds];
        CGAffineTransform t = CGAffineTransformMakeScale(-1, 1);
        reorderContainer.transform = t;
        [self addSubview:reorderContainer];
        [reorderContainer addSubview:reorderControl];
    }
} 
```

请注意，单元格需要配置为仅显示重新排序控件，否则需要完成更多工作。**

# html - 在不使用 JavaScript 更改 iframe 内容时移动到页面顶部

> ID：11141950
> 
> 赞同：1
> 
> 时间：2012-06-21T15:50:59.260
> 
> 标签：html, iframe

我检查了以下问题： [在 iframe 中单击子页面时，如何将父页面滚动到顶部？](https://stackoverflow.com/questions/3064873/how-do-i-scroll-parent-page-to-top-when-child-page-is-click-within-iframe) 并 [在 iframe 中加载远程内容时滚动父页面](https://stackoverflow.com/questions/5411848/scrolling-parent-page-when-remote-content-loads-in-iframe) 但我想尽可能避免使用 javascript。我有一个 iframe

```
<iframe name="MapFrame" id="MapFrameID" src="http://maps.google.ch/maps?f=q&..."></iframe> 
```

还有一些指向它的链接：

```
<a href="http://maps.google.com/maps?q=St%C3%A4mpflistr.+28,+3052+Zollikofen..." target="MapFrame">mostra sulla mappa</a> 
```

我的问题是一些链接在页面下方很远，当它们被“点击”时，iframe 不可见或仅部分可见。

如何在不使用 javascript 的情况下强制页面滚动到顶部？

我已经在页面顶部有一个 id=Fascione 的 div，我在页脚中使用它来“转到顶部”

```
<a href="#Fascione"><img class="NoBackground" alt="Go to top" src="images/common/go_up_black.png" width="30" height="30"></a> 
```

我想重复使用它；这可能吗（再次没有javascript）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T17:39:27.843

您可能想尝试这段代码：

`<a href="#Fascione" onclick="parent.scrollTo(0,0);">Go to the top</a>`

这是一种将页面滚动到顶部的简单方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T16:02:51.723

我认为您将不得不使用Javascript，这并不难。以下是要更改的内容：

```
<a href="#Fascione" onclick="var map = document.getElementById('MapFrameID'); map.src = 'http://maps.gooogle.com/maps...'">mostra sulla mappa</a> 
```

href="#Fascione" 会将页面推到顶部，更改 iframe 上的 SRC 会自动触发更新。

# excel - 如何将科学数字转换为一般数字

> ID：11141951
> 
> 赞同：0
> 
> 时间：2012-06-21T15:50:59.323
> 
> 标签：excel, vba

我有一个带有 18 位数字列的模板，当输入最后一个数字将转换为零时。所以我将该列修改为文本列。我需要将 xls 转换为 csv，在转换时我正在验证列，如果数字长度小于 18，我将零填充到该数字。将其转换为 csv 后，数字将被修改为科学数字。有没有可能不将数字转换为科学数字。它在文本列中保持不变。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T21:34:17.823

我打算将此作为评论添加到上面的评论中，但该选项对我来说没有出现，所以我将其作为答案。

在第一点上，Excel 只允许您使用 15 个有效数字，这就是为什么您最初得到零的原因。所以是的，您必须将列格式化为文本以处理 18 位输入。不过，正如 Tim Williams 指出的那样，虽然格式决定了您保存的文件的内容（这就是您在写字板中打开文件时看到正确格式的原因），但在 Excel 中重新打开它时无济于事。

问题是 Excel 非常热衷于“帮助”您，以至于在大多数情况下，当您打开 .csv 文件时它不会显示文本导入向导。相反，它将直接打开文件，对内容格式做出最佳猜测，在您的情况下，尽管存在前导零，但它会错误地猜测。

解决此问题的一种方法是将文件另存为 .csv，但确保它具有不同的扩展名。我使用.cma。当您保存文件时，您将其另存为“MyFile.cma”，但您必须在“文件名”对话框中将该名称用双引号引起来，否则 Excel 会将其另存为 MyFile.cma.csv

当您打开 .cma（或类似的其他无法识别的扩展名）时，Excel 将显示文本导入向导，它允许您（如 Tim 建议的那样）指定您希望在打开文件时将列作为文本。这样它就不会转换为数字，更具体地说是科学数字。

另一个选项是使用 VBA 中的 OpenText 方法重新打开文件：

```
 Workbooks.OpenText FileName:= _
    "C:\Users\YourName\Documents\Data\YourFile.cma", _
    Origin:=xlMSDOS, StartRow:=1, DataType:=xlDelimited, 
    TextQualifier:=xlDoubleQuote, _
    ConsecutiveDelimiter:=False, Tab:=True, Semicolon:=False, Comma:=True, _
    Space:=False, Other:=False, 
    FieldInfo:=Array(Array(1, 2)), TrailingMinusNumbers:=True 
```

这取决于您想要或需要投入多少精力来实现自动化。

# variables - Powershell 空值表达式

> ID：11141952
> 
> 赞同：2
> 
> 时间：2012-06-21T15:51:00.210
> 
> 标签：variables, powershell

我有下面的脚本，我一生都无法理解为什么它给了我“你不能在空值表达式上调用方法”。它在两个地方出错。

```
Which computer?: NFDW2206
What is the AssetID?: 00000007
Checking NFDW2206 to see if the Registry Key exists..
You cannot call a method on a null-valued expression.
At \\NFDNT007\Dept\Corporate\IT\Network Services\Documentation\Asset Tag.ps1:11 char:33
+         $regassetid = $regKey.GetValue <<<< ("AssetID")
    + CategoryInfo          : InvalidOperation: (GetValue:String) [], RuntimeException
    + FullyQualifiedErrorId : InvokeMethodOnNull

The Key does not exist. Writing AssetID.....
You cannot call a method on a null-valued expression.
At \\NFDNT007\Dept\Corporate\IT\Network Services\Documentation\Asset Tag.ps1:18 char:20
+             $regKey.Setvalue <<<< ('AssetID', $AssetID, 'String')
    + CategoryInfo          : InvalidOperation: (Setvalue:String) [], RuntimeException
    + FullyQualifiedErrorId : InvokeMethodOnNull 
```

代码如下

```
$Computer = Read-Host "Which computer?"
$AssetID = Read-Host "What is the AssetID?"

if (($Computer -eq "") -or ($AssetID -eq "")) {
    Write-Host "Error: A blank parameter was detected" -BackgroundColor Black -ForegroundColor Yellow
} else {
    if (Test-Connection -comp $Computer -count 1 -quiet) {
        Write-Host "Checking $Computer to see if the Registry Key exists.."
        $reg = [Microsoft.Win32.RegistryKey]::OpenRemoteBaseKey("LocalMachine", $Computer)
        $regKey = $reg.OpenSubKey("SOFTWARE\Multek Northfield")
        $regassetid = $regKey.GetValue("AssetID")

        if ($regassetid -eq $null) {

            Write-Host "The Key does not exist. Writing AssetID....."
            $reg = [Microsoft.Win32.RegistryKey]::OpenRemoteBaseKey("LocalMachine", $Computer)
            $regKey = $reg.OpenSubKey("SOFTWARE\Multek Northfield",$True) ## $True = Write
            $regKey.Setvalue('AssetID', $AssetID, 'String')

        } else {

            $OverWrite = Read-Host "AssetID exists do you wish to continue?"

            if (($OverWrite -eq "y") -or ($OverWrite -eq "yes")) {
                $reg = [Microsoft.Win32.RegistryKey]::OpenRemoteBaseKey('LocalMachine', $Computer)
                $regKey = $reg.OpenSubKey("SOFTWARE\Multek Northfield",$True) ## $True = Write
                $regKey.Setvalue("AssetID", $AssetID, "String")
            }

        }
    } else {
        Write-Host "Error: $computer is offline..." -BackgroundColor Black -ForegroundColor Yellow
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T19:35:35.360

文档说，如果操作失败，OpenSubKey 将返回 null。很可能是找不到钥匙。远程系统是 64 位操作系统吗？如果是这样，则可能是您遇到了注册表虚拟化问题。可能需要往下看`SOFTWARE\WOW6432Node\Multek Northfield`

# c++ - 一个写和一个读操作：使用一个 wrlock 两个 VS 一个 rdlock 读操作和一个 wrlock 写操作？

> ID：11141953
> 
> 赞同：0
> 
> 时间：2012-06-21T15:51:07.340
> 
> 标签：c++, pthreads

**A 或 B 哪个更好或更快？**

```
std::deque<Myclass> queue;
... // do something
std::size_t size = 0;
... // create n threads, one push queue and others pop queue.

// a thread do below
#ifdef A
pthread_rwlock_wrlock(&rwlock);
queue.push_front(myobj);
size = queue.size();
pthread_rwlock_unlock(&rwlock);
#endif

#ifdef B
pthread_rwlock_wrlock(&rwlock);
queue.push_front(myobj); 
pthread_rwlock_unlock(&rwlock);
// if there is some operation,
// I think this B is better,
// because I should get the newest size.
pthread_rwlock_rdlock(&rwlock);
size = queue.size();
pthread_rwlock_unlock(&rwlock);
#endif

// other threads do below
pthread_rwlock_wrlock(&rwlock);
queue.pop_back(); 
pthread_rwlock_unlock(&rwlock); 
```

**那是我的不理解。**

**任何信息或建议对我都有很大的帮助！**

***为我糟糕的英语道歉！***

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T15:57:10.960

您*的 A*版本更快，因为您只需要获取一次锁（无论如何您都需要获取一次写锁）。此外，返回的大小将是*最新*的（在*push*时），因为没有其他线程可以同时访问队列。

如果你这样做*B ，你可能会得到一个不同的**大小*答案（如你所指出的），但是，一旦你释放锁（在任何一种情况下），`size`变量总是可以保持陈旧的值（一个线程可能在你更新队列时）想要*使用*`size`)中的值

此外，读者应该查询队列的大小（在受保护的部分内）以避免队列为空时出现异常

# bash - Bash、grep、sed...：用多行文件内容替换术语

> ID：11141955
> 
> 赞同：0
> 
> 时间：2012-06-21T15:51:17.277
> 
> 标签：bash, sed, grep

我有一个包含以下内容的文件 test.xml：

```
<body>
<content>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed non risus. Suspendisse lectus tortor, dignissim sit amet, adipiscing nec, ultricies sed, dolor. Cras elementum ultrices diam.</p><p>Maecenas ligula massa, varius a, semper congue, euismod non, mi. Proin porttitor, orci nec nonummy molestie, enim est eleifend mi,..</p><p>
<MEDIAREF localid="HTM37c2ae34-b92c-11e1-86ab-e6b6e8e434a7-0"/>
</p><p>Duis arcu massa, scelerisque vitae, consequat in, pretium a, enim. Pellentesque congue. Ut in risus volutpat libero pharetra tempor. Cras vestibulum bibendum augue</p><p>
<MEDIAREF localid="HTM37c2ae34-b92c-11e1-86ab-e6b6e8e434a7-1"/>
</p><p>Praesent egestas leo in pede. Praesent blandit odio eu enim.
</p>
</content>
</body>
...
<ZONEMEDIAS>
<MEDIA localid="HTM37c2ae34-b92c-11e1-86ab-e6b6e8e434a7-0">
<MEDIAPROPRIETES>
<PROPRIETE value="HTM" name="type"/>
</MEDIAPROPRIETES>
<CODEMEDIA>&lt;object width="493" height="370"&gt;&lt;param name="movie" value="http://www.youtube.com/v/Rxxxxxfr_FR&amp;amp;rel=0"&gt;&lt;/param&gt;&lt;param name="allowFullScreen" value="true"&gt;&lt;/param&gt;&lt;param name="allowscriptaccess" value="always"&gt;&lt;/param&gt;&lt;embed src="http://www.youtube.com/v/RxxxxxfrR&amp;amp;rel=0" type="application/x-shockwave-flash" width="493" height="370" allowscriptaccess="always" allowfullscreen="true"&gt;&lt;/embed&gt;&lt;/object&gt;
</CODEMEDIA>
</MEDIA><MEDIA localid="HTM37c2ae34-b92c-11e1-86ab-e6b6e8e434a7-1">
<MEDIAPROPRIETES>
<PROPRIETE value="HTM" name="type"/>
</MEDIAPROPRIETES>
<CODEMEDIA>&lt;blockquote class="twitter-tweet" lang="fr"&gt;&lt;p&gt;second texte to replace &lt;a href="https://twitter.com/xxxx" data-datetime="2012-06-15T01:12:03+00:00"&gt;Juin 15, 2012&lt;/a&gt;&lt;/blockquote&gt;
&lt;script src="//platform.twitter.com/widgets.js" charset="utf-8"&gt;&lt;/script&gt;
</CODEMEDIA>
</MEDIA>
</ZONEMEDIAS> 
```

我希望更换

```
<MEDIAREF localid="HTM37c2ae34-b92c-11e1-86ab-e6b6e8e434a7-0"/> 
```

经过

```
&lt;object width="493" height="370"&gt;&lt;param name="movie" value="http://www.youtube.com/v/Rxxxxxfr_FR&amp;amp;rel=0"&gt;&lt;/param&gt;&lt;param name="allowFullScreen" value="true"&gt;&lt;/param&gt;&lt;param name="allowscriptaccess" value="always"&gt;&lt;/param&gt;&lt;embed src="http://www.youtube.com/v/RxxxxxfrR&amp;amp;rel=0" type="application/x-shockwave-flash" width="493" height="370" allowscriptaccess="always" allowfullscreen="true"&gt;&lt;/embed&gt;&lt;/object&gt; 
```

并对 :: 做同样的事情

请问有什么方法可以在bash中实现这一点吗？

如果localid，我尝试了类似的方法来检索值

```
grep "<MEDIAREF localid=.*\".>" test.xml | sed -e "s/^.*<MEDIAREF localid=/<MEDIAREF localid=/"  | cut -f2 -d"\"" | cut -f1 -d"\"" 
```

但我不知道如何更换之后

有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T16:12:24.173

在 bash

```
while read line;do
  if [[ $line =~ 'MEDIAREF localid="HTM37c2ae34-b92c-11e1-86ab-e6b6e8e434a7-0"' ]];then
    echo '&lt;object width="493" height="370"&gt;&lt;param name="movie" value="http://www.youtube.com/v/Rxxxxxfr_FR&amp;amp;rel=0"&gt;&lt;/param&gt;&lt;param name="allowFullScreen" value="true"&gt;&lt;/param&gt;&lt;param name="allowscriptaccess" value="always"&gt;&lt;/param&gt;&lt;embed src="http://www.youtube.com/v/RxxxxxfrR&amp;amp;rel=0" type="application/x-shockwave-flash" width="493" height="370" allowscriptaccess="always" allowfullscreen="true"&gt;&lt;/embed&gt;&lt;/object&gt;';
  else
    echo "$line";
  fi;
done  < test.xml > new-test.xml 
```

编辑，在您发表评论后，我更了解您想要做什么，bash 不是最好的解决方案，可能不安全，perl 更好，但它适用于您的示例。这是 bash 的解决方案：

```
#!/bin/bash
# First loop to set variables ${!HTM*}
localid=""         # localid property
codemedia=0        # flag to indicate between CODEMEDIA tags
cm_content=""      # CODEMEDIA content
while IFS=\< read -d \> content tag;do
    if((codemedia==1));then
        cm_content="$cm_content$content"
    fi
    # set the flag or localid property
    if [[ "$tag" =~ ^CODEMEDIA.* ]];then
        codemedia=1
    elif [[ "$tag" =~ ^/CODEMEDIA ]];then
        codemedia=0
        eval "$localid=\"${cm_content//\"/\\\"}\""
        cm_content=""
    elif [[ "$tag" =~ ^MEDIA\  ]];then
        lf=0
        while read -d \" lprop;do
            if((lf==1));then
                localid=${lprop//-/_}
                break
            fi
            if [[ "$lprop" =~ localid=$ ]];then
                lf=1
            fi
        done <<<$tag
    fi
done < test.xml
echo ${!HTM*}
# Second loop to replace MEDIAREF tag
{ while IFS=\< read -d \> content tag;do
    if [[ "$tag" =~ ^MEDIAREF.*/$ ]];then
        lf=0
        while read -d \" lprop;do
            if((lf==1));then
                localid=${lprop//-/_}
                break
            fi
            if [[ "$lprop" =~ localid=$ ]];then
                lf=1
            fi
        done <<<$tag
        echo -n "$content${!localid}"
    else
        echo -n "$content<$tag>"
    fi
done;echo;} < test.xml > new-test.xml 
```

perl 中的其他解决方案：

```
#!/usr/bin/perl
use strict;
use warnings;

my $inputFile=$ARGV[0]||"test.xml";
my %hash;
open(INPUT,"<$inputFile") or die "cannot open $inputFile for readding";
# reads whole file in $_ (see perlvar)
# other solution if file is too long is to set $/="</MEDIA>"; for example and to change the while loop
$_=join("",<INPUT>);
# for gms flags (see perlre)
while(m{<MEDIA localid="(.*?)".*?<CODEMEDIA>(.*?)</CODEMEDIA>.*?</MEDIA>}gms){
    $hash{$1}=$2;
}
close(INPUT);
open(INPUT,"<$inputFile") or die "cannot open $inputFile for readding";
# again reads whole file
$_=join("",<INPUT>);
s{<MEDIAREF localid="(.*?)".*?/>}{$hash{$1}}gms;
close(INPUT);
# print on STDOUT
# other solution open(OUTPUT,">filename"); print OUTPUT $_; close(OUTPUT);
print; 
```

# java - 如何在程序运行时更新 GUI？

> ID：11141957
> 
> 赞同：0
> 
> 时间：2012-06-21T15:51:23.363
> 
> 标签：java, android, multithreading, user-interface

我试图在每次循环迭代后更新 GUI。我已经阅读了类似问题的其他答案，但仍然无法正常工作。在下面的代码中，我调用了模拟，它通过循环调用步骤运行，该步骤根据需要计算和更改 GUI 组件，但 GUI 直到循环完全结束后才会更新。如何在每次迭代后更新它？

```
public void step(View v) {
    for (int i = 0; i < cells.length; i++)
        update(i);

    count++;

    Toast.makeText(getApplicationContext(), count + "", 1000).show();
}

public void simulate(View v) {
    while (!pause) {
        step(v);

        try {
            Thread.sleep(10);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    }
}

public void update(final int i)
{
            //This goes through each button and counts the neighbors (this is the 
            //intensive work
    int neighbors = getNeighbors(i);

            //With the information provided from the getNeighbors the following if
            //statement updates the GUI using the dead and alive method calls.
    if (isAlive(cells[i])) {
        if (neighbors < 2)
            dead(cells[i]);
        else if (neighbors > 3)
            dead(cells[i]);
    } 
    else {
        if (neighbors == 3)
            alive(cells[i]);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T16:45:36.250

问题是您正在应用程序的主线程中运行该代码。GUI 在同一线程上运行，并且在您阻止它时无法更新。

您必须在不同的任务中进行计算，然后向主进程发送消息以更新 GUI。阅读此内容以获取背景信息（如果您不熟悉此内容，请先阅读背景信息）：

[http://developer.android.com/guide/topics/fundamentals/processes-and-threads.html](http://developer.android.com/guide/topics/fundamentals/processes-and-threads.html)

最简单的方法是使用 AsyncTask，然后使用“onProgressUpdate()”进行 GUI 更新。尽管 AsyncTask 已经使事情变得非常简单，但您必须注意，底层活动可能会在 AsyncTask 运行时被破坏。文档中并没有很好地涵盖这一点，但我发现使用 Fragments 可能是处理它的最佳方式。阅读这篇文章以获得非常好的描述：

[http://blogactivity.wordpress.com/2011/09/01/proper-use-of-asynctask/](http://blogactivity.wordpress.com/2011/09/01/proper-use-of-asynctask/)

备注：另请阅读 AsyncTask 文档。由于论坛的限制，我无法发布链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T15:54:43.610

我认为您必须为此使用 AsyncTask 。

尝试阅读文档..

[http://developer.android.com/reference/android/os/AsyncTask.html](http://developer.android.com/reference/android/os/AsyncTask.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T17:23:09.513

我们总是被告知，**UI 工作应该在 UI-Thread 上，Non-UI 工作在 Non-UI Thread 上，但是从 HoneyComb android 版本开始它变成了一个 LAW**。`When we start an` `application in Android, it start on the Dedicated UI thread, creating any other thread` `will drop you off the UI thread, you normally do this to do some process intensive work,` `but when you want to display the output of the non-ui thread process, on the ui thread` `then you will experience lagging, exception etc...`

在我看来，这可以通过`two`多种方式完成......

1.  使用**Handler** ... `Handler stores the reference of the thread on which it was` `created, Initialize Handler inside the` **onCreate()** `method, and then use` **handler.post()** `to update the UI thread.`

2.  使用android提供的**AsyncTask<>**，同步UI和Non-UI线程

    AsyncTask<> 中的方法

    `doInBackground(String...) // Work on the Non-UI thread`

    `postExecute(String result) // Getting the Output from the Non-Ui thread and`

    `Putting the Output back on the UI Thread`

# excel - 在电子表格中计算每周和每月总计

> ID：11141966
> 
> 赞同：4
> 
> 时间：2012-06-21T15:51:56.763
> 
> 标签：excel, xls, google-sheets

如何根据每日值计算每周总和（第 7 行打印的最后 7 行的总和），每月相同的问题（基于每周或每天）。我尝试了一些公式，但都失败了。

![在此处输入图像描述](../Images/16a2a5b420fa1b80c7b8c4d8065e84c6.png)

（第一列是日期列，不在图像中）

PS对“过于本地化”和“没有建设性”感到抱歉，我只是不知道如何以不同的方式提出这个问题

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-21T16:01:18.677

对于周列，您可以添加一个公式，例如`=IF(WEEKDAY(A8)=7,sum(B2:B8),"")`（将周的总和放在星期日。

对于月份列：`=IF(MONTH(A2)<>MONTH(A2+1),SUM(B$2:B2)-SUMIF(A$2:A2,"<"&DATE(YEAR(A2),MONTH(A2),1),B$2:B2),"")`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T16:11:15.817

对于每周专栏

```
=IF(IFERROR(WEEKNUM(A2)=WEEKNUM(A1), FALSE), "",SUM(B2:B8)) 
```

每月专栏

```
=IF(IFERROR(MONTH(A2)=MONTH(A1), FALSE), "",SUMIF(A2:A33, "<"&DATE(YEAR(A2),MONTH(A2)+1,1), B2:B33)) 
```

这些应该可以在任何地方使用。周和月的总和将在周/月的第一天列出（您的工作表似乎有什么）

注意：sumif 中的范围为 31 天。我意识到每个月都不是 31 天。但是它们最多 31 天，并且只有在月份正确的情况下才会包括每一天，因此它也适用于 28,29 和 30 天的月份。这意味着该公式将适用于所有月份而无需修改。

# sharepoint - sharepoint 2010 的自定义迷你日历

> ID：11141974
> 
> 赞同：4
> 
> 时间：2012-06-21T15:52:44.147
> 
> 标签：sharepoint, sharepoint-2010

我需要为 SP 2010 设置迷你日历。我找到[了这篇](http://erikswenson.blogspot.com/2009/10/how-to-create-really-small-sharepoint.html?utm_source=feedburner&utm_medium=feed&utm_campaign=Feed%3a%20SharepointBrandingDesign%20%28SharePoint%20Branding%20&%20Design%29)文章，但它不适用于 SP2010。也许我错过了什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T19:19:59.083

我为 SharePoint 2010 迷你日历使用了开源 Web 部件。看看这是否适合你。网址： http: [//minicalendarwebpart.codeplex.com/](http://minicalendarwebpart.codeplex.com/)

# ruby - 如何在 Ruby 中重载构造函数？

> ID：11141980
> 
> 赞同：3
> 
> 时间：2012-06-21T15:53:08.883
> 
> 标签：ruby, constructor, overloading, ruby-1.9.2, overriding

> **可能重复：**
> [在 Ruby 中有没有办法重载初始化构造函数？](https://stackoverflow.com/questions/3958735/in-ruby-is-there-a-way-to-overload-the-initialize-constructor)

`BigDecimal`不像初始值那样采用浮点数，所以我正在编写一个构造函数来处理它。它似乎忽略了初始化方法并调用了默认构造函数。

它抛出`TypeError can't convert Float into String (TypeError)`

该方法`format`确实有效。

文件 BigDecimal.rb：

```
require 'bigdecimal'

class BigDecimal

    def initialize
        if self.class == Float
            super self.to_s
        end
    end

    def format
        sprintf("%.2f", self)
    end

end 
```

然后，在文件 test.rb 中：

```
require 'BigDecimal' # => true
bd = BigDecimal.new('54.4477') # works
puts bd.format # 54.44
bd2 = BigDecimal.new(34.343) # TypeError: can't convert Float into String (TypeError) 
```

红宝石 1.9.2

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-21T17:03:04.620

您的代码存在问题：

1.  您使用猴子补丁而不是继承，因此在您的`initialize`方法中，`super`将调用的初始化方法`Object`，它是 BigDecimal 的超类。要调用默认构造函数，您必须使用其他方法，如下所示。

2.  您没有为该`initialize`方法输入参数。

3.  BigDecimal 将浮点数作为构造函数参数

所以，

1.  您可以直接使用默认构造函数并将浮点数传递为：

    ```
    BigDecimal.new(34.343, 5) # 5 is the precision 
    ```

2.  您可以通过这种方式覆盖构造函数：

注意：我们通常使用别名`initialize`方法。但是在这种情况下，这似乎不起作用（由于某些未知原因，`initialize`不会被调用）......所以我们必须给`new`更基本的方法起别名。

```
 require 'bigdecimal'

    class BigDecimal

        class << self
          alias_method :__new__, :new  #alias the original constructor so we can call later
          def new(*args)
              if args.length == 1 && args[0].is_a?(Float)
                  __new__(args[0].to_s)
              else
                  __new__(*args)
              end
          end
        end

        def format
            sprintf("%.2f", self)
        end

    end

    BigDecimal.new(12.334)
    #<BigDecimal:10a9a48,'0.12334E2',18(18)> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-21T15:58:37.897

> BigDecimal 不像初始值那样采用浮点数

你确定吗？

```
BigDecimal.new(2.4)
#=>ArgumentError: can't omit precision for a Rational. 
```

所以你必须给出一个精度作为第二个参数：

```
BigDecimal.new(2.4, 2)
#=> #<BigDecimal:7ff689b0f2e8,'0.24E1',18(36)> 
```

文档没有指出 1.9.2 和 1.9.3 之间的变化。

# mysql - SQL 查询左连接没有给出准确的结果

> ID：11141986
> 
> 赞同：0
> 
> 时间：2012-06-21T15:53:23.783
> 
> 标签：mysql, sql, phpmyadmin

我一直在尝试根据他们的角色 id 加入两个表（USERS 和 USERS_ROLES）我将左连接放在以下查询中

> users.id = users_roles.fk_user_id 但是 users_roles.fk_role_id coulmun 的输出不正确，并且在应该显示 users.id = users_roles.fk_user_id 的 id 的地方显示为 NULL，即 4（在大多数地方），因为 users.id = users_roles .fk_user_id users_roles.fk_role_id 的值 = 4

请让我知道我该如何解决这个问题，所以我的查询应该得到它们匹配的 id 的确切值，谢谢

```
SELECT users.id, users.v_first_name, users.v_last_name, user_facility.fk_facility_id,users.fk_tenant_id, marital_status.v_marital_status, 
            users.v_blood_type, NOW(),users_roles.fk_role_id
            FROM users
            LEFT JOIN (user_facility, marital_status, users_roles) ON
            users.id = user_facility.fk_user_id AND users.fk_marital_status_id=marital_status.id AND  users.id = users_roles.fk_user_id 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T16:02:59.123

`AND`在与`Left`或连接一起使用时使用运算符`Right`会产生不同的结果。你应该清楚你想要完成什么..[看到这个](http://techpint.com/programming/how-sql-joins-works)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T15:59:24.917

当它显示时，表示子句`NULL`中的所有表之间没有对应关系（关系） 。`JOIN`

如果您只想显示在所有表中都有关系的那些，请`INNER JOIN`改用。

```
SELECT u.id,
       u.v_first_name,
       u.v_last_name,
       uf.fk_facility_id,
       u.fk_tenant_id,
       ms.v_marital_status,
       u.v_blood_type,
       NOW(),
       ur.fk_role_id
FROM users u
INNER JOIN user_facility uf ON u.id = uf.fk_user_id
INNER JOIN marital_status ms ON u.fk_marital_status_id=ms.id
INNER JOIN users_roles ur ON u.id = ur.fk_user_id 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-21T16:16:13.487

好吧，这就是您首先隐式内连接 3 个表，然后仅当与所有 3 个内连接表相关的 3 个条件匹配时才将结果显式左连接到第 4 个表（即，当第 3 个条件为假时，剩下的两个表中的任何一个都没有加入任何内容）

我强烈建议**不要结合隐式和显式连接**，我个人一直使用显式连接：

如果您需要外部连接：

```
SELECT ...
FROM users
LEFT JOIN user_facility ON users.id = user_facility.fk_user_id
LEFT JOIN marital_status ON users.fk_marital_status_id=marital_status.id
LEFT JOIN users_roles ON users.id = users_roles.fk_user_id 
```

如果您需要内部连接：

```
SELECT ...
FROM users
JOIN user_facility ON users.id = user_facility.fk_user_id
JOIN marital_status ON users.fk_marital_status_id=marital_status.id
JOIN users_roles ON users.id = users_roles.fk_user_id 
```

或者，如果您出于某种晦涩的原因更喜欢隐式内部连接：

```
SELECT ...
FROM users,
     user_facility,
     marital_status,
     users_roles
WHERE users.id = user_facility.fk_user_id
  AND users.fk_marital_status_id=marital_status.id
  AND users.id = users_roles.fk_user_id 
```

（据我所知，隐式外连接在所有 RDBMS 中都被弃用了）

# oracle - oracle由多个父母连接

> ID：11141989
> 
> 赞同：1
> 
> 时间：2012-06-21T15:53:36.253
> 
> 标签：oracle, connect-by

我在使用 connect by 时遇到问题。

我有一个查询，通过它我检索了几列，包括这三个：

*   ID
*   父母ID
*   对象 ID

现在对于相同的`ID`and `parentID`，有多个关联的对象，例如

ID ParentID ObjectID
1 0 112
1 0 113
2 0 111
2 0 112
3 1 111
4 1 112

我正在尝试使用`connect by`，但无法在适当的层次结构中获得结果。我需要它如下所示的方式。采取`ID`-`parentID`组合，显示所有行，`ID-parentID`然后显示所有子代，`ID`即其`parentID`= `ID`

ID ParentID ObjectID
1 0 112
1 0 113
3 1 111
4 1 112
2 0 111
2 0 112

```
select ID,parent_id, object_id from table start with parent_id=0 
connect by prior id=parent_id order by id,parent_id 
```

上面的查询没有导致我需要的适当的层次结构。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T17:47:18.627

好吧，您的问题似乎是您使用的是非规范化表设计。如果给定`ID`始终具有相同的`ParentID`，则不应在所有这些行中单独指示该关系。

更好的设计是有一个显示父子关系的表，`ID`作为主键，第二个表显示`ID`to的映射`ObjectID`，我假设两个列一起构成主键。然后，您将对第一个表应用分层查询，并将该结果连接到另一个表以获取每一行的相关对象。

您可以使用当前的表结构来模拟它...

```
with parent_child as (select distinct id, parent_id from table),
     tree as (select id, parent_id from parent_child
               start with parent_id = 0
               connect by prior id = parent_id )
select id, table.parent_id, table.object_id
  from tree join table using (id) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T18:05:28.590

这是一个运行的脚本。不理想，但会工作 -

```
select * from (select distinct test.id,
                    parent_id,
                    object_id,
                    connect_by_root test.id root
      from test
     start with test.parent_id = 0
    connect by prior test.id = parent_id)
order by root,id 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-22T09:35:00.087

首先感谢所有试图帮助我的人。

最后我改变了我的方法，因为将层次结构 CONNECT BY 子句应用于具有多个连接的内部查询对我不起作用。

我采取了以下方法

1.  从第一个表（即具有 ID-ParentID 的表）中获取分层数据。使用 CONNECT BY 选择查询 table1。它将以正确的顺序给出 ID。加入检索到的 ID 列表。

2.  将上述 ID 作为选择查询 IN 子句中的逗号分隔字符串传递给具有 ID-ObjectID 的第二个表。

> select * from table2 where ID in (above Joined string of ID) order by instr('above Joined string of ID',ID);

`ORDER BY INSTR`做了魔术。它会给我按 IN 子句数据排序的结果，并且 IN 子句字符串是使用分层查询准备的。因此，它显然是按顺序排列的。

再次感谢大家的帮助！

注意：上述方法有一个约束：ID 在 IN 子句中作为逗号分隔的字符串传递。IN 子句中的字符数有限制。我猜1000个字符。没有把握。但正如我在第一张表的数据上确定的那样，它不会超过 1000 个字符的限制。因此我选择了上述方法。

# jquery-mobile - jquery无法绑定函数

> ID：11141994
> 
> 赞同：0
> 
> 时间：2012-06-21T15:53:48.103
> 
> 标签：jquery-mobile, jquery, jquery-on

我正在尝试将 onBlur 和 onFocus 处理程序附加到 SSN 输入字段。但是，我看到一个错误说对象没有方法'ON'。代码位于[http://jsfiddle.net/H4Q5f/](http://jsfiddle.net/H4Q5f/)

如您所见，我发表评论以找出细节，但到目前为止还没有运气。任何帮助表示赞赏。为方便起见，这里是代码：

HTML：

```
<!doctype html>
<html lang="en">

<head>
<meta charset="utf-8" />
<title>Test Page</title> 
<meta name="viewport" content="width=device-width, initial-scale=1"> 
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black" />

<link rel="stylesheet" href="http://code.jquery.com/mobile/1.1.0/jquery.mobile-1.1.0.min.css" />
<script src="http://code.jquery.com/jquery-1.6.4.min.js"></script>
<script src="http://code.jquery.com/mobile/1.1.0/jquery.mobile-1.1.0.min.js"></script>
<script type="text/javascript" src="../../appjavascript/ssa/mkwr/mytest.js"></script>

</head>

<body>
    <div data-role="page" id="MyTestPage">
        <div data-role="header" data-position="fixed" data-logo="true" data-tap-toggle="false" data-fullscreen="false" >
            <h1> Page Title </h1>
        </div>

        <div data-role="content">
            <div class="content-primary divcontent">
                <h1 class='h1title'>Using This App</h1>
                <p> Here are the instructions </a>
                </p>
            </div>

                <div class="inputdata">
                    <br /> <br /> 
                    <input type="text" name="accessCode" id="AccessCode" value=""  placeholder="Access Code:" /> <br />
                    <input type="text" id="ssn1" class="ssn" value=""  placeholder="SSN1:" /> <br />
                    <input type="text" id="ssn2" class="ssn" value=""  placeholder="SSN2:" /> <br />
                </div>
                <input type="button" id="myalert" value="Next" />
        </div>
        <!-- /content -->
</body>
</html> 
```

这是java脚本

```
if (typeof TEST == "undefined" || !TEST) {
    var TEST = {};
}

( function() {
    TEST.mkwr = {
        init : function() { // this is a public function
      $("[data-role='page']").on("pagebeforeshow", TEST.mkwr.hideError());
      $("[data-role='page']").on("pageshow", TEST.mkwr.setHandlers());
        },

        // On Blur, we need to add the '-'s if they doesn't exist so the user
        // view edit the entered value formatted
        ssnOnBlurHandler : function(input) { // Auto format SSN on blur
            if ($(input).val().length == 9) {
                var _ssn = $(input).val();
                var _ssnSegmentA = _ssn.substring(0, 3);
                var _ssnSegmentB = _ssn.substring(3, 5);
                var _ssnSegmentC = _ssn.substring(5, 9);
                $(input).val(
                        _ssnSegmentA + "-" + _ssnSegmentB + "-" + _ssnSegmentC);
            }
        }, // _ssnOnBlurHandler

        // On focus, we need to remove the '-'s if they exist so the user
        // can edit the entered value
        ssnOnFocusHandler : function(input) {
            // allow backspace, tab, delete, arrows, numbers and keypad numbers ONLY
            if ($(input).val().length == 11) {
                var _ssn = $(input).val();
                var _ssnSegmentA = _ssn.substring(0, 3);
                var _ssnSegmentB = _ssn.substring(4, 6);
                var _ssnSegmentC = _ssn.substring(7, 11);

                $(input).val(_ssnSegmentA + _ssnSegmentB + _ssnSegmentC);
            }
        }, // _ssnOnFocusHandler

        // Hide all errors
        hideError : function() {
            $(".error").hide(); // Hide all errors
        },

        setHandlers : function() {
            alert("Set Handlers");
            // $(".ssn").each( function() {
      // var input = this; input.blur(TEST.mkwr.ssnOnBlurHandler(input))
      // });
      // $(".ssn").each( function() {
      // var input = this; input.focus(TEST.mkwr.ssnOnFocusHandler(input))
      // });
    }
    };
})(); // end the anonymous function

$("[data-role='page']").bind("pageinit", TEST.mkwr.init()); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T15:57:16.200

该[`.on()`](http://api.jquery.com/on/)函数是在 jQuery 1.7 中引入的。您在上面发布的代码包括`<script src="http://code.jquery.com/jquery-1.6.4.min.js"></script>`没有该功能的 jQuery 1.6.4 ( )。您可以升级到最新版本的 jQuery（推荐）或使用等效功能 - [`.bind()`](http://api.jquery.com/bind/)- 用于旧版本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T16:29:53.763

我发现 jsfiddle 上的代码存在一些问题。这是一个用于触发处理程序和解析代码的更新版本。看起来你的 ssn 逻辑可能需要稍微修正一下，但一切都让你到达那里。

[http://jsfiddle.net/H4Q5f/10/](http://jsfiddle.net/H4Q5f/10/)

我看到的问题部分是在您使用 .on 而不是 .bind 给定 jquery 版本之前提到的。但你也没有设置你的处理程序，而是解雇你的处理程序。你有这个：

```
input.bind("blur",TEST.mkwr.ssnOnBlurHandler(input)) 
```

这会将函数的结果返回给 set 方法，这不是您想要的。所以我把它改成这样：

```
input.bind("blur",TEST.mkwr.ssnOnBlurHandler) 
```

因此，现在您将处理程序传递给 set 方法，以便在事件发生时触发它。

希望这是有道理的。

# ruby-on-rails - 回滚 | 由于cancan授权设计重定向循环

> ID：11141999
> 
> 赞同：7
> 
> 时间：2012-06-21T15:54:06.870
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, devise, cancan

她是我的应用程序.rb

```
class ApplicationController < ActionController::Base
  protect_from_forgery

  rescue_from CanCan::AccessDenied do |exception|
    flash[:error] = "You must first login to view this page"
    session[:user_return_to] = request.url
    redirect_to "/users/sign_in"
  end                                                                                                                                                  

end 
```

如果 AccessDenied 被抛出并且用户没有登录（“工作得很好”），这会将使用重定向到登录页面，但是一旦登录，如果登录但由于登录页面没有被 cancan 授权，它将导致重定向循环只会通过 session[:user_return_to] = request.url 将它们重定向回用户。

问题是：如果用户已登录但未授权，我该如何处理此逻辑。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-21T16:15:42.250

我添加了一些条件来完成这项工作。

```
class ApplicationController < ActionController::Base
  protect_from_forgery

    #Redirects to login for secure resources
    rescue_from CanCan::AccessDenied do |exception|

      if user_signed_in?
        flash[:error] = "Not authorized to view this page"
        session[:user_return_to] = nil
        redirect_to root_url

      else              
        flash[:error] = "You must first login to view this page"
        session[:user_return_to] = request.url
        redirect_to "/users/sign_in"
      end 

    end 
end 
```